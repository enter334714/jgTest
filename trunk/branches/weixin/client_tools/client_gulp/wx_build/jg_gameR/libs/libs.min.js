var Laya=window.Laya=function(r$R,r$S){var r$o={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(r$S,r$Q){return 1==arguments.length?r$o.__presubstr.call(this,r$S):r$o.__presubstr.call(this,r$S,0<r$Q?r$Q:this.length+r$Q)},__init:function(r$S){r$S.forEach(function(r$S){r$S.__init$&&r$S.__init$()})},__isClass:function(r$S){return r$S&&(r$S.__isclass||r$S==Object||r$S==String||r$S==Array)},__newvec:function(r$S,r$Q){var r$e=[];r$e.length=r$S;for(var r$l=0;r$l<r$S;r$l++)r$e[r$l]=r$Q;return r$e},__extend:function(r$S,r$Q){for(var r$e in r$Q)if(r$Q.hasOwnProperty(r$e)){var r$l=Object.getOwnPropertyDescriptor(r$Q,r$e),r$M=r$l.get,r$d=r$l.set;r$M||r$d?r$M&&r$d?Object.defineProperty(r$S,r$e,r$l):(r$M&&Object.defineProperty(r$S,r$e,r$M),r$d&&Object.defineProperty(r$S,r$e,r$d)):r$S[r$e]=r$Q[r$e]}function r$T(){r$o.un(this,"constructor",r$S)}r$T.prototype=r$Q.prototype,r$S.prototype=new r$T,r$o.un(r$S.prototype,"__imps",r$o.__copy({},r$Q.prototype.__imps))},__copy:function(r$S,r$Q){if(!r$Q)return null;for(var r$e in r$S=r$S||{},r$Q)r$S[r$e]=r$Q[r$e];return r$S},__package:function(r$S,r$Q){if(!r$o.__packages[r$S]){r$o.__packages[r$S]=!0;var r$e=r$R,r$l=r$S.split(".");if(1<r$l.length)for(var r$M=0,r$d=r$l.length-1;r$M<r$d;r$M++){var r$T=r$e[r$l[r$M]];r$e=r$T||(r$e[r$l[r$M]]={})}r$e[r$l[r$l.length-1]]||(r$e[r$l[r$l.length-1]]=r$Q||{})}},__hasOwnProperty:function(r$S,r$Q){return r$Q=r$Q||this,Object.hasOwnProperty.call(r$Q,r$S)||function r$S(r$Q,r$e){if(Object.hasOwnProperty.call(r$e.prototype,r$Q))return!0;var r$l=r$e.prototype.__super;return null==r$l?null:r$S(r$Q,r$l)}(r$S,r$Q.__class)},__typeof:function(r$S,r$Q){if(!r$S||!r$Q)return!1;if(r$Q===String)return"string"==typeof r$S;if(r$Q===Number)return"number"==typeof r$S;if(r$Q.__interface__)r$Q=r$Q.__interface__;else if("string"!=typeof r$Q)return r$S instanceof r$Q;return r$S.__imps&&r$S.__imps[r$Q]||r$S.__class==r$Q},__as:function(r$S,r$Q){return this.__typeof(r$S,r$Q)?r$S:null},__int:function(r$S){return r$S?parseInt(r$S):0},interface:function(r$S,r$Q){r$o.__package(r$S,{});var r$e=r$o.__internals,r$l=r$e[r$S]=r$e[r$S]||{self:r$S};if(r$Q){var r$M=r$Q.split(",");r$l.extend=[];for(var r$d=0;r$d<r$M.length;r$d++){var r$T=r$M[r$d];r$e[r$T]=r$e[r$T]||{self:r$T},r$l.extend.push(r$e[r$T])}}var r$U=r$R,r$i=r$S.split(".");for(r$d=0;r$d<r$i.length-1;r$d++)r$U=r$U[r$i[r$d]];r$U[r$i[r$i.length-1]]={__interface__:r$S}},class:function(r$S,r$Q,r$e,r$l){if(r$e&&r$o.__extend(r$S,r$e),r$Q)if(r$o.__package(r$Q,r$S),r$o.__classmap[r$Q]=r$S,0<r$Q.indexOf(".")){if(0==r$Q.indexOf("laya.")){var r$M=r$Q.split(".");r$l=r$l||r$M[r$M.length-1],r$o[r$l]&&console.log("Warning!,this class["+r$l+"] already exist:",r$o[r$l]),r$o[r$l]=r$S}}else"Main"==r$Q?r$R.Main=r$S:"MainWX"==r$Q?r$R.MainWX=r$S:(r$o[r$Q]&&console.log("Error!,this class["+r$Q+"] already exist:",r$o[r$Q]),r$o[r$Q]=r$S);var r$d=r$o.un,r$T=r$S.prototype;r$d(r$T,"hasOwnProperty",r$o.__hasOwnProperty),r$d(r$T,"__class",r$S),r$d(r$T,"__super",r$e),r$d(r$T,"__className",r$Q),r$d(r$S,"__super",r$e),r$d(r$S,"__className",r$Q),r$d(r$S,"__isclass",!0),r$d(r$S,"super",function(r$S){this.__super.call(r$S)})},imps:function(r$S,r$Q){if(!r$Q)return null;var r$M=r$S.__imps||r$o.un(r$S,"__imps",{});function r$d(r$S){var r$Q,r$e;if((r$Q=r$o.__internals[r$S])&&(r$M[r$S]=!0,r$e=r$Q.extend))for(var r$l=0;r$l<r$e.length;r$l++)r$d(r$e[r$l].self)}for(var r$e in r$Q)r$d(r$e)},superSet:function(r$S,r$Q,r$e,r$l){var r$M=r$S.prototype["_$set_"+r$e];r$M&&r$M.call(r$Q,r$l)},superGet:function(r$S,r$Q,r$e){var r$l=r$S.prototype["_$get_"+r$e];return r$l?r$l.call(r$Q):null},getset:function(r$S,r$Q,r$e,r$l,r$M){r$S?(r$l&&(r$Q["_$GET_"+r$e]=r$l),r$M&&(r$Q["_$SET_"+r$e]=r$M)):(r$l&&r$o.un(r$Q,"_$get_"+r$e,r$l),r$M&&r$o.un(r$Q,"_$set_"+r$e,r$M)),r$l&&r$M?Object.defineProperty(r$Q,r$e,{get:r$l,set:r$M,enumerable:!1,configurable:!0}):(r$l&&Object.defineProperty(r$Q,r$e,{get:r$l,enumerable:!1,configurable:!0}),r$M&&Object.defineProperty(r$Q,r$e,{set:r$M,enumerable:!1,configurable:!0}))},static:function(r$e,r$l){for(var r$M=0,r$S=r$l.length;r$M<r$S;r$M+=2)if("length"==r$l[r$M])r$e.length=r$l[r$M+1].call(r$e);else{function r$Q(){var r$Q=r$l[r$M],r$S=r$l[r$M+1];Object.defineProperty(r$e,r$Q,{get:function(){return delete this[r$Q],this[r$Q]=r$S.call(this)},set:function(r$S){delete this[r$Q],this[r$Q]=r$S},enumerable:!0,configurable:!0})}r$Q()}},un:function(r$S,r$Q,r$e){return r$e||(r$e=r$S[r$Q]),r$o.__propun.value=r$e,Object.defineProperty(r$S,r$Q,r$o.__propun),r$e},uns:function(r$Q,r$S){r$S.forEach(function(r$S){r$o.un(r$Q,r$S)})}};return r$R.console=r$R.console||{log:function(){}},r$R.trace=r$R.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),r$o}(window,document);!function(r$S,r$Q,r$e){r$e.un,r$e.uns,r$e.static,r$e.class,r$e.getset,r$e.__newvec}(window,document,Laya),function(r$T,r$Q,r$O){r$O.un,r$O.uns;var r$i=r$O.static,r$o=r$O.class,r$L=r$O.getset;r$O.__newvec;r$O.interface("laya.runtime.IMarket"),r$O.interface("laya.filters.IFilter"),r$O.interface("laya.display.ILayout"),r$O.interface("laya.resource.IDispose"),r$O.interface("laya.runtime.IPlatform"),r$O.interface("laya.resource.IDestroy"),r$O.interface("laya.runtime.IConchNode"),r$O.interface("laya.filters.IFilterAction"),r$O.interface("laya.runtime.ICPlatformClass"),r$O.interface("laya.resource.ICreateResource"),r$O.interface("laya.runtime.IConchRenderObject"),r$O.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var r$k=function(){function r$d(){}return r$o(r$d,"laya.utils.RunDriver"),r$d.FILTER_ACTIONS=[],r$d.pixelRatio=-1,r$d._charSizeTestDiv=null,r$d.now=function(){return Date.now()},r$d.getWindow=function(){return r$T},r$d.getPixelRatio=function(){if(r$d.pixelRatio<0){var r$S=r$f.context,r$Q=r$S.backingStorePixelRatio||r$S.webkitBackingStorePixelRatio||r$S.mozBackingStorePixelRatio||r$S.msBackingStorePixelRatio||r$S.oBackingStorePixelRatio||r$S.backingStorePixelRatio||1;(r$d.pixelRatio=(r$f.window.devicePixelRatio||1)/r$Q)<1&&(r$d.pixelRatio=1)}return r$d.pixelRatio},r$d.getIncludeStr=function(r$S){return null},r$d.createShaderCondition=function(r$S){var r$Q="(function() {return "+r$S+";})";return r$O._runScript(r$Q)},r$d.fontMap=[],r$d.measureText=function(r$S,r$Q){var r$e=r$d.hanzi.test(r$S);if(r$e&&r$d.fontMap[r$Q])return r$d.fontMap[r$Q];var r$l=r$f.context;r$l.font=r$Q;var r$M=r$l.measureText(r$S);return r$e&&(r$d.fontMap[r$Q]=r$M),r$M},r$d.getWebGLContext=function(r$S){},r$d.beginFlush=function(){},r$d.endFinish=function(){},r$d.addToAtlas=null,r$d.flashFlushImage=function(r$S){},r$d.drawToCanvas=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=r$AS.create("2D"),r$U=new r$$(r$e,r$l,r$T);return r$n.renders[r$Q]._fun(r$S,r$U,r$M,r$d),r$T},r$d.createParticleTemplate2D=null,r$d.createGLTextur=null,r$d.createWebGLContext2D=null,r$d.changeWebGLSize=function(r$S,r$Q){},r$d.createRenderSprite=function(r$S,r$Q){return new r$n(r$S,r$Q)},r$d.createFilterAction=function(r$S){return new r$A},r$d.createGraphics=function(){return new r$p},r$d.clear=function(r$S){r$m._context.ctx.clear()},r$d.cancelLoadByUrl=function(r$S){},r$d.clearAtlas=function(r$S){},r$d.isAtlas=function(r$S){return!1},r$d.addTextureToAtlas=function(r$S){},r$d.getTexturePixels=function(r$S,r$Q,r$e,r$l,r$M){return null},r$d.skinAniSprite=function(){return null},r$d.update3DLoop=function(){},r$i(r$d,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),r$d}(),r$l=(r$L(1,r$O,"alertGlobalError",null,function(r$S){var r$d=0;r$f.window.onerror=r$S?function(r$S,r$Q,r$e,r$l,r$M){r$d++<5&&r$M&&alert(r$M.stack||r$M)}:null}),r$O.init=function(r$S,r$Q,r$e){for(var r$l=[],r$M=2,r$d=arguments.length;r$M<r$d;r$M++)r$l.push(arguments[r$M]);if(!r$O._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=r$O._arrayBufferSlice),r$O._isinit=!0,r$f.__init__(),r$P.__init__(),r$p.__init__(),r$O.timer=new r$C,r$O.scaleTimer=new r$C,r$O.loader=new r$iS,r$s.__init__(),r$M=0;for(var r$T=r$l.length;r$M<r$T;r$M++)r$l[r$M].enable&&r$l[r$M].enable();return r$J.__init__(),r$U.__init__(),r$a.__init__(),r$u.beginCheck(),r$O._currentStage=r$O.stage=new r$GS,r$O.stage.conchModel&&r$O.stage.conchModel.setRootNode(),r$O._getUrlPath(),r$O.render=new r$m(0,0),r$O.stage.size(r$S,r$Q),r$n.__init__(),r$Y.__init__(),r$j.instance.__init__(r$O.stage,r$m.canvas),r$DS.__init__(),r$t.autoStopMusic=!0,r$I.__init__(),r$m.canvas}},r$O._getUrlPath=function(){var r$S=r$f.window.location,r$Q=r$S.pathname;r$Q=r$Q&&":"==r$Q.charAt(2)?r$Q.substring(1):r$Q,r$b.rootPath=r$b.basePath=r$b.getPath("file:"==r$S.protocol?r$Q:r$S.protocol+"//"+r$S.host+r$S.pathname)},r$O._arrayBufferSlice=function(r$S,r$Q){var r$e=new Uint8Array(this,r$S,r$Q-r$S),r$l=new Uint8Array(r$e.length);return r$l.set(r$e),r$l.buffer},r$O._runScript=function(r$S){return r$f.window[r$O._evcode](r$S)},r$O.stage=null,r$O.timer=null,r$O.scaleTimer=null,r$O.loader=null,r$O.version="1.8.6",r$O.render=null,r$O._currentStage=null,r$O._isinit=!1,r$O.isDebug=!1,r$O.MiniAdpter={init:function(){r$T.navigator&&r$T.navigator.userAgent&&-1<r$T.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},r$i(r$O,["conchMarket",function(){return this.conchMarket=r$T.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=r$T.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function r$S(){}return r$o(r$S,"Config"),r$S.WebGLTextCacheCount=500,r$S.atlasEnable=!1,r$S.showCanvasMark=!1,r$S.animationInterval=50,r$S.isAntialias=!1,r$S.isAlpha=!1,r$S.premultipliedAlpha=!0,r$S.isStencil=!0,r$S.preserveDrawingBuffer=!1,r$S}()),r$R=function(){function r$R(){this._events=null}r$o(r$R,"laya.events.EventDispatcher");var r$S=r$R.prototype;return r$S.hasListener=function(r$S){return!!(this._events&&this._events[r$S])},r$S.event=function(r$S,r$Q){if(!this._events||!this._events[r$S])return!1;var r$e=this._events[r$S];if(r$e.lock)r$e.queue||(r$e.queue=[]),r$e.queue.push(r$Q);else{var r$l;for(r$e.lock=!0,r$e.cursor=r$e.head;r$e.cursor;)r$l=r$e.cursor,r$e.cursor=r$l.next,r$l.once&&r$R.delNode(r$e,r$l),null!=r$Q?r$l.args?r$l.method.apply(r$l.caller,r$l.args.concat(r$Q)):r$Q instanceof Array?r$l.method.apply(r$l.caller,r$Q):r$l.method.call(r$l.caller,r$Q):r$l.method.apply(r$l.caller,r$l.args),r$l.once&&r$R.recoverHandler(r$l);r$e.lock=!1,!r$e.head&&this._events&&this._events[r$S]==r$e&&delete this._events[r$S],r$e.queue&&r$e.queue.length&&this.event(r$S,r$e.queue.shift())}return!0},r$S.on=function(r$S,r$Q,r$e,r$l){return this._createListener(r$S,r$Q,r$e,r$l,!1)},r$S.once=function(r$S,r$Q,r$e,r$l){return this._createListener(r$S,r$Q,r$e,r$l,!0)},r$S._createListener=function(r$S,r$Q,r$e,r$l,r$M,r$d){void 0===r$d&&(r$d=!0),r$d&&this.off(r$S,r$Q,r$e,r$M);var r$T=r$R.createHandler(r$Q||this,r$e,r$l,r$M);this._events||(this._events={});var r$U=this._events,r$i=r$U[r$S];return r$i?r$i.tail?(r$T.prev=r$i.tail,r$i.tail.next=r$T,r$i.tail=r$T):r$i.head=r$i.tail=r$T:r$U[r$S]={head:r$T,tail:r$T,cursor:null,lock:!1},this},r$S.off=function(r$S,r$Q,r$e,r$l){if(void 0===r$l&&(r$l=!1),!this._events||!this._events[r$S])return this;for(var r$M=this._events[r$S],r$d=r$M.head;r$d;){if((!r$Q||r$d.caller===r$Q)&&r$d.method===r$e&&(!r$l||r$d.once)){r$R.delNode(r$M,r$d),r$M.cursor==r$d&&(r$M.cursor=r$d.next),r$R.recoverHandler(r$d);break}r$d=r$d.next}return this},r$S.offAll=function(r$S){var r$Q=this._events;if(!r$Q)return this;if(r$S)this._recoverHandlers(r$Q[r$S]),delete r$Q[r$S];else{for(var r$e in r$Q)this._recoverHandlers(r$Q[r$e]);this._events=null}return this},r$S._recoverHandlers=function(r$S){if(r$S){for(var r$Q=r$S.head;r$Q;){r$R.delNode(r$S,r$Q);var r$e=r$Q.next;r$R.recoverHandler(r$Q),r$Q=r$e}r$S.cursor=null}},r$S.isMouseEvent=function(r$S){return r$R.MOUSE_EVENTS[r$S]},r$R.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},r$R.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},r$R.delNode=function(r$S,r$Q){r$Q.prev?r$Q.prev.next=r$Q.next:r$S.head=r$Q.next,r$Q.next?r$Q.next.prev=r$Q.prev:r$S.tail=r$Q.prev},r$R.createHandler=function(r$S,r$Q,r$e,r$l){var r$M=r$R._freeHandler;return r$M?(r$R._freeCount--,r$R._freeHandler=r$M.next,r$M.caller=r$S,r$M.method=r$Q,r$M.args=r$e,r$M.once=r$l):r$M={caller:r$S,method:r$Q,args:r$e,once:r$l},r$M.prev=r$M.next=null,r$M},r$R.recoverHandler=function(r$S){r$S.caller=r$S.method=r$S.args=r$S.prev=null,r$S.next=r$R._freeHandler,r$R._freeHandler=r$S,r$R._freeCount++},r$R._freeHandler=null,r$R._freeCount=0,r$R}(),r$z=function(){function r$M(r$S,r$Q,r$e,r$l){this.once=!1,void(this._id=0)===r$l&&(r$l=!1),this.setTo(r$S,r$Q,r$e,r$l)}r$o(r$M,"laya.utils.Handler");var r$S=r$M.prototype;return r$S.setTo=function(r$S,r$Q,r$e,r$l){return this._id=r$M._gid++,this.caller=r$S,this.method=r$Q,this.args=r$e,this.once=r$l,this},r$S.run=function(){if(null==this.method)return null;var r$S=this._id,r$Q=this.method.apply(this.caller,this.args);return this._id===r$S&&this.once&&this.recover(),r$Q},r$S.runWith=function(r$S){if(null==this.method)return null;var r$Q=this._id;if(null==r$S)var r$e=this.method.apply(this.caller,this.args);else r$e=this.args||r$S.unshift?this.args?this.method.apply(this.caller,this.args.concat(r$S)):this.method.apply(this.caller,r$S):this.method.call(this.caller,r$S);return this._id===r$Q&&this.once&&this.recover(),r$e},r$S.clear=function(){return this.caller=null,this.method=null,this.args=null,this},r$S.recover=function(){0<this._id&&(this._id=0,this.clear())},r$M.create=function(r$S,r$Q,r$e,r$l){return void 0===r$l&&(r$l=!0),new r$M(r$S,r$Q,r$e,r$l)},r$M._gid=1,r$M}(),r$E=function(){function r$S(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}r$o(r$S,"laya.display.BitmapFont");var r$Q=r$S.prototype;return r$Q.loadFont=function(r$S,r$Q){this._path=r$S,this._complete=r$Q,r$O.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],r$z.create(this,this.onLoaded))},r$Q.onLoaded=function(){this.parseFont(r$US.getRes(this._path),r$US.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},r$Q.parseFont=function(r$S,r$Q){if(null!=r$S&&null!=r$Q){this._texture=r$Q;var r$e=r$S.getElementsByTagName("info");if(!r$e[0].getAttributeNode)return this.parseFont2(r$S,r$Q);this.fontSize=parseInt(r$e[0].getAttributeNode("size").nodeValue);var r$l,r$M=r$e[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(r$M[0]),parseInt(r$M[1]),parseInt(r$M[2]),parseInt(r$M[3])],r$l=r$S.getElementsByTagName("char");var r$d=0;for(r$d=0;r$d<r$l.length;r$d++){var r$T=r$l[r$d],r$U=parseInt(r$T.getAttributeNode("id").nodeValue),r$i=parseInt(r$T.getAttributeNode("xoffset").nodeValue)/1,r$R=parseInt(r$T.getAttributeNode("yoffset").nodeValue)/1,r$o=parseInt(r$T.getAttributeNode("xadvance").nodeValue)/1,r$Y=new r$g;r$Y.x=parseInt(r$T.getAttributeNode("x").nodeValue),r$Y.y=parseInt(r$T.getAttributeNode("y").nodeValue),r$Y.width=parseInt(r$T.getAttributeNode("width").nodeValue),r$Y.height=parseInt(r$T.getAttributeNode("height").nodeValue);var r$p=r$oS.create(r$Q,r$Y.x,r$Y.y,r$Y.width,r$Y.height,r$i,r$R);this._maxWidth=Math.max(this._maxWidth,r$o+this.letterSpacing),this._fontCharDic[r$U]=r$p,this._fontWidthMap[r$U]=r$o}}},r$Q.parseFont2=function(r$S,r$Q){if(null!=r$S&&null!=r$Q){this._texture=r$Q;var r$e=r$S.getElementsByTagName("info");this.fontSize=parseInt(r$e[0].attributes.size.nodeValue);var r$l=r$e[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(r$l[0]),parseInt(r$l[1]),parseInt(r$l[2]),parseInt(r$l[3])];var r$M=r$S.getElementsByTagName("char"),r$d=0;for(r$d=0;r$d<r$M.length;r$d++){var r$T=r$M[r$d].attributes,r$U=parseInt(r$T.id.nodeValue),r$i=parseInt(r$T.xoffset.nodeValue)/1,r$R=parseInt(r$T.yoffset.nodeValue)/1,r$o=parseInt(r$T.xadvance.nodeValue)/1,r$Y=new r$g;r$Y.x=parseInt(r$T.x.nodeValue),r$Y.y=parseInt(r$T.y.nodeValue),r$Y.width=parseInt(r$T.width.nodeValue),r$Y.height=parseInt(r$T.height.nodeValue);var r$p=r$oS.create(r$Q,r$Y.x,r$Y.y,r$Y.width,r$Y.height,r$i,r$R);this._maxWidth=Math.max(this._maxWidth,r$o+this.letterSpacing),this._fontCharDic[r$U]=r$p,this._fontWidthMap[r$U]=r$o}}},r$Q.getCharTexture=function(r$S){return this._fontCharDic[r$S.charCodeAt(0)]},r$Q.destroy=function(){if(this._texture){for(var r$S in this._fontCharDic){var r$Q=this._fontCharDic[r$S];r$Q&&r$Q.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},r$Q.setSpaceWidth=function(r$S){this._spaceWidth=r$S},r$Q.getCharWidth=function(r$S){var r$Q=r$S.charCodeAt(0);return this._fontWidthMap[r$Q]?this._fontWidthMap[r$Q]+this.letterSpacing:" "==r$S?this._spaceWidth+this.letterSpacing:0},r$Q.getTextWidth=function(r$S){for(var r$Q=0,r$e=0,r$l=r$S.length;r$e<r$l;r$e++)r$Q+=this.getCharWidth(r$S.charAt(r$e));return r$Q},r$Q.getMaxWidth=function(){return this._maxWidth},r$Q.getMaxHeight=function(){return this.fontSize},r$Q.drawText=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T,r$U=this.getTextWidth(r$S),r$i=0;"center"===r$M&&(r$i=(r$d-r$U)/2),"right"===r$M&&(r$i=r$d-r$U);for(var r$R=0,r$o=0,r$Y=r$S.length;r$o<r$Y;r$o++)(r$T=this.getCharTexture(r$S.charAt(r$o)))&&(r$Q.graphics.drawTexture(r$T,r$e+r$R+r$i,r$l),r$R+=this.getCharWidth(r$S.charAt(r$o)))},r$S}(),r$U=function(){function r$e(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=r$e._TF_EMPTY}r$o(r$e,"laya.display.css.Style");var r$S=r$e.prototype;return r$S.getTransform=function(){return this._tf},r$S.setTransform=function(r$S){this._tf="none"!==r$S&&r$S?r$S:r$e._TF_EMPTY},r$S.setTranslateX=function(r$S){this._tf===r$e._TF_EMPTY&&(this._tf=new r$M),this._tf.translateX=r$S},r$S.setTranslateY=function(r$S){this._tf===r$e._TF_EMPTY&&(this._tf=new r$M),this._tf.translateY=r$S},r$S.setScaleX=function(r$S){this._tf===r$e._TF_EMPTY&&(this._tf=new r$M),this._tf.scaleX=r$S},r$S.setScale=function(r$S,r$Q){this._tf===r$e._TF_EMPTY&&(this._tf=new r$M),this._tf.scaleX=r$S,this._tf.scaleY=r$Q},r$S.setScaleY=function(r$S){this._tf===r$e._TF_EMPTY&&(this._tf=new r$M),this._tf.scaleY=r$S},r$S.setRotate=function(r$S){this._tf===r$e._TF_EMPTY&&(this._tf=new r$M),this._tf.rotate=r$S},r$S.setSkewX=function(r$S){this._tf===r$e._TF_EMPTY&&(this._tf=new r$M),this._tf.skewX=r$S},r$S.setSkewY=function(r$S){this._tf===r$e._TF_EMPTY&&(this._tf=new r$M),this._tf.skewY=r$S},r$S.destroy=function(){this.scrollRect=null},r$S.render=function(r$S,r$Q,r$e,r$l){},r$S.getCSSStyle=function(){return r$QS.EMPTY},r$S._enableLayout=function(){return!1},r$L(0,r$S,"scaleX",function(){return this._tf.scaleX},function(r$S){this.setScaleX(r$S)}),r$L(0,r$S,"transform",function(){return this.getTransform()},function(r$S){this.setTransform(r$S)}),r$L(0,r$S,"translateX",function(){return this._tf.translateX},function(r$S){this.setTranslateX(r$S)}),r$L(0,r$S,"translateY",function(){return this._tf.translateY},function(r$S){this.setTranslateY(r$S)}),r$L(0,r$S,"scaleY",function(){return this._tf.scaleY},function(r$S){this.setScaleY(r$S)}),r$L(0,r$S,"block",function(){return 0!=(1&this._type)}),r$L(0,r$S,"skewY",function(){return this._tf.skewY},function(r$S){this.setSkewY(r$S)}),r$L(0,r$S,"rotate",function(){return this._tf.rotate},function(r$S){this.setRotate(r$S)}),r$L(0,r$S,"skewX",function(){return this._tf.skewX},function(r$S){this.setSkewX(r$S)}),r$L(0,r$S,"paddingLeft",function(){return 0}),r$L(0,r$S,"paddingTop",function(){return 0}),r$L(0,r$S,"absolute",function(){return!0}),r$e.__init__=function(){r$e._TF_EMPTY=new r$M,r$e.EMPTY=new r$e},r$e.EMPTY=null,r$e._TF_EMPTY=null,r$e}(),r$J=function(){function r$Q(r$S){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=r$W.create(r$Q.defaultColor),this.family=r$Q.defaultFamily,this.stroke=r$Q._STROKE,this.size=r$Q.defaultSize,r$S&&r$S!==r$Q.EMPTY&&r$S.copyTo(this)}r$o(r$Q,"laya.display.css.Font");var r$S=r$Q.prototype;return r$S.set=function(r$S){this._text=null;for(var r$Q=r$S.split(" "),r$e=0,r$l=r$Q.length;r$e<r$l;r$e++){var r$M=r$Q[r$e];switch(r$M){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<r$M.indexOf("px")&&(this.size=parseInt(r$M),this.family=r$Q[r$e+1],r$e++)}},r$S.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},r$S.copyTo=function(r$S){r$S._type=this._type,r$S._text=this._text,r$S._weight=this._weight,r$S._color=this._color,r$S.family=this.family,r$S.stroke=this.stroke!=r$Q._STROKE?this.stroke.slice():r$Q._STROKE,r$S.indent=this.indent,r$S.size=this.size},r$L(0,r$S,"password",function(){return 0!=(1024&this._type)},function(r$S){r$S?this._type|=1024:this._type&=-1025}),r$L(0,r$S,"color",function(){return this._color.strColor},function(r$S){this._color=r$W.create(r$S)}),r$L(0,r$S,"italic",function(){return 0!=(512&this._type)},function(r$S){r$S?this._type|=512:this._type&=-513}),r$L(0,r$S,"bold",function(){return 0!=(2048&this._type)},function(r$S){r$S?this._type|=2048:this._type&=-2049}),r$L(0,r$S,"weight",function(){return""+this._weight},function(r$S){var r$Q=0;switch(r$S){case"normal":break;case"bold":this.bold=!0,r$Q=700;break;case"bolder":r$Q=800;break;case"lighter":r$Q=100;break;default:r$Q=parseInt(r$S)}this._weight=r$Q,this._text=null}),r$L(0,r$S,"decoration",function(){return this._decoration?this._decoration.value:null},function(r$S){var r$Q=r$S.split(" ");switch(this._decoration||(this._decoration={}),r$Q[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=r$Q[0]}r$Q[1]&&(this._decoration.color=r$W.create(r$Q)),this._decoration.value=r$S}),r$Q.__init__=function(){r$Q.EMPTY=new r$Q(null)},r$Q.EMPTY=null,r$Q.defaultColor="#000000",r$Q.defaultSize=12,r$Q.defaultFamily="Arial",r$Q.defaultFont="12px Arial",r$Q._STROKE=[0,"#000000"],r$Q._ITALIC=512,r$Q._PASSWORD=1024,r$Q._BOLD=2048,r$Q}(),r$M=function(){function r$S(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return r$o(r$S,"laya.display.css.TransformInfo"),r$S}(),r$p=function(){function r$Y(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,r$m.isConchNode){this._nativeObj=new r$T._conchGraphics,this.id=this._nativeObj.conchID}}r$o(r$Y,"laya.display.Graphics");var r$S=r$Y.prototype;return r$S.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},r$S.clear=function(r$S){void 0===r$S&&(r$S=!1);var r$Q=0,r$e=0;if(r$S){var r$l=this._one;if(this._cmds){for(r$e=this._cmds.length,r$Q=0;r$Q<r$e;r$Q++)!(r$l=this._cmds[r$Q])||r$l.callee!==r$m._context._drawTexture&&r$l.callee!==r$m._context._drawTextureWithTransform||(r$l[0]=null,r$Y._cache.push(r$l));this._cmds.length=0}else r$l&&(!r$l||r$l.callee!==r$m._context._drawTexture&&r$l.callee!==r$m._context._drawTextureWithTransform||(r$l[0]=null,r$Y._cache.push(r$l)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(r$Q=0,r$e=this._vectorgraphArray.length;r$Q<r$e;r$Q++)r$_.getInstance().deleteShape(this._vectorgraphArray[r$Q]);this._vectorgraphArray.length=0}},r$S._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},r$S._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new r$e,this._graphicBounds._graphics=this)},r$S._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},r$S._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},r$S.getBounds=function(r$S){return void 0===r$S&&(r$S=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(r$S)},r$S.getBoundPoints=function(r$S){return void 0===r$S&&(r$S=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(r$S)},r$S._addCmd=function(r$S){this._cmds=this._cmds||[],r$S.callee=r$S.shift(),this._cmds.push(r$S)},r$S.setFilters=function(r$S){this._saveToCmd(r$m._context._setFilters,r$S)},r$S.drawTexture=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){if(void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=0),void 0===r$M&&(r$M=0),void 0===r$T&&(r$T=1),!r$S||r$T<.01)return null;r$l||(r$l=r$S.sourceWidth),r$M||(r$M=r$S.sourceHeight),r$T=r$T<0?0:1<r$T?1:r$T;var r$U,r$i=!r$m.isWebGL&&(r$f.onFirefox||r$f.onEdge||r$f.onIE||r$f.onSafari)?.5:0,r$R=r$l/r$S.sourceWidth,r$o=r$M/r$S.sourceHeight;return r$l=r$S.width*r$R,r$M=r$S.height*r$o,r$S.loaded&&(r$l<=0||r$M<=0)?null:(r$Q+=r$S.offsetX*r$R,r$e+=r$S.offsetY*r$o,this._sp&&(this._sp._renderType|=512),r$Q-=r$i,r$e-=r$i,r$l+=2*r$i,r$M+=2*r$i,r$Y._cache.length?((r$U=r$Y._cache.pop())[0]=r$S,r$U[1]=r$Q,r$U[2]=r$e,r$U[3]=r$l,r$U[4]=r$M,r$U[5]=r$d,r$U[6]=r$T):r$U=[r$S,r$Q,r$e,r$l,r$M,r$d,r$T],r$U.callee=r$d||1!=r$T?r$m._context._drawTextureWithTransform:r$m._context._drawTexture,null!=this._one||r$d||1!=r$T?this._saveToCmd(r$U.callee,r$U):(this._one=r$U,this._render=this._renderOneImg),r$S.loaded||r$S.once("loaded",this,this._textureLoaded,[r$S,r$U]),this._repaint(),r$U)},r$S.cleanByTexture=function(r$S,r$Q,r$e,r$l,r$M){if(void 0===r$l&&(r$l=0),void 0===r$M&&(r$M=0),!r$S)return this.clear();if(this._one&&this._render===this._renderOneImg){r$l||(r$l=r$S.sourceWidth),r$M||(r$M=r$S.sourceHeight);var r$d=r$l/r$S.sourceWidth,r$T=r$M/r$S.sourceHeight;r$l=r$S.width*r$d,r$M=r$S.height*r$T,r$Q+=r$S.offsetX*r$d,r$e+=r$S.offsetY*r$T,this._one[0]=r$S,this._one[1]=r$Q,this._one[2]=r$e,this._one[3]=r$l,this._one[4]=r$M,this._repaint()}else this.clear(),r$S&&this.drawTexture(r$S,r$Q,r$e,r$l,r$M)},r$S.drawTextures=function(r$S,r$Q){r$S&&this._saveToCmd(r$m._context._drawTextures,[r$S,r$Q])},r$S.fillTexture=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){if(void 0===r$l&&(r$l=0),void 0===r$M&&(r$M=0),void 0===r$d&&(r$d="repeat"),r$S){var r$U=[r$S,r$Q,r$e,r$l,r$M,r$d,r$T||r$H.EMPTY,{}];r$S.loaded||r$S.once("loaded",this,this._textureLoaded,[r$S,r$U]),this._saveToCmd(r$m._context._fillTexture,r$U)}},r$S._textureLoaded=function(r$S,r$Q){r$Q[3]=r$Q[3]||r$S.width,r$Q[4]=r$Q[4]||r$S.height,this._repaint()},r$S.fillCircle=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){r$e.bitmap.enableMerageInAtlas=!1;var r$U=new Float32Array(2*(r$T+1)),r$i=new Float32Array(2*(r$T+1)),r$R=new Uint16Array(3*r$T),r$o=2*Math.PI/r$T,r$Y=0;r$U[0]=r$l,r$U[1]=r$M,r$i[0]=r$l/r$e.width,r$i[1]=r$M/r$e.height;for(var r$p=2,r$J=0;r$J<r$T;r$J++){var r$L=r$d*Math.cos(r$Y)+r$l,r$j=r$d*Math.sin(r$Y)+r$M;r$U[r$p]=r$L,r$U[r$p+1]=r$j,r$i[r$p]=r$L/r$e.width,r$i[r$p+1]=r$j/r$e.height,r$Y+=r$o,r$p+=2}for(r$J=r$p=0;r$J<r$T;r$J++)r$R[r$p++]=0,r$R[r$p++]=r$J+1,r$R[r$p++]=r$T+1<=r$J+2?1:r$J+2;this.drawTriangles(r$e,r$S,r$Q,r$U,r$i,r$R)},r$S.drawTriangles=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){void 0===r$U&&(r$U=1),this._saveToCmd(r$m._context.drawTriangles,[r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R])},r$S._saveToCmd=function(r$S,r$Q){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=r$Q,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(r$Q)),r$Q.callee=r$S,this._repaint(),r$Q},r$S.clipRect=function(r$S,r$Q,r$e,r$l){this._saveToCmd(r$m._context._clipRect,[r$S,r$Q,r$e,r$l])},r$S.fillText=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){void 0===r$T&&(r$T=0),this._saveToCmd(r$m._context._fillText,[r$S,r$Q,r$e,r$l||r$J.defaultFont,r$M,r$d])},r$S.fillBorderText=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){this._saveToCmd(r$m._context._fillBorderText,[r$S,r$Q,r$e,r$l||r$J.defaultFont,r$M,r$d,r$T,r$U])},r$S.strokeText=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this._saveToCmd(r$m._context._strokeText,[r$S,r$Q,r$e,r$l||r$J.defaultFont,r$M,r$d,r$T])},r$S.alpha=function(r$S){r$S=r$S<0?0:1<r$S?1:r$S,this._saveToCmd(r$m._context._alpha,[r$S])},r$S.setAlpha=function(r$S){r$S=r$S<0?0:1<r$S?1:r$S,this._saveToCmd(r$m._context._setAlpha,[r$S])},r$S.transform=function(r$S,r$Q,r$e){void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),this._saveToCmd(r$m._context._transform,[r$S,r$Q,r$e])},r$S.rotate=function(r$S,r$Q,r$e){void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),this._saveToCmd(r$m._context._rotate,[r$S,r$Q,r$e])},r$S.scale=function(r$S,r$Q,r$e,r$l){void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=0),this._saveToCmd(r$m._context._scale,[r$S,r$Q,r$e,r$l])},r$S.translate=function(r$S,r$Q){this._saveToCmd(r$m._context._translate,[r$S,r$Q])},r$S.save=function(){this._saveToCmd(r$m._context._save,[])},r$S.restore=function(){this._saveToCmd(r$m._context._restore,[])},r$S.replaceText=function(r$S){this._repaint();var r$Q=this._cmds;if(r$Q){for(var r$e=r$Q.length-1;-1<r$e;r$e--)if(this._isTextCmd(r$Q[r$e].callee))return r$Q[r$e][0].toUpperCase?r$Q[r$e][0]=r$S:r$Q[r$e][0].setText(r$S),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=r$S:this._one[0].setText(r$S),!0;return!1},r$S._isTextCmd=function(r$S){return r$S===r$m._context._fillText||r$S===r$m._context._fillBorderText||r$S===r$m._context._strokeText},r$S.replaceTextColor=function(r$S){this._repaint();var r$Q=this._cmds;if(r$Q)for(var r$e=r$Q.length-1;-1<r$e;r$e--)this._isTextCmd(r$Q[r$e].callee)&&(r$Q[r$e][4]=r$S,r$Q[r$e][0].toUpperCase||(r$Q[r$e][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=r$S,this._one[0].toUpperCase||(this._one[0].changed=!0))},r$S.loadImage=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=this;void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=0),void 0===r$M&&(r$M=0);var r$U=r$US.getRes(r$S);function r$i(r$S){r$S&&(r$T.drawTexture(r$S,r$Q,r$e,r$l,r$M),null!=r$d&&r$d.call(r$T._sp,r$S))}r$U?r$i(r$U):r$O.loader.load(r$S,r$z.create(null,r$i),null,"image")},r$S._renderEmpty=function(r$S,r$Q,r$e,r$l){},r$S._renderAll=function(r$S,r$Q,r$e,r$l){for(var r$M,r$d=this._cmds,r$T=0,r$U=r$d.length;r$T<r$U;r$T++)(r$M=r$d[r$T]).callee.call(r$Q,r$e,r$l,r$M)},r$S._renderOne=function(r$S,r$Q,r$e,r$l){this._one.callee.call(r$Q,r$e,r$l,this._one)},r$S._renderOneImg=function(r$S,r$Q,r$e,r$l){this._one.callee.call(r$Q,r$e,r$l,this._one),2305!==r$S._renderType&&(r$S._renderType|=1)},r$S.drawLine=function(r$S,r$Q,r$e,r$l,r$M,r$d){void 0===r$d&&(r$d=1);var r$T=0;r$m.isWebGL&&(r$T=r$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(r$T));var r$U=r$d%2==0?0:.5,r$i=[r$S+r$U,r$Q+r$U,r$e+r$U,r$l+r$U,r$M,r$d,r$T];this._saveToCmd(r$m._context._drawLine,r$i)},r$S.drawLines=function(r$S,r$Q,r$e,r$l,r$M){void 0===r$M&&(r$M=1);var r$d=0;if(r$e&&!(r$e.length<4)){r$m.isWebGL&&(r$d=r$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(r$d));var r$T=r$M%2==0?0:.5,r$U=[r$S+r$T,r$Q+r$T,r$e,r$l,r$M,r$d];this._saveToCmd(r$m._context._drawLines,r$U)}},r$S.drawCurves=function(r$S,r$Q,r$e,r$l,r$M){void 0===r$M&&(r$M=1);var r$d=[r$S,r$Q,r$e,r$l,r$M];this._saveToCmd(r$m._context._drawCurves,r$d)},r$S.drawRect=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){void 0===r$T&&(r$T=1);var r$U=r$d?r$T/2:0,r$i=r$d?r$T:0,r$R=[r$S+r$U,r$Q+r$U,r$e-r$i,r$l-r$i,r$M,r$d,r$T];this._saveToCmd(r$m._context._drawRect,r$R)},r$S.drawCircle=function(r$S,r$Q,r$e,r$l,r$M,r$d){void 0===r$d&&(r$d=1);var r$T=r$M?r$d/2:0,r$U=0;r$m.isWebGL&&(r$U=r$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(r$U));var r$i=[r$S,r$Q,r$e-r$T,r$l,r$M,r$d,r$U];this._saveToCmd(r$m._context._drawCircle,r$i)},r$S.drawPie=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){void 0===r$U&&(r$U=1);var r$i=r$T?r$U/2:0,r$R=r$T?r$U:0,r$o=0;r$m.isWebGL&&(r$o=r$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(r$o));var r$Y=[r$S+r$i,r$Q+r$i,r$e-r$R,r$l,r$M,r$d,r$T,r$U,r$o];r$Y[3]=r$V.toRadian(r$l),r$Y[4]=r$V.toRadian(r$M),this._saveToCmd(r$m._context._drawPie,r$Y)},r$S.drawPoly=function(r$S,r$Q,r$e,r$l,r$M,r$d){void 0===r$d&&(r$d=1);var r$T=0,r$U=!1;r$m.isWebGL&&(r$T=r$_.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(r$T),r$U=!(6<r$e.length));var r$i=r$M?r$d%2==0?0:.5:0,r$R=[r$S+r$i,r$Q+r$i,r$e,r$l,r$M,r$d,r$T,r$U];this._saveToCmd(r$m._context._drawPoly,r$R)},r$S.drawPath=function(r$S,r$Q,r$e,r$l,r$M){var r$d=[r$S,r$Q,r$e,r$l,r$M];this._saveToCmd(r$m._context._drawPath,r$d)},r$L(0,r$S,"cmds",function(){return this._cmds},function(r$S){this._sp&&(this._sp._renderType|=512),this._cmds=r$S,this._render=this._renderAll,this._repaint()}),r$Y.__init__=function(){if(r$m.isConchNode){for(var r$S=laya.display.Graphics.prototype,r$Q=r$f.window.ConchGraphics.prototype,r$e=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],r$l=0,r$M=r$e.length;r$l<=r$M;r$l++){var r$d=r$e[r$l];r$S[r$d]=r$Q[r$d]}r$S._saveToCmd=null,r$Q.drawImageS&&(r$S.drawTextures=function(r$S,r$Q){if(r$S&&r$S.loaded&&r$S.bitmap&&r$S.source){var r$e=r$S.uv,r$l=r$S.bitmap.width,r$M=r$S.bitmap.height;this.drawImageS(r$S.bitmap.source,r$e[0]*r$l,r$e[1]*r$M,(r$e[2]-r$e[0])*r$l,(r$e[5]-r$e[3])*r$M,r$S.offsetX,r$S.offsetY,r$S.width,r$S.height,r$Q)}}),r$S.drawTexture=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){if(void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=0),void 0===r$M&&(r$M=0),void 0===r$T&&(r$T=1),r$S)if(r$S.loaded){if(r$S.loaded&&r$S.bitmap&&r$S.source&&(r$l||(r$l=r$S.sourceWidth),r$M||(r$M=r$S.sourceHeight),r$T=r$T<0?0:1<r$T?1:r$T,r$l=r$l-r$S.sourceWidth+r$S.width,r$M=r$M-r$S.sourceHeight+r$S.height,!(r$l<=0||r$M<=0))){r$Q+=r$S.offsetX,r$e+=r$S.offsetY;var r$U=r$S.uv,r$i=r$S.bitmap.width,r$R=r$S.bitmap.height;r$U[4]<r$U[0]&&r$U[5]<r$U[1]?this.drawImageM(r$S.bitmap.source,r$U[4]*r$i,r$U[5]*r$R,(r$U[0]-r$U[4])*r$i,(r$U[1]-r$U[5])*r$R,r$Q,r$e,r$l,r$M,r$d,r$T):this.drawImageM(r$S.bitmap.source,r$U[0]*r$i,r$U[1]*r$R,(r$U[2]-r$U[0])*r$i,(r$U[5]-r$U[3])*r$R,r$Q,r$e,r$l,r$M,r$d,r$T),this._repaint()}}else r$S.once("loaded",this,function(){this.drawTexture(r$S,r$Q,r$e,r$l,r$M,r$d)})},r$S.fillTexture=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){if(void 0===r$l&&(r$l=0),void 0===r$M&&(r$M=0),void 0===r$d&&(r$d="repeat"),r$S&&r$S.loaded){var r$U,r$i=r$m._context.ctx,r$R=r$S.bitmap.width,r$o=r$S.bitmap.height,r$Y=r$S.uv;r$U=r$S.uv!=r$oS.DEF_UV?r$i.createPattern(r$S.bitmap.source,r$d,r$Y[0]*r$R,r$Y[1]*r$o,(r$Y[2]-r$Y[0])*r$R,(r$Y[5]-r$Y[3])*r$o):r$i.createPattern(r$S.bitmap.source,r$d);var r$p=0,r$J=0;r$T&&(r$Q+=r$T.x%r$S.width,r$e+=r$T.y%r$S.height,r$p-=r$T.x%r$S.width,r$J-=r$T.y%r$S.height),this._fillImage(r$U,r$Q,r$e,r$p,r$J,r$l,r$M)}}}},r$Y._cache=[],r$Y}(),r$e=function(){function r$A(){this._cacheBoundsType=!1}r$o(r$A,"laya.display.GraphicsBounds");var r$S=r$A.prototype;return r$S.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},r$S.reset=function(){this._temp&&(this._temp.length=0)},r$S.getBounds=function(r$S){return void 0===r$S&&(r$S=!1),(!this._bounds||!this._temp||this._temp.length<1||r$S!=this._cacheBoundsType)&&(this._bounds=r$g._getWrapRec(this.getBoundPoints(r$S),this._bounds)),this._cacheBoundsType=r$S,this._bounds},r$S.getBoundPoints=function(r$S){return void 0===r$S&&(r$S=!1),(!this._temp||this._temp.length<1||r$S!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(r$S)),this._cacheBoundsType=r$S,this._rstBoundPoints=r$V.copyArray(this._rstBoundPoints,this._temp)},r$S._getCmdPoints=function(r$S){void 0===r$S&&(r$S=!1);var r$Q,r$e,r$l=r$m._context,r$M=this._graphics.cmds;if((r$Q=this._temp||(this._temp=[])).length=0,r$M||null==this._graphics._one||(r$A._tempCmds.length=0,r$A._tempCmds.push(this._graphics._one),r$M=r$A._tempCmds),!r$M)return r$Q;(r$e=r$A._tempMatrixArrays).length=0;var r$d=r$A._initMatrix;r$d.identity();for(var r$T,r$U,r$i=r$A._tempMatrix,r$R=NaN,r$o=NaN,r$Y=NaN,r$p=NaN,r$J=NaN,r$L=NaN,r$j=0,r$c=r$M.length;r$j<r$c;r$j++)if((r$T=r$M[r$j]).callee)switch(r$T.callee){case r$l._save:case 7:r$e.push(r$d),r$d=r$d.clone();break;case r$l._restore:case 8:r$d=r$e.pop();break;case r$l._scale:case 5:r$i.identity(),r$i.translate(-r$T[2],-r$T[3]),r$i.scale(r$T[0],r$T[1]),r$i.translate(r$T[2],r$T[3]),this._switchMatrix(r$d,r$i);break;case r$l._rotate:case 3:r$i.identity(),r$i.translate(-r$T[1],-r$T[2]),r$i.rotate(r$T[0]),r$i.translate(r$T[1],r$T[2]),this._switchMatrix(r$d,r$i);break;case r$l._translate:case 6:r$i.identity(),r$i.translate(r$T[0],r$T[1]),this._switchMatrix(r$d,r$i);break;case r$l._transform:case 4:r$i.identity(),r$i.translate(-r$T[1],-r$T[2]),r$i.concat(r$T[0]),r$i.translate(r$T[1],r$T[2]),this._switchMatrix(r$d,r$i);break;case 16:case 24:r$A._addPointArrToRst(r$Q,r$g._getBoundPointS(r$T[0],r$T[1],r$T[2],r$T[3]),r$d);break;case 17:r$d.copyTo(r$i),r$i.concat(r$T[4]),r$A._addPointArrToRst(r$Q,r$g._getBoundPointS(r$T[0],r$T[1],r$T[2],r$T[3]),r$i);break;case r$l._drawTexture:r$U=r$T[0],r$S?r$T[3]&&r$T[4]?r$A._addPointArrToRst(r$Q,r$g._getBoundPointS(r$T[1],r$T[2],r$T[3],r$T[4]),r$d):(r$U=r$T[0],r$A._addPointArrToRst(r$Q,r$g._getBoundPointS(r$T[1],r$T[2],r$U.width,r$U.height),r$d)):(r$R=(r$T[3]||r$U.sourceWidth)/r$U.width,r$o=(r$T[4]||r$U.sourceHeight)/r$U.height,r$Y=r$R*r$U.sourceWidth,r$p=r$o*r$U.sourceHeight,r$J=0<r$U.offsetX?r$U.offsetX:0,r$L=0<r$U.offsetY?r$U.offsetY:0,r$J*=r$R,r$L*=r$o,r$A._addPointArrToRst(r$Q,r$g._getBoundPointS(r$T[1]-r$J,r$T[2]-r$L,r$Y,r$p),r$d));break;case r$l._fillTexture:r$T[3]&&r$T[4]?r$A._addPointArrToRst(r$Q,r$g._getBoundPointS(r$T[1],r$T[2],r$T[3],r$T[4]),r$d):(r$U=r$T[0],r$A._addPointArrToRst(r$Q,r$g._getBoundPointS(r$T[1],r$T[2],r$U.width,r$U.height),r$d));break;case r$l._drawTextureWithTransform:var r$G;r$G=r$T[5]?(r$d.copyTo(r$i),r$i.concat(r$T[5]),r$i):r$d,r$S?r$T[3]&&r$T[4]?r$A._addPointArrToRst(r$Q,r$g._getBoundPointS(r$T[1],r$T[2],r$T[3],r$T[4]),r$G):(r$U=r$T[0],r$A._addPointArrToRst(r$Q,r$g._getBoundPointS(r$T[1],r$T[2],r$U.width,r$U.height),r$G)):(r$U=r$T[0],r$R=(r$T[3]||r$U.sourceWidth)/r$U.width,r$o=(r$T[4]||r$U.sourceHeight)/r$U.height,r$Y=r$R*r$U.sourceWidth,r$p=r$o*r$U.sourceHeight,r$J=0<r$U.offsetX?r$U.offsetX:0,r$L=0<r$U.offsetY?r$U.offsetY:0,r$J*=r$R,r$L*=r$o,r$A._addPointArrToRst(r$Q,r$g._getBoundPointS(r$T[1]-r$J,r$T[2]-r$L,r$Y,r$p),r$G));break;case r$l._drawRect:case 13:r$A._addPointArrToRst(r$Q,r$g._getBoundPointS(r$T[0],r$T[1],r$T[2],r$T[3]),r$d);break;case r$l._drawCircle:case r$l._fillCircle:case 14:r$A._addPointArrToRst(r$Q,r$g._getBoundPointS(r$T[0]-r$T[2],r$T[1]-r$T[2],r$T[2]+r$T[2],r$T[2]+r$T[2]),r$d);break;case r$l._drawLine:case 20:r$A._tempPoints.length=0;var r$z;r$z=.5*r$T[5],r$T[0]==r$T[2]?r$A._tempPoints.push(r$T[0]+r$z,r$T[1],r$T[2]+r$z,r$T[3],r$T[0]-r$z,r$T[1],r$T[2]-r$z,r$T[3]):r$T[1]==r$T[3]?r$A._tempPoints.push(r$T[0],r$T[1]+r$z,r$T[2],r$T[3]+r$z,r$T[0],r$T[1]-r$z,r$T[2],r$T[3]-r$z):r$A._tempPoints.push(r$T[0],r$T[1],r$T[2],r$T[3]),r$A._addPointArrToRst(r$Q,r$A._tempPoints,r$d);break;case r$l._drawCurves:case 22:r$A._addPointArrToRst(r$Q,r$v.I.getBezierPoints(r$T[2]),r$d,r$T[0],r$T[1]);break;case r$l._drawPoly:case r$l._drawLines:case 18:r$A._addPointArrToRst(r$Q,r$T[2],r$d,r$T[0],r$T[1]);break;case r$l._drawPath:case 19:r$A._addPointArrToRst(r$Q,this._getPathPoints(r$T[2]),r$d,r$T[0],r$T[1]);break;case r$l._drawPie:case 15:r$A._addPointArrToRst(r$Q,this._getPiePoints(r$T[0],r$T[1],r$T[2],r$T[3],r$T[4]),r$d)}return 200<r$Q.length?r$Q=r$V.copyArray(r$Q,r$g._getWrapRec(r$Q)._getBoundPoints()):8<r$Q.length&&(r$Q=r$D.scanPList(r$Q)),r$Q},r$S._switchMatrix=function(r$S,r$Q){r$Q.concat(r$S),r$Q.copyTo(r$S)},r$S._getPiePoints=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$A._tempPoints;r$A._tempPoints.length=0,r$d.push(r$S,r$Q);var r$T=(r$M-r$l)%(2*Math.PI)/10,r$U=NaN,r$i=r$l;for(r$U=0;r$U<=10;r$U++)r$d.push(r$S+r$e*Math.cos(r$i),r$Q+r$e*Math.sin(r$i)),r$i+=r$T;return r$d},r$S._getPathPoints=function(r$S){var r$Q,r$e,r$l=0,r$M=r$A._tempPoints;for(r$M.length=0,r$Q=r$S.length,r$l=0;r$l<r$Q;r$l++)1<(r$e=r$S[r$l]).length&&(r$M.push(r$e[1],r$e[2]),3<r$e.length&&r$M.push(r$e[3],r$e[4]));return r$M},r$A._addPointArrToRst=function(r$S,r$Q,r$e,r$l,r$M){void 0===r$l&&(r$l=0),void 0===r$M&&(r$M=0);var r$d,r$T=0;for(r$d=r$Q.length,r$T=0;r$T<r$d;r$T+=2)r$A._addPointToRst(r$S,r$Q[r$T]+r$l,r$Q[r$T+1]+r$M,r$e)},r$A._addPointToRst=function(r$S,r$Q,r$e,r$l){var r$M=r$H.TEMP;r$M.setTo(r$Q||0,r$e||0),r$l.transformPoint(r$M),r$S.push(r$M.x,r$M.y)},r$A._tempPoints=[],r$A._tempMatrixArrays=[],r$A._tempCmds=[],r$i(r$A,["_tempMatrix",function(){return this._tempMatrix=new r$X},"_initMatrix",function(){return this._initMatrix=new r$X}]),r$A}(),r$d=function(){function r$S(){}r$o(r$S,"laya.events.Event");var r$Q=r$S.prototype;return r$Q.setTo=function(r$S,r$Q,r$e){return this.type=r$S,this.currentTarget=r$Q,this.target=r$e,this},r$Q.stopPropagation=function(){this._stoped=!0},r$L(0,r$Q,"stageY",function(){return r$O.stage.mouseY}),r$L(0,r$Q,"charCode",function(){return this.nativeEvent.charCode}),r$L(0,r$Q,"touches",function(){var r$S=this.nativeEvent.touches;if(r$S)for(var r$Q=r$O.stage,r$e=0,r$l=r$S.length;r$e<r$l;r$e++){var r$M=r$S[r$e],r$d=r$H.TEMP;r$d.setTo(r$M.clientX,r$M.clientY),r$Q._canvasTransform.invertTransformPoint(r$d),r$Q.transform.invertTransformPoint(r$d),r$M.stageX=r$d.x,r$M.stageY=r$d.y}return r$S}),r$L(0,r$Q,"keyLocation",function(){return this.nativeEvent.keyLocation}),r$L(0,r$Q,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),r$L(0,r$Q,"altKey",function(){return this.nativeEvent.altKey}),r$L(0,r$Q,"shiftKey",function(){return this.nativeEvent.shiftKey}),r$L(0,r$Q,"stageX",function(){return r$O.stage.mouseX}),r$S.EMPTY=new r$S,r$S.MOUSE_DOWN="mousedown",r$S.MOUSE_UP="mouseup",r$S.CLICK="click",r$S.RIGHT_MOUSE_DOWN="rightmousedown",r$S.RIGHT_MOUSE_UP="rightmouseup",r$S.RIGHT_CLICK="rightclick",r$S.MOUSE_MOVE="mousemove",r$S.MOUSE_OVER="mouseover",r$S.MOUSE_OUT="mouseout",r$S.MOUSE_WHEEL="mousewheel",r$S.ROLL_OVER="mouseover",r$S.ROLL_OUT="mouseout",r$S.DOUBLE_CLICK="doubleclick",r$S.CHANGE="change",r$S.CHANGED="changed",r$S.RESIZE="resize",r$S.ADDED="added",r$S.REMOVED="removed",r$S.DISPLAY="display",r$S.UNDISPLAY="undisplay",r$S.ERROR="error",r$S.COMPLETE="complete",r$S.LOADED="loaded",r$S.INITED="inited",r$S.PROGRESS="progress",r$S.INPUT="input",r$S.RENDER="render",r$S.OPEN="open",r$S.MESSAGE="message",r$S.CLOSE="close",r$S.KEY_DOWN="keydown",r$S.KEY_PRESS="keypress",r$S.KEY_UP="keyup",r$S.FRAME="enterframe",r$S.DRAG_START="dragstart",r$S.DRAG_MOVE="dragmove",r$S.DRAG_END="dragend",r$S.ENTER="enter",r$S.SELECT="select",r$S.BLUR="blur",r$S.FOCUS="focus",r$S.VISIBILITY_CHANGE="visibilitychange",r$S.FOCUS_CHANGE="focuschange",r$S.PLAYED="played",r$S.PAUSED="paused",r$S.STOPPED="stopped",r$S.START="start",r$S.END="end",r$S.ENABLE_CHANGED="enablechanged",r$S.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",r$S.COMPONENT_ADDED="componentadded",r$S.COMPONENT_REMOVED="componentremoved",r$S.LAYER_CHANGED="layerchanged",r$S.HIERARCHY_LOADED="hierarchyloaded",r$S.RECOVERED="recovered",r$S.RELEASED="released",r$S.LINK="link",r$S.LABEL="label",r$S.FULL_SCREEN_CHANGE="fullscreenchange",r$S.DEVICE_LOST="devicelost",r$S.MESH_CHANGED="meshchanged",r$S.MATERIAL_CHANGED="materialchanged",r$S.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",r$S.ANIMATION_CHANGED="animationchanged",r$S.TRIGGER_ENTER="triggerenter",r$S.TRIGGER_STAY="triggerstay",r$S.TRIGGER_EXIT="triggerexit",r$S.TRAIL_FILTER_CHANGE="trailfilterchange",r$S.DOMINO_FILTER_CHANGE="dominofilterchange",r$S}(),r$Y=(function(){function r$S(){}r$o(r$S,"laya.events.Keyboard"),r$S.NUMBER_0=48,r$S.NUMBER_1=49,r$S.NUMBER_2=50,r$S.NUMBER_3=51,r$S.NUMBER_4=52,r$S.NUMBER_5=53,r$S.NUMBER_6=54,r$S.NUMBER_7=55,r$S.NUMBER_8=56,r$S.NUMBER_9=57,r$S.A=65,r$S.B=66,r$S.C=67,r$S.D=68,r$S.E=69,r$S.F=70,r$S.G=71,r$S.H=72,r$S.I=73,r$S.J=74,r$S.K=75,r$S.L=76,r$S.M=77,r$S.N=78,r$S.O=79,r$S.P=80,r$S.Q=81,r$S.R=82,r$S.S=83,r$S.T=84,r$S.U=85,r$S.V=86,r$S.W=87,r$S.X=88,r$S.Y=89,r$S.Z=90,r$S.F1=112,r$S.F2=113,r$S.F3=114,r$S.F4=115,r$S.F5=116,r$S.F6=117,r$S.F7=118,r$S.F8=119,r$S.F9=120,r$S.F10=121,r$S.F11=122,r$S.F12=123,r$S.F13=124,r$S.F14=125,r$S.F15=126,r$S.NUMPAD=21,r$S.NUMPAD_0=96,r$S.NUMPAD_1=97,r$S.NUMPAD_2=98,r$S.NUMPAD_3=99,r$S.NUMPAD_4=100,r$S.NUMPAD_5=101,r$S.NUMPAD_6=102,r$S.NUMPAD_7=103,r$S.NUMPAD_8=104,r$S.NUMPAD_9=105,r$S.NUMPAD_ADD=107,r$S.NUMPAD_DECIMAL=110,r$S.NUMPAD_DIVIDE=111,r$S.NUMPAD_ENTER=108,r$S.NUMPAD_MULTIPLY=106,r$S.NUMPAD_SUBTRACT=109,r$S.SEMICOLON=186,r$S.EQUAL=187,r$S.COMMA=188,r$S.MINUS=189,r$S.PERIOD=190,r$S.SLASH=191,r$S.BACKQUOTE=192,r$S.LEFTBRACKET=219,r$S.BACKSLASH=220,r$S.RIGHTBRACKET=221,r$S.QUOTE=222,r$S.ALTERNATE=18,r$S.BACKSPACE=8,r$S.CAPS_LOCK=20,r$S.COMMAND=15,r$S.CONTROL=17,r$S.DELETE=46,r$S.ENTER=13,r$S.ESCAPE=27,r$S.PAGE_UP=33,r$S.PAGE_DOWN=34,r$S.END=35,r$S.HOME=36,r$S.LEFT=37,r$S.UP=38,r$S.RIGHT=39,r$S.DOWN=40,r$S.SHIFT=16,r$S.SPACE=32,r$S.TAB=9,r$S.INSERT=45}(),function(){function r$M(){}return r$o(r$M,"laya.events.KeyBoardManager"),r$M.__init__=function(){r$M._addEvent("keydown"),r$M._addEvent("keypress"),r$M._addEvent("keyup")},r$M._addEvent=function(r$Q){r$f.document.addEventListener(r$Q,function(r$S){laya.events.KeyBoardManager._dispatch(r$S,r$Q)},!0)},r$M._dispatch=function(r$S,r$Q){if(r$M.enabled){r$M._event._stoped=!1,r$M._event.nativeEvent=r$S,r$M._event.keyCode=r$S.keyCode||r$S.which||r$S.charCode,"keydown"===r$Q?r$M._pressKeys[r$M._event.keyCode]=!0:"keyup"===r$Q&&(r$M._pressKeys[r$M._event.keyCode]=null);for(var r$e=r$O.stage.focus&&null!=r$O.stage.focus.event&&r$O.stage.focus.displayedInStage?r$O.stage.focus:r$O.stage,r$l=r$e;r$l;)r$l.event(r$Q,r$M._event.setTo(r$Q,r$l,r$e)),r$l=r$l.parent}},r$M.hasKeyDown=function(r$S){return r$M._pressKeys[r$S]},r$M._pressKeys={},r$M.enabled=!0,r$i(r$M,["_event",function(){return this._event=new r$d}]),r$M}()),r$j=(function(){function r$S(){}r$o(r$S,"laya.events.KeyLocation"),r$S.STANDARD=0,r$S.LEFT=1,r$S.RIGHT=2,r$S.NUM_PAD=3}(),function(){function r$R(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=r$f.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new r$d,this._matrix=new r$X,this._point=new r$H,this._rect=new r$g,this._prePoint=new r$H,this._curTouchID=NaN}r$o(r$R,"laya.events.MouseManager");var r$S=r$R.prototype;return r$S.__init__=function(r$S,r$Q){var r$e=this;this._stage=r$S;var r$l=this,r$M=this._eventList;r$Q.oncontextmenu=function(r$S){if(r$R.enabled)return!1},r$Q.addEventListener("mousedown",function(r$S){r$R.enabled&&(r$f.onIE||r$S.preventDefault(),r$M.push(r$S),r$l.mouseDownTime=r$f.now())}),r$Q.addEventListener("mouseup",function(r$S){r$R.enabled&&(r$S.preventDefault(),r$M.push(r$S),r$l.mouseDownTime=-r$f.now())},!0),r$Q.addEventListener("mousemove",function(r$S){if(r$R.enabled){r$S.preventDefault();var r$Q=r$f.now();if(r$Q-r$l._lastMoveTimer<10)return;r$l._lastMoveTimer=r$Q,r$M.push(r$S)}},!0),r$Q.addEventListener("mouseout",function(r$S){r$R.enabled&&r$M.push(r$S)}),r$Q.addEventListener("mouseover",function(r$S){r$R.enabled&&r$M.push(r$S)}),r$Q.addEventListener("touchstart",function(r$S){r$R.enabled&&(r$M.push(r$S),r$R._isFirstTouch||r$DS.isInputting||r$S.preventDefault(),r$l.mouseDownTime=r$f.now())}),r$Q.addEventListener("touchend",function(r$S){r$R.enabled?(r$R._isFirstTouch||r$DS.isInputting||r$S.preventDefault(),r$R._isFirstTouch=!1,r$M.push(r$S),r$l.mouseDownTime=-r$f.now()):r$e._curTouchID=NaN},!0),r$Q.addEventListener("touchmove",function(r$S){r$R.enabled&&(r$S.preventDefault(),r$M.push(r$S))},!0),r$Q.addEventListener("touchcancel",function(r$S){r$R.enabled?(r$S.preventDefault(),r$M.push(r$S)):r$e._curTouchID=NaN},!0),r$Q.addEventListener("mousewheel",function(r$S){r$R.enabled&&r$M.push(r$S)}),r$Q.addEventListener("DOMMouseScroll",function(r$S){r$R.enabled&&r$M.push(r$S)})},r$S.initEvent=function(r$S,r$Q){var r$e;this._event._stoped=!1,this._event.nativeEvent=r$Q||r$S,this._target=null,this._point.setTo(r$S.pageX||r$S.clientX,r$S.pageY||r$S.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=r$S.identifier||0,this._tTouchID=this._event.touchId,(r$e=r$c.I._event)._stoped=!1,r$e.nativeEvent=this._event.nativeEvent,r$e.touchId=this._event.touchId},r$S.checkMouseWheel=function(r$S){this._event.delta=r$S.wheelDelta?.025*r$S.wheelDelta:-r$S.detail;for(var r$Q=r$c.I.getLastOvers(),r$e=0,r$l=r$Q.length;r$e<r$l;r$e++){var r$M=r$Q[r$e];r$M.event("mousewheel",this._event.setTo("mousewheel",r$M,this._target))}},r$S.onMouseMove=function(r$S){r$c.I.onMouseMove(r$S,this._tTouchID)},r$S.onMouseDown=function(r$S){if(r$DS.isInputting&&r$O.stage.focus&&r$O.stage.focus.focus&&!r$O.stage.focus.contains(this._target)){var r$Q=r$O.stage.focus._tf||r$O.stage.focus,r$e=r$S._tf||r$S;r$e instanceof laya.display.Input&&r$e.multiline==r$Q.multiline?r$Q._focusOut():r$Q.focus=!1}r$c.I.onMouseDown(r$S,this._tTouchID,this._isLeftMouse)},r$S.onMouseUp=function(r$S){r$c.I.onMouseUp(r$S,this._tTouchID,this._isLeftMouse)},r$S.check=function(r$S,r$Q,r$e,r$l){this._point.setTo(r$Q,r$e),r$S.fromParentPoint(this._point),r$Q=this._point.x,r$e=this._point.y;var r$M=r$S.scrollRect;if(r$M&&(this._rect.setTo(r$M.x,r$M.y,r$M.width,r$M.height),!this._rect.contains(r$Q,r$e)))return!1;if(!this.disableMouseEvent){if(r$S.hitTestPrior&&!r$S.mouseThrough&&!this.hitTest(r$S,r$Q,r$e))return!1;for(var r$d=r$S._childs.length-1;-1<r$d;r$d--){var r$T=r$S._childs[r$d];if(!r$T.destroyed&&r$T.mouseEnabled&&r$T.visible&&this.check(r$T,r$Q,r$e,r$l))return!0}}var r$U=!(!r$S.hitTestPrior||r$S.mouseThrough||this.disableMouseEvent)||this.hitTest(r$S,r$Q,r$e);return r$U?(this._target=r$S,r$l.call(this,r$S)):r$l===this.onMouseUp&&r$S===this._stage&&(this._target=this._stage,r$l.call(this,this._target)),r$U},r$S.hitTest=function(r$S,r$Q,r$e){var r$l=!1;if(r$S.scrollRect&&(r$Q-=r$S.scrollRect.x,r$e-=r$S.scrollRect.y),r$S.hitArea instanceof laya.utils.HitArea)return r$S.hitArea.isHit(r$Q,r$e);if(0<r$S.width&&0<r$S.height||r$S.mouseThrough||r$S.hitArea)if(r$S.mouseThrough)r$l=r$S.getGraphicBounds().contains(r$Q,r$e);else{var r$M=this._rect;r$S.hitArea?r$M=r$S.hitArea:r$M.setTo(0,0,r$S.width,r$S.height),r$l=r$M.contains(r$Q,r$e)}return r$l},r$S.runEvent=function(){var r$S=this._eventList.length;if(r$S){this.mouseEventTime=r$f.now();var r$Q,r$e=0,r$l=0,r$M=0;try{for(;r$e<r$S;){var r$d=this._eventList[r$e];switch("mousemove"!==r$d.type&&(this._prePoint.x=this._prePoint.y=-1e6),r$d.type){case"mousedown":this._touchIDs[0]=this._id++,r$R._isTouchRespond?r$R._isTouchRespond=!1:(this._isLeftMouse=0===r$d.button,this.initEvent(r$d),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===r$d.button,this.initEvent(r$d),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-r$d.clientX)+Math.abs(this._prePoint.y-r$d.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=r$d.clientX,this._prePoint.y=r$d.clientY,this.initEvent(r$d),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":r$R._isTouchRespond=!0,this._isLeftMouse=!0;var r$T=r$d.changedTouches;for(r$l=0,r$M=r$T.length;r$l<r$M;r$l++)r$Q=r$T[r$l],(r$R.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=r$Q.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[r$Q.identifier]=this._id++,this.initEvent(r$Q,r$d),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":r$R._isTouchRespond=!0,this._isLeftMouse=!0;var r$U=r$d.changedTouches;for(r$l=0,r$M=r$U.length;r$l<r$M;r$l++)if(r$Q=r$U[r$l],r$R.multiTouchEnabled||r$Q.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(r$Q,r$d);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var r$i=r$d.changedTouches;for(r$l=0,r$M=r$i.length;r$l<r$M;r$l++)r$Q=r$i[r$l],(r$R.multiTouchEnabled||r$Q.identifier==this._curTouchID)&&(this.initEvent(r$Q,r$d),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(r$d);break;case"mouseout":r$c.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}r$e++}}catch(r$S){throw this._eventList.length=0,r$S}this._eventList.length=0}},r$R.enabled=!0,r$R.multiTouchEnabled=!0,r$R._isTouchRespond=!1,r$R._isFirstTouch=!0,r$i(r$R,["instance",function(){return this.instance=new r$R}]),r$R}()),r$c=function(){function r$L(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new r$d}r$o(r$L,"laya.events.TouchManager");var r$S=r$L.prototype;return r$S._clearTempArrs=function(){r$L._oldArr.length=0,r$L._newArr.length=0,r$L._tEleArr.length=0},r$S.getTouchFromArr=function(r$S,r$Q){var r$e,r$l,r$M=0;for(r$e=r$Q.length,r$M=0;r$M<r$e;r$M++)if((r$l=r$Q[r$M]).id==r$S)return r$l;return null},r$S.removeTouchFromArr=function(r$S,r$Q){var r$e=0;for(r$e=r$Q.length-1;0<=r$e;r$e--)r$Q[r$e].id==r$S&&r$Q.splice(r$e,1)},r$S.createTouchO=function(r$S,r$Q){var r$e;return(r$e=r$Z.getItem("TouchData")||{}).id=r$Q,r$e.tar=r$S,r$e},r$S.onMouseDown=function(r$S,r$Q,r$e){var r$l,r$M,r$d,r$T;(void 0===r$e&&(r$e=!1),this.enable)&&(r$l=this.getTouchFromArr(r$Q,this.preOvers),r$d=this.getEles(r$S,null,r$L._tEleArr),r$l?r$l.tar=r$S:(r$M=this.createTouchO(r$S,r$Q),this.preOvers.push(r$M)),r$f.onMobile&&this.sendEvents(r$d,"mouseover",r$Q),r$T=r$e?this.preDowns:this.preRightDowns,(r$l=this.getTouchFromArr(r$Q,r$T))?r$l.tar=r$S:(r$M=this.createTouchO(r$S,r$Q),r$T.push(r$M)),this.sendEvents(r$d,r$e?"mousedown":"rightmousedown",r$Q),this._clearTempArrs())},r$S.sendEvents=function(r$S,r$Q,r$e){void 0===r$e&&(r$e=0);var r$l,r$M,r$d,r$T=0;for(r$l=r$S.length,this._event._stoped=!1,r$M=r$S[0],r$T=0;r$T<r$l;r$T++){if((r$d=r$S[r$T]).destroyed)return;if(r$d.event(r$Q,this._event.setTo(r$Q,r$d,r$M)),this._event._stoped)break}},r$S.getEles=function(r$S,r$Q,r$e){for(r$e?r$e.length=0:r$e=[];r$S&&r$S!=r$Q;)r$e.push(r$S),r$S=r$S.parent;return r$e},r$S.checkMouseOutAndOverOfMove=function(r$S,r$Q,r$e){if(void 0===r$e&&(r$e=0),r$Q!=r$S){var r$l,r$M,r$d=0,r$T=0;if(r$Q.contains(r$S))r$M=this.getEles(r$S,r$Q,r$L._tEleArr),this.sendEvents(r$M,"mouseover",r$e);else if(r$S.contains(r$Q))r$M=this.getEles(r$Q,r$S,r$L._tEleArr),this.sendEvents(r$M,"mouseout",r$e);else{var r$U,r$i;(r$M=r$L._tEleArr).length=0,r$U=this.getEles(r$Q,null,r$L._oldArr),r$i=this.getEles(r$S,null,r$L._newArr),r$T=r$U.length;var r$R=0;for(r$d=0;r$d<r$T;r$d++){if(r$l=r$U[r$d],0<=(r$R=r$i.indexOf(r$l))){r$i.splice(r$R,r$i.length-r$R);break}r$M.push(r$l)}0<r$M.length&&this.sendEvents(r$M,"mouseout",r$e),0<r$i.length&&this.sendEvents(r$i,"mouseover",r$e)}}},r$S.onMouseMove=function(r$S,r$Q){var r$e,r$l;this.enable&&((r$e=this.getTouchFromArr(r$Q,this.preOvers))?(this.checkMouseOutAndOverOfMove(r$S,r$e.tar),r$e.tar=r$S,r$l=this.getEles(r$S,null,r$L._tEleArr)):(r$l=this.getEles(r$S,null,r$L._tEleArr),this.sendEvents(r$l,"mouseover",r$Q),this.preOvers.push(this.createTouchO(r$S,r$Q))),this.sendEvents(r$l,"mousemove",r$Q),this._clearTempArrs())},r$S.getLastOvers=function(){return(r$L._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,r$L._tEleArr):(r$L._tEleArr.push(r$O.stage),r$L._tEleArr)},r$S.stageMouseOut=function(){var r$S;r$S=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(r$S,"mouseout",0)},r$S.onMouseUp=function(r$S,r$Q,r$e){if(void 0===r$e&&(r$e=!1),this.enable){var r$l,r$M,r$d,r$T,r$U,r$i,r$R=0,r$o=0,r$Y=r$f.onMobile;if(r$M=this.getEles(r$S,null,r$L._tEleArr),this.sendEvents(r$M,r$e?"mouseup":"rightmouseup",r$Q),r$i=r$e?this.preDowns:this.preRightDowns,r$l=this.getTouchFromArr(r$Q,r$i)){var r$p,r$J=r$f.now();if(r$p=r$J-this._lastClickTime<300,this._lastClickTime=r$J,r$S==r$l.tar)r$U=r$M;else for(r$d=this.getEles(r$l.tar,null,r$L._oldArr),(r$U=r$L._newArr).length=0,r$o=r$d.length,r$R=0;r$R<r$o;r$R++)r$T=r$d[r$R],0<=r$M.indexOf(r$T)&&r$U.push(r$T);0<r$U.length&&this.sendEvents(r$U,r$e?"click":"rightclick",r$Q),r$e&&r$p&&this.sendEvents(r$U,"doubleclick",r$Q),this.removeTouchFromArr(r$Q,r$i),r$l.tar=null,r$Z.recover("TouchData",r$l)}else;(r$l=this.getTouchFromArr(r$Q,this.preOvers))&&r$Y&&((r$U=this.getEles(r$l.tar,null,r$U))&&0<r$U.length&&this.sendEvents(r$U,"mouseout",r$Q),this.removeTouchFromArr(r$Q,this.preOvers),r$l.tar=null,r$Z.recover("TouchData",r$l)),this._clearTempArrs()}},r$L._oldArr=[],r$L._newArr=[],r$L._tEleArr=[],r$i(r$L,["I",function(){return this.I=new r$L}]),r$L}(),r$G=function(){function r$S(){this._action=null}r$o(r$S,"laya.filters.Filter");var r$Q=r$S.prototype;return r$O.imps(r$Q,{"laya.filters.IFilter":!0}),r$Q.callNative=function(r$S){},r$L(0,r$Q,"type",function(){return-1}),r$L(0,r$Q,"action",function(){return this._action}),r$S.BLUR=16,r$S.COLOR=32,r$S.GLOW=8,r$S._filterStart=null,r$S._filterEnd=null,r$S._EndTarget=null,r$S._recycleScope=null,r$S._filter=null,r$S._useSrc=null,r$S._endSrc=null,r$S._useOut=null,r$S._endOut=null,r$S}(),r$A=function(){function r$S(){this.data=null}r$o(r$S,"laya.filters.ColorFilterAction");var r$Q=r$S.prototype;return r$O.imps(r$Q,{"laya.filters.IFilterAction":!0}),r$Q.apply=function(r$S){var r$Q=r$S.ctx.ctx,r$e=r$S.ctx.ctx.canvas;if(0==r$e.width||0==r$e.height)return r$e;for(var r$l,r$M=r$Q.getImageData(0,0,r$e.width,r$e.height),r$d=r$M.data,r$T=0,r$U=r$d.length;r$T<r$U;r$T+=4)r$l=this.getColor(r$d[r$T],r$d[r$T+1],r$d[r$T+2],r$d[r$T+3]),0!=r$d[r$T+3]&&(r$d[r$T]=r$l[0],r$d[r$T+1]=r$l[1],r$d[r$T+2]=r$l[2],r$d[r$T+3]=r$l[3]);return r$Q.putImageData(r$M,0,0),r$S},r$Q.getColor=function(r$S,r$Q,r$e,r$l){var r$M=[];if(this.data._mat&&this.data._alpha){var r$d=this.data._mat,r$T=this.data._alpha;r$M[0]=r$d[0]*r$S+r$d[1]*r$Q+r$d[2]*r$e+r$d[3]*r$l+r$T[0],r$M[1]=r$d[4]*r$S+r$d[5]*r$Q+r$d[6]*r$e+r$d[7]*r$l+r$T[1],r$M[2]=r$d[8]*r$S+r$d[9]*r$Q+r$d[10]*r$e+r$d[11]*r$l+r$T[2],r$M[3]=r$d[12]*r$S+r$d[13]*r$Q+r$d[14]*r$e+r$d[15]*r$l+r$T[3]}return r$M},r$S}(),r$v=(function(){function r$S(){}r$o(r$S,"laya.maths.Arith"),r$S.formatR=function(r$S){return r$S>Math.PI&&(r$S-=2*Math.PI),r$S<-Math.PI&&(r$S+=2*Math.PI),r$S},r$S.isPOT=function(r$S,r$Q){return 0<r$S&&0==(r$S&r$S-1)&&0<r$Q&&0==(r$Q&r$Q-1)},r$S.setMatToArray=function(r$S,r$Q){r$S.a,r$S.b,r$S.c,r$S.d,r$S.tx,r$S.ty,r$Q[0]=r$S.a,r$Q[1]=r$S.b,r$Q[4]=r$S.c,r$Q[5]=r$S.d,r$Q[12]=r$S.tx,r$Q[13]=r$S.ty}}(),function(){function r$S(){this._controlPoints=[new r$H,new r$H,new r$H],this._calFun=this.getPoint2}r$o(r$S,"laya.maths.Bezier");var r$Q=r$S.prototype;return r$Q._switchPoint=function(r$S,r$Q){var r$e=this._controlPoints.shift();r$e.setTo(r$S,r$Q),this._controlPoints.push(r$e)},r$Q.getPoint2=function(r$S,r$Q){var r$e=this._controlPoints[0],r$l=this._controlPoints[1],r$M=this._controlPoints[2],r$d=Math.pow(1-r$S,2)*r$e.x+2*r$S*(1-r$S)*r$l.x+Math.pow(r$S,2)*r$M.x,r$T=Math.pow(1-r$S,2)*r$e.y+2*r$S*(1-r$S)*r$l.y+Math.pow(r$S,2)*r$M.y;r$Q.push(r$d,r$T)},r$Q.getPoint3=function(r$S,r$Q){var r$e=this._controlPoints[0],r$l=this._controlPoints[1],r$M=this._controlPoints[2],r$d=this._controlPoints[3],r$T=Math.pow(1-r$S,3)*r$e.x+3*r$l.x*r$S*(1-r$S)*(1-r$S)+3*r$M.x*r$S*r$S*(1-r$S)+r$d.x*Math.pow(r$S,3),r$U=Math.pow(1-r$S,3)*r$e.y+3*r$l.y*r$S*(1-r$S)*(1-r$S)+3*r$M.y*r$S*r$S*(1-r$S)+r$d.y*Math.pow(r$S,3);r$Q.push(r$T,r$U)},r$Q.insertPoints=function(r$S,r$Q){var r$e,r$l=NaN;for(r$e=1/(r$S=0<r$S?r$S:5),r$l=0;r$l<=1;r$l+=r$e)this._calFun(r$l,r$Q)},r$Q.getBezierPoints=function(r$S,r$Q,r$e){void 0===r$Q&&(r$Q=5),void 0===r$e&&(r$e=2);var r$l,r$M,r$d=0;if((r$l=r$S.length)<2*(r$e+1))return[];switch(r$M=[],r$e){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=r$e;)this._controlPoints.push(new r$H);for(r$d=0;r$d<2*r$e;r$d+=2)this._switchPoint(r$S[r$d],r$S[r$d+1]);for(r$d=2*r$e;r$d<r$l;r$d+=2)this._switchPoint(r$S[r$d],r$S[r$d+1]),r$d/2%r$e==0&&this.insertPoints(r$Q,r$M);return r$M},r$i(r$S,["I",function(){return this.I=new r$S}]),r$S}()),r$D=function(){function r$R(){}return r$o(r$R,"laya.maths.GrahamScan"),r$R.multiply=function(r$S,r$Q,r$e){return(r$S.x-r$e.x)*(r$Q.y-r$e.y)-(r$Q.x-r$e.x)*(r$S.y-r$e.y)},r$R.dis=function(r$S,r$Q){return(r$S.x-r$Q.x)*(r$S.x-r$Q.x)+(r$S.y-r$Q.y)*(r$S.y-r$Q.y)},r$R._getPoints=function(r$S,r$Q,r$e){for(void 0===r$Q&&(r$Q=!1),r$R._mPointList||(r$R._mPointList=[]);r$R._mPointList.length<r$S;)r$R._mPointList.push(new r$H);return r$e||(r$e=[]),r$e.length=0,r$Q?r$R.getFrom(r$e,r$R._mPointList,r$S):r$R.getFromR(r$e,r$R._mPointList,r$S),r$e},r$R.getFrom=function(r$S,r$Q,r$e){var r$l=0;for(r$l=0;r$l<r$e;r$l++)r$S.push(r$Q[r$l]);return r$S},r$R.getFromR=function(r$S,r$Q,r$e){var r$l=0;for(r$l=0;r$l<r$e;r$l++)r$S.push(r$Q.pop());return r$S},r$R.pListToPointList=function(r$S,r$Q){void 0===r$Q&&(r$Q=!1);var r$e=0,r$l=r$S.length/2,r$M=r$R._getPoints(r$l,r$Q,r$R._tempPointList);for(r$e=0;r$e<r$l;r$e++)r$M[r$e].setTo(r$S[r$e+r$e],r$S[r$e+r$e+1]);return r$M},r$R.pointListToPlist=function(r$S){var r$Q,r$e=0,r$l=r$S.length,r$M=r$R._temPList;for(r$e=r$M.length=0;r$e<r$l;r$e++)r$Q=r$S[r$e],r$M.push(r$Q.x,r$Q.y);return r$M},r$R.scanPList=function(r$S){return r$V.copyArray(r$S,r$R.pointListToPlist(r$R.scan(r$R.pListToPointList(r$S,!0))))},r$R.scan=function(r$S){var r$Q,r$e,r$l,r$M=0,r$d=0,r$T=0,r$U=r$S.length,r$i={};for((r$e=r$R._temArr).length=0,r$M=(r$U=r$S.length)-1;0<=r$M;r$M--)r$l=(r$Q=r$S[r$M]).x+"_"+r$Q.y,r$i.hasOwnProperty(r$l)||(r$i[r$l]=!0,r$e.push(r$Q));for(r$U=r$e.length,r$V.copyArray(r$S,r$e),r$M=1;r$M<r$U;r$M++)(r$S[r$M].y<r$S[r$T].y||r$S[r$M].y==r$S[r$T].y&&r$S[r$M].x<r$S[r$T].x)&&(r$T=r$M);for(r$Q=r$S[0],r$S[0]=r$S[r$T],r$S[r$T]=r$Q,r$M=1;r$M<r$U-1;r$M++){for(r$d=(r$T=r$M)+1;r$d<r$U;r$d++)(0<r$R.multiply(r$S[r$d],r$S[r$T],r$S[0])||0==r$R.multiply(r$S[r$d],r$S[r$T],r$S[0])&&r$R.dis(r$S[0],r$S[r$d])<r$R.dis(r$S[0],r$S[r$T]))&&(r$T=r$d);r$Q=r$S[r$M],r$S[r$M]=r$S[r$T],r$S[r$T]=r$Q}if((r$e=r$R._temArr).length=0,r$S.length<3)return r$V.copyArray(r$e,r$S);for(r$e.push(r$S[0],r$S[1],r$S[2]),r$M=3;r$M<r$U;r$M++){for(;2<=r$e.length&&0<=r$R.multiply(r$S[r$M],r$e[r$e.length-1],r$e[r$e.length-2]);)r$e.pop();r$S[r$M]&&r$e.push(r$S[r$M])}return r$e},r$R._mPointList=null,r$R._tempPointList=[],r$R._temPList=[],r$R._temArr=[],r$R}(),r$B=function(){function r$M(){}return r$o(r$M,"laya.maths.MathUtil"),r$M.subtractVector3=function(r$S,r$Q,r$e){r$e[0]=r$S[0]-r$Q[0],r$e[1]=r$S[1]-r$Q[1],r$e[2]=r$S[2]-r$Q[2]},r$M.lerp=function(r$S,r$Q,r$e){return r$S*(1-r$e)+r$Q*r$e},r$M.scaleVector3=function(r$S,r$Q,r$e){r$e[0]=r$S[0]*r$Q,r$e[1]=r$S[1]*r$Q,r$e[2]=r$S[2]*r$Q},r$M.lerpVector3=function(r$S,r$Q,r$e,r$l){var r$M=r$S[0],r$d=r$S[1],r$T=r$S[2];r$l[0]=r$M+r$e*(r$Q[0]-r$M),r$l[1]=r$d+r$e*(r$Q[1]-r$d),r$l[2]=r$T+r$e*(r$Q[2]-r$T)},r$M.lerpVector4=function(r$S,r$Q,r$e,r$l){var r$M=r$S[0],r$d=r$S[1],r$T=r$S[2],r$U=r$S[3];r$l[0]=r$M+r$e*(r$Q[0]-r$M),r$l[1]=r$d+r$e*(r$Q[1]-r$d),r$l[2]=r$T+r$e*(r$Q[2]-r$T),r$l[3]=r$U+r$e*(r$Q[3]-r$U)},r$M.slerpQuaternionArray=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){var r$U,r$i,r$R,r$o,r$Y,r$p=r$S[r$Q+0],r$J=r$S[r$Q+1],r$L=r$S[r$Q+2],r$j=r$S[r$Q+3],r$c=r$e[r$l+0],r$G=r$e[r$l+1],r$z=r$e[r$l+2],r$A=r$e[r$l+3];return(r$i=r$p*r$c+r$J*r$G+r$L*r$z+r$j*r$A)<0&&(r$i=-r$i,r$c=-r$c,r$G=-r$G,r$z=-r$z,r$A=-r$A),r$Y=1e-6<1-r$i?(r$U=Math.acos(r$i),r$R=Math.sin(r$U),r$o=Math.sin((1-r$M)*r$U)/r$R,Math.sin(r$M*r$U)/r$R):(r$o=1-r$M,r$M),r$d[r$T+0]=r$o*r$p+r$Y*r$c,r$d[r$T+1]=r$o*r$J+r$Y*r$G,r$d[r$T+2]=r$o*r$L+r$Y*r$z,r$d[r$T+3]=r$o*r$j+r$Y*r$A,r$d},r$M.getRotation=function(r$S,r$Q,r$e,r$l){return Math.atan2(r$l-r$Q,r$e-r$S)/Math.PI*180},r$M.sortBigFirst=function(r$S,r$Q){return r$S==r$Q?0:r$S<r$Q?1:-1},r$M.sortSmallFirst=function(r$S,r$Q){return r$S==r$Q?0:r$S<r$Q?-1:1},r$M.sortNumBigFirst=function(r$S,r$Q){return parseFloat(r$Q)-parseFloat(r$S)},r$M.sortNumSmallFirst=function(r$S,r$Q){return parseFloat(r$S)-parseFloat(r$Q)},r$M.sortByKey=function(r$e,r$S,r$Q){var r$l;return void 0===r$S&&(r$S=!1),void 0===r$Q&&(r$Q=!0),r$l=r$S?r$Q?r$M.sortNumBigFirst:r$M.sortBigFirst:r$Q?r$M.sortNumSmallFirst:r$M.sortSmallFirst,function(r$S,r$Q){return r$l(r$S[r$e],r$Q[r$e])}},r$M}(),r$X=function(){function r$e(r$S,r$Q,r$e,r$l,r$M,r$d){this.inPool=!1,this.bTransform=!1,void 0===r$S&&(r$S=1),void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=1),void 0===r$M&&(r$M=0),void 0===r$d&&(r$d=0),this.a=r$S,this.b=r$Q,this.c=r$e,this.d=r$l,this.tx=r$M,this.ty=r$d,this._checkTransform()}r$o(r$e,"laya.maths.Matrix");var r$S=r$e.prototype;return r$S.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},r$S._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},r$S.setTranslate=function(r$S,r$Q){return this.tx=r$S,this.ty=r$Q,this},r$S.translate=function(r$S,r$Q){return this.tx+=r$S,this.ty+=r$Q,this},r$S.scale=function(r$S,r$Q){this.a*=r$S,this.d*=r$Q,this.c*=r$S,this.b*=r$Q,this.tx*=r$S,this.ty*=r$Q,this.bTransform=!0},r$S.rotate=function(r$S){var r$Q=Math.cos(r$S),r$e=Math.sin(r$S),r$l=this.a,r$M=this.c,r$d=this.tx;this.a=r$l*r$Q-this.b*r$e,this.b=r$l*r$e+this.b*r$Q,this.c=r$M*r$Q-this.d*r$e,this.d=r$M*r$e+this.d*r$Q,this.tx=r$d*r$Q-this.ty*r$e,this.ty=r$d*r$e+this.ty*r$Q,this.bTransform=!0},r$S.skew=function(r$S,r$Q){var r$e=Math.tan(r$S),r$l=Math.tan(r$Q),r$M=this.a,r$d=this.b;return this.a+=r$l*this.c,this.b+=r$l*this.d,this.c+=r$e*r$M,this.d+=r$e*r$d,this},r$S.invertTransformPoint=function(r$S){var r$Q=this.a,r$e=this.b,r$l=this.c,r$M=this.d,r$d=this.tx,r$T=r$Q*r$M-r$e*r$l,r$U=r$M/r$T,r$i=-r$e/r$T,r$R=-r$l/r$T,r$o=r$Q/r$T,r$Y=(r$l*this.ty-r$M*r$d)/r$T,r$p=-(r$Q*this.ty-r$e*r$d)/r$T;return r$S.setTo(r$U*r$S.x+r$R*r$S.y+r$Y,r$i*r$S.x+r$o*r$S.y+r$p)},r$S.transformPoint=function(r$S){return r$S.setTo(this.a*r$S.x+this.c*r$S.y+this.tx,this.b*r$S.x+this.d*r$S.y+this.ty)},r$S.transformPointN=function(r$S){return r$S.setTo(this.a*r$S.x+this.c*r$S.y,this.b*r$S.x+this.d*r$S.y)},r$S.transformPointArray=function(r$S,r$Q){for(var r$e=r$S.length,r$l=0;r$l<r$e;r$l+=2){var r$M=r$S[r$l],r$d=r$S[r$l+1];r$Q[r$l]=this.a*r$M+this.c*r$d+this.tx,r$Q[r$l+1]=this.b*r$M+this.d*r$d+this.ty}return r$Q},r$S.transformPointArrayScale=function(r$S,r$Q){for(var r$e=r$S.length,r$l=0;r$l<r$e;r$l+=2){var r$M=r$S[r$l],r$d=r$S[r$l+1];r$Q[r$l]=this.a*r$M+this.c*r$d,r$Q[r$l+1]=this.b*r$M+this.d*r$d}return r$Q},r$S.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},r$S.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},r$S.invert=function(){var r$S=this.a,r$Q=this.b,r$e=this.c,r$l=this.d,r$M=this.tx,r$d=r$S*r$l-r$Q*r$e;return this.a=r$l/r$d,this.b=-r$Q/r$d,this.c=-r$e/r$d,this.d=r$S/r$d,this.tx=(r$e*this.ty-r$l*r$M)/r$d,this.ty=-(r$S*this.ty-r$Q*r$M)/r$d,this},r$S.setTo=function(r$S,r$Q,r$e,r$l,r$M,r$d){return this.a=r$S,this.b=r$Q,this.c=r$e,this.d=r$l,this.tx=r$M,this.ty=r$d,this},r$S.concat=function(r$S){var r$Q=this.a,r$e=this.c,r$l=this.tx;return this.a=r$Q*r$S.a+this.b*r$S.c,this.b=r$Q*r$S.b+this.b*r$S.d,this.c=r$e*r$S.a+this.d*r$S.c,this.d=r$e*r$S.b+this.d*r$S.d,this.tx=r$l*r$S.a+this.ty*r$S.c+r$S.tx,this.ty=r$l*r$S.b+this.ty*r$S.d+r$S.ty,this},r$S.scaleEx=function(r$S,r$Q){var r$e=this.a,r$l=this.b,r$M=this.c,r$d=this.d;0!==r$l||0!==r$M?(this.a=r$S*r$e,this.b=r$S*r$l,this.c=r$Q*r$M):(this.a=r$S*r$e,this.b=0*r$d,this.c=0*r$e),this.d=r$Q*r$d,this.bTransform=!0},r$S.rotateEx=function(r$S){var r$Q=Math.cos(r$S),r$e=Math.sin(r$S),r$l=this.a,r$M=this.b,r$d=this.c,r$T=this.d;0!==r$M||0!==r$d?(this.a=r$Q*r$l+r$e*r$d,this.b=r$Q*r$M+r$e*r$T,this.c=-r$e*r$l+r$Q*r$d,this.d=-r$e*r$M+r$Q*r$T):(this.a=r$Q*r$l,this.b=r$e*r$T,this.c=-r$e*r$l,this.d=r$Q*r$T),this.bTransform=!0},r$S.clone=function(){var r$S=r$e.create();return r$S.a=this.a,r$S.b=this.b,r$S.c=this.c,r$S.d=this.d,r$S.tx=this.tx,r$S.ty=this.ty,r$S.bTransform=this.bTransform,r$S},r$S.copyTo=function(r$S){return r$S.a=this.a,r$S.b=this.b,r$S.c=this.c,r$S.d=this.d,r$S.tx=this.tx,r$S.ty=this.ty,r$S.bTransform=this.bTransform,r$S},r$S.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},r$S.destroy=function(){if(!this.inPool){var r$S=r$e._cache;this.inPool=!0,r$S._length||(r$S._length=0),(r$S[r$S._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},r$e.mul=function(r$S,r$Q,r$e){var r$l=r$S.a,r$M=r$S.b,r$d=r$S.c,r$T=r$S.d,r$U=r$S.tx,r$i=r$S.ty,r$R=r$Q.a,r$o=r$Q.b,r$Y=r$Q.c,r$p=r$Q.d,r$J=r$Q.tx,r$L=r$Q.ty;return 0!==r$o||0!==r$Y?(r$e.a=r$l*r$R+r$M*r$Y,r$e.b=r$l*r$o+r$M*r$p,r$e.c=r$d*r$R+r$T*r$Y,r$e.d=r$d*r$o+r$T*r$p,r$e.tx=r$R*r$U+r$Y*r$i+r$J,r$e.ty=r$o*r$U+r$p*r$i+r$L):(r$e.a=r$l*r$R,r$e.b=r$M*r$p,r$e.c=r$d*r$R,r$e.d=r$T*r$p,r$e.tx=r$R*r$U+r$J,r$e.ty=r$p*r$i+r$L),r$e},r$e.mul16=function(r$S,r$Q,r$e){var r$l=r$S.a,r$M=r$S.b,r$d=r$S.c,r$T=r$S.d,r$U=r$S.tx,r$i=r$S.ty,r$R=r$Q.a,r$o=r$Q.b,r$Y=r$Q.c,r$p=r$Q.d,r$J=r$Q.tx,r$L=r$Q.ty;return 0!==r$o||0!==r$Y?(r$e[0]=r$l*r$R+r$M*r$Y,r$e[1]=r$l*r$o+r$M*r$p,r$e[4]=r$d*r$R+r$T*r$Y,r$e[5]=r$d*r$o+r$T*r$p,r$e[12]=r$R*r$U+r$Y*r$i+r$J,r$e[13]=r$o*r$U+r$p*r$i+r$L):(r$e[0]=r$l*r$R,r$e[1]=r$M*r$p,r$e[4]=r$d*r$R,r$e[5]=r$T*r$p,r$e[12]=r$R*r$U+r$J,r$e[13]=r$p*r$i+r$L),r$e},r$e.mulPre=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){var r$i=r$S.a,r$R=r$S.b,r$o=r$S.c,r$Y=r$S.d,r$p=r$S.tx,r$J=r$S.ty;return 0!==r$e||0!==r$l?(r$U.a=r$i*r$Q+r$R*r$l,r$U.b=r$i*r$e+r$R*r$M,r$U.c=r$o*r$Q+r$Y*r$l,r$U.d=r$o*r$e+r$Y*r$M,r$U.tx=r$Q*r$p+r$l*r$J+r$d,r$U.ty=r$e*r$p+r$M*r$J+r$T):(r$U.a=r$i*r$Q,r$U.b=r$R*r$M,r$U.c=r$o*r$Q,r$U.d=r$Y*r$M,r$U.tx=r$Q*r$p+r$d,r$U.ty=r$M*r$J+r$T),r$U},r$e.mulPos=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){var r$i=r$S.a,r$R=r$S.b,r$o=r$S.c,r$Y=r$S.d,r$p=r$S.tx,r$J=r$S.ty;return 0!==r$R||0!==r$o?(r$U.a=r$Q*r$i+r$e*r$o,r$U.b=r$Q*r$R+r$e*r$Y,r$U.c=r$l*r$i+r$M*r$o,r$U.d=r$l*r$R+r$M*r$Y,r$U.tx=r$i*r$d+r$o*r$T+r$p,r$U.ty=r$R*r$d+r$Y*r$T+r$J):(r$U.a=r$Q*r$i,r$U.b=r$e*r$Y,r$U.c=r$l*r$i,r$U.d=r$M*r$Y,r$U.tx=r$i*r$d+r$p,r$U.ty=r$Y*r$T+r$J),r$U},r$e.preMul=function(r$S,r$Q,r$e){var r$l=r$S.a,r$M=r$S.b,r$d=r$S.c,r$T=r$S.d,r$U=r$Q.a,r$i=r$Q.b,r$R=r$Q.c,r$o=r$Q.d,r$Y=r$Q.tx,r$p=r$Q.ty;return r$e.a=r$U*r$l,r$e.b=r$e.c=0,r$e.d=r$o*r$T,r$e.tx=r$Y*r$l+r$S.tx,r$e.ty=r$p*r$T+r$S.ty,0===r$i&&0===r$R&&0===r$M&&0===r$d||(r$e.a+=r$i*r$d,r$e.d+=r$R*r$M,r$e.b+=r$U*r$M+r$i*r$T,r$e.c+=r$R*r$l+r$o*r$d,r$e.tx+=r$p*r$d,r$e.ty+=r$Y*r$M),r$e},r$e.preMulXY=function(r$S,r$Q,r$e,r$l){var r$M=r$S.a,r$d=r$S.b,r$T=r$S.c,r$U=r$S.d;return r$l.a=r$M,r$l.b=r$d,r$l.c=r$T,r$l.d=r$U,r$l.tx=r$Q*r$M+r$S.tx+r$e*r$T,r$l.ty=r$e*r$U+r$S.ty+r$Q*r$d,r$l},r$e.create=function(){var r$S=r$e._cache,r$Q=r$S._length?r$S[--r$S._length]:new r$e;return r$Q.inPool=!1,r$Q},r$e.EMPTY=new r$e,r$e.TEMP=new r$e,r$e._cache=[],r$e}(),r$H=function(){function r$S(r$S,r$Q){void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),this.x=r$S,this.y=r$Q}r$o(r$S,"laya.maths.Point");var r$Q=r$S.prototype;return r$Q.setTo=function(r$S,r$Q){return this.x=r$S,this.y=r$Q,this},r$Q.distance=function(r$S,r$Q){return Math.sqrt((this.x-r$S)*(this.x-r$S)+(this.y-r$Q)*(this.y-r$Q))},r$Q.toString=function(){return this.x+","+this.y},r$Q.normalize=function(){var r$S=Math.sqrt(this.x*this.x+this.y*this.y);if(0<r$S){var r$Q=1/r$S;this.x*=r$Q,this.y*=r$Q}},r$S.TEMP=new r$S,r$S.EMPTY=new r$S,r$S}(),r$g=function(){function r$R(r$S,r$Q,r$e,r$l){void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=0),this.x=r$S,this.y=r$Q,this.width=r$e,this.height=r$l}r$o(r$R,"laya.maths.Rectangle");var r$S=r$R.prototype;return r$S.setTo=function(r$S,r$Q,r$e,r$l){return this.x=r$S,this.y=r$Q,this.width=r$e,this.height=r$l,this},r$S.copyFrom=function(r$S){return this.x=r$S.x,this.y=r$S.y,this.width=r$S.width,this.height=r$S.height,this},r$S.contains=function(r$S,r$Q){return!(this.width<=0||this.height<=0)&&(r$S>=this.x&&r$S<this.right&&r$Q>=this.y&&r$Q<this.bottom)},r$S.intersects=function(r$S){return!(r$S.x>this.x+this.width||r$S.x+r$S.width<this.x||r$S.y>this.y+this.height||r$S.y+r$S.height<this.y)},r$S.intersection=function(r$S,r$Q){return this.intersects(r$S)?(r$Q||(r$Q=new r$R),r$Q.x=Math.max(this.x,r$S.x),r$Q.y=Math.max(this.y,r$S.y),r$Q.width=Math.min(this.right,r$S.right)-r$Q.x,r$Q.height=Math.min(this.bottom,r$S.bottom)-r$Q.y,r$Q):null},r$S.union=function(r$S,r$Q){return r$Q||(r$Q=new r$R),this.clone(r$Q),r$S.width<=0||r$S.height<=0?r$Q:(r$Q.addPoint(r$S.x,r$S.y),r$Q.addPoint(r$S.right,r$S.bottom),this)},r$S.clone=function(r$S){return r$S||(r$S=new r$R),r$S.x=this.x,r$S.y=this.y,r$S.width=this.width,r$S.height=this.height,r$S},r$S.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},r$S.equals=function(r$S){return!(!r$S||r$S.x!==this.x||r$S.y!==this.y||r$S.width!==this.width||r$S.height!==this.height)},r$S.addPoint=function(r$S,r$Q){return this.x>r$S&&(this.width+=this.x-r$S,this.x=r$S),this.y>r$Q&&(this.height+=this.y-r$Q,this.y=r$Q),this.width<r$S-this.x&&(this.width=r$S-this.x),this.height<r$Q-this.y&&(this.height=r$Q-this.y),this},r$S._getBoundPoints=function(){var r$S=r$R._temB;return(r$S.length=0)==this.width||0==this.height||r$S.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),r$S},r$S.isEmpty=function(){return this.width<=0||this.height<=0},r$L(0,r$S,"right",function(){return this.x+this.width}),r$L(0,r$S,"bottom",function(){return this.y+this.height}),r$R._getBoundPointS=function(r$S,r$Q,r$e,r$l){var r$M=r$R._temA;return(r$M.length=0)==r$e||0==r$l||r$M.push(r$S,r$Q,r$S+r$e,r$Q,r$S,r$Q+r$l,r$S+r$e,r$Q+r$l),r$M},r$R._getWrapRec=function(r$S,r$Q){if(!r$S||r$S.length<1)return r$Q?r$Q.setTo(0,0,0,0):r$R.TEMP.setTo(0,0,0,0);r$Q=r$Q||new r$R;var r$e,r$l,r$M,r$d,r$T,r$U=r$S.length,r$i=r$H.TEMP;for(r$M=r$T=-(r$l=r$d=99999),r$e=0;r$e<r$U;r$e+=2)r$i.x=r$S[r$e],r$i.y=r$S[r$e+1],r$l=r$l<r$i.x?r$l:r$i.x,r$d=r$d<r$i.y?r$d:r$i.y,r$M=r$M>r$i.x?r$M:r$i.x,r$T=r$T>r$i.y?r$T:r$i.y;return r$Q.setTo(r$l,r$d,r$M-r$l,r$T-r$d)},r$R.EMPTY=new r$R,r$R.TEMP=new r$R,r$R._temB=[],r$R._temA=[],r$R}(),r$t=function(){function r$i(){}return r$o(r$i,"laya.media.SoundManager"),r$L(1,r$i,"useAudioMusic",function(){return r$i._useAudioMusic},function(r$S){r$i._useAudioMusic=r$S,r$i._musicClass=r$S?r$eS:null}),r$L(1,r$i,"autoStopMusic",function(){return r$i._autoStopMusic},function(r$S){r$O.stage.off("blur",null,r$i._stageOnBlur),r$O.stage.off("focus",null,r$i._stageOnFocus),r$O.stage.off("visibilitychange",null,r$i._visibilityChange),(r$i._autoStopMusic=r$S)&&(r$O.stage.on("blur",null,r$i._stageOnBlur),r$O.stage.on("focus",null,r$i._stageOnFocus),r$O.stage.on("visibilitychange",null,r$i._visibilityChange))}),r$L(1,r$i,"muted",function(){return r$i._muted},function(r$S){r$S!=r$i._muted&&(r$S&&r$i.stopAllSound(),r$i.musicMuted=r$S,r$i._muted=r$S)}),r$L(1,r$i,"musicMuted",function(){return r$i._musicMuted},function(r$S){r$S!=r$i._musicMuted&&(r$S?(r$i._tMusic&&r$i._musicChannel&&!r$i._musicChannel.isStopped?r$i._musicChannel.pause():r$i._musicChannel=null,r$i._musicMuted=r$S):(r$i._musicMuted=r$S,r$i._tMusic&&r$i._musicChannel&&r$i._musicChannel.resume()))}),r$L(1,r$i,"soundMuted",function(){return r$i._soundMuted},function(r$S){r$i._soundMuted=r$S}),r$i.addChannel=function(r$S){0<=r$i._channels.indexOf(r$S)||(r$i._channels.push(r$S),r$i.autoReleaseSound&&0!=r$i._notUsedCount&&r$i._notUsedUrls[r$S.url]&&(delete r$i._notUsedUrls[r$S.url],0==--r$i._notUsedCount&&r$O.timer.clear(r$i,r$i.disposeSoundIfNotUsed)))},r$i.removeChannel=function(r$S){var r$Q=r$i._channels,r$e=r$Q.indexOf(r$S);if(-1!=r$e&&(r$Q.splice(r$e,1),r$i.autoReleaseSound)){var r$l=r$S.url,r$M=r$i.defaultIntervals[r$l]||2e4;if(0<r$M){var r$d=!0;for(r$e=r$Q.length-1;0<=r$e;r$e--)if(r$Q[r$e].url==r$l){r$d=!1;break}r$d&&(r$i._notUsedUrls[r$l]=Date.now()+r$M,0==r$i._notUsedCount++&&r$O.timer.loop(1e4,r$i,r$i.disposeSoundIfNotUsed))}}},r$i.disposeSoundIfNotUsed=function(){var r$S=r$i._notUsedUrls;if(0!=r$i._notUsedCount){var r$Q=Date.now();for(var r$e in r$S)r$Q>=r$S[r$e]&&(delete r$S[r$e],--r$i._notUsedCount,r$i.destroySound(r$e));if(0!=r$i._notUsedCount)return}r$O.timer.clear(r$i,r$i.disposeSoundIfNotUsed)},r$i._visibilityChange=function(){r$O.stage.isVisibility?r$i._stageOnFocus():r$i._stageOnBlur()},r$i._stageOnBlur=function(){r$i._isActive=!1,r$i._musicChannel&&(r$i._musicChannel.isStopped||(r$i._blurPaused=!0,r$i._musicChannel.pause())),r$i.stopAllSound(),r$O.stage.once("mousedown",null,r$i._stageOnFocus)},r$i._recoverWebAudio=function(){r$dS.ctx&&"running"!=r$dS.ctx.state&&r$dS.ctx.resume&&r$dS.ctx.resume()},r$i._stageOnFocus=function(){if(r$i._isActive=!0,r$i._recoverWebAudio(),r$O.stage.off("mousedown",null,r$i._stageOnFocus),r$i._blurPaused){var r$S=r$i._musicChannel;r$S&&r$i._music&&r$S.isStopped&&(r$i._blurPaused=!1,r$i._music._disposed?r$i.playMusic(r$S.url,r$S.loops,r$S.startHandler,r$S.completeHandler,r$S.startTime):r$S.audioBuffer?r$S.resume():r$i._music.play(r$S.startTime,r$S.loops,r$S.startHandler,r$S))}},r$i.playSound=function(r$S,r$Q,r$e,r$l,r$M,r$d){if(void 0===r$Q&&(r$Q=1),void 0===r$d&&(r$d=0),!r$S)return null;if(r$i._muted)return null;if(r$i._recoverWebAudio(),r$S==r$i._tMusic){if(r$i._musicMuted)return null}else{if(!r$i._isActive)return null;if(r$i._soundMuted)return null}var r$T,r$U=r$i._pool[r$S];return r$M||(r$M=r$i._soundClass),r$U||((r$U=new r$M).load(r$S),r$i._pool[r$S]=r$U),(r$T=r$U.play(r$d,r$Q,r$e))?(r$S==r$i._tMusic&&(r$i._music=r$U,r$i._isActive||(r$i._blurPaused=!0,r$T.pause())),r$T.url=r$S,r$T.volume=r$S==r$i._tMusic?r$i.musicVolume:r$i.soundVolume,r$T.completeHandler=r$l,r$T):null},r$i.destroySound=function(r$S){var r$Q=r$i._pool[r$S];r$Q&&(delete r$i._pool[r$S],r$Q.dispose())},r$i.playMusic=function(r$S,r$Q,r$e,r$l,r$M){return void 0===r$Q&&(r$Q=0),void 0===r$M&&(r$M=0),r$i._tMusic=r$S,r$i._musicChannel&&r$i._musicChannel.stop(),r$i._musicChannel=r$i.playSound(r$S,r$Q,r$e,r$l,null,r$M)},r$i.stopSound=function(r$S){for(var r$Q,r$e=r$i._channels.length-1;0<=r$e;r$e--)(r$Q=r$i._channels[r$e]).url==r$S&&r$Q.stop()},r$i.stopAll=function(){r$i._tMusic=null;var r$S=0;for(r$S=r$i._channels.length-1;0<=r$S;r$S--)r$i._channels[r$S].stop()},r$i.stopAllSound=function(){var r$S,r$Q=0;for(r$Q=r$i._channels.length-1;0<=r$Q;r$Q--)(r$S=r$i._channels[r$Q]).url!=r$i._tMusic&&r$S.stop()},r$i.stopMusic=function(){r$i._musicChannel&&r$i._musicChannel.stop(),r$i._tMusic=null},r$i.setSoundVolume=function(r$S,r$Q){if(r$Q)r$i._setVolume(r$Q,r$S);else{r$i.soundVolume=r$S;var r$e,r$l=0;for(r$l=r$i._channels.length-1;0<=r$l;r$l--)(r$e=r$i._channels[r$l]).url!=r$i._tMusic&&(r$e.volume=r$S)}},r$i.setMusicVolume=function(r$S){r$i.musicVolume=r$S,r$i._setVolume(r$i._tMusic,r$S)},r$i._setVolume=function(r$S,r$Q){for(var r$e,r$l=r$i._channels.length-1;0<=r$l;r$l--)(r$e=r$i._channels[r$l]).url==r$S&&(r$e.volume=r$Q)},r$i.musicVolume=1,r$i.soundVolume=1,r$i.playbackRate=1,r$i._useAudioMusic=!0,r$i._muted=!1,r$i._soundMuted=!1,r$i._musicMuted=!1,r$i._tMusic=null,r$i._musicChannel=null,r$i._music=null,r$i._channels=[],r$i._autoStopMusic=!1,r$i._blurPaused=!1,r$i._isActive=!0,r$i._soundClass=null,r$i._musicClass=null,r$i.autoReleaseSound=!0,r$i._pool={},r$i.defaultIntervals={},r$i._notUsedUrls={},r$i._notUsedCount=0,r$i}(),r$I=function(){var r$S;function r$e(){}return r$o(r$e,"laya.net.LocalStorage"),r$e.__init__=function(){r$e._baseClass||(r$e._baseClass=r$S).init(),r$e.items=r$e._baseClass.items,r$e.support=r$e._baseClass.support},r$e.setItem=function(r$S,r$Q){r$e._baseClass.setItem(r$S,r$Q)},r$e.getItem=function(r$S){return r$e._baseClass.getItem(r$S)},r$e.setJSON=function(r$S,r$Q){r$e._baseClass.setJSON(r$S,r$Q)},r$e.getJSON=function(r$S){return r$e._baseClass.getJSON(r$S)},r$e.removeItem=function(r$S){r$e._baseClass.removeItem(r$S)},r$e.clear=function(){r$e._baseClass.clear()},r$e._baseClass=null,r$e.items=null,r$e.support=!1,r$e.__init$=function(){r$S=function(){function r$e(){}return r$o(r$e,""),r$e.init=function(){try{r$e.support=!0,r$e.items=r$T.localStorage,r$e.setItem("laya","1"),r$e.removeItem("laya")}catch(r$S){r$e.support=!1}r$e.support||console.log("LocalStorage is not supprot or browser is private mode.")},r$e.setItem=function(r$S,r$Q){try{r$e.support&&r$e.items.setItem(r$S,r$Q)}catch(r$S){console.warn("set localStorage failed",r$S)}},r$e.getItem=function(r$S){return r$e.support?r$e.items.getItem(r$S):null},r$e.setJSON=function(r$S,r$Q){try{r$e.support&&r$e.items.setItem(r$S,JSON.stringify(r$Q))}catch(r$S){console.warn("set localStorage failed",r$S)}},r$e.getJSON=function(r$S){return JSON.parse(r$e.support?r$e.items.getItem(r$S):null)},r$e.removeItem=function(r$S){r$e.support&&r$e.items.removeItem(r$S)},r$e.clear=function(){r$e.support&&r$e.items.clear()},r$e.items=null,r$e.support=!1,r$e}()},r$e}(),r$h=(function(){function r$l(){}r$o(r$l,"laya.net.ResourceVersion"),r$l.enable=function(r$S,r$Q,r$e){void 0===r$e&&(r$e=2),laya.net.ResourceVersion.type=r$e,r$O.loader.load(r$S,r$z.create(null,r$l.onManifestLoaded,[r$Q]),null,"json"),r$b.customFormat=r$l.addVersionPrefix},r$l.onManifestLoaded=function(r$S,r$Q){r$l.manifest=r$Q,r$S.run(),r$Q||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},r$l.addVersionPrefix=function(r$S){return r$l.manifest&&r$l.manifest[r$S]?2==r$l.type?r$l.manifest[r$S]:r$l.manifest[r$S]+"/"+r$S:r$S},r$l.FOLDER_VERSION=1,r$l.FILENAME_VERSION=2,r$l.manifest=null,r$l.type=1}(),function(){function r$S(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}r$o(r$S,"laya.net.TTFLoader");var r$Q=r$S.prototype;return r$Q.load=function(r$S){var r$Q=(this._url=r$S).split(".ttf")[0].split("/");this.fontName=r$Q[r$Q.length-1],r$f.window.conch?this._loadConch():r$f.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},r$Q._loadConch=function(){this._http=new r$TS,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},r$Q._onHttpLoaded=function(r$S){r$f.window.conch.setFontFaceFromBuffer(this.fontName,r$S),this._clearHttp(),this._complete()},r$Q._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},r$Q._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},r$Q._complete=function(){r$O.timer.clear(this,this._complete),r$O.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},r$Q._checkComplete=function(){r$k.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},r$Q._loadWithFontFace=function(){var r$S=new r$f.window.FontFace(this.fontName,"url('"+this._url+"')");r$f.window.document.fonts.add(r$S);var r$Q=this;r$S.loaded.then(function(){r$Q._complete()}),r$S.load()},r$Q._createDiv=function(){this._div=r$f.createElement("div"),this._div.innerHTML="laya";var r$S=this._div.style;r$S.fontFamily=this.fontName,r$S.position="absolute",r$S.left="-100px",r$S.top="-100px",r$f.document.body.appendChild(this._div)},r$Q._loadWithCSS=function(){var r$S=this,r$Q=r$f.createElement("style");r$Q.type="text/css",r$f.document.body.appendChild(r$Q),r$Q.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=r$k.measureText("LayaTTFFont",this._fontTxt).width;var r$e=this;r$Q.onload=function(){r$O.timer.once(1e4,r$e,r$S._complete)},r$O.timer.loop(20,this,this._checkComplete),this._createDiv()},r$S._testString="LayaTTFFont",r$S}()),r$b=function(){function r$l(r$S){this._url=null,this._path=null,this._url=r$l.formatURL(r$S),this._path=r$l.getPath(r$S)}r$o(r$l,"laya.net.URL");var r$S=r$l.prototype;return r$L(0,r$S,"path",function(){return this._path}),r$L(0,r$S,"url",function(){return this._url}),r$l.formatURL=function(r$S,r$Q){if(!r$S)return"null path";if(0<r$S.indexOf(":"))return r$S;null!=r$l.customFormat&&(r$S=r$l.customFormat(r$S,r$Q));var r$e=r$S.charAt(0);if("."===r$e)return r$l.formatRelativePath((r$Q||r$l.basePath)+r$S);if("~"===r$e)return r$l.rootPath+r$S.substring(1);if("d"===r$e){if(0===r$S.indexOf("data:image"))return r$S}else if("/"===r$e)return r$S;return(r$Q||r$l.basePath)+r$S},r$l.formatRelativePath=function(r$S){for(var r$Q=r$S.split("/"),r$e=0,r$l=r$Q.length;r$e<r$l;r$e++)".."==r$Q[r$e]&&(r$Q.splice(r$e-1,2),r$e-=2);return r$Q.join("/")},r$l.isAbsolute=function(r$S){return 0<r$S.indexOf(":")||"/"==r$S.charAt(0)},r$l.getPath=function(r$S){var r$Q=r$S.lastIndexOf("/");return 0<r$Q?r$S.substr(0,r$Q+1):""},r$l.getFileName=function(r$S){var r$Q=r$S.lastIndexOf("/");return 0<r$Q?r$S.substr(r$Q+1):r$S},r$l.version={},r$l.basePath="",r$l.rootPath="",r$l.customFormat=function(r$S){var r$Q=r$l.version[r$S];return!r$m.isConchApp&&r$Q&&(r$S+="?v="+r$Q),r$S},r$l}(),r$m=function(){function r$M(r$S,r$Q){this._timeId=0;var r$e=r$M._mainCanvas.source.style;r$e.position="absolute",r$e.top=r$e.left="0px",r$e.background="#000000",r$M._mainCanvas.source.id="layaCanvas";var r$l=laya.renders.Render.isWebGL;r$M._mainCanvas.source.width=r$S,r$M._mainCanvas.source.height=r$Q,r$l&&r$M.WebGL.init(r$M._mainCanvas,r$S,r$Q),r$f.container.appendChild(r$M._mainCanvas.source),(r$M._context=new r$$(r$S,r$Q,r$l?null:r$M._mainCanvas)).ctx.setIsMainContext(),r$f.window.requestAnimationFrame(function r$S(r$Q){r$f.window.requestAnimationFrame(r$S);r$O.stage._loop()}),r$O.stage.on("visibilitychange",this,this._onVisibilitychange)}r$o(r$M,"laya.renders.Render");var r$S=r$M.prototype;return r$S._onVisibilitychange=function(){r$O.stage.isVisibility?0!=this._timeId&&r$f.window.clearInterval(this._timeId):this._timeId=r$f.window.setInterval(this._enterFrame,1e3)},r$S._enterFrame=function(r$S){r$O.stage._loop()},r$L(1,r$M,"context",function(){return r$M._context}),r$L(1,r$M,"canvas",function(){return r$M._mainCanvas.source}),r$M._context=null,r$M._mainCanvas=null,r$M.WebGL=null,r$M.isConchNode=!1,r$M.isConchApp=!1,r$M.isConchWebGL=!1,r$M.isWebGL=!1,r$M.is3DMode=!1,r$M.optimizeTextureMemory=function(r$S,r$Q){return!0},r$M.__init$=function(){r$T.ConchRenderType=r$T.ConchRenderType||1,r$T.ConchRenderType|=r$T.conch?4:0,r$M.isConchNode=5==(5&r$T.ConchRenderType),r$M.isConchApp=4==(4&r$T.ConchRenderType),r$M.isConchWebGL=6==r$T.ConchRenderType},r$M}(),r$$=function(){function r$T(r$S,r$Q,r$e){this.x=0,this.y=0,this._drawTexture=function(r$S,r$Q,r$e){r$e[0].loaded&&this.ctx.drawTexture(r$e[0],r$e[1],r$e[2],r$e[3],r$e[4],r$S,r$Q)},this._fillTexture=function(r$S,r$Q,r$e){r$e[0].loaded&&this.ctx.fillTexture(r$e[0],r$e[1]+r$S,r$e[2]+r$Q,r$e[3],r$e[4],r$e[5],r$e[6],r$e[7])},this._drawTextureWithTransform=function(r$S,r$Q,r$e){r$e[0].loaded&&this.ctx.drawTextureWithTransform(r$e[0],r$e[1],r$e[2],r$e[3],r$e[4],r$e[5],r$S,r$Q,r$e[6])},this._fillQuadrangle=function(r$S,r$Q,r$e){this.ctx.fillQuadrangle(r$e[0],r$e[1],r$e[2],r$e[3],r$e[4])},this._drawRect=function(r$S,r$Q,r$e){var r$l=this.ctx;null!=r$e[4]&&(r$l.fillStyle=r$e[4],r$l.fillRect(r$S+r$e[0],r$Q+r$e[1],r$e[2],r$e[3],null)),null!=r$e[5]&&(r$l.strokeStyle=r$e[5],r$l.lineWidth=r$e[6],r$l.strokeRect(r$S+r$e[0],r$Q+r$e[1],r$e[2],r$e[3],r$e[6]))},this._drawPie=function(r$S,r$Q,r$e){var r$l=this.ctx;r$m.isWebGL&&r$l.setPathId(r$e[8]),r$l.beginPath(),r$m.isWebGL?(r$l.movePath(r$e[0]+r$S,r$e[1]+r$Q),r$l.moveTo(0,0)):r$l.moveTo(r$S+r$e[0],r$Q+r$e[1]),r$l.arc(r$S+r$e[0],r$Q+r$e[1],r$e[2],r$e[3],r$e[4]),r$l.closePath(),this._fillAndStroke(r$e[5],r$e[6],r$e[7],!0)},this._clipRect=function(r$S,r$Q,r$e){this.ctx.clipRect(r$S+r$e[0],r$Q+r$e[1],r$e[2],r$e[3])},this._fillRect=function(r$S,r$Q,r$e){this.ctx.fillRect(r$S+r$e[0],r$Q+r$e[1],r$e[2],r$e[3],r$e[4])},this._drawCircle=function(r$S,r$Q,r$e){var r$l=this.ctx;r$m.isWebGL&&r$l.setPathId(r$e[6]),r$N.drawCall++,r$l.beginPath(),r$m.isWebGL&&r$l.movePath(r$e[0]+r$S,r$e[1]+r$Q),r$l.arc(r$e[0]+r$S,r$e[1]+r$Q,r$e[2],0,r$T.PI2),r$l.closePath(),this._fillAndStroke(r$e[3],r$e[4],r$e[5],!0)},this._fillCircle=function(r$S,r$Q,r$e){r$N.drawCall++;var r$l=this.ctx;r$l.beginPath(),r$l.fillStyle=r$e[3],r$l.arc(r$e[0]+r$S,r$e[1]+r$Q,r$e[2],0,r$T.PI2),r$l.fill()},this._setShader=function(r$S,r$Q,r$e){this.ctx.setShader(r$e[0])},this._drawLine=function(r$S,r$Q,r$e){var r$l=this.ctx;r$m.isWebGL&&r$l.setPathId(r$e[6]),r$l.beginPath(),r$l.strokeStyle=r$e[4],r$l.lineWidth=r$e[5],r$m.isWebGL?(r$l.movePath(r$S,r$Q),r$l.moveTo(r$e[0],r$e[1]),r$l.lineTo(r$e[2],r$e[3])):(r$l.moveTo(r$S+r$e[0],r$Q+r$e[1]),r$l.lineTo(r$S+r$e[2],r$Q+r$e[3])),r$l.stroke()},this._drawLines=function(r$S,r$Q,r$e){var r$l=this.ctx;r$m.isWebGL&&r$l.setPathId(r$e[5]),r$l.beginPath(),r$S+=r$e[0],r$Q+=r$e[1],r$m.isWebGL&&r$l.movePath(r$S,r$Q),r$l.strokeStyle=r$e[3],r$l.lineWidth=r$e[4];var r$M=r$e[2],r$d=2,r$T=r$M.length;if(r$m.isWebGL)for(r$l.moveTo(r$M[0],r$M[1]);r$d<r$T;)r$l.lineTo(r$M[r$d++],r$M[r$d++]);else for(r$l.moveTo(r$S+r$M[0],r$Q+r$M[1]);r$d<r$T;)r$l.lineTo(r$S+r$M[r$d++],r$Q+r$M[r$d++]);r$l.stroke()},this._drawLinesWebGL=function(r$S,r$Q,r$e){this.ctx.drawLines(r$S+this.x+r$e[0],r$Q+this.y+r$e[1],r$e[2],r$e[3],r$e[4])},this._drawCurves=function(r$S,r$Q,r$e){this.ctx.drawCurves(r$S,r$Q,r$e)},this._draw=function(r$S,r$Q,r$e){r$e[0].call(null,this,r$S,r$Q)},this._transformByMatrix=function(r$S,r$Q,r$e){this.ctx.transformByMatrix(r$e[0])},this._setTransform=function(r$S,r$Q,r$e){this.ctx.setTransform(r$e[0],r$e[1],r$e[2],r$e[3],r$e[4],r$e[5])},this._setTransformByMatrix=function(r$S,r$Q,r$e){this.ctx.setTransformByMatrix(r$e[0])},this._save=function(r$S,r$Q,r$e){this.ctx.save()},this._restore=function(r$S,r$Q,r$e){this.ctx.restore()},this._translate=function(r$S,r$Q,r$e){this.ctx.translate(r$e[0],r$e[1])},this._transform=function(r$S,r$Q,r$e){this.ctx.translate(r$e[1]+r$S,r$e[2]+r$Q);var r$l=r$e[0];this.ctx.transform(r$l.a,r$l.b,r$l.c,r$l.d,r$l.tx,r$l.ty),this.ctx.translate(-r$S-r$e[1],-r$Q-r$e[2])},this._rotate=function(r$S,r$Q,r$e){this.ctx.translate(r$e[1]+r$S,r$e[2]+r$Q),this.ctx.rotate(r$e[0]),this.ctx.translate(-r$S-r$e[1],-r$Q-r$e[2])},this._scale=function(r$S,r$Q,r$e){this.ctx.translate(r$e[2]+r$S,r$e[3]+r$Q),this.ctx.scale(r$e[0],r$e[1]),this.ctx.translate(-r$S-r$e[2],-r$Q-r$e[3])},this._alpha=function(r$S,r$Q,r$e){this.ctx.globalAlpha*=r$e[0]},this._setAlpha=function(r$S,r$Q,r$e){this.ctx.globalAlpha=r$e[0]},this._fillText=function(r$S,r$Q,r$e){this.ctx.fillText(r$e[0],r$e[1]+r$S,r$e[2]+r$Q,r$e[3],r$e[4],r$e[5])},this._strokeText=function(r$S,r$Q,r$e){this.ctx.strokeText(r$e[0],r$e[1]+r$S,r$e[2]+r$Q,r$e[3],r$e[4],r$e[5],r$e[6])},this._fillBorderText=function(r$S,r$Q,r$e){this.ctx.fillBorderText(r$e[0],r$e[1]+r$S,r$e[2]+r$Q,r$e[3],r$e[4],r$e[5],r$e[6],r$e[7])},this._blendMode=function(r$S,r$Q,r$e){this.ctx.globalCompositeOperation=r$e[0]},this._beginClip=function(r$S,r$Q,r$e){this.ctx.beginClip&&this.ctx.beginClip(r$S+r$e[0],r$Q+r$e[1],r$e[2],r$e[3])},this._setIBVB=function(r$S,r$Q,r$e){this.ctx.setIBVB(r$e[0]+r$S,r$e[1]+r$Q,r$e[2],r$e[3],r$e[4],r$e[5],r$e[6],r$e[7])},this._fillTrangles=function(r$S,r$Q,r$e){this.ctx.fillTrangles(r$e[0],r$e[1]+r$S,r$e[2]+r$Q,r$e[3],r$e[4])},this._drawPath=function(r$S,r$Q,r$e){var r$l=this.ctx;r$m.isWebGL&&r$l.setPathId(-1),r$l.beginPath(),r$S+=r$e[0],r$Q+=r$e[1],r$m.isWebGL&&r$l.movePath(r$S,r$Q);for(var r$M=r$e[2],r$d=0,r$T=r$M.length;r$d<r$T;r$d++){var r$U=r$M[r$d];switch(r$U[0]){case"moveTo":r$m.isWebGL?r$l.moveTo(r$U[1],r$U[2]):r$l.moveTo(r$S+r$U[1],r$Q+r$U[2]);break;case"lineTo":r$m.isWebGL?r$l.lineTo(r$U[1],r$U[2]):r$l.lineTo(r$S+r$U[1],r$Q+r$U[2]);break;case"arcTo":r$m.isWebGL?r$l.arcTo(r$U[1],r$U[2],r$U[3],r$U[4],r$U[5]):r$l.arcTo(r$S+r$U[1],r$Q+r$U[2],r$S+r$U[3],r$Q+r$U[4],r$U[5]);break;case"closePath":r$l.closePath()}}var r$i=r$e[3];null!=r$i&&(r$l.fillStyle=r$i.fillStyle,r$l.fill());var r$R=r$e[4];null!=r$R&&(r$l.strokeStyle=r$R.strokeStyle,r$l.lineWidth=r$R.lineWidth||1,r$l.lineJoin=r$R.lineJoin,r$l.lineCap=r$R.lineCap,r$l.miterLimit=r$R.miterLimit,r$l.stroke())},this.drawPoly=function(r$S,r$Q,r$e){this.ctx.drawPoly(r$S+this.x+r$e[0],r$Q+this.y+r$e[1],r$e[2],r$e[3],r$e[4],r$e[5],r$e[6])},this._drawPoly=function(r$S,r$Q,r$e){var r$l=this.ctx,r$M=r$e[2],r$d=2,r$T=r$M.length;if(r$m.isWebGL)for(r$l.setPathId(r$e[6]),r$l.beginPath(),r$S+=r$e[0],r$Q+=r$e[1],r$l.movePath(r$S,r$Q),r$l.moveTo(r$M[0],r$M[1]);r$d<r$T;)r$l.lineTo(r$M[r$d++],r$M[r$d++]);else for(r$l.beginPath(),r$S+=r$e[0],r$Q+=r$e[1],r$l.moveTo(r$S+r$M[0],r$Q+r$M[1]);r$d<r$T;)r$l.lineTo(r$S+r$M[r$d++],r$Q+r$M[r$d++]);r$l.closePath(),this._fillAndStroke(r$e[3],r$e[4],r$e[5],r$e[7])},this._drawSkin=function(r$S,r$Q,r$e){var r$l=r$e[0];if(r$l){var r$M=this.ctx;r$l.render(r$M,r$S,r$Q)}},this._drawParticle=function(r$S,r$Q,r$e){this.ctx.drawParticle(r$S+this.x,r$Q+this.y,r$e[0])},this._setFilters=function(r$S,r$Q,r$e){this.ctx.setFilters(r$e)},r$e?this.ctx=r$e.getContext("2d"):(r$e=r$AS.create("3D"),this.ctx=r$k.createWebGLContext2D(r$e),r$e._setContext(this.ctx)),r$e.size(r$S,r$Q),this.canvas=r$e}r$o(r$T,"laya.renders.RenderContext");var r$S=r$T.prototype;return r$S.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},r$S.drawTexture=function(r$S,r$Q,r$e,r$l,r$M){r$S.loaded&&this.ctx.drawTexture(r$S,r$Q,r$e,r$l,r$M,this.x,this.y)},r$S._drawTextures=function(r$S,r$Q,r$e){r$e[0].loaded&&this.ctx.drawTextures(r$e[0],r$e[1],r$S+this.x,r$Q+this.y)},r$S.drawTextureWithTransform=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){r$S.loaded&&this.ctx.drawTextureWithTransform(r$S,r$Q,r$e,r$l,r$M,r$d,this.x,this.y,r$T)},r$S.fillQuadrangle=function(r$S,r$Q,r$e,r$l,r$M){this.ctx.fillQuadrangle(r$S,r$Q,r$e,r$l,r$M)},r$S.drawCanvas=function(r$S,r$Q,r$e,r$l,r$M){this.ctx.drawCanvas(r$S,r$Q+this.x,r$e+this.y,r$l,r$M)},r$S.drawRect=function(r$S,r$Q,r$e,r$l,r$M,r$d){void 0===r$d&&(r$d=1);var r$T=this.ctx;r$T.strokeStyle=r$M,r$T.lineWidth=r$d,r$T.strokeRect(r$S+this.x,r$Q+this.y,r$e,r$l,r$d)},r$S._fillAndStroke=function(r$S,r$Q,r$e,r$l){void 0===r$l&&(r$l=!1);var r$M=this.ctx;null!=r$S&&(r$M.fillStyle=r$S,r$m.isWebGL?r$M.fill(r$l):r$M.fill()),null!=r$Q&&0<r$e&&(r$M.strokeStyle=r$Q,r$M.lineWidth=r$e,r$M.stroke())},r$S.clipRect=function(r$S,r$Q,r$e,r$l){this.ctx.clipRect(r$S+this.x,r$Q+this.y,r$e,r$l)},r$S.fillRect=function(r$S,r$Q,r$e,r$l,r$M){this.ctx.fillRect(r$S+this.x,r$Q+this.y,r$e,r$l,r$M)},r$S.drawCircle=function(r$S,r$Q,r$e,r$l,r$M){void 0===r$M&&(r$M=1),r$N.drawCall++;var r$d=this.ctx;r$d.beginPath(),r$d.strokeStyle=r$l,r$d.lineWidth=r$M,r$d.arc(r$S+this.x,r$Q+this.y,r$e,0,r$T.PI2),r$d.stroke()},r$S.drawTriangles=function(r$S,r$Q,r$e){if(r$m.isWebGL)this.ctx.drawTriangles(r$e[0],r$S+r$e[1],r$Q+r$e[2],r$e[3],r$e[4],r$e[5],r$e[6],r$e[7],r$e[8],r$e[9]);else{var r$l=r$e[5],r$M=0,r$d=r$l.length,r$T=this.ctx;for(r$M=0;r$M<r$d;r$M+=3){var r$U=2*r$l[r$M],r$i=2*r$l[r$M+1],r$R=2*r$l[r$M+2];r$T.drawTriangle(r$e[0],r$e[3],r$e[4],r$U,r$i,r$R,r$e[6],!0)}}},r$S.fillCircle=function(r$S,r$Q,r$e,r$l){r$N.drawCall++;var r$M=this.ctx;r$M.beginPath(),r$M.fillStyle=r$l,r$M.arc(r$S+this.x,r$Q+this.y,r$e,0,r$T.PI2),r$M.fill()},r$S.setShader=function(r$S){this.ctx.setShader(r$S)},r$S.drawLine=function(r$S,r$Q,r$e,r$l,r$M,r$d){void 0===r$d&&(r$d=1);var r$T=this.ctx;r$T.beginPath(),r$T.strokeStyle=r$M,r$T.lineWidth=r$d,r$T.moveTo(this.x+r$S,this.y+r$Q),r$T.lineTo(this.x+r$e,this.y+r$l),r$T.stroke()},r$S.clear=function(){this.ctx.clear()},r$S.transformByMatrix=function(r$S){this.ctx.transformByMatrix(r$S)},r$S.setTransform=function(r$S,r$Q,r$e,r$l,r$M,r$d){this.ctx.setTransform(r$S,r$Q,r$e,r$l,r$M,r$d)},r$S.setTransformByMatrix=function(r$S){this.ctx.setTransformByMatrix(r$S)},r$S.save=function(){this.ctx.save()},r$S.restore=function(){this.ctx.restore()},r$S.translate=function(r$S,r$Q){this.ctx.translate(r$S,r$Q)},r$S.transform=function(r$S,r$Q,r$e,r$l,r$M,r$d){this.ctx.transform(r$S,r$Q,r$e,r$l,r$M,r$d)},r$S.rotate=function(r$S){this.ctx.rotate(r$S)},r$S.scale=function(r$S,r$Q){this.ctx.scale(r$S,r$Q)},r$S.alpha=function(r$S){this.ctx.globalAlpha*=r$S},r$S.setAlpha=function(r$S){this.ctx.globalAlpha=r$S},r$S.fillWords=function(r$S,r$Q,r$e,r$l,r$M,r$d){void 0===r$d&&(r$d=0),this.ctx.fillWords(r$S,r$Q,r$e,r$l,r$M,r$d)},r$S.fillBorderWords=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this.ctx.fillBorderWords(r$S,r$Q,r$e,r$l,r$M,r$d,r$T)},r$S.fillText=function(r$S,r$Q,r$e,r$l,r$M,r$d){this.ctx.fillText(r$S,r$Q+this.x,r$e+this.y,r$l,r$M,r$d)},r$S.strokeText=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this.ctx.strokeText(r$S,r$Q+this.x,r$e+this.y,r$l,r$M,r$d,r$T)},r$S.blendMode=function(r$S){this.ctx.globalCompositeOperation=r$S},r$S.flush=function(){this.ctx.flush&&this.ctx.flush()},r$S.addRenderObject=function(r$S){this.ctx.addRenderObject(r$S)},r$S.beginClip=function(r$S,r$Q,r$e,r$l){this.ctx.beginClip&&this.ctx.beginClip(r$S,r$Q,r$e,r$l)},r$S.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},r$S.fillTrangles=function(r$S,r$Q,r$e){this.ctx.fillTrangles(r$e[0],r$e[1],r$e[2],r$e[3],4<r$e.length?r$e[4]:null)},r$T.PI2=2*Math.PI,r$T}(),r$n=function(){function r$T(r$S,r$Q){switch(this._next=r$Q||r$T.NORENDER,r$S){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=r$G._filter);case 69905:return void(this._fun=r$T._initRenderFun)}this.onCreate(r$S)}r$o(r$T,"laya.renders.RenderSprite");var r$S=r$T.prototype;return r$S.onCreate=function(r$S){},r$S._style=function(r$S,r$Q,r$e,r$l){r$S._style.render(r$S,r$Q,r$e,r$l);var r$M=this._next;r$M._fun.call(r$M,r$S,r$Q,r$e,r$l)},r$S._no=function(r$S,r$Q,r$e,r$l){},r$S._custom=function(r$S,r$Q,r$e,r$l){r$S.customRender(r$Q,r$e,r$l);var r$M=r$S._style._tf;this._next._fun.call(this._next,r$S,r$Q,r$e-r$M.translateX,r$l-r$M.translateY)},r$S._clip=function(r$S,r$Q,r$e,r$l){var r$M=this._next;if(r$M!=r$T.NORENDER){var r$d=r$S._style.scrollRect;r$Q.ctx.save(),r$Q.ctx.clipRect(r$e,r$l,r$d.width,r$d.height),r$M._fun.call(r$M,r$S,r$Q,r$e-r$d.x,r$l-r$d.y),r$Q.ctx.restore()}},r$S._blend=function(r$S,r$Q,r$e,r$l){var r$M=r$S._style;r$M.blendMode&&(r$Q.ctx.globalCompositeOperation=r$M.blendMode);var r$d=this._next;r$d._fun.call(r$d,r$S,r$Q,r$e,r$l),r$Q.ctx.globalCompositeOperation="source-over"},r$S._mask=function(r$S,r$Q,r$e,r$l){var r$M=this._next;r$M._fun.call(r$M,r$S,r$Q,r$e,r$l);var r$d=r$S.mask;r$d&&(r$Q.ctx.globalCompositeOperation="destination-in",(0<r$d.numChildren||!r$d.graphics._isOnlyOne())&&(r$d.cacheAsBitmap=!0),r$d.render(r$Q,r$e-r$S.pivotX,r$l-r$S.pivotY)),r$Q.ctx.globalCompositeOperation="source-over"},r$S._graphics=function(r$S,r$Q,r$e,r$l){var r$M=r$S._style._tf;r$S._graphics&&r$S._graphics._render(r$S,r$Q,r$e-r$M.translateX,r$l-r$M.translateY);var r$d=this._next;r$d._fun.call(r$d,r$S,r$Q,r$e,r$l)},r$S._image=function(r$S,r$Q,r$e,r$l){var r$M=r$S._style;r$Q.ctx.drawTexture2(r$e,r$l,r$M._tf.translateX,r$M._tf.translateY,r$S.transform,r$M.alpha,r$M.blendMode,r$S._graphics._one)},r$S._image2=function(r$S,r$Q,r$e,r$l){var r$M=r$S._style._tf;r$Q.ctx.drawTexture2(r$e,r$l,r$M.translateX,r$M.translateY,r$S.transform,1,null,r$S._graphics._one)},r$S._alpha=function(r$S,r$Q,r$e,r$l){var r$M;if(.01<(r$M=r$S._style.alpha)||r$S._needRepaint()){var r$d=r$Q.ctx.globalAlpha;r$Q.ctx.globalAlpha*=r$M;var r$T=this._next;r$T._fun.call(r$T,r$S,r$Q,r$e,r$l),r$Q.ctx.globalAlpha=r$d}},r$S._transform=function(r$S,r$Q,r$e,r$l){var r$M=r$S.transform,r$d=this._next;r$M&&r$d!=r$T.NORENDER?(r$Q.save(),r$Q.transform(r$M.a,r$M.b,r$M.c,r$M.d,r$M.tx+r$e,r$M.ty+r$l),r$d._fun.call(r$d,r$S,r$Q,0,0),r$Q.restore()):r$d._fun.call(r$d,r$S,r$Q,r$e,r$l)},r$S._childs=function(r$S,r$Q,r$e,r$l){var r$M=r$S._style,r$d=r$M._tf;if(r$e=r$e-r$d.translateX+r$M.paddingLeft,r$l=r$l-r$d.translateY+r$M.paddingTop,r$M._calculation){var r$T=r$S._getWords();if(r$T){var r$U=r$M;r$U&&(r$U.stroke?r$Q.fillBorderWords(r$T,r$e,r$l,r$U.font,r$U.color,r$U.strokeColor,r$U.stroke):r$Q.fillWords(r$T,r$e,r$l,r$U.font,r$U.color,"none"!=r$U.textDecoration&&r$U.underLine?1:0))}}var r$i,r$R=r$S._childs,r$o=r$R.length;if(r$S.viewport||r$S.optimizeScrollRect&&r$S._style.scrollRect){var r$Y=r$S.viewport||r$S._style.scrollRect,r$p=r$Y.x,r$J=r$Y.y,r$L=r$Y.right,r$j=r$Y.bottom,r$c=NaN,r$G=NaN;for(r$z=0;r$z<r$o;++r$z)(r$i=r$R[r$z]).visible&&(r$c=r$i._x)<r$L&&r$c+r$i.width>r$p&&(r$G=r$i._y)<r$j&&r$G+r$i.height>r$J&&r$i.render(r$Q,r$e,r$l)}else for(var r$z=0;r$z<r$o;++r$z)(r$i=r$R[r$z])._style.visible&&r$i.render(r$Q,r$e,r$l)},r$S._canvas=function(r$S,r$Q,r$e,r$l){var r$M=r$S._$P.cacheCanvas;if(r$M){"bitmap"===r$M.type?r$N.canvasBitmap++:r$N.canvasNormal++;var r$d=r$M.ctx;if(r$S._needRepaint()||!r$d)this._canvas_repaint(r$S,r$Q,r$e,r$l);else{var r$T=r$M._cacheRec;r$Q.drawCanvas(r$d.canvas,r$e+r$T.x,r$l+r$T.y,r$T.width,r$T.height)}}else this._next._fun.call(this._next,r$S,r$Q,r$e,r$l)},r$S._canvas_repaint=function(r$S,r$Q,r$e,r$l){var r$M=r$S._$P.cacheCanvas,r$d=this._next;if(r$M){var r$T,r$U,r$i,r$R,r$o=r$M.ctx,r$Y=r$S._needRepaint()||!r$o,r$p=r$M.type;if("bitmap"===r$p?r$N.canvasBitmap++:r$N.canvasNormal++,r$Y){var r$J,r$L;r$M._cacheRec||(r$M._cacheRec=new r$g),r$m.isWebGL&&"bitmap"!==r$p?r$M._cacheRec.setTo(-r$S.pivotX,-r$S.pivotY,1,1):((r$R=r$S.getSelfBounds()).x=r$R.x-r$S.pivotX,r$R.y=r$R.y-r$S.pivotY,r$R.x=r$R.x-16,r$R.y=r$R.y-16,r$R.width=r$R.width+32,r$R.height=r$R.height+32,r$R.x=Math.floor(r$R.x+r$e)-r$e,r$R.y=Math.floor(r$R.y+r$l)-r$l,r$R.width=Math.floor(r$R.width),r$R.height=Math.floor(r$R.height),r$M._cacheRec.copyFrom(r$R)),r$R=r$M._cacheRec;var r$j,r$c=r$m.isWebGL?1:r$f.pixelRatio*r$O.stage.clientScaleX,r$G=r$m.isWebGL?1:r$f.pixelRatio*r$O.stage.clientScaleY;if(!r$m.isWebGL){var r$z,r$A=1,r$v=1;for(r$z=r$S;r$z&&r$z!=r$O.stage;)r$A*=r$z.scaleX,r$v*=r$z.scaleY,r$z=r$z.parent;r$m.isWebGL?(r$A<1&&(r$c*=r$A),r$v<1&&(r$G*=r$v)):(1<r$A&&(r$c*=r$A),1<r$v&&(r$G*=r$v))}if(r$S.scrollRect){var r$D=r$S.scrollRect;r$R.x-=r$D.x,r$R.y-=r$D.y}if(r$J=r$R.width*r$c,r$L=r$R.height*r$G,r$U=r$R.x,r$i=r$R.y,r$m.isWebGL&&"bitmap"===r$p&&(2048<r$J||2048<r$L))return console.warn("cache bitmap size larger than 2048,cache ignored"),r$M.ctx&&(r$Z.recover("RenderContext",r$M.ctx),r$M.ctx.canvas.size(0,0),r$M.ctx=null),void r$d._fun.call(r$d,r$S,r$Q,r$e,r$l);if(r$o||(r$o=r$M.ctx=r$Z.getItem("RenderContext")||new r$$(r$J,r$L,r$AS.create("AUTO"))),r$o.ctx.sprite=r$S,(r$T=r$o.canvas).clear(),(r$T.width!=r$J||r$T.height!=r$L)&&r$T.size(r$J,r$L),"bitmap"===r$p?r$T.context.asBitmap=!0:"normal"===r$p&&(r$T.context.asBitmap=!1),1!=r$c||1!=r$G){var r$B=r$o.ctx;r$B.save(),r$B.scale(r$c,r$G),!r$m.isConchWebGL&&r$m.isConchApp&&(r$j=r$S._$P.cf)&&r$B.setFilterMatrix&&r$B.setFilterMatrix(r$j._mat,r$j._alpha),r$d._fun.call(r$d,r$S,r$o,-r$U,-r$i),r$B.restore(),r$m.isConchApp&&!r$m.isConchWebGL||r$S._applyFilters()}else r$B=r$o.ctx,!r$m.isConchWebGL&&r$m.isConchApp&&(r$j=r$S._$P.cf)&&r$B.setFilterMatrix&&r$B.setFilterMatrix(r$j._mat,r$j._alpha),r$d._fun.call(r$d,r$S,r$o,-r$U,-r$i),r$m.isConchApp&&!r$m.isConchWebGL||r$S._applyFilters();r$S._$P.staticCache&&(r$M.reCache=!1),r$N.canvasReCache++}else r$U=(r$R=r$M._cacheRec).x,r$i=r$R.y,r$T=r$o.canvas;r$Q.drawCanvas(r$T,r$e+r$U,r$l+r$i,r$R.width,r$R.height)}else r$d._fun.call(r$d,r$S,r$o,r$e,r$l)},r$T.__init__=function(){var r$S,r$Q,r$e=0;for(r$Q=r$k.createRenderSprite(69905,null),r$S=r$T.renders.length=4096,r$e=0;r$e<r$S;r$e++)r$T.renders[r$e]=r$Q;r$T.renders[0]=r$k.createRenderSprite(0,null),function(r$S,r$Q){for(var r$e=0,r$l=0;r$l<r$S.length;r$l++)r$e|=r$S[r$l],r$T.renders[r$e]=r$Q}([1,512,4,2],new r$T(1,null)),r$T.renders[513]=r$k.createRenderSprite(513,null),r$T.renders[517]=new r$T(517,null)},r$T._initRenderFun=function(r$S,r$Q,r$e,r$l){var r$M=r$S._renderType;(r$T.renders[r$M]=r$T._getTypeRender(r$M))._fun(r$S,r$Q,r$e,r$l)},r$T._getTypeRender=function(r$S){for(var r$Q=null,r$e=2048;1<r$e;)r$e&r$S&&(r$Q=r$k.createRenderSprite(r$e,r$Q)),r$e>>=1;return r$Q},r$T.IMAGE=1,r$T.ALPHA=2,r$T.TRANSFORM=4,r$T.BLEND=8,r$T.CANVAS=16,r$T.FILTERS=32,r$T.MASK=64,r$T.CLIP=128,r$T.STYLE=256,r$T.GRAPHICS=512,r$T.CUSTOM=1024,r$T.CHILDS=2048,r$T.INIT=69905,r$T.renders=[],r$T.NORENDER=new r$T(0,null),r$T}(),r$P=function(){function r$U(){this._repaint=!1}r$o(r$U,"laya.resource.Context");var r$S=r$U.prototype;return r$S.replaceReset=function(){var r$S,r$Q,r$e=0;for(r$S=r$U.replaceKeys.length,r$e=0;r$e<r$S;r$e++)r$Q=r$U.replaceKeys[r$e],this[r$U.newKeys[r$e]]=this[r$Q]},r$S.replaceResotre=function(){this.__restore(),this.__reset()},r$S.setIsMainContext=function(){},r$S.drawTextures=function(r$S,r$Q,r$e,r$l){r$N.drawCall+=r$Q.length/2;for(var r$M=r$S.width,r$d=r$S.height,r$T=0,r$U=r$Q.length;r$T<r$U;r$T+=2)this.drawTexture(r$S,r$Q[r$T],r$Q[r$T+1],r$M,r$d,r$e,r$l)},r$S.drawCanvas=function(r$S,r$Q,r$e,r$l,r$M){r$N.drawCall++,this.drawImage(r$S.source,r$Q,r$e,r$l,r$M)},r$S.fillRect=function(r$S,r$Q,r$e,r$l,r$M){r$N.drawCall++,r$M&&(this.fillStyle=r$M),this.__fillRect(r$S,r$Q,r$e,r$l)},r$S.fillText=function(r$S,r$Q,r$e,r$l,r$M,r$d){r$N.drawCall++,3<arguments.length&&null!=r$l&&(this.font=r$l,this.fillStyle=r$M,this.textAlign=r$d,this.textBaseline="top"),this.__fillText(r$S,r$Q,r$e)},r$S.fillBorderText=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){r$N.drawCall++,this.font=r$l,this.fillStyle=r$M,this.textBaseline="top",this.strokeStyle=r$d,this.lineWidth=r$T,this.textAlign=r$U,this.__strokeText(r$S,r$Q,r$e),this.__fillText(r$S,r$Q,r$e)},r$S.strokeText=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){r$N.drawCall++,3<arguments.length&&null!=r$l&&(this.font=r$l,this.strokeStyle=r$M,this.lineWidth=r$d,this.textAlign=r$T,this.textBaseline="top"),this.__strokeText(r$S,r$Q,r$e)},r$S.transformByMatrix=function(r$S){this.transform(r$S.a,r$S.b,r$S.c,r$S.d,r$S.tx,r$S.ty)},r$S.setTransformByMatrix=function(r$S){this.setTransform(r$S.a,r$S.b,r$S.c,r$S.d,r$S.tx,r$S.ty)},r$S.clipRect=function(r$S,r$Q,r$e,r$l){r$N.drawCall++,this.beginPath(),this.rect(r$S,r$Q,r$e,r$l),this.clip()},r$S.drawTexture=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){r$N.drawCall++;var r$U=r$S.uv,r$i=r$S.bitmap.width,r$R=r$S.bitmap.height;this.drawImage(r$S.source,r$U[0]*r$i,r$U[1]*r$R,(r$U[2]-r$U[0])*r$i,(r$U[5]-r$U[3])*r$R,r$Q+r$d,r$e+r$T,r$l,r$M)},r$S.drawTextureWithTransform=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){r$N.drawCall++;var r$R=r$S.uv,r$o=r$S.bitmap.width,r$Y=r$S.bitmap.height;this.save(),1!=r$i&&(this.globalAlpha*=r$i),r$d?(this.transform(r$d.a,r$d.b,r$d.c,r$d.d,r$d.tx+r$T,r$d.ty+r$U),this.drawImage(r$S.source,r$R[0]*r$o,r$R[1]*r$Y,(r$R[2]-r$R[0])*r$o,(r$R[5]-r$R[3])*r$Y,r$Q,r$e,r$l,r$M)):this.drawImage(r$S.source,r$R[0]*r$o,r$R[1]*r$Y,(r$R[2]-r$R[0])*r$o,(r$R[5]-r$R[3])*r$Y,r$Q+r$T,r$e+r$U,r$l,r$M),this.restore()},r$S.drawTexture2=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){var r$i=r$U[0];if(r$i.loaded&&r$i.bitmap&&r$i.source){r$N.drawCall++;var r$R=1!==r$d;if(r$R){var r$o=this.globalAlpha;this.globalAlpha*=r$d}var r$Y=r$i.uv,r$p=r$i.bitmap.width,r$J=r$i.bitmap.height;r$M?(this.save(),this.transform(r$M.a,r$M.b,r$M.c,r$M.d,r$M.tx+r$S,r$M.ty+r$Q),this.drawImage(r$i.source,r$Y[0]*r$p,r$Y[1]*r$J,(r$Y[2]-r$Y[0])*r$p,(r$Y[5]-r$Y[3])*r$J,r$U[1]-r$e,r$U[2]-r$l,r$U[3],r$U[4]),this.restore()):this.drawImage(r$i.source,r$Y[0]*r$p,r$Y[1]*r$J,(r$Y[2]-r$Y[0])*r$p,(r$Y[5]-r$Y[3])*r$J,r$U[1]-r$e+r$S,r$U[2]-r$l+r$Q,r$U[3],r$U[4]),r$R&&(this.globalAlpha=r$o)}},r$S.fillTexture=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){if(!r$U.pat){if(r$S.uv!=r$oS.DEF_UV){var r$i=new r$AS("2D");r$i.getContext("2d"),r$i.size(r$S.width,r$S.height),r$i.context.drawTexture(r$S,0,0,r$S.width,r$S.height,0,0),r$S=new r$oS(r$i)}r$U.pat=this.createPattern(r$S.bitmap.source,r$d)}var r$R=r$Q,r$o=r$e,r$Y=0,r$p=0;r$T&&(r$R+=r$T.x%r$S.width,r$o+=r$T.y%r$S.height,r$Y-=r$T.x%r$S.width,r$p-=r$T.y%r$S.height),this.translate(r$R,r$o),this.fillRect(r$Y,r$p,r$l,r$M,r$U.pat),this.translate(-r$R,-r$o)},r$S.drawTriangle=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){var r$i=r$S.bitmap,r$R=r$i.source,r$o=r$S.width,r$Y=r$S.height,r$p=r$i.width,r$J=r$i.height,r$L=r$e[r$l]*r$p,r$j=r$e[r$M]*r$p,r$c=r$e[r$d]*r$p,r$G=r$e[r$l+1]*r$J,r$z=r$e[r$M+1]*r$J,r$A=r$e[r$d+1]*r$J,r$v=r$Q[r$l],r$D=r$Q[r$M],r$B=r$Q[r$d],r$O=r$Q[r$l+1],r$H=r$Q[r$M+1],r$g=r$Q[r$d+1];if(r$U){var r$I=(r$v+r$D+r$B)/3,r$E=(r$O+r$H+r$g)/3,r$t=r$v-r$I,r$k=r$O-r$E,r$X=Math.sqrt(r$t*r$t+r$k*r$k);r$v=r$I+r$t/r$X*(r$X+1),r$O=r$E+r$k/r$X*(r$X+1),r$k=r$H-r$E,r$D=r$I+(r$t=r$D-r$I)/(r$X=Math.sqrt(r$t*r$t+r$k*r$k))*(r$X+1),r$H=r$E+r$k/r$X*(r$X+1),r$k=r$g-r$E,r$B=r$I+(r$t=r$B-r$I)/(r$X=Math.sqrt(r$t*r$t+r$k*r$k))*(r$X+1),r$g=r$E+r$k/r$X*(r$X+1)}this.save(),r$T&&this.transform(r$T.a,r$T.b,r$T.c,r$T.d,r$T.tx,r$T.ty),this.beginPath(),this.moveTo(r$v,r$O),this.lineTo(r$D,r$H),this.lineTo(r$B,r$g),this.closePath(),this.clip();var r$h=1/(r$L*r$z+r$G*r$c+r$j*r$A-r$z*r$c-r$G*r$j-r$L*r$A),r$b=r$v*r$z+r$G*r$B+r$D*r$A-r$z*r$B-r$G*r$D-r$v*r$A,r$m=r$L*r$D+r$v*r$c+r$j*r$B-r$D*r$c-r$v*r$j-r$L*r$B,r$$=r$L*r$z*r$B+r$G*r$D*r$c+r$v*r$j*r$A-r$v*r$z*r$c-r$G*r$j*r$B-r$L*r$D*r$A,r$n=r$O*r$z+r$G*r$g+r$H*r$A-r$z*r$g-r$G*r$H-r$O*r$A,r$P=r$L*r$H+r$O*r$c+r$j*r$g-r$H*r$c-r$O*r$j-r$L*r$g,r$a=r$L*r$z*r$g+r$G*r$H*r$c+r$O*r$j*r$A-r$O*r$z*r$c-r$G*r$j*r$g-r$L*r$H*r$A;this.transform(r$b*r$h,r$n*r$h,r$m*r$h,r$P*r$h,r$$*r$h,r$a*r$h),this.drawImage(r$R,r$S.uv[0]*r$p,r$S.uv[1]*r$J,r$o,r$Y,r$S.uv[0]*r$p,r$S.uv[1]*r$J,r$o,r$Y),this.restore()},r$S.flush=function(){return 0},r$S.fillWords=function(r$S,r$Q,r$e,r$l,r$M,r$d){r$l&&(this.font=r$l),r$M&&(this.fillStyle=r$M);this.textBaseline="top",this.textAlign="left";for(var r$T=0,r$U=r$S.length;r$T<r$U;r$T++){var r$i=r$S[r$T];if(this.__fillText(r$i.char,r$i.x+r$Q,r$i.y+r$e),1===r$d){var r$R=r$i.height,r$o=.5*r$i.style.letterSpacing;r$o||(r$o=0),this.beginPath(),this.strokeStyle=r$M,this.lineWidth=1,this.moveTo(r$Q+r$i.x-r$o+.5,r$e+r$i.y+r$R+.5),this.lineTo(r$Q+r$i.x+r$i.width+r$o+.5,r$e+r$i.y+r$R+.5),this.stroke()}}},r$S.fillBorderWords=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){r$l&&(this.font=r$l),r$M&&(this.fillStyle=r$M),this.textBaseline="top",this.lineWidth=r$T,this.textAlign="left",this.strokeStyle=r$d;for(var r$U=0,r$i=r$S.length;r$U<r$i;r$U++){var r$R=r$S[r$U];this.__strokeText(r$R.char,r$R.x+r$Q,r$R.y+r$e),this.__fillText(r$R.char,r$R.x+r$Q,r$R.y+r$e)}},r$S.destroy=function(){this.canvas.width=this.canvas.height=0},r$S.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},r$S.drawCurves=function(r$S,r$Q,r$e){this.beginPath(),this.strokeStyle=r$e[3],this.lineWidth=r$e[4];var r$l=r$e[2];r$S+=r$e[0],r$Q+=r$e[1],this.moveTo(r$S+r$l[0],r$Q+r$l[1]);for(var r$M=2,r$d=r$l.length;r$M<r$d;)this.quadraticCurveTo(r$S+r$l[r$M++],r$Q+r$l[r$M++],r$S+r$l[r$M++],r$Q+r$l[r$M++]);this.stroke()},r$U.__init__=function(r$Q){var r$e=laya.resource.Context.prototype;if(!(r$Q=r$Q||CanvasRenderingContext2D.prototype).inited){r$Q.inited=!0,r$Q.__fillText=r$Q.fillText,r$Q.__fillRect=r$Q.fillRect,r$Q.__strokeText=r$Q.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(r$S){r$Q[r$S]=r$e[r$S]})}},r$U.replaceCanvasGetSet=function(r$S,r$Q){var r$e=Object.getOwnPropertyDescriptor(r$S,r$Q);if(!r$e||!r$e.configurable)return!1;var r$l,r$M={};for(r$l in r$e)"set"!=r$l&&(r$M[r$l]=r$e[r$l]);var r$d=r$e.set;return r$M.set=function(r$S){r$d.call(this,r$S);var r$Q=this.getContext("2d");r$Q&&"__reset"in r$Q&&r$Q.__reset()},Object.defineProperty(r$S,r$Q,r$M),!0},r$U.replaceGetSet=function(r$S,r$Q){var r$e=Object.getOwnPropertyDescriptor(r$S,r$Q);if(!r$e||!r$e.configurable)return!1;var r$l,r$M={};for(r$l in r$e)"set"!=r$l&&(r$M[r$l]=r$e[r$l]);var r$d=r$e.set,r$T="___"+r$Q+"__";return r$U.newKeys.push(r$T),r$M.set=function(r$S){r$S!=this[r$T]&&(this[r$T]=r$S,r$d.call(this,r$S))},Object.defineProperty(r$S,r$Q,r$M),!0},r$U._default=new r$U,r$U.newKeys=[],r$i(r$U,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),r$U}(),r$a=function(){function r$d(r$S){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++r$d._uniqueIDCounter,this._name=r$S||"Content Manager",r$d._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,r$d._resourceManagers.push(this),this._resources=[],this._records={}}r$o(r$d,"laya.resource.ResourceManager");var r$S=r$d.prototype;return r$O.imps(r$S,{"laya.resource.IDispose":!0}),r$S.getResourceByIndex=function(r$S){return this._resources[r$S]},r$S.getResourcesLength=function(){return this._resources.length},r$S.addResource=function(r$S){return r$S.resourceManager&&r$S.resourceManager.removeResource(r$S),-1===this._resources.indexOf(r$S)&&((r$S._resourceManager=this)._resources.push(r$S),this.addRecord(r$S.uri,r$S.__className,r$S.memorySize),this.addSize(r$S.memorySize),!0)},r$S.removeResource=function(r$S){var r$Q=this._resources.indexOf(r$S);return-1!==r$Q&&(this._resources.splice(r$Q,1),r$S._resourceManager=null,this._memorySize-=r$S.memorySize,this.addRecord(r$S.uri,r$S.__className,-r$S.memorySize),!0)},r$S.unload=function(){for(var r$S=this._resources.slice(0,this._resources.length),r$Q=0;r$Q<r$S.length;r$Q++){r$S[r$Q].destroy()}r$S.length=0},r$S.dispose=function(){if(this===r$d._systemResourceManager)throw new Error("systemResourceManager不能被释放！");r$d._resourceManagers.splice(r$d._resourceManagers.indexOf(this),1),r$d._isResourceManagersSorted=!1;for(var r$S=this._resources.slice(0,this._resources.length),r$Q=0;r$Q<r$S.length;r$Q++){var r$e=r$S[r$Q];r$e.resourceManager.removeResource(r$e),r$e.destroy()}r$S.length=0},r$S.addSize=function(r$S){r$S&&(this.autoRelease&&0<r$S&&this._memorySize+r$S>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=r$S)},r$S.addRecord=function(r$S,r$Q,r$e){DEBUG&&r$e&&!r$S&&console.error(r$S,r$Q,r$e),r$S&&(this._records.hasOwnProperty(r$Q+"|"+r$S)||(this._records[r$Q+"|"+r$S]=0),this._records[r$Q+"|"+r$S]+=r$e,DEBUG&&this._records[r$Q+"|"+r$S]<0&&console.error(r$S,r$Q,this._records[r$Q+"|"+r$S]))},r$S.garbageCollection=function(r$S){var r$Q=this._resources;(r$Q=r$Q.slice()).sort(function(r$S,r$Q){if(!r$S||!r$Q)throw new Error("a或b不能为空！");return r$S.released&&r$Q.released?0:r$S.released?1:r$Q.released?-1:r$S._lastUseFrameCount-r$Q._lastUseFrameCount});for(var r$e=r$N.loopCount,r$l=0,r$M=r$Q.length;r$l<r$M;r$l++){var r$d=r$Q[r$l];if(!(1<r$e-r$d._lastUseFrameCount))return void(this._memorySize>=r$S&&(this._isOverflow=!0));if(r$d.releaseResource(),this._memorySize<r$S)return void(this._isOverflow=!1)}},r$L(0,r$S,"id",function(){return this._id}),r$L(0,r$S,"name",function(){return this._name},function(r$S){!r$S&&""===r$S||this._name===r$S||(this._name=r$S,r$d._isResourceManagersSorted=!1)}),r$L(0,r$S,"memorySize",function(){return this._memorySize}),r$L(0,r$S,"records",function(){return this._records}),r$L(1,r$d,"systemResourceManager",function(){return r$d._systemResourceManager}),r$d.__init__=function(){r$d.currentResourceManager=r$d.systemResourceManager},r$d.getLoadedResourceManagerByIndex=function(r$S){return r$d._resourceManagers[r$S]},r$d.getLoadedResourceManagersCount=function(){return r$d._resourceManagers.length},r$d.recreateContentManagers=function(r$S){void 0===r$S&&(r$S=!1);for(var r$Q=r$d.currentResourceManager,r$e=0;r$e<r$d._resourceManagers.length;r$e++){r$d.currentResourceManager=r$d._resourceManagers[r$e];for(var r$l=0;r$l<r$d.currentResourceManager._resources.length;r$l++)r$d.currentResourceManager._resources[r$l].releaseResource(r$S),r$d.currentResourceManager._resources[r$l].activeResource(r$S)}r$d.currentResourceManager=r$Q},r$d.releaseContentManagers=function(r$S){void 0===r$S&&(r$S=!1);for(var r$Q=r$d.currentResourceManager,r$e=0;r$e<r$d._resourceManagers.length;r$e++){r$d.currentResourceManager=r$d._resourceManagers[r$e];for(var r$l=0;r$l<r$d.currentResourceManager._resources.length;r$l++){var r$M=r$d.currentResourceManager._resources[r$l];!r$M.released&&r$M.releaseResource(r$S)}}r$d.currentResourceManager=r$Q},r$d._uniqueIDCounter=0,r$d._isResourceManagersSorted=!1,r$d._resourceManagers=[],r$i(r$d,["_systemResourceManager",function(){return this._systemResourceManager=new r$d("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=r$d._systemResourceManager}]),r$d}(),r$f=(function(){function r$S(){}r$o(r$S,"laya.system.System"),r$S.changeDefinition=function(r$S,r$Q){r$O[r$S]=r$Q;var r$e=r$S+"=classObj";r$O._runScript(r$e)},r$S.__init__=function(){r$m.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function r$e(){}return r$o(r$e,"laya.utils.Browser"),r$L(1,r$e,"pixelRatio",function(){return r$e.__init__(),-1<r$e.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:r$k.getPixelRatio()}),r$L(1,r$e,"height",function(){return r$e.__init__(),(r$O.stage&&r$O.stage.canvasRotation?r$e.clientWidth:r$e.clientHeight)*r$e.pixelRatio}),r$L(1,r$e,"clientWidth",function(){return r$e.__init__(),r$e.window.innerWidth||r$e.document.body.clientWidth}),r$L(1,r$e,"window",function(){return r$e.__init__(),r$e._window}),r$L(1,r$e,"clientHeight",function(){return r$e.__init__(),r$e.window.innerHeight||r$e.document.body.clientHeight||r$e.document.documentElement.clientHeight}),r$L(1,r$e,"width",function(){return r$e.__init__(),(r$O.stage&&r$O.stage.canvasRotation?r$e.clientHeight:r$e.clientWidth)*r$e.pixelRatio}),r$L(1,r$e,"container",function(){return r$e.__init__(),r$e._container||((r$e._container=r$e.createElement("div")).id="layaContainer",r$e.document.body.appendChild(r$e._container)),r$e._container},function(r$S){r$e._container=r$S}),r$L(1,r$e,"document",function(){return r$e.__init__(),r$e._document}),r$e.__init__=function(){if(!r$e._window){r$e._window=r$k.getWindow(),r$e._document=r$e.window.document,r$e._window.addEventListener("message",function(r$S){laya.utils.Browser._onMessage(r$S)},!1),r$e.document.__createElement=r$e.document.createElement,r$T.requestAnimationFrame=r$T.requestAnimationFrame||r$T.webkitRequestAnimationFrame||r$T.mozRequestAnimationFrame||r$T.oRequestAnimationFrame||r$T.msRequestAnimationFrame||function(r$S){return r$T.setTimeout(r$S,1e3/60)};var r$S=r$T.document.body.style;r$S["-webkit-user-select"]="none",r$S["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",r$e.userAgent=r$e.window.navigator.userAgent,r$e.onIOS=!!(r$e.u=r$e.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),r$e.onMobile=-1<r$e.u.indexOf("Mobile"),r$e.onIPhone=-1<r$e.u.indexOf("iPhone"),r$e.onMac=-1<r$e.u.indexOf("Mac OS X"),r$e.onIPad=-1<r$e.u.indexOf("iPad"),r$e.onAndroid=-1<r$e.u.indexOf("Android")||-1<r$e.u.indexOf("Adr"),r$e.onWP=-1<r$e.u.indexOf("Windows Phone"),r$e.onQQBrowser=-1<r$e.u.indexOf("QQBrowser"),r$e.onMQQBrowser=-1<r$e.u.indexOf("MQQBrowser")||-1<r$e.u.indexOf("Mobile")&&-1<r$e.u.indexOf("QQ"),r$e.onIE=!!r$e.window.ActiveXObject||"ActiveXObject"in r$e.window,r$e.onWeiXin=-1<r$e.u.indexOf("MicroMessenger"),r$e.onPC=!r$e.onMobile,r$e.onSafari=-1<r$e.u.indexOf("Safari"),r$e.onFirefox=-1<r$e.u.indexOf("Firefox"),r$e.onEdge=-1<r$e.u.indexOf("Edge"),r$e.onMiniGame=-1<r$e.u.indexOf("MiniGame"),r$e.onLimixiu=-1<r$e.u.indexOf("limixiu"),r$e.httpProtocol="http:"==r$e.window.location.protocol,r$e.onMiniGame&&null==r$e.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),r$e.webAudioEnabled=!!(r$e.window.AudioContext||r$e.window.webkitAudioContext||r$e.window.mozAudioContext),r$e.soundType=r$e.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",r$MS=r$e.webAudioEnabled?r$dS:r$eS,r$e.webAudioEnabled&&r$dS.initWebAudio(),r$eS._initMusicAudio(),r$e.enableTouch="ontouchstart"in r$T||r$T.DocumentTouch&&r$Q instanceof DocumentTouch,r$T.focus(),r$t._soundClass=r$MS,r$t._musicClass=r$eS,r$m._mainCanvas=r$m._mainCanvas||r$AS.create("2D"),r$e.canvas||(r$e.canvas=r$AS.create("2D"),r$e.context=r$e.canvas.getContext("2d"))}},r$e._onMessage=function(r$S){if(r$S.data&&"size"==r$S.data.name){if(r$e.window.innerWidth=r$S.data.width,r$e.window.innerHeight=r$S.data.height,r$e.window.__innerHeight=r$S.data.clientHeight,!r$e.document.createEvent)return void console.warn("no document.createEvent");var r$Q=r$e.document.createEvent("HTMLEvents");return r$Q.initEvent("resize",!1,!1),void r$e.window.dispatchEvent(r$Q)}},r$e.createElement=function(r$S){return r$e.__init__(),r$e.document.__createElement(r$S)},r$e.getElementById=function(r$S){return r$e.__init__(),r$e.document.getElementById(r$S)},r$e.removeElement=function(r$S){r$S&&r$S.parentNode&&r$S.parentNode.removeChild(r$S)},r$e.now=function(){return r$k.now()},r$e._window=null,r$e._document=null,r$e._container=null,r$e.userAgent=null,r$e.u=null,r$e.onIOS=!1,r$e.onMac=!1,r$e.onMobile=!1,r$e.onIPhone=!1,r$e.onIPad=!1,r$e.onAndroid=!1,r$e.onWP=!1,r$e.onQQBrowser=!1,r$e.onMQQBrowser=!1,r$e.onSafari=!1,r$e.onFirefox=!1,r$e.onEdge=!1,r$e.onIE=!1,r$e.onWeiXin=!1,r$e.onMiniGame=!1,r$e.onLimixiu=!1,r$e.onPC=!1,r$e.httpProtocol=!1,r$e.webAudioEnabled=!1,r$e.soundType=null,r$e.enableTouch=!1,r$e.canvas=null,r$e.context=null,r$e.__init$=function(){},r$e}()),r$w=function(){function r$Q(r$S){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,r$S?(this._u8d_=new Uint8Array(r$S),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}r$o(r$Q,"laya.utils.Byte");var r$S=r$Q.prototype;return r$S.___resizeBuffer=function(r$Q){try{var r$S=new Uint8Array(r$Q);null!=this._u8d_&&(this._u8d_.length<=r$Q?r$S.set(this._u8d_):r$S.set(this._u8d_.subarray(0,r$Q))),this._u8d_=r$S,this._d_=new DataView(r$S.buffer)}catch(r$S){throw"___resizeBuffer err:"+r$Q}},r$S.getString=function(){return this.rUTF(this.getUint16())},r$S.getFloat32Array=function(r$S,r$Q){var r$e=r$S+r$Q;r$e=r$e>this._length?this._length:r$e;var r$l=new Float32Array(this._d_.buffer.slice(r$S,r$e));return this._pos_=r$e,r$l},r$S.getUint8Array=function(r$S,r$Q){var r$e=r$S+r$Q;r$e=r$e>this._length?this._length:r$e;var r$l=new Uint8Array(this._d_.buffer.slice(r$S,r$e));return this._pos_=r$e,r$l},r$S.getInt16Array=function(r$S,r$Q){var r$e=r$S+r$Q;r$e=r$e>this._length?this._length:r$e;var r$l=new Int16Array(this._d_.buffer.slice(r$S,r$e));return this._pos_=r$e,r$l},r$S.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var r$S=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,r$S},r$S.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var r$S=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,r$S},r$S.writeFloat32=function(r$S){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,r$S,this._xd_),this._pos_+=4},r$S.writeFloat64=function(r$S){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,r$S,this._xd_),this._pos_+=8},r$S.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var r$S=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,r$S},r$S.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var r$S=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,r$S},r$S.writeInt32=function(r$S){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,r$S,this._xd_),this._pos_+=4},r$S.writeUint32=function(r$S){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,r$S,this._xd_),this._pos_+=4},r$S.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var r$S=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,r$S},r$S.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var r$S=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,r$S},r$S.writeUint16=function(r$S){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,r$S,this._xd_),this._pos_+=2},r$S.writeInt16=function(r$S){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,r$S,this._xd_),this._pos_+=2},r$S.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},r$S.writeUint8=function(r$S){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,r$S),this._pos_++},r$S._getUInt8=function(r$S){return this._d_.getUint8(r$S)},r$S._getUint16=function(r$S){return this._d_.getUint16(r$S,this._xd_)},r$S._getMatrix=function(){return new r$X(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},r$S.rUTF=function(r$S){for(var r$Q=[],r$e=this._pos_+r$S,r$l=0,r$M=0,r$d=0,r$T=String.fromCharCode,r$U=this._u8d_;this._pos_<r$e;)(r$l=r$U[this._pos_++])<128?0!=r$l&&r$Q.push(r$T(r$l)):r$l<224?r$Q.push(r$T((63&r$l)<<6|127&r$U[this._pos_++])):r$l<240?(r$M=r$U[this._pos_++],r$Q.push(r$T((31&r$l)<<12|(127&r$M)<<6|127&r$U[this._pos_++]))):(r$M=r$U[this._pos_++],r$d=r$U[this._pos_++],r$Q.push(r$T((15&r$l)<<18|(127&r$M)<<12|r$d<<6&127|127&r$U[this._pos_++]))),0;return r$Q.join("")},r$S.getCustomString=function(r$S){for(var r$Q=[],r$e=0,r$l=0,r$M=0,r$d=String.fromCharCode,r$T=this._u8d_;0<r$S;)if((r$l=r$T[this._pos_])<128)r$Q.push(r$d(r$l)),this._pos_++,r$S--;else for(r$e=r$l-128,this._pos_++,r$S-=r$e;0<r$e;)r$l=r$T[this._pos_++],r$M=r$T[this._pos_++],r$Q.push(r$d(r$M<<8|r$l)),r$e--;return r$Q.join("")},r$S.clear=function(){this._pos_=0,this.length=0},r$S.__getBuffer=function(){return this._d_.buffer},r$S.writeUTFBytes=function(r$S){for(var r$Q=0,r$e=(r$S+="").length;r$Q<r$e;r$Q++){var r$l=r$S.charCodeAt(r$Q);r$l<=127?this.writeByte(r$l):r$l<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|r$l>>6,128|63&r$l],this._pos_),this._pos_+=2):r$l<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|r$l>>12,128|r$l>>6&63,128|63&r$l],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|r$l>>18,128|r$l>>12&63,128|r$l>>6&63,128|63&r$l],this._pos_),this._pos_+=4)}},r$S.writeUTFString=function(r$S){var r$Q=this.pos;this.writeUint16(1),this.writeUTFBytes(r$S);var r$e=this.pos-r$Q-2;if(65536<=r$e)throw"writeUTFString byte len more than 65536";this._d_.setUint16(r$Q,r$e,this._xd_)},r$S.readUTFString=function(){return this.readUTFBytes(this.getUint16())},r$S.getUTFString=function(){return this.readUTFString()},r$S.readUTFBytes=function(r$S){if(void 0===r$S&&(r$S=-1),0==r$S)return"";var r$Q=this.bytesAvailable;if(r$Q<r$S)throw"readUTFBytes error - Out of bounds";return r$S=0<r$S?r$S:r$Q,this.rUTF(r$S)},r$S.getUTFBytes=function(r$S){return void 0===r$S&&(r$S=-1),this.readUTFBytes(r$S)},r$S.writeByte=function(r$S){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,r$S),this._pos_+=1},r$S.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},r$S.getByte=function(){return this.readByte()},r$S.ensureWrite=function(r$S){this._length<r$S&&(this._length=r$S),this._allocated_<r$S&&(this.length=r$S)},r$S.writeArrayBuffer=function(r$S,r$Q,r$e){if(void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),r$Q<0||r$e<0)throw"writeArrayBuffer error - Out of bounds";0==r$e&&(r$e=r$S.byteLength-r$Q),this.ensureWrite(this._pos_+r$e);var r$l=new Uint8Array(r$S);this._u8d_.set(r$l.subarray(r$Q,r$Q+r$e),this._pos_),this._pos_+=r$e},r$L(0,r$S,"buffer",function(){var r$S=this._d_.buffer;return r$S.byteLength==this.length?r$S:r$S.slice(0,this.length)}),r$L(0,r$S,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(r$S){this._xd_="littleEndian"==r$S}),r$L(0,r$S,"length",function(){return this._length},function(r$S){this._allocated_<r$S?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(r$S,2*this._allocated_))):this._allocated_>r$S&&this.___resizeBuffer(this._allocated_=r$S),this._length=r$S}),r$L(0,r$S,"pos",function(){return this._pos_},function(r$S){this._pos_=r$S}),r$L(0,r$S,"bytesAvailable",function(){return this._length-this._pos_}),r$Q.getSystemEndian=function(){if(!r$Q._sysEndian){var r$S=new ArrayBuffer(2);new DataView(r$S).setInt16(0,256,!0),r$Q._sysEndian=256===new Int16Array(r$S)[0]?"littleEndian":"bigEndian"}return r$Q._sysEndian},r$Q.BIG_ENDIAN="bigEndian",r$Q.LITTLE_ENDIAN="littleEndian",r$Q._sysEndian=null,r$Q}(),r$u=function(){function r$M(){}return r$o(r$M,"laya.utils.CacheManager"),r$M.regCacheByFunction=function(r$S,r$Q){var r$e;r$M.unRegCacheByFunction(r$S,r$Q),r$e={tryDispose:r$S,getCacheList:r$Q},r$M._cacheList.push(r$e)},r$M.unRegCacheByFunction=function(r$S,r$Q){var r$e,r$l=0;for(r$e=r$M._cacheList.length,r$l=0;r$l<r$e;r$l++)if(r$M._cacheList[r$l].tryDispose==r$S&&r$M._cacheList[r$l].getCacheList==r$Q)return void r$M._cacheList.splice(r$l,1)},r$M.forceDispose=function(){var r$S=0,r$Q=r$M._cacheList.length;for(r$S=0;r$S<r$Q;r$S++)r$M._cacheList[r$S].tryDispose(!0)},r$M.beginCheck=function(r$S){void 0===r$S&&(r$S=15e3),r$O.timer.loop(r$S,null,r$M._checkLoop)},r$M.stopCheck=function(){r$O.timer.clear(null,r$M._checkLoop)},r$M._checkLoop=function(){var r$S=r$M._cacheList;if(!(r$S.length<1)){var r$Q,r$e=r$f.now(),r$l=0;for(r$Q=r$l=r$S.length;0<r$l&&(r$S[r$M._index=++r$M._index%r$Q].tryDispose(!1),!(r$f.now()-r$e>r$M.loopTimeLimit));)r$l--}},r$M.loopTimeLimit=2,r$M._cacheList=[],r$M._index=0,r$M}(),r$r=function(){function r$J(){}return r$o(r$J,"laya.utils.ClassUtils"),r$J.regClass=function(r$S,r$Q){r$J._classMap[r$S]=r$Q},r$J.getRegClass=function(r$S){return r$J._classMap[r$S]},r$J.getInstance=function(r$S){var r$Q=r$J.getClass(r$S);return r$Q?new r$Q:(console.warn("[error] Undefined class:",r$S),null)},r$J.createByJson=function(r$S,r$Q,r$e,r$l,r$M){"string"==typeof r$S&&(r$S=JSON.parse(r$S));var r$d=r$S.props;if(!r$Q&&!(r$Q=r$M?r$M.runWith(r$S):r$J.getInstance(r$d.runtime||r$S.type)))return null;var r$T=r$S.child;if(r$T)for(var r$U=0,r$i=r$T.length;r$U<r$i;r$U++){var r$R=r$T[r$U];if("render"!==r$R.props.name&&"render"!==r$R.props.renderType||!r$Q._$set_itemRender)if("Graphic"==r$R.type)r$J.addGraphicsToSprite(r$R,r$Q);else if(r$J.isDrawType(r$R.type))r$J.addGraphicToSprite(r$R,r$Q,!0);else{var r$o=r$J.createByJson(r$R,null,r$e,r$l,r$M);"Script"==r$R.type?r$o.hasOwnProperty("owner")?r$o.owner=r$Q:r$o.hasOwnProperty("target")&&(r$o.target=r$Q):"mask"==r$R.props.renderType?r$Q.mask=r$o:r$Q.addChild(r$o)}else r$Q.itemRender=r$R}if(r$d)for(var r$Y in r$d){var r$p=r$d[r$Y];"var"===r$Y&&r$e?r$e[r$p]=r$Q:r$p instanceof Array&&"function"==typeof r$Q[r$Y]?r$Q[r$Y].apply(r$Q,r$p):r$Q[r$Y]=r$p}return r$l&&r$S.customProps&&r$l.runWith([r$Q,r$S]),r$Q.created&&r$Q.created(),r$Q},r$J.addGraphicsToSprite=function(r$S,r$Q){var r$e;if((r$e=r$S.child)&&!(r$e.length<1)){var r$l;r$l=r$J._getGraphicsFromSprite(r$S,r$Q);var r$M=0,r$d=0;r$S.props&&(r$M=r$J._getObjVar(r$S.props,"x",0),r$d=r$J._getObjVar(r$S.props,"y",0)),0!=r$M&&0!=r$d&&r$l.translate(r$M,r$d);var r$T,r$U=0;for(r$T=r$e.length,r$U=0;r$U<r$T;r$U++)r$J._addGraphicToGraphics(r$e[r$U],r$l);0!=r$M&&0!=r$d&&r$l.translate(-r$M,-r$d)}},r$J.addGraphicToSprite=function(r$S,r$Q,r$e){var r$l;void 0===r$e&&(r$e=!1),r$l=r$e?r$J._getGraphicsFromSprite(r$S,r$Q):r$Q.graphics,r$J._addGraphicToGraphics(r$S,r$l)},r$J._getGraphicsFromSprite=function(r$S,r$Q){var r$e,r$l;if(!r$S||!r$S.props)return r$Q.graphics;switch(r$l=r$S.props.renderType){case"hit":case"unHit":var r$M;r$Q.hitArea||(r$Q.hitArea=new r$q),(r$M=r$Q.hitArea)[r$l]||(r$M[r$l]=new r$p),r$e=r$M[r$l]}return r$e||(r$e=r$Q.graphics),r$e},r$J._getTransformData=function(r$S){var r$Q;(r$S.hasOwnProperty("pivotX")||r$S.hasOwnProperty("pivotY"))&&(r$Q=r$Q||new r$X).translate(-r$J._getObjVar(r$S,"pivotX",0),-r$J._getObjVar(r$S,"pivotY",0));var r$e=r$J._getObjVar(r$S,"scaleX",1),r$l=r$J._getObjVar(r$S,"scaleY",1),r$M=r$J._getObjVar(r$S,"rotation",0);r$J._getObjVar(r$S,"skewX",0),r$J._getObjVar(r$S,"skewY",0);return 1==r$e&&1==r$l&&0==r$M||((r$Q=r$Q||new r$X).scale(r$e,r$l),r$Q.rotate(.0174532922222222*r$M)),r$Q},r$J._addGraphicToGraphics=function(r$S,r$Q){var r$e,r$l;if((r$e=r$S.props)&&(r$l=r$J.DrawTypeDic[r$S.type])){var r$M,r$d;r$M=r$Q;var r$T=r$J._getParams(r$e,r$l[1],r$l[2],r$l[3]);((r$d=r$J._tM)||1!=r$J._alpha)&&(r$M.save(),r$d&&r$M.transform(r$d),1!=r$J._alpha&&r$M.alpha(r$J._alpha)),r$M[r$l[0]].apply(r$M,r$T),(r$d||1!=r$J._alpha)&&r$M.restore()}},r$J._adptLineData=function(r$S){return r$S[2]=parseFloat(r$S[0])+parseFloat(r$S[2]),r$S[3]=parseFloat(r$S[1])+parseFloat(r$S[3]),r$S},r$J._adptTextureData=function(r$S){return r$S[0]=r$US.getRes(r$S[0]),r$S},r$J._adptLinesData=function(r$S){return r$S[2]=r$J._getPointListByStr(r$S[2]),r$S},r$J.isDrawType=function(r$S){return"Image"!=r$S&&r$J.DrawTypeDic.hasOwnProperty(r$S)},r$J._getParams=function(r$S,r$Q,r$e,r$l){var r$M;void 0===r$e&&(r$e=0),(r$M=r$J._temParam).length=r$Q.length;var r$d,r$T,r$U=0;for(r$d=r$Q.length,r$U=0;r$U<r$d;r$U++)r$M[r$U]=r$J._getObjVar(r$S,r$Q[r$U][0],r$Q[r$U][1]);return r$J._alpha=r$J._getObjVar(r$S,"alpha",1),r$T=r$J._getTransformData(r$S),r$J._tM=r$T?(r$e||(r$e=0),r$T.translate(r$M[r$e],r$M[r$e+1]),r$M[r$e]=r$M[r$e+1]=0,r$T):null,r$l&&r$J[r$l]&&(r$M=r$J[r$l](r$M)),r$M},r$J._getPointListByStr=function(r$S){var r$Q,r$e,r$l=0;for(r$e=(r$Q=r$S.split(",")).length,r$l=0;r$l<r$e;r$l++)r$Q[r$l]=parseFloat(r$Q[r$l]);return r$Q},r$J._getObjVar=function(r$S,r$Q,r$e){return r$S.hasOwnProperty(r$Q)?r$S[r$Q]:r$e},r$J._temParam=[],r$J._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},r$J.getClass=function(r$S){var r$Q=r$J._classMap[r$S]||r$S;return"string"==typeof r$Q?r$O.__classmap[r$Q]:r$Q},r$J._tM=null,r$J._alpha=NaN,r$i(r$J,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),r$J}(),r$W=function(){function r$d(r$S){if(this._color=[],"string"==typeof r$S){null===(this.strColor=r$S)&&(r$S="#000000"),"#"==r$S.charAt(0)&&(r$S=r$S.substr(1));var r$Q=r$S.length;if(3==r$Q||4==r$Q){for(var r$e="",r$l=0;r$l<r$Q;r$l++)r$e+=r$S[r$l]+r$S[r$l];r$S=r$e}var r$M=this.numColor=parseInt(r$S,16);if(8==r$S.length)return void(this._color=[parseInt(r$S.substr(0,2),16)/255,((16711680&r$M)>>16)/255,((65280&r$M)>>8)/255,(255&r$M)/255])}else r$M=this.numColor=r$S,this.strColor=r$V.toHexColor(r$M);this._color=[((16711680&r$M)>>16)/255,((65280&r$M)>>8)/255,(255&r$M)/255,1],this._color.__id=++r$d._COLODID}return r$o(r$d,"laya.utils.Color"),r$d._initDefault=function(){for(var r$S in r$d._DEFAULT={},r$d._COLOR_MAP)r$d._SAVE[r$S]=r$d._DEFAULT[r$S]=new r$d(r$d._COLOR_MAP[r$S]);return r$d._DEFAULT},r$d._initSaveMap=function(){for(var r$S in r$d._SAVE_SIZE=0,r$d._SAVE={},r$d._DEFAULT)r$d._SAVE[r$S]=r$d._DEFAULT[r$S]},r$d.create=function(r$S){var r$Q=r$d._SAVE[r$S+""];return null!=r$Q?r$Q:(r$d._SAVE_SIZE<1e3||r$d._initSaveMap(),r$d._SAVE[r$S+""]=new r$d(r$S))},r$d._SAVE={},r$d._SAVE_SIZE=0,r$d._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},r$d._DEFAULT=r$d._initDefault(),r$d._COLODID=1,r$d}(),r$x=(function(){function r$S(){this._values=[],this._keys=[]}r$o(r$S,"laya.utils.Dictionary");var r$Q=r$S.prototype;r$Q.set=function(r$S,r$Q){var r$e=this.indexOf(r$S);0<=r$e?this._values[r$e]=r$Q:(this._keys.push(r$S),this._values.push(r$Q))},r$Q.indexOf=function(r$S){var r$Q=this._keys.indexOf(r$S);return 0<=r$Q?r$Q:(r$S="string"==typeof r$S?Number(r$S):"number"==typeof r$S?r$S.toString():r$S,this._keys.indexOf(r$S))},r$Q.get=function(r$S){var r$Q=this.indexOf(r$S);return r$Q<0?null:this._values[r$Q]},r$Q.remove=function(r$S){var r$Q=this.indexOf(r$S);return 0<=r$Q&&(this._keys.splice(r$Q,1),this._values.splice(r$Q,1),!0)},r$Q.clear=function(){this._values.length=0,this._keys.length=0},r$L(0,r$Q,"values",function(){return this._values}),r$L(0,r$Q,"keys",function(){return this._keys})}(),function(){function r$S(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}r$o(r$S,"laya.utils.Dragging");var r$Q=r$S.prototype;return r$Q.start=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){void 0===r$U&&(r$U=.92),this.clearTimer(),this.target=r$S,this.area=r$Q,this.hasInertia=r$e,this.elasticDistance=r$Q?r$l:0,this.elasticBackTime=r$M,this.data=r$d,this._disableMouseEvent=r$T,this.ratio=r$U,1!=r$S.globalScaleX||1!=r$S.globalScaleY?this._parent=r$S.parent:this._parent=r$O.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,r$O.stage.on("mouseup",this,this.onStageMouseUp),r$O.stage.on("mouseout",this,this.onStageMouseUp),r$O.timer.frameLoop(1,this,this.loop)},r$Q.clearTimer=function(){r$O.timer.clear(this,this.loop),r$O.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},r$Q.stop=function(){this._dragging&&(r$j.instance.disableMouseEvent=!1,r$O.stage.off("mouseup",this,this.onStageMouseUp),r$O.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},r$Q.loop=function(){var r$S=this._parent.getMousePoint(),r$Q=r$S.x,r$e=r$S.y,r$l=r$Q-this._lastX,r$M=r$e-this._lastY;if(this._clickOnly){if(!(1<Math.abs(r$l*r$O.stage._canvasTransform.getScaleX())||1<Math.abs(r$M*r$O.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),r$j.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(r$l,r$M);0==r$l&&0==r$M||(this._lastX=r$Q,this._lastY=r$e,this.target.x+=r$l*this._elasticRateX,this.target.y+=r$M*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},r$Q.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var r$S=this.area.x-this.target.x;else r$S=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-r$S/this.elasticDistance),this.target.y<this.area.y)var r$Q=this.area.y-this.target.y;else r$Q=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-r$Q/this.elasticDistance)}},r$Q.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},r$Q.onStageMouseUp=function(r$S){if(r$j.instance.disableMouseEvent=!1,r$O.stage.off("mouseup",this,this.onStageMouseUp),r$O.stage.off("mouseout",this,this.onStageMouseUp),r$O.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var r$Q=this._offsets.length,r$e=Math.min(r$Q,6),r$l=this._offsets.length-r$e,r$M=r$Q-1;r$l<r$M;r$M--)this._offsetY+=this._offsets[r$M--],this._offsetX+=this._offsets[r$M];this._offsetX=this._offsetX/r$e*2,this._offsetY=this._offsetY/r$e*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),r$O.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},r$Q.checkElastic=function(){var r$S=NaN,r$Q=NaN;if(this.target.x<this.area.x?r$S=this.area.x:this.target.x>this.area.x+this.area.width&&(r$S=this.area.x+this.area.width),this.target.y<this.area.y?r$Q=this.area.y:this.target.y>this.area.y+this.area.height&&(r$Q=this.area.y+this.area.height),isNaN(r$S)&&isNaN(r$Q))this.clear();else{var r$e={};isNaN(r$S)||(r$e.x=r$S),isNaN(r$Q)||(r$e.y=r$Q),this._tween=r$K.to(this.target,r$e,this.elasticBackTime,r$F.sineOut,r$z.create(this,this.clear),0,!1,!1)}},r$Q.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(r$O.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},r$Q.clear=function(){if(this.target){this.clearTimer();var r$S=this.target;this.target=null,this._parent=null,r$S.event("dragend",this.data)}},r$S}()),r$F=function(){function r$U(){}return r$o(r$U,"laya.utils.Ease"),r$U.linearNone=function(r$S,r$Q,r$e,r$l){return r$e*r$S/r$l+r$Q},r$U.linearIn=function(r$S,r$Q,r$e,r$l){return r$e*r$S/r$l+r$Q},r$U.linearInOut=function(r$S,r$Q,r$e,r$l){return r$e*r$S/r$l+r$Q},r$U.linearOut=function(r$S,r$Q,r$e,r$l){return r$e*r$S/r$l+r$Q},r$U.bounceIn=function(r$S,r$Q,r$e,r$l){return r$e-r$U.bounceOut(r$l-r$S,0,r$e,r$l)+r$Q},r$U.bounceInOut=function(r$S,r$Q,r$e,r$l){return r$S<.5*r$l?.5*r$U.bounceIn(2*r$S,0,r$e,r$l)+r$Q:.5*r$U.bounceOut(2*r$S-r$l,0,r$e,r$l)+.5*r$e+r$Q},r$U.bounceOut=function(r$S,r$Q,r$e,r$l){return(r$S/=r$l)<1/2.75?r$e*(7.5625*r$S*r$S)+r$Q:r$S<2/2.75?r$e*(7.5625*(r$S-=1.5/2.75)*r$S+.75)+r$Q:r$S<2.5/2.75?r$e*(7.5625*(r$S-=2.25/2.75)*r$S+.9375)+r$Q:r$e*(7.5625*(r$S-=2.625/2.75)*r$S+.984375)+r$Q},r$U.backIn=function(r$S,r$Q,r$e,r$l,r$M){return void 0===r$M&&(r$M=1.70158),r$e*(r$S/=r$l)*r$S*((r$M+1)*r$S-r$M)+r$Q},r$U.backInOut=function(r$S,r$Q,r$e,r$l,r$M){return void 0===r$M&&(r$M=1.70158),(r$S/=.5*r$l)<1?.5*r$e*(r$S*r$S*((1+(r$M*=1.525))*r$S-r$M))+r$Q:r$e/2*((r$S-=2)*r$S*((1+(r$M*=1.525))*r$S+r$M)+2)+r$Q},r$U.backOut=function(r$S,r$Q,r$e,r$l,r$M){return void 0===r$M&&(r$M=1.70158),r$e*((r$S=r$S/r$l-1)*r$S*((r$M+1)*r$S+r$M)+1)+r$Q},r$U.elasticIn=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T;return void 0===r$M&&(r$M=0),void 0===r$d&&(r$d=0),0==r$S?r$Q:1==(r$S/=r$l)?r$Q+r$e:(r$d||(r$d=.3*r$l),r$T=!r$M||0<r$e&&r$M<r$e||r$e<0&&r$M<-r$e?(r$M=r$e,r$d/4):r$d/r$U.PI2*Math.asin(r$e/r$M),-r$M*Math.pow(2,10*(r$S-=1))*Math.sin((r$S*r$l-r$T)*r$U.PI2/r$d)+r$Q)},r$U.elasticInOut=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T;return void 0===r$M&&(r$M=0),void 0===r$d&&(r$d=0),0==r$S?r$Q:2==(r$S/=.5*r$l)?r$Q+r$e:(r$d||(r$d=r$l*(.3*1.5)),r$T=!r$M||0<r$e&&r$M<r$e||r$e<0&&r$M<-r$e?(r$M=r$e,r$d/4):r$d/r$U.PI2*Math.asin(r$e/r$M),r$S<1?r$M*Math.pow(2,10*(r$S-=1))*Math.sin((r$S*r$l-r$T)*r$U.PI2/r$d)*-.5+r$Q:r$M*Math.pow(2,-10*(r$S-=1))*Math.sin((r$S*r$l-r$T)*r$U.PI2/r$d)*.5+r$e+r$Q)},r$U.elasticOut=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T;return void 0===r$M&&(r$M=0),void 0===r$d&&(r$d=0),0==r$S?r$Q:1==(r$S/=r$l)?r$Q+r$e:(r$d||(r$d=.3*r$l),r$T=!r$M||0<r$e&&r$M<r$e||r$e<0&&r$M<-r$e?(r$M=r$e,r$d/4):r$d/r$U.PI2*Math.asin(r$e/r$M),r$M*Math.pow(2,-10*r$S)*Math.sin((r$S*r$l-r$T)*r$U.PI2/r$d)+r$e+r$Q)},r$U.strongIn=function(r$S,r$Q,r$e,r$l){return r$e*(r$S/=r$l)*r$S*r$S*r$S*r$S+r$Q},r$U.strongInOut=function(r$S,r$Q,r$e,r$l){return(r$S/=.5*r$l)<1?.5*r$e*r$S*r$S*r$S*r$S*r$S+r$Q:.5*r$e*((r$S-=2)*r$S*r$S*r$S*r$S+2)+r$Q},r$U.strongOut=function(r$S,r$Q,r$e,r$l){return r$e*((r$S=r$S/r$l-1)*r$S*r$S*r$S*r$S+1)+r$Q},r$U.sineInOut=function(r$S,r$Q,r$e,r$l){return.5*-r$e*(Math.cos(Math.PI*r$S/r$l)-1)+r$Q},r$U.sineIn=function(r$S,r$Q,r$e,r$l){return-r$e*Math.cos(r$S/r$l*r$U.HALF_PI)+r$e+r$Q},r$U.sineOut=function(r$S,r$Q,r$e,r$l){return r$e*Math.sin(r$S/r$l*r$U.HALF_PI)+r$Q},r$U.quintIn=function(r$S,r$Q,r$e,r$l){return r$e*(r$S/=r$l)*r$S*r$S*r$S*r$S+r$Q},r$U.quintInOut=function(r$S,r$Q,r$e,r$l){return(r$S/=.5*r$l)<1?.5*r$e*r$S*r$S*r$S*r$S*r$S+r$Q:.5*r$e*((r$S-=2)*r$S*r$S*r$S*r$S+2)+r$Q},r$U.quintOut=function(r$S,r$Q,r$e,r$l){return r$e*((r$S=r$S/r$l-1)*r$S*r$S*r$S*r$S+1)+r$Q},r$U.quartIn=function(r$S,r$Q,r$e,r$l){return r$e*(r$S/=r$l)*r$S*r$S*r$S+r$Q},r$U.quartInOut=function(r$S,r$Q,r$e,r$l){return(r$S/=.5*r$l)<1?.5*r$e*r$S*r$S*r$S*r$S+r$Q:.5*-r$e*((r$S-=2)*r$S*r$S*r$S-2)+r$Q},r$U.quartOut=function(r$S,r$Q,r$e,r$l){return-r$e*((r$S=r$S/r$l-1)*r$S*r$S*r$S-1)+r$Q},r$U.cubicIn=function(r$S,r$Q,r$e,r$l){return r$e*(r$S/=r$l)*r$S*r$S+r$Q},r$U.cubicInOut=function(r$S,r$Q,r$e,r$l){return(r$S/=.5*r$l)<1?.5*r$e*r$S*r$S*r$S+r$Q:.5*r$e*((r$S-=2)*r$S*r$S+2)+r$Q},r$U.cubicOut=function(r$S,r$Q,r$e,r$l){return r$e*((r$S=r$S/r$l-1)*r$S*r$S+1)+r$Q},r$U.quadIn=function(r$S,r$Q,r$e,r$l){return r$e*(r$S/=r$l)*r$S+r$Q},r$U.quadInOut=function(r$S,r$Q,r$e,r$l){return(r$S/=.5*r$l)<1?.5*r$e*r$S*r$S+r$Q:.5*-r$e*(--r$S*(r$S-2)-1)+r$Q},r$U.quadOut=function(r$S,r$Q,r$e,r$l){return-r$e*(r$S/=r$l)*(r$S-2)+r$Q},r$U.expoIn=function(r$S,r$Q,r$e,r$l){return 0==r$S?r$Q:r$e*Math.pow(2,10*(r$S/r$l-1))+r$Q-.001*r$e},r$U.expoInOut=function(r$S,r$Q,r$e,r$l){return 0==r$S?r$Q:r$S==r$l?r$Q+r$e:(r$S/=.5*r$l)<1?.5*r$e*Math.pow(2,10*(r$S-1))+r$Q:.5*r$e*(2-Math.pow(2,-10*--r$S))+r$Q},r$U.expoOut=function(r$S,r$Q,r$e,r$l){return r$S==r$l?r$Q+r$e:r$e*(1-Math.pow(2,-10*r$S/r$l))+r$Q},r$U.circIn=function(r$S,r$Q,r$e,r$l){return-r$e*(Math.sqrt(1-(r$S/=r$l)*r$S)-1)+r$Q},r$U.circInOut=function(r$S,r$Q,r$e,r$l){return(r$S/=.5*r$l)<1?.5*-r$e*(Math.sqrt(1-r$S*r$S)-1)+r$Q:.5*r$e*(Math.sqrt(1-(r$S-=2)*r$S)+1)+r$Q},r$U.circOut=function(r$S,r$Q,r$e,r$l){return r$e*Math.sqrt(1-(r$S=r$S/r$l-1)*r$S)+r$Q},r$U.HALF_PI=.5*Math.PI,r$U.PI2=2*Math.PI,r$U}(),r$q=function(){function r$Y(){this._hit=null,this._unHit=null}r$o(r$Y,"laya.utils.HitArea");var r$S=r$Y.prototype;return r$S.isHit=function(r$S,r$Q){return!!r$Y.isHitGraphic(r$S,r$Q,this.hit)&&!r$Y.isHitGraphic(r$S,r$Q,this.unHit)},r$S.contains=function(r$S,r$Q){return this.isHit(r$S,r$Q)},r$L(0,r$S,"hit",function(){return this._hit||(this._hit=new r$p),this._hit},function(r$S){this._hit=r$S}),r$L(0,r$S,"unHit",function(){return this._unHit||(this._unHit=new r$p),this._unHit},function(r$S){this._unHit=r$S}),r$Y.isHitGraphic=function(r$S,r$Q,r$e){if(!r$e)return!1;var r$l;if(!(r$l=r$e.cmds)&&r$e._one&&((r$l=r$Y._cmds).length=1,r$l[0]=r$e._one),!r$l)return!1;var r$M,r$d,r$T=0;for(r$M=r$l.length,r$T=0;r$T<r$M;r$T++)if(r$d=r$l[r$T]){var r$U=r$m._context;switch(r$d.callee){case r$U._translate:case 6:r$S-=r$d[0],r$Q-=r$d[1]}if(r$Y.isHitCmd(r$S,r$Q,r$d))return!0}return!1},r$Y.isHitCmd=function(r$S,r$Q,r$e){if(!r$e)return!1;var r$l=r$m._context,r$M=!1;switch(r$e.callee){case r$l._drawRect:case 13:r$Y._rec.setTo(r$e[0],r$e[1],r$e[2],r$e[3]),r$M=r$Y._rec.contains(r$S,r$Q);break;case r$l._drawCircle:case r$l._fillCircle:case 14:r$M=(r$S-=r$e[0])*r$S+(r$Q-=r$e[1])*r$Q<r$e[2]*r$e[2];break;case r$l._drawPoly:case 18:r$S-=r$e[0],r$Q-=r$e[1],r$M=r$Y.ptInPolygon(r$S,r$Q,r$e[2])}return r$M},r$Y.ptInPolygon=function(r$S,r$Q,r$e){var r$l;(r$l=r$Y._ptPoint).setTo(r$S,r$Q);var r$M,r$d=0,r$T=NaN,r$U=NaN,r$i=NaN,r$R=NaN;r$M=r$e.length;for(var r$o=0;r$o<r$M;r$o+=2){if(r$T=r$e[r$o],r$U=r$e[r$o+1],r$i=r$e[(r$o+2)%r$M],r$U!=(r$R=r$e[(r$o+3)%r$M]))if(!(r$l.y<Math.min(r$U,r$R)))if(!(r$l.y>=Math.max(r$U,r$R)))(r$l.y-r$U)*(r$i-r$T)/(r$R-r$U)+r$T>r$l.x&&r$d++}return r$d%2==1},r$Y._cmds=[],r$i(r$Y,["_rec",function(){return this._rec=new r$g},"_ptPoint",function(){return this._ptPoint=new r$H}]),r$Y}(),r$Z=(function(){function r$M(r$S,r$Q,r$e,r$l){this.char=r$S,this.charNum=r$S.charCodeAt(0),this._x=this._y=0,this.width=r$Q,this.height=r$e,this.style=r$l,this.isWord=!r$M._isWordRegExp.test(r$S)}r$o(r$M,"laya.utils.HTMLChar");var r$S=r$M.prototype;r$O.imps(r$S,{"laya.display.ILayout":!0}),r$S.setSprite=function(r$S){this._sprite=r$S},r$S.getSprite=function(){return this._sprite},r$S._isChar=function(){return!0},r$S._getCSSStyle=function(){return this.style},r$L(0,r$S,"width",function(){return this._w},function(r$S){this._w=r$S}),r$L(0,r$S,"x",function(){return this._x},function(r$S){this._sprite&&(this._sprite.x=r$S),this._x=r$S}),r$L(0,r$S,"y",function(){return this._y},function(r$S){this._sprite&&(this._sprite.y=r$S),this._y=r$S}),r$L(0,r$S,"height",function(){return this._h},function(r$S){this._h=r$S}),r$M._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function r$Q(){}r$o(r$Q,"laya.utils.Log"),r$Q.enable=function(){r$Q._logdiv||(r$Q._logdiv=r$f.window.document.createElement("div"),r$f.window.document.body.appendChild(r$Q._logdiv),r$Q._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},r$Q.toggle=function(){var r$S=r$Q._logdiv.style;"1px"==r$S.width?r$S.width=r$S.height="50%":r$S.width=r$S.height="1px"},r$Q.print=function(r$S){r$Q._logdiv&&(r$Q.maxCount<=r$Q._count&&r$Q.clear(),r$Q._count++,r$Q._logdiv.innerText+=r$S+"\n",r$Q._logdiv.scrollTop=r$Q._logdiv.scrollHeight)},r$Q.clear=function(){r$Q._logdiv.innerText="",r$Q._count=0},r$Q._logdiv=null,r$Q._count=0,r$Q.maxCount=20}(),function(){function r$Q(){}r$o(r$Q,"laya.utils.Mouse"),r$L(1,r$Q,"cursor",function(){return r$Q._style.cursor},function(r$S){r$Q._style.cursor=r$S}),r$Q.hide=function(){"none"!=r$Q.cursor&&(r$Q._preCursor=r$Q.cursor,r$Q.cursor="none")},r$Q.show=function(){"none"==r$Q.cursor&&(r$Q.cursor=r$Q._preCursor?r$Q._preCursor:"auto")},r$Q._preCursor=null,r$i(r$Q,["_style",function(){return this._style=r$f.document.body.style}])}(),function(){function r$d(){}return r$o(r$d,"laya.utils.Pool"),r$d.getPoolBySign=function(r$S){return r$d._poolDic[r$S]||(r$d._poolDic[r$S]=[])},r$d.clearBySign=function(r$S){r$d._poolDic[r$S]&&(r$d._poolDic[r$S].length=0)},r$d.recover=function(r$S,r$Q){r$Q.__InPool||(r$Q.__InPool=!0,r$d.getPoolBySign(r$S).push(r$Q))},r$d.getItemByClass=function(r$S,r$Q){var r$e=r$d.getPoolBySign(r$S),r$l=r$e.length?r$e.pop():new r$Q;return r$l.__InPool=!1,r$l},r$d.getItemByCreateFun=function(r$S,r$Q,r$e){var r$l=r$d.getPoolBySign(r$S),r$M=r$l.length?r$l.pop():r$Q.call(r$e);return r$M.__InPool=!1,r$M},r$d.getItem=function(r$S){var r$Q=r$d.getPoolBySign(r$S),r$e=r$Q.length?r$Q.pop():null;return r$e&&(r$e.__InPool=!1),r$e},r$d._poolDic={},r$d.InPoolSign="__InPool",r$d}()),r$N=function(){function r$i(){}return r$o(r$i,"laya.utils.Stat"),r$L(1,r$i,"onclick",null,function(r$S){r$i._sp&&r$i._sp.on("click",r$i._sp,r$S),r$i._canvas&&(r$i._canvas.source.onclick=r$S,r$i._canvas.source.style.pointerEvents="")}),r$i.show=function(r$S,r$Q,r$e){if(void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),!r$m.isConchApp||r$m.isConchWebGL){if(r$m.isConchWebGL||r$f.onMiniGame||r$f.onLimixiu||(r$i._useCanvas=!0),r$i._show=!0,r$i._fpsData.length=60,r$i._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},r$i._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},r$i._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},r$i._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},r$m.isWebGL)if(r$i._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},r$m.is3DMode){if(r$i._view[0].title="FPS(3D)",r$i._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},r$i._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},r$i._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==r$e){var r$l=8;r$i._view[r$l++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},r$i._view[r$l++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},r$i._view[r$l++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},r$i._view[r$l++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},r$i._view[r$l++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},r$i._view[r$l++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},r$i._view[r$l++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},r$i._view[r$l++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},r$i._view[r$l++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==r$e){r$l=8;r$i._view[r$l++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},r$i._view[r$l++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},r$i._view[r$l++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},r$i._view[r$l++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},r$i._view[r$l++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},r$i._view[r$l++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},r$i._view[r$l++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else r$i._view[0].title="FPS(WebGL)",r$i._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else r$i._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};r$i._useCanvas?r$i.createUIPre(r$S,r$Q):r$i.createUI(r$S,r$Q),r$i.enable()}else r$f.window.conch.showFPS&&r$f.window.conch.showFPS(r$S,r$Q)},r$i.createUIPre=function(r$S,r$Q){var r$e=r$f.pixelRatio;r$i._width=170*r$e,r$i._vx=75*r$e,r$i._height=r$e*(12*r$i._view.length+3*r$e)+4,r$i._fontSize=12*r$e;for(var r$l=0;r$l<r$i._view.length;r$l++)r$i._view[r$l].x=4,r$i._view[r$l].y=r$l*r$i._fontSize+2*r$e;r$i._canvas||((r$i._canvas=new r$AS("2D")).size(r$i._width,r$i._height),(r$i._ctx=r$i._canvas.getContext("2d")).textBaseline="top",r$i._ctx.font=r$i._fontSize+"px Sans-serif",r$i._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+r$S+"px;top:"+r$Q+"px;width:"+r$i._width/r$e+"px;height:"+r$i._height/r$e+"px;"),r$i._first=!0,r$i.loop(),r$i._first=!1,r$f.container.appendChild(r$i._canvas.source)},r$i.createUI=function(r$S,r$Q){var r$e=r$i._sp,r$l=r$f.pixelRatio;r$e||(r$e=new r$YS,(r$i._leftText=new r$cS).pos(5,5),r$i._leftText.color="#ffffff",r$e.addChild(r$i._leftText),(r$i._txt=new r$cS).pos(80*r$l,5),r$i._txt.color="#ffffff",r$e.addChild(r$i._txt),r$i._sp=r$e),r$e.pos(r$S,r$Q);for(var r$M="",r$d=0;r$d<r$i._view.length;r$d++){r$M+=r$i._view[r$d].title+"\n"}r$i._leftText.text=r$M;var r$T=170*r$l,r$U=r$l*(12*r$i._view.length+3*r$l)+4;r$i._txt.fontSize=r$i._fontSize*r$l,r$i._leftText.fontSize=r$i._fontSize*r$l,r$e.size(r$T,r$U),r$e.graphics.clear(),r$e.graphics.setAlpha(.5),r$e.graphics.drawRect(0,0,r$T,r$U,"#999999"),r$e.graphics.setAlpha(1),r$i.loop()},r$i.enable=function(){r$O.timer.frameLoop(1,r$i,r$i.loop)},r$i.hide=function(){r$i._show=!1,r$O.timer.clear(r$i,r$i.loop),r$i._canvas&&r$f.removeElement(r$i._canvas.source)},r$i.clear=function(){r$i.trianglesFaces=r$i.drawCall=r$i.shaderCall=r$i.spriteCount=r$i.spriteRenderUseCacheCount=r$i.treeNodeCollision=r$i.treeSpriteCollision=r$i.canvasNormal=r$i.canvasBitmap=r$i.canvasReCache=0},r$i.loop=function(){r$i._count++;var r$S=r$f.now();if(!(r$S-r$i._timer<1e3)){var r$Q=r$i._count;if(r$i.FPS=Math.round(1e3*r$Q/(r$S-r$i._timer)),r$i._show){r$i.trianglesFaces=Math.round(r$i.trianglesFaces/r$Q),r$i.spriteCount=r$i._useCanvas?(r$i.drawCall=Math.round(r$i.drawCall/r$Q)-2,r$i.shaderCall=Math.round(r$i.shaderCall/r$Q),Math.round(r$i.spriteCount/r$Q)-1):(r$i.drawCall=Math.round(r$i.drawCall/r$Q)-2,r$i.shaderCall=Math.round(r$i.shaderCall/r$Q)-4,Math.round(r$i.spriteCount/r$Q)-4),r$i.spriteRenderUseCacheCount=Math.round(r$i.spriteRenderUseCacheCount/r$Q),r$i.canvasNormal=Math.round(r$i.canvasNormal/r$Q),r$i.canvasBitmap=Math.round(r$i.canvasBitmap/r$Q),r$i.canvasReCache=Math.ceil(r$i.canvasReCache/r$Q),r$i.treeNodeCollision=Math.round(r$i.treeNodeCollision/r$Q),r$i.treeSpriteCollision=Math.round(r$i.treeSpriteCollision/r$Q);var r$e=0<r$i.FPS?Math.floor(1e3/r$i.FPS).toString():" ";r$i._fpsStr=r$i.FPS+(r$i.renderSlow?" slow":"")+" "+r$e,r$i._spriteStr=r$i.spriteCount+(r$i.spriteRenderUseCacheCount?"/"+r$i.spriteRenderUseCacheCount:""),r$i._canvasStr=r$i.canvasReCache+"/"+r$i.canvasNormal+"/"+r$i.canvasBitmap,r$i.currentMemorySize=r$a.systemResourceManager.memorySize,r$i._useCanvas?r$i.renderInfoPre():r$i.renderInfo(),r$i.clear()}r$i._count=0,r$i._timer=r$S}},r$i.renderInfoPre=function(){if(r$i._canvas){var r$S=r$i._ctx;r$S.clearRect(r$i._first?0:r$i._vx,0,r$i._width,r$i._height);for(var r$Q=r$m.WebGL.mainContext,r$e=0;r$e<r$i._view.length;r$e++){var r$l=r$i._view[r$e];r$i._first&&(r$S.fillStyle="white",r$S.fillText(r$l.title,r$l.x,r$l.y,null,null,null)),r$S.fillStyle=r$l.color;var r$M=-1;if((r$l=r$i._view[r$e]).varying){if(r$Q)switch(r$l.varying){case 1:r$M=r$Q.getParameter(r$Q[r$l.value]);break;case 2:r$M=r$Q.getExtension(r$l.value)}}else r$M=r$i[r$l.value];"M"==r$l.units&&(r$M=Math.floor(r$M/1048576*100)/100+" M"),"K"==r$l.units&&(r$M=Math.floor(r$M/1024*100)/100+" K"),"string"==r$l.units&&(r$M=r$M.match(/\d+\.?\d/i)),r$S.fillText(r$M+"",r$l.x+r$i._vx,r$l.y,null,null,null)}}},r$i.renderInfo=function(){for(var r$S="",r$Q=r$m.WebGL.mainContext,r$e=0;r$e<r$i._view.length;r$e++){var r$l=r$i._view[r$e],r$M=-1;if(r$l.varying){if(r$Q)switch(r$l.varying){case 1:r$M=r$Q.getParameter(r$Q[r$l.value]);break;case 2:r$M=r$Q.getExtension(r$l.value)}}else r$M=r$i[r$l.value];"M"==r$l.units&&(r$M=Math.floor(r$M/1048576*100)/100+" M"),"K"==r$l.units&&(r$M=Math.floor(r$M/1024*100)/100+" K"),"string"==r$l.units&&(r$M=r$M.match(/\d+\.?\d/i)),r$S+=r$M+"\n"}r$i._txt.text=r$S},r$i.FPS=0,r$i.loopCount=0,r$i.shaderCall=0,r$i.drawCall=0,r$i.trianglesFaces=0,r$i.spriteCount=0,r$i.spriteRenderUseCacheCount=0,r$i.treeNodeCollision=0,r$i.treeSpriteCollision=0,r$i.canvasNormal=0,r$i.canvasBitmap=0,r$i.canvasReCache=0,r$i.renderSlow=!1,r$i.currentMemorySize=0,r$i._fpsStr=null,r$i._canvasStr=null,r$i._spriteStr=null,r$i._fpsData=[],r$i._timer=0,r$i._count=0,r$i._view=[],r$i._fontSize=12,r$i._txt=null,r$i._leftText=null,r$i._sp=null,r$i._show=!1,r$i._useCanvas=!1,r$i._canvas=null,r$i._ctx=null,r$i._first=!1,r$i._vx=NaN,r$i._width=0,r$i._height=100,r$i}(),r$C=(function(){function r$S(){this._strsToID={},this._idToStrs=[],this._length=0}r$o(r$S,"laya.utils.StringKey");var r$Q=r$S.prototype;r$Q.add=function(r$S){var r$Q=this._strsToID[r$S];return null!=r$Q?r$Q:(this._idToStrs[this._length]=r$S,this._strsToID[r$S]=this._length++)},r$Q.getID=function(r$S){var r$Q=this._strsToID[r$S];return null==r$Q?-1:r$Q},r$Q.getName=function(r$S){var r$Q=this._idToStrs[r$S];return null==r$Q?void 0:r$Q}}(),function(){var r$R;function r$S(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}r$o(r$S,"laya.utils.Timer");var r$Q=r$S.prototype;return r$Q._init=function(){r$O.timer&&r$O.timer.frameLoop(1,this,this._update)},r$Q._now=function(){return Date.now()},r$Q._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var r$S=this.currFrame=this.currFrame+this.scale,r$Q=this._now();this._delta=(r$Q-this._lastTimer)*this.scale;var r$e=this.currTimer=this.currTimer+this._delta;r$O.isDebug&&6e4<Math.abs(r$Q-this._lastTimer)&&console.error("系统时间错误！"+(r$Q-this._lastTimer)),this._lastTimer=r$Q;var r$l=this._handlers;for(r$T=this._count=0,r$U=r$l.length;r$T<r$U;r$T++)if(null!==(r$i=r$l[r$T]).method){var r$M=r$i.userFrame?r$S:r$e;if(r$M>=r$i.exeTime)if(r$i.repeat)if(r$i.jumpFrame)for(;r$M>=r$i.exeTime;)r$i.exeTime+=r$i.delay,r$i.run(!1);else r$i.exeTime+=r$i.delay,r$i.run(!1),r$M>r$i.exeTime&&(r$i.exeTime+=Math.ceil((r$M-r$i.exeTime)/r$i.delay)*r$i.delay);else r$i.run(!0)}else this._count++;(30<this._count||r$S%200==0)&&this._clearHandlers();for(var r$d=this._laters,r$T=0,r$U=r$d.length-1;r$T<=r$U;r$T++){var r$i=r$d[r$T];this._isIgnoreRecover(r$i)||(null!==r$i.method&&(delete this._map[r$i.key],r$i.run(!1)),this._recoverHandler(r$i)),r$T===r$U&&(r$U=r$d.length-1)}r$d.length=0}},r$Q._clearHandlers=function(){for(var r$S=this._handlers,r$Q=0,r$e=r$S.length;r$Q<r$e;r$Q++){var r$l=r$S[r$Q];null!==r$l.method?this._temp.push(r$l):this._isIgnoreRecover(r$l)?this._temp.push(r$l):this._recoverHandler(r$l)}this._handlers=this._temp,this._temp=r$S,this._temp.length=0},r$Q._recoverHandler=function(r$S){this._map[r$S.key]==r$S&&delete this._map[r$S.key],r$S.recover()},r$Q._create=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){if(!r$e)return r$M.apply(r$l,r$d),null;if(r$T){var r$i=this._getHandler(r$l,r$M);if(r$i)return r$i.repeat=r$Q,r$i.userFrame=r$S,r$i.delay=r$e,r$i.ignoreRecover=r$U,r$i.caller=r$l,r$i.method=r$M,r$i.args=r$d,r$i.exeTime=r$e+(r$S?this.currFrame:this.currTimer+this._now()-this._lastTimer),r$i}return(r$i=r$R.create()).repeat=r$Q,r$i.userFrame=r$S,r$i.delay=r$e,r$i.ignoreRecover=r$U,r$i.caller=r$l,r$i.method=r$M,r$i.args=r$d,r$i.exeTime=r$e+(r$S?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(r$i),this._handlers.push(r$i),r$i},r$Q._indexHandler=function(r$S){var r$Q=r$S.caller,r$e=r$S.method,r$l=r$Q?r$Q.$_GID||(r$Q.$_GID=r$V.getGID()):0,r$M=r$e.$_TID||(r$e.$_TID=this._mid++);r$S.key=r$l+"_"+r$M,this._map[r$S.key]=r$S},r$Q.once=function(r$S,r$Q,r$e,r$l,r$M){void 0===r$M&&(r$M=!0),this._create(!1,!1,r$S,r$Q,r$e,r$l,r$M,!1)},r$Q.loop=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){void 0===r$M&&(r$M=!0),void 0===r$d&&(r$d=!1),void 0===r$T&&(r$T=!1);var r$U=this._create(!1,!0,r$S,r$Q,r$e,r$l,r$M,r$T);r$U&&(r$U.jumpFrame=r$d)},r$Q.frameOnce=function(r$S,r$Q,r$e,r$l,r$M){void 0===r$M&&(r$M=!0),this._create(!0,!1,r$S,r$Q,r$e,r$l,r$M,!1)},r$Q.frameLoop=function(r$S,r$Q,r$e,r$l,r$M,r$d){void 0===r$M&&(r$M=!0),void 0===r$d&&(r$d=!1),this._create(!0,!0,r$S,r$Q,r$e,r$l,r$M,r$d)},r$Q.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+r$R._freeCount},r$Q.clear=function(r$S,r$Q){var r$e=this._getHandler(r$S,r$Q);return!(!r$e||this._isIgnoreRecover(r$e))&&(delete this._map[r$e.key],r$e.key=null,r$e.clear(),!0)},r$Q.clearAll=function(r$S){if(r$S)for(var r$Q=0,r$e=this._handlers.length;r$Q<r$e;r$Q++){var r$l=this._handlers[r$Q];r$l.caller===r$S&&(this._isIgnoreRecover(r$l)||(delete this._map[r$l.key],r$l.key=null,r$l.clear()))}},r$Q._getHandler=function(r$S,r$Q){var r$e=r$S?r$S.$_GID||(r$S.$_GID=r$V.getGID()):0,r$l=r$Q.$_TID||(r$Q.$_TID=this._mid++);return this._map[r$e+"_"+r$l]},r$Q._isIgnoreRecover=function(r$S){if(r$S.ignoreRecover||r$S.caller&&"IgnoreRecover"==r$S.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var r$Q="";try{arguments.propertyIsEnumerable.caller}catch(r$S){r$Q=r$S.stack}r$O.recordError("报错：核心定时器销毁忽略  "+r$Q)}return!0}return!1},r$Q.hasHandler=function(r$S,r$Q){return this._map[r$S.$_GID+"_"+r$Q.$_TID]},r$Q.callLater=function(r$S,r$Q,r$e){if(null==this._getHandler(r$S,r$Q)){var r$l=r$R.create();r$l.caller=r$S,r$l.method=r$Q,r$l.args=r$e,this._indexHandler(r$l),this._laters.push(r$l)}},r$Q.runCallLater=function(r$S,r$Q){var r$e=this._getHandler(r$S,r$Q);r$e&&null!=r$e.method&&(this._isIgnoreRecover(r$e)||(delete this._map[r$e.key],r$e.run(!0)))},r$Q.runTimer=function(r$S,r$Q){this.runCallLater(r$S,r$Q)},r$L(0,r$Q,"delta",function(){return this._delta}),r$S.__init$=function(){r$R=function(){function r$Q(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}r$o(r$Q,"");var r$S=r$Q.prototype;return r$S.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},r$S.recover=function(){this.clear(),this.args=r$Q._freeHandler,r$Q._freeHandler=this,r$Q._freeCount++},r$S.run=function(r$S){var r$Q=this.caller;if(r$Q&&r$Q.destroyed)return this.clear();var r$e=this.method,r$l=this.args;r$S&&this.clear(),null!=r$e&&(r$l?r$e.apply(r$Q,r$l):r$e.call(r$Q))},r$Q._freeHandler=null,r$Q._freeCount=0,r$Q.create=function(){var r$S=r$Q._freeHandler;return r$S?(r$Q._freeHandler=r$S.args,--r$Q._freeCount,r$S.args=null,r$S):new r$Q},r$Q}()},r$S}()),r$K=function(){function r$Y(){this.gid=0}r$o(r$Y,"laya.utils.Tween");var r$S=r$Y.prototype;return r$S.to=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){return void 0===r$d&&(r$d=0),void 0===r$T&&(r$T=!1),this._create(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,!0,!1,!0)},r$S.from=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){return void 0===r$d&&(r$d=0),void 0===r$T&&(r$T=!1),this._create(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,!1,!1,!0)},r$S._create=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){if(!r$S)throw new Error("Tween:target is null");this._target=r$S,this._duration=r$e,this._ease=r$l||r$Q.ease||r$Y.easeNone,this._complete=r$M||r$Q.complete,this._delay=r$d,this._props=[],this._usedTimer=0,this._startTimer=r$f.now(),this._usedPool=r$i,this._delayParam=null,this.update=r$Q.update;var r$o=r$S.$_GID||(r$S.$_GID=r$V.getGID());return r$Y.tweenMap[r$o]?(r$T&&r$Y.clearTween(r$S),r$Y.tweenMap[r$o].push(this)):r$Y.tweenMap[r$o]=[this],r$R?r$d<=0?this.firstStart(r$S,r$Q,r$U):(this._delayParam=[r$S,r$Q,r$U],r$O.scaleTimer.once(r$d,this,this.firstStart,this._delayParam)):this._initProps(r$S,r$Q,r$U),this},r$S.firstStart=function(r$S,r$Q,r$e){this._delayParam=null,r$S.destroyed?this.clear():(this._initProps(r$S,r$Q,r$e),this._beginLoop())},r$S._initProps=function(r$S,r$Q,r$e){for(var r$l in r$Q)if("number"==typeof r$S[r$l]){var r$M=r$e?r$S[r$l]:r$Q[r$l],r$d=r$e?r$Q[r$l]:r$S[r$l];this._props.push([r$l,r$M,r$d-r$M]),r$e||(r$S[r$l]=r$M)}},r$S._beginLoop=function(){r$O.scaleTimer.frameLoop(1,this,this._doEase)},r$S._doEase=function(){this._updateEase(r$f.now())},r$S._updateEase=function(r$S){var r$Q=this._target;if(r$Q){if(r$Q.destroyed)return r$Y.clearTween(r$Q);var r$e=this._usedTimer=r$S-this._startTimer-this._delay;if(!(r$e<0)){if(r$e>=this._duration)return this.complete();for(var r$l=0<r$e?this._ease(r$e,0,1,this._duration):0,r$M=this._props,r$d=0,r$T=r$M.length;r$d<r$T;r$d++){var r$U=r$M[r$d];r$Q[r$U[0]]=r$U[1]+r$l*r$U[2]}this.update&&this.update.run()}}},r$S.complete=function(){if(this._target){r$O.scaleTimer.runTimer(this,this.firstStart);for(var r$S=this._target,r$Q=this._props,r$e=this._complete,r$l=0,r$M=r$Q.length;r$l<r$M;r$l++){var r$d=r$Q[r$l];r$S[r$d[0]]=r$d[1]+r$d[2]}this.update&&this.update.run(),this.clear(),r$e&&r$e.run()}},r$S.pause=function(){r$O.scaleTimer.clear(this,this._beginLoop),r$O.scaleTimer.clear(this,this._doEase),r$O.scaleTimer.clear(this,this.firstStart);var r$S;(r$S=r$f.now()-this._startTimer-this._delay)<0&&(this._usedTimer=r$S)},r$S.setStartTime=function(r$S){this._startTimer=r$S},r$S.clear=function(){this._target&&(this._remove(),this._clear())},r$S._clear=function(){this.pause(),r$O.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,r$Z.recover("tween",this))},r$S.recover=function(){this._usedPool=!0,this._clear()},r$S._remove=function(){var r$S=r$Y.tweenMap[this._target.$_GID];if(r$S)for(var r$Q=0,r$e=r$S.length;r$Q<r$e;r$Q++)if(r$S[r$Q]===this){r$S.splice(r$Q,1);break}},r$S.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=r$f.now(),this._delayParam)r$O.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var r$S=this._props,r$Q=0,r$e=r$S.length;r$Q<r$e;r$Q++){var r$l=r$S[r$Q];this._target[r$l[0]]=r$l[1]}r$O.scaleTimer.once(this._delay,this,this._beginLoop)}},r$S.resume=function(){this._usedTimer>=this._duration||(this._startTimer=r$f.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?r$O.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},r$L(0,r$S,"progress",null,function(r$S){var r$Q=r$S*this._duration;this._startTimer=r$f.now()-this._delay-r$Q}),r$Y.to=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){return void 0===r$d&&(r$d=0),void 0===r$T&&(r$T=!1),void 0===r$U&&(r$U=!0),r$Z.getItemByClass("tween",r$Y)._create(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,!0,r$U,!0)},r$Y.from=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){return void 0===r$d&&(r$d=0),void 0===r$T&&(r$T=!1),void 0===r$U&&(r$U=!0),r$Z.getItemByClass("tween",r$Y)._create(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,!1,r$U,!0)},r$Y.clearAll=function(r$S){if(r$S&&r$S.$_GID){var r$Q=r$Y.tweenMap[r$S.$_GID];if(r$Q){for(var r$e=0,r$l=r$Q.length;r$e<r$l;r$e++)r$Q[r$e]._clear();r$Q.length=0}}},r$Y.clear=function(r$S){r$S.clear()},r$Y.clearTween=function(r$S){r$Y.clearAll(r$S)},r$Y.easeNone=function(r$S,r$Q,r$e,r$l){return r$e*r$S/r$l+r$Q},r$Y.tweenMap={},r$Y}(),r$V=function(){function r$U(){}return r$o(r$U,"laya.utils.Utils"),r$U.toRadian=function(r$S){return r$S*r$U._pi2},r$U.toAngle=function(r$S){return r$S*r$U._pi},r$U.toHexColor=function(r$S){if(r$S<0||isNaN(r$S))return null;for(var r$Q=r$S.toString(16);r$Q.length<6;)r$Q="0"+r$Q;return"#"+r$Q},r$U.getGID=function(){return r$U._gid++},r$U.concatArray=function(r$S,r$Q){if(!r$Q)return r$S;if(!r$S)return r$Q;var r$e=0,r$l=r$Q.length;for(r$e=0;r$e<r$l;r$e++)r$S.push(r$Q[r$e]);return r$S},r$U.clearArray=function(r$S){return r$S&&(r$S.length=0),r$S},r$U.copyArray=function(r$S,r$Q){if(r$S||(r$S=[]),!r$Q)return r$S;r$S.length=r$Q.length;var r$e=0,r$l=r$Q.length;for(r$e=0;r$e<r$l;r$e++)r$S[r$e]=r$Q[r$e];return r$S},r$U.getGlobalRecByPoints=function(r$S,r$Q,r$e,r$l,r$M){var r$d,r$T;return r$d=new r$H(r$Q,r$e),r$d=r$S.localToGlobal(r$d),r$T=new r$H(r$l,r$M),r$T=r$S.localToGlobal(r$T),r$g._getWrapRec([r$d.x,r$d.y,r$T.x,r$T.y])},r$U.getGlobalPosAndScale=function(r$S){return r$U.getGlobalRecByPoints(r$S,0,0,1,1)},r$U.bind=function(r$S,r$Q){return r$S.bind(r$Q)},r$U.measureText=function(r$S,r$Q){return r$k.measureText(r$S,r$Q)},r$U.updateOrder=function(r$S){if(!r$S||r$S.length<2)return!1;for(var r$Q,r$e=1,r$l=0,r$M=r$S.length,r$d=NaN;r$e<r$M;){for(r$Q=r$S[r$l=r$e],r$d=r$S[r$l]._zOrder;-1<--r$l&&r$S[r$l]._zOrder>r$d;)r$S[r$l+1]=r$S[r$l];r$S[r$l+1]=r$Q,r$e++}var r$T=r$Q.parent.conchModel;if(r$T)if(null!=r$T.updateZOrder)r$T.updateZOrder();else{for(r$e=0;r$e<r$M;r$e++)r$T.removeChild(r$S[r$e].conchModel);for(r$e=0;r$e<r$M;r$e++)r$T.addChildAt(r$S[r$e].conchModel,r$e)}return!0},r$U.transPointList=function(r$S,r$Q,r$e){var r$l=0,r$M=r$S.length;for(r$l=0;r$l<r$M;r$l+=2)r$S[r$l]+=r$Q,r$S[r$l+1]+=r$e},r$U.parseInt=function(r$S,r$Q){void 0===r$Q&&(r$Q=0);var r$e=r$f.window.parseInt(r$S,r$Q);return isNaN(r$e)?0:r$e},r$U.getFileExtension=function(r$S){r$U._extReg.lastIndex=r$S.lastIndexOf(".");var r$Q=r$U._extReg.exec(r$S);return r$Q&&1<r$Q.length?r$Q[1].toLowerCase():null},r$U.getTransformRelativeToWindow=function(r$S,r$Q,r$e){var r$l=r$O.stage,r$M=laya.utils.Utils.getGlobalPosAndScale(r$S),r$d=r$l._canvasTransform.clone(),r$T=r$d.tx,r$U=r$d.ty;r$d.rotate(-Math.PI/180*r$O.stage.canvasDegree),r$d.scale(r$O.stage.clientScaleX,r$O.stage.clientScaleY);var r$i=r$O.stage.canvasDegree%180!=0,r$R=NaN,r$o=NaN;r$i?(r$R=r$e+r$M.y,r$o=r$Q+r$M.x,r$R*=r$d.d,r$o*=r$d.a,90==r$O.stage.canvasDegree?(r$R=r$T-r$R,r$o+=r$U):(r$R+=r$T,r$o=r$U-r$o)):(r$R=r$Q+r$M.x,r$o=r$e+r$M.y,r$R*=r$d.a,r$o*=r$d.d,r$R+=r$T,r$o+=r$U);var r$Y=NaN,r$p=NaN;return r$p=r$i?(r$Y=r$d.d*r$M.height,r$d.a*r$M.width):(r$Y=r$d.a*r$M.width,r$d.d*r$M.height),{x:r$R,y:r$o,scaleX:r$Y,scaleY:r$p}},r$U.fitDOMElementInArea=function(r$S,r$Q,r$e,r$l,r$M,r$d){r$S._fitLayaAirInitialized||(r$S._fitLayaAirInitialized=!0,r$S.style.transformOrigin=r$S.style.webKittransformOrigin="left top",r$S.style.position="absolute");var r$T=r$U.getTransformRelativeToWindow(r$Q,r$e,r$l);r$S.style.transform=r$S.style.webkitTransform="scale("+r$T.scaleX+","+r$T.scaleY+") rotate("+r$O.stage.canvasDegree+"deg)",r$S.style.width=r$M+"px",r$S.style.height=r$d+"px",r$S.style.left=r$T.x+"px",r$S.style.top=r$T.y+"px"},r$U.isOkTextureList=function(r$S){if(!r$S)return!1;var r$Q,r$e=0,r$l=r$S.length;for(r$e=0;r$e<r$l;r$e++)if(!(r$Q=r$S[r$e])||!r$Q.source)return!1;return!0},r$U.isOKCmdList=function(r$S){if(!r$S)return!1;var r$Q,r$e,r$l=0,r$M=r$S.length,r$d=r$m._context;for(r$l=0;r$l<r$M;r$l++)switch((r$Q=r$S[r$l]).callee){case r$d._drawTexture:case r$d._fillTexture:case r$d._drawTextureWithTransform:if(!(r$e=r$Q[0])||!r$e.source)return!1}return!0},r$U._gid=1,r$U._pi=180/Math.PI,r$U._pi2=Math.PI/180,r$U._extReg=/\.(\w+)\??/g,r$U.parseXMLFromString=function(r$S){var r$Q;if(r$S=r$S.replace(/>\s+</g,"><"),-1<(r$Q=(new DOMParser).parseFromString(r$S,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(r$Q.firstChild.firstChild.textContent);return r$Q},r$U}(),r$_=function(){function r$S(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],r$m.isWebGL&&r$u.regCacheByFunction(r$V.bind(this.startDispose,this),r$V.bind(this.getCacheList,this))}r$o(r$S,"laya.utils.VectorGraphManager");var r$Q=r$S.prototype;return r$Q.getId=function(){return this._id++},r$Q.addShape=function(r$S,r$Q){this.shapeDic[r$S]=r$Q,this.useDic[r$S]||(this.useDic[r$S]=!0)},r$Q.addLine=function(r$S,r$Q){this.shapeLineDic[r$S]=r$Q,this.shapeLineDic[r$S]||(this.shapeLineDic[r$S]=!0)},r$Q.getShape=function(r$S){this._checkKey&&null!=this.useDic[r$S]&&(this.useDic[r$S]=!0)},r$Q.deleteShape=function(r$S){this.shapeDic[r$S]&&(this.shapeDic[r$S]=null,delete this.shapeDic[r$S]),this.shapeLineDic[r$S]&&(this.shapeLineDic[r$S]=null,delete this.shapeLineDic[r$S]),null!=this.useDic[r$S]&&delete this.useDic[r$S]},r$Q.getCacheList=function(){var r$S,r$Q=[];for(r$S in this.shapeDic)r$Q.push(this.shapeDic[r$S]);for(r$S in this.shapeLineDic)r$Q.push(this.shapeLineDic[r$S]);return r$Q},r$Q.startDispose=function(r$S){var r$Q;for(r$Q in this.useDic)this.useDic[r$Q]=!1;this._checkKey=!0},r$Q.endDispose=function(){if(this._checkKey){var r$S;for(r$S in this.useDic)this.useDic[r$S]||this.deleteShape(r$S);this._checkKey=!1}},r$S.getInstance=function(){return r$S.instance=r$S.instance||new r$S},r$S.instance=null,r$S}(),r$s=function(){function r$l(){this._obj=null,this._obj=r$l.supportWeakMap?new r$f.window.WeakMap:{},r$l.supportWeakMap||r$l._maps.push(this)}r$o(r$l,"laya.utils.WeakObject");var r$S=r$l.prototype;return r$S.set=function(r$S,r$Q){if(null!=r$S)if(r$l.supportWeakMap){var r$e=r$S;"string"!=typeof r$S&&"number"!=typeof r$S||(r$e=r$l._keys[r$S])||(r$e=r$l._keys[r$S]={k:r$S}),this._obj.set(r$e,r$Q)}else"string"==typeof r$S||"number"==typeof r$S?this._obj[r$S]=r$Q:(r$S.$_GID||(r$S.$_GID=r$V.getGID()),this._obj[r$S.$_GID]=r$Q)},r$S.get=function(r$S){if(null==r$S)return null;if(r$l.supportWeakMap){var r$Q="string"==typeof r$S||"number"==typeof r$S?r$l._keys[r$S]:r$S;return r$Q?this._obj.get(r$Q):null}return"string"==typeof r$S||"number"==typeof r$S?this._obj[r$S]:this._obj[r$S.$_GID]},r$S.del=function(r$S){if(null!=r$S)if(r$l.supportWeakMap){var r$Q="string"==typeof r$S||"number"==typeof r$S?r$l._keys[r$S]:r$S;if(!r$Q)return;this._obj.delete(r$Q)}else"string"==typeof r$S||"number"==typeof r$S?delete this._obj[r$S]:delete this._obj[this._obj.$_GID]},r$S.has=function(r$S){if(null==r$S)return!1;if(r$l.supportWeakMap){var r$Q="string"==typeof r$S||"number"==typeof r$S?r$l._keys[r$S]:r$S;return this._obj.has(r$Q)}return"string"==typeof r$S||"number"==typeof r$S?null!=this._obj[r$S]:null!=this._obj[this._obj.$_GID]},r$l.__init__=function(){(r$l.supportWeakMap=null!=r$f.window.WeakMap)||r$O.timer.loop(r$l.delInterval,null,r$l.clearCache)},r$l.clearCache=function(){for(var r$S=0,r$Q=r$l._maps.length;r$S<r$Q;r$S++){r$l._maps[r$S]._obj={}}},r$l.supportWeakMap=!1,r$l.delInterval=3e5,r$l._keys={},r$l._maps=[],r$i(r$l,["I",function(){return this.I=new r$l}]),r$l}(),r$y=function(){function r$S(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}r$o(r$S,"laya.utils.WordText");var r$Q=r$S.prototype;return r$Q.setText=function(r$S){this.changed=!0,this._text=r$S},r$Q.toString=function(){return this._text},r$Q.charCodeAt=function(r$S){return this._text?this._text.charCodeAt(r$S):NaN},r$Q.charAt=function(r$S){return this._text?this._text.charAt(r$S):null},r$L(0,r$Q,"length",function(){return this._text?this._text.length:0}),r$S}(),r$SS=function(r$S){function r$T(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,r$T.__super.call(this),this._childs=r$T.ARRAY_EMPTY,this._$P=r$T.PROP_EMPTY,this.timer=r$O.scaleTimer,this.conchModel=r$m.isConchNode?this.createConchModel():null}r$o(r$T,"laya.display.Node",r$R);var r$Q=r$T.prototype;return r$Q._setBit=function(r$S,r$Q){1==r$S&&(this._getBit(r$S)!=r$Q&&this._updateDisplayedInstage());r$Q?this._bits|=r$S:this._bits&=~r$S},r$Q._getBit=function(r$S){return 0!=(this._bits&r$S)},r$Q._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},r$Q._setUpNoticeType=function(r$S){var r$Q=this;for(r$Q._setBit(r$S,!0),r$Q=r$Q.parent;r$Q;){if(r$Q._getBit(r$S))return;r$Q._setBit(r$S,!0),r$Q=r$Q.parent}},r$Q.on=function(r$S,r$Q,r$e,r$l){return"display"!==r$S&&"undisplay"!==r$S||this._getBit(1)||this._setUpNoticeType(1),this._createListener(r$S,r$Q,r$e,r$l,!1)},r$Q.once=function(r$S,r$Q,r$e,r$l){return"display"!==r$S&&"undisplay"!==r$S||this._getBit(1)||this._setUpNoticeType(1),this._createListener(r$S,r$Q,r$e,r$l,!0)},r$Q.createConchModel=function(){return null},r$Q.destroy=function(r$S){void 0===r$S&&(r$S=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(r$S?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},r$Q.destroyChildren=function(){if(this._childs)for(var r$S=this._childs.length-1;-1<r$S;r$S--)this._childs[r$S].destroy(!0)},r$Q.addChild=function(r$S){if(!r$S||this.destroyed||r$S===this)return r$S;if(r$S.zOrder&&this._set$P("hasZorder",!0),r$S._parent===this){var r$Q=this.getChildIndex(r$S);r$Q!==this._childs.length-1&&(this._childs.splice(r$Q,1),this._childs.push(r$S),this.conchModel&&(this.conchModel.removeChild(r$S.conchModel),this.conchModel.addChildAt(r$S.conchModel,this._childs.length-1)),this._childChanged())}else r$S.parent&&r$S.parent.removeChild(r$S),this._childs===r$T.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(r$S),this.conchModel&&this.conchModel.addChildAt(r$S.conchModel,this._childs.length-1),(r$S.parent=this)._childChanged();return r$S},r$Q.addChildren=function(r$S){for(var r$Q=arguments,r$e=0,r$l=r$Q.length;r$e<r$l;)this.addChild(r$Q[r$e++])},r$Q.addChildAt=function(r$S,r$Q){if(!r$S||this.destroyed||r$S===this)return r$S;if(r$S.zOrder&&this._set$P("hasZorder",!0),0<=r$Q&&r$Q<=this._childs.length){if(r$S._parent===this){var r$e=this.getChildIndex(r$S);this._childs.splice(r$e,1),this._childs.splice(r$Q,0,r$S),this.conchModel&&(this.conchModel.removeChild(r$S.conchModel),this.conchModel.addChildAt(r$S.conchModel,r$Q)),this._childChanged()}else r$S.parent&&r$S.parent.removeChild(r$S),this._childs===r$T.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(r$Q,0,r$S),this.conchModel&&this.conchModel.addChildAt(r$S.conchModel,r$Q),r$S.parent=this;return r$S}throw new Error("appendChildAt:The index is out of bounds")},r$Q.getChildIndex=function(r$S){return this._childs.indexOf(r$S)},r$Q.getChildByName=function(r$S){var r$Q=this._childs;if(r$Q)for(var r$e=0,r$l=r$Q.length;r$e<r$l;r$e++){var r$M=r$Q[r$e];if(r$M.name===r$S)return r$M}return null},r$Q._get$P=function(r$S){return this._$P[r$S]},r$Q._set$P=function(r$S,r$Q){return this.destroyed||(this._$P===r$T.PROP_EMPTY&&(this._$P={}),this._$P[r$S]=r$Q),r$Q},r$Q.getChildAt=function(r$S){return this._childs[r$S]},r$Q.setChildIndex=function(r$S,r$Q){var r$e=this._childs;if(r$Q<0||r$Q>=r$e.length)throw new Error("setChildIndex:The index is out of bounds.");var r$l=this.getChildIndex(r$S);if(r$l<0)throw new Error("setChildIndex:node is must child of this object.");return r$e.splice(r$l,1),r$e.splice(r$Q,0,r$S),this.conchModel&&(this.conchModel.removeChild(r$S.conchModel),this.conchModel.addChildAt(r$S.conchModel,r$Q)),this._childChanged(),r$S},r$Q._childChanged=function(r$S){},r$Q.removeChild=function(r$S){if(!this._childs)return r$S;var r$Q=this._childs.indexOf(r$S);return this.removeChildAt(r$Q)},r$Q.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},r$Q.removeChildByName=function(r$S){var r$Q=this.getChildByName(r$S);return r$Q&&this.removeChild(r$Q),r$Q},r$Q.removeChildAt=function(r$S){var r$Q=this.getChildAt(r$S);if(r$Q){for(var r$e=this._childs.length-1,r$l=r$S;r$l<r$e;++r$l)this._childs[r$l]=this._childs[r$l+1];this._childs.length=r$e,this.conchModel&&this.conchModel.removeChild(r$Q.conchModel),r$Q.parent=null}return r$Q},r$Q.removeChildren=function(r$S,r$Q){if(void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=2147483647),this._childs&&0<this._childs.length){var r$e=this._childs;if(0===r$S&&r$d<=r$Q){var r$l=r$e;this._childs=r$T.ARRAY_EMPTY}else r$l=r$e.splice(r$S,r$Q-r$S);for(var r$M=0,r$d=r$l.length;r$M<r$d;r$M++)r$l[r$M].parent=null,this.conchModel&&this.conchModel.removeChild(r$l[r$M].conchModel)}return this},r$Q.replaceChild=function(r$S,r$Q){var r$e=this._childs.indexOf(r$Q);return-1<r$e?(this._childs.splice(r$e,1,r$S),this.conchModel&&(this.conchModel.removeChild(r$Q.conchModel),this.conchModel.addChildAt(r$S.conchModel,r$e)),r$Q.parent=null,r$S.parent=this,r$S):null},r$Q._updateDisplayedInstage=function(){var r$S;r$S=this;var r$Q=r$O.stage;for(this._displayedInStage=!1;r$S;){if(r$S._getBit(1)){this._displayedInStage=r$S._displayedInStage;break}if(r$S==r$Q||r$S._displayedInStage){this._displayedInStage=!0;break}r$S=r$S.parent}},r$Q._setDisplay=function(r$S){this._displayedInStage!==r$S&&((this._displayedInStage=r$S)?this.event("display"):this.event("undisplay"))},r$Q._displayChild=function(r$S,r$Q){var r$e=r$S._childs;if(r$e)for(var r$l=0;r$l<r$e.length;r$l++){var r$M=r$e[r$l];r$M&&r$M._getBit(1)&&(0<r$M._childs.length?this._displayChild(r$M,r$Q):r$M._setDisplay(r$Q))}r$S._setDisplay(r$Q)},r$Q.contains=function(r$S){if(r$S===this)return!0;for(;r$S;){if(r$S.parent===this)return!0;r$S=r$S.parent}return!1},r$Q.timerLoop=function(r$S,r$Q,r$e,r$l,r$M,r$d){void 0===r$M&&(r$M=!0),void 0===r$d&&(r$d=!1),this.timer.loop(r$S,r$Q,r$e,r$l,r$M,r$d)},r$Q.timerOnce=function(r$S,r$Q,r$e,r$l,r$M){void 0===r$M&&(r$M=!0),this.timer._create(!1,!1,r$S,r$Q,r$e,r$l,r$M)},r$Q.frameLoop=function(r$S,r$Q,r$e,r$l,r$M){void 0===r$M&&(r$M=!0),this.timer._create(!0,!0,r$S,r$Q,r$e,r$l,r$M)},r$Q.frameOnce=function(r$S,r$Q,r$e,r$l,r$M){void 0===r$M&&(r$M=!0),this.timer._create(!0,!1,r$S,r$Q,r$e,r$l,r$M)},r$Q.clearTimer=function(r$S,r$Q){this.timer.clear(r$S,r$Q)},r$L(0,r$Q,"numChildren",function(){return this._childs.length}),r$L(0,r$Q,"destroyed",function(){return this._destroyed}),r$L(0,r$Q,"parent",function(){return this._parent},function(r$S){this._parent!==r$S&&(r$S?(this._parent=r$S,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),r$S.displayedInStage&&this._displayChild(this,!0)),r$S._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=r$S))}),r$L(0,r$Q,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),r$T.ARRAY_EMPTY=[],r$T.PROP_EMPTY={},r$T.NOTICE_DISPLAY=1,r$T.MOUSEENABLE=2,r$T}(),r$QS=function(r$S){function r$p(r$S){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,r$p.__super.call(this),this._padding=r$p._PADDING,this._spacing=r$p._SPACING,this._aligns=r$p._ALIGNS,this._font=r$J.EMPTY,this._ower=r$S}r$o(r$p,"laya.display.css.CSSStyle",r$S);var r$Q=r$p.prototype;return r$Q.destroy=function(){this._ower=null,this._font=null,this._rect=null},r$Q.inherit=function(r$S){this._font=r$S._font,this._spacing=r$S._spacing===r$p._SPACING?r$p._SPACING:r$S._spacing.slice(),this.lineHeight=r$S.lineHeight},r$Q._widthAuto=function(){return 0!=(262144&this._type)},r$Q.widthed=function(r$S){return 0!=(8&this._type)},r$Q._calculation=function(r$S,r$Q){if(r$Q.indexOf("%")<0)return!1;var r$l=this._ower,r$M=r$l.parent,r$d=this._rect;function r$T(r$S,r$Q,r$e){return r$S*r$e[0]+r$Q*r$e[1]+r$e[2]}function r$e(r$S){var r$Q=r$M.width,r$e=r$l.width;r$d.width&&(r$l.width=r$T(r$Q,r$e,r$d.width)),r$d.height&&(r$l.height=r$T(r$Q,r$e,r$d.height)),r$d.left&&(r$l.x=r$T(r$Q,r$e,r$d.left)),r$d.top&&(r$l.y=r$T(r$Q,r$e,r$d.top))}null===r$d&&(r$M._getCSSStyle()._type|=524288,r$M.on("resize",this,r$e),this._rect=r$d={input:{}});var r$U=r$Q.split(" ");return r$U[0]=parseFloat(r$U[0])/100,1==r$U.length?r$U[1]=r$U[2]=0:(r$U[1]=parseFloat(r$U[1])/100,r$U[2]=parseFloat(r$U[2])),r$d[r$S]=r$U,r$d.input[r$S]=r$Q,r$e(),!0},r$Q.heighted=function(r$S){return 0!=(8192&this._type)},r$Q.size=function(r$S,r$Q){var r$e=this._ower,r$l=!1;-1!==r$S&&r$S!=this._ower.width&&(this._type|=8,this._ower.width=r$S,r$l=!0),-1!==r$Q&&r$Q!=this._ower.height&&(this._type|=8192,this._ower.height=r$Q,r$l=!0),r$l&&(r$e._layoutLater(),524288&this._type&&r$e.event("resize",this))},r$Q._getAlign=function(){return this._aligns[0]},r$Q._getValign=function(){return this._aligns[1]},r$Q._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},r$Q._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new r$J(this._font))},r$Q.render=function(r$S,r$Q,r$e,r$l){var r$M=r$S.width,r$d=r$S.height;r$e-=r$S.pivotX,r$l-=r$S.pivotY,this._bgground&&null!=this._bgground.color&&r$Q.ctx.fillRect(r$e,r$l,r$M,r$d,this._bgground.color),this._border&&this._border.color&&r$Q.drawRect(r$e,r$l,r$M,r$d,this._border.color.strColor,this._border.size)},r$Q.getCSSStyle=function(){return this},r$Q.cssText=function(r$S){this.attrs(r$p.parseOneCSS(r$S,";"))},r$Q.attrs=function(r$S){if(r$S)for(var r$Q=0,r$e=r$S.length;r$Q<r$e;r$Q++){var r$l=r$S[r$Q];this[r$l[0]]=r$l[1]}},r$Q.setTransform=function(r$S){"none"===r$S?this._tf=r$U._TF_EMPTY:this.attrs(r$p.parseOneCSS(r$S,","))},r$Q.translate=function(r$S,r$Q){this._tf===r$U._TF_EMPTY&&(this._tf=new r$M),this._tf.translateX=r$S,this._tf.translateY=r$Q},r$Q.scale=function(r$S,r$Q){this._tf===r$U._TF_EMPTY&&(this._tf=new r$M),this._tf.scaleX=r$S,this._tf.scaleY=r$Q},r$Q._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},r$L(0,r$Q,"block",r$S.prototype._$get_block,function(r$S){r$S?this._type|=1:this._type&=-2}),r$L(0,r$Q,"valign",function(){return r$p._valigndef[this._aligns[1]]},function(r$S){this._aligns===r$p._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=r$p._valigndef[r$S]}),r$L(0,r$Q,"height",null,function(r$S){if(this._type|=8192,"string"==typeof r$S){if(this._calculation("height",r$S))return;r$S=parseInt(r$S)}this.size(-1,r$S)}),r$L(0,r$Q,"width",null,function(r$S){if(this._type|=8,"string"==typeof r$S){var r$Q=r$S.indexOf("auto");if(0<=r$Q&&(this._type|=262144,r$S=r$S.substr(0,r$Q)),this._calculation("width",r$S))return;r$S=parseInt(r$S)}this.size(r$S,-1)}),r$L(0,r$Q,"fontWeight",function(){return this._font.weight},function(r$S){this._createFont().weight=r$S}),r$L(0,r$Q,"left",null,function(r$S){var r$Q=this._ower;if("string"==typeof r$S){if("center"===r$S?r$S="50% -50% 0":"right"===r$S&&(r$S="100% -100% 0"),this._calculation("left",r$S))return;r$S=parseInt(r$S)}r$Q.x=r$S}),r$L(0,r$Q,"_translate",null,function(r$S){this.translate(r$S[0],r$S[1])}),r$L(0,r$Q,"absolute",function(){return 0!=(4&this._type)}),r$L(0,r$Q,"top",null,function(r$S){var r$Q=this._ower;if("string"==typeof r$S){if("middle"===r$S?r$S="50% -50% 0":"bottom"===r$S&&(r$S="100% -100% 0"),this._calculation("top",r$S))return;r$S=parseInt(r$S)}r$Q.y=r$S}),r$L(0,r$Q,"align",function(){return r$p._aligndef[this._aligns[0]]},function(r$S){this._aligns===r$p._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=r$p._aligndef[r$S]}),r$L(0,r$Q,"bold",function(){return this._font.bold},function(r$S){this._createFont().bold=r$S}),r$L(0,r$Q,"padding",function(){return this._padding},function(r$S){this._padding=r$S}),r$L(0,r$Q,"leading",function(){return this._spacing[1]},function(r$S){"string"==typeof r$S&&(r$S=parseInt(r$S+"")),this._spacing===r$p._SPACING&&(this._spacing=[0,0]),this._spacing[1]=r$S}),r$L(0,r$Q,"lineElement",function(){return 0!=(65536&this._type)},function(r$S){r$S?this._type|=65536:this._type&=-65537}),r$L(0,r$Q,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(r$S){this.lineElement=!1,"right"===r$S?this._type|=32768:this._type&=-32769}),r$L(0,r$Q,"textDecoration",function(){return this._font.decoration},function(r$S){this._createFont().decoration=r$S}),r$L(0,r$Q,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(r$S){"nowrap"===r$S&&(this._type|=131072),"none"===r$S&&(this._type&=-131073)}),r$L(0,r$Q,"background",null,function(r$S){r$S?(this._bgground||(this._bgground={}),this._bgground.color=r$S,this._ower.conchModel&&this._ower.conchModel.bgColor(r$S),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),r$L(0,r$Q,"wordWrap",function(){return 0==(131072&this._type)},function(r$S){r$S?this._type&=-131073:this._type|=131072}),r$L(0,r$Q,"color",function(){return this._font.color},function(r$S){this._createFont().color=r$S}),r$L(0,r$Q,"password",function(){return this._font.password},function(r$S){this._createFont().password=r$S}),r$L(0,r$Q,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(r$S){"none"===r$S?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=r$S),this._ower.conchModel&&this._ower.conchModel.bgColor(r$S),this._ower._renderType|=256}),r$L(0,r$Q,"font",function(){return this._font.toString()},function(r$S){this._createFont().set(r$S)}),r$L(0,r$Q,"weight",null,function(r$S){this._createFont().weight=r$S}),r$L(0,r$Q,"letterSpacing",function(){return this._spacing[0]},function(r$S){"string"==typeof r$S&&(r$S=parseInt(r$S+"")),this._spacing===r$p._SPACING&&(this._spacing=[0,0]),this._spacing[0]=r$S}),r$L(0,r$Q,"fontSize",function(){return this._font.size},function(r$S){this._createFont().size=r$S}),r$L(0,r$Q,"italic",function(){return this._font.italic},function(r$S){this._createFont().italic=r$S}),r$L(0,r$Q,"fontFamily",function(){return this._font.family},function(r$S){this._createFont().family=r$S}),r$L(0,r$Q,"stroke",function(){return this._font.stroke[0]},function(r$S){this._createFont().stroke===r$J._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=r$S}),r$L(0,r$Q,"strokeColor",function(){return this._font.stroke[1]},function(r$S){this._createFont().stroke===r$J._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=r$S}),r$L(0,r$Q,"border",function(){return this._border?this._border.value:""},function(r$S){if("none"!=r$S){this._border||(this._border={});var r$Q=(this._border.value=r$S).split(" ");if(this._border.color=r$W.create(r$Q[r$Q.length-1]),1==r$Q.length)return this._border.size=1,void(this._border.type="solid");var r$e=0;0<r$Q[0].indexOf("px")?(this._border.size=parseInt(r$Q[0]),r$e++):this._border.size=1,this._border.type=r$Q[r$e],this._ower._renderType|=256}else this._border=null}),r$L(0,r$Q,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(r$S){r$S?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==r$S?null:r$W.create(r$S),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),r$L(0,r$Q,"position",function(){return 4&this._type?"absolute":""},function(r$S){"absolute"==r$S?this._type|=4:this._type&=-5}),r$L(0,r$Q,"display",null,function(r$S){switch(r$S){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),r$L(0,r$Q,"paddingLeft",function(){return this.padding[3]}),r$L(0,r$Q,"paddingTop",function(){return this.padding[0]}),r$L(0,r$Q,"_scale",null,function(r$S){this._ower.scale(r$S[0],r$S[1])}),r$L(0,r$Q,"_rotate",null,function(r$S){this._ower.rotation=r$S}),r$p.parseOneCSS=function(r$S,r$Q){for(var r$e,r$l=[],r$M=r$S.split(r$Q),r$d=0,r$T=r$M.length;r$d<r$T;r$d++){var r$U=r$M[r$d],r$i=r$U.indexOf(":"),r$R=r$U.substr(0,r$i).replace(/^\s+|\s+$/g,"");if(0!=r$R.length){var r$o=r$U.substr(r$i+1).replace(/^\s+|\s+$/g,""),r$Y=[r$R,r$o];switch(r$R){case"italic":case"bold":r$Y[1]="true"==r$o;break;case"line-height":r$Y[0]="lineHeight",r$Y[1]=parseInt(r$o);break;case"font-size":r$Y[0]="fontSize",r$Y[1]=parseInt(r$o);break;case"padding":1<(r$e=r$o.split(" ")).length||(r$e[1]=r$e[2]=r$e[3]=r$e[0]),r$Y[1]=[parseInt(r$e[0]),parseInt(r$e[1]),parseInt(r$e[2]),parseInt(r$e[3])];break;case"rotate":r$Y[0]="_rotate",r$Y[1]=parseFloat(r$o);break;case"scale":r$e=r$o.split(" "),r$Y[0]="_scale",r$Y[1]=[parseFloat(r$e[0]),parseFloat(r$e[1])];break;case"translate":r$e=r$o.split(" "),r$Y[0]="_translate",r$Y[1]=[parseInt(r$e[0]),parseInt(r$e[1])];break;default:(r$Y[0]=r$p._CSSTOVALUE[r$R])||(r$Y[0]=r$R)}r$l.push(r$Y)}}return r$l},r$p.parseCSS=function(r$S,r$Q){for(var r$e;null!=(r$e=r$p._parseCSSRegExp.exec(r$S));)r$p.styleSheets[r$e[1]]=r$p.parseOneCSS(r$e[2],";")},r$p.EMPTY=new r$p(null),r$p._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},r$p._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),r$p._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},r$p._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},r$p.styleSheets={},r$p.ALIGN_CENTER=1,r$p.ALIGN_RIGHT=2,r$p.VALIGN_MIDDLE=1,r$p.VALIGN_BOTTOM=2,r$p._CSS_BLOCK=1,r$p._DISPLAY_NONE=2,r$p._ABSOLUTE=4,r$p._WIDTH_SET=8,r$p._PADDING=[0,0,0,0],r$p._RECT=[-1,-1,-1,-1],r$p._SPACING=[0,0],r$p._ALIGNS=[0,0,0],r$p.ADDLAYOUTED=512,r$p._NEWFONT=4096,r$p._HEIGHT_SET=8192,r$p._BACKGROUND_SET=16384,r$p._FLOAT_RIGHT=32768,r$p._LINE_ELEMENT=65536,r$p._NOWARP=131072,r$p._WIDTHAUTO=262144,r$p._LISTERRESZIE=524288,r$p}(r$U),r$eS=function(r$S){function r$T(){this.url=null,this.audio=null,this.loaded=!1,r$T.__super.call(this)}r$o(r$T,"laya.media.h5audio.AudioSound",r$R);var r$Q=r$T.prototype;return r$Q.dispose=function(){var r$S=r$T._audioCache[this.url];r$S&&(r$S.src="",delete r$T._audioCache[this.url])},r$Q.load=function(r$S){var r$Q;if(r$S=r$b.formatURL(r$S),(this.url=r$S)==r$t._tMusic?(r$T._initMusicAudio(),(r$Q=r$T._musicAudio).src!=r$S&&(r$T._audioCache[r$Q.src]=null,r$Q=null)):r$Q=r$T._audioCache[r$S],r$Q&&2<=r$Q.readyState)this.event("complete");else{r$Q||(r$Q=r$S==r$t._tMusic?(r$T._initMusicAudio(),r$T._musicAudio):r$f.createElement("audio"),(r$T._audioCache[r$S]=r$Q).src=r$S),r$Q.addEventListener("canplaythrough",r$l),r$Q.addEventListener("error",r$M);var r$e=this;(this.audio=r$Q).load?r$Q.load():r$M()}function r$l(){r$d(),r$e.loaded=!0,r$e.event("complete")}function r$M(){r$Q.load=null,r$d(),r$e.event("error")}function r$d(){r$Q.removeEventListener("canplaythrough",r$l),r$Q.removeEventListener("error",r$M)}},r$Q.play=function(r$S,r$Q,r$e){if(void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),!this.url)return null;var r$l,r$M;if(!(r$l=this.url==r$t._tMusic?r$T._musicAudio:r$T._audioCache[this.url]))return null;r$M=r$Z.getItem("audio:"+this.url),r$m.isConchApp?r$M||((r$M=r$f.createElement("audio")).src=this.url):this.url==r$t._tMusic?(r$T._initMusicAudio(),(r$M=r$T._musicAudio).src=this.url):r$M=r$M||r$l.cloneNode(!0);var r$d=new r$pS(r$M);return r$d.url=this.url,r$d.loops=r$Q,r$d.startTime=r$S,r$d.startHandler=r$e,r$d.play(!1),r$t.addChannel(r$d),r$d},r$L(0,r$Q,"duration",function(){var r$S;return(r$S=r$T._audioCache[this.url])?r$S.duration:0}),r$T._initMusicAudio=function(){r$T._musicAudio||(r$T._musicAudio||(r$T._musicAudio=r$f.createElement("audio")),r$m.isConchApp||r$f.document.addEventListener("mousedown",r$T._makeMusicOK))},r$T._makeMusicOK=function(){r$f.document.removeEventListener("mousedown",r$T._makeMusicOK),r$T._musicAudio.src?r$T._musicAudio.play():(r$T._musicAudio.src="",r$T._musicAudio.load())},r$T._audioCache={},r$T._musicAudio=null,r$T}(),r$lS=function(r$S){function r$Q(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,r$Q.__super.call(this)}r$o(r$Q,"laya.media.SoundChannel",r$R);var r$e=r$Q.prototype;return r$e.play=function(){},r$e.stop=function(){},r$e.pause=function(){},r$e.resume=function(){},r$e.__runComplete=function(r$S){r$S&&r$S.run()},r$L(0,r$e,"volume",function(){return 1},function(r$S){}),r$L(0,r$e,"position",function(){return 0}),r$L(0,r$e,"duration",function(){return 0}),r$Q}(),r$MS=function(r$S){function r$Q(){r$Q.__super.call(this)}r$o(r$Q,"laya.media.Sound",r$R);var r$e=r$Q.prototype;return r$e.load=function(r$S){},r$e.play=function(r$S,r$Q,r$e){return void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),null},r$e.dispose=function(){},r$L(0,r$e,"duration",function(){return 0}),r$Q}(),r$dS=function(r$S){function r$M(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,r$M.__super.call(this)}r$o(r$M,"laya.media.webaudio.WebAudioSound",r$R);var r$Q=r$M.prototype;return r$Q.load=function(r$S){this.url=r$S,this.audioBuffer=r$M._dataCache[r$S],this.audioBuffer?this._loaded(this.audioBuffer):(r$M.e.on("loaded:"+r$S,this,this._loaded),r$M.e.on("err:"+r$S,this,this._err),r$M.__loadingSound[r$S]||(r$M.__loadingSound[r$S]=!0,r$O.loader.load(r$S,r$z.create(this,this.onloaded),null,r$US.BUFFER,4,!1,null,!0)))},r$Q.onloaded=function(r$S){r$S||this._err(),this._disposed?this._removeLoadEvents():(this.data=r$S,r$M.buffs.push({buffer:this.data,url:this.url}),r$M.decode())},r$Q._err=function(){if(this._removeLoadEvents(),r$M.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var r$S,r$Q,r$e,r$l=0;for(r$S=(r$Q=this.__toPlays).length,r$l=0;r$l<r$S;r$l++)(r$e=r$Q[r$l])[3]&&!r$e[3].isStopped&&r$e[3].event("error");this.__toPlays.length=0}},r$Q._loaded=function(r$S){this._removeLoadEvents(),this._disposed||(this.audioBuffer=r$S,this.loaded=!0,this.event("complete"))},r$Q._removeLoadEvents=function(){r$M.e.off("loaded:"+this.url,this,this._loaded),r$M.e.off("err:"+this.url,this,this._err)},r$Q.__playAfterLoaded=function(){if(this.__toPlays){var r$S,r$Q,r$e,r$l=0;for(r$S=(r$Q=this.__toPlays).length,r$l=0;r$l<r$S;r$l++)(r$e=r$Q[r$l])[3]&&!r$e[3].isStopped&&this.play(r$e[0],r$e[1],r$e[2],r$e[3]);this.__toPlays.length=0}},r$Q.play=function(r$S,r$Q,r$e,r$l){return void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),r$l=r$l||new r$JS,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([r$S,r$Q,r$e,r$l]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),r$l.url=this.url,r$l.loops=r$Q,r$l.audioBuffer=this.audioBuffer,r$l.startTime=r$S,r$l.startHandler=r$e,r$l.play(!1),r$t.addChannel(r$l),r$l},r$Q.dispose=function(){this._disposed=!0,delete r$M._dataCache[this.url],delete r$M.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},r$L(0,r$Q,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),r$M.decode=function(){if(!(r$M.buffs.length<=0||r$M.isDecoding))if(r$M.isDecoding=!0,(r$M.tInfo=r$M.buffs.shift())&&r$M.tInfo.buffer&&r$M.tInfo.buffer.byteLength)try{r$M.ctx.decodeAudioData(r$M.tInfo.buffer,r$M._done,r$M._fail)}catch(r$S){console.error("decodeAudioData error  byteLength:"+r$M.tInfo.buffer.byteLength+"  url:"+r$M.tInfo.url)}else r$M._fail()},r$M._done=function(r$S){r$M.e.event("loaded:"+r$M.tInfo.url,r$S),r$M._dataCache[r$M.tInfo.url]=r$S,r$M.isDecoding=!1,r$M.decode()},r$M._fail=function(){r$M.e.event("err:"+r$M.tInfo.url,null),r$M.isDecoding=!1,r$M.decode()},r$M._playEmptySound=function(){if(null!=r$M.ctx){if(r$M._emptySource&&(r$M._emptySource.stop(),r$M._emptySource.disconnect(0),!r$JS._tryCleanFailed))try{r$M._emptySource.buffer=null}catch(r$S){r$JS._tryCleanFailed=!0}var r$S=r$M.ctx.createBufferSource();r$S.buffer=r$M._miniBuffer,r$S.connect(r$M.ctx.destination),r$S.start(0,0,0),r$M._emptySource=r$S}},r$M._unlock=function(){r$M._unlocked||(r$M._playEmptySound(),"running"==r$M.ctx.state?(r$f.document.removeEventListener("mousedown",r$M._unlock,!0),r$f.document.removeEventListener("touchend",r$M._unlock,!0),r$f.document.removeEventListener("touchstart",r$M._unlock,!0),r$M._unlocked=!0):"suspended"==r$M.ctx.state&&r$t._recoverWebAudio())},r$M.initWebAudio=function(){"running"!=r$M.ctx.state&&(r$M._unlock(),r$f.document.addEventListener("mousedown",r$M._unlock,!0),r$f.document.addEventListener("touchend",r$M._unlock,!0),r$f.document.addEventListener("touchstart",r$M._unlock,!0))},r$M._emptySource=null,r$M._dataCache={},r$M.buffs=[],r$M.isDecoding=!1,r$M._unlocked=!1,r$M.tInfo=null,r$M.__loadingSound={},r$i(r$M,["window",function(){return this.window=r$f.window},"webAudioEnabled",function(){return this.webAudioEnabled=r$M.window.AudioContext||r$M.window.webkitAudioContext||r$M.window.mozAudioContext},"ctx",function(){return this.ctx=r$M.webAudioEnabled?new(r$M.window.AudioContext||r$M.window.webkitAudioContext||r$M.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=r$M.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new r$R}]),r$M}(),r$TS=function(r$S){function r$Q(){this._responseType=null,this._data=null,r$Q.__super.call(this),this._http=new r$f.window.XMLHttpRequest}r$o(r$Q,"laya.net.HttpRequest",r$R);var r$e=r$Q.prototype;return r$e.send=function(r$S,r$Q,r$e,r$l,r$M){void 0===r$e&&(r$e="get"),void 0===r$l&&(r$l="text"),this._responseType=r$l,this._data=null;var r$d=this,r$T=this._http;if(r$T.open(r$e,r$S,!0),r$M)for(var r$U=0;r$U<r$M.length;r$U++)r$T.setRequestHeader(r$M[r$U++],r$M[r$U]);else r$m.isConchApp||(r$Q&&"string"!=typeof r$Q?r$T.setRequestHeader("Content-Type","application/json"):r$T.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));r$T.responseType="arraybuffer"!==r$l?"text":"arraybuffer",r$T.onerror=function(r$S){r$d._onError(r$S)},r$T.onabort=function(r$S){r$d._onAbort(r$S)},r$T.onprogress=function(r$S){r$d._onProgress(r$S)},r$T.onload=function(r$S){r$d._onLoad(r$S)},r$T.send(r$Q)},r$e._onProgress=function(r$S){r$S&&r$S.lengthComputable&&this.event("progress",r$S.loaded/r$S.total)},r$e._onAbort=function(r$S){this.error("Request was aborted by user")},r$e._onError=function(r$S){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},r$e._onLoad=function(r$S){var r$Q=this._http,r$e=void 0!==r$Q.status?r$Q.status:200;200===r$e||204===r$e||0===r$e?this.complete():this.error("["+r$Q.status+"]"+r$Q.statusText+":"+r$Q.responseURL)},r$e.error=function(r$S){this.clear(),this.event("error",r$S)},r$e.complete=function(){this.clear();var r$Q=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=r$V.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(r$S){r$Q=!1,this.error(r$S.message)}r$Q&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},r$e.clear=function(){var r$S=this._http;r$S.onerror=r$S.onabort=r$S.onprogress=r$S.onload=null},r$L(0,r$e,"url",function(){return this._http.responseURL}),r$L(0,r$e,"http",function(){return this._http}),r$L(0,r$e,"data",function(){return this._data}),r$Q}(),r$US=function(r$S){function r$I(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,r$I.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}r$o(r$I,"laya.net.Loader",r$R);var r$Q=r$I.prototype;return r$Q.load=function(r$S,r$Q,r$e,r$l,r$M){if(r$S&&""!=r$S||console.error("Loader 加载的url不合法 "+r$S),void 0===r$e&&(r$e=!0),void 0===r$M&&(r$M=!1),0===(this._url=r$S).indexOf("data:image")?this._type=r$Q="image":this._type=r$Q||(r$Q=this.getTypeFromUrl(r$S)),this._cache=r$e,this._data=null,!r$M&&r$I.loadedMap[r$S])return this._data=r$I.loadedMap[r$S],this.event("progress",1),void this.event("complete",this._data);if(r$l&&r$I.setGroup(r$S,r$l),null!=r$I.parserMap[r$Q])return this._customParse=!0,void(r$I.parserMap[r$Q]instanceof laya.utils.Handler?r$I.parserMap[r$Q].runWith(this):r$I.parserMap[r$Q].call(null,this));if("image"===r$Q||"htmlimage"===r$Q||"nativeimage"===r$Q)return this._loadImage(r$S);if("ttf"===r$Q)return this._loadTTF(r$S);switch(r$Q){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:r$Q}r$I.preLoadedMap[r$S]?this.onLoaded(r$I.preLoadedMap[r$S]):r$T.resMgrLoad(r$S,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},r$Q.getTypeFromUrl=function(r$S){var r$Q=r$V.getFileExtension(r$S);return r$Q?r$I.typeMap[r$Q]:(console.warn("Not recognize the resources suffix",r$S),"text")},r$Q._loadTTF=function(r$S){r$S=r$b.formatURL(r$S);var r$Q=new r$h;r$Q.complete=r$z.create(this,this.onLoaded),r$Q.load(r$S)},r$Q._loadImage=function(r$S){r$T.imgMgrLoad(r$S,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},r$Q._loadImageComplete=function(r$S,r$Q,r$e){if(null!=r$e)if(r$e instanceof ArrayBuffer){var r$l=new DataView(r$e),r$M=new laya.webgl.resource.WebGLImage(new Uint8Array(r$e,8),r$S,0,!1,r$l.getUint32(0),r$l.getUint32(4));this.onLoaded(r$M)}else if(r$e instanceof r$oS)r$I.imgMgrSet[r$S]=r$Q,r$T.imgMgrLock(r$S,r$I.imgMgrSet[r$S]),this._url=r$S,this.complete(r$e);else{var r$d=-1!=r$S.indexOf(".png",r$S.length-4)?6408:6407;r$M=new laya.webgl.resource.WebGLImage(r$e,r$S,r$d,!1,r$e.width,r$e.height);this.onLoaded(r$M)}else this.event("error","Load image failed")},r$Q._loadSound=function(r$S){var r$Q=new r$t._soundClass,r$e=this;function r$l(){r$Q.offAll()}r$Q.on("complete",this,function(){r$l(),r$e.onLoaded(r$Q)}),r$Q.on("error",this,function(){r$l(),r$Q.dispose(),r$e.event("error","Load sound failed")}),r$Q.load(r$S)},r$Q.onProgress=function(r$S){"atlas"===this._type?this.event("progress",.3*r$S):this.event("progress",r$S)},r$Q.onError=function(r$S){this.event("error",r$S)},r$Q._loadedComplete=function(r$S,r$Q,r$e){if(null!=r$e)switch(this._type){case"atlas":case"plf":case"json":var r$l=new r$w(r$e);this.onLoaded(JSON.parse(r$l.readUTFBytes()));break;case"font":r$l=new r$w(r$e);this.onLoaded(r$V.parseXMLFromString(r$l.readUTFBytes()));break;default:this.onLoaded(r$e)}else this.event("error",r$S)},r$Q.onLoaded=function(r$S){var r$Q=this._type;if("plf"==r$Q)this.parsePLFData(r$S),this.complete(r$S);else if("image"===r$Q){var r$e=new r$oS(r$S);r$e.url=this._url,this.complete(r$e)}else if("sound"===r$Q||"htmlimage"===r$Q||"nativeimage"===r$Q)this.complete(r$S);else if("atlas"===r$Q){if(!r$S.src&&!r$S._setContext){if(!this._data){if((this._data=r$S).meta&&r$S.meta.image)for(var r$l=r$S.meta.image.split(","),r$M=0<=this._url.indexOf("/")?"/":"\\",r$d=this._url.lastIndexOf(r$M),r$T=0<=r$d?this._url.substr(0,r$d+1):"",r$U=0,r$i=r$l.length;r$U<r$i;r$U++)r$l[r$U]=r$T+r$l[r$U];else r$l=[this._url.replace(".json",".png")];r$l.reverse(),r$S.toLoads=r$l,r$S.pics=[]}return this.event("progress",.3+1/r$l.length*.6),this._loadImage(r$l.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(r$S),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var r$R=this._data.frames,r$o=this._url.split("?")[0],r$Y=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:r$o.substring(0,r$o.lastIndexOf("."))+"/",r$p=this._data.pics,r$J=r$b.formatURL(this._url),r$L=r$I.atlasMap[r$J]||(r$I.atlasMap[r$J]=[]);r$L.dir=r$Y;var r$j=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var r$c in r$j=parseFloat(this._data.meta.scale),r$R){var r$G,r$z=r$R[r$c],r$A=r$p[r$z.frame.idx?r$z.frame.idx:0],r$v=r$b.formatURL(r$Y+r$c);r$A.scaleRate=r$j,r$G=r$oS.create(r$A,r$z.frame.x,r$z.frame.y,r$z.frame.w,r$z.frame.h,r$z.spriteSourceSize.x,r$z.spriteSourceSize.y,r$z.sourceSize.w,r$z.sourceSize.h),r$I.cacheRes(r$v,r$G),r$I.keepCache(this._url,r$Y+r$c),r$G.url=r$v,r$L.push(r$v)}else for(r$c in r$R)r$A=r$p[(r$z=r$R[r$c]).frame.idx?r$z.frame.idx:0],r$v=r$b.formatURL(r$Y+r$c),r$I.cacheRes(r$v,r$oS.create(r$A,r$z.frame.x,r$z.frame.y,r$z.frame.w,r$z.frame.h,r$z.spriteSourceSize.x,r$z.spriteSourceSize.y,r$z.sourceSize.w,r$z.sourceSize.h)),r$I.loadedMap[r$v].url=r$v,r$I.keepCache(this._url,r$Y+r$c),r$L.push(r$v);delete this._data.pics,this.complete(this._data)}else if("font"==r$Q){if(!r$S.src)return this._data=r$S,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var r$D=new r$E;r$D.parseFont(this._data,r$S);var r$B=this._url.split(".fnt")[0].split("/"),r$O=r$B[r$B.length-1];r$cS.registerBitmapFont(r$O,r$D),this._data=r$D,this.complete(this._data)}else if("pkm"==r$Q){var r$H=r$BS.create(r$S,this._url),r$g=new r$oS(r$H);r$g.url=this._url,this.complete(r$g)}else this.complete(r$S)},r$Q.parsePLFData=function(r$S){var r$Q,r$e,r$l;for(r$Q in r$S)switch(r$l=r$S[r$Q],r$Q){case"json":case"text":for(r$e in r$l)r$I.preLoadedMap[r$b.formatURL(r$e)]=r$l[r$e];break;default:for(r$e in r$l)r$I.preLoadedMap[r$b.formatURL(r$e)]=r$l[r$e]}},r$Q.complete=function(r$S){this._data=r$S,this._customParse?this.event("loaded",r$S instanceof Array?[r$S]:r$S):(r$I._loaders.push(this),r$I._isWorking||r$I.checkNext())},r$Q.endLoad=function(r$S){r$S&&(this._data=r$S),this._cache&&r$I.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},r$L(0,r$Q,"url",function(){return this._url}),r$L(0,r$Q,"data",function(){return this._data}),r$L(0,r$Q,"cache",function(){return this._cache}),r$L(0,r$Q,"type",function(){return this._type}),r$I.checkNext=function(){r$I._isWorking=!0;for(var r$S=r$f.now();r$I._startIndex<r$I._loaders.length;)if(r$f.now(),r$I._loaders[r$I._startIndex].endLoad(),r$I._startIndex++,r$f.now()-r$S>r$I.maxTimeOut)return console.warn("loader callback cost a long time:"+(r$f.now()-r$S)+" url="+r$I._loaders[r$I._startIndex-1].url),void r$O.timer.frameOnce(1,null,r$I.checkNext);r$I._loaders.length=0,r$I._startIndex=0,r$I._isWorking=!1},r$I.clearRes=function(r$S,r$Q){if(null!=r$S){void 0===r$Q&&(r$Q=!1),r$S=r$b.formatURL(r$S);var r$e=r$I.getAtlas(r$S);if(r$e){for(var r$l=0,r$M=r$e.length;r$l<r$M;r$l++){var r$d=r$e[r$l],r$T=r$I.getRes(r$d);delete r$I.loadedMap[r$d],r$I.clearCache(r$S.substring(r$b.basePath.length),r$d.substring(r$b.basePath.length)),r$T&&r$T.destroy(r$Q)}r$e.length=0,delete r$I.atlasMap[r$S],delete r$I.loadedMap[r$S]}else{var r$U=r$I.loadedMap[r$S];r$U&&(delete r$I.loadedMap[r$S],r$U instanceof laya.resource.Texture&&r$U.bitmap&&r$U.destroy(r$Q))}}},r$I.clearTextureRes=function(r$S){r$S=r$b.formatURL(r$S);var r$Q=laya.net.Loader.getAtlas(r$S),r$e=r$Q&&0<r$Q.length?laya.net.Loader.getRes(r$Q[0]):laya.net.Loader.getRes(r$S);r$e&&r$e.bitmap&&(r$m.isConchApp&&!r$m.isConchWebGL?r$e.bitmap.source.releaseTexture&&r$e.bitmap.source.releaseTexture():null==r$e.bitmap._atlaser&&r$e.bitmap.releaseResource(!0))},r$I.getRes=function(r$S){return r$I.loadedMap[r$b.formatURL(r$S)]},r$I.getAtlas=function(r$S){return r$I.atlasMap[r$b.formatURL(r$S)]},r$I.cacheRes=function(r$S,r$Q){r$S=r$b.formatURL(r$S),null!=r$I.loadedMap[r$S]?console.warn("Resources already exist,is repeated loading:",r$S):r$I.loadedMap[r$S]=r$Q},r$I.setGroup=function(r$S,r$Q){r$I.groupMap[r$Q]||(r$I.groupMap[r$Q]=[]),r$I.groupMap[r$Q].push(r$S)},r$I.clearResByGroup=function(r$S){if(r$I.groupMap[r$S]){var r$Q=r$I.groupMap[r$S],r$e=0,r$l=r$Q.length;for(r$e=0;r$e<r$l;r$e++)r$I.clearRes(r$Q[r$e]);r$Q.length=0}},r$I.keepCache=function(r$S,r$Q){if(r$S&&r$Q){var r$e=r$I.cacheSet[r$Q];r$e?-1==r$e.indexOf(r$S)&&r$e.push(r$S):r$I.cacheSet[r$Q]=[r$S]}},r$I.clearCache=function(r$S,r$Q){if(r$S&&r$Q){var r$e=r$I.cacheSet[r$Q];if(r$e){var r$l=r$e.indexOf(r$S);if(-1!==r$l){var r$M=r$e.length-1;0==r$M?(delete r$I.cacheSet[r$Q],0<r$I.imgMgrSet[r$Q]?r$T.imgMgrFree(r$Q,r$I.imgMgrSet[r$Q]):r$I.clearRes(r$Q,!0)):(r$e[r$l]=r$e[r$M],r$e.length=r$M)}}}},r$I.saveObject=function(r$S,r$Q,r$e){if(r$Q&&r$S){var r$l=r$I.objectSet[r$S];r$l?(console.warn("Loader.saveObject: "+r$S),r$l[0]=r$Q,r$l[1]=r$e):r$I.objectSet[r$S]=[r$Q,r$e,[]]}},r$I.findObject=function(r$S){if(r$S){var r$Q=r$I.objectSet[r$S];if(r$Q)return r$Q[0]}return null},r$I.keepObject=function(r$S,r$Q){if(r$S&&r$Q){var r$e=r$I.objectSet[r$Q];r$e&&-1===r$e[2].indexOf(r$S)&&r$e[2].push(r$S)}},r$I.clearObject=function(r$S,r$Q){if(r$S&&r$Q){var r$e=r$I.objectSet[r$Q];if(r$e){var r$l=r$e[2],r$M=r$l.indexOf(r$S);if(-1!==r$M){var r$d=r$l.length-1;0==r$d?(delete r$I.objectSet[r$Q],r$e[1]&&r$e[1].call(null,r$e[0])):(r$l[r$M]=r$l[r$d],r$l.length=r$d)}}}},r$I.TEXT="text",r$I.JSON="json",r$I.XML="xml",r$I.BUFFER="arraybuffer",r$I.IMAGE="image",r$I.SOUND="sound",r$I.ATLAS="atlas",r$I.FONT="font",r$I.TTF="ttf",r$I.PLF="plf",r$I.PKM="pkm",r$I.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},r$I.parserMap={},r$I.groupMap={},r$I.maxTimeOut=100,r$I.loadedMap={},r$I.preLoadedMap={},r$I.atlasMap={},r$I._loaders=[],r$I._isWorking=!1,r$I._startIndex=0,r$I.imgCache={},r$I.cacheSet={},r$I.objectSet={},r$I.imgMgrSet={},r$I}(),r$iS=function(r$S){var r$p;function r$J(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},r$J.__super.call(this);for(var r$S=0;r$S<this._maxPriority;r$S++)this._resInfos[r$S]=[]}r$o(r$J,"laya.net.LoaderManager",r$R);var r$Q=r$J.prototype;return r$Q.create=function(r$S,r$e,r$Q,r$l,r$M,r$d,r$T,r$U){if(null==r$d&&(r$d=2),null==r$T&&(r$T=!0),r$S instanceof Array){var r$i=r$S,r$R=r$i.length,r$o=0;if(r$Q)var r$Y=r$z.create(r$Q.caller,r$Q.method,r$Q.args,!1);for(var r$p=0;r$p<r$R;r$p++){var r$J=r$i[r$p];"string"==typeof r$J&&(r$J=r$i[r$p]={url:r$J}),r$J.progress=0}for(r$p=0;r$p<r$R;r$p++){r$J=r$i[r$p];var r$L=r$Q?r$z.create(null,r$G,[r$J],!1):null,r$j=r$Q||r$e?r$z.create(null,r$c,[r$J]):null;this._create(r$J.url,r$j,r$L,r$J.clas||r$l,r$J.params||r$M,null!=r$J.priority&&0<=r$J.priority?r$J.priority:r$d,r$T,r$J.group||r$U)}function r$c(r$S,r$Q){r$o++,r$S.progress=1,r$o===r$R&&r$e&&r$e.run()}function r$G(r$S,r$Q){r$S.progress=r$Q;for(var r$e=0,r$l=0;r$l<r$R;r$l++){r$e+=r$i[r$l].progress}var r$M=r$e/r$R;r$Y.runWith(r$M)}return!0}return this._create(r$S,r$e,r$Q,r$l,r$M,r$d,r$T,r$U)},r$Q._create=function(r$Q,r$e,r$S,r$l,r$M,r$d,r$T,r$U){r$Q&&""!=r$Q||console.error("加载的url不合法 "+r$Q),null==r$d&&(r$d=2),null==r$T&&(r$T=!0);var r$i=r$b.formatURL(r$Q),r$R=this.getRes(r$i);if(r$R)!r$R.hasOwnProperty("loaded")||r$R.loaded?(r$S&&r$S.runWith(1),r$e&&r$e.run()):r$e&&r$O.loader._createListener(r$Q,r$e.caller,r$e.method,r$e.args,!0,!1);else{var r$o=r$V.getFileExtension(r$Q),r$Y=r$J.createMap[r$o];if(!r$Y)throw new Error("LoaderManager:unknown file("+r$Q+") extension with: "+r$o+".");r$l||(r$l=r$Y[0]);var r$p=r$Y[1];if("atlas"==r$o)this.load(r$Q,r$e,r$S,r$p,r$d,r$T);else{r$l===r$oS&&(r$p="htmlimage"),(r$R=r$l?new r$l:null).hasOwnProperty("_loaded")&&(r$R._loaded=!1),r$R._setUrl(r$Q),r$U&&r$R._setGroup(r$U),this._createLoad(r$R,r$Q,r$z.create(null,function(r$S){r$R&&!r$R.destroyed&&r$S&&r$R.onAsynLoaded.call(r$R,r$Q,r$S,r$M),r$e&&r$e.run();r$O.loader.event(r$Q)}),r$S,r$p,r$d,!1,r$U,!0),r$T&&this.cacheRes(r$i,r$R)}}return r$R},r$Q.load=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){r$S&&""!=r$S||console.error("加载的url不合法 "+r$S);var r$i=this;if(null==r$M&&(r$M=2),null==r$d&&(r$d=!0),void 0===r$U&&(r$U=!1),r$S instanceof Array)return this._loadAssets(r$S,r$Q,r$e,r$l,r$M,r$d,r$T);var r$R=r$US.getRes(r$S);if(null!=r$R)r$O.timer.frameOnce(1,null,function(){r$e&&r$e.runWith(1),r$Q&&r$Q.runWith(r$R),r$i._loaderCount||r$i.event("complete")});else{var r$o=r$J._resMap[r$S];r$o?(r$Q&&r$o._createListener("complete",r$Q.caller,r$Q.method,r$Q.args,!1,!1),r$e&&r$o._createListener("progress",r$e.caller,r$e.method,r$e.args,!1,!1)):((r$o=this._infoPool.length?this._infoPool.pop():new r$p).url=r$S,r$o.type=r$l,r$o.cache=r$d,r$o.group=r$T,r$o.ignoreCache=r$U,r$o.priority=r$M,r$Q&&r$o.on("complete",r$Q.caller,r$Q.method,r$Q.args),r$e&&r$o.on("progress",r$e.caller,r$e.method,r$e.args),r$J._resMap[r$S]=r$o,r$M=r$M<this._maxPriority?0<=r$M?r$M:0:this._maxPriority-1,this._resInfos[r$M].push(r$o),this._next())}return this},r$Q._createLoad=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){var r$R=this;if(null==r$d&&(r$d=2),null==r$T&&(r$T=!0),void 0===r$i&&(r$i=!1),r$Q instanceof Array)return this._loadAssets(r$Q,r$e,r$l,r$M,r$d,r$T,r$U);var r$o=r$US.getRes(r$Q);if(null!=r$o)r$O.timer.frameOnce(1,null,function(){r$l&&r$l.runWith(1),r$e&&r$e.runWith(r$o),r$R._loaderCount||r$R.event("complete")});else{var r$Y=r$J._resMap[r$Q];r$Y?(r$e&&r$Y._createListener("complete",r$e.caller,r$e.method,r$e.args,!1,!1),r$l&&r$Y._createListener("progress",r$l.caller,r$l.method,r$l.args,!1,!1)):((r$Y=this._infoPool.length?this._infoPool.pop():new r$p).url=r$Q,r$Y.clas=r$S,r$Y.type=r$M,r$Y.cache=r$T,r$Y.group=r$U,r$Y.ignoreCache=r$i,r$Y.priority=r$d,r$e&&r$Y.on("complete",r$e.caller,r$e.method,r$e.args),r$l&&r$Y.on("progress",r$l.caller,r$l.method,r$l.args),r$J._resMap[r$Q]=r$Y,r$d=r$d<this._maxPriority?0<=r$d?r$d:0:this._maxPriority-1,this._resInfos[r$d].push(r$Y),this._next())}return this},r$Q._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var r$S=0;r$S<this._maxPriority;r$S++)for(var r$Q=this._resInfos[r$S];0<r$Q.length;){var r$e=r$Q.shift();if(r$e)return this._doLoad(r$e)}this._loaderCount||this.event("complete")}},r$Q._doLoad=function(r$Q){this._loaderCount++;var r$e=this._loaders.length?this._loaders.pop():new r$US;r$e.on("complete",null,r$M),r$e.on("progress",null,function(r$S){r$Q.event("progress",r$S)}),r$e.on("error",null,function(r$S){r$M(null)});var r$l=this;function r$M(r$S){r$e.offAll(),r$e._data=null,r$e._customParse=!1,r$l._loaders.push(r$e),r$l._endLoad(r$Q,r$S instanceof Array?[r$S]:r$S),r$l._loaderCount--,r$l._next()}r$e._class=r$Q.clas,1<=r$Q.priority?(r$e.priority=r$Q.priority,r$e.realTime=!1):(r$e.priority=0,r$e.realTime=!0),r$e.load(r$Q.url,r$Q.type,r$Q.cache,r$Q.group,r$Q.ignoreCache)},r$Q._endLoad=function(r$S,r$Q){var r$e=r$S.url;if(null==r$Q){var r$l=this._failRes[r$e]||0;if(r$l<this.retryNum)return console.warn("[warn]Retry to load:",r$e),this._failRes[r$e]=r$l+1,void r$O.timer.once(this.retryDelay,this,this._addReTry,[r$S],!1);console.warn("[error]Failed to load:",r$e),this.event("error",r$e)}this._failRes[r$e]&&(this._failRes[r$e]=0),delete r$J._resMap[r$e],r$S.event("complete",r$Q),r$S.offAll(),this._infoPool.push(r$S)},r$Q._addReTry=function(r$S){this._resInfos[this._maxPriority-1].push(r$S),this._next()},r$Q.clearRes=function(r$S,r$Q){void 0===r$Q&&(r$Q=!1),r$US.clearRes(r$S,r$Q)},r$Q.getRes=function(r$S){return r$US.getRes(r$S)},r$Q.cacheRes=function(r$S,r$Q){r$US.cacheRes(r$S,r$Q)},r$Q.clearTextureRes=function(r$S){r$US.clearTextureRes(r$S)},r$Q.setGroup=function(r$S,r$Q){r$US.setGroup(r$S,r$Q)},r$Q.clearResByGroup=function(r$S){r$US.clearResByGroup(r$S)},r$Q.clearUnLoaded=function(){for(var r$S=0;r$S<this._maxPriority;r$S++){for(var r$Q=this._resInfos[r$S],r$e=r$Q.length-1;-1<r$e;r$e--){var r$l=r$Q[r$e];r$l&&(r$l.offAll(),this._infoPool.push(r$l))}r$Q.length=0}this._loaderCount=0,r$J._resMap={}},r$Q.cancelLoadByUrls=function(r$S){if(r$S)for(var r$Q=0,r$e=r$S.length;r$Q<r$e;r$Q++)this.cancelLoadByUrl(r$S[r$Q])},r$Q.cancelLoadByUrl=function(r$S){for(var r$Q=0;r$Q<this._maxPriority;r$Q++)for(var r$e=this._resInfos[r$Q],r$l=r$e.length-1;-1<r$l;r$l--){var r$M=r$e[r$l];r$M&&r$M.url===r$S&&(r$e[r$l]=null,r$M.offAll(),this._infoPool.push(r$M))}r$J._resMap[r$S]&&delete r$J._resMap[r$S]},r$Q._loadAssets=function(r$S,r$e,r$T,r$Q,r$l,r$M,r$d){null==r$l&&(r$l=2),null==r$M&&(r$M=!0);for(var r$U=r$S.length,r$i=0,r$R=0,r$o=[],r$Y=!0,r$p=0;r$p<r$U;r$p++){var r$J=r$S[r$p];if(!r$J)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+r$S);"string"==typeof r$J&&(r$J={url:r$J,type:r$Q,size:1,priority:r$l}),r$J.size||(r$J.size=1),r$J.progress=0,r$R+=r$J.size,r$o.push(r$J);var r$L=r$T?r$z.create(null,r$G,[r$J],!1):null,r$j=r$e||r$T?r$z.create(null,r$c,[r$J]):null;this.load(r$J.url,r$j,r$L,r$J.type,null!=r$J.priority&&0<=r$J.priority?r$J.priority:2,r$M,r$J.group||r$d)}function r$c(r$S,r$Q){r$i++,r$S.progress=1,r$Q||(r$Y=!1),r$i===r$U&&r$e&&r$e.runWith(r$Y)}function r$G(r$S,r$Q){if(null!=r$T){r$S.progress=r$Q;for(var r$e=0,r$l=0;r$l<r$o.length;r$l++){var r$M=r$o[r$l];r$e+=r$M.size*r$M.progress}var r$d=r$e/r$R;r$T.runWith(r$d)}}return this},r$J.cacheRes=function(r$S,r$Q){r$US.cacheRes(r$S,r$Q)},r$J._resMap={},r$i(r$J,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),r$J.__init$=function(){r$p=function(r$S){function r$Q(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,r$Q.__super.call(this)}return r$o(r$Q,"",r$R),r$Q}()},r$J}(),r$RS=(function(r$S){function r$M(r$S){r$M.__super.call(this),r$S||(r$S=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var r$Q=0,r$e=0,r$l=0;r$l<20;r$l++)r$l%5!=4?this._mat[r$Q++]=r$S[r$l]:this._alpha[r$e++]=r$S[r$l];this._action=r$k.createFilterAction(32),this._action.data=this}r$o(r$M,"laya.filters.ColorFilter",r$G);var r$Q=r$M.prototype;r$O.imps(r$Q,{"laya.filters.IFilter":!0}),r$Q.callNative=function(r$S){r$S._$P.cf=this;r$S.conchModel&&r$S.conchModel.setFilterMatrix&&r$S.conchModel.setFilterMatrix(this._mat,this._alpha)},r$L(0,r$Q,"type",function(){return 32}),r$L(0,r$Q,"action",function(){return this._action})}(),function(r$S){function r$l(r$S,r$Q,r$e){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===r$Q&&(r$Q=0),r$l.__super.call(this),this._byteClass=r$e||r$w,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,r$S&&0<r$Q&&r$Q<65535&&this.connect(r$S,r$Q)}r$o(r$l,"laya.net.Socket",r$R);var r$Q=r$l.prototype;r$Q.connect=function(r$S,r$Q){var r$e="ws://"+r$S+":"+r$Q;r$e="https:"==r$f.window.location.protocol?"wss://"+r$S+":"+r$Q:"ws://"+r$S+":"+r$Q,this.connectByUrl(r$e)},r$Q.connectByUrl=function(r$S){var r$Q=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new r$f.window.WebSocket(r$S,this.protocols):this._socket=new r$f.window.WebSocket(r$S),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(r$S){r$Q._onOpen(r$S)},this._socket.onmessage=function(r$S){r$Q._onMessage(r$S)},this._socket.onclose=function(r$S){r$Q._onClose(r$S)},this._socket.onerror=function(r$S){r$Q._onError(r$S)}},r$Q.cleanSocket=function(){try{this._socket.close()}catch(r$S){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},r$Q.close=function(){if(null!=this._socket)try{this._socket.close()}catch(r$S){}},r$Q._onOpen=function(r$S){this._connected=!0,this.event("open",r$S)},r$Q._onMessage=function(r$S){if(r$S&&r$S.data){var r$Q=r$S.data;if(this.disableInput&&r$Q)this.event("message",r$Q);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var r$e=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,r$Q&&("string"==typeof r$Q?this._input.writeUTFBytes(r$Q):this._input.writeArrayBuffer(r$Q),this._addInputPosition=this._input.pos,this._input.pos=r$e),this.event("message",r$Q)}}},r$Q._onClose=function(r$S){this._connected=!1,this.event("close",r$S)},r$Q._onError=function(r$S){this.event("error",r$S)},r$Q.send=function(r$S){this._socket.send(r$S)},r$Q.flush=function(){if(this._output&&0<this._output.length){var r$Q;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(r$S){r$Q=r$S}this._output.endian=this.endian,this._output.clear(),r$Q&&this.event("error",r$Q)}},r$L(0,r$Q,"input",function(){return this._input}),r$L(0,r$Q,"output",function(){return this._output}),r$L(0,r$Q,"connected",function(){return this._connected}),r$L(0,r$Q,"endian",function(){return this._endian},function(r$S){this._endian=r$S,null!=this._input&&(this._input.endian=r$S),null!=this._output&&(this._output.endian=r$S)}),r$l.LITTLE_ENDIAN="littleEndian",r$l.BIG_ENDIAN="bigEndian"}(),function(r$S){function r$U(){r$U.__super.call(this),this._$1__id=++r$U._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(r$U._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,r$a.currentResourceManager&&r$a.currentResourceManager.addResource(this)}r$o(r$U,"laya.resource.Resource",r$R);var r$Q=r$U.prototype;return r$O.imps(r$Q,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),r$Q._setUrl=function(r$S){var r$Q;this._url!==r$S&&(this._url&&((r$Q=r$U._urlResourcesMap[this._url]).splice(r$Q.indexOf(this),1),0===r$Q.length&&delete r$U._urlResourcesMap[this._url]),r$S&&((r$Q=r$U._urlResourcesMap[r$S])||(r$U._urlResourcesMap[r$S]=r$Q=[]),r$Q.push(this)),this._url=r$S)},r$Q._getGroup=function(){return this._group},r$Q._setGroup=function(r$S){var r$Q;this._group!==r$S&&(this._group&&((r$Q=r$U._groupResourcesMap[this._group]).splice(r$Q.indexOf(this),1),0===r$Q.length&&delete r$U._groupResourcesMap[this._group]),r$S&&((r$Q=r$U._groupResourcesMap[r$S])||(r$U._groupResourcesMap[r$S]=r$Q=[]),r$Q.push(this)),this._group=r$S)},r$Q._addReference=function(){this._referenceCount++},r$Q._removeReference=function(){this._referenceCount--},r$Q._clearReference=function(){this._referenceCount=0},r$Q._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},r$Q.recreateResource=function(){this.completeCreate()},r$Q.disposeResource=function(){},r$Q.activeResource=function(r$S){void 0===r$S&&(r$S=!1),this._lastUseFrameCount=r$N.loopCount,!this._destroyed&&this.__loaded&&(this._released||r$S)&&this.recreateResource()},r$Q.releaseResource=function(r$S){return void 0===r$S&&(r$S=!0),!(!r$S&&this.lock)&&(!(this._released&&!r$S)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},r$Q.onAsynLoaded=function(r$S,r$Q,r$e){throw new Error("Resource: must override this function!")},r$Q.destroy=function(){var r$S;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete r$U._idResourcesMap[this.id],this._url&&((r$S=r$U._urlResourcesMap[this._url])&&(r$S.splice(r$S.indexOf(this),1),0===r$S.length&&delete r$U._urlResourcesMap[this.url]),r$US.clearRes(this._url),this.__loaded||r$k.cancelLoadByUrl(this._url)),this._group&&((r$S=r$U._groupResourcesMap[this._group]).splice(r$S.indexOf(this),1),0===r$S.length&&delete r$U._groupResourcesMap[this.url]))},r$Q.completeCreate=function(){this._released=!1,this.event("recovered",this)},r$Q.dispose=function(){this.destroy()},r$L(0,r$Q,"memorySize",function(){return this._memorySize},function(r$S){var r$Q=r$S-this._memorySize;this._memorySize=r$S,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,r$Q),this.resourceManager&&this.resourceManager.addSize(r$Q)}),r$L(0,r$Q,"_loaded",null,function(r$S){this.__loaded=r$S}),r$L(0,r$Q,"loaded",function(){return this.__loaded}),r$L(0,r$Q,"id",function(){return this._$1__id}),r$L(0,r$Q,"destroyed",function(){return this._destroyed}),r$L(0,r$Q,"group",function(){return this._getGroup()},function(r$S){this._setGroup(r$S)}),r$L(0,r$Q,"resourceManager",function(){return this._resourceManager}),r$L(0,r$Q,"url",function(){return this._url}),r$L(0,r$Q,"released",function(){return this._released}),r$L(0,r$Q,"referenceCount",function(){return this._referenceCount}),r$U.getResourceByID=function(r$S){return r$U._idResourcesMap[r$S]},r$U.getResourceByURL=function(r$S,r$Q){return void 0===r$Q&&(r$Q=0),null==r$U._urlResourcesMap[r$S]?null:r$U._urlResourcesMap[r$S][r$Q]},r$U.getResourceCountByURL=function(r$S){return r$U._urlResourcesMap[r$S].length},r$U.destroyUnusedResources=function(r$S){var r$Q;if(r$S){var r$e=r$U._groupResourcesMap[r$S];if(r$e)for(var r$l=r$e.slice(),r$M=0,r$d=r$l.length;r$M<r$d;r$M++)(r$Q=r$l[r$M]).lock||0!==r$Q._referenceCount||r$Q.destroy()}else for(var r$T in r$U._idResourcesMap)(r$Q=r$U._idResourcesMap[r$T]).lock||0!==r$Q._referenceCount||r$Q.destroy()},r$U._uniqueIDCounter=0,r$U._idResourcesMap={},r$U._urlResourcesMap={},r$U._groupResourcesMap={},r$U}()),r$oS=function(r$S){function r$I(r$S,r$Q){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,r$I.__super.call(this),r$S&&null!=r$S._addReference&&r$S._addReference(),this.setTo(r$S,r$Q)}r$o(r$I,"laya.resource.Texture",r$R);var r$Q=r$I.prototype;return r$Q._setUrl=function(r$S){this.url=r$S},r$Q.setTo=function(r$S,r$Q){if(r$S instanceof r$T.HTMLElement){var r$e=r$AS.create("2D",r$S);this.bitmap=r$e}else this.bitmap=r$S;if(this.uv=r$Q||r$I.DEF_UV,r$S){this._w=r$S.width,this._h=r$S.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var r$l=this;if(this._loaded)r$k.addToAtlas&&r$k.addToAtlas(r$l);else{var r$M=r$S;r$M instanceof laya.resource.HTMLImage&&r$M.image&&r$M.image.addEventListener("load",function(r$S){r$k.addToAtlas&&r$k.addToAtlas(r$l)},!1)}}},r$Q.active=function(){this.bitmap&&this.bitmap.activeResource()},r$Q.destroy=function(r$S){if(void 0===r$S&&(r$S=!1),this.alphaTexture&&(this.alphaTexture.destroy(r$S),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var r$Q=this.bitmap;r$S?(r$m.isConchApp&&r$Q.source&&r$Q.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,r$Q.dispose(),r$Q._clearReference()):(r$Q._removeReference(),0==r$Q.referenceCount&&(r$m.isConchApp&&r$Q.source&&r$Q.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,r$Q.dispose())),this.url&&this===r$O.loader.getRes(this.url)&&r$O.loader.clearRes(this.url,r$S),this._loaded=!1}},r$Q.load=function(r$S){var r$Q=this;this._loaded=!1,r$S=r$b.customFormat(r$S);var r$e=this.bitmap||(this.bitmap=r$BS.create(r$S));r$e.uri=r$S,r$e&&r$e._addReference();var r$l=this;r$e.onload=function(){r$e.onload=null,r$l._loaded=!0,r$Q.sourceWidth=r$Q._w=r$e.width,r$Q.sourceHeight=r$Q._h=r$e.height,r$l.event("loaded",this),r$k.addToAtlas&&r$k.addToAtlas(r$l)}},r$Q.addTextureToAtlas=function(r$S){r$k.addTextureToAtlas(this)},r$Q.getPixels=function(r$S,r$Q,r$e,r$l){if(r$m.isConchApp){var r$M=this.bitmap;if(r$M.source&&r$M.source.getImageData){var r$d=r$M.source.getImageData(r$S,r$Q,r$e,r$l),r$T=new Uint8Array(r$d);return Array.from(r$T)}return null}return r$m.isWebGL?r$k.getTexturePixels(this,r$S,r$Q,r$e,r$l):(r$f.canvas.size(r$e,r$l),r$f.canvas.clear(),r$f.context.drawTexture(this,-r$S,-r$Q,this.width,this.height,0,0),r$f.context.getImageData(0,0,r$e,r$l).data)},r$Q.onAsynLoaded=function(r$S,r$Q){if(r$Q){if("function"!=typeof r$Q._addReference)throw new Error("bitmap._addReference is not a function. "+r$Q.className+" "+typeof r$Q._addReference+" "+r$Q.constructor);r$Q._addReference()}this.setTo(r$Q,this.uv),this._loaded&&this.event("loaded",this)},r$L(0,r$Q,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),r$L(0,r$Q,"loaded",function(){return this._loaded}),r$L(0,r$Q,"released",function(){return!this.bitmap||this.bitmap.released}),r$L(0,r$Q,"width",function(){return this._w?this._w:this.uv&&this.uv!==r$I.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(r$S){this._w=r$S,this.sourceWidth||(this.sourceWidth=r$S)}),r$L(0,r$Q,"repeat",function(){return!r$m.isWebGL||!this.bitmap||this.bitmap.repeat},function(r$S){r$S&&r$m.isWebGL&&this.bitmap&&(this.bitmap.repeat=r$S)&&(this.bitmap.enableMerageInAtlas=!1)}),r$L(0,r$Q,"height",function(){return this._h?this._h:this.uv&&this.uv!==r$I.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(r$S){this._h=r$S,this.sourceHeight||(this.sourceHeight=r$S)}),r$L(0,r$Q,"isLinearSampling",function(){return!r$m.isWebGL||9728!=this.bitmap.minFifter},function(r$S){!r$S&&r$m.isWebGL&&(r$S||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),r$I.moveUV=function(r$S,r$Q,r$e){for(var r$l=0;r$l<8;r$l+=2)r$e[r$l]+=r$S,r$e[r$l+1]+=r$Q;return r$e},r$I.create=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){void 0===r$d&&(r$d=0),void 0===r$T&&(r$T=0),void 0===r$U&&(r$U=0),void 0===r$i&&(r$i=0);var r$R=r$S instanceof laya.resource.Texture,r$o=r$R?r$S.uv:r$I.DEF_UV,r$Y=r$R?r$S.bitmap:r$S,r$p=r$k.isAtlas(r$Y);if(r$p){var r$J=r$Y._atlaser,r$L=r$S._atlasID;if(-1==r$L)throw new Error("create texture error");r$Y=r$J._inAtlasTextureBitmapValue[r$L],r$o=r$J._inAtlasTextureOriUVValue[r$L]}var r$j=new r$I(r$Y,null);r$Y.width&&r$Q+r$l>r$Y.width&&(r$l=r$Y.width-r$Q),r$Y.height&&r$e+r$M>r$Y.height&&(r$M=r$Y.height-r$e),r$j.width=r$l,r$j.height=r$M,r$j.offsetX=r$d,r$j.offsetY=r$T,r$j.sourceWidth=r$U||r$l,r$j.sourceHeight=r$i||r$M;var r$c=1/r$Y.width,r$G=1/r$Y.height;r$Q*=r$c,r$e*=r$G,r$l*=r$c,r$M*=r$G;var r$z=r$j.uv[0],r$A=r$j.uv[1],r$v=r$j.uv[4],r$D=r$j.uv[5],r$B=r$v-r$z,r$O=r$D-r$A,r$H=r$I.moveUV(r$o[0],r$o[1],[r$Q,r$e,r$Q+r$l,r$e,r$Q+r$l,r$e+r$M,r$Q,r$e+r$M]);r$j.uv=[r$z+r$H[0]*r$B,r$A+r$H[1]*r$O,r$v-(1-r$H[2])*r$B,r$A+r$H[3]*r$O,r$v-(1-r$H[4])*r$B,r$D-(1-r$H[5])*r$O,r$z+r$H[6]*r$B,r$D-(1-r$H[7])*r$O],r$p&&r$j.addTextureToAtlas();var r$g=r$Y.scaleRate;return r$g&&1!=r$g?(r$j.sourceWidth/=r$g,r$j.sourceHeight/=r$g,r$j.width/=r$g,r$j.height/=r$g,r$j.scaleRate=r$g,r$j.offsetX/=r$g,r$j.offsetY/=r$g):r$j.scaleRate=1,r$j},r$I.createFromTexture=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$S.scaleRate;1!=r$d&&(r$Q*=r$d,r$e*=r$d,r$l*=r$d,r$M*=r$d);var r$T=r$g.TEMP.setTo(r$Q-r$S.offsetX,r$e-r$S.offsetY,r$l,r$M),r$U=r$T.intersection(r$I._rect1.setTo(0,0,r$S.width,r$S.height),r$I._rect2);if(!r$U)return null;var r$i=r$I.create(r$S,r$U.x,r$U.y,r$U.width,r$U.height,r$U.x-r$T.x,r$U.y-r$T.y,r$l,r$M);if(r$i.bitmap&&r$i.bitmap._removeReference)return r$i.bitmap._removeReference(),r$i;var r$R="bitmap:"+(r$i.bitmap?r$i.bitmap.constructor?r$i.bitmap.constructor.name:r$i.bitmap.__className:"")+", url:"+(r$S.url+" | "+(r$i.bitmap?r$i.bitmap.url:r$S.url))+", x="+r$Q+",y="+r$e+",width="+r$l+",height="+r$M+", result="+(r$U?r$U.x+","+r$U.y+","+r$U.width+","+r$U.height:"null")+", rect="+r$T.x+","+r$T.y+","+r$T.width+","+r$T.height;throw new Error("报错：bitmap._removeReference is not a function  "+r$R)},r$I.DEF_UV=[0,0,1,0,1,1,0,1],r$I.INV_UV=[0,1,1,1,1,0,0,0],r$I._rect1=new r$g,r$I._rect2=new r$g,r$I}(),r$S=function(r$S){var r$U;function r$d(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,r$d.__super.call(this)}r$o(r$d,"laya.utils.TimeLine",r$R);var r$Q=r$d.prototype;return r$Q.to=function(r$S,r$Q,r$e,r$l,r$M){return void 0===r$M&&(r$M=0),this._create(r$S,r$Q,r$e,r$l,r$M,!0)},r$Q.from=function(r$S,r$Q,r$e,r$l,r$M){return void 0===r$M&&(r$M=0),this._create(r$S,r$Q,r$e,r$l,r$M,!1)},r$Q._create=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=r$Z.getItemByClass("tweenData",r$U);return r$T.isTo=r$d,r$T.type=0,r$T.target=r$S,r$T.duration=r$e,r$T.data=r$Q,r$T.startTime=this._startTime+r$M,r$T.endTime=r$T.startTime+r$T.duration,r$T.ease=r$l,this._startTime=Math.max(r$T.endTime,this._startTime),this._tweenDataList.push(r$T),this._startTimeSort=!0,this._endTimeSort=!0,this},r$Q.addLabel=function(r$S,r$Q){var r$e=r$Z.getItemByClass("tweenData",r$U);return r$e.type=1,r$e.data=r$S,r$e.endTime=r$e.startTime=this._startTime+r$Q,this._labelDic||(this._labelDic={}),this._labelDic[r$S]=r$e,this._tweenDataList.push(r$e),this},r$Q.removeLabel=function(r$S){if(this._labelDic&&this._labelDic[r$S]){var r$Q=this._labelDic[r$S];if(r$Q){var r$e=this._tweenDataList.indexOf(r$Q);-1<r$e&&this._tweenDataList.splice(r$e,1)}delete this._labelDic[r$S]}},r$Q.gotoTime=function(r$S){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var r$Q,r$e,r$l,r$M;for(var r$d in this._firstTweenDic)if(r$e=this._firstTweenDic[r$d])for(var r$T in r$e)r$e.diyTarget.hasOwnProperty(r$T)&&(r$e.diyTarget[r$T]=r$e[r$T]);for(r$d in this._tweenDic)(r$Q=this._tweenDic[r$d]).clear(),delete this._tweenDic[r$d];if(this._index=0,this._gidIndex=0,this._currTime=r$S,this._lastTime=r$f.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=r$l=this._tweenDataList.concat(),r$l.sort(function(r$S,r$Q){return r$S.endTime>r$Q.endTime?1:r$S.endTime<r$Q.endTime?-1:0})}else r$l=this._endTweenDataList;for(var r$U=0,r$i=r$l.length;r$U<r$i;r$U++)if(0==(r$M=r$l[r$U]).type){if(!(r$S>=r$M.endTime))break;this._index=Math.max(this._index,r$U+1);var r$R=r$M.data;if(r$M.isTo)for(var r$o in r$R)r$M.target[r$o]=r$R[r$o]}for(r$U=0,r$i=this._tweenDataList.length;r$U<r$i;r$U++)0==(r$M=this._tweenDataList[r$U]).type&&r$S>=r$M.startTime&&r$S<r$M.endTime&&(this._index=Math.max(this._index,r$U+1),this._gidIndex++,(r$Q=r$Z.getItemByClass("tween",r$K))._create(r$M.target,r$M.data,r$M.duration,r$M.ease,r$z.create(this,this._animComplete,[this._gidIndex]),0,!1,r$M.isTo,!0,!1),r$Q.setStartTime(this._currTime-(r$S-r$M.startTime)),r$Q._updateEase(this._currTime),r$Q.gid=this._gidIndex,this._tweenDic[this._gidIndex]=r$Q)}},r$Q.gotoLabel=function(r$S){if(null!=this._labelDic){var r$Q=this._labelDic[r$S];r$Q&&this.gotoTime(r$Q.startTime)}},r$Q.pause=function(){r$O.timer.clear(this,this._update)},r$Q.resume=function(){this.play(this._currTime,this._loopKey)},r$Q.play=function(r$S,r$Q){if(void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(r$S,r$Q){return r$S.startTime>r$Q.startTime?1:r$S.startTime<r$Q.startTime?-1:0});for(var r$e=0,r$l=this._tweenDataList.length;r$e<r$l;r$e++){var r$M=this._tweenDataList[r$e];if(null!=r$M&&0==r$M.type){var r$d=r$M.target,r$T=r$d.$_GID||(r$d.$_GID=r$V.getGID()),r$U=null;for(var r$i in null==this._firstTweenDic[r$T]?((r$U={}).diyTarget=r$d,this._firstTweenDic[r$T]=r$U):r$U=this._firstTweenDic[r$T],r$M.data)null==r$U[r$i]&&(r$U[r$i]=r$d[r$i])}}}"string"==typeof r$S?this.gotoLabel(r$S):this.gotoTime(r$S),this._loopKey=r$Q,this._lastTime=r$f.now(),r$O.timer.frameLoop(1,this,this._update)}},r$Q._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var r$S in this._tweenDic)(r$Q=this._tweenDic[r$S]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var r$Q,r$e=r$f.now(),r$l=r$e-this._lastTime,r$M=this._currTime+=r$l*this.scale;for(r$S in this._lastTime=r$e,this._tweenDic)(r$Q=this._tweenDic[r$S])._updateEase(r$M);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var r$d=this._tweenDataList[this._index];r$M>=r$d.startTime&&(this._index++,0==r$d.type?(this._gidIndex++,(r$Q=r$Z.getItemByClass("tween",r$K))._create(r$d.target,r$d.data,r$d.duration,r$d.ease,r$z.create(this,this._animComplete,[this._gidIndex]),0,!1,r$d.isTo,!0,!1),r$Q.setStartTime(r$M),r$Q.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=r$Q)._updateEase(r$M)):this.event("label",r$d.data))}},r$Q._animComplete=function(r$S){this._tweenDic[r$S]&&delete this._tweenDic[r$S]},r$Q._complete=function(){this.event("complete")},r$Q.reset=function(){var r$S;if(this._labelDic)for(r$S in this._labelDic)delete this._labelDic[r$S];for(r$S in this._tweenDic)this._tweenDic[r$S].clear(),delete this._tweenDic[r$S];for(r$S in this._firstTweenDic)delete this._firstTweenDic[r$S];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var r$Q,r$e=0;for(r$Q=this._tweenDataList.length,r$e=0;r$e<r$Q;r$e++)this._tweenDataList[r$e]&&this._tweenDataList[r$e].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,r$O.timer.clear(this,this._update)},r$Q.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},r$L(0,r$Q,"index",function(){return this._frameIndex},function(r$S){this._frameIndex=r$S,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),r$L(0,r$Q,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),r$d.to=function(r$S,r$Q,r$e,r$l,r$M){return void 0===r$M&&(r$M=0),(new r$d).to(r$S,r$Q,r$e,r$l,r$M)},r$d.from=function(r$S,r$Q,r$e,r$l,r$M){return void 0===r$M&&(r$M=0),(new r$d).from(r$S,r$Q,r$e,r$l,r$M)},r$d.__init$=function(){r$U=function(){function r$S(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return r$o(r$S,""),r$S.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,r$Z.recover("tweenData",this)},r$S}()},r$d}(),r$YS=function(r$M){function r$e(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,r$e.__super.call(this),this._style=r$U.EMPTY}r$o(r$e,"laya.display.Sprite",r$M);var r$S=r$e.prototype;return r$O.imps(r$S,{"laya.display.ILayout":!0}),r$S.createConchModel=function(){return new ConchNode},r$S.destroy=function(r$S){if(void 0===r$S&&(r$S=!0),this._releaseMem(),!this._destroyed){this.filters=null;var r$Q=this.mask;r$Q&&(this.mask=null,r$Q.destroy(r$S))}r$M.prototype.destroy.call(this,r$S),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},r$S.updateZOrder=function(){r$V.updateOrder(this._childs)&&this.repaint()},r$S.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},r$S.setBounds=function(r$S){this._set$P("uBounds",r$S)},r$S.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new r$g),r$g._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},r$S.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new r$g),r$g._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},r$S._boundPointsToParent=function(r$S){void 0===r$S&&(r$S=!1);var r$Q=0,r$e=0;this._style&&(r$Q=this._style._tf.translateX,r$e=this._style._tf.translateY,r$S=r$S||0!==this._style._tf.rotate,this._style.scrollRect&&(r$Q+=this._style.scrollRect.x,r$e+=this._style.scrollRect.y));var r$l=this._getBoundPointsM(r$S);if(!r$l||r$l.length<1)return r$l;if(8!=r$l.length&&(r$l=r$S?r$D.scanPList(r$l):r$g._getWrapRec(r$l,r$g.TEMP)._getBoundPoints()),!this.transform)return r$V.transPointList(r$l,this._x-r$Q,this._y-r$e),r$l;var r$M=r$H.TEMP,r$d=0,r$T=r$l.length;for(r$d=0;r$d<r$T;r$d+=2)r$M.x=r$l[r$d],r$M.y=r$l[r$d+1],this.toParentPoint(r$M),r$l[r$d]=r$M.x,r$l[r$d+1]=r$M.y;return r$l},r$S.getGraphicBounds=function(r$S){return void 0===r$S&&(r$S=!1),this._graphics?this._graphics.getBounds(r$S):r$g.TEMP.setTo(0,0,0,0)},r$S._getBoundPointsM=function(r$S){if(void 0===r$S&&(r$S=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var r$Q=r$V.clearArray(this._$P.temBM),r$e=r$g.TEMP;return r$e.copyFrom(this.scrollRect),r$V.concatArray(r$Q,r$e._getBoundPoints()),r$Q}for(var r$l,r$M,r$d,r$T=this._graphics?this._graphics.getBoundPoints():r$V.clearArray(this._$P.temBM),r$U=0,r$i=(r$d=this._childs).length;r$U<r$i;r$U++)(r$l=r$d[r$U])instanceof laya.display.Sprite&&1==r$l.visible&&(r$M=r$l._boundPointsToParent(r$S))&&(r$T=r$T?r$V.concatArray(r$T,r$M):r$M);return r$T},r$S.getStyle=function(){return this._style===r$U.EMPTY&&(this._style=new r$U),this._style},r$S.setStyle=function(r$S){this._style=r$S},r$S._adjustTransform=function(){this._tfChanged=!1;var r$S,r$Q=this._style._tf,r$e=r$Q.scaleX,r$l=r$Q.scaleY;if(r$Q.rotate||1!==r$e||1!==r$l||r$Q.skewX||r$Q.skewY){(r$S=this._transform||(this._transform=r$X.create())).bTransform=!0;var r$M=.0174532922222222*(r$Q.rotate-r$Q.skewX),r$d=.0174532922222222*(r$Q.rotate+r$Q.skewY),r$T=Math.cos(r$d),r$U=Math.sin(r$d),r$i=Math.sin(r$M),r$R=Math.cos(r$M);return r$S.a=r$e*r$T,r$S.b=r$e*r$U,r$S.c=-r$l*r$i,r$S.d=r$l*r$R,r$S.tx=r$S.ty=0,r$S}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,r$S},r$S.pos=function(r$S,r$Q,r$e){if(void 0===r$e&&(r$e=!1),this._x!==r$S||this._y!==r$Q){if(this.destroyed)return this;if(r$e){this._x=r$S,this._y=r$Q,this.conchModel&&this.conchModel.pos(this._x,this._y);var r$l=this._parent;r$l&&0===r$l._repaint&&(r$l._repaint=1,r$l.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=r$S,this.y=r$Q}return this},r$S.pivot=function(r$S,r$Q){return this.pivotX=r$S,this.pivotY=r$Q,this},r$S.size=function(r$S,r$Q){return this.width=r$S,this.height=r$Q,this},r$S.scale=function(r$S,r$Q,r$e){void 0===r$e&&(r$e=!1);var r$l=this.getStyle(),r$M=r$l._tf;if(r$M.scaleX!=r$S||r$M.scaleY!=r$Q){if(this.destroyed)return this;if(r$e){r$l.setScale(r$S,r$Q),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(r$S,r$Q),this._renderType|=4;var r$d=this._parent;r$d&&0===r$d._repaint&&(r$d._repaint=1,r$d.parentRepaint())}else this.scaleX=r$S,this.scaleY=r$Q}return this},r$S.skew=function(r$S,r$Q){return this.skewX=r$S,this.skewY=r$Q,this},r$S.render=function(r$S,r$Q,r$e){r$N.spriteCount++,r$n.renders[this._renderType]._fun(this,r$S,r$Q+this._x,r$e+this._y),this._repaint=0},r$S.drawToCanvas=function(r$S,r$Q,r$e,r$l){if(r$m.isConchNode){var r$M=r$AS.create("2D");return new r$$(r$S,r$Q,r$M).ctx.setCanvasType(1),this.conchModel.drawToCanvas(r$M.source,r$e,r$l),r$M}return r$k.drawToCanvas(this,this._renderType,r$S,r$Q,r$e,r$l)},r$S.customRender=function(r$S,r$Q,r$e){this._renderType|=1024},r$S._applyFilters=function(){var r$S;if(!r$m.isWebGL&&((r$S=this._$P.filters)&&!(r$S.length<1)))for(var r$Q=0,r$e=r$S.length;r$Q<r$e;r$Q++)r$S[r$Q].action.apply(this._$P.cacheCanvas)},r$S._isHaveGlowFilter=function(){var r$S,r$Q=0;if(this.filters)for(r$Q=0;r$Q<this.filters.length;r$Q++)if(8==this.filters[r$Q].type)return!0;for(r$Q=0,r$S=this._childs.length;r$Q<r$S;r$Q++)if(this._childs[r$Q]._isHaveGlowFilter())return!0;return!1},r$S.localToGlobal=function(r$S,r$Q){void 0===r$Q&&(r$Q=!1),!0===r$Q&&(r$S=new r$H(r$S.x,r$S.y));for(var r$e=this;r$e&&r$e!=r$O.stage;)r$S=r$e.toParentPoint(r$S),r$e=r$e.parent;return r$S},r$S.globalToLocal=function(r$S,r$Q){void 0===r$Q&&(r$Q=!1),r$Q&&(r$S=new r$H(r$S.x,r$S.y));for(var r$e=this,r$l=[];r$e&&r$e!=r$O.stage;)r$l.push(r$e),r$e=r$e.parent;for(var r$M=r$l.length-1;0<=r$M;)r$S=(r$e=r$l[r$M]).fromParentPoint(r$S),r$M--;return r$S},r$S.toParentPoint=function(r$S){if(!r$S)return r$S;r$S.x-=this.pivotX,r$S.y-=this.pivotY,this.transform&&this._transform.transformPoint(r$S),r$S.x+=this._x,r$S.y+=this._y;var r$Q=this._style.scrollRect;return r$Q&&(r$S.x-=r$Q.x,r$S.y-=r$Q.y),r$S},r$S.fromParentPoint=function(r$S){if(!r$S)return r$S;r$S.x-=this._x,r$S.y-=this._y;var r$Q=this._style.scrollRect;return r$Q&&(r$S.x+=r$Q.x,r$S.y+=r$Q.y),this.transform&&this._transform.invertTransformPoint(r$S),r$S.x+=this.pivotX,r$S.y+=this.pivotY,r$S},r$S.on=function(r$S,r$Q,r$e,r$l){return 1!==this._mouseEnableState&&this.isMouseEvent(r$S)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(r$S,r$Q,r$e,r$l,!1)):r$M.prototype.on.call(this,r$S,r$Q,r$e,r$l)},r$S.once=function(r$S,r$Q,r$e,r$l){return 1!==this._mouseEnableState&&this.isMouseEvent(r$S)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(r$S,r$Q,r$e,r$l,!0)):r$M.prototype.once.call(this,r$S,r$Q,r$e,r$l)},r$S._$2__onDisplay=function(){if(1!==this._mouseEnableState){var r$S=this;for(r$S=r$S.parent;r$S&&1!==r$S._mouseEnableState&&!r$S._getBit(2);)r$S.mouseEnabled=!0,r$S._setBit(2,!0),r$S=r$S.parent}},r$S.loadImage=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=this;return void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=0),void 0===r$M&&(r$M=0),this.graphics.loadImage(r$S,r$Q,r$e,r$l,r$M,function(r$S){r$T.destroyed||(r$T.size(r$Q+(r$l||r$S.width),r$e+(r$M||r$S.height)),r$T.repaint(),r$d&&r$d.runWith(r$S))}),this},r$S.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},r$S._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},r$S._childChanged=function(r$S){this._childs.length?this._renderType|=2048:this._renderType&=-2049,r$S&&this._get$P("hasZorder")&&r$O.timer.callLater(this,this.updateZOrder),this.repaint()},r$S.parentRepaint=function(){var r$S=this._parent;r$S&&0===r$S._repaint&&(r$S._repaint=1,r$S.parentRepaint())},r$S.startDrag=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){void 0===r$Q&&(r$Q=!1),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=300),void 0===r$d&&(r$d=!1),void 0===r$T&&(r$T=.92),this._$P.dragging||this._set$P("dragging",new r$x),this._$P.dragging.start(this,r$S,r$Q,r$e,r$l,r$M,r$d,r$T)},r$S.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},r$S._releaseMem=function(){if(this._$P){var r$S=this._$P.cacheCanvas;r$S&&r$S.ctx&&(r$Z.recover("RenderContext",r$S.ctx),r$S.ctx.canvas.size(0,0),r$S.ctx=null);var r$Q=this._$P._filterCache;r$Q&&(r$Q.destroy(),r$Q.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},r$S._setDisplay=function(r$S){r$S||this._releaseMem(),r$M.prototype._setDisplay.call(this,r$S)},r$S.hitTestPoint=function(r$S,r$Q){var r$e=this.globalToLocal(r$H.TEMP.setTo(r$S,r$Q));return r$S=r$e.x,r$Q=r$e.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?r$g.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(r$S,r$Q)},r$S.getMousePoint=function(){return this.globalToLocal(r$H.TEMP.setTo(r$O.stage.mouseX,r$O.stage.mouseY))},r$S._getWords=function(){return null},r$S._addChildsToLayout=function(r$S){var r$Q=this._getWords();if(null==r$Q&&0==this._childs.length)return!1;if(r$Q)for(var r$e=0,r$l=r$Q.length;r$e<r$l;r$e++)r$S.push(r$Q[r$e]);r$e=0;for(var r$M=this._childs.length;r$e<r$M;++r$e){var r$d=this._childs[r$e];r$d._style._enableLayout()&&r$d._addToLayout(r$S)}return!0},r$S._addToLayout=function(r$S){this._style.absolute||(this._style.block?r$S.push(this):this._addChildsToLayout(r$S)&&(this.x=this.y=0))},r$S._isChar=function(){return!1},r$S._getCSSStyle=function(){return this._style.getCSSStyle()},r$S._setAttributes=function(r$S,r$Q){switch(r$S){case"x":this.x=parseFloat(r$Q);break;case"y":this.y=parseFloat(r$Q);break;case"width":this.width=parseFloat(r$Q);break;case"height":this.height=parseFloat(r$Q);break;default:this[r$S]=r$Q}},r$S._layoutLater=function(){this.parent&&this.parent._layoutLater()},r$L(0,r$S,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(r$S){this._optimizeScrollRect!=r$S&&(this._optimizeScrollRect=r$S,this.conchModel&&this.conchModel.optimizeScrollRect(r$S))}),r$L(0,r$S,"customRenderEnable",null,function(r$S){if(r$S&&(this._renderType|=1024,r$m.isConchNode)){r$e.CustomList.push(this);var r$Q=new r$AS("2d");r$Q._setContext(new CanvasRenderingContext2D),this.customContext=new r$$(0,0,r$Q),r$Q.context.setCanvasType&&r$Q.context.setCanvasType(2),this.conchModel.custom(r$Q.context)}}),r$L(0,r$S,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(r$S){this.cacheAs=r$S?this._$P.hasFilter?"none":"normal":"none"}),r$L(0,r$S,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(r$S){var r$Q=this._$P.cacheCanvas;if(r$S!==(r$Q?r$Q.type:"none")){if("none"!==r$S)this._getBit(1)||this._setUpNoticeType(1),r$Q||(r$Q=this._set$P("cacheCanvas",r$Z.getItemByClass("cacheCanvas",Object))),r$Q.type=r$S,r$Q.reCache=!0,this._renderType|=16,"bitmap"==r$S&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(r$Q){var r$e=r$Q;r$e&&r$e.ctx&&(r$Z.recover("RenderContext",r$e.ctx),r$e.ctx.canvas.size(0,0),r$e.ctx=null),r$Z.recover("cacheCanvas",r$Q)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),r$L(0,r$S,"zOrder",function(){return this._zOrder},function(r$S){this._zOrder!=r$S&&(this._zOrder=r$S,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(r$S),this._parent&&(r$S&&this._parent._set$P("hasZorder",!0),r$O.timer.callLater(this._parent,this.updateZOrder)))}),r$L(0,r$S,"rotation",function(){return this._style._tf.rotate},function(r$S){var r$Q=this.getStyle();if(r$Q._tf.rotate!==r$S){r$Q.setRotate(r$S),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(r$S),this._renderType|=4;var r$e=this._parent;r$e&&0===r$e._repaint&&(r$e._repaint=1,r$e.parentRepaint())}}),r$L(0,r$S,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(r$S){this._width!==r$S&&(this._width=r$S,this.conchModel&&this.conchModel.size(r$S,this._height),this.repaint())}),r$L(0,r$S,"x",function(){return this._x},function(r$S){if(this._x!==r$S){if(this.destroyed)return;this._x=r$S,this.conchModel&&this.conchModel.pos(r$S,this._y);var r$Q=this._parent;r$Q&&0===r$Q._repaint&&(r$Q._repaint=1,r$Q.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),r$L(0,r$S,"globalScaleY",function(){for(var r$S=1,r$Q=this;r$Q&&r$Q!==r$O.stage;)r$S*=r$Q.scaleY,r$Q=r$Q.parent;return r$S}),r$L(0,r$S,"hitArea",function(){return this._$P.hitArea},function(r$S){this._set$P("hitArea",r$S)}),r$L(0,r$S,"staticCache",function(){return this._$P.staticCache},function(r$S){this._set$P("staticCache",r$S),r$S||this.reCache()}),r$L(0,r$S,"texture",function(){return this._texture},function(r$S){this._texture!=r$S&&(this._texture=r$S,this.graphics.cleanByTexture(r$S,0,0))}),r$L(0,r$S,"y",function(){return this._y},function(r$S){if(this._y!==r$S){if(this.destroyed)return;this._y=r$S,this.conchModel&&this.conchModel.pos(this._x,r$S);var r$Q=this._parent;r$Q&&0===r$Q._repaint&&(r$Q._repaint=1,r$Q.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),r$L(0,r$S,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(r$S){this._height!==r$S&&(this._height=r$S,this.conchModel&&this.conchModel.size(this._width,r$S),this.repaint())}),r$L(0,r$S,"blendMode",function(){return this._style.blendMode},function(r$S){this.getStyle().blendMode=r$S,this.conchModel&&this.conchModel.blendMode(r$S),r$S&&"source-over"!=r$S?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),r$L(0,r$S,"scaleX",function(){return this._style._tf.scaleX},function(r$S){var r$Q=this.getStyle();if(r$Q._tf.scaleX!==r$S){r$Q.setScaleX(r$S),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(r$S,r$Q._tf.scaleY),this._renderType|=4;var r$e=this._parent;r$e&&0===r$e._repaint&&(r$e._repaint=1,r$e.parentRepaint())}}),r$L(0,r$S,"scaleY",function(){return this._style._tf.scaleY},function(r$S){var r$Q=this.getStyle();if(r$Q._tf.scaleY!==r$S){r$Q.setScaleY(r$S),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(r$Q._tf.scaleX,r$S),this._renderType|=4;var r$e=this._parent;r$e&&0===r$e._repaint&&(r$e._repaint=1,r$e.parentRepaint())}}),r$L(0,r$S,"stage",function(){return r$O.stage}),r$L(0,r$S,"skewX",function(){return this._style._tf.skewX},function(r$S){var r$Q=this.getStyle();if(r$Q._tf.skewX!==r$S){r$Q.setSkewX(r$S),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(r$S,r$Q._tf.skewY),this._renderType|=4;var r$e=this._parent;r$e&&0===r$e._repaint&&(r$e._repaint=1,r$e.parentRepaint())}}),r$L(0,r$S,"scrollRect",function(){return this._style.scrollRect},function(r$S){this.getStyle().scrollRect=r$S,this.repaint(),r$S?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(r$S.x,r$S.y,r$S.width,r$S.height)):(this._renderType&=-129,this.conchModel&&(r$e.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),r$L(0,r$S,"skewY",function(){return this._style._tf.skewY},function(r$S){var r$Q=this.getStyle();if(r$Q._tf.skewY!==r$S){r$Q.setSkewY(r$S),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(r$Q._tf.skewX,r$S),this._renderType|=4;var r$e=this._parent;r$e&&0===r$e._repaint&&(r$e._repaint=1,r$e.parentRepaint())}}),r$L(0,r$S,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(r$S){this._tfChanged=!1,(this._transform=r$S)&&(this._x=r$S.tx,this._y=r$S.ty,r$S.tx=r$S.ty=0,this.conchModel&&this.conchModel.transform(r$S.a,r$S.b,r$S.c,r$S.d,this._x,this._y)),r$S?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),r$L(0,r$S,"pivotX",function(){return this._style._tf.translateX},function(r$S){this.getStyle().setTranslateX(r$S),this.conchModel&&this.conchModel.pivot(r$S,this._style._tf.translateY),this.repaint()}),r$L(0,r$S,"pivotY",function(){return this._style._tf.translateY},function(r$S){this.getStyle().setTranslateY(r$S),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,r$S),this.repaint()}),r$L(0,r$S,"alpha",function(){return this._style.alpha},function(r$S){this._style&&this._style.alpha!==r$S&&(r$S=r$S<0?0:1<r$S?1:r$S,this.getStyle().alpha=r$S,this.conchModel&&this.conchModel.alpha(r$S),1!==r$S?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),r$L(0,r$S,"visible",function(){return this._style.visible},function(r$S){this._style&&this._style.visible!==r$S&&(this.getStyle().visible=r$S,this.conchModel&&this.conchModel.visible(r$S),this.parentRepaint())}),r$L(0,r$S,"graphics",function(){return this._graphics||(this.graphics=r$k.createGraphics())},function(r$S){this._graphics&&(this._graphics._sp=null),(this._graphics=r$S)?(this._renderType&=-2,this._renderType|=512,(r$S._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(r$e.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),r$L(0,r$S,"filters",function(){return this._$P.filters},function(r$S){r$S&&0===r$S.length&&(r$S=null),this._$P.filters!=r$S&&(this._set$P("filters",r$S?r$S.slice():null),r$m.isConchApp&&(this.conchModel&&(r$e.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),r$m.isWebGL&&(r$S&&r$S.length?this._renderType|=32:this._renderType&=-33),r$S&&0<r$S.length?(this._getBit(1)||this._setUpNoticeType(1),r$m.isWebGL&&1==r$S.length&&r$S[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(r$m.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),r$L(0,r$S,"parent",r$M.prototype._$get_parent,function(r$S){r$O.superSet(r$SS,this,"parent",r$S),r$S&&this._getBit(2)&&this._$2__onDisplay()}),r$L(0,r$S,"mask",function(){return this._$P._mask},function(r$S){r$S&&this.mask&&this.mask._$P.maskParent||(r$S?(this.cacheAs="bitmap",this._set$P("_mask",r$S),r$S._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",r$S),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(r$S?r$S.conchModel:null),this._renderType|=64,this.parentRepaint())}),r$L(0,r$S,"mouseEnabled",function(){return 1<this._mouseEnableState},function(r$S){this._mouseEnableState=r$S?2:1}),r$L(0,r$S,"globalScaleX",function(){for(var r$S=1,r$Q=this;r$Q&&r$Q!==r$O.stage;)r$S*=r$Q.scaleX,r$Q=r$Q.parent;return r$S}),r$L(0,r$S,"mouseX",function(){return this.getMousePoint().x}),r$L(0,r$S,"mouseY",function(){return this.getMousePoint().y}),r$e.fromImage=function(r$S){return(new r$e).loadImage(r$S)},r$e._cachePool=[],r$e.CustomList=[],r$i(r$e,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=r$T.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),r$e}(r$SS),r$pS=function(r$S){function r$Q(r$S){this._audio=null,this._onEnd=null,this._resumePlay=null,r$Q.__super.call(this),this._onEnd=r$V.bind(this.__onEnd,this),this._resumePlay=r$V.bind(this.__resumePlay,this),r$S.addEventListener("ended",this._onEnd),this._audio=r$S}r$o(r$Q,"laya.media.h5audio.AudioSoundChannel",r$lS);var r$e=r$Q.prototype;return r$e.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(r$O.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},r$e.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,r$f.container.appendChild(this._audio),this._audio.play()}catch(r$S){this.event("error")}},r$e.play=function(r$S){this.isStopped=!1;try{this._audio.playbackRate=r$t.playbackRate,this._audio.currentTime=this.startTime}catch(r$S){return void this._audio.addEventListener("canplay",this._resumePlay)}r$t.addChannel(this),r$f.container.appendChild(this._audio),!r$S&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},r$e.stop=function(){this.isStopped=!0,r$t.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&r$m.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),r$f.onIE||this._audio!=r$eS._musicAudio&&r$Z.recover("audio:"+this.url,this._audio),r$f.removeElement(this._audio),this._audio=null)},r$e.pause=function(){this.isStopped=!0,r$t.removeChannel(this),"pause"in this._audio&&this._audio.pause()},r$e.resume=function(){this._audio&&(this.isStopped=!1,r$t.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},r$L(0,r$e,"position",function(){return this._audio?this._audio.currentTime:0}),r$L(0,r$e,"duration",function(){return this._audio?this._audio.duration:0}),r$L(0,r$e,"volume",function(){return this._audio?this._audio.volume:1},function(r$S){this._audio&&(this._audio.volume=r$S)}),r$Q}(),r$JS=function(r$S){function r$Q(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=r$dS.ctx,r$Q.__super.call(this),this._onPlayEnd=r$V.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}r$o(r$Q,"laya.media.webaudio.WebAudioSoundChannel",r$lS);var r$e=r$Q.prototype;return r$e.play=function(r$S){if(r$t.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var r$Q=this.context,r$e=this.gain,r$l=r$Q.createBufferSource();(this.bufferSource=r$l).buffer=this.audioBuffer,r$l.connect(r$e),r$e&&r$e.disconnect(),r$e.connect(r$Q.destination),r$l.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=r$f.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(r$l.loop=!0),r$l.playbackRate.setTargetAtTime?r$l.playbackRate.setTargetAtTime(r$t.playbackRate,this.context.currentTime,.1):r$l.playbackRate.value=r$t.playbackRate,r$l.start(0,this.startTime),!r$S&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},r$e.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(r$O.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},r$e._clearBufferSource=function(){if(this.bufferSource){var r$S=this.bufferSource;r$S.stop?r$S.stop(0):r$S.noteOff(0),r$S.disconnect(0),r$S.onended=null,r$Q._tryCleanFailed||this._tryClearBuffer(r$S),this.bufferSource=null}},r$e._tryClearBuffer=function(r$S){try{r$S.buffer=null}catch(r$S){r$Q._tryCleanFailed=!0}},r$e.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,r$t.removeChannel(this),this.startHandler=null,this.completeHandler=null},r$e.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,r$t.removeChannel(this)},r$e.resume=function(){this.startTime=this._pauseTime,this.play(!1)},r$L(0,r$e,"position",function(){return this.bufferSource?(r$f.now()-this._startTime)/1e3+this.startTime:0}),r$L(0,r$e,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),r$L(0,r$e,"volume",function(){return this._volume},function(r$S){this.isStopped||(this._volume=r$S,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(r$S,this.context.currentTime,.1):this.gain.gain.value=r$S)}),r$Q._tryCleanFailed=!1,r$Q}(),r$LS=function(r$S){function r$Q(){r$Q.__super.call(this),this._w=0,this._h=0}r$o(r$Q,"laya.resource.Bitmap",r$RS);var r$e=r$Q.prototype;return r$L(0,r$e,"width",function(){return this._w}),r$L(0,r$e,"height",function(){return this._h}),r$L(0,r$e,"source",function(){return this._source}),r$Q}(),r$jS=function(r$Q){function r$S(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,r$S.__super.call(this),this._interval=r$l.animationInterval,this._setUpNoticeType(1)}r$o(r$S,"laya.display.AnimationPlayerBase",r$Q);var r$e=r$S.prototype;return r$e.play=function(r$S,r$Q,r$e,r$l){void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=!0),void 0===r$e&&(r$e=""),void 0===r$l&&(r$l=!0),this._isPlaying=!0,this.index="string"==typeof r$S?this._getFrameByLabel(r$S):r$S,this.loop=r$Q,this._actionName=r$e,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},r$e._getFrameByLabel=function(r$S){var r$Q=0;for(r$Q=0;r$Q<this._count;r$Q++)if(this._labels[r$Q]&&0<=this._labels[r$Q].indexOf(r$S))return r$Q;return 0},r$e._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},r$e._setControlNode=function(r$S){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=r$S)&&r$S!=this&&(r$S.on("display",this,this._checkResumePlaying),r$S.on("undisplay",this,this._checkResumePlaying))},r$e._setDisplay=function(r$S){r$Q.prototype._setDisplay.call(this,r$S),this._checkResumePlaying()},r$e._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},r$e.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},r$e.addLabel=function(r$S,r$Q){this._labels||(this._labels={}),this._labels[r$Q]||(this._labels[r$Q]=[]),this._labels[r$Q].push(r$S)},r$e.removeLabel=function(r$S){if(r$S){if(this._labels)for(var r$Q in this._labels)this._removeLabelFromLabelList(this._labels[r$Q],r$S)}else this._labels=null},r$e._removeLabelFromLabelList=function(r$S,r$Q){if(r$S)for(var r$e=r$S.length-1;0<=r$e;r$e--)r$S[r$e]==r$Q&&r$S.splice(r$e,1)},r$e.gotoAndStop=function(r$S){this.index="string"==typeof r$S?this._getFrameByLabel(r$S):r$S,this.stop()},r$e._displayToIndex=function(r$S){},r$e.clear=function(){this.stop(),this._labels=null},r$L(0,r$e,"interval",function(){return this._interval},function(r$S){this._interval!=r$S&&(this._frameRateChanged=!0,this._interval=r$S,this._isPlaying&&0<r$S&&this.timerLoop(r$S,this,this._frameLoop,null,!0,!0))}),r$L(0,r$e,"isPlaying",function(){return this._isPlaying}),r$L(0,r$e,"index",function(){return this._index},function(r$S){if(this._index=r$S,this._displayToIndex(r$S),this._labels&&this._labels[r$S])for(var r$Q=this._labels[r$S],r$e=0,r$l=r$Q.length;r$e<r$l;r$e++)this.event("label",r$Q[r$e])}),r$L(0,r$e,"count",function(){return this._count}),r$S.WRAP_POSITIVE=0,r$S.WRAP_REVERSE=1,r$S.WRAP_PINGPONG=2,r$S}(r$YS),r$cS=function(r$Q){function r$J(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,r$J.__super.call(this),this.overflow=r$J.VISIBLE,this._style=new r$QS(this),this._style.wordWrap=!1}r$o(r$J,"laya.display.Text",r$Q);var r$S=r$J.prototype;return r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,r$S),this._lines=null,this._words&&(this._words.length=0,this._words=null)},r$S._getBoundPointsM=function(r$S){void 0===r$S&&(r$S=!1);var r$Q=r$g.TEMP;return r$Q.setTo(0,0,this.width,this.height),r$Q._getBoundPoints()},r$S.getGraphicBounds=function(r$S){void 0===r$S&&(r$S=!1);var r$Q=r$g.TEMP;return r$Q.setTo(0,0,this.width,this.height),r$Q},r$S._getCSSStyle=function(){return this._style},r$S.lang=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o){if(r$S=r$J.langPacks&&r$J.langPacks[r$S]?r$J.langPacks[r$S]:r$S,arguments.length<2)this._text=r$S;else{for(var r$Y=0,r$p=arguments.length;r$Y<r$p;r$Y++)r$S=r$S.replace("{"+r$Y+"}",arguments[r$Y+1]);this._text=r$S}},r$S._isPassWordMode=function(){var r$S=this._style.password;return"prompt"in this&&this.prompt==this._text&&(r$S=!1),r$S},r$S._getPassWordTxt=function(r$S){var r$Q;r$Q="";for(var r$e=r$S.length;0<r$e;r$e--)r$Q+="●";return r$Q},r$S.renderText=function(r$S,r$Q){var r$e=this.graphics;r$e.clear(!0);var r$l=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(r$f.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);r$f.context.font=r$l;var r$M=this.padding,r$d=r$M[3],r$T="left",r$U=this._lines,r$i=this.leading+this._charSize.height,r$R=this._currBitmapFont;r$R&&(r$i=this.leading+r$R.getMaxHeight());var r$o=r$M[0];if(!r$R&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(r$T="right",r$d=this._width-r$M[1]):"center"==this.align&&(r$T="center",r$d=.5*this._width+r$M[3]-r$M[1])),0<this._height){var r$Y=this._textHeight>this._height?"top":this.valign;"middle"===r$Y?r$o=.5*(this._height-r$Q*r$i)+r$M[0]-r$M[2]:"bottom"===r$Y&&(r$o=this._height-r$Q*r$i-r$M[2])}var r$p=this._style;if(r$R&&r$R.autoScaleSize)var r$J=r$R.fontSize/this.fontSize;if(this._clipPoint)if(r$e.save(),r$R&&r$R.autoScaleSize){var r$L=0,r$j=0;r$L=this._width?this._width-r$M[3]-r$M[1]:this._textWidth,r$j=this._height?this._height-r$M[0]-r$M[2]:this._textHeight,r$L*=r$J,r$j*=r$J,r$e.clipRect(r$M[3],r$M[0],r$L,r$j)}else r$e.clipRect(r$M[3],r$M[0],this._width?this._width-r$M[3]-r$M[1]:this._textWidth,this._height?this._height-r$M[0]-r$M[2]:this._textHeight);var r$c=r$p.password;"prompt"in this&&this.prompt==this._text&&(r$c=!1);for(var r$G=0,r$z=0,r$A=Math.min(this._lines.length,r$Q+r$S)||1,r$v=r$S;r$v<r$A;r$v++){var r$D,r$B=r$U[r$v];if(r$c){var r$O=r$B.length;r$B="";for(var r$H=r$O;0<r$H;r$H--)r$B+="●"}if(r$G=r$d-(this._clipPoint?this._clipPoint.x:0),r$z=r$o+r$i*r$v-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(r$T,r$G,r$z,r$v),r$R){var r$g=this.width;r$R.autoScaleSize&&(r$g=this.width*r$J),r$R.drawText(r$B,this,r$G,r$z,this.align,r$g)}else r$m.isWebGL?(this._words||(this._words=[]),(r$D=this._words.length>r$v-r$S?this._words[r$v-r$S]:new r$y).setText(r$B)):r$D=r$B,r$p.stroke?r$e.fillBorderText(r$D,r$G,r$z,r$l,this.color,r$p.strokeColor,r$p.stroke,r$T):r$e.fillText(r$D,r$G,r$z,r$l,this.color,r$T)}if(r$R&&r$R.autoScaleSize){var r$I=1/r$J;this.scale(r$I,r$I)}this._clipPoint&&r$e.restore(),this._startX=r$d,this._startY=r$o},r$S.drawUnderline=function(r$S,r$Q,r$e,r$l){var r$M=this._lineWidths[r$l];switch(r$S){case"center":r$Q-=r$M/2;break;case"right":r$Q-=r$M}r$e+=this._charSize.height,this._graphics.drawLine(r$Q,r$e,r$Q+r$M,r$e,this.underlineColor||this.color,1)},r$S.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);r$f.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new r$H(0,0)):this._clipPoint=null;var r$S=this._lines.length;if(this.overflow!=r$J.VISIBLE){var r$Q=this.overflow==r$J.HIDDEN?Math.floor:Math.ceil;r$S=Math.min(r$S,r$Q((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var r$e=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(r$e,r$S),this.repaint()},r$S.evalTextSize=function(){var r$S,r$Q=NaN;r$S=Math.max.apply(this,this._lineWidths),r$Q=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],r$S==this._textWidth&&r$Q==this._textHeight||(this._textWidth=r$S,this._textHeight=r$Q,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},r$S.checkEnabledViewportOrNot=function(){return this.overflow==r$J.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},r$S.changeText=function(r$S){this._text!==r$S&&(this.lang(r$S+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},r$S.parseLines=function(r$S){var r$Q=this.wordWrap||this.overflow==r$J.HIDDEN;if(r$Q)var r$e=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var r$l=r$f.context.measureText(r$J._testWord);r$m.isConchApp&&0===r$l.width&&0===r$l.height&&(r$l=r$f.context.measureText("W")),this._charSize.width=r$l.width,this._charSize.height=r$l.height||this.fontSize}for(var r$M=r$S.replace(/\r\n/g,"\n").split("\n"),r$d=0,r$T=r$M.length;r$d<r$T;r$d++){var r$U=r$M[r$d];r$Q?this.parseLine(r$U,r$e):(this._lineWidths.push(this.getTextWidth(r$U)),this._lines.push(r$U))}},r$S.parseLine=function(r$S,r$Q){r$f.context;var r$e,r$l=this._lines,r$M=0,r$d=NaN,r$T=NaN,r$U=0;if((r$d=this.getTextWidth(r$S))<=r$Q)return r$l.push(r$S),void this._lineWidths.push(r$d);r$d=this._charSize.width,0==(r$M=Math.floor(r$Q/r$d))&&(r$M=1),r$T=r$d=this.getTextWidth(r$S.substring(0,r$M));for(var r$i=r$M,r$R=r$S.length;r$i<r$R;r$i++)if(r$Q<(r$T+=r$d=this.getTextWidth(r$S.charAt(r$i))))if(this.wordWrap){var r$o=r$S.substring(r$U,r$i);if(r$o.charCodeAt(r$o.length-1)<255?(r$e=/(?:\w|-)+$/.exec(r$o))&&(r$i=r$e.index+r$U,0==r$e.index?r$i+=r$o.length:r$o=r$S.substring(r$U,r$i)):r$J.RightToLeft&&(r$e=/([\u0600-\u06FF])+$/.exec(r$o))&&(r$i=r$e.index+r$U,0==r$e.index?r$i+=r$o.length:r$o=r$S.substring(r$U,r$i)),r$l.push(r$o),this._lineWidths.push(r$T-r$d),!((r$U=r$i)+r$M<r$R)){r$l.push(r$S.substring(r$U,r$R)),this._lineWidths.push(this.getTextWidth(r$l[r$l.length-1])),r$U=-1;break}r$i+=r$M,r$T=r$d=this.getTextWidth(r$S.substring(r$U,r$i)),r$i--}else if(this.overflow==r$J.HIDDEN)return r$l.push(r$S.substring(0,r$i)),void this._lineWidths.push(this.getTextWidth(r$l[r$l.length-1]));this.wordWrap&&-1!=r$U&&(r$l.push(r$S.substring(r$U,r$R)),this._lineWidths.push(this.getTextWidth(r$l[r$l.length-1])))},r$S.getTextWidth=function(r$S){return this._currBitmapFont?this._currBitmapFont.getTextWidth(r$S):r$f.context.measureText(r$S).width},r$S.getWordWrapWidth=function(){var r$S=this.padding,r$Q=NaN;return(r$Q=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(r$Q=this.wordWrap?100:r$f.width),r$Q<=0&&(r$Q=100),r$Q-r$S[3]-r$S[1]},r$S.getCharPoint=function(r$S,r$Q){this._isChanged&&r$O.timer.runCallLater(this,this.typeset);for(var r$e=0,r$l=this._lines,r$M=0,r$d=0,r$T=r$l.length;r$d<r$T;r$d++){if(r$S<(r$e+=r$l[r$d].length)){var r$U=r$d;break}r$M=r$e}var r$i=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;r$f.context.font=r$i;var r$R=this.getTextWidth(this._text.substring(r$M,r$S));return(r$Q||new r$H).setTo(this._startX+r$R-(this._clipPoint?this._clipPoint.x:0),this._startY+r$U*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},r$L(0,r$S,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(r$S){r$S!=this._width&&(r$O.superSet(r$YS,this,"width",r$S),this.isChanged=!0)}),r$L(0,r$S,"textWidth",function(){return this._isChanged&&r$O.timer.runCallLater(this,this.typeset),this._textWidth}),r$L(0,r$S,"height",function(){return this._height?this._height:this.textHeight},function(r$S){r$S!=this._height&&(r$O.superSet(r$YS,this,"height",r$S),this.isChanged=!0)}),r$L(0,r$S,"textHeight",function(){return this._isChanged&&r$O.timer.runCallLater(this,this.typeset),this._textHeight}),r$L(0,r$S,"padding",function(){return this._getCSSStyle().padding},function(r$S){this._getCSSStyle().padding=r$S,this.isChanged=!0}),r$L(0,r$S,"bold",function(){return this._getCSSStyle().bold},function(r$S){this._getCSSStyle().bold=r$S,this.isChanged=!0}),r$L(0,r$S,"text",function(){return this._text||""},function(r$S){this._text!==r$S&&(this.lang(r$S+""),this.isChanged=!0,this.event("change"))}),r$L(0,r$S,"color",function(){return this._getCSSStyle().color},function(r$S){this._getCSSStyle().color!=r$S&&(this._getCSSStyle().color=r$S,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),r$L(0,r$S,"font",function(){return this._getCSSStyle().fontFamily},function(r$S){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),r$J._bitmapFonts&&r$J._bitmapFonts[r$S]&&(this._currBitmapFont=r$J._bitmapFonts[r$S]),this._getCSSStyle().fontFamily=r$S,this.isChanged=!0}),r$L(0,r$S,"fontSize",function(){return this._getCSSStyle().fontSize},function(r$S){this._getCSSStyle().fontSize=r$S,this.isChanged=!0}),r$L(0,r$S,"italic",function(){return this._getCSSStyle().italic},function(r$S){this._getCSSStyle().italic=r$S,this.isChanged=!0}),r$L(0,r$S,"align",function(){return this._getCSSStyle().align},function(r$S){this._getCSSStyle().align=r$S,this.isChanged=!0}),r$L(0,r$S,"valign",function(){return this._getCSSStyle().valign},function(r$S){this._getCSSStyle().valign=r$S,this.isChanged=!0}),r$L(0,r$S,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(r$S){this._getCSSStyle().wordWrap=r$S,this.isChanged=!0}),r$L(0,r$S,"leading",function(){return this._getCSSStyle().leading},function(r$S){this._getCSSStyle().leading=r$S,this.isChanged=!0}),r$L(0,r$S,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(r$S){this._getCSSStyle().backgroundColor=r$S,this.isChanged=!0}),r$L(0,r$S,"borderColor",function(){return this._getCSSStyle().borderColor},function(r$S){this._getCSSStyle().borderColor=r$S,this.isChanged=!0}),r$L(0,r$S,"stroke",function(){return this._getCSSStyle().stroke},function(r$S){this._getCSSStyle().stroke=r$S,this.isChanged=!0}),r$L(0,r$S,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(r$S){this._getCSSStyle().strokeColor=r$S,this.isChanged=!0}),r$L(0,r$S,"isChanged",null,function(r$S){this._isChanged!==r$S&&(this._isChanged=r$S)&&r$O.timer.callLater(this,this.typeset)}),r$L(0,r$S,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(r$S){if(!(this.overflow!=r$J.SCROLL||this.textWidth<this._width)&&this._clipPoint){r$S=r$S<this.padding[3]?this.padding[3]:r$S;var r$Q=this._textWidth-this._width;r$S=r$Q<r$S?r$Q:r$S;var r$e=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=r$S,this.renderText(this._lastVisibleLineIndex,r$e)}}),r$L(0,r$S,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(r$S){if(!(this.overflow!=r$J.SCROLL||this.textHeight<this._height)&&this._clipPoint){r$S=r$S<this.padding[0]?this.padding[0]:r$S;var r$Q=this._textHeight-this._height,r$e=(r$S=r$Q<r$S?r$Q:r$S)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=r$e;var r$l=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=r$S,this.renderText(r$e,r$l)}}),r$L(0,r$S,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),r$L(0,r$S,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),r$L(0,r$S,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),r$L(0,r$S,"underlineColor",function(){return this._underlineColor},function(r$S){this._underlineColor=r$S,this._isChanged=!0,this.typeset()}),r$J.registerBitmapFont=function(r$S,r$Q){r$J._bitmapFonts||(r$J._bitmapFonts={}),r$J._bitmapFonts[r$S]=r$Q},r$J.unregisterBitmapFont=function(r$S,r$Q){if(void 0===r$Q&&(r$Q=!0),r$J._bitmapFonts&&r$J._bitmapFonts[r$S]){var r$e=r$J._bitmapFonts[r$S];r$Q&&r$e.destroy(),delete r$J._bitmapFonts[r$S]}},r$J.setTextRightToLeft=function(){var r$S;(r$S=r$f.canvas.source.style).display="none",r$S.position="absolute",r$S.direction="rtl",r$m._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,r$f.document.body.appendChild(r$f.canvas.source)},r$J.supportFont=function(r$S){r$f.context.font="10px sans-serif";var r$Q=r$f.context.measureText("abcji").width;r$f.context.font="10px "+r$S;var r$e=r$f.context.measureText("abcji").width;return console.log(r$Q,r$e),r$Q!==r$e},r$J._testWord="游",r$J.langPacks=null,r$J.VISIBLE="visible",r$J.SCROLL="scroll",r$J.HIDDEN="hidden",r$J.CharacterCache=!0,r$J.RightToLeft=!1,r$J._bitmapFonts=null,r$i(r$J,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),r$J}(r$YS),r$GS=function(r$Y){function r$T(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",r$T.__super.call(this),this.offset=new r$H,this._canvasTransform=new r$X,this._previousOrientation=r$f.window.orientation;var r$Q=this;this.transform=r$X.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var r$S=r$f.window,r$e=this;r$S.addEventListener("focus",function(){r$Q._isFocused=!0,r$e.event("focus"),r$e.event("focuschange")}),r$S.addEventListener("blur",function(){r$Q._isFocused=!1,r$e.event("blur"),r$e.event("focuschange"),r$e._isInputting()&&(r$DS.inputElement.target.focus=!1)});var r$l="visibilityState",r$M="visibilitychange",r$d=r$S.document;void 0!==r$d.hidden?(r$M="visibilitychange",r$l="visibilityState"):void 0!==r$d.mozHidden?(r$M="mozvisibilitychange",r$l="mozVisibilityState"):void 0!==r$d.msHidden?(r$M="msvisibilitychange",r$l="msVisibilityState"):void 0!==r$d.webkitHidden&&(r$M="webkitvisibilitychange",r$l="webkitVisibilityState"),r$S.document.addEventListener(r$M,function(){"hidden"==r$f.document[r$l]?r$e._setStageVisible(!1):r$e._setStageVisible(!0)}),r$S.document.addEventListener("qbrowserVisibilityChange",function(r$S){r$e._setStageVisible(!r$S.hidden)}),r$S.addEventListener("resize",function(){var r$S=r$f.window.orientation;null!=r$S&&r$S!=r$Q._previousOrientation&&r$e._isInputting()&&(r$DS.inputElement.target.focus=!1),r$Q._previousOrientation=r$S,r$e._isInputting()||r$e._resetCanvas()}),r$S.addEventListener("orientationchange",function(r$S){r$e._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),r$f.onMobile&&this.on("mousedown",this,this._onmouseMove)}r$o(r$T,"laya.display.Stage",r$Y);var r$S=r$T.prototype;return r$S._setStageVisible=function(r$S){this._isVisibility!=r$S&&(this._isVisibility=r$S,this._isVisibility||this._isInputting()&&(r$DS.inputElement.target.focus=!1),this.event("visibilitychange"))},r$S._isInputting=function(){return r$f.onMobile&&r$DS.isInputting},r$S._changeCanvasSize=function(){this.setScreenSize(r$f.clientWidth*r$f.pixelRatio,r$f.clientHeight*r$f.pixelRatio)},r$S._resetCanvas=function(){if(this.screenAdaptationEnabled){var r$S=r$m._mainCanvas;r$S.source.style;r$S.size(1,1),r$O.timer.once(100,this,this._changeCanvasSize)}},r$S.setScreenSize=function(r$S,r$Q){var r$e=!1;if("none"!==this._screenMode&&(r$e=(r$S/r$Q<1?"vertical":"horizontal")!==this._screenMode)){var r$l=r$Q;r$Q=r$S,r$S=r$l}this.canvasRotation=r$e;var r$M=r$m._mainCanvas,r$d=r$M.source.style,r$T=this._canvasTransform.identity(),r$U=this._scaleMode,r$i=r$S/this.designWidth,r$R=r$Q/this.designHeight,r$o=this.designWidth,r$Y=this.designHeight,r$p=r$S,r$J=r$Q,r$L=r$f.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,r$U){case"noscale":r$i=r$R=1,r$p=this.designWidth,r$J=this.designHeight;break;case"showall":r$i=r$R=Math.min(r$i,r$R),r$o=r$p=Math.round(this.designWidth*r$i),r$Y=r$J=Math.round(this.designHeight*r$R);break;case"noborder":r$i=r$R=Math.max(r$i,r$R),r$p=Math.round(this.designWidth*r$i),r$J=Math.round(this.designHeight*r$R);break;case"full":r$i=r$R=1,this._width=r$o=r$S,this._height=r$Y=r$Q;break;case"fixedwidth":r$R=r$i,this._height=r$Y=Math.round(r$Q/r$i);break;case"fixedheight":r$i=r$R,this._width=r$o=Math.round(r$S/r$R);break;case"fixedauto":r$S/r$Q<this.designWidth/this.designHeight?(r$R=r$i,this._height=r$Y=Math.round(r$Q/r$i)):(r$i=r$R,this._width=r$o=Math.round(r$S/r$R))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,r$o=r$o+1&2147483646,r$Y=r$Y+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),r$i*=this.scaleX,r$R*=this.scaleY,1===r$i&&1===r$R?this.transform.identity():(this.transform.a=this._formatData(r$i/(r$p/r$o)),this.transform.d=this._formatData(r$R/(r$J/r$Y)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),r$M.size(r$o,r$Y),r$k.changeWebGLSize(r$o,r$Y),r$T.scale(r$p/r$o/r$L,r$J/r$Y/r$L),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(r$S-r$p)/r$L:this.offset.x=.5*(r$S-r$p)/r$L,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(r$Q-r$J)/r$L:this.offset.y=.5*(r$Q-r$J)/r$L,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),r$T.translate(this.offset.x,this.offset.y),this.canvasDegree=0,r$e&&("horizontal"===this._screenMode?(r$T.rotate(Math.PI/2),r$T.translate(r$Q/r$L,0),this.canvasDegree=90):(r$T.rotate(-Math.PI/2),r$T.translate(0,r$S/r$L),this.canvasDegree=-90)),r$T.a=this._formatData(r$T.a),r$T.d=this._formatData(r$T.d),r$T.tx=this._formatData(r$T.tx),r$T.ty=this._formatData(r$T.ty),r$d.transformOrigin=r$d.webkitTransformOrigin=r$d.msTransformOrigin=r$d.mozTransformOrigin=r$d.oTransformOrigin="0px 0px 0px",r$d.transform=r$d.webkitTransform=r$d.msTransform=r$d.mozTransform=r$d.oTransform="matrix("+r$T.toString()+")",r$T.translate(parseInt(r$d.left)||0,parseInt(r$d.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},r$S._formatData=function(r$S){return Math.abs(r$S)<1e-6?0:Math.abs(1-r$S)<.001?0<r$S?1:-1:r$S},r$S.getMousePoint=function(){return r$H.TEMP.setTo(this.mouseX,this.mouseY)},r$S.repaint=function(){this._repaint=1},r$S.parentRepaint=function(){},r$S._loop=function(){return this.render(r$m.context,0,0),!0},r$S._onmouseMove=function(r$S){this._mouseMoveTime=r$f.now()},r$S.getTimeFromFrameStart=function(){return r$f.now()-this._frameStartTime},r$S.render=function(r$S,r$Q,r$e){if("sleep"===this._frameRate&&!r$m.isConchApp){var r$l=r$f.now();if(!(1e3<=r$l-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(r$N.loopCount++,r$j.instance.runEvent(),r$O.timer._update()));this._frameStartTime=r$l}if(this._renderCount++,r$m.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=r$f.now();var r$M="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),r$d=this._renderCount%2==0;if(r$N.renderSlow=!r$M,r$M||r$d||r$m.isConchApp){var r$T;r$N.loopCount++,r$j.instance.runEvent(),r$O.timer._update(),r$k.update3DLoop();var r$U=0,r$i=0;if(r$m.isConchNode)for(r$U=0,r$i=this._scenes.length;r$U<r$i;r$U++)(r$T=this._scenes[r$U])&&r$T._updateSceneConch();else for(r$U=0,r$i=this._scenes.length;r$U<r$i;r$U++)(r$T=this._scenes[r$U])&&r$T._updateScene();if(r$m.isConchNode){var r$R=r$YS.CustomList;for(r$U=0,r$i=r$R.length;r$U<r$i;r$U++){var r$o=r$R[r$U];r$o.customRender(r$o.customContext,0,0)}return}}r$m.isConchNode||this.renderingEnabled&&(r$M||!r$d||r$m.isConchWebGL)&&(r$m.isWebGL?r$m.WebGL.mainContext&&!r$m.WebGL.mainContext.isContextLost()&&(r$S.clear(),r$Y.prototype.render.call(this,r$S,r$Q,r$e),r$N._show&&r$N._sp&&r$N._sp.render(r$S,r$Q,r$e),r$k.clear(this._bgColor),r$k.beginFlush(),r$S.flush(),r$k.endFinish(),r$_.instance&&r$_.getInstance().endDispose()):(r$k.clear(this._bgColor),r$Y.prototype.render.call(this,r$S,r$Q,r$e),r$N._show&&r$N._sp&&r$N._sp.render(r$S,r$Q,r$e)))}else this._renderCount%5==0&&(r$N.loopCount++,r$j.instance.runEvent(),r$O.timer._update())},r$S._requestFullscreen=function(){var r$S=r$f.document.documentElement;r$S.requestFullscreen?r$S.requestFullscreen():r$S.mozRequestFullScreen?r$S.mozRequestFullScreen():r$S.webkitRequestFullscreen?r$S.webkitRequestFullscreen():r$S.msRequestFullscreen&&r$S.msRequestFullscreen()},r$S._fullScreenChanged=function(){r$O.stage.event("fullscreenchange")},r$S.exitFullscreen=function(){var r$S=r$f.document;r$S.exitFullscreen?r$S.exitFullscreen():r$S.mozCancelFullScreen?r$S.mozCancelFullScreen():r$S.webkitExitFullscreen&&r$S.webkitExitFullscreen()},r$L(0,r$S,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),r$L(0,r$S,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),r$L(0,r$S,"frameRate",function(){return this._frameRate},function(r$S){if(this._frameRate=r$S,r$m.isConchApp)switch(this._frameRate){case"slow":r$f.window.conch&&r$f.window.conchConfig.setSlowFrame&&r$f.window.conchConfig.setSlowFrame(!0);break;case"fast":r$f.window.conch&&r$f.window.conchConfig.setSlowFrame&&r$f.window.conchConfig.setSlowFrame(!1);break;case"mouse":r$f.window.conch&&r$f.window.conchConfig.setMouseFrame&&r$f.window.conchConfig.setMouseFrame(2e3);break;case"sleep":r$f.window.conch&&r$f.window.conchConfig.setLimitFPS&&r$f.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),r$L(0,r$S,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),r$L(0,r$S,"width",r$Y.prototype._$get_width,function(r$S){this.designWidth=r$S,r$O.superSet(r$YS,this,"width",r$S),r$O.timer.callLater(this,this._changeCanvasSize)}),r$L(0,r$S,"alignH",function(){return this._alignH},function(r$S){this._alignH=r$S,r$O.timer.callLater(this,this._changeCanvasSize)}),r$L(0,r$S,"isFocused",function(){return this._isFocused}),r$L(0,r$S,"height",r$Y.prototype._$get_height,function(r$S){this.designHeight=r$S,r$O.superSet(r$YS,this,"height",r$S),r$O.timer.callLater(this,this._changeCanvasSize)}),r$L(0,r$S,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||r$X.create()},r$Y.prototype._$set_transform),r$L(0,r$S,"isVisibility",function(){return this._isVisibility}),r$L(0,r$S,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),r$L(0,r$S,"scaleMode",function(){return this._scaleMode},function(r$S){this._scaleMode=r$S,r$O.timer.callLater(this,this._changeCanvasSize)}),r$L(0,r$S,"alignV",function(){return this._alignV},function(r$S){this._alignV=r$S,r$O.timer.callLater(this,this._changeCanvasSize)}),r$L(0,r$S,"bgColor",function(){return this._bgColor},function(r$S){this._bgColor=r$S,this.conchModel&&this.conchModel.bgColor(r$S),r$m.isWebGL&&(r$S?r$T._wgColor=r$W.create(r$S)._color:r$f.onMiniGame||(r$T._wgColor=null)),r$f.onLimixiu?r$T._wgColor=r$W.create(r$S)._color:r$m.canvas.style.background=r$S||"none"}),r$L(0,r$S,"mouseX",function(){return Math.round(r$j.instance.mouseX/this.clientScaleX)}),r$L(0,r$S,"mouseY",function(){return Math.round(r$j.instance.mouseY/this.clientScaleY)}),r$L(0,r$S,"screenMode",function(){return this._screenMode},function(r$S){this._screenMode=r$S}),r$L(0,r$S,"visible",r$Y.prototype._$get_visible,function(r$S){this.visible!==r$S&&(r$O.superSet(r$YS,this,"visible",r$S),r$m._mainCanvas.source.style.visibility=r$S?"visible":"hidden")}),r$L(0,r$S,"fullScreenEnabled",null,function(r$S){var r$Q=r$f.document,r$e=r$m.canvas;r$S?(r$e.addEventListener("mousedown",this._requestFullscreen),r$e.addEventListener("touchstart",this._requestFullscreen),r$Q.addEventListener("fullscreenchange",this._fullScreenChanged),r$Q.addEventListener("mozfullscreenchange",this._fullScreenChanged),r$Q.addEventListener("webkitfullscreenchange",this._fullScreenChanged),r$Q.addEventListener("msfullscreenchange",this._fullScreenChanged)):(r$e.removeEventListener("mousedown",this._requestFullscreen),r$e.removeEventListener("touchstart",this._requestFullscreen),r$Q.removeEventListener("fullscreenchange",this._fullScreenChanged),r$Q.removeEventListener("mozfullscreenchange",this._fullScreenChanged),r$Q.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),r$Q.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),r$T.SCALE_NOSCALE="noscale",r$T.SCALE_EXACTFIT="exactfit",r$T.SCALE_SHOWALL="showall",r$T.SCALE_NOBORDER="noborder",r$T.SCALE_FULL="full",r$T.SCALE_FIXED_WIDTH="fixedwidth",r$T.SCALE_FIXED_HEIGHT="fixedheight",r$T.SCALE_FIXED_AUTO="fixedauto",r$T.ALIGN_LEFT="left",r$T.ALIGN_RIGHT="right",r$T.ALIGN_CENTER="center",r$T.ALIGN_TOP="top",r$T.ALIGN_MIDDLE="middle",r$T.ALIGN_BOTTOM="bottom",r$T.SCREEN_NONE="none",r$T.SCREEN_HORIZONTAL="horizontal",r$T.SCREEN_VERTICAL="vertical",r$T.FRAME_FAST="fast",r$T.FRAME_SLOW="slow",r$T.FRAME_MOUSE="mouse",r$T.FRAME_SLEEP="sleep",r$T.FRAME_MOUSE_THREDHOLD=2e3,r$i(r$T,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),r$T}(r$YS),r$zS=(function(r$S){function r$Q(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,r$Q.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}r$o(r$Q,"laya.media.SoundNode",r$YS);var r$e=r$Q.prototype;r$e._onParentChange=function(){this.target=this.parent},r$e.play=function(r$S,r$Q){void 0===r$S&&(r$S=1),isNaN(r$S)&&(r$S=1),this.url&&(this.stop(),this._channel=r$t.playSound(this.url,r$S,null,r$Q))},r$e.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},r$e._setPlayAction=function(r$S,r$Q,r$e,r$l){void 0===r$l&&(r$l=!0),this[r$e]&&r$S&&(r$l?r$S.on(r$Q,this,this[r$e]):r$S.off(r$Q,this,this[r$e]))},r$e._setPlayActions=function(r$S,r$Q,r$e,r$l){if(void 0===r$l&&(r$l=!0),r$S&&r$Q){var r$M,r$d=r$Q.split(","),r$T=0;for(r$M=r$d.length,r$T=0;r$T<r$M;r$T++)this._setPlayAction(r$S,r$d[r$T],r$e,r$l)}},r$L(0,r$e,"playEvent",null,function(r$S){(this._playEvents=r$S)&&this._tar&&this._setPlayActions(this._tar,r$S,"play")}),r$L(0,r$e,"target",null,function(r$S){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=r$S,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),r$L(0,r$e,"stopEvent",null,function(r$S){(this._stopEvents=r$S)&&this._tar&&this._setPlayActions(this._tar,r$S,"stop")})}(),function(r$S){function r$Q(){this._src=null,this._onload=null,this._onerror=null,r$Q.__super.call(this)}r$o(r$Q,"laya.resource.FileBitmap",r$LS);var r$e=r$Q.prototype;return r$L(0,r$e,"src",function(){return this._src},function(r$S){this._src=r$S}),r$L(0,r$e,"onload",null,function(r$S){}),r$L(0,r$e,"onerror",null,function(r$S){}),r$Q}()),r$AS=function(r$S){function r$e(r$S,r$Q){this._is2D=!1,r$e.__super.call(this);var r$l=this;if(this._source=this,"2D"===r$S||"AUTO"===r$S&&!r$m.isWebGL){this._is2D=!0,this._source=r$Q||r$f.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var r$M=this;r$M.getContext=function(r$S,r$Q){if(r$l._ctx)return r$l._ctx;var r$e=r$l._ctx=r$l._source.getContext(r$S,r$Q);return r$e&&(r$e._canvas=r$M,r$m.isFlash||r$f.onLimixiu||(r$e.size=function(r$S,r$Q){})),r$e}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}r$o(r$e,"laya.resource.HTMLCanvas",r$LS);var r$Q=r$e.prototype;return r$Q.clear=function(){this._ctx&&this._ctx.clear()},r$Q.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},r$Q.release=function(){},r$Q._setContext=function(r$S){this._ctx=r$S},r$Q.getContext=function(r$S,r$Q){return this._ctx?this._ctx:this._ctx=r$e._createContext(this)},r$Q.getMemSize=function(){return 0},r$Q.size=function(r$S,r$Q){(this._w!=r$S||this._h!=r$Q||this._source&&(this._source.width!=r$S||this._source.height!=r$Q))&&(this._w=r$S,this._h=r$Q,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(r$S,r$Q),this._source&&(this._source.height=r$Q,this._source.width=r$S))},r$Q.getCanvas=function(){return this._source},r$Q.toBase64=function(r$S,r$Q,r$e){if(this._source)if(r$m.isConchApp&&this._source.toBase64)this._source.toBase64(r$S,r$Q,r$e);else{var r$l=this._source.toDataURL(r$S,r$Q);r$e.call(this,r$l)}},r$L(0,r$Q,"context",function(){return this._ctx}),r$L(0,r$Q,"asBitmap",null,function(r$S){}),r$e.create=function(r$S,r$Q){return new r$e(r$S,r$Q)},r$e.TYPE2D="2D",r$e.TYPE3D="3D",r$e.TYPEAUTO="AUTO",r$e._createContext=null,r$e}(),r$vS=(function(r$S){function r$i(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){throw r$i.__super.call(this),new Error("不允许new！")}r$o(r$i,"laya.resource.HTMLSubImage",r$LS),r$i.create=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){return void 0===r$U&&(r$U=!1),new r$i(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U)}}(),function(r$S){function r$Y(){this._frames=null,this._url=null,r$Y.__super.call(this),this._setControlNode(this)}r$o(r$Y,"laya.display.Animation",r$S);var r$Q=r$Y.prototype;r$Q.destroy=function(r$S){void 0===r$S&&(r$S=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,r$S),this._frames=null,this._labels=null},r$Q.play=function(r$S,r$Q,r$e,r$l){void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=!0),void 0===r$e&&(r$e=""),void 0===r$l&&(r$l=!0),r$e&&this._setFramesFromCache(r$e,r$l),this._isPlaying=!0,this.index="string"==typeof r$S?this._getFrameByLabel(r$S):r$S,this.loop=r$Q,this._actionName=r$e,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},r$Q._setFramesFromCache=function(r$S,r$Q){var r$e;return void 0===r$Q&&(r$Q=!1),this._url&&(r$S=this._url+"#"+r$S),r$S&&r$Y.framesMap[r$S]?((r$e=r$Y.framesMap[r$S])instanceof Array?(this._frames=r$Y.framesMap[r$S],this._count=this._frames.length):(r$e.nodeRoot&&(r$Y.framesMap[r$S]=this._parseGraphicAnimationByData(r$e),r$e=r$Y.framesMap[r$S]),this._frames=r$e.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=r$e.interval),this._labels=this._copyLabels(r$e.labels)),!0):(r$Q&&console.log("ani not found:",r$S),!1)},r$Q._copyLabels=function(r$S){if(!r$S)return null;var r$Q,r$e;for(r$e in r$Q={},r$S)r$Q[r$e]=r$V.copyArray([],r$S[r$e]);return r$Q},r$Q._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&r$S.prototype._frameLoop.call(this)},r$Q._displayToIndex=function(r$S){this._frames&&(this.graphics=this._frames[r$S])},r$Q.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},r$Q.loadImages=function(r$S,r$Q){return void 0===r$Q&&(r$Q=""),this._url="",this._setFramesFromCache(r$Q)||(this.frames=r$Y.framesMap[r$Q]?r$Y.framesMap[r$Q]:r$Y.createFrames(r$S,r$Q)),this},r$Q.loadAtlas=function(r$Q,r$e,r$l){void 0===r$l&&(r$l=""),this._url="";var r$M=this;function r$S(r$S){r$Q===r$S&&(r$M.frames=r$Y.framesMap[r$l]?r$Y.framesMap[r$l]:r$Y.createFrames(r$Q,r$l),r$e&&r$e.run())}return r$M._setFramesFromCache(r$l)||(r$US.getAtlas(r$Q)?r$S(r$Q):r$O.loader.load(r$Q,r$z.create(null,r$S,[r$Q]),null,"atlas")),this},r$Q.loadAnimation=function(r$S,r$Q,r$e){this._url=r$S;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,r$Q&&r$Q.run()):!r$e||r$US.getAtlas(r$e)?this._loadAnimationData(r$S,r$Q,r$e):r$O.loader.load(r$e,r$z.create(this,this._loadAnimationData,[r$S,r$Q,r$e]),null,"atlas"),this},r$Q._loadAnimationData=function(r$U,r$i,r$S){var r$R=this;if(!r$S||r$US.getAtlas(r$S)){var r$o=this;r$US.getRes(r$U)?r$Q(r$U):r$O.loader.load(r$U,r$z.create(null,r$Q,[r$U]),null,"json"),r$US.clearRes(r$U)}else console.warn("atlas load fail:"+r$S);function r$Q(r$S){if(r$US.getRes(r$S)&&r$U===r$S){var r$Q;if(r$Y.framesMap[r$U+"#"])r$o._setFramesFromCache(r$R._actionName,!0),r$R.index=0,r$R._checkResumePlaying();else{var r$e=r$o._parseGraphicAnimation(r$US.getRes(r$U));if(!r$e)return;var r$l,r$M=r$e.animationList,r$d=0,r$T=r$M.length;for(r$d=0;r$d<r$T;r$d++)r$Q=r$M[r$d],r$Y.framesMap[r$U+"#"+r$Q.name]=r$Q,r$l||(r$l=r$Q);r$l&&(r$Y.framesMap[r$U+"#"]=r$l,r$o._setFramesFromCache(r$R._actionName,!0),r$R.index=0),r$R._checkResumePlaying()}r$i&&r$i.run()}}},r$Q._parseGraphicAnimation=function(r$S){return r$OS.parseAnimationData(r$S)},r$Q._parseGraphicAnimationByData=function(r$S){return r$OS.parseAnimationByData(r$S)},r$L(0,r$Q,"frames",function(){return this._frames},function(r$S){(this._frames=r$S)&&(this._count=r$S.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),r$L(0,r$Q,"autoPlay",null,function(r$S){r$S?this.play():this.stop()}),r$L(0,r$Q,"source",null,function(r$S){-1<r$S.indexOf(".ani")?this.loadAnimation(r$S):-1<r$S.indexOf(".json")||-1<r$S.indexOf("als")||-1<r$S.indexOf("atlas")?this.loadAtlas(r$S):this.loadImages(r$S.split(","))}),r$L(0,r$Q,"autoAnimation",null,function(r$S){this.play(0,!0,r$S,!1)}),r$Y.createFrames=function(r$S,r$Q){var r$e,r$l,r$M=0,r$d=0;if("string"==typeof r$S){var r$T=r$US.getAtlas(r$S);if(r$T&&r$T.length)for(r$e=[],r$M=0,r$d=r$T.length;r$M<r$d;r$M++)(r$l=new r$k.createGraphics).drawTexture(r$US.getRes(r$T[r$M]),0,0),r$e.push(r$l)}else if(r$S instanceof Array)for(r$e=[],r$M=0,r$d=r$S.length;r$M<r$d;r$M++)(r$l=new r$k.createGraphics).loadImage(r$S[r$M],0,0),r$e.push(r$l);return r$Q&&(r$Y.framesMap[r$Q]=r$e),r$e},r$Y.clearCache=function(r$S){var r$Q,r$e=r$Y.framesMap,r$l=r$S+"#";for(r$Q in r$e)r$Q!==r$S&&0!=r$Q.indexOf(r$l)||delete r$Y.framesMap[r$Q]},r$Y.framesMap={}}(r$jS),function(r$S){function r$d(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,r$d.__super.call(this),null==r$d._sortIndexFun&&(r$d._sortIndexFun=r$B.sortByKey("index",!1,!0))}r$o(r$d,"laya.display.FrameAnimation",r$S);var r$Q=r$d.prototype;return r$Q._setUp=function(r$S,r$Q){this._labels=null,this._animationNewFrames=null,this._targetDic=r$S,this._animationData=r$Q,this.interval=1e3/r$Q.frameRate,r$Q.parsed?(this._count=r$Q.count,this._labels=r$Q.labels,this._animationNewFrames=r$Q.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),r$Q.parsed=!0,r$Q.labels=this._labels,r$Q.count=this._count,r$Q.animationNewFrames=this._animationNewFrames},r$Q.clear=function(){r$S.prototype.clear.call(this),this._targetDic=null,this._animationData=null},r$Q._displayToIndex=function(r$S){if(this._animationData){r$S<0&&(r$S=0),r$S>this._count&&(r$S=this._count);var r$Q=this._animationData.nodes,r$e=0,r$l=r$Q.length;for(r$e=0;r$e<r$l;r$e++)this._displayNodeToFrame(r$Q[r$e],r$S)}},r$Q._displayNodeToFrame=function(r$S,r$Q,r$e){r$e||(r$e=this._targetDic);var r$l=r$e[r$S.target];if(r$l){var r$M,r$d,r$T,r$U=r$S.frames,r$i=r$S.keys,r$R=0,r$o=r$i.length;for(r$R=0;r$R<r$o;r$R++)r$T=(r$d=r$U[r$M=r$i[r$R]]).length>r$Q?r$d[r$Q]:r$d[r$d.length-1],r$l[r$M]=r$T}},r$Q._calculateDatas=function(){if(this._animationData){var r$S,r$Q=this._animationData.nodes,r$e=0,r$l=r$Q.length;for(r$e=this._count=0;r$e<r$l;r$e++)r$S=r$Q[r$e],this._calculateNodeKeyFrames(r$S);this._count+=1}},r$Q._calculateNodeKeyFrames=function(r$S){var r$Q,r$e,r$l=r$S.keyframes,r$M=r$S.target;for(r$Q in r$S.frames||(r$S.frames={}),r$S.keys?r$S.keys.length=0:r$S.keys=[],r$S.initValues||(r$S.initValues={}),r$l)r$e=r$l[r$Q],r$S.frames[r$Q]||(r$S.frames[r$Q]=[]),this._targetDic&&this._targetDic[r$M]&&(r$S.initValues[r$Q]=this._targetDic[r$M][r$Q]),r$e.sort(r$d._sortIndexFun),r$S.keys.push(r$Q),this._calculateNodePropFrames(r$e,r$S.frames[r$Q],r$Q,r$M)},r$Q.resetToInitState=function(){if(this._targetDic&&this._animationData){var r$S,r$Q,r$e=this._animationData.nodes,r$l=0,r$M=r$e.length;for(r$l=0;r$l<r$M;r$l++)if(r$Q=(r$S=r$e[r$l]).initValues){var r$d,r$T=this._targetDic[r$S.target];if(r$T)for(r$d in r$Q)r$T[r$d]=r$Q[r$d]}}},r$Q._calculateNodePropFrames=function(r$S,r$Q,r$e,r$l){var r$M=0,r$d=r$S.length-1;if(0<r$d){for(r$Q.length=r$S[r$d].index+1,r$M=0;r$M<r$d;r$M++)this._dealKeyFrame(r$S[r$M]),this._calculateFrameValues(r$S[r$M],r$S[r$M+1],r$Q);this._dealKeyFrame(r$S[r$M])}0==r$d&&(r$Q[r$S[0].index]=r$S[0].value,this._animationNewFrames&&(this._animationNewFrames[r$S[0].index]=!0))},r$Q._dealKeyFrame=function(r$S){r$S.label&&""!=r$S.label&&this.addLabel(r$S.label,r$S.index)},r$Q._calculateFrameValues=function(r$S,r$Q,r$e){var r$l,r$M=0,r$d=r$S.index,r$T=r$Q.index,r$U=r$S.value,r$i=r$Q.value-r$S.value,r$R=r$T-r$d;if(r$T>this._count&&(this._count=r$T),r$S.tween)for(null==(r$l=r$F[r$S.tweenMethod])&&(r$l=r$F.linearNone),r$M=r$d;r$M<r$T;r$M++)r$e[r$M]=r$l(r$M-r$d,r$U,r$i,r$R),this._animationNewFrames&&(this._animationNewFrames[r$M]=!0);else for(r$M=r$d;r$M<r$T;r$M++)r$e[r$M]=r$U;this._animationNewFrames&&(this._animationNewFrames[r$S.index]=!0,this._animationNewFrames[r$Q.index]=!0),r$e[r$Q.index]=r$Q.value},r$d._sortIndexFun=null,r$d}(r$jS)),r$DS=function(r$Q){function r$M(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",r$M.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=r$cS.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}r$o(r$M,"laya.display.Input",r$Q);var r$S=r$M.prototype;return r$S.setSelection=function(r$S,r$Q){this.focus=!0,laya.display.Input.inputElement.selectionStart=r$S,laya.display.Input.inputElement.selectionEnd=r$Q},r$S._onUnDisplay=function(r$S){this.focus=!1},r$S._onMouseDown=function(r$S){this.focus=!0},r$S._syncInputTransform=function(){var r$S=this.nativeInput,r$Q=r$V.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),r$e=this._width-this.padding[1]-this.padding[3],r$l=this._height-this.padding[0]-this.padding[2];r$m.isConchApp?(r$S.setScale(r$Q.scaleX,r$Q.scaleY),r$S.setSize(r$e,r$l),r$S.setPos(r$Q.x,r$Q.y)):(r$M.inputContainer.style.transform=r$M.inputContainer.style.webkitTransform="scale("+r$Q.scaleX+","+r$Q.scaleY+") rotate("+r$O.stage.canvasDegree+"deg)",r$S.style.width=r$e+"px",r$S.style.height=r$l+"px",r$M.inputContainer.style.left=r$Q.x+"px",r$M.inputContainer.style.top=r$Q.y+"px")},r$S.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},r$S._setInputMethod=function(){r$M.input.parentElement&&r$M.inputContainer.removeChild(r$M.input),r$M.area.parentElement&&r$M.inputContainer.removeChild(r$M.area),r$M.inputElement=this._multiline?r$M.area:r$M.input,r$M.inputContainer.appendChild(r$M.inputElement),r$cS.RightToLeft&&(r$M.inputElement.style.direction="rtl")},r$S._focusIn=function(){laya.display.Input.isInputting=!0;var r$S=this.nativeInput;this._focus=!0;var r$Q=r$S.style;r$Q.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),r$S.readOnly=!this._editable,r$m.isConchApp&&(r$S.setType(this._type),r$S.setForbidEdit(!this._editable)),r$S.maxLength=this._maxChars;this.padding;if(r$S.type=this._type,r$S.value=this._content,r$S.placeholder=this._prompt,r$O.stage.off("keydown",this,this._onKeyDown),r$O.stage.on("keydown",this,this._onKeyDown),(r$O.stage.focus=this).event("focus"),r$f.onPC&&r$S.focus(),!r$f.onMiniGame){this._text;this._text=null}this.typeset(),r$S.setColor(this._originColor),r$S.setFontSize(this.fontSize),r$S.setFontFace(r$f.onIPhone&&r$cS._fontFamilyMap[this.font]||this.font),r$m.isConchApp&&r$S.setMultiAble&&r$S.setMultiAble(this._multiline),r$Q.lineHeight=this.leading+this.fontSize+"px",r$Q.fontStyle=this.italic?"italic":"normal",r$Q.fontWeight=this.bold?"bold":"normal",r$Q.textAlign=this.align,r$Q.padding="0 0",this._syncInputTransform(),!r$m.isConchApp&&r$f.onPC&&r$O.timer.frameLoop(1,this,this._syncInputTransform)},r$S._setPromptColor=function(){(r$M.promptStyleDOM=r$f.getElementById("promptStyle"))||((r$M.promptStyleDOM=r$f.createElement("style")).setAttribute("id","promptStyle"),r$f.document.head.appendChild(r$M.promptStyleDOM)),r$M.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},r$S._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(r$O.superSet(r$cS,this,"text",this._content),r$O.superSet(r$cS,this,"color",this._originColor)):(r$O.superSet(r$cS,this,"text",this._prompt),r$O.superSet(r$cS,this,"color",this._promptColor)),r$O.stage.off("keydown",this,this._onKeyDown),r$O.stage.focus=null,this.event("blur"),r$m.isConchApp&&this.nativeInput.blur(),r$f.onPC&&r$O.timer.clear(this,this._syncInputTransform)},r$S._onKeyDown=function(r$S){13===r$S.keyCode&&(r$f.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},r$S.changeText=function(r$S){this._content=r$S,this._focus?(this.nativeInput.value=r$S||"",this.event("change")):r$Q.prototype.changeText.call(this,r$S)},r$L(0,r$S,"color",r$Q.prototype._$get_color,function(r$S){this._focus&&this.nativeInput.setColor(r$S),r$O.superSet(r$cS,this,"color",this._content?r$S:this._promptColor),this._originColor=r$S}),r$L(0,r$S,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(r$S){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),r$L(0,r$S,"multiline",function(){return this._multiline},function(r$S){this._multiline=r$S,this.valign=r$S?"top":"middle"}),r$L(0,r$S,"maxChars",function(){return this._maxChars},function(r$S){r$S<=0&&(r$S=1e5),this._maxChars=r$S}),r$L(0,r$S,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(r$S){r$O.superSet(r$cS,this,"color",this._originColor),r$S+="",this._focus?(this.nativeInput.value=r$S||"",this.event("change")):(this._multiline||(r$S=r$S.replace(/\r?\n/g,"")),(this._content=r$S)?r$O.superSet(r$cS,this,"text",r$S):(r$O.superSet(r$cS,this,"text",this._prompt),r$O.superSet(r$cS,this,"color",this.promptColor)))}),r$L(0,r$S,"nativeInput",function(){return this._multiline?r$M.area:r$M.input}),r$L(0,r$S,"prompt",function(){return this._prompt},function(r$S){!this._text&&r$S&&r$O.superSet(r$cS,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?r$O.superSet(r$cS,this,"text",this._text==this._prompt?r$S:this._text):r$O.superSet(r$cS,this,"text",r$S),this._prompt=r$cS.langPacks&&r$cS.langPacks[r$S]?r$cS.langPacks[r$S]:r$S}),r$L(0,r$S,"focus",function(){return this._focus},function(r$S){var r$Q=this.nativeInput;this._focus!==r$S&&(r$S?(r$Q.target?r$Q.target._focusOut():this._setInputMethod(),(r$Q.target=this)._focusIn()):(r$Q.target=null,this._focusOut(),r$f.document.body.scrollTop=0,r$Q.blur(),r$m.isConchApp?r$Q.setPos(-1e4,-1e4):r$M.inputContainer.contains(r$Q)&&r$M.inputContainer.removeChild(r$Q)))}),r$L(0,r$S,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(r$S){r$S?(-1<(r$S="[^"+r$S+"]").indexOf("^^")&&(r$S=r$S.replace("^^","")),this._restrictPattern=new RegExp(r$S,"g")):this._restrictPattern=null}),r$L(0,r$S,"editable",function(){return this._editable},function(r$S){this._editable=r$S,r$m.isConchApp&&r$M.input.setForbidEdit(!r$S)}),r$L(0,r$S,"promptColor",function(){return this._promptColor},function(r$S){this._promptColor=r$S,this._content||r$O.superSet(r$cS,this,"color",r$S)}),r$L(0,r$S,"type",function(){return this._type},function(r$S){this._getCSSStyle().password="password"==r$S,this._type=r$S,r$m.isConchApp&&this.nativeInput.setType(r$S)}),r$L(0,r$S,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(r$S){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),r$L(0,r$S,"asPassword",function(){return this._getCSSStyle().password},function(r$S){this._getCSSStyle().password=r$S,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),r$M.__init__=function(){r$M._createInputElement(),r$f.onMobile&&r$m.canvas.addEventListener(r$M.IOS_IFRAME?r$f.onMiniGame?"touchend":"click":"touchend",r$M._popupInputMethod)},r$M._popupInputMethod=function(r$S){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},r$M._createInputElement=function(){r$M._initInput(r$M.area=r$f.createElement("textarea")),r$M._initInput(r$M.input=r$f.createElement("input")),(r$M.inputContainer=r$f.createElement("div")).style.position="absolute",r$M.inputContainer.style.zIndex=1e5,r$f.container.appendChild(r$M.inputContainer),r$M.inputContainer.setPos=function(r$S,r$Q){r$M.inputContainer.style.left=r$S+"px",r$M.inputContainer.style.top=r$Q+"px"}},r$M._initInput=function(r$Q){var r$S=r$Q.style;r$S.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",r$S.resize="none",r$S.backgroundColor="transparent",r$S.border="none",r$S.outline="none",r$S.zIndex=1,r$Q.addEventListener("input",r$M._processInputting),r$Q.addEventListener("mousemove",r$M._stopEvent),r$Q.addEventListener("mousedown",r$M._stopEvent),r$Q.addEventListener("touchmove",r$M._stopEvent),r$Q.setFontFace=function(r$S){r$Q.style.fontFamily=r$S},r$m.isConchApp||(r$Q.setColor=function(r$S){r$Q.style.color=r$S},r$Q.setFontSize=function(r$S){r$Q.style.fontSize=r$S+"px"})},r$M._processInputting=function(r$S){var r$Q=laya.display.Input.inputElement.target;if(r$Q){var r$e=laya.display.Input.inputElement.value;r$Q._restrictPattern&&(r$e=r$e.replace(/\u2006|\x27/g,""),r$Q._restrictPattern.test(r$e)&&(r$e=r$e.replace(r$Q._restrictPattern,""),laya.display.Input.inputElement.value=r$e)),r$Q._text=r$e,r$Q.event("input")}},r$M._stopEvent=function(r$S){"touchmove"==r$S.type&&r$S.preventDefault(),r$S.stopPropagation&&r$S.stopPropagation()},r$M.TYPE_TEXT="text",r$M.TYPE_PASSWORD="password",r$M.TYPE_EMAIL="email",r$M.TYPE_URL="url",r$M.TYPE_NUMBER="number",r$M.TYPE_RANGE="range",r$M.TYPE_DATE="date",r$M.TYPE_MONTH="month",r$M.TYPE_WEEK="week",r$M.TYPE_TIME="time",r$M.TYPE_DATE_TIME="datetime",r$M.TYPE_DATE_TIME_LOCAL="datetime-local",r$M.TYPE_SEARCH="search",r$M.input=null,r$M.area=null,r$M.inputElement=null,r$M.inputContainer=null,r$M.confirmButton=null,r$M.promptStyleDOM=null,r$M.inputHeight=45,r$M.isInputting=!1,r$M.stageMatrix=null,r$i(r$M,["IOS_IFRAME",function(){return this.IOS_IFRAME=r$f.onIOS&&r$f.window.top!=r$f.window.self}]),r$M}(r$cS),r$BS=function(r$S){function r$e(r$S,r$Q){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,r$e.__super.call(this),r$S&&this._init_(r$S,r$Q)}r$o(r$e,"laya.resource.HTMLImage",r$zS);var r$Q=r$e.prototype;return r$Q._init_=function(r$S,r$Q){this._src=r$S,this._source=new r$f.window.Image,r$Q&&(r$Q.onload&&(this.onload=r$Q.onload),r$Q.onerror&&(this.onerror=r$Q.onerror),r$Q.onCreate&&r$Q.onCreate(this)),0!=r$S.indexOf("data:image")&&(this._source.crossOrigin=""),r$S&&(this._source.src=r$S)},r$Q.recreateResource=function(){var r$S=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var r$Q=this;this._source=new r$f.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(r$Q._needReleaseAgain)return r$Q._needReleaseAgain=!1,r$Q._source.onload=null,void(r$Q._source=null);r$Q._source.onload=null,r$Q.memorySize=r$S._w*r$S._h*4,r$Q._recreateLock=!1,r$Q.completeCreate()},this._source.src=this._src}},r$Q.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},r$Q.onresize=function(){this._w=this._source.width,this._h=this._source.height},r$L(0,r$Q,"onload",null,function(r$S){var r$Q=this;this._onload=r$S,this._source&&(this._source.onload=null!=this._onload?function(){r$Q.onresize(),r$Q._onload()}:null)}),r$L(0,r$Q,"onerror",null,function(r$S){var r$Q=this;this._onerror=r$S,this._source&&(this._source.onerror=null!=this._onerror?function(){r$Q._onerror()}:null)}),r$L(0,r$Q,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(r$S){this._enableMerageInAtlas=r$S,r$m.isConchApp&&this._source&&(this._source.enableMerageInAtlas=r$S)}),r$e.create=function(r$S,r$Q){return new r$e(r$S,r$Q)},r$e}(),r$OS=(function(r$d){function r$S(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,r$S.__super.call(this)}r$o(r$S,"laya.display.EffectAnimation",r$d);var r$Q=r$S.prototype;r$Q._onOtherBegin=function(r$S){r$S!=this&&this.stop()},r$Q.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},r$Q._onPlayAction=function(){this.play(0,!1)},r$Q.play=function(r$S,r$Q,r$e,r$l){void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=!0),void 0===r$e&&(r$e=""),void 0===r$l&&(r$l=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,r$S,r$Q,r$e,r$l))},r$Q._recordInitData=function(){if(this._aniKeys){var r$S,r$Q,r$e=0;for(r$S=this._aniKeys.length,r$e=0;r$e<r$S;r$e++)r$Q=this._aniKeys[r$e],this._initData[r$Q]=this._target[r$Q]}},r$Q._displayToIndex=function(r$S){if(this._animationData){r$S<0&&(r$S=0),r$S>this._count&&(r$S=this._count);var r$Q=this._animationData.nodes,r$e=0,r$l=r$Q.length;for(r$l=1<r$l?1:r$l,r$e=0;r$e<r$l;r$e++)this._displayNodeToFrame(r$Q[r$e],r$S)}},r$Q._displayNodeToFrame=function(r$S,r$Q,r$e){if(this._target){var r$l;r$l=this._target;var r$M,r$d,r$T,r$U,r$i=r$S.frames,r$R=r$S.keys,r$o=0,r$Y=r$R.length;r$U=r$S.secondFrames;var r$p,r$J,r$L,r$j,r$c=0;for(r$o=0;r$o<r$Y;r$o++)r$d=r$i[r$M=r$R[r$o]],r$T=-1==(r$c=r$U[r$M])?this._initData[r$M]:r$Q<r$c?(r$L=(r$J=r$S.keyframes[r$M])[0]).tween?(null==(r$p=r$F[r$L.tweenMethod])&&(r$p=r$F.linearNone),r$j=r$J[1],r$p(r$Q,this._initData[r$M],r$j.value-this._initData[r$M],r$j.index)):this._initData[r$M]:r$d.length>r$Q?r$d[r$Q]:r$d[r$d.length-1],r$l[r$M]=r$T}},r$Q._calculateNodeKeyFrames=function(r$S){r$d.prototype._calculateNodeKeyFrames.call(this,r$S);var r$Q,r$e,r$l,r$M=r$S.keyframes;r$S.target;for(r$Q in r$l={},r$S.secondFrames=r$l,r$M)(r$e=r$M[r$Q]).length<=1?r$l[r$Q]=-1:r$l[r$Q]=r$e[1].index},r$L(0,r$Q,"target",function(){return this._target},function(r$S){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=r$S,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),r$L(0,r$Q,"playEvent",null,function(r$S){(this._playEvents=r$S)&&this.addEvent()}),r$L(0,r$Q,"effectData",null,function(r$S){var r$Q;r$S&&((r$Q=r$S.animations)&&r$Q[0]&&(this._setUp({},r$Q[0]),r$Q[0].nodes&&r$Q[0].nodes[0]&&(this._aniKeys=r$Q[0].nodes[0].keys)))}),r$L(0,r$Q,"effectClass",null,function(r$S){var r$Q,r$e;(this._effectClass=r$r.getClass(r$S),this._effectClass)&&((r$Q=this._effectClass.uiView)&&(r$e=r$Q.animations)&&r$e[0]&&(this._setUp({},r$e[0]),r$e[0].nodes&&r$e[0].nodes[0]&&(this._aniKeys=r$e[0].nodes[0].keys)))}),r$S.EffectAnimationBegin="effectanimationbegin"}(r$vS),function(r$Q){var r$E;function r$t(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,r$t.__super.call(this)}r$o(r$t,"laya.utils.GraphicAnimation",r$Q);var r$S=r$t.prototype;return r$S._parseNodeList=function(r$S){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[r$S.compId]=r$S.props,r$S.compId&&this._nodeList.push(r$S.compId);var r$Q=r$S.child;if(r$Q){var r$e=0,r$l=r$Q.length;for(r$e=0;r$e<r$l;r$e++)this._parseNodeList(r$Q[r$e])}},r$S._calGraphicData=function(r$S){var r$Q;if(this._setUp(null,r$S),this._createGraphicData(),this._nodeIDAniDic)for(r$Q in this._nodeIDAniDic)this._nodeIDAniDic[r$Q]=null},r$S._createGraphicData=function(){var r$S,r$Q=[],r$e=0,r$l=this.count,r$M=this._animationNewFrames;for(r$M||(r$M=[]),r$e=0;r$e<r$l;r$e++)!r$M[r$e]&&r$S||(r$S=this._createFrameGraphic(r$e)),r$Q.push(r$S);this._gList=r$Q},r$S._createFrameGraphic=function(r$S){var r$Q=r$k.createGraphics();return r$t._rootMatrix||(r$t._rootMatrix=new r$X),this._updateNodeGraphic(this._rootNode,r$S,r$t._rootMatrix,r$Q),r$Q},r$S._updateNodeGraphic=function(r$S,r$Q,r$e,r$l,r$M){var r$d;void 0===r$M&&(r$M=1);var r$T,r$U,r$i,r$R=(r$d=this._nodeGDic[r$S.compId]=this._getNodeGraphicData(r$S.compId,r$Q,this._nodeGDic[r$S.compId])).alpha*r$M;if(!(r$R<.01)&&(r$d.resultTransform||(r$d.resultTransform=r$X.create()),r$T=r$d.resultTransform,r$X.mul(r$d.transform,r$e,r$T),r$d.skin&&(r$U=this._getTextureByUrl(r$d.skin))&&(r$T._checkTransform()?(r$l.drawTexture(r$U,0,0,r$d.width,r$d.height,r$T,r$R),r$d.resultTransform=null):r$l.drawTexture(r$U,r$T.tx,r$T.ty,r$d.width,r$d.height,null,r$R)),r$i=r$S.child)){var r$o,r$Y=0;for(r$o=r$i.length,r$Y=0;r$Y<r$o;r$Y++)this._updateNodeGraphic(r$i[r$Y],r$Q,r$T,r$l,r$R)}},r$S._updateNoChilds=function(r$S,r$Q){if(r$S.skin){var r$e=this._getTextureByUrl(r$S.skin);if(r$e){var r$l=r$S.transform;r$l._checkTransform();!r$l.bTransform?r$Q.drawTexture(r$e,r$l.tx,r$l.ty,r$S.width,r$S.height,null,r$S.alpha):r$Q.drawTexture(r$e,0,0,r$S.width,r$S.height,r$l.clone(),r$S.alpha)}}},r$S._updateNodeGraphic2=function(r$S,r$Q,r$e){var r$l;if(r$l=this._nodeGDic[r$S.compId]=this._getNodeGraphicData(r$S.compId,r$Q,this._nodeGDic[r$S.compId]),r$S.child){var r$M=r$l.transform;r$M._checkTransform();var r$d,r$T;r$T=(r$d=!r$M.bTransform)&&(0!=r$M.tx||0!=r$M.ty);var r$U,r$i,r$R;if((r$U=r$M.bTransform||1!=r$l.alpha)&&r$e.save(),1!=r$l.alpha&&r$e.alpha(r$l.alpha),r$d?r$T&&r$e.translate(r$M.tx,r$M.ty):r$e.transform(r$M.clone()),r$i=r$S.child,r$l.skin&&(r$R=this._getTextureByUrl(r$l.skin))&&r$e.drawTexture(r$R,0,0,r$l.width,r$l.height),r$i){var r$o,r$Y=0;for(r$o=r$i.length,r$Y=0;r$Y<r$o;r$Y++)this._updateNodeGraphic2(r$i[r$Y],r$Q,r$e)}r$U?r$e.restore():r$d?r$T&&r$e.translate(-r$M.tx,-r$M.ty):r$e.transform(r$M.clone().invert())}else this._updateNoChilds(r$l,r$e)},r$S._calculateNodeKeyFrames=function(r$S){r$Q.prototype._calculateNodeKeyFrames.call(this,r$S),this._nodeIDAniDic[r$S.target]=r$S},r$S.getNodeDataByID=function(r$S){return this._nodeIDAniDic[r$S]},r$S._getParams=function(r$S,r$Q,r$e,r$l){var r$M=r$t._temParam;r$M.length=r$Q.length;var r$d=0,r$T=r$Q.length;for(r$d=0;r$d<r$T;r$d++)r$M[r$d]=this._getObjVar(r$S,r$Q[r$d][0],r$e,r$Q[r$d][1],r$l);return r$M},r$S._getObjVar=function(r$S,r$Q,r$e,r$l,r$M){if(r$S.hasOwnProperty(r$Q)){var r$d=r$S[r$Q];if(r$e>=r$d.length&&(r$e=r$d.length-1),null!=r$S[r$Q][r$e])return r$S[r$Q][r$e]}return r$M.hasOwnProperty(r$Q)?r$M[r$Q]:r$l},r$S._getNodeGraphicData=function(r$S,r$Q,r$e){r$e||(r$e=r$E.create()),r$e.transform?r$e.transform.identity():r$e.transform=r$X.create();var r$l=this.getNodeDataByID(r$S);if(!r$l)return r$e;var r$M,r$d,r$T=r$l.frames,r$U=this._getParams(r$T,r$t._drawTextureCmd,r$Q,this._nodeDefaultProps[r$S]),r$i=r$U[0],r$R=NaN,r$o=NaN,r$Y=r$U[5],r$p=r$U[6],r$J=r$U[13],r$L=r$U[14],r$j=r$U[7],r$c=r$U[8],r$G=r$U[9],r$z=r$U[11],r$A=r$U[12];r$R=r$U[3],r$o=r$U[4],0!=r$R&&0!=r$o||(r$i=null),-1==r$R&&(r$R=0),-1==r$o&&(r$o=0),r$e.skin=r$i,r$e.width=r$R,r$e.height=r$o,r$i&&((r$M=this._getTextureByUrl(r$i))?(r$R||(r$R=r$M.sourceWidth),r$o||(r$o=r$M.sourceHeight)):console.warn("lost skin:",r$i,",you may load pics first")),r$e.alpha=r$U[10],r$d=r$e.transform,0!=r$J&&(r$Y=r$J*r$R),0!=r$L&&(r$p=r$L*r$o),0==r$Y&&0==r$p||r$d.translate(-r$Y,-r$p);var r$v=null;if(r$G||1!==r$j||1!==r$c||r$z||r$A){(r$v=r$t._tempMt).identity(),r$v.bTransform=!0;var r$D=.0174532922222222*(r$G-r$z),r$B=.0174532922222222*(r$G+r$A),r$O=Math.cos(r$B),r$H=Math.sin(r$B),r$g=Math.sin(r$D),r$I=Math.cos(r$D);r$v.a=r$j*r$O,r$v.b=r$j*r$H,r$v.c=-r$c*r$g,r$v.d=r$c*r$I,r$v.tx=r$v.ty=0}return r$v&&(r$d=r$X.mul(r$d,r$v,r$d)),r$d.translate(r$U[1],r$U[2]),r$e},r$S._getTextureByUrl=function(r$S){return r$US.getRes(r$S)},r$S.setAniData=function(r$S,r$Q){if(r$S.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=r$S,this._parseNodeList(r$S);var r$e,r$l={},r$M=[],r$d=r$S.animations,r$T=0,r$U=r$d.length;for(r$T=0;r$T<r$U;r$T++)if(r$e=r$d[r$T],this._labels=null,(!r$Q||r$Q==r$e.name)&&r$e){try{this._calGraphicData(r$e)}catch(r$S){console.warn("parse animation fail:"+r$e.name+",empty animation created"),this._gList=[]}var r$i={};r$i.interval=1e3/r$e.frameRate,r$i.frames=this._gList,r$i.labels=this._labels,r$i.name=r$e.name,r$M.push(r$i),r$l[r$e.name]=r$i}this.animationList=r$M,this.animationDic=r$l}r$t._temParam.length=0},r$S.parseByData=function(r$S){var r$Q,r$e;r$Q=r$S.nodeRoot,r$e=r$S.aniO,delete r$S.nodeRoot,delete r$S.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=r$Q,this._parseNodeList(r$Q),this._labels=null;try{this._calGraphicData(r$e)}catch(r$S){console.warn("parse animation fail:"+r$e.name+",empty animation created"),this._gList=[]}var r$l=r$S;return r$l.interval=1e3/r$e.frameRate,r$l.frames=this._gList,r$l.labels=this._labels,r$l.name=r$e.name,r$l},r$S.setUpAniData=function(r$S){if(r$S.animations){var r$Q,r$e={},r$l=[],r$M=r$S.animations,r$d=0,r$T=r$M.length;for(r$d=0;r$d<r$T;r$d++)if(r$Q=r$M[r$d]){var r$U={};r$U.name=r$Q.name,r$U.aniO=r$Q,r$U.nodeRoot=r$S,r$l.push(r$U),r$e[r$Q.name]=r$U}this.animationList=r$l,this.animationDic=r$e}},r$S._clear=function(){var r$S,r$Q;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(r$S in this._nodeGDic)(r$Q=this._nodeGDic[r$S])&&r$Q.recover();this._nodeGDic=null},r$t.parseAnimationByData=function(r$S){var r$Q;return r$t._I||(r$t._I=new r$t),r$Q=r$t._I.parseByData(r$S),r$t._I._clear(),r$Q},r$t.parseAnimationData=function(r$S){var r$Q;return r$t._I||(r$t._I=new r$t),r$t._I.setUpAniData(r$S),(r$Q={}).animationList=r$t._I.animationList,r$Q.animationDic=r$t._I.animationDic,r$t._I._clear(),r$Q},r$t._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],r$t._temParam=[],r$t._I=null,r$t._rootMatrix=null,r$i(r$t,["_tempMt",function(){return this._tempMt=new r$X}]),r$t.__init$=function(){r$E=function(){function r$S(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return r$o(r$S,""),r$S.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),r$Z.recover("GraphicNode",this)},r$S.create=function(){return r$Z.getItemByClass("GraphicNode",r$S)},r$S}()},r$t}(r$vS));r$O.__init([r$R,r$iS,r$m,r$f,r$C,r$I,r$S,r$OS])}(window,document,Laya),function(r$S,r$Q,r$e){r$e.un,r$e.uns,r$e.static;var r$l=r$e.class;r$e.getset,r$e.__newvec;new(function(){function r$S(){}return r$l(r$S,"LayaMain"),r$S}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(r$S,r$Q){"use strict";for(var r$e in Object.defineProperty(r$Q,"__esModule",{value:!0}),Laya){var r$l=Laya[r$e];r$l&&r$l.__isclass&&(r$Q[r$e]=r$l)}}),function(r$S,r$Q,r$B){r$B.un,r$B.uns;var r$T=r$B.static,r$p=r$B.class,r$l=r$B.getset,r$d=r$B.__newvec,r$o=laya.maths.Arith,r$Y=laya.maths.Bezier,r$e=laya.resource.Bitmap,r$J=laya.utils.Browser,r$i=laya.utils.Byte,r$L=laya.utils.Color,r$O=(laya.filters.ColorFilter,r$B.Config),r$M=laya.resource.Context,r$H=(laya.events.Event,laya.filters.Filter),r$U=laya.display.Graphics,r$R=laya.resource.HTMLCanvas,r$j=(laya.utils.HTMLChar,laya.resource.HTMLImage),r$c=laya.resource.HTMLSubImage,r$g=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),r$I=laya.maths.Point,r$E=laya.maths.Rectangle,r$G=laya.renders.Render,r$z=(laya.renders.RenderContext,laya.renders.RenderSprite),r$A=laya.resource.Resource,r$v=laya.resource.ResourceManager,r$D=laya.utils.RunDriver,r$t=laya.display.Sprite,r$k=laya.display.Stage,r$X=laya.utils.Stat,r$h=laya.utils.StringKey,r$b=(laya.display.css.Style,laya.system.System),r$m=laya.display.Text,r$$=laya.resource.Texture,r$n=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),r$P=laya.utils.VectorGraphManager;laya.utils.WordText;r$B.interface("laya.webgl.shapes.IShape"),r$B.interface("laya.webgl.submit.ISubmit"),r$B.interface("laya.webgl.text.ICharSegment"),r$B.interface("laya.webgl.canvas.save.ISaveData"),r$B.interface("laya.webgl.resource.IMergeAtlasBitmap"),r$B.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var r$a=function(){function r$S(){}r$p(r$S,"laya.filters.webgl.FilterActionGL");var r$Q=r$S.prototype;return r$B.imps(r$Q,{"laya.filters.IFilterActionGL":!0}),r$Q.setValue=function(r$S){},r$Q.setValueMix=function(r$S){},r$Q.apply3d=function(r$S,r$Q,r$e,r$l,r$M){return null},r$Q.apply=function(r$S){return null},r$l(0,r$Q,"typeMix",function(){return 0}),r$S}(),r$f=function(){function r$S(){}return r$p(r$S,"laya.webgl.shader.ShaderValue"),r$S}(),r$w=function(){var r$l,r$M;function r$S(r$S,r$Q,r$e){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new r$M,void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),this._cells=null,this._rowInfo=null,this._init(r$S,r$Q),this._atlasID=r$e}r$p(r$S,"laya.webgl.atlas.AtlasGrid");var r$Q=r$S.prototype;return r$Q.getAltasID=function(){return this._atlasID},r$Q.setAltasID=function(r$S){0<=r$S&&(this._atlasID=r$S)},r$Q.addTex=function(r$S,r$Q,r$e){var r$l=this._get(r$Q,r$e);return 0==r$l.ret||(this._fill(r$l.x,r$l.y,r$Q,r$e,r$S),this._texCount++),r$l},r$Q._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},r$Q._init=function(r$S,r$Q){if(this._width=r$S,this._height=r$Q,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=r$d(this._height);for(var r$e=0;r$e<this._height;r$e++)this._rowInfo[r$e]=new r$l;return this._clear(),!0},r$Q._get=function(r$S,r$Q){var r$e=new r$r;if(r$S>=this._failSize.width&&r$Q>=this._failSize.height)return r$e;for(var r$l=-1,r$M=-1,r$d=this._width,r$T=this._height,r$U=this._cells,r$i=0;r$i<r$T;r$i++)if(!(this._rowInfo[r$i].spaceCount<r$S))for(var r$R=0;r$R<r$d;){var r$o=3*(r$i*r$d+r$R);if(0!=r$U[r$o]||r$U[1+r$o]<r$S||r$U[2+r$o]<r$Q)r$R+=r$U[1+r$o];else{r$l=r$R,r$M=r$i;for(var r$Y=0;r$Y<r$S;r$Y++)if(r$U[3*r$Y+r$o+2]<r$Q){r$l=-1;break}if(!(r$l<0))return r$e.ret=!0,r$e.x=r$l,r$e.y=r$M,r$e;r$R+=r$U[1+r$o]}}return r$e},r$Q._fill=function(r$S,r$Q,r$e,r$l,r$M){var r$d=this._width,r$T=this._height;this._check(r$S+r$e<=r$d&&r$Q+r$l<=r$T);for(var r$U=r$Q;r$U<r$l+r$Q;++r$U){this._check(this._rowInfo[r$U].spaceCount>=r$e),this._rowInfo[r$U].spaceCount-=r$e;for(var r$i=0;r$i<r$e;r$i++){var r$R=3*(r$S+r$U*r$d+r$i);this._check(0==this._cells[r$R]),this._cells[r$R]=r$M,this._cells[1+r$R]=r$e,this._cells[2+r$R]=r$l}}if(0<r$S)for(r$U=0;r$U<r$l;++r$U){var r$o=0;for(r$i=r$S-1;0<=r$i&&0==this._cells[3*((r$Q+r$U)*r$d+r$i)];--r$i,++r$o);for(r$i=r$o;0<r$i;--r$i)this._cells[3*((r$Q+r$U)*r$d+r$S-r$i)+1]=r$i,this._check(0<r$i)}if(0<r$Q)for(r$i=r$S;r$i<r$S+r$e;++r$i){for(r$o=0,r$U=r$Q-1;0<=r$U&&0==this._cells[3*(r$i+r$U*r$d)];--r$U,r$o++);for(r$U=r$o;0<r$U;--r$U)this._cells[3*(r$i+(r$Q-r$U)*r$d)+2]=r$U,this._check(0<r$U)}},r$Q._check=function(r$S){0==r$S&&console.log("xtexMerger 错误啦")},r$Q._clear=function(){for(var r$S=this._texCount=0;r$S<this._height;r$S++)this._rowInfo[r$S].spaceCount=this._width;for(var r$Q=0;r$Q<this._height;r$Q++)for(var r$e=0;r$e<this._width;r$e++){var r$l=3*(r$Q*this._width+r$e);this._cells[r$l]=0,this._cells[1+r$l]=this._width-r$e,this._cells[2+r$l]=this._width-r$Q}this._failSize.width=this._width+1,this._failSize.height=this._height+1},r$S.__init$=function(){r$l=function(){function r$S(){this.spaceCount=0}return r$p(r$S,""),r$S}(),r$M=function(){function r$S(){this.width=0,this.height=0}return r$p(r$S,""),r$S}()},r$S}(),r$u=function(){function r$G(r$S,r$Q,r$e,r$l){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=r$S,this._height=r$Q,this._gridSize=r$e,this._maxAtlaserCount=r$l,this._gridNumX=r$S/r$e,this._gridNumY=r$Q/r$e,this._curAtlasIndex=0,this._atlaserArray=[]}r$p(r$G,"laya.webgl.atlas.AtlasResourceManager");var r$S=r$G.prototype;return r$S.setAtlasParam=function(r$S,r$Q,r$e,r$l){if(1==this._setAtlasParam)return r$G._sid_=0,this._width=r$S,this._height=r$Q,this._gridSize=r$e,this._maxAtlaserCount=r$l,this._gridNumX=r$S/r$e,this._gridNumY=r$Q/r$e,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},r$S.pushData=function(r$S){var r$Q,r$e=r$S.bitmap,r$l=-1,r$M=null,r$d=0,r$T=0;for(r$d=0,r$Q=this._atlaserArray.length;r$d<r$Q&&(r$T=(this._curAtlasIndex+r$d)%r$Q,-1==(r$l=(r$M=this._atlaserArray[r$T]).findBitmapIsExist(r$e)));r$d++);if(-1!=r$l){var r$U=r$M.InAtlasWebGLImagesOffsetValue[r$l];return r$L=r$U[0],r$j=r$U[1],r$M.addToAtlas(r$S,r$L,r$j),!0}this._setAtlasParam=!1;for(var r$i=Math.ceil((r$S.bitmap.width+2)/this._gridSize),r$R=Math.ceil((r$S.bitmap.height+2)/this._gridSize),r$o=!1,r$Y=0;r$Y<2;r$Y++){var r$p=this._maxAtlaserCount;for(r$d=0;r$d<r$p;r$d++){r$T=(this._curAtlasIndex+r$d)%r$p,this._atlaserArray.length-1>=r$T||this._atlaserArray.push(new r$ES(this._gridNumX,this._gridNumY,this._width,this._height,r$G._sid_++));var r$J=this._atlaserArray[r$T],r$L=0,r$j=0,r$c=r$J.addTex(1,r$i,r$R);if(r$c.ret){r$L=r$c.x*this._gridSize+1,r$j=r$c.y*this._gridSize+1,r$e.lock=!0,r$J.addToAtlasTexture(r$e,r$L,r$j),r$J.addToAtlas(r$S,r$L,r$j),r$o=!0,this._curAtlasIndex=r$T;break}}if(r$o)break;this._atlaserArray.push(new r$ES(this._gridNumX,this._gridNumY,this._width,this._height,r$G._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return r$o||console.log(">>>AtlasManager pushData error"),r$o},r$S.addToAtlas=function(r$S){laya.webgl.atlas.AtlasResourceManager.instance.pushData(r$S)},r$S.garbageCollection=function(){if(!0===this._needGC){for(var r$S=this._atlaserArray.length-this._maxAtlaserCount,r$Q=0;r$Q<r$S;r$Q++)this._atlaserArray[r$Q].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+r$S),this._atlaserArray.splice(0,r$S),this._needGC=!1}return!0},r$S.freeAll=function(){for(var r$S=0,r$Q=this._atlaserArray.length;r$S<r$Q;r$S++)this._atlaserArray[r$S].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},r$S.getAtlaserCount=function(){return this._atlaserArray.length},r$S.getAtlaserByIndex=function(r$S){return this._atlaserArray[r$S]},r$l(1,r$G,"instance",function(){return r$G._Instance||(r$G._Instance=new r$G(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),r$G._Instance}),r$l(1,r$G,"enabled",function(){return r$O.atlasEnable}),r$l(1,r$G,"atlasLimitWidth",function(){return r$G._atlasLimitWidth},function(r$S){r$G._atlasLimitWidth=r$S}),r$l(1,r$G,"atlasLimitHeight",function(){return r$G._atlasLimitHeight},function(r$S){r$G._atlasLimitHeight=r$S}),r$G._enable=function(){r$O.atlasEnable=!0},r$G._disable=function(){r$O.atlasEnable=!1},r$G.__init__=function(){r$G.atlasTextureWidth=2048,r$G.atlasTextureHeight=2048,r$G.maxTextureCount=6,r$G.atlasLimitWidth=512,r$G.atlasLimitHeight=512},r$G._atlasLimitWidth=0,r$G._atlasLimitHeight=0,r$G.gridSize=16,r$G.atlasTextureWidth=0,r$G.atlasTextureHeight=0,r$G.maxTextureCount=0,r$G._atlasRestore=0,r$G.BOARDER_TYPE_NO=0,r$G.BOARDER_TYPE_RIGHT=1,r$G.BOARDER_TYPE_LEFT=2,r$G.BOARDER_TYPE_BOTTOM=4,r$G.BOARDER_TYPE_TOP=8,r$G.BOARDER_TYPE_ALL=15,r$G._sid_=0,r$G._Instance=null,r$G}(),r$r=function(){function r$S(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return r$p(r$S,"laya.webgl.atlas.MergeFillInfo"),r$S}(),r$W=function(){function r$Q(){}return r$p(r$Q,"laya.webgl.canvas.BlendMode"),r$Q._init_=function(r$S){r$Q.fns=[r$Q.BlendNormal,r$Q.BlendAdd,r$Q.BlendMultiply,r$Q.BlendScreen,r$Q.BlendOverlay,r$Q.BlendLight,r$Q.BlendMask,r$Q.BlendDestinationOut],r$Q.targetFns=[r$Q.BlendNormalTarget,r$Q.BlendAddTarget,r$Q.BlendMultiplyTarget,r$Q.BlendScreenTarget,r$Q.BlendOverlayTarget,r$Q.BlendLightTarget,r$Q.BlendMask,r$Q.BlendDestinationOut]},r$Q.BlendNormal=function(r$S){r$S.blendFunc(1,771)},r$Q.BlendAdd=function(r$S){r$S.blendFunc(1,772)},r$Q.BlendMultiply=function(r$S){r$S.blendFunc(774,771)},r$Q.BlendScreen=function(r$S){r$S.blendFunc(1,1)},r$Q.BlendOverlay=function(r$S){r$S.blendFunc(1,769)},r$Q.BlendLight=function(r$S){r$S.blendFunc(1,1)},r$Q.BlendNormalTarget=function(r$S){r$S.blendFunc(1,771)},r$Q.BlendAddTarget=function(r$S){r$S.blendFunc(1,772)},r$Q.BlendMultiplyTarget=function(r$S){r$S.blendFunc(774,771)},r$Q.BlendScreenTarget=function(r$S){r$S.blendFunc(1,1)},r$Q.BlendOverlayTarget=function(r$S){r$S.blendFunc(1,769)},r$Q.BlendLightTarget=function(r$S){r$S.blendFunc(1,1)},r$Q.BlendMask=function(r$S){r$S.blendFunc(0,770)},r$Q.BlendDestinationOut=function(r$S){r$S.blendFunc(0,0)},r$Q.activeBlendFunction=null,r$Q.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],r$Q.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},r$Q.NORMAL="normal",r$Q.ADD="add",r$Q.MULTIPLY="multiply",r$Q.SCREEN="screen",r$Q.LIGHT="light",r$Q.OVERLAY="overlay",r$Q.DESTINATIONOUT="destination-out",r$Q.fns=[],r$Q.targetFns=[],r$Q}(),r$x=function(){function r$e(r$S){this._color=r$L.create("black"),this.setValue(r$S)}r$p(r$e,"laya.webgl.canvas.DrawStyle");var r$S=r$e.prototype;return r$S.setValue=function(r$S){if(r$S){if("string"==typeof r$S)return void(this._color=r$L.create(r$S));if(r$S instanceof laya.utils.Color)return void(this._color=r$S)}},r$S.reset=function(){this._color=r$L.create("black")},r$S.equal=function(r$S){return"string"==typeof r$S?this._color.strColor===r$S:r$S instanceof laya.utils.Color&&this._color.numColor===r$S.numColor},r$S.toColorStr=function(){return this._color.strColor},r$e.create=function(r$S){var r$Q;if(r$S&&("string"==typeof r$S?r$Q=r$L.create(r$S):r$S instanceof laya.utils.Color&&(r$Q=r$S),r$Q))return r$Q._drawStyle||(r$Q._drawStyle=new r$e(r$S));return laya.webgl.canvas.DrawStyle.DEFAULT},r$T(r$e,["DEFAULT",function(){return this.DEFAULT=new r$e("#000000")}]),r$e}(),r$F=function(){function r$S(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];r$vS.mainContext;this.ib=r$sS.create(35048),this.vb=r$yS.create(5)}r$p(r$S,"laya.webgl.canvas.Path");var r$Q=r$S.prototype;return r$Q.addPoint=function(r$S,r$Q){this.tempArray.push(r$S,r$Q)},r$Q.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},r$Q.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},r$Q.polygon=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T;return this.geomatrys.push(this._curGeomatry=r$T=new r$hS(r$S,r$Q,r$e,r$l,r$M,r$d)),r$l||(r$T.fill=!1),null==r$d&&(r$T.borderWidth=0),r$T},r$Q.setGeomtry=function(r$S){this.geomatrys.push(this._curGeomatry=r$S)},r$Q.drawLine=function(r$S,r$Q,r$e,r$l,r$M){var r$d;return this.closePath?this.geomatrys.push(this._curGeomatry=r$d=new r$XS(r$S,r$Q,r$e,r$l,r$M)):this.geomatrys.push(this._curGeomatry=r$d=new r$kS(r$S,r$Q,r$e,r$l,r$M)),r$d.fill=!1,r$d},r$Q.update=function(){var r$S=this.ib._byteLength,r$Q=this.geomatrys.length;this.offset=r$S;for(var r$e=this.geoStart;r$e<r$Q;r$e++)this.geomatrys[r$e].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=r$Q,this.count=(this.ib._byteLength-r$S)/r$jS.BYTES_PIDX},r$Q.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},r$Q.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},r$S}(),r$q=function(){function r$U(){}r$p(r$U,"laya.webgl.canvas.save.SaveBase");var r$S=r$U.prototype;return r$B.imps(r$S,{"laya.webgl.canvas.save.ISaveData":!0}),r$S.isSaveMark=function(){return!1},r$S.restore=function(r$S){this._dataObj[this._valueName]=this._value,(r$U._cache[r$U._cache._length++]=this)._newSubmit&&(r$S._curSubmit=r$dS.RENDERBASE,r$S._renderKey=0)},r$U._createArray=function(){var r$S=[];return r$S._length=0,r$S},r$U._init=function(){var r$S=r$U._namemap={};return r$S[1]="ALPHA",r$S[2]="fillStyle",r$S[8]="font",r$S[256]="lineWidth",r$S[512]="strokeStyle",r$S[8192]="_mergeID",r$S[1024]=r$S[2048]=r$S[4096]=[],r$S[16384]="textBaseline",r$S[32768]="textAlign",r$S[65536]="_nBlendType",r$S[1048576]="shader",r$S[2097152]="filters",r$S},r$U.save=function(r$S,r$Q,r$e,r$l){if((r$S._saveMark._saveuse&r$Q)!==r$Q){r$S._saveMark._saveuse|=r$Q;var r$M=r$U._cache,r$d=0<r$M._length?r$M[--r$M._length]:new r$U;r$d._value=r$e[r$d._valueName=r$U._namemap[r$Q]],r$d._dataObj=r$e,r$d._newSubmit=r$l;var r$T=r$S._save;r$T[r$T._length++]=r$d}},r$U._cache=laya.webgl.canvas.save.SaveBase._createArray(),r$U._namemap=r$U._init(),r$U}(),r$Z=function(){function r$d(){this._clipRect=new r$E}r$p(r$d,"laya.webgl.canvas.save.SaveClipRect");var r$S=r$d.prototype;return r$B.imps(r$S,{"laya.webgl.canvas.save.ISaveData":!0}),r$S.isSaveMark=function(){return!1},r$S.restore=function(r$S){r$S._clipRect=this._clipSaveRect,(r$d._cache[r$d._cache._length++]=this)._submitScissor.submitLength=r$S._submits._length-this._submitScissor.submitIndex,r$S._curSubmit=r$dS.RENDERBASE,r$S._renderKey=0},r$d.save=function(r$S,r$Q){if(131072!=(131072&r$S._saveMark._saveuse)){r$S._saveMark._saveuse|=131072;var r$e=r$d._cache,r$l=0<r$e._length?r$e[--r$e._length]:new r$d;r$l._clipSaveRect=r$S._clipRect,r$S._clipRect=r$l._clipRect.copyFrom(r$S._clipRect),r$l._submitScissor=r$Q;var r$M=r$S._save;r$M[r$M._length++]=r$l}},r$T(r$d,["_cache",function(){return this._cache=r$q._createArray()}]),r$d}(),r$N=function(){function r$J(){this._contextX=0,this._contextY=0,this._clipRect=new r$E,this._rect=new r$E,this._matrix=new r$g}r$p(r$J,"laya.webgl.canvas.save.SaveClipRectStencil");var r$S=r$J.prototype;return r$B.imps(r$S,{"laya.webgl.canvas.save.ISaveData":!0}),r$S.isSaveMark=function(){return!1},r$S.restore=function(r$S){r$oS.restore(r$S,this._rect,this._saveMatrix,this._contextX,this._contextY),r$S._clipRect=this._clipSaveRect,r$S._curMat=this._saveMatrix,r$S._x=this._contextX,r$S._y=this._contextY,r$J._cache[r$J._cache._length++]=this,r$S._curSubmit=r$dS.RENDERBASE},r$J.save=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){if(262144!=(262144&r$S._saveMark._saveuse)){r$S._saveMark._saveuse|=262144;var r$o=r$J._cache,r$Y=0<r$o._length?r$o[--r$o._length]:new r$J;r$Y._clipSaveRect=r$S._clipRect,r$Y._clipRect.setTo(r$T,r$U,r$i,r$R),r$S._clipRect=r$Y._clipRect,r$Y._rect.x=r$e,r$Y._rect.y=r$l,r$Y._rect.width=r$M,r$Y._rect.height=r$d,r$Y._contextX=r$S._x,r$Y._contextY=r$S._y,r$Y._saveMatrix=r$S._curMat,r$S._curMat.copyTo(r$Y._matrix),r$S._curMat=r$Y._matrix,r$Y._submitStencil=r$Q;var r$p=r$S._save;r$p[r$p._length++]=r$Y}},r$T(r$J,["_cache",function(){return this._cache=r$q._createArray()}]),r$J}(),r$C=function(){function r$l(){this._saveuse=0}r$p(r$l,"laya.webgl.canvas.save.SaveMark");var r$S=r$l.prototype;return r$B.imps(r$S,{"laya.webgl.canvas.save.ISaveData":!0}),r$S.isSaveMark=function(){return!0},r$S.restore=function(r$S){r$S._saveMark=this._preSaveMark,r$l._no[r$l._no._length++]=this},r$l.Create=function(r$S){var r$Q=r$l._no,r$e=0<r$Q._length?r$Q[--r$Q._length]:new r$l;return r$e._saveuse=0,r$e._preSaveMark=r$S._saveMark,r$S._saveMark=r$e},r$T(r$l,["_no",function(){return this._no=r$q._createArray()}]),r$l}(),r$K=function(){function r$d(){this._matrix=new r$g}r$p(r$d,"laya.webgl.canvas.save.SaveTransform");var r$S=r$d.prototype;return r$B.imps(r$S,{"laya.webgl.canvas.save.ISaveData":!0}),r$S.isSaveMark=function(){return!1},r$S.restore=function(r$S){r$S._curMat=this._savematrix,r$d._no[r$d._no._length++]=this},r$d.save=function(r$S){var r$Q=r$S._saveMark;if(2048!=(2048&r$Q._saveuse)){r$Q._saveuse|=2048;var r$e=r$d._no,r$l=0<r$e._length?r$e[--r$e._length]:new r$d;r$l._savematrix=r$S._curMat,r$S._curMat=r$S._curMat.copyTo(r$l._matrix);var r$M=r$S._save;r$M[r$M._length++]=r$l}},r$T(r$d,["_no",function(){return this._no=r$q._createArray()}]),r$d}(),r$V=function(){function r$M(){}r$p(r$M,"laya.webgl.canvas.save.SaveTranslate");var r$S=r$M.prototype;return r$B.imps(r$S,{"laya.webgl.canvas.save.ISaveData":!0}),r$S.isSaveMark=function(){return!1},r$S.restore=function(r$S){r$S._curMat;r$S._x=this._x,r$S._y=this._y,r$M._no[r$M._no._length++]=this},r$M.save=function(r$S){var r$Q=r$M._no,r$e=0<r$Q._length?r$Q[--r$Q._length]:new r$M;r$e._x=r$S._x,r$e._y=r$S._y;var r$l=r$S._save;r$l[r$l._length++]=r$e},r$T(r$M,["_no",function(){return this._no=r$q._createArray()}]),r$M}(),r$_=function(){function r$S(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new r$E}r$p(r$S,"laya.webgl.resource.RenderTargetMAX");var r$Q=r$S.prototype;return r$Q.setSP=function(r$S){this._sp=r$S},r$Q.size=function(r$S,r$Q){var r$e=this;this._width!==r$S||this._height!==r$Q?(this.repaint=!0,this._width=r$S,this._height=r$Q,this.target?this.target.size(r$S,r$Q):this.target=r$PS.create(r$S,r$Q),this.target.hasListener("recovered")||this.target.on("recovered",this,function(r$S){r$B.timer.callLater(r$e._sp,r$e._sp.repaint)})):this.target.size(r$S,r$Q)},r$Q._flushToTarget=function(r$S,r$Q){if(!r$Q._destroy){var r$e=r$zS.worldScissorTest,r$l=r$zS.worldClipRect;r$zS.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,r$zS.worldScissorTest=!1,r$vS.mainContext.disable(3089);var r$M=r$zS.worldAlpha,r$d=r$zS.worldMatrix4,r$T=r$zS.worldMatrix,r$U=r$zS.worldFilters,r$i=r$zS.worldShaderDefines;if(r$zS.worldMatrix=r$g.EMPTY,r$zS.restoreTempArray(),r$zS.worldMatrix4=r$zS.TEMPMAT4_ARRAY,r$zS.worldAlpha=1,r$zS.worldFilters=null,r$zS.worldShaderDefines=null,r$nS.activeShader=null,r$Q.start(),r$O.showCanvasMark?r$Q.clear(0,1,0,.3):r$Q.clear(0,0,0,0),r$S.flush(),r$Q.end(),r$nS.activeShader=null,r$zS.worldAlpha=r$M,r$zS.worldMatrix4=r$d,r$zS.worldMatrix=r$T,r$zS.worldFilters=r$U,r$zS.worldShaderDefines=r$i,r$zS.worldScissorTest=r$e){var r$R=r$zS.height-r$l.y-r$l.height;r$vS.mainContext.scissor(r$l.x,r$R,r$l.width,r$l.height),r$vS.mainContext.enable(3089)}r$zS.worldClipRect=r$l}},r$Q.flush=function(r$S){this.repaint&&(this._flushToTarget(r$S,this.target),this.repaint=!1)},r$Q.drawTo=function(r$S,r$Q,r$e,r$l,r$M){r$S.drawTexture(this.target.getTexture(),r$Q,r$e,r$l,r$M,0,0)},r$Q.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},r$S}(),r$s=function(){function r$S(){this.ALPHA=1,this.shaderType=0,this.defines=new r$tS}return r$p(r$S,"laya.webgl.shader.d2.Shader2D"),r$S.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},r$S.__init__=function(){var r$S,r$Q;r$CS.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),r$CS.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),r$CS.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),r$CS.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),r$CS.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),r$CS.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),r$CS.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),r$CS.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),r$S="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",r$Q='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',r$CS.preCompile2D(0,1,r$S,r$Q,null),r$S="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",r$Q='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',r$CS.preCompile2D(0,2,r$S,r$Q,null),r$S="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",r$Q="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",r$CS.preCompile2D(0,4,r$S,r$Q,null),r$S="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",r$Q='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',r$CS.preCompile2D(0,256,r$S,r$Q,null),r$S="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",r$Q="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",r$CS.preCompile2D(0,512,r$S,r$Q,null)},r$S}(),r$y=function(){function r$Q(r$S,r$Q,r$e){this._value=0,this._name2int=r$S,this._int2name=r$Q,this._int2nameMap=r$e}r$p(r$Q,"laya.webgl.shader.ShaderDefines");var r$S=r$Q.prototype;return r$S.add=function(r$S){return"string"==typeof r$S&&(r$S=this._name2int[r$S]),this._value|=r$S,this._value},r$S.addInt=function(r$S){return this._value|=r$S,this._value},r$S.remove=function(r$S){return"string"==typeof r$S&&(r$S=this._name2int[r$S]),this._value&=~r$S,this._value},r$S.isDefine=function(r$S){return(this._value&r$S)===r$S},r$S.getValue=function(){return this._value},r$S.setValue=function(r$S){this._value=r$S},r$S.toNameDic=function(){var r$S=this._int2nameMap[this._value];return r$S||r$Q._toText(this._value,this._int2name,this._int2nameMap)},r$Q._reg=function(r$S,r$Q,r$e,r$l){r$l[r$e[r$S]=r$Q]=r$S},r$Q._toText=function(r$S,r$Q,r$e){var r$l=r$e[r$S];if(r$l)return r$l;for(var r$M={},r$d=1,r$T=0;r$T<32&&!(r$S<(r$d=1<<r$T));r$T++)if(r$S&r$d){var r$U=r$Q[r$d];r$U&&(r$M[r$U]="")}return r$e[r$S]=r$M},r$Q._toInt=function(r$S,r$Q){for(var r$e=r$S.split("."),r$l=0,r$M=0,r$d=r$e.length;r$M<r$d;r$M++){var r$T=r$Q[r$e[r$M]];if(!r$T)throw new Error("Defines to int err:"+r$S+"/"+r$e[r$M]);r$l|=r$T}return r$l},r$Q}(),r$SS=function(){function r$T(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new r$g}r$p(r$T,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var r$S=r$T.prototype;return r$S.init=function(r$S,r$Q,r$e){if(r$Q)this._vs=r$Q;else{this._vs=[];var r$l=r$S.width,r$M=r$S.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(r$l,0,1,0,1,1,1,1),this._vs.push(r$l,r$M,1,1,1,1,1,1),this._vs.push(0,r$M,0,1,1,1,1,1)}r$e?this._ps=r$e:(r$T._defaultPS||(r$T._defaultPS=[]).push(0,1,3,3,1,2),this._ps=r$T._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=r$S},r$S.init2=function(r$S,r$Q,r$e,r$l,r$M){this.transform&&(this.transform=null),r$e?this._ps=r$e:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=r$l,this._uvs=r$M,this.mEleNum=this._ps.length,this.mTexture=r$S,(r$G.isConchNode||r$G.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},r$S._initMyData=function(){var r$S=0,r$Q=0,r$e=4*this._verticles.length;this._vs=r$T._tempVS;var r$l=!1;if(r$G.isConchNode||r$G.isConchApp?(this._vs.length=r$e,r$l=!0):this._vs.length<r$e&&(this._vs.length=r$e,r$l=!0),r$T._tVSLen=r$e,r$l)for(;r$S<r$e;)this._vs[r$S]=this._verticles[r$Q],this._vs[r$S+1]=this._verticles[r$Q+1],this._vs[r$S+2]=this._uvs[r$Q],this._vs[r$S+3]=this._uvs[r$Q+1],this._vs[r$S+4]=1,this._vs[r$S+5]=1,this._vs[r$S+6]=1,this._vs[r$S+7]=1,r$S+=8,r$Q+=2;else for(;r$S<r$e;)this._vs[r$S]=this._verticles[r$Q],this._vs[r$S+1]=this._verticles[r$Q+1],this._vs[r$S+2]=this._uvs[r$Q],this._vs[r$S+3]=this._uvs[r$Q+1],r$S+=8,r$Q+=2},r$S.getData2=function(r$S,r$Q,r$e){var r$l;this.mVBBuffer=r$S,this.mIBBuffer=r$Q,this._initMyData(),r$S.appendEx2(this._vs,Float32Array,r$T._tVSLen,4),this._indexStart=r$Q._byteLength,(r$l=r$T._tempIB).length<this._ps.length&&(r$l.length=this._ps.length);for(var r$M=0,r$d=this._ps.length;r$M<r$d;r$M++)r$l[r$M]=this._ps[r$M]+r$e;r$Q.appendEx2(r$l,Uint16Array,this._ps.length,2)},r$S.getData=function(r$S,r$Q,r$e){if(this.mVBBuffer=r$S,this.mIBBuffer=r$Q,r$S.append(this.mVBData),this._indexStart=r$Q._byteLength,this.mIBData.start!=r$e){for(var r$l=0,r$M=this._ps.length;r$l<r$M;r$l++)this.mIBData[r$l]=this._ps[r$l]+r$e;this.mIBData.start=r$e}r$Q.append(this.mIBData)},r$S.render=function(r$S,r$Q,r$e){if(r$G.isWebGL&&this.mTexture){r$S._renderKey=0,r$S._shader2D.glTexture=null,r$QS.getInstance().addSkinMesh(this);var r$l=r$dS.createShape(r$S,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,r$HS.create(512,0));this.transform||(this.transform=r$g.EMPTY),this.transform.translate(r$Q,r$e),r$g.mul(this.transform,r$S._curMat,this._tempMatrix),this.transform.translate(-r$Q,-r$e);var r$M=r$l.shaderValue,r$d=r$M.u_mmat2||r$zS.getMatrArray();r$zS.mat2MatArray(this._tempMatrix,r$d),r$M.textureHost=this.mTexture,r$M.offsetX=0,r$M.offsetY=0,r$M.u_mmat2=r$d,r$M.ALPHA=r$S._shader2D.ALPHA,r$S._submits[r$S._submits._length++]=r$l}else r$G.isConchApp&&this.mTexture&&(this.transform||(this.transform=r$g.EMPTY),r$S.setSkinMesh&&r$S.setSkinMesh(r$Q,r$e,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},r$T._tempVS=[],r$T._tempIB=[],r$T._defaultPS=null,r$T._tVSLen=0,r$T}(),r$QS=function(){function r$S(){this.ib=null,this.vb=null;r$vS.mainContext;this.ib=r$sS.create(35048),this.vb=r$yS.create(8)}r$p(r$S,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var r$Q=r$S.prototype;return r$Q.addSkinMesh=function(r$S){r$S.getData2(this.vb,this.ib,this.vb._byteLength/32)},r$Q.reset=function(){this.vb.clear(),this.ib.clear()},r$S.getInstance=function(){return r$S.instance=r$S.instance||new r$S},r$S.instance=null,r$S}(),r$eS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===r$i&&(r$i=0),this.x=r$S,this.y=r$Q,this.width=r$e,this.height=r$l,this.edges=r$M,this.color=r$d,this.borderWidth=r$T,this.borderColor=r$U}r$p(r$S,"laya.webgl.shapes.BasePoly");var r$Q=r$S.prototype;return r$B.imps(r$Q,{"laya.webgl.shapes.IShape":!0}),r$Q.getData=function(r$S,r$Q,r$e){},r$Q.rebuild=function(r$S){},r$Q.setMatrix=function(r$S){},r$Q.needUpdate=function(r$S){return!0},r$Q.sector=function(r$S,r$Q,r$e){var r$l=this.x,r$M=this.y,r$d=this.edges,r$T=(this.r1-this.r0)/r$d,r$U=this.width,r$i=this.height,r$R=this.color,r$o=(r$R>>16&255)/255,r$Y=(r$R>>8&255)/255,r$p=(255&r$R)/255;r$S.push(r$l,r$M,r$o,r$Y,r$p);for(var r$J=0;r$J<r$d+1;r$J++)r$S.push(r$l+Math.sin(r$T*r$J+this.r0)*r$U,r$M+Math.cos(r$T*r$J+this.r0)*r$i),r$S.push(r$o,r$Y,r$p);for(r$J=0;r$J<r$d;r$J++)r$Q.push(r$e,r$e+r$J+1,r$e+r$J+2)},r$Q.createLine2=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T,r$U,r$i,r$R,r$o,r$Y,r$p,r$J,r$L,r$j,r$c,r$G,r$z,r$A,r$v,r$D,r$B,r$O,r$H,r$g,r$I=r$S.concat(),r$E=r$M,r$t=this.borderColor,r$k=(r$t>>16&255)/255,r$X=(r$t>>8&255)/255,r$h=(255&r$t)/255,r$b=r$I.length/2,r$m=r$l,r$$=r$e/2;r$i=r$I[0],r$R=r$I[1],r$j=r$i-(r$o=r$I[2]),r$L=(r$L=-(r$R-(r$Y=r$I[3])))/(r$g=Math.sqrt(r$L*r$L+r$j*r$j))*r$$,r$j=r$j/r$g*r$$,r$E.push(r$i-r$L+this.x,r$R-r$j+this.y,r$k,r$X,r$h,r$i+r$L+this.x,r$R+r$j+this.y,r$k,r$X,r$h);for(var r$n=1;r$n<r$b-1;r$n++)r$i=r$I[2*(r$n-1)],r$R=r$I[2*(r$n-1)+1],r$o=r$I[2*r$n],r$Y=r$I[2*r$n+1],r$p=r$I[2*(r$n+1)],r$J=r$I[2*(r$n+1)+1],r$j=r$i-r$o,r$G=r$o-r$p,r$v=(-(r$L=(r$L=-(r$R-r$Y))/(r$g=Math.sqrt(r$L*r$L+r$j*r$j))*r$$)+r$i)*(-(r$j=r$j/r$g*r$$)+r$Y)-(-r$L+r$o)*(-r$j+r$R),r$O=(-(r$c=(r$c=-(r$Y-r$J))/(r$g=Math.sqrt(r$c*r$c+r$G*r$G))*r$$)+r$p)*(-(r$G=r$G/r$g*r$$)+r$Y)-(-r$c+r$o)*(-r$G+r$J),r$H=(r$z=-r$j+r$R-(-r$j+r$Y))*(r$B=-r$c+r$o-(-r$c+r$p))-(r$D=-r$G+r$J-(-r$G+r$Y))*(r$A=-r$L+r$o-(-r$L+r$i)),Math.abs(r$H)<.1?(r$H+=10.1,r$E.push(r$o-r$L+this.x,r$Y-r$j+this.y,r$k,r$X,r$h,r$o+r$L+this.x,r$Y+r$j+this.y,r$k,r$X,r$h)):(((r$T=(r$A*r$O-r$B*r$v)/r$H)-r$o)*(r$T-r$o)+((r$U=(r$D*r$v-r$z*r$O)/r$H)-r$Y)+(r$U-r$Y),r$E.push(r$T+this.x,r$U+this.y,r$k,r$X,r$h,r$o-(r$T-r$o)+this.x,r$Y-(r$U-r$Y)+this.y,r$k,r$X,r$h));r$i=r$I[r$I.length-4],r$R=r$I[r$I.length-3],r$j=r$i-(r$o=r$I[r$I.length-2]),r$L=(r$L=-(r$R-(r$Y=r$I[r$I.length-1])))/(r$g=Math.sqrt(r$L*r$L+r$j*r$j))*r$$,r$j=r$j/r$g*r$$,r$E.push(r$o-r$L+this.x,r$Y-r$j+this.y,r$k,r$X,r$h,r$o+r$L+this.x,r$Y+r$j+this.y,r$k,r$X,r$h);var r$P=r$d;for(r$n=1;r$n<r$P;r$n++)r$Q.push(r$m+2*(r$n-1),r$m+2*(r$n-1)+1,r$m+2*r$n+1,r$m+2*r$n+1,r$m+2*r$n,r$m+2*(r$n-1));return r$E},r$Q.createLine=function(r$S,r$Q,r$e,r$l){var r$M=r$S.concat(),r$d=r$S,r$T=this.borderColor,r$U=(r$T>>16&255)/255,r$i=(r$T>>8&255)/255,r$R=(255&r$T)/255;r$M.splice(0,5);var r$o,r$Y,r$p,r$J,r$L,r$j,r$c,r$G,r$z,r$A,r$v,r$D,r$B,r$O,r$H,r$g,r$I,r$E,r$t,r$k,r$X=r$M.length/5,r$h=r$l,r$b=r$e/2;r$p=r$M[0],r$J=r$M[1],r$A=r$p-(r$L=r$M[5]),r$z=(r$z=-(r$J-(r$j=r$M[6])))/(r$k=Math.sqrt(r$z*r$z+r$A*r$A))*r$b,r$A=r$A/r$k*r$b,r$d.push(r$p-r$z,r$J-r$A,r$U,r$i,r$R,r$p+r$z,r$J+r$A,r$U,r$i,r$R);for(var r$m=1;r$m<r$X-1;r$m++)r$p=r$M[5*(r$m-1)],r$J=r$M[5*(r$m-1)+1],r$L=r$M[5*r$m],r$j=r$M[5*r$m+1],r$c=r$M[5*(r$m+1)],r$G=r$M[5*(r$m+1)+1],r$A=r$p-r$L,r$D=r$L-r$c,r$H=(-(r$z=(r$z=-(r$J-r$j))/(r$k=Math.sqrt(r$z*r$z+r$A*r$A))*r$b)+r$p)*(-(r$A=r$A/r$k*r$b)+r$j)-(-r$z+r$L)*(-r$A+r$J),r$E=(-(r$v=(r$v=-(r$j-r$G))/(r$k=Math.sqrt(r$v*r$v+r$D*r$D))*r$b)+r$c)*(-(r$D=r$D/r$k*r$b)+r$j)-(-r$v+r$L)*(-r$D+r$G),r$t=(r$B=-r$A+r$J-(-r$A+r$j))*(r$I=-r$v+r$L-(-r$v+r$c))-(r$g=-r$D+r$G-(-r$D+r$j))*(r$O=-r$z+r$L-(-r$z+r$p)),Math.abs(r$t)<.1?(r$t+=10.1,r$d.push(r$L-r$z,r$j-r$A,r$U,r$i,r$R,r$L+r$z,r$j+r$A,r$U,r$i,r$R)):(((r$o=(r$O*r$E-r$I*r$H)/r$t)-r$L)*(r$o-r$L)+((r$Y=(r$g*r$H-r$B*r$E)/r$t)-r$j)+(r$Y-r$j),r$d.push(r$o,r$Y,r$U,r$i,r$R,r$L-(r$o-r$L),r$j-(r$Y-r$j),r$U,r$i,r$R));r$p=r$M[r$M.length-10],r$J=r$M[r$M.length-9],r$A=r$p-(r$L=r$M[r$M.length-5]),r$z=(r$z=-(r$J-(r$j=r$M[r$M.length-4])))/(r$k=Math.sqrt(r$z*r$z+r$A*r$A))*r$b,r$A=r$A/r$k*r$b,r$d.push(r$L-r$z,r$j-r$A,r$U,r$i,r$R,r$L+r$z,r$j+r$A,r$U,r$i,r$R);var r$$=this.edges+1;for(r$m=1;r$m<r$$;r$m++)r$Q.push(r$h+2*(r$m-1),r$h+2*(r$m-1)+1,r$h+2*r$m+1,r$h+2*r$m+1,r$h+2*r$m,r$h+2*(r$m-1));return r$d},r$Q.createLoopLine=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=r$S.concat(),r$U=r$M||r$S,r$i=this.borderColor,r$R=(r$i>>16&255)/255,r$o=(r$i>>8&255)/255,r$Y=(255&r$i)/255;r$T.splice(0,5);var r$p=[r$T[0],r$T[1]],r$J=[r$T[r$T.length-5],r$T[r$T.length-4]],r$L=r$J[0]+.5*(r$p[0]-r$J[0]),r$j=r$J[1]+.5*(r$p[1]-r$J[1]);r$T.unshift(r$L,r$j,0,0,0),r$T.push(r$L,r$j,0,0,0);var r$c,r$G,r$z,r$A,r$v,r$D,r$B,r$O,r$H,r$g,r$I,r$E,r$t,r$k,r$X,r$h,r$b,r$m,r$$,r$n,r$P=r$T.length/5,r$a=r$l,r$f=r$e/2;r$z=r$T[0],r$A=r$T[1],r$g=r$z-(r$v=r$T[5]),r$H=(r$H=-(r$A-(r$D=r$T[6])))/(r$n=Math.sqrt(r$H*r$H+r$g*r$g))*r$f,r$g=r$g/r$n*r$f,r$U.push(r$z-r$H,r$A-r$g,r$R,r$o,r$Y,r$z+r$H,r$A+r$g,r$R,r$o,r$Y);for(var r$w=1;r$w<r$P-1;r$w++)r$z=r$T[5*(r$w-1)],r$A=r$T[5*(r$w-1)+1],r$v=r$T[5*r$w],r$D=r$T[5*r$w+1],r$B=r$T[5*(r$w+1)],r$O=r$T[5*(r$w+1)+1],r$g=r$z-r$v,r$E=r$v-r$B,r$X=(-(r$H=(r$H=-(r$A-r$D))/(r$n=Math.sqrt(r$H*r$H+r$g*r$g))*r$f)+r$z)*(-(r$g=r$g/r$n*r$f)+r$D)-(-r$H+r$v)*(-r$g+r$A),r$m=(-(r$I=(r$I=-(r$D-r$O))/(r$n=Math.sqrt(r$I*r$I+r$E*r$E))*r$f)+r$B)*(-(r$E=r$E/r$n*r$f)+r$D)-(-r$I+r$v)*(-r$E+r$O),r$$=(r$t=-r$g+r$A-(-r$g+r$D))*(r$b=-r$I+r$v-(-r$I+r$B))-(r$h=-r$E+r$O-(-r$E+r$D))*(r$k=-r$H+r$v-(-r$H+r$z)),Math.abs(r$$)<.1?(r$$+=10.1,r$U.push(r$v-r$H,r$D-r$g,r$R,r$o,r$Y,r$v+r$H,r$D+r$g,r$R,r$o,r$Y)):(((r$c=(r$k*r$m-r$b*r$X)/r$$)-r$v)*(r$c-r$v)+((r$G=(r$h*r$X-r$t*r$m)/r$$)-r$D)+(r$G-r$D),r$U.push(r$c,r$G,r$R,r$o,r$Y,r$v-(r$c-r$v),r$D-(r$G-r$D),r$R,r$o,r$Y));r$d&&(r$Q=r$d);var r$u=this.edges+1;for(r$w=1;r$w<r$u;r$w++)r$Q.push(r$a+2*(r$w-1),r$a+2*(r$w-1)+1,r$a+2*r$w+1,r$a+2*r$w+1,r$a+2*r$w,r$a+2*(r$w-1));return r$Q.push(r$a+2*(r$w-1),r$a+2*(r$w-1)+1,r$a+1,r$a+1,r$a,r$a+2*(r$w-1)),r$U},r$S}(),r$lS=function(){function r$j(){}return r$p(r$j,"laya.webgl.shapes.Earcut"),r$j.earcut=function(r$S,r$Q,r$e){r$e=r$e||2;var r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o=r$Q&&r$Q.length,r$Y=r$o?r$Q[0]*r$e:r$S.length,r$p=r$j.linkedList(r$S,0,r$Y,r$e,!0),r$J=[];if(!r$p)return r$J;if(r$o&&(r$p=r$j.eliminateHoles(r$S,r$Q,r$p,r$e)),r$S.length>80*r$e){r$l=r$d=r$S[0],r$M=r$T=r$S[1];for(var r$L=r$e;r$L<r$Y;r$L+=r$e)(r$U=r$S[r$L])<r$l&&(r$l=r$U),(r$i=r$S[r$L+1])<r$M&&(r$M=r$i),r$d<r$U&&(r$d=r$U),r$T<r$i&&(r$T=r$i);r$R=0!==(r$R=Math.max(r$d-r$l,r$T-r$M))?1/r$R:0}return r$j.earcutLinked(r$p,r$J,r$e,r$l,r$M,r$R),r$J},r$j.linkedList=function(r$S,r$Q,r$e,r$l,r$M){var r$d,r$T;if(r$M===0<r$j.signedArea(r$S,r$Q,r$e,r$l))for(r$d=r$Q;r$d<r$e;r$d+=r$l)r$T=r$j.insertNode(r$d,r$S[r$d],r$S[r$d+1],r$T);else for(r$d=r$e-r$l;r$Q<=r$d;r$d-=r$l)r$T=r$j.insertNode(r$d,r$S[r$d],r$S[r$d+1],r$T);return r$T&&r$j.equals(r$T,r$T.next)&&(r$j.removeNode(r$T),r$T=r$T.next),r$T},r$j.filterPoints=function(r$S,r$Q){if(!r$S)return r$S;r$Q||(r$Q=r$S);var r$e,r$l=r$S;do{if(r$e=!1,r$l.steiner||!r$j.equals(r$l,r$l.next)&&0!==r$j.area(r$l.prev,r$l,r$l.next))r$l=r$l.next;else{if(r$j.removeNode(r$l),(r$l=r$Q=r$l.prev)===r$l.next)break;r$e=!0}}while(r$e||r$l!==r$Q);return r$Q},r$j.earcutLinked=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){if(r$S){!r$T&&r$d&&r$j.indexCurve(r$S,r$l,r$M,r$d);for(var r$U,r$i,r$R=r$S;r$S.prev!==r$S.next;)if(r$U=r$S.prev,r$i=r$S.next,r$d?r$j.isEarHashed(r$S,r$l,r$M,r$d):r$j.isEar(r$S))r$Q.push(r$U.i/r$e),r$Q.push(r$S.i/r$e),r$Q.push(r$i.i/r$e),r$j.removeNode(r$S),r$S=r$i.next,r$R=r$i.next;else if((r$S=r$i)===r$R){r$T?1===r$T?(r$S=r$j.cureLocalIntersections(r$S,r$Q,r$e),r$j.earcutLinked(r$S,r$Q,r$e,r$l,r$M,r$d,2)):2===r$T&&r$j.splitEarcut(r$S,r$Q,r$e,r$l,r$M,r$d):r$j.earcutLinked(r$j.filterPoints(r$S,null),r$Q,r$e,r$l,r$M,r$d,1);break}}},r$j.isEar=function(r$S){var r$Q=r$S.prev,r$e=r$S,r$l=r$S.next;if(0<=r$j.area(r$Q,r$e,r$l))return!1;for(var r$M=r$S.next.next;r$M!==r$S.prev;){if(r$j.pointInTriangle(r$Q.x,r$Q.y,r$e.x,r$e.y,r$l.x,r$l.y,r$M.x,r$M.y)&&0<=r$j.area(r$M.prev,r$M,r$M.next))return!1;r$M=r$M.next}return!0},r$j.isEarHashed=function(r$S,r$Q,r$e,r$l){var r$M=r$S.prev,r$d=r$S,r$T=r$S.next;if(0<=r$j.area(r$M,r$d,r$T))return!1;for(var r$U=r$M.x<r$d.x?r$M.x<r$T.x?r$M.x:r$T.x:r$d.x<r$T.x?r$d.x:r$T.x,r$i=r$M.y<r$d.y?r$M.y<r$T.y?r$M.y:r$T.y:r$d.y<r$T.y?r$d.y:r$T.y,r$R=r$M.x>r$d.x?r$M.x>r$T.x?r$M.x:r$T.x:r$d.x>r$T.x?r$d.x:r$T.x,r$o=r$M.y>r$d.y?r$M.y>r$T.y?r$M.y:r$T.y:r$d.y>r$T.y?r$d.y:r$T.y,r$Y=r$j.zOrder(r$U,r$i,r$Q,r$e,r$l),r$p=r$j.zOrder(r$R,r$o,r$Q,r$e,r$l),r$J=r$S.nextZ;r$J&&r$J.z<=r$p;){if(r$J!==r$S.prev&&r$J!==r$S.next&&r$j.pointInTriangle(r$M.x,r$M.y,r$d.x,r$d.y,r$T.x,r$T.y,r$J.x,r$J.y)&&0<=r$j.area(r$J.prev,r$J,r$J.next))return!1;r$J=r$J.nextZ}for(r$J=r$S.prevZ;r$J&&r$J.z>=r$Y;){if(r$J!==r$S.prev&&r$J!==r$S.next&&r$j.pointInTriangle(r$M.x,r$M.y,r$d.x,r$d.y,r$T.x,r$T.y,r$J.x,r$J.y)&&0<=r$j.area(r$J.prev,r$J,r$J.next))return!1;r$J=r$J.prevZ}return!0},r$j.cureLocalIntersections=function(r$S,r$Q,r$e){var r$l=r$S;do{var r$M=r$l.prev,r$d=r$l.next.next;!r$j.equals(r$M,r$d)&&r$j.intersects(r$M,r$l,r$l.next,r$d)&&r$j.locallyInside(r$M,r$d)&&r$j.locallyInside(r$d,r$M)&&(r$Q.push(r$M.i/r$e),r$Q.push(r$l.i/r$e),r$Q.push(r$d.i/r$e),r$j.removeNode(r$l),r$j.removeNode(r$l.next),r$l=r$S=r$d),r$l=r$l.next}while(r$l!==r$S);return r$l},r$j.splitEarcut=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=r$S;do{for(var r$U=r$T.next.next;r$U!==r$T.prev;){if(r$T.i!==r$U.i&&r$j.isValidDiagonal(r$T,r$U)){var r$i=r$j.splitPolygon(r$T,r$U);return r$T=r$j.filterPoints(r$T,r$T.next),r$i=r$j.filterPoints(r$i,r$i.next),r$j.earcutLinked(r$T,r$Q,r$e,r$l,r$M,r$d),void r$j.earcutLinked(r$i,r$Q,r$e,r$l,r$M,r$d)}r$U=r$U.next}r$T=r$T.next}while(r$T!==r$S)},r$j.eliminateHoles=function(r$S,r$Q,r$e,r$l){var r$M,r$d,r$T,r$U,r$i,r$R=[];for(r$M=0,r$d=r$Q.length;r$M<r$d;r$M++)r$T=r$Q[r$M]*r$l,r$U=r$M<r$d-1?r$Q[r$M+1]*r$l:r$S.length,(r$i=r$j.linkedList(r$S,r$T,r$U,r$l,!1))===r$i.next&&(r$i.steiner=!0),r$R.push(r$j.getLeftmost(r$i));for(r$R.sort(r$j.compareX),r$M=0;r$M<r$R.length;r$M++)r$j.eliminateHole(r$R[r$M],r$e),r$e=r$j.filterPoints(r$e,r$e.next);return r$e},r$j.compareX=function(r$S,r$Q){return r$S.x-r$Q.x},r$j.eliminateHole=function(r$S,r$Q){if(r$Q=r$j.findHoleBridge(r$S,r$Q)){var r$e=r$j.splitPolygon(r$Q,r$S);r$j.filterPoints(r$e,r$e.next)}},r$j.findHoleBridge=function(r$S,r$Q){var r$e,r$l=r$Q,r$M=r$S.x,r$d=r$S.y,r$T=-1/0;do{if(r$d<=r$l.y&&r$d>=r$l.next.y&&r$l.next.y!==r$l.y){var r$U=r$l.x+(r$d-r$l.y)*(r$l.next.x-r$l.x)/(r$l.next.y-r$l.y);if(r$U<=r$M&&r$T<r$U){if((r$T=r$U)===r$M){if(r$d===r$l.y)return r$l;if(r$d===r$l.next.y)return r$l.next}r$e=r$l.x<r$l.next.x?r$l:r$l.next}}r$l=r$l.next}while(r$l!==r$Q);if(!r$e)return null;if(r$M===r$T)return r$e.prev;var r$i,r$R=r$e,r$o=r$e.x,r$Y=r$e.y,r$p=1/0;for(r$l=r$e.next;r$l!==r$R;)r$M>=r$l.x&&r$l.x>=r$o&&r$M!==r$l.x&&r$j.pointInTriangle(r$d<r$Y?r$M:r$T,r$d,r$o,r$Y,r$d<r$Y?r$T:r$M,r$d,r$l.x,r$l.y)&&((r$i=Math.abs(r$d-r$l.y)/(r$M-r$l.x))<r$p||r$i===r$p&&r$l.x>r$e.x)&&r$j.locallyInside(r$l,r$S)&&(r$e=r$l,r$p=r$i),r$l=r$l.next;return r$e},r$j.indexCurve=function(r$S,r$Q,r$e,r$l){for(var r$M=r$S;null===r$M.z&&(r$M.z=r$j.zOrder(r$M.x,r$M.y,r$Q,r$e,r$l)),r$M.prevZ=r$M.prev,r$M.nextZ=r$M.next,(r$M=r$M.next)!==r$S;);r$M.prevZ.nextZ=null,r$M.prevZ=null,r$j.sortLinked(r$M)},r$j.sortLinked=function(r$S){var r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R=1;do{for(r$e=r$S,r$d=r$S=null,r$T=0;r$e;){for(r$T++,r$l=r$e,r$Q=r$U=0;r$Q<r$R&&(r$U++,r$l=r$l.nextZ);r$Q++);for(r$i=r$R;0<r$U||0<r$i&&r$l;)0!==r$U&&(0===r$i||!r$l||r$e.z<=r$l.z)?(r$e=(r$M=r$e).nextZ,r$U--):(r$l=(r$M=r$l).nextZ,r$i--),r$d?r$d.nextZ=r$M:r$S=r$M,r$M.prevZ=r$d,r$d=r$M;r$e=r$l}r$d.nextZ=null,r$R*=2}while(1<r$T);return r$S},r$j.zOrder=function(r$S,r$Q,r$e,r$l,r$M){return(r$S=1431655765&((r$S=858993459&((r$S=252645135&((r$S=16711935&((r$S=32767*(r$S-r$e)*r$M)|r$S<<8))|r$S<<4))|r$S<<2))|r$S<<1))|(r$Q=1431655765&((r$Q=858993459&((r$Q=252645135&((r$Q=16711935&((r$Q=32767*(r$Q-r$l)*r$M)|r$Q<<8))|r$Q<<4))|r$Q<<2))|r$Q<<1))<<1},r$j.getLeftmost=function(r$S){for(var r$Q=r$S,r$e=r$S;r$Q.x<r$e.x&&(r$e=r$Q),(r$Q=r$Q.next)!==r$S;);return r$e},r$j.pointInTriangle=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){return 0<=(r$M-r$T)*(r$Q-r$U)-(r$S-r$T)*(r$d-r$U)&&0<=(r$S-r$T)*(r$l-r$U)-(r$e-r$T)*(r$Q-r$U)&&0<=(r$e-r$T)*(r$d-r$U)-(r$M-r$T)*(r$l-r$U)},r$j.isValidDiagonal=function(r$S,r$Q){return r$S.next.i!==r$Q.i&&r$S.prev.i!==r$Q.i&&!r$j.intersectsPolygon(r$S,r$Q)&&r$j.locallyInside(r$S,r$Q)&&r$j.locallyInside(r$Q,r$S)&&r$j.middleInside(r$S,r$Q)},r$j.area=function(r$S,r$Q,r$e){return(r$Q.y-r$S.y)*(r$e.x-r$Q.x)-(r$Q.x-r$S.x)*(r$e.y-r$Q.y)},r$j.equals=function(r$S,r$Q){return r$S.x===r$Q.x&&r$S.y===r$Q.y},r$j.intersects=function(r$S,r$Q,r$e,r$l){return!!(r$j.equals(r$S,r$Q)&&r$j.equals(r$e,r$l)||r$j.equals(r$S,r$l)&&r$j.equals(r$e,r$Q))||0<r$j.area(r$S,r$Q,r$e)!=0<r$j.area(r$S,r$Q,r$l)&&0<r$j.area(r$e,r$l,r$S)!=0<r$j.area(r$e,r$l,r$Q)},r$j.intersectsPolygon=function(r$S,r$Q){var r$e=r$S;do{if(r$e.i!==r$S.i&&r$e.next.i!==r$S.i&&r$e.i!==r$Q.i&&r$e.next.i!==r$Q.i&&r$j.intersects(r$e,r$e.next,r$S,r$Q))return!0;r$e=r$e.next}while(r$e!==r$S);return!1},r$j.locallyInside=function(r$S,r$Q){return r$j.area(r$S.prev,r$S,r$S.next)<0?0<=r$j.area(r$S,r$Q,r$S.next)&&0<=r$j.area(r$S,r$S.prev,r$Q):r$j.area(r$S,r$Q,r$S.prev)<0||r$j.area(r$S,r$S.next,r$Q)<0},r$j.middleInside=function(r$S,r$Q){for(var r$e=r$S,r$l=!1,r$M=(r$S.x+r$Q.x)/2,r$d=(r$S.y+r$Q.y)/2;r$e.y>r$d!=r$e.next.y>r$d&&r$e.next.y!==r$e.y&&r$M<(r$e.next.x-r$e.x)*(r$d-r$e.y)/(r$e.next.y-r$e.y)+r$e.x&&(r$l=!r$l),(r$e=r$e.next)!==r$S;);return r$l},r$j.splitPolygon=function(r$S,r$Q){var r$e=new r$MS(r$S.i,r$S.x,r$S.y),r$l=new r$MS(r$Q.i,r$Q.x,r$Q.y),r$M=r$S.next,r$d=r$Q.prev;return(r$S.next=r$Q).prev=r$S,(r$e.next=r$M).prev=r$e,(r$l.next=r$e).prev=r$l,(r$d.next=r$l).prev=r$d,r$l},r$j.insertNode=function(r$S,r$Q,r$e,r$l){var r$M=new r$MS(r$S,r$Q,r$e);return r$l?(r$M.next=r$l.next,(r$M.prev=r$l).next.prev=r$M,r$l.next=r$M):(r$M.prev=r$M).next=r$M,r$M},r$j.removeNode=function(r$S){r$S.next.prev=r$S.prev,r$S.prev.next=r$S.next,r$S.prevZ&&(r$S.prevZ.nextZ=r$S.nextZ),r$S.nextZ&&(r$S.nextZ.prevZ=r$S.prevZ)},r$j.signedArea=function(r$S,r$Q,r$e,r$l){for(var r$M=0,r$d=r$Q,r$T=r$e-r$l;r$d<r$e;r$d+=r$l)r$M+=(r$S[r$T]-r$S[r$d])*(r$S[r$d+1]+r$S[r$T+1]),r$T=r$d;return r$M},r$j}(),r$MS=function(){function r$S(r$S,r$Q,r$e){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=r$S,this.x=r$Q,this.y=r$e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return r$p(r$S,"laya.webgl.shapes.EarcutNode"),r$S}(),r$dS=(function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this.lineWidth=r$S,this.lineColor=r$Q,this.lineAlpha=r$e,this.fillColor=r$l,this.fillAlpha=r$M,this.shape=r$T,this.fill=r$d}r$p(r$S,"laya.webgl.shapes.GeometryData");var r$Q=r$S.prototype;r$Q.clone=function(){return new r$S(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},r$Q.getIndexData=function(){return null},r$Q.getVertexData=function(){return null},r$Q.destroy=function(){this.shape=null}}(),function(){function r$S(r$S){if(r$S instanceof Float32Array)this.points=r$S;else if(r$S instanceof Array){r$S.length;this.points=new Float32Array(r$S)}}r$p(r$S,"laya.webgl.shapes.Vertex");var r$Q=r$S.prototype;r$B.imps(r$Q,{"laya.webgl.shapes.IShape":!0}),r$Q.getData=function(r$S,r$Q,r$e){},r$Q.needUpdate=function(r$S){return!1},r$Q.rebuild=function(r$S){},r$Q.setMatrix=function(r$S){}}(),function(){function r$i(r$S){void 0===r$S&&(r$S=1e4),this._renderType=r$S}r$p(r$i,"laya.webgl.submit.Submit");var r$S=r$i.prototype;return r$B.imps(r$S,{"laya.webgl.submit.ISubmit":!0}),r$S.releaseRender=function(){var r$S=r$i._cache;(r$S[r$S._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},r$S.getRenderType=function(){return this._renderType},r$S.renderSubmit=function(){if(0===this._numEle)return 1;var r$S=this.shaderValue.textureHost;if(r$S){var r$Q=r$S.source;if(!r$S.bitmap||!r$Q)return 1;this.shaderValue.texture=r$Q,r$S.alphaTexture&&r$S.alphaTexture.source&&(this.shaderValue.texture1=r$S.alphaTexture.source)}this._vb.bind_upload(this._ib);var r$e=r$vS.mainContext;return this.shaderValue.upload(),r$W.activeBlendFunction!==this._blendFn&&(r$e.enable(3042),this._blendFn(r$e),r$W.activeBlendFunction=this._blendFn),r$X.drawCall++,r$X.trianglesFaces+=this._numEle/3,r$e.drawElements(4,this._numEle,5123,this._startIdx),1},r$i.__init__=function(){var r$S=r$i.RENDERBASE=new r$i(-1);r$S.shaderValue=new r$HS(0,0),r$S.shaderValue.ALPHA=-1234},r$i.createSubmit=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$i._cache._length?r$i._cache[--r$i._cache._length]:new r$i;null==r$e&&((r$e=r$d._selfVb||(r$d._selfVb=r$yS.create(-1))).clear(),r$l=0),r$d._ib=r$Q,r$d._vb=r$e,r$d._startIdx=r$l*r$jS.BYTES_PIDX,r$d._numEle=0;var r$T=r$S._nBlendType;r$d._blendFn=r$S._targets?r$W.targetFns[r$T]:r$W.fns[r$T],r$d.shaderValue=r$M,r$d.shaderValue.setValue(r$S._shader2D);var r$U=r$S._shader2D.filters;return r$U&&r$d.shaderValue.setFilters(r$U),r$d},r$i.createShape=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=r$i._cache._length?r$i._cache[--r$i._cache._length]:new r$i;r$T._ib=r$Q,r$T._vb=r$e,r$T._numEle=r$l,r$T._startIdx=r$M,r$T.shaderValue=r$d,r$T.shaderValue.setValue(r$S._shader2D);var r$U=r$S._nBlendType;return r$T._blendFn=r$S._targets?r$W.targetFns[r$U]:r$W.fns[r$U],r$T},r$i.TYPE_2D=1e4,r$i.TYPE_CANVAS=10003,r$i.TYPE_CMDSETRT=10004,r$i.TYPE_CUSTOM=10005,r$i.TYPE_BLURRT=10006,r$i.TYPE_CMDDESTORYPRERT=10007,r$i.TYPE_DISABLESTENCIL=10008,r$i.TYPE_OTHERIBVB=10009,r$i.TYPE_PRIMITIVE=10010,r$i.TYPE_RT=10011,r$i.TYPE_BLUR_RT=10012,r$i.TYPE_TARGET=10013,r$i.TYPE_CHANGE_VALUE=10014,r$i.TYPE_SHAPE=10015,r$i.TYPE_TEXTURE=10016,r$i.TYPE_FILLTEXTURE=10017,r$i.RENDERBASE=null,r$i._cache=((r$i._cache=[])._length=0,r$i._cache),r$i}()),r$TS=function(){function r$l(){this.fun=null,this.args=null}r$p(r$l,"laya.webgl.submit.SubmitCMD");var r$S=r$l.prototype;return r$B.imps(r$S,{"laya.webgl.submit.ISubmit":!0}),r$S.renderSubmit=function(){return this.fun.apply(null,this.args),1},r$S.getRenderType=function(){return 0},r$S.releaseRender=function(){var r$S=r$l._cache;r$S[r$S._length++]=this},r$l.create=function(r$S,r$Q){var r$e=r$l._cache._length?r$l._cache[--r$l._cache._length]:new r$l;return r$e.fun=r$Q,r$e.args=r$S,r$e},r$l._cache=((r$l._cache=[])._length=0,r$l._cache),r$l}(),r$US=function(){function r$Q(){this.variables={}}r$p(r$Q,"laya.webgl.submit.SubmitCMDScope");var r$S=r$Q.prototype;return r$S.getValue=function(r$S){return this.variables[r$S]},r$S.addValue=function(r$S,r$Q){return this.variables[r$S]=r$Q},r$S.setValue=function(r$S,r$Q){return this.variables.hasOwnProperty(r$S)?this.variables[r$S]=r$Q:null},r$S.clear=function(){for(var r$S in this.variables)delete this.variables[r$S]},r$S.recycle=function(){this.clear(),r$Q.POOL.push(this)},r$Q.create=function(){var r$S=r$Q.POOL.pop();return r$S||(r$S=new r$Q),r$S},r$Q.POOL=[],r$Q}(),r$iS=function(){function r$Y(){this.offset=0,this.startIndex=0,this._mat=r$g.create()}r$p(r$Y,"laya.webgl.submit.SubmitOtherIBVB");var r$S=r$Y.prototype;return r$B.imps(r$S,{"laya.webgl.submit.ISubmit":!0}),r$S.releaseRender=function(){var r$S=r$Y._cache;(r$S[r$S._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},r$S.getRenderType=function(){return 10009},r$S.renderSubmit=function(){var r$S=this._shaderValue.textureHost;if(r$S){var r$Q=r$S.source;if(!r$S.bitmap||!r$Q)return 1;this._shaderValue.texture=r$Q}this._vb.bind_upload(this._ib);var r$e=r$zS.worldMatrix4,r$l=r$g.TEMP;r$g.mulPre(this._mat,r$e[0],r$e[1],r$e[4],r$e[5],r$e[12],r$e[13],r$l);var r$M=r$zS.worldMatrix4=r$Y.tempMatrix4;r$M[0]=r$l.a,r$M[1]=r$l.b,r$M[4]=r$l.c,r$M[5]=r$l.d,r$M[12]=r$l.tx,r$M[13]=r$l.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var r$d=r$vS.mainContext;return r$W.activeBlendFunction!==this._blendFn&&(r$d.enable(3042),this._blendFn(r$d),r$W.activeBlendFunction=this._blendFn),r$X.drawCall++,r$X.trianglesFaces+=this._numEle/3,r$d.drawElements(4,this._numEle,5123,this.startIndex),r$zS.worldMatrix4=r$e,r$nS.activeShader=null,1},r$Y.create=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){void 0===r$i&&(r$i=0);var r$R=r$Y._cache._length?r$Y._cache[--r$Y._cache._length]:new r$Y;r$R._ib=r$e,r$R._vb=r$Q,r$R._numEle=r$l,r$R._shader=r$M,r$R._shaderValue=r$d;var r$o=r$S._nBlendType;switch(r$R._blendFn=r$S._targets?r$W.targetFns[r$o]:r$W.fns[r$o],r$i){case 0:r$R.offset=0,r$R.startIndex=r$U/(r$jS.BYTES_PE*r$Q.vertexStride)*1.5,r$R.startIndex*=r$jS.BYTES_PIDX;break;case 1:r$R.startIndex=r$T,r$R.offset=r$U}return r$R},r$Y._cache=((r$Y._cache=[])._length=0,r$Y._cache),r$Y.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r$Y}(),r$RS=function(){function r$e(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new r$E,this.screenRect=new r$E}r$p(r$e,"laya.webgl.submit.SubmitScissor");var r$S=r$e.prototype;return r$B.imps(r$S,{"laya.webgl.submit.ISubmit":!0}),r$S._scissor=function(r$S,r$Q,r$e,r$l){var r$M=r$zS.worldMatrix4,r$d=r$M[0],r$T=r$M[5],r$U=r$M[12],r$i=r$M[13];if(r$l*=r$T,(r$e*=r$d)<1||r$l<1)return!1;var r$R=(r$S=r$S*r$d+r$U)+r$e,r$o=(r$Q=r$Q*r$T+r$i)+r$l;r$S<0&&(r$e=r$R-(r$S=0)),r$Q<0&&(r$l=r$o-(r$Q=0));var r$Y=r$zS.worldClipRect;if(r$S=Math.max(r$S,r$Y.x),r$Q=Math.max(r$Q,r$Y.y),r$e=Math.min(r$R,r$Y.right)-r$S,r$l=Math.min(r$o,r$Y.bottom)-r$Q,r$e<1||r$l<1)return!1;var r$p=r$zS.worldScissorTest;return this.screenRect.copyFrom(r$Y),r$Y.x=r$S,r$Y.y=r$Q,r$Y.width=r$e,r$Y.height=r$l,r$zS.worldScissorTest=!0,r$Q=r$zS.height-r$Q-r$l,r$vS.mainContext.scissor(r$S,r$Q,r$e,r$l),r$vS.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),r$p?(r$Q=r$zS.height-this.screenRect.y-this.screenRect.height,r$vS.mainContext.scissor(this.screenRect.x,r$Q,this.screenRect.width,this.screenRect.height),r$vS.mainContext.enable(3089)):(r$vS.mainContext.disable(3089),r$zS.worldScissorTest=!1),r$Y.copyFrom(this.screenRect),!0},r$S._scissorWithTagart=function(r$S,r$Q,r$e,r$l){if(r$e<1||r$l<1)return!1;var r$M=r$S+r$e,r$d=r$Q+r$l;r$S<0&&(r$e=r$M-(r$S=0)),r$Q<0&&(r$l=r$d-(r$Q=0));var r$T=r$zS.worldClipRect;if(r$S=Math.max(r$S,r$T.x),r$Q=Math.max(r$Q,r$T.y),r$e=Math.min(r$M,r$T.right)-r$S,r$l=Math.min(r$d,r$T.bottom)-r$Q,r$e<1||r$l<1)return!1;var r$U=r$zS.worldScissorTest;return this.screenRect.copyFrom(r$T),r$zS.worldScissorTest=!0,r$T.x=r$S,r$T.y=r$Q,r$T.width=r$e,r$T.height=r$l,r$Q=r$zS.height-r$Q-r$l,r$vS.mainContext.scissor(r$S,r$Q,r$e,r$l),r$vS.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),r$U?(r$Q=r$zS.height-this.screenRect.y-this.screenRect.height,r$vS.mainContext.scissor(this.screenRect.x,r$Q,this.screenRect.width,this.screenRect.height),r$vS.mainContext.enable(3089)):(r$vS.mainContext.disable(3089),r$zS.worldScissorTest=!1),r$T.copyFrom(this.screenRect),!0},r$S.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},r$S.getRenderType=function(){return 0},r$S.releaseRender=function(){var r$S=r$e._cache;(r$S[r$S._length++]=this).context=null},r$e.create=function(r$S){var r$Q=r$e._cache._length?r$e._cache[--r$e._cache._length]:new r$e;return r$Q.context=r$S,r$Q},r$e._cache=((r$e._cache=[])._length=0,r$e._cache),r$e}(),r$oS=function(){function r$i(){this.step=0,this.blendMode=null,this.level=0}r$p(r$i,"laya.webgl.submit.SubmitStencil");var r$S=r$i.prototype;return r$B.imps(r$S,{"laya.webgl.submit.ISubmit":!0}),r$S.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},r$S.getRenderType=function(){return 0},r$S.releaseRender=function(){var r$S=r$i._cache;r$S[r$S._length++]=this},r$S.do1=function(){var r$S=r$vS.mainContext;r$S.enable(2960),r$S.clear(1024),r$S.colorMask(!1,!1,!1,!1),r$S.stencilFunc(514,this.level,255),r$S.stencilOp(7680,7680,7682)},r$S.do2=function(){var r$S=r$vS.mainContext;r$S.stencilFunc(514,this.level+1,255),r$S.colorMask(!0,!0,!0,!0),r$S.stencilOp(7680,7680,7680)},r$S.do3=function(){var r$S=r$vS.mainContext;r$S.colorMask(!0,!0,!0,!0),r$S.stencilOp(7680,7680,7680),r$S.clear(1024),r$S.disable(2960)},r$S.do4=function(){var r$S=r$vS.mainContext;0==this.level&&(r$S.enable(2960),r$S.clear(1024)),r$S.colorMask(!1,!1,!1,!1),r$S.stencilFunc(519,0,255),r$S.stencilOp(7680,7680,7682)},r$S.do5=function(){var r$S=r$vS.mainContext;r$S.stencilFunc(514,this.level,255),r$S.colorMask(!0,!0,!0,!0),r$S.stencilOp(7680,7680,7680)},r$S.do6=function(){var r$S=r$vS.mainContext;r$W.targetFns[r$W.TOINT[this.blendMode]](r$S)},r$S.do7=function(){var r$S=r$vS.mainContext;r$S.colorMask(!1,!1,!1,!1),r$S.stencilOp(7680,7680,7683)},r$S.do8=function(){var r$S=r$vS.mainContext;r$S.colorMask(!0,!0,!0,!0),r$S.stencilFunc(514,this.level,255),r$S.stencilOp(7680,7680,7680)},r$i.restore=function(r$S,r$Q,r$e,r$l,r$M){var r$d;if((r$S._renderKey=0)<r$i._mask&&r$i._mask--,0==r$i._mask)r$d=laya.webgl.submit.SubmitStencil.create(3),r$S.addRenderObject(r$d),r$S._curSubmit=r$dS.RENDERBASE;else{r$d=laya.webgl.submit.SubmitStencil.create(7),r$S.addRenderObject(r$d);var r$T=r$S._vb;r$T._byteLength;if(r$cS.fillRectImgVb(r$T,null,r$Q.x,r$Q.y,r$Q.width,r$Q.height,r$$.DEF_UV,r$e,r$l,r$M,0,0)){r$S._shader2D.glTexture=null;var r$U=r$S._curSubmit=r$dS.createSubmit(r$S,r$S._ib,r$T,(r$T._byteLength-64)/32*3,r$HS.create(2,0));r$U.shaderValue.ALPHA=1,r$S._submits[r$S._submits._length++]=r$U,r$S._curSubmit._numEle+=6,r$S._curSubmit=r$dS.RENDERBASE}else alert("clipRect calc stencil rect error");r$d=laya.webgl.submit.SubmitStencil.create(8),r$S.addRenderObject(r$d)}},r$i.restore2=function(r$S,r$Q){var r$e;(r$S._renderKey=0)<r$i._mask&&r$i._mask--,0==r$i._mask?(r$e=laya.webgl.submit.SubmitStencil.create(3),r$S.addRenderObject(r$e),r$S._curSubmit=r$dS.RENDERBASE):(r$e=laya.webgl.submit.SubmitStencil.create(7),r$S.addRenderObject(r$e),r$S._submits[r$S._submits._length++]=r$Q,r$e=laya.webgl.submit.SubmitStencil.create(8),r$S.addRenderObject(r$e))},r$i.create=function(r$S){var r$Q=r$i._cache._length?r$i._cache[--r$i._cache._length]:new r$i;return 5==(r$Q.step=r$S)&&++r$i._mask,r$Q.level=r$i._mask,r$Q},r$i._cache=((r$i._cache=[])._length=0,r$i._cache),r$i._mask=0,r$i}(),r$YS=function(){function r$U(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}r$p(r$U,"laya.webgl.submit.SubmitTarget");var r$S=r$U.prototype;return r$B.imps(r$S,{"laya.webgl.submit.ISubmit":!0}),r$S.renderSubmit=function(){this._vb.bind_upload(this._ib);var r$S=this.scope.getValue(this.proName);return r$S&&(this.shaderValue.texture=r$S.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[r$S.width,r$S.height]),this.shaderValue.upload(),this.blend(),r$X.drawCall++,r$X.trianglesFaces+=this._numEle/3,r$vS.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},r$S.blend=function(){if(r$W.activeBlendFunction!==r$W.fns[this.blendType]){var r$S=r$vS.mainContext;r$S.enable(3042),r$W.fns[this.blendType](r$S),r$W.activeBlendFunction=r$W.fns[this.blendType]}},r$S.getRenderType=function(){return 0},r$S.releaseRender=function(){var r$S=r$U._cache;(r$S[r$S._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},r$U.create=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=r$U._cache._length?r$U._cache[--r$U._cache._length]:new r$U;return r$T._ib=r$Q,r$T._vb=r$e,r$T.proName=r$d,r$T._startIdx=r$l*r$jS.BYTES_PIDX,r$T._numEle=0,r$T.blendType=r$S._nBlendType,r$T.shaderValue=r$M,r$T.shaderValue.setValue(r$S._shader2D),r$T},r$U._cache=((r$U._cache=[])._length=0,r$U._cache),r$U}(),r$pS=function(){function r$S(){this._sourceStr=null}r$p(r$S,"laya.webgl.text.CharSegment");var r$Q=r$S.prototype;return r$B.imps(r$Q,{"laya.webgl.text.ICharSegment":!0}),r$Q.textToSpit=function(r$S){this._sourceStr=r$S},r$Q.getChar=function(r$S){return this._sourceStr.charAt(r$S)},r$Q.getCharCode=function(r$S){return this._sourceStr.charCodeAt(r$S)},r$Q.length=function(){return this._sourceStr.length},r$S}(),r$JS=function(){var r$S;function r$X(){}return r$p(r$X,"laya.webgl.text.DrawText"),r$X.__init__=function(){r$X._charsTemp=new Array,r$X._drawValue=new r$S,r$X._charSeg=new r$pS},r$X.customCharSeg=function(r$S){r$X._charSeg=r$S},r$X.getChar=function(r$S,r$Q,r$e){var r$l=r$qS.createOneChar(r$S,r$e);return-1!=r$Q&&(r$X._charsCache[r$Q]=r$l),r$l},r$X._drawSlow=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o,r$Y,r$p,r$J,r$L){var r$j,r$c,r$G=r$X._drawValue.value(r$d,r$U,r$i,r$R,r$p,r$J,r$L),r$z=0,r$A=0,r$v=r$X._charsTemp,r$D=0,r$B=NaN;if(r$l)for(r$v.length=r$l.length,r$z=0,r$A=r$l.length;r$z<r$A;r$z++)(r$c=r$l[r$z])&&(r$B=r$c.charNum+r$G.txtID,r$v[r$z]=r$j=r$X._charsCache[r$B]||r$X.getChar(r$c.char,r$B,r$G),r$j.active());else{var r$O=r$e instanceof laya.utils.WordText?r$e.toString():r$e;if(r$m.CharacterCache){r$X._charSeg.textToSpit(r$O);var r$H=r$X._charSeg.length();for(r$z=0,r$A=r$v.length=r$H;r$z<r$A;r$z++)r$B=r$X._charSeg.getCharCode(r$z)+r$G.txtID,r$v[r$z]=r$j=r$X._charsCache[r$B]||r$X.getChar(r$X._charSeg.getChar(r$z),r$B,r$G),r$j.active(),r$D+=r$j.cw}else r$v.length=0,(r$j=r$X.getChar(r$O,-1,r$G)).active(),r$D+=r$j.cw,r$v[0]=r$j}var r$g=0;null!==r$T&&"left"!==r$T&&(r$g=-("center"==r$T?r$D/2:r$D));var r$I,r$E,r$t=NaN,r$k=0;if(r$l)for(r$z=0,r$A=r$v.length;r$z<r$A;r$z++)r$j=r$v[r$z],r$c=r$l[r$z],r$j&&r$c&&!r$j.isSpace&&(r$t=r$j.borderSize,r$I=r$j.texture,r$Q._drawText(r$I,r$o+r$g+r$c.x*r$p-r$t,r$Y+r$c.y*r$J-r$t,r$I.width,r$I.height,r$M,0,0,0,0));else{for(r$z=0,r$A=r$v.length;r$z<r$A;r$z++)(r$j=r$v[r$z])&&!r$j.isSpace&&(r$t=r$j.borderSize,r$I=r$j.texture,r$Q._drawText(r$I,r$o+r$g-r$t,r$Y-r$t,r$I.width,r$I.height,r$M,0,0,0,0),r$S&&((r$E=r$S[r$k++])||(r$E=r$S[r$k-1]=[]),r$E[0]=r$I,r$E[1]=r$g-r$t,r$E[2]=-r$t)),r$g+=r$j.cw;r$S&&(r$S.length=r$k)}},r$X._drawFast=function(r$S,r$Q,r$e,r$l,r$M){for(var r$d,r$T,r$U=0,r$i=r$S.length;r$U<r$i;r$U++)(r$d=(r$T=r$S[r$U])[0]).active(),r$Q._drawText(r$d,r$l+r$T[1],r$M+r$T[2],r$d.width,r$d.height,r$e,0,0,0,0)},r$X.drawText=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o,r$Y){if(void 0===r$Y&&(r$Y=0),!(r$Q&&0===r$Q.length||r$e&&0===r$e.length)){var r$p=r$l.a,r$J=r$l.d;(0!==r$l.b||0!==r$l.c)&&(r$p=r$J=1);var r$L=1!==r$p||1!==r$J;if(r$L&&r$B.stage.transform){var r$j=r$B.stage.transform;r$L=r$j.a===r$p&&r$j.d===r$J}else r$L=!1;if(r$L){var r$c=(r$l=r$l.copyTo(r$OS._tmpMatrix)).tx,r$G=r$l.ty;r$l.scale(1/r$p,1/r$J),r$l._checkTransform(),r$R*=r$p,r$o*=r$J,r$R+=r$c-r$l.tx,r$o+=r$G-r$l.ty}else r$p=r$J=1;if(r$e)r$X._drawSlow(null,r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o,r$p,r$J,r$Y);else{if(null===r$Q.toUpperCase){var r$z=r$p+1e5*r$J,r$A=r$Q;return void(r$A.changed||r$A.id!==r$z?(r$A.id=r$z,r$A.changed=!1,r$X._drawSlow(r$A.save,r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o,r$p,r$J,r$Y)):r$X._drawFast(r$A.save,r$S,r$l,r$R,r$o))}var r$v=r$Q+r$M.toString()+r$T+r$U+r$i+r$p+r$J+r$d,r$D=r$X._textsCache[r$v];r$m.CharacterCache?r$D?r$X._drawFast(r$D,r$S,r$l,r$R,r$o):(r$X._textsCache.__length||(r$X._textsCache.__length=0),r$X._textsCache.__length>r$O.WebGLTextCacheCount&&((r$X._textsCache={}).__length=0,r$X._curPoolIndex=0),r$X._textCachesPool[r$X._curPoolIndex]?(r$D=r$X._textsCache[r$v]=r$X._textCachesPool[r$X._curPoolIndex]).length=0:r$X._textCachesPool[r$X._curPoolIndex]=r$D=r$X._textsCache[r$v]=[],r$X._textsCache.__length++,r$X._curPoolIndex++,r$X._drawSlow(r$D,r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o,r$p,r$J,r$Y)):r$X._drawSlow(r$D,r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o,r$p,r$J,r$Y)}}},r$X._charsTemp=null,r$X._textCachesPool=[],r$X._curPoolIndex=0,r$X._charsCache={},r$X._textsCache={},r$X._drawValue=null,r$X.d=[],r$X._charSeg=null,r$X.__init$=function(){r$S=function(){function r$i(){}return r$p(r$i,""),r$i.prototype.value=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this.font=r$S,this.fillColor=r$Q,this.borderColor=r$e,this.lineWidth=r$l,this.scaleX=r$M,this.scaleY=r$d,this.underLine=r$T;var r$U=r$S.toString()+r$M+r$d+r$l+(r$Q?r$Q.toLowerCase():" ")+(r$e?r$e.toLowerCase():" ")+r$T;return this.txtID=r$i._keymap[r$U],this.txtID||(this.txtID=1e-7*++r$i._keymapCount,r$i._keymap[r$U]=this.txtID),this},r$i.clear=function(){r$i._keymap={},r$i._keymapCount=1},r$i._keymap={},r$i._keymapCount=1,r$i}()},r$X}(),r$LS=function(){function r$M(r$S){this._index=0,this._size=14,this._italic=-2,r$M._cache2=r$M._cache2||[],this.setFont(r$S||"14px Arial")}r$p(r$M,"laya.webgl.text.FontInContext");var r$S=r$M.prototype;return r$S.setFont=function(r$S){var r$Q=r$M._cache2[r$S];if(r$Q)this._words=r$Q[0],this._size=r$Q[1];else{this._words=r$S.split(" ");for(var r$e=0,r$l=this._words.length;r$e<r$l;r$e++)if(0<this._words[r$e].indexOf("px")){this._index=r$e;break}this._size=parseInt(this._words[this._index]),r$M._cache2[r$S]=[this._words,this._size]}this._text=null,this._italic=-2},r$S.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},r$S.hasType=function(r$S){for(var r$Q=0,r$e=this._words.length;r$Q<r$e;r$Q++)if(this._words[r$Q]===r$S)return r$Q;return-1},r$S.removeType=function(r$S){for(var r$Q=0,r$e=this._words.length;r$Q<r$e;r$Q++)if(this._words[r$Q]===r$S){this._words.splice(r$Q,1),this._index>r$Q&&this._index--;break}this._text=null,this._italic=-2},r$S.copyTo=function(r$S){return r$S._text=this._text,r$S._size=this._size,r$S._index=this._index,r$S._words=this._words.slice(),r$S._italic=-2,r$S},r$S.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},r$l(0,r$S,"size",function(){return this._size},function(r$S){this._size=r$S,this._words[this._index]=r$S+"px",this._text=null}),r$M.create=function(r$S){var r$Q=r$M._cache[r$S];return r$Q||(r$Q=r$M._cache[r$S]=new r$M(r$S))},r$M.EMPTY=new r$M,r$M._cache={},r$M._cache2=null,r$M}(),r$jS=function(){function r$S(){}return r$p(r$S,"laya.webgl.utils.CONST3D2D"),r$S.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r$S.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],r$S.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],r$S._TMPARRAY=[],r$S._OFFSETX=0,r$S._OFFSETY=0,r$T(r$S,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),r$S}(),r$cS=function(){function r$L(){}return r$p(r$L,"laya.webgl.utils.GlUtils"),r$L.make2DProjection=function(r$S,r$Q,r$e){return[2/r$S,0,0,0,0,-2/r$Q,0,0,0,0,2/r$e,0,-1,1,0,1]},r$L.fillIBQuadrangle=function(r$S,r$Q){if(65535/4<r$Q)throw Error("IBQuadrangle count:"+r$Q+" must<:"+Math.floor(65535/4));r$Q=Math.floor(r$Q),r$S._resizeBuffer(6*(r$Q+1)*2,!1),r$S.byteLength=r$S.bufferLength;for(var r$e=r$S.getUint16Array(),r$l=0,r$M=0;r$M<r$Q;r$M++)r$e[r$l++]=4*r$M,r$e[r$l++]=4*r$M+2,r$e[r$l++]=4*r$M+1,r$e[r$l++]=4*r$M,r$e[r$l++]=4*r$M+3,r$e[r$l++]=4*r$M+2;return r$S.setNeedUpload(),!0},r$L.expandIBQuadrangle=function(r$S,r$Q){r$S.bufferLength>=6*r$Q*2||r$L.fillIBQuadrangle(r$S,r$Q)},r$L.mathCeilPowerOfTwo=function(r$S){return r$S--,r$S|=r$S>>1,r$S|=r$S>>2,r$S|=r$S>>4,r$S|=r$S>>8,r$S|=r$S>>16,++r$S},r$L.fillQuadrangleImgVb=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){var r$i=16+(r$S._byteLength>>2);r$S.byteLength=r$i<<2;var r$R=r$S.getFloat32Array();r$R[(r$i-=16)+2]=r$M[0],r$R[r$i+3]=r$M[1],r$R[r$i+6]=r$M[2],r$R[r$i+7]=r$M[3],r$R[r$i+10]=r$M[4],r$R[r$i+11]=r$M[5],r$R[r$i+14]=r$M[6],r$R[r$i+15]=r$M[7];var r$o=r$d.a,r$Y=r$d.b,r$p=r$d.c,r$J=r$d.d;if(1!==r$o||0!==r$Y||0!==r$p||1!==r$J){r$d.bTransform=!0;var r$L=r$d.tx+r$T,r$j=r$d.ty+r$U;r$R[r$i]=(r$l[0]+r$Q)*r$o+(r$l[1]+r$e)*r$p+r$L,r$R[r$i+1]=(r$l[0]+r$Q)*r$Y+(r$l[1]+r$e)*r$J+r$j,r$R[r$i+4]=(r$l[2]+r$Q)*r$o+(r$l[3]+r$e)*r$p+r$L,r$R[r$i+5]=(r$l[2]+r$Q)*r$Y+(r$l[3]+r$e)*r$J+r$j,r$R[r$i+8]=(r$l[4]+r$Q)*r$o+(r$l[5]+r$e)*r$p+r$L,r$R[r$i+9]=(r$l[4]+r$Q)*r$Y+(r$l[5]+r$e)*r$J+r$j,r$R[r$i+12]=(r$l[6]+r$Q)*r$o+(r$l[7]+r$e)*r$p+r$L,r$R[r$i+13]=(r$l[6]+r$Q)*r$Y+(r$l[7]+r$e)*r$J+r$j}else r$d.bTransform=!1,r$Q+=r$d.tx+r$T,r$e+=r$d.ty+r$U,r$R[r$i]=r$Q+r$l[0],r$R[r$i+1]=r$e+r$l[1],r$R[r$i+4]=r$Q+r$l[2],r$R[r$i+5]=r$e+r$l[3],r$R[r$i+8]=r$Q+r$l[4],r$R[r$i+9]=r$e+r$l[5],r$R[r$i+12]=r$Q+r$l[6],r$R[r$i+13]=r$e+r$l[7];return r$S._upload=!0},r$L.fillTranglesVB=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){var r$U=(r$S._byteLength>>2)+r$l.length;r$S.byteLength=r$U<<2;var r$i=r$S.getFloat32Array();r$U-=r$l.length;for(var r$R=r$l.length,r$o=r$M.a,r$Y=r$M.b,r$p=r$M.c,r$J=r$M.d,r$L=0;r$L<r$R;r$L+=4)if(r$i[r$U+r$L+2]=r$l[r$L+2],r$i[r$U+r$L+3]=r$l[r$L+3],1!==r$o||0!==r$Y||0!==r$p||1!==r$J){r$M.bTransform=!0;var r$j=r$M.tx+r$d,r$c=r$M.ty+r$T;r$i[r$U+r$L]=(r$l[r$L]+r$Q)*r$o+(r$l[r$L+1]+r$e)*r$p+r$j,r$i[r$U+r$L+1]=(r$l[r$L]+r$Q)*r$Y+(r$l[r$L+1]+r$e)*r$J+r$c}else r$M.bTransform=!1,r$Q+=r$M.tx+r$d,r$e+=r$M.ty+r$T,r$i[r$U+r$L]=r$Q+r$l[r$L],r$i[r$U+r$L+1]=r$e+r$l[r$L+1];return r$S._upload=!0},r$L.copyPreImgVb=function(r$S,r$Q,r$e){var r$l=r$S._byteLength>>2;r$S.byteLength=r$l+16<<2;for(var r$M=r$S.getFloat32Array(),r$d=0,r$T=r$l-16;r$d<4;r$d++)r$M[r$l]=r$M[r$T]+r$Q,++r$T,r$M[++r$l]=r$M[r$T]+r$e,++r$T,r$M[++r$l]=r$M[r$T],++r$T,r$M[++r$l]=r$M[r$T],++r$l,++r$T;r$S._upload=!0},r$L.fillRectImgVb=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o,r$Y,r$p){void 0===r$p&&(r$p=!1);var r$J,r$L,r$j,r$c,r$G,r$z,r$A,r$v,r$D,r$B,r$O,r$H,r$g,r$I,r$E,r$t,r$k=1,r$X=r$U.a,r$h=r$U.b,r$b=r$U.c,r$m=r$U.d,r$$=r$Q&&r$Q.width<99999999;if(1!==r$X||0!==r$h||0!==r$b||1!==r$m?(r$U.bTransform=!0,0===r$h&&0===r$b&&(r$k=23,r$D=r$M+r$e,r$B=r$d+r$l,r$J=r$X*r$e+(r$O=r$U.tx+r$i),r$j=r$X*r$D+r$O,r$L=r$m*r$l+(r$H=r$U.ty+r$R),r$c=r$m*r$B+r$H)):(r$k=23,r$U.bTransform=!1,r$j=(r$J=r$e+r$U.tx+r$i)+r$M,r$c=(r$L=r$l+r$U.ty+r$R)+r$d),r$$&&(r$G=r$Q.x,r$z=r$Q.y,r$A=r$Q.width+r$G,r$v=r$Q.height+r$z),1!==r$k){if(Math.min(r$J,r$j)>=r$A)return!1;if(Math.min(r$L,r$c)>=r$v)return!1;if(Math.max(r$j,r$J)<=r$G)return!1;if(Math.max(r$c,r$L)<=r$z)return!1}var r$n=r$S._byteLength>>2;r$S.byteLength=16+r$n<<2;var r$P=r$S.getFloat32Array();switch(r$P[2+r$n]=r$T[0],r$P[3+r$n]=r$T[1],r$P[6+r$n]=r$T[2],r$P[7+r$n]=r$T[3],r$P[10+r$n]=r$T[4],r$P[11+r$n]=r$T[5],r$P[14+r$n]=r$T[6],r$P[15+r$n]=r$T[7],r$k){case 1:r$O=r$U.tx+r$i,r$H=r$U.ty+r$R;var r$a=r$X*r$e,r$f=r$b*r$l,r$w=r$m*r$l,r$u=r$h*r$e,r$r=r$X*(r$D=r$M+r$e),r$W=r$b*(r$B=r$d+r$l),r$x=r$m*r$B,r$F=r$h*r$D;r$p?(r$g=r$a+r$f+r$O,r$E=Math.round(r$g)-r$g,r$I=r$w+r$u+r$H,r$t=Math.round(r$I)-r$I,r$P[r$n]=r$g+r$E,r$P[1+r$n]=r$I+r$t,r$P[4+r$n]=r$r+r$f+r$O+r$E,r$P[5+r$n]=r$w+r$F+r$H+r$t,r$P[8+r$n]=r$r+r$W+r$O+r$E,r$P[9+r$n]=r$x+r$F+r$H+r$t,r$P[12+r$n]=r$a+r$W+r$O+r$E,r$P[13+r$n]=r$x+r$u+r$H+r$t):(r$P[r$n]=r$a+r$f+r$O,r$P[1+r$n]=r$w+r$u+r$H,r$P[4+r$n]=r$r+r$f+r$O,r$P[5+r$n]=r$w+r$F+r$H,r$P[8+r$n]=r$r+r$W+r$O,r$P[9+r$n]=r$x+r$F+r$H,r$P[12+r$n]=r$a+r$W+r$O,r$P[13+r$n]=r$x+r$u+r$H);break;case 23:r$p?(r$g=r$J+r$o,r$E=Math.round(r$g)-r$g,r$I=r$L,r$t=Math.round(r$I)-r$I,r$P[r$n]=r$g+r$E,r$P[1+r$n]=r$I+r$t,r$P[4+r$n]=r$j+r$o+r$E,r$P[5+r$n]=r$L+r$t,r$P[8+r$n]=r$j+r$E,r$P[9+r$n]=r$c+r$t,r$P[12+r$n]=r$J+r$E,r$P[13+r$n]=r$c+r$t):(r$P[r$n]=r$J+r$o,r$P[1+r$n]=r$L,r$P[4+r$n]=r$j+r$o,r$P[5+r$n]=r$L,r$P[8+r$n]=r$j,r$P[9+r$n]=r$c,r$P[12+r$n]=r$J,r$P[13+r$n]=r$c)}return r$S._upload=!0},r$L.fillLineVb=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){var r$i=.5*r$T,r$R=r$L._fillLineArray,r$o=-(r$l-r$d),r$Y=r$e-r$M,r$p=Math.sqrt(r$o*r$o+r$Y*r$Y);r$o/=r$p,r$Y/=r$p,r$o*=r$i,r$Y*=r$i,r$R[0]=r$e-r$o,r$R[1]=r$l-r$Y,r$R[4]=r$e+r$o,r$R[5]=r$l+r$Y,r$R[8]=r$M+r$o,r$R[9]=r$d+r$Y,r$R[12]=r$M-r$o,r$R[13]=r$d-r$Y,r$U&&r$U.transformPointArray(r$R,r$R);var r$J=16+(r$S._byteLength>>2);return r$S.byteLength=r$J<<2,r$S.insertData(r$R,r$J-16),!0},r$L._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r$L}(),r$GS=(function(){function r$i(){}r$p(r$i,"laya.webgl.utils.MatirxArray"),r$i.ArrayMul=function(r$S,r$Q,r$e){if(r$S)if(r$Q)for(var r$l=NaN,r$M=NaN,r$d=NaN,r$T=NaN,r$U=0;r$U<4;r$U++)r$l=r$S[r$U],r$M=r$S[r$U+4],r$d=r$S[r$U+8],r$T=r$S[r$U+12],r$e[r$U]=r$l*r$Q[0]+r$M*r$Q[1]+r$d*r$Q[2]+r$T*r$Q[3],r$e[r$U+4]=r$l*r$Q[4]+r$M*r$Q[5]+r$d*r$Q[6]+r$T*r$Q[7],r$e[r$U+8]=r$l*r$Q[8]+r$M*r$Q[9]+r$d*r$Q[10]+r$T*r$Q[11],r$e[r$U+12]=r$l*r$Q[12]+r$M*r$Q[13]+r$d*r$Q[14]+r$T*r$Q[15];else r$i.copyArray(r$S,r$e);else r$i.copyArray(r$Q,r$e)},r$i.copyArray=function(r$S,r$Q){if(r$S&&r$Q)for(var r$e=0;r$e<r$S.length;r$e++)r$Q[r$e]=r$S[r$e]}}(),function(){function r$Q(r$S,r$Q,r$e){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=r$S,this._vb=new r$yS(r$S,35048),r$Q&&this._vb._resizeBuffer(r$Q,!1),this._ib=new r$sS,r$e&&this._ib._resizeBuffer(r$e,!1)}r$p(r$Q,"laya.webgl.utils.Mesh2D");var r$S=r$Q.prototype;return r$S.cloneWithNewVB=function(){var r$S=new r$Q(this._stride,0,0);return r$S._ib=this._ib,r$S._quadNum=this._quadNum,r$S._attribInfo=this._attribInfo,r$S},r$S.cloneWithNewVBIB=function(){var r$S=new r$Q(this._stride,0,0);return r$S._attribInfo=this._attribInfo,r$S},r$S.getVBW=function(){return this._vb.setNeedUpload(),this._vb},r$S.getVBR=function(){return this._vb},r$S.getIBR=function(){return this._ib},r$S.getIBW=function(){return this._ib.setNeedUpload(),this._ib},r$S.createQuadIB=function(r$S){this._quadNum=r$S,this._ib._resizeBuffer(6*r$S*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var r$Q=this._ib.getUint16Array(),r$e=0,r$l=0,r$M=0;r$M<r$S;r$M++)r$Q[r$e++]=r$l,r$Q[r$e++]=r$l+2,r$Q[r$e++]=r$l+1,r$Q[r$e++]=r$l,r$Q[r$e++]=r$l+3,r$Q[r$e++]=r$l+2,r$l+=4;this._ib.setNeedUpload()},r$S.setAttributes=function(r$S){if(this._attribInfo=r$S,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},r$S.getEleNum=function(){return this._ib.getBuffer().byteLength/2},r$S.releaseMesh=function(){},r$S.destroy=function(){},r$S.clearVB=function(){this._vb.clear()},r$Q._gvaoid=0,r$Q}()),r$zS=function(){function r$M(){}return r$p(r$M,"laya.webgl.utils.RenderState2D"),r$M.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},r$M.mat2MatArray=function(r$S,r$Q){var r$e=r$S,r$l=r$Q;return r$l[0]=r$e.a,r$l[1]=r$e.b,r$l[2]=r$M.EMPTYMAT4_ARRAY[2],r$l[3]=r$M.EMPTYMAT4_ARRAY[3],r$l[4]=r$e.c,r$l[5]=r$e.d,r$l[6]=r$M.EMPTYMAT4_ARRAY[6],r$l[7]=r$M.EMPTYMAT4_ARRAY[7],r$l[8]=r$M.EMPTYMAT4_ARRAY[8],r$l[9]=r$M.EMPTYMAT4_ARRAY[9],r$l[10]=r$M.EMPTYMAT4_ARRAY[10],r$l[11]=r$M.EMPTYMAT4_ARRAY[11],r$l[12]=r$e.tx,r$l[13]=r$e.ty,r$l[14]=r$M.EMPTYMAT4_ARRAY[14],r$l[15]=r$M.EMPTYMAT4_ARRAY[15],r$Q},r$M.restoreTempArray=function(){r$M.TEMPMAT4_ARRAY[0]=1,r$M.TEMPMAT4_ARRAY[1]=0,r$M.TEMPMAT4_ARRAY[4]=0,r$M.TEMPMAT4_ARRAY[5]=1,r$M.TEMPMAT4_ARRAY[12]=0,r$M.TEMPMAT4_ARRAY[13]=0},r$M.clear=function(){r$M.worldScissorTest=!1,r$M.worldShaderDefines=null,r$M.worldFilters=null,r$M.worldAlpha=1,r$M.worldClipRect.x=r$M.worldClipRect.y=0,r$M.worldClipRect.width=r$M.width,r$M.worldClipRect.height=r$M.height,r$M.curRenderTarget=null},r$M._MAXSIZE=99999999,r$M.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r$M.worldMatrix4=r$M.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r$M.worldAlpha=1,r$M.worldScissorTest=!1,r$M.worldFilters=null,r$M.worldShaderDefines=null,r$M.curRenderTarget=null,r$M.width=0,r$M.height=0,r$T(r$M,["worldMatrix",function(){return this.worldMatrix=new r$g},"worldClipRect",function(){return this.worldClipRect=new r$E(0,0,99999999,99999999)}]),r$M}(),r$AS=function(){var r$z,r$e;function r$A(r$S,r$Q,r$e,r$l,r$M){var r$d=this;function r$T(r$S){var r$Q=[],r$e=new r$z(r$Q);return r$d._compileToTree(r$e,r$S.split("\n"),0,r$Q,r$M),r$e}var r$U=r$J.now();this._VS=r$T(r$Q),this._PS=r$T(r$e),this._nameMap=r$l,2<r$J.now()-r$U&&console.log("ShaderCompile use time:"+(r$J.now()-r$U)+"  size:"+r$Q.length+"/"+r$e.length)}r$p(r$A,"laya.webgl.utils.ShaderCompile");var r$S=r$A.prototype;return r$S._compileToTree=function(r$S,r$Q,r$e,r$l,r$M){var r$d,r$T,r$U,r$i,r$R,r$o,r$Y,r$p=0,r$J=0,r$L=0,r$j=0;for(r$J=r$e;r$J<r$Q.length;r$J++)if(!((r$U=r$Q[r$J]).length<1)&&0!==(r$p=r$U.indexOf("//"))){if(0<=r$p&&(r$U=r$U.substr(0,r$p)),r$d=r$Y||new r$z(r$l),r$Y=null,r$d.text=r$U,r$d.noCompile=!0,0<=(r$p=r$U.indexOf("#"))){for(r$i="#",r$j=r$p+1,r$L=r$U.length;r$j<r$L;r$j++){var r$c=r$U.charAt(r$j);if(" "===r$c||"\t"===r$c||"\r"===r$c||"\n"===r$c||"?"===r$c)break;r$i+=r$c}switch(r$d.name=r$i){case"#ifdef":case"#ifndef":if(r$d.src=r$U,r$d.noCompile=null!=r$U.match(/[!&|()=<>]/),r$d.noCompile?console.log("function():Boolean{return "+r$U.substr(r$p+r$d.name.length)+"}"):(r$o=r$U.replace(/^\s*/,"").split(/\s+/),r$d.setCondition(r$o[1],"#ifdef"===r$i?1:2),r$d.text="//"+r$d.text),r$d.setParent(r$S),r$S=r$d,r$M)for(r$o=r$U.substr(r$j).split(r$A._splitToWordExps3),r$j=0;r$j<r$o.length;r$j++)(r$U=r$o[r$j]).length&&(r$M[r$U]=!0);continue;case"#if":if(r$d.src=r$U,r$d.noCompile=!0,r$d.setParent(r$S),r$S=r$d,r$M)for(r$o=r$U.substr(r$j).split(r$A._splitToWordExps3),r$j=0;r$j<r$o.length;r$j++)(r$U=r$o[r$j]).length&&"defined"!=r$U&&(r$M[r$U]=!0);continue;case"#else":r$d.src=r$U,r$T=(r$S=r$S.parent).childs[r$S.childs.length-1],r$d.noCompile=r$T.noCompile,r$d.noCompile||(r$d.condition=r$T.condition,r$d.conditionType=1==r$T.conditionType?2:1,r$d.text="//"+r$d.text+" "+r$T.text+" "+r$d.conditionType),r$d.setParent(r$S),r$S=r$d;continue;case"#endif":r$T=(r$S=r$S.parent).childs[r$S.childs.length-1],r$d.noCompile=r$T.noCompile,r$d.noCompile||(r$d.text="//"+r$d.text),r$d.setParent(r$S);continue;case"#include":r$o=r$A.splitToWords(r$U,null);var r$G=r$A.includes[r$o[1]];if(!r$G)throw"ShaderCompile error no this include file:"+r$o[1];if((r$p=r$o[0].indexOf("?"))<0){r$d.setParent(r$S),r$U=r$G.getWith("with"==r$o[2]?r$o[3]:null),this._compileToTree(r$d,r$U.split("\n"),0,r$l,r$M),r$d.text="";continue}r$d.setCondition(r$o[0].substr(r$p+1),1),r$d.text=r$G.getWith("with"==r$o[2]?r$o[3]:null);break;case"#import":r$R=(r$o=r$A.splitToWords(r$U,null))[1],r$l.push({node:r$d,file:r$A.includes[r$R],ofs:r$d.text.length});continue}}else{if((r$T=r$S.childs[r$S.childs.length-1])&&!r$T.name){0<r$l.length&&r$A.splitToWords(r$U,r$T),r$Y=r$d,r$T.text+="\n"+r$U;continue}0<r$l.length&&r$A.splitToWords(r$U,r$d)}r$d.setParent(r$S)}},r$S.createShader=function(r$S,r$Q,r$e){var r$l={},r$M="";if(r$S)for(var r$d in r$S)r$M+="#define "+r$d+"\n",r$l[r$d]=!0;var r$T=this._VS.toscript(r$l,[]),r$U=this._PS.toscript(r$l,[]);return(r$e||r$CS.create)(r$M+r$T.join("\n"),r$M+r$U.join("\n"),r$Q,this._nameMap)},r$A._parseOne=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T={type:r$A.shaderParamsMap[r$e[r$l+1]],name:r$e[r$l+2],size:isNaN(parseInt(r$e[r$l+3]))?1:parseInt(r$e[r$l+3])};return r$d&&("attribute"==r$M?r$S.push(r$T):r$Q.push(r$T)),":"==r$e[r$l+3]&&(r$T.type=r$e[r$l+4],r$l+=2),r$l+=2},r$A.addInclude=function(r$S,r$Q){if(!r$Q||0===r$Q.length)throw new Error("add shader include file err:"+r$S);if(r$A.includes[r$S])throw new Error("add shader include file err, has add:"+r$S);r$A.includes[r$S]=new r$e(r$Q)},r$A.preGetParams=function(r$S,r$Q){var r$e=[r$S,r$Q],r$l={},r$M=[],r$d=[],r$T={},r$U=[];r$l.attributes=r$M,r$l.uniforms=r$d,r$l.defines=r$T;for(var r$i=0,r$R=0,r$o=0;r$o<2;r$o++){r$e[r$o]=r$e[r$o].replace(r$A._removeAnnotation,"");var r$Y,r$p=r$e[r$o].match(r$A._reg);for(r$i=0,r$R=r$p.length;r$i<r$R;r$i++){var r$J=r$p[r$i];if("attribute"==r$J||"uniform"==r$J)r$i=r$A._parseOne(r$M,r$d,r$p,r$i,r$J,!0);else{if("#define"==r$J){r$U[r$J=r$p[++r$i]]=1;continue}if("#ifdef"==r$J){r$T[r$Y=r$p[++r$i]]=r$T[r$Y]||[];for(r$i++;r$i<r$R;r$i++)if("attribute"==(r$J=r$p[r$i])||"uniform"==r$J)r$i=r$A._parseOne(r$M,r$d,r$p,r$i,r$J,r$U[r$Y]);else if("#else"==r$J)for(r$i++;r$i<r$R;r$i++)if("attribute"==(r$J=r$p[r$i])||"uniform"==r$J)r$i=r$A._parseOne(r$M,r$d,r$p,r$i,r$J,!r$U[r$Y]);else if("#endif"==r$J)break}}}}return r$l},r$A.splitToWords=function(r$S,r$Q){for(var r$e,r$l,r$M=[],r$d=-1,r$T=0,r$U=r$S.length;r$T<r$U;r$T++)if(r$e=r$S.charAt(r$T),0<=" \t=+-*/&%!<>()'\",;".indexOf(r$e)){if(0<=r$d&&1<r$T-r$d&&(r$l=r$S.substr(r$d,r$T-r$d),r$M.push(r$l)),'"'==r$e||"'"==r$e){var r$i=r$S.indexOf(r$e,r$T+1);if(r$i<0)throw"Sharder err:"+r$S;r$M.push(r$S.substr(r$T+1,r$i-r$T-1)),r$T=r$i,r$d=-1;continue}"("==r$e&&r$Q&&0<r$M.length&&(r$l=r$M[r$M.length-1]+";","vec4;main;".indexOf(r$l)<0&&(r$Q.useFuns+=r$l)),r$d=-1}else r$d<0&&(r$d=r$T);return r$d<r$U&&1<r$U-r$d&&(r$l=r$S.substr(r$d,r$U-r$d),r$M.push(r$l)),r$M},r$A.IFDEF_NO=0,r$A.IFDEF_YES=1,r$A.IFDEF_ELSE=2,r$A.IFDEF_PARENT=3,r$A._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),r$A._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),r$A._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),r$A.includes={},r$T(r$A,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),r$A.__init$=function(){r$z=function(){function r$e(r$S){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=r$S}r$p(r$e,"");var r$S=r$e.prototype;return r$S.setParent=function(r$S){r$S.childs.push(this),this.z=r$S.z+1,this.parent=r$S},r$S.setCondition=function(r$S,r$Q){r$S&&(this.conditionType=r$Q,r$S=r$S.replace(/(\s*$)/g,""),this.condition=function(){return this[r$S]},this.condition.__condition=r$S)},r$S.toscript=function(r$S,r$Q){return this._toscript(r$S,r$Q,++r$e.__id)},r$S._toscript=function(r$l,r$M,r$d){if(this.childs.length<1&&!this.text)return r$M;r$M.length;if(this.condition){var r$S=!!this.condition.call(r$l);if(2===this.conditionType&&(r$S=!r$S),!r$S)return r$M}if(this.text&&r$M.push(this.text),0<this.childs.length&&this.childs.forEach(function(r$S,r$Q,r$e){r$S._toscript(r$l,r$M,r$d)}),0<this.includefiles.length&&0<this.useFuns.length)for(var r$Q,r$e=0,r$T=this.includefiles.length;r$e<r$T;r$e++)this.includefiles[r$e].curUseID!=r$d&&0<(r$Q=this.includefiles[r$e].file.getFunsScript(this.useFuns)).length&&(this.includefiles[r$e].curUseID=r$d,r$M[0]=r$Q+r$M[0]);return r$M},r$e.__id=1,r$e}(),r$e=function(){function r$S(r$S){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=r$S;for(var r$Q=0,r$e=0,r$l=0;!((r$Q=r$S.indexOf("#begin",r$Q))<0);){for(r$l=r$Q+5;!((r$l=r$S.indexOf("#end",r$l))<0)&&"i"===r$S.charAt(r$l+4);)r$l+=5;if(r$l<0)throw"add include err,no #end:"+r$S;r$e=r$S.indexOf("\n",r$Q);var r$M=r$A.splitToWords(r$S.substr(r$Q,r$e-r$Q),null);"code"==r$M[1]?this.codes[r$M[2]]=r$S.substr(r$e+1,r$l-r$e-1):"function"==r$M[1]&&(r$e=r$S.indexOf("function",r$Q),r$e+="function".length,this.funs[r$M[3]]=r$S.substr(r$e+1,r$l-r$e-1),this.funnames+=r$M[3]+";"),r$Q=r$l+1}}r$p(r$S,"");var r$Q=r$S.prototype;return r$Q.getWith=function(r$S){var r$Q=r$S?this.codes[r$S]:this.script;if(!r$Q)throw"get with error:"+r$S;return r$Q},r$Q.getFunsScript=function(r$S){var r$Q="";for(var r$e in this.funs)0<=r$S.indexOf(r$e+";")&&(r$Q+=this.funs[r$e]);return r$Q},r$S}()},r$A}(),r$vS=function(){function r$T(){}return r$p(r$T,"laya.webgl.WebGL"),r$T._uint8ArraySlice=function(){for(var r$S=this.length,r$Q=new Uint8Array(this.length),r$e=0;r$e<r$S;r$e++)r$Q[r$e]=this[r$e];return r$Q},r$T._float32ArraySlice=function(){for(var r$S=this.length,r$Q=new Float32Array(this.length),r$e=0;r$e<r$S;r$e++)r$Q[r$e]=this[r$e];return r$Q},r$T._uint16ArraySlice=function(r$S){var r$Q,r$e=arguments,r$l=0,r$M=0;if(0===r$e.length)for(r$l=this.length,r$Q=new Uint16Array(r$l),r$M=0;r$M<r$l;r$M++)r$Q[r$M]=this[r$M];else if(2===r$e.length){var r$d=r$e[0],r$T=r$e[1];if(r$d<r$T)for(r$l=r$T-r$d,r$Q=new Uint16Array(r$l),r$M=r$d;r$M<r$T;r$M++)r$Q[r$M-r$d]=this[r$M];else r$Q=new Uint16Array(0)}return r$Q},r$T.expandContext=function(){var r$S=r$M.prototype,r$Q=CanvasRenderingContext2D.prototype;r$Q.fillTrangles=r$S.fillTrangles,r$KS.__int__(null),r$Q.setIBVB=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){void 0===r$i&&(r$i=0),void 0===r$R&&(r$R=0),null===r$e&&(this._ib=this._ib||r$sS.QuadrangleIB,r$e=this._ib,r$cS.expandIBQuadrangle(r$e,r$l._byteLength/64+8)),this._setIBVB(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R)},r$Q.fillTrangles=function(r$S,r$Q,r$e,r$l,r$M){this._curMat=this._curMat||r$g.create(),this._vb=this._vb||r$yS.create(),this._ib||(this._ib=r$sS.create(),r$cS.fillIBQuadrangle(this._ib,r$T/4));var r$d=this._vb,r$T=r$l.length>>4;r$cS.fillTranglesVB(r$d,r$Q,r$e,r$l,r$M||this._curMat,0,0),r$cS.expandIBQuadrangle(this._ib,r$d._byteLength/64+8);var r$U=new r$HS(1,0);r$U.textureHost=r$S;var r$i=new r$_S("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");r$d._vertType=3,this._setIBVB(r$Q,r$e,this._ib,r$d,6*r$T,r$M,r$i,r$U,0,0)}},r$T.enable=function(){if(r$J.__init__(),r$G.isConchApp&&!r$G.isConchWebGL)return r$D.skinAniSprite=function(){return new r$SS},r$T.expandContext(),!1;if(r$D.getWebGLContext=function(r$S){for(var r$Q,r$e=["webgl","experimental-webgl","webkit-3d","moz-webgl"],r$l=0;r$l<r$e.length;r$l++){try{r$Q=r$S.getContext(r$e[r$l],{stencil:r$O.isStencil,alpha:r$O.isAlpha,antialias:r$O.isAntialias,premultipliedAlpha:r$O.premultipliedAlpha,preserveDrawingBuffer:r$O.preserveDrawingBuffer})}catch(r$S){}if(r$Q)return r$Q}return null},null==(r$T.mainContext=r$D.getWebGLContext(r$G._mainCanvas)))return!1;if(r$G.isWebGL)return!0;r$j.create=function(r$S,r$Q){return new r$SQ(r$S,r$Q)},r$c.create=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){return new r$NS(r$S,r$Q,r$e,r$l,r$M,r$d,r$T)},r$G.WebGL=r$T,r$G.isWebGL=!0,r$JS.__init__(),r$D.createRenderSprite=function(r$S,r$Q){return new r$gS(r$S,r$Q)},r$D.createWebGLContext2D=function(r$S){return new r$OS(r$S)},r$D.changeWebGLSize=function(r$S,r$Q){laya.webgl.WebGL.onStageResize(r$S,r$Q)},r$D.createGraphics=function(){return new r$BS};var r$S=r$D.createFilterAction;return r$D.createFilterAction=r$S||function(r$S){return new r$IS},r$D.clear=function(r$S){r$zS.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var r$Q=r$G.context.ctx,r$e=0==r$Q._submits._length||r$O.preserveDrawingBuffer?r$L.create(r$S)._color:r$k._wgColor;r$e&&r$Q.clearBG(r$e[0],r$e[1],r$e[2],r$e[3]),r$zS.clear()},r$D.addToAtlas=function(r$S,r$Q){void 0===r$Q&&(r$Q=!1);var r$e=r$S.bitmap;r$G.optimizeTextureMemory(r$S.url,r$S)?r$B.__typeof(r$e,"laya.webgl.resource.IMergeAtlasBitmap")&&r$e.allowMerageInAtlas&&r$e.on("recovered",r$S,r$S.addTextureToAtlas):r$e.enableMerageInAtlas=!1},r$D.isAtlas=function(r$S){return r$S instanceof laya.webgl.atlas.AtlasWebGLCanvas},r$u._enable(),r$D.beginFlush=function(){for(var r$S=r$u.instance,r$Q=r$S.getAtlaserCount(),r$e=0;r$e<r$Q;r$e++){var r$l=r$S.getAtlaserByIndex(r$e).texture;r$l._flashCacheImageNeedFlush&&r$D.flashFlushImage(r$l)}},r$D.drawToCanvas=function(r$S,r$Q,r$e,r$l,r$M,r$d){(r$e<=0||r$l<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),r$e|=0,r$l|=0,r$M|=0,r$d|=0;var r$T=r$PS.create(r$e,r$l,6408,5121,0,!1);r$T.start(),r$T.clear(0,0,0,0),r$G.context.clear(),r$z.renders[r$Q]._fun(r$S,r$G.context,r$M,r$zS.height-r$l+r$d),r$G.context.flush(),r$T.end();var r$U=r$T.getData(0,0,r$e,r$l);if(r$T.recycle(),r$U.byteLength==r$e*r$l*4){var r$i=new r$FS;r$i._canvas=r$J.createElement("canvas"),r$i.size(r$e,r$l);var r$R=r$i._canvas.getContext("2d");r$J.canvas.size(r$e,r$l);var r$o=r$J.context,r$Y=r$o.createImageData(r$e,r$l);return r$Y.data.set(new Uint8ClampedArray(r$U.buffer)),r$i._imgData=r$Y,r$o.putImageData(r$Y,0,0),r$R.save(),r$R.translate(0,r$l),r$R.scale(1,-1),r$R.drawImage(r$J.canvas.source,0,0),r$R.restore(),r$i}console.log("drawToCanvas error: w:"+r$e+",h:"+r$l+",datalen:"+r$U.byteLength)},r$D.createFilterAction=function(r$S){var r$Q;switch(r$S){case 32:r$Q=new r$IS}return r$Q},r$D.addTextureToAtlas=function(r$S){r$S._uvID++,r$u._atlasRestore++,r$S.bitmap.enableMerageInAtlas&&r$u.instance.addToAtlas(r$S)},r$D.getTexturePixels=function(r$S,r$Q,r$e,r$l,r$M){r$G.context.ctx.clear();var r$d=new r$t;r$d.graphics.drawTexture(r$S,-r$Q,-r$e);var r$T=r$PS.create(r$l,r$M);r$T.start(),r$T.clear(0,0,0,0),r$d.render(r$G.context,0,0),r$G.context.ctx.flush(),r$T.end();for(var r$U=r$T.getData(0,0,r$l,r$M),r$i=[],r$R=0,r$o=r$M-1;0<=r$o;r$o--)for(var r$Y=0;r$Y<r$l;r$Y++)r$R=4*(r$o*r$l+r$Y),r$i.push(r$U[r$R]),r$i.push(r$U[r$R+1]),r$i.push(r$U[r$R+2]),r$i.push(r$U[r$R+3]);return r$i},r$D.skinAniSprite=function(){return new r$SS},r$R.create=function(r$S,r$Q){var r$e=new r$FS;return r$e._imgData=r$Q,r$e.flipY=!1,r$e},r$H._filterStart=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$S.getValue("bounds"),r$T=r$PS.create(r$d.width,r$d.height);if(r$T.start(),r$T.clear(0,0,0,0),r$S.addValue("src",r$T),r$S.addValue("ScissorTest",r$zS.worldScissorTest),r$zS.worldScissorTest){var r$U=new r$E;r$U.copyFrom(r$e.ctx._clipRect),r$S.addValue("clipRect",r$U),r$zS.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},r$H._filterEnd=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$S.getValue("bounds");r$S.getValue("src").end();var r$T=r$PS.create(r$d.width,r$d.height);r$T.start(),r$T.clear(0,0,0,0),r$S.addValue("out",r$T),r$Q._set$P("_filterCache",r$T),r$Q._set$P("_isHaveGlowFilter",r$S.getValue("_isHaveGlowFilter"))},r$H._EndTarget=function(r$S,r$Q){if(r$S.getValue("src").recycle(),r$S.getValue("out").end(),r$S.getValue("ScissorTest")){r$zS.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),r$Q.ctx.save();var r$e=r$S.getValue("clipRect");r$Q.ctx.clipRect(r$e.x,r$e.y,r$e.width,r$e.height)}},r$H._useSrc=function(r$S){var r$Q=r$S.getValue("out");r$Q.end(),(r$Q=r$S.getValue("src")).start(),r$Q.clear(0,0,0,0)},r$H._endSrc=function(r$S){r$S.getValue("src").end()},r$H._useOut=function(r$S){var r$Q=r$S.getValue("src");r$Q.end(),(r$Q=r$S.getValue("out")).start(),r$Q.clear(0,0,0,0)},r$H._endOut=function(r$S){r$S.getValue("out").end()},r$H._recycleScope=function(r$S){r$S.recycle()},r$H._filter=function(r$S,r$Q,r$e,r$l){var r$M=this._next;if(r$M){var r$d,r$T,r$U=r$S.filters,r$i=r$U.length;if(1==r$i&&32==r$U[0].type)return r$Q.ctx.save(),r$Q.ctx.setFilters([r$U[0]]),r$M._fun.call(r$M,r$S,r$Q,r$e,r$l),void r$Q.ctx.restore();var r$R=r$US.create(),r$o=r$I.TEMP,r$Y=r$Q.ctx._getTransformMatrix(),r$p=r$g.create();r$Y.copyTo(r$p);var r$J=0,r$L=0,r$j=!1,r$c=r$S._$P._filterCache?r$S._$P._filterCache:null;if(!r$c||r$S._repaint){r$j=r$S._isHaveGlowFilter(),r$R.addValue("_isHaveGlowFilter",r$j),r$j&&(r$J=50,r$L=25),(r$T=new r$E).copyFrom(r$S.getSelfBounds()),r$T.x+=r$S.x,r$T.y+=r$S.y,r$T.x-=r$S.pivotX+4,r$T.y-=r$S.pivotY+4;var r$G=r$T.x,r$z=r$T.y;if(r$T.width+=r$J+8,r$T.height+=r$J+8,r$o.x=r$T.x*r$p.a+r$T.y*r$p.c,r$o.y=r$T.y*r$p.d+r$T.x*r$p.b,r$T.x=r$o.x,r$T.y=r$o.y,r$o.x=r$T.width*r$p.a+r$T.height*r$p.c,r$o.y=r$T.height*r$p.d+r$T.width*r$p.b,r$T.width=r$o.x,r$T.height=r$o.y,r$T.width<=0||r$T.height<=0)return;r$c&&r$c.recycle(),r$R.addValue("bounds",r$T);var r$A=r$TS.create([r$R,r$S,r$Q,0,0],r$H._filterStart);r$Q.addRenderObject(r$A),r$Q.ctx._renderKey=0,r$Q.ctx._shader2D.glTexture=null;var r$v=r$S.x-r$G+r$L,r$D=r$S.y-r$z+r$L;r$M._fun.call(r$M,r$S,r$Q,r$v,r$D),r$A=r$TS.create([r$R,r$S,r$Q,0,0],r$H._filterEnd),r$Q.addRenderObject(r$A);for(var r$B=0;r$B<r$i;r$B++){0!=r$B&&(r$A=r$TS.create([r$R],r$H._useSrc),r$Q.addRenderObject(r$A),r$d=r$HS.create(1,0),r$g.TEMP.identity(),r$Q.ctx.drawTarget(r$R,0,0,r$T.width,r$T.height,r$g.TEMP,"out",r$d,null,r$W.TOINT.overlay),r$A=r$TS.create([r$R],r$H._useOut),r$Q.addRenderObject(r$A)),r$U[r$B].action.apply3d(r$R,r$S,r$Q,0,0)}r$A=r$TS.create([r$R,r$Q],r$H._EndTarget),r$Q.addRenderObject(r$A)}else{if((r$j=!!r$S._$P._isHaveGlowFilter&&r$S._$P._isHaveGlowFilter)&&(r$J=50,r$L=25),(r$T=r$S.getBounds()).width<=0||r$T.height<=0)return;r$T.width+=r$J,r$T.height+=r$J,r$o.x=r$T.x*r$p.a+r$T.y*r$p.c,r$o.y=r$T.y*r$p.d+r$T.x*r$p.b,r$T.x=r$o.x,r$T.y=r$o.y,r$o.x=r$T.width*r$p.a+r$T.height*r$p.c,r$o.y=r$T.height*r$p.d+r$T.width*r$p.b,r$T.width=r$o.x,r$T.height=r$o.y,r$R.addValue("out",r$c)}r$e=r$e-r$L-r$S.x,r$l=r$l-r$L-r$S.y,r$o.setTo(r$e,r$l),r$p.transformPoint(r$o),r$e=r$o.x+r$T.x,r$l=r$o.y+r$T.y,r$d=r$HS.create(1,0),r$g.TEMP.identity(),r$Q.ctx.drawTarget(r$R,r$e,r$l,r$T.width,r$T.height,r$g.TEMP,"out",r$d,null,r$W.TOINT.overlay),r$A=r$TS.create([r$R],r$H._recycleScope),r$Q.addRenderObject(r$A),r$p.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=r$T._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=r$T._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=r$T._uint8ArraySlice),!0},r$T.onStageResize=function(r$S,r$Q){null!=r$T.mainContext&&(r$T.mainContext.viewport(0,0,r$S,r$Q),r$zS.width=r$S,r$zS.height=r$Q)},r$T.onInvalidGLRes=function(){r$u.instance.freeAll(),r$v.releaseContentManagers(!0),r$T.doNodeRepaint(r$B.stage),r$T.mainContext.viewport(0,0,r$zS.width,r$zS.height),r$B.stage.event("devicelost")},r$T.doNodeRepaint=function(r$S){0==r$S.numChildren&&r$S.repaint();for(var r$Q=0;r$Q<r$S.numChildren;r$Q++)r$T.doNodeRepaint(r$S.getChildAt(r$Q))},r$T.init=function(r$S,r$Q,r$e){r$T.mainCanvas=r$S,r$R._createContext=function(r$S){return new r$OS(r$S)},r$FS._createContext=function(r$S){return new r$OS(r$S)};var r$l=laya.webgl.WebGL.mainContext;if(null!=r$l.getShaderPrecisionFormat){var r$M=r$l.getShaderPrecisionFormat(35633,36338),r$d=r$l.getShaderPrecisionFormat(35632,36338);r$T.shaderHighPrecision=!(!r$M.precision||!r$d.precision)}else r$T.shaderHighPrecision=!1;if(r$l.deleteTexture1=r$l.deleteTexture,r$l.deleteTexture=function(r$S){r$S==r$DS.curBindTexValue&&(r$DS.curBindTexValue=null),r$l.deleteTexture1(r$S)},r$T.onStageResize(r$Q,r$e),null==r$T.mainContext)throw new Error("webGL getContext err!");r$b.__init__(),r$u.__init__(),r$tS.__init__(),r$dS.__init__(),r$OS.__init__(),r$HS.__init__(),r$s.__init__(),r$KS.__int__(r$l),r$W._init_(r$l),r$G.isConchApp&&conch.setOnInvalidGLRes(r$T.onInvalidGLRes)},r$T.mainCanvas=null,r$T.mainContext=null,r$T.antialias=!0,r$T.shaderHighPrecision=!1,r$T._bg_null=[0,0,0,0],r$T}(),r$DS=function(){function r$l(){}return r$p(r$l,"laya.webgl.WebGLContext"),r$l.UseProgram=function(r$S){return r$l._useProgram!==r$S&&(r$vS.mainContext.useProgram(r$S),r$l._useProgram=r$S,!0)},r$l.setDepthTest=function(r$S,r$Q){r$Q!==r$l._depthTest&&((r$l._depthTest=r$Q)?r$S.enable(2929):r$S.disable(2929))},r$l.setDepthMask=function(r$S,r$Q){r$Q!==r$l._depthMask&&(r$l._depthMask=r$Q,r$S.depthMask(r$Q))},r$l.setDepthFunc=function(r$S,r$Q){r$Q!==r$l._depthFunc&&(r$l._depthFunc=r$Q,r$S.depthFunc(r$Q))},r$l.setBlend=function(r$S,r$Q){r$Q!==r$l._blend&&((r$l._blend=r$Q)?r$S.enable(3042):r$S.disable(3042))},r$l.setBlendFunc=function(r$S,r$Q,r$e){(r$Q!==r$l._sFactor||r$e!==r$l._dFactor)&&(r$l._sFactor=r$Q,r$l._dFactor=r$e,r$S.blendFunc(r$Q,r$e))},r$l.setCullFace=function(r$S,r$Q){r$Q!==r$l._cullFace&&((r$l._cullFace=r$Q)?r$S.enable(2884):r$S.disable(2884))},r$l.setFrontFace=function(r$S,r$Q){r$Q!==r$l._frontFace&&(r$l._frontFace=r$Q,r$S.frontFace(r$Q))},r$l.bindTexture=function(r$S,r$Q,r$e){r$S.bindTexture(r$Q,r$e),r$l.curBindTexTarget=r$Q,r$l.curBindTexValue=r$e},r$l.DEPTH_BUFFER_BIT=256,r$l.STENCIL_BUFFER_BIT=1024,r$l.COLOR_BUFFER_BIT=16384,r$l.POINTS=0,r$l.LINES=1,r$l.LINE_LOOP=2,r$l.LINE_STRIP=3,r$l.TRIANGLES=4,r$l.TRIANGLE_STRIP=5,r$l.TRIANGLE_FAN=6,r$l.ZERO=0,r$l.ONE=1,r$l.SRC_COLOR=768,r$l.ONE_MINUS_SRC_COLOR=769,r$l.SRC_ALPHA=770,r$l.ONE_MINUS_SRC_ALPHA=771,r$l.DST_ALPHA=772,r$l.ONE_MINUS_DST_ALPHA=773,r$l.DST_COLOR=774,r$l.ONE_MINUS_DST_COLOR=775,r$l.SRC_ALPHA_SATURATE=776,r$l.FUNC_ADD=32774,r$l.BLEND_EQUATION=32777,r$l.BLEND_EQUATION_RGB=32777,r$l.BLEND_EQUATION_ALPHA=34877,r$l.FUNC_SUBTRACT=32778,r$l.FUNC_REVERSE_SUBTRACT=32779,r$l.BLEND_DST_RGB=32968,r$l.BLEND_SRC_RGB=32969,r$l.BLEND_DST_ALPHA=32970,r$l.BLEND_SRC_ALPHA=32971,r$l.CONSTANT_COLOR=32769,r$l.ONE_MINUS_CONSTANT_COLOR=32770,r$l.CONSTANT_ALPHA=32771,r$l.ONE_MINUS_CONSTANT_ALPHA=32772,r$l.BLEND_COLOR=32773,r$l.ARRAY_BUFFER=34962,r$l.ELEMENT_ARRAY_BUFFER=34963,r$l.ARRAY_BUFFER_BINDING=34964,r$l.ELEMENT_ARRAY_BUFFER_BINDING=34965,r$l.STREAM_DRAW=35040,r$l.STATIC_DRAW=35044,r$l.DYNAMIC_DRAW=35048,r$l.BUFFER_SIZE=34660,r$l.BUFFER_USAGE=34661,r$l.CURRENT_VERTEX_ATTRIB=34342,r$l.FRONT=1028,r$l.BACK=1029,r$l.CULL_FACE=2884,r$l.FRONT_AND_BACK=1032,r$l.BLEND=3042,r$l.DITHER=3024,r$l.STENCIL_TEST=2960,r$l.DEPTH_TEST=2929,r$l.SCISSOR_TEST=3089,r$l.POLYGON_OFFSET_FILL=32823,r$l.SAMPLE_ALPHA_TO_COVERAGE=32926,r$l.SAMPLE_COVERAGE=32928,r$l.NO_ERROR=0,r$l.INVALID_ENUM=1280,r$l.INVALID_VALUE=1281,r$l.INVALID_OPERATION=1282,r$l.OUT_OF_MEMORY=1285,r$l.CW=2304,r$l.CCW=2305,r$l.LINE_WIDTH=2849,r$l.ALIASED_POINT_SIZE_RANGE=33901,r$l.ALIASED_LINE_WIDTH_RANGE=33902,r$l.CULL_FACE_MODE=2885,r$l.FRONT_FACE=2886,r$l.DEPTH_RANGE=2928,r$l.DEPTH_WRITEMASK=2930,r$l.DEPTH_CLEAR_VALUE=2931,r$l.DEPTH_FUNC=2932,r$l.STENCIL_CLEAR_VALUE=2961,r$l.STENCIL_FUNC=2962,r$l.STENCIL_FAIL=2964,r$l.STENCIL_PASS_DEPTH_FAIL=2965,r$l.STENCIL_PASS_DEPTH_PASS=2966,r$l.STENCIL_REF=2967,r$l.STENCIL_VALUE_MASK=2963,r$l.STENCIL_WRITEMASK=2968,r$l.STENCIL_BACK_FUNC=34816,r$l.STENCIL_BACK_FAIL=34817,r$l.STENCIL_BACK_PASS_DEPTH_FAIL=34818,r$l.STENCIL_BACK_PASS_DEPTH_PASS=34819,r$l.STENCIL_BACK_REF=36003,r$l.STENCIL_BACK_VALUE_MASK=36004,r$l.STENCIL_BACK_WRITEMASK=36005,r$l.VIEWPORT=2978,r$l.SCISSOR_BOX=3088,r$l.COLOR_CLEAR_VALUE=3106,r$l.COLOR_WRITEMASK=3107,r$l.UNPACK_ALIGNMENT=3317,r$l.PACK_ALIGNMENT=3333,r$l.MAX_TEXTURE_SIZE=3379,r$l.MAX_VIEWPORT_DIMS=3386,r$l.SUBPIXEL_BITS=3408,r$l.RED_BITS=3410,r$l.GREEN_BITS=3411,r$l.BLUE_BITS=3412,r$l.ALPHA_BITS=3413,r$l.DEPTH_BITS=3414,r$l.STENCIL_BITS=3415,r$l.POLYGON_OFFSET_UNITS=10752,r$l.POLYGON_OFFSET_FACTOR=32824,r$l.TEXTURE_BINDING_2D=32873,r$l.SAMPLE_BUFFERS=32936,r$l.SAMPLES=32937,r$l.SAMPLE_COVERAGE_VALUE=32938,r$l.SAMPLE_COVERAGE_INVERT=32939,r$l.NUM_COMPRESSED_TEXTURE_FORMATS=34466,r$l.COMPRESSED_TEXTURE_FORMATS=34467,r$l.DONT_CARE=4352,r$l.FASTEST=4353,r$l.NICEST=4354,r$l.GENERATE_MIPMAP_HINT=33170,r$l.BYTE=5120,r$l.UNSIGNED_BYTE=5121,r$l.SHORT=5122,r$l.UNSIGNED_SHORT=5123,r$l.INT=5124,r$l.UNSIGNED_INT=5125,r$l.FLOAT=5126,r$l.DEPTH_COMPONENT=6402,r$l.ALPHA=6406,r$l.RGB=6407,r$l.RGBA=6408,r$l.LUMINANCE=6409,r$l.LUMINANCE_ALPHA=6410,r$l.UNSIGNED_SHORT_4_4_4_4=32819,r$l.UNSIGNED_SHORT_5_5_5_1=32820,r$l.UNSIGNED_SHORT_5_6_5=33635,r$l.FRAGMENT_SHADER=35632,r$l.VERTEX_SHADER=35633,r$l.MAX_VERTEX_ATTRIBS=34921,r$l.MAX_VERTEX_UNIFORM_VECTORS=36347,r$l.MAX_VARYING_VECTORS=36348,r$l.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,r$l.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,r$l.MAX_TEXTURE_IMAGE_UNITS=34930,r$l.MAX_FRAGMENT_UNIFORM_VECTORS=36349,r$l.SHADER_TYPE=35663,r$l.DELETE_STATUS=35712,r$l.LINK_STATUS=35714,r$l.VALIDATE_STATUS=35715,r$l.ATTACHED_SHADERS=35717,r$l.ACTIVE_UNIFORMS=35718,r$l.ACTIVE_ATTRIBUTES=35721,r$l.SHADING_LANGUAGE_VERSION=35724,r$l.CURRENT_PROGRAM=35725,r$l.NEVER=512,r$l.LESS=513,r$l.EQUAL=514,r$l.LEQUAL=515,r$l.GREATER=516,r$l.NOTEQUAL=517,r$l.GEQUAL=518,r$l.ALWAYS=519,r$l.KEEP=7680,r$l.REPLACE=7681,r$l.INCR=7682,r$l.DECR=7683,r$l.INVERT=5386,r$l.INCR_WRAP=34055,r$l.DECR_WRAP=34056,r$l.VENDOR=7936,r$l.RENDERER=7937,r$l.VERSION=7938,r$l.NEAREST=9728,r$l.LINEAR=9729,r$l.NEAREST_MIPMAP_NEAREST=9984,r$l.LINEAR_MIPMAP_NEAREST=9985,r$l.NEAREST_MIPMAP_LINEAR=9986,r$l.LINEAR_MIPMAP_LINEAR=9987,r$l.TEXTURE_MAG_FILTER=10240,r$l.TEXTURE_MIN_FILTER=10241,r$l.TEXTURE_WRAP_S=10242,r$l.TEXTURE_WRAP_T=10243,r$l.TEXTURE_2D=3553,r$l.TEXTURE=5890,r$l.TEXTURE_CUBE_MAP=34067,r$l.TEXTURE_BINDING_CUBE_MAP=34068,r$l.TEXTURE_CUBE_MAP_POSITIVE_X=34069,r$l.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,r$l.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,r$l.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,r$l.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,r$l.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,r$l.MAX_CUBE_MAP_TEXTURE_SIZE=34076,r$l.TEXTURE0=33984,r$l.TEXTURE1=33985,r$l.TEXTURE2=33986,r$l.TEXTURE3=33987,r$l.TEXTURE4=33988,r$l.TEXTURE5=33989,r$l.TEXTURE6=33990,r$l.TEXTURE7=33991,r$l.TEXTURE8=33992,r$l.TEXTURE9=33993,r$l.TEXTURE10=33994,r$l.TEXTURE11=33995,r$l.TEXTURE12=33996,r$l.TEXTURE13=33997,r$l.TEXTURE14=33998,r$l.TEXTURE15=33999,r$l.TEXTURE16=34e3,r$l.TEXTURE17=34001,r$l.TEXTURE18=34002,r$l.TEXTURE19=34003,r$l.TEXTURE20=34004,r$l.TEXTURE21=34005,r$l.TEXTURE22=34006,r$l.TEXTURE23=34007,r$l.TEXTURE24=34008,r$l.TEXTURE25=34009,r$l.TEXTURE26=34010,r$l.TEXTURE27=34011,r$l.TEXTURE28=34012,r$l.TEXTURE29=34013,r$l.TEXTURE30=34014,r$l.TEXTURE31=34015,r$l.ACTIVE_TEXTURE=34016,r$l.REPEAT=10497,r$l.CLAMP_TO_EDGE=33071,r$l.MIRRORED_REPEAT=33648,r$l.FLOAT_VEC2=35664,r$l.FLOAT_VEC3=35665,r$l.FLOAT_VEC4=35666,r$l.INT_VEC2=35667,r$l.INT_VEC3=35668,r$l.INT_VEC4=35669,r$l.BOOL=35670,r$l.BOOL_VEC2=35671,r$l.BOOL_VEC3=35672,r$l.BOOL_VEC4=35673,r$l.FLOAT_MAT2=35674,r$l.FLOAT_MAT3=35675,r$l.FLOAT_MAT4=35676,r$l.SAMPLER_2D=35678,r$l.SAMPLER_CUBE=35680,r$l.VERTEX_ATTRIB_ARRAY_ENABLED=34338,r$l.VERTEX_ATTRIB_ARRAY_SIZE=34339,r$l.VERTEX_ATTRIB_ARRAY_STRIDE=34340,r$l.VERTEX_ATTRIB_ARRAY_TYPE=34341,r$l.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,r$l.VERTEX_ATTRIB_ARRAY_POINTER=34373,r$l.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,r$l.COMPILE_STATUS=35713,r$l.LOW_FLOAT=36336,r$l.MEDIUM_FLOAT=36337,r$l.HIGH_FLOAT=36338,r$l.LOW_INT=36339,r$l.MEDIUM_INT=36340,r$l.HIGH_INT=36341,r$l.FRAMEBUFFER=36160,r$l.RENDERBUFFER=36161,r$l.RGBA4=32854,r$l.RGB5_A1=32855,r$l.RGB565=36194,r$l.DEPTH_COMPONENT16=33189,r$l.STENCIL_INDEX=6401,r$l.STENCIL_INDEX8=36168,r$l.DEPTH_STENCIL=34041,r$l.RENDERBUFFER_WIDTH=36162,r$l.RENDERBUFFER_HEIGHT=36163,r$l.RENDERBUFFER_INTERNAL_FORMAT=36164,r$l.RENDERBUFFER_RED_SIZE=36176,r$l.RENDERBUFFER_GREEN_SIZE=36177,r$l.RENDERBUFFER_BLUE_SIZE=36178,r$l.RENDERBUFFER_ALPHA_SIZE=36179,r$l.RENDERBUFFER_DEPTH_SIZE=36180,r$l.RENDERBUFFER_STENCIL_SIZE=36181,r$l.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,r$l.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,r$l.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,r$l.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,r$l.COLOR_ATTACHMENT0=36064,r$l.DEPTH_ATTACHMENT=36096,r$l.STENCIL_ATTACHMENT=36128,r$l.DEPTH_STENCIL_ATTACHMENT=33306,r$l.NONE=0,r$l.FRAMEBUFFER_COMPLETE=36053,r$l.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,r$l.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,r$l.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,r$l.FRAMEBUFFER_UNSUPPORTED=36061,r$l.FRAMEBUFFER_BINDING=36006,r$l.RENDERBUFFER_BINDING=36007,r$l.MAX_RENDERBUFFER_SIZE=34024,r$l.INVALID_FRAMEBUFFER_OPERATION=1286,r$l.UNPACK_FLIP_Y_WEBGL=37440,r$l.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,r$l.CONTEXT_LOST_WEBGL=37442,r$l.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,r$l.BROWSER_DEFAULT_WEBGL=37444,r$l._useProgram=null,r$l._depthTest=!0,r$l._depthMask=!0,r$l._blend=!1,r$l._cullFace=!1,r$l.curBindTexTarget=null,r$l.curBindTexValue=null,r$T(r$l,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),r$l}(),r$BS=function(r$S){function r$Q(){r$Q.__super.call(this)}r$p(r$Q,"laya.webgl.display.GraphicsGL",r$U);var r$e=r$Q.prototype;return r$e.setShader=function(r$S){this._saveToCmd(r$G.context._setShader,[r$S])},r$e.setIBVB=function(r$S,r$Q,r$e,r$l,r$M,r$d){this._saveToCmd(r$G.context._setIBVB,[r$S,r$Q,r$e,r$l,r$M,r$d])},r$e.drawParticle=function(r$S,r$Q,r$e){var r$l=r$D.createParticleTemplate2D(r$e);r$l.x=r$S,r$l.y=r$Q,this._saveToCmd(r$G.context._drawParticle,[r$l])},r$Q}(),r$OS=function(r$S){var r$e;function r$w(r$S){this._x=0,this._y=0,this._id=++r$w._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,r$w.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=r$w.MAXCLIPRECT,this.mOutPoint,this._canvas=r$S,this._canvas._addReference(),r$w._contextcount++,r$G.isFlash?(this._ib=r$sS.create(35044),r$cS.fillIBQuadrangle(this._ib,16)):this._ib=r$sS.QuadrangleIB,this.clear()}r$p(r$w,"laya.webgl.canvas.WebGLContext2D",r$M);var r$Q=r$w.prototype;return r$Q.setIsMainContext=function(){this._isMain=!0},r$Q.clearBG=function(r$S,r$Q,r$e,r$l){var r$M=r$vS.mainContext;r$M.clearColor(r$S,r$Q,r$e,r$l),r$M.clear(16384)},r$Q._getSubmits=function(){return this._submits},r$Q._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var r$S=0,r$Q=this._submits._length;r$S<r$Q;r$S++)this._submits[r$S].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},r$Q.destroy=function(){--r$w._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=r$sS.QuadrangleIB&&this._ib.releaseResource()},r$Q.clear=function(){this._submits||(this._other=r$e.DEFAULT,this._curMat=r$g.create(),this._vb=r$yS.create(-1),this._submits=[],this._save=[r$C.Create(this)],this._save.length=10,this._shader2D=new r$s,this._triangleMesh=r$$S.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=r$e.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=r$w.MAXCLIPRECT,this._curSubmit=r$dS.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=r$x.DEFAULT;for(var r$S=0,r$Q=this._submits._length;r$S<r$Q;r$S++)this._submits[r$S].releaseRender(),this._submits[r$S]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},r$Q.size=function(r$S,r$Q){if(this._width!=r$S||this._height!=r$Q)if(0==r$S||0==r$Q){0!=this._vb._byteLength&&(this._width=r$S,this._height=r$Q,this._vb.clear(),this._vb.upload());for(var r$e=0,r$l=this._submits._length;r$e<r$l;r$e++)this._submits[r$e].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=r$S,this._height=r$Q,this._targets&&this._targets.size(r$S,r$Q),this._canvas.memorySize-=this._canvas.memorySize;0===r$S&&0===r$Q&&this._releaseMem()},r$Q._getTransformMatrix=function(){return this._curMat},r$Q.translate=function(r$S,r$Q){0===r$S&&0===r$Q||(r$V.save(this),this._curMat.bTransform&&(r$K.save(this),this._curMat.transformPointN(r$I.TEMP.setTo(r$S,r$Q)),r$S=r$I.TEMP.x,r$Q=r$I.TEMP.y),this._x+=r$S,this._y+=r$Q)},r$Q.save=function(){this._save[this._save._length++]=r$C.Create(this)},r$Q.restore=function(){var r$S=this._save._length;if(!(r$S<1))for(var r$Q=r$S-1;0<=r$Q;r$Q--){var r$e=this._save[r$Q];if(r$e.restore(this),r$e.isSaveMark())return void(this._save._length=r$Q)}},r$Q._fillText=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){void 0===r$R&&(r$R=0);var r$o=this._shader2D,r$Y=this._curSubmit.shaderValue,r$p=r$M?r$LS.create(r$M):this._other.font;if(r$u.enabled)r$o.ALPHA!==r$Y.ALPHA&&(r$o.glTexture=null),r$JS.drawText(this,r$S,r$Q,this._curMat,r$p,r$i||this._other.textAlign,r$d,r$T,r$U,r$e,r$l,r$R);else{this._shader2D.defines.getValue();var r$J=r$d?r$L.create(r$d)._color:r$o.colorAdd;r$o.ALPHA===r$Y.ALPHA&&r$J===r$o.colorAdd&&r$Y.colorAdd===r$o.colorAdd||(r$o.glTexture=null,r$o.colorAdd=r$J),r$JS.drawText(this,r$S,r$Q,this._curMat,r$p,r$i||this._other.textAlign,r$d,r$T,r$U,r$e,r$l,r$R)}},r$Q.fillWords=function(r$S,r$Q,r$e,r$l,r$M,r$d){this._fillText(null,r$S,r$Q,r$e,r$l,r$M,null,-1,null,r$d)},r$Q.fillBorderWords=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this._fillBorderText(null,r$S,r$Q,r$e,r$l,r$M,r$d,r$T,null)},r$Q.fillText=function(r$S,r$Q,r$e,r$l,r$M,r$d){this._fillText(r$S,null,r$Q,r$e,r$l,r$M,null,-1,r$d)},r$Q.strokeText=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this._fillText(r$S,null,r$Q,r$e,r$l,null,r$M,r$d||1,r$T)},r$Q.fillBorderText=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){this._fillBorderText(r$S,null,r$Q,r$e,r$l,r$M,r$d,r$T,r$U)},r$Q._fillBorderText=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){if(!r$u.enabled)return this._fillText(r$S,r$Q,r$e,r$l,r$M,null,r$T,r$U||1,r$i),void this._fillText(r$S,r$Q,r$e,r$l,r$M,r$d,null,-1,r$i);var r$R=this._shader2D,r$o=this._curSubmit.shaderValue;r$R.ALPHA!==r$o.ALPHA&&(r$R.glTexture=null);var r$Y=r$M?(r$w._fontTemp.setFont(r$M),r$w._fontTemp):this._other.font;r$JS.drawText(this,r$S,r$Q,this._curMat,r$Y,r$i||this._other.textAlign,r$d,r$T,r$U||1,r$e,r$l,0)},r$Q.fillRect=function(r$S,r$Q,r$e,r$l,r$M){var r$d=this._vb;if(r$cS.fillRectImgVb(r$d,this._clipRect,r$S,r$Q,r$e,r$l,r$$.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var r$T=this._shader2D.fillStyle;r$M&&(this._shader2D.fillStyle=r$x.create(r$M));var r$U=this._shader2D,r$i=this._curSubmit.shaderValue;if(r$U.fillStyle!==r$i.fillStyle||r$U.ALPHA!==r$i.ALPHA){r$U.glTexture=null;var r$R=this._curSubmit=r$dS.createSubmit(this,this._ib,r$d,(r$d._byteLength-64)/32*3,r$HS.create(2,0));r$R.shaderValue.color=r$U.fillStyle._color._color,r$R.shaderValue.ALPHA=r$U.ALPHA,this._submits[this._submits._length++]=r$R}this._curSubmit._numEle+=6,this._shader2D.fillStyle=r$T}},r$Q.fillTexture=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){if(r$S.loaded&&r$S.bitmap&&r$S.source){var r$i=this._vb,r$R=r$S.bitmap.width,r$o=r$S.bitmap.height,r$Y=r$S.uv,r$p=r$T.x%r$S.width,r$J=r$T.y%r$S.height;if(r$R!=r$U.w||r$o!=r$U.h){if(!r$U.w&&!r$U.h)switch(r$U.oy=r$U.ox=0,r$d){case"repeat":r$U.width=r$l,r$U.height=r$M;break;case"repeat-x":r$U.width=r$l,r$J<0?r$S.height+r$J>r$M?r$U.height=r$M:r$U.height=r$S.height+r$J:(r$U.oy=r$J,r$S.height+r$J>r$M?r$U.height=r$M-r$J:r$U.height=r$S.height);break;case"repeat-y":r$p<0?r$S.width+r$p>r$l?r$U.width=r$l:r$U.width=r$S.width+r$p:(r$U.ox=r$p,r$S.width+r$p>r$l?r$U.width=r$l-r$p:r$U.width=r$S.width),r$U.height=r$M;break;case"no-repeat":r$p<0?r$S.width+r$p>r$l?r$U.width=r$l:r$U.width=r$S.width+r$p:(r$U.ox=r$p,r$S.width+r$p>r$l?r$U.width=r$l-r$p:r$U.width=r$S.width),r$J<0?r$S.height+r$J>r$M?r$U.height=r$M:r$U.height=r$S.height+r$J:(r$U.oy=r$J,r$S.height+r$J>r$M?r$U.height=r$M-r$J:r$U.height=r$S.height);break;default:r$U.width=r$l,r$U.height=r$M}r$U.w=r$R,r$U.h=r$o,r$U.uv=[0,0,r$U.width/r$R,0,r$U.width/r$R,r$U.height/r$o,0,r$U.height/r$o]}if(r$Q+=r$U.ox,r$e+=r$U.oy,r$p-=r$U.ox,r$J-=r$U.oy,r$cS.fillRectImgVb(r$i,this._clipRect,r$Q,r$e,r$U.width,r$U.height,r$U.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var r$L=r$mS.create(this,this._ib,r$i,(r$i._byteLength-64)/32*3,r$HS.create(256,0)),r$j=(this._submits[this._submits._length++]=r$L).shaderValue;r$j.textureHost=r$S;var r$c=r$Y[0]*r$R,r$G=r$Y[1]*r$o,r$z=(r$Y[2]-r$Y[0])*r$R,r$A=(r$Y[5]-r$Y[3])*r$o,r$v=-r$p/r$R,r$D=-r$J/r$o;r$j.u_TexRange[0]=r$c/r$R,r$j.u_TexRange[1]=r$z/r$R,r$j.u_TexRange[2]=r$G/r$o,r$j.u_TexRange[3]=r$A/r$o,r$j.u_offset[0]=r$v,r$j.u_offset[1]=r$D,r$u.enabled&&!this._isMain&&r$L.addTexture(r$S,(r$i._byteLength>>2)-16),(this._curSubmit=r$L)._renderType=10017,r$L._numEle+=6}}else this.sprite&&r$B.timer.callLater(this,this._repaintSprite)},r$Q.setShader=function(r$S){r$q.save(this,1048576,this._shader2D,!0),this._shader2D.shader=r$S},r$Q.setFilters=function(r$S){r$q.save(this,2097152,this._shader2D,!0),this._shader2D.filters=r$S,this._curSubmit=r$dS.RENDERBASE,this._renderKey=0,this._drawCount++},r$Q.drawTexture=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this._drawTextureM(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,null,1)},r$Q.addTextureVb=function(r$S,r$Q,r$e){var r$l=this._curSubmit._vb||this._vb,r$M=r$l._byteLength>>2;r$l.byteLength=r$M+16<<2;for(var r$d=r$l.getFloat32Array(),r$T=0;r$T<16;r$T+=4)r$d[r$M++]=r$S[r$T]+r$Q,r$d[r$M++]=r$S[r$T+1]+r$e,r$d[r$M++]=r$S[r$T+2],r$d[r$M++]=r$S[r$T+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),r$l._upload=!0},r$Q.willDrawTexture=function(r$S,r$Q){if(!(r$S.loaded&&r$S.bitmap&&r$S.source))return this.sprite&&r$B.timer.callLater(this,this._repaintSprite),0;var r$e=r$S.bitmap,r$l=r$e.id+this._shader2D.ALPHA*r$Q+10016;if(r$l==this._renderKey)return r$l;var r$M=this._shader2D,r$d=r$M.ALPHA,r$T=this._curSubmit.shaderValue;r$M.ALPHA*=r$Q,this._renderKey=r$l,this._drawCount++,r$M.glTexture=r$e;var r$U=this._vb,r$i=null,r$R=r$U._byteLength/32*3,r$o=r$T.textureHost&&r$T.textureHost==r$S&&r$T.textureHost.alphaTexture==r$S.alphaTexture;return r$i=r$mS.create(this,this._ib,r$U,r$R,r$HS.create(1,0)),(this._submits[this._submits._length++]=r$i).shaderValue.textureHost=r$S,r$i._renderType=10016,r$i._preIsSameTextureShader=10016===this._curSubmit._renderType&&r$M.ALPHA===r$T.ALPHA&&r$o,this._curSubmit=r$i,r$M.ALPHA=r$d,r$l},r$Q.drawTextures=function(r$S,r$Q,r$e,r$l){if(r$S.loaded&&r$S.bitmap&&r$S.source){var r$M=this._clipRect;if(this._clipRect=r$w.MAXCLIPRECT,this._drawTextureM(r$S,r$Q[0],r$Q[1],r$S.width,r$S.height,r$e,r$l,null,1)){if(this._clipRect=r$M,r$X.drawCall++,!(r$Q.length<4)){for(var r$d=this._curSubmit._vb||this._vb,r$T=this._curMat.a,r$U=this._curMat.d,r$i=2,r$R=r$Q.length;r$i<r$R;r$i+=2)r$cS.copyPreImgVb(r$d,(r$Q[r$i]-r$Q[r$i-2])*r$T,(r$Q[r$i+1]-r$Q[r$i-1])*r$U),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&r$B.timer.callLater(this,this._repaintSprite)},r$Q._drawTextureM=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){if(!r$S.loaded||!r$S.source)return this.sprite&&r$B.timer.callLater(this,this._repaintSprite),!1;var r$R=this._curSubmit._vb||this._vb,r$o=r$S.bitmap;r$Q+=r$d,r$e+=r$T,this._drawCount++;var r$Y=r$o.id+this._shader2D.ALPHA*r$i+10016;if(r$Y!=this._renderKey){this._renderKey=r$Y;var r$p=this._curSubmit.shaderValue,r$J=this._shader2D,r$L=r$J.ALPHA;r$J.ALPHA*=r$i,r$J.glTexture=r$o;var r$j=this._vb,r$c=null,r$G=r$j._byteLength/32*3,r$z=r$p.textureHost&&r$p.textureHost==r$S&&r$p.textureHost.alphaTexture==r$S.alphaTexture;r$c=r$mS.create(this,this._ib,r$j,r$G,r$HS.create(1,0)),(this._submits[this._submits._length++]=r$c).shaderValue.textureHost=r$S,r$c._renderType=10016,r$c._preIsSameTextureShader=10016===this._curSubmit._renderType&&r$J.ALPHA===r$p.ALPHA&&r$z,this._curSubmit=r$c,r$R=this._curSubmit._vb||this._vb,r$J.ALPHA=r$L}return!!r$cS.fillRectImgVb(r$R,this._clipRect,r$Q,r$e,r$l||r$S.width,r$M||r$S.height,r$S.uv,r$U||this._curMat,this._x,this._y,0,0)&&(r$u.enabled&&!this._isMain&&this._curSubmit.addTexture(r$S,(r$R._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},r$Q._repaintSprite=function(){this.sprite&&this.sprite.repaint()},r$Q._drawText=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){var r$o=r$S.bitmap;this._drawCount++;var r$Y=r$o.id+this._shader2D.ALPHA+10016;if(r$Y!=this._renderKey){this._renderKey=r$Y;var r$p=this._curSubmit.shaderValue,r$J=this._shader2D;r$J.glTexture=r$o;var r$L=this._vb,r$j=null,r$c=r$L._byteLength/32*3,r$G=r$p.textureHost&&r$p.textureHost==r$S&&r$p.textureHost.alphaTexture==r$S.alphaTexture;(r$j=r$u.enabled?r$mS.create(this,this._ib,r$L,r$c,r$HS.create(1,0)):r$mS.create(this,this._ib,r$L,r$c,r$VS.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&r$J.ALPHA===r$p.ALPHA&&r$G,(this._submits[this._submits._length++]=r$j).shaderValue.textureHost=r$S,r$j._renderType=10016,this._curSubmit=r$j}r$S.active();var r$z=this._curSubmit._vb||this._vb;r$cS.fillRectImgVb(r$z,this._clipRect,r$Q+r$T,r$e+r$U,r$l||r$S.width,r$M||r$S.height,r$S.uv,r$d||this._curMat,this._x,this._y,r$i,r$R,!0)&&(r$u.enabled&&!this._isMain&&this._curSubmit.addTexture(r$S,(r$z._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},r$Q.drawTextureWithTransform=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){if(r$d){var r$R=this._curMat,r$o=this._x,r$Y=this._y;(0!==r$T||0!==r$U)&&(this._x=r$T*r$R.a+r$U*r$R.c,this._y=r$U*r$R.d+r$T*r$R.b),r$d&&r$R.bTransform?(r$g.mul(r$d,r$R,r$w._tmpMatrix),(r$d=r$w._tmpMatrix)._checkTransform()):(this._x+=r$R.tx,this._y+=r$R.ty),this._drawTextureM(r$S,r$Q,r$e,r$l,r$M,0,0,r$d,r$i),this._x=r$o,this._y=r$Y}else this._drawTextureM(r$S,r$Q,r$e,r$l,r$M,r$T,r$U,null,r$i)},r$Q.fillQuadrangle=function(r$S,r$Q,r$e,r$l,r$M){var r$d=this._curSubmit,r$T=this._vb,r$U=this._shader2D,r$i=r$d.shaderValue;if(this._renderKey=0,r$S.bitmap){var r$R=r$S.bitmap;r$U.glTexture==r$R&&r$U.ALPHA===r$i.ALPHA||(r$U.glTexture=r$R,(r$d=this._curSubmit=r$dS.createSubmit(this,this._ib,r$T,r$T._byteLength/32*3,r$HS.create(1,0))).shaderValue.glTexture=r$R,this._submits[this._submits._length++]=r$d),r$cS.fillQuadrangleImgVb(r$T,r$Q,r$e,r$l,r$S.uv,r$M||this._curMat,this._x,this._y)}else r$d.shaderValue.fillStyle&&r$d.shaderValue.fillStyle.equal(r$S)&&r$U.ALPHA===r$i.ALPHA||(r$U.glTexture=null,(r$d=this._curSubmit=r$dS.createSubmit(this,this._ib,r$T,r$T._byteLength/32*3,r$HS.create(2,0))).shaderValue.defines.add(2),r$d.shaderValue.fillStyle=r$x.create(r$S),this._submits[this._submits._length++]=r$d),r$cS.fillQuadrangleImgVb(r$T,r$Q,r$e,r$l,r$$.DEF_UV,r$M||this._curMat,this._x,this._y);r$d._numEle+=6},r$Q.drawTexture2=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){if(0!=r$d){var r$i=this._curMat;if(this._x=r$S*r$i.a+r$Q*r$i.c,this._y=r$Q*r$i.d+r$S*r$i.b,r$M&&(r$M=r$i.bTransform||r$M.bTransform?(r$g.mul(r$M,r$i,r$w._tmpMatrix),r$w._tmpMatrix):(this._x+=r$M.tx+r$i.tx,this._y+=r$M.ty+r$i.ty,r$g.EMPTY)),1!==r$d||r$T){var r$R=this._shader2D.ALPHA,r$o=this._nBlendType;this._shader2D.ALPHA=r$d,r$T&&(this._nBlendType=r$W.TOINT(r$T)),this._drawTextureM(r$U[0],r$U[1]-r$e,r$U[2]-r$l,r$U[3],r$U[4],0,0,r$M,1),this._shader2D.ALPHA=r$R,this._nBlendType=r$o}else this._drawTextureM(r$U[0],r$U[1]-r$e,r$U[2]-r$l,r$U[3],r$U[4],0,0,r$M,1);this._x=this._y=0}},r$Q.drawCanvas=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$S.context;if(this._renderKey=0,r$d._targets)this._submits[this._submits._length++]=r$bS.create(r$d,0,null),this._curSubmit=r$dS.RENDERBASE,r$d._targets.drawTo(this,r$Q,r$e,r$l,r$M);else{var r$T=this._submits[this._submits._length++]=r$bS.create(r$d,this._shader2D.ALPHA,this._shader2D.filters),r$U=r$l/r$S.width,r$i=r$M/r$S.height,r$R=r$T._matrix;this._curMat.copyTo(r$R),1!=r$U&&1!=r$i&&r$R.scale(r$U,r$i);var r$o=r$R.tx,r$Y=r$R.ty;r$R.tx=r$R.ty=0,r$R.transformPoint(r$I.TEMP.setTo(r$Q,r$e)),r$R.translate(r$I.TEMP.x+r$o,r$I.TEMP.y+r$Y),this._curSubmit=r$dS.RENDERBASE}r$O.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=r$d._targets?"yellow":"green",this.strokeRect(r$Q-1,r$e-1,r$l+2,r$M+2,1),this.strokeRect(r$Q,r$e,r$l,r$M,1),this.restore())},r$Q.drawTarget=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){void 0===r$R&&(r$R=-1);var r$o=this._vb;if(r$cS.fillRectImgVb(r$o,this._clipRect,r$Q,r$e,r$l,r$M,r$i||r$$.DEF_UV,r$d||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var r$Y=this._curSubmit=r$YS.create(this,this._ib,r$o,(r$o._byteLength-64)/32*3,r$U,r$T);r$Y.blendType=-1==r$R?this._nBlendType:r$R,r$Y.scope=r$S,this._submits[this._submits._length++]=r$Y,this._curSubmit._numEle+=6}},r$Q.mixRGBandAlpha=function(r$S){return this._mixRGBandAlpha(r$S,this._shader2D.ALPHA)},r$Q._mixRGBandAlpha=function(r$S,r$Q){var r$e=(4278190080&r$S)>>>24;return 0!=r$e?r$e*=r$Q:r$e=255*r$Q,16777215&r$S|r$e<<24},r$Q.drawTriangles=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){if(!r$S.loaded||!r$S.source)return this.sprite&&r$B.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;r$S.bitmap;var r$o=this._mixRGBandAlpha(4294967295,r$U),r$Y=(r$l.length,r$d.length);this._renderKey=-1;var r$p=this._curSubmit=r$mS.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,r$HS.create(1,0));return r$p.shaderValue.textureHost=r$S,r$p._renderType=10016,this._submits[this._submits._length++]=r$p,r$T?(r$w._tmpMatrix.a=r$T.a,r$w._tmpMatrix.b=r$T.b,r$w._tmpMatrix.c=r$T.c,r$w._tmpMatrix.d=r$T.d,r$w._tmpMatrix.tx=r$T.tx+r$Q,r$w._tmpMatrix.ty=r$T.ty+r$e,r$g.mul(r$w._tmpMatrix,this._curMat,r$w._tmpMatrix)):(r$w._tmpMatrix.a=this._curMat.a,r$w._tmpMatrix.b=this._curMat.b,r$w._tmpMatrix.c=this._curMat.c,r$w._tmpMatrix.d=this._curMat.d,r$w._tmpMatrix.tx=this._curMat.tx+r$Q,r$w._tmpMatrix.ty=this._curMat.ty+r$e),this._triangleMesh.addData(r$l,r$M,r$d,r$w._tmpMatrix,r$o,this),this._curSubmit._numEle+=r$Y,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},r$Q.transform=function(r$S,r$Q,r$e,r$l,r$M,r$d){r$K.save(this),r$g.mul(r$g.TEMP.setTo(r$S,r$Q,r$e,r$l,r$M,r$d),this._curMat,this._curMat),this._curMat._checkTransform()},r$Q.setTransformByMatrix=function(r$S){r$S.copyTo(this._curMat)},r$Q.transformByMatrix=function(r$S){r$K.save(this),r$g.mul(r$S,this._curMat,this._curMat),this._curMat._checkTransform()},r$Q.rotate=function(r$S){r$K.save(this),this._curMat.rotateEx(r$S)},r$Q.scale=function(r$S,r$Q){r$K.save(this),this._curMat.scaleEx(r$S,r$Q)},r$Q.clipRect=function(r$S,r$Q,r$e,r$l){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var r$M=r$oS.create(4);this.addRenderObject(r$M);var r$d=this._vb,r$T=r$d._byteLength>>2;if(r$cS.fillRectImgVb(r$d,null,r$S,r$Q,r$e,r$l,r$$.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var r$U=this._curSubmit=r$dS.createSubmit(this,this._ib,r$d,(r$d._byteLength-64)/32*3,r$HS.create(2,0));r$U.shaderValue.ALPHA=1,this._submits[this._submits._length++]=r$U,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var r$i=r$oS.create(5);this.addRenderObject(r$i);var r$R=r$d.getFloat32Array(),r$o=Math.min(Math.min(Math.min(r$R[0+r$T],r$R[4+r$T]),r$R[8+r$T]),r$R[12+r$T]),r$Y=Math.max(Math.max(Math.max(r$R[0+r$T],r$R[4+r$T]),r$R[8+r$T]),r$R[12+r$T]),r$p=Math.min(Math.min(Math.min(r$R[1+r$T],r$R[5+r$T]),r$R[9+r$T]),r$R[13+r$T]),r$J=Math.max(Math.max(Math.max(r$R[1+r$T],r$R[5+r$T]),r$R[9+r$T]),r$R[13+r$T]);r$N.save(this,r$i,r$S,r$Q,r$e,r$l,r$o,r$p,r$Y-r$o,r$J-r$p),this._curSubmit=r$dS.RENDERBASE}else{r$e*=this._curMat.a,r$l*=this._curMat.d;var r$L=r$I.TEMP;this._curMat.transformPoint(r$L.setTo(r$S,r$Q)),r$e<0&&(r$L.x=r$L.x+r$e,r$e=-r$e),r$l<0&&(r$L.y=r$L.y+r$l,r$l=-r$l),this._renderKey=0;var r$j=this._curSubmit=r$RS.create(this);(this._submits[this._submits._length++]=r$j).submitIndex=this._submits._length,r$j.submitLength=9999999,r$Z.save(this,r$j);var r$c=this._clipRect,r$G=r$c.x,r$z=r$c.y,r$A=r$L.x+r$e,r$v=r$L.y+r$l;r$G<r$L.x&&(r$c.x=r$L.x),r$z<r$L.y&&(r$c.y=r$L.y),r$c.width=Math.min(r$A,r$G+r$c.width)-r$c.x,r$c.height=Math.min(r$v,r$z+r$c.height)-r$c.y,this._shader2D.glTexture=null,r$j.clipRect.copyFrom(r$c),this._curSubmit=r$dS.RENDERBASE}},r$Q.setIBVB=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o){if(void 0===r$i&&(r$i=0),void 0===r$R&&(r$R=0),void 0===r$o&&(r$o=0),null===r$e){if(r$G.isFlash){var r$Y=r$l;r$Y._selfIB||(r$Y._selfIB=r$sS.create(35044)),r$Y._selfIB.clear(),r$e=r$Y._selfIB}else r$e=this._ib;r$cS.expandIBQuadrangle(r$e,r$l._byteLength/(4*r$l.vertexStride*4))}if(!r$U||!r$T)throw Error("setIBVB must input:shader shaderValues");var r$p=r$iS.create(this,r$l,r$e,r$M,r$T,r$U,r$i,r$R,r$o);r$d||(r$d=r$g.EMPTY),r$d.translate(r$S,r$Q),r$g.mul(r$d,this._curMat,r$p._mat),r$d.translate(-r$S,-r$Q),this._submits[this._submits._length++]=r$p,this._curSubmit=r$dS.RENDERBASE,this._renderKey=0},r$Q.addRenderObject=function(r$S){this._submits[this._submits._length++]=r$S},r$Q.fillTrangles=function(r$S,r$Q,r$e,r$l,r$M){var r$d=this._curSubmit,r$T=this._vb,r$U=this._shader2D,r$i=r$d.shaderValue,r$R=r$l.length>>4,r$o=r$S.bitmap;this._renderKey=0,r$U.glTexture==r$o&&r$U.ALPHA===r$i.ALPHA||((r$d=this._curSubmit=r$dS.createSubmit(this,this._ib,r$T,r$T._byteLength/32*3,r$HS.create(1,0))).shaderValue.textureHost=r$S,this._submits[this._submits._length++]=r$d),r$cS.fillTranglesVB(r$T,r$Q,r$e,r$l,r$M||this._curMat,this._x,this._y),r$d._numEle+=6*r$R},r$Q.submitElement=function(r$S,r$Q){var r$e=this._submits;for(r$Q<0&&(r$Q=r$e._length);r$S<r$Q;)r$S+=r$e[r$S].renderSubmit()},r$Q.finish=function(){r$vS.mainContext.finish()},r$Q.flush=function(){var r$S=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(r$S>this._ib.bufferLength/12&&r$cS.expandIBQuadrangle(this._ib,r$S),!this._isMain&&r$u.enabled&&r$u._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=r$u._atlasRestore;for(var r$Q=this._submits,r$e=0,r$l=r$Q._length;r$e<r$l;r$e++){var r$M=r$Q[r$e];10016===r$M.getRenderType()&&r$M.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),r$QS.instance&&r$QS.getInstance().reset();var r$d;for(r$e=0,r$d=this.meshlist.length;r$e<r$d;r$e++){var r$T=this.meshlist[r$e];r$T.canReuse?r$T.releaseMesh():r$T.destroy()}return this.meshlist.length=0,this._curSubmit=r$dS.RENDERBASE,this._renderKey=0,this._triangleMesh=r$$S.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},r$Q.setPathId=function(r$S){if(this.mId=r$S,-1!=this.mId){this.mHaveKey=!1;var r$Q=r$P.getInstance();r$Q.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,r$Q.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},r$Q.movePath=function(r$S,r$Q){var r$e=r$S,r$l=r$Q;r$S=this._curMat.a*r$e+this._curMat.c*r$l+this._curMat.tx,r$Q=this._curMat.b*r$e+this._curMat.d*r$l+this._curMat.ty,this.mX+=r$S,this.mY+=r$Q},r$Q.beginPath=function(){var r$S=this._getPath();r$S.tempArray.length=0,r$S.closePath=!1,this.mX=0,this.mY=0},r$Q.closePath=function(){this._path.closePath=!0},r$Q.fill=function(r$S){void 0===r$S&&(r$S=!1);var r$Q=this._getPath();this.drawPoly(0,0,r$Q.tempArray,this.fillStyle._color.numColor,0,0,r$S)},r$Q.stroke=function(){var r$S=this._getPath();if(0<this.lineWidth){if(-1==this.mId)r$S.drawLine(0,0,r$S.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var r$Q=r$P.getInstance().shapeLineDic[this.mId];r$Q.rebuild(r$S.tempArray),r$S.setGeomtry(r$Q)}else r$P.getInstance().addLine(this.mId,r$S.drawLine(0,0,r$S.tempArray,this.lineWidth,this.strokeStyle._color.numColor));r$S.update();var r$e=[this.mX,this.mY],r$l=r$dS.createShape(this,r$S.ib,r$S.vb,r$S.count,r$S.offset,r$HS.create(4,0));r$l.shaderValue.ALPHA=this._shader2D.ALPHA,r$l.shaderValue.u_pos=r$e,r$l.shaderValue.u_mmat2=r$zS.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=r$l,this._renderKey=-1}},r$Q.line=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=this._curSubmit,r$U=this._vb;if(r$cS.fillLineVb(r$U,this._clipRect,r$S,r$Q,r$e,r$l,r$M,r$d)){this._renderKey=0;var r$i=this._shader2D,r$R=r$T.shaderValue;r$i.strokeStyle===r$R.strokeStyle&&r$i.ALPHA===r$R.ALPHA||(r$i.glTexture=null,(r$T=this._curSubmit=r$dS.createSubmit(this,this._ib,r$U,(r$U._byteLength-64)/32*3,r$HS.create(2,0))).shaderValue.strokeStyle=r$i.strokeStyle,r$T.shaderValue.mainID=2,r$T.shaderValue.ALPHA=r$i.ALPHA,this._submits[this._submits._length++]=r$T),r$T._numEle+=6}},r$Q.moveTo=function(r$S,r$Q,r$e){void 0===r$e&&(r$e=!0);var r$l=this._getPath();if(r$e){var r$M=r$S,r$d=r$Q;r$S=this._curMat.a*r$M+this._curMat.c*r$d,r$Q=this._curMat.b*r$M+this._curMat.d*r$d}r$l.addPoint(r$S,r$Q)},r$Q.lineTo=function(r$S,r$Q,r$e){void 0===r$e&&(r$e=!0);var r$l=this._getPath();if(r$e){var r$M=r$S,r$d=r$Q;r$S=this._curMat.a*r$M+this._curMat.c*r$d,r$Q=this._curMat.b*r$M+this._curMat.d*r$d}r$l.addPoint(r$S,r$Q)},r$Q.drawCurves=function(r$S,r$Q,r$e){this.setPathId(-1),this.beginPath(),this.strokeStyle=r$e[3],this.lineWidth=r$e[4];var r$l=r$e[2];r$S+=r$e[0],r$Q+=r$e[1],this.movePath(r$S,r$Q),this.moveTo(r$l[0],r$l[1]);for(var r$M=2,r$d=r$l.length;r$M<r$d;)this.quadraticCurveTo(r$l[r$M++],r$l[r$M++],r$l[r$M++],r$l[r$M++]);this.stroke()},r$Q.arcTo=function(r$S,r$Q,r$e,r$l,r$M){if(-1==this.mId||!this.mHaveKey){var r$d=0,r$T=0,r$U=0,r$i=this._getPath();this._curMat.copyTo(r$w._tmpMatrix),r$w._tmpMatrix.tx=r$w._tmpMatrix.ty=0,r$w._tempPoint.setTo(r$i.getEndPointX(),r$i.getEndPointY()),r$w._tmpMatrix.invertTransformPoint(r$w._tempPoint);var r$R=r$w._tempPoint.x-r$S,r$o=r$w._tempPoint.y-r$Q,r$Y=Math.sqrt(r$R*r$R+r$o*r$o);if(!(r$Y<=1e-6)){var r$p=r$R/r$Y,r$J=r$o/r$Y,r$L=r$e-r$S,r$j=r$l-r$Q,r$c=r$L*r$L+r$j*r$j,r$G=Math.sqrt(r$c);if(!(r$G<=1e-6)){var r$z=r$L/r$G,r$A=r$j/r$G,r$v=r$p+r$z,r$D=r$J+r$A,r$B=Math.sqrt(r$v*r$v+r$D*r$D);if(!(r$B<=1e-6)){var r$O=r$v/r$B,r$H=r$D/r$B,r$g=Math.acos(r$O*r$p+r$H*r$J),r$I=Math.PI/2-r$g,r$E=(r$Y=r$M/Math.tan(r$I))*r$p+r$S,r$t=r$Y*r$J+r$Q,r$k=Math.sqrt(r$Y*r$Y+r$M*r$M),r$X=r$S+r$O*r$k,r$h=r$Q+r$H*r$k,r$b=0,r$m=0;if(0<=r$p*r$A-r$J*r$z){var r$$=2*r$I/r$w.SEGNUM;r$b=Math.sin(r$$),r$m=Math.cos(r$$)}else r$$=2*-r$I/r$w.SEGNUM,r$b=Math.sin(r$$),r$m=Math.cos(r$$);r$T=this._curMat.a*r$E+this._curMat.c*r$t,r$U=this._curMat.b*r$E+this._curMat.d*r$t,r$T==this._path.getEndPointX()&&r$U==this._path.getEndPointY()||r$i.addPoint(r$T,r$U);var r$n=r$E-r$X,r$P=r$t-r$h;for(r$d=0;r$d<r$w.SEGNUM;r$d++){var r$a=r$n*r$m+r$P*r$b,r$f=-r$n*r$b+r$P*r$m;r$T=r$a+r$X,r$U=r$f+r$h,r$S=this._curMat.a*r$T+this._curMat.c*r$U,r$U=r$Q=this._curMat.b*r$T+this._curMat.d*r$U,(r$T=r$S)==this._path.getEndPointX()&&r$U==this._path.getEndPointY()||r$i.addPoint(r$T,r$U),r$n=r$a,r$P=r$f}}}}}},r$Q.arc=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){if(void 0===r$d&&(r$d=!1),void 0===r$T&&(r$T=!0),-1!=this.mId){var r$U=r$P.getInstance().shapeDic[this.mId];if(r$U&&this.mHaveKey&&!r$U.needUpdate(this._curMat))return;r$Q=r$S=0}var r$i,r$R=0,r$o=0,r$Y=0,r$p=0,r$J=0,r$L=0,r$j=0;if(r$o=r$M-r$l,r$d)if(Math.abs(r$o)>=2*Math.PI)r$o=2*-Math.PI;else for(;0<r$o;)r$o-=2*Math.PI;else if(Math.abs(r$o)>=2*Math.PI)r$o=2*Math.PI;else for(;r$o<0;)r$o+=2*Math.PI;r$i=r$o/(r$j=r$e<101?Math.max(10,r$o*r$e/5):r$e<201?Math.max(10,r$o*r$e/20):Math.max(10,r$o*r$e/40))/2,r$Y=Math.abs(4/3*(1-Math.cos(r$i))/Math.sin(r$i)),r$d&&(r$Y=-r$Y);var r$c=this._getPath(),r$G=NaN,r$z=NaN;for(r$L=0;r$L<=r$j;r$L++)r$R=r$l+r$o*(r$L/r$j),r$p=r$S+Math.cos(r$R)*r$e,r$J=r$Q+Math.sin(r$R)*r$e,r$T&&(r$G=r$p,r$z=r$J,r$p=this._curMat.a*r$G+this._curMat.c*r$z,r$J=this._curMat.b*r$G+this._curMat.d*r$z),r$p==this._path.getEndPointX()&&r$J==this._path.getEndPointY()||r$c.addPoint(r$p,r$J);r$p=r$S+Math.cos(r$M)*r$e,r$J=r$Q+Math.sin(r$M)*r$e,r$T&&(r$G=r$p,r$z=r$J,r$p=this._curMat.a*r$G+this._curMat.c*r$z,r$J=this._curMat.b*r$G+this._curMat.d*r$z),r$p==this._path.getEndPointX()&&r$J==this._path.getEndPointY()||r$c.addPoint(r$p,r$J)},r$Q.quadraticCurveTo=function(r$S,r$Q,r$e,r$l){var r$M=r$Y.I,r$d=r$e,r$T=r$l;r$e=this._curMat.a*r$d+this._curMat.c*r$T,r$l=this._curMat.b*r$d+this._curMat.d*r$T,r$d=r$S,r$T=r$Q,r$S=this._curMat.a*r$d+this._curMat.c*r$T,r$Q=this._curMat.b*r$d+this._curMat.d*r$T;for(var r$U=r$M.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),r$S,r$Q,r$e,r$l],30,2),r$i=0,r$R=r$U.length/2;r$i<r$R;r$i++)this.lineTo(r$U[2*r$i],r$U[2*r$i+1],!1);this.lineTo(r$e,r$l,!1)},r$Q.rect=function(r$S,r$Q,r$e,r$l){this._other=this._other.make(),this._other.path||(this._other.path=new r$F),this._other.path.rect(r$S,r$Q,r$e,r$l)},r$Q.strokeRect=function(r$S,r$Q,r$e,r$l,r$M){var r$d=.5*r$M;this.line(r$S-r$d,r$Q,r$S+r$e+r$d,r$Q,r$M,this._curMat),this.line(r$S+r$e,r$Q,r$S+r$e,r$Q+r$l,r$M,this._curMat),this.line(r$S,r$Q,r$S,r$Q+r$l,r$M,this._curMat),this.line(r$S-r$d,r$Q+r$l,r$S+r$e+r$d,r$Q+r$l,r$M,this._curMat)},r$Q.clip=function(){},r$Q.drawPoly=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){void 0===r$T&&(r$T=!1),this._renderKey=0,this._shader2D.glTexture=null;var r$U=this._getPath();if(-1==this.mId)r$U.polygon(r$S,r$Q,r$e,r$l,r$M||1,r$d);else if(this.mHaveKey){var r$i=r$P.getInstance().shapeDic[this.mId];r$i.setMatrix(this._curMat),r$i.rebuild(r$U.tempArray),r$U.setGeomtry(r$i)}else{var r$R=r$U.polygon(r$S,r$Q,r$e,r$l,r$M||1,r$d);r$P.getInstance().addShape(this.mId,r$R),r$R.setMatrix(this._curMat)}r$U.update();var r$o,r$Y=[this.mX,this.mY];if((r$o=r$dS.createShape(this,r$U.ib,r$U.vb,r$U.count,r$U.offset,r$HS.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,r$o.shaderValue.u_pos=r$Y,r$o.shaderValue.u_mmat2=r$zS.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=r$o,0<r$M){if(this.mHaveLineKey){var r$p=r$P.getInstance().shapeLineDic[this.mId];r$p.rebuild(r$U.tempArray),r$U.setGeomtry(r$p)}else r$P.getInstance().addShape(this.mId,r$U.drawLine(r$S,r$Q,r$e,r$M,r$d));r$U.update(),(r$o=r$dS.createShape(this,r$U.ib,r$U.vb,r$U.count,r$U.offset,r$HS.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,r$o.shaderValue.u_mmat2=r$zS.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=r$o}},r$Q.drawParticle=function(r$S,r$Q,r$e){r$e.x=r$S,r$e.y=r$Q,this._submits[this._submits._length++]=r$e},r$Q._getPath=function(){return this._path||(this._path=new r$F)},r$l(0,r$Q,"globalCompositeOperation",function(){return r$W.NAMES[this._nBlendType]},function(r$S){var r$Q=r$W.TOINT[r$S];null==r$Q||this._nBlendType===r$Q||(r$q.save(this,65536,this,!0),this._curSubmit=r$dS.RENDERBASE,this._renderKey=0,this._nBlendType=r$Q)}),r$l(0,r$Q,"strokeStyle",function(){return this._shader2D.strokeStyle},function(r$S){this._shader2D.strokeStyle.equal(r$S)||(r$q.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=r$x.create(r$S))}),r$l(0,r$Q,"globalAlpha",function(){return this._shader2D.ALPHA},function(r$S){(r$S=Math.floor(1e3*r$S)/1e3)!=this._shader2D.ALPHA&&(r$q.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=r$S)}),r$l(0,r$Q,"asBitmap",null,function(r$S){if(r$S){if(this._targets||(this._targets=new r$_),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),r$l(0,r$Q,"fillStyle",function(){return this._shader2D.fillStyle},function(r$S){this._shader2D.fillStyle.equal(r$S)||(r$q.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=r$x.create(r$S))}),r$l(0,r$Q,"textAlign",function(){return this._other.textAlign},function(r$S){this._other.textAlign===r$S||(this._other=this._other.make(),r$q.save(this,32768,this._other,!1),this._other.textAlign=r$S)}),r$l(0,r$Q,"lineWidth",function(){return this._other.lineWidth},function(r$S){this._other.lineWidth===r$S||(this._other=this._other.make(),r$q.save(this,256,this._other,!1),this._other.lineWidth=r$S)}),r$l(0,r$Q,"textBaseline",function(){return this._other.textBaseline},function(r$S){this._other.textBaseline===r$S||(this._other=this._other.make(),r$q.save(this,16384,this._other,!1),this._other.textBaseline=r$S)}),r$l(0,r$Q,"font",null,function(r$S){r$S!=this._other.font.toString()&&(this._other=this._other.make(),r$q.save(this,8,this._other,!1),this._other.font===r$LS.EMPTY?this._other.font=new r$LS(r$S):this._other.font.setFont(r$S))}),r$w.__init__=function(){r$e.DEFAULT=new r$e},r$w._tempPoint=new r$I,r$w._SUBMITVBSIZE=32e3,r$w._MAXSIZE=99999999,r$w._RECTVBSIZE=16,r$w.MAXCLIPRECT=new r$E(0,0,99999999,99999999),r$w._COUNT=0,r$w._tmpMatrix=new r$g,r$w.SEGNUM=32,r$w._contextcount=0,r$T(r$w,["_fontTemp",function(){return this._fontTemp=new r$LS},"_drawStyleTemp",function(){return this._drawStyleTemp=new r$x(null)}]),r$w.__init$=function(){r$e=function(){function r$S(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=r$LS.EMPTY}r$p(r$S,"");var r$Q=r$S.prototype;return r$Q.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=r$LS.EMPTY},r$Q.make=function(){return this===r$S.DEFAULT?new r$S:this},r$S.DEFAULT=null,r$S}()},r$w}(),r$HS=function(r$S){function r$l(r$S,r$Q){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,r$l.__super.call(this),this.defines=new r$tS,this.position=r$l._POSITION,this.mainID=r$S,this.subID=r$Q,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=r$S|r$Q,this._inClassCache=r$l._cache[this._cacheID],0<r$S&&!this._inClassCache&&(this._inClassCache=r$l._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}r$p(r$l,"laya.webgl.shader.d2.value.Value2D",r$f);var r$Q=r$l.prototype;return r$Q.setValue=function(r$S){},r$Q.refresh=function(){var r$S=this.size;return r$S[0]=r$zS.width,r$S[1]=r$zS.height,this.alpha=this.ALPHA*r$zS.worldAlpha,this.mmat=r$zS.worldMatrix4,this},r$Q._ShaderWithCompile=function(){return r$CS.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,r$_S.create)},r$Q._withWorldShaderDefines=function(){var r$S=r$zS.worldShaderDefines,r$Q=r$CS.sharders[this.mainID|this.defines._value|r$S.getValue()];if(!r$Q){var r$e,r$l={};for(r$e in this.defines.toNameDic())r$l[r$e]="";for(r$e in r$S.toNameDic())r$l[r$e]="";r$Q=r$CS.withCompile2D(0,this.mainID,r$l,this.mainID|this.defines._value|r$S.getValue(),r$_S.create)}var r$M=r$zS.worldFilters;if(!r$M)return r$Q;for(var r$d,r$T=r$M.length,r$U=0;r$U<r$T;r$U++)(r$d=r$M[r$U])&&r$d.action.setValue(this);return r$Q},r$Q.upload=function(){var r$S=r$zS;this.alpha=this.ALPHA*r$S.worldAlpha,r$zS.worldMatrix4!==r$zS.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),r$vS.shaderHighPrecision&&this.defines.add(1024);var r$Q,r$e=r$S.worldShaderDefines?this._withWorldShaderDefines():r$CS.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=r$S.width,this.size[1]=r$S.height,this.mmat=r$S.worldMatrix4,r$nS.activeShader!==r$e?r$e._shaderValueWidth!==r$S.width||r$e._shaderValueHeight!==r$S.height?(r$e._shaderValueWidth=r$S.width,r$e._shaderValueHeight=r$S.height):r$Q=r$e._params2dQuick2||r$e._make2dQuick2():r$e._shaderValueWidth!==r$S.width||r$e._shaderValueHeight!==r$S.height?(r$e._shaderValueWidth=r$S.width,r$e._shaderValueHeight=r$S.height):r$Q=r$e._params2dQuick1||r$e._make2dQuick1(),r$e.upload(this,r$Q)},r$Q.setFilters=function(r$S){if(this.filters=r$S)for(var r$Q,r$e=r$S.length,r$l=0;r$l<r$e;r$l++)(r$Q=r$S[r$l])&&(this.defines.add(r$Q.type),r$Q.action.setValue(this))},r$Q.clear=function(){this.defines.setValue(this.subID)},r$Q.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},r$l._initone=function(r$S,r$Q){r$l._typeClass[r$S]=r$Q,r$l._cache[r$S]=[],r$l._cache[r$S]._length=0},r$l.__init__=function(){r$l._POSITION=[2,5126,!1,4*r$jS.BYTES_PE,0],r$l._TEXCOORD=[2,5126,!1,4*r$jS.BYTES_PE,2*r$jS.BYTES_PE],r$l._initone(2,r$wS),r$l._initone(4,r$WS),r$l._initone(256,r$uS),r$l._initone(512,r$fS),r$l._initone(1,r$rS),r$l._initone(65,r$VS),r$l._initone(9,r$rS)},r$l.create=function(r$S,r$Q){var r$e=r$l._cache[r$S|r$Q];return r$e._length?r$e[--r$e._length]:new r$l._typeClass[r$S|r$Q](r$Q)},r$l._POSITION=null,r$l._TEXCOORD=null,r$l._cache=[],r$l._typeClass=[],r$l.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r$l}(),r$gS=function(r$S){function r$c(r$S,r$Q){r$c.__super.call(this,r$S,r$Q)}r$p(r$c,"laya.webgl.utils.RenderSprite3D",r$z);var r$Q=r$c.prototype;return r$Q.onCreate=function(r$S){switch(r$S){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},r$Q._mask=function(r$S,r$Q,r$e,r$l){var r$M,r$d,r$T=this._next,r$U=r$S.mask;if(r$U){r$Q.ctx.save();var r$i=r$Q.ctx.globalCompositeOperation,r$R=new r$E;if(r$R.copyFrom(r$U.getBounds()),r$R.width=Math.round(r$R.width),r$R.height=Math.round(r$R.height),r$R.x=Math.round(r$R.x),r$R.y=Math.round(r$R.y),0<r$R.width&&0<r$R.height){var r$o=r$S._style._tf,r$Y=r$US.create();r$Y.addValue("bounds",r$R),r$M=r$TS.create([r$Y,r$Q],laya.webgl.utils.RenderSprite3D.tmpTarget),r$Q.addRenderObject(r$M),r$U.render(r$Q,-r$R.x,-r$R.y),r$M=r$TS.create([r$Y],laya.webgl.utils.RenderSprite3D.endTmpTarget),r$Q.addRenderObject(r$M),r$Q.ctx.save(),r$Q.clipRect(r$e-r$o.translateX+r$R.x,r$l-r$o.translateY+r$R.y,r$R.width,r$R.height),r$T._fun.call(r$T,r$S,r$Q,r$e,r$l),r$Q.ctx.restore(),r$d=r$oS.create(6),r$i=r$Q.ctx.globalCompositeOperation,r$d.blendMode="mask",r$Q.addRenderObject(r$d),r$g.TEMP.identity();var r$p=r$HS.create(1,0),r$J=r$$.INV_UV,r$L=r$R.width,r$j=r$R.height;(r$R.width<32||r$R.height<32)&&((r$J=r$c.tempUV)[0]=0,r$J[1]=0,r$J[2]=32<=r$R.width?1:r$R.width/32,r$J[3]=0,r$J[4]=32<=r$R.width?1:r$R.width/32,r$J[5]=32<=r$R.height?1:r$R.height/32,r$J[6]=0,r$J[7]=32<=r$R.height?1:r$R.height/32,r$R.width=32<=r$R.width?r$R.width:32,r$R.height=32<=r$R.height?r$R.height:32,r$J[1]*=-1,r$J[3]*=-1,r$J[5]*=-1,r$J[7]*=-1,r$J[1]+=1,r$J[3]+=1,r$J[5]+=1,r$J[7]+=1),r$Q.ctx.drawTarget(r$Y,r$e+r$R.x-r$o.translateX,r$l+r$R.y-r$o.translateY,r$L,r$j,r$g.TEMP,"tmpTarget",r$p,r$J,6),r$M=r$TS.create([r$Y],laya.webgl.utils.RenderSprite3D.recycleTarget),r$Q.addRenderObject(r$M),(r$d=r$oS.create(6)).blendMode=r$i,r$Q.addRenderObject(r$d)}r$Q.ctx.restore()}else r$T._fun.call(r$T,r$S,r$Q,r$e,r$l)},r$Q._blend=function(r$S,r$Q,r$e,r$l){var r$M=r$S._style,r$d=this._next;r$M.blendMode?(r$Q.ctx.save(),r$Q.ctx.globalCompositeOperation=r$M.blendMode,r$d._fun.call(r$d,r$S,r$Q,r$e,r$l),r$Q.ctx.restore()):r$d._fun.call(r$d,r$S,r$Q,r$e,r$l)},r$Q._transform=function(r$S,r$Q,r$e,r$l){var r$M=r$S.transform,r$d=this._next;if(r$M&&r$d!=r$z.NORENDER){var r$T=r$Q.ctx;r$S._style;r$M.tx=r$e,r$M.ty=r$l;var r$U=r$T._getTransformMatrix(),r$i=r$U.clone();r$g.mul(r$M,r$U,r$U),r$U._checkTransform(),r$M.tx=r$M.ty=0,r$d._fun.call(r$d,r$S,r$Q,0,0),r$i.copyTo(r$U),r$i.destroy()}else r$d._fun.call(r$d,r$S,r$Q,r$e,r$l)},r$c.tmpTarget=function(r$S,r$Q){var r$e=r$S.getValue("bounds"),r$l=r$PS.create(r$e.width,r$e.height);r$l.start(),r$l.clear(0,0,0,0),r$S.addValue("tmpTarget",r$l)},r$c.endTmpTarget=function(r$S){r$S.getValue("tmpTarget").end()},r$c.recycleTarget=function(r$S){r$S.getValue("tmpTarget").recycle(),r$S.recycle()},r$T(r$c,["tempUV",function(){return this.tempUV=new Array(8)}]),r$c}(),r$IS=function(r$S){function r$Q(){this.data=null,r$Q.__super.call(this)}r$p(r$Q,"laya.filters.webgl.ColorFilterActionGL",r$a);var r$e=r$Q.prototype;return r$B.imps(r$e,{"laya.filters.IFilterActionGL":!0}),r$e.setValue=function(r$S){r$S.colorMat=this.data._mat,r$S.colorAlpha=this.data._alpha},r$e.apply3d=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$S.getValue("bounds"),r$T=r$HS.create(1,0);r$T.setFilters([this.data]);var r$U=r$g.TEMP;r$U.identity(),r$e.ctx.drawTarget(r$S,0,0,r$d.width,r$d.height,r$U,"src",r$T)},r$Q}(),r$ES=function(r$S){function r$d(r$S,r$Q,r$e,r$l,r$M){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,r$d.__super.call(this,r$S,r$Q,r$M),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new r$xS,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=r$e,this._atlasCanvas.height=r$l,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}r$p(r$d,"laya.webgl.atlas.Atlaser",r$w);var r$Q=r$d.prototype;return r$Q.computeUVinAtlasTexture=function(r$S,r$Q,r$e,r$l){var r$M=r$u.atlasTextureWidth,r$d=r$u.atlasTextureHeight,r$T=r$e/r$M,r$U=r$l/r$d,r$i=(r$e+r$S.bitmap.width)/r$M,r$R=(r$l+r$S.bitmap.height)/r$d,r$o=r$S.bitmap.width/r$M,r$Y=r$S.bitmap.height/r$d;r$S.uv=[r$T+r$Q[0]*r$o,r$U+r$Q[1]*r$Y,r$i-(1-r$Q[2])*r$o,r$U+r$Q[3]*r$Y,r$i-(1-r$Q[4])*r$o,r$R-(1-r$Q[5])*r$Y,r$T+r$Q[6]*r$o,r$R-(1-r$Q[7])*r$Y]},r$Q.findBitmapIsExist=function(r$S){if(r$S instanceof laya.webgl.resource.WebGLImage){var r$Q=r$S,r$e=r$Q.url,r$l=this._InAtlasWebGLImagesKey[r$e||r$Q.id];if(r$l)return r$l.offsetInfoID}return-1},r$Q.addToAtlasTexture=function(r$S,r$Q,r$e){if(r$S instanceof laya.webgl.resource.WebGLImage){var r$l=r$S,r$M=r$l.url;this._InAtlasWebGLImagesKey[r$M||r$l.id]={bitmap:r$S,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([r$Q,r$e])}this._atlasCanvas.texSubImage2D(r$Q,r$e,r$S.atlasSource),r$S.clearAtlasSource()},r$Q.addToAtlas=function(r$S,r$Q,r$e){r$S._atlasID=this._inAtlasTextureKey.length;var r$l=r$S.uv.slice(),r$M=r$S.bitmap;this._inAtlasTextureKey.push(r$S),this._inAtlasTextureOriUVValue.push(r$l),this._inAtlasTextureBitmapValue.push(r$M),this.computeUVinAtlasTexture(r$S,r$l,r$Q,r$e),r$S.bitmap=this._atlasCanvas},r$Q.clear=function(){for(var r$S=0,r$Q=this._inAtlasTextureKey.length;r$S<r$Q;r$S++)this._inAtlasTextureKey[r$S].bitmap=this._inAtlasTextureBitmapValue[r$S],this._inAtlasTextureKey[r$S].uv=this._inAtlasTextureOriUVValue[r$S],this._inAtlasTextureKey[r$S]._atlasID=-1,this._inAtlasTextureKey[r$S].bitmap.lock=!1,this._inAtlasTextureKey[r$S].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},r$Q.dispose=function(){this.clear(),this._atlasCanvas.destroy()},r$l(0,r$Q,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),r$l(0,r$Q,"texture",function(){return this._atlasCanvas}),r$l(0,r$Q,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),r$d}(),r$tS=function(r$S){function r$e(){r$e.__super.call(this,r$e.__name2int,r$e.__int2name,r$e.__int2nameMap)}return r$p(r$e,"laya.webgl.shader.d2.ShaderDefines2D",r$y),r$e.__init__=function(){r$e.reg("TEXTURE2D",1),r$e.reg("COLOR2D",2),r$e.reg("PRIMITIVE",4),r$e.reg("GLOW_FILTER",8),r$e.reg("BLUR_FILTER",16),r$e.reg("COLOR_FILTER",32),r$e.reg("COLOR_ADD",64),r$e.reg("WORLDMAT",128),r$e.reg("FILLTEXTURE",256),r$e.reg("FSHIGHPRECISION",1024),r$e.reg("TXTALPHA",2048),r$e.reg("TXTCOMPRESS",4096)},r$e.reg=function(r$S,r$Q){r$y._reg(r$S,r$Q,r$e.__name2int,r$e.__int2name)},r$e.toText=function(r$S,r$Q,r$e){return r$y._toText(r$S,r$Q,r$e)},r$e.toInt=function(r$S){return r$y._toInt(r$S,r$e.__name2int)},r$e.TEXTURE2D=1,r$e.COLOR2D=2,r$e.PRIMITIVE=4,r$e.FILTERGLOW=8,r$e.FILTERBLUR=16,r$e.FILTERCOLOR=32,r$e.COLORADD=64,r$e.WORLDMAT=128,r$e.FILLTEXTURE=256,r$e.SKINMESH=512,r$e.SHADERDEFINE_FSHIGHPRECISION=1024,r$e.TXTALPHA=2048,r$e.TXTCOMPRESS=4096,r$e.__name2int={},r$e.__int2name=[],r$e.__int2nameMap=[],r$e}(),r$kS=(function(r$S){function r$U(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){r$U.__super.call(this,r$S,r$Q,r$e,r$l,40,r$M,r$d,r$T)}r$p(r$U,"laya.webgl.shapes.Ellipse",r$eS)}(),function(r$S){function r$d(r$S,r$Q,r$e,r$l,r$M){this._points=[],this.rebuild(r$e),r$d.__super.call(this,r$S,r$Q,0,0,0,r$M,r$l,r$M,0)}r$p(r$d,"laya.webgl.shapes.Line",r$eS);var r$Q=r$d.prototype;return r$Q.rebuild=function(r$S){var r$Q=r$S.length;r$Q!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(r$Q/2-1)),this.mFloat32Array=new Float32Array(5*r$Q)),this._points.length=0;for(var r$e=NaN,r$l=NaN,r$M=-1,r$d=-1,r$T=r$S.length/2,r$U=0;r$U<r$T;r$U++)r$e=r$S[2*r$U],r$l=r$S[2*r$U+1],(.01<Math.abs(r$M-r$e)||.01<Math.abs(r$d-r$l))&&this._points.push(r$e,r$l),r$M=r$e,r$d=r$l},r$Q.getData=function(r$S,r$Q,r$e){var r$l=[],r$M=[];0<this.borderWidth&&this.createLine2(this._points,r$l,this.borderWidth,r$e,r$M,this._points.length/2),this.mUint16Array.set(r$l,0),this.mFloat32Array.set(r$M,0),r$S.append(this.mUint16Array),r$Q.append(this.mFloat32Array)},r$d}()),r$XS=function(r$S){function r$Y(r$S,r$Q,r$e,r$l,r$M){this._points=[];for(var r$d=NaN,r$T=NaN,r$U=-1,r$i=-1,r$R=r$e.length/2-1,r$o=0;r$o<r$R;r$o++)r$d=r$e[2*r$o],r$T=r$e[2*r$o+1],(.01<Math.abs(r$U-r$d)||.01<Math.abs(r$i-r$T))&&this._points.push(r$d,r$T),r$U=r$d,r$i=r$T;r$d=r$e[2*r$R],r$T=r$e[2*r$R+1],r$U=this._points[0],r$i=this._points[1],(.01<Math.abs(r$U-r$d)||.01<Math.abs(r$i-r$T))&&this._points.push(r$d,r$T),r$Y.__super.call(this,r$S,r$Q,0,0,this._points.length/2,0,r$l,r$M)}r$p(r$Y,"laya.webgl.shapes.LoopLine",r$eS);var r$Q=r$Y.prototype;return r$Q.getData=function(r$S,r$Q,r$e){if(0<this.borderWidth){for(var r$l=this.color,r$M=(r$l>>16&255)/255,r$d=(r$l>>8&255)/255,r$T=(255&r$l)/255,r$U=[],r$i=0,r$R=0,r$o=[],r$Y=Math.floor(this._points.length/2),r$p=0;r$p<r$Y;r$p++)r$i=this._points[2*r$p],r$R=this._points[2*r$p+1],r$U.push(this.x+r$i,this.y+r$R,r$M,r$d,r$T);this.createLoopLine(r$U,r$o,this.borderWidth,r$e+r$U.length/5),r$S.append(new Uint16Array(r$o)),r$Q.append(new Float32Array(r$U))}},r$Q.createLoopLine=function(r$S,r$Q,r$e,r$l,r$M,r$d){r$S.length;var r$T=r$S.concat(),r$U=r$M||r$S,r$i=this.borderColor,r$R=(r$i>>16&255)/255,r$o=(r$i>>8&255)/255,r$Y=(255&r$i)/255,r$p=[r$T[0],r$T[1]],r$J=[r$T[r$T.length-5],r$T[r$T.length-4]],r$L=r$J[0]+.5*(r$p[0]-r$J[0]),r$j=r$J[1]+.5*(r$p[1]-r$J[1]);r$T.unshift(r$L,r$j,0,0,0),r$T.push(r$L,r$j,0,0,0);var r$c,r$G,r$z,r$A,r$v,r$D,r$B,r$O,r$H,r$g,r$I,r$E,r$t,r$k,r$X,r$h,r$b,r$m,r$$,r$n,r$P=r$T.length/5,r$a=r$l,r$f=r$e/2;r$z=r$T[0],r$A=r$T[1],r$g=r$z-(r$v=r$T[5]),r$H=(r$H=-(r$A-(r$D=r$T[6])))/(r$n=Math.sqrt(r$H*r$H+r$g*r$g))*r$f,r$g=r$g/r$n*r$f,r$U.push(r$z-r$H,r$A-r$g,r$R,r$o,r$Y,r$z+r$H,r$A+r$g,r$R,r$o,r$Y);for(var r$w=1;r$w<r$P-1;r$w++)r$z=r$T[5*(r$w-1)],r$A=r$T[5*(r$w-1)+1],r$v=r$T[5*r$w],r$D=r$T[5*r$w+1],r$B=r$T[5*(r$w+1)],r$O=r$T[5*(r$w+1)+1],r$g=r$z-r$v,r$E=r$v-r$B,r$X=(-(r$H=(r$H=-(r$A-r$D))/(r$n=Math.sqrt(r$H*r$H+r$g*r$g))*r$f)+r$z)*(-(r$g=r$g/r$n*r$f)+r$D)-(-r$H+r$v)*(-r$g+r$A),r$m=(-(r$I=(r$I=-(r$D-r$O))/(r$n=Math.sqrt(r$I*r$I+r$E*r$E))*r$f)+r$B)*(-(r$E=r$E/r$n*r$f)+r$D)-(-r$I+r$v)*(-r$E+r$O),r$$=(r$t=-r$g+r$A-(-r$g+r$D))*(r$b=-r$I+r$v-(-r$I+r$B))-(r$h=-r$E+r$O-(-r$E+r$D))*(r$k=-r$H+r$v-(-r$H+r$z)),Math.abs(r$$)<.1?(r$$+=10.1,r$U.push(r$v-r$H,r$D-r$g,r$R,r$o,r$Y,r$v+r$H,r$D+r$g,r$R,r$o,r$Y)):(((r$c=(r$k*r$m-r$b*r$X)/r$$)-r$v)*(r$c-r$v)+((r$G=(r$h*r$X-r$t*r$m)/r$$)-r$D)+(r$G-r$D),r$U.push(r$c,r$G,r$R,r$o,r$Y,r$v-(r$c-r$v),r$D-(r$G-r$D),r$R,r$o,r$Y));r$d&&(r$Q=r$d);var r$u=this.edges+1;for(r$w=1;r$w<r$u;r$w++)r$Q.push(r$a+2*(r$w-1),r$a+2*(r$w-1)+1,r$a+2*r$w+1,r$a+2*r$w+1,r$a+2*r$w,r$a+2*(r$w-1));return r$Q.push(r$a+2*(r$w-1),r$a+2*(r$w-1)+1,r$a+1,r$a+1,r$a,r$a+2*(r$w-1)),r$U},r$Y}(),r$hS=function(r$S){function r$T(r$S,r$Q,r$e,r$l,r$M,r$d){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=r$g.create(),this._points=r$e.slice(0,r$e.length),r$T.__super.call(this,r$S,r$Q,0,0,this._points.length/2,r$l,r$M,r$d)}r$p(r$T,"laya.webgl.shapes.Polygon",r$eS);var r$Q=r$T.prototype;return r$Q.rebuild=function(r$S){this._repaint||(this._points.length=0,this._points=this._points.concat(r$S))},r$Q.setMatrix=function(r$S){r$S.copyTo(this._mat)},r$Q.needUpdate=function(r$S){return this._repaint=this._mat.a==r$S.a&&this._mat.b==r$S.b&&this._mat.c==r$S.c&&this._mat.d==r$S.d&&this._mat.tx==r$S.tx&&this._mat.ty==r$S.ty,!this._repaint},r$Q.getData=function(r$S,r$Q,r$e){var r$l,r$M=0,r$d=this._points,r$T=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=r$e){for(this._start=r$e,r$l=[],r$T=this.earcutTriangles.length,r$M=0;r$M<r$T;r$M++)r$l.push(this.earcutTriangles[r$M]+r$e);this.mUint16Array=new Uint16Array(r$l)}}else{this._start=r$e,r$l=[];var r$U=[],r$i=[],r$R=this.color,r$o=(r$R>>16&255)/255,r$Y=(r$R>>8&255)/255,r$p=(255&r$R)/255;for(r$T=Math.floor(r$d.length/2),r$M=0;r$M<r$T;r$M++)r$U.push(this.x+r$d[2*r$M],this.y+r$d[2*r$M+1],r$o,r$Y,r$p),r$i.push(this.x+r$d[2*r$M],this.y+r$d[2*r$M+1]);for(this.earcutTriangles=r$lS.earcut(r$i,null,2),r$T=this.earcutTriangles.length,r$M=0;r$M<r$T;r$M++)r$l.push(this.earcutTriangles[r$M]+r$e);this.mUint16Array=new Uint16Array(r$l),this.mFloat32Array=new Float32Array(r$U)}r$S.append(this.mUint16Array),r$Q.append(this.mFloat32Array)},r$T}(),r$bS=function(r$S){function r$d(){this._matrix=new r$g,this._matrix4=r$jS.defaultMatrix4.concat(),r$d.__super.call(this,1e4),this.shaderValue=new r$HS(0,0)}r$p(r$d,"laya.webgl.submit.SubmitCanvas",r$dS);var r$Q=r$d.prototype;return r$Q.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var r$S=r$zS.worldAlpha,r$Q=r$zS.worldMatrix4,r$e=r$zS.worldMatrix,r$l=r$zS.worldFilters,r$M=r$zS.worldShaderDefines,r$d=this.shaderValue,r$T=this._matrix,r$U=this._matrix4,r$i=r$g.TEMP;return r$g.mul(r$T,r$e,r$i),r$U[0]=r$i.a,r$U[1]=r$i.b,r$U[4]=r$i.c,r$U[5]=r$i.d,r$U[12]=r$i.tx,r$U[13]=r$i.ty,r$zS.worldMatrix=r$i.clone(),r$zS.worldMatrix4=r$U,r$zS.worldAlpha=r$zS.worldAlpha*r$d.alpha,r$d.filters&&r$d.filters.length&&(r$zS.worldFilters=r$d.filters,r$zS.worldShaderDefines=r$d.defines),this._ctx_src.flush(),r$zS.worldAlpha=r$S,r$zS.worldMatrix4=r$Q,r$zS.worldMatrix.destroy(),r$zS.worldMatrix=r$e,r$zS.worldFilters=r$l,r$zS.worldShaderDefines=r$M,1},r$Q.releaseRender=function(){var r$S=r$d._cache;this._ctx_src=null,r$S[r$S._length++]=this},r$Q.getRenderType=function(){return 10003},r$d.create=function(r$S,r$Q,r$e){var r$l=r$d._cache._length?r$d._cache[--r$d._cache._length]:new r$d;r$l._ctx_src=r$S;var r$M=r$l.shaderValue;return r$M.alpha=r$Q,r$M.defines.setValue(0),r$e&&r$e.length&&r$M.setFilters(r$e),r$l},r$d._cache=((r$d._cache=[])._length=0,r$d._cache),r$d}(),r$mS=function(r$S){function r$R(r$S){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===r$S&&(r$S=1e4),r$R.__super.call(this,r$S)}r$p(r$R,"laya.webgl.submit.SubmitTexture",r$dS);var r$Q=r$R.prototype;return r$Q.releaseRender=function(){var r$S=r$R._cache;(r$S[r$S._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},r$Q.addTexture=function(r$S,r$Q){this._texsID[this._texs.length]=r$S._uvID,this._texs.push(r$S),this._vbPos.push(r$Q)},r$Q.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var r$S=this.shaderValue.textureHost.bitmap;if(null!==r$S)for(var r$Q=this._vb.getFloat32Array(),r$e=0,r$l=this._texs.length;r$e<r$l;r$e++){var r$M=this._texs[r$e];r$M.active();var r$d=r$M.uv;if(this._texsID[r$e]!==r$M._uvID){this._texsID[r$e]=r$M._uvID;var r$T=this._vbPos[r$e];r$Q[r$T+2]=r$d[0],r$Q[r$T+3]=r$d[1],r$Q[r$T+6]=r$d[2],r$Q[r$T+7]=r$d[3],r$Q[r$T+10]=r$d[4],r$Q[r$T+11]=r$d[5],r$Q[r$T+14]=r$d[6],r$Q[r$T+15]=r$d[7],this._vb.setNeedUpload()}r$M.bitmap!==r$S&&(this._isSameTexture=!1)}}},r$Q.renderSubmit=function(){if(0===this._numEle)return r$R._shaderSet=!1,1;var r$S=this.shaderValue.textureHost;if(r$S){var r$Q=r$S.source;if(!r$S.bitmap||!r$Q)return r$R._shaderSet=!1,1;this.shaderValue.texture=r$Q,r$S.alphaTexture&&r$S.alphaTexture.source&&(this.shaderValue.texture1=r$S.alphaTexture.source)}this._vb.bind_upload(this._ib);var r$e=r$vS.mainContext;if(r$W.activeBlendFunction!==this._blendFn&&(r$e.enable(3042),this._blendFn(r$e),r$W.activeBlendFunction=this._blendFn),r$X.drawCall++,r$X.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&r$nS.activeShader&&r$R._shaderSet?(r$nS.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&r$nS.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),r$R._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var r$l=r$S.bitmap,r$M=0,r$d=r$nS.activeShader,r$T=0,r$U=this._texs.length;r$T<r$U;r$T++){var r$i=this._texs[r$T];r$i.bitmap===r$l&&r$T+1!==r$U||(r$d.uploadTexture2D(r$i.source),r$e.drawElements(4,6*(r$T-r$M+1),5123,this._startIdx+6*r$M*r$jS.BYTES_PIDX),r$l=r$i.bitmap,r$M=r$T)}else r$e.drawElements(4,this._numEle,5123,this._startIdx);return 1},r$R.create=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$R._cache._length?r$R._cache[--r$R._cache._length]:new r$R;null==r$e&&((r$e=r$d._selfVb||(r$d._selfVb=r$yS.create(-1))).clear(),r$l=0),r$d._ib=r$Q,r$d._vb=r$e,r$d._startIdx=r$l*r$jS.BYTES_PIDX,r$d._numEle=0;var r$T=r$S._nBlendType;r$d._blendFn=r$S._targets?r$W.targetFns[r$T]:r$W.fns[r$T],r$d.shaderValue=r$M,r$d.shaderValue.setValue(r$S._shader2D);var r$U=r$S._shader2D.filters;return r$U&&r$d.shaderValue.setFilters(r$U),r$d},r$R._cache=((r$R._cache=[])._length=0,r$R._cache),r$R._shaderSet=!0,r$R}(),r$$S=function(r$S){function r$G(){r$G.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}r$p(r$G,"laya.webgl.utils.MeshTexture",r$GS);var r$Q=r$G.prototype;return r$Q.addData=function(r$S,r$Q,r$e,r$l,r$M,r$d){for(var r$T=r$S.length/2,r$U=this._vb.needSize(r$T*r$G.const_stride)>>2,r$i=this._vb.getFloat32Array(),r$R=0,r$o=0;r$o<r$T;r$o++){var r$Y=r$S[r$R],r$p=r$S[r$R+1],r$J=r$Y*r$l.a+r$p*r$l.c+r$l.tx,r$L=r$Y*r$l.b+r$p*r$l.d+r$l.ty;r$i[r$U++]=r$J,r$i[r$U++]=r$L,r$i[r$U++]=r$Q[r$R],r$i[r$U++]=r$Q[r$R+1],r$R+=2}this._vb.setNeedUpload();var r$j=this.vertNum;if(0<r$j){(r$T=r$e.length)>r$G.tmpIdx.length&&(r$G.tmpIdx=new Uint16Array(r$T));for(var r$c=0;r$c<r$T;r$c++)r$G.tmpIdx[r$c]=r$e[r$c]+r$j;this._ib.appendU16Array(r$G.tmpIdx,r$e.length)}else this._ib.append(r$e);this._ib.setNeedUpload(),this.vertNum+=r$T,this.indexNum+=r$e.length},r$Q.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},r$Q.destroy=function(){this._ib.destroy(),this._vb.destroy()},r$G.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new r$G},r$G.const_stride=16,r$G._POOL=[],r$T(r$G,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),r$G}(),r$nS=function(r$S){function r$Q(){r$Q.__super.call(this),this.lock=!0}return r$p(r$Q,"laya.webgl.shader.BaseShader",r$A),r$Q.activeShader=null,r$Q.bindShader=null,r$Q}(),r$PS=function(r$Q){function r$o(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===r$e&&(r$e=6408),void 0===r$l&&(r$l=5121),void 0===r$M&&(r$M=34041),void 0===r$d&&(r$d=!1),void 0===r$T&&(r$T=!1),void 0===r$U&&(r$U=-1),void 0===r$i&&(r$i=-1),this._type=1,this._w=r$S,this._h=r$Q,this._surfaceFormat=r$e,this._surfaceType=r$l,this._depthStencilFormat=r$M,r$G.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=r$d,this._repeat=r$T,this._minFifter=r$U,this._magFifter=r$i,this._createWebGLRenderTarget(),this.bitmap.lock=!0,r$o.__super.call(this,this.bitmap,r$$.INV_UV)}r$p(r$o,"laya.webgl.resource.RenderTarget2D",r$Q);var r$S=r$o.prototype;return r$B.imps(r$S,{"laya.resource.IDispose":!0}),r$S.getType=function(){return this._type},r$S.getTexture=function(){return this},r$S.size=function(r$S,r$Q){this._w==r$S&&this._h==r$Q||(this._w=r$S,this._h=r$Q,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},r$S.release=function(){this.destroy()},r$S.recycle=function(){r$o.POOL.push(this)},r$S.start=function(){var r$S=r$vS.mainContext;return this._preRenderTarget=r$zS.curRenderTarget,r$zS.curRenderTarget=this,r$S.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(r$S.viewport(0,0,this._w,this._h),this._svWidth=r$zS.width,this._svHeight=r$zS.height,r$zS.width=this._w,r$zS.height=this._h,r$nS.activeShader=null),this},r$S.clear=function(r$S,r$Q,r$e,r$l){void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=1);var r$M=r$vS.mainContext;r$M.clearColor(r$S,r$Q,r$e,r$l);var r$d=16384;switch(this._depthStencilFormat){case 33189:r$d|=256;break;case 36168:r$d|=1024;break;case 34041:r$d|=256,r$d|=1024}r$M.clear(r$d)},r$S.end=function(){var r$S=r$vS.mainContext;r$S.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,r$zS.curRenderTarget=this._preRenderTarget,1==this._type?(r$S.viewport(0,0,this._svWidth,this._svHeight),r$zS.width=this._svWidth,r$zS.height=this._svHeight,r$nS.activeShader=null):r$S.viewport(0,0,r$B.stage.width,r$B.stage.height)},r$S.getData=function(r$S,r$Q,r$e,r$l){var r$M=r$vS.mainContext;if(r$M.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===r$M.checkFramebufferStatus(36160)))return r$M.bindFramebuffer(36160,null),null;var r$d=new Uint8Array(this._w*this._h*4);return r$M.readPixels(r$S,r$Q,r$e,r$l,this._surfaceFormat,this._surfaceType,r$d),r$M.bindFramebuffer(36160,null),r$d},r$S.destroy=function(r$S){void 0===r$S&&(r$S=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,r$Q.prototype.destroy.call(this))},r$S.dispose=function(){},r$S._createWebGLRenderTarget=function(){this.bitmap=new r$ZS(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(r$S){this.event("recovered")})},r$l(0,r$S,"surfaceFormat",function(){return this._surfaceFormat}),r$l(0,r$S,"magFifter",function(){return this._magFifter}),r$l(0,r$S,"surfaceType",function(){return this._surfaceType}),r$l(0,r$S,"mipMap",function(){return this._mipMap}),r$l(0,r$S,"depthStencilFormat",function(){return this._depthStencilFormat}),r$l(0,r$S,"minFifter",function(){return this._minFifter}),r$l(0,r$S,"source",function(){return this._alreadyResolved?r$B.superGet(r$$,this,"source"):null}),r$o.create=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){void 0===r$e&&(r$e=6408),void 0===r$l&&(r$l=5121),void 0===r$M&&(r$M=34041),void 0===r$d&&(r$d=!1),void 0===r$T&&(r$T=!1),void 0===r$U&&(r$U=-1),void 0===r$i&&(r$i=-1);var r$R=r$o.POOL.pop();return r$R||(r$R=new r$o(r$S,r$Q)),r$R.bitmap&&r$R._w==r$S&&r$R._h==r$Q&&r$R._surfaceFormat==r$e&&r$R._surfaceType==r$l&&r$R._depthStencilFormat==r$M&&r$R._mipMap==r$d&&r$R._repeat==r$T&&r$R._minFifter==r$U&&r$R._magFifter==r$i||(r$R._w=r$S,r$R._h=r$Q,r$R._surfaceFormat=r$e,r$R._surfaceType=r$l,r$R._depthStencilFormat=r$M,r$G.isConchWebGL&&34041===r$R._depthStencilFormat&&(r$R._depthStencilFormat=33189),r$R._mipMap=r$d,r$R._repeat=r$T,r$R._minFifter=r$U,r$R._magFifter=r$i,r$R.release(),r$R._createWebGLRenderTarget()),r$R},r$o.TYPE2D=1,r$o.TYPE3D=2,r$o.POOL=[],r$o}(r$$),r$aS=function(r$S){function r$Q(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,r$Q.__super.call(this),r$Q._gl=r$vS.mainContext}r$p(r$Q,"laya.webgl.utils.Buffer",r$A);var r$e=r$Q.prototype;return r$e._bind=function(){this.activeResource(),r$Q._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(r$Q._bindVertexBuffer=this._glBuffer),r$Q._gl.bindBuffer(this._bufferType,r$Q._bindActive[this._bufferType]=this._glBuffer),r$nS.activeShader=null)},r$e.recreateResource=function(){this._glBuffer||(this._glBuffer=r$Q._gl.createBuffer()),this.completeCreate()},r$e.disposeResource=function(){this._glBuffer&&(r$vS.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},r$l(0,r$e,"bufferUsage",function(){return this._bufferUsage}),r$Q._gl=null,r$Q._bindActive={},r$Q._bindVertexBuffer=null,r$Q._enableAtributes=[],r$Q}(),r$fS=function(r$S){function r$e(r$S){this.texcoord=null,this.offsetX=300,this.offsetY=0,r$e.__super.call(this,512,0);var r$Q=8*r$jS.BYTES_PE;this.position=[2,5126,!1,r$Q,0],this.texcoord=[2,5126,!1,r$Q,2*r$jS.BYTES_PE],this.color=[4,5126,!1,r$Q,4*r$jS.BYTES_PE]}return r$p(r$e,"laya.webgl.shader.d2.skinAnishader.SkinSV",r$HS),r$e}(),r$wS=function(r$S){function r$Q(r$S){r$Q.__super.call(this,2,0),this.color=[]}return r$p(r$Q,"laya.webgl.shader.d2.value.Color2dSV",r$HS),r$Q.prototype.setValue=function(r$S){r$S.fillStyle&&(this.color=r$S.fillStyle._color._color),r$S.strokeStyle&&(this.color=r$S.strokeStyle._color._color)},r$Q}(),r$uS=function(r$S){function r$Q(r$S){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=r$HS._TEXCOORD,r$Q.__super.call(this,256,0)}r$p(r$Q,"laya.webgl.shader.d2.value.FillTextureSV",r$HS);var r$e=r$Q.prototype;return r$e.setValue=function(r$S){this.ALPHA=r$S.ALPHA,r$S.filters&&this.setFilters(r$S.filters)},r$e.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},r$Q}(),r$rS=function(r$S){function r$Q(r$S){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=r$HS._TEXCOORD,void 0===r$S&&(r$S=0),r$Q.__super.call(this,1,r$S)}r$p(r$Q,"laya.webgl.shader.d2.value.TextureSV",r$HS);var r$e=r$Q.prototype;return r$e.setValue=function(r$S){this.ALPHA=r$S.ALPHA,r$S.filters&&this.setFilters(r$S.filters)},r$e.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},r$Q}(),r$WS=function(r$S){function r$Q(r$S){this.a_color=null,this.u_pos=[0,0],r$Q.__super.call(this,4,0),this.position=[2,5126,!1,5*r$jS.BYTES_PE,0],this.a_color=[3,5126,!1,5*r$jS.BYTES_PE,2*r$jS.BYTES_PE]}return r$p(r$Q,"laya.webgl.shader.d2.value.PrimitiveSV",r$HS),r$Q}(),r$xS=function(r$S){function r$Q(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,r$Q.__super.call(this)}r$p(r$Q,"laya.webgl.atlas.AtlasWebGLCanvas",r$S);var r$e=r$Q.prototype;return r$e.recreateResource=function(){var r$S=r$vS.mainContext,r$Q=this._source=r$S.createTexture(),r$e=r$DS.curBindTexTarget,r$l=r$DS.curBindTexValue;r$DS.bindTexture(r$S,3553,r$Q),r$S.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),r$S.texParameteri(3553,10241,9729),r$S.texParameteri(3553,10240,9729),r$S.texParameteri(3553,10242,33071),r$S.texParameteri(3553,10243,33071),r$e&&r$l&&r$DS.bindTexture(r$S,r$e,r$l),this.memorySize=this._w*this._h*4,this.completeCreate()},r$e.disposeResource=function(){this._source&&(r$vS.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},r$e.texSubImage2D=function(r$S,r$Q,r$e){if(r$G.isFlash){this._flashCacheImage||(this._flashCacheImage=r$j.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var r$l=r$e.bitmapdata;this._flashCacheImage._image.copyPixels(r$l,0,0,r$l.width,r$l.height,r$S,r$Q),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var r$M=r$vS.mainContext,r$d=r$DS.curBindTexTarget,r$T=r$DS.curBindTexValue;r$DS.bindTexture(r$M,3553,this._source),r$M.pixelStorei(37441,!0),0<=r$S-1&&r$M.texSubImage2D(3553,0,r$S-1,r$Q,6408,5121,r$e),r$S+1<=this._w&&r$M.texSubImage2D(3553,0,r$S+1,r$Q,6408,5121,r$e),0<=r$Q-1&&r$M.texSubImage2D(3553,0,r$S,r$Q-1,6408,5121,r$e),r$Q+1<=this._h&&r$M.texSubImage2D(3553,0,r$S,r$Q+1,6408,5121,r$e),r$M.texSubImage2D(3553,0,r$S,r$Q,6408,5121,r$e),r$M.pixelStorei(37441,!1),r$d&&r$T&&r$DS.bindTexture(r$M,r$d,r$T)}},r$e.texSubImage2DPixel=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$vS.mainContext,r$T=r$DS.curBindTexTarget,r$U=r$DS.curBindTexValue;r$DS.bindTexture(r$d,3553,this._source);var r$i=new Uint8Array(r$M.data);r$d.pixelStorei(37441,!0),r$d.texSubImage2D(3553,0,r$S,r$Q,r$e,r$l,6408,5121,r$i),r$d.pixelStorei(37441,!1),r$T&&r$U&&r$DS.bindTexture(r$d,r$T,r$U)},r$l(0,r$e,"width",r$S.prototype._$get_width,function(r$S){this._w=r$S}),r$l(0,r$e,"height",r$S.prototype._$get_height,function(r$S){this._h=r$S}),r$Q}(r$e),r$FS=function(r$S){function r$M(){this.flipY=!0,this.alwaysChange=!1,r$M.__super.call(this)}r$p(r$M,"laya.webgl.resource.WebGLCanvas",r$e);var r$Q=r$M.prototype;return r$Q.getCanvas=function(){return this._canvas},r$Q.clear=function(){this._ctx&&this._ctx.clear()},r$Q.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},r$Q._setContext=function(r$S){this._ctx=r$S},r$Q.getContext=function(r$S,r$Q){return this._ctx?this._ctx:this._ctx=r$M._createContext(this)},r$Q.size=function(r$S,r$Q){this._w==r$S&&this._h==r$Q||(this._w=r$S,this._h=r$Q,this._ctx&&this._ctx.size(r$S,r$Q),this._canvas&&(this._canvas.height=r$Q,this._canvas.width=r$S))},r$Q.activeResource=function(r$S){void 0===r$S&&(r$S=!1),this._source||this.recreateResource()},r$Q.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},r$Q.disposeResource=function(){this._source&&!this.iscpuSource&&(r$vS.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},r$Q.createWebGlTexture=function(){var r$S=r$vS.mainContext;this._canvas;var r$Q=this._source=r$S.createTexture();this.iscpuSource=!1;var r$e=r$DS.curBindTexTarget,r$l=r$DS.curBindTexValue;r$DS.bindTexture(r$S,3553,r$Q),r$S.pixelStorei(37440,this.flipY?1:0),r$M.premulAlpha&&r$S.pixelStorei(37441,!0),r$S.texImage2D(3553,0,6408,6408,5121,this._imgData),r$M.premulAlpha&&r$S.pixelStorei(37441,!1),r$S.texParameteri(3553,10240,9729),r$S.texParameteri(3553,10241,9729),r$S.texParameteri(3553,10242,33071),r$S.texParameteri(3553,10243,33071),r$S.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,r$e&&r$l&&r$DS.bindTexture(r$S,r$e,r$l)},r$Q.reloadCanvasData=function(){var r$S=r$vS.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var r$Q=r$DS.curBindTexTarget,r$e=r$DS.curBindTexValue;r$DS.bindTexture(r$S,3553,this._source),r$M.premulAlpha&&r$S.pixelStorei(37441,!0),r$S.texImage2D(3553,0,6408,6408,5121,this._imgData),r$M.premulAlpha&&r$S.pixelStorei(37441,!1),r$S.pixelStorei(37440,0),r$Q&&r$e&&r$DS.bindTexture(r$S,r$Q,r$e)},r$Q.texSubImage2D=function(r$S,r$Q,r$e){var r$l=r$vS.mainContext,r$M=r$DS.curBindTexTarget,r$d=r$DS.curBindTexValue;r$DS.bindTexture(r$l,3553,this._source),r$l.pixelStorei(37441,!0),r$l.texSubImage2D(3553,0,r$Q,r$e,6408,5121,r$S._source),r$l.pixelStorei(37441,!1),r$M&&r$d&&r$DS.bindTexture(r$l,r$M,r$d)},r$Q.toBase64=function(r$S,r$Q,r$e){var r$l=null;this._canvas&&(r$l=this._canvas.toDataURL(r$S,r$Q)),r$e.call(this,r$l)},r$l(0,r$Q,"context",function(){return this._ctx}),r$l(0,r$Q,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),r$l(0,r$Q,"asBitmap",null,function(r$S){this._ctx&&(this._ctx.asBitmap=r$S)}),r$M._createContext=null,r$M.premulAlpha=!1,r$M}(),r$qS=function(r$S){function r$d(r$S,r$Q){this.CborderSize=12,r$d.__super.call(this),this.char=r$S,this.isSpace=" "===r$S,this.xs=r$Q.scaleX,this.ys=r$Q.scaleY,this.font=r$Q.font.toString(),this.fontSize=r$Q.font.size,this.fillColor=r$Q.fillColor,this.borderColor=r$Q.borderColor,this.lineWidth=r$Q.lineWidth,this.underLine=r$Q.underLine;var r$e,r$l=r$G.isConchApp;r$l?((r$e=ConchTextCanvas)._source=ConchTextCanvas,r$e._source.canvas=ConchTextCanvas):r$e=r$J.canvas.source,this.canvas=r$e,this._enableMerageInAtlas=!0,this._ctx=r$l?r$e:this.canvas.getContext("2d",void 0);var r$M=r$n.measureText(this.char,this.font);this.cw=r$M.width*this.xs,this.ch=(r$M.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new r$$(this)}r$p(r$d,"laya.webgl.resource.WebGLCharImage",r$e);var r$Q=r$d.prototype;return r$B.imps(r$Q,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),r$Q.active=function(){this.texture.active()},r$Q.recreateResource=function(){var r$S=r$G.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),r$S){var r$Q=this.fontSize;1==this.xs&&1==this.ys||(r$Q=parseInt(r$Q*(this.xs>this.ys?this.xs:this.ys)+""));var r$e="normal 100 "+this.font;r$e=r$e.replace(r$d._fontSizeReg,r$Q),this.borderColor&&(r$e+=" 1 "+this.borderColor),this._ctx.font=r$e,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,r$m.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var r$l=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(r$l,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},r$Q.onresize=function(r$S,r$Q){this._w=r$S,this._h=r$Q,this._allowMerageInAtlas=!0},r$Q.clearAtlasSource=function(){},r$l(0,r$Q,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),r$l(0,r$Q,"atlasSource",function(){return this.canvas}),r$l(0,r$Q,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(r$S){this._enableMerageInAtlas=r$S}),r$d.createOneChar=function(r$S,r$Q){return new r$d(r$S,r$Q)},r$d._fontSizeReg=new RegExp("\\d+(?=px)","g"),r$d}(),r$ZS=function(r$S){function r$R(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){void 0===r$e&&(r$e=6408),void 0===r$l&&(r$l=5121),void 0===r$M&&(r$M=34041),void 0===r$d&&(r$d=!1),void 0===r$T&&(r$T=!1),void 0===r$U&&(r$U=-1),void 0===r$i&&(r$i=1),r$R.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=r$S,this._h=r$Q,this._surfaceFormat=r$e,this._surfaceType=r$l,this._depthStencilFormat=r$M,this._mipMap=r$d,this._repeat=r$T,this._minFifter=r$U,this._magFifter=r$i}r$p(r$R,"laya.webgl.resource.WebGLRenderTarget",r$e);var r$Q=r$R.prototype;return r$Q.recreateResource=function(){var r$S=r$vS.mainContext;this._frameBuffer||(this._frameBuffer=r$S.createFramebuffer()),this._source||(this._source=r$S.createTexture());var r$Q=r$DS.curBindTexTarget,r$e=r$DS.curBindTexValue;r$DS.bindTexture(r$S,3553,this._source),r$S.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var r$l=this._minFifter,r$M=this._magFifter,r$d=this._repeat?10497:33071,r$T=r$o.isPOT(this._w,this._h);if(r$T?(this._mipMap?-1!==r$l||(r$l=9987):-1!==r$l||(r$l=9729),-1!==r$M||(r$M=9729),r$S.texParameteri(3553,10241,r$l),r$S.texParameteri(3553,10240,r$M),r$S.texParameteri(3553,10242,r$d),r$S.texParameteri(3553,10243,r$d),this._mipMap&&r$S.generateMipmap(3553)):(-1!==r$l||(r$l=9729),-1!==r$M||(r$M=9729),r$S.texParameteri(3553,10241,r$l),r$S.texParameteri(3553,10240,r$M),r$S.texParameteri(3553,10242,33071),r$S.texParameteri(3553,10243,33071)),r$S.bindFramebuffer(36160,this._frameBuffer),r$S.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=r$S.createRenderbuffer()),r$S.bindRenderbuffer(36161,this._depthStencilBuffer),r$S.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:r$S.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:r$S.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:r$S.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}r$S.bindFramebuffer(36160,null),r$Q&&r$e&&r$DS.bindTexture(r$S,r$Q,r$e),r$S.bindRenderbuffer(36161,null),r$T&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},r$Q.disposeResource=function(){this._frameBuffer&&(r$vS.mainContext.deleteTexture(this._source),r$vS.mainContext.deleteFramebuffer(this._frameBuffer),r$vS.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},r$l(0,r$Q,"depthStencilBuffer",function(){return this._depthStencilBuffer}),r$l(0,r$Q,"frameBuffer",function(){return this._frameBuffer}),r$R}(),r$NS=function(r$S){function r$U(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this.offsetX=0,this.offsetY=0,r$U.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=r$d,this.canvas=r$S,this._ctx=r$S.getContext("2d",void 0),this._w=r$l,this._h=r$M,this.offsetX=r$Q,this.offsetY=r$e,this.src=r$T,this._enableMerageInAtlas=!0,r$u.enabled&&this._w<r$u.atlasLimitWidth&&this._h<r$u.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}r$p(r$U,"laya.webgl.resource.WebGLSubImage",r$e);var r$Q=r$U.prototype;return r$B.imps(r$Q,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),r$Q.size=function(r$S,r$Q){this._w=r$S,this._h=r$Q,this._ctx&&this._ctx.size(r$S,r$Q),this.canvas&&(this.canvas.height=r$Q,this.canvas.width=r$S)},r$Q.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},r$Q.createWebGlTexture=function(){var r$S=r$vS.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var r$Q=this._source=r$S.createTexture(),r$e=r$DS.curBindTexTarget,r$l=r$DS.curBindTexValue;r$DS.bindTexture(r$S,3553,r$Q),r$S.pixelStorei(37441,!0),r$S.texImage2D(3553,0,6408,6408,5121,this.canvas),r$S.pixelStorei(37441,!1);var r$M=this.minFifter,r$d=this.magFifter,r$T=this.repeat?10497:33071,r$U=r$o.isPOT(this.width,this.height);r$U?(this.mipmap?-1!==r$M||(r$M=9987):-1!==r$M||(r$M=9729),-1!==r$d||(r$d=9729),r$S.texParameteri(3553,10240,r$d),r$S.texParameteri(3553,10241,r$M),r$S.texParameteri(3553,10242,r$T),r$S.texParameteri(3553,10243,r$T),this.mipmap&&r$S.generateMipmap(3553)):(-1!==r$M||(r$M=9729),-1!==r$d||(r$d=9729),r$S.texParameteri(3553,10241,r$M),r$S.texParameteri(3553,10240,r$d),r$S.texParameteri(3553,10242,33071),r$S.texParameteri(3553,10243,33071)),r$e&&r$l&&r$DS.bindTexture(r$S,r$e,r$l),this.canvas=null,r$U&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},r$Q.disposeResource=function(){r$u.enabled&&this._allowMerageInAtlas||!this._source||(r$vS.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},r$Q.clearAtlasSource=function(){},r$l(0,r$Q,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),r$l(0,r$Q,"atlasSource",function(){return this.canvas}),r$l(0,r$Q,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(r$S){this._allowMerageInAtlas=r$S}),r$U}(),r$CS=function(r$S){function r$R(r$S,r$Q,r$e,r$l){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,r$R.__super.call(this),!r$S||!r$Q)throw"Shader Error";this._id=++r$R._count,this._vs=r$S,this._ps=r$Q,this._nameMap=r$l||{},null!=r$e&&(r$R.sharders[r$e]=this)}r$p(r$R,"laya.webgl.shader.Shader",r$nS);var r$Q=r$R.prototype;return r$Q.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},r$Q.disposeResource=function(){r$vS.mainContext.deleteShader(this._vshader),r$vS.mainContext.deleteShader(this._pshader),r$vS.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},r$Q._compile=function(){if(!r$vS.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var r$S=[this._vs,this._ps],r$Q=r$vS.mainContext;if(this._program=r$Q.createProgram(),this._vshader=r$R._createShader(r$Q,r$S[0],35633),this._pshader=r$R._createShader(r$Q,r$S[1],35632),r$Q.attachShader(this._program,this._vshader),r$Q.attachShader(this._program,this._pshader),r$Q.linkProgram(this._program),!r$G.isConchApp&&!r$Q.getProgramParameter(this._program,35714))throw r$Q.getProgramInfoLog(this._program);var r$e,r$l,r$M=0,r$d=0;for(r$d=r$G.isConchApp?r$Q.getProgramParameterEx(this._vs,this._ps,"",35721):r$Q.getProgramParameter(this._program,35721),r$M=0;r$M<r$d;r$M++){var r$T=null;r$e={vartype:"attribute",glfun:null,ivartype:0,attrib:r$T=r$G.isConchApp?r$Q.getActiveAttribEx(this._vs,this._ps,"",r$M):r$Q.getActiveAttrib(this._program,r$M),location:r$Q.getAttribLocation(this._program,r$T.name),name:r$T.name,type:r$T.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(r$e)}var r$U=0;for(r$U=r$G.isConchApp?r$Q.getProgramParameterEx(this._vs,this._ps,"",35718):r$Q.getProgramParameter(this._program,35718),r$M=0;r$M<r$U;r$M++){var r$i=null;r$i=r$G.isConchApp?r$Q.getActiveUniformEx(this._vs,this._ps,"",r$M):r$Q.getActiveUniform(this._program,r$M),0<(r$e={vartype:"uniform",glfun:null,ivartype:1,attrib:r$T,location:r$Q.getUniformLocation(this._program,r$i.name),name:r$i.name,type:r$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(r$e.name=r$e.name.substr(0,r$e.name.length-3),r$e.isArray=!0,r$e.location=r$Q.getUniformLocation(this._program,r$e.name)),this._params.push(r$e)}for(r$M=0,r$l=this._params.length;r$M<r$l;r$M++)if((r$e=this._params[r$M]).indexOfParams=r$M,r$e.index=1,r$e.value=[r$e.location,null],r$e.codename=r$e.name,r$e.name=this._nameMap[r$e.codename]?this._nameMap[r$e.codename]:r$e.codename,(this._paramsMap[r$e.name]=r$e)._this=this,r$e.uploadedValue=[],"attribute"!==r$e.vartype)switch(r$e.type){case 5124:r$e.fun=r$e.isArray?this._uniform1iv:this._uniform1i;break;case 5126:r$e.fun=r$e.isArray?this._uniform1fv:this._uniform1f;break;case 35664:r$e.fun=r$e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:r$e.fun=r$e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:r$e.fun=r$e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:r$e.fun=this._uniform_sampler2D;break;case 35680:r$e.fun=this._uniform_samplerCube;break;case 35676:r$e.glfun=r$Q.uniformMatrix4fv,r$e.fun=this._uniformMatrix4fv;break;case 35670:r$e.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else r$e.fun=this._attribute}},r$Q.getUniform=function(r$S){return this._paramsMap[r$S]},r$Q._attribute=function(r$S,r$Q){var r$e=r$vS.mainContext,r$l=r$aS._enableAtributes,r$M=r$S.location;return r$l[r$M]||r$e.enableVertexAttribArray(r$M),r$e.vertexAttribPointer(r$M,r$Q[0],r$Q[1],r$Q[2],r$Q[3],r$Q[4]+this._offset),r$l[r$M]=r$aS._bindVertexBuffer,1},r$Q._uniform1f=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q?(r$vS.mainContext.uniform1f(r$S.location,r$e[0]=r$Q),1):0},r$Q._uniform1fv=function(r$S,r$Q){if(r$Q.length<4){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]||r$e[2]!==r$Q[2]||r$e[3]!==r$Q[3]?(r$vS.mainContext.uniform1fv(r$S.location,r$Q),r$e[0]=r$Q[0],r$e[1]=r$Q[1],r$e[2]=r$Q[2],r$e[3]=r$Q[3],1):0}return r$vS.mainContext.uniform1fv(r$S.location,r$Q),1},r$Q._uniform_vec2=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]?(r$vS.mainContext.uniform2f(r$S.location,r$e[0]=r$Q[0],r$e[1]=r$Q[1]),1):0},r$Q._uniform_vec2v=function(r$S,r$Q){if(r$Q.length<2){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]||r$e[2]!==r$Q[2]||r$e[3]!==r$Q[3]?(r$vS.mainContext.uniform2fv(r$S.location,r$Q),r$e[0]=r$Q[0],r$e[1]=r$Q[1],r$e[2]=r$Q[2],r$e[3]=r$Q[3],1):0}return r$vS.mainContext.uniform2fv(r$S.location,r$Q),1},r$Q._uniform_vec3=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]||r$e[2]!==r$Q[2]?(r$vS.mainContext.uniform3f(r$S.location,r$e[0]=r$Q[0],r$e[1]=r$Q[1],r$e[2]=r$Q[2]),1):0},r$Q._uniform_vec3v=function(r$S,r$Q){return r$vS.mainContext.uniform3fv(r$S.location,r$Q),1},r$Q._uniform_vec4=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]||r$e[2]!==r$Q[2]||r$e[3]!==r$Q[3]?(r$vS.mainContext.uniform4f(r$S.location,r$e[0]=r$Q[0],r$e[1]=r$Q[1],r$e[2]=r$Q[2],r$e[3]=r$Q[3]),1):0},r$Q._uniform_vec4v=function(r$S,r$Q){return r$vS.mainContext.uniform4fv(r$S.location,r$Q),1},r$Q._uniformMatrix2fv=function(r$S,r$Q){return r$vS.mainContext.uniformMatrix2fv(r$S.location,!1,r$Q),1},r$Q._uniformMatrix3fv=function(r$S,r$Q){return r$vS.mainContext.uniformMatrix3fv(r$S.location,!1,r$Q),1},r$Q._uniformMatrix4fv=function(r$S,r$Q){return r$vS.mainContext.uniformMatrix4fv(r$S.location,!1,r$Q),1},r$Q._uniform1i=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q?(r$vS.mainContext.uniform1i(r$S.location,r$e[0]=r$Q),1):0},r$Q._uniform1iv=function(r$S,r$Q){return r$vS.mainContext.uniform1iv(r$S.location,r$Q),1},r$Q._uniform_ivec2=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]?(r$vS.mainContext.uniform2i(r$S.location,r$e[0]=r$Q[0],r$e[1]=r$Q[1]),1):0},r$Q._uniform_ivec2v=function(r$S,r$Q){return r$vS.mainContext.uniform2iv(r$S.location,r$Q),1},r$Q._uniform_vec3i=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]||r$e[2]!==r$Q[2]?(r$vS.mainContext.uniform3i(r$S.location,r$e[0]=r$Q[0],r$e[1]=r$Q[1],r$e[2]=r$Q[2]),1):0},r$Q._uniform_vec3vi=function(r$S,r$Q){return r$vS.mainContext.uniform3iv(r$S.location,r$Q),1},r$Q._uniform_vec4i=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]||r$e[2]!==r$Q[2]||r$e[3]!==r$Q[3]?(r$vS.mainContext.uniform4i(r$S.location,r$e[0]=r$Q[0],r$e[1]=r$Q[1],r$e[2]=r$Q[2],r$e[3]=r$Q[3]),1):0},r$Q._uniform_vec4vi=function(r$S,r$Q){return r$vS.mainContext.uniform4iv(r$S.location,r$Q),1},r$Q._uniform_sampler2D=function(r$S,r$Q){var r$e=r$vS.mainContext,r$l=r$S.uploadedValue;return null==r$l[0]?(r$l[0]=this._curActTexIndex,r$e.uniform1i(r$S.location,this._curActTexIndex),r$e.activeTexture(r$R._TEXTURES[this._curActTexIndex]),r$DS.bindTexture(r$e,3553,r$Q),this._curActTexIndex++,1):(r$e.activeTexture(r$R._TEXTURES[r$l[0]]),r$DS.bindTexture(r$e,3553,r$Q),0)},r$Q._uniform_samplerCube=function(r$S,r$Q){var r$e=r$vS.mainContext,r$l=r$S.uploadedValue;return null==r$l[0]?(r$l[0]=this._curActTexIndex,r$e.uniform1i(r$S.location,this._curActTexIndex),r$e.activeTexture(r$R._TEXTURES[this._curActTexIndex]),r$DS.bindTexture(r$e,34067,r$Q),this._curActTexIndex++,1):(r$e.activeTexture(r$R._TEXTURES[r$l[0]]),r$DS.bindTexture(r$e,34067,r$Q),0)},r$Q._noSetValue=function(r$S){console.log("no....:"+r$S.name)},r$Q.uploadOne=function(r$S,r$Q){this.activeResource(),r$DS.UseProgram(this._program);var r$e=this._paramsMap[r$S];r$e.fun.call(this,r$e,r$Q)},r$Q.uploadTexture2D=function(r$S){r$X.shaderCall++;var r$Q=r$vS.mainContext;r$Q.activeTexture(33984),r$DS.bindTexture(r$Q,3553,r$S)},r$Q.uploadTexture2D1=function(r$S){r$X.shaderCall++;var r$Q=r$vS.mainContext;r$Q.activeTexture(33985),r$DS.bindTexture(r$Q,3553,r$S)},r$Q.upload=function(r$S,r$Q){r$nS.activeShader=r$nS.bindShader=this,this._lastUseFrameCount===r$X.loopCount||this.activeResource(),r$DS.UseProgram(this._program),this._reCompile?(r$Q=this._params,this._reCompile=!1):r$Q=r$Q||this._params;r$vS.mainContext;for(var r$e,r$l,r$M=r$Q.length,r$d=0,r$T=0;r$T<r$M;r$T++)null!==(r$l=r$S[(r$e=r$Q[r$T]).name])&&(r$d+=r$e.fun.call(this,r$e,r$l));r$X.shaderCall+=r$d},r$Q.uploadArray=function(r$S,r$Q,r$e){r$nS.activeShader=this,(r$nS.bindShader=this).activeResource(),r$DS.UseProgram(this._program);this._params;for(var r$l,r$M,r$d=0,r$T=r$Q-2;0<=r$T;r$T-=2)(r$M=this._paramsMap[r$S[r$T]])&&null!=(r$l=r$S[r$T+1])&&(r$e&&r$e[r$M.name]&&r$e[r$M.name].bind(),r$d+=r$M.fun.call(this,r$M,r$l));r$X.shaderCall+=r$d},r$Q.getParams=function(){return this._params},r$R.getShader=function(r$S){return r$R.sharders[r$S]},r$R.create=function(r$S,r$Q,r$e,r$l){return new r$R(r$S,r$Q,r$e,r$l)},r$R.withCompile=function(r$S,r$Q,r$e,r$l){if(r$e&&r$R.sharders[r$e])return r$R.sharders[r$e];var r$M=r$R._preCompileShader[2e-4*r$S];if(!r$M)throw new Error("withCompile shader err!"+r$S);return r$M.createShader(r$Q,r$e,r$l)},r$R.withCompile2D=function(r$S,r$Q,r$e,r$l,r$M){if(r$l&&r$R.sharders[r$l])return r$R.sharders[r$l];var r$d=r$R._preCompileShader[2e-4*r$S+r$Q];if(!r$d)throw new Error("withCompile shader err!"+r$S+" "+r$Q);return r$d.createShader(r$e,r$l,r$M)},r$R.addInclude=function(r$S,r$Q){r$AS.addInclude(r$S,r$Q)},r$R.preCompile=function(r$S,r$Q,r$e,r$l){var r$M=2e-4*r$S;r$R._preCompileShader[r$M]=new r$AS(r$M,r$Q,r$e,r$l)},r$R.preCompile2D=function(r$S,r$Q,r$e,r$l,r$M){var r$d=2e-4*r$S+r$Q;r$R._preCompileShader[r$d]=new r$AS(r$d,r$e,r$l,r$M)},r$R._createShader=function(r$S,r$Q,r$e){var r$l=r$S.createShader(r$e);return r$S.shaderSource(r$l,r$Q),r$S.compileShader(r$l),r$l},r$R._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],r$R._count=0,r$R._preCompileShader={},r$R.SHADERNAME2ID=2e-4,r$R.sharders=((r$R.sharders=[]).length=32,r$R.sharders),r$T(r$R,["nameKey",function(){return this.nameKey=new r$h}]),r$R}(),r$KS=function(r$S){function r$Q(){this._maxsize=0,this._upload=!0,this._uploadSize=0,r$Q.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}r$p(r$Q,"laya.webgl.utils.Buffer2D",r$S);var r$e=r$Q.prototype;return r$e.needSize=function(r$S){var r$Q=this._byteLength;if(r$S){var r$e=this._byteLength+r$S;r$e<=this._buffer.byteLength||this._resizeBuffer(r$e<<1,!0),this._byteLength=r$e}return r$Q},r$e._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),r$X.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,r$aS._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),r$aS._gl.bufferSubData(this._bufferType,0,this._buffer)},r$e._bufferSubData=function(r$S,r$Q,r$e){if(void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),this._maxsize=Math.max(this._maxsize,this._byteLength),r$X.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,r$aS._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),r$Q||r$e){var r$l=this._buffer.slice(r$Q,r$e);r$aS._gl.bufferSubData(this._bufferType,r$S,r$l)}else r$aS._gl.bufferSubData(this._bufferType,r$S,this._buffer)},r$e._checkArrayUse=function(){},r$e._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},r$e._bind_subUpload=function(r$S,r$Q,r$e){return void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(r$S,r$Q,r$e),!0)},r$e._resizeBuffer=function(r$S,r$Q){if(r$S<this._buffer.byteLength)return this;if(this.memorySize=r$S,r$Q&&this._buffer&&0<this._buffer.byteLength){var r$e=new ArrayBuffer(r$S);new Uint8Array(r$e).set(new Uint8Array(this._buffer),0),this._buffer=r$e}else this._buffer=new ArrayBuffer(r$S);return this._checkArrayUse(),this._upload=!0,this},r$e.append=function(r$S){this._upload=!0;var r$Q,r$e;r$Q=r$S.byteLength,r$S instanceof Uint8Array?(this._resizeBuffer(this._byteLength+r$Q,!0),r$e=new Uint8Array(this._buffer,this._byteLength)):r$S instanceof Uint16Array?(this._resizeBuffer(this._byteLength+r$Q,!0),r$e=new Uint16Array(this._buffer,this._byteLength)):r$S instanceof Float32Array&&(this._resizeBuffer(this._byteLength+r$Q,!0),r$e=new Float32Array(this._buffer,this._byteLength)),r$e.set(r$S,0),this._byteLength+=r$Q,this._checkArrayUse()},r$e.appendU16Array=function(r$S,r$Q){this._resizeBuffer(this._byteLength+2*r$Q,!0);for(var r$e=new Uint16Array(this._buffer,this._byteLength,r$Q),r$l=0;r$l<r$Q;r$l++)r$e[r$l]=r$S[r$l];this._byteLength+=2*r$Q,this._checkArrayUse()},r$e.appendEx=function(r$S,r$Q){this._upload=!0;var r$e;r$e=r$S.byteLength,this._resizeBuffer(this._byteLength+r$e,!0),new r$Q(this._buffer,this._byteLength).set(r$S,0),this._byteLength+=r$e,this._checkArrayUse()},r$e.appendEx2=function(r$S,r$Q,r$e,r$l){void 0===r$l&&(r$l=1),this._upload=!0;var r$M,r$d;r$M=r$e*r$l,this._resizeBuffer(this._byteLength+r$M,!0),r$d=new r$Q(this._buffer,this._byteLength);var r$T=0;for(r$T=0;r$T<r$e;r$T++)r$d[r$T]=r$S[r$T];this._byteLength+=r$M,this._checkArrayUse()},r$e.getBuffer=function(){return this._buffer},r$e.setNeedUpload=function(){this._upload=!0},r$e.getNeedUpload=function(){return this._upload},r$e.upload=function(){var r$S=this._bind_upload();return r$aS._gl.bindBuffer(this._bufferType,null),r$aS._bindActive[this._bufferType]=null,r$nS.activeShader=null,r$S},r$e.subUpload=function(r$S,r$Q,r$e){void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0);var r$l=this._bind_subUpload();return r$aS._gl.bindBuffer(this._bufferType,null),r$aS._bindActive[this._bufferType]=null,r$nS.activeShader=null,r$l},r$e.disposeResource=function(){r$S.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},r$e.clear=function(){this._byteLength=0,this._upload=!0},r$l(0,r$e,"bufferLength",function(){return this._buffer.byteLength}),r$l(0,r$e,"byteLength",null,function(r$S){this._byteLength!==r$S&&(r$S<=this._buffer.byteLength||this._resizeBuffer(2*r$S+256,!0),this._byteLength=r$S)}),r$Q.__int__=function(r$S){r$sS.QuadrangleIB=r$sS.create(35044),r$cS.fillIBQuadrangle(r$sS.QuadrangleIB,16)},r$Q.FLOAT32=4,r$Q.SHORT=2,r$Q}(r$aS),r$VS=(function(r$Q){function r$e(r$S){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,r$e.__super.call(this,9)}r$p(r$e,"laya.webgl.shader.d2.value.GlowSV",r$Q);var r$S=r$e.prototype;r$S.setValue=function(r$S){r$Q.prototype.setValue.call(this,r$S)},r$S.clear=function(){r$Q.prototype.clear.call(this)}}(r$rS),function(r$S){function r$Q(r$S){r$Q.__super.call(this,64),this.defines.add(64)}r$p(r$Q,"laya.webgl.shader.d2.value.TextSV",r$S);var r$e=r$Q.prototype;return r$e.release=function(){(r$Q.pool[r$Q._length++]=this).clear()},r$e.clear=function(){r$S.prototype.clear.call(this)},r$Q.create=function(){return r$Q._length?r$Q.pool[--r$Q._length]:new r$Q(null)},r$Q.pool=[],r$Q._length=0,r$Q}(r$rS)),r$_S=function(r$S){function r$M(r$S,r$Q,r$e,r$l){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,r$M.__super.call(this,r$S,r$Q,r$e,r$l)}r$p(r$M,"laya.webgl.shader.d2.Shader2X",r$S);var r$Q=r$M.prototype;return r$Q.upload2dQuick1=function(r$S){this.upload(r$S,this._params2dQuick1||this._make2dQuick1())},r$Q._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var r$S,r$Q=this._params,r$e=0,r$l=r$Q.length;r$e<r$l;r$e++)r$S=r$Q[r$e],(r$G.isFlash||"size"!==r$S.name&&"position"!==r$S.name&&"texcoord"!==r$S.name)&&this._params2dQuick1.push(r$S)}return this._params2dQuick1},r$Q.disposeResource=function(){r$S.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},r$Q.upload2dQuick2=function(r$S){this.upload(r$S,this._params2dQuick2||this._make2dQuick2())},r$Q._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var r$S,r$Q=this._params,r$e=0,r$l=r$Q.length;r$e<r$l;r$e++)r$S=r$Q[r$e],(r$G.isFlash||"size"!==r$S.name)&&this._params2dQuick2.push(r$S)}return this._params2dQuick2},r$M.create=function(r$S,r$Q,r$e,r$l){return new r$M(r$S,r$Q,r$e,r$l)},r$M}(r$CS),r$sS=function(r$S){function r$Q(r$S){this._uint8Array=null,this._uint16Array=null,void 0===r$S&&(r$S=35044),r$Q.__super.call(this),this._bufferUsage=r$S,this._bufferType=34963,r$G.isFlash||(this._buffer=new ArrayBuffer(8))}r$p(r$Q,"laya.webgl.utils.IndexBuffer2D",r$KS);var r$e=r$Q.prototype;return r$e._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},r$e.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},r$e.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},r$e.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},r$Q.QuadrangleIB=null,r$Q.create=function(r$S){return void 0===r$S&&(r$S=35044),new r$Q(r$S)},r$Q}(),r$yS=function(r$S){function r$e(r$S,r$Q){this._floatArray32=null,this._vertexStride=0,r$e.__super.call(this),this._vertexStride=r$S,this._bufferUsage=r$Q,this._bufferType=34962,r$G.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}r$p(r$e,"laya.webgl.utils.VertexBuffer2D",r$S);var r$Q=r$e.prototype;return r$Q.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},r$Q.bind=function(r$S){r$S&&r$S._bind(),this._bind()},r$Q.insertData=function(r$S,r$Q){this.getFloat32Array().set(r$S,r$Q),this._upload=!0},r$Q.bind_upload=function(r$S){r$S._bind_upload()||r$S._bind(),this._bind_upload()||this._bind()},r$Q._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},r$Q.disposeResource=function(){r$S.prototype.disposeResource.call(this)},r$Q.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},r$l(0,r$Q,"vertexStride",function(){return this._vertexStride}),r$e.create=function(r$S,r$Q){return void 0===r$Q&&(r$Q=35048),new r$e(r$S,r$Q)},r$e}(r$KS),r$SQ=function(r$S){function r$U(r$S,r$Q,r$e,r$l,r$M,r$d){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===r$e&&(r$e=6408),void 0===r$l&&(r$l=!0),r$U.__super.call(this,r$S,r$Q),r$S){if(this._format=r$e,this._mipmap=r$l,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof r$S)this._url=r$S,this._src=r$S,this._image=new r$J.window.Image,r$Q&&(r$Q.onload&&(this.onload=r$Q.onload),r$Q.onerror&&(this.onerror=r$Q.onerror),r$Q.onCreate&&r$Q.onCreate(this)),this._image.crossOrigin=r$S&&0==r$S.indexOf("data:")?null:"",r$S&&(this._image.src=r$S);else if(r$S instanceof ArrayBuffer){this._src=r$Q,this._url=this._src;var r$T=new r$i(r$S);r$T.readUTFBytes(4),r$T.readUTFBytes(2),r$T.getInt16();r$T.endian="bigEndian",this._w=r$T.getInt16(),this._h=r$T.getInt16();r$T.getInt16(),r$T.getInt16();this._image=new Uint8Array(r$S,r$T.pos),this._format=r$vS.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,r$u.enabled&&this._w<r$u.atlasLimitWidth&&this._h<r$u.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(r$S instanceof Uint8Array))return this._src=r$Q,this._url=this._src,this._image=r$S.source||r$S,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=r$Q,this._url=this._src,this._w=r$M,this._h=r$d,this._image=r$S,this._format=0===r$e?r$S.byteLength/(r$M*r$d)==4?6408:6407:r$e}this._$5__enableMerageInAtlas=!0}}r$p(r$U,"laya.webgl.resource.WebGLImage",r$j);var r$Q=r$U.prototype;return r$B.imps(r$Q,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),r$Q._init_=function(r$S,r$Q){},r$Q._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var r$S=r$vS.mainContext,r$Q=this._source=r$S.createTexture(),r$e=r$DS.curBindTexTarget,r$l=r$DS.curBindTexValue;r$DS.bindTexture(r$S,3553,r$Q);var r$M=this.minFifter,r$d=this.magFifter,r$T=this.repeat?10497:33071,r$U=r$o.isPOT(this._w,this._h),r$i=!1;switch(r$U?(this.mipmap?-1!==r$M||(r$M=9987):-1!==r$M||(r$M=9729),-1!==r$d||(r$d=9729),r$S.texParameteri(3553,10241,r$M),r$S.texParameteri(3553,10240,r$d),r$S.texParameteri(3553,10242,r$T),r$S.texParameteri(3553,10243,r$T),this.mipmap&&r$S.generateMipmap(3553)):(-1!==r$M||(r$M=9729),-1!==r$d||(r$d=9729),r$S.texParameteri(3553,10241,r$M),r$S.texParameteri(3553,10240,r$d),r$S.texParameteri(3553,10242,33071),r$S.texParameteri(3553,10243,33071)),r$S.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&r$S.pixelStorei(r$S.UNPACK_ALIGNMENT,1),r$S.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&r$S.pixelStorei(r$S.UNPACK_ALIGNMENT,1),r$S.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:r$i=!0,r$S.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case r$vS.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:r$i=!0,r$S.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}r$S.pixelStorei(37441,!1),r$e&&r$l&&r$DS.bindTexture(r$S,r$e,r$l),this.uri||(this.uri=this._url),r$i?this.memorySize=this._image.length:r$U&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},r$Q.recreateResource=function(){var r$S=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var r$Q=this;this._image=new r$J.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(r$Q._needReleaseAgain)return r$Q._needReleaseAgain=!1,r$Q._image.onload=null,void(r$Q._image=null);r$Q._allowMerageInAtlas&&r$Q._enableMerageInAtlas?(r$S.memorySize=0,r$S._recreateLock=!1):r$Q._createWebGlTexture(),r$Q.completeCreate()},this._image.src=this._src}},r$Q.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&r$vS.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},r$Q.onresize=function(){this._w=this._image.width,this._h=this._image.height,r$u.enabled&&this._w<r$u.atlasLimitWidth&&this._h<r$u.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},r$Q.clearAtlasSource=function(){this._image=null},r$l(0,r$Q,"format",function(){return this._format}),r$l(0,r$Q,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(r$S){this._$5__enableMerageInAtlas=r$S}),r$l(0,r$Q,"mipmap",function(){return this._mipmap}),r$l(0,r$Q,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),r$l(0,r$Q,"atlasSource",function(){return this._image}),r$l(0,r$Q,"onload",null,function(r$S){var r$Q=this;this._onload=r$S,this._image&&(this._image.onload=null!=this._onload?function(){r$Q.onresize(),r$Q._onload()}:null)}),r$l(0,r$Q,"onerror",null,function(r$S){var r$Q=this;this._onerror=r$S,this._image&&(this._image.onerror=null!=this._onerror?function(){r$Q._onerror()}:null)}),r$U}();r$B.__init([r$JS,r$w,r$OS,r$AS])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(r$S,r$Q){"use strict";for(var r$e in Object.defineProperty(r$Q,"__esModule",{value:!0}),Laya){var r$l=Laya[r$e];r$l&&r$l.__isclass&&(r$Q[r$e]=r$l)}}),function(r$d,r$S,r$l){r$l.un,r$l.uns;var r$M=r$l.static,r$T=r$l.class,r$U=r$l.getset,r$i=(r$l.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),r$L=laya.utils.ClassUtils,r$Y=(laya.events.Event,laya.utils.HTMLChar),r$R=laya.net.Loader,r$o=(laya.display.Node,laya.maths.Rectangle),r$p=laya.renders.Render,r$J=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),r$j=laya.utils.Stat,r$n=laya.display.Text,r$c=laya.resource.Texture,r$G=laya.net.URL,r$z=laya.utils.Utils,r$A=function(){function r$J(){}return r$T(r$J,"laya.html.utils.HTMLParse"),r$J.parse=function(r$S,r$Q,r$e){r$Q=(r$Q="<root>"+(r$Q=r$Q.replace(/<br>/g,"<br/>"))+"</root>").replace(r$J.spacePattern,r$J.char255);var r$l=r$z.parseXMLFromString(r$Q);r$J._parseXML(r$S,r$l.childNodes[0].childNodes,r$e)},r$J._parseXML=function(r$S,r$Q,r$e,r$l){var r$M=0,r$d=0;if(r$Q.join||r$Q.item)for(r$M=0,r$d=r$Q.length;r$M<r$d;++r$M)r$J._parseXML(r$S,r$Q[r$M],r$e,r$l);else{var r$T,r$U,r$i;if(3==r$Q.nodeType)return void(r$S instanceof laya.html.dom.HTMLDivElement?(null==r$Q.nodeName&&(r$Q.nodeName="#text"),r$U=r$Q.nodeName.toLowerCase(),0<(r$i=r$Q.textContent.replace(/^\s+|\s+$/g,"")).length&&(r$T=r$L.getInstance(r$U))&&(r$S.addChild(r$T),r$T.innerTEXT=r$i.replace(r$J.char255AndOneSpacePattern," "))):0<(r$i=r$Q.textContent.replace(/^\s+|\s+$/g,"")).length&&(r$S.innerTEXT=r$i.replace(r$J.char255AndOneSpacePattern," ")));if("#comment"==(r$U=r$Q.nodeName.toLowerCase()))return;if(r$T=r$L.getInstance(r$U)){(r$T=r$S.addChild(r$T)).URI=r$e,r$T.href=r$l;var r$R=r$Q.attributes;if(r$R&&0<r$R.length)for(r$M=0,r$d=r$R.length;r$M<r$d;++r$M){var r$o=r$R[r$M],r$Y=r$o.nodeName,r$p=r$o.value;r$T._setAttributes(r$Y,r$p)}r$J._parseXML(r$T,r$Q.childNodes,r$e,r$T.href)}else r$J._parseXML(r$S,r$Q.childNodes,r$e,r$l)}},r$J.char255=String.fromCharCode(255),r$J.spacePattern=/&nbsp;|&#160;/g,r$J.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),r$J}(),r$v=function(){function r$$(){}return r$T(r$$,"laya.html.utils.Layout"),r$$.later=function(r$S){null==r$$._will&&(r$$._will=[],r$l.stage.frameLoop(1,null,function(){if(!(r$$._will.length<1)){for(var r$S=0;r$S<r$$._will.length;r$S++)laya.html.utils.Layout.layout(r$$._will[r$S]);r$$._will.length=0}})),r$$._will.push(r$S)},r$$.layout=function(r$S){if(!r$S||!r$S._style)return null;if(0==(512&r$S._style._type))return null;r$S.getStyle()._type&=-513;var r$Q=r$$._multiLineLayout(r$S);return r$p.isConchApp&&r$S.layaoutCallNative&&r$S.layaoutCallNative(),r$Q},r$$._multiLineLayout=function(r$S){if(r$n.RightToLeft)return r$$._multiLineLayout2(r$S);var r$Q=new Array;r$S._addChildsToLayout(r$Q);var r$e,r$l,r$M,r$d,r$T,r$U=0,r$i=r$Q.length,r$R=r$S._getCSSStyle(),r$o=r$R.letterSpacing,r$Y=r$R.leading,r$p=r$R.lineHeight,r$J=r$R._widthAuto()||!r$R.wordWrap,r$L=r$J?999999:r$S.width,r$j=(r$S.height,0),r$c=r$R.italic?r$R.fontSize/3:0,r$G=r$R._getAlign(),r$z=r$R._getValign(),r$A=0!==r$z||0!==r$G||0!=r$p,r$v=0,r$D=0,r$B=0,r$O=0,r$H=new Array,r$g=r$H[0]=new r$P,r$I=!1,r$E=!1;r$g.h=0,r$R.italic&&(r$L-=r$R.fontSize/3);var r$t=0,r$k=!0;function r$X(){r$g.y=r$D,r$D+=r$g.h+r$Y,0==r$g.h&&(r$D+=r$p),r$g.mWidth=r$t,r$t=0,r$g=new r$P,r$H.push(r$g),r$g.h=0,r$I=!(r$k=!(r$v=0))}for(r$U=0;r$U<r$i;r$U++)if(null!=(r$e=r$Q[r$U]))if(r$k=!1,r$e instanceof laya.html.dom.HTMLBrElement)r$X(),r$g.y=r$D;else{if(r$e._isChar()){if((r$d=r$e).isWord)r$I=r$E||"\n"===r$d.char,r$g.wordStartIndex=r$g.elements.length;else{if(r$B=r$d.width+r$d.style.letterSpacin,0<r$H.length&&r$L<r$v+r$B&&0<r$g.wordStartIndex){var r$h;r$h=r$g.elements.length-r$g.wordStartIndex+1,r$g.elements.length=r$g.wordStartIndex,r$U-=r$h,r$X();continue}r$I=!1,r$t+=r$d.width}r$B=r$d.width+r$o,r$O=r$d.height,r$E=!1,(r$I=r$I||r$L<r$v+r$B)&&r$X(),r$g.minTextHeight=Math.min(r$g.minTextHeight,r$e.height)}else r$l=r$e._getCSSStyle(),r$T=r$e,r$M=r$l.padding,0===r$l._getCssFloat()||(r$A=!0),r$I=r$E||r$l.lineElement,r$B=r$T.width*r$T._style._tf.scaleX+r$M[1]+r$M[3]+r$o,r$O=r$T.height*r$T._style._tf.scaleY+r$M[0]+r$M[2],r$E=r$l.lineElement,(r$I=r$I||r$L<r$v+r$B&&r$l.wordWrap)&&r$X();r$g.elements.push(r$e),r$g.h=Math.max(r$g.h,r$O),r$e.x=r$v,r$e.y=r$D,r$v+=r$B,r$g.w=r$v-r$o,r$g.y=r$D,r$j=Math.max(r$v+r$c,r$j)}else r$k||(r$v+=r$$.DIV_ELEMENT_PADDING),r$g.wordStartIndex=r$g.elements.length;if(r$D=r$g.y+r$g.h,r$A){var r$b=0,r$m=r$L;for(r$J&&0<r$S.width&&(r$m=r$S.width),r$U=0,r$i=r$H.length;r$U<r$i;r$U++)r$H[r$U].updatePos(0,r$m,r$U,r$b,r$G,r$z,r$p),r$b+=Math.max(r$p,r$H[r$U].h+r$Y);r$D=r$b}return r$J&&(r$S.width=r$j),r$D>r$S.height&&(r$S.height=r$D),[r$j,r$D]},r$$._multiLineLayout2=function(r$S){var r$Q=new Array;r$S._addChildsToLayout(r$Q);var r$e,r$l,r$M,r$d,r$T,r$U=0,r$i=r$Q.length,r$R=r$S._getCSSStyle(),r$o=r$R.letterSpacing,r$Y=r$R.leading,r$p=r$R.lineHeight,r$J=r$R._widthAuto()||!r$R.wordWrap,r$L=r$J?999999:r$S.width,r$j=(r$S.height,0),r$c=r$R.italic?r$R.fontSize/3:0,r$G=2-r$R._getAlign(),r$z=r$R._getValign(),r$A=0!==r$z||0!=r$G||0!=r$p,r$v=0,r$D=0,r$B=0,r$O=0,r$H=new Array,r$g=r$H[0]=new r$P,r$I=!1,r$E=!1;r$g.h=0,r$R.italic&&(r$L-=r$R.fontSize/3);var r$t=0,r$k=!0;function r$X(){r$g.y=r$D,r$D+=r$g.h+r$Y,0==r$g.h&&(r$D+=r$p),r$g.mWidth=r$t,r$t=0,r$g=new r$P,r$H.push(r$g),r$g.h=0,r$I=!(r$k=!(r$v=0))}for(r$U=0;r$U<r$i;r$U++)if(null!=(r$e=r$Q[r$U]))if(r$k=!1,r$e instanceof laya.html.dom.HTMLBrElement)r$X(),r$g.y=r$D;else{if(r$e._isChar()){if((r$d=r$e).isWord)r$I=r$E||"\n"===r$d.char,r$g.wordStartIndex=r$g.elements.length;else{if(0<r$H.length&&r$L<r$v+r$B&&0<r$g.wordStartIndex){var r$h;r$h=r$g.elements.length-r$g.wordStartIndex+1,r$g.elements.length=r$g.wordStartIndex,r$U-=r$h,r$X();continue}r$I=!1,r$t+=r$d.width}r$B=r$d.width+r$o,r$O=r$d.height,r$E=!1,(r$I=r$I||r$L<r$v+r$B)&&r$X(),r$g.minTextHeight=Math.min(r$g.minTextHeight,r$e.height)}else r$l=r$e._getCSSStyle(),r$T=r$e,r$M=r$l.padding,0===r$l._getCssFloat()||(r$A=!0),r$I=r$E||r$l.lineElement,r$B=r$T.width*r$T._style._tf.scaleX+r$M[1]+r$M[3]+r$o,r$O=r$T.height*r$T._style._tf.scaleY+r$M[0]+r$M[2],r$E=r$l.lineElement,(r$I=r$I||r$L<r$v+r$B&&r$l.wordWrap)&&r$X();r$g.elements.push(r$e),r$g.h=Math.max(r$g.h,r$O),r$e.x=r$v,r$e.y=r$D,r$v+=r$B,r$g.w=r$v-r$o,r$g.y=r$D,r$j=Math.max(r$v+r$c,r$j)}else r$k||(r$v+=r$$.DIV_ELEMENT_PADDING),r$g.wordStartIndex=r$g.elements.length;if(r$D=r$g.y+r$g.h,r$A){var r$b=0,r$m=r$L;for(r$U=0,r$i=r$H.length;r$U<r$i;r$U++)r$H[r$U].updatePos(0,r$m,r$U,r$b,r$G,r$z,r$p),r$b+=Math.max(r$p,r$H[r$U].h+r$Y);r$D=r$b}for(r$J&&(r$S.width=r$j),r$D>r$S.height&&(r$S.height=r$D),r$U=0,r$i=r$H.length;r$U<r$i;r$U++)r$H[r$U].revertOrder(r$L);return[r$j,r$D]},r$$._will=null,r$$.DIV_ELEMENT_PADDING=0,r$$}(),r$P=function(){function r$S(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}r$T(r$S,"laya.html.utils.LayoutLine");var r$Q=r$S.prototype;return r$Q.updatePos=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){var r$U,r$i=0;0<this.elements.length&&(r$i=(r$U=this.elements[this.elements.length-1]).x+r$U.width-this.elements[0].x);var r$R=0,r$o=NaN;1===r$M&&(r$R=(r$Q-r$i)/2),2===r$M&&(r$R=r$Q-r$i),0===r$T||0!=r$d||(r$d=1);for(var r$Y=0,r$p=this.elements.length;r$Y<r$p;r$Y++){var r$J=(r$U=this.elements[r$Y])._getCSSStyle();switch(0!==r$R&&(r$U.x+=r$R),r$J._getValign()){case 0:r$U.y=r$l;break;case 1:var r$L=0;99999!=this.minTextHeight&&(r$L=this.minTextHeight);var r$j=(r$L+r$T)/2;r$j=Math.max(r$j,this.h),r$o=(laya.html.dom.HTMLImageElement,r$l+r$j-r$U.height),r$U.y=r$o;break;case 2:r$U.y=r$l+(r$T-r$U.height)}}},r$Q.revertOrder=function(r$S){var r$Q;if(0<this.elements.length){var r$e,r$l=0;for(r$e=this.elements.length,r$l=0;r$l<r$e;r$l++)(r$Q=this.elements[r$l]).x=r$S-r$Q.x-r$Q.width}},r$S}(),r$D=function(r$e){function r$Q(){this.URI=null,this._href=null,r$Q.__super.call(this),this._text=r$Q._EMPTYTEXT,this.setStyle(new r$i(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}r$T(r$Q,"laya.html.dom.HTMLElement",r$e);var r$S=r$Q.prototype;return r$S.layaoutCallNative=function(){var r$S=0;if(this._childs&&0<(r$S=this._childs.length))for(var r$Q=0;r$Q<r$S;r$Q++)this._childs[r$Q].layaoutCallNative&&this._childs[r$Q].layaoutCallNative();var r$e=this._getWords();r$e?laya.html.dom.HTMLElement.fillWords(this,r$e,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},r$S.appendChild=function(r$S){return this.addChild(r$S)},r$S._getWords2=function(){var r$S=this._text.text;if(!r$S||0===r$S.length)return null;var r$Q,r$e,r$l=0,r$M=0;if(this._text.drawWords)r$e=this._text.drawWords;else{for(r$M=(r$Q=r$S.split(" ")).length-1,r$e=[],r$l=0;r$l<r$M;r$l++)r$e.push(r$Q[r$l]," ");0<=r$M&&r$e.push(r$Q[r$M]),this._text.drawWords=r$e}var r$d,r$T=this._text.words;if(r$T&&r$T.length===r$e.length)return r$T;null===r$T&&(this._text.words=r$T=[]),r$T.length=r$e.length;var r$U=this.style,r$i=r$U.font;for(r$l=0,r$M=r$e.length;r$l<r$M;r$l++){r$d=r$z.measureText(r$e[r$l],r$i);var r$R=r$T[r$l]=new r$Y(r$e[r$l],r$d.width,r$d.height||r$U.fontSize,r$U);if(1<r$R.char.length&&(r$R.charNum=r$R.char),this.href){var r$o=new r$J;this.addChild(r$o),r$R.setSprite(r$o)}}return r$T},r$S._getWords=function(){if(!r$n.CharacterCache)return this._getWords2();var r$S=this._text.text;if(!r$S||0===r$S.length)return null;var r$Q,r$e=this._text.words;if(r$e&&r$e.length===r$S.length)return r$e;null===r$e&&(this._text.words=r$e=[]),r$e.length=r$S.length;for(var r$l=this.style,r$M=r$l.font,r$d=0,r$T=r$S.length;r$d<r$T;r$d++)if(r$Q=r$z.measureText(r$S.charAt(r$d),r$M)){var r$U=r$e[r$d]=new r$Y(r$S.charAt(r$d),r$Q.width,r$Q.height||r$l.fontSize,r$l);if(this.href){var r$i=new r$J;this.addChild(r$i),r$U.setSprite(r$i)}}else console.warn("_getWords size is null"+r$S.charAt(r$d),r$M);return r$e},r$S.showLinkSprite=function(){var r$S=this._text.words;if(r$S)for(var r$Q,r$e,r$l=[],r$M=0;r$M<r$S.length;r$M++)r$e=r$S[r$M],(r$Q=new r$J).graphics.drawRect(0,0,r$e.width,r$e.height,"#ff0000"),r$Q.width=r$e.width,r$Q.height=r$e.height,this.addChild(r$Q),r$l.push(r$Q)},r$S._layoutLater=function(){var r$S=this.style;512&r$S._type||(r$S.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&r$S.block?(r$v.later(this),r$S._type|=512):this.parent&&this.parent._layoutLater())},r$S._setAttributes=function(r$S,r$Q){switch(r$S){case"style":return void this.style.cssText(r$Q);case"class":return void(this.className=r$Q)}r$e.prototype._setAttributes.call(this,r$S,r$Q)},r$S.updateHref=function(){if(null!=this._href){var r$S=this._getWords();if(r$S)for(var r$Q,r$e,r$l=0;r$l<r$S.length;r$l++)(r$e=(r$Q=r$S[r$l]).getSprite())&&(r$e.size(r$Q.width,r$Q.height),r$e.on("click",this,this.onLinkHandler))}},r$S.onLinkHandler=function(r$S){switch(r$S.type){case"click":for(var r$Q=this;r$Q;)r$Q.event("link",[this.href]),r$Q=r$Q.parent}},r$S.formatURL=function(r$S){return this.URI?r$G.formatURL(r$S,this.URI?this.URI.path:null):r$S},r$U(0,r$S,"href",function(){return this._href},function(r$S){null!=(this._href=r$S)&&(this._getCSSStyle().underLine=1,this.updateHref())}),r$U(0,r$S,"color",null,function(r$S){this.style.color=r$S}),r$U(0,r$S,"onClick",null,function(r$S){r$l._runScript("fn=function(event){"+r$S+";}"),this.on("click",this,void 0)}),r$U(0,r$S,"id",null,function(r$S){r$B.document.setElementById(r$S,this)}),r$U(0,r$S,"innerTEXT",function(){return this._text.text},function(r$S){this.text=r$S}),r$U(0,r$S,"style",function(){return this._style}),r$U(0,r$S,"text",function(){return this._text.text},function(r$S){this._text==r$Q._EMPTYTEXT?this._text={text:r$S,words:null}:(this._text.text=r$S,this._text.words&&(this._text.words.length=0)),r$p.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),r$U(0,r$S,"parent",r$e.prototype._$get_parent,function(r$S){if(r$S instanceof laya.html.dom.HTMLElement){var r$Q=r$S;this.URI||(this.URI=r$Q.URI),this.style.inherit(r$Q.style)}r$l.superSet(r$J,this,"parent",r$S)}),r$U(0,r$S,"className",null,function(r$S){this.style.attrs(r$B.document.styleSheets["."+r$S])}),r$Q.fillWords=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){r$S.graphics.clear();for(var r$U=0,r$i=r$Q.length;r$U<r$i;r$U++){var r$R=r$Q[r$U];r$S.graphics.fillText(r$R.char,r$R.x+r$e,r$R.y+r$l,r$M,r$d,"left",r$T)}},r$Q._EMPTYTEXT={text:null,words:null},r$Q}(r$J),r$Q=(function(r$S){function r$Q(){r$Q.__super.call(this),this.style.lineElement=!0,this.style.block=!0}r$T(r$Q,"laya.html.dom.HTMLBrElement",r$D)}(),function(r$S){function r$Q(){this.contextHeight=NaN,this.contextWidth=NaN,r$Q.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}r$T(r$Q,"laya.html.dom.HTMLDivElement",r$S);var r$e=r$Q.prototype;return r$e.appendHTML=function(r$S){r$A.parse(this,r$S,this.URI),this.layout()},r$e._addChildsToLayout=function(r$Q){var r$S=this._getWords();if(null==r$S&&0==this._childs.length)return!1;r$S&&r$S.forEach(function(r$S){r$Q.push(r$S)});for(var r$e=!0,r$l=0,r$M=this._childs.length;r$l<r$M;r$l++){var r$d=this._childs[r$l];r$e?r$e=!1:r$Q.push(null),r$d._addToLayout(r$Q)}return!0},r$e._addToLayout=function(r$S){this.layout()},r$e.layout=function(){if(this.style){this.style._type|=512;var r$S=r$v.layout(this);if(r$S){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new r$o);var r$Q=this._$P.mHtmlBounds;r$Q.x=r$Q.y=0,r$Q.width=this.contextWidth=r$S[0],r$Q.height=this.contextHeight=r$S[1],this.setBounds(r$Q)}}},r$U(0,r$e,"height",function(){return this._height?this._height:this.contextHeight},r$S.prototype._$set_height),r$U(0,r$e,"innerHTML",null,function(r$S){this.destroyChildren(),this.appendHTML(r$S)}),r$U(0,r$e,"width",function(){return this._width?this._width:this.contextWidth},function(r$S){var r$Q=!1;r$Q=0===r$S?r$S!=this._width:r$S!=this.width,r$l.superSet(r$D,this,"width",r$S),r$Q&&this.layout()}),r$Q}(r$D)),r$B=function(r$S){function r$Q(){this.all=new Array,this.styleSheets=r$i.styleSheets,r$Q.__super.call(this)}r$T(r$Q,"laya.html.dom.HTMLDocument",r$D);var r$e=r$Q.prototype;return r$e.getElementById=function(r$S){return this.all[r$S]},r$e.setElementById=function(r$S,r$Q){this.all[r$S]=r$Q},r$M(r$Q,["document",function(){return this.document=new r$Q}]),r$Q}();(function(r$S){function r$Q(){this._tex=null,this._url=null,this._renderArgs=[],r$Q.__super.call(this),this.style.block=!0}r$T(r$Q,"laya.html.dom.HTMLImageElement",r$D);var r$e=r$Q.prototype;r$e._addToLayout=function(r$S){!this._style.absolute&&r$S.push(this)},r$e.render=function(r$S,r$Q,r$e){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(r$j.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,r$S.ctx.drawTexture2(r$Q,r$e,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},r$e.layaoutCallNative=function(){var r$S=0;if(this._childs&&0<(r$S=this._childs.length))for(var r$Q=0;r$Q<r$S;r$Q++)this._childs[r$Q].layaoutCallNative&&this._childs[r$Q].layaoutCallNative()},r$U(0,r$e,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(r$S){this._width!==r$S&&(this._width=r$S,this._style.width=r$S,this.repaint())}),r$U(0,r$e,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(r$S){this._height!==r$S&&(this._height=r$S,this._style.height=r$S,this.repaint())}),r$e.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),r$R.clearCache(this,this._url),this._tex=null),r$D.prototype.destroy.call(this)},r$e.onloaded=function(){var r$S=this._style;r$S&&!r$S.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),r$S&&!r$S.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),r$p.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},r$e._loadImageComplete=function(r$S,r$Q,r$e){if(!this._destroyed)if(null!=r$e)if(r$e instanceof ArrayBuffer){var r$l=new DataView(r$e);new laya.webgl.resource.WebGLImage(new Uint8Array(r$e,8),r$S,0,!1,r$l.getUint32(0),r$l.getUint32(4));this.onloaded()}else if(r$e instanceof r$c)r$R.imgMgrSet[r$S]=r$Q,r$d.imgMgrLock(r$S,r$R.imgMgrSet[r$S]),this._url=r$S,this._tex=r$e,r$R.keepCache(this,r$S),r$R.cacheRes(r$S,this._tex),this.onloaded();else{var r$M=-1!=r$S.indexOf(".png",r$S.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(r$e,r$S,r$M,!1,r$e.width,r$e.height);this.onloaded()}else this.event("error","Load image failed")},r$U(0,r$e,"src",null,function(r$S){(r$S=this.formatURL(r$S),this._url!=r$S)&&(null!=this._tex&&(r$R.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=r$S,(this._tex=r$R.getRes(r$S))?(r$R.keepCache(this,r$S),this.onloaded()):r$d.imgMgrLoad(r$S,this._loadImageComplete.bind(this),2,!1))})})(),function(r$S){function r$Q(){this.type=null,r$Q.__super.call(this),this.visible=!1}r$T(r$Q,"laya.html.dom.HTMLLinkElement",r$S);var r$e=r$Q.prototype;r$e._onload=function(r$S){switch(this.type){case"text/css":r$i.parseCSS(r$S,this.URI)}},r$U(0,r$e,"href",r$S.prototype._$get_href,function(r$S){var r$Q=this;r$S=this.formatURL(r$S),this.URI=new r$G(r$S);var r$e=new r$R;r$e.once("complete",null,function(r$S){r$Q._onload(r$S)}),r$e.load(r$S,"text")}),r$Q._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(r$D),function(r$S){function r$Q(){r$Q.__super.call(this),this.visible=!1}r$T(r$Q,"laya.html.dom.HTMLStyleElement",r$S),r$U(0,r$Q.prototype,"text",r$S.prototype._$get_text,function(r$S){r$i.parseCSS(r$S,null)})}(r$D),function(r$S){function r$Q(){r$Q.__super.call(this),this._getCSSStyle().valign="middle"}r$T(r$Q,"laya.html.dom.HTMLIframeElement",r$S),r$U(0,r$Q.prototype,"href",r$S.prototype._$get_href,function(r$e){var r$l=this;r$e=this.formatURL(r$e);var r$S=new r$R;r$S.once("complete",null,function(r$S){var r$Q=r$l.URI;r$l.URI=new r$G(r$e),r$l.innerHTML=r$S,!r$Q||(r$l.URI=r$Q)}),r$S.load(r$e,"text")})}(r$Q)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(r$S,r$Q){"use strict";for(var r$e in Object.defineProperty(r$Q,"__esModule",{value:!0}),Laya){var r$l=Laya[r$e];r$l&&r$l.__isclass&&(r$Q[r$e]=r$l)}}),function(r$S,r$Q,r$j){r$j.un,r$j.uns;var r$l=r$j.static,r$d=r$j.class,r$M=r$j.getset,r$e=(r$j.__newvec,laya.display.Animation),r$c=(laya.utils.Browser,laya.utils.ClassUtils),r$T=laya.filters.ColorFilter,r$U=laya.utils.Ease,r$i=laya.events.Event,r$R=(laya.events.EventDispatcher,laya.display.css.Font),r$o=laya.display.FrameAnimation,r$Y=laya.display.Graphics,r$p=laya.utils.Handler,r$J=laya.display.Input,r$z=laya.net.Loader,r$L=(laya.display.Node,laya.maths.Point),r$G=laya.maths.Rectangle,r$A=laya.renders.Render,r$v=laya.display.Sprite,r$D=laya.display.Text,r$B=laya.resource.Texture,r$O=laya.utils.Tween,r$H=laya.utils.Utils,r$g=laya.utils.WeakObject;r$j.interface("laya.ui.IItem"),r$j.interface("laya.ui.ISelect"),r$j.interface("laya.ui.IRender"),r$j.interface("laya.ui.IComponent"),r$j.interface("laya.ui.IBox","IComponent");var r$I=function(){function r$S(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return r$d(r$S,"laya.ui.LayoutStyle"),r$l(r$S,["EMPTY",function(){return this.EMPTY=new r$S}]),r$S}(),r$E=function(){function r$S(){}return r$d(r$S,"laya.ui.Styles"),r$S.labelColor="#000000",r$S.buttonStateNum=3,r$S.scrollBarMinNum=15,r$S.scrollBarDelayTime=500,r$l(r$S,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),r$S}(),r$t=function(){function r$M(){}return r$d(r$M,"laya.ui.UIUtils"),r$M.fillArray=function(r$S,r$Q,r$e){var r$l=r$S.concat();if(r$Q)for(var r$M=r$Q.split(","),r$d=0,r$T=Math.min(r$l.length,r$M.length);r$d<r$T;r$d++){var r$U=r$M[r$d];r$l[r$d]="true"==r$U||"false"!=r$U&&r$U,null!=r$e&&(r$l[r$d]=r$e(r$U))}return r$l},r$M.toColor=function(r$S){return r$H.toHexColor(r$S)},r$M.gray=function(r$S,r$Q){void 0===r$Q&&(r$Q=!0),r$Q?r$M.addFilter(r$S,r$M.grayFilter):r$M.clearFilter(r$S,r$T)},r$M.addFilter=function(r$S,r$Q){var r$e=r$S.filters||[];r$e.push(r$Q),r$S.filters=r$e},r$M.clearFilter=function(r$S,r$Q){var r$e=r$S.filters;if(null!=r$e&&0<r$e.length){for(var r$l=r$e.length-1;-1<r$l;r$l--){var r$M=r$e[r$l];r$j.__typeof(r$M,r$Q)&&r$e.splice(r$l,1)}r$S.filters=r$e}},r$M._getReplaceStr=function(r$S){return r$M.escapeSequence[r$S]},r$M.adptString=function(r$S){return r$S.replace(/\\(\w)/g,r$M._getReplaceStr)},r$M.getBindFun=function(r$S){var r$Q=r$M._funMap.get(r$S);if(null==r$Q){var r$e='"'+r$S+'"',r$l="(function(data){if(data==null)return;with(data){try{\nreturn "+(r$e=r$e.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";r$Q=r$j._runScript(r$l),r$M._funMap.set(r$S,r$Q)}return r$Q},r$l(r$M,["grayFilter",function(){return this.grayFilter=new r$T([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new r$g}]),r$M}(),r$k=function(){function r$S(){}return r$d(r$S,"UIConfig"),r$S.touchScrollEnable=!0,r$S.mouseWheelEnable=!0,r$S.showButtons=!0,r$S.popupBgColor="#000000",r$S.popupBgAlpha=.5,r$S.closeDialogOnSide=!0,r$S}(),r$X=function(r$e){function r$G(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,r$G.__super.call(this),this._weakKeys=[]}r$d(r$G,"laya.ui.AutoBitmap",r$e);var r$S=r$G.prototype;return r$S.destroy=function(){if(r$z.clearObject(this,this._weakKey),this._weakKeys){for(var r$S=0,r$Q=this._weakKeys.length;r$S<r$Q;++r$S)r$z.clearObject(this,this._weakKeys[r$S]);this._weakKeys=null}r$e.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},r$S._setChanged=function(){this._isChanged||(this._isChanged=!0,r$j.timer.callLater(this,this.changeSource))},r$S.changeSource=function(){this._isChanged=!1;var r$S=this._source;if(r$S&&r$S.bitmap){var r$Q=this.width,r$e=this.height,r$l=this._sizeGrid,r$M=r$S.sourceWidth,r$d=r$S.sourceHeight;if(!r$l||r$M===r$Q&&r$d===r$e)this.cleanByTexture(r$S,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,r$Q,r$e);else{r$z.clearObject(this,this._weakKey),r$S.$_GID||(r$S.$_GID=r$H.getGID());var r$T=r$S.$_GID+"."+r$Q+"."+r$e+"."+r$l.join("."),r$U=r$z.findObject(r$T);if(r$H.isOKCmdList(r$U))return this._weakKey=r$T,r$z.keepObject(this,this._weakKey),void(this.cmds=r$U);this.clear();var r$i,r$R,r$o=r$l[0],r$Y=r$l[1],r$p=r$l[2],r$J=r$l[3],r$L=r$l[4],r$j=!1;if(r$Q==r$M&&(r$J=r$Y=0),r$e==r$d&&(r$o=r$p=0),r$Q<r$J+r$Y){var r$c=r$Q;r$j=!0,r$Q=r$J+r$Y,this.save(),this.clipRect(0,0,r$c,r$e)}r$J&&r$o&&(r$i=r$G.getTexture(r$S,0,0,r$J,r$o),r$R=this._weakKeys[0],r$i?(r$R!=r$i.weakKey&&(r$z.clearObject(this,r$R),r$z.keepObject(this,r$i.weakKey),this._weakKeys[0]=r$i.weakKey),this.drawTexture(r$i,0,0,r$J,r$o)):(r$z.clearObject(this,r$R),this._weakKeys[0]="")),r$Y&&r$o&&(r$i=r$G.getTexture(r$S,r$M-r$Y,0,r$Y,r$o),r$R=this._weakKeys[1],r$i?(r$R!=r$i.weakKey&&(r$z.clearObject(this,r$R),r$z.keepObject(this,r$i.weakKey),this._weakKeys[1]=r$i.weakKey),this.drawTexture(r$i,r$Q-r$Y,0,r$Y,r$o)):(r$z.clearObject(this,r$R),this._weakKeys[1]="")),r$J&&r$p&&(r$i=r$G.getTexture(r$S,0,r$d-r$p,r$J,r$p),r$R=this._weakKeys[2],r$i?(r$R!=r$i.weakKey&&(r$z.clearObject(this,r$R),r$z.keepObject(this,r$i.weakKey),this._weakKeys[2]=r$i.weakKey),this.drawTexture(r$i,0,r$e-r$p,r$J,r$p)):(r$z.clearObject(this,r$R),this._weakKeys[2]="")),r$Y&&r$p&&(r$i=r$G.getTexture(r$S,r$M-r$Y,r$d-r$p,r$Y,r$p),r$R=this._weakKeys[3],r$i?(r$R!=r$i.weakKey&&(r$z.clearObject(this,r$R),r$z.keepObject(this,r$i.weakKey),this._weakKeys[3]=r$i.weakKey),this.drawTexture(r$i,r$Q-r$Y,r$e-r$p,r$Y,r$p)):(r$z.clearObject(this,r$R),this._weakKeys[3]="")),r$o&&(r$i=r$G.getTexture(r$S,r$J,0,r$M-r$J-r$Y,r$o),r$R=this._weakKeys[4],r$i?(r$R!=r$i.weakKey&&(r$z.clearObject(this,r$R),r$z.keepObject(this,r$i.weakKey),this._weakKeys[4]=r$i.weakKey),this.drawBitmap(r$L,r$i,r$J,0,r$Q-r$J-r$Y,r$o)):(r$z.clearObject(this,r$R),this._weakKeys[4]="")),r$p&&(r$i=r$G.getTexture(r$S,r$J,r$d-r$p,r$M-r$J-r$Y,r$p),r$R=this._weakKeys[5],r$i?(r$R!=r$i.weakKey&&(r$z.clearObject(this,r$R),r$z.keepObject(this,r$i.weakKey),this._weakKeys[5]=r$i.weakKey),this.drawBitmap(r$L,r$i,r$J,r$e-r$p,r$Q-r$J-r$Y,r$p)):(r$z.clearObject(this,r$R),this._weakKeys[5]="")),r$J&&(r$i=r$G.getTexture(r$S,0,r$o,r$J,r$d-r$o-r$p),r$R=this._weakKeys[6],r$i?(r$R!=r$i.weakKey&&(r$z.clearObject(this,r$R),r$z.keepObject(this,r$i.weakKey),this._weakKeys[6]=r$i.weakKey),this.drawBitmap(r$L,r$i,0,r$o,r$J,r$e-r$o-r$p)):(r$z.clearObject(this,r$R),this._weakKeys[6]="")),r$Y&&(r$i=r$G.getTexture(r$S,r$M-r$Y,r$o,r$Y,r$d-r$o-r$p),r$R=this._weakKeys[7],r$i?(r$R!=r$i.weakKey&&(r$z.clearObject(this,r$R),r$z.keepObject(this,r$i.weakKey),this._weakKeys[7]=r$i.weakKey),this.drawBitmap(r$L,r$i,r$Q-r$Y,r$o,r$Y,r$e-r$o-r$p)):(r$z.clearObject(this,r$R),this._weakKeys[7]="")),r$i=r$G.getTexture(r$S,r$J,r$o,r$M-r$J-r$Y,r$d-r$o-r$p),r$R=this._weakKeys[8],r$i?(r$R!=r$i.weakKey&&(r$z.clearObject(this,r$R),r$z.keepObject(this,r$i.weakKey),this._weakKeys[8]=r$i.weakKey),this.drawBitmap(r$L,r$i,r$J,r$o,r$Q-r$J-r$Y,r$e-r$o-r$p)):(r$z.clearObject(this,r$R),this._weakKeys[8]=""),r$j&&this.restore(),this.autoCacheCmd&&!r$A.isConchApp&&(r$z.saveObject(r$T,this.cmds,null),this._weakKey=r$T,r$z.keepObject(this,this._weakKey))}this._repaint()}},r$S.drawBitmap=function(r$S,r$Q,r$e,r$l,r$M,r$d){void 0===r$M&&(r$M=0),void 0===r$d&&(r$d=0),r$M<.1||r$d<.1||(!r$S||r$Q.width==r$M&&r$Q.height==r$d?this.drawTexture(r$Q,r$e,r$l,r$M,r$d):this.fillTexture(r$Q,r$e,r$l,r$M,r$d))},r$S.clear=function(r$S){void 0===r$S&&(r$S=!0),r$e.prototype.clear.call(this,!1)},r$M(0,r$S,"sizeGrid",function(){return this._sizeGrid},function(r$S){this._sizeGrid=r$S,this._setChanged()}),r$M(0,r$S,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(r$S){this._width!=r$S&&(this._width=r$S,this._setChanged())}),r$M(0,r$S,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(r$S){this._height!=r$S&&(this._height=r$S,this._setChanged())}),r$M(0,r$S,"source",function(){return this._source},function(r$S){r$S?(this._source=r$S,this._setChanged()):(this._source=null,this.clear())}),r$G.getTexture=function(r$S,r$Q,r$e,r$l,r$M){r$l<=0&&(r$l=1),r$M<=0&&(r$M=1),r$S.$_GID||(r$S.$_GID=r$H.getGID());var r$d=r$S.$_GID+"."+r$Q+"."+r$e+"."+r$l+"."+r$M,r$T=r$z.findObject(r$d);if((!r$T||!r$T.source)&&(r$T=r$B.createFromTexture(r$S,r$Q,r$e,r$l,r$M))){if(r$S.alphaTexture){var r$U=r$S.width/r$S.alphaTexture.width;r$T.alphaTexture=r$B.createFromTexture(r$S.alphaTexture,r$Q/r$U,r$e/r$U,r$l/r$U,r$M/r$U)}r$z.saveObject(r$d,r$T),r$T.weakKey=r$d}return r$T},r$G}(r$Y),r$h=(function(r$S){function r$Q(){r$Q.__super.call(this)}r$d(r$Q,"laya.ui.UIEvent",r$i),r$Q.SHOW_TIP="showtip",r$Q.HIDE_TIP="hidetip"}(),function(r$Q){function r$S(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,r$S.__super.call(this),this._layout=r$I.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}r$d(r$S,"laya.ui.Component",r$Q);var r$e=r$S.prototype;return r$j.imps(r$e,{"laya.ui.IComponent":!0}),r$e.destroy=function(r$S){void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,r$S),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},r$e.preinitialize=function(){},r$e.createChildren=function(){},r$e.initialize=function(){},r$e.callLater=function(r$S,r$Q){r$j.timer.callLater(this,r$S,r$Q)},r$e.runCallLater=function(r$S){r$j.timer.runCallLater(this,r$S)},r$e.commitMeasure=function(){},r$e.changeSize=function(){this.event("resize")},r$e.getLayout=function(){return this._layout===r$I.EMPTY&&(this._layout=new r$I),this._layout},r$e._setLayoutEnabled=function(r$S){this._layout&&this._layout.enable!=r$S&&(this._layout.enable=r$S,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},r$e.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},r$e.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},r$e.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},r$e.resetLayoutX=function(){var r$S=this._layout;if(isNaN(r$S.anchorX)||(this.pivotX=r$S.anchorX*this.width),this.layoutEnabled){var r$Q=this.parent;r$Q&&(isNaN(r$S.centerX)?isNaN(r$S.left)?isNaN(r$S.right)||(this.x=Math.round(r$Q.width-this.displayWidth-r$S.right+this.pivotX*this.scaleX)):(this.x=Math.round(r$S.left+this.pivotX*this.scaleX),isNaN(r$S.right)||(this.width=(r$Q._width-r$S.left-r$S.right)/(this.scaleX||.01))):this.x=Math.round(.5*(r$Q.width-this.displayWidth)+r$S.centerX+this.pivotX*this.scaleX))}},r$e.resetLayoutY=function(){var r$S=this._layout;if(isNaN(r$S.anchorY)||(this.pivotY=r$S.anchorY*this.height),this.layoutEnabled){var r$Q=this.parent;r$Q&&(isNaN(r$S.centerY)?isNaN(r$S.top)?isNaN(r$S.bottom)||(this.y=Math.round(r$Q.height-this.displayHeight-r$S.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(r$S.top+this.pivotY*this.scaleY),isNaN(r$S.bottom)||(this.height=(r$Q._height-r$S.top-r$S.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(r$Q.height-this.displayHeight)+r$S.centerY+this.pivotY*this.scaleY))}},r$e.onMouseOver=function(r$S){r$j.stage.event("showtip",this._toolTip)},r$e.onMouseOut=function(r$S){r$j.stage.event("hidetip",this._toolTip)},r$M(0,r$e,"displayWidth",function(){return this.width*this.scaleX}),r$M(0,r$e,"width",function(){return this._width?this._width:this.measureWidth},function(r$S){this._width!=r$S&&(this._width=r$S,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),r$M(0,r$e,"measureWidth",function(){var r$S=0;this.commitMeasure();for(var r$Q=this.numChildren-1;-1<r$Q;r$Q--){var r$e=this.getChildAt(r$Q);r$e.visible&&(r$S=Math.max(r$e.x+r$e.width*r$e.scaleX,r$S))}return r$S}),r$M(0,r$e,"displayHeight",function(){return this.height*this.scaleY}),r$M(0,r$e,"height",function(){return this._height?this._height:this.measureHeight},function(r$S){this._height!=r$S&&(this._height=r$S,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),r$M(0,r$e,"dataSource",function(){return this._dataSource},function(r$S){for(var r$Q in this._dataSource=r$S,this._dataSource)this.hasOwnProperty(r$Q)&&"function"!=typeof this[r$Q]&&(this[r$Q]=this._dataSource[r$Q])}),r$M(0,r$e,"scaleY",r$Q.prototype._$get_scaleY,function(r$S){r$j.superGet(r$v,this,"scaleY")!=r$S&&(r$j.superSet(r$v,this,"scaleY",r$S),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),r$M(0,r$e,"measureHeight",function(){var r$S=0;this.commitMeasure();for(var r$Q=this.numChildren-1;-1<r$Q;r$Q--){var r$e=this.getChildAt(r$Q);r$e.visible&&(r$S=Math.max(r$e.y+r$e.height*r$e.scaleY,r$S))}return r$S}),r$M(0,r$e,"scaleX",r$Q.prototype._$get_scaleX,function(r$S){r$j.superGet(r$v,this,"scaleX")!=r$S&&(r$j.superSet(r$v,this,"scaleX",r$S),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),r$M(0,r$e,"top",function(){return this._layout.top},function(r$S){r$S!=this._layout.top&&(this.getLayout().top=r$S,this._setLayoutEnabled(!0)),this.resetLayoutY()}),r$M(0,r$e,"bottom",function(){return this._layout.bottom},function(r$S){r$S!=this._layout.bottom&&(this.getLayout().bottom=r$S,this._setLayoutEnabled(!0)),this.resetLayoutY()}),r$M(0,r$e,"left",function(){return this._layout.left},function(r$S){r$S!=this._layout.left&&(this.getLayout().left=r$S,this._setLayoutEnabled(!0)),this.resetLayoutX()}),r$M(0,r$e,"right",function(){return this._layout.right},function(r$S){r$S!=this._layout.right&&(this.getLayout().right=r$S,this._setLayoutEnabled(!0)),this.resetLayoutX()}),r$M(0,r$e,"centerX",function(){return this._layout.centerX},function(r$S){r$S!=this._layout.centerX&&(this.getLayout().centerX=r$S,this._setLayoutEnabled(!0)),this.resetLayoutX()}),r$M(0,r$e,"centerY",function(){return this._layout.centerY},function(r$S){r$S!=this._layout.centerY&&(this.getLayout().centerY=r$S,this._setLayoutEnabled(!0)),this.resetLayoutY()}),r$M(0,r$e,"anchorX",function(){return this._layout.anchorX},function(r$S){r$S!=this._layout.anchorX&&(this.getLayout().anchorX=r$S,this._setLayoutEnabled(!0)),this.resetLayoutX()}),r$M(0,r$e,"anchorY",function(){return this._layout.anchorY},function(r$S){r$S!=this._layout.anchorY&&(this.getLayout().anchorY=r$S,this._setLayoutEnabled(!0)),this.resetLayoutY()}),r$M(0,r$e,"tag",function(){return this._tag},function(r$S){this._tag=r$S}),r$M(0,r$e,"toolTip",function(){return this._toolTip},function(r$S){this._toolTip!=r$S&&(null!=(this._toolTip=r$S)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),r$M(0,r$e,"comXml",function(){return this._comXml},function(r$S){this._comXml=r$S}),r$M(0,r$e,"gray",function(){return this._gray},function(r$S){r$S!==this._gray&&(this._gray=r$S,r$t.gray(this,r$S))}),r$M(0,r$e,"disabled",function(){return this._disabled},function(r$S){r$S!==this._disabled&&(this.gray=this._disabled=r$S,this.mouseEnabled=!r$S)}),r$S}(r$v)),r$b=function(r$S){function r$Q(){this.lockLayer=null,this.popupEffect=function(r$S){r$S.scale(1,1),r$O.from(r$S,{x:r$j.stage.width/2,y:r$j.stage.height/2,scaleX:0,scaleY:0},300,r$U.backOut,r$p.create(this,this.doOpen,[r$S]))},this.closeEffect=function(r$S,r$Q){r$O.to(r$S,{x:r$j.stage.width/2,y:r$j.stage.height/2,scaleX:0,scaleY:0},300,r$U.strongOut,r$p.create(this,this.doClose,[r$S,r$Q]))},r$Q.__super.call(this),this.maskLayer=new r$v,this.popupEffectHandler=r$p.create(this,this.popupEffect,null,!1),this.closeEffectHandler=r$p.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,r$j.stage.addChild(this),r$j.stage.on("resize",this,this._onResize),r$k.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}r$d(r$Q,"laya.ui.DialogManager",r$v);var r$e=r$Q.prototype;return r$e._closeOnSide=function(){var r$S=this.getChildAt(this.numChildren-1);r$S instanceof laya.ui.Dialog&&r$S.close("side")},r$e.setLockView=function(r$S){this.lockLayer||(this.lockLayer=new r$m,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(r$j.stage.width,r$j.stage.height)),this.lockLayer.removeChildren(),r$S&&(r$S.centerX=r$S.centerY=0,this.lockLayer.addChild(r$S))},r$e._onResize=function(r$S){var r$Q=this.maskLayer.width=r$j.stage.width,r$e=this.maskLayer.height=r$j.stage.height;this.lockLayer&&this.lockLayer.size(r$Q,r$e),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,r$Q,r$e,r$k.popupBgColor),this.maskLayer.alpha=r$k.popupBgAlpha;for(var r$l=this.numChildren-1;-1<r$l;r$l--){var r$M=this.getChildAt(r$l);r$M.popupCenter&&this._centerDialog(r$M)}},r$e._centerDialog=function(r$S){r$S.x=Math.round((r$j.stage.width-r$S.width>>1)+r$S.pivotX),r$S.y=Math.round((r$j.stage.height-r$S.height>>1)+r$S.pivotY)},r$e.open=function(r$S,r$Q,r$e){void 0===r$Q&&(r$Q=!1),void 0===r$e&&(r$e=!1),r$Q&&this._closeAll(),r$S.popupCenter&&this._centerDialog(r$S),this.addChild(r$S),(r$S.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),r$e&&null!=r$S.popupEffect?r$S.popupEffect.runWith(r$S):this.doOpen(r$S),this.event("open")},r$e.doOpen=function(r$S){r$S.onOpened()},r$e.lock=function(r$S){this.lockLayer&&(r$S?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},r$e.close=function(r$S,r$Q,r$e){void 0===r$e&&(r$e=!1),r$e&&null!=r$S.closeEffect?r$S.closeEffect.runWith([r$S,r$Q]):this.doClose(r$S,r$Q),this.event("close")},r$e.doClose=function(r$S,r$Q){r$S.removeSelf(),r$S.isModal&&this._checkMask(),r$S.closeHandler&&r$S.closeHandler.runWith(r$Q),r$S.onClosed(r$Q)},r$e.closeAll=function(){this._closeAll(),this.event("close")},r$e._closeAll=function(){for(var r$S=this.numChildren-1;-1<r$S;r$S--){var r$Q=this.getChildAt(r$S);r$Q&&null!=r$Q.close&&this.doClose(r$Q)}},r$e.getDialogsByGroup=function(r$S){for(var r$Q=[],r$e=this.numChildren-1;-1<r$e;r$e--){var r$l=this.getChildAt(r$e);r$l&&r$l.group===r$S&&r$Q.push(r$l)}return r$Q},r$e.closeByGroup=function(r$S){for(var r$Q=[],r$e=this.numChildren-1;-1<r$e;r$e--){var r$l=this.getChildAt(r$e);r$l&&r$l.group===r$S&&(r$l.close(),r$Q.push(r$l))}return r$Q},r$e._checkMask=function(){this.maskLayer.removeSelf();for(var r$S=this.numChildren-1;-1<r$S;r$S--){var r$Q=this.getChildAt(r$S);if(r$Q&&r$Q.isModal)return void this.addChildAt(this.maskLayer,r$S)}},r$Q}(),r$m=function(r$S){function r$Q(){r$Q.__super.call(this)}r$d(r$Q,"laya.ui.Box",r$S);var r$e=r$Q.prototype;return r$j.imps(r$e,{"laya.ui.IBox":!0}),r$M(0,r$e,"dataSource",r$S.prototype._$get_dataSource,function(r$S){for(var r$Q in this._dataSource=r$S){var r$e=this.getChildByName(r$Q);r$e?r$e.dataSource=r$S[r$Q]:this.hasOwnProperty(r$Q)&&"function"!=typeof this[r$Q]&&(this[r$Q]=r$S[r$Q])}}),r$Q}(r$h),r$$=function(r$Q){function r$e(r$S,r$Q){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,r$e.__super.call(this),this._labelColors=r$E.buttonLabelColors,this._stateNum=r$E.buttonStateNum,void 0===r$Q&&(r$Q=""),this.skin=r$S,this.label=r$Q}r$d(r$e,"laya.ui.Button",r$Q);var r$S=r$e.prototype;return r$j.imps(r$S,{"laya.ui.ISelect":!0}),r$S.destroy=function(r$S){r$z.clearCache(this,this._skin),r$z.clearObject(this,this._weakKey),void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,r$S),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(r$S),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},r$S.createChildren=function(){this.graphics=this._bitmap=new r$X},r$S.createText=function(){this._text||(this._text=new r$D,this._text.overflow=r$D.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},r$S.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},r$S.onMouse=function(r$S){if(!1!==this.toggle||!this._selected)return"click"===r$S.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=r$e.stateMap[r$S.type]))},r$S.changeClips=function(){var r$S=r$z.getRes(this._skin);if(r$S&&this._skin&&""!=this._skin){r$z.clearObject(this,this._weakKey);var r$Q=r$S.sourceWidth,r$e=r$S.sourceHeight/this._stateNum;r$S.$_GID||(r$S.$_GID=r$H.getGID());var r$l=r$S.$_GID+"-"+this._stateNum,r$M=r$z.findObject(r$l);if(r$H.isOkTextureList(r$M)||(r$M=null),r$M)this._weakKey=r$l,r$z.keepObject(this,this._weakKey),this._sources=r$M;else{if(this._sources=[],1===this._stateNum)this._sources.push(r$S);else for(var r$d=0;r$d<this._stateNum;r$d++){var r$T=r$B.createFromTexture(r$S,0,r$e*r$d,r$Q,r$e);if(r$S.alphaTexture){var r$U=r$S.width/r$S.alphaTexture.width;r$T.alphaTexture=r$B.createFromTexture(r$S.alphaTexture,0/r$U,r$e*r$d/r$U,r$Q/r$U,r$e/r$U)}this._sources.push(r$T)}r$z.saveObject(r$l,this._sources),this._weakKey=r$l,r$z.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||r$Q,this._bitmap.height=this._height||r$e,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=r$Q)}else console.warn("lose skin ",this._skin,this.name,this.__className)},r$S.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var r$S=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[r$S]),this.label&&(this._text.color=this._labelColors[r$S],this._strokeColors&&(this._text.strokeColor=this._strokeColors[r$S]))},r$S._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},r$M(0,r$S,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(r$S){this.createText(),this._text.strokeColor=r$S}),r$M(0,r$S,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),r$M(0,r$S,"skin",function(){return this._skin},function(r$S){this._skin!=r$S&&(r$z.clearCache(this,this._skin),this._skin=r$S,r$z.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),r$M(0,r$S,"state",function(){return this._state},function(r$S){this._state!=r$S&&(this._state=r$S,this._setStateChanged())}),r$M(0,r$S,"text",function(){return this.createText(),this._text}),r$M(0,r$S,"stateNum",function(){return this._stateNum},function(r$S){"string"==typeof r$S&&(r$S=parseInt(r$S)),this._stateNum!=r$S&&(this._stateNum=r$S<1?1:3<r$S?3:r$S,this.callLater(this.changeClips))}),r$M(0,r$S,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(r$S){this._strokeColors=r$t.fillArray(r$E.buttonLabelColors,r$S,String),this._setStateChanged()}),r$M(0,r$S,"labelColors",function(){return this._labelColors.join(",")},function(r$S){this._labelColors=r$t.fillArray(r$E.buttonLabelColors,r$S,String),this._setStateChanged()}),r$M(0,r$S,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),r$M(0,r$S,"label",function(){return this._text?this._text.text:null},function(r$S){(this._text||r$S)&&(this.createText(),this._text.text!=r$S&&(r$S&&!this._text.parent&&this.addChild(this._text),this._text.text=(r$S+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),r$M(0,r$S,"selected",function(){return this._selected},function(r$S){this._selected!=r$S&&(this._selected=r$S,this.state=this._selected?2:0,this.event("change"))}),r$M(0,r$S,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(r$S){this.createText(),this._text.padding=r$t.fillArray(r$E.labelPadding,r$S,Number)}),r$M(0,r$S,"labelSize",function(){return this.createText(),this._text.fontSize},function(r$S){this.createText(),this._text.fontSize=r$S}),r$M(0,r$S,"labelStroke",function(){return this.createText(),this._text.stroke},function(r$S){this.createText(),this._text.stroke=r$S}),r$M(0,r$S,"labelBold",function(){return this.createText(),this._text.bold},function(r$S){this.createText(),this._text.bold=r$S}),r$M(0,r$S,"labelFont",function(){return this.createText(),this._text.font},function(r$S){this.createText(),this._text.font=r$S}),r$M(0,r$S,"labelAlign",function(){return this.createText(),this._text.align},function(r$S){this.createText(),this._text.align=r$S}),r$M(0,r$S,"clickHandler",function(){return this._clickHandler},function(r$S){this._clickHandler=r$S}),r$M(0,r$S,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(r$S){this._bitmap.sizeGrid=r$t.fillArray(r$E.defaultSizeGrid,r$S,Number)}),r$M(0,r$S,"width",r$Q.prototype._$get_width,function(r$S){r$j.superSet(r$h,this,"width",r$S),this._autoSize&&(this._bitmap.width=r$S,this._text&&(this._text.width=r$S))}),r$M(0,r$S,"height",r$Q.prototype._$get_height,function(r$S){r$j.superSet(r$h,this,"height",r$S),this._autoSize&&(this._bitmap.height=r$S,this._text&&(this._text.height=r$S))}),r$M(0,r$S,"dataSource",r$Q.prototype._$get_dataSource,function(r$S){"number"==typeof(this._dataSource=r$S)||"string"==typeof r$S?this.label=r$S+"":r$j.superSet(r$h,this,"dataSource",r$S)}),r$M(0,r$S,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(r$S){this._bitmap._offset=r$S?r$t.fillArray([1,1],r$S,Number):[]}),r$l(r$e,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),r$e}(r$h),r$n=function(r$Q){function r$l(r$S,r$Q,r$e){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,r$l.__super.call(this),void 0===r$Q&&(r$Q=1),void 0===r$e&&(r$e=1),this._clipX=r$Q,this._clipY=r$e,this.skin=r$S}r$d(r$l,"laya.ui.Clip",r$Q);var r$S=r$l.prototype;return r$S.destroy=function(r$S){r$z.clearCache(this,this._skin),r$z.clearObject(this,this._weakKey),void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},r$S.dispose=function(){this.destroy(!0),r$j.loader.clearRes(this._skin)},r$S.createChildren=function(){this.graphics=this._bitmap=new r$X},r$S._onDisplay=function(r$S){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},r$S.changeClip=function(){if(this._clipChanged=!1,this._skin){var r$S=r$z.getRes(this._skin);r$S?this.loadComplete(this._skin,r$S):r$j.loader.load(this._skin,r$p.create(this,this.loadComplete,[this._skin]))}},r$S.loadComplete=function(r$S,r$Q){if(r$S===this._skin&&r$Q){r$z.clearObject(this,this._weakKey);var r$e=this._clipWidth||Math.ceil(r$Q.sourceWidth/this._clipX),r$l=this._clipHeight||Math.ceil(r$Q.sourceHeight/this._clipY),r$M=this._skin+r$e+r$l,r$d=r$z.findObject(r$M);if(r$H.isOkTextureList(r$d)||(r$d=null),r$d)this._weakKey=r$M,r$z.keepObject(this,this._weakKey),this._sources=r$d;else{this._sources=[];for(var r$T=0;r$T<this._clipY;r$T++)for(var r$U=0;r$U<this._clipX;r$U++){var r$i=r$B.createFromTexture(r$Q,r$e*r$U,r$l*r$T,r$e,r$l);if(r$Q.alphaTexture){var r$R=r$Q.width/r$Q.alphaTexture.width;r$i.alphaTexture=r$B.createFromTexture(r$Q.alphaTexture,r$e*r$U/r$R,r$l*r$T/r$R,r$e/r$R,r$l/r$R)}this._sources.push(r$i)}r$z.saveObject(r$M,this._sources),this._weakKey=r$M,r$z.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},r$S.play=function(r$S,r$Q){void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=-1),this._isPlaying=!0,this.index=r$S,this._toIndex=r$Q,this._index++,r$j.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},r$S._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},r$S.stop=function(){this._isPlaying=!1,r$j.timer.clear(this,this._loop),this.event("complete")},r$S._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},r$M(0,r$S,"interval",function(){return this._interval},function(r$S){this._interval!=r$S&&(this._interval=r$S,this._isPlaying&&this.play())}),r$M(0,r$S,"skin",function(){return this._skin},function(r$S){this._skin!=r$S&&(r$z.clearCache(this,this._skin),(this._skin=r$S)?(r$z.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),r$M(0,r$S,"sources",function(){return this._sources},function(r$S){this._sources=r$S,this.index=this._index,this.event("loaded")}),r$M(0,r$S,"clipX",function(){return this._clipX},function(r$S){this._clipX=r$S||1,this._setClipChanged()}),r$M(0,r$S,"clipY",function(){return this._clipY},function(r$S){this._clipY=r$S||1,this._setClipChanged()}),r$M(0,r$S,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),r$M(0,r$S,"clipWidth",function(){return this._clipWidth},function(r$S){this._clipWidth=r$S,this._setClipChanged()}),r$M(0,r$S,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(r$S){this._bitmap.sizeGrid=r$t.fillArray(r$E.defaultSizeGrid,r$S,Number)}),r$M(0,r$S,"group",function(){return this._group},function(r$S){r$S&&this._skin&&r$z.setGroup(this._skin,r$S),this._group=r$S}),r$M(0,r$S,"clipHeight",function(){return this._clipHeight},function(r$S){this._clipHeight=r$S,this._setClipChanged()}),r$M(0,r$S,"width",r$Q.prototype._$get_width,function(r$S){r$j.superSet(r$h,this,"width",r$S),this._bitmap.width=r$S}),r$M(0,r$S,"height",r$Q.prototype._$get_height,function(r$S){r$j.superSet(r$h,this,"height",r$S),this._bitmap.height=r$S}),r$M(0,r$S,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),r$M(0,r$S,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),r$M(0,r$S,"index",function(){return this._index},function(r$S){this._index=r$S,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[r$S]),this.event("change")}),r$M(0,r$S,"autoPlay",function(){return this._autoPlay},function(r$S){this._autoPlay!=r$S&&((this._autoPlay=r$S)?this.play():this.stop())}),r$M(0,r$S,"isPlaying",function(){return this._isPlaying},function(r$S){this._isPlaying=r$S}),r$M(0,r$S,"dataSource",r$Q.prototype._$get_dataSource,function(r$S){"number"==typeof(this._dataSource=r$S)&&Math.floor(r$S)==r$S||"string"==typeof r$S?this.index=parseInt(r$S):r$j.superSet(r$h,this,"dataSource",r$S)}),r$M(0,r$S,"bitmap",function(){return this._bitmap}),r$l}(r$h),r$P=function(r$Q){function r$S(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,r$S.__super.call(this)}r$d(r$S,"laya.ui.ColorPicker",r$Q);var r$e=r$S.prototype;return r$e.destroy=function(r$S){void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,r$S),this._colorPanel&&this._colorPanel.destroy(r$S),this._colorButton&&this._colorButton.destroy(r$S),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},r$e.createChildren=function(){this.addChild(this._colorButton=new r$$),this._colorPanel=new r$m,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new r$v),this._colorPanel.addChild(this._colorBlock=new r$v),this._colorPanel.addChild(this._colorInput=new r$J)},r$e.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},r$e.onPanelMouseDown=function(r$S){r$S.stopPropagation()},r$e.changePanel=function(){this._panelChanged=!1;var r$S=this._colorPanel.graphics;r$S.clear(),r$S.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(r$S=this._colorTiles.graphics).clear();for(var r$Q=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],r$e=0;r$e<12;r$e++)for(var r$l=0;r$l<20;r$l++){var r$M=0;r$M=0===r$l?r$Q[r$e]:1===r$l?0:51*(((3*r$e+r$l/6)%3<<0)+3*(r$e/6<<0))<<16|r$l%6*51<<8|(r$e<<0)%6*51;var r$d=r$t.toColor(r$M);this._colors.push(r$d);var r$T=r$l*this._gridSize,r$U=r$e*this._gridSize;r$S.drawRect(r$T,r$U,this._gridSize,this._gridSize,r$d,"#000000")}},r$e.onColorButtonClick=function(r$S){this._colorPanel.parent?this.close():this.open()},r$e.open=function(){var r$S=this.localToGlobal(new r$L),r$Q=r$S.x+this._colorPanel.width<=r$j.stage.width?r$S.x:r$j.stage.width-this._colorPanel.width,r$e=r$S.y+this._colorButton.height;r$e=r$e+this._colorPanel.height<=r$j.stage.height?r$e:r$S.y-this._colorPanel.height,this._colorPanel.pos(r$Q,r$e),this._colorPanel.zOrder=1001,r$j._currentStage.addChild(this._colorPanel),r$j.stage.on("mousedown",this,this.removeColorBox)},r$e.close=function(){r$j.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},r$e.removeColorBox=function(r$S){this.close()},r$e.onColorFieldKeyDown=function(r$S){13==r$S.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),r$S.stopPropagation())},r$e.onColorInputChange=function(r$S){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},r$e.onColorTilesClick=function(r$S){this.selectedColor=this.getColorByMouse(),this.close()},r$e.onColorTilesMouseMove=function(r$S){this._colorInput.focus=!1;var r$Q=this.getColorByMouse();this._colorInput.text=r$Q,this.drawBlock(r$Q)},r$e.getColorByMouse=function(){var r$S=this._colorTiles.getMousePoint(),r$Q=Math.floor(r$S.x/this._gridSize),r$e=Math.floor(r$S.y/this._gridSize);return this._colors[20*r$e+r$Q]},r$e.drawBlock=function(r$S){var r$Q=this._colorBlock.graphics;r$Q.clear();var r$e=r$S||"#ffffff";r$Q.drawRect(0,0,50,20,r$e,this._borderColor),r$S||r$Q.drawLine(0,0,50,20,"#ff0000")},r$e.changeColor=function(){var r$S=this.graphics;r$S.clear();var r$Q=this._selectedColor||"#000000";r$S.drawRect(0,0,this._colorButton.width,this._colorButton.height,r$Q)},r$e._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},r$M(0,r$e,"inputBgColor",function(){return this._inputBgColor},function(r$S){this._inputBgColor=r$S,this._setPanelChanged()}),r$M(0,r$e,"selectedColor",function(){return this._selectedColor},function(r$S){this._selectedColor!=r$S&&(this._selectedColor=this._colorInput.text=r$S,this.drawBlock(r$S),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",r$i.EMPTY.setTo("change",this,this)))}),r$M(0,r$e,"skin",function(){return this._colorButton.skin},function(r$S){this._colorButton.skin=r$S,this.changeColor()}),r$M(0,r$e,"bgColor",function(){return this._bgColor},function(r$S){this._bgColor=r$S,this._setPanelChanged()}),r$M(0,r$e,"borderColor",function(){return this._borderColor},function(r$S){this._borderColor=r$S,this._setPanelChanged()}),r$M(0,r$e,"inputColor",function(){return this._inputColor},function(r$S){this._inputColor=r$S,this._setPanelChanged()}),r$S}(r$h),r$a=function(r$Q){function r$e(r$S,r$Q){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,r$e.__super.call(this),this._itemColors=r$E.comboBoxItemColors,this.skin=r$S,this.labels=r$Q}r$d(r$e,"laya.ui.ComboBox",r$Q);var r$S=r$e.prototype;return r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,r$S),this._button&&this._button.destroy(r$S),this._list&&this._list.destroy(r$S),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},r$S.createChildren=function(){this.addChild(this._button=new r$$),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},r$S._createList=function(){this._list=new r$N,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},r$S._setListEvent=function(r$S){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=r$p.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},r$S.onListDown=function(r$S){r$S.stopPropagation()},r$S.onScrollBarDown=function(r$S){r$S.stopPropagation()},r$S.onButtonMouseDown=function(r$S){this.callLater(this.switchTo,[!this._isOpen])},r$S.changeList=function(){this._listChanged=!1;var r$S=this.width-2,r$Q=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:r$S,height:this._itemHeight,fontSize:this._itemSize,color:r$Q}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},r$S.onlistItemMouse=function(r$S,r$Q){var r$e=r$S.type;if("mouseover"===r$e||"mouseout"===r$e){if(this._isCustomList)return;var r$l=this._list.getCell(r$Q);if(!r$l)return;var r$M=r$l.getChildByName("label");r$M&&("mouseover"===r$e?(r$M.bgColor=this._itemColors[0],r$M.color=this._itemColors[1]):(r$M.bgColor=null,r$M.color=this._itemColors[2]))}else"click"===r$e&&(this.selectedIndex=r$Q,this.isOpen=!1)},r$S.switchTo=function(r$S){this.isOpen=r$S},r$S.changeOpen=function(){this.isOpen=!this._isOpen},r$S.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var r$S=this._list.graphics;r$S.clear(),r$S.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var r$Q=this._list.array||[],r$e=r$Q.length=0,r$l=this._labels.length;r$e<r$l;r$e++)r$Q.push({label:this._labels[r$e]});this._list.height=this._listHeight,this._list.array=r$Q},r$S.changeSelected=function(){this._button.label=this.selectedLabel},r$S._onStageMouseWheel=function(r$S){this._list&&!this._list.contains(r$S.target)&&this.removeList(null)},r$S.removeList=function(r$S){r$j.stage.off("mousedown",this,this.removeList),r$j.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},r$M(0,r$S,"selectedIndex",function(){return this._selectedIndex},function(r$S){this._selectedIndex!=r$S&&(this._selectedIndex=r$S,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[r$i.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),r$M(0,r$S,"measureHeight",function(){return this._button.height}),r$M(0,r$S,"skin",function(){return this._button.skin},function(r$S){this._button.skin!=r$S&&(this._button.skin=r$S,this._listChanged=!0)}),r$M(0,r$S,"measureWidth",function(){return this._button.width}),r$M(0,r$S,"width",r$Q.prototype._$get_width,function(r$S){r$j.superSet(r$h,this,"width",r$S),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),r$M(0,r$S,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(r$S){this.selectedIndex=this._labels.indexOf(r$S)}),r$M(0,r$S,"labels",function(){return this._labels.join(",")},function(r$S){0<this._labels.length&&(this.selectedIndex=-1),r$S?this._labels=r$S.split(","):this._labels.length=0,this._itemChanged=!0}),r$M(0,r$S,"height",r$Q.prototype._$get_height,function(r$S){r$j.superSet(r$h,this,"height",r$S),this._button.height=this._height}),r$M(0,r$S,"selectHandler",function(){return this._selectHandler},function(r$S){this._selectHandler=r$S}),r$M(0,r$S,"visibleNum",function(){return this._visibleNum},function(r$S){this._visibleNum=r$S,this._listChanged=!0}),r$M(0,r$S,"labelBold",function(){return this._button.text.bold},function(r$S){this._button.text.bold=r$S}),r$M(0,r$S,"itemColors",function(){return String(this._itemColors)},function(r$S){this._itemColors=r$t.fillArray(this._itemColors,r$S,String),this._listChanged=!0}),r$M(0,r$S,"itemSize",function(){return this._itemSize},function(r$S){this._itemSize=r$S,this._listChanged=!0}),r$M(0,r$S,"scrollBar",function(){return this.list.scrollBar}),r$M(0,r$S,"isOpen",function(){return this._isOpen},function(r$S){if(this._isOpen!=r$S)if(this._isOpen=r$S,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var r$Q=this.localToGlobal(r$L.TEMP.setTo(0,0)),r$e=r$Q.y+this._button.height;r$e=r$e+this._listHeight<=r$j.stage.height?r$e:r$Q.y-this._listHeight,this._list.pos(r$Q.x,r$e),this._list.zOrder=1001,r$j._currentStage.addChild(this._list),r$j.stage.once("mousedown",this,this.removeList),r$j.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),r$M(0,r$S,"scrollBarSkin",function(){return this._scrollBarSkin},function(r$S){this._scrollBarSkin=r$S}),r$M(0,r$S,"sizeGrid",function(){return this._button.sizeGrid},function(r$S){this._button.sizeGrid=r$S}),r$M(0,r$S,"button",function(){return this._button}),r$M(0,r$S,"list",function(){return this._list||this._createList(),this._list},function(r$S){r$S&&(r$S.removeSelf(),this._isCustomList=!0,this._list=r$S,this._setListEvent(r$S),this._itemHeight=r$S.getCell(0).height+r$S.spaceY)}),r$M(0,r$S,"dataSource",r$Q.prototype._$get_dataSource,function(r$S){"number"==typeof(this._dataSource=r$S)&&Math.floor(r$S)==r$S||"string"==typeof r$S?this.selectedIndex=parseInt(r$S):r$S instanceof Array?this.labels=r$S.join(","):r$j.superSet(r$h,this,"dataSource",r$S)}),r$M(0,r$S,"labelColors",function(){return this._button.labelColors},function(r$S){this._button.labelColors!=r$S&&(this._button.labelColors=r$S)}),r$M(0,r$S,"labelPadding",function(){return this._button.text.padding.join(",")},function(r$S){this._button.text.padding=r$t.fillArray(r$E.labelPadding,r$S,Number)}),r$M(0,r$S,"labelSize",function(){return this._button.text.fontSize},function(r$S){this._button.text.fontSize=r$S}),r$M(0,r$S,"labelFont",function(){return this._button.text.font},function(r$S){this._button.text.font=r$S}),r$M(0,r$S,"stateNum",function(){return this._button.stateNum},function(r$S){this._button.stateNum=r$S}),r$e}(r$h),r$f=function(r$Q){function r$e(r$S){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,r$e.__super.call(this),this._showButtons=r$k.showButtons,this._touchScrollEnable=r$k.touchScrollEnable,this._mouseWheelEnable=r$k.mouseWheelEnable,this.skin=r$S,this.max=1}r$d(r$e,"laya.ui.ScrollBar",r$Q);var r$S=r$e.prototype;return r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),this.stopScroll(),this.target=null,r$Q.prototype.destroy.call(this,r$S),this.upButton&&this.upButton.destroy(r$S),this.downButton&&this.downButton.destroy(r$S),this.slider&&this.slider.destroy(r$S),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},r$S.createChildren=function(){this.addChild(this.slider=new r$w),this.addChild(this.upButton=new r$$),this.addChild(this.downButton=new r$$)},r$S.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},r$S.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},r$S.onButtonMouseDown=function(r$S){var r$Q=r$S.currentTarget===this.upButton;this.slide(r$Q),r$j.timer.once(r$E.scrollBarDelayTime,this,this.startLoop,[r$Q]),r$j.stage.once("mouseup",this,this.onStageMouseUp)},r$S.startLoop=function(r$S){r$j.timer.frameLoop(1,this,this.slide,[r$S])},r$S.slide=function(r$S){r$S?this.value-=this._scrollSize:this.value+=this._scrollSize},r$S.onStageMouseUp=function(r$S){r$j.timer.clear(this,this.startLoop),r$j.timer.clear(this,this.slide)},r$S.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},r$S.changeSize=function(){r$Q.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},r$S.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},r$S.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},r$S.setScroll=function(r$S,r$Q,r$e){this.runCallLater(this.changeSize),this.slider.setSlider(r$S,r$Q,r$e),this.slider.bar.visible=0<r$Q,!this._hide&&this.autoHide&&(this.visible=!1)},r$S.onTargetMouseWheel=function(r$S){this.value-=r$S.delta*this._scrollSize,this.target=this._target},r$S.onTargetMouseDown=function(r$S){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new r$L),this._lastPoint.setTo(r$j.stage.mouseX,r$j.stage.mouseY),r$j.timer.clear(this,this.tweenMove),r$O.clearTween(this),r$j.stage.once("mouseup",this,this.onStageMouseUp2),r$j.stage.once("mouseout",this,this.onStageMouseUp2),r$j.timer.frameLoop(1,this,this.loop)},r$S.loop=function(){var r$S=r$j.stage.mouseY,r$Q=r$j.stage.mouseX;if(this._lastOffset=this.isVertical?r$S-this._lastPoint.y:r$Q-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?r$j.stage._canvasTransform.getScaleY():r$j.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=r$Q,this._lastPoint.y=r$S,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},r$S.onStageMouseUp2=function(r$S){if(r$j.stage.off("mouseup",this,this.onStageMouseUp2),r$j.stage.off("mouseout",this,this.onStageMouseUp2),r$j.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?r$O.to(this,{value:this.min},this.elasticBackTime,r$U.sineOut,r$p.create(this,this.elasticOver)):this._value>this.max&&r$O.to(this,{value:this.max},this.elasticBackTime,r$U.sineOut,r$p.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?r$j.stage.mouseY-this._lastPoint.y:r$j.stage.mouseX-this._lastPoint.x);for(var r$Q=0,r$e=Math.min(this._offsets.length,3),r$l=0;r$l<r$e;r$l++)r$Q+=this._offsets[this._offsets.length-1-r$l];if(this._lastOffset=r$Q/r$e,(r$Q=Math.abs(this._lastOffset))<2)return void this.event("end");60<r$Q&&(this._lastOffset=0<this._lastOffset?60:-60);var r$M=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));r$j.timer.frameLoop(1,this,this.tweenMove,[r$M])}},r$S.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&r$O.to(this,{alpha:0},500),this.event("end")},r$S.tweenMove=function(r$S){this._lastOffset*=this.rollRatio;var r$Q=NaN;if(0<r$S&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,r$Q=.5*-(this.min-r$S-this.value),this._lastOffset>r$Q&&(this._lastOffset=r$Q)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,r$Q=.5*-(this.max+r$S-this.value),this._lastOffset<r$Q&&(this._lastOffset=r$Q))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(r$j.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?r$O.to(this,{value:this.min},this.elasticBackTime,r$U.sineOut,r$p.create(this,this.elasticOver)):this._value>this.max?r$O.to(this,{value:this.max},this.elasticBackTime,r$U.sineOut,r$p.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&r$O.to(this,{alpha:0},500)}},r$S.stopScroll=function(){this.onStageMouseUp2(null),r$j.timer.clear(this,this.tweenMove),r$O.clearTween(this)},r$M(0,r$S,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),r$M(0,r$S,"skin",function(){return this._skin},function(r$S){this._skin!=r$S&&(this._skin=r$S,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),r$M(0,r$S,"max",function(){return this.slider.max},function(r$S){this.slider.max=r$S}),r$M(0,r$S,"showButtons",function(){return this._showButtons},function(r$S){this._showButtons=r$S,this.callLater(this.changeScrollBar)}),r$M(0,r$S,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),r$M(0,r$S,"min",function(){return this.slider.min},function(r$S){this.slider.min=r$S}),r$M(0,r$S,"value",function(){return this._value},function(r$S){r$S!==this._value&&(this._value=r$S,this._isElastic||(this.slider._value!=r$S&&(this.slider._value=r$S,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),r$M(0,r$S,"isVertical",function(){return this.slider.isVertical},function(r$S){this.slider.isVertical=r$S}),r$M(0,r$S,"sizeGrid",function(){return this.slider.sizeGrid},function(r$S){this.slider.sizeGrid=r$S}),r$M(0,r$S,"scrollSize",function(){return this._scrollSize},function(r$S){this._scrollSize=r$S}),r$M(0,r$S,"dataSource",r$Q.prototype._$get_dataSource,function(r$S){"number"==typeof(this._dataSource=r$S)||"string"==typeof r$S?this.value=Number(r$S):r$j.superSet(r$h,this,"dataSource",r$S)}),r$M(0,r$S,"thumbPercent",function(){return this._thumbPercent},function(r$S){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),r$S=1<=r$S?.99:r$S,this._thumbPercent=r$S,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*r$S,r$E.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*r$S,r$E.scrollBarMinNum))}),r$M(0,r$S,"target",function(){return this._target},function(r$S){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=r$S)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),r$M(0,r$S,"hide",function(){return this._hide},function(r$S){this._hide=r$S,this.visible=!r$S}),r$M(0,r$S,"touchScrollEnable",function(){return this._touchScrollEnable},function(r$S){this._touchScrollEnable=r$S,this.target=this._target}),r$M(0,r$S,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(r$S){this._mouseWheelEnable=r$S,this.target=this._target}),r$M(0,r$S,"tick",function(){return this.slider.tick},function(r$S){this.slider.tick=r$S}),r$e}(r$h),r$w=function(r$Q){function r$e(r$S){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,r$e.__super.call(this),this.skin=r$S}r$d(r$e,"laya.ui.Slider",r$Q);var r$S=r$e.prototype;return r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,r$S),this._bg&&this._bg.destroy(r$S),this._bar&&this._bar.destroy(r$S),this._progress&&this._progress.destroy(r$S),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},r$S.createChildren=function(){this.addChild(this._bg=new r$u),this.addChild(this._bar=new r$$)},r$S.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},r$S.onBarMouseDown=function(r$S){this._globalSacle||(this._globalSacle=new r$L),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=r$j.stage.mouseX,this._ty=r$j.stage.mouseY,r$j.stage.on("mousemove",this,this.mouseMove),r$j.stage.once("mouseup",this,this.mouseUp),r$j.stage.once("mouseout",this,this.mouseUp),this.showValueText()},r$S.showValueText=function(){if(this.showLabel){var r$S=laya.ui.Slider.label;this.addChild(r$S),r$S.textField.changeText(this._value+""),this.isVertical?(r$S.x=this._bar.x+20,r$S.y=.5*(this._bar.height-r$S.height)+this._bar.y):(r$S.y=this._bar.y-20,r$S.x=.5*(this._bar.width-r$S.width)+this._bar.x)}},r$S.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},r$S.mouseUp=function(r$S){r$j.stage.off("mousemove",this,this.mouseMove),r$j.stage.off("mouseup",this,this.mouseUp),r$j.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},r$S.mouseMove=function(r$S){var r$Q=this._value;this.isVertical?(this._bar.y+=(r$j.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(r$j.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=r$j.stage.mouseX,this._ty=r$j.stage.mouseY;var r$e=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*r$e)/r$e,this._value!=r$Q&&this.sendChangeEvent(),this.showValueText()},r$S.sendChangeEvent=function(r$S){void 0===r$S&&(r$S="change"),this.event(r$S),this.changeHandler&&this.changeHandler.runWith(this._value)},r$S.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},r$S.changeSize=function(){r$Q.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},r$S.setSlider=function(r$S,r$Q,r$e){this._value=-1,this._min=r$S,this._max=r$S<r$Q?r$Q:r$S,this.value=r$e<r$S?r$S:r$Q<r$e?r$Q:r$e},r$S.changeValue=function(){var r$S=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*r$S)/r$S,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var r$Q=this._max-this._min;0===r$Q&&(r$Q=1),this.isVertical?(this._bar.y=(this._value-this._min)/r$Q*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/r$Q*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},r$S.onBgMouseDown=function(r$S){var r$Q=this._bg.getMousePoint();this.isVertical?this.value=r$Q.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=r$Q.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},r$M(0,r$S,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),r$M(0,r$S,"skin",function(){return this._skin},function(r$S){if(this._skin!=r$S){this._skin=r$S,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var r$Q=this._skin.replace(".png","$progress.png");r$z.getRes(r$Q)&&(this._progress||(this.addChild(this._progress=new r$u),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=r$Q),this.setBarPoint(),this.callLater(this.changeValue)}}),r$M(0,r$S,"allowClickBack",function(){return this._allowClickBack},function(r$S){this._allowClickBack!=r$S&&((this._allowClickBack=r$S)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),r$M(0,r$S,"max",function(){return this._max},function(r$S){this._max!=r$S&&(this._max=r$S,this.callLater(this.changeValue))}),r$M(0,r$S,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),r$M(0,r$S,"tick",function(){return this._tick},function(r$S){this._tick!=r$S&&(this._tick=r$S,this.callLater(this.changeValue))}),r$M(0,r$S,"sizeGrid",function(){return this._bg.sizeGrid},function(r$S){this._bg.sizeGrid=r$S,this._bar.sizeGrid=r$S,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),r$M(0,r$S,"min",function(){return this._min},function(r$S){this._min!=r$S&&(this._min=r$S,this.callLater(this.changeValue))}),r$M(0,r$S,"value",function(){return this._value},function(r$S){if(this._value!=r$S){var r$Q=this._value;this._value=r$S,this.changeValue(),this._value!=r$Q&&this.sendChangeEvent()}}),r$M(0,r$S,"dataSource",r$Q.prototype._$get_dataSource,function(r$S){"number"==typeof(this._dataSource=r$S)||"string"==typeof r$S?this.value=Number(r$S):r$j.superSet(r$h,this,"dataSource",r$S)}),r$M(0,r$S,"bar",function(){return this._bar}),r$l(r$e,["label",function(){return this.label=new r$r}]),r$e}(r$h),r$u=function(r$Q){function r$e(r$S){this._bitmap=null,this._skin=null,this._group=null,r$e.__super.call(this),this.skin=r$S}r$d(r$e,"laya.ui.Image",r$Q);var r$S=r$e.prototype;return r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,r$z.clearCache(this,this._skin)},r$S.dispose=function(){this.destroy(!0),r$z.clearCache(this,this._skin)},r$S.createChildren=function(){this.graphics=this._bitmap=new r$X},r$S.setSource=function(r$S,r$Q){r$S===this._skin&&r$Q&&(this.source=r$Q,this.onCompResize())},r$M(0,r$S,"source",function(){return this._bitmap.source},function(r$S){this._bitmap&&(this._bitmap.source=r$S,this.event("loaded"),this.repaint())}),r$M(0,r$S,"dataSource",r$Q.prototype._$get_dataSource,function(r$S){"string"==typeof(this._dataSource=r$S)?this.skin=r$S:r$j.superSet(r$h,this,"dataSource",r$S)}),r$M(0,r$S,"measureHeight",function(){return this._bitmap.height}),r$M(0,r$S,"skin",function(){return this._skin},function(r$S){if(this._skin!=r$S)if(r$z.clearCache(this,this._skin),this._skin=r$S){r$z.keepCache(this,this._skin);var r$Q=r$z.getRes(r$S);r$Q?(this.source=r$Q,this.onCompResize()):r$j.loader.load(this._skin,r$p.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),r$M(0,r$S,"group",function(){return this._group},function(r$S){r$S&&this._skin&&r$z.setGroup(this._skin,r$S),this._group=r$S}),r$M(0,r$S,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(r$S){this._bitmap.sizeGrid=r$t.fillArray(r$E.defaultSizeGrid,r$S,Number)}),r$M(0,r$S,"measureWidth",function(){return this._bitmap.width}),r$M(0,r$S,"width",r$Q.prototype._$get_width,function(r$S){r$j.superSet(r$h,this,"width",r$S),this._bitmap.width=0==r$S?1e-7:r$S}),r$M(0,r$S,"height",r$Q.prototype._$get_height,function(r$S){r$j.superSet(r$h,this,"height",r$S),this._bitmap.height=0==r$S?1e-7:r$S}),r$e}(r$h),r$r=function(r$Q){function r$e(r$S){this._tf=null,r$e.__super.call(this),void 0===r$S&&(r$S=""),r$R.defaultColor=r$E.labelColor,this.text=r$S}r$d(r$e,"laya.ui.Label",r$Q);var r$S=r$e.prototype;return r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,r$S),this._tf=null},r$S.createChildren=function(){this.addChild(this._tf=new r$D)},r$S.changeText=function(r$S){this._tf.changeText(r$S)},r$M(0,r$S,"padding",function(){return this._tf.padding.join(",")},function(r$S){this._tf.padding=r$t.fillArray(r$E.labelPadding,r$S,Number)}),r$M(0,r$S,"bold",function(){return this._tf.bold},function(r$S){this._tf.bold=r$S}),r$M(0,r$S,"align",function(){return this._tf.align},function(r$S){this._tf.align=r$S}),r$M(0,r$S,"text",function(){return this._tf.text},function(r$S){this._tf.text!=r$S&&(r$S&&(r$S=r$t.adptString(r$S+"")),this._tf.text=r$S,this.event("change"),this._width&&this._height||this.onCompResize())}),r$M(0,r$S,"italic",function(){return this._tf.italic},function(r$S){this._tf.italic=r$S}),r$M(0,r$S,"wordWrap",function(){return this._tf.wordWrap},function(r$S){this._tf.wordWrap=r$S}),r$M(0,r$S,"font",function(){return this._tf.font},function(r$S){this._tf.font=r$S}),r$M(0,r$S,"dataSource",r$Q.prototype._$get_dataSource,function(r$S){"number"==typeof(this._dataSource=r$S)||"string"==typeof r$S?this.text=r$S+"":r$j.superSet(r$h,this,"dataSource",r$S)}),r$M(0,r$S,"color",function(){return this._tf.color},function(r$S){this._tf.color=r$S}),r$M(0,r$S,"valign",function(){return this._tf.valign},function(r$S){this._tf.valign=r$S}),r$M(0,r$S,"leading",function(){return this._tf.leading},function(r$S){this._tf.leading=r$S}),r$M(0,r$S,"fontSize",function(){return this._tf.fontSize},function(r$S){this._tf.fontSize=r$S}),r$M(0,r$S,"bgColor",function(){return this._tf.bgColor},function(r$S){this._tf.bgColor=r$S}),r$M(0,r$S,"borderColor",function(){return this._tf.borderColor},function(r$S){this._tf.borderColor=r$S}),r$M(0,r$S,"stroke",function(){return this._tf.stroke},function(r$S){this._tf.stroke=r$S}),r$M(0,r$S,"strokeColor",function(){return this._tf.strokeColor},function(r$S){this._tf.strokeColor=r$S}),r$M(0,r$S,"textField",function(){return this._tf}),r$M(0,r$S,"measureWidth",function(){return this._tf.width}),r$M(0,r$S,"measureHeight",function(){return this._tf.height}),r$M(0,r$S,"width",function(){return this._width||this._tf.text?r$j.superGet(r$h,this,"width"):0},function(r$S){r$j.superSet(r$h,this,"width",r$S),this._tf.width=r$S}),r$M(0,r$S,"height",function(){return this._height||this._tf.text?r$j.superGet(r$h,this,"height"):0},function(r$S){r$j.superSet(r$h,this,"height",r$S),this._tf.height=r$S}),r$M(0,r$S,"overflow",function(){return this._tf.overflow},function(r$S){this._tf.overflow=r$S}),r$M(0,r$S,"underline",function(){return this._tf.underline},function(r$S){this._tf.underline=r$S}),r$M(0,r$S,"underlineColor",function(){return this._tf.underlineColor},function(r$S){this._tf.underlineColor=r$S}),r$e}(r$h),r$W=function(r$Q){function r$e(r$S){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,r$e.__super.call(this),this.skin=r$S}r$d(r$e,"laya.ui.ProgressBar",r$Q);var r$S=r$e.prototype;return r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,r$S),this._bg&&this._bg.destroy(r$S),this._bar&&this._bar.destroy(r$S),this._bg=this._bar=null,this.changeHandler=null},r$S.createChildren=function(){this.addChild(this._bg=new r$u),this.addChild(this._bar=new r$u)},r$S.changeValue=function(){if(this.sizeGrid){var r$S=this.sizeGrid.split(","),r$Q=Number(r$S[3]),r$e=Number(r$S[1]),r$l=(this.width-r$Q-r$e)*this._value;this._bar.width=r$Q+r$e+r$l,this._bar.visible=this._bar.width>r$Q+r$e}else this._bar.width=this.width*this._value},r$M(0,r$S,"measureHeight",function(){return this._bg.height}),r$M(0,r$S,"skin",function(){return this._skin},function(r$S){this._skin!=r$S&&(this._skin=r$S,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),r$M(0,r$S,"measureWidth",function(){return this._bg.width}),r$M(0,r$S,"height",r$Q.prototype._$get_height,function(r$S){r$j.superSet(r$h,this,"height",r$S),this._bg.height=this._height,this._bar.height=this._height}),r$M(0,r$S,"bar",function(){return this._bar}),r$M(0,r$S,"value",function(){return this._value},function(r$S){this._value!=r$S&&(r$S=1<r$S?1:r$S<0?0:r$S,this._value=r$S,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(r$S))}),r$M(0,r$S,"bg",function(){return this._bg}),r$M(0,r$S,"sizeGrid",function(){return this._bg.sizeGrid},function(r$S){this._bg.sizeGrid=this._bar.sizeGrid=r$S}),r$M(0,r$S,"width",r$Q.prototype._$get_width,function(r$S){r$j.superSet(r$h,this,"width",r$S),this._bg.width=this._width,this.callLater(this.changeValue)}),r$M(0,r$S,"dataSource",r$Q.prototype._$get_dataSource,function(r$S){"number"==typeof(this._dataSource=r$S)||"string"==typeof r$S?this.value=Number(r$S):r$j.superSet(r$h,this,"dataSource",r$S)}),r$e}(r$h),r$x=(function(r$S){function r$e(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,r$e.__super.call(this),this._tipBox=new r$h,this._tipBox.addChild(this._tipText=new r$D),this._tipText.x=this._tipText.y=5,this._tipText.color=r$e.tipTextColor,this._defaultTipHandler=this._showDefaultTip,r$j.stage.on("showtip",this,this._onStageShowTip),r$j.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}r$d(r$e,"laya.ui.TipManager",r$h);var r$Q=r$e.prototype;r$Q._onStageHideTip=function(r$S){r$j.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},r$Q._onStageShowTip=function(r$S){r$j.timer.once(r$e.tipDelay,this,this._showTip,[r$S],!0)},r$Q._showTip=function(r$S){if("string"==typeof r$S){var r$Q=String(r$S);Boolean(r$Q)&&this._defaultTipHandler(r$Q)}else r$S instanceof laya.utils.Handler?r$S.run():"function"==typeof r$S&&r$S.apply();r$j.stage.on("mousemove",this,this._onStageMouseMove),r$j.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},r$Q._onStageMouseDown=function(r$S){this.closeAll()},r$Q._onStageMouseMove=function(r$S){this._showToStage(this,r$e.offsetX,r$e.offsetY)},r$Q._showToStage=function(r$S,r$Q,r$e){void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0);var r$l=r$S.getBounds();r$S.x=r$j.stage.mouseX+r$Q,r$S.y=r$j.stage.mouseY+r$e,r$S.x+r$l.width>r$j.stage.width&&(r$S.x-=r$l.width+r$Q),r$S.y+r$l.height>r$j.stage.height&&(r$S.y-=r$l.height+r$e)},r$Q.closeAll=function(){r$j.timer.clear(this,this._showTip),r$j.stage.off("mousemove",this,this._onStageMouseMove),r$j.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},r$Q.showDislayTip=function(r$S){this.addChild(r$S),this._showToStage(this),r$j._currentStage.addChild(this)},r$Q._showDefaultTip=function(r$S){this._tipText.text=r$S;var r$Q=this._tipBox.graphics;r$Q.clear(),r$Q.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,r$e.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),r$j._currentStage.addChild(this)},r$M(0,r$Q,"defaultTipHandler",function(){return this._defaultTipHandler},function(r$S){this._defaultTipHandler=r$S}),r$e.offsetX=10,r$e.offsetY=15,r$e.tipTextColor="#ffffff",r$e.tipBackColor="#111111",r$e.tipDelay=200}(),function(r$S){var r$J;function r$L(){this._idMap=null,this._aniList=null,this._watchMap={},r$L.__super.call(this)}r$d(r$L,"laya.ui.View",r$m);var r$Q=r$L.prototype;return r$Q.createView=function(r$S){if(r$S.animations&&!this._idMap&&(this._idMap={}),r$L.createComp(r$S,this,this),r$S.animations){var r$Q,r$e,r$l=[],r$M=r$S.animations,r$d=0,r$T=r$M.length;for(r$d=0;r$d<r$T;r$d++){switch(r$Q=new r$o,r$e=r$M[r$d],r$Q._setUp(this._idMap,r$e),(this[r$e.name]=r$Q)._setControlNode(this),r$e.action){case 1:r$Q.play(0,!1);break;case 2:r$Q.play(0,!0)}r$l.push(r$Q)}this._aniList=r$l}0<this._width&&null==r$S.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},r$Q.onEvent=function(r$S,r$Q){},r$Q.loadUI=function(r$S){var r$Q=r$L.uiMap[r$S];r$Q&&this.createView(r$Q)},r$Q.destroy=function(r$S){void 0===r$S&&(r$S=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,r$S)},r$Q.changeData=function(r$S){var r$Q=this._watchMap[r$S];if(r$Q){console.log("change",r$S);for(var r$e=0,r$l=r$Q.length;r$e<r$l;r$e++){r$Q[r$e].exe(this)}}},r$L._regs=function(){for(var r$S in r$L.uiClassMap)r$c.regClass(r$S,r$L.uiClassMap[r$S])},r$L.createComp=function(r$S,r$Q,r$e,r$l){if(!(r$Q=r$Q||r$L.getCompInstance(r$S)))return console.warn("can not create:"+r$S.type),null;var r$M=r$S.child;if(r$M)for(var r$d=r$Q instanceof laya.ui.List,r$T=0,r$U=r$M.length;r$T<r$U;r$T++){var r$i=r$M[r$T];if(!r$Q.hasOwnProperty("itemRender")||"render"!=r$i.props.name&&"render"!==r$i.props.renderType)if("Graphic"==r$i.type)r$c.addGraphicsToSprite(r$i,r$Q);else if(r$c.isDrawType(r$i.type))r$c.addGraphicToSprite(r$i,r$Q,!0);else{if(r$d){var r$R=[],r$o=r$L.createComp(r$i,null,r$e,r$R);r$R.length&&(r$o._$bindData=r$R)}else r$o=r$L.createComp(r$i,null,r$e,r$l);"Script"==r$i.type?"owner"in r$o?r$o.owner=r$Q:"target"in r$o&&(r$o.target=r$Q):"mask"==r$i.props.renderType||"mask"==r$i.props.name?r$Q.mask=r$o:r$o instanceof laya.display.Sprite&&r$Q.addChild(r$o)}else r$Q.itemRender=r$i}var r$Y=r$S.props;for(var r$p in r$Y){var r$J=r$Y[r$p];r$L.eventDic[r$p]?r$J&&r$e&&r$Q.on(r$p,r$e,r$e.onEvent,[r$J]):r$L.setCompValue(r$Q,r$p,r$J,r$e,r$l)}return r$j.__typeof(r$Q,"laya.ui.IItem")&&r$Q.initItems(),r$S.compId&&r$e&&r$e._idMap&&(r$e._idMap[r$S.compId]=r$Q),r$Q},r$L.setCompValue=function(r$S,r$Q,r$e,r$l,r$M){if("string"==typeof r$e&&-1<r$e.indexOf("${")){if(r$L._sheet||(r$L._sheet=r$c.getClass("laya.data.Table")),!r$L._sheet)return void console.warn("Can not find class Sheet");if(r$M)r$M.push(r$S,r$Q,r$e);else if(r$l){-1==r$e.indexOf("].")&&(r$e=r$e.replace(".","[0]."));var r$d,r$T,r$U=new r$J(r$S,r$Q,r$e);r$U.exe(r$l);for(var r$i=r$e.replace(/\[.*?\]\./g,".");null!=(r$d=r$L._parseWatchData.exec(r$i));){for(var r$R=r$d[1];null!=(r$T=r$L._parseKeyWord.exec(r$R));){var r$o=r$T[0],r$Y=r$l._watchMap[r$o]||(r$l._watchMap[r$o]=[]);r$Y.push(r$U),r$L._sheet.I.notifer.on(r$o,r$l,r$l.changeData,[r$o])}(r$Y=r$l._watchMap[r$R]||(r$l._watchMap[r$R]=[])).push(r$U),r$L._sheet.I.notifer.on(r$R,r$l,r$l.changeData,[r$R])}}}else if("var"===r$Q&&r$l)r$l[r$e]=r$S;else if("onClick"==r$Q){var r$p=r$j._runScript("(function(){"+r$e+"})");r$S.on("click",r$l,r$p)}else r$S[r$Q]="true"===r$e||"false"!==r$e&&r$e},r$L.getCompInstance=function(r$S){var r$Q,r$e=r$S.props?r$S.props.runtime:null;return r$Q=r$e?r$L.viewClassMap[r$e]||r$L.uiClassMap[r$e]||r$j.__classmap[r$e]:r$L.uiClassMap[r$S.type],r$S.props&&r$S.props.hasOwnProperty("renderType")&&"instance"==r$S.props.renderType?r$Q.instance:r$Q?new r$Q:null},r$L.regComponent=function(r$S,r$Q){r$L.uiClassMap[r$S]=r$Q,r$c.regClass(r$S,r$Q)},r$L.regViewRuntime=function(r$S,r$Q){r$L.viewClassMap[r$S]=r$Q},r$L.uiMap={},r$L.viewClassMap={},r$L._sheet=null,r$l(r$L,["uiClassMap",function(){return this.uiClassMap={ViewStack:r$SS,LinkButton:r$$,TextArea:r$RS,ColorPicker:r$P,Box:r$m,Button:r$$,CheckBox:r$F,Clip:r$n,ComboBox:r$a,Component:r$h,HScrollBar:r$C,HSlider:r$V,Image:r$u,Label:r$r,List:r$N,Panel:r$K,ProgressBar:r$W,Radio:r$s,RadioGroup:r$US,ScrollBar:r$f,Slider:r$w,Tab:r$iS,TextInput:r$eS,View:r$L,VScrollBar:r$QS,VSlider:r$lS,Tree:r$y,HBox:r$dS,VBox:r$TS,Sprite:r$v,Animation:r$e,Text:r$D,FontClip:r$Z}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),r$L.__init$=function(){r$L._regs(),r$J=function(){function r$S(r$S,r$Q,r$e){this.comp=null,this.prop=null,this.value=null,this.comp=r$S,this.prop=r$Q,this.value=r$e}return r$d(r$S,""),r$S.prototype.exe=function(r$S){var r$Q=r$t.getBindFun(this.value);this.comp[this.prop]=r$Q.call(this,r$S)},r$S}()},r$L}()),r$F=function(r$S){function r$e(r$S,r$Q){void 0===r$Q&&(r$Q=""),r$e.__super.call(this,r$S,r$Q)}r$d(r$e,"laya.ui.CheckBox",r$S);var r$Q=r$e.prototype;return r$Q.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},r$Q.initialize=function(){r$S.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},r$M(0,r$Q,"dataSource",r$S.prototype._$get_dataSource,function(r$S){"boolean"==typeof(this._dataSource=r$S)?this.selected=r$S:"string"==typeof r$S?this.selected="true"===r$S:r$j.superSet(r$$,this,"dataSource",r$S)}),r$e}(r$$),r$q=function(r$S){function r$Q(){this._space=0,this._align="none",this._itemChanged=!1,r$Q.__super.call(this)}r$d(r$Q,"laya.ui.LayoutBox",r$m);var r$e=r$Q.prototype;return r$e.addChild=function(r$S){return r$S.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,r$S)},r$e.onResize=function(r$S){this._setItemChanged()},r$e.addChildAt=function(r$S,r$Q){return r$S.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,r$S,r$Q)},r$e.removeChild=function(r$S){return r$S.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,r$S)},r$e.removeChildAt=function(r$S){return this.getChildAt(r$S).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,r$S)},r$e.refresh=function(){this._setItemChanged()},r$e.changeItems=function(){this._itemChanged=!1},r$e.sortItem=function(r$S){r$S&&r$S.sort(function(r$S,r$Q){return r$S.y-r$Q.y})},r$e._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},r$M(0,r$e,"space",function(){return this._space},function(r$S){this._space=r$S,this._setItemChanged()}),r$M(0,r$e,"align",function(){return this._align},function(r$S){this._align=r$S,this._setItemChanged()}),r$Q}(),r$Z=function(r$Q){function r$e(r$S,r$Q){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,r$e.__super.call(this),r$S&&(this.skin=r$S),r$Q&&(this.sheet=r$Q)}r$d(r$e,"laya.ui.FontClip",r$Q);var r$S=r$e.prototype;return r$S.createChildren=function(){this._bitmap=new r$X,this.on("loaded",this,this._onClipLoaded)},r$S._onClipLoaded=function(){this.callLater(this.changeValue)},r$S.changeValue=function(){var r$S;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),r$S=this._sources[0]))){var r$Q="horizontal"===this._direction;r$Q?(this._wordsW=this._valueArr.length*(r$S.sourceWidth+this.spaceX),this._wordsH=r$S.sourceHeight):(this._wordsW=r$S.sourceWidth,this._wordsH=(r$S.sourceHeight+this.spaceY)*this._valueArr.length);var r$e=0;if(this._width)switch(this._align){case"center":r$e=.5*(this._width-this._wordsW);break;case"right":r$e=this._width-this._wordsW;break;default:r$e=0}for(var r$l=0,r$M=this._valueArr.length;r$l<r$M;r$l++){var r$d=this._indexMap[this._valueArr.charAt(r$l)];this.sources[r$d]&&(r$S=this.sources[r$d],r$Q?this.graphics.drawTexture(r$S,r$e+r$l*(r$S.sourceWidth+this.spaceX),0,r$S.sourceWidth,r$S.sourceHeight):this.graphics.drawTexture(r$S,0+r$e,r$l*(r$S.sourceHeight+this.spaceY),r$S.sourceWidth,r$S.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),r$Q.prototype.destroy.call(this,r$S)},r$M(0,r$S,"sheet",function(){return this._sheet},function(r$S){r$S+="";var r$Q=(this._sheet=r$S).split(" ");this._clipX=String(r$Q[0]).length,this.clipY=r$Q.length,this._indexMap={};for(var r$e=0;r$e<this._clipY;r$e++)for(var r$l=r$Q[r$e].split(""),r$M=0,r$d=r$l.length;r$M<r$d;r$M++)this._indexMap[r$l[r$M]]=r$e*this._clipX+r$M}),r$M(0,r$S,"height",r$Q.prototype._$get_height,function(r$S){r$j.superSet(r$n,this,"height",r$S),this.callLater(this.changeValue)}),r$M(0,r$S,"direction",function(){return this._direction},function(r$S){this._direction=r$S,this.callLater(this.changeValue)}),r$M(0,r$S,"value",function(){return this._valueArr?this._valueArr:""},function(r$S){r$S+="",this._valueArr=r$S,this.callLater(this.changeValue)}),r$M(0,r$S,"width",r$Q.prototype._$get_width,function(r$S){r$j.superSet(r$n,this,"width",r$S),this.callLater(this.changeValue)}),r$M(0,r$S,"spaceX",function(){return this._spaceX},function(r$S){this._spaceX=r$S,"horizontal"===this._direction&&this.callLater(this.changeValue)}),r$M(0,r$S,"spaceY",function(){return this._spaceY},function(r$S){this._spaceY=r$S,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),r$M(0,r$S,"align",function(){return this._align},function(r$S){this._align=r$S,this.callLater(this.changeValue)}),r$M(0,r$S,"measureWidth",function(){return this._wordsW}),r$M(0,r$S,"measureHeight",function(){return this._wordsH}),r$e}(r$n),r$N=function(r$S){function r$Q(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new r$L,r$Q.__super.call(this)}r$d(r$Q,"laya.ui.List",r$S);var r$e=r$Q.prototype;return r$j.imps(r$e,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),r$e.destroy=function(r$S){void 0===r$S&&(r$S=!0),this._content&&this._content.destroy(r$S),this._scrollBar&&this._scrollBar.destroy(r$S),laya.ui.Component.prototype.destroy.call(this,r$S),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},r$e.createChildren=function(){this.addChild(this._content=new r$m)},r$e.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=r$j.superGet(r$m,this,"cacheAs")),r$j.superSet(r$m,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},r$e.onScrollEnd=function(){r$j.superSet(r$m,this,"cacheAs",this._$P.cacheAs)},r$e._removePreScrollBar=function(){var r$S=this.removeChildByName("scrollBar");r$S&&r$S.destroy(!0)},r$e.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var r$S=this._getOneCell(),r$Q=r$S.width+this._spaceX||1,r$e=r$S.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/r$Q):Math.ceil(this._width/r$Q)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/r$e):Math.round(this._height/r$e));var r$l=this._width?this._width:r$Q*this.repeatX-this._spaceX,r$M=this._height?this._height:r$e*this.repeatY-this._spaceY;this._cellSize=this._isVertical?r$e:r$Q,this._cellOffset=this._isVertical?r$e*Math.max(this._repeatY2,this._repeatY)-r$M-this._spaceY:r$Q*Math.max(this._repeatX2,this._repeatX)-r$l-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=r$M:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=r$l),this.setContentSize(r$l,r$M);var r$d=this._isVertical?this.repeatX:this.repeatY,r$T=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,r$d,r$T),this._createdLine=r$T,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},r$e._getOneCell=function(){if(0===this._cells.length){var r$S=this.createItem();if(this._offset.setTo(r$S.x,r$S.y),this.cacheContent)return r$S;this._cells.push(r$S)}return this._cells[0]},r$e._createItems=function(r$S,r$Q,r$e){var r$l=this._content,r$M=this._getOneCell(),r$d=r$M.width+this._spaceX,r$T=r$M.height+this._spaceY;if(this.cacheContent){var r$U=new r$m;r$U.cacheAsBitmap=!0,r$U.pos((this._isVertical?0:r$S)*r$d,(this._isVertical?r$S:0)*r$T),this._content.addChild(r$U),this._content.optimizeScrollRect=!0,r$l=r$U}else{for(var r$i=[],r$R=this._cells.length-1;-1<r$R;r$R--){var r$o=this._cells[r$R];r$o.removeSelf(),r$i.push(r$o)}this._cells.length=0}for(var r$Y=r$S;r$Y<r$e;r$Y++)for(var r$p=0;r$p<r$Q;r$p++)(r$M=r$i&&r$i.length?r$i.pop():this.createItem()).x=(this._isVertical?r$p:r$Y)*r$d-r$l.x,r$M.y=(this._isVertical?r$Y:r$p)*r$T-r$l.y,r$M.name="item"+(r$Y*r$Q+r$p),r$l.addChild(r$M),this.addCell(r$M)},r$e.createItem=function(){var r$S=[];if("function"==typeof this._itemRender)var r$Q=new this._itemRender;else r$Q=r$x.createComp(this._itemRender,null,null,r$S);if(0==r$S.length&&r$Q._watchMap){var r$e=r$Q._watchMap;for(var r$l in r$e)for(var r$M=r$e[r$l],r$d=0;r$d<r$M.length;r$d++){var r$T=r$M[r$d];r$S.push(r$T.comp,r$T.prop,r$T.value)}}return r$S.length&&(r$Q._$bindData=r$S),r$Q},r$e.addCell=function(r$S){r$S.on("click",this,this.onCellMouse),r$S.on("rightclick",this,this.onCellMouse),r$S.on("mouseover",this,this.onCellMouse),r$S.on("mouseout",this,this.onCellMouse),r$S.on("mousedown",this,this.onCellMouse),r$S.on("mouseup",this,this.onCellMouse),this._cells.push(r$S)},r$e.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var r$S=0,r$Q=r$S=0;r$Q<1e4;r$Q++){var r$e=this.getChildByName("item"+r$Q);if(!r$e)break;this.addCell(r$e),r$S++}this.repeatY=r$S}},r$e.setContentSize=function(r$S,r$Q){this._content.width=r$S,this._content.height=r$Q,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new r$G),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,r$S,r$Q),this._content.scrollRect=this._content.scrollRect),this.event("resize")},r$e.onCellMouse=function(r$S){"mousedown"===r$S.type&&(this._isMoved=!1);var r$Q=r$S.currentTarget,r$e=this._startIndex+this._cells.indexOf(r$Q);r$e<0||("click"===r$S.type||"rightclick"===r$S.type?this.selectEnable&&!this._isMoved?this.selectedIndex=r$e:this.changeCellState(r$Q,!0,0):"mouseover"!==r$S.type&&"mouseout"!==r$S.type||this._selectedIndex===r$e||this.changeCellState(r$Q,"mouseover"===r$S.type,0),this.mouseHandler&&this.mouseHandler.runWith([r$S,r$e]))},r$e.changeCellState=function(r$S,r$Q,r$e){var r$l=r$S.getChildByName("selectBox");r$l&&(this.selectEnable=!0,r$l.visible=r$Q,r$l.index=r$e)},r$e.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},r$e.onScrollBarChange=function(r$S){this.runCallLater(this.changeCells);var r$Q=this._scrollBar.value,r$e=this._isVertical?this.repeatX:this.repeatY,r$l=this._isVertical?this.repeatY:this.repeatX,r$M=Math.floor(r$Q/this._cellSize);if(this.cacheContent)r$T=r$l+1,this._createdLine-r$M<r$T&&(this._createItems(this._createdLine,r$e,this._createdLine+r$T),this.renderItems(this._createdLine*r$e,0),this._createdLine+=r$T);else{var r$d=r$M*r$e,r$T=0;if(r$d>this._startIndex){r$T=r$d-this._startIndex;var r$U=!0,r$i=this._startIndex+r$e*(r$l+1);this._isMoved=!0}else r$d<this._startIndex&&(r$T=this._startIndex-r$d,r$U=!1,r$i=this._startIndex-1,this._isMoved=!0);for(var r$R=0;r$R<r$T;r$R++){if(r$U){var r$o=this._cells.shift();this._cells[this._cells.length]=r$o;var r$Y=r$i+r$R}else r$o=this._cells.pop(),this._cells.unshift(r$o),r$Y=r$i-r$R;var r$p=Math.floor(r$Y/r$e)*this._cellSize;this._isVertical?r$o.y=r$p:r$o.x=r$p,this.renderItem(r$o,r$Y)}this._startIndex=r$d,this.changeSelectStatus()}var r$J=this._content.scrollRect;this._isVertical?(r$J.y=r$Q-this._offset.y,r$J.x=-this._offset.x):(r$J.y=-this._offset.y,r$J.x=r$Q-this._offset.x),this._content.scrollRect=r$J},r$e.posCell=function(r$S,r$Q){if(this._scrollBar){var r$e=this._isVertical?this.repeatX:this.repeatY,r$l=(this._isVertical?this.repeatY:this.repeatX,Math.floor(r$Q/r$e)*this._cellSize);this._isVertical?r$S.y=r$l:r$S.x=r$l}},r$e.changeSelectStatus=function(){for(var r$S=0,r$Q=this._cells.length;r$S<r$Q;r$S++)this.changeCellState(this._cells[r$S],this._selectedIndex===this._startIndex+r$S,1)},r$e.renderItems=function(r$S,r$Q){void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0);for(var r$e=r$S,r$l=r$Q||this._cells.length;r$e<r$l;r$e++)this.renderItem(this._cells[r$e],this._startIndex+r$e);this.changeSelectStatus()},r$e.renderItem=function(r$S,r$Q){this._array&&0<=r$Q&&r$Q<this._array.length?(r$S.visible=!0,r$S._$bindData?(r$S._dataSource=this._array[r$Q],this._bindData(r$S,this._array[r$Q])):r$S.dataSource=this._array[r$Q],this.cacheContent||this.posCell(r$S,r$Q),this.hasListener("render")&&this.event("render",[r$S,r$Q]),this.renderHandler&&this.renderHandler.runWith([r$S,r$Q])):(r$S.visible=!1,r$S.dataSource=null)},r$e._bindData=function(r$S,r$Q){for(var r$e=r$S._$bindData,r$l=0,r$M=r$e.length;r$l<r$M;r$l++){var r$d=r$e[r$l++],r$T=r$e[r$l++],r$U=r$e[r$l],r$i=r$t.getBindFun(r$U);r$d[r$T]=r$i.call(this,r$Q)}},r$e.refresh=function(){this.array=this._array},r$e.getItem=function(r$S){return-1<r$S&&r$S<this._array.length?this._array[r$S]:null},r$e.changeItem=function(r$S,r$Q){-1<r$S&&r$S<this._array.length&&(this._array[r$S]=r$Q,r$S>=this._startIndex&&r$S<this._startIndex+this._cells.length&&this.renderItem(this.getCell(r$S),r$S))},r$e.setItem=function(r$S,r$Q){this.changeItem(r$S,r$Q)},r$e.addItem=function(r$S){this._array.push(r$S),this.array=this._array},r$e.addItemAt=function(r$S,r$Q){this._array.splice(r$Q,0,r$S),this.array=this._array},r$e.deleteItem=function(r$S){this._array.splice(r$S,1),this.array=this._array},r$e.getCell=function(r$S){return this.runCallLater(this.changeCells),-1<r$S&&this._cells?this._cells[(r$S-this._startIndex)%this._cells.length]:null},r$e.scrollTo=function(r$S){if(this._scrollBar){var r$Q=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(r$S/r$Q)*this._cellSize}else this.startIndex=r$S},r$e.tweenTo=function(r$S,r$Q,r$e){if(void 0===r$Q&&(r$Q=200),this._scrollBar){var r$l=this._isVertical?this.repeatX:this.repeatY;r$O.to(this._scrollBar,{value:Math.floor(r$S/r$l)*this._cellSize},r$Q,null,r$e,0,!0)}else this.startIndex=r$S,r$e&&r$e.run()},r$e._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},r$e.commitMeasure=function(){this.runCallLater(this.changeCells)},r$M(0,r$e,"cacheAs",r$S.prototype._$get_cacheAs,function(r$S){r$j.superSet(r$m,this,"cacheAs",r$S),this._scrollBar&&(this._$P.cacheAs=null,"none"!==r$S?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),r$M(0,r$e,"content",function(){return this._content}),r$M(0,r$e,"height",r$S.prototype._$get_height,function(r$S){r$S!=this._height&&(r$j.superSet(r$m,this,"height",r$S),this._setCellChanged())}),r$M(0,r$e,"itemRender",function(){return this._itemRender},function(r$S){if(this._itemRender!=r$S){this._itemRender=r$S;for(var r$Q=this._cells.length-1;-1<r$Q;r$Q--)this._cells[r$Q].destroy();this._cells.length=0,this._setCellChanged()}}),r$M(0,r$e,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(r$S){this._removePreScrollBar();var r$Q=new r$QS;r$Q.name="scrollBar",r$Q.right=0,r$S&&" "!=r$S&&(r$Q.skin=r$S),this.scrollBar=r$Q,this.addChild(r$Q),this._setCellChanged()}),r$M(0,r$e,"page",function(){return this._page},function(r$S){this._page=r$S,this._array&&(this._page=0<r$S?r$S:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),r$M(0,r$e,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(r$S){this._removePreScrollBar();var r$Q=new r$C;r$Q.name="scrollBar",r$Q.bottom=0,r$S&&" "!=r$S&&(r$Q.skin=r$S),this.scrollBar=r$Q,this.addChild(r$Q),this._setCellChanged()}),r$M(0,r$e,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(r$S){this._repeatX=r$S,this._setCellChanged()}),r$M(0,r$e,"scrollBar",function(){return this._scrollBar},function(r$S){this._scrollBar!=r$S&&(this._scrollBar=r$S)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),r$M(0,r$e,"width",r$S.prototype._$get_width,function(r$S){r$S!=this._width&&(r$j.superSet(r$m,this,"width",r$S),this._setCellChanged())}),r$M(0,r$e,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(r$S){this._repeatY=r$S,this._setCellChanged()}),r$M(0,r$e,"spaceX",function(){return this._spaceX},function(r$S){this._spaceX=r$S,this._setCellChanged()}),r$M(0,r$e,"spaceY",function(){return this._spaceY},function(r$S){this._spaceY=r$S,this._setCellChanged()}),r$M(0,r$e,"selectedIndex",function(){return this._selectedIndex},function(r$S){this._selectedIndex!=r$S&&(this._selectedIndex=r$S,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(r$S),this.startIndex=this._startIndex)}),r$M(0,r$e,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(r$S){this.selectedIndex=this._array.indexOf(r$S)}),r$M(0,r$e,"length",function(){return this._array?this._array.length:0}),r$M(0,r$e,"selection",function(){return this.getCell(this._selectedIndex)},function(r$S){this.selectedIndex=this._startIndex+this._cells.indexOf(r$S)}),r$M(0,r$e,"startIndex",function(){return this._startIndex},function(r$S){this._startIndex=0<r$S?r$S:0,this.callLater(this.renderItems)}),r$M(0,r$e,"array",function(){return this._array},function(r$S){this.runCallLater(this.changeCells),this._array=r$S||[];var r$Q=this._array.length;if(this.totalPage=Math.ceil(r$Q/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<r$Q?this._selectedIndex:r$Q-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var r$e=this._isVertical?this.repeatX:this.repeatY,r$l=this._isVertical?this.repeatY:this.repeatX,r$M=Math.ceil(r$Q/r$e);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=r$l/r$M,this._scrollBar.setScroll(0,(r$M-r$l)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),r$M(0,r$e,"dataSource",r$S.prototype._$get_dataSource,function(r$S){"number"==typeof(this._dataSource=r$S)&&Math.floor(r$S)==r$S||"string"==typeof r$S?this.selectedIndex=parseInt(r$S):r$S instanceof Array?this.array=r$S:r$j.superSet(r$m,this,"dataSource",r$S)}),r$M(0,r$e,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),r$Q}(r$m),r$C=function(r$S){function r$Q(){r$Q.__super.call(this)}return r$d(r$Q,"laya.ui.HScrollBar",r$S),r$Q.prototype.initialize=function(){r$S.prototype.initialize.call(this),this.slider.isVertical=!1},r$Q}(r$f),r$K=function(r$S){function r$Q(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,r$Q.__super.call(this),this.width=this.height=100}r$d(r$Q,"laya.ui.Panel",r$S);var r$e=r$Q.prototype;return r$e.destroy=function(r$S){void 0===r$S&&(r$S=!0),laya.ui.Component.prototype.destroy.call(this,r$S),this._content&&this._content.destroy(r$S),this._vScrollBar&&this._vScrollBar.destroy(r$S),this._hScrollBar&&this._hScrollBar.destroy(r$S),this._vScrollBar=null,this._hScrollBar=null,this._content=null},r$e.destroyChildren=function(){this._content.destroyChildren()},r$e.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new r$m)},r$e.addChild=function(r$S){return r$S.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(r$S)},r$e.onResize=function(){this._setScrollChanged()},r$e.addChildAt=function(r$S,r$Q){return r$S.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(r$S,r$Q)},r$e.removeChild=function(r$S){return r$S.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(r$S)},r$e.removeChildAt=function(r$S){return this.getChildAt(r$S).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(r$S)},r$e.removeChildren=function(r$S,r$Q){return void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=2147483647),this._content.removeChildren(r$S,r$Q),this._setScrollChanged(),this},r$e.getChildAt=function(r$S){return this._content.getChildAt(r$S)},r$e.getChildByName=function(r$S){return this._content.getChildByName(r$S)},r$e.getChildIndex=function(r$S){return this._content.getChildIndex(r$S)},r$e.changeScroll=function(){this._scrollChanged=!1;var r$S=this.contentWidth||1,r$Q=this.contentHeight||1,r$e=this._vScrollBar,r$l=this._hScrollBar,r$M=r$e&&r$Q>this._height,r$d=r$l&&r$S>this._width,r$T=r$M?this._width-r$e.width:this._width,r$U=r$d?this._height-r$l.height:this._height;r$e&&(r$e.x=this._width-r$e.width,r$e.y=0,r$e.height=this._height-(r$d?r$l.height:0),r$e.scrollSize=Math.max(.033*this._height,1),r$e.thumbPercent=r$U/r$Q,r$e.setScroll(0,r$Q-r$U,r$e.value)),r$l&&(r$l.x=0,r$l.y=this._height-r$l.height,r$l.width=this._width-(r$M?r$e.width:0),r$l.scrollSize=Math.max(.033*this._width,1),r$l.thumbPercent=r$T/r$S,r$l.setScroll(0,r$S-r$T,r$l.value))},r$e.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},r$e.setContentSize=function(r$S,r$Q){var r$e=this._content;r$e.width=r$S,r$e.height=r$Q,r$e.scrollRect||(r$e.scrollRect=new r$G),r$e.scrollRect.setTo(0,0,r$S,r$Q),r$e.scrollRect=r$e.scrollRect},r$e.onScrollBarChange=function(r$S){var r$Q=this._content.scrollRect;if(r$Q){var r$e=Math.round(r$S.value);r$S.isVertical?r$Q.y=r$e:r$Q.x=r$e,this._content.scrollRect=r$Q}},r$e.scrollTo=function(r$S,r$Q){void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),this.vScrollBar&&(this.vScrollBar.value=r$Q),this.hScrollBar&&(this.hScrollBar.value=r$S)},r$e.refresh=function(){this.changeScroll()},r$e.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=r$j.superGet(r$m,this,"cacheAs")),r$j.superSet(r$m,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},r$e.onScrollEnd=function(){r$j.superSet(r$m,this,"cacheAs",this._$P.cacheAs)},r$e._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},r$M(0,r$e,"numChildren",function(){return this._content.numChildren}),r$M(0,r$e,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(r$S){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new r$C),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=r$S}),r$M(0,r$e,"contentWidth",function(){for(var r$S=0,r$Q=this._content.numChildren-1;-1<r$Q;r$Q--){var r$e=this._content.getChildAt(r$Q);r$S=Math.max(r$e.x+r$e.width*r$e.scaleX,r$S)}return r$S}),r$M(0,r$e,"contentHeight",function(){for(var r$S=0,r$Q=this._content.numChildren-1;-1<r$Q;r$Q--){var r$e=this._content.getChildAt(r$Q);r$S=Math.max(r$e.y+r$e.height*r$e.scaleY,r$S)}return r$S}),r$M(0,r$e,"width",r$S.prototype._$get_width,function(r$S){r$j.superSet(r$m,this,"width",r$S),this._setScrollChanged()}),r$M(0,r$e,"hScrollBar",function(){return this._hScrollBar}),r$M(0,r$e,"content",function(){return this._content}),r$M(0,r$e,"height",r$S.prototype._$get_height,function(r$S){r$j.superSet(r$m,this,"height",r$S),this._setScrollChanged()}),r$M(0,r$e,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(r$S){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new r$QS),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=r$S}),r$M(0,r$e,"vScrollBar",function(){return this._vScrollBar}),r$M(0,r$e,"cacheAs",r$S.prototype._$get_cacheAs,function(r$S){r$j.superSet(r$m,this,"cacheAs",r$S),this._$P.cacheAs=null,"none"!==r$S?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),r$Q}(r$m),r$V=function(r$S){function r$Q(r$S){r$Q.__super.call(this,r$S),this.isVertical=!1}return r$d(r$Q,"laya.ui.HSlider",r$w),r$Q}(),r$_=function(r$S){function r$e(r$S,r$Q){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,r$e.__super.call(this),this.skin=r$Q,this.labels=r$S}r$d(r$e,"laya.ui.UIGroup",r$S);var r$Q=r$e.prototype;return r$j.imps(r$Q,{"laya.ui.IItem":!0}),r$Q.preinitialize=function(){this.mouseEnabled=!0},r$Q.destroy=function(r$S){void 0===r$S&&(r$S=!0),laya.ui.Component.prototype.destroy.call(this,r$S),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},r$Q.addItem=function(r$S,r$Q){void 0===r$Q&&(r$Q=!0);var r$e=r$S,r$l=this._items.length;if(r$e.name="item"+r$l,this.addChild(r$e),this.initItems(),r$Q&&0<r$l){var r$M=this._items[r$l-1];"horizontal"==this._direction?r$e.x=r$M.x+r$M.width+this._space:r$e.y=r$M.y+r$M.height+this._space}else r$Q&&(r$e.x=0,r$e.y=0);return r$l},r$Q.delItem=function(r$S,r$Q){void 0===r$Q&&(r$Q=!0);var r$e=this._items.indexOf(r$S);if(-1!=r$e){var r$l=r$S;this.removeChild(r$l);for(var r$M=r$e+1,r$d=this._items.length;r$M<r$d;r$M++){var r$T=this._items[r$M];r$T.name="item"+(r$M-1),r$Q&&("horizontal"==this._direction?r$T.x-=r$l.width+this._space:r$T.y-=r$l.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var r$U;r$U=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=r$U}}},r$Q.initItems=function(){this._items||(this._items=[]);for(var r$S=this._items.length=0;r$S<1e4;r$S++){var r$Q=this.getChildByName("item"+r$S);if(null==r$Q)break;this._items.push(r$Q),r$Q.selected=r$S===this._selectedIndex,r$Q.clickHandler=r$p.create(this,this.itemClick,[r$S],!1)}},r$Q.itemClick=function(r$S){this.selectedIndex=r$S},r$Q.setSelect=function(r$S,r$Q){this._items&&-1<r$S&&r$S<this._items.length&&(this._items[r$S].selected=r$Q)},r$Q.createItem=function(r$S,r$Q){return null},r$Q.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var r$S=0,r$Q=0,r$e=this._items.length;r$Q<r$e;r$Q++){var r$l=this._items[r$Q];this._skin&&(r$l.skin=this._skin),this._labelColors&&(r$l.labelColors=this._labelColors),this._labelSize&&(r$l.labelSize=this._labelSize),this._labelStroke&&(r$l.labelStroke=this._labelStroke),this._labelStrokeColor&&(r$l.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(r$l.strokeColors=this._strokeColors),this._labelBold&&(r$l.labelBold=this._labelBold),this._labelPadding&&(r$l.labelPadding=this._labelPadding),this._labelAlign&&(r$l.labelAlign=this._labelAlign),this._stateNum&&(r$l.stateNum=this._stateNum),this._labelFont&&(r$l.labelFont=this._labelFont),"horizontal"===this._direction?(r$l.y=0,r$l.x=r$S,r$S+=r$l.width+this._space):(r$l.x=0,r$l.y=r$S,r$S+=r$l.height+this._space)}this.changeSize()},r$Q.commitMeasure=function(){this.runCallLater(this.changeLabels)},r$Q._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},r$M(0,r$Q,"labelStrokeColor",function(){return this._labelStrokeColor},function(r$S){this._labelStrokeColor!=r$S&&(this._labelStrokeColor=r$S,this._setLabelChanged())}),r$M(0,r$Q,"skin",function(){return this._skin},function(r$S){this._skin!=r$S&&(this._skin=r$S,this._setLabelChanged())}),r$M(0,r$Q,"selectedIndex",function(){return this._selectedIndex},function(r$S){this._selectedIndex!=r$S&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=r$S,this.setSelect(r$S,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),r$M(0,r$Q,"labels",function(){return this._labels},function(r$S){if(this._labels!=r$S){if(this._labels=r$S,this.removeChildren(),this._setLabelChanged(),this._labels)for(var r$Q=this._labels.split(","),r$e=0,r$l=r$Q.length;r$e<r$l;r$e++){var r$M=this.createItem(this._skin,r$Q[r$e]);r$M.name="item"+r$e,this.addChild(r$M)}this.initItems()}}),r$M(0,r$Q,"strokeColors",function(){return this._strokeColors},function(r$S){this._strokeColors!=r$S&&(this._strokeColors=r$S,this._setLabelChanged())}),r$M(0,r$Q,"labelColors",function(){return this._labelColors},function(r$S){this._labelColors!=r$S&&(this._labelColors=r$S,this._setLabelChanged())}),r$M(0,r$Q,"labelStroke",function(){return this._labelStroke},function(r$S){this._labelStroke!=r$S&&(this._labelStroke=r$S,this._setLabelChanged())}),r$M(0,r$Q,"labelSize",function(){return this._labelSize},function(r$S){this._labelSize!=r$S&&(this._labelSize=r$S,this._setLabelChanged())}),r$M(0,r$Q,"stateNum",function(){return this._stateNum},function(r$S){this._stateNum!=r$S&&(this._stateNum=r$S,this._setLabelChanged())}),r$M(0,r$Q,"labelBold",function(){return this._labelBold},function(r$S){this._labelBold!=r$S&&(this._labelBold=r$S,this._setLabelChanged())}),r$M(0,r$Q,"labelFont",function(){return this._labelFont},function(r$S){this._labelFont!=r$S&&(this._labelFont=r$S,this._setLabelChanged())}),r$M(0,r$Q,"labelPadding",function(){return this._labelPadding},function(r$S){this._labelPadding!=r$S&&(this._labelPadding=r$S,this._setLabelChanged())}),r$M(0,r$Q,"direction",function(){return this._direction},function(r$S){this._direction=r$S,this._setLabelChanged()}),r$M(0,r$Q,"space",function(){return this._space},function(r$S){this._space=r$S,this._setLabelChanged()}),r$M(0,r$Q,"items",function(){return this._items}),r$M(0,r$Q,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(r$S){this.selectedIndex=this._items.indexOf(r$S)}),r$M(0,r$Q,"dataSource",r$S.prototype._$get_dataSource,function(r$S){"number"==typeof(this._dataSource=r$S)&&Math.floor(r$S)==r$S||"string"==typeof r$S?this.selectedIndex=parseInt(r$S):r$S instanceof Array?this.labels=r$S.join(","):r$j.superSet(r$m,this,"dataSource",r$S)}),r$e}(r$m),r$s=function(r$Q){function r$e(r$S,r$Q){this._value=null,void 0===r$Q&&(r$Q=""),r$e.__super.call(this,r$S,r$Q)}r$d(r$e,"laya.ui.Radio",r$Q);var r$S=r$e.prototype;return r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,r$S),this._value=null},r$S.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},r$S.initialize=function(){r$Q.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},r$S.onClick=function(r$S){this.selected=!0},r$M(0,r$S,"value",function(){return null!=this._value?this._value:this.label},function(r$S){this._value=r$S}),r$e}(r$$),r$y=function(r$S){function r$Q(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,r$Q.__super.call(this),this.width=this.height=200}r$d(r$Q,"laya.ui.Tree",r$S);var r$e=r$Q.prototype;return r$j.imps(r$e,{"laya.ui.IRender":!0}),r$e.destroy=function(r$S){void 0===r$S&&(r$S=!0),laya.ui.Component.prototype.destroy.call(this,r$S),this._list&&this._list.destroy(r$S),this._list=null,this._source=null,this._renderHandler=null},r$e.createChildren=function(){this.addChild(this._list=new r$N),this._list.renderHandler=r$p.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},r$e.onListChange=function(r$S){this.event("change")},r$e.getArray=function(){var r$S,r$Q=[];for(var r$e in this._source)r$S=this._source[r$e],this.getParentOpenStatus(r$S)&&(r$S.x=this._spaceLeft*this.getDepth(r$S),r$Q.push(r$S));return r$Q},r$e.getDepth=function(r$S,r$Q){return void 0===r$Q&&(r$Q=0),null==r$S.nodeParent?r$Q:this.getDepth(r$S.nodeParent,r$Q+1)},r$e.getParentOpenStatus=function(r$S){var r$Q=r$S.nodeParent;return null==r$Q||!!r$Q.isOpen&&(null==r$Q.nodeParent||this.getParentOpenStatus(r$Q))},r$e.renderItem=function(r$S,r$Q){var r$e=r$S.dataSource;if(r$e){r$S.left=r$e.x;var r$l=r$S.getChildByName("arrow");r$l&&(r$e.hasChild?(r$l.visible=!0,r$l.index=r$e.isOpen?1:0,r$l.tag=r$Q,r$l.off("click",this,this.onArrowClick),r$l.on("click",this,this.onArrowClick)):r$l.visible=!1);var r$M=r$S.getChildByName("folder");r$M&&(2==r$M.clipY?r$M.index=r$e.isDirectory?0:1:r$M.index=r$e.isDirectory?r$e.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([r$S,r$Q])}},r$e.onArrowClick=function(r$S){var r$Q=r$S.currentTarget.tag;this._list.array[r$Q].isOpen=!this._list.array[r$Q].isOpen,this.event("open"),this._list.array=this.getArray()},r$e.setItemState=function(r$S,r$Q){this._list.array[r$S]&&(this._list.array[r$S].isOpen=r$Q,this._list.array=this.getArray())},r$e.fresh=function(){this._list.array=this.getArray(),this.repaint()},r$e.parseXml=function(r$S,r$Q,r$e,r$l){var r$M,r$d=r$S.childNodes,r$T=r$d.length;if(!r$l){r$M={};var r$U,r$i=r$S.attributes;for(var r$R in r$i){var r$o=(r$U=r$i[r$R]).nodeName,r$Y=r$U.nodeValue;r$M[r$o]="true"==r$Y||"false"!=r$Y&&r$Y}r$M.nodeParent=r$e,0<r$T&&(r$M.isDirectory=!0),r$M.hasChild=0<r$T,r$Q.push(r$M)}for(var r$p=0;r$p<r$T;r$p++){var r$J=r$d[r$p];this.parseXml(r$J,r$Q,r$M,!1)}},r$e.parseOpenStatus=function(r$S,r$Q){for(var r$e=0,r$l=r$Q.length;r$e<r$l;r$e++){var r$M=r$Q[r$e];if(r$M.isDirectory)for(var r$d=0,r$T=r$S.length;r$d<r$T;r$d++){var r$U=r$S[r$d];if(r$U.isDirectory&&this.isSameParent(r$U,r$M)&&r$M.label==r$U.label){r$M.isOpen=r$U.isOpen;break}}}},r$e.isSameParent=function(r$S,r$Q){return null==r$S.nodeParent&&null==r$Q.nodeParent||null!=r$S.nodeParent&&null!=r$Q.nodeParent&&(r$S.nodeParent.label==r$Q.nodeParent.label&&this.isSameParent(r$S.nodeParent,r$Q.nodeParent))},r$e.filter=function(r$S){if(Boolean(r$S)){var r$Q=[];this.getFilterSource(this._source,r$Q,r$S),this._list.array=r$Q}else this._list.array=this.getArray()},r$e.getFilterSource=function(r$S,r$Q,r$e){var r$l;for(var r$M in r$e=r$e.toLocaleLowerCase(),r$S)!(r$l=r$S[r$M]).isDirectory&&-1<String(r$l.label).toLowerCase().indexOf(r$e)&&(r$l.x=0,r$Q.push(r$l)),r$l.child&&0<r$l.child.length&&this.getFilterSource(r$l.child,r$Q,r$e)},r$M(0,r$e,"spaceBottom",function(){return this._list.spaceY},function(r$S){this._list.spaceY=r$S}),r$M(0,r$e,"keepStatus",function(){return this._keepStatus},function(r$S){this._keepStatus=r$S}),r$M(0,r$e,"itemRender",function(){return this._list.itemRender},function(r$S){this._list.itemRender=r$S}),r$M(0,r$e,"array",function(){return this._list.array},function(r$S){this._keepStatus&&this._list.array&&r$S&&this.parseOpenStatus(this._list.array,r$S),this._source=r$S,this._list.array=this.getArray()}),r$M(0,r$e,"mouseHandler",function(){return this._list.mouseHandler},function(r$S){this._list.mouseHandler=r$S}),r$M(0,r$e,"dataSource",r$S.prototype._$get_dataSource,function(r$S){this._dataSource=r$S,r$j.superSet(r$m,this,"dataSource",r$S)}),r$M(0,r$e,"source",function(){return this._source}),r$M(0,r$e,"scrollBar",function(){return this._list.scrollBar}),r$M(0,r$e,"list",function(){return this._list}),r$M(0,r$e,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(r$S){this._list.vScrollBarSkin=r$S}),r$M(0,r$e,"renderHandler",function(){return this._renderHandler},function(r$S){this._renderHandler=r$S}),r$M(0,r$e,"selectedIndex",function(){return this._list.selectedIndex},function(r$S){this._list.selectedIndex=r$S}),r$M(0,r$e,"spaceLeft",function(){return this._spaceLeft},function(r$S){this._spaceLeft=r$S}),r$M(0,r$e,"selectedItem",function(){return this._list.selectedItem},function(r$S){this._list.selectedItem=r$S}),r$M(0,r$e,"width",r$S.prototype._$get_width,function(r$S){r$j.superSet(r$m,this,"width",r$S),this._list.width=r$S}),r$M(0,r$e,"height",r$S.prototype._$get_height,function(r$S){r$j.superSet(r$m,this,"height",r$S),this._list.height=r$S}),r$M(0,r$e,"xml",null,function(r$S){var r$Q=[];this.parseXml(r$S.childNodes[0],r$Q,null,!0),this.array=r$Q}),r$M(0,r$e,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),r$Q}(r$m),r$SS=function(r$S){function r$Q(){this._items=null,this._selectedIndex=0,r$Q.__super.call(this),this._setIndexHandler=r$p.create(this,this.setIndex,null,!1)}r$d(r$Q,"laya.ui.ViewStack",r$S);var r$e=r$Q.prototype;return r$j.imps(r$e,{"laya.ui.IItem":!0}),r$e.setItems=function(r$S){this.removeChildren();for(var r$Q=0,r$e=0,r$l=r$S.length;r$e<r$l;r$e++){var r$M=r$S[r$e];r$M&&(r$M.name="item"+r$Q,this.addChild(r$M),r$Q++)}this.initItems()},r$e.addItem=function(r$S){r$S.name="item"+this._items.length,this.addChild(r$S),this.initItems()},r$e.initItems=function(){this._items=[];for(var r$S=0;r$S<1e4;r$S++){var r$Q=this.getChildByName("item"+r$S);if(null==r$Q)break;this._items.push(r$Q),r$Q.visible=r$S==this._selectedIndex}},r$e.setSelect=function(r$S,r$Q){this._items&&-1<r$S&&r$S<this._items.length&&(this._items[r$S].visible=r$Q)},r$e.setIndex=function(r$S){this.selectedIndex=r$S},r$M(0,r$e,"dataSource",r$S.prototype._$get_dataSource,function(r$S){if("number"==typeof(this._dataSource=r$S)&&Math.floor(r$S)==r$S||"string"==typeof r$S)this.selectedIndex=parseInt(r$S);else for(var r$Q in this._dataSource)this.hasOwnProperty(r$Q)&&(this[r$Q]=this._dataSource[r$Q])}),r$M(0,r$e,"selectedIndex",function(){return this._selectedIndex},function(r$S){this._selectedIndex!=r$S&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=r$S,this.setSelect(this._selectedIndex,!0))}),r$M(0,r$e,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(r$S){this.selectedIndex=this._items.indexOf(r$S)}),r$M(0,r$e,"items",function(){return this._items}),r$M(0,r$e,"setIndexHandler",function(){return this._setIndexHandler},function(r$S){this._setIndexHandler=r$S}),r$Q}(r$m),r$QS=function(r$S){function r$Q(){r$Q.__super.call(this)}return r$d(r$Q,"laya.ui.VScrollBar",r$f),r$Q}(),r$eS=function(r$Q){function r$e(r$S){this._bg=null,this._skin=null,r$e.__super.call(this),void 0===r$S&&(r$S=""),this.text=r$S,this.skin=this.skin}r$d(r$e,"laya.ui.TextInput",r$Q);var r$S=r$e.prototype;return r$S.preinitialize=function(){this.mouseEnabled=!0},r$S.destroy=function(r$S){r$z.clearCache(this,this._skin),void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,r$S),this._bg&&this._bg.destroy(),this._bg=null},r$S.createChildren=function(){this.addChild(this._tf=new r$J),this._tf.padding=r$E.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},r$S._onFocus=function(){this.event("focus",this)},r$S._onBlur=function(){this.event("blur",this)},r$S._onInput=function(){this.event("input",this)},r$S._onEnter=function(){this.event("enter",this)},r$S.initialize=function(){this.width=128,this.height=22},r$S.select=function(){this._tf.select()},r$S.setSelection=function(r$S,r$Q){this._tf.setSelection(r$S,r$Q)},r$M(0,r$S,"text",r$Q.prototype._$get_text,function(r$S){this._tf.text!=r$S&&(r$S+="",this._tf.text=r$S,this.event("change"))}),r$M(0,r$S,"bg",function(){return this._bg},function(r$S){this.graphics=this._bg=r$S}),r$M(0,r$S,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(r$S){this._tf.inputElementYAdjuster=r$S}),r$M(0,r$S,"multiline",function(){return this._tf.multiline},function(r$S){this._tf.multiline=r$S}),r$M(0,r$S,"skin",function(){return this._skin},function(r$S){this._skin!=r$S&&(r$z.clearCache(this,this._skin),this._skin=r$S,this._bg||(this.graphics=this._bg=new r$X),r$z.keepCache(this,this._skin),this._bg.source=r$z.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),r$M(0,r$S,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(r$S){this._bg||(this.graphics=this._bg=new r$X),this._bg.sizeGrid=r$t.fillArray(r$E.defaultSizeGrid,r$S,Number)}),r$M(0,r$S,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(r$S){this._tf.inputElementXAdjuster=r$S}),r$M(0,r$S,"width",r$Q.prototype._$get_width,function(r$S){r$j.superSet(r$r,this,"width",r$S),this._bg&&(this._bg.width=r$S)}),r$M(0,r$S,"height",r$Q.prototype._$get_height,function(r$S){r$j.superSet(r$r,this,"height",r$S),this._bg&&(this._bg.height=r$S)}),r$M(0,r$S,"editable",function(){return this._tf.editable},function(r$S){this._tf.editable=r$S}),r$M(0,r$S,"restrict",function(){return this._tf.restrict},function(r$S){this._tf.restrict=r$S}),r$M(0,r$S,"prompt",function(){return this._tf.prompt},function(r$S){this._tf.prompt=r$S}),r$M(0,r$S,"promptColor",function(){return this._tf.promptColor},function(r$S){this._tf.promptColor=r$S}),r$M(0,r$S,"maxChars",function(){return this._tf.maxChars},function(r$S){this._tf.maxChars=r$S}),r$M(0,r$S,"focus",function(){return this._tf.focus},function(r$S){this._tf.focus=r$S}),r$M(0,r$S,"type",function(){return this._tf.type},function(r$S){this._tf.type=r$S}),r$M(0,r$S,"asPassword",function(){return this._tf.asPassword},function(r$S){this._tf.asPassword=r$S}),r$e}(r$r),r$lS=function(r$S){function r$Q(){r$Q.__super.call(this)}return r$d(r$Q,"laya.ui.VSlider",r$w),r$Q}(),r$MS=function(r$S){function r$l(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,r$l.__super.call(this)}r$d(r$l,"laya.ui.Dialog",r$S);var r$Q=r$l.prototype;return r$Q.initialize=function(){this.popupEffect=r$l.manager.popupEffectHandler,this.closeEffect=r$l.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},r$Q._dealDragArea=function(){var r$S=this.getChildByName("drag");r$S&&(this.dragArea=r$S.x+","+r$S.y+","+r$S.width+","+r$S.height,r$S.removeSelf())},r$Q._onClick=function(r$S){var r$Q=r$S.target;if(r$Q)switch(r$Q.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(r$Q.name)}},r$Q.show=function(r$S,r$Q){void 0===r$S&&(r$S=!1),void 0===r$Q&&(r$Q=!0),this._open(!1,r$S,r$Q)},r$Q.popup=function(r$S,r$Q){void 0===r$S&&(r$S=!1),void 0===r$Q&&(r$Q=!0),this._open(!0,r$S,r$Q)},r$Q._open=function(r$S,r$Q,r$e){r$l.manager.lock(!1),this.isModal=r$S,r$l.manager.open(this,r$Q,r$e)},r$Q.onOpened=function(){},r$Q.close=function(r$S,r$Q){void 0===r$Q&&(r$Q=!0),r$l.manager.close(this,r$S,r$Q)},r$Q.onClosed=function(r$S){},r$Q._onMouseDown=function(r$S){var r$Q=this.getMousePoint();this._dragArea.contains(r$Q.x,r$Q.y)?this.startDrag():this.stopDrag()},r$M(0,r$Q,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(r$S){if(r$S){var r$Q=r$t.fillArray([0,0,0,0],r$S,Number);this._dragArea=new r$G(r$Q[0],r$Q[1],r$Q[2],r$Q[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),r$M(0,r$Q,"isPopup",function(){return null!=this.parent}),r$M(0,r$Q,"zOrder",r$S.prototype._$get_zOrder,function(r$S){r$j.superSet(r$x,this,"zOrder",r$S),r$l.manager._checkMask()}),r$M(1,r$l,"manager",function(){return r$l._manager=r$l._manager||new r$b},function(r$S){r$l._manager=r$S}),r$l.setLockView=function(r$S){r$l.manager.setLockView(r$S)},r$l.lock=function(r$S){r$l.manager.lock(r$S)},r$l.closeAll=function(){r$l.manager.closeAll()},r$l.getDialogsByGroup=function(r$S){return r$l.manager.getDialogsByGroup(r$S)},r$l.closeByGroup=function(r$S){return r$l.manager.closeByGroup(r$S)},r$l.CLOSE="close",r$l.CANCEL="cancel",r$l.SURE="sure",r$l.NO="no",r$l.OK="ok",r$l.YES="yes",r$l._manager=null,r$l}(r$x),r$dS=function(r$S){function r$Q(){r$Q.__super.call(this)}r$d(r$Q,"laya.ui.HBox",r$S);var r$e=r$Q.prototype;return r$e.sortItem=function(r$S){r$S&&r$S.sort(function(r$S,r$Q){return r$S.x-r$Q.x})},r$e.changeItems=function(){this._itemChanged=!1;for(var r$S=[],r$Q=0,r$e=0,r$l=this.numChildren;r$e<r$l;r$e++){var r$M=this.getChildAt(r$e);r$M&&r$M.layoutEnabled&&(r$S.push(r$M),r$Q=this._height?this._height:Math.max(r$Q,r$M.height*r$M.scaleY))}this.sortItem(r$S);var r$d=0;for(r$e=0,r$l=r$S.length;r$e<r$l;r$e++)(r$M=r$S[r$e]).x=r$d,r$d+=r$M.width*r$M.scaleX+this._space,"top"==this._align?r$M.y=0:"middle"==this._align?r$M.y=.5*(r$Q-r$M.height*r$M.scaleY):"bottom"==this._align&&(r$M.y=r$Q-r$M.height*r$M.scaleY);this.changeSize()},r$M(0,r$e,"height",r$S.prototype._$get_height,function(r$S){this._height!=r$S&&(r$j.superSet(r$q,this,"height",r$S),this.callLater(this.changeItems))}),r$Q.NONE="none",r$Q.TOP="top",r$Q.MIDDLE="middle",r$Q.BOTTOM="bottom",r$Q}(r$q),r$TS=function(r$S){function r$Q(){r$Q.__super.call(this)}r$d(r$Q,"laya.ui.VBox",r$S);var r$e=r$Q.prototype;return r$e.changeItems=function(){this._itemChanged=!1;for(var r$S=[],r$Q=0,r$e=0,r$l=this.numChildren;r$e<r$l;r$e++){var r$M=this.getChildAt(r$e);r$M&&r$M.layoutEnabled&&(r$S.push(r$M),r$Q=this._width?this._width:Math.max(r$Q,r$M.width*r$M.scaleX))}this.sortItem(r$S);var r$d=0;for(r$e=0,r$l=r$S.length;r$e<r$l;r$e++)(r$M=r$S[r$e]).y=r$d,r$d+=r$M.height*r$M.scaleY+this._space,"left"==this._align?r$M.x=0:"center"==this._align?r$M.x=.5*(r$Q-r$M.width*r$M.scaleX):"right"==this._align&&(r$M.x=r$Q-r$M.width*r$M.scaleX);this.changeSize()},r$M(0,r$e,"width",r$S.prototype._$get_width,function(r$S){this._width!=r$S&&(r$j.superSet(r$q,this,"width",r$S),this.callLater(this.changeItems))}),r$Q.NONE="none",r$Q.LEFT="left",r$Q.CENTER="center",r$Q.RIGHT="right",r$Q}(r$q),r$US=function(r$S){function r$Q(){r$Q.__super.call(this)}return r$d(r$Q,"laya.ui.RadioGroup",r$_),r$Q.prototype.createItem=function(r$S,r$Q){return new r$s(r$S,r$Q)},r$Q}(),r$iS=function(r$S){function r$Q(){r$Q.__super.call(this)}return r$d(r$Q,"laya.ui.Tab",r$_),r$Q.prototype.createItem=function(r$S,r$Q){return new r$$(r$S,r$Q)},r$Q}(),r$RS=function(r$Q){function r$e(r$S){this._vScrollBar=null,this._hScrollBar=null,void 0===r$S&&(r$S=""),r$e.__super.call(this,r$S)}r$d(r$e,"laya.ui.TextArea",r$Q);var r$S=r$e.prototype;return r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,r$S),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},r$S.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},r$S.onVBarChanged=function(r$S){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},r$S.onHBarChanged=function(r$S){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},r$S.changeScroll=function(){var r$S=this._vScrollBar&&0<this._tf.maxScrollY,r$Q=this._hScrollBar&&0<this._tf.maxScrollX,r$e=r$S?this._width-this._vScrollBar.width:this._width,r$l=r$Q?this._height-this._hScrollBar.height:this._height,r$M=this._tf.padding||r$E.labelPadding;this._tf.width=r$e,this._tf.height=r$l,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-r$M[2],this._vScrollBar.y=r$M[1],this._vScrollBar.height=this._height-(r$Q?this._hScrollBar.height:0)-r$M[1]-r$M[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=r$l/Math.max(this._tf.textHeight,r$l),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=r$S),this._hScrollBar&&(this._hScrollBar.x=r$M[0],this._hScrollBar.y=this._height-this._hScrollBar.height-r$M[3],this._hScrollBar.width=this._width-(r$S?this._vScrollBar.width:0)-r$M[0]-r$M[2],this._hScrollBar.scrollSize=Math.max(.033*r$e,1),this._hScrollBar.thumbPercent=r$e/Math.max(this._tf.textWidth,r$e),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=r$Q)},r$S.scrollTo=function(r$S){this.commitMeasure(),this._tf.scrollY=r$S},r$M(0,r$S,"scrollY",function(){return this._tf.scrollY}),r$M(0,r$S,"width",r$Q.prototype._$get_width,function(r$S){r$j.superSet(r$eS,this,"width",r$S),this.callLater(this.changeScroll)}),r$M(0,r$S,"hScrollBar",function(){return this._hScrollBar}),r$M(0,r$S,"height",r$Q.prototype._$get_height,function(r$S){r$j.superSet(r$eS,this,"height",r$S),this.callLater(this.changeScroll)}),r$M(0,r$S,"maxScrollX",function(){return this._tf.maxScrollX}),r$M(0,r$S,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(r$S){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new r$QS),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=r$S}),r$M(0,r$S,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(r$S){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new r$C),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=r$S}),r$M(0,r$S,"vScrollBar",function(){return this._vScrollBar}),r$M(0,r$S,"maxScrollY",function(){return this._tf.maxScrollY}),r$M(0,r$S,"scrollX",function(){return this._tf.scrollX}),r$e}(r$eS);!function(r$S){function r$Q(){this._uiView=null,this.isCloseOther=!1,r$Q.__super.call(this)}r$d(r$Q,"laya.ui.AsynDialog",r$MS);var r$e=r$Q.prototype;r$e.createView=function(r$S){this._uiView=r$S},r$e._open=function(r$S,r$Q,r$e){this.isModal=r$S,this.isCloseOther=r$Q,r$MS.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},r$e.onCreated=function(){this.createUI(),this.onOpen()},r$e.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},r$e.onOpen=function(){r$MS.manager.open(this,this.isCloseOther),r$MS.manager.lock(!1)},r$e.close=function(r$S,r$Q){void 0===r$Q&&(r$Q=!0),r$MS.manager.close(this),this.onClose()},r$e.onClose=function(){},r$e.destroy=function(r$S){void 0===r$S&&(r$S=!0),laya.ui.View.prototype.destroy.call(this,r$S),this._uiView=null,this.onDestroy()},r$e.onDestroy=function(){}}();r$j.__init([r$x])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(r$S,r$Q){"use strict";for(var r$e in Object.defineProperty(r$Q,"__esModule",{value:!0}),Laya){var r$l=Laya[r$e];r$l&&r$l.__isclass&&(r$Q[r$e]=r$l)}}),function(r$p,r$S,r$D){r$D.un,r$D.uns;var r$Y=r$D.static,r$J=r$D.class,r$L=r$D.getset,r$l=r$D.__newvec,r$v=laya.maths.Arith,r$T=laya.webgl.atlas.AtlasResourceManager,r$e=laya.webgl.shader.BaseShader,r$h=laya.utils.Browser,r$U=laya.webgl.utils.Buffer,r$B=laya.utils.Byte,r$M=laya.utils.ClassUtils,r$i=r$D.Config,r$d=(laya.events.Event,laya.events.EventDispatcher),r$E=laya.utils.Handler,r$G=laya.net.Loader,r$Q=laya.net.LoaderManager,r$R=(laya.maths.MathUtil,laya.display.Node),r$j=laya.renders.Render,r$o=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),r$c=laya.resource.Resource,r$z=laya.utils.RunDriver,r$A=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),r$O=laya.display.Sprite,r$H=laya.utils.Stat,r$g=laya.utils.StringKey,r$t=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),r$I=laya.utils.Utils,r$k=laya.webgl.WebGL,r$X=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;r$D.interface("laya.d3.core.IClone"),r$D.interface("laya.d3.graphics.IVertex"),r$D.interface("laya.d3.core.render.IUpdate"),r$D.interface("laya.d3.core.scene.ITreeNode"),r$D.interface("laya.d3.core.render.IRenderable");(function(){function r$$(){}r$J(r$$,"laya.d3.animation.AnimationClipParser01"),r$$.READ_DATA=function(){r$$._DATA.offset=r$$._reader.getUint32(),r$$._DATA.size=r$$._reader.getUint32()},r$$.READ_BLOCK=function(){for(var r$S=r$$._BLOCK.count=r$$._reader.getUint16(),r$Q=r$$._BLOCK.blockStarts=[],r$e=r$$._BLOCK.blockLengths=[],r$l=0;r$l<r$S;r$l++)r$Q.push(r$$._reader.getUint32()),r$e.push(r$$._reader.getUint32())},r$$.READ_STRINGS=function(){var r$S=r$$._reader.getUint32(),r$Q=r$$._reader.getUint16(),r$e=r$$._reader.pos;r$$._reader.pos=r$S+r$$._DATA.offset;for(var r$l=0;r$l<r$Q;r$l++)r$$._strings[r$l]=r$$._reader.readUTFString();r$$._reader.pos=r$e},r$$.parse=function(r$S,r$Q){r$$._animationClip=r$S;(r$$._reader=r$Q).__getBuffer();r$$.READ_DATA(),r$$.READ_BLOCK(),r$$.READ_STRINGS();for(var r$e=0,r$l=r$$._BLOCK.count;r$e<r$l;r$e++){var r$M=r$Q.getUint16(),r$d=r$$._strings[r$M],r$T=r$$["READ_"+r$d];if(null==r$T)throw new Error("model file err,no this function:"+r$M+" "+r$d);r$T.call()}},r$$.READ_ANIMATIONS=function(){var r$S,r$Q=0,r$e=0,r$l=r$$._reader,r$M=r$l.__getBuffer(),r$d=[],r$T=r$l.getUint8();for(r$d.length=r$T,r$Q=0;r$Q<r$T;r$Q++)r$d[r$Q]=r$l.getUint16();var r$U=[],r$i=r$l.getUint16();for(r$U.length=r$i,r$Q=0;r$Q<r$i;r$Q++)r$U[r$Q]=r$l.getFloat32();var r$R=r$$._animationClip;r$R.name=r$$._strings[r$l.getUint16()];var r$o=r$R._duration=r$l.getFloat32();r$R.islooping=!!r$l.getByte(),r$R._frameRate=r$l.getInt16();var r$Y=r$l.getInt16(),r$p=r$R._nodes=new Array;r$p.length=r$Y,(r$R._publicClipDatas=[]).length=r$Y;var r$J=r$R._nodesMap={},r$L=0,r$j=0;for(r$Q=0;r$Q<r$Y;r$Q++){r$S=r$p[r$Q]=new r$W;var r$c=r$l.getUint16(),r$G=r$S.path=[];for(r$G.length=r$c,r$e=0;r$e<r$c;r$e++)r$G[r$e]=r$$._strings[r$l.getUint16()];var r$z=r$G.join("/"),r$A=r$J[r$z];r$A||(r$J[r$z]=r$A=[]),r$A.push(r$S);var r$v=r$l.getInt16();-1!==r$v&&(r$S.componentType=r$$._strings[r$v]);var r$D=r$u._propertyIndexDic[r$$._strings[r$l.getUint16()]];if(null==r$D)throw new Error("AnimationClipParser01:unknown property name.");var r$B=r$D<4,r$O=!r$B||r$B&&""===r$G[0];(r$S._cacheProperty=r$O)?r$L++:r$j++,r$S.propertyNameID=r$D;var r$H=r$d[r$l.getUint8()];r$S.keyFrameWidth=r$H/4;var r$g=r$S.keyFrames=[],r$I=r$g.length=r$l.getUint16(),r$E=null,r$t=NaN;for(r$e=0;r$e<r$I;r$e++){var r$k=r$g[r$e]=new r$r;r$t=r$k.startTime=r$U[r$l.getUint16()];var r$X=r$l.pos;r$k.inTangent=new Float32Array(r$M.slice(r$X,r$X+r$H)),r$l.pos+=r$H,r$X=r$l.pos,r$k.outTangent=new Float32Array(r$M.slice(r$X,r$X+r$H)),r$l.pos+=r$H,r$X=r$l.pos,r$k.data=new Float32Array(r$M.slice(r$X,r$X+r$H)),r$l.pos+=r$H,r$E&&(r$E.next=r$k,r$E.duration=r$t-r$E.startTime),r$E=r$k}r$k.next=null,r$k.duration=r$o-r$t}var r$h=r$R._nodeToCachePropertyMap=new Int32Array(r$Y),r$b=r$R._cachePropertyMap=new Int32Array(r$L),r$m=r$R._unCachePropertyMap=new Int32Array(r$j);for(r$L=r$j=0,r$Q=0;r$Q<r$Y;r$Q++)(r$S=r$p[r$Q])._cacheProperty?(r$h[r$Q]=r$L,r$b[r$L++]=r$Q):r$m[r$j++]=r$Q},r$$._animationClip=null,r$$._reader=null,r$$._strings=[],r$Y(r$$,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function r$f(){}r$J(r$f,"laya.d3.animation.AnimationClipParser02"),r$f.READ_DATA=function(){r$f._DATA.offset=r$f._reader.getUint32(),r$f._DATA.size=r$f._reader.getUint32()},r$f.READ_BLOCK=function(){for(var r$S=r$f._BLOCK.count=r$f._reader.getUint16(),r$Q=r$f._BLOCK.blockStarts=[],r$e=r$f._BLOCK.blockLengths=[],r$l=0;r$l<r$S;r$l++)r$Q.push(r$f._reader.getUint32()),r$e.push(r$f._reader.getUint32())},r$f.READ_STRINGS=function(){var r$S=r$f._reader.getUint32(),r$Q=r$f._reader.getUint16(),r$e=r$f._reader.pos;r$f._reader.pos=r$S+r$f._DATA.offset;for(var r$l=0;r$l<r$Q;r$l++)r$f._strings[r$l]=r$f._reader.readUTFString();r$f._reader.pos=r$e},r$f.parse=function(r$S,r$Q){r$f._animationClip=r$S;(r$f._reader=r$Q).__getBuffer();r$f.READ_DATA(),r$f.READ_BLOCK(),r$f.READ_STRINGS();for(var r$e=0,r$l=r$f._BLOCK.count;r$e<r$l;r$e++){var r$M=r$Q.getUint16(),r$d=r$f._strings[r$M],r$T=r$f["READ_"+r$d];if(null==r$T)throw new Error("model file err,no this function:"+r$M+" "+r$d);r$T.call()}},r$f.READ_ANIMATIONS=function(){var r$S,r$Q=0,r$e=0,r$l=r$f._reader,r$M=r$l.__getBuffer(),r$d=[],r$T=r$l.getUint8();for(r$d.length=r$T,r$Q=0;r$Q<r$T;r$Q++)r$d[r$Q]=r$l.getUint16();var r$U=[],r$i=r$l.getUint16();for(r$U.length=r$i,r$Q=0;r$Q<r$i;r$Q++)r$U[r$Q]=r$l.getFloat32();var r$R=r$f._animationClip;r$R.name=r$f._strings[r$l.getUint16()];var r$o=r$R._duration=r$l.getFloat32();r$R.islooping=!!r$l.getByte(),r$R._frameRate=r$l.getInt16();var r$Y=r$l.getInt16(),r$p=r$R._nodes=new Array;r$p.length=r$Y,(r$R._publicClipDatas=[]).length=r$Y;var r$J=r$R._nodesMap={},r$L=0,r$j=0;for(r$Q=0;r$Q<r$Y;r$Q++){r$S=r$p[r$Q]=new r$W;var r$c=r$l.getUint16(),r$G=r$S.path=[];for(r$G.length=r$c,r$e=0;r$e<r$c;r$e++)r$G[r$e]=r$f._strings[r$l.getUint16()];var r$z=r$G.join("/"),r$A=r$J[r$z];r$A||(r$J[r$z]=r$A=[]),r$A.push(r$S);var r$v=r$l.getInt16();-1!==r$v&&(r$S.componentType=r$f._strings[r$v]);var r$D=r$u._propertyIndexDic[r$f._strings[r$l.getUint16()]];if(null==r$D)throw new Error("AnimationClipParser02:unknown property name.");var r$B=r$D<4,r$O=!r$B||r$B&&""===r$G[0];(r$S._cacheProperty=r$O)?r$L++:r$j++,r$S.propertyNameID=r$D;var r$H=r$d[r$l.getUint8()];r$S.keyFrameWidth=r$H/4;var r$g=r$S.keyFrames=[],r$I=r$g.length=r$l.getUint16(),r$E=null,r$t=NaN;for(r$e=0;r$e<r$I;r$e++){var r$k=r$g[r$e]=new r$r;r$t=r$k.startTime=r$U[r$l.getUint16()];var r$X=r$l.pos;r$k.inTangent=new Float32Array(r$M.slice(r$X,r$X+r$H)),r$l.pos+=r$H,r$X=r$l.pos,r$k.outTangent=new Float32Array(r$M.slice(r$X,r$X+r$H)),r$l.pos+=r$H,r$X=r$l.pos,r$k.data=new Float32Array(r$M.slice(r$X,r$X+r$H)),r$l.pos+=r$H,r$E&&(r$E.next=r$k,r$E.duration=r$t-r$E.startTime),r$E=r$k}r$k.next=null,r$k.duration=r$o-r$t}var r$h=r$l.getUint16();for(r$Q=0;r$Q<r$h;r$Q++){var r$b,r$m=new r$w;r$m.time=r$l.getFloat32(),r$m.eventName=r$f._strings[r$l.getUint16()];var r$$=r$l.getUint16();for(0<r$$&&(r$m.params=r$b=[]),r$e=0;r$e<r$$;r$e++){switch(r$l.getByte()){case 0:r$b.push(!!r$l.getByte());break;case 1:r$b.push(r$l.getInt32());break;case 2:r$b.push(r$l.getFloat32());break;case 3:r$b.push(r$f._strings[r$l.getUint16()]);break;default:throw new Error("unknown type.")}}r$R.addEvent(r$m)}var r$n=r$R._nodeToCachePropertyMap=new Int32Array(r$Y),r$P=r$R._cachePropertyMap=new Int32Array(r$L),r$a=r$R._unCachePropertyMap=new Int32Array(r$j);for(r$L=r$j=0,r$Q=0;r$Q<r$Y;r$Q++)(r$S=r$p[r$Q])._cacheProperty?(r$n[r$Q]=r$L,r$P[r$L++]=r$Q):r$a[r$j++]=r$Q},r$f._animationClip=null,r$f._reader=null,r$f._strings=[],r$Y(r$f,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var r$w=function(){function r$S(){this.time=NaN,this.eventName=null,this.params=null}return r$J(r$S,"laya.d3.animation.AnimationEvent"),r$S}(),r$u=function(){function r$l(){this._childs=[],this.transform=new r$zQ(this)}r$J(r$l,"laya.d3.animation.AnimationNode");var r$S=r$l.prototype;return r$D.imps(r$S,{"laya.d3.core.IClone":!0}),r$S.addChild=function(r$S){r$S._parent=this,r$S.transform.setParent(this.transform),this._childs.push(r$S)},r$S.removeChild=function(r$S){var r$Q=this._childs.indexOf(r$S);-1!==r$Q&&this._childs.splice(r$Q,1)},r$S.getChildByName=function(r$S){for(var r$Q=0,r$e=this._childs.length;r$Q<r$e;r$Q++){var r$l=this._childs[r$Q];if(r$l.name===r$S)return r$l}return null},r$S.getChildByIndex=function(r$S){return this._childs[r$S]},r$S.getChildCount=function(){return this._childs.length},r$S.cloneTo=function(r$S){var r$Q=r$S;r$Q.name=this.name;for(var r$e=0,r$l=this._childs.length;r$e<r$l;r$e++){var r$M=this._childs[r$e],r$d=r$M.clone();r$Q.addChild(r$d);var r$T=r$M.transform,r$U=r$d.transform;r$U.setLocalPosition(r$T.getLocalPosition()),r$U.setLocalRotation(r$T.getLocalRotation()),r$U.setLocalScale(r$T.getLocalScale()),r$U._localRotationEuler=r$T._localRotationEuler,r$U._setWorldMatrixIgnoreUpdate(r$T.getWorldMatrix())}},r$S.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$l.__init__=function(){r$l.registerAnimationNodeProperty("localPosition",r$l._getLocalPosition,r$l._setLocalPosition),r$l.registerAnimationNodeProperty("localRotation",r$l._getLocalRotation,r$l._setLocalRotation),r$l.registerAnimationNodeProperty("localScale",r$l._getLocalScale,r$l._setLocalScale),r$l.registerAnimationNodeProperty("localRotationEuler",r$l._getLocalRotationEuler,r$l._setLocalRotationEuler),r$l.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",r$l._getParticleRenderSharedMaterialTintColor,r$l._setParticleRenderSharedMaterialTintColor),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",r$l._getMeshRenderSharedMaterialTilingOffset,r$l._setMeshRenderSharedMaterialTilingOffset),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",r$l._getMeshRenderSharedMaterialAlbedo,r$l._setMeshRenderSharedMaterialAlbedo),r$l.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",r$l._getSkinnedMeshRenderSharedMaterialTilingOffset,r$l._setSkinnedMeshRenderSharedMaterialTilingOffset),r$l.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",r$l._getSkinnedMeshRenderSharedMaterialAlbedo,r$l._setSkinnedMeshRenderSharedMaterialAlbedo),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",r$l._getMeshRenderSharedMaterialAlbedo,r$l._setMeshRenderSharedMaterialAlbedo),r$l.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",r$l._getSkinnedMeshRenderSharedMaterialAlbedo,r$l._setSkinnedMeshRenderSharedMaterialAlbedo),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",r$l._getMeshRenderSharedMaterialIntensity,r$l._setMeshRenderSharedMaterialIntensity),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",r$l._getMeshRenderSharedMaterialAlpha,r$l._setMeshRenderSharedMaterialAlpha),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",r$l._getMeshRenderSharedMaterialAlphaColor,r$l._setMeshRenderSharedMaterialAlphaColor),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",r$l._getMeshRenderSharedMaterialBaseColor,r$l._setMeshRenderSharedMaterialBaseColor),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",r$l._getMeshRenderSharedMaterialDissolve,r$l._setMeshRenderSharedMaterialDissolve),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",r$l._getMeshRenderSharedMaterialDissolveSpeed,r$l._setMeshRenderSharedMaterialDissolveSpeed),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",r$l._getMeshRenderSharedMaterialMMultiplier,r$l._setMeshRenderSharedMaterialMMultiplier),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",r$l._getMeshRenderSharedMaterialBaseScrollSpeedX,r$l._setMeshRenderSharedMaterialBaseScrollSpeedX),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",r$l._getMeshRenderSharedMaterialBaseScrollSpeedY,r$l._setMeshRenderSharedMaterialBaseScrollSpeedY),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",r$l._getMeshRenderSharedMaterialSecondScrollSpeedX,r$l._setMeshRenderSharedMaterialSecondScrollSpeedX),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",r$l._getMeshRenderSharedMaterialSecondScrollSpeedY,r$l._setMeshRenderSharedMaterialSecondScrollSpeedY),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",r$l._getMeshRenderSharedMaterialDetailTilingOffset,r$l._setMeshRenderSharedMaterialDetailTilingOffset),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",r$l._getMeshRenderSharedMaterialDissolveTilingOffset,r$l._setMeshRenderSharedMaterialDissolveTilingOffset),r$l.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",r$l._getMeshRenderSharedMaterialMaskTilingOffset,r$l._setMeshRenderSharedMaterialMaskTilingOffset)},r$l.registerAnimationNodeProperty=function(r$S,r$Q,r$e){if(r$l._propertyIndexDic[r$S])throw new Error("AnimationNode: this propertyName has registered.");r$l._propertyIndexDic[r$S]=r$l._propertyIDCounter,r$l._propertyGetFuncs[r$l._propertyIDCounter]=r$Q,r$l._propertySetFuncs[r$l._propertyIDCounter]=r$e,r$l._propertyIDCounter++},r$l._getLocalPosition=function(r$S,r$Q){return r$S?r$S.transform.getLocalPosition():r$Q._transform.localPosition.elements},r$l._setLocalPosition=function(r$S,r$Q,r$e){if(r$S)r$S.transform.setLocalPosition(r$e);else{var r$l=r$Q._transform,r$M=r$l.localPosition;r$M.elements=r$e,r$l.localPosition=r$M}},r$l._getLocalRotation=function(r$S,r$Q){return r$S?r$S.transform.getLocalRotation():r$Q._transform.localRotation.elements},r$l._setLocalRotation=function(r$S,r$Q,r$e){if(r$S)r$S.transform.setLocalRotation(r$e);else{var r$l=r$Q._transform,r$M=r$l.localRotation;r$M.elements=r$e,r$l.localRotation=r$M}},r$l._getLocalScale=function(r$S,r$Q){return r$S?r$S.transform.getLocalScale():r$Q._transform.localScale.elements},r$l._setLocalScale=function(r$S,r$Q,r$e){if(r$S)r$S.transform.setLocalScale(r$e);else{var r$l=r$Q._transform,r$M=r$l.localScale;r$M.elements=r$e,r$l.localScale=r$M}},r$l._getLocalRotationEuler=function(r$S,r$Q){return r$S?r$S.transform.getLocalRotationEuler():r$Q._transform.localRotationEuler.elements},r$l._setLocalRotationEuler=function(r$S,r$Q,r$e){if(r$S)r$S.transform.setLocalRotationEuler(r$e);else{var r$l=r$Q._transform,r$M=r$l.localRotationEuler;r$M.elements=r$e,r$l.localRotationEuler=r$M}},r$l._getMeshRenderSharedMaterialTilingOffset=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return r$Q.meshRender.sharedMaterial.tilingOffset.elements},r$l._setMeshRenderSharedMaterialTilingOffset=function(r$S,r$Q,r$e){var r$l,r$M;if(r$S){var r$d=r$S.transform._entity;r$d&&((r$M=(r$l=r$d.owner.meshRender.material).tilingOffset).elements=r$e,r$l.tilingOffset=r$M)}else(r$M=(r$l=r$Q.meshRender.material).tilingOffset).elements=r$e,r$l.tilingOffset=r$M},r$l._getMeshRenderSharedMaterialAlbedo=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.albedoColor.elements:null}return r$Q.meshRender.sharedMaterial.albedoColor.elements},r$l._setMeshRenderSharedMaterialAlbedo=function(r$S,r$Q,r$e){var r$l,r$M;if(r$S){var r$d=r$S.transform._entity;r$d&&((r$M=(r$l=r$d.owner.meshRender.material).albedoColor).elements=r$e,r$l.albedoColor=r$M)}else(r$M=(r$l=r$Q.meshRender.material).albedoColor).elements=r$e,r$l.albedoColor=r$M},r$l._getSkinnedMeshRenderSharedMaterialTilingOffset=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return r$Q.skinnedMeshRender.sharedMaterial.tilingOffset.elements},r$l._setSkinnedMeshRenderSharedMaterialTilingOffset=function(r$S,r$Q,r$e){var r$l,r$M;if(r$S){var r$d=r$S.transform._entity;r$d&&((r$M=(r$l=r$d.owner.skinnedMeshRender.material).tilingOffset).elements=r$e,r$l.tilingOffset=r$M)}else(r$M=(r$l=r$Q.skinnedMeshRender.material).tilingOffset).elements=r$e,r$l.tilingOffset=r$M},r$l._getSkinnedMeshRenderSharedMaterialAlbedo=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return r$Q.skinnedMeshRender.sharedMaterial.albedoColor.elements},r$l._setSkinnedMeshRenderSharedMaterialAlbedo=function(r$S,r$Q,r$e){var r$l,r$M;if(r$S){var r$d=r$S.transform._entity;r$d&&((r$M=(r$l=r$d.owner.skinnedMeshRender.material).albedoColor).elements=r$e,r$l.albedoColor=r$M)}else(r$M=(r$l=r$Q.skinnedMeshRender.material).albedoColor).elements=r$e,r$l.albedoColor=r$M},r$l._getParticleRenderSharedMaterialTintColor=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.particleRender.sharedMaterial.tintColor.elements:null}return r$Q.particleRender.sharedMaterial.tintColor.elements},r$l._setParticleRenderSharedMaterialTintColor=function(r$S,r$Q,r$e){var r$l,r$M;if(r$S){var r$d=r$S.transform._entity;r$d&&((r$M=(r$l=r$d.owner.particleRender.material).tintColor).elements=r$e,r$l.tintColor=r$M)}else(r$M=(r$l=r$Q.particleRender.material).tintColor).elements=r$e,r$l.tintColor=r$M},r$l._getMeshRenderSharedMaterialAlphaColor=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.alphaColor.elements:null}return r$Q.meshRender.sharedMaterial.alphaColor.elements},r$l._setMeshRenderSharedMaterialAlphaColor=function(r$S,r$Q,r$e){var r$l,r$M;if(r$S){var r$d=r$S.transform._entity;r$d&&((r$M=(r$l=r$d.owner.meshRender.material).alphaColor).elements=r$e,r$l.alphaColor=r$M)}else(r$M=(r$l=r$Q.meshRender.material).alphaColor).elements=r$e,r$l.alphaColor=r$M},r$l._getMeshRenderSharedMaterialBaseColor=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.baseColor.elements:null}return r$Q.meshRender.sharedMaterial.baseColor.elements},r$l._setMeshRenderSharedMaterialBaseColor=function(r$S,r$Q,r$e){var r$l,r$M;if(r$S){var r$d=r$S.transform._entity;r$d&&((r$M=(r$l=r$d.owner.meshRender.material).baseColor).elements=r$e,r$l.baseColor=r$M)}else(r$M=(r$l=r$Q.meshRender.material).baseColor).elements=r$e,r$l.baseColor=r$M},r$l._getMeshRenderSharedMaterialDissolve=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.dissolve:0}return r$Q.meshRender.sharedMaterial.dissolve},r$l._setMeshRenderSharedMaterialDissolve=function(r$S,r$Q,r$e){if(r$S){var r$l=r$S.transform._entity;r$l&&(r$l.owner.meshRender.material.dissolve=r$e[0])}else r$Q.meshRender.material.dissolve=r$e[0]},r$l._getMeshRenderSharedMaterialDissolveSpeed=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.dissolveSpeed:0}return r$Q.meshRender.sharedMaterial.dissolveSpeed},r$l._setMeshRenderSharedMaterialDissolveSpeed=function(r$S,r$Q,r$e){if(r$S){var r$l=r$S.transform._entity;r$l&&(r$l.owner.meshRender.material.dissolveSpeed=r$e[0])}else r$Q.meshRender.material.dissolveSpeed=r$e[0]},r$l._getMeshRenderSharedMaterialMMultiplier=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.mMultiplier:0}return r$Q.meshRender.sharedMaterial.mMultiplier},r$l._setMeshRenderSharedMaterialMMultiplier=function(r$S,r$Q,r$e){if(r$S){var r$l=r$S.transform._entity;r$l&&(r$l.owner.meshRender.material.mMultiplier=r$e[0])}else r$Q.meshRender.material.mMultiplier=r$e[0]},r$l._getMeshRenderSharedMaterialBaseScrollSpeedX=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return r$Q.meshRender.sharedMaterial.baseScrollSpeedX},r$l._setMeshRenderSharedMaterialBaseScrollSpeedX=function(r$S,r$Q,r$e){if(r$S){var r$l=r$S.transform._entity;r$l&&(r$l.owner.meshRender.material.baseScrollSpeedX=r$e[0])}else r$Q.meshRender.material.baseScrollSpeedX=r$e[0]},r$l._getMeshRenderSharedMaterialBaseScrollSpeedY=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return r$Q.meshRender.sharedMaterial.baseScrollSpeedY},r$l._setMeshRenderSharedMaterialBaseScrollSpeedY=function(r$S,r$Q,r$e){if(r$S){var r$l=r$S.transform._entity;r$l&&(r$l.owner.meshRender.material.baseScrollSpeedY=r$e[0])}else r$Q.meshRender.material.baseScrollSpeedY=r$e[0]},r$l._getMeshRenderSharedMaterialSecondScrollSpeedX=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return r$Q.meshRender.sharedMaterial.secondScrollSpeedX},r$l._setMeshRenderSharedMaterialSecondScrollSpeedX=function(r$S,r$Q,r$e){if(r$S){var r$l=r$S.transform._entity;r$l&&(r$l.owner.meshRender.material.secondScrollSpeedX=r$e[0])}else r$Q.meshRender.material.secondScrollSpeedX=r$e[0]},r$l._getMeshRenderSharedMaterialSecondScrollSpeedY=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return r$Q.meshRender.sharedMaterial.secondScrollSpeedY},r$l._setMeshRenderSharedMaterialSecondScrollSpeedY=function(r$S,r$Q,r$e){if(r$S){var r$l=r$S.transform._entity;r$l&&(r$l.owner.meshRender.material.secondScrollSpeedY=r$e[0])}else r$Q.meshRender.material.secondScrollSpeedY=r$e[0]},r$l._getMeshRenderSharedMaterialAlpha=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.alpha:0}return r$Q.meshRender.sharedMaterial.alpha},r$l._setMeshRenderSharedMaterialAlpha=function(r$S,r$Q,r$e){if(r$S){var r$l=r$S.transform._entity;r$l&&(r$l.owner.meshRender.material.alpha=r$e[0])}else r$Q.meshRender.material.alpha=r$e[0]},r$l._getMeshRenderSharedMaterialIntensity=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.intensity:0}return r$Q.meshRender.sharedMaterial.intensity},r$l._setMeshRenderSharedMaterialIntensity=function(r$S,r$Q,r$e){if(r$S){var r$l=r$S.transform._entity;r$l&&(r$l.owner.meshRender.material.intensity=r$e[0])}else r$Q.meshRender.material.intensity=r$e[0]},r$l._getMeshRenderSharedMaterialDetailTilingOffset=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return r$Q.meshRender.sharedMaterial.detailTilingOffset.elements},r$l._setMeshRenderSharedMaterialDetailTilingOffset=function(r$S,r$Q,r$e){var r$l,r$M;if(r$S){var r$d=r$S.transform._entity;r$d&&((r$M=(r$l=r$d.owner.meshRender.material).detailTilingOffset).elements=r$e,r$l.detailTilingOffset=r$M)}else(r$M=(r$l=r$Q.meshRender.material).detailTilingOffset).elements=r$e,r$l.detailTilingOffset=r$M},r$l._getMeshRenderSharedMaterialDissolveTilingOffset=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return r$Q.meshRender.sharedMaterial.dissolveTilingOffset.elements},r$l._setMeshRenderSharedMaterialDissolveTilingOffset=function(r$S,r$Q,r$e){var r$l,r$M;if(r$S){var r$d=r$S.transform._entity;r$d&&((r$M=(r$l=r$d.owner.meshRender.material).dissolveTilingOffset).elements=r$e,r$l.dissolveTilingOffset=r$M)}else(r$M=(r$l=r$Q.meshRender.material).dissolveTilingOffset).elements=r$e,r$l.dissolveTilingOffset=r$M},r$l._getMeshRenderSharedMaterialMaskTilingOffset=function(r$S,r$Q){if(r$S){var r$e=r$S.transform._entity;return r$e?r$e.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return r$Q.meshRender.sharedMaterial.maskTilingOffset.elements},r$l._setMeshRenderSharedMaterialMaskTilingOffset=function(r$S,r$Q,r$e){var r$l,r$M;if(r$S){var r$d=r$S.transform._entity;r$d&&((r$M=(r$l=r$d.owner.meshRender.material).maskTilingOffset).elements=r$e,r$l.maskTilingOffset=r$M)}else(r$M=(r$l=r$Q.meshRender.material).maskTilingOffset).elements=r$e,r$l.maskTilingOffset=r$M},r$l._propertyIDCounter=0,r$l._propertyIndexDic={},r$l._propertySetFuncs=[],r$l._propertyGetFuncs=[],r$l}(),r$r=function(){function r$S(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return r$J(r$S,"laya.d3.animation.Keyframe"),r$S}(),r$W=function(){function r$S(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return r$J(r$S,"laya.d3.animation.KeyframeNode"),r$S}(),r$b=(function(){function r$S(){this._tempVector30=new r$TQ,this._tempVector31=new r$TQ,this._tempVector32=new r$TQ,this._a=new r$TQ,this._b=new r$TQ,this._c=new r$TQ,this._d=new r$TQ}r$J(r$S,"laya.d3.core.glitter.SplineCurvePositionVelocity");var r$Q=r$S.prototype;r$Q.Init=function(r$S,r$Q,r$e,r$l){r$S.cloneTo(this._d),r$Q.cloneTo(this._c),r$TQ.scale(r$S,2,this._a),r$TQ.scale(r$e,2,this._tempVector30),r$TQ.subtract(this._a,this._tempVector30,this._a),r$TQ.add(this._a,r$Q,this._a),r$TQ.add(this._a,r$l,this._a),r$TQ.scale(r$e,3,this._b),r$TQ.scale(r$S,3,this._tempVector30),r$TQ.subtract(this._b,this._tempVector30,this._b),r$TQ.subtract(this._b,r$l,this._b),r$TQ.scale(r$Q,2,this._tempVector30),r$TQ.subtract(this._b,this._tempVector30,this._b)},r$Q.Slerp=function(r$S,r$Q){r$TQ.scale(this._a,r$S*r$S*r$S,this._tempVector30),r$TQ.scale(this._b,r$S*r$S,this._tempVector31),r$TQ.scale(this._c,r$S,this._tempVector32),r$TQ.add(this._tempVector30,this._tempVector31,r$Q),r$TQ.add(r$Q,this._tempVector32,r$Q),r$TQ.add(r$Q,this._d,r$Q)}}(),function(){function r$P(r$S,r$Q,r$e,r$l){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=r$S,this._h=r$Q,this._minHeight=r$e,this._maxHeight=r$l}r$J(r$P,"laya.d3.core.HeightMap");var r$S=r$P.prototype;r$S._inBounds=function(r$S,r$Q){return 0<=r$S&&r$S<this._h&&0<=r$Q&&r$Q<this._w},r$S.getHeight=function(r$S,r$Q){return this._inBounds(r$S,r$Q)?this._datas[r$S][r$Q]:NaN},r$L(0,r$S,"width",function(){return this._w}),r$L(0,r$S,"height",function(){return this._h}),r$L(0,r$S,"maxHeight",function(){return this._maxHeight}),r$L(0,r$S,"minHeight",function(){return this._minHeight}),r$P.creatFromMesh=function(r$S,r$Q,r$e,r$l){for(var r$M=[],r$d=[],r$T=r$S.getSubMeshCount(),r$U=0;r$U<r$T;r$U++){for(var r$i=r$S.getSubMesh(r$U),r$R=r$i._getVertexBuffer(),r$o=r$R.getData(),r$Y=[],r$p=0;r$p<r$o.length;r$p+=r$R.vertexDeclaration.vertexStride/4){var r$J=new r$TQ(r$o[r$p+0],r$o[r$p+1],r$o[r$p+2]);r$Y.push(r$J)}r$M.push(r$Y);var r$L=r$i._getIndexBuffer();r$d.push(r$L.getData())}var r$j=r$S.boundingBox,r$c=r$j.min.x,r$G=r$j.min.z,r$z=r$j.max.x,r$A=r$j.max.z,r$v=r$j.min.y,r$D=r$j.max.y,r$B=r$z-r$c,r$O=r$A-r$G,r$H=r$l.elements[0]=r$B/(r$Q-1),r$g=r$l.elements[1]=r$O/(r$e-1),r$I=new r$P(r$Q,r$e,r$v,r$D),r$E=r$P._tempRay,r$t=r$E.direction.elements;r$t[0]=0,r$t[1]=-1,r$t[2]=0;var r$k=r$D+.1;r$E.origin.elements[1]=r$k;for(var r$X=0;r$X<r$e;r$X++){var r$h=r$G+r$X*r$g;r$I._datas[r$X]=[];for(var r$b=0;r$b<r$Q;r$b++){var r$m=r$c+r$b*r$H,r$$=r$E.origin.elements;r$$[0]=r$m,r$$[2]=r$h;var r$n=r$P._getPosition(r$E,r$M,r$d);r$I._datas[r$X][r$b]=r$n===Number.MAX_VALUE?NaN:r$k-r$n}}return r$I},r$P.createFromImage=function(r$S,r$Q,r$e){for(var r$l=r$S.width,r$M=r$S.height,r$d=new r$P(r$l,r$M,r$Q,r$e),r$T=(r$e-r$Q)/254,r$U=r$S.getPixels(),r$i=0,r$R=0;r$R<r$M;r$R++)for(var r$o=r$d._datas[r$R]=[],r$Y=0;r$Y<r$l;r$Y++){var r$p=r$U[r$i++],r$J=r$U[r$i++],r$L=r$U[r$i++],r$j=r$U[r$i++];r$o[r$Y]=255==r$p&&255==r$J&&255==r$L&&255==r$j?NaN:(r$p+r$J+r$L)/3*r$T+r$Q}return r$d},r$P._getPosition=function(r$S,r$Q,r$e){for(var r$l=Number.MAX_VALUE,r$M=0;r$M<r$Q.length;r$M++)for(var r$d=r$Q[r$M],r$T=r$e[r$M],r$U=0;r$U<r$T.length;r$U+=3){var r$i=r$d[r$T[r$U+0]],r$R=r$d[r$T[r$U+1]],r$o=r$d[r$T[r$U+2]],r$Y=r$LQ.rayIntersectsTriangle(r$S,r$i,r$R,r$o);!isNaN(r$Y)&&r$Y<r$l&&(r$l=r$Y)}return r$l},r$Y(r$P,["_tempRay",function(){return this._tempRay=new r$MQ(new r$TQ,new r$TQ)}])}(),function(){function r$M(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}r$J(r$M,"laya.d3.core.Layer");var r$S=r$M.prototype;return r$S._binarySearchIndex=function(){for(var r$S=0,r$Q=r$M._collsionTestList.length-1,r$e=0;r$S<=r$Q;){r$e=Math.floor((r$S+r$Q)/2);var r$l=r$M._collsionTestList[r$e];if(r$l==this._number)return r$e;r$l>this._number?r$Q=r$e-1:r$S=r$e+1}return r$S},r$S._addCollider=function(r$S){0===this._colliders.length&&r$M._collsionTestList.splice(this._binarySearchIndex(),0,this._number),r$S._isRigidbody?(this._colliders.unshift(r$S),this._nonRigidbodyOffset++):this._colliders.push(r$S)},r$S._removeCollider=function(r$S){var r$Q=this._colliders.indexOf(r$S);r$Q<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(r$Q,1),0===this._colliders.length&&r$M._collsionTestList.splice(r$M._collsionTestList.indexOf(this._number),1)},r$L(0,r$S,"number",function(){return this._number}),r$L(0,r$S,"visible",function(){return this._visible},function(r$S){this._visible=r$S,r$M._visibleLayers=r$S?r$M._visibleLayers|this.mask:r$M._visibleLayers&~this.mask}),r$L(0,r$S,"mask",function(){return this._mask}),r$L(1,r$M,"visibleLayers",function(){return r$M._visibleLayers},function(r$S){r$M._visibleLayers=r$S;for(var r$Q=0,r$e=r$M._layerList.length;r$Q<r$e;r$Q++){var r$l=r$M._layerList[r$Q];r$l._visible=0!=(r$l._mask&r$M._visibleLayers)}}),r$M.__init__=function(){r$M._layerList.length=31;for(var r$S=0;r$S<31;r$S++){var r$Q=new r$M;r$M._layerList[r$S]=r$Q,0===r$S?(r$Q.name="Default Layer",r$Q.visible=!0):(r$Q.name="Layer-"+r$S,r$Q.visible=!1),r$Q._number=r$S,r$Q._mask=Math.pow(2,r$S)}r$M.currentCreationLayer=r$M._layerList[0]},r$M.getLayerByNumber=function(r$S){if(r$S<0||30<r$S)throw new Error("无法返回指定Layer，该number超出范围！");return r$M._layerList[r$S]},r$M.getLayerByName=function(r$S){for(var r$Q=0;r$Q<31;r$Q++)if(r$M._layerList[r$Q].name===r$S)return r$M._layerList[r$Q];throw new Error("无法返回指定Layer,该name不存在")},r$M.isVisible=function(r$S){return 0!=(r$S&r$M._currentCameraCullingMask&r$M._visibleLayers)},r$M._layerList=[],r$M._visibleLayers=2147483647,r$M._collsionTestList=[],r$M._currentCameraCullingMask=2147483647,r$M.maxCount=31,r$M.currentCreationLayer=null,r$M}()),r$m=(function(){function r$S(r$S,r$Q,r$e){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=r$S,this._minCount=r$Q,this._maxCount=r$e}r$J(r$S,"laya.d3.core.particleShuriKen.module.Burst");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q.cloneTo=function(r$S){var r$Q=r$S;r$Q._time=this._time,r$Q._minCount=this._minCount,r$Q._maxCount=this._maxCount},r$Q.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$Q,"time",function(){return this._time}),r$L(0,r$Q,"minCount",function(){return this._minCount}),r$L(0,r$Q,"maxCount",function(){return this._maxCount})}(),function(){function r$S(r$S){this._color=null,this.enbale=!1,this._color=r$S}r$J(r$S,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var r$Q=r$S.prototype;r$Q.cloneTo=function(r$S){var r$Q=r$S;this._color.cloneTo(r$Q._color),r$Q.enbale=this.enbale},r$Q.clone=function(){var r$S;switch(this._color.type){case 0:r$S=r$n.createByConstant(this._color.constant.clone());break;case 1:r$S=r$n.createByGradient(this._color.gradient.clone());break;case 2:r$S=r$n.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:r$S=r$n.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var r$Q=new this.constructor(r$S);return r$Q.enbale=this.enbale,r$Q},r$L(0,r$Q,"color",function(){return this._color})}(),function(){function r$S(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}r$J(r$S,"laya.d3.core.particleShuriKen.module.Emission");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),r$Q._destroy=function(){this._bursts=null,this._destroyed=!0},r$Q.getBurstsCount=function(){return this._bursts.length},r$Q.getBurstByIndex=function(r$S){return this._bursts[r$S]},r$Q.addBurst=function(r$S){var r$Q=this._bursts.length;if(0<r$Q)for(var r$e=0;r$e<r$Q;r$e++)this._bursts[r$e].time>r$S.time&&this._bursts.splice(r$e,0,r$S);this._bursts.push(r$S)},r$Q.removeBurst=function(r$S){var r$Q=this._bursts.indexOf(r$S);-1!==r$Q&&this._bursts.splice(r$Q,1)},r$Q.removeBurstByIndex=function(r$S){this._bursts.splice(r$S,1)},r$Q.clearBurst=function(){this._bursts.length=0},r$Q.cloneTo=function(r$S){var r$Q=r$S,r$e=r$Q._bursts;r$e.length=this._bursts.length;for(var r$l=0,r$M=this._bursts.length;r$l<r$M;r$l++){var r$d=r$e[r$l];r$d?this._bursts[r$l].cloneTo(r$d):r$e[r$l]=this._bursts[r$l].clone()}r$Q._emissionRate=this._emissionRate,r$Q.enbale=this.enbale},r$Q.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$Q,"destroyed",function(){return this._destroyed}),r$L(0,r$Q,"emissionRate",function(){return this._emissionRate},function(r$S){if(r$S<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=r$S})}(),function(){function r$l(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}r$J(r$l,"laya.d3.core.particleShuriKen.module.FrameOverTime");var r$S=r$l.prototype;return r$D.imps(r$S,{"laya.d3.core.IClone":!0}),r$S.cloneTo=function(r$S){var r$Q=r$S;r$Q._type=this._type,r$Q._constant=this._constant,this._overTime.cloneTo(r$Q._overTime),r$Q._constantMin=this._constantMin,r$Q._constantMax=this._constantMax,this._overTimeMin.cloneTo(r$Q._overTimeMin),this._overTimeMax.cloneTo(r$Q._overTimeMax)},r$S.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$S,"frameOverTimeData",function(){return this._overTime}),r$L(0,r$S,"constant",function(){return this._constant}),r$L(0,r$S,"type",function(){return this._type}),r$L(0,r$S,"frameOverTimeDataMin",function(){return this._overTimeMin}),r$L(0,r$S,"constantMin",function(){return this._constantMin}),r$L(0,r$S,"frameOverTimeDataMax",function(){return this._overTimeMax}),r$L(0,r$S,"constantMax",function(){return this._constantMax}),r$l.createByConstant=function(r$S){var r$Q=new r$l;return r$Q._type=0,r$Q._constant=r$S,r$Q},r$l.createByOverTime=function(r$S){var r$Q=new r$l;return r$Q._type=1,r$Q._overTime=r$S,r$Q},r$l.createByRandomTwoConstant=function(r$S,r$Q){var r$e=new r$l;return r$e._type=2,r$e._constantMin=r$S,r$e._constantMax=r$Q,r$e},r$l.createByRandomTwoOverTime=function(r$S,r$Q){var r$e=new r$l;return r$e._type=3,r$e._overTimeMin=r$S,r$e._overTimeMax=r$Q,r$e},r$l}()),r$$=function(){function r$R(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}r$J(r$R,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var r$S=r$R.prototype;return r$D.imps(r$S,{"laya.d3.core.IClone":!0}),r$S.cloneTo=function(r$S){var r$Q=r$S;r$Q._type=this._type,r$Q._separateAxes=this._separateAxes,r$Q._constant=this._constant,this._constantSeparate.cloneTo(r$Q._constantSeparate),this._gradient.cloneTo(r$Q._gradient),this._gradientX.cloneTo(r$Q._gradientX),this._gradientY.cloneTo(r$Q._gradientY),this._gradientZ.cloneTo(r$Q._gradientZ),r$Q._constantMin=this._constantMin,r$Q._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(r$Q._constantMinSeparate),this._constantMaxSeparate.cloneTo(r$Q._constantMaxSeparate),this._gradientMin.cloneTo(r$Q._gradientMin),this._gradientMax.cloneTo(r$Q._gradientMax),this._gradientXMin.cloneTo(r$Q._gradientXMin),this._gradientXMax.cloneTo(r$Q._gradientXMax),this._gradientYMin.cloneTo(r$Q._gradientYMin),this._gradientYMax.cloneTo(r$Q._gradientYMax),this._gradientZMin.cloneTo(r$Q._gradientZMin),this._gradientZMax.cloneTo(r$Q._gradientZMax)},r$S.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$S,"gradientZ",function(){return this._gradientZ}),r$L(0,r$S,"constant",function(){return this._constant}),r$L(0,r$S,"gradient",function(){return this._gradient}),r$L(0,r$S,"separateAxes",function(){return this._separateAxes}),r$L(0,r$S,"type",function(){return this._type}),r$L(0,r$S,"constantSeparate",function(){return this._constantSeparate}),r$L(0,r$S,"gradientX",function(){return this._gradientX}),r$L(0,r$S,"gradientY",function(){return this._gradientY}),r$L(0,r$S,"gradientW",function(){return this._gradientW}),r$L(0,r$S,"gradientMin",function(){return this._gradientMin}),r$L(0,r$S,"constantMin",function(){return this._constantMin}),r$L(0,r$S,"gradientMax",function(){return this._gradientMax}),r$L(0,r$S,"constantMax",function(){return this._constantMax}),r$L(0,r$S,"gradientWMin",function(){return this._gradientWMin}),r$L(0,r$S,"constantMinSeparate",function(){return this._constantMinSeparate}),r$L(0,r$S,"constantMaxSeparate",function(){return this._constantMaxSeparate}),r$L(0,r$S,"gradientXMin",function(){return this._gradientXMin}),r$L(0,r$S,"gradientXMax",function(){return this._gradientXMax}),r$L(0,r$S,"gradientWMax",function(){return this._gradientWMax}),r$L(0,r$S,"gradientYMin",function(){return this._gradientYMin}),r$L(0,r$S,"gradientYMax",function(){return this._gradientYMax}),r$L(0,r$S,"gradientZMin",function(){return this._gradientZMin}),r$L(0,r$S,"gradientZMax",function(){return this._gradientZMax}),r$R.createByConstant=function(r$S){var r$Q=new r$R;return r$Q._type=0,r$Q._separateAxes=!1,r$Q._constant=r$S,r$Q},r$R.createByConstantSeparate=function(r$S){var r$Q=new r$R;return r$Q._type=0,r$Q._separateAxes=!0,r$Q._constantSeparate=r$S,r$Q},r$R.createByGradient=function(r$S){var r$Q=new r$R;return r$Q._type=1,r$Q._separateAxes=!1,r$Q._gradient=r$S,r$Q},r$R.createByGradientSeparate=function(r$S,r$Q,r$e,r$l){var r$M=new r$R;return r$M._type=1,r$M._separateAxes=!0,r$M._gradientX=r$S,r$M._gradientY=r$Q,r$M._gradientZ=r$e,r$M._gradientW=r$l,r$M},r$R.createByRandomTwoConstant=function(r$S,r$Q){var r$e=new r$R;return r$e._type=2,r$e._separateAxes=!1,r$e._constantMin=r$S,r$e._constantMax=r$Q,r$e},r$R.createByRandomTwoConstantSeparate=function(r$S,r$Q){var r$e=new r$R;return r$e._type=2,r$e._separateAxes=!0,r$e._constantMinSeparate=r$S,r$e._constantMaxSeparate=r$Q,r$e},r$R.createByRandomTwoGradient=function(r$S,r$Q){var r$e=new r$R;return r$e._type=3,r$e._separateAxes=!1,r$e._gradientMin=r$S,r$e._gradientMax=r$Q,r$e},r$R.createByRandomTwoGradientSeparate=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){var r$i=new r$R;return r$i._type=3,r$i._separateAxes=!0,r$i._gradientXMin=r$S,r$i._gradientXMax=r$Q,r$i._gradientYMin=r$e,r$i._gradientYMax=r$l,r$i._gradientZMin=r$M,r$i._gradientZMax=r$d,r$i._gradientWMin=r$T,r$i._gradientWMax=r$U,r$i},r$R}(),r$n=function(){function r$l(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}r$J(r$l,"laya.d3.core.particleShuriKen.module.GradientColor");var r$S=r$l.prototype;return r$D.imps(r$S,{"laya.d3.core.IClone":!0}),r$S.cloneTo=function(r$S){var r$Q=r$S;r$Q._type=this._type,this._constant.cloneTo(r$Q._constant),this._constantMin.cloneTo(r$Q._constantMin),this._constantMax.cloneTo(r$Q._constantMax),this._gradient.cloneTo(r$Q._gradient),this._gradientMin.cloneTo(r$Q._gradientMin),this._gradientMax.cloneTo(r$Q._gradientMax)},r$S.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$S,"gradient",function(){return this._gradient}),r$L(0,r$S,"constant",function(){return this._constant}),r$L(0,r$S,"type",function(){return this._type}),r$L(0,r$S,"gradientMin",function(){return this._gradientMin}),r$L(0,r$S,"constantMin",function(){return this._constantMin}),r$L(0,r$S,"gradientMax",function(){return this._gradientMax}),r$L(0,r$S,"constantMax",function(){return this._constantMax}),r$l.createByConstant=function(r$S){var r$Q=new r$l;return r$Q._type=0,r$Q._constant=r$S,r$Q},r$l.createByGradient=function(r$S){var r$Q=new r$l;return r$Q._type=1,r$Q._gradient=r$S,r$Q},r$l.createByRandomTwoConstant=function(r$S,r$Q){var r$e=new r$l;return r$e._type=2,r$e._constantMin=r$S,r$e._constantMax=r$Q,r$e},r$l.createByRandomTwoGradient=function(r$S,r$Q){var r$e=new r$l;return r$e._type=3,r$e._gradientMin=r$S,r$e._gradientMax=r$Q,r$e},r$l}(),r$P=(function(){function r$S(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}r$J(r$S,"laya.d3.core.particleShuriKen.module.GradientDataColor");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q.addAlpha=function(r$S,r$Q){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==r$S&&(r$S=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=r$S,this._alphaElements[this._alphaCurrentLength++]=r$Q):DEBUG},r$Q.addRGB=function(r$S,r$Q){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==r$S&&(r$S=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=r$S,this._rgbElements[this._rgbCurrentLength++]=r$Q.x,this._rgbElements[this._rgbCurrentLength++]=r$Q.y,this._rgbElements[this._rgbCurrentLength++]=r$Q.z):DEBUG},r$Q.cloneTo=function(r$S){var r$Q=r$S,r$e=0,r$l=0;r$Q._alphaCurrentLength=this._alphaCurrentLength;var r$M=r$Q._alphaElements;for(r$M.length=this._alphaElements.length,r$e=0,r$l=this._alphaElements.length;r$e<r$l;r$e++)r$M[r$e]=this._alphaElements[r$e];r$Q._rgbCurrentLength=this._rgbCurrentLength;var r$d=r$Q._rgbElements;for(r$d.length=this._rgbElements.length,r$e=0,r$l=this._rgbElements.length;r$e<r$l;r$e++)r$d[r$e]=this._rgbElements[r$e]},r$Q.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$Q,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),r$L(0,r$Q,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function r$S(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}r$J(r$S,"laya.d3.core.particleShuriKen.module.GradientDataInt");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q.add=function(r$S,r$Q){this._currentLength<8?(6===this._currentLength&&1!==r$S&&(r$S=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=r$S,this._elements[this._currentLength++]=r$Q):console.log("Warning:data count must lessEqual than 4")},r$Q.cloneTo=function(r$S){var r$Q=r$S;r$Q._currentLength=this._currentLength;var r$e=r$Q._elements;r$e.length=this._elements.length;for(var r$l=0,r$M=this._elements.length;r$l<r$M;r$l++)r$e[r$l]=this._elements[r$l]},r$Q.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$Q,"gradientCount",function(){return this._currentLength/2})}(),function(){function r$S(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}r$J(r$S,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q.add=function(r$S,r$Q){this._currentLength<8?(6===this._currentLength&&1!==r$S&&(r$S=1,DEBUG),this._elements[this._currentLength++]=r$S,this._elements[this._currentLength++]=r$Q):DEBUG},r$Q.getKeyByIndex=function(r$S){return this._elements[2*r$S]},r$Q.getValueByIndex=function(r$S){return this._elements[2*r$S+1]},r$Q.getAverageValue=function(){for(var r$S=0,r$Q=this._currentLength-2;r$S<r$Q;r$S+=2){this._elements[r$S+1];this._elements[r$S+3],this._elements[r$S+2]-this._elements[r$S]}return 0},r$Q.cloneTo=function(r$S){var r$Q=r$S;r$Q._currentLength=this._currentLength;var r$e=r$Q._elements;r$e.length=this._elements.length;for(var r$l=0,r$M=this._elements.length;r$l<r$M;r$l++)r$e[r$l]=this._elements[r$l]},r$Q.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$Q,"gradientCount",function(){return this._currentLength/2})}(),function(){function r$S(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}r$J(r$S,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q.add=function(r$S,r$Q){this._currentLength<8?(6===this._currentLength&&1!==r$S&&(r$S=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=r$S,this._elements[this._currentLength++]=r$Q.x,this._elements[this._currentLength++]=r$Q.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},r$Q.cloneTo=function(r$S){var r$Q=r$S;r$Q._currentLength=this._currentLength;var r$e=r$Q._elements;r$e.length=this._elements.length;for(var r$l=0,r$M=this._elements.length;r$l<r$M;r$l++)r$e[r$l]=this._elements[r$l]},r$Q.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$Q,"gradientCount",function(){return this._currentLength/3})}(),function(){function r$U(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}r$J(r$U,"laya.d3.core.particleShuriKen.module.GradientSize");var r$S=r$U.prototype;return r$D.imps(r$S,{"laya.d3.core.IClone":!0}),r$S.getMaxSizeInGradient=function(){var r$S=0,r$Q=0,r$e=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(r$S=0,r$Q=this._gradientX.gradientCount;r$S<r$Q;r$S++)r$e=Math.max(r$e,this._gradientX.getValueByIndex(r$S));for(r$S=0,r$Q=this._gradientY.gradientCount;r$S<r$Q;r$S++)r$e=Math.max(r$e,this._gradientY.getValueByIndex(r$S))}else for(r$S=0,r$Q=this._gradient.gradientCount;r$S<r$Q;r$S++)r$e=Math.max(r$e,this._gradient.getValueByIndex(r$S));break;case 1:r$e=this._separateAxes?(r$e=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),r$e=Math.max(r$e,this._constantMinSeparate.y),Math.max(r$e,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(r$S=0,r$Q=this._gradientXMin.gradientCount;r$S<r$Q;r$S++)r$e=Math.max(r$e,this._gradientXMin.getValueByIndex(r$S));for(r$S=0,r$Q=this._gradientXMax.gradientCount;r$S<r$Q;r$S++)r$e=Math.max(r$e,this._gradientXMax.getValueByIndex(r$S));for(r$S=0,r$Q=this._gradientYMin.gradientCount;r$S<r$Q;r$S++)r$e=Math.max(r$e,this._gradientYMin.getValueByIndex(r$S));for(r$S=0,r$Q=this._gradientZMax.gradientCount;r$S<r$Q;r$S++)r$e=Math.max(r$e,this._gradientZMax.getValueByIndex(r$S))}else{for(r$S=0,r$Q=this._gradientMin.gradientCount;r$S<r$Q;r$S++)r$e=Math.max(r$e,this._gradientMin.getValueByIndex(r$S));for(r$S=0,r$Q=this._gradientMax.gradientCount;r$S<r$Q;r$S++)r$e=Math.max(r$e,this._gradientMax.getValueByIndex(r$S))}}return r$e},r$S.cloneTo=function(r$S){var r$Q=r$S;r$Q._type=this._type,r$Q._separateAxes=this._separateAxes,this._gradient.cloneTo(r$Q._gradient),this._gradientX.cloneTo(r$Q._gradientX),this._gradientY.cloneTo(r$Q._gradientY),this._gradientZ.cloneTo(r$Q._gradientZ),r$Q._constantMin=this._constantMin,r$Q._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(r$Q._constantMinSeparate),this._constantMaxSeparate.cloneTo(r$Q._constantMaxSeparate),this._gradientMin.cloneTo(r$Q._gradientMin),this._gradientMax.cloneTo(r$Q._gradientMax),this._gradientXMin.cloneTo(r$Q._gradientXMin),this._gradientXMax.cloneTo(r$Q._gradientXMax),this._gradientYMin.cloneTo(r$Q._gradientYMin),this._gradientYMax.cloneTo(r$Q._gradientYMax),this._gradientZMin.cloneTo(r$Q._gradientZMin),this._gradientZMax.cloneTo(r$Q._gradientZMax)},r$S.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$S,"gradientZ",function(){return this._gradientZ}),r$L(0,r$S,"gradient",function(){return this._gradient}),r$L(0,r$S,"separateAxes",function(){return this._separateAxes}),r$L(0,r$S,"type",function(){return this._type}),r$L(0,r$S,"gradientMin",function(){return this._gradientMin}),r$L(0,r$S,"constantMin",function(){return this._constantMin}),r$L(0,r$S,"gradientX",function(){return this._gradientX}),r$L(0,r$S,"gradientY",function(){return this._gradientY}),r$L(0,r$S,"gradientMax",function(){return this._gradientMax}),r$L(0,r$S,"constantMax",function(){return this._constantMax}),r$L(0,r$S,"constantMinSeparate",function(){return this._constantMinSeparate}),r$L(0,r$S,"constantMaxSeparate",function(){return this._constantMaxSeparate}),r$L(0,r$S,"gradientXMin",function(){return this._gradientXMin}),r$L(0,r$S,"gradientXMax",function(){return this._gradientXMax}),r$L(0,r$S,"gradientYMin",function(){return this._gradientYMin}),r$L(0,r$S,"gradientYMax",function(){return this._gradientYMax}),r$L(0,r$S,"gradientZMin",function(){return this._gradientZMin}),r$L(0,r$S,"gradientZMax",function(){return this._gradientZMax}),r$U.createByGradient=function(r$S){var r$Q=new r$U;return r$Q._type=0,r$Q._separateAxes=!1,r$Q._gradient=r$S,r$Q},r$U.createByGradientSeparate=function(r$S,r$Q,r$e){var r$l=new r$U;return r$l._type=0,r$l._separateAxes=!0,r$l._gradientX=r$S,r$l._gradientY=r$Q,r$l._gradientZ=r$e,r$l},r$U.createByRandomTwoConstant=function(r$S,r$Q){var r$e=new r$U;return r$e._type=1,r$e._separateAxes=!1,r$e._constantMin=r$S,r$e._constantMax=r$Q,r$e},r$U.createByRandomTwoConstantSeparate=function(r$S,r$Q){var r$e=new r$U;return r$e._type=1,r$e._separateAxes=!0,r$e._constantMinSeparate=r$S,r$e._constantMaxSeparate=r$Q,r$e},r$U.createByRandomTwoGradient=function(r$S,r$Q){var r$e=new r$U;return r$e._type=2,r$e._separateAxes=!1,r$e._gradientMin=r$S,r$e._gradientMax=r$Q,r$e},r$U.createByRandomTwoGradientSeparate=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=new r$U;return r$T._type=2,r$T._separateAxes=!0,r$T._gradientXMin=r$S,r$T._gradientXMax=r$Q,r$T._gradientYMin=r$e,r$T._gradientYMax=r$l,r$T._gradientZMin=r$M,r$T._gradientZMax=r$d,r$T},r$U}()),r$a=function(){function r$U(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}r$J(r$U,"laya.d3.core.particleShuriKen.module.GradientVelocity");var r$S=r$U.prototype;return r$D.imps(r$S,{"laya.d3.core.IClone":!0}),r$S.cloneTo=function(r$S){var r$Q=r$S;r$Q._type=this._type,this._constant.cloneTo(r$Q._constant),this._gradientX.cloneTo(r$Q._gradientX),this._gradientY.cloneTo(r$Q._gradientY),this._gradientZ.cloneTo(r$Q._gradientZ),this._constantMin.cloneTo(r$Q._constantMin),this._constantMax.cloneTo(r$Q._constantMax),this._gradientXMin.cloneTo(r$Q._gradientXMin),this._gradientXMax.cloneTo(r$Q._gradientXMax),this._gradientYMin.cloneTo(r$Q._gradientYMin),this._gradientYMax.cloneTo(r$Q._gradientYMax),this._gradientZMin.cloneTo(r$Q._gradientZMin),this._gradientZMax.cloneTo(r$Q._gradientZMax)},r$S.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$S,"gradientZ",function(){return this._gradientZ}),r$L(0,r$S,"constant",function(){return this._constant}),r$L(0,r$S,"type",function(){return this._type}),r$L(0,r$S,"gradientXMax",function(){return this._gradientXMax}),r$L(0,r$S,"constantMin",function(){return this._constantMin}),r$L(0,r$S,"gradientX",function(){return this._gradientX}),r$L(0,r$S,"gradientY",function(){return this._gradientY}),r$L(0,r$S,"gradientXMin",function(){return this._gradientXMin}),r$L(0,r$S,"constantMax",function(){return this._constantMax}),r$L(0,r$S,"gradientYMin",function(){return this._gradientYMin}),r$L(0,r$S,"gradientYMax",function(){return this._gradientYMax}),r$L(0,r$S,"gradientZMin",function(){return this._gradientZMin}),r$L(0,r$S,"gradientZMax",function(){return this._gradientZMax}),r$U.createByConstant=function(r$S){var r$Q=new r$U;return r$Q._type=0,r$Q._constant=r$S,r$Q},r$U.createByGradient=function(r$S,r$Q,r$e){var r$l=new r$U;return r$l._type=1,r$l._gradientX=r$S,r$l._gradientY=r$Q,r$l._gradientZ=r$e,r$l},r$U.createByRandomTwoConstant=function(r$S,r$Q){var r$e=new r$U;return r$e._type=2,r$e._constantMin=r$S,r$e._constantMax=r$Q,r$e},r$U.createByRandomTwoGradient=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=new r$U;return r$T._type=3,r$T._gradientXMin=r$S,r$T._gradientXMax=r$Q,r$T._gradientYMin=r$e,r$T._gradientYMax=r$l,r$T._gradientZMin=r$M,r$T._gradientZMax=r$d,r$T},r$U}(),r$f=(function(){function r$S(r$S){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=r$S}r$J(r$S,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q.cloneTo=function(r$S){var r$Q=r$S;this._angularVelocity.cloneTo(r$Q._angularVelocity),r$Q.enbale=this.enbale},r$Q.clone=function(){var r$S;switch(this._angularVelocity.type){case 0:r$S=this._angularVelocity.separateAxes?r$$.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):r$$.createByConstant(this._angularVelocity.constant);break;case 1:r$S=this._angularVelocity.separateAxes?r$$.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):r$$.createByGradient(this._angularVelocity.gradient.clone());break;case 2:r$S=this._angularVelocity.separateAxes?r$$.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):r$$.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:r$S=this._angularVelocity.separateAxes?r$$.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):r$$.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var r$Q=new this.constructor(r$S);return r$Q.enbale=this.enbale,r$Q},r$L(0,r$Q,"angularVelocity",function(){return this._angularVelocity})}(),function(){function r$S(){this.enable=!1,this.randomDirection=!1}r$J(r$S,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q._getShapeBoundBox=function(r$S){throw new Error("BaseShape: must override it.")},r$Q._getSpeedBoundBox=function(r$S){throw new Error("BaseShape: must override it.")},r$Q.generatePositionAndDirection=function(r$S,r$Q,r$e,r$l){throw new Error("BaseShape: must override it.")},r$Q._calculateProceduralBounds=function(r$S,r$Q,r$e){this._getShapeBoundBox(r$S);var r$l=r$S.min,r$M=r$S.max;r$TQ.multiply(r$l,r$Q,r$l),r$TQ.multiply(r$M,r$Q,r$M);var r$d=new r$KS(new r$TQ,new r$TQ);this.randomDirection?(r$d.min=new r$TQ(-1,-1,-1),r$d.max=new r$TQ(1,1,1)):this._getSpeedBoundBox(r$d);var r$T=new r$KS(new r$TQ,new r$TQ),r$U=r$T.min,r$i=r$T.max;r$TQ.scale(r$d.min,r$e.y,r$U),r$TQ.scale(r$d.max,r$e.y,r$i),r$TQ.add(r$S.min,r$U,r$U),r$TQ.add(r$S.max,r$i,r$i),r$TQ.min(r$S.min,r$U,r$S.min),r$TQ.max(r$S.max,r$U,r$S.max);var r$R=new r$KS(new r$TQ,new r$TQ),r$o=r$R.min,r$Y=r$R.max;r$TQ.scale(r$d.min,r$e.x,r$o),r$TQ.scale(r$d.max,r$e.x,r$Y),r$TQ.min(r$R.min,r$Y,r$U),r$TQ.max(r$R.min,r$Y,r$i),r$TQ.min(r$S.min,r$U,r$S.min),r$TQ.max(r$S.max,r$U,r$S.max)},r$Q.cloneTo=function(r$S){r$S.enable=this.enable},r$Q.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$S}()),r$x=function(){function r$d(){}return r$J(r$d,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),r$d._randomPointUnitArcCircle=function(r$S,r$Q,r$e){var r$l=r$Q.elements,r$M=NaN;r$M=r$e?r$e.getFloat()*r$S:Math.random()*r$S,r$l[0]=Math.cos(r$M),r$l[1]=Math.sin(r$M)},r$d._randomPointInsideUnitArcCircle=function(r$S,r$Q,r$e){var r$l=r$Q.elements;r$d._randomPointUnitArcCircle(r$S,r$Q,r$e);var r$M=NaN;r$M=r$e?Math.pow(r$e.getFloat(),.5):Math.pow(Math.random(),.5),r$l[0]=r$l[0]*r$M,r$l[1]=r$l[1]*r$M},r$d._randomPointUnitCircle=function(r$S,r$Q){var r$e=r$S.elements,r$l=NaN;r$l=r$Q?r$Q.getFloat()*Math.PI*2:Math.random()*Math.PI*2,r$e[0]=Math.cos(r$l),r$e[1]=Math.sin(r$l)},r$d._randomPointInsideUnitCircle=function(r$S,r$Q){var r$e=r$S.elements;r$d._randomPointUnitCircle(r$S);var r$l=NaN;r$l=r$Q?Math.pow(r$Q.getFloat(),.5):Math.pow(Math.random(),.5),r$e[0]=r$e[0]*r$l,r$e[1]=r$e[1]*r$l},r$d._randomPointUnitSphere=function(r$S,r$Q){var r$e=r$S.elements,r$l=NaN,r$M=NaN;r$M=r$Q?(r$l=r$e[2]=2*r$Q.getFloat()-1,r$Q.getFloat()*Math.PI*2):(r$l=r$e[2]=2*Math.random()-1,Math.random()*Math.PI*2);var r$d=Math.sqrt(1-r$l*r$l);r$e[0]=r$d*Math.cos(r$M),r$e[1]=r$d*Math.sin(r$M)},r$d._randomPointInsideUnitSphere=function(r$S,r$Q){var r$e=r$S.elements;r$d._randomPointUnitSphere(r$S);var r$l=NaN;r$l=r$Q?Math.pow(r$Q.getFloat(),1/3):Math.pow(Math.random(),1/3),r$e[0]=r$e[0]*r$l,r$e[1]=r$e[1]*r$l,r$e[2]=r$e[2]*r$l},r$d._randomPointInsideHalfUnitBox=function(r$S,r$Q){var r$e=r$S.elements;r$Q?(r$e[0]=r$Q.getFloat()-.5,r$e[1]=r$Q.getFloat()-.5,r$e[2]=r$Q.getFloat()-.5):(r$e[0]=Math.random()-.5,r$e[1]=Math.random()-.5,r$e[2]=Math.random()-.5)},r$d}(),r$F=(function(){function r$S(r$S){this._size=null,this.enbale=!1,this._size=r$S}r$J(r$S,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q.cloneTo=function(r$S){var r$Q=r$S;this._size.cloneTo(r$Q._size),r$Q.enbale=this.enbale},r$Q.clone=function(){var r$S;switch(this._size.type){case 0:r$S=this._size.separateAxes?r$P.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):r$P.createByGradient(this._size.gradient.clone());break;case 1:r$S=this._size.separateAxes?r$P.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):r$P.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:r$S=this._size.separateAxes?r$P.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):r$P.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var r$Q=new this.constructor(r$S);return r$Q.enbale=this.enbale,r$Q},r$L(0,r$Q,"size",function(){return this._size})}(),function(){function r$l(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}r$J(r$l,"laya.d3.core.particleShuriKen.module.StartFrame");var r$S=r$l.prototype;return r$D.imps(r$S,{"laya.d3.core.IClone":!0}),r$S.cloneTo=function(r$S){var r$Q=r$S;r$Q._type=this._type,r$Q._constant=this._constant,r$Q._constantMin=this._constantMin,r$Q._constantMax=this._constantMax},r$S.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$S,"constant",function(){return this._constant}),r$L(0,r$S,"type",function(){return this._type}),r$L(0,r$S,"constantMin",function(){return this._constantMin}),r$L(0,r$S,"constantMax",function(){return this._constantMax}),r$l.createByConstant=function(r$S){var r$Q=new r$l;return r$Q._type=0,r$Q._constant=r$S,r$Q},r$l.createByRandomTwoConstant=function(r$S,r$Q){var r$e=new r$l;return r$e._type=1,r$e._constantMin=r$S,r$e._constantMax=r$Q,r$e},r$l}()),r$q=(function(){function r$S(r$S,r$Q){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new r$dQ(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=r$S,this._startFrame=r$Q}r$J(r$S,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q.cloneTo=function(r$S){var r$Q=r$S;this.tiles.cloneTo(r$Q.tiles),r$Q.type=this.type,r$Q.randomRow=this.randomRow,this._frame.cloneTo(r$Q._frame),this._startFrame.cloneTo(r$Q._startFrame),r$Q.cycles=this.cycles,r$Q.enableUVChannels=this.enableUVChannels,r$Q.enable=this.enable},r$Q.clone=function(){var r$S,r$Q;switch(this._frame.type){case 0:r$S=r$m.createByConstant(this._frame.constant);break;case 1:r$S=r$m.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:r$S=r$m.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:r$S=r$m.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:r$Q=r$F.createByConstant(this._startFrame.constant);break;case 1:r$Q=r$F.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var r$e=new this.constructor(r$S,r$Q);return this.tiles.cloneTo(r$e.tiles),r$e.type=this.type,r$e.randomRow=this.randomRow,r$e.cycles=this.cycles,r$e.enableUVChannels=this.enableUVChannels,r$e.enable=this.enable,r$e},r$L(0,r$Q,"frame",function(){return this._frame}),r$L(0,r$Q,"startFrame",function(){return this._startFrame})}(),function(){function r$S(r$S){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=r$S}r$J(r$S,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q.cloneTo=function(r$S){var r$Q=r$S;this._velocity.cloneTo(r$Q._velocity),r$Q.enbale=this.enbale,r$Q.space=this.space},r$Q.clone=function(){var r$S;switch(this._velocity.type){case 0:r$S=r$a.createByConstant(this._velocity.constant.clone());break;case 1:r$S=r$a.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:r$S=r$a.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:r$S=r$a.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var r$Q=new this.constructor(r$S);return r$Q.enbale=this.enbale,r$Q.space=this.space,r$Q},r$L(0,r$Q,"velocity",function(){return this._velocity})}(),function(){function r$S(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new r$pQ,this._vb=r$fQ.create(r$S._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=r$aQ.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=r$nQ.nameKey.getID("LINE"),this._shaderCompile=r$HQ._preCompileShader[this._sharderNameID]}r$J(r$S,"laya.d3.core.PhasorSpriter3D");var r$Q=r$S.prototype;return r$Q.line=function(r$S,r$Q,r$e,r$l){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(r$S.x,r$S.y,r$S.z,r$Q.x,r$Q.y,r$Q.z,r$Q.w),this.addVertex(r$e.x,r$e.y,r$e.z,r$l.x,r$l.y,r$l.z,r$l.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},r$Q.circle=function(r$S,r$Q,r$e,r$l,r$M,r$d){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*r$Q,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/r$Q,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*r$S,Math.cos(this._tempNumver0)*r$S,0,r$e,r$l,r$M,r$d),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},r$Q.plane=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=r$l/2,this._tempNumver1=r$M/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(r$S-this._tempNumver0,r$Q+this._tempNumver1,r$e,r$d,r$T,r$U,r$i),this.addVertex(r$S+this._tempNumver0,r$Q+this._tempNumver1,r$e,r$d,r$T,r$U,r$i),this.addVertex(r$S-this._tempNumver0,r$Q-this._tempNumver1,r$e,r$d,r$T,r$U,r$i),this.addVertex(r$S+this._tempNumver0,r$Q-this._tempNumver1,r$e,r$d,r$T,r$U,r$i),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},r$Q.box=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=r$l/2,this._tempNumver1=r$M/2,this._tempNumver2=r$d/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(r$S-this._tempNumver0,r$Q+this._tempNumver1,r$e+this._tempNumver2,r$T,r$U,r$i,r$R),this.addVertex(r$S+this._tempNumver0,r$Q+this._tempNumver1,r$e+this._tempNumver2,r$T,r$U,r$i,r$R),this.addVertex(r$S-this._tempNumver0,r$Q-this._tempNumver1,r$e+this._tempNumver2,r$T,r$U,r$i,r$R),this.addVertex(r$S+this._tempNumver0,r$Q-this._tempNumver1,r$e+this._tempNumver2,r$T,r$U,r$i,r$R),this.addVertex(r$S+this._tempNumver0,r$Q+this._tempNumver1,r$e-this._tempNumver2,r$T,r$U,r$i,r$R),this.addVertex(r$S-this._tempNumver0,r$Q+this._tempNumver1,r$e-this._tempNumver2,r$T,r$U,r$i,r$R),this.addVertex(r$S+this._tempNumver0,r$Q-this._tempNumver1,r$e-this._tempNumver2,r$T,r$U,r$i,r$R),this.addVertex(r$S-this._tempNumver0,r$Q-this._tempNumver1,r$e-this._tempNumver2,r$T,r$U,r$i,r$R),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},r$Q.cone=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*r$e+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*r$e>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/r$e,this.addVertexIndex(0,r$Q,0,r$l,r$M,r$d,r$T,this._tempUint0),this.addVertexIndex(0,0,0,r$l,r$M,r$d,r$T,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<r$e;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(r$S*this._tempNumver2,0,r$S*this._tempNumver3,r$l,r$M,r$d,r$T,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==r$e-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(r$S*this._tempNumver2,0,r$S*this._tempNumver3,r$l,r$M,r$d,r$T,this._tempUint0+(this._tempInt0+r$e)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==r$e-1?this.addIndexes(this._tempUint1+r$e+2):this.addIndexes(this._tempUint1+this._tempInt0+r$e+1),this.addIndexes(this._tempUint1+this._tempInt0+r$e),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},r$Q.boundingBoxLine=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(r$S,r$M,r$d,r$T,r$U,r$i,r$R),this.addVertex(r$l,r$M,r$d,r$T,r$U,r$i,r$R),this.addVertex(r$S,r$Q,r$d,r$T,r$U,r$i,r$R),this.addVertex(r$l,r$Q,r$d,r$T,r$U,r$i,r$R),this.addVertex(r$l,r$M,r$e,r$T,r$U,r$i,r$R),this.addVertex(r$S,r$M,r$e,r$T,r$U,r$i,r$R),this.addVertex(r$l,r$Q,r$e,r$T,r$U,r$i,r$R),this.addVertex(r$S,r$Q,r$e,r$T,r$U,r$i,r$R),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},r$Q.addVertex=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=r$S,this._vbData[this._posInVBData+1]=r$Q,this._vbData[this._posInVBData+2]=r$e,this._vbData[this._posInVBData+3]=r$l,this._vbData[this._posInVBData+4]=r$M,this._vbData[this._posInVBData+5]=r$d,this._vbData[this._posInVBData+6]=r$T,this._posInVBData+=this._floatSizePerVer,this},r$Q.addVertexIndex=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){return this._hasBegun||this.addVertexIndexException(),this._vbData[r$U]=r$S,this._vbData[r$U+1]=r$Q,this._vbData[r$U+2]=r$e,this._vbData[r$U+3]=r$l,this._vbData[r$U+4]=r$M,this._vbData[r$U+5]=r$d,this._vbData[r$U+6]=r$T,(r$U+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=r$U),this},r$Q.addIndexes=function(r$S){var r$Q=arguments;this._hasBegun||this.addVertexIndexException();for(var r$e=0;r$e<r$Q.length;r$e++)this._ibData[this._posInIBData]=r$Q[r$e],this._posInIBData++;return this},r$Q.begin=function(r$S,r$Q){return this._hasBegun&&this.beginException0(),1!==r$S&&4!==r$S&&this.beginException1(),this._primitiveType=r$S,this._camera=r$Q,this._hasBegun=!0,this},r$Q.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},r$Q.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(r$S._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),r$H.drawCall++,r$k.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},r$Q.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},r$Q.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},r$Q.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},r$Q.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},r$Q.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},r$Q.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(28,[new r$TS(0,"vector3",0),new r$TS(12,"vector4",1)])}]),r$S}()),r$Z=function(){function r$S(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++r$S._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new r$pQ}r$J(r$S,"laya.d3.core.render.RenderElement");var r$Q=r$S.prototype;return r$Q.getDynamicBatchBakedVertexs=function(r$S){for(var r$Q=this._renderObj._getVertexBuffer(r$S),r$e=r$Q.getData().slice(),r$l=r$Q.vertexDeclaration,r$M=r$l.getVertexElementByUsage(0).offset/4,r$d=r$l.getVertexElementByUsage(3).offset/4,r$T=this._sprite3D.transform,r$U=r$T.worldMatrix,r$i=r$T.rotation,r$R=r$l.vertexStride/4,r$o=0,r$Y=r$e.length;r$o<r$Y;r$o+=r$R){var r$p=r$o+r$M,r$J=r$o+r$d;r$cQ.transformVector3ArrayToVector3ArrayCoordinate(r$e,r$p,r$U,r$e,r$p),r$cQ.transformVector3ArrayByQuat(r$e,r$J,r$i,r$e,r$J)}return r$e},r$Q.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},r$Q._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},r$L(0,r$Q,"id",function(){return this._id}),r$L(0,r$Q,"renderObj",function(){return this._renderObj},function(r$S){this._renderObj!==r$S&&(this._renderObj=r$S)}),r$S._uniqueIDCounter=0,r$S}(),r$N=function(){function r$Q(r$S){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++r$Q._uniqueIDCounter,this._needSort=!1,this._scene=r$S,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}r$J(r$Q,"laya.d3.core.render.RenderQueue");var r$S=r$Q.prototype;return r$S._sortOpaqueFunc=function(r$S,r$Q){if(r$S._render&&r$Q._render){var r$e=r$S._material.renderQueue-r$Q._material.renderQueue;return 0==r$e?r$S._render._distanceForSort-r$Q._render._distanceForSort:r$e}return 0},r$S._sortAlphaFunc=function(r$S,r$Q){if(r$S._render&&r$Q._render){var r$e=r$S._material.renderQueue-r$Q._material.renderQueue;return 0==r$e?r$Q._render._distanceForSort-r$S._render._distanceForSort:r$e}return 0},r$S._begainRenderElement=function(r$S,r$Q,r$e){return!!r$Q._beforeRender(r$S)},r$S._sortAlpha=function(r$S){r$Q._cameraPosition=r$S,this._finalElements.sort(this._sortAlphaFunc)},r$S._sortOpaque=function(r$S){r$Q._cameraPosition=r$S,this._finalElements.sort(this._sortOpaqueFunc)},r$S._preRender=function(r$S){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},r$S._render=function(r$S,r$Q){for(var r$e,r$l,r$M,r$d,r$T,r$U,r$i=r$H.loopCount,r$R=this._scene,r$o=r$S.camera,r$Y=(r$o.id,!1),r$p=0,r$J=this._finalElements.length;r$p<r$J;r$p++){var r$L,r$j,r$c,r$G=this._finalElements[r$p];if(null!=r$G._onPreRenderFunction&&r$G._onPreRenderFunction.call(r$G._sprite3D,r$S),0===r$G._type){if(r$S.owner=r$c=r$G._sprite3D,r$S.renderElement=r$G,r$c._preRenderUpdateComponents(r$S),r$L=r$G.renderObj,r$j=r$G._material,this._begainRenderElement(r$S,r$L,r$j)){if(r$e=r$L._getVertexBuffers(),!(r$M=(r$l=r$L._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[r$l.id]){this._errorRecord[r$l.id]=1;var r$z="vertexBuffer:"+("("+r$l._destroyed+","+r$l._released+","+r$l._referenceCount+","+r$l._buffer+")")+", material:"+(r$j?r$j.__className+"("+r$j._destroyed+","+r$j._released+")":"null")+", owner:"+(r$c?r$c.__className+"("+r$c._destroyed+","+r$c._activeInHierarchy+","+r$c._displayedInStage+")":"null")+", renderObj:"+(r$L?r$L.__className+"("+r$L._destroyed+","+r$L._released+","+r$L._referenceCount+")":"")+", parent:, url:"+(r$c?r$c.url:"")+", disposeStack:"+r$l.disposeStack;r$D.recordError("报错：unknown vertexDeclaration  "+r$z)}continue}if(r$Y=(r$d=r$S._shader=r$j._getShader(r$R._shaderDefineValue,r$M.shaderDefineValue,r$c._shaderDefineValue)).bind()||r$i!==r$d._uploadLoopCount,r$e){if(r$d._uploadVertexBuffer!==r$e||r$Y){for(var r$A=0;r$A<r$e.length;r$A++){var r$v=r$e[r$A];r$d.uploadAttributesX(r$v.vertexDeclaration.shaderValues.data,r$v)}r$d._uploadVertexBuffer=r$e}}else(r$d._uploadVertexBuffer!==r$l||r$Y)&&(r$d.uploadAttributes(r$M.shaderValues.data,null),r$d._uploadVertexBuffer=r$l);(r$d._uploadScene!==r$R||r$Y)&&(r$d.uploadSceneUniforms(r$R._shaderValues.data),r$d._uploadScene=r$R),(r$o!==r$d._uploadCamera||r$d._uploadSprite3D!==r$c||r$Y)&&(r$d.uploadSpriteUniforms(r$c._shaderValues.data),r$d._uploadSprite3D=r$c),(r$o!==r$d._uploadCamera||r$Y)&&(r$d.uploadCameraUniforms(r$o._shaderValues.data),r$d._uploadCamera=r$o),(r$d._uploadMaterial!==r$j||r$Y)&&(r$j._upload(),r$d._uploadMaterial=r$j),r$T!==r$j?(r$j._setRenderStateBlendDepth(),r$j._setRenderStateFrontFace(r$Q,r$c.transform),r$T=r$j,r$U=r$c):r$U!==r$c&&(r$j._setRenderStateFrontFace(r$Q,r$c.transform),r$U=r$c),r$L._render(r$S),r$d._uploadLoopCount=r$i}r$c._postRenderUpdateComponents(r$S)}else if(2===r$G._type){r$G.renderObj;r$S.owner=r$c=r$G._sprite3D,r$S.renderElement=r$G,r$S._batchIndexStart=r$G._tempBatchIndexStart,r$S._batchIndexEnd=r$G._tempBatchIndexEnd,r$L=r$G.renderObj,r$j=r$G._material,this._begainRenderElement(r$S,r$L,r$j)&&(r$M=(r$l=r$L._getVertexBuffer(0)).vertexDeclaration,r$Y=(r$d=r$S._shader=r$j._getShader(r$R._shaderDefineValue,r$M.shaderDefineValue,r$c._shaderDefineValue)).bind()||r$i!==r$d._uploadLoopCount,(r$d._uploadVertexBuffer!==r$l||r$Y)&&(r$d.uploadAttributes(r$M.shaderValues.data,null),r$d._uploadVertexBuffer=r$l),(r$d._uploadScene!==r$R||r$Y)&&(r$d.uploadSceneUniforms(r$R._shaderValues.data),r$d._uploadScene=r$R),(r$o!==r$d._uploadCamera||r$d._uploadSprite3D!==r$c||r$Y)&&(r$d.uploadSpriteUniforms(r$c._shaderValues.data),r$d._uploadSprite3D=r$c),(r$o!==r$d._uploadCamera||r$Y)&&(r$d.uploadCameraUniforms(r$o._shaderValues.data),r$d._uploadCamera=r$o),(r$d._uploadMaterial!==r$j||r$Y)&&(r$j._upload(),r$d._uploadMaterial=r$j),r$T!==r$j?(r$j._setRenderStateBlendDepth(),r$j._setRenderStateFrontFace(r$Q,r$c.transform),r$T=r$j,r$U=r$c):r$U!==r$c&&(r$j._setRenderStateFrontFace(r$Q,r$c.transform),r$U=r$c),r$L._render(r$S),r$d._uploadLoopCount=r$i)}}},r$S._renderShadow=function(r$S,r$Q){for(var r$e,r$l,r$M,r$d,r$T,r$U=r$H.loopCount,r$i=this._scene,r$R=r$S.camera,r$o=!1,r$Y=0,r$p=this._finalElements.length;r$Y<r$p;r$Y++){var r$J,r$L,r$j,r$c=this._finalElements[r$Y];0===r$c._type&&(r$S.owner=r$j=r$c._sprite3D,r$Q||r$j._projectionViewWorldUpdateCamera===r$R&&r$j._projectionViewWorldUpdateLoopCount===r$H.loopCount||(r$j._render._renderUpdate(r$S._projectionViewMatrix),r$j._projectionViewWorldUpdateLoopCount=r$H.loopCount,r$j._projectionViewWorldUpdateCamera=r$R),r$S.renderElement=r$c,r$j._preRenderUpdateComponents(r$S),r$J=r$c.renderObj,r$L=r$c._material,this._begainRenderElement(r$S,r$J,null)&&(r$l=(r$e=r$J._getVertexBuffer(0)).vertexDeclaration,r$o=(r$M=r$S._shader=r$L._getShader(r$i._shaderDefineValue,r$l.shaderDefineValue,r$j._shaderDefineValue)).bind()||r$U!==r$M._uploadLoopCount,(r$M._uploadVertexBuffer!==r$e||r$o)&&(r$M.uploadAttributes(r$l.shaderValues.data,null),r$M._uploadVertexBuffer=r$e),(r$R!==r$M._uploadCamera||r$M._uploadSprite3D!==r$j||r$o)&&(r$M.uploadSpriteUniforms(r$j._shaderValues.data),r$M._uploadSprite3D=r$j),(r$R!==r$M._uploadCamera||r$o)&&(r$M.uploadCameraUniforms(r$R._shaderValues.data),r$M._uploadCamera=r$R),(r$M._uploadMaterial!==r$L||r$o)&&(r$L._upload(),r$M._uploadMaterial=r$L),r$M._uploadRenderElement,r$d!==r$L?(r$L._setRenderStateFrontFace(!1,r$j.transform),r$d=r$L,r$T=r$j):r$T!==r$j&&(r$L._setRenderStateFrontFace(!1,r$j.transform),r$T=r$j),r$J._render(r$S),r$M._uploadLoopCount=r$U),r$j._postRenderUpdateComponents(r$S))}},r$S._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},r$S._addRenderElement=function(r$S){this._renderElements.push(r$S),this._needSort=!0},r$S._addDynamicBatchElement=function(r$S){this._dynamicBatchCombineRenderElements.push(r$S)},r$L(0,r$S,"id",function(){return this._id}),r$Q._uniqueIDCounter=0,r$Q._cameraPosition=null,r$Q}(),r$C=function(){function r$S(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return r$J(r$S,"laya.d3.core.render.RenderState"),r$S.clientWidth=0,r$S.clientHeight=0,r$S}(),r$K=function(){function r$T(r$S,r$Q){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new r$_S(new r$TQ,0),this._corners=[new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ],this._boundingBoxCenter=new r$TQ,this._children=r$l(8),this._objects=[],this._tempBoundBoxCorners=[new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ],this._scene=r$S,this._currentDepth=r$Q}r$J(r$T,"laya.d3.core.scene.OctreeNode");var r$S=r$T.prototype;return r$D.imps(r$S,{"laya.d3.core.scene.ITreeNode":!0}),r$S.init=function(r$S,r$Q){var r$e=new r$TQ,r$l=new r$TQ;r$TQ.scale(r$Q,-.5,r$e),r$TQ.scale(r$Q,.5,r$l),r$TQ.add(r$e,r$S,r$e),r$TQ.add(r$l,r$S,r$l),this.exactBox=new r$KS(r$e,r$l),this.relaxBox=new r$KS(r$e,r$l)},r$S.addTreeNode=function(r$S){1===Collision.boxContainsBox(this._relaxBox,r$S.boundingBox)?this.addNodeDown(r$S,0):this.addObject(r$S)},r$S.addChild=function(r$S){var r$Q=this._children[r$S];if(null==r$Q){r$Q=new r$T(this._scene,this._currentDepth+1),(this._children[r$S]=r$Q)._parent=this,r$TQ.subtract(this._exactBox.max,this._exactBox.min,r$T.tempSize),r$TQ.multiply(r$T.tempSize,r$T._octreeSplit[r$S],r$T.tempCenter),r$TQ.add(this._exactBox.min,r$T.tempCenter,r$T.tempCenter),r$TQ.scale(r$T.tempSize,.25,r$T.tempSize);var r$e=new r$TQ,r$l=new r$TQ;r$TQ.subtract(r$T.tempCenter,r$T.tempSize,r$e),r$TQ.add(r$T.tempCenter,r$T.tempSize,r$l),r$Q.exactBox=new r$KS(r$e,r$l),r$TQ.scale(r$T.tempSize,r$T.relax,r$T.tempSize);var r$M=new r$TQ,r$d=new r$TQ;r$TQ.subtract(r$T.tempCenter,r$T.tempSize,r$M),r$TQ.add(r$T.tempCenter,r$T.tempSize,r$d),r$Q.relaxBox=new r$KS(r$M,r$d)}return r$Q},r$S.addObject=function(r$S){(r$S._treeNode=this)._objects.push(r$S)},r$S.removeObject=function(r$S){if(r$S._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var r$Q=this._objects.indexOf(r$S);return-1!==r$Q&&(this._objects.splice(r$Q,1),!0)},r$S.clearObject=function(){this._objects.length=0},r$S.addNodeUp=function(r$S,r$Q){this._parent&&1!==Collision.boxContainsBox(this._exactBox,r$S.boundingBox)?this._parent.addNodeUp(r$S,r$Q-1):this.addNodeDown(r$S,r$Q)},r$S.addNodeDown=function(r$S,r$Q){if(r$Q<this._scene.treeLevel){var r$e=this.inChildIndex(r$S.boundingBoxCenter),r$l=this.addChild(r$e);1===Collision.boxContainsBox(r$l._relaxBox,r$S.boundingBox)?r$l.addNodeDown(r$S,++r$Q):this.addObject(r$S)}else this.addObject(r$S)},r$S.inChildIndex=function(r$S){return 4*(r$S.z<this._boundingBoxCenter.z?0:1)+2*(r$S.y<this._boundingBoxCenter.y?0:1)+(r$S.x<this._boundingBoxCenter.x?0:1)},r$S.updateObject=function(r$S){1===Collision.boxContainsBox(this._relaxBox,r$S.boundingBox)?(this.removeObject(r$S),r$S._treeNode=null,this.addNodeDown(r$S,this._currentDepth)):this._parent&&(this.removeObject(r$S),r$S._treeNode=null,this._parent.addNodeUp(r$S,this._currentDepth-1))},r$S.cullingObjects=function(r$S,r$Q,r$e,r$l,r$M){var r$d,r$T=0,r$U=0,r$i=0,r$R=this._scene._dynamicBatchManager;for(r$T=0,r$d=this._objects.length;r$T<r$d;r$T++){var r$o=this._objects[r$T];if(r$b.isVisible(r$o._owner.layer.mask)&&r$o.enable){if(r$Q&&(r$H.treeSpriteCollision+=1,0===r$S.containsBoundSphere(r$o.boundingSphere)))continue;r$o._renderUpdate(r$M),r$o._distanceForSort=r$TQ.distance(r$o.boundingSphere.center,r$l)+r$o.sortingFudge;var r$Y=r$o._renderElements;for(r$U=0,r$i=r$Y.length;r$U<r$i;r$U++){var r$p=r$Y[r$U],r$J=r$p._staticBatch;if(r$J&&r$J._material===r$p._material)r$J._addBatchRenderElement(r$p);else{var r$L=r$p.renderObj;r$L.triangleCount<10&&1===r$L._vertexBufferCount&&r$L._getIndexBuffer()&&r$p._material.renderQueue<2&&r$p._canDynamicBatch&&!r$o._owner.isStatic?r$R._addPrepareRenderElement(r$p):this._scene.getRenderQueue(r$p._material.renderQueue)._addRenderElement(r$p)}}}}for(r$T=0;r$T<8;r$T++){var r$j=this._children[r$T];if(null!=r$j){var r$c=r$Q;if(r$Q){var r$G=r$S.containsBoundBox(r$j._relaxBox);if(r$H.treeNodeCollision+=1,0===r$G)continue;r$c=2===r$G}r$j.cullingObjects(r$S,r$c,r$e,r$l,r$M)}}},r$S.cullingShadowObjects=function(r$S,r$Q,r$e,r$l,r$M){var r$d,r$T=0,r$U=0,r$i=0;this._scene._dynamicBatchManager;for(r$T=0,r$d=this._objects.length;r$T<r$d;r$T++){var r$R=this._objects[r$T];if(r$R.castShadow&&r$b.isVisible(r$R._owner.layer.mask)&&r$R.enable){if(r$e&&0===r$S[0].containsBoundSphere(r$R.boundingSphere))continue;for(var r$o=1,r$Y=r$S.length;r$o<r$Y;r$o++){var r$p=r$Q[r$o-1];if(0!==r$S[r$o].containsBoundSphere(r$R.boundingSphere)){var r$J=r$R._renderElements;for(r$U=0,r$i=r$J.length;r$U<r$i;r$U++)r$p._addRenderElement(r$J[r$U])}}}}for(r$T=0;r$T<8;r$T++){var r$L=this._children[r$T];if(null!=r$L){var r$j=r$e;if(r$e){var r$c=r$S[0].containsBoundBox(r$L._relaxBox);if(0===r$c)continue;r$j=2===r$c}r$L.cullingShadowObjects(r$S,r$Q,r$j,r$l,r$M)}}},r$S.cullingShadowObjectsOnePSSM=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T,r$U=r$Q[0],r$i=0,r$R=0,r$o=0;for(r$i=0,r$T=this._objects.length;r$i<r$T;r$i++){var r$Y=this._objects[r$i];if(r$Y.castShadow&&r$b.isVisible(r$Y._owner.layer.mask)&&r$Y.enable){if(r$l&&0===r$S.containsBoundSphere(r$Y.boundingSphere))continue;r$Y._renderUpdate(r$e);var r$p=r$Y._renderElements;for(r$R=0,r$o=r$p.length;r$R<r$o;r$R++)r$U._addRenderElement(r$p[r$R])}}for(r$i=0;r$i<8;r$i++){var r$J=this._children[r$i];if(null!=r$J){var r$L=r$l;if(r$l){var r$j=r$S.containsBoundBox(r$J._relaxBox);if(0===r$j)continue;r$L=2===r$j}r$J.cullingShadowObjectsOnePSSM(r$S,r$Q,r$e,r$L,r$M,r$d)}}},r$S.renderBoudingBox=function(r$S){this._renderBoudingBox(r$S);for(var r$Q=0;r$Q<8;++r$Q){var r$e=this._children[r$Q];r$e&&r$e.renderBoudingBox(r$S)}},r$S.buildAllChild=function(r$S){if(r$S<this._scene.treeLevel)for(var r$Q=0;r$Q<8;r$Q++){this.addChild(r$Q).buildAllChild(r$S+1)}},r$S._renderBoudingBox=function(r$S){},r$L(0,r$S,"exactBox",function(){return this._exactBox},function(r$S){this._exactBox=r$S,r$TQ.add(r$S.min,r$S.max,this._boundingBoxCenter),r$TQ.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),r$L(0,r$S,"relaxBox",function(){return this._relaxBox},function(r$S){(this._relaxBox=r$S).getCorners(this._corners),r$_S.createfromPoints(this._corners,this._boundingSphere)}),r$T.debugMode=!1,r$T.relax=1.15,r$T.CHILDNUM=8,r$Y(r$T,["tempVector0",function(){return this.tempVector0=new r$TQ},"tempSize",function(){return this.tempSize=new r$TQ},"tempCenter",function(){return this.tempCenter=new r$TQ},"_octreeSplit",function(){return this._octreeSplit=[new r$TQ(.25,.25,.25),new r$TQ(.75,.25,.25),new r$TQ(.25,.75,.25),new r$TQ(.75,.75,.25),new r$TQ(.25,.25,.75),new r$TQ(.75,.25,.75),new r$TQ(.25,.75,.75),new r$TQ(.75,.75,.75)]}]),r$T}(),r$V=(function(){function r$S(){}r$J(r$S,"laya.d3.core.scene.SceneManager")}(),function(){function r$S(r$S,r$Q,r$e,r$l){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===r$S&&(r$S=1),void 0===r$Q&&(r$Q=1),void 0===r$e&&(r$e=1),void 0===r$l&&(r$l=1),this._r=r$S,this._g=r$Q,this._b=r$e,this._a=r$l}return r$J(r$S,"laya.d3.core.trail.module.Color",null,"Color$1"),r$S.prototype.cloneTo=function(r$S){r$S._r=this._r,r$S._g=this._g,r$S._b=this._b,r$S._a=this._a},r$Y(r$S,["RED",function(){return this.RED=new r$S(1,0,0,1)},"GREEN",function(){return this.GREEN=new r$S(0,1,0,1)},"BLUE",function(){return this.BLUE=new r$S(0,0,1,1)},"CYAN",function(){return this.CYAN=new r$S(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new r$S(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new r$S(1,0,1,1)},"GRAY",function(){return this.GRAY=new r$S(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new r$S(1,1,1,1)},"BLACK",function(){return this.BLACK=new r$S(0,0,0,1)}]),r$S}()),r$_=(function(){function r$S(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}r$J(r$S,"laya.d3.core.trail.module.Gradient");var r$Q=r$S.prototype;r$Q.setKeys=function(r$S,r$Q){var r$e,r$l;this._colorKeys=r$S;for(var r$M=this.index=0;r$M<r$S.length;r$M++){var r$d=(r$e=r$S[r$M]).color;this._colorKeyData[this.index++]=r$d._r,this._colorKeyData[this.index++]=r$d._g,this._colorKeyData[this.index++]=r$d._b,this._colorKeyData[this.index++]=r$e.time}this._alphaKeys=r$Q;for(var r$T=this.index=0;r$T<r$Q.length;r$T++)r$l=r$Q[r$T],this._alphaKeyData[this.index++]=r$l.alpha,this._alphaKeyData[this.index++]=r$l.time},r$Q.cloneTo=function(r$S){var r$Q=0,r$e=0,r$l=this.colorKeys,r$M=[];for(r$Q=0,r$e=r$l.length;r$Q<r$e;r$Q++){var r$d=new r$s;r$l[r$Q].cloneTo(r$d),r$M.push(r$d)}var r$T=this.alphaKeys,r$U=[];for(r$Q=0,r$e=r$T.length;r$Q<r$e;r$Q++){var r$i=new r$_;r$T[r$Q].cloneTo(r$i),r$U.push(r$i)}r$S.setKeys(r$M,r$U)},r$L(0,r$Q,"mode",function(){return this._mode},function(r$S){this._mode=r$S}),r$L(0,r$Q,"colorKeys",function(){return this._colorKeys},function(r$S){this._colorKeys=r$S;for(var r$Q=this.index=0;r$Q<r$S.length;r$Q++){var r$e=r$S[r$Q],r$l=r$e.color;this._colorKeyData[this.index++]=r$l._r,this._colorKeyData[this.index++]=r$l._g,this._colorKeyData[this.index++]=r$l._b,this._colorKeyData[this.index++]=r$e.time}}),r$L(0,r$Q,"alphaKeys",function(){return this._alphaKeys},function(r$S){this._alphaKeys=r$S;for(var r$Q=this.index=0;r$Q<r$S.length;r$Q++){var r$e=r$S[r$Q];this._alphaKeyData[this.index++]=r$e.alpha,this._alphaKeyData[this.index++]=r$e.time}})}(),function(){function r$S(r$S,r$Q){this._alpha=NaN,this._time=NaN,void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),this._alpha=r$S,this._time=r$Q}r$J(r$S,"laya.d3.core.trail.module.GradientAlphaKey");var r$Q=r$S.prototype;return r$Q.cloneTo=function(r$S){r$S.alpha=this.alpha,r$S.time=this.time},r$L(0,r$Q,"alpha",function(){return this._alpha},function(r$S){this._alpha=r$S}),r$L(0,r$Q,"time",function(){return this._time},function(r$S){this._time=r$S}),r$S}()),r$s=function(){function r$S(r$S,r$Q){this._color=null,this._time=NaN,void 0===r$Q&&(r$Q=0),this._color=r$S||new r$V,this._time=r$Q}r$J(r$S,"laya.d3.core.trail.module.GradientColorKey");var r$Q=r$S.prototype;return r$Q.cloneTo=function(r$S){this.color.cloneTo(r$S.color),r$S.time=this.time},r$L(0,r$Q,"color",function(){return this._color},function(r$S){this._color=r$S}),r$L(0,r$Q,"time",function(){return this._time},function(r$S){this._time=r$S}),r$S}(),r$y=(function(){function r$S(){}r$J(r$S,"laya.d3.core.trail.module.GradientMode"),r$S.Blend=0,r$S.Fixed=1}(),function(){function r$S(){}r$J(r$S,"laya.d3.core.trail.module.TextureMode"),r$S.Stretch=0,r$S.Tile=1}(),function(){function r$S(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}r$J(r$S,"laya.d3.core.trail.module.TrailKeyFrame"),r$S.prototype.cloneTo=function(r$S){r$S.time=this.time,r$S.inTangent=this.inTangent,r$S.outTangent=this.outTangent,r$S.value=this.value}}(),function(){function r$Q(r$S){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new r$TQ,this._curPosition=new r$TQ,this._delVector3=new r$TQ,this._lastFixedVertexPosition=new r$TQ,this._pointAtoBVector3=new r$TQ,this._pointA=new r$TQ,this._pointB=new r$TQ,this._owner=r$S,this._id=r$Q.renderElementCount++,0==this._id?r$S._owner.transform.position.cloneTo(this._lastPosition):r$S._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new r$fQ(r$y.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new r$fQ(r$y.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}r$J(r$Q,"laya.d3.core.trail.TrailRenderElement");var r$S=r$Q.prototype;r$D.imps(r$S,{"laya.d3.core.render.IRenderable":!0}),r$S._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},r$S._addTrailByFirstPosition=function(r$S,r$Q){r$TQ.subtract(r$Q,r$S,this._delVector3),r$TQ.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),r$TQ.normalize(this._pointAtoBVector3,this._pointAtoBVector3),r$TQ.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(r$S),r$S.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},r$S._addTrailByNextPosition=function(r$S){r$TQ.subtract(r$S,this._lastFixedVertexPosition,this._delVector3),r$TQ.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),r$TQ.normalize(this._pointAtoBVector3,this._pointAtoBVector3),r$TQ.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=r$TQ.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=r$sS.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(r$S),r$S.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(r$S),this._virtualVerticesCount=2)},r$S._updateVerticesByPosition=function(r$S){this._pointe=r$S.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},r$S._updateVertexBuffer2=function(){var r$S,r$Q=0,r$e=0,r$l=0;for(r$l=0,r$S=(this._verticesCount+this._virtualVerticesCount)/2;r$l<r$S;r$l++)r$e=0==this._owner.textureMode?(this._VerticesToTailLength[r$l]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[r$l],this._vertices2[r$Q++]=1-r$e,this._vertices2[r$Q++]=1-r$e;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},r$S._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},r$S._updateDisappear=function(){var r$S,r$Q=0;for(r$Q=this._curDisappearIndex,r$S=(this._verticesCount+this._virtualVerticesCount)/2;r$Q<r$S;r$Q++)this._owner._curtime-this._everyGroupVertexBirthTime[r$Q]>=this._owner.time+r$sS.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},r$S._beforeRender=function(r$S){return this._camera=r$S.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),r$TQ.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},r$S._render=function(r$S){this._isDead||(r$k.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),r$H.drawCall++,r$H.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},r$S._getVertexBuffer=function(r$S){return void 0===r$S&&(r$S=0),0===r$S?this._vertexBuffer1:1===r$S?this._vertexBuffer2:null},r$S._getVertexBuffers=function(){return this._vertexBuffers},r$S._getIndexBuffer=function(){return null},r$S.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},r$S._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},r$L(0,r$S,"_vertexBufferCount",function(){return this._vertexBuffers.length}),r$L(0,r$S,"triangleCount",function(){return 0}),r$Q.renderElementCount=0}(),function(){function r$S(){}r$J(r$S,"laya.d3.core.trail.VertexTrail");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration1}),r$L(1,r$S,"vertexDeclaration1",function(){return r$S._vertexDeclaration1}),r$L(1,r$S,"vertexDeclaration2",function(){return r$S._vertexDeclaration2}),r$Y(r$S,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new r$dS(32,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",41),new r$TS(24,"single",33),new r$TS(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new r$dS(4,[new r$TS(0,"single",38)])}]),r$S}()),r$SS=function(){function r$v(r$S){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=r$S}r$J(r$v,"laya.d3.graphics.DynamicBatch");var r$S=r$v.prototype;return r$D.imps(r$S,{"laya.d3.core.render.IRenderable":!0}),r$S._getVertexBuffer=function(r$S){return void 0===r$S&&(r$S=0),0===r$S?this._vertexBuffer:null},r$S._getIndexBuffer=function(){return this._indexBuffer},r$S._getCombineRenderElementFromPool=function(r$S,r$Q,r$e){var r$l=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return r$l||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=r$l=new r$Z,r$l._sprite3D=new r$NQ),r$l._sprite3D._render._renderUpdate(r$e),r$l},r$S._getRenderElement=function(r$S,r$Q,r$e){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*r$v.maxVertexCount),this._indexDatas=new Uint16Array(r$v.maxIndexCount),this._vertexBuffer=r$fQ.create(this._vertexDeclaration,r$v.maxVertexCount,35048),this._indexBuffer=r$aQ.create("ushort",r$v.maxIndexCount,35048));for(var r$l=this._merageElements.length=0,r$M=0,r$d=0,r$T=this._combineRenderElements.length;r$d<r$T;r$d++){var r$U=this._combineRenderElements[r$d],r$i=r$U.getDynamicBatchBakedVertexs(0),r$R=r$U.getBakedIndices(),r$o=r$U._sprite3D.transform._isFrontFaceInvert,r$Y=r$l/(this._vertexDeclaration.vertexStride/4),r$p=r$M,r$J=r$p+r$R.length;r$U._tempBatchIndexStart=r$p,r$U._tempBatchIndexEnd=r$J,this._indexDatas.set(r$R,r$M);var r$L=0;if(r$o)for(r$L=r$p;r$L<r$J;r$L+=3){this._indexDatas[r$L]=r$Y+this._indexDatas[r$L];var r$j=this._indexDatas[r$L+1],r$c=this._indexDatas[r$L+2];this._indexDatas[r$L+1]=r$Y+r$c,this._indexDatas[r$L+2]=r$Y+r$j}else for(r$L=r$p;r$L<r$J;r$L+=3)this._indexDatas[r$L]=r$Y+this._indexDatas[r$L],this._indexDatas[r$L+1]=r$Y+this._indexDatas[r$L+1],this._indexDatas[r$L+2]=r$Y+this._indexDatas[r$L+2];r$M+=r$R.length,this._vertexDatas.set(r$i,r$l),r$l+=r$i.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),r$d=this._combineRenderElementPoolIndex=0,r$T=this._materials.length;r$d<r$T;r$d++){var r$G=this._getCombineRenderElementFromPool(r$S,r$Q,r$e);r$G._type=2,r$G._staticBatch=null;var r$z=(r$G.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[r$d]]._tempBatchIndexStart,r$A=r$d+1===this._materialToRenderElementsOffsets.length?r$M:this._combineRenderElements[this._materialToRenderElementsOffsets[r$d+1]]._tempBatchIndexStart;r$G._tempBatchIndexStart=r$z,r$G._tempBatchIndexEnd=r$A,r$G._material=this._materials[r$d],this._merageElements.push(r$G)}},r$S._addCombineRenderObjTest=function(r$S){var r$Q=r$S.renderObj,r$e=this._currentCombineIndexCount+r$Q._getIndexBuffer().indexCount,r$l=this._currentCombineVertexCount+r$Q._getVertexBuffer().vertexCount;return!(r$v.maxVertexCount<r$l||r$v.maxIndexCount<r$e)},r$S._addCombineRenderObj=function(r$S){var r$Q=r$S.renderObj;this._combineRenderElements.push(r$S),this._currentCombineIndexCount=this._currentCombineIndexCount+r$Q._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+r$Q._getVertexBuffer().vertexCount},r$S._addCombineMaterial=function(r$S){this._materials.push(r$S)},r$S._addMaterialToRenderElementOffset=function(r$S){this._materialToRenderElementsOffsets.push(r$S)},r$S._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},r$S._addToRenderQueue=function(r$S,r$Q,r$e,r$l){this._getRenderElement(r$Q,r$e,r$l);for(var r$M=0,r$d=this._materials.length;r$M<r$d;r$M++)r$S.getRenderQueue(this._materials[r$M].renderQueue)._addDynamicBatchElement(this._merageElements[r$M])},r$S._beforeRender=function(r$S){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},r$S._render=function(r$S){var r$Q=r$S._batchIndexEnd-r$S._batchIndexStart;r$k.mainContext.drawElements(4,r$Q,5123,2*r$S._batchIndexStart),r$H.drawCall++,r$H.trianglesFaces+=r$Q/3},r$S._getVertexBuffers=function(){return null},r$L(0,r$S,"_vertexBufferCount",function(){return 1}),r$L(0,r$S,"triangleCount",function(){return this._indexBuffer.indexCount/3}),r$L(0,r$S,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),r$v.maxVertexCount=2e4,r$v.maxIndexCount=4e4,r$v.maxCombineTriangleCount=10,r$v}(),r$QS=function(){function r$v(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}r$J(r$v,"laya.d3.graphics.DynamicBatchManager");var r$S=r$v.prototype;return r$S.getDynamicBatch=function(r$S,r$Q){var r$e,r$l=r$S.id.toString()+r$Q;return this._dynamicBatches[r$l]?r$e=this._dynamicBatches[r$l]:this._dynamicBatches[r$l]=r$e=new r$SS(r$S),r$e},r$S._garbageCollection=function(){for(var r$S in this._dynamicBatches)0===this._dynamicBatches[r$S].combineRenderElementsCount&&delete this._dynamicBatches[r$S]},r$S._addPrepareRenderElement=function(r$S){this._prepareDynamicBatchCombineElements.push(r$S)},r$S._finishCombineDynamicBatch=function(r$S){var r$Q,r$e,r$l;this._prepareDynamicBatchCombineElements.sort(r$v._sortPrepareDynamicBatch);for(var r$M,r$d,r$T,r$U,r$i,r$R=-1,r$o=!0,r$Y=0,r$p=-1,r$J=0,r$L=this._prepareDynamicBatchCombineElements.length;r$J<r$L;r$J++){var r$j=(r$d=this._prepareDynamicBatchCombineElements[r$J]).renderObj._getVertexBuffer(0).vertexDeclaration,r$c=r$e!==r$j;r$c&&(r$Y=0,r$e=r$j);var r$G=r$Y!==r$R;if(r$G&&(r$R=r$Y),(r$c||r$G)&&(r$T=this.getDynamicBatch(r$j,r$Y),r$Q=null),r$o)if(r$T._addCombineRenderObjTest(r$d)){if(r$Q!==(r$M=r$d._material))r$U&&(r$S.getRenderQueue(r$i._material.renderQueue)._addRenderElement(r$i),r$i=r$U=null,r$p=-1),r$U=r$M,r$p=r$T.combineRenderElementsCount,r$i=r$d,r$Q=r$M;else if(r$U){var r$z=r$i.renderObj,r$A=r$d.renderObj;r$z._getVertexBuffer().vertexCount+r$A._getVertexBuffer().vertexCount>r$SS.maxVertexCount||r$z._getIndexBuffer().indexCount+r$A._getIndexBuffer().indexCount>r$SS.maxIndexCount?(r$S.getRenderQueue(r$i._material.renderQueue)._addRenderElement(r$i),r$U=r$M,r$p=r$T.combineRenderElementsCount,r$i=r$d):(r$T._addCombineMaterial(r$U),r$T._addMaterialToRenderElementOffset(r$p),r$T._addCombineRenderObj(r$i),r$i=r$U=null,r$p=-1,r$T._addCombineRenderObj(r$d))}else r$T._addCombineRenderObj(r$d);r$o=!0}else r$U&&(r$S.getRenderQueue(r$i._material.renderQueue)._addRenderElement(r$i),r$i=r$U=null,r$p=-1),r$Y++,r$o=!1;else r$l=this._prepareDynamicBatchCombineElements[r$J-1],r$T._addMaterialToRenderElementOffset(r$T.combineRenderElementsCount),r$Q=r$l._material,r$T._addCombineMaterial(r$Q),r$T._addCombineRenderObj(r$l),r$o=!0,r$Q!==(r$M=r$d._material)?(r$U=r$M,r$p=r$T.combineRenderElementsCount,r$i=r$d):r$T._addCombineRenderObj(r$d),r$Q=r$M}r$U&&(r$S.getRenderQueue(r$i._material.renderQueue)._addRenderElement(r$i),r$i=r$U=null,r$p=-1),this._prepareDynamicBatchCombineElements.length=0},r$S._clearRenderElements=function(){for(var r$S in this._dynamicBatches)this._dynamicBatches[r$S]._clearRenderElements()},r$S._addToRenderQueue=function(r$S,r$Q,r$e,r$l){for(var r$M in this._dynamicBatches){var r$d=this._dynamicBatches[r$M];0<r$d.combineRenderElementsCount&&r$d._addToRenderQueue(r$S,r$Q,r$e,r$l)}},r$S.dispose=function(){this._dynamicBatches=null},r$v._sortPrepareDynamicBatch=function(r$S,r$Q){return r$S._mainSortID-r$Q._mainSortID},r$v}(),r$eS=function(){function r$S(){}return r$J(r$S,"laya.d3.graphics.FrustumCulling"),r$S.renderShadowObjectCulling=function(r$S,r$Q,r$e,r$l,r$M){var r$d=0,r$T=0,r$U=0,r$i=0;for(r$d=0,r$U=r$e.length;r$d<r$U;r$d++){var r$R=r$e[r$d];r$R&&r$R._clearRenderElements()}var r$o,r$Y,r$p,r$J=r$S._cullingRenders;if(1<r$M){for(r$d=0,r$U=r$S._cullingRendersLength;r$d<r$U;r$d++)if((r$o=r$J[r$d]).castShadow&&r$b.isVisible(r$o._owner.layer.mask)&&r$o.enable)for(var r$L=1,r$j=r$Q.length;r$L<r$j;r$L++)if(r$Y=r$e[r$L-1],0!==r$Q[r$L].containsBoundSphere(r$o.boundingSphere))for(r$T=0,r$i=(r$p=r$o._renderElements).length;r$T<r$i;r$T++)r$Y._addRenderElement(r$p[r$T])}else for(r$d=0,r$U=r$S._cullingRendersLength;r$d<r$U;r$d++)if((r$o=r$J[r$d]).castShadow&&r$b.isVisible(r$o._owner.layer.mask)&&r$o.enable&&0!==r$Q[0].containsBoundSphere(r$o.boundingSphere))for(r$o._renderUpdate(r$l),r$Y=r$e[0],r$T=0,r$i=(r$p=r$o._renderElements).length;r$T<r$i;r$T++)r$Y._addRenderElement(r$p[r$T])},r$S.renderShadowObjectCullingOctree=function(r$S,r$Q,r$e,r$l,r$M){for(var r$d=0,r$T=r$e.length;r$d<r$T;r$d++){var r$U=r$e[r$d];r$U&&r$U._clearRenderElements()}1<r$M?r$S.treeRoot.cullingShadowObjects(r$Q,r$e,!0,0,r$S):r$S.treeRoot.cullingShadowObjectsOnePSSM(r$Q[0],r$e,r$l,!0,0,r$S)},r$S.renderObjectCulling=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=0,r$U=0,r$i=0,r$R=0,r$o=r$Q._quenes,r$Y=r$Q._dynamicBatchManager,r$p=r$Q._cullingRenders;for(r$T=0,r$U=r$o.length;r$T<r$U;r$T++){var r$J=r$o[r$T];r$J&&r$J._clearRenderElements()}var r$L=r$lS._staticBatchManagers;for(r$T=0,r$U=r$L.length;r$T<r$U;r$T++)r$L[r$T]._clearRenderElements();r$Y._clearRenderElements();var r$j=r$e.transform.position;for(r$T=0,r$U=r$Q._cullingRendersLength;r$T<r$U;r$T++){var r$c=r$p[r$T];if(r$b.isVisible(r$c._owner.layer.mask)&&r$c.enable&&0!==r$S.containsBoundSphere(r$c.boundingSphere)&&r$c._renderUpdate(r$d)){r$c._distanceForSort=r$TQ.distance(r$c.boundingSphere.center,r$j)+r$c.sortingFudge;var r$G=r$c._renderElements;for(r$i=0,r$R=r$G.length;r$i<r$R;r$i++){var r$z=r$G[r$i],r$A=r$z._staticBatch;if(r$A&&r$A._material===r$z._material)r$A._addBatchRenderElement(r$z);else{var r$v=r$z.renderObj;r$v.triangleCount<10&&1===r$v._vertexBufferCount&&r$v._getIndexBuffer()&&r$z._material.renderQueue<2&&r$z._canDynamicBatch&&!r$c._owner.isStatic?r$Y._addPrepareRenderElement(r$z):r$Q.getRenderQueue(r$z._material.renderQueue)._addRenderElement(r$z)}}}}for(r$T=0,r$U=r$L.length;r$T<r$U;r$T++)r$L[r$T]._addToRenderQueue(r$Q,r$l,r$M,r$d);r$Y._finishCombineDynamicBatch(r$Q),r$Y._addToRenderQueue(r$Q,r$l,r$M,r$d)},r$S.renderObjectCullingOctree=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=0,r$U=0,r$i=r$Q._quenes,r$R=r$Q._dynamicBatchManager;for(r$T=0,r$U=r$i.length;r$T<r$U;r$T++){var r$o=r$i[r$T];r$o&&r$o._clearRenderElements()}var r$Y=r$lS._staticBatchManagers;for(r$T=0,r$U=r$Y.length;r$T<r$U;r$T++)r$Y[r$T]._clearRenderElements();for(r$R._clearRenderElements(),r$Q._cullingRenders.length=0,r$Q.treeRoot.cullingObjects(r$S,!0,0,r$e.transform.position,r$d),r$T=0,r$U=r$Y.length;r$T<r$U;r$T++)r$Y[r$T]._addToRenderQueue(r$Q,r$l,r$M,r$d);r$R._finishCombineDynamicBatch(r$Q),r$R._addToRenderQueue(r$Q,r$l,r$M,r$d)},r$S.renderObjectCullingNoBoundFrustum=function(r$S,r$Q,r$e,r$l,r$M){var r$d=0,r$T=0,r$U=0,r$i=0,r$R=r$S._quenes,r$o=r$S._dynamicBatchManager,r$Y=r$S._cullingRenders;for(r$d=0,r$T=r$R.length;r$d<r$T;r$d++){var r$p=r$R[r$d];r$p&&r$p._clearRenderElements()}var r$J=r$lS._staticBatchManagers;for(r$d=0,r$T=r$J.length;r$d<r$T;r$d++)r$J[r$d]._clearRenderElements();r$o._clearRenderElements();var r$L=r$Q.transform.position;for(r$d=0,r$T=r$S._cullingRendersLength;r$d<r$T;r$d++){var r$j=r$Y[r$d];if(r$b.isVisible(r$j._owner.layer.mask)&&r$j.enable){r$j._renderUpdate(r$M),r$j._distanceForSort=r$TQ.distance(r$j.boundingSphere.center,r$L)+r$j.sortingFudge;var r$c=r$j._renderElements;for(r$U=0,r$i=r$c.length;r$U<r$i;r$U++){var r$G=r$c[r$U],r$z=r$G._staticBatch;if(r$z&&r$z._material===r$G._material)r$z._addBatchRenderElement(r$G);else{var r$A=r$G.renderObj;r$A.triangleCount<10&&1===r$A._vertexBufferCount&&r$A._getIndexBuffer()&&r$G._material.renderQueue<2&&r$G._canDynamicBatch&&!r$j._owner.isStatic?r$o._addPrepareRenderElement(r$G):r$S.getRenderQueue(r$G._material.renderQueue)._addRenderElement(r$G)}}}}for(r$d=0,r$T=r$J.length;r$d<r$T;r$d++)r$J[r$d]._addToRenderQueue(r$S,r$e,r$l,r$M);r$o._finishCombineDynamicBatch(r$S),r$o._addToRenderQueue(r$S,r$e,r$l,r$M)},r$S}(),r$lS=function(){function r$d(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}r$J(r$d,"laya.d3.graphics.StaticBatchManager");var r$S=r$d.prototype;return r$S._finishInit=function(){for(var r$S in this._staticBatches)this._staticBatches[r$S]._finishInit();this._initBatchRenderElements.length=0},r$S._initStaticBatchs=function(r$S){throw new Error("StaticBatchManager:must override this function.")},r$S._addInitBatchSprite=function(r$S){for(var r$Q=r$S._render._renderElements,r$e=0,r$l=r$Q.length;r$e<r$l;r$e++)this._initBatchRenderElements.push(r$Q[r$e])},r$S._clearRenderElements=function(){for(var r$S in this._staticBatches)this._staticBatches[r$S]._clearRenderElements()},r$S._garbageCollection=function(r$S){var r$Q=r$S._staticBatch,r$e=r$Q._initBatchRenderElements,r$l=r$e.indexOf(r$S);r$e.splice(r$l,1),0===r$e.length&&(r$Q.dispose(),delete this._staticBatches[r$Q._key])},r$S._addToRenderQueue=function(r$S,r$Q,r$e,r$l){for(var r$M in this._staticBatches){var r$d=this._staticBatches[r$M];0<r$d._batchRenderElements.length&&r$d._updateToRenderQueue(r$S,r$l)}},r$S.dispose=function(){this._staticBatches=null},r$d._addToStaticBatchQueue=function(r$S){r$S instanceof laya.d3.core.RenderableSprite3D&&r$S._addToInitStaticBatchManager();for(var r$Q=0,r$e=r$S.numChildren;r$Q<r$e;r$Q++)r$d._addToStaticBatchQueue(r$S._childs[r$Q])},r$d.combine=function(r$S,r$Q){var r$e,r$l=0,r$M=0;if(r$Q)for(r$l=0,r$M=r$Q.length;r$l<r$M;r$l++){r$Q[r$l]._addToInitStaticBatchManager()}else r$S&&r$d._addToStaticBatchQueue(r$S);for(r$l=0,r$M=r$d._staticBatchManagers.length;r$l<r$M;r$l++)(r$e=r$d._staticBatchManagers[r$l])._initStaticBatchs(r$S),r$e._finishInit()},r$d._staticBatchManagers=[],r$d}(),r$MS=function(){function r$S(r$S,r$Q,r$e){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=r$S,this._manager=r$Q,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=r$e}r$J(r$S,"laya.d3.graphics.StaticBatch");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),r$Q._binarySearch=function(r$S){for(var r$Q=0,r$e=this._batchRenderElements.length-1,r$l=0;r$Q<=r$e;)r$l=Math.floor((r$Q+r$e)/2),this._compareBatchRenderElement(this._batchRenderElements[r$l],r$S)?r$e=r$l-1:r$Q=r$l+1;return r$Q},r$Q._compareBatchRenderElement=function(r$S,r$Q){throw new Error("StaticBatch:must override this function.")},r$Q._getVertexDecLightMap=function(r$S){return r$S===r$aS.vertexDeclaration?r$bS.vertexDeclaration:r$S===r$PS.vertexDeclaration?r$hS.vertexDeclaration:r$S===r$gS.vertexDeclaration?r$vS.vertexDeclaration:r$S===r$rS.vertexDeclaration?null:r$S===r$jS.vertexDeclaration?r$cS.vertexDeclaration:r$S===r$wS.vertexDeclaration?r$$S.vertexDeclaration:r$S===r$kS.vertexDeclaration?r$XS.vertexDeclaration:r$S===r$fS.vertexDeclaration?r$mS.vertexDeclaration:r$S===r$PS.vertexDeclaration?r$hS.vertexDeclaration:r$S===r$IS.vertexDeclaration?r$DS.vertexDeclaration:r$S===r$rS.vertexDeclaration?null:r$S===r$jS.vertexDeclaration?r$cS.vertexDeclaration:r$S===r$uS.vertexDeclaration?r$nS.vertexDeclaration:r$S===r$kS.vertexDeclaration?r$XS.vertexDeclaration:r$S},r$Q._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},r$Q._addBatchRenderElement=function(r$S){this._batchRenderElements.splice(this._binarySearch(r$S),0,r$S)},r$Q._updateToRenderQueue=function(r$S,r$Q){this._combineRenderElementPoolIndex=0,this._getRenderElement(r$S.getRenderQueue(this._material.renderQueue)._renderElements,r$S,r$Q)},r$Q._getRenderElement=function(r$S,r$Q,r$e){throw new Error("StaticBatch:must override this function.")},r$Q._finishInit=function(){throw new Error("StaticBatch:must override this function.")},r$Q._clearRenderElements=function(){this._batchRenderElements.length=0},r$Q.dispose=function(){},r$Q._getVertexBuffer=function(r$S){return void 0===r$S&&(r$S=0),null},r$Q._getIndexBuffer=function(){return null},r$Q._beforeRender=function(r$S){return!0},r$Q._render=function(r$S){},r$Q._getVertexBuffers=function(){return null},r$L(0,r$Q,"_vertexBufferCount",function(){return 1}),r$L(0,r$Q,"triangleCount",function(){return 0}),r$S.combine=function(r$S){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),r$lS.combine(r$S)},r$S.maxBatchVertexCount=65535,r$S}(),r$dS=function(){function r$T(r$S,r$Q){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++r$T._uniqueIDCounter,this._id>r$T.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",r$T.maxVertexDeclaration);this._shaderValues=new r$pQ,this._vertexElementsDic={},this._vertexStride=r$S,this._vertexElements=r$Q;for(var r$e=0;r$e<r$Q.length;r$e++){var r$l=r$Q[r$e],r$M=r$l.elementUsage;this._vertexElementsDic[r$M]=r$l;var r$d=[r$T._getTypeSize(r$l.elementFormat)/4,5126,!1,this._vertexStride,r$l.offset];switch(this._shaderValues.setValue(r$M,r$d),r$M){case 1:this._addShaderDefine(r$HQ.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(r$HQ.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(r$HQ.SHADERDEFINE_UV1)}}}r$J(r$T,"laya.d3.graphics.VertexDeclaration");var r$S=r$T.prototype;return r$S._addShaderDefine=function(r$S){this._shaderDefineValue|=r$S},r$S._removeShaderDefine=function(r$S){this._shaderDefineValue&=~r$S},r$S.getVertexElements=function(){return this._vertexElements.slice()},r$S.getVertexElementByUsage=function(r$S){return this._vertexElementsDic[r$S]},r$S.unBinding=function(){},r$L(0,r$S,"shaderDefineValue",function(){return this._shaderDefineValue}),r$L(0,r$S,"id",function(){return this._id}),r$L(0,r$S,"vertexStride",function(){return this._vertexStride}),r$L(0,r$S,"shaderValues",function(){return this._shaderValues}),r$T._getTypeSize=function(r$S){switch(r$S){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},r$T.getVertexStride=function(r$S){for(var r$Q=0,r$e=0;r$e<r$S.Length;r$e++){var r$l=r$S[r$e],r$M=r$l.offset+r$T._getTypeSize(r$l.elementFormat);r$Q<r$M&&(r$Q=r$M)}return r$Q},r$T._maxVertexDeclarationBit=1e3,r$T._uniqueIDCounter=1,r$Y(r$T,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),r$T}(),r$TS=function(){function r$S(r$S,r$Q,r$e){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=r$S,this.elementFormat=r$Q,this.elementUsage=r$e}return r$J(r$S,"laya.d3.graphics.VertexElement"),r$S}(),r$US=(function(){function r$S(){}r$J(r$S,"laya.d3.graphics.VertexElementFormat"),r$S.Single="single",r$S.Vector2="vector2",r$S.Vector3="vector3",r$S.Vector4="vector4",r$S.Color="color",r$S.Byte4="byte4",r$S.Short2="short2",r$S.Short4="short4",r$S.NormalizedShort2="normalizedshort2",r$S.NormalizedShort4="normalizedshort4",r$S.HalfVector2="halfvector2",r$S.HalfVector4="halfvector4"}(),function(){function r$S(){}r$J(r$S,"laya.d3.graphics.VertexElementUsage"),r$S.POSITION0=0,r$S.COLOR0=1,r$S.TEXTURECOORDINATE0=2,r$S.NORMAL0=3,r$S.BINORMAL0=4,r$S.TANGENT0=5,r$S.BLENDINDICES0=6,r$S.BLENDWEIGHT0=7,r$S.DEPTH0=8,r$S.FOG0=9,r$S.POINTSIZE0=10,r$S.SAMPLE0=11,r$S.TESSELLATEFACTOR0=12,r$S.COLOR1=13,r$S.NEXTTEXTURECOORDINATE0=14,r$S.TEXTURECOORDINATE1=15,r$S.NEXTTEXTURECOORDINATE1=16,r$S.CORNERTEXTURECOORDINATE0=17,r$S.VELOCITY0=18,r$S.STARTCOLOR0=19,r$S.STARTSIZE=20,r$S.AGEADDSCALE0=21,r$S.STARTROTATION=22,r$S.ENDCOLOR0=23,r$S.STARTLIFETIME=24,r$S.TIME0=33,r$S.SHAPEPOSITIONSTARTLIFETIME=30,r$S.DIRECTIONTIME=32,r$S.SIZEROTATION0=27,r$S.RADIUS0=28,r$S.RADIAN0=29,r$S.STARTSPEED=31,r$S.RANDOM0=34,r$S.RANDOM1=35,r$S.SIMULATIONWORLDPOSTION=36,r$S.SIMULATIONWORLDROTATION=37,r$S.TEXTURECOORDINATE0X=38,r$S.TEXTURECOORDINATE0X1=39,r$S.TEXTURECOORDINATE0Y=40,r$S.OFFSETVECTOR=41}(),function(){function r$S(r$S,r$Q,r$e){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=r$S,this._textureCoordinate0=r$Q,this._time=r$e}r$J(r$S,"laya.d3.graphics.VertexGlitter");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate0}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"time",function(){return this._time}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(24,[new r$TS(0,"vector3",0),new r$TS(12,"vector2",2),new r$TS(20,"single",33)])}])}(),function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=r$S,this._position=r$Q,this._velocity=r$e,this._startColor=r$l,this._endColor=r$M,this._sizeRotation=r$d,this._radius=r$T,this._radian=r$U,this._ageAddScale=r$i,this._time=r$R}r$J(r$S,"laya.d3.graphics.VertexParticle");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"endColor",function(){return this._endColor}),r$L(0,r$Q,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),r$L(0,r$Q,"sizeRotation",function(){return this._sizeRotation}),r$L(0,r$Q,"velocity",function(){return this._velocity}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"startColor",function(){return this._startColor}),r$L(0,r$Q,"radius",function(){return this._radius}),r$L(0,r$Q,"radian",function(){return this._radian}),r$L(0,r$Q,"ageAddScale",function(){return this._ageAddScale}),r$L(0,r$Q,"time",function(){return this._time}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(116,[new r$TS(0,"vector4",17),new r$TS(16,"vector3",0),new r$TS(28,"vector3",18),new r$TS(40,"vector4",19),new r$TS(56,"vector4",23),new r$TS(72,"vector3",27),new r$TS(84,"vector2",28),new r$TS(92,"vector4",29),new r$TS(108,"single",24),new r$TS(112,"single",33)])}])}(),function(){function r$S(r$S){this._position=null,this._position=r$S}r$J(r$S,"laya.d3.graphics.VertexPosition");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(12,[new r$TS(0,"vector3",0)])}]),r$S}()),r$iS=function(){function r$S(r$S,r$Q){this._position=null,this._normal=null,this._position=r$S,this._normal=r$Q}r$J(r$S,"laya.d3.graphics.VertexPositionNormal");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(24,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3)])}]),r$S}(),r$RS=function(){function r$S(r$S,r$Q,r$e){this._position=null,this._normal=null,this._color=null,this._position=r$S,this._normal=r$Q,this._color=r$e}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColor");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(40,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1)])}]),r$S}(),r$oS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._blendIndex=r$l,this._blendWeight=r$M}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorSkin");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(72,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector4",7),new r$TS(56,"vector4",6)])}]),r$S}(),r$YS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._tangent=r$l,this._blendIndex=r$M,this._blendWeight=r$d}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(88,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector4",7),new r$TS(56,"vector4",6),new r$TS(72,"vector4",5)])}]),r$S}(),r$pS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._tangent=r$l,this._blendIndex=r$M,this._blendWeight=r$d}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(84,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector4",7),new r$TS(56,"vector4",6),new r$TS(72,"vector3",5)])}]),r$S}(),r$JS=function(){function r$S(r$S,r$Q,r$e,r$l){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._tangent=r$l}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorSTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(56,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector4",5)])}]),r$S}(),r$LS=function(){function r$S(r$S,r$Q,r$e,r$l){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._tangent=r$l}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(52,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector3",5)])}]),r$S}(),r$jS=function(){function r$S(r$S,r$Q,r$e,r$l){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._textureCoordinate=r$l}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorTexture");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(48,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector2",2)])}]),r$S}(),r$cS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._textureCoordinate0=r$l,this._textureCoordinate1=r$M}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(0,r$Q,"textureCoordinate1",function(){return this._textureCoordinate1}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(56,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector2",2),new r$TS(48,"vector2",15)])}]),r$S}(),r$GS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._textureCoordinate0=r$l,this._textureCoordinate1=r$M,this._blendIndex=r$d,this._blendWeight=r$T}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(0,r$Q,"textureCoordinate1",function(){return this._textureCoordinate1}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(88,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector2",2),new r$TS(48,"vector2",15),new r$TS(56,"vector4",7),new r$TS(72,"vector4",6)])}]),r$S}(),r$zS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._textureCoordinate0=r$l,this._textureCoordinate1=r$M,this._tangent=r$d,this._blendIndex=r$T,this._blendWeight=r$U}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(0,r$Q,"textureCoordinate1",function(){return this._textureCoordinate1}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(104,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector2",2),new r$TS(48,"vector2",15),new r$TS(56,"vector4",7),new r$TS(72,"vector4",6),new r$TS(88,"vector4",5)])}]),r$S}(),r$AS=function(){function r$S(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$Q.VertexPositionNormalColorTexture0SkinTangent=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){this._position=r$S,this._normal=r$Q,this._color=r$e,this._textureCoordinate0=r$l,this._textureCoordinate1=r$M,this._tangent=r$d,this._blendIndex=r$T,this._blendWeight=r$U},r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(0,r$Q,"textureCoordinate1",function(){return this._textureCoordinate1}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(100,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector2",2),new r$TS(48,"vector2",15),new r$TS(56,"vector4",7),new r$TS(72,"vector4",6),new r$TS(88,"vector3",5)])}]),r$S}(),r$vS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._textureCoordinate0=r$l,this._textureCoordinate1=r$M,this._tangent=r$d}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(0,r$Q,"textureCoordinate1",function(){return this._textureCoordinate1}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(72,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector2",2),new r$TS(48,"vector2",15),new r$TS(56,"vector4",5)])}]),r$S}(),r$DS=function(){function r$S(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$Q.VertexPositionNormalColorTexture0Tangent=function(r$S,r$Q,r$e,r$l,r$M,r$d){this._position=r$S,this._normal=r$Q,this._color=r$e,this._textureCoordinate0=r$l,this._textureCoordinate1=r$M,this._tangent=r$d},r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(0,r$Q,"textureCoordinate1",function(){return this._textureCoordinate1}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(68,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector2",2),new r$TS(48,"vector2",15),new r$TS(56,"vector3",5)])}]),r$S}(),r$BS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._textureCoordinate=r$l,this._blendIndex=r$M,this._blendWeight=r$d}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(80,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector2",2),new r$TS(48,"vector4",7),new r$TS(64,"vector4",6)])}]),r$S}(),r$OS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._textureCoordinate=r$l,this._tangent=r$M,this._blendIndex=r$d,this._blendWeight=r$T}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(96,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector2",2),new r$TS(48,"vector4",7),new r$TS(64,"vector4",6),new r$TS(80,"vector4",5)])}]),r$S}(),r$HS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._textureCoordinate=r$l,this._tangent=r$M,this._blendIndex=r$d,this._blendWeight=r$T}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(92,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector2",2),new r$TS(48,"vector4",7),new r$TS(64,"vector4",6),new r$TS(80,"vector3",5)])}]),r$S}(),r$gS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._textureCoordinate=r$l,this._tangent=r$M}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(64,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector2",2),new r$TS(48,"vector4",5)])}]),r$S}(),r$IS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._color=r$e,this._textureCoordinate=r$l,this._tangent=r$M}r$J(r$S,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"color",function(){return this._color}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(60,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",1),new r$TS(40,"vector2",2),new r$TS(48,"vector3",5)])}]),r$S}(),r$ES=function(){function r$S(r$S,r$Q,r$e){this._position=null,this._normal=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._tangent=r$e}r$J(r$S,"laya.d3.graphics.VertexPositionNormalSTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(40,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector4",5)])}]),r$S}(),r$tS=function(){function r$S(r$S,r$Q,r$e){this._position=null,this._normal=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._tangent=r$e}r$J(r$S,"laya.d3.graphics.VertexPositionNormalTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(36,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector3",5)])}]),r$S}(),r$kS=function(){function r$S(r$S,r$Q,r$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=r$S,this._normal=r$Q,this._textureCoordinate=r$e}r$J(r$S,"laya.d3.graphics.VertexPositionNormalTexture");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(32,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector2",2)])}]),r$S}(),r$XS=function(){function r$S(r$S,r$Q,r$e,r$l){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=r$S,this._normal=r$Q,this._textureCoordinate0=r$e,this._textureCoordinate1=r$l}r$J(r$S,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(0,r$Q,"textureCoordinate1",function(){return this._textureCoordinate1}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(40,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector2",2),new r$TS(32,"vector2",15)])}]),r$S}(),r$hS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=r$S,this._normal=r$Q,this._textureCoordinate0=r$e,this._textureCoordinate1=r$l,this._blendIndex=r$M,this._blendWeight=r$d}r$J(r$S,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(0,r$Q,"textureCoordinate1",function(){return this._textureCoordinate1}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(72,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector2",2),new r$TS(32,"vector2",15),new r$TS(40,"vector4",7),new r$TS(56,"vector4",6)])}]),r$S}(),r$bS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._textureCoordinate0=r$e,this._textureCoordinate1=r$l,this._tangent=r$M,this._blendIndex=r$d,this._blendWeight=r$T}r$J(r$S,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(0,r$Q,"textureCoordinate1",function(){return this._textureCoordinate1}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(88,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector2",2),new r$TS(32,"vector2",15),new r$TS(40,"vector4",7),new r$TS(56,"vector4",6),new r$TS(72,"vector4",5)])}]),r$S}(),r$mS=function(){function r$S(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}r$J(r$S,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$Q.VertexPositionNormalTexture0SkinTangent=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){this._position=r$S,this._normal=r$Q,this._textureCoordinate0=r$e,this._textureCoordinate1=r$l,this._tangent=r$M,this._blendIndex=r$d,this._blendWeight=r$T},r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(0,r$Q,"textureCoordinate1",function(){return this._textureCoordinate1}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(84,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector2",2),new r$TS(32,"vector2",15),new r$TS(40,"vector4",7),new r$TS(56,"vector4",6),new r$TS(72,"vector3",5)])}]),r$S}(),r$$S=function(){function r$S(r$S,r$Q,r$e,r$l,r$M){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._textureCoordinate0=r$e,this._textureCoordinate1=r$l,this._tangent=r$M}r$J(r$S,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(0,r$Q,"textureCoordinate1",function(){return this._textureCoordinate1}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(56,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector2",2),new r$TS(32,"vector2",15),new r$TS(40,"vector4",5)])}]),r$S}(),r$nS=function(){function r$S(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}r$J(r$S,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$Q.VertexPositionNormalTexture0Tangent=function(r$S,r$Q,r$e,r$l,r$M){this._position=r$S,this._normal=r$Q,this._textureCoordinate0=r$e,this._textureCoordinate1=r$l,this._tangent=r$M},r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(0,r$Q,"textureCoordinate1",function(){return this._textureCoordinate1}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(52,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector2",2),new r$TS(32,"vector2",15),new r$TS(40,"vector3",5)])}]),r$S}(),r$PS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=r$S,this._normal=r$Q,this._textureCoordinate=r$e,this._blendIndex=r$l,this._blendWeight=r$M}r$J(r$S,"laya.d3.graphics.VertexPositionNormalTextureSkin");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(64,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector2",2),new r$TS(32,"vector4",7),new r$TS(48,"vector4",6)])}]),r$S}(),r$aS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._textureCoordinate=r$e,this._tangent=r$l,this._blendIndex=r$M,this._blendWeight=r$d}r$J(r$S,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(80,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector2",2),new r$TS(32,"vector4",7),new r$TS(48,"vector4",6),new r$TS(64,"vector4",5)])}]),r$S}(),r$fS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._textureCoordinate=r$e,this._tangent=r$l,this._blendIndex=r$M,this._blendWeight=r$d}r$J(r$S,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(76,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector2",2),new r$TS(32,"vector4",7),new r$TS(48,"vector4",6),new r$TS(64,"vector3",5)])}]),r$S}(),r$wS=function(){function r$S(r$S,r$Q,r$e,r$l){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._textureCoordinate=r$e,this._tangent=r$l}r$J(r$S,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(48,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector2",2),new r$TS(32,"vector4",5)])}]),r$S}(),r$uS=function(){function r$S(r$S,r$Q,r$e,r$l){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=r$S,this._normal=r$Q,this._textureCoordinate=r$e,this._tangent=r$l}r$J(r$S,"laya.d3.graphics.VertexPositionNormalTextureTangent");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(44,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector2",2),new r$TS(32,"vector3",5)])}]),r$S}(),r$rS=function(){function r$S(r$S,r$Q,r$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=r$S,this._normal=r$Q,this._textureCoordinate=r$e}r$J(r$S,"laya.d3.graphics.VertexPositionNTBTexture");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(56,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector3",5),new r$TS(36,"vector3",4),new r$TS(48,"vector2",2)])}]),r$S}(),r$WS=function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=r$S,this._normal=r$Q,this._textureCoordinate0=r$l,this._textureCoordinate1=r$M,this._tangent=r$d,r$e=r$e,this._blendIndex=r$T,this._blendWeight=r$U}r$J(r$S,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"tangent",function(){return this._tangent}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(0,r$Q,"textureCoordinate1",function(){return this._textureCoordinate1}),r$L(0,r$Q,"blendIndex",function(){return this._blendIndex}),r$L(0,r$Q,"blendWeight",function(){return this._blendWeight}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(96,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector3",5),new r$TS(36,"vector3",4),new r$TS(48,"vector2",2),new r$TS(56,"vector2",15),new r$TS(64,"vector4",7),new r$TS(80,"vector4",6)])}]),r$S}(),r$xS=function(){function r$S(r$S,r$Q,r$e){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=r$S,this._normal=r$Q,this._textureCoordinate=r$e}r$J(r$S,"laya.d3.graphics.VertexPositionNTBTextureSkin");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"textureCoordinate",function(){return this._textureCoordinate}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(88,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector3",5),new r$TS(36,"vector3",4),new r$TS(48,"vector2",2),new r$TS(56,"vector4",7),new r$TS(72,"vector4",6)])}]),r$S}(),r$FS=(function(){function r$S(r$S,r$Q,r$e,r$l){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=r$S,this._normal=r$Q,this._textureCoord0=r$e,this._textureCoord1=r$l}r$J(r$S,"laya.d3.graphics.VertexPositionTerrain");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"normal",function(){return this._normal}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"textureCoord0",function(){return this._textureCoord0}),r$L(0,r$Q,"textureCoord1",function(){return this._textureCoord1}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(40,[new r$TS(0,"vector3",0),new r$TS(12,"vector3",3),new r$TS(24,"vector2",2),new r$TS(32,"vector2",15)])}])}(),function(){function r$S(r$S,r$Q){this._position=null,this._textureCoordinate0=null,this._position=r$S,this._textureCoordinate0=r$Q}r$J(r$S,"laya.d3.graphics.VertexPositionTexture0");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"position",function(){return this._position}),r$L(0,r$Q,"textureCoordinate0",function(){return this._textureCoordinate0}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(20,[new r$TS(0,"vector3",0),new r$TS(12,"vector2",2)])}]),r$S}()),r$qS=(function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o,r$Y,r$p,r$J){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=r$S,this._positionStartLifeTime=r$Q,this._velocity=r$e,this._startColor=r$l,this._startSize=r$M,this._startRotation0=r$d,this._startRotation1=r$T,this._startRotation2=r$U,this._startLifeTime=r$i,this._time=r$R,this._startSpeed=r$o,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=r$J}r$J(r$S,"laya.d3.graphics.VertexShurikenParticleBillboard");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),r$L(0,r$Q,"random1",function(){return this._randoms1}),r$L(0,r$Q,"startRotation2",function(){return this._startRotation2}),r$L(0,r$Q,"positionStartLifeTime",function(){return this._positionStartLifeTime}),r$L(0,r$Q,"velocity",function(){return this._velocity}),r$L(0,r$Q,"random0",function(){return this._randoms0}),r$L(0,r$Q,"startSize",function(){return this._startSize}),r$L(0,r$Q,"startColor",function(){return this._startColor}),r$L(0,r$Q,"startRotation0",function(){return this._startRotation0}),r$L(0,r$Q,"startRotation1",function(){return this._startRotation1}),r$L(0,r$Q,"startLifeTime",function(){return this._startLifeTime}),r$L(0,r$Q,"time",function(){return this._time}),r$L(0,r$Q,"startSpeed",function(){return this._startSpeed}),r$L(0,r$Q,"simulationWorldPostion",function(){return this._simulationWorldPostion}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(152,[new r$TS(0,"vector4",17),new r$TS(16,"vector4",30),new r$TS(32,"vector4",32),new r$TS(48,"vector4",19),new r$TS(64,"vector3",20),new r$TS(76,"vector3",22),new r$TS(88,"single",31),new r$TS(92,"vector4",34),new r$TS(108,"vector4",35),new r$TS(124,"vector3",36),new r$TS(136,"vector4",37)])}])}(),function(){function r$S(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o,r$Y,r$p,r$J){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=r$S,this._positionStartLifeTime=r$Q,this._velocity=r$e,this._startColor=r$l,this._startSize=r$M,this._startRotation0=r$d,this._startRotation1=r$T,this._startRotation2=r$U,this._startLifeTime=r$i,this._time=r$R,this._startSpeed=r$o,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=r$J}r$J(r$S,"laya.d3.graphics.VertexShurikenParticleMesh");var r$Q=r$S.prototype;r$D.imps(r$Q,{"laya.d3.graphics.IVertex":!0}),r$L(0,r$Q,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),r$L(0,r$Q,"velocity",function(){return this._velocity}),r$L(0,r$Q,"position",function(){return this._positionStartLifeTime}),r$L(0,r$Q,"random0",function(){return this._randoms0}),r$L(0,r$Q,"startSize",function(){return this._startSize}),r$L(0,r$Q,"startColor",function(){return this._startColor}),r$L(0,r$Q,"startRotation0",function(){return this._startRotation0}),r$L(0,r$Q,"startRotation1",function(){return this._startRotation1}),r$L(0,r$Q,"random1",function(){return this._randoms1}),r$L(0,r$Q,"startRotation2",function(){return this._startRotation2}),r$L(0,r$Q,"startLifeTime",function(){return this._startLifeTime}),r$L(0,r$Q,"time",function(){return this._time}),r$L(0,r$Q,"startSpeed",function(){return this._startSpeed}),r$L(0,r$Q,"simulationWorldPostion",function(){return this._simulationWorldPostion}),r$L(0,r$Q,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$L(1,r$S,"vertexDeclaration",function(){return r$S._vertexDeclaration}),r$Y(r$S,["_vertexDeclaration",function(){return this._vertexDeclaration=new r$dS(172,[new r$TS(0,"vector3",0),new r$TS(12,"vector4",1),new r$TS(28,"vector2",2),new r$TS(36,"vector4",30),new r$TS(52,"vector4",32),new r$TS(68,"vector4",19),new r$TS(84,"vector3",20),new r$TS(96,"vector3",22),new r$TS(108,"single",31),new r$TS(112,"vector4",34),new r$TS(128,"vector4",35),new r$TS(144,"vector3",36),new r$TS(156,"vector4",37)])}])}(),function(){function r$A(r$S,r$Q,r$e,r$l,r$M,r$d){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=r$e,this._materials=r$l,this._subMeshes=r$M,this._materialMap=r$d,this._version=r$Q,this._onLoaded(r$S)}r$J(r$A,"laya.d3.loaders.LoadModelV01");var r$S=r$A.prototype;return r$S._onLoaded=function(r$S){this._readData=r$S,this.READ_BLOCK();for(var r$Q=0;r$Q<this._BLOCK.count;r$Q++){var r$e=this._readData.getUint16(),r$l=this._strings[r$e],r$M=this["READ_"+r$l];if(null==r$M)throw new Error("model file err,no this function:"+r$e+" "+r$l);if(!r$M.call(this))break}return this._mesh},r$S.onError=function(){},r$S._readString=function(){return this._strings[this._readData.getUint16()]},r$S.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},r$S.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},r$S.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var r$S=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var r$Q=0;r$Q<this._STRINGS.size;r$Q++)this._strings[r$Q]=this._readData.readUTFString();return this._readData.pos=r$S,!0},r$S.READ_MATERIAL=function(){var r$S=this._readData.getUint16(),r$Q=(this._readString(),this._readString());return this._materials[r$S]="null"!==r$Q?r$G.getRes(this._materialMap[r$Q]):new r$tQ,!0},r$S.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var r$S,r$Q=this._readData.__getBuffer(),r$e=0,r$l=this._readData.getUint32(),r$M=this._readData.getUint32(),r$d=(new Float32Array(r$Q.slice(r$l+this._DATA.offset,r$l+this._DATA.offset+r$M)),this._readData.getUint32()),r$T=this._readData.getUint32(),r$U=new Float32Array(r$Q.slice(r$d+this._DATA.offset,r$d+this._DATA.offset+r$T));for(this.mesh._inverseBindPoses=[],r$e=0,r$S=r$U.length;r$e<r$S;r$e+=16){var r$i=new r$SQ(r$U[r$e+0],r$U[r$e+1],r$U[r$e+2],r$U[r$e+3],r$U[r$e+4],r$U[r$e+5],r$U[r$e+6],r$U[r$e+7],r$U[r$e+8],r$U[r$e+9],r$U[r$e+10],r$U[r$e+11],r$U[r$e+12],r$U[r$e+13],r$U[r$e+14],r$U[r$e+15]);this.mesh._inverseBindPoses.push(r$i)}break;default:throw new Error("LoadModel:unknown version.")}return!0},r$S.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var r$S=this._readString();this._shaderAttributes=r$S.match(r$A._attrReg);var r$Q=this._readData.getUint32(),r$e=this._readData.getUint32(),r$l=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),r$M=this._readData.getUint32(),r$d=this._readData.getUint32(),r$T=this._readData.getUint32(),r$U=this._readData.__getBuffer(),r$i=new r$RQ(this._mesh),r$R=this._getVertexDeclaration(),r$o=r$fQ.create(r$R,r$M/r$R.vertexStride,35044,!0),r$Y=r$l+this._DATA.offset,r$p=r$U.slice(r$Y,r$Y+r$M);r$o.setData(new Float32Array(r$p));for(var r$J=(r$i._vertexBuffer=r$o).vertexDeclaration.getVertexElements(),r$L=0;r$L<r$J.length;r$L++)r$i._bufferUsage[r$J[r$L].elementUsage]=r$o;var r$j=r$aQ.create("ushort",r$e/2,35044,!0),r$c=r$Q+this._DATA.offset,r$G=r$U.slice(r$c,r$c+r$e);r$j.setData(new Uint16Array(r$G)),r$i._indexBuffer=r$j;var r$z=r$U.slice(r$d+this._DATA.offset,r$d+this._DATA.offset+r$T);return r$i._boneIndicesList[0]=new Uint8Array(r$z),this._subMeshes.push(r$i),!0},r$S.READ_DATAAREA=function(){return!1},r$S._getVertexDeclaration=function(){for(var r$S,r$Q=!1,r$e=!1,r$l=!1,r$M=!1,r$d=!1,r$T=!1,r$U=!1,r$i=!1,r$R=!1,r$o=0;r$o<this._shaderAttributes.length;r$o+=8)switch(this._shaderAttributes[r$o]){case"POSITION":r$Q=!0;break;case"NORMAL":r$e=!0;break;case"COLOR":r$l=!0;break;case"UV":r$M=!0;break;case"UV1":r$d=!0;break;case"BLENDWEIGHT":r$U=!0;break;case"BLENDINDICES":r$i=!0;break;case"TANGENT":r$T=!0;break;case"BINORMAL":r$R=!0}return r$Q&&r$e&&r$l&&r$M&&r$d&&r$U&&r$i&&r$T?r$S=r$AS.vertexDeclaration:r$Q&&r$e&&r$l&&r$M&&r$d&&r$U&&r$i?r$S=r$GS.vertexDeclaration:r$Q&&r$e&&r$M&&r$d&&r$U&&r$i&&r$T?r$S=r$mS.vertexDeclaration:r$Q&&r$e&&r$M&&r$d&&r$U&&r$i?r$S=r$hS.vertexDeclaration:r$Q&&r$e&&r$l&&r$M&&r$U&&r$i&&r$T?r$S=r$HS.vertexDeclaration:r$Q&&r$e&&r$l&&r$M&&r$U&&r$i?r$S=r$BS.vertexDeclaration:r$Q&&r$e&&r$T&&r$R&&r$M&&r$U&&r$i?r$S=r$xS.vertexDeclaration:r$Q&&r$e&&r$M&&r$U&&r$i&&r$T?r$S=r$fS.vertexDeclaration:r$Q&&r$e&&r$M&&r$U&&r$i?r$S=r$PS.vertexDeclaration:r$Q&&r$e&&r$l&&r$U&&r$i&&r$T?r$S=r$pS.vertexDeclaration:r$Q&&r$e&&r$l&&r$U&&r$i?r$S=r$oS.vertexDeclaration:r$Q&&r$e&&r$l&&r$M&&r$d&&r$T?r$S=r$DS.vertexDeclaration:r$Q&&r$e&&r$l&&r$M&&r$d?r$S=r$cS.vertexDeclaration:r$Q&&r$e&&r$M&&r$d&&r$T?r$S=r$nS.vertexDeclaration:r$Q&&r$e&&r$M&&r$d?r$S=r$XS.vertexDeclaration:r$Q&&r$e&&r$l&&r$M&&r$T?r$S=r$IS.vertexDeclaration:r$Q&&r$e&&r$M&&r$T&&r$R?r$S=r$rS.vertexDeclaration:r$Q&&r$e&&r$l&&r$M?r$S=r$jS.vertexDeclaration:r$Q&&r$e&&r$M&&r$T?r$S=r$uS.vertexDeclaration:r$Q&&r$e&&r$M?r$S=r$kS.vertexDeclaration:r$Q&&r$e&&r$l&&r$T?r$S=r$LS.vertexDeclaration:r$Q&&r$e&&r$l&&(r$S=r$RS.vertexDeclaration),r$S},r$L(0,r$S,"mesh",function(){return this._mesh}),r$A._attrReg=new RegExp("(\\w+)|([:,;])","g"),r$A}()),r$ZS=function(){function r$O(){}return r$J(r$O,"laya.d3.loaders.LoadModelV02"),r$O.parse=function(r$S,r$Q,r$e,r$l,r$M,r$d){r$O._mesh=r$e,r$O._materials=r$l,r$O._subMeshes=r$M,r$O._materialMap=r$d,r$O._version=r$Q,r$O._readData=r$S,r$O.READ_DATA(),r$O.READ_BLOCK(),r$O.READ_STRINGS();for(var r$T=0,r$U=r$O._BLOCK.count;r$T<r$U;r$T++){r$O._readData.pos=r$O._BLOCK.blockStarts[r$T];var r$i=r$O._readData.getUint16(),r$R=r$O._strings[r$i],r$o=r$O["READ_"+r$R];if(null==r$o)throw new Error("model file err,no this function:"+r$i+" "+r$R);r$o.call()}r$O._strings.length=0,r$O._readData=null,r$O._version=null,r$O._mesh=null,r$O._materials=null,r$O._subMeshes=null,r$O._materialMap=null},r$O._readString=function(){return r$O._strings[r$O._readData.getUint16()]},r$O.READ_DATA=function(){r$O._DATA.offset=r$O._readData.getUint32(),r$O._DATA.size=r$O._readData.getUint32()},r$O.READ_BLOCK=function(){for(var r$S=r$O._BLOCK.count=r$O._readData.getUint16(),r$Q=r$O._BLOCK.blockStarts=[],r$e=r$O._BLOCK.blockLengths=[],r$l=0;r$l<r$S;r$l++)r$Q.push(r$O._readData.getUint32()),r$e.push(r$O._readData.getUint32())},r$O.READ_STRINGS=function(){var r$S=r$O._readData.getUint32(),r$Q=r$O._readData.getUint16(),r$e=r$O._readData.pos;r$O._readData.pos=r$S+r$O._DATA.offset;for(var r$l=0;r$l<r$Q;r$l++)r$O._strings[r$l]=r$O._readData.readUTFString();r$O._readData.pos=r$e},r$O.READ_MATERIAL=function(){r$O._readString(),r$O._readString();var r$S=r$O._readString();return""!==r$S&&r$O._materials.push(r$G.getRes(r$O._materialMap[r$S])),!0},r$O.READ_MESH=function(){r$O._readString();var r$S,r$Q=r$O._readData.__getBuffer(),r$e=0,r$l=r$O._readData.getInt16(),r$M=r$O._DATA.offset;for(r$e=0;r$e<r$l;r$e++){var r$d=r$M+r$O._readData.getUint32(),r$T=r$O._readData.getUint32(),r$U=new Float32Array(r$Q.slice(r$d,r$d+r$T)),r$i=r$O._readString().match(r$O._attrReg),r$R=r$O._getVertexDeclaration(r$i),r$o=r$fQ.create(r$R,4*r$U.length/r$R.vertexStride,35044,!0);r$o.setData(r$U),r$O._mesh._vertexBuffers.push(r$o)}var r$Y=r$M+r$O._readData.getUint32(),r$p=r$O._readData.getUint32(),r$J=new Uint16Array(r$Q.slice(r$Y,r$Y+r$p)),r$L=r$aQ.create("ushort",r$p/2,35044,!0);r$L.setData(r$J),r$O._mesh._indexBuffer=r$L;var r$j=r$O._mesh._boneNames=[],r$c=r$O._readData.getUint16();for(r$j.length=r$c,r$e=0;r$e<r$c;r$e++)r$j[r$e]=r$O._strings[r$O._readData.getUint16()];var r$G=r$O._readData.getUint32(),r$z=r$O._readData.getUint32(),r$A=(new Float32Array(r$Q.slice(r$M+r$G,r$M+r$G+r$z)),r$O._readData.getUint32()),r$v=r$O._readData.getUint32(),r$D=new Float32Array(r$Q.slice(r$M+r$A,r$M+r$A+r$v));for(r$O._mesh._inverseBindPoses=[],r$e=0,r$S=r$D.length;r$e<r$S;r$e+=16){var r$B=new r$SQ(r$D[r$e+0],r$D[r$e+1],r$D[r$e+2],r$D[r$e+3],r$D[r$e+4],r$D[r$e+5],r$D[r$e+6],r$D[r$e+7],r$D[r$e+8],r$D[r$e+9],r$D[r$e+10],r$D[r$e+11],r$D[r$e+12],r$D[r$e+13],r$D[r$e+14],r$D[r$e+15]);r$O._mesh._inverseBindPoses.push(r$B)}return r$O._mesh._skinnedDatas=new Float32Array(16*r$D.length),!0},r$O.READ_SUBMESH=function(){var r$S=r$O._readData.__getBuffer(),r$Q=new r$RQ(r$O._mesh),r$e=r$O._readData.getInt16(),r$l=r$O._readData.getUint32(),r$M=r$O._readData.getUint32();r$Q._vertexBuffer=r$O._mesh._vertexBuffers[r$e],r$Q._vertexStart=r$l,r$Q._vertexCount=r$M;var r$d=r$O._readData.getUint32(),r$T=r$O._readData.getUint32(),r$U=r$O._mesh._indexBuffer;r$Q._indexBuffer=r$U,r$Q._indexStart=r$d,r$Q._indexCount=r$T,r$Q._indices=new Uint16Array(r$U.getData().buffer,2*r$d,r$T);var r$i=r$O._DATA.offset,r$R=r$Q._subIndexBufferStart,r$o=r$Q._subIndexBufferCount,r$Y=r$Q._boneIndicesList,r$p=r$O._readData.getUint16();r$R.length=r$p,r$o.length=r$p,r$Y.length=r$p;for(var r$J=0;r$J<r$p;r$J++){r$R[r$J]=r$O._readData.getUint32(),r$o[r$J]=r$O._readData.getUint32();var r$L=r$O._readData.getUint32(),r$j=r$O._readData.getUint32();r$Q._boneIndicesList[r$J]=new Uint8Array(r$S.slice(r$i+r$L,r$i+r$L+r$j))}return r$O._subMeshes.push(r$Q),!0},r$O._getVertexDeclaration=function(r$S){for(var r$Q,r$e=!1,r$l=!1,r$M=!1,r$d=!1,r$T=!1,r$U=!1,r$i=!1,r$R=!1,r$o=!1,r$Y=0;r$Y<r$S.length;r$Y++)switch(r$S[r$Y]){case"POSITION":r$e=!0;break;case"NORMAL":r$l=!0;break;case"COLOR":r$M=!0;break;case"UV":r$d=!0;break;case"UV1":r$T=!0;break;case"BLENDWEIGHT":r$i=!0;break;case"BLENDINDICES":r$R=!0;break;case"TANGENT":r$U=!0;break;case"BINORMAL":r$o=!0}return r$e&&r$l&&r$M&&r$d&&r$T&&r$i&&r$R&&r$U?r$Q=r$AS.vertexDeclaration:r$e&&r$l&&r$M&&r$d&&r$T&&r$i&&r$R?r$Q=r$GS.vertexDeclaration:r$e&&r$l&&r$d&&r$T&&r$i&&r$R&&r$U?r$Q=r$mS.vertexDeclaration:r$e&&r$l&&r$d&&r$T&&r$i&&r$R?r$Q=r$hS.vertexDeclaration:r$e&&r$l&&r$M&&r$d&&r$i&&r$R&&r$U?r$Q=r$HS.vertexDeclaration:r$e&&r$l&&r$M&&r$d&&r$i&&r$R?r$Q=r$BS.vertexDeclaration:r$e&&r$l&&r$d&&r$i&&r$R&&r$U?r$Q=r$fS.vertexDeclaration:r$e&&r$l&&r$d&&r$i&&r$R?r$Q=r$PS.vertexDeclaration:r$e&&r$l&&r$M&&r$i&&r$R&&r$U?r$Q=r$pS.vertexDeclaration:r$e&&r$l&&r$M&&r$i&&r$R?r$Q=r$oS.vertexDeclaration:r$e&&r$l&&r$M&&r$d&&r$T&&r$U?r$Q=r$DS.vertexDeclaration:r$e&&r$l&&r$M&&r$d&&r$T?r$Q=r$cS.vertexDeclaration:r$e&&r$l&&r$d&&r$T&&r$U?r$Q=r$nS.vertexDeclaration:r$e&&r$l&&r$d&&r$T?r$Q=r$XS.vertexDeclaration:r$e&&r$l&&r$M&&r$d&&r$U?r$Q=r$IS.vertexDeclaration:r$e&&r$l&&r$d&&r$U&&r$o?r$Q=r$rS.vertexDeclaration:r$e&&r$l&&r$M&&r$d?r$Q=r$jS.vertexDeclaration:r$e&&r$l&&r$d&&r$U?r$Q=r$uS.vertexDeclaration:r$e&&r$l&&r$d?r$Q=r$kS.vertexDeclaration:r$e&&r$l&&r$M&&r$U?r$Q=r$LS.vertexDeclaration:r$e&&r$l&&r$M&&(r$Q=r$RS.vertexDeclaration),r$Q},r$O._attrReg=new RegExp("(\\w+)|([:,;])","g"),r$O._strings=[],r$O._readData=null,r$O._version=null,r$O._mesh=null,r$O._materials=null,r$O._subMeshes=null,r$O._materialMap=null,r$Y(r$O,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),r$O}(),r$NS=function(){function r$B(){}return r$J(r$B,"laya.d3.loaders.LoadModelV03"),r$B.parse=function(r$S,r$Q,r$e,r$l,r$M){r$B._mesh=r$e,r$B._subMeshes=r$l,r$B._materialMap=r$M,r$B._version=r$Q,r$B._readData=r$S,r$B.READ_DATA(),r$B.READ_BLOCK(),r$B.READ_STRINGS();for(var r$d=0,r$T=r$B._BLOCK.count;r$d<r$T;r$d++){r$B._readData.pos=r$B._BLOCK.blockStarts[r$d];var r$U=r$B._readData.getUint16(),r$i=r$B._strings[r$U],r$R=r$B["READ_"+r$i];if(null==r$R)throw new Error("model file err,no this function:"+r$U+" "+r$i);r$R.call()}r$B._strings.length=0,r$B._readData=null,r$B._version=null,r$B._mesh=null,r$B._subMeshes=null,r$B._materialMap=null},r$B._readString=function(){return r$B._strings[r$B._readData.getUint16()]},r$B.READ_DATA=function(){r$B._DATA.offset=r$B._readData.getUint32(),r$B._DATA.size=r$B._readData.getUint32()},r$B.READ_BLOCK=function(){for(var r$S=r$B._BLOCK.count=r$B._readData.getUint16(),r$Q=r$B._BLOCK.blockStarts=[],r$e=r$B._BLOCK.blockLengths=[],r$l=0;r$l<r$S;r$l++)r$Q.push(r$B._readData.getUint32()),r$e.push(r$B._readData.getUint32())},r$B.READ_STRINGS=function(){var r$S=r$B._readData.getUint32(),r$Q=r$B._readData.getUint16(),r$e=r$B._readData.pos;r$B._readData.pos=r$S+r$B._DATA.offset;for(var r$l=0;r$l<r$Q;r$l++)r$B._strings[r$l]=r$B._readData.readUTFString();r$B._readData.pos=r$e},r$B.READ_MESH=function(){var r$S,r$Q=r$B._readString(),r$e=r$B._readData.__getBuffer(),r$l=0,r$M=r$B._readData.getInt16(),r$d=r$B._DATA.offset;for(r$l=0;r$l<r$M;r$l++){var r$T,r$U=r$d+r$B._readData.getUint32(),r$i=r$B._readData.getUint32(),r$R=new Float32Array(r$e.slice(r$U,r$U+r$i)),r$o=r$B._readString();switch(r$B._version){case"LAYAMODEL:03":r$T=r$B._vertexDeclarationMap_Discard[r$o];break;case"LAYAMODEL:0301":r$T=r$B._vertexDeclarationMap[r$o];break;default:throw new Error("LoadModelV03: unknown version.")}if(!r$T)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+r$B._version+"  bufferAttribute="+r$o+"  name="+r$Q+"  url="+(r$B._mesh?r$B._mesh.url:"null"));var r$Y=r$fQ.create(r$T,4*r$R.length/r$T.vertexStride,35044,!0,r$B._mesh._url+"_"+r$l);r$Y.setData(r$R),r$B._mesh._vertexBuffers.push(r$Y)}var r$p=r$d+r$B._readData.getUint32(),r$J=r$B._readData.getUint32(),r$L=new Uint16Array(r$e.slice(r$p,r$p+r$J)),r$j=r$aQ.create("ushort",r$J/2,35044,!0,r$B._mesh._url);r$j.setData(r$L),r$B._mesh._indexBuffer=r$j;var r$c=r$B._mesh._boneNames=[],r$G=r$B._readData.getUint16();for(r$c.length=r$G,r$l=0;r$l<r$G;r$l++)r$c[r$l]=r$B._strings[r$B._readData.getUint16()];r$B._readData.pos+=8;var r$z=r$B._readData.getUint32(),r$A=r$B._readData.getUint32(),r$v=new Float32Array(r$e.slice(r$d+r$z,r$d+r$z+r$A));for(r$B._mesh._inverseBindPoses=[],r$l=0,r$S=r$v.length;r$l<r$S;r$l+=16){var r$D=new r$SQ(r$v[r$l+0],r$v[r$l+1],r$v[r$l+2],r$v[r$l+3],r$v[r$l+4],r$v[r$l+5],r$v[r$l+6],r$v[r$l+7],r$v[r$l+8],r$v[r$l+9],r$v[r$l+10],r$v[r$l+11],r$v[r$l+12],r$v[r$l+13],r$v[r$l+14],r$v[r$l+15]);r$B._mesh._inverseBindPoses.push(r$D)}return r$B._mesh._skinnedDatas=new Float32Array(16*r$v.length),!0},r$B.READ_SUBMESH=function(){var r$S=r$B._readData.__getBuffer(),r$Q=new r$RQ(r$B._mesh),r$e=r$B._readData.getInt16(),r$l=r$B._readData.getUint32(),r$M=r$B._readData.getUint32();r$Q._vertexBuffer=r$B._mesh._vertexBuffers[r$e],r$Q._vertexStart=r$l,r$Q._vertexCount=r$M;var r$d=r$B._readData.getUint32(),r$T=r$B._readData.getUint32(),r$U=r$B._mesh._indexBuffer;r$Q._indexBuffer=r$U,r$Q._indexStart=r$d,r$Q._indexCount=r$T,r$Q._indices=new Uint16Array(r$U.getData().buffer,2*r$d,r$T);var r$i=r$B._DATA.offset,r$R=r$Q._subIndexBufferStart,r$o=r$Q._subIndexBufferCount,r$Y=r$Q._boneIndicesList,r$p=r$B._readData.getUint16();r$R.length=r$p,r$o.length=r$p,r$Y.length=r$p;for(var r$J=0;r$J<r$p;r$J++){r$R[r$J]=r$B._readData.getUint32(),r$o[r$J]=r$B._readData.getUint32();var r$L=r$B._readData.getUint32(),r$j=r$B._readData.getUint32();r$Y[r$J]=new Uint8Array(r$S.slice(r$i+r$L,r$i+r$L+r$j))}return r$B._subMeshes.push(r$Q),!0},r$B._strings=[],r$B._readData=null,r$B._version=null,r$B._mesh=null,r$B._subMeshes=null,r$B._materialMap=null,r$Y(r$B,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":r$AS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":r$GS.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":r$WS.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":r$mS.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":r$hS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":r$HS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":r$BS.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":r$fS.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":r$PS.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":r$pS.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":r$oS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":r$DS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":r$cS.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":r$nS.vertexDeclaration,"POSITION,NORMAL,UV,UV1":r$XS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":r$IS.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":r$rS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":r$jS.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":r$uS.vertexDeclaration,"POSITION,NORMAL,UV":r$kS.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":r$LS.vertexDeclaration,"POSITION,NORMAL,COLOR":r$RS.vertexDeclaration,"POSITION,NORMAL,TANGENT":r$tS.vertexDeclaration,"POSITION,NORMAL":r$iS.vertexDeclaration,"POSITION,UV":r$FS.vertexDeclaration,POSITION:r$US.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":r$zS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":r$GS.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":r$WS.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":r$bS.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":r$hS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":r$OS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":r$BS.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":r$aS.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":r$PS.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":r$YS.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":r$oS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":r$vS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":r$cS.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":r$$S.vertexDeclaration,"POSITION,NORMAL,UV,UV1":r$XS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":r$gS.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":r$rS.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":r$jS.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":r$wS.vertexDeclaration,"POSITION,NORMAL,UV":r$kS.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":r$JS.vertexDeclaration,"POSITION,NORMAL,COLOR":r$RS.vertexDeclaration,"POSITION,NORMAL,TANGENT":r$ES.vertexDeclaration,"POSITION,NORMAL":r$iS.vertexDeclaration,"POSITION,UV":r$FS.vertexDeclaration,POSITION:r$US.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),r$B}(),r$CS=function(){function r$U(){}return r$J(r$U,"laya.d3.loaders.MeshReader"),r$U.read=function(r$S,r$Q,r$e,r$l,r$M){var r$d=new r$B(r$S);r$d.pos=0;var r$T=r$d.readUTFString();switch(r$T){case"LAYAMODEL:01":case"LAYASKINANI:01":r$U._readVersion01(r$d,r$T,r$Q,r$e,r$l,r$M);break;case"LAYAMODEL:02":r$ZS.parse(r$d,r$T,r$Q,r$e,r$l,r$M);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":r$NS.parse(r$d,r$T,r$Q,r$l,r$M);break;default:throw new Error("MeshReader: unknown mesh version.")}r$Q._setSubMeshes(r$l)},r$U._readVersion01=function(r$S,r$Q,r$e,r$l,r$M,r$d){new r$qS(r$S,r$Q,r$e,r$l,r$M,r$d)},r$U}(),r$KS=function(){function r$S(r$S,r$Q){this.min=null,this.max=null,this.min=r$S,this.max=r$Q}r$J(r$S,"laya.d3.math.BoundBox");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q.getCorners=function(r$S){r$S.length=8;var r$Q=this.min.elements,r$e=this.max.elements,r$l=r$Q[0],r$M=r$Q[1],r$d=r$Q[2],r$T=r$e[0],r$U=r$e[1],r$i=r$e[2];r$S[0]=new r$TQ(r$l,r$U,r$i),r$S[1]=new r$TQ(r$T,r$U,r$i),r$S[2]=new r$TQ(r$T,r$M,r$i),r$S[3]=new r$TQ(r$l,r$M,r$i),r$S[4]=new r$TQ(r$l,r$U,r$d),r$S[5]=new r$TQ(r$T,r$U,r$d),r$S[6]=new r$TQ(r$T,r$M,r$d),r$S[7]=new r$TQ(r$l,r$M,r$d)},r$Q.toDefault=function(){this.min.toDefault(),this.max.toDefault()},r$Q.cloneTo=function(r$S){var r$Q=r$S;this.min.cloneTo(r$Q.min),this.max.cloneTo(r$Q.max)},r$Q.clone=function(){var r$S=new this.constructor(new r$TQ,new r$TQ);return this.cloneTo(r$S),r$S},r$S.createfromPoints=function(r$S,r$Q){if(null==r$S)throw new Error("points");var r$e=r$Q.min,r$l=r$Q.max,r$M=r$e.elements;r$M[0]=Number.MAX_VALUE,r$M[1]=Number.MAX_VALUE,r$M[2]=Number.MAX_VALUE;var r$d=r$l.elements;r$d[0]=-Number.MAX_VALUE,r$d[1]=-Number.MAX_VALUE,r$d[2]=-Number.MAX_VALUE;for(var r$T=0,r$U=r$S.length;r$T<r$U;++r$T)r$TQ.min(r$e,r$S[r$T],r$e),r$TQ.max(r$l,r$S[r$T],r$l)},r$S.merge=function(r$S,r$Q,r$e){r$TQ.min(r$S.min,r$Q.min,r$e.min),r$TQ.max(r$S.max,r$Q.max,r$e.max)},r$S}(),r$VS=function(){function r$R(r$S){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=r$S,this._near=new r$QQ(new r$TQ),this._far=new r$QQ(new r$TQ),this._left=new r$QQ(new r$TQ),this._right=new r$QQ(new r$TQ),this._top=new r$QQ(new r$TQ),this._bottom=new r$QQ(new r$TQ),r$R._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}r$J(r$R,"laya.d3.math.BoundFrustum");var r$S=r$R.prototype;return r$S.equalsBoundFrustum=function(r$S){return this._matrix.equalsOtherMatrix(r$S.matrix)},r$S.equalsObj=function(r$S){if(r$S instanceof laya.d3.math.BoundFrustum){var r$Q=r$S;return this.equalsBoundFrustum(r$Q)}return!1},r$S.getPlane=function(r$S){switch(r$S){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},r$S.getCorners=function(r$S){r$R._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(r$S[0]),r$R._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(r$S[1]),r$R._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(r$S[2]),r$R._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(r$S[3]),r$R._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(r$S[4]),r$R._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(r$S[5]),r$R._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(r$S[6]),r$R._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(r$S[7])},r$S.containsPoint=function(r$S){for(var r$Q=r$QQ.PlaneIntersectionType_Front,r$e=r$QQ.PlaneIntersectionType_Front,r$l=0;r$l<6;r$l++){switch(r$l){case 0:r$e=Collision.intersectsPlaneAndPoint(this._near,r$S);break;case 1:r$e=Collision.intersectsPlaneAndPoint(this._far,r$S);break;case 2:r$e=Collision.intersectsPlaneAndPoint(this._left,r$S);break;case 3:r$e=Collision.intersectsPlaneAndPoint(this._right,r$S);break;case 4:r$e=Collision.intersectsPlaneAndPoint(this._top,r$S);break;case 5:r$e=Collision.intersectsPlaneAndPoint(this._bottom,r$S)}switch(r$e){case r$QQ.PlaneIntersectionType_Back:return 0;case r$QQ.PlaneIntersectionType_Intersecting:r$Q=r$QQ.PlaneIntersectionType_Intersecting}}switch(r$Q){case r$QQ.PlaneIntersectionType_Intersecting:return 2;default:return 1}},r$S.containsBoundBox=function(r$S){for(var r$Q,r$e=r$R._tempV30,r$l=r$R._tempV31,r$M=1,r$d=0;r$d<6;r$d++){if(r$Q=this.getPlane(r$d),this._getBoxToPlanePVertexNVertex(r$S,r$Q.normal,r$e,r$l),Collision.intersectsPlaneAndPoint(r$Q,r$e)===r$QQ.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(r$Q,r$l)===r$QQ.PlaneIntersectionType_Back&&(r$M=2)}return r$M},r$S.containsBoundSphere=function(r$S){for(var r$Q=r$QQ.PlaneIntersectionType_Front,r$e=r$QQ.PlaneIntersectionType_Front,r$l=0;r$l<6;r$l++){switch(r$l){case 0:r$e=Collision.intersectsPlaneAndSphere(this._near,r$S);break;case 1:r$e=Collision.intersectsPlaneAndSphere(this._far,r$S);break;case 2:r$e=Collision.intersectsPlaneAndSphere(this._left,r$S);break;case 3:r$e=Collision.intersectsPlaneAndSphere(this._right,r$S);break;case 4:r$e=Collision.intersectsPlaneAndSphere(this._top,r$S);break;case 5:r$e=Collision.intersectsPlaneAndSphere(this._bottom,r$S)}switch(r$e){case r$QQ.PlaneIntersectionType_Back:return 0;case r$QQ.PlaneIntersectionType_Intersecting:r$Q=r$QQ.PlaneIntersectionType_Intersecting}}switch(r$Q){case r$QQ.PlaneIntersectionType_Intersecting:return 2;default:return 1}},r$S._getBoxToPlanePVertexNVertex=function(r$S,r$Q,r$e,r$l){var r$M=r$S.min,r$d=r$M.elements,r$T=r$S.max,r$U=r$T.elements,r$i=r$Q.elements,r$R=r$i[0],r$o=r$i[1],r$Y=r$i[2];r$M.cloneTo(r$e);var r$p=r$e.elements;0<=r$R&&(r$p[0]=r$U[0]),0<=r$o&&(r$p[1]=r$U[1]),0<=r$Y&&(r$p[2]=r$U[2]),r$T.cloneTo(r$l);var r$J=r$l.elements;0<=r$R&&(r$J[0]=r$d[0]),0<=r$o&&(r$J[1]=r$d[1]),0<=r$Y&&(r$J[2]=r$d[2])},r$L(0,r$S,"top",function(){return this._top}),r$L(0,r$S,"matrix",function(){return this._matrix},function(r$S){this._matrix=r$S,r$R._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),r$L(0,r$S,"near",function(){return this._near}),r$L(0,r$S,"far",function(){return this._far}),r$L(0,r$S,"left",function(){return this._left}),r$L(0,r$S,"right",function(){return this._right}),r$L(0,r$S,"bottom",function(){return this._bottom}),r$R._getPlanesFromMatrix=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){var r$U=r$S.elements,r$i=r$U[0],r$R=r$U[1],r$o=r$U[2],r$Y=r$U[3],r$p=r$U[4],r$J=r$U[5],r$L=r$U[6],r$j=r$U[7],r$c=r$U[8],r$G=r$U[9],r$z=r$U[10],r$A=r$U[11],r$v=r$U[12],r$D=r$U[13],r$B=r$U[14],r$O=r$U[15],r$H=r$Q.normal.elements;r$H[0]=r$Y+r$o,r$H[1]=r$j+r$L,r$H[2]=r$A+r$z,r$Q.distance=r$O+r$B,r$Q.normalize();var r$g=r$e.normal.elements;r$g[0]=r$Y-r$o,r$g[1]=r$j-r$L,r$g[2]=r$A-r$z,r$e.distance=r$O-r$B,r$e.normalize();var r$I=r$l.normal.elements;r$I[0]=r$Y+r$i,r$I[1]=r$j+r$p,r$I[2]=r$A+r$c,r$l.distance=r$O+r$v,r$l.normalize();var r$E=r$M.normal.elements;r$E[0]=r$Y-r$i,r$E[1]=r$j-r$p,r$E[2]=r$A-r$c,r$M.distance=r$O-r$v,r$M.normalize();var r$t=r$d.normal.elements;r$t[0]=r$Y-r$R,r$t[1]=r$j-r$J,r$t[2]=r$A-r$G,r$d.distance=r$O-r$D,r$d.normalize();var r$k=r$T.normal.elements;r$k[0]=r$Y+r$R,r$k[1]=r$j+r$J,r$k[2]=r$A+r$G,r$T.distance=r$O+r$D,r$T.normalize()},r$R._get3PlaneInterPoint=function(r$S,r$Q,r$e){var r$l=r$S.normal,r$M=r$Q.normal,r$d=r$e.normal;r$TQ.cross(r$M,r$d,r$R._tempV30),r$TQ.cross(r$d,r$l,r$R._tempV31),r$TQ.cross(r$l,r$M,r$R._tempV32);var r$T=r$TQ.dot(r$l,r$R._tempV30),r$U=r$TQ.dot(r$M,r$R._tempV31),r$i=r$TQ.dot(r$d,r$R._tempV32);return r$TQ.scale(r$R._tempV30,-r$S.distance/r$T,r$R._tempV33),r$TQ.scale(r$R._tempV31,-r$Q.distance/r$U,r$R._tempV34),r$TQ.scale(r$R._tempV32,-r$e.distance/r$i,r$R._tempV35),r$TQ.add(r$R._tempV33,r$R._tempV34,r$R._tempV36),r$TQ.add(r$R._tempV35,r$R._tempV36,r$R._tempV37),r$R._tempV37},r$Y(r$R,["_tempV30",function(){return this._tempV30=new r$TQ},"_tempV31",function(){return this._tempV31=new r$TQ},"_tempV32",function(){return this._tempV32=new r$TQ},"_tempV33",function(){return this._tempV33=new r$TQ},"_tempV34",function(){return this._tempV34=new r$TQ},"_tempV35",function(){return this._tempV35=new r$TQ},"_tempV36",function(){return this._tempV36=new r$TQ},"_tempV37",function(){return this._tempV37=new r$TQ}]),r$R}(),r$_S=function(){function r$o(r$S,r$Q){this.center=null,this.radius=NaN,this.center=r$S,this.radius=r$Q}r$J(r$o,"laya.d3.math.BoundSphere");var r$S=r$o.prototype;return r$D.imps(r$S,{"laya.d3.core.IClone":!0}),r$S.toDefault=function(){this.center.toDefault(),this.radius=0},r$S.intersectsRayDistance=function(r$S){return Collision.intersectsRayAndSphereRD(r$S,this)},r$S.intersectsRayPoint=function(r$S,r$Q){return Collision.intersectsRayAndSphereRP(r$S,this,r$Q)},r$S.cloneTo=function(r$S){var r$Q=r$S;this.center.cloneTo(r$Q.center),r$Q.radius=this.radius},r$S.clone=function(){var r$S=new this.constructor(new r$TQ,new r$TQ);return this.cloneTo(r$S),r$S},r$o.createFromSubPoints=function(r$S,r$Q,r$e,r$l){if(null==r$S)throw new Error("points");if(r$Q<0||r$Q>=r$S.length)throw new Error("start"+r$Q+"Must be in the range [0, "+(r$S.length-1)+"]");if(r$e<0||r$Q+r$e>r$S.length)throw new Error("count"+r$e+"Must be in the range <= "+r$S.length+"}");var r$M=r$Q+r$e,r$d=r$o._tempVector3;r$d.elements[0]=0,r$d.elements[1]=0,r$d.elements[2]=0;for(var r$T=r$Q;r$T<r$M;++r$T)r$TQ.add(r$S[r$T],r$d,r$d);var r$U=r$l.center;r$TQ.scale(r$d,1/r$e,r$U);var r$i=0;for(r$T=r$Q;r$T<r$M;++r$T){var r$R=r$TQ.distanceSquared(r$U,r$S[r$T]);r$i<r$R&&(r$i=r$R)}r$l.radius=Math.sqrt(r$i)},r$o.createfromPoints=function(r$S,r$Q){if(null==r$S)throw new Error("points");r$o.createFromSubPoints(r$S,0,r$S.length,r$Q)},r$Y(r$o,["_tempVector3",function(){return this._tempVector3=new r$TQ}]),r$o}(),r$sS=(function(){function r$S(){}r$J(r$S,"laya.d3.math.ContainmentType"),r$S.Disjoint=0,r$S.Contains=1,r$S.Intersects=2}(),function(){function r$e(){}return r$J(r$e,"laya.d3.math.MathUtils3D"),r$e.isZero=function(r$S){return Math.abs(r$S)<r$e.zeroTolerance},r$e.nearEqual=function(r$S,r$Q){return!!r$e.isZero(r$S-r$Q)},r$e.fastInvSqrt=function(r$S){return r$e.isZero(r$S)?r$S:1/Math.sqrt(r$S)},r$Y(r$e,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),r$e}()),r$yS=function(){function r$i(){var r$S=this.elements=new Float32Array(9);r$S[0]=1,r$S[1]=0,r$S[2]=0,r$S[3]=0,r$S[4]=1,r$S[5]=0,r$S[6]=0,r$S[7]=0,r$S[8]=1}r$J(r$i,"laya.d3.math.Matrix3x3");var r$S=r$i.prototype;return r$D.imps(r$S,{"laya.d3.core.IClone":!0}),r$S.determinant=function(){var r$S=this.elements,r$Q=r$S[0],r$e=r$S[1],r$l=r$S[2],r$M=r$S[3],r$d=r$S[4],r$T=r$S[5],r$U=r$S[6],r$i=r$S[7],r$R=r$S[8];return r$Q*(r$R*r$d-r$T*r$i)+r$e*(-r$R*r$M+r$T*r$U)+r$l*(r$i*r$M-r$d*r$U)},r$S.translate=function(r$S,r$Q){var r$e=r$Q.elements,r$l=this.elements,r$M=r$S.elements,r$d=r$l[0],r$T=r$l[1],r$U=r$l[2],r$i=r$l[3],r$R=r$l[4],r$o=r$l[5],r$Y=r$l[6],r$p=r$l[7],r$J=r$l[8],r$L=r$M[0],r$j=r$M[1];r$e[0]=r$d,r$e[1]=r$T,r$e[2]=r$U,r$e[3]=r$i,r$e[4]=r$R,r$e[5]=r$o,r$e[6]=r$L*r$d+r$j*r$i+r$Y,r$e[7]=r$L*r$T+r$j*r$R+r$p,r$e[8]=r$L*r$U+r$j*r$o+r$J},r$S.rotate=function(r$S,r$Q){var r$e=r$Q.elements,r$l=this.elements,r$M=r$l[0],r$d=r$l[1],r$T=r$l[2],r$U=r$l[3],r$i=r$l[4],r$R=r$l[5],r$o=r$l[6],r$Y=r$l[7],r$p=r$l[8],r$J=Math.sin(r$S),r$L=Math.cos(r$S);r$e[0]=r$L*r$M+r$J*r$U,r$e[1]=r$L*r$d+r$J*r$i,r$e[2]=r$L*r$T+r$J*r$R,r$e[3]=r$L*r$U-r$J*r$M,r$e[4]=r$L*r$i-r$J*r$d,r$e[5]=r$L*r$R-r$J*r$T,r$e[6]=r$o,r$e[7]=r$Y,r$e[8]=r$p},r$S.scale=function(r$S,r$Q){var r$e=r$Q.elements,r$l=this.elements,r$M=r$S.elements,r$d=r$M[0],r$T=r$M[1];r$e[0]=r$d*r$l[0],r$e[1]=r$d*r$l[1],r$e[2]=r$d*r$l[2],r$e[3]=r$T*r$l[3],r$e[4]=r$T*r$l[4],r$e[5]=r$T*r$l[5],r$e[6]=r$l[6],r$e[7]=r$l[7],r$e[8]=r$l[8]},r$S.invert=function(r$S){var r$Q=r$S.elements,r$e=this.elements,r$l=r$e[0],r$M=r$e[1],r$d=r$e[2],r$T=r$e[3],r$U=r$e[4],r$i=r$e[5],r$R=r$e[6],r$o=r$e[7],r$Y=r$e[8],r$p=r$Y*r$U-r$i*r$o,r$J=-r$Y*r$T+r$i*r$R,r$L=r$o*r$T-r$U*r$R,r$j=r$l*r$p+r$M*r$J+r$d*r$L;r$j||(r$S=null),r$j=1/r$j,r$Q[0]=r$p*r$j,r$Q[1]=(-r$Y*r$M+r$d*r$o)*r$j,r$Q[2]=(r$i*r$M-r$d*r$U)*r$j,r$Q[3]=r$J*r$j,r$Q[4]=(r$Y*r$l-r$d*r$R)*r$j,r$Q[5]=(-r$i*r$l+r$d*r$T)*r$j,r$Q[6]=r$L*r$j,r$Q[7]=(-r$o*r$l+r$M*r$R)*r$j,r$Q[8]=(r$U*r$l-r$M*r$T)*r$j},r$S.transpose=function(r$S){var r$Q=r$S.elements,r$e=this.elements;if(r$S===this){var r$l=r$e[1],r$M=r$e[2],r$d=r$e[5];r$Q[1]=r$e[3],r$Q[2]=r$e[6],r$Q[3]=r$l,r$Q[5]=r$e[7],r$Q[6]=r$M,r$Q[7]=r$d}else r$Q[0]=r$e[0],r$Q[1]=r$e[3],r$Q[2]=r$e[6],r$Q[3]=r$e[1],r$Q[4]=r$e[4],r$Q[5]=r$e[7],r$Q[6]=r$e[2],r$Q[7]=r$e[5],r$Q[8]=r$e[8]},r$S.identity=function(){var r$S=this.elements;r$S[0]=1,r$S[1]=0,r$S[2]=0,r$S[3]=0,r$S[4]=1,r$S[5]=0,r$S[6]=0,r$S[7]=0,r$S[8]=1},r$S.cloneTo=function(r$S){var r$Q,r$e,r$l;if((r$e=this.elements)!==(r$l=r$S.elements))for(r$Q=0;r$Q<9;++r$Q)r$l[r$Q]=r$e[r$Q]},r$S.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$i.createFromTranslation=function(r$S,r$Q){r$Q.elements;var r$e=r$S.elements;r$Q[0]=1,r$Q[1]=0,r$Q[2]=0,r$Q[3]=0,r$Q[4]=1,r$Q[5]=0,r$Q[6]=r$e[0],r$Q[7]=r$e[1],r$Q[8]=1},r$i.createFromRotation=function(r$S,r$Q){var r$e=r$Q.elements,r$l=Math.sin(r$S),r$M=Math.cos(r$S);r$e[0]=r$M,r$e[1]=r$l,r$e[2]=0,r$e[3]=-r$l,r$e[4]=r$M,r$e[5]=0,r$e[6]=0,r$e[7]=0,r$e[8]=1},r$i.createFromScaling=function(r$S,r$Q){var r$e=r$Q.elements,r$l=r$S.elements;r$e[0]=r$l[0],r$e[1]=0,r$e[2]=0,r$e[3]=0,r$e[4]=r$l[1],r$e[5]=0,r$e[6]=0,r$e[7]=0,r$e[8]=1},r$i.createFromMatrix4x4=function(r$S,r$Q){r$Q[0]=r$S[0],r$Q[1]=r$S[1],r$Q[2]=r$S[2],r$Q[3]=r$S[4],r$Q[4]=r$S[5],r$Q[5]=r$S[6],r$Q[6]=r$S[8],r$Q[7]=r$S[9],r$Q[8]=r$S[10]},r$i.multiply=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q.elements,r$T=r$M[0],r$U=r$M[1],r$i=r$M[2],r$R=r$M[3],r$o=r$M[4],r$Y=r$M[5],r$p=r$M[6],r$J=r$M[7],r$L=r$M[8],r$j=r$d[0],r$c=r$d[1],r$G=r$d[2],r$z=r$d[3],r$A=r$d[4],r$v=r$d[5],r$D=r$d[6],r$B=r$d[7],r$O=r$d[8];r$l[0]=r$j*r$T+r$c*r$R+r$G*r$p,r$l[1]=r$j*r$U+r$c*r$o+r$G*r$J,r$l[2]=r$j*r$i+r$c*r$Y+r$G*r$L,r$l[3]=r$z*r$T+r$A*r$R+r$v*r$p,r$l[4]=r$z*r$U+r$A*r$o+r$v*r$J,r$l[5]=r$z*r$i+r$A*r$Y+r$v*r$L,r$l[6]=r$D*r$T+r$B*r$R+r$O*r$p,r$l[7]=r$D*r$U+r$B*r$o+r$O*r$J,r$l[8]=r$D*r$i+r$B*r$Y+r$O*r$L},r$i.lookAt=function(r$S,r$Q,r$e,r$l){r$TQ.subtract(r$S,r$Q,r$i._tempV30),r$TQ.normalize(r$i._tempV30,r$i._tempV30),r$TQ.cross(r$e,r$i._tempV30,r$i._tempV31),r$TQ.normalize(r$i._tempV31,r$i._tempV31),r$TQ.cross(r$i._tempV30,r$i._tempV31,r$i._tempV32);var r$M=r$i._tempV30.elements,r$d=r$i._tempV31.elements,r$T=r$i._tempV32.elements,r$U=r$l.elements;r$U[0]=r$d[0],r$U[3]=r$d[1],r$U[6]=r$d[2],r$U[1]=r$T[0],r$U[4]=r$T[1],r$U[7]=r$T[2],r$U[2]=r$M[0],r$U[5]=r$M[1],r$U[8]=r$M[2]},r$i.DEFAULT=new r$i,r$Y(r$i,["_tempV30",function(){return this._tempV30=new r$TQ},"_tempV31",function(){return this._tempV31=new r$TQ},"_tempV32",function(){return this._tempV32=new r$TQ}]),r$i}(),r$SQ=function(){function r$g(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o,r$Y,r$p,r$J,r$L,r$j){void 0===r$S&&(r$S=1),void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=0),void 0===r$M&&(r$M=0),void 0===r$d&&(r$d=1),void 0===r$T&&(r$T=0),void 0===r$U&&(r$U=0),void 0===r$i&&(r$i=0),void 0===r$R&&(r$R=0),void 0===r$o&&(r$o=1),void 0===r$Y&&(r$Y=0),void 0===r$p&&(r$p=0),void 0===r$J&&(r$J=0),void 0===r$L&&(r$L=0),void 0===r$j&&(r$j=1);var r$c=this.elements=new Float32Array(16);r$c[0]=r$S,r$c[1]=r$Q,r$c[2]=r$e,r$c[3]=r$l,r$c[4]=r$M,r$c[5]=r$d,r$c[6]=r$T,r$c[7]=r$U,r$c[8]=r$i,r$c[9]=r$R,r$c[10]=r$o,r$c[11]=r$Y,r$c[12]=r$p,r$c[13]=r$J,r$c[14]=r$L,r$c[15]=r$j}r$J(r$g,"laya.d3.math.Matrix4x4");var r$S=r$g.prototype;return r$D.imps(r$S,{"laya.d3.core.IClone":!0}),r$S.getElementByRowColumn=function(r$S,r$Q){if(r$S<0||3<r$S)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(r$Q<0||3<r$Q)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*r$S+r$Q]},r$S.setElementByRowColumn=function(r$S,r$Q,r$e){if(r$S<0||3<r$S)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(r$Q<0||3<r$Q)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*r$S+r$Q]=r$e},r$S.equalsOtherMatrix=function(r$S){var r$Q=this.elements,r$e=r$S.elements;return r$sS.nearEqual(r$Q[0],r$e[0])&&r$sS.nearEqual(r$Q[1],r$e[1])&&r$sS.nearEqual(r$Q[2],r$e[2])&&r$sS.nearEqual(r$Q[3],r$e[3])&&r$sS.nearEqual(r$Q[4],r$e[4])&&r$sS.nearEqual(r$Q[5],r$e[5])&&r$sS.nearEqual(r$Q[6],r$e[6])&&r$sS.nearEqual(r$Q[7],r$e[7])&&r$sS.nearEqual(r$Q[8],r$e[8])&&r$sS.nearEqual(r$Q[9],r$e[9])&&r$sS.nearEqual(r$Q[10],r$e[10])&&r$sS.nearEqual(r$Q[11],r$e[11])&&r$sS.nearEqual(r$Q[12],r$e[12])&&r$sS.nearEqual(r$Q[13],r$e[13])&&r$sS.nearEqual(r$Q[14],r$e[14])&&r$sS.nearEqual(r$Q[15],r$e[15])},r$S.decomposeTransRotScale=function(r$S,r$Q,r$e){var r$l=r$g._tempMatrix4x4;return this.decomposeTransRotMatScale(r$S,r$l,r$e)?(r$eQ.createFromMatrix4x4(r$l,r$Q),!0):(r$Q.identity(),!1)},r$S.decomposeTransRotMatScale=function(r$S,r$Q,r$e){var r$l=this.elements,r$M=r$S.elements,r$d=r$Q.elements,r$T=r$e.elements;r$M[0]=r$l[12],r$M[1]=r$l[13],r$M[2]=r$l[14];var r$U=r$l[0],r$i=r$l[1],r$R=r$l[2],r$o=r$l[4],r$Y=r$l[5],r$p=r$l[6],r$J=r$l[8],r$L=r$l[9],r$j=r$l[10],r$c=r$T[0]=Math.sqrt(r$U*r$U+r$i*r$i+r$R*r$R),r$G=r$T[1]=Math.sqrt(r$o*r$o+r$Y*r$Y+r$p*r$p),r$z=r$T[2]=Math.sqrt(r$J*r$J+r$L*r$L+r$j*r$j);if(r$sS.isZero(r$c)||r$sS.isZero(r$G)||r$sS.isZero(r$z))return r$d[1]=r$d[2]=r$d[3]=r$d[4]=r$d[6]=r$d[7]=r$d[8]=r$d[9]=r$d[11]=r$d[12]=r$d[13]=r$d[14]=0,r$d[0]=r$d[5]=r$d[10]=r$d[15]=1,!1;var r$A=r$g._tempVector0,r$v=r$A.elements;r$v[0]=r$J/r$z,r$v[1]=r$L/r$z,r$v[2]=r$j/r$z;var r$D=r$g._tempVector1,r$B=r$D.elements;r$B[0]=r$U/r$c,r$B[1]=r$i/r$c,r$B[2]=r$R/r$c;var r$O=r$g._tempVector2;r$TQ.cross(r$A,r$D,r$O);var r$H=r$g._tempVector1;return r$TQ.cross(r$O,r$A,r$H),r$d[3]=r$d[7]=r$d[11]=r$d[12]=r$d[13]=r$d[14]=0,r$d[15]=1,r$d[0]=r$H.x,r$d[1]=r$H.y,r$d[2]=r$H.z,r$d[4]=r$O.x,r$d[5]=r$O.y,r$d[6]=r$O.z,r$d[8]=r$A.x,r$d[9]=r$A.y,r$d[10]=r$A.z,r$d[0]*r$U+r$d[1]*r$i+r$d[2]*r$R<0&&(r$T[0]=-r$c),r$d[4]*r$o+r$d[5]*r$Y+r$d[6]*r$p<0&&(r$T[1]=-r$G),r$d[8]*r$J+r$d[9]*r$L+r$d[10]*r$j<0&&(r$T[2]=-r$z),!0},r$S.decomposeYawPitchRoll=function(r$S){var r$Q=r$S.elements,r$e=Math.asin(-this.elements[9]);r$Q[1]=r$e,Math.cos(r$e)>r$sS.zeroTolerance?(r$Q[2]=Math.atan2(this.elements[1],this.elements[5]),r$Q[0]=Math.atan2(this.elements[8],this.elements[10])):(r$Q[2]=Math.atan2(-this.elements[4],this.elements[0]),r$Q[0]=0)},r$S.normalize=function(){var r$S=this.elements,r$Q=r$S[0],r$e=r$S[1],r$l=r$S[2],r$M=Math.sqrt(r$Q*r$Q+r$e*r$e+r$l*r$l);if(!r$M)return r$S[0]=0,r$S[1]=0,void(r$S[2]=0);1!=r$M&&(r$M=1/r$M,r$S[0]=r$Q*r$M,r$S[1]=r$e*r$M,r$S[2]=r$l*r$M)},r$S.transpose=function(){var r$S,r$Q;return r$Q=(r$S=this.elements)[1],r$S[1]=r$S[4],r$S[4]=r$Q,r$Q=r$S[2],r$S[2]=r$S[8],r$S[8]=r$Q,r$Q=r$S[3],r$S[3]=r$S[12],r$S[12]=r$Q,r$Q=r$S[6],r$S[6]=r$S[9],r$S[9]=r$Q,r$Q=r$S[7],r$S[7]=r$S[13],r$S[13]=r$Q,r$Q=r$S[11],r$S[11]=r$S[14],r$S[14]=r$Q,this},r$S.invert=function(r$S){var r$Q=this.elements,r$e=r$S.elements,r$l=r$Q[0],r$M=r$Q[1],r$d=r$Q[2],r$T=r$Q[3],r$U=r$Q[4],r$i=r$Q[5],r$R=r$Q[6],r$o=r$Q[7],r$Y=r$Q[8],r$p=r$Q[9],r$J=r$Q[10],r$L=r$Q[11],r$j=r$Q[12],r$c=r$Q[13],r$G=r$Q[14],r$z=r$Q[15],r$A=r$l*r$i-r$M*r$U,r$v=r$l*r$R-r$d*r$U,r$D=r$l*r$o-r$T*r$U,r$B=r$M*r$R-r$d*r$i,r$O=r$M*r$o-r$T*r$i,r$H=r$d*r$o-r$T*r$R,r$g=r$Y*r$c-r$p*r$j,r$I=r$Y*r$G-r$J*r$j,r$E=r$Y*r$z-r$L*r$j,r$t=r$p*r$G-r$J*r$c,r$k=r$p*r$z-r$L*r$c,r$X=r$J*r$z-r$L*r$G,r$h=r$A*r$X-r$v*r$k+r$D*r$t+r$B*r$E-r$O*r$I+r$H*r$g;0!==Math.abs(r$h)&&(r$h=1/r$h,r$e[0]=(r$i*r$X-r$R*r$k+r$o*r$t)*r$h,r$e[1]=(r$d*r$k-r$M*r$X-r$T*r$t)*r$h,r$e[2]=(r$c*r$H-r$G*r$O+r$z*r$B)*r$h,r$e[3]=(r$J*r$O-r$p*r$H-r$L*r$B)*r$h,r$e[4]=(r$R*r$E-r$U*r$X-r$o*r$I)*r$h,r$e[5]=(r$l*r$X-r$d*r$E+r$T*r$I)*r$h,r$e[6]=(r$G*r$D-r$j*r$H-r$z*r$v)*r$h,r$e[7]=(r$Y*r$H-r$J*r$D+r$L*r$v)*r$h,r$e[8]=(r$U*r$k-r$i*r$E+r$o*r$g)*r$h,r$e[9]=(r$M*r$E-r$l*r$k-r$T*r$g)*r$h,r$e[10]=(r$j*r$O-r$c*r$D+r$z*r$A)*r$h,r$e[11]=(r$p*r$D-r$Y*r$O-r$L*r$A)*r$h,r$e[12]=(r$i*r$I-r$U*r$t-r$R*r$g)*r$h,r$e[13]=(r$l*r$t-r$M*r$I+r$d*r$g)*r$h,r$e[14]=(r$c*r$v-r$j*r$B-r$G*r$A)*r$h,r$e[15]=(r$Y*r$B-r$p*r$v+r$J*r$A)*r$h)},r$S.identity=function(){var r$S=this.elements;r$S[1]=r$S[2]=r$S[3]=r$S[4]=r$S[6]=r$S[7]=r$S[8]=r$S[9]=r$S[11]=r$S[12]=r$S[13]=r$S[14]=0,r$S[0]=r$S[5]=r$S[10]=r$S[15]=1},r$S.cloneTo=function(r$S){var r$Q,r$e,r$l;if((r$e=this.elements)!==(r$l=r$S.elements))for(r$Q=0;r$Q<16;++r$Q)r$l[r$Q]=r$e[r$Q]},r$S.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$S.getTranslationVector=function(r$S){var r$Q=this.elements,r$e=r$S.elements;r$e[0]=r$Q[12],r$e[1]=r$Q[13],r$e[2]=r$Q[14]},r$S.setTranslationVector=function(r$S){var r$Q=this.elements,r$e=r$S.elements;r$Q[12]=r$e[0],r$Q[13]=r$e[1],r$Q[14]=r$e[2]},r$S.getForward=function(r$S){var r$Q=this.elements,r$e=r$S.elements;r$e[0]=-r$Q[8],r$e[1]=-r$Q[9],r$e[2]=-r$Q[10]},r$S.setForward=function(r$S){var r$Q=this.elements,r$e=r$S.elements;r$Q[8]=-r$e[0],r$Q[9]=-r$e[1],r$Q[10]=-r$e[2]},r$g.createRotationX=function(r$S,r$Q){var r$e=r$Q.elements,r$l=Math.sin(r$S),r$M=Math.cos(r$S);r$e[1]=r$e[2]=r$e[3]=r$e[4]=r$e[7]=r$e[8]=r$e[11]=r$e[12]=r$e[13]=r$e[14]=0,r$e[0]=r$e[15]=1,r$e[5]=r$e[10]=r$M,r$e[6]=r$l,r$e[9]=-r$l},r$g.createRotationY=function(r$S,r$Q){var r$e=r$Q.elements,r$l=Math.sin(r$S),r$M=Math.cos(r$S);r$e[1]=r$e[3]=r$e[4]=r$e[6]=r$e[7]=r$e[9]=r$e[11]=r$e[12]=r$e[13]=r$e[14]=0,r$e[5]=r$e[15]=1,r$e[0]=r$e[10]=r$M,r$e[2]=-r$l,r$e[8]=r$l},r$g.createRotationZ=function(r$S,r$Q){var r$e=r$Q.elements,r$l=Math.sin(r$S),r$M=Math.cos(r$S);r$e[2]=r$e[3]=r$e[6]=r$e[7]=r$e[8]=r$e[9]=r$e[11]=r$e[12]=r$e[13]=r$e[14]=0,r$e[10]=r$e[15]=1,r$e[0]=r$e[5]=r$M,r$e[1]=r$l,r$e[4]=-r$l},r$g.createRotationYawPitchRoll=function(r$S,r$Q,r$e,r$l){r$eQ.createFromYawPitchRoll(r$S,r$Q,r$e,r$g._tempQuaternion),r$g.createRotationQuaternion(r$g._tempQuaternion,r$l)},r$g.createRotationAxis=function(r$S,r$Q,r$e){var r$l=r$S.elements,r$M=r$l[0],r$d=r$l[1],r$T=r$l[2],r$U=Math.cos(r$Q),r$i=Math.sin(r$Q),r$R=r$M*r$M,r$o=r$d*r$d,r$Y=r$T*r$T,r$p=r$M*r$d,r$J=r$M*r$T,r$L=r$d*r$T,r$j=r$e.elements;r$j[3]=r$j[7]=r$j[11]=r$j[12]=r$j[13]=r$j[14]=0,r$j[15]=1,r$j[0]=r$R+r$U*(1-r$R),r$j[1]=r$p-r$U*r$p+r$i*r$T,r$j[2]=r$J-r$U*r$J-r$i*r$d,r$j[4]=r$p-r$U*r$p-r$i*r$T,r$j[5]=r$o+r$U*(1-r$o),r$j[6]=r$L-r$U*r$L+r$i*r$M,r$j[8]=r$J-r$U*r$J+r$i*r$d,r$j[9]=r$L-r$U*r$L-r$i*r$M,r$j[10]=r$Y+r$U*(1-r$Y)},r$g.createRotationQuaternion=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements,r$M=r$e[0],r$d=r$e[1],r$T=r$e[2],r$U=r$e[3],r$i=r$M*r$M,r$R=r$d*r$d,r$o=r$T*r$T,r$Y=r$M*r$d,r$p=r$T*r$U,r$J=r$T*r$M,r$L=r$d*r$U,r$j=r$d*r$T,r$c=r$M*r$U;r$l[3]=r$l[7]=r$l[11]=r$l[12]=r$l[13]=r$l[14]=0,r$l[15]=1,r$l[0]=1-2*(r$R+r$o),r$l[1]=2*(r$Y+r$p),r$l[2]=2*(r$J-r$L),r$l[4]=2*(r$Y-r$p),r$l[5]=1-2*(r$o+r$i),r$l[6]=2*(r$j+r$c),r$l[8]=2*(r$J+r$L),r$l[9]=2*(r$j-r$c),r$l[10]=1-2*(r$R+r$i)},r$g.createTranslate=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements;r$l[4]=r$l[8]=r$l[1]=r$l[9]=r$l[2]=r$l[6]=r$l[3]=r$l[7]=r$l[11]=0,r$l[0]=r$l[5]=r$l[10]=r$l[15]=1,r$l[12]=r$e[0],r$l[13]=r$e[1],r$l[14]=r$e[2]},r$g.createScaling=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements;r$l[0]=r$e[0],r$l[5]=r$e[1],r$l[10]=r$e[2],r$l[1]=r$l[4]=r$l[8]=r$l[12]=r$l[9]=r$l[13]=r$l[2]=r$l[6]=r$l[14]=r$l[3]=r$l[7]=r$l[11]=0,r$l[15]=1},r$g.multiply=function(r$S,r$Q,r$e){var r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o;for(r$M=r$e.elements,r$d=r$S.elements,r$M===(r$T=r$Q.elements)&&(r$T=r$T.slice()),r$l=0;r$l<4;r$l++)r$U=r$d[r$l],r$i=r$d[r$l+4],r$R=r$d[r$l+8],r$o=r$d[r$l+12],r$M[r$l]=r$U*r$T[0]+r$i*r$T[1]+r$R*r$T[2]+r$o*r$T[3],r$M[r$l+4]=r$U*r$T[4]+r$i*r$T[5]+r$R*r$T[6]+r$o*r$T[7],r$M[r$l+8]=r$U*r$T[8]+r$i*r$T[9]+r$R*r$T[10]+r$o*r$T[11],r$M[r$l+12]=r$U*r$T[12]+r$i*r$T[13]+r$R*r$T[14]+r$o*r$T[15]},r$g.createFromQuaternion=function(r$S,r$Q){var r$e=r$Q.elements,r$l=r$S.elements,r$M=r$l[0],r$d=r$l[1],r$T=r$l[2],r$U=r$l[3],r$i=r$M+r$M,r$R=r$d+r$d,r$o=r$T+r$T,r$Y=r$M*r$i,r$p=r$d*r$i,r$J=r$d*r$R,r$L=r$T*r$i,r$j=r$T*r$R,r$c=r$T*r$o,r$G=r$U*r$i,r$z=r$U*r$R,r$A=r$U*r$o;r$e[0]=1-r$J-r$c,r$e[1]=r$p+r$A,r$e[2]=r$L-r$z,r$e[3]=0,r$e[4]=r$p-r$A,r$e[5]=1-r$Y-r$c,r$e[6]=r$j+r$G,r$e[7]=0,r$e[8]=r$L+r$z,r$e[9]=r$j-r$G,r$e[10]=1-r$Y-r$J,r$e[11]=0,r$e[12]=0,r$e[13]=0,r$e[14]=0,r$e[15]=1},r$g.createAffineTransformation=function(r$S,r$Q,r$e,r$l){var r$M=r$S.elements,r$d=r$Q.elements,r$T=r$e.elements,r$U=r$l.elements,r$i=r$d[0],r$R=r$d[1],r$o=r$d[2],r$Y=r$d[3],r$p=r$i+r$i,r$J=r$R+r$R,r$L=r$o+r$o,r$j=r$i*r$p,r$c=r$i*r$J,r$G=r$i*r$L,r$z=r$R*r$J,r$A=r$R*r$L,r$v=r$o*r$L,r$D=r$Y*r$p,r$B=r$Y*r$J,r$O=r$Y*r$L,r$H=r$T[0],r$g=r$T[1],r$I=r$T[2];r$U[0]=(1-(r$z+r$v))*r$H,r$U[1]=(r$c+r$O)*r$H,r$U[2]=(r$G-r$B)*r$H,r$U[3]=0,r$U[4]=(r$c-r$O)*r$g,r$U[5]=(1-(r$j+r$v))*r$g,r$U[6]=(r$A+r$D)*r$g,r$U[7]=0,r$U[8]=(r$G+r$B)*r$I,r$U[9]=(r$A-r$D)*r$I,r$U[10]=(1-(r$j+r$z))*r$I,r$U[11]=0,r$U[12]=r$M[0],r$U[13]=r$M[1],r$U[14]=r$M[2],r$U[15]=1},r$g.createLookAt=function(r$S,r$Q,r$e,r$l){var r$M=r$l.elements,r$d=r$g._tempVector0,r$T=r$g._tempVector1,r$U=r$g._tempVector2;r$TQ.subtract(r$S,r$Q,r$U),r$TQ.normalize(r$U,r$U),r$TQ.cross(r$e,r$U,r$d),r$TQ.normalize(r$d,r$d),r$TQ.cross(r$U,r$d,r$T),r$l.identity(),r$M[0]=r$d.x,r$M[4]=r$d.y,r$M[8]=r$d.z,r$M[1]=r$T.x,r$M[5]=r$T.y,r$M[9]=r$T.z,r$M[2]=r$U.x,r$M[6]=r$U.y,r$M[10]=r$U.z,r$M[12]=-r$TQ.dot(r$d,r$S),r$M[13]=-r$TQ.dot(r$T,r$S),r$M[14]=-r$TQ.dot(r$U,r$S)},r$g.createPerspective=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$M.elements,r$T=1/Math.tan(r$S/2),r$U=1/(r$e-r$l);r$d[0]=r$T/r$Q,r$d[5]=r$T,r$d[10]=(r$l+r$e)*r$U,r$d[11]=-1,r$d[14]=2*r$l*r$e*r$U,r$d[1]=r$d[2]=r$d[3]=r$d[4]=r$d[6]=r$d[7]=r$d[8]=r$d[9]=r$d[12]=r$d[13]=r$d[15]=0},r$g.createOrthoOffCenterRH=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){var r$U=r$T.elements,r$i=1/(r$S-r$Q),r$R=1/(r$e-r$l),r$o=1/(r$M-r$d);r$U[1]=r$U[2]=r$U[3]=r$U[4]=r$U[6]=r$U[7]=r$U[8]=r$U[9]=r$U[11]=0,r$U[15]=1,r$U[0]=-2*r$i,r$U[5]=-2*r$R,r$U[10]=2*r$o,r$U[12]=(r$S+r$Q)*r$i,r$U[13]=(r$l+r$e)*r$R,r$U[14]=(r$d+r$M)*r$o},r$g.translation=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements;r$l[0]=r$l[5]=r$l[10]=r$l[15]=1,r$l[12]=r$e[0],r$l[13]=r$e[1],r$l[14]=r$e[2]},r$Y(r$g,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new r$g},"_tempVector0",function(){return this._tempVector0=new r$TQ},"_tempVector1",function(){return this._tempVector1=new r$TQ},"_tempVector2",function(){return this._tempVector2=new r$TQ},"_tempQuaternion",function(){return this._tempQuaternion=new r$eQ},"DEFAULT",function(){return this.DEFAULT=new r$g},"ZERO",function(){return this.ZERO=new r$g(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),r$g}(),r$QQ=(function(){function r$A(r$S,r$Q){this.extents=null,this.transformation=null,this.extents=r$S,this.transformation=r$Q}r$J(r$A,"laya.d3.math.OrientedBoundBox");var r$S=r$A.prototype;r$S.getCorners=function(r$S){var r$Q=r$A._tempV30.elements,r$e=r$A._tempV31.elements,r$l=r$A._tempV32.elements,r$M=this.extents.elements;r$Q[0]=r$M[0],r$Q[1]=r$Q[2]=0,r$e[1]=r$M[1],r$e[0]=r$e[2]=0,r$l[2]=r$M[2],r$l[0]=r$l[1]=0,r$TQ.TransformNormal(r$A._tempV30,this.transformation,r$A._tempV30),r$TQ.TransformNormal(r$A._tempV31,this.transformation,r$A._tempV31),r$TQ.TransformNormal(r$A._tempV32,this.transformation,r$A._tempV32);var r$d=r$A._tempV33;this.transformation.getTranslationVector(r$d),r$S.length=8,r$TQ.add(r$d,r$A._tempV30,r$A._tempV34),r$TQ.add(r$A._tempV34,r$A._tempV31,r$A._tempV34),r$TQ.add(r$A._tempV34,r$A._tempV32,r$S[0]),r$TQ.add(r$d,r$A._tempV30,r$A._tempV34),r$TQ.add(r$A._tempV34,r$A._tempV31,r$A._tempV34),r$TQ.subtract(r$A._tempV34,r$A._tempV32,r$S[1]),r$TQ.subtract(r$d,r$A._tempV30,r$A._tempV34),r$TQ.add(r$A._tempV34,r$A._tempV31,r$A._tempV34),r$TQ.subtract(r$A._tempV34,r$A._tempV32,r$S[2]),r$TQ.subtract(r$d,r$A._tempV30,r$A._tempV34),r$TQ.add(r$A._tempV34,r$A._tempV31,r$A._tempV34),r$TQ.add(r$A._tempV34,r$A._tempV32,r$S[3]),r$TQ.add(r$d,r$A._tempV30,r$A._tempV34),r$TQ.subtract(r$A._tempV34,r$A._tempV31,r$A._tempV34),r$TQ.add(r$A._tempV34,r$A._tempV32,r$S[4]),r$TQ.add(r$d,r$A._tempV30,r$A._tempV34),r$TQ.subtract(r$A._tempV34,r$A._tempV31,r$A._tempV34),r$TQ.subtract(r$A._tempV34,r$A._tempV32,r$S[5]),r$TQ.subtract(r$d,r$A._tempV30,r$A._tempV34),r$TQ.subtract(r$A._tempV34,r$A._tempV31,r$A._tempV34),r$TQ.subtract(r$A._tempV34,r$A._tempV32,r$S[6]),r$TQ.subtract(r$d,r$A._tempV30,r$A._tempV34),r$TQ.subtract(r$A._tempV34,r$A._tempV31,r$A._tempV34),r$TQ.add(r$A._tempV34,r$A._tempV32,r$S[7])},r$S.transform=function(r$S){r$SQ.multiply(this.transformation,r$S,this.transformation)},r$S.scale=function(r$S){r$TQ.multiply(this.extents,r$S,this.extents)},r$S.translate=function(r$S){this.transformation.getTranslationVector(r$A._tempV30),r$TQ.add(r$A._tempV30,r$S,r$A._tempV31),this.transformation.setTranslationVector(r$A._tempV31)},r$S.Size=function(r$S){r$TQ.scale(this.extents,2,r$S)},r$S.getSize=function(r$S){var r$Q=this.extents.elements;r$A._tempV30.x=r$Q[0],r$A._tempV31.y=r$Q[1],r$A._tempV32.z=r$Q[2],r$TQ.TransformNormal(r$A._tempV30,this.transformation,r$A._tempV30),r$TQ.TransformNormal(r$A._tempV31,this.transformation,r$A._tempV31),r$TQ.TransformNormal(r$A._tempV31,this.transformation,r$A._tempV32);var r$e=r$S.elements;r$e[0]=r$TQ.scalarLength(r$A._tempV30),r$e[1]=r$TQ.scalarLength(r$A._tempV31),r$e[2]=r$TQ.scalarLength(r$A._tempV32)},r$S.getSizeSquared=function(r$S){var r$Q=this.extents.elements;r$A._tempV30.x=r$Q[0],r$A._tempV31.y=r$Q[1],r$A._tempV32.z=r$Q[2],r$TQ.TransformNormal(r$A._tempV30,this.transformation,r$A._tempV30),r$TQ.TransformNormal(r$A._tempV31,this.transformation,r$A._tempV31),r$TQ.TransformNormal(r$A._tempV31,this.transformation,r$A._tempV32);var r$e=r$S.elements;r$e[0]=r$TQ.scalarLengthSquared(r$A._tempV30),r$e[1]=r$TQ.scalarLengthSquared(r$A._tempV31),r$e[2]=r$TQ.scalarLengthSquared(r$A._tempV32)},r$S.getCenter=function(r$S){this.transformation.getTranslationVector(r$S)},r$S.containsPoint=function(r$S){var r$Q=this.extents.elements,r$e=r$Q[0],r$l=r$Q[1],r$M=r$Q[2];this.transformation.invert(r$A._tempM0),r$TQ.transformCoordinate(r$S,r$A._tempM0,r$A._tempV30);var r$d=r$A._tempV30.elements,r$T=Math.abs(r$d[0]),r$U=Math.abs(r$d[1]),r$i=Math.abs(r$d[2]);return r$sS.nearEqual(r$T,r$e)&&r$sS.nearEqual(r$U,r$l)&&r$sS.nearEqual(r$i,r$M)?2:r$T<r$e&&r$U<r$l&&r$i<r$M?1:0},r$S.containsPoints=function(r$S){var r$Q=this.extents.elements,r$e=r$Q[0],r$l=r$Q[1],r$M=r$Q[2];this.transformation.invert(r$A._tempM0);for(var r$d=!0,r$T=!1,r$U=0;r$U<r$S.length;r$U++){r$TQ.transformCoordinate(r$S[r$U],r$A._tempM0,r$A._tempV30);var r$i=r$A._tempV30.elements,r$R=Math.abs(r$i[0]),r$o=Math.abs(r$i[1]),r$Y=Math.abs(r$i[2]);r$sS.nearEqual(r$R,r$e)&&r$sS.nearEqual(r$o,r$l)&&r$sS.nearEqual(r$Y,r$M)&&(r$T=!0),r$R<r$e&&r$o<r$l&&r$Y<r$M?r$T=!0:r$d=!1}return r$d?1:r$T?2:0},r$S.containsSphere=function(r$S,r$Q){void 0===r$Q&&(r$Q=!1);var r$e=this.extents.elements,r$l=r$e[0],r$M=r$e[1],r$d=r$e[2],r$T=r$S.radius;this.transformation.invert(r$A._tempM0),r$TQ.transformCoordinate(r$S.center,r$A._tempM0,r$A._tempV30);var r$U=NaN;if(r$U=r$Q?r$T:(r$TQ.scale(r$TQ.UnitX,r$T,r$A._tempV31),r$TQ.TransformNormal(r$A._tempV31,r$A._tempM0,r$A._tempV31),r$TQ.scalarLength(r$A._tempV31)),r$TQ.scale(this.extents,-1,r$A._tempV32),r$TQ.Clamp(r$A._tempV30,r$A._tempV32,this.extents,r$A._tempV33),r$U*r$U<r$TQ.distanceSquared(r$A._tempV30,r$A._tempV33))return 0;var r$i=r$A._tempV30.elements,r$R=r$i[0],r$o=r$i[1],r$Y=r$i[2],r$p=r$A._tempV32.elements,r$J=r$p[0],r$L=r$p[1],r$j=r$p[2];return r$J+r$U<=r$R&&r$R<=r$l-r$U&&r$U<r$l-r$J&&r$L+r$U<=r$o&&r$o<=r$M-r$U&&r$U<r$M-r$L&&r$j+r$U<=r$Y&&r$Y<=r$d-r$U&&r$U<r$d-r$j?1:2},r$S.containsOrientedBoundBox=function(r$S){var r$Q=0,r$e=0;r$S.getCorners(r$A._corners);var r$l=this.containsPoints(r$A._corners);if(0!=r$l)return r$l;var r$M=this.extents.elements;r$S.extents.cloneTo(r$A._tempV35);var r$d=r$A._tempV35.elements;r$A._getRows(this.transformation,r$A._rows1),r$A._getRows(r$S.transformation,r$A._rows2);var r$T=NaN;for(r$Q=0;r$Q<4;r$Q++)for(r$e=0;r$e<4;r$e++)3==r$Q||3==r$e?(r$A._tempM0.setElementByRowColumn(r$Q,r$e,0),r$A._tempM1.setElementByRowColumn(r$Q,r$e,0)):(r$T=r$TQ.dot(r$A._rows1[r$Q],r$A._rows2[r$e]),r$A._tempM0.setElementByRowColumn(r$Q,r$e,r$T),r$A._tempM1.setElementByRowColumn(r$Q,r$e,Math.abs(r$T)));r$S.getCenter(r$A._tempV34),this.getCenter(r$A._tempV36),r$TQ.subtract(r$A._tempV34,r$A._tempV36,r$A._tempV30);var r$U=r$A._tempV31.elements;r$U[0]=r$TQ.dot(r$A._tempV30,r$A._rows1[0]),r$U[1]=r$TQ.dot(r$A._tempV30,r$A._rows1[1]),r$U[2]=r$TQ.dot(r$A._tempV30,r$A._rows1[2]);var r$i=r$A._tempV32.elements,r$R=r$A._tempV33.elements;for(r$Q=0;r$Q<3;r$Q++)if(r$i[0]=r$A._tempM1.getElementByRowColumn(r$Q,0),r$i[1]=r$A._tempM1.getElementByRowColumn(r$Q,1),r$i[2]=r$A._tempM1.getElementByRowColumn(r$Q,2),r$M[r$Q]+r$TQ.dot(r$A._tempV35,r$A._tempV32)<Math.abs(r$U[r$Q]))return 0;for(r$e=0;r$e<3;r$e++)if(r$i[0]=r$A._tempM1.getElementByRowColumn(0,r$e),r$i[1]=r$A._tempM1.getElementByRowColumn(1,r$e),r$i[2]=r$A._tempM1.getElementByRowColumn(2,r$e),r$R[0]=r$A._tempM0.getElementByRowColumn(0,r$e),r$R[1]=r$A._tempM0.getElementByRowColumn(1,r$e),r$R[2]=r$A._tempM0.getElementByRowColumn(2,r$e),r$TQ.dot(this.extents,r$A._tempV32)+r$d[r$e]<Math.abs(r$TQ.dot(r$A._tempV31,r$A._tempV33)))return 0;for(r$Q=0;r$Q<3;r$Q++)for(r$e=0;r$e<3;r$e++){var r$o=(r$Q+1)%3,r$Y=(r$Q+2)%3,r$p=(r$e+1)%3,r$J=(r$e+2)%3;if(r$M[r$o]*r$A._tempM1.getElementByRowColumn(r$Y,r$e)+r$M[r$Y]*r$A._tempM1.getElementByRowColumn(r$o,r$e)+(r$d[r$p]*r$A._tempM1.getElementByRowColumn(r$Q,r$J)+r$d[r$J]*r$A._tempM1.getElementByRowColumn(r$Q,r$p))<Math.abs(r$U[r$Y]*r$A._tempM0.getElementByRowColumn(r$o,r$e)-r$U[r$o]*r$A._tempM0.getElementByRowColumn(r$Y,r$e)))return 0}return 2},r$S.containsLine=function(r$S,r$Q){r$A._corners[0]=r$S,r$A._corners[1]=r$Q;var r$e=this.containsPoints(r$A._corners);if(0!=r$e)return r$e;var r$l=this.extents.elements,r$M=r$l[0],r$d=r$l[1],r$T=r$l[2];this.transformation.invert(r$A._tempM0),r$TQ.transformCoordinate(r$S,r$A._tempM0,r$A._tempV30),r$TQ.transformCoordinate(r$Q,r$A._tempM0,r$A._tempV31),r$TQ.add(r$A._tempV30,r$A._tempV31,r$A._tempV32),r$TQ.scale(r$A._tempV32,.5,r$A._tempV32),r$TQ.subtract(r$A._tempV30,r$A._tempV32,r$A._tempV33);var r$U=r$A._tempV33.elements,r$i=r$U[0],r$R=r$U[1],r$o=r$U[2],r$Y=r$A._tempV34.elements,r$p=r$Y[0]=Math.abs(r$U[0]),r$J=r$Y[1]=Math.abs(r$U[1]),r$L=r$Y[2]=Math.abs(r$U[2]),r$j=r$A._tempV32.elements,r$c=r$j[0],r$G=r$j[1],r$z=r$j[2];return Math.abs(r$c)>r$M+r$p?0:Math.abs(r$G)>r$d+r$J?0:Math.abs(r$z)>r$T+r$L?0:Math.abs(r$G*r$o-r$z*r$R)>r$d*r$L+r$T*r$J?0:Math.abs(r$c*r$o-r$z*r$i)>r$M*r$L+r$T*r$p?0:Math.abs(r$c*r$R-r$G*r$i)>r$M*r$J+r$d*r$p?0:2},r$S.containsBoundBox=function(r$S){var r$Q=0,r$e=0,r$l=r$S.min,r$M=r$S.max;r$S.getCorners(r$A._corners);var r$d=this.containsPoints(r$A._corners);if(0!=r$d)return r$d;r$TQ.subtract(r$M,r$l,r$A._tempV30),r$TQ.scale(r$A._tempV30,.5,r$A._tempV30),r$TQ.add(r$l,r$A._tempV30,r$A._tempV30),r$TQ.subtract(r$M,r$A._tempV30,r$A._tempV31);var r$T=this.extents.elements,r$U=r$A._tempV31.elements;r$A._getRows(this.transformation,r$A._rows1),this.transformation.invert(r$A._tempM0);for(r$Q=0;r$Q<3;r$Q++)for(r$e=0;r$e<3;r$e++)r$A._tempM1.setElementByRowColumn(r$Q,r$e,Math.abs(r$A._tempM0.getElementByRowColumn(r$Q,r$e)));this.getCenter(r$A._tempV35),r$TQ.subtract(r$A._tempV30,r$A._tempV35,r$A._tempV32);var r$i=r$A._tempV31.elements;r$i[0]=r$TQ.dot(r$A._tempV32,r$A._rows1[0]),r$i[1]=r$TQ.dot(r$A._tempV32,r$A._rows1[1]),r$i[2]=r$TQ.dot(r$A._tempV32,r$A._rows1[2]);var r$R=r$A._tempV33.elements,r$o=r$A._tempV34.elements;for(r$Q=0;r$Q<3;r$Q++)if(r$R[0]=r$A._tempM1.getElementByRowColumn(r$Q,0),r$R[1]=r$A._tempM1.getElementByRowColumn(r$Q,1),r$R[2]=r$A._tempM1.getElementByRowColumn(r$Q,2),r$T[r$Q]+r$TQ.dot(r$A._tempV31,r$A._tempV33)<Math.abs(r$i[r$Q]))return 0;for(r$e=0;r$e<3;r$e++)if(r$R[0]=r$A._tempM1.getElementByRowColumn(0,r$e),r$R[1]=r$A._tempM1.getElementByRowColumn(1,r$e),r$R[2]=r$A._tempM1.getElementByRowColumn(2,r$e),r$o[0]=r$A._tempM0.getElementByRowColumn(0,r$e),r$o[1]=r$A._tempM0.getElementByRowColumn(1,r$e),r$o[2]=r$A._tempM0.getElementByRowColumn(2,r$e),r$TQ.dot(this.extents,r$A._tempV33)+r$U[r$e]<Math.abs(r$TQ.dot(r$A._tempV31,r$A._tempV34)))return 0;for(r$Q=0;r$Q<3;r$Q++)for(r$e=0;r$e<3;r$e++){var r$Y=(r$Q+1)%3,r$p=(r$Q+2)%3,r$J=(r$e+1)%3,r$L=(r$e+2)%3;if(r$T[r$Y]*r$A._tempM1.getElementByRowColumn(r$p,r$e)+r$T[r$p]*r$A._tempM1.getElementByRowColumn(r$Y,r$e)+(r$U[r$J]*r$A._tempM1.getElementByRowColumn(r$Q,r$L)+r$U[r$L]*r$A._tempM1.getElementByRowColumn(r$Q,r$J))<Math.abs(r$i[r$p]*r$A._tempM0.getElementByRowColumn(r$Y,r$e)-r$i[r$Y]*r$A._tempM0.getElementByRowColumn(r$p,r$e)))return 0}return 2},r$S.intersectsRay=function(r$S,r$Q){r$TQ.scale(this.extents,-1,r$A._tempV30),this.transformation.invert(r$A._tempM0),r$TQ.TransformNormal(r$S.direction,r$A._tempM0,r$A._ray.direction),r$TQ.transformCoordinate(r$S.origin,r$A._tempM0,r$A._ray.origin),r$A._boxBound1.min=r$A._tempV30,r$A._boxBound1.max=this.extents;var r$e=Collision.intersectsRayAndBoxRP(r$A._ray,r$A._boxBound1,r$Q);return-1!==r$e&&r$TQ.transformCoordinate(r$Q,this.transformation,r$Q),r$e},r$S._getLocalCorners=function(r$S){r$S.length=8;var r$Q=this.extents.elements;r$A._tempV30.x=r$Q[0],r$A._tempV31.y=r$Q[1],r$A._tempV32.z=r$Q[2],r$TQ.add(r$A._tempV30,r$A._tempV31,r$A._tempV33),r$TQ.add(r$A._tempV33,r$A._tempV32,r$S[0]),r$TQ.add(r$A._tempV30,r$A._tempV31,r$A._tempV33),r$TQ.subtract(r$A._tempV33,r$A._tempV32,r$S[1]),r$TQ.subtract(r$A._tempV31,r$A._tempV30,r$A._tempV33),r$TQ.subtract(r$A._tempV33,r$A._tempV30,r$S[2]),r$TQ.subtract(r$A._tempV31,r$A._tempV30,r$A._tempV33),r$TQ.add(r$A._tempV33,r$A._tempV32,r$S[3]),r$TQ.subtract(r$A._tempV30,r$A._tempV31,r$A._tempV33),r$TQ.add(r$A._tempV33,r$A._tempV32,r$S[4]),r$TQ.subtract(r$A._tempV30,r$A._tempV31,r$A._tempV33),r$TQ.subtract(r$A._tempV33,r$A._tempV32,r$S[5]),r$TQ.scale(r$S[0],-1,r$S[6]),r$TQ.subtract(r$A._tempV32,r$A._tempV30,r$A._tempV33),r$TQ.subtract(r$A._tempV33,r$A._tempV31,r$S[7])},r$S.equals=function(r$S){return this.extents==r$S.extents&&this.transformation==r$S.transformation},r$S.cloneTo=function(r$S){var r$Q=r$S;this.extents.cloneTo(r$Q.extents),this.transformation.cloneTo(r$Q.transformation)},r$A.createByBoundBox=function(r$S,r$Q){var r$e=r$S.min,r$l=r$S.max;r$TQ.subtract(r$l,r$e,r$A._tempV30),r$TQ.scale(r$A._tempV30,.5,r$A._tempV30),r$TQ.add(r$e,r$A._tempV30,r$A._tempV31),r$TQ.subtract(r$l,r$A._tempV31,r$A._tempV32),r$SQ.translation(r$A._tempV31,r$A._tempM0);var r$M=r$A._tempV32.clone(),r$d=r$A._tempM0.clone();r$Q.extents=r$M,r$Q.transformation=r$d},r$A.createByMinAndMaxVertex=function(r$S,r$Q){return r$TQ.subtract(r$Q,r$S,r$A._tempV30),r$TQ.scale(r$A._tempV30,.5,r$A._tempV30),r$TQ.add(r$S,r$A._tempV30,r$A._tempV31),r$TQ.subtract(r$Q,r$A._tempV31,r$A._tempV32),r$SQ.translation(r$A._tempV31,r$A._tempM0),new r$A(r$A._tempV32,r$A._tempM0)},r$A._getRows=function(r$S,r$Q){r$Q.length=3;var r$e=r$S.elements,r$l=r$Q[0].elements;r$l[0]=r$e[0],r$l[1]=r$e[1],r$l[2]=r$e[2];var r$M=r$Q[1].elements;r$M[0]=r$e[4],r$M[1]=r$e[5],r$M[2]=r$e[6];var r$d=r$Q[2].elements;r$d[0]=r$e[8],r$d[1]=r$e[9],r$d[2]=r$e[10]},r$A.getObbtoObbMatrix4x4=function(r$S,r$Q,r$e,r$l){var r$M=r$S.transformation,r$d=r$Q.transformation;if(r$e){r$A._getRows(r$M,r$A._rows1),r$A._getRows(r$d,r$A._rows2);for(var r$T=0;r$T<3;r$T++)for(var r$U=0;r$U<3;r$U++)r$l.setElementByRowColumn(r$T,r$U,r$TQ.dot(r$A._rows2[r$T],r$A._rows1[r$U]));r$Q.getCenter(r$A._tempV30),r$S.getCenter(r$A._tempV31),r$TQ.subtract(r$A._tempV30,r$A._tempV31,r$A._tempV32);var r$i=r$l.elements;r$i[12]=r$TQ.dot(r$A._tempV32,r$A._rows1[0]),r$i[13]=r$TQ.dot(r$A._tempV32,r$A._rows1[1]),r$i[14]=r$TQ.dot(r$A._tempV32,r$A._rows1[2]),r$i[15]=1}else r$M.invert(r$A._tempM0),r$SQ.multiply(r$d,r$A._tempM0,r$l)},r$A.merge=function(r$S,r$Q,r$e){var r$l=r$S.extents,r$M=r$S.transformation;r$A.getObbtoObbMatrix4x4(r$S,r$Q,r$e,r$A._tempM0),r$Q._getLocalCorners(r$A._corners),r$TQ.transformCoordinate(r$A._corners[0],r$A._tempM0,r$A._corners[0]),r$TQ.transformCoordinate(r$A._corners[1],r$A._tempM0,r$A._corners[1]),r$TQ.transformCoordinate(r$A._corners[2],r$A._tempM0,r$A._corners[2]),r$TQ.transformCoordinate(r$A._corners[3],r$A._tempM0,r$A._corners[3]),r$TQ.transformCoordinate(r$A._corners[4],r$A._tempM0,r$A._corners[4]),r$TQ.transformCoordinate(r$A._corners[5],r$A._tempM0,r$A._corners[5]),r$TQ.transformCoordinate(r$A._corners[6],r$A._tempM0,r$A._corners[6]),r$TQ.transformCoordinate(r$A._corners[7],r$A._tempM0,r$A._corners[7]),r$TQ.scale(r$l,-1,r$A._boxBound1.min),r$l.cloneTo(r$A._boxBound1.max),r$KS.createfromPoints(r$A._corners,r$A._boxBound2),r$KS.merge(r$A._boxBound2,r$A._boxBound1,r$A._boxBound3);var r$d=r$A._boxBound3.min,r$T=r$A._boxBound3.max;r$TQ.subtract(r$T,r$d,r$A._tempV30),r$TQ.scale(r$A._tempV30,.5,r$A._tempV30),r$TQ.add(r$d,r$A._tempV30,r$A._tempV32),r$TQ.subtract(r$T,r$A._tempV32,r$l),r$TQ.transformCoordinate(r$A._tempV32,r$M,r$A._tempV33)},r$Y(r$A,["_tempV30",function(){return this._tempV30=new r$TQ},"_tempV31",function(){return this._tempV31=new r$TQ},"_tempV32",function(){return this._tempV32=new r$TQ},"_tempV33",function(){return this._tempV33=new r$TQ},"_tempV34",function(){return this._tempV34=new r$TQ},"_tempV35",function(){return this._tempV35=new r$TQ},"_tempV36",function(){return this._tempV36=new r$TQ},"_tempM0",function(){return this._tempM0=new r$SQ},"_tempM1",function(){return this._tempM1=new r$SQ},"_corners",function(){return this._corners=[new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ]},"_rows1",function(){return this._rows1=[new r$TQ,new r$TQ,new r$TQ]},"_rows2",function(){return this._rows2=[new r$TQ,new r$TQ,new r$TQ]},"_ray",function(){return this._ray=new r$MQ(new r$TQ,new r$TQ)},"_boxBound1",function(){return this._boxBound1=new r$KS(new r$TQ,new r$TQ)},"_boxBound2",function(){return this._boxBound2=new r$KS(new r$TQ,new r$TQ)},"_boxBound3",function(){return this._boxBound3=new r$KS(new r$TQ,new r$TQ)}])}(),function(){function r$D(r$S,r$Q){this.normal=null,this.distance=NaN,void 0===r$Q&&(r$Q=0),this.normal=r$S,this.distance=r$Q}return r$J(r$D,"laya.d3.math.Plane"),r$D.prototype.normalize=function(){var r$S=this.normal.elements,r$Q=r$S[0],r$e=r$S[1],r$l=r$S[2],r$M=1/Math.sqrt(r$Q*r$Q+r$e*r$e+r$l*r$l);r$S[0]=r$Q*r$M,r$S[1]=r$e*r$M,r$S[2]=r$l*r$M,this.distance*=r$M},r$D.createPlaneBy3P=function(r$S,r$Q,r$e){var r$l=r$S.elements,r$M=r$Q.elements,r$d=r$e.elements,r$T=r$M[0]-r$l[0],r$U=r$M[1]-r$l[1],r$i=r$M[2]-r$l[2],r$R=r$d[0]-r$l[0],r$o=r$d[1]-r$l[1],r$Y=r$d[2]-r$l[2],r$p=r$U*r$Y-r$i*r$o,r$J=r$i*r$R-r$T*r$Y,r$L=r$T*r$o-r$U*r$R,r$j=1/Math.sqrt(r$p*r$p+r$J*r$J+r$L*r$L),r$c=r$p*r$j,r$G=r$J*r$j,r$z=r$L*r$j,r$A=r$D._TEMPVec3.elements;r$A[0]=r$c,r$A[1]=r$G,r$A[2]=r$z;var r$v=-(r$c*r$l[0]+r$G*r$l[1]+r$z*r$l[2]);return new r$D(r$D._TEMPVec3,r$v)},r$D.PlaneIntersectionType_Back=0,r$D.PlaneIntersectionType_Front=1,r$D.PlaneIntersectionType_Intersecting=2,r$Y(r$D,["_TEMPVec3",function(){return this._TEMPVec3=new r$TQ}]),r$D}()),r$eQ=function(){function r$M(r$S,r$Q,r$e,r$l){this.elements=new Float32Array(4),void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=1),this.elements[0]=r$S,this.elements[1]=r$Q,this.elements[2]=r$e,this.elements[3]=r$l}r$J(r$M,"laya.d3.math.Quaternion");var r$S=r$M.prototype;return r$D.imps(r$S,{"laya.d3.core.IClone":!0}),r$S.scaling=function(r$S,r$Q){var r$e=r$Q.elements,r$l=this.elements;r$e[0]=r$l[0]*r$S,r$e[1]=r$l[1]*r$S,r$e[2]=r$l[2]*r$S,r$e[3]=r$l[3]*r$S},r$S.normalize=function(r$S){var r$Q=r$S.elements,r$e=this.elements,r$l=r$e[0],r$M=r$e[1],r$d=r$e[2],r$T=r$e[3],r$U=r$l*r$l+r$M*r$M+r$d*r$d+r$T*r$T;0<r$U&&(r$U=1/Math.sqrt(r$U),r$Q[0]=r$l*r$U,r$Q[1]=r$M*r$U,r$Q[2]=r$d*r$U,r$Q[3]=r$T*r$U)},r$S.length=function(){var r$S=this.elements,r$Q=r$S[0],r$e=r$S[1],r$l=r$S[2],r$M=r$S[3];return Math.sqrt(r$Q*r$Q+r$e*r$e+r$l*r$l+r$M*r$M)},r$S.rotateX=function(r$S,r$Q){var r$e=r$Q.elements,r$l=this.elements;r$S*=.5;var r$M=r$l[0],r$d=r$l[1],r$T=r$l[2],r$U=r$l[3],r$i=Math.sin(r$S),r$R=Math.cos(r$S);r$e[0]=r$M*r$R+r$U*r$i,r$e[1]=r$d*r$R+r$T*r$i,r$e[2]=r$T*r$R-r$d*r$i,r$e[3]=r$U*r$R-r$M*r$i},r$S.rotateY=function(r$S,r$Q){var r$e=r$Q.elements,r$l=this.elements;r$S*=.5;var r$M=r$l[0],r$d=r$l[1],r$T=r$l[2],r$U=r$l[3],r$i=Math.sin(r$S),r$R=Math.cos(r$S);r$e[0]=r$M*r$R-r$T*r$i,r$e[1]=r$d*r$R+r$U*r$i,r$e[2]=r$T*r$R+r$M*r$i,r$e[3]=r$U*r$R-r$d*r$i},r$S.rotateZ=function(r$S,r$Q){var r$e=r$Q.elements,r$l=this.elements;r$S*=.5;var r$M=r$l[0],r$d=r$l[1],r$T=r$l[2],r$U=r$l[3],r$i=Math.sin(r$S),r$R=Math.cos(r$S);r$e[0]=r$M*r$R+r$d*r$i,r$e[1]=r$d*r$R-r$M*r$i,r$e[2]=r$T*r$R+r$U*r$i,r$e[3]=r$U*r$R-r$T*r$i},r$S.getYawPitchRoll=function(r$S){r$TQ.transformQuat(r$TQ.ForwardRH,this,r$M.TEMPVector31),r$TQ.transformQuat(r$TQ.Up,this,r$M.TEMPVector32);var r$Q=r$M.TEMPVector32.elements;r$M.angleTo(r$TQ.ZERO,r$M.TEMPVector31,r$M.TEMPVector33);var r$e=r$M.TEMPVector33.elements;r$e[0]==Math.PI/2?(r$e[1]=r$M.arcTanAngle(r$Q[2],r$Q[0]),r$e[2]=0):r$e[0]==-Math.PI/2?(r$e[1]=r$M.arcTanAngle(-r$Q[2],-r$Q[0]),r$e[2]=0):(r$SQ.createRotationY(-r$e[1],r$M.TEMPMatrix0),r$SQ.createRotationX(-r$e[0],r$M.TEMPMatrix1),r$TQ.transformCoordinate(r$M.TEMPVector32,r$M.TEMPMatrix0,r$M.TEMPVector32),r$TQ.transformCoordinate(r$M.TEMPVector32,r$M.TEMPMatrix1,r$M.TEMPVector32),r$e[2]=r$M.arcTanAngle(r$Q[1],-r$Q[0])),r$e[1]<=-Math.PI&&(r$e[1]=Math.PI),r$e[2]<=-Math.PI&&(r$e[2]=Math.PI),r$e[1]>=Math.PI&&r$e[2]>=Math.PI&&(r$e[1]=0,r$e[2]=0,r$e[0]=Math.PI-r$e[0]);var r$l=r$S.elements;r$l[0]=r$e[1],r$l[1]=r$e[0],r$l[2]=r$e[2]},r$S.invert=function(r$S){var r$Q=r$S.elements,r$e=this.elements,r$l=r$e[0],r$M=r$e[1],r$d=r$e[2],r$T=r$e[3],r$U=r$l*r$l+r$M*r$M+r$d*r$d+r$T*r$T,r$i=r$U?1/r$U:0;r$Q[0]=-r$l*r$i,r$Q[1]=-r$M*r$i,r$Q[2]=-r$d*r$i,r$Q[3]=r$T*r$i},r$S.identity=function(){var r$S=this.elements;r$S[0]=0,r$S[1]=0,r$S[2]=0,r$S[3]=1},r$S.fromArray=function(r$S,r$Q){void 0===r$Q&&(r$Q=0),this.elements[0]=r$S[r$Q+0],this.elements[1]=r$S[r$Q+1],this.elements[2]=r$S[r$Q+2],this.elements[3]=r$S[r$Q+3]},r$S.cloneTo=function(r$S){var r$Q,r$e,r$l;if((r$e=this.elements)!==(r$l=r$S.elements))for(r$Q=0;r$Q<4;++r$Q)r$l[r$Q]=r$e[r$Q]},r$S.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$S.equals=function(r$S){var r$Q=this.elements,r$e=r$S.elements;return r$sS.nearEqual(r$Q[0],r$e[0])&&r$sS.nearEqual(r$Q[1],r$e[1])&&r$sS.nearEqual(r$Q[2],r$e[2])&&r$sS.nearEqual(r$Q[3],r$e[3])},r$S.lengthSquared=function(){var r$S=this.elements[0],r$Q=this.elements[1],r$e=this.elements[2],r$l=this.elements[3];return r$S*r$S+r$Q*r$Q+r$e*r$e+r$l*r$l},r$L(0,r$S,"x",function(){return this.elements[0]}),r$L(0,r$S,"y",function(){return this.elements[1]}),r$L(0,r$S,"z",function(){return this.elements[2]}),r$L(0,r$S,"w",function(){return this.elements[3]}),r$M.createFromYawPitchRoll=function(r$S,r$Q,r$e,r$l){var r$M=.5*r$e,r$d=.5*r$Q,r$T=.5*r$S,r$U=Math.sin(r$M),r$i=Math.cos(r$M),r$R=Math.sin(r$d),r$o=Math.cos(r$d),r$Y=Math.sin(r$T),r$p=Math.cos(r$T),r$J=r$l.elements;r$J[0]=r$p*r$R*r$i+r$Y*r$o*r$U,r$J[1]=r$Y*r$o*r$i-r$p*r$R*r$U,r$J[2]=r$p*r$o*r$U-r$Y*r$R*r$i,r$J[3]=r$p*r$o*r$i+r$Y*r$R*r$U},r$M.multiply=function(r$S,r$Q,r$e){var r$l=r$S.elements,r$M=r$Q.elements,r$d=r$e.elements,r$T=r$l[0],r$U=r$l[1],r$i=r$l[2],r$R=r$l[3],r$o=r$M[0],r$Y=r$M[1],r$p=r$M[2],r$J=r$M[3],r$L=r$U*r$p-r$i*r$Y,r$j=r$i*r$o-r$T*r$p,r$c=r$T*r$Y-r$U*r$o,r$G=r$T*r$o+r$U*r$Y+r$i*r$p;r$d[0]=r$T*r$J+r$o*r$R+r$L,r$d[1]=r$U*r$J+r$Y*r$R+r$j,r$d[2]=r$i*r$J+r$p*r$R+r$c,r$d[3]=r$R*r$J-r$G},r$M.arcTanAngle=function(r$S,r$Q){return 0==r$S?1==r$Q?Math.PI/2:-Math.PI/2:0<r$S?Math.atan(r$Q/r$S):r$S<0?0<r$Q?Math.atan(r$Q/r$S)+Math.PI:Math.atan(r$Q/r$S)-Math.PI:0},r$M.angleTo=function(r$S,r$Q,r$e){r$TQ.subtract(r$Q,r$S,r$M.TEMPVector30),r$TQ.normalize(r$M.TEMPVector30,r$M.TEMPVector30),r$e.elements[0]=Math.asin(r$M.TEMPVector30.y),r$e.elements[1]=r$M.arcTanAngle(-r$M.TEMPVector30.z,-r$M.TEMPVector30.x)},r$M.createFromAxisAngle=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements;r$Q*=.5;var r$d=Math.sin(r$Q);r$l[0]=r$d*r$M[0],r$l[1]=r$d*r$M[1],r$l[2]=r$d*r$M[2],r$l[3]=Math.cos(r$Q)},r$M.createFromMatrix3x3=function(r$S,r$Q){var r$e,r$l=r$Q.elements,r$M=r$S.elements,r$d=r$M[0]+r$M[4]+r$M[8];if(0<r$d)r$e=Math.sqrt(r$d+1),r$l[3]=.5*r$e,r$e=.5/r$e,r$l[0]=(r$M[5]-r$M[7])*r$e,r$l[1]=(r$M[6]-r$M[2])*r$e,r$l[2]=(r$M[1]-r$M[3])*r$e;else{var r$T=0;r$M[4]>r$M[0]&&(r$T=1),r$M[8]>r$M[3*r$T+r$T]&&(r$T=2);var r$U=(r$T+1)%3,r$i=(r$T+2)%3;r$e=Math.sqrt(r$M[3*r$T+r$T]-r$M[3*r$U+r$U]-r$M[3*r$i+r$i]+1),r$l[r$T]=.5*r$e,r$e=.5/r$e,r$l[3]=(r$M[3*r$U+r$i]-r$M[3*r$i+r$U])*r$e,r$l[r$U]=(r$M[3*r$U+r$T]+r$M[3*r$T+r$U])*r$e,r$l[r$i]=(r$M[3*r$i+r$T]+r$M[3*r$T+r$i])*r$e}},r$M.createFromMatrix4x4=function(r$S,r$Q){var r$e,r$l,r$M=r$S.elements,r$d=r$Q.elements,r$T=r$M[0]+r$M[5]+r$M[10];0<r$T?(r$e=Math.sqrt(r$T+1),r$d[3]=.5*r$e,r$e=.5/r$e,r$d[0]=(r$M[6]-r$M[9])*r$e,r$d[1]=(r$M[8]-r$M[2])*r$e,r$d[2]=(r$M[1]-r$M[4])*r$e):r$M[0]>=r$M[5]&&r$M[0]>=r$M[10]?(r$l=.5/(r$e=Math.sqrt(1+r$M[0]-r$M[5]-r$M[10])),r$d[0]=.5*r$e,r$d[1]=(r$M[1]+r$M[4])*r$l,r$d[2]=(r$M[2]+r$M[8])*r$l,r$d[3]=(r$M[6]-r$M[9])*r$l):r$M[5]>r$M[10]?(r$l=.5/(r$e=Math.sqrt(1+r$M[5]-r$M[0]-r$M[10])),r$d[0]=(r$M[4]+r$M[1])*r$l,r$d[1]=.5*r$e,r$d[2]=(r$M[9]+r$M[6])*r$l,r$d[3]=(r$M[8]-r$M[2])*r$l):(r$l=.5/(r$e=Math.sqrt(1+r$M[10]-r$M[0]-r$M[5])),r$d[0]=(r$M[8]+r$M[2])*r$l,r$d[1]=(r$M[9]+r$M[6])*r$l,r$d[2]=.5*r$e,r$d[3]=(r$M[1]-r$M[4])*r$l)},r$M.slerp=function(r$S,r$Q,r$e,r$l){var r$M,r$d,r$T,r$U,r$i,r$R=r$S.elements,r$o=r$Q.elements,r$Y=r$l.elements,r$p=r$R[0],r$J=r$R[1],r$L=r$R[2],r$j=r$R[3],r$c=r$o[0],r$G=r$o[1],r$z=r$o[2],r$A=r$o[3];return(r$d=r$p*r$c+r$J*r$G+r$L*r$z+r$j*r$A)<0&&(r$d=-r$d,r$c=-r$c,r$G=-r$G,r$z=-r$z,r$A=-r$A),r$i=1e-6<1-r$d?(r$M=Math.acos(r$d),r$T=Math.sin(r$M),r$U=Math.sin((1-r$e)*r$M)/r$T,Math.sin(r$e*r$M)/r$T):(r$U=1-r$e,r$e),r$Y[0]=r$U*r$p+r$i*r$c,r$Y[1]=r$U*r$J+r$i*r$G,r$Y[2]=r$U*r$L+r$i*r$z,r$Y[3]=r$U*r$j+r$i*r$A,r$Y},r$M.lerp=function(r$S,r$Q,r$e,r$l){var r$M=r$l.elements,r$d=r$S.elements,r$T=r$Q.elements,r$U=r$d[0],r$i=r$d[1],r$R=r$d[2],r$o=r$d[3];r$M[0]=r$U+r$e*(r$T[0]-r$U),r$M[1]=r$i+r$e*(r$T[1]-r$i),r$M[2]=r$R+r$e*(r$T[2]-r$R),r$M[3]=r$o+r$e*(r$T[3]-r$o)},r$M.add=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q.elements;r$l[0]=r$M[0]+r$d[0],r$l[1]=r$M[1]+r$d[1],r$l[2]=r$M[2]+r$d[2],r$l[3]=r$M[3]+r$d[3]},r$M.dot=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements;return r$e[0]*r$l[0]+r$e[1]*r$l[1]+r$e[2]*r$l[2]+r$e[3]*r$l[3]},r$M.rotationLookAt=function(r$S,r$Q,r$e){r$M.lookAt(r$TQ.ZERO,r$S,r$Q,r$e)},r$M.lookAt=function(r$S,r$Q,r$e,r$l){r$yS.lookAt(r$S,r$Q,r$e,r$M._tempMatrix3x3),r$M.rotationMatrix(r$M._tempMatrix3x3,r$l)},r$M.invert=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements,r$M=r$S.lengthSquared();r$sS.isZero(r$M)||(r$M=1/r$M,r$l[0]=-r$e[0]*r$M,r$l[1]=-r$e[1]*r$M,r$l[2]=-r$e[2]*r$M,r$l[3]=r$e[3]*r$M)},r$M.rotationMatrix=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$e[0],r$M=r$e[1],r$d=r$e[2],r$T=r$e[3],r$U=r$e[4],r$i=r$e[5],r$R=r$e[6],r$o=r$e[7],r$Y=r$e[8],r$p=r$Q.elements,r$J=NaN,r$L=NaN,r$j=r$l+r$U+r$Y;0<r$j?(r$J=Math.sqrt(r$j+1),r$p[3]=.5*r$J,r$J=.5/r$J,r$p[0]=(r$i-r$o)*r$J,r$p[1]=(r$R-r$d)*r$J,r$p[2]=(r$M-r$T)*r$J):r$U<=r$l&&r$Y<=r$l?(r$L=.5/(r$J=Math.sqrt(1+r$l-r$U-r$Y)),r$p[0]=.5*r$J,r$p[1]=(r$M+r$T)*r$L,r$p[2]=(r$d+r$R)*r$L,r$p[3]=(r$i-r$o)*r$L):r$Y<r$U?(r$L=.5/(r$J=Math.sqrt(1+r$U-r$l-r$Y)),r$p[0]=(r$T+r$M)*r$L,r$p[1]=.5*r$J,r$p[2]=(r$o+r$i)*r$L,r$p[3]=(r$R-r$d)*r$L):(r$L=.5/(r$J=Math.sqrt(1+r$Y-r$l-r$U)),r$p[0]=(r$R+r$d)*r$L,r$p[1]=(r$o+r$i)*r$L,r$p[2]=.5*r$J,r$p[3]=(r$M-r$T)*r$L)},r$M.DEFAULT=new r$M,r$Y(r$M,["TEMPVector30",function(){return this.TEMPVector30=new r$TQ},"TEMPVector31",function(){return this.TEMPVector31=new r$TQ},"TEMPVector32",function(){return this.TEMPVector32=new r$TQ},"TEMPVector33",function(){return this.TEMPVector33=new r$TQ},"TEMPMatrix0",function(){return this.TEMPMatrix0=new r$SQ},"TEMPMatrix1",function(){return this.TEMPMatrix1=new r$SQ},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new r$yS},"NAN",function(){return this.NAN=new r$M(NaN,NaN,NaN,NaN)}]),r$M}(),r$lQ=function(){function r$S(r$S){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=r$S,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}r$J(r$S,"laya.d3.math.Rand");var r$Q=r$S.prototype;return r$Q.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},r$Q.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},r$Q.getSignedFloat=function(){return 2*this.getFloat()-1},r$L(0,r$Q,"seed",function(){return this.seeds[0]},function(r$S){this.seeds[0]=r$S,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),r$S.getFloatFromInt=function(r$S){return 1/8388607*(8388607&r$S)},r$S.getByteFromInt=function(r$S){return(8388607&r$S)>>>15},r$S}(),r$MQ=(function(){function r$M(r$S){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(r$S instanceof Array)||4!==r$S.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|r$S[0],this._state0L=0|r$S[1],this._state1U=0|r$S[2],this._state1L=0|r$S[3]}r$J(r$M,"laya.d3.math.RandX");var r$S=r$M.prototype;r$S.randomint=function(){var r$S=this._state0U,r$Q=this._state0L,r$e=this._state1U,r$l=this._state1L,r$M=(r$l>>>0)+(r$Q>>>0),r$d=r$e+r$S+(r$M/2>>>31)>>>0,r$T=r$M>>>0,r$U=0,r$i=0;r$U=(r$S^=r$U=r$S<<23|(-512&r$Q)>>>9)^(this._state0U=r$e),r$i=(r$Q^=r$i=r$Q<<23)^(this._state0L=r$l);r$U^=r$S>>>18,r$i^=r$Q>>>18|(262143&r$S)<<14;return r$U^=r$e>>>5,r$i^=r$l>>>5|(31&r$e)<<27,this._state1U=r$U,this._state1L=r$i,[r$d,r$T]},r$S.random=function(){var r$S=this.randomint(),r$Q=r$S[0],r$e=1023<<20|r$Q>>>12,r$l=0|(r$S[1]>>>12|(4095&r$Q)<<20);return r$M._CONVERTION_BUFFER.setUint32(0,r$e,!1),r$M._CONVERTION_BUFFER.setUint32(4,r$l,!1),r$lQ._CONVERTION_BUFFER.getFloat64(0,!1)-1},r$Y(r$M,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new r$lQ([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function r$S(r$S,r$Q){this.origin=null,this.direction=null,this.origin=r$S,this.direction=r$Q}return r$J(r$S,"laya.d3.math.Ray"),r$S}()),r$dQ=function(){function r$S(r$S,r$Q){this.elements=new Float32Array(2),void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0);var r$e=this.elements;r$e[0]=r$S,r$e[1]=r$Q}r$J(r$S,"laya.d3.math.Vector2");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q.fromArray=function(r$S,r$Q){void 0===r$Q&&(r$Q=0),this.elements[0]=r$S[r$Q+0],this.elements[1]=r$S[r$Q+1]},r$Q.cloneTo=function(r$S){var r$Q=r$S.elements,r$e=this.elements;r$Q[0]=r$e[0],r$Q[1]=r$e[1]},r$Q.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$Q,"x",function(){return this.elements[0]},function(r$S){this.elements[0]=r$S}),r$L(0,r$Q,"y",function(){return this.elements[1]},function(r$S){this.elements[1]=r$S}),r$S.scale=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements;r$l[0]=r$M[0]*r$Q,r$l[1]=r$M[1]*r$Q},r$Y(r$S,["ZERO",function(){return this.ZERO=new r$S(0,0)},"ONE",function(){return this.ONE=new r$S(1,1)}]),r$S}(),r$TQ=function(){function r$o(r$S,r$Q,r$e){this.elements=new Float32Array(3),void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0);var r$l=this.elements;r$l[0]=r$S,r$l[1]=r$Q,r$l[2]=r$e}r$J(r$o,"laya.d3.math.Vector3");var r$S=r$o.prototype;return r$D.imps(r$S,{"laya.d3.core.IClone":!0}),r$S.fromArray=function(r$S,r$Q){void 0===r$Q&&(r$Q=0),this.elements[0]=r$S[r$Q+0],this.elements[1]=r$S[r$Q+1],this.elements[2]=r$S[r$Q+2]},r$S.cloneTo=function(r$S){var r$Q=r$S.elements,r$e=this.elements;r$Q[0]=r$e[0],r$Q[1]=r$e[1],r$Q[2]=r$e[2]},r$S.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$S.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},r$S.reset=function(r$S,r$Q,r$e){this.elements[0]=r$S,this.elements[1]=r$Q,this.elements[2]=r$e},r$L(0,r$S,"x",function(){return this.elements[0]},function(r$S){this.elements[0]=r$S}),r$L(0,r$S,"y",function(){return this.elements[1]},function(r$S){this.elements[1]=r$S}),r$L(0,r$S,"z",function(){return this.elements[2]},function(r$S){this.elements[2]=r$S}),r$o.distanceSquared=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements,r$M=r$e[0]-r$l[0],r$d=r$e[1]-r$l[1],r$T=r$e[2]-r$l[2];return r$M*r$M+r$d*r$d+r$T*r$T},r$o.distance=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements,r$M=r$e[0]-r$l[0],r$d=r$e[1]-r$l[1],r$T=r$e[2]-r$l[2];return Math.sqrt(r$M*r$M+r$d*r$d+r$T*r$T)},r$o.min=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q.elements;r$l[0]=Math.min(r$M[0],r$d[0]),r$l[1]=Math.min(r$M[1],r$d[1]),r$l[2]=Math.min(r$M[2],r$d[2])},r$o.max=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q.elements;r$l[0]=Math.max(r$M[0],r$d[0]),r$l[1]=Math.max(r$M[1],r$d[1]),r$l[2]=Math.max(r$M[2],r$d[2])},r$o.transformQuat=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q.elements,r$T=r$M[0],r$U=r$M[1],r$i=r$M[2],r$R=r$d[0],r$o=r$d[1],r$Y=r$d[2],r$p=r$d[3],r$J=r$p*r$T+r$o*r$i-r$Y*r$U,r$L=r$p*r$U+r$Y*r$T-r$R*r$i,r$j=r$p*r$i+r$R*r$U-r$o*r$T,r$c=-r$R*r$T-r$o*r$U-r$Y*r$i;r$l[0]=r$J*r$p+r$c*-r$R+r$L*-r$Y-r$j*-r$o,r$l[1]=r$L*r$p+r$c*-r$o+r$j*-r$R-r$J*-r$Y,r$l[2]=r$j*r$p+r$c*-r$Y+r$J*-r$o-r$L*-r$R},r$o.scalarLength=function(r$S){var r$Q=r$S.elements,r$e=r$Q[0],r$l=r$Q[1],r$M=r$Q[2];return Math.sqrt(r$e*r$e+r$l*r$l+r$M*r$M)},r$o.scalarLengthSquared=function(r$S){var r$Q=r$S.elements,r$e=r$Q[0],r$l=r$Q[1],r$M=r$Q[2];return r$e*r$e+r$l*r$l+r$M*r$M},r$o.normalize=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements,r$M=r$e[0],r$d=r$e[1],r$T=r$e[2],r$U=r$M*r$M+r$d*r$d+r$T*r$T;0<r$U&&(r$U=1/Math.sqrt(r$U),r$l[0]=r$e[0]*r$U,r$l[1]=r$e[1]*r$U,r$l[2]=r$e[2]*r$U)},r$o.multiply=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q.elements;r$l[0]=r$M[0]*r$d[0],r$l[1]=r$M[1]*r$d[1],r$l[2]=r$M[2]*r$d[2]},r$o.scale=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements;r$l[0]=r$M[0]*r$Q,r$l[1]=r$M[1]*r$Q,r$l[2]=r$M[2]*r$Q},r$o.lerp=function(r$S,r$Q,r$e,r$l){var r$M=r$l.elements,r$d=r$S.elements,r$T=r$Q.elements,r$U=r$d[0],r$i=r$d[1],r$R=r$d[2];r$M[0]=r$U+r$e*(r$T[0]-r$U),r$M[1]=r$i+r$e*(r$T[1]-r$i),r$M[2]=r$R+r$e*(r$T[2]-r$R)},r$o.transformV3ToV3=function(r$S,r$Q,r$e){var r$l=r$o._tempVector4;r$o.transformV3ToV4(r$S,r$Q,r$l);var r$M=r$l.elements,r$d=r$e.elements;r$d[0]=r$M[0],r$d[1]=r$M[1],r$d[2]=r$M[2]},r$o.transformV3ToV4=function(r$S,r$Q,r$e){var r$l=r$S.elements,r$M=r$l[0],r$d=r$l[1],r$T=r$l[2],r$U=r$Q.elements,r$i=r$e.elements;r$i[0]=r$M*r$U[0]+r$d*r$U[4]+r$T*r$U[8]+r$U[12],r$i[1]=r$M*r$U[1]+r$d*r$U[5]+r$T*r$U[9]+r$U[13],r$i[2]=r$M*r$U[2]+r$d*r$U[6]+r$T*r$U[10]+r$U[14],r$i[3]=r$M*r$U[3]+r$d*r$U[7]+r$T*r$U[11]+r$U[15]},r$o.TransformNormal=function(r$S,r$Q,r$e){var r$l=r$S.elements,r$M=r$l[0],r$d=r$l[1],r$T=r$l[2],r$U=r$Q.elements,r$i=r$e.elements;r$i[0]=r$M*r$U[0]+r$d*r$U[4]+r$T*r$U[8],r$i[1]=r$M*r$U[1]+r$d*r$U[5]+r$T*r$U[9],r$i[2]=r$M*r$U[2]+r$d*r$U[6]+r$T*r$U[10]},r$o.transformCoordinate=function(r$S,r$Q,r$e){var r$l=r$o._tempVector4.elements,r$M=r$S.elements,r$d=r$M[0],r$T=r$M[1],r$U=r$M[2],r$i=r$Q.elements;r$l[0]=r$d*r$i[0]+r$T*r$i[4]+r$U*r$i[8]+r$i[12],r$l[1]=r$d*r$i[1]+r$T*r$i[5]+r$U*r$i[9]+r$i[13],r$l[2]=r$d*r$i[2]+r$T*r$i[6]+r$U*r$i[10]+r$i[14],r$l[3]=1/(r$d*r$i[3]+r$T*r$i[7]+r$U*r$i[11]+r$i[15]);var r$R=r$e.elements;r$R[0]=r$l[0]*r$l[3],r$R[1]=r$l[1]*r$l[3],r$R[2]=r$l[2]*r$l[3]},r$o.Clamp=function(r$S,r$Q,r$e,r$l){var r$M=r$S.elements,r$d=r$M[0],r$T=r$M[1],r$U=r$M[2],r$i=r$Q.elements,r$R=r$i[0],r$o=r$i[1],r$Y=r$i[2],r$p=r$e.elements,r$J=r$p[0],r$L=r$p[1],r$j=r$p[2],r$c=r$l.elements;r$d=(r$d=r$J<r$d?r$J:r$d)<r$R?r$R:r$d,r$T=(r$T=r$L<r$T?r$L:r$T)<r$o?r$o:r$T,r$U=(r$U=r$j<r$U?r$j:r$U)<r$Y?r$Y:r$U,r$c[0]=r$d,r$c[1]=r$T,r$c[2]=r$U},r$o.add=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q.elements;r$l[0]=r$M[0]+r$d[0],r$l[1]=r$M[1]+r$d[1],r$l[2]=r$M[2]+r$d[2]},r$o.subtract=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q.elements;r$l[0]=r$M[0]-r$d[0],r$l[1]=r$M[1]-r$d[1],r$l[2]=r$M[2]-r$d[2]},r$o.cross=function(r$S,r$Q,r$e){var r$l=r$S.elements,r$M=r$Q.elements,r$d=r$e.elements,r$T=r$l[0],r$U=r$l[1],r$i=r$l[2],r$R=r$M[0],r$o=r$M[1],r$Y=r$M[2];r$d[0]=r$U*r$Y-r$i*r$o,r$d[1]=r$i*r$R-r$T*r$Y,r$d[2]=r$T*r$o-r$U*r$R},r$o.dot=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements;return r$e[0]*r$l[0]+r$e[1]*r$l[1]+r$e[2]*r$l[2]},r$o.equals=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements;return r$sS.nearEqual(Math.abs(r$e[0]),Math.abs(r$l[0]))&&r$sS.nearEqual(Math.abs(r$e[1]),Math.abs(r$l[1]))&&r$sS.nearEqual(Math.abs(r$e[2]),Math.abs(r$l[2]))},r$o.ZERO=new r$o(0,0,0),r$o.ONE=new r$o(1,1,1),r$o.NegativeUnitX=new r$o(-1,0,0),r$o.UnitX=new r$o(1,0,0),r$o.UnitY=new r$o(0,1,0),r$o.UnitZ=new r$o(0,0,1),r$o.ForwardRH=new r$o(0,0,-1),r$o.ForwardLH=new r$o(0,0,1),r$o.Up=new r$o(0,1,0),r$o.NAN=new r$o(NaN,NaN,NaN),r$Y(r$o,["_tempVector4",function(){return this._tempVector4=new r$UQ}]),r$o}(),r$UQ=function(){function r$S(r$S,r$Q,r$e,r$l){this.elements=new Float32Array(4),void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=0);var r$M=this.elements;r$M[0]=r$S,r$M[1]=r$Q,r$M[2]=r$e,r$M[3]=r$l}r$J(r$S,"laya.d3.math.Vector4");var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q.fromArray=function(r$S,r$Q){void 0===r$Q&&(r$Q=0),this.elements[0]=r$S[r$Q+0],this.elements[1]=r$S[r$Q+1],this.elements[2]=r$S[r$Q+2],this.elements[3]=r$S[r$Q+3]},r$Q.cloneTo=function(r$S){var r$Q=r$S.elements,r$e=this.elements;r$Q[0]=r$e[0],r$Q[1]=r$e[1],r$Q[2]=r$e[2],r$Q[3]=r$e[3]},r$Q.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$Q.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},r$Q.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},r$L(0,r$Q,"x",function(){return this.elements[0]},function(r$S){this.elements[0]=r$S}),r$L(0,r$Q,"y",function(){return this.elements[1]},function(r$S){this.elements[1]=r$S}),r$L(0,r$Q,"z",function(){return this.elements[2]},function(r$S){this.elements[2]=r$S}),r$L(0,r$Q,"w",function(){return this.elements[3]},function(r$S){this.elements[3]=r$S}),r$S.lerp=function(r$S,r$Q,r$e,r$l){var r$M=r$l.elements,r$d=r$S.elements,r$T=r$Q.elements,r$U=r$d[0],r$i=r$d[1],r$R=r$d[2],r$o=r$d[3];r$M[0]=r$U+r$e*(r$T[0]-r$U),r$M[1]=r$i+r$e*(r$T[1]-r$i),r$M[2]=r$R+r$e*(r$T[2]-r$R),r$M[3]=r$o+r$e*(r$T[3]-r$o)},r$S.transformByM4x4=function(r$S,r$Q,r$e){var r$l=r$S.elements,r$M=r$l[0],r$d=r$l[1],r$T=r$l[2],r$U=r$l[3],r$i=r$Q.elements,r$R=r$e.elements;r$R[0]=r$M*r$i[0]+r$d*r$i[4]+r$T*r$i[8]+r$U*r$i[12],r$R[1]=r$M*r$i[1]+r$d*r$i[5]+r$T*r$i[9]+r$U*r$i[13],r$R[2]=r$M*r$i[2]+r$d*r$i[6]+r$T*r$i[10]+r$U*r$i[14],r$R[3]=r$M*r$i[3]+r$d*r$i[7]+r$T*r$i[11]+r$U*r$i[15]},r$S.equals=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements;return r$sS.nearEqual(Math.abs(r$e[0]),Math.abs(r$l[0]))&&r$sS.nearEqual(Math.abs(r$e[1]),Math.abs(r$l[1]))&&r$sS.nearEqual(Math.abs(r$e[2]),Math.abs(r$l[2]))&&r$sS.nearEqual(Math.abs(r$e[3]),Math.abs(r$l[3]))},r$S.normalize=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements,r$M=r$S.length();0<r$M&&(r$l[0]=r$e[0]*r$M,r$l[1]=r$e[1]*r$M,r$l[2]=r$e[2]*r$M,r$l[3]=r$e[3]*r$M)},r$S.add=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q.elements;r$l[0]=r$M[0]+r$d[0],r$l[1]=r$M[1]+r$d[1],r$l[2]=r$M[2]+r$d[2],r$l[3]=r$M[3]+r$d[3]},r$S.subtract=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q.elements;r$l[0]=r$M[0]-r$d[0],r$l[1]=r$M[1]-r$d[1],r$l[2]=r$M[2]-r$d[2],r$l[3]=r$M[3]-r$d[3]},r$S.multiply=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q.elements;r$l[0]=r$M[0]*r$d[0],r$l[1]=r$M[1]*r$d[1],r$l[2]=r$M[2]*r$d[2],r$l[3]=r$M[3]*r$d[3]},r$S.scale=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements;r$l[0]=r$M[0]*r$Q,r$l[1]=r$M[1]*r$Q,r$l[2]=r$M[2]*r$Q,r$l[3]=r$M[3]*r$Q},r$S.Clamp=function(r$S,r$Q,r$e,r$l){var r$M=r$S.elements,r$d=r$M[0],r$T=r$M[1],r$U=r$M[2],r$i=r$M[3],r$R=r$Q.elements,r$o=r$R[0],r$Y=r$R[1],r$p=r$R[2],r$J=r$R[3],r$L=r$e.elements,r$j=r$L[0],r$c=r$L[1],r$G=r$L[2],r$z=r$L[3],r$A=r$l.elements;r$d=(r$d=r$j<r$d?r$j:r$d)<r$o?r$o:r$d,r$T=(r$T=r$c<r$T?r$c:r$T)<r$Y?r$Y:r$T,r$U=(r$U=r$G<r$U?r$G:r$U)<r$p?r$p:r$U,r$i=(r$i=r$z<r$i?r$z:r$i)<r$J?r$J:r$i,r$A[0]=r$d,r$A[1]=r$T,r$A[2]=r$U,r$A[3]=r$i},r$S.distanceSquared=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements,r$M=r$e[0]-r$l[0],r$d=r$e[1]-r$l[1],r$T=r$e[2]-r$l[2],r$U=r$e[3]-r$l[3];return r$M*r$M+r$d*r$d+r$T*r$T+r$U*r$U},r$S.distance=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements,r$M=r$e[0]-r$l[0],r$d=r$e[1]-r$l[1],r$T=r$e[2]-r$l[2],r$U=r$e[3]-r$l[3];return Math.sqrt(r$M*r$M+r$d*r$d+r$T*r$T+r$U*r$U)},r$S.dot=function(r$S,r$Q){var r$e=r$S.elements,r$l=r$Q.elements;return r$e[0]*r$l[0]+r$e[1]*r$l[1]+r$e[2]*r$l[2]+r$e[3]*r$l[3]},r$S.min=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q.elements;r$l[0]=Math.min(r$M[0],r$d[0]),r$l[1]=Math.min(r$M[1],r$d[1]),r$l[2]=Math.min(r$M[2],r$d[2]),r$l[3]=Math.min(r$M[3],r$d[3])},r$S.max=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q.elements;r$l[0]=Math.max(r$M[0],r$d[0]),r$l[1]=Math.max(r$M[1],r$d[1]),r$l[2]=Math.max(r$M[2],r$d[2]),r$l[3]=Math.max(r$M[3],r$d[3])},r$Y(r$S,["ZERO",function(){return this.ZERO=new r$S},"ONE",function(){return this.ONE=new r$S(1,1,1,1)},"UnitX",function(){return this.UnitX=new r$S(1,0,0,0)},"UnitY",function(){return this.UnitY=new r$S(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new r$S(0,0,1,0)},"UnitW",function(){return this.UnitW=new r$S(0,0,0,1)}]),r$S}(),r$iQ=function(){function r$d(r$S,r$Q,r$e,r$l){this.minDepth=0,this.maxDepth=1,this.x=r$S,this.y=r$Q,this.width=r$e,this.height=r$l}r$J(r$d,"laya.d3.math.Viewport");var r$S=r$d.prototype;return r$S.project=function(r$S,r$Q,r$e){r$TQ.transformV3ToV3(r$S,r$Q,r$e);var r$l=r$S.elements,r$M=r$Q.elements,r$d=r$e.elements,r$T=r$l[0]*r$M[3]+r$l[1]*r$M[7]+r$l[2]*r$M[11]+r$M[15];1!==r$T&&(r$d[0]=r$d[0]/r$T,r$d[1]=r$d[1]/r$T,r$d[2]=r$d[2]/r$T),r$d[0]=.5*(r$d[0]+1)*this.width+this.x,r$d[1]=.5*(1-r$d[1])*this.height+this.y,r$d[2]=r$d[2]*(this.maxDepth-this.minDepth)+this.minDepth},r$S.unprojectFromMat=function(r$S,r$Q,r$e){var r$l=r$S.elements,r$M=r$Q.elements,r$d=r$e.elements;r$d[0]=(r$l[0]-this.x)/this.width*2-1,r$d[1]=-((r$l[1]-this.y)/this.height*2-1);var r$T=(this.maxDepth-this.minDepth)/2;r$d[2]=(r$l[2]-this.minDepth-r$T)/r$T;var r$U=r$d[0]*r$M[3]+r$d[1]*r$M[7]+r$d[2]*r$M[11]+r$M[15];r$TQ.transformV3ToV3(r$e,r$Q,r$e),1!==r$U&&(r$d[0]=r$d[0]/r$U,r$d[1]=r$d[1]/r$U,r$d[2]=r$d[2]/r$U)},r$S.unprojectFromWVP=function(r$S,r$Q,r$e,r$l,r$M){r$SQ.multiply(r$Q,r$e,r$d._tempMatrix4x4),r$l&&r$SQ.multiply(r$d._tempMatrix4x4,r$l,r$d._tempMatrix4x4),r$d._tempMatrix4x4.invert(r$d._tempMatrix4x4),this.unprojectFromMat(r$S,r$d._tempMatrix4x4,r$M)},r$Y(r$d,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new r$SQ}]),r$d}(),r$RQ=function(){function r$t(r$S){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=r$S,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}r$J(r$t,"laya.d3.resource.models.SubMesh");var r$S=r$t.prototype;return r$D.imps(r$S,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),r$S._getVertexBuffer=function(r$S){return void 0===r$S&&(r$S=0),0===r$S?this._vertexBuffer:null},r$S._getIndexBuffer=function(){return this._indexBuffer},r$S._getStaticBatchBakedVertexs=function(r$S,r$Q){var r$e,r$l,r$M=this._vertexBuffer,r$d=r$M.vertexDeclaration,r$T=r$d.getVertexElementByUsage(0).offset/4,r$U=r$d.getVertexElementByUsage(3).offset/4,r$i=r$Q.meshRender.lightmapScaleOffset,r$R=0,r$o=0,r$Y=0,r$p=0,r$J=0,r$L=0;if(r$i)if(r$l=r$d.getVertexElementByUsage(15))r$Y=r$d.vertexStride/4,r$e=0<this._vertexCount?r$M.getData().slice(this._vertexStart*r$Y,(this._vertexStart+this._vertexCount)*r$Y):r$M.getData().slice(),r$p=r$l.offset/4;else{r$Y=(r$L=r$d.vertexStride/4)+2,r$e=this._vertexCount?new Float32Array(this._vertexCount*(r$M.vertexDeclaration.vertexStride/4+2)):new Float32Array(r$M.vertexCount*(r$M.vertexDeclaration.vertexStride/4+2)),r$p=(r$J=r$d.getVertexElementByUsage(2).offset/4)+2;var r$j=r$M.getData();for(r$R=0,r$o=r$j.length/r$L;r$R<r$o;r$R++){var r$c=0;r$c=0<this._vertexCount?(this._vertexStart+r$R)*r$L:r$R*r$L;var r$G=r$R*r$Y,r$z=0;for(r$z=0;r$z<r$p;r$z++)r$e[r$G+r$z]=r$j[r$c+r$z];for(r$z=r$p;r$z<r$L;r$z++)r$e[r$G+r$z+2]=r$j[r$c+r$z]}}else r$Y=r$d.vertexStride/4,r$e=this._vertexCount?r$M.getData().slice(this._vertexStart*r$Y,(this._vertexStart+this._vertexCount)*r$Y):r$M.getData().slice();if(r$S){var r$A=r$S.worldMatrix,r$v=r$t._tempMatrix4x40;r$A.invert(r$v);var r$D=r$t._tempMatrix4x41,r$B=r$Q.transform.worldMatrix;r$SQ.multiply(r$v,r$B,r$D)}else r$D=r$Q.transform.worldMatrix;var r$O=r$t._tempQuaternion0;for(r$D.decomposeTransRotScale(r$t._tempVector30,r$O,r$t._tempVector31),r$R=0,r$o=r$e.length/r$Y;r$R<r$o;r$R++){var r$H=r$R*r$Y+r$T,r$g=r$R*r$Y+r$U;if(r$cQ.transformVector3ArrayToVector3ArrayCoordinate(r$e,r$H,r$D,r$e,r$H),r$cQ.transformVector3ArrayByQuat(r$e,r$g,r$O,r$e,r$g),r$i){var r$I=r$R*r$Y+r$p;if(r$l)r$cQ.transformLightingMapTexcoordByUV1Array(r$e,r$I,r$i,r$e,r$I);else{var r$E=r$R*r$L+r$J;r$cQ.transformLightingMapTexcoordByUV0Array(r$j,r$E,r$i,r$e,r$I)}}}return r$e},r$S._getVertexBuffers=function(){return null},r$S._beforeRender=function(r$S){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},r$S._render=function(r$S){var r$Q,r$e=0,r$l=r$S.renderElement;if(1<this._indexCount){var r$M=this._boneIndicesList.length;if(1<r$M){for(var r$d=0;r$d<r$M;r$d++)(r$Q=r$l._skinAnimationDatas||this._skinAnimationDatas)&&(r$l._shaderValue.setValue(0,r$Q[r$d]),r$S._shader.uploadRenderElementUniforms(r$l._shaderValue.data)),r$k.mainContext.drawElements(4,this._subIndexBufferCount[r$d],5123,2*this._subIndexBufferStart[r$d]);r$H.drawCall+=r$M}else(r$Q=r$l._skinAnimationDatas||this._skinAnimationDatas)&&(r$l._shaderValue.setValue(0,r$Q[0]),r$S._shader.uploadRenderElementUniforms(r$l._shaderValue.data)),r$k.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),r$H.drawCall++;r$e=this._indexCount}else r$e=this._indexBuffer.indexCount,(r$Q=r$l._skinAnimationDatas||this._skinAnimationDatas)&&(r$l._shaderValue.setValue(0,r$Q[0]),r$S._shader.uploadRenderElementUniforms(r$l._shaderValue.data)),r$k.mainContext.drawElements(4,r$e,5123,0),r$H.drawCall++;r$H.trianglesFaces+=r$e/3},r$S.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},r$S.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},r$L(0,r$S,"_vertexBufferCount",function(){return 1}),r$L(0,r$S,"triangleCount",function(){return this._indexBuffer.indexCount/3}),r$Y(r$t,["_tempVector30",function(){return this._tempVector30=new r$TQ},"_tempVector31",function(){return this._tempVector31=new r$TQ},"_tempQuaternion0",function(){return this._tempQuaternion0=new r$eQ},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new r$SQ},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new r$SQ}]),r$t}(),r$oQ=function(){function r$S(r$S){this.defineCounter=0,this.defines=null,r$S?(this.defineCounter=r$S.defineCounter,this.defines=r$S.defines.slice()):(this.defineCounter=0,this.defines=[])}return r$J(r$S,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),r$S.prototype.registerDefine=function(r$S){var r$Q=Math.pow(2,this.defineCounter++);return this.defines[r$Q]=r$S,r$Q},r$S}(),r$YQ=function(){function r$S(){}return r$J(r$S,"laya.d3.shader.ShaderInit3D"),r$S.__init__=function(){var r$S,r$Q;r$HQ._globalRegDefine("HIGHPRECISION",r$HQ.SHADERDEFINE_HIGHPRECISION),r$HQ._globalRegDefine("FOG",r$HQ.SHADERDEFINE_FOG),r$HQ._globalRegDefine("DIRECTIONLIGHT",r$HQ.SHADERDEFINE_DIRECTIONLIGHT),r$HQ._globalRegDefine("POINTLIGHT",r$HQ.SHADERDEFINE_POINTLIGHT),r$HQ._globalRegDefine("SPOTLIGHT",r$HQ.SHADERDEFINE_SPOTLIGHT),r$HQ._globalRegDefine("UV",r$HQ.SHADERDEFINE_UV0),r$HQ._globalRegDefine("COLOR",r$HQ.SHADERDEFINE_COLOR),r$HQ._globalRegDefine("UV1",r$HQ.SHADERDEFINE_UV1),r$HQ._globalRegDefine("CASTSHADOW",r$JQ.SHADERDEFINE_CAST_SHADOW),r$HQ._globalRegDefine("SHADOWMAP_PSSM1",r$JQ.SHADERDEFINE_SHADOW_PSSM1),r$HQ._globalRegDefine("SHADOWMAP_PSSM2",r$JQ.SHADERDEFINE_SHADOW_PSSM2),r$HQ._globalRegDefine("SHADOWMAP_PSSM3",r$JQ.SHADERDEFINE_SHADOW_PSSM3),r$HQ._globalRegDefine("SHADOWMAP_PCF_NO",r$JQ.SHADERDEFINE_SHADOW_PCF_NO),r$HQ._globalRegDefine("SHADOWMAP_PCF1",r$JQ.SHADERDEFINE_SHADOW_PCF1),r$HQ._globalRegDefine("SHADOWMAP_PCF2",r$JQ.SHADERDEFINE_SHADOW_PCF2),r$HQ._globalRegDefine("SHADOWMAP_PCF3",r$JQ.SHADERDEFINE_SHADOW_PCF3),r$HQ._globalRegDefine("DEPTHFOG",r$HQ.SAHDERDEFINE_DEPTHFOG),r$nQ.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),r$nQ.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),r$S={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},r$Q={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var r$e=r$nQ.nameKey.add("SIMPLE");shaderCompile=r$HQ.add(r$e,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',r$S,r$Q),r$PQ.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),r$PQ.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),r$PQ.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),r$PQ.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),r$PQ.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),r$PQ.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),r$PQ.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),r$PQ.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),r$PQ.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},r$S}(),r$pQ=function(){function r$S(){this._data=null,this._data=[]}r$J(r$S,"laya.d3.shader.ValusArray");var r$Q=r$S.prototype;return r$Q.setValue=function(r$S,r$Q){this._data[r$S]=r$Q},r$L(0,r$Q,"data",function(){return this._data}),r$S}(),r$JQ=function(){function r$S(){}return r$S.SHADERDEFINE_RECEIVE_SHADOW=1,r$S.SHADERDEFINE_CAST_SHADOW=512,r$S.SHADERDEFINE_SHADOW_PSSM1=1024,r$S.SHADERDEFINE_SHADOW_PSSM2=2048,r$S.SHADERDEFINE_SHADOW_PSSM3=4096,r$S.SHADERDEFINE_SHADOW_PCF_NO=8192,r$S.SHADERDEFINE_SHADOW_PCF1=16384,r$S.SHADERDEFINE_SHADOW_PCF2=32768,r$S.SHADERDEFINE_SHADOW_PCF3=65536,r$S.MAX_PSSM_COUNT=3,r$S}(),r$LQ=function(){function r$N(){}return r$J(r$N,"laya.d3.utils.Picker"),r$N.calculateCursorRay=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=r$S.elements[0],r$U=r$S.elements[1],r$i=r$N._tempVector30,r$R=r$i.elements;r$R[0]=r$T,r$R[1]=r$U,r$R[2]=r$Q.minDepth;var r$o=r$N._tempVector31,r$Y=r$o.elements;r$Y[0]=r$T,r$Y[1]=r$U,r$Y[2]=r$Q.maxDepth;var r$p=r$d.origin,r$J=r$N._tempVector32;r$Q.unprojectFromWVP(r$i,r$e,r$l,r$M,r$p),r$Q.unprojectFromWVP(r$o,r$e,r$l,r$M,r$J);var r$L=r$d.direction.elements;r$L[0]=r$J.x-r$p.x,r$L[1]=r$J.y-r$p.y,r$L[2]=r$J.z-r$p.z,r$TQ.normalize(r$d.direction,r$d.direction)},r$N.rayIntersectsPositionsAndIndices=function(r$S,r$Q,r$e,r$l,r$M){for(var r$d=r$e.vertexStride/4,r$T=r$e.getVertexElementByUsage(0).offset/4,r$U=Number.MAX_VALUE,r$i=-1,r$R=-1,r$o=-1,r$Y=0;r$Y<r$l.length;r$Y+=3){var r$p=r$N._tempVector35,r$J=r$p.elements,r$L=r$l[r$Y]*r$d,r$j=r$L+r$T;r$J[0]=r$Q[r$j],r$J[1]=r$Q[1+r$j],r$J[2]=r$Q[2+r$j];var r$c=r$N._tempVector36,r$G=r$c.elements,r$z=r$l[r$Y+1]*r$d,r$A=r$z+r$T;r$G[0]=r$Q[r$A],r$G[1]=r$Q[1+r$A],r$G[2]=r$Q[2+r$A];var r$v=r$N._tempVector37,r$D=r$v.elements,r$B=r$l[r$Y+2]*r$d,r$O=r$B+r$T;r$D[0]=r$Q[r$O],r$D[1]=r$Q[1+r$O],r$D[2]=r$Q[2+r$O];var r$H=laya.d3.utils.Picker.rayIntersectsTriangle(r$S,r$p,r$c,r$v);!isNaN(r$H)&&r$H<r$U&&(r$U=r$H,r$i=r$L,r$R=r$z,r$o=r$B)}if(r$U===Number.MAX_VALUE)return r$M.position.toDefault(),r$M.distance=Number.MAX_VALUE,r$M.trianglePositions[0].toDefault(),r$M.trianglePositions[1].toDefault(),r$M.trianglePositions[2].toDefault(),r$M.triangleNormals[0].toDefault(),r$M.triangleNormals[1].toDefault(),r$M.triangleNormals[2].toDefault(),!1;r$M.distance=r$U,r$TQ.scale(r$S.direction,r$U,r$M.position),r$TQ.add(r$S.origin,r$M.position,r$M.position);var r$g=r$M.trianglePositions,r$I=r$g[0],r$E=r$g[1],r$t=r$g[2],r$k=r$I.elements,r$X=r$E.elements,r$h=r$t.elements,r$b=r$i+r$T;r$k[0]=r$Q[r$b],r$k[1]=r$Q[r$b+1],r$k[2]=r$Q[r$b+2];var r$m=r$R+r$T;r$X[0]=r$Q[r$m],r$X[1]=r$Q[r$m+1],r$X[2]=r$Q[r$m+2];var r$$=r$o+r$T;r$h[0]=r$Q[r$$],r$h[1]=r$Q[r$$+1],r$h[2]=r$Q[r$$+2];var r$n=r$e.getVertexElementByUsage(3);if(r$n){var r$P=r$n.offset/4,r$a=r$M.triangleNormals,r$f=r$a[0],r$w=r$a[1],r$u=r$a[2],r$r=r$f.elements,r$W=r$w.elements,r$x=r$u.elements,r$F=r$i+r$P;r$r[0]=r$Q[r$F],r$r[1]=r$Q[r$F+1],r$r[2]=r$Q[r$F+2];var r$q=r$R+r$P;r$W[0]=r$Q[r$q],r$W[1]=r$Q[r$q+1],r$W[2]=r$Q[r$q+2];var r$Z=r$o+r$P;r$x[0]=r$Q[r$Z],r$x[1]=r$Q[r$Z+1],r$x[2]=r$Q[r$Z+2]}return!0},r$N.rayIntersectsTriangle=function(r$S,r$Q,r$e,r$l){var r$M=r$N._tempVector30,r$d=r$N._tempVector31;r$TQ.subtract(r$e,r$Q,r$M),r$TQ.subtract(r$l,r$Q,r$d);var r$T,r$U=r$N._tempVector32;if(r$TQ.cross(r$S.direction,r$d,r$U),(r$T=r$TQ.dot(r$M,r$U))>-Number.MIN_VALUE&&r$T<Number.MIN_VALUE)return Number.NaN;var r$i,r$R=1/r$T,r$o=r$N._tempVector33;if(r$TQ.subtract(r$S.origin,r$Q,r$o),r$i=r$TQ.dot(r$o,r$U),(r$i*=r$R)<0||1<r$i)return Number.NaN;var r$Y,r$p,r$J=r$N._tempVector34;return r$TQ.cross(r$o,r$M,r$J),r$Y=r$TQ.dot(r$S.direction,r$J),(r$Y*=r$R)<0||1<r$i+r$Y?Number.NaN:(r$p=r$TQ.dot(r$d,r$J),(r$p*=r$R)<0?Number.NaN:r$p)},r$Y(r$N,["_tempVector30",function(){return this._tempVector30=new r$TQ},"_tempVector31",function(){return this._tempVector31=new r$TQ},"_tempVector32",function(){return this._tempVector32=new r$TQ},"_tempVector33",function(){return this._tempVector33=new r$TQ},"_tempVector34",function(){return this._tempVector34=new r$TQ},"_tempVector35",function(){return this._tempVector35=new r$TQ},"_tempVector36",function(){return this._tempVector36=new r$TQ},"_tempVector37",function(){return this._tempVector37=new r$TQ}]),r$N}(),r$jQ=(function(){function r$S(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new r$TQ,new r$TQ,new r$TQ],this.trianglePositions.length=3,this.triangleNormals=[new r$TQ,new r$TQ,new r$TQ],this.triangleNormals.length=3,this.position=new r$TQ}r$J(r$S,"laya.d3.utils.RaycastHit"),r$S.prototype.cloneTo=function(r$S){r$S.distance=this.distance,this.trianglePositions[0].cloneTo(r$S.trianglePositions[0]),this.trianglePositions[1].cloneTo(r$S.trianglePositions[1]),this.trianglePositions[2].cloneTo(r$S.trianglePositions[2]),this.triangleNormals[0].cloneTo(r$S.triangleNormals[0]),this.triangleNormals[1].cloneTo(r$S.triangleNormals[1]),this.triangleNormals[2].cloneTo(r$S.triangleNormals[2]),this.position.cloneTo(r$S.position),r$S.sprite3D=this.sprite3D}}(),function(){function r$S(r$S,r$Q){this._width=0,this._height=0,this._width=r$S,this._height=r$Q}r$J(r$S,"laya.d3.utils.Size");var r$Q=r$S.prototype;return r$L(0,r$Q,"width",function(){return-1===this._width?r$C.clientWidth:this._width}),r$L(0,r$Q,"height",function(){return-1===this._height?r$C.clientHeight:this._height}),r$L(1,r$S,"fullScreen",function(){return new r$S(-1,-1)}),r$S}()),r$cQ=function(){function r$b(){}return r$J(r$b,"laya.d3.utils.Utils3D"),r$b._rotationTransformScaleSkinAnimation=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o,r$Y){var r$p,r$J,r$L,r$j,r$c,r$G=r$b._tempArray16_0,r$z=r$b._tempArray16_1,r$A=r$b._tempArray16_2,r$v=r$l+r$l,r$D=r$M+r$M,r$B=r$d+r$d,r$O=r$l*r$v,r$H=r$M*r$v,r$g=r$M*r$D,r$I=r$d*r$v,r$E=r$d*r$D,r$t=r$d*r$B,r$k=r$T*r$v,r$X=r$T*r$D,r$h=r$T*r$B;for(r$G[15]=1,r$G[0]=1-r$g-r$t,r$G[1]=r$H+r$h,r$G[2]=r$I-r$X,r$G[4]=r$H-r$h,r$G[5]=1-r$O-r$t,r$G[6]=r$E+r$k,r$G[8]=r$I+r$X,r$G[9]=r$E-r$k,r$G[10]=1-r$O-r$g,r$z[15]=1,r$z[0]=r$U,r$z[5]=r$i,r$z[10]=r$R,r$p=0;r$p<4;r$p++)r$J=r$G[r$p],r$L=r$G[r$p+4],r$j=r$G[r$p+8],r$c=r$G[r$p+12],r$A[r$p]=r$J,r$A[r$p+4]=r$L,r$A[r$p+8]=r$j,r$A[r$p+12]=r$J*r$S+r$L*r$Q+r$j*r$e+r$c;for(r$p=0;r$p<4;r$p++)r$J=r$A[r$p],r$L=r$A[r$p+4],r$j=r$A[r$p+8],r$c=r$A[r$p+12],r$o[r$p+r$Y]=r$J*r$z[0]+r$L*r$z[1]+r$j*r$z[2]+r$c*r$z[3],r$o[r$p+r$Y+4]=r$J*r$z[4]+r$L*r$z[5]+r$j*r$z[6]+r$c*r$z[7],r$o[r$p+r$Y+8]=r$J*r$z[8]+r$L*r$z[9]+r$j*r$z[10]+r$c*r$z[11],r$o[r$p+r$Y+12]=r$J*r$z[12]+r$L*r$z[13]+r$j*r$z[14]+r$c*r$z[15]},r$b._createNodeByJson=function(r$S,r$Q,r$e,r$l){if(!r$e)switch(r$Q.type){case"Sprite3D":r$e=new r$$Q;break;case"MeshSprite3D":r$e=new r$NQ;break;case"SkinnedMeshSprite3D":r$e=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":r$e=new ShuriKenParticle3D;break;case"TrailSprite3D":r$e=new TrailSprite3D;break;case"Terrain":r$e=new Terrain;break;case"Camera":r$e=new r$ZQ;break;case"DirectionLight":r$e=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var r$M=r$Q.props;if(r$M)for(var r$d in r$M)r$e[r$d]=r$M[r$d];var r$T=r$Q.customProps;r$T&&(r$e instanceof laya.d3.core.Sprite3D?(r$e._parseBaseCustomProps(r$T),r$e._parseCustomProps(r$S,r$l,r$T,r$Q),r$e._parseCustomComponent(r$S,r$l,r$Q.components)):r$e._parseCustomProps(r$S,r$l,r$T,r$Q));var r$U=r$Q.child;if(r$U)for(var r$i=0,r$R=r$U.length;r$i<r$R;r$i++){var r$o=r$b._createNodeByJson(r$S,r$U[r$i],null,r$l);r$e.addChild(r$o)}return r$e},r$b._computeBoneAndAnimationDatasByBindPoseMatrxix=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T,r$U,r$i=0,r$R=0,r$o=r$S.length;for(r$T=0;r$T<r$o;r$i+=r$S[r$T].keyframeWidth,r$R+=16,r$T++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(r$Q[r$i+0],r$Q[r$i+1],r$Q[r$i+2],r$Q[r$i+3],r$Q[r$i+4],r$Q[r$i+5],r$Q[r$i+6],r$Q[r$i+7],r$Q[r$i+8],r$Q[r$i+9],r$l,r$R),0!=r$T&&(r$U=16*r$S[r$T].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(r$l,r$U,r$l,r$R,r$l,r$R));var r$Y=r$e.length;for(r$T=0;r$T<r$Y;r$T++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(r$l,16*r$d[r$T],r$e[r$T],r$M,16*r$T)},r$b._computeAnimationDatasByArrayAndMatrixFast=function(r$S,r$Q,r$e,r$l){for(var r$M=0,r$d=r$S.length;r$M<r$d;r$M++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(r$Q,16*r$l[r$M],r$S[r$M],r$e,16*r$M)},r$b._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(r$S,r$Q,r$e,r$l,r$M){var r$d,r$T,r$U=0,r$i=0,r$R=r$S.length;for(r$d=0;r$d<r$R;r$U+=r$S[r$d].keyframeWidth,r$i+=16,r$d++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(r$Q[r$U+7],r$Q[r$U+8],r$Q[r$U+9],r$Q[r$U+3],r$Q[r$U+4],r$Q[r$U+5],r$Q[r$U+6],r$Q[r$U+0],r$Q[r$U+1],r$Q[r$U+2],r$l,r$i),0!=r$d&&(r$T=16*r$S[r$d].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(r$l,r$T,r$l,r$i,r$l,r$i));var r$o=r$e.length;for(r$d=0;r$d<r$o;r$d++){var r$Y=16*r$d;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(r$l,r$Y,r$e[r$d],r$M,r$Y)}},r$b._computeAnimationDatasByArrayAndMatrixFastOld=function(r$S,r$Q,r$e){for(var r$l=r$S.length,r$M=0;r$M<r$l;r$M++){var r$d=16*r$M;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(r$Q,r$d,r$S[r$M],r$e,r$d)}},r$b._computeRootAnimationData=function(r$S,r$Q,r$e){for(var r$l=0,r$M=0,r$d=0,r$T=r$S.length;r$l<r$T;r$M+=r$S[r$l].keyframeWidth,r$d+=16,r$l++)laya.d3.utils.Utils3D.createAffineTransformationArray(r$Q[r$M+0],r$Q[r$M+1],r$Q[r$M+2],r$Q[r$M+3],r$Q[r$M+4],r$Q[r$M+5],r$Q[r$M+6],r$Q[r$M+7],r$Q[r$M+8],r$Q[r$M+9],r$e,r$d)},r$b.transformVector3ArrayByQuat=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$e.elements,r$T=r$S[r$Q],r$U=r$S[r$Q+1],r$i=r$S[r$Q+2],r$R=r$d[0],r$o=r$d[1],r$Y=r$d[2],r$p=r$d[3],r$J=r$p*r$T+r$o*r$i-r$Y*r$U,r$L=r$p*r$U+r$Y*r$T-r$R*r$i,r$j=r$p*r$i+r$R*r$U-r$o*r$T,r$c=-r$R*r$T-r$o*r$U-r$Y*r$i;r$l[r$M]=r$J*r$p+r$c*-r$R+r$L*-r$Y-r$j*-r$o,r$l[r$M+1]=r$L*r$p+r$c*-r$o+r$j*-r$R-r$J*-r$Y,r$l[r$M+2]=r$j*r$p+r$c*-r$Y+r$J*-r$o-r$L*-r$R},r$b.mulMatrixByArray=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T,r$U,r$i,r$R,r$o;if(r$M===r$e){for(r$e=r$b._tempArray16_3,r$T=0;r$T<16;++r$T)r$e[r$T]=r$M[r$d+r$T];r$l=0}for(r$T=0;r$T<4;r$T++)r$U=r$S[r$Q+r$T],r$i=r$S[r$Q+r$T+4],r$R=r$S[r$Q+r$T+8],r$o=r$S[r$Q+r$T+12],r$M[r$d+r$T]=r$U*r$e[r$l+0]+r$i*r$e[r$l+1]+r$R*r$e[r$l+2]+r$o*r$e[r$l+3],r$M[r$d+r$T+4]=r$U*r$e[r$l+4]+r$i*r$e[r$l+5]+r$R*r$e[r$l+6]+r$o*r$e[r$l+7],r$M[r$d+r$T+8]=r$U*r$e[r$l+8]+r$i*r$e[r$l+9]+r$R*r$e[r$l+10]+r$o*r$e[r$l+11],r$M[r$d+r$T+12]=r$U*r$e[r$l+12]+r$i*r$e[r$l+13]+r$R*r$e[r$l+14]+r$o*r$e[r$l+15]},r$b.mulMatrixByArrayFast=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T,r$U,r$i,r$R,r$o;for(r$T=0;r$T<4;r$T++)r$U=r$S[r$Q+r$T],r$i=r$S[r$Q+r$T+4],r$R=r$S[r$Q+r$T+8],r$o=r$S[r$Q+r$T+12],r$M[r$d+r$T]=r$U*r$e[r$l+0]+r$i*r$e[r$l+1]+r$R*r$e[r$l+2]+r$o*r$e[r$l+3],r$M[r$d+r$T+4]=r$U*r$e[r$l+4]+r$i*r$e[r$l+5]+r$R*r$e[r$l+6]+r$o*r$e[r$l+7],r$M[r$d+r$T+8]=r$U*r$e[r$l+8]+r$i*r$e[r$l+9]+r$R*r$e[r$l+10]+r$o*r$e[r$l+11],r$M[r$d+r$T+12]=r$U*r$e[r$l+12]+r$i*r$e[r$l+13]+r$R*r$e[r$l+14]+r$o*r$e[r$l+15]},r$b.mulMatrixByArrayAndMatrixFast=function(r$S,r$Q,r$e,r$l,r$M){var r$d,r$T,r$U,r$i,r$R,r$o=r$e.elements,r$Y=r$o[0],r$p=r$o[1],r$J=r$o[2],r$L=r$o[3],r$j=r$o[4],r$c=r$o[5],r$G=r$o[6],r$z=r$o[7],r$A=r$o[8],r$v=r$o[9],r$D=r$o[10],r$B=r$o[11],r$O=r$o[12],r$H=r$o[13],r$g=r$o[14],r$I=r$o[15],r$E=r$Q,r$t=r$Q+4,r$k=r$Q+8,r$X=r$Q+12,r$h=r$M,r$b=r$M+4,r$m=r$M+8,r$$=r$M+12;for(r$d=0;r$d<4;r$d++)r$T=r$S[r$E+r$d],r$U=r$S[r$t+r$d],r$i=r$S[r$k+r$d],r$R=r$S[r$X+r$d],r$l[r$h+r$d]=r$T*r$Y+r$U*r$p+r$i*r$J+r$R*r$L,r$l[r$b+r$d]=r$T*r$j+r$U*r$c+r$i*r$G+r$R*r$z,r$l[r$m+r$d]=r$T*r$A+r$U*r$v+r$i*r$D+r$R*r$B,r$l[r$$+r$d]=r$T*r$O+r$U*r$H+r$i*r$g+r$R*r$I},r$b.createAffineTransformationArray=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o,r$Y){var r$p=r$l+r$l,r$J=r$M+r$M,r$L=r$d+r$d,r$j=r$l*r$p,r$c=r$l*r$J,r$G=r$l*r$L,r$z=r$M*r$J,r$A=r$M*r$L,r$v=r$d*r$L,r$D=r$T*r$p,r$B=r$T*r$J,r$O=r$T*r$L;r$o[r$Y+0]=(1-(r$z+r$v))*r$U,r$o[r$Y+1]=(r$c+r$O)*r$U,r$o[r$Y+2]=(r$G-r$B)*r$U,r$o[r$Y+3]=0,r$o[r$Y+4]=(r$c-r$O)*r$i,r$o[r$Y+5]=(1-(r$j+r$v))*r$i,r$o[r$Y+6]=(r$A+r$D)*r$i,r$o[r$Y+7]=0,r$o[r$Y+8]=(r$G+r$B)*r$R,r$o[r$Y+9]=(r$A-r$D)*r$R,r$o[r$Y+10]=(1-(r$j+r$z))*r$R,r$o[r$Y+11]=0,r$o[r$Y+12]=r$S,r$o[r$Y+13]=r$Q,r$o[r$Y+14]=r$e,r$o[r$Y+15]=1},r$b.transformVector3ArrayToVector3ArrayCoordinate=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$b._tempArray4_0,r$T=r$S[r$Q+0],r$U=r$S[r$Q+1],r$i=r$S[r$Q+2],r$R=r$e.elements;r$d[0]=r$T*r$R[0]+r$U*r$R[4]+r$i*r$R[8]+r$R[12],r$d[1]=r$T*r$R[1]+r$U*r$R[5]+r$i*r$R[9]+r$R[13],r$d[2]=r$T*r$R[2]+r$U*r$R[6]+r$i*r$R[10]+r$R[14],r$d[3]=1/(r$T*r$R[3]+r$U*r$R[7]+r$i*r$R[11]+r$R[15]),r$l[r$M+0]=r$d[0]*r$d[3],r$l[r$M+1]=r$d[1]*r$d[3],r$l[r$M+2]=r$d[2]*r$d[3]},r$b.transformLightingMapTexcoordByUV0Array=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$e.elements;r$l[r$M+0]=r$S[r$Q+0]*r$d[0]+r$d[2],r$l[r$M+1]=(r$S[r$Q+1]-1)*r$d[1]+r$d[3]},r$b.transformLightingMapTexcoordByUV1Array=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$e.elements;r$l[r$M+0]=r$S[r$Q+0]*r$d[0]+r$d[2],r$l[r$M+1]=1+r$S[r$Q+1]*r$d[1]+r$d[3]},r$b.getURLVerion=function(r$S){var r$Q=r$S.indexOf("?");return 0<=r$Q?r$S.substr(r$Q):null},r$b._quaternionCreateFromYawPitchRollArray=function(r$S,r$Q,r$e,r$l){var r$M=.5*r$e,r$d=.5*r$Q,r$T=.5*r$S,r$U=Math.sin(r$M),r$i=Math.cos(r$M),r$R=Math.sin(r$d),r$o=Math.cos(r$d),r$Y=Math.sin(r$T),r$p=Math.cos(r$T);r$l[0]=r$p*r$R*r$i+r$Y*r$o*r$U,r$l[1]=r$Y*r$o*r$i-r$p*r$R*r$U,r$l[2]=r$p*r$o*r$U-r$Y*r$R*r$i,r$l[3]=r$p*r$o*r$i+r$Y*r$R*r$U},r$b._createAffineTransformationArray=function(r$S,r$Q,r$e,r$l){var r$M=r$Q[0],r$d=r$Q[1],r$T=r$Q[2],r$U=r$Q[3],r$i=r$M+r$M,r$R=r$d+r$d,r$o=r$T+r$T,r$Y=r$M*r$i,r$p=r$M*r$R,r$J=r$M*r$o,r$L=r$d*r$R,r$j=r$d*r$o,r$c=r$T*r$o,r$G=r$U*r$i,r$z=r$U*r$R,r$A=r$U*r$o,r$v=r$e[0],r$D=r$e[1],r$B=r$e[2];r$l[0]=(1-(r$L+r$c))*r$v,r$l[1]=(r$p+r$A)*r$v,r$l[2]=(r$J-r$z)*r$v,r$l[3]=0,r$l[4]=(r$p-r$A)*r$D,r$l[5]=(1-(r$Y+r$c))*r$D,r$l[6]=(r$j+r$G)*r$D,r$l[7]=0,r$l[8]=(r$J+r$z)*r$B,r$l[9]=(r$j-r$G)*r$B,r$l[10]=(1-(r$Y+r$L))*r$B,r$l[11]=0,r$l[12]=r$S[0],r$l[13]=r$S[1],r$l[14]=r$S[2],r$l[15]=1},r$b._mulMatrixArray=function(r$S,r$Q,r$e,r$l){var r$M,r$d,r$T,r$U,r$i,r$R=r$Q.elements,r$o=r$R[0],r$Y=r$R[1],r$p=r$R[2],r$J=r$R[3],r$L=r$R[4],r$j=r$R[5],r$c=r$R[6],r$G=r$R[7],r$z=r$R[8],r$A=r$R[9],r$v=r$R[10],r$D=r$R[11],r$B=r$R[12],r$O=r$R[13],r$H=r$R[14],r$g=r$R[15],r$I=r$l,r$E=r$l+4,r$t=r$l+8,r$k=r$l+12;for(r$M=0;r$M<4;r$M++)r$d=r$S[r$M],r$T=r$S[r$M+4],r$U=r$S[r$M+8],r$i=r$S[r$M+12],r$e[r$I+r$M]=r$d*r$o+r$T*r$Y+r$U*r$p+r$i*r$J,r$e[r$E+r$M]=r$d*r$L+r$T*r$j+r$U*r$c+r$i*r$G,r$e[r$t+r$M]=r$d*r$z+r$T*r$A+r$U*r$v+r$i*r$D,r$e[r$k+r$M]=r$d*r$B+r$T*r$O+r$U*r$H+r$i*r$g},r$b.getYawPitchRoll=function(r$S,r$Q){r$b.transformQuat(r$TQ.ForwardRH,r$S,r$eQ.TEMPVector31),r$b.transformQuat(r$TQ.Up,r$S,r$eQ.TEMPVector32);var r$e=r$eQ.TEMPVector32.elements;r$b.angleTo(r$TQ.ZERO,r$eQ.TEMPVector31,r$eQ.TEMPVector33);var r$l=r$eQ.TEMPVector33.elements;r$l[0]==Math.PI/2?(r$l[1]=r$b.arcTanAngle(r$e[2],r$e[0]),r$l[2]=0):r$l[0]==-Math.PI/2?(r$l[1]=r$b.arcTanAngle(-r$e[2],-r$e[0]),r$l[2]=0):(r$SQ.createRotationY(-r$l[1],r$eQ.TEMPMatrix0),r$SQ.createRotationX(-r$l[0],r$eQ.TEMPMatrix1),r$TQ.transformCoordinate(r$eQ.TEMPVector32,r$eQ.TEMPMatrix0,r$eQ.TEMPVector32),r$TQ.transformCoordinate(r$eQ.TEMPVector32,r$eQ.TEMPMatrix1,r$eQ.TEMPVector32),r$l[2]=r$b.arcTanAngle(r$e[1],-r$e[0])),r$l[1]<=-Math.PI&&(r$l[1]=Math.PI),r$l[2]<=-Math.PI&&(r$l[2]=Math.PI),r$l[1]>=Math.PI&&r$l[2]>=Math.PI&&(r$l[1]=0,r$l[2]=0,r$l[0]=Math.PI-r$l[0]),r$Q[0]=r$l[1],r$Q[1]=r$l[0],r$Q[2]=r$l[2]},r$b.arcTanAngle=function(r$S,r$Q){return 0==r$S?1==r$Q?Math.PI/2:-Math.PI/2:0<r$S?Math.atan(r$Q/r$S):r$S<0?0<r$Q?Math.atan(r$Q/r$S)+Math.PI:Math.atan(r$Q/r$S)-Math.PI:0},r$b.angleTo=function(r$S,r$Q,r$e){r$TQ.subtract(r$Q,r$S,r$eQ.TEMPVector30),r$TQ.normalize(r$eQ.TEMPVector30,r$eQ.TEMPVector30),r$e.elements[0]=Math.asin(r$eQ.TEMPVector30.y),r$e.elements[1]=r$b.arcTanAngle(-r$eQ.TEMPVector30.z,-r$eQ.TEMPVector30.x)},r$b.transformQuat=function(r$S,r$Q,r$e){var r$l=r$e.elements,r$M=r$S.elements,r$d=r$Q,r$T=r$M[0],r$U=r$M[1],r$i=r$M[2],r$R=r$d[0],r$o=r$d[1],r$Y=r$d[2],r$p=r$d[3],r$J=r$p*r$T+r$o*r$i-r$Y*r$U,r$L=r$p*r$U+r$Y*r$T-r$R*r$i,r$j=r$p*r$i+r$R*r$U-r$o*r$T,r$c=-r$R*r$T-r$o*r$U-r$Y*r$i;r$l[0]=r$J*r$p+r$c*-r$R+r$L*-r$Y-r$j*-r$o,r$l[1]=r$L*r$p+r$c*-r$o+r$j*-r$R-r$J*-r$Y,r$l[2]=r$j*r$p+r$c*-r$Y+r$J*-r$o-r$L*-r$R},r$b.quaterionNormalize=function(r$S,r$Q){var r$e=r$S[0],r$l=r$S[1],r$M=r$S[2],r$d=r$S[3],r$T=r$e*r$e+r$l*r$l+r$M*r$M+r$d*r$d;0<r$T&&(r$T=1/Math.sqrt(r$T),r$Q[0]=r$e*r$T,r$Q[1]=r$l*r$T,r$Q[2]=r$M*r$T,r$Q[3]=r$d*r$T)},r$b.matrix4x4MultiplyFFF=function(r$S,r$Q,r$e){var r$l,r$M,r$d,r$T,r$U;if(r$e===r$Q)for(r$Q=new Float32Array(16),r$l=0;r$l<16;++r$l)r$Q[r$l]=r$e[r$l];for(r$l=0;r$l<4;r$l++)r$M=r$S[r$l],r$d=r$S[r$l+4],r$T=r$S[r$l+8],r$U=r$S[r$l+12],r$e[r$l]=r$M*r$Q[0]+r$d*r$Q[1]+r$T*r$Q[2]+r$U*r$Q[3],r$e[r$l+4]=r$M*r$Q[4]+r$d*r$Q[5]+r$T*r$Q[6]+r$U*r$Q[7],r$e[r$l+8]=r$M*r$Q[8]+r$d*r$Q[9]+r$T*r$Q[10]+r$U*r$Q[11],r$e[r$l+12]=r$M*r$Q[12]+r$d*r$Q[13]+r$T*r$Q[14]+r$U*r$Q[15]},r$b.matrix4x4MultiplyMFM=function(r$S,r$Q,r$e){r$b.matrix4x4MultiplyFFF(r$S.elements,r$Q,r$e.elements)},r$Y(r$b,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new r$TQ},"_tempVector3_1",function(){return this._tempVector3_1=new r$TQ},"_tempVector3_2",function(){return this._tempVector3_2=new r$TQ},"_tempVector3_3",function(){return this._tempVector3_3=new r$TQ},"_tempVector3_4",function(){return this._tempVector3_4=new r$TQ},"_tempVector3_5",function(){return this._tempVector3_5=new r$TQ},"_tempVector3_6",function(){return this._tempVector3_6=new r$TQ},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),r$b}(),r$GQ=function(){function r$X(){}return r$J(r$X,"Laya3D"),r$X._cancelLoadByUrl=function(r$S){r$D.loader.cancelLoadByUrl(r$S),r$X._innerFirstLevelLoaderManager.cancelLoadByUrl(r$S),r$X._innerSecondLevelLoaderManager.cancelLoadByUrl(r$S),r$X._innerThirdLevelLoaderManager.cancelLoadByUrl(r$S),r$X._innerFourthLevelLoaderManager.cancelLoadByUrl(r$S)},r$X._changeWebGLSize=function(r$S,r$Q){r$k.onStageResize(r$S,r$Q),r$C.clientWidth=r$S,r$C.clientHeight=r$Q},r$X.__init__=function(){var r$S=r$Q.createMap;r$S.lh=[r$$Q,"SPRITE3DHIERARCHY"],r$S.ls=[r$mQ,"SPRITE3DHIERARCHY"],r$S.lm=[r$rQ,"MESH"],r$S.lmat=[r$PQ,"MATERIAL"],r$S.jpg=[r$xQ,"nativeimage"],r$S.jpeg=[r$xQ,"nativeimage"],r$S.png=[r$xQ,"nativeimage"],r$S.pkm=[r$xQ,"arraybuffer"],r$S.raw=[r$wQ,"arraybuffer"],r$S.mipmaps=[r$wQ,"arraybuffer"],r$G.parserMap.SPRITE3DHIERARCHY=r$X._loadHierarchy,r$G.parserMap.MESH=r$X._loadMesh,r$G.parserMap.MATERIAL=r$X._loadMaterial,r$G.parserMap.TEXTURECUBE=r$X._loadTextureCube,r$G.parserMap.TERRAIN=r$X._loadTerrain,r$X._innerFirstLevelLoaderManager.on("error",null,r$X._eventLoadManagerError),r$X._innerSecondLevelLoaderManager.on("error",null,r$X._eventLoadManagerError),r$X._innerThirdLevelLoaderManager.on("error",null,r$X._eventLoadManagerError),r$X._innerFourthLevelLoaderManager.on("error",null,r$X._eventLoadManagerError)},r$X.READ_BLOCK=function(){return r$X._readData.pos+=4,!0},r$X.READ_DATA=function(){return r$X._DATA.offset=r$X._readData.getUint32(),r$X._DATA.size=r$X._readData.getUint32(),!0},r$X.READ_STRINGS=function(){var r$S=[],r$Q={offset:0,size:0};r$Q.offset=r$X._readData.getUint16(),r$Q.size=r$X._readData.getUint16();r$X._readData.pos;r$X._readData.pos=r$Q.offset+r$X._DATA.offset;for(var r$e=0;r$e<r$Q.size;r$e++){var r$l=r$X._readData.readUTFString();-1===r$l.lastIndexOf(".lmat")&&-1===r$l.lastIndexOf(".lpbr")||r$S.push(r$l)}return r$S},r$X.formatRelativePath=function(r$S,r$Q){var r$e;if("."===r$Q.charAt(0)){for(var r$l=(r$S+r$Q).split("/"),r$M=0,r$d=r$l.length;r$M<r$d;r$M++)if(".."==r$l[r$M]){var r$T=r$M-1;0<r$T&&".."!==r$l[r$T]&&(r$l.splice(r$T,2),r$M-=2)}r$e=r$l.join("/")}else r$e=r$S+r$Q;return null!=r$t.customFormat&&(r$e=r$t.customFormat(r$e,null)),r$e},r$X._eventLoadManagerError=function(r$S){r$D.loader.event("error",r$S)},r$X._addHierarchyInnerUrls=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T=r$X.formatRelativePath(r$l,r$M);r$e&&(r$T+=r$e),r$S.push({url:r$T,clas:r$d}),r$Q[r$M]=r$T},r$X._getSprite3DHierarchyInnerUrls=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){var r$U,r$i=0,r$R=0;switch(r$S.type){case"Scene":var r$o=r$S.customProps.lightmaps;for(r$i=0,r$R=r$o.length;r$i<r$R;r$i++){var r$Y=r$o[r$i].replace(".exr",".png");r$X._addHierarchyInnerUrls(r$l,r$M,r$d,r$T,r$Y,r$xQ)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var r$p;if(r$S.instanceParams)(r$p=r$S.instanceParams.loadPath)&&r$X._addHierarchyInnerUrls(r$Q,r$M,r$d,r$T,r$p,r$rQ);else{(r$p=(r$U=r$S.customProps).meshPath)&&r$X._addHierarchyInnerUrls(r$Q,r$M,r$d,r$T,r$p,r$rQ);var r$J=r$U.materials;if(r$J)for(r$i=0,r$R=r$J.length;r$i<r$R;r$i++){for(var r$L=r$J[r$i],r$j=r$L.type.split("."),r$c=r$h.window,r$G=0,r$z=r$j.length;r$G<r$z;++r$G){r$c=r$c[this.clasPaths[r$G]]}if("function"!=typeof r$c)throw"_getSprite3DHierarchyInnerUrls 错误: "+r$L.type+" 不是类";r$X._addHierarchyInnerUrls(r$e,r$M,r$d,r$T,r$L.path,r$c)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var r$A=(r$U=r$S.customProps).meshPath;r$A&&r$X._addHierarchyInnerUrls(r$Q,r$M,r$d,r$T,r$A,r$rQ);var r$v=r$U.material;if(r$v){r$j=r$v.type.split("."),r$c=r$h.window;for(r$G=0,r$z=r$j.length;r$G<r$z;++r$G){r$c=r$c[this.clasPaths[r$G]]}r$X._addHierarchyInnerUrls(r$e,r$M,r$d,r$T,r$v.path,r$c)}else{var r$D=r$U.materialPath;if(r$D)r$X._addHierarchyInnerUrls(r$e,r$M,r$d,r$T,r$D,ShurikenParticleMaterial);else{var r$B=r$U.texturePath;r$B&&r$X._addHierarchyInnerUrls(r$l,r$M,r$d,r$T,r$B,r$xQ)}}break;case"Terrain":r$X._addHierarchyInnerUrls(r$l,r$M,r$d,r$T,r$S.customProps.dataPath,TerrainRes)}var r$O=r$S.components;for(var r$H in r$O){var r$g=r$O[r$H];switch(r$H){case"Animator":var r$I=r$g.avatarPath;if(r$I)r$X._addHierarchyInnerUrls(r$l,r$M,r$d,r$T,r$I,Avatar);else{var r$E=r$g.avatar;r$E&&r$X._addHierarchyInnerUrls(r$l,r$M,r$d,r$T,r$E.path,Avatar)}var r$t=r$g.clipPaths;for(r$i=0,r$R=r$t.length;r$i<r$R;r$i++)r$X._addHierarchyInnerUrls(r$l,r$M,r$d,r$T,r$t[r$i],AnimationClip)}}var r$k=r$S.child;for(r$i=0,r$R=r$k.length;r$i<r$R;r$i++)r$X._getSprite3DHierarchyInnerUrls(r$k[r$i],r$Q,r$e,r$l,r$M,r$d,r$T)},r$X._loadHierarchy=function(r$S){r$S.on("loaded",null,r$X._onHierarchylhLoaded,[r$S,r$S._class._getGroup()]),r$S.load(r$S.url,"json",!1,null,!0)},r$X._onHierarchylhLoaded=function(r$S,r$Q,r$e){if(r$S._class.destroyed)r$S.endLoad();else{var r$l=r$S.url,r$M=r$cQ.getURLVerion(r$l),r$d=r$t.getPath(r$l),r$T=[],r$U=[],r$i=[],r$R={};r$X._getSprite3DHierarchyInnerUrls(r$e,r$T,r$U,r$i,r$R,r$M,r$d);var r$o=r$T.length+r$U.length+r$i.length,r$Y=r$o+1,r$p=1/r$Y;if(r$X._onProcessChange(r$S,0,r$p,1),0<r$i.length){var r$J=r$o/r$Y,r$L=r$E.create(null,r$X._onProcessChange,[r$S,r$p,r$J],!1);r$X._innerFourthLevelLoaderManager.create(r$i,r$E.create(null,r$X._onHierarchyInnerForthLevResouLoaded,[r$S,r$Q,r$L,r$e,r$R,r$T,r$U,r$p+r$J*r$i.length,r$J]),r$L,null,null,1,!0,r$Q)}else r$X._onHierarchyInnerForthLevResouLoaded(r$S,r$Q,null,r$e,r$R,r$T,r$U,r$p,r$J)}},r$X._onHierarchyInnerForthLevResouLoaded=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){if(r$S._class.destroyed)r$S.endLoad();else if(r$e&&r$e.recover(),0<r$T.length){var r$R=r$E.create(null,r$X._onProcessChange,[r$S,r$U,r$i],!1);r$X._innerSecondLevelLoaderManager.create(r$T,r$E.create(null,r$X._onHierarchyInnerSecondLevResouLoaded,[r$S,r$Q,r$R,r$l,r$M,r$d,r$U+r$i*r$T.length,r$i]),r$e,null,null,1,!0,r$Q)}else r$X._onHierarchyInnerSecondLevResouLoaded(r$S,r$Q,null,r$l,r$M,r$d,r$U,r$i)},r$X._onHierarchyInnerSecondLevResouLoaded=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U){if(r$S._class.destroyed)r$S.endLoad();else if(r$e&&r$e.recover(),0<r$d.length){var r$i=r$E.create(null,r$X._onProcessChange,[r$S,r$T,r$U],!1);r$X._innerFirstLevelLoaderManager.create(r$d,r$E.create(null,r$X._onHierarchyInnerFirstLevResouLoaded,[r$S,r$i,r$l,r$M]),r$e,null,null,1,!0,r$Q)}else r$X._onHierarchyInnerFirstLevResouLoaded(r$S,null,r$l,r$M)},r$X._onHierarchyInnerFirstLevResouLoaded=function(r$S,r$Q,r$e,r$l){r$Q&&r$Q.recover(),r$S.endLoad([r$e,r$l])},r$X._loadTerrain=function(r$S){r$S.on("loaded",null,r$X._onTerrainLtLoaded,[r$S,r$S._class._getGroup()]),r$S.load(r$S.url,"json",!1,null,!0)},r$X._onTerrainLtLoaded=function(r$S,r$Q,r$e){if(r$S._class.destroyed)r$S.endLoad();else{var r$l,r$M,r$d=r$S.url,r$T=r$cQ.getURLVerion(r$d),r$U=r$t.getPath(r$d),r$i=[],r$R={},r$o=0,r$Y=0,r$p=r$e.heightData;r$l=r$p.url,r$M=r$X.formatRelativePath(r$U,r$l),r$T&&(r$M+=r$T),r$l=r$R[r$l]=r$M;var r$J=r$e.detailTexture;for(r$o=0,r$Y=r$J.length;r$o<r$Y;r$o++)r$i.push({url:r$J[r$o].diffuse});var r$L=r$e.normalMap;for(r$o=0,r$Y=r$L.length;r$o<r$Y;r$o++)r$i.push({url:r$L[r$o]});var r$j=r$e.alphaMap;for(r$o=0,r$Y=r$j.length;r$o<r$Y;r$o++)r$i.push({url:r$j[r$o],params:[!1,!1,6408,!0]});for(r$o=0,r$Y=r$i.length;r$o<r$Y;r$o++){var r$c=r$i[r$o].url;r$M=r$X.formatRelativePath(r$U,r$c),r$T&&(r$M+=r$T),r$i[r$o].url=r$M,r$R[r$c]=r$M}var r$G=r$i.length,r$z=r$G+2,r$A=1/r$z;r$X._onProcessChange(r$S,0,r$A,1);var r$v={heightMapLoaded:!1,texturesLoaded:!1},r$D=r$E.create(null,r$X._onProcessChange,[r$S,r$A,r$A],!1);r$X._innerFourthLevelLoaderManager.create(r$l,r$E.create(null,r$X._onTerrainHeightMapLoaded,[r$S,r$D,r$e,r$R,r$v]),r$D,null,[r$p.numX,r$p.numZ,r$p.bitType,r$p.value],1,!0,r$Q);var r$B=r$E.create(null,r$X._onProcessChange,[r$S,2*r$A,r$G/r$z],!1);r$X._innerFourthLevelLoaderManager.create(r$i,r$E.create(null,r$X._onTerrainTexturesLoaded,[r$S,r$B,r$e,r$R,r$v]),r$B,null,null,1,!0,r$Q)}},r$X._onTerrainHeightMapLoaded=function(r$S,r$Q,r$e,r$l,r$M){r$M.heightMapLoaded=!0,r$M.texturesLoaded&&(r$S.endLoad([r$e,r$l]),r$Q.recover())},r$X._onTerrainTexturesLoaded=function(r$S,r$Q,r$e,r$l,r$M){r$M.texturesLoaded=!0,r$M.heightMapLoaded&&(r$S.endLoad([r$e,r$l]),r$Q.recover())},r$X._loadMesh=function(r$S){r$S.on("loaded",null,r$X._onMeshLmLoaded,[r$S,r$S._class._getGroup()]),r$S.load(r$S.url,"arraybuffer",!1,null,!0)},r$X._onMeshLmLoaded=function(r$S,r$Q,r$e){if(r$S._class.destroyed)r$S.endLoad();else{var r$l,r$M,r$d,r$T=r$S.url,r$U=r$cQ.getURLVerion(r$T),r$i=r$t.getPath(r$T),r$R={},r$o=0,r$Y=0;switch((r$X._readData=new r$B(r$e)).pos=0,r$X._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var r$p=r$X._readData.getUint32();r$X._readData.pos=r$X._readData.pos+4,r$Y=r$X._readData.getUint16(),r$X._readData.pos=r$X._readData.pos+8*r$Y;var r$J=r$X._readData.getUint32();for(r$Y=r$X._readData.getUint16(),r$X._readData.pos=r$p+r$J,r$l=[],r$o=0;r$o<r$Y;r$o++){var r$L=r$X._readData.readUTFString();-1!==r$L.lastIndexOf(".lmat")&&r$l.push(r$L)}break;default:for(r$X.READ_BLOCK(),r$o=0;r$o<2;r$o++){var r$j=r$X._readData.getUint16(),r$c=r$X._strings[r$j],r$G=r$X["READ_"+r$c];if(null==r$G)throw new Error("model file err,no this function:"+r$j+" "+r$c);1===r$o?r$l=r$G.call():r$G.call()}}for(r$o=0,r$d=r$l.length;r$o<r$d;r$o++){var r$z=r$l[r$o];r$M=r$X.formatRelativePath(r$i,r$z),r$U&&(r$M+=r$U),r$l[r$o]=r$M,r$R[r$z]=r$M}if(0<r$l.length){r$X._onProcessChange(r$S,0,.5,1);var r$A=r$E.create(null,r$X._onProcessChange,[r$S,.5,.5],!1);r$X._innerSecondLevelLoaderManager.create(r$l,r$E.create(null,r$X._onMeshMateialLoaded,[r$S,r$A,r$e,r$R]),r$A,null,null,1,!0,r$Q)}else r$S.endLoad([r$e,r$R])}},r$X._onMeshMateialLoaded=function(r$S,r$Q,r$e,r$l){r$S.endLoad([r$e,r$l]),r$Q.recover()},r$X._getMaterialTexturePath=function(r$S,r$Q,r$e){var r$l=r$S.length-4;return r$S.indexOf(".dds")!=r$l&&r$S.indexOf(".tga")!=r$l&&r$S.indexOf(".exr")!=r$l&&r$S.indexOf(".DDS")!=r$l&&r$S.indexOf(".TGA")!=r$l&&r$S.indexOf(".EXR")!=r$l||(r$S=r$S.substr(0,r$l)+".png"),r$S=r$X.formatRelativePath(r$e,r$S),r$Q&&(r$S+=r$Q),r$S},r$X._loadMaterial=function(r$S){r$S.on("loaded",null,r$X._onMaterilLmatLoaded,[r$S,r$S._class._getGroup()]),r$S.load(r$S.url,"json",!1,null,!0)},r$X._onMaterilLmatLoaded=function(r$S,r$Q,r$e){if(r$S._class.destroyed)r$S.endLoad();else{var r$l,r$M=r$S.url,r$d=r$cQ.getURLVerion(r$M),r$T=r$t.getPath(r$M),r$U=[],r$i={},r$R=r$e.customProps,r$o=r$e.version;if(r$o)switch(r$o){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var r$Y=r$e.props.textures,r$p=0,r$J=r$Y.length;r$p<r$J;r$p++){var r$L=r$Y[r$p],r$j=r$L.path;if(r$j){var r$c=r$j.length-4;r$j.indexOf(".exr")!=r$c&&r$j.indexOf(".EXR")!=r$c||(r$j=r$j.substr(0,r$c)+".png"),r$l=r$X.formatRelativePath(r$T,r$j),r$d&&(r$l+=r$d),r$U.push({url:r$l,params:r$L.params}),r$i[r$j]=r$l}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var r$G=r$R.diffuseTexture.texture2D;if(r$G&&(r$l=r$X._getMaterialTexturePath(r$G,r$d,r$T),r$U.push(r$l),r$i[r$G]=r$l),r$R.normalTexture){var r$z=r$R.normalTexture.texture2D;r$z&&(r$l=r$X._getMaterialTexturePath(r$z,r$d,r$T),r$U.push(r$l),r$i[r$z]=r$l)}if(r$R.specularTexture){var r$A=r$R.specularTexture.texture2D;r$A&&(r$l=r$X._getMaterialTexturePath(r$A,r$d,r$T),r$U.push(r$l),r$i[r$A]=r$l)}if(r$R.emissiveTexture){var r$v=r$R.emissiveTexture.texture2D;r$v&&(r$l=r$X._getMaterialTexturePath(r$v,r$d,r$T),r$U.push(r$l),r$i[r$v]=r$l)}if(r$R.ambientTexture){var r$D=r$R.ambientTexture.texture2D;r$D&&(r$l=r$X._getMaterialTexturePath(r$D,r$d,r$T),r$U.push(r$l),r$i[r$D]=r$l)}if(r$R.reflectTexture){var r$B=r$R.reflectTexture.texture2D;r$B&&(r$l=r$X._getMaterialTexturePath(r$B,r$d,r$T),r$U.push(r$l),r$i[r$B]=r$l)}}var r$O=r$U.length,r$H=r$O+1,r$g=1/r$H;if(r$X._onProcessChange(r$S,0,r$g,1),0<r$O){var r$I=r$E.create(null,r$X._onProcessChange,[r$S,r$g,r$O/r$H],!1);r$X._innerFourthLevelLoaderManager.create(r$U,r$E.create(null,r$X._onMateialTexturesLoaded,[r$S,r$I,r$e,r$i]),r$I,r$xQ,null,1,!0,r$Q)}else r$X._onMateialTexturesLoaded(r$S,null,r$e,null)}},r$X._onMateialTexturesLoaded=function(r$S,r$Q,r$e,r$l){r$S.endLoad([r$e,r$l]),r$Q&&r$Q.recover()},r$X._loadTextureCube=function(r$S){r$S.on("loaded",null,r$X._onTextureCubeLtcLoaded,[r$S]),r$S.load(r$S.url,"json",!1,null,!0)},r$X._onTextureCubeLtcLoaded=function(r$S,r$Q){if(r$S._class.destroyed)r$S.endLoad();else{var r$e=r$t.getPath(r$S.url),r$l=[r$X.formatRelativePath(r$e,r$Q.px),r$X.formatRelativePath(r$e,r$Q.nx),r$X.formatRelativePath(r$e,r$Q.py),r$X.formatRelativePath(r$e,r$Q.ny),r$X.formatRelativePath(r$e,r$Q.pz),r$X.formatRelativePath(r$e,r$Q.nz)];r$X._onProcessChange(r$S,0,1/7,1);var r$M=r$E.create(null,r$X._onProcessChange,[r$S,1/7,6/7],!1);r$X._innerFourthLevelLoaderManager.load(r$l,r$E.create(null,r$X._onTextureCubeImagesLoaded,[r$S,r$l,r$M]),r$M,"nativeimage")}},r$X._onTextureCubeImagesLoaded=function(r$S,r$Q,r$e){var r$l=[];r$l.length=6;for(var r$M=0;r$M<6;r$M++){var r$d=r$Q[r$M];r$l[r$M]=r$G.getRes(r$d),r$G.clearRes(r$d)}r$S.endLoad(r$l),r$e.recover()},r$X._onProcessChange=function(r$S,r$Q,r$e,r$l){(r$l=r$Q+r$l*r$e)<1&&r$S.event("progress",r$l)},r$X.init=function(r$S,r$Q,r$e,r$l,r$M,r$d){if(void 0===r$e&&(r$e=!1),void 0===r$l&&(r$l=!1),void 0===r$M&&(r$M=!0),void 0===r$d&&(r$d=!0),r$z.update3DLoop=function(){},r$z.cancelLoadByUrl=function(r$S){r$X._cancelLoadByUrl(r$S)},r$i.isAntialias=r$e,r$i.isAlpha=r$l,r$i.premultipliedAlpha=r$M,r$i.isStencil=r$d,!r$k.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");r$z.changeWebGLSize=r$X._changeWebGLSize,r$j.is3DMode=!0,r$D.init(r$S,r$Q),r$b.__init__(),r$YQ.__init__(),r$NQ.__init__(),r$u.__init__(),r$X.__init__(),r$T.maxTextureCount=2,(r$X.debugMode||r$K.debugMode)&&(r$X._debugPhasorSprite=new r$q)},r$X.HIERARCHY="SPRITE3DHIERARCHY",r$X.MESH="MESH",r$X.MATERIAL="MATERIAL",r$X.PBRMATERIAL="PBRMTL",r$X.TEXTURECUBE="TEXTURECUBE",r$X.TERRAIN="TERRAIN",r$X._readData=null,r$X._debugPhasorSprite=null,r$X.debugMode=!1,r$Y(r$X,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new r$Q},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new r$Q},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new r$Q},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new r$Q}]),r$X}(),r$zQ=function(r$S){function r$M(r$S){r$M.__super.call(this),this._owner=r$S,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}r$J(r$M,"laya.d3.animation.AnimationTransform3D",r$d);var r$Q=r$M.prototype;return r$Q._getlocalMatrix=function(){return this._localUpdate&&(r$cQ._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},r$Q._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var r$S=0,r$Q=this._childs.length;r$S<r$Q;r$S++)this._childs[r$S]._onWorldTransform()}},r$Q._setWorldMatrixAndUpdate=function(r$S){if(this._worldMatrix=r$S,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var r$Q=this._getlocalMatrix(),r$e=0;r$e<16;++r$e)this._worldMatrix[r$e]=r$Q[r$e];else r$cQ.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},r$Q._setWorldMatrixNoUpdate=function(r$S){this._worldMatrix=r$S},r$Q._setWorldMatrixIgnoreUpdate=function(r$S){this._worldMatrix=r$S,this._worldUpdate=!1},r$Q.getLocalPosition=function(){return this._localPosition},r$Q.setLocalPosition=function(r$S){if(this._parent)this._localPosition=r$S,this._localUpdate=!0,this._onWorldTransform();else{var r$Q=this._entity.owner._transform,r$e=this._entity.localPosition,r$l=r$e.elements;r$l[0]=r$S[0],r$l[1]=r$S[1],r$l[2]=r$S[2],r$Q.localPosition=r$e}},r$Q.getLocalRotation=function(){if(this._localQuaternionUpdate){var r$S=this._localRotationEuler;r$cQ._quaternionCreateFromYawPitchRollArray(r$S[1]/r$M._angleToRandin,r$S[0]/r$M._angleToRandin,r$S[2]/r$M._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},r$Q.setLocalRotation=function(r$S){if(this._parent)this._localRotation=r$S,r$cQ.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var r$Q=this._entity.owner._transform,r$e=this._entity.localRotation,r$l=r$e.elements;r$l[0]=r$S[0],r$l[1]=r$S[1],r$l[2]=r$S[2],r$l[3]=r$S[3],r$Q.localRotation=r$e}},r$Q.getLocalScale=function(){return this._localScale},r$Q.setLocalScale=function(r$S){if(this._parent)this._localScale=r$S,this._localUpdate=!0,this._onWorldTransform();else{var r$Q=this._entity.owner._transform,r$e=this._entity.localScale,r$l=r$e.elements;r$l[0]=r$S[0],r$l[1]=r$S[1],r$l[2]=r$S[2],r$Q.localScale=r$e}},r$Q.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){r$cQ.getYawPitchRoll(this._localRotation,r$M._tempVector3);var r$S=r$M._tempVector3,r$Q=this._localRotationEuler;r$Q[0]=r$S[1]*r$M._angleToRandin,r$Q[1]=r$S[0]*r$M._angleToRandin,r$Q[2]=r$S[2]*r$M._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},r$Q.setLocalRotationEuler=function(r$S){if(this._parent)r$cQ._quaternionCreateFromYawPitchRollArray(r$S[1]/r$M._angleToRandin,r$S[0]/r$M._angleToRandin,r$S[2]/r$M._angleToRandin,this._localRotation),this._localRotationEuler=r$S,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var r$Q=this._entity.owner._transform,r$e=this._entity.localRotationEuler,r$l=r$e.elements;r$l[0]=r$S[0],r$l[1]=r$S[1],r$l[2]=r$S[2],r$Q.localRotationEuler=r$e}},r$Q.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)r$cQ.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var r$S=this._getlocalMatrix(),r$Q=0;r$Q<16;++r$Q)this._worldMatrix[r$Q]=r$S[r$Q];this._worldUpdate=!1}return this._worldMatrix},r$Q.setParent=function(r$S){if(this._parent!==r$S){if(this._parent){var r$Q=this._parent._childs,r$e=r$Q.indexOf(this);r$Q.splice(r$e,1)}r$S&&(r$S._childs.push(this),r$S&&this._onWorldTransform()),this._parent=r$S}},r$Y(r$M,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),r$M}(),r$AQ=function(r$S){function r$Q(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,r$Q.__super.call(this),this._destroyed=!1,this._id=r$Q._uniqueIDCounter,r$Q._uniqueIDCounter++}r$J(r$Q,"laya.d3.component.Component3D",r$d);var r$e=r$Q.prototype;return r$D.imps(r$e,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),r$e._initialize=function(r$S){this._owner=r$S,this._enable=!0,this.started=!1,this._load(r$S)},r$e._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},r$e._load=function(r$S){},r$e._start=function(r$S){},r$e._update=function(r$S){},r$e._lateUpdate=function(r$S){},r$e._preRenderUpdate=function(r$S){},r$e._postRenderUpdate=function(r$S){},r$e._unload=function(r$S){this.offAll()},r$e._cloneTo=function(r$S){},r$L(0,r$e,"id",function(){return this._id}),r$L(0,r$e,"destroyed",function(){return this._destroyed}),r$L(0,r$e,"owner",function(){return this._owner}),r$L(0,r$e,"enable",function(){return this._enable},function(r$S){this._enable!==r$S&&(this._enable=r$S,this.event("enablechanged",this._enable))}),r$L(0,r$e,"isSingleton",function(){return r$Q._isSingleton}),r$Q._isSingleton=!0,r$Q._uniqueIDCounter=1,r$Q}(),r$vQ=function(r$S){function r$Q(){this._destroyed=!1,r$Q.__super.call(this),this._destroyed=!1}r$J(r$Q,"laya.d3.core.GeometryFilter",r$d);var r$e=r$Q.prototype;return r$D.imps(r$e,{"laya.resource.IDestroy":!0}),r$e._destroy=function(){this.offAll(),this._destroyed=!0},r$L(0,r$e,"_isAsyncLoaded",function(){return!0}),r$L(0,r$e,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),r$L(0,r$e,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),r$L(0,r$e,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),r$L(0,r$e,"destroyed",function(){return this._destroyed}),r$Q}(),r$DQ=function(r$S){function r$l(r$S){r$l.__super.call(this),this._id=++r$l._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new r$KS(new r$TQ,new r$TQ),this._boundingBoxCenter=new r$TQ,this._boundingSphere=new r$_S(new r$TQ,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=r$S,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}r$J(r$l,"laya.d3.core.render.BaseRender",r$d);var r$Q=r$l.prototype;return r$D.imps(r$Q,{"laya.resource.IDestroy":!0}),r$Q._changeMaterialReference=function(r$S,r$Q){r$S&&r$S._removeReference(),r$Q._addReference()},r$Q._getInstanceMaterial=function(r$S,r$Q){var r$e=new r$S.constructor;return r$S.cloneTo(r$e),r$e.name=r$e.name+"(Instance)",this._materialsInstance[r$Q]=!0,this._changeMaterialReference(this._materials[r$Q],r$e),this._materials[r$Q]=r$e},r$Q._setShaderValuelightMap=function(r$S){this._setShaderValueTexture(3,r$S)},r$Q._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},r$Q._renderRenderableBoundBox=function(){var r$S=r$GQ._debugPhasorSprite,r$Q=this.boundingBox,r$e=r$l._tempBoundBoxCorners;r$Q.getCorners(r$e),r$S.line(r$e[0],r$l._greenColor,r$e[1],r$l._greenColor),r$S.line(r$e[2],r$l._greenColor,r$e[3],r$l._greenColor),r$S.line(r$e[4],r$l._greenColor,r$e[5],r$l._greenColor),r$S.line(r$e[6],r$l._greenColor,r$e[7],r$l._greenColor),r$S.line(r$e[0],r$l._greenColor,r$e[3],r$l._greenColor),r$S.line(r$e[1],r$l._greenColor,r$e[2],r$l._greenColor),r$S.line(r$e[2],r$l._greenColor,r$e[6],r$l._greenColor),r$S.line(r$e[3],r$l._greenColor,r$e[7],r$l._greenColor),r$S.line(r$e[0],r$l._greenColor,r$e[4],r$l._greenColor),r$S.line(r$e[1],r$l._greenColor,r$e[5],r$l._greenColor),r$S.line(r$e[4],r$l._greenColor,r$e[7],r$l._greenColor),r$S.line(r$e[5],r$l._greenColor,r$e[6],r$l._greenColor)},r$Q._calculateBoundingSphere=function(){throw"BaseRender: must override it."},r$Q._calculateBoundingBox=function(){throw"BaseRender: must override it."},r$Q._setShaderValueTexture=function(r$S,r$Q){this._owner._shaderValues.setValue(r$S,r$Q)},r$Q._setShaderValueMatrix4x4=function(r$S,r$Q){this._owner._shaderValues.setValue(r$S,r$Q?r$Q.elements:null)},r$Q._setShaderValueColor=function(r$S,r$Q){this._owner._shaderValues.setValue(r$S,r$Q?r$Q.elements:null)},r$Q._setShaderValueBuffer=function(r$S,r$Q){this._owner._shaderValues.setValue(r$S,r$Q)},r$Q._setShaderValueInt=function(r$S,r$Q){this._owner._shaderValues.setValue(r$S,r$Q)},r$Q._setShaderValueBool=function(r$S,r$Q){this._owner._shaderValues.setValue(r$S,r$Q)},r$Q._setShaderValueNumber=function(r$S,r$Q){this._owner._shaderValues.setValue(r$S,r$Q)},r$Q._setShaderValueVector2=function(r$S,r$Q){this._owner._shaderValues.setValue(r$S,r$Q?r$Q.elements:null)},r$Q._addShaderDefine=function(r$S){this._owner._shaderDefineValue|=r$S},r$Q._removeShaderDefine=function(r$S){this._owner._shaderDefineValue&=~r$S},r$Q._renderUpdate=function(r$S){return!0},r$Q._applyLightMapParams=function(){if(0<=this._lightmapIndex){var r$S=this._owner.scene;if(r$S){var r$Q=r$S.getlightmaps()[this._lightmapIndex];r$Q?(this._addShaderDefine(r$qQ.SAHDERDEFINE_LIGHTMAP),r$Q.loaded?this._setShaderValuelightMap(r$Q):r$Q.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(r$qQ.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(r$qQ.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(r$qQ.SAHDERDEFINE_LIGHTMAP)},r$Q._updateOctreeNode=function(){var r$S=this._treeNode;r$S&&this._octreeNodeNeedChange&&(r$S.updateObject(this),this._octreeNodeNeedChange=!1)},r$Q._destroy=function(){this.offAll();var r$S=0,r$Q=0;for(r$S=0,r$Q=this._renderElements.length;r$S<r$Q;r$S++)this._renderElements[r$S]._destroy();for(r$S=0,r$Q=this._materials.length;r$S<r$Q;r$S++)this._materials[r$S]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},r$L(0,r$Q,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),r$L(0,r$Q,"id",function(){return this._id}),r$L(0,r$Q,"material",function(){var r$S=this._materials[0];if(r$S&&!this._materialsInstance[0]){var r$Q=this._getInstanceMaterial(r$S,0);this.event("materialchanged",[this,0,r$Q])}return this._materials[0]},function(r$S){this.sharedMaterial=r$S}),r$L(0,r$Q,"sharedMaterial",function(){return this._materials[0]},function(r$S){var r$Q=this._materials[0];r$Q!==r$S&&(this._materials[0]=r$S,this._materialsInstance[0]=!1,this._changeMaterialReference(r$Q,r$S),this.event("materialchanged",[this,0,r$S]))}),r$L(0,r$Q,"lightmapIndex",function(){return this._lightmapIndex},function(r$S){this._lightmapIndex=r$S,this._applyLightMapParams()}),r$L(0,r$Q,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(r$S){this._lightmapScaleOffset=r$S,this._setShaderValueColor(2,r$S),this._addShaderDefine(r$qQ.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),r$L(0,r$Q,"enable",function(){return this._enable},function(r$S){this._enable=r$S,this.event("enablechanged",[this,r$S])}),r$L(0,r$Q,"materials",function(){for(var r$S=0,r$Q=this._materials.length;r$S<r$Q;r$S++)if(!this._materialsInstance[r$S]){var r$e=this._getInstanceMaterial(this._materials[r$S],r$S);this.event("materialchanged",[this,r$S,r$e])}return this._materials.slice()},function(r$S){this.sharedMaterials=r$S}),r$L(0,r$Q,"sharedMaterials",function(){return this._materials.slice()},function(r$S){if(!r$S)throw new Error("MeshRender: shadredMaterials value can't be null.");var r$Q=r$S.length;this._materialsInstance.length=r$Q;for(var r$e=0;r$e<r$Q;r$e++){var r$l=this._materials[r$e];r$l!==r$S[r$e]&&(this._materialsInstance[r$e]=!1,this._changeMaterialReference(r$l,r$S[r$e]),this.event("materialchanged",[this,r$e,r$S[r$e]]))}this._materials=r$S}),r$L(0,r$Q,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),r$L(0,r$Q,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var r$S=this.boundingBox;r$TQ.add(r$S.min,r$S.max,this._boundingBoxCenter),r$TQ.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),r$L(0,r$Q,"receiveShadow",function(){return this._receiveShadow},function(r$S){this._receiveShadow!==r$S&&((this._receiveShadow=r$S)?this._addShaderDefine(r$JQ.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(r$JQ.SHADERDEFINE_RECEIVE_SHADOW))}),r$L(0,r$Q,"destroyed",function(){return this._destroyed}),r$l._uniqueIDCounter=0,r$Y(r$l,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ,new r$TQ]},"_greenColor",function(){return this._greenColor=new r$UQ(0,1,0,1)}]),r$l}(),r$BQ=function(r$S){function r$U(r$S){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,r$U.__super.call(this),this._localPosition=new r$TQ,this._localRotation=new r$eQ(0,0,0,1),this._localScale=new r$TQ(1,1,1),this._localRotationEuler=new r$TQ,this._localMatrix=new r$SQ,this._position=new r$TQ,this._rotation=new r$eQ(0,0,0,1),this._scale=new r$TQ(1,1,1),this._worldMatrix=new r$SQ,this._forward=new r$TQ,this._up=new r$TQ,this._right=new r$TQ,this._owner=r$S,this._childs=[]}r$J(r$U,"laya.d3.core.Transform3D",r$d);var r$Q=r$U.prototype;return r$Q._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)r$SQ.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var r$S=r$U._tempVector30;r$TQ.multiply(this.pivot,this._localScale,r$S);var r$Q=r$U._tempVector31;r$TQ.subtract(r$S,this.pivot,r$Q);var r$e=r$U._tempVector32,r$l=this.localRotation;r$TQ.transformQuat(r$S,r$l,r$e),r$TQ.subtract(r$e,r$S,r$e);var r$M=r$U._tempVector33;r$TQ.subtract(this._localPosition,r$Q,r$M),r$TQ.subtract(r$M,r$e,r$M),r$SQ.createAffineTransformation(r$M,r$l,this._localScale,this._localMatrix)}},r$Q._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var r$S=0,r$Q=this._childs.length;r$S<r$Q;r$S++)this._childs[r$S]._onWorldPositionRotationTransform()}},r$Q._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var r$S=0,r$Q=this._childs.length;r$S<r$Q;r$S++)this._childs[r$S]._onWorldPositionScaleTransform()}},r$Q._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var r$S=0,r$Q=this._childs.length;r$S<r$Q;r$S++)this._childs[r$S]._onWorldPositionTransform()}},r$Q._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var r$S=0,r$Q=this._childs.length;r$S<r$Q;r$S++)this._childs[r$S]._onWorldPositionRotationTransform()}},r$Q._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var r$S=0,r$Q=this._childs.length;r$S<r$Q;r$S++)this._childs[r$S]._onWorldPositionScaleTransform()}},r$Q._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var r$S=0,r$Q=this._childs.length;r$S<r$Q;r$S++)this._childs[r$S]._onWorldTransform()}},r$Q.translate=function(r$S,r$Q){void 0===r$Q&&(r$Q=!0),r$Q?(r$SQ.createFromQuaternion(this.localRotation,r$U._tempMatrix0),r$TQ.transformCoordinate(r$S,r$U._tempMatrix0,r$U._tempVector30),r$TQ.add(this.localPosition,r$U._tempVector30,this._localPosition),this.localPosition=this._localPosition):(r$TQ.add(this.position,r$S,this._position),this.position=this._position)},r$Q.rotate=function(r$S,r$Q,r$e){var r$l;void 0===r$Q&&(r$Q=!0),void 0===r$e&&(r$e=!0),r$l=r$e?r$S:(r$TQ.scale(r$S,Math.PI/180,r$U._tempVector30),r$U._tempVector30),r$eQ.createFromYawPitchRoll(r$l.y,r$l.x,r$l.z,r$U._tempQuaternion0),r$Q?(r$eQ.multiply(this._localRotation,r$U._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(r$eQ.multiply(r$U._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},r$Q.lookAt=function(r$S,r$Q,r$e){void 0===r$e&&(r$e=!1);var r$l,r$M=r$S.elements;if(r$e){if(r$l=this._localPosition.elements,Math.abs(r$l[0]-r$M[0])<r$sS.zeroTolerance&&Math.abs(r$l[1]-r$M[1])<r$sS.zeroTolerance&&Math.abs(r$l[2]-r$M[2])<r$sS.zeroTolerance)return;r$eQ.lookAt(this._localPosition,r$S,r$Q,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var r$d=this.position;if(r$l=r$d.elements,Math.abs(r$l[0]-r$M[0])<r$sS.zeroTolerance&&Math.abs(r$l[1]-r$M[1])<r$sS.zeroTolerance&&Math.abs(r$l[2]-r$M[2])<r$sS.zeroTolerance)return;r$eQ.lookAt(r$d,r$S,r$Q,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},r$L(0,r$Q,"_isFrontFaceInvert",function(){var r$S=this.scale,r$Q=r$S.x<0;return r$S.y<0&&(r$Q=!r$Q),r$S.z<0&&(r$Q=!r$Q),r$Q}),r$L(0,r$Q,"owner",function(){return this._owner}),r$L(0,r$Q,"localRotation",function(){if(this._localQuaternionUpdate){var r$S=this._localRotationEuler.elements;r$eQ.createFromYawPitchRoll(r$S[1]/r$U._angleToRandin,r$S[0]/r$U._angleToRandin,r$S[2]/r$U._angleToRandin,this._localRotation)}return this._localRotation},function(r$S){this._localRotation=r$S,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),r$L(0,r$Q,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?r$SQ.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(r$S){null===this._parent?r$S.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),r$SQ.multiply(this._localMatrix,r$S,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=r$S,this._worldUpdate=!1}),r$L(0,r$Q,"worldNeedUpdate",function(){return this._worldUpdate}),r$L(0,r$Q,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(r$S){this._localMatrix=r$S,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),r$L(0,r$Q,"dummy",function(){return this._dummy},function(r$S){this._dummy!==r$S&&(this._dummy&&(this._dummy._entity=null),r$S&&(r$S._entity=this),this._dummy=r$S)}),r$L(0,r$Q,"localPosition",function(){return this._localPosition},function(r$S){this._localPosition=r$S,this._localUpdate=!0,this._onWorldPositionTransform()}),r$L(0,r$Q,"position",function(){if(this._positionUpdate){if(null!=this._parent){var r$S=this._parent.position;r$TQ.multiply(this._localPosition,this._parent.scale,r$U._tempVector30),r$TQ.transformQuat(r$U._tempVector30,this._parent.rotation,r$U._tempVector30),r$TQ.add(r$S,r$U._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(r$S){if(null!=this._parent){r$TQ.subtract(r$S,this._parent.position,this._localPosition);var r$Q=this._parent.scale.elements,r$e=r$Q[0],r$l=r$Q[1],r$M=r$Q[2];if(1!==r$e||1!==r$l||1!==r$M){var r$d=r$U._tempVector30,r$T=r$d.elements;r$T[0]=1/r$e,r$T[1]=1/r$l,r$T[2]=1/r$M,r$TQ.multiply(this._localPosition,r$d,this._localPosition)}this._parent.rotation.invert(r$U._tempQuaternion0),r$TQ.transformQuat(this._localPosition,r$U._tempQuaternion0,this._localPosition)}else r$S.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=r$S,this._positionUpdate=!1}),r$L(0,r$Q,"localScale",function(){return this._localScale},function(r$S){this._localScale=r$S,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),r$L(0,r$Q,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(r$U._tempVector30);var r$S=r$U._tempVector30.elements,r$Q=this._localRotationEuler.elements;r$Q[0]=r$S[1]*r$U._angleToRandin,r$Q[1]=r$S[0]*r$U._angleToRandin,r$Q[2]=r$S[2]*r$U._angleToRandin}return this._localRotationEuler},function(r$S){this._localRotationEuler=r$S,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),r$L(0,r$Q,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?r$eQ.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(r$S){null!=this._parent?(this._parent.rotation.invert(r$U._tempQuaternion0),r$eQ.multiply(r$S,r$U._tempQuaternion0,this._localRotation)):r$S.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=r$S,this._rotationUpdate=!1}),r$L(0,r$Q,"scale",function(){return this._scaleUpdate&&(null!==this._parent?r$TQ.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(r$S){if(null!==this._parent){var r$Q=this._parent.scale.elements,r$e=r$U._tempVector30.elements;r$e[0]=1/r$Q[0],r$e[1]=1/r$Q[1],r$e[2]=1/r$Q[2],r$TQ.multiply(r$S,r$U._tempVector30,this._localScale)}else r$S.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=r$S,this._scaleUpdate=!1}),r$L(0,r$Q,"rotationEuler",null,function(r$S){r$eQ.createFromYawPitchRoll(r$S.y,r$S.x,r$S.z,this._rotation),this.rotation=this._rotation}),r$L(0,r$Q,"forward",function(){var r$S=this.worldMatrix.elements;return this._forward.elements[0]=-r$S[8],this._forward.elements[1]=-r$S[9],this._forward.elements[2]=-r$S[10],this._forward}),r$L(0,r$Q,"up",function(){var r$S=this.worldMatrix.elements;return this._up.elements[0]=r$S[4],this._up.elements[1]=r$S[5],this._up.elements[2]=r$S[6],this._up}),r$L(0,r$Q,"right",function(){var r$S=this.worldMatrix.elements;return this._right.elements[0]=r$S[0],this._right.elements[1]=r$S[1],this._right.elements[2]=r$S[2],this._right}),r$L(0,r$Q,"parent",function(){return this._parent},function(r$S){if(this._parent!==r$S){if(this._parent){var r$Q=this._parent._childs,r$e=r$Q.indexOf(this);r$Q.splice(r$e,1)}r$S&&(r$S._childs.push(this),r$S&&this._onWorldTransform()),this._parent=r$S}}),r$Y(r$U,["_tempVector30",function(){return this._tempVector30=new r$TQ},"_tempVector31",function(){return this._tempVector31=new r$TQ},"_tempVector32",function(){return this._tempVector32=new r$TQ},"_tempVector33",function(){return this._tempVector33=new r$TQ},"_tempQuaternion0",function(){return this._tempQuaternion0=new r$eQ},"_tempMatrix0",function(){return this._tempMatrix0=new r$SQ},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),r$U}(),r$OQ=(function(r$S){function r$Q(){this._rotation=0,this._matNeedUpdte=!1,r$Q.__super.call(this),this._matrix=new r$SQ,this._offset=new r$dQ,this._tiling=new r$dQ(1,1)}r$J(r$Q,"laya.d3.core.TransformUV",r$d);var r$e=r$Q.prototype;r$D.imps(r$e,{"laya.d3.core.IClone":!0}),r$e._updateMatrix=function(){r$Q._tempOffsetV3.elements[0]=this._offset.x,r$Q._tempOffsetV3.elements[1]=this._offset.y,r$eQ.createFromYawPitchRoll(0,0,this._rotation,r$Q._tempRotationQua),r$Q._tempTitlingV3.elements[0]=this._tiling.x,r$Q._tempTitlingV3.elements[1]=this._tiling.y,r$SQ.createAffineTransformation(r$Q._tempOffsetV3,r$Q._tempRotationQua,r$Q._tempTitlingV3,this._matrix)},r$e.cloneTo=function(r$S){r$S._matrix=this._matrix.clone(),r$S._offset=this._offset.clone(),r$S._rotation=this._rotation,r$S._tiling=this._tiling.clone()},r$e.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$e,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),r$L(0,r$e,"tiling",function(){return this._tiling},function(r$S){this._tiling=r$S,this._matNeedUpdte=!0}),r$L(0,r$e,"offset",function(){return this._offset},function(r$S){this._offset=r$S,this._matNeedUpdte=!0}),r$L(0,r$e,"rotation",function(){return this._rotation},function(r$S){this._rotation=r$S,this._matNeedUpdte=!0}),r$Y(r$Q,["_tempOffsetV3",function(){return this._tempOffsetV3=new r$TQ(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new r$eQ},"_tempTitlingV3",function(){return this._tempTitlingV3=new r$TQ(1,1,1)}])}(),function(r$e){function r$S(){this.x=NaN,this.y=NaN,this.z=NaN,r$S.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}r$J(r$S,"laya.d3.core.particleShuriKen.module.shape.BoxShape",r$e);var r$Q=r$S.prototype;r$Q._getShapeBoundBox=function(r$S){var r$Q=r$S.min.elements;r$Q[0]=.5*-this.x,r$Q[1]=.5*-this.y,r$Q[2]=.5*-this.z;var r$e=r$S.max.elements;r$e[0]=.5*this.x,r$e[1]=.5*this.y,r$e[2]=.5*this.z},r$Q._getSpeedBoundBox=function(r$S){var r$Q=r$S.min.elements;r$Q[0]=0,r$Q[1]=0,r$Q[2]=0;var r$e=r$S.max.elements;r$e[0]=0,r$e[1]=1,r$e[2]=0},r$Q.generatePositionAndDirection=function(r$S,r$Q,r$e,r$l){var r$M=r$S.elements,r$d=r$Q.elements;r$e?(r$e.seed=r$l[16],r$x._randomPointInsideHalfUnitBox(r$S,r$e),r$l[16]=r$e.seed):r$x._randomPointInsideHalfUnitBox(r$S),r$M[0]=this.x*r$M[0],r$M[1]=this.y*r$M[1],r$M[2]=this.z*r$M[2],this.randomDirection?r$e?(r$e.seed=r$l[17],r$x._randomPointUnitSphere(r$Q,r$e),r$l[17]=r$e.seed):r$x._randomPointUnitSphere(r$Q):(r$d[0]=0,r$d[1]=0,r$d[2]=1)},r$Q.cloneTo=function(r$S){r$e.prototype.cloneTo.call(this,r$S);var r$Q=r$S;r$Q.x=this.x,r$Q.y=this.y,r$Q.z=this.z,r$Q.randomDirection=this.randomDirection}}(r$f),function(r$e){function r$T(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,r$T.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}r$J(r$T,"laya.d3.core.particleShuriKen.module.shape.CircleShape",r$e);var r$S=r$T.prototype;r$S._getShapeBoundBox=function(r$S){var r$Q=r$S.min.elements;r$Q[0]=r$Q[2]=-this.radius,r$Q[1]=0;var r$e=r$S.max.elements;r$e[0]=r$e[2]=this.radius,r$e[1]=0},r$S._getSpeedBoundBox=function(r$S){var r$Q=r$S.min.elements;r$Q[0]=r$Q[1]=-1,r$Q[2]=0;var r$e=r$S.max.elements;r$e[0]=r$e[1]=1,r$e[2]=0},r$S.generatePositionAndDirection=function(r$S,r$Q,r$e,r$l){var r$M=r$S.elements,r$d=r$T._tempPositionPoint.elements;r$e?(r$e.seed=r$l[16],this.emitFromEdge?r$x._randomPointUnitArcCircle(this.arc,r$T._tempPositionPoint,r$e):r$x._randomPointInsideUnitArcCircle(this.arc,r$T._tempPositionPoint,r$e),r$l[16]=r$e.seed):this.emitFromEdge?r$x._randomPointUnitArcCircle(this.arc,r$T._tempPositionPoint):r$x._randomPointInsideUnitArcCircle(this.arc,r$T._tempPositionPoint),r$M[0]=-r$d[0],r$M[1]=r$d[1],r$M[2]=0,r$TQ.scale(r$S,this.radius,r$S),this.randomDirection?r$e?(r$e.seed=r$l[17],r$x._randomPointUnitSphere(r$Q,r$e),r$l[17]=r$e.seed):r$x._randomPointUnitSphere(r$Q):r$S.cloneTo(r$Q)},r$S.cloneTo=function(r$S){r$e.prototype.cloneTo.call(this,r$S);var r$Q=r$S;r$Q.radius=this.radius,r$Q.arc=this.arc,r$Q.emitFromEdge=this.emitFromEdge,r$Q.randomDirection=this.randomDirection},r$Y(r$T,["_tempPositionPoint",function(){return this._tempPositionPoint=new r$dQ}])}(r$f),function(r$e){function r$p(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,r$p.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}r$J(r$p,"laya.d3.core.particleShuriKen.module.shape.ConeShape",r$e);var r$S=r$p.prototype;r$S._getShapeBoundBox=function(r$S){var r$Q=this.radius+this.length*Math.sin(this.angle),r$e=this.length*Math.cos(this.angle),r$l=r$S.min.elements;r$l[0]=r$l[1]=-r$Q,r$l[2]=0;var r$M=r$S.max.elements;r$M[0]=r$M[1]=r$Q,r$M[2]=r$e},r$S._getSpeedBoundBox=function(r$S){var r$Q=Math.sin(this.angle),r$e=r$S.min.elements;r$e[0]=r$e[1]=-r$Q,r$e[2]=0;var r$l=r$S.max.elements;r$l[0]=r$e[1]=r$Q,r$l[2]=1},r$S.generatePositionAndDirection=function(r$S,r$Q,r$e,r$l){var r$M,r$d=r$S.elements,r$T=r$Q.elements,r$U=r$p._tempPositionPoint.elements,r$i=NaN,r$R=NaN,r$o=Math.cos(this.angle),r$Y=Math.sin(this.angle);switch(this.emitType){case 0:r$e?(r$e.seed=r$l[16],r$x._randomPointInsideUnitCircle(r$p._tempPositionPoint,r$e),r$l[16]=r$e.seed):r$x._randomPointInsideUnitCircle(r$p._tempPositionPoint),r$i=r$U[0],r$R=r$U[1],r$d[0]=r$i*this.radius,r$d[1]=r$R*this.radius,r$d[2]=0,this.randomDirection?(r$e?(r$e.seed=r$l[17],r$x._randomPointInsideUnitCircle(r$p._tempDirectionPoint,r$e),r$l[17]=r$e.seed):r$x._randomPointInsideUnitCircle(r$p._tempDirectionPoint),r$M=r$p._tempDirectionPoint.elements,r$T[0]=r$M[0]*r$Y,r$T[1]=r$M[1]*r$Y):(r$T[0]=r$i*r$Y,r$T[1]=r$R*r$Y),r$T[2]=r$o;break;case 1:r$e?(r$e.seed=r$l[16],r$x._randomPointUnitCircle(r$p._tempPositionPoint,r$e),r$l[16]=r$e.seed):r$x._randomPointUnitCircle(r$p._tempPositionPoint),r$i=r$U[0],r$R=r$U[1],r$d[0]=r$i*this.radius,r$d[1]=r$R*this.radius,r$d[2]=0,this.randomDirection?(r$e?(r$e.seed=r$l[17],r$x._randomPointInsideUnitCircle(r$p._tempDirectionPoint,r$e),r$l[17]=r$e.seed):r$x._randomPointInsideUnitCircle(r$p._tempDirectionPoint),r$M=r$p._tempDirectionPoint.elements,r$T[0]=r$M[0]*r$Y,r$T[1]=r$M[1]*r$Y):(r$T[0]=r$i*r$Y,r$T[1]=r$R*r$Y),r$T[2]=r$o;break;case 2:r$e?(r$e.seed=r$l[16],r$x._randomPointInsideUnitCircle(r$p._tempPositionPoint,r$e)):r$x._randomPointInsideUnitCircle(r$p._tempPositionPoint),r$i=r$U[0],r$R=r$U[1],r$d[0]=r$i*this.radius,r$d[1]=r$R*this.radius,r$T[r$d[2]=0]=r$i*r$Y,r$T[1]=r$R*r$Y,r$T[2]=r$o,r$TQ.normalize(r$Q,r$Q),r$e?(r$TQ.scale(r$Q,this.length*r$e.getFloat(),r$Q),r$l[16]=r$e.seed):r$TQ.scale(r$Q,this.length*Math.random(),r$Q),r$TQ.add(r$S,r$Q,r$S),this.randomDirection&&(r$e?(r$e.seed=r$l[17],r$x._randomPointUnitSphere(r$Q,r$e),r$l[17]=r$e.seed):r$x._randomPointUnitSphere(r$Q));break;case 3:r$e?(r$e.seed=r$l[16],r$x._randomPointUnitCircle(r$p._tempPositionPoint,r$e)):r$x._randomPointUnitCircle(r$p._tempPositionPoint),r$i=r$U[0],r$R=r$U[1],r$d[0]=r$i*this.radius,r$d[1]=r$R*this.radius,r$T[r$d[2]=0]=r$i*r$Y,r$T[1]=r$R*r$Y,r$T[2]=r$o,r$TQ.normalize(r$Q,r$Q),r$e?(r$TQ.scale(r$Q,this.length*r$e.getFloat(),r$Q),r$l[16]=r$e.seed):r$TQ.scale(r$Q,this.length*Math.random(),r$Q),r$TQ.add(r$S,r$Q,r$S),this.randomDirection&&(r$e?(r$e.seed=r$l[17],r$x._randomPointUnitSphere(r$Q,r$e),r$l[17]=r$e.seed):r$x._randomPointUnitSphere(r$Q));break;default:throw new Error("ConeShape:emitType is invalid.")}},r$S.cloneTo=function(r$S){r$e.prototype.cloneTo.call(this,r$S);var r$Q=r$S;r$Q.angle=this.angle,r$Q.radius=this.radius,r$Q.length=this.length,r$Q.emitType=this.emitType,r$Q.randomDirection=this.randomDirection},r$Y(r$p,["_tempPositionPoint",function(){return this._tempPositionPoint=new r$dQ},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new r$dQ}])}(r$f),function(r$e){function r$S(){this.radius=NaN,this.emitFromShell=!1,r$S.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}r$J(r$S,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",r$e);var r$Q=r$S.prototype;r$Q._getShapeBoundBox=function(r$S){var r$Q=r$S.min.elements;r$Q[0]=r$Q[1]=r$Q[2]=-this.radius;var r$e=r$S.max.elements;r$e[0]=r$e[1]=this.radius,r$e[2]=0},r$Q._getSpeedBoundBox=function(r$S){var r$Q=r$S.min.elements;r$Q[0]=r$Q[1]=-1,r$Q[2]=0;var r$e=r$S.max.elements;r$e[0]=r$e[1]=r$e[2]=1},r$Q.generatePositionAndDirection=function(r$S,r$Q,r$e,r$l){var r$M=r$S.elements;r$e?(r$e.seed=r$l[16],this.emitFromShell?r$x._randomPointUnitSphere(r$S,r$e):r$x._randomPointInsideUnitSphere(r$S,r$e),r$l[16]=r$e.seed):this.emitFromShell?r$x._randomPointUnitSphere(r$S):r$x._randomPointInsideUnitSphere(r$S),r$TQ.scale(r$S,this.radius,r$S);var r$d=r$M[2];r$d<0&&(r$M[2]=-1*r$d),this.randomDirection?r$e?(r$e.seed=r$l[17],r$x._randomPointUnitSphere(r$Q,r$e),r$l[17]=r$e.seed):r$x._randomPointUnitSphere(r$Q):r$S.cloneTo(r$Q)},r$Q.cloneTo=function(r$S){r$e.prototype.cloneTo.call(this,r$S);var r$Q=r$S;r$Q.radius=this.radius,r$Q.emitFromShell=this.emitFromShell,r$Q.randomDirection=this.randomDirection}}(r$f),function(r$e){function r$S(){this.radius=NaN,this.emitFromShell=!1,r$S.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}r$J(r$S,"laya.d3.core.particleShuriKen.module.shape.SphereShape",r$e);var r$Q=r$S.prototype;r$Q._getShapeBoundBox=function(r$S){var r$Q=r$S.min.elements;r$Q[0]=r$Q[1]=r$Q[2]=-this.radius;var r$e=r$S.max.elements;r$e[0]=r$e[1]=r$e[2]=this.radius},r$Q._getSpeedBoundBox=function(r$S){var r$Q=r$S.min.elements;r$Q[0]=r$Q[1]=r$Q[2]=-1;var r$e=r$S.max.elements;r$e[0]=r$e[1]=r$e[2]=1},r$Q.generatePositionAndDirection=function(r$S,r$Q,r$e,r$l){r$e?(r$e.seed=r$l[16],this.emitFromShell?r$x._randomPointUnitSphere(r$S,r$e):r$x._randomPointInsideUnitSphere(r$S,r$e),r$l[16]=r$e.seed):this.emitFromShell?r$x._randomPointUnitSphere(r$S):r$x._randomPointInsideUnitSphere(r$S),r$TQ.scale(r$S,this.radius,r$S),this.randomDirection?r$e?(r$e.seed=r$l[17],r$x._randomPointUnitSphere(r$Q,r$e),r$l[17]=r$e.seed):r$x._randomPointUnitSphere(r$Q):r$S.cloneTo(r$Q)},r$Q.cloneTo=function(r$S){r$e.prototype.cloneTo.call(this,r$S);var r$Q=r$S;r$Q.radius=this.radius,r$Q.emitFromShell=this.emitFromShell,r$Q.randomDirection=this.randomDirection}}(r$f),function(r$S){function r$Q(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,r$Q.__super.call(this)}return r$J(r$Q,"laya.d3.core.render.SubMeshRenderElement",r$Z),r$Q}()),r$HQ=function(r$S){function r$c(r$S,r$Q,r$e,r$l,r$M,r$d){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=r$S,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[r$JQ.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[r$qQ.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[r$qQ.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[r$tQ.SHADERDEFINE_ALPHATEST]="ALPHATEST";r$c.__super.call(this,r$S,r$Q,r$e,null,{}),this._attributeMap=r$l;var r$T;for(r$T in r$M){var r$U=r$M[r$T];switch(r$U[1]){case 0:this._renderElementUniformMap[r$T]=r$U[0];break;case 1:this._materialUniformMap[r$T]=r$U[0];break;case 2:this._spriteUniformMap[r$T]=r$U[0];break;case 3:this._cameraUniformMap[r$T]=r$U[0];break;case 4:this._sceneUniformMap[r$T]=r$U[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}r$J(r$c,"laya.d3.shader.ShaderCompile3D",r$A);var r$Q=r$c.prototype;return r$Q._definesToNameDic=function(r$S,r$Q){for(var r$e={},r$l=1,r$M=0;r$M<32&&!(r$S<(r$l=1<<r$M));r$M++)if(r$S&r$l){var r$d=r$Q[r$l];r$d&&(r$e[r$d]="")}return r$e},r$Q.withCompile=function(r$S,r$Q,r$e,r$l){var r$M,r$d,r$T;if(r$d=this.sharders[r$S])if(r$T=r$d[r$Q]){if(r$M=r$T[r$e])return r$M}else r$T=r$d[r$Q]=[];else r$T=(r$d=this.sharders[r$S]=[])[r$Q]=[];var r$U,r$i=this._definesToNameDic(r$S,r$c._globalInt2name),r$R=this._definesToNameDic(r$Q,this._spriteInt2name),r$o=this._definesToNameDic(r$e,this._materialInt2name),r$Y={},r$p="";if(r$i)for(r$U in r$i)r$p+="#define "+r$U+"\n",r$Y[r$U]=!0;if(r$R)for(r$U in r$R)r$p+="#define "+r$U+"\n",r$Y[r$U]=!0;if(r$o)for(r$U in r$o)r$p+="#define "+r$U+"\n",r$Y[r$U]=!0;var r$J=r$nQ.nameKey.getName(this._name)+" compile ("+r$S+","+r$Q+","+r$e+")",r$L=this._VS.toscript(r$Y,[]),r$j=this._PS.toscript(r$Y,[]);r$h.now();if(r$M=r$nQ.create(r$p+r$L.join("\n"),r$p+r$j.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,r$l,r$J),r$T[r$e]=r$M,laya.d3.shader.ShaderCompile3D.debugMode)r$h.now();return r$M},r$Q.precompileShaderWithShaderDefine=function(r$S,r$Q,r$e){this.withCompile(r$S,r$Q,r$e,!0)},r$Q.addMaterialDefines=function(r$S){var r$Q=r$S.defines;for(var r$e in r$Q){var r$l=r$Q[r$e],r$M=parseInt(r$e);this._materialInt2name[r$M]=r$l,this._materialName2Int[r$l]=r$M}},r$Q.addSpriteDefines=function(r$S){var r$Q=r$S.defines;for(var r$e in r$Q){var r$l=r$Q[r$e],r$M=parseInt(r$e);this._spriteInt2name[r$M]=r$l,this._spriteName2Int[r$l]=r$M}},r$Q.getMaterialDefineByName=function(r$S){return this._materialName2Int[r$S]},r$Q.registerMaterialDefine=function(r$S){var r$Q=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[r$Q]=r$S,this._materialName2Int[r$S]=r$Q},r$Q.registerSpriteDefine=function(r$S){var r$Q=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[r$Q]=r$S,this._spriteName2Int[r$S]=r$Q},r$c._globalRegDefine=function(r$S,r$Q){r$c._globalInt2name[r$Q]=r$S},r$c.add=function(r$S,r$Q,r$e,r$l,r$M){return laya.d3.shader.ShaderCompile3D._preCompileShader[r$S]=new r$c(r$S,r$Q,r$e,r$l,r$M,r$A.includes)},r$c.get=function(r$S){return laya.d3.shader.ShaderCompile3D._preCompileShader[r$nQ.nameKey.getID(r$S)]},r$c._preCompileShader={},r$c._globalInt2name=[],r$c.debugMode=!1,r$c.SHADERDEFINE_HIGHPRECISION=1,r$c.SHADERDEFINE_FOG=4,r$c.SHADERDEFINE_DIRECTIONLIGHT=8,r$c.SHADERDEFINE_POINTLIGHT=16,r$c.SHADERDEFINE_SPOTLIGHT=32,r$c.SHADERDEFINE_UV0=64,r$c.SHADERDEFINE_COLOR=128,r$c.SHADERDEFINE_UV1=256,r$c.SAHDERDEFINE_DEPTHFOG=131072,r$c}(),r$gQ=function(r$S){function r$L(){r$L.__super.call(this)}r$J(r$L,"laya.d3.graphics.MeshSprite3DStaticBatchManager",r$lS);var r$Q=r$L.prototype;return r$Q._getStaticBatch=function(r$S,r$Q,r$e,r$l){var r$M,r$d;return r$d=r$S?r$S.id.toString()+r$e.id.toString()+r$Q.id.toString()+r$l.toString():r$e.id.toString()+r$Q.id.toString()+r$l.toString(),this._staticBatches[r$d]?r$M=this._staticBatches[r$d]:this._staticBatches[r$d]=r$M=new r$IQ(r$d,this,r$S,r$Q,r$e),r$M},r$Q._initStaticBatchs=function(r$S){var r$Q,r$e;this._initBatchRenderElements.sort(r$L._sortPrepareStaticBatch);for(var r$l,r$M=!1,r$d=0,r$T=0,r$U=this._initBatchRenderElements.length;r$T<r$U;r$T++){var r$i,r$R=this._initBatchRenderElements[r$T],r$o=r$R.renderObj._getVertexBuffer(0);r$R._sprite3D;if(r$e===r$o.vertexDeclaration&&r$Q===r$R._material)if(r$M)r$l._addCombineBatchRenderObjTest(r$R)?(r$i=r$R._staticBatch)!==r$l&&(r$i&&r$i._deleteCombineBatchRenderObj(r$R),r$l._addCombineBatchRenderObj(r$R)):(r$M=!1,r$d++);else{var r$Y=this._initBatchRenderElements[r$T-1],r$p=r$Y.renderObj,r$J=r$R.renderObj;r$M=!(65535<r$p._getVertexBuffer().vertexCount+r$J._getVertexBuffer().vertexCount)&&(r$l=this._getStaticBatch(r$S,r$e,r$Q,r$d),(r$i=r$Y._staticBatch)!==r$l&&(r$i&&r$i._deleteCombineBatchRenderObj(r$Y),r$l._addCombineBatchRenderObj(r$Y)),(r$i=r$R._staticBatch)!==r$l&&(r$i&&r$i._deleteCombineBatchRenderObj(r$R),r$l._addCombineBatchRenderObj(r$R)),!0)}else r$M=!1,r$d=0;r$Q=r$R._material,r$e=r$o.vertexDeclaration}},r$L._sortPrepareStaticBatch=function(r$S,r$Q){var r$e=r$S._render,r$l=r$Q._render,r$M=r$e.lightmapIndex-r$l.lightmapIndex;if(0!=r$M)return r$M;var r$d=r$e.receiveShadow-r$l.receiveShadow;if(0!=r$d)return r$d;var r$T=r$S._mainSortID-r$Q._mainSortID;return 0==r$T?r$S.renderObj.triangleCount-r$Q.renderObj.triangleCount:r$T},r$L}(),r$IQ=function(r$S){function r$d(r$S,r$Q,r$e,r$l,r$M){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,r$d.__super.call(this,r$S,r$Q,r$e),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=r$l,this._material=r$M}r$J(r$d,"laya.d3.graphics.SubMeshStaticBatch",r$MS);var r$Q=r$d.prototype;return r$Q._compareBatchRenderElement=function(r$S,r$Q){return r$S._batchIndexStart>r$Q._batchIndexStart},r$Q._addCombineBatchRenderObjTest=function(r$S){var r$Q=r$S.renderObj._vertexCount;return!(65535<(0<r$Q?this._currentCombineVertexCount+r$Q:this._currentCombineVertexCount+r$S.renderObj._getVertexBuffer().vertexCount))},r$Q._addCombineBatchRenderObj=function(r$S){var r$Q=r$S.renderObj,r$e=r$Q._vertexCount;this._initBatchRenderElements.push(r$S),r$S._staticBatch=this,0<r$e?(this._currentCombineIndexCount+=r$Q._indexCount,this._currentCombineVertexCount+=r$e):(this._currentCombineIndexCount=this._currentCombineIndexCount+r$Q._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+r$Q._getVertexBuffer().vertexCount),this._needFinishCombine=!0},r$Q._deleteCombineBatchRenderObj=function(r$S){var r$Q=r$S.renderObj,r$e=this._initBatchRenderElements.indexOf(r$S);if(-1!==r$e){this._initBatchRenderElements.splice(r$e,1),r$S._staticBatch=null;var r$l=r$Q._vertexCount;0<r$l?(this._currentCombineIndexCount=this._currentCombineIndexCount-r$Q._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-r$l):(this._currentCombineIndexCount=this._currentCombineIndexCount-r$Q._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-r$Q._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},r$Q._finishInit=function(){if(this._needFinishCombine){var r$S=0,r$Q=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var r$e=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),r$l=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=r$fQ.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=r$aQ.create("ushort",this._currentCombineIndexCount,35044);for(var r$M=0,r$d=this._initBatchRenderElements.length;r$M<r$d;r$M++){var r$T=this._initBatchRenderElements[r$M],r$U=r$T.renderObj,r$i=r$U._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,r$T._sprite3D),r$R=r$U.getIndices(),r$o=r$T._sprite3D.transform._isFrontFaceInvert,r$Y=r$S/(this._vertexDeclaration.vertexStride/4)-r$U._vertexStart,r$p=r$Q,r$J=r$p+r$R.length;r$T._batchIndexStart=r$p,r$T._batchIndexEnd=r$J,r$l.set(r$R,r$Q);var r$L=0;if(r$o)for(r$L=r$p;r$L<r$J;r$L+=3){r$l[r$L]=r$Y+r$l[r$L];var r$j=r$l[r$L+1],r$c=r$l[r$L+2];r$l[r$L+1]=r$Y+r$c,r$l[r$L+2]=r$Y+r$j}else for(r$L=r$p;r$L<r$J;r$L+=3)r$l[r$L]=r$Y+r$l[r$L],r$l[r$L+1]=r$Y+r$l[r$L+1],r$l[r$L+2]=r$Y+r$l[r$L+2];r$Q+=r$R.length,r$e.set(r$i,r$S),r$S+=r$i.length}this._vertexBuffer.setData(r$e),this._indexBuffer.setData(r$l),this._needFinishCombine=!1}},r$Q._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new r$OQ)},r$Q._getRenderElement=function(r$S,r$Q,r$e){for(var r$l,r$M,r$d=this._batchRenderElements.length,r$T=!0,r$U=0;r$U<r$d;r$U++){var r$i,r$R,r$o=(r$M=this._batchRenderElements[r$U])._sprite3D._render;if(0!==r$U&&(r$T=(r$i=(r$l=this._batchRenderElements[r$U-1])._sprite3D._render).lightmapIndex!==r$o.lightmapIndex||r$i.receiveShadow!==r$o.receiveShadow||r$l._batchIndexEnd!==r$M._batchIndexStart),r$T){(r$R=this._getCombineRenderElementFromPool()).renderObj=this,r$R._material=this._material,r$R._batchIndexStart=r$M._batchIndexStart,r$R._batchIndexEnd=r$M._batchIndexEnd;var r$Y=r$o.lightmapIndex,r$p=r$Y+1,r$J=this._batchOwnerIndices[r$p];r$J||(r$J=this._batchOwnerIndices[r$p]=[]);var r$L,r$j=r$J[r$M._render.receiveShadow?1:0];void 0===r$j?(r$J[r$o.receiveShadow?1:0]=this._batchOwners.length,(r$L=new r$NQ(null,"StaticBatchMeshSprite3D"))._scene=r$Q,r$L._transform=this._rootOwner?this._rootOwner._transform:null,r$L._render.lightmapIndex=r$Y,r$L._render.receiveShadow=r$M._render.receiveShadow,this._batchOwners.push(r$L)):r$L=this._batchOwners[r$j],r$L._render._renderUpdate(r$e),r$R._sprite3D=r$L,r$S.push(r$R)}else r$R._batchIndexEnd=r$M._batchIndexEnd}},r$Q._beforeRender=function(r$S){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},r$Q._render=function(r$S){var r$Q=r$S.renderElement,r$e=r$Q._batchIndexStart,r$l=r$Q._batchIndexEnd-r$e;r$k.mainContext.drawElements(4,r$l,5123,2*r$e),r$H.drawCall++,r$H.trianglesFaces+=r$l/3},r$Q.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},r$Q._getVertexBuffer=function(r$S){return void 0===r$S&&(r$S=0),this._vertexBuffer},r$d}(),r$EQ=function(r$S){function r$Q(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,r$Q.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}r$J(r$Q,"laya.d3.core.ComponentNode",r$R);var r$e=r$Q.prototype;return r$e.addComponent=function(r$S){var r$Q,r$e=this._componentsMap.indexOf(r$S);if(-1===r$e)r$Q=[],this._componentsMap.push(r$S),this._typeComponentsIndices.push(r$Q);else if(r$Q=this._typeComponentsIndices[r$e],this._components[r$Q[0]].isSingleton)throw new Error("无法单实例创建"+r$S+"组件，"+r$S+"组件已存在！");var r$l=r$M.getInstance(r$S);return r$Q.push(this._components.length),this._components.push(r$l),r$l instanceof laya.d3.component.Script&&this._scripts.push(r$l),r$l._initialize(this),r$l},r$e._removeComponent=function(r$S,r$Q){var r$e=this._typeComponentsIndices[r$S],r$l=r$e[r$Q],r$M=this._components[r$l];this._components.splice(r$l,1),r$M instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(r$M),1),r$e.splice(r$Q,1),0===r$e.length&&(this._typeComponentsIndices.splice(r$S,1),this._componentsMap.splice(r$S,1));for(var r$d=0,r$T=this._componentsMap.length;r$d<r$T;r$d++)for(var r$U=(r$e=this._typeComponentsIndices[r$d]).length-1;0<=r$U;r$U--){var r$i=r$e[r$U];if(!(r$l<r$i))break;r$e[r$U]=--r$i}r$M._destroy()},r$e.getComponentByType=function(r$S,r$Q){void 0===r$Q&&(r$Q=0);var r$e=this._componentsMap.indexOf(r$S);return-1===r$e?null:this._components[this._typeComponentsIndices[r$e][r$Q]]},r$e.getComponentsByType=function(r$S,r$Q){var r$e=this._componentsMap.indexOf(r$S);if(-1!==r$e){var r$l=this._typeComponentsIndices[r$e],r$M=r$l.length;r$Q.length=r$M;for(var r$d=0;r$d<r$M;r$d++)r$Q[r$d]=this._components[r$l[r$d]]}else r$Q.length=0},r$e.getComponentByIndex=function(r$S){return this._components[r$S]},r$e.removeComponentByType=function(r$S,r$Q){void 0===r$Q&&(r$Q=0);var r$e=this._componentsMap.indexOf(r$S);-1!==r$e&&this._removeComponent(r$e,r$Q)},r$e.removeComponentsByType=function(r$S){var r$Q=this._componentsMap.indexOf(r$S);if(-1!==r$Q)for(var r$e=this._typeComponentsIndices[r$Q],r$l=0,r$M=r$e.length;r$l<r$M;r$e.length<r$M?r$M--:r$l++)this._removeComponent(r$Q,r$l)},r$e.removeAllComponent=function(){for(var r$S=0,r$Q=this._componentsMap.length;r$S<r$Q;this._componentsMap.length<r$Q?r$Q--:r$S++)this.removeComponentsByType(this._componentsMap[r$S])},r$e._updateComponents=function(r$S){for(var r$Q=0,r$e=this._components.length;r$Q<r$e;r$Q++){var r$l=this._components[r$Q];!r$l.started&&(r$l._start(r$S),r$l.started=!0),r$l.enable&&r$l._update(r$S)}},r$e._lateUpdateComponents=function(r$S){for(var r$Q=0;r$Q<this._components.length;r$Q++){var r$e=this._components[r$Q];!r$e.started&&(r$e._start(r$S),r$e.started=!0),r$e.enable&&r$e._lateUpdate(r$S)}},r$e._preRenderUpdateComponents=function(r$S){for(var r$Q=0;r$Q<this._components.length;r$Q++){var r$e=this._components[r$Q];!r$e.started&&(r$e._start(r$S),r$e.started=!0),r$e.enable&&r$e._preRenderUpdate(r$S)}},r$e._postRenderUpdateComponents=function(r$S){for(var r$Q=0;r$Q<this._components.length;r$Q++){var r$e=this._components[r$Q];!r$e.started&&(r$e._start(r$S),r$e.started=!0),r$e.enable&&r$e._postRenderUpdate(r$S)}},r$Q}(),r$tQ=function(r$l){function r$S(){r$S.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new r$pQ,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new r$UQ(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}r$J(r$S,"laya.d3.core.material.BaseMaterial",r$l);var r$Q=r$S.prototype;return r$D.imps(r$Q,{"laya.d3.core.IClone":!0}),r$Q._addShaderDefine=function(r$S){this._shaderDefineValue|=r$S},r$Q._removeShaderDefine=function(r$S){this._shaderDefineValue&=~r$S},r$Q._addDisablePublicShaderDefine=function(r$S){this._disablePublicShaderDefine|=r$S},r$Q._removeDisablePublicShaderDefine=function(r$S){this._disablePublicShaderDefine&=~r$S},r$Q._setBuffer=function(r$S,r$Q){this._shaderValues.setValue(r$S,r$Q),this._values[r$S]=r$Q},r$Q._getBuffer=function(r$S){return this._values[r$S]},r$Q._setMatrix4x4=function(r$S,r$Q){this._shaderValues.setValue(r$S,r$Q?r$Q.elements:null),this._values[r$S]=r$Q},r$Q._getMatrix4x4=function(r$S){return this._values[r$S]},r$Q._setInt=function(r$S,r$Q){this._shaderValues.setValue(r$S,r$Q),this._values[r$S]=r$Q},r$Q._getInt=function(r$S){return this._values[r$S]},r$Q._setNumber=function(r$S,r$Q){this._shaderValues.setValue(r$S,r$Q),this._values[r$S]=r$Q},r$Q._getNumber=function(r$S){return this._values[r$S]},r$Q._setBool=function(r$S,r$Q){this._shaderValues.setValue(r$S,r$Q),this._values[r$S]=r$Q},r$Q._getBool=function(r$S){return this._values[r$S]},r$Q._setVector2=function(r$S,r$Q){this._shaderValues.setValue(r$S,r$Q?r$Q.elements:null),this._values[r$S]=r$Q},r$Q._getVector2=function(r$S){return this._values[r$S]},r$Q._setColor=function(r$S,r$Q){this._shaderValues.setValue(r$S,r$Q?r$Q.elements:null),this._values[r$S]=r$Q},r$Q._getColor=function(r$S){return this._values[r$S]},r$Q._setTexture=function(r$S,r$Q){var r$e=this._values[r$S];this._values[r$S]=r$Q,this._shaderValues.setValue(r$S,r$Q),0<this.referenceCount&&(r$e&&r$e._removeReference(),r$Q&&r$Q._addReference())},r$Q._getTexture=function(r$S){return this._values[r$S]},r$Q._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},r$Q._getShader=function(r$S,r$Q,r$e){var r$l=(r$S|r$Q)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(r$l,r$e,this._shaderDefineValue),this._shader},r$Q._setRenderStateBlendDepth=function(){var r$S=r$k.mainContext;switch(r$X.setDepthMask(r$S,this.depthWrite),0===this.depthTest?r$X.setDepthTest(r$S,!1):(r$X.setDepthTest(r$S,!0),r$X.setDepthFunc(r$S,this.depthTest)),this.blend){case 0:r$X.setBlend(r$S,!1);break;case 1:r$X.setBlend(r$S,!0),r$X.setBlendFunc(r$S,this.srcBlend,this.dstBlend);break;case 2:r$X.setBlend(r$S,!0)}},r$Q._setRenderStateFrontFace=function(r$S,r$Q){var r$e=r$k.mainContext,r$l=0;switch(this.cull){case 0:r$X.setCullFace(r$e,!1);break;case 1:r$X.setCullFace(r$e,!0),r$l=r$S?r$Q&&r$Q._isFrontFaceInvert?2305:2304:r$Q&&r$Q._isFrontFaceInvert?2304:2305,r$X.setFrontFace(r$e,r$l);break;case 2:r$X.setCullFace(r$e,!0),r$l=r$S?r$Q&&r$Q._isFrontFaceInvert?2304:2305:r$Q&&r$Q._isFrontFaceInvert?2305:2304,r$X.setFrontFace(r$e,r$l)}},r$Q.onAsynLoaded=function(r$S,r$Q,r$e){var r$l=r$Q[0],r$M=r$Q[1];switch(r$l.version){case"LAYAMATERIAL:01":var r$d=0,r$T=0,r$U=r$l.props;for(var r$i in r$U)switch(r$i){case"vectors":var r$R=r$U[r$i];for(r$d=0,r$T=r$R.length;r$d<r$T;r$d++){var r$o=r$R[r$d],r$Y=r$o.value;switch(r$Y.length){case 2:this[r$o.name]=new r$dQ(r$Y[0],r$Y[1]);break;case 3:this[r$o.name]=new r$TQ(r$Y[0],r$Y[1],r$Y[2]);break;case 4:this[r$o.name]=new r$UQ(r$Y[0],r$Y[1],r$Y[2],r$Y[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var r$p=r$U[r$i];for(r$d=0,r$T=r$p.length;r$d<r$T;r$d++){var r$J=r$p[r$d],r$L=r$J.path;r$L&&(this[r$J.name]=r$G.getRes(r$M[r$L]))}break;case"defines":var r$j=r$U[r$i];for(r$d=0,r$T=r$j.length;r$d<r$T;r$d++){var r$c=this._shaderCompile.getMaterialDefineByName(r$j[r$d]);this._addShaderDefine(r$c)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[r$i]=r$U[r$i];break;case"renderQueue":switch(r$U[r$i]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[r$i]=r$U[r$i]}break;case"LAYAMATERIAL:02":for(r$i in r$U=r$l.props)switch(r$i){case"vectors":for(r$d=0,r$T=(r$R=r$U[r$i]).length;r$d<r$T;r$d++)switch((r$Y=(r$o=r$R[r$d]).value).length){case 2:this[r$o.name]=new r$dQ(r$Y[0],r$Y[1]);break;case 3:this[r$o.name]=new r$TQ(r$Y[0],r$Y[1],r$Y[2]);break;case 4:this[r$o.name]=new r$UQ(r$Y[0],r$Y[1],r$Y[2],r$Y[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(r$d=0,r$T=(r$p=r$U[r$i]).length;r$d<r$T;r$d++)(r$L=(r$J=r$p[r$d]).path)&&(this[r$J.name]=r$G.getRes(r$M[r$L]));break;case"defines":for(r$d=0,r$T=(r$j=r$U[r$i]).length;r$d<r$T;r$d++)r$c=this._shaderCompile.getMaterialDefineByName(r$j[r$d]),this._addShaderDefine(r$c);break;default:this[r$i]=r$U[r$i]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},r$Q._addReference=function(){r$l.prototype._addReference.call(this);for(var r$S=0,r$Q=this._values.length;r$S<r$Q;r$S++){var r$e=this._values[r$S];r$e&&r$e instanceof laya.d3.resource.BaseTexture&&r$e._addReference()}},r$Q._removeReference=function(){r$l.prototype._removeReference.call(this);for(var r$S=0,r$Q=this._values.length;r$S<r$Q;r$S++){var r$e=this._values[r$S];r$e&&r$e instanceof laya.d3.resource.BaseTexture&&r$e._removeReference()}},r$Q.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},r$Q.setShaderName=function(r$S){var r$Q=r$nQ.nameKey.getID(r$S);if(-1===r$Q)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=r$HQ._preCompileShader[r$Q]},r$Q.cloneTo=function(r$S){var r$Q=r$S;r$Q.name=this.name,r$Q.cull=this.cull,r$Q.blend=this.blend,r$Q.srcBlend=this.srcBlend,r$Q.dstBlend=this.dstBlend,r$Q.srcBlendRGB=this.srcBlendRGB,r$Q.dstBlendRGB=this.dstBlendRGB,r$Q.srcBlendAlpha=this.srcBlendAlpha,r$Q.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(r$Q.blendConstColor),r$Q.blendEquation=this.blendEquation,r$Q.blendEquationRGB=this.blendEquationRGB,r$Q.blendEquationAlpha=this.blendEquationAlpha,r$Q.depthTest=this.depthTest,r$Q.depthWrite=this.depthWrite,r$Q.renderQueue=this.renderQueue,r$Q._shader=this._shader,r$Q._disablePublicShaderDefine=this._disablePublicShaderDefine,r$Q._shaderDefineValue=this._shaderDefineValue;var r$e,r$l=0,r$M=r$Q._shaderValues;r$Q._shaderValues.data.length=this._shaderValues.data.length;var r$d=this._values.length,r$T=r$Q._values;for(r$l=0,r$e=r$T.length=r$d;r$l<r$e;r$l++){var r$U=this._values[r$l];if(r$U)if("number"==typeof r$U)r$T[r$l]=r$U,r$M.data[r$l]=r$U;else if("number"==typeof r$U&&Math.floor(r$U)==r$U)r$T[r$l]=r$U,r$M.data[r$l]=r$U;else if("boolean"==typeof r$U)r$T[r$l]=r$U,r$M.data[r$l]=r$U;else if(r$U instanceof laya.d3.math.Vector2){var r$i=r$T[r$l]||(r$T[r$l]=new r$dQ);r$U.cloneTo(r$i),r$M.data[r$l]=r$i.elements}else if(r$U instanceof laya.d3.math.Vector3){var r$R=r$T[r$l]||(r$T[r$l]=new r$TQ);r$U.cloneTo(r$R),r$M.data[r$l]=r$R.elements}else if(r$U instanceof laya.d3.math.Vector4){var r$o=r$T[r$l]||(r$T[r$l]=new r$UQ);r$U.cloneTo(r$o),r$M.data[r$l]=r$o.elements}else if(r$U instanceof laya.d3.math.Matrix4x4){var r$Y=r$T[r$l]||(r$T[r$l]=new r$SQ);r$U.cloneTo(r$Y),r$M.data[r$l]=r$Y.elements}else r$U instanceof laya.d3.resource.BaseTexture&&(r$T[r$l]=r$U,r$M.data[r$l]=r$U)}},r$Q.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$L(0,r$Q,"alphaTestValue",function(){return this._getNumber(0)},function(r$S){this._setNumber(0,r$S)}),r$L(0,r$Q,"alphaTest",function(){return this._alphaTest},function(r$S){(this._alphaTest=r$S)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),r$S.__init__=function(){r$S.SHADERDEFINE_ALPHATEST=r$S.shaderDefines.registerDefine("ALPHATEST")},r$S.RENDERQUEUE_OPAQUE=2e3,r$S.RENDERQUEUE_ALPHATEST=2450,r$S.RENDERQUEUE_TRANSPARENT=3e3,r$S.CULL_NONE=0,r$S.CULL_FRONT=1,r$S.CULL_BACK=2,r$S.BLEND_DISABLE=0,r$S.BLEND_ENABLE_ALL=1,r$S.BLEND_ENABLE_SEPERATE=2,r$S.BLENDPARAM_ZERO=0,r$S.BLENDPARAM_ONE=1,r$S.BLENDPARAM_SRC_COLOR=768,r$S.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,r$S.BLENDPARAM_DST_COLOR=774,r$S.BLENDPARAM_ONE_MINUS_DST_COLOR=775,r$S.BLENDPARAM_SRC_ALPHA=770,r$S.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,r$S.BLENDPARAM_DST_ALPHA=772,r$S.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,r$S.BLENDPARAM_SRC_ALPHA_SATURATE=776,r$S.BLENDEQUATION_ADD=0,r$S.BLENDEQUATION_SUBTRACT=1,r$S.BLENDEQUATION_REVERSE_SUBTRACT=2,r$S.DEPTHTEST_OFF=0,r$S.DEPTHTEST_NEVER=512,r$S.DEPTHTEST_LESS=513,r$S.DEPTHTEST_EQUAL=514,r$S.DEPTHTEST_LEQUAL=515,r$S.DEPTHTEST_GREATER=516,r$S.DEPTHTEST_NOTEQUAL=517,r$S.DEPTHTEST_GEQUAL=518,r$S.DEPTHTEST_ALWAYS=519,r$S.SHADERDEFINE_ALPHATEST=1,r$S.ALPHATESTVALUE=0,r$Y(r$S,["shaderDefines",function(){return this.shaderDefines=new r$oQ}]),r$S}(r$c),r$kQ=function(r$S){function r$Q(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,r$Q.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}r$J(r$Q,"laya.d3.resource.BaseTexture",r$c);var r$e=r$Q.prototype;return r$L(0,r$e,"width",function(){return this._width}),r$L(0,r$e,"repeat",function(){return this._repeat},function(r$S){if(this._repeat!==r$S&&(this._repeat=r$S,this._source)){var r$Q=r$k.mainContext;r$X.bindTexture(r$Q,this._type,this._source),r$v.isPOT(this._width,this._height)&&this._repeat?(r$Q.texParameteri(this._type,10242,10497),r$Q.texParameteri(this._type,10243,10497)):(r$Q.texParameteri(this._type,10242,33071),r$Q.texParameteri(this._type,10243,33071))}}),r$L(0,r$e,"height",function(){return this._height}),r$L(0,r$e,"magFifter",function(){return this._magFifter},function(r$S){(this._magFifter=r$S)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(r$S)}),r$L(0,r$e,"wrapModeV",function(){return this._wrapModeV}),r$L(0,r$e,"size",function(){return this._size}),r$L(0,r$e,"wrapModeU",function(){return this._wrapModeU}),r$L(0,r$e,"mipmap",function(){return this._mipmap},function(r$S){this._mipmap=r$S,this._mipmap!=r$S&&this._conchTexture&&this._conchTexture.setMipMap(r$S)}),r$L(0,r$e,"minFifter",function(){return this._minFifter},function(r$S){this._minFifter=r$S,this._minFifter!=r$S&&this._conchTexture&&this._conchTexture.setMinFifter(r$S)}),r$L(0,r$e,"format",function(){return this._format}),r$L(0,r$e,"source",function(){return this.activeResource(),this._source}),r$L(0,r$e,"defaulteTexture",function(){return r$WQ.grayTexture}),r$Q.WARPMODE_REPEAT=0,r$Q.WARPMODE_CLAMP=1,r$Q}(),r$XQ=function(r$S){function r$Q(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,r$Q.__super.call(this),this._boundingBoxCorners=r$l(8,null)}r$J(r$Q,"laya.d3.resource.models.BaseMesh",r$c);var r$e=r$Q.prototype;return r$e._getPositions=function(){throw new Error("未Override,请重载该属性！")},r$e._generateBoundingObject=function(){this._boundingSphere=new r$_S(new r$TQ,0),r$_S.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new r$KS(new r$TQ,new r$TQ),r$KS.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},r$e.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},r$e.getRenderElement=function(r$S){throw new Error("未Override,请重载该属性！")},r$L(0,r$e,"subMeshCount",function(){return this._subMeshCount}),r$L(0,r$e,"boundingBox",function(){return this._boundingBox}),r$L(0,r$e,"boundingBoxCorners",function(){return this._boundingBoxCorners}),r$L(0,r$e,"boundingSphere",function(){return this._boundingSphere}),r$Q}(),r$hQ=(function(r$S){function r$Q(){r$Q.__super.call(this)}r$J(r$Q,"laya.d3.component.Script",r$AQ);var r$e=r$Q.prototype;r$e.onTriggerEnter=function(r$S){},r$e.onTriggerExit=function(r$S){},r$e.onTriggerStay=function(r$S){},r$L(0,r$e,"isSingleton",function(){return r$Q._isSingleton}),r$Q._isSingleton=!1}(),function(r$S){function r$Q(r$S){this._owner=null,this._sharedMesh=null,r$Q.__super.call(this),this._owner=r$S}r$J(r$Q,"laya.d3.core.MeshFilter",r$S);var r$e=r$Q.prototype;return r$e._sharedMeshLoaded=function(){this.event("loaded")},r$e._destroy=function(){r$S.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},r$L(0,r$e,"sharedMesh",function(){return this._sharedMesh},function(r$S){var r$Q=this._sharedMesh;r$Q&&r$Q._removeReference(),(this._sharedMesh=r$S)._addReference(),this.event("meshchanged",[this,r$Q,r$S]),r$S.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),r$L(0,r$e,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),r$L(0,r$e,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),r$L(0,r$e,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),r$L(0,r$e,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),r$Q}(r$vQ)),r$bQ=function(r$S){function r$Q(r$S){r$Q.__super.call(this,r$S),r$S.meshFilter.on("meshchanged",this,this._onMeshChanged)}r$J(r$Q,"laya.d3.core.MeshRender",r$DQ);var r$e=r$Q.prototype;return r$e._onMeshChanged=function(r$S,r$Q,r$e){r$e.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:r$e.once("loaded",this,this._onMeshLoaed)},r$e._onMeshLoaed=function(r$S,r$Q){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},r$e._calculateBoundingSphereByInitSphere=function(r$S){var r$Q=NaN,r$e=this._owner.transform,r$l=r$e.scale.elements,r$M=Math.abs(r$l[0]),r$d=Math.abs(r$l[1]),r$T=Math.abs(r$l[2]);r$Q=r$d<=r$M&&r$T<=r$M?r$M:r$T<=r$d?r$d:r$T,r$TQ.transformCoordinate(r$S.center,r$e.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=r$S.radius*r$Q},r$e._calculateBoundBoxByInitCorners=function(r$S){for(var r$Q=this._owner.transform.worldMatrix,r$e=0;r$e<8;r$e++)r$TQ.transformCoordinate(r$S[r$e],r$Q,r$DQ._tempBoundBoxCorners[r$e]);r$KS.createfromPoints(r$DQ._tempBoundBoxCorners,this._boundingBox)},r$e._calculateBoundingSphere=function(){var r$S=this._owner.meshFilter.sharedMesh;null==r$S||null==r$S.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(r$S.boundingSphere)},r$e._calculateBoundingBox=function(){var r$S=this._owner.meshFilter.sharedMesh;null==r$S||null==r$S.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(r$S.boundingBoxCorners)},r$e._renderUpdate=function(r$S){var r$Q=this._owner.transform;if(r$Q){this._setShaderValueMatrix4x4(0,r$Q.worldMatrix);var r$e=this._owner.getProjectionViewWorldMatrix(r$S);this._setShaderValueMatrix4x4(1,r$e)}else this._setShaderValueMatrix4x4(0,r$SQ.DEFAULT),this._setShaderValueMatrix4x4(1,r$S);return r$GQ.debugMode&&this._renderRenderableBoundBox(),!0},r$Q}(),r$mQ=function(r$Q){function r$l(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,r$l.__super.call(this),this._renderState=new r$C,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new r$pQ,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new r$QS,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new r$TQ(.7,.7,.7),this.ambientColor=new r$TQ(.212,.227,.259),r$k.shaderHighPrecision&&this.addShaderDefine(r$HQ.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}r$J(r$l,"laya.d3.core.scene.Scene",r$Q);var r$S=r$l.prototype;return r$D.imps(r$S,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),r$S._setUrl=function(r$S){this._url=r$S},r$S._getGroup=function(){return this._group},r$S._setGroup=function(r$S){this._group=r$S},r$S._display=function(){r$D.stage._scenes.push(this),r$D.stage._scenes.sort(r$l._sortScenes);for(var r$S=0,r$Q=this._childs.length;r$S<r$Q;r$S++){var r$e=this._childs[r$S];r$e.active&&r$e._activeHierarchy()}},r$S._unDisplay=function(){var r$S=r$D.stage._scenes;r$S.splice(r$S.indexOf(this),1);for(var r$Q=0,r$e=this._childs.length;r$Q<r$e;r$Q++){var r$l=this._childs[r$Q];r$l.active&&r$l._inActiveHierarchy()}},r$S._addChild3D=function(r$S){r$S.transform._onWorldTransform(),r$S._setBelongScene(this),this.displayedInStage&&r$S.active&&r$S._activeHierarchy()},r$S._removeChild3D=function(r$S){r$S.transform.parent=null,this.displayedInStage&&r$S.active&&r$S._inActiveHierarchy(),r$S._setUnBelongScene()},r$S.initOctree=function(r$S,r$Q,r$e,r$l,r$M){void 0===r$M&&(r$M=6),this.treeSize=new r$TQ(r$S,r$Q,r$e),this.treeLevel=r$M,this.treeRoot=new r$K(this,0),this.treeRoot.init(r$l,this.treeSize)},r$S._prepareUpdateToRenderState=function(r$S,r$Q){r$Q.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,r$Q.scene=this},r$S._prepareSceneToRender=function(r$S){var r$Q=this._lights.length;if(0<r$Q)for(var r$e=0,r$l=0;r$l<r$Q&&!(this._lights[r$l]._prepareToScene(r$S)&&++r$e>=this._enableLightCount);r$l++);},r$S._updateChilds=function(r$S){for(var r$Q=0,r$e=this._childs.length;r$Q<r$e;++r$Q)this._childs[r$Q]._update(r$S)},r$S._preRenderScene=function(r$S,r$Q,r$e){var r$l,r$M=r$Q._viewMatrix,r$d=r$Q._projectionMatrix,r$T=r$Q._projectionViewMatrix,r$U=0,r$i=r$Q.camera;for(r$i.useOcclusionCulling?this.treeRoot?r$eS.renderObjectCullingOctree(r$e,this,r$i,r$M,r$d,r$T):r$eS.renderObjectCulling(r$e,this,r$i,r$M,r$d,r$T):r$eS.renderObjectCullingNoBoundFrustum(this,r$i,r$M,r$d,r$T),r$U=0,r$l=this._quenes.length;r$U<r$l;r$U++)this._quenes[r$U]&&this._quenes[r$U]._preRender(r$Q)},r$S._clear=function(r$S,r$Q){var r$e=r$Q._viewport,r$l=r$Q.camera,r$M=r$e.x,r$d=r$l.renderTargetSize.height-r$e.y-r$e.height,r$T=r$e.width,r$U=r$e.height;r$S.viewport(r$M,r$d,r$T,r$U);var r$i=256,r$R=r$l.renderTarget;switch(r$l.clearFlag){case 0:var r$o=r$l.clearColor;if(r$o){r$S.enable(3089),r$S.scissor(r$M,r$d,r$T,r$U);var r$Y=r$o.elements;r$S.clearColor(r$Y[0],r$Y[1],r$Y[2],r$Y[3]),r$i|=16384}if(r$R)switch(r$o||(r$i=16384),r$R.depthStencilFormat){case 33189:r$i|=256;break;case 36168:r$i|=1024;break;case 34041:r$i|=256,r$i|=1024}r$S.clear(r$i),r$o&&r$S.disable(3089);break;case 1:case 2:if(r$R)switch(r$i=16384,r$R.depthStencilFormat){case 33189:r$i|=256;break;case 36168:r$i|=1024;break;case 34041:r$i|=256,r$i|=1024}r$S.clear(r$i);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},r$S._renderScene=function(r$S,r$Q){var r$e,r$l,r$M=r$Q.camera,r$d=0;for(r$d=0;r$d<2;r$d++)(r$l=this._quenes[r$d])&&(r$M.renderTarget?r$l._render(r$Q,!0):r$l._render(r$Q,!1));if(1===r$M.clearFlag){var r$T=r$M.sky;r$T&&(r$X.setCullFace(r$S,!1),r$X.setDepthFunc(r$S,515),r$X.setDepthMask(r$S,!1),r$T._render(r$Q),r$X.setDepthFunc(r$S,513),r$X.setDepthMask(r$S,!0))}for(r$d=2,r$e=this._quenes.length;r$d<r$e;r$d++)(r$l=this._quenes[r$d])&&(r$l._sortAlpha(r$Q.camera.transform.position),r$M.renderTarget?r$l._render(r$Q,!0):r$l._render(r$Q,!1))},r$S._set3DRenderConfig=function(r$S){r$S.disable(3042),r$X._blend=!1,r$S.blendFunc(770,771),r$X._sFactor=770,r$X._dFactor=771,r$S.disable(2929),r$X._depthTest=!1,r$S.enable(2884),r$X._cullFace=!0,r$S.depthMask(1),r$X._depthMask=!0,r$S.frontFace(2304),r$X._frontFace=2304},r$S._set2DRenderConfig=function(r$S){r$X.setBlend(r$S,!0),r$X.setBlendFunc(r$S,1,771),r$X.setDepthTest(r$S,!1),r$X.setCullFace(r$S,!1),r$X.setDepthMask(r$S,!0),r$X.setFrontFace(r$S,2305),r$S.viewport(0,0,r$o.width,r$o.height)},r$S._parseCustomProps=function(r$S,r$Q,r$e,r$l){var r$M=r$l.customProps.lightmaps,r$d=r$M.length,r$T=this._lightmaps;r$T.length=r$d;for(var r$U=0;r$U<r$d;r$U++)r$T[r$U]=r$G.getRes(r$Q[r$M[r$U].replace(".exr",".png")]);this.setlightmaps(r$T);var r$i=r$l.customProps.ambientColor;r$i&&(this.ambientColor=new r$TQ(r$i[0],r$i[1],r$i[2]));var r$R=r$l.customProps.fogColor;r$R&&(this.fogColor=new r$TQ(r$R[0],r$R[1],r$R[2]))},r$S._addLight=function(r$S){this._lights.indexOf(r$S)<0&&this._lights.push(r$S)},r$S._removeLight=function(r$S){var r$Q=this._lights.indexOf(r$S);0<=r$Q&&this._lights.splice(r$Q,1)},r$S._updateScene=function(){var r$S=this._renderState;this._prepareUpdateToRenderState(r$k.mainContext,r$S),this._updateComponents(r$S),this._updateChilds(r$S),this._lateUpdateComponents(r$S),this._time+=r$S.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},r$S._updateSceneConch=function(){var r$S=this._renderState;this._prepareUpdateToRenderState(r$k.mainContext,r$S),this._updateComponents(r$S),this._lateUpdateComponents(r$S),this._prepareSceneToRender(r$S);for(var r$Q=0,r$e=this._cameraPool.length;r$Q<r$e;r$Q++){var r$l=this._cameraPool[r$Q];(r$S.camera=r$l)._prepareCameraToRender()}},r$S._preRenderShadow=function(r$S,r$Q,r$e,r$l,r$M){this.treeRoot?r$eS.renderShadowObjectCullingOctree(this,r$Q,r$e,r$l,r$M):r$eS.renderShadowObjectCulling(this,r$Q,r$e,r$l,r$M);for(var r$d=0,r$T=r$e.length;r$d<r$T;r$d++)r$e[r$d]&&r$e[r$d]._preRender(r$S)},r$S._renderShadowMap=function(r$S,r$Q,r$e){var r$l=this.parallelSplitShadowMaps[0];r$l._calcAllLightCameraInfo(r$e);var r$M,r$d,r$T,r$U=r$l.PSSMNum;if(this._preRenderShadow(r$Q,r$l._lightCulling,r$l._shadowQuenes,r$l._lightVPMatrix[0],r$U),this.addShaderDefine(r$JQ.SHADERDEFINE_CAST_SHADOW),1<r$U)for(var r$i=0;r$i<r$U;r$i++)r$M=r$l.getRenderTarget(r$i+1),r$l.beginRenderTarget(r$i+1),r$S.clearColor(1,1,1,1),r$S.clear(16640),r$S.viewport(0,0,r$M.width,r$M.height),r$Q.camera=r$T=r$l.getLightCamera(r$i),r$T._prepareCameraToRender(),r$T._prepareCameraViewProject(r$T.viewMatrix,r$T.projectionMatrix),r$Q._projectionViewMatrix=r$l._lightVPMatrix[r$i+1],(r$d=r$l._shadowQuenes[r$i])._preRender(r$Q),r$d._renderShadow(r$Q,!1),r$l.endRenderTarget(r$i+1);else r$M=r$l.getRenderTarget(1),r$l.beginRenderTarget(1),r$S.clearColor(1,1,1,1),r$S.clear(16640),r$S.viewport(0,0,r$M.width,r$M.height),r$Q.camera=r$T=r$l.getLightCamera(0),r$T._prepareCameraToRender(),r$T._prepareCameraViewProject(r$T.viewMatrix,r$T.projectionMatrix),r$Q._projectionViewMatrix=r$l._lightVPMatrix[0],(r$d=r$l._shadowQuenes[0])._preRender(r$Q),r$d._renderShadow(r$Q,!0),r$l.endRenderTarget(1);this.removeShaderDefine(r$JQ.SHADERDEFINE_CAST_SHADOW)},r$S.addTreeNode=function(r$S){this.treeRoot.addTreeNode(r$S)},r$S.removeTreeNode=function(r$S){this.treeSize&&r$S._treeNode&&r$S._treeNode.removeObject(r$S)},r$S.setlightmaps=function(r$S){this._lightmaps=r$S;for(var r$Q=0,r$e=this._renderableSprite3Ds.length;r$Q<r$e;r$Q++)this._renderableSprite3Ds[r$Q]._render._applyLightMapParams()},r$S.getlightmaps=function(){return this._lightmaps},r$S.addChildAt=function(r$S,r$Q){if(!(r$S instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(r$S&&r$S.__className));if(!r$S||this.destroyed||r$S===this)return r$S;if(r$S.zOrder&&this._set$P("hasZorder",!0),0<=r$Q&&r$Q<=this._childs.length){if(r$S._parent===this){var r$e=this.getChildIndex(r$S);this._childs.splice(r$e,1),this._childs.splice(r$Q,0,r$S),this.conchModel&&(this.conchModel.removeChild(r$S.conchModel),this.conchModel.addChildAt(r$S.conchModel,r$Q)),this._childChanged()}else r$S.parent&&r$S.parent.removeChild(r$S),this._childs===r$R.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(r$Q,0,r$S),this.conchModel&&this.conchModel.addChildAt(r$S.conchModel,r$Q),(r$S.parent=this)._addChild3D(r$S);return r$S}throw new Error("appendChildAt:The index is out of bounds")},r$S.addChild=function(r$S){if(!(r$S instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!r$S||this.destroyed||r$S===this)return r$S;if(r$S.zOrder&&this._set$P("hasZorder",!0),r$S._parent===this){var r$Q=this.getChildIndex(r$S);r$Q!==this._childs.length-1&&(this._childs.splice(r$Q,1),this._childs.push(r$S),this.conchModel&&(this.conchModel.removeChild(r$S.conchModel),this.conchModel.addChildAt(r$S.conchModel,this._childs.length-1)),this._childChanged())}else r$S.parent&&r$S.parent.removeChild(r$S),this._childs===r$R.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(r$S),this.conchModel&&this.conchModel.addChildAt(r$S.conchModel,this._childs.length-1),(r$S.parent=this)._childChanged(),this._addChild3D(r$S);return r$S},r$S.removeChildAt=function(r$S){var r$Q=this.getChildAt(r$S);return r$Q&&(this._removeChild3D(r$Q),this._childs.splice(r$S,1),this.conchModel&&this.conchModel.removeChild(r$Q.conchModel),r$Q.parent=null),r$Q},r$S.removeChildren=function(r$S,r$Q){if(void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=2147483647),this._childs&&0<this._childs.length){var r$e=this._childs;if(0===r$S&&r$d<=r$Q){var r$l=r$e;this._childs=r$R.ARRAY_EMPTY}else r$l=r$e.splice(r$S,r$Q-r$S);for(var r$M=0,r$d=r$l.length;r$M<r$d;r$M++)this._removeChild3D(r$l[r$M]),r$l[r$M].parent=null,this.conchModel&&this.conchModel.removeChild(r$l[r$M].conchModel)}return this},r$S.addFrustumCullingObject=function(r$S){this.treeRoot?this.addTreeNode(r$S):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(r$S):this._cullingRenders[this._cullingRendersLength]=r$S,r$S._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},r$S.removeFrustumCullingObject=function(r$S){if(this.treeRoot)this.removeTreeNode(r$S);else{this._cullingRendersLength--;var r$Q=r$S._indexInSceneFrustumCullingObjects;if(r$Q!==this._cullingRendersLength){var r$e=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[r$Q]=r$e)._indexInSceneFrustumCullingObjects=r$Q,r$S._indexInSceneFrustumCullingObjects=-1}}},r$S.getRenderQueue=function(r$S){return r$S<3e3?this._quenes[1]||(this._quenes[1]=new r$N(this)):this._quenes[2]||(this._quenes[2]=new r$N(this))},r$S.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new r$N(this)},r$S.addShaderDefine=function(r$S){this._shaderDefineValue|=r$S},r$S.removeShaderDefine=function(r$S){this._shaderDefineValue&=~r$S},r$S.addScript=function(r$S){return this._addComponent(r$S)},r$S.getScriptByType=function(r$S,r$Q){return void 0===r$Q&&(r$Q=0),this._getComponentByType(r$S,r$Q)},r$S.getScriptsByType=function(r$S,r$Q){this._getComponentsByType(r$S,r$Q)},r$S.getScriptByIndex=function(r$S){return this._getComponentByIndex(r$S)},r$S.removeScriptByType=function(r$S,r$Q){void 0===r$Q&&(r$Q=0),this._removeComponentByType(r$S,r$Q)},r$S.removeScriptsByType=function(r$S){this._removeComponentByType(r$S)},r$S.removeAllScript=function(){this._removeAllComponent()},r$S.render=function(r$S,r$Q,r$e){(r$j._context.ctx._renderKey=0)<this._childs.length&&r$S.addRenderObject(this)},r$S.renderSubmit=function(){var r$S=r$k.mainContext,r$Q=this._renderState;this._set3DRenderConfig(r$S),this._prepareSceneToRender(this._renderState);var r$e,r$l=0,r$M=0;if(r$GQ.debugMode||r$K.debugMode)for(r$l=0,r$M=this._cameraPool.length;r$l<r$M;r$l++)r$e=this._cameraPool[r$l],r$GQ._debugPhasorSprite.begin(1,r$e),r$e.activeInHierarchy&&r$e._renderCamera(r$S,r$Q,this),r$GQ._debugPhasorSprite.end();else for(r$l=0,r$M=this._cameraPool.length;r$l<r$M;r$l++)(r$e=this._cameraPool[r$l]).activeInHierarchy&&r$e._renderCamera(r$S,r$Q,this);return this._set2DRenderConfig(r$S),1},r$S.onAsynLoaded=function(r$S,r$Q,r$e){var r$l=r$Q[0];if("Scene"!==r$l.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var r$M=r$Q[1];r$cQ._createNodeByJson(this,r$l,this,r$M),this.event("hierarchyloaded",[this]),this.__loaded=!0},r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),this.destroyed||(r$Q.prototype.destroy.call(this,r$S),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,r$G.clearRes(this.url),this.loaded||r$GQ._cancelLoadByUrl(this.url))},r$S.getRenderType=function(){return 0},r$S.releaseRender=function(){},r$S._addComponent=function(r$S){var r$Q,r$e=this._componentsMap.indexOf(r$S);if(-1===r$e)r$Q=[],this._componentsMap.push(r$S),this._typeComponentsIndices.push(r$Q);else if(r$Q=this._typeComponentsIndices[r$e],this._components[r$Q[0]].isSingleton)throw new Error("无法单实例创建"+r$S+"组件，"+r$S+"组件已存在！");var r$l=r$M.getInstance(r$S);r$Q.push(this._components.length),this._components.push(r$l);return r$l._initialize(this),r$l},r$S._removeComponent=function(r$S,r$Q){var r$e=this._typeComponentsIndices[r$S],r$l=r$e[r$Q],r$M=this._components[r$l];this._components.splice(r$l,1),r$e.splice(r$Q,1),0===r$e.length&&(this._typeComponentsIndices.splice(r$S,1),this._componentsMap.splice(r$S,1));for(var r$d=0,r$T=this._componentsMap.length;r$d<r$T;r$d++)for(var r$U=(r$e=this._typeComponentsIndices[r$d]).length-1;0<=r$U;r$U--){var r$i=r$e[r$U];if(!(r$l<r$i))break;r$e[r$U]=--r$i}r$M._destroy()},r$S._getComponentByType=function(r$S,r$Q){void 0===r$Q&&(r$Q=0);var r$e=this._componentsMap.indexOf(r$S);return-1===r$e?null:this._components[this._typeComponentsIndices[r$e][r$Q]]},r$S._getComponentsByType=function(r$S,r$Q){var r$e=this._componentsMap.indexOf(r$S);if(-1!==r$e){var r$l=this._typeComponentsIndices[r$e],r$M=r$l.length;r$Q.length=r$M;for(var r$d=0;r$d<r$M;r$d++)r$Q[r$d]=this._components[r$l[r$d]]}else r$Q.length=0},r$S._getComponentByIndex=function(r$S){return this._components[r$S]},r$S._removeComponentByType=function(r$S,r$Q){void 0===r$Q&&(r$Q=0);var r$e=this._componentsMap.indexOf(r$S);-1!==r$e&&this._removeComponent(r$e,r$Q)},r$S._removeComponentsByType=function(r$S){var r$Q=this._componentsMap.indexOf(r$S);if(-1!==r$Q)for(var r$e=this._typeComponentsIndices[r$Q],r$l=0,r$M=r$e.length;r$l<r$M;r$e.length<r$M?r$M--:r$l++)this._removeComponent(r$Q,r$l)},r$S._removeAllComponent=function(){for(var r$S=0,r$Q=this._componentsMap.length;r$S<r$Q;this._componentsMap.length<r$Q?r$Q--:r$S++)this._removeComponentsByType(this._componentsMap[r$S])},r$S._updateComponents=function(r$S){for(var r$Q=0,r$e=this._components.length;r$Q<r$e;r$Q++){var r$l=this._components[r$Q];!r$l.started&&(r$l._start(r$S),r$l.started=!0),r$l.enable&&r$l._update(r$S)}},r$S._lateUpdateComponents=function(r$S){for(var r$Q=0;r$Q<this._components.length;r$Q++){var r$e=this._components[r$Q];!r$e.started&&(r$e._start(r$S),r$e.started=!0),r$e.enable&&r$e._lateUpdate(r$S)}},r$S._preRenderUpdateComponents=function(r$S){for(var r$Q=0;r$Q<this._components.length;r$Q++){var r$e=this._components[r$Q];!r$e.started&&(r$e._start(r$S),r$e.started=!0),r$e.enable&&r$e._preRenderUpdate(r$S)}},r$S._postRenderUpdateComponents=function(r$S){for(var r$Q=0;r$Q<this._components.length;r$Q++){var r$e=this._components[r$Q];!r$e.started&&(r$e._start(r$S),r$e.started=!0),r$e.enable&&r$e._postRenderUpdate(r$S)}},r$L(0,r$S,"_loaded",null,function(r$S){this.__loaded=r$S}),r$L(0,r$S,"fogColor",function(){return this._fogColor},function(r$S){this._fogColor=r$S,this._shaderValues.setValue(0,r$S.elements)}),r$L(0,r$S,"enableFog",function(){return this._enableFog},function(r$S){this._enableFog!==r$S&&((this._enableFog=r$S)?(this.addShaderDefine(r$HQ.SHADERDEFINE_FOG),this.removeShaderDefine(r$HQ.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(r$HQ.SHADERDEFINE_FOG))}),r$L(0,r$S,"url",function(){return this._url}),r$L(0,r$S,"loaded",function(){return this.__loaded}),r$L(0,r$S,"enableDepthFog",function(){return this._enableDepthFog},function(r$S){this._enableDepthFog!=r$S&&((this._enableDepthFog=r$S)?(this.addShaderDefine(r$HQ.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(r$HQ.SHADERDEFINE_FOG)):this.removeShaderDefine(r$HQ.SAHDERDEFINE_DEPTHFOG))}),r$L(0,r$S,"fogStart",function(){return this._fogStart},function(r$S){this._fogStart=r$S,this._shaderValues.setValue(1,r$S)}),r$L(0,r$S,"fogRange",function(){return this._fogRange},function(r$S){this._fogRange=r$S,this._shaderValues.setValue(2,r$S)}),r$L(0,r$S,"ambientColor",function(){return this._ambientColor},function(r$S){this._ambientColor=r$S,this._shaderValues.setValue(21,r$S.elements)}),r$L(0,r$S,"scene",function(){return this}),r$L(0,r$S,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),r$l._sortScenes=function(r$S,r$Q){if(r$S.parent!==r$D.stage||r$Q.parent!==r$D.stage)return r$S.parent!==r$D.stage&&r$Q.parent!==r$D.stage?r$l._sortScenes(r$S.parent,r$Q.parent):r$S.parent===r$D.stage?-1:1;var r$e=r$D.stage._childs;return r$e.indexOf(r$S)-r$e.indexOf(r$Q)},r$l.load=function(r$S){return r$D.loader.create(r$S,null,null,r$l)},r$l.FOGCOLOR=0,r$l.FOGSTART=1,r$l.FOGRANGE=2,r$l.LIGHTDIRECTION=3,r$l.LIGHTDIRCOLOR=4,r$l.POINTLIGHTPOS=5,r$l.POINTLIGHTRANGE=6,r$l.POINTLIGHTATTENUATION=7,r$l.POINTLIGHTCOLOR=8,r$l.SPOTLIGHTPOS=9,r$l.SPOTLIGHTDIRECTION=10,r$l.SPOTLIGHTSPOT=11,r$l.SPOTLIGHTRANGE=12,r$l.SPOTLIGHTATTENUATION=13,r$l.SPOTLIGHTCOLOR=14,r$l.SHADOWDISTANCE=15,r$l.SHADOWLIGHTVIEWPROJECT=16,r$l.SHADOWMAPPCFOFFSET=17,r$l.SHADOWMAPTEXTURE1=18,r$l.SHADOWMAPTEXTURE2=19,r$l.SHADOWMAPTEXTURE3=20,r$l.AMBIENTCOLOR=21,r$l.TIME=22,r$l}(r$O),r$$Q=function(r$S){function r$Q(r$S){r$Q.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new r$SQ,this._shaderValues=new r$pQ,this._colliders=[],this._id=++r$Q._uniqueIDCounter,this._transform=new r$BQ(this),this.name=r$S||"Sprite3D-"+r$Q._nameNumberCounter++,this.layer=r$b.currentCreationLayer,this.active=!0}r$J(r$Q,"laya.d3.core.Sprite3D",r$EQ);var r$e=r$Q.prototype;return r$D.imps(r$e,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),r$e._setUrl=function(r$S){this._url=r$S},r$e._getGroup=function(){return this._group},r$e._setGroup=function(r$S){this._group=r$S},r$e._addChild3D=function(r$S){r$S.transform.parent=this.transform,this._hierarchyAnimator&&(!r$S._hierarchyAnimator&&r$S._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(r$S,!0,[r$S.name])),this._scene&&(r$S._setBelongScene(this._scene),this._activeInHierarchy&&r$S._active&&r$S._activeHierarchy())},r$e._removeChild3D=function(r$S){r$S.transform.parent=null,this._scene&&(this._activeInHierarchy&&r$S._active&&r$S._inActiveHierarchy(),r$S._setUnBelongScene()),this._hierarchyAnimator&&(r$S._hierarchyAnimator==this._hierarchyAnimator&&r$S._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(r$S,!1,[r$S.name]))},r$e._parseBaseCustomProps=function(r$S){var r$Q=this.transform.localPosition;r$S.translate?(r$Q.fromArray(r$S.translate),r$Q.x*=100,r$Q.y*=100,r$Q.z*=100):r$Q.elements.fill(0),this.transform.localPosition=r$Q;var r$e=this.transform.localRotation;r$S.rotation?r$e.fromArray(r$S.rotation):r$e.fromArray([0,0,0,-1]),this.transform.localRotation=r$e;var r$l=this.transform.localScale;r$S.scale?r$l.fromArray(r$S.scale):r$l.elements.fill(1),this.transform.localScale=r$l;var r$M=r$S.layer;null!=r$M&&(this.layer=r$b.getLayerByNumber(r$M))},r$e._parseCustomComponent=function(r$S,r$Q,r$e){for(var r$l in r$e){var r$M=r$e[r$l];switch(r$l){case"Animator":var r$d=this.addComponent(Animator);if(r$M.avatarPath)r$d.avatar=r$G.getRes(r$Q[r$M.avatarPath]);else{var r$T=r$M.avatar;if(r$T){r$d.avatar=r$G.getRes(r$Q[r$T.path]);var r$U=r$T.linkSprites;r$U&&r$S.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[r$d,r$U])}}for(var r$i=r$M.clipPaths,r$R=r$i.length,r$o=0;r$o<r$R;r$o++)r$d.addClip(r$G.getRes(r$Q[r$i[r$o]]));r$d.clip=r$G.getRes(r$Q[r$i[0]]);var r$Y=r$M.playOnWake;void 0!==r$Y&&(r$d.playOnWake=r$Y);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var r$p=this.addComponent(SphereCollider);r$p.isTrigger=r$M.isTrigger;var r$J=r$p.center;r$J.fromArray(r$M.center),r$p.center=r$J,r$p.radius=r$M.radius;break;case"BoxCollider":var r$L=this.addComponent(BoxCollider);r$L.isTrigger=r$M.isTrigger,r$L.center.fromArray(r$M.center);var r$j=r$L.size;r$j.fromArray(r$M.size),r$L.size=r$j;break;case"MeshCollider":this.addComponent(MeshCollider)}}},r$e._onRootNodeHierarchyLoaded=function(r$S,r$Q){for(var r$e in r$Q){for(var r$l=this,r$M=r$Q[r$e],r$d=0,r$T=r$M.length;r$d<r$T;r$d++){var r$U=r$M[r$d];if(""===r$U)break;if(!(r$l=r$l.getChildByName(r$U)))break}r$l&&r$S.linkSprite3DToAvatarNode(r$e,r$l)}},r$e._setHierarchyAnimator=function(r$S,r$Q){this._changeHierarchyAnimator(r$S);for(var r$e=0,r$l=this._childs.length;r$e<r$l;r$e++){var r$M=this._childs[r$e];r$M._hierarchyAnimator==r$Q&&r$M._setHierarchyAnimator(r$S,r$Q)}},r$e._clearHierarchyAnimator=function(r$S,r$Q){this._changeHierarchyAnimator(r$Q);for(var r$e=0,r$l=this._childs.length;r$e<r$l;r$e++){var r$M=this._childs[r$e];r$M._hierarchyAnimator==r$S&&r$M._clearHierarchyAnimator(r$S,r$Q)}},r$e._getAnimatorToLinkSprite3D=function(r$S,r$Q,r$e){var r$l=this.getComponentByType(Animator);if(r$l&&(r$l.avatar?r$l.avatar._version||r$S._setAnimatorToLinkAvatar(r$l,r$Q):r$S._setAnimatorToLinkSprite3DNoAvatar(r$l,r$Q,r$e)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){r$e.unshift(this._parent.name);var r$M=this._parent;r$M._hierarchyAnimator&&r$M._getAnimatorToLinkSprite3D(r$S,r$Q,r$e)}},r$e._setAnimatorToLinkSprite3DNoAvatar=function(r$S,r$Q,r$e){var r$l=0,r$M=0;for(r$l=0,r$M=r$S.getClipCount();r$l<r$M;r$l++)r$S._handleSpriteOwnersBySprite(r$l,r$Q,r$e,this);for(r$l=0,r$M=this._childs.length;r$l<r$M;r$l++){var r$d=this._childs[r$l],r$T=r$e.length;r$e.push(r$d.name),r$d._setAnimatorToLinkSprite3DNoAvatar(r$S,r$Q,r$e),r$e.splice(r$T,1)}},r$e._changeHierarchyAnimator=function(r$S){this._hierarchyAnimator=r$S},r$e._isLinkSpriteToAnimationNode=function(r$S,r$Q,r$e){var r$l=r$S._avatarNodes.indexOf(r$Q),r$M=r$S._cacheSpriteToNodesMap;if(r$e)this._transform.dummy=r$Q.transform,r$S._cacheNodesToSpriteMap[r$l]=r$M.length,r$M.push(r$l);else{this._transform.dummy=null;var r$d=r$S._cacheNodesToSpriteMap[r$l];r$S._cacheNodesToSpriteMap[r$l]=null,r$M.splice(r$d,1)}},r$e._setBelongScene=function(r$S){this._scene=r$S;for(var r$Q=0,r$e=this._childs.length;r$Q<r$e;r$Q++)this._childs[r$Q]._setBelongScene(r$S)},r$e._setUnBelongScene=function(){this._scene=null;for(var r$S=0,r$Q=this._childs.length;r$S<r$Q;r$S++)this._childs[r$S]._setUnBelongScene()},r$e._activeHierarchy=function(){var r$S=0,r$Q=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),r$S=0,r$Q=this._colliders.length;r$S<r$Q;r$S++)this._layer._addCollider(this._colliders[r$S]);for(this.event("activeinhierarchychanged",!0),r$S=0,r$Q=this._childs.length;r$S<r$Q;r$S++){var r$e=this._childs[r$S];r$e._active&&r$e._activeHierarchy()}},r$e._inActiveHierarchy=function(){var r$S=0,r$Q=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),r$S=0,r$Q=this._colliders.length;r$S<r$Q;r$S++){var r$e=this._colliders[r$S];r$e._clearCollsionMap(),this._layer._removeCollider(r$e)}for(this.event("activeinhierarchychanged",!1),r$S=0,r$Q=this._childs.length;r$S<r$Q;r$S++){var r$l=this._childs[r$S];r$l._active&&r$l._inActiveHierarchy()}},r$e.addComponent=function(r$S){var r$Q,r$e=this._componentsMap.indexOf(r$S);if(-1===r$e)r$Q=[],this._componentsMap.push(r$S),this._typeComponentsIndices.push(r$Q);else if(r$Q=this._typeComponentsIndices[r$e],this._components[r$Q[0]].isSingleton)throw new Error("无法单实例创建"+r$S+"组件，"+r$S+"组件已存在！");var r$l=r$M.getInstance(r$S);return r$Q.push(this._components.length),this._components.push(r$l),r$l instanceof laya.d3.component.Script&&this._scripts.push(r$l),r$l._initialize(this),r$l},r$e._removeComponent=function(r$S,r$Q){var r$e,r$l=0,r$M=this._typeComponentsIndices[r$S],r$d=r$M[r$Q],r$T=this._components[r$d];for(r$T instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(r$T),1),r$M.splice(r$Q,1),0===r$M.length&&(this._typeComponentsIndices.splice(r$S,1),this._componentsMap.splice(r$S,1)),r$l=0,r$e=this._componentsMap.length;r$l<r$e;r$l++)for(var r$U=(r$M=this._typeComponentsIndices[r$l]).length-1;0<=r$U;r$U--){var r$i=r$M[r$U];if(!(r$d<r$i))break;r$M[r$U]=--r$i}r$T._destroy()},r$e._clearSelfRenderObjects=function(){},r$e._addSelfRenderObjects=function(){},r$e._parseCustomProps=function(r$S,r$Q,r$e,r$l){},r$e._updateChilds=function(r$S){var r$Q=this._childs.length;if(0!==r$Q)for(var r$e=0;r$e<r$Q;++r$e)this._childs[r$e]._update(r$S)},r$e._getSortID=function(r$S,r$Q){return 1e3*r$Q.id+r$S._getVertexBuffer().vertexDeclaration.id},r$e._update=function(r$S){(r$S.owner=this)._activeInHierarchy&&(this._updateComponents(r$S),this._lateUpdateComponents(r$S),r$H.spriteCount++,this._childs.length&&this._updateChilds(r$S))},r$e.getProjectionViewWorldMatrix=function(r$S){return r$SQ.multiply(r$S,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},r$e.loadHierarchy=function(r$S){this.addChild(laya.d3.core.Sprite3D.load(r$S))},r$e.addChildAt=function(r$S,r$Q){if(!(r$S instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!r$S||this.destroyed||r$S===this)return r$S;if(r$S.zOrder&&this._set$P("hasZorder",!0),0<=r$Q&&r$Q<=this._childs.length){if(r$S._parent===this){var r$e=this.getChildIndex(r$S);this._childs.splice(r$e,1),this._childs.splice(r$Q,0,r$S),this.conchModel&&(this.conchModel.removeChild(r$S.conchModel),this.conchModel.addChildAt(r$S.conchModel,r$Q)),this._childChanged()}else r$S.parent&&r$S.parent.removeChild(r$S),this._childs===r$R.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(r$Q,0,r$S),this.conchModel&&this.conchModel.addChildAt(r$S.conchModel,r$Q),(r$S.parent=this)._addChild3D(r$S);return r$S}throw new Error("appendChildAt:The index is out of bounds")},r$e.addChild=function(r$S){if(!(r$S instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!r$S||this.destroyed||r$S===this)return r$S;if(r$S.zOrder&&this._set$P("hasZorder",!0),r$S._parent===this){var r$Q=this.getChildIndex(r$S);r$Q!==this._childs.length-1&&(this._childs.splice(r$Q,1),this._childs.push(r$S),this.conchModel&&(this.conchModel.removeChild(r$S.conchModel),this.conchModel.addChildAt(r$S.conchModel,this._childs.length-1)),this._childChanged())}else r$S.parent&&r$S.parent.removeChild(r$S),this._childs===r$R.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(r$S),this.conchModel&&this.conchModel.addChildAt(r$S.conchModel,this._childs.length-1),(r$S.parent=this)._childChanged(),this._addChild3D(r$S);return r$S},r$e.removeChildAt=function(r$S){var r$Q=this.getChildAt(r$S);return r$Q&&(this._removeChild3D(r$Q),this._childs.splice(r$S,1),this.conchModel&&this.conchModel.removeChild(r$Q.conchModel),r$Q.parent=null),r$Q},r$e.removeChildren=function(r$S,r$Q){if(void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=2147483647),this._childs&&0<this._childs.length){var r$e=this._childs;if(0===r$S&&r$d<=r$Q){var r$l=r$e;this._childs=r$R.ARRAY_EMPTY}else r$l=r$e.splice(r$S,r$Q-r$S);for(var r$M=0,r$d=r$l.length;r$M<r$d;r$M++)this._removeChild3D(r$l[r$M]),r$l[r$M].parent=null,this.conchModel&&this.conchModel.removeChild(r$l[r$M].conchModel)}return this},r$e.onAsynLoaded=function(r$S,r$Q,r$e){var r$l=r$Q[0];if("Sprite3D"!==r$l.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var r$M=r$Q[1];r$cQ._createNodeByJson(this,r$l,this,r$M),this.event("hierarchyloaded",[this]),this.__loaded=!0},r$e.cloneTo=function(r$S){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var r$Q=r$S;r$Q.name=this.name,r$Q._destroyed=this._destroyed,r$Q.timer=this.timer,r$Q._$P=this._$P,r$Q.active=this._active;var r$e=r$Q.transform.localPosition;this.transform.localPosition.cloneTo(r$e),r$Q.transform.localPosition=r$e;var r$l=r$Q.transform.localRotation;this.transform.localRotation.cloneTo(r$l),r$Q.transform.localRotation=r$l;var r$M=r$Q.transform.localScale;this.transform.localScale.cloneTo(r$M),r$Q.transform.localScale=r$M,r$Q.isStatic=this.isStatic;var r$d=0,r$T=0;for(r$d=0,r$T=this._componentsMap.length;r$d<r$T;r$d++){var r$U=r$Q.addComponent(this._componentsMap[r$d]);this._components[r$d]._cloneTo(r$U)}for(r$d=0,r$T=this._childs.length;r$d<r$T;r$d++)r$Q.addChild(this._childs[r$d].clone());var r$i=r$Q.getComponentByType(Animator);if(r$i){var r$R=r$i._linkSpritesData;if(r$R)for(var r$o in r$R){for(var r$Y=r$R[r$o],r$p=r$Q,r$J=0,r$L=r$Y.length;r$J<r$L&&(r$p=r$p.getChildByName(r$Y[r$J]));r$J++);if(r$p){var r$j=r$i._avatarNodeMap[r$o];r$p._isLinkSpriteToAnimationNode(r$i,r$j,!0)}}}},r$e.clone=function(){var r$S=new this.constructor;return this.cloneTo(r$S),r$S},r$e.destroy=function(r$S){if(void 0===r$S&&(r$S=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,r$S);var r$Q,r$e=0;for(r$e=0,r$Q=this._components.length;r$e<r$Q;r$e++)this._components[r$e]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,r$G.clearRes(this.url),this.loaded||r$GQ._cancelLoadByUrl(this.url)}},r$e._handleSpriteToAvatar=function(r$S,r$Q){r$S._avatarNodes;var r$e=r$S._avatarNodeMap[this.name];r$e&&r$e.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(r$S,r$e,r$Q)},r$e._setAnimatorToLinkAvatar=function(r$S,r$Q){this._handleSpriteToAvatar(r$S,r$Q);for(var r$e=0,r$l=this._childs.length;r$e<r$l;r$e++){this._childs[r$e]._setAnimatorToLinkAvatar(r$S,r$Q)}},r$L(0,r$e,"activeInHierarchy",function(){return this._activeInHierarchy}),r$L(0,r$e,"_loaded",null,function(r$S){this.__loaded=r$S}),r$L(0,r$e,"active",function(){return this._active},function(r$S){this._active!==r$S&&(this._active=r$S,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(r$S?this._activeHierarchy():this._inActiveHierarchy()))}),r$L(0,r$e,"componentsCount",function(){return this._components.length}),r$L(0,r$e,"loaded",function(){return this.__loaded}),r$L(0,r$e,"id",function(){return this._id}),r$L(0,r$e,"url",function(){return this._url}),r$L(0,r$e,"layer",function(){return this._layer},function(r$S){if(this._layer!==r$S){if(!r$S)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var r$Q=0,r$e=this._colliders.length;if(this._layer)for(r$Q=0;r$Q<r$e;r$Q++)this._layer._removeCollider(this._colliders[r$Q]);for(r$Q=0;r$Q<r$e;r$Q++)r$S._addCollider(this._colliders[r$Q])}this._layer=r$S,this.event("layerchanged",r$S)}}),r$L(0,r$e,"scene",function(){return this._scene}),r$L(0,r$e,"transform",function(){return this._transform}),r$Q.instantiate=function(r$S,r$Q,r$e,r$l,r$M){void 0===r$e&&(r$e=!0);var r$d=r$S.clone();r$Q&&r$Q.addChild(r$d);var r$T=r$d.transform;if(r$e){var r$U=r$T.worldMatrix;r$S.transform.worldMatrix.cloneTo(r$U),r$T.worldMatrix=r$U}else r$l&&(r$T.position=r$l),r$M&&(r$T.rotation=r$M);return r$d},r$Q.load=function(r$S){return r$D.loader.create(r$S,null,null,r$Q)},r$Q.WORLDMATRIX=0,r$Q.MVPMATRIX=1,r$Q._uniqueIDCounter=0,r$Q._nameNumberCounter=0,r$Q}(),r$nQ=function(r$S){function r$o(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],r$o.__super.call(this),!r$S||!r$Q)throw"Shader Error";this._id=++r$o._count,this._vs=r$S,this._ps=r$Q,this._attributeMap=r$e,this._sceneUniformMap=r$l,this._cameraUniformMap=r$M,this._spriteUniformMap=r$d,this._materialUniformMap=r$T,this._renderElementUniformMap=r$U,this._precompile=r$i,this._define=r$R,this._precompile&&r$o.extCompileObj&&r$o.extCompileFunc?r$o.extCompileFunc.call(r$o.extCompileObj,r$S,r$Q,r$R):this.recreateResource()}r$J(r$o,"laya.d3.shader.Shader3D",r$e);var r$Q=r$o.prototype;return r$Q.recreateResource=function(){r$h.now();this._compile(),this.completeCreate(),this.memorySize=0},r$Q.disposeResource=function(){r$k.mainContext.deleteShader(this._vshader),r$k.mainContext.deleteShader(this._pshader),r$k.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},r$Q._compile=function(){if(!r$k.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var r$S=[this._vs,this._ps],r$Q=r$k.mainContext;if(this._program=r$Q.createProgram(),this._vshader=r$o._createShader(r$Q,r$S[0],35633),this._pshader=r$o._createShader(r$Q,r$S[1],35632),r$Q.attachShader(this._program,this._vshader),r$Q.attachShader(this._program,this._pshader),r$Q.linkProgram(this._program),!r$j.isConchApp&&r$HQ.debugMode&&!r$Q.getProgramParameter(this._program,35714))throw r$Q.getProgramInfoLog(this._program);var r$e,r$l=0,r$M=0,r$d=0;for(r$d=r$j.isConchApp?r$Q.getProgramParameterEx(this._vs,this._ps,"",35721):r$Q.getProgramParameter(this._program,35721),r$l=0;r$l<r$d;r$l++){var r$T=null;r$e={vartype:"attribute",ivartype:0,attrib:r$T=r$j.isConchApp?r$Q.getActiveAttribEx(this._vs,this._ps,"",r$l):r$Q.getActiveAttrib(this._program,r$l),location:r$Q.getAttribLocation(this._program,r$T.name),name:r$T.name,type:r$T.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(r$e)}var r$U=0;for(r$U=r$j.isConchApp?r$Q.getProgramParameterEx(this._vs,this._ps,"",35718):r$Q.getProgramParameter(this._program,35718),r$l=0;r$l<r$U;r$l++){var r$i=null;r$i=r$j.isConchApp?r$Q.getActiveUniformEx(this._vs,this._ps,"",r$l):r$Q.getActiveUniform(this._program,r$l),0<(r$e={vartype:"uniform",ivartype:1,attrib:r$T,location:r$Q.getUniformLocation(this._program,r$i.name),name:r$i.name,type:r$i.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(r$e.name=r$e.name.substr(0,r$e.name.length-3),r$e.isArray=!0,r$e.location=r$Q.getUniformLocation(this._program,r$e.name)),this._uniformParams.push(r$e)}for(r$l=0,r$M=this._attributeParams.length;r$l<r$M;r$l++)(r$e=this._attributeParams[r$l]).indexOfParams=r$l,r$e.index=1,r$e.value=[r$e.location,null],r$e.codename=r$e.name,r$e.name=null!=this._attributeMap[r$e.codename]?this._attributeMap[r$e.codename]:r$e.codename,this._attributeParamsMap.push(r$e.name),this._attributeParamsMap.push(r$e),r$e._this=this,r$e.uploadedValue=[],r$e.fun=this._attribute;for(r$l=0,r$M=this._uniformParams.length;r$l<r$M;r$l++)switch((r$e=this._uniformParams[r$l]).indexOfParams=r$l,r$e.index=1,r$e.value=[r$e.location,null],r$e.codename=r$e.name,null!=this._sceneUniformMap[r$e.codename]?(r$e.name=this._sceneUniformMap[r$e.codename],this._sceneUniformParamsMap.push(r$e.name),this._sceneUniformParamsMap.push(r$e)):null!=this._cameraUniformMap[r$e.codename]?(r$e.name=this._cameraUniformMap[r$e.codename],this._cameraUniformParamsMap.push(r$e.name),this._cameraUniformParamsMap.push(r$e)):null!=this._spriteUniformMap[r$e.codename]?(r$e.name=this._spriteUniformMap[r$e.codename],this._spriteUniformParamsMap.push(r$e.name),this._spriteUniformParamsMap.push(r$e)):null!=this._materialUniformMap[r$e.codename]?(r$e.name=this._materialUniformMap[r$e.codename],this._materialUniformParamsMap.push(r$e.name),this._materialUniformParamsMap.push(r$e)):null!=this._renderElementUniformMap[r$e.codename]?(r$e.name=this._renderElementUniformMap[r$e.codename],this._renderElementUniformParamsMap.push(r$e.name),this._renderElementUniformParamsMap.push(r$e)):console.log("Shader:can't find uinform name:"+r$e.codename+" in shader file."),r$e._this=this,r$e.uploadedValue=[],r$e.type){case 5124:r$e.fun=r$e.isArray?this._uniform1iv:this._uniform1i;break;case 5126:r$e.fun=r$e.isArray?this._uniform1fv:this._uniform1f;break;case 35664:r$e.fun=r$e.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:r$e.fun=r$e.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:r$e.fun=r$e.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:r$e.fun=this._uniform_sampler2D;break;case 35680:r$e.fun=this._uniform_samplerCube;break;case 35676:r$e.fun=this._uniformMatrix4fv;break;case 35670:r$e.fun=this._uniform1i;break;case 35674:r$e.fun=this._uinformMatrix2fv;break;case 35675:r$e.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},r$Q._attribute=function(r$S,r$Q){var r$e=r$k.mainContext,r$l=r$U._enableAtributes,r$M=r$S.location;return r$l[r$M]||r$e.enableVertexAttribArray(r$M),r$e.vertexAttribPointer(r$M,r$Q[0],r$Q[1],r$Q[2],r$Q[3],r$Q[4]),r$l[r$M]=r$U._bindVertexBuffer,1},r$Q._uniform1f=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q?(r$k.mainContext.uniform1f(r$S.location,r$e[0]=r$Q),1):0},r$Q._uniform1fv=function(r$S,r$Q){if(r$Q.length<4){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]||r$e[2]!==r$Q[2]||r$e[3]!==r$Q[3]?(r$k.mainContext.uniform1fv(r$S.location,r$Q),r$e[0]=r$Q[0],r$e[1]=r$Q[1],r$e[2]=r$Q[2],r$e[3]=r$Q[3],1):0}return r$k.mainContext.uniform1fv(r$S.location,r$Q),1},r$Q._uniform_vec2=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]?(r$k.mainContext.uniform2f(r$S.location,r$e[0]=r$Q[0],r$e[1]=r$Q[1]),1):0},r$Q._uniform_vec2v=function(r$S,r$Q){if(r$Q.length<2){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]||r$e[2]!==r$Q[2]||r$e[3]!==r$Q[3]?(r$k.mainContext.uniform2fv(r$S.location,r$Q),r$e[0]=r$Q[0],r$e[1]=r$Q[1],r$e[2]=r$Q[2],r$e[3]=r$Q[3],1):0}return r$k.mainContext.uniform2fv(r$S.location,r$Q),1},r$Q._uniform_vec3=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]||r$e[2]!==r$Q[2]?(r$k.mainContext.uniform3f(r$S.location,r$e[0]=r$Q[0],r$e[1]=r$Q[1],r$e[2]=r$Q[2]),1):0},r$Q._uniform_vec3v=function(r$S,r$Q){return r$k.mainContext.uniform3fv(r$S.location,r$Q),1},r$Q._uniform_vec4=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]||r$e[2]!==r$Q[2]||r$e[3]!==r$Q[3]?(r$k.mainContext.uniform4f(r$S.location,r$e[0]=r$Q[0],r$e[1]=r$Q[1],r$e[2]=r$Q[2],r$e[3]=r$Q[3]),1):0},r$Q._uniform_vec4v=function(r$S,r$Q){return r$k.mainContext.uniform4fv(r$S.location,r$Q),1},r$Q._uniformMatrix2fv=function(r$S,r$Q){return r$k.mainContext.uniformMatrix2fv(r$S.location,!1,r$Q),1},r$Q._uniformMatrix3fv=function(r$S,r$Q){return r$k.mainContext.uniformMatrix3fv(r$S.location,!1,r$Q),1},r$Q._uniformMatrix4fv=function(r$S,r$Q){return r$k.mainContext.uniformMatrix4fv(r$S.location,!1,r$Q),1},r$Q._uinformMatrix2fv=function(r$S,r$Q){return r$k.mainContext.uniformMatrix2fv(r$S.location,!1,r$Q),1},r$Q._uinformMatrix3fv=function(r$S,r$Q){return r$k.mainContext.uniformMatrix3fv(r$S.location,!1,r$Q),1},r$Q._uniform1i=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q?(r$k.mainContext.uniform1i(r$S.location,r$e[0]=r$Q),1):0},r$Q._uniform1iv=function(r$S,r$Q){return r$k.mainContext.uniform1iv(r$S.location,r$Q),1},r$Q._uniform_ivec2=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]?(r$k.mainContext.uniform2i(r$S.location,r$e[0]=r$Q[0],r$e[1]=r$Q[1]),1):0},r$Q._uniform_ivec2v=function(r$S,r$Q){return r$k.mainContext.uniform2iv(r$S.location,r$Q),1},r$Q._uniform_vec3i=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]||r$e[2]!==r$Q[2]?(r$k.mainContext.uniform3i(r$S.location,r$e[0]=r$Q[0],r$e[1]=r$Q[1],r$e[2]=r$Q[2]),1):0},r$Q._uniform_vec3vi=function(r$S,r$Q){return r$k.mainContext.uniform3iv(r$S.location,r$Q),1},r$Q._uniform_vec4i=function(r$S,r$Q){var r$e=r$S.uploadedValue;return r$e[0]!==r$Q[0]||r$e[1]!==r$Q[1]||r$e[2]!==r$Q[2]||r$e[3]!==r$Q[3]?(r$k.mainContext.uniform4i(r$S.location,r$e[0]=r$Q[0],r$e[1]=r$Q[1],r$e[2]=r$Q[2],r$e[3]=r$Q[3]),1):0},r$Q._uniform_vec4vi=function(r$S,r$Q){return r$k.mainContext.uniform4iv(r$S.location,r$Q),1},r$Q._uniform_sampler2D=function(r$S,r$Q){var r$e=r$Q.source||r$Q.defaulteTexture.source,r$l=r$k.mainContext,r$M=r$S.uploadedValue;if(null!=r$M[0])return r$l.activeTexture(r$o._TEXTURES[r$M[0]]),r$e&&r$X.bindTexture(r$l,3553,r$e),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return r$M[0]=this._curActTexIndex,r$l.uniform1i(r$S.location,this._curActTexIndex),r$l.activeTexture(r$o._TEXTURES[this._curActTexIndex]),r$e&&r$X.bindTexture(r$l,3553,r$e),this._curActTexIndex++,1},r$Q._uniform_samplerCube=function(r$S,r$Q){var r$e=r$Q.source||r$Q.defaulteTexture.source,r$l=r$k.mainContext,r$M=r$S.uploadedValue;if(null!=r$M[0])return r$l.activeTexture(r$o._TEXTURES[r$M[0]]),r$e?r$X.bindTexture(r$l,34067,r$e):r$X.bindTexture(r$l,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return r$M[0]=this._curActTexIndex,r$l.uniform1i(r$S.location,this._curActTexIndex),r$l.activeTexture(r$o._TEXTURES[this._curActTexIndex]),r$e?r$X.bindTexture(r$l,34067,r$e):r$X.bindTexture(r$l,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},r$Q._noSetValue=function(r$S){console.log("no....:"+r$S.name)},r$Q.bind=function(){return r$e.activeShader=this,(r$e.bindShader=this).activeResource(),r$X.UseProgram(this._program)},r$Q.uploadAttributes=function(r$S,r$Q){for(var r$e,r$l,r$M=0,r$d=0,r$T=this._attributeParamsMap.length;r$d<r$T;r$d+=2)r$l=this._attributeParamsMap[r$d+1],null!=(r$e=r$S[this._attributeParamsMap[r$d]])&&(r$Q&&r$Q[r$l.name]&&r$Q[r$l.name].bind(),r$M+=r$l.fun.call(this,r$l,r$e));r$H.shaderCall+=r$M},r$Q.uploadAttributesX=function(r$S,r$Q){for(var r$e,r$l,r$M=0,r$d=0,r$T=this._attributeParamsMap.length;r$d<r$T;r$d+=2)r$l=this._attributeParamsMap[r$d+1],null!=(r$e=r$S[this._attributeParamsMap[r$d]])&&(r$Q._bind(),r$M+=r$l.fun.call(this,r$l,r$e));r$H.shaderCall+=r$M},r$Q.uploadSceneUniforms=function(r$S){for(var r$Q,r$e,r$l=0,r$M=0,r$d=this._sceneUniformParamsMap.length;r$M<r$d;r$M+=2)r$e=this._sceneUniformParamsMap[r$M+1],null!=(r$Q=r$S[this._sceneUniformParamsMap[r$M]])&&(r$l+=r$e.fun.call(this,r$e,r$Q));r$H.shaderCall+=r$l},r$Q.uploadCameraUniforms=function(r$S){for(var r$Q,r$e,r$l=0,r$M=0,r$d=this._cameraUniformParamsMap.length;r$M<r$d;r$M+=2)r$e=this._cameraUniformParamsMap[r$M+1],null!=(r$Q=r$S[this._cameraUniformParamsMap[r$M]])&&(r$l+=r$e.fun.call(this,r$e,r$Q));r$H.shaderCall+=r$l},r$Q.uploadSpriteUniforms=function(r$S){for(var r$Q,r$e,r$l=0,r$M=0,r$d=this._spriteUniformParamsMap.length;r$M<r$d;r$M+=2)r$e=this._spriteUniformParamsMap[r$M+1],null!=(r$Q=r$S[this._spriteUniformParamsMap[r$M]])&&(r$l+=r$e.fun.call(this,r$e,r$Q));r$H.shaderCall+=r$l},r$Q.uploadMaterialUniforms=function(r$S){for(var r$Q,r$e,r$l=0,r$M=0,r$d=this._materialUniformParamsMap.length;r$M<r$d;r$M+=2)r$e=this._materialUniformParamsMap[r$M+1],null!=(r$Q=r$S[this._materialUniformParamsMap[r$M]])&&(r$l+=r$e.fun.call(this,r$e,r$Q));r$H.shaderCall+=r$l},r$Q.uploadRenderElementUniforms=function(r$S){for(var r$Q,r$e,r$l=0,r$M=0,r$d=this._renderElementUniformParamsMap.length;r$M<r$d;r$M+=2)r$e=this._renderElementUniformParamsMap[r$M+1],null!=(r$Q=r$S[this._renderElementUniformParamsMap[r$M]])&&(r$l+=r$e.fun.call(this,r$e,r$Q));r$H.shaderCall+=r$l},r$o.create=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){return new r$o(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R)},r$o.addInclude=function(r$S,r$Q){r$A.addInclude(r$S,r$Q)},r$o._createShader=function(r$S,r$Q,r$e){var r$l=r$S.createShader(r$e);if(r$S.shaderSource(r$l,r$Q),r$S.compileShader(r$l),r$HQ.debugMode&&!r$S.getShaderParameter(r$l,35713))throw r$S.getShaderInfoLog(r$l);return r$l},r$o.PERIOD_RENDERELEMENT=0,r$o.PERIOD_MATERIAL=1,r$o.PERIOD_SPRITE=2,r$o.PERIOD_CAMERA=3,r$o.PERIOD_SCENE=4,r$o._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],r$o._count=0,r$o._preCompile=!1,r$o.extCompileFunc=null,r$o.extCompileObj=null,r$Y(r$o,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new r$g}]),r$o}(),r$PQ=function(r$U){function r$i(){this._transformUV=null,r$i.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new r$TQ(.6,.6,.6)),this._setColor(10,new r$TQ(1,1,1)),this._setColor(11,new r$UQ(1,1,1,8)),this._setColor(12,new r$TQ(1,1,1)),this._setColor(7,new r$UQ(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new r$UQ(1,1,0,0)),this.renderMode=1}r$J(r$i,"laya.d3.core.material.StandardMaterial",r$U);var r$S=r$i.prototype;return r$S.disableLight=function(){this._addDisablePublicShaderDefine(r$HQ.SHADERDEFINE_POINTLIGHT|r$HQ.SHADERDEFINE_SPOTLIGHT|r$HQ.SHADERDEFINE_DIRECTIONLIGHT)},r$S.disableFog=function(){this._addDisablePublicShaderDefine(r$HQ.SHADERDEFINE_FOG)},r$S.onAsynLoaded=function(r$S,r$Q,r$e){var r$l=r$Q[0];if(r$l.version)r$U.prototype.onAsynLoaded.call(this,r$S,r$Q,r$e);else{var r$M=r$Q[1],r$d=r$l.props;for(var r$T in r$d)this[r$T]=r$d[r$T];r$i._parseStandardMaterial(r$M,this,r$l),this._endLoaded()}},r$S.cloneTo=function(r$S){r$U.prototype.cloneTo.call(this,r$S);var r$Q=r$S;this._transformUV&&(r$Q._transformUV=this._transformUV.clone())},r$L(0,r$S,"ambientColor",function(){return this._getColor(9)},function(r$S){this._setColor(9,r$S)}),r$L(0,r$S,"ambientTexture",function(){return this._getTexture(5)},function(r$S){r$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,r$S)}),r$L(0,r$S,"renderMode",null,function(r$S){switch(r$S){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(r$i.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(r$S)}),r$L(0,r$S,"reflectColor",function(){return this._getColor(12)},function(r$S){this._setColor(12,r$S)}),r$L(0,r$S,"tilingOffset",function(){return this._getColor(15)},function(r$S){if(r$S){var r$Q=r$S.elements;1!=r$Q[0]||1!=r$Q[1]||0!=r$Q[2]||0!=r$Q[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,r$S)}),r$L(0,r$S,"albedo",function(){return this._getColor(7)},function(r$S){this._setColor(7,r$S)}),r$L(0,r$S,"diffuseColor",function(){return this._getColor(10)},function(r$S){this._setColor(10,r$S)}),r$L(0,r$S,"albedoColor",function(){return this._getColor(7)},function(r$S){this._setColor(7,r$S)}),r$L(0,r$S,"specularColor",function(){return this._getColor(11)},function(r$S){this._setColor(11,r$S)}),r$L(0,r$S,"diffuseTexture",function(){return this._getTexture(1)},function(r$S){r$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,r$S)}),r$L(0,r$S,"normalTexture",function(){return this._getTexture(2)},function(r$S){r$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,r$S)}),r$L(0,r$S,"specularTexture",function(){return this._getTexture(3)},function(r$S){r$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,r$S)}),r$L(0,r$S,"emissiveTexture",function(){return this._getTexture(4)},function(r$S){r$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,r$S)}),r$L(0,r$S,"reflectTexture",function(){return this._getTexture(6)},function(r$S){r$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,r$S)}),r$L(0,r$S,"transformUV",function(){return this._transformUV},function(r$S){this._transformUV=r$S,this._setMatrix4x4(13,r$S.matrix),r$S?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,r$S.matrix.elements,0)}),r$i.__init__=function(){r$i.SHADERDEFINE_DIFFUSEMAP=r$i.shaderDefines.registerDefine("DIFFUSEMAP"),r$i.SHADERDEFINE_NORMALMAP=r$i.shaderDefines.registerDefine("NORMALMAP"),r$i.SHADERDEFINE_SPECULARMAP=r$i.shaderDefines.registerDefine("SPECULARMAP"),r$i.SHADERDEFINE_EMISSIVEMAP=r$i.shaderDefines.registerDefine("EMISSIVEMAP"),r$i.SHADERDEFINE_AMBIENTMAP=r$i.shaderDefines.registerDefine("AMBIENTMAP"),r$i.SHADERDEFINE_REFLECTMAP=r$i.shaderDefines.registerDefine("REFLECTMAP"),r$i.SHADERDEFINE_UVTRANSFORM=r$i.shaderDefines.registerDefine("UVTRANSFORM"),r$i.SHADERDEFINE_TILINGOFFSET=r$i.shaderDefines.registerDefine("TILINGOFFSET"),r$i.SHADERDEFINE_ADDTIVEFOG=r$i.shaderDefines.registerDefine("ADDTIVEFOG")},r$i.load=function(r$S){return r$D.loader.create(r$S,null,null,r$i)},r$i._parseStandardMaterial=function(r$S,r$Q,r$e){var r$l=r$e.customProps,r$M=r$l.ambientColor;r$Q.ambientColor=new r$TQ(r$M[0],r$M[1],r$M[2]);var r$d=r$l.diffuseColor;r$Q.diffuseColor=new r$TQ(r$d[0],r$d[1],r$d[2]);var r$T=r$l.specularColor;r$Q.specularColor=new r$UQ(r$T[0],r$T[1],r$T[2],r$T[3]);var r$U=r$l.reflectColor;r$Q.reflectColor=new r$TQ(r$U[0],r$U[1],r$U[2]);var r$i=r$l.albedoColor;r$i&&(r$Q.albedo=new r$UQ(r$i[0],r$i[1],r$i[2],r$i[3]));var r$R=r$l.diffuseTexture.texture2D;r$R&&(r$Q.diffuseTexture=r$G.getRes(r$S[r$R]));var r$o=r$l.normalTexture.texture2D;r$o&&(r$Q.normalTexture=r$G.getRes(r$S[r$o]));var r$Y=r$l.specularTexture.texture2D;r$Y&&(r$Q.specularTexture=r$G.getRes(r$S[r$Y]));var r$p=r$l.emissiveTexture.texture2D;r$p&&(r$Q.emissiveTexture=r$G.getRes(r$S[r$p]));var r$J=r$l.ambientTexture.texture2D;r$J&&(r$Q.ambientTexture=r$G.getRes(r$S[r$J]));var r$L=r$l.reflectTexture.texture2D;r$L&&(r$Q.reflectTexture=r$G.getRes(r$S[r$L]))},r$i.RENDERMODE_OPAQUE=1,r$i.RENDERMODE_OPAQUEDOUBLEFACE=2,r$i.RENDERMODE_CUTOUT=3,r$i.RENDERMODE_CUTOUTDOUBLEFACE=4,r$i.RENDERMODE_TRANSPARENT=13,r$i.RENDERMODE_TRANSPARENTDOUBLEFACE=14,r$i.RENDERMODE_ADDTIVE=15,r$i.RENDERMODE_ADDTIVEDOUBLEFACE=16,r$i.RENDERMODE_DEPTHREAD_TRANSPARENT=5,r$i.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,r$i.RENDERMODE_DEPTHREAD_ADDTIVE=7,r$i.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,r$i.RENDERMODE_NONDEPTH_TRANSPARENT=9,r$i.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,r$i.RENDERMODE_NONDEPTH_ADDTIVE=11,r$i.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,r$i.SHADERDEFINE_DIFFUSEMAP=0,r$i.SHADERDEFINE_NORMALMAP=0,r$i.SHADERDEFINE_SPECULARMAP=0,r$i.SHADERDEFINE_EMISSIVEMAP=0,r$i.SHADERDEFINE_AMBIENTMAP=0,r$i.SHADERDEFINE_REFLECTMAP=0,r$i.SHADERDEFINE_UVTRANSFORM=0,r$i.SHADERDEFINE_TILINGOFFSET=0,r$i.SHADERDEFINE_ADDTIVEFOG=0,r$i.DIFFUSETEXTURE=1,r$i.NORMALTEXTURE=2,r$i.SPECULARTEXTURE=3,r$i.EMISSIVETEXTURE=4,r$i.AMBIENTTEXTURE=5,r$i.REFLECTTEXTURE=6,r$i.ALBEDO=7,r$i.UVANIAGE=8,r$i.MATERIALAMBIENT=9,r$i.MATERIALDIFFUSE=10,r$i.MATERIALSPECULAR=11,r$i.MATERIALREFLECT=12,r$i.UVMATRIX=13,r$i.UVAGE=14,r$i.TILINGOFFSET=15,r$Y(r$i,["defaultMaterial",function(){var r$S=new r$i;return r$S.lock=!0,this.defaultMaterial=r$S},"shaderDefines",function(){return this.shaderDefines=new r$oQ(r$tQ.shaderDefines)}]),r$i}(r$tQ),r$aQ=function(r$S){function r$T(r$S,r$Q,r$e,r$l,r$M){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===r$e&&(r$e=35044),void 0===r$l&&(r$l=!1),r$T.__super.call(this),this._indexType=r$S,this._indexCount=r$Q,this._bufferUsage=r$e,this._bufferType=34963,this._canRead=r$l;var r$d;if("ushort"==r$S)this._indexTypeByteCount=2;else{if("ubyte"!=r$S)throw new Error("unidentification index type.");this._indexTypeByteCount=1}r$d=this._indexTypeByteCount*r$Q,this._byteLength=r$d,this._bind(),r$U._gl.bufferData(this._bufferType,r$d,this._bufferUsage),this.uri=r$M,r$l?("ushort"==r$S?this._buffer=new Uint16Array(r$Q):"ubyte"==r$S&&(this._buffer=new Uint8Array(r$Q)),this.memorySize=2*r$d):this.memorySize=r$d}r$J(r$T,"laya.d3.graphics.IndexBuffer3D",r$S);var r$Q=r$T.prototype;return r$Q.setData=function(r$S,r$Q,r$e,r$l){void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=4294967295);var r$M=0;if("ushort"==this._indexType?(r$M=2,0===r$e&&4294967295===r$l||(r$S=new Uint16Array(r$S.buffer,r$e*r$M,r$l))):"ubyte"==this._indexType&&(r$M=1,0===r$e&&4294967295===r$l||(r$S=new Uint8Array(r$S.buffer,r$e*r$M,r$l))),this._bind(),r$U._gl.bufferSubData(this._bufferType,r$Q*r$M,r$S),this._canRead)if(0!==r$Q||0!==r$e||4294967295!==r$l){var r$d=this._buffer.length-r$Q;r$d<r$l&&(r$l=r$d);for(var r$T=0;r$T<r$l;r$T++)this._buffer[r$Q+r$T]=r$S[r$T]}else this._buffer=r$S},r$Q.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},r$Q.disposeResource=function(){r$S.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},r$L(0,r$Q,"indexType",function(){return this._indexType}),r$L(0,r$Q,"indexTypeByteCount",function(){return this._indexTypeByteCount}),r$L(0,r$Q,"indexCount",function(){return this._indexCount}),r$L(0,r$Q,"canRead",function(){return this._canRead}),r$T.INDEXTYPE_UBYTE="ubyte",r$T.INDEXTYPE_USHORT="ushort",r$T.create=function(r$S,r$Q,r$e,r$l,r$M){return void 0===r$e&&(r$e=35044),void 0===r$l&&(r$l=!1),new r$T(r$S,r$Q,r$e,r$l,r$M)},r$T}(r$U),r$fQ=function(r$d){function r$T(r$S,r$Q,r$e,r$l,r$M){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===r$l&&(r$l=!1),r$T.__super.call(this),this._vertexDeclaration=r$S,this._vertexCount=r$Q,this._bufferUsage=r$e,this._bufferType=34962,this._canRead=r$l,this.uri=r$M,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*r$Q,this._bind(),r$U._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),r$l&&(this._buffer=new Float32Array(this._byteLength/4))}r$J(r$T,"laya.d3.graphics.VertexBuffer3D",r$d);var r$S=r$T.prototype;return r$S.bindWithIndexBuffer=function(r$S){r$S&&r$S._bind(),this._bind()},r$S.setData=function(r$S,r$Q,r$e,r$l){if(void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=4294967295),0===r$e&&4294967295===r$l||(r$S=new Float32Array(r$S.buffer,4*r$e,r$l)),this._bind(),r$U._gl.bufferSubData(this._bufferType,4*r$Q,r$S),this._canRead)if(0!==r$Q||0!==r$e||4294967295!==r$l){var r$M=this._buffer.length-r$Q;r$M<r$l&&(r$l=r$M);for(var r$d=0;r$d<r$l;r$d++)this._buffer[r$Q+r$d]=r$S[r$d]}else this._buffer=r$S},r$S.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},r$S.disposeResource=function(){for(var r$S=r$k.mainContext,r$Q=this._vertexDeclaration.getVertexElements(),r$e=r$U._enableAtributes,r$l=0,r$M=r$Q.length;r$l<r$M;r$l++)r$e[r$l]===this._glBuffer&&(r$S.disableVertexAttribArray(r$l),r$e[r$l]=null);r$d.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},r$L(0,r$S,"vertexDeclaration",function(){return this._vertexDeclaration}),r$L(0,r$S,"vertexCount",function(){return this._vertexCount}),r$L(0,r$S,"canRead",function(){return this._canRead}),r$T.create=function(r$S,r$Q,r$e,r$l,r$M){return void 0===r$e&&(r$e=35044),void 0===r$l&&(r$l=!1),new r$T(r$S,r$Q,r$e,r$l,r$M)},r$T}(r$U),r$wQ=function(r$S){function r$A(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,r$A.__super.call(this),this._type=3553}r$J(r$A,"laya.d3.resource.DataTexture2D",r$kQ);var r$Q=r$A.prototype;return r$Q.genDebugMipmaps=function(){var r$S=[];return r$S.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),r$S.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),r$S.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),r$S.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),r$S.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),r$S.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),r$S.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),r$S.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),r$S.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),r$S.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),r$S},r$Q._onTextureLoaded=function(r$S){},r$Q._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var r$S=r$k.mainContext,r$Q=this._source=r$S.createTexture(),r$e=this._width,r$l=this._height,r$M=r$X.curBindTexTarget,r$d=r$X.curBindTexValue,r$T=!1;if(r$X.bindTexture(r$S,this._type,r$Q),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var r$U=0;r$S.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var r$i=0;r$i<this._mipmaps.length;r$i++){if(this._mipmaps[r$i].byteLength!=r$R*r$o*4)throw"mipmap size error  level:"+r$i;r$S.texSubImage2D(this._type,0,r$A.simLodRect[r$U++],r$A.simLodRect[r$U++],r$A.simLodRect[r$U++],r$A.simLodRect[r$U++],6408,5121,new Uint8Array(this._mipmaps[r$i]))}this.minFifter=9729,this.magFifter=9729}else{var r$R=this._width,r$o=this._height;for(r$U=0,r$S.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),r$i=0;r$i<this._mipmaps.length;r$i++){if(this._mipmaps[r$i].byteLength!=r$R*r$o*4)throw"mipmap size error  level:"+r$i;r$S.texImage2D(this._type,r$i,6408,r$R,r$o,0,6408,5121,new Uint8Array(this._mipmaps[r$i])),(r$R/=2)<1&&(r$R=1),(r$o/=2)<1&&(r$o=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&r$S.pixelStorei(r$S.UNPACK_ALIGNMENT,1),r$S.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var r$Y=0,r$p=!1,r$J=!1;this._buffer.byteLength==4*r$e*r$l?(r$Y=6408,r$p=!0):this._buffer.byteLength==3*r$e*r$l?(r$Y=6407,r$J=!0):r$Y=this._format,r$p||r$J?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),r$J&&r$S.pixelStorei(r$S.UNPACK_ALIGNMENT,1),r$S.texImage2D(this._type,0,r$Y,r$e,r$l,0,r$Y,5121,this._buffer)):r$S&&r$Y==r$S.ALPHA?(r$S.texImage2D(3553,0,r$Y,r$e,r$l,0,r$Y,r$S.UNSIGNED_BYTE,this._buffer),r$T=!0):0!=r$Y&&(r$S.compressedTexImage2D(3553,0,r$Y,r$e,r$l,0,this._buffer),r$T=!0)}var r$L=this._minFifter,r$j=this._magFifter,r$c=0==this._wrapModeU?10497:33071,r$G=0==this._wrapModeV?10497:33071,r$z=r$v.isPOT(r$e,r$l);r$z?(this._mipmap||this._mipmaps?-1!==r$L||(r$L=9987):-1!==r$L||(r$L=9729),-1!==r$j||(r$j=9729),r$S.texParameteri(this._type,10241,r$L),r$S.texParameteri(this._type,10240,r$j),r$S.texParameteri(this._type,10242,r$c),r$S.texParameteri(this._type,10243,r$G),this._mipmap&&r$S.generateMipmap(this._type)):(-1!==r$L||(r$L=9729),-1!==r$j||(r$j=9729),r$S.texParameteri(this._type,10241,r$L),r$S.texParameteri(this._type,10240,r$j),r$S.texParameteri(this._type,10242,33071),r$S.texParameteri(this._type,10243,33071)),r$M&&r$d&&r$X.bindTexture(r$S,r$M,r$d),this.memorySize=r$T?this._buffer.length:r$z?r$e*r$l*4*(1+1/3):r$e*r$l*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},r$Q.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},r$Q.onAsynLoaded=function(r$S,r$Q,r$e){var r$l;r$e&&(r$l=r$e[0].call(this,r$Q)),r$l&&(this._width=r$l.width,this._height=r$l.height,this._buffer=r$l.data),this._src=r$S,this._size=new r$jQ(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},r$Q.getPixels=function(){return new Uint8Array(this._buffer)},r$Q.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(r$k.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},r$L(0,r$Q,"src",function(){return this._src}),r$A.create=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){if(void 0===r$l&&(r$l=9729),void 0===r$M&&(r$M=9729),void 0===r$d&&(r$d=!0),!r$S||r$S.byteLength<r$Q*r$e*4)throw"DataTexture2D create error";var r$U=new r$A;return r$U.uri=r$T,r$U._buffer=r$S,r$U._width=r$Q,r$U._height=r$e,r$U._mipmap=r$d,r$U._magFifter=r$l,r$U._minFifter=r$M,r$U._size=new r$jQ(r$U._width,r$U._height),r$U._conchTexture?alert("怎么给runtime传递datatexture数据"):r$U.activeResource(),r$U},r$A.load=function(r$S,r$Q,r$e,r$l,r$M){if(void 0===r$Q&&(r$Q=0),void 0===r$e&&(r$e=0),void 0===r$l&&(r$l=9729),void 0===r$M&&(r$M=9729),"mipmaps"===r$I.getFileExtension(r$S)){var r$d=r$D.loader.create(r$S,null,null,r$A,[function(r$S){this._mipmaps=[];var r$Q=new Uint32Array(r$S);this._width=r$Q[0];var r$e=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,r$e=1024),this._width!=r$e)throw"现在只支持512x256的环境贴图。当前的是"+r$Q[0];this._height=r$Q[1];for(var r$l=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,r$M=this._height,r$d=8;;){var r$T=r$l*r$M*4;if(r$d+r$T>r$S.byteLength)throw"load mipmaps data size error ";var r$U=new Uint8Array(r$S,r$d,r$T);if(this._mipmaps.push(r$U),r$d+=r$T,1==r$l&&1==r$M)break;(r$l/=2)<1&&(r$l=1),(r$M/=2)<1&&(r$M=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){r$d.simLodInfo=new Float32Array(40);for(var r$T=0;r$T<r$d.simLodInfo.length;)r$d.simLodInfo[r$T]=(r$A.simLodRect[r$T]+.5)/1024,r$T++,r$d.simLodInfo[r$T]=(r$A.simLodRect[r$T]+.5)/256,r$T++,r$d.simLodInfo[r$T]=Math.max(r$A.simLodRect[r$T]-1,.1)/1024,r$T++,r$d.simLodInfo[r$T]=Math.max(r$A.simLodRect[r$T]-1.5,.1)/256,r$T++}return r$d}if("number"==typeof r$Q)return r$D.loader.create(r$S,null,null,r$A,[function(r$S){return this._width=r$Q,this._height=r$e,this._buffer=r$S,null}]);if("function"==typeof r$Q)return r$D.loader.create(r$S,null,null,r$A,[r$Q]);throw new Error("unknown params.")},r$A.lodasatlas=!1,r$Y(r$A,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),r$A}(),r$uQ=function(r$S){function r$Q(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,r$Q.__super.call(this)}r$J(r$Q,"laya.d3.resource.models.PrimitiveMesh",r$XQ);var r$e=r$Q.prototype;return r$D.imps(r$e,{"laya.d3.core.render.IRenderable":!0}),r$e._getVertexBuffer=function(r$S){return void 0===r$S&&(r$S=0),0===r$S?this._vertexBuffer:null},r$e._getVertexBuffers=function(){return null},r$e._getIndexBuffer=function(){return this._indexBuffer},r$e._getPositions=function(){var r$S,r$Q=[],r$e=this._vertexBuffer.vertexDeclaration.getVertexElements(),r$l=0;for(r$l=0;r$l<r$e.length;r$l++){var r$M=r$e[r$l];if("vector3"===r$M.elementFormat&&0===r$M.elementUsage){r$S=r$M;break}}var r$d=this._vertexBuffer.getData();for(r$l=0;r$l<r$d.length;r$l+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var r$T=r$l+r$S.offset/4,r$U=new r$TQ(r$d[r$T+0],r$d[r$T+1],r$d[r$T+2]);r$Q.push(r$U)}return r$Q},r$e.getRenderElement=function(r$S){return this},r$e.getRenderElementsCount=function(){return 1},r$e.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},r$e._beforeRender=function(r$S){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},r$e._render=function(r$S){r$k.mainContext.drawElements(4,this._numberIndices,5123,0),r$H.drawCall++,r$H.trianglesFaces+=this._numberIndices/3},r$L(0,r$e,"_vertexBufferCount",function(){return 1}),r$L(0,r$e,"triangleCount",function(){return this._indexBuffer.indexCount/3}),r$Q}(),r$rQ=function(r$S){function r$Q(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,r$Q.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}r$J(r$Q,"laya.d3.resource.models.Mesh",r$XQ);var r$e=r$Q.prototype;return r$e._getPositions=function(){var r$S,r$Q,r$e,r$l,r$M,r$d=[],r$T=0,r$U=0,r$i=0;if(0!==this._vertexBuffers.length){var r$R=this._vertexBuffers.length;for(r$T=0;r$T<r$R;r$T++){for(r$e=(r$S=this._vertexBuffers[r$T]).vertexDeclaration.getVertexElements(),r$U=0;r$U<r$e.length;r$U++)if("vector3"===(r$l=r$e[r$U]).elementFormat&&0===r$l.elementUsage){r$Q=r$l;break}for(r$M=r$S.getData(),r$U=0;r$U<r$M.length;r$U+=r$S.vertexDeclaration.vertexStride/4)r$i=r$U+r$Q.offset/4,r$d.push(new r$TQ(r$M[r$i+0],r$M[r$i+1],r$M[r$i+2]))}}else{var r$o=this._subMeshes.length;for(r$T=0;r$T<r$o;r$T++){for(r$e=(r$S=this._subMeshes[r$T]._getVertexBuffer()).vertexDeclaration.getVertexElements(),r$U=0;r$U<r$e.length;r$U++)if("vector3"===(r$l=r$e[r$U]).elementFormat&&0===r$l.elementUsage){r$Q=r$l;break}for(r$M=r$S.getData(),r$U=0;r$U<r$M.length;r$U+=r$S.vertexDeclaration.vertexStride/4)r$i=r$U+r$Q.offset/4,r$d.push(new r$TQ(r$M[r$i+0],r$M[r$i+1],r$M[r$i+2]))}}return r$d},r$e._setSubMeshes=function(r$S){this._subMeshes=r$S,this._subMeshCount=r$S.length;for(var r$Q=0;r$Q<this._subMeshCount;r$Q++)r$S[r$Q]._indexInMesh=r$Q;this._positions=this._getPositions(),this._generateBoundingObject()},r$e.onAsynLoaded=function(r$S,r$Q,r$e){var r$l=r$Q[0],r$M=r$Q[1];r$CS.read(r$l,this,this._materials,this._subMeshes,r$M),this.completeCreate(),this._endLoaded()},r$e.getSubMesh=function(r$S){return this._subMeshes[r$S]},r$e.getSubMeshCount=function(){return this._subMeshes.length},r$e.getRenderElementsCount=function(){return this._subMeshes.length},r$e.getRenderElement=function(r$S){return this._subMeshes[r$S]},r$e.disposeResource=function(){for(var r$S=0;r$S<this._subMeshes.length;r$S++)this._subMeshes[r$S].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},r$L(0,r$e,"materials",function(){return this._materials.slice()}),r$L(0,r$e,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),r$Q.load=function(r$S){return r$D.loader.create(r$S,null,null,r$Q)},r$Q}(),r$WQ=(function(r$S){function r$R(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===r$e&&(r$e=6408),void 0===r$l&&(r$l=5121),void 0===r$M&&(r$M=33189),void 0===r$d&&(r$d=!1),void 0===r$T&&(r$T=!1),void 0===r$U&&(r$U=-1),void 0===r$i&&(r$i=-1),r$R.__super.call(this),this._type=3553,this._width=r$S,this._height=r$Q,this._size=new r$jQ(r$S,r$Q),this._surfaceFormat=r$e,this._surfaceType=r$l,this._depthStencilFormat=r$M,r$j.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=r$d,this._repeat=r$T,this._minFifter=r$U,this._magFifter=r$i,this.activeResource(),this._alreadyResolved=!0}r$J(r$R,"laya.d3.resource.RenderTexture",r$kQ);var r$Q=r$R.prototype;r$Q.recreateResource=function(){var r$S=r$k.mainContext;this._frameBuffer=r$S.createFramebuffer(),this._source=r$S.createTexture();var r$Q=r$X.curBindTexTarget,r$e=r$X.curBindTexValue;r$X.bindTexture(r$S,this._type,this._source),r$S.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var r$l=this._minFifter,r$M=this._magFifter,r$d=this._repeat?10497:33071;if(r$v.isPOT(this._width,this._height)?(this._mipmap?-1!==r$l||(r$l=9987):-1!==r$l||(r$l=9729),-1!==r$M||(r$M=9729),r$S.texParameteri(this._type,10241,r$l),r$S.texParameteri(this._type,10240,r$M),r$S.texParameteri(this._type,10242,r$d),r$S.texParameteri(this._type,10243,r$d),this._mipmap&&r$S.generateMipmap(this._type)):(-1!==r$l||(r$l=9729),-1!==r$M||(r$M=9729),r$S.texParameteri(this._type,10241,r$l),r$S.texParameteri(this._type,10240,r$M),r$S.texParameteri(this._type,10242,33071),r$S.texParameteri(this._type,10243,33071)),r$Q&&r$e&&r$X.bindTexture(r$S,r$Q,r$e),r$S.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=r$S.createRenderbuffer(),r$S.bindRenderbuffer(36161,this._depthStencilBuffer),r$S.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),r$S.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:r$S.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:r$S.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:r$S.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}r$S.framebufferTexture2D(36160,36064,3553,this._source,0),r$S.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},r$Q.start=function(){r$k.mainContext.bindFramebuffer(36160,this.frameBuffer),(r$R._currentRenderTarget=this)._alreadyResolved=!1},r$Q.end=function(){r$k.mainContext.bindFramebuffer(36160,null),r$R._currentRenderTarget=null,this._alreadyResolved=!0},r$Q.getData=function(r$S,r$Q,r$e,r$l){var r$M=r$k.mainContext;if(r$M.bindFramebuffer(36160,this._frameBuffer),!(36053===r$M.checkFramebufferStatus(36160)))return r$M.bindFramebuffer(36160,null),null;var r$d=new Uint8Array(this._width*this._height*4);return r$M.readPixels(r$S,r$Q,r$e,r$l,this._surfaceFormat,this._surfaceType,r$d),r$M.bindFramebuffer(36160,null),r$d},r$Q.disposeResource=function(){if(this._frameBuffer){var r$S=r$k.mainContext;r$S.deleteTexture(this._source),r$S.deleteFramebuffer(this._frameBuffer),r$S.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},r$L(0,r$Q,"surfaceFormat",function(){return this._surfaceFormat}),r$L(0,r$Q,"surfaceType",function(){return this._surfaceType}),r$L(0,r$Q,"depthStencilFormat",function(){return this._depthStencilFormat}),r$L(0,r$Q,"source",function(){return this._alreadyResolved?r$D.superGet(r$kQ,this,"source"):null}),r$L(0,r$Q,"depthStencilBuffer",function(){return this._depthStencilBuffer}),r$L(0,r$Q,"frameBuffer",function(){return this._frameBuffer}),r$R._currentRenderTarget=null}(),function(r$S){function r$Q(r$S){this._color=null,this._pixels=null,r$Q.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new r$jQ(this.width,this.height),this._color=r$S,this._pixels=new Uint8Array([255*r$S.x,255*r$S.y,255*r$S.z,255*r$S.w]),this.uri="SolidColorTexture2D_"+this.id}r$J(r$Q,"laya.d3.resource.SolidColorTexture2D",r$kQ);var r$e=r$Q.prototype;return r$e._createWebGlTexture=function(){var r$S=r$k.mainContext,r$Q=this._source=r$S.createTexture(),r$e=this._width,r$l=this._height,r$M=r$X.curBindTexTarget,r$d=r$X.curBindTexValue;r$X.bindTexture(r$S,this._type,r$Q),r$S.texImage2D(this._type,0,6408,r$e,r$l,0,6408,5121,this._pixels);var r$T=this._minFifter,r$U=this._magFifter,r$i=this._repeat?10497:33071,r$R=r$v.isPOT(r$e,r$l);r$R?(this._mipmap?-1!==r$T||(r$T=9987):-1!==r$T||(r$T=9729),-1!==r$U||(r$U=9729),r$S.texParameteri(this._type,10241,r$T),r$S.texParameteri(this._type,10240,r$U),r$S.texParameteri(this._type,10242,r$i),r$S.texParameteri(this._type,10243,r$i),this._mipmap&&r$S.generateMipmap(this._type)):(-1!==r$T||(r$T=9729),-1!==r$U||(r$U=9729),r$S.texParameteri(this._type,10241,r$T),r$S.texParameteri(this._type,10240,r$U),r$S.texParameteri(this._type,10242,33071),r$S.texParameteri(this._type,10243,33071)),r$M&&r$d&&r$X.bindTexture(r$S,r$M,r$d),this.memorySize=r$R?r$e*r$l*4*(1+1/3):r$e*r$l*4},r$e.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},r$e.disposeResource=function(){this._source&&(r$k.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},r$Y(r$Q,["magentaTexture",function(){var r$S=new r$Q(new r$UQ(1,0,1,1));return r$S.lock=!0,this.magentaTexture=r$S},"grayTexture",function(){var r$S=new r$Q(new r$UQ(.5,.5,.5,1));return r$S.lock=!0,this.grayTexture=r$S}]),r$Q}()),r$xQ=function(r$S){function r$M(r$S,r$Q,r$e,r$l){this._canRead=!1,this._image=null,this._pixels=null,void 0===r$S&&(r$S=!1),void 0===r$Q&&(r$Q=!0),void 0===r$e&&(r$e=6408),void 0===r$l&&(r$l=!0),r$M.__super.call(this),this._type=3553,this._repeat=r$Q,this._canRead=r$S,this._format=r$e,this._mipmap=r$l}r$J(r$M,"laya.d3.resource.Texture2D",r$kQ);var r$Q=r$M.prototype;return r$Q._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var r$S=r$k.mainContext,r$Q=this._source=r$S.createTexture(),r$e=this._width,r$l=this._height,r$M=r$X.curBindTexTarget,r$d=r$X.curBindTexValue;switch(r$X.bindTexture(r$S,this._type,r$Q),this._format){case 6407:case 6408:this._canRead?r$S.texImage2D(this._type,0,this._format,r$e,r$l,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?r$S.texImage2D(this._type,0,this._image._format,r$e,r$l,0,this._image._format,5121,this._image.atlasSource):r$S.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case r$k.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:r$S.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var r$T=this._minFifter,r$U=this._magFifter,r$i=this._repeat?10497:33071,r$R=0==this._wrapModeU?10497:33071,r$o=0==this._wrapModeV?10497:33071,r$Y=r$v.isPOT(r$e,r$l);r$Y?(this._mipmap?-1!==r$T||(r$T=9987):-1!==r$T||(r$T=9729),-1!==r$U||(r$U=9729),r$S.texParameteri(this._type,10241,r$T),r$S.texParameteri(this._type,10240,r$U),r$S.texParameteri(this._type,10242,r$i),r$S.texParameteri(this._type,10243,r$i),r$S.texParameteri(this._type,10242,r$R),r$S.texParameteri(this._type,10243,r$o),this._mipmap&&r$S.generateMipmap(this._type)):(-1!==r$T||(r$T=9729),-1!==r$U||(r$U=9729),r$S.texParameteri(this._type,10241,r$T),r$S.texParameteri(this._type,10240,r$U),r$S.texParameteri(this._type,10242,33071),r$S.texParameteri(this._type,10243,33071)),r$M&&r$d&&r$X.bindTexture(r$S,r$M,r$d),this._image.onload=null,this._image=null,this.memorySize=r$Y?r$e*r$l*4*(1+1/3):r$e*r$l*4},r$Q.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},r$Q.onAsynLoaded=function(r$S,r$Q,r$e){if(r$e){var r$l=r$e[0];void 0!==r$l&&(this._canRead=r$l);var r$M=r$e[1];void 0!==r$M&&(this._repeat=r$M);var r$d=r$e[2];void 0!==r$d&&(this._format=r$d);var r$T=r$e[3];void 0!==r$T&&(this._mipmap=r$T);var r$U=r$e.wrapModeU;void 0!==r$U&&(this._wrapModeU=r$U);var r$i=r$e.wrapModeV;void 0!==r$i&&(this._wrapModeV=r$i)}switch(this._format){case 6407:case 6408:var r$R=(this._image=r$Q).width,r$o=r$Q.height;this._width=r$R,this._height=r$o,this._size=new r$jQ(r$R,r$o),this._canRead&&(r$j.isConchApp?r$Q instanceof r$p.HTMLElement&&(this._pixels=new Uint8Array(r$Q.getImageData(0,0,r$R,r$o))):(r$h.canvas.size(r$R,r$o),r$h.canvas.clear(),r$h.context.drawImage(r$Q,0,0,r$R,r$o),this._pixels=new Uint8Array(r$h.context.getImageData(0,0,r$R,r$o).data.buffer)));break;case r$k.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var r$Y=new r$B(r$Q);r$Y.readUTFBytes(4),r$Y.readUTFBytes(2),r$Y.getInt16();r$Y.endian="bigEndian",this._width=r$Y.getInt16(),this._height=r$Y.getInt16(),this._size=new r$jQ(this._width,this._height);r$Y.getInt16(),r$Y.getInt16();this._image=new Uint8Array(r$Q,r$Y.pos)}this.recreateResource(),this._endLoaded()},r$Q.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},r$Q.disposeResource=function(){this._source&&(r$k.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},r$L(0,r$Q,"_src",function(){return this.url}),r$L(0,r$Q,"src",function(){return this.url}),r$M.load=function(r$S){return r$D.loader.create(r$S,null,null,r$M)},r$M}(),r$FQ=function(r$Q){function r$e(r$S,r$Q){r$e.__super.call(this),void 0===r$S&&(r$S=.3),void 0===r$Q&&(r$Q=1e3),this._tempVector3=new r$TQ,this._position=new r$TQ,this._up=new r$TQ,this._forward=new r$TQ,this._right=new r$TQ,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=r$jQ.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=r$S,this._farPlane=r$Q,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),r$D.stage.on("resize",this,this._onScreenSizeChanged)}r$J(r$e,"laya.d3.core.BaseCamera",r$Q);var r$S=r$e.prototype;return r$S._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var r$S=this.scene._cameraPool,r$Q=r$S.length-1,r$e=0;r$e<r$Q;r$e++)if(r$S[r$e].renderingOrder>r$S[r$Q].renderingOrder){var r$l=r$S[r$e];r$S[r$e]=r$S[r$Q],r$S[r$Q]=r$l}},r$S._calculateProjectionMatrix=function(){},r$S._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},r$S._prepareCameraToRender=function(){r$b._currentCameraCullingMask=this.cullingMask;var r$S=this._shaderValues;r$S.setValue(0,this.transform.position.elements),r$S.setValue(5,this.forward.elements),r$S.setValue(6,this.up.elements)},r$S._prepareCameraViewProject=function(r$S,r$Q){var r$e=this._shaderValues;r$e.setValue(1,r$S.elements),r$e.setValue(2,r$Q.elements)},r$S._renderCamera=function(r$S,r$Q,r$e){},r$S.addLayer=function(r$S){29!==r$S.number&&30!=r$S.number&&(this.cullingMask=this.cullingMask|r$S.mask)},r$S.removeLayer=function(r$S){29!==r$S.number&&30!=r$S.number&&(this.cullingMask=this.cullingMask&~r$S.mask)},r$S.addAllLayers=function(){this.cullingMask=2147483647},r$S.removeAllLayers=function(){this.cullingMask=0|r$b.getLayerByNumber(29).mask|r$b.getLayerByNumber(30).mask},r$S.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},r$S.moveForward=function(r$S){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=r$S,this.transform.translate(this._tempVector3)},r$S.moveRight=function(r$S){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=r$S,this.transform.translate(this._tempVector3)},r$S.moveVertical=function(r$S){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=r$S,this.transform.translate(this._tempVector3,!1)},r$S._addSelfRenderObjects=function(){var r$S=this.scene._cameraPool,r$Q=r$S.length;if(0<r$Q){for(var r$e=r$Q-1;0<=r$e;r$e--)if(this.renderingOrder<=r$S[r$e].renderingOrder){r$S.splice(r$e+1,0,this);break}}else r$S.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},r$S._clearSelfRenderObjects=function(){var r$S=this.scene._cameraPool;r$S.splice(r$S.indexOf(this),1)},r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,r$D.stage.off("resize",this,this._onScreenSizeChanged),r$Q.prototype.destroy.call(this,r$S)},r$L(0,r$S,"sky",function(){return this._sky},function(r$S){(this._sky=r$S)._ownerCamera=this}),r$L(0,r$S,"forward",function(){var r$S=this.transform.worldMatrix.elements,r$Q=this._forward.elements;return r$Q[0]=-r$S[8],r$Q[1]=-r$S[9],r$Q[2]=-r$S[10],this._forward}),r$L(0,r$S,"position",function(){var r$S=this.transform.worldMatrix.elements,r$Q=this._position.elements;return r$Q[0]=r$S[12],r$Q[1]=r$S[13],r$Q[2]=r$S[14],this._position}),r$L(0,r$S,"renderTarget",function(){return this._renderTarget},function(r$S){null!=(this._renderTarget=r$S)&&(this._renderTargetSize=r$S.size)}),r$L(0,r$S,"up",function(){var r$S=this.transform.worldMatrix.elements,r$Q=this._up.elements;return r$Q[0]=r$S[4],r$Q[1]=r$S[5],r$Q[2]=r$S[6],this._up}),r$L(0,r$S,"right",function(){var r$S=this.transform.worldMatrix.elements,r$Q=this._right.elements;return r$Q[0]=r$S[0],r$Q[1]=r$S[1],r$Q[2]=r$S[2],this._right}),r$L(0,r$S,"renderTargetSize",function(){return this._renderTargetSize},function(r$S){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=r$S,this._calculateProjectionMatrix()}),r$L(0,r$S,"fieldOfView",function(){return this._fieldOfView},function(r$S){this._fieldOfView=r$S,this._calculateProjectionMatrix()}),r$L(0,r$S,"nearPlane",function(){return this._nearPlane},function(r$S){this._nearPlane=r$S,this._calculateProjectionMatrix()}),r$L(0,r$S,"farPlane",function(){return this._farPlane},function(r$S){this._farPlane=r$S,this._calculateProjectionMatrix()}),r$L(0,r$S,"orthographic",function(){return this._orthographic},function(r$S){this._orthographic=r$S,this._calculateProjectionMatrix()}),r$L(0,r$S,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(r$S){this._orthographicVerticalSize=r$S,this._calculateProjectionMatrix()}),r$L(0,r$S,"renderingOrder",function(){return this._renderingOrder},function(r$S){this._renderingOrder=r$S,this._sortCamerasByRenderingOrder()}),r$e.CAMERAPOS=0,r$e.VIEWMATRIX=1,r$e.PROJECTMATRIX=2,r$e.VPMATRIX=3,r$e.VPMATRIX_NO_TRANSLATE=4,r$e.CAMERADIRECTION=5,r$e.CAMERAUP=6,r$e.ENVIRONMENTDIFFUSE=7,r$e.ENVIRONMENTSPECULAR=8,r$e.SIMLODINFO=9,r$e.DIFFUSEIRRADMATR=10,r$e.DIFFUSEIRRADMATG=11,r$e.DIFFUSEIRRADMATB=12,r$e.HDREXPOSURE=13,r$e.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",r$e.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",r$e.CLEARFLAG_SOLIDCOLOR=0,r$e.CLEARFLAG_SKY=1,r$e.CLEARFLAG_DEPTHONLY=2,r$e.CLEARFLAG_NONE=3,r$Y(r$e,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new r$SQ(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new r$SQ},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new r$SQ}]),r$e}(r$$Q),r$qQ=function(r$e){function r$Q(r$S){this._render=null,this._geometryFilter=null,r$Q.__super.call(this,r$S)}r$J(r$Q,"laya.d3.core.RenderableSprite3D",r$e);var r$S=r$Q.prototype;return r$S._addToInitStaticBatchManager=function(){},r$S._setBelongScene=function(r$S){r$e.prototype._setBelongScene.call(this,r$S),r$S._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},r$S._setUnBelongScene=function(){var r$S=this._scene._renderableSprite3Ds,r$Q=r$S.indexOf(this);r$S.splice(r$Q,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),r$e.prototype._setUnBelongScene.call(this)},r$S._update=function(r$S){(r$S.owner=this)._activeInHierarchy&&(this._updateComponents(r$S),this._render._updateOctreeNode(),this._lateUpdateComponents(r$S),r$H.spriteCount++,this._childs.length&&this._updateChilds(r$S))},r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),r$e.prototype.destroy.call(this,r$S),this._render._destroy(),this._render=null},r$Q.__init__=function(){r$Q.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=r$Q.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),r$Q.SAHDERDEFINE_LIGHTMAP=r$Q.shaderDefines.registerDefine("LIGHTMAP")},r$Q.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,r$Q.SAHDERDEFINE_LIGHTMAP=4,r$Q.LIGHTMAPSCALEOFFSET=2,r$Q.LIGHTMAP=3,r$Y(r$Q,["shaderDefines",function(){return this.shaderDefines=new r$oQ}]),r$Q}(r$$Q),r$ZQ=(function(r$S){function r$l(r$S,r$Q,r$e){this._long=NaN,this._width=NaN,this._height=NaN,void 0===r$S&&(r$S=1),void 0===r$Q&&(r$Q=1),void 0===r$e&&(r$e=1),r$l.__super.call(this),this._long=r$S,this._width=r$Q,this._height=r$e,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}r$J(r$l,"laya.d3.resource.models.BoxMesh",r$uQ);var r$Q=r$l.prototype;r$Q.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var r$S=r$kS.vertexDeclaration,r$Q=(r$S.vertexStride,this._long/2),r$e=this._height/2,r$l=this._width/2,r$M=new Float32Array([-r$Q,r$e,-r$l,0,1,0,0,0,r$Q,r$e,-r$l,0,1,0,1,0,r$Q,r$e,r$l,0,1,0,1,1,-r$Q,r$e,r$l,0,1,0,0,1,-r$Q,-r$e,-r$l,0,-1,0,0,1,r$Q,-r$e,-r$l,0,-1,0,1,1,r$Q,-r$e,r$l,0,-1,0,1,0,-r$Q,-r$e,r$l,0,-1,0,0,0,-r$Q,r$e,-r$l,-1,0,0,0,0,-r$Q,r$e,r$l,-1,0,0,1,0,-r$Q,-r$e,r$l,-1,0,0,1,1,-r$Q,-r$e,-r$l,-1,0,0,0,1,r$Q,r$e,-r$l,1,0,0,1,0,r$Q,r$e,r$l,1,0,0,0,0,r$Q,-r$e,r$l,1,0,0,0,1,r$Q,-r$e,-r$l,1,0,0,1,1,-r$Q,r$e,r$l,0,0,1,0,0,r$Q,r$e,r$l,0,0,1,1,0,r$Q,-r$e,r$l,0,0,1,1,1,-r$Q,-r$e,r$l,0,0,1,0,1,-r$Q,r$e,-r$l,0,0,-1,1,0,r$Q,r$e,-r$l,0,0,-1,0,0,r$Q,-r$e,-r$l,0,0,-1,0,1,-r$Q,-r$e,-r$l,0,0,-1,1,1]),r$d=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new r$fQ(r$S,this._numberVertices,35044,!0),this._indexBuffer=new r$aQ("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(r$M),this._indexBuffer.setData(r$d),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},r$L(0,r$Q,"long",function(){return this._long},function(r$S){this._long!==r$S&&(this._long=r$S,this.releaseResource(),this.activeResource())}),r$L(0,r$Q,"width",function(){return this._width},function(r$S){this._width!==r$S&&(this._width=r$S,this.releaseResource(),this.activeResource())}),r$L(0,r$Q,"height",function(){return this._height},function(r$S){this._height!==r$S&&(this._height=r$S,this.releaseResource(),this.activeResource())})}(),function(r$S){function r$T(r$S,r$Q,r$e){void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=.3),void 0===r$e&&(r$e=1e3),this._viewMatrix=new r$SQ,this._projectionMatrix=new r$SQ,this._projectionViewMatrix=new r$SQ,this._viewport=new r$iQ(0,0,0,0),this._normalizedViewport=new r$iQ(0,0,1,1),this._aspectRatio=r$S,this._boundFrustumUpdate=!0,this._boundFrustum=new r$VS(r$SQ.DEFAULT),r$T.__super.call(this,r$Q,r$e),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}r$J(r$T,"laya.d3.core.Camera",r$FQ);var r$Q=r$T.prototype;return r$Q._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},r$Q._parseCustomProps=function(r$S,r$Q,r$e,r$l){var r$M=r$e.clearColor;this.clearColor=new r$UQ(r$M[0],r$M[1],r$M[2],r$M[3]);var r$d=r$e.viewport;this.normalizedViewport=new r$iQ(r$d[0],r$d[1],r$d[2],r$d[3])},r$Q._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var r$S=this.orthographicVerticalSize*this.aspectRatio*.5,r$Q=.5*this.orthographicVerticalSize;r$SQ.createOrthoOffCenterRH(-r$S,r$S,-r$Q,r$Q,this.nearPlane,this.farPlane,this._projectionMatrix)}else r$SQ.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},r$Q._update=function(r$S){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,r$S)},r$Q._renderCamera=function(r$S,r$Q,r$e){var r$l,r$M;r$e.parallelSplitShadowMaps[0]&&r$e._renderShadowMap(r$S,r$Q,this),(r$Q.camera=this)._prepareCameraToRender(),r$e._preRenderUpdateComponents(r$Q),r$l=r$Q._viewMatrix=this.viewMatrix;var r$d=this._renderTarget;r$d?(r$d.start(),r$SQ.multiply(r$FQ._invertYScaleMatrix,this._projectionMatrix,r$FQ._invertYProjectionMatrix),r$SQ.multiply(r$FQ._invertYScaleMatrix,this.projectionViewMatrix,r$FQ._invertYProjectionViewMatrix),r$M=r$Q._projectionMatrix=r$FQ._invertYProjectionMatrix,r$Q._projectionViewMatrix=r$FQ._invertYProjectionViewMatrix):(r$M=r$Q._projectionMatrix=this._projectionMatrix,r$Q._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(r$l,r$M),r$Q._viewport=this.viewport,r$e._preRenderScene(r$S,r$Q,this.boundFrustum),r$e._clear(r$S,r$Q),r$e._renderScene(r$S,r$Q),r$e._postRenderUpdateComponents(r$Q),r$d&&r$d.end()},r$Q.viewportPointToRay=function(r$S,r$Q){r$LQ.calculateCursorRay(r$S,this.viewport,this._projectionMatrix,this.viewMatrix,null,r$Q)},r$Q.normalizedViewportPointToRay=function(r$S,r$Q){var r$e=r$T._tempVector20,r$l=this.viewport,r$M=r$S.elements,r$d=r$e.elements;r$d[0]=r$M[0]*r$l.width,r$d[1]=r$M[1]*r$l.height,r$LQ.calculateCursorRay(r$e,this.viewport,this._projectionMatrix,this.viewMatrix,null,r$Q)},r$Q.worldToViewportPoint=function(r$S,r$Q){r$SQ.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(r$S,this._projectionViewMatrix,r$Q);var r$e=r$Q.elements;r$e[0]=r$e[0]/r$D.stage.clientScaleX,r$e[1]=r$e[1]/r$D.stage.clientScaleY},r$Q.worldToNormalizedViewportPoint=function(r$S,r$Q){r$SQ.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(r$S,this._projectionViewMatrix,r$Q);var r$e=r$Q.elements;r$e[0]=r$e[0]/r$D.stage.clientScaleX,r$e[1]=r$e[1]/r$D.stage.clientScaleY},r$Q.convertScreenCoordToOrthographicCoord=function(r$S,r$Q){if(this._orthographic){var r$e=r$C.clientWidth,r$l=r$C.clientHeight,r$M=this.orthographicVerticalSize*this.aspectRatio/r$e,r$d=this.orthographicVerticalSize/r$l,r$T=r$S.elements,r$U=r$Q.elements;return r$U[0]=(-r$e/2+r$T[0])*r$M,r$U[1]=(r$l/2-r$T[1])*r$d,r$U[2]=(this.nearPlane-this.farPlane)*(r$T[2]+1)/2-this.nearPlane,r$TQ.transformCoordinate(r$Q,this.transform.worldMatrix,r$Q),!0}return!1},r$L(0,r$Q,"projectionViewMatrix",function(){return r$SQ.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),r$L(0,r$Q,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var r$S=this.viewport;return r$S.width/r$S.height},function(r$S){if(r$S<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=r$S,this._calculateProjectionMatrix()}),r$L(0,r$Q,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),r$L(0,r$Q,"needViewport",function(){var r$S=this.normalizedViewport;return 0===r$S.x&&0===r$S.y&&1===r$S.width&&1===r$S.height}),r$L(0,r$Q,"viewport",function(){if(this._viewportExpressedInClipSpace){var r$S=this._normalizedViewport,r$Q=this.renderTargetSize,r$e=r$Q.width,r$l=r$Q.height;this._viewport.x=r$S.x*r$e,this._viewport.y=r$S.y*r$l,this._viewport.width=r$S.width*r$e,this._viewport.height=r$S.height*r$l}return this._viewport},function(r$S){if(null!=this.renderTarget&&(r$S.x<0||r$S.y<0||0==r$S.width||0==r$S.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=r$S,this._calculateProjectionMatrix()}),r$L(0,r$Q,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var r$S=this._viewport,r$Q=this.renderTargetSize,r$e=r$Q.width,r$l=r$Q.height;this._normalizedViewport.x=r$S.x/r$e,this._normalizedViewport.y=r$S.y/r$l,this._normalizedViewport.width=r$S.width/r$e,this._normalizedViewport.height=r$S.height/r$l}return this._normalizedViewport},function(r$S){r$S.x<0&&(r$S.x=0,console.warn("Camera: viewport.x must large than 0.0.")),r$S.y<0&&(r$S.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<r$S.x+r$S.width&&(r$S.width=1-r$S.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<r$S.y+r$S.height&&(r$S.height=1-r$S.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=r$S,this._calculateProjectionMatrix()}),r$L(0,r$Q,"projectionMatrix",function(){return this._projectionMatrix},function(r$S){this._projectionMatrix=r$S,this._useUserProjectionMatrix=!0}),r$L(0,r$Q,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),r$Y(r$T,["_tempVector20",function(){return this._tempVector20=new r$dQ}]),r$T}()),r$NQ=function(r$e){function r$l(r$S,r$Q){r$l.__super.call(this,r$Q),this._geometryFilter=new r$hQ(this),this._render=new r$bQ(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),r$S&&(this._geometryFilter.sharedMesh=r$S)instanceof laya.d3.resource.models.Mesh&&(r$S.loaded?this._render.sharedMaterials=r$S.materials:r$S.once("loaded",this,this._applyMeshMaterials))}r$J(r$l,"laya.d3.core.MeshSprite3D",r$e);var r$S=r$l.prototype;return r$S._changeRenderObjectByMesh=function(r$S){var r$Q=this._render._renderElements,r$e=r$Q[r$S];r$e||(r$e=r$Q[r$S]=new r$OQ),r$e._render=this._render;var r$l=this._render.sharedMaterials[r$S];r$l||(r$l=r$PQ.defaultMaterial);var r$M=this._geometryFilter.sharedMesh.getRenderElement(r$S);return r$e._mainSortID=this._getSortID(r$M,r$l),r$e._sprite3D=this,r$e.renderObj=r$M,r$e._material=r$l,r$e},r$S._changeRenderObjectByMaterial=function(r$S,r$Q){var r$e=this._render._renderElements[r$S];r$Q||(r$Q=r$PQ.defaultMaterial);var r$l=this._geometryFilter.sharedMesh.getRenderElement(r$S);return r$e._mainSortID=this._getSortID(r$l,r$Q),r$e._sprite3D=this,r$e.renderObj=r$l,r$e._material=r$Q,r$e},r$S._changeRenderObjectsByMesh=function(){var r$S=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=r$S;for(var r$Q=0;r$Q<r$S;r$Q++)this._changeRenderObjectByMesh(r$Q)},r$S._onMeshChanged=function(r$S){var r$Q=r$S.sharedMesh;r$Q.loaded?this._changeRenderObjectsByMesh():r$Q.once("loaded",this,this._onMeshLoaded)},r$S._onMeshLoaded=function(r$S){r$S===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},r$S._onMaterialChanged=function(r$S,r$Q,r$e){r$Q<this._render._renderElements.length&&this._changeRenderObjectByMaterial(r$Q,r$e)},r$S._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},r$S._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},r$S._parseCustomProps=function(r$S,r$Q,r$e,r$l){var r$M=this.meshRender,r$d=r$e.lightmapIndex;null!=r$d&&(r$M.lightmapIndex=r$d);var r$T,r$U,r$i=r$e.lightmapScaleOffset;if(r$i&&(r$M.lightmapScaleOffset=new r$UQ(r$i[0],r$i[1],r$i[2],r$i[3])),r$l.instanceParams)(r$T=r$l.instanceParams.loadPath)&&(r$U=r$G.getRes(r$Q[r$T]),(this.meshFilter.sharedMesh=r$U).loaded?r$M.sharedMaterials=r$U.materials:r$U.once("loaded",this,this._applyMeshMaterials));else{(r$T=r$e.meshPath)&&(r$U=r$G.getRes(r$Q[r$T]),this.meshFilter.sharedMesh=r$U);var r$R=r$e.materials;if(r$R){var r$o=r$M.sharedMaterials,r$Y=r$R.length;r$o.length=r$Y;for(var r$p=0;r$p<r$Y;r$p++)r$o[r$p]=r$G.getRes(r$Q[r$R[r$p].path]);r$M.sharedMaterials=r$o}}},r$S._applyMeshMaterials=function(r$S){for(var r$Q=this._render.sharedMaterials,r$e=r$S.materials,r$l=0,r$M=r$e.length;r$l<r$M;r$l++)r$Q[r$l]||(r$Q[r$l]=r$e[r$l]);this._render.sharedMaterials=r$Q},r$S._addToInitStaticBatchManager=function(){r$l._staticBatchManager._addInitBatchSprite(this)},r$S.cloneTo=function(r$S){var r$Q=r$S;r$Q._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var r$e=this._render,r$l=r$Q._render;r$l.enable=r$e.enable,r$l.sharedMaterials=r$e.sharedMaterials,r$l.castShadow=r$e.castShadow;var r$M=r$e.lightmapScaleOffset;r$M&&(r$l.lightmapScaleOffset=r$M.clone()),r$l.lightmapIndex=r$e.lightmapIndex,r$l.receiveShadow=r$e.receiveShadow,r$l.sortingFudge=r$e.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,r$S)},r$S.destroy=function(r$S){if(void 0===r$S&&(r$S=!0),!this.destroyed){var r$Q=this.meshFilter.sharedMesh;null!=r$Q&&(r$Q.loaded||r$Q.off("loaded",this,this._applyMeshMaterials)),r$e.prototype.destroy.call(this,r$S),this._geometryFilter._destroy()}},r$L(0,r$S,"meshFilter",function(){return this._geometryFilter}),r$L(0,r$S,"meshRender",function(){return this._render}),r$l.__init__=function(){r$lS._staticBatchManagers.push(r$l._staticBatchManager)},r$l.load=function(r$S){return r$D.loader.create(r$S,null,null,r$l)},r$Y(r$l,["_staticBatchManager",function(){return this._staticBatchManager=new r$gQ}]),r$l}(r$qQ)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(r$S,r$Q){"use strict";for(var r$e in Object.defineProperty(r$Q,"__esModule",{value:!0}),Laya){var r$l=Laya[r$e];r$l&&r$l.__isclass&&(r$Q[r$e]=r$l)}}),function(r$S,r$Q,r$MS){r$MS.un,r$MS.uns;var r$e=r$MS.static,r$l=r$MS.class,r$d=r$MS.getset,r$j=r$MS.__newvec,r$U=laya.maths.Bezier,r$Y=laya.utils.Browser,r$kS=laya.utils.Byte,r$M=(laya.events.Event,laya.events.EventDispatcher),r$T=laya.display.Graphics,r$i=(laya.resource.HTMLCanvas,laya.utils.Handler),r$R=laya.net.Loader,r$p=laya.maths.MathUtil,r$XS=laya.maths.Matrix,r$c=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),r$o=(laya.renders.RenderContext,laya.resource.Resource),r$J=laya.utils.RunDriver,r$dS=laya.display.Sprite,r$L=laya.utils.Stat,r$hS=laya.resource.Texture,r$G=(laya.net.URL,laya.utils.Utils),r$X=function(){function r$S(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return r$l(r$S,"laya.ani.AnimationContent"),r$S}(),r$h=function(){function r$S(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return r$l(r$S,"laya.ani.AnimationNodeContent"),r$S}(),r$A=function(){function r$S(){}return r$l(r$S,"laya.ani.AnimationParser01"),r$S.parse=function(r$S,r$Q){var r$e=r$Q.__getBuffer(),r$l=0,r$M=0,r$d=0,r$T=0,r$U=0,r$i=0,r$R=0,r$o=r$Q.readUTFString();r$S._aniClassName=r$o;var r$Y,r$p=r$Q.readUTFString().split("\n"),r$J=r$Q.getUint8(),r$L=r$Q.getUint32(),r$j=r$Q.getUint32();0<r$L&&(r$Y=r$e.slice(r$L,r$j));var r$c=new r$kS(r$Y);for(0<r$j&&(r$S._publicExtData=r$e.slice(r$j,r$e.byteLength)),r$S._useParent=!!r$Q.getUint8(),r$S._anis.length=r$J,r$l=0;r$l<r$J;r$l++){var r$G=r$S._anis[r$l]=new r$X;r$G.nodes=new Array;var r$z=r$G.name=r$p[r$Q.getUint16()];r$S._aniMap[r$z]=r$l,r$G.bone3DMap={},r$G.playTime=r$Q.getFloat32(),r$G.playTime<=0&&console.error("播放时间不能为0  url="+r$S.url+" name="+r$G.name);var r$A=r$G.nodes.length=r$Q.getUint8();for(r$M=r$G.totalKeyframeDatasLength=0;r$M<r$A;r$M++){var r$v=r$G.nodes[r$M]=new r$h;r$v.childs=[];var r$D=r$Q.getInt16();0<=r$D&&(r$v.name=r$p[r$D],r$G.bone3DMap[r$v.name]=r$M),r$v.keyFrame=new Array,r$v.parentIndex=r$Q.getInt16(),-1==r$v.parentIndex?r$v.parent=null:r$v.parent=r$G.nodes[r$v.parentIndex],r$v.lerpType=r$Q.getUint8();var r$B=r$Q.getUint32();r$c.pos=r$B;var r$O=r$v.keyframeWidth=r$c.getUint16();if(r$G.totalKeyframeDatasLength+=r$O,0===r$v.lerpType||1===r$v.lerpType)for(r$v.interpolationMethod=[],r$v.interpolationMethod.length=r$O,r$d=0;r$d<r$O;r$d++)r$v.interpolationMethod[r$d]=r$$.interpolation[r$c.getUint8()];null!=r$v.parent&&r$v.parent.childs.push(r$v);var r$H=r$Q.getUint16();0<r$H&&(r$v.extenData=r$e.slice(r$Q.pos,r$Q.pos+r$H),r$Q.pos+=r$H);var r$g,r$I=r$Q.getUint16(),r$E=0;for(r$d=0,r$T=r$v.keyFrame.length=r$I;r$d<r$T;r$d++){if((r$g=r$v.keyFrame[r$d]=new r$b).duration=r$Q.getFloat32(),r$g.startTime=r$E,2===r$v.lerpType){r$g.interpolationData=[];var r$t,r$k=r$Q.getUint8();switch(r$t=r$Q.getFloat32()){case 254:for(r$g.interpolationData.length=r$O,r$R=0;r$R<r$O;r$R++)r$g.interpolationData[r$R]=0;break;case 255:for(r$g.interpolationData.length=r$O,r$R=0;r$R<r$O;r$R++)r$g.interpolationData[r$R]=5;break;default:for(r$g.interpolationData.push(r$t),r$i=1;r$i<r$k;r$i++)r$g.interpolationData.push(r$Q.getFloat32())}}for(r$g.data=new Float32Array(r$O),r$U=0;r$U<r$O;r$U++)r$g.data[r$U]=r$Q.getFloat32(),-1e-8<r$g.data[r$U]&&r$g.data[r$U]<1e-8&&(r$g.data[r$U]=0);r$E+=r$g.duration}r$g.startTime=r$G.playTime,r$v.playTime=r$G.playTime,r$S._calculateKeyFrame(r$v,r$I,r$O)}}},r$S}(),r$v=function(){function r$D(){}return r$l(r$D,"laya.ani.AnimationParser02"),r$D.READ_DATA=function(){r$D._DATA.offset=r$D._reader.getUint32(),r$D._DATA.size=r$D._reader.getUint32()},r$D.READ_BLOCK=function(){for(var r$S=r$D._BLOCK.count=r$D._reader.getUint16(),r$Q=r$D._BLOCK.blockStarts=[],r$e=r$D._BLOCK.blockLengths=[],r$l=0;r$l<r$S;r$l++)r$Q.push(r$D._reader.getUint32()),r$e.push(r$D._reader.getUint32())},r$D.READ_STRINGS=function(){var r$S=r$D._reader.getUint32(),r$Q=r$D._reader.getUint16(),r$e=r$D._reader.pos;r$D._reader.pos=r$S+r$D._DATA.offset;for(var r$l=0;r$l<r$Q;r$l++)r$D._strings[r$l]=r$D._reader.readUTFString();r$D._reader.pos=r$e},r$D.parse=function(r$S,r$Q){r$D._templet=r$S;(r$D._reader=r$Q).__getBuffer();r$D.READ_DATA(),r$D.READ_BLOCK(),r$D.READ_STRINGS();for(var r$e=0,r$l=r$D._BLOCK.count;r$e<r$l;r$e++){var r$M=r$Q.getUint16(),r$d=r$D._strings[r$M],r$T=r$D["READ_"+r$d];if(null==r$T)throw new Error("model file err,no this function:"+r$M+" "+r$d);r$T.call()}},r$D.READ_ANIMATIONS=function(){var r$S=r$D._reader,r$Q=r$S.__getBuffer(),r$e=0,r$l=0,r$M=0,r$d=0,r$T=r$S.getUint16(),r$U=[];for(r$U.length=r$T,r$e=0;r$e<r$T;r$e++)r$U[r$e]=r$$.interpolation[r$S.getByte()];var r$i=r$S.getUint8();for(r$D._templet._anis.length=r$i,r$e=0;r$e<r$i;r$e++){var r$R=r$D._templet._anis[r$e]={};r$R.nodes=new Array;var r$o=r$R.name=r$D._strings[r$S.getUint16()];r$D._templet._aniMap[r$o]=r$e,r$R.bone3DMap={},r$R.playTime=r$S.getFloat32();var r$Y=r$R.nodes.length=r$S.getInt16();for(r$l=r$R.totalKeyframeDatasLength=0;r$l<r$Y;r$l++){var r$p=r$R.nodes[r$l]={};r$p.keyframeWidth=r$T,r$p.childs=[];var r$J=r$S.getUint16();0<=r$J&&(r$p.name=r$D._strings[r$J],r$R.bone3DMap[r$p.name]=r$l),r$p.keyFrame=new Array,r$p.parentIndex=r$S.getInt16(),-1==r$p.parentIndex?r$p.parent=null:r$p.parent=r$R.nodes[r$p.parentIndex],r$R.totalKeyframeDatasLength+=r$T,r$p.interpolationMethod=r$U,null!=r$p.parent&&r$p.parent.childs.push(r$p);var r$L=r$S.getUint16(),r$j=null,r$c=null;for(r$M=0,r$d=r$p.keyFrame.length=r$L;r$M<r$d;r$M++){(r$j=r$p.keyFrame[r$M]={}).startTime=r$S.getFloat32(),r$c&&(r$c.duration=r$j.startTime-r$c.startTime);var r$G=r$D._DATA.offset,r$z=r$S.getUint32(),r$A=4*r$T,r$v=r$Q.slice(r$G+r$z,r$G+r$z+r$A);r$j.data=new Float32Array(r$v),r$c=r$j}r$j.duration=0,r$p.playTime=r$R.playTime,r$D._templet._calculateKeyFrame(r$p,r$L,r$T)}}},r$D._templet=null,r$D._reader=null,r$D._strings=[],r$e(r$D,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),r$D}(),r$bS=(function(){function r$S(){}r$l(r$S,"laya.ani.AnimationState"),r$S.stopped=0,r$S.paused=1,r$S.playing=2}(),function(){function r$M(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new r$qS,this.resultMatrix=new r$XS,this._children=[]}r$l(r$M,"laya.ani.bone.Bone");var r$S=r$M.prototype;return r$S.setTempMatrix=function(r$S){this._tempMatrix=r$S;var r$Q,r$e=0;for(r$e=0,r$Q=this._children.length;r$e<r$Q;r$e++)this._children[r$e].setTempMatrix(this._tempMatrix)},r$S.update=function(r$S){var r$Q;if(this.rotation=this.transform.skX,r$S)r$Q=this.resultTransform.getMatrix(),r$XS.mul(r$Q,r$S,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)r$Q=this.resultTransform.getMatrix(),r$XS.mul(r$Q,this.parentBone.resultMatrix,this.resultMatrix);else{var r$e=this.parentBone,r$l=NaN,r$M=NaN,r$d=NaN,r$T=this.parentBone.resultMatrix;r$Q=this.resultTransform.getMatrix();var r$U=r$T.a*r$Q.tx+r$T.c*r$Q.ty+r$T.tx,r$i=r$T.b*r$Q.tx+r$T.d*r$Q.ty+r$T.ty,r$R=new r$XS;this.inheritRotation?(r$l=Math.atan2(r$e.resultMatrix.b,r$e.resultMatrix.a),r$M=Math.cos(r$l),r$d=Math.sin(r$l),r$R.setTo(r$M,r$d,-r$d,r$M,0,0),r$XS.mul(this._tempMatrix,r$R,r$XS.TEMP),r$XS.TEMP.copyTo(r$R),r$Q=this.resultTransform.getMatrix(),r$XS.mul(r$Q,r$R,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,r$Q=this.resultTransform.getMatrix(),r$XS.TEMP.identity(),r$XS.TEMP.d=this.d,r$XS.mul(r$Q,r$XS.TEMP,this.resultMatrix)),this.resultMatrix.tx=r$U,this.resultMatrix.ty=r$i}else(r$Q=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var r$o,r$Y=0;for(r$Y=0,r$o=this._children.length;r$Y<r$o;r$Y++)this._children[r$Y].update()},r$S.updateChild=function(){var r$S,r$Q=0;for(r$Q=0,r$S=this._children.length;r$Q<r$S;r$Q++)this._children[r$Q].update()},r$S.setRotation=function(r$S){this._sprite&&(this._sprite.rotation=180*r$S/Math.PI)},r$S.updateDraw=function(r$S,r$Q){r$M.ShowBones&&!r$M.ShowBones[this.name]||(this._sprite||(this._sprite=new r$dS,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),r$MS.stage.addChild(this._sprite)),this._sprite.x=r$S+this.resultMatrix.tx,this._sprite.y=r$Q+this.resultMatrix.ty);var r$e,r$l=0;for(r$l=0,r$e=this._children.length;r$l<r$e;r$l++)this._children[r$l].updateDraw(r$S,r$Q)},r$S.addChild=function(r$S){this._children.push(r$S),r$S.parentBone=this},r$S.findBone=function(r$S){if(this.name==r$S)return this;var r$Q,r$e,r$l=0;for(r$l=0,r$Q=this._children.length;r$l<r$Q;r$l++)if(r$e=this._children[r$l].findBone(r$S))return r$e;return null},r$S.localToWorld=function(r$S){var r$Q=r$S[0],r$e=r$S[1];r$S[0]=r$Q*this.resultMatrix.a+r$e*this.resultMatrix.c+this.resultMatrix.tx,r$S[1]=r$Q*this.resultMatrix.b+r$e*this.resultMatrix.d+this.resultMatrix.ty},r$M.ShowBones={},r$M}()),r$mS=function(){function r$j(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}r$l(r$j,"laya.ani.bone.BoneSlot");var r$S=r$j.prototype;return r$S.showSlotData=function(r$S,r$Q){void 0===r$Q&&(r$Q=!0),this.currSlotData=r$S,r$Q&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},r$S.showDisplayByName=function(r$S){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(r$S))},r$S.replaceDisplayByName=function(r$S,r$Q){if(this.currSlotData){var r$e;r$e=this.currSlotData.getDisplayByName(r$S);var r$l;r$l=this.currSlotData.getDisplayByName(r$Q),this.replaceDisplayByIndex(r$e,r$l)}},r$S.replaceDisplayByIndex=function(r$S,r$Q){this.currSlotData&&(this._replaceDic[r$S]=r$Q,this.displayIndex==r$S&&this.showDisplayByIndex(r$S))},r$S.showDisplayByIndex=function(r$S){if(null!=this._replaceDic[r$S]&&(r$S=this._replaceDic[r$S]),this.currSlotData&&-1<r$S&&r$S<this.currSlotData.displayArr.length){if(this.displayIndex=r$S,this.currDisplayData=this.currSlotData.displayArr[r$S],this.currDisplayData){var r$Q=this.currDisplayData.name;this.currTexture=this.templet.getTexture(r$Q),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!r$c.isConchApp||r$c.isConchApp&&"0.9.15"<r$dS.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},r$S.replaceSkin=function(r$S){this._diyTexture=r$S,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},r$S.setParentMatrix=function(r$S){this._parentMatrix=r$S},r$S.draw=function(r$S,r$Q,r$e,r$l){if(void 0===r$e&&(r$e=!1),void 0===r$l&&(r$l=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var r$M,r$d=this.currTexture;switch(this._diyTexture&&(r$d=this._diyTexture),this.currDisplayData.type){case 0:if(r$S){var r$T=this.getDisplayMatrix();if(this._parentMatrix){var r$U=!1;if(r$T){var r$i;if(r$XS.mul(r$T,this._parentMatrix,r$XS.TEMP),r$i=r$e?(null==this._resultMatrix&&(this._resultMatrix=new r$XS),this._resultMatrix):new r$XS,!r$c.isWebGL&&this.currDisplayData.uvs||r$c.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var r$R=r$j._tempMatrix;r$R.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(r$R.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(r$U=!0,r$R.rotate(-Math.PI/2)),r$XS.mul(r$R,r$XS.TEMP,r$i)}else r$XS.TEMP.copyTo(r$i);r$U?r$S.drawTexture(r$d,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,r$i):r$S.drawTexture(r$d,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,r$i)}}}break;case 1:if(null==(r$M=r$e?(null==this._skinSprite&&(this._skinSprite=r$j.createSkinMesh()),this._skinSprite):r$j.createSkinMesh()))return;var r$o;if(null==this.currDisplayData.bones){var r$Y,r$p=this.currDisplayData.weights;this.deformData&&(r$p=this.deformData),r$Y=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=r$O.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=r$O.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=r$p;this.currDisplayData.triangles.length;r$o=this.currDisplayData.triangles,r$M.init2(r$d,null,r$o,this._mVerticleArr,r$Y);var r$J,r$L=this.getDisplayMatrix();if(this._parentMatrix)if(r$L)r$XS.mul(r$L,this._parentMatrix,r$XS.TEMP),r$J=r$e?(null==this._resultMatrix&&(this._resultMatrix=new r$XS),this._resultMatrix):new r$XS,r$XS.TEMP.copyTo(r$J),r$M.transform=r$J}else this.skinMesh(r$Q,r$M,r$l);r$S.drawSkin(r$M);break;case 2:if(null==(r$M=r$e?(null==this._skinSprite&&(this._skinSprite=r$j.createSkinMesh()),this._skinSprite):r$j.createSkinMesh()))return;this.skinMesh(r$Q,r$M,r$l),r$S.drawSkin(r$M)}}},r$S.skinMesh=function(r$S,r$Q,r$e){var r$l,r$M=this.currTexture,r$d=this.currDisplayData.bones;r$l=this._diyTexture?(r$M=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=r$O.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=r$O.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var r$T,r$U,r$i=this.currDisplayData.weights,r$R=this.currDisplayData.triangles,r$o=0,r$Y=0,r$p=0,r$J=NaN,r$L=NaN,r$j=0,r$c=0,r$G=[],r$z=0,r$A=0;if(this.deformData&&0<this.deformData.length){var r$v=0;for(r$z=0,r$A=r$d.length;r$z<r$A;){for(r$p=r$d[r$z++]+r$z,r$Y=r$o=0;r$z<r$p;r$z++)r$U=r$S[r$d[r$z]],r$J=r$i[r$j]+this.deformData[r$v++],r$L=r$i[r$j+1]+this.deformData[r$v++],r$c=r$i[r$j+2],r$o+=(r$J*r$U.a+r$L*r$U.c+r$U.tx)*r$c,r$Y+=(r$J*r$U.b+r$L*r$U.d+r$U.ty)*r$c,r$j+=3;r$G.push(r$o,r$Y)}}else for(r$z=0,r$A=r$d.length;r$z<r$A;){for(r$p=r$d[r$z++]+r$z,r$Y=r$o=0;r$z<r$p;r$z++)r$U=r$S[r$d[r$z]],r$J=r$i[r$j],r$L=r$i[r$j+1],r$c=r$i[r$j+2],r$o+=(r$J*r$U.a+r$L*r$U.c+r$U.tx)*r$c,r$Y+=(r$J*r$U.b+r$L*r$U.d+r$U.ty)*r$c,r$j+=3;r$G.push(r$o,r$Y)}this._mVerticleArr=r$G,r$T=r$R,r$Q.init2(r$M,null,r$T,this._mVerticleArr,r$l)},r$S.drawBonePoint=function(r$S){r$S&&this._parentMatrix&&r$S.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},r$S.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},r$S.getMatrix=function(){return this._resultMatrix},r$S.copy=function(){var r$S=new r$j;return r$S.type="copy",r$S.name=this.name,r$S.attachmentName=this.attachmentName,r$S.srcDisplayIndex=this.srcDisplayIndex,r$S.parent=this.parent,r$S.displayIndex=this.displayIndex,r$S.templet=this.templet,r$S.currSlotData=this.currSlotData,r$S.currTexture=this.currTexture,r$S.currDisplayData=this.currDisplayData,r$S},r$j.createSkinMesh=function(){return r$c.isWebGL||r$c.isConchApp?r$J.skinAniSprite():(r$c.isWebGL,null)},r$e(r$j,["_tempMatrix",function(){return this._tempMatrix=new r$XS}]),r$j}(),r$$S=function(){function r$S(){this.skinName=null,this.deformSlotDataList=[]}return r$l(r$S,"laya.ani.bone.DeformAniData"),r$S}(),r$nS=function(){function r$S(){this.deformSlotDisplayList=[]}return r$l(r$S,"laya.ani.bone.DeformSlotData"),r$S}(),r$PS=function(){function r$S(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}r$l(r$S,"laya.ani.bone.DeformSlotDisplayData");var r$Q=r$S.prototype;return r$Q.binarySearch1=function(r$S,r$Q){var r$e=0,r$l=r$S.length-2;if(0==r$l)return 1;for(var r$M=r$l>>>1;;){if(r$S[Math.floor(r$M+1)]<=r$Q?r$e=r$M+1:r$l=r$M,r$e==r$l)return r$e+1;r$M=r$e+r$l>>>1}return 0},r$Q.apply=function(r$S,r$Q,r$e){if(void 0===r$e&&(r$e=1),r$S+=.05,!(this.timeList.length<=0)){var r$l=0;if(!(r$S<this.timeList[0])){var r$M=this.vectices[0].length,r$d=[],r$T=this.binarySearch1(this.timeList,r$S);if(this.frameIndex=r$T,r$S>=this.timeList[this.timeList.length-1]){var r$U=this.vectices[this.vectices.length-1];if(r$e<1)for(r$l=0;r$l<r$M;r$l++)r$d[r$l]+=(r$U[r$l]-r$d[r$l])*r$e;else for(r$l=0;r$l<r$M;r$l++)r$d[r$l]=r$U[r$l];this.deformData=r$d}else{this.tweenKeyList[this.frameIndex];var r$i=this.vectices[this.frameIndex-1],r$R=this.vectices[this.frameIndex],r$o=this.timeList[this.frameIndex-1],r$Y=this.timeList[this.frameIndex];r$e=this.tweenKeyList[r$T-1]?(r$S-r$o)/(r$Y-r$o):0;var r$p=NaN;for(r$l=0;r$l<r$M;r$l++)r$p=r$i[r$l],r$d[r$l]=r$p+(r$R[r$l]-r$p)*r$e;this.deformData=r$d}}}},r$S}(),r$aS=function(){function r$S(){this.time=NaN,this.drawOrder=[]}return r$l(r$S,"laya.ani.bone.DrawOrderData"),r$S}(),r$fS=function(){function r$S(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return r$l(r$S,"laya.ani.bone.EventData"),r$S}(),r$z=function(){function r$lS(r$S,r$Q){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=r$S,this._targetBone=r$Q[r$S.targetBoneIndex],this.isSpine=r$S.isSpine,null==this._bones&&(this._bones=[]);for(var r$e=this._bones.length=0,r$l=r$S.boneIndexs.length;r$e<r$l;r$e++)this._bones.push(r$Q[r$S.boneIndexs[r$e]]);this.name=r$S.name,this.mix=r$S.mix,this.bendDirection=r$S.bendDirection}r$l(r$lS,"laya.ani.bone.IkConstraint");var r$S=r$lS.prototype;return r$S.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},r$S._applyIk1=function(r$S,r$Q,r$e,r$l){var r$M=r$S.parentBone,r$d=1/(r$M.resultMatrix.a*r$M.resultMatrix.d-r$M.resultMatrix.b*r$M.resultMatrix.c),r$T=r$Q-r$M.resultMatrix.tx,r$U=r$e-r$M.resultMatrix.ty,r$i=(r$T*r$M.resultMatrix.d-r$U*r$M.resultMatrix.c)*r$d-r$S.transform.x,r$R=(r$U*r$M.resultMatrix.a-r$T*r$M.resultMatrix.b)*r$d-r$S.transform.y,r$o=Math.atan2(r$R,r$i)*r$lS.radDeg-0-r$S.transform.skX;r$S.transform.scX<0&&(r$o+=180),180<r$o?r$o-=360:r$o<-180&&(r$o+=360),r$S.transform.skX=r$S.transform.skY=r$S.transform.skX+r$o*r$l,r$S.update()},r$S.updatePos=function(r$S,r$Q){this._sp&&this._sp.pos(r$S,r$Q)},r$S._applyIk2=function(r$S,r$Q,r$e,r$l,r$M,r$d){if(0!=r$d){var r$T=r$S.resultTransform.x,r$U=r$S.resultTransform.y,r$i=r$S.transform.scX,r$R=r$S.transform.scY,r$o=r$Q.transform.scX,r$Y=0,r$p=0,r$J=0;r$J=r$i<0?(r$i=-r$i,r$Y=180,-1):(r$Y=0,1),r$R<0&&(r$R=-r$R,r$J=-r$J),r$p=r$o<0?(r$o=-r$o,180):0;var r$L=r$Q.resultTransform.x,r$j=NaN,r$c=NaN,r$G=NaN,r$z=r$S.resultMatrix.a,r$A=r$S.resultMatrix.c,r$v=r$S.resultMatrix.b,r$D=r$S.resultMatrix.d,r$B=Math.abs(r$i-r$R)<=1e-4;r$G=r$B?(r$c=r$z*r$L+r$A*(r$j=r$Q.resultTransform.y)+r$S.resultMatrix.tx,r$v*r$L+r$D*r$j+r$S.resultMatrix.ty):(r$j=0,r$c=r$z*r$L+r$S.resultMatrix.tx,r$v*r$L+r$S.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new r$dS,r$MS.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(r$e,r$l,15,"#ffff00"),this._sp.graphics.drawCircle(r$c,r$G,15,"#ff00ff")),r$S.setRotation(Math.atan2(r$G-r$S.resultMatrix.ty,r$c-r$S.resultMatrix.tx));var r$O=r$S.parentBone;r$z=r$O.resultMatrix.a,r$A=r$O.resultMatrix.c,r$v=r$O.resultMatrix.b;var r$H=1/(r$z*(r$D=r$O.resultMatrix.d)-r$A*r$v),r$g=r$e-r$O.resultMatrix.tx,r$I=r$l-r$O.resultMatrix.ty,r$E=(r$g*r$D-r$I*r$A)*r$H-r$T,r$t=(r$I*r$z-r$g*r$v)*r$H-r$U,r$k=((r$g=r$c-r$O.resultMatrix.tx)*r$D-(r$I=r$G-r$O.resultMatrix.ty)*r$A)*r$H-r$T,r$X=(r$I*r$z-r$g*r$v)*r$H-r$U,r$h=Math.sqrt(r$k*r$k+r$X*r$X),r$b=r$Q.length*r$o,r$m=NaN,r$$=NaN;if(r$B){var r$n=(r$E*r$E+r$t*r$t-r$h*r$h-(r$b*=r$i)*r$b)/(2*r$h*r$b);r$n<-1?r$n=-1:1<r$n&&(r$n=1),r$$=Math.acos(r$n)*r$M,r$z=r$h+r$b*r$n,r$A=r$b*Math.sin(r$$),r$m=Math.atan2(r$t*r$z-r$E*r$A,r$E*r$z+r$t*r$A)}else{var r$P=(r$z=r$i*r$b)*r$z,r$a=(r$A=r$R*r$b)*r$A,r$f=r$E*r$E+r$t*r$t,r$w=Math.atan2(r$t,r$E),r$u=-2*r$a*r$h,r$r=r$a-r$P;if(0<(r$D=r$u*r$u-4*r$r*(r$v=r$a*r$h*r$h+r$P*r$f-r$P*r$a))){var r$W=Math.sqrt(r$D);r$u<0&&(r$W=-r$W);var r$x=(r$W=-(r$u+r$W)/2)/r$r,r$F=r$v/r$W,r$q=Math.abs(r$x)<Math.abs(r$F)?r$x:r$F;r$q*r$q<=r$f&&(r$I=Math.sqrt(r$f-r$q*r$q)*r$M,r$m=r$w-Math.atan2(r$I,r$q),r$$=Math.atan2(r$I/r$R,(r$q-r$h)/r$i))}var r$Z=0,r$N=Number.MAX_VALUE,r$C=0,r$K=0,r$V=0,r$_=0,r$s=0,r$y=0;r$_<(r$D=(r$g=r$h+r$z)*r$g)&&(r$V=0,r$_=r$D,r$s=r$g),(r$D=(r$g=r$h-r$z)*r$g)<r$N&&(r$Z=Math.PI,r$N=r$D,r$C=r$g);var r$SS=Math.acos(-r$z*r$h/(r$P-r$a));(r$D=(r$g=r$z*Math.cos(r$SS)+r$h)*r$g+(r$I=r$A*Math.sin(r$SS))*r$I)<r$N&&(r$Z=r$SS,r$N=r$D,r$C=r$g,r$K=r$I),r$_<r$D&&(r$V=r$SS,r$_=r$D,r$s=r$g,r$y=r$I),r$$=r$f<=(r$N+r$_)/2?(r$m=r$w-Math.atan2(r$K*r$M,r$C),r$Z*r$M):(r$m=r$w-Math.atan2(r$y*r$M,r$s),r$V*r$M)}var r$QS=Math.atan2(r$j,r$L)*r$J,r$eS=r$S.resultTransform.skX;180<(r$m=(r$m-r$QS)*r$lS.radDeg+r$Y-r$eS)?r$m-=360:r$m<-180&&(r$m+=360),r$S.resultTransform.x=r$T,r$S.resultTransform.y=r$U,r$S.resultTransform.skX=r$S.resultTransform.skY=r$eS+r$m*r$d,r$eS=r$Q.resultTransform.skX,180<(r$$=((r$$+r$QS)*r$lS.radDeg-0)*r$J+r$p-(r$eS%=360))?r$$-=360:r$$<-180&&(r$$+=360),r$Q.resultTransform.x=r$L,r$Q.resultTransform.y=r$j,r$Q.resultTransform.skX=r$Q.resultTransform.skY=r$Q.resultTransform.skY+r$$*r$d,r$S.update()}},r$S._applyIk3=function(r$S,r$Q,r$e,r$l,r$M,r$d){if(0!=r$d){var r$T,r$U,r$i=r$Q.resultMatrix.a*r$Q.length,r$R=r$Q.resultMatrix.b*r$Q.length,r$o=r$i*r$i+r$R*r$R,r$Y=Math.sqrt(r$o),r$p=r$S.resultMatrix.tx,r$J=r$S.resultMatrix.ty,r$L=r$Q.resultMatrix.tx,r$j=r$Q.resultMatrix.ty,r$c=r$L-r$p,r$G=r$j-r$J,r$z=r$c*r$c+r$G*r$G,r$A=Math.sqrt(r$z),r$v=(r$c=r$e-r$S.resultMatrix.tx)*r$c+(r$G=r$l-r$S.resultMatrix.ty)*r$G,r$D=Math.sqrt(r$v);if(r$Y+r$A<=r$D||r$D+r$Y<=r$A||r$D+r$A<=r$Y){var r$B=NaN;r$L=r$p+(r$B=r$Y+r$A<=r$D?1:-1)*(r$e-r$p)*r$A/r$D,r$j=r$J+r$B*(r$l-r$J)*r$A/r$D}else{var r$O=(r$z-r$o+r$v)/(2*r$v),r$H=Math.sqrt(r$z-r$O*r$O*r$v)/r$D,r$g=r$p+r$c*r$O,r$I=r$J+r$G*r$O,r$E=-r$G*r$H,r$t=r$c*r$H;r$j=0<r$M?(r$L=r$g-r$E,r$I-r$t):(r$L=r$g+r$E,r$I+r$t)}r$T=r$L,r$U=r$j,this.isDebug&&(this._sp||(this._sp=new r$dS,r$MS.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(r$p,r$J,15,"#ff00ff"),this._sp.graphics.drawCircle(r$e,r$l,15,"#ffff00"),this._sp.graphics.drawCircle(r$T,r$U,15,"#ff00ff"));var r$k,r$X;r$k=Math.atan2(r$U-r$S.resultMatrix.ty,r$T-r$S.resultMatrix.tx),r$S.setRotation(r$k),(r$X=r$lS._tempMatrix).identity(),r$X.rotate(r$k),r$X.scale(r$S.resultMatrix.getScaleX(),r$S.resultMatrix.getScaleY()),r$X.translate(r$S.resultMatrix.tx,r$S.resultMatrix.ty),r$X.copyTo(r$S.resultMatrix),r$S.updateChild();var r$h,r$b;r$h=Math.atan2(r$l-r$U,r$e-r$T),r$Q.setRotation(r$h),(r$b=r$lS._tempMatrix).identity(),r$b.rotate(r$h),r$b.scale(r$Q.resultMatrix.getScaleX(),r$Q.resultMatrix.getScaleY()),r$b.translate(r$T,r$U),r$X.copyTo(r$Q.resultMatrix),r$Q.updateChild()}},r$e(r$lS,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new r$XS}]),r$lS}(),r$wS=function(){function r$S(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return r$l(r$S,"laya.ani.bone.IkConstraintData"),r$S}(),r$D=function(){function r$b(r$S,r$Q){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=r$S,this.position=r$S.position,this.spacing=r$S.spacing,this.rotateMix=r$S.rotateMix,this.translateMix=r$S.translateMix,this.bones=[];for(var r$e=this.data.bones,r$l=0,r$M=r$e.length;r$l<r$M;r$l++)this.bones.push(r$Q[r$e[r$l]])}r$l(r$b,"laya.ani.bone.PathConstraint");var r$S=r$b.prototype;return r$S.apply=function(r$S,r$Q){if(this.target){var r$e=this.translateMix,r$l=this.translateMix,r$M=0<r$l,r$d=this.data.spacingMode,r$T="length"==r$d,r$U=this.data.rotateMode,r$i="tangent"==r$U,r$R="chainScale"==r$U,r$o=[],r$Y=this.bones.length,r$p=r$i?r$Y:r$Y+1,r$J=[];(this._spaces=r$J)[0]=this.position;var r$L=this.spacing;if(r$R||r$T)for(var r$j=0,r$c=r$p-1;r$j<r$c;){var r$G=this.bones[r$j],r$z=r$G.length,r$A=r$z*r$G.resultMatrix.a,r$v=r$z*r$G.resultMatrix.b;r$z=Math.sqrt(r$A*r$A+r$v*r$v),r$R&&(r$o[r$j]=r$z),r$J[++r$j]=r$T?Math.max(0,r$z+r$L):r$L}else for(r$j=1;r$j<r$p;r$j++)r$J[r$j]=r$L;var r$D=this.computeWorldPositions(this.target,r$S,r$Q,r$p,r$i,"percent"==this.data.positionMode,"percent"==r$d);if(this._debugKey){for(r$j=0;r$j<r$D.length;r$j++)r$Q.drawCircle(r$D[r$j++],r$D[r$j++],5,"#00ff00");var r$B=[];for(r$j=0;r$j<r$D.length;r$j++)r$B.push(r$D[r$j++],r$D[r$j++]);r$Q.drawLines(0,0,r$B,"#ff0000")}var r$O=r$D[0],r$H=r$D[1],r$g=this.data.offsetRotation,r$I="chain"==r$U&&0==r$g,r$E=NaN;for(r$j=0,r$E=3;r$j<r$Y;r$j++,r$E+=3){(r$G=this.bones[r$j]).resultMatrix.tx+=(r$O-r$G.resultMatrix.tx)*r$e,r$G.resultMatrix.ty+=(r$H-r$G.resultMatrix.ty)*r$e;var r$t=(r$A=r$D[r$E])-r$O,r$k=(r$v=r$D[r$E+1])-r$H;if(r$R&&0!=(r$z=r$o[r$j])){var r$X=(Math.sqrt(r$t*r$t+r$k*r$k)/r$z-1)*r$l+1;r$G.resultMatrix.a*=r$X,r$G.resultMatrix.c*=r$X}if(r$O=r$A,r$H=r$v,r$M){var r$h=r$G.resultMatrix.a,r$b=r$G.resultMatrix.c,r$m=r$G.resultMatrix.b,r$$=r$G.resultMatrix.d,r$n=NaN,r$P=NaN,r$a=NaN;r$n=r$i?r$D[r$E-1]:0==r$J[r$j+1]?r$D[r$E+2]:Math.atan2(r$k,r$t),r$n-=Math.atan2(r$m,r$h)-r$g/180*Math.PI,r$I&&(r$P=Math.cos(r$n),r$a=Math.sin(r$n),r$O+=((r$z=r$G.length)*(r$P*r$h-r$a*r$m)-r$t)*r$l,r$H+=(r$z*(r$a*r$h+r$P*r$m)-r$k)*r$l),r$n>Math.PI?r$n-=2*Math.PI:r$n<-Math.PI&&(r$n+=2*Math.PI),r$n*=r$l,r$P=Math.cos(r$n),r$a=Math.sin(r$n),r$G.resultMatrix.a=r$P*r$h-r$a*r$m,r$G.resultMatrix.c=r$P*r$b-r$a*r$$,r$G.resultMatrix.b=r$a*r$h+r$P*r$m,r$G.resultMatrix.d=r$a*r$b+r$P*r$$}}}},r$S.computeWorldVertices2=function(r$S,r$Q,r$e,r$l,r$M,r$d){var r$T,r$U,r$i=r$S.currDisplayData.bones,r$R=r$S.currDisplayData.weights,r$o=r$S.currDisplayData.triangles,r$Y=0,r$p=0,r$J=0,r$L=0,r$j=0,r$c=0,r$G=0,r$z=0,r$A=0,r$v=0,r$D=0;if(null!=r$i){for(r$Y=0;r$Y<r$e;r$Y+=2)r$p+=(r$L=r$i[r$p])+1,r$J+=r$L;var r$B=r$Q;for(r$j=r$d,r$c=3*r$J;r$j<r$l;r$j+=2){for(r$z=r$G=0,r$L=r$i[r$p++],r$L+=r$p;r$p<r$L;r$p++,r$c+=3){r$T=r$B[r$i[r$p]].resultMatrix,r$A=r$R[r$c],r$v=r$R[r$c+1];var r$O=r$R[r$c+2];r$G+=(r$A*r$T.a+r$v*r$T.c+r$T.tx)*r$O,r$z+=(r$A*r$T.b+r$v*r$T.d+r$T.ty)*r$O}r$M[r$j]=r$G,r$M[r$j+1]=r$z}}else{var r$H,r$g;if(r$o||(r$o=r$R),r$S.deformData&&(r$o=r$S.deformData),r$H=r$S.parent,r$Q)for(r$D=r$Q.length,r$Y=0;r$Y<r$D;r$Y++)if(r$Q[r$Y].name==r$H){r$U=r$Q[r$Y];break}r$U&&(r$g=r$U.resultMatrix),r$g||(r$g=r$b._tempMt);var r$I=r$g.tx,r$E=r$g.ty,r$t=r$g.a,r$k=r$g.b,r$X=r$g.c,r$h=r$g.d;for(r$U&&(r$h*=r$U.d),r$p=r$e,r$j=r$d;r$j<r$l;r$p+=2,r$j+=2)r$A=r$o[r$p],r$v=r$o[r$p+1],r$M[r$j]=r$A*r$t+r$v*r$k+r$I,r$M[r$j+1]=-(r$A*r$X+r$v*r$h+r$E)}},r$S.computeWorldPositions=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T){r$S.currDisplayData.bones,r$S.currDisplayData.weights,r$S.currDisplayData.triangles;var r$U=[],r$i=0,r$R=r$S.currDisplayData.verLen,r$o=this.position,r$Y=this._spaces,r$p=[],r$J=[],r$L=r$R/6,r$j=-1,r$c=NaN,r$G=0,r$z=0,r$A=NaN,r$v=NaN,r$D=NaN,r$B=NaN;if(r$L--,r$R-=4,this.computeWorldVertices2(r$S,r$Q,2,r$R,r$U,0),this._debugKey)for(r$i=0;r$i<r$U.length;)r$e.drawCircle(r$U[r$i++],r$U[r$i++],10,"#ff0000");r$p=r$U,this._curves.length=r$L;var r$O=this._curves,r$H=r$p[r$c=0],r$g=r$p[1],r$I=0,r$E=0,r$t=0,r$k=0,r$X=0,r$h=0,r$b=NaN,r$m=NaN,r$$=NaN,r$n=NaN,r$P=NaN,r$a=NaN,r$f=NaN,r$w=NaN,r$u=0;for(r$i=0,r$u=2;r$i<r$L;r$i++,r$u+=6)r$I=r$p[r$u],r$E=r$p[r$u+1],r$t=r$p[r$u+2],r$k=r$p[r$u+3],r$P=2*(r$b=.1875*(r$H-2*r$I+r$t))+(r$$=.09375*(3*(r$I-r$t)-r$H+(r$X=r$p[r$u+4]))),r$a=2*(r$m=.1875*(r$g-2*r$E+r$k))+(r$n=.09375*(3*(r$E-r$k)-r$g+(r$h=r$p[r$u+5]))),r$f=.75*(r$I-r$H)+r$b+.16666667*r$$,r$w=.75*(r$E-r$g)+r$m+.16666667*r$n,r$c+=Math.sqrt(r$f*r$f+r$w*r$w),r$f+=r$P,r$w+=r$a,r$P+=r$$,r$a+=r$n,r$c+=Math.sqrt(r$f*r$f+r$w*r$w),r$f+=r$P,r$w+=r$a,r$c+=Math.sqrt(r$f*r$f+r$w*r$w),r$f+=r$P+r$$,r$w+=r$a+r$n,r$c+=Math.sqrt(r$f*r$f+r$w*r$w),r$O[r$i]=r$c,r$H=r$X,r$g=r$h;if(r$d&&(r$o*=r$c),r$T)for(r$i=0;r$i<r$l;r$i++)r$Y[r$i]*=r$c;var r$r=this._segments,r$W=0,r$x=0;for(r$x=r$z=r$G=r$i=0;r$i<r$l;r$i++,r$G+=3)if((r$A=r$o+=r$v=r$Y[r$i])<0)this.addBeforePosition(r$A,r$p,0,r$J,r$G);else if(r$c<r$A)this.addAfterPosition(r$A-r$c,r$p,r$R-4,r$J,r$G);else{for(;;r$z++)if(!((r$B=r$O[r$z])<r$A)){0==r$z?r$A/=r$B:r$A=(r$A-(r$D=r$O[r$z-1]))/(r$B-r$D);break}if(r$z!=r$j){var r$F=6*(r$j=r$z);for(r$H=r$p[r$F],r$g=r$p[r$F+1],r$I=r$p[r$F+2],r$E=r$p[r$F+3],r$t=r$p[r$F+4],r$k=r$p[r$F+5],r$P=2*(r$b=.03*(r$H-2*r$I+r$t))+(r$$=.006*(3*(r$I-r$t)-r$H+(r$X=r$p[r$F+6]))),r$a=2*(r$m=.03*(r$g-2*r$E+r$k))+(r$n=.006*(3*(r$E-r$k)-r$g+(r$h=r$p[r$F+7]))),r$f=.3*(r$I-r$H)+r$b+.16666667*r$$,r$w=.3*(r$E-r$g)+r$m+.16666667*r$n,r$W=Math.sqrt(r$f*r$f+r$w*r$w),r$r[0]=r$W,r$F=1;r$F<8;r$F++)r$f+=r$P,r$w+=r$a,r$P+=r$$,r$a+=r$n,r$W+=Math.sqrt(r$f*r$f+r$w*r$w),r$r[r$F]=r$W;r$f+=r$P,r$w+=r$a,r$W+=Math.sqrt(r$f*r$f+r$w*r$w),r$r[8]=r$W,r$f+=r$P+r$$,r$w+=r$a+r$n,r$W+=Math.sqrt(r$f*r$f+r$w*r$w),r$r[9]=r$W,r$x=0}for(r$A*=r$W;;r$x++)if(!((r$B=r$r[r$x])<r$A)){0==r$x?r$A/=r$B:r$A=r$x+(r$A-(r$D=r$r[r$x-1]))/(r$B-r$D);break}this.addCurvePosition(.1*r$A,r$H,r$g,r$I,r$E,r$t,r$k,r$X,r$h,r$J,r$G,r$M||0<r$i&&0==r$v)}return r$J},r$S.addBeforePosition=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$Q[r$e],r$T=r$Q[r$e+1],r$U=r$Q[r$e+2]-r$d,r$i=r$Q[r$e+3]-r$T,r$R=Math.atan2(r$i,r$U);r$l[r$M]=r$d+r$S*Math.cos(r$R),r$l[r$M+1]=r$T+r$S*Math.sin(r$R),r$l[r$M+2]=r$R},r$S.addAfterPosition=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$Q[r$e+2],r$T=r$Q[r$e+3],r$U=r$d-r$Q[r$e],r$i=r$T-r$Q[r$e+1],r$R=Math.atan2(r$i,r$U);r$l[r$M]=r$d+r$S*Math.cos(r$R),r$l[r$M+1]=r$T+r$S*Math.sin(r$R),r$l[r$M+2]=r$R},r$S.addCurvePosition=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o,r$Y){0==r$S&&(r$S=1e-4);var r$p=r$S*r$S,r$J=r$p*r$S,r$L=1-r$S,r$j=r$L*r$L,r$c=r$j*r$L,r$G=r$L*r$S,r$z=3*r$G,r$A=r$L*r$z,r$v=r$z*r$S,r$D=r$Q*r$c+r$l*r$A+r$d*r$v+r$U*r$J,r$B=r$e*r$c+r$M*r$A+r$T*r$v+r$i*r$J;r$R[r$o]=r$D,r$R[r$o+1]=r$B,r$R[r$o+2]=r$Y?Math.atan2(r$B-(r$e*r$j+r$M*r$G*2+r$T*r$p),r$D-(r$Q*r$j+r$l*r$G*2+r$d*r$p)):0},r$b.NONE=-1,r$b.BEFORE=-2,r$b.AFTER=-3,r$e(r$b,["_tempMt",function(){return this._tempMt=new r$XS}]),r$b}(),r$uS=function(){function r$S(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return r$l(r$S,"laya.ani.bone.PathConstraintData"),r$S}(),r$rS=function(){function r$S(){this.name=null,this.slotArr=[]}return r$l(r$S,"laya.ani.bone.SkinData"),r$S}(),r$WS=function(){function r$S(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}r$l(r$S,"laya.ani.bone.SkinSlotDisplayData");var r$Q=r$S.prototype;return r$Q.createTexture=function(r$S){return this.texture||(this.texture=new r$hS(r$S.bitmap,this.uvs),r$S.bitmap.alphaTexture&&(this.texture.alphaTexture=new r$hS(r$S.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=r$S.height,this.texture.height=r$S.width,this.texture.offsetX=-r$S.offsetX,this.texture.offsetY=-r$S.offsetY,this.texture.sourceWidth=r$S.sourceHeight,this.texture.sourceHeight=r$S.sourceWidth):(this.texture.width=r$S.width,this.texture.height=r$S.height,this.texture.offsetX=-r$S.offsetX,this.texture.offsetY=-r$S.offsetY,this.texture.sourceWidth=r$S.sourceWidth,this.texture.sourceHeight=r$S.sourceHeight),r$c.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},r$Q.destory=function(){this.texture&&this.texture.destroy()},r$S}(),r$xS=function(){function r$S(){this.name=null,this.displayArr=[]}return r$l(r$S,"laya.ani.bone.SlotData"),r$S.prototype.getDisplayByName=function(r$S){for(var r$Q=0,r$e=this.displayArr.length;r$Q<r$e;r$Q++)if(this.displayArr[r$Q].attachmentName==r$S)return r$Q;return-1},r$S}(),r$B=function(){function r$S(r$S,r$Q){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=r$j(2,0),this._data=r$S,null==this._bones&&(this._bones=[]),this.target=r$Q[r$S.targetIndex];var r$e,r$l=0;for(r$l=0,r$e=r$S.boneIndexs.length;r$l<r$e;r$l++)this._bones.push(r$Q[r$S.boneIndexs[r$l]]);this.rotateMix=r$S.rotateMix,this.translateMix=r$S.translateMix,this.scaleMix=r$S.scaleMix,this.shearMix=r$S.shearMix}return r$l(r$S,"laya.ani.bone.TfConstraint"),r$S.prototype.apply=function(){for(var r$S,r$Q=this.target.resultMatrix.a,r$e=this.target.resultMatrix.b,r$l=this.target.resultMatrix.c,r$M=this.target.resultMatrix.d,r$d=0,r$T=this._bones.length;r$d<r$T;r$d++){if(r$S=this._bones[r$d],0<this.rotateMix){var r$U=r$S.resultMatrix.a,r$i=r$S.resultMatrix.b,r$R=r$S.resultMatrix.c,r$o=r$S.resultMatrix.d,r$Y=Math.atan2(r$l,r$Q)-Math.atan2(r$R,r$U)+this._data.offsetRotation*Math.PI/180;r$Y>Math.PI?r$Y-=2*Math.PI:r$Y<-Math.PI&&(r$Y+=2*Math.PI),r$Y*=this.rotateMix;var r$p=Math.cos(r$Y),r$J=Math.sin(r$Y);r$S.resultMatrix.a=r$p*r$U-r$J*r$R,r$S.resultMatrix.b=r$p*r$i-r$J*r$o,r$S.resultMatrix.c=r$J*r$U+r$p*r$R,r$S.resultMatrix.d=r$J*r$i+r$p*r$o}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),r$S.resultMatrix.tx+=(this._temp[0]-r$S.resultMatrix.tx)*this.translateMix,r$S.resultMatrix.ty+=(this._temp[1]-r$S.resultMatrix.ty)*this.translateMix,r$S.updateChild()),0<this.scaleMix){var r$L=Math.sqrt(r$S.resultMatrix.a*r$S.resultMatrix.a+r$S.resultMatrix.c*r$S.resultMatrix.c),r$j=Math.sqrt(r$Q*r$Q+r$l*r$l),r$c=1e-5<r$L?(r$L+(r$j-r$L+this._data.offsetScaleX)*this.scaleMix)/r$L:0;r$S.resultMatrix.a*=r$c,r$S.resultMatrix.c*=r$c,r$L=Math.sqrt(r$S.resultMatrix.b*r$S.resultMatrix.b+r$S.resultMatrix.d*r$S.resultMatrix.d),r$j=Math.sqrt(r$e*r$e+r$M*r$M),r$c=1e-5<r$L?(r$L+(r$j-r$L+this._data.offsetScaleY)*this.scaleMix)/r$L:0,r$S.resultMatrix.b*=r$c,r$S.resultMatrix.d*=r$c}if(0<this.shearMix){r$i=r$S.resultMatrix.b,r$o=r$S.resultMatrix.d;var r$G=Math.atan2(r$o,r$i);(r$Y=Math.atan2(r$M,r$e)-Math.atan2(r$l,r$Q)-(r$G-Math.atan2(r$S.resultMatrix.c,r$S.resultMatrix.a)))>Math.PI?r$Y-=2*Math.PI:r$Y<-Math.PI&&(r$Y+=2*Math.PI),r$Y=r$G+(r$Y+this._data.offsetShearY*Math.PI/180)*this.shearMix,r$c=Math.sqrt(r$i*r$i+r$o*r$o),r$S.resultMatrix.b=Math.cos(r$Y)*r$c,r$S.resultMatrix.d=Math.sin(r$Y)*r$c}}},r$S}(),r$FS=function(){function r$S(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return r$l(r$S,"laya.ani.bone.TfConstraintData"),r$S}(),r$qS=function(){function r$S(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}r$l(r$S,"laya.ani.bone.Transform");var r$Q=r$S.prototype;return r$Q.initData=function(r$S){null!=r$S.x&&(this.x=r$S.x),null!=r$S.y&&(this.y=r$S.y),null!=r$S.skX&&(this.skX=r$S.skX),null!=r$S.skY&&(this.skY=r$S.skY),null!=r$S.scX&&(this.scX=r$S.scX),null!=r$S.scY&&(this.scY=r$S.scY)},r$Q.getMatrix=function(){var r$S;return(r$S=this.mMatrix?this.mMatrix:this.mMatrix=new r$XS).identity(),r$S.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(r$S,this.skewX*Math.PI/180,this.skewY*Math.PI/180),r$S.rotate(this.skX*Math.PI/180),r$S.translate(this.x,this.y),r$S},r$Q.skew=function(r$S,r$Q,r$e){var r$l=Math.sin(r$e),r$M=Math.cos(r$e),r$d=Math.sin(r$Q),r$T=Math.cos(r$Q);return r$S.setTo(r$S.a*r$T-r$S.b*r$l,r$S.a*r$d+r$S.b*r$M,r$S.c*r$T-r$S.d*r$l,r$S.c*r$d+r$S.d*r$M,r$S.tx*r$T-r$S.ty*r$l,r$S.tx*r$d+r$S.ty*r$M),r$S},r$S}(),r$O=function(){function r$S(){}return r$l(r$S,"laya.ani.bone.UVTools"),r$S.getRelativeUV=function(r$S,r$Q,r$e){var r$l=r$S[0],r$M=r$S[2]-r$S[0],r$d=r$S[1],r$T=r$S[5]-r$S[1];r$e||(r$e=[]),r$e.length=r$Q.length;var r$U,r$i=0;r$U=r$e.length;var r$R=1/r$M,r$o=1/r$T;for(r$i=0;r$i<r$U;r$i+=2)r$e[r$i]=(r$Q[r$i]-r$l)*r$R,r$e[r$i+1]=(r$Q[r$i+1]-r$d)*r$o;return r$e},r$S.getAbsoluteUV=function(r$S,r$Q,r$e){if(0==r$S[0]&&0==r$S[1]&&1==r$S[4]&&1==r$S[5])return r$e?(r$G.copyArray(r$e,r$Q),r$e):r$Q;var r$l=r$S[0],r$M=r$S[2]-r$S[0],r$d=r$S[1],r$T=r$S[5]-r$S[1];r$e||(r$e=[]),r$e.length=r$Q.length;var r$U,r$i=0;for(r$U=r$e.length,r$i=0;r$i<r$U;r$i+=2)r$e[r$i]=r$Q[r$i]*r$M+r$l,r$e[r$i+1]=r$Q[r$i+1]*r$T+r$d;return r$e},r$S}(),r$b=function(){function r$S(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return r$l(r$S,"laya.ani.KeyFramesContent"),r$S}(),r$H=function(){function r$o(){}return r$l(r$o,"laya.ani.math.BezierLerp"),r$o.getBezierRate=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$o._getBezierParamKey(r$Q,r$e,r$l,r$M),r$T=100*r$d+r$S;if(r$o._bezierResultCache[r$T])return r$o._bezierResultCache[r$T];var r$U,r$i=r$o._getBezierPoints(r$Q,r$e,r$l,r$M,r$d),r$R=0;for(r$U=r$i.length,r$R=0;r$R<r$U;r$R+=2)if(r$S<=r$i[r$R])return r$o._bezierResultCache[r$T]=r$i[r$R+1],r$i[r$R+1];return r$o._bezierResultCache[r$T]=1},r$o._getBezierParamKey=function(r$S,r$Q,r$e,r$l){return 100*(100*(100*(100*r$S+r$Q)+r$e)+r$l)},r$o._getBezierPoints=function(r$S,r$Q,r$e,r$l,r$M){return r$o._bezierPointsCache[r$M]?r$o._bezierPointsCache[r$M]:(r$d=[0,0,r$S,r$Q,r$e,r$l,1,1],r$T=(new r$U).getBezierPoints(r$d,100,3),r$o._bezierPointsCache[r$M]=r$T);var r$d,r$T},r$o._bezierResultCache={},r$o._bezierPointsCache={},r$o}(),r$g=function(r$S){function r$Q(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,r$Q.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}r$l(r$Q,"laya.ani.AnimationPlayer",r$M);var r$e=r$Q.prototype;return r$MS.imps(r$e,{"laya.resource.IDestroy":!0}),r$e._onTempletLoadedComputeFullKeyframeIndices=function(r$S,r$Q,r$e){this._templet===r$e&&this._cachePlayRate===r$S&&this._cacheFrameRate===r$Q&&this._computeFullKeyframeIndices()},r$e._computeFullKeyframeIndices=function(){for(var r$S=this._fullFrames=[],r$Q=this._templet,r$e=this._cacheFrameRateInterval*this._cachePlayRate,r$l=0,r$M=r$Q.getAnimationCount();r$l<r$M;r$l++){for(var r$d=[],r$T=0,r$U=r$Q.getAnimation(r$l).nodes.length;r$T<r$U;r$T++){for(var r$i=r$Q.getAnimation(r$l).nodes[r$T],r$R=Math.floor(r$i.playTime/r$e+.01),r$o=new Uint16Array(r$R+1),r$Y=-1,r$p=0,r$J=r$i.keyFrame.length;r$p<r$J;r$p++){var r$L=r$i.keyFrame[r$p],r$j=r$L.startTime,r$c=r$j+r$L.duration+r$e;do{for(var r$G=Math.floor(r$j/r$e+.5),r$z=r$Y+1;r$z<r$G;r$z++)r$o[r$z]=r$p;r$o[r$Y=r$G]=r$p,r$j+=r$e}while(r$j<=r$c)}r$d.push(r$o)}r$S.push(r$d)}},r$e._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},r$e._calculatePlayDuration=function(){if(0!==this.state){var r$S=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=r$S),this._playEnd>r$S&&(this._playEnd=r$S),this._playDuration=this._playEnd-this._playStart}},r$e._setPlayParams=function(r$S,r$Q){this._currentTime=r$S,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/r$Q+.01),0),this._currentFrameTime=this._currentKeyframeIndex*r$Q},r$e._setPlayParamsWhenStop=function(r$S,r$Q){this._currentTime=r$S,this._currentKeyframeIndex=Math.max(Math.floor(r$S/r$Q+.01),0),this._currentFrameTime=this._currentKeyframeIndex*r$Q,this._currentAnimationClipIndex=-1},r$e._update=function(r$S){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var r$Q=this._cacheFrameRateInterval*this._cachePlayRate,r$e=0;this._startUpdateLoopCount!==r$L.loopCount&&(r$e=r$S*this.playbackRate,this._elapsedPlaybackTime+=r$e);var r$l=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=r$l)return this._setPlayParamsWhenStop(r$l,r$Q),void this.event("stopped");if(r$e+=this._currentTime,0<r$l)if(r$l<=r$e)do{if(r$e-=r$l,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(r$l,r$Q),this._stopWhenCircleFinish=!1,void this.event("stopped");r$e<r$l&&(this._setPlayParams(r$e,r$Q),this.event("complete"))}while(r$l<=r$e);else this._setPlayParams(r$e,r$Q);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(r$l,r$Q),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},r$e._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},r$e.play=function(r$S,r$Q,r$e,r$l,r$M){if(void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=1),void 0===r$e&&(r$e=2147483647),void 0===r$l&&(r$l=0),void 0===r$M&&(r$M=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(r$e<0||r$l<0||r$M<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==r$M&&r$M<r$l)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=r$Q,this._overallDuration=r$e,this._playStart=r$l,this._playEnd=r$M,this._paused=!1,this._currentAnimationClipIndex=r$S,this._currentKeyframeIndex=0,this._startUpdateLoopCount=r$L.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},r$e.playByFrame=function(r$S,r$Q,r$e,r$l,r$M,r$d){void 0===r$S&&(r$S=0),void 0===r$Q&&(r$Q=1),void 0===r$e&&(r$e=2147483647),void 0===r$l&&(r$l=0),void 0===r$M&&(r$M=0),void 0===r$d&&(r$d=30);var r$T=1e3/r$d;this.play(r$S,r$Q,r$e,r$l*r$T,r$M*r$T)},r$e.stop=function(r$S){void 0===r$S&&(r$S=!0),r$S?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},r$d(0,r$e,"playEnd",function(){return this._playEnd}),r$d(0,r$e,"templet",function(){return this._templet},function(r$S){0===!this.state&&this.stop(!0),this._templet!==r$S&&((this._templet=r$S).loaded?this._computeFullKeyframeIndices():r$S.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),r$d(0,r$e,"playStart",function(){return this._playStart}),r$d(0,r$e,"playDuration",function(){return this._playDuration}),r$d(0,r$e,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),r$d(0,r$e,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),r$d(0,r$e,"overallDuration",function(){return this._overallDuration}),r$d(0,r$e,"currentFrameTime",function(){return this._currentFrameTime}),r$d(0,r$e,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),r$d(0,r$e,"currentPlayTime",function(){return this._currentTime+this._playStart}),r$d(0,r$e,"cachePlayRate",function(){return this._cachePlayRate},function(r$S){this._cachePlayRate!==r$S&&(this._cachePlayRate=r$S,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[r$S,this._cacheFrameRate])))}),r$d(0,r$e,"cacheFrameRate",function(){return this._cacheFrameRate},function(r$S){this._cacheFrameRate!==r$S&&(this._cacheFrameRate=r$S,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,r$S])))}),r$d(0,r$e,"currentTime",null,function(r$S){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(r$S<this._playStart||r$S>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=r$L.loopCount;var r$Q=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=r$S,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/r$Q),0),this._currentFrameTime=this._currentKeyframeIndex*r$Q}}),r$d(0,r$e,"paused",function(){return this._paused},function(r$S){(this._paused=r$S)&&this.event("paused")}),r$d(0,r$e,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),r$d(0,r$e,"destroyed",function(){return this._destroyed}),r$Q}(),r$m=function(r$S){function r$Q(){r$Q.__super.call(this),r$c.isConchNode&&(this.drawSkin=function(r$S){r$S.transform||(r$S.transform=r$XS.EMPTY),this._addCmd([r$S]),this.setSkinMesh&&this.setSkinMesh(r$S._ps,r$S.mVBData,r$S.mEleNum,0,r$S.mTexture,r$S.transform)})}return r$l(r$Q,"laya.ani.GraphicsAni",r$T),r$Q.prototype.drawSkin=function(r$S){var r$Q=[r$S];this._saveToCmd(r$c._context._drawSkin,r$Q)},r$Q.create=function(){return r$Q._caches.pop()||new r$Q},r$Q.recycle=function(r$S){r$S.clear(),r$Q._caches.push(r$S)},r$Q._caches=[],r$Q}(),r$$=function(r$S){function r$z(){this._aniMap={},this.unfixedLastAniIndex=-1,r$z.__super.call(this),this._anis=new Array}r$l(r$z,"laya.ani.AnimationTemplet",r$o);var r$Q=r$z.prototype;return r$Q.parse=function(r$S){var r$Q=new r$kS(r$S);this._aniVersion=r$Q.readUTFString(),r$A.parse(this,r$Q)},r$Q._calculateKeyFrame=function(r$S,r$Q,r$e){var r$l=r$S.keyFrame;r$l[r$Q]=r$l[0];for(var r$M=0;r$M<r$Q;r$M++){var r$d=r$l[r$M];r$d.nextData=0===r$d.duration?r$d.data:r$l[r$M+1].data}r$l.length--},r$Q.onAsynLoaded=function(r$S,r$Q,r$e){var r$l=new r$kS(r$Q);switch(this._aniVersion=r$l.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":r$v.parse(this,r$l);break;default:r$A.parse(this,r$l)}this._endLoaded()},r$Q.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},r$Q.getAnimationCount=function(){return this._anis.length},r$Q.getAnimation=function(r$S){return this._anis[r$S]},r$Q.getAniDuration=function(r$S){return this._anis[r$S].playTime},r$Q.getNodes=function(r$S){return this._anis[r$S].nodes},r$Q.getNodeIndexWithName=function(r$S,r$Q){return this._anis[r$S].bone3DMap[r$Q]},r$Q.getNodeCount=function(r$S){return this._anis[r$S].nodes.length},r$Q.getTotalkeyframesLength=function(r$S){return this._anis[r$S].totalKeyframeDatasLength},r$Q.getPublicExtData=function(){return this._publicExtData},r$Q.getAnimationDataWithCache=function(r$S,r$Q,r$e,r$l){var r$M=r$Q[r$e];if(r$M){var r$d=r$M[r$S];return r$d?r$d[r$l]:null}return null},r$Q.setAnimationDataWithCache=function(r$S,r$Q,r$e,r$l,r$M){var r$d=r$Q[r$e]||(r$Q[r$e]={});(r$d[r$S]||(r$d[r$S]=[]))[r$l]=r$M},r$Q.getOriginalData=function(r$S,r$Q,r$e,r$l,r$M){for(var r$d=this._anis[r$S].nodes,r$T=0,r$U=0,r$i=r$d.length,r$R=0;r$U<r$i;r$U++){var r$o,r$Y=r$d[r$U];r$o=r$Y.keyFrame[r$e[r$U][r$l]],r$Y.dataOffset=r$R;var r$p=r$M-r$o.startTime,r$J=r$Y.lerpType;if(r$J)switch(r$J){case 0:case 1:for(r$T=0;r$T<r$Y.keyframeWidth;)r$T+=r$Y.interpolationMethod[r$T](r$Y,r$T,r$Q,r$R+r$T,r$o.data,r$p,null,r$o.duration,r$o.nextData);break;case 2:var r$L=r$o.interpolationData,r$j=r$L.length,r$c=0;for(r$T=0;r$T<r$j;){var r$G=r$L[r$T];switch(r$G){case 6:case 7:r$T+=r$z.interpolation[r$G](r$Y,r$c,r$Q,r$R+r$c,r$o.data,r$p,null,r$o.duration,r$o.nextData,r$L,r$T+1);break;default:r$T+=r$z.interpolation[r$G](r$Y,r$c,r$Q,r$R+r$c,r$o.data,r$p,null,r$o.duration,r$o.nextData)}r$c++}}else for(r$T=0;r$T<r$Y.keyframeWidth;)r$T+=r$Y.interpolationMethod[r$T](r$Y,r$T,r$Q,r$R+r$T,r$o.data,r$p,null,r$o.duration,r$o.nextData);r$R+=r$Y.keyframeWidth}},r$Q.getNodesCurrentFrameIndex=function(r$S,r$Q){var r$e=this._anis[r$S].nodes;r$S!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(r$e.length),this.unfixedCurrentTimes=new Float32Array(r$e.length),this.unfixedLastAniIndex=r$S);for(var r$l=0,r$M=r$e.length;r$l<r$M;r$l++){var r$d=r$e[r$l];for(r$Q<this.unfixedCurrentTimes[r$l]&&(this.unfixedCurrentFrameIndexes[r$l]=0),this.unfixedCurrentTimes[r$l]=r$Q;this.unfixedCurrentFrameIndexes[r$l]<r$d.keyFrame.length&&!(r$d.keyFrame[this.unfixedCurrentFrameIndexes[r$l]].startTime>this.unfixedCurrentTimes[r$l]);)this.unfixedCurrentFrameIndexes[r$l]++;this.unfixedCurrentFrameIndexes[r$l]--}return this.unfixedCurrentFrameIndexes},r$Q.getOriginalDataUnfixedRate=function(r$S,r$Q,r$e){var r$l=this._anis[r$S].nodes;r$S!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(r$l.length),this.unfixedCurrentTimes=new Float32Array(r$l.length),this.unfixedKeyframes=r$j(r$l.length),this.unfixedLastAniIndex=r$S);for(var r$M=0,r$d=0,r$T=r$l.length,r$U=0;r$d<r$T;r$d++){var r$i=r$l[r$d];for(r$e<this.unfixedCurrentTimes[r$d]&&(this.unfixedCurrentFrameIndexes[r$d]=0),this.unfixedCurrentTimes[r$d]=r$e;this.unfixedCurrentFrameIndexes[r$d]<r$i.keyFrame.length&&!(r$i.keyFrame[this.unfixedCurrentFrameIndexes[r$d]].startTime>this.unfixedCurrentTimes[r$d]);)this.unfixedKeyframes[r$d]=r$i.keyFrame[this.unfixedCurrentFrameIndexes[r$d]],this.unfixedCurrentFrameIndexes[r$d]++;var r$R=this.unfixedKeyframes[r$d];r$i.dataOffset=r$U;var r$o=r$e-r$R.startTime;if(r$i.lerpType)switch(r$i.lerpType){case 0:case 1:for(r$M=0;r$M<r$i.keyframeWidth;)r$M+=r$i.interpolationMethod[r$M](r$i,r$M,r$Q,r$U+r$M,r$R.data,r$o,null,r$R.duration,r$R.nextData);break;case 2:var r$Y=r$R.interpolationData,r$p=r$Y.length,r$J=0;for(r$M=0;r$M<r$p;){var r$L=r$Y[r$M];switch(r$L){case 6:case 7:r$M+=r$z.interpolation[r$L](r$i,r$J,r$Q,r$U+r$J,r$R.data,r$o,null,r$R.duration,r$R.nextData,r$Y,r$M+1);break;default:r$M+=r$z.interpolation[r$L](r$i,r$J,r$Q,r$U+r$J,r$R.data,r$o,null,r$R.duration,r$R.nextData)}r$J++}}else for(r$M=0;r$M<r$i.keyframeWidth;)r$M+=r$i.interpolationMethod[r$M](r$i,r$M,r$Q,r$U+r$M,r$R.data,r$o,null,r$R.duration,r$R.nextData);r$U+=r$i.keyframeWidth}},r$z._LinearInterpolation_0=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){var r$o=0===r$U?0:r$d/r$U;return r$e[r$l]=(1-r$o)*r$M[r$Q]+r$o*r$i[r$Q],1},r$z._QuaternionInterpolation_1=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){var r$o=0===r$U?0:r$d/r$U;return r$p.slerpQuaternionArray(r$M,r$Q,r$i,r$Q,r$o,r$e,r$l),4},r$z._AngleInterpolation_2=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){return 0},r$z._RadiansInterpolation_3=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){return 0},r$z._Matrix4x4Interpolation_4=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){for(var r$o=0;r$o<16;r$o++,r$Q++)r$e[r$l+r$o]=r$M[r$Q]+r$d*r$T[r$Q];return 16},r$z._NoInterpolation_5=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R){return r$e[r$l]=r$M[r$Q],1},r$z._BezierInterpolation_6=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o){return void 0===r$o&&(r$o=0),r$e[r$l]=r$M[r$Q]+(r$i[r$Q]-r$M[r$Q])*r$H.getBezierRate(r$d/r$U,r$R[r$o],r$R[r$o+1],r$R[r$o+2],r$R[r$o+3]),5},r$z._BezierInterpolation_7=function(r$S,r$Q,r$e,r$l,r$M,r$d,r$T,r$U,r$i,r$R,r$o){return void 0===r$o&&(r$o=0),r$e[r$l]=r$R[r$o+4]+r$R[r$o+5]*r$H.getBezierRate((.001*r$d+r$R[r$o+6])/r$R[r$o+7],r$R[r$o],r$R[r$o+1],r$R[r$o+2],r$R[r$o+3]),9},r$z.load=function(r$S){return r$MS.loader.create(r$S,null,null,r$z)},r$z.interpolation=[r$z._LinearInterpolation_0,r$z._QuaternionInterpolation_1,r$z._AngleInterpolation_2,r$z._RadiansInterpolation_3,r$z._Matrix4x4Interpolation_4,r$z._NoInterpolation_5,r$z._BezierInterpolation_6,r$z._BezierInterpolation_7],r$z}(),r$I=function(r$Q){function r$e(r$S,r$Q){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,r$e.__super.call(this),void 0===r$Q&&(r$Q=0),r$S&&this.init(r$S,r$Q)}r$l(r$e,"laya.ani.bone.Skeleton",r$Q);var r$S=r$e.prototype;return r$S.init=function(r$S,r$Q){void 0===r$Q&&(r$Q=0);var r$e,r$l,r$M,r$d=0,r$T=0;if(1==r$Q)for(this._graphicsCache=[],r$d=0,r$T=r$S.getAnimationCount();r$d<r$T;r$d++)this._graphicsCache.push([]);if(this._yReverseMatrix=r$S.yReverseMatrix,this._aniMode=r$Q,this._templet=r$S,this._player=new r$g,this._player.cacheFrameRate=r$S.rate,this._player.templet=r$S,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=r$S.mBoneArr,this._rootBone=r$S.mRootBone,this._aniSectionDic=r$S.aniSectionDic,0<r$S.ikArr.length)for(this._ikArr=[],r$d=0,r$T=r$S.ikArr.length;r$d<r$T;r$d++)this._ikArr.push(new r$z(r$S.ikArr[r$d],this._boneList));if(0<r$S.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),r$d=0,r$T=r$S.pathArr.length;r$d<r$T;r$d++)r$e=r$S.pathArr[r$d],r$l=new r$D(r$e,this._boneList),(r$M=this._boneSlotDic[r$e.name])&&((r$l=new r$D(r$e,this._boneList)).target=r$M),this._pathDic[r$e.name]=r$l;if(0<r$S.tfArr.length)for(this._tfArr=[],r$d=0,r$T=r$S.tfArr.length;r$d<r$T;r$d++)this._tfArr.push(new r$B(r$S.tfArr[r$d],this._boneList));if(0<r$S.skinDataArray.length){var r$U=this._templet.skinDataArray[this._skinIndex];this._skinName=r$U.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},r$S.load=function(r$S,r$Q,r$e){},r$S._onLoaded=function(){},r$S._parseComplete=function(){var r$S=r$E.TEMPLET_DICTIONARY[this._aniPath];r$S&&(this.init(r$S,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},r$S._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},r$S._onPlay=function(){this.event("played")},r$S._onStop=function(){var r$S,r$Q=this._templet.eventAniArr[this._aniClipIndex];if(r$Q&&this._eventIndex<r$Q.length)for(;this._eventIndex<r$Q.length;this._eventIndex++)(r$S=r$Q[this._eventIndex]).time>=this._player.playStart&&r$S.time<=this._player.playEnd&&this.event("label",r$S);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},r$S._onPause=function(){this.event("paused")},r$S._parseSrcBoneMatrix=function(){var r$S=0,r$Q=0;for(r$Q=this._templet.srcBoneMatrixArr.length,r$S=0;r$S<r$Q;r$S++)this._boneMatrixArray.push(new r$XS);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var r$e,r$l,r$M=this._templet.boneSlotArray;for(r$S=0,r$Q=r$M.length;r$S<r$Q;r$S++)r$e=r$M[r$S],null==(r$l=this._bindBoneBoneSlotDic[r$e.parent])&&(this._bindBoneBoneSlotDic[r$e.parent]=r$l=[]),this._boneSlotDic[r$e.name]=r$e=r$e.copy(),r$l.push(r$e),this._boneSlotArray.push(r$e)}},r$S._emitMissedEvents=function(r$S,r$Q,r$e){void 0===r$e&&(r$e=0);var r$l=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(r$l){var r$M,r$d,r$T=0;for(r$M=r$l.length,r$T=r$e;r$T<r$M;r$T++)(r$d=r$l[r$T]).time>=this._player.playStart&&r$d.time<=this._player.playEnd&&this.event("label",r$d)}},r$S._update=function(r$S){if(void 0===r$S&&(r$S=!0),!(this._pause||r$S&&this._indexControl)){var r$Q=this.timer.currTimer,r$e=this._player.currentKeyframeIndex,r$l=r$Q-this._lastTime;if(r$S?this._player._update(r$l):r$e=-1,this._lastTime=r$Q,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<r$l&&this._clipIndex==r$e&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var r$M;this._lastUpdateAniClipIndex=this._aniClipIndex,r$e>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var r$d,r$T=this._templet.eventAniArr[this._aniClipIndex];if(r$T&&this._eventIndex<r$T.length&&((r$M=r$T[this._eventIndex]).time>=this._player.playStart&&r$M.time<=this._player.playEnd?this._player.currentPlayTime>=r$M.time&&(this.event("label",r$M),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(r$d=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=r$d&&(this.graphics=r$d));var r$U=0,r$i=0;for(r$i=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,r$i-1)&&0<r$i;)r$i--;if(r$i<this._clipIndex)for(r$U=r$i;r$U<this._clipIndex;r$U++)this._createGraphics(r$U)}else if(1==this._aniMode){if(r$d=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=r$d&&(this.graphics=r$d));for(r$i=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,r$i-1)&&0<r$i;)r$i--;if(r$i<this._clipIndex)for(r$U=r$i;r$U<this._clipIndex;r$U++)this._createGraphics(r$U)}this._createGraphics()}}},r$S._createGraphics=function(r$S){void 0===r$S&&(r$S=-1),-1==r$S&&(r$S=this._clipIndex);var r$Q,r$e,r$l=r$S*this._player.cacheFrameRateInterval,r$M=this._templet.drawOrderAniArr[this._aniClipIndex];if(r$M&&0<r$M.length)for(this._drawOrderIndex=0,r$Q=r$M[this._drawOrderIndex];r$l>=r$Q.time&&(this._drawOrder=r$Q.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=r$M.length));)r$Q=r$M[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=r$m.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=r$m.create(),r$e=this.graphics;var r$d=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],r$S,r$l);var r$T,r$U,r$i,r$R,r$o=this._aniSectionDic[this._aniClipIndex],r$Y=0,r$p=0,r$J=0,r$L=0,r$j=0,r$c=this._templet.srcBoneMatrixArr.length;for(r$j=r$o[r$p=0];r$p<r$c;r$p++)r$R=this._boneList[r$p],r$i=this._templet.srcBoneMatrixArr[r$p],r$R.resultTransform.scX=r$i.scX*this._curOriginalData[r$Y++],r$R.resultTransform.skX=r$i.skX+this._curOriginalData[r$Y++],r$R.resultTransform.skY=r$i.skY+this._curOriginalData[r$Y++],r$R.resultTransform.scY=r$i.scY*this._curOriginalData[r$Y++],r$R.resultTransform.x=r$i.x+this._curOriginalData[r$Y++],r$R.resultTransform.y=r$i.y+this._curOriginalData[r$Y++],8===this._templet.tMatrixDataLen&&(r$R.resultTransform.skewX=r$i.skewX+this._curOriginalData[r$Y++],r$R.resultTransform.skewY=r$i.skewY+this._curOriginalData[r$Y++]);var r$G,r$z={},r$A={};for(r$j+=r$o[1];r$p<r$j;r$p++)r$z[(r$G=r$d[r$p]).name]=this._curOriginalData[r$Y++],r$A[r$G.name]=this._curOriginalData[r$Y++],this._curOriginalData[r$Y++],this._curOriginalData[r$Y++],this._curOriginalData[r$Y++],this._curOriginalData[r$Y++];var r$v,r$D,r$B={},r$O={};for(r$j+=r$o[2];r$p<r$j;r$p++)r$B[(r$G=r$d[r$p]).name]=this._curOriginalData[r$Y++],r$O[r$G.name]=this._curOriginalData[r$Y++],this._curOriginalData[r$Y++],this._curOriginalData[r$Y++],this._curOriginalData[r$Y++],this._curOriginalData[r$Y++];if(this._pathDic)for(r$j+=r$o[3];r$p<r$j;r$p++){if(r$G=r$d[r$p],r$v=this._pathDic[r$G.name])switch(new r$kS(r$G.extenData).getByte()){case 1:r$v.position=this._curOriginalData[r$Y++];break;case 2:r$v.spacing=this._curOriginalData[r$Y++];break;case 3:r$v.rotateMix=this._curOriginalData[r$Y++],r$v.translateMix=this._curOriginalData[r$Y++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(r$XS.TEMP.identity()),this._ikArr)for(r$p=0,r$j=this._ikArr.length;r$p<r$j;r$p++)r$D=this._ikArr[r$p],r$B.hasOwnProperty(r$D.name)&&(r$D.bendDirection=r$B[r$D.name]),r$O.hasOwnProperty(r$D.name)&&(r$D.mix=r$O[r$D.name]),r$D.apply();if(this._pathDic)for(var r$H in this._pathDic)(r$v=this._pathDic[r$H]).apply(this._boneList,r$e);if(this._tfArr)for(r$p=0,r$L=this._tfArr.length;r$p<r$L;r$p++)this._tfArr[r$p].apply();for(r$p=0,r$L=this._boneList.length;r$p<r$L;r$p++)if(r$R=this._boneList[r$p],r$U=this._bindBoneBoneSlotDic[r$R.name],r$R.resultMatrix.copyTo(this._boneMatrixArray[r$p]),r$U)for(r$J=0,r$j=r$U.length;r$J<r$j;r$J++)(r$T=r$U[r$J])&&r$T.setParentMatrix(r$R.resultMatrix);var r$g,r$I,r$E,r$t,r$k={},r$X=this._templet.deformAniArr;if(r$X&&0<r$X.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,r$p=0,r$j=this._boneSlotArray.length;r$p<r$j;r$p++)(r$T=this._boneSlotArray[r$p]).deformData=null;var r$h,r$b=r$X[this._aniClipIndex];for(r$h in r$g=r$b.default,this._setDeform(r$g,r$k,this._boneSlotArray,r$l),r$b)"default"!=r$h&&r$h!=this._skinName&&(r$g=r$b[r$h],this._setDeform(r$g,r$k,this._boneSlotArray,r$l));r$g=r$b[this._skinName],this._setDeform(r$g,r$k,this._boneSlotArray,r$l)}if(this._drawOrder)for(r$p=0,r$j=this._drawOrder.length;r$p<r$j;r$p++)r$I=r$z[(r$T=this._boneSlotArray[this._drawOrder[r$p]]).name],r$E=r$A[r$T.name],isNaN(r$E)||(r$e.save(),r$e.alpha(r$E)),isNaN(r$I)||-2==r$I||(this._templet.attachmentNames?r$T.showDisplayByName(this._templet.attachmentNames[r$I]):r$T.showDisplayByIndex(r$I)),r$k[this._drawOrder[r$p]]?(r$t=r$k[this._drawOrder[r$p]],r$T.currDisplayData&&r$t[r$T.currDisplayData.attachmentName]?r$T.deformData=r$t[r$T.currDisplayData.attachmentName]:r$T.deformData=null):r$T.deformData=null,isNaN(r$E)?r$T.draw(r$e,this._boneMatrixArray,2==this._aniMode):r$T.draw(r$e,this._boneMatrixArray,2==this._aniMode,r$E),isNaN(r$E)||r$e.restore();else for(r$p=0,r$j=this._boneSlotArray.length;r$p<r$j;r$p++)r$I=r$z[(r$T=this._boneSlotArray[r$p]).name],r$E=r$A[r$T.name],isNaN(r$E)||(r$e.save(),r$e.alpha(r$E)),isNaN(r$I)||-2==r$I||(this._templet.attachmentNames?r$T.showDisplayByName(this._templet.attachmentNames[r$I]):r$T.showDisplayByIndex(r$I)),r$k[r$p]?(r$t=r$k[r$p],r$T.currDisplayData&&r$t[r$T.currDisplayData.attachmentName]?r$T.deformData=r$t[r$T.currDisplayData.attachmentName]:r$T.deformData=null):r$T.deformData=null,isNaN(r$E)?r$T.draw(r$e,this._boneMatrixArray,2==this._aniMode):r$T.draw(r$e,this._boneMatrixArray,2==this._aniMode,r$E),isNaN(r$E)||r$e.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,r$S,r$e):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,r$S,r$e)},r$S._setDeform=function(r$S,r$Q,r$e,r$l){if(r$S){var r$M,r$d,r$T,r$U=0,r$i=0,r$R=0;if(r$S)for(r$U=0,r$i=r$S.deformSlotDataList.length;r$U<r$i;r$U++)for(r$M=r$S.deformSlotDataList[r$U],r$R=0;r$R<r$M.deformSlotDisplayList.length;r$R++)r$T=r$e[(r$d=r$M.deformSlotDisplayList[r$R]).slotIndex],r$d.apply(r$l,r$T),r$Q[r$d.slotIndex]||(r$Q[r$d.slotIndex]={}),r$Q[r$d.slotIndex][r$d.attachment]=r$d.deformData}},r$S.getAnimNum=function(){return this._templet.getAnimationCount()},r$S.getAniNameByIndex=function(r$S){return this._templet.getAniNameByIndex(r$S)},r$S.getSlotByName=function(r$S){return this._boneSlotDic[r$S]},r$S.showSkinByName=function(r$S,r$Q){void 0===r$Q&&(r$Q=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(r$S),r$Q)},r$S.showSkinByIndex=function(r$S,r$Q){void 0===r$Q&&(r$Q=!0);for(var r$e=0;r$e<this._boneSlotArray.length;r$e++)this._boneSlotArray[r$e].showSlotData(null,r$Q);if(this._templet.showSkinByIndex(this._boneSlotDic,r$S,r$Q)){var r$l=this._templet.skinDataArray[r$S];this._skinIndex=r$S,this._skinName=r$l.name}this._clearCache()},r$S.showSlotSkinByIndex=function(r$S,r$Q){if(0!=this._aniMode){var r$e=this.getSlotByName(r$S);r$e&&r$e.showDisplayByIndex(r$Q),this._clearCache()}},r$S.showSlotSkinByName=function(r$S,r$Q){if(0!=this._aniMode){var r$e=this.getSlotByName(r$S);r$e&&r$e.showDisplayByName(r$Q),this._clearCache()}},r$S.replaceSlotSkinName=function(r$S,r$Q,r$e){if(0!=this._aniMode){var r$l=this.getSlotByName(r$S);r$l&&r$l.replaceDisplayByName(r$Q,r$e),this._clearCache()}},r$S.replaceSlotSkinByIndex=function(r$S,r$Q,r$e){if(0!=this._aniMode){var r$l=this.getSlotByName(r$S);r$l&&r$l.replaceDisplayByIndex(r$Q,r$e),this._clearCache()}},r$S.setSlotSkin=function(r$S,r$Q){if(0!=this._aniMode){var r$e=this.getSlotByName(r$S);r$e&&r$e.replaceSkin(r$Q),this._clearCache()}},r$S._clearCache=function(){if(1==this._aniMode)for(var r$S=0,r$Q=this._graphicsCache.length;r$S<r$Q;r$S++){for(var r$e=0,r$l=this._graphicsCache[r$S].length;r$e<r$l;r$e++){var r$M=this._graphicsCache[r$S][r$e];r$M!=this.graphics&&r$m.recycle(r$M)}this._graphicsCache[r$S].length=0}},r$S.play=function(r$S,r$Q,r$e,r$l,r$M,r$d){void 0===r$e&&(r$e=!0),void 0===r$l&&(r$l=0),void 0===r$M&&(r$M=0),void 0===r$d&&(r$d=!0),this._indexControl=!1;var r$T=-1,r$U=NaN;if(r$U=r$Q?2147483647:0,"string"==typeof r$S)for(var r$i=0,r$R=this._templet.getAnimationCount();r$i<r$R;r$i++){var r$o=this._templet.getAnimation(r$i);if(r$o&&r$S==r$o.name){r$T=r$i;break}}else r$T=r$S;-1<r$T&&r$T<this.getAnimNum()&&(this._aniClipIndex=r$T,(r$e||this._pause||this._currAniIndex!=r$T)&&(this._currAniIndex=r$T,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(r$T)),this._drawOrder=null,this._eventIndex=0,this._player.play(r$T,this._player.playbackRate,r$U,r$l,r$M),r$d&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=r$Y.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},r$S.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},r$S.playbackRate=function(r$S){this._player&&(this._player.playbackRate=r$S)},r$S.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},r$S.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=r$Y.now(),this.timer.frameLoop(1,this,this._update,null,!0))},r$S._getGrahicsDataWithCache=function(r$S,r$Q){return this._graphicsCache[r$S][r$Q]},r$S._setGrahicsDataWithCache=function(r$S,r$Q,r$e){this._graphicsCache[r$S][r$Q]=r$e},r$S.destroy=function(r$S){void 0===r$S&&(r$S=!0),r$Q.prototype.destroy.call(this,r$S),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},r$d(0,r$S,"url",function(){return this._aniPath},function(r$S){this.load(r$S)}),r$d(0,r$S,"index",function(){return this._index},function(r$S){this.player&&(this._index=r$S,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),r$d(0,r$S,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),r$d(0,r$S,"templet",function(){return this._templet}),r$d(0,r$S,"player",function(){return this._player}),r$e.useSimpleMeshInCanvas=!1,r$e}(r$dS),r$E=function(r$Q){function r$M(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,r$M.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}r$l(r$M,"laya.ani.bone.Templet",r$Q);var r$S=r$M.prototype;return r$S.getLoadList=function(){return this._loadList},r$S.loadAni=function(r$S){this._skBufferUrl=r$S,r$MS.loader.load(r$S,r$i.create(this,this.onComplete),null,"arraybuffer")},r$S.onComplete=function(r$S){if(this._isDestroyed)this.destroy();else{var r$Q=r$R.getRes(this._skBufferUrl);r$Q?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,r$Q)):this.event("error","load failed:"+this._skBufferUrl)}},r$S.parseData=function(r$S,r$Q,r$e){void 0===r$e&&(r$e=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=r$S,this._mainTexture&&r$c.isWebGL&&r$S.bitmap&&(r$S.bitmap.enableMerageInAtlas=!1),this._rate=r$e,this.parse(r$Q)},r$S.buildArmature=function(r$S){return void 0===r$S&&(r$S=0),new r$I(this,r$S)},r$S.parse=function(r$S){r$Q.prototype.parse.call(this,r$S),this._endLoaded(),this._aniVersion!=r$M.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+r$M.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},r$S._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var r$S=0;this._loadList=[];var r$Q,r$e=new r$kS(this.getPublicExtData()),r$l=0,r$M=0,r$d=0,r$T=r$e.getInt32(),r$U=r$e.readUTFString(),r$i=r$U.split("\n");for(r$S=0;r$S<r$T;r$S++)r$Q=this._path+r$i[2*r$S],r$U=r$i[2*r$S+1],r$e.getFloat32(),r$e.getFloat32(),r$l=r$e.getFloat32(),r$M=r$e.getFloat32(),r$d=r$e.getFloat32(),isNaN(r$d)?0:r$d,r$d=r$e.getFloat32(),isNaN(r$d)?0:r$d,r$d=r$e.getFloat32(),isNaN(r$d)?r$l:r$d,r$d=r$e.getFloat32(),isNaN(r$d)?r$M:r$d,-1==this._loadList.indexOf(r$Q)&&this._loadList.push(r$Q);this.event("inited",this)}},r$S._textureComplete=function(){for(var r$S,r$Q,r$e=0,r$l=this._loadList.length;r$e<r$l;r$e++)r$Q=this._loadList[r$e],r$S=this._textureDic[r$Q]=r$R.getRes(r$Q),r$c.isWebGL&&r$S&&r$S.bitmap&&(r$S.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},r$S._parsePublicExtData=function(){var r$S=0,r$Q=0,r$e=0,r$l=0,r$M=0;for(r$S=0,r$M=this.getAnimationCount();r$S<r$M;r$S++)this._graphicsCache.push([]);var r$d;r$d="Dragon"!=this._aniClassName;var r$T,r$U,r$i=new r$kS(this.getPublicExtData()),r$R=0,r$o=0,r$Y=0,r$p=0,r$J=0,r$L=0,r$j=0,r$c=0,r$G=0,r$z=r$i.getInt32(),r$A=r$i.readUTFString(),r$v=r$A.split("\n");for(r$S=0;r$S<r$z;r$S++){if(r$T=this._mainTexture,r$U=this._path+r$v[2*r$S],r$A=r$v[2*r$S+1],null==this._mainTexture&&(r$T=this._textureDic[r$U]),!r$T)return this.event("error",this),void(this.isParseFail=!0);r$R=r$i.getFloat32(),r$o=r$i.getFloat32(),r$Y=r$i.getFloat32(),r$p=r$i.getFloat32(),r$G=r$i.getFloat32(),r$J=isNaN(r$G)?0:r$G,r$G=r$i.getFloat32(),r$L=isNaN(r$G)?0:r$G,r$G=r$i.getFloat32(),r$j=isNaN(r$G)?r$Y:r$G,r$G=r$i.getFloat32(),r$c=isNaN(r$G)?r$p:r$G,this.subTextureDic[r$A]=r$hS.create(r$T,r$R,r$o,r$Y,r$p,-r$J,-r$L,r$j,r$c),r$T.alphaTexture&&(this.subTextureDic[r$A].alphaTexture=r$hS.create(r$T.alphaTexture,r$R,r$o,r$Y,r$p,-r$J,-r$L,r$j,r$c))}this._mainTexture=r$T;var r$D,r$B,r$O,r$H,r$g,r$I=r$i.getUint16();for(r$S=0;r$S<r$I;r$S++)(r$D=[]).push(r$i.getUint16()),r$D.push(r$i.getUint16()),r$D.push(r$i.getUint16()),r$D.push(r$i.getUint16()),this.aniSectionDic[r$S]=r$D;var r$E,r$t=r$i.getInt16(),r$k={};for(r$S=0;r$S<r$t;r$S++)r$B=new r$bS,0==r$S?r$E=r$B:r$B.root=r$E,r$B.d=r$d?-1:1,r$H=r$i.readUTFString(),r$g=r$i.readUTFString(),r$B.length=r$i.getFloat32(),1==r$i.getByte()&&(r$B.inheritRotation=!1),1==r$i.getByte()&&(r$B.inheritScale=!1),r$B.name=r$H,r$g&&((r$O=r$k[r$g])?r$O.addChild(r$B):this.mRootBone=r$B),r$k[r$H]=r$B,this.mBoneArr.push(r$B);this.tMatrixDataLen=r$i.getUint16();var r$X,r$h,r$b=r$i.getUint16(),r$m=Math.floor(r$b/this.tMatrixDataLen),r$$=this.srcBoneMatrixArr;for(r$S=0;r$S<r$m;r$S++)(r$X=new r$qS).scX=r$i.getFloat32(),r$X.skX=r$i.getFloat32(),r$X.skY=r$i.getFloat32(),r$X.scY=r$i.getFloat32(),r$X.x=r$i.getFloat32(),r$X.y=r$i.getFloat32(),8===this.tMatrixDataLen&&(r$X.skewX=r$i.getFloat32(),r$X.skewY=r$i.getFloat32()),r$$.push(r$X),(r$B=this.mBoneArr[r$S]).transform=r$X;var r$n,r$P=r$i.getUint16(),r$a=0;for(r$S=0;r$S<r$P;r$S++){for(r$h=new r$wS,r$a=r$i.getUint16(),r$Q=0;r$Q<r$a;r$Q++)r$h.boneNames.push(r$i.readUTFString()),r$h.boneIndexs.push(r$i.getInt16());r$h.name=r$i.readUTFString(),r$h.targetBoneName=r$i.readUTFString(),r$h.targetBoneIndex=r$i.getInt16(),r$h.bendDirection=r$i.getFloat32(),r$h.mix=r$i.getFloat32(),r$h.isSpine=r$d,this.ikArr.push(r$h)}var r$f,r$w=r$i.getUint16(),r$u=0;for(r$S=0;r$S<r$w;r$S++){for(r$n=new r$FS,r$u=r$i.getUint16(),r$Q=0;r$Q<r$u;r$Q++)r$n.boneIndexs.push(r$i.getInt16());r$n.name=r$i.getUTFString(),r$n.targetIndex=r$i.getInt16(),r$n.rotateMix=r$i.getFloat32(),r$n.translateMix=r$i.getFloat32(),r$n.scaleMix=r$i.getFloat32(),r$n.shearMix=r$i.getFloat32(),r$n.offsetRotation=r$i.getFloat32(),r$n.offsetX=r$i.getFloat32(),r$n.offsetY=r$i.getFloat32(),r$n.offsetScaleX=r$i.getFloat32(),r$n.offsetScaleY=r$i.getFloat32(),r$n.offsetShearY=r$i.getFloat32(),this.tfArr.push(r$n)}var r$r=r$i.getUint16(),r$W=0;for(r$S=0;r$S<r$r;r$S++){for((r$f=new r$uS).name=r$i.readUTFString(),r$W=r$i.getUint16(),r$Q=0;r$Q<r$W;r$Q++)r$f.bones.push(r$i.getInt16());r$f.target=r$i.readUTFString(),r$f.positionMode=r$i.readUTFString(),r$f.spacingMode=r$i.readUTFString(),r$f.rotateMode=r$i.readUTFString(),r$f.offsetRotation=r$i.getFloat32(),r$f.position=r$i.getFloat32(),r$f.spacing=r$i.getFloat32(),r$f.rotateMix=r$i.getFloat32(),r$f.translateMix=r$i.getFloat32(),this.pathArr.push(r$f)}var r$x,r$F,r$q,r$Z,r$N,r$C=0,r$K=0,r$V=0,r$_=NaN,r$s=0,r$y=r$i.getInt16();for(r$S=0;r$S<r$y;r$S++){var r$SS=r$i.getUint8(),r$QS={};this.deformAniArr.push(r$QS);for(var r$eS=0;r$eS<r$SS;r$eS++)for((r$x=new r$$S).skinName=r$i.getUTFString(),r$QS[r$x.skinName]=r$x,r$C=r$i.getInt16(),r$Q=0;r$Q<r$C;r$Q++)for(r$F=new r$nS,r$x.deformSlotDataList.push(r$F),r$K=r$i.getInt16(),r$e=0;r$e<r$K;r$e++)for(r$q=new r$PS,r$F.deformSlotDisplayList.push(r$q),r$q.slotIndex=r$i.getInt16(),r$q.attachment=r$i.getUTFString(),r$V=r$i.getInt16(),r$l=0;r$l<r$V;r$l++)for(1==r$i.getByte()?r$q.tweenKeyList.push(!0):r$q.tweenKeyList.push(!1),r$_=r$i.getFloat32(),r$q.timeList.push(r$_),r$Z=[],r$q.vectices.push(r$Z),r$s=r$i.getInt16(),r$M=0;r$M<r$s;r$M++)r$Z.push(r$i.getFloat32())}var r$lS,r$MS,r$dS=r$i.getInt16(),r$TS=0,r$US=0;for(r$S=0;r$S<r$dS;r$S++){for(r$TS=r$i.getInt16(),r$N=[],r$Q=0;r$Q<r$TS;r$Q++){for((r$lS=new r$aS).time=r$i.getFloat32(),r$US=r$i.getInt16(),r$e=0;r$e<r$US;r$e++)r$lS.drawOrder.push(r$i.getInt16());r$N.push(r$lS)}this.drawOrderAniArr.push(r$N)}var r$iS,r$RS=r$i.getInt16(),r$oS=0;for(r$S=0;r$S<r$RS;r$S++){for(r$oS=r$i.getInt16(),r$MS=[],r$Q=0;r$Q<r$oS;r$Q++)(r$iS=new r$fS).name=r$i.getUTFString(),r$iS.intValue=r$i.getInt32(),r$iS.floatValue=r$i.getFloat32(),r$iS.stringValue=r$i.getUTFString(),r$iS.time=r$i.getFloat32(),r$MS.push(r$iS);this.eventAniArr.push(r$MS)}var r$YS=r$i.getInt16();if(0<r$YS)for(this.attachmentNames=[],r$S=0;r$S<r$YS;r$S++)this.attachmentNames.push(r$i.getUTFString());var r$pS,r$JS,r$LS=r$i.getInt16();for(r$S=0;r$S<r$LS;r$S++)(r$pS=new r$mS).name=r$i.readUTFString(),r$pS.parent=r$i.readUTFString(),r$pS.attachmentName=r$i.readUTFString(),r$pS.srcDisplayIndex=r$pS.displayIndex=r$i.getInt16(),(r$pS.templet=this).boneSlotDic[r$pS.name]=r$pS,null==(r$JS=this.bindBoneBoneSlotDic[r$pS.parent])&&(this.bindBoneBoneSlotDic[r$pS.parent]=r$JS=[]),r$JS.push(r$pS),this.boneSlotArray.push(r$pS);var r$jS,r$cS,r$GS,r$zS=r$i.readUTFString().split("\n"),r$AS=0,r$vS=r$i.getUint8(),r$DS=0,r$BS=0,r$OS=0,r$HS=0,r$gS=0,r$IS=0,r$ES=0;for(r$S=0;r$S<r$vS;r$S++){for((r$jS=new r$rS).name=r$zS[r$AS++],r$DS=r$i.getUint8(),r$Q=0;r$Q<r$DS;r$Q++){for((r$cS=new r$xS).name=r$zS[r$AS++],r$pS=this.boneSlotDic[r$cS.name],r$BS=r$i.getUint8(),r$e=0;r$e<r$BS;r$e++){if(r$GS=new r$WS,this.skinSlotDisplayDataArr.push(r$GS),r$GS.name=r$zS[r$AS++],r$GS.attachmentName=r$zS[r$AS++],r$GS.transform=new r$qS,r$GS.transform.scX=r$i.getFloat32(),r$GS.transform.skX=r$i.getFloat32(),r$GS.transform.skY=r$i.getFloat32(),r$GS.transform.scY=r$i.getFloat32(),r$GS.transform.x=r$i.getFloat32(),r$GS.transform.y=r$i.getFloat32(),r$cS.displayArr.push(r$GS),r$GS.width=r$i.getFloat32(),r$GS.height=r$i.getFloat32(),r$GS.type=r$i.getUint8(),r$GS.verLen=r$i.getUint16(),0<(r$t=r$i.getUint16()))for(r$GS.bones=[],r$l=0;r$l<r$t;r$l++){var r$tS=r$i.getUint16();r$GS.bones.push(r$tS)}if(0<(r$OS=r$i.getUint16()))for(r$GS.uvs=[],r$l=0;r$l<r$OS;r$l++)r$GS.uvs.push(r$i.getFloat32());if(0<(r$HS=r$i.getUint16()))for(r$GS.weights=[],r$l=0;r$l<r$HS;r$l++)r$GS.weights.push(r$i.getFloat32());if(0<(r$gS=r$i.getUint16()))for(r$GS.triangles=[],r$l=0;r$l<r$gS;r$l++)r$GS.triangles.push(r$i.getUint16());if(0<(r$IS=r$i.getUint16()))for(r$GS.vertices=[],r$l=0;r$l<r$IS;r$l++)r$GS.vertices.push(r$i.getFloat32());if(0<(r$ES=r$i.getUint16()))for(r$GS.lengths=[],r$l=0;r$l<r$ES;r$l++)r$GS.lengths.push(r$i.getFloat32())}r$jS.slotArr.push(r$cS)}this.skinDic[r$jS.name]=r$jS,this.skinDataArray.push(r$jS)}1==r$i.getUint8()?(this.yReverseMatrix=new r$XS(1,0,0,-1,0,0),r$E&&r$E.setTempMatrix(this.yReverseMatrix)):r$E&&r$E.setTempMatrix(new r$XS),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},r$S.getTexture=function(r$S){var r$Q=this.subTextureDic[r$S];return r$Q||(r$Q=this.subTextureDic[r$S.substr(0,r$S.length-1)]),null==r$Q?this._mainTexture:r$Q},r$S.showSkinByIndex=function(r$S,r$Q,r$e){if(void 0===r$e&&(r$e=!0),r$Q<0&&r$Q>=this.skinDataArray.length)return!1;var r$l,r$M,r$d=0,r$T=0,r$U=this.skinDataArray[r$Q];if(r$U){for(r$d=0,r$T=r$U.slotArr.length;r$d<r$T;r$d++)(r$M=r$U.slotArr[r$d])&&(r$l=r$S[r$M.name])&&(r$l.showSlotData(r$M,r$e),r$e&&"undefined"!=r$l.attachmentName&&"null"!=r$l.attachmentName?r$l.showDisplayByName(r$l.attachmentName):r$l.showDisplayByIndex(r$l.displayIndex));return!0}return!1},r$S.getSkinIndexByName=function(r$S){for(var r$Q=0,r$e=this.skinDataArray.length;r$Q<r$e;r$Q++)if(this.skinDataArray[r$Q].name==r$S)return r$Q;return-1},r$S.getGrahicsDataWithCache=function(r$S,r$Q){return this._graphicsCache[r$S][r$Q]},r$S.setGrahicsDataWithCache=function(r$S,r$Q,r$e){this._graphicsCache[r$S][r$Q]=r$e},r$S.destroy=function(){var r$S;for(var r$Q in this._isDestroyed=!0,this.subTextureDic)(r$S=this.subTextureDic[r$Q])&&r$S.destroy();for(r$Q in this._textureDic)(r$S=this._textureDic[r$Q])&&r$S.destroy();for(var r$e=0,r$l=this.skinSlotDisplayDataArr.length;r$e<r$l;r$e++)this.skinSlotDisplayDataArr[r$e].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete r$M.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},r$S.getAniNameByIndex=function(r$S){var r$Q=this.getAnimation(r$S);return r$Q?r$Q.name:null},r$d(0,r$S,"rate",function(){return this._rate},function(r$S){this._rate=r$S}),r$M.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",r$M.TEMPLET_DICTIONARY=null,r$M}(r$$)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(r$S,r$Q){"use strict";for(var r$e in Object.defineProperty(r$Q,"__esModule",{value:!0}),Laya){var r$l=Laya[r$e];r$l&&r$l.__isclass&&(r$Q[r$e]=r$l)}});