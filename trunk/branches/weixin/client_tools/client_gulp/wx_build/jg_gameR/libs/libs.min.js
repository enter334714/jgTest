var Laya=window.Laya=function(X$K,X$m){var X$D={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(X$m,X$p){return 1==arguments.length?X$D.__presubstr.call(this,X$m):X$D.__presubstr.call(this,X$m,0<X$p?X$p:this.length+X$p)},__init:function(X$m){X$m.forEach(function(X$m){X$m.__init$&&X$m.__init$()})},__isClass:function(X$m){return X$m&&(X$m.__isclass||X$m==Object||X$m==String||X$m==Array)},__newvec:function(X$m,X$p){var X$h=[];X$h.length=X$m;for(var X$P=0;X$P<X$m;X$P++)X$h[X$P]=X$p;return X$h},__extend:function(X$m,X$p){for(var X$h in X$p)if(X$p.hasOwnProperty(X$h)){var X$P=Object.getOwnPropertyDescriptor(X$p,X$h),X$L=X$P.get,X$q=X$P.set;X$L||X$q?X$L&&X$q?Object.defineProperty(X$m,X$h,X$P):(X$L&&Object.defineProperty(X$m,X$h,X$L),X$q&&Object.defineProperty(X$m,X$h,X$q)):X$m[X$h]=X$p[X$h]}function X$k(){X$D.un(this,"constructor",X$m)}X$k.prototype=X$p.prototype,X$m.prototype=new X$k,X$D.un(X$m.prototype,"__imps",X$D.__copy({},X$p.prototype.__imps))},__copy:function(X$m,X$p){if(!X$p)return null;for(var X$h in X$m=X$m||{},X$p)X$m[X$h]=X$p[X$h];return X$m},__package:function(X$m,X$p){if(!X$D.__packages[X$m]){X$D.__packages[X$m]=!0;var X$h=X$K,X$P=X$m.split(".");if(1<X$P.length)for(var X$L=0,X$q=X$P.length-1;X$L<X$q;X$L++){var X$k=X$h[X$P[X$L]];X$h=X$k||(X$h[X$P[X$L]]={})}X$h[X$P[X$P.length-1]]||(X$h[X$P[X$P.length-1]]=X$p||{})}},__hasOwnProperty:function(X$m,X$p){return X$p=X$p||this,Object.hasOwnProperty.call(X$p,X$m)||function X$m(X$p,X$h){if(Object.hasOwnProperty.call(X$h.prototype,X$p))return!0;var X$P=X$h.prototype.__super;return null==X$P?null:X$m(X$p,X$P)}(X$m,X$p.__class)},__typeof:function(X$m,X$p){if(!X$m||!X$p)return!1;if(X$p===String)return"string"==typeof X$m;if(X$p===Number)return"number"==typeof X$m;if(X$p.__interface__)X$p=X$p.__interface__;else if("string"!=typeof X$p)return X$m instanceof X$p;return X$m.__imps&&X$m.__imps[X$p]||X$m.__class==X$p},__as:function(X$m,X$p){return this.__typeof(X$m,X$p)?X$m:null},__int:function(X$m){return X$m?parseInt(X$m):0},interface:function(X$m,X$p){X$D.__package(X$m,{});var X$h=X$D.__internals,X$P=X$h[X$m]=X$h[X$m]||{self:X$m};if(X$p){var X$L=X$p.split(",");X$P.extend=[];for(var X$q=0;X$q<X$L.length;X$q++){var X$k=X$L[X$q];X$h[X$k]=X$h[X$k]||{self:X$k},X$P.extend.push(X$h[X$k])}}var X$Y=X$K,X$d=X$m.split(".");for(X$q=0;X$q<X$d.length-1;X$q++)X$Y=X$Y[X$d[X$q]];X$Y[X$d[X$d.length-1]]={__interface__:X$m}},class:function(X$m,X$p,X$h,X$P){if(X$h&&X$D.__extend(X$m,X$h),X$p)if(X$D.__package(X$p,X$m),X$D.__classmap[X$p]=X$m,0<X$p.indexOf(".")){if(0==X$p.indexOf("laya.")){var X$L=X$p.split(".");X$P=X$P||X$L[X$L.length-1],X$D[X$P]&&console.log("Warning!,this class["+X$P+"] already exist:",X$D[X$P]),X$D[X$P]=X$m}}else"Main"==X$p?X$K.Main=X$m:"MainWX"==X$p?X$K.MainWX=X$m:(X$D[X$p]&&console.log("Error!,this class["+X$p+"] already exist:",X$D[X$p]),X$D[X$p]=X$m);var X$q=X$D.un,X$k=X$m.prototype;X$q(X$k,"hasOwnProperty",X$D.__hasOwnProperty),X$q(X$k,"__class",X$m),X$q(X$k,"__super",X$h),X$q(X$k,"__className",X$p),X$q(X$m,"__super",X$h),X$q(X$m,"__className",X$p),X$q(X$m,"__isclass",!0),X$q(X$m,"super",function(X$m){this.__super.call(X$m)})},imps:function(X$m,X$p){if(!X$p)return null;var X$L=X$m.__imps||X$D.un(X$m,"__imps",{});function X$q(X$m){var X$p,X$h;if((X$p=X$D.__internals[X$m])&&(X$L[X$m]=!0,X$h=X$p.extend))for(var X$P=0;X$P<X$h.length;X$P++)X$q(X$h[X$P].self)}for(var X$h in X$p)X$q(X$h)},superSet:function(X$m,X$p,X$h,X$P){var X$L=X$m.prototype["_$set_"+X$h];X$L&&X$L.call(X$p,X$P)},superGet:function(X$m,X$p,X$h){var X$P=X$m.prototype["_$get_"+X$h];return X$P?X$P.call(X$p):null},getset:function(X$m,X$p,X$h,X$P,X$L){X$m?(X$P&&(X$p["_$GET_"+X$h]=X$P),X$L&&(X$p["_$SET_"+X$h]=X$L)):(X$P&&X$D.un(X$p,"_$get_"+X$h,X$P),X$L&&X$D.un(X$p,"_$set_"+X$h,X$L)),X$P&&X$L?Object.defineProperty(X$p,X$h,{get:X$P,set:X$L,enumerable:!1,configurable:!0}):(X$P&&Object.defineProperty(X$p,X$h,{get:X$P,enumerable:!1,configurable:!0}),X$L&&Object.defineProperty(X$p,X$h,{set:X$L,enumerable:!1,configurable:!0}))},static:function(X$h,X$P){for(var X$L=0,X$m=X$P.length;X$L<X$m;X$L+=2)if("length"==X$P[X$L])X$h.length=X$P[X$L+1].call(X$h);else{function X$p(){var X$p=X$P[X$L],X$m=X$P[X$L+1];Object.defineProperty(X$h,X$p,{get:function(){return delete this[X$p],this[X$p]=X$m.call(this)},set:function(X$m){delete this[X$p],this[X$p]=X$m},enumerable:!0,configurable:!0})}X$p()}},un:function(X$m,X$p,X$h){return X$h||(X$h=X$m[X$p]),X$D.__propun.value=X$h,Object.defineProperty(X$m,X$p,X$D.__propun),X$h},uns:function(X$p,X$m){X$m.forEach(function(X$m){X$D.un(X$p,X$m)})}};return X$K.console=X$K.console||{log:function(){}},X$K.trace=X$K.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),X$D}(window,document);!function(X$m,X$p,X$h){X$h.un,X$h.uns,X$h.static,X$h.class,X$h.getset,X$h.__newvec}(window,document,Laya),function(X$k,X$p,X$E){X$E.un,X$E.uns;var X$d=X$E.static,X$D=X$E.class,X$A=X$E.getset;X$E.__newvec;X$E.interface("laya.runtime.IMarket"),X$E.interface("laya.filters.IFilter"),X$E.interface("laya.display.ILayout"),X$E.interface("laya.resource.IDispose"),X$E.interface("laya.runtime.IPlatform"),X$E.interface("laya.resource.IDestroy"),X$E.interface("laya.runtime.IConchNode"),X$E.interface("laya.filters.IFilterAction"),X$E.interface("laya.runtime.ICPlatformClass"),X$E.interface("laya.resource.ICreateResource"),X$E.interface("laya.runtime.IConchRenderObject"),X$E.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var X$Q=function(){function X$q(){}return X$D(X$q,"laya.utils.RunDriver"),X$q.FILTER_ACTIONS=[],X$q.pixelRatio=-1,X$q._charSizeTestDiv=null,X$q.now=function(){return Date.now()},X$q.getWindow=function(){return X$k},X$q.getPixelRatio=function(){if(X$q.pixelRatio<0){var X$m=X$w.context,X$p=X$m.backingStorePixelRatio||X$m.webkitBackingStorePixelRatio||X$m.mozBackingStorePixelRatio||X$m.msBackingStorePixelRatio||X$m.oBackingStorePixelRatio||X$m.backingStorePixelRatio||1;(X$q.pixelRatio=(X$w.window.devicePixelRatio||1)/X$p)<1&&(X$q.pixelRatio=1)}return X$q.pixelRatio},X$q.getIncludeStr=function(X$m){return null},X$q.createShaderCondition=function(X$m){var X$p="(function() {return "+X$m+";})";return X$E._runScript(X$p)},X$q.fontMap=[],X$q.measureText=function(X$m,X$p){var X$h=X$q.hanzi.test(X$m);if(X$h&&X$q.fontMap[X$p])return X$q.fontMap[X$p];var X$P=X$w.context;X$P.font=X$p;var X$L=X$P.measureText(X$m);return X$L||(X$L={width:16,height:16}),X$h&&(X$q.fontMap[X$p]=X$L),X$L},X$q.getWebGLContext=function(X$m){},X$q.beginFlush=function(){},X$q.endFinish=function(){},X$q.addToAtlas=null,X$q.flashFlushImage=function(X$m){},X$q.drawToCanvas=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=X$am.create("2D"),X$Y=new X$_(X$h,X$P,X$k);return X$l.renders[X$p]._fun(X$m,X$Y,X$L,X$q),X$k},X$q.createParticleTemplate2D=null,X$q.createGLTextur=null,X$q.createWebGLContext2D=null,X$q.changeWebGLSize=function(X$m,X$p){},X$q.createRenderSprite=function(X$m,X$p){return new X$l(X$m,X$p)},X$q.createFilterAction=function(X$m){return new X$a},X$q.createGraphics=function(){return new X$R},X$q.clear=function(X$m){X$S._context.ctx.clear()},X$q.cancelLoadByUrl=function(X$m){},X$q.clearAtlas=function(X$m){},X$q.isAtlas=function(X$m){return!1},X$q.addTextureToAtlas=function(X$m){},X$q.getTexturePixels=function(X$m,X$p,X$h,X$P,X$L){return null},X$q.skinAniSprite=function(){return null},X$q.update3DLoop=function(){},X$d(X$q,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),X$q}(),X$P=(X$A(1,X$E,"alertGlobalError",null,function(X$m){var X$q=0;X$w.window.onerror=X$m?function(X$m,X$p,X$h,X$P,X$L){X$q++<5&&X$L&&alert(X$L.stack||X$L)}:null}),X$E.init=function(X$m,X$p,X$h){for(var X$P=[],X$L=2,X$q=arguments.length;X$L<X$q;X$L++)X$P.push(arguments[X$L]);if(!X$E._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=X$E._arrayBufferSlice),X$E._isinit=!0,X$w.__init__(),X$J.__init__(),X$R.__init__(),X$E.timer=new X$i,X$E.scaleTimer=new X$i,X$E.loader=new X$dm,X$O.__init__(),X$L=0;for(var X$k=X$P.length;X$L<X$k;X$L++)X$P[X$L].enable&&X$P[X$L].enable();return X$$.__init__(),X$Y.__init__(),X$z.__init__(),X$s.beginCheck(),X$E._currentStage=X$E.stage=new X$cm,X$E.stage.conchModel&&X$E.stage.conchModel.setRootNode(),X$E._getUrlPath(),X$E.render=new X$S(0,0),X$E.stage.size(X$m,X$p),X$l.__init__(),X$F.__init__(),X$B.instance.__init__(X$E.stage,X$S.canvas),X$Hm.__init__(),X$x.autoStopMusic=!0,X$T.__init__(),X$S.canvas}},X$E._getUrlPath=function(){var X$m=X$w.window.location,X$p=X$m.pathname;X$p=X$p&&":"==X$p.charAt(2)?X$p.substring(1):X$p,X$N.rootPath=X$N.basePath=X$N.getPath("file:"==X$m.protocol?X$p:X$m.protocol+"//"+X$m.host+X$m.pathname)},X$E._arrayBufferSlice=function(X$m,X$p){var X$h=new Uint8Array(this,X$m,X$p-X$m),X$P=new Uint8Array(X$h.length);return X$P.set(X$h),X$P.buffer},X$E._runScript=function(X$m){return X$w.window[X$E._evcode](X$m)},X$E.stage=null,X$E.timer=null,X$E.scaleTimer=null,X$E.loader=null,X$E.version="1.8.6",X$E.render=null,X$E._currentStage=null,X$E._isinit=!1,X$E.isDebug=!1,X$E.MiniAdpter={init:function(){X$k.navigator&&X$k.navigator.userAgent&&-1<X$k.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},X$d(X$E,["conchMarket",function(){return this.conchMarket=X$k.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=X$k.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function X$m(){}return X$D(X$m,"Config"),X$m.WebGLTextCacheCount=500,X$m.atlasEnable=!1,X$m.showCanvasMark=!1,X$m.animationInterval=50,X$m.isAntialias=!1,X$m.isAlpha=!1,X$m.premultipliedAlpha=!0,X$m.isStencil=!0,X$m.preserveDrawingBuffer=!1,X$m}()),X$K=function(){function X$K(){this._events=null}X$D(X$K,"laya.events.EventDispatcher");var X$m=X$K.prototype;return X$m.hasListener=function(X$m){return!!(this._events&&this._events[X$m])},X$m.getListener=function(X$m){return this._events?this._events[X$m]:null},X$m.event=function(X$m,X$p){if(!this._events||!this._events[X$m])return!1;var X$h=this._events[X$m];if(X$h.lock)X$h.queue||(X$h.queue=[]),X$h.queue.push(X$p);else{var X$P;for(X$h.lock=!0,X$h.cursor=X$h.head;X$h.cursor;)(X$P=X$h.cursor).recover?(X$h.head=X$h.tail=X$h.cursor=null,console.error("node is recover："+X$P.id)):(X$h.cursor=X$P.next,X$P.once&&X$K.delNode(X$h,X$P),X$P.method&&(null!=X$p?X$P.args?X$P.method.apply(X$P.caller,X$P.args.concat(X$p)):X$p instanceof Array?X$P.method.apply(X$P.caller,X$p):X$P.caller?X$P.method.call(X$P.caller,X$p):X$E.recordError("事件派发错误","node.caller:"+X$P.caller+"node.method:"+X$P.method+"data:"+X$p+"node.prev"+X$P.prev):X$P.method.apply(X$P.caller,X$P.args)),X$P.once&&X$K.recoverHandler(X$P));X$h.lock=!1,!X$h.head&&this._events&&this._events[X$m]==X$h&&delete this._events[X$m],X$h.queue&&X$h.queue.length&&this.event(X$m,X$h.queue.shift())}return!0},X$m.on=function(X$m,X$p,X$h,X$P){return this._createListener(X$m,X$p,X$h,X$P,!1)},X$m.once=function(X$m,X$p,X$h,X$P){return this._createListener(X$m,X$p,X$h,X$P,!0)},X$m._createListener=function(X$m,X$p,X$h,X$P,X$L,X$q){void 0===X$q&&(X$q=!0),X$q&&this.off(X$m,X$p,X$h,X$L);var X$k=X$K.createHandler(X$p||this,X$h,X$P,X$L);this._events||(this._events={});var X$Y=this._events,X$d=X$Y[X$m];return X$d?X$d.tail?(X$k.prev=X$d.tail,X$d.tail.next=X$k,X$d.tail=X$k):X$d.head=X$d.tail=X$k:X$Y[X$m]={head:X$k,tail:X$k,cursor:null,lock:!1},this},X$m.off=function(X$m,X$p,X$h,X$P){if(void 0===X$P&&(X$P=!1),!this._events||!this._events[X$m])return this;for(var X$L=this._events[X$m],X$q=X$L.head;X$q;){if((!X$p||X$q.caller===X$p)&&X$q.method===X$h&&(!X$P||X$q.once)){X$K.delNode(X$L,X$q),X$L.cursor==X$q&&(X$L.cursor=X$q.next),X$K.recoverHandler(X$q);break}X$q=X$q.next}return this},X$m.offAll=function(X$m){var X$p=this._events;if(!X$p)return this;if(X$m)this._recoverHandlers(X$p[X$m]),delete X$p[X$m];else{for(var X$h in X$p)this._recoverHandlers(X$p[X$h]);this._events=null}return this},X$m._recoverHandlers=function(X$m){if(X$m){for(var X$p=X$m.head;X$p;){X$K.delNode(X$m,X$p);var X$h=X$p.next;X$K.recoverHandler(X$p),X$p=X$h}X$m.cursor=null}},X$m.isMouseEvent=function(X$m){return X$K.MOUSE_EVENTS[X$m]},X$K.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},X$K.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},X$K.delNode=function(X$m,X$p){X$p.prev?X$p.prev.next=X$p.next:X$m.head=X$p.next,X$p.next?X$p.next.prev=X$p.prev:X$m.tail=X$p.prev},X$K.createHandler=function(X$m,X$p,X$h,X$P){var X$L=500<X$K._freeHandler.length?X$K._freeHandler.shift():null;if(X$L)if(X$L.recover)X$L.recover=!1,X$L.caller=X$m,X$L.method=X$p,X$L.args=X$h,X$L.once=X$P;else{var X$q="";try{arguments.propertyIsEnumerable.caller}catch(X$m){X$q=X$m.stack}var X$k=X$L.caller?(X$L.caller.__proto__&&X$L.caller.__proto__.constructor&&X$L.caller.__proto__.constructor.name)+"|"+X$L.caller.__className+"|"+X$L.caller.name:"",X$Y=X$L.method?X$L.method.name:"";X$E.recordError("EventDispatcher重复创建","caller="+X$k+"  method="+X$Y+"  stack="+X$q),X$L={id:++X$K._nodeCount,caller:X$m,method:X$p,args:X$h,once:X$P,recover:!1}}else X$L={id:++X$K._nodeCount,caller:X$m,method:X$p,args:X$h,once:X$P,recover:!1};return X$L.prev=X$L.next=null,X$L},X$K.recoverHandler=function(X$m){if(X$m.recover){if(X$K._errorCount<5){X$K._errorCount++;var X$p="";try{arguments.propertyIsEnumerable.caller}catch(X$m){X$p=X$m.stack}var X$h=X$m.caller?(X$m.caller.__proto__&&X$m.caller.__proto__.constructor&&X$m.caller.__proto__.constructor.name)+"|"+X$m.caller.__className+"|"+X$m.caller.name:"",X$P=X$m.method?X$m.method.name:"";X$E.recordError("EventDispatcher重复回收","id="+X$m.id+"  caller="+X$h+"  method="+X$P+"  stack="+X$p)}X$m.caller=X$m.method=X$m.args=X$m.prev=null}else X$m.recover=!0,X$m.caller=X$m.method=X$m.args=X$m.prev=X$m.next=null,X$K._freeHandler&&X$K._freeHandler.length<3e3&&X$K._freeHandler.push(X$m)},X$K._freeHandler=[],X$K._nodeCount=0,X$K._errorCount=0,X$K}(),X$e=function(){function X$L(X$m,X$p,X$h,X$P){this.once=!1,void(this._id=0)===X$P&&(X$P=!1),this.setTo(X$m,X$p,X$h,X$P)}X$D(X$L,"laya.utils.Handler");var X$m=X$L.prototype;return X$m.setTo=function(X$m,X$p,X$h,X$P){return this._id=X$L._gid++,this.caller=X$m,this.method=X$p,this.args=X$h,this.once=X$P,this},X$m.run=function(){if(null==this.method)return null;var X$m=this._id,X$p=this.method.apply(this.caller,this.args);return this._id===X$m&&this.once&&this.recover(),X$p},X$m.runWith=function(X$m){if(null==this.method)return null;var X$p=this._id;if(null==X$m)var X$h=this.method.apply(this.caller,this.args);else X$h=this.args||X$m.unshift?this.args?this.method.apply(this.caller,this.args.concat(X$m)):this.method.apply(this.caller,X$m):this.method.call(this.caller,X$m);return this._id===X$p&&this.once&&this.recover(),X$h},X$m.clear=function(){return this.caller=null,this.method=null,this.args=null,this},X$m.recover=function(){0<this._id&&(this._id=0,this.clear())},X$L.create=function(X$m,X$p,X$h,X$P){return void 0===X$P&&(X$P=!0),new X$L(X$m,X$p,X$h,X$P)},X$L._gid=1,X$L}(),X$j=function(){function X$m(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}X$D(X$m,"laya.display.BitmapFont");var X$p=X$m.prototype;return X$p.loadFont=function(X$m,X$p){this._path=X$m,this._complete=X$p,X$E.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],X$e.create(this,this.onLoaded))},X$p.onLoaded=function(){this.parseFont(X$Ym.getRes(this._path),X$Ym.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},X$p.parseFont=function(X$m,X$p){if(null!=X$m&&null!=X$p){this._texture=X$p;var X$h=X$m.getElementsByTagName("info");if(!X$h[0].getAttributeNode)return this.parseFont2(X$m,X$p);this.fontSize=parseInt(X$h[0].getAttributeNode("size").nodeValue);var X$P,X$L=X$h[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(X$L[0]),parseInt(X$L[1]),parseInt(X$L[2]),parseInt(X$L[3])],X$P=X$m.getElementsByTagName("char");var X$q=0;for(X$q=0;X$q<X$P.length;X$q++){var X$k=X$P[X$q],X$Y=parseInt(X$k.getAttributeNode("id").nodeValue),X$d=parseInt(X$k.getAttributeNode("xoffset").nodeValue)/1,X$K=parseInt(X$k.getAttributeNode("yoffset").nodeValue)/1,X$D=parseInt(X$k.getAttributeNode("xadvance").nodeValue)/1,X$F=new X$b;X$F.x=parseInt(X$k.getAttributeNode("x").nodeValue),X$F.y=parseInt(X$k.getAttributeNode("y").nodeValue),X$F.width=parseInt(X$k.getAttributeNode("width").nodeValue),X$F.height=parseInt(X$k.getAttributeNode("height").nodeValue);var X$R=X$Dm.create(X$p,X$F.x,X$F.y,X$F.width,X$F.height,X$d,X$K);this._maxWidth=Math.max(this._maxWidth,X$D+this.letterSpacing),this._fontCharDic[X$Y]=X$R,this._fontWidthMap[X$Y]=X$D}}},X$p.parseFont2=function(X$m,X$p){if(null!=X$m&&null!=X$p){this._texture=X$p;var X$h=X$m.getElementsByTagName("info");this.fontSize=parseInt(X$h[0].attributes.size.nodeValue);var X$P=X$h[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(X$P[0]),parseInt(X$P[1]),parseInt(X$P[2]),parseInt(X$P[3])];var X$L=X$m.getElementsByTagName("char"),X$q=0;for(X$q=0;X$q<X$L.length;X$q++){var X$k=X$L[X$q].attributes,X$Y=parseInt(X$k.id.nodeValue),X$d=parseInt(X$k.xoffset.nodeValue)/1,X$K=parseInt(X$k.yoffset.nodeValue)/1,X$D=parseInt(X$k.xadvance.nodeValue)/1,X$F=new X$b;X$F.x=parseInt(X$k.x.nodeValue),X$F.y=parseInt(X$k.y.nodeValue),X$F.width=parseInt(X$k.width.nodeValue),X$F.height=parseInt(X$k.height.nodeValue);var X$R=X$Dm.create(X$p,X$F.x,X$F.y,X$F.width,X$F.height,X$d,X$K);this._maxWidth=Math.max(this._maxWidth,X$D+this.letterSpacing),this._fontCharDic[X$Y]=X$R,this._fontWidthMap[X$Y]=X$D}}},X$p.getCharTexture=function(X$m){return this._fontCharDic[X$m.charCodeAt(0)]},X$p.destroy=function(){if(this._texture){for(var X$m in this._fontCharDic){var X$p=this._fontCharDic[X$m];X$p&&X$p.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},X$p.setSpaceWidth=function(X$m){this._spaceWidth=X$m},X$p.getCharWidth=function(X$m){var X$p=X$m.charCodeAt(0);return this._fontWidthMap[X$p]?this._fontWidthMap[X$p]+this.letterSpacing:" "==X$m?this._spaceWidth+this.letterSpacing:0},X$p.getTextWidth=function(X$m){for(var X$p=0,X$h=0,X$P=X$m.length;X$h<X$P;X$h++)X$p+=this.getCharWidth(X$m.charAt(X$h));return X$p},X$p.getMaxWidth=function(){return this._maxWidth},X$p.getMaxHeight=function(){return this.fontSize},X$p.drawText=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k,X$Y=this.getTextWidth(X$m),X$d=0;"center"===X$L&&(X$d=(X$q-X$Y)/2),"right"===X$L&&(X$d=X$q-X$Y);for(var X$K=0,X$D=0,X$F=X$m.length;X$D<X$F;X$D++)(X$k=this.getCharTexture(X$m.charAt(X$D)))&&(X$p.graphics.drawTexture(X$k,X$h+X$K+X$d,X$P),X$K+=this.getCharWidth(X$m.charAt(X$D)))},X$m}(),X$Y=function(){function X$h(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=X$h._TF_EMPTY}X$D(X$h,"laya.display.css.Style");var X$m=X$h.prototype;return X$m.getTransform=function(){return this._tf},X$m.setTransform=function(X$m){this._tf="none"!==X$m&&X$m?X$m:X$h._TF_EMPTY},X$m.setTranslateX=function(X$m){this._tf===X$h._TF_EMPTY&&(this._tf=new X$L),this._tf.translateX=X$m},X$m.setTranslateY=function(X$m){this._tf===X$h._TF_EMPTY&&(this._tf=new X$L),this._tf.translateY=X$m},X$m.setScaleX=function(X$m){this._tf===X$h._TF_EMPTY&&(this._tf=new X$L),this._tf.scaleX=X$m},X$m.setScale=function(X$m,X$p){this._tf===X$h._TF_EMPTY&&(this._tf=new X$L),this._tf.scaleX=X$m,this._tf.scaleY=X$p},X$m.setScaleY=function(X$m){this._tf===X$h._TF_EMPTY&&(this._tf=new X$L),this._tf.scaleY=X$m},X$m.setRotate=function(X$m){this._tf===X$h._TF_EMPTY&&(this._tf=new X$L),this._tf.rotate=X$m},X$m.setSkewX=function(X$m){this._tf===X$h._TF_EMPTY&&(this._tf=new X$L),this._tf.skewX=X$m},X$m.setSkewY=function(X$m){this._tf===X$h._TF_EMPTY&&(this._tf=new X$L),this._tf.skewY=X$m},X$m.destroy=function(){this.scrollRect=null},X$m.render=function(X$m,X$p,X$h,X$P){},X$m.getCSSStyle=function(){return X$pm.EMPTY},X$m._enableLayout=function(){return!1},X$A(0,X$m,"scaleX",function(){return this._tf.scaleX},function(X$m){this.setScaleX(X$m)}),X$A(0,X$m,"transform",function(){return this.getTransform()},function(X$m){this.setTransform(X$m)}),X$A(0,X$m,"translateX",function(){return this._tf.translateX},function(X$m){this.setTranslateX(X$m)}),X$A(0,X$m,"translateY",function(){return this._tf.translateY},function(X$m){this.setTranslateY(X$m)}),X$A(0,X$m,"scaleY",function(){return this._tf.scaleY},function(X$m){this.setScaleY(X$m)}),X$A(0,X$m,"block",function(){return 0!=(1&this._type)}),X$A(0,X$m,"skewY",function(){return this._tf.skewY},function(X$m){this.setSkewY(X$m)}),X$A(0,X$m,"rotate",function(){return this._tf.rotate},function(X$m){this.setRotate(X$m)}),X$A(0,X$m,"skewX",function(){return this._tf.skewX},function(X$m){this.setSkewX(X$m)}),X$A(0,X$m,"paddingLeft",function(){return 0}),X$A(0,X$m,"paddingTop",function(){return 0}),X$A(0,X$m,"absolute",function(){return!0}),X$h.__init__=function(){X$h._TF_EMPTY=new X$L,X$h.EMPTY=new X$h},X$h.EMPTY=null,X$h._TF_EMPTY=null,X$h}(),X$$=function(){function X$p(X$m){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=X$U.create(X$p.defaultColor),this.family=X$p.defaultFamily,this.stroke=X$p._STROKE,this.size=X$p.defaultSize,X$m&&X$m!==X$p.EMPTY&&X$m.copyTo(this)}X$D(X$p,"laya.display.css.Font");var X$m=X$p.prototype;return X$m.set=function(X$m){this._text=null;for(var X$p=X$m.split(" "),X$h=0,X$P=X$p.length;X$h<X$P;X$h++){var X$L=X$p[X$h];switch(X$L){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<X$L.indexOf("px")&&(this.size=parseInt(X$L),this.family=X$p[X$h+1],X$h++)}},X$m.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},X$m.copyTo=function(X$m){X$m._type=this._type,X$m._text=this._text,X$m._weight=this._weight,X$m._color=this._color,X$m.family=this.family,X$m.stroke=this.stroke!=X$p._STROKE?this.stroke.slice():X$p._STROKE,X$m.indent=this.indent,X$m.size=this.size},X$A(0,X$m,"password",function(){return 0!=(1024&this._type)},function(X$m){X$m?this._type|=1024:this._type&=-1025}),X$A(0,X$m,"color",function(){return this._color.strColor},function(X$m){this._color=X$U.create(X$m)}),X$A(0,X$m,"italic",function(){return 0!=(512&this._type)},function(X$m){X$m?this._type|=512:this._type&=-513}),X$A(0,X$m,"bold",function(){return 0!=(2048&this._type)},function(X$m){X$m?this._type|=2048:this._type&=-2049}),X$A(0,X$m,"weight",function(){return""+this._weight},function(X$m){var X$p=0;switch(X$m){case"normal":break;case"bold":this.bold=!0,X$p=700;break;case"bolder":X$p=800;break;case"lighter":X$p=100;break;default:X$p=parseInt(X$m)}this._weight=X$p,this._text=null}),X$A(0,X$m,"decoration",function(){return this._decoration?this._decoration.value:null},function(X$m){var X$p=X$m.split(" ");switch(this._decoration||(this._decoration={}),X$p[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=X$p[0]}X$p[1]&&(this._decoration.color=X$U.create(X$p)),this._decoration.value=X$m}),X$p.__init__=function(){X$p.EMPTY=new X$p(null)},X$p.EMPTY=null,X$p.defaultColor="#000000",X$p.defaultSize=12,X$p.defaultFamily="Arial",X$p.defaultFont="12px Arial",X$p._STROKE=[0,"#000000"],X$p._ITALIC=512,X$p._PASSWORD=1024,X$p._BOLD=2048,X$p}(),X$L=function(){function X$m(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return X$D(X$m,"laya.display.css.TransformInfo"),X$m}(),X$R=function(){function X$F(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,X$S.isConchNode){this._nativeObj=new X$k._conchGraphics,this.id=this._nativeObj.conchID}}X$D(X$F,"laya.display.Graphics");var X$m=X$F.prototype;return X$m.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},X$m.clear=function(X$m){void 0===X$m&&(X$m=!1);var X$p=0,X$h=0;if(X$m){var X$P=this._one;if(this._cmds){for(X$h=this._cmds.length,X$p=0;X$p<X$h;X$p++)!(X$P=this._cmds[X$p])||X$P.callee!==X$S._context._drawTexture&&X$P.callee!==X$S._context._drawTextureWithTransform||(X$P[0]=null,X$F._cache.push(X$P));this._cmds.length=0}else X$P&&(!X$P||X$P.callee!==X$S._context._drawTexture&&X$P.callee!==X$S._context._drawTextureWithTransform||(X$P[0]=null,X$F._cache.push(X$P)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(X$p=0,X$h=this._vectorgraphArray.length;X$p<X$h;X$p++)X$t.getInstance().deleteShape(this._vectorgraphArray[X$p]);this._vectorgraphArray.length=0}},X$m._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},X$m._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new X$h,this._graphicBounds._graphics=this)},X$m._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},X$m._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},X$m.getBounds=function(X$m){return void 0===X$m&&(X$m=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(X$m)},X$m.getBoundPoints=function(X$m){return void 0===X$m&&(X$m=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(X$m)},X$m._addCmd=function(X$m){this._cmds=this._cmds||[],X$m.callee=X$m.shift(),this._cmds.push(X$m)},X$m.setFilters=function(X$m){this._saveToCmd(X$S._context._setFilters,X$m)},X$m.drawTexture=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){if(void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=0),void 0===X$L&&(X$L=0),void 0===X$k&&(X$k=1),!X$m||X$k<.01)return null;X$P||(X$P=X$m.sourceWidth),X$L||(X$L=X$m.sourceHeight),X$k=X$k<0?0:1<X$k?1:X$k;var X$Y,X$d=!X$S.isWebGL&&(X$w.onFirefox||X$w.onEdge||X$w.onIE||X$w.onSafari)?.5:0,X$K=X$P/X$m.sourceWidth,X$D=X$L/X$m.sourceHeight;return X$P=X$m.width*X$K,X$L=X$m.height*X$D,X$m.loaded&&(X$P<=0||X$L<=0)?null:(X$p+=X$m.offsetX*X$K,X$h+=X$m.offsetY*X$D,this._sp&&(this._sp._renderType|=512),X$p-=X$d,X$h-=X$d,X$P+=2*X$d,X$L+=2*X$d,X$F._cache.length?((X$Y=X$F._cache.pop())[0]=X$m,X$Y[1]=X$p,X$Y[2]=X$h,X$Y[3]=X$P,X$Y[4]=X$L,X$Y[5]=X$q,X$Y[6]=X$k):X$Y=[X$m,X$p,X$h,X$P,X$L,X$q,X$k],X$Y.callee=X$q||1!=X$k?X$S._context._drawTextureWithTransform:X$S._context._drawTexture,null!=this._one||X$q||1!=X$k?this._saveToCmd(X$Y.callee,X$Y):(this._one=X$Y,this._render=this._renderOneImg),X$m.loaded||X$m.once("loaded",this,this._textureLoaded,[X$m,X$Y]),this._repaint(),X$Y)},X$m.cleanByTexture=function(X$m,X$p,X$h,X$P,X$L){if(void 0===X$P&&(X$P=0),void 0===X$L&&(X$L=0),!X$m)return this.clear();if(this._one&&this._render===this._renderOneImg){X$P||(X$P=X$m.sourceWidth),X$L||(X$L=X$m.sourceHeight);var X$q=X$P/X$m.sourceWidth,X$k=X$L/X$m.sourceHeight;X$P=X$m.width*X$q,X$L=X$m.height*X$k,X$p+=X$m.offsetX*X$q,X$h+=X$m.offsetY*X$k,this._one[0]=X$m,this._one[1]=X$p,this._one[2]=X$h,this._one[3]=X$P,this._one[4]=X$L,this._repaint()}else this.clear(),X$m&&this.drawTexture(X$m,X$p,X$h,X$P,X$L)},X$m.drawTextures=function(X$m,X$p){X$m&&this._saveToCmd(X$S._context._drawTextures,[X$m,X$p])},X$m.fillTexture=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){if(void 0===X$P&&(X$P=0),void 0===X$L&&(X$L=0),void 0===X$q&&(X$q="repeat"),X$m){var X$Y=[X$m,X$p,X$h,X$P,X$L,X$q,X$k||X$I.EMPTY,{}];X$m.loaded||X$m.once("loaded",this,this._textureLoaded,[X$m,X$Y]),this._saveToCmd(X$S._context._fillTexture,X$Y)}},X$m._textureLoaded=function(X$m,X$p){X$p[3]=X$p[3]||X$m.width,X$p[4]=X$p[4]||X$m.height,this._repaint()},X$m.fillCircle=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){X$h.bitmap.enableMerageInAtlas=!1;var X$Y=new Float32Array(2*(X$k+1)),X$d=new Float32Array(2*(X$k+1)),X$K=new Uint16Array(3*X$k),X$D=2*Math.PI/X$k,X$F=0;X$Y[0]=X$P,X$Y[1]=X$L,X$d[0]=X$P/X$h.width,X$d[1]=X$L/X$h.height;for(var X$R=2,X$$=0;X$$<X$k;X$$++){var X$A=X$q*Math.cos(X$F)+X$P,X$B=X$q*Math.sin(X$F)+X$L;X$Y[X$R]=X$A,X$Y[X$R+1]=X$B,X$d[X$R]=X$A/X$h.width,X$d[X$R+1]=X$B/X$h.height,X$F+=X$D,X$R+=2}for(X$$=X$R=0;X$$<X$k;X$$++)X$K[X$R++]=0,X$K[X$R++]=X$$+1,X$K[X$R++]=X$k+1<=X$$+2?1:X$$+2;this.drawTriangles(X$h,X$m,X$p,X$Y,X$d,X$K)},X$m.drawTriangles=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){void 0===X$Y&&(X$Y=1),this._saveToCmd(X$S._context.drawTriangles,[X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K])},X$m._saveToCmd=function(X$m,X$p){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=X$p,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(X$p)),X$p.callee=X$m,this._repaint(),X$p},X$m.clipRect=function(X$m,X$p,X$h,X$P){this._saveToCmd(X$S._context._clipRect,[X$m,X$p,X$h,X$P])},X$m.fillText=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){void 0===X$k&&(X$k=0),this._saveToCmd(X$S._context._fillText,[X$m,X$p,X$h,X$P||X$$.defaultFont,X$L,X$q])},X$m.fillBorderText=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){this._saveToCmd(X$S._context._fillBorderText,[X$m,X$p,X$h,X$P||X$$.defaultFont,X$L,X$q,X$k,X$Y])},X$m.strokeText=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this._saveToCmd(X$S._context._strokeText,[X$m,X$p,X$h,X$P||X$$.defaultFont,X$L,X$q,X$k])},X$m.alpha=function(X$m){X$m=X$m<0?0:1<X$m?1:X$m,this._saveToCmd(X$S._context._alpha,[X$m])},X$m.setAlpha=function(X$m){X$m=X$m<0?0:1<X$m?1:X$m,this._saveToCmd(X$S._context._setAlpha,[X$m])},X$m.transform=function(X$m,X$p,X$h){void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),this._saveToCmd(X$S._context._transform,[X$m,X$p,X$h])},X$m.rotate=function(X$m,X$p,X$h){void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),this._saveToCmd(X$S._context._rotate,[X$m,X$p,X$h])},X$m.scale=function(X$m,X$p,X$h,X$P){void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=0),this._saveToCmd(X$S._context._scale,[X$m,X$p,X$h,X$P])},X$m.translate=function(X$m,X$p){this._saveToCmd(X$S._context._translate,[X$m,X$p])},X$m.save=function(){this._saveToCmd(X$S._context._save,[])},X$m.restore=function(){this._saveToCmd(X$S._context._restore,[])},X$m.replaceText=function(X$m){this._repaint();var X$p=this._cmds;if(X$p){for(var X$h=X$p.length-1;-1<X$h;X$h--)if(this._isTextCmd(X$p[X$h].callee))return X$p[X$h][0].toUpperCase?X$p[X$h][0]=X$m:X$p[X$h][0].setText(X$m),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=X$m:this._one[0].setText(X$m),!0;return!1},X$m._isTextCmd=function(X$m){return X$m===X$S._context._fillText||X$m===X$S._context._fillBorderText||X$m===X$S._context._strokeText},X$m.replaceTextColor=function(X$m){this._repaint();var X$p=this._cmds;if(X$p)for(var X$h=X$p.length-1;-1<X$h;X$h--)this._isTextCmd(X$p[X$h].callee)&&(X$p[X$h][4]=X$m,X$p[X$h][0].toUpperCase||(X$p[X$h][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=X$m,this._one[0].toUpperCase||(this._one[0].changed=!0))},X$m.loadImage=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=this;void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=0),void 0===X$L&&(X$L=0);var X$Y=X$Ym.getRes(X$m);function X$d(X$m){X$m&&(X$k.drawTexture(X$m,X$p,X$h,X$P,X$L),null!=X$q&&X$q.call(X$k._sp,X$m))}X$Y?X$d(X$Y):X$E.loader.load(X$m,X$e.create(null,X$d),null,"image")},X$m._renderEmpty=function(X$m,X$p,X$h,X$P){},X$m._renderAll=function(X$m,X$p,X$h,X$P){for(var X$L,X$q=this._cmds,X$k=0,X$Y=X$q.length;X$k<X$Y;X$k++)(X$L=X$q[X$k]).callee.call(X$p,X$h,X$P,X$L)},X$m._renderOne=function(X$m,X$p,X$h,X$P){this._one.callee.call(X$p,X$h,X$P,this._one)},X$m._renderOneImg=function(X$m,X$p,X$h,X$P){this._one.callee.call(X$p,X$h,X$P,this._one),2305!==X$m._renderType&&(X$m._renderType|=1)},X$m.drawLine=function(X$m,X$p,X$h,X$P,X$L,X$q){void 0===X$q&&(X$q=1);var X$k=0;X$S.isWebGL&&(X$k=X$t.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(X$k));var X$Y=X$q%2==0?0:.5,X$d=[X$m+X$Y,X$p+X$Y,X$h+X$Y,X$P+X$Y,X$L,X$q,X$k];this._saveToCmd(X$S._context._drawLine,X$d)},X$m.drawLines=function(X$m,X$p,X$h,X$P,X$L){void 0===X$L&&(X$L=1);var X$q=0;if(X$h&&!(X$h.length<4)){X$S.isWebGL&&(X$q=X$t.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(X$q));var X$k=X$L%2==0?0:.5,X$Y=[X$m+X$k,X$p+X$k,X$h,X$P,X$L,X$q];this._saveToCmd(X$S._context._drawLines,X$Y)}},X$m.drawCurves=function(X$m,X$p,X$h,X$P,X$L){void 0===X$L&&(X$L=1);var X$q=[X$m,X$p,X$h,X$P,X$L];this._saveToCmd(X$S._context._drawCurves,X$q)},X$m.drawRect=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){void 0===X$k&&(X$k=1);var X$Y=X$q?X$k/2:0,X$d=X$q?X$k:0,X$K=[X$m+X$Y,X$p+X$Y,X$h-X$d,X$P-X$d,X$L,X$q,X$k];this._saveToCmd(X$S._context._drawRect,X$K)},X$m.drawCircle=function(X$m,X$p,X$h,X$P,X$L,X$q){void 0===X$q&&(X$q=1);var X$k=X$L?X$q/2:0,X$Y=0;X$S.isWebGL&&(X$Y=X$t.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(X$Y));var X$d=[X$m,X$p,X$h-X$k,X$P,X$L,X$q,X$Y];this._saveToCmd(X$S._context._drawCircle,X$d)},X$m.drawPie=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){void 0===X$Y&&(X$Y=1);var X$d=X$k?X$Y/2:0,X$K=X$k?X$Y:0,X$D=0;X$S.isWebGL&&(X$D=X$t.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(X$D));var X$F=[X$m+X$d,X$p+X$d,X$h-X$K,X$P,X$L,X$q,X$k,X$Y,X$D];X$F[3]=X$g.toRadian(X$P),X$F[4]=X$g.toRadian(X$L),this._saveToCmd(X$S._context._drawPie,X$F)},X$m.drawPoly=function(X$m,X$p,X$h,X$P,X$L,X$q){void 0===X$q&&(X$q=1);var X$k=0,X$Y=!1;X$S.isWebGL&&(X$k=X$t.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(X$k),X$Y=!(6<X$h.length));var X$d=X$L?X$q%2==0?0:.5:0,X$K=[X$m+X$d,X$p+X$d,X$h,X$P,X$L,X$q,X$k,X$Y];this._saveToCmd(X$S._context._drawPoly,X$K)},X$m.drawPath=function(X$m,X$p,X$h,X$P,X$L){var X$q=[X$m,X$p,X$h,X$P,X$L];this._saveToCmd(X$S._context._drawPath,X$q)},X$A(0,X$m,"cmds",function(){return this._cmds},function(X$m){this._sp&&(this._sp._renderType|=512),this._cmds=X$m,this._render=this._renderAll,this._repaint()}),X$F.__init__=function(){if(X$S.isConchNode){for(var X$m=laya.display.Graphics.prototype,X$p=X$w.window.ConchGraphics.prototype,X$h=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],X$P=0,X$L=X$h.length;X$P<=X$L;X$P++){var X$q=X$h[X$P];X$m[X$q]=X$p[X$q]}X$m._saveToCmd=null,X$p.drawImageS&&(X$m.drawTextures=function(X$m,X$p){if(X$m&&X$m.loaded&&X$m.bitmap&&X$m.source){var X$h=X$m.uv,X$P=X$m.bitmap.width,X$L=X$m.bitmap.height;this.drawImageS(X$m.bitmap.source,X$h[0]*X$P,X$h[1]*X$L,(X$h[2]-X$h[0])*X$P,(X$h[5]-X$h[3])*X$L,X$m.offsetX,X$m.offsetY,X$m.width,X$m.height,X$p)}}),X$m.drawTexture=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){if(void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=0),void 0===X$L&&(X$L=0),void 0===X$k&&(X$k=1),X$m)if(X$m.loaded){if(X$m.loaded&&X$m.bitmap&&X$m.source&&(X$P||(X$P=X$m.sourceWidth),X$L||(X$L=X$m.sourceHeight),X$k=X$k<0?0:1<X$k?1:X$k,X$P=X$P-X$m.sourceWidth+X$m.width,X$L=X$L-X$m.sourceHeight+X$m.height,!(X$P<=0||X$L<=0))){X$p+=X$m.offsetX,X$h+=X$m.offsetY;var X$Y=X$m.uv,X$d=X$m.bitmap.width,X$K=X$m.bitmap.height;X$Y[4]<X$Y[0]&&X$Y[5]<X$Y[1]?this.drawImageM(X$m.bitmap.source,X$Y[4]*X$d,X$Y[5]*X$K,(X$Y[0]-X$Y[4])*X$d,(X$Y[1]-X$Y[5])*X$K,X$p,X$h,X$P,X$L,X$q,X$k):this.drawImageM(X$m.bitmap.source,X$Y[0]*X$d,X$Y[1]*X$K,(X$Y[2]-X$Y[0])*X$d,(X$Y[5]-X$Y[3])*X$K,X$p,X$h,X$P,X$L,X$q,X$k),this._repaint()}}else X$m.once("loaded",this,function(){this.drawTexture(X$m,X$p,X$h,X$P,X$L,X$q)})},X$m.fillTexture=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){if(void 0===X$P&&(X$P=0),void 0===X$L&&(X$L=0),void 0===X$q&&(X$q="repeat"),X$m&&X$m.loaded){var X$Y,X$d=X$S._context.ctx,X$K=X$m.bitmap.width,X$D=X$m.bitmap.height,X$F=X$m.uv;X$Y=X$m.uv!=X$Dm.DEF_UV?X$d.createPattern(X$m.bitmap.source,X$q,X$F[0]*X$K,X$F[1]*X$D,(X$F[2]-X$F[0])*X$K,(X$F[5]-X$F[3])*X$D):X$d.createPattern(X$m.bitmap.source,X$q);var X$R=0,X$$=0;X$k&&(X$p+=X$k.x%X$m.width,X$h+=X$k.y%X$m.height,X$R-=X$k.x%X$m.width,X$$-=X$k.y%X$m.height),this._fillImage(X$Y,X$p,X$h,X$R,X$$,X$P,X$L)}}}},X$F._cache=[],X$F}(),X$h=function(){function X$a(){this._cacheBoundsType=!1}X$D(X$a,"laya.display.GraphicsBounds");var X$m=X$a.prototype;return X$m.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},X$m.reset=function(){this._temp&&(this._temp.length=0)},X$m.getBounds=function(X$m){return void 0===X$m&&(X$m=!1),(!this._bounds||!this._temp||this._temp.length<1||X$m!=this._cacheBoundsType)&&(this._bounds=X$b._getWrapRec(this.getBoundPoints(X$m),this._bounds)),this._cacheBoundsType=X$m,this._bounds},X$m.getBoundPoints=function(X$m){return void 0===X$m&&(X$m=!1),(!this._temp||this._temp.length<1||X$m!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(X$m)),this._cacheBoundsType=X$m,this._rstBoundPoints=X$g.copyArray(this._rstBoundPoints,this._temp)},X$m._getCmdPoints=function(X$m){void 0===X$m&&(X$m=!1);var X$p,X$h,X$P=X$S._context,X$L=this._graphics.cmds;if((X$p=this._temp||(this._temp=[])).length=0,X$L||null==this._graphics._one||(X$a._tempCmds.length=0,X$a._tempCmds.push(this._graphics._one),X$L=X$a._tempCmds),!X$L)return X$p;(X$h=X$a._tempMatrixArrays).length=0;var X$q=X$a._initMatrix;X$q.identity();for(var X$k,X$Y,X$d=X$a._tempMatrix,X$K=NaN,X$D=NaN,X$F=NaN,X$R=NaN,X$$=NaN,X$A=NaN,X$B=0,X$n=X$L.length;X$B<X$n;X$B++)if((X$k=X$L[X$B]).callee)switch(X$k.callee){case X$P._save:case 7:X$h.push(X$q),X$q=X$q.clone();break;case X$P._restore:case 8:X$q=X$h.pop();break;case X$P._scale:case 5:X$d.identity(),X$d.translate(-X$k[2],-X$k[3]),X$d.scale(X$k[0],X$k[1]),X$d.translate(X$k[2],X$k[3]),this._switchMatrix(X$q,X$d);break;case X$P._rotate:case 3:X$d.identity(),X$d.translate(-X$k[1],-X$k[2]),X$d.rotate(X$k[0]),X$d.translate(X$k[1],X$k[2]),this._switchMatrix(X$q,X$d);break;case X$P._translate:case 6:X$d.identity(),X$d.translate(X$k[0],X$k[1]),this._switchMatrix(X$q,X$d);break;case X$P._transform:case 4:X$d.identity(),X$d.translate(-X$k[1],-X$k[2]),X$d.concat(X$k[0]),X$d.translate(X$k[1],X$k[2]),this._switchMatrix(X$q,X$d);break;case 16:case 24:X$a._addPointArrToRst(X$p,X$b._getBoundPointS(X$k[0],X$k[1],X$k[2],X$k[3]),X$q);break;case 17:X$q.copyTo(X$d),X$d.concat(X$k[4]),X$a._addPointArrToRst(X$p,X$b._getBoundPointS(X$k[0],X$k[1],X$k[2],X$k[3]),X$d);break;case X$P._drawTexture:X$Y=X$k[0],X$m?X$k[3]&&X$k[4]?X$a._addPointArrToRst(X$p,X$b._getBoundPointS(X$k[1],X$k[2],X$k[3],X$k[4]),X$q):(X$Y=X$k[0],X$a._addPointArrToRst(X$p,X$b._getBoundPointS(X$k[1],X$k[2],X$Y.width,X$Y.height),X$q)):(X$K=(X$k[3]||X$Y.sourceWidth)/X$Y.width,X$D=(X$k[4]||X$Y.sourceHeight)/X$Y.height,X$F=X$K*X$Y.sourceWidth,X$R=X$D*X$Y.sourceHeight,X$$=0<X$Y.offsetX?X$Y.offsetX:0,X$A=0<X$Y.offsetY?X$Y.offsetY:0,X$$*=X$K,X$A*=X$D,X$a._addPointArrToRst(X$p,X$b._getBoundPointS(X$k[1]-X$$,X$k[2]-X$A,X$F,X$R),X$q));break;case X$P._fillTexture:X$k[3]&&X$k[4]?X$a._addPointArrToRst(X$p,X$b._getBoundPointS(X$k[1],X$k[2],X$k[3],X$k[4]),X$q):(X$Y=X$k[0],X$a._addPointArrToRst(X$p,X$b._getBoundPointS(X$k[1],X$k[2],X$Y.width,X$Y.height),X$q));break;case X$P._drawTextureWithTransform:var X$c;X$c=X$k[5]?(X$q.copyTo(X$d),X$d.concat(X$k[5]),X$d):X$q,X$m?X$k[3]&&X$k[4]?X$a._addPointArrToRst(X$p,X$b._getBoundPointS(X$k[1],X$k[2],X$k[3],X$k[4]),X$c):(X$Y=X$k[0],X$a._addPointArrToRst(X$p,X$b._getBoundPointS(X$k[1],X$k[2],X$Y.width,X$Y.height),X$c)):(X$Y=X$k[0],X$K=(X$k[3]||X$Y.sourceWidth)/X$Y.width,X$D=(X$k[4]||X$Y.sourceHeight)/X$Y.height,X$F=X$K*X$Y.sourceWidth,X$R=X$D*X$Y.sourceHeight,X$$=0<X$Y.offsetX?X$Y.offsetX:0,X$A=0<X$Y.offsetY?X$Y.offsetY:0,X$$*=X$K,X$A*=X$D,X$a._addPointArrToRst(X$p,X$b._getBoundPointS(X$k[1]-X$$,X$k[2]-X$A,X$F,X$R),X$c));break;case X$P._drawRect:case 13:X$a._addPointArrToRst(X$p,X$b._getBoundPointS(X$k[0],X$k[1],X$k[2],X$k[3]),X$q);break;case X$P._drawCircle:case X$P._fillCircle:case 14:X$a._addPointArrToRst(X$p,X$b._getBoundPointS(X$k[0]-X$k[2],X$k[1]-X$k[2],X$k[2]+X$k[2],X$k[2]+X$k[2]),X$q);break;case X$P._drawLine:case 20:X$a._tempPoints.length=0;var X$e;X$e=.5*X$k[5],X$k[0]==X$k[2]?X$a._tempPoints.push(X$k[0]+X$e,X$k[1],X$k[2]+X$e,X$k[3],X$k[0]-X$e,X$k[1],X$k[2]-X$e,X$k[3]):X$k[1]==X$k[3]?X$a._tempPoints.push(X$k[0],X$k[1]+X$e,X$k[2],X$k[3]+X$e,X$k[0],X$k[1]-X$e,X$k[2],X$k[3]-X$e):X$a._tempPoints.push(X$k[0],X$k[1],X$k[2],X$k[3]),X$a._addPointArrToRst(X$p,X$a._tempPoints,X$q);break;case X$P._drawCurves:case 22:X$a._addPointArrToRst(X$p,X$Z.I.getBezierPoints(X$k[2]),X$q,X$k[0],X$k[1]);break;case X$P._drawPoly:case X$P._drawLines:case 18:X$a._addPointArrToRst(X$p,X$k[2],X$q,X$k[0],X$k[1]);break;case X$P._drawPath:case 19:X$a._addPointArrToRst(X$p,this._getPathPoints(X$k[2]),X$q,X$k[0],X$k[1]);break;case X$P._drawPie:case 15:X$a._addPointArrToRst(X$p,this._getPiePoints(X$k[0],X$k[1],X$k[2],X$k[3],X$k[4]),X$q)}return 200<X$p.length?X$p=X$g.copyArray(X$p,X$b._getWrapRec(X$p)._getBoundPoints()):8<X$p.length&&(X$p=X$H.scanPList(X$p)),X$p},X$m._switchMatrix=function(X$m,X$p){X$p.concat(X$m),X$p.copyTo(X$m)},X$m._getPiePoints=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$a._tempPoints;X$a._tempPoints.length=0,X$q.push(X$m,X$p);var X$k=(X$L-X$P)%(2*Math.PI)/10,X$Y=NaN,X$d=X$P;for(X$Y=0;X$Y<=10;X$Y++)X$q.push(X$m+X$h*Math.cos(X$d),X$p+X$h*Math.sin(X$d)),X$d+=X$k;return X$q},X$m._getPathPoints=function(X$m){var X$p,X$h,X$P=0,X$L=X$a._tempPoints;for(X$L.length=0,X$p=X$m.length,X$P=0;X$P<X$p;X$P++)1<(X$h=X$m[X$P]).length&&(X$L.push(X$h[1],X$h[2]),3<X$h.length&&X$L.push(X$h[3],X$h[4]));return X$L},X$a._addPointArrToRst=function(X$m,X$p,X$h,X$P,X$L){void 0===X$P&&(X$P=0),void 0===X$L&&(X$L=0);var X$q,X$k=0;for(X$q=X$p.length,X$k=0;X$k<X$q;X$k+=2)X$a._addPointToRst(X$m,X$p[X$k]+X$P,X$p[X$k+1]+X$L,X$h)},X$a._addPointToRst=function(X$m,X$p,X$h,X$P){var X$L=X$I.TEMP;X$L.setTo(X$p||0,X$h||0),X$P.transformPoint(X$L),X$m.push(X$L.x,X$L.y)},X$a._tempPoints=[],X$a._tempMatrixArrays=[],X$a._tempCmds=[],X$d(X$a,["_tempMatrix",function(){return this._tempMatrix=new X$M},"_initMatrix",function(){return this._initMatrix=new X$M}]),X$a}(),X$q=function(){function X$m(){}X$D(X$m,"laya.events.Event");var X$p=X$m.prototype;return X$p.setTo=function(X$m,X$p,X$h){return this.type=X$m,this.currentTarget=X$p,this.target=X$h,this},X$p.stopPropagation=function(){this._stoped=!0},X$A(0,X$p,"stageY",function(){return X$E.stage.mouseY}),X$A(0,X$p,"charCode",function(){return this.nativeEvent.charCode}),X$A(0,X$p,"touches",function(){var X$m=this.nativeEvent.touches;if(X$m)for(var X$p=X$E.stage,X$h=0,X$P=X$m.length;X$h<X$P;X$h++){var X$L=X$m[X$h],X$q=X$I.TEMP;X$q.setTo(X$L.clientX,X$L.clientY),X$p._canvasTransform.invertTransformPoint(X$q),X$p.transform.invertTransformPoint(X$q),X$L.stageX=X$q.x,X$L.stageY=X$q.y}return X$m}),X$A(0,X$p,"keyLocation",function(){return this.nativeEvent.keyLocation}),X$A(0,X$p,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),X$A(0,X$p,"altKey",function(){return this.nativeEvent.altKey}),X$A(0,X$p,"shiftKey",function(){return this.nativeEvent.shiftKey}),X$A(0,X$p,"stageX",function(){return X$E.stage.mouseX}),X$m.EMPTY=new X$m,X$m.MOUSE_DOWN="mousedown",X$m.MOUSE_UP="mouseup",X$m.CLICK="click",X$m.RIGHT_MOUSE_DOWN="rightmousedown",X$m.RIGHT_MOUSE_UP="rightmouseup",X$m.RIGHT_CLICK="rightclick",X$m.MOUSE_MOVE="mousemove",X$m.MOUSE_OVER="mouseover",X$m.MOUSE_OUT="mouseout",X$m.MOUSE_WHEEL="mousewheel",X$m.ROLL_OVER="mouseover",X$m.ROLL_OUT="mouseout",X$m.DOUBLE_CLICK="doubleclick",X$m.CHANGE="change",X$m.CHANGED="changed",X$m.RESIZE="resize",X$m.ADDED="added",X$m.REMOVED="removed",X$m.DISPLAY="display",X$m.UNDISPLAY="undisplay",X$m.ERROR="error",X$m.COMPLETE="complete",X$m.LOADED="loaded",X$m.INITED="inited",X$m.PROGRESS="progress",X$m.INPUT="input",X$m.RENDER="render",X$m.OPEN="open",X$m.MESSAGE="message",X$m.CLOSE="close",X$m.KEY_DOWN="keydown",X$m.KEY_PRESS="keypress",X$m.KEY_UP="keyup",X$m.FRAME="enterframe",X$m.DRAG_START="dragstart",X$m.DRAG_MOVE="dragmove",X$m.DRAG_END="dragend",X$m.ENTER="enter",X$m.SELECT="select",X$m.BLUR="blur",X$m.FOCUS="focus",X$m.VISIBILITY_CHANGE="visibilitychange",X$m.FOCUS_CHANGE="focuschange",X$m.PLAYED="played",X$m.PAUSED="paused",X$m.STOPPED="stopped",X$m.START="start",X$m.END="end",X$m.ENABLE_CHANGED="enablechanged",X$m.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",X$m.COMPONENT_ADDED="componentadded",X$m.COMPONENT_REMOVED="componentremoved",X$m.LAYER_CHANGED="layerchanged",X$m.HIERARCHY_LOADED="hierarchyloaded",X$m.RECOVERED="recovered",X$m.RELEASED="released",X$m.LINK="link",X$m.LABEL="label",X$m.FULL_SCREEN_CHANGE="fullscreenchange",X$m.DEVICE_LOST="devicelost",X$m.MESH_CHANGED="meshchanged",X$m.MATERIAL_CHANGED="materialchanged",X$m.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",X$m.ANIMATION_CHANGED="animationchanged",X$m.TRIGGER_ENTER="triggerenter",X$m.TRIGGER_STAY="triggerstay",X$m.TRIGGER_EXIT="triggerexit",X$m.TRAIL_FILTER_CHANGE="trailfilterchange",X$m.DOMINO_FILTER_CHANGE="dominofilterchange",X$m}(),X$F=(function(){function X$m(){}X$D(X$m,"laya.events.Keyboard"),X$m.NUMBER_0=48,X$m.NUMBER_1=49,X$m.NUMBER_2=50,X$m.NUMBER_3=51,X$m.NUMBER_4=52,X$m.NUMBER_5=53,X$m.NUMBER_6=54,X$m.NUMBER_7=55,X$m.NUMBER_8=56,X$m.NUMBER_9=57,X$m.A=65,X$m.B=66,X$m.C=67,X$m.D=68,X$m.E=69,X$m.F=70,X$m.G=71,X$m.H=72,X$m.I=73,X$m.J=74,X$m.K=75,X$m.L=76,X$m.M=77,X$m.N=78,X$m.O=79,X$m.P=80,X$m.Q=81,X$m.R=82,X$m.S=83,X$m.T=84,X$m.U=85,X$m.V=86,X$m.W=87,X$m.X=88,X$m.Y=89,X$m.Z=90,X$m.F1=112,X$m.F2=113,X$m.F3=114,X$m.F4=115,X$m.F5=116,X$m.F6=117,X$m.F7=118,X$m.F8=119,X$m.F9=120,X$m.F10=121,X$m.F11=122,X$m.F12=123,X$m.F13=124,X$m.F14=125,X$m.F15=126,X$m.NUMPAD=21,X$m.NUMPAD_0=96,X$m.NUMPAD_1=97,X$m.NUMPAD_2=98,X$m.NUMPAD_3=99,X$m.NUMPAD_4=100,X$m.NUMPAD_5=101,X$m.NUMPAD_6=102,X$m.NUMPAD_7=103,X$m.NUMPAD_8=104,X$m.NUMPAD_9=105,X$m.NUMPAD_ADD=107,X$m.NUMPAD_DECIMAL=110,X$m.NUMPAD_DIVIDE=111,X$m.NUMPAD_ENTER=108,X$m.NUMPAD_MULTIPLY=106,X$m.NUMPAD_SUBTRACT=109,X$m.SEMICOLON=186,X$m.EQUAL=187,X$m.COMMA=188,X$m.MINUS=189,X$m.PERIOD=190,X$m.SLASH=191,X$m.BACKQUOTE=192,X$m.LEFTBRACKET=219,X$m.BACKSLASH=220,X$m.RIGHTBRACKET=221,X$m.QUOTE=222,X$m.ALTERNATE=18,X$m.BACKSPACE=8,X$m.CAPS_LOCK=20,X$m.COMMAND=15,X$m.CONTROL=17,X$m.DELETE=46,X$m.ENTER=13,X$m.ESCAPE=27,X$m.PAGE_UP=33,X$m.PAGE_DOWN=34,X$m.END=35,X$m.HOME=36,X$m.LEFT=37,X$m.UP=38,X$m.RIGHT=39,X$m.DOWN=40,X$m.SHIFT=16,X$m.SPACE=32,X$m.TAB=9,X$m.INSERT=45}(),function(){function X$L(){}return X$D(X$L,"laya.events.KeyBoardManager"),X$L.__init__=function(){X$L._addEvent("keydown"),X$L._addEvent("keypress"),X$L._addEvent("keyup")},X$L._addEvent=function(X$p){X$w.document.addEventListener(X$p,function(X$m){laya.events.KeyBoardManager._dispatch(X$m,X$p)},!0)},X$L._dispatch=function(X$m,X$p){if(X$L.enabled){X$L._event._stoped=!1,X$L._event.nativeEvent=X$m,X$L._event.keyCode=X$m.keyCode||X$m.which||X$m.charCode,"keydown"===X$p?X$L._pressKeys[X$L._event.keyCode]=!0:"keyup"===X$p&&(X$L._pressKeys[X$L._event.keyCode]=null);for(var X$h=X$E.stage.focus&&null!=X$E.stage.focus.event&&X$E.stage.focus.displayedInStage?X$E.stage.focus:X$E.stage,X$P=X$h;X$P;)X$P.event(X$p,X$L._event.setTo(X$p,X$P,X$h)),X$P=X$P.parent}},X$L.hasKeyDown=function(X$m){return X$L._pressKeys[X$m]},X$L._pressKeys={},X$L.enabled=!0,X$d(X$L,["_event",function(){return this._event=new X$q}]),X$L}()),X$B=(function(){function X$m(){}X$D(X$m,"laya.events.KeyLocation"),X$m.STANDARD=0,X$m.LEFT=1,X$m.RIGHT=2,X$m.NUM_PAD=3}(),function(){function X$K(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=X$w.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new X$q,this._matrix=new X$M,this._point=new X$I,this._rect=new X$b,this._prePoint=new X$I,this._curTouchID=NaN}X$D(X$K,"laya.events.MouseManager");var X$m=X$K.prototype;return X$m.__init__=function(X$m,X$p){var X$h=this;this._stage=X$m;var X$P=this,X$L=this._eventList;X$p.oncontextmenu=function(X$m){if(X$K.enabled)return!1},X$p.addEventListener("mousedown",function(X$m){X$K.enabled&&(X$w.onIE||X$m.preventDefault(),X$L.push(X$m),X$P.mouseDownTime=X$w.now())}),X$p.addEventListener("mouseup",function(X$m){X$K.enabled&&(X$m.preventDefault(),X$L.push(X$m),X$P.mouseDownTime=-X$w.now())},!0),X$p.addEventListener("mousemove",function(X$m){if(X$K.enabled){X$m.preventDefault();var X$p=X$w.now();if(X$p-X$P._lastMoveTimer<10)return;X$P._lastMoveTimer=X$p,X$L.push(X$m)}},!0),X$p.addEventListener("mouseout",function(X$m){X$K.enabled&&X$L.push(X$m)}),X$p.addEventListener("mouseover",function(X$m){X$K.enabled&&X$L.push(X$m)}),X$p.addEventListener("touchstart",function(X$m){X$K.enabled&&(X$L.push(X$m),X$K._isFirstTouch||X$Hm.isInputting||X$m.preventDefault(),X$P.mouseDownTime=X$w.now())}),X$p.addEventListener("touchend",function(X$m){X$K.enabled?(X$K._isFirstTouch||X$Hm.isInputting||X$m.preventDefault(),X$K._isFirstTouch=!1,X$L.push(X$m),X$P.mouseDownTime=-X$w.now()):X$h._curTouchID=NaN},!0),X$p.addEventListener("touchmove",function(X$m){X$K.enabled&&(X$m.preventDefault(),X$L.push(X$m))},!0),X$p.addEventListener("touchcancel",function(X$m){X$K.enabled?(X$m.preventDefault(),X$L.push(X$m)):X$h._curTouchID=NaN},!0),X$p.addEventListener("mousewheel",function(X$m){X$K.enabled&&X$L.push(X$m)}),X$p.addEventListener("DOMMouseScroll",function(X$m){X$K.enabled&&X$L.push(X$m)})},X$m.initEvent=function(X$m,X$p){var X$h;this._event._stoped=!1,this._event.nativeEvent=X$p||X$m,this._target=null,this._point.setTo(X$m.pageX||X$m.clientX,X$m.pageY||X$m.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=X$m.identifier||0,this._tTouchID=this._event.touchId,(X$h=X$n.I._event)._stoped=!1,X$h.nativeEvent=this._event.nativeEvent,X$h.touchId=this._event.touchId},X$m.checkMouseWheel=function(X$m){this._event.delta=X$m.wheelDelta?.025*X$m.wheelDelta:-X$m.detail;for(var X$p=X$n.I.getLastOvers(),X$h=0,X$P=X$p.length;X$h<X$P;X$h++){var X$L=X$p[X$h];X$L.event("mousewheel",this._event.setTo("mousewheel",X$L,this._target))}},X$m.onMouseMove=function(X$m){X$n.I.onMouseMove(X$m,this._tTouchID)},X$m.onMouseDown=function(X$m){if(X$Hm.isInputting&&X$E.stage.focus&&X$E.stage.focus.focus&&!X$E.stage.focus.contains(this._target)){var X$p=X$E.stage.focus._tf||X$E.stage.focus,X$h=X$m._tf||X$m;X$h instanceof laya.display.Input&&X$h.multiline==X$p.multiline?X$p._focusOut():X$p.focus=!1}X$n.I.onMouseDown(X$m,this._tTouchID,this._isLeftMouse)},X$m.onMouseUp=function(X$m){X$n.I.onMouseUp(X$m,this._tTouchID,this._isLeftMouse)},X$m.check=function(X$m,X$p,X$h,X$P){this._point.setTo(X$p,X$h),X$m.fromParentPoint(this._point),X$p=this._point.x,X$h=this._point.y;var X$L=X$m.scrollRect;if(X$L&&(this._rect.setTo(X$L.x,X$L.y,X$L.width,X$L.height),!this._rect.contains(X$p,X$h)))return!1;if(!this.disableMouseEvent){if(X$m.hitTestPrior&&!X$m.mouseThrough&&!this.hitTest(X$m,X$p,X$h))return!1;for(var X$q=X$m._childs.length-1;-1<X$q;X$q--){var X$k=X$m._childs[X$q];if(!X$k.destroyed&&X$k.mouseEnabled&&X$k.visible&&this.check(X$k,X$p,X$h,X$P))return!0}}var X$Y=!(!X$m.hitTestPrior||X$m.mouseThrough||this.disableMouseEvent)||this.hitTest(X$m,X$p,X$h);return X$Y?(this._target=X$m,X$P.call(this,X$m)):X$P===this.onMouseUp&&X$m===this._stage&&(this._target=this._stage,X$P.call(this,this._target)),X$Y},X$m.hitTest=function(X$m,X$p,X$h){var X$P=!1;if(X$m.scrollRect&&(X$p-=X$m.scrollRect.x,X$h-=X$m.scrollRect.y),X$m.hitArea instanceof laya.utils.HitArea)return X$m.hitArea.isHit(X$p,X$h);if(0<X$m.width&&0<X$m.height||X$m.mouseThrough||X$m.hitArea)if(X$m.mouseThrough)X$P=X$m.getGraphicBounds().contains(X$p,X$h);else{var X$L=this._rect;X$m.hitArea?X$L=X$m.hitArea:X$L.setTo(0,0,X$m.width,X$m.height),X$P=X$L.contains(X$p,X$h)}return X$P},X$m.runEvent=function(){var X$m=this._eventList.length;if(X$m){this.mouseEventTime=X$w.now();var X$p,X$h=0,X$P=0,X$L=0;try{for(;X$h<X$m;){var X$q=this._eventList[X$h];switch("mousemove"!==X$q.type&&(this._prePoint.x=this._prePoint.y=-1e6),X$q.type){case"mousedown":this._touchIDs[0]=this._id++,X$K._isTouchRespond?X$K._isTouchRespond=!1:(this._isLeftMouse=0===X$q.button,this.initEvent(X$q),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===X$q.button,this.initEvent(X$q),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-X$q.clientX)+Math.abs(this._prePoint.y-X$q.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=X$q.clientX,this._prePoint.y=X$q.clientY,this.initEvent(X$q),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":X$K._isTouchRespond=!0,this._isLeftMouse=!0;var X$k=X$q.changedTouches;for(X$P=0,X$L=X$k.length;X$P<X$L;X$P++)X$p=X$k[X$P],(X$K.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=X$p.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[X$p.identifier]=this._id++,this.initEvent(X$p,X$q),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":X$K._isTouchRespond=!0,this._isLeftMouse=!0;var X$Y=X$q.changedTouches;for(X$P=0,X$L=X$Y.length;X$P<X$L;X$P++)if(X$p=X$Y[X$P],X$K.multiTouchEnabled||X$p.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(X$p,X$q);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var X$d=X$q.changedTouches;for(X$P=0,X$L=X$d.length;X$P<X$L;X$P++)X$p=X$d[X$P],(X$K.multiTouchEnabled||X$p.identifier==this._curTouchID)&&(this.initEvent(X$p,X$q),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(X$q);break;case"mouseout":X$n.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}X$h++}}catch(X$m){throw this._eventList.length=0,X$m}this._eventList.length=0}},X$K.enabled=!0,X$K.multiTouchEnabled=!0,X$K._isTouchRespond=!1,X$K._isFirstTouch=!0,X$d(X$K,["instance",function(){return this.instance=new X$K}]),X$K}()),X$n=function(){function X$A(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new X$q}X$D(X$A,"laya.events.TouchManager");var X$m=X$A.prototype;return X$m._clearTempArrs=function(){X$A._oldArr.length=0,X$A._newArr.length=0,X$A._tEleArr.length=0},X$m.getTouchFromArr=function(X$m,X$p){var X$h,X$P,X$L=0;for(X$h=X$p.length,X$L=0;X$L<X$h;X$L++)if((X$P=X$p[X$L]).id==X$m)return X$P;return null},X$m.removeTouchFromArr=function(X$m,X$p){var X$h=0;for(X$h=X$p.length-1;0<=X$h;X$h--)X$p[X$h].id==X$m&&X$p.splice(X$h,1)},X$m.createTouchO=function(X$m,X$p){var X$h;return(X$h=X$o.getItem("TouchData")||{}).id=X$p,X$h.tar=X$m,X$h},X$m.onMouseDown=function(X$m,X$p,X$h){var X$P,X$L,X$q,X$k;(void 0===X$h&&(X$h=!1),this.enable)&&(X$P=this.getTouchFromArr(X$p,this.preOvers),X$q=this.getEles(X$m,null,X$A._tEleArr),X$P?X$P.tar=X$m:(X$L=this.createTouchO(X$m,X$p),this.preOvers.push(X$L)),X$w.onMobile&&this.sendEvents(X$q,"mouseover",X$p),X$k=X$h?this.preDowns:this.preRightDowns,(X$P=this.getTouchFromArr(X$p,X$k))?X$P.tar=X$m:(X$L=this.createTouchO(X$m,X$p),X$k.push(X$L)),this.sendEvents(X$q,X$h?"mousedown":"rightmousedown",X$p),this._clearTempArrs())},X$m.sendEvents=function(X$m,X$p,X$h){void 0===X$h&&(X$h=0);var X$P,X$L,X$q,X$k=0;for(X$P=X$m.length,this._event._stoped=!1,X$L=X$m[0],X$k=0;X$k<X$P;X$k++){if((X$q=X$m[X$k]).destroyed)return;if(X$q.event(X$p,this._event.setTo(X$p,X$q,X$L)),this._event._stoped)break}},X$m.getEles=function(X$m,X$p,X$h){for(X$h?X$h.length=0:X$h=[];X$m&&X$m!=X$p;)X$h.push(X$m),X$m=X$m.parent;return X$h},X$m.checkMouseOutAndOverOfMove=function(X$m,X$p,X$h){if(void 0===X$h&&(X$h=0),X$p!=X$m){var X$P,X$L,X$q=0,X$k=0;if(X$p.contains(X$m))X$L=this.getEles(X$m,X$p,X$A._tEleArr),this.sendEvents(X$L,"mouseover",X$h);else if(X$m.contains(X$p))X$L=this.getEles(X$p,X$m,X$A._tEleArr),this.sendEvents(X$L,"mouseout",X$h);else{var X$Y,X$d;(X$L=X$A._tEleArr).length=0,X$Y=this.getEles(X$p,null,X$A._oldArr),X$d=this.getEles(X$m,null,X$A._newArr),X$k=X$Y.length;var X$K=0;for(X$q=0;X$q<X$k;X$q++){if(X$P=X$Y[X$q],0<=(X$K=X$d.indexOf(X$P))){X$d.splice(X$K,X$d.length-X$K);break}X$L.push(X$P)}0<X$L.length&&this.sendEvents(X$L,"mouseout",X$h),0<X$d.length&&this.sendEvents(X$d,"mouseover",X$h)}}},X$m.onMouseMove=function(X$m,X$p){var X$h,X$P;this.enable&&((X$h=this.getTouchFromArr(X$p,this.preOvers))?(this.checkMouseOutAndOverOfMove(X$m,X$h.tar),X$h.tar=X$m,X$P=this.getEles(X$m,null,X$A._tEleArr)):(X$P=this.getEles(X$m,null,X$A._tEleArr),this.sendEvents(X$P,"mouseover",X$p),this.preOvers.push(this.createTouchO(X$m,X$p))),this.sendEvents(X$P,"mousemove",X$p),this._clearTempArrs())},X$m.getLastOvers=function(){return(X$A._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,X$A._tEleArr):(X$A._tEleArr.push(X$E.stage),X$A._tEleArr)},X$m.stageMouseOut=function(){var X$m;X$m=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(X$m,"mouseout",0)},X$m.onMouseUp=function(X$m,X$p,X$h){if(void 0===X$h&&(X$h=!1),this.enable){var X$P,X$L,X$q,X$k,X$Y,X$d,X$K=0,X$D=0,X$F=X$w.onMobile;if(X$L=this.getEles(X$m,null,X$A._tEleArr),this.sendEvents(X$L,X$h?"mouseup":"rightmouseup",X$p),X$d=X$h?this.preDowns:this.preRightDowns,X$P=this.getTouchFromArr(X$p,X$d)){var X$R,X$$=X$w.now();if(X$R=X$$-this._lastClickTime<300,this._lastClickTime=X$$,X$m==X$P.tar)X$Y=X$L;else for(X$q=this.getEles(X$P.tar,null,X$A._oldArr),(X$Y=X$A._newArr).length=0,X$D=X$q.length,X$K=0;X$K<X$D;X$K++)X$k=X$q[X$K],0<=X$L.indexOf(X$k)&&X$Y.push(X$k);0<X$Y.length&&this.sendEvents(X$Y,X$h?"click":"rightclick",X$p),X$h&&X$R&&this.sendEvents(X$Y,"doubleclick",X$p),this.removeTouchFromArr(X$p,X$d),X$P.tar=null,X$o.recover("TouchData",X$P)}else;(X$P=this.getTouchFromArr(X$p,this.preOvers))&&X$F&&((X$Y=this.getEles(X$P.tar,null,X$Y))&&0<X$Y.length&&this.sendEvents(X$Y,"mouseout",X$p),this.removeTouchFromArr(X$p,this.preOvers),X$P.tar=null,X$o.recover("TouchData",X$P)),this._clearTempArrs()}},X$A._oldArr=[],X$A._newArr=[],X$A._tEleArr=[],X$d(X$A,["I",function(){return this.I=new X$A}]),X$A}(),X$c=function(){function X$m(){this._action=null}X$D(X$m,"laya.filters.Filter");var X$p=X$m.prototype;return X$E.imps(X$p,{"laya.filters.IFilter":!0}),X$p.callNative=function(X$m){},X$A(0,X$p,"type",function(){return-1}),X$A(0,X$p,"action",function(){return this._action}),X$m.BLUR=16,X$m.COLOR=32,X$m.GLOW=8,X$m._filterStart=null,X$m._filterEnd=null,X$m._EndTarget=null,X$m._recycleScope=null,X$m._filter=null,X$m._useSrc=null,X$m._endSrc=null,X$m._useOut=null,X$m._endOut=null,X$m}(),X$a=function(){function X$m(){this.data=null}X$D(X$m,"laya.filters.ColorFilterAction");var X$p=X$m.prototype;return X$E.imps(X$p,{"laya.filters.IFilterAction":!0}),X$p.apply=function(X$m){var X$p=X$m.ctx.ctx,X$h=X$m.ctx.ctx.canvas;if(0==X$h.width||0==X$h.height)return X$h;for(var X$P,X$L=X$p.getImageData(0,0,X$h.width,X$h.height),X$q=X$L.data,X$k=0,X$Y=X$q.length;X$k<X$Y;X$k+=4)X$P=this.getColor(X$q[X$k],X$q[X$k+1],X$q[X$k+2],X$q[X$k+3]),0!=X$q[X$k+3]&&(X$q[X$k]=X$P[0],X$q[X$k+1]=X$P[1],X$q[X$k+2]=X$P[2],X$q[X$k+3]=X$P[3]);return X$p.putImageData(X$L,0,0),X$m},X$p.getColor=function(X$m,X$p,X$h,X$P){var X$L=[];if(this.data._mat&&this.data._alpha){var X$q=this.data._mat,X$k=this.data._alpha;X$L[0]=X$q[0]*X$m+X$q[1]*X$p+X$q[2]*X$h+X$q[3]*X$P+X$k[0],X$L[1]=X$q[4]*X$m+X$q[5]*X$p+X$q[6]*X$h+X$q[7]*X$P+X$k[1],X$L[2]=X$q[8]*X$m+X$q[9]*X$p+X$q[10]*X$h+X$q[11]*X$P+X$k[2],X$L[3]=X$q[12]*X$m+X$q[13]*X$p+X$q[14]*X$h+X$q[15]*X$P+X$k[3]}return X$L},X$m}(),X$Z=(function(){function X$m(){}X$D(X$m,"laya.maths.Arith"),X$m.formatR=function(X$m){return X$m>Math.PI&&(X$m-=2*Math.PI),X$m<-Math.PI&&(X$m+=2*Math.PI),X$m},X$m.isPOT=function(X$m,X$p){return 0<X$m&&0==(X$m&X$m-1)&&0<X$p&&0==(X$p&X$p-1)},X$m.setMatToArray=function(X$m,X$p){X$m.a,X$m.b,X$m.c,X$m.d,X$m.tx,X$m.ty,X$p[0]=X$m.a,X$p[1]=X$m.b,X$p[4]=X$m.c,X$p[5]=X$m.d,X$p[12]=X$m.tx,X$p[13]=X$m.ty}}(),function(){function X$m(){this._controlPoints=[new X$I,new X$I,new X$I],this._calFun=this.getPoint2}X$D(X$m,"laya.maths.Bezier");var X$p=X$m.prototype;return X$p._switchPoint=function(X$m,X$p){var X$h=this._controlPoints.shift();X$h.setTo(X$m,X$p),this._controlPoints.push(X$h)},X$p.getPoint2=function(X$m,X$p){var X$h=this._controlPoints[0],X$P=this._controlPoints[1],X$L=this._controlPoints[2],X$q=Math.pow(1-X$m,2)*X$h.x+2*X$m*(1-X$m)*X$P.x+Math.pow(X$m,2)*X$L.x,X$k=Math.pow(1-X$m,2)*X$h.y+2*X$m*(1-X$m)*X$P.y+Math.pow(X$m,2)*X$L.y;X$p.push(X$q,X$k)},X$p.getPoint3=function(X$m,X$p){var X$h=this._controlPoints[0],X$P=this._controlPoints[1],X$L=this._controlPoints[2],X$q=this._controlPoints[3],X$k=Math.pow(1-X$m,3)*X$h.x+3*X$P.x*X$m*(1-X$m)*(1-X$m)+3*X$L.x*X$m*X$m*(1-X$m)+X$q.x*Math.pow(X$m,3),X$Y=Math.pow(1-X$m,3)*X$h.y+3*X$P.y*X$m*(1-X$m)*(1-X$m)+3*X$L.y*X$m*X$m*(1-X$m)+X$q.y*Math.pow(X$m,3);X$p.push(X$k,X$Y)},X$p.insertPoints=function(X$m,X$p){var X$h,X$P=NaN;for(X$h=1/(X$m=0<X$m?X$m:5),X$P=0;X$P<=1;X$P+=X$h)this._calFun(X$P,X$p)},X$p.getBezierPoints=function(X$m,X$p,X$h){void 0===X$p&&(X$p=5),void 0===X$h&&(X$h=2);var X$P,X$L,X$q=0;if((X$P=X$m.length)<2*(X$h+1))return[];switch(X$L=[],X$h){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=X$h;)this._controlPoints.push(new X$I);for(X$q=0;X$q<2*X$h;X$q+=2)this._switchPoint(X$m[X$q],X$m[X$q+1]);for(X$q=2*X$h;X$q<X$P;X$q+=2)this._switchPoint(X$m[X$q],X$m[X$q+1]),X$q/2%X$h==0&&this.insertPoints(X$p,X$L);return X$L},X$d(X$m,["I",function(){return this.I=new X$m}]),X$m}()),X$H=function(){function X$K(){}return X$D(X$K,"laya.maths.GrahamScan"),X$K.multiply=function(X$m,X$p,X$h){return(X$m.x-X$h.x)*(X$p.y-X$h.y)-(X$p.x-X$h.x)*(X$m.y-X$h.y)},X$K.dis=function(X$m,X$p){return(X$m.x-X$p.x)*(X$m.x-X$p.x)+(X$m.y-X$p.y)*(X$m.y-X$p.y)},X$K._getPoints=function(X$m,X$p,X$h){for(void 0===X$p&&(X$p=!1),X$K._mPointList||(X$K._mPointList=[]);X$K._mPointList.length<X$m;)X$K._mPointList.push(new X$I);return X$h||(X$h=[]),X$h.length=0,X$p?X$K.getFrom(X$h,X$K._mPointList,X$m):X$K.getFromR(X$h,X$K._mPointList,X$m),X$h},X$K.getFrom=function(X$m,X$p,X$h){var X$P=0;for(X$P=0;X$P<X$h;X$P++)X$m.push(X$p[X$P]);return X$m},X$K.getFromR=function(X$m,X$p,X$h){var X$P=0;for(X$P=0;X$P<X$h;X$P++)X$m.push(X$p.pop());return X$m},X$K.pListToPointList=function(X$m,X$p){void 0===X$p&&(X$p=!1);var X$h=0,X$P=X$m.length/2,X$L=X$K._getPoints(X$P,X$p,X$K._tempPointList);for(X$h=0;X$h<X$P;X$h++)X$L[X$h].setTo(X$m[X$h+X$h],X$m[X$h+X$h+1]);return X$L},X$K.pointListToPlist=function(X$m){var X$p,X$h=0,X$P=X$m.length,X$L=X$K._temPList;for(X$h=X$L.length=0;X$h<X$P;X$h++)X$p=X$m[X$h],X$L.push(X$p.x,X$p.y);return X$L},X$K.scanPList=function(X$m){return X$g.copyArray(X$m,X$K.pointListToPlist(X$K.scan(X$K.pListToPointList(X$m,!0))))},X$K.scan=function(X$m){var X$p,X$h,X$P,X$L=0,X$q=0,X$k=0,X$Y=X$m.length,X$d={};for((X$h=X$K._temArr).length=0,X$L=(X$Y=X$m.length)-1;0<=X$L;X$L--)X$P=(X$p=X$m[X$L]).x+"_"+X$p.y,X$d.hasOwnProperty(X$P)||(X$d[X$P]=!0,X$h.push(X$p));for(X$Y=X$h.length,X$g.copyArray(X$m,X$h),X$L=1;X$L<X$Y;X$L++)(X$m[X$L].y<X$m[X$k].y||X$m[X$L].y==X$m[X$k].y&&X$m[X$L].x<X$m[X$k].x)&&(X$k=X$L);for(X$p=X$m[0],X$m[0]=X$m[X$k],X$m[X$k]=X$p,X$L=1;X$L<X$Y-1;X$L++){for(X$q=(X$k=X$L)+1;X$q<X$Y;X$q++)(0<X$K.multiply(X$m[X$q],X$m[X$k],X$m[0])||0==X$K.multiply(X$m[X$q],X$m[X$k],X$m[0])&&X$K.dis(X$m[0],X$m[X$q])<X$K.dis(X$m[0],X$m[X$k]))&&(X$k=X$q);X$p=X$m[X$L],X$m[X$L]=X$m[X$k],X$m[X$k]=X$p}if((X$h=X$K._temArr).length=0,X$m.length<3)return X$g.copyArray(X$h,X$m);for(X$h.push(X$m[0],X$m[1],X$m[2]),X$L=3;X$L<X$Y;X$L++){for(;2<=X$h.length&&0<=X$K.multiply(X$m[X$L],X$h[X$h.length-1],X$h[X$h.length-2]);)X$h.pop();X$m[X$L]&&X$h.push(X$m[X$L])}return X$h},X$K._mPointList=null,X$K._tempPointList=[],X$K._temPList=[],X$K._temArr=[],X$K}(),X$W=function(){function X$L(){}return X$D(X$L,"laya.maths.MathUtil"),X$L.subtractVector3=function(X$m,X$p,X$h){X$h[0]=X$m[0]-X$p[0],X$h[1]=X$m[1]-X$p[1],X$h[2]=X$m[2]-X$p[2]},X$L.lerp=function(X$m,X$p,X$h){return X$m*(1-X$h)+X$p*X$h},X$L.scaleVector3=function(X$m,X$p,X$h){X$h[0]=X$m[0]*X$p,X$h[1]=X$m[1]*X$p,X$h[2]=X$m[2]*X$p},X$L.lerpVector3=function(X$m,X$p,X$h,X$P){var X$L=X$m[0],X$q=X$m[1],X$k=X$m[2];X$P[0]=X$L+X$h*(X$p[0]-X$L),X$P[1]=X$q+X$h*(X$p[1]-X$q),X$P[2]=X$k+X$h*(X$p[2]-X$k)},X$L.lerpVector4=function(X$m,X$p,X$h,X$P){var X$L=X$m[0],X$q=X$m[1],X$k=X$m[2],X$Y=X$m[3];X$P[0]=X$L+X$h*(X$p[0]-X$L),X$P[1]=X$q+X$h*(X$p[1]-X$q),X$P[2]=X$k+X$h*(X$p[2]-X$k),X$P[3]=X$Y+X$h*(X$p[3]-X$Y)},X$L.slerpQuaternionArray=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){var X$Y,X$d,X$K,X$D,X$F,X$R=X$m[X$p+0],X$$=X$m[X$p+1],X$A=X$m[X$p+2],X$B=X$m[X$p+3],X$n=X$h[X$P+0],X$c=X$h[X$P+1],X$e=X$h[X$P+2],X$a=X$h[X$P+3];return(X$d=X$R*X$n+X$$*X$c+X$A*X$e+X$B*X$a)<0&&(X$d=-X$d,X$n=-X$n,X$c=-X$c,X$e=-X$e,X$a=-X$a),X$F=1e-6<1-X$d?(X$Y=Math.acos(X$d),X$K=Math.sin(X$Y),X$D=Math.sin((1-X$L)*X$Y)/X$K,Math.sin(X$L*X$Y)/X$K):(X$D=1-X$L,X$L),X$q[X$k+0]=X$D*X$R+X$F*X$n,X$q[X$k+1]=X$D*X$$+X$F*X$c,X$q[X$k+2]=X$D*X$A+X$F*X$e,X$q[X$k+3]=X$D*X$B+X$F*X$a,X$q},X$L.getRotation=function(X$m,X$p,X$h,X$P){return Math.atan2(X$P-X$p,X$h-X$m)/Math.PI*180},X$L.sortBigFirst=function(X$m,X$p){return X$m==X$p?0:X$m<X$p?1:-1},X$L.sortSmallFirst=function(X$m,X$p){return X$m==X$p?0:X$m<X$p?-1:1},X$L.sortNumBigFirst=function(X$m,X$p){return parseFloat(X$p)-parseFloat(X$m)},X$L.sortNumSmallFirst=function(X$m,X$p){return parseFloat(X$m)-parseFloat(X$p)},X$L.sortByKey=function(X$h,X$m,X$p){var X$P;return void 0===X$m&&(X$m=!1),void 0===X$p&&(X$p=!0),X$P=X$m?X$p?X$L.sortNumBigFirst:X$L.sortBigFirst:X$p?X$L.sortNumSmallFirst:X$L.sortSmallFirst,function(X$m,X$p){return X$P(X$m[X$h],X$p[X$h])}},X$L}(),X$M=function(){function X$h(X$m,X$p,X$h,X$P,X$L,X$q){this.inPool=!1,this.bTransform=!1,void 0===X$m&&(X$m=1),void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=1),void 0===X$L&&(X$L=0),void 0===X$q&&(X$q=0),this.a=X$m,this.b=X$p,this.c=X$h,this.d=X$P,this.tx=X$L,this.ty=X$q,this._checkTransform()}X$D(X$h,"laya.maths.Matrix");var X$m=X$h.prototype;return X$m.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},X$m._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},X$m.setTranslate=function(X$m,X$p){return this.tx=X$m,this.ty=X$p,this},X$m.translate=function(X$m,X$p){return this.tx+=X$m,this.ty+=X$p,this},X$m.scale=function(X$m,X$p){this.a*=X$m,this.d*=X$p,this.c*=X$m,this.b*=X$p,this.tx*=X$m,this.ty*=X$p,this.bTransform=!0},X$m.rotate=function(X$m){var X$p=Math.cos(X$m),X$h=Math.sin(X$m),X$P=this.a,X$L=this.c,X$q=this.tx;this.a=X$P*X$p-this.b*X$h,this.b=X$P*X$h+this.b*X$p,this.c=X$L*X$p-this.d*X$h,this.d=X$L*X$h+this.d*X$p,this.tx=X$q*X$p-this.ty*X$h,this.ty=X$q*X$h+this.ty*X$p,this.bTransform=!0},X$m.skew=function(X$m,X$p){var X$h=Math.tan(X$m),X$P=Math.tan(X$p),X$L=this.a,X$q=this.b;return this.a+=X$P*this.c,this.b+=X$P*this.d,this.c+=X$h*X$L,this.d+=X$h*X$q,this},X$m.invertTransformPoint=function(X$m){var X$p=this.a,X$h=this.b,X$P=this.c,X$L=this.d,X$q=this.tx,X$k=X$p*X$L-X$h*X$P,X$Y=X$L/X$k,X$d=-X$h/X$k,X$K=-X$P/X$k,X$D=X$p/X$k,X$F=(X$P*this.ty-X$L*X$q)/X$k,X$R=-(X$p*this.ty-X$h*X$q)/X$k;return X$m.setTo(X$Y*X$m.x+X$K*X$m.y+X$F,X$d*X$m.x+X$D*X$m.y+X$R)},X$m.transformPoint=function(X$m){return X$m.setTo(this.a*X$m.x+this.c*X$m.y+this.tx,this.b*X$m.x+this.d*X$m.y+this.ty)},X$m.transformPointN=function(X$m){return X$m.setTo(this.a*X$m.x+this.c*X$m.y,this.b*X$m.x+this.d*X$m.y)},X$m.transformPointArray=function(X$m,X$p){for(var X$h=X$m.length,X$P=0;X$P<X$h;X$P+=2){var X$L=X$m[X$P],X$q=X$m[X$P+1];X$p[X$P]=this.a*X$L+this.c*X$q+this.tx,X$p[X$P+1]=this.b*X$L+this.d*X$q+this.ty}return X$p},X$m.transformPointArrayScale=function(X$m,X$p){for(var X$h=X$m.length,X$P=0;X$P<X$h;X$P+=2){var X$L=X$m[X$P],X$q=X$m[X$P+1];X$p[X$P]=this.a*X$L+this.c*X$q,X$p[X$P+1]=this.b*X$L+this.d*X$q}return X$p},X$m.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},X$m.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},X$m.invert=function(){var X$m=this.a,X$p=this.b,X$h=this.c,X$P=this.d,X$L=this.tx,X$q=X$m*X$P-X$p*X$h;return this.a=X$P/X$q,this.b=-X$p/X$q,this.c=-X$h/X$q,this.d=X$m/X$q,this.tx=(X$h*this.ty-X$P*X$L)/X$q,this.ty=-(X$m*this.ty-X$p*X$L)/X$q,this},X$m.setTo=function(X$m,X$p,X$h,X$P,X$L,X$q){return this.a=X$m,this.b=X$p,this.c=X$h,this.d=X$P,this.tx=X$L,this.ty=X$q,this},X$m.concat=function(X$m){var X$p=this.a,X$h=this.c,X$P=this.tx;return this.a=X$p*X$m.a+this.b*X$m.c,this.b=X$p*X$m.b+this.b*X$m.d,this.c=X$h*X$m.a+this.d*X$m.c,this.d=X$h*X$m.b+this.d*X$m.d,this.tx=X$P*X$m.a+this.ty*X$m.c+X$m.tx,this.ty=X$P*X$m.b+this.ty*X$m.d+X$m.ty,this},X$m.scaleEx=function(X$m,X$p){var X$h=this.a,X$P=this.b,X$L=this.c,X$q=this.d;0!==X$P||0!==X$L?(this.a=X$m*X$h,this.b=X$m*X$P,this.c=X$p*X$L):(this.a=X$m*X$h,this.b=0*X$q,this.c=0*X$h),this.d=X$p*X$q,this.bTransform=!0},X$m.rotateEx=function(X$m){var X$p=Math.cos(X$m),X$h=Math.sin(X$m),X$P=this.a,X$L=this.b,X$q=this.c,X$k=this.d;0!==X$L||0!==X$q?(this.a=X$p*X$P+X$h*X$q,this.b=X$p*X$L+X$h*X$k,this.c=-X$h*X$P+X$p*X$q,this.d=-X$h*X$L+X$p*X$k):(this.a=X$p*X$P,this.b=X$h*X$k,this.c=-X$h*X$P,this.d=X$p*X$k),this.bTransform=!0},X$m.clone=function(){var X$m=X$h.create();return X$m.a=this.a,X$m.b=this.b,X$m.c=this.c,X$m.d=this.d,X$m.tx=this.tx,X$m.ty=this.ty,X$m.bTransform=this.bTransform,X$m},X$m.copyTo=function(X$m){return X$m.a=this.a,X$m.b=this.b,X$m.c=this.c,X$m.d=this.d,X$m.tx=this.tx,X$m.ty=this.ty,X$m.bTransform=this.bTransform,X$m},X$m.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},X$m.destroy=function(){if(!this.inPool){var X$m=X$h._cache;this.inPool=!0,X$m._length||(X$m._length=0),(X$m[X$m._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},X$h.mul=function(X$m,X$p,X$h){var X$P=X$m.a,X$L=X$m.b,X$q=X$m.c,X$k=X$m.d,X$Y=X$m.tx,X$d=X$m.ty,X$K=X$p.a,X$D=X$p.b,X$F=X$p.c,X$R=X$p.d,X$$=X$p.tx,X$A=X$p.ty;return 0!==X$D||0!==X$F?(X$h.a=X$P*X$K+X$L*X$F,X$h.b=X$P*X$D+X$L*X$R,X$h.c=X$q*X$K+X$k*X$F,X$h.d=X$q*X$D+X$k*X$R,X$h.tx=X$K*X$Y+X$F*X$d+X$$,X$h.ty=X$D*X$Y+X$R*X$d+X$A):(X$h.a=X$P*X$K,X$h.b=X$L*X$R,X$h.c=X$q*X$K,X$h.d=X$k*X$R,X$h.tx=X$K*X$Y+X$$,X$h.ty=X$R*X$d+X$A),X$h},X$h.mul16=function(X$m,X$p,X$h){var X$P=X$m.a,X$L=X$m.b,X$q=X$m.c,X$k=X$m.d,X$Y=X$m.tx,X$d=X$m.ty,X$K=X$p.a,X$D=X$p.b,X$F=X$p.c,X$R=X$p.d,X$$=X$p.tx,X$A=X$p.ty;return 0!==X$D||0!==X$F?(X$h[0]=X$P*X$K+X$L*X$F,X$h[1]=X$P*X$D+X$L*X$R,X$h[4]=X$q*X$K+X$k*X$F,X$h[5]=X$q*X$D+X$k*X$R,X$h[12]=X$K*X$Y+X$F*X$d+X$$,X$h[13]=X$D*X$Y+X$R*X$d+X$A):(X$h[0]=X$P*X$K,X$h[1]=X$L*X$R,X$h[4]=X$q*X$K,X$h[5]=X$k*X$R,X$h[12]=X$K*X$Y+X$$,X$h[13]=X$R*X$d+X$A),X$h},X$h.mulPre=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){var X$d=X$m.a,X$K=X$m.b,X$D=X$m.c,X$F=X$m.d,X$R=X$m.tx,X$$=X$m.ty;return 0!==X$h||0!==X$P?(X$Y.a=X$d*X$p+X$K*X$P,X$Y.b=X$d*X$h+X$K*X$L,X$Y.c=X$D*X$p+X$F*X$P,X$Y.d=X$D*X$h+X$F*X$L,X$Y.tx=X$p*X$R+X$P*X$$+X$q,X$Y.ty=X$h*X$R+X$L*X$$+X$k):(X$Y.a=X$d*X$p,X$Y.b=X$K*X$L,X$Y.c=X$D*X$p,X$Y.d=X$F*X$L,X$Y.tx=X$p*X$R+X$q,X$Y.ty=X$L*X$$+X$k),X$Y},X$h.mulPos=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){var X$d=X$m.a,X$K=X$m.b,X$D=X$m.c,X$F=X$m.d,X$R=X$m.tx,X$$=X$m.ty;return 0!==X$K||0!==X$D?(X$Y.a=X$p*X$d+X$h*X$D,X$Y.b=X$p*X$K+X$h*X$F,X$Y.c=X$P*X$d+X$L*X$D,X$Y.d=X$P*X$K+X$L*X$F,X$Y.tx=X$d*X$q+X$D*X$k+X$R,X$Y.ty=X$K*X$q+X$F*X$k+X$$):(X$Y.a=X$p*X$d,X$Y.b=X$h*X$F,X$Y.c=X$P*X$d,X$Y.d=X$L*X$F,X$Y.tx=X$d*X$q+X$R,X$Y.ty=X$F*X$k+X$$),X$Y},X$h.preMul=function(X$m,X$p,X$h){var X$P=X$m.a,X$L=X$m.b,X$q=X$m.c,X$k=X$m.d,X$Y=X$p.a,X$d=X$p.b,X$K=X$p.c,X$D=X$p.d,X$F=X$p.tx,X$R=X$p.ty;return X$h.a=X$Y*X$P,X$h.b=X$h.c=0,X$h.d=X$D*X$k,X$h.tx=X$F*X$P+X$m.tx,X$h.ty=X$R*X$k+X$m.ty,0===X$d&&0===X$K&&0===X$L&&0===X$q||(X$h.a+=X$d*X$q,X$h.d+=X$K*X$L,X$h.b+=X$Y*X$L+X$d*X$k,X$h.c+=X$K*X$P+X$D*X$q,X$h.tx+=X$R*X$q,X$h.ty+=X$F*X$L),X$h},X$h.preMulXY=function(X$m,X$p,X$h,X$P){var X$L=X$m.a,X$q=X$m.b,X$k=X$m.c,X$Y=X$m.d;return X$P.a=X$L,X$P.b=X$q,X$P.c=X$k,X$P.d=X$Y,X$P.tx=X$p*X$L+X$m.tx+X$h*X$k,X$P.ty=X$h*X$Y+X$m.ty+X$p*X$q,X$P},X$h.create=function(){var X$m=X$h._cache,X$p=X$m._length?X$m[--X$m._length]:new X$h;return X$p.inPool=!1,X$p},X$h.EMPTY=new X$h,X$h.TEMP=new X$h,X$h._cache=[],X$h}(),X$I=function(){function X$m(X$m,X$p){void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),this.x=X$m,this.y=X$p}X$D(X$m,"laya.maths.Point");var X$p=X$m.prototype;return X$p.setTo=function(X$m,X$p){return this.x=X$m,this.y=X$p,this},X$p.distance=function(X$m,X$p){return Math.sqrt((this.x-X$m)*(this.x-X$m)+(this.y-X$p)*(this.y-X$p))},X$p.toString=function(){return this.x+","+this.y},X$p.normalize=function(){var X$m=Math.sqrt(this.x*this.x+this.y*this.y);if(0<X$m){var X$p=1/X$m;this.x*=X$p,this.y*=X$p}},X$m.TEMP=new X$m,X$m.EMPTY=new X$m,X$m}(),X$b=function(){function X$K(X$m,X$p,X$h,X$P){void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=0),this.x=X$m,this.y=X$p,this.width=X$h,this.height=X$P}X$D(X$K,"laya.maths.Rectangle");var X$m=X$K.prototype;return X$m.setTo=function(X$m,X$p,X$h,X$P){return this.x=X$m,this.y=X$p,this.width=X$h,this.height=X$P,this},X$m.copyFrom=function(X$m){return this.x=X$m.x,this.y=X$m.y,this.width=X$m.width,this.height=X$m.height,this},X$m.contains=function(X$m,X$p){return!(this.width<=0||this.height<=0)&&(X$m>=this.x&&X$m<this.right&&X$p>=this.y&&X$p<this.bottom)},X$m.intersects=function(X$m){return!(X$m.x>this.x+this.width||X$m.x+X$m.width<this.x||X$m.y>this.y+this.height||X$m.y+X$m.height<this.y)},X$m.intersection=function(X$m,X$p){return this.intersects(X$m)?(X$p||(X$p=new X$K),X$p.x=Math.max(this.x,X$m.x),X$p.y=Math.max(this.y,X$m.y),X$p.width=Math.min(this.right,X$m.right)-X$p.x,X$p.height=Math.min(this.bottom,X$m.bottom)-X$p.y,X$p):null},X$m.union=function(X$m,X$p){return X$p||(X$p=new X$K),this.clone(X$p),X$m.width<=0||X$m.height<=0?X$p:(X$p.addPoint(X$m.x,X$m.y),X$p.addPoint(X$m.right,X$m.bottom),this)},X$m.clone=function(X$m){return X$m||(X$m=new X$K),X$m.x=this.x,X$m.y=this.y,X$m.width=this.width,X$m.height=this.height,X$m},X$m.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},X$m.equals=function(X$m){return!(!X$m||X$m.x!==this.x||X$m.y!==this.y||X$m.width!==this.width||X$m.height!==this.height)},X$m.addPoint=function(X$m,X$p){return this.x>X$m&&(this.width+=this.x-X$m,this.x=X$m),this.y>X$p&&(this.height+=this.y-X$p,this.y=X$p),this.width<X$m-this.x&&(this.width=X$m-this.x),this.height<X$p-this.y&&(this.height=X$p-this.y),this},X$m._getBoundPoints=function(){var X$m=X$K._temB;return(X$m.length=0)==this.width||0==this.height||X$m.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),X$m},X$m.isEmpty=function(){return this.width<=0||this.height<=0},X$A(0,X$m,"right",function(){return this.x+this.width}),X$A(0,X$m,"bottom",function(){return this.y+this.height}),X$K._getBoundPointS=function(X$m,X$p,X$h,X$P){var X$L=X$K._temA;return(X$L.length=0)==X$h||0==X$P||X$L.push(X$m,X$p,X$m+X$h,X$p,X$m,X$p+X$P,X$m+X$h,X$p+X$P),X$L},X$K._getWrapRec=function(X$m,X$p){if(!X$m||X$m.length<1)return X$p?X$p.setTo(0,0,0,0):X$K.TEMP.setTo(0,0,0,0);X$p=X$p||new X$K;var X$h,X$P,X$L,X$q,X$k,X$Y=X$m.length,X$d=X$I.TEMP;for(X$L=X$k=-(X$P=X$q=99999),X$h=0;X$h<X$Y;X$h+=2)X$d.x=X$m[X$h],X$d.y=X$m[X$h+1],X$P=X$P<X$d.x?X$P:X$d.x,X$q=X$q<X$d.y?X$q:X$d.y,X$L=X$L>X$d.x?X$L:X$d.x,X$k=X$k>X$d.y?X$k:X$d.y;return X$p.setTo(X$P,X$q,X$L-X$P,X$k-X$q)},X$K.EMPTY=new X$K,X$K.TEMP=new X$K,X$K._temB=[],X$K._temA=[],X$K}(),X$x=function(){function X$d(){}return X$D(X$d,"laya.media.SoundManager"),X$A(1,X$d,"useAudioMusic",function(){return X$d._useAudioMusic},function(X$m){X$d._useAudioMusic=X$m,X$d._musicClass=X$m?X$hm:null}),X$A(1,X$d,"autoStopMusic",function(){return X$d._autoStopMusic},function(X$m){X$E.stage.off("blur",null,X$d._stageOnBlur),X$E.stage.off("focus",null,X$d._stageOnFocus),X$E.stage.off("visibilitychange",null,X$d._visibilityChange),(X$d._autoStopMusic=X$m)&&(X$E.stage.on("blur",null,X$d._stageOnBlur),X$E.stage.on("focus",null,X$d._stageOnFocus),X$E.stage.on("visibilitychange",null,X$d._visibilityChange))}),X$A(1,X$d,"muted",function(){return X$d._muted},function(X$m){X$m!=X$d._muted&&(X$m&&X$d.stopAllSound(),X$d.musicMuted=X$m,X$d._muted=X$m)}),X$A(1,X$d,"musicMuted",function(){return X$d._musicMuted},function(X$m){X$m!=X$d._musicMuted&&(X$m?(X$d._tMusic&&X$d._musicChannel&&!X$d._musicChannel.isStopped?X$d._musicChannel.pause():X$d._musicChannel=null,X$d._musicMuted=X$m):(X$d._musicMuted=X$m,X$d._tMusic&&X$d._musicChannel&&X$d._musicChannel.resume()))}),X$A(1,X$d,"soundMuted",function(){return X$d._soundMuted},function(X$m){X$d._soundMuted=X$m}),X$d.addChannel=function(X$m){0<=X$d._channels.indexOf(X$m)||(X$d._channels.push(X$m),X$d.autoReleaseSound&&0!=X$d._notUsedCount&&X$d._notUsedUrls[X$m.url]&&(delete X$d._notUsedUrls[X$m.url],0==--X$d._notUsedCount&&X$E.timer.clear(X$d,X$d.disposeSoundIfNotUsed)))},X$d.removeChannel=function(X$m){var X$p=X$d._channels,X$h=X$p.indexOf(X$m);if(-1!=X$h&&(X$p.splice(X$h,1),X$d.autoReleaseSound)){var X$P=X$m.url,X$L=X$d.defaultIntervals[X$P]||2e4;if(0<X$L){var X$q=!0;for(X$h=X$p.length-1;0<=X$h;X$h--)if(X$p[X$h].url==X$P){X$q=!1;break}X$q&&(X$d._notUsedUrls[X$P]=Date.now()+X$L,0==X$d._notUsedCount++&&X$E.timer.loop(1e4,X$d,X$d.disposeSoundIfNotUsed))}}},X$d.disposeSoundIfNotUsed=function(){var X$m=X$d._notUsedUrls;if(0!=X$d._notUsedCount){var X$p=Date.now();for(var X$h in X$m)X$p>=X$m[X$h]&&(delete X$m[X$h],--X$d._notUsedCount,X$d.destroySound(X$h));if(0!=X$d._notUsedCount)return}X$E.timer.clear(X$d,X$d.disposeSoundIfNotUsed)},X$d._visibilityChange=function(){X$E.stage.isVisibility?X$d._stageOnFocus():X$d._stageOnBlur()},X$d._stageOnBlur=function(){X$d._isActive=!1,X$d._musicChannel&&(X$d._musicChannel.isStopped||(X$d._blurPaused=!0,X$d._musicChannel.pause())),X$d.stopAllSound(),X$E.stage.once("mousedown",null,X$d._stageOnFocus)},X$d._recoverWebAudio=function(){X$qm.ctx&&"running"!=X$qm.ctx.state&&X$qm.ctx.resume&&X$qm.ctx.resume()},X$d._stageOnFocus=function(){if(X$d._isActive=!0,X$d._recoverWebAudio(),X$E.stage.off("mousedown",null,X$d._stageOnFocus),X$d._blurPaused){var X$m=X$d._musicChannel;X$m&&X$d._music&&X$m.isStopped&&(X$d._blurPaused=!1,X$d._music._disposed?X$d.playMusic(X$m.url,X$m.loops,X$m.startHandler,X$m.completeHandler,X$m.startTime):X$m.audioBuffer?X$m.resume():X$d._music.play(X$m.startTime,X$m.loops,X$m.startHandler,X$m))}},X$d.playSound=function(X$m,X$p,X$h,X$P,X$L,X$q){if(void 0===X$p&&(X$p=1),void 0===X$q&&(X$q=0),!X$m)return null;if(X$d._muted)return null;if(X$d._recoverWebAudio(),X$m==X$d._tMusic){if(X$d._musicMuted)return null}else{if(!X$d._isActive)return null;if(X$d._soundMuted)return null}var X$k,X$Y=X$d._pool[X$m];return X$L||(X$L=X$d._soundClass),X$Y||((X$Y=new X$L).load(X$m),X$d._pool[X$m]=X$Y),(X$k=X$Y.play(X$q,X$p,X$h))?(X$m==X$d._tMusic&&(X$d._music=X$Y,X$d._isActive||(X$d._blurPaused=!0,X$k.pause())),X$k.url=X$m,X$k.volume=X$m==X$d._tMusic?X$d.musicVolume:X$d.soundVolume,X$k.completeHandler=X$P,X$k):null},X$d.destroySound=function(X$m){var X$p=X$d._pool[X$m];X$p&&(delete X$d._pool[X$m],X$p.dispose())},X$d.playMusic=function(X$m,X$p,X$h,X$P,X$L){return void 0===X$p&&(X$p=0),void 0===X$L&&(X$L=0),X$d._tMusic=X$m,X$d._musicChannel&&X$d._musicChannel.stop(),X$d._musicChannel=X$d.playSound(X$m,X$p,X$h,X$P,null,X$L)},X$d.stopSound=function(X$m){for(var X$p,X$h=X$d._channels.length-1;0<=X$h;X$h--)(X$p=X$d._channels[X$h]).url==X$m&&X$p.stop()},X$d.stopAll=function(){X$d._tMusic=null;var X$m=0;for(X$m=X$d._channels.length-1;0<=X$m;X$m--)X$d._channels[X$m].stop()},X$d.stopAllSound=function(){var X$m,X$p=0;for(X$p=X$d._channels.length-1;0<=X$p;X$p--)(X$m=X$d._channels[X$p]).url!=X$d._tMusic&&X$m.stop()},X$d.stopMusic=function(){X$d._musicChannel&&X$d._musicChannel.stop(),X$d._tMusic=null},X$d.setSoundVolume=function(X$m,X$p){if(X$p)X$d._setVolume(X$p,X$m);else{X$d.soundVolume=X$m;var X$h,X$P=0;for(X$P=X$d._channels.length-1;0<=X$P;X$P--)(X$h=X$d._channels[X$P]).url!=X$d._tMusic&&(X$h.volume=X$m)}},X$d.setMusicVolume=function(X$m){X$d.musicVolume=X$m,X$d._setVolume(X$d._tMusic,X$m)},X$d._setVolume=function(X$m,X$p){for(var X$h,X$P=X$d._channels.length-1;0<=X$P;X$P--)(X$h=X$d._channels[X$P]).url==X$m&&(X$h.volume=X$p)},X$d.musicVolume=1,X$d.soundVolume=1,X$d.playbackRate=1,X$d._useAudioMusic=!0,X$d._muted=!1,X$d._soundMuted=!1,X$d._musicMuted=!1,X$d._tMusic=null,X$d._musicChannel=null,X$d._music=null,X$d._channels=[],X$d._autoStopMusic=!1,X$d._blurPaused=!1,X$d._isActive=!0,X$d._soundClass=null,X$d._musicClass=null,X$d.autoReleaseSound=!0,X$d._pool={},X$d.defaultIntervals={},X$d._notUsedUrls={},X$d._notUsedCount=0,X$d}(),X$T=function(){var X$m;function X$h(){}return X$D(X$h,"laya.net.LocalStorage"),X$h.__init__=function(){X$h._baseClass||(X$h._baseClass=X$m).init(),X$h.items=X$h._baseClass.items,X$h.support=X$h._baseClass.support},X$h.setItem=function(X$m,X$p){X$h._baseClass.setItem(X$m,X$p)},X$h.getItem=function(X$m){return X$h._baseClass.getItem(X$m)},X$h.setJSON=function(X$m,X$p){X$h._baseClass.setJSON(X$m,X$p)},X$h.getJSON=function(X$m){return X$h._baseClass.getJSON(X$m)},X$h.removeItem=function(X$m){X$h._baseClass.removeItem(X$m)},X$h.clear=function(){X$h._baseClass.clear()},X$h._baseClass=null,X$h.items=null,X$h.support=!1,X$h.__init$=function(){X$m=function(){function X$h(){}return X$D(X$h,""),X$h.init=function(){try{X$h.support=!0,X$h.items=X$k.localStorage,X$h.setItem("laya","1"),X$h.removeItem("laya")}catch(X$m){X$h.support=!1}X$h.support||console.log("LocalStorage is not supprot or browser is private mode.")},X$h.setItem=function(X$m,X$p){try{X$h.support&&X$h.items.setItem(X$m,X$p)}catch(X$m){console.warn("set localStorage failed",X$m)}},X$h.getItem=function(X$m){return X$h.support?X$h.items.getItem(X$m):null},X$h.setJSON=function(X$m,X$p){try{X$h.support&&X$h.items.setItem(X$m,JSON.stringify(X$p))}catch(X$m){console.warn("set localStorage failed",X$m)}},X$h.getJSON=function(X$m){return JSON.parse(X$h.support?X$h.items.getItem(X$m):null)},X$h.removeItem=function(X$m){X$h.support&&X$h.items.removeItem(X$m)},X$h.clear=function(){X$h.support&&X$h.items.clear()},X$h.items=null,X$h.support=!1,X$h}()},X$h}(),X$u=(function(){function X$P(){}X$D(X$P,"laya.net.ResourceVersion"),X$P.enable=function(X$m,X$p,X$h){void 0===X$h&&(X$h=2),laya.net.ResourceVersion.type=X$h,X$E.loader.load(X$m,X$e.create(null,X$P.onManifestLoaded,[X$p]),null,"json"),X$N.customFormat=X$P.addVersionPrefix},X$P.onManifestLoaded=function(X$m,X$p){X$P.manifest=X$p,X$m.run(),X$p||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},X$P.addVersionPrefix=function(X$m){return X$P.manifest&&X$P.manifest[X$m]?2==X$P.type?X$P.manifest[X$m]:X$P.manifest[X$m]+"/"+X$m:X$m},X$P.FOLDER_VERSION=1,X$P.FILENAME_VERSION=2,X$P.manifest=null,X$P.type=1}(),function(){function X$m(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}X$D(X$m,"laya.net.TTFLoader");var X$p=X$m.prototype;return X$p.load=function(X$m){var X$p=(this._url=X$m).split(".ttf")[0].split("/");this.fontName=X$p[X$p.length-1],X$w.window.conch?this._loadConch():X$w.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},X$p._loadConch=function(){this._http=new X$km,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},X$p._onHttpLoaded=function(X$m){X$w.window.conch.setFontFaceFromBuffer(this.fontName,X$m),this._clearHttp(),this._complete()},X$p._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},X$p._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},X$p._complete=function(){X$E.timer.clear(this,this._complete),X$E.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},X$p._checkComplete=function(){X$Q.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},X$p._loadWithFontFace=function(){var X$m=new X$w.window.FontFace(this.fontName,"url('"+this._url+"')");X$w.window.document.fonts.add(X$m);var X$p=this;X$m.loaded.then(function(){X$p._complete()}),X$m.load()},X$p._createDiv=function(){this._div=X$w.createElement("div"),this._div.innerHTML="laya";var X$m=this._div.style;X$m.fontFamily=this.fontName,X$m.position="absolute",X$m.left="-100px",X$m.top="-100px",X$w.document.body.appendChild(this._div)},X$p._loadWithCSS=function(){var X$m=this,X$p=X$w.createElement("style");X$p.type="text/css",X$w.document.body.appendChild(X$p),X$p.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=X$Q.measureText("LayaTTFFont",this._fontTxt).width;var X$h=this;X$p.onload=function(){X$E.timer.once(1e4,X$h,X$m._complete)},X$E.timer.loop(20,this,this._checkComplete),this._createDiv()},X$m._testString="LayaTTFFont",X$m}()),X$N=function(){function X$P(X$m){this._url=null,this._path=null,this._url=X$P.formatURL(X$m),this._path=X$P.getPath(X$m)}X$D(X$P,"laya.net.URL");var X$m=X$P.prototype;return X$A(0,X$m,"path",function(){return this._path}),X$A(0,X$m,"url",function(){return this._url}),X$P.formatURL=function(X$m,X$p){if(!X$m)return"null path";if(0<X$m.indexOf(":"))return X$m;null!=X$P.customFormat&&(X$m=X$P.customFormat(X$m,X$p));var X$h=X$m.charAt(0);if("."===X$h)return X$P.formatRelativePath((X$p||X$P.basePath)+X$m);if("~"===X$h)return X$P.rootPath+X$m.substring(1);if("d"===X$h){if(0===X$m.indexOf("data:image"))return X$m}else if("/"===X$h)return X$m;return(X$p||X$P.basePath)+X$m},X$P.formatRelativePath=function(X$m){for(var X$p=X$m.split("/"),X$h=0,X$P=X$p.length;X$h<X$P;X$h++)".."==X$p[X$h]&&(X$p.splice(X$h-1,2),X$h-=2);return X$p.join("/")},X$P.isAbsolute=function(X$m){return 0<X$m.indexOf(":")||"/"==X$m.charAt(0)},X$P.getPath=function(X$m){var X$p=X$m.lastIndexOf("/");return 0<X$p?X$m.substr(0,X$p+1):""},X$P.getFileName=function(X$m){var X$p=X$m.lastIndexOf("/");return 0<X$p?X$m.substr(X$p+1):X$m},X$P.version={},X$P.basePath="",X$P.rootPath="",X$P.customFormat=function(X$m){var X$p=X$P.version[X$m];return!X$S.isConchApp&&X$p&&(X$m+="?v="+X$p),X$m},X$P}(),X$S=function(){function X$L(X$m,X$p){this._timeId=0;var X$h=X$L._mainCanvas.source.style;X$h.position="absolute",X$h.top=X$h.left="0px",X$h.background="#000000",X$L._mainCanvas.source.id="layaCanvas";var X$P=laya.renders.Render.isWebGL;X$L._mainCanvas.source.width=X$m,X$L._mainCanvas.source.height=X$p,X$P&&X$L.WebGL.init(X$L._mainCanvas,X$m,X$p),X$w.container.appendChild(X$L._mainCanvas.source),(X$L._context=new X$_(X$m,X$p,X$P?null:X$L._mainCanvas)).ctx.setIsMainContext(),X$w.window.requestAnimationFrame(function X$m(X$p){X$w.window.requestAnimationFrame(X$m);X$E.stage._loop()}),X$E.stage.on("visibilitychange",this,this._onVisibilitychange)}X$D(X$L,"laya.renders.Render");var X$m=X$L.prototype;return X$m._onVisibilitychange=function(){X$E.stage.isVisibility?0!=this._timeId&&X$w.window.clearInterval(this._timeId):this._timeId=X$w.window.setInterval(this._enterFrame,1e3)},X$m._enterFrame=function(X$m){X$E.stage._loop()},X$A(1,X$L,"context",function(){return X$L._context}),X$A(1,X$L,"canvas",function(){return X$L._mainCanvas.source}),X$L._context=null,X$L._mainCanvas=null,X$L.WebGL=null,X$L.isConchNode=!1,X$L.isConchApp=!1,X$L.isConchWebGL=!1,X$L.isWebGL=!1,X$L.is3DMode=!1,X$L.optimizeTextureMemory=function(X$m,X$p){return!0},X$L.__init$=function(){X$k.ConchRenderType=X$k.ConchRenderType||1,X$k.ConchRenderType|=X$k.conch?4:0,X$L.isConchNode=5==(5&X$k.ConchRenderType),X$L.isConchApp=4==(4&X$k.ConchRenderType),X$L.isConchWebGL=6==X$k.ConchRenderType},X$L}(),X$_=function(){function X$k(X$m,X$p,X$h){this.x=0,this.y=0,this._drawTexture=function(X$m,X$p,X$h){X$h[0].loaded&&this.ctx.drawTexture(X$h[0],X$h[1],X$h[2],X$h[3],X$h[4],X$m,X$p)},this._fillTexture=function(X$m,X$p,X$h){X$h[0].loaded&&this.ctx.fillTexture(X$h[0],X$h[1]+X$m,X$h[2]+X$p,X$h[3],X$h[4],X$h[5],X$h[6],X$h[7])},this._drawTextureWithTransform=function(X$m,X$p,X$h){X$h[0].loaded&&this.ctx.drawTextureWithTransform(X$h[0],X$h[1],X$h[2],X$h[3],X$h[4],X$h[5],X$m,X$p,X$h[6])},this._fillQuadrangle=function(X$m,X$p,X$h){this.ctx.fillQuadrangle(X$h[0],X$h[1],X$h[2],X$h[3],X$h[4])},this._drawRect=function(X$m,X$p,X$h){var X$P=this.ctx;null!=X$h[4]&&(X$P.fillStyle=X$h[4],X$P.fillRect(X$m+X$h[0],X$p+X$h[1],X$h[2],X$h[3],null)),null!=X$h[5]&&(X$P.strokeStyle=X$h[5],X$P.lineWidth=X$h[6],X$P.strokeRect(X$m+X$h[0],X$p+X$h[1],X$h[2],X$h[3],X$h[6]))},this._drawPie=function(X$m,X$p,X$h){var X$P=this.ctx;X$S.isWebGL&&X$P.setPathId(X$h[8]),X$P.beginPath(),X$S.isWebGL?(X$P.movePath(X$h[0]+X$m,X$h[1]+X$p),X$P.moveTo(0,0)):X$P.moveTo(X$m+X$h[0],X$p+X$h[1]),X$P.arc(X$m+X$h[0],X$p+X$h[1],X$h[2],X$h[3],X$h[4]),X$P.closePath(),this._fillAndStroke(X$h[5],X$h[6],X$h[7],!0)},this._clipRect=function(X$m,X$p,X$h){this.ctx.clipRect(X$m+X$h[0],X$p+X$h[1],X$h[2],X$h[3])},this._fillRect=function(X$m,X$p,X$h){this.ctx.fillRect(X$m+X$h[0],X$p+X$h[1],X$h[2],X$h[3],X$h[4])},this._drawCircle=function(X$m,X$p,X$h){var X$P=this.ctx;X$S.isWebGL&&X$P.setPathId(X$h[6]),X$f.drawCall++,X$P.beginPath(),X$S.isWebGL&&X$P.movePath(X$h[0]+X$m,X$h[1]+X$p),X$P.arc(X$h[0]+X$m,X$h[1]+X$p,X$h[2],0,X$k.PI2),X$P.closePath(),this._fillAndStroke(X$h[3],X$h[4],X$h[5],!0)},this._fillCircle=function(X$m,X$p,X$h){X$f.drawCall++;var X$P=this.ctx;X$P.beginPath(),X$P.fillStyle=X$h[3],X$P.arc(X$h[0]+X$m,X$h[1]+X$p,X$h[2],0,X$k.PI2),X$P.fill()},this._setShader=function(X$m,X$p,X$h){this.ctx.setShader(X$h[0])},this._drawLine=function(X$m,X$p,X$h){var X$P=this.ctx;X$S.isWebGL&&X$P.setPathId(X$h[6]),X$P.beginPath(),X$P.strokeStyle=X$h[4],X$P.lineWidth=X$h[5],X$S.isWebGL?(X$P.movePath(X$m,X$p),X$P.moveTo(X$h[0],X$h[1]),X$P.lineTo(X$h[2],X$h[3])):(X$P.moveTo(X$m+X$h[0],X$p+X$h[1]),X$P.lineTo(X$m+X$h[2],X$p+X$h[3])),X$P.stroke()},this._drawLines=function(X$m,X$p,X$h){var X$P=this.ctx;X$S.isWebGL&&X$P.setPathId(X$h[5]),X$P.beginPath(),X$m+=X$h[0],X$p+=X$h[1],X$S.isWebGL&&X$P.movePath(X$m,X$p),X$P.strokeStyle=X$h[3],X$P.lineWidth=X$h[4];var X$L=X$h[2],X$q=2,X$k=X$L.length;if(X$S.isWebGL)for(X$P.moveTo(X$L[0],X$L[1]);X$q<X$k;)X$P.lineTo(X$L[X$q++],X$L[X$q++]);else for(X$P.moveTo(X$m+X$L[0],X$p+X$L[1]);X$q<X$k;)X$P.lineTo(X$m+X$L[X$q++],X$p+X$L[X$q++]);X$P.stroke()},this._drawLinesWebGL=function(X$m,X$p,X$h){this.ctx.drawLines(X$m+this.x+X$h[0],X$p+this.y+X$h[1],X$h[2],X$h[3],X$h[4])},this._drawCurves=function(X$m,X$p,X$h){this.ctx.drawCurves(X$m,X$p,X$h)},this._draw=function(X$m,X$p,X$h){X$h[0].call(null,this,X$m,X$p)},this._transformByMatrix=function(X$m,X$p,X$h){this.ctx.transformByMatrix(X$h[0])},this._setTransform=function(X$m,X$p,X$h){this.ctx.setTransform(X$h[0],X$h[1],X$h[2],X$h[3],X$h[4],X$h[5])},this._setTransformByMatrix=function(X$m,X$p,X$h){this.ctx.setTransformByMatrix(X$h[0])},this._save=function(X$m,X$p,X$h){this.ctx.save()},this._restore=function(X$m,X$p,X$h){this.ctx.restore()},this._translate=function(X$m,X$p,X$h){this.ctx.translate(X$h[0],X$h[1])},this._transform=function(X$m,X$p,X$h){this.ctx.translate(X$h[1]+X$m,X$h[2]+X$p);var X$P=X$h[0];this.ctx.transform(X$P.a,X$P.b,X$P.c,X$P.d,X$P.tx,X$P.ty),this.ctx.translate(-X$m-X$h[1],-X$p-X$h[2])},this._rotate=function(X$m,X$p,X$h){this.ctx.translate(X$h[1]+X$m,X$h[2]+X$p),this.ctx.rotate(X$h[0]),this.ctx.translate(-X$m-X$h[1],-X$p-X$h[2])},this._scale=function(X$m,X$p,X$h){this.ctx.translate(X$h[2]+X$m,X$h[3]+X$p),this.ctx.scale(X$h[0],X$h[1]),this.ctx.translate(-X$m-X$h[2],-X$p-X$h[3])},this._alpha=function(X$m,X$p,X$h){this.ctx.globalAlpha*=X$h[0]},this._setAlpha=function(X$m,X$p,X$h){this.ctx.globalAlpha=X$h[0]},this._fillText=function(X$m,X$p,X$h){this.ctx.fillText(X$h[0],X$h[1]+X$m,X$h[2]+X$p,X$h[3],X$h[4],X$h[5])},this._strokeText=function(X$m,X$p,X$h){this.ctx.strokeText(X$h[0],X$h[1]+X$m,X$h[2]+X$p,X$h[3],X$h[4],X$h[5],X$h[6])},this._fillBorderText=function(X$m,X$p,X$h){this.ctx.fillBorderText(X$h[0],X$h[1]+X$m,X$h[2]+X$p,X$h[3],X$h[4],X$h[5],X$h[6],X$h[7])},this._blendMode=function(X$m,X$p,X$h){this.ctx.globalCompositeOperation=X$h[0]},this._beginClip=function(X$m,X$p,X$h){this.ctx.beginClip&&this.ctx.beginClip(X$m+X$h[0],X$p+X$h[1],X$h[2],X$h[3])},this._setIBVB=function(X$m,X$p,X$h){this.ctx.setIBVB(X$h[0]+X$m,X$h[1]+X$p,X$h[2],X$h[3],X$h[4],X$h[5],X$h[6],X$h[7])},this._fillTrangles=function(X$m,X$p,X$h){this.ctx.fillTrangles(X$h[0],X$h[1]+X$m,X$h[2]+X$p,X$h[3],X$h[4])},this._drawPath=function(X$m,X$p,X$h){var X$P=this.ctx;X$S.isWebGL&&X$P.setPathId(-1),X$P.beginPath(),X$m+=X$h[0],X$p+=X$h[1],X$S.isWebGL&&X$P.movePath(X$m,X$p);for(var X$L=X$h[2],X$q=0,X$k=X$L.length;X$q<X$k;X$q++){var X$Y=X$L[X$q];switch(X$Y[0]){case"moveTo":X$S.isWebGL?X$P.moveTo(X$Y[1],X$Y[2]):X$P.moveTo(X$m+X$Y[1],X$p+X$Y[2]);break;case"lineTo":X$S.isWebGL?X$P.lineTo(X$Y[1],X$Y[2]):X$P.lineTo(X$m+X$Y[1],X$p+X$Y[2]);break;case"arcTo":X$S.isWebGL?X$P.arcTo(X$Y[1],X$Y[2],X$Y[3],X$Y[4],X$Y[5]):X$P.arcTo(X$m+X$Y[1],X$p+X$Y[2],X$m+X$Y[3],X$p+X$Y[4],X$Y[5]);break;case"closePath":X$P.closePath()}}var X$d=X$h[3];null!=X$d&&(X$P.fillStyle=X$d.fillStyle,X$P.fill());var X$K=X$h[4];null!=X$K&&(X$P.strokeStyle=X$K.strokeStyle,X$P.lineWidth=X$K.lineWidth||1,X$P.lineJoin=X$K.lineJoin,X$P.lineCap=X$K.lineCap,X$P.miterLimit=X$K.miterLimit,X$P.stroke())},this.drawPoly=function(X$m,X$p,X$h){this.ctx.drawPoly(X$m+this.x+X$h[0],X$p+this.y+X$h[1],X$h[2],X$h[3],X$h[4],X$h[5],X$h[6])},this._drawPoly=function(X$m,X$p,X$h){var X$P=this.ctx,X$L=X$h[2],X$q=2,X$k=X$L.length;if(X$S.isWebGL)for(X$P.setPathId(X$h[6]),X$P.beginPath(),X$m+=X$h[0],X$p+=X$h[1],X$P.movePath(X$m,X$p),X$P.moveTo(X$L[0],X$L[1]);X$q<X$k;)X$P.lineTo(X$L[X$q++],X$L[X$q++]);else for(X$P.beginPath(),X$m+=X$h[0],X$p+=X$h[1],X$P.moveTo(X$m+X$L[0],X$p+X$L[1]);X$q<X$k;)X$P.lineTo(X$m+X$L[X$q++],X$p+X$L[X$q++]);X$P.closePath(),this._fillAndStroke(X$h[3],X$h[4],X$h[5],X$h[7])},this._drawSkin=function(X$m,X$p,X$h){var X$P=X$h[0];if(X$P){var X$L=this.ctx;X$P.render(X$L,X$m,X$p)}},this._drawParticle=function(X$m,X$p,X$h){this.ctx.drawParticle(X$m+this.x,X$p+this.y,X$h[0])},this._setFilters=function(X$m,X$p,X$h){this.ctx.setFilters(X$h)},X$h?this.ctx=X$h.getContext("2d"):(X$h=X$am.create("3D"),this.ctx=X$Q.createWebGLContext2D(X$h),X$h._setContext(this.ctx)),X$h.size(X$m,X$p),this.canvas=X$h}X$D(X$k,"laya.renders.RenderContext");var X$m=X$k.prototype;return X$m.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},X$m.drawTexture=function(X$m,X$p,X$h,X$P,X$L){X$m.loaded&&this.ctx.drawTexture(X$m,X$p,X$h,X$P,X$L,this.x,this.y)},X$m._drawTextures=function(X$m,X$p,X$h){X$h[0].loaded&&this.ctx.drawTextures(X$h[0],X$h[1],X$m+this.x,X$p+this.y)},X$m.drawTextureWithTransform=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){X$m.loaded&&this.ctx.drawTextureWithTransform(X$m,X$p,X$h,X$P,X$L,X$q,this.x,this.y,X$k)},X$m.fillQuadrangle=function(X$m,X$p,X$h,X$P,X$L){this.ctx.fillQuadrangle(X$m,X$p,X$h,X$P,X$L)},X$m.drawCanvas=function(X$m,X$p,X$h,X$P,X$L){this.ctx.drawCanvas(X$m,X$p+this.x,X$h+this.y,X$P,X$L)},X$m.drawRect=function(X$m,X$p,X$h,X$P,X$L,X$q){void 0===X$q&&(X$q=1);var X$k=this.ctx;X$k.strokeStyle=X$L,X$k.lineWidth=X$q,X$k.strokeRect(X$m+this.x,X$p+this.y,X$h,X$P,X$q)},X$m._fillAndStroke=function(X$m,X$p,X$h,X$P){void 0===X$P&&(X$P=!1);var X$L=this.ctx;null!=X$m&&(X$L.fillStyle=X$m,X$S.isWebGL?X$L.fill(X$P):X$L.fill()),null!=X$p&&0<X$h&&(X$L.strokeStyle=X$p,X$L.lineWidth=X$h,X$L.stroke())},X$m.clipRect=function(X$m,X$p,X$h,X$P){this.ctx.clipRect(X$m+this.x,X$p+this.y,X$h,X$P)},X$m.fillRect=function(X$m,X$p,X$h,X$P,X$L){this.ctx.fillRect(X$m+this.x,X$p+this.y,X$h,X$P,X$L)},X$m.drawCircle=function(X$m,X$p,X$h,X$P,X$L){void 0===X$L&&(X$L=1),X$f.drawCall++;var X$q=this.ctx;X$q.beginPath(),X$q.strokeStyle=X$P,X$q.lineWidth=X$L,X$q.arc(X$m+this.x,X$p+this.y,X$h,0,X$k.PI2),X$q.stroke()},X$m.drawTriangles=function(X$m,X$p,X$h){if(X$S.isWebGL)this.ctx.drawTriangles(X$h[0],X$m+X$h[1],X$p+X$h[2],X$h[3],X$h[4],X$h[5],X$h[6],X$h[7],X$h[8],X$h[9]);else{var X$P=X$h[5],X$L=0,X$q=X$P.length,X$k=this.ctx;for(X$L=0;X$L<X$q;X$L+=3){var X$Y=2*X$P[X$L],X$d=2*X$P[X$L+1],X$K=2*X$P[X$L+2];X$k.drawTriangle(X$h[0],X$h[3],X$h[4],X$Y,X$d,X$K,X$h[6],!0)}}},X$m.fillCircle=function(X$m,X$p,X$h,X$P){X$f.drawCall++;var X$L=this.ctx;X$L.beginPath(),X$L.fillStyle=X$P,X$L.arc(X$m+this.x,X$p+this.y,X$h,0,X$k.PI2),X$L.fill()},X$m.setShader=function(X$m){this.ctx.setShader(X$m)},X$m.drawLine=function(X$m,X$p,X$h,X$P,X$L,X$q){void 0===X$q&&(X$q=1);var X$k=this.ctx;X$k.beginPath(),X$k.strokeStyle=X$L,X$k.lineWidth=X$q,X$k.moveTo(this.x+X$m,this.y+X$p),X$k.lineTo(this.x+X$h,this.y+X$P),X$k.stroke()},X$m.clear=function(){this.ctx.clear()},X$m.transformByMatrix=function(X$m){this.ctx.transformByMatrix(X$m)},X$m.setTransform=function(X$m,X$p,X$h,X$P,X$L,X$q){this.ctx.setTransform(X$m,X$p,X$h,X$P,X$L,X$q)},X$m.setTransformByMatrix=function(X$m){this.ctx.setTransformByMatrix(X$m)},X$m.save=function(){this.ctx.save()},X$m.restore=function(){this.ctx.restore()},X$m.translate=function(X$m,X$p){this.ctx.translate(X$m,X$p)},X$m.transform=function(X$m,X$p,X$h,X$P,X$L,X$q){this.ctx.transform(X$m,X$p,X$h,X$P,X$L,X$q)},X$m.rotate=function(X$m){this.ctx.rotate(X$m)},X$m.scale=function(X$m,X$p){this.ctx.scale(X$m,X$p)},X$m.alpha=function(X$m){this.ctx.globalAlpha*=X$m},X$m.setAlpha=function(X$m){this.ctx.globalAlpha=X$m},X$m.fillWords=function(X$m,X$p,X$h,X$P,X$L,X$q){void 0===X$q&&(X$q=0),this.ctx.fillWords(X$m,X$p,X$h,X$P,X$L,X$q)},X$m.fillBorderWords=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this.ctx.fillBorderWords(X$m,X$p,X$h,X$P,X$L,X$q,X$k)},X$m.fillText=function(X$m,X$p,X$h,X$P,X$L,X$q){this.ctx.fillText(X$m,X$p+this.x,X$h+this.y,X$P,X$L,X$q)},X$m.strokeText=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this.ctx.strokeText(X$m,X$p+this.x,X$h+this.y,X$P,X$L,X$q,X$k)},X$m.blendMode=function(X$m){this.ctx.globalCompositeOperation=X$m},X$m.flush=function(){this.ctx.flush&&this.ctx.flush()},X$m.addRenderObject=function(X$m){this.ctx.addRenderObject(X$m)},X$m.beginClip=function(X$m,X$p,X$h,X$P){this.ctx.beginClip&&this.ctx.beginClip(X$m,X$p,X$h,X$P)},X$m.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},X$m.fillTrangles=function(X$m,X$p,X$h){this.ctx.fillTrangles(X$h[0],X$h[1],X$h[2],X$h[3],4<X$h.length?X$h[4]:null)},X$k.PI2=2*Math.PI,X$k}(),X$l=function(){function X$k(X$m,X$p){switch(this._next=X$p||X$k.NORENDER,X$m){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=X$c._filter);case 69905:return void(this._fun=X$k._initRenderFun)}this.onCreate(X$m)}X$D(X$k,"laya.renders.RenderSprite");var X$m=X$k.prototype;return X$m.onCreate=function(X$m){},X$m._style=function(X$m,X$p,X$h,X$P){X$m._style.render(X$m,X$p,X$h,X$P);var X$L=this._next;X$L._fun.call(X$L,X$m,X$p,X$h,X$P)},X$m._no=function(X$m,X$p,X$h,X$P){},X$m._custom=function(X$m,X$p,X$h,X$P){X$m.customRender(X$p,X$h,X$P);var X$L=X$m._style._tf;this._next._fun.call(this._next,X$m,X$p,X$h-X$L.translateX,X$P-X$L.translateY)},X$m._clip=function(X$m,X$p,X$h,X$P){var X$L=this._next;if(X$L!=X$k.NORENDER){var X$q=X$m._style.scrollRect;X$p.ctx.save(),X$p.ctx.clipRect(X$h,X$P,X$q.width,X$q.height),X$L._fun.call(X$L,X$m,X$p,X$h-X$q.x,X$P-X$q.y),X$p.ctx.restore()}},X$m._blend=function(X$m,X$p,X$h,X$P){var X$L=X$m._style;X$L.blendMode&&(X$p.ctx.globalCompositeOperation=X$L.blendMode);var X$q=this._next;X$q._fun.call(X$q,X$m,X$p,X$h,X$P),X$p.ctx.globalCompositeOperation="source-over"},X$m._mask=function(X$m,X$p,X$h,X$P){var X$L=this._next;X$L._fun.call(X$L,X$m,X$p,X$h,X$P);var X$q=X$m.mask;X$q&&(X$p.ctx.globalCompositeOperation="destination-in",(0<X$q.numChildren||!X$q.graphics._isOnlyOne())&&(X$q.cacheAsBitmap=!0),X$q.render(X$p,X$h-X$m.pivotX,X$P-X$m.pivotY)),X$p.ctx.globalCompositeOperation="source-over"},X$m._graphics=function(X$m,X$p,X$h,X$P){var X$L=X$m._style._tf;X$m._graphics&&X$m._graphics._render(X$m,X$p,X$h-X$L.translateX,X$P-X$L.translateY);var X$q=this._next;X$q._fun.call(X$q,X$m,X$p,X$h,X$P)},X$m._image=function(X$m,X$p,X$h,X$P){var X$L=X$m._style;X$p.ctx.drawTexture2(X$h,X$P,X$L._tf.translateX,X$L._tf.translateY,X$m.transform,X$L.alpha,X$L.blendMode,X$m._graphics._one)},X$m._image2=function(X$m,X$p,X$h,X$P){var X$L=X$m._style._tf;X$p.ctx.drawTexture2(X$h,X$P,X$L.translateX,X$L.translateY,X$m.transform,1,null,X$m._graphics._one)},X$m._alpha=function(X$m,X$p,X$h,X$P){var X$L;if(.01<(X$L=X$m._style.alpha)||X$m._needRepaint()){var X$q=X$p.ctx.globalAlpha;X$p.ctx.globalAlpha*=X$L;var X$k=this._next;X$k._fun.call(X$k,X$m,X$p,X$h,X$P),X$p.ctx.globalAlpha=X$q}},X$m._transform=function(X$m,X$p,X$h,X$P){var X$L=X$m.transform,X$q=this._next;X$L&&X$q!=X$k.NORENDER?(X$p.save(),X$p.transform(X$L.a,X$L.b,X$L.c,X$L.d,X$L.tx+X$h,X$L.ty+X$P),X$q._fun.call(X$q,X$m,X$p,0,0),X$p.restore()):X$q._fun.call(X$q,X$m,X$p,X$h,X$P)},X$m._childs=function(X$m,X$p,X$h,X$P){var X$L=X$m._style,X$q=X$L._tf;if(X$h=X$h-X$q.translateX+X$L.paddingLeft,X$P=X$P-X$q.translateY+X$L.paddingTop,X$L._calculation){var X$k=X$m._getWords();if(X$k){var X$Y=X$L;X$Y&&(X$Y.stroke?X$p.fillBorderWords(X$k,X$h,X$P,X$Y.font,X$Y.color,X$Y.strokeColor,X$Y.stroke):X$p.fillWords(X$k,X$h,X$P,X$Y.font,X$Y.color,"none"!=X$Y.textDecoration&&X$Y.underLine?1:0))}}var X$d,X$K=X$m._childs,X$D=X$K.length;if(X$m.viewport||X$m.optimizeScrollRect&&X$m._style.scrollRect){var X$F=X$m.viewport||X$m._style.scrollRect,X$R=X$F.x,X$$=X$F.y,X$A=X$F.right,X$B=X$F.bottom,X$n=NaN,X$c=NaN;for(X$e=0;X$e<X$D;++X$e)(X$d=X$K[X$e]).visible&&(X$n=X$d._x)<X$A&&X$n+X$d.width>X$R&&(X$c=X$d._y)<X$B&&X$c+X$d.height>X$$&&X$d.render(X$p,X$h,X$P)}else for(var X$e=0;X$e<X$D;++X$e)(X$d=X$K[X$e])._style.visible&&X$d.render(X$p,X$h,X$P)},X$m._canvas=function(X$m,X$p,X$h,X$P){var X$L=X$m._$P.cacheCanvas;if(X$L){"bitmap"===X$L.type?X$f.canvasBitmap++:X$f.canvasNormal++;var X$q=X$L.ctx;if(X$m._needRepaint()||!X$q)this._canvas_repaint(X$m,X$p,X$h,X$P);else{var X$k=X$L._cacheRec;X$p.drawCanvas(X$q.canvas,X$h+X$k.x,X$P+X$k.y,X$k.width,X$k.height)}}else this._next._fun.call(this._next,X$m,X$p,X$h,X$P)},X$m._canvas_repaint=function(X$m,X$p,X$h,X$P){var X$L=X$m._$P.cacheCanvas,X$q=this._next;if(X$L){var X$k,X$Y,X$d,X$K,X$D=X$L.ctx,X$F=X$m._needRepaint()||!X$D,X$R=X$L.type;if("bitmap"===X$R?X$f.canvasBitmap++:X$f.canvasNormal++,X$F){var X$$,X$A;X$L._cacheRec||(X$L._cacheRec=new X$b),X$S.isWebGL&&"bitmap"!==X$R?X$L._cacheRec.setTo(-X$m.pivotX,-X$m.pivotY,1,1):((X$K=X$m.getSelfBounds()).x=X$K.x-X$m.pivotX,X$K.y=X$K.y-X$m.pivotY,X$K.x=X$K.x-16,X$K.y=X$K.y-16,X$K.width=X$K.width+32,X$K.height=X$K.height+32,X$K.x=Math.floor(X$K.x+X$h)-X$h,X$K.y=Math.floor(X$K.y+X$P)-X$P,X$K.width=Math.floor(X$K.width),X$K.height=Math.floor(X$K.height),X$L._cacheRec.copyFrom(X$K)),X$K=X$L._cacheRec;var X$B,X$n=X$S.isWebGL?1:X$w.pixelRatio*X$E.stage.clientScaleX,X$c=X$S.isWebGL?1:X$w.pixelRatio*X$E.stage.clientScaleY;if(!X$S.isWebGL){var X$e,X$a=1,X$Z=1;for(X$e=X$m;X$e&&X$e!=X$E.stage;)X$a*=X$e.scaleX,X$Z*=X$e.scaleY,X$e=X$e.parent;X$S.isWebGL?(X$a<1&&(X$n*=X$a),X$Z<1&&(X$c*=X$Z)):(1<X$a&&(X$n*=X$a),1<X$Z&&(X$c*=X$Z))}if(X$m.scrollRect){var X$H=X$m.scrollRect;X$K.x-=X$H.x,X$K.y-=X$H.y}if(X$$=X$K.width*X$n,X$A=X$K.height*X$c,X$Y=X$K.x,X$d=X$K.y,X$S.isWebGL&&"bitmap"===X$R&&(2048<X$$||2048<X$A))return console.warn("cache bitmap size larger than 2048,cache ignored"),X$L.ctx&&(X$o.recover("RenderContext",X$L.ctx),X$L.ctx.canvas.size(0,0),X$L.ctx=null),void X$q._fun.call(X$q,X$m,X$p,X$h,X$P);if(X$D||(X$D=X$L.ctx=X$o.getItem("RenderContext")||new X$_(X$$,X$A,X$am.create("AUTO"))),X$D.ctx.sprite=X$m,(X$k=X$D.canvas).clear(),(X$k.width!=X$$||X$k.height!=X$A)&&X$k.size(X$$,X$A),"bitmap"===X$R?X$k.context.asBitmap=!0:"normal"===X$R&&(X$k.context.asBitmap=!1),1!=X$n||1!=X$c){var X$W=X$D.ctx;X$W.save(),X$W.scale(X$n,X$c),!X$S.isConchWebGL&&X$S.isConchApp&&(X$B=X$m._$P.cf)&&X$W.setFilterMatrix&&X$W.setFilterMatrix(X$B._mat,X$B._alpha),X$q._fun.call(X$q,X$m,X$D,-X$Y,-X$d),X$W.restore(),X$S.isConchApp&&!X$S.isConchWebGL||X$m._applyFilters()}else X$W=X$D.ctx,!X$S.isConchWebGL&&X$S.isConchApp&&(X$B=X$m._$P.cf)&&X$W.setFilterMatrix&&X$W.setFilterMatrix(X$B._mat,X$B._alpha),X$q._fun.call(X$q,X$m,X$D,-X$Y,-X$d),X$S.isConchApp&&!X$S.isConchWebGL||X$m._applyFilters();X$m._$P.staticCache&&(X$L.reCache=!1),X$f.canvasReCache++}else X$Y=(X$K=X$L._cacheRec).x,X$d=X$K.y,X$k=X$D.canvas;X$p.drawCanvas(X$k,X$h+X$Y,X$P+X$d,X$K.width,X$K.height)}else X$q._fun.call(X$q,X$m,X$D,X$h,X$P)},X$k.__init__=function(){var X$m,X$p,X$h=0;for(X$p=X$Q.createRenderSprite(69905,null),X$m=X$k.renders.length=4096,X$h=0;X$h<X$m;X$h++)X$k.renders[X$h]=X$p;X$k.renders[0]=X$Q.createRenderSprite(0,null),function(X$m,X$p){for(var X$h=0,X$P=0;X$P<X$m.length;X$P++)X$h|=X$m[X$P],X$k.renders[X$h]=X$p}([1,512,4,2],new X$k(1,null)),X$k.renders[513]=X$Q.createRenderSprite(513,null),X$k.renders[517]=new X$k(517,null)},X$k._initRenderFun=function(X$m,X$p,X$h,X$P){var X$L=X$m._renderType;(X$k.renders[X$L]=X$k._getTypeRender(X$L))._fun(X$m,X$p,X$h,X$P)},X$k._getTypeRender=function(X$m){for(var X$p=null,X$h=2048;1<X$h;)X$h&X$m&&(X$p=X$Q.createRenderSprite(X$h,X$p)),X$h>>=1;return X$p},X$k.IMAGE=1,X$k.ALPHA=2,X$k.TRANSFORM=4,X$k.BLEND=8,X$k.CANVAS=16,X$k.FILTERS=32,X$k.MASK=64,X$k.CLIP=128,X$k.STYLE=256,X$k.GRAPHICS=512,X$k.CUSTOM=1024,X$k.CHILDS=2048,X$k.INIT=69905,X$k.renders=[],X$k.NORENDER=new X$k(0,null),X$k}(),X$J=function(){function X$Y(){this._repaint=!1}X$D(X$Y,"laya.resource.Context");var X$m=X$Y.prototype;return X$m.replaceReset=function(){var X$m,X$p,X$h=0;for(X$m=X$Y.replaceKeys.length,X$h=0;X$h<X$m;X$h++)X$p=X$Y.replaceKeys[X$h],this[X$Y.newKeys[X$h]]=this[X$p]},X$m.replaceResotre=function(){this.__restore(),this.__reset()},X$m.setIsMainContext=function(){},X$m.drawTextures=function(X$m,X$p,X$h,X$P){X$f.drawCall+=X$p.length/2;for(var X$L=X$m.width,X$q=X$m.height,X$k=0,X$Y=X$p.length;X$k<X$Y;X$k+=2)this.drawTexture(X$m,X$p[X$k],X$p[X$k+1],X$L,X$q,X$h,X$P)},X$m.drawCanvas=function(X$m,X$p,X$h,X$P,X$L){X$f.drawCall++,this.drawImage(X$m.source,X$p,X$h,X$P,X$L)},X$m.fillRect=function(X$m,X$p,X$h,X$P,X$L){X$f.drawCall++,X$L&&(this.fillStyle=X$L),this.__fillRect(X$m,X$p,X$h,X$P)},X$m.fillText=function(X$m,X$p,X$h,X$P,X$L,X$q){X$f.drawCall++,3<arguments.length&&null!=X$P&&(this.font=X$P,this.fillStyle=X$L,this.textAlign=X$q,this.textBaseline="top"),this.__fillText(X$m,X$p,X$h)},X$m.fillBorderText=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){X$f.drawCall++,this.font=X$P,this.fillStyle=X$L,this.textBaseline="top",this.strokeStyle=X$q,this.lineWidth=X$k,this.textAlign=X$Y,this.__strokeText(X$m,X$p,X$h),this.__fillText(X$m,X$p,X$h)},X$m.strokeText=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){X$f.drawCall++,3<arguments.length&&null!=X$P&&(this.font=X$P,this.strokeStyle=X$L,this.lineWidth=X$q,this.textAlign=X$k,this.textBaseline="top"),this.__strokeText(X$m,X$p,X$h)},X$m.transformByMatrix=function(X$m){this.transform(X$m.a,X$m.b,X$m.c,X$m.d,X$m.tx,X$m.ty)},X$m.setTransformByMatrix=function(X$m){this.setTransform(X$m.a,X$m.b,X$m.c,X$m.d,X$m.tx,X$m.ty)},X$m.clipRect=function(X$m,X$p,X$h,X$P){X$f.drawCall++,this.beginPath(),this.rect(X$m,X$p,X$h,X$P),this.clip()},X$m.drawTexture=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){X$f.drawCall++;var X$Y=X$m.uv,X$d=X$m.bitmap.width,X$K=X$m.bitmap.height;this.drawImage(X$m.source,X$Y[0]*X$d,X$Y[1]*X$K,(X$Y[2]-X$Y[0])*X$d,(X$Y[5]-X$Y[3])*X$K,X$p+X$q,X$h+X$k,X$P,X$L)},X$m.drawTextureWithTransform=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){X$f.drawCall++;var X$K=X$m.uv,X$D=X$m.bitmap.width,X$F=X$m.bitmap.height;this.save(),1!=X$d&&(this.globalAlpha*=X$d),X$q?(this.transform(X$q.a,X$q.b,X$q.c,X$q.d,X$q.tx+X$k,X$q.ty+X$Y),this.drawImage(X$m.source,X$K[0]*X$D,X$K[1]*X$F,(X$K[2]-X$K[0])*X$D,(X$K[5]-X$K[3])*X$F,X$p,X$h,X$P,X$L)):this.drawImage(X$m.source,X$K[0]*X$D,X$K[1]*X$F,(X$K[2]-X$K[0])*X$D,(X$K[5]-X$K[3])*X$F,X$p+X$k,X$h+X$Y,X$P,X$L),this.restore()},X$m.drawTexture2=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){var X$d=X$Y[0];if(X$d.loaded&&X$d.bitmap&&X$d.source){X$f.drawCall++;var X$K=1!==X$q;if(X$K){var X$D=this.globalAlpha;this.globalAlpha*=X$q}var X$F=X$d.uv,X$R=X$d.bitmap.width,X$$=X$d.bitmap.height;X$L?(this.save(),this.transform(X$L.a,X$L.b,X$L.c,X$L.d,X$L.tx+X$m,X$L.ty+X$p),this.drawImage(X$d.source,X$F[0]*X$R,X$F[1]*X$$,(X$F[2]-X$F[0])*X$R,(X$F[5]-X$F[3])*X$$,X$Y[1]-X$h,X$Y[2]-X$P,X$Y[3],X$Y[4]),this.restore()):this.drawImage(X$d.source,X$F[0]*X$R,X$F[1]*X$$,(X$F[2]-X$F[0])*X$R,(X$F[5]-X$F[3])*X$$,X$Y[1]-X$h+X$m,X$Y[2]-X$P+X$p,X$Y[3],X$Y[4]),X$K&&(this.globalAlpha=X$D)}},X$m.fillTexture=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){if(!X$Y.pat){if(X$m.uv!=X$Dm.DEF_UV){var X$d=new X$am("2D");X$d.getContext("2d"),X$d.size(X$m.width,X$m.height),X$d.context.drawTexture(X$m,0,0,X$m.width,X$m.height,0,0),X$m=new X$Dm(X$d)}X$Y.pat=this.createPattern(X$m.bitmap.source,X$q)}var X$K=X$p,X$D=X$h,X$F=0,X$R=0;X$k&&(X$K+=X$k.x%X$m.width,X$D+=X$k.y%X$m.height,X$F-=X$k.x%X$m.width,X$R-=X$k.y%X$m.height),this.translate(X$K,X$D),this.fillRect(X$F,X$R,X$P,X$L,X$Y.pat),this.translate(-X$K,-X$D)},X$m.drawTriangle=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){var X$d=X$m.bitmap,X$K=X$d.source,X$D=X$m.width,X$F=X$m.height,X$R=X$d.width,X$$=X$d.height,X$A=X$h[X$P]*X$R,X$B=X$h[X$L]*X$R,X$n=X$h[X$q]*X$R,X$c=X$h[X$P+1]*X$$,X$e=X$h[X$L+1]*X$$,X$a=X$h[X$q+1]*X$$,X$Z=X$p[X$P],X$H=X$p[X$L],X$W=X$p[X$q],X$E=X$p[X$P+1],X$I=X$p[X$L+1],X$b=X$p[X$q+1];if(X$Y){var X$T=(X$Z+X$H+X$W)/3,X$j=(X$E+X$I+X$b)/3,X$x=X$Z-X$T,X$Q=X$E-X$j,X$M=Math.sqrt(X$x*X$x+X$Q*X$Q);X$Z=X$T+X$x/X$M*(X$M+1),X$E=X$j+X$Q/X$M*(X$M+1),X$Q=X$I-X$j,X$H=X$T+(X$x=X$H-X$T)/(X$M=Math.sqrt(X$x*X$x+X$Q*X$Q))*(X$M+1),X$I=X$j+X$Q/X$M*(X$M+1),X$Q=X$b-X$j,X$W=X$T+(X$x=X$W-X$T)/(X$M=Math.sqrt(X$x*X$x+X$Q*X$Q))*(X$M+1),X$b=X$j+X$Q/X$M*(X$M+1)}this.save(),X$k&&this.transform(X$k.a,X$k.b,X$k.c,X$k.d,X$k.tx,X$k.ty),this.beginPath(),this.moveTo(X$Z,X$E),this.lineTo(X$H,X$I),this.lineTo(X$W,X$b),this.closePath(),this.clip();var X$u=1/(X$A*X$e+X$c*X$n+X$B*X$a-X$e*X$n-X$c*X$B-X$A*X$a),X$N=X$Z*X$e+X$c*X$W+X$H*X$a-X$e*X$W-X$c*X$H-X$Z*X$a,X$S=X$A*X$H+X$Z*X$n+X$B*X$W-X$H*X$n-X$Z*X$B-X$A*X$W,X$_=X$A*X$e*X$W+X$c*X$H*X$n+X$Z*X$B*X$a-X$Z*X$e*X$n-X$c*X$B*X$W-X$A*X$H*X$a,X$l=X$E*X$e+X$c*X$b+X$I*X$a-X$e*X$b-X$c*X$I-X$E*X$a,X$J=X$A*X$I+X$E*X$n+X$B*X$b-X$I*X$n-X$E*X$B-X$A*X$b,X$z=X$A*X$e*X$b+X$c*X$I*X$n+X$E*X$B*X$a-X$E*X$e*X$n-X$c*X$B*X$b-X$A*X$I*X$a;this.transform(X$N*X$u,X$l*X$u,X$S*X$u,X$J*X$u,X$_*X$u,X$z*X$u),this.drawImage(X$K,X$m.uv[0]*X$R,X$m.uv[1]*X$$,X$D,X$F,X$m.uv[0]*X$R,X$m.uv[1]*X$$,X$D,X$F),this.restore()},X$m.flush=function(){return 0},X$m.fillWords=function(X$m,X$p,X$h,X$P,X$L,X$q){X$P&&(this.font=X$P),X$L&&(this.fillStyle=X$L);this.textBaseline="top",this.textAlign="left";for(var X$k=0,X$Y=X$m.length;X$k<X$Y;X$k++){var X$d=X$m[X$k];if(this.__fillText(X$d.char,X$d.x+X$p,X$d.y+X$h),1===X$q){var X$K=X$d.height,X$D=.5*X$d.style.letterSpacing;X$D||(X$D=0),this.beginPath(),this.strokeStyle=X$L,this.lineWidth=1,this.moveTo(X$p+X$d.x-X$D+.5,X$h+X$d.y+X$K+.5),this.lineTo(X$p+X$d.x+X$d.width+X$D+.5,X$h+X$d.y+X$K+.5),this.stroke()}}},X$m.fillBorderWords=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){X$P&&(this.font=X$P),X$L&&(this.fillStyle=X$L),this.textBaseline="top",this.lineWidth=X$k,this.textAlign="left",this.strokeStyle=X$q;for(var X$Y=0,X$d=X$m.length;X$Y<X$d;X$Y++){var X$K=X$m[X$Y];this.__strokeText(X$K.char,X$K.x+X$p,X$K.y+X$h),this.__fillText(X$K.char,X$K.x+X$p,X$K.y+X$h)}},X$m.destroy=function(){this.canvas.width=this.canvas.height=0},X$m.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},X$m.drawCurves=function(X$m,X$p,X$h){this.beginPath(),this.strokeStyle=X$h[3],this.lineWidth=X$h[4];var X$P=X$h[2];X$m+=X$h[0],X$p+=X$h[1],this.moveTo(X$m+X$P[0],X$p+X$P[1]);for(var X$L=2,X$q=X$P.length;X$L<X$q;)this.quadraticCurveTo(X$m+X$P[X$L++],X$p+X$P[X$L++],X$m+X$P[X$L++],X$p+X$P[X$L++]);this.stroke()},X$Y.__init__=function(X$p){var X$h=laya.resource.Context.prototype;if(!(X$p=X$p||CanvasRenderingContext2D.prototype).inited){X$p.inited=!0,X$p.__fillText=X$p.fillText,X$p.__fillRect=X$p.fillRect,X$p.__strokeText=X$p.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(X$m){X$p[X$m]=X$h[X$m]})}},X$Y.replaceCanvasGetSet=function(X$m,X$p){var X$h=Object.getOwnPropertyDescriptor(X$m,X$p);if(!X$h||!X$h.configurable)return!1;var X$P,X$L={};for(X$P in X$h)"set"!=X$P&&(X$L[X$P]=X$h[X$P]);var X$q=X$h.set;return X$L.set=function(X$m){X$q.call(this,X$m);var X$p=this.getContext("2d");X$p&&"__reset"in X$p&&X$p.__reset()},Object.defineProperty(X$m,X$p,X$L),!0},X$Y.replaceGetSet=function(X$m,X$p){var X$h=Object.getOwnPropertyDescriptor(X$m,X$p);if(!X$h||!X$h.configurable)return!1;var X$P,X$L={};for(X$P in X$h)"set"!=X$P&&(X$L[X$P]=X$h[X$P]);var X$q=X$h.set,X$k="___"+X$p+"__";return X$Y.newKeys.push(X$k),X$L.set=function(X$m){X$m!=this[X$k]&&(this[X$k]=X$m,X$q.call(this,X$m))},Object.defineProperty(X$m,X$p,X$L),!0},X$Y._default=new X$Y,X$Y.newKeys=[],X$d(X$Y,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),X$Y}(),X$z=function(){function X$q(X$m){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++X$q._uniqueIDCounter,this._name=X$m||"Content Manager",X$q._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,X$q._resourceManagers.push(this),this._resources=[],this._records={}}X$D(X$q,"laya.resource.ResourceManager");var X$m=X$q.prototype;return X$E.imps(X$m,{"laya.resource.IDispose":!0}),X$m.getResourceByIndex=function(X$m){return this._resources[X$m]},X$m.getResourcesLength=function(){return this._resources.length},X$m.addResource=function(X$m){return X$m.resourceManager&&X$m.resourceManager.removeResource(X$m),-1===this._resources.indexOf(X$m)&&((X$m._resourceManager=this)._resources.push(X$m),this.addRecord(X$m.uri,X$m.__className,X$m.memorySize),this.addSize(X$m.memorySize),!0)},X$m.removeResource=function(X$m){var X$p=this._resources.indexOf(X$m);return-1!==X$p&&(this._resources.splice(X$p,1),X$m._resourceManager=null,this._memorySize-=X$m.memorySize,this.addRecord(X$m.uri,X$m.__className,-X$m.memorySize),!0)},X$m.unload=function(){for(var X$m=this._resources.slice(0,this._resources.length),X$p=0;X$p<X$m.length;X$p++){X$m[X$p].destroy()}X$m.length=0},X$m.dispose=function(){if(this===X$q._systemResourceManager)throw new Error("systemResourceManager不能被释放！");X$q._resourceManagers.splice(X$q._resourceManagers.indexOf(this),1),X$q._isResourceManagersSorted=!1;for(var X$m=this._resources.slice(0,this._resources.length),X$p=0;X$p<X$m.length;X$p++){var X$h=X$m[X$p];X$h.resourceManager.removeResource(X$h),X$h.destroy()}X$m.length=0},X$m.addSize=function(X$m){X$m&&(this.autoRelease&&0<X$m&&this._memorySize+X$m>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=X$m)},X$m.addRecord=function(X$m,X$p,X$h){DEBUG&&X$h&&!X$m&&console.error(X$m,X$p,X$h)},X$m.garbageCollection=function(X$m){var X$p=this._resources;(X$p=X$p.slice()).sort(function(X$m,X$p){if(!X$m||!X$p)throw new Error("a或b不能为空！");return X$m.released&&X$p.released?0:X$m.released?1:X$p.released?-1:X$m._lastUseFrameCount-X$p._lastUseFrameCount});for(var X$h=X$f.loopCount,X$P=0,X$L=X$p.length;X$P<X$L;X$P++){var X$q=X$p[X$P];if(!(1<X$h-X$q._lastUseFrameCount))return void(this._memorySize>=X$m&&(this._isOverflow=!0));if(X$q.releaseResource(),this._memorySize<X$m)return void(this._isOverflow=!1)}},X$A(0,X$m,"id",function(){return this._id}),X$A(0,X$m,"name",function(){return this._name},function(X$m){!X$m&&""===X$m||this._name===X$m||(this._name=X$m,X$q._isResourceManagersSorted=!1)}),X$A(0,X$m,"memorySize",function(){return this._memorySize}),X$A(0,X$m,"records",function(){return this._records}),X$A(1,X$q,"systemResourceManager",function(){return X$q._systemResourceManager}),X$q.__init__=function(){X$q.currentResourceManager=X$q.systemResourceManager},X$q.getLoadedResourceManagerByIndex=function(X$m){return X$q._resourceManagers[X$m]},X$q.getLoadedResourceManagersCount=function(){return X$q._resourceManagers.length},X$q.recreateContentManagers=function(X$m){void 0===X$m&&(X$m=!1);for(var X$p=X$q.currentResourceManager,X$h=0;X$h<X$q._resourceManagers.length;X$h++){X$q.currentResourceManager=X$q._resourceManagers[X$h];for(var X$P=0;X$P<X$q.currentResourceManager._resources.length;X$P++)X$q.currentResourceManager._resources[X$P].releaseResource(X$m),X$q.currentResourceManager._resources[X$P].activeResource(X$m)}X$q.currentResourceManager=X$p},X$q.releaseContentManagers=function(X$m){void 0===X$m&&(X$m=!1);for(var X$p=X$q.currentResourceManager,X$h=0;X$h<X$q._resourceManagers.length;X$h++){X$q.currentResourceManager=X$q._resourceManagers[X$h];for(var X$P=0;X$P<X$q.currentResourceManager._resources.length;X$P++){var X$L=X$q.currentResourceManager._resources[X$P];!X$L.released&&X$L.releaseResource(X$m)}}X$q.currentResourceManager=X$p},X$q._uniqueIDCounter=0,X$q._isResourceManagersSorted=!1,X$q._resourceManagers=[],X$d(X$q,["_systemResourceManager",function(){return this._systemResourceManager=new X$q("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=X$q._systemResourceManager}]),X$q}(),X$w=(function(){function X$m(){}X$D(X$m,"laya.system.System"),X$m.changeDefinition=function(X$m,X$p){X$E[X$m]=X$p;var X$h=X$m+"=classObj";X$E._runScript(X$h)},X$m.__init__=function(){X$S.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function X$h(){}return X$D(X$h,"laya.utils.Browser"),X$A(1,X$h,"pixelRatio",function(){return X$h.__init__(),-1<X$h.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:X$Q.getPixelRatio()}),X$A(1,X$h,"height",function(){return X$h.__init__(),(X$E.stage&&X$E.stage.canvasRotation?X$h.clientWidth:X$h.clientHeight)*X$h.pixelRatio}),X$A(1,X$h,"clientWidth",function(){return X$h.__init__(),X$h.window.innerWidth||X$h.document.body.clientWidth}),X$A(1,X$h,"window",function(){return X$h.__init__(),X$h._window}),X$A(1,X$h,"clientHeight",function(){return X$h.__init__(),X$h.window.innerHeight||X$h.document.body.clientHeight||X$h.document.documentElement.clientHeight}),X$A(1,X$h,"width",function(){return X$h.__init__(),(X$E.stage&&X$E.stage.canvasRotation?X$h.clientHeight:X$h.clientWidth)*X$h.pixelRatio}),X$A(1,X$h,"container",function(){return X$h.__init__(),X$h._container||((X$h._container=X$h.createElement("div")).id="layaContainer",X$h.document.body.appendChild(X$h._container)),X$h._container},function(X$m){X$h._container=X$m}),X$A(1,X$h,"document",function(){return X$h.__init__(),X$h._document}),X$h.__init__=function(){if(!X$h._window){X$h._window=X$Q.getWindow(),X$h._document=X$h.window.document,X$h._window.addEventListener("message",function(X$m){laya.utils.Browser._onMessage(X$m)},!1),X$h.document.__createElement=X$h.document.createElement,X$k.requestAnimationFrame=X$k.requestAnimationFrame||X$k.webkitRequestAnimationFrame||X$k.mozRequestAnimationFrame||X$k.oRequestAnimationFrame||X$k.msRequestAnimationFrame||function(X$m){return X$k.setTimeout(X$m,1e3/60)};var X$m=X$k.document.body.style;X$m["-webkit-user-select"]="none",X$m["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",X$h.userAgent=X$h.window.navigator.userAgent,X$h.onIOS=!!(X$h.u=X$h.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),X$h.onMobile=-1<X$h.u.indexOf("Mobile"),X$h.onIPhone=-1<X$h.u.indexOf("iPhone"),X$h.onMac=-1<X$h.u.indexOf("Mac OS X"),X$h.onIPad=-1<X$h.u.indexOf("iPad"),X$h.onAndroid=-1<X$h.u.indexOf("Android")||-1<X$h.u.indexOf("Adr"),X$h.onWP=-1<X$h.u.indexOf("Windows Phone"),X$h.onQQBrowser=-1<X$h.u.indexOf("QQBrowser"),X$h.onMQQBrowser=-1<X$h.u.indexOf("MQQBrowser")||-1<X$h.u.indexOf("Mobile")&&-1<X$h.u.indexOf("QQ"),X$h.onIE=!!X$h.window.ActiveXObject||"ActiveXObject"in X$h.window,X$h.onWeiXin=-1<X$h.u.indexOf("MicroMessenger"),X$h.onPC=!X$h.onMobile,X$h.onSafari=-1<X$h.u.indexOf("Safari"),X$h.onFirefox=-1<X$h.u.indexOf("Firefox"),X$h.onEdge=-1<X$h.u.indexOf("Edge"),X$h.onMiniGame=-1<X$h.u.indexOf("MiniGame"),X$h.onLimixiu=-1<X$h.u.indexOf("limixiu"),X$h.httpProtocol="http:"==X$h.window.location.protocol,X$h.onMiniGame&&null==X$h.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),X$h.webAudioEnabled=!!(X$h.window.AudioContext||X$h.window.webkitAudioContext||X$h.window.mozAudioContext),X$h.soundType=X$h.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",X$Lm=X$h.webAudioEnabled?X$qm:X$hm,X$h.webAudioEnabled&&X$qm.initWebAudio(),X$hm._initMusicAudio(),X$h.enableTouch="ontouchstart"in X$k||X$k.DocumentTouch&&X$p instanceof DocumentTouch,X$k.focus(),X$x._soundClass=X$Lm,X$x._musicClass=X$hm,X$S._mainCanvas=X$S._mainCanvas||X$am.create("2D"),X$h.canvas||(X$h.canvas=X$am.create("2D"),X$h.context=X$h.canvas.getContext("2d"))}},X$h._onMessage=function(X$m){if(X$m.data&&"size"==X$m.data.name){if(X$h.window.innerWidth=X$m.data.width,X$h.window.innerHeight=X$m.data.height,X$h.window.__innerHeight=X$m.data.clientHeight,!X$h.document.createEvent)return void console.warn("no document.createEvent");var X$p=X$h.document.createEvent("HTMLEvents");return X$p.initEvent("resize",!1,!1),void X$h.window.dispatchEvent(X$p)}},X$h.createElement=function(X$m){return X$h.__init__(),X$h.document.__createElement(X$m)},X$h.getElementById=function(X$m){return X$h.__init__(),X$h.document.getElementById(X$m)},X$h.removeElement=function(X$m){X$m&&X$m.parentNode&&X$m.parentNode.removeChild(X$m)},X$h.now=function(){return X$Q.now()},X$h._window=null,X$h._document=null,X$h._container=null,X$h.userAgent=null,X$h.u=null,X$h.onIOS=!1,X$h.onMac=!1,X$h.onMobile=!1,X$h.onIPhone=!1,X$h.onIPad=!1,X$h.onAndroid=!1,X$h.onWP=!1,X$h.onQQBrowser=!1,X$h.onMQQBrowser=!1,X$h.onSafari=!1,X$h.onFirefox=!1,X$h.onEdge=!1,X$h.onIE=!1,X$h.onWeiXin=!1,X$h.onMiniGame=!1,X$h.onLimixiu=!1,X$h.onPC=!1,X$h.httpProtocol=!1,X$h.webAudioEnabled=!1,X$h.soundType=null,X$h.enableTouch=!1,X$h.canvas=null,X$h.context=null,X$h.__init$=function(){},X$h}()),X$X=function(){function X$p(X$m){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,X$m?(this._u8d_=new Uint8Array(X$m),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}X$D(X$p,"laya.utils.Byte");var X$m=X$p.prototype;return X$m.___resizeBuffer=function(X$p){try{var X$m=new Uint8Array(X$p);null!=this._u8d_&&(this._u8d_.length<=X$p?X$m.set(this._u8d_):X$m.set(this._u8d_.subarray(0,X$p))),this._u8d_=X$m,this._d_=new DataView(X$m.buffer)}catch(X$m){throw"___resizeBuffer err:"+X$p}},X$m.getString=function(){return this.rUTF(this.getUint16())},X$m.getFloat32Array=function(X$m,X$p){var X$h=X$m+X$p;X$h=X$h>this._length?this._length:X$h;var X$P=new Float32Array(this._d_.buffer.slice(X$m,X$h));return this._pos_=X$h,X$P},X$m.getUint8Array=function(X$m,X$p){var X$h=X$m+X$p;X$h=X$h>this._length?this._length:X$h;var X$P=new Uint8Array(this._d_.buffer.slice(X$m,X$h));return this._pos_=X$h,X$P},X$m.getInt16Array=function(X$m,X$p){var X$h=X$m+X$p;X$h=X$h>this._length?this._length:X$h;var X$P=new Int16Array(this._d_.buffer.slice(X$m,X$h));return this._pos_=X$h,X$P},X$m.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var X$m=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,X$m},X$m.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var X$m=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,X$m},X$m.writeFloat32=function(X$m){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,X$m,this._xd_),this._pos_+=4},X$m.writeFloat64=function(X$m){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,X$m,this._xd_),this._pos_+=8},X$m.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var X$m=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,X$m},X$m.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var X$m=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,X$m},X$m.writeInt32=function(X$m){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,X$m,this._xd_),this._pos_+=4},X$m.writeUint32=function(X$m){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,X$m,this._xd_),this._pos_+=4},X$m.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var X$m=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,X$m},X$m.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var X$m=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,X$m},X$m.writeUint16=function(X$m){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,X$m,this._xd_),this._pos_+=2},X$m.writeInt16=function(X$m){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,X$m,this._xd_),this._pos_+=2},X$m.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},X$m.writeUint8=function(X$m){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,X$m),this._pos_++},X$m._getUInt8=function(X$m){return this._d_.getUint8(X$m)},X$m._getUint16=function(X$m){return this._d_.getUint16(X$m,this._xd_)},X$m._getMatrix=function(){return new X$M(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},X$m.rUTF=function(X$m){for(var X$p=[],X$h=this._pos_+X$m,X$P=0,X$L=0,X$q=0,X$k=String.fromCharCode,X$Y=this._u8d_;this._pos_<X$h;)(X$P=X$Y[this._pos_++])<128?0!=X$P&&X$p.push(X$k(X$P)):X$P<224?X$p.push(X$k((63&X$P)<<6|127&X$Y[this._pos_++])):X$P<240?(X$L=X$Y[this._pos_++],X$p.push(X$k((31&X$P)<<12|(127&X$L)<<6|127&X$Y[this._pos_++]))):(X$L=X$Y[this._pos_++],X$q=X$Y[this._pos_++],X$p.push(X$k((15&X$P)<<18|(127&X$L)<<12|X$q<<6&127|127&X$Y[this._pos_++]))),0;return X$p.join("")},X$m.getCustomString=function(X$m){for(var X$p=[],X$h=0,X$P=0,X$L=0,X$q=String.fromCharCode,X$k=this._u8d_;0<X$m;)if((X$P=X$k[this._pos_])<128)X$p.push(X$q(X$P)),this._pos_++,X$m--;else for(X$h=X$P-128,this._pos_++,X$m-=X$h;0<X$h;)X$P=X$k[this._pos_++],X$L=X$k[this._pos_++],X$p.push(X$q(X$L<<8|X$P)),X$h--;return X$p.join("")},X$m.clear=function(){this._pos_=0,this.length=0},X$m.__getBuffer=function(){return this._d_.buffer},X$m.writeUTFBytes=function(X$m){for(var X$p=0,X$h=(X$m+="").length;X$p<X$h;X$p++){var X$P=X$m.charCodeAt(X$p);X$P<=127?this.writeByte(X$P):X$P<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|X$P>>6,128|63&X$P],this._pos_),this._pos_+=2):X$P<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|X$P>>12,128|X$P>>6&63,128|63&X$P],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|X$P>>18,128|X$P>>12&63,128|X$P>>6&63,128|63&X$P],this._pos_),this._pos_+=4)}},X$m.writeUTFString=function(X$m){var X$p=this.pos;this.writeUint16(1),this.writeUTFBytes(X$m);var X$h=this.pos-X$p-2;if(65536<=X$h)throw"writeUTFString byte len more than 65536";this._d_.setUint16(X$p,X$h,this._xd_)},X$m.readUTFString=function(){return this.readUTFBytes(this.getUint16())},X$m.getUTFString=function(){return this.readUTFString()},X$m.readUTFBytes=function(X$m){if(void 0===X$m&&(X$m=-1),0==X$m)return"";var X$p=this.bytesAvailable;if(X$p<X$m)throw"readUTFBytes error - Out of bounds";return X$m=0<X$m?X$m:X$p,this.rUTF(X$m)},X$m.getUTFBytes=function(X$m){return void 0===X$m&&(X$m=-1),this.readUTFBytes(X$m)},X$m.writeByte=function(X$m){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,X$m),this._pos_+=1},X$m.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},X$m.getByte=function(){return this.readByte()},X$m.ensureWrite=function(X$m){this._length<X$m&&(this._length=X$m),this._allocated_<X$m&&(this.length=X$m)},X$m.writeArrayBuffer=function(X$m,X$p,X$h){if(void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),X$p<0||X$h<0)throw"writeArrayBuffer error - Out of bounds";0==X$h&&(X$h=X$m.byteLength-X$p),this.ensureWrite(this._pos_+X$h);var X$P=new Uint8Array(X$m);this._u8d_.set(X$P.subarray(X$p,X$p+X$h),this._pos_),this._pos_+=X$h},X$A(0,X$m,"buffer",function(){var X$m=this._d_.buffer;return X$m.byteLength==this.length?X$m:X$m.slice(0,this.length)}),X$A(0,X$m,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(X$m){this._xd_="littleEndian"==X$m}),X$A(0,X$m,"length",function(){return this._length},function(X$m){this._allocated_<X$m?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(X$m,2*this._allocated_))):this._allocated_>X$m&&this.___resizeBuffer(this._allocated_=X$m),this._length=X$m}),X$A(0,X$m,"pos",function(){return this._pos_},function(X$m){this._pos_=X$m}),X$A(0,X$m,"bytesAvailable",function(){return this._length-this._pos_}),X$p.getSystemEndian=function(){if(!X$p._sysEndian){var X$m=new ArrayBuffer(2);new DataView(X$m).setInt16(0,256,!0),X$p._sysEndian=256===new Int16Array(X$m)[0]?"littleEndian":"bigEndian"}return X$p._sysEndian},X$p.BIG_ENDIAN="bigEndian",X$p.LITTLE_ENDIAN="littleEndian",X$p._sysEndian=null,X$p}(),X$s=function(){function X$L(){}return X$D(X$L,"laya.utils.CacheManager"),X$L.regCacheByFunction=function(X$m,X$p){var X$h;X$L.unRegCacheByFunction(X$m,X$p),X$h={tryDispose:X$m,getCacheList:X$p},X$L._cacheList.push(X$h)},X$L.unRegCacheByFunction=function(X$m,X$p){var X$h,X$P=0;for(X$h=X$L._cacheList.length,X$P=0;X$P<X$h;X$P++)if(X$L._cacheList[X$P].tryDispose==X$m&&X$L._cacheList[X$P].getCacheList==X$p)return void X$L._cacheList.splice(X$P,1)},X$L.forceDispose=function(){var X$m=0,X$p=X$L._cacheList.length;for(X$m=0;X$m<X$p;X$m++)X$L._cacheList[X$m].tryDispose(!0)},X$L.beginCheck=function(X$m){void 0===X$m&&(X$m=15e3),X$E.timer.loop(X$m,null,X$L._checkLoop)},X$L.stopCheck=function(){X$E.timer.clear(null,X$L._checkLoop)},X$L._checkLoop=function(){var X$m=X$L._cacheList;if(!(X$m.length<1)){var X$p,X$h=X$w.now(),X$P=0;for(X$p=X$P=X$m.length;0<X$P&&(X$m[X$L._index=++X$L._index%X$p].tryDispose(!1),!(X$w.now()-X$h>X$L.loopTimeLimit));)X$P--}},X$L.loopTimeLimit=2,X$L._cacheList=[],X$L._index=0,X$L}(),X$G=function(){function X$$(){}return X$D(X$$,"laya.utils.ClassUtils"),X$$.regClass=function(X$m,X$p){X$$._classMap[X$m]=X$p},X$$.getRegClass=function(X$m){return X$$._classMap[X$m]},X$$.getInstance=function(X$m){var X$p=X$$.getClass(X$m);return X$p?new X$p:(console.warn("[error] Undefined class:",X$m),null)},X$$.createByJson=function(X$m,X$p,X$h,X$P,X$L){"string"==typeof X$m&&(X$m=JSON.parse(X$m));var X$q=X$m.props;if(!X$p&&!(X$p=X$L?X$L.runWith(X$m):X$$.getInstance(X$q.runtime||X$m.type)))return null;var X$k=X$m.child;if(X$k)for(var X$Y=0,X$d=X$k.length;X$Y<X$d;X$Y++){var X$K=X$k[X$Y];if("render"!==X$K.props.name&&"render"!==X$K.props.renderType||!X$p._$set_itemRender)if("Graphic"==X$K.type)X$$.addGraphicsToSprite(X$K,X$p);else if(X$$.isDrawType(X$K.type))X$$.addGraphicToSprite(X$K,X$p,!0);else{var X$D=X$$.createByJson(X$K,null,X$h,X$P,X$L);"Script"==X$K.type?X$D.hasOwnProperty("owner")?X$D.owner=X$p:X$D.hasOwnProperty("target")&&(X$D.target=X$p):"mask"==X$K.props.renderType?X$p.mask=X$D:X$p.addChild(X$D)}else X$p.itemRender=X$K}if(X$q)for(var X$F in X$q){var X$R=X$q[X$F];"var"===X$F&&X$h?X$h[X$R]=X$p:X$R instanceof Array&&"function"==typeof X$p[X$F]?X$p[X$F].apply(X$p,X$R):X$p[X$F]=X$R}return X$P&&X$m.customProps&&X$P.runWith([X$p,X$m]),X$p.created&&X$p.created(),X$p},X$$.addGraphicsToSprite=function(X$m,X$p){var X$h;if((X$h=X$m.child)&&!(X$h.length<1)){var X$P;X$P=X$$._getGraphicsFromSprite(X$m,X$p);var X$L=0,X$q=0;X$m.props&&(X$L=X$$._getObjVar(X$m.props,"x",0),X$q=X$$._getObjVar(X$m.props,"y",0)),0!=X$L&&0!=X$q&&X$P.translate(X$L,X$q);var X$k,X$Y=0;for(X$k=X$h.length,X$Y=0;X$Y<X$k;X$Y++)X$$._addGraphicToGraphics(X$h[X$Y],X$P);0!=X$L&&0!=X$q&&X$P.translate(-X$L,-X$q)}},X$$.addGraphicToSprite=function(X$m,X$p,X$h){var X$P;void 0===X$h&&(X$h=!1),X$P=X$h?X$$._getGraphicsFromSprite(X$m,X$p):X$p.graphics,X$$._addGraphicToGraphics(X$m,X$P)},X$$._getGraphicsFromSprite=function(X$m,X$p){var X$h,X$P;if(!X$m||!X$m.props)return X$p.graphics;switch(X$P=X$m.props.renderType){case"hit":case"unHit":var X$L;X$p.hitArea||(X$p.hitArea=new X$V),(X$L=X$p.hitArea)[X$P]||(X$L[X$P]=new X$R),X$h=X$L[X$P]}return X$h||(X$h=X$p.graphics),X$h},X$$._getTransformData=function(X$m){var X$p;(X$m.hasOwnProperty("pivotX")||X$m.hasOwnProperty("pivotY"))&&(X$p=X$p||new X$M).translate(-X$$._getObjVar(X$m,"pivotX",0),-X$$._getObjVar(X$m,"pivotY",0));var X$h=X$$._getObjVar(X$m,"scaleX",1),X$P=X$$._getObjVar(X$m,"scaleY",1),X$L=X$$._getObjVar(X$m,"rotation",0);X$$._getObjVar(X$m,"skewX",0),X$$._getObjVar(X$m,"skewY",0);return 1==X$h&&1==X$P&&0==X$L||((X$p=X$p||new X$M).scale(X$h,X$P),X$p.rotate(.0174532922222222*X$L)),X$p},X$$._addGraphicToGraphics=function(X$m,X$p){var X$h,X$P;if((X$h=X$m.props)&&(X$P=X$$.DrawTypeDic[X$m.type])){var X$L,X$q;X$L=X$p;var X$k=X$$._getParams(X$h,X$P[1],X$P[2],X$P[3]);((X$q=X$$._tM)||1!=X$$._alpha)&&(X$L.save(),X$q&&X$L.transform(X$q),1!=X$$._alpha&&X$L.alpha(X$$._alpha)),X$L[X$P[0]].apply(X$L,X$k),(X$q||1!=X$$._alpha)&&X$L.restore()}},X$$._adptLineData=function(X$m){return X$m[2]=parseFloat(X$m[0])+parseFloat(X$m[2]),X$m[3]=parseFloat(X$m[1])+parseFloat(X$m[3]),X$m},X$$._adptTextureData=function(X$m){return X$m[0]=X$Ym.getRes(X$m[0]),X$m},X$$._adptLinesData=function(X$m){return X$m[2]=X$$._getPointListByStr(X$m[2]),X$m},X$$.isDrawType=function(X$m){return"Image"!=X$m&&X$$.DrawTypeDic.hasOwnProperty(X$m)},X$$._getParams=function(X$m,X$p,X$h,X$P){var X$L;void 0===X$h&&(X$h=0),(X$L=X$$._temParam).length=X$p.length;var X$q,X$k,X$Y=0;for(X$q=X$p.length,X$Y=0;X$Y<X$q;X$Y++)X$L[X$Y]=X$$._getObjVar(X$m,X$p[X$Y][0],X$p[X$Y][1]);return X$$._alpha=X$$._getObjVar(X$m,"alpha",1),X$k=X$$._getTransformData(X$m),X$$._tM=X$k?(X$h||(X$h=0),X$k.translate(X$L[X$h],X$L[X$h+1]),X$L[X$h]=X$L[X$h+1]=0,X$k):null,X$P&&X$$[X$P]&&(X$L=X$$[X$P](X$L)),X$L},X$$._getPointListByStr=function(X$m){var X$p,X$h,X$P=0;for(X$h=(X$p=X$m.split(",")).length,X$P=0;X$P<X$h;X$P++)X$p[X$P]=parseFloat(X$p[X$P]);return X$p},X$$._getObjVar=function(X$m,X$p,X$h){return X$m.hasOwnProperty(X$p)?X$m[X$p]:X$h},X$$._temParam=[],X$$._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},X$$.getClass=function(X$m){var X$p=X$$._classMap[X$m]||X$m;return"string"==typeof X$p?X$E.__classmap[X$p]:X$p},X$$._tM=null,X$$._alpha=NaN,X$d(X$$,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),X$$}(),X$U=function(){function X$q(X$m){if(this._color=[],"string"==typeof X$m){null===(this.strColor=X$m)&&(X$m="#000000"),"#"==X$m.charAt(0)&&(X$m=X$m.substr(1));var X$p=X$m.length;if(3==X$p||4==X$p){for(var X$h="",X$P=0;X$P<X$p;X$P++)X$h+=X$m[X$P]+X$m[X$P];X$m=X$h}var X$L=this.numColor=parseInt(X$m,16);if(8==X$m.length)return void(this._color=[parseInt(X$m.substr(0,2),16)/255,((16711680&X$L)>>16)/255,((65280&X$L)>>8)/255,(255&X$L)/255])}else X$L=this.numColor=X$m,this.strColor=X$g.toHexColor(X$L);this._color=[((16711680&X$L)>>16)/255,((65280&X$L)>>8)/255,(255&X$L)/255,1],this._color.__id=++X$q._COLODID}return X$D(X$q,"laya.utils.Color"),X$q._initDefault=function(){for(var X$m in X$q._DEFAULT={},X$q._COLOR_MAP)X$q._SAVE[X$m]=X$q._DEFAULT[X$m]=new X$q(X$q._COLOR_MAP[X$m]);return X$q._DEFAULT},X$q._initSaveMap=function(){for(var X$m in X$q._SAVE_SIZE=0,X$q._SAVE={},X$q._DEFAULT)X$q._SAVE[X$m]=X$q._DEFAULT[X$m]},X$q.create=function(X$m){var X$p=X$q._SAVE[X$m+""];return null!=X$p?X$p:(X$q._SAVE_SIZE<1e3||X$q._initSaveMap(),X$q._SAVE[X$m+""]=new X$q(X$m))},X$q._SAVE={},X$q._SAVE_SIZE=0,X$q._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},X$q._DEFAULT=X$q._initDefault(),X$q._COLODID=1,X$q}(),X$r=(function(){function X$m(){this._values=[],this._keys=[]}X$D(X$m,"laya.utils.Dictionary");var X$p=X$m.prototype;X$p.set=function(X$m,X$p){var X$h=this.indexOf(X$m);0<=X$h?this._values[X$h]=X$p:(this._keys.push(X$m),this._values.push(X$p))},X$p.indexOf=function(X$m){var X$p=this._keys.indexOf(X$m);return 0<=X$p?X$p:(X$m="string"==typeof X$m?Number(X$m):"number"==typeof X$m?X$m.toString():X$m,this._keys.indexOf(X$m))},X$p.get=function(X$m){var X$p=this.indexOf(X$m);return X$p<0?null:this._values[X$p]},X$p.remove=function(X$m){var X$p=this.indexOf(X$m);return 0<=X$p&&(this._keys.splice(X$p,1),this._values.splice(X$p,1),!0)},X$p.clear=function(){this._values.length=0,this._keys.length=0},X$A(0,X$p,"values",function(){return this._values}),X$A(0,X$p,"keys",function(){return this._keys})}(),function(){function X$m(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}X$D(X$m,"laya.utils.Dragging");var X$p=X$m.prototype;return X$p.start=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){void 0===X$Y&&(X$Y=.92),this.clearTimer(),this.target=X$m,this.area=X$p,this.hasInertia=X$h,this.elasticDistance=X$p?X$P:0,this.elasticBackTime=X$L,this.data=X$q,this._disableMouseEvent=X$k,this.ratio=X$Y,1!=X$m.globalScaleX||1!=X$m.globalScaleY?this._parent=X$m.parent:this._parent=X$E.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,X$E.stage.on("mouseup",this,this.onStageMouseUp),X$E.stage.on("mouseout",this,this.onStageMouseUp),X$E.timer.frameLoop(1,this,this.loop)},X$p.clearTimer=function(){X$E.timer.clear(this,this.loop),X$E.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},X$p.stop=function(){this._dragging&&(X$B.instance.disableMouseEvent=!1,X$E.stage.off("mouseup",this,this.onStageMouseUp),X$E.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},X$p.loop=function(){var X$m=this._parent.getMousePoint(),X$p=X$m.x,X$h=X$m.y,X$P=X$p-this._lastX,X$L=X$h-this._lastY;if(this._clickOnly){if(!(1<Math.abs(X$P*X$E.stage._canvasTransform.getScaleX())||1<Math.abs(X$L*X$E.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),X$B.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(X$P,X$L);0==X$P&&0==X$L||(this._lastX=X$p,this._lastY=X$h,this.target.x+=X$P*this._elasticRateX,this.target.y+=X$L*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},X$p.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var X$m=this.area.x-this.target.x;else X$m=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-X$m/this.elasticDistance),this.target.y<this.area.y)var X$p=this.area.y-this.target.y;else X$p=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-X$p/this.elasticDistance)}},X$p.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},X$p.onStageMouseUp=function(X$m){if(X$B.instance.disableMouseEvent=!1,X$E.stage.off("mouseup",this,this.onStageMouseUp),X$E.stage.off("mouseout",this,this.onStageMouseUp),X$E.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var X$p=this._offsets.length,X$h=Math.min(X$p,6),X$P=this._offsets.length-X$h,X$L=X$p-1;X$P<X$L;X$L--)this._offsetY+=this._offsets[X$L--],this._offsetX+=this._offsets[X$L];this._offsetX=this._offsetX/X$h*2,this._offsetY=this._offsetY/X$h*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),X$E.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},X$p.checkElastic=function(){var X$m=NaN,X$p=NaN;if(this.target.x<this.area.x?X$m=this.area.x:this.target.x>this.area.x+this.area.width&&(X$m=this.area.x+this.area.width),this.target.y<this.area.y?X$p=this.area.y:this.target.y>this.area.y+this.area.height&&(X$p=this.area.y+this.area.height),isNaN(X$m)&&isNaN(X$p))this.clear();else{var X$h={};isNaN(X$m)||(X$h.x=X$m),isNaN(X$p)||(X$h.y=X$p),this._tween=X$v.to(this.target,X$h,this.elasticBackTime,X$y.sineOut,X$e.create(this,this.clear),0,!1,!1)}},X$p.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(X$E.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},X$p.clear=function(){if(this.target){this.clearTimer();var X$m=this.target;this.target=null,this._parent=null,X$m.event("dragend",this.data)}},X$m}()),X$y=function(){function X$Y(){}return X$D(X$Y,"laya.utils.Ease"),X$Y.linearNone=function(X$m,X$p,X$h,X$P){return X$h*X$m/X$P+X$p},X$Y.linearIn=function(X$m,X$p,X$h,X$P){return X$h*X$m/X$P+X$p},X$Y.linearInOut=function(X$m,X$p,X$h,X$P){return X$h*X$m/X$P+X$p},X$Y.linearOut=function(X$m,X$p,X$h,X$P){return X$h*X$m/X$P+X$p},X$Y.bounceIn=function(X$m,X$p,X$h,X$P){return X$h-X$Y.bounceOut(X$P-X$m,0,X$h,X$P)+X$p},X$Y.bounceInOut=function(X$m,X$p,X$h,X$P){return X$m<.5*X$P?.5*X$Y.bounceIn(2*X$m,0,X$h,X$P)+X$p:.5*X$Y.bounceOut(2*X$m-X$P,0,X$h,X$P)+.5*X$h+X$p},X$Y.bounceOut=function(X$m,X$p,X$h,X$P){return(X$m/=X$P)<1/2.75?X$h*(7.5625*X$m*X$m)+X$p:X$m<2/2.75?X$h*(7.5625*(X$m-=1.5/2.75)*X$m+.75)+X$p:X$m<2.5/2.75?X$h*(7.5625*(X$m-=2.25/2.75)*X$m+.9375)+X$p:X$h*(7.5625*(X$m-=2.625/2.75)*X$m+.984375)+X$p},X$Y.backIn=function(X$m,X$p,X$h,X$P,X$L){return void 0===X$L&&(X$L=1.70158),X$h*(X$m/=X$P)*X$m*((X$L+1)*X$m-X$L)+X$p},X$Y.backInOut=function(X$m,X$p,X$h,X$P,X$L){return void 0===X$L&&(X$L=1.70158),(X$m/=.5*X$P)<1?.5*X$h*(X$m*X$m*((1+(X$L*=1.525))*X$m-X$L))+X$p:X$h/2*((X$m-=2)*X$m*((1+(X$L*=1.525))*X$m+X$L)+2)+X$p},X$Y.backOut=function(X$m,X$p,X$h,X$P,X$L){return void 0===X$L&&(X$L=1.70158),X$h*((X$m=X$m/X$P-1)*X$m*((X$L+1)*X$m+X$L)+1)+X$p},X$Y.elasticIn=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k;return void 0===X$L&&(X$L=0),void 0===X$q&&(X$q=0),0==X$m?X$p:1==(X$m/=X$P)?X$p+X$h:(X$q||(X$q=.3*X$P),X$k=!X$L||0<X$h&&X$L<X$h||X$h<0&&X$L<-X$h?(X$L=X$h,X$q/4):X$q/X$Y.PI2*Math.asin(X$h/X$L),-X$L*Math.pow(2,10*(X$m-=1))*Math.sin((X$m*X$P-X$k)*X$Y.PI2/X$q)+X$p)},X$Y.elasticInOut=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k;return void 0===X$L&&(X$L=0),void 0===X$q&&(X$q=0),0==X$m?X$p:2==(X$m/=.5*X$P)?X$p+X$h:(X$q||(X$q=X$P*(.3*1.5)),X$k=!X$L||0<X$h&&X$L<X$h||X$h<0&&X$L<-X$h?(X$L=X$h,X$q/4):X$q/X$Y.PI2*Math.asin(X$h/X$L),X$m<1?X$L*Math.pow(2,10*(X$m-=1))*Math.sin((X$m*X$P-X$k)*X$Y.PI2/X$q)*-.5+X$p:X$L*Math.pow(2,-10*(X$m-=1))*Math.sin((X$m*X$P-X$k)*X$Y.PI2/X$q)*.5+X$h+X$p)},X$Y.elasticOut=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k;return void 0===X$L&&(X$L=0),void 0===X$q&&(X$q=0),0==X$m?X$p:1==(X$m/=X$P)?X$p+X$h:(X$q||(X$q=.3*X$P),X$k=!X$L||0<X$h&&X$L<X$h||X$h<0&&X$L<-X$h?(X$L=X$h,X$q/4):X$q/X$Y.PI2*Math.asin(X$h/X$L),X$L*Math.pow(2,-10*X$m)*Math.sin((X$m*X$P-X$k)*X$Y.PI2/X$q)+X$h+X$p)},X$Y.strongIn=function(X$m,X$p,X$h,X$P){return X$h*(X$m/=X$P)*X$m*X$m*X$m*X$m+X$p},X$Y.strongInOut=function(X$m,X$p,X$h,X$P){return(X$m/=.5*X$P)<1?.5*X$h*X$m*X$m*X$m*X$m*X$m+X$p:.5*X$h*((X$m-=2)*X$m*X$m*X$m*X$m+2)+X$p},X$Y.strongOut=function(X$m,X$p,X$h,X$P){return X$h*((X$m=X$m/X$P-1)*X$m*X$m*X$m*X$m+1)+X$p},X$Y.sineInOut=function(X$m,X$p,X$h,X$P){return.5*-X$h*(Math.cos(Math.PI*X$m/X$P)-1)+X$p},X$Y.sineIn=function(X$m,X$p,X$h,X$P){return-X$h*Math.cos(X$m/X$P*X$Y.HALF_PI)+X$h+X$p},X$Y.sineOut=function(X$m,X$p,X$h,X$P){return X$h*Math.sin(X$m/X$P*X$Y.HALF_PI)+X$p},X$Y.quintIn=function(X$m,X$p,X$h,X$P){return X$h*(X$m/=X$P)*X$m*X$m*X$m*X$m+X$p},X$Y.quintInOut=function(X$m,X$p,X$h,X$P){return(X$m/=.5*X$P)<1?.5*X$h*X$m*X$m*X$m*X$m*X$m+X$p:.5*X$h*((X$m-=2)*X$m*X$m*X$m*X$m+2)+X$p},X$Y.quintOut=function(X$m,X$p,X$h,X$P){return X$h*((X$m=X$m/X$P-1)*X$m*X$m*X$m*X$m+1)+X$p},X$Y.quartIn=function(X$m,X$p,X$h,X$P){return X$h*(X$m/=X$P)*X$m*X$m*X$m+X$p},X$Y.quartInOut=function(X$m,X$p,X$h,X$P){return(X$m/=.5*X$P)<1?.5*X$h*X$m*X$m*X$m*X$m+X$p:.5*-X$h*((X$m-=2)*X$m*X$m*X$m-2)+X$p},X$Y.quartOut=function(X$m,X$p,X$h,X$P){return-X$h*((X$m=X$m/X$P-1)*X$m*X$m*X$m-1)+X$p},X$Y.cubicIn=function(X$m,X$p,X$h,X$P){return X$h*(X$m/=X$P)*X$m*X$m+X$p},X$Y.cubicInOut=function(X$m,X$p,X$h,X$P){return(X$m/=.5*X$P)<1?.5*X$h*X$m*X$m*X$m+X$p:.5*X$h*((X$m-=2)*X$m*X$m+2)+X$p},X$Y.cubicOut=function(X$m,X$p,X$h,X$P){return X$h*((X$m=X$m/X$P-1)*X$m*X$m+1)+X$p},X$Y.quadIn=function(X$m,X$p,X$h,X$P){return X$h*(X$m/=X$P)*X$m+X$p},X$Y.quadInOut=function(X$m,X$p,X$h,X$P){return(X$m/=.5*X$P)<1?.5*X$h*X$m*X$m+X$p:.5*-X$h*(--X$m*(X$m-2)-1)+X$p},X$Y.quadOut=function(X$m,X$p,X$h,X$P){return-X$h*(X$m/=X$P)*(X$m-2)+X$p},X$Y.expoIn=function(X$m,X$p,X$h,X$P){return 0==X$m?X$p:X$h*Math.pow(2,10*(X$m/X$P-1))+X$p-.001*X$h},X$Y.expoInOut=function(X$m,X$p,X$h,X$P){return 0==X$m?X$p:X$m==X$P?X$p+X$h:(X$m/=.5*X$P)<1?.5*X$h*Math.pow(2,10*(X$m-1))+X$p:.5*X$h*(2-Math.pow(2,-10*--X$m))+X$p},X$Y.expoOut=function(X$m,X$p,X$h,X$P){return X$m==X$P?X$p+X$h:X$h*(1-Math.pow(2,-10*X$m/X$P))+X$p},X$Y.circIn=function(X$m,X$p,X$h,X$P){return-X$h*(Math.sqrt(1-(X$m/=X$P)*X$m)-1)+X$p},X$Y.circInOut=function(X$m,X$p,X$h,X$P){return(X$m/=.5*X$P)<1?.5*-X$h*(Math.sqrt(1-X$m*X$m)-1)+X$p:.5*X$h*(Math.sqrt(1-(X$m-=2)*X$m)+1)+X$p},X$Y.circOut=function(X$m,X$p,X$h,X$P){return X$h*Math.sqrt(1-(X$m=X$m/X$P-1)*X$m)+X$p},X$Y.HALF_PI=.5*Math.PI,X$Y.PI2=2*Math.PI,X$Y}(),X$V=function(){function X$F(){this._hit=null,this._unHit=null}X$D(X$F,"laya.utils.HitArea");var X$m=X$F.prototype;return X$m.isHit=function(X$m,X$p){return!!X$F.isHitGraphic(X$m,X$p,this.hit)&&!X$F.isHitGraphic(X$m,X$p,this.unHit)},X$m.contains=function(X$m,X$p){return this.isHit(X$m,X$p)},X$A(0,X$m,"hit",function(){return this._hit||(this._hit=new X$R),this._hit},function(X$m){this._hit=X$m}),X$A(0,X$m,"unHit",function(){return this._unHit||(this._unHit=new X$R),this._unHit},function(X$m){this._unHit=X$m}),X$F.isHitGraphic=function(X$m,X$p,X$h){if(!X$h)return!1;var X$P;if(!(X$P=X$h.cmds)&&X$h._one&&((X$P=X$F._cmds).length=1,X$P[0]=X$h._one),!X$P)return!1;var X$L,X$q,X$k=0;for(X$L=X$P.length,X$k=0;X$k<X$L;X$k++)if(X$q=X$P[X$k]){var X$Y=X$S._context;switch(X$q.callee){case X$Y._translate:case 6:X$m-=X$q[0],X$p-=X$q[1]}if(X$F.isHitCmd(X$m,X$p,X$q))return!0}return!1},X$F.isHitCmd=function(X$m,X$p,X$h){if(!X$h)return!1;var X$P=X$S._context,X$L=!1;switch(X$h.callee){case X$P._drawRect:case 13:X$F._rec.setTo(X$h[0],X$h[1],X$h[2],X$h[3]),X$L=X$F._rec.contains(X$m,X$p);break;case X$P._drawCircle:case X$P._fillCircle:case 14:X$L=(X$m-=X$h[0])*X$m+(X$p-=X$h[1])*X$p<X$h[2]*X$h[2];break;case X$P._drawPoly:case 18:X$m-=X$h[0],X$p-=X$h[1],X$L=X$F.ptInPolygon(X$m,X$p,X$h[2])}return X$L},X$F.ptInPolygon=function(X$m,X$p,X$h){var X$P;(X$P=X$F._ptPoint).setTo(X$m,X$p);var X$L,X$q=0,X$k=NaN,X$Y=NaN,X$d=NaN,X$K=NaN;X$L=X$h.length;for(var X$D=0;X$D<X$L;X$D+=2){if(X$k=X$h[X$D],X$Y=X$h[X$D+1],X$d=X$h[(X$D+2)%X$L],X$Y!=(X$K=X$h[(X$D+3)%X$L]))if(!(X$P.y<Math.min(X$Y,X$K)))if(!(X$P.y>=Math.max(X$Y,X$K)))(X$P.y-X$Y)*(X$d-X$k)/(X$K-X$Y)+X$k>X$P.x&&X$q++}return X$q%2==1},X$F._cmds=[],X$d(X$F,["_rec",function(){return this._rec=new X$b},"_ptPoint",function(){return this._ptPoint=new X$I}]),X$F}(),X$o=(function(){function X$L(X$m,X$p,X$h,X$P){this.char=X$m,this.charNum=X$m.charCodeAt(0),this._x=this._y=0,this.width=X$p,this.height=X$h,this.style=X$P,this.isWord=!X$L._isWordRegExp.test(X$m)}X$D(X$L,"laya.utils.HTMLChar");var X$m=X$L.prototype;X$E.imps(X$m,{"laya.display.ILayout":!0}),X$m.setSprite=function(X$m){this._sprite=X$m},X$m.getSprite=function(){return this._sprite},X$m._isChar=function(){return!0},X$m._getCSSStyle=function(){return this.style},X$A(0,X$m,"width",function(){return this._w},function(X$m){this._w=X$m}),X$A(0,X$m,"x",function(){return this._x},function(X$m){this._sprite&&(this._sprite.x=X$m),this._x=X$m}),X$A(0,X$m,"y",function(){return this._y},function(X$m){this._sprite&&(this._sprite.y=X$m),this._y=X$m}),X$A(0,X$m,"height",function(){return this._h},function(X$m){this._h=X$m}),X$L._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function X$p(){}X$D(X$p,"laya.utils.Log"),X$p.enable=function(){X$p._logdiv||(X$p._logdiv=X$w.window.document.createElement("div"),X$w.window.document.body.appendChild(X$p._logdiv),X$p._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},X$p.toggle=function(){var X$m=X$p._logdiv.style;"1px"==X$m.width?X$m.width=X$m.height="50%":X$m.width=X$m.height="1px"},X$p.print=function(X$m){X$p._logdiv&&(X$p.maxCount<=X$p._count&&X$p.clear(),X$p._count++,X$p._logdiv.innerText+=X$m+"\n",X$p._logdiv.scrollTop=X$p._logdiv.scrollHeight)},X$p.clear=function(){X$p._logdiv.innerText="",X$p._count=0},X$p._logdiv=null,X$p._count=0,X$p.maxCount=20}(),function(){function X$p(){}X$D(X$p,"laya.utils.Mouse"),X$A(1,X$p,"cursor",function(){return X$p._style.cursor},function(X$m){X$p._style.cursor=X$m}),X$p.hide=function(){"none"!=X$p.cursor&&(X$p._preCursor=X$p.cursor,X$p.cursor="none")},X$p.show=function(){"none"==X$p.cursor&&(X$p.cursor=X$p._preCursor?X$p._preCursor:"auto")},X$p._preCursor=null,X$d(X$p,["_style",function(){return this._style=X$w.document.body.style}])}(),function(){function X$q(){}return X$D(X$q,"laya.utils.Pool"),X$q.getPoolBySign=function(X$m){return X$q._poolDic[X$m]||(X$q._poolDic[X$m]=[])},X$q.clearBySign=function(X$m){X$q._poolDic[X$m]&&(X$q._poolDic[X$m].length=0)},X$q.recover=function(X$m,X$p){X$p.__InPool||(X$p.__InPool=!0,X$q.getPoolBySign(X$m).push(X$p))},X$q.getItemByClass=function(X$m,X$p){var X$h=X$q.getPoolBySign(X$m),X$P=X$h.length?X$h.pop():new X$p;return X$P.__InPool=!1,X$P},X$q.getItemByCreateFun=function(X$m,X$p,X$h){var X$P=X$q.getPoolBySign(X$m),X$L=X$P.length?X$P.pop():X$p.call(X$h);return X$L.__InPool=!1,X$L},X$q.getItem=function(X$m){var X$p=X$q.getPoolBySign(X$m),X$h=X$p.length?X$p.pop():null;return X$h&&(X$h.__InPool=!1),X$h},X$q._poolDic={},X$q.InPoolSign="__InPool",X$q}()),X$f=function(){function X$d(){}return X$D(X$d,"laya.utils.Stat"),X$A(1,X$d,"onclick",null,function(X$m){X$d._sp&&X$d._sp.on("click",X$d._sp,X$m),X$d._canvas&&(X$d._canvas.source.onclick=X$m,X$d._canvas.source.style.pointerEvents="")}),X$d.show=function(X$m,X$p,X$h){if(void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),!X$S.isConchApp||X$S.isConchWebGL){if(X$S.isConchWebGL||X$w.onMiniGame||X$w.onLimixiu||(X$d._useCanvas=!0),X$d._show=!0,X$d._fpsData.length=60,X$d._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},X$d._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},X$d._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},X$d._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},X$S.isWebGL)if(X$d._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},X$S.is3DMode){if(X$d._view[0].title="FPS(3D)",X$d._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},X$d._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},X$d._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==X$h){var X$P=8;X$d._view[X$P++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},X$d._view[X$P++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},X$d._view[X$P++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},X$d._view[X$P++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},X$d._view[X$P++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},X$d._view[X$P++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},X$d._view[X$P++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},X$d._view[X$P++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},X$d._view[X$P++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==X$h){X$P=8;X$d._view[X$P++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},X$d._view[X$P++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},X$d._view[X$P++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},X$d._view[X$P++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},X$d._view[X$P++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},X$d._view[X$P++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},X$d._view[X$P++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else X$d._view[0].title="FPS(WebGL)",X$d._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else X$d._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};X$d._useCanvas?X$d.createUIPre(X$m,X$p):X$d.createUI(X$m,X$p),X$d.enable()}else X$w.window.conch.showFPS&&X$w.window.conch.showFPS(X$m,X$p)},X$d.createUIPre=function(X$m,X$p){var X$h=X$w.pixelRatio;X$d._width=170*X$h,X$d._vx=75*X$h,X$d._height=X$h*(12*X$d._view.length+3*X$h)+4,X$d._fontSize=12*X$h;for(var X$P=0;X$P<X$d._view.length;X$P++)X$d._view[X$P].x=4,X$d._view[X$P].y=X$P*X$d._fontSize+2*X$h;X$d._canvas||((X$d._canvas=new X$am("2D")).size(X$d._width,X$d._height),(X$d._ctx=X$d._canvas.getContext("2d")).textBaseline="top",X$d._ctx.font=X$d._fontSize+"px Sans-serif",X$d._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+X$m+"px;top:"+X$p+"px;width:"+X$d._width/X$h+"px;height:"+X$d._height/X$h+"px;"),X$d._first=!0,X$d.loop(),X$d._first=!1,X$w.container.appendChild(X$d._canvas.source)},X$d.createUI=function(X$m,X$p){var X$h=X$d._sp,X$P=X$w.pixelRatio;X$h||(X$h=new X$Fm,(X$d._leftText=new X$nm).pos(5,5),X$d._leftText.color="#ffffff",X$h.addChild(X$d._leftText),(X$d._txt=new X$nm).pos(80*X$P,5),X$d._txt.color="#ffffff",X$h.addChild(X$d._txt),X$d._sp=X$h),X$h.pos(X$m,X$p);for(var X$L="",X$q=0;X$q<X$d._view.length;X$q++){X$L+=X$d._view[X$q].title+"\n"}X$d._leftText.text=X$L;var X$k=170*X$P,X$Y=X$P*(12*X$d._view.length+3*X$P)+4;X$d._txt.fontSize=X$d._fontSize*X$P,X$d._leftText.fontSize=X$d._fontSize*X$P,X$h.size(X$k,X$Y),X$h.graphics.clear(),X$h.graphics.setAlpha(.5),X$h.graphics.drawRect(0,0,X$k,X$Y,"#999999"),X$h.graphics.setAlpha(1),X$d.loop()},X$d.enable=function(){X$E.timer.frameLoop(1,X$d,X$d.loop)},X$d.hide=function(){X$d._show=!1,X$E.timer.clear(X$d,X$d.loop),X$d._canvas&&X$w.removeElement(X$d._canvas.source)},X$d.clear=function(){X$d.trianglesFaces=X$d.drawCall=X$d.shaderCall=X$d.spriteCount=X$d.spriteRenderUseCacheCount=X$d.treeNodeCollision=X$d.treeSpriteCollision=X$d.canvasNormal=X$d.canvasBitmap=X$d.canvasReCache=0},X$d.loop=function(){X$d._count++;var X$m=X$w.now();if(!(X$m-X$d._timer<1e3)){var X$p=X$d._count;if(X$d.FPS=Math.round(1e3*X$p/(X$m-X$d._timer)),X$d._show){X$d.trianglesFaces=Math.round(X$d.trianglesFaces/X$p),X$d.spriteCount=X$d._useCanvas?(X$d.drawCall=Math.round(X$d.drawCall/X$p)-2,X$d.shaderCall=Math.round(X$d.shaderCall/X$p),Math.round(X$d.spriteCount/X$p)-1):(X$d.drawCall=Math.round(X$d.drawCall/X$p)-2,X$d.shaderCall=Math.round(X$d.shaderCall/X$p)-4,Math.round(X$d.spriteCount/X$p)-4),X$d.spriteRenderUseCacheCount=Math.round(X$d.spriteRenderUseCacheCount/X$p),X$d.canvasNormal=Math.round(X$d.canvasNormal/X$p),X$d.canvasBitmap=Math.round(X$d.canvasBitmap/X$p),X$d.canvasReCache=Math.ceil(X$d.canvasReCache/X$p),X$d.treeNodeCollision=Math.round(X$d.treeNodeCollision/X$p),X$d.treeSpriteCollision=Math.round(X$d.treeSpriteCollision/X$p);var X$h=0<X$d.FPS?Math.floor(1e3/X$d.FPS).toString():" ";X$d._fpsStr=X$d.FPS+(X$d.renderSlow?" slow":"")+" "+X$h,X$d._spriteStr=X$d.spriteCount+(X$d.spriteRenderUseCacheCount?"/"+X$d.spriteRenderUseCacheCount:""),X$d._canvasStr=X$d.canvasReCache+"/"+X$d.canvasNormal+"/"+X$d.canvasBitmap,X$d.currentMemorySize=X$z.systemResourceManager.memorySize,X$d._useCanvas?X$d.renderInfoPre():X$d.renderInfo(),X$d.clear()}X$d._count=0,X$d._timer=X$m}},X$d.renderInfoPre=function(){if(X$d._canvas){var X$m=X$d._ctx;X$m.clearRect(X$d._first?0:X$d._vx,0,X$d._width,X$d._height);for(var X$p=X$S.WebGL.mainContext,X$h=0;X$h<X$d._view.length;X$h++){var X$P=X$d._view[X$h];X$d._first&&(X$m.fillStyle="white",X$m.fillText(X$P.title,X$P.x,X$P.y,null,null,null)),X$m.fillStyle=X$P.color;var X$L=-1;if((X$P=X$d._view[X$h]).varying){if(X$p)switch(X$P.varying){case 1:X$L=X$p.getParameter(X$p[X$P.value]);break;case 2:X$L=X$p.getExtension(X$P.value)}}else X$L=X$d[X$P.value];"M"==X$P.units&&(X$L=Math.floor(X$L/1048576*100)/100+" M"),"K"==X$P.units&&(X$L=Math.floor(X$L/1024*100)/100+" K"),"string"==X$P.units&&(X$L=X$L.match(/\d+\.?\d/i)),X$m.fillText(X$L+"",X$P.x+X$d._vx,X$P.y,null,null,null)}}},X$d.renderInfo=function(){for(var X$m="",X$p=X$S.WebGL.mainContext,X$h=0;X$h<X$d._view.length;X$h++){var X$P=X$d._view[X$h],X$L=-1;if(X$P.varying){if(X$p)switch(X$P.varying){case 1:X$L=X$p.getParameter(X$p[X$P.value]);break;case 2:X$L=X$p.getExtension(X$P.value)}}else X$L=X$d[X$P.value];"M"==X$P.units&&(X$L=Math.floor(X$L/1048576*100)/100+" M"),"K"==X$P.units&&(X$L=Math.floor(X$L/1024*100)/100+" K"),"string"==X$P.units&&(X$L=X$L.match(/\d+\.?\d/i)),X$m+=X$L+"\n"}X$d._txt.text=X$m},X$d.FPS=0,X$d.loopCount=0,X$d.shaderCall=0,X$d.drawCall=0,X$d.trianglesFaces=0,X$d.spriteCount=0,X$d.spriteRenderUseCacheCount=0,X$d.treeNodeCollision=0,X$d.treeSpriteCollision=0,X$d.canvasNormal=0,X$d.canvasBitmap=0,X$d.canvasReCache=0,X$d.renderSlow=!1,X$d.currentMemorySize=0,X$d._fpsStr=null,X$d._canvasStr=null,X$d._spriteStr=null,X$d._fpsData=[],X$d._timer=0,X$d._count=0,X$d._view=[],X$d._fontSize=12,X$d._txt=null,X$d._leftText=null,X$d._sp=null,X$d._show=!1,X$d._useCanvas=!1,X$d._canvas=null,X$d._ctx=null,X$d._first=!1,X$d._vx=NaN,X$d._width=0,X$d._height=100,X$d}(),X$i=(function(){function X$m(){this._strsToID={},this._idToStrs=[],this._length=0}X$D(X$m,"laya.utils.StringKey");var X$p=X$m.prototype;X$p.add=function(X$m){var X$p=this._strsToID[X$m];return null!=X$p?X$p:(this._idToStrs[this._length]=X$m,this._strsToID[X$m]=this._length++)},X$p.getID=function(X$m){var X$p=this._strsToID[X$m];return null==X$p?-1:X$p},X$p.getName=function(X$m){var X$p=this._idToStrs[X$m];return null==X$p?void 0:X$p}}(),function(){var X$K;function X$m(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}X$D(X$m,"laya.utils.Timer");var X$p=X$m.prototype;return X$p._init=function(){X$E.timer&&X$E.timer.frameLoop(1,this,this._update)},X$p._now=function(){return Date.now()},X$p._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var X$m=this.currFrame=this.currFrame+this.scale,X$p=this._now();this._delta=(X$p-this._lastTimer)*this.scale;var X$h=this.currTimer=this.currTimer+this._delta;X$E.isDebug&&6e4<Math.abs(X$p-this._lastTimer)&&console.error("系统时间错误！"+(X$p-this._lastTimer)),this._lastTimer=X$p;var X$P=this._handlers;for(X$k=this._count=0,X$Y=X$P.length;X$k<X$Y;X$k++)if(null!==(X$d=X$P[X$k]).method){var X$L=X$d.userFrame?X$m:X$h;if(X$L>=X$d.exeTime)if(X$d.repeat)if(X$d.jumpFrame)for(;X$L>=X$d.exeTime;)X$d.exeTime+=X$d.delay,X$d.run(!1);else X$d.exeTime+=X$d.delay,X$d.run(!1),X$L>X$d.exeTime&&(X$d.exeTime+=Math.ceil((X$L-X$d.exeTime)/X$d.delay)*X$d.delay);else X$d.run(!0)}else this._count++;(30<this._count||X$m%200==0)&&this._clearHandlers();for(var X$q=this._laters,X$k=0,X$Y=X$q.length-1;X$k<=X$Y;X$k++){var X$d=X$q[X$k];this._isIgnoreRecover(X$d)||(null!==X$d.method&&(delete this._map[X$d.key],X$d.run(!1)),this._recoverHandler(X$d)),X$k===X$Y&&(X$Y=X$q.length-1)}X$q.length=0}},X$p._clearHandlers=function(){for(var X$m=this._handlers,X$p=0,X$h=X$m.length;X$p<X$h;X$p++){var X$P=X$m[X$p];null!==X$P.method?this._temp.push(X$P):this._isIgnoreRecover(X$P)?this._temp.push(X$P):this._recoverHandler(X$P)}this._handlers=this._temp,this._temp=X$m,this._temp.length=0},X$p._recoverHandler=function(X$m){this._map[X$m.key]==X$m&&delete this._map[X$m.key],X$m.recover()},X$p._create=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){if(!X$h)return X$L.apply(X$P,X$q),null;if(X$k){var X$d=this._getHandler(X$P,X$L);if(X$d)return X$d.repeat=X$p,X$d.userFrame=X$m,X$d.delay=X$h,X$d.ignoreRecover=X$Y,X$d.caller=X$P,X$d.method=X$L,X$d.args=X$q,X$d.exeTime=X$h+(X$m?this.currFrame:this.currTimer+this._now()-this._lastTimer),X$d}return(X$d=X$K.create()).repeat=X$p,X$d.userFrame=X$m,X$d.delay=X$h,X$d.ignoreRecover=X$Y,X$d.caller=X$P,X$d.method=X$L,X$d.args=X$q,X$d.exeTime=X$h+(X$m?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(X$d),this._handlers.push(X$d),X$d},X$p._indexHandler=function(X$m){var X$p=X$m.caller,X$h=X$m.method,X$P=X$p?X$p.$_GID||(X$p.$_GID=X$g.getGID()):0,X$L=X$h.$_TID||(X$h.$_TID=this._mid++);X$m.key=X$P+"_"+X$L,this._map[X$m.key]=X$m},X$p.once=function(X$m,X$p,X$h,X$P,X$L){void 0===X$L&&(X$L=!0),this._create(!1,!1,X$m,X$p,X$h,X$P,X$L,!1)},X$p.loop=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){void 0===X$L&&(X$L=!0),void 0===X$q&&(X$q=!1),void 0===X$k&&(X$k=!1);var X$Y=this._create(!1,!0,X$m,X$p,X$h,X$P,X$L,X$k);X$Y&&(X$Y.jumpFrame=X$q)},X$p.frameOnce=function(X$m,X$p,X$h,X$P,X$L){void 0===X$L&&(X$L=!0),this._create(!0,!1,X$m,X$p,X$h,X$P,X$L,!1)},X$p.frameLoop=function(X$m,X$p,X$h,X$P,X$L,X$q){void 0===X$L&&(X$L=!0),void 0===X$q&&(X$q=!1),this._create(!0,!0,X$m,X$p,X$h,X$P,X$L,X$q)},X$p.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+X$K._freeCount},X$p.clear=function(X$m,X$p){var X$h=this._getHandler(X$m,X$p);return!(!X$h||this._isIgnoreRecover(X$h))&&(delete this._map[X$h.key],X$h.key=null,X$h.clear(),!0)},X$p.clearAll=function(X$m){if(X$m)for(var X$p=0,X$h=this._handlers.length;X$p<X$h;X$p++){var X$P=this._handlers[X$p];X$P.caller===X$m&&(this._isIgnoreRecover(X$P)||(delete this._map[X$P.key],X$P.key=null,X$P.clear()))}},X$p._getHandler=function(X$m,X$p){var X$h=X$m?X$m.$_GID||(X$m.$_GID=X$g.getGID()):0,X$P=X$p.$_TID||(X$p.$_TID=this._mid++);return this._map[X$h+"_"+X$P]},X$p._isIgnoreRecover=function(X$m){if(X$m.ignoreRecover||X$m.caller&&"IgnoreRecover"==X$m.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var X$p="";try{arguments.propertyIsEnumerable.caller}catch(X$m){X$p=X$m.stack}X$E.recordError("报错：核心定时器销毁忽略  "+X$p)}return!0}return!1},X$p.hasHandler=function(X$m,X$p){return this._map[X$m.$_GID+"_"+X$p.$_TID]},X$p.callLater=function(X$m,X$p,X$h){if(null==this._getHandler(X$m,X$p)){var X$P=X$K.create();X$P.caller=X$m,X$P.method=X$p,X$P.args=X$h,this._indexHandler(X$P),this._laters.push(X$P)}},X$p.runCallLater=function(X$m,X$p){var X$h=this._getHandler(X$m,X$p);X$h&&null!=X$h.method&&(this._isIgnoreRecover(X$h)||(delete this._map[X$h.key],X$h.run(!0)))},X$p.runTimer=function(X$m,X$p){this.runCallLater(X$m,X$p)},X$A(0,X$p,"delta",function(){return this._delta}),X$m.__init$=function(){X$K=function(){function X$p(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}X$D(X$p,"");var X$m=X$p.prototype;return X$m.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},X$m.recover=function(){this.clear(),this.args=X$p._freeHandler,X$p._freeHandler=this,X$p._freeCount++},X$m.run=function(X$m){var X$p=this.caller;if(X$p&&X$p.destroyed)return this.clear();var X$h=this.method,X$P=this.args;X$m&&this.clear(),null!=X$h&&(X$P?X$h.apply(X$p,X$P):X$h.call(X$p))},X$p._freeHandler=null,X$p._freeCount=0,X$p.create=function(){var X$m=X$p._freeHandler;return X$m?(X$p._freeHandler=X$m.args,--X$p._freeCount,X$m.args=null,X$m):new X$p},X$p}()},X$m}()),X$v=function(){function X$F(){this.gid=0}X$D(X$F,"laya.utils.Tween");var X$m=X$F.prototype;return X$m.to=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){return void 0===X$q&&(X$q=0),void 0===X$k&&(X$k=!1),this._create(X$m,X$p,X$h,X$P,X$L,X$q,X$k,!0,!1,!0)},X$m.from=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){return void 0===X$q&&(X$q=0),void 0===X$k&&(X$k=!1),this._create(X$m,X$p,X$h,X$P,X$L,X$q,X$k,!1,!1,!0)},X$m._create=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){if(!X$m)throw new Error("Tween:target is null");this._target=X$m,this._duration=X$h,this._ease=X$P||X$p.ease||X$F.easeNone,this._complete=X$L||X$p.complete,this._delay=X$q,this._props=[],this._usedTimer=0,this._startTimer=X$w.now(),this._usedPool=X$d,this._delayParam=null,this.update=X$p.update;var X$D=X$m.$_GID||(X$m.$_GID=X$g.getGID());return X$F.tweenMap[X$D]?(X$k&&X$F.clearTween(X$m),X$F.tweenMap[X$D].push(this)):X$F.tweenMap[X$D]=[this],X$K?X$q<=0?this.firstStart(X$m,X$p,X$Y):(this._delayParam=[X$m,X$p,X$Y],X$E.scaleTimer.once(X$q,this,this.firstStart,this._delayParam)):this._initProps(X$m,X$p,X$Y),this},X$m.firstStart=function(X$m,X$p,X$h){this._delayParam=null,X$m.destroyed?this.clear():(this._initProps(X$m,X$p,X$h),this._beginLoop())},X$m._initProps=function(X$m,X$p,X$h){for(var X$P in X$p)if("number"==typeof X$m[X$P]){var X$L=X$h?X$m[X$P]:X$p[X$P],X$q=X$h?X$p[X$P]:X$m[X$P];this._props.push([X$P,X$L,X$q-X$L]),X$h||(X$m[X$P]=X$L)}},X$m._beginLoop=function(){X$E.scaleTimer.frameLoop(1,this,this._doEase)},X$m._doEase=function(){this._updateEase(X$w.now())},X$m._updateEase=function(X$m){var X$p=this._target;if(X$p){if(X$p.destroyed)return X$F.clearTween(X$p);var X$h=this._usedTimer=X$m-this._startTimer-this._delay;if(!(X$h<0)){if(X$h>=this._duration)return this.complete();for(var X$P=0<X$h?this._ease(X$h,0,1,this._duration):0,X$L=this._props,X$q=0,X$k=X$L.length;X$q<X$k;X$q++){var X$Y=X$L[X$q];X$p[X$Y[0]]=X$Y[1]+X$P*X$Y[2]}this.update&&this.update.run()}}},X$m.complete=function(){if(this._target){X$E.scaleTimer.runTimer(this,this.firstStart);for(var X$m=this._target,X$p=this._props,X$h=this._complete,X$P=0,X$L=X$p.length;X$P<X$L;X$P++){var X$q=X$p[X$P];X$m[X$q[0]]=X$q[1]+X$q[2]}this.update&&this.update.run(),this.clear(),X$h&&X$h.run()}},X$m.pause=function(){X$E.scaleTimer.clear(this,this._beginLoop),X$E.scaleTimer.clear(this,this._doEase),X$E.scaleTimer.clear(this,this.firstStart);var X$m;(X$m=X$w.now()-this._startTimer-this._delay)<0&&(this._usedTimer=X$m)},X$m.setStartTime=function(X$m){this._startTimer=X$m},X$m.clear=function(){this._target&&(this._remove(),this._clear())},X$m._clear=function(){this.pause(),X$E.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,X$o.recover("tween",this))},X$m.recover=function(){this._usedPool=!0,this._clear()},X$m._remove=function(){var X$m=X$F.tweenMap[this._target.$_GID];if(X$m)for(var X$p=0,X$h=X$m.length;X$p<X$h;X$p++)if(X$m[X$p]===this){X$m.splice(X$p,1);break}},X$m.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=X$w.now(),this._delayParam)X$E.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var X$m=this._props,X$p=0,X$h=X$m.length;X$p<X$h;X$p++){var X$P=X$m[X$p];this._target[X$P[0]]=X$P[1]}X$E.scaleTimer.once(this._delay,this,this._beginLoop)}},X$m.resume=function(){this._usedTimer>=this._duration||(this._startTimer=X$w.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?X$E.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},X$A(0,X$m,"progress",null,function(X$m){var X$p=X$m*this._duration;this._startTimer=X$w.now()-this._delay-X$p}),X$F.to=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){return void 0===X$q&&(X$q=0),void 0===X$k&&(X$k=!1),void 0===X$Y&&(X$Y=!0),X$o.getItemByClass("tween",X$F)._create(X$m,X$p,X$h,X$P,X$L,X$q,X$k,!0,X$Y,!0)},X$F.from=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){return void 0===X$q&&(X$q=0),void 0===X$k&&(X$k=!1),void 0===X$Y&&(X$Y=!0),X$o.getItemByClass("tween",X$F)._create(X$m,X$p,X$h,X$P,X$L,X$q,X$k,!1,X$Y,!0)},X$F.clearAll=function(X$m){if(X$m&&X$m.$_GID){var X$p=X$F.tweenMap[X$m.$_GID];if(X$p){for(var X$h=0,X$P=X$p.length;X$h<X$P;X$h++)X$p[X$h]._clear();X$p.length=0}}},X$F.clear=function(X$m){X$m.clear()},X$F.clearTween=function(X$m){X$F.clearAll(X$m)},X$F.easeNone=function(X$m,X$p,X$h,X$P){return X$h*X$m/X$P+X$p},X$F.tweenMap={},X$F}(),X$g=function(){function X$Y(){}return X$D(X$Y,"laya.utils.Utils"),X$Y.toRadian=function(X$m){return X$m*X$Y._pi2},X$Y.toAngle=function(X$m){return X$m*X$Y._pi},X$Y.toHexColor=function(X$m){if(X$m<0||isNaN(X$m))return null;for(var X$p=X$m.toString(16);X$p.length<6;)X$p="0"+X$p;return"#"+X$p},X$Y.getGID=function(){return X$Y._gid++},X$Y.concatArray=function(X$m,X$p){if(!X$p)return X$m;if(!X$m)return X$p;var X$h=0,X$P=X$p.length;for(X$h=0;X$h<X$P;X$h++)X$m.push(X$p[X$h]);return X$m},X$Y.clearArray=function(X$m){return X$m&&(X$m.length=0),X$m},X$Y.copyArray=function(X$m,X$p){if(X$m||(X$m=[]),!X$p)return X$m;X$m.length=X$p.length;var X$h=0,X$P=X$p.length;for(X$h=0;X$h<X$P;X$h++)X$m[X$h]=X$p[X$h];return X$m},X$Y.getGlobalRecByPoints=function(X$m,X$p,X$h,X$P,X$L){var X$q,X$k;return X$q=new X$I(X$p,X$h),X$q=X$m.localToGlobal(X$q),X$k=new X$I(X$P,X$L),X$k=X$m.localToGlobal(X$k),X$b._getWrapRec([X$q.x,X$q.y,X$k.x,X$k.y])},X$Y.getGlobalPosAndScale=function(X$m){return X$Y.getGlobalRecByPoints(X$m,0,0,1,1)},X$Y.bind=function(X$m,X$p){return X$m.bind(X$p)},X$Y.measureText=function(X$m,X$p){return X$Q.measureText(X$m,X$p)},X$Y.contextMeasureText=function(X$m){var X$p=X$w.context.measureText(X$m);return X$p||(X$p={width:16,height:16}),X$p},X$Y.updateOrder=function(X$m){if(!X$m||X$m.length<2)return!1;for(var X$p,X$h=1,X$P=0,X$L=X$m.length,X$q=NaN;X$h<X$L;){for(X$p=X$m[X$P=X$h],X$q=X$m[X$P]._zOrder;-1<--X$P&&X$m[X$P]._zOrder>X$q;)X$m[X$P+1]=X$m[X$P];X$m[X$P+1]=X$p,X$h++}var X$k=X$p.parent.conchModel;if(X$k)if(null!=X$k.updateZOrder)X$k.updateZOrder();else{for(X$h=0;X$h<X$L;X$h++)X$k.removeChild(X$m[X$h].conchModel);for(X$h=0;X$h<X$L;X$h++)X$k.addChildAt(X$m[X$h].conchModel,X$h)}return!0},X$Y.transPointList=function(X$m,X$p,X$h){var X$P=0,X$L=X$m.length;for(X$P=0;X$P<X$L;X$P+=2)X$m[X$P]+=X$p,X$m[X$P+1]+=X$h},X$Y.parseInt=function(X$m,X$p){void 0===X$p&&(X$p=0);var X$h=X$w.window.parseInt(X$m,X$p);return isNaN(X$h)?0:X$h},X$Y.getFileExtension=function(X$m){X$Y._extReg.lastIndex=X$m.lastIndexOf(".");var X$p=X$Y._extReg.exec(X$m);return X$p&&1<X$p.length?X$p[1].toLowerCase():null},X$Y.getTransformRelativeToWindow=function(X$m,X$p,X$h){var X$P=X$E.stage,X$L=laya.utils.Utils.getGlobalPosAndScale(X$m),X$q=X$P._canvasTransform.clone(),X$k=X$q.tx,X$Y=X$q.ty;X$q.rotate(-Math.PI/180*X$E.stage.canvasDegree),X$q.scale(X$E.stage.clientScaleX,X$E.stage.clientScaleY);var X$d=X$E.stage.canvasDegree%180!=0,X$K=NaN,X$D=NaN;X$d?(X$K=X$h+X$L.y,X$D=X$p+X$L.x,X$K*=X$q.d,X$D*=X$q.a,90==X$E.stage.canvasDegree?(X$K=X$k-X$K,X$D+=X$Y):(X$K+=X$k,X$D=X$Y-X$D)):(X$K=X$p+X$L.x,X$D=X$h+X$L.y,X$K*=X$q.a,X$D*=X$q.d,X$K+=X$k,X$D+=X$Y);var X$F=NaN,X$R=NaN;return X$R=X$d?(X$F=X$q.d*X$L.height,X$q.a*X$L.width):(X$F=X$q.a*X$L.width,X$q.d*X$L.height),{x:X$K,y:X$D,scaleX:X$F,scaleY:X$R}},X$Y.fitDOMElementInArea=function(X$m,X$p,X$h,X$P,X$L,X$q){X$m._fitLayaAirInitialized||(X$m._fitLayaAirInitialized=!0,X$m.style.transformOrigin=X$m.style.webKittransformOrigin="left top",X$m.style.position="absolute");var X$k=X$Y.getTransformRelativeToWindow(X$p,X$h,X$P);X$m.style.transform=X$m.style.webkitTransform="scale("+X$k.scaleX+","+X$k.scaleY+") rotate("+X$E.stage.canvasDegree+"deg)",X$m.style.width=X$L+"px",X$m.style.height=X$q+"px",X$m.style.left=X$k.x+"px",X$m.style.top=X$k.y+"px"},X$Y.isOkTextureList=function(X$m){if(!X$m)return!1;var X$p,X$h=0,X$P=X$m.length;for(X$h=0;X$h<X$P;X$h++)if(!(X$p=X$m[X$h])||!X$p.source)return!1;return!0},X$Y.isOKCmdList=function(X$m){if(!X$m)return!1;var X$p,X$h,X$P=0,X$L=X$m.length,X$q=X$S._context;for(X$P=0;X$P<X$L;X$P++)switch((X$p=X$m[X$P]).callee){case X$q._drawTexture:case X$q._fillTexture:case X$q._drawTextureWithTransform:if(!(X$h=X$p[0])||!X$h.source)return!1}return!0},X$Y._gid=1,X$Y._pi=180/Math.PI,X$Y._pi2=Math.PI/180,X$Y._extReg=/\.(\w+)\??/g,X$Y.parseXMLFromString=function(X$m){var X$p;if(X$m=X$m.replace(/>\s+</g,"><"),-1<(X$p=(new DOMParser).parseFromString(X$m,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(X$p.firstChild.firstChild.textContent);return X$p},X$Y}(),X$t=function(){function X$m(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],X$S.isWebGL&&X$s.regCacheByFunction(X$g.bind(this.startDispose,this),X$g.bind(this.getCacheList,this))}X$D(X$m,"laya.utils.VectorGraphManager");var X$p=X$m.prototype;return X$p.getId=function(){return this._id++},X$p.addShape=function(X$m,X$p){this.shapeDic[X$m]=X$p,this.useDic[X$m]||(this.useDic[X$m]=!0)},X$p.addLine=function(X$m,X$p){this.shapeLineDic[X$m]=X$p,this.shapeLineDic[X$m]||(this.shapeLineDic[X$m]=!0)},X$p.getShape=function(X$m){this._checkKey&&null!=this.useDic[X$m]&&(this.useDic[X$m]=!0)},X$p.deleteShape=function(X$m){this.shapeDic[X$m]&&(this.shapeDic[X$m]=null,delete this.shapeDic[X$m]),this.shapeLineDic[X$m]&&(this.shapeLineDic[X$m]=null,delete this.shapeLineDic[X$m]),null!=this.useDic[X$m]&&delete this.useDic[X$m]},X$p.getCacheList=function(){var X$m,X$p=[];for(X$m in this.shapeDic)X$p.push(this.shapeDic[X$m]);for(X$m in this.shapeLineDic)X$p.push(this.shapeLineDic[X$m]);return X$p},X$p.startDispose=function(X$m){var X$p;for(X$p in this.useDic)this.useDic[X$p]=!1;this._checkKey=!0},X$p.endDispose=function(){if(this._checkKey){var X$m;for(X$m in this.useDic)this.useDic[X$m]||this.deleteShape(X$m);this._checkKey=!1}},X$m.getInstance=function(){return X$m.instance=X$m.instance||new X$m},X$m.instance=null,X$m}(),X$O=function(){function X$P(){this._obj=null,this._obj=X$P.supportWeakMap?new X$w.window.WeakMap:{},X$P.supportWeakMap||X$P._maps.push(this)}X$D(X$P,"laya.utils.WeakObject");var X$m=X$P.prototype;return X$m.set=function(X$m,X$p){if(null!=X$m)if(X$P.supportWeakMap){var X$h=X$m;"string"!=typeof X$m&&"number"!=typeof X$m||(X$h=X$P._keys[X$m])||(X$h=X$P._keys[X$m]={k:X$m}),this._obj.set(X$h,X$p)}else"string"==typeof X$m||"number"==typeof X$m?this._obj[X$m]=X$p:(X$m.$_GID||(X$m.$_GID=X$g.getGID()),this._obj[X$m.$_GID]=X$p)},X$m.get=function(X$m){if(null==X$m)return null;if(X$P.supportWeakMap){var X$p="string"==typeof X$m||"number"==typeof X$m?X$P._keys[X$m]:X$m;return X$p?this._obj.get(X$p):null}return"string"==typeof X$m||"number"==typeof X$m?this._obj[X$m]:this._obj[X$m.$_GID]},X$m.del=function(X$m){if(null!=X$m)if(X$P.supportWeakMap){var X$p="string"==typeof X$m||"number"==typeof X$m?X$P._keys[X$m]:X$m;if(!X$p)return;this._obj.delete(X$p)}else"string"==typeof X$m||"number"==typeof X$m?delete this._obj[X$m]:delete this._obj[this._obj.$_GID]},X$m.has=function(X$m){if(null==X$m)return!1;if(X$P.supportWeakMap){var X$p="string"==typeof X$m||"number"==typeof X$m?X$P._keys[X$m]:X$m;return this._obj.has(X$p)}return"string"==typeof X$m||"number"==typeof X$m?null!=this._obj[X$m]:null!=this._obj[this._obj.$_GID]},X$P.__init__=function(){(X$P.supportWeakMap=null!=X$w.window.WeakMap)||X$E.timer.loop(X$P.delInterval,null,X$P.clearCache)},X$P.clearCache=function(){for(var X$m=0,X$p=X$P._maps.length;X$m<X$p;X$m++){X$P._maps[X$m]._obj={}}},X$P.supportWeakMap=!1,X$P.delInterval=3e5,X$P._keys={},X$P._maps=[],X$d(X$P,["I",function(){return this.I=new X$P}]),X$P}(),X$C=function(){function X$m(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}X$D(X$m,"laya.utils.WordText");var X$p=X$m.prototype;return X$p.setText=function(X$m){this.changed=!0,this._text=X$m},X$p.toString=function(){return this._text},X$p.charCodeAt=function(X$m){return this._text?this._text.charCodeAt(X$m):NaN},X$p.charAt=function(X$m){return this._text?this._text.charAt(X$m):null},X$A(0,X$p,"length",function(){return this._text?this._text.length:0}),X$m}(),X$mm=function(X$m){function X$k(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,X$k.__super.call(this),this._childs=X$k.ARRAY_EMPTY,this._$P=X$k.PROP_EMPTY,this.timer=X$E.scaleTimer,this.conchModel=X$S.isConchNode?this.createConchModel():null}X$D(X$k,"laya.display.Node",X$K);var X$p=X$k.prototype;return X$p._setBit=function(X$m,X$p){1==X$m&&(this._getBit(X$m)!=X$p&&this._updateDisplayedInstage());X$p?this._bits|=X$m:this._bits&=~X$m},X$p._getBit=function(X$m){return 0!=(this._bits&X$m)},X$p._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},X$p._setUpNoticeType=function(X$m){var X$p=this;for(X$p._setBit(X$m,!0),X$p=X$p.parent;X$p;){if(X$p._getBit(X$m))return;X$p._setBit(X$m,!0),X$p=X$p.parent}},X$p.on=function(X$m,X$p,X$h,X$P){return"display"!==X$m&&"undisplay"!==X$m||this._getBit(1)||this._setUpNoticeType(1),this._createListener(X$m,X$p,X$h,X$P,!1)},X$p.once=function(X$m,X$p,X$h,X$P){return"display"!==X$m&&"undisplay"!==X$m||this._getBit(1)||this._setUpNoticeType(1),this._createListener(X$m,X$p,X$h,X$P,!0)},X$p.createConchModel=function(){return null},X$p.destroy=function(X$m){void 0===X$m&&(X$m=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(X$m?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},X$p.destroyChildren=function(){if(this._childs)for(var X$m=this._childs.length-1;-1<X$m;X$m--)this._childs[X$m].destroy(!0)},X$p.addChild=function(X$m){if(!X$m||this.destroyed||X$m===this)return X$m;if(X$m.zOrder&&this._set$P("hasZorder",!0),X$m._parent===this){var X$p=this.getChildIndex(X$m);X$p!==this._childs.length-1&&(this._childs.splice(X$p,1),this._childs.push(X$m),this.conchModel&&(this.conchModel.removeChild(X$m.conchModel),this.conchModel.addChildAt(X$m.conchModel,this._childs.length-1)),this._childChanged())}else X$m.parent&&X$m.parent.removeChild(X$m),this._childs===X$k.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(X$m),this.conchModel&&this.conchModel.addChildAt(X$m.conchModel,this._childs.length-1),(X$m.parent=this)._childChanged();return X$m},X$p.addChildren=function(X$m){for(var X$p=arguments,X$h=0,X$P=X$p.length;X$h<X$P;)this.addChild(X$p[X$h++])},X$p.addChildAt=function(X$m,X$p){if(!X$m||this.destroyed||X$m===this)return X$m;if(X$m.zOrder&&this._set$P("hasZorder",!0),0<=X$p&&X$p<=this._childs.length){if(X$m._parent===this){var X$h=this.getChildIndex(X$m);this._childs.splice(X$h,1),this._childs.splice(X$p,0,X$m),this.conchModel&&(this.conchModel.removeChild(X$m.conchModel),this.conchModel.addChildAt(X$m.conchModel,X$p)),this._childChanged()}else X$m.parent&&X$m.parent.removeChild(X$m),this._childs===X$k.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(X$p,0,X$m),this.conchModel&&this.conchModel.addChildAt(X$m.conchModel,X$p),X$m.parent=this;return X$m}throw new Error("appendChildAt:The index is out of bounds")},X$p.getChildIndex=function(X$m){return this._childs.indexOf(X$m)},X$p.getChildByName=function(X$m){var X$p=this._childs;if(X$p)for(var X$h=0,X$P=X$p.length;X$h<X$P;X$h++){var X$L=X$p[X$h];if(X$L.name===X$m)return X$L}return null},X$p._get$P=function(X$m){return this._$P[X$m]},X$p._set$P=function(X$m,X$p){return this.destroyed||(this._$P===X$k.PROP_EMPTY&&(this._$P={}),this._$P[X$m]=X$p),X$p},X$p.getChildAt=function(X$m){return this._childs[X$m]},X$p.setChildIndex=function(X$m,X$p){var X$h=this._childs;if(X$p<0||X$p>=X$h.length)throw new Error("setChildIndex:The index is out of bounds.");var X$P=this.getChildIndex(X$m);if(X$P<0)throw new Error("setChildIndex:node is must child of this object.");return X$h.splice(X$P,1),X$h.splice(X$p,0,X$m),this.conchModel&&(this.conchModel.removeChild(X$m.conchModel),this.conchModel.addChildAt(X$m.conchModel,X$p)),this._childChanged(),X$m},X$p._childChanged=function(X$m){},X$p.removeChild=function(X$m){if(!this._childs)return X$m;var X$p=this._childs.indexOf(X$m);return this.removeChildAt(X$p)},X$p.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},X$p.removeChildByName=function(X$m){var X$p=this.getChildByName(X$m);return X$p&&this.removeChild(X$p),X$p},X$p.removeChildAt=function(X$m){var X$p=this.getChildAt(X$m);if(X$p){for(var X$h=this._childs.length-1,X$P=X$m;X$P<X$h;++X$P)this._childs[X$P]=this._childs[X$P+1];this._childs.length=X$h,this.conchModel&&this.conchModel.removeChild(X$p.conchModel),X$p.parent=null}return X$p},X$p.removeChildren=function(X$m,X$p){if(void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=2147483647),this._childs&&0<this._childs.length){var X$h=this._childs;if(0===X$m&&X$q<=X$p){var X$P=X$h;this._childs=X$k.ARRAY_EMPTY}else X$P=X$h.splice(X$m,X$p-X$m);for(var X$L=0,X$q=X$P.length;X$L<X$q;X$L++)X$P[X$L].parent=null,this.conchModel&&this.conchModel.removeChild(X$P[X$L].conchModel)}return this},X$p.replaceChild=function(X$m,X$p){var X$h=this._childs.indexOf(X$p);return-1<X$h?(this._childs.splice(X$h,1,X$m),this.conchModel&&(this.conchModel.removeChild(X$p.conchModel),this.conchModel.addChildAt(X$m.conchModel,X$h)),X$p.parent=null,X$m.parent=this,X$m):null},X$p._updateDisplayedInstage=function(){var X$m;X$m=this;var X$p=X$E.stage;for(this._displayedInStage=!1;X$m;){if(X$m._getBit(1)){this._displayedInStage=X$m._displayedInStage;break}if(X$m==X$p||X$m._displayedInStage){this._displayedInStage=!0;break}X$m=X$m.parent}},X$p._setDisplay=function(X$m){this._displayedInStage!==X$m&&((this._displayedInStage=X$m)?this.event("display"):this.event("undisplay"))},X$p._displayChild=function(X$m,X$p){var X$h=X$m._childs;if(X$h)for(var X$P=0;X$P<X$h.length;X$P++){var X$L=X$h[X$P];X$L&&X$L._getBit(1)&&(0<X$L._childs.length?this._displayChild(X$L,X$p):X$L._setDisplay(X$p))}X$m._setDisplay(X$p)},X$p.contains=function(X$m){if(X$m===this)return!0;for(;X$m;){if(X$m.parent===this)return!0;X$m=X$m.parent}return!1},X$p.timerLoop=function(X$m,X$p,X$h,X$P,X$L,X$q){void 0===X$L&&(X$L=!0),void 0===X$q&&(X$q=!1),this.timer.loop(X$m,X$p,X$h,X$P,X$L,X$q)},X$p.timerOnce=function(X$m,X$p,X$h,X$P,X$L){void 0===X$L&&(X$L=!0),this.timer._create(!1,!1,X$m,X$p,X$h,X$P,X$L)},X$p.frameLoop=function(X$m,X$p,X$h,X$P,X$L){void 0===X$L&&(X$L=!0),this.timer._create(!0,!0,X$m,X$p,X$h,X$P,X$L)},X$p.frameOnce=function(X$m,X$p,X$h,X$P,X$L){void 0===X$L&&(X$L=!0),this.timer._create(!0,!1,X$m,X$p,X$h,X$P,X$L)},X$p.clearTimer=function(X$m,X$p){this.timer.clear(X$m,X$p)},X$A(0,X$p,"numChildren",function(){return this._childs.length}),X$A(0,X$p,"destroyed",function(){return this._destroyed}),X$A(0,X$p,"parent",function(){return this._parent},function(X$m){this._parent!==X$m&&(X$m?(this._parent=X$m,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),X$m.displayedInStage&&this._displayChild(this,!0)),X$m._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=X$m))}),X$A(0,X$p,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),X$k.ARRAY_EMPTY=[],X$k.PROP_EMPTY={},X$k.NOTICE_DISPLAY=1,X$k.MOUSEENABLE=2,X$k}(),X$pm=function(X$m){function X$R(X$m){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,X$R.__super.call(this),this._padding=X$R._PADDING,this._spacing=X$R._SPACING,this._aligns=X$R._ALIGNS,this._font=X$$.EMPTY,this._ower=X$m}X$D(X$R,"laya.display.css.CSSStyle",X$m);var X$p=X$R.prototype;return X$p.destroy=function(){this._ower=null,this._font=null,this._rect=null},X$p.inherit=function(X$m){this._font=X$m._font,this._spacing=X$m._spacing===X$R._SPACING?X$R._SPACING:X$m._spacing.slice(),this.lineHeight=X$m.lineHeight},X$p._widthAuto=function(){return 0!=(262144&this._type)},X$p.widthed=function(X$m){return 0!=(8&this._type)},X$p._calculation=function(X$m,X$p){if(X$p.indexOf("%")<0)return!1;var X$P=this._ower,X$L=X$P.parent,X$q=this._rect;function X$k(X$m,X$p,X$h){return X$m*X$h[0]+X$p*X$h[1]+X$h[2]}function X$h(X$m){var X$p=X$L.width,X$h=X$P.width;X$q.width&&(X$P.width=X$k(X$p,X$h,X$q.width)),X$q.height&&(X$P.height=X$k(X$p,X$h,X$q.height)),X$q.left&&(X$P.x=X$k(X$p,X$h,X$q.left)),X$q.top&&(X$P.y=X$k(X$p,X$h,X$q.top))}null===X$q&&(X$L._getCSSStyle()._type|=524288,X$L.on("resize",this,X$h),this._rect=X$q={input:{}});var X$Y=X$p.split(" ");return X$Y[0]=parseFloat(X$Y[0])/100,1==X$Y.length?X$Y[1]=X$Y[2]=0:(X$Y[1]=parseFloat(X$Y[1])/100,X$Y[2]=parseFloat(X$Y[2])),X$q[X$m]=X$Y,X$q.input[X$m]=X$p,X$h(),!0},X$p.heighted=function(X$m){return 0!=(8192&this._type)},X$p.size=function(X$m,X$p){var X$h=this._ower,X$P=!1;-1!==X$m&&X$m!=this._ower.width&&(this._type|=8,this._ower.width=X$m,X$P=!0),-1!==X$p&&X$p!=this._ower.height&&(this._type|=8192,this._ower.height=X$p,X$P=!0),X$P&&(X$h._layoutLater(),524288&this._type&&X$h.event("resize",this))},X$p._getAlign=function(){return this._aligns[0]},X$p._getValign=function(){return this._aligns[1]},X$p._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},X$p._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new X$$(this._font))},X$p.render=function(X$m,X$p,X$h,X$P){var X$L=X$m.width,X$q=X$m.height;X$h-=X$m.pivotX,X$P-=X$m.pivotY,this._bgground&&null!=this._bgground.color&&X$p.ctx.fillRect(X$h,X$P,X$L,X$q,this._bgground.color),this._border&&this._border.color&&X$p.drawRect(X$h,X$P,X$L,X$q,this._border.color.strColor,this._border.size)},X$p.getCSSStyle=function(){return this},X$p.cssText=function(X$m){this.attrs(X$R.parseOneCSS(X$m,";"))},X$p.attrs=function(X$m){if(X$m)for(var X$p=0,X$h=X$m.length;X$p<X$h;X$p++){var X$P=X$m[X$p];this[X$P[0]]=X$P[1]}},X$p.setTransform=function(X$m){"none"===X$m?this._tf=X$Y._TF_EMPTY:this.attrs(X$R.parseOneCSS(X$m,","))},X$p.translate=function(X$m,X$p){this._tf===X$Y._TF_EMPTY&&(this._tf=new X$L),this._tf.translateX=X$m,this._tf.translateY=X$p},X$p.scale=function(X$m,X$p){this._tf===X$Y._TF_EMPTY&&(this._tf=new X$L),this._tf.scaleX=X$m,this._tf.scaleY=X$p},X$p._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},X$A(0,X$p,"block",X$m.prototype._$get_block,function(X$m){X$m?this._type|=1:this._type&=-2}),X$A(0,X$p,"valign",function(){return X$R._valigndef[this._aligns[1]]},function(X$m){this._aligns===X$R._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=X$R._valigndef[X$m]}),X$A(0,X$p,"height",null,function(X$m){if(this._type|=8192,"string"==typeof X$m){if(this._calculation("height",X$m))return;X$m=parseInt(X$m)}this.size(-1,X$m)}),X$A(0,X$p,"width",null,function(X$m){if(this._type|=8,"string"==typeof X$m){var X$p=X$m.indexOf("auto");if(0<=X$p&&(this._type|=262144,X$m=X$m.substr(0,X$p)),this._calculation("width",X$m))return;X$m=parseInt(X$m)}this.size(X$m,-1)}),X$A(0,X$p,"fontWeight",function(){return this._font.weight},function(X$m){this._createFont().weight=X$m}),X$A(0,X$p,"left",null,function(X$m){var X$p=this._ower;if("string"==typeof X$m){if("center"===X$m?X$m="50% -50% 0":"right"===X$m&&(X$m="100% -100% 0"),this._calculation("left",X$m))return;X$m=parseInt(X$m)}X$p.x=X$m}),X$A(0,X$p,"_translate",null,function(X$m){this.translate(X$m[0],X$m[1])}),X$A(0,X$p,"absolute",function(){return 0!=(4&this._type)}),X$A(0,X$p,"top",null,function(X$m){var X$p=this._ower;if("string"==typeof X$m){if("middle"===X$m?X$m="50% -50% 0":"bottom"===X$m&&(X$m="100% -100% 0"),this._calculation("top",X$m))return;X$m=parseInt(X$m)}X$p.y=X$m}),X$A(0,X$p,"align",function(){return X$R._aligndef[this._aligns[0]]},function(X$m){this._aligns===X$R._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=X$R._aligndef[X$m]}),X$A(0,X$p,"bold",function(){return this._font.bold},function(X$m){this._createFont().bold=X$m}),X$A(0,X$p,"padding",function(){return this._padding},function(X$m){this._padding=X$m}),X$A(0,X$p,"leading",function(){return this._spacing[1]},function(X$m){"string"==typeof X$m&&(X$m=parseInt(X$m+"")),this._spacing===X$R._SPACING&&(this._spacing=[0,0]),this._spacing[1]=X$m}),X$A(0,X$p,"lineElement",function(){return 0!=(65536&this._type)},function(X$m){X$m?this._type|=65536:this._type&=-65537}),X$A(0,X$p,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(X$m){this.lineElement=!1,"right"===X$m?this._type|=32768:this._type&=-32769}),X$A(0,X$p,"textDecoration",function(){return this._font.decoration},function(X$m){this._createFont().decoration=X$m}),X$A(0,X$p,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(X$m){"nowrap"===X$m&&(this._type|=131072),"none"===X$m&&(this._type&=-131073)}),X$A(0,X$p,"background",null,function(X$m){X$m?(this._bgground||(this._bgground={}),this._bgground.color=X$m,this._ower.conchModel&&this._ower.conchModel.bgColor(X$m),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),X$A(0,X$p,"wordWrap",function(){return 0==(131072&this._type)},function(X$m){X$m?this._type&=-131073:this._type|=131072}),X$A(0,X$p,"color",function(){return this._font.color},function(X$m){this._createFont().color=X$m}),X$A(0,X$p,"password",function(){return this._font.password},function(X$m){this._createFont().password=X$m}),X$A(0,X$p,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(X$m){"none"===X$m?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=X$m),this._ower.conchModel&&this._ower.conchModel.bgColor(X$m),this._ower._renderType|=256}),X$A(0,X$p,"font",function(){return this._font.toString()},function(X$m){this._createFont().set(X$m)}),X$A(0,X$p,"weight",null,function(X$m){this._createFont().weight=X$m}),X$A(0,X$p,"letterSpacing",function(){return this._spacing[0]},function(X$m){"string"==typeof X$m&&(X$m=parseInt(X$m+"")),this._spacing===X$R._SPACING&&(this._spacing=[0,0]),this._spacing[0]=X$m}),X$A(0,X$p,"fontSize",function(){return this._font.size},function(X$m){this._createFont().size=X$m}),X$A(0,X$p,"italic",function(){return this._font.italic},function(X$m){this._createFont().italic=X$m}),X$A(0,X$p,"fontFamily",function(){return this._font.family},function(X$m){this._createFont().family=X$m}),X$A(0,X$p,"stroke",function(){return this._font.stroke[0]},function(X$m){this._createFont().stroke===X$$._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=X$m}),X$A(0,X$p,"strokeColor",function(){return this._font.stroke[1]},function(X$m){this._createFont().stroke===X$$._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=X$m}),X$A(0,X$p,"border",function(){return this._border?this._border.value:""},function(X$m){if("none"!=X$m){this._border||(this._border={});var X$p=(this._border.value=X$m).split(" ");if(this._border.color=X$U.create(X$p[X$p.length-1]),1==X$p.length)return this._border.size=1,void(this._border.type="solid");var X$h=0;0<X$p[0].indexOf("px")?(this._border.size=parseInt(X$p[0]),X$h++):this._border.size=1,this._border.type=X$p[X$h],this._ower._renderType|=256}else this._border=null}),X$A(0,X$p,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(X$m){X$m?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==X$m?null:X$U.create(X$m),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),X$A(0,X$p,"position",function(){return 4&this._type?"absolute":""},function(X$m){"absolute"==X$m?this._type|=4:this._type&=-5}),X$A(0,X$p,"display",null,function(X$m){switch(X$m){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),X$A(0,X$p,"paddingLeft",function(){return this.padding[3]}),X$A(0,X$p,"paddingTop",function(){return this.padding[0]}),X$A(0,X$p,"_scale",null,function(X$m){this._ower.scale(X$m[0],X$m[1])}),X$A(0,X$p,"_rotate",null,function(X$m){this._ower.rotation=X$m}),X$R.parseOneCSS=function(X$m,X$p){for(var X$h,X$P=[],X$L=X$m.split(X$p),X$q=0,X$k=X$L.length;X$q<X$k;X$q++){var X$Y=X$L[X$q],X$d=X$Y.indexOf(":"),X$K=X$Y.substr(0,X$d).replace(/^\s+|\s+$/g,"");if(0!=X$K.length){var X$D=X$Y.substr(X$d+1).replace(/^\s+|\s+$/g,""),X$F=[X$K,X$D];switch(X$K){case"italic":case"bold":X$F[1]="true"==X$D;break;case"line-height":X$F[0]="lineHeight",X$F[1]=parseInt(X$D);break;case"font-size":X$F[0]="fontSize",X$F[1]=parseInt(X$D);break;case"padding":1<(X$h=X$D.split(" ")).length||(X$h[1]=X$h[2]=X$h[3]=X$h[0]),X$F[1]=[parseInt(X$h[0]),parseInt(X$h[1]),parseInt(X$h[2]),parseInt(X$h[3])];break;case"rotate":X$F[0]="_rotate",X$F[1]=parseFloat(X$D);break;case"scale":X$h=X$D.split(" "),X$F[0]="_scale",X$F[1]=[parseFloat(X$h[0]),parseFloat(X$h[1])];break;case"translate":X$h=X$D.split(" "),X$F[0]="_translate",X$F[1]=[parseInt(X$h[0]),parseInt(X$h[1])];break;default:(X$F[0]=X$R._CSSTOVALUE[X$K])||(X$F[0]=X$K)}X$P.push(X$F)}}return X$P},X$R.parseCSS=function(X$m,X$p){for(var X$h;null!=(X$h=X$R._parseCSSRegExp.exec(X$m));)X$R.styleSheets[X$h[1]]=X$R.parseOneCSS(X$h[2],";")},X$R.EMPTY=new X$R(null),X$R._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},X$R._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),X$R._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},X$R._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},X$R.styleSheets={},X$R.ALIGN_CENTER=1,X$R.ALIGN_RIGHT=2,X$R.VALIGN_MIDDLE=1,X$R.VALIGN_BOTTOM=2,X$R._CSS_BLOCK=1,X$R._DISPLAY_NONE=2,X$R._ABSOLUTE=4,X$R._WIDTH_SET=8,X$R._PADDING=[0,0,0,0],X$R._RECT=[-1,-1,-1,-1],X$R._SPACING=[0,0],X$R._ALIGNS=[0,0,0],X$R.ADDLAYOUTED=512,X$R._NEWFONT=4096,X$R._HEIGHT_SET=8192,X$R._BACKGROUND_SET=16384,X$R._FLOAT_RIGHT=32768,X$R._LINE_ELEMENT=65536,X$R._NOWARP=131072,X$R._WIDTHAUTO=262144,X$R._LISTERRESZIE=524288,X$R}(X$Y),X$hm=function(X$m){function X$k(){this.url=null,this.audio=null,this.loaded=!1,X$k.__super.call(this)}X$D(X$k,"laya.media.h5audio.AudioSound",X$K);var X$p=X$k.prototype;return X$p.dispose=function(){var X$m=X$k._audioCache[this.url];X$m&&(X$m.src="",delete X$k._audioCache[this.url])},X$p.load=function(X$m){var X$p;if(X$m=X$N.formatURL(X$m),(this.url=X$m)==X$x._tMusic?(X$k._initMusicAudio(),(X$p=X$k._musicAudio).src!=X$m&&(X$k._audioCache[X$p.src]=null,X$p=null)):X$p=X$k._audioCache[X$m],X$p&&2<=X$p.readyState)this.event("complete");else{X$p||(X$p=X$m==X$x._tMusic?(X$k._initMusicAudio(),X$k._musicAudio):X$w.createElement("audio"),(X$k._audioCache[X$m]=X$p).src=X$m),X$p.addEventListener("canplaythrough",X$P),X$p.addEventListener("error",X$L);var X$h=this;(this.audio=X$p).load?X$p.load():X$L()}function X$P(){X$q(),X$h.loaded=!0,X$h.event("complete")}function X$L(){X$p.load=null,X$q(),X$h.event("error")}function X$q(){X$p.removeEventListener("canplaythrough",X$P),X$p.removeEventListener("error",X$L)}},X$p.play=function(X$m,X$p,X$h){if(void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),!this.url)return null;var X$P,X$L;if(!(X$P=this.url==X$x._tMusic?X$k._musicAudio:X$k._audioCache[this.url]))return null;X$L=X$o.getItem("audio:"+this.url),X$S.isConchApp?X$L||((X$L=X$w.createElement("audio")).src=this.url):this.url==X$x._tMusic?(X$k._initMusicAudio(),(X$L=X$k._musicAudio).src=this.url):X$L=X$L||X$P.cloneNode(!0);var X$q=new X$Rm(X$L);return X$q.url=this.url,X$q.loops=X$p,X$q.startTime=X$m,X$q.startHandler=X$h,X$q.play(!1),X$x.addChannel(X$q),X$q},X$A(0,X$p,"duration",function(){var X$m;return(X$m=X$k._audioCache[this.url])?X$m.duration:0}),X$k._initMusicAudio=function(){X$k._musicAudio||(X$k._musicAudio||(X$k._musicAudio=X$w.createElement("audio")),X$S.isConchApp||X$w.document.addEventListener("mousedown",X$k._makeMusicOK))},X$k._makeMusicOK=function(){X$w.document.removeEventListener("mousedown",X$k._makeMusicOK),X$k._musicAudio.src?X$k._musicAudio.play():(X$k._musicAudio.src="",X$k._musicAudio.load())},X$k._audioCache={},X$k._musicAudio=null,X$k}(),X$Pm=function(X$m){function X$p(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,X$p.__super.call(this)}X$D(X$p,"laya.media.SoundChannel",X$K);var X$h=X$p.prototype;return X$h.play=function(){},X$h.stop=function(){},X$h.pause=function(){},X$h.resume=function(){},X$h.__runComplete=function(X$m){X$m&&X$m.run()},X$A(0,X$h,"volume",function(){return 1},function(X$m){}),X$A(0,X$h,"position",function(){return 0}),X$A(0,X$h,"duration",function(){return 0}),X$p}(),X$Lm=function(X$m){function X$p(){X$p.__super.call(this)}X$D(X$p,"laya.media.Sound",X$K);var X$h=X$p.prototype;return X$h.load=function(X$m){},X$h.play=function(X$m,X$p,X$h){return void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),null},X$h.dispose=function(){},X$A(0,X$h,"duration",function(){return 0}),X$p}(),X$qm=function(X$m){function X$L(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,X$L.__super.call(this)}X$D(X$L,"laya.media.webaudio.WebAudioSound",X$K);var X$p=X$L.prototype;return X$p.load=function(X$m){this.url=X$m,this.audioBuffer=X$L._dataCache[X$m],this.audioBuffer?this._loaded(this.audioBuffer):(X$L.e.on("loaded:"+X$m,this,this._loaded),X$L.e.on("err:"+X$m,this,this._err),X$L.__loadingSound[X$m]||(X$L.__loadingSound[X$m]=!0,X$E.loader.load(X$m,X$e.create(this,this.onloaded),null,X$Ym.BUFFER,4,!1,null,!0)))},X$p.onloaded=function(X$m){X$m||this._err(),this._disposed?this._removeLoadEvents():(this.data=X$m,X$L.buffs.push({buffer:this.data,url:this.url}),X$L.decode())},X$p._err=function(){if(this._removeLoadEvents(),X$L.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var X$m,X$p,X$h,X$P=0;for(X$m=(X$p=this.__toPlays).length,X$P=0;X$P<X$m;X$P++)(X$h=X$p[X$P])[3]&&!X$h[3].isStopped&&X$h[3].event("error");this.__toPlays.length=0}},X$p._loaded=function(X$m){this._removeLoadEvents(),this._disposed||(this.audioBuffer=X$m,this.loaded=!0,this.event("complete"))},X$p._removeLoadEvents=function(){X$L.e.off("loaded:"+this.url,this,this._loaded),X$L.e.off("err:"+this.url,this,this._err)},X$p.__playAfterLoaded=function(){if(this.__toPlays){var X$m,X$p,X$h,X$P=0;for(X$m=(X$p=this.__toPlays).length,X$P=0;X$P<X$m;X$P++)(X$h=X$p[X$P])[3]&&!X$h[3].isStopped&&this.play(X$h[0],X$h[1],X$h[2],X$h[3]);this.__toPlays.length=0}},X$p.play=function(X$m,X$p,X$h,X$P){return void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),X$P=X$P||new X$$m,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([X$m,X$p,X$h,X$P]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),X$P.url=this.url,X$P.loops=X$p,X$P.audioBuffer=this.audioBuffer,X$P.startTime=X$m,X$P.startHandler=X$h,X$P.play(!1),X$x.addChannel(X$P),X$P},X$p.dispose=function(){this._disposed=!0,delete X$L._dataCache[this.url],delete X$L.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},X$A(0,X$p,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),X$L.decode=function(){if(!(X$L.buffs.length<=0||X$L.isDecoding))if(X$L.isDecoding=!0,(X$L.tInfo=X$L.buffs.shift())&&X$L.tInfo.buffer&&X$L.tInfo.buffer.byteLength)try{X$L.ctx.decodeAudioData(X$L.tInfo.buffer,X$L._done,X$L._fail)}catch(X$m){console.error("decodeAudioData error  byteLength:"+X$L.tInfo.buffer.byteLength+"  url:"+X$L.tInfo.url)}else X$L._fail()},X$L._done=function(X$m){X$L.e.event("loaded:"+X$L.tInfo.url,X$m),X$L._dataCache[X$L.tInfo.url]=X$m,X$L.isDecoding=!1,X$L.decode()},X$L._fail=function(){X$L.e.event("err:"+X$L.tInfo.url,null),X$L.isDecoding=!1,X$L.decode()},X$L._playEmptySound=function(){if(null!=X$L.ctx){if(X$L._emptySource&&(X$L._emptySource.stop(),X$L._emptySource.disconnect(0),!X$$m._tryCleanFailed))try{X$L._emptySource.buffer=null}catch(X$m){X$$m._tryCleanFailed=!0}var X$m=X$L.ctx.createBufferSource();X$m.buffer=X$L._miniBuffer,X$m.connect(X$L.ctx.destination),X$m.start(0,0,0),X$L._emptySource=X$m}},X$L._unlock=function(){X$L._unlocked||(X$L._playEmptySound(),"running"==X$L.ctx.state?(X$w.document.removeEventListener("mousedown",X$L._unlock,!0),X$w.document.removeEventListener("touchend",X$L._unlock,!0),X$w.document.removeEventListener("touchstart",X$L._unlock,!0),X$L._unlocked=!0):"suspended"==X$L.ctx.state&&X$x._recoverWebAudio())},X$L.initWebAudio=function(){"running"!=X$L.ctx.state&&(X$L._unlock(),X$w.document.addEventListener("mousedown",X$L._unlock,!0),X$w.document.addEventListener("touchend",X$L._unlock,!0),X$w.document.addEventListener("touchstart",X$L._unlock,!0))},X$L._emptySource=null,X$L._dataCache={},X$L.buffs=[],X$L.isDecoding=!1,X$L._unlocked=!1,X$L.tInfo=null,X$L.__loadingSound={},X$d(X$L,["window",function(){return this.window=X$w.window},"webAudioEnabled",function(){return this.webAudioEnabled=X$L.window.AudioContext||X$L.window.webkitAudioContext||X$L.window.mozAudioContext},"ctx",function(){return this.ctx=X$L.webAudioEnabled?new(X$L.window.AudioContext||X$L.window.webkitAudioContext||X$L.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=X$L.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new X$K}]),X$L}(),X$km=function(X$m){function X$p(){this._responseType=null,this._data=null,X$p.__super.call(this),this._http=new X$w.window.XMLHttpRequest}X$D(X$p,"laya.net.HttpRequest",X$K);var X$h=X$p.prototype;return X$h.send=function(X$m,X$p,X$h,X$P,X$L){void 0===X$h&&(X$h="get"),void 0===X$P&&(X$P="text"),this._responseType=X$P,this._data=null;var X$q=this,X$k=this._http;if(X$k.open(X$h,X$m,!0),X$L)for(var X$Y=0;X$Y<X$L.length;X$Y++)X$k.setRequestHeader(X$L[X$Y++],X$L[X$Y]);else X$S.isConchApp||(X$p&&"string"!=typeof X$p?X$k.setRequestHeader("Content-Type","application/json"):X$k.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));X$k.responseType="arraybuffer"!==X$P?"text":"arraybuffer",X$k.onerror=function(X$m){X$q._onError(X$m)},X$k.onabort=function(X$m){X$q._onAbort(X$m)},X$k.onprogress=function(X$m){X$q._onProgress(X$m)},X$k.onload=function(X$m){X$q._onLoad(X$m)},X$k.send(X$p)},X$h._onProgress=function(X$m){X$m&&X$m.lengthComputable&&this.event("progress",X$m.loaded/X$m.total)},X$h._onAbort=function(X$m){this.error("Request was aborted by user")},X$h._onError=function(X$m){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},X$h._onLoad=function(X$m){var X$p=this._http,X$h=void 0!==X$p.status?X$p.status:200;200===X$h||204===X$h||0===X$h?this.complete():this.error("["+X$p.status+"]"+X$p.statusText+":"+X$p.responseURL)},X$h.error=function(X$m){this.clear(),this.event("error",X$m)},X$h.complete=function(){this.clear();var X$p=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=X$g.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(X$m){X$p=!1,this.error(X$m.message)}X$p&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},X$h.clear=function(){var X$m=this._http;X$m.onerror=X$m.onabort=X$m.onprogress=X$m.onload=null},X$A(0,X$h,"url",function(){return this._http.responseURL}),X$A(0,X$h,"http",function(){return this._http}),X$A(0,X$h,"data",function(){return this._data}),X$p}(),X$Ym=function(X$m){function X$T(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,X$T.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}X$D(X$T,"laya.net.Loader",X$K);var X$p=X$T.prototype;return X$p.load=function(X$m,X$p,X$h,X$P,X$L){if(X$m&&""!=X$m||console.error("Loader 加载的url不合法 "+X$m),void 0===X$h&&(X$h=!0),void 0===X$L&&(X$L=!1),0===(this._url=X$m).indexOf("data:image")?this._type=X$p="image":this._type=X$p||(X$p=this.getTypeFromUrl(X$m)),this._cache=X$h,this._data=null,!X$L&&X$T.loadedMap[X$m])return this._data=X$T.loadedMap[X$m],this.event("progress",1),void this.event("complete",this._data);if(X$P&&X$T.setGroup(X$m,X$P),null!=X$T.parserMap[X$p])return this._customParse=!0,void(X$T.parserMap[X$p]instanceof laya.utils.Handler?X$T.parserMap[X$p].runWith(this):X$T.parserMap[X$p].call(null,this));if("image"===X$p||"htmlimage"===X$p||"nativeimage"===X$p)return this._loadImage(X$m);if("ttf"===X$p)return this._loadTTF(X$m);switch(X$p){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:X$p}X$T.preLoadedMap[X$m]?this.onLoaded(X$T.preLoadedMap[X$m]):X$k.resMgrLoad(X$m,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},X$p.getTypeFromUrl=function(X$m){var X$p=X$g.getFileExtension(X$m);return X$p?X$T.typeMap[X$p]:(console.warn("Not recognize the resources suffix",X$m),"text")},X$p._loadTTF=function(X$m){X$m=X$N.formatURL(X$m);var X$p=new X$u;X$p.complete=X$e.create(this,this.onLoaded),X$p.load(X$m)},X$p._loadImage=function(X$m){X$k.imgMgrLoad(X$m,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},X$p._loadImageComplete=function(X$m,X$p,X$h){if(null!=X$h)if(X$h instanceof ArrayBuffer){var X$P=new DataView(X$h),X$L=new laya.webgl.resource.WebGLImage(new Uint8Array(X$h,8),X$m,0,!1,X$P.getUint32(0),X$P.getUint32(4));this.onLoaded(X$L)}else if(X$h instanceof X$Dm)X$T.imgMgrSet[X$m]=X$p,X$k.imgMgrLock(X$m,X$T.imgMgrSet[X$m]),this._url=X$m,this.complete(X$h);else{var X$q=-1!=X$m.indexOf(".png",X$m.length-4)?6408:6407;X$L=new laya.webgl.resource.WebGLImage(X$h,X$m,X$q,!1,X$h.width,X$h.height);this.onLoaded(X$L)}else this.event("error","Load image failed")},X$p.imageCancel=function(X$m,X$p,X$h){X$k.imgMgrCancel(X$m,this._onImageCallback)},X$p._loadSound=function(X$m){var X$p=new X$x._soundClass,X$h=this;function X$P(){X$p.offAll()}X$p.on("complete",this,function(){X$P(),X$h.onLoaded(X$p)}),X$p.on("error",this,function(){X$P(),X$p.dispose(),X$h.event("error","Load sound failed")}),X$p.load(X$m)},X$p.onProgress=function(X$m){"atlas"===this._type?this.event("progress",.3*X$m):this.event("progress",X$m)},X$p.onError=function(X$m){this.event("error",X$m)},X$p._loadedComplete=function(X$m,X$p,X$h){if(null!=X$h)switch(this._type){case"atlas":case"plf":case"json":var X$P=new X$X(X$h);this.onLoaded(JSON.parse(X$P.readUTFBytes()));break;case"font":X$P=new X$X(X$h);this.onLoaded(X$g.parseXMLFromString(X$P.readUTFBytes()));break;default:this.onLoaded(X$h)}else this.event("error",X$m)},X$p.onLoaded=function(X$m){var X$p=this._type;if("plf"==X$p)this.parsePLFData(X$m),this.complete(X$m);else if("image"===X$p){var X$h=new X$Dm(X$m);X$h.url=this._url,this.complete(X$h)}else if("sound"===X$p||"htmlimage"===X$p||"nativeimage"===X$p)this.complete(X$m);else if("atlas"===X$p){if(!X$m.src&&!X$m._setContext){if(!this._data){if((this._data=X$m).meta&&X$m.meta.image)for(var X$P=X$m.meta.image.split(","),X$L=0<=this._url.indexOf("/")?"/":"\\",X$q=this._url.lastIndexOf(X$L),X$k=0<=X$q?this._url.substr(0,X$q+1):"",X$Y=0,X$d=X$P.length;X$Y<X$d;X$Y++)X$P[X$Y]=X$k+X$P[X$Y];else X$P=[this._url.replace(".json",".png")];X$P.reverse(),X$m.toLoads=X$P,X$m.pics=[]}return this.event("progress",.3+1/X$P.length*.6),this._loadImage(X$P.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(X$m),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var X$K=this._data.frames,X$D=this._url.split("?")[0],X$F=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:X$D.substring(0,X$D.lastIndexOf("."))+"/",X$R=this._data.pics,X$$=X$N.formatURL(this._url),X$A=X$T.atlasMap[X$$]||(X$T.atlasMap[X$$]=[]);X$A.dir=X$F;var X$B=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var X$n in X$B=parseFloat(this._data.meta.scale),X$K){var X$c,X$e=X$K[X$n],X$a=X$R[X$e.frame.idx?X$e.frame.idx:0],X$Z=X$N.formatURL(X$F+X$n);X$a.scaleRate=X$B,X$c=X$Dm.create(X$a,X$e.frame.x,X$e.frame.y,X$e.frame.w,X$e.frame.h,X$e.spriteSourceSize.x,X$e.spriteSourceSize.y,X$e.sourceSize.w,X$e.sourceSize.h),X$T.cacheRes(X$Z,X$c),X$T.keepCache(this._url,X$F+X$n),X$c.url=X$Z,X$A.push(X$Z)}else for(X$n in X$K)X$a=X$R[(X$e=X$K[X$n]).frame.idx?X$e.frame.idx:0],X$Z=X$N.formatURL(X$F+X$n),X$T.cacheRes(X$Z,X$Dm.create(X$a,X$e.frame.x,X$e.frame.y,X$e.frame.w,X$e.frame.h,X$e.spriteSourceSize.x,X$e.spriteSourceSize.y,X$e.sourceSize.w,X$e.sourceSize.h)),X$T.loadedMap[X$Z].url=X$Z,X$T.keepCache(this._url,X$F+X$n),X$A.push(X$Z);delete this._data.pics,this.complete(this._data)}else if("font"==X$p){if(!X$m.src)return this._data=X$m,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var X$H=new X$j;X$H.parseFont(this._data,X$m);var X$W=this._url.split(".fnt")[0].split("/"),X$E=X$W[X$W.length-1];X$nm.registerBitmapFont(X$E,X$H),this._data=X$H,this.complete(this._data)}else if("pkm"==X$p){var X$I=X$Wm.create(X$m,this._url),X$b=new X$Dm(X$I);X$b.url=this._url,this.complete(X$b)}else this.complete(X$m)},X$p.parsePLFData=function(X$m){var X$p,X$h,X$P;for(X$p in X$m)switch(X$P=X$m[X$p],X$p){case"json":case"text":for(X$h in X$P)X$T.preLoadedMap[X$N.formatURL(X$h)]=X$P[X$h];break;default:for(X$h in X$P)X$T.preLoadedMap[X$N.formatURL(X$h)]=X$P[X$h]}},X$p.complete=function(X$m){this._data=X$m,this._customParse?this.event("loaded",X$m instanceof Array?[X$m]:X$m):(X$T._loaders.push(this),X$T._isWorking||X$T.checkNext())},X$p.endLoad=function(X$m){X$m&&(this._data=X$m),this._cache&&X$T.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},X$A(0,X$p,"url",function(){return this._url}),X$A(0,X$p,"data",function(){return this._data}),X$A(0,X$p,"cache",function(){return this._cache}),X$A(0,X$p,"type",function(){return this._type}),X$T.checkNext=function(){X$T._isWorking=!0;for(var X$m=X$w.now();X$T._startIndex<X$T._loaders.length;)if(X$w.now(),X$T._loaders[X$T._startIndex].endLoad(),X$T._startIndex++,X$w.now()-X$m>X$T.maxTimeOut)return console.warn("loader callback cost a long time:"+(X$w.now()-X$m)+" url="+X$T._loaders[X$T._startIndex-1].url),void X$E.timer.frameOnce(1,null,X$T.checkNext);X$T._loaders.length=0,X$T._startIndex=0,X$T._isWorking=!1},X$T.clearRes=function(X$m,X$p){if(null!=X$m){void 0===X$p&&(X$p=!1),X$m=X$N.formatURL(X$m);var X$h=X$T.getAtlas(X$m);if(X$h){for(var X$P=0,X$L=X$h.length;X$P<X$L;X$P++){var X$q=X$h[X$P],X$k=X$T.getRes(X$q);delete X$T.loadedMap[X$q],X$T.clearCache(X$m.substring(X$N.basePath.length),X$q.substring(X$N.basePath.length)),X$k&&X$k.destroy(X$p)}X$h.length=0,delete X$T.atlasMap[X$m],delete X$T.loadedMap[X$m]}else{var X$Y=X$T.loadedMap[X$m];X$Y&&(delete X$T.loadedMap[X$m],X$Y instanceof laya.resource.Texture&&X$Y.bitmap&&X$Y.destroy(X$p))}}},X$T.clearTextureRes=function(X$m){X$m=X$N.formatURL(X$m);var X$p=laya.net.Loader.getAtlas(X$m),X$h=X$p&&0<X$p.length?laya.net.Loader.getRes(X$p[0]):laya.net.Loader.getRes(X$m);X$h&&X$h.bitmap&&(X$S.isConchApp&&!X$S.isConchWebGL?X$h.bitmap.source.releaseTexture&&X$h.bitmap.source.releaseTexture():null==X$h.bitmap._atlaser&&X$h.bitmap.releaseResource(!0))},X$T.getRes=function(X$m){return X$T.loadedMap[X$N.formatURL(X$m)]},X$T.getAtlas=function(X$m){return X$T.atlasMap[X$N.formatURL(X$m)]},X$T.cacheRes=function(X$m,X$p){X$m=X$N.formatURL(X$m),null!=X$T.loadedMap[X$m]?console.warn("Resources already exist,is repeated loading:",X$m):X$T.loadedMap[X$m]=X$p},X$T.setGroup=function(X$m,X$p){X$T.groupMap[X$p]||(X$T.groupMap[X$p]=[]),X$T.groupMap[X$p].push(X$m)},X$T.clearResByGroup=function(X$m){if(X$T.groupMap[X$m]){var X$p=X$T.groupMap[X$m],X$h=0,X$P=X$p.length;for(X$h=0;X$h<X$P;X$h++)X$T.clearRes(X$p[X$h]);X$p.length=0}},X$T.keepCache=function(X$m,X$p){if(X$m&&X$p){var X$h=X$T.cacheSet[X$p];X$h?-1==X$h.indexOf(X$m)&&X$h.push(X$m):X$T.cacheSet[X$p]=[X$m]}},X$T.clearCache=function(X$m,X$p){if(X$m&&X$p){var X$h=X$T.cacheSet[X$p];if(X$h){var X$P=X$h.indexOf(X$m);if(-1!==X$P){var X$L=X$h.length-1;0==X$L?(delete X$T.cacheSet[X$p],0<X$T.imgMgrSet[X$p]?X$k.imgMgrFree(X$p,X$T.imgMgrSet[X$p]):X$T.clearRes(X$p,!0)):(X$h[X$P]=X$h[X$L],X$h.length=X$L)}}}},X$T.saveObject=function(X$m,X$p,X$h){if(X$p&&X$m){var X$P=X$T.objectSet[X$m];X$P?(console.warn("Loader.saveObject: "+X$m),X$P[0]=X$p,X$P[1]=X$h):X$T.objectSet[X$m]=[X$p,X$h,[]]}},X$T.findObject=function(X$m){if(X$m){var X$p=X$T.objectSet[X$m];if(X$p)return X$p[0]}return null},X$T.keepObject=function(X$m,X$p){if(X$m&&X$p){var X$h=X$T.objectSet[X$p];X$h&&-1===X$h[2].indexOf(X$m)&&X$h[2].push(X$m)}},X$T.clearObject=function(X$m,X$p){if(X$m&&X$p){var X$h=X$T.objectSet[X$p];if(X$h){var X$P=X$h[2],X$L=X$P.indexOf(X$m);if(-1!==X$L){var X$q=X$P.length-1;0==X$q?(delete X$T.objectSet[X$p],X$h[1]&&X$h[1].call(null,X$h[0])):(X$P[X$L]=X$P[X$q],X$P.length=X$q)}}}},X$T.TEXT="text",X$T.JSON="json",X$T.XML="xml",X$T.BUFFER="arraybuffer",X$T.IMAGE="image",X$T.SOUND="sound",X$T.ATLAS="atlas",X$T.FONT="font",X$T.TTF="ttf",X$T.PLF="plf",X$T.PKM="pkm",X$T.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},X$T.parserMap={},X$T.groupMap={},X$T.maxTimeOut=100,X$T.loadedMap={},X$T.preLoadedMap={},X$T.atlasMap={},X$T._loaders=[],X$T._isWorking=!1,X$T._startIndex=0,X$T.imgCache={},X$T.cacheSet={},X$T.objectSet={},X$T.imgMgrSet={},X$T}(),X$dm=function(X$m){var X$R;function X$$(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},X$$.__super.call(this);for(var X$m=0;X$m<this._maxPriority;X$m++)this._resInfos[X$m]=[]}X$D(X$$,"laya.net.LoaderManager",X$K);var X$p=X$$.prototype;return X$p.create=function(X$m,X$h,X$p,X$P,X$L,X$q,X$k,X$Y){if(null==X$q&&(X$q=2),null==X$k&&(X$k=!0),X$m instanceof Array){var X$d=X$m,X$K=X$d.length,X$D=0;if(X$p)var X$F=X$e.create(X$p.caller,X$p.method,X$p.args,!1);for(var X$R=0;X$R<X$K;X$R++){var X$$=X$d[X$R];"string"==typeof X$$&&(X$$=X$d[X$R]={url:X$$}),X$$.progress=0}for(X$R=0;X$R<X$K;X$R++){X$$=X$d[X$R];var X$A=X$p?X$e.create(null,X$c,[X$$],!1):null,X$B=X$p||X$h?X$e.create(null,X$n,[X$$]):null;this._create(X$$.url,X$B,X$A,X$$.clas||X$P,X$$.params||X$L,null!=X$$.priority&&0<=X$$.priority?X$$.priority:X$q,X$k,X$$.group||X$Y)}function X$n(X$m,X$p){X$D++,X$m.progress=1,X$D===X$K&&X$h&&X$h.run()}function X$c(X$m,X$p){X$m.progress=X$p;for(var X$h=0,X$P=0;X$P<X$K;X$P++){X$h+=X$d[X$P].progress}var X$L=X$h/X$K;X$F.runWith(X$L)}return!0}return this._create(X$m,X$h,X$p,X$P,X$L,X$q,X$k,X$Y)},X$p._create=function(X$p,X$h,X$m,X$P,X$L,X$q,X$k,X$Y){X$p&&""!=X$p||console.error("加载的url不合法 "+X$p),null==X$q&&(X$q=2),null==X$k&&(X$k=!0);var X$d=X$N.formatURL(X$p),X$K=this.getRes(X$d);if(X$K)!X$K.hasOwnProperty("loaded")||X$K.loaded?(X$m&&X$m.runWith(1),X$h&&X$h.run()):X$h&&X$E.loader._createListener(X$p,X$h.caller,X$h.method,X$h.args,!0,!1);else{var X$D=X$g.getFileExtension(X$p),X$F=X$$.createMap[X$D];if(!X$F)throw new Error("LoaderManager:unknown file("+X$p+") extension with: "+X$D+".");X$P||(X$P=X$F[0]);var X$R=X$F[1];if("atlas"==X$D)this.load(X$p,X$h,X$m,X$R,X$q,X$k);else{X$P===X$Dm&&(X$R="htmlimage"),(X$K=X$P?new X$P:null).hasOwnProperty("_loaded")&&(X$K._loaded=!1),X$K._setUrl(X$p),X$Y&&X$K._setGroup(X$Y),this._createLoad(X$K,X$p,X$e.create(null,function(X$m){X$K&&!X$K.destroyed&&X$m&&X$K.onAsynLoaded.call(X$K,X$p,X$m,X$L),X$h&&X$h.run();X$E.loader.event(X$p)}),X$m,X$R,X$q,!1,X$Y,!0),X$k&&this.cacheRes(X$d,X$K)}}return X$K},X$p.load=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){X$m&&""!=X$m||console.error("加载的url不合法 "+X$m);var X$d=this;if(null==X$L&&(X$L=2),null==X$q&&(X$q=!0),void 0===X$Y&&(X$Y=!1),X$m instanceof Array)return this._loadAssets(X$m,X$p,X$h,X$P,X$L,X$q,X$k);var X$K=X$Ym.getRes(X$m);if(null!=X$K)X$E.timer.frameOnce(1,null,function(){X$h&&X$h.runWith(1),X$p&&X$p.runWith(X$K),X$d._loaderCount||X$d.event("complete")});else{var X$D=X$$._resMap[X$m];X$D?(X$p&&X$D._createListener("complete",X$p.caller,X$p.method,X$p.args,!1,!1),X$h&&X$D._createListener("progress",X$h.caller,X$h.method,X$h.args,!1,!1)):((X$D=this._infoPool.length?this._infoPool.pop():new X$R).url=X$m,X$D.clas=null,X$D.type=X$P,X$D.cache=X$q,X$D.group=X$k,X$D.ignoreCache=X$Y,X$D.priority=X$L,X$p&&X$D.on("complete",X$p.caller,X$p.method,X$p.args),X$h&&X$D.on("progress",X$h.caller,X$h.method,X$h.args),X$$._resMap[X$m]=X$D,X$L=X$L<this._maxPriority?0<=X$L?X$L:0:this._maxPriority-1,this._resInfos[X$L].push(X$D),this._next())}return this},X$p.cancel=function(X$m,X$p,X$h){if(X$K=X$$._resMap[X$m]){X$p&&X$K.off("complete",X$p.caller,X$p.method,!1),X$h&&X$K.off("progress",X$h.caller,X$h.method,!1);var X$P=X$K.getListener("complete"),X$L=X$K.getListener("progress");if(!(X$P&&X$P.head||X$L&&X$L.head)){if(X$K.loader){var X$q=X$K.loader;X$q.imageCancel(X$m),X$q.offAll(),X$q._data=null,X$q._customParse=!1,X$q._url=null,X$q._class=null,X$q._type=null,this._loaders.push(X$q),this._loaderCount--,delete this._loaderMap[X$K.url]}for(var X$k=0;X$k<this._maxPriority;X$k++)for(var X$Y=this._resInfos[X$k],X$d=X$Y.length-1;-1<X$d;X$d--){var X$K;(X$K=X$Y[X$d])&&X$K.url===X$m&&(X$Y[X$d]=null,X$K.destroy(),X$K.offAll(),this._infoPool.push(X$K))}delete X$$._resMap[X$m],this._next()}}},X$p._createLoad=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){var X$K=this;if(null==X$q&&(X$q=2),null==X$k&&(X$k=!0),void 0===X$d&&(X$d=!1),X$p instanceof Array)return this._loadAssets(X$p,X$h,X$P,X$L,X$q,X$k,X$Y);var X$D=X$Ym.getRes(X$p);if(null!=X$D)X$E.timer.frameOnce(1,null,function(){X$P&&X$P.runWith(1),X$h&&X$h.runWith(X$D),X$K._loaderCount||X$K.event("complete")});else{var X$F=X$$._resMap[X$p];X$F?(X$h&&X$F._createListener("complete",X$h.caller,X$h.method,X$h.args,!1,!1),X$P&&X$F._createListener("progress",X$P.caller,X$P.method,X$P.args,!1,!1)):((X$F=this._infoPool.length?this._infoPool.pop():new X$R).url=X$p,X$F.clas=X$m,X$F.type=X$L,X$F.cache=X$k,X$F.group=X$Y,X$F.ignoreCache=X$d,X$F.priority=X$q,X$h&&X$F.on("complete",X$h.caller,X$h.method,X$h.args),X$P&&X$F.on("progress",X$P.caller,X$P.method,X$P.args),X$$._resMap[X$p]=X$F,X$q=X$q<this._maxPriority?0<=X$q?X$q:0:this._maxPriority-1,this._resInfos[X$q].push(X$F),this._next())}return this},X$p._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var X$m=0;X$m<this._maxPriority;X$m++)for(var X$p=this._resInfos[X$m];0<X$p.length;){var X$h=X$p.shift();if(X$h)return this._doLoad(X$h)}this._loaderCount||this.event("complete")}},X$p._doLoad=function(X$p){var X$h=this._loaders.length?this._loaders.pop():new X$Ym;this._loaderCount++,(this._loaderMap[X$p.url]=X$h).on("complete",null,X$L),X$h.on("progress",null,function(X$m){X$p.event("progress",X$m)}),X$h.on("error",null,function(X$m){X$L(null)}),X$p.loader=X$h;var X$P=this;function X$L(X$m){X$h.offAll(),X$h._data=null,X$h._customParse=!1,X$h._url=null,X$h._class=null,X$h._type=null,X$P._loaders.push(X$h),X$P._loaderCount--,delete X$P._loaderMap[X$p.url],X$P._endLoad(X$p,X$m instanceof Array?[X$m]:X$m),X$P._next()}X$h._class=X$p.clas,1<=X$p.priority?(X$h.priority=X$p.priority,X$h.realTime=!1):(X$h.priority=0,X$h.realTime=!0),X$h.load(X$p.url,X$p.type,X$p.cache,X$p.group,X$p.ignoreCache)},X$p._endLoad=function(X$m,X$p){var X$h=X$m.url;if(null==X$p){var X$P=this._failRes[X$h]||0;if(X$P<this.retryNum)return console.warn("[warn]Retry to load:",X$h),this._failRes[X$h]=X$P+1,void X$E.timer.once(this.retryDelay,this,this._addReTry,[X$m],!1);console.warn("[error]Failed to load:",X$h),this.event("error",X$h)}this._failRes[X$h]&&(this._failRes[X$h]=0),delete X$$._resMap[X$h],X$m.event("complete",X$p),X$m.destroy(),X$m.offAll(),this._infoPool.push(X$m)},X$p._addReTry=function(X$m){this._resInfos[this._maxPriority-1].push(X$m),this._next()},X$p.clearRes=function(X$m,X$p){void 0===X$p&&(X$p=!1),X$Ym.clearRes(X$m,X$p)},X$p.getRes=function(X$m){return X$Ym.getRes(X$m)},X$p.cacheRes=function(X$m,X$p){X$Ym.cacheRes(X$m,X$p)},X$p.clearTextureRes=function(X$m){X$Ym.clearTextureRes(X$m)},X$p.setGroup=function(X$m,X$p){X$Ym.setGroup(X$m,X$p)},X$p.clearResByGroup=function(X$m){X$Ym.clearResByGroup(X$m)},X$p.clearUnLoaded=function(){for(var X$m=0;X$m<this._maxPriority;X$m++){for(var X$p=this._resInfos[X$m],X$h=X$p.length-1;-1<X$h;X$h--){var X$P=X$p[X$h];X$P&&(X$P.destroy(),X$P.offAll(),this._infoPool.push(X$P))}X$p.length=0}this._loaderCount=0,X$$._resMap={}},X$p.cancelLoadByUrls=function(X$m){if(X$m)for(var X$p=0,X$h=X$m.length;X$p<X$h;X$p++)this.cancelLoadByUrl(X$m[X$p])},X$p.cancelLoadByUrl=function(X$m){for(var X$p=0;X$p<this._maxPriority;X$p++)for(var X$h=this._resInfos[X$p],X$P=X$h.length-1;-1<X$P;X$P--){var X$L=X$h[X$P];X$L&&X$L.url===X$m&&(X$h[X$P]=null,X$L.destroy(),X$L.offAll(),this._infoPool.push(X$L))}X$$._resMap[X$m]&&delete X$$._resMap[X$m]},X$p._loadAssets=function(X$m,X$h,X$k,X$p,X$P,X$L,X$q){null==X$P&&(X$P=2),null==X$L&&(X$L=!0);for(var X$Y=X$m.length,X$d=0,X$K=0,X$D=[],X$F=!0,X$R=0;X$R<X$Y;X$R++){var X$$=X$m[X$R];if(!X$$)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+X$m);"string"==typeof X$$&&(X$$={url:X$$,type:X$p,size:1,priority:X$P}),X$$.size||(X$$.size=1),X$$.progress=0,X$K+=X$$.size,X$D.push(X$$);var X$A=X$k?X$e.create(null,X$c,[X$$],!1):null,X$B=X$h||X$k?X$e.create(null,X$n,[X$$]):null;this.load(X$$.url,X$B,X$A,X$$.type,null!=X$$.priority&&0<=X$$.priority?X$$.priority:2,X$L,X$$.group||X$q)}function X$n(X$m,X$p){X$d++,X$m.progress=1,X$p||(X$F=!1),X$d===X$Y&&X$h&&X$h.runWith(X$F)}function X$c(X$m,X$p){if(null!=X$k){X$m.progress=X$p;for(var X$h=0,X$P=0;X$P<X$D.length;X$P++){var X$L=X$D[X$P];X$h+=X$L.size*X$L.progress}var X$q=X$h/X$K;X$k.runWith(X$q)}}return this},X$$.cacheRes=function(X$m,X$p){X$Ym.cacheRes(X$m,X$p)},X$$._resMap={},X$d(X$$,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),X$$.__init$=function(){X$R=function(X$m){function X$p(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,X$p.__super.call(this)}return X$D(X$p,"",X$K),X$p.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},X$p}()},X$$}(),X$Km=(function(X$m){function X$L(X$m){X$L.__super.call(this),X$m||(X$m=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var X$p=0,X$h=0,X$P=0;X$P<20;X$P++)X$P%5!=4?this._mat[X$p++]=X$m[X$P]:this._alpha[X$h++]=X$m[X$P];this._action=X$Q.createFilterAction(32),this._action.data=this}X$D(X$L,"laya.filters.ColorFilter",X$c);var X$p=X$L.prototype;X$E.imps(X$p,{"laya.filters.IFilter":!0}),X$p.callNative=function(X$m){X$m._$P.cf=this;X$m.conchModel&&X$m.conchModel.setFilterMatrix&&X$m.conchModel.setFilterMatrix(this._mat,this._alpha)},X$A(0,X$p,"type",function(){return 32}),X$A(0,X$p,"action",function(){return this._action})}(),function(X$m){function X$P(X$m,X$p,X$h){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===X$p&&(X$p=0),X$P.__super.call(this),this._byteClass=X$h||X$X,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,X$m&&0<X$p&&X$p<65535&&this.connect(X$m,X$p)}X$D(X$P,"laya.net.Socket",X$K);var X$p=X$P.prototype;X$p.connect=function(X$m,X$p){var X$h="ws://"+X$m+":"+X$p;X$h="https:"==X$w.window.location.protocol?"wss://"+X$m+":"+X$p:"ws://"+X$m+":"+X$p,this.connectByUrl(X$h)},X$p.connectByUrl=function(X$m){var X$p=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new X$w.window.WebSocket(X$m,this.protocols):this._socket=new X$w.window.WebSocket(X$m),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(X$m){X$p._onOpen(X$m)},this._socket.onmessage=function(X$m){X$p._onMessage(X$m)},this._socket.onclose=function(X$m){X$p._onClose(X$m)},this._socket.onerror=function(X$m){X$p._onError(X$m)}},X$p.cleanSocket=function(){try{this._socket.close()}catch(X$m){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},X$p.close=function(){if(null!=this._socket)try{this._socket.close()}catch(X$m){}},X$p._onOpen=function(X$m){this._connected=!0,this.event("open",X$m)},X$p._onMessage=function(X$m){if(X$m&&X$m.data){var X$p=X$m.data;if(this.disableInput&&X$p)this.event("message",X$p);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var X$h=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,X$p&&("string"==typeof X$p?this._input.writeUTFBytes(X$p):this._input.writeArrayBuffer(X$p),this._addInputPosition=this._input.pos,this._input.pos=X$h),this.event("message",X$p)}}},X$p._onClose=function(X$m){this._connected=!1,this.event("close",X$m)},X$p._onError=function(X$m){this.event("error",X$m)},X$p.send=function(X$m){this._socket.send(X$m)},X$p.flush=function(){if(this._output&&0<this._output.length){var X$p;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(X$m){X$p=X$m}this._output.endian=this.endian,this._output.clear(),X$p&&this.event("error",X$p)}},X$A(0,X$p,"input",function(){return this._input}),X$A(0,X$p,"output",function(){return this._output}),X$A(0,X$p,"connected",function(){return this._connected}),X$A(0,X$p,"endian",function(){return this._endian},function(X$m){this._endian=X$m,null!=this._input&&(this._input.endian=X$m),null!=this._output&&(this._output.endian=X$m)}),X$P.LITTLE_ENDIAN="littleEndian",X$P.BIG_ENDIAN="bigEndian"}(),function(X$m){function X$Y(){X$Y.__super.call(this),this._$1__id=++X$Y._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(X$Y._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,X$z.currentResourceManager&&X$z.currentResourceManager.addResource(this)}X$D(X$Y,"laya.resource.Resource",X$K);var X$p=X$Y.prototype;return X$E.imps(X$p,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),X$p._setUrl=function(X$m){var X$p;this._url!==X$m&&(this._url&&((X$p=X$Y._urlResourcesMap[this._url]).splice(X$p.indexOf(this),1),0===X$p.length&&delete X$Y._urlResourcesMap[this._url]),X$m&&((X$p=X$Y._urlResourcesMap[X$m])||(X$Y._urlResourcesMap[X$m]=X$p=[]),X$p.push(this)),this._url=X$m)},X$p._getGroup=function(){return this._group},X$p._setGroup=function(X$m){var X$p;this._group!==X$m&&(this._group&&((X$p=X$Y._groupResourcesMap[this._group]).splice(X$p.indexOf(this),1),0===X$p.length&&delete X$Y._groupResourcesMap[this._group]),X$m&&((X$p=X$Y._groupResourcesMap[X$m])||(X$Y._groupResourcesMap[X$m]=X$p=[]),X$p.push(this)),this._group=X$m)},X$p._addReference=function(){this._referenceCount++},X$p._removeReference=function(){this._referenceCount--},X$p._clearReference=function(){this._referenceCount=0},X$p._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},X$p.recreateResource=function(){this.completeCreate()},X$p.disposeResource=function(){},X$p.activeResource=function(X$m){void 0===X$m&&(X$m=!1),this._lastUseFrameCount=X$f.loopCount,!this._destroyed&&this.__loaded&&(this._released||X$m)&&this.recreateResource()},X$p.releaseResource=function(X$m){return void 0===X$m&&(X$m=!0),!(!X$m&&this.lock)&&(!(this._released&&!X$m)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},X$p.onAsynLoaded=function(X$m,X$p,X$h){throw new Error("Resource: must override this function!")},X$p.destroy=function(){var X$m;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete X$Y._idResourcesMap[this.id],this._url&&((X$m=X$Y._urlResourcesMap[this._url])&&(X$m.splice(X$m.indexOf(this),1),0===X$m.length&&delete X$Y._urlResourcesMap[this.url]),X$Ym.clearRes(this._url),this.__loaded||X$Q.cancelLoadByUrl(this._url)),this._group&&((X$m=X$Y._groupResourcesMap[this._group]).splice(X$m.indexOf(this),1),0===X$m.length&&delete X$Y._groupResourcesMap[this.url]))},X$p.completeCreate=function(){this._released=!1,this.event("recovered",this)},X$p.dispose=function(){this.destroy()},X$A(0,X$p,"memorySize",function(){return this._memorySize},function(X$m){var X$p=X$m-this._memorySize;this._memorySize=X$m,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,X$p),this.resourceManager&&this.resourceManager.addSize(X$p)}),X$A(0,X$p,"_loaded",null,function(X$m){this.__loaded=X$m}),X$A(0,X$p,"loaded",function(){return this.__loaded}),X$A(0,X$p,"id",function(){return this._$1__id}),X$A(0,X$p,"destroyed",function(){return this._destroyed}),X$A(0,X$p,"group",function(){return this._getGroup()},function(X$m){this._setGroup(X$m)}),X$A(0,X$p,"resourceManager",function(){return this._resourceManager}),X$A(0,X$p,"url",function(){return this._url}),X$A(0,X$p,"released",function(){return this._released}),X$A(0,X$p,"referenceCount",function(){return this._referenceCount}),X$Y.getResourceByID=function(X$m){return X$Y._idResourcesMap[X$m]},X$Y.getResourceByURL=function(X$m,X$p){return void 0===X$p&&(X$p=0),null==X$Y._urlResourcesMap[X$m]?null:X$Y._urlResourcesMap[X$m][X$p]},X$Y.getResourceCountByURL=function(X$m){return X$Y._urlResourcesMap[X$m].length},X$Y.destroyUnusedResources=function(X$m){var X$p;if(X$m){var X$h=X$Y._groupResourcesMap[X$m];if(X$h)for(var X$P=X$h.slice(),X$L=0,X$q=X$P.length;X$L<X$q;X$L++)(X$p=X$P[X$L]).lock||0!==X$p._referenceCount||X$p.destroy()}else for(var X$k in X$Y._idResourcesMap)(X$p=X$Y._idResourcesMap[X$k]).lock||0!==X$p._referenceCount||X$p.destroy()},X$Y._uniqueIDCounter=0,X$Y._idResourcesMap={},X$Y._urlResourcesMap={},X$Y._groupResourcesMap={},X$Y}()),X$Dm=function(X$m){function X$T(X$m,X$p){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,X$T.__super.call(this),X$m&&null!=X$m._addReference&&X$m._addReference(),this.setTo(X$m,X$p)}X$D(X$T,"laya.resource.Texture",X$K);var X$p=X$T.prototype;return X$p._setUrl=function(X$m){this.url=X$m},X$p.setTo=function(X$m,X$p){if(X$m instanceof X$k.HTMLElement){var X$h=X$am.create("2D",X$m);this.bitmap=X$h}else this.bitmap=X$m;if(this.uv=X$p||X$T.DEF_UV,X$m){this._w=X$m.width,this._h=X$m.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var X$P=this;if(this._loaded)X$Q.addToAtlas&&X$Q.addToAtlas(X$P);else{var X$L=X$m;X$L instanceof laya.resource.HTMLImage&&X$L.image&&X$L.image.addEventListener("load",function(X$m){X$Q.addToAtlas&&X$Q.addToAtlas(X$P)},!1)}}},X$p.active=function(){this.bitmap&&this.bitmap.activeResource()},X$p.destroy=function(X$m){if(void 0===X$m&&(X$m=!1),this.alphaTexture&&(this.alphaTexture.destroy(X$m),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var X$p=this.bitmap;X$m?(X$S.isConchApp&&X$p.source&&X$p.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,X$p.dispose(),X$p._clearReference()):(X$p._removeReference(),0==X$p.referenceCount&&(X$S.isConchApp&&X$p.source&&X$p.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,X$p.dispose())),this.url&&this===X$E.loader.getRes(this.url)&&X$E.loader.clearRes(this.url,X$m),this._loaded=!1}},X$p.load=function(X$m){var X$p=this;this._loaded=!1,X$m=X$N.customFormat(X$m);var X$h=this.bitmap||(this.bitmap=X$Wm.create(X$m));X$h.uri=X$m,X$h&&X$h._addReference();var X$P=this;X$h.onload=function(){X$h.onload=null,X$P._loaded=!0,X$p.sourceWidth=X$p._w=X$h.width,X$p.sourceHeight=X$p._h=X$h.height,X$P.event("loaded",this),X$Q.addToAtlas&&X$Q.addToAtlas(X$P)}},X$p.addTextureToAtlas=function(X$m){X$Q.addTextureToAtlas(this)},X$p.getPixels=function(X$m,X$p,X$h,X$P){if(X$S.isConchApp){var X$L=this.bitmap;if(X$L.source&&X$L.source.getImageData){var X$q=X$L.source.getImageData(X$m,X$p,X$h,X$P),X$k=new Uint8Array(X$q);return Array.from(X$k)}return null}return X$S.isWebGL?X$Q.getTexturePixels(this,X$m,X$p,X$h,X$P):(X$w.canvas.size(X$h,X$P),X$w.canvas.clear(),X$w.context.drawTexture(this,-X$m,-X$p,this.width,this.height,0,0),X$w.context.getImageData(0,0,X$h,X$P).data)},X$p.onAsynLoaded=function(X$m,X$p){if(X$p){if("function"!=typeof X$p._addReference)throw new Error("bitmap._addReference is not a function. "+X$p.className+" "+typeof X$p._addReference+" "+X$p.constructor);X$p._addReference()}this.setTo(X$p,this.uv),this._loaded&&this.event("loaded",this)},X$A(0,X$p,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),X$A(0,X$p,"loaded",function(){return this._loaded}),X$A(0,X$p,"released",function(){return!this.bitmap||this.bitmap.released}),X$A(0,X$p,"width",function(){return this._w?this._w:this.uv&&this.uv!==X$T.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(X$m){this._w=X$m,this.sourceWidth||(this.sourceWidth=X$m)}),X$A(0,X$p,"repeat",function(){return!X$S.isWebGL||!this.bitmap||this.bitmap.repeat},function(X$m){X$m&&X$S.isWebGL&&this.bitmap&&(this.bitmap.repeat=X$m)&&(this.bitmap.enableMerageInAtlas=!1)}),X$A(0,X$p,"height",function(){return this._h?this._h:this.uv&&this.uv!==X$T.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(X$m){this._h=X$m,this.sourceHeight||(this.sourceHeight=X$m)}),X$A(0,X$p,"isLinearSampling",function(){return!X$S.isWebGL||9728!=this.bitmap.minFifter},function(X$m){!X$m&&X$S.isWebGL&&(X$m||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),X$T.moveUV=function(X$m,X$p,X$h){for(var X$P=0;X$P<8;X$P+=2)X$h[X$P]+=X$m,X$h[X$P+1]+=X$p;return X$h},X$T.create=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){void 0===X$q&&(X$q=0),void 0===X$k&&(X$k=0),void 0===X$Y&&(X$Y=0),void 0===X$d&&(X$d=0);var X$K=X$m instanceof laya.resource.Texture,X$D=X$K?X$m.uv:X$T.DEF_UV,X$F=X$K?X$m.bitmap:X$m,X$R=X$Q.isAtlas(X$F);if(X$R){var X$$=X$F._atlaser,X$A=X$m._atlasID;if(-1==X$A)throw new Error("create texture error");X$F=X$$._inAtlasTextureBitmapValue[X$A],X$D=X$$._inAtlasTextureOriUVValue[X$A]}var X$B=new X$T(X$F,null);X$F.width&&X$p+X$P>X$F.width&&(X$P=X$F.width-X$p),X$F.height&&X$h+X$L>X$F.height&&(X$L=X$F.height-X$h),X$B.width=X$P,X$B.height=X$L,X$B.offsetX=X$q,X$B.offsetY=X$k,X$B.sourceWidth=X$Y||X$P,X$B.sourceHeight=X$d||X$L;var X$n=1/X$F.width,X$c=1/X$F.height;X$p*=X$n,X$h*=X$c,X$P*=X$n,X$L*=X$c;var X$e=X$B.uv[0],X$a=X$B.uv[1],X$Z=X$B.uv[4],X$H=X$B.uv[5],X$W=X$Z-X$e,X$E=X$H-X$a,X$I=X$T.moveUV(X$D[0],X$D[1],[X$p,X$h,X$p+X$P,X$h,X$p+X$P,X$h+X$L,X$p,X$h+X$L]);X$B.uv=[X$e+X$I[0]*X$W,X$a+X$I[1]*X$E,X$Z-(1-X$I[2])*X$W,X$a+X$I[3]*X$E,X$Z-(1-X$I[4])*X$W,X$H-(1-X$I[5])*X$E,X$e+X$I[6]*X$W,X$H-(1-X$I[7])*X$E],X$R&&X$B.addTextureToAtlas();var X$b=X$F.scaleRate;return X$b&&1!=X$b?(X$B.sourceWidth/=X$b,X$B.sourceHeight/=X$b,X$B.width/=X$b,X$B.height/=X$b,X$B.scaleRate=X$b,X$B.offsetX/=X$b,X$B.offsetY/=X$b):X$B.scaleRate=1,X$B},X$T.createFromTexture=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$m.scaleRate;1!=X$q&&(X$p*=X$q,X$h*=X$q,X$P*=X$q,X$L*=X$q);var X$k=X$b.TEMP.setTo(X$p-X$m.offsetX,X$h-X$m.offsetY,X$P,X$L),X$Y=X$k.intersection(X$T._rect1.setTo(0,0,X$m.width,X$m.height),X$T._rect2);if(!X$Y)return null;var X$d=X$T.create(X$m,X$Y.x,X$Y.y,X$Y.width,X$Y.height,X$Y.x-X$k.x,X$Y.y-X$k.y,X$P,X$L);if(X$d.bitmap&&X$d.bitmap._removeReference)return X$d.bitmap._removeReference(),X$d;var X$K="bitmap:"+(X$d.bitmap?X$d.bitmap.constructor?X$d.bitmap.constructor.name:X$d.bitmap.__className:"")+", url:"+(X$m.url+" | "+(X$d.bitmap?X$d.bitmap.url:X$m.url))+", x="+X$p+",y="+X$h+",width="+X$P+",height="+X$L+", result="+(X$Y?X$Y.x+","+X$Y.y+","+X$Y.width+","+X$Y.height:"null")+", rect="+X$k.x+","+X$k.y+","+X$k.width+","+X$k.height;throw new Error("报错：bitmap._removeReference is not a function  "+X$K)},X$T.DEF_UV=[0,0,1,0,1,1,0,1],X$T.INV_UV=[0,1,1,1,1,0,0,0],X$T._rect1=new X$b,X$T._rect2=new X$b,X$T}(),X$m=function(X$m){var X$Y;function X$q(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,X$q.__super.call(this)}X$D(X$q,"laya.utils.TimeLine",X$K);var X$p=X$q.prototype;return X$p.to=function(X$m,X$p,X$h,X$P,X$L){return void 0===X$L&&(X$L=0),this._create(X$m,X$p,X$h,X$P,X$L,!0)},X$p.from=function(X$m,X$p,X$h,X$P,X$L){return void 0===X$L&&(X$L=0),this._create(X$m,X$p,X$h,X$P,X$L,!1)},X$p._create=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=X$o.getItemByClass("tweenData",X$Y);return X$k.isTo=X$q,X$k.type=0,X$k.target=X$m,X$k.duration=X$h,X$k.data=X$p,X$k.startTime=this._startTime+X$L,X$k.endTime=X$k.startTime+X$k.duration,X$k.ease=X$P,this._startTime=Math.max(X$k.endTime,this._startTime),this._tweenDataList.push(X$k),this._startTimeSort=!0,this._endTimeSort=!0,this},X$p.addLabel=function(X$m,X$p){var X$h=X$o.getItemByClass("tweenData",X$Y);return X$h.type=1,X$h.data=X$m,X$h.endTime=X$h.startTime=this._startTime+X$p,this._labelDic||(this._labelDic={}),this._labelDic[X$m]=X$h,this._tweenDataList.push(X$h),this},X$p.removeLabel=function(X$m){if(this._labelDic&&this._labelDic[X$m]){var X$p=this._labelDic[X$m];if(X$p){var X$h=this._tweenDataList.indexOf(X$p);-1<X$h&&this._tweenDataList.splice(X$h,1)}delete this._labelDic[X$m]}},X$p.gotoTime=function(X$m){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var X$p,X$h,X$P,X$L;for(var X$q in this._firstTweenDic)if(X$h=this._firstTweenDic[X$q])for(var X$k in X$h)X$h.diyTarget.hasOwnProperty(X$k)&&(X$h.diyTarget[X$k]=X$h[X$k]);for(X$q in this._tweenDic)(X$p=this._tweenDic[X$q]).clear(),delete this._tweenDic[X$q];if(this._index=0,this._gidIndex=0,this._currTime=X$m,this._lastTime=X$w.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=X$P=this._tweenDataList.concat(),X$P.sort(function(X$m,X$p){return X$m.endTime>X$p.endTime?1:X$m.endTime<X$p.endTime?-1:0})}else X$P=this._endTweenDataList;for(var X$Y=0,X$d=X$P.length;X$Y<X$d;X$Y++)if(0==(X$L=X$P[X$Y]).type){if(!(X$m>=X$L.endTime))break;this._index=Math.max(this._index,X$Y+1);var X$K=X$L.data;if(X$L.isTo)for(var X$D in X$K)X$L.target[X$D]=X$K[X$D]}for(X$Y=0,X$d=this._tweenDataList.length;X$Y<X$d;X$Y++)0==(X$L=this._tweenDataList[X$Y]).type&&X$m>=X$L.startTime&&X$m<X$L.endTime&&(this._index=Math.max(this._index,X$Y+1),this._gidIndex++,(X$p=X$o.getItemByClass("tween",X$v))._create(X$L.target,X$L.data,X$L.duration,X$L.ease,X$e.create(this,this._animComplete,[this._gidIndex]),0,!1,X$L.isTo,!0,!1),X$p.setStartTime(this._currTime-(X$m-X$L.startTime)),X$p._updateEase(this._currTime),X$p.gid=this._gidIndex,this._tweenDic[this._gidIndex]=X$p)}},X$p.gotoLabel=function(X$m){if(null!=this._labelDic){var X$p=this._labelDic[X$m];X$p&&this.gotoTime(X$p.startTime)}},X$p.pause=function(){X$E.timer.clear(this,this._update)},X$p.resume=function(){this.play(this._currTime,this._loopKey)},X$p.play=function(X$m,X$p){if(void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(X$m,X$p){return X$m.startTime>X$p.startTime?1:X$m.startTime<X$p.startTime?-1:0});for(var X$h=0,X$P=this._tweenDataList.length;X$h<X$P;X$h++){var X$L=this._tweenDataList[X$h];if(null!=X$L&&0==X$L.type){var X$q=X$L.target,X$k=X$q.$_GID||(X$q.$_GID=X$g.getGID()),X$Y=null;for(var X$d in null==this._firstTweenDic[X$k]?((X$Y={}).diyTarget=X$q,this._firstTweenDic[X$k]=X$Y):X$Y=this._firstTweenDic[X$k],X$L.data)null==X$Y[X$d]&&(X$Y[X$d]=X$q[X$d])}}}"string"==typeof X$m?this.gotoLabel(X$m):this.gotoTime(X$m),this._loopKey=X$p,this._lastTime=X$w.now(),X$E.timer.frameLoop(1,this,this._update)}},X$p._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var X$m in this._tweenDic)(X$p=this._tweenDic[X$m]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var X$p,X$h=X$w.now(),X$P=X$h-this._lastTime,X$L=this._currTime+=X$P*this.scale;for(X$m in this._lastTime=X$h,this._tweenDic)(X$p=this._tweenDic[X$m])._updateEase(X$L);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var X$q=this._tweenDataList[this._index];X$L>=X$q.startTime&&(this._index++,0==X$q.type?(this._gidIndex++,(X$p=X$o.getItemByClass("tween",X$v))._create(X$q.target,X$q.data,X$q.duration,X$q.ease,X$e.create(this,this._animComplete,[this._gidIndex]),0,!1,X$q.isTo,!0,!1),X$p.setStartTime(X$L),X$p.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=X$p)._updateEase(X$L)):this.event("label",X$q.data))}},X$p._animComplete=function(X$m){this._tweenDic[X$m]&&delete this._tweenDic[X$m]},X$p._complete=function(){this.event("complete")},X$p.reset=function(){var X$m;if(this._labelDic)for(X$m in this._labelDic)delete this._labelDic[X$m];for(X$m in this._tweenDic)this._tweenDic[X$m].clear(),delete this._tweenDic[X$m];for(X$m in this._firstTweenDic)delete this._firstTweenDic[X$m];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var X$p,X$h=0;for(X$p=this._tweenDataList.length,X$h=0;X$h<X$p;X$h++)this._tweenDataList[X$h]&&this._tweenDataList[X$h].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,X$E.timer.clear(this,this._update)},X$p.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},X$A(0,X$p,"index",function(){return this._frameIndex},function(X$m){this._frameIndex=X$m,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),X$A(0,X$p,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),X$q.to=function(X$m,X$p,X$h,X$P,X$L){return void 0===X$L&&(X$L=0),(new X$q).to(X$m,X$p,X$h,X$P,X$L)},X$q.from=function(X$m,X$p,X$h,X$P,X$L){return void 0===X$L&&(X$L=0),(new X$q).from(X$m,X$p,X$h,X$P,X$L)},X$q.__init$=function(){X$Y=function(){function X$m(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return X$D(X$m,""),X$m.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,X$o.recover("tweenData",this)},X$m}()},X$q}(),X$Fm=function(X$L){function X$h(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,X$h.__super.call(this),this._style=X$Y.EMPTY}X$D(X$h,"laya.display.Sprite",X$L);var X$m=X$h.prototype;return X$E.imps(X$m,{"laya.display.ILayout":!0}),X$m.createConchModel=function(){return new ConchNode},X$m.destroy=function(X$m){if(void 0===X$m&&(X$m=!0),this._releaseMem(),!this._destroyed){this.filters=null;var X$p=this.mask;X$p&&(this.mask=null,X$p.destroy(X$m))}X$L.prototype.destroy.call(this,X$m),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},X$m.updateZOrder=function(){X$g.updateOrder(this._childs)&&this.repaint()},X$m.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},X$m.setBounds=function(X$m){this._set$P("uBounds",X$m)},X$m.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new X$b),X$b._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},X$m.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new X$b),X$b._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},X$m._boundPointsToParent=function(X$m){void 0===X$m&&(X$m=!1);var X$p=0,X$h=0;this._style&&(X$p=this._style._tf.translateX,X$h=this._style._tf.translateY,X$m=X$m||0!==this._style._tf.rotate,this._style.scrollRect&&(X$p+=this._style.scrollRect.x,X$h+=this._style.scrollRect.y));var X$P=this._getBoundPointsM(X$m);if(!X$P||X$P.length<1)return X$P;if(8!=X$P.length&&(X$P=X$m?X$H.scanPList(X$P):X$b._getWrapRec(X$P,X$b.TEMP)._getBoundPoints()),!this.transform)return X$g.transPointList(X$P,this._x-X$p,this._y-X$h),X$P;var X$L=X$I.TEMP,X$q=0,X$k=X$P.length;for(X$q=0;X$q<X$k;X$q+=2)X$L.x=X$P[X$q],X$L.y=X$P[X$q+1],this.toParentPoint(X$L),X$P[X$q]=X$L.x,X$P[X$q+1]=X$L.y;return X$P},X$m.getGraphicBounds=function(X$m){return void 0===X$m&&(X$m=!1),this._graphics?this._graphics.getBounds(X$m):X$b.TEMP.setTo(0,0,0,0)},X$m._getBoundPointsM=function(X$m){if(void 0===X$m&&(X$m=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var X$p=X$g.clearArray(this._$P.temBM),X$h=X$b.TEMP;return X$h.copyFrom(this.scrollRect),X$g.concatArray(X$p,X$h._getBoundPoints()),X$p}for(var X$P,X$L,X$q,X$k=this._graphics?this._graphics.getBoundPoints():X$g.clearArray(this._$P.temBM),X$Y=0,X$d=(X$q=this._childs).length;X$Y<X$d;X$Y++)(X$P=X$q[X$Y])instanceof laya.display.Sprite&&1==X$P.visible&&(X$L=X$P._boundPointsToParent(X$m))&&(X$k=X$k?X$g.concatArray(X$k,X$L):X$L);return X$k},X$m.getStyle=function(){return this._style===X$Y.EMPTY&&(this._style=new X$Y),this._style},X$m.setStyle=function(X$m){this._style=X$m},X$m._adjustTransform=function(){this._tfChanged=!1;var X$m,X$p=this._style._tf,X$h=X$p.scaleX,X$P=X$p.scaleY;if(X$p.rotate||1!==X$h||1!==X$P||X$p.skewX||X$p.skewY){(X$m=this._transform||(this._transform=X$M.create())).bTransform=!0;var X$L=.0174532922222222*(X$p.rotate-X$p.skewX),X$q=.0174532922222222*(X$p.rotate+X$p.skewY),X$k=Math.cos(X$q),X$Y=Math.sin(X$q),X$d=Math.sin(X$L),X$K=Math.cos(X$L);return X$m.a=X$h*X$k,X$m.b=X$h*X$Y,X$m.c=-X$P*X$d,X$m.d=X$P*X$K,X$m.tx=X$m.ty=0,X$m}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,X$m},X$m.pos=function(X$m,X$p,X$h){if(void 0===X$h&&(X$h=!1),this._x!==X$m||this._y!==X$p){if(this.destroyed)return this;if(X$h){this._x=X$m,this._y=X$p,this.conchModel&&this.conchModel.pos(this._x,this._y);var X$P=this._parent;X$P&&0===X$P._repaint&&(X$P._repaint=1,X$P.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=X$m,this.y=X$p}return this},X$m.pivot=function(X$m,X$p){return this.pivotX=X$m,this.pivotY=X$p,this},X$m.size=function(X$m,X$p){return this.width=X$m,this.height=X$p,this},X$m.scale=function(X$m,X$p,X$h){void 0===X$h&&(X$h=!1);var X$P=this.getStyle(),X$L=X$P._tf;if(X$L.scaleX!=X$m||X$L.scaleY!=X$p){if(this.destroyed)return this;if(X$h){X$P.setScale(X$m,X$p),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(X$m,X$p),this._renderType|=4;var X$q=this._parent;X$q&&0===X$q._repaint&&(X$q._repaint=1,X$q.parentRepaint())}else this.scaleX=X$m,this.scaleY=X$p}return this},X$m.skew=function(X$m,X$p){return this.skewX=X$m,this.skewY=X$p,this},X$m.render=function(X$m,X$p,X$h){X$f.spriteCount++,X$l.renders[this._renderType]._fun(this,X$m,X$p+this._x,X$h+this._y),this._repaint=0},X$m.drawToCanvas=function(X$m,X$p,X$h,X$P){if(X$S.isConchNode){var X$L=X$am.create("2D");return new X$_(X$m,X$p,X$L).ctx.setCanvasType(1),this.conchModel.drawToCanvas(X$L.source,X$h,X$P),X$L}return X$Q.drawToCanvas(this,this._renderType,X$m,X$p,X$h,X$P)},X$m.customRender=function(X$m,X$p,X$h){this._renderType|=1024},X$m._applyFilters=function(){var X$m;if(!X$S.isWebGL&&((X$m=this._$P.filters)&&!(X$m.length<1)))for(var X$p=0,X$h=X$m.length;X$p<X$h;X$p++)X$m[X$p].action.apply(this._$P.cacheCanvas)},X$m._isHaveGlowFilter=function(){var X$m,X$p=0;if(this.filters)for(X$p=0;X$p<this.filters.length;X$p++)if(8==this.filters[X$p].type)return!0;for(X$p=0,X$m=this._childs.length;X$p<X$m;X$p++)if(this._childs[X$p]._isHaveGlowFilter())return!0;return!1},X$m.localToGlobal=function(X$m,X$p){void 0===X$p&&(X$p=!1),!0===X$p&&(X$m=new X$I(X$m.x,X$m.y));for(var X$h=this;X$h&&X$h!=X$E.stage;)X$m=X$h.toParentPoint(X$m),X$h=X$h.parent;return X$m},X$m.globalToLocal=function(X$m,X$p){void 0===X$p&&(X$p=!1),X$p&&(X$m=new X$I(X$m.x,X$m.y));for(var X$h=this,X$P=[];X$h&&X$h!=X$E.stage;)X$P.push(X$h),X$h=X$h.parent;for(var X$L=X$P.length-1;0<=X$L;)X$m=(X$h=X$P[X$L]).fromParentPoint(X$m),X$L--;return X$m},X$m.toParentPoint=function(X$m){if(!X$m)return X$m;X$m.x-=this.pivotX,X$m.y-=this.pivotY,this.transform&&this._transform.transformPoint(X$m),X$m.x+=this._x,X$m.y+=this._y;var X$p=this._style.scrollRect;return X$p&&(X$m.x-=X$p.x,X$m.y-=X$p.y),X$m},X$m.fromParentPoint=function(X$m){if(!X$m)return X$m;X$m.x-=this._x,X$m.y-=this._y;var X$p=this._style.scrollRect;return X$p&&(X$m.x+=X$p.x,X$m.y+=X$p.y),this.transform&&this._transform.invertTransformPoint(X$m),X$m.x+=this.pivotX,X$m.y+=this.pivotY,X$m},X$m.on=function(X$m,X$p,X$h,X$P){return 1!==this._mouseEnableState&&this.isMouseEvent(X$m)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(X$m,X$p,X$h,X$P,!1)):X$L.prototype.on.call(this,X$m,X$p,X$h,X$P)},X$m.once=function(X$m,X$p,X$h,X$P){return 1!==this._mouseEnableState&&this.isMouseEvent(X$m)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(X$m,X$p,X$h,X$P,!0)):X$L.prototype.once.call(this,X$m,X$p,X$h,X$P)},X$m._$2__onDisplay=function(){if(1!==this._mouseEnableState){var X$m=this;for(X$m=X$m.parent;X$m&&1!==X$m._mouseEnableState&&!X$m._getBit(2);)X$m.mouseEnabled=!0,X$m._setBit(2,!0),X$m=X$m.parent}},X$m.loadImage=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=this;return void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=0),void 0===X$L&&(X$L=0),this.graphics.loadImage(X$m,X$p,X$h,X$P,X$L,function(X$m){X$k.destroyed||(X$k.size(X$p+(X$P||X$m.width),X$h+(X$L||X$m.height)),X$k.repaint(),X$q&&X$q.runWith(X$m))}),this},X$m.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},X$m._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},X$m._childChanged=function(X$m){this._childs.length?this._renderType|=2048:this._renderType&=-2049,X$m&&this._get$P("hasZorder")&&X$E.timer.callLater(this,this.updateZOrder),this.repaint()},X$m.parentRepaint=function(){var X$m=this._parent;X$m&&0===X$m._repaint&&(X$m._repaint=1,X$m.parentRepaint())},X$m.startDrag=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){void 0===X$p&&(X$p=!1),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=300),void 0===X$q&&(X$q=!1),void 0===X$k&&(X$k=.92),this._$P.dragging||this._set$P("dragging",new X$r),this._$P.dragging.start(this,X$m,X$p,X$h,X$P,X$L,X$q,X$k)},X$m.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},X$m._releaseMem=function(){if(this._$P){var X$m=this._$P.cacheCanvas;X$m&&X$m.ctx&&(X$o.recover("RenderContext",X$m.ctx),X$m.ctx.canvas.size(0,0),X$m.ctx=null);var X$p=this._$P._filterCache;X$p&&(X$p.destroy(),X$p.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},X$m._setDisplay=function(X$m){X$m||this._releaseMem(),X$L.prototype._setDisplay.call(this,X$m)},X$m.hitTestPoint=function(X$m,X$p){var X$h=this.globalToLocal(X$I.TEMP.setTo(X$m,X$p));return X$m=X$h.x,X$p=X$h.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?X$b.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(X$m,X$p)},X$m.getMousePoint=function(){return this.globalToLocal(X$I.TEMP.setTo(X$E.stage.mouseX,X$E.stage.mouseY))},X$m._getWords=function(){return null},X$m._addChildsToLayout=function(X$m){var X$p=this._getWords();if(null==X$p&&0==this._childs.length)return!1;if(X$p)for(var X$h=0,X$P=X$p.length;X$h<X$P;X$h++)X$m.push(X$p[X$h]);X$h=0;for(var X$L=this._childs.length;X$h<X$L;++X$h){var X$q=this._childs[X$h];X$q._style._enableLayout()&&X$q._addToLayout(X$m)}return!0},X$m._addToLayout=function(X$m){this._style.absolute||(this._style.block?X$m.push(this):this._addChildsToLayout(X$m)&&(this.x=this.y=0))},X$m._isChar=function(){return!1},X$m._getCSSStyle=function(){return this._style.getCSSStyle()},X$m._setAttributes=function(X$m,X$p){switch(X$m){case"x":this.x=parseFloat(X$p);break;case"y":this.y=parseFloat(X$p);break;case"width":this.width=parseFloat(X$p);break;case"height":this.height=parseFloat(X$p);break;default:this[X$m]=X$p}},X$m._layoutLater=function(){this.parent&&this.parent._layoutLater()},X$A(0,X$m,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(X$m){this._optimizeScrollRect!=X$m&&(this._optimizeScrollRect=X$m,this.conchModel&&this.conchModel.optimizeScrollRect(X$m))}),X$A(0,X$m,"customRenderEnable",null,function(X$m){if(X$m&&(this._renderType|=1024,X$S.isConchNode)){X$h.CustomList.push(this);var X$p=new X$am("2d");X$p._setContext(new CanvasRenderingContext2D),this.customContext=new X$_(0,0,X$p),X$p.context.setCanvasType&&X$p.context.setCanvasType(2),this.conchModel.custom(X$p.context)}}),X$A(0,X$m,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(X$m){this.cacheAs=X$m?this._$P.hasFilter?"none":"normal":"none"}),X$A(0,X$m,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(X$m){var X$p=this._$P.cacheCanvas;if(X$m!==(X$p?X$p.type:"none")){if("none"!==X$m)this._getBit(1)||this._setUpNoticeType(1),X$p||(X$p=this._set$P("cacheCanvas",X$o.getItemByClass("cacheCanvas",Object))),X$p.type=X$m,X$p.reCache=!0,this._renderType|=16,"bitmap"==X$m&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(X$p){var X$h=X$p;X$h&&X$h.ctx&&(X$o.recover("RenderContext",X$h.ctx),X$h.ctx.canvas.size(0,0),X$h.ctx=null),X$o.recover("cacheCanvas",X$p)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),X$A(0,X$m,"zOrder",function(){return this._zOrder},function(X$m){this._zOrder!=X$m&&(this._zOrder=X$m,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(X$m),this._parent&&(X$m&&this._parent._set$P("hasZorder",!0),X$E.timer.callLater(this._parent,this.updateZOrder)))}),X$A(0,X$m,"rotation",function(){return this._style._tf.rotate},function(X$m){var X$p=this.getStyle();if(X$p._tf.rotate!==X$m){X$p.setRotate(X$m),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(X$m),this._renderType|=4;var X$h=this._parent;X$h&&0===X$h._repaint&&(X$h._repaint=1,X$h.parentRepaint())}}),X$A(0,X$m,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(X$m){this._width!==X$m&&(this._width=X$m,this.conchModel&&this.conchModel.size(X$m,this._height),this.repaint())}),X$A(0,X$m,"x",function(){return this._x},function(X$m){if(this._x!==X$m){if(this.destroyed)return;this._x=X$m,this.conchModel&&this.conchModel.pos(X$m,this._y);var X$p=this._parent;X$p&&0===X$p._repaint&&(X$p._repaint=1,X$p.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),X$A(0,X$m,"globalScaleY",function(){for(var X$m=1,X$p=this;X$p&&X$p!==X$E.stage;)X$m*=X$p.scaleY,X$p=X$p.parent;return X$m}),X$A(0,X$m,"hitArea",function(){return this._$P.hitArea},function(X$m){this._set$P("hitArea",X$m)}),X$A(0,X$m,"staticCache",function(){return this._$P.staticCache},function(X$m){this._set$P("staticCache",X$m),X$m||this.reCache()}),X$A(0,X$m,"texture",function(){return this._texture},function(X$m){this._texture!=X$m&&(this._texture=X$m,this.graphics.cleanByTexture(X$m,0,0))}),X$A(0,X$m,"y",function(){return this._y},function(X$m){if(this._y!==X$m){if(this.destroyed)return;this._y=X$m,this.conchModel&&this.conchModel.pos(this._x,X$m);var X$p=this._parent;X$p&&0===X$p._repaint&&(X$p._repaint=1,X$p.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),X$A(0,X$m,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(X$m){this._height!==X$m&&(this._height=X$m,this.conchModel&&this.conchModel.size(this._width,X$m),this.repaint())}),X$A(0,X$m,"blendMode",function(){return this._style.blendMode},function(X$m){this.getStyle().blendMode=X$m,this.conchModel&&this.conchModel.blendMode(X$m),X$m&&"source-over"!=X$m?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),X$A(0,X$m,"scaleX",function(){return this._style._tf.scaleX},function(X$m){var X$p=this.getStyle();if(X$p._tf.scaleX!==X$m){X$p.setScaleX(X$m),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(X$m,X$p._tf.scaleY),this._renderType|=4;var X$h=this._parent;X$h&&0===X$h._repaint&&(X$h._repaint=1,X$h.parentRepaint())}}),X$A(0,X$m,"scaleY",function(){return this._style._tf.scaleY},function(X$m){var X$p=this.getStyle();if(X$p._tf.scaleY!==X$m){X$p.setScaleY(X$m),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(X$p._tf.scaleX,X$m),this._renderType|=4;var X$h=this._parent;X$h&&0===X$h._repaint&&(X$h._repaint=1,X$h.parentRepaint())}}),X$A(0,X$m,"stage",function(){return X$E.stage}),X$A(0,X$m,"skewX",function(){return this._style._tf.skewX},function(X$m){var X$p=this.getStyle();if(X$p._tf.skewX!==X$m){X$p.setSkewX(X$m),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(X$m,X$p._tf.skewY),this._renderType|=4;var X$h=this._parent;X$h&&0===X$h._repaint&&(X$h._repaint=1,X$h.parentRepaint())}}),X$A(0,X$m,"scrollRect",function(){return this._style.scrollRect},function(X$m){this.getStyle().scrollRect=X$m,this.repaint(),X$m?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(X$m.x,X$m.y,X$m.width,X$m.height)):(this._renderType&=-129,this.conchModel&&(X$h.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),X$A(0,X$m,"skewY",function(){return this._style._tf.skewY},function(X$m){var X$p=this.getStyle();if(X$p._tf.skewY!==X$m){X$p.setSkewY(X$m),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(X$p._tf.skewX,X$m),this._renderType|=4;var X$h=this._parent;X$h&&0===X$h._repaint&&(X$h._repaint=1,X$h.parentRepaint())}}),X$A(0,X$m,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(X$m){this._tfChanged=!1,(this._transform=X$m)&&(this._x=X$m.tx,this._y=X$m.ty,X$m.tx=X$m.ty=0,this.conchModel&&this.conchModel.transform(X$m.a,X$m.b,X$m.c,X$m.d,this._x,this._y)),X$m?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),X$A(0,X$m,"pivotX",function(){return this._style._tf.translateX},function(X$m){this.getStyle().setTranslateX(X$m),this.conchModel&&this.conchModel.pivot(X$m,this._style._tf.translateY),this.repaint()}),X$A(0,X$m,"pivotY",function(){return this._style._tf.translateY},function(X$m){this.getStyle().setTranslateY(X$m),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,X$m),this.repaint()}),X$A(0,X$m,"alpha",function(){return this._style.alpha},function(X$m){this._style&&this._style.alpha!==X$m&&(X$m=X$m<0?0:1<X$m?1:X$m,this.getStyle().alpha=X$m,this.conchModel&&this.conchModel.alpha(X$m),1!==X$m?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),X$A(0,X$m,"visible",function(){return this._style.visible},function(X$m){this._style&&this._style.visible!==X$m&&(this.getStyle().visible=X$m,this.conchModel&&this.conchModel.visible(X$m),this.parentRepaint())}),X$A(0,X$m,"graphics",function(){return this._graphics||(this.graphics=X$Q.createGraphics())},function(X$m){this._graphics&&(this._graphics._sp=null),(this._graphics=X$m)?(this._renderType&=-2,this._renderType|=512,(X$m._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(X$h.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),X$A(0,X$m,"filters",function(){return this._$P.filters},function(X$m){X$m&&0===X$m.length&&(X$m=null),this._$P.filters!=X$m&&(this._set$P("filters",X$m?X$m.slice():null),X$S.isConchApp&&(this.conchModel&&(X$h.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),X$S.isWebGL&&(X$m&&X$m.length?this._renderType|=32:this._renderType&=-33),X$m&&0<X$m.length?(this._getBit(1)||this._setUpNoticeType(1),X$S.isWebGL&&1==X$m.length&&X$m[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(X$S.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),X$A(0,X$m,"parent",X$L.prototype._$get_parent,function(X$m){X$E.superSet(X$mm,this,"parent",X$m),X$m&&this._getBit(2)&&this._$2__onDisplay()}),X$A(0,X$m,"mask",function(){return this._$P._mask},function(X$m){X$m&&this.mask&&this.mask._$P.maskParent||(X$m?(this.cacheAs="bitmap",this._set$P("_mask",X$m),X$m._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",X$m),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(X$m?X$m.conchModel:null),this._renderType|=64,this.parentRepaint())}),X$A(0,X$m,"mouseEnabled",function(){return 1<this._mouseEnableState},function(X$m){this._mouseEnableState=X$m?2:1}),X$A(0,X$m,"globalScaleX",function(){for(var X$m=1,X$p=this;X$p&&X$p!==X$E.stage;)X$m*=X$p.scaleX,X$p=X$p.parent;return X$m}),X$A(0,X$m,"mouseX",function(){return this.getMousePoint().x}),X$A(0,X$m,"mouseY",function(){return this.getMousePoint().y}),X$h.fromImage=function(X$m){return(new X$h).loadImage(X$m)},X$h._cachePool=[],X$h.CustomList=[],X$d(X$h,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=X$k.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),X$h}(X$mm),X$Rm=function(X$m){function X$p(X$m){this._audio=null,this._onEnd=null,this._resumePlay=null,X$p.__super.call(this),this._onEnd=X$g.bind(this.__onEnd,this),this._resumePlay=X$g.bind(this.__resumePlay,this),X$m.addEventListener("ended",this._onEnd),this._audio=X$m}X$D(X$p,"laya.media.h5audio.AudioSoundChannel",X$Pm);var X$h=X$p.prototype;return X$h.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(X$E.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},X$h.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,X$w.container.appendChild(this._audio),this._audio.play()}catch(X$m){this.event("error")}},X$h.play=function(X$m){this.isStopped=!1;try{this._audio.playbackRate=X$x.playbackRate,this._audio.currentTime=this.startTime}catch(X$m){return void this._audio.addEventListener("canplay",this._resumePlay)}X$x.addChannel(this),X$w.container.appendChild(this._audio),!X$m&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},X$h.stop=function(){this.isStopped=!0,X$x.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&X$S.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),X$w.onIE||this._audio!=X$hm._musicAudio&&X$o.recover("audio:"+this.url,this._audio),X$w.removeElement(this._audio),this._audio=null)},X$h.pause=function(){this.isStopped=!0,X$x.removeChannel(this),"pause"in this._audio&&this._audio.pause()},X$h.resume=function(){this._audio&&(this.isStopped=!1,X$x.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},X$A(0,X$h,"position",function(){return this._audio?this._audio.currentTime:0}),X$A(0,X$h,"duration",function(){return this._audio?this._audio.duration:0}),X$A(0,X$h,"volume",function(){return this._audio?this._audio.volume:1},function(X$m){this._audio&&(this._audio.volume=X$m)}),X$p}(),X$$m=function(X$m){function X$p(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=X$qm.ctx,X$p.__super.call(this),this._onPlayEnd=X$g.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}X$D(X$p,"laya.media.webaudio.WebAudioSoundChannel",X$Pm);var X$h=X$p.prototype;return X$h.play=function(X$m){if(X$x.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var X$p=this.context,X$h=this.gain,X$P=X$p.createBufferSource();(this.bufferSource=X$P).buffer=this.audioBuffer,X$P.connect(X$h),X$h&&X$h.disconnect(),X$h.connect(X$p.destination),X$P.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=X$w.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(X$P.loop=!0),X$P.playbackRate.setTargetAtTime?X$P.playbackRate.setTargetAtTime(X$x.playbackRate,this.context.currentTime,.1):X$P.playbackRate.value=X$x.playbackRate,X$P.start(0,this.startTime),!X$m&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},X$h.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(X$E.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},X$h._clearBufferSource=function(){if(this.bufferSource){var X$m=this.bufferSource;X$m.stop?X$m.stop(0):X$m.noteOff(0),X$m.disconnect(0),X$m.onended=null,X$p._tryCleanFailed||this._tryClearBuffer(X$m),this.bufferSource=null}},X$h._tryClearBuffer=function(X$m){try{X$m.buffer=null}catch(X$m){X$p._tryCleanFailed=!0}},X$h.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,X$x.removeChannel(this),this.startHandler=null,this.completeHandler=null},X$h.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,X$x.removeChannel(this)},X$h.resume=function(){this.startTime=this._pauseTime,this.play(!1)},X$A(0,X$h,"position",function(){return this.bufferSource?(X$w.now()-this._startTime)/1e3+this.startTime:0}),X$A(0,X$h,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),X$A(0,X$h,"volume",function(){return this._volume},function(X$m){this.isStopped||(this._volume=X$m,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(X$m,this.context.currentTime,.1):this.gain.gain.value=X$m)}),X$p._tryCleanFailed=!1,X$p}(),X$Am=function(X$m){function X$p(){X$p.__super.call(this),this._w=0,this._h=0}X$D(X$p,"laya.resource.Bitmap",X$Km);var X$h=X$p.prototype;return X$A(0,X$h,"width",function(){return this._w}),X$A(0,X$h,"height",function(){return this._h}),X$A(0,X$h,"source",function(){return this._source}),X$p}(),X$Bm=function(X$p){function X$m(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,X$m.__super.call(this),this._interval=X$P.animationInterval,this._setUpNoticeType(1)}X$D(X$m,"laya.display.AnimationPlayerBase",X$p);var X$h=X$m.prototype;return X$h.play=function(X$m,X$p,X$h,X$P){void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=!0),void 0===X$h&&(X$h=""),void 0===X$P&&(X$P=!0),this._isPlaying=!0,this.index="string"==typeof X$m?this._getFrameByLabel(X$m):X$m,this.loop=X$p,this._actionName=X$h,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},X$h._getFrameByLabel=function(X$m){var X$p=0;for(X$p=0;X$p<this._count;X$p++)if(this._labels[X$p]&&0<=this._labels[X$p].indexOf(X$m))return X$p;return 0},X$h._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},X$h._setControlNode=function(X$m){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=X$m)&&X$m!=this&&(X$m.on("display",this,this._checkResumePlaying),X$m.on("undisplay",this,this._checkResumePlaying))},X$h._setDisplay=function(X$m){X$p.prototype._setDisplay.call(this,X$m),this._checkResumePlaying()},X$h._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},X$h.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},X$h.addLabel=function(X$m,X$p){this._labels||(this._labels={}),this._labels[X$p]||(this._labels[X$p]=[]),this._labels[X$p].push(X$m)},X$h.removeLabel=function(X$m){if(X$m){if(this._labels)for(var X$p in this._labels)this._removeLabelFromLabelList(this._labels[X$p],X$m)}else this._labels=null},X$h._removeLabelFromLabelList=function(X$m,X$p){if(X$m)for(var X$h=X$m.length-1;0<=X$h;X$h--)X$m[X$h]==X$p&&X$m.splice(X$h,1)},X$h.gotoAndStop=function(X$m){this.index="string"==typeof X$m?this._getFrameByLabel(X$m):X$m,this.stop()},X$h._displayToIndex=function(X$m){},X$h.clear=function(){this.stop(),this._labels=null},X$A(0,X$h,"interval",function(){return this._interval},function(X$m){this._interval!=X$m&&(this._frameRateChanged=!0,this._interval=X$m,this._isPlaying&&0<X$m&&this.timerLoop(X$m,this,this._frameLoop,null,!0,!0))}),X$A(0,X$h,"isPlaying",function(){return this._isPlaying}),X$A(0,X$h,"index",function(){return this._index},function(X$m){if(this._index=X$m,this._displayToIndex(X$m),this._labels&&this._labels[X$m])for(var X$p=this._labels[X$m],X$h=0,X$P=X$p.length;X$h<X$P;X$h++)this.event("label",X$p[X$h])}),X$A(0,X$h,"count",function(){return this._count}),X$m.WRAP_POSITIVE=0,X$m.WRAP_REVERSE=1,X$m.WRAP_PINGPONG=2,X$m}(X$Fm),X$nm=function(X$p){function X$$(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,X$$.__super.call(this),this.overflow=X$$.VISIBLE,this._style=new X$pm(this),this._style.wordWrap=!1}X$D(X$$,"laya.display.Text",X$p);var X$m=X$$.prototype;return X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,X$m),this._lines=null,this._words&&(this._words.length=0,this._words=null)},X$m._getBoundPointsM=function(X$m){void 0===X$m&&(X$m=!1);var X$p=X$b.TEMP;return X$p.setTo(0,0,this.width,this.height),X$p._getBoundPoints()},X$m.getGraphicBounds=function(X$m){void 0===X$m&&(X$m=!1);var X$p=X$b.TEMP;return X$p.setTo(0,0,this.width,this.height),X$p},X$m._getCSSStyle=function(){return this._style},X$m.lang=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D){if(X$m=X$$.langPacks&&X$$.langPacks[X$m]?X$$.langPacks[X$m]:X$m,arguments.length<2)this._text=X$m;else{for(var X$F=0,X$R=arguments.length;X$F<X$R;X$F++)X$m=X$m.replace("{"+X$F+"}",arguments[X$F+1]);this._text=X$m}},X$m._isPassWordMode=function(){var X$m=this._style.password;return"prompt"in this&&this.prompt==this._text&&(X$m=!1),X$m},X$m._getPassWordTxt=function(X$m){var X$p;X$p="";for(var X$h=X$m.length;0<X$h;X$h--)X$p+="●";return X$p},X$m.renderText=function(X$m,X$p){var X$h=this.graphics;X$h.clear(!0);var X$P=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(X$w.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);X$w.context.font=X$P;var X$L=this.padding,X$q=X$L[3],X$k="left",X$Y=this._lines,X$d=this.leading+this._charSize.height,X$K=this._currBitmapFont;X$K&&(X$d=this.leading+X$K.getMaxHeight());var X$D=X$L[0];if(!X$K&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(X$k="right",X$q=this._width-X$L[1]):"center"==this.align&&(X$k="center",X$q=.5*this._width+X$L[3]-X$L[1])),0<this._height){var X$F=this._textHeight>this._height?"top":this.valign;"middle"===X$F?X$D=.5*(this._height-X$p*X$d)+X$L[0]-X$L[2]:"bottom"===X$F&&(X$D=this._height-X$p*X$d-X$L[2])}var X$R=this._style;if(X$K&&X$K.autoScaleSize)var X$$=X$K.fontSize/this.fontSize;if(this._clipPoint)if(X$h.save(),X$K&&X$K.autoScaleSize){var X$A=0,X$B=0;X$A=this._width?this._width-X$L[3]-X$L[1]:this._textWidth,X$B=this._height?this._height-X$L[0]-X$L[2]:this._textHeight,X$A*=X$$,X$B*=X$$,X$h.clipRect(X$L[3],X$L[0],X$A,X$B)}else X$h.clipRect(X$L[3],X$L[0],this._width?this._width-X$L[3]-X$L[1]:this._textWidth,this._height?this._height-X$L[0]-X$L[2]:this._textHeight);var X$n=X$R.password;"prompt"in this&&this.prompt==this._text&&(X$n=!1);for(var X$c=0,X$e=0,X$a=Math.min(this._lines.length,X$p+X$m)||1,X$Z=X$m;X$Z<X$a;X$Z++){var X$H,X$W=X$Y[X$Z];if(X$n){var X$E=X$W.length;X$W="";for(var X$I=X$E;0<X$I;X$I--)X$W+="●"}if(X$c=X$q-(this._clipPoint?this._clipPoint.x:0),X$e=X$D+X$d*X$Z-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(X$k,X$c,X$e,X$Z),X$K){var X$b=this.width;X$K.autoScaleSize&&(X$b=this.width*X$$),X$K.drawText(X$W,this,X$c,X$e,this.align,X$b)}else X$S.isWebGL?(this._words||(this._words=[]),(X$H=this._words.length>X$Z-X$m?this._words[X$Z-X$m]:new X$C).setText(X$W)):X$H=X$W,X$R.stroke?X$h.fillBorderText(X$H,X$c,X$e,X$P,this.color,X$R.strokeColor,X$R.stroke,X$k):X$h.fillText(X$H,X$c,X$e,X$P,this.color,X$k)}if(X$K&&X$K.autoScaleSize){var X$T=1/X$$;this.scale(X$T,X$T)}this._clipPoint&&X$h.restore(),this._startX=X$q,this._startY=X$D},X$m.drawUnderline=function(X$m,X$p,X$h,X$P){var X$L=this._lineWidths[X$P];switch(X$m){case"center":X$p-=X$L/2;break;case"right":X$p-=X$L}X$h+=this._charSize.height,this._graphics.drawLine(X$p,X$h,X$p+X$L,X$h,this.underlineColor||this.color,1)},X$m.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);X$w.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new X$I(0,0)):this._clipPoint=null;var X$m=this._lines.length;if(this.overflow!=X$$.VISIBLE){var X$p=this.overflow==X$$.HIDDEN?Math.floor:Math.ceil;X$m=Math.min(X$m,X$p((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var X$h=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(X$h,X$m),this.repaint()},X$m.evalTextSize=function(){var X$m,X$p=NaN;X$m=Math.max.apply(this,this._lineWidths),X$p=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],X$m==this._textWidth&&X$p==this._textHeight||(this._textWidth=X$m,this._textHeight=X$p,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},X$m.checkEnabledViewportOrNot=function(){return this.overflow==X$$.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},X$m.changeText=function(X$m){this._text!==X$m&&(this.lang(X$m+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},X$m.parseLines=function(X$m){var X$p=this.wordWrap||this.overflow==X$$.HIDDEN;if(X$p)var X$h=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var X$P=X$g.contextMeasureText(X$$._testWord);X$S.isConchApp&&0===X$P.width&&0===X$P.height&&(X$P=X$g.contextMeasureText("W")),this._charSize.width=X$P.width,this._charSize.height=X$P.height||this.fontSize}for(var X$L=X$m.replace(/\r\n/g,"\n").split("\n"),X$q=0,X$k=X$L.length;X$q<X$k;X$q++){var X$Y=X$L[X$q];X$p?this.parseLine(X$Y,X$h):(this._lineWidths.push(this.getTextWidth(X$Y)),this._lines.push(X$Y))}},X$m.parseLine=function(X$m,X$p){X$w.context;var X$h,X$P=this._lines,X$L=0,X$q=NaN,X$k=NaN,X$Y=0;if((X$q=this.getTextWidth(X$m))<=X$p)return X$P.push(X$m),void this._lineWidths.push(X$q);X$q=this._charSize.width,0==(X$L=Math.floor(X$p/X$q))&&(X$L=1),X$k=X$q=this.getTextWidth(X$m.substring(0,X$L));for(var X$d=X$L,X$K=X$m.length;X$d<X$K;X$d++)if(X$p<(X$k+=X$q=this.getTextWidth(X$m.charAt(X$d))))if(this.wordWrap){var X$D=X$m.substring(X$Y,X$d);if(X$D.charCodeAt(X$D.length-1)<255?(X$h=/(?:\w|-)+$/.exec(X$D))&&(X$d=X$h.index+X$Y,0==X$h.index?X$d+=X$D.length:X$D=X$m.substring(X$Y,X$d)):X$$.RightToLeft&&(X$h=/([\u0600-\u06FF])+$/.exec(X$D))&&(X$d=X$h.index+X$Y,0==X$h.index?X$d+=X$D.length:X$D=X$m.substring(X$Y,X$d)),X$P.push(X$D),this._lineWidths.push(X$k-X$q),!((X$Y=X$d)+X$L<X$K)){X$P.push(X$m.substring(X$Y,X$K)),this._lineWidths.push(this.getTextWidth(X$P[X$P.length-1])),X$Y=-1;break}X$d+=X$L,X$k=X$q=this.getTextWidth(X$m.substring(X$Y,X$d)),X$d--}else if(this.overflow==X$$.HIDDEN)return X$P.push(X$m.substring(0,X$d)),void this._lineWidths.push(this.getTextWidth(X$P[X$P.length-1]));this.wordWrap&&-1!=X$Y&&(X$P.push(X$m.substring(X$Y,X$K)),this._lineWidths.push(this.getTextWidth(X$P[X$P.length-1])))},X$m.getTextWidth=function(X$m){return this._currBitmapFont?this._currBitmapFont.getTextWidth(X$m):X$g.contextMeasureText(X$m).width},X$m.getWordWrapWidth=function(){var X$m=this.padding,X$p=NaN;return(X$p=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(X$p=this.wordWrap?100:X$w.width),X$p<=0&&(X$p=100),X$p-X$m[3]-X$m[1]},X$m.getCharPoint=function(X$m,X$p){this._isChanged&&X$E.timer.runCallLater(this,this.typeset);for(var X$h=0,X$P=this._lines,X$L=0,X$q=0,X$k=X$P.length;X$q<X$k;X$q++){if(X$m<(X$h+=X$P[X$q].length)){var X$Y=X$q;break}X$L=X$h}var X$d=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;X$w.context.font=X$d;var X$K=this.getTextWidth(this._text.substring(X$L,X$m));return(X$p||new X$I).setTo(this._startX+X$K-(this._clipPoint?this._clipPoint.x:0),this._startY+X$Y*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},X$A(0,X$m,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(X$m){X$m!=this._width&&(X$E.superSet(X$Fm,this,"width",X$m),this.isChanged=!0)}),X$A(0,X$m,"textWidth",function(){return this._isChanged&&X$E.timer.runCallLater(this,this.typeset),this._textWidth}),X$A(0,X$m,"height",function(){return this._height?this._height:this.textHeight},function(X$m){X$m!=this._height&&(X$E.superSet(X$Fm,this,"height",X$m),this.isChanged=!0)}),X$A(0,X$m,"textHeight",function(){return this._isChanged&&X$E.timer.runCallLater(this,this.typeset),this._textHeight}),X$A(0,X$m,"padding",function(){return this._getCSSStyle().padding},function(X$m){this._getCSSStyle().padding=X$m,this.isChanged=!0}),X$A(0,X$m,"bold",function(){return this._getCSSStyle().bold},function(X$m){this._getCSSStyle().bold=X$m,this.isChanged=!0}),X$A(0,X$m,"text",function(){return this._text||""},function(X$m){this._text!==X$m&&(this.lang(X$m+""),this.isChanged=!0,this.event("change"))}),X$A(0,X$m,"color",function(){return this._getCSSStyle().color},function(X$m){this._getCSSStyle().color!=X$m&&(this._getCSSStyle().color=X$m,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),X$A(0,X$m,"font",function(){return this._getCSSStyle().fontFamily},function(X$m){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),X$$._bitmapFonts&&X$$._bitmapFonts[X$m]&&(this._currBitmapFont=X$$._bitmapFonts[X$m]),this._getCSSStyle().fontFamily=X$m,this.isChanged=!0}),X$A(0,X$m,"fontSize",function(){return this._getCSSStyle().fontSize},function(X$m){this._getCSSStyle().fontSize=X$m,this.isChanged=!0}),X$A(0,X$m,"italic",function(){return this._getCSSStyle().italic},function(X$m){this._getCSSStyle().italic=X$m,this.isChanged=!0}),X$A(0,X$m,"align",function(){return this._getCSSStyle().align},function(X$m){this._getCSSStyle().align=X$m,this.isChanged=!0}),X$A(0,X$m,"valign",function(){return this._getCSSStyle().valign},function(X$m){this._getCSSStyle().valign=X$m,this.isChanged=!0}),X$A(0,X$m,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(X$m){this._getCSSStyle().wordWrap=X$m,this.isChanged=!0}),X$A(0,X$m,"leading",function(){return this._getCSSStyle().leading},function(X$m){this._getCSSStyle().leading=X$m,this.isChanged=!0}),X$A(0,X$m,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(X$m){this._getCSSStyle().backgroundColor=X$m,this.isChanged=!0}),X$A(0,X$m,"borderColor",function(){return this._getCSSStyle().borderColor},function(X$m){this._getCSSStyle().borderColor=X$m,this.isChanged=!0}),X$A(0,X$m,"stroke",function(){return this._getCSSStyle().stroke},function(X$m){this._getCSSStyle().stroke=X$m,this.isChanged=!0}),X$A(0,X$m,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(X$m){this._getCSSStyle().strokeColor=X$m,this.isChanged=!0}),X$A(0,X$m,"isChanged",null,function(X$m){this._isChanged!==X$m&&(this._isChanged=X$m)&&X$E.timer.callLater(this,this.typeset)}),X$A(0,X$m,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(X$m){if(!(this.overflow!=X$$.SCROLL||this.textWidth<this._width)&&this._clipPoint){X$m=X$m<this.padding[3]?this.padding[3]:X$m;var X$p=this._textWidth-this._width;X$m=X$p<X$m?X$p:X$m;var X$h=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=X$m,this.renderText(this._lastVisibleLineIndex,X$h)}}),X$A(0,X$m,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(X$m){if(!(this.overflow!=X$$.SCROLL||this.textHeight<this._height)&&this._clipPoint){X$m=X$m<this.padding[0]?this.padding[0]:X$m;var X$p=this._textHeight-this._height,X$h=(X$m=X$p<X$m?X$p:X$m)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=X$h;var X$P=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=X$m,this.renderText(X$h,X$P)}}),X$A(0,X$m,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),X$A(0,X$m,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),X$A(0,X$m,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),X$A(0,X$m,"underlineColor",function(){return this._underlineColor},function(X$m){this._underlineColor=X$m,this._isChanged=!0,this.typeset()}),X$$.registerBitmapFont=function(X$m,X$p){X$$._bitmapFonts||(X$$._bitmapFonts={}),X$$._bitmapFonts[X$m]=X$p},X$$.unregisterBitmapFont=function(X$m,X$p){if(void 0===X$p&&(X$p=!0),X$$._bitmapFonts&&X$$._bitmapFonts[X$m]){var X$h=X$$._bitmapFonts[X$m];X$p&&X$h.destroy(),delete X$$._bitmapFonts[X$m]}},X$$.setTextRightToLeft=function(){var X$m;(X$m=X$w.canvas.source.style).display="none",X$m.position="absolute",X$m.direction="rtl",X$S._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,X$w.document.body.appendChild(X$w.canvas.source)},X$$.supportFont=function(X$m){X$w.context.font="10px sans-serif";var X$p=X$g.contextMeasureText("abcji").width;X$w.context.font="10px "+X$m;var X$h=X$g.contextMeasureText("abcji").width;return console.log(X$p,X$h),X$p!==X$h},X$$._testWord="游",X$$.langPacks=null,X$$.VISIBLE="visible",X$$.SCROLL="scroll",X$$.HIDDEN="hidden",X$$.CharacterCache=!0,X$$.RightToLeft=!1,X$$._bitmapFonts=null,X$d(X$$,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),X$$}(X$Fm),X$cm=function(X$F){function X$k(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",X$k.__super.call(this),this.offset=new X$I,this._canvasTransform=new X$M,this._previousOrientation=X$w.window.orientation;var X$p=this;this.transform=X$M.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var X$m=X$w.window,X$h=this;X$m.addEventListener("focus",function(){X$p._isFocused=!0,X$h.event("focus"),X$h.event("focuschange")}),X$m.addEventListener("blur",function(){X$p._isFocused=!1,X$h.event("blur"),X$h.event("focuschange"),X$h._isInputting()&&(X$Hm.inputElement.target.focus=!1)});var X$P="visibilityState",X$L="visibilitychange",X$q=X$m.document;void 0!==X$q.hidden?(X$L="visibilitychange",X$P="visibilityState"):void 0!==X$q.mozHidden?(X$L="mozvisibilitychange",X$P="mozVisibilityState"):void 0!==X$q.msHidden?(X$L="msvisibilitychange",X$P="msVisibilityState"):void 0!==X$q.webkitHidden&&(X$L="webkitvisibilitychange",X$P="webkitVisibilityState"),X$m.document.addEventListener(X$L,function(){"hidden"==X$w.document[X$P]?X$h._setStageVisible(!1):X$h._setStageVisible(!0)}),X$m.document.addEventListener("qbrowserVisibilityChange",function(X$m){X$h._setStageVisible(!X$m.hidden)}),X$m.addEventListener("resize",function(){var X$m=X$w.window.orientation;null!=X$m&&X$m!=X$p._previousOrientation&&X$h._isInputting()&&(X$Hm.inputElement.target.focus=!1),X$p._previousOrientation=X$m,X$h._isInputting()||X$h._resetCanvas()}),X$m.addEventListener("orientationchange",function(X$m){X$h._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),X$w.onMobile&&this.on("mousedown",this,this._onmouseMove)}X$D(X$k,"laya.display.Stage",X$F);var X$m=X$k.prototype;return X$m._setStageVisible=function(X$m){this._isVisibility!=X$m&&(this._isVisibility=X$m,this._isVisibility||this._isInputting()&&(X$Hm.inputElement.target.focus=!1),this.event("visibilitychange"))},X$m._isInputting=function(){return X$w.onMobile&&X$Hm.isInputting},X$m._changeCanvasSize=function(){this.setScreenSize(X$w.clientWidth*X$w.pixelRatio,X$w.clientHeight*X$w.pixelRatio)},X$m._resetCanvas=function(){if(this.screenAdaptationEnabled){var X$m=X$S._mainCanvas;X$m.source.style;X$m.size(1,1),X$E.timer.once(100,this,this._changeCanvasSize)}},X$m.setScreenSize=function(X$m,X$p){var X$h=!1;if("none"!==this._screenMode&&(X$h=(X$m/X$p<1?"vertical":"horizontal")!==this._screenMode)){var X$P=X$p;X$p=X$m,X$m=X$P}this.canvasRotation=X$h;var X$L=X$S._mainCanvas,X$q=X$L.source.style,X$k=this._canvasTransform.identity(),X$Y=this._scaleMode,X$d=X$m/this.designWidth,X$K=X$p/this.designHeight,X$D=this.designWidth,X$F=this.designHeight,X$R=X$m,X$$=X$p,X$A=X$w.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,X$Y){case"noscale":X$d=X$K=1,X$R=this.designWidth,X$$=this.designHeight;break;case"showall":X$d=X$K=Math.min(X$d,X$K),X$D=X$R=Math.round(this.designWidth*X$d),X$F=X$$=Math.round(this.designHeight*X$K);break;case"noborder":X$d=X$K=Math.max(X$d,X$K),X$R=Math.round(this.designWidth*X$d),X$$=Math.round(this.designHeight*X$K);break;case"full":X$d=X$K=1,this._width=X$D=X$m,this._height=X$F=X$p;break;case"fixedwidth":X$K=X$d,this._height=X$F=Math.round(X$p/X$d);break;case"fixedheight":X$d=X$K,this._width=X$D=Math.round(X$m/X$K);break;case"fixedauto":X$m/X$p<this.designWidth/this.designHeight?(X$K=X$d,this._height=X$F=Math.round(X$p/X$d)):(X$d=X$K,this._width=X$D=Math.round(X$m/X$K))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,X$D=X$D+1&2147483646,X$F=X$F+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),X$d*=this.scaleX,X$K*=this.scaleY,1===X$d&&1===X$K?this.transform.identity():(this.transform.a=this._formatData(X$d/(X$R/X$D)),this.transform.d=this._formatData(X$K/(X$$/X$F)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),X$L.size(X$D,X$F),X$Q.changeWebGLSize(X$D,X$F),X$k.scale(X$R/X$D/X$A,X$$/X$F/X$A),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(X$m-X$R)/X$A:this.offset.x=.5*(X$m-X$R)/X$A,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(X$p-X$$)/X$A:this.offset.y=.5*(X$p-X$$)/X$A,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),X$k.translate(this.offset.x,this.offset.y),this.canvasDegree=0,X$h&&("horizontal"===this._screenMode?(X$k.rotate(Math.PI/2),X$k.translate(X$p/X$A,0),this.canvasDegree=90):(X$k.rotate(-Math.PI/2),X$k.translate(0,X$m/X$A),this.canvasDegree=-90)),X$k.a=this._formatData(X$k.a),X$k.d=this._formatData(X$k.d),X$k.tx=this._formatData(X$k.tx),X$k.ty=this._formatData(X$k.ty),X$q.transformOrigin=X$q.webkitTransformOrigin=X$q.msTransformOrigin=X$q.mozTransformOrigin=X$q.oTransformOrigin="0px 0px 0px",X$q.transform=X$q.webkitTransform=X$q.msTransform=X$q.mozTransform=X$q.oTransform="matrix("+X$k.toString()+")",X$k.translate(parseInt(X$q.left)||0,parseInt(X$q.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},X$m._formatData=function(X$m){return Math.abs(X$m)<1e-6?0:Math.abs(1-X$m)<.001?0<X$m?1:-1:X$m},X$m.getMousePoint=function(){return X$I.TEMP.setTo(this.mouseX,this.mouseY)},X$m.repaint=function(){this._repaint=1},X$m.parentRepaint=function(){},X$m._loop=function(){return this.render(X$S.context,0,0),!0},X$m._onmouseMove=function(X$m){this._mouseMoveTime=X$w.now()},X$m.getTimeFromFrameStart=function(){return X$w.now()-this._frameStartTime},X$m.render=function(X$m,X$p,X$h){if("sleep"===this._frameRate&&!X$S.isConchApp){var X$P=X$w.now();if(!(1e3<=X$P-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(X$f.loopCount++,X$B.instance.runEvent(),X$E.timer._update()));this._frameStartTime=X$P}if(this._renderCount++,X$S.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=X$w.now();var X$L="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),X$q=this._renderCount%2==0;if(X$f.renderSlow=!X$L,X$L||X$q||X$S.isConchApp){var X$k;X$f.loopCount++,X$B.instance.runEvent(),X$E.timer._update(),X$Q.update3DLoop();var X$Y=0,X$d=0;if(X$S.isConchNode)for(X$Y=0,X$d=this._scenes.length;X$Y<X$d;X$Y++)(X$k=this._scenes[X$Y])&&X$k._updateSceneConch();else for(X$Y=0,X$d=this._scenes.length;X$Y<X$d;X$Y++)(X$k=this._scenes[X$Y])&&X$k._updateScene();if(X$S.isConchNode){var X$K=X$Fm.CustomList;for(X$Y=0,X$d=X$K.length;X$Y<X$d;X$Y++){var X$D=X$K[X$Y];X$D.customRender(X$D.customContext,0,0)}return}}X$S.isConchNode||this.renderingEnabled&&(X$L||!X$q||X$S.isConchWebGL)&&(X$S.isWebGL?X$S.WebGL.mainContext&&!X$S.WebGL.mainContext.isContextLost()&&(X$m.clear(),X$F.prototype.render.call(this,X$m,X$p,X$h),X$f._show&&X$f._sp&&X$f._sp.render(X$m,X$p,X$h),X$Q.clear(this._bgColor),X$Q.beginFlush(),X$m.flush(),X$Q.endFinish(),X$t.instance&&X$t.getInstance().endDispose()):(X$Q.clear(this._bgColor),X$F.prototype.render.call(this,X$m,X$p,X$h),X$f._show&&X$f._sp&&X$f._sp.render(X$m,X$p,X$h)))}else this._renderCount%5==0&&(X$f.loopCount++,X$B.instance.runEvent(),X$E.timer._update())},X$m._requestFullscreen=function(){var X$m=X$w.document.documentElement;X$m.requestFullscreen?X$m.requestFullscreen():X$m.mozRequestFullScreen?X$m.mozRequestFullScreen():X$m.webkitRequestFullscreen?X$m.webkitRequestFullscreen():X$m.msRequestFullscreen&&X$m.msRequestFullscreen()},X$m._fullScreenChanged=function(){X$E.stage.event("fullscreenchange")},X$m.exitFullscreen=function(){var X$m=X$w.document;X$m.exitFullscreen?X$m.exitFullscreen():X$m.mozCancelFullScreen?X$m.mozCancelFullScreen():X$m.webkitExitFullscreen&&X$m.webkitExitFullscreen()},X$A(0,X$m,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),X$A(0,X$m,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),X$A(0,X$m,"frameRate",function(){return this._frameRate},function(X$m){if(this._frameRate=X$m,X$S.isConchApp)switch(this._frameRate){case"slow":X$w.window.conch&&X$w.window.conchConfig.setSlowFrame&&X$w.window.conchConfig.setSlowFrame(!0);break;case"fast":X$w.window.conch&&X$w.window.conchConfig.setSlowFrame&&X$w.window.conchConfig.setSlowFrame(!1);break;case"mouse":X$w.window.conch&&X$w.window.conchConfig.setMouseFrame&&X$w.window.conchConfig.setMouseFrame(2e3);break;case"sleep":X$w.window.conch&&X$w.window.conchConfig.setLimitFPS&&X$w.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),X$A(0,X$m,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),X$A(0,X$m,"width",X$F.prototype._$get_width,function(X$m){this.designWidth=X$m,X$E.superSet(X$Fm,this,"width",X$m),X$E.timer.callLater(this,this._changeCanvasSize)}),X$A(0,X$m,"alignH",function(){return this._alignH},function(X$m){this._alignH=X$m,X$E.timer.callLater(this,this._changeCanvasSize)}),X$A(0,X$m,"isFocused",function(){return this._isFocused}),X$A(0,X$m,"height",X$F.prototype._$get_height,function(X$m){this.designHeight=X$m,X$E.superSet(X$Fm,this,"height",X$m),X$E.timer.callLater(this,this._changeCanvasSize)}),X$A(0,X$m,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||X$M.create()},X$F.prototype._$set_transform),X$A(0,X$m,"isVisibility",function(){return this._isVisibility}),X$A(0,X$m,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),X$A(0,X$m,"scaleMode",function(){return this._scaleMode},function(X$m){this._scaleMode=X$m,X$E.timer.callLater(this,this._changeCanvasSize)}),X$A(0,X$m,"alignV",function(){return this._alignV},function(X$m){this._alignV=X$m,X$E.timer.callLater(this,this._changeCanvasSize)}),X$A(0,X$m,"bgColor",function(){return this._bgColor},function(X$m){this._bgColor=X$m,this.conchModel&&this.conchModel.bgColor(X$m),X$S.isWebGL&&(X$m?X$k._wgColor=X$U.create(X$m)._color:X$w.onMiniGame||(X$k._wgColor=null)),X$w.onLimixiu?X$k._wgColor=X$U.create(X$m)._color:X$S.canvas.style.background=X$m||"none"}),X$A(0,X$m,"mouseX",function(){return Math.round(X$B.instance.mouseX/this.clientScaleX)}),X$A(0,X$m,"mouseY",function(){return Math.round(X$B.instance.mouseY/this.clientScaleY)}),X$A(0,X$m,"screenMode",function(){return this._screenMode},function(X$m){this._screenMode=X$m}),X$A(0,X$m,"visible",X$F.prototype._$get_visible,function(X$m){this.visible!==X$m&&(X$E.superSet(X$Fm,this,"visible",X$m),X$S._mainCanvas.source.style.visibility=X$m?"visible":"hidden")}),X$A(0,X$m,"fullScreenEnabled",null,function(X$m){var X$p=X$w.document,X$h=X$S.canvas;X$m?(X$h.addEventListener("mousedown",this._requestFullscreen),X$h.addEventListener("touchstart",this._requestFullscreen),X$p.addEventListener("fullscreenchange",this._fullScreenChanged),X$p.addEventListener("mozfullscreenchange",this._fullScreenChanged),X$p.addEventListener("webkitfullscreenchange",this._fullScreenChanged),X$p.addEventListener("msfullscreenchange",this._fullScreenChanged)):(X$h.removeEventListener("mousedown",this._requestFullscreen),X$h.removeEventListener("touchstart",this._requestFullscreen),X$p.removeEventListener("fullscreenchange",this._fullScreenChanged),X$p.removeEventListener("mozfullscreenchange",this._fullScreenChanged),X$p.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),X$p.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),X$k.SCALE_NOSCALE="noscale",X$k.SCALE_EXACTFIT="exactfit",X$k.SCALE_SHOWALL="showall",X$k.SCALE_NOBORDER="noborder",X$k.SCALE_FULL="full",X$k.SCALE_FIXED_WIDTH="fixedwidth",X$k.SCALE_FIXED_HEIGHT="fixedheight",X$k.SCALE_FIXED_AUTO="fixedauto",X$k.ALIGN_LEFT="left",X$k.ALIGN_RIGHT="right",X$k.ALIGN_CENTER="center",X$k.ALIGN_TOP="top",X$k.ALIGN_MIDDLE="middle",X$k.ALIGN_BOTTOM="bottom",X$k.SCREEN_NONE="none",X$k.SCREEN_HORIZONTAL="horizontal",X$k.SCREEN_VERTICAL="vertical",X$k.FRAME_FAST="fast",X$k.FRAME_SLOW="slow",X$k.FRAME_MOUSE="mouse",X$k.FRAME_SLEEP="sleep",X$k.FRAME_MOUSE_THREDHOLD=2e3,X$d(X$k,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),X$k}(X$Fm),X$em=(function(X$m){function X$p(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,X$p.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}X$D(X$p,"laya.media.SoundNode",X$Fm);var X$h=X$p.prototype;X$h._onParentChange=function(){this.target=this.parent},X$h.play=function(X$m,X$p){void 0===X$m&&(X$m=1),isNaN(X$m)&&(X$m=1),this.url&&(this.stop(),this._channel=X$x.playSound(this.url,X$m,null,X$p))},X$h.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},X$h._setPlayAction=function(X$m,X$p,X$h,X$P){void 0===X$P&&(X$P=!0),this[X$h]&&X$m&&(X$P?X$m.on(X$p,this,this[X$h]):X$m.off(X$p,this,this[X$h]))},X$h._setPlayActions=function(X$m,X$p,X$h,X$P){if(void 0===X$P&&(X$P=!0),X$m&&X$p){var X$L,X$q=X$p.split(","),X$k=0;for(X$L=X$q.length,X$k=0;X$k<X$L;X$k++)this._setPlayAction(X$m,X$q[X$k],X$h,X$P)}},X$A(0,X$h,"playEvent",null,function(X$m){(this._playEvents=X$m)&&this._tar&&this._setPlayActions(this._tar,X$m,"play")}),X$A(0,X$h,"target",null,function(X$m){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=X$m,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),X$A(0,X$h,"stopEvent",null,function(X$m){(this._stopEvents=X$m)&&this._tar&&this._setPlayActions(this._tar,X$m,"stop")})}(),function(X$m){function X$p(){this._src=null,this._onload=null,this._onerror=null,X$p.__super.call(this)}X$D(X$p,"laya.resource.FileBitmap",X$Am);var X$h=X$p.prototype;return X$A(0,X$h,"src",function(){return this._src},function(X$m){this._src=X$m}),X$A(0,X$h,"onload",null,function(X$m){}),X$A(0,X$h,"onerror",null,function(X$m){}),X$p}()),X$am=function(X$m){function X$h(X$m,X$p){this._is2D=!1,X$h.__super.call(this);var X$P=this;if(this._source=this,"2D"===X$m||"AUTO"===X$m&&!X$S.isWebGL){this._is2D=!0,this._source=X$p||X$w.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var X$L=this;X$L.getContext=function(X$m,X$p){if(X$P._ctx)return X$P._ctx;var X$h=X$P._ctx=X$P._source.getContext(X$m,X$p);return X$h&&(X$h._canvas=X$L,X$S.isFlash||X$w.onLimixiu||(X$h.size=function(X$m,X$p){})),X$h}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}X$D(X$h,"laya.resource.HTMLCanvas",X$Am);var X$p=X$h.prototype;return X$p.clear=function(){this._ctx&&this._ctx.clear()},X$p.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},X$p.release=function(){},X$p._setContext=function(X$m){this._ctx=X$m},X$p.getContext=function(X$m,X$p){return this._ctx?this._ctx:this._ctx=X$h._createContext(this)},X$p.getMemSize=function(){return 0},X$p.size=function(X$m,X$p){(this._w!=X$m||this._h!=X$p||this._source&&(this._source.width!=X$m||this._source.height!=X$p))&&(this._w=X$m,this._h=X$p,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(X$m,X$p),this._source&&(this._source.height=X$p,this._source.width=X$m))},X$p.getCanvas=function(){return this._source},X$p.toBase64=function(X$m,X$p,X$h){if(this._source)if(X$S.isConchApp&&this._source.toBase64)this._source.toBase64(X$m,X$p,X$h);else{var X$P=this._source.toDataURL(X$m,X$p);X$h.call(this,X$P)}},X$A(0,X$p,"context",function(){return this._ctx}),X$A(0,X$p,"asBitmap",null,function(X$m){}),X$h.create=function(X$m,X$p){return new X$h(X$m,X$p)},X$h.TYPE2D="2D",X$h.TYPE3D="3D",X$h.TYPEAUTO="AUTO",X$h._createContext=null,X$h}(),X$Zm=(function(X$m){function X$d(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){throw X$d.__super.call(this),new Error("不允许new！")}X$D(X$d,"laya.resource.HTMLSubImage",X$Am),X$d.create=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){return void 0===X$Y&&(X$Y=!1),new X$d(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y)}}(),function(X$m){function X$F(){this._frames=null,this._url=null,X$F.__super.call(this),this._setControlNode(this)}X$D(X$F,"laya.display.Animation",X$m);var X$p=X$F.prototype;X$p.destroy=function(X$m){void 0===X$m&&(X$m=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,X$m),this._frames=null,this._labels=null},X$p.play=function(X$m,X$p,X$h,X$P){void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=!0),void 0===X$h&&(X$h=""),void 0===X$P&&(X$P=!0),X$h&&this._setFramesFromCache(X$h,X$P),this._isPlaying=!0,this.index="string"==typeof X$m?this._getFrameByLabel(X$m):X$m,this.loop=X$p,this._actionName=X$h,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},X$p._setFramesFromCache=function(X$m,X$p){var X$h;return void 0===X$p&&(X$p=!1),this._url&&(X$m=this._url+"#"+X$m),X$m&&X$F.framesMap[X$m]?((X$h=X$F.framesMap[X$m])instanceof Array?(this._frames=X$F.framesMap[X$m],this._count=this._frames.length):(X$h.nodeRoot&&(X$F.framesMap[X$m]=this._parseGraphicAnimationByData(X$h),X$h=X$F.framesMap[X$m]),this._frames=X$h.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=X$h.interval),this._labels=this._copyLabels(X$h.labels)),!0):(X$p&&console.log("ani not found:",X$m),!1)},X$p._copyLabels=function(X$m){if(!X$m)return null;var X$p,X$h;for(X$h in X$p={},X$m)X$p[X$h]=X$g.copyArray([],X$m[X$h]);return X$p},X$p._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&X$m.prototype._frameLoop.call(this)},X$p._displayToIndex=function(X$m){this._frames&&(this.graphics=this._frames[X$m])},X$p.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},X$p.loadImages=function(X$m,X$p){return void 0===X$p&&(X$p=""),this._url="",this._setFramesFromCache(X$p)||(this.frames=X$F.framesMap[X$p]?X$F.framesMap[X$p]:X$F.createFrames(X$m,X$p)),this},X$p.loadAtlas=function(X$p,X$h,X$P){void 0===X$P&&(X$P=""),this._url="";var X$L=this;function X$m(X$m){X$p===X$m&&(X$L.frames=X$F.framesMap[X$P]?X$F.framesMap[X$P]:X$F.createFrames(X$p,X$P),X$h&&X$h.run())}return X$L._setFramesFromCache(X$P)||(X$Ym.getAtlas(X$p)?X$m(X$p):X$E.loader.load(X$p,X$e.create(null,X$m,[X$p]),null,"atlas")),this},X$p.loadAnimation=function(X$m,X$p,X$h){this._url=X$m;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,X$p&&X$p.run()):!X$h||X$Ym.getAtlas(X$h)?this._loadAnimationData(X$m,X$p,X$h):X$E.loader.load(X$h,X$e.create(this,this._loadAnimationData,[X$m,X$p,X$h]),null,"atlas"),this},X$p._loadAnimationData=function(X$Y,X$d,X$m){var X$K=this;if(!X$m||X$Ym.getAtlas(X$m)){var X$D=this;X$Ym.getRes(X$Y)?X$p(X$Y):X$E.loader.load(X$Y,X$e.create(null,X$p,[X$Y]),null,"json"),X$Ym.clearRes(X$Y)}else console.warn("atlas load fail:"+X$m);function X$p(X$m){if(X$Ym.getRes(X$m)&&X$Y===X$m){var X$p;if(X$F.framesMap[X$Y+"#"])X$D._setFramesFromCache(X$K._actionName,!0),X$K.index=0,X$K._checkResumePlaying();else{var X$h=X$D._parseGraphicAnimation(X$Ym.getRes(X$Y));if(!X$h)return;var X$P,X$L=X$h.animationList,X$q=0,X$k=X$L.length;for(X$q=0;X$q<X$k;X$q++)X$p=X$L[X$q],X$F.framesMap[X$Y+"#"+X$p.name]=X$p,X$P||(X$P=X$p);X$P&&(X$F.framesMap[X$Y+"#"]=X$P,X$D._setFramesFromCache(X$K._actionName,!0),X$K.index=0),X$K._checkResumePlaying()}X$d&&X$d.run()}}},X$p._parseGraphicAnimation=function(X$m){return X$Em.parseAnimationData(X$m)},X$p._parseGraphicAnimationByData=function(X$m){return X$Em.parseAnimationByData(X$m)},X$A(0,X$p,"frames",function(){return this._frames},function(X$m){(this._frames=X$m)&&(this._count=X$m.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),X$A(0,X$p,"autoPlay",null,function(X$m){X$m?this.play():this.stop()}),X$A(0,X$p,"source",null,function(X$m){-1<X$m.indexOf(".ani")?this.loadAnimation(X$m):-1<X$m.indexOf(".json")||-1<X$m.indexOf("als")||-1<X$m.indexOf("atlas")?this.loadAtlas(X$m):this.loadImages(X$m.split(","))}),X$A(0,X$p,"autoAnimation",null,function(X$m){this.play(0,!0,X$m,!1)}),X$F.createFrames=function(X$m,X$p){var X$h,X$P,X$L=0,X$q=0;if("string"==typeof X$m){var X$k=X$Ym.getAtlas(X$m);if(X$k&&X$k.length)for(X$h=[],X$L=0,X$q=X$k.length;X$L<X$q;X$L++)(X$P=new X$Q.createGraphics).drawTexture(X$Ym.getRes(X$k[X$L]),0,0),X$h.push(X$P)}else if(X$m instanceof Array)for(X$h=[],X$L=0,X$q=X$m.length;X$L<X$q;X$L++)(X$P=new X$Q.createGraphics).loadImage(X$m[X$L],0,0),X$h.push(X$P);return X$p&&(X$F.framesMap[X$p]=X$h),X$h},X$F.clearCache=function(X$m){var X$p,X$h=X$F.framesMap,X$P=X$m+"#";for(X$p in X$h)X$p!==X$m&&0!=X$p.indexOf(X$P)||delete X$F.framesMap[X$p]},X$F.framesMap={}}(X$Bm),function(X$m){function X$q(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,X$q.__super.call(this),null==X$q._sortIndexFun&&(X$q._sortIndexFun=X$W.sortByKey("index",!1,!0))}X$D(X$q,"laya.display.FrameAnimation",X$m);var X$p=X$q.prototype;return X$p._setUp=function(X$m,X$p){this._labels=null,this._animationNewFrames=null,this._targetDic=X$m,this._animationData=X$p,this.interval=1e3/X$p.frameRate,X$p.parsed?(this._count=X$p.count,this._labels=X$p.labels,this._animationNewFrames=X$p.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),X$p.parsed=!0,X$p.labels=this._labels,X$p.count=this._count,X$p.animationNewFrames=this._animationNewFrames},X$p.clear=function(){X$m.prototype.clear.call(this),this._targetDic=null,this._animationData=null},X$p._displayToIndex=function(X$m){if(this._animationData){X$m<0&&(X$m=0),X$m>this._count&&(X$m=this._count);var X$p=this._animationData.nodes,X$h=0,X$P=X$p.length;for(X$h=0;X$h<X$P;X$h++)this._displayNodeToFrame(X$p[X$h],X$m)}},X$p._displayNodeToFrame=function(X$m,X$p,X$h){X$h||(X$h=this._targetDic);var X$P=X$h[X$m.target];if(X$P){var X$L,X$q,X$k,X$Y=X$m.frames,X$d=X$m.keys,X$K=0,X$D=X$d.length;for(X$K=0;X$K<X$D;X$K++)X$k=(X$q=X$Y[X$L=X$d[X$K]]).length>X$p?X$q[X$p]:X$q[X$q.length-1],X$P[X$L]=X$k}},X$p._calculateDatas=function(){if(this._animationData){var X$m,X$p=this._animationData.nodes,X$h=0,X$P=X$p.length;for(X$h=this._count=0;X$h<X$P;X$h++)X$m=X$p[X$h],this._calculateNodeKeyFrames(X$m);this._count+=1}},X$p._calculateNodeKeyFrames=function(X$m){var X$p,X$h,X$P=X$m.keyframes,X$L=X$m.target;for(X$p in X$m.frames||(X$m.frames={}),X$m.keys?X$m.keys.length=0:X$m.keys=[],X$m.initValues||(X$m.initValues={}),X$P)X$h=X$P[X$p],X$m.frames[X$p]||(X$m.frames[X$p]=[]),this._targetDic&&this._targetDic[X$L]&&(X$m.initValues[X$p]=this._targetDic[X$L][X$p]),X$h.sort(X$q._sortIndexFun),X$m.keys.push(X$p),this._calculateNodePropFrames(X$h,X$m.frames[X$p],X$p,X$L)},X$p.resetToInitState=function(){if(this._targetDic&&this._animationData){var X$m,X$p,X$h=this._animationData.nodes,X$P=0,X$L=X$h.length;for(X$P=0;X$P<X$L;X$P++)if(X$p=(X$m=X$h[X$P]).initValues){var X$q,X$k=this._targetDic[X$m.target];if(X$k)for(X$q in X$p)X$k[X$q]=X$p[X$q]}}},X$p._calculateNodePropFrames=function(X$m,X$p,X$h,X$P){var X$L=0,X$q=X$m.length-1;if(0<X$q){for(X$p.length=X$m[X$q].index+1,X$L=0;X$L<X$q;X$L++)this._dealKeyFrame(X$m[X$L]),this._calculateFrameValues(X$m[X$L],X$m[X$L+1],X$p);this._dealKeyFrame(X$m[X$L])}0==X$q&&(X$p[X$m[0].index]=X$m[0].value,this._animationNewFrames&&(this._animationNewFrames[X$m[0].index]=!0))},X$p._dealKeyFrame=function(X$m){X$m.label&&""!=X$m.label&&this.addLabel(X$m.label,X$m.index)},X$p._calculateFrameValues=function(X$m,X$p,X$h){var X$P,X$L=0,X$q=X$m.index,X$k=X$p.index,X$Y=X$m.value,X$d=X$p.value-X$m.value,X$K=X$k-X$q;if(X$k>this._count&&(this._count=X$k),X$m.tween)for(null==(X$P=X$y[X$m.tweenMethod])&&(X$P=X$y.linearNone),X$L=X$q;X$L<X$k;X$L++)X$h[X$L]=X$P(X$L-X$q,X$Y,X$d,X$K),this._animationNewFrames&&(this._animationNewFrames[X$L]=!0);else for(X$L=X$q;X$L<X$k;X$L++)X$h[X$L]=X$Y;this._animationNewFrames&&(this._animationNewFrames[X$m.index]=!0,this._animationNewFrames[X$p.index]=!0),X$h[X$p.index]=X$p.value},X$q._sortIndexFun=null,X$q}(X$Bm)),X$Hm=function(X$p){function X$L(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",X$L.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=X$nm.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}X$D(X$L,"laya.display.Input",X$p);var X$m=X$L.prototype;return X$m.setSelection=function(X$m,X$p){this.focus=!0,laya.display.Input.inputElement.selectionStart=X$m,laya.display.Input.inputElement.selectionEnd=X$p},X$m._onUnDisplay=function(X$m){this.focus=!1},X$m._onMouseDown=function(X$m){this.focus=!0},X$m._syncInputTransform=function(){var X$m=this.nativeInput,X$p=X$g.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),X$h=this._width-this.padding[1]-this.padding[3],X$P=this._height-this.padding[0]-this.padding[2];X$S.isConchApp?(X$m.setScale(X$p.scaleX,X$p.scaleY),X$m.setSize(X$h,X$P),X$m.setPos(X$p.x,X$p.y)):(X$L.inputContainer.style.transform=X$L.inputContainer.style.webkitTransform="scale("+X$p.scaleX+","+X$p.scaleY+") rotate("+X$E.stage.canvasDegree+"deg)",X$m.style.width=X$h+"px",X$m.style.height=X$P+"px",X$L.inputContainer.style.left=X$p.x+"px",X$L.inputContainer.style.top=X$p.y+"px")},X$m.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},X$m._setInputMethod=function(){X$L.input.parentElement&&X$L.inputContainer.removeChild(X$L.input),X$L.area.parentElement&&X$L.inputContainer.removeChild(X$L.area),X$L.inputElement=this._multiline?X$L.area:X$L.input,X$L.inputContainer.appendChild(X$L.inputElement),X$nm.RightToLeft&&(X$L.inputElement.style.direction="rtl")},X$m._focusIn=function(){laya.display.Input.isInputting=!0;var X$m=this.nativeInput;this._focus=!0;var X$p=X$m.style;X$p.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),X$m.readOnly=!this._editable,X$S.isConchApp&&(X$m.setType(this._type),X$m.setForbidEdit(!this._editable)),X$m.maxLength=this._maxChars;this.padding;if(X$m.type=this._type,X$m.value=this._content,X$m.placeholder=this._prompt,X$E.stage.off("keydown",this,this._onKeyDown),X$E.stage.on("keydown",this,this._onKeyDown),(X$E.stage.focus=this).event("focus"),X$w.onPC&&X$m.focus(),!X$w.onMiniGame){this._text;this._text=null}this.typeset(),X$m.setColor(this._originColor),X$m.setFontSize(this.fontSize),X$m.setFontFace(X$w.onIPhone&&X$nm._fontFamilyMap[this.font]||this.font),X$S.isConchApp&&X$m.setMultiAble&&X$m.setMultiAble(this._multiline),X$p.lineHeight=this.leading+this.fontSize+"px",X$p.fontStyle=this.italic?"italic":"normal",X$p.fontWeight=this.bold?"bold":"normal",X$p.textAlign=this.align,X$p.padding="0 0",this._syncInputTransform(),!X$S.isConchApp&&X$w.onPC&&X$E.timer.frameLoop(1,this,this._syncInputTransform)},X$m._setPromptColor=function(){(X$L.promptStyleDOM=X$w.getElementById("promptStyle"))||((X$L.promptStyleDOM=X$w.createElement("style")).setAttribute("id","promptStyle"),X$w.document.head.appendChild(X$L.promptStyleDOM)),X$L.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},X$m._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(X$E.superSet(X$nm,this,"text",this._content),X$E.superSet(X$nm,this,"color",this._originColor)):(X$E.superSet(X$nm,this,"text",this._prompt),X$E.superSet(X$nm,this,"color",this._promptColor)),X$E.stage.off("keydown",this,this._onKeyDown),X$E.stage.focus=null,this.event("blur"),X$S.isConchApp&&this.nativeInput.blur(),X$w.onPC&&X$E.timer.clear(this,this._syncInputTransform)},X$m._onKeyDown=function(X$m){13===X$m.keyCode&&(X$w.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},X$m.changeText=function(X$m){this._content=X$m,this._focus?(this.nativeInput.value=X$m||"",this.event("change")):X$p.prototype.changeText.call(this,X$m)},X$A(0,X$m,"color",X$p.prototype._$get_color,function(X$m){this._focus&&this.nativeInput.setColor(X$m),X$E.superSet(X$nm,this,"color",this._content?X$m:this._promptColor),this._originColor=X$m}),X$A(0,X$m,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(X$m){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),X$A(0,X$m,"multiline",function(){return this._multiline},function(X$m){this._multiline=X$m,this.valign=X$m?"top":"middle"}),X$A(0,X$m,"maxChars",function(){return this._maxChars},function(X$m){X$m<=0&&(X$m=1e5),this._maxChars=X$m}),X$A(0,X$m,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(X$m){X$E.superSet(X$nm,this,"color",this._originColor),X$m+="",this._focus?(this.nativeInput.value=X$m||"",this.event("change")):(this._multiline||(X$m=X$m.replace(/\r?\n/g,"")),(this._content=X$m)?X$E.superSet(X$nm,this,"text",X$m):(X$E.superSet(X$nm,this,"text",this._prompt),X$E.superSet(X$nm,this,"color",this.promptColor)))}),X$A(0,X$m,"nativeInput",function(){return this._multiline?X$L.area:X$L.input}),X$A(0,X$m,"prompt",function(){return this._prompt},function(X$m){!this._text&&X$m&&X$E.superSet(X$nm,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?X$E.superSet(X$nm,this,"text",this._text==this._prompt?X$m:this._text):X$E.superSet(X$nm,this,"text",X$m),this._prompt=X$nm.langPacks&&X$nm.langPacks[X$m]?X$nm.langPacks[X$m]:X$m}),X$A(0,X$m,"focus",function(){return this._focus},function(X$m){var X$p=this.nativeInput;this._focus!==X$m&&(X$m?(X$p.target?X$p.target._focusOut():this._setInputMethod(),(X$p.target=this)._focusIn()):(X$p.target=null,this._focusOut(),X$w.document.body.scrollTop=0,X$p.blur(),X$S.isConchApp?X$p.setPos(-1e4,-1e4):X$L.inputContainer.contains(X$p)&&X$L.inputContainer.removeChild(X$p)))}),X$A(0,X$m,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(X$m){X$m?(-1<(X$m="[^"+X$m+"]").indexOf("^^")&&(X$m=X$m.replace("^^","")),this._restrictPattern=new RegExp(X$m,"g")):this._restrictPattern=null}),X$A(0,X$m,"editable",function(){return this._editable},function(X$m){this._editable=X$m,X$S.isConchApp&&X$L.input.setForbidEdit(!X$m)}),X$A(0,X$m,"promptColor",function(){return this._promptColor},function(X$m){this._promptColor=X$m,this._content||X$E.superSet(X$nm,this,"color",X$m)}),X$A(0,X$m,"type",function(){return this._type},function(X$m){this._getCSSStyle().password="password"==X$m,this._type=X$m,X$S.isConchApp&&this.nativeInput.setType(X$m)}),X$A(0,X$m,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(X$m){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),X$A(0,X$m,"asPassword",function(){return this._getCSSStyle().password},function(X$m){this._getCSSStyle().password=X$m,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),X$L.__init__=function(){X$L._createInputElement(),X$w.onMobile&&X$S.canvas.addEventListener(X$L.IOS_IFRAME?X$w.onMiniGame?"touchend":"click":"touchend",X$L._popupInputMethod)},X$L._popupInputMethod=function(X$m){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},X$L._createInputElement=function(){X$L._initInput(X$L.area=X$w.createElement("textarea")),X$L._initInput(X$L.input=X$w.createElement("input")),(X$L.inputContainer=X$w.createElement("div")).style.position="absolute",X$L.inputContainer.style.zIndex=1e5,X$w.container.appendChild(X$L.inputContainer),X$L.inputContainer.setPos=function(X$m,X$p){X$L.inputContainer.style.left=X$m+"px",X$L.inputContainer.style.top=X$p+"px"}},X$L._initInput=function(X$p){var X$m=X$p.style;X$m.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",X$m.resize="none",X$m.backgroundColor="transparent",X$m.border="none",X$m.outline="none",X$m.zIndex=1,X$p.addEventListener("input",X$L._processInputting),X$p.addEventListener("mousemove",X$L._stopEvent),X$p.addEventListener("mousedown",X$L._stopEvent),X$p.addEventListener("touchmove",X$L._stopEvent),X$p.setFontFace=function(X$m){X$p.style.fontFamily=X$m},X$S.isConchApp||(X$p.setColor=function(X$m){X$p.style.color=X$m},X$p.setFontSize=function(X$m){X$p.style.fontSize=X$m+"px"})},X$L._processInputting=function(X$m){var X$p=laya.display.Input.inputElement.target;if(X$p){var X$h=laya.display.Input.inputElement.value;X$p._restrictPattern&&(X$h=X$h.replace(/\u2006|\x27/g,""),X$p._restrictPattern.test(X$h)&&(X$h=X$h.replace(X$p._restrictPattern,""),laya.display.Input.inputElement.value=X$h)),X$p._text=X$h,X$p.event("input")}},X$L._stopEvent=function(X$m){"touchmove"==X$m.type&&X$m.preventDefault(),X$m.stopPropagation&&X$m.stopPropagation()},X$L.TYPE_TEXT="text",X$L.TYPE_PASSWORD="password",X$L.TYPE_EMAIL="email",X$L.TYPE_URL="url",X$L.TYPE_NUMBER="number",X$L.TYPE_RANGE="range",X$L.TYPE_DATE="date",X$L.TYPE_MONTH="month",X$L.TYPE_WEEK="week",X$L.TYPE_TIME="time",X$L.TYPE_DATE_TIME="datetime",X$L.TYPE_DATE_TIME_LOCAL="datetime-local",X$L.TYPE_SEARCH="search",X$L.input=null,X$L.area=null,X$L.inputElement=null,X$L.inputContainer=null,X$L.confirmButton=null,X$L.promptStyleDOM=null,X$L.inputHeight=45,X$L.isInputting=!1,X$L.stageMatrix=null,X$d(X$L,["IOS_IFRAME",function(){return this.IOS_IFRAME=X$w.onIOS&&X$w.window.top!=X$w.window.self}]),X$L}(X$nm),X$Wm=function(X$m){function X$h(X$m,X$p){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,X$h.__super.call(this),X$m&&this._init_(X$m,X$p)}X$D(X$h,"laya.resource.HTMLImage",X$em);var X$p=X$h.prototype;return X$p._init_=function(X$m,X$p){this._src=X$m,this._source=new X$w.window.Image,X$p&&(X$p.onload&&(this.onload=X$p.onload),X$p.onerror&&(this.onerror=X$p.onerror),X$p.onCreate&&X$p.onCreate(this)),0!=X$m.indexOf("data:image")&&(this._source.crossOrigin=""),X$m&&(this._source.src=X$m)},X$p.recreateResource=function(){var X$m=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var X$p=this;this._source=new X$w.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(X$p._needReleaseAgain)return X$p._needReleaseAgain=!1,X$p._source.onload=null,void(X$p._source=null);X$p._source.onload=null,X$p.memorySize=X$m._w*X$m._h*4,X$p._recreateLock=!1,X$p.completeCreate()},this._source.src=this._src}},X$p.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},X$p.onresize=function(){this._w=this._source.width,this._h=this._source.height},X$A(0,X$p,"onload",null,function(X$m){var X$p=this;this._onload=X$m,this._source&&(this._source.onload=null!=this._onload?function(){X$p.onresize(),X$p._onload()}:null)}),X$A(0,X$p,"onerror",null,function(X$m){var X$p=this;this._onerror=X$m,this._source&&(this._source.onerror=null!=this._onerror?function(){X$p._onerror()}:null)}),X$A(0,X$p,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(X$m){this._enableMerageInAtlas=X$m,X$S.isConchApp&&this._source&&(this._source.enableMerageInAtlas=X$m)}),X$h.create=function(X$m,X$p){return new X$h(X$m,X$p)},X$h}(),X$Em=(function(X$q){function X$m(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,X$m.__super.call(this)}X$D(X$m,"laya.display.EffectAnimation",X$q);var X$p=X$m.prototype;X$p._onOtherBegin=function(X$m){X$m!=this&&this.stop()},X$p.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},X$p._onPlayAction=function(){this.play(0,!1)},X$p.play=function(X$m,X$p,X$h,X$P){void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=!0),void 0===X$h&&(X$h=""),void 0===X$P&&(X$P=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,X$m,X$p,X$h,X$P))},X$p._recordInitData=function(){if(this._aniKeys){var X$m,X$p,X$h=0;for(X$m=this._aniKeys.length,X$h=0;X$h<X$m;X$h++)X$p=this._aniKeys[X$h],this._initData[X$p]=this._target[X$p]}},X$p._displayToIndex=function(X$m){if(this._animationData){X$m<0&&(X$m=0),X$m>this._count&&(X$m=this._count);var X$p=this._animationData.nodes,X$h=0,X$P=X$p.length;for(X$P=1<X$P?1:X$P,X$h=0;X$h<X$P;X$h++)this._displayNodeToFrame(X$p[X$h],X$m)}},X$p._displayNodeToFrame=function(X$m,X$p,X$h){if(this._target){var X$P;X$P=this._target;var X$L,X$q,X$k,X$Y,X$d=X$m.frames,X$K=X$m.keys,X$D=0,X$F=X$K.length;X$Y=X$m.secondFrames;var X$R,X$$,X$A,X$B,X$n=0;for(X$D=0;X$D<X$F;X$D++)X$q=X$d[X$L=X$K[X$D]],X$k=-1==(X$n=X$Y[X$L])?this._initData[X$L]:X$p<X$n?(X$A=(X$$=X$m.keyframes[X$L])[0]).tween?(null==(X$R=X$y[X$A.tweenMethod])&&(X$R=X$y.linearNone),X$B=X$$[1],X$R(X$p,this._initData[X$L],X$B.value-this._initData[X$L],X$B.index)):this._initData[X$L]:X$q.length>X$p?X$q[X$p]:X$q[X$q.length-1],X$P[X$L]=X$k}},X$p._calculateNodeKeyFrames=function(X$m){X$q.prototype._calculateNodeKeyFrames.call(this,X$m);var X$p,X$h,X$P,X$L=X$m.keyframes;X$m.target;for(X$p in X$P={},X$m.secondFrames=X$P,X$L)(X$h=X$L[X$p]).length<=1?X$P[X$p]=-1:X$P[X$p]=X$h[1].index},X$A(0,X$p,"target",function(){return this._target},function(X$m){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=X$m,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),X$A(0,X$p,"playEvent",null,function(X$m){(this._playEvents=X$m)&&this.addEvent()}),X$A(0,X$p,"effectData",null,function(X$m){var X$p;X$m&&((X$p=X$m.animations)&&X$p[0]&&(this._setUp({},X$p[0]),X$p[0].nodes&&X$p[0].nodes[0]&&(this._aniKeys=X$p[0].nodes[0].keys)))}),X$A(0,X$p,"effectClass",null,function(X$m){var X$p,X$h;(this._effectClass=X$G.getClass(X$m),this._effectClass)&&((X$p=this._effectClass.uiView)&&(X$h=X$p.animations)&&X$h[0]&&(this._setUp({},X$h[0]),X$h[0].nodes&&X$h[0].nodes[0]&&(this._aniKeys=X$h[0].nodes[0].keys)))}),X$m.EffectAnimationBegin="effectanimationbegin"}(X$Zm),function(X$p){var X$j;function X$x(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,X$x.__super.call(this)}X$D(X$x,"laya.utils.GraphicAnimation",X$p);var X$m=X$x.prototype;return X$m._parseNodeList=function(X$m){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[X$m.compId]=X$m.props,X$m.compId&&this._nodeList.push(X$m.compId);var X$p=X$m.child;if(X$p){var X$h=0,X$P=X$p.length;for(X$h=0;X$h<X$P;X$h++)this._parseNodeList(X$p[X$h])}},X$m._calGraphicData=function(X$m){var X$p;if(this._setUp(null,X$m),this._createGraphicData(),this._nodeIDAniDic)for(X$p in this._nodeIDAniDic)this._nodeIDAniDic[X$p]=null},X$m._createGraphicData=function(){var X$m,X$p=[],X$h=0,X$P=this.count,X$L=this._animationNewFrames;for(X$L||(X$L=[]),X$h=0;X$h<X$P;X$h++)!X$L[X$h]&&X$m||(X$m=this._createFrameGraphic(X$h)),X$p.push(X$m);this._gList=X$p},X$m._createFrameGraphic=function(X$m){var X$p=X$Q.createGraphics();return X$x._rootMatrix||(X$x._rootMatrix=new X$M),this._updateNodeGraphic(this._rootNode,X$m,X$x._rootMatrix,X$p),X$p},X$m._updateNodeGraphic=function(X$m,X$p,X$h,X$P,X$L){var X$q;void 0===X$L&&(X$L=1);var X$k,X$Y,X$d,X$K=(X$q=this._nodeGDic[X$m.compId]=this._getNodeGraphicData(X$m.compId,X$p,this._nodeGDic[X$m.compId])).alpha*X$L;if(!(X$K<.01)&&(X$q.resultTransform||(X$q.resultTransform=X$M.create()),X$k=X$q.resultTransform,X$M.mul(X$q.transform,X$h,X$k),X$q.skin&&(X$Y=this._getTextureByUrl(X$q.skin))&&(X$k._checkTransform()?(X$P.drawTexture(X$Y,0,0,X$q.width,X$q.height,X$k,X$K),X$q.resultTransform=null):X$P.drawTexture(X$Y,X$k.tx,X$k.ty,X$q.width,X$q.height,null,X$K)),X$d=X$m.child)){var X$D,X$F=0;for(X$D=X$d.length,X$F=0;X$F<X$D;X$F++)this._updateNodeGraphic(X$d[X$F],X$p,X$k,X$P,X$K)}},X$m._updateNoChilds=function(X$m,X$p){if(X$m.skin){var X$h=this._getTextureByUrl(X$m.skin);if(X$h){var X$P=X$m.transform;X$P._checkTransform();!X$P.bTransform?X$p.drawTexture(X$h,X$P.tx,X$P.ty,X$m.width,X$m.height,null,X$m.alpha):X$p.drawTexture(X$h,0,0,X$m.width,X$m.height,X$P.clone(),X$m.alpha)}}},X$m._updateNodeGraphic2=function(X$m,X$p,X$h){var X$P;if(X$P=this._nodeGDic[X$m.compId]=this._getNodeGraphicData(X$m.compId,X$p,this._nodeGDic[X$m.compId]),X$m.child){var X$L=X$P.transform;X$L._checkTransform();var X$q,X$k;X$k=(X$q=!X$L.bTransform)&&(0!=X$L.tx||0!=X$L.ty);var X$Y,X$d,X$K;if((X$Y=X$L.bTransform||1!=X$P.alpha)&&X$h.save(),1!=X$P.alpha&&X$h.alpha(X$P.alpha),X$q?X$k&&X$h.translate(X$L.tx,X$L.ty):X$h.transform(X$L.clone()),X$d=X$m.child,X$P.skin&&(X$K=this._getTextureByUrl(X$P.skin))&&X$h.drawTexture(X$K,0,0,X$P.width,X$P.height),X$d){var X$D,X$F=0;for(X$D=X$d.length,X$F=0;X$F<X$D;X$F++)this._updateNodeGraphic2(X$d[X$F],X$p,X$h)}X$Y?X$h.restore():X$q?X$k&&X$h.translate(-X$L.tx,-X$L.ty):X$h.transform(X$L.clone().invert())}else this._updateNoChilds(X$P,X$h)},X$m._calculateNodeKeyFrames=function(X$m){X$p.prototype._calculateNodeKeyFrames.call(this,X$m),this._nodeIDAniDic[X$m.target]=X$m},X$m.getNodeDataByID=function(X$m){return this._nodeIDAniDic[X$m]},X$m._getParams=function(X$m,X$p,X$h,X$P){var X$L=X$x._temParam;X$L.length=X$p.length;var X$q=0,X$k=X$p.length;for(X$q=0;X$q<X$k;X$q++)X$L[X$q]=this._getObjVar(X$m,X$p[X$q][0],X$h,X$p[X$q][1],X$P);return X$L},X$m._getObjVar=function(X$m,X$p,X$h,X$P,X$L){if(X$m.hasOwnProperty(X$p)){var X$q=X$m[X$p];if(X$h>=X$q.length&&(X$h=X$q.length-1),null!=X$m[X$p][X$h])return X$m[X$p][X$h]}return X$L.hasOwnProperty(X$p)?X$L[X$p]:X$P},X$m._getNodeGraphicData=function(X$m,X$p,X$h){X$h||(X$h=X$j.create()),X$h.transform?X$h.transform.identity():X$h.transform=X$M.create();var X$P=this.getNodeDataByID(X$m);if(!X$P)return X$h;var X$L,X$q,X$k=X$P.frames,X$Y=this._getParams(X$k,X$x._drawTextureCmd,X$p,this._nodeDefaultProps[X$m]),X$d=X$Y[0],X$K=NaN,X$D=NaN,X$F=X$Y[5],X$R=X$Y[6],X$$=X$Y[13],X$A=X$Y[14],X$B=X$Y[7],X$n=X$Y[8],X$c=X$Y[9],X$e=X$Y[11],X$a=X$Y[12];X$K=X$Y[3],X$D=X$Y[4],0!=X$K&&0!=X$D||(X$d=null),-1==X$K&&(X$K=0),-1==X$D&&(X$D=0),X$h.skin=X$d,X$h.width=X$K,X$h.height=X$D,X$d&&((X$L=this._getTextureByUrl(X$d))?(X$K||(X$K=X$L.sourceWidth),X$D||(X$D=X$L.sourceHeight)):console.warn("lost skin:",X$d,",you may load pics first")),X$h.alpha=X$Y[10],X$q=X$h.transform,0!=X$$&&(X$F=X$$*X$K),0!=X$A&&(X$R=X$A*X$D),0==X$F&&0==X$R||X$q.translate(-X$F,-X$R);var X$Z=null;if(X$c||1!==X$B||1!==X$n||X$e||X$a){(X$Z=X$x._tempMt).identity(),X$Z.bTransform=!0;var X$H=.0174532922222222*(X$c-X$e),X$W=.0174532922222222*(X$c+X$a),X$E=Math.cos(X$W),X$I=Math.sin(X$W),X$b=Math.sin(X$H),X$T=Math.cos(X$H);X$Z.a=X$B*X$E,X$Z.b=X$B*X$I,X$Z.c=-X$n*X$b,X$Z.d=X$n*X$T,X$Z.tx=X$Z.ty=0}return X$Z&&(X$q=X$M.mul(X$q,X$Z,X$q)),X$q.translate(X$Y[1],X$Y[2]),X$h},X$m._getTextureByUrl=function(X$m){return X$Ym.getRes(X$m)},X$m.setAniData=function(X$m,X$p){if(X$m.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=X$m,this._parseNodeList(X$m);var X$h,X$P={},X$L=[],X$q=X$m.animations,X$k=0,X$Y=X$q.length;for(X$k=0;X$k<X$Y;X$k++)if(X$h=X$q[X$k],this._labels=null,(!X$p||X$p==X$h.name)&&X$h){try{this._calGraphicData(X$h)}catch(X$m){console.warn("parse animation fail:"+X$h.name+",empty animation created"),this._gList=[]}var X$d={};X$d.interval=1e3/X$h.frameRate,X$d.frames=this._gList,X$d.labels=this._labels,X$d.name=X$h.name,X$L.push(X$d),X$P[X$h.name]=X$d}this.animationList=X$L,this.animationDic=X$P}X$x._temParam.length=0},X$m.parseByData=function(X$m){var X$p,X$h;X$p=X$m.nodeRoot,X$h=X$m.aniO,delete X$m.nodeRoot,delete X$m.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=X$p,this._parseNodeList(X$p),this._labels=null;try{this._calGraphicData(X$h)}catch(X$m){console.warn("parse animation fail:"+X$h.name+",empty animation created"),this._gList=[]}var X$P=X$m;return X$P.interval=1e3/X$h.frameRate,X$P.frames=this._gList,X$P.labels=this._labels,X$P.name=X$h.name,X$P},X$m.setUpAniData=function(X$m){if(X$m.animations){var X$p,X$h={},X$P=[],X$L=X$m.animations,X$q=0,X$k=X$L.length;for(X$q=0;X$q<X$k;X$q++)if(X$p=X$L[X$q]){var X$Y={};X$Y.name=X$p.name,X$Y.aniO=X$p,X$Y.nodeRoot=X$m,X$P.push(X$Y),X$h[X$p.name]=X$Y}this.animationList=X$P,this.animationDic=X$h}},X$m._clear=function(){var X$m,X$p;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(X$m in this._nodeGDic)(X$p=this._nodeGDic[X$m])&&X$p.recover();this._nodeGDic=null},X$x.parseAnimationByData=function(X$m){var X$p;return X$x._I||(X$x._I=new X$x),X$p=X$x._I.parseByData(X$m),X$x._I._clear(),X$p},X$x.parseAnimationData=function(X$m){var X$p;return X$x._I||(X$x._I=new X$x),X$x._I.setUpAniData(X$m),(X$p={}).animationList=X$x._I.animationList,X$p.animationDic=X$x._I.animationDic,X$x._I._clear(),X$p},X$x._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],X$x._temParam=[],X$x._I=null,X$x._rootMatrix=null,X$d(X$x,["_tempMt",function(){return this._tempMt=new X$M}]),X$x.__init$=function(){X$j=function(){function X$m(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return X$D(X$m,""),X$m.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),X$o.recover("GraphicNode",this)},X$m.create=function(){return X$o.getItemByClass("GraphicNode",X$m)},X$m}()},X$x}(X$Zm));X$E.__init([X$K,X$dm,X$S,X$w,X$i,X$T,X$m,X$Em])}(window,document,Laya),function(X$m,X$p,X$h){X$h.un,X$h.uns,X$h.static;var X$P=X$h.class;X$h.getset,X$h.__newvec;new(function(){function X$m(){}return X$P(X$m,"LayaMain"),X$m}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(X$m,X$p){"use strict";for(var X$h in Object.defineProperty(X$p,"__esModule",{value:!0}),Laya){var X$P=Laya[X$h];X$P&&X$P.__isclass&&(X$p[X$h]=X$P)}}),function(X$m,X$p,X$W){X$W.un,X$W.uns;var X$k=X$W.static,X$R=X$W.class,X$P=X$W.getset,X$q=X$W.__newvec,X$D=laya.maths.Arith,X$F=laya.maths.Bezier,X$h=laya.resource.Bitmap,X$$=laya.utils.Browser,X$d=laya.utils.Byte,X$A=laya.utils.Color,X$E=(laya.filters.ColorFilter,X$W.Config),X$L=laya.resource.Context,X$I=(laya.events.Event,laya.filters.Filter),X$Y=laya.display.Graphics,X$K=laya.resource.HTMLCanvas,X$B=(laya.utils.HTMLChar,laya.resource.HTMLImage),X$n=laya.resource.HTMLSubImage,X$b=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),X$T=laya.maths.Point,X$j=laya.maths.Rectangle,X$c=laya.renders.Render,X$e=(laya.renders.RenderContext,laya.renders.RenderSprite),X$a=laya.resource.Resource,X$Z=laya.resource.ResourceManager,X$H=laya.utils.RunDriver,X$x=laya.display.Sprite,X$Q=laya.display.Stage,X$M=laya.utils.Stat,X$u=laya.utils.StringKey,X$N=(laya.display.css.Style,laya.system.System),X$S=laya.display.Text,X$_=laya.resource.Texture,X$l=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),X$J=laya.utils.VectorGraphManager;laya.utils.WordText;X$W.interface("laya.webgl.shapes.IShape"),X$W.interface("laya.webgl.submit.ISubmit"),X$W.interface("laya.webgl.text.ICharSegment"),X$W.interface("laya.webgl.canvas.save.ISaveData"),X$W.interface("laya.webgl.resource.IMergeAtlasBitmap"),X$W.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var X$z=function(){function X$m(){}X$R(X$m,"laya.filters.webgl.FilterActionGL");var X$p=X$m.prototype;return X$W.imps(X$p,{"laya.filters.IFilterActionGL":!0}),X$p.setValue=function(X$m){},X$p.setValueMix=function(X$m){},X$p.apply3d=function(X$m,X$p,X$h,X$P,X$L){return null},X$p.apply=function(X$m){return null},X$P(0,X$p,"typeMix",function(){return 0}),X$m}(),X$w=function(){function X$m(){}return X$R(X$m,"laya.webgl.shader.ShaderValue"),X$m}(),X$X=function(){var X$P,X$L;function X$m(X$m,X$p,X$h){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new X$L,void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),this._cells=null,this._rowInfo=null,this._init(X$m,X$p),this._atlasID=X$h}X$R(X$m,"laya.webgl.atlas.AtlasGrid");var X$p=X$m.prototype;return X$p.getAltasID=function(){return this._atlasID},X$p.setAltasID=function(X$m){0<=X$m&&(this._atlasID=X$m)},X$p.addTex=function(X$m,X$p,X$h){var X$P=this._get(X$p,X$h);return 0==X$P.ret||(this._fill(X$P.x,X$P.y,X$p,X$h,X$m),this._texCount++),X$P},X$p._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},X$p._init=function(X$m,X$p){if(this._width=X$m,this._height=X$p,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=X$q(this._height);for(var X$h=0;X$h<this._height;X$h++)this._rowInfo[X$h]=new X$P;return this._clear(),!0},X$p._get=function(X$m,X$p){var X$h=new X$G;if(X$m>=this._failSize.width&&X$p>=this._failSize.height)return X$h;for(var X$P=-1,X$L=-1,X$q=this._width,X$k=this._height,X$Y=this._cells,X$d=0;X$d<X$k;X$d++)if(!(this._rowInfo[X$d].spaceCount<X$m))for(var X$K=0;X$K<X$q;){var X$D=3*(X$d*X$q+X$K);if(0!=X$Y[X$D]||X$Y[1+X$D]<X$m||X$Y[2+X$D]<X$p)X$K+=X$Y[1+X$D];else{X$P=X$K,X$L=X$d;for(var X$F=0;X$F<X$m;X$F++)if(X$Y[3*X$F+X$D+2]<X$p){X$P=-1;break}if(!(X$P<0))return X$h.ret=!0,X$h.x=X$P,X$h.y=X$L,X$h;X$K+=X$Y[1+X$D]}}return X$h},X$p._fill=function(X$m,X$p,X$h,X$P,X$L){var X$q=this._width,X$k=this._height;this._check(X$m+X$h<=X$q&&X$p+X$P<=X$k);for(var X$Y=X$p;X$Y<X$P+X$p;++X$Y){this._check(this._rowInfo[X$Y].spaceCount>=X$h),this._rowInfo[X$Y].spaceCount-=X$h;for(var X$d=0;X$d<X$h;X$d++){var X$K=3*(X$m+X$Y*X$q+X$d);this._check(0==this._cells[X$K]),this._cells[X$K]=X$L,this._cells[1+X$K]=X$h,this._cells[2+X$K]=X$P}}if(0<X$m)for(X$Y=0;X$Y<X$P;++X$Y){var X$D=0;for(X$d=X$m-1;0<=X$d&&0==this._cells[3*((X$p+X$Y)*X$q+X$d)];--X$d,++X$D);for(X$d=X$D;0<X$d;--X$d)this._cells[3*((X$p+X$Y)*X$q+X$m-X$d)+1]=X$d,this._check(0<X$d)}if(0<X$p)for(X$d=X$m;X$d<X$m+X$h;++X$d){for(X$D=0,X$Y=X$p-1;0<=X$Y&&0==this._cells[3*(X$d+X$Y*X$q)];--X$Y,X$D++);for(X$Y=X$D;0<X$Y;--X$Y)this._cells[3*(X$d+(X$p-X$Y)*X$q)+2]=X$Y,this._check(0<X$Y)}},X$p._check=function(X$m){0==X$m&&console.log("xtexMerger 错误啦")},X$p._clear=function(){for(var X$m=this._texCount=0;X$m<this._height;X$m++)this._rowInfo[X$m].spaceCount=this._width;for(var X$p=0;X$p<this._height;X$p++)for(var X$h=0;X$h<this._width;X$h++){var X$P=3*(X$p*this._width+X$h);this._cells[X$P]=0,this._cells[1+X$P]=this._width-X$h,this._cells[2+X$P]=this._width-X$p}this._failSize.width=this._width+1,this._failSize.height=this._height+1},X$m.__init$=function(){X$P=function(){function X$m(){this.spaceCount=0}return X$R(X$m,""),X$m}(),X$L=function(){function X$m(){this.width=0,this.height=0}return X$R(X$m,""),X$m}()},X$m}(),X$s=function(){function X$c(X$m,X$p,X$h,X$P){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=X$m,this._height=X$p,this._gridSize=X$h,this._maxAtlaserCount=X$P,this._gridNumX=X$m/X$h,this._gridNumY=X$p/X$h,this._curAtlasIndex=0,this._atlaserArray=[]}X$R(X$c,"laya.webgl.atlas.AtlasResourceManager");var X$m=X$c.prototype;return X$m.setAtlasParam=function(X$m,X$p,X$h,X$P){if(1==this._setAtlasParam)return X$c._sid_=0,this._width=X$m,this._height=X$p,this._gridSize=X$h,this._maxAtlaserCount=X$P,this._gridNumX=X$m/X$h,this._gridNumY=X$p/X$h,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},X$m.pushData=function(X$m){var X$p,X$h=X$m.bitmap,X$P=-1,X$L=null,X$q=0,X$k=0;for(X$q=0,X$p=this._atlaserArray.length;X$q<X$p&&(X$k=(this._curAtlasIndex+X$q)%X$p,-1==(X$P=(X$L=this._atlaserArray[X$k]).findBitmapIsExist(X$h)));X$q++);if(-1!=X$P){var X$Y=X$L.InAtlasWebGLImagesOffsetValue[X$P];return X$A=X$Y[0],X$B=X$Y[1],X$L.addToAtlas(X$m,X$A,X$B),!0}this._setAtlasParam=!1;for(var X$d=Math.ceil((X$m.bitmap.width+2)/this._gridSize),X$K=Math.ceil((X$m.bitmap.height+2)/this._gridSize),X$D=!1,X$F=0;X$F<2;X$F++){var X$R=this._maxAtlaserCount;for(X$q=0;X$q<X$R;X$q++){X$k=(this._curAtlasIndex+X$q)%X$R,this._atlaserArray.length-1>=X$k||this._atlaserArray.push(new X$jm(this._gridNumX,this._gridNumY,this._width,this._height,X$c._sid_++));var X$$=this._atlaserArray[X$k],X$A=0,X$B=0,X$n=X$$.addTex(1,X$d,X$K);if(X$n.ret){X$A=X$n.x*this._gridSize+1,X$B=X$n.y*this._gridSize+1,X$h.lock=!0,X$$.addToAtlasTexture(X$h,X$A,X$B),X$$.addToAtlas(X$m,X$A,X$B),X$D=!0,this._curAtlasIndex=X$k;break}}if(X$D)break;this._atlaserArray.push(new X$jm(this._gridNumX,this._gridNumY,this._width,this._height,X$c._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return X$D||console.log(">>>AtlasManager pushData error"),X$D},X$m.addToAtlas=function(X$m){laya.webgl.atlas.AtlasResourceManager.instance.pushData(X$m)},X$m.garbageCollection=function(){if(!0===this._needGC){for(var X$m=this._atlaserArray.length-this._maxAtlaserCount,X$p=0;X$p<X$m;X$p++)this._atlaserArray[X$p].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+X$m),this._atlaserArray.splice(0,X$m),this._needGC=!1}return!0},X$m.freeAll=function(){for(var X$m=0,X$p=this._atlaserArray.length;X$m<X$p;X$m++)this._atlaserArray[X$m].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},X$m.getAtlaserCount=function(){return this._atlaserArray.length},X$m.getAtlaserByIndex=function(X$m){return this._atlaserArray[X$m]},X$P(1,X$c,"instance",function(){return X$c._Instance||(X$c._Instance=new X$c(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),X$c._Instance}),X$P(1,X$c,"enabled",function(){return X$E.atlasEnable}),X$P(1,X$c,"atlasLimitWidth",function(){return X$c._atlasLimitWidth},function(X$m){X$c._atlasLimitWidth=X$m}),X$P(1,X$c,"atlasLimitHeight",function(){return X$c._atlasLimitHeight},function(X$m){X$c._atlasLimitHeight=X$m}),X$c._enable=function(){X$E.atlasEnable=!0},X$c._disable=function(){X$E.atlasEnable=!1},X$c.__init__=function(){X$c.atlasTextureWidth=2048,X$c.atlasTextureHeight=2048,X$c.maxTextureCount=6,X$c.atlasLimitWidth=512,X$c.atlasLimitHeight=512},X$c._atlasLimitWidth=0,X$c._atlasLimitHeight=0,X$c.gridSize=16,X$c.atlasTextureWidth=0,X$c.atlasTextureHeight=0,X$c.maxTextureCount=0,X$c._atlasRestore=0,X$c.BOARDER_TYPE_NO=0,X$c.BOARDER_TYPE_RIGHT=1,X$c.BOARDER_TYPE_LEFT=2,X$c.BOARDER_TYPE_BOTTOM=4,X$c.BOARDER_TYPE_TOP=8,X$c.BOARDER_TYPE_ALL=15,X$c._sid_=0,X$c._Instance=null,X$c}(),X$G=function(){function X$m(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return X$R(X$m,"laya.webgl.atlas.MergeFillInfo"),X$m}(),X$U=function(){function X$p(){}return X$R(X$p,"laya.webgl.canvas.BlendMode"),X$p._init_=function(X$m){X$p.fns=[X$p.BlendNormal,X$p.BlendAdd,X$p.BlendMultiply,X$p.BlendScreen,X$p.BlendOverlay,X$p.BlendLight,X$p.BlendMask,X$p.BlendDestinationOut],X$p.targetFns=[X$p.BlendNormalTarget,X$p.BlendAddTarget,X$p.BlendMultiplyTarget,X$p.BlendScreenTarget,X$p.BlendOverlayTarget,X$p.BlendLightTarget,X$p.BlendMask,X$p.BlendDestinationOut]},X$p.BlendNormal=function(X$m){X$m.blendFunc(1,771)},X$p.BlendAdd=function(X$m){X$m.blendFunc(1,772)},X$p.BlendMultiply=function(X$m){X$m.blendFunc(774,771)},X$p.BlendScreen=function(X$m){X$m.blendFunc(1,1)},X$p.BlendOverlay=function(X$m){X$m.blendFunc(1,769)},X$p.BlendLight=function(X$m){X$m.blendFunc(1,1)},X$p.BlendNormalTarget=function(X$m){X$m.blendFunc(1,771)},X$p.BlendAddTarget=function(X$m){X$m.blendFunc(1,772)},X$p.BlendMultiplyTarget=function(X$m){X$m.blendFunc(774,771)},X$p.BlendScreenTarget=function(X$m){X$m.blendFunc(1,1)},X$p.BlendOverlayTarget=function(X$m){X$m.blendFunc(1,769)},X$p.BlendLightTarget=function(X$m){X$m.blendFunc(1,1)},X$p.BlendMask=function(X$m){X$m.blendFunc(0,770)},X$p.BlendDestinationOut=function(X$m){X$m.blendFunc(0,0)},X$p.activeBlendFunction=null,X$p.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],X$p.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},X$p.NORMAL="normal",X$p.ADD="add",X$p.MULTIPLY="multiply",X$p.SCREEN="screen",X$p.LIGHT="light",X$p.OVERLAY="overlay",X$p.DESTINATIONOUT="destination-out",X$p.fns=[],X$p.targetFns=[],X$p}(),X$r=function(){function X$h(X$m){this._color=X$A.create("black"),this.setValue(X$m)}X$R(X$h,"laya.webgl.canvas.DrawStyle");var X$m=X$h.prototype;return X$m.setValue=function(X$m){if(X$m){if("string"==typeof X$m)return void(this._color=X$A.create(X$m));if(X$m instanceof laya.utils.Color)return void(this._color=X$m)}},X$m.reset=function(){this._color=X$A.create("black")},X$m.equal=function(X$m){return"string"==typeof X$m?this._color.strColor===X$m:X$m instanceof laya.utils.Color&&this._color.numColor===X$m.numColor},X$m.toColorStr=function(){return this._color.strColor},X$h.create=function(X$m){var X$p;if(X$m&&("string"==typeof X$m?X$p=X$A.create(X$m):X$m instanceof laya.utils.Color&&(X$p=X$m),X$p))return X$p._drawStyle||(X$p._drawStyle=new X$h(X$m));return laya.webgl.canvas.DrawStyle.DEFAULT},X$k(X$h,["DEFAULT",function(){return this.DEFAULT=new X$h("#000000")}]),X$h}(),X$y=function(){function X$m(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];X$Zm.mainContext;this.ib=X$Om.create(35048),this.vb=X$Cm.create(5)}X$R(X$m,"laya.webgl.canvas.Path");var X$p=X$m.prototype;return X$p.addPoint=function(X$m,X$p){this.tempArray.push(X$m,X$p)},X$p.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},X$p.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},X$p.polygon=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k;return this.geomatrys.push(this._curGeomatry=X$k=new X$um(X$m,X$p,X$h,X$P,X$L,X$q)),X$P||(X$k.fill=!1),null==X$q&&(X$k.borderWidth=0),X$k},X$p.setGeomtry=function(X$m){this.geomatrys.push(this._curGeomatry=X$m)},X$p.drawLine=function(X$m,X$p,X$h,X$P,X$L){var X$q;return this.closePath?this.geomatrys.push(this._curGeomatry=X$q=new X$Mm(X$m,X$p,X$h,X$P,X$L)):this.geomatrys.push(this._curGeomatry=X$q=new X$Qm(X$m,X$p,X$h,X$P,X$L)),X$q.fill=!1,X$q},X$p.update=function(){var X$m=this.ib._byteLength,X$p=this.geomatrys.length;this.offset=X$m;for(var X$h=this.geoStart;X$h<X$p;X$h++)this.geomatrys[X$h].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=X$p,this.count=(this.ib._byteLength-X$m)/X$Bm.BYTES_PIDX},X$p.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},X$p.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},X$m}(),X$V=function(){function X$Y(){}X$R(X$Y,"laya.webgl.canvas.save.SaveBase");var X$m=X$Y.prototype;return X$W.imps(X$m,{"laya.webgl.canvas.save.ISaveData":!0}),X$m.isSaveMark=function(){return!1},X$m.restore=function(X$m){this._dataObj[this._valueName]=this._value,(X$Y._cache[X$Y._cache._length++]=this)._newSubmit&&(X$m._curSubmit=X$qm.RENDERBASE,X$m._renderKey=0)},X$Y._createArray=function(){var X$m=[];return X$m._length=0,X$m},X$Y._init=function(){var X$m=X$Y._namemap={};return X$m[1]="ALPHA",X$m[2]="fillStyle",X$m[8]="font",X$m[256]="lineWidth",X$m[512]="strokeStyle",X$m[8192]="_mergeID",X$m[1024]=X$m[2048]=X$m[4096]=[],X$m[16384]="textBaseline",X$m[32768]="textAlign",X$m[65536]="_nBlendType",X$m[1048576]="shader",X$m[2097152]="filters",X$m},X$Y.save=function(X$m,X$p,X$h,X$P){if((X$m._saveMark._saveuse&X$p)!==X$p){X$m._saveMark._saveuse|=X$p;var X$L=X$Y._cache,X$q=0<X$L._length?X$L[--X$L._length]:new X$Y;X$q._value=X$h[X$q._valueName=X$Y._namemap[X$p]],X$q._dataObj=X$h,X$q._newSubmit=X$P;var X$k=X$m._save;X$k[X$k._length++]=X$q}},X$Y._cache=laya.webgl.canvas.save.SaveBase._createArray(),X$Y._namemap=X$Y._init(),X$Y}(),X$o=function(){function X$q(){this._clipRect=new X$j}X$R(X$q,"laya.webgl.canvas.save.SaveClipRect");var X$m=X$q.prototype;return X$W.imps(X$m,{"laya.webgl.canvas.save.ISaveData":!0}),X$m.isSaveMark=function(){return!1},X$m.restore=function(X$m){X$m._clipRect=this._clipSaveRect,(X$q._cache[X$q._cache._length++]=this)._submitScissor.submitLength=X$m._submits._length-this._submitScissor.submitIndex,X$m._curSubmit=X$qm.RENDERBASE,X$m._renderKey=0},X$q.save=function(X$m,X$p){if(131072!=(131072&X$m._saveMark._saveuse)){X$m._saveMark._saveuse|=131072;var X$h=X$q._cache,X$P=0<X$h._length?X$h[--X$h._length]:new X$q;X$P._clipSaveRect=X$m._clipRect,X$m._clipRect=X$P._clipRect.copyFrom(X$m._clipRect),X$P._submitScissor=X$p;var X$L=X$m._save;X$L[X$L._length++]=X$P}},X$k(X$q,["_cache",function(){return this._cache=X$V._createArray()}]),X$q}(),X$f=function(){function X$$(){this._contextX=0,this._contextY=0,this._clipRect=new X$j,this._rect=new X$j,this._matrix=new X$b}X$R(X$$,"laya.webgl.canvas.save.SaveClipRectStencil");var X$m=X$$.prototype;return X$W.imps(X$m,{"laya.webgl.canvas.save.ISaveData":!0}),X$m.isSaveMark=function(){return!1},X$m.restore=function(X$m){X$Dm.restore(X$m,this._rect,this._saveMatrix,this._contextX,this._contextY),X$m._clipRect=this._clipSaveRect,X$m._curMat=this._saveMatrix,X$m._x=this._contextX,X$m._y=this._contextY,X$$._cache[X$$._cache._length++]=this,X$m._curSubmit=X$qm.RENDERBASE},X$$.save=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){if(262144!=(262144&X$m._saveMark._saveuse)){X$m._saveMark._saveuse|=262144;var X$D=X$$._cache,X$F=0<X$D._length?X$D[--X$D._length]:new X$$;X$F._clipSaveRect=X$m._clipRect,X$F._clipRect.setTo(X$k,X$Y,X$d,X$K),X$m._clipRect=X$F._clipRect,X$F._rect.x=X$h,X$F._rect.y=X$P,X$F._rect.width=X$L,X$F._rect.height=X$q,X$F._contextX=X$m._x,X$F._contextY=X$m._y,X$F._saveMatrix=X$m._curMat,X$m._curMat.copyTo(X$F._matrix),X$m._curMat=X$F._matrix,X$F._submitStencil=X$p;var X$R=X$m._save;X$R[X$R._length++]=X$F}},X$k(X$$,["_cache",function(){return this._cache=X$V._createArray()}]),X$$}(),X$i=function(){function X$P(){this._saveuse=0}X$R(X$P,"laya.webgl.canvas.save.SaveMark");var X$m=X$P.prototype;return X$W.imps(X$m,{"laya.webgl.canvas.save.ISaveData":!0}),X$m.isSaveMark=function(){return!0},X$m.restore=function(X$m){X$m._saveMark=this._preSaveMark,X$P._no[X$P._no._length++]=this},X$P.Create=function(X$m){var X$p=X$P._no,X$h=0<X$p._length?X$p[--X$p._length]:new X$P;return X$h._saveuse=0,X$h._preSaveMark=X$m._saveMark,X$m._saveMark=X$h},X$k(X$P,["_no",function(){return this._no=X$V._createArray()}]),X$P}(),X$v=function(){function X$q(){this._matrix=new X$b}X$R(X$q,"laya.webgl.canvas.save.SaveTransform");var X$m=X$q.prototype;return X$W.imps(X$m,{"laya.webgl.canvas.save.ISaveData":!0}),X$m.isSaveMark=function(){return!1},X$m.restore=function(X$m){X$m._curMat=this._savematrix,X$q._no[X$q._no._length++]=this},X$q.save=function(X$m){var X$p=X$m._saveMark;if(2048!=(2048&X$p._saveuse)){X$p._saveuse|=2048;var X$h=X$q._no,X$P=0<X$h._length?X$h[--X$h._length]:new X$q;X$P._savematrix=X$m._curMat,X$m._curMat=X$m._curMat.copyTo(X$P._matrix);var X$L=X$m._save;X$L[X$L._length++]=X$P}},X$k(X$q,["_no",function(){return this._no=X$V._createArray()}]),X$q}(),X$g=function(){function X$L(){}X$R(X$L,"laya.webgl.canvas.save.SaveTranslate");var X$m=X$L.prototype;return X$W.imps(X$m,{"laya.webgl.canvas.save.ISaveData":!0}),X$m.isSaveMark=function(){return!1},X$m.restore=function(X$m){X$m._curMat;X$m._x=this._x,X$m._y=this._y,X$L._no[X$L._no._length++]=this},X$L.save=function(X$m){var X$p=X$L._no,X$h=0<X$p._length?X$p[--X$p._length]:new X$L;X$h._x=X$m._x,X$h._y=X$m._y;var X$P=X$m._save;X$P[X$P._length++]=X$h},X$k(X$L,["_no",function(){return this._no=X$V._createArray()}]),X$L}(),X$t=function(){function X$m(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new X$j}X$R(X$m,"laya.webgl.resource.RenderTargetMAX");var X$p=X$m.prototype;return X$p.setSP=function(X$m){this._sp=X$m},X$p.size=function(X$m,X$p){var X$h=this;this._width!==X$m||this._height!==X$p?(this.repaint=!0,this._width=X$m,this._height=X$p,this.target?this.target.size(X$m,X$p):this.target=X$Jm.create(X$m,X$p),this.target.hasListener("recovered")||this.target.on("recovered",this,function(X$m){X$W.timer.callLater(X$h._sp,X$h._sp.repaint)})):this.target.size(X$m,X$p)},X$p._flushToTarget=function(X$m,X$p){if(!X$p._destroy){var X$h=X$em.worldScissorTest,X$P=X$em.worldClipRect;X$em.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,X$em.worldScissorTest=!1,X$Zm.mainContext.disable(3089);var X$L=X$em.worldAlpha,X$q=X$em.worldMatrix4,X$k=X$em.worldMatrix,X$Y=X$em.worldFilters,X$d=X$em.worldShaderDefines;if(X$em.worldMatrix=X$b.EMPTY,X$em.restoreTempArray(),X$em.worldMatrix4=X$em.TEMPMAT4_ARRAY,X$em.worldAlpha=1,X$em.worldFilters=null,X$em.worldShaderDefines=null,X$lm.activeShader=null,X$p.start(),X$E.showCanvasMark?X$p.clear(0,1,0,.3):X$p.clear(0,0,0,0),X$m.flush(),X$p.end(),X$lm.activeShader=null,X$em.worldAlpha=X$L,X$em.worldMatrix4=X$q,X$em.worldMatrix=X$k,X$em.worldFilters=X$Y,X$em.worldShaderDefines=X$d,X$em.worldScissorTest=X$h){var X$K=X$em.height-X$P.y-X$P.height;X$Zm.mainContext.scissor(X$P.x,X$K,X$P.width,X$P.height),X$Zm.mainContext.enable(3089)}X$em.worldClipRect=X$P}},X$p.flush=function(X$m){this.repaint&&(this._flushToTarget(X$m,this.target),this.repaint=!1)},X$p.drawTo=function(X$m,X$p,X$h,X$P,X$L){X$m.drawTexture(this.target.getTexture(),X$p,X$h,X$P,X$L,0,0)},X$p.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},X$m}(),X$O=function(){function X$m(){this.ALPHA=1,this.shaderType=0,this.defines=new X$xm}return X$R(X$m,"laya.webgl.shader.d2.Shader2D"),X$m.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},X$m.__init__=function(){var X$m,X$p;X$im.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),X$im.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),X$im.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),X$im.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),X$im.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),X$im.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),X$im.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),X$im.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),X$m="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",X$p='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',X$im.preCompile2D(0,1,X$m,X$p,null),X$m="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",X$p='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',X$im.preCompile2D(0,2,X$m,X$p,null),X$m="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",X$p="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",X$im.preCompile2D(0,4,X$m,X$p,null),X$m="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",X$p='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',X$im.preCompile2D(0,256,X$m,X$p,null),X$m="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",X$p="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",X$im.preCompile2D(0,512,X$m,X$p,null)},X$m}(),X$C=function(){function X$p(X$m,X$p,X$h){this._value=0,this._name2int=X$m,this._int2name=X$p,this._int2nameMap=X$h}X$R(X$p,"laya.webgl.shader.ShaderDefines");var X$m=X$p.prototype;return X$m.add=function(X$m){return"string"==typeof X$m&&(X$m=this._name2int[X$m]),this._value|=X$m,this._value},X$m.addInt=function(X$m){return this._value|=X$m,this._value},X$m.remove=function(X$m){return"string"==typeof X$m&&(X$m=this._name2int[X$m]),this._value&=~X$m,this._value},X$m.isDefine=function(X$m){return(this._value&X$m)===X$m},X$m.getValue=function(){return this._value},X$m.setValue=function(X$m){this._value=X$m},X$m.toNameDic=function(){var X$m=this._int2nameMap[this._value];return X$m||X$p._toText(this._value,this._int2name,this._int2nameMap)},X$p._reg=function(X$m,X$p,X$h,X$P){X$P[X$h[X$m]=X$p]=X$m},X$p._toText=function(X$m,X$p,X$h){var X$P=X$h[X$m];if(X$P)return X$P;for(var X$L={},X$q=1,X$k=0;X$k<32&&!(X$m<(X$q=1<<X$k));X$k++)if(X$m&X$q){var X$Y=X$p[X$q];X$Y&&(X$L[X$Y]="")}return X$h[X$m]=X$L},X$p._toInt=function(X$m,X$p){for(var X$h=X$m.split("."),X$P=0,X$L=0,X$q=X$h.length;X$L<X$q;X$L++){var X$k=X$p[X$h[X$L]];if(!X$k)throw new Error("Defines to int err:"+X$m+"/"+X$h[X$L]);X$P|=X$k}return X$P},X$p}(),X$mm=function(){function X$k(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new X$b}X$R(X$k,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var X$m=X$k.prototype;return X$m.init=function(X$m,X$p,X$h){if(X$p)this._vs=X$p;else{this._vs=[];var X$P=X$m.width,X$L=X$m.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(X$P,0,1,0,1,1,1,1),this._vs.push(X$P,X$L,1,1,1,1,1,1),this._vs.push(0,X$L,0,1,1,1,1,1)}X$h?this._ps=X$h:(X$k._defaultPS||(X$k._defaultPS=[]).push(0,1,3,3,1,2),this._ps=X$k._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=X$m},X$m.init2=function(X$m,X$p,X$h,X$P,X$L){this.transform&&(this.transform=null),X$h?this._ps=X$h:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=X$P,this._uvs=X$L,this.mEleNum=this._ps.length,this.mTexture=X$m,(X$c.isConchNode||X$c.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},X$m._initMyData=function(){var X$m=0,X$p=0,X$h=4*this._verticles.length;this._vs=X$k._tempVS;var X$P=!1;if(X$c.isConchNode||X$c.isConchApp?(this._vs.length=X$h,X$P=!0):this._vs.length<X$h&&(this._vs.length=X$h,X$P=!0),X$k._tVSLen=X$h,X$P)for(;X$m<X$h;)this._vs[X$m]=this._verticles[X$p],this._vs[X$m+1]=this._verticles[X$p+1],this._vs[X$m+2]=this._uvs[X$p],this._vs[X$m+3]=this._uvs[X$p+1],this._vs[X$m+4]=1,this._vs[X$m+5]=1,this._vs[X$m+6]=1,this._vs[X$m+7]=1,X$m+=8,X$p+=2;else for(;X$m<X$h;)this._vs[X$m]=this._verticles[X$p],this._vs[X$m+1]=this._verticles[X$p+1],this._vs[X$m+2]=this._uvs[X$p],this._vs[X$m+3]=this._uvs[X$p+1],X$m+=8,X$p+=2},X$m.getData2=function(X$m,X$p,X$h){var X$P;this.mVBBuffer=X$m,this.mIBBuffer=X$p,this._initMyData(),X$m.appendEx2(this._vs,Float32Array,X$k._tVSLen,4),this._indexStart=X$p._byteLength,(X$P=X$k._tempIB).length<this._ps.length&&(X$P.length=this._ps.length);for(var X$L=0,X$q=this._ps.length;X$L<X$q;X$L++)X$P[X$L]=this._ps[X$L]+X$h;X$p.appendEx2(X$P,Uint16Array,this._ps.length,2)},X$m.getData=function(X$m,X$p,X$h){if(this.mVBBuffer=X$m,this.mIBBuffer=X$p,X$m.append(this.mVBData),this._indexStart=X$p._byteLength,this.mIBData.start!=X$h){for(var X$P=0,X$L=this._ps.length;X$P<X$L;X$P++)this.mIBData[X$P]=this._ps[X$P]+X$h;this.mIBData.start=X$h}X$p.append(this.mIBData)},X$m.render=function(X$m,X$p,X$h){if(X$c.isWebGL&&this.mTexture){X$m._renderKey=0,X$m._shader2D.glTexture=null,X$pm.getInstance().addSkinMesh(this);var X$P=X$qm.createShape(X$m,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,X$Im.create(512,0));this.transform||(this.transform=X$b.EMPTY),this.transform.translate(X$p,X$h),X$b.mul(this.transform,X$m._curMat,this._tempMatrix),this.transform.translate(-X$p,-X$h);var X$L=X$P.shaderValue,X$q=X$L.u_mmat2||X$em.getMatrArray();X$em.mat2MatArray(this._tempMatrix,X$q),X$L.textureHost=this.mTexture,X$L.offsetX=0,X$L.offsetY=0,X$L.u_mmat2=X$q,X$L.ALPHA=X$m._shader2D.ALPHA,X$m._submits[X$m._submits._length++]=X$P}else X$c.isConchApp&&this.mTexture&&(this.transform||(this.transform=X$b.EMPTY),X$m.setSkinMesh&&X$m.setSkinMesh(X$p,X$h,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},X$k._tempVS=[],X$k._tempIB=[],X$k._defaultPS=null,X$k._tVSLen=0,X$k}(),X$pm=function(){function X$m(){this.ib=null,this.vb=null;X$Zm.mainContext;this.ib=X$Om.create(35048),this.vb=X$Cm.create(8)}X$R(X$m,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var X$p=X$m.prototype;return X$p.addSkinMesh=function(X$m){X$m.getData2(this.vb,this.ib,this.vb._byteLength/32)},X$p.reset=function(){this.vb.clear(),this.ib.clear()},X$m.getInstance=function(){return X$m.instance=X$m.instance||new X$m},X$m.instance=null,X$m}(),X$hm=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===X$d&&(X$d=0),this.x=X$m,this.y=X$p,this.width=X$h,this.height=X$P,this.edges=X$L,this.color=X$q,this.borderWidth=X$k,this.borderColor=X$Y}X$R(X$m,"laya.webgl.shapes.BasePoly");var X$p=X$m.prototype;return X$W.imps(X$p,{"laya.webgl.shapes.IShape":!0}),X$p.getData=function(X$m,X$p,X$h){},X$p.rebuild=function(X$m){},X$p.setMatrix=function(X$m){},X$p.needUpdate=function(X$m){return!0},X$p.sector=function(X$m,X$p,X$h){var X$P=this.x,X$L=this.y,X$q=this.edges,X$k=(this.r1-this.r0)/X$q,X$Y=this.width,X$d=this.height,X$K=this.color,X$D=(X$K>>16&255)/255,X$F=(X$K>>8&255)/255,X$R=(255&X$K)/255;X$m.push(X$P,X$L,X$D,X$F,X$R);for(var X$$=0;X$$<X$q+1;X$$++)X$m.push(X$P+Math.sin(X$k*X$$+this.r0)*X$Y,X$L+Math.cos(X$k*X$$+this.r0)*X$d),X$m.push(X$D,X$F,X$R);for(X$$=0;X$$<X$q;X$$++)X$p.push(X$h,X$h+X$$+1,X$h+X$$+2)},X$p.createLine2=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k,X$Y,X$d,X$K,X$D,X$F,X$R,X$$,X$A,X$B,X$n,X$c,X$e,X$a,X$Z,X$H,X$W,X$E,X$I,X$b,X$T=X$m.concat(),X$j=X$L,X$x=this.borderColor,X$Q=(X$x>>16&255)/255,X$M=(X$x>>8&255)/255,X$u=(255&X$x)/255,X$N=X$T.length/2,X$S=X$P,X$_=X$h/2;X$d=X$T[0],X$K=X$T[1],X$B=X$d-(X$D=X$T[2]),X$A=(X$A=-(X$K-(X$F=X$T[3])))/(X$b=Math.sqrt(X$A*X$A+X$B*X$B))*X$_,X$B=X$B/X$b*X$_,X$j.push(X$d-X$A+this.x,X$K-X$B+this.y,X$Q,X$M,X$u,X$d+X$A+this.x,X$K+X$B+this.y,X$Q,X$M,X$u);for(var X$l=1;X$l<X$N-1;X$l++)X$d=X$T[2*(X$l-1)],X$K=X$T[2*(X$l-1)+1],X$D=X$T[2*X$l],X$F=X$T[2*X$l+1],X$R=X$T[2*(X$l+1)],X$$=X$T[2*(X$l+1)+1],X$B=X$d-X$D,X$c=X$D-X$R,X$Z=(-(X$A=(X$A=-(X$K-X$F))/(X$b=Math.sqrt(X$A*X$A+X$B*X$B))*X$_)+X$d)*(-(X$B=X$B/X$b*X$_)+X$F)-(-X$A+X$D)*(-X$B+X$K),X$E=(-(X$n=(X$n=-(X$F-X$$))/(X$b=Math.sqrt(X$n*X$n+X$c*X$c))*X$_)+X$R)*(-(X$c=X$c/X$b*X$_)+X$F)-(-X$n+X$D)*(-X$c+X$$),X$I=(X$e=-X$B+X$K-(-X$B+X$F))*(X$W=-X$n+X$D-(-X$n+X$R))-(X$H=-X$c+X$$-(-X$c+X$F))*(X$a=-X$A+X$D-(-X$A+X$d)),Math.abs(X$I)<.1?(X$I+=10.1,X$j.push(X$D-X$A+this.x,X$F-X$B+this.y,X$Q,X$M,X$u,X$D+X$A+this.x,X$F+X$B+this.y,X$Q,X$M,X$u)):(((X$k=(X$a*X$E-X$W*X$Z)/X$I)-X$D)*(X$k-X$D)+((X$Y=(X$H*X$Z-X$e*X$E)/X$I)-X$F)+(X$Y-X$F),X$j.push(X$k+this.x,X$Y+this.y,X$Q,X$M,X$u,X$D-(X$k-X$D)+this.x,X$F-(X$Y-X$F)+this.y,X$Q,X$M,X$u));X$d=X$T[X$T.length-4],X$K=X$T[X$T.length-3],X$B=X$d-(X$D=X$T[X$T.length-2]),X$A=(X$A=-(X$K-(X$F=X$T[X$T.length-1])))/(X$b=Math.sqrt(X$A*X$A+X$B*X$B))*X$_,X$B=X$B/X$b*X$_,X$j.push(X$D-X$A+this.x,X$F-X$B+this.y,X$Q,X$M,X$u,X$D+X$A+this.x,X$F+X$B+this.y,X$Q,X$M,X$u);var X$J=X$q;for(X$l=1;X$l<X$J;X$l++)X$p.push(X$S+2*(X$l-1),X$S+2*(X$l-1)+1,X$S+2*X$l+1,X$S+2*X$l+1,X$S+2*X$l,X$S+2*(X$l-1));return X$j},X$p.createLine=function(X$m,X$p,X$h,X$P){var X$L=X$m.concat(),X$q=X$m,X$k=this.borderColor,X$Y=(X$k>>16&255)/255,X$d=(X$k>>8&255)/255,X$K=(255&X$k)/255;X$L.splice(0,5);var X$D,X$F,X$R,X$$,X$A,X$B,X$n,X$c,X$e,X$a,X$Z,X$H,X$W,X$E,X$I,X$b,X$T,X$j,X$x,X$Q,X$M=X$L.length/5,X$u=X$P,X$N=X$h/2;X$R=X$L[0],X$$=X$L[1],X$a=X$R-(X$A=X$L[5]),X$e=(X$e=-(X$$-(X$B=X$L[6])))/(X$Q=Math.sqrt(X$e*X$e+X$a*X$a))*X$N,X$a=X$a/X$Q*X$N,X$q.push(X$R-X$e,X$$-X$a,X$Y,X$d,X$K,X$R+X$e,X$$+X$a,X$Y,X$d,X$K);for(var X$S=1;X$S<X$M-1;X$S++)X$R=X$L[5*(X$S-1)],X$$=X$L[5*(X$S-1)+1],X$A=X$L[5*X$S],X$B=X$L[5*X$S+1],X$n=X$L[5*(X$S+1)],X$c=X$L[5*(X$S+1)+1],X$a=X$R-X$A,X$H=X$A-X$n,X$I=(-(X$e=(X$e=-(X$$-X$B))/(X$Q=Math.sqrt(X$e*X$e+X$a*X$a))*X$N)+X$R)*(-(X$a=X$a/X$Q*X$N)+X$B)-(-X$e+X$A)*(-X$a+X$$),X$j=(-(X$Z=(X$Z=-(X$B-X$c))/(X$Q=Math.sqrt(X$Z*X$Z+X$H*X$H))*X$N)+X$n)*(-(X$H=X$H/X$Q*X$N)+X$B)-(-X$Z+X$A)*(-X$H+X$c),X$x=(X$W=-X$a+X$$-(-X$a+X$B))*(X$T=-X$Z+X$A-(-X$Z+X$n))-(X$b=-X$H+X$c-(-X$H+X$B))*(X$E=-X$e+X$A-(-X$e+X$R)),Math.abs(X$x)<.1?(X$x+=10.1,X$q.push(X$A-X$e,X$B-X$a,X$Y,X$d,X$K,X$A+X$e,X$B+X$a,X$Y,X$d,X$K)):(((X$D=(X$E*X$j-X$T*X$I)/X$x)-X$A)*(X$D-X$A)+((X$F=(X$b*X$I-X$W*X$j)/X$x)-X$B)+(X$F-X$B),X$q.push(X$D,X$F,X$Y,X$d,X$K,X$A-(X$D-X$A),X$B-(X$F-X$B),X$Y,X$d,X$K));X$R=X$L[X$L.length-10],X$$=X$L[X$L.length-9],X$a=X$R-(X$A=X$L[X$L.length-5]),X$e=(X$e=-(X$$-(X$B=X$L[X$L.length-4])))/(X$Q=Math.sqrt(X$e*X$e+X$a*X$a))*X$N,X$a=X$a/X$Q*X$N,X$q.push(X$A-X$e,X$B-X$a,X$Y,X$d,X$K,X$A+X$e,X$B+X$a,X$Y,X$d,X$K);var X$_=this.edges+1;for(X$S=1;X$S<X$_;X$S++)X$p.push(X$u+2*(X$S-1),X$u+2*(X$S-1)+1,X$u+2*X$S+1,X$u+2*X$S+1,X$u+2*X$S,X$u+2*(X$S-1));return X$q},X$p.createLoopLine=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=X$m.concat(),X$Y=X$L||X$m,X$d=this.borderColor,X$K=(X$d>>16&255)/255,X$D=(X$d>>8&255)/255,X$F=(255&X$d)/255;X$k.splice(0,5);var X$R=[X$k[0],X$k[1]],X$$=[X$k[X$k.length-5],X$k[X$k.length-4]],X$A=X$$[0]+.5*(X$R[0]-X$$[0]),X$B=X$$[1]+.5*(X$R[1]-X$$[1]);X$k.unshift(X$A,X$B,0,0,0),X$k.push(X$A,X$B,0,0,0);var X$n,X$c,X$e,X$a,X$Z,X$H,X$W,X$E,X$I,X$b,X$T,X$j,X$x,X$Q,X$M,X$u,X$N,X$S,X$_,X$l,X$J=X$k.length/5,X$z=X$P,X$w=X$h/2;X$e=X$k[0],X$a=X$k[1],X$b=X$e-(X$Z=X$k[5]),X$I=(X$I=-(X$a-(X$H=X$k[6])))/(X$l=Math.sqrt(X$I*X$I+X$b*X$b))*X$w,X$b=X$b/X$l*X$w,X$Y.push(X$e-X$I,X$a-X$b,X$K,X$D,X$F,X$e+X$I,X$a+X$b,X$K,X$D,X$F);for(var X$X=1;X$X<X$J-1;X$X++)X$e=X$k[5*(X$X-1)],X$a=X$k[5*(X$X-1)+1],X$Z=X$k[5*X$X],X$H=X$k[5*X$X+1],X$W=X$k[5*(X$X+1)],X$E=X$k[5*(X$X+1)+1],X$b=X$e-X$Z,X$j=X$Z-X$W,X$M=(-(X$I=(X$I=-(X$a-X$H))/(X$l=Math.sqrt(X$I*X$I+X$b*X$b))*X$w)+X$e)*(-(X$b=X$b/X$l*X$w)+X$H)-(-X$I+X$Z)*(-X$b+X$a),X$S=(-(X$T=(X$T=-(X$H-X$E))/(X$l=Math.sqrt(X$T*X$T+X$j*X$j))*X$w)+X$W)*(-(X$j=X$j/X$l*X$w)+X$H)-(-X$T+X$Z)*(-X$j+X$E),X$_=(X$x=-X$b+X$a-(-X$b+X$H))*(X$N=-X$T+X$Z-(-X$T+X$W))-(X$u=-X$j+X$E-(-X$j+X$H))*(X$Q=-X$I+X$Z-(-X$I+X$e)),Math.abs(X$_)<.1?(X$_+=10.1,X$Y.push(X$Z-X$I,X$H-X$b,X$K,X$D,X$F,X$Z+X$I,X$H+X$b,X$K,X$D,X$F)):(((X$n=(X$Q*X$S-X$N*X$M)/X$_)-X$Z)*(X$n-X$Z)+((X$c=(X$u*X$M-X$x*X$S)/X$_)-X$H)+(X$c-X$H),X$Y.push(X$n,X$c,X$K,X$D,X$F,X$Z-(X$n-X$Z),X$H-(X$c-X$H),X$K,X$D,X$F));X$q&&(X$p=X$q);var X$s=this.edges+1;for(X$X=1;X$X<X$s;X$X++)X$p.push(X$z+2*(X$X-1),X$z+2*(X$X-1)+1,X$z+2*X$X+1,X$z+2*X$X+1,X$z+2*X$X,X$z+2*(X$X-1));return X$p.push(X$z+2*(X$X-1),X$z+2*(X$X-1)+1,X$z+1,X$z+1,X$z,X$z+2*(X$X-1)),X$Y},X$m}(),X$Pm=function(){function X$B(){}return X$R(X$B,"laya.webgl.shapes.Earcut"),X$B.earcut=function(X$m,X$p,X$h){X$h=X$h||2;var X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D=X$p&&X$p.length,X$F=X$D?X$p[0]*X$h:X$m.length,X$R=X$B.linkedList(X$m,0,X$F,X$h,!0),X$$=[];if(!X$R)return X$$;if(X$D&&(X$R=X$B.eliminateHoles(X$m,X$p,X$R,X$h)),X$m.length>80*X$h){X$P=X$q=X$m[0],X$L=X$k=X$m[1];for(var X$A=X$h;X$A<X$F;X$A+=X$h)(X$Y=X$m[X$A])<X$P&&(X$P=X$Y),(X$d=X$m[X$A+1])<X$L&&(X$L=X$d),X$q<X$Y&&(X$q=X$Y),X$k<X$d&&(X$k=X$d);X$K=0!==(X$K=Math.max(X$q-X$P,X$k-X$L))?1/X$K:0}return X$B.earcutLinked(X$R,X$$,X$h,X$P,X$L,X$K),X$$},X$B.linkedList=function(X$m,X$p,X$h,X$P,X$L){var X$q,X$k;if(X$L===0<X$B.signedArea(X$m,X$p,X$h,X$P))for(X$q=X$p;X$q<X$h;X$q+=X$P)X$k=X$B.insertNode(X$q,X$m[X$q],X$m[X$q+1],X$k);else for(X$q=X$h-X$P;X$p<=X$q;X$q-=X$P)X$k=X$B.insertNode(X$q,X$m[X$q],X$m[X$q+1],X$k);return X$k&&X$B.equals(X$k,X$k.next)&&(X$B.removeNode(X$k),X$k=X$k.next),X$k},X$B.filterPoints=function(X$m,X$p){if(!X$m)return X$m;X$p||(X$p=X$m);var X$h,X$P=X$m;do{if(X$h=!1,X$P.steiner||!X$B.equals(X$P,X$P.next)&&0!==X$B.area(X$P.prev,X$P,X$P.next))X$P=X$P.next;else{if(X$B.removeNode(X$P),(X$P=X$p=X$P.prev)===X$P.next)break;X$h=!0}}while(X$h||X$P!==X$p);return X$p},X$B.earcutLinked=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){if(X$m){!X$k&&X$q&&X$B.indexCurve(X$m,X$P,X$L,X$q);for(var X$Y,X$d,X$K=X$m;X$m.prev!==X$m.next;)if(X$Y=X$m.prev,X$d=X$m.next,X$q?X$B.isEarHashed(X$m,X$P,X$L,X$q):X$B.isEar(X$m))X$p.push(X$Y.i/X$h),X$p.push(X$m.i/X$h),X$p.push(X$d.i/X$h),X$B.removeNode(X$m),X$m=X$d.next,X$K=X$d.next;else if((X$m=X$d)===X$K){X$k?1===X$k?(X$m=X$B.cureLocalIntersections(X$m,X$p,X$h),X$B.earcutLinked(X$m,X$p,X$h,X$P,X$L,X$q,2)):2===X$k&&X$B.splitEarcut(X$m,X$p,X$h,X$P,X$L,X$q):X$B.earcutLinked(X$B.filterPoints(X$m,null),X$p,X$h,X$P,X$L,X$q,1);break}}},X$B.isEar=function(X$m){var X$p=X$m.prev,X$h=X$m,X$P=X$m.next;if(0<=X$B.area(X$p,X$h,X$P))return!1;for(var X$L=X$m.next.next;X$L!==X$m.prev;){if(X$B.pointInTriangle(X$p.x,X$p.y,X$h.x,X$h.y,X$P.x,X$P.y,X$L.x,X$L.y)&&0<=X$B.area(X$L.prev,X$L,X$L.next))return!1;X$L=X$L.next}return!0},X$B.isEarHashed=function(X$m,X$p,X$h,X$P){var X$L=X$m.prev,X$q=X$m,X$k=X$m.next;if(0<=X$B.area(X$L,X$q,X$k))return!1;for(var X$Y=X$L.x<X$q.x?X$L.x<X$k.x?X$L.x:X$k.x:X$q.x<X$k.x?X$q.x:X$k.x,X$d=X$L.y<X$q.y?X$L.y<X$k.y?X$L.y:X$k.y:X$q.y<X$k.y?X$q.y:X$k.y,X$K=X$L.x>X$q.x?X$L.x>X$k.x?X$L.x:X$k.x:X$q.x>X$k.x?X$q.x:X$k.x,X$D=X$L.y>X$q.y?X$L.y>X$k.y?X$L.y:X$k.y:X$q.y>X$k.y?X$q.y:X$k.y,X$F=X$B.zOrder(X$Y,X$d,X$p,X$h,X$P),X$R=X$B.zOrder(X$K,X$D,X$p,X$h,X$P),X$$=X$m.nextZ;X$$&&X$$.z<=X$R;){if(X$$!==X$m.prev&&X$$!==X$m.next&&X$B.pointInTriangle(X$L.x,X$L.y,X$q.x,X$q.y,X$k.x,X$k.y,X$$.x,X$$.y)&&0<=X$B.area(X$$.prev,X$$,X$$.next))return!1;X$$=X$$.nextZ}for(X$$=X$m.prevZ;X$$&&X$$.z>=X$F;){if(X$$!==X$m.prev&&X$$!==X$m.next&&X$B.pointInTriangle(X$L.x,X$L.y,X$q.x,X$q.y,X$k.x,X$k.y,X$$.x,X$$.y)&&0<=X$B.area(X$$.prev,X$$,X$$.next))return!1;X$$=X$$.prevZ}return!0},X$B.cureLocalIntersections=function(X$m,X$p,X$h){var X$P=X$m;do{var X$L=X$P.prev,X$q=X$P.next.next;!X$B.equals(X$L,X$q)&&X$B.intersects(X$L,X$P,X$P.next,X$q)&&X$B.locallyInside(X$L,X$q)&&X$B.locallyInside(X$q,X$L)&&(X$p.push(X$L.i/X$h),X$p.push(X$P.i/X$h),X$p.push(X$q.i/X$h),X$B.removeNode(X$P),X$B.removeNode(X$P.next),X$P=X$m=X$q),X$P=X$P.next}while(X$P!==X$m);return X$P},X$B.splitEarcut=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=X$m;do{for(var X$Y=X$k.next.next;X$Y!==X$k.prev;){if(X$k.i!==X$Y.i&&X$B.isValidDiagonal(X$k,X$Y)){var X$d=X$B.splitPolygon(X$k,X$Y);return X$k=X$B.filterPoints(X$k,X$k.next),X$d=X$B.filterPoints(X$d,X$d.next),X$B.earcutLinked(X$k,X$p,X$h,X$P,X$L,X$q),void X$B.earcutLinked(X$d,X$p,X$h,X$P,X$L,X$q)}X$Y=X$Y.next}X$k=X$k.next}while(X$k!==X$m)},X$B.eliminateHoles=function(X$m,X$p,X$h,X$P){var X$L,X$q,X$k,X$Y,X$d,X$K=[];for(X$L=0,X$q=X$p.length;X$L<X$q;X$L++)X$k=X$p[X$L]*X$P,X$Y=X$L<X$q-1?X$p[X$L+1]*X$P:X$m.length,(X$d=X$B.linkedList(X$m,X$k,X$Y,X$P,!1))===X$d.next&&(X$d.steiner=!0),X$K.push(X$B.getLeftmost(X$d));for(X$K.sort(X$B.compareX),X$L=0;X$L<X$K.length;X$L++)X$B.eliminateHole(X$K[X$L],X$h),X$h=X$B.filterPoints(X$h,X$h.next);return X$h},X$B.compareX=function(X$m,X$p){return X$m.x-X$p.x},X$B.eliminateHole=function(X$m,X$p){if(X$p=X$B.findHoleBridge(X$m,X$p)){var X$h=X$B.splitPolygon(X$p,X$m);X$B.filterPoints(X$h,X$h.next)}},X$B.findHoleBridge=function(X$m,X$p){var X$h,X$P=X$p,X$L=X$m.x,X$q=X$m.y,X$k=-1/0;do{if(X$q<=X$P.y&&X$q>=X$P.next.y&&X$P.next.y!==X$P.y){var X$Y=X$P.x+(X$q-X$P.y)*(X$P.next.x-X$P.x)/(X$P.next.y-X$P.y);if(X$Y<=X$L&&X$k<X$Y){if((X$k=X$Y)===X$L){if(X$q===X$P.y)return X$P;if(X$q===X$P.next.y)return X$P.next}X$h=X$P.x<X$P.next.x?X$P:X$P.next}}X$P=X$P.next}while(X$P!==X$p);if(!X$h)return null;if(X$L===X$k)return X$h.prev;var X$d,X$K=X$h,X$D=X$h.x,X$F=X$h.y,X$R=1/0;for(X$P=X$h.next;X$P!==X$K;)X$L>=X$P.x&&X$P.x>=X$D&&X$L!==X$P.x&&X$B.pointInTriangle(X$q<X$F?X$L:X$k,X$q,X$D,X$F,X$q<X$F?X$k:X$L,X$q,X$P.x,X$P.y)&&((X$d=Math.abs(X$q-X$P.y)/(X$L-X$P.x))<X$R||X$d===X$R&&X$P.x>X$h.x)&&X$B.locallyInside(X$P,X$m)&&(X$h=X$P,X$R=X$d),X$P=X$P.next;return X$h},X$B.indexCurve=function(X$m,X$p,X$h,X$P){for(var X$L=X$m;null===X$L.z&&(X$L.z=X$B.zOrder(X$L.x,X$L.y,X$p,X$h,X$P)),X$L.prevZ=X$L.prev,X$L.nextZ=X$L.next,(X$L=X$L.next)!==X$m;);X$L.prevZ.nextZ=null,X$L.prevZ=null,X$B.sortLinked(X$L)},X$B.sortLinked=function(X$m){var X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K=1;do{for(X$h=X$m,X$q=X$m=null,X$k=0;X$h;){for(X$k++,X$P=X$h,X$p=X$Y=0;X$p<X$K&&(X$Y++,X$P=X$P.nextZ);X$p++);for(X$d=X$K;0<X$Y||0<X$d&&X$P;)0!==X$Y&&(0===X$d||!X$P||X$h.z<=X$P.z)?(X$h=(X$L=X$h).nextZ,X$Y--):(X$P=(X$L=X$P).nextZ,X$d--),X$q?X$q.nextZ=X$L:X$m=X$L,X$L.prevZ=X$q,X$q=X$L;X$h=X$P}X$q.nextZ=null,X$K*=2}while(1<X$k);return X$m},X$B.zOrder=function(X$m,X$p,X$h,X$P,X$L){return(X$m=1431655765&((X$m=858993459&((X$m=252645135&((X$m=16711935&((X$m=32767*(X$m-X$h)*X$L)|X$m<<8))|X$m<<4))|X$m<<2))|X$m<<1))|(X$p=1431655765&((X$p=858993459&((X$p=252645135&((X$p=16711935&((X$p=32767*(X$p-X$P)*X$L)|X$p<<8))|X$p<<4))|X$p<<2))|X$p<<1))<<1},X$B.getLeftmost=function(X$m){for(var X$p=X$m,X$h=X$m;X$p.x<X$h.x&&(X$h=X$p),(X$p=X$p.next)!==X$m;);return X$h},X$B.pointInTriangle=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){return 0<=(X$L-X$k)*(X$p-X$Y)-(X$m-X$k)*(X$q-X$Y)&&0<=(X$m-X$k)*(X$P-X$Y)-(X$h-X$k)*(X$p-X$Y)&&0<=(X$h-X$k)*(X$q-X$Y)-(X$L-X$k)*(X$P-X$Y)},X$B.isValidDiagonal=function(X$m,X$p){return X$m.next.i!==X$p.i&&X$m.prev.i!==X$p.i&&!X$B.intersectsPolygon(X$m,X$p)&&X$B.locallyInside(X$m,X$p)&&X$B.locallyInside(X$p,X$m)&&X$B.middleInside(X$m,X$p)},X$B.area=function(X$m,X$p,X$h){return(X$p.y-X$m.y)*(X$h.x-X$p.x)-(X$p.x-X$m.x)*(X$h.y-X$p.y)},X$B.equals=function(X$m,X$p){return X$m.x===X$p.x&&X$m.y===X$p.y},X$B.intersects=function(X$m,X$p,X$h,X$P){return!!(X$B.equals(X$m,X$p)&&X$B.equals(X$h,X$P)||X$B.equals(X$m,X$P)&&X$B.equals(X$h,X$p))||0<X$B.area(X$m,X$p,X$h)!=0<X$B.area(X$m,X$p,X$P)&&0<X$B.area(X$h,X$P,X$m)!=0<X$B.area(X$h,X$P,X$p)},X$B.intersectsPolygon=function(X$m,X$p){var X$h=X$m;do{if(X$h.i!==X$m.i&&X$h.next.i!==X$m.i&&X$h.i!==X$p.i&&X$h.next.i!==X$p.i&&X$B.intersects(X$h,X$h.next,X$m,X$p))return!0;X$h=X$h.next}while(X$h!==X$m);return!1},X$B.locallyInside=function(X$m,X$p){return X$B.area(X$m.prev,X$m,X$m.next)<0?0<=X$B.area(X$m,X$p,X$m.next)&&0<=X$B.area(X$m,X$m.prev,X$p):X$B.area(X$m,X$p,X$m.prev)<0||X$B.area(X$m,X$m.next,X$p)<0},X$B.middleInside=function(X$m,X$p){for(var X$h=X$m,X$P=!1,X$L=(X$m.x+X$p.x)/2,X$q=(X$m.y+X$p.y)/2;X$h.y>X$q!=X$h.next.y>X$q&&X$h.next.y!==X$h.y&&X$L<(X$h.next.x-X$h.x)*(X$q-X$h.y)/(X$h.next.y-X$h.y)+X$h.x&&(X$P=!X$P),(X$h=X$h.next)!==X$m;);return X$P},X$B.splitPolygon=function(X$m,X$p){var X$h=new X$Lm(X$m.i,X$m.x,X$m.y),X$P=new X$Lm(X$p.i,X$p.x,X$p.y),X$L=X$m.next,X$q=X$p.prev;return(X$m.next=X$p).prev=X$m,(X$h.next=X$L).prev=X$h,(X$P.next=X$h).prev=X$P,(X$q.next=X$P).prev=X$q,X$P},X$B.insertNode=function(X$m,X$p,X$h,X$P){var X$L=new X$Lm(X$m,X$p,X$h);return X$P?(X$L.next=X$P.next,(X$L.prev=X$P).next.prev=X$L,X$P.next=X$L):(X$L.prev=X$L).next=X$L,X$L},X$B.removeNode=function(X$m){X$m.next.prev=X$m.prev,X$m.prev.next=X$m.next,X$m.prevZ&&(X$m.prevZ.nextZ=X$m.nextZ),X$m.nextZ&&(X$m.nextZ.prevZ=X$m.prevZ)},X$B.signedArea=function(X$m,X$p,X$h,X$P){for(var X$L=0,X$q=X$p,X$k=X$h-X$P;X$q<X$h;X$q+=X$P)X$L+=(X$m[X$k]-X$m[X$q])*(X$m[X$q+1]+X$m[X$k+1]),X$k=X$q;return X$L},X$B}(),X$Lm=function(){function X$m(X$m,X$p,X$h){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=X$m,this.x=X$p,this.y=X$h,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return X$R(X$m,"laya.webgl.shapes.EarcutNode"),X$m}(),X$qm=(function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this.lineWidth=X$m,this.lineColor=X$p,this.lineAlpha=X$h,this.fillColor=X$P,this.fillAlpha=X$L,this.shape=X$k,this.fill=X$q}X$R(X$m,"laya.webgl.shapes.GeometryData");var X$p=X$m.prototype;X$p.clone=function(){return new X$m(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},X$p.getIndexData=function(){return null},X$p.getVertexData=function(){return null},X$p.destroy=function(){this.shape=null}}(),function(){function X$m(X$m){if(X$m instanceof Float32Array)this.points=X$m;else if(X$m instanceof Array){X$m.length;this.points=new Float32Array(X$m)}}X$R(X$m,"laya.webgl.shapes.Vertex");var X$p=X$m.prototype;X$W.imps(X$p,{"laya.webgl.shapes.IShape":!0}),X$p.getData=function(X$m,X$p,X$h){},X$p.needUpdate=function(X$m){return!1},X$p.rebuild=function(X$m){},X$p.setMatrix=function(X$m){}}(),function(){function X$d(X$m){void 0===X$m&&(X$m=1e4),this._renderType=X$m}X$R(X$d,"laya.webgl.submit.Submit");var X$m=X$d.prototype;return X$W.imps(X$m,{"laya.webgl.submit.ISubmit":!0}),X$m.releaseRender=function(){var X$m=X$d._cache;(X$m[X$m._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},X$m.getRenderType=function(){return this._renderType},X$m.renderSubmit=function(){if(0===this._numEle)return 1;var X$m=this.shaderValue.textureHost;if(X$m){var X$p=X$m.source;if(!X$m.bitmap||!X$p)return 1;this.shaderValue.texture=X$p,X$m.alphaTexture&&X$m.alphaTexture.source&&(this.shaderValue.texture1=X$m.alphaTexture.source)}this._vb.bind_upload(this._ib);var X$h=X$Zm.mainContext;return this.shaderValue.upload(),X$U.activeBlendFunction!==this._blendFn&&(X$h.enable(3042),this._blendFn(X$h),X$U.activeBlendFunction=this._blendFn),X$M.drawCall++,X$M.trianglesFaces+=this._numEle/3,X$h.drawElements(4,this._numEle,5123,this._startIdx),1},X$d.__init__=function(){var X$m=X$d.RENDERBASE=new X$d(-1);X$m.shaderValue=new X$Im(0,0),X$m.shaderValue.ALPHA=-1234},X$d.createSubmit=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$d._cache._length?X$d._cache[--X$d._cache._length]:new X$d;null==X$h&&((X$h=X$q._selfVb||(X$q._selfVb=X$Cm.create(-1))).clear(),X$P=0),X$q._ib=X$p,X$q._vb=X$h,X$q._startIdx=X$P*X$Bm.BYTES_PIDX,X$q._numEle=0;var X$k=X$m._nBlendType;X$q._blendFn=X$m._targets?X$U.targetFns[X$k]:X$U.fns[X$k],X$q.shaderValue=X$L,X$q.shaderValue.setValue(X$m._shader2D);var X$Y=X$m._shader2D.filters;return X$Y&&X$q.shaderValue.setFilters(X$Y),X$q},X$d.createShape=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=X$d._cache._length?X$d._cache[--X$d._cache._length]:new X$d;X$k._ib=X$p,X$k._vb=X$h,X$k._numEle=X$P,X$k._startIdx=X$L,X$k.shaderValue=X$q,X$k.shaderValue.setValue(X$m._shader2D);var X$Y=X$m._nBlendType;return X$k._blendFn=X$m._targets?X$U.targetFns[X$Y]:X$U.fns[X$Y],X$k},X$d.TYPE_2D=1e4,X$d.TYPE_CANVAS=10003,X$d.TYPE_CMDSETRT=10004,X$d.TYPE_CUSTOM=10005,X$d.TYPE_BLURRT=10006,X$d.TYPE_CMDDESTORYPRERT=10007,X$d.TYPE_DISABLESTENCIL=10008,X$d.TYPE_OTHERIBVB=10009,X$d.TYPE_PRIMITIVE=10010,X$d.TYPE_RT=10011,X$d.TYPE_BLUR_RT=10012,X$d.TYPE_TARGET=10013,X$d.TYPE_CHANGE_VALUE=10014,X$d.TYPE_SHAPE=10015,X$d.TYPE_TEXTURE=10016,X$d.TYPE_FILLTEXTURE=10017,X$d.RENDERBASE=null,X$d._cache=((X$d._cache=[])._length=0,X$d._cache),X$d}()),X$km=function(){function X$P(){this.fun=null,this.args=null}X$R(X$P,"laya.webgl.submit.SubmitCMD");var X$m=X$P.prototype;return X$W.imps(X$m,{"laya.webgl.submit.ISubmit":!0}),X$m.renderSubmit=function(){return this.fun.apply(null,this.args),1},X$m.getRenderType=function(){return 0},X$m.releaseRender=function(){var X$m=X$P._cache;X$m[X$m._length++]=this},X$P.create=function(X$m,X$p){var X$h=X$P._cache._length?X$P._cache[--X$P._cache._length]:new X$P;return X$h.fun=X$p,X$h.args=X$m,X$h},X$P._cache=((X$P._cache=[])._length=0,X$P._cache),X$P}(),X$Ym=function(){function X$p(){this.variables={}}X$R(X$p,"laya.webgl.submit.SubmitCMDScope");var X$m=X$p.prototype;return X$m.getValue=function(X$m){return this.variables[X$m]},X$m.addValue=function(X$m,X$p){return this.variables[X$m]=X$p},X$m.setValue=function(X$m,X$p){return this.variables.hasOwnProperty(X$m)?this.variables[X$m]=X$p:null},X$m.clear=function(){for(var X$m in this.variables)delete this.variables[X$m]},X$m.recycle=function(){this.clear(),X$p.POOL.push(this)},X$p.create=function(){var X$m=X$p.POOL.pop();return X$m||(X$m=new X$p),X$m},X$p.POOL=[],X$p}(),X$dm=function(){function X$F(){this.offset=0,this.startIndex=0,this._mat=X$b.create()}X$R(X$F,"laya.webgl.submit.SubmitOtherIBVB");var X$m=X$F.prototype;return X$W.imps(X$m,{"laya.webgl.submit.ISubmit":!0}),X$m.releaseRender=function(){var X$m=X$F._cache;(X$m[X$m._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},X$m.getRenderType=function(){return 10009},X$m.renderSubmit=function(){var X$m=this._shaderValue.textureHost;if(X$m){var X$p=X$m.source;if(!X$m.bitmap||!X$p)return 1;this._shaderValue.texture=X$p}this._vb.bind_upload(this._ib);var X$h=X$em.worldMatrix4,X$P=X$b.TEMP;X$b.mulPre(this._mat,X$h[0],X$h[1],X$h[4],X$h[5],X$h[12],X$h[13],X$P);var X$L=X$em.worldMatrix4=X$F.tempMatrix4;X$L[0]=X$P.a,X$L[1]=X$P.b,X$L[4]=X$P.c,X$L[5]=X$P.d,X$L[12]=X$P.tx,X$L[13]=X$P.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var X$q=X$Zm.mainContext;return X$U.activeBlendFunction!==this._blendFn&&(X$q.enable(3042),this._blendFn(X$q),X$U.activeBlendFunction=this._blendFn),X$M.drawCall++,X$M.trianglesFaces+=this._numEle/3,X$q.drawElements(4,this._numEle,5123,this.startIndex),X$em.worldMatrix4=X$h,X$lm.activeShader=null,1},X$F.create=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){void 0===X$d&&(X$d=0);var X$K=X$F._cache._length?X$F._cache[--X$F._cache._length]:new X$F;X$K._ib=X$h,X$K._vb=X$p,X$K._numEle=X$P,X$K._shader=X$L,X$K._shaderValue=X$q;var X$D=X$m._nBlendType;switch(X$K._blendFn=X$m._targets?X$U.targetFns[X$D]:X$U.fns[X$D],X$d){case 0:X$K.offset=0,X$K.startIndex=X$Y/(X$Bm.BYTES_PE*X$p.vertexStride)*1.5,X$K.startIndex*=X$Bm.BYTES_PIDX;break;case 1:X$K.startIndex=X$k,X$K.offset=X$Y}return X$K},X$F._cache=((X$F._cache=[])._length=0,X$F._cache),X$F.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],X$F}(),X$Km=function(){function X$h(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new X$j,this.screenRect=new X$j}X$R(X$h,"laya.webgl.submit.SubmitScissor");var X$m=X$h.prototype;return X$W.imps(X$m,{"laya.webgl.submit.ISubmit":!0}),X$m._scissor=function(X$m,X$p,X$h,X$P){var X$L=X$em.worldMatrix4,X$q=X$L[0],X$k=X$L[5],X$Y=X$L[12],X$d=X$L[13];if(X$P*=X$k,(X$h*=X$q)<1||X$P<1)return!1;var X$K=(X$m=X$m*X$q+X$Y)+X$h,X$D=(X$p=X$p*X$k+X$d)+X$P;X$m<0&&(X$h=X$K-(X$m=0)),X$p<0&&(X$P=X$D-(X$p=0));var X$F=X$em.worldClipRect;if(X$m=Math.max(X$m,X$F.x),X$p=Math.max(X$p,X$F.y),X$h=Math.min(X$K,X$F.right)-X$m,X$P=Math.min(X$D,X$F.bottom)-X$p,X$h<1||X$P<1)return!1;var X$R=X$em.worldScissorTest;return this.screenRect.copyFrom(X$F),X$F.x=X$m,X$F.y=X$p,X$F.width=X$h,X$F.height=X$P,X$em.worldScissorTest=!0,X$p=X$em.height-X$p-X$P,X$Zm.mainContext.scissor(X$m,X$p,X$h,X$P),X$Zm.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),X$R?(X$p=X$em.height-this.screenRect.y-this.screenRect.height,X$Zm.mainContext.scissor(this.screenRect.x,X$p,this.screenRect.width,this.screenRect.height),X$Zm.mainContext.enable(3089)):(X$Zm.mainContext.disable(3089),X$em.worldScissorTest=!1),X$F.copyFrom(this.screenRect),!0},X$m._scissorWithTagart=function(X$m,X$p,X$h,X$P){if(X$h<1||X$P<1)return!1;var X$L=X$m+X$h,X$q=X$p+X$P;X$m<0&&(X$h=X$L-(X$m=0)),X$p<0&&(X$P=X$q-(X$p=0));var X$k=X$em.worldClipRect;if(X$m=Math.max(X$m,X$k.x),X$p=Math.max(X$p,X$k.y),X$h=Math.min(X$L,X$k.right)-X$m,X$P=Math.min(X$q,X$k.bottom)-X$p,X$h<1||X$P<1)return!1;var X$Y=X$em.worldScissorTest;return this.screenRect.copyFrom(X$k),X$em.worldScissorTest=!0,X$k.x=X$m,X$k.y=X$p,X$k.width=X$h,X$k.height=X$P,X$p=X$em.height-X$p-X$P,X$Zm.mainContext.scissor(X$m,X$p,X$h,X$P),X$Zm.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),X$Y?(X$p=X$em.height-this.screenRect.y-this.screenRect.height,X$Zm.mainContext.scissor(this.screenRect.x,X$p,this.screenRect.width,this.screenRect.height),X$Zm.mainContext.enable(3089)):(X$Zm.mainContext.disable(3089),X$em.worldScissorTest=!1),X$k.copyFrom(this.screenRect),!0},X$m.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},X$m.getRenderType=function(){return 0},X$m.releaseRender=function(){var X$m=X$h._cache;(X$m[X$m._length++]=this).context=null},X$h.create=function(X$m){var X$p=X$h._cache._length?X$h._cache[--X$h._cache._length]:new X$h;return X$p.context=X$m,X$p},X$h._cache=((X$h._cache=[])._length=0,X$h._cache),X$h}(),X$Dm=function(){function X$d(){this.step=0,this.blendMode=null,this.level=0}X$R(X$d,"laya.webgl.submit.SubmitStencil");var X$m=X$d.prototype;return X$W.imps(X$m,{"laya.webgl.submit.ISubmit":!0}),X$m.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},X$m.getRenderType=function(){return 0},X$m.releaseRender=function(){var X$m=X$d._cache;X$m[X$m._length++]=this},X$m.do1=function(){var X$m=X$Zm.mainContext;X$m.enable(2960),X$m.clear(1024),X$m.colorMask(!1,!1,!1,!1),X$m.stencilFunc(514,this.level,255),X$m.stencilOp(7680,7680,7682)},X$m.do2=function(){var X$m=X$Zm.mainContext;X$m.stencilFunc(514,this.level+1,255),X$m.colorMask(!0,!0,!0,!0),X$m.stencilOp(7680,7680,7680)},X$m.do3=function(){var X$m=X$Zm.mainContext;X$m.colorMask(!0,!0,!0,!0),X$m.stencilOp(7680,7680,7680),X$m.clear(1024),X$m.disable(2960)},X$m.do4=function(){var X$m=X$Zm.mainContext;0==this.level&&(X$m.enable(2960),X$m.clear(1024)),X$m.colorMask(!1,!1,!1,!1),X$m.stencilFunc(519,0,255),X$m.stencilOp(7680,7680,7682)},X$m.do5=function(){var X$m=X$Zm.mainContext;X$m.stencilFunc(514,this.level,255),X$m.colorMask(!0,!0,!0,!0),X$m.stencilOp(7680,7680,7680)},X$m.do6=function(){var X$m=X$Zm.mainContext;X$U.targetFns[X$U.TOINT[this.blendMode]](X$m)},X$m.do7=function(){var X$m=X$Zm.mainContext;X$m.colorMask(!1,!1,!1,!1),X$m.stencilOp(7680,7680,7683)},X$m.do8=function(){var X$m=X$Zm.mainContext;X$m.colorMask(!0,!0,!0,!0),X$m.stencilFunc(514,this.level,255),X$m.stencilOp(7680,7680,7680)},X$d.restore=function(X$m,X$p,X$h,X$P,X$L){var X$q;if((X$m._renderKey=0)<X$d._mask&&X$d._mask--,0==X$d._mask)X$q=laya.webgl.submit.SubmitStencil.create(3),X$m.addRenderObject(X$q),X$m._curSubmit=X$qm.RENDERBASE;else{X$q=laya.webgl.submit.SubmitStencil.create(7),X$m.addRenderObject(X$q);var X$k=X$m._vb;X$k._byteLength;if(X$nm.fillRectImgVb(X$k,null,X$p.x,X$p.y,X$p.width,X$p.height,X$_.DEF_UV,X$h,X$P,X$L,0,0)){X$m._shader2D.glTexture=null;var X$Y=X$m._curSubmit=X$qm.createSubmit(X$m,X$m._ib,X$k,(X$k._byteLength-64)/32*3,X$Im.create(2,0));X$Y.shaderValue.ALPHA=1,X$m._submits[X$m._submits._length++]=X$Y,X$m._curSubmit._numEle+=6,X$m._curSubmit=X$qm.RENDERBASE}else alert("clipRect calc stencil rect error");X$q=laya.webgl.submit.SubmitStencil.create(8),X$m.addRenderObject(X$q)}},X$d.restore2=function(X$m,X$p){var X$h;(X$m._renderKey=0)<X$d._mask&&X$d._mask--,0==X$d._mask?(X$h=laya.webgl.submit.SubmitStencil.create(3),X$m.addRenderObject(X$h),X$m._curSubmit=X$qm.RENDERBASE):(X$h=laya.webgl.submit.SubmitStencil.create(7),X$m.addRenderObject(X$h),X$m._submits[X$m._submits._length++]=X$p,X$h=laya.webgl.submit.SubmitStencil.create(8),X$m.addRenderObject(X$h))},X$d.create=function(X$m){var X$p=X$d._cache._length?X$d._cache[--X$d._cache._length]:new X$d;return 5==(X$p.step=X$m)&&++X$d._mask,X$p.level=X$d._mask,X$p},X$d._cache=((X$d._cache=[])._length=0,X$d._cache),X$d._mask=0,X$d}(),X$Fm=function(){function X$Y(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}X$R(X$Y,"laya.webgl.submit.SubmitTarget");var X$m=X$Y.prototype;return X$W.imps(X$m,{"laya.webgl.submit.ISubmit":!0}),X$m.renderSubmit=function(){this._vb.bind_upload(this._ib);var X$m=this.scope.getValue(this.proName);return X$m&&(this.shaderValue.texture=X$m.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[X$m.width,X$m.height]),this.shaderValue.upload(),this.blend(),X$M.drawCall++,X$M.trianglesFaces+=this._numEle/3,X$Zm.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},X$m.blend=function(){if(X$U.activeBlendFunction!==X$U.fns[this.blendType]){var X$m=X$Zm.mainContext;X$m.enable(3042),X$U.fns[this.blendType](X$m),X$U.activeBlendFunction=X$U.fns[this.blendType]}},X$m.getRenderType=function(){return 0},X$m.releaseRender=function(){var X$m=X$Y._cache;(X$m[X$m._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},X$Y.create=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=X$Y._cache._length?X$Y._cache[--X$Y._cache._length]:new X$Y;return X$k._ib=X$p,X$k._vb=X$h,X$k.proName=X$q,X$k._startIdx=X$P*X$Bm.BYTES_PIDX,X$k._numEle=0,X$k.blendType=X$m._nBlendType,X$k.shaderValue=X$L,X$k.shaderValue.setValue(X$m._shader2D),X$k},X$Y._cache=((X$Y._cache=[])._length=0,X$Y._cache),X$Y}(),X$Rm=function(){function X$m(){this._sourceStr=null}X$R(X$m,"laya.webgl.text.CharSegment");var X$p=X$m.prototype;return X$W.imps(X$p,{"laya.webgl.text.ICharSegment":!0}),X$p.textToSpit=function(X$m){this._sourceStr=X$m},X$p.getChar=function(X$m){return this._sourceStr.charAt(X$m)},X$p.getCharCode=function(X$m){return this._sourceStr.charCodeAt(X$m)},X$p.length=function(){return this._sourceStr.length},X$m}(),X$$m=function(){var X$m;function X$M(){}return X$R(X$M,"laya.webgl.text.DrawText"),X$M.__init__=function(){X$M._charsTemp=new Array,X$M._drawValue=new X$m,X$M._charSeg=new X$Rm},X$M.customCharSeg=function(X$m){X$M._charSeg=X$m},X$M.getChar=function(X$m,X$p,X$h){var X$P=X$Vm.createOneChar(X$m,X$h);return-1!=X$p&&(X$M._charsCache[X$p]=X$P),X$P},X$M._drawSlow=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D,X$F,X$R,X$$,X$A){var X$B,X$n,X$c=X$M._drawValue.value(X$q,X$Y,X$d,X$K,X$R,X$$,X$A),X$e=0,X$a=0,X$Z=X$M._charsTemp,X$H=0,X$W=NaN;if(X$P)for(X$Z.length=X$P.length,X$e=0,X$a=X$P.length;X$e<X$a;X$e++)(X$n=X$P[X$e])&&(X$W=X$n.charNum+X$c.txtID,X$Z[X$e]=X$B=X$M._charsCache[X$W]||X$M.getChar(X$n.char,X$W,X$c),X$B.active());else{var X$E=X$h instanceof laya.utils.WordText?X$h.toString():X$h;if(X$S.CharacterCache){X$M._charSeg.textToSpit(X$E);var X$I=X$M._charSeg.length();for(X$e=0,X$a=X$Z.length=X$I;X$e<X$a;X$e++)X$W=X$M._charSeg.getCharCode(X$e)+X$c.txtID,X$Z[X$e]=X$B=X$M._charsCache[X$W]||X$M.getChar(X$M._charSeg.getChar(X$e),X$W,X$c),X$B.active(),X$H+=X$B.cw}else X$Z.length=0,(X$B=X$M.getChar(X$E,-1,X$c)).active(),X$H+=X$B.cw,X$Z[0]=X$B}var X$b=0;null!==X$k&&"left"!==X$k&&(X$b=-("center"==X$k?X$H/2:X$H));var X$T,X$j,X$x=NaN,X$Q=0;if(X$P)for(X$e=0,X$a=X$Z.length;X$e<X$a;X$e++)X$B=X$Z[X$e],X$n=X$P[X$e],X$B&&X$n&&!X$B.isSpace&&(X$x=X$B.borderSize,X$T=X$B.texture,X$p._drawText(X$T,X$D+X$b+X$n.x*X$R-X$x,X$F+X$n.y*X$$-X$x,X$T.width,X$T.height,X$L,0,0,0,0));else{for(X$e=0,X$a=X$Z.length;X$e<X$a;X$e++)(X$B=X$Z[X$e])&&!X$B.isSpace&&(X$x=X$B.borderSize,X$T=X$B.texture,X$p._drawText(X$T,X$D+X$b-X$x,X$F-X$x,X$T.width,X$T.height,X$L,0,0,0,0),X$m&&((X$j=X$m[X$Q++])||(X$j=X$m[X$Q-1]=[]),X$j[0]=X$T,X$j[1]=X$b-X$x,X$j[2]=-X$x)),X$b+=X$B.cw;X$m&&(X$m.length=X$Q)}},X$M._drawFast=function(X$m,X$p,X$h,X$P,X$L){for(var X$q,X$k,X$Y=0,X$d=X$m.length;X$Y<X$d;X$Y++)(X$q=(X$k=X$m[X$Y])[0]).active(),X$p._drawText(X$q,X$P+X$k[1],X$L+X$k[2],X$q.width,X$q.height,X$h,0,0,0,0)},X$M.drawText=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D,X$F){if(void 0===X$F&&(X$F=0),!(X$p&&0===X$p.length||X$h&&0===X$h.length)){var X$R=X$P.a,X$$=X$P.d;(0!==X$P.b||0!==X$P.c)&&(X$R=X$$=1);var X$A=1!==X$R||1!==X$$;if(X$A&&X$W.stage.transform){var X$B=X$W.stage.transform;X$A=X$B.a===X$R&&X$B.d===X$$}else X$A=!1;if(X$A){var X$n=(X$P=X$P.copyTo(X$Em._tmpMatrix)).tx,X$c=X$P.ty;X$P.scale(1/X$R,1/X$$),X$P._checkTransform(),X$K*=X$R,X$D*=X$$,X$K+=X$n-X$P.tx,X$D+=X$c-X$P.ty}else X$R=X$$=1;if(X$h)X$M._drawSlow(null,X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D,X$R,X$$,X$F);else{if(null===X$p.toUpperCase){var X$e=X$R+1e5*X$$,X$a=X$p;return void(X$a.changed||X$a.id!==X$e?(X$a.id=X$e,X$a.changed=!1,X$M._drawSlow(X$a.save,X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D,X$R,X$$,X$F)):X$M._drawFast(X$a.save,X$m,X$P,X$K,X$D))}var X$Z=X$p+X$L.toString()+X$k+X$Y+X$d+X$R+X$$+X$q,X$H=X$M._textsCache[X$Z];X$S.CharacterCache?X$H?X$M._drawFast(X$H,X$m,X$P,X$K,X$D):(X$M._textsCache.__length||(X$M._textsCache.__length=0),X$M._textsCache.__length>X$E.WebGLTextCacheCount&&((X$M._textsCache={}).__length=0,X$M._curPoolIndex=0),X$M._textCachesPool[X$M._curPoolIndex]?(X$H=X$M._textsCache[X$Z]=X$M._textCachesPool[X$M._curPoolIndex]).length=0:X$M._textCachesPool[X$M._curPoolIndex]=X$H=X$M._textsCache[X$Z]=[],X$M._textsCache.__length++,X$M._curPoolIndex++,X$M._drawSlow(X$H,X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D,X$R,X$$,X$F)):X$M._drawSlow(X$H,X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D,X$R,X$$,X$F)}}},X$M._charsTemp=null,X$M._textCachesPool=[],X$M._curPoolIndex=0,X$M._charsCache={},X$M._textsCache={},X$M._drawValue=null,X$M.d=[],X$M._charSeg=null,X$M.__init$=function(){X$m=function(){function X$d(){}return X$R(X$d,""),X$d.prototype.value=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this.font=X$m,this.fillColor=X$p,this.borderColor=X$h,this.lineWidth=X$P,this.scaleX=X$L,this.scaleY=X$q,this.underLine=X$k;var X$Y=X$m.toString()+X$L+X$q+X$P+(X$p?X$p.toLowerCase():" ")+(X$h?X$h.toLowerCase():" ")+X$k;return this.txtID=X$d._keymap[X$Y],this.txtID||(this.txtID=1e-7*++X$d._keymapCount,X$d._keymap[X$Y]=this.txtID),this},X$d.clear=function(){X$d._keymap={},X$d._keymapCount=1},X$d._keymap={},X$d._keymapCount=1,X$d}()},X$M}(),X$Am=function(){function X$L(X$m){this._index=0,this._size=14,this._italic=-2,X$L._cache2=X$L._cache2||[],this.setFont(X$m||"14px Arial")}X$R(X$L,"laya.webgl.text.FontInContext");var X$m=X$L.prototype;return X$m.setFont=function(X$m){var X$p=X$L._cache2[X$m];if(X$p)this._words=X$p[0],this._size=X$p[1];else{this._words=X$m.split(" ");for(var X$h=0,X$P=this._words.length;X$h<X$P;X$h++)if(0<this._words[X$h].indexOf("px")){this._index=X$h;break}this._size=parseInt(this._words[this._index]),X$L._cache2[X$m]=[this._words,this._size]}this._text=null,this._italic=-2},X$m.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},X$m.hasType=function(X$m){for(var X$p=0,X$h=this._words.length;X$p<X$h;X$p++)if(this._words[X$p]===X$m)return X$p;return-1},X$m.removeType=function(X$m){for(var X$p=0,X$h=this._words.length;X$p<X$h;X$p++)if(this._words[X$p]===X$m){this._words.splice(X$p,1),this._index>X$p&&this._index--;break}this._text=null,this._italic=-2},X$m.copyTo=function(X$m){return X$m._text=this._text,X$m._size=this._size,X$m._index=this._index,X$m._words=this._words.slice(),X$m._italic=-2,X$m},X$m.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},X$P(0,X$m,"size",function(){return this._size},function(X$m){this._size=X$m,this._words[this._index]=X$m+"px",this._text=null}),X$L.create=function(X$m){var X$p=X$L._cache[X$m];return X$p||(X$p=X$L._cache[X$m]=new X$L(X$m))},X$L.EMPTY=new X$L,X$L._cache={},X$L._cache2=null,X$L}(),X$Bm=function(){function X$m(){}return X$R(X$m,"laya.webgl.utils.CONST3D2D"),X$m.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],X$m.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],X$m.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],X$m._TMPARRAY=[],X$m._OFFSETX=0,X$m._OFFSETY=0,X$k(X$m,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),X$m}(),X$nm=function(){function X$A(){}return X$R(X$A,"laya.webgl.utils.GlUtils"),X$A.make2DProjection=function(X$m,X$p,X$h){return[2/X$m,0,0,0,0,-2/X$p,0,0,0,0,2/X$h,0,-1,1,0,1]},X$A.fillIBQuadrangle=function(X$m,X$p){if(65535/4<X$p)throw Error("IBQuadrangle count:"+X$p+" must<:"+Math.floor(65535/4));X$p=Math.floor(X$p),X$m._resizeBuffer(6*(X$p+1)*2,!1),X$m.byteLength=X$m.bufferLength;for(var X$h=X$m.getUint16Array(),X$P=0,X$L=0;X$L<X$p;X$L++)X$h[X$P++]=4*X$L,X$h[X$P++]=4*X$L+2,X$h[X$P++]=4*X$L+1,X$h[X$P++]=4*X$L,X$h[X$P++]=4*X$L+3,X$h[X$P++]=4*X$L+2;return X$m.setNeedUpload(),!0},X$A.expandIBQuadrangle=function(X$m,X$p){X$m.bufferLength>=6*X$p*2||X$A.fillIBQuadrangle(X$m,X$p)},X$A.mathCeilPowerOfTwo=function(X$m){return X$m--,X$m|=X$m>>1,X$m|=X$m>>2,X$m|=X$m>>4,X$m|=X$m>>8,X$m|=X$m>>16,++X$m},X$A.fillQuadrangleImgVb=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){var X$d=16+(X$m._byteLength>>2);X$m.byteLength=X$d<<2;var X$K=X$m.getFloat32Array();X$K[(X$d-=16)+2]=X$L[0],X$K[X$d+3]=X$L[1],X$K[X$d+6]=X$L[2],X$K[X$d+7]=X$L[3],X$K[X$d+10]=X$L[4],X$K[X$d+11]=X$L[5],X$K[X$d+14]=X$L[6],X$K[X$d+15]=X$L[7];var X$D=X$q.a,X$F=X$q.b,X$R=X$q.c,X$$=X$q.d;if(1!==X$D||0!==X$F||0!==X$R||1!==X$$){X$q.bTransform=!0;var X$A=X$q.tx+X$k,X$B=X$q.ty+X$Y;X$K[X$d]=(X$P[0]+X$p)*X$D+(X$P[1]+X$h)*X$R+X$A,X$K[X$d+1]=(X$P[0]+X$p)*X$F+(X$P[1]+X$h)*X$$+X$B,X$K[X$d+4]=(X$P[2]+X$p)*X$D+(X$P[3]+X$h)*X$R+X$A,X$K[X$d+5]=(X$P[2]+X$p)*X$F+(X$P[3]+X$h)*X$$+X$B,X$K[X$d+8]=(X$P[4]+X$p)*X$D+(X$P[5]+X$h)*X$R+X$A,X$K[X$d+9]=(X$P[4]+X$p)*X$F+(X$P[5]+X$h)*X$$+X$B,X$K[X$d+12]=(X$P[6]+X$p)*X$D+(X$P[7]+X$h)*X$R+X$A,X$K[X$d+13]=(X$P[6]+X$p)*X$F+(X$P[7]+X$h)*X$$+X$B}else X$q.bTransform=!1,X$p+=X$q.tx+X$k,X$h+=X$q.ty+X$Y,X$K[X$d]=X$p+X$P[0],X$K[X$d+1]=X$h+X$P[1],X$K[X$d+4]=X$p+X$P[2],X$K[X$d+5]=X$h+X$P[3],X$K[X$d+8]=X$p+X$P[4],X$K[X$d+9]=X$h+X$P[5],X$K[X$d+12]=X$p+X$P[6],X$K[X$d+13]=X$h+X$P[7];return X$m._upload=!0},X$A.fillTranglesVB=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){var X$Y=(X$m._byteLength>>2)+X$P.length;X$m.byteLength=X$Y<<2;var X$d=X$m.getFloat32Array();X$Y-=X$P.length;for(var X$K=X$P.length,X$D=X$L.a,X$F=X$L.b,X$R=X$L.c,X$$=X$L.d,X$A=0;X$A<X$K;X$A+=4)if(X$d[X$Y+X$A+2]=X$P[X$A+2],X$d[X$Y+X$A+3]=X$P[X$A+3],1!==X$D||0!==X$F||0!==X$R||1!==X$$){X$L.bTransform=!0;var X$B=X$L.tx+X$q,X$n=X$L.ty+X$k;X$d[X$Y+X$A]=(X$P[X$A]+X$p)*X$D+(X$P[X$A+1]+X$h)*X$R+X$B,X$d[X$Y+X$A+1]=(X$P[X$A]+X$p)*X$F+(X$P[X$A+1]+X$h)*X$$+X$n}else X$L.bTransform=!1,X$p+=X$L.tx+X$q,X$h+=X$L.ty+X$k,X$d[X$Y+X$A]=X$p+X$P[X$A],X$d[X$Y+X$A+1]=X$h+X$P[X$A+1];return X$m._upload=!0},X$A.copyPreImgVb=function(X$m,X$p,X$h){var X$P=X$m._byteLength>>2;X$m.byteLength=X$P+16<<2;for(var X$L=X$m.getFloat32Array(),X$q=0,X$k=X$P-16;X$q<4;X$q++)X$L[X$P]=X$L[X$k]+X$p,++X$k,X$L[++X$P]=X$L[X$k]+X$h,++X$k,X$L[++X$P]=X$L[X$k],++X$k,X$L[++X$P]=X$L[X$k],++X$P,++X$k;X$m._upload=!0},X$A.fillRectImgVb=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D,X$F,X$R){void 0===X$R&&(X$R=!1);var X$$,X$A,X$B,X$n,X$c,X$e,X$a,X$Z,X$H,X$W,X$E,X$I,X$b,X$T,X$j,X$x,X$Q=1,X$M=X$Y.a,X$u=X$Y.b,X$N=X$Y.c,X$S=X$Y.d,X$_=X$p&&X$p.width<99999999;if(1!==X$M||0!==X$u||0!==X$N||1!==X$S?(X$Y.bTransform=!0,0===X$u&&0===X$N&&(X$Q=23,X$H=X$L+X$h,X$W=X$q+X$P,X$$=X$M*X$h+(X$E=X$Y.tx+X$d),X$B=X$M*X$H+X$E,X$A=X$S*X$P+(X$I=X$Y.ty+X$K),X$n=X$S*X$W+X$I)):(X$Q=23,X$Y.bTransform=!1,X$B=(X$$=X$h+X$Y.tx+X$d)+X$L,X$n=(X$A=X$P+X$Y.ty+X$K)+X$q),X$_&&(X$c=X$p.x,X$e=X$p.y,X$a=X$p.width+X$c,X$Z=X$p.height+X$e),1!==X$Q){if(Math.min(X$$,X$B)>=X$a)return!1;if(Math.min(X$A,X$n)>=X$Z)return!1;if(Math.max(X$B,X$$)<=X$c)return!1;if(Math.max(X$n,X$A)<=X$e)return!1}var X$l=X$m._byteLength>>2;X$m.byteLength=16+X$l<<2;var X$J=X$m.getFloat32Array();switch(X$J[2+X$l]=X$k[0],X$J[3+X$l]=X$k[1],X$J[6+X$l]=X$k[2],X$J[7+X$l]=X$k[3],X$J[10+X$l]=X$k[4],X$J[11+X$l]=X$k[5],X$J[14+X$l]=X$k[6],X$J[15+X$l]=X$k[7],X$Q){case 1:X$E=X$Y.tx+X$d,X$I=X$Y.ty+X$K;var X$z=X$M*X$h,X$w=X$N*X$P,X$X=X$S*X$P,X$s=X$u*X$h,X$G=X$M*(X$H=X$L+X$h),X$U=X$N*(X$W=X$q+X$P),X$r=X$S*X$W,X$y=X$u*X$H;X$R?(X$b=X$z+X$w+X$E,X$j=Math.round(X$b)-X$b,X$T=X$X+X$s+X$I,X$x=Math.round(X$T)-X$T,X$J[X$l]=X$b+X$j,X$J[1+X$l]=X$T+X$x,X$J[4+X$l]=X$G+X$w+X$E+X$j,X$J[5+X$l]=X$X+X$y+X$I+X$x,X$J[8+X$l]=X$G+X$U+X$E+X$j,X$J[9+X$l]=X$r+X$y+X$I+X$x,X$J[12+X$l]=X$z+X$U+X$E+X$j,X$J[13+X$l]=X$r+X$s+X$I+X$x):(X$J[X$l]=X$z+X$w+X$E,X$J[1+X$l]=X$X+X$s+X$I,X$J[4+X$l]=X$G+X$w+X$E,X$J[5+X$l]=X$X+X$y+X$I,X$J[8+X$l]=X$G+X$U+X$E,X$J[9+X$l]=X$r+X$y+X$I,X$J[12+X$l]=X$z+X$U+X$E,X$J[13+X$l]=X$r+X$s+X$I);break;case 23:X$R?(X$b=X$$+X$D,X$j=Math.round(X$b)-X$b,X$T=X$A,X$x=Math.round(X$T)-X$T,X$J[X$l]=X$b+X$j,X$J[1+X$l]=X$T+X$x,X$J[4+X$l]=X$B+X$D+X$j,X$J[5+X$l]=X$A+X$x,X$J[8+X$l]=X$B+X$j,X$J[9+X$l]=X$n+X$x,X$J[12+X$l]=X$$+X$j,X$J[13+X$l]=X$n+X$x):(X$J[X$l]=X$$+X$D,X$J[1+X$l]=X$A,X$J[4+X$l]=X$B+X$D,X$J[5+X$l]=X$A,X$J[8+X$l]=X$B,X$J[9+X$l]=X$n,X$J[12+X$l]=X$$,X$J[13+X$l]=X$n)}return X$m._upload=!0},X$A.fillLineVb=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){var X$d=.5*X$k,X$K=X$A._fillLineArray,X$D=-(X$P-X$q),X$F=X$h-X$L,X$R=Math.sqrt(X$D*X$D+X$F*X$F);X$D/=X$R,X$F/=X$R,X$D*=X$d,X$F*=X$d,X$K[0]=X$h-X$D,X$K[1]=X$P-X$F,X$K[4]=X$h+X$D,X$K[5]=X$P+X$F,X$K[8]=X$L+X$D,X$K[9]=X$q+X$F,X$K[12]=X$L-X$D,X$K[13]=X$q-X$F,X$Y&&X$Y.transformPointArray(X$K,X$K);var X$$=16+(X$m._byteLength>>2);return X$m.byteLength=X$$<<2,X$m.insertData(X$K,X$$-16),!0},X$A._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],X$A}(),X$cm=(function(){function X$d(){}X$R(X$d,"laya.webgl.utils.MatirxArray"),X$d.ArrayMul=function(X$m,X$p,X$h){if(X$m)if(X$p)for(var X$P=NaN,X$L=NaN,X$q=NaN,X$k=NaN,X$Y=0;X$Y<4;X$Y++)X$P=X$m[X$Y],X$L=X$m[X$Y+4],X$q=X$m[X$Y+8],X$k=X$m[X$Y+12],X$h[X$Y]=X$P*X$p[0]+X$L*X$p[1]+X$q*X$p[2]+X$k*X$p[3],X$h[X$Y+4]=X$P*X$p[4]+X$L*X$p[5]+X$q*X$p[6]+X$k*X$p[7],X$h[X$Y+8]=X$P*X$p[8]+X$L*X$p[9]+X$q*X$p[10]+X$k*X$p[11],X$h[X$Y+12]=X$P*X$p[12]+X$L*X$p[13]+X$q*X$p[14]+X$k*X$p[15];else X$d.copyArray(X$m,X$h);else X$d.copyArray(X$p,X$h)},X$d.copyArray=function(X$m,X$p){if(X$m&&X$p)for(var X$h=0;X$h<X$m.length;X$h++)X$p[X$h]=X$m[X$h]}}(),function(){function X$p(X$m,X$p,X$h){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=X$m,this._vb=new X$Cm(X$m,35048),X$p&&this._vb._resizeBuffer(X$p,!1),this._ib=new X$Om,X$h&&this._ib._resizeBuffer(X$h,!1)}X$R(X$p,"laya.webgl.utils.Mesh2D");var X$m=X$p.prototype;return X$m.cloneWithNewVB=function(){var X$m=new X$p(this._stride,0,0);return X$m._ib=this._ib,X$m._quadNum=this._quadNum,X$m._attribInfo=this._attribInfo,X$m},X$m.cloneWithNewVBIB=function(){var X$m=new X$p(this._stride,0,0);return X$m._attribInfo=this._attribInfo,X$m},X$m.getVBW=function(){return this._vb.setNeedUpload(),this._vb},X$m.getVBR=function(){return this._vb},X$m.getIBR=function(){return this._ib},X$m.getIBW=function(){return this._ib.setNeedUpload(),this._ib},X$m.createQuadIB=function(X$m){this._quadNum=X$m,this._ib._resizeBuffer(6*X$m*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var X$p=this._ib.getUint16Array(),X$h=0,X$P=0,X$L=0;X$L<X$m;X$L++)X$p[X$h++]=X$P,X$p[X$h++]=X$P+2,X$p[X$h++]=X$P+1,X$p[X$h++]=X$P,X$p[X$h++]=X$P+3,X$p[X$h++]=X$P+2,X$P+=4;this._ib.setNeedUpload()},X$m.setAttributes=function(X$m){if(this._attribInfo=X$m,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},X$m.getEleNum=function(){return this._ib.getBuffer().byteLength/2},X$m.releaseMesh=function(){},X$m.destroy=function(){},X$m.clearVB=function(){this._vb.clear()},X$p._gvaoid=0,X$p}()),X$em=function(){function X$L(){}return X$R(X$L,"laya.webgl.utils.RenderState2D"),X$L.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},X$L.mat2MatArray=function(X$m,X$p){var X$h=X$m,X$P=X$p;return X$P[0]=X$h.a,X$P[1]=X$h.b,X$P[2]=X$L.EMPTYMAT4_ARRAY[2],X$P[3]=X$L.EMPTYMAT4_ARRAY[3],X$P[4]=X$h.c,X$P[5]=X$h.d,X$P[6]=X$L.EMPTYMAT4_ARRAY[6],X$P[7]=X$L.EMPTYMAT4_ARRAY[7],X$P[8]=X$L.EMPTYMAT4_ARRAY[8],X$P[9]=X$L.EMPTYMAT4_ARRAY[9],X$P[10]=X$L.EMPTYMAT4_ARRAY[10],X$P[11]=X$L.EMPTYMAT4_ARRAY[11],X$P[12]=X$h.tx,X$P[13]=X$h.ty,X$P[14]=X$L.EMPTYMAT4_ARRAY[14],X$P[15]=X$L.EMPTYMAT4_ARRAY[15],X$p},X$L.restoreTempArray=function(){X$L.TEMPMAT4_ARRAY[0]=1,X$L.TEMPMAT4_ARRAY[1]=0,X$L.TEMPMAT4_ARRAY[4]=0,X$L.TEMPMAT4_ARRAY[5]=1,X$L.TEMPMAT4_ARRAY[12]=0,X$L.TEMPMAT4_ARRAY[13]=0},X$L.clear=function(){X$L.worldScissorTest=!1,X$L.worldShaderDefines=null,X$L.worldFilters=null,X$L.worldAlpha=1,X$L.worldClipRect.x=X$L.worldClipRect.y=0,X$L.worldClipRect.width=X$L.width,X$L.worldClipRect.height=X$L.height,X$L.curRenderTarget=null},X$L._MAXSIZE=99999999,X$L.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],X$L.worldMatrix4=X$L.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],X$L.worldAlpha=1,X$L.worldScissorTest=!1,X$L.worldFilters=null,X$L.worldShaderDefines=null,X$L.curRenderTarget=null,X$L.width=0,X$L.height=0,X$k(X$L,["worldMatrix",function(){return this.worldMatrix=new X$b},"worldClipRect",function(){return this.worldClipRect=new X$j(0,0,99999999,99999999)}]),X$L}(),X$am=function(){var X$e,X$h;function X$a(X$m,X$p,X$h,X$P,X$L){var X$q=this;function X$k(X$m){var X$p=[],X$h=new X$e(X$p);return X$q._compileToTree(X$h,X$m.split("\n"),0,X$p,X$L),X$h}var X$Y=X$$.now();this._VS=X$k(X$p),this._PS=X$k(X$h),this._nameMap=X$P,2<X$$.now()-X$Y&&console.log("ShaderCompile use time:"+(X$$.now()-X$Y)+"  size:"+X$p.length+"/"+X$h.length)}X$R(X$a,"laya.webgl.utils.ShaderCompile");var X$m=X$a.prototype;return X$m._compileToTree=function(X$m,X$p,X$h,X$P,X$L){var X$q,X$k,X$Y,X$d,X$K,X$D,X$F,X$R=0,X$$=0,X$A=0,X$B=0;for(X$$=X$h;X$$<X$p.length;X$$++)if(!((X$Y=X$p[X$$]).length<1)&&0!==(X$R=X$Y.indexOf("//"))){if(0<=X$R&&(X$Y=X$Y.substr(0,X$R)),X$q=X$F||new X$e(X$P),X$F=null,X$q.text=X$Y,X$q.noCompile=!0,0<=(X$R=X$Y.indexOf("#"))){for(X$d="#",X$B=X$R+1,X$A=X$Y.length;X$B<X$A;X$B++){var X$n=X$Y.charAt(X$B);if(" "===X$n||"\t"===X$n||"\r"===X$n||"\n"===X$n||"?"===X$n)break;X$d+=X$n}switch(X$q.name=X$d){case"#ifdef":case"#ifndef":if(X$q.src=X$Y,X$q.noCompile=null!=X$Y.match(/[!&|()=<>]/),X$q.noCompile?console.log("function():Boolean{return "+X$Y.substr(X$R+X$q.name.length)+"}"):(X$D=X$Y.replace(/^\s*/,"").split(/\s+/),X$q.setCondition(X$D[1],"#ifdef"===X$d?1:2),X$q.text="//"+X$q.text),X$q.setParent(X$m),X$m=X$q,X$L)for(X$D=X$Y.substr(X$B).split(X$a._splitToWordExps3),X$B=0;X$B<X$D.length;X$B++)(X$Y=X$D[X$B]).length&&(X$L[X$Y]=!0);continue;case"#if":if(X$q.src=X$Y,X$q.noCompile=!0,X$q.setParent(X$m),X$m=X$q,X$L)for(X$D=X$Y.substr(X$B).split(X$a._splitToWordExps3),X$B=0;X$B<X$D.length;X$B++)(X$Y=X$D[X$B]).length&&"defined"!=X$Y&&(X$L[X$Y]=!0);continue;case"#else":X$q.src=X$Y,X$k=(X$m=X$m.parent).childs[X$m.childs.length-1],X$q.noCompile=X$k.noCompile,X$q.noCompile||(X$q.condition=X$k.condition,X$q.conditionType=1==X$k.conditionType?2:1,X$q.text="//"+X$q.text+" "+X$k.text+" "+X$q.conditionType),X$q.setParent(X$m),X$m=X$q;continue;case"#endif":X$k=(X$m=X$m.parent).childs[X$m.childs.length-1],X$q.noCompile=X$k.noCompile,X$q.noCompile||(X$q.text="//"+X$q.text),X$q.setParent(X$m);continue;case"#include":X$D=X$a.splitToWords(X$Y,null);var X$c=X$a.includes[X$D[1]];if(!X$c)throw"ShaderCompile error no this include file:"+X$D[1];if((X$R=X$D[0].indexOf("?"))<0){X$q.setParent(X$m),X$Y=X$c.getWith("with"==X$D[2]?X$D[3]:null),this._compileToTree(X$q,X$Y.split("\n"),0,X$P,X$L),X$q.text="";continue}X$q.setCondition(X$D[0].substr(X$R+1),1),X$q.text=X$c.getWith("with"==X$D[2]?X$D[3]:null);break;case"#import":X$K=(X$D=X$a.splitToWords(X$Y,null))[1],X$P.push({node:X$q,file:X$a.includes[X$K],ofs:X$q.text.length});continue}}else{if((X$k=X$m.childs[X$m.childs.length-1])&&!X$k.name){0<X$P.length&&X$a.splitToWords(X$Y,X$k),X$F=X$q,X$k.text+="\n"+X$Y;continue}0<X$P.length&&X$a.splitToWords(X$Y,X$q)}X$q.setParent(X$m)}},X$m.createShader=function(X$m,X$p,X$h){var X$P={},X$L="";if(X$m)for(var X$q in X$m)X$L+="#define "+X$q+"\n",X$P[X$q]=!0;var X$k=this._VS.toscript(X$P,[]),X$Y=this._PS.toscript(X$P,[]);return(X$h||X$im.create)(X$L+X$k.join("\n"),X$L+X$Y.join("\n"),X$p,this._nameMap)},X$a._parseOne=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k={type:X$a.shaderParamsMap[X$h[X$P+1]],name:X$h[X$P+2],size:isNaN(parseInt(X$h[X$P+3]))?1:parseInt(X$h[X$P+3])};return X$q&&("attribute"==X$L?X$m.push(X$k):X$p.push(X$k)),":"==X$h[X$P+3]&&(X$k.type=X$h[X$P+4],X$P+=2),X$P+=2},X$a.addInclude=function(X$m,X$p){if(!X$p||0===X$p.length)throw new Error("add shader include file err:"+X$m);if(X$a.includes[X$m])throw new Error("add shader include file err, has add:"+X$m);X$a.includes[X$m]=new X$h(X$p)},X$a.preGetParams=function(X$m,X$p){var X$h=[X$m,X$p],X$P={},X$L=[],X$q=[],X$k={},X$Y=[];X$P.attributes=X$L,X$P.uniforms=X$q,X$P.defines=X$k;for(var X$d=0,X$K=0,X$D=0;X$D<2;X$D++){X$h[X$D]=X$h[X$D].replace(X$a._removeAnnotation,"");var X$F,X$R=X$h[X$D].match(X$a._reg);for(X$d=0,X$K=X$R.length;X$d<X$K;X$d++){var X$$=X$R[X$d];if("attribute"==X$$||"uniform"==X$$)X$d=X$a._parseOne(X$L,X$q,X$R,X$d,X$$,!0);else{if("#define"==X$$){X$Y[X$$=X$R[++X$d]]=1;continue}if("#ifdef"==X$$){X$k[X$F=X$R[++X$d]]=X$k[X$F]||[];for(X$d++;X$d<X$K;X$d++)if("attribute"==(X$$=X$R[X$d])||"uniform"==X$$)X$d=X$a._parseOne(X$L,X$q,X$R,X$d,X$$,X$Y[X$F]);else if("#else"==X$$)for(X$d++;X$d<X$K;X$d++)if("attribute"==(X$$=X$R[X$d])||"uniform"==X$$)X$d=X$a._parseOne(X$L,X$q,X$R,X$d,X$$,!X$Y[X$F]);else if("#endif"==X$$)break}}}}return X$P},X$a.splitToWords=function(X$m,X$p){for(var X$h,X$P,X$L=[],X$q=-1,X$k=0,X$Y=X$m.length;X$k<X$Y;X$k++)if(X$h=X$m.charAt(X$k),0<=" \t=+-*/&%!<>()'\",;".indexOf(X$h)){if(0<=X$q&&1<X$k-X$q&&(X$P=X$m.substr(X$q,X$k-X$q),X$L.push(X$P)),'"'==X$h||"'"==X$h){var X$d=X$m.indexOf(X$h,X$k+1);if(X$d<0)throw"Sharder err:"+X$m;X$L.push(X$m.substr(X$k+1,X$d-X$k-1)),X$k=X$d,X$q=-1;continue}"("==X$h&&X$p&&0<X$L.length&&(X$P=X$L[X$L.length-1]+";","vec4;main;".indexOf(X$P)<0&&(X$p.useFuns+=X$P)),X$q=-1}else X$q<0&&(X$q=X$k);return X$q<X$Y&&1<X$Y-X$q&&(X$P=X$m.substr(X$q,X$Y-X$q),X$L.push(X$P)),X$L},X$a.IFDEF_NO=0,X$a.IFDEF_YES=1,X$a.IFDEF_ELSE=2,X$a.IFDEF_PARENT=3,X$a._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),X$a._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),X$a._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),X$a.includes={},X$k(X$a,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),X$a.__init$=function(){X$e=function(){function X$h(X$m){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=X$m}X$R(X$h,"");var X$m=X$h.prototype;return X$m.setParent=function(X$m){X$m.childs.push(this),this.z=X$m.z+1,this.parent=X$m},X$m.setCondition=function(X$m,X$p){X$m&&(this.conditionType=X$p,X$m=X$m.replace(/(\s*$)/g,""),this.condition=function(){return this[X$m]},this.condition.__condition=X$m)},X$m.toscript=function(X$m,X$p){return this._toscript(X$m,X$p,++X$h.__id)},X$m._toscript=function(X$P,X$L,X$q){if(this.childs.length<1&&!this.text)return X$L;X$L.length;if(this.condition){var X$m=!!this.condition.call(X$P);if(2===this.conditionType&&(X$m=!X$m),!X$m)return X$L}if(this.text&&X$L.push(this.text),0<this.childs.length&&this.childs.forEach(function(X$m,X$p,X$h){X$m._toscript(X$P,X$L,X$q)}),0<this.includefiles.length&&0<this.useFuns.length)for(var X$p,X$h=0,X$k=this.includefiles.length;X$h<X$k;X$h++)this.includefiles[X$h].curUseID!=X$q&&0<(X$p=this.includefiles[X$h].file.getFunsScript(this.useFuns)).length&&(this.includefiles[X$h].curUseID=X$q,X$L[0]=X$p+X$L[0]);return X$L},X$h.__id=1,X$h}(),X$h=function(){function X$m(X$m){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=X$m;for(var X$p=0,X$h=0,X$P=0;!((X$p=X$m.indexOf("#begin",X$p))<0);){for(X$P=X$p+5;!((X$P=X$m.indexOf("#end",X$P))<0)&&"i"===X$m.charAt(X$P+4);)X$P+=5;if(X$P<0)throw"add include err,no #end:"+X$m;X$h=X$m.indexOf("\n",X$p);var X$L=X$a.splitToWords(X$m.substr(X$p,X$h-X$p),null);"code"==X$L[1]?this.codes[X$L[2]]=X$m.substr(X$h+1,X$P-X$h-1):"function"==X$L[1]&&(X$h=X$m.indexOf("function",X$p),X$h+="function".length,this.funs[X$L[3]]=X$m.substr(X$h+1,X$P-X$h-1),this.funnames+=X$L[3]+";"),X$p=X$P+1}}X$R(X$m,"");var X$p=X$m.prototype;return X$p.getWith=function(X$m){var X$p=X$m?this.codes[X$m]:this.script;if(!X$p)throw"get with error:"+X$m;return X$p},X$p.getFunsScript=function(X$m){var X$p="";for(var X$h in this.funs)0<=X$m.indexOf(X$h+";")&&(X$p+=this.funs[X$h]);return X$p},X$m}()},X$a}(),X$Zm=function(){function X$k(){}return X$R(X$k,"laya.webgl.WebGL"),X$k._uint8ArraySlice=function(){for(var X$m=this.length,X$p=new Uint8Array(this.length),X$h=0;X$h<X$m;X$h++)X$p[X$h]=this[X$h];return X$p},X$k._float32ArraySlice=function(){for(var X$m=this.length,X$p=new Float32Array(this.length),X$h=0;X$h<X$m;X$h++)X$p[X$h]=this[X$h];return X$p},X$k._uint16ArraySlice=function(X$m){var X$p,X$h=arguments,X$P=0,X$L=0;if(0===X$h.length)for(X$P=this.length,X$p=new Uint16Array(X$P),X$L=0;X$L<X$P;X$L++)X$p[X$L]=this[X$L];else if(2===X$h.length){var X$q=X$h[0],X$k=X$h[1];if(X$q<X$k)for(X$P=X$k-X$q,X$p=new Uint16Array(X$P),X$L=X$q;X$L<X$k;X$L++)X$p[X$L-X$q]=this[X$L];else X$p=new Uint16Array(0)}return X$p},X$k.expandContext=function(){var X$m=X$L.prototype,X$p=CanvasRenderingContext2D.prototype;X$p.fillTrangles=X$m.fillTrangles,X$vm.__int__(null),X$p.setIBVB=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){void 0===X$d&&(X$d=0),void 0===X$K&&(X$K=0),null===X$h&&(this._ib=this._ib||X$Om.QuadrangleIB,X$h=this._ib,X$nm.expandIBQuadrangle(X$h,X$P._byteLength/64+8)),this._setIBVB(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K)},X$p.fillTrangles=function(X$m,X$p,X$h,X$P,X$L){this._curMat=this._curMat||X$b.create(),this._vb=this._vb||X$Cm.create(),this._ib||(this._ib=X$Om.create(),X$nm.fillIBQuadrangle(this._ib,X$k/4));var X$q=this._vb,X$k=X$P.length>>4;X$nm.fillTranglesVB(X$q,X$p,X$h,X$P,X$L||this._curMat,0,0),X$nm.expandIBQuadrangle(this._ib,X$q._byteLength/64+8);var X$Y=new X$Im(1,0);X$Y.textureHost=X$m;var X$d=new X$tm("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");X$q._vertType=3,this._setIBVB(X$p,X$h,this._ib,X$q,6*X$k,X$L,X$d,X$Y,0,0)}},X$k.enable=function(){if(X$$.__init__(),X$c.isConchApp&&!X$c.isConchWebGL)return X$H.skinAniSprite=function(){return new X$mm},X$k.expandContext(),!1;if(X$H.getWebGLContext=function(X$m){for(var X$p,X$h=["webgl","experimental-webgl","webkit-3d","moz-webgl"],X$P=0;X$P<X$h.length;X$P++){try{X$p=X$m.getContext(X$h[X$P],{stencil:X$E.isStencil,alpha:X$E.isAlpha,antialias:X$E.isAntialias,premultipliedAlpha:X$E.premultipliedAlpha,preserveDrawingBuffer:X$E.preserveDrawingBuffer})}catch(X$m){}if(X$p)return X$p}return null},null==(X$k.mainContext=X$k.mainContext||X$H.getWebGLContext(X$c._mainCanvas)))return!1;if(X$c.isWebGL)return!0;X$B.create=function(X$m,X$p){return new X$mp(X$m,X$p)},X$n.create=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){return new X$fm(X$m,X$p,X$h,X$P,X$L,X$q,X$k)},X$c.WebGL=X$k,X$c.isWebGL=!0,X$$m.__init__(),X$H.createRenderSprite=function(X$m,X$p){return new X$bm(X$m,X$p)},X$H.createWebGLContext2D=function(X$m){return new X$Em(X$m)},X$H.changeWebGLSize=function(X$m,X$p){laya.webgl.WebGL.onStageResize(X$m,X$p)},X$H.createGraphics=function(){return new X$Wm};var X$m=X$H.createFilterAction;return X$H.createFilterAction=X$m||function(X$m){return new X$Tm},X$H.clear=function(X$m){X$em.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var X$p=X$c.context.ctx,X$h=0==X$p._submits._length||X$E.preserveDrawingBuffer?X$A.create(X$m)._color:X$Q._wgColor;X$h&&X$p.clearBG(X$h[0],X$h[1],X$h[2],X$h[3]),X$em.clear()},X$H.addToAtlas=function(X$m,X$p){void 0===X$p&&(X$p=!1);var X$h=X$m.bitmap;X$c.optimizeTextureMemory(X$m.url,X$m)?X$W.__typeof(X$h,"laya.webgl.resource.IMergeAtlasBitmap")&&X$h.allowMerageInAtlas&&X$h.on("recovered",X$m,X$m.addTextureToAtlas):X$h.enableMerageInAtlas=!1},X$H.isAtlas=function(X$m){return X$m instanceof laya.webgl.atlas.AtlasWebGLCanvas},X$s._enable(),X$H.beginFlush=function(){for(var X$m=X$s.instance,X$p=X$m.getAtlaserCount(),X$h=0;X$h<X$p;X$h++){var X$P=X$m.getAtlaserByIndex(X$h).texture;X$P._flashCacheImageNeedFlush&&X$H.flashFlushImage(X$P)}},X$H.drawToCanvas=function(X$m,X$p,X$h,X$P,X$L,X$q){(X$h<=0||X$P<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),X$h|=0,X$P|=0,X$L|=0,X$q|=0;var X$k=X$Jm.create(X$h,X$P,6408,5121,0,!1);X$k.start(),X$k.clear(0,0,0,0),X$c.context.clear(),X$e.renders[X$p]._fun(X$m,X$c.context,X$L,X$em.height-X$P+X$q),X$c.context.flush(),X$k.end();var X$Y=X$k.getData(0,0,X$h,X$P);if(X$k.recycle(),X$Y.byteLength==X$h*X$P*4){var X$d=new X$ym;X$d._canvas=X$$.createElement("canvas"),X$d.size(X$h,X$P);var X$K=X$d._canvas.getContext("2d");X$$.canvas.size(X$h,X$P);var X$D=X$$.context,X$F=X$D.createImageData(X$h,X$P);return X$F.data.set(new Uint8ClampedArray(X$Y.buffer)),X$d._imgData=X$F,X$D.putImageData(X$F,0,0),X$K.save(),X$K.translate(0,X$P),X$K.scale(1,-1),X$K.drawImage(X$$.canvas.source,0,0),X$K.restore(),X$d}console.log("drawToCanvas error: w:"+X$h+",h:"+X$P+",datalen:"+X$Y.byteLength)},X$H.createFilterAction=function(X$m){var X$p;switch(X$m){case 32:X$p=new X$Tm}return X$p},X$H.addTextureToAtlas=function(X$m){X$m._uvID++,X$s._atlasRestore++,X$m.bitmap.enableMerageInAtlas&&X$s.instance.addToAtlas(X$m)},X$H.getTexturePixels=function(X$m,X$p,X$h,X$P,X$L){X$c.context.ctx.clear();var X$q=new X$x;X$q.graphics.drawTexture(X$m,-X$p,-X$h);var X$k=X$Jm.create(X$P,X$L);X$k.start(),X$k.clear(0,0,0,0),X$q.render(X$c.context,0,0),X$c.context.ctx.flush(),X$k.end();for(var X$Y=X$k.getData(0,0,X$P,X$L),X$d=[],X$K=0,X$D=X$L-1;0<=X$D;X$D--)for(var X$F=0;X$F<X$P;X$F++)X$K=4*(X$D*X$P+X$F),X$d.push(X$Y[X$K]),X$d.push(X$Y[X$K+1]),X$d.push(X$Y[X$K+2]),X$d.push(X$Y[X$K+3]);return X$d},X$H.skinAniSprite=function(){return new X$mm},X$K.create=function(X$m,X$p){var X$h=new X$ym;return X$h._imgData=X$p,X$h.flipY=!1,X$h},X$I._filterStart=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$m.getValue("bounds"),X$k=X$Jm.create(X$q.width,X$q.height);if(X$k.start(),X$k.clear(0,0,0,0),X$m.addValue("src",X$k),X$m.addValue("ScissorTest",X$em.worldScissorTest),X$em.worldScissorTest){var X$Y=new X$j;X$Y.copyFrom(X$h.ctx._clipRect),X$m.addValue("clipRect",X$Y),X$em.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},X$I._filterEnd=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$m.getValue("bounds");X$m.getValue("src").end();var X$k=X$Jm.create(X$q.width,X$q.height);X$k.start(),X$k.clear(0,0,0,0),X$m.addValue("out",X$k),X$p._set$P("_filterCache",X$k),X$p._set$P("_isHaveGlowFilter",X$m.getValue("_isHaveGlowFilter"))},X$I._EndTarget=function(X$m,X$p){if(X$m.getValue("src").recycle(),X$m.getValue("out").end(),X$m.getValue("ScissorTest")){X$em.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),X$p.ctx.save();var X$h=X$m.getValue("clipRect");X$p.ctx.clipRect(X$h.x,X$h.y,X$h.width,X$h.height)}},X$I._useSrc=function(X$m){var X$p=X$m.getValue("out");X$p.end(),(X$p=X$m.getValue("src")).start(),X$p.clear(0,0,0,0)},X$I._endSrc=function(X$m){X$m.getValue("src").end()},X$I._useOut=function(X$m){var X$p=X$m.getValue("src");X$p.end(),(X$p=X$m.getValue("out")).start(),X$p.clear(0,0,0,0)},X$I._endOut=function(X$m){X$m.getValue("out").end()},X$I._recycleScope=function(X$m){X$m.recycle()},X$I._filter=function(X$m,X$p,X$h,X$P){var X$L=this._next;if(X$L){var X$q,X$k,X$Y=X$m.filters,X$d=X$Y.length;if(1==X$d&&32==X$Y[0].type)return X$p.ctx.save(),X$p.ctx.setFilters([X$Y[0]]),X$L._fun.call(X$L,X$m,X$p,X$h,X$P),void X$p.ctx.restore();var X$K=X$Ym.create(),X$D=X$T.TEMP,X$F=X$p.ctx._getTransformMatrix(),X$R=X$b.create();X$F.copyTo(X$R);var X$$=0,X$A=0,X$B=!1,X$n=X$m._$P._filterCache?X$m._$P._filterCache:null;if(!X$n||X$m._repaint){X$B=X$m._isHaveGlowFilter(),X$K.addValue("_isHaveGlowFilter",X$B),X$B&&(X$$=50,X$A=25),(X$k=new X$j).copyFrom(X$m.getSelfBounds()),X$k.x+=X$m.x,X$k.y+=X$m.y,X$k.x-=X$m.pivotX+4,X$k.y-=X$m.pivotY+4;var X$c=X$k.x,X$e=X$k.y;if(X$k.width+=X$$+8,X$k.height+=X$$+8,X$D.x=X$k.x*X$R.a+X$k.y*X$R.c,X$D.y=X$k.y*X$R.d+X$k.x*X$R.b,X$k.x=X$D.x,X$k.y=X$D.y,X$D.x=X$k.width*X$R.a+X$k.height*X$R.c,X$D.y=X$k.height*X$R.d+X$k.width*X$R.b,X$k.width=X$D.x,X$k.height=X$D.y,X$k.width<=0||X$k.height<=0)return;X$n&&X$n.recycle(),X$K.addValue("bounds",X$k);var X$a=X$km.create([X$K,X$m,X$p,0,0],X$I._filterStart);X$p.addRenderObject(X$a),X$p.ctx._renderKey=0,X$p.ctx._shader2D.glTexture=null;var X$Z=X$m.x-X$c+X$A,X$H=X$m.y-X$e+X$A;X$L._fun.call(X$L,X$m,X$p,X$Z,X$H),X$a=X$km.create([X$K,X$m,X$p,0,0],X$I._filterEnd),X$p.addRenderObject(X$a);for(var X$W=0;X$W<X$d;X$W++){0!=X$W&&(X$a=X$km.create([X$K],X$I._useSrc),X$p.addRenderObject(X$a),X$q=X$Im.create(1,0),X$b.TEMP.identity(),X$p.ctx.drawTarget(X$K,0,0,X$k.width,X$k.height,X$b.TEMP,"out",X$q,null,X$U.TOINT.overlay),X$a=X$km.create([X$K],X$I._useOut),X$p.addRenderObject(X$a)),X$Y[X$W].action.apply3d(X$K,X$m,X$p,0,0)}X$a=X$km.create([X$K,X$p],X$I._EndTarget),X$p.addRenderObject(X$a)}else{if((X$B=!!X$m._$P._isHaveGlowFilter&&X$m._$P._isHaveGlowFilter)&&(X$$=50,X$A=25),(X$k=X$m.getBounds()).width<=0||X$k.height<=0)return;X$k.width+=X$$,X$k.height+=X$$,X$D.x=X$k.x*X$R.a+X$k.y*X$R.c,X$D.y=X$k.y*X$R.d+X$k.x*X$R.b,X$k.x=X$D.x,X$k.y=X$D.y,X$D.x=X$k.width*X$R.a+X$k.height*X$R.c,X$D.y=X$k.height*X$R.d+X$k.width*X$R.b,X$k.width=X$D.x,X$k.height=X$D.y,X$K.addValue("out",X$n)}X$h=X$h-X$A-X$m.x,X$P=X$P-X$A-X$m.y,X$D.setTo(X$h,X$P),X$R.transformPoint(X$D),X$h=X$D.x+X$k.x,X$P=X$D.y+X$k.y,X$q=X$Im.create(1,0),X$b.TEMP.identity(),X$p.ctx.drawTarget(X$K,X$h,X$P,X$k.width,X$k.height,X$b.TEMP,"out",X$q,null,X$U.TOINT.overlay),X$a=X$km.create([X$K],X$I._recycleScope),X$p.addRenderObject(X$a),X$R.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=X$k._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=X$k._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=X$k._uint8ArraySlice),!0},X$k.onStageResize=function(X$m,X$p){null!=X$k.mainContext&&(X$k.mainContext.viewport(0,0,X$m,X$p),X$em.width=X$m,X$em.height=X$p)},X$k.onInvalidGLRes=function(){X$s.instance.freeAll(),X$Z.releaseContentManagers(!0),X$k.doNodeRepaint(X$W.stage),X$k.mainContext.viewport(0,0,X$em.width,X$em.height),X$W.stage.event("devicelost")},X$k.doNodeRepaint=function(X$m){0==X$m.numChildren&&X$m.repaint();for(var X$p=0;X$p<X$m.numChildren;X$p++)X$k.doNodeRepaint(X$m.getChildAt(X$p))},X$k.init=function(X$m,X$p,X$h){X$k.mainCanvas=X$m,X$K._createContext=function(X$m){return new X$Em(X$m)},X$ym._createContext=function(X$m){return new X$Em(X$m)};var X$P=laya.webgl.WebGL.mainContext;if(null!=X$P.getShaderPrecisionFormat){var X$L=X$P.getShaderPrecisionFormat(35633,36338),X$q=X$P.getShaderPrecisionFormat(35632,36338);X$k.shaderHighPrecision=!(!X$L.precision||!X$q.precision)}else X$k.shaderHighPrecision=!1;if(X$k.compressAstc=X$P.getExtension("WEBGL_compressed_texture_astc"),X$k.compressAtc=X$P.getExtension("WEBGL_compressed_texture_atc"),X$k.compressEtc=X$P.getExtension("WEBGL_compressed_texture_etc"),X$k.compressEtc1=X$P.getExtension("WEBGL_compressed_texture_etc1"),X$k.compressPvrtc=X$P.getExtension("WEBGL_compressed_texture_pvrtc"),X$k.compressS3tc=X$P.getExtension("WEBGL_compressed_texture_s3tc"),X$k.compressS3tc_srgb=X$P.getExtension("WEBGL_compressed_texture_s3tc_srgb"),X$k.compressAstc=X$k.compressAstc?X$k.compressAstc:{},X$k.compressAtc=X$k.compressAtc?X$k.compressAtc:{},X$k.compressEtc=X$k.compressEtc?X$k.compressEtc:{},X$k.compressEtc1=X$k.compressEtc1?X$k.compressEtc1:{},X$k.compressPvrtc=X$k.compressPvrtc?X$k.compressPvrtc:{},X$k.compressS3tc=X$k.compressS3tc?X$k.compressS3tc:{},X$k.compressS3tc_srgb=X$k.compressS3tc_srgb?X$k.compressS3tc_srgb:{},X$P.deleteTexture1=X$P.deleteTexture,X$P.deleteTexture=function(X$m){X$m==X$Hm.curBindTexValue&&(X$Hm.curBindTexValue=null),X$P.deleteTexture1(X$m)},X$k.onStageResize(X$p,X$h),null==X$k.mainContext)throw new Error("webGL getContext err!");X$N.__init__(),X$s.__init__(),X$xm.__init__(),X$qm.__init__(),X$Em.__init__(),X$Im.__init__(),X$O.__init__(),X$vm.__int__(X$P),X$U._init_(X$P),X$c.isConchApp&&conch.setOnInvalidGLRes(X$k.onInvalidGLRes)},X$k.mainCanvas=null,X$k.antialias=!0,X$k.shaderHighPrecision=!1,X$k._bg_null=[0,0,0,0],X$k}(),X$Hm=function(){function X$P(){}return X$R(X$P,"laya.webgl.WebGLContext"),X$P.UseProgram=function(X$m){return X$P._useProgram!==X$m&&(X$Zm.mainContext.useProgram(X$m),X$P._useProgram=X$m,!0)},X$P.setDepthTest=function(X$m,X$p){X$p!==X$P._depthTest&&((X$P._depthTest=X$p)?X$m.enable(2929):X$m.disable(2929))},X$P.setDepthMask=function(X$m,X$p){X$p!==X$P._depthMask&&(X$P._depthMask=X$p,X$m.depthMask(X$p))},X$P.setDepthFunc=function(X$m,X$p){X$p!==X$P._depthFunc&&(X$P._depthFunc=X$p,X$m.depthFunc(X$p))},X$P.setBlend=function(X$m,X$p){X$p!==X$P._blend&&((X$P._blend=X$p)?X$m.enable(3042):X$m.disable(3042))},X$P.setBlendFunc=function(X$m,X$p,X$h){(X$p!==X$P._sFactor||X$h!==X$P._dFactor)&&(X$P._sFactor=X$p,X$P._dFactor=X$h,X$m.blendFunc(X$p,X$h))},X$P.setCullFace=function(X$m,X$p){X$p!==X$P._cullFace&&((X$P._cullFace=X$p)?X$m.enable(2884):X$m.disable(2884))},X$P.setFrontFace=function(X$m,X$p){X$p!==X$P._frontFace&&(X$P._frontFace=X$p,X$m.frontFace(X$p))},X$P.bindTexture=function(X$m,X$p,X$h){X$m.bindTexture(X$p,X$h),X$P.curBindTexTarget=X$p,X$P.curBindTexValue=X$h},X$P.DEPTH_BUFFER_BIT=256,X$P.STENCIL_BUFFER_BIT=1024,X$P.COLOR_BUFFER_BIT=16384,X$P.POINTS=0,X$P.LINES=1,X$P.LINE_LOOP=2,X$P.LINE_STRIP=3,X$P.TRIANGLES=4,X$P.TRIANGLE_STRIP=5,X$P.TRIANGLE_FAN=6,X$P.ZERO=0,X$P.ONE=1,X$P.SRC_COLOR=768,X$P.ONE_MINUS_SRC_COLOR=769,X$P.SRC_ALPHA=770,X$P.ONE_MINUS_SRC_ALPHA=771,X$P.DST_ALPHA=772,X$P.ONE_MINUS_DST_ALPHA=773,X$P.DST_COLOR=774,X$P.ONE_MINUS_DST_COLOR=775,X$P.SRC_ALPHA_SATURATE=776,X$P.FUNC_ADD=32774,X$P.BLEND_EQUATION=32777,X$P.BLEND_EQUATION_RGB=32777,X$P.BLEND_EQUATION_ALPHA=34877,X$P.FUNC_SUBTRACT=32778,X$P.FUNC_REVERSE_SUBTRACT=32779,X$P.BLEND_DST_RGB=32968,X$P.BLEND_SRC_RGB=32969,X$P.BLEND_DST_ALPHA=32970,X$P.BLEND_SRC_ALPHA=32971,X$P.CONSTANT_COLOR=32769,X$P.ONE_MINUS_CONSTANT_COLOR=32770,X$P.CONSTANT_ALPHA=32771,X$P.ONE_MINUS_CONSTANT_ALPHA=32772,X$P.BLEND_COLOR=32773,X$P.ARRAY_BUFFER=34962,X$P.ELEMENT_ARRAY_BUFFER=34963,X$P.ARRAY_BUFFER_BINDING=34964,X$P.ELEMENT_ARRAY_BUFFER_BINDING=34965,X$P.STREAM_DRAW=35040,X$P.STATIC_DRAW=35044,X$P.DYNAMIC_DRAW=35048,X$P.BUFFER_SIZE=34660,X$P.BUFFER_USAGE=34661,X$P.CURRENT_VERTEX_ATTRIB=34342,X$P.FRONT=1028,X$P.BACK=1029,X$P.CULL_FACE=2884,X$P.FRONT_AND_BACK=1032,X$P.BLEND=3042,X$P.DITHER=3024,X$P.STENCIL_TEST=2960,X$P.DEPTH_TEST=2929,X$P.SCISSOR_TEST=3089,X$P.POLYGON_OFFSET_FILL=32823,X$P.SAMPLE_ALPHA_TO_COVERAGE=32926,X$P.SAMPLE_COVERAGE=32928,X$P.NO_ERROR=0,X$P.INVALID_ENUM=1280,X$P.INVALID_VALUE=1281,X$P.INVALID_OPERATION=1282,X$P.OUT_OF_MEMORY=1285,X$P.CW=2304,X$P.CCW=2305,X$P.LINE_WIDTH=2849,X$P.ALIASED_POINT_SIZE_RANGE=33901,X$P.ALIASED_LINE_WIDTH_RANGE=33902,X$P.CULL_FACE_MODE=2885,X$P.FRONT_FACE=2886,X$P.DEPTH_RANGE=2928,X$P.DEPTH_WRITEMASK=2930,X$P.DEPTH_CLEAR_VALUE=2931,X$P.DEPTH_FUNC=2932,X$P.STENCIL_CLEAR_VALUE=2961,X$P.STENCIL_FUNC=2962,X$P.STENCIL_FAIL=2964,X$P.STENCIL_PASS_DEPTH_FAIL=2965,X$P.STENCIL_PASS_DEPTH_PASS=2966,X$P.STENCIL_REF=2967,X$P.STENCIL_VALUE_MASK=2963,X$P.STENCIL_WRITEMASK=2968,X$P.STENCIL_BACK_FUNC=34816,X$P.STENCIL_BACK_FAIL=34817,X$P.STENCIL_BACK_PASS_DEPTH_FAIL=34818,X$P.STENCIL_BACK_PASS_DEPTH_PASS=34819,X$P.STENCIL_BACK_REF=36003,X$P.STENCIL_BACK_VALUE_MASK=36004,X$P.STENCIL_BACK_WRITEMASK=36005,X$P.VIEWPORT=2978,X$P.SCISSOR_BOX=3088,X$P.COLOR_CLEAR_VALUE=3106,X$P.COLOR_WRITEMASK=3107,X$P.UNPACK_ALIGNMENT=3317,X$P.PACK_ALIGNMENT=3333,X$P.MAX_TEXTURE_SIZE=3379,X$P.MAX_VIEWPORT_DIMS=3386,X$P.SUBPIXEL_BITS=3408,X$P.RED_BITS=3410,X$P.GREEN_BITS=3411,X$P.BLUE_BITS=3412,X$P.ALPHA_BITS=3413,X$P.DEPTH_BITS=3414,X$P.STENCIL_BITS=3415,X$P.POLYGON_OFFSET_UNITS=10752,X$P.POLYGON_OFFSET_FACTOR=32824,X$P.TEXTURE_BINDING_2D=32873,X$P.SAMPLE_BUFFERS=32936,X$P.SAMPLES=32937,X$P.SAMPLE_COVERAGE_VALUE=32938,X$P.SAMPLE_COVERAGE_INVERT=32939,X$P.NUM_COMPRESSED_TEXTURE_FORMATS=34466,X$P.COMPRESSED_TEXTURE_FORMATS=34467,X$P.DONT_CARE=4352,X$P.FASTEST=4353,X$P.NICEST=4354,X$P.GENERATE_MIPMAP_HINT=33170,X$P.BYTE=5120,X$P.UNSIGNED_BYTE=5121,X$P.SHORT=5122,X$P.UNSIGNED_SHORT=5123,X$P.INT=5124,X$P.UNSIGNED_INT=5125,X$P.FLOAT=5126,X$P.DEPTH_COMPONENT=6402,X$P.ALPHA=6406,X$P.RGB=6407,X$P.RGBA=6408,X$P.LUMINANCE=6409,X$P.LUMINANCE_ALPHA=6410,X$P.UNSIGNED_SHORT_4_4_4_4=32819,X$P.UNSIGNED_SHORT_5_5_5_1=32820,X$P.UNSIGNED_SHORT_5_6_5=33635,X$P.FRAGMENT_SHADER=35632,X$P.VERTEX_SHADER=35633,X$P.MAX_VERTEX_ATTRIBS=34921,X$P.MAX_VERTEX_UNIFORM_VECTORS=36347,X$P.MAX_VARYING_VECTORS=36348,X$P.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,X$P.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,X$P.MAX_TEXTURE_IMAGE_UNITS=34930,X$P.MAX_FRAGMENT_UNIFORM_VECTORS=36349,X$P.SHADER_TYPE=35663,X$P.DELETE_STATUS=35712,X$P.LINK_STATUS=35714,X$P.VALIDATE_STATUS=35715,X$P.ATTACHED_SHADERS=35717,X$P.ACTIVE_UNIFORMS=35718,X$P.ACTIVE_ATTRIBUTES=35721,X$P.SHADING_LANGUAGE_VERSION=35724,X$P.CURRENT_PROGRAM=35725,X$P.NEVER=512,X$P.LESS=513,X$P.EQUAL=514,X$P.LEQUAL=515,X$P.GREATER=516,X$P.NOTEQUAL=517,X$P.GEQUAL=518,X$P.ALWAYS=519,X$P.KEEP=7680,X$P.REPLACE=7681,X$P.INCR=7682,X$P.DECR=7683,X$P.INVERT=5386,X$P.INCR_WRAP=34055,X$P.DECR_WRAP=34056,X$P.VENDOR=7936,X$P.RENDERER=7937,X$P.VERSION=7938,X$P.NEAREST=9728,X$P.LINEAR=9729,X$P.NEAREST_MIPMAP_NEAREST=9984,X$P.LINEAR_MIPMAP_NEAREST=9985,X$P.NEAREST_MIPMAP_LINEAR=9986,X$P.LINEAR_MIPMAP_LINEAR=9987,X$P.TEXTURE_MAG_FILTER=10240,X$P.TEXTURE_MIN_FILTER=10241,X$P.TEXTURE_WRAP_S=10242,X$P.TEXTURE_WRAP_T=10243,X$P.TEXTURE_2D=3553,X$P.TEXTURE=5890,X$P.TEXTURE_CUBE_MAP=34067,X$P.TEXTURE_BINDING_CUBE_MAP=34068,X$P.TEXTURE_CUBE_MAP_POSITIVE_X=34069,X$P.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,X$P.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,X$P.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,X$P.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,X$P.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,X$P.MAX_CUBE_MAP_TEXTURE_SIZE=34076,X$P.TEXTURE0=33984,X$P.TEXTURE1=33985,X$P.TEXTURE2=33986,X$P.TEXTURE3=33987,X$P.TEXTURE4=33988,X$P.TEXTURE5=33989,X$P.TEXTURE6=33990,X$P.TEXTURE7=33991,X$P.TEXTURE8=33992,X$P.TEXTURE9=33993,X$P.TEXTURE10=33994,X$P.TEXTURE11=33995,X$P.TEXTURE12=33996,X$P.TEXTURE13=33997,X$P.TEXTURE14=33998,X$P.TEXTURE15=33999,X$P.TEXTURE16=34e3,X$P.TEXTURE17=34001,X$P.TEXTURE18=34002,X$P.TEXTURE19=34003,X$P.TEXTURE20=34004,X$P.TEXTURE21=34005,X$P.TEXTURE22=34006,X$P.TEXTURE23=34007,X$P.TEXTURE24=34008,X$P.TEXTURE25=34009,X$P.TEXTURE26=34010,X$P.TEXTURE27=34011,X$P.TEXTURE28=34012,X$P.TEXTURE29=34013,X$P.TEXTURE30=34014,X$P.TEXTURE31=34015,X$P.ACTIVE_TEXTURE=34016,X$P.REPEAT=10497,X$P.CLAMP_TO_EDGE=33071,X$P.MIRRORED_REPEAT=33648,X$P.FLOAT_VEC2=35664,X$P.FLOAT_VEC3=35665,X$P.FLOAT_VEC4=35666,X$P.INT_VEC2=35667,X$P.INT_VEC3=35668,X$P.INT_VEC4=35669,X$P.BOOL=35670,X$P.BOOL_VEC2=35671,X$P.BOOL_VEC3=35672,X$P.BOOL_VEC4=35673,X$P.FLOAT_MAT2=35674,X$P.FLOAT_MAT3=35675,X$P.FLOAT_MAT4=35676,X$P.SAMPLER_2D=35678,X$P.SAMPLER_CUBE=35680,X$P.VERTEX_ATTRIB_ARRAY_ENABLED=34338,X$P.VERTEX_ATTRIB_ARRAY_SIZE=34339,X$P.VERTEX_ATTRIB_ARRAY_STRIDE=34340,X$P.VERTEX_ATTRIB_ARRAY_TYPE=34341,X$P.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,X$P.VERTEX_ATTRIB_ARRAY_POINTER=34373,X$P.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,X$P.COMPILE_STATUS=35713,X$P.LOW_FLOAT=36336,X$P.MEDIUM_FLOAT=36337,X$P.HIGH_FLOAT=36338,X$P.LOW_INT=36339,X$P.MEDIUM_INT=36340,X$P.HIGH_INT=36341,X$P.FRAMEBUFFER=36160,X$P.RENDERBUFFER=36161,X$P.RGBA4=32854,X$P.RGB5_A1=32855,X$P.RGB565=36194,X$P.DEPTH_COMPONENT16=33189,X$P.STENCIL_INDEX=6401,X$P.STENCIL_INDEX8=36168,X$P.DEPTH_STENCIL=34041,X$P.RENDERBUFFER_WIDTH=36162,X$P.RENDERBUFFER_HEIGHT=36163,X$P.RENDERBUFFER_INTERNAL_FORMAT=36164,X$P.RENDERBUFFER_RED_SIZE=36176,X$P.RENDERBUFFER_GREEN_SIZE=36177,X$P.RENDERBUFFER_BLUE_SIZE=36178,X$P.RENDERBUFFER_ALPHA_SIZE=36179,X$P.RENDERBUFFER_DEPTH_SIZE=36180,X$P.RENDERBUFFER_STENCIL_SIZE=36181,X$P.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,X$P.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,X$P.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,X$P.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,X$P.COLOR_ATTACHMENT0=36064,X$P.DEPTH_ATTACHMENT=36096,X$P.STENCIL_ATTACHMENT=36128,X$P.DEPTH_STENCIL_ATTACHMENT=33306,X$P.NONE=0,X$P.FRAMEBUFFER_COMPLETE=36053,X$P.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,X$P.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,X$P.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,X$P.FRAMEBUFFER_UNSUPPORTED=36061,X$P.FRAMEBUFFER_BINDING=36006,X$P.RENDERBUFFER_BINDING=36007,X$P.MAX_RENDERBUFFER_SIZE=34024,X$P.INVALID_FRAMEBUFFER_OPERATION=1286,X$P.UNPACK_FLIP_Y_WEBGL=37440,X$P.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,X$P.CONTEXT_LOST_WEBGL=37442,X$P.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,X$P.BROWSER_DEFAULT_WEBGL=37444,X$P._useProgram=null,X$P._depthTest=!0,X$P._depthMask=!0,X$P._blend=!1,X$P._cullFace=!1,X$P.curBindTexTarget=null,X$P.curBindTexValue=null,X$k(X$P,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),X$P}(),X$Wm=function(X$m){function X$p(){X$p.__super.call(this)}X$R(X$p,"laya.webgl.display.GraphicsGL",X$Y);var X$h=X$p.prototype;return X$h.setShader=function(X$m){this._saveToCmd(X$c.context._setShader,[X$m])},X$h.setIBVB=function(X$m,X$p,X$h,X$P,X$L,X$q){this._saveToCmd(X$c.context._setIBVB,[X$m,X$p,X$h,X$P,X$L,X$q])},X$h.drawParticle=function(X$m,X$p,X$h){var X$P=X$H.createParticleTemplate2D(X$h);X$P.x=X$m,X$P.y=X$p,this._saveToCmd(X$c.context._drawParticle,[X$P])},X$p}(),X$Em=function(X$m){var X$h;function X$X(X$m){this._x=0,this._y=0,this._id=++X$X._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,X$X.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=X$X.MAXCLIPRECT,this.mOutPoint,this._canvas=X$m,this._canvas._addReference(),X$X._contextcount++,X$c.isFlash?(this._ib=X$Om.create(35044),X$nm.fillIBQuadrangle(this._ib,16)):this._ib=X$Om.QuadrangleIB,this.clear()}X$R(X$X,"laya.webgl.canvas.WebGLContext2D",X$L);var X$p=X$X.prototype;return X$p.setIsMainContext=function(){this._isMain=!0},X$p.clearBG=function(X$m,X$p,X$h,X$P){var X$L=X$Zm.mainContext;X$L.clearColor(X$m,X$p,X$h,X$P),X$L.clear(16384)},X$p._getSubmits=function(){return this._submits},X$p._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var X$m=0,X$p=this._submits._length;X$m<X$p;X$m++)this._submits[X$m].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},X$p.destroy=function(){--X$X._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=X$Om.QuadrangleIB&&this._ib.releaseResource()},X$p.clear=function(){this._submits||(this._other=X$h.DEFAULT,this._curMat=X$b.create(),this._vb=X$Cm.create(-1),this._submits=[],this._save=[X$i.Create(this)],this._save.length=10,this._shader2D=new X$O,this._triangleMesh=X$_m.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=X$h.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=X$X.MAXCLIPRECT,this._curSubmit=X$qm.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=X$r.DEFAULT;for(var X$m=0,X$p=this._submits._length;X$m<X$p;X$m++)this._submits[X$m].releaseRender(),this._submits[X$m]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},X$p.size=function(X$m,X$p){if(this._width!=X$m||this._height!=X$p)if(0==X$m||0==X$p){0!=this._vb._byteLength&&(this._width=X$m,this._height=X$p,this._vb.clear(),this._vb.upload());for(var X$h=0,X$P=this._submits._length;X$h<X$P;X$h++)this._submits[X$h].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=X$m,this._height=X$p,this._targets&&this._targets.size(X$m,X$p),this._canvas.memorySize-=this._canvas.memorySize;0===X$m&&0===X$p&&this._releaseMem()},X$p._getTransformMatrix=function(){return this._curMat},X$p.translate=function(X$m,X$p){0===X$m&&0===X$p||(X$g.save(this),this._curMat.bTransform&&(X$v.save(this),this._curMat.transformPointN(X$T.TEMP.setTo(X$m,X$p)),X$m=X$T.TEMP.x,X$p=X$T.TEMP.y),this._x+=X$m,this._y+=X$p)},X$p.save=function(){this._save[this._save._length++]=X$i.Create(this)},X$p.restore=function(){var X$m=this._save._length;if(!(X$m<1))for(var X$p=X$m-1;0<=X$p;X$p--){var X$h=this._save[X$p];if(X$h.restore(this),X$h.isSaveMark())return void(this._save._length=X$p)}},X$p._fillText=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){void 0===X$K&&(X$K=0);var X$D=this._shader2D,X$F=this._curSubmit.shaderValue,X$R=X$L?X$Am.create(X$L):this._other.font;if(X$s.enabled)X$D.ALPHA!==X$F.ALPHA&&(X$D.glTexture=null),X$$m.drawText(this,X$m,X$p,this._curMat,X$R,X$d||this._other.textAlign,X$q,X$k,X$Y,X$h,X$P,X$K);else{this._shader2D.defines.getValue();var X$$=X$q?X$A.create(X$q)._color:X$D.colorAdd;X$D.ALPHA===X$F.ALPHA&&X$$===X$D.colorAdd&&X$F.colorAdd===X$D.colorAdd||(X$D.glTexture=null,X$D.colorAdd=X$$),X$$m.drawText(this,X$m,X$p,this._curMat,X$R,X$d||this._other.textAlign,X$q,X$k,X$Y,X$h,X$P,X$K)}},X$p.fillWords=function(X$m,X$p,X$h,X$P,X$L,X$q){this._fillText(null,X$m,X$p,X$h,X$P,X$L,null,-1,null,X$q)},X$p.fillBorderWords=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this._fillBorderText(null,X$m,X$p,X$h,X$P,X$L,X$q,X$k,null)},X$p.fillText=function(X$m,X$p,X$h,X$P,X$L,X$q){this._fillText(X$m,null,X$p,X$h,X$P,X$L,null,-1,X$q)},X$p.strokeText=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this._fillText(X$m,null,X$p,X$h,X$P,null,X$L,X$q||1,X$k)},X$p.fillBorderText=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){this._fillBorderText(X$m,null,X$p,X$h,X$P,X$L,X$q,X$k,X$Y)},X$p._fillBorderText=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){if(!X$s.enabled)return this._fillText(X$m,X$p,X$h,X$P,X$L,null,X$k,X$Y||1,X$d),void this._fillText(X$m,X$p,X$h,X$P,X$L,X$q,null,-1,X$d);var X$K=this._shader2D,X$D=this._curSubmit.shaderValue;X$K.ALPHA!==X$D.ALPHA&&(X$K.glTexture=null);var X$F=X$L?(X$X._fontTemp.setFont(X$L),X$X._fontTemp):this._other.font;X$$m.drawText(this,X$m,X$p,this._curMat,X$F,X$d||this._other.textAlign,X$q,X$k,X$Y||1,X$h,X$P,0)},X$p.fillRect=function(X$m,X$p,X$h,X$P,X$L){var X$q=this._vb;if(X$nm.fillRectImgVb(X$q,this._clipRect,X$m,X$p,X$h,X$P,X$_.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var X$k=this._shader2D.fillStyle;X$L&&(this._shader2D.fillStyle=X$r.create(X$L));var X$Y=this._shader2D,X$d=this._curSubmit.shaderValue;if(X$Y.fillStyle!==X$d.fillStyle||X$Y.ALPHA!==X$d.ALPHA){X$Y.glTexture=null;var X$K=this._curSubmit=X$qm.createSubmit(this,this._ib,X$q,(X$q._byteLength-64)/32*3,X$Im.create(2,0));X$K.shaderValue.color=X$Y.fillStyle._color._color,X$K.shaderValue.ALPHA=X$Y.ALPHA,this._submits[this._submits._length++]=X$K}this._curSubmit._numEle+=6,this._shader2D.fillStyle=X$k}},X$p.fillTexture=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){if(X$m.loaded&&X$m.bitmap&&X$m.source){var X$d=this._vb,X$K=X$m.bitmap.width,X$D=X$m.bitmap.height,X$F=X$m.uv,X$R=X$k.x%X$m.width,X$$=X$k.y%X$m.height;if(X$K!=X$Y.w||X$D!=X$Y.h){if(!X$Y.w&&!X$Y.h)switch(X$Y.oy=X$Y.ox=0,X$q){case"repeat":X$Y.width=X$P,X$Y.height=X$L;break;case"repeat-x":X$Y.width=X$P,X$$<0?X$m.height+X$$>X$L?X$Y.height=X$L:X$Y.height=X$m.height+X$$:(X$Y.oy=X$$,X$m.height+X$$>X$L?X$Y.height=X$L-X$$:X$Y.height=X$m.height);break;case"repeat-y":X$R<0?X$m.width+X$R>X$P?X$Y.width=X$P:X$Y.width=X$m.width+X$R:(X$Y.ox=X$R,X$m.width+X$R>X$P?X$Y.width=X$P-X$R:X$Y.width=X$m.width),X$Y.height=X$L;break;case"no-repeat":X$R<0?X$m.width+X$R>X$P?X$Y.width=X$P:X$Y.width=X$m.width+X$R:(X$Y.ox=X$R,X$m.width+X$R>X$P?X$Y.width=X$P-X$R:X$Y.width=X$m.width),X$$<0?X$m.height+X$$>X$L?X$Y.height=X$L:X$Y.height=X$m.height+X$$:(X$Y.oy=X$$,X$m.height+X$$>X$L?X$Y.height=X$L-X$$:X$Y.height=X$m.height);break;default:X$Y.width=X$P,X$Y.height=X$L}X$Y.w=X$K,X$Y.h=X$D,X$Y.uv=[0,0,X$Y.width/X$K,0,X$Y.width/X$K,X$Y.height/X$D,0,X$Y.height/X$D]}if(X$p+=X$Y.ox,X$h+=X$Y.oy,X$R-=X$Y.ox,X$$-=X$Y.oy,X$nm.fillRectImgVb(X$d,this._clipRect,X$p,X$h,X$Y.width,X$Y.height,X$Y.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var X$A=X$Sm.create(this,this._ib,X$d,(X$d._byteLength-64)/32*3,X$Im.create(256,0)),X$B=(this._submits[this._submits._length++]=X$A).shaderValue;X$B.textureHost=X$m;var X$n=X$F[0]*X$K,X$c=X$F[1]*X$D,X$e=(X$F[2]-X$F[0])*X$K,X$a=(X$F[5]-X$F[3])*X$D,X$Z=-X$R/X$K,X$H=-X$$/X$D;X$B.u_TexRange[0]=X$n/X$K,X$B.u_TexRange[1]=X$e/X$K,X$B.u_TexRange[2]=X$c/X$D,X$B.u_TexRange[3]=X$a/X$D,X$B.u_offset[0]=X$Z,X$B.u_offset[1]=X$H,X$s.enabled&&!this._isMain&&X$A.addTexture(X$m,(X$d._byteLength>>2)-16),(this._curSubmit=X$A)._renderType=10017,X$A._numEle+=6}}else this.sprite&&X$W.timer.callLater(this,this._repaintSprite)},X$p.setShader=function(X$m){X$V.save(this,1048576,this._shader2D,!0),this._shader2D.shader=X$m},X$p.setFilters=function(X$m){X$V.save(this,2097152,this._shader2D,!0),this._shader2D.filters=X$m,this._curSubmit=X$qm.RENDERBASE,this._renderKey=0,this._drawCount++},X$p.drawTexture=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this._drawTextureM(X$m,X$p,X$h,X$P,X$L,X$q,X$k,null,1)},X$p.addTextureVb=function(X$m,X$p,X$h){var X$P=this._curSubmit._vb||this._vb,X$L=X$P._byteLength>>2;X$P.byteLength=X$L+16<<2;for(var X$q=X$P.getFloat32Array(),X$k=0;X$k<16;X$k+=4)X$q[X$L++]=X$m[X$k]+X$p,X$q[X$L++]=X$m[X$k+1]+X$h,X$q[X$L++]=X$m[X$k+2],X$q[X$L++]=X$m[X$k+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),X$P._upload=!0},X$p.willDrawTexture=function(X$m,X$p){if(!(X$m.loaded&&X$m.bitmap&&X$m.source))return this.sprite&&X$W.timer.callLater(this,this._repaintSprite),0;var X$h=X$m.bitmap,X$P=X$h.id+this._shader2D.ALPHA*X$p+10016;if(X$P==this._renderKey)return X$P;var X$L=this._shader2D,X$q=X$L.ALPHA,X$k=this._curSubmit.shaderValue;X$L.ALPHA*=X$p,this._renderKey=X$P,this._drawCount++,X$L.glTexture=X$h;var X$Y=this._vb,X$d=null,X$K=X$Y._byteLength/32*3,X$D=X$k.textureHost&&X$k.textureHost==X$m&&X$k.textureHost.alphaTexture==X$m.alphaTexture;return X$d=X$Sm.create(this,this._ib,X$Y,X$K,X$Im.create(1,0)),(this._submits[this._submits._length++]=X$d).shaderValue.textureHost=X$m,X$d._renderType=10016,X$d._preIsSameTextureShader=10016===this._curSubmit._renderType&&X$L.ALPHA===X$k.ALPHA&&X$D,this._curSubmit=X$d,X$L.ALPHA=X$q,X$P},X$p.drawTextures=function(X$m,X$p,X$h,X$P){if(X$m.loaded&&X$m.bitmap&&X$m.source){var X$L=this._clipRect;if(this._clipRect=X$X.MAXCLIPRECT,this._drawTextureM(X$m,X$p[0],X$p[1],X$m.width,X$m.height,X$h,X$P,null,1)){if(this._clipRect=X$L,X$M.drawCall++,!(X$p.length<4)){for(var X$q=this._curSubmit._vb||this._vb,X$k=this._curMat.a,X$Y=this._curMat.d,X$d=2,X$K=X$p.length;X$d<X$K;X$d+=2)X$nm.copyPreImgVb(X$q,(X$p[X$d]-X$p[X$d-2])*X$k,(X$p[X$d+1]-X$p[X$d-1])*X$Y),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&X$W.timer.callLater(this,this._repaintSprite)},X$p._drawTextureM=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){if(!X$m.loaded||!X$m.source)return this.sprite&&X$W.timer.callLater(this,this._repaintSprite),!1;var X$K=this._curSubmit._vb||this._vb,X$D=X$m.bitmap;X$p+=X$q,X$h+=X$k,this._drawCount++;var X$F=X$D.id+this._shader2D.ALPHA*X$d+10016;if(X$F!=this._renderKey){this._renderKey=X$F;var X$R=this._curSubmit.shaderValue,X$$=this._shader2D,X$A=X$$.ALPHA;X$$.ALPHA*=X$d,X$$.glTexture=X$D;var X$B=this._vb,X$n=null,X$c=X$B._byteLength/32*3,X$e=X$R.textureHost&&X$R.textureHost==X$m&&X$R.textureHost.alphaTexture==X$m.alphaTexture;X$n=X$Sm.create(this,this._ib,X$B,X$c,X$Im.create(1,0)),(this._submits[this._submits._length++]=X$n).shaderValue.textureHost=X$m,X$n._renderType=10016,X$n._preIsSameTextureShader=10016===this._curSubmit._renderType&&X$$.ALPHA===X$R.ALPHA&&X$e,this._curSubmit=X$n,X$K=this._curSubmit._vb||this._vb,X$$.ALPHA=X$A}return!!X$nm.fillRectImgVb(X$K,this._clipRect,X$p,X$h,X$P||X$m.width,X$L||X$m.height,X$m.uv,X$Y||this._curMat,this._x,this._y,0,0)&&(X$s.enabled&&!this._isMain&&this._curSubmit.addTexture(X$m,(X$K._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},X$p._repaintSprite=function(){this.sprite&&this.sprite.repaint()},X$p._drawText=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){var X$D=X$m.bitmap;this._drawCount++;var X$F=X$D.id+this._shader2D.ALPHA+10016;if(X$F!=this._renderKey){this._renderKey=X$F;var X$R=this._curSubmit.shaderValue,X$$=this._shader2D;X$$.glTexture=X$D;var X$A=this._vb,X$B=null,X$n=X$A._byteLength/32*3,X$c=X$R.textureHost&&X$R.textureHost==X$m&&X$R.textureHost.alphaTexture==X$m.alphaTexture;(X$B=X$s.enabled?X$Sm.create(this,this._ib,X$A,X$n,X$Im.create(1,0)):X$Sm.create(this,this._ib,X$A,X$n,X$gm.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&X$$.ALPHA===X$R.ALPHA&&X$c,(this._submits[this._submits._length++]=X$B).shaderValue.textureHost=X$m,X$B._renderType=10016,this._curSubmit=X$B}X$m.active();var X$e=this._curSubmit._vb||this._vb;X$nm.fillRectImgVb(X$e,this._clipRect,X$p+X$k,X$h+X$Y,X$P||X$m.width,X$L||X$m.height,X$m.uv,X$q||this._curMat,this._x,this._y,X$d,X$K,!0)&&(X$s.enabled&&!this._isMain&&this._curSubmit.addTexture(X$m,(X$e._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},X$p.drawTextureWithTransform=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){if(X$q){var X$K=this._curMat,X$D=this._x,X$F=this._y;(0!==X$k||0!==X$Y)&&(this._x=X$k*X$K.a+X$Y*X$K.c,this._y=X$Y*X$K.d+X$k*X$K.b),X$q&&X$K.bTransform?(X$b.mul(X$q,X$K,X$X._tmpMatrix),(X$q=X$X._tmpMatrix)._checkTransform()):(this._x+=X$K.tx,this._y+=X$K.ty),this._drawTextureM(X$m,X$p,X$h,X$P,X$L,0,0,X$q,X$d),this._x=X$D,this._y=X$F}else this._drawTextureM(X$m,X$p,X$h,X$P,X$L,X$k,X$Y,null,X$d)},X$p.fillQuadrangle=function(X$m,X$p,X$h,X$P,X$L){var X$q=this._curSubmit,X$k=this._vb,X$Y=this._shader2D,X$d=X$q.shaderValue;if(this._renderKey=0,X$m.bitmap){var X$K=X$m.bitmap;X$Y.glTexture==X$K&&X$Y.ALPHA===X$d.ALPHA||(X$Y.glTexture=X$K,(X$q=this._curSubmit=X$qm.createSubmit(this,this._ib,X$k,X$k._byteLength/32*3,X$Im.create(1,0))).shaderValue.glTexture=X$K,this._submits[this._submits._length++]=X$q),X$nm.fillQuadrangleImgVb(X$k,X$p,X$h,X$P,X$m.uv,X$L||this._curMat,this._x,this._y)}else X$q.shaderValue.fillStyle&&X$q.shaderValue.fillStyle.equal(X$m)&&X$Y.ALPHA===X$d.ALPHA||(X$Y.glTexture=null,(X$q=this._curSubmit=X$qm.createSubmit(this,this._ib,X$k,X$k._byteLength/32*3,X$Im.create(2,0))).shaderValue.defines.add(2),X$q.shaderValue.fillStyle=X$r.create(X$m),this._submits[this._submits._length++]=X$q),X$nm.fillQuadrangleImgVb(X$k,X$p,X$h,X$P,X$_.DEF_UV,X$L||this._curMat,this._x,this._y);X$q._numEle+=6},X$p.drawTexture2=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){if(0!=X$q){var X$d=this._curMat;if(this._x=X$m*X$d.a+X$p*X$d.c,this._y=X$p*X$d.d+X$m*X$d.b,X$L&&(X$L=X$d.bTransform||X$L.bTransform?(X$b.mul(X$L,X$d,X$X._tmpMatrix),X$X._tmpMatrix):(this._x+=X$L.tx+X$d.tx,this._y+=X$L.ty+X$d.ty,X$b.EMPTY)),1!==X$q||X$k){var X$K=this._shader2D.ALPHA,X$D=this._nBlendType;this._shader2D.ALPHA=X$q,X$k&&(this._nBlendType=X$U.TOINT(X$k)),this._drawTextureM(X$Y[0],X$Y[1]-X$h,X$Y[2]-X$P,X$Y[3],X$Y[4],0,0,X$L,1),this._shader2D.ALPHA=X$K,this._nBlendType=X$D}else this._drawTextureM(X$Y[0],X$Y[1]-X$h,X$Y[2]-X$P,X$Y[3],X$Y[4],0,0,X$L,1);this._x=this._y=0}},X$p.drawCanvas=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$m.context;if(this._renderKey=0,X$q._targets)this._submits[this._submits._length++]=X$Nm.create(X$q,0,null),this._curSubmit=X$qm.RENDERBASE,X$q._targets.drawTo(this,X$p,X$h,X$P,X$L);else{var X$k=this._submits[this._submits._length++]=X$Nm.create(X$q,this._shader2D.ALPHA,this._shader2D.filters),X$Y=X$P/X$m.width,X$d=X$L/X$m.height,X$K=X$k._matrix;this._curMat.copyTo(X$K),1!=X$Y&&1!=X$d&&X$K.scale(X$Y,X$d);var X$D=X$K.tx,X$F=X$K.ty;X$K.tx=X$K.ty=0,X$K.transformPoint(X$T.TEMP.setTo(X$p,X$h)),X$K.translate(X$T.TEMP.x+X$D,X$T.TEMP.y+X$F),this._curSubmit=X$qm.RENDERBASE}X$E.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=X$q._targets?"yellow":"green",this.strokeRect(X$p-1,X$h-1,X$P+2,X$L+2,1),this.strokeRect(X$p,X$h,X$P,X$L,1),this.restore())},X$p.drawTarget=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){void 0===X$K&&(X$K=-1);var X$D=this._vb;if(X$nm.fillRectImgVb(X$D,this._clipRect,X$p,X$h,X$P,X$L,X$d||X$_.DEF_UV,X$q||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var X$F=this._curSubmit=X$Fm.create(this,this._ib,X$D,(X$D._byteLength-64)/32*3,X$Y,X$k);X$F.blendType=-1==X$K?this._nBlendType:X$K,X$F.scope=X$m,this._submits[this._submits._length++]=X$F,this._curSubmit._numEle+=6}},X$p.mixRGBandAlpha=function(X$m){return this._mixRGBandAlpha(X$m,this._shader2D.ALPHA)},X$p._mixRGBandAlpha=function(X$m,X$p){var X$h=(4278190080&X$m)>>>24;return 0!=X$h?X$h*=X$p:X$h=255*X$p,16777215&X$m|X$h<<24},X$p.drawTriangles=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){if(!X$m.loaded||!X$m.source)return this.sprite&&X$W.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;X$m.bitmap;var X$D=this._mixRGBandAlpha(4294967295,X$Y),X$F=(X$P.length,X$q.length);this._renderKey=-1;var X$R=this._curSubmit=X$Sm.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,X$Im.create(1,0));return X$R.shaderValue.textureHost=X$m,X$R._renderType=10016,this._submits[this._submits._length++]=X$R,X$k?(X$X._tmpMatrix.a=X$k.a,X$X._tmpMatrix.b=X$k.b,X$X._tmpMatrix.c=X$k.c,X$X._tmpMatrix.d=X$k.d,X$X._tmpMatrix.tx=X$k.tx+X$p,X$X._tmpMatrix.ty=X$k.ty+X$h,X$b.mul(X$X._tmpMatrix,this._curMat,X$X._tmpMatrix)):(X$X._tmpMatrix.a=this._curMat.a,X$X._tmpMatrix.b=this._curMat.b,X$X._tmpMatrix.c=this._curMat.c,X$X._tmpMatrix.d=this._curMat.d,X$X._tmpMatrix.tx=this._curMat.tx+X$p,X$X._tmpMatrix.ty=this._curMat.ty+X$h),this._triangleMesh.addData(X$P,X$L,X$q,X$X._tmpMatrix,X$D,this),this._curSubmit._numEle+=X$F,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},X$p.transform=function(X$m,X$p,X$h,X$P,X$L,X$q){X$v.save(this),X$b.mul(X$b.TEMP.setTo(X$m,X$p,X$h,X$P,X$L,X$q),this._curMat,this._curMat),this._curMat._checkTransform()},X$p.setTransformByMatrix=function(X$m){X$m.copyTo(this._curMat)},X$p.transformByMatrix=function(X$m){X$v.save(this),X$b.mul(X$m,this._curMat,this._curMat),this._curMat._checkTransform()},X$p.rotate=function(X$m){X$v.save(this),this._curMat.rotateEx(X$m)},X$p.scale=function(X$m,X$p){X$v.save(this),this._curMat.scaleEx(X$m,X$p)},X$p.clipRect=function(X$m,X$p,X$h,X$P){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var X$L=X$Dm.create(4);this.addRenderObject(X$L);var X$q=this._vb,X$k=X$q._byteLength>>2;if(X$nm.fillRectImgVb(X$q,null,X$m,X$p,X$h,X$P,X$_.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var X$Y=this._curSubmit=X$qm.createSubmit(this,this._ib,X$q,(X$q._byteLength-64)/32*3,X$Im.create(2,0));X$Y.shaderValue.ALPHA=1,this._submits[this._submits._length++]=X$Y,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var X$d=X$Dm.create(5);this.addRenderObject(X$d);var X$K=X$q.getFloat32Array(),X$D=Math.min(Math.min(Math.min(X$K[0+X$k],X$K[4+X$k]),X$K[8+X$k]),X$K[12+X$k]),X$F=Math.max(Math.max(Math.max(X$K[0+X$k],X$K[4+X$k]),X$K[8+X$k]),X$K[12+X$k]),X$R=Math.min(Math.min(Math.min(X$K[1+X$k],X$K[5+X$k]),X$K[9+X$k]),X$K[13+X$k]),X$$=Math.max(Math.max(Math.max(X$K[1+X$k],X$K[5+X$k]),X$K[9+X$k]),X$K[13+X$k]);X$f.save(this,X$d,X$m,X$p,X$h,X$P,X$D,X$R,X$F-X$D,X$$-X$R),this._curSubmit=X$qm.RENDERBASE}else{X$h*=this._curMat.a,X$P*=this._curMat.d;var X$A=X$T.TEMP;this._curMat.transformPoint(X$A.setTo(X$m,X$p)),X$h<0&&(X$A.x=X$A.x+X$h,X$h=-X$h),X$P<0&&(X$A.y=X$A.y+X$P,X$P=-X$P),this._renderKey=0;var X$B=this._curSubmit=X$Km.create(this);(this._submits[this._submits._length++]=X$B).submitIndex=this._submits._length,X$B.submitLength=9999999,X$o.save(this,X$B);var X$n=this._clipRect,X$c=X$n.x,X$e=X$n.y,X$a=X$A.x+X$h,X$Z=X$A.y+X$P;X$c<X$A.x&&(X$n.x=X$A.x),X$e<X$A.y&&(X$n.y=X$A.y),X$n.width=Math.min(X$a,X$c+X$n.width)-X$n.x,X$n.height=Math.min(X$Z,X$e+X$n.height)-X$n.y,this._shader2D.glTexture=null,X$B.clipRect.copyFrom(X$n),this._curSubmit=X$qm.RENDERBASE}},X$p.setIBVB=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D){if(void 0===X$d&&(X$d=0),void 0===X$K&&(X$K=0),void 0===X$D&&(X$D=0),null===X$h){if(X$c.isFlash){var X$F=X$P;X$F._selfIB||(X$F._selfIB=X$Om.create(35044)),X$F._selfIB.clear(),X$h=X$F._selfIB}else X$h=this._ib;X$nm.expandIBQuadrangle(X$h,X$P._byteLength/(4*X$P.vertexStride*4))}if(!X$Y||!X$k)throw Error("setIBVB must input:shader shaderValues");var X$R=X$dm.create(this,X$P,X$h,X$L,X$k,X$Y,X$d,X$K,X$D);X$q||(X$q=X$b.EMPTY),X$q.translate(X$m,X$p),X$b.mul(X$q,this._curMat,X$R._mat),X$q.translate(-X$m,-X$p),this._submits[this._submits._length++]=X$R,this._curSubmit=X$qm.RENDERBASE,this._renderKey=0},X$p.addRenderObject=function(X$m){this._submits[this._submits._length++]=X$m},X$p.fillTrangles=function(X$m,X$p,X$h,X$P,X$L){var X$q=this._curSubmit,X$k=this._vb,X$Y=this._shader2D,X$d=X$q.shaderValue,X$K=X$P.length>>4,X$D=X$m.bitmap;this._renderKey=0,X$Y.glTexture==X$D&&X$Y.ALPHA===X$d.ALPHA||((X$q=this._curSubmit=X$qm.createSubmit(this,this._ib,X$k,X$k._byteLength/32*3,X$Im.create(1,0))).shaderValue.textureHost=X$m,this._submits[this._submits._length++]=X$q),X$nm.fillTranglesVB(X$k,X$p,X$h,X$P,X$L||this._curMat,this._x,this._y),X$q._numEle+=6*X$K},X$p.submitElement=function(X$m,X$p){var X$h=this._submits;for(X$p<0&&(X$p=X$h._length);X$m<X$p;)X$m+=X$h[X$m].renderSubmit()},X$p.finish=function(){X$Zm.mainContext.finish()},X$p.flush=function(){var X$m=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(X$m>this._ib.bufferLength/12&&X$nm.expandIBQuadrangle(this._ib,X$m),!this._isMain&&X$s.enabled&&X$s._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=X$s._atlasRestore;for(var X$p=this._submits,X$h=0,X$P=X$p._length;X$h<X$P;X$h++){var X$L=X$p[X$h];10016===X$L.getRenderType()&&X$L.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),X$pm.instance&&X$pm.getInstance().reset();var X$q;for(X$h=0,X$q=this.meshlist.length;X$h<X$q;X$h++){var X$k=this.meshlist[X$h];X$k.canReuse?X$k.releaseMesh():X$k.destroy()}return this.meshlist.length=0,this._curSubmit=X$qm.RENDERBASE,this._renderKey=0,this._triangleMesh=X$_m.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},X$p.setPathId=function(X$m){if(this.mId=X$m,-1!=this.mId){this.mHaveKey=!1;var X$p=X$J.getInstance();X$p.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,X$p.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},X$p.movePath=function(X$m,X$p){var X$h=X$m,X$P=X$p;X$m=this._curMat.a*X$h+this._curMat.c*X$P+this._curMat.tx,X$p=this._curMat.b*X$h+this._curMat.d*X$P+this._curMat.ty,this.mX+=X$m,this.mY+=X$p},X$p.beginPath=function(){var X$m=this._getPath();X$m.tempArray.length=0,X$m.closePath=!1,this.mX=0,this.mY=0},X$p.closePath=function(){this._path.closePath=!0},X$p.fill=function(X$m){void 0===X$m&&(X$m=!1);var X$p=this._getPath();this.drawPoly(0,0,X$p.tempArray,this.fillStyle._color.numColor,0,0,X$m)},X$p.stroke=function(){var X$m=this._getPath();if(0<this.lineWidth){if(-1==this.mId)X$m.drawLine(0,0,X$m.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var X$p=X$J.getInstance().shapeLineDic[this.mId];X$p.rebuild(X$m.tempArray),X$m.setGeomtry(X$p)}else X$J.getInstance().addLine(this.mId,X$m.drawLine(0,0,X$m.tempArray,this.lineWidth,this.strokeStyle._color.numColor));X$m.update();var X$h=[this.mX,this.mY],X$P=X$qm.createShape(this,X$m.ib,X$m.vb,X$m.count,X$m.offset,X$Im.create(4,0));X$P.shaderValue.ALPHA=this._shader2D.ALPHA,X$P.shaderValue.u_pos=X$h,X$P.shaderValue.u_mmat2=X$em.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=X$P,this._renderKey=-1}},X$p.line=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=this._curSubmit,X$Y=this._vb;if(X$nm.fillLineVb(X$Y,this._clipRect,X$m,X$p,X$h,X$P,X$L,X$q)){this._renderKey=0;var X$d=this._shader2D,X$K=X$k.shaderValue;X$d.strokeStyle===X$K.strokeStyle&&X$d.ALPHA===X$K.ALPHA||(X$d.glTexture=null,(X$k=this._curSubmit=X$qm.createSubmit(this,this._ib,X$Y,(X$Y._byteLength-64)/32*3,X$Im.create(2,0))).shaderValue.strokeStyle=X$d.strokeStyle,X$k.shaderValue.mainID=2,X$k.shaderValue.ALPHA=X$d.ALPHA,this._submits[this._submits._length++]=X$k),X$k._numEle+=6}},X$p.moveTo=function(X$m,X$p,X$h){void 0===X$h&&(X$h=!0);var X$P=this._getPath();if(X$h){var X$L=X$m,X$q=X$p;X$m=this._curMat.a*X$L+this._curMat.c*X$q,X$p=this._curMat.b*X$L+this._curMat.d*X$q}X$P.addPoint(X$m,X$p)},X$p.lineTo=function(X$m,X$p,X$h){void 0===X$h&&(X$h=!0);var X$P=this._getPath();if(X$h){var X$L=X$m,X$q=X$p;X$m=this._curMat.a*X$L+this._curMat.c*X$q,X$p=this._curMat.b*X$L+this._curMat.d*X$q}X$P.addPoint(X$m,X$p)},X$p.drawCurves=function(X$m,X$p,X$h){this.setPathId(-1),this.beginPath(),this.strokeStyle=X$h[3],this.lineWidth=X$h[4];var X$P=X$h[2];X$m+=X$h[0],X$p+=X$h[1],this.movePath(X$m,X$p),this.moveTo(X$P[0],X$P[1]);for(var X$L=2,X$q=X$P.length;X$L<X$q;)this.quadraticCurveTo(X$P[X$L++],X$P[X$L++],X$P[X$L++],X$P[X$L++]);this.stroke()},X$p.arcTo=function(X$m,X$p,X$h,X$P,X$L){if(-1==this.mId||!this.mHaveKey){var X$q=0,X$k=0,X$Y=0,X$d=this._getPath();this._curMat.copyTo(X$X._tmpMatrix),X$X._tmpMatrix.tx=X$X._tmpMatrix.ty=0,X$X._tempPoint.setTo(X$d.getEndPointX(),X$d.getEndPointY()),X$X._tmpMatrix.invertTransformPoint(X$X._tempPoint);var X$K=X$X._tempPoint.x-X$m,X$D=X$X._tempPoint.y-X$p,X$F=Math.sqrt(X$K*X$K+X$D*X$D);if(!(X$F<=1e-6)){var X$R=X$K/X$F,X$$=X$D/X$F,X$A=X$h-X$m,X$B=X$P-X$p,X$n=X$A*X$A+X$B*X$B,X$c=Math.sqrt(X$n);if(!(X$c<=1e-6)){var X$e=X$A/X$c,X$a=X$B/X$c,X$Z=X$R+X$e,X$H=X$$+X$a,X$W=Math.sqrt(X$Z*X$Z+X$H*X$H);if(!(X$W<=1e-6)){var X$E=X$Z/X$W,X$I=X$H/X$W,X$b=Math.acos(X$E*X$R+X$I*X$$),X$T=Math.PI/2-X$b,X$j=(X$F=X$L/Math.tan(X$T))*X$R+X$m,X$x=X$F*X$$+X$p,X$Q=Math.sqrt(X$F*X$F+X$L*X$L),X$M=X$m+X$E*X$Q,X$u=X$p+X$I*X$Q,X$N=0,X$S=0;if(0<=X$R*X$a-X$$*X$e){var X$_=2*X$T/X$X.SEGNUM;X$N=Math.sin(X$_),X$S=Math.cos(X$_)}else X$_=2*-X$T/X$X.SEGNUM,X$N=Math.sin(X$_),X$S=Math.cos(X$_);X$k=this._curMat.a*X$j+this._curMat.c*X$x,X$Y=this._curMat.b*X$j+this._curMat.d*X$x,X$k==this._path.getEndPointX()&&X$Y==this._path.getEndPointY()||X$d.addPoint(X$k,X$Y);var X$l=X$j-X$M,X$J=X$x-X$u;for(X$q=0;X$q<X$X.SEGNUM;X$q++){var X$z=X$l*X$S+X$J*X$N,X$w=-X$l*X$N+X$J*X$S;X$k=X$z+X$M,X$Y=X$w+X$u,X$m=this._curMat.a*X$k+this._curMat.c*X$Y,X$Y=X$p=this._curMat.b*X$k+this._curMat.d*X$Y,(X$k=X$m)==this._path.getEndPointX()&&X$Y==this._path.getEndPointY()||X$d.addPoint(X$k,X$Y),X$l=X$z,X$J=X$w}}}}}},X$p.arc=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){if(void 0===X$q&&(X$q=!1),void 0===X$k&&(X$k=!0),-1!=this.mId){var X$Y=X$J.getInstance().shapeDic[this.mId];if(X$Y&&this.mHaveKey&&!X$Y.needUpdate(this._curMat))return;X$p=X$m=0}var X$d,X$K=0,X$D=0,X$F=0,X$R=0,X$$=0,X$A=0,X$B=0;if(X$D=X$L-X$P,X$q)if(Math.abs(X$D)>=2*Math.PI)X$D=2*-Math.PI;else for(;0<X$D;)X$D-=2*Math.PI;else if(Math.abs(X$D)>=2*Math.PI)X$D=2*Math.PI;else for(;X$D<0;)X$D+=2*Math.PI;X$d=X$D/(X$B=X$h<101?Math.max(10,X$D*X$h/5):X$h<201?Math.max(10,X$D*X$h/20):Math.max(10,X$D*X$h/40))/2,X$F=Math.abs(4/3*(1-Math.cos(X$d))/Math.sin(X$d)),X$q&&(X$F=-X$F);var X$n=this._getPath(),X$c=NaN,X$e=NaN;for(X$A=0;X$A<=X$B;X$A++)X$K=X$P+X$D*(X$A/X$B),X$R=X$m+Math.cos(X$K)*X$h,X$$=X$p+Math.sin(X$K)*X$h,X$k&&(X$c=X$R,X$e=X$$,X$R=this._curMat.a*X$c+this._curMat.c*X$e,X$$=this._curMat.b*X$c+this._curMat.d*X$e),X$R==this._path.getEndPointX()&&X$$==this._path.getEndPointY()||X$n.addPoint(X$R,X$$);X$R=X$m+Math.cos(X$L)*X$h,X$$=X$p+Math.sin(X$L)*X$h,X$k&&(X$c=X$R,X$e=X$$,X$R=this._curMat.a*X$c+this._curMat.c*X$e,X$$=this._curMat.b*X$c+this._curMat.d*X$e),X$R==this._path.getEndPointX()&&X$$==this._path.getEndPointY()||X$n.addPoint(X$R,X$$)},X$p.quadraticCurveTo=function(X$m,X$p,X$h,X$P){var X$L=X$F.I,X$q=X$h,X$k=X$P;X$h=this._curMat.a*X$q+this._curMat.c*X$k,X$P=this._curMat.b*X$q+this._curMat.d*X$k,X$q=X$m,X$k=X$p,X$m=this._curMat.a*X$q+this._curMat.c*X$k,X$p=this._curMat.b*X$q+this._curMat.d*X$k;for(var X$Y=X$L.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),X$m,X$p,X$h,X$P],30,2),X$d=0,X$K=X$Y.length/2;X$d<X$K;X$d++)this.lineTo(X$Y[2*X$d],X$Y[2*X$d+1],!1);this.lineTo(X$h,X$P,!1)},X$p.rect=function(X$m,X$p,X$h,X$P){this._other=this._other.make(),this._other.path||(this._other.path=new X$y),this._other.path.rect(X$m,X$p,X$h,X$P)},X$p.strokeRect=function(X$m,X$p,X$h,X$P,X$L){var X$q=.5*X$L;this.line(X$m-X$q,X$p,X$m+X$h+X$q,X$p,X$L,this._curMat),this.line(X$m+X$h,X$p,X$m+X$h,X$p+X$P,X$L,this._curMat),this.line(X$m,X$p,X$m,X$p+X$P,X$L,this._curMat),this.line(X$m-X$q,X$p+X$P,X$m+X$h+X$q,X$p+X$P,X$L,this._curMat)},X$p.clip=function(){},X$p.drawPoly=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){void 0===X$k&&(X$k=!1),this._renderKey=0,this._shader2D.glTexture=null;var X$Y=this._getPath();if(-1==this.mId)X$Y.polygon(X$m,X$p,X$h,X$P,X$L||1,X$q);else if(this.mHaveKey){var X$d=X$J.getInstance().shapeDic[this.mId];X$d.setMatrix(this._curMat),X$d.rebuild(X$Y.tempArray),X$Y.setGeomtry(X$d)}else{var X$K=X$Y.polygon(X$m,X$p,X$h,X$P,X$L||1,X$q);X$J.getInstance().addShape(this.mId,X$K),X$K.setMatrix(this._curMat)}X$Y.update();var X$D,X$F=[this.mX,this.mY];if((X$D=X$qm.createShape(this,X$Y.ib,X$Y.vb,X$Y.count,X$Y.offset,X$Im.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,X$D.shaderValue.u_pos=X$F,X$D.shaderValue.u_mmat2=X$em.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=X$D,0<X$L){if(this.mHaveLineKey){var X$R=X$J.getInstance().shapeLineDic[this.mId];X$R.rebuild(X$Y.tempArray),X$Y.setGeomtry(X$R)}else X$J.getInstance().addShape(this.mId,X$Y.drawLine(X$m,X$p,X$h,X$L,X$q));X$Y.update(),(X$D=X$qm.createShape(this,X$Y.ib,X$Y.vb,X$Y.count,X$Y.offset,X$Im.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,X$D.shaderValue.u_mmat2=X$em.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=X$D}},X$p.drawParticle=function(X$m,X$p,X$h){X$h.x=X$m,X$h.y=X$p,this._submits[this._submits._length++]=X$h},X$p._getPath=function(){return this._path||(this._path=new X$y)},X$P(0,X$p,"globalCompositeOperation",function(){return X$U.NAMES[this._nBlendType]},function(X$m){var X$p=X$U.TOINT[X$m];null==X$p||this._nBlendType===X$p||(X$V.save(this,65536,this,!0),this._curSubmit=X$qm.RENDERBASE,this._renderKey=0,this._nBlendType=X$p)}),X$P(0,X$p,"strokeStyle",function(){return this._shader2D.strokeStyle},function(X$m){this._shader2D.strokeStyle.equal(X$m)||(X$V.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=X$r.create(X$m))}),X$P(0,X$p,"globalAlpha",function(){return this._shader2D.ALPHA},function(X$m){(X$m=Math.floor(1e3*X$m)/1e3)!=this._shader2D.ALPHA&&(X$V.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=X$m)}),X$P(0,X$p,"asBitmap",null,function(X$m){if(X$m){if(this._targets||(this._targets=new X$t),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),X$P(0,X$p,"fillStyle",function(){return this._shader2D.fillStyle},function(X$m){this._shader2D.fillStyle.equal(X$m)||(X$V.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=X$r.create(X$m))}),X$P(0,X$p,"textAlign",function(){return this._other.textAlign},function(X$m){this._other.textAlign===X$m||(this._other=this._other.make(),X$V.save(this,32768,this._other,!1),this._other.textAlign=X$m)}),X$P(0,X$p,"lineWidth",function(){return this._other.lineWidth},function(X$m){this._other.lineWidth===X$m||(this._other=this._other.make(),X$V.save(this,256,this._other,!1),this._other.lineWidth=X$m)}),X$P(0,X$p,"textBaseline",function(){return this._other.textBaseline},function(X$m){this._other.textBaseline===X$m||(this._other=this._other.make(),X$V.save(this,16384,this._other,!1),this._other.textBaseline=X$m)}),X$P(0,X$p,"font",null,function(X$m){X$m!=this._other.font.toString()&&(this._other=this._other.make(),X$V.save(this,8,this._other,!1),this._other.font===X$Am.EMPTY?this._other.font=new X$Am(X$m):this._other.font.setFont(X$m))}),X$X.__init__=function(){X$h.DEFAULT=new X$h},X$X._tempPoint=new X$T,X$X._SUBMITVBSIZE=32e3,X$X._MAXSIZE=99999999,X$X._RECTVBSIZE=16,X$X.MAXCLIPRECT=new X$j(0,0,99999999,99999999),X$X._COUNT=0,X$X._tmpMatrix=new X$b,X$X.SEGNUM=32,X$X._contextcount=0,X$k(X$X,["_fontTemp",function(){return this._fontTemp=new X$Am},"_drawStyleTemp",function(){return this._drawStyleTemp=new X$r(null)}]),X$X.__init$=function(){X$h=function(){function X$m(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=X$Am.EMPTY}X$R(X$m,"");var X$p=X$m.prototype;return X$p.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=X$Am.EMPTY},X$p.make=function(){return this===X$m.DEFAULT?new X$m:this},X$m.DEFAULT=null,X$m}()},X$X}(),X$Im=function(X$m){function X$P(X$m,X$p){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,X$P.__super.call(this),this.defines=new X$xm,this.position=X$P._POSITION,this.mainID=X$m,this.subID=X$p,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=X$m|X$p,this._inClassCache=X$P._cache[this._cacheID],0<X$m&&!this._inClassCache&&(this._inClassCache=X$P._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}X$R(X$P,"laya.webgl.shader.d2.value.Value2D",X$w);var X$p=X$P.prototype;return X$p.setValue=function(X$m){},X$p.refresh=function(){var X$m=this.size;return X$m[0]=X$em.width,X$m[1]=X$em.height,this.alpha=this.ALPHA*X$em.worldAlpha,this.mmat=X$em.worldMatrix4,this},X$p._ShaderWithCompile=function(){return X$im.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,X$tm.create)},X$p._withWorldShaderDefines=function(){var X$m=X$em.worldShaderDefines,X$p=X$im.sharders[this.mainID|this.defines._value|X$m.getValue()];if(!X$p){var X$h,X$P={};for(X$h in this.defines.toNameDic())X$P[X$h]="";for(X$h in X$m.toNameDic())X$P[X$h]="";X$p=X$im.withCompile2D(0,this.mainID,X$P,this.mainID|this.defines._value|X$m.getValue(),X$tm.create)}var X$L=X$em.worldFilters;if(!X$L)return X$p;for(var X$q,X$k=X$L.length,X$Y=0;X$Y<X$k;X$Y++)(X$q=X$L[X$Y])&&X$q.action.setValue(this);return X$p},X$p.upload=function(){var X$m=X$em;this.alpha=this.ALPHA*X$m.worldAlpha,X$em.worldMatrix4!==X$em.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),X$Zm.shaderHighPrecision&&this.defines.add(1024);var X$p,X$h=X$m.worldShaderDefines?this._withWorldShaderDefines():X$im.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=X$m.width,this.size[1]=X$m.height,this.mmat=X$m.worldMatrix4,X$lm.activeShader!==X$h?X$h._shaderValueWidth!==X$m.width||X$h._shaderValueHeight!==X$m.height?(X$h._shaderValueWidth=X$m.width,X$h._shaderValueHeight=X$m.height):X$p=X$h._params2dQuick2||X$h._make2dQuick2():X$h._shaderValueWidth!==X$m.width||X$h._shaderValueHeight!==X$m.height?(X$h._shaderValueWidth=X$m.width,X$h._shaderValueHeight=X$m.height):X$p=X$h._params2dQuick1||X$h._make2dQuick1(),X$h.upload(this,X$p)},X$p.setFilters=function(X$m){if(this.filters=X$m)for(var X$p,X$h=X$m.length,X$P=0;X$P<X$h;X$P++)(X$p=X$m[X$P])&&(this.defines.add(X$p.type),X$p.action.setValue(this))},X$p.clear=function(){this.defines.setValue(this.subID)},X$p.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},X$P._initone=function(X$m,X$p){X$P._typeClass[X$m]=X$p,X$P._cache[X$m]=[],X$P._cache[X$m]._length=0},X$P.__init__=function(){X$P._POSITION=[2,5126,!1,4*X$Bm.BYTES_PE,0],X$P._TEXCOORD=[2,5126,!1,4*X$Bm.BYTES_PE,2*X$Bm.BYTES_PE],X$P._initone(2,X$Xm),X$P._initone(4,X$Um),X$P._initone(256,X$sm),X$P._initone(512,X$wm),X$P._initone(1,X$Gm),X$P._initone(65,X$gm),X$P._initone(9,X$Gm)},X$P.create=function(X$m,X$p){var X$h=X$P._cache[X$m|X$p];return X$h._length?X$h[--X$h._length]:new X$P._typeClass[X$m|X$p](X$p)},X$P._POSITION=null,X$P._TEXCOORD=null,X$P._cache=[],X$P._typeClass=[],X$P.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],X$P}(),X$bm=function(X$m){function X$n(X$m,X$p){X$n.__super.call(this,X$m,X$p)}X$R(X$n,"laya.webgl.utils.RenderSprite3D",X$e);var X$p=X$n.prototype;return X$p.onCreate=function(X$m){switch(X$m){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},X$p._mask=function(X$m,X$p,X$h,X$P){var X$L,X$q,X$k=this._next,X$Y=X$m.mask;if(X$Y){X$p.ctx.save();var X$d=X$p.ctx.globalCompositeOperation,X$K=new X$j;if(X$K.copyFrom(X$Y.getBounds()),X$K.width=Math.round(X$K.width),X$K.height=Math.round(X$K.height),X$K.x=Math.round(X$K.x),X$K.y=Math.round(X$K.y),0<X$K.width&&0<X$K.height){var X$D=X$m._style._tf,X$F=X$Ym.create();X$F.addValue("bounds",X$K),X$L=X$km.create([X$F,X$p],laya.webgl.utils.RenderSprite3D.tmpTarget),X$p.addRenderObject(X$L),X$Y.render(X$p,-X$K.x,-X$K.y),X$L=X$km.create([X$F],laya.webgl.utils.RenderSprite3D.endTmpTarget),X$p.addRenderObject(X$L),X$p.ctx.save(),X$p.clipRect(X$h-X$D.translateX+X$K.x,X$P-X$D.translateY+X$K.y,X$K.width,X$K.height),X$k._fun.call(X$k,X$m,X$p,X$h,X$P),X$p.ctx.restore(),X$q=X$Dm.create(6),X$d=X$p.ctx.globalCompositeOperation,X$q.blendMode="mask",X$p.addRenderObject(X$q),X$b.TEMP.identity();var X$R=X$Im.create(1,0),X$$=X$_.INV_UV,X$A=X$K.width,X$B=X$K.height;(X$K.width<32||X$K.height<32)&&((X$$=X$n.tempUV)[0]=0,X$$[1]=0,X$$[2]=32<=X$K.width?1:X$K.width/32,X$$[3]=0,X$$[4]=32<=X$K.width?1:X$K.width/32,X$$[5]=32<=X$K.height?1:X$K.height/32,X$$[6]=0,X$$[7]=32<=X$K.height?1:X$K.height/32,X$K.width=32<=X$K.width?X$K.width:32,X$K.height=32<=X$K.height?X$K.height:32,X$$[1]*=-1,X$$[3]*=-1,X$$[5]*=-1,X$$[7]*=-1,X$$[1]+=1,X$$[3]+=1,X$$[5]+=1,X$$[7]+=1),X$p.ctx.drawTarget(X$F,X$h+X$K.x-X$D.translateX,X$P+X$K.y-X$D.translateY,X$A,X$B,X$b.TEMP,"tmpTarget",X$R,X$$,6),X$L=X$km.create([X$F],laya.webgl.utils.RenderSprite3D.recycleTarget),X$p.addRenderObject(X$L),(X$q=X$Dm.create(6)).blendMode=X$d,X$p.addRenderObject(X$q)}X$p.ctx.restore()}else X$k._fun.call(X$k,X$m,X$p,X$h,X$P)},X$p._blend=function(X$m,X$p,X$h,X$P){var X$L=X$m._style,X$q=this._next;X$L.blendMode?(X$p.ctx.save(),X$p.ctx.globalCompositeOperation=X$L.blendMode,X$q._fun.call(X$q,X$m,X$p,X$h,X$P),X$p.ctx.restore()):X$q._fun.call(X$q,X$m,X$p,X$h,X$P)},X$p._transform=function(X$m,X$p,X$h,X$P){var X$L=X$m.transform,X$q=this._next;if(X$L&&X$q!=X$e.NORENDER){var X$k=X$p.ctx;X$m._style;X$L.tx=X$h,X$L.ty=X$P;var X$Y=X$k._getTransformMatrix(),X$d=X$Y.clone();X$b.mul(X$L,X$Y,X$Y),X$Y._checkTransform(),X$L.tx=X$L.ty=0,X$q._fun.call(X$q,X$m,X$p,0,0),X$d.copyTo(X$Y),X$d.destroy()}else X$q._fun.call(X$q,X$m,X$p,X$h,X$P)},X$n.tmpTarget=function(X$m,X$p){var X$h=X$m.getValue("bounds"),X$P=X$Jm.create(X$h.width,X$h.height);X$P.start(),X$P.clear(0,0,0,0),X$m.addValue("tmpTarget",X$P)},X$n.endTmpTarget=function(X$m){X$m.getValue("tmpTarget").end()},X$n.recycleTarget=function(X$m){X$m.getValue("tmpTarget").recycle(),X$m.recycle()},X$k(X$n,["tempUV",function(){return this.tempUV=new Array(8)}]),X$n}(),X$Tm=function(X$m){function X$p(){this.data=null,X$p.__super.call(this)}X$R(X$p,"laya.filters.webgl.ColorFilterActionGL",X$z);var X$h=X$p.prototype;return X$W.imps(X$h,{"laya.filters.IFilterActionGL":!0}),X$h.setValue=function(X$m){X$m.colorMat=this.data._mat,X$m.colorAlpha=this.data._alpha},X$h.apply3d=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$m.getValue("bounds"),X$k=X$Im.create(1,0);X$k.setFilters([this.data]);var X$Y=X$b.TEMP;X$Y.identity(),X$h.ctx.drawTarget(X$m,0,0,X$q.width,X$q.height,X$Y,"src",X$k)},X$p}(),X$jm=function(X$m){function X$q(X$m,X$p,X$h,X$P,X$L){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,X$q.__super.call(this,X$m,X$p,X$L),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new X$rm,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=X$h,this._atlasCanvas.height=X$P,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}X$R(X$q,"laya.webgl.atlas.Atlaser",X$X);var X$p=X$q.prototype;return X$p.computeUVinAtlasTexture=function(X$m,X$p,X$h,X$P){var X$L=X$s.atlasTextureWidth,X$q=X$s.atlasTextureHeight,X$k=X$h/X$L,X$Y=X$P/X$q,X$d=(X$h+X$m.bitmap.width)/X$L,X$K=(X$P+X$m.bitmap.height)/X$q,X$D=X$m.bitmap.width/X$L,X$F=X$m.bitmap.height/X$q;X$m.uv=[X$k+X$p[0]*X$D,X$Y+X$p[1]*X$F,X$d-(1-X$p[2])*X$D,X$Y+X$p[3]*X$F,X$d-(1-X$p[4])*X$D,X$K-(1-X$p[5])*X$F,X$k+X$p[6]*X$D,X$K-(1-X$p[7])*X$F]},X$p.findBitmapIsExist=function(X$m){if(X$m instanceof laya.webgl.resource.WebGLImage){var X$p=X$m,X$h=X$p.url,X$P=this._InAtlasWebGLImagesKey[X$h||X$p.id];if(X$P)return X$P.offsetInfoID}return-1},X$p.addToAtlasTexture=function(X$m,X$p,X$h){if(X$m instanceof laya.webgl.resource.WebGLImage){var X$P=X$m,X$L=X$P.url;this._InAtlasWebGLImagesKey[X$L||X$P.id]={bitmap:X$m,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([X$p,X$h])}this._atlasCanvas.texSubImage2D(X$p,X$h,X$m.atlasSource),X$m.clearAtlasSource()},X$p.addToAtlas=function(X$m,X$p,X$h){X$m._atlasID=this._inAtlasTextureKey.length;var X$P=X$m.uv.slice(),X$L=X$m.bitmap;this._inAtlasTextureKey.push(X$m),this._inAtlasTextureOriUVValue.push(X$P),this._inAtlasTextureBitmapValue.push(X$L),this.computeUVinAtlasTexture(X$m,X$P,X$p,X$h),X$m.bitmap=this._atlasCanvas},X$p.clear=function(){for(var X$m=0,X$p=this._inAtlasTextureKey.length;X$m<X$p;X$m++)this._inAtlasTextureKey[X$m].bitmap=this._inAtlasTextureBitmapValue[X$m],this._inAtlasTextureKey[X$m].uv=this._inAtlasTextureOriUVValue[X$m],this._inAtlasTextureKey[X$m]._atlasID=-1,this._inAtlasTextureKey[X$m].bitmap.lock=!1,this._inAtlasTextureKey[X$m].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},X$p.dispose=function(){this.clear(),this._atlasCanvas.destroy()},X$P(0,X$p,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),X$P(0,X$p,"texture",function(){return this._atlasCanvas}),X$P(0,X$p,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),X$q}(),X$xm=function(X$m){function X$h(){X$h.__super.call(this,X$h.__name2int,X$h.__int2name,X$h.__int2nameMap)}return X$R(X$h,"laya.webgl.shader.d2.ShaderDefines2D",X$C),X$h.__init__=function(){X$h.reg("TEXTURE2D",1),X$h.reg("COLOR2D",2),X$h.reg("PRIMITIVE",4),X$h.reg("GLOW_FILTER",8),X$h.reg("BLUR_FILTER",16),X$h.reg("COLOR_FILTER",32),X$h.reg("COLOR_ADD",64),X$h.reg("WORLDMAT",128),X$h.reg("FILLTEXTURE",256),X$h.reg("FSHIGHPRECISION",1024),X$h.reg("TXTALPHA",2048),X$h.reg("TXTCOMPRESS",4096)},X$h.reg=function(X$m,X$p){X$C._reg(X$m,X$p,X$h.__name2int,X$h.__int2name)},X$h.toText=function(X$m,X$p,X$h){return X$C._toText(X$m,X$p,X$h)},X$h.toInt=function(X$m){return X$C._toInt(X$m,X$h.__name2int)},X$h.TEXTURE2D=1,X$h.COLOR2D=2,X$h.PRIMITIVE=4,X$h.FILTERGLOW=8,X$h.FILTERBLUR=16,X$h.FILTERCOLOR=32,X$h.COLORADD=64,X$h.WORLDMAT=128,X$h.FILLTEXTURE=256,X$h.SKINMESH=512,X$h.SHADERDEFINE_FSHIGHPRECISION=1024,X$h.TXTALPHA=2048,X$h.TXTCOMPRESS=4096,X$h.__name2int={},X$h.__int2name=[],X$h.__int2nameMap=[],X$h}(),X$Qm=(function(X$m){function X$Y(X$m,X$p,X$h,X$P,X$L,X$q,X$k){X$Y.__super.call(this,X$m,X$p,X$h,X$P,40,X$L,X$q,X$k)}X$R(X$Y,"laya.webgl.shapes.Ellipse",X$hm)}(),function(X$m){function X$q(X$m,X$p,X$h,X$P,X$L){this._points=[],this.rebuild(X$h),X$q.__super.call(this,X$m,X$p,0,0,0,X$L,X$P,X$L,0)}X$R(X$q,"laya.webgl.shapes.Line",X$hm);var X$p=X$q.prototype;return X$p.rebuild=function(X$m){var X$p=X$m.length;X$p!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(X$p/2-1)),this.mFloat32Array=new Float32Array(5*X$p)),this._points.length=0;for(var X$h=NaN,X$P=NaN,X$L=-1,X$q=-1,X$k=X$m.length/2,X$Y=0;X$Y<X$k;X$Y++)X$h=X$m[2*X$Y],X$P=X$m[2*X$Y+1],(.01<Math.abs(X$L-X$h)||.01<Math.abs(X$q-X$P))&&this._points.push(X$h,X$P),X$L=X$h,X$q=X$P},X$p.getData=function(X$m,X$p,X$h){var X$P=[],X$L=[];0<this.borderWidth&&this.createLine2(this._points,X$P,this.borderWidth,X$h,X$L,this._points.length/2),this.mUint16Array.set(X$P,0),this.mFloat32Array.set(X$L,0),X$m.append(this.mUint16Array),X$p.append(this.mFloat32Array)},X$q}()),X$Mm=function(X$m){function X$F(X$m,X$p,X$h,X$P,X$L){this._points=[];for(var X$q=NaN,X$k=NaN,X$Y=-1,X$d=-1,X$K=X$h.length/2-1,X$D=0;X$D<X$K;X$D++)X$q=X$h[2*X$D],X$k=X$h[2*X$D+1],(.01<Math.abs(X$Y-X$q)||.01<Math.abs(X$d-X$k))&&this._points.push(X$q,X$k),X$Y=X$q,X$d=X$k;X$q=X$h[2*X$K],X$k=X$h[2*X$K+1],X$Y=this._points[0],X$d=this._points[1],(.01<Math.abs(X$Y-X$q)||.01<Math.abs(X$d-X$k))&&this._points.push(X$q,X$k),X$F.__super.call(this,X$m,X$p,0,0,this._points.length/2,0,X$P,X$L)}X$R(X$F,"laya.webgl.shapes.LoopLine",X$hm);var X$p=X$F.prototype;return X$p.getData=function(X$m,X$p,X$h){if(0<this.borderWidth){for(var X$P=this.color,X$L=(X$P>>16&255)/255,X$q=(X$P>>8&255)/255,X$k=(255&X$P)/255,X$Y=[],X$d=0,X$K=0,X$D=[],X$F=Math.floor(this._points.length/2),X$R=0;X$R<X$F;X$R++)X$d=this._points[2*X$R],X$K=this._points[2*X$R+1],X$Y.push(this.x+X$d,this.y+X$K,X$L,X$q,X$k);this.createLoopLine(X$Y,X$D,this.borderWidth,X$h+X$Y.length/5),X$m.append(new Uint16Array(X$D)),X$p.append(new Float32Array(X$Y))}},X$p.createLoopLine=function(X$m,X$p,X$h,X$P,X$L,X$q){X$m.length;var X$k=X$m.concat(),X$Y=X$L||X$m,X$d=this.borderColor,X$K=(X$d>>16&255)/255,X$D=(X$d>>8&255)/255,X$F=(255&X$d)/255,X$R=[X$k[0],X$k[1]],X$$=[X$k[X$k.length-5],X$k[X$k.length-4]],X$A=X$$[0]+.5*(X$R[0]-X$$[0]),X$B=X$$[1]+.5*(X$R[1]-X$$[1]);X$k.unshift(X$A,X$B,0,0,0),X$k.push(X$A,X$B,0,0,0);var X$n,X$c,X$e,X$a,X$Z,X$H,X$W,X$E,X$I,X$b,X$T,X$j,X$x,X$Q,X$M,X$u,X$N,X$S,X$_,X$l,X$J=X$k.length/5,X$z=X$P,X$w=X$h/2;X$e=X$k[0],X$a=X$k[1],X$b=X$e-(X$Z=X$k[5]),X$I=(X$I=-(X$a-(X$H=X$k[6])))/(X$l=Math.sqrt(X$I*X$I+X$b*X$b))*X$w,X$b=X$b/X$l*X$w,X$Y.push(X$e-X$I,X$a-X$b,X$K,X$D,X$F,X$e+X$I,X$a+X$b,X$K,X$D,X$F);for(var X$X=1;X$X<X$J-1;X$X++)X$e=X$k[5*(X$X-1)],X$a=X$k[5*(X$X-1)+1],X$Z=X$k[5*X$X],X$H=X$k[5*X$X+1],X$W=X$k[5*(X$X+1)],X$E=X$k[5*(X$X+1)+1],X$b=X$e-X$Z,X$j=X$Z-X$W,X$M=(-(X$I=(X$I=-(X$a-X$H))/(X$l=Math.sqrt(X$I*X$I+X$b*X$b))*X$w)+X$e)*(-(X$b=X$b/X$l*X$w)+X$H)-(-X$I+X$Z)*(-X$b+X$a),X$S=(-(X$T=(X$T=-(X$H-X$E))/(X$l=Math.sqrt(X$T*X$T+X$j*X$j))*X$w)+X$W)*(-(X$j=X$j/X$l*X$w)+X$H)-(-X$T+X$Z)*(-X$j+X$E),X$_=(X$x=-X$b+X$a-(-X$b+X$H))*(X$N=-X$T+X$Z-(-X$T+X$W))-(X$u=-X$j+X$E-(-X$j+X$H))*(X$Q=-X$I+X$Z-(-X$I+X$e)),Math.abs(X$_)<.1?(X$_+=10.1,X$Y.push(X$Z-X$I,X$H-X$b,X$K,X$D,X$F,X$Z+X$I,X$H+X$b,X$K,X$D,X$F)):(((X$n=(X$Q*X$S-X$N*X$M)/X$_)-X$Z)*(X$n-X$Z)+((X$c=(X$u*X$M-X$x*X$S)/X$_)-X$H)+(X$c-X$H),X$Y.push(X$n,X$c,X$K,X$D,X$F,X$Z-(X$n-X$Z),X$H-(X$c-X$H),X$K,X$D,X$F));X$q&&(X$p=X$q);var X$s=this.edges+1;for(X$X=1;X$X<X$s;X$X++)X$p.push(X$z+2*(X$X-1),X$z+2*(X$X-1)+1,X$z+2*X$X+1,X$z+2*X$X+1,X$z+2*X$X,X$z+2*(X$X-1));return X$p.push(X$z+2*(X$X-1),X$z+2*(X$X-1)+1,X$z+1,X$z+1,X$z,X$z+2*(X$X-1)),X$Y},X$F}(),X$um=function(X$m){function X$k(X$m,X$p,X$h,X$P,X$L,X$q){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=X$b.create(),this._points=X$h.slice(0,X$h.length),X$k.__super.call(this,X$m,X$p,0,0,this._points.length/2,X$P,X$L,X$q)}X$R(X$k,"laya.webgl.shapes.Polygon",X$hm);var X$p=X$k.prototype;return X$p.rebuild=function(X$m){this._repaint||(this._points.length=0,this._points=this._points.concat(X$m))},X$p.setMatrix=function(X$m){X$m.copyTo(this._mat)},X$p.needUpdate=function(X$m){return this._repaint=this._mat.a==X$m.a&&this._mat.b==X$m.b&&this._mat.c==X$m.c&&this._mat.d==X$m.d&&this._mat.tx==X$m.tx&&this._mat.ty==X$m.ty,!this._repaint},X$p.getData=function(X$m,X$p,X$h){var X$P,X$L=0,X$q=this._points,X$k=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=X$h){for(this._start=X$h,X$P=[],X$k=this.earcutTriangles.length,X$L=0;X$L<X$k;X$L++)X$P.push(this.earcutTriangles[X$L]+X$h);this.mUint16Array=new Uint16Array(X$P)}}else{this._start=X$h,X$P=[];var X$Y=[],X$d=[],X$K=this.color,X$D=(X$K>>16&255)/255,X$F=(X$K>>8&255)/255,X$R=(255&X$K)/255;for(X$k=Math.floor(X$q.length/2),X$L=0;X$L<X$k;X$L++)X$Y.push(this.x+X$q[2*X$L],this.y+X$q[2*X$L+1],X$D,X$F,X$R),X$d.push(this.x+X$q[2*X$L],this.y+X$q[2*X$L+1]);for(this.earcutTriangles=X$Pm.earcut(X$d,null,2),X$k=this.earcutTriangles.length,X$L=0;X$L<X$k;X$L++)X$P.push(this.earcutTriangles[X$L]+X$h);this.mUint16Array=new Uint16Array(X$P),this.mFloat32Array=new Float32Array(X$Y)}X$m.append(this.mUint16Array),X$p.append(this.mFloat32Array)},X$k}(),X$Nm=function(X$m){function X$q(){this._matrix=new X$b,this._matrix4=X$Bm.defaultMatrix4.concat(),X$q.__super.call(this,1e4),this.shaderValue=new X$Im(0,0)}X$R(X$q,"laya.webgl.submit.SubmitCanvas",X$qm);var X$p=X$q.prototype;return X$p.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var X$m=X$em.worldAlpha,X$p=X$em.worldMatrix4,X$h=X$em.worldMatrix,X$P=X$em.worldFilters,X$L=X$em.worldShaderDefines,X$q=this.shaderValue,X$k=this._matrix,X$Y=this._matrix4,X$d=X$b.TEMP;return X$b.mul(X$k,X$h,X$d),X$Y[0]=X$d.a,X$Y[1]=X$d.b,X$Y[4]=X$d.c,X$Y[5]=X$d.d,X$Y[12]=X$d.tx,X$Y[13]=X$d.ty,X$em.worldMatrix=X$d.clone(),X$em.worldMatrix4=X$Y,X$em.worldAlpha=X$em.worldAlpha*X$q.alpha,X$q.filters&&X$q.filters.length&&(X$em.worldFilters=X$q.filters,X$em.worldShaderDefines=X$q.defines),this._ctx_src.flush(),X$em.worldAlpha=X$m,X$em.worldMatrix4=X$p,X$em.worldMatrix.destroy(),X$em.worldMatrix=X$h,X$em.worldFilters=X$P,X$em.worldShaderDefines=X$L,1},X$p.releaseRender=function(){var X$m=X$q._cache;this._ctx_src=null,X$m[X$m._length++]=this},X$p.getRenderType=function(){return 10003},X$q.create=function(X$m,X$p,X$h){var X$P=X$q._cache._length?X$q._cache[--X$q._cache._length]:new X$q;X$P._ctx_src=X$m;var X$L=X$P.shaderValue;return X$L.alpha=X$p,X$L.defines.setValue(0),X$h&&X$h.length&&X$L.setFilters(X$h),X$P},X$q._cache=((X$q._cache=[])._length=0,X$q._cache),X$q}(),X$Sm=function(X$m){function X$K(X$m){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===X$m&&(X$m=1e4),X$K.__super.call(this,X$m)}X$R(X$K,"laya.webgl.submit.SubmitTexture",X$qm);var X$p=X$K.prototype;return X$p.releaseRender=function(){var X$m=X$K._cache;(X$m[X$m._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},X$p.addTexture=function(X$m,X$p){this._texsID[this._texs.length]=X$m._uvID,this._texs.push(X$m),this._vbPos.push(X$p)},X$p.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var X$m=this.shaderValue.textureHost.bitmap;if(null!==X$m)for(var X$p=this._vb.getFloat32Array(),X$h=0,X$P=this._texs.length;X$h<X$P;X$h++){var X$L=this._texs[X$h];X$L.active();var X$q=X$L.uv;if(this._texsID[X$h]!==X$L._uvID){this._texsID[X$h]=X$L._uvID;var X$k=this._vbPos[X$h];X$p[X$k+2]=X$q[0],X$p[X$k+3]=X$q[1],X$p[X$k+6]=X$q[2],X$p[X$k+7]=X$q[3],X$p[X$k+10]=X$q[4],X$p[X$k+11]=X$q[5],X$p[X$k+14]=X$q[6],X$p[X$k+15]=X$q[7],this._vb.setNeedUpload()}X$L.bitmap!==X$m&&(this._isSameTexture=!1)}}},X$p.renderSubmit=function(){if(0===this._numEle)return X$K._shaderSet=!1,1;var X$m=this.shaderValue.textureHost;if(X$m){var X$p=X$m.source;if(!X$m.bitmap||!X$p)return X$K._shaderSet=!1,1;this.shaderValue.texture=X$p,X$m.alphaTexture&&X$m.alphaTexture.source&&(this.shaderValue.texture1=X$m.alphaTexture.source)}this._vb.bind_upload(this._ib);var X$h=X$Zm.mainContext;if(X$U.activeBlendFunction!==this._blendFn&&(X$h.enable(3042),this._blendFn(X$h),X$U.activeBlendFunction=this._blendFn),X$M.drawCall++,X$M.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&X$lm.activeShader&&X$K._shaderSet?(X$lm.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&X$lm.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),X$K._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var X$P=X$m.bitmap,X$L=0,X$q=X$lm.activeShader,X$k=0,X$Y=this._texs.length;X$k<X$Y;X$k++){var X$d=this._texs[X$k];X$d.bitmap===X$P&&X$k+1!==X$Y||(X$q.uploadTexture2D(X$d.source),X$h.drawElements(4,6*(X$k-X$L+1),5123,this._startIdx+6*X$L*X$Bm.BYTES_PIDX),X$P=X$d.bitmap,X$L=X$k)}else X$h.drawElements(4,this._numEle,5123,this._startIdx);return 1},X$K.create=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$K._cache._length?X$K._cache[--X$K._cache._length]:new X$K;null==X$h&&((X$h=X$q._selfVb||(X$q._selfVb=X$Cm.create(-1))).clear(),X$P=0),X$q._ib=X$p,X$q._vb=X$h,X$q._startIdx=X$P*X$Bm.BYTES_PIDX,X$q._numEle=0;var X$k=X$m._nBlendType;X$q._blendFn=X$m._targets?X$U.targetFns[X$k]:X$U.fns[X$k],X$q.shaderValue=X$L,X$q.shaderValue.setValue(X$m._shader2D);var X$Y=X$m._shader2D.filters;return X$Y&&X$q.shaderValue.setFilters(X$Y),X$q},X$K._cache=((X$K._cache=[])._length=0,X$K._cache),X$K._shaderSet=!0,X$K}(),X$_m=function(X$m){function X$c(){X$c.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}X$R(X$c,"laya.webgl.utils.MeshTexture",X$cm);var X$p=X$c.prototype;return X$p.addData=function(X$m,X$p,X$h,X$P,X$L,X$q){for(var X$k=X$m.length/2,X$Y=this._vb.needSize(X$k*X$c.const_stride)>>2,X$d=this._vb.getFloat32Array(),X$K=0,X$D=0;X$D<X$k;X$D++){var X$F=X$m[X$K],X$R=X$m[X$K+1],X$$=X$F*X$P.a+X$R*X$P.c+X$P.tx,X$A=X$F*X$P.b+X$R*X$P.d+X$P.ty;X$d[X$Y++]=X$$,X$d[X$Y++]=X$A,X$d[X$Y++]=X$p[X$K],X$d[X$Y++]=X$p[X$K+1],X$K+=2}this._vb.setNeedUpload();var X$B=this.vertNum;if(0<X$B){(X$k=X$h.length)>X$c.tmpIdx.length&&(X$c.tmpIdx=new Uint16Array(X$k));for(var X$n=0;X$n<X$k;X$n++)X$c.tmpIdx[X$n]=X$h[X$n]+X$B;this._ib.appendU16Array(X$c.tmpIdx,X$h.length)}else this._ib.append(X$h);this._ib.setNeedUpload(),this.vertNum+=X$k,this.indexNum+=X$h.length},X$p.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},X$p.destroy=function(){this._ib.destroy(),this._vb.destroy()},X$c.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new X$c},X$c.const_stride=16,X$c._POOL=[],X$k(X$c,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),X$c}(),X$lm=function(X$m){function X$p(){X$p.__super.call(this),this.lock=!0}return X$R(X$p,"laya.webgl.shader.BaseShader",X$a),X$p.activeShader=null,X$p.bindShader=null,X$p}(),X$Jm=function(X$p){function X$D(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===X$h&&(X$h=6408),void 0===X$P&&(X$P=5121),void 0===X$L&&(X$L=34041),void 0===X$q&&(X$q=!1),void 0===X$k&&(X$k=!1),void 0===X$Y&&(X$Y=-1),void 0===X$d&&(X$d=-1),this._type=1,this._w=X$m,this._h=X$p,this._surfaceFormat=X$h,this._surfaceType=X$P,this._depthStencilFormat=X$L,X$c.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=X$q,this._repeat=X$k,this._minFifter=X$Y,this._magFifter=X$d,this._createWebGLRenderTarget(),this.bitmap.lock=!0,X$D.__super.call(this,this.bitmap,X$_.INV_UV)}X$R(X$D,"laya.webgl.resource.RenderTarget2D",X$p);var X$m=X$D.prototype;return X$W.imps(X$m,{"laya.resource.IDispose":!0}),X$m.getType=function(){return this._type},X$m.getTexture=function(){return this},X$m.size=function(X$m,X$p){this._w==X$m&&this._h==X$p||(this._w=X$m,this._h=X$p,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},X$m.release=function(){this.destroy()},X$m.recycle=function(){X$D.POOL.push(this)},X$m.start=function(){var X$m=X$Zm.mainContext;return this._preRenderTarget=X$em.curRenderTarget,X$em.curRenderTarget=this,X$m.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(X$m.viewport(0,0,this._w,this._h),this._svWidth=X$em.width,this._svHeight=X$em.height,X$em.width=this._w,X$em.height=this._h,X$lm.activeShader=null),this},X$m.clear=function(X$m,X$p,X$h,X$P){void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=1);var X$L=X$Zm.mainContext;X$L.clearColor(X$m,X$p,X$h,X$P);var X$q=16384;switch(this._depthStencilFormat){case 33189:X$q|=256;break;case 36168:X$q|=1024;break;case 34041:X$q|=256,X$q|=1024}X$L.clear(X$q)},X$m.end=function(){var X$m=X$Zm.mainContext;X$m.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,X$em.curRenderTarget=this._preRenderTarget,1==this._type?(X$m.viewport(0,0,this._svWidth,this._svHeight),X$em.width=this._svWidth,X$em.height=this._svHeight,X$lm.activeShader=null):X$m.viewport(0,0,X$W.stage.width,X$W.stage.height)},X$m.getData=function(X$m,X$p,X$h,X$P){var X$L=X$Zm.mainContext;if(X$L.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===X$L.checkFramebufferStatus(36160)))return X$L.bindFramebuffer(36160,null),null;var X$q=new Uint8Array(this._w*this._h*4);return X$L.readPixels(X$m,X$p,X$h,X$P,this._surfaceFormat,this._surfaceType,X$q),X$L.bindFramebuffer(36160,null),X$q},X$m.destroy=function(X$m){void 0===X$m&&(X$m=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,X$p.prototype.destroy.call(this))},X$m.dispose=function(){},X$m._createWebGLRenderTarget=function(){this.bitmap=new X$om(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(X$m){this.event("recovered")})},X$P(0,X$m,"surfaceFormat",function(){return this._surfaceFormat}),X$P(0,X$m,"magFifter",function(){return this._magFifter}),X$P(0,X$m,"surfaceType",function(){return this._surfaceType}),X$P(0,X$m,"mipMap",function(){return this._mipMap}),X$P(0,X$m,"depthStencilFormat",function(){return this._depthStencilFormat}),X$P(0,X$m,"minFifter",function(){return this._minFifter}),X$P(0,X$m,"source",function(){return this._alreadyResolved?X$W.superGet(X$_,this,"source"):null}),X$D.create=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){void 0===X$h&&(X$h=6408),void 0===X$P&&(X$P=5121),void 0===X$L&&(X$L=34041),void 0===X$q&&(X$q=!1),void 0===X$k&&(X$k=!1),void 0===X$Y&&(X$Y=-1),void 0===X$d&&(X$d=-1);var X$K=X$D.POOL.pop();return X$K||(X$K=new X$D(X$m,X$p)),X$K.bitmap&&X$K._w==X$m&&X$K._h==X$p&&X$K._surfaceFormat==X$h&&X$K._surfaceType==X$P&&X$K._depthStencilFormat==X$L&&X$K._mipMap==X$q&&X$K._repeat==X$k&&X$K._minFifter==X$Y&&X$K._magFifter==X$d||(X$K._w=X$m,X$K._h=X$p,X$K._surfaceFormat=X$h,X$K._surfaceType=X$P,X$K._depthStencilFormat=X$L,X$c.isConchWebGL&&34041===X$K._depthStencilFormat&&(X$K._depthStencilFormat=33189),X$K._mipMap=X$q,X$K._repeat=X$k,X$K._minFifter=X$Y,X$K._magFifter=X$d,X$K.release(),X$K._createWebGLRenderTarget()),X$K},X$D.TYPE2D=1,X$D.TYPE3D=2,X$D.POOL=[],X$D}(X$_),X$zm=function(X$m){function X$p(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,X$p.__super.call(this),X$p._gl=X$Zm.mainContext}X$R(X$p,"laya.webgl.utils.Buffer",X$a);var X$h=X$p.prototype;return X$h._bind=function(){this.activeResource(),X$p._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(X$p._bindVertexBuffer=this._glBuffer),X$p._gl.bindBuffer(this._bufferType,X$p._bindActive[this._bufferType]=this._glBuffer),X$lm.activeShader=null)},X$h.recreateResource=function(){this._glBuffer||(this._glBuffer=X$p._gl.createBuffer()),this.completeCreate()},X$h.disposeResource=function(){this._glBuffer&&(X$Zm.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},X$P(0,X$h,"bufferUsage",function(){return this._bufferUsage}),X$p._gl=null,X$p._bindActive={},X$p._bindVertexBuffer=null,X$p._enableAtributes=[],X$p}(),X$wm=function(X$m){function X$h(X$m){this.texcoord=null,this.offsetX=300,this.offsetY=0,X$h.__super.call(this,512,0);var X$p=8*X$Bm.BYTES_PE;this.position=[2,5126,!1,X$p,0],this.texcoord=[2,5126,!1,X$p,2*X$Bm.BYTES_PE],this.color=[4,5126,!1,X$p,4*X$Bm.BYTES_PE]}return X$R(X$h,"laya.webgl.shader.d2.skinAnishader.SkinSV",X$Im),X$h}(),X$Xm=function(X$m){function X$p(X$m){X$p.__super.call(this,2,0),this.color=[]}return X$R(X$p,"laya.webgl.shader.d2.value.Color2dSV",X$Im),X$p.prototype.setValue=function(X$m){X$m.fillStyle&&(this.color=X$m.fillStyle._color._color),X$m.strokeStyle&&(this.color=X$m.strokeStyle._color._color)},X$p}(),X$sm=function(X$m){function X$p(X$m){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=X$Im._TEXCOORD,X$p.__super.call(this,256,0)}X$R(X$p,"laya.webgl.shader.d2.value.FillTextureSV",X$Im);var X$h=X$p.prototype;return X$h.setValue=function(X$m){this.ALPHA=X$m.ALPHA,X$m.filters&&this.setFilters(X$m.filters)},X$h.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},X$p}(),X$Gm=function(X$m){function X$p(X$m){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=X$Im._TEXCOORD,void 0===X$m&&(X$m=0),X$p.__super.call(this,1,X$m)}X$R(X$p,"laya.webgl.shader.d2.value.TextureSV",X$Im);var X$h=X$p.prototype;return X$h.setValue=function(X$m){this.ALPHA=X$m.ALPHA,X$m.filters&&this.setFilters(X$m.filters)},X$h.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},X$p}(),X$Um=function(X$m){function X$p(X$m){this.a_color=null,this.u_pos=[0,0],X$p.__super.call(this,4,0),this.position=[2,5126,!1,5*X$Bm.BYTES_PE,0],this.a_color=[3,5126,!1,5*X$Bm.BYTES_PE,2*X$Bm.BYTES_PE]}return X$R(X$p,"laya.webgl.shader.d2.value.PrimitiveSV",X$Im),X$p}(),X$rm=function(X$m){function X$p(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,X$p.__super.call(this)}X$R(X$p,"laya.webgl.atlas.AtlasWebGLCanvas",X$m);var X$h=X$p.prototype;return X$h.recreateResource=function(){var X$m=X$Zm.mainContext,X$p=this._source=X$m.createTexture(),X$h=X$Hm.curBindTexTarget,X$P=X$Hm.curBindTexValue;X$Hm.bindTexture(X$m,3553,X$p),X$m.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),X$m.texParameteri(3553,10241,9729),X$m.texParameteri(3553,10240,9729),X$m.texParameteri(3553,10242,33071),X$m.texParameteri(3553,10243,33071),X$h&&X$P&&X$Hm.bindTexture(X$m,X$h,X$P),this.memorySize=this._w*this._h*4,this.completeCreate()},X$h.disposeResource=function(){this._source&&(X$Zm.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},X$h.texSubImage2D=function(X$m,X$p,X$h){if(X$c.isFlash){this._flashCacheImage||(this._flashCacheImage=X$B.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var X$P=X$h.bitmapdata;this._flashCacheImage._image.copyPixels(X$P,0,0,X$P.width,X$P.height,X$m,X$p),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var X$L=X$Zm.mainContext,X$q=X$Hm.curBindTexTarget,X$k=X$Hm.curBindTexValue;X$Hm.bindTexture(X$L,3553,this._source),X$L.pixelStorei(37441,!0),0<=X$m-1&&X$L.texSubImage2D(3553,0,X$m-1,X$p,6408,5121,X$h),X$m+1<=this._w&&X$L.texSubImage2D(3553,0,X$m+1,X$p,6408,5121,X$h),0<=X$p-1&&X$L.texSubImage2D(3553,0,X$m,X$p-1,6408,5121,X$h),X$p+1<=this._h&&X$L.texSubImage2D(3553,0,X$m,X$p+1,6408,5121,X$h),X$L.texSubImage2D(3553,0,X$m,X$p,6408,5121,X$h),X$L.pixelStorei(37441,!1),X$q&&X$k&&X$Hm.bindTexture(X$L,X$q,X$k)}},X$h.texSubImage2DPixel=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$Zm.mainContext,X$k=X$Hm.curBindTexTarget,X$Y=X$Hm.curBindTexValue;X$Hm.bindTexture(X$q,3553,this._source);var X$d=new Uint8Array(X$L.data);X$q.pixelStorei(37441,!0),X$q.texSubImage2D(3553,0,X$m,X$p,X$h,X$P,6408,5121,X$d),X$q.pixelStorei(37441,!1),X$k&&X$Y&&X$Hm.bindTexture(X$q,X$k,X$Y)},X$P(0,X$h,"width",X$m.prototype._$get_width,function(X$m){this._w=X$m}),X$P(0,X$h,"height",X$m.prototype._$get_height,function(X$m){this._h=X$m}),X$p}(X$h),X$ym=function(X$m){function X$L(){this.flipY=!0,this.alwaysChange=!1,X$L.__super.call(this)}X$R(X$L,"laya.webgl.resource.WebGLCanvas",X$h);var X$p=X$L.prototype;return X$p.getCanvas=function(){return this._canvas},X$p.clear=function(){this._ctx&&this._ctx.clear()},X$p.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},X$p._setContext=function(X$m){this._ctx=X$m},X$p.getContext=function(X$m,X$p){return this._ctx?this._ctx:this._ctx=X$L._createContext(this)},X$p.size=function(X$m,X$p){this._w==X$m&&this._h==X$p||(this._w=X$m,this._h=X$p,this._ctx&&this._ctx.size(X$m,X$p),this._canvas&&(this._canvas.height=X$p,this._canvas.width=X$m))},X$p.activeResource=function(X$m){void 0===X$m&&(X$m=!1),this._source||this.recreateResource()},X$p.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},X$p.disposeResource=function(){this._source&&!this.iscpuSource&&(X$Zm.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},X$p.createWebGlTexture=function(){var X$m=X$Zm.mainContext;this._canvas;var X$p=this._source=X$m.createTexture();this.iscpuSource=!1;var X$h=X$Hm.curBindTexTarget,X$P=X$Hm.curBindTexValue;X$Hm.bindTexture(X$m,3553,X$p),X$m.pixelStorei(37440,this.flipY?1:0),X$L.premulAlpha&&X$m.pixelStorei(37441,!0),X$m.texImage2D(3553,0,6408,6408,5121,this._imgData),X$L.premulAlpha&&X$m.pixelStorei(37441,!1),X$m.texParameteri(3553,10240,9729),X$m.texParameteri(3553,10241,9729),X$m.texParameteri(3553,10242,33071),X$m.texParameteri(3553,10243,33071),X$m.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,X$h&&X$P&&X$Hm.bindTexture(X$m,X$h,X$P)},X$p.reloadCanvasData=function(){var X$m=X$Zm.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var X$p=X$Hm.curBindTexTarget,X$h=X$Hm.curBindTexValue;X$Hm.bindTexture(X$m,3553,this._source),X$L.premulAlpha&&X$m.pixelStorei(37441,!0),X$m.texImage2D(3553,0,6408,6408,5121,this._imgData),X$L.premulAlpha&&X$m.pixelStorei(37441,!1),X$m.pixelStorei(37440,0),X$p&&X$h&&X$Hm.bindTexture(X$m,X$p,X$h)},X$p.texSubImage2D=function(X$m,X$p,X$h){var X$P=X$Zm.mainContext,X$L=X$Hm.curBindTexTarget,X$q=X$Hm.curBindTexValue;X$Hm.bindTexture(X$P,3553,this._source),X$P.pixelStorei(37441,!0),X$P.texSubImage2D(3553,0,X$p,X$h,6408,5121,X$m._source),X$P.pixelStorei(37441,!1),X$L&&X$q&&X$Hm.bindTexture(X$P,X$L,X$q)},X$p.toBase64=function(X$m,X$p,X$h){var X$P=null;this._canvas&&(X$P=this._canvas.toDataURL(X$m,X$p)),X$h.call(this,X$P)},X$P(0,X$p,"context",function(){return this._ctx}),X$P(0,X$p,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),X$P(0,X$p,"asBitmap",null,function(X$m){this._ctx&&(this._ctx.asBitmap=X$m)}),X$L._createContext=null,X$L.premulAlpha=!1,X$L}(),X$Vm=function(X$m){function X$q(X$m,X$p){this.CborderSize=12,X$q.__super.call(this),this.char=X$m,this.isSpace=" "===X$m,this.xs=X$p.scaleX,this.ys=X$p.scaleY,this.font=X$p.font.toString(),this.fontSize=X$p.font.size,this.fillColor=X$p.fillColor,this.borderColor=X$p.borderColor,this.lineWidth=X$p.lineWidth,this.underLine=X$p.underLine;var X$h,X$P=X$c.isConchApp;X$P?((X$h=ConchTextCanvas)._source=ConchTextCanvas,X$h._source.canvas=ConchTextCanvas):X$h=X$$.canvas.source,this.canvas=X$h,this._enableMerageInAtlas=!0,this._ctx=X$P?X$h:this.canvas.getContext("2d",void 0);var X$L=X$l.measureText(this.char,this.font);this.cw=X$L.width*this.xs,this.ch=(X$L.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new X$_(this)}X$R(X$q,"laya.webgl.resource.WebGLCharImage",X$h);var X$p=X$q.prototype;return X$W.imps(X$p,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),X$p.active=function(){this.texture.active()},X$p.recreateResource=function(){var X$m=X$c.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),X$m){var X$p=this.fontSize;1==this.xs&&1==this.ys||(X$p=parseInt(X$p*(this.xs>this.ys?this.xs:this.ys)+""));var X$h="normal 100 "+this.font;X$h=X$h.replace(X$q._fontSizeReg,X$p),this.borderColor&&(X$h+=" 1 "+this.borderColor),this._ctx.font=X$h,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,X$S.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var X$P=this._ctx.measureText(this.char);X$P||(X$P={width:16});var X$L=X$P.width+1;this._ctx.lineTo(X$L,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},X$p.onresize=function(X$m,X$p){this._w=X$m,this._h=X$p,this._allowMerageInAtlas=!0},X$p.clearAtlasSource=function(){},X$P(0,X$p,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),X$P(0,X$p,"atlasSource",function(){return this.canvas}),X$P(0,X$p,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(X$m){this._enableMerageInAtlas=X$m}),X$q.createOneChar=function(X$m,X$p){return new X$q(X$m,X$p)},X$q._fontSizeReg=new RegExp("\\d+(?=px)","g"),X$q}(),X$om=function(X$m){function X$K(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){void 0===X$h&&(X$h=6408),void 0===X$P&&(X$P=5121),void 0===X$L&&(X$L=34041),void 0===X$q&&(X$q=!1),void 0===X$k&&(X$k=!1),void 0===X$Y&&(X$Y=-1),void 0===X$d&&(X$d=1),X$K.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=X$m,this._h=X$p,this._surfaceFormat=X$h,this._surfaceType=X$P,this._depthStencilFormat=X$L,this._mipMap=X$q,this._repeat=X$k,this._minFifter=X$Y,this._magFifter=X$d}X$R(X$K,"laya.webgl.resource.WebGLRenderTarget",X$h);var X$p=X$K.prototype;return X$p.recreateResource=function(){var X$m=X$Zm.mainContext;this._frameBuffer||(this._frameBuffer=X$m.createFramebuffer()),this._source||(this._source=X$m.createTexture());var X$p=X$Hm.curBindTexTarget,X$h=X$Hm.curBindTexValue;X$Hm.bindTexture(X$m,3553,this._source),X$m.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var X$P=this._minFifter,X$L=this._magFifter,X$q=this._repeat?10497:33071,X$k=X$D.isPOT(this._w,this._h);if(X$k?(this._mipMap?-1!==X$P||(X$P=9987):-1!==X$P||(X$P=9729),-1!==X$L||(X$L=9729),X$m.texParameteri(3553,10241,X$P),X$m.texParameteri(3553,10240,X$L),X$m.texParameteri(3553,10242,X$q),X$m.texParameteri(3553,10243,X$q),this._mipMap&&X$m.generateMipmap(3553)):(-1!==X$P||(X$P=9729),-1!==X$L||(X$L=9729),X$m.texParameteri(3553,10241,X$P),X$m.texParameteri(3553,10240,X$L),X$m.texParameteri(3553,10242,33071),X$m.texParameteri(3553,10243,33071)),X$m.bindFramebuffer(36160,this._frameBuffer),X$m.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=X$m.createRenderbuffer()),X$m.bindRenderbuffer(36161,this._depthStencilBuffer),X$m.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:X$m.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:X$m.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:X$m.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}X$m.bindFramebuffer(36160,null),X$p&&X$h&&X$Hm.bindTexture(X$m,X$p,X$h),X$m.bindRenderbuffer(36161,null),X$k&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},X$p.disposeResource=function(){this._frameBuffer&&(X$Zm.mainContext.deleteTexture(this._source),X$Zm.mainContext.deleteFramebuffer(this._frameBuffer),X$Zm.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null)},X$P(0,X$p,"depthStencilBuffer",function(){return this._depthStencilBuffer}),X$P(0,X$p,"frameBuffer",function(){return this._frameBuffer}),X$K}(),X$fm=function(X$m){function X$Y(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this.offsetX=0,this.offsetY=0,X$Y.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=X$q,this.canvas=X$m,this._ctx=X$m.getContext("2d",void 0),this._w=X$P,this._h=X$L,this.offsetX=X$p,this.offsetY=X$h,this.src=X$k,this._enableMerageInAtlas=!0,X$s.enabled&&this._w<X$s.atlasLimitWidth&&this._h<X$s.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}X$R(X$Y,"laya.webgl.resource.WebGLSubImage",X$h);var X$p=X$Y.prototype;return X$W.imps(X$p,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),X$p.size=function(X$m,X$p){this._w=X$m,this._h=X$p,this._ctx&&this._ctx.size(X$m,X$p),this.canvas&&(this.canvas.height=X$p,this.canvas.width=X$m)},X$p.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},X$p.createWebGlTexture=function(){var X$m=X$Zm.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var X$p=this._source=X$m.createTexture(),X$h=X$Hm.curBindTexTarget,X$P=X$Hm.curBindTexValue;X$Hm.bindTexture(X$m,3553,X$p),X$m.pixelStorei(37441,!0),X$m.texImage2D(3553,0,6408,6408,5121,this.canvas),X$m.pixelStorei(37441,!1);var X$L=this.minFifter,X$q=this.magFifter,X$k=this.repeat?10497:33071,X$Y=X$D.isPOT(this.width,this.height);X$Y?(this.mipmap?-1!==X$L||(X$L=9987):-1!==X$L||(X$L=9729),-1!==X$q||(X$q=9729),X$m.texParameteri(3553,10240,X$q),X$m.texParameteri(3553,10241,X$L),X$m.texParameteri(3553,10242,X$k),X$m.texParameteri(3553,10243,X$k),this.mipmap&&X$m.generateMipmap(3553)):(-1!==X$L||(X$L=9729),-1!==X$q||(X$q=9729),X$m.texParameteri(3553,10241,X$L),X$m.texParameteri(3553,10240,X$q),X$m.texParameteri(3553,10242,33071),X$m.texParameteri(3553,10243,33071)),X$h&&X$P&&X$Hm.bindTexture(X$m,X$h,X$P),this.canvas=null,X$Y&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},X$p.disposeResource=function(){X$s.enabled&&this._allowMerageInAtlas||!this._source||(X$Zm.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},X$p.clearAtlasSource=function(){},X$P(0,X$p,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),X$P(0,X$p,"atlasSource",function(){return this.canvas}),X$P(0,X$p,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(X$m){this._allowMerageInAtlas=X$m}),X$Y}(),X$im=function(X$m){function X$K(X$m,X$p,X$h,X$P){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,X$K.__super.call(this),!X$m||!X$p)throw"Shader Error";this._id=++X$K._count,this._vs=X$m,this._ps=X$p,this._nameMap=X$P||{},null!=X$h&&(X$K.sharders[X$h]=this)}X$R(X$K,"laya.webgl.shader.Shader",X$lm);var X$p=X$K.prototype;return X$p.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},X$p.disposeResource=function(){X$Zm.mainContext.deleteShader(this._vshader),X$Zm.mainContext.deleteShader(this._pshader),X$Zm.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},X$p._compile=function(){if(!X$Zm.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var X$m=[this._vs,this._ps],X$p=X$Zm.mainContext;if(this._program=X$p.createProgram(),this._vshader=X$K._createShader(X$p,X$m[0],35633),this._pshader=X$K._createShader(X$p,X$m[1],35632),X$p.attachShader(this._program,this._vshader),X$p.attachShader(this._program,this._pshader),X$p.linkProgram(this._program),!X$c.isConchApp&&!X$p.getProgramParameter(this._program,35714))throw X$p.getProgramInfoLog(this._program);var X$h,X$P,X$L=0,X$q=0;for(X$q=X$c.isConchApp?X$p.getProgramParameterEx(this._vs,this._ps,"",35721):X$p.getProgramParameter(this._program,35721),X$L=0;X$L<X$q;X$L++){var X$k=null;X$h={vartype:"attribute",glfun:null,ivartype:0,attrib:X$k=X$c.isConchApp?X$p.getActiveAttribEx(this._vs,this._ps,"",X$L):X$p.getActiveAttrib(this._program,X$L),location:X$p.getAttribLocation(this._program,X$k.name),name:X$k.name,type:X$k.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(X$h)}var X$Y=0;for(X$Y=X$c.isConchApp?X$p.getProgramParameterEx(this._vs,this._ps,"",35718):X$p.getProgramParameter(this._program,35718),X$L=0;X$L<X$Y;X$L++){var X$d=null;X$d=X$c.isConchApp?X$p.getActiveUniformEx(this._vs,this._ps,"",X$L):X$p.getActiveUniform(this._program,X$L),0<(X$h={vartype:"uniform",glfun:null,ivartype:1,attrib:X$k,location:X$p.getUniformLocation(this._program,X$d.name),name:X$d.name,type:X$d.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(X$h.name=X$h.name.substr(0,X$h.name.length-3),X$h.isArray=!0,X$h.location=X$p.getUniformLocation(this._program,X$h.name)),this._params.push(X$h)}for(X$L=0,X$P=this._params.length;X$L<X$P;X$L++)if((X$h=this._params[X$L]).indexOfParams=X$L,X$h.index=1,X$h.value=[X$h.location,null],X$h.codename=X$h.name,X$h.name=this._nameMap[X$h.codename]?this._nameMap[X$h.codename]:X$h.codename,(this._paramsMap[X$h.name]=X$h)._this=this,X$h.uploadedValue=[],"attribute"!==X$h.vartype)switch(X$h.type){case 5124:X$h.fun=X$h.isArray?this._uniform1iv:this._uniform1i;break;case 5126:X$h.fun=X$h.isArray?this._uniform1fv:this._uniform1f;break;case 35664:X$h.fun=X$h.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:X$h.fun=X$h.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:X$h.fun=X$h.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:X$h.fun=this._uniform_sampler2D;break;case 35680:X$h.fun=this._uniform_samplerCube;break;case 35676:X$h.glfun=X$p.uniformMatrix4fv,X$h.fun=this._uniformMatrix4fv;break;case 35670:X$h.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else X$h.fun=this._attribute}},X$p.getUniform=function(X$m){return this._paramsMap[X$m]},X$p._attribute=function(X$m,X$p){var X$h=X$Zm.mainContext,X$P=X$zm._enableAtributes,X$L=X$m.location;return X$P[X$L]||X$h.enableVertexAttribArray(X$L),X$h.vertexAttribPointer(X$L,X$p[0],X$p[1],X$p[2],X$p[3],X$p[4]+this._offset),X$P[X$L]=X$zm._bindVertexBuffer,1},X$p._uniform1f=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p?(X$Zm.mainContext.uniform1f(X$m.location,X$h[0]=X$p),1):0},X$p._uniform1fv=function(X$m,X$p){if(X$p.length<4){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]||X$h[2]!==X$p[2]||X$h[3]!==X$p[3]?(X$Zm.mainContext.uniform1fv(X$m.location,X$p),X$h[0]=X$p[0],X$h[1]=X$p[1],X$h[2]=X$p[2],X$h[3]=X$p[3],1):0}return X$Zm.mainContext.uniform1fv(X$m.location,X$p),1},X$p._uniform_vec2=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]?(X$Zm.mainContext.uniform2f(X$m.location,X$h[0]=X$p[0],X$h[1]=X$p[1]),1):0},X$p._uniform_vec2v=function(X$m,X$p){if(X$p.length<2){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]||X$h[2]!==X$p[2]||X$h[3]!==X$p[3]?(X$Zm.mainContext.uniform2fv(X$m.location,X$p),X$h[0]=X$p[0],X$h[1]=X$p[1],X$h[2]=X$p[2],X$h[3]=X$p[3],1):0}return X$Zm.mainContext.uniform2fv(X$m.location,X$p),1},X$p._uniform_vec3=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]||X$h[2]!==X$p[2]?(X$Zm.mainContext.uniform3f(X$m.location,X$h[0]=X$p[0],X$h[1]=X$p[1],X$h[2]=X$p[2]),1):0},X$p._uniform_vec3v=function(X$m,X$p){return X$Zm.mainContext.uniform3fv(X$m.location,X$p),1},X$p._uniform_vec4=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]||X$h[2]!==X$p[2]||X$h[3]!==X$p[3]?(X$Zm.mainContext.uniform4f(X$m.location,X$h[0]=X$p[0],X$h[1]=X$p[1],X$h[2]=X$p[2],X$h[3]=X$p[3]),1):0},X$p._uniform_vec4v=function(X$m,X$p){return X$Zm.mainContext.uniform4fv(X$m.location,X$p),1},X$p._uniformMatrix2fv=function(X$m,X$p){return X$Zm.mainContext.uniformMatrix2fv(X$m.location,!1,X$p),1},X$p._uniformMatrix3fv=function(X$m,X$p){return X$Zm.mainContext.uniformMatrix3fv(X$m.location,!1,X$p),1},X$p._uniformMatrix4fv=function(X$m,X$p){return X$Zm.mainContext.uniformMatrix4fv(X$m.location,!1,X$p),1},X$p._uniform1i=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p?(X$Zm.mainContext.uniform1i(X$m.location,X$h[0]=X$p),1):0},X$p._uniform1iv=function(X$m,X$p){return X$Zm.mainContext.uniform1iv(X$m.location,X$p),1},X$p._uniform_ivec2=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]?(X$Zm.mainContext.uniform2i(X$m.location,X$h[0]=X$p[0],X$h[1]=X$p[1]),1):0},X$p._uniform_ivec2v=function(X$m,X$p){return X$Zm.mainContext.uniform2iv(X$m.location,X$p),1},X$p._uniform_vec3i=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]||X$h[2]!==X$p[2]?(X$Zm.mainContext.uniform3i(X$m.location,X$h[0]=X$p[0],X$h[1]=X$p[1],X$h[2]=X$p[2]),1):0},X$p._uniform_vec3vi=function(X$m,X$p){return X$Zm.mainContext.uniform3iv(X$m.location,X$p),1},X$p._uniform_vec4i=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]||X$h[2]!==X$p[2]||X$h[3]!==X$p[3]?(X$Zm.mainContext.uniform4i(X$m.location,X$h[0]=X$p[0],X$h[1]=X$p[1],X$h[2]=X$p[2],X$h[3]=X$p[3]),1):0},X$p._uniform_vec4vi=function(X$m,X$p){return X$Zm.mainContext.uniform4iv(X$m.location,X$p),1},X$p._uniform_sampler2D=function(X$m,X$p){var X$h=X$Zm.mainContext,X$P=X$m.uploadedValue;return null==X$P[0]?(X$P[0]=this._curActTexIndex,X$h.uniform1i(X$m.location,this._curActTexIndex),X$h.activeTexture(X$K._TEXTURES[this._curActTexIndex]),X$Hm.bindTexture(X$h,3553,X$p),this._curActTexIndex++,1):(X$h.activeTexture(X$K._TEXTURES[X$P[0]]),X$Hm.bindTexture(X$h,3553,X$p),0)},X$p._uniform_samplerCube=function(X$m,X$p){var X$h=X$Zm.mainContext,X$P=X$m.uploadedValue;return null==X$P[0]?(X$P[0]=this._curActTexIndex,X$h.uniform1i(X$m.location,this._curActTexIndex),X$h.activeTexture(X$K._TEXTURES[this._curActTexIndex]),X$Hm.bindTexture(X$h,34067,X$p),this._curActTexIndex++,1):(X$h.activeTexture(X$K._TEXTURES[X$P[0]]),X$Hm.bindTexture(X$h,34067,X$p),0)},X$p._noSetValue=function(X$m){console.log("no....:"+X$m.name)},X$p.uploadOne=function(X$m,X$p){this.activeResource(),X$Hm.UseProgram(this._program);var X$h=this._paramsMap[X$m];X$h.fun.call(this,X$h,X$p)},X$p.uploadTexture2D=function(X$m){X$M.shaderCall++;var X$p=X$Zm.mainContext;X$p.activeTexture(33984),X$Hm.bindTexture(X$p,3553,X$m)},X$p.uploadTexture2D1=function(X$m){X$M.shaderCall++;var X$p=X$Zm.mainContext;X$p.activeTexture(33985),X$Hm.bindTexture(X$p,3553,X$m)},X$p.upload=function(X$m,X$p){X$lm.activeShader=X$lm.bindShader=this,this._lastUseFrameCount===X$M.loopCount||this.activeResource(),X$Hm.UseProgram(this._program),this._reCompile?(X$p=this._params,this._reCompile=!1):X$p=X$p||this._params;X$Zm.mainContext;for(var X$h,X$P,X$L=X$p.length,X$q=0,X$k=0;X$k<X$L;X$k++)null!==(X$P=X$m[(X$h=X$p[X$k]).name])&&(X$q+=X$h.fun.call(this,X$h,X$P));X$M.shaderCall+=X$q},X$p.uploadArray=function(X$m,X$p,X$h){X$lm.activeShader=this,(X$lm.bindShader=this).activeResource(),X$Hm.UseProgram(this._program);this._params;for(var X$P,X$L,X$q=0,X$k=X$p-2;0<=X$k;X$k-=2)(X$L=this._paramsMap[X$m[X$k]])&&null!=(X$P=X$m[X$k+1])&&(X$h&&X$h[X$L.name]&&X$h[X$L.name].bind(),X$q+=X$L.fun.call(this,X$L,X$P));X$M.shaderCall+=X$q},X$p.getParams=function(){return this._params},X$K.getShader=function(X$m){return X$K.sharders[X$m]},X$K.create=function(X$m,X$p,X$h,X$P){return new X$K(X$m,X$p,X$h,X$P)},X$K.withCompile=function(X$m,X$p,X$h,X$P){if(X$h&&X$K.sharders[X$h])return X$K.sharders[X$h];var X$L=X$K._preCompileShader[2e-4*X$m];if(!X$L)throw new Error("withCompile shader err!"+X$m);return X$L.createShader(X$p,X$h,X$P)},X$K.withCompile2D=function(X$m,X$p,X$h,X$P,X$L){if(X$P&&X$K.sharders[X$P])return X$K.sharders[X$P];var X$q=X$K._preCompileShader[2e-4*X$m+X$p];if(!X$q)throw new Error("withCompile shader err!"+X$m+" "+X$p);return X$q.createShader(X$h,X$P,X$L)},X$K.addInclude=function(X$m,X$p){X$am.addInclude(X$m,X$p)},X$K.preCompile=function(X$m,X$p,X$h,X$P){var X$L=2e-4*X$m;X$K._preCompileShader[X$L]=new X$am(X$L,X$p,X$h,X$P)},X$K.preCompile2D=function(X$m,X$p,X$h,X$P,X$L){var X$q=2e-4*X$m+X$p;X$K._preCompileShader[X$q]=new X$am(X$q,X$h,X$P,X$L)},X$K._createShader=function(X$m,X$p,X$h){var X$P=X$m.createShader(X$h);return X$m.shaderSource(X$P,X$p),X$m.compileShader(X$P),X$P},X$K._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],X$K._count=0,X$K._preCompileShader={},X$K.SHADERNAME2ID=2e-4,X$K.sharders=((X$K.sharders=[]).length=32,X$K.sharders),X$k(X$K,["nameKey",function(){return this.nameKey=new X$u}]),X$K}(),X$vm=function(X$m){function X$p(){this._maxsize=0,this._upload=!0,this._uploadSize=0,X$p.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}X$R(X$p,"laya.webgl.utils.Buffer2D",X$m);var X$h=X$p.prototype;return X$h.needSize=function(X$m){var X$p=this._byteLength;if(X$m){var X$h=this._byteLength+X$m;X$h<=this._buffer.byteLength||this._resizeBuffer(X$h<<1,!0),this._byteLength=X$h}return X$p},X$h._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),X$M.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,X$zm._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),X$zm._gl.bufferSubData(this._bufferType,0,this._buffer)},X$h._bufferSubData=function(X$m,X$p,X$h){if(void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),this._maxsize=Math.max(this._maxsize,this._byteLength),X$M.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,X$zm._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),X$p||X$h){var X$P=this._buffer.slice(X$p,X$h);X$zm._gl.bufferSubData(this._bufferType,X$m,X$P)}else X$zm._gl.bufferSubData(this._bufferType,X$m,this._buffer)},X$h._checkArrayUse=function(){},X$h._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},X$h._bind_subUpload=function(X$m,X$p,X$h){return void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(X$m,X$p,X$h),!0)},X$h._resizeBuffer=function(X$m,X$p){if(X$m<this._buffer.byteLength)return this;if(this.memorySize=X$m,X$p&&this._buffer&&0<this._buffer.byteLength){var X$h=new ArrayBuffer(X$m);new Uint8Array(X$h).set(new Uint8Array(this._buffer),0),this._buffer=X$h}else this._buffer=new ArrayBuffer(X$m);return this._checkArrayUse(),this._upload=!0,this},X$h.append=function(X$m){this._upload=!0;var X$p,X$h;X$p=X$m.byteLength,X$m instanceof Uint8Array?(this._resizeBuffer(this._byteLength+X$p,!0),X$h=new Uint8Array(this._buffer,this._byteLength)):X$m instanceof Uint16Array?(this._resizeBuffer(this._byteLength+X$p,!0),X$h=new Uint16Array(this._buffer,this._byteLength)):X$m instanceof Float32Array&&(this._resizeBuffer(this._byteLength+X$p,!0),X$h=new Float32Array(this._buffer,this._byteLength)),X$h.set(X$m,0),this._byteLength+=X$p,this._checkArrayUse()},X$h.appendU16Array=function(X$m,X$p){this._resizeBuffer(this._byteLength+2*X$p,!0);for(var X$h=new Uint16Array(this._buffer,this._byteLength,X$p),X$P=0;X$P<X$p;X$P++)X$h[X$P]=X$m[X$P];this._byteLength+=2*X$p,this._checkArrayUse()},X$h.appendEx=function(X$m,X$p){this._upload=!0;var X$h;X$h=X$m.byteLength,this._resizeBuffer(this._byteLength+X$h,!0),new X$p(this._buffer,this._byteLength).set(X$m,0),this._byteLength+=X$h,this._checkArrayUse()},X$h.appendEx2=function(X$m,X$p,X$h,X$P){void 0===X$P&&(X$P=1),this._upload=!0;var X$L,X$q;X$L=X$h*X$P,this._resizeBuffer(this._byteLength+X$L,!0),X$q=new X$p(this._buffer,this._byteLength);var X$k=0;for(X$k=0;X$k<X$h;X$k++)X$q[X$k]=X$m[X$k];this._byteLength+=X$L,this._checkArrayUse()},X$h.getBuffer=function(){return this._buffer},X$h.setNeedUpload=function(){this._upload=!0},X$h.getNeedUpload=function(){return this._upload},X$h.upload=function(){var X$m=this._bind_upload();return X$zm._gl.bindBuffer(this._bufferType,null),X$zm._bindActive[this._bufferType]=null,X$lm.activeShader=null,X$m},X$h.subUpload=function(X$m,X$p,X$h){void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0);var X$P=this._bind_subUpload();return X$zm._gl.bindBuffer(this._bufferType,null),X$zm._bindActive[this._bufferType]=null,X$lm.activeShader=null,X$P},X$h.disposeResource=function(){X$m.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},X$h.clear=function(){this._byteLength=0,this._upload=!0},X$P(0,X$h,"bufferLength",function(){return this._buffer.byteLength}),X$P(0,X$h,"byteLength",null,function(X$m){this._byteLength!==X$m&&(X$m<=this._buffer.byteLength||this._resizeBuffer(2*X$m+256,!0),this._byteLength=X$m)}),X$p.__int__=function(X$m){X$Om.QuadrangleIB=X$Om.create(35044),X$nm.fillIBQuadrangle(X$Om.QuadrangleIB,16)},X$p.FLOAT32=4,X$p.SHORT=2,X$p}(X$zm),X$gm=(function(X$p){function X$h(X$m){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,X$h.__super.call(this,9)}X$R(X$h,"laya.webgl.shader.d2.value.GlowSV",X$p);var X$m=X$h.prototype;X$m.setValue=function(X$m){X$p.prototype.setValue.call(this,X$m)},X$m.clear=function(){X$p.prototype.clear.call(this)}}(X$Gm),function(X$m){function X$p(X$m){X$p.__super.call(this,64),this.defines.add(64)}X$R(X$p,"laya.webgl.shader.d2.value.TextSV",X$m);var X$h=X$p.prototype;return X$h.release=function(){(X$p.pool[X$p._length++]=this).clear()},X$h.clear=function(){X$m.prototype.clear.call(this)},X$p.create=function(){return X$p._length?X$p.pool[--X$p._length]:new X$p(null)},X$p.pool=[],X$p._length=0,X$p}(X$Gm)),X$tm=function(X$m){function X$L(X$m,X$p,X$h,X$P){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,X$L.__super.call(this,X$m,X$p,X$h,X$P)}X$R(X$L,"laya.webgl.shader.d2.Shader2X",X$m);var X$p=X$L.prototype;return X$p.upload2dQuick1=function(X$m){this.upload(X$m,this._params2dQuick1||this._make2dQuick1())},X$p._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var X$m,X$p=this._params,X$h=0,X$P=X$p.length;X$h<X$P;X$h++)X$m=X$p[X$h],(X$c.isFlash||"size"!==X$m.name&&"position"!==X$m.name&&"texcoord"!==X$m.name)&&this._params2dQuick1.push(X$m)}return this._params2dQuick1},X$p.disposeResource=function(){X$m.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},X$p.upload2dQuick2=function(X$m){this.upload(X$m,this._params2dQuick2||this._make2dQuick2())},X$p._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var X$m,X$p=this._params,X$h=0,X$P=X$p.length;X$h<X$P;X$h++)X$m=X$p[X$h],(X$c.isFlash||"size"!==X$m.name)&&this._params2dQuick2.push(X$m)}return this._params2dQuick2},X$L.create=function(X$m,X$p,X$h,X$P){return new X$L(X$m,X$p,X$h,X$P)},X$L}(X$im),X$Om=function(X$m){function X$p(X$m){this._uint8Array=null,this._uint16Array=null,void 0===X$m&&(X$m=35044),X$p.__super.call(this),this._bufferUsage=X$m,this._bufferType=34963,X$c.isFlash||(this._buffer=new ArrayBuffer(8))}X$R(X$p,"laya.webgl.utils.IndexBuffer2D",X$vm);var X$h=X$p.prototype;return X$h._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},X$h.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},X$h.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},X$h.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},X$p.QuadrangleIB=null,X$p.create=function(X$m){return void 0===X$m&&(X$m=35044),new X$p(X$m)},X$p}(),X$Cm=function(X$m){function X$h(X$m,X$p){this._floatArray32=null,this._vertexStride=0,X$h.__super.call(this),this._vertexStride=X$m,this._bufferUsage=X$p,this._bufferType=34962,X$c.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}X$R(X$h,"laya.webgl.utils.VertexBuffer2D",X$m);var X$p=X$h.prototype;return X$p.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},X$p.bind=function(X$m){X$m&&X$m._bind(),this._bind()},X$p.insertData=function(X$m,X$p){this.getFloat32Array().set(X$m,X$p),this._upload=!0},X$p.bind_upload=function(X$m){X$m._bind_upload()||X$m._bind(),this._bind_upload()||this._bind()},X$p._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},X$p.disposeResource=function(){X$m.prototype.disposeResource.call(this)},X$p.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},X$P(0,X$p,"vertexStride",function(){return this._vertexStride}),X$h.create=function(X$m,X$p){return void 0===X$p&&(X$p=35048),new X$h(X$m,X$p)},X$h}(X$vm),X$mp=function(X$m){function X$Y(X$m,X$p,X$h,X$P,X$L,X$q){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===X$h&&(X$h=6408),void 0===X$P&&(X$P=!0),X$Y.__super.call(this,X$m,X$p),X$m){if(this._format=X$h,this._mipmap=X$P,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof X$m)this._url=X$m,this._src=X$m,this._image=new X$$.window.Image,X$p&&(X$p.onload&&(this.onload=X$p.onload),X$p.onerror&&(this.onerror=X$p.onerror),X$p.onCreate&&X$p.onCreate(this)),this._image.crossOrigin=X$m&&0==X$m.indexOf("data:")?null:"",X$m&&(this._image.src=X$m);else if(X$m instanceof ArrayBuffer){this._src=X$p,this._url=this._src;var X$k=new X$d(X$m);X$k.readUTFBytes(4),X$k.readUTFBytes(2),X$k.getInt16();X$k.endian="bigEndian",this._w=X$k.getInt16(),this._h=X$k.getInt16();X$k.getInt16(),X$k.getInt16();this._image=new Uint8Array(X$m,X$k.pos),this._format=X$Zm.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,X$s.enabled&&this._w<X$s.atlasLimitWidth&&this._h<X$s.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(X$m instanceof Uint8Array))return this._src=X$p,this._url=this._src,this._image=X$m.source||X$m,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=X$p,this._url=this._src,this._w=X$L,this._h=X$q,this._image=X$m,this._format=0===X$h?X$m.byteLength/(X$L*X$q)==4?6408:6407:X$h}this._$5__enableMerageInAtlas=!0}}X$R(X$Y,"laya.webgl.resource.WebGLImage",X$B);var X$p=X$Y.prototype;return X$W.imps(X$p,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),X$p._init_=function(X$m,X$p){},X$p._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var X$m=X$Zm.mainContext,X$p=this._source=X$m.createTexture(),X$h=X$Hm.curBindTexTarget,X$P=X$Hm.curBindTexValue;X$Hm.bindTexture(X$m,3553,X$p);var X$L=this.minFifter,X$q=this.magFifter,X$k=this.repeat?10497:33071,X$Y=X$D.isPOT(this._w,this._h),X$d=!1;switch(X$Y?(this.mipmap?-1!==X$L||(X$L=9987):-1!==X$L||(X$L=9729),-1!==X$q||(X$q=9729),X$m.texParameteri(3553,10241,X$L),X$m.texParameteri(3553,10240,X$q),X$m.texParameteri(3553,10242,X$k),X$m.texParameteri(3553,10243,X$k),this.mipmap&&X$m.generateMipmap(3553)):(-1!==X$L||(X$L=9729),-1!==X$q||(X$q=9729),X$m.texParameteri(3553,10241,X$L),X$m.texParameteri(3553,10240,X$q),X$m.texParameteri(3553,10242,33071),X$m.texParameteri(3553,10243,33071)),X$m.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&X$m.pixelStorei(X$m.UNPACK_ALIGNMENT,1),X$m.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&X$m.pixelStorei(X$m.UNPACK_ALIGNMENT,1),X$m.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:X$d=!0,X$m.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case X$Zm.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:X$d=!0,X$m.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}X$m.pixelStorei(37441,!1),X$h&&X$P&&X$Hm.bindTexture(X$m,X$h,X$P),this.uri||(this.uri=this._url),X$d?this.memorySize=this._image.length:X$Y&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},X$p.recreateResource=function(){var X$m=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var X$p=this;this._image=new X$$.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(X$p._needReleaseAgain)return X$p._needReleaseAgain=!1,X$p._image.onload=null,void(X$p._image=null);X$p._allowMerageInAtlas&&X$p._enableMerageInAtlas?(X$m.memorySize=0,X$m._recreateLock=!1):X$p._createWebGlTexture(),X$p.completeCreate()},this._image.src=this._src}},X$p.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&X$Zm.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},X$p.onresize=function(){this._w=this._image.width,this._h=this._image.height,X$s.enabled&&this._w<X$s.atlasLimitWidth&&this._h<X$s.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},X$p.clearAtlasSource=function(){this._image=null},X$P(0,X$p,"format",function(){return this._format}),X$P(0,X$p,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(X$m){this._$5__enableMerageInAtlas=X$m}),X$P(0,X$p,"mipmap",function(){return this._mipmap}),X$P(0,X$p,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),X$P(0,X$p,"atlasSource",function(){return this._image}),X$P(0,X$p,"onload",null,function(X$m){var X$p=this;this._onload=X$m,this._image&&(this._image.onload=null!=this._onload?function(){X$p.onresize(),X$p._onload()}:null)}),X$P(0,X$p,"onerror",null,function(X$m){var X$p=this;this._onerror=X$m,this._image&&(this._image.onerror=null!=this._onerror?function(){X$p._onerror()}:null)}),X$Y}();X$W.__init([X$$m,X$X,X$Em,X$am])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(X$m,X$p){"use strict";for(var X$h in Object.defineProperty(X$p,"__esModule",{value:!0}),Laya){var X$P=Laya[X$h];X$P&&X$P.__isclass&&(X$p[X$h]=X$P)}}),function(X$q,X$m,X$P){X$P.un,X$P.uns;var X$L=X$P.static,X$k=X$P.class,X$Y=X$P.getset,X$d=(X$P.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),X$A=laya.utils.ClassUtils,X$F=(laya.events.Event,laya.utils.HTMLChar),X$K=laya.net.Loader,X$D=(laya.display.Node,laya.maths.Rectangle),X$R=laya.renders.Render,X$$=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),X$B=laya.utils.Stat,X$l=laya.display.Text,X$n=laya.resource.Texture,X$c=laya.net.URL,X$e=laya.utils.Utils,X$a=function(){function X$$(){}return X$k(X$$,"laya.html.utils.HTMLParse"),X$$.parse=function(X$m,X$p,X$h){X$p=(X$p="<root>"+(X$p=X$p.replace(/<br>/g,"<br/>"))+"</root>").replace(X$$.spacePattern,X$$.char255);var X$P=X$e.parseXMLFromString(X$p);X$$._parseXML(X$m,X$P.childNodes[0].childNodes,X$h)},X$$._parseXML=function(X$m,X$p,X$h,X$P){var X$L=0,X$q=0;if(X$p.join||X$p.item)for(X$L=0,X$q=X$p.length;X$L<X$q;++X$L)X$$._parseXML(X$m,X$p[X$L],X$h,X$P);else{var X$k,X$Y,X$d;if(3==X$p.nodeType)return void(X$m instanceof laya.html.dom.HTMLDivElement?(null==X$p.nodeName&&(X$p.nodeName="#text"),X$Y=X$p.nodeName.toLowerCase(),0<(X$d=X$p.textContent.replace(/^\s+|\s+$/g,"")).length&&(X$k=X$A.getInstance(X$Y))&&(X$m.addChild(X$k),X$k.innerTEXT=X$d.replace(X$$.char255AndOneSpacePattern," "))):0<(X$d=X$p.textContent.replace(/^\s+|\s+$/g,"")).length&&(X$m.innerTEXT=X$d.replace(X$$.char255AndOneSpacePattern," ")));if("#comment"==(X$Y=X$p.nodeName.toLowerCase()))return;if(X$k=X$A.getInstance(X$Y)){(X$k=X$m.addChild(X$k)).URI=X$h,X$k.href=X$P;var X$K=X$p.attributes;if(X$K&&0<X$K.length)for(X$L=0,X$q=X$K.length;X$L<X$q;++X$L){var X$D=X$K[X$L],X$F=X$D.nodeName,X$R=X$D.value;X$k._setAttributes(X$F,X$R)}X$$._parseXML(X$k,X$p.childNodes,X$h,X$k.href)}else X$$._parseXML(X$m,X$p.childNodes,X$h,X$P)}},X$$.char255=String.fromCharCode(255),X$$.spacePattern=/&nbsp;|&#160;/g,X$$.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),X$$}(),X$Z=function(){function X$_(){}return X$k(X$_,"laya.html.utils.Layout"),X$_.later=function(X$m){null==X$_._will&&(X$_._will=[],X$P.stage.frameLoop(1,null,function(){if(!(X$_._will.length<1)){for(var X$m=0;X$m<X$_._will.length;X$m++)laya.html.utils.Layout.layout(X$_._will[X$m]);X$_._will.length=0}})),X$_._will.push(X$m)},X$_.layout=function(X$m){if(!X$m||!X$m._style)return null;if(0==(512&X$m._style._type))return null;X$m.getStyle()._type&=-513;var X$p=X$_._multiLineLayout(X$m);return X$R.isConchApp&&X$m.layaoutCallNative&&X$m.layaoutCallNative(),X$p},X$_._multiLineLayout=function(X$m){if(X$l.RightToLeft)return X$_._multiLineLayout2(X$m);var X$p=new Array;X$m._addChildsToLayout(X$p);var X$h,X$P,X$L,X$q,X$k,X$Y=0,X$d=X$p.length,X$K=X$m._getCSSStyle(),X$D=X$K.letterSpacing,X$F=X$K.leading,X$R=X$K.lineHeight,X$$=X$K._widthAuto()||!X$K.wordWrap,X$A=X$$?999999:X$m.width,X$B=(X$m.height,0),X$n=X$K.italic?X$K.fontSize/3:0,X$c=X$K._getAlign(),X$e=X$K._getValign(),X$a=0!==X$e||0!==X$c||0!=X$R,X$Z=0,X$H=0,X$W=0,X$E=0,X$I=new Array,X$b=X$I[0]=new X$J,X$T=!1,X$j=!1;X$b.h=0,X$K.italic&&(X$A-=X$K.fontSize/3);var X$x=0,X$Q=!0;function X$M(){X$b.y=X$H,X$H+=X$b.h+X$F,0==X$b.h&&(X$H+=X$R),X$b.mWidth=X$x,X$x=0,X$b=new X$J,X$I.push(X$b),X$b.h=0,X$T=!(X$Q=!(X$Z=0))}for(X$Y=0;X$Y<X$d;X$Y++)if(null!=(X$h=X$p[X$Y]))if(X$Q=!1,X$h instanceof laya.html.dom.HTMLBrElement)X$M(),X$b.y=X$H;else{if(X$h._isChar()){if((X$q=X$h).isWord)X$T=X$j||"\n"===X$q.char,X$b.wordStartIndex=X$b.elements.length;else{if(X$W=X$q.width+X$q.style.letterSpacin,0<X$I.length&&X$A<X$Z+X$W&&0<X$b.wordStartIndex){var X$u;X$u=X$b.elements.length-X$b.wordStartIndex+1,X$b.elements.length=X$b.wordStartIndex,X$Y-=X$u,X$M();continue}X$T=!1,X$x+=X$q.width}X$W=X$q.width+X$D,X$E=X$q.height,X$j=!1,(X$T=X$T||X$A<X$Z+X$W)&&X$M(),X$b.minTextHeight=Math.min(X$b.minTextHeight,X$h.height)}else X$P=X$h._getCSSStyle(),X$k=X$h,X$L=X$P.padding,0===X$P._getCssFloat()||(X$a=!0),X$T=X$j||X$P.lineElement,X$W=X$k.width*X$k._style._tf.scaleX+X$L[1]+X$L[3]+X$D,X$E=X$k.height*X$k._style._tf.scaleY+X$L[0]+X$L[2],X$j=X$P.lineElement,(X$T=X$T||X$A<X$Z+X$W&&X$P.wordWrap)&&X$M();X$b.elements.push(X$h),X$b.h=Math.max(X$b.h,X$E),X$h.x=X$Z,X$h.y=X$H,X$Z+=X$W,X$b.w=X$Z-X$D,X$b.y=X$H,X$B=Math.max(X$Z+X$n,X$B)}else X$Q||(X$Z+=X$_.DIV_ELEMENT_PADDING),X$b.wordStartIndex=X$b.elements.length;if(X$H=X$b.y+X$b.h,X$a){var X$N=0,X$S=X$A;for(X$$&&0<X$m.width&&(X$S=X$m.width),X$Y=0,X$d=X$I.length;X$Y<X$d;X$Y++)X$I[X$Y].updatePos(0,X$S,X$Y,X$N,X$c,X$e,X$R),X$N+=Math.max(X$R,X$I[X$Y].h+X$F);X$H=X$N}return X$$&&(X$m.width=X$B),X$H>X$m.height&&(X$m.height=X$H),[X$B,X$H]},X$_._multiLineLayout2=function(X$m){var X$p=new Array;X$m._addChildsToLayout(X$p);var X$h,X$P,X$L,X$q,X$k,X$Y=0,X$d=X$p.length,X$K=X$m._getCSSStyle(),X$D=X$K.letterSpacing,X$F=X$K.leading,X$R=X$K.lineHeight,X$$=X$K._widthAuto()||!X$K.wordWrap,X$A=X$$?999999:X$m.width,X$B=(X$m.height,0),X$n=X$K.italic?X$K.fontSize/3:0,X$c=2-X$K._getAlign(),X$e=X$K._getValign(),X$a=0!==X$e||0!=X$c||0!=X$R,X$Z=0,X$H=0,X$W=0,X$E=0,X$I=new Array,X$b=X$I[0]=new X$J,X$T=!1,X$j=!1;X$b.h=0,X$K.italic&&(X$A-=X$K.fontSize/3);var X$x=0,X$Q=!0;function X$M(){X$b.y=X$H,X$H+=X$b.h+X$F,0==X$b.h&&(X$H+=X$R),X$b.mWidth=X$x,X$x=0,X$b=new X$J,X$I.push(X$b),X$b.h=0,X$T=!(X$Q=!(X$Z=0))}for(X$Y=0;X$Y<X$d;X$Y++)if(null!=(X$h=X$p[X$Y]))if(X$Q=!1,X$h instanceof laya.html.dom.HTMLBrElement)X$M(),X$b.y=X$H;else{if(X$h._isChar()){if((X$q=X$h).isWord)X$T=X$j||"\n"===X$q.char,X$b.wordStartIndex=X$b.elements.length;else{if(0<X$I.length&&X$A<X$Z+X$W&&0<X$b.wordStartIndex){var X$u;X$u=X$b.elements.length-X$b.wordStartIndex+1,X$b.elements.length=X$b.wordStartIndex,X$Y-=X$u,X$M();continue}X$T=!1,X$x+=X$q.width}X$W=X$q.width+X$D,X$E=X$q.height,X$j=!1,(X$T=X$T||X$A<X$Z+X$W)&&X$M(),X$b.minTextHeight=Math.min(X$b.minTextHeight,X$h.height)}else X$P=X$h._getCSSStyle(),X$k=X$h,X$L=X$P.padding,0===X$P._getCssFloat()||(X$a=!0),X$T=X$j||X$P.lineElement,X$W=X$k.width*X$k._style._tf.scaleX+X$L[1]+X$L[3]+X$D,X$E=X$k.height*X$k._style._tf.scaleY+X$L[0]+X$L[2],X$j=X$P.lineElement,(X$T=X$T||X$A<X$Z+X$W&&X$P.wordWrap)&&X$M();X$b.elements.push(X$h),X$b.h=Math.max(X$b.h,X$E),X$h.x=X$Z,X$h.y=X$H,X$Z+=X$W,X$b.w=X$Z-X$D,X$b.y=X$H,X$B=Math.max(X$Z+X$n,X$B)}else X$Q||(X$Z+=X$_.DIV_ELEMENT_PADDING),X$b.wordStartIndex=X$b.elements.length;if(X$H=X$b.y+X$b.h,X$a){var X$N=0,X$S=X$A;for(X$Y=0,X$d=X$I.length;X$Y<X$d;X$Y++)X$I[X$Y].updatePos(0,X$S,X$Y,X$N,X$c,X$e,X$R),X$N+=Math.max(X$R,X$I[X$Y].h+X$F);X$H=X$N}for(X$$&&(X$m.width=X$B),X$H>X$m.height&&(X$m.height=X$H),X$Y=0,X$d=X$I.length;X$Y<X$d;X$Y++)X$I[X$Y].revertOrder(X$A);return[X$B,X$H]},X$_._will=null,X$_.DIV_ELEMENT_PADDING=0,X$_}(),X$J=function(){function X$m(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}X$k(X$m,"laya.html.utils.LayoutLine");var X$p=X$m.prototype;return X$p.updatePos=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){var X$Y,X$d=0;0<this.elements.length&&(X$d=(X$Y=this.elements[this.elements.length-1]).x+X$Y.width-this.elements[0].x);var X$K=0,X$D=NaN;1===X$L&&(X$K=(X$p-X$d)/2),2===X$L&&(X$K=X$p-X$d),0===X$k||0!=X$q||(X$q=1);for(var X$F=0,X$R=this.elements.length;X$F<X$R;X$F++){var X$$=(X$Y=this.elements[X$F])._getCSSStyle();switch(0!==X$K&&(X$Y.x+=X$K),X$$._getValign()){case 0:X$Y.y=X$P;break;case 1:var X$A=0;99999!=this.minTextHeight&&(X$A=this.minTextHeight);var X$B=(X$A+X$k)/2;X$B=Math.max(X$B,this.h),X$D=(laya.html.dom.HTMLImageElement,X$P+X$B-X$Y.height),X$Y.y=X$D;break;case 2:X$Y.y=X$P+(X$k-X$Y.height)}}},X$p.revertOrder=function(X$m){var X$p;if(0<this.elements.length){var X$h,X$P=0;for(X$h=this.elements.length,X$P=0;X$P<X$h;X$P++)(X$p=this.elements[X$P]).x=X$m-X$p.x-X$p.width}},X$m}(),X$H=function(X$h){function X$p(){this.URI=null,this._href=null,X$p.__super.call(this),this._text=X$p._EMPTYTEXT,this.setStyle(new X$d(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}X$k(X$p,"laya.html.dom.HTMLElement",X$h);var X$m=X$p.prototype;return X$m.layaoutCallNative=function(){var X$m=0;if(this._childs&&0<(X$m=this._childs.length))for(var X$p=0;X$p<X$m;X$p++)this._childs[X$p].layaoutCallNative&&this._childs[X$p].layaoutCallNative();var X$h=this._getWords();X$h?laya.html.dom.HTMLElement.fillWords(this,X$h,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},X$m.appendChild=function(X$m){return this.addChild(X$m)},X$m._getWords2=function(){var X$m=this._text.text;if(!X$m||0===X$m.length)return null;var X$p,X$h,X$P=0,X$L=0;if(this._text.drawWords)X$h=this._text.drawWords;else{for(X$L=(X$p=X$m.split(" ")).length-1,X$h=[],X$P=0;X$P<X$L;X$P++)X$h.push(X$p[X$P]," ");0<=X$L&&X$h.push(X$p[X$L]),this._text.drawWords=X$h}var X$q,X$k=this._text.words;if(X$k&&X$k.length===X$h.length)return X$k;null===X$k&&(this._text.words=X$k=[]),X$k.length=X$h.length;var X$Y=this.style,X$d=X$Y.font;for(X$P=0,X$L=X$h.length;X$P<X$L;X$P++){X$q=X$e.measureText(X$h[X$P],X$d);var X$K=X$k[X$P]=new X$F(X$h[X$P],X$q.width,X$q.height||X$Y.fontSize,X$Y);if(1<X$K.char.length&&(X$K.charNum=X$K.char),this.href){var X$D=new X$$;this.addChild(X$D),X$K.setSprite(X$D)}}return X$k},X$m._getWords=function(){if(!X$l.CharacterCache)return this._getWords2();var X$m=this._text.text;if(!X$m||0===X$m.length)return null;var X$p,X$h=this._text.words;if(X$h&&X$h.length===X$m.length)return X$h;null===X$h&&(this._text.words=X$h=[]),X$h.length=X$m.length;for(var X$P=this.style,X$L=X$P.font,X$q=0,X$k=X$m.length;X$q<X$k;X$q++)if(X$p=X$e.measureText(X$m.charAt(X$q),X$L)){var X$Y=X$h[X$q]=new X$F(X$m.charAt(X$q),X$p.width,X$p.height||X$P.fontSize,X$P);if(this.href){var X$d=new X$$;this.addChild(X$d),X$Y.setSprite(X$d)}}else console.warn("_getWords size is null"+X$m.charAt(X$q),X$L);return X$h},X$m.showLinkSprite=function(){var X$m=this._text.words;if(X$m)for(var X$p,X$h,X$P=[],X$L=0;X$L<X$m.length;X$L++)X$h=X$m[X$L],(X$p=new X$$).graphics.drawRect(0,0,X$h.width,X$h.height,"#ff0000"),X$p.width=X$h.width,X$p.height=X$h.height,this.addChild(X$p),X$P.push(X$p)},X$m._layoutLater=function(){var X$m=this.style;512&X$m._type||(X$m.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&X$m.block?(X$Z.later(this),X$m._type|=512):this.parent&&this.parent._layoutLater())},X$m._setAttributes=function(X$m,X$p){switch(X$m){case"style":return void this.style.cssText(X$p);case"class":return void(this.className=X$p)}X$h.prototype._setAttributes.call(this,X$m,X$p)},X$m.updateHref=function(){if(null!=this._href){var X$m=this._getWords();if(X$m)for(var X$p,X$h,X$P=0;X$P<X$m.length;X$P++)(X$h=(X$p=X$m[X$P]).getSprite())&&(X$h.size(X$p.width,X$p.height),X$h.on("click",this,this.onLinkHandler))}},X$m.onLinkHandler=function(X$m){switch(X$m.type){case"click":for(var X$p=this;X$p;)X$p.event("link",[this.href]),X$p=X$p.parent}},X$m.formatURL=function(X$m){return this.URI?X$c.formatURL(X$m,this.URI?this.URI.path:null):X$m},X$Y(0,X$m,"href",function(){return this._href},function(X$m){null!=(this._href=X$m)&&(this._getCSSStyle().underLine=1,this.updateHref())}),X$Y(0,X$m,"color",null,function(X$m){this.style.color=X$m}),X$Y(0,X$m,"onClick",null,function(X$m){X$P._runScript("fn=function(event){"+X$m+";}"),this.on("click",this,void 0)}),X$Y(0,X$m,"id",null,function(X$m){X$W.document.setElementById(X$m,this)}),X$Y(0,X$m,"innerTEXT",function(){return this._text.text},function(X$m){this.text=X$m}),X$Y(0,X$m,"style",function(){return this._style}),X$Y(0,X$m,"text",function(){return this._text.text},function(X$m){this._text==X$p._EMPTYTEXT?this._text={text:X$m,words:null}:(this._text.text=X$m,this._text.words&&(this._text.words.length=0)),X$R.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),X$Y(0,X$m,"parent",X$h.prototype._$get_parent,function(X$m){if(X$m instanceof laya.html.dom.HTMLElement){var X$p=X$m;this.URI||(this.URI=X$p.URI),this.style.inherit(X$p.style)}X$P.superSet(X$$,this,"parent",X$m)}),X$Y(0,X$m,"className",null,function(X$m){this.style.attrs(X$W.document.styleSheets["."+X$m])}),X$p.fillWords=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){X$m.graphics.clear();for(var X$Y=0,X$d=X$p.length;X$Y<X$d;X$Y++){var X$K=X$p[X$Y];X$m.graphics.fillText(X$K.char,X$K.x+X$h,X$K.y+X$P,X$L,X$q,"left",X$k)}},X$p._EMPTYTEXT={text:null,words:null},X$p}(X$$),X$p=(function(X$m){function X$p(){X$p.__super.call(this),this.style.lineElement=!0,this.style.block=!0}X$k(X$p,"laya.html.dom.HTMLBrElement",X$H)}(),function(X$m){function X$p(){this.contextHeight=NaN,this.contextWidth=NaN,X$p.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}X$k(X$p,"laya.html.dom.HTMLDivElement",X$m);var X$h=X$p.prototype;return X$h.appendHTML=function(X$m){X$a.parse(this,X$m,this.URI),this.layout()},X$h._addChildsToLayout=function(X$p){var X$m=this._getWords();if(null==X$m&&0==this._childs.length)return!1;X$m&&X$m.forEach(function(X$m){X$p.push(X$m)});for(var X$h=!0,X$P=0,X$L=this._childs.length;X$P<X$L;X$P++){var X$q=this._childs[X$P];X$h?X$h=!1:X$p.push(null),X$q._addToLayout(X$p)}return!0},X$h._addToLayout=function(X$m){this.layout()},X$h.layout=function(){if(this.style){this.style._type|=512;var X$m=X$Z.layout(this);if(X$m){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new X$D);var X$p=this._$P.mHtmlBounds;X$p.x=X$p.y=0,X$p.width=this.contextWidth=X$m[0],X$p.height=this.contextHeight=X$m[1],this.setBounds(X$p)}}},X$Y(0,X$h,"height",function(){return this._height?this._height:this.contextHeight},X$m.prototype._$set_height),X$Y(0,X$h,"innerHTML",null,function(X$m){this.destroyChildren(),this.appendHTML(X$m)}),X$Y(0,X$h,"width",function(){return this._width?this._width:this.contextWidth},function(X$m){var X$p=!1;X$p=0===X$m?X$m!=this._width:X$m!=this.width,X$P.superSet(X$H,this,"width",X$m),X$p&&this.layout()}),X$p}(X$H)),X$W=function(X$m){function X$p(){this.all=new Array,this.styleSheets=X$d.styleSheets,X$p.__super.call(this)}X$k(X$p,"laya.html.dom.HTMLDocument",X$H);var X$h=X$p.prototype;return X$h.getElementById=function(X$m){return this.all[X$m]},X$h.setElementById=function(X$m,X$p){this.all[X$m]=X$p},X$L(X$p,["document",function(){return this.document=new X$p}]),X$p}();(function(X$m){function X$p(){this._tex=null,this._url=null,this._renderArgs=[],X$p.__super.call(this),this.style.block=!0}X$k(X$p,"laya.html.dom.HTMLImageElement",X$H);var X$h=X$p.prototype;X$h._addToLayout=function(X$m){!this._style.absolute&&X$m.push(this)},X$h.render=function(X$m,X$p,X$h){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(X$B.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,X$m.ctx.drawTexture2(X$p,X$h,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},X$h.layaoutCallNative=function(){var X$m=0;if(this._childs&&0<(X$m=this._childs.length))for(var X$p=0;X$p<X$m;X$p++)this._childs[X$p].layaoutCallNative&&this._childs[X$p].layaoutCallNative()},X$Y(0,X$h,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(X$m){this._width!==X$m&&(this._width=X$m,this._style.width=X$m,this.repaint())}),X$Y(0,X$h,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(X$m){this._height!==X$m&&(this._height=X$m,this._style.height=X$m,this.repaint())}),X$h.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),X$K.clearCache(this,this._url),this._tex=null),X$H.prototype.destroy.call(this)},X$h.onloaded=function(){var X$m=this._style;X$m&&!X$m.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),X$m&&!X$m.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),X$R.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},X$h._loadImageComplete=function(X$m,X$p,X$h){if(!this._destroyed)if(null!=X$h)if(X$h instanceof ArrayBuffer){var X$P=new DataView(X$h);new laya.webgl.resource.WebGLImage(new Uint8Array(X$h,8),X$m,0,!1,X$P.getUint32(0),X$P.getUint32(4));this.onloaded()}else if(X$h instanceof X$n)X$K.imgMgrSet[X$m]=X$p,X$q.imgMgrLock(X$m,X$K.imgMgrSet[X$m]),this._url=X$m,this._tex=X$h,X$K.keepCache(this,X$m),X$K.cacheRes(X$m,this._tex),this.onloaded();else{var X$L=-1!=X$m.indexOf(".png",X$m.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(X$h,X$m,X$L,!1,X$h.width,X$h.height);this.onloaded()}else this.event("error","Load image failed")},X$Y(0,X$h,"src",null,function(X$m){(X$m=this.formatURL(X$m),this._url!=X$m)&&(null!=this._tex&&(X$K.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=X$m,(this._tex=X$K.getRes(X$m))?(X$K.keepCache(this,X$m),this.onloaded()):X$q.imgMgrLoad(X$m,this._loadImageComplete.bind(this),2,!1))})})(),function(X$m){function X$p(){this.type=null,X$p.__super.call(this),this.visible=!1}X$k(X$p,"laya.html.dom.HTMLLinkElement",X$m);var X$h=X$p.prototype;X$h._onload=function(X$m){switch(this.type){case"text/css":X$d.parseCSS(X$m,this.URI)}},X$Y(0,X$h,"href",X$m.prototype._$get_href,function(X$m){var X$p=this;X$m=this.formatURL(X$m),this.URI=new X$c(X$m);var X$h=new X$K;X$h.once("complete",null,function(X$m){X$p._onload(X$m)}),X$h.load(X$m,"text")}),X$p._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(X$H),function(X$m){function X$p(){X$p.__super.call(this),this.visible=!1}X$k(X$p,"laya.html.dom.HTMLStyleElement",X$m),X$Y(0,X$p.prototype,"text",X$m.prototype._$get_text,function(X$m){X$d.parseCSS(X$m,null)})}(X$H),function(X$m){function X$p(){X$p.__super.call(this),this._getCSSStyle().valign="middle"}X$k(X$p,"laya.html.dom.HTMLIframeElement",X$m),X$Y(0,X$p.prototype,"href",X$m.prototype._$get_href,function(X$h){var X$P=this;X$h=this.formatURL(X$h);var X$m=new X$K;X$m.once("complete",null,function(X$m){var X$p=X$P.URI;X$P.URI=new X$c(X$h),X$P.innerHTML=X$m,!X$p||(X$P.URI=X$p)}),X$m.load(X$h,"text")})}(X$p)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(X$m,X$p){"use strict";for(var X$h in Object.defineProperty(X$p,"__esModule",{value:!0}),Laya){var X$P=Laya[X$h];X$P&&X$P.__isclass&&(X$p[X$h]=X$P)}}),function(X$L,X$m,X$B){X$B.un,X$B.uns;var X$P=X$B.static,X$q=X$B.class,X$k=X$B.getset,X$h=(X$B.__newvec,laya.display.Animation),X$n=(laya.utils.Browser,laya.utils.ClassUtils),X$Y=laya.filters.ColorFilter,X$d=laya.utils.Ease,X$K=laya.events.Event,X$D=(laya.events.EventDispatcher,laya.display.css.Font),X$F=laya.display.FrameAnimation,X$p=laya.display.Graphics,X$R=laya.utils.Handler,X$$=laya.display.Input,X$e=laya.net.Loader,X$A=(laya.display.Node,laya.maths.Point),X$c=laya.maths.Rectangle,X$a=laya.renders.Render,X$Z=laya.display.Sprite,X$H=laya.display.Text,X$W=laya.resource.Texture,X$E=laya.utils.Tween,X$I=laya.utils.Utils,X$b=laya.utils.WeakObject;X$B.interface("laya.ui.IItem"),X$B.interface("laya.ui.ISelect"),X$B.interface("laya.ui.IRender"),X$B.interface("laya.ui.IComponent"),X$B.interface("laya.ui.IBox","IComponent");var X$T=function(){function X$m(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return X$q(X$m,"laya.ui.LayoutStyle"),X$P(X$m,["EMPTY",function(){return this.EMPTY=new X$m}]),X$m}(),X$j=function(){function X$m(){}return X$q(X$m,"laya.ui.Styles"),X$m.labelColor="#000000",X$m.buttonStateNum=3,X$m.scrollBarMinNum=15,X$m.scrollBarDelayTime=500,X$P(X$m,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),X$m}(),X$x=function(){function X$L(){}return X$q(X$L,"laya.ui.UIUtils"),X$L.fillArray=function(X$m,X$p,X$h){var X$P=X$m.concat();if(X$p)for(var X$L=X$p.split(","),X$q=0,X$k=Math.min(X$P.length,X$L.length);X$q<X$k;X$q++){var X$Y=X$L[X$q];X$P[X$q]="true"==X$Y||"false"!=X$Y&&X$Y,null!=X$h&&(X$P[X$q]=X$h(X$Y))}return X$P},X$L.toColor=function(X$m){return X$I.toHexColor(X$m)},X$L.gray=function(X$m,X$p){void 0===X$p&&(X$p=!0),X$p?X$L.addFilter(X$m,X$L.grayFilter):X$L.clearFilter(X$m,X$Y)},X$L.addFilter=function(X$m,X$p){var X$h=X$m.filters||[];X$h.push(X$p),X$m.filters=X$h},X$L.clearFilter=function(X$m,X$p){var X$h=X$m.filters;if(null!=X$h&&0<X$h.length){for(var X$P=X$h.length-1;-1<X$P;X$P--){var X$L=X$h[X$P];X$B.__typeof(X$L,X$p)&&X$h.splice(X$P,1)}X$m.filters=X$h}},X$L._getReplaceStr=function(X$m){return X$L.escapeSequence[X$m]},X$L.adptString=function(X$m){return X$m.replace(/\\(\w)/g,X$L._getReplaceStr)},X$L.getBindFun=function(X$m){var X$p=X$L._funMap.get(X$m);if(null==X$p){var X$h='"'+X$m+'"',X$P="(function(data){if(data==null)return;with(data){try{\nreturn "+(X$h=X$h.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";X$p=X$B._runScript(X$P),X$L._funMap.set(X$m,X$p)}return X$p},X$P(X$L,["grayFilter",function(){return this.grayFilter=new X$Y([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new X$b}]),X$L}(),X$Q=function(){function X$m(){}return X$q(X$m,"UIConfig"),X$m.touchScrollEnable=!0,X$m.mouseWheelEnable=!0,X$m.showButtons=!0,X$m.popupBgColor="#000000",X$m.popupBgAlpha=.5,X$m.closeDialogOnSide=!0,X$m}(),X$M=function(X$h){function X$c(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,X$c.__super.call(this),this._weakKeys=[]}X$q(X$c,"laya.ui.AutoBitmap",X$h);var X$m=X$c.prototype;return X$m.destroy=function(){if(X$e.clearObject(this,this._weakKey),this._weakKeys){for(var X$m=0,X$p=this._weakKeys.length;X$m<X$p;++X$m)X$e.clearObject(this,this._weakKeys[X$m]);this._weakKeys=null}X$h.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},X$m._setChanged=function(){this._isChanged||(this._isChanged=!0,X$B.timer.callLater(this,this.changeSource))},X$m.changeSource=function(){this._isChanged=!1;var X$m=this._source;if(X$m&&X$m.bitmap){var X$p=this.width,X$h=this.height,X$P=this._sizeGrid,X$L=X$m.sourceWidth,X$q=X$m.sourceHeight;if(!X$P||X$L===X$p&&X$q===X$h)this.cleanByTexture(X$m,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,X$p,X$h);else{X$e.clearObject(this,this._weakKey),X$m.$_GID||(X$m.$_GID=X$I.getGID());var X$k=X$m.$_GID+"."+X$p+"."+X$h+"."+X$P.join("."),X$Y=X$e.findObject(X$k);if(X$I.isOKCmdList(X$Y))return this._weakKey=X$k,X$e.keepObject(this,this._weakKey),void(this.cmds=X$Y);this.clear();var X$d,X$K,X$D=X$P[0],X$F=X$P[1],X$R=X$P[2],X$$=X$P[3],X$A=X$P[4],X$B=!1;if(X$p==X$L&&(X$$=X$F=0),X$h==X$q&&(X$D=X$R=0),X$p<X$$+X$F){var X$n=X$p;X$B=!0,X$p=X$$+X$F,this.save(),this.clipRect(0,0,X$n,X$h)}X$$&&X$D&&(X$d=X$c.getTexture(X$m,0,0,X$$,X$D),X$K=this._weakKeys[0],X$d?(X$K!=X$d.weakKey&&(X$e.clearObject(this,X$K),X$e.keepObject(this,X$d.weakKey),this._weakKeys[0]=X$d.weakKey),this.drawTexture(X$d,0,0,X$$,X$D)):(X$e.clearObject(this,X$K),this._weakKeys[0]="")),X$F&&X$D&&(X$d=X$c.getTexture(X$m,X$L-X$F,0,X$F,X$D),X$K=this._weakKeys[1],X$d?(X$K!=X$d.weakKey&&(X$e.clearObject(this,X$K),X$e.keepObject(this,X$d.weakKey),this._weakKeys[1]=X$d.weakKey),this.drawTexture(X$d,X$p-X$F,0,X$F,X$D)):(X$e.clearObject(this,X$K),this._weakKeys[1]="")),X$$&&X$R&&(X$d=X$c.getTexture(X$m,0,X$q-X$R,X$$,X$R),X$K=this._weakKeys[2],X$d?(X$K!=X$d.weakKey&&(X$e.clearObject(this,X$K),X$e.keepObject(this,X$d.weakKey),this._weakKeys[2]=X$d.weakKey),this.drawTexture(X$d,0,X$h-X$R,X$$,X$R)):(X$e.clearObject(this,X$K),this._weakKeys[2]="")),X$F&&X$R&&(X$d=X$c.getTexture(X$m,X$L-X$F,X$q-X$R,X$F,X$R),X$K=this._weakKeys[3],X$d?(X$K!=X$d.weakKey&&(X$e.clearObject(this,X$K),X$e.keepObject(this,X$d.weakKey),this._weakKeys[3]=X$d.weakKey),this.drawTexture(X$d,X$p-X$F,X$h-X$R,X$F,X$R)):(X$e.clearObject(this,X$K),this._weakKeys[3]="")),X$D&&(X$d=X$c.getTexture(X$m,X$$,0,X$L-X$$-X$F,X$D),X$K=this._weakKeys[4],X$d?(X$K!=X$d.weakKey&&(X$e.clearObject(this,X$K),X$e.keepObject(this,X$d.weakKey),this._weakKeys[4]=X$d.weakKey),this.drawBitmap(X$A,X$d,X$$,0,X$p-X$$-X$F,X$D)):(X$e.clearObject(this,X$K),this._weakKeys[4]="")),X$R&&(X$d=X$c.getTexture(X$m,X$$,X$q-X$R,X$L-X$$-X$F,X$R),X$K=this._weakKeys[5],X$d?(X$K!=X$d.weakKey&&(X$e.clearObject(this,X$K),X$e.keepObject(this,X$d.weakKey),this._weakKeys[5]=X$d.weakKey),this.drawBitmap(X$A,X$d,X$$,X$h-X$R,X$p-X$$-X$F,X$R)):(X$e.clearObject(this,X$K),this._weakKeys[5]="")),X$$&&(X$d=X$c.getTexture(X$m,0,X$D,X$$,X$q-X$D-X$R),X$K=this._weakKeys[6],X$d?(X$K!=X$d.weakKey&&(X$e.clearObject(this,X$K),X$e.keepObject(this,X$d.weakKey),this._weakKeys[6]=X$d.weakKey),this.drawBitmap(X$A,X$d,0,X$D,X$$,X$h-X$D-X$R)):(X$e.clearObject(this,X$K),this._weakKeys[6]="")),X$F&&(X$d=X$c.getTexture(X$m,X$L-X$F,X$D,X$F,X$q-X$D-X$R),X$K=this._weakKeys[7],X$d?(X$K!=X$d.weakKey&&(X$e.clearObject(this,X$K),X$e.keepObject(this,X$d.weakKey),this._weakKeys[7]=X$d.weakKey),this.drawBitmap(X$A,X$d,X$p-X$F,X$D,X$F,X$h-X$D-X$R)):(X$e.clearObject(this,X$K),this._weakKeys[7]="")),X$d=X$c.getTexture(X$m,X$$,X$D,X$L-X$$-X$F,X$q-X$D-X$R),X$K=this._weakKeys[8],X$d?(X$K!=X$d.weakKey&&(X$e.clearObject(this,X$K),X$e.keepObject(this,X$d.weakKey),this._weakKeys[8]=X$d.weakKey),this.drawBitmap(X$A,X$d,X$$,X$D,X$p-X$$-X$F,X$h-X$D-X$R)):(X$e.clearObject(this,X$K),this._weakKeys[8]=""),X$B&&this.restore(),this.autoCacheCmd&&!X$a.isConchApp&&(X$e.saveObject(X$k,this.cmds,null),this._weakKey=X$k,X$e.keepObject(this,this._weakKey))}this._repaint()}},X$m.drawBitmap=function(X$m,X$p,X$h,X$P,X$L,X$q){void 0===X$L&&(X$L=0),void 0===X$q&&(X$q=0),X$L<.1||X$q<.1||(!X$m||X$p.width==X$L&&X$p.height==X$q?this.drawTexture(X$p,X$h,X$P,X$L,X$q):this.fillTexture(X$p,X$h,X$P,X$L,X$q))},X$m.clear=function(X$m){void 0===X$m&&(X$m=!0),X$h.prototype.clear.call(this,!1)},X$k(0,X$m,"sizeGrid",function(){return this._sizeGrid},function(X$m){this._sizeGrid=X$m,this._setChanged()}),X$k(0,X$m,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(X$m){this._width!=X$m&&(this._width=X$m,this._setChanged())}),X$k(0,X$m,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(X$m){this._height!=X$m&&(this._height=X$m,this._setChanged())}),X$k(0,X$m,"source",function(){return this._source},function(X$m){X$m?(this._source=X$m,this._setChanged()):(this._source=null,this.clear())}),X$c.getTexture=function(X$m,X$p,X$h,X$P,X$L){X$P<=0&&(X$P=1),X$L<=0&&(X$L=1),X$m.$_GID||(X$m.$_GID=X$I.getGID());var X$q=X$m.$_GID+"."+X$p+"."+X$h+"."+X$P+"."+X$L,X$k=X$e.findObject(X$q);if((!X$k||!X$k.source)&&(X$k=X$W.createFromTexture(X$m,X$p,X$h,X$P,X$L))){if(X$m.alphaTexture){var X$Y=X$m.width/X$m.alphaTexture.width;X$k.alphaTexture=X$W.createFromTexture(X$m.alphaTexture,X$p/X$Y,X$h/X$Y,X$P/X$Y,X$L/X$Y)}X$e.saveObject(X$q,X$k),X$k.weakKey=X$q}return X$k},X$c}(X$p),X$u=(function(X$m){function X$p(){X$p.__super.call(this)}X$q(X$p,"laya.ui.UIEvent",X$K),X$p.SHOW_TIP="showtip",X$p.HIDE_TIP="hidetip"}(),function(X$p){function X$m(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,X$m.__super.call(this),this._layout=X$T.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}X$q(X$m,"laya.ui.Component",X$p);var X$h=X$m.prototype;return X$B.imps(X$h,{"laya.ui.IComponent":!0}),X$h.destroy=function(X$m){void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,X$m),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},X$h.preinitialize=function(){},X$h.createChildren=function(){},X$h.initialize=function(){},X$h.callLater=function(X$m,X$p){X$B.timer.callLater(this,X$m,X$p)},X$h.runCallLater=function(X$m){X$B.timer.runCallLater(this,X$m)},X$h.commitMeasure=function(){},X$h.changeSize=function(){this.event("resize")},X$h.getLayout=function(){return this._layout===X$T.EMPTY&&(this._layout=new X$T),this._layout},X$h._setLayoutEnabled=function(X$m){this._layout&&this._layout.enable!=X$m&&(this._layout.enable=X$m,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},X$h.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},X$h.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},X$h.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},X$h.resetLayoutX=function(){var X$m=this._layout;if(isNaN(X$m.anchorX)||(this.pivotX=X$m.anchorX*this.width),this.layoutEnabled){var X$p=this.parent;X$p&&(isNaN(X$m.centerX)?isNaN(X$m.left)?isNaN(X$m.right)||(this.x=Math.round(X$p.width-this.displayWidth-X$m.right+this.pivotX*this.scaleX)):(this.x=Math.round(X$m.left+this.pivotX*this.scaleX),isNaN(X$m.right)||(this.width=(X$p._width-X$m.left-X$m.right)/(this.scaleX||.01))):this.x=Math.round(.5*(X$p.width-this.displayWidth)+X$m.centerX+this.pivotX*this.scaleX))}},X$h.resetLayoutY=function(){var X$m=this._layout;if(isNaN(X$m.anchorY)||(this.pivotY=X$m.anchorY*this.height),this.layoutEnabled){var X$p=this.parent;X$p&&(isNaN(X$m.centerY)?isNaN(X$m.top)?isNaN(X$m.bottom)||(this.y=Math.round(X$p.height-this.displayHeight-X$m.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(X$m.top+this.pivotY*this.scaleY),isNaN(X$m.bottom)||(this.height=(X$p._height-X$m.top-X$m.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(X$p.height-this.displayHeight)+X$m.centerY+this.pivotY*this.scaleY))}},X$h.onMouseOver=function(X$m){X$B.stage.event("showtip",this._toolTip)},X$h.onMouseOut=function(X$m){X$B.stage.event("hidetip",this._toolTip)},X$k(0,X$h,"displayWidth",function(){return this.width*this.scaleX}),X$k(0,X$h,"width",function(){return this._width?this._width:this.measureWidth},function(X$m){this._width!=X$m&&(this._width=X$m,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),X$k(0,X$h,"measureWidth",function(){var X$m=0;this.commitMeasure();for(var X$p=this.numChildren-1;-1<X$p;X$p--){var X$h=this.getChildAt(X$p);X$h.visible&&(X$m=Math.max(X$h.x+X$h.width*X$h.scaleX,X$m))}return X$m}),X$k(0,X$h,"displayHeight",function(){return this.height*this.scaleY}),X$k(0,X$h,"height",function(){return this._height?this._height:this.measureHeight},function(X$m){this._height!=X$m&&(this._height=X$m,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),X$k(0,X$h,"dataSource",function(){return this._dataSource},function(X$m){for(var X$p in this._dataSource=X$m,this._dataSource)this.hasOwnProperty(X$p)&&"function"!=typeof this[X$p]&&(this[X$p]=this._dataSource[X$p])}),X$k(0,X$h,"scaleY",X$p.prototype._$get_scaleY,function(X$m){X$B.superGet(X$Z,this,"scaleY")!=X$m&&(X$B.superSet(X$Z,this,"scaleY",X$m),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),X$k(0,X$h,"measureHeight",function(){var X$m=0;this.commitMeasure();for(var X$p=this.numChildren-1;-1<X$p;X$p--){var X$h=this.getChildAt(X$p);X$h.visible&&(X$m=Math.max(X$h.y+X$h.height*X$h.scaleY,X$m))}return X$m}),X$k(0,X$h,"scaleX",X$p.prototype._$get_scaleX,function(X$m){X$B.superGet(X$Z,this,"scaleX")!=X$m&&(X$B.superSet(X$Z,this,"scaleX",X$m),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),X$k(0,X$h,"top",function(){return this._layout.top},function(X$m){X$m!=this._layout.top&&(this.getLayout().top=X$m,this._setLayoutEnabled(!0)),this.resetLayoutY()}),X$k(0,X$h,"bottom",function(){return this._layout.bottom},function(X$m){X$m!=this._layout.bottom&&(this.getLayout().bottom=X$m,this._setLayoutEnabled(!0)),this.resetLayoutY()}),X$k(0,X$h,"left",function(){return this._layout.left},function(X$m){X$m!=this._layout.left&&(this.getLayout().left=X$m,this._setLayoutEnabled(!0)),this.resetLayoutX()}),X$k(0,X$h,"right",function(){return this._layout.right},function(X$m){X$m!=this._layout.right&&(this.getLayout().right=X$m,this._setLayoutEnabled(!0)),this.resetLayoutX()}),X$k(0,X$h,"centerX",function(){return this._layout.centerX},function(X$m){X$m!=this._layout.centerX&&(this.getLayout().centerX=X$m,this._setLayoutEnabled(!0)),this.resetLayoutX()}),X$k(0,X$h,"centerY",function(){return this._layout.centerY},function(X$m){X$m!=this._layout.centerY&&(this.getLayout().centerY=X$m,this._setLayoutEnabled(!0)),this.resetLayoutY()}),X$k(0,X$h,"anchorX",function(){return this._layout.anchorX},function(X$m){X$m!=this._layout.anchorX&&(this.getLayout().anchorX=X$m,this._setLayoutEnabled(!0)),this.resetLayoutX()}),X$k(0,X$h,"anchorY",function(){return this._layout.anchorY},function(X$m){X$m!=this._layout.anchorY&&(this.getLayout().anchorY=X$m,this._setLayoutEnabled(!0)),this.resetLayoutY()}),X$k(0,X$h,"tag",function(){return this._tag},function(X$m){this._tag=X$m}),X$k(0,X$h,"toolTip",function(){return this._toolTip},function(X$m){this._toolTip!=X$m&&(null!=(this._toolTip=X$m)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),X$k(0,X$h,"comXml",function(){return this._comXml},function(X$m){this._comXml=X$m}),X$k(0,X$h,"gray",function(){return this._gray},function(X$m){X$m!==this._gray&&(this._gray=X$m,X$x.gray(this,X$m))}),X$k(0,X$h,"disabled",function(){return this._disabled},function(X$m){X$m!==this._disabled&&(this.gray=this._disabled=X$m,this.mouseEnabled=!X$m)}),X$m}(X$Z)),X$N=function(X$m){function X$p(){this.lockLayer=null,this.popupEffect=function(X$m){X$m.scale(1,1),X$E.from(X$m,{x:X$B.stage.width/2,y:X$B.stage.height/2,scaleX:0,scaleY:0},300,X$d.backOut,X$R.create(this,this.doOpen,[X$m]))},this.closeEffect=function(X$m,X$p){X$E.to(X$m,{x:X$B.stage.width/2,y:X$B.stage.height/2,scaleX:0,scaleY:0},300,X$d.strongOut,X$R.create(this,this.doClose,[X$m,X$p]))},X$p.__super.call(this),this.maskLayer=new X$Z,this.popupEffectHandler=X$R.create(this,this.popupEffect,null,!1),this.closeEffectHandler=X$R.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,X$B.stage.addChild(this),X$B.stage.on("resize",this,this._onResize),X$Q.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}X$q(X$p,"laya.ui.DialogManager",X$Z);var X$h=X$p.prototype;return X$h._closeOnSide=function(){var X$m=this.getChildAt(this.numChildren-1);X$m instanceof laya.ui.Dialog&&X$m.close("side")},X$h.setLockView=function(X$m){this.lockLayer||(this.lockLayer=new X$S,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(X$B.stage.width,X$B.stage.height)),this.lockLayer.removeChildren(),X$m&&(X$m.centerX=X$m.centerY=0,this.lockLayer.addChild(X$m))},X$h._onResize=function(X$m){var X$p=this.maskLayer.width=X$B.stage.width,X$h=this.maskLayer.height=X$B.stage.height;this.lockLayer&&this.lockLayer.size(X$p,X$h),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,X$p,X$h,X$Q.popupBgColor),this.maskLayer.alpha=X$Q.popupBgAlpha;for(var X$P=this.numChildren-1;-1<X$P;X$P--){var X$L=this.getChildAt(X$P);X$L.popupCenter&&this._centerDialog(X$L)}},X$h._centerDialog=function(X$m){X$m.x=Math.round((X$B.stage.width-X$m.width>>1)+X$m.pivotX),X$m.y=Math.round((X$B.stage.height-X$m.height>>1)+X$m.pivotY)},X$h.open=function(X$m,X$p,X$h){void 0===X$p&&(X$p=!1),void 0===X$h&&(X$h=!1),X$p&&this._closeAll(),X$m.popupCenter&&this._centerDialog(X$m),this.addChild(X$m),(X$m.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),X$h&&null!=X$m.popupEffect?X$m.popupEffect.runWith(X$m):this.doOpen(X$m),this.event("open")},X$h.doOpen=function(X$m){X$m.onOpened()},X$h.lock=function(X$m){this.lockLayer&&(X$m?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},X$h.close=function(X$m,X$p,X$h){void 0===X$h&&(X$h=!1),X$h&&null!=X$m.closeEffect?X$m.closeEffect.runWith([X$m,X$p]):this.doClose(X$m,X$p),this.event("close")},X$h.doClose=function(X$m,X$p){X$m.removeSelf(),X$m.isModal&&this._checkMask(),X$m.closeHandler&&X$m.closeHandler.runWith(X$p),X$m.onClosed(X$p)},X$h.closeAll=function(){this._closeAll(),this.event("close")},X$h._closeAll=function(){for(var X$m=this.numChildren-1;-1<X$m;X$m--){var X$p=this.getChildAt(X$m);X$p&&null!=X$p.close&&this.doClose(X$p)}},X$h.getDialogsByGroup=function(X$m){for(var X$p=[],X$h=this.numChildren-1;-1<X$h;X$h--){var X$P=this.getChildAt(X$h);X$P&&X$P.group===X$m&&X$p.push(X$P)}return X$p},X$h.closeByGroup=function(X$m){for(var X$p=[],X$h=this.numChildren-1;-1<X$h;X$h--){var X$P=this.getChildAt(X$h);X$P&&X$P.group===X$m&&(X$P.close(),X$p.push(X$P))}return X$p},X$h._checkMask=function(){this.maskLayer.removeSelf();for(var X$m=this.numChildren-1;-1<X$m;X$m--){var X$p=this.getChildAt(X$m);if(X$p&&X$p.isModal)return void this.addChildAt(this.maskLayer,X$m)}},X$p}(),X$S=function(X$m){function X$p(){X$p.__super.call(this)}X$q(X$p,"laya.ui.Box",X$m);var X$h=X$p.prototype;return X$B.imps(X$h,{"laya.ui.IBox":!0}),X$k(0,X$h,"dataSource",X$m.prototype._$get_dataSource,function(X$m){for(var X$p in this._dataSource=X$m){var X$h=this.getChildByName(X$p);X$h?X$h.dataSource=X$m[X$p]:this.hasOwnProperty(X$p)&&"function"!=typeof this[X$p]&&(this[X$p]=X$m[X$p])}}),X$p}(X$u),X$_=function(X$p){function X$h(X$m,X$p){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,X$h.__super.call(this),this._labelColors=X$j.buttonLabelColors,this._stateNum=X$j.buttonStateNum,void 0===X$p&&(X$p=""),this.skin=X$m,this.label=X$p}X$q(X$h,"laya.ui.Button",X$p);var X$m=X$h.prototype;return X$B.imps(X$m,{"laya.ui.ISelect":!0}),X$m.destroy=function(X$m){this.clearEvent(),X$e.clearCache(this,this._skin),X$e.clearObject(this,this._weakKey),void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,X$m),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(X$m),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},X$m.clearEvent=function(){this._skin&&X$L.atalsNotify&&X$L.atalsNotify.off(this._skin,this,this._setBtnSource)},X$m.createChildren=function(){this.graphics=this._bitmap=new X$M},X$m.createText=function(){this._text||(this._text=new X$H,this._text.overflow=X$H.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},X$m.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},X$m.onMouse=function(X$m){if(!1!==this.toggle||!this._selected)return"click"===X$m.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=X$h.stateMap[X$m.type]))},X$m.changeClips=function(){var X$m=X$e.getRes(this._skin);if(X$m)if(this._skin&&""!=this._skin){X$e.clearObject(this,this._weakKey);var X$p=X$m.sourceWidth,X$h=X$m.sourceHeight/this._stateNum;X$m.$_GID||(X$m.$_GID=X$I.getGID());var X$P=X$m.$_GID+"-"+this._stateNum,X$L=X$e.findObject(X$P);if(X$I.isOkTextureList(X$L)||(X$L=null),X$L)this._weakKey=X$P,X$e.keepObject(this,this._weakKey),this._sources=X$L;else{if(this._sources=[],1===this._stateNum)this._sources.push(X$m);else for(var X$q=0;X$q<this._stateNum;X$q++){var X$k=X$W.createFromTexture(X$m,0,X$h*X$q,X$p,X$h);if(X$m.alphaTexture){var X$Y=X$m.width/X$m.alphaTexture.width;X$k.alphaTexture=X$W.createFromTexture(X$m.alphaTexture,0/X$Y,X$h*X$q/X$Y,X$p/X$Y,X$h/X$Y)}this._sources.push(X$k)}X$e.saveObject(X$P,this._sources),this._weakKey=X$P,X$e.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||X$p,this._bitmap.height=this._height||X$h,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=X$p)}else console.warn("lose skin ",this._skin,this.name,this.__className)},X$m.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var X$m=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[X$m]),this.label&&(this._text.color=this._labelColors[X$m],this._strokeColors&&(this._text.strokeColor=this._strokeColors[X$m]))},X$m._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},X$k(0,X$m,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(X$m){this.createText(),this._text.strokeColor=X$m}),X$k(0,X$m,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),X$k(0,X$m,"skin",function(){return this._skin},function(X$m){if(this._skin!=X$m)if(this.clearEvent(),X$e.clearCache(this,this._skin),this._skin=X$m,X$e.keepCache(this,this._skin),X$e.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var X$p=X$L.resAtalsObj&&X$L.resAtalsObj[this._skin];X$p?(X$L.atalsNotify&&X$L.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=X$p.sourceW),0==this.height&&(this.height=X$p.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),X$m._setBtnSource=function(X$m,X$p){X$m===this._skin&&X$p&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},X$k(0,X$m,"state",function(){return this._state},function(X$m){this._state!=X$m&&(this._state=X$m,this._setStateChanged())}),X$k(0,X$m,"text",function(){return this.createText(),this._text}),X$k(0,X$m,"stateNum",function(){return this._stateNum},function(X$m){"string"==typeof X$m&&(X$m=parseInt(X$m)),this._stateNum!=X$m&&(this._stateNum=X$m<1?1:3<X$m?3:X$m,this.callLater(this.changeClips))}),X$k(0,X$m,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(X$m){this._strokeColors=X$x.fillArray(X$j.buttonLabelColors,X$m,String),this._setStateChanged()}),X$k(0,X$m,"labelColors",function(){return this._labelColors.join(",")},function(X$m){this._labelColors=X$x.fillArray(X$j.buttonLabelColors,X$m,String),this._setStateChanged()}),X$k(0,X$m,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),X$k(0,X$m,"label",function(){return this._text?this._text.text:null},function(X$m){(this._text||X$m)&&(this.createText(),this._text.text!=X$m&&(X$m&&!this._text.parent&&this.addChild(this._text),this._text.text=(X$m+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),X$k(0,X$m,"selected",function(){return this._selected},function(X$m){this._selected!=X$m&&(this._selected=X$m,this.state=this._selected?2:0,this.event("change"))}),X$k(0,X$m,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(X$m){this.createText(),this._text.padding=X$x.fillArray(X$j.labelPadding,X$m,Number)}),X$k(0,X$m,"labelSize",function(){return this.createText(),this._text.fontSize},function(X$m){this.createText(),this._text.fontSize=X$m}),X$k(0,X$m,"labelStroke",function(){return this.createText(),this._text.stroke},function(X$m){this.createText(),this._text.stroke=X$m}),X$k(0,X$m,"labelBold",function(){return this.createText(),this._text.bold},function(X$m){this.createText(),this._text.bold=X$m}),X$k(0,X$m,"labelFont",function(){return this.createText(),this._text.font},function(X$m){this.createText(),this._text.font=X$m}),X$k(0,X$m,"labelAlign",function(){return this.createText(),this._text.align},function(X$m){this.createText(),this._text.align=X$m}),X$k(0,X$m,"clickHandler",function(){return this._clickHandler},function(X$m){this._clickHandler=X$m}),X$k(0,X$m,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(X$m){this._bitmap.sizeGrid=X$x.fillArray(X$j.defaultSizeGrid,X$m,Number)}),X$k(0,X$m,"width",X$p.prototype._$get_width,function(X$m){X$B.superSet(X$u,this,"width",X$m),this._autoSize&&(this._bitmap.width=X$m,this._text&&(this._text.width=X$m))}),X$k(0,X$m,"height",X$p.prototype._$get_height,function(X$m){X$B.superSet(X$u,this,"height",X$m),this._autoSize&&(this._bitmap.height=X$m,this._text&&(this._text.height=X$m))}),X$k(0,X$m,"dataSource",X$p.prototype._$get_dataSource,function(X$m){"number"==typeof(this._dataSource=X$m)||"string"==typeof X$m?this.label=X$m+"":X$B.superSet(X$u,this,"dataSource",X$m)}),X$k(0,X$m,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(X$m){this._bitmap._offset=X$m?X$x.fillArray([1,1],X$m,Number):[]}),X$P(X$h,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),X$h}(X$u),X$l=function(X$p){function X$P(X$m,X$p,X$h){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,X$P.__super.call(this),void 0===X$p&&(X$p=1),void 0===X$h&&(X$h=1),this._clipX=X$p,this._clipY=X$h,this.skin=X$m}X$q(X$P,"laya.ui.Clip",X$p);var X$m=X$P.prototype;return X$m.destroy=function(X$m){this.clearEvent(),this.clearLoad(),X$e.clearCache(this,this._skin),X$e.clearObject(this,this._weakKey),void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},X$m.dispose=function(){this.destroy(!0),X$B.loader.clearRes(this._skin)},X$m.createChildren=function(){this.graphics=this._bitmap=new X$M},X$m._onDisplay=function(X$m){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},X$m.changeClip=function(){if(this._clipChanged=!1,this._skin){var X$m=X$e.getRes(this._skin);if(X$m)this.loadComplete(this._skin,X$m);else{if(X$L.resAtalsObj&&X$L.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=X$R.create(this,this.loadComplete,[this._skin]),this._progress=null,X$B.loader.load(this._skin,this._complete,this._progress)}}},X$m.loadComplete=function(X$m,X$p){if(X$m===this._skin&&X$p){X$e.clearObject(this,this._weakKey);var X$h=this._clipWidth||Math.ceil(X$p.sourceWidth/this._clipX),X$P=this._clipHeight||Math.ceil(X$p.sourceHeight/this._clipY),X$L=this._skin+X$h+X$P,X$q=X$e.findObject(X$L);if(X$I.isOkTextureList(X$q)||(X$q=null),X$q)this._weakKey=X$L,X$e.keepObject(this,this._weakKey),this._sources=X$q;else{this._sources=[];for(var X$k=0;X$k<this._clipY;X$k++)for(var X$Y=0;X$Y<this._clipX;X$Y++){var X$d=X$W.createFromTexture(X$p,X$h*X$Y,X$P*X$k,X$h,X$P);if(X$p.alphaTexture){var X$K=X$p.width/X$p.alphaTexture.width;X$d.alphaTexture=X$W.createFromTexture(X$p.alphaTexture,X$h*X$Y/X$K,X$P*X$k/X$K,X$h/X$K,X$P/X$K)}this._sources.push(X$d)}X$e.saveObject(X$L,this._sources),this._weakKey=X$L,X$e.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},X$m.play=function(X$m,X$p){void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=-1),this._isPlaying=!0,this.index=X$m,this._toIndex=X$p,this._index++,X$B.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},X$m._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},X$m.stop=function(){this._isPlaying=!1,X$B.timer.clear(this,this._loop),this.event("complete")},X$m._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},X$k(0,X$m,"interval",function(){return this._interval},function(X$m){this._interval!=X$m&&(this._interval=X$m,this._isPlaying&&this.play())}),X$m.clearEvent=function(){this._skin&&X$L.atalsNotify&&X$L.atalsNotify.off(this._skin,this,this._setBtnSource)},X$m.clearLoad=function(){this._skin&&((this._complete||this._progress)&&X$B.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},X$k(0,X$m,"skin",function(){return this._skin},function(X$m){if(this._skin!=X$m)if(this.clearLoad(),this.clearEvent(),X$e.clearCache(this,this._skin),this._skin=X$m){X$e.keepCache(this,this._skin);var X$p=X$e.getRes(X$m),X$h=X$L.resAtalsObj&&X$L.resAtalsObj[this._skin];!X$p&&X$h?X$L.atalsNotify&&X$L.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),X$m._setBtnSource=function(X$m,X$p){X$m===this._skin&&X$p&&(this.loadComplete(X$m,X$p),this.clearEvent())},X$k(0,X$m,"sources",function(){return this._sources},function(X$m){this._sources=X$m,this.index=this._index,this.event("loaded")}),X$k(0,X$m,"clipX",function(){return this._clipX},function(X$m){this._clipX=X$m||1,this._setClipChanged()}),X$k(0,X$m,"clipY",function(){return this._clipY},function(X$m){this._clipY=X$m||1,this._setClipChanged()}),X$k(0,X$m,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),X$k(0,X$m,"clipWidth",function(){return this._clipWidth},function(X$m){this._clipWidth=X$m,this._setClipChanged()}),X$k(0,X$m,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(X$m){this._bitmap.sizeGrid=X$x.fillArray(X$j.defaultSizeGrid,X$m,Number)}),X$k(0,X$m,"group",function(){return this._group},function(X$m){X$m&&this._skin&&X$e.setGroup(this._skin,X$m),this._group=X$m}),X$k(0,X$m,"clipHeight",function(){return this._clipHeight},function(X$m){this._clipHeight=X$m,this._setClipChanged()}),X$k(0,X$m,"width",X$p.prototype._$get_width,function(X$m){X$B.superSet(X$u,this,"width",X$m),this._bitmap.width=X$m}),X$k(0,X$m,"height",X$p.prototype._$get_height,function(X$m){X$B.superSet(X$u,this,"height",X$m),this._bitmap.height=X$m}),X$k(0,X$m,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),X$k(0,X$m,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),X$k(0,X$m,"index",function(){return this._index},function(X$m){this._index=X$m,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[X$m]),this.event("change")}),X$k(0,X$m,"autoPlay",function(){return this._autoPlay},function(X$m){this._autoPlay!=X$m&&((this._autoPlay=X$m)?this.play():this.stop())}),X$k(0,X$m,"isPlaying",function(){return this._isPlaying},function(X$m){this._isPlaying=X$m}),X$k(0,X$m,"dataSource",X$p.prototype._$get_dataSource,function(X$m){"number"==typeof(this._dataSource=X$m)&&Math.floor(X$m)==X$m||"string"==typeof X$m?this.index=parseInt(X$m):X$B.superSet(X$u,this,"dataSource",X$m)}),X$k(0,X$m,"bitmap",function(){return this._bitmap}),X$P}(X$u),X$J=function(X$p){function X$m(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,X$m.__super.call(this)}X$q(X$m,"laya.ui.ColorPicker",X$p);var X$h=X$m.prototype;return X$h.destroy=function(X$m){void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,X$m),this._colorPanel&&this._colorPanel.destroy(X$m),this._colorButton&&this._colorButton.destroy(X$m),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},X$h.createChildren=function(){this.addChild(this._colorButton=new X$_),this._colorPanel=new X$S,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new X$Z),this._colorPanel.addChild(this._colorBlock=new X$Z),this._colorPanel.addChild(this._colorInput=new X$$)},X$h.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},X$h.onPanelMouseDown=function(X$m){X$m.stopPropagation()},X$h.changePanel=function(){this._panelChanged=!1;var X$m=this._colorPanel.graphics;X$m.clear(),X$m.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(X$m=this._colorTiles.graphics).clear();for(var X$p=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],X$h=0;X$h<12;X$h++)for(var X$P=0;X$P<20;X$P++){var X$L=0;X$L=0===X$P?X$p[X$h]:1===X$P?0:51*(((3*X$h+X$P/6)%3<<0)+3*(X$h/6<<0))<<16|X$P%6*51<<8|(X$h<<0)%6*51;var X$q=X$x.toColor(X$L);this._colors.push(X$q);var X$k=X$P*this._gridSize,X$Y=X$h*this._gridSize;X$m.drawRect(X$k,X$Y,this._gridSize,this._gridSize,X$q,"#000000")}},X$h.onColorButtonClick=function(X$m){this._colorPanel.parent?this.close():this.open()},X$h.open=function(){var X$m=this.localToGlobal(new X$A),X$p=X$m.x+this._colorPanel.width<=X$B.stage.width?X$m.x:X$B.stage.width-this._colorPanel.width,X$h=X$m.y+this._colorButton.height;X$h=X$h+this._colorPanel.height<=X$B.stage.height?X$h:X$m.y-this._colorPanel.height,this._colorPanel.pos(X$p,X$h),this._colorPanel.zOrder=1001,X$B._currentStage.addChild(this._colorPanel),X$B.stage.on("mousedown",this,this.removeColorBox)},X$h.close=function(){X$B.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},X$h.removeColorBox=function(X$m){this.close()},X$h.onColorFieldKeyDown=function(X$m){13==X$m.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),X$m.stopPropagation())},X$h.onColorInputChange=function(X$m){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},X$h.onColorTilesClick=function(X$m){this.selectedColor=this.getColorByMouse(),this.close()},X$h.onColorTilesMouseMove=function(X$m){this._colorInput.focus=!1;var X$p=this.getColorByMouse();this._colorInput.text=X$p,this.drawBlock(X$p)},X$h.getColorByMouse=function(){var X$m=this._colorTiles.getMousePoint(),X$p=Math.floor(X$m.x/this._gridSize),X$h=Math.floor(X$m.y/this._gridSize);return this._colors[20*X$h+X$p]},X$h.drawBlock=function(X$m){var X$p=this._colorBlock.graphics;X$p.clear();var X$h=X$m||"#ffffff";X$p.drawRect(0,0,50,20,X$h,this._borderColor),X$m||X$p.drawLine(0,0,50,20,"#ff0000")},X$h.changeColor=function(){var X$m=this.graphics;X$m.clear();var X$p=this._selectedColor||"#000000";X$m.drawRect(0,0,this._colorButton.width,this._colorButton.height,X$p)},X$h._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},X$k(0,X$h,"inputBgColor",function(){return this._inputBgColor},function(X$m){this._inputBgColor=X$m,this._setPanelChanged()}),X$k(0,X$h,"selectedColor",function(){return this._selectedColor},function(X$m){this._selectedColor!=X$m&&(this._selectedColor=this._colorInput.text=X$m,this.drawBlock(X$m),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",X$K.EMPTY.setTo("change",this,this)))}),X$k(0,X$h,"skin",function(){return this._colorButton.skin},function(X$m){this._colorButton.skin=X$m,this.changeColor()}),X$k(0,X$h,"bgColor",function(){return this._bgColor},function(X$m){this._bgColor=X$m,this._setPanelChanged()}),X$k(0,X$h,"borderColor",function(){return this._borderColor},function(X$m){this._borderColor=X$m,this._setPanelChanged()}),X$k(0,X$h,"inputColor",function(){return this._inputColor},function(X$m){this._inputColor=X$m,this._setPanelChanged()}),X$m}(X$u),X$z=function(X$p){function X$h(X$m,X$p){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,X$h.__super.call(this),this._itemColors=X$j.comboBoxItemColors,this.skin=X$m,this.labels=X$p}X$q(X$h,"laya.ui.ComboBox",X$p);var X$m=X$h.prototype;return X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,X$m),this._button&&this._button.destroy(X$m),this._list&&this._list.destroy(X$m),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},X$m.createChildren=function(){this.addChild(this._button=new X$_),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},X$m._createList=function(){this._list=new X$f,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},X$m._setListEvent=function(X$m){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=X$R.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},X$m.onListDown=function(X$m){X$m.stopPropagation()},X$m.onScrollBarDown=function(X$m){X$m.stopPropagation()},X$m.onButtonMouseDown=function(X$m){this.callLater(this.switchTo,[!this._isOpen])},X$m.changeList=function(){this._listChanged=!1;var X$m=this.width-2,X$p=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:X$m,height:this._itemHeight,fontSize:this._itemSize,color:X$p}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},X$m.onlistItemMouse=function(X$m,X$p){var X$h=X$m.type;if("mouseover"===X$h||"mouseout"===X$h){if(this._isCustomList)return;var X$P=this._list.getCell(X$p);if(!X$P)return;var X$L=X$P.getChildByName("label");X$L&&("mouseover"===X$h?(X$L.bgColor=this._itemColors[0],X$L.color=this._itemColors[1]):(X$L.bgColor=null,X$L.color=this._itemColors[2]))}else"click"===X$h&&(this.selectedIndex=X$p,this.isOpen=!1)},X$m.switchTo=function(X$m){this.isOpen=X$m},X$m.changeOpen=function(){this.isOpen=!this._isOpen},X$m.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var X$m=this._list.graphics;X$m.clear(),X$m.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var X$p=this._list.array||[],X$h=X$p.length=0,X$P=this._labels.length;X$h<X$P;X$h++)X$p.push({label:this._labels[X$h]});this._list.height=this._listHeight,this._list.array=X$p},X$m.changeSelected=function(){this._button.label=this.selectedLabel},X$m._onStageMouseWheel=function(X$m){this._list&&!this._list.contains(X$m.target)&&this.removeList(null)},X$m.removeList=function(X$m){X$B.stage.off("mousedown",this,this.removeList),X$B.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},X$k(0,X$m,"selectedIndex",function(){return this._selectedIndex},function(X$m){this._selectedIndex!=X$m&&(this._selectedIndex=X$m,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[X$K.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),X$k(0,X$m,"measureHeight",function(){return this._button.height}),X$k(0,X$m,"skin",function(){return this._button.skin},function(X$m){this._button.skin!=X$m&&(this._button.skin=X$m,this._listChanged=!0)}),X$k(0,X$m,"measureWidth",function(){return this._button.width}),X$k(0,X$m,"width",X$p.prototype._$get_width,function(X$m){X$B.superSet(X$u,this,"width",X$m),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),X$k(0,X$m,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(X$m){this.selectedIndex=this._labels.indexOf(X$m)}),X$k(0,X$m,"labels",function(){return this._labels.join(",")},function(X$m){0<this._labels.length&&(this.selectedIndex=-1),X$m?this._labels=X$m.split(","):this._labels.length=0,this._itemChanged=!0}),X$k(0,X$m,"height",X$p.prototype._$get_height,function(X$m){X$B.superSet(X$u,this,"height",X$m),this._button.height=this._height}),X$k(0,X$m,"selectHandler",function(){return this._selectHandler},function(X$m){this._selectHandler=X$m}),X$k(0,X$m,"visibleNum",function(){return this._visibleNum},function(X$m){this._visibleNum=X$m,this._listChanged=!0}),X$k(0,X$m,"labelBold",function(){return this._button.text.bold},function(X$m){this._button.text.bold=X$m}),X$k(0,X$m,"itemColors",function(){return String(this._itemColors)},function(X$m){this._itemColors=X$x.fillArray(this._itemColors,X$m,String),this._listChanged=!0}),X$k(0,X$m,"itemSize",function(){return this._itemSize},function(X$m){this._itemSize=X$m,this._listChanged=!0}),X$k(0,X$m,"scrollBar",function(){return this.list.scrollBar}),X$k(0,X$m,"isOpen",function(){return this._isOpen},function(X$m){if(this._isOpen!=X$m)if(this._isOpen=X$m,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var X$p=this.localToGlobal(X$A.TEMP.setTo(0,0)),X$h=X$p.y+this._button.height;X$h=X$h+this._listHeight<=X$B.stage.height?X$h:X$p.y-this._listHeight,this._list.pos(X$p.x,X$h),this._list.zOrder=1001,X$B._currentStage.addChild(this._list),X$B.stage.once("mousedown",this,this.removeList),X$B.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),X$k(0,X$m,"scrollBarSkin",function(){return this._scrollBarSkin},function(X$m){this._scrollBarSkin=X$m}),X$k(0,X$m,"sizeGrid",function(){return this._button.sizeGrid},function(X$m){this._button.sizeGrid=X$m}),X$k(0,X$m,"button",function(){return this._button}),X$k(0,X$m,"list",function(){return this._list||this._createList(),this._list},function(X$m){X$m&&(X$m.removeSelf(),this._isCustomList=!0,this._list=X$m,this._setListEvent(X$m),this._itemHeight=X$m.getCell(0).height+X$m.spaceY)}),X$k(0,X$m,"dataSource",X$p.prototype._$get_dataSource,function(X$m){"number"==typeof(this._dataSource=X$m)&&Math.floor(X$m)==X$m||"string"==typeof X$m?this.selectedIndex=parseInt(X$m):X$m instanceof Array?this.labels=X$m.join(","):X$B.superSet(X$u,this,"dataSource",X$m)}),X$k(0,X$m,"labelColors",function(){return this._button.labelColors},function(X$m){this._button.labelColors!=X$m&&(this._button.labelColors=X$m)}),X$k(0,X$m,"labelPadding",function(){return this._button.text.padding.join(",")},function(X$m){this._button.text.padding=X$x.fillArray(X$j.labelPadding,X$m,Number)}),X$k(0,X$m,"labelSize",function(){return this._button.text.fontSize},function(X$m){this._button.text.fontSize=X$m}),X$k(0,X$m,"labelFont",function(){return this._button.text.font},function(X$m){this._button.text.font=X$m}),X$k(0,X$m,"stateNum",function(){return this._button.stateNum},function(X$m){this._button.stateNum=X$m}),X$h}(X$u),X$w=function(X$p){function X$h(X$m){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,X$h.__super.call(this),this._showButtons=X$Q.showButtons,this._touchScrollEnable=X$Q.touchScrollEnable,this._mouseWheelEnable=X$Q.mouseWheelEnable,this.skin=X$m,this.max=1}X$q(X$h,"laya.ui.ScrollBar",X$p);var X$m=X$h.prototype;return X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),this.stopScroll(),this.target=null,X$p.prototype.destroy.call(this,X$m),this.upButton&&this.upButton.destroy(X$m),this.downButton&&this.downButton.destroy(X$m),this.slider&&this.slider.destroy(X$m),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},X$m.createChildren=function(){this.addChild(this.slider=new X$X),this.addChild(this.upButton=new X$_),this.addChild(this.downButton=new X$_)},X$m.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},X$m.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},X$m.onButtonMouseDown=function(X$m){var X$p=X$m.currentTarget===this.upButton;this.slide(X$p),X$B.timer.once(X$j.scrollBarDelayTime,this,this.startLoop,[X$p]),X$B.stage.once("mouseup",this,this.onStageMouseUp)},X$m.startLoop=function(X$m){X$B.timer.frameLoop(1,this,this.slide,[X$m])},X$m.slide=function(X$m){X$m?this.value-=this._scrollSize:this.value+=this._scrollSize},X$m.onStageMouseUp=function(X$m){X$B.timer.clear(this,this.startLoop),X$B.timer.clear(this,this.slide)},X$m.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},X$m.changeSize=function(){X$p.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},X$m.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},X$m.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},X$m.setScroll=function(X$m,X$p,X$h){this.runCallLater(this.changeSize),this.slider.setSlider(X$m,X$p,X$h),this.slider.bar.visible=0<X$p,!this._hide&&this.autoHide&&(this.visible=!1)},X$m.onTargetMouseWheel=function(X$m){this.value-=X$m.delta*this._scrollSize,this.target=this._target},X$m.onTargetMouseDown=function(X$m){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new X$A),this._lastPoint.setTo(X$B.stage.mouseX,X$B.stage.mouseY),X$B.timer.clear(this,this.tweenMove),X$E.clearTween(this),X$B.stage.once("mouseup",this,this.onStageMouseUp2),X$B.stage.once("mouseout",this,this.onStageMouseUp2),X$B.timer.frameLoop(1,this,this.loop)},X$m.loop=function(){var X$m=X$B.stage.mouseY,X$p=X$B.stage.mouseX;if(this._lastOffset=this.isVertical?X$m-this._lastPoint.y:X$p-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?X$B.stage._canvasTransform.getScaleY():X$B.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=X$p,this._lastPoint.y=X$m,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},X$m.onStageMouseUp2=function(X$m){if(X$B.stage.off("mouseup",this,this.onStageMouseUp2),X$B.stage.off("mouseout",this,this.onStageMouseUp2),X$B.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?X$E.to(this,{value:this.min},this.elasticBackTime,X$d.sineOut,X$R.create(this,this.elasticOver)):this._value>this.max&&X$E.to(this,{value:this.max},this.elasticBackTime,X$d.sineOut,X$R.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?X$B.stage.mouseY-this._lastPoint.y:X$B.stage.mouseX-this._lastPoint.x);for(var X$p=0,X$h=Math.min(this._offsets.length,3),X$P=0;X$P<X$h;X$P++)X$p+=this._offsets[this._offsets.length-1-X$P];if(this._lastOffset=X$p/X$h,(X$p=Math.abs(this._lastOffset))<2)return void this.event("end");60<X$p&&(this._lastOffset=0<this._lastOffset?60:-60);var X$L=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));X$B.timer.frameLoop(1,this,this.tweenMove,[X$L])}},X$m.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&X$E.to(this,{alpha:0},500),this.event("end")},X$m.tweenMove=function(X$m){this._lastOffset*=this.rollRatio;var X$p=NaN;if(0<X$m&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,X$p=.5*-(this.min-X$m-this.value),this._lastOffset>X$p&&(this._lastOffset=X$p)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,X$p=.5*-(this.max+X$m-this.value),this._lastOffset<X$p&&(this._lastOffset=X$p))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(X$B.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?X$E.to(this,{value:this.min},this.elasticBackTime,X$d.sineOut,X$R.create(this,this.elasticOver)):this._value>this.max?X$E.to(this,{value:this.max},this.elasticBackTime,X$d.sineOut,X$R.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&X$E.to(this,{alpha:0},500)}},X$m.stopScroll=function(){this.onStageMouseUp2(null),X$B.timer.clear(this,this.tweenMove),X$E.clearTween(this)},X$k(0,X$m,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),X$k(0,X$m,"skin",function(){return this._skin},function(X$m){this._skin!=X$m&&(this._skin=X$m,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),X$k(0,X$m,"max",function(){return this.slider.max},function(X$m){this.slider.max=X$m}),X$k(0,X$m,"showButtons",function(){return this._showButtons},function(X$m){this._showButtons=X$m,this.callLater(this.changeScrollBar)}),X$k(0,X$m,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),X$k(0,X$m,"min",function(){return this.slider.min},function(X$m){this.slider.min=X$m}),X$k(0,X$m,"value",function(){return this._value},function(X$m){X$m!==this._value&&(this._value=X$m,this._isElastic||(this.slider._value!=X$m&&(this.slider._value=X$m,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),X$k(0,X$m,"isVertical",function(){return this.slider.isVertical},function(X$m){this.slider.isVertical=X$m}),X$k(0,X$m,"sizeGrid",function(){return this.slider.sizeGrid},function(X$m){this.slider.sizeGrid=X$m}),X$k(0,X$m,"scrollSize",function(){return this._scrollSize},function(X$m){this._scrollSize=X$m}),X$k(0,X$m,"dataSource",X$p.prototype._$get_dataSource,function(X$m){"number"==typeof(this._dataSource=X$m)||"string"==typeof X$m?this.value=Number(X$m):X$B.superSet(X$u,this,"dataSource",X$m)}),X$k(0,X$m,"thumbPercent",function(){return this._thumbPercent},function(X$m){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),X$m=1<=X$m?.99:X$m,this._thumbPercent=X$m,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*X$m,X$j.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*X$m,X$j.scrollBarMinNum))}),X$k(0,X$m,"target",function(){return this._target},function(X$m){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=X$m)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),X$k(0,X$m,"hide",function(){return this._hide},function(X$m){this._hide=X$m,this.visible=!X$m}),X$k(0,X$m,"touchScrollEnable",function(){return this._touchScrollEnable},function(X$m){this._touchScrollEnable=X$m,this.target=this._target}),X$k(0,X$m,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(X$m){this._mouseWheelEnable=X$m,this.target=this._target}),X$k(0,X$m,"tick",function(){return this.slider.tick},function(X$m){this.slider.tick=X$m}),X$h}(X$u),X$X=function(X$p){function X$h(X$m){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,X$h.__super.call(this),this.skin=X$m}X$q(X$h,"laya.ui.Slider",X$p);var X$m=X$h.prototype;return X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,X$m),this._bg&&this._bg.destroy(X$m),this._bar&&this._bar.destroy(X$m),this._progress&&this._progress.destroy(X$m),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},X$m.createChildren=function(){this.addChild(this._bg=new X$s),this.addChild(this._bar=new X$_)},X$m.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},X$m.onBarMouseDown=function(X$m){this._globalSacle||(this._globalSacle=new X$A),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=X$B.stage.mouseX,this._ty=X$B.stage.mouseY,X$B.stage.on("mousemove",this,this.mouseMove),X$B.stage.once("mouseup",this,this.mouseUp),X$B.stage.once("mouseout",this,this.mouseUp),this.showValueText()},X$m.showValueText=function(){if(this.showLabel){var X$m=laya.ui.Slider.label;this.addChild(X$m),X$m.textField.changeText(this._value+""),this.isVertical?(X$m.x=this._bar.x+20,X$m.y=.5*(this._bar.height-X$m.height)+this._bar.y):(X$m.y=this._bar.y-20,X$m.x=.5*(this._bar.width-X$m.width)+this._bar.x)}},X$m.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},X$m.mouseUp=function(X$m){X$B.stage.off("mousemove",this,this.mouseMove),X$B.stage.off("mouseup",this,this.mouseUp),X$B.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},X$m.mouseMove=function(X$m){var X$p=this._value;this.isVertical?(this._bar.y+=(X$B.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(X$B.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=X$B.stage.mouseX,this._ty=X$B.stage.mouseY;var X$h=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*X$h)/X$h,this._value!=X$p&&this.sendChangeEvent(),this.showValueText()},X$m.sendChangeEvent=function(X$m){void 0===X$m&&(X$m="change"),this.event(X$m),this.changeHandler&&this.changeHandler.runWith(this._value)},X$m.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},X$m.changeSize=function(){X$p.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},X$m.setSlider=function(X$m,X$p,X$h){this._value=-1,this._min=X$m,this._max=X$m<X$p?X$p:X$m,this.value=X$h<X$m?X$m:X$p<X$h?X$p:X$h},X$m.changeValue=function(){var X$m=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*X$m)/X$m,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var X$p=this._max-this._min;0===X$p&&(X$p=1),this.isVertical?(this._bar.y=(this._value-this._min)/X$p*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/X$p*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},X$m.onBgMouseDown=function(X$m){var X$p=this._bg.getMousePoint();this.isVertical?this.value=X$p.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=X$p.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},X$k(0,X$m,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),X$k(0,X$m,"skin",function(){return this._skin},function(X$m){if(this._skin!=X$m){this._skin=X$m,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var X$p=this._skin.replace(".png","$progress.png");X$e.getRes(X$p)&&(this._progress||(this.addChild(this._progress=new X$s),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=X$p),this.setBarPoint(),this.callLater(this.changeValue)}}),X$k(0,X$m,"allowClickBack",function(){return this._allowClickBack},function(X$m){this._allowClickBack!=X$m&&((this._allowClickBack=X$m)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),X$k(0,X$m,"max",function(){return this._max},function(X$m){this._max!=X$m&&(this._max=X$m,this.callLater(this.changeValue))}),X$k(0,X$m,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),X$k(0,X$m,"tick",function(){return this._tick},function(X$m){this._tick!=X$m&&(this._tick=X$m,this.callLater(this.changeValue))}),X$k(0,X$m,"sizeGrid",function(){return this._bg.sizeGrid},function(X$m){this._bg.sizeGrid=X$m,this._bar.sizeGrid=X$m,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),X$k(0,X$m,"min",function(){return this._min},function(X$m){this._min!=X$m&&(this._min=X$m,this.callLater(this.changeValue))}),X$k(0,X$m,"value",function(){return this._value},function(X$m){if(this._value!=X$m){var X$p=this._value;this._value=X$m,this.changeValue(),this._value!=X$p&&this.sendChangeEvent()}}),X$k(0,X$m,"dataSource",X$p.prototype._$get_dataSource,function(X$m){"number"==typeof(this._dataSource=X$m)||"string"==typeof X$m?this.value=Number(X$m):X$B.superSet(X$u,this,"dataSource",X$m)}),X$k(0,X$m,"bar",function(){return this._bar}),X$P(X$h,["label",function(){return this.label=new X$G}]),X$h}(X$u),X$s=function(X$p){function X$h(X$m){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,X$h.__super.call(this),this.skin=X$m}X$q(X$h,"laya.ui.Image",X$p);var X$m=X$h.prototype;return X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,X$e.clearCache(this,this._skin)},X$m.dispose=function(){this.destroy(!0),X$e.clearCache(this,this._skin),this.clearEvent()},X$m.createChildren=function(){this.graphics=this._bitmap=new X$M},X$m.setSource=function(X$m,X$p){X$m===this._skin&&X$p&&(this.source=X$p,this.onCompResize(),this.clearEvent())},X$m.clearEvent=function(){this._skin&&X$L.atalsNotify&&X$L.atalsNotify.off(this._skin,this,this.setSource)},X$m.clearLoad=function(){this._skin&&((this._complete||this._progress)&&X$B.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},X$k(0,X$m,"source",function(){return this._bitmap.source},function(X$m){this._bitmap&&(this._bitmap.source=X$m,this.event("loaded"),this.repaint())}),X$k(0,X$m,"dataSource",X$p.prototype._$get_dataSource,function(X$m){"string"==typeof(this._dataSource=X$m)?this.skin=X$m:X$B.superSet(X$u,this,"dataSource",X$m)}),X$k(0,X$m,"measureHeight",function(){return this._bitmap.height}),X$k(0,X$m,"skin",function(){return this._skin},function(X$m){if(this._skin!=X$m)if(X$e.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=X$m){X$e.keepCache(this,this._skin);var X$p=X$e.getRes(X$m),X$h=X$L.resAtalsObj&&X$L.resAtalsObj[this._skin];X$p?(this.source=X$p,this.onCompResize()):X$h?(X$L.atalsNotify&&X$L.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=X$h.sourceW),0==this.height&&(this.height=X$h.sourceH)):(this._complete=X$R.create(this,this.setSource,[this._skin]),this._progress=null,X$B.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),X$k(0,X$m,"group",function(){return this._group},function(X$m){X$m&&this._skin&&X$e.setGroup(this._skin,X$m),this._group=X$m}),X$k(0,X$m,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(X$m){this._bitmap.sizeGrid=X$x.fillArray(X$j.defaultSizeGrid,X$m,Number)}),X$k(0,X$m,"measureWidth",function(){return this._bitmap.width}),X$k(0,X$m,"width",X$p.prototype._$get_width,function(X$m){X$B.superSet(X$u,this,"width",X$m),this._bitmap.width=0==X$m?1e-7:X$m}),X$k(0,X$m,"height",X$p.prototype._$get_height,function(X$m){X$B.superSet(X$u,this,"height",X$m),this._bitmap.height=0==X$m?1e-7:X$m}),X$h}(X$u),X$G=function(X$p){function X$h(X$m){this._tf=null,X$h.__super.call(this),void 0===X$m&&(X$m=""),X$D.defaultColor=X$j.labelColor,this.text=X$m}X$q(X$h,"laya.ui.Label",X$p);var X$m=X$h.prototype;return X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,X$m),this._tf=null},X$m.createChildren=function(){this.addChild(this._tf=new X$H)},X$m.changeText=function(X$m){this._tf.changeText(X$m)},X$k(0,X$m,"padding",function(){return this._tf.padding.join(",")},function(X$m){this._tf.padding=X$x.fillArray(X$j.labelPadding,X$m,Number)}),X$k(0,X$m,"bold",function(){return this._tf.bold},function(X$m){this._tf.bold=X$m}),X$k(0,X$m,"align",function(){return this._tf.align},function(X$m){this._tf.align=X$m}),X$k(0,X$m,"text",function(){return this._tf.text},function(X$m){this._tf.text!=X$m&&(X$m&&(X$m=X$x.adptString(X$m+"")),this._tf.text=X$m,this.event("change"),this._width&&this._height||this.onCompResize())}),X$k(0,X$m,"italic",function(){return this._tf.italic},function(X$m){this._tf.italic=X$m}),X$k(0,X$m,"wordWrap",function(){return this._tf.wordWrap},function(X$m){this._tf.wordWrap=X$m}),X$k(0,X$m,"font",function(){return this._tf.font},function(X$m){this._tf.font=X$m}),X$k(0,X$m,"dataSource",X$p.prototype._$get_dataSource,function(X$m){"number"==typeof(this._dataSource=X$m)||"string"==typeof X$m?this.text=X$m+"":X$B.superSet(X$u,this,"dataSource",X$m)}),X$k(0,X$m,"color",function(){return this._tf.color},function(X$m){this._tf.color=X$m}),X$k(0,X$m,"valign",function(){return this._tf.valign},function(X$m){this._tf.valign=X$m}),X$k(0,X$m,"leading",function(){return this._tf.leading},function(X$m){this._tf.leading=X$m}),X$k(0,X$m,"fontSize",function(){return this._tf.fontSize},function(X$m){this._tf.fontSize=X$m}),X$k(0,X$m,"bgColor",function(){return this._tf.bgColor},function(X$m){this._tf.bgColor=X$m}),X$k(0,X$m,"borderColor",function(){return this._tf.borderColor},function(X$m){this._tf.borderColor=X$m}),X$k(0,X$m,"stroke",function(){return this._tf.stroke},function(X$m){this._tf.stroke=X$m}),X$k(0,X$m,"strokeColor",function(){return this._tf.strokeColor},function(X$m){this._tf.strokeColor=X$m}),X$k(0,X$m,"textField",function(){return this._tf}),X$k(0,X$m,"measureWidth",function(){return this._tf.width}),X$k(0,X$m,"measureHeight",function(){return this._tf.height}),X$k(0,X$m,"width",function(){return this._width||this._tf.text?X$B.superGet(X$u,this,"width"):0},function(X$m){X$B.superSet(X$u,this,"width",X$m),this._tf.width=X$m}),X$k(0,X$m,"height",function(){return this._height||this._tf.text?X$B.superGet(X$u,this,"height"):0},function(X$m){X$B.superSet(X$u,this,"height",X$m),this._tf.height=X$m}),X$k(0,X$m,"overflow",function(){return this._tf.overflow},function(X$m){this._tf.overflow=X$m}),X$k(0,X$m,"underline",function(){return this._tf.underline},function(X$m){this._tf.underline=X$m}),X$k(0,X$m,"underlineColor",function(){return this._tf.underlineColor},function(X$m){this._tf.underlineColor=X$m}),X$h}(X$u),X$U=function(X$p){function X$h(X$m){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,X$h.__super.call(this),this.skin=X$m}X$q(X$h,"laya.ui.ProgressBar",X$p);var X$m=X$h.prototype;return X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,X$m),this._bg&&this._bg.destroy(X$m),this._bar&&this._bar.destroy(X$m),this._bg=this._bar=null,this.changeHandler=null},X$m.createChildren=function(){this.addChild(this._bg=new X$s),this.addChild(this._bar=new X$s)},X$m.changeValue=function(){if(this.sizeGrid){var X$m=this.sizeGrid.split(","),X$p=Number(X$m[3]),X$h=Number(X$m[1]),X$P=(this.width-X$p-X$h)*this._value;this._bar.width=X$p+X$h+X$P,this._bar.visible=this._bar.width>X$p+X$h}else this._bar.width=this.width*this._value},X$k(0,X$m,"measureHeight",function(){return this._bg.height}),X$k(0,X$m,"skin",function(){return this._skin},function(X$m){this._skin!=X$m&&(this._skin=X$m,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),X$k(0,X$m,"measureWidth",function(){return this._bg.width}),X$k(0,X$m,"height",X$p.prototype._$get_height,function(X$m){X$B.superSet(X$u,this,"height",X$m),this._bg.height=this._height,this._bar.height=this._height}),X$k(0,X$m,"bar",function(){return this._bar}),X$k(0,X$m,"value",function(){return this._value},function(X$m){this._value!=X$m&&(X$m=1<X$m?1:X$m<0?0:X$m,this._value=X$m,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(X$m))}),X$k(0,X$m,"bg",function(){return this._bg}),X$k(0,X$m,"sizeGrid",function(){return this._bg.sizeGrid},function(X$m){this._bg.sizeGrid=this._bar.sizeGrid=X$m}),X$k(0,X$m,"width",X$p.prototype._$get_width,function(X$m){X$B.superSet(X$u,this,"width",X$m),this._bg.width=this._width,this.callLater(this.changeValue)}),X$k(0,X$m,"dataSource",X$p.prototype._$get_dataSource,function(X$m){"number"==typeof(this._dataSource=X$m)||"string"==typeof X$m?this.value=Number(X$m):X$B.superSet(X$u,this,"dataSource",X$m)}),X$h}(X$u),X$r=(function(X$m){function X$h(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,X$h.__super.call(this),this._tipBox=new X$u,this._tipBox.addChild(this._tipText=new X$H),this._tipText.x=this._tipText.y=5,this._tipText.color=X$h.tipTextColor,this._defaultTipHandler=this._showDefaultTip,X$B.stage.on("showtip",this,this._onStageShowTip),X$B.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}X$q(X$h,"laya.ui.TipManager",X$u);var X$p=X$h.prototype;X$p._onStageHideTip=function(X$m){X$B.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},X$p._onStageShowTip=function(X$m){X$B.timer.once(X$h.tipDelay,this,this._showTip,[X$m],!0)},X$p._showTip=function(X$m){if("string"==typeof X$m){var X$p=String(X$m);Boolean(X$p)&&this._defaultTipHandler(X$p)}else X$m instanceof laya.utils.Handler?X$m.run():"function"==typeof X$m&&X$m.apply();X$B.stage.on("mousemove",this,this._onStageMouseMove),X$B.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},X$p._onStageMouseDown=function(X$m){this.closeAll()},X$p._onStageMouseMove=function(X$m){this._showToStage(this,X$h.offsetX,X$h.offsetY)},X$p._showToStage=function(X$m,X$p,X$h){void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0);var X$P=X$m.getBounds();X$m.x=X$B.stage.mouseX+X$p,X$m.y=X$B.stage.mouseY+X$h,X$m.x+X$P.width>X$B.stage.width&&(X$m.x-=X$P.width+X$p),X$m.y+X$P.height>X$B.stage.height&&(X$m.y-=X$P.height+X$h)},X$p.closeAll=function(){X$B.timer.clear(this,this._showTip),X$B.stage.off("mousemove",this,this._onStageMouseMove),X$B.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},X$p.showDislayTip=function(X$m){this.addChild(X$m),this._showToStage(this),X$B._currentStage.addChild(this)},X$p._showDefaultTip=function(X$m){this._tipText.text=X$m;var X$p=this._tipBox.graphics;X$p.clear(),X$p.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,X$h.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),X$B._currentStage.addChild(this)},X$k(0,X$p,"defaultTipHandler",function(){return this._defaultTipHandler},function(X$m){this._defaultTipHandler=X$m}),X$h.offsetX=10,X$h.offsetY=15,X$h.tipTextColor="#ffffff",X$h.tipBackColor="#111111",X$h.tipDelay=200}(),function(X$m){var X$$;function X$A(){this._idMap=null,this._aniList=null,this._watchMap={},X$A.__super.call(this)}X$q(X$A,"laya.ui.View",X$S);var X$p=X$A.prototype;return X$p.createView=function(X$m){if(X$m.animations&&!this._idMap&&(this._idMap={}),X$A.createComp(X$m,this,this),X$m.animations){var X$p,X$h,X$P=[],X$L=X$m.animations,X$q=0,X$k=X$L.length;for(X$q=0;X$q<X$k;X$q++){switch(X$p=new X$F,X$h=X$L[X$q],X$p._setUp(this._idMap,X$h),(this[X$h.name]=X$p)._setControlNode(this),X$h.action){case 1:X$p.play(0,!1);break;case 2:X$p.play(0,!0)}X$P.push(X$p)}this._aniList=X$P}0<this._width&&null==X$m.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},X$p.onEvent=function(X$m,X$p){},X$p.loadUI=function(X$m){var X$p=X$A.uiMap[X$m];X$p&&this.createView(X$p)},X$p.destroy=function(X$m){void 0===X$m&&(X$m=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,X$m)},X$p.changeData=function(X$m){var X$p=this._watchMap[X$m];if(X$p){console.log("change",X$m);for(var X$h=0,X$P=X$p.length;X$h<X$P;X$h++){X$p[X$h].exe(this)}}},X$A._regs=function(){for(var X$m in X$A.uiClassMap)X$n.regClass(X$m,X$A.uiClassMap[X$m])},X$A.createComp=function(X$m,X$p,X$h,X$P){if(!(X$p=X$p||X$A.getCompInstance(X$m)))return console.warn("can not create:"+X$m.type),null;var X$L=X$m.child;if(X$L)for(var X$q=X$p instanceof laya.ui.List,X$k=0,X$Y=X$L.length;X$k<X$Y;X$k++){var X$d=X$L[X$k];if(!X$p.hasOwnProperty("itemRender")||"render"!=X$d.props.name&&"render"!==X$d.props.renderType)if("Graphic"==X$d.type)X$n.addGraphicsToSprite(X$d,X$p);else if(X$n.isDrawType(X$d.type))X$n.addGraphicToSprite(X$d,X$p,!0);else{if(X$q){var X$K=[],X$D=X$A.createComp(X$d,null,X$h,X$K);X$K.length&&(X$D._$bindData=X$K)}else X$D=X$A.createComp(X$d,null,X$h,X$P);"Script"==X$d.type?"owner"in X$D?X$D.owner=X$p:"target"in X$D&&(X$D.target=X$p):"mask"==X$d.props.renderType||"mask"==X$d.props.name?X$p.mask=X$D:X$D instanceof laya.display.Sprite&&X$p.addChild(X$D)}else X$p.itemRender=X$d}var X$F=X$m.props;for(var X$R in X$F){var X$$=X$F[X$R];X$A.eventDic[X$R]?X$$&&X$h&&X$p.on(X$R,X$h,X$h.onEvent,[X$$]):X$A.setCompValue(X$p,X$R,X$$,X$h,X$P)}return X$B.__typeof(X$p,"laya.ui.IItem")&&X$p.initItems(),X$m.compId&&X$h&&X$h._idMap&&(X$h._idMap[X$m.compId]=X$p),X$p},X$A.setCompValue=function(X$m,X$p,X$h,X$P,X$L){if("string"==typeof X$h&&-1<X$h.indexOf("${")){if(X$A._sheet||(X$A._sheet=X$n.getClass("laya.data.Table")),!X$A._sheet)return void console.warn("Can not find class Sheet");if(X$L)X$L.push(X$m,X$p,X$h);else if(X$P){-1==X$h.indexOf("].")&&(X$h=X$h.replace(".","[0]."));var X$q,X$k,X$Y=new X$$(X$m,X$p,X$h);X$Y.exe(X$P);for(var X$d=X$h.replace(/\[.*?\]\./g,".");null!=(X$q=X$A._parseWatchData.exec(X$d));){for(var X$K=X$q[1];null!=(X$k=X$A._parseKeyWord.exec(X$K));){var X$D=X$k[0],X$F=X$P._watchMap[X$D]||(X$P._watchMap[X$D]=[]);X$F.push(X$Y),X$A._sheet.I.notifer.on(X$D,X$P,X$P.changeData,[X$D])}(X$F=X$P._watchMap[X$K]||(X$P._watchMap[X$K]=[])).push(X$Y),X$A._sheet.I.notifer.on(X$K,X$P,X$P.changeData,[X$K])}}}else if("var"===X$p&&X$P)X$P[X$h]=X$m;else if("onClick"==X$p){var X$R=X$B._runScript("(function(){"+X$h+"})");X$m.on("click",X$P,X$R)}else X$m[X$p]="true"===X$h||"false"!==X$h&&X$h},X$A.getCompInstance=function(X$m){var X$p,X$h=X$m.props?X$m.props.runtime:null;return X$p=X$h?X$A.viewClassMap[X$h]||X$A.uiClassMap[X$h]||X$B.__classmap[X$h]:X$A.uiClassMap[X$m.type],X$m.props&&X$m.props.hasOwnProperty("renderType")&&"instance"==X$m.props.renderType?X$p.instance:X$p?new X$p:null},X$A.regComponent=function(X$m,X$p){X$A.uiClassMap[X$m]=X$p,X$n.regClass(X$m,X$p)},X$A.regViewRuntime=function(X$m,X$p){X$A.viewClassMap[X$m]=X$p},X$A.uiMap={},X$A.viewClassMap={},X$A._sheet=null,X$P(X$A,["uiClassMap",function(){return this.uiClassMap={ViewStack:X$mm,LinkButton:X$_,TextArea:X$Km,ColorPicker:X$J,Box:X$S,Button:X$_,CheckBox:X$y,Clip:X$l,ComboBox:X$z,Component:X$u,HScrollBar:X$i,HSlider:X$g,Image:X$s,Label:X$G,List:X$f,Panel:X$v,ProgressBar:X$U,Radio:X$O,RadioGroup:X$Ym,ScrollBar:X$w,Slider:X$X,Tab:X$dm,TextInput:X$hm,View:X$A,VScrollBar:X$pm,VSlider:X$Pm,Tree:X$C,HBox:X$qm,VBox:X$km,Sprite:X$Z,Animation:X$h,Text:X$H,FontClip:X$o}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),X$A.__init$=function(){X$A._regs(),X$$=function(){function X$m(X$m,X$p,X$h){this.comp=null,this.prop=null,this.value=null,this.comp=X$m,this.prop=X$p,this.value=X$h}return X$q(X$m,""),X$m.prototype.exe=function(X$m){var X$p=X$x.getBindFun(this.value);this.comp[this.prop]=X$p.call(this,X$m)},X$m}()},X$A}()),X$y=function(X$m){function X$h(X$m,X$p){void 0===X$p&&(X$p=""),X$h.__super.call(this,X$m,X$p)}X$q(X$h,"laya.ui.CheckBox",X$m);var X$p=X$h.prototype;return X$p.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},X$p.initialize=function(){X$m.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},X$k(0,X$p,"dataSource",X$m.prototype._$get_dataSource,function(X$m){"boolean"==typeof(this._dataSource=X$m)?this.selected=X$m:"string"==typeof X$m?this.selected="true"===X$m:X$B.superSet(X$_,this,"dataSource",X$m)}),X$h}(X$_),X$V=function(X$m){function X$p(){this._space=0,this._align="none",this._itemChanged=!1,X$p.__super.call(this)}X$q(X$p,"laya.ui.LayoutBox",X$S);var X$h=X$p.prototype;return X$h.addChild=function(X$m){return X$m.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,X$m)},X$h.onResize=function(X$m){this._setItemChanged()},X$h.addChildAt=function(X$m,X$p){return X$m.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,X$m,X$p)},X$h.removeChild=function(X$m){return X$m.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,X$m)},X$h.removeChildAt=function(X$m){return this.getChildAt(X$m).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,X$m)},X$h.refresh=function(){this._setItemChanged()},X$h.changeItems=function(){this._itemChanged=!1},X$h.sortItem=function(X$m){X$m&&X$m.sort(function(X$m,X$p){return X$m.y-X$p.y})},X$h._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},X$k(0,X$h,"space",function(){return this._space},function(X$m){this._space=X$m,this._setItemChanged()}),X$k(0,X$h,"align",function(){return this._align},function(X$m){this._align=X$m,this._setItemChanged()}),X$p}(),X$o=function(X$p){function X$h(X$m,X$p){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,X$h.__super.call(this),X$m&&(this.skin=X$m),X$p&&(this.sheet=X$p)}X$q(X$h,"laya.ui.FontClip",X$p);var X$m=X$h.prototype;return X$m.createChildren=function(){this._bitmap=new X$M,this.on("loaded",this,this._onClipLoaded)},X$m._onClipLoaded=function(){this.callLater(this.changeValue)},X$m.changeValue=function(){var X$m;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),X$m=this._sources[0]))){var X$p="horizontal"===this._direction;X$p?(this._wordsW=this._valueArr.length*(X$m.sourceWidth+this.spaceX),this._wordsH=X$m.sourceHeight):(this._wordsW=X$m.sourceWidth,this._wordsH=(X$m.sourceHeight+this.spaceY)*this._valueArr.length);var X$h=0;if(this._width)switch(this._align){case"center":X$h=.5*(this._width-this._wordsW);break;case"right":X$h=this._width-this._wordsW;break;default:X$h=0}for(var X$P=0,X$L=this._valueArr.length;X$P<X$L;X$P++){var X$q=this._indexMap[this._valueArr.charAt(X$P)];this.sources[X$q]&&(X$m=this.sources[X$q],X$p?this.graphics.drawTexture(X$m,X$h+X$P*(X$m.sourceWidth+this.spaceX),0,X$m.sourceWidth,X$m.sourceHeight):this.graphics.drawTexture(X$m,0+X$h,X$P*(X$m.sourceHeight+this.spaceY),X$m.sourceWidth,X$m.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),X$p.prototype.destroy.call(this,X$m)},X$k(0,X$m,"sheet",function(){return this._sheet},function(X$m){X$m+="";var X$p=(this._sheet=X$m).split(" ");this._clipX=String(X$p[0]).length,this.clipY=X$p.length,this._indexMap={};for(var X$h=0;X$h<this._clipY;X$h++)for(var X$P=X$p[X$h].split(""),X$L=0,X$q=X$P.length;X$L<X$q;X$L++)this._indexMap[X$P[X$L]]=X$h*this._clipX+X$L}),X$k(0,X$m,"height",X$p.prototype._$get_height,function(X$m){X$B.superSet(X$l,this,"height",X$m),this.callLater(this.changeValue)}),X$k(0,X$m,"direction",function(){return this._direction},function(X$m){this._direction=X$m,this.callLater(this.changeValue)}),X$k(0,X$m,"value",function(){return this._valueArr?this._valueArr:""},function(X$m){X$m+="",this._valueArr=X$m,this.callLater(this.changeValue)}),X$k(0,X$m,"width",X$p.prototype._$get_width,function(X$m){X$B.superSet(X$l,this,"width",X$m),this.callLater(this.changeValue)}),X$k(0,X$m,"spaceX",function(){return this._spaceX},function(X$m){this._spaceX=X$m,"horizontal"===this._direction&&this.callLater(this.changeValue)}),X$k(0,X$m,"spaceY",function(){return this._spaceY},function(X$m){this._spaceY=X$m,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),X$k(0,X$m,"align",function(){return this._align},function(X$m){this._align=X$m,this.callLater(this.changeValue)}),X$k(0,X$m,"measureWidth",function(){return this._wordsW}),X$k(0,X$m,"measureHeight",function(){return this._wordsH}),X$h}(X$l),X$f=function(X$m){function X$p(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new X$A,X$p.__super.call(this)}X$q(X$p,"laya.ui.List",X$m);var X$h=X$p.prototype;return X$B.imps(X$h,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),X$h.destroy=function(X$m){void 0===X$m&&(X$m=!0),this._content&&this._content.destroy(X$m),this._scrollBar&&this._scrollBar.destroy(X$m),laya.ui.Component.prototype.destroy.call(this,X$m),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},X$h.createChildren=function(){this.addChild(this._content=new X$S)},X$h.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=X$B.superGet(X$S,this,"cacheAs")),X$B.superSet(X$S,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},X$h.onScrollEnd=function(){X$B.superSet(X$S,this,"cacheAs",this._$P.cacheAs)},X$h._removePreScrollBar=function(){var X$m=this.removeChildByName("scrollBar");X$m&&X$m.destroy(!0)},X$h.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var X$m=this._getOneCell(),X$p=X$m.width+this._spaceX||1,X$h=X$m.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/X$p):Math.ceil(this._width/X$p)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/X$h):Math.round(this._height/X$h));var X$P=this._width?this._width:X$p*this.repeatX-this._spaceX,X$L=this._height?this._height:X$h*this.repeatY-this._spaceY;this._cellSize=this._isVertical?X$h:X$p,this._cellOffset=this._isVertical?X$h*Math.max(this._repeatY2,this._repeatY)-X$L-this._spaceY:X$p*Math.max(this._repeatX2,this._repeatX)-X$P-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=X$L:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=X$P),this.setContentSize(X$P,X$L);var X$q=this._isVertical?this.repeatX:this.repeatY,X$k=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,X$q,X$k),this._createdLine=X$k,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},X$h._getOneCell=function(){if(0===this._cells.length){var X$m=this.createItem();if(this._offset.setTo(X$m.x,X$m.y),this.cacheContent)return X$m;this._cells.push(X$m)}return this._cells[0]},X$h._createItems=function(X$m,X$p,X$h){var X$P=this._content,X$L=this._getOneCell(),X$q=X$L.width+this._spaceX,X$k=X$L.height+this._spaceY;if(this.cacheContent){var X$Y=new X$S;X$Y.cacheAsBitmap=!0,X$Y.pos((this._isVertical?0:X$m)*X$q,(this._isVertical?X$m:0)*X$k),this._content.addChild(X$Y),this._content.optimizeScrollRect=!0,X$P=X$Y}else{for(var X$d=[],X$K=this._cells.length-1;-1<X$K;X$K--){var X$D=this._cells[X$K];X$D.removeSelf(),X$d.push(X$D)}this._cells.length=0}for(var X$F=X$m;X$F<X$h;X$F++)for(var X$R=0;X$R<X$p;X$R++)(X$L=X$d&&X$d.length?X$d.pop():this.createItem()).x=(this._isVertical?X$R:X$F)*X$q-X$P.x,X$L.y=(this._isVertical?X$F:X$R)*X$k-X$P.y,X$L.name="item"+(X$F*X$p+X$R),X$P.addChild(X$L),this.addCell(X$L)},X$h.createItem=function(){var X$m=[];if("function"==typeof this._itemRender)var X$p=new this._itemRender;else X$p=X$r.createComp(this._itemRender,null,null,X$m);if(0==X$m.length&&X$p._watchMap){var X$h=X$p._watchMap;for(var X$P in X$h)for(var X$L=X$h[X$P],X$q=0;X$q<X$L.length;X$q++){var X$k=X$L[X$q];X$m.push(X$k.comp,X$k.prop,X$k.value)}}return X$m.length&&(X$p._$bindData=X$m),X$p},X$h.addCell=function(X$m){X$m.on("click",this,this.onCellMouse),X$m.on("rightclick",this,this.onCellMouse),X$m.on("mouseover",this,this.onCellMouse),X$m.on("mouseout",this,this.onCellMouse),X$m.on("mousedown",this,this.onCellMouse),X$m.on("mouseup",this,this.onCellMouse),this._cells.push(X$m)},X$h.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var X$m=0,X$p=X$m=0;X$p<1e4;X$p++){var X$h=this.getChildByName("item"+X$p);if(!X$h)break;this.addCell(X$h),X$m++}this.repeatY=X$m}},X$h.setContentSize=function(X$m,X$p){this._content.width=X$m,this._content.height=X$p,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new X$c),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,X$m,X$p),this._content.scrollRect=this._content.scrollRect),this.event("resize")},X$h.onCellMouse=function(X$m){"mousedown"===X$m.type&&(this._isMoved=!1);var X$p=X$m.currentTarget,X$h=this._startIndex+this._cells.indexOf(X$p);X$h<0||("click"===X$m.type||"rightclick"===X$m.type?this.selectEnable&&!this._isMoved?this.selectedIndex=X$h:this.changeCellState(X$p,!0,0):"mouseover"!==X$m.type&&"mouseout"!==X$m.type||this._selectedIndex===X$h||this.changeCellState(X$p,"mouseover"===X$m.type,0),this.mouseHandler&&this.mouseHandler.runWith([X$m,X$h]))},X$h.changeCellState=function(X$m,X$p,X$h){var X$P=X$m.getChildByName("selectBox");X$P&&(this.selectEnable=!0,X$P.visible=X$p,X$P.index=X$h)},X$h.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},X$h.onScrollBarChange=function(X$m){this.runCallLater(this.changeCells);var X$p=this._scrollBar.value,X$h=this._isVertical?this.repeatX:this.repeatY,X$P=this._isVertical?this.repeatY:this.repeatX,X$L=Math.floor(X$p/this._cellSize);if(this.cacheContent)X$k=X$P+1,this._createdLine-X$L<X$k&&(this._createItems(this._createdLine,X$h,this._createdLine+X$k),this.renderItems(this._createdLine*X$h,0),this._createdLine+=X$k);else{var X$q=X$L*X$h,X$k=0;if(X$q>this._startIndex){X$k=X$q-this._startIndex;var X$Y=!0,X$d=this._startIndex+X$h*(X$P+1);this._isMoved=!0}else X$q<this._startIndex&&(X$k=this._startIndex-X$q,X$Y=!1,X$d=this._startIndex-1,this._isMoved=!0);for(var X$K=0;X$K<X$k;X$K++){if(X$Y){var X$D=this._cells.shift();this._cells[this._cells.length]=X$D;var X$F=X$d+X$K}else X$D=this._cells.pop(),this._cells.unshift(X$D),X$F=X$d-X$K;var X$R=Math.floor(X$F/X$h)*this._cellSize;this._isVertical?X$D.y=X$R:X$D.x=X$R,this.renderItem(X$D,X$F)}this._startIndex=X$q,this.changeSelectStatus()}var X$$=this._content.scrollRect;this._isVertical?(X$$.y=X$p-this._offset.y,X$$.x=-this._offset.x):(X$$.y=-this._offset.y,X$$.x=X$p-this._offset.x),this._content.scrollRect=X$$},X$h.posCell=function(X$m,X$p){if(this._scrollBar){var X$h=this._isVertical?this.repeatX:this.repeatY,X$P=(this._isVertical?this.repeatY:this.repeatX,Math.floor(X$p/X$h)*this._cellSize);this._isVertical?X$m.y=X$P:X$m.x=X$P}},X$h.changeSelectStatus=function(){for(var X$m=0,X$p=this._cells.length;X$m<X$p;X$m++)this.changeCellState(this._cells[X$m],this._selectedIndex===this._startIndex+X$m,1)},X$h.renderItems=function(X$m,X$p){void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0);for(var X$h=X$m,X$P=X$p||this._cells.length;X$h<X$P;X$h++)this.renderItem(this._cells[X$h],this._startIndex+X$h);this.changeSelectStatus()},X$h.renderItem=function(X$m,X$p){this._array&&0<=X$p&&X$p<this._array.length?(X$m.visible=!0,X$m._$bindData?(X$m._dataSource=this._array[X$p],this._bindData(X$m,this._array[X$p])):X$m.dataSource=this._array[X$p],this.cacheContent||this.posCell(X$m,X$p),this.hasListener("render")&&this.event("render",[X$m,X$p]),this.renderHandler&&this.renderHandler.runWith([X$m,X$p])):(X$m.visible=!1,X$m.dataSource=null)},X$h._bindData=function(X$m,X$p){for(var X$h=X$m._$bindData,X$P=0,X$L=X$h.length;X$P<X$L;X$P++){var X$q=X$h[X$P++],X$k=X$h[X$P++],X$Y=X$h[X$P],X$d=X$x.getBindFun(X$Y);X$q[X$k]=X$d.call(this,X$p)}},X$h.refresh=function(){this.array=this._array},X$h.getItem=function(X$m){return-1<X$m&&X$m<this._array.length?this._array[X$m]:null},X$h.changeItem=function(X$m,X$p){-1<X$m&&X$m<this._array.length&&(this._array[X$m]=X$p,X$m>=this._startIndex&&X$m<this._startIndex+this._cells.length&&this.renderItem(this.getCell(X$m),X$m))},X$h.setItem=function(X$m,X$p){this.changeItem(X$m,X$p)},X$h.addItem=function(X$m){this._array.push(X$m),this.array=this._array},X$h.addItemAt=function(X$m,X$p){this._array.splice(X$p,0,X$m),this.array=this._array},X$h.deleteItem=function(X$m){this._array.splice(X$m,1),this.array=this._array},X$h.getCell=function(X$m){return this.runCallLater(this.changeCells),-1<X$m&&this._cells?this._cells[(X$m-this._startIndex)%this._cells.length]:null},X$h.scrollTo=function(X$m){if(this._scrollBar){var X$p=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(X$m/X$p)*this._cellSize}else this.startIndex=X$m},X$h.tweenTo=function(X$m,X$p,X$h){if(void 0===X$p&&(X$p=200),this._scrollBar){var X$P=this._isVertical?this.repeatX:this.repeatY;X$E.to(this._scrollBar,{value:Math.floor(X$m/X$P)*this._cellSize},X$p,null,X$h,0,!0)}else this.startIndex=X$m,X$h&&X$h.run()},X$h._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},X$h.commitMeasure=function(){this.runCallLater(this.changeCells)},X$k(0,X$h,"cacheAs",X$m.prototype._$get_cacheAs,function(X$m){X$B.superSet(X$S,this,"cacheAs",X$m),this._scrollBar&&(this._$P.cacheAs=null,"none"!==X$m?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),X$k(0,X$h,"content",function(){return this._content}),X$k(0,X$h,"height",X$m.prototype._$get_height,function(X$m){X$m!=this._height&&(X$B.superSet(X$S,this,"height",X$m),this._setCellChanged())}),X$k(0,X$h,"itemRender",function(){return this._itemRender},function(X$m){if(this._itemRender!=X$m){this._itemRender=X$m;for(var X$p=this._cells.length-1;-1<X$p;X$p--)this._cells[X$p].destroy();this._cells.length=0,this._setCellChanged()}}),X$k(0,X$h,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(X$m){this._removePreScrollBar();var X$p=new X$pm;X$p.name="scrollBar",X$p.right=0,X$m&&" "!=X$m&&(X$p.skin=X$m),this.scrollBar=X$p,this.addChild(X$p),this._setCellChanged()}),X$k(0,X$h,"page",function(){return this._page},function(X$m){this._page=X$m,this._array&&(this._page=0<X$m?X$m:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),X$k(0,X$h,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(X$m){this._removePreScrollBar();var X$p=new X$i;X$p.name="scrollBar",X$p.bottom=0,X$m&&" "!=X$m&&(X$p.skin=X$m),this.scrollBar=X$p,this.addChild(X$p),this._setCellChanged()}),X$k(0,X$h,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(X$m){this._repeatX=X$m,this._setCellChanged()}),X$k(0,X$h,"scrollBar",function(){return this._scrollBar},function(X$m){this._scrollBar!=X$m&&(this._scrollBar=X$m)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),X$k(0,X$h,"width",X$m.prototype._$get_width,function(X$m){X$m!=this._width&&(X$B.superSet(X$S,this,"width",X$m),this._setCellChanged())}),X$k(0,X$h,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(X$m){this._repeatY=X$m,this._setCellChanged()}),X$k(0,X$h,"spaceX",function(){return this._spaceX},function(X$m){this._spaceX=X$m,this._setCellChanged()}),X$k(0,X$h,"spaceY",function(){return this._spaceY},function(X$m){this._spaceY=X$m,this._setCellChanged()}),X$k(0,X$h,"selectedIndex",function(){return this._selectedIndex},function(X$m){this._selectedIndex!=X$m&&(this._selectedIndex=X$m,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(X$m),this.startIndex=this._startIndex)}),X$k(0,X$h,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(X$m){this.selectedIndex=this._array.indexOf(X$m)}),X$k(0,X$h,"length",function(){return this._array?this._array.length:0}),X$k(0,X$h,"selection",function(){return this.getCell(this._selectedIndex)},function(X$m){this.selectedIndex=this._startIndex+this._cells.indexOf(X$m)}),X$k(0,X$h,"startIndex",function(){return this._startIndex},function(X$m){this._startIndex=0<X$m?X$m:0,this.callLater(this.renderItems)}),X$k(0,X$h,"array",function(){return this._array},function(X$m){this.runCallLater(this.changeCells),this._array=X$m||[];var X$p=this._array.length;if(this.totalPage=Math.ceil(X$p/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<X$p?this._selectedIndex:X$p-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var X$h=this._isVertical?this.repeatX:this.repeatY,X$P=this._isVertical?this.repeatY:this.repeatX,X$L=Math.ceil(X$p/X$h);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=X$P/X$L,this._scrollBar.setScroll(0,(X$L-X$P)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),X$k(0,X$h,"dataSource",X$m.prototype._$get_dataSource,function(X$m){"number"==typeof(this._dataSource=X$m)&&Math.floor(X$m)==X$m||"string"==typeof X$m?this.selectedIndex=parseInt(X$m):X$m instanceof Array?this.array=X$m:X$B.superSet(X$S,this,"dataSource",X$m)}),X$k(0,X$h,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),X$p}(X$S),X$i=function(X$m){function X$p(){X$p.__super.call(this)}return X$q(X$p,"laya.ui.HScrollBar",X$m),X$p.prototype.initialize=function(){X$m.prototype.initialize.call(this),this.slider.isVertical=!1},X$p}(X$w),X$v=function(X$m){function X$p(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,X$p.__super.call(this),this.width=this.height=100}X$q(X$p,"laya.ui.Panel",X$m);var X$h=X$p.prototype;return X$h.destroy=function(X$m){void 0===X$m&&(X$m=!0),laya.ui.Component.prototype.destroy.call(this,X$m),this._content&&this._content.destroy(X$m),this._vScrollBar&&this._vScrollBar.destroy(X$m),this._hScrollBar&&this._hScrollBar.destroy(X$m),this._vScrollBar=null,this._hScrollBar=null,this._content=null},X$h.destroyChildren=function(){this._content.destroyChildren()},X$h.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new X$S)},X$h.addChild=function(X$m){return X$m.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(X$m)},X$h.onResize=function(){this._setScrollChanged()},X$h.addChildAt=function(X$m,X$p){return X$m.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(X$m,X$p)},X$h.removeChild=function(X$m){return X$m.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(X$m)},X$h.removeChildAt=function(X$m){return this.getChildAt(X$m).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(X$m)},X$h.removeChildren=function(X$m,X$p){return void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=2147483647),this._content.removeChildren(X$m,X$p),this._setScrollChanged(),this},X$h.getChildAt=function(X$m){return this._content.getChildAt(X$m)},X$h.getChildByName=function(X$m){return this._content.getChildByName(X$m)},X$h.getChildIndex=function(X$m){return this._content.getChildIndex(X$m)},X$h.changeScroll=function(){this._scrollChanged=!1;var X$m=this.contentWidth||1,X$p=this.contentHeight||1,X$h=this._vScrollBar,X$P=this._hScrollBar,X$L=X$h&&X$p>this._height,X$q=X$P&&X$m>this._width,X$k=X$L?this._width-X$h.width:this._width,X$Y=X$q?this._height-X$P.height:this._height;X$h&&(X$h.x=this._width-X$h.width,X$h.y=0,X$h.height=this._height-(X$q?X$P.height:0),X$h.scrollSize=Math.max(.033*this._height,1),X$h.thumbPercent=X$Y/X$p,X$h.setScroll(0,X$p-X$Y,X$h.value)),X$P&&(X$P.x=0,X$P.y=this._height-X$P.height,X$P.width=this._width-(X$L?X$h.width:0),X$P.scrollSize=Math.max(.033*this._width,1),X$P.thumbPercent=X$k/X$m,X$P.setScroll(0,X$m-X$k,X$P.value))},X$h.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},X$h.setContentSize=function(X$m,X$p){var X$h=this._content;X$h.width=X$m,X$h.height=X$p,X$h.scrollRect||(X$h.scrollRect=new X$c),X$h.scrollRect.setTo(0,0,X$m,X$p),X$h.scrollRect=X$h.scrollRect},X$h.onScrollBarChange=function(X$m){var X$p=this._content.scrollRect;if(X$p){var X$h=Math.round(X$m.value);X$m.isVertical?X$p.y=X$h:X$p.x=X$h,this._content.scrollRect=X$p}},X$h.scrollTo=function(X$m,X$p){void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),this.vScrollBar&&(this.vScrollBar.value=X$p),this.hScrollBar&&(this.hScrollBar.value=X$m)},X$h.refresh=function(){this.changeScroll()},X$h.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=X$B.superGet(X$S,this,"cacheAs")),X$B.superSet(X$S,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},X$h.onScrollEnd=function(){X$B.superSet(X$S,this,"cacheAs",this._$P.cacheAs)},X$h._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},X$k(0,X$h,"numChildren",function(){return this._content.numChildren}),X$k(0,X$h,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(X$m){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new X$i),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=X$m}),X$k(0,X$h,"contentWidth",function(){for(var X$m=0,X$p=this._content.numChildren-1;-1<X$p;X$p--){var X$h=this._content.getChildAt(X$p);X$m=Math.max(X$h.x+X$h.width*X$h.scaleX,X$m)}return X$m}),X$k(0,X$h,"contentHeight",function(){for(var X$m=0,X$p=this._content.numChildren-1;-1<X$p;X$p--){var X$h=this._content.getChildAt(X$p);X$m=Math.max(X$h.y+X$h.height*X$h.scaleY,X$m)}return X$m}),X$k(0,X$h,"width",X$m.prototype._$get_width,function(X$m){X$B.superSet(X$S,this,"width",X$m),this._setScrollChanged()}),X$k(0,X$h,"hScrollBar",function(){return this._hScrollBar}),X$k(0,X$h,"content",function(){return this._content}),X$k(0,X$h,"height",X$m.prototype._$get_height,function(X$m){X$B.superSet(X$S,this,"height",X$m),this._setScrollChanged()}),X$k(0,X$h,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(X$m){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new X$pm),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=X$m}),X$k(0,X$h,"vScrollBar",function(){return this._vScrollBar}),X$k(0,X$h,"cacheAs",X$m.prototype._$get_cacheAs,function(X$m){X$B.superSet(X$S,this,"cacheAs",X$m),this._$P.cacheAs=null,"none"!==X$m?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),X$p}(X$S),X$g=function(X$m){function X$p(X$m){X$p.__super.call(this,X$m),this.isVertical=!1}return X$q(X$p,"laya.ui.HSlider",X$X),X$p}(),X$t=function(X$m){function X$h(X$m,X$p){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,X$h.__super.call(this),this.skin=X$p,this.labels=X$m}X$q(X$h,"laya.ui.UIGroup",X$m);var X$p=X$h.prototype;return X$B.imps(X$p,{"laya.ui.IItem":!0}),X$p.preinitialize=function(){this.mouseEnabled=!0},X$p.destroy=function(X$m){void 0===X$m&&(X$m=!0),laya.ui.Component.prototype.destroy.call(this,X$m),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},X$p.addItem=function(X$m,X$p){void 0===X$p&&(X$p=!0);var X$h=X$m,X$P=this._items.length;if(X$h.name="item"+X$P,this.addChild(X$h),this.initItems(),X$p&&0<X$P){var X$L=this._items[X$P-1];"horizontal"==this._direction?X$h.x=X$L.x+X$L.width+this._space:X$h.y=X$L.y+X$L.height+this._space}else X$p&&(X$h.x=0,X$h.y=0);return X$P},X$p.delItem=function(X$m,X$p){void 0===X$p&&(X$p=!0);var X$h=this._items.indexOf(X$m);if(-1!=X$h){var X$P=X$m;this.removeChild(X$P);for(var X$L=X$h+1,X$q=this._items.length;X$L<X$q;X$L++){var X$k=this._items[X$L];X$k.name="item"+(X$L-1),X$p&&("horizontal"==this._direction?X$k.x-=X$P.width+this._space:X$k.y-=X$P.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var X$Y;X$Y=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=X$Y}}},X$p.initItems=function(){this._items||(this._items=[]);for(var X$m=this._items.length=0;X$m<1e4;X$m++){var X$p=this.getChildByName("item"+X$m);if(null==X$p)break;this._items.push(X$p),X$p.selected=X$m===this._selectedIndex,X$p.clickHandler=X$R.create(this,this.itemClick,[X$m],!1)}},X$p.itemClick=function(X$m){this.selectedIndex=X$m},X$p.setSelect=function(X$m,X$p){this._items&&-1<X$m&&X$m<this._items.length&&(this._items[X$m].selected=X$p)},X$p.createItem=function(X$m,X$p){return null},X$p.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var X$m=0,X$p=0,X$h=this._items.length;X$p<X$h;X$p++){var X$P=this._items[X$p];this._skin&&(X$P.skin=this._skin),this._labelColors&&(X$P.labelColors=this._labelColors),this._labelSize&&(X$P.labelSize=this._labelSize),this._labelStroke&&(X$P.labelStroke=this._labelStroke),this._labelStrokeColor&&(X$P.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(X$P.strokeColors=this._strokeColors),this._labelBold&&(X$P.labelBold=this._labelBold),this._labelPadding&&(X$P.labelPadding=this._labelPadding),this._labelAlign&&(X$P.labelAlign=this._labelAlign),this._stateNum&&(X$P.stateNum=this._stateNum),this._labelFont&&(X$P.labelFont=this._labelFont),"horizontal"===this._direction?(X$P.y=0,X$P.x=X$m,X$m+=X$P.width+this._space):(X$P.x=0,X$P.y=X$m,X$m+=X$P.height+this._space)}this.changeSize()},X$p.commitMeasure=function(){this.runCallLater(this.changeLabels)},X$p._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},X$k(0,X$p,"labelStrokeColor",function(){return this._labelStrokeColor},function(X$m){this._labelStrokeColor!=X$m&&(this._labelStrokeColor=X$m,this._setLabelChanged())}),X$k(0,X$p,"skin",function(){return this._skin},function(X$m){this._skin!=X$m&&(this._skin=X$m,this._setLabelChanged())}),X$k(0,X$p,"selectedIndex",function(){return this._selectedIndex},function(X$m){this._selectedIndex!=X$m&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=X$m,this.setSelect(X$m,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),X$k(0,X$p,"labels",function(){return this._labels},function(X$m){if(this._labels!=X$m){if(this._labels=X$m,this.removeChildren(),this._setLabelChanged(),this._labels)for(var X$p=this._labels.split(","),X$h=0,X$P=X$p.length;X$h<X$P;X$h++){var X$L=this.createItem(this._skin,X$p[X$h]);X$L.name="item"+X$h,this.addChild(X$L)}this.initItems()}}),X$k(0,X$p,"strokeColors",function(){return this._strokeColors},function(X$m){this._strokeColors!=X$m&&(this._strokeColors=X$m,this._setLabelChanged())}),X$k(0,X$p,"labelColors",function(){return this._labelColors},function(X$m){this._labelColors!=X$m&&(this._labelColors=X$m,this._setLabelChanged())}),X$k(0,X$p,"labelStroke",function(){return this._labelStroke},function(X$m){this._labelStroke!=X$m&&(this._labelStroke=X$m,this._setLabelChanged())}),X$k(0,X$p,"labelSize",function(){return this._labelSize},function(X$m){this._labelSize!=X$m&&(this._labelSize=X$m,this._setLabelChanged())}),X$k(0,X$p,"stateNum",function(){return this._stateNum},function(X$m){this._stateNum!=X$m&&(this._stateNum=X$m,this._setLabelChanged())}),X$k(0,X$p,"labelBold",function(){return this._labelBold},function(X$m){this._labelBold!=X$m&&(this._labelBold=X$m,this._setLabelChanged())}),X$k(0,X$p,"labelFont",function(){return this._labelFont},function(X$m){this._labelFont!=X$m&&(this._labelFont=X$m,this._setLabelChanged())}),X$k(0,X$p,"labelPadding",function(){return this._labelPadding},function(X$m){this._labelPadding!=X$m&&(this._labelPadding=X$m,this._setLabelChanged())}),X$k(0,X$p,"direction",function(){return this._direction},function(X$m){this._direction=X$m,this._setLabelChanged()}),X$k(0,X$p,"space",function(){return this._space},function(X$m){this._space=X$m,this._setLabelChanged()}),X$k(0,X$p,"items",function(){return this._items}),X$k(0,X$p,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(X$m){this.selectedIndex=this._items.indexOf(X$m)}),X$k(0,X$p,"dataSource",X$m.prototype._$get_dataSource,function(X$m){"number"==typeof(this._dataSource=X$m)&&Math.floor(X$m)==X$m||"string"==typeof X$m?this.selectedIndex=parseInt(X$m):X$m instanceof Array?this.labels=X$m.join(","):X$B.superSet(X$S,this,"dataSource",X$m)}),X$h}(X$S),X$O=function(X$p){function X$h(X$m,X$p){this._value=null,void 0===X$p&&(X$p=""),X$h.__super.call(this,X$m,X$p)}X$q(X$h,"laya.ui.Radio",X$p);var X$m=X$h.prototype;return X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,X$m),this._value=null},X$m.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},X$m.initialize=function(){X$p.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},X$m.onClick=function(X$m){this.selected=!0},X$k(0,X$m,"value",function(){return null!=this._value?this._value:this.label},function(X$m){this._value=X$m}),X$h}(X$_),X$C=function(X$m){function X$p(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,X$p.__super.call(this),this.width=this.height=200}X$q(X$p,"laya.ui.Tree",X$m);var X$h=X$p.prototype;return X$B.imps(X$h,{"laya.ui.IRender":!0}),X$h.destroy=function(X$m){void 0===X$m&&(X$m=!0),laya.ui.Component.prototype.destroy.call(this,X$m),this._list&&this._list.destroy(X$m),this._list=null,this._source=null,this._renderHandler=null},X$h.createChildren=function(){this.addChild(this._list=new X$f),this._list.renderHandler=X$R.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},X$h.onListChange=function(X$m){this.event("change")},X$h.getArray=function(){var X$m,X$p=[];for(var X$h in this._source)X$m=this._source[X$h],this.getParentOpenStatus(X$m)&&(X$m.x=this._spaceLeft*this.getDepth(X$m),X$p.push(X$m));return X$p},X$h.getDepth=function(X$m,X$p){return void 0===X$p&&(X$p=0),null==X$m.nodeParent?X$p:this.getDepth(X$m.nodeParent,X$p+1)},X$h.getParentOpenStatus=function(X$m){var X$p=X$m.nodeParent;return null==X$p||!!X$p.isOpen&&(null==X$p.nodeParent||this.getParentOpenStatus(X$p))},X$h.renderItem=function(X$m,X$p){var X$h=X$m.dataSource;if(X$h){X$m.left=X$h.x;var X$P=X$m.getChildByName("arrow");X$P&&(X$h.hasChild?(X$P.visible=!0,X$P.index=X$h.isOpen?1:0,X$P.tag=X$p,X$P.off("click",this,this.onArrowClick),X$P.on("click",this,this.onArrowClick)):X$P.visible=!1);var X$L=X$m.getChildByName("folder");X$L&&(2==X$L.clipY?X$L.index=X$h.isDirectory?0:1:X$L.index=X$h.isDirectory?X$h.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([X$m,X$p])}},X$h.onArrowClick=function(X$m){var X$p=X$m.currentTarget.tag;this._list.array[X$p].isOpen=!this._list.array[X$p].isOpen,this.event("open"),this._list.array=this.getArray()},X$h.setItemState=function(X$m,X$p){this._list.array[X$m]&&(this._list.array[X$m].isOpen=X$p,this._list.array=this.getArray())},X$h.fresh=function(){this._list.array=this.getArray(),this.repaint()},X$h.parseXml=function(X$m,X$p,X$h,X$P){var X$L,X$q=X$m.childNodes,X$k=X$q.length;if(!X$P){X$L={};var X$Y,X$d=X$m.attributes;for(var X$K in X$d){var X$D=(X$Y=X$d[X$K]).nodeName,X$F=X$Y.nodeValue;X$L[X$D]="true"==X$F||"false"!=X$F&&X$F}X$L.nodeParent=X$h,0<X$k&&(X$L.isDirectory=!0),X$L.hasChild=0<X$k,X$p.push(X$L)}for(var X$R=0;X$R<X$k;X$R++){var X$$=X$q[X$R];this.parseXml(X$$,X$p,X$L,!1)}},X$h.parseOpenStatus=function(X$m,X$p){for(var X$h=0,X$P=X$p.length;X$h<X$P;X$h++){var X$L=X$p[X$h];if(X$L.isDirectory)for(var X$q=0,X$k=X$m.length;X$q<X$k;X$q++){var X$Y=X$m[X$q];if(X$Y.isDirectory&&this.isSameParent(X$Y,X$L)&&X$L.label==X$Y.label){X$L.isOpen=X$Y.isOpen;break}}}},X$h.isSameParent=function(X$m,X$p){return null==X$m.nodeParent&&null==X$p.nodeParent||null!=X$m.nodeParent&&null!=X$p.nodeParent&&(X$m.nodeParent.label==X$p.nodeParent.label&&this.isSameParent(X$m.nodeParent,X$p.nodeParent))},X$h.filter=function(X$m){if(Boolean(X$m)){var X$p=[];this.getFilterSource(this._source,X$p,X$m),this._list.array=X$p}else this._list.array=this.getArray()},X$h.getFilterSource=function(X$m,X$p,X$h){var X$P;for(var X$L in X$h=X$h.toLocaleLowerCase(),X$m)!(X$P=X$m[X$L]).isDirectory&&-1<String(X$P.label).toLowerCase().indexOf(X$h)&&(X$P.x=0,X$p.push(X$P)),X$P.child&&0<X$P.child.length&&this.getFilterSource(X$P.child,X$p,X$h)},X$k(0,X$h,"spaceBottom",function(){return this._list.spaceY},function(X$m){this._list.spaceY=X$m}),X$k(0,X$h,"keepStatus",function(){return this._keepStatus},function(X$m){this._keepStatus=X$m}),X$k(0,X$h,"itemRender",function(){return this._list.itemRender},function(X$m){this._list.itemRender=X$m}),X$k(0,X$h,"array",function(){return this._list.array},function(X$m){this._keepStatus&&this._list.array&&X$m&&this.parseOpenStatus(this._list.array,X$m),this._source=X$m,this._list.array=this.getArray()}),X$k(0,X$h,"mouseHandler",function(){return this._list.mouseHandler},function(X$m){this._list.mouseHandler=X$m}),X$k(0,X$h,"dataSource",X$m.prototype._$get_dataSource,function(X$m){this._dataSource=X$m,X$B.superSet(X$S,this,"dataSource",X$m)}),X$k(0,X$h,"source",function(){return this._source}),X$k(0,X$h,"scrollBar",function(){return this._list.scrollBar}),X$k(0,X$h,"list",function(){return this._list}),X$k(0,X$h,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(X$m){this._list.vScrollBarSkin=X$m}),X$k(0,X$h,"renderHandler",function(){return this._renderHandler},function(X$m){this._renderHandler=X$m}),X$k(0,X$h,"selectedIndex",function(){return this._list.selectedIndex},function(X$m){this._list.selectedIndex=X$m}),X$k(0,X$h,"spaceLeft",function(){return this._spaceLeft},function(X$m){this._spaceLeft=X$m}),X$k(0,X$h,"selectedItem",function(){return this._list.selectedItem},function(X$m){this._list.selectedItem=X$m}),X$k(0,X$h,"width",X$m.prototype._$get_width,function(X$m){X$B.superSet(X$S,this,"width",X$m),this._list.width=X$m}),X$k(0,X$h,"height",X$m.prototype._$get_height,function(X$m){X$B.superSet(X$S,this,"height",X$m),this._list.height=X$m}),X$k(0,X$h,"xml",null,function(X$m){var X$p=[];this.parseXml(X$m.childNodes[0],X$p,null,!0),this.array=X$p}),X$k(0,X$h,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),X$p}(X$S),X$mm=function(X$m){function X$p(){this._items=null,this._selectedIndex=0,X$p.__super.call(this),this._setIndexHandler=X$R.create(this,this.setIndex,null,!1)}X$q(X$p,"laya.ui.ViewStack",X$m);var X$h=X$p.prototype;return X$B.imps(X$h,{"laya.ui.IItem":!0}),X$h.setItems=function(X$m){this.removeChildren();for(var X$p=0,X$h=0,X$P=X$m.length;X$h<X$P;X$h++){var X$L=X$m[X$h];X$L&&(X$L.name="item"+X$p,this.addChild(X$L),X$p++)}this.initItems()},X$h.addItem=function(X$m){X$m.name="item"+this._items.length,this.addChild(X$m),this.initItems()},X$h.initItems=function(){this._items=[];for(var X$m=0;X$m<1e4;X$m++){var X$p=this.getChildByName("item"+X$m);if(null==X$p)break;this._items.push(X$p),X$p.visible=X$m==this._selectedIndex}},X$h.setSelect=function(X$m,X$p){this._items&&-1<X$m&&X$m<this._items.length&&(this._items[X$m].visible=X$p)},X$h.setIndex=function(X$m){this.selectedIndex=X$m},X$k(0,X$h,"dataSource",X$m.prototype._$get_dataSource,function(X$m){if("number"==typeof(this._dataSource=X$m)&&Math.floor(X$m)==X$m||"string"==typeof X$m)this.selectedIndex=parseInt(X$m);else for(var X$p in this._dataSource)this.hasOwnProperty(X$p)&&(this[X$p]=this._dataSource[X$p])}),X$k(0,X$h,"selectedIndex",function(){return this._selectedIndex},function(X$m){this._selectedIndex!=X$m&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=X$m,this.setSelect(this._selectedIndex,!0))}),X$k(0,X$h,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(X$m){this.selectedIndex=this._items.indexOf(X$m)}),X$k(0,X$h,"items",function(){return this._items}),X$k(0,X$h,"setIndexHandler",function(){return this._setIndexHandler},function(X$m){this._setIndexHandler=X$m}),X$p}(X$S),X$pm=function(X$m){function X$p(){X$p.__super.call(this)}return X$q(X$p,"laya.ui.VScrollBar",X$w),X$p}(),X$hm=function(X$p){function X$h(X$m){this._bg=null,this._skin=null,X$h.__super.call(this),void 0===X$m&&(X$m=""),this.text=X$m,this.skin=this.skin}X$q(X$h,"laya.ui.TextInput",X$p);var X$m=X$h.prototype;return X$m.preinitialize=function(){this.mouseEnabled=!0},X$m.destroy=function(X$m){X$e.clearCache(this,this._skin),void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,X$m),this._bg&&this._bg.destroy(),this._bg=null},X$m.createChildren=function(){this.addChild(this._tf=new X$$),this._tf.padding=X$j.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},X$m._onFocus=function(){this.event("focus",this)},X$m._onBlur=function(){this.event("blur",this)},X$m._onInput=function(){this.event("input",this)},X$m._onEnter=function(){this.event("enter",this)},X$m.initialize=function(){this.width=128,this.height=22},X$m.select=function(){this._tf.select()},X$m.setSelection=function(X$m,X$p){this._tf.setSelection(X$m,X$p)},X$k(0,X$m,"text",X$p.prototype._$get_text,function(X$m){this._tf.text!=X$m&&(X$m+="",this._tf.text=X$m,this.event("change"))}),X$k(0,X$m,"bg",function(){return this._bg},function(X$m){this.graphics=this._bg=X$m}),X$k(0,X$m,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(X$m){this._tf.inputElementYAdjuster=X$m}),X$k(0,X$m,"multiline",function(){return this._tf.multiline},function(X$m){this._tf.multiline=X$m}),X$k(0,X$m,"skin",function(){return this._skin},function(X$m){this._skin!=X$m&&(X$e.clearCache(this,this._skin),this._skin=X$m,this._bg||(this.graphics=this._bg=new X$M),X$e.keepCache(this,this._skin),this._bg.source=X$e.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),X$k(0,X$m,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(X$m){this._bg||(this.graphics=this._bg=new X$M),this._bg.sizeGrid=X$x.fillArray(X$j.defaultSizeGrid,X$m,Number)}),X$k(0,X$m,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(X$m){this._tf.inputElementXAdjuster=X$m}),X$k(0,X$m,"width",X$p.prototype._$get_width,function(X$m){X$B.superSet(X$G,this,"width",X$m),this._bg&&(this._bg.width=X$m)}),X$k(0,X$m,"height",X$p.prototype._$get_height,function(X$m){X$B.superSet(X$G,this,"height",X$m),this._bg&&(this._bg.height=X$m)}),X$k(0,X$m,"editable",function(){return this._tf.editable},function(X$m){this._tf.editable=X$m}),X$k(0,X$m,"restrict",function(){return this._tf.restrict},function(X$m){this._tf.restrict=X$m}),X$k(0,X$m,"prompt",function(){return this._tf.prompt},function(X$m){this._tf.prompt=X$m}),X$k(0,X$m,"promptColor",function(){return this._tf.promptColor},function(X$m){this._tf.promptColor=X$m}),X$k(0,X$m,"maxChars",function(){return this._tf.maxChars},function(X$m){this._tf.maxChars=X$m}),X$k(0,X$m,"focus",function(){return this._tf.focus},function(X$m){this._tf.focus=X$m}),X$k(0,X$m,"type",function(){return this._tf.type},function(X$m){this._tf.type=X$m}),X$k(0,X$m,"asPassword",function(){return this._tf.asPassword},function(X$m){this._tf.asPassword=X$m}),X$h}(X$G),X$Pm=function(X$m){function X$p(){X$p.__super.call(this)}return X$q(X$p,"laya.ui.VSlider",X$X),X$p}(),X$Lm=function(X$m){function X$P(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,X$P.__super.call(this)}X$q(X$P,"laya.ui.Dialog",X$m);var X$p=X$P.prototype;return X$p.initialize=function(){this.popupEffect=X$P.manager.popupEffectHandler,this.closeEffect=X$P.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},X$p._dealDragArea=function(){var X$m=this.getChildByName("drag");X$m&&(this.dragArea=X$m.x+","+X$m.y+","+X$m.width+","+X$m.height,X$m.removeSelf())},X$p._onClick=function(X$m){var X$p=X$m.target;if(X$p)switch(X$p.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(X$p.name)}},X$p.show=function(X$m,X$p){void 0===X$m&&(X$m=!1),void 0===X$p&&(X$p=!0),this._open(!1,X$m,X$p)},X$p.popup=function(X$m,X$p){void 0===X$m&&(X$m=!1),void 0===X$p&&(X$p=!0),this._open(!0,X$m,X$p)},X$p._open=function(X$m,X$p,X$h){X$P.manager.lock(!1),this.isModal=X$m,X$P.manager.open(this,X$p,X$h)},X$p.onOpened=function(){},X$p.close=function(X$m,X$p){void 0===X$p&&(X$p=!0),X$P.manager.close(this,X$m,X$p)},X$p.onClosed=function(X$m){},X$p._onMouseDown=function(X$m){var X$p=this.getMousePoint();this._dragArea.contains(X$p.x,X$p.y)?this.startDrag():this.stopDrag()},X$k(0,X$p,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(X$m){if(X$m){var X$p=X$x.fillArray([0,0,0,0],X$m,Number);this._dragArea=new X$c(X$p[0],X$p[1],X$p[2],X$p[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),X$k(0,X$p,"isPopup",function(){return null!=this.parent}),X$k(0,X$p,"zOrder",X$m.prototype._$get_zOrder,function(X$m){X$B.superSet(X$r,this,"zOrder",X$m),X$P.manager._checkMask()}),X$k(1,X$P,"manager",function(){return X$P._manager=X$P._manager||new X$N},function(X$m){X$P._manager=X$m}),X$P.setLockView=function(X$m){X$P.manager.setLockView(X$m)},X$P.lock=function(X$m){X$P.manager.lock(X$m)},X$P.closeAll=function(){X$P.manager.closeAll()},X$P.getDialogsByGroup=function(X$m){return X$P.manager.getDialogsByGroup(X$m)},X$P.closeByGroup=function(X$m){return X$P.manager.closeByGroup(X$m)},X$P.CLOSE="close",X$P.CANCEL="cancel",X$P.SURE="sure",X$P.NO="no",X$P.OK="ok",X$P.YES="yes",X$P._manager=null,X$P}(X$r),X$qm=function(X$m){function X$p(){X$p.__super.call(this)}X$q(X$p,"laya.ui.HBox",X$m);var X$h=X$p.prototype;return X$h.sortItem=function(X$m){X$m&&X$m.sort(function(X$m,X$p){return X$m.x-X$p.x})},X$h.changeItems=function(){this._itemChanged=!1;for(var X$m=[],X$p=0,X$h=0,X$P=this.numChildren;X$h<X$P;X$h++){var X$L=this.getChildAt(X$h);X$L&&X$L.layoutEnabled&&(X$m.push(X$L),X$p=this._height?this._height:Math.max(X$p,X$L.height*X$L.scaleY))}this.sortItem(X$m);var X$q=0;for(X$h=0,X$P=X$m.length;X$h<X$P;X$h++)(X$L=X$m[X$h]).x=X$q,X$q+=X$L.width*X$L.scaleX+this._space,"top"==this._align?X$L.y=0:"middle"==this._align?X$L.y=.5*(X$p-X$L.height*X$L.scaleY):"bottom"==this._align&&(X$L.y=X$p-X$L.height*X$L.scaleY);this.changeSize()},X$k(0,X$h,"height",X$m.prototype._$get_height,function(X$m){this._height!=X$m&&(X$B.superSet(X$V,this,"height",X$m),this.callLater(this.changeItems))}),X$p.NONE="none",X$p.TOP="top",X$p.MIDDLE="middle",X$p.BOTTOM="bottom",X$p}(X$V),X$km=function(X$m){function X$p(){X$p.__super.call(this)}X$q(X$p,"laya.ui.VBox",X$m);var X$h=X$p.prototype;return X$h.changeItems=function(){this._itemChanged=!1;for(var X$m=[],X$p=0,X$h=0,X$P=this.numChildren;X$h<X$P;X$h++){var X$L=this.getChildAt(X$h);X$L&&X$L.layoutEnabled&&(X$m.push(X$L),X$p=this._width?this._width:Math.max(X$p,X$L.width*X$L.scaleX))}this.sortItem(X$m);var X$q=0;for(X$h=0,X$P=X$m.length;X$h<X$P;X$h++)(X$L=X$m[X$h]).y=X$q,X$q+=X$L.height*X$L.scaleY+this._space,"left"==this._align?X$L.x=0:"center"==this._align?X$L.x=.5*(X$p-X$L.width*X$L.scaleX):"right"==this._align&&(X$L.x=X$p-X$L.width*X$L.scaleX);this.changeSize()},X$k(0,X$h,"width",X$m.prototype._$get_width,function(X$m){this._width!=X$m&&(X$B.superSet(X$V,this,"width",X$m),this.callLater(this.changeItems))}),X$p.NONE="none",X$p.LEFT="left",X$p.CENTER="center",X$p.RIGHT="right",X$p}(X$V),X$Ym=function(X$m){function X$p(){X$p.__super.call(this)}return X$q(X$p,"laya.ui.RadioGroup",X$t),X$p.prototype.createItem=function(X$m,X$p){return new X$O(X$m,X$p)},X$p}(),X$dm=function(X$m){function X$p(){X$p.__super.call(this)}return X$q(X$p,"laya.ui.Tab",X$t),X$p.prototype.createItem=function(X$m,X$p){return new X$_(X$m,X$p)},X$p}(),X$Km=function(X$p){function X$h(X$m){this._vScrollBar=null,this._hScrollBar=null,void 0===X$m&&(X$m=""),X$h.__super.call(this,X$m)}X$q(X$h,"laya.ui.TextArea",X$p);var X$m=X$h.prototype;return X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,X$m),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},X$m.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},X$m.onVBarChanged=function(X$m){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},X$m.onHBarChanged=function(X$m){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},X$m.changeScroll=function(){var X$m=this._vScrollBar&&0<this._tf.maxScrollY,X$p=this._hScrollBar&&0<this._tf.maxScrollX,X$h=X$m?this._width-this._vScrollBar.width:this._width,X$P=X$p?this._height-this._hScrollBar.height:this._height,X$L=this._tf.padding||X$j.labelPadding;this._tf.width=X$h,this._tf.height=X$P,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-X$L[2],this._vScrollBar.y=X$L[1],this._vScrollBar.height=this._height-(X$p?this._hScrollBar.height:0)-X$L[1]-X$L[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=X$P/Math.max(this._tf.textHeight,X$P),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=X$m),this._hScrollBar&&(this._hScrollBar.x=X$L[0],this._hScrollBar.y=this._height-this._hScrollBar.height-X$L[3],this._hScrollBar.width=this._width-(X$m?this._vScrollBar.width:0)-X$L[0]-X$L[2],this._hScrollBar.scrollSize=Math.max(.033*X$h,1),this._hScrollBar.thumbPercent=X$h/Math.max(this._tf.textWidth,X$h),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=X$p)},X$m.scrollTo=function(X$m){this.commitMeasure(),this._tf.scrollY=X$m},X$k(0,X$m,"scrollY",function(){return this._tf.scrollY}),X$k(0,X$m,"width",X$p.prototype._$get_width,function(X$m){X$B.superSet(X$hm,this,"width",X$m),this.callLater(this.changeScroll)}),X$k(0,X$m,"hScrollBar",function(){return this._hScrollBar}),X$k(0,X$m,"height",X$p.prototype._$get_height,function(X$m){X$B.superSet(X$hm,this,"height",X$m),this.callLater(this.changeScroll)}),X$k(0,X$m,"maxScrollX",function(){return this._tf.maxScrollX}),X$k(0,X$m,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(X$m){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new X$pm),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=X$m}),X$k(0,X$m,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(X$m){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new X$i),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=X$m}),X$k(0,X$m,"vScrollBar",function(){return this._vScrollBar}),X$k(0,X$m,"maxScrollY",function(){return this._tf.maxScrollY}),X$k(0,X$m,"scrollX",function(){return this._tf.scrollX}),X$h}(X$hm);!function(X$m){function X$p(){this._uiView=null,this.isCloseOther=!1,X$p.__super.call(this)}X$q(X$p,"laya.ui.AsynDialog",X$Lm);var X$h=X$p.prototype;X$h.createView=function(X$m){this._uiView=X$m},X$h._open=function(X$m,X$p,X$h){this.isModal=X$m,this.isCloseOther=X$p,X$Lm.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},X$h.onCreated=function(){this.createUI(),this.onOpen()},X$h.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},X$h.onOpen=function(){X$Lm.manager.open(this,this.isCloseOther),X$Lm.manager.lock(!1)},X$h.close=function(X$m,X$p){void 0===X$p&&(X$p=!0),X$Lm.manager.close(this),this.onClose()},X$h.onClose=function(){},X$h.destroy=function(X$m){void 0===X$m&&(X$m=!0),laya.ui.View.prototype.destroy.call(this,X$m),this._uiView=null,this.onDestroy()},X$h.onDestroy=function(){}}();X$B.__init([X$r])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(X$m,X$p){"use strict";for(var X$h in Object.defineProperty(X$p,"__esModule",{value:!0}),Laya){var X$P=Laya[X$h];X$P&&X$P.__isclass&&(X$p[X$h]=X$P)}}),function(X$R,X$m,X$H){X$H.un,X$H.uns;var X$F=X$H.static,X$$=X$H.class,X$A=X$H.getset,X$P=X$H.__newvec,X$Z=laya.maths.Arith,X$k=laya.webgl.atlas.AtlasResourceManager,X$h=laya.webgl.shader.BaseShader,X$u=laya.utils.Browser,X$Y=laya.webgl.utils.Buffer,X$W=laya.utils.Byte,X$L=laya.utils.ClassUtils,X$d=X$H.Config,X$q=(laya.events.Event,laya.events.EventDispatcher),X$j=laya.utils.Handler,X$c=laya.net.Loader,X$p=laya.net.LoaderManager,X$K=(laya.maths.MathUtil,laya.display.Node),X$B=laya.renders.Render,X$D=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),X$n=laya.resource.Resource,X$e=laya.utils.RunDriver,X$a=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),X$E=laya.display.Sprite,X$I=laya.utils.Stat,X$b=laya.utils.StringKey,X$x=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),X$T=laya.utils.Utils,X$Q=laya.webgl.WebGL,X$M=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;X$H.interface("laya.d3.core.IClone"),X$H.interface("laya.d3.graphics.IVertex"),X$H.interface("laya.d3.core.render.IUpdate"),X$H.interface("laya.d3.core.scene.ITreeNode"),X$H.interface("laya.d3.core.render.IRenderable");(function(){function X$_(){}X$$(X$_,"laya.d3.animation.AnimationClipParser01"),X$_.READ_DATA=function(){X$_._DATA.offset=X$_._reader.getUint32(),X$_._DATA.size=X$_._reader.getUint32()},X$_.READ_BLOCK=function(){for(var X$m=X$_._BLOCK.count=X$_._reader.getUint16(),X$p=X$_._BLOCK.blockStarts=[],X$h=X$_._BLOCK.blockLengths=[],X$P=0;X$P<X$m;X$P++)X$p.push(X$_._reader.getUint32()),X$h.push(X$_._reader.getUint32())},X$_.READ_STRINGS=function(){var X$m=X$_._reader.getUint32(),X$p=X$_._reader.getUint16(),X$h=X$_._reader.pos;X$_._reader.pos=X$m+X$_._DATA.offset;for(var X$P=0;X$P<X$p;X$P++)X$_._strings[X$P]=X$_._reader.readUTFString();X$_._reader.pos=X$h},X$_.parse=function(X$m,X$p){X$_._animationClip=X$m;(X$_._reader=X$p).__getBuffer();X$_.READ_DATA(),X$_.READ_BLOCK(),X$_.READ_STRINGS();for(var X$h=0,X$P=X$_._BLOCK.count;X$h<X$P;X$h++){var X$L=X$p.getUint16(),X$q=X$_._strings[X$L],X$k=X$_["READ_"+X$q];if(null==X$k)throw new Error("model file err,no this function:"+X$L+" "+X$q);X$k.call()}},X$_.READ_ANIMATIONS=function(){var X$m,X$p=0,X$h=0,X$P=X$_._reader,X$L=X$P.__getBuffer(),X$q=[],X$k=X$P.getUint8();for(X$q.length=X$k,X$p=0;X$p<X$k;X$p++)X$q[X$p]=X$P.getUint16();var X$Y=[],X$d=X$P.getUint16();for(X$Y.length=X$d,X$p=0;X$p<X$d;X$p++)X$Y[X$p]=X$P.getFloat32();var X$K=X$_._animationClip;X$K.name=X$_._strings[X$P.getUint16()];var X$D=X$K._duration=X$P.getFloat32();X$K.islooping=!!X$P.getByte(),X$K._frameRate=X$P.getInt16();var X$F=X$P.getInt16(),X$R=X$K._nodes=new Array;X$R.length=X$F,(X$K._publicClipDatas=[]).length=X$F;var X$$=X$K._nodesMap={},X$A=0,X$B=0;for(X$p=0;X$p<X$F;X$p++){X$m=X$R[X$p]=new X$U;var X$n=X$P.getUint16(),X$c=X$m.path=[];for(X$c.length=X$n,X$h=0;X$h<X$n;X$h++)X$c[X$h]=X$_._strings[X$P.getUint16()];var X$e=X$c.join("/"),X$a=X$$[X$e];X$a||(X$$[X$e]=X$a=[]),X$a.push(X$m);var X$Z=X$P.getInt16();-1!==X$Z&&(X$m.componentType=X$_._strings[X$Z]);var X$H=X$s._propertyIndexDic[X$_._strings[X$P.getUint16()]];if(null==X$H)throw new Error("AnimationClipParser01:unknown property name.");var X$W=X$H<4,X$E=!X$W||X$W&&""===X$c[0];(X$m._cacheProperty=X$E)?X$A++:X$B++,X$m.propertyNameID=X$H;var X$I=X$q[X$P.getUint8()];X$m.keyFrameWidth=X$I/4;var X$b=X$m.keyFrames=[],X$T=X$b.length=X$P.getUint16(),X$j=null,X$x=NaN;for(X$h=0;X$h<X$T;X$h++){var X$Q=X$b[X$h]=new X$G;X$x=X$Q.startTime=X$Y[X$P.getUint16()];var X$M=X$P.pos;X$Q.inTangent=new Float32Array(X$L.slice(X$M,X$M+X$I)),X$P.pos+=X$I,X$M=X$P.pos,X$Q.outTangent=new Float32Array(X$L.slice(X$M,X$M+X$I)),X$P.pos+=X$I,X$M=X$P.pos,X$Q.data=new Float32Array(X$L.slice(X$M,X$M+X$I)),X$P.pos+=X$I,X$j&&(X$j.next=X$Q,X$j.duration=X$x-X$j.startTime),X$j=X$Q}X$Q.next=null,X$Q.duration=X$D-X$x}var X$u=X$K._nodeToCachePropertyMap=new Int32Array(X$F),X$N=X$K._cachePropertyMap=new Int32Array(X$A),X$S=X$K._unCachePropertyMap=new Int32Array(X$B);for(X$A=X$B=0,X$p=0;X$p<X$F;X$p++)(X$m=X$R[X$p])._cacheProperty?(X$u[X$p]=X$A,X$N[X$A++]=X$p):X$S[X$B++]=X$p},X$_._animationClip=null,X$_._reader=null,X$_._strings=[],X$F(X$_,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function X$w(){}X$$(X$w,"laya.d3.animation.AnimationClipParser02"),X$w.READ_DATA=function(){X$w._DATA.offset=X$w._reader.getUint32(),X$w._DATA.size=X$w._reader.getUint32()},X$w.READ_BLOCK=function(){for(var X$m=X$w._BLOCK.count=X$w._reader.getUint16(),X$p=X$w._BLOCK.blockStarts=[],X$h=X$w._BLOCK.blockLengths=[],X$P=0;X$P<X$m;X$P++)X$p.push(X$w._reader.getUint32()),X$h.push(X$w._reader.getUint32())},X$w.READ_STRINGS=function(){var X$m=X$w._reader.getUint32(),X$p=X$w._reader.getUint16(),X$h=X$w._reader.pos;X$w._reader.pos=X$m+X$w._DATA.offset;for(var X$P=0;X$P<X$p;X$P++)X$w._strings[X$P]=X$w._reader.readUTFString();X$w._reader.pos=X$h},X$w.parse=function(X$m,X$p){X$w._animationClip=X$m;(X$w._reader=X$p).__getBuffer();X$w.READ_DATA(),X$w.READ_BLOCK(),X$w.READ_STRINGS();for(var X$h=0,X$P=X$w._BLOCK.count;X$h<X$P;X$h++){var X$L=X$p.getUint16(),X$q=X$w._strings[X$L],X$k=X$w["READ_"+X$q];if(null==X$k)throw new Error("model file err,no this function:"+X$L+" "+X$q);X$k.call()}},X$w.READ_ANIMATIONS=function(){var X$m,X$p=0,X$h=0,X$P=X$w._reader,X$L=X$P.__getBuffer(),X$q=[],X$k=X$P.getUint8();for(X$q.length=X$k,X$p=0;X$p<X$k;X$p++)X$q[X$p]=X$P.getUint16();var X$Y=[],X$d=X$P.getUint16();for(X$Y.length=X$d,X$p=0;X$p<X$d;X$p++)X$Y[X$p]=X$P.getFloat32();var X$K=X$w._animationClip;X$K.name=X$w._strings[X$P.getUint16()];var X$D=X$K._duration=X$P.getFloat32();X$K.islooping=!!X$P.getByte(),X$K._frameRate=X$P.getInt16();var X$F=X$P.getInt16(),X$R=X$K._nodes=new Array;X$R.length=X$F,(X$K._publicClipDatas=[]).length=X$F;var X$$=X$K._nodesMap={},X$A=0,X$B=0;for(X$p=0;X$p<X$F;X$p++){X$m=X$R[X$p]=new X$U;var X$n=X$P.getUint16(),X$c=X$m.path=[];for(X$c.length=X$n,X$h=0;X$h<X$n;X$h++)X$c[X$h]=X$w._strings[X$P.getUint16()];var X$e=X$c.join("/"),X$a=X$$[X$e];X$a||(X$$[X$e]=X$a=[]),X$a.push(X$m);var X$Z=X$P.getInt16();-1!==X$Z&&(X$m.componentType=X$w._strings[X$Z]);var X$H=X$s._propertyIndexDic[X$w._strings[X$P.getUint16()]];if(null==X$H)throw new Error("AnimationClipParser02:unknown property name.");var X$W=X$H<4,X$E=!X$W||X$W&&""===X$c[0];(X$m._cacheProperty=X$E)?X$A++:X$B++,X$m.propertyNameID=X$H;var X$I=X$q[X$P.getUint8()];X$m.keyFrameWidth=X$I/4;var X$b=X$m.keyFrames=[],X$T=X$b.length=X$P.getUint16(),X$j=null,X$x=NaN;for(X$h=0;X$h<X$T;X$h++){var X$Q=X$b[X$h]=new X$G;X$x=X$Q.startTime=X$Y[X$P.getUint16()];var X$M=X$P.pos;X$Q.inTangent=new Float32Array(X$L.slice(X$M,X$M+X$I)),X$P.pos+=X$I,X$M=X$P.pos,X$Q.outTangent=new Float32Array(X$L.slice(X$M,X$M+X$I)),X$P.pos+=X$I,X$M=X$P.pos,X$Q.data=new Float32Array(X$L.slice(X$M,X$M+X$I)),X$P.pos+=X$I,X$j&&(X$j.next=X$Q,X$j.duration=X$x-X$j.startTime),X$j=X$Q}X$Q.next=null,X$Q.duration=X$D-X$x}var X$u=X$P.getUint16();for(X$p=0;X$p<X$u;X$p++){var X$N,X$S=new X$X;X$S.time=X$P.getFloat32(),X$S.eventName=X$w._strings[X$P.getUint16()];var X$_=X$P.getUint16();for(0<X$_&&(X$S.params=X$N=[]),X$h=0;X$h<X$_;X$h++){switch(X$P.getByte()){case 0:X$N.push(!!X$P.getByte());break;case 1:X$N.push(X$P.getInt32());break;case 2:X$N.push(X$P.getFloat32());break;case 3:X$N.push(X$w._strings[X$P.getUint16()]);break;default:throw new Error("unknown type.")}}X$K.addEvent(X$S)}var X$l=X$K._nodeToCachePropertyMap=new Int32Array(X$F),X$J=X$K._cachePropertyMap=new Int32Array(X$A),X$z=X$K._unCachePropertyMap=new Int32Array(X$B);for(X$A=X$B=0,X$p=0;X$p<X$F;X$p++)(X$m=X$R[X$p])._cacheProperty?(X$l[X$p]=X$A,X$J[X$A++]=X$p):X$z[X$B++]=X$p},X$w._animationClip=null,X$w._reader=null,X$w._strings=[],X$F(X$w,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var X$X=function(){function X$m(){this.time=NaN,this.eventName=null,this.params=null}return X$$(X$m,"laya.d3.animation.AnimationEvent"),X$m}(),X$s=function(){function X$P(){this._childs=[],this.transform=new X$ep(this)}X$$(X$P,"laya.d3.animation.AnimationNode");var X$m=X$P.prototype;return X$H.imps(X$m,{"laya.d3.core.IClone":!0}),X$m.addChild=function(X$m){X$m._parent=this,X$m.transform.setParent(this.transform),this._childs.push(X$m)},X$m.removeChild=function(X$m){var X$p=this._childs.indexOf(X$m);-1!==X$p&&this._childs.splice(X$p,1)},X$m.getChildByName=function(X$m){for(var X$p=0,X$h=this._childs.length;X$p<X$h;X$p++){var X$P=this._childs[X$p];if(X$P.name===X$m)return X$P}return null},X$m.getChildByIndex=function(X$m){return this._childs[X$m]},X$m.getChildCount=function(){return this._childs.length},X$m.cloneTo=function(X$m){var X$p=X$m;X$p.name=this.name;for(var X$h=0,X$P=this._childs.length;X$h<X$P;X$h++){var X$L=this._childs[X$h],X$q=X$L.clone();X$p.addChild(X$q);var X$k=X$L.transform,X$Y=X$q.transform;X$Y.setLocalPosition(X$k.getLocalPosition()),X$Y.setLocalRotation(X$k.getLocalRotation()),X$Y.setLocalScale(X$k.getLocalScale()),X$Y._localRotationEuler=X$k._localRotationEuler,X$Y._setWorldMatrixIgnoreUpdate(X$k.getWorldMatrix())}},X$m.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$P.__init__=function(){X$P.registerAnimationNodeProperty("localPosition",X$P._getLocalPosition,X$P._setLocalPosition),X$P.registerAnimationNodeProperty("localRotation",X$P._getLocalRotation,X$P._setLocalRotation),X$P.registerAnimationNodeProperty("localScale",X$P._getLocalScale,X$P._setLocalScale),X$P.registerAnimationNodeProperty("localRotationEuler",X$P._getLocalRotationEuler,X$P._setLocalRotationEuler),X$P.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",X$P._getParticleRenderSharedMaterialTintColor,X$P._setParticleRenderSharedMaterialTintColor),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",X$P._getMeshRenderSharedMaterialTilingOffset,X$P._setMeshRenderSharedMaterialTilingOffset),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",X$P._getMeshRenderSharedMaterialAlbedo,X$P._setMeshRenderSharedMaterialAlbedo),X$P.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",X$P._getSkinnedMeshRenderSharedMaterialTilingOffset,X$P._setSkinnedMeshRenderSharedMaterialTilingOffset),X$P.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",X$P._getSkinnedMeshRenderSharedMaterialAlbedo,X$P._setSkinnedMeshRenderSharedMaterialAlbedo),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",X$P._getMeshRenderSharedMaterialAlbedo,X$P._setMeshRenderSharedMaterialAlbedo),X$P.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",X$P._getSkinnedMeshRenderSharedMaterialAlbedo,X$P._setSkinnedMeshRenderSharedMaterialAlbedo),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",X$P._getMeshRenderSharedMaterialIntensity,X$P._setMeshRenderSharedMaterialIntensity),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",X$P._getMeshRenderSharedMaterialAlpha,X$P._setMeshRenderSharedMaterialAlpha),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",X$P._getMeshRenderSharedMaterialAlphaColor,X$P._setMeshRenderSharedMaterialAlphaColor),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",X$P._getMeshRenderSharedMaterialBaseColor,X$P._setMeshRenderSharedMaterialBaseColor),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",X$P._getMeshRenderSharedMaterialDissolve,X$P._setMeshRenderSharedMaterialDissolve),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",X$P._getMeshRenderSharedMaterialDissolveSpeed,X$P._setMeshRenderSharedMaterialDissolveSpeed),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",X$P._getMeshRenderSharedMaterialMMultiplier,X$P._setMeshRenderSharedMaterialMMultiplier),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",X$P._getMeshRenderSharedMaterialBaseScrollSpeedX,X$P._setMeshRenderSharedMaterialBaseScrollSpeedX),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",X$P._getMeshRenderSharedMaterialBaseScrollSpeedY,X$P._setMeshRenderSharedMaterialBaseScrollSpeedY),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",X$P._getMeshRenderSharedMaterialSecondScrollSpeedX,X$P._setMeshRenderSharedMaterialSecondScrollSpeedX),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",X$P._getMeshRenderSharedMaterialSecondScrollSpeedY,X$P._setMeshRenderSharedMaterialSecondScrollSpeedY),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",X$P._getMeshRenderSharedMaterialDetailTilingOffset,X$P._setMeshRenderSharedMaterialDetailTilingOffset),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",X$P._getMeshRenderSharedMaterialDissolveTilingOffset,X$P._setMeshRenderSharedMaterialDissolveTilingOffset),X$P.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",X$P._getMeshRenderSharedMaterialMaskTilingOffset,X$P._setMeshRenderSharedMaterialMaskTilingOffset)},X$P.registerAnimationNodeProperty=function(X$m,X$p,X$h){if(X$P._propertyIndexDic[X$m])throw new Error("AnimationNode: this propertyName has registered.");X$P._propertyIndexDic[X$m]=X$P._propertyIDCounter,X$P._propertyGetFuncs[X$P._propertyIDCounter]=X$p,X$P._propertySetFuncs[X$P._propertyIDCounter]=X$h,X$P._propertyIDCounter++},X$P._getLocalPosition=function(X$m,X$p){return X$m?X$m.transform.getLocalPosition():X$p._transform.localPosition.elements},X$P._setLocalPosition=function(X$m,X$p,X$h){if(X$m)X$m.transform.setLocalPosition(X$h);else{var X$P=X$p._transform,X$L=X$P.localPosition;X$L.elements=X$h,X$P.localPosition=X$L}},X$P._getLocalRotation=function(X$m,X$p){return X$m?X$m.transform.getLocalRotation():X$p._transform.localRotation.elements},X$P._setLocalRotation=function(X$m,X$p,X$h){if(X$m)X$m.transform.setLocalRotation(X$h);else{var X$P=X$p._transform,X$L=X$P.localRotation;X$L.elements=X$h,X$P.localRotation=X$L}},X$P._getLocalScale=function(X$m,X$p){return X$m?X$m.transform.getLocalScale():X$p._transform.localScale.elements},X$P._setLocalScale=function(X$m,X$p,X$h){if(X$m)X$m.transform.setLocalScale(X$h);else{var X$P=X$p._transform,X$L=X$P.localScale;X$L.elements=X$h,X$P.localScale=X$L}},X$P._getLocalRotationEuler=function(X$m,X$p){return X$m?X$m.transform.getLocalRotationEuler():X$p._transform.localRotationEuler.elements},X$P._setLocalRotationEuler=function(X$m,X$p,X$h){if(X$m)X$m.transform.setLocalRotationEuler(X$h);else{var X$P=X$p._transform,X$L=X$P.localRotationEuler;X$L.elements=X$h,X$P.localRotationEuler=X$L}},X$P._getMeshRenderSharedMaterialTilingOffset=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return X$p.meshRender.sharedMaterial.tilingOffset.elements},X$P._setMeshRenderSharedMaterialTilingOffset=function(X$m,X$p,X$h){var X$P,X$L;if(X$m){var X$q=X$m.transform._entity;X$q&&((X$L=(X$P=X$q.owner.meshRender.material).tilingOffset).elements=X$h,X$P.tilingOffset=X$L)}else(X$L=(X$P=X$p.meshRender.material).tilingOffset).elements=X$h,X$P.tilingOffset=X$L},X$P._getMeshRenderSharedMaterialAlbedo=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.albedoColor.elements:null}return X$p.meshRender.sharedMaterial.albedoColor.elements},X$P._setMeshRenderSharedMaterialAlbedo=function(X$m,X$p,X$h){var X$P,X$L;if(X$m){var X$q=X$m.transform._entity;X$q&&((X$L=(X$P=X$q.owner.meshRender.material).albedoColor).elements=X$h,X$P.albedoColor=X$L)}else(X$L=(X$P=X$p.meshRender.material).albedoColor).elements=X$h,X$P.albedoColor=X$L},X$P._getSkinnedMeshRenderSharedMaterialTilingOffset=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return X$p.skinnedMeshRender.sharedMaterial.tilingOffset.elements},X$P._setSkinnedMeshRenderSharedMaterialTilingOffset=function(X$m,X$p,X$h){var X$P,X$L;if(X$m){var X$q=X$m.transform._entity;X$q&&((X$L=(X$P=X$q.owner.skinnedMeshRender.material).tilingOffset).elements=X$h,X$P.tilingOffset=X$L)}else(X$L=(X$P=X$p.skinnedMeshRender.material).tilingOffset).elements=X$h,X$P.tilingOffset=X$L},X$P._getSkinnedMeshRenderSharedMaterialAlbedo=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return X$p.skinnedMeshRender.sharedMaterial.albedoColor.elements},X$P._setSkinnedMeshRenderSharedMaterialAlbedo=function(X$m,X$p,X$h){var X$P,X$L;if(X$m){var X$q=X$m.transform._entity;X$q&&((X$L=(X$P=X$q.owner.skinnedMeshRender.material).albedoColor).elements=X$h,X$P.albedoColor=X$L)}else(X$L=(X$P=X$p.skinnedMeshRender.material).albedoColor).elements=X$h,X$P.albedoColor=X$L},X$P._getParticleRenderSharedMaterialTintColor=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.particleRender.sharedMaterial.tintColor.elements:null}return X$p.particleRender.sharedMaterial.tintColor.elements},X$P._setParticleRenderSharedMaterialTintColor=function(X$m,X$p,X$h){var X$P,X$L;if(X$m){var X$q=X$m.transform._entity;X$q&&((X$L=(X$P=X$q.owner.particleRender.material).tintColor).elements=X$h,X$P.tintColor=X$L)}else(X$L=(X$P=X$p.particleRender.material).tintColor).elements=X$h,X$P.tintColor=X$L},X$P._getMeshRenderSharedMaterialAlphaColor=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.alphaColor.elements:null}return X$p.meshRender.sharedMaterial.alphaColor.elements},X$P._setMeshRenderSharedMaterialAlphaColor=function(X$m,X$p,X$h){var X$P,X$L;if(X$m){var X$q=X$m.transform._entity;X$q&&((X$L=(X$P=X$q.owner.meshRender.material).alphaColor).elements=X$h,X$P.alphaColor=X$L)}else(X$L=(X$P=X$p.meshRender.material).alphaColor).elements=X$h,X$P.alphaColor=X$L},X$P._getMeshRenderSharedMaterialBaseColor=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.baseColor.elements:null}return X$p.meshRender.sharedMaterial.baseColor.elements},X$P._setMeshRenderSharedMaterialBaseColor=function(X$m,X$p,X$h){var X$P,X$L;if(X$m){var X$q=X$m.transform._entity;X$q&&((X$L=(X$P=X$q.owner.meshRender.material).baseColor).elements=X$h,X$P.baseColor=X$L)}else(X$L=(X$P=X$p.meshRender.material).baseColor).elements=X$h,X$P.baseColor=X$L},X$P._getMeshRenderSharedMaterialDissolve=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.dissolve:0}return X$p.meshRender.sharedMaterial.dissolve},X$P._setMeshRenderSharedMaterialDissolve=function(X$m,X$p,X$h){if(X$m){var X$P=X$m.transform._entity;X$P&&(X$P.owner.meshRender.material.dissolve=X$h[0])}else X$p.meshRender.material.dissolve=X$h[0]},X$P._getMeshRenderSharedMaterialDissolveSpeed=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.dissolveSpeed:0}return X$p.meshRender.sharedMaterial.dissolveSpeed},X$P._setMeshRenderSharedMaterialDissolveSpeed=function(X$m,X$p,X$h){if(X$m){var X$P=X$m.transform._entity;X$P&&(X$P.owner.meshRender.material.dissolveSpeed=X$h[0])}else X$p.meshRender.material.dissolveSpeed=X$h[0]},X$P._getMeshRenderSharedMaterialMMultiplier=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.mMultiplier:0}return X$p.meshRender.sharedMaterial.mMultiplier},X$P._setMeshRenderSharedMaterialMMultiplier=function(X$m,X$p,X$h){if(X$m){var X$P=X$m.transform._entity;X$P&&(X$P.owner.meshRender.material.mMultiplier=X$h[0])}else X$p.meshRender.material.mMultiplier=X$h[0]},X$P._getMeshRenderSharedMaterialBaseScrollSpeedX=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return X$p.meshRender.sharedMaterial.baseScrollSpeedX},X$P._setMeshRenderSharedMaterialBaseScrollSpeedX=function(X$m,X$p,X$h){if(X$m){var X$P=X$m.transform._entity;X$P&&(X$P.owner.meshRender.material.baseScrollSpeedX=X$h[0])}else X$p.meshRender.material.baseScrollSpeedX=X$h[0]},X$P._getMeshRenderSharedMaterialBaseScrollSpeedY=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return X$p.meshRender.sharedMaterial.baseScrollSpeedY},X$P._setMeshRenderSharedMaterialBaseScrollSpeedY=function(X$m,X$p,X$h){if(X$m){var X$P=X$m.transform._entity;X$P&&(X$P.owner.meshRender.material.baseScrollSpeedY=X$h[0])}else X$p.meshRender.material.baseScrollSpeedY=X$h[0]},X$P._getMeshRenderSharedMaterialSecondScrollSpeedX=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return X$p.meshRender.sharedMaterial.secondScrollSpeedX},X$P._setMeshRenderSharedMaterialSecondScrollSpeedX=function(X$m,X$p,X$h){if(X$m){var X$P=X$m.transform._entity;X$P&&(X$P.owner.meshRender.material.secondScrollSpeedX=X$h[0])}else X$p.meshRender.material.secondScrollSpeedX=X$h[0]},X$P._getMeshRenderSharedMaterialSecondScrollSpeedY=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return X$p.meshRender.sharedMaterial.secondScrollSpeedY},X$P._setMeshRenderSharedMaterialSecondScrollSpeedY=function(X$m,X$p,X$h){if(X$m){var X$P=X$m.transform._entity;X$P&&(X$P.owner.meshRender.material.secondScrollSpeedY=X$h[0])}else X$p.meshRender.material.secondScrollSpeedY=X$h[0]},X$P._getMeshRenderSharedMaterialAlpha=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.alpha:0}return X$p.meshRender.sharedMaterial.alpha},X$P._setMeshRenderSharedMaterialAlpha=function(X$m,X$p,X$h){if(X$m){var X$P=X$m.transform._entity;X$P&&(X$P.owner.meshRender.material.alpha=X$h[0])}else X$p.meshRender.material.alpha=X$h[0]},X$P._getMeshRenderSharedMaterialIntensity=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.intensity:0}return X$p.meshRender.sharedMaterial.intensity},X$P._setMeshRenderSharedMaterialIntensity=function(X$m,X$p,X$h){if(X$m){var X$P=X$m.transform._entity;X$P&&(X$P.owner.meshRender.material.intensity=X$h[0])}else X$p.meshRender.material.intensity=X$h[0]},X$P._getMeshRenderSharedMaterialDetailTilingOffset=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return X$p.meshRender.sharedMaterial.detailTilingOffset.elements},X$P._setMeshRenderSharedMaterialDetailTilingOffset=function(X$m,X$p,X$h){var X$P,X$L;if(X$m){var X$q=X$m.transform._entity;X$q&&((X$L=(X$P=X$q.owner.meshRender.material).detailTilingOffset).elements=X$h,X$P.detailTilingOffset=X$L)}else(X$L=(X$P=X$p.meshRender.material).detailTilingOffset).elements=X$h,X$P.detailTilingOffset=X$L},X$P._getMeshRenderSharedMaterialDissolveTilingOffset=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return X$p.meshRender.sharedMaterial.dissolveTilingOffset.elements},X$P._setMeshRenderSharedMaterialDissolveTilingOffset=function(X$m,X$p,X$h){var X$P,X$L;if(X$m){var X$q=X$m.transform._entity;X$q&&((X$L=(X$P=X$q.owner.meshRender.material).dissolveTilingOffset).elements=X$h,X$P.dissolveTilingOffset=X$L)}else(X$L=(X$P=X$p.meshRender.material).dissolveTilingOffset).elements=X$h,X$P.dissolveTilingOffset=X$L},X$P._getMeshRenderSharedMaterialMaskTilingOffset=function(X$m,X$p){if(X$m){var X$h=X$m.transform._entity;return X$h?X$h.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return X$p.meshRender.sharedMaterial.maskTilingOffset.elements},X$P._setMeshRenderSharedMaterialMaskTilingOffset=function(X$m,X$p,X$h){var X$P,X$L;if(X$m){var X$q=X$m.transform._entity;X$q&&((X$L=(X$P=X$q.owner.meshRender.material).maskTilingOffset).elements=X$h,X$P.maskTilingOffset=X$L)}else(X$L=(X$P=X$p.meshRender.material).maskTilingOffset).elements=X$h,X$P.maskTilingOffset=X$L},X$P._propertyIDCounter=0,X$P._propertyIndexDic={},X$P._propertySetFuncs=[],X$P._propertyGetFuncs=[],X$P}(),X$G=function(){function X$m(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return X$$(X$m,"laya.d3.animation.Keyframe"),X$m}(),X$U=function(){function X$m(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return X$$(X$m,"laya.d3.animation.KeyframeNode"),X$m}(),X$N=(function(){function X$m(){this._tempVector30=new X$kp,this._tempVector31=new X$kp,this._tempVector32=new X$kp,this._a=new X$kp,this._b=new X$kp,this._c=new X$kp,this._d=new X$kp}X$$(X$m,"laya.d3.core.glitter.SplineCurvePositionVelocity");var X$p=X$m.prototype;X$p.Init=function(X$m,X$p,X$h,X$P){X$m.cloneTo(this._d),X$p.cloneTo(this._c),X$kp.scale(X$m,2,this._a),X$kp.scale(X$h,2,this._tempVector30),X$kp.subtract(this._a,this._tempVector30,this._a),X$kp.add(this._a,X$p,this._a),X$kp.add(this._a,X$P,this._a),X$kp.scale(X$h,3,this._b),X$kp.scale(X$m,3,this._tempVector30),X$kp.subtract(this._b,this._tempVector30,this._b),X$kp.subtract(this._b,X$P,this._b),X$kp.scale(X$p,2,this._tempVector30),X$kp.subtract(this._b,this._tempVector30,this._b)},X$p.Slerp=function(X$m,X$p){X$kp.scale(this._a,X$m*X$m*X$m,this._tempVector30),X$kp.scale(this._b,X$m*X$m,this._tempVector31),X$kp.scale(this._c,X$m,this._tempVector32),X$kp.add(this._tempVector30,this._tempVector31,X$p),X$kp.add(X$p,this._tempVector32,X$p),X$kp.add(X$p,this._d,X$p)}}(),function(){function X$J(X$m,X$p,X$h,X$P){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=X$m,this._h=X$p,this._minHeight=X$h,this._maxHeight=X$P}X$$(X$J,"laya.d3.core.HeightMap");var X$m=X$J.prototype;X$m._inBounds=function(X$m,X$p){return 0<=X$m&&X$m<this._h&&0<=X$p&&X$p<this._w},X$m.getHeight=function(X$m,X$p){return this._inBounds(X$m,X$p)?this._datas[X$m][X$p]:NaN},X$A(0,X$m,"width",function(){return this._w}),X$A(0,X$m,"height",function(){return this._h}),X$A(0,X$m,"maxHeight",function(){return this._maxHeight}),X$A(0,X$m,"minHeight",function(){return this._minHeight}),X$J.creatFromMesh=function(X$m,X$p,X$h,X$P){for(var X$L=[],X$q=[],X$k=X$m.getSubMeshCount(),X$Y=0;X$Y<X$k;X$Y++){for(var X$d=X$m.getSubMesh(X$Y),X$K=X$d._getVertexBuffer(),X$D=X$K.getData(),X$F=[],X$R=0;X$R<X$D.length;X$R+=X$K.vertexDeclaration.vertexStride/4){var X$$=new X$kp(X$D[X$R+0],X$D[X$R+1],X$D[X$R+2]);X$F.push(X$$)}X$L.push(X$F);var X$A=X$d._getIndexBuffer();X$q.push(X$A.getData())}var X$B=X$m.boundingBox,X$n=X$B.min.x,X$c=X$B.min.z,X$e=X$B.max.x,X$a=X$B.max.z,X$Z=X$B.min.y,X$H=X$B.max.y,X$W=X$e-X$n,X$E=X$a-X$c,X$I=X$P.elements[0]=X$W/(X$p-1),X$b=X$P.elements[1]=X$E/(X$h-1),X$T=new X$J(X$p,X$h,X$Z,X$H),X$j=X$J._tempRay,X$x=X$j.direction.elements;X$x[0]=0,X$x[1]=-1,X$x[2]=0;var X$Q=X$H+.1;X$j.origin.elements[1]=X$Q;for(var X$M=0;X$M<X$h;X$M++){var X$u=X$c+X$M*X$b;X$T._datas[X$M]=[];for(var X$N=0;X$N<X$p;X$N++){var X$S=X$n+X$N*X$I,X$_=X$j.origin.elements;X$_[0]=X$S,X$_[2]=X$u;var X$l=X$J._getPosition(X$j,X$L,X$q);X$T._datas[X$M][X$N]=X$l===Number.MAX_VALUE?NaN:X$Q-X$l}}return X$T},X$J.createFromImage=function(X$m,X$p,X$h){for(var X$P=X$m.width,X$L=X$m.height,X$q=new X$J(X$P,X$L,X$p,X$h),X$k=(X$h-X$p)/254,X$Y=X$m.getPixels(),X$d=0,X$K=0;X$K<X$L;X$K++)for(var X$D=X$q._datas[X$K]=[],X$F=0;X$F<X$P;X$F++){var X$R=X$Y[X$d++],X$$=X$Y[X$d++],X$A=X$Y[X$d++],X$B=X$Y[X$d++];X$D[X$F]=255==X$R&&255==X$$&&255==X$A&&255==X$B?NaN:(X$R+X$$+X$A)/3*X$k+X$p}return X$q},X$J._getPosition=function(X$m,X$p,X$h){for(var X$P=Number.MAX_VALUE,X$L=0;X$L<X$p.length;X$L++)for(var X$q=X$p[X$L],X$k=X$h[X$L],X$Y=0;X$Y<X$k.length;X$Y+=3){var X$d=X$q[X$k[X$Y+0]],X$K=X$q[X$k[X$Y+1]],X$D=X$q[X$k[X$Y+2]],X$F=X$Ap.rayIntersectsTriangle(X$m,X$d,X$K,X$D);!isNaN(X$F)&&X$F<X$P&&(X$P=X$F)}return X$P},X$F(X$J,["_tempRay",function(){return this._tempRay=new X$Lp(new X$kp,new X$kp)}])}(),function(){function X$L(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}X$$(X$L,"laya.d3.core.Layer");var X$m=X$L.prototype;return X$m._binarySearchIndex=function(){for(var X$m=0,X$p=X$L._collsionTestList.length-1,X$h=0;X$m<=X$p;){X$h=Math.floor((X$m+X$p)/2);var X$P=X$L._collsionTestList[X$h];if(X$P==this._number)return X$h;X$P>this._number?X$p=X$h-1:X$m=X$h+1}return X$m},X$m._addCollider=function(X$m){0===this._colliders.length&&X$L._collsionTestList.splice(this._binarySearchIndex(),0,this._number),X$m._isRigidbody?(this._colliders.unshift(X$m),this._nonRigidbodyOffset++):this._colliders.push(X$m)},X$m._removeCollider=function(X$m){var X$p=this._colliders.indexOf(X$m);X$p<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(X$p,1),0===this._colliders.length&&X$L._collsionTestList.splice(X$L._collsionTestList.indexOf(this._number),1)},X$A(0,X$m,"number",function(){return this._number}),X$A(0,X$m,"visible",function(){return this._visible},function(X$m){this._visible=X$m,X$L._visibleLayers=X$m?X$L._visibleLayers|this.mask:X$L._visibleLayers&~this.mask}),X$A(0,X$m,"mask",function(){return this._mask}),X$A(1,X$L,"visibleLayers",function(){return X$L._visibleLayers},function(X$m){X$L._visibleLayers=X$m;for(var X$p=0,X$h=X$L._layerList.length;X$p<X$h;X$p++){var X$P=X$L._layerList[X$p];X$P._visible=0!=(X$P._mask&X$L._visibleLayers)}}),X$L.__init__=function(){X$L._layerList.length=31;for(var X$m=0;X$m<31;X$m++){var X$p=new X$L;X$L._layerList[X$m]=X$p,0===X$m?(X$p.name="Default Layer",X$p.visible=!0):(X$p.name="Layer-"+X$m,X$p.visible=!1),X$p._number=X$m,X$p._mask=Math.pow(2,X$m)}X$L.currentCreationLayer=X$L._layerList[0]},X$L.getLayerByNumber=function(X$m){if(X$m<0||30<X$m)throw new Error("无法返回指定Layer，该number超出范围！");return X$L._layerList[X$m]},X$L.getLayerByName=function(X$m){for(var X$p=0;X$p<31;X$p++)if(X$L._layerList[X$p].name===X$m)return X$L._layerList[X$p];throw new Error("无法返回指定Layer,该name不存在")},X$L.isVisible=function(X$m){return 0!=(X$m&X$L._currentCameraCullingMask&X$L._visibleLayers)},X$L._layerList=[],X$L._visibleLayers=2147483647,X$L._collsionTestList=[],X$L._currentCameraCullingMask=2147483647,X$L.maxCount=31,X$L.currentCreationLayer=null,X$L}()),X$S=(function(){function X$m(X$m,X$p,X$h){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=X$m,this._minCount=X$p,this._maxCount=X$h}X$$(X$m,"laya.d3.core.particleShuriKen.module.Burst");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p.cloneTo=function(X$m){var X$p=X$m;X$p._time=this._time,X$p._minCount=this._minCount,X$p._maxCount=this._maxCount},X$p.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$p,"time",function(){return this._time}),X$A(0,X$p,"minCount",function(){return this._minCount}),X$A(0,X$p,"maxCount",function(){return this._maxCount})}(),function(){function X$m(X$m){this._color=null,this.enbale=!1,this._color=X$m}X$$(X$m,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var X$p=X$m.prototype;X$p.cloneTo=function(X$m){var X$p=X$m;this._color.cloneTo(X$p._color),X$p.enbale=this.enbale},X$p.clone=function(){var X$m;switch(this._color.type){case 0:X$m=X$l.createByConstant(this._color.constant.clone());break;case 1:X$m=X$l.createByGradient(this._color.gradient.clone());break;case 2:X$m=X$l.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:X$m=X$l.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var X$p=new this.constructor(X$m);return X$p.enbale=this.enbale,X$p},X$A(0,X$p,"color",function(){return this._color})}(),function(){function X$m(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}X$$(X$m,"laya.d3.core.particleShuriKen.module.Emission");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),X$p._destroy=function(){this._bursts=null,this._destroyed=!0},X$p.getBurstsCount=function(){return this._bursts.length},X$p.getBurstByIndex=function(X$m){return this._bursts[X$m]},X$p.addBurst=function(X$m){var X$p=this._bursts.length;if(0<X$p)for(var X$h=0;X$h<X$p;X$h++)this._bursts[X$h].time>X$m.time&&this._bursts.splice(X$h,0,X$m);this._bursts.push(X$m)},X$p.removeBurst=function(X$m){var X$p=this._bursts.indexOf(X$m);-1!==X$p&&this._bursts.splice(X$p,1)},X$p.removeBurstByIndex=function(X$m){this._bursts.splice(X$m,1)},X$p.clearBurst=function(){this._bursts.length=0},X$p.cloneTo=function(X$m){var X$p=X$m,X$h=X$p._bursts;X$h.length=this._bursts.length;for(var X$P=0,X$L=this._bursts.length;X$P<X$L;X$P++){var X$q=X$h[X$P];X$q?this._bursts[X$P].cloneTo(X$q):X$h[X$P]=this._bursts[X$P].clone()}X$p._emissionRate=this._emissionRate,X$p.enbale=this.enbale},X$p.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$p,"destroyed",function(){return this._destroyed}),X$A(0,X$p,"emissionRate",function(){return this._emissionRate},function(X$m){if(X$m<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=X$m})}(),function(){function X$P(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}X$$(X$P,"laya.d3.core.particleShuriKen.module.FrameOverTime");var X$m=X$P.prototype;return X$H.imps(X$m,{"laya.d3.core.IClone":!0}),X$m.cloneTo=function(X$m){var X$p=X$m;X$p._type=this._type,X$p._constant=this._constant,this._overTime.cloneTo(X$p._overTime),X$p._constantMin=this._constantMin,X$p._constantMax=this._constantMax,this._overTimeMin.cloneTo(X$p._overTimeMin),this._overTimeMax.cloneTo(X$p._overTimeMax)},X$m.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$m,"frameOverTimeData",function(){return this._overTime}),X$A(0,X$m,"constant",function(){return this._constant}),X$A(0,X$m,"type",function(){return this._type}),X$A(0,X$m,"frameOverTimeDataMin",function(){return this._overTimeMin}),X$A(0,X$m,"constantMin",function(){return this._constantMin}),X$A(0,X$m,"frameOverTimeDataMax",function(){return this._overTimeMax}),X$A(0,X$m,"constantMax",function(){return this._constantMax}),X$P.createByConstant=function(X$m){var X$p=new X$P;return X$p._type=0,X$p._constant=X$m,X$p},X$P.createByOverTime=function(X$m){var X$p=new X$P;return X$p._type=1,X$p._overTime=X$m,X$p},X$P.createByRandomTwoConstant=function(X$m,X$p){var X$h=new X$P;return X$h._type=2,X$h._constantMin=X$m,X$h._constantMax=X$p,X$h},X$P.createByRandomTwoOverTime=function(X$m,X$p){var X$h=new X$P;return X$h._type=3,X$h._overTimeMin=X$m,X$h._overTimeMax=X$p,X$h},X$P}()),X$_=function(){function X$K(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}X$$(X$K,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var X$m=X$K.prototype;return X$H.imps(X$m,{"laya.d3.core.IClone":!0}),X$m.cloneTo=function(X$m){var X$p=X$m;X$p._type=this._type,X$p._separateAxes=this._separateAxes,X$p._constant=this._constant,this._constantSeparate.cloneTo(X$p._constantSeparate),this._gradient.cloneTo(X$p._gradient),this._gradientX.cloneTo(X$p._gradientX),this._gradientY.cloneTo(X$p._gradientY),this._gradientZ.cloneTo(X$p._gradientZ),X$p._constantMin=this._constantMin,X$p._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(X$p._constantMinSeparate),this._constantMaxSeparate.cloneTo(X$p._constantMaxSeparate),this._gradientMin.cloneTo(X$p._gradientMin),this._gradientMax.cloneTo(X$p._gradientMax),this._gradientXMin.cloneTo(X$p._gradientXMin),this._gradientXMax.cloneTo(X$p._gradientXMax),this._gradientYMin.cloneTo(X$p._gradientYMin),this._gradientYMax.cloneTo(X$p._gradientYMax),this._gradientZMin.cloneTo(X$p._gradientZMin),this._gradientZMax.cloneTo(X$p._gradientZMax)},X$m.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$m,"gradientZ",function(){return this._gradientZ}),X$A(0,X$m,"constant",function(){return this._constant}),X$A(0,X$m,"gradient",function(){return this._gradient}),X$A(0,X$m,"separateAxes",function(){return this._separateAxes}),X$A(0,X$m,"type",function(){return this._type}),X$A(0,X$m,"constantSeparate",function(){return this._constantSeparate}),X$A(0,X$m,"gradientX",function(){return this._gradientX}),X$A(0,X$m,"gradientY",function(){return this._gradientY}),X$A(0,X$m,"gradientW",function(){return this._gradientW}),X$A(0,X$m,"gradientMin",function(){return this._gradientMin}),X$A(0,X$m,"constantMin",function(){return this._constantMin}),X$A(0,X$m,"gradientMax",function(){return this._gradientMax}),X$A(0,X$m,"constantMax",function(){return this._constantMax}),X$A(0,X$m,"gradientWMin",function(){return this._gradientWMin}),X$A(0,X$m,"constantMinSeparate",function(){return this._constantMinSeparate}),X$A(0,X$m,"constantMaxSeparate",function(){return this._constantMaxSeparate}),X$A(0,X$m,"gradientXMin",function(){return this._gradientXMin}),X$A(0,X$m,"gradientXMax",function(){return this._gradientXMax}),X$A(0,X$m,"gradientWMax",function(){return this._gradientWMax}),X$A(0,X$m,"gradientYMin",function(){return this._gradientYMin}),X$A(0,X$m,"gradientYMax",function(){return this._gradientYMax}),X$A(0,X$m,"gradientZMin",function(){return this._gradientZMin}),X$A(0,X$m,"gradientZMax",function(){return this._gradientZMax}),X$K.createByConstant=function(X$m){var X$p=new X$K;return X$p._type=0,X$p._separateAxes=!1,X$p._constant=X$m,X$p},X$K.createByConstantSeparate=function(X$m){var X$p=new X$K;return X$p._type=0,X$p._separateAxes=!0,X$p._constantSeparate=X$m,X$p},X$K.createByGradient=function(X$m){var X$p=new X$K;return X$p._type=1,X$p._separateAxes=!1,X$p._gradient=X$m,X$p},X$K.createByGradientSeparate=function(X$m,X$p,X$h,X$P){var X$L=new X$K;return X$L._type=1,X$L._separateAxes=!0,X$L._gradientX=X$m,X$L._gradientY=X$p,X$L._gradientZ=X$h,X$L._gradientW=X$P,X$L},X$K.createByRandomTwoConstant=function(X$m,X$p){var X$h=new X$K;return X$h._type=2,X$h._separateAxes=!1,X$h._constantMin=X$m,X$h._constantMax=X$p,X$h},X$K.createByRandomTwoConstantSeparate=function(X$m,X$p){var X$h=new X$K;return X$h._type=2,X$h._separateAxes=!0,X$h._constantMinSeparate=X$m,X$h._constantMaxSeparate=X$p,X$h},X$K.createByRandomTwoGradient=function(X$m,X$p){var X$h=new X$K;return X$h._type=3,X$h._separateAxes=!1,X$h._gradientMin=X$m,X$h._gradientMax=X$p,X$h},X$K.createByRandomTwoGradientSeparate=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){var X$d=new X$K;return X$d._type=3,X$d._separateAxes=!0,X$d._gradientXMin=X$m,X$d._gradientXMax=X$p,X$d._gradientYMin=X$h,X$d._gradientYMax=X$P,X$d._gradientZMin=X$L,X$d._gradientZMax=X$q,X$d._gradientWMin=X$k,X$d._gradientWMax=X$Y,X$d},X$K}(),X$l=function(){function X$P(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}X$$(X$P,"laya.d3.core.particleShuriKen.module.GradientColor");var X$m=X$P.prototype;return X$H.imps(X$m,{"laya.d3.core.IClone":!0}),X$m.cloneTo=function(X$m){var X$p=X$m;X$p._type=this._type,this._constant.cloneTo(X$p._constant),this._constantMin.cloneTo(X$p._constantMin),this._constantMax.cloneTo(X$p._constantMax),this._gradient.cloneTo(X$p._gradient),this._gradientMin.cloneTo(X$p._gradientMin),this._gradientMax.cloneTo(X$p._gradientMax)},X$m.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$m,"gradient",function(){return this._gradient}),X$A(0,X$m,"constant",function(){return this._constant}),X$A(0,X$m,"type",function(){return this._type}),X$A(0,X$m,"gradientMin",function(){return this._gradientMin}),X$A(0,X$m,"constantMin",function(){return this._constantMin}),X$A(0,X$m,"gradientMax",function(){return this._gradientMax}),X$A(0,X$m,"constantMax",function(){return this._constantMax}),X$P.createByConstant=function(X$m){var X$p=new X$P;return X$p._type=0,X$p._constant=X$m,X$p},X$P.createByGradient=function(X$m){var X$p=new X$P;return X$p._type=1,X$p._gradient=X$m,X$p},X$P.createByRandomTwoConstant=function(X$m,X$p){var X$h=new X$P;return X$h._type=2,X$h._constantMin=X$m,X$h._constantMax=X$p,X$h},X$P.createByRandomTwoGradient=function(X$m,X$p){var X$h=new X$P;return X$h._type=3,X$h._gradientMin=X$m,X$h._gradientMax=X$p,X$h},X$P}(),X$J=(function(){function X$m(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}X$$(X$m,"laya.d3.core.particleShuriKen.module.GradientDataColor");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p.addAlpha=function(X$m,X$p){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==X$m&&(X$m=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=X$m,this._alphaElements[this._alphaCurrentLength++]=X$p):DEBUG},X$p.addRGB=function(X$m,X$p){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==X$m&&(X$m=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=X$m,this._rgbElements[this._rgbCurrentLength++]=X$p.x,this._rgbElements[this._rgbCurrentLength++]=X$p.y,this._rgbElements[this._rgbCurrentLength++]=X$p.z):DEBUG},X$p.cloneTo=function(X$m){var X$p=X$m,X$h=0,X$P=0;X$p._alphaCurrentLength=this._alphaCurrentLength;var X$L=X$p._alphaElements;for(X$L.length=this._alphaElements.length,X$h=0,X$P=this._alphaElements.length;X$h<X$P;X$h++)X$L[X$h]=this._alphaElements[X$h];X$p._rgbCurrentLength=this._rgbCurrentLength;var X$q=X$p._rgbElements;for(X$q.length=this._rgbElements.length,X$h=0,X$P=this._rgbElements.length;X$h<X$P;X$h++)X$q[X$h]=this._rgbElements[X$h]},X$p.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$p,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),X$A(0,X$p,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function X$m(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}X$$(X$m,"laya.d3.core.particleShuriKen.module.GradientDataInt");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p.add=function(X$m,X$p){this._currentLength<8?(6===this._currentLength&&1!==X$m&&(X$m=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=X$m,this._elements[this._currentLength++]=X$p):console.log("Warning:data count must lessEqual than 4")},X$p.cloneTo=function(X$m){var X$p=X$m;X$p._currentLength=this._currentLength;var X$h=X$p._elements;X$h.length=this._elements.length;for(var X$P=0,X$L=this._elements.length;X$P<X$L;X$P++)X$h[X$P]=this._elements[X$P]},X$p.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$p,"gradientCount",function(){return this._currentLength/2})}(),function(){function X$m(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}X$$(X$m,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p.add=function(X$m,X$p){this._currentLength<8?(6===this._currentLength&&1!==X$m&&(X$m=1,DEBUG),this._elements[this._currentLength++]=X$m,this._elements[this._currentLength++]=X$p):DEBUG},X$p.getKeyByIndex=function(X$m){return this._elements[2*X$m]},X$p.getValueByIndex=function(X$m){return this._elements[2*X$m+1]},X$p.getAverageValue=function(){for(var X$m=0,X$p=this._currentLength-2;X$m<X$p;X$m+=2){this._elements[X$m+1];this._elements[X$m+3],this._elements[X$m+2]-this._elements[X$m]}return 0},X$p.cloneTo=function(X$m){var X$p=X$m;X$p._currentLength=this._currentLength;var X$h=X$p._elements;X$h.length=this._elements.length;for(var X$P=0,X$L=this._elements.length;X$P<X$L;X$P++)X$h[X$P]=this._elements[X$P]},X$p.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$p,"gradientCount",function(){return this._currentLength/2})}(),function(){function X$m(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}X$$(X$m,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p.add=function(X$m,X$p){this._currentLength<8?(6===this._currentLength&&1!==X$m&&(X$m=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=X$m,this._elements[this._currentLength++]=X$p.x,this._elements[this._currentLength++]=X$p.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},X$p.cloneTo=function(X$m){var X$p=X$m;X$p._currentLength=this._currentLength;var X$h=X$p._elements;X$h.length=this._elements.length;for(var X$P=0,X$L=this._elements.length;X$P<X$L;X$P++)X$h[X$P]=this._elements[X$P]},X$p.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$p,"gradientCount",function(){return this._currentLength/3})}(),function(){function X$Y(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}X$$(X$Y,"laya.d3.core.particleShuriKen.module.GradientSize");var X$m=X$Y.prototype;return X$H.imps(X$m,{"laya.d3.core.IClone":!0}),X$m.getMaxSizeInGradient=function(){var X$m=0,X$p=0,X$h=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(X$m=0,X$p=this._gradientX.gradientCount;X$m<X$p;X$m++)X$h=Math.max(X$h,this._gradientX.getValueByIndex(X$m));for(X$m=0,X$p=this._gradientY.gradientCount;X$m<X$p;X$m++)X$h=Math.max(X$h,this._gradientY.getValueByIndex(X$m))}else for(X$m=0,X$p=this._gradient.gradientCount;X$m<X$p;X$m++)X$h=Math.max(X$h,this._gradient.getValueByIndex(X$m));break;case 1:X$h=this._separateAxes?(X$h=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),X$h=Math.max(X$h,this._constantMinSeparate.y),Math.max(X$h,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(X$m=0,X$p=this._gradientXMin.gradientCount;X$m<X$p;X$m++)X$h=Math.max(X$h,this._gradientXMin.getValueByIndex(X$m));for(X$m=0,X$p=this._gradientXMax.gradientCount;X$m<X$p;X$m++)X$h=Math.max(X$h,this._gradientXMax.getValueByIndex(X$m));for(X$m=0,X$p=this._gradientYMin.gradientCount;X$m<X$p;X$m++)X$h=Math.max(X$h,this._gradientYMin.getValueByIndex(X$m));for(X$m=0,X$p=this._gradientZMax.gradientCount;X$m<X$p;X$m++)X$h=Math.max(X$h,this._gradientZMax.getValueByIndex(X$m))}else{for(X$m=0,X$p=this._gradientMin.gradientCount;X$m<X$p;X$m++)X$h=Math.max(X$h,this._gradientMin.getValueByIndex(X$m));for(X$m=0,X$p=this._gradientMax.gradientCount;X$m<X$p;X$m++)X$h=Math.max(X$h,this._gradientMax.getValueByIndex(X$m))}}return X$h},X$m.cloneTo=function(X$m){var X$p=X$m;X$p._type=this._type,X$p._separateAxes=this._separateAxes,this._gradient.cloneTo(X$p._gradient),this._gradientX.cloneTo(X$p._gradientX),this._gradientY.cloneTo(X$p._gradientY),this._gradientZ.cloneTo(X$p._gradientZ),X$p._constantMin=this._constantMin,X$p._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(X$p._constantMinSeparate),this._constantMaxSeparate.cloneTo(X$p._constantMaxSeparate),this._gradientMin.cloneTo(X$p._gradientMin),this._gradientMax.cloneTo(X$p._gradientMax),this._gradientXMin.cloneTo(X$p._gradientXMin),this._gradientXMax.cloneTo(X$p._gradientXMax),this._gradientYMin.cloneTo(X$p._gradientYMin),this._gradientYMax.cloneTo(X$p._gradientYMax),this._gradientZMin.cloneTo(X$p._gradientZMin),this._gradientZMax.cloneTo(X$p._gradientZMax)},X$m.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$m,"gradientZ",function(){return this._gradientZ}),X$A(0,X$m,"gradient",function(){return this._gradient}),X$A(0,X$m,"separateAxes",function(){return this._separateAxes}),X$A(0,X$m,"type",function(){return this._type}),X$A(0,X$m,"gradientMin",function(){return this._gradientMin}),X$A(0,X$m,"constantMin",function(){return this._constantMin}),X$A(0,X$m,"gradientX",function(){return this._gradientX}),X$A(0,X$m,"gradientY",function(){return this._gradientY}),X$A(0,X$m,"gradientMax",function(){return this._gradientMax}),X$A(0,X$m,"constantMax",function(){return this._constantMax}),X$A(0,X$m,"constantMinSeparate",function(){return this._constantMinSeparate}),X$A(0,X$m,"constantMaxSeparate",function(){return this._constantMaxSeparate}),X$A(0,X$m,"gradientXMin",function(){return this._gradientXMin}),X$A(0,X$m,"gradientXMax",function(){return this._gradientXMax}),X$A(0,X$m,"gradientYMin",function(){return this._gradientYMin}),X$A(0,X$m,"gradientYMax",function(){return this._gradientYMax}),X$A(0,X$m,"gradientZMin",function(){return this._gradientZMin}),X$A(0,X$m,"gradientZMax",function(){return this._gradientZMax}),X$Y.createByGradient=function(X$m){var X$p=new X$Y;return X$p._type=0,X$p._separateAxes=!1,X$p._gradient=X$m,X$p},X$Y.createByGradientSeparate=function(X$m,X$p,X$h){var X$P=new X$Y;return X$P._type=0,X$P._separateAxes=!0,X$P._gradientX=X$m,X$P._gradientY=X$p,X$P._gradientZ=X$h,X$P},X$Y.createByRandomTwoConstant=function(X$m,X$p){var X$h=new X$Y;return X$h._type=1,X$h._separateAxes=!1,X$h._constantMin=X$m,X$h._constantMax=X$p,X$h},X$Y.createByRandomTwoConstantSeparate=function(X$m,X$p){var X$h=new X$Y;return X$h._type=1,X$h._separateAxes=!0,X$h._constantMinSeparate=X$m,X$h._constantMaxSeparate=X$p,X$h},X$Y.createByRandomTwoGradient=function(X$m,X$p){var X$h=new X$Y;return X$h._type=2,X$h._separateAxes=!1,X$h._gradientMin=X$m,X$h._gradientMax=X$p,X$h},X$Y.createByRandomTwoGradientSeparate=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=new X$Y;return X$k._type=2,X$k._separateAxes=!0,X$k._gradientXMin=X$m,X$k._gradientXMax=X$p,X$k._gradientYMin=X$h,X$k._gradientYMax=X$P,X$k._gradientZMin=X$L,X$k._gradientZMax=X$q,X$k},X$Y}()),X$z=function(){function X$Y(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}X$$(X$Y,"laya.d3.core.particleShuriKen.module.GradientVelocity");var X$m=X$Y.prototype;return X$H.imps(X$m,{"laya.d3.core.IClone":!0}),X$m.cloneTo=function(X$m){var X$p=X$m;X$p._type=this._type,this._constant.cloneTo(X$p._constant),this._gradientX.cloneTo(X$p._gradientX),this._gradientY.cloneTo(X$p._gradientY),this._gradientZ.cloneTo(X$p._gradientZ),this._constantMin.cloneTo(X$p._constantMin),this._constantMax.cloneTo(X$p._constantMax),this._gradientXMin.cloneTo(X$p._gradientXMin),this._gradientXMax.cloneTo(X$p._gradientXMax),this._gradientYMin.cloneTo(X$p._gradientYMin),this._gradientYMax.cloneTo(X$p._gradientYMax),this._gradientZMin.cloneTo(X$p._gradientZMin),this._gradientZMax.cloneTo(X$p._gradientZMax)},X$m.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$m,"gradientZ",function(){return this._gradientZ}),X$A(0,X$m,"constant",function(){return this._constant}),X$A(0,X$m,"type",function(){return this._type}),X$A(0,X$m,"gradientXMax",function(){return this._gradientXMax}),X$A(0,X$m,"constantMin",function(){return this._constantMin}),X$A(0,X$m,"gradientX",function(){return this._gradientX}),X$A(0,X$m,"gradientY",function(){return this._gradientY}),X$A(0,X$m,"gradientXMin",function(){return this._gradientXMin}),X$A(0,X$m,"constantMax",function(){return this._constantMax}),X$A(0,X$m,"gradientYMin",function(){return this._gradientYMin}),X$A(0,X$m,"gradientYMax",function(){return this._gradientYMax}),X$A(0,X$m,"gradientZMin",function(){return this._gradientZMin}),X$A(0,X$m,"gradientZMax",function(){return this._gradientZMax}),X$Y.createByConstant=function(X$m){var X$p=new X$Y;return X$p._type=0,X$p._constant=X$m,X$p},X$Y.createByGradient=function(X$m,X$p,X$h){var X$P=new X$Y;return X$P._type=1,X$P._gradientX=X$m,X$P._gradientY=X$p,X$P._gradientZ=X$h,X$P},X$Y.createByRandomTwoConstant=function(X$m,X$p){var X$h=new X$Y;return X$h._type=2,X$h._constantMin=X$m,X$h._constantMax=X$p,X$h},X$Y.createByRandomTwoGradient=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=new X$Y;return X$k._type=3,X$k._gradientXMin=X$m,X$k._gradientXMax=X$p,X$k._gradientYMin=X$h,X$k._gradientYMax=X$P,X$k._gradientZMin=X$L,X$k._gradientZMax=X$q,X$k},X$Y}(),X$w=(function(){function X$m(X$m){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=X$m}X$$(X$m,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p.cloneTo=function(X$m){var X$p=X$m;this._angularVelocity.cloneTo(X$p._angularVelocity),X$p.enbale=this.enbale},X$p.clone=function(){var X$m;switch(this._angularVelocity.type){case 0:X$m=this._angularVelocity.separateAxes?X$_.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):X$_.createByConstant(this._angularVelocity.constant);break;case 1:X$m=this._angularVelocity.separateAxes?X$_.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):X$_.createByGradient(this._angularVelocity.gradient.clone());break;case 2:X$m=this._angularVelocity.separateAxes?X$_.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):X$_.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:X$m=this._angularVelocity.separateAxes?X$_.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):X$_.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var X$p=new this.constructor(X$m);return X$p.enbale=this.enbale,X$p},X$A(0,X$p,"angularVelocity",function(){return this._angularVelocity})}(),function(){function X$m(){this.enable=!1,this.randomDirection=!1}X$$(X$m,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p._getShapeBoundBox=function(X$m){throw new Error("BaseShape: must override it.")},X$p._getSpeedBoundBox=function(X$m){throw new Error("BaseShape: must override it.")},X$p.generatePositionAndDirection=function(X$m,X$p,X$h,X$P){throw new Error("BaseShape: must override it.")},X$p._calculateProceduralBounds=function(X$m,X$p,X$h){this._getShapeBoundBox(X$m);var X$P=X$m.min,X$L=X$m.max;X$kp.multiply(X$P,X$p,X$P),X$kp.multiply(X$L,X$p,X$L);var X$q=new X$vm(new X$kp,new X$kp);this.randomDirection?(X$q.min=new X$kp(-1,-1,-1),X$q.max=new X$kp(1,1,1)):this._getSpeedBoundBox(X$q);var X$k=new X$vm(new X$kp,new X$kp),X$Y=X$k.min,X$d=X$k.max;X$kp.scale(X$q.min,X$h.y,X$Y),X$kp.scale(X$q.max,X$h.y,X$d),X$kp.add(X$m.min,X$Y,X$Y),X$kp.add(X$m.max,X$d,X$d),X$kp.min(X$m.min,X$Y,X$m.min),X$kp.max(X$m.max,X$Y,X$m.max);var X$K=new X$vm(new X$kp,new X$kp),X$D=X$K.min,X$F=X$K.max;X$kp.scale(X$q.min,X$h.x,X$D),X$kp.scale(X$q.max,X$h.x,X$F),X$kp.min(X$K.min,X$F,X$Y),X$kp.max(X$K.min,X$F,X$d),X$kp.min(X$m.min,X$Y,X$m.min),X$kp.max(X$m.max,X$Y,X$m.max)},X$p.cloneTo=function(X$m){X$m.enable=this.enable},X$p.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$m}()),X$r=function(){function X$q(){}return X$$(X$q,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),X$q._randomPointUnitArcCircle=function(X$m,X$p,X$h){var X$P=X$p.elements,X$L=NaN;X$L=X$h?X$h.getFloat()*X$m:Math.random()*X$m,X$P[0]=Math.cos(X$L),X$P[1]=Math.sin(X$L)},X$q._randomPointInsideUnitArcCircle=function(X$m,X$p,X$h){var X$P=X$p.elements;X$q._randomPointUnitArcCircle(X$m,X$p,X$h);var X$L=NaN;X$L=X$h?Math.pow(X$h.getFloat(),.5):Math.pow(Math.random(),.5),X$P[0]=X$P[0]*X$L,X$P[1]=X$P[1]*X$L},X$q._randomPointUnitCircle=function(X$m,X$p){var X$h=X$m.elements,X$P=NaN;X$P=X$p?X$p.getFloat()*Math.PI*2:Math.random()*Math.PI*2,X$h[0]=Math.cos(X$P),X$h[1]=Math.sin(X$P)},X$q._randomPointInsideUnitCircle=function(X$m,X$p){var X$h=X$m.elements;X$q._randomPointUnitCircle(X$m);var X$P=NaN;X$P=X$p?Math.pow(X$p.getFloat(),.5):Math.pow(Math.random(),.5),X$h[0]=X$h[0]*X$P,X$h[1]=X$h[1]*X$P},X$q._randomPointUnitSphere=function(X$m,X$p){var X$h=X$m.elements,X$P=NaN,X$L=NaN;X$L=X$p?(X$P=X$h[2]=2*X$p.getFloat()-1,X$p.getFloat()*Math.PI*2):(X$P=X$h[2]=2*Math.random()-1,Math.random()*Math.PI*2);var X$q=Math.sqrt(1-X$P*X$P);X$h[0]=X$q*Math.cos(X$L),X$h[1]=X$q*Math.sin(X$L)},X$q._randomPointInsideUnitSphere=function(X$m,X$p){var X$h=X$m.elements;X$q._randomPointUnitSphere(X$m);var X$P=NaN;X$P=X$p?Math.pow(X$p.getFloat(),1/3):Math.pow(Math.random(),1/3),X$h[0]=X$h[0]*X$P,X$h[1]=X$h[1]*X$P,X$h[2]=X$h[2]*X$P},X$q._randomPointInsideHalfUnitBox=function(X$m,X$p){var X$h=X$m.elements;X$p?(X$h[0]=X$p.getFloat()-.5,X$h[1]=X$p.getFloat()-.5,X$h[2]=X$p.getFloat()-.5):(X$h[0]=Math.random()-.5,X$h[1]=Math.random()-.5,X$h[2]=Math.random()-.5)},X$q}(),X$y=(function(){function X$m(X$m){this._size=null,this.enbale=!1,this._size=X$m}X$$(X$m,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p.cloneTo=function(X$m){var X$p=X$m;this._size.cloneTo(X$p._size),X$p.enbale=this.enbale},X$p.clone=function(){var X$m;switch(this._size.type){case 0:X$m=this._size.separateAxes?X$J.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):X$J.createByGradient(this._size.gradient.clone());break;case 1:X$m=this._size.separateAxes?X$J.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):X$J.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:X$m=this._size.separateAxes?X$J.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):X$J.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var X$p=new this.constructor(X$m);return X$p.enbale=this.enbale,X$p},X$A(0,X$p,"size",function(){return this._size})}(),function(){function X$P(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}X$$(X$P,"laya.d3.core.particleShuriKen.module.StartFrame");var X$m=X$P.prototype;return X$H.imps(X$m,{"laya.d3.core.IClone":!0}),X$m.cloneTo=function(X$m){var X$p=X$m;X$p._type=this._type,X$p._constant=this._constant,X$p._constantMin=this._constantMin,X$p._constantMax=this._constantMax},X$m.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$m,"constant",function(){return this._constant}),X$A(0,X$m,"type",function(){return this._type}),X$A(0,X$m,"constantMin",function(){return this._constantMin}),X$A(0,X$m,"constantMax",function(){return this._constantMax}),X$P.createByConstant=function(X$m){var X$p=new X$P;return X$p._type=0,X$p._constant=X$m,X$p},X$P.createByRandomTwoConstant=function(X$m,X$p){var X$h=new X$P;return X$h._type=1,X$h._constantMin=X$m,X$h._constantMax=X$p,X$h},X$P}()),X$V=(function(){function X$m(X$m,X$p){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new X$qp(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=X$m,this._startFrame=X$p}X$$(X$m,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p.cloneTo=function(X$m){var X$p=X$m;this.tiles.cloneTo(X$p.tiles),X$p.type=this.type,X$p.randomRow=this.randomRow,this._frame.cloneTo(X$p._frame),this._startFrame.cloneTo(X$p._startFrame),X$p.cycles=this.cycles,X$p.enableUVChannels=this.enableUVChannels,X$p.enable=this.enable},X$p.clone=function(){var X$m,X$p;switch(this._frame.type){case 0:X$m=X$S.createByConstant(this._frame.constant);break;case 1:X$m=X$S.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:X$m=X$S.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:X$m=X$S.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:X$p=X$y.createByConstant(this._startFrame.constant);break;case 1:X$p=X$y.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var X$h=new this.constructor(X$m,X$p);return this.tiles.cloneTo(X$h.tiles),X$h.type=this.type,X$h.randomRow=this.randomRow,X$h.cycles=this.cycles,X$h.enableUVChannels=this.enableUVChannels,X$h.enable=this.enable,X$h},X$A(0,X$p,"frame",function(){return this._frame}),X$A(0,X$p,"startFrame",function(){return this._startFrame})}(),function(){function X$m(X$m){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=X$m}X$$(X$m,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p.cloneTo=function(X$m){var X$p=X$m;this._velocity.cloneTo(X$p._velocity),X$p.enbale=this.enbale,X$p.space=this.space},X$p.clone=function(){var X$m;switch(this._velocity.type){case 0:X$m=X$z.createByConstant(this._velocity.constant.clone());break;case 1:X$m=X$z.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:X$m=X$z.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:X$m=X$z.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var X$p=new this.constructor(X$m);return X$p.enbale=this.enbale,X$p.space=this.space,X$p},X$A(0,X$p,"velocity",function(){return this._velocity})}(),function(){function X$m(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new X$Rp,this._vb=X$wp.create(X$m._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=X$zp.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=X$lp.nameKey.getID("LINE"),this._shaderCompile=X$Ip._preCompileShader[this._sharderNameID]}X$$(X$m,"laya.d3.core.PhasorSpriter3D");var X$p=X$m.prototype;return X$p.line=function(X$m,X$p,X$h,X$P){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(X$m.x,X$m.y,X$m.z,X$p.x,X$p.y,X$p.z,X$p.w),this.addVertex(X$h.x,X$h.y,X$h.z,X$P.x,X$P.y,X$P.z,X$P.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},X$p.circle=function(X$m,X$p,X$h,X$P,X$L,X$q){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*X$p,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/X$p,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*X$m,Math.cos(this._tempNumver0)*X$m,0,X$h,X$P,X$L,X$q),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},X$p.plane=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=X$P/2,this._tempNumver1=X$L/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(X$m-this._tempNumver0,X$p+this._tempNumver1,X$h,X$q,X$k,X$Y,X$d),this.addVertex(X$m+this._tempNumver0,X$p+this._tempNumver1,X$h,X$q,X$k,X$Y,X$d),this.addVertex(X$m-this._tempNumver0,X$p-this._tempNumver1,X$h,X$q,X$k,X$Y,X$d),this.addVertex(X$m+this._tempNumver0,X$p-this._tempNumver1,X$h,X$q,X$k,X$Y,X$d),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},X$p.box=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=X$P/2,this._tempNumver1=X$L/2,this._tempNumver2=X$q/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(X$m-this._tempNumver0,X$p+this._tempNumver1,X$h+this._tempNumver2,X$k,X$Y,X$d,X$K),this.addVertex(X$m+this._tempNumver0,X$p+this._tempNumver1,X$h+this._tempNumver2,X$k,X$Y,X$d,X$K),this.addVertex(X$m-this._tempNumver0,X$p-this._tempNumver1,X$h+this._tempNumver2,X$k,X$Y,X$d,X$K),this.addVertex(X$m+this._tempNumver0,X$p-this._tempNumver1,X$h+this._tempNumver2,X$k,X$Y,X$d,X$K),this.addVertex(X$m+this._tempNumver0,X$p+this._tempNumver1,X$h-this._tempNumver2,X$k,X$Y,X$d,X$K),this.addVertex(X$m-this._tempNumver0,X$p+this._tempNumver1,X$h-this._tempNumver2,X$k,X$Y,X$d,X$K),this.addVertex(X$m+this._tempNumver0,X$p-this._tempNumver1,X$h-this._tempNumver2,X$k,X$Y,X$d,X$K),this.addVertex(X$m-this._tempNumver0,X$p-this._tempNumver1,X$h-this._tempNumver2,X$k,X$Y,X$d,X$K),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},X$p.cone=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*X$h+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*X$h>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/X$h,this.addVertexIndex(0,X$p,0,X$P,X$L,X$q,X$k,this._tempUint0),this.addVertexIndex(0,0,0,X$P,X$L,X$q,X$k,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<X$h;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(X$m*this._tempNumver2,0,X$m*this._tempNumver3,X$P,X$L,X$q,X$k,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==X$h-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(X$m*this._tempNumver2,0,X$m*this._tempNumver3,X$P,X$L,X$q,X$k,this._tempUint0+(this._tempInt0+X$h)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==X$h-1?this.addIndexes(this._tempUint1+X$h+2):this.addIndexes(this._tempUint1+this._tempInt0+X$h+1),this.addIndexes(this._tempUint1+this._tempInt0+X$h),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},X$p.boundingBoxLine=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(X$m,X$L,X$q,X$k,X$Y,X$d,X$K),this.addVertex(X$P,X$L,X$q,X$k,X$Y,X$d,X$K),this.addVertex(X$m,X$p,X$q,X$k,X$Y,X$d,X$K),this.addVertex(X$P,X$p,X$q,X$k,X$Y,X$d,X$K),this.addVertex(X$P,X$L,X$h,X$k,X$Y,X$d,X$K),this.addVertex(X$m,X$L,X$h,X$k,X$Y,X$d,X$K),this.addVertex(X$P,X$p,X$h,X$k,X$Y,X$d,X$K),this.addVertex(X$m,X$p,X$h,X$k,X$Y,X$d,X$K),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},X$p.addVertex=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=X$m,this._vbData[this._posInVBData+1]=X$p,this._vbData[this._posInVBData+2]=X$h,this._vbData[this._posInVBData+3]=X$P,this._vbData[this._posInVBData+4]=X$L,this._vbData[this._posInVBData+5]=X$q,this._vbData[this._posInVBData+6]=X$k,this._posInVBData+=this._floatSizePerVer,this},X$p.addVertexIndex=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){return this._hasBegun||this.addVertexIndexException(),this._vbData[X$Y]=X$m,this._vbData[X$Y+1]=X$p,this._vbData[X$Y+2]=X$h,this._vbData[X$Y+3]=X$P,this._vbData[X$Y+4]=X$L,this._vbData[X$Y+5]=X$q,this._vbData[X$Y+6]=X$k,(X$Y+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=X$Y),this},X$p.addIndexes=function(X$m){var X$p=arguments;this._hasBegun||this.addVertexIndexException();for(var X$h=0;X$h<X$p.length;X$h++)this._ibData[this._posInIBData]=X$p[X$h],this._posInIBData++;return this},X$p.begin=function(X$m,X$p){return this._hasBegun&&this.beginException0(),1!==X$m&&4!==X$m&&this.beginException1(),this._primitiveType=X$m,this._camera=X$p,this._hasBegun=!0,this},X$p.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},X$p.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(X$m._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),X$I.drawCall++,X$Q.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},X$p.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},X$p.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},X$p.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},X$p.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},X$p.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},X$p.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(28,[new X$km(0,"vector3",0),new X$km(12,"vector4",1)])}]),X$m}()),X$o=function(){function X$m(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++X$m._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new X$Rp}X$$(X$m,"laya.d3.core.render.RenderElement");var X$p=X$m.prototype;return X$p.getDynamicBatchBakedVertexs=function(X$m){for(var X$p=this._renderObj._getVertexBuffer(X$m),X$h=X$p.getData().slice(),X$P=X$p.vertexDeclaration,X$L=X$P.getVertexElementByUsage(0).offset/4,X$q=X$P.getVertexElementByUsage(3).offset/4,X$k=this._sprite3D.transform,X$Y=X$k.worldMatrix,X$d=X$k.rotation,X$K=X$P.vertexStride/4,X$D=0,X$F=X$h.length;X$D<X$F;X$D+=X$K){var X$R=X$D+X$L,X$$=X$D+X$q;X$np.transformVector3ArrayToVector3ArrayCoordinate(X$h,X$R,X$Y,X$h,X$R),X$np.transformVector3ArrayByQuat(X$h,X$$,X$d,X$h,X$$)}return X$h},X$p.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},X$p._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},X$A(0,X$p,"id",function(){return this._id}),X$A(0,X$p,"renderObj",function(){return this._renderObj},function(X$m){this._renderObj!==X$m&&(this._renderObj=X$m)}),X$m._uniqueIDCounter=0,X$m}(),X$f=function(){function X$p(X$m){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++X$p._uniqueIDCounter,this._needSort=!1,this._scene=X$m,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}X$$(X$p,"laya.d3.core.render.RenderQueue");var X$m=X$p.prototype;return X$m._sortOpaqueFunc=function(X$m,X$p){if(X$m._render&&X$p._render){var X$h=X$m._material.renderQueue-X$p._material.renderQueue;return 0==X$h?X$m._render._distanceForSort-X$p._render._distanceForSort:X$h}return 0},X$m._sortAlphaFunc=function(X$m,X$p){if(X$m._render&&X$p._render){var X$h=X$m._material.renderQueue-X$p._material.renderQueue;return 0==X$h?X$p._render._distanceForSort-X$m._render._distanceForSort:X$h}return 0},X$m._begainRenderElement=function(X$m,X$p,X$h){return!!X$p._beforeRender(X$m)},X$m._sortAlpha=function(X$m){X$p._cameraPosition=X$m,this._finalElements.sort(this._sortAlphaFunc)},X$m._sortOpaque=function(X$m){X$p._cameraPosition=X$m,this._finalElements.sort(this._sortOpaqueFunc)},X$m._preRender=function(X$m){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},X$m._render=function(X$m,X$p){for(var X$h,X$P,X$L,X$q,X$k,X$Y,X$d=X$I.loopCount,X$K=this._scene,X$D=X$m.camera,X$F=(X$D.id,!1),X$R=0,X$$=this._finalElements.length;X$R<X$$;X$R++){var X$A,X$B,X$n,X$c=this._finalElements[X$R];if(null!=X$c._onPreRenderFunction&&X$c._onPreRenderFunction.call(X$c._sprite3D,X$m),0===X$c._type){if(X$m.owner=X$n=X$c._sprite3D,X$m.renderElement=X$c,X$n._preRenderUpdateComponents(X$m),X$A=X$c.renderObj,X$B=X$c._material,this._begainRenderElement(X$m,X$A,X$B)){if(X$h=X$A._getVertexBuffers(),!(X$L=(X$P=X$A._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[X$P.id]){this._errorRecord[X$P.id]=1;var X$e="vertexBuffer:"+("("+X$P._destroyed+","+X$P._released+","+X$P._referenceCount+","+X$P._buffer+")")+", material:"+(X$B?X$B.__className+"("+X$B._destroyed+","+X$B._released+")":"null")+", owner:"+(X$n?X$n.__className+"("+X$n._destroyed+","+X$n._activeInHierarchy+","+X$n._displayedInStage+")":"null")+", renderObj:"+(X$A?X$A.__className+"("+X$A._destroyed+","+X$A._released+","+X$A._referenceCount+")":"")+", parent:, url:"+(X$n?X$n.url:"")+", disposeStack:"+X$P.disposeStack;X$H.recordError("报错：unknown vertexDeclaration  "+X$e)}continue}if(X$F=(X$q=X$m._shader=X$B._getShader(X$K._shaderDefineValue,X$L.shaderDefineValue,X$n._shaderDefineValue)).bind()||X$d!==X$q._uploadLoopCount,X$h){if(X$q._uploadVertexBuffer!==X$h||X$F){for(var X$a=0;X$a<X$h.length;X$a++){var X$Z=X$h[X$a];X$q.uploadAttributesX(X$Z.vertexDeclaration.shaderValues.data,X$Z)}X$q._uploadVertexBuffer=X$h}}else(X$q._uploadVertexBuffer!==X$P||X$F)&&(X$q.uploadAttributes(X$L.shaderValues.data,null),X$q._uploadVertexBuffer=X$P);(X$q._uploadScene!==X$K||X$F)&&(X$q.uploadSceneUniforms(X$K._shaderValues.data),X$q._uploadScene=X$K),(X$D!==X$q._uploadCamera||X$q._uploadSprite3D!==X$n||X$F)&&(X$q.uploadSpriteUniforms(X$n._shaderValues.data),X$q._uploadSprite3D=X$n),(X$D!==X$q._uploadCamera||X$F)&&(X$q.uploadCameraUniforms(X$D._shaderValues.data),X$q._uploadCamera=X$D),(X$q._uploadMaterial!==X$B||X$F)&&(X$B._upload(),X$q._uploadMaterial=X$B),X$k!==X$B?(X$B._setRenderStateBlendDepth(),X$B._setRenderStateFrontFace(X$p,X$n.transform),X$k=X$B,X$Y=X$n):X$Y!==X$n&&(X$B._setRenderStateFrontFace(X$p,X$n.transform),X$Y=X$n),X$A._render(X$m),X$q._uploadLoopCount=X$d}X$n._postRenderUpdateComponents(X$m)}else if(2===X$c._type){X$c.renderObj;X$m.owner=X$n=X$c._sprite3D,X$m.renderElement=X$c,X$m._batchIndexStart=X$c._tempBatchIndexStart,X$m._batchIndexEnd=X$c._tempBatchIndexEnd,X$A=X$c.renderObj,X$B=X$c._material,this._begainRenderElement(X$m,X$A,X$B)&&(X$L=(X$P=X$A._getVertexBuffer(0)).vertexDeclaration,X$F=(X$q=X$m._shader=X$B._getShader(X$K._shaderDefineValue,X$L.shaderDefineValue,X$n._shaderDefineValue)).bind()||X$d!==X$q._uploadLoopCount,(X$q._uploadVertexBuffer!==X$P||X$F)&&(X$q.uploadAttributes(X$L.shaderValues.data,null),X$q._uploadVertexBuffer=X$P),(X$q._uploadScene!==X$K||X$F)&&(X$q.uploadSceneUniforms(X$K._shaderValues.data),X$q._uploadScene=X$K),(X$D!==X$q._uploadCamera||X$q._uploadSprite3D!==X$n||X$F)&&(X$q.uploadSpriteUniforms(X$n._shaderValues.data),X$q._uploadSprite3D=X$n),(X$D!==X$q._uploadCamera||X$F)&&(X$q.uploadCameraUniforms(X$D._shaderValues.data),X$q._uploadCamera=X$D),(X$q._uploadMaterial!==X$B||X$F)&&(X$B._upload(),X$q._uploadMaterial=X$B),X$k!==X$B?(X$B._setRenderStateBlendDepth(),X$B._setRenderStateFrontFace(X$p,X$n.transform),X$k=X$B,X$Y=X$n):X$Y!==X$n&&(X$B._setRenderStateFrontFace(X$p,X$n.transform),X$Y=X$n),X$A._render(X$m),X$q._uploadLoopCount=X$d)}}},X$m._renderShadow=function(X$m,X$p){for(var X$h,X$P,X$L,X$q,X$k,X$Y=X$I.loopCount,X$d=this._scene,X$K=X$m.camera,X$D=!1,X$F=0,X$R=this._finalElements.length;X$F<X$R;X$F++){var X$$,X$A,X$B,X$n=this._finalElements[X$F];0===X$n._type&&(X$m.owner=X$B=X$n._sprite3D,X$p||X$B._projectionViewWorldUpdateCamera===X$K&&X$B._projectionViewWorldUpdateLoopCount===X$I.loopCount||(X$B._render._renderUpdate(X$m._projectionViewMatrix),X$B._projectionViewWorldUpdateLoopCount=X$I.loopCount,X$B._projectionViewWorldUpdateCamera=X$K),X$m.renderElement=X$n,X$B._preRenderUpdateComponents(X$m),X$$=X$n.renderObj,X$A=X$n._material,this._begainRenderElement(X$m,X$$,null)&&(X$P=(X$h=X$$._getVertexBuffer(0)).vertexDeclaration,X$D=(X$L=X$m._shader=X$A._getShader(X$d._shaderDefineValue,X$P.shaderDefineValue,X$B._shaderDefineValue)).bind()||X$Y!==X$L._uploadLoopCount,(X$L._uploadVertexBuffer!==X$h||X$D)&&(X$L.uploadAttributes(X$P.shaderValues.data,null),X$L._uploadVertexBuffer=X$h),(X$K!==X$L._uploadCamera||X$L._uploadSprite3D!==X$B||X$D)&&(X$L.uploadSpriteUniforms(X$B._shaderValues.data),X$L._uploadSprite3D=X$B),(X$K!==X$L._uploadCamera||X$D)&&(X$L.uploadCameraUniforms(X$K._shaderValues.data),X$L._uploadCamera=X$K),(X$L._uploadMaterial!==X$A||X$D)&&(X$A._upload(),X$L._uploadMaterial=X$A),X$L._uploadRenderElement,X$q!==X$A?(X$A._setRenderStateFrontFace(!1,X$B.transform),X$q=X$A,X$k=X$B):X$k!==X$B&&(X$A._setRenderStateFrontFace(!1,X$B.transform),X$k=X$B),X$$._render(X$m),X$L._uploadLoopCount=X$Y),X$B._postRenderUpdateComponents(X$m))}},X$m._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},X$m._addRenderElement=function(X$m){this._renderElements.push(X$m),this._needSort=!0},X$m._addDynamicBatchElement=function(X$m){this._dynamicBatchCombineRenderElements.push(X$m)},X$A(0,X$m,"id",function(){return this._id}),X$p._uniqueIDCounter=0,X$p._cameraPosition=null,X$p}(),X$i=function(){function X$m(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return X$$(X$m,"laya.d3.core.render.RenderState"),X$m.clientWidth=0,X$m.clientHeight=0,X$m}(),X$v=function(){function X$k(X$m,X$p){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new X$tm(new X$kp,0),this._corners=[new X$kp,new X$kp,new X$kp,new X$kp,new X$kp,new X$kp,new X$kp,new X$kp],this._boundingBoxCenter=new X$kp,this._children=X$P(8),this._objects=[],this._tempBoundBoxCorners=[new X$kp,new X$kp,new X$kp,new X$kp,new X$kp,new X$kp,new X$kp,new X$kp],this._scene=X$m,this._currentDepth=X$p}X$$(X$k,"laya.d3.core.scene.OctreeNode");var X$m=X$k.prototype;return X$H.imps(X$m,{"laya.d3.core.scene.ITreeNode":!0}),X$m.init=function(X$m,X$p){var X$h=new X$kp,X$P=new X$kp;X$kp.scale(X$p,-.5,X$h),X$kp.scale(X$p,.5,X$P),X$kp.add(X$h,X$m,X$h),X$kp.add(X$P,X$m,X$P),this.exactBox=new X$vm(X$h,X$P),this.relaxBox=new X$vm(X$h,X$P)},X$m.addTreeNode=function(X$m){1===Collision.boxContainsBox(this._relaxBox,X$m.boundingBox)?this.addNodeDown(X$m,0):this.addObject(X$m)},X$m.addChild=function(X$m){var X$p=this._children[X$m];if(null==X$p){X$p=new X$k(this._scene,this._currentDepth+1),(this._children[X$m]=X$p)._parent=this,X$kp.subtract(this._exactBox.max,this._exactBox.min,X$k.tempSize),X$kp.multiply(X$k.tempSize,X$k._octreeSplit[X$m],X$k.tempCenter),X$kp.add(this._exactBox.min,X$k.tempCenter,X$k.tempCenter),X$kp.scale(X$k.tempSize,.25,X$k.tempSize);var X$h=new X$kp,X$P=new X$kp;X$kp.subtract(X$k.tempCenter,X$k.tempSize,X$h),X$kp.add(X$k.tempCenter,X$k.tempSize,X$P),X$p.exactBox=new X$vm(X$h,X$P),X$kp.scale(X$k.tempSize,X$k.relax,X$k.tempSize);var X$L=new X$kp,X$q=new X$kp;X$kp.subtract(X$k.tempCenter,X$k.tempSize,X$L),X$kp.add(X$k.tempCenter,X$k.tempSize,X$q),X$p.relaxBox=new X$vm(X$L,X$q)}return X$p},X$m.addObject=function(X$m){(X$m._treeNode=this)._objects.push(X$m)},X$m.removeObject=function(X$m){if(X$m._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var X$p=this._objects.indexOf(X$m);return-1!==X$p&&(this._objects.splice(X$p,1),!0)},X$m.clearObject=function(){this._objects.length=0},X$m.addNodeUp=function(X$m,X$p){this._parent&&1!==Collision.boxContainsBox(this._exactBox,X$m.boundingBox)?this._parent.addNodeUp(X$m,X$p-1):this.addNodeDown(X$m,X$p)},X$m.addNodeDown=function(X$m,X$p){if(X$p<this._scene.treeLevel){var X$h=this.inChildIndex(X$m.boundingBoxCenter),X$P=this.addChild(X$h);1===Collision.boxContainsBox(X$P._relaxBox,X$m.boundingBox)?X$P.addNodeDown(X$m,++X$p):this.addObject(X$m)}else this.addObject(X$m)},X$m.inChildIndex=function(X$m){return 4*(X$m.z<this._boundingBoxCenter.z?0:1)+2*(X$m.y<this._boundingBoxCenter.y?0:1)+(X$m.x<this._boundingBoxCenter.x?0:1)},X$m.updateObject=function(X$m){1===Collision.boxContainsBox(this._relaxBox,X$m.boundingBox)?(this.removeObject(X$m),X$m._treeNode=null,this.addNodeDown(X$m,this._currentDepth)):this._parent&&(this.removeObject(X$m),X$m._treeNode=null,this._parent.addNodeUp(X$m,this._currentDepth-1))},X$m.cullingObjects=function(X$m,X$p,X$h,X$P,X$L){var X$q,X$k=0,X$Y=0,X$d=0,X$K=this._scene._dynamicBatchManager;for(X$k=0,X$q=this._objects.length;X$k<X$q;X$k++){var X$D=this._objects[X$k];if(X$N.isVisible(X$D._owner.layer.mask)&&X$D.enable){if(X$p&&(X$I.treeSpriteCollision+=1,0===X$m.containsBoundSphere(X$D.boundingSphere)))continue;X$D._renderUpdate(X$L),X$D._distanceForSort=X$kp.distance(X$D.boundingSphere.center,X$P)+X$D.sortingFudge;var X$F=X$D._renderElements;for(X$Y=0,X$d=X$F.length;X$Y<X$d;X$Y++){var X$R=X$F[X$Y],X$$=X$R._staticBatch;if(X$$&&X$$._material===X$R._material)X$$._addBatchRenderElement(X$R);else{var X$A=X$R.renderObj;X$A.triangleCount<10&&1===X$A._vertexBufferCount&&X$A._getIndexBuffer()&&X$R._material.renderQueue<2&&X$R._canDynamicBatch&&!X$D._owner.isStatic?X$K._addPrepareRenderElement(X$R):this._scene.getRenderQueue(X$R._material.renderQueue)._addRenderElement(X$R)}}}}for(X$k=0;X$k<8;X$k++){var X$B=this._children[X$k];if(null!=X$B){var X$n=X$p;if(X$p){var X$c=X$m.containsBoundBox(X$B._relaxBox);if(X$I.treeNodeCollision+=1,0===X$c)continue;X$n=2===X$c}X$B.cullingObjects(X$m,X$n,X$h,X$P,X$L)}}},X$m.cullingShadowObjects=function(X$m,X$p,X$h,X$P,X$L){var X$q,X$k=0,X$Y=0,X$d=0;this._scene._dynamicBatchManager;for(X$k=0,X$q=this._objects.length;X$k<X$q;X$k++){var X$K=this._objects[X$k];if(X$K.castShadow&&X$N.isVisible(X$K._owner.layer.mask)&&X$K.enable){if(X$h&&0===X$m[0].containsBoundSphere(X$K.boundingSphere))continue;for(var X$D=1,X$F=X$m.length;X$D<X$F;X$D++){var X$R=X$p[X$D-1];if(0!==X$m[X$D].containsBoundSphere(X$K.boundingSphere)){var X$$=X$K._renderElements;for(X$Y=0,X$d=X$$.length;X$Y<X$d;X$Y++)X$R._addRenderElement(X$$[X$Y])}}}}for(X$k=0;X$k<8;X$k++){var X$A=this._children[X$k];if(null!=X$A){var X$B=X$h;if(X$h){var X$n=X$m[0].containsBoundBox(X$A._relaxBox);if(0===X$n)continue;X$B=2===X$n}X$A.cullingShadowObjects(X$m,X$p,X$B,X$P,X$L)}}},X$m.cullingShadowObjectsOnePSSM=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k,X$Y=X$p[0],X$d=0,X$K=0,X$D=0;for(X$d=0,X$k=this._objects.length;X$d<X$k;X$d++){var X$F=this._objects[X$d];if(X$F.castShadow&&X$N.isVisible(X$F._owner.layer.mask)&&X$F.enable){if(X$P&&0===X$m.containsBoundSphere(X$F.boundingSphere))continue;X$F._renderUpdate(X$h);var X$R=X$F._renderElements;for(X$K=0,X$D=X$R.length;X$K<X$D;X$K++)X$Y._addRenderElement(X$R[X$K])}}for(X$d=0;X$d<8;X$d++){var X$$=this._children[X$d];if(null!=X$$){var X$A=X$P;if(X$P){var X$B=X$m.containsBoundBox(X$$._relaxBox);if(0===X$B)continue;X$A=2===X$B}X$$.cullingShadowObjectsOnePSSM(X$m,X$p,X$h,X$A,X$L,X$q)}}},X$m.renderBoudingBox=function(X$m){this._renderBoudingBox(X$m);for(var X$p=0;X$p<8;++X$p){var X$h=this._children[X$p];X$h&&X$h.renderBoudingBox(X$m)}},X$m.buildAllChild=function(X$m){if(X$m<this._scene.treeLevel)for(var X$p=0;X$p<8;X$p++){this.addChild(X$p).buildAllChild(X$m+1)}},X$m._renderBoudingBox=function(X$m){},X$A(0,X$m,"exactBox",function(){return this._exactBox},function(X$m){this._exactBox=X$m,X$kp.add(X$m.min,X$m.max,this._boundingBoxCenter),X$kp.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),X$A(0,X$m,"relaxBox",function(){return this._relaxBox},function(X$m){(this._relaxBox=X$m).getCorners(this._corners),X$tm.createfromPoints(this._corners,this._boundingSphere)}),X$k.debugMode=!1,X$k.relax=1.15,X$k.CHILDNUM=8,X$F(X$k,["tempVector0",function(){return this.tempVector0=new X$kp},"tempSize",function(){return this.tempSize=new X$kp},"tempCenter",function(){return this.tempCenter=new X$kp},"_octreeSplit",function(){return this._octreeSplit=[new X$kp(.25,.25,.25),new X$kp(.75,.25,.25),new X$kp(.25,.75,.25),new X$kp(.75,.75,.25),new X$kp(.25,.25,.75),new X$kp(.75,.25,.75),new X$kp(.25,.75,.75),new X$kp(.75,.75,.75)]}]),X$k}(),X$g=(function(){function X$m(){}X$$(X$m,"laya.d3.core.scene.SceneManager")}(),function(){function X$m(X$m,X$p,X$h,X$P){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===X$m&&(X$m=1),void 0===X$p&&(X$p=1),void 0===X$h&&(X$h=1),void 0===X$P&&(X$P=1),this._r=X$m,this._g=X$p,this._b=X$h,this._a=X$P}return X$$(X$m,"laya.d3.core.trail.module.Color",null,"Color$1"),X$m.prototype.cloneTo=function(X$m){X$m._r=this._r,X$m._g=this._g,X$m._b=this._b,X$m._a=this._a},X$F(X$m,["RED",function(){return this.RED=new X$m(1,0,0,1)},"GREEN",function(){return this.GREEN=new X$m(0,1,0,1)},"BLUE",function(){return this.BLUE=new X$m(0,0,1,1)},"CYAN",function(){return this.CYAN=new X$m(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new X$m(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new X$m(1,0,1,1)},"GRAY",function(){return this.GRAY=new X$m(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new X$m(1,1,1,1)},"BLACK",function(){return this.BLACK=new X$m(0,0,0,1)}]),X$m}()),X$t=(function(){function X$m(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}X$$(X$m,"laya.d3.core.trail.module.Gradient");var X$p=X$m.prototype;X$p.setKeys=function(X$m,X$p){var X$h,X$P;this._colorKeys=X$m;for(var X$L=this.index=0;X$L<X$m.length;X$L++){var X$q=(X$h=X$m[X$L]).color;this._colorKeyData[this.index++]=X$q._r,this._colorKeyData[this.index++]=X$q._g,this._colorKeyData[this.index++]=X$q._b,this._colorKeyData[this.index++]=X$h.time}this._alphaKeys=X$p;for(var X$k=this.index=0;X$k<X$p.length;X$k++)X$P=X$p[X$k],this._alphaKeyData[this.index++]=X$P.alpha,this._alphaKeyData[this.index++]=X$P.time},X$p.cloneTo=function(X$m){var X$p=0,X$h=0,X$P=this.colorKeys,X$L=[];for(X$p=0,X$h=X$P.length;X$p<X$h;X$p++){var X$q=new X$O;X$P[X$p].cloneTo(X$q),X$L.push(X$q)}var X$k=this.alphaKeys,X$Y=[];for(X$p=0,X$h=X$k.length;X$p<X$h;X$p++){var X$d=new X$t;X$k[X$p].cloneTo(X$d),X$Y.push(X$d)}X$m.setKeys(X$L,X$Y)},X$A(0,X$p,"mode",function(){return this._mode},function(X$m){this._mode=X$m}),X$A(0,X$p,"colorKeys",function(){return this._colorKeys},function(X$m){this._colorKeys=X$m;for(var X$p=this.index=0;X$p<X$m.length;X$p++){var X$h=X$m[X$p],X$P=X$h.color;this._colorKeyData[this.index++]=X$P._r,this._colorKeyData[this.index++]=X$P._g,this._colorKeyData[this.index++]=X$P._b,this._colorKeyData[this.index++]=X$h.time}}),X$A(0,X$p,"alphaKeys",function(){return this._alphaKeys},function(X$m){this._alphaKeys=X$m;for(var X$p=this.index=0;X$p<X$m.length;X$p++){var X$h=X$m[X$p];this._alphaKeyData[this.index++]=X$h.alpha,this._alphaKeyData[this.index++]=X$h.time}})}(),function(){function X$m(X$m,X$p){this._alpha=NaN,this._time=NaN,void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),this._alpha=X$m,this._time=X$p}X$$(X$m,"laya.d3.core.trail.module.GradientAlphaKey");var X$p=X$m.prototype;return X$p.cloneTo=function(X$m){X$m.alpha=this.alpha,X$m.time=this.time},X$A(0,X$p,"alpha",function(){return this._alpha},function(X$m){this._alpha=X$m}),X$A(0,X$p,"time",function(){return this._time},function(X$m){this._time=X$m}),X$m}()),X$O=function(){function X$m(X$m,X$p){this._color=null,this._time=NaN,void 0===X$p&&(X$p=0),this._color=X$m||new X$g,this._time=X$p}X$$(X$m,"laya.d3.core.trail.module.GradientColorKey");var X$p=X$m.prototype;return X$p.cloneTo=function(X$m){this.color.cloneTo(X$m.color),X$m.time=this.time},X$A(0,X$p,"color",function(){return this._color},function(X$m){this._color=X$m}),X$A(0,X$p,"time",function(){return this._time},function(X$m){this._time=X$m}),X$m}(),X$C=(function(){function X$m(){}X$$(X$m,"laya.d3.core.trail.module.GradientMode"),X$m.Blend=0,X$m.Fixed=1}(),function(){function X$m(){}X$$(X$m,"laya.d3.core.trail.module.TextureMode"),X$m.Stretch=0,X$m.Tile=1}(),function(){function X$m(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}X$$(X$m,"laya.d3.core.trail.module.TrailKeyFrame"),X$m.prototype.cloneTo=function(X$m){X$m.time=this.time,X$m.inTangent=this.inTangent,X$m.outTangent=this.outTangent,X$m.value=this.value}}(),function(){function X$p(X$m){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new X$kp,this._curPosition=new X$kp,this._delVector3=new X$kp,this._lastFixedVertexPosition=new X$kp,this._pointAtoBVector3=new X$kp,this._pointA=new X$kp,this._pointB=new X$kp,this._owner=X$m,this._id=X$p.renderElementCount++,0==this._id?X$m._owner.transform.position.cloneTo(this._lastPosition):X$m._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new X$wp(X$C.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new X$wp(X$C.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}X$$(X$p,"laya.d3.core.trail.TrailRenderElement");var X$m=X$p.prototype;X$H.imps(X$m,{"laya.d3.core.render.IRenderable":!0}),X$m._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},X$m._addTrailByFirstPosition=function(X$m,X$p){X$kp.subtract(X$p,X$m,this._delVector3),X$kp.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),X$kp.normalize(this._pointAtoBVector3,this._pointAtoBVector3),X$kp.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(X$m),X$m.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},X$m._addTrailByNextPosition=function(X$m){X$kp.subtract(X$m,this._lastFixedVertexPosition,this._delVector3),X$kp.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),X$kp.normalize(this._pointAtoBVector3,this._pointAtoBVector3),X$kp.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=X$kp.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=X$Om.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(X$m),X$m.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(X$m),this._virtualVerticesCount=2)},X$m._updateVerticesByPosition=function(X$m){this._pointe=X$m.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},X$m._updateVertexBuffer2=function(){var X$m,X$p=0,X$h=0,X$P=0;for(X$P=0,X$m=(this._verticesCount+this._virtualVerticesCount)/2;X$P<X$m;X$P++)X$h=0==this._owner.textureMode?(this._VerticesToTailLength[X$P]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[X$P],this._vertices2[X$p++]=1-X$h,this._vertices2[X$p++]=1-X$h;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},X$m._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},X$m._updateDisappear=function(){var X$m,X$p=0;for(X$p=this._curDisappearIndex,X$m=(this._verticesCount+this._virtualVerticesCount)/2;X$p<X$m;X$p++)this._owner._curtime-this._everyGroupVertexBirthTime[X$p]>=this._owner.time+X$Om.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},X$m._beforeRender=function(X$m){return this._camera=X$m.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),X$kp.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},X$m._render=function(X$m){this._isDead||(X$Q.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),X$I.drawCall++,X$I.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},X$m._getVertexBuffer=function(X$m){return void 0===X$m&&(X$m=0),0===X$m?this._vertexBuffer1:1===X$m?this._vertexBuffer2:null},X$m._getVertexBuffers=function(){return this._vertexBuffers},X$m._getIndexBuffer=function(){return null},X$m.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},X$m._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},X$A(0,X$m,"_vertexBufferCount",function(){return this._vertexBuffers.length}),X$A(0,X$m,"triangleCount",function(){return 0}),X$p.renderElementCount=0}(),function(){function X$m(){}X$$(X$m,"laya.d3.core.trail.VertexTrail");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration1}),X$A(1,X$m,"vertexDeclaration1",function(){return X$m._vertexDeclaration1}),X$A(1,X$m,"vertexDeclaration2",function(){return X$m._vertexDeclaration2}),X$F(X$m,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new X$qm(32,[new X$km(0,"vector3",0),new X$km(12,"vector3",41),new X$km(24,"single",33),new X$km(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new X$qm(4,[new X$km(0,"single",38)])}]),X$m}()),X$mm=function(){function X$Z(X$m){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=X$m}X$$(X$Z,"laya.d3.graphics.DynamicBatch");var X$m=X$Z.prototype;return X$H.imps(X$m,{"laya.d3.core.render.IRenderable":!0}),X$m._getVertexBuffer=function(X$m){return void 0===X$m&&(X$m=0),0===X$m?this._vertexBuffer:null},X$m._getIndexBuffer=function(){return this._indexBuffer},X$m._getCombineRenderElementFromPool=function(X$m,X$p,X$h){var X$P=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return X$P||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=X$P=new X$o,X$P._sprite3D=new X$fp),X$P._sprite3D._render._renderUpdate(X$h),X$P},X$m._getRenderElement=function(X$m,X$p,X$h){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*X$Z.maxVertexCount),this._indexDatas=new Uint16Array(X$Z.maxIndexCount),this._vertexBuffer=X$wp.create(this._vertexDeclaration,X$Z.maxVertexCount,35048),this._indexBuffer=X$zp.create("ushort",X$Z.maxIndexCount,35048));for(var X$P=this._merageElements.length=0,X$L=0,X$q=0,X$k=this._combineRenderElements.length;X$q<X$k;X$q++){var X$Y=this._combineRenderElements[X$q],X$d=X$Y.getDynamicBatchBakedVertexs(0),X$K=X$Y.getBakedIndices(),X$D=X$Y._sprite3D.transform._isFrontFaceInvert,X$F=X$P/(this._vertexDeclaration.vertexStride/4),X$R=X$L,X$$=X$R+X$K.length;X$Y._tempBatchIndexStart=X$R,X$Y._tempBatchIndexEnd=X$$,this._indexDatas.set(X$K,X$L);var X$A=0;if(X$D)for(X$A=X$R;X$A<X$$;X$A+=3){this._indexDatas[X$A]=X$F+this._indexDatas[X$A];var X$B=this._indexDatas[X$A+1],X$n=this._indexDatas[X$A+2];this._indexDatas[X$A+1]=X$F+X$n,this._indexDatas[X$A+2]=X$F+X$B}else for(X$A=X$R;X$A<X$$;X$A+=3)this._indexDatas[X$A]=X$F+this._indexDatas[X$A],this._indexDatas[X$A+1]=X$F+this._indexDatas[X$A+1],this._indexDatas[X$A+2]=X$F+this._indexDatas[X$A+2];X$L+=X$K.length,this._vertexDatas.set(X$d,X$P),X$P+=X$d.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),X$q=this._combineRenderElementPoolIndex=0,X$k=this._materials.length;X$q<X$k;X$q++){var X$c=this._getCombineRenderElementFromPool(X$m,X$p,X$h);X$c._type=2,X$c._staticBatch=null;var X$e=(X$c.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[X$q]]._tempBatchIndexStart,X$a=X$q+1===this._materialToRenderElementsOffsets.length?X$L:this._combineRenderElements[this._materialToRenderElementsOffsets[X$q+1]]._tempBatchIndexStart;X$c._tempBatchIndexStart=X$e,X$c._tempBatchIndexEnd=X$a,X$c._material=this._materials[X$q],this._merageElements.push(X$c)}},X$m._addCombineRenderObjTest=function(X$m){var X$p=X$m.renderObj,X$h=this._currentCombineIndexCount+X$p._getIndexBuffer().indexCount,X$P=this._currentCombineVertexCount+X$p._getVertexBuffer().vertexCount;return!(X$Z.maxVertexCount<X$P||X$Z.maxIndexCount<X$h)},X$m._addCombineRenderObj=function(X$m){var X$p=X$m.renderObj;this._combineRenderElements.push(X$m),this._currentCombineIndexCount=this._currentCombineIndexCount+X$p._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+X$p._getVertexBuffer().vertexCount},X$m._addCombineMaterial=function(X$m){this._materials.push(X$m)},X$m._addMaterialToRenderElementOffset=function(X$m){this._materialToRenderElementsOffsets.push(X$m)},X$m._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},X$m._addToRenderQueue=function(X$m,X$p,X$h,X$P){this._getRenderElement(X$p,X$h,X$P);for(var X$L=0,X$q=this._materials.length;X$L<X$q;X$L++)X$m.getRenderQueue(this._materials[X$L].renderQueue)._addDynamicBatchElement(this._merageElements[X$L])},X$m._beforeRender=function(X$m){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},X$m._render=function(X$m){var X$p=X$m._batchIndexEnd-X$m._batchIndexStart;X$Q.mainContext.drawElements(4,X$p,5123,2*X$m._batchIndexStart),X$I.drawCall++,X$I.trianglesFaces+=X$p/3},X$m._getVertexBuffers=function(){return null},X$A(0,X$m,"_vertexBufferCount",function(){return 1}),X$A(0,X$m,"triangleCount",function(){return this._indexBuffer.indexCount/3}),X$A(0,X$m,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),X$Z.maxVertexCount=2e4,X$Z.maxIndexCount=4e4,X$Z.maxCombineTriangleCount=10,X$Z}(),X$pm=function(){function X$Z(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}X$$(X$Z,"laya.d3.graphics.DynamicBatchManager");var X$m=X$Z.prototype;return X$m.getDynamicBatch=function(X$m,X$p){var X$h,X$P=X$m.id.toString()+X$p;return this._dynamicBatches[X$P]?X$h=this._dynamicBatches[X$P]:this._dynamicBatches[X$P]=X$h=new X$mm(X$m),X$h},X$m._garbageCollection=function(){for(var X$m in this._dynamicBatches)0===this._dynamicBatches[X$m].combineRenderElementsCount&&delete this._dynamicBatches[X$m]},X$m._addPrepareRenderElement=function(X$m){this._prepareDynamicBatchCombineElements.push(X$m)},X$m._finishCombineDynamicBatch=function(X$m){var X$p,X$h,X$P;this._prepareDynamicBatchCombineElements.sort(X$Z._sortPrepareDynamicBatch);for(var X$L,X$q,X$k,X$Y,X$d,X$K=-1,X$D=!0,X$F=0,X$R=-1,X$$=0,X$A=this._prepareDynamicBatchCombineElements.length;X$$<X$A;X$$++){var X$B=(X$q=this._prepareDynamicBatchCombineElements[X$$]).renderObj._getVertexBuffer(0).vertexDeclaration,X$n=X$h!==X$B;X$n&&(X$F=0,X$h=X$B);var X$c=X$F!==X$K;if(X$c&&(X$K=X$F),(X$n||X$c)&&(X$k=this.getDynamicBatch(X$B,X$F),X$p=null),X$D)if(X$k._addCombineRenderObjTest(X$q)){if(X$p!==(X$L=X$q._material))X$Y&&(X$m.getRenderQueue(X$d._material.renderQueue)._addRenderElement(X$d),X$d=X$Y=null,X$R=-1),X$Y=X$L,X$R=X$k.combineRenderElementsCount,X$d=X$q,X$p=X$L;else if(X$Y){var X$e=X$d.renderObj,X$a=X$q.renderObj;X$e._getVertexBuffer().vertexCount+X$a._getVertexBuffer().vertexCount>X$mm.maxVertexCount||X$e._getIndexBuffer().indexCount+X$a._getIndexBuffer().indexCount>X$mm.maxIndexCount?(X$m.getRenderQueue(X$d._material.renderQueue)._addRenderElement(X$d),X$Y=X$L,X$R=X$k.combineRenderElementsCount,X$d=X$q):(X$k._addCombineMaterial(X$Y),X$k._addMaterialToRenderElementOffset(X$R),X$k._addCombineRenderObj(X$d),X$d=X$Y=null,X$R=-1,X$k._addCombineRenderObj(X$q))}else X$k._addCombineRenderObj(X$q);X$D=!0}else X$Y&&(X$m.getRenderQueue(X$d._material.renderQueue)._addRenderElement(X$d),X$d=X$Y=null,X$R=-1),X$F++,X$D=!1;else X$P=this._prepareDynamicBatchCombineElements[X$$-1],X$k._addMaterialToRenderElementOffset(X$k.combineRenderElementsCount),X$p=X$P._material,X$k._addCombineMaterial(X$p),X$k._addCombineRenderObj(X$P),X$D=!0,X$p!==(X$L=X$q._material)?(X$Y=X$L,X$R=X$k.combineRenderElementsCount,X$d=X$q):X$k._addCombineRenderObj(X$q),X$p=X$L}X$Y&&(X$m.getRenderQueue(X$d._material.renderQueue)._addRenderElement(X$d),X$d=X$Y=null,X$R=-1),this._prepareDynamicBatchCombineElements.length=0},X$m._clearRenderElements=function(){for(var X$m in this._dynamicBatches)this._dynamicBatches[X$m]._clearRenderElements()},X$m._addToRenderQueue=function(X$m,X$p,X$h,X$P){for(var X$L in this._dynamicBatches){var X$q=this._dynamicBatches[X$L];0<X$q.combineRenderElementsCount&&X$q._addToRenderQueue(X$m,X$p,X$h,X$P)}},X$m.dispose=function(){this._dynamicBatches=null},X$Z._sortPrepareDynamicBatch=function(X$m,X$p){return X$m._mainSortID-X$p._mainSortID},X$Z}(),X$hm=function(){function X$m(){}return X$$(X$m,"laya.d3.graphics.FrustumCulling"),X$m.renderShadowObjectCulling=function(X$m,X$p,X$h,X$P,X$L){var X$q=0,X$k=0,X$Y=0,X$d=0;for(X$q=0,X$Y=X$h.length;X$q<X$Y;X$q++){var X$K=X$h[X$q];X$K&&X$K._clearRenderElements()}var X$D,X$F,X$R,X$$=X$m._cullingRenders;if(1<X$L){for(X$q=0,X$Y=X$m._cullingRendersLength;X$q<X$Y;X$q++)if((X$D=X$$[X$q]).castShadow&&X$N.isVisible(X$D._owner.layer.mask)&&X$D.enable)for(var X$A=1,X$B=X$p.length;X$A<X$B;X$A++)if(X$F=X$h[X$A-1],0!==X$p[X$A].containsBoundSphere(X$D.boundingSphere))for(X$k=0,X$d=(X$R=X$D._renderElements).length;X$k<X$d;X$k++)X$F._addRenderElement(X$R[X$k])}else for(X$q=0,X$Y=X$m._cullingRendersLength;X$q<X$Y;X$q++)if((X$D=X$$[X$q]).castShadow&&X$N.isVisible(X$D._owner.layer.mask)&&X$D.enable&&0!==X$p[0].containsBoundSphere(X$D.boundingSphere))for(X$D._renderUpdate(X$P),X$F=X$h[0],X$k=0,X$d=(X$R=X$D._renderElements).length;X$k<X$d;X$k++)X$F._addRenderElement(X$R[X$k])},X$m.renderShadowObjectCullingOctree=function(X$m,X$p,X$h,X$P,X$L){for(var X$q=0,X$k=X$h.length;X$q<X$k;X$q++){var X$Y=X$h[X$q];X$Y&&X$Y._clearRenderElements()}1<X$L?X$m.treeRoot.cullingShadowObjects(X$p,X$h,!0,0,X$m):X$m.treeRoot.cullingShadowObjectsOnePSSM(X$p[0],X$h,X$P,!0,0,X$m)},X$m.renderObjectCulling=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=0,X$Y=0,X$d=0,X$K=0,X$D=X$p._quenes,X$F=X$p._dynamicBatchManager,X$R=X$p._cullingRenders;for(X$k=0,X$Y=X$D.length;X$k<X$Y;X$k++){var X$$=X$D[X$k];X$$&&X$$._clearRenderElements()}var X$A=X$Pm._staticBatchManagers;for(X$k=0,X$Y=X$A.length;X$k<X$Y;X$k++)X$A[X$k]._clearRenderElements();X$F._clearRenderElements();var X$B=X$h.transform.position;for(X$k=0,X$Y=X$p._cullingRendersLength;X$k<X$Y;X$k++){var X$n=X$R[X$k];if(X$N.isVisible(X$n._owner.layer.mask)&&X$n.enable&&0!==X$m.containsBoundSphere(X$n.boundingSphere)&&X$n._renderUpdate(X$q)){X$n._distanceForSort=X$kp.distance(X$n.boundingSphere.center,X$B)+X$n.sortingFudge;var X$c=X$n._renderElements;for(X$d=0,X$K=X$c.length;X$d<X$K;X$d++){var X$e=X$c[X$d],X$a=X$e._staticBatch;if(X$a&&X$a._material===X$e._material)X$a._addBatchRenderElement(X$e);else{var X$Z=X$e.renderObj;X$Z.triangleCount<10&&1===X$Z._vertexBufferCount&&X$Z._getIndexBuffer()&&X$e._material.renderQueue<2&&X$e._canDynamicBatch&&!X$n._owner.isStatic?X$F._addPrepareRenderElement(X$e):X$p.getRenderQueue(X$e._material.renderQueue)._addRenderElement(X$e)}}}}for(X$k=0,X$Y=X$A.length;X$k<X$Y;X$k++)X$A[X$k]._addToRenderQueue(X$p,X$P,X$L,X$q);X$F._finishCombineDynamicBatch(X$p),X$F._addToRenderQueue(X$p,X$P,X$L,X$q)},X$m.renderObjectCullingOctree=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=0,X$Y=0,X$d=X$p._quenes,X$K=X$p._dynamicBatchManager;for(X$k=0,X$Y=X$d.length;X$k<X$Y;X$k++){var X$D=X$d[X$k];X$D&&X$D._clearRenderElements()}var X$F=X$Pm._staticBatchManagers;for(X$k=0,X$Y=X$F.length;X$k<X$Y;X$k++)X$F[X$k]._clearRenderElements();for(X$K._clearRenderElements(),X$p._cullingRenders.length=0,X$p.treeRoot.cullingObjects(X$m,!0,0,X$h.transform.position,X$q),X$k=0,X$Y=X$F.length;X$k<X$Y;X$k++)X$F[X$k]._addToRenderQueue(X$p,X$P,X$L,X$q);X$K._finishCombineDynamicBatch(X$p),X$K._addToRenderQueue(X$p,X$P,X$L,X$q)},X$m.renderObjectCullingNoBoundFrustum=function(X$m,X$p,X$h,X$P,X$L){var X$q=0,X$k=0,X$Y=0,X$d=0,X$K=X$m._quenes,X$D=X$m._dynamicBatchManager,X$F=X$m._cullingRenders;for(X$q=0,X$k=X$K.length;X$q<X$k;X$q++){var X$R=X$K[X$q];X$R&&X$R._clearRenderElements()}var X$$=X$Pm._staticBatchManagers;for(X$q=0,X$k=X$$.length;X$q<X$k;X$q++)X$$[X$q]._clearRenderElements();X$D._clearRenderElements();var X$A=X$p.transform.position;for(X$q=0,X$k=X$m._cullingRendersLength;X$q<X$k;X$q++){var X$B=X$F[X$q];if(X$N.isVisible(X$B._owner.layer.mask)&&X$B.enable){X$B._renderUpdate(X$L),X$B._distanceForSort=X$kp.distance(X$B.boundingSphere.center,X$A)+X$B.sortingFudge;var X$n=X$B._renderElements;for(X$Y=0,X$d=X$n.length;X$Y<X$d;X$Y++){var X$c=X$n[X$Y],X$e=X$c._staticBatch;if(X$e&&X$e._material===X$c._material)X$e._addBatchRenderElement(X$c);else{var X$a=X$c.renderObj;X$a.triangleCount<10&&1===X$a._vertexBufferCount&&X$a._getIndexBuffer()&&X$c._material.renderQueue<2&&X$c._canDynamicBatch&&!X$B._owner.isStatic?X$D._addPrepareRenderElement(X$c):X$m.getRenderQueue(X$c._material.renderQueue)._addRenderElement(X$c)}}}}for(X$q=0,X$k=X$$.length;X$q<X$k;X$q++)X$$[X$q]._addToRenderQueue(X$m,X$h,X$P,X$L);X$D._finishCombineDynamicBatch(X$m),X$D._addToRenderQueue(X$m,X$h,X$P,X$L)},X$m}(),X$Pm=function(){function X$q(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}X$$(X$q,"laya.d3.graphics.StaticBatchManager");var X$m=X$q.prototype;return X$m._finishInit=function(){for(var X$m in this._staticBatches)this._staticBatches[X$m]._finishInit();this._initBatchRenderElements.length=0},X$m._initStaticBatchs=function(X$m){throw new Error("StaticBatchManager:must override this function.")},X$m._addInitBatchSprite=function(X$m){for(var X$p=X$m._render._renderElements,X$h=0,X$P=X$p.length;X$h<X$P;X$h++)this._initBatchRenderElements.push(X$p[X$h])},X$m._clearRenderElements=function(){for(var X$m in this._staticBatches)this._staticBatches[X$m]._clearRenderElements()},X$m._garbageCollection=function(X$m){var X$p=X$m._staticBatch,X$h=X$p._initBatchRenderElements,X$P=X$h.indexOf(X$m);X$h.splice(X$P,1),0===X$h.length&&(X$p.dispose(),delete this._staticBatches[X$p._key])},X$m._addToRenderQueue=function(X$m,X$p,X$h,X$P){for(var X$L in this._staticBatches){var X$q=this._staticBatches[X$L];0<X$q._batchRenderElements.length&&X$q._updateToRenderQueue(X$m,X$P)}},X$m.dispose=function(){this._staticBatches=null},X$q._addToStaticBatchQueue=function(X$m){X$m instanceof laya.d3.core.RenderableSprite3D&&X$m._addToInitStaticBatchManager();for(var X$p=0,X$h=X$m.numChildren;X$p<X$h;X$p++)X$q._addToStaticBatchQueue(X$m._childs[X$p])},X$q.combine=function(X$m,X$p){var X$h,X$P=0,X$L=0;if(X$p)for(X$P=0,X$L=X$p.length;X$P<X$L;X$P++){X$p[X$P]._addToInitStaticBatchManager()}else X$m&&X$q._addToStaticBatchQueue(X$m);for(X$P=0,X$L=X$q._staticBatchManagers.length;X$P<X$L;X$P++)(X$h=X$q._staticBatchManagers[X$P])._initStaticBatchs(X$m),X$h._finishInit()},X$q._staticBatchManagers=[],X$q}(),X$Lm=function(){function X$m(X$m,X$p,X$h){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=X$m,this._manager=X$p,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=X$h}X$$(X$m,"laya.d3.graphics.StaticBatch");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),X$p._binarySearch=function(X$m){for(var X$p=0,X$h=this._batchRenderElements.length-1,X$P=0;X$p<=X$h;)X$P=Math.floor((X$p+X$h)/2),this._compareBatchRenderElement(this._batchRenderElements[X$P],X$m)?X$h=X$P-1:X$p=X$P+1;return X$p},X$p._compareBatchRenderElement=function(X$m,X$p){throw new Error("StaticBatch:must override this function.")},X$p._getVertexDecLightMap=function(X$m){return X$m===X$zm.vertexDeclaration?X$Nm.vertexDeclaration:X$m===X$Jm.vertexDeclaration?X$um.vertexDeclaration:X$m===X$bm.vertexDeclaration?X$Zm.vertexDeclaration:X$m===X$Gm.vertexDeclaration?null:X$m===X$Bm.vertexDeclaration?X$nm.vertexDeclaration:X$m===X$Xm.vertexDeclaration?X$_m.vertexDeclaration:X$m===X$Qm.vertexDeclaration?X$Mm.vertexDeclaration:X$m===X$wm.vertexDeclaration?X$Sm.vertexDeclaration:X$m===X$Jm.vertexDeclaration?X$um.vertexDeclaration:X$m===X$Tm.vertexDeclaration?X$Hm.vertexDeclaration:X$m===X$Gm.vertexDeclaration?null:X$m===X$Bm.vertexDeclaration?X$nm.vertexDeclaration:X$m===X$sm.vertexDeclaration?X$lm.vertexDeclaration:X$m===X$Qm.vertexDeclaration?X$Mm.vertexDeclaration:X$m},X$p._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},X$p._addBatchRenderElement=function(X$m){this._batchRenderElements.splice(this._binarySearch(X$m),0,X$m)},X$p._updateToRenderQueue=function(X$m,X$p){this._combineRenderElementPoolIndex=0,this._getRenderElement(X$m.getRenderQueue(this._material.renderQueue)._renderElements,X$m,X$p)},X$p._getRenderElement=function(X$m,X$p,X$h){throw new Error("StaticBatch:must override this function.")},X$p._finishInit=function(){throw new Error("StaticBatch:must override this function.")},X$p._clearRenderElements=function(){this._batchRenderElements.length=0},X$p.dispose=function(){},X$p._getVertexBuffer=function(X$m){return void 0===X$m&&(X$m=0),null},X$p._getIndexBuffer=function(){return null},X$p._beforeRender=function(X$m){return!0},X$p._render=function(X$m){},X$p._getVertexBuffers=function(){return null},X$A(0,X$p,"_vertexBufferCount",function(){return 1}),X$A(0,X$p,"triangleCount",function(){return 0}),X$m.combine=function(X$m){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),X$Pm.combine(X$m)},X$m.maxBatchVertexCount=65535,X$m}(),X$qm=function(){function X$k(X$m,X$p){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++X$k._uniqueIDCounter,this._id>X$k.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",X$k.maxVertexDeclaration);this._shaderValues=new X$Rp,this._vertexElementsDic={},this._vertexStride=X$m,this._vertexElements=X$p;for(var X$h=0;X$h<X$p.length;X$h++){var X$P=X$p[X$h],X$L=X$P.elementUsage;this._vertexElementsDic[X$L]=X$P;var X$q=[X$k._getTypeSize(X$P.elementFormat)/4,5126,!1,this._vertexStride,X$P.offset];switch(this._shaderValues.setValue(X$L,X$q),X$L){case 1:this._addShaderDefine(X$Ip.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(X$Ip.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(X$Ip.SHADERDEFINE_UV1)}}}X$$(X$k,"laya.d3.graphics.VertexDeclaration");var X$m=X$k.prototype;return X$m._addShaderDefine=function(X$m){this._shaderDefineValue|=X$m},X$m._removeShaderDefine=function(X$m){this._shaderDefineValue&=~X$m},X$m.getVertexElements=function(){return this._vertexElements.slice()},X$m.getVertexElementByUsage=function(X$m){return this._vertexElementsDic[X$m]},X$m.unBinding=function(){},X$A(0,X$m,"shaderDefineValue",function(){return this._shaderDefineValue}),X$A(0,X$m,"id",function(){return this._id}),X$A(0,X$m,"vertexStride",function(){return this._vertexStride}),X$A(0,X$m,"shaderValues",function(){return this._shaderValues}),X$k._getTypeSize=function(X$m){switch(X$m){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},X$k.getVertexStride=function(X$m){for(var X$p=0,X$h=0;X$h<X$m.Length;X$h++){var X$P=X$m[X$h],X$L=X$P.offset+X$k._getTypeSize(X$P.elementFormat);X$p<X$L&&(X$p=X$L)}return X$p},X$k._maxVertexDeclarationBit=1e3,X$k._uniqueIDCounter=1,X$F(X$k,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),X$k}(),X$km=function(){function X$m(X$m,X$p,X$h){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=X$m,this.elementFormat=X$p,this.elementUsage=X$h}return X$$(X$m,"laya.d3.graphics.VertexElement"),X$m}(),X$Ym=(function(){function X$m(){}X$$(X$m,"laya.d3.graphics.VertexElementFormat"),X$m.Single="single",X$m.Vector2="vector2",X$m.Vector3="vector3",X$m.Vector4="vector4",X$m.Color="color",X$m.Byte4="byte4",X$m.Short2="short2",X$m.Short4="short4",X$m.NormalizedShort2="normalizedshort2",X$m.NormalizedShort4="normalizedshort4",X$m.HalfVector2="halfvector2",X$m.HalfVector4="halfvector4"}(),function(){function X$m(){}X$$(X$m,"laya.d3.graphics.VertexElementUsage"),X$m.POSITION0=0,X$m.COLOR0=1,X$m.TEXTURECOORDINATE0=2,X$m.NORMAL0=3,X$m.BINORMAL0=4,X$m.TANGENT0=5,X$m.BLENDINDICES0=6,X$m.BLENDWEIGHT0=7,X$m.DEPTH0=8,X$m.FOG0=9,X$m.POINTSIZE0=10,X$m.SAMPLE0=11,X$m.TESSELLATEFACTOR0=12,X$m.COLOR1=13,X$m.NEXTTEXTURECOORDINATE0=14,X$m.TEXTURECOORDINATE1=15,X$m.NEXTTEXTURECOORDINATE1=16,X$m.CORNERTEXTURECOORDINATE0=17,X$m.VELOCITY0=18,X$m.STARTCOLOR0=19,X$m.STARTSIZE=20,X$m.AGEADDSCALE0=21,X$m.STARTROTATION=22,X$m.ENDCOLOR0=23,X$m.STARTLIFETIME=24,X$m.TIME0=33,X$m.SHAPEPOSITIONSTARTLIFETIME=30,X$m.DIRECTIONTIME=32,X$m.SIZEROTATION0=27,X$m.RADIUS0=28,X$m.RADIAN0=29,X$m.STARTSPEED=31,X$m.RANDOM0=34,X$m.RANDOM1=35,X$m.SIMULATIONWORLDPOSTION=36,X$m.SIMULATIONWORLDROTATION=37,X$m.TEXTURECOORDINATE0X=38,X$m.TEXTURECOORDINATE0X1=39,X$m.TEXTURECOORDINATE0Y=40,X$m.OFFSETVECTOR=41}(),function(){function X$m(X$m,X$p,X$h){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=X$m,this._textureCoordinate0=X$p,this._time=X$h}X$$(X$m,"laya.d3.graphics.VertexGlitter");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate0}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"time",function(){return this._time}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(24,[new X$km(0,"vector3",0),new X$km(12,"vector2",2),new X$km(20,"single",33)])}])}(),function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=X$m,this._position=X$p,this._velocity=X$h,this._startColor=X$P,this._endColor=X$L,this._sizeRotation=X$q,this._radius=X$k,this._radian=X$Y,this._ageAddScale=X$d,this._time=X$K}X$$(X$m,"laya.d3.graphics.VertexParticle");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"endColor",function(){return this._endColor}),X$A(0,X$p,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),X$A(0,X$p,"sizeRotation",function(){return this._sizeRotation}),X$A(0,X$p,"velocity",function(){return this._velocity}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"startColor",function(){return this._startColor}),X$A(0,X$p,"radius",function(){return this._radius}),X$A(0,X$p,"radian",function(){return this._radian}),X$A(0,X$p,"ageAddScale",function(){return this._ageAddScale}),X$A(0,X$p,"time",function(){return this._time}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(116,[new X$km(0,"vector4",17),new X$km(16,"vector3",0),new X$km(28,"vector3",18),new X$km(40,"vector4",19),new X$km(56,"vector4",23),new X$km(72,"vector3",27),new X$km(84,"vector2",28),new X$km(92,"vector4",29),new X$km(108,"single",24),new X$km(112,"single",33)])}])}(),function(){function X$m(X$m){this._position=null,this._position=X$m}X$$(X$m,"laya.d3.graphics.VertexPosition");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(12,[new X$km(0,"vector3",0)])}]),X$m}()),X$dm=function(){function X$m(X$m,X$p){this._position=null,this._normal=null,this._position=X$m,this._normal=X$p}X$$(X$m,"laya.d3.graphics.VertexPositionNormal");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(24,[new X$km(0,"vector3",0),new X$km(12,"vector3",3)])}]),X$m}(),X$Km=function(){function X$m(X$m,X$p,X$h){this._position=null,this._normal=null,this._color=null,this._position=X$m,this._normal=X$p,this._color=X$h}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColor");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(40,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1)])}]),X$m}(),X$Dm=function(){function X$m(X$m,X$p,X$h,X$P,X$L){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._blendIndex=X$P,this._blendWeight=X$L}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorSkin");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(72,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector4",7),new X$km(56,"vector4",6)])}]),X$m}(),X$Fm=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._tangent=X$P,this._blendIndex=X$L,this._blendWeight=X$q}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(88,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector4",7),new X$km(56,"vector4",6),new X$km(72,"vector4",5)])}]),X$m}(),X$Rm=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._tangent=X$P,this._blendIndex=X$L,this._blendWeight=X$q}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(84,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector4",7),new X$km(56,"vector4",6),new X$km(72,"vector3",5)])}]),X$m}(),X$$m=function(){function X$m(X$m,X$p,X$h,X$P){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._tangent=X$P}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorSTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(56,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector4",5)])}]),X$m}(),X$Am=function(){function X$m(X$m,X$p,X$h,X$P){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._tangent=X$P}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(52,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector3",5)])}]),X$m}(),X$Bm=function(){function X$m(X$m,X$p,X$h,X$P){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._textureCoordinate=X$P}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorTexture");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(48,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector2",2)])}]),X$m}(),X$nm=function(){function X$m(X$m,X$p,X$h,X$P,X$L){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._textureCoordinate0=X$P,this._textureCoordinate1=X$L}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(0,X$p,"textureCoordinate1",function(){return this._textureCoordinate1}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(56,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector2",2),new X$km(48,"vector2",15)])}]),X$m}(),X$cm=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._textureCoordinate0=X$P,this._textureCoordinate1=X$L,this._blendIndex=X$q,this._blendWeight=X$k}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(0,X$p,"textureCoordinate1",function(){return this._textureCoordinate1}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(88,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector2",2),new X$km(48,"vector2",15),new X$km(56,"vector4",7),new X$km(72,"vector4",6)])}]),X$m}(),X$em=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._textureCoordinate0=X$P,this._textureCoordinate1=X$L,this._tangent=X$q,this._blendIndex=X$k,this._blendWeight=X$Y}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(0,X$p,"textureCoordinate1",function(){return this._textureCoordinate1}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(104,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector2",2),new X$km(48,"vector2",15),new X$km(56,"vector4",7),new X$km(72,"vector4",6),new X$km(88,"vector4",5)])}]),X$m}(),X$am=function(){function X$m(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$p.VertexPositionNormalColorTexture0SkinTangent=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){this._position=X$m,this._normal=X$p,this._color=X$h,this._textureCoordinate0=X$P,this._textureCoordinate1=X$L,this._tangent=X$q,this._blendIndex=X$k,this._blendWeight=X$Y},X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(0,X$p,"textureCoordinate1",function(){return this._textureCoordinate1}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(100,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector2",2),new X$km(48,"vector2",15),new X$km(56,"vector4",7),new X$km(72,"vector4",6),new X$km(88,"vector3",5)])}]),X$m}(),X$Zm=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._textureCoordinate0=X$P,this._textureCoordinate1=X$L,this._tangent=X$q}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(0,X$p,"textureCoordinate1",function(){return this._textureCoordinate1}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(72,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector2",2),new X$km(48,"vector2",15),new X$km(56,"vector4",5)])}]),X$m}(),X$Hm=function(){function X$m(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$p.VertexPositionNormalColorTexture0Tangent=function(X$m,X$p,X$h,X$P,X$L,X$q){this._position=X$m,this._normal=X$p,this._color=X$h,this._textureCoordinate0=X$P,this._textureCoordinate1=X$L,this._tangent=X$q},X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(0,X$p,"textureCoordinate1",function(){return this._textureCoordinate1}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(68,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector2",2),new X$km(48,"vector2",15),new X$km(56,"vector3",5)])}]),X$m}(),X$Wm=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._textureCoordinate=X$P,this._blendIndex=X$L,this._blendWeight=X$q}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(80,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector2",2),new X$km(48,"vector4",7),new X$km(64,"vector4",6)])}]),X$m}(),X$Em=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._textureCoordinate=X$P,this._tangent=X$L,this._blendIndex=X$q,this._blendWeight=X$k}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(96,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector2",2),new X$km(48,"vector4",7),new X$km(64,"vector4",6),new X$km(80,"vector4",5)])}]),X$m}(),X$Im=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._textureCoordinate=X$P,this._tangent=X$L,this._blendIndex=X$q,this._blendWeight=X$k}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(92,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector2",2),new X$km(48,"vector4",7),new X$km(64,"vector4",6),new X$km(80,"vector3",5)])}]),X$m}(),X$bm=function(){function X$m(X$m,X$p,X$h,X$P,X$L){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._textureCoordinate=X$P,this._tangent=X$L}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(64,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector2",2),new X$km(48,"vector4",5)])}]),X$m}(),X$Tm=function(){function X$m(X$m,X$p,X$h,X$P,X$L){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._color=X$h,this._textureCoordinate=X$P,this._tangent=X$L}X$$(X$m,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"color",function(){return this._color}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(60,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",1),new X$km(40,"vector2",2),new X$km(48,"vector3",5)])}]),X$m}(),X$jm=function(){function X$m(X$m,X$p,X$h){this._position=null,this._normal=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._tangent=X$h}X$$(X$m,"laya.d3.graphics.VertexPositionNormalSTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(40,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector4",5)])}]),X$m}(),X$xm=function(){function X$m(X$m,X$p,X$h){this._position=null,this._normal=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._tangent=X$h}X$$(X$m,"laya.d3.graphics.VertexPositionNormalTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(36,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector3",5)])}]),X$m}(),X$Qm=function(){function X$m(X$m,X$p,X$h){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=X$m,this._normal=X$p,this._textureCoordinate=X$h}X$$(X$m,"laya.d3.graphics.VertexPositionNormalTexture");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(32,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector2",2)])}]),X$m}(),X$Mm=function(){function X$m(X$m,X$p,X$h,X$P){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=X$m,this._normal=X$p,this._textureCoordinate0=X$h,this._textureCoordinate1=X$P}X$$(X$m,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(0,X$p,"textureCoordinate1",function(){return this._textureCoordinate1}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(40,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector2",2),new X$km(32,"vector2",15)])}]),X$m}(),X$um=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=X$m,this._normal=X$p,this._textureCoordinate0=X$h,this._textureCoordinate1=X$P,this._blendIndex=X$L,this._blendWeight=X$q}X$$(X$m,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(0,X$p,"textureCoordinate1",function(){return this._textureCoordinate1}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(72,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector2",2),new X$km(32,"vector2",15),new X$km(40,"vector4",7),new X$km(56,"vector4",6)])}]),X$m}(),X$Nm=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._textureCoordinate0=X$h,this._textureCoordinate1=X$P,this._tangent=X$L,this._blendIndex=X$q,this._blendWeight=X$k}X$$(X$m,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(0,X$p,"textureCoordinate1",function(){return this._textureCoordinate1}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(88,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector2",2),new X$km(32,"vector2",15),new X$km(40,"vector4",7),new X$km(56,"vector4",6),new X$km(72,"vector4",5)])}]),X$m}(),X$Sm=function(){function X$m(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}X$$(X$m,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$p.VertexPositionNormalTexture0SkinTangent=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){this._position=X$m,this._normal=X$p,this._textureCoordinate0=X$h,this._textureCoordinate1=X$P,this._tangent=X$L,this._blendIndex=X$q,this._blendWeight=X$k},X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(0,X$p,"textureCoordinate1",function(){return this._textureCoordinate1}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(84,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector2",2),new X$km(32,"vector2",15),new X$km(40,"vector4",7),new X$km(56,"vector4",6),new X$km(72,"vector3",5)])}]),X$m}(),X$_m=function(){function X$m(X$m,X$p,X$h,X$P,X$L){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._textureCoordinate0=X$h,this._textureCoordinate1=X$P,this._tangent=X$L}X$$(X$m,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(0,X$p,"textureCoordinate1",function(){return this._textureCoordinate1}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(56,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector2",2),new X$km(32,"vector2",15),new X$km(40,"vector4",5)])}]),X$m}(),X$lm=function(){function X$m(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}X$$(X$m,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$p.VertexPositionNormalTexture0Tangent=function(X$m,X$p,X$h,X$P,X$L){this._position=X$m,this._normal=X$p,this._textureCoordinate0=X$h,this._textureCoordinate1=X$P,this._tangent=X$L},X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(0,X$p,"textureCoordinate1",function(){return this._textureCoordinate1}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(52,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector2",2),new X$km(32,"vector2",15),new X$km(40,"vector3",5)])}]),X$m}(),X$Jm=function(){function X$m(X$m,X$p,X$h,X$P,X$L){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=X$m,this._normal=X$p,this._textureCoordinate=X$h,this._blendIndex=X$P,this._blendWeight=X$L}X$$(X$m,"laya.d3.graphics.VertexPositionNormalTextureSkin");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(64,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector2",2),new X$km(32,"vector4",7),new X$km(48,"vector4",6)])}]),X$m}(),X$zm=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._textureCoordinate=X$h,this._tangent=X$P,this._blendIndex=X$L,this._blendWeight=X$q}X$$(X$m,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(80,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector2",2),new X$km(32,"vector4",7),new X$km(48,"vector4",6),new X$km(64,"vector4",5)])}]),X$m}(),X$wm=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._textureCoordinate=X$h,this._tangent=X$P,this._blendIndex=X$L,this._blendWeight=X$q}X$$(X$m,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(76,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector2",2),new X$km(32,"vector4",7),new X$km(48,"vector4",6),new X$km(64,"vector3",5)])}]),X$m}(),X$Xm=function(){function X$m(X$m,X$p,X$h,X$P){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._textureCoordinate=X$h,this._tangent=X$P}X$$(X$m,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(48,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector2",2),new X$km(32,"vector4",5)])}]),X$m}(),X$sm=function(){function X$m(X$m,X$p,X$h,X$P){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=X$m,this._normal=X$p,this._textureCoordinate=X$h,this._tangent=X$P}X$$(X$m,"laya.d3.graphics.VertexPositionNormalTextureTangent");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(44,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector2",2),new X$km(32,"vector3",5)])}]),X$m}(),X$Gm=function(){function X$m(X$m,X$p,X$h){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=X$m,this._normal=X$p,this._textureCoordinate=X$h}X$$(X$m,"laya.d3.graphics.VertexPositionNTBTexture");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(56,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector3",5),new X$km(36,"vector3",4),new X$km(48,"vector2",2)])}]),X$m}(),X$Um=function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=X$m,this._normal=X$p,this._textureCoordinate0=X$P,this._textureCoordinate1=X$L,this._tangent=X$q,X$h=X$h,this._blendIndex=X$k,this._blendWeight=X$Y}X$$(X$m,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"tangent",function(){return this._tangent}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(0,X$p,"textureCoordinate1",function(){return this._textureCoordinate1}),X$A(0,X$p,"blendIndex",function(){return this._blendIndex}),X$A(0,X$p,"blendWeight",function(){return this._blendWeight}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(96,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector3",5),new X$km(36,"vector3",4),new X$km(48,"vector2",2),new X$km(56,"vector2",15),new X$km(64,"vector4",7),new X$km(80,"vector4",6)])}]),X$m}(),X$rm=function(){function X$m(X$m,X$p,X$h){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=X$m,this._normal=X$p,this._textureCoordinate=X$h}X$$(X$m,"laya.d3.graphics.VertexPositionNTBTextureSkin");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"textureCoordinate",function(){return this._textureCoordinate}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(88,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector3",5),new X$km(36,"vector3",4),new X$km(48,"vector2",2),new X$km(56,"vector4",7),new X$km(72,"vector4",6)])}]),X$m}(),X$ym=(function(){function X$m(X$m,X$p,X$h,X$P){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=X$m,this._normal=X$p,this._textureCoord0=X$h,this._textureCoord1=X$P}X$$(X$m,"laya.d3.graphics.VertexPositionTerrain");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"normal",function(){return this._normal}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"textureCoord0",function(){return this._textureCoord0}),X$A(0,X$p,"textureCoord1",function(){return this._textureCoord1}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(40,[new X$km(0,"vector3",0),new X$km(12,"vector3",3),new X$km(24,"vector2",2),new X$km(32,"vector2",15)])}])}(),function(){function X$m(X$m,X$p){this._position=null,this._textureCoordinate0=null,this._position=X$m,this._textureCoordinate0=X$p}X$$(X$m,"laya.d3.graphics.VertexPositionTexture0");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"position",function(){return this._position}),X$A(0,X$p,"textureCoordinate0",function(){return this._textureCoordinate0}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(20,[new X$km(0,"vector3",0),new X$km(12,"vector2",2)])}]),X$m}()),X$Vm=(function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D,X$F,X$R,X$$){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=X$m,this._positionStartLifeTime=X$p,this._velocity=X$h,this._startColor=X$P,this._startSize=X$L,this._startRotation0=X$q,this._startRotation1=X$k,this._startRotation2=X$Y,this._startLifeTime=X$d,this._time=X$K,this._startSpeed=X$D,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=X$$}X$$(X$m,"laya.d3.graphics.VertexShurikenParticleBillboard");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),X$A(0,X$p,"random1",function(){return this._randoms1}),X$A(0,X$p,"startRotation2",function(){return this._startRotation2}),X$A(0,X$p,"positionStartLifeTime",function(){return this._positionStartLifeTime}),X$A(0,X$p,"velocity",function(){return this._velocity}),X$A(0,X$p,"random0",function(){return this._randoms0}),X$A(0,X$p,"startSize",function(){return this._startSize}),X$A(0,X$p,"startColor",function(){return this._startColor}),X$A(0,X$p,"startRotation0",function(){return this._startRotation0}),X$A(0,X$p,"startRotation1",function(){return this._startRotation1}),X$A(0,X$p,"startLifeTime",function(){return this._startLifeTime}),X$A(0,X$p,"time",function(){return this._time}),X$A(0,X$p,"startSpeed",function(){return this._startSpeed}),X$A(0,X$p,"simulationWorldPostion",function(){return this._simulationWorldPostion}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(152,[new X$km(0,"vector4",17),new X$km(16,"vector4",30),new X$km(32,"vector4",32),new X$km(48,"vector4",19),new X$km(64,"vector3",20),new X$km(76,"vector3",22),new X$km(88,"single",31),new X$km(92,"vector4",34),new X$km(108,"vector4",35),new X$km(124,"vector3",36),new X$km(136,"vector4",37)])}])}(),function(){function X$m(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D,X$F,X$R,X$$){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=X$m,this._positionStartLifeTime=X$p,this._velocity=X$h,this._startColor=X$P,this._startSize=X$L,this._startRotation0=X$q,this._startRotation1=X$k,this._startRotation2=X$Y,this._startLifeTime=X$d,this._time=X$K,this._startSpeed=X$D,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=X$$}X$$(X$m,"laya.d3.graphics.VertexShurikenParticleMesh");var X$p=X$m.prototype;X$H.imps(X$p,{"laya.d3.graphics.IVertex":!0}),X$A(0,X$p,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),X$A(0,X$p,"velocity",function(){return this._velocity}),X$A(0,X$p,"position",function(){return this._positionStartLifeTime}),X$A(0,X$p,"random0",function(){return this._randoms0}),X$A(0,X$p,"startSize",function(){return this._startSize}),X$A(0,X$p,"startColor",function(){return this._startColor}),X$A(0,X$p,"startRotation0",function(){return this._startRotation0}),X$A(0,X$p,"startRotation1",function(){return this._startRotation1}),X$A(0,X$p,"random1",function(){return this._randoms1}),X$A(0,X$p,"startRotation2",function(){return this._startRotation2}),X$A(0,X$p,"startLifeTime",function(){return this._startLifeTime}),X$A(0,X$p,"time",function(){return this._time}),X$A(0,X$p,"startSpeed",function(){return this._startSpeed}),X$A(0,X$p,"simulationWorldPostion",function(){return this._simulationWorldPostion}),X$A(0,X$p,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$A(1,X$m,"vertexDeclaration",function(){return X$m._vertexDeclaration}),X$F(X$m,["_vertexDeclaration",function(){return this._vertexDeclaration=new X$qm(172,[new X$km(0,"vector3",0),new X$km(12,"vector4",1),new X$km(28,"vector2",2),new X$km(36,"vector4",30),new X$km(52,"vector4",32),new X$km(68,"vector4",19),new X$km(84,"vector3",20),new X$km(96,"vector3",22),new X$km(108,"single",31),new X$km(112,"vector4",34),new X$km(128,"vector4",35),new X$km(144,"vector3",36),new X$km(156,"vector4",37)])}])}(),function(){function X$a(X$m,X$p,X$h,X$P,X$L,X$q){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=X$h,this._materials=X$P,this._subMeshes=X$L,this._materialMap=X$q,this._version=X$p,this._onLoaded(X$m)}X$$(X$a,"laya.d3.loaders.LoadModelV01");var X$m=X$a.prototype;return X$m._onLoaded=function(X$m){this._readData=X$m,this.READ_BLOCK();for(var X$p=0;X$p<this._BLOCK.count;X$p++){var X$h=this._readData.getUint16(),X$P=this._strings[X$h],X$L=this["READ_"+X$P];if(null==X$L)throw new Error("model file err,no this function:"+X$h+" "+X$P);if(!X$L.call(this))break}return this._mesh},X$m.onError=function(){},X$m._readString=function(){return this._strings[this._readData.getUint16()]},X$m.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},X$m.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},X$m.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var X$m=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var X$p=0;X$p<this._STRINGS.size;X$p++)this._strings[X$p]=this._readData.readUTFString();return this._readData.pos=X$m,!0},X$m.READ_MATERIAL=function(){var X$m=this._readData.getUint16(),X$p=(this._readString(),this._readString());return this._materials[X$m]="null"!==X$p?X$c.getRes(this._materialMap[X$p]):new X$xp,!0},X$m.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var X$m,X$p=this._readData.__getBuffer(),X$h=0,X$P=this._readData.getUint32(),X$L=this._readData.getUint32(),X$q=(new Float32Array(X$p.slice(X$P+this._DATA.offset,X$P+this._DATA.offset+X$L)),this._readData.getUint32()),X$k=this._readData.getUint32(),X$Y=new Float32Array(X$p.slice(X$q+this._DATA.offset,X$q+this._DATA.offset+X$k));for(this.mesh._inverseBindPoses=[],X$h=0,X$m=X$Y.length;X$h<X$m;X$h+=16){var X$d=new X$mp(X$Y[X$h+0],X$Y[X$h+1],X$Y[X$h+2],X$Y[X$h+3],X$Y[X$h+4],X$Y[X$h+5],X$Y[X$h+6],X$Y[X$h+7],X$Y[X$h+8],X$Y[X$h+9],X$Y[X$h+10],X$Y[X$h+11],X$Y[X$h+12],X$Y[X$h+13],X$Y[X$h+14],X$Y[X$h+15]);this.mesh._inverseBindPoses.push(X$d)}break;default:throw new Error("LoadModel:unknown version.")}return!0},X$m.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var X$m=this._readString();this._shaderAttributes=X$m.match(X$a._attrReg);var X$p=this._readData.getUint32(),X$h=this._readData.getUint32(),X$P=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),X$L=this._readData.getUint32(),X$q=this._readData.getUint32(),X$k=this._readData.getUint32(),X$Y=this._readData.__getBuffer(),X$d=new X$Kp(this._mesh),X$K=this._getVertexDeclaration(),X$D=X$wp.create(X$K,X$L/X$K.vertexStride,35044,!0),X$F=X$P+this._DATA.offset,X$R=X$Y.slice(X$F,X$F+X$L);X$D.setData(new Float32Array(X$R));for(var X$$=(X$d._vertexBuffer=X$D).vertexDeclaration.getVertexElements(),X$A=0;X$A<X$$.length;X$A++)X$d._bufferUsage[X$$[X$A].elementUsage]=X$D;var X$B=X$zp.create("ushort",X$h/2,35044,!0),X$n=X$p+this._DATA.offset,X$c=X$Y.slice(X$n,X$n+X$h);X$B.setData(new Uint16Array(X$c)),X$d._indexBuffer=X$B;var X$e=X$Y.slice(X$q+this._DATA.offset,X$q+this._DATA.offset+X$k);return X$d._boneIndicesList[0]=new Uint8Array(X$e),this._subMeshes.push(X$d),!0},X$m.READ_DATAAREA=function(){return!1},X$m._getVertexDeclaration=function(){for(var X$m,X$p=!1,X$h=!1,X$P=!1,X$L=!1,X$q=!1,X$k=!1,X$Y=!1,X$d=!1,X$K=!1,X$D=0;X$D<this._shaderAttributes.length;X$D+=8)switch(this._shaderAttributes[X$D]){case"POSITION":X$p=!0;break;case"NORMAL":X$h=!0;break;case"COLOR":X$P=!0;break;case"UV":X$L=!0;break;case"UV1":X$q=!0;break;case"BLENDWEIGHT":X$Y=!0;break;case"BLENDINDICES":X$d=!0;break;case"TANGENT":X$k=!0;break;case"BINORMAL":X$K=!0}return X$p&&X$h&&X$P&&X$L&&X$q&&X$Y&&X$d&&X$k?X$m=X$am.vertexDeclaration:X$p&&X$h&&X$P&&X$L&&X$q&&X$Y&&X$d?X$m=X$cm.vertexDeclaration:X$p&&X$h&&X$L&&X$q&&X$Y&&X$d&&X$k?X$m=X$Sm.vertexDeclaration:X$p&&X$h&&X$L&&X$q&&X$Y&&X$d?X$m=X$um.vertexDeclaration:X$p&&X$h&&X$P&&X$L&&X$Y&&X$d&&X$k?X$m=X$Im.vertexDeclaration:X$p&&X$h&&X$P&&X$L&&X$Y&&X$d?X$m=X$Wm.vertexDeclaration:X$p&&X$h&&X$k&&X$K&&X$L&&X$Y&&X$d?X$m=X$rm.vertexDeclaration:X$p&&X$h&&X$L&&X$Y&&X$d&&X$k?X$m=X$wm.vertexDeclaration:X$p&&X$h&&X$L&&X$Y&&X$d?X$m=X$Jm.vertexDeclaration:X$p&&X$h&&X$P&&X$Y&&X$d&&X$k?X$m=X$Rm.vertexDeclaration:X$p&&X$h&&X$P&&X$Y&&X$d?X$m=X$Dm.vertexDeclaration:X$p&&X$h&&X$P&&X$L&&X$q&&X$k?X$m=X$Hm.vertexDeclaration:X$p&&X$h&&X$P&&X$L&&X$q?X$m=X$nm.vertexDeclaration:X$p&&X$h&&X$L&&X$q&&X$k?X$m=X$lm.vertexDeclaration:X$p&&X$h&&X$L&&X$q?X$m=X$Mm.vertexDeclaration:X$p&&X$h&&X$P&&X$L&&X$k?X$m=X$Tm.vertexDeclaration:X$p&&X$h&&X$L&&X$k&&X$K?X$m=X$Gm.vertexDeclaration:X$p&&X$h&&X$P&&X$L?X$m=X$Bm.vertexDeclaration:X$p&&X$h&&X$L&&X$k?X$m=X$sm.vertexDeclaration:X$p&&X$h&&X$L?X$m=X$Qm.vertexDeclaration:X$p&&X$h&&X$P&&X$k?X$m=X$Am.vertexDeclaration:X$p&&X$h&&X$P&&(X$m=X$Km.vertexDeclaration),X$m},X$A(0,X$m,"mesh",function(){return this._mesh}),X$a._attrReg=new RegExp("(\\w+)|([:,;])","g"),X$a}()),X$om=function(){function X$E(){}return X$$(X$E,"laya.d3.loaders.LoadModelV02"),X$E.parse=function(X$m,X$p,X$h,X$P,X$L,X$q){X$E._mesh=X$h,X$E._materials=X$P,X$E._subMeshes=X$L,X$E._materialMap=X$q,X$E._version=X$p,X$E._readData=X$m,X$E.READ_DATA(),X$E.READ_BLOCK(),X$E.READ_STRINGS();for(var X$k=0,X$Y=X$E._BLOCK.count;X$k<X$Y;X$k++){X$E._readData.pos=X$E._BLOCK.blockStarts[X$k];var X$d=X$E._readData.getUint16(),X$K=X$E._strings[X$d],X$D=X$E["READ_"+X$K];if(null==X$D)throw new Error("model file err,no this function:"+X$d+" "+X$K);X$D.call()}X$E._strings.length=0,X$E._readData=null,X$E._version=null,X$E._mesh=null,X$E._materials=null,X$E._subMeshes=null,X$E._materialMap=null},X$E._readString=function(){return X$E._strings[X$E._readData.getUint16()]},X$E.READ_DATA=function(){X$E._DATA.offset=X$E._readData.getUint32(),X$E._DATA.size=X$E._readData.getUint32()},X$E.READ_BLOCK=function(){for(var X$m=X$E._BLOCK.count=X$E._readData.getUint16(),X$p=X$E._BLOCK.blockStarts=[],X$h=X$E._BLOCK.blockLengths=[],X$P=0;X$P<X$m;X$P++)X$p.push(X$E._readData.getUint32()),X$h.push(X$E._readData.getUint32())},X$E.READ_STRINGS=function(){var X$m=X$E._readData.getUint32(),X$p=X$E._readData.getUint16(),X$h=X$E._readData.pos;X$E._readData.pos=X$m+X$E._DATA.offset;for(var X$P=0;X$P<X$p;X$P++)X$E._strings[X$P]=X$E._readData.readUTFString();X$E._readData.pos=X$h},X$E.READ_MATERIAL=function(){X$E._readString(),X$E._readString();var X$m=X$E._readString();return""!==X$m&&X$E._materials.push(X$c.getRes(X$E._materialMap[X$m])),!0},X$E.READ_MESH=function(){X$E._readString();var X$m,X$p=X$E._readData.__getBuffer(),X$h=0,X$P=X$E._readData.getInt16(),X$L=X$E._DATA.offset;for(X$h=0;X$h<X$P;X$h++){var X$q=X$L+X$E._readData.getUint32(),X$k=X$E._readData.getUint32(),X$Y=new Float32Array(X$p.slice(X$q,X$q+X$k)),X$d=X$E._readString().match(X$E._attrReg),X$K=X$E._getVertexDeclaration(X$d),X$D=X$wp.create(X$K,4*X$Y.length/X$K.vertexStride,35044,!0);X$D.setData(X$Y),X$E._mesh._vertexBuffers.push(X$D)}var X$F=X$L+X$E._readData.getUint32(),X$R=X$E._readData.getUint32(),X$$=new Uint16Array(X$p.slice(X$F,X$F+X$R)),X$A=X$zp.create("ushort",X$R/2,35044,!0);X$A.setData(X$$),X$E._mesh._indexBuffer=X$A;var X$B=X$E._mesh._boneNames=[],X$n=X$E._readData.getUint16();for(X$B.length=X$n,X$h=0;X$h<X$n;X$h++)X$B[X$h]=X$E._strings[X$E._readData.getUint16()];var X$c=X$E._readData.getUint32(),X$e=X$E._readData.getUint32(),X$a=(new Float32Array(X$p.slice(X$L+X$c,X$L+X$c+X$e)),X$E._readData.getUint32()),X$Z=X$E._readData.getUint32(),X$H=new Float32Array(X$p.slice(X$L+X$a,X$L+X$a+X$Z));for(X$E._mesh._inverseBindPoses=[],X$h=0,X$m=X$H.length;X$h<X$m;X$h+=16){var X$W=new X$mp(X$H[X$h+0],X$H[X$h+1],X$H[X$h+2],X$H[X$h+3],X$H[X$h+4],X$H[X$h+5],X$H[X$h+6],X$H[X$h+7],X$H[X$h+8],X$H[X$h+9],X$H[X$h+10],X$H[X$h+11],X$H[X$h+12],X$H[X$h+13],X$H[X$h+14],X$H[X$h+15]);X$E._mesh._inverseBindPoses.push(X$W)}return X$E._mesh._skinnedDatas=new Float32Array(16*X$H.length),!0},X$E.READ_SUBMESH=function(){var X$m=X$E._readData.__getBuffer(),X$p=new X$Kp(X$E._mesh),X$h=X$E._readData.getInt16(),X$P=X$E._readData.getUint32(),X$L=X$E._readData.getUint32();X$p._vertexBuffer=X$E._mesh._vertexBuffers[X$h],X$p._vertexStart=X$P,X$p._vertexCount=X$L;var X$q=X$E._readData.getUint32(),X$k=X$E._readData.getUint32(),X$Y=X$E._mesh._indexBuffer;X$p._indexBuffer=X$Y,X$p._indexStart=X$q,X$p._indexCount=X$k,X$p._indices=new Uint16Array(X$Y.getData().buffer,2*X$q,X$k);var X$d=X$E._DATA.offset,X$K=X$p._subIndexBufferStart,X$D=X$p._subIndexBufferCount,X$F=X$p._boneIndicesList,X$R=X$E._readData.getUint16();X$K.length=X$R,X$D.length=X$R,X$F.length=X$R;for(var X$$=0;X$$<X$R;X$$++){X$K[X$$]=X$E._readData.getUint32(),X$D[X$$]=X$E._readData.getUint32();var X$A=X$E._readData.getUint32(),X$B=X$E._readData.getUint32();X$p._boneIndicesList[X$$]=new Uint8Array(X$m.slice(X$d+X$A,X$d+X$A+X$B))}return X$E._subMeshes.push(X$p),!0},X$E._getVertexDeclaration=function(X$m){for(var X$p,X$h=!1,X$P=!1,X$L=!1,X$q=!1,X$k=!1,X$Y=!1,X$d=!1,X$K=!1,X$D=!1,X$F=0;X$F<X$m.length;X$F++)switch(X$m[X$F]){case"POSITION":X$h=!0;break;case"NORMAL":X$P=!0;break;case"COLOR":X$L=!0;break;case"UV":X$q=!0;break;case"UV1":X$k=!0;break;case"BLENDWEIGHT":X$d=!0;break;case"BLENDINDICES":X$K=!0;break;case"TANGENT":X$Y=!0;break;case"BINORMAL":X$D=!0}return X$h&&X$P&&X$L&&X$q&&X$k&&X$d&&X$K&&X$Y?X$p=X$am.vertexDeclaration:X$h&&X$P&&X$L&&X$q&&X$k&&X$d&&X$K?X$p=X$cm.vertexDeclaration:X$h&&X$P&&X$q&&X$k&&X$d&&X$K&&X$Y?X$p=X$Sm.vertexDeclaration:X$h&&X$P&&X$q&&X$k&&X$d&&X$K?X$p=X$um.vertexDeclaration:X$h&&X$P&&X$L&&X$q&&X$d&&X$K&&X$Y?X$p=X$Im.vertexDeclaration:X$h&&X$P&&X$L&&X$q&&X$d&&X$K?X$p=X$Wm.vertexDeclaration:X$h&&X$P&&X$q&&X$d&&X$K&&X$Y?X$p=X$wm.vertexDeclaration:X$h&&X$P&&X$q&&X$d&&X$K?X$p=X$Jm.vertexDeclaration:X$h&&X$P&&X$L&&X$d&&X$K&&X$Y?X$p=X$Rm.vertexDeclaration:X$h&&X$P&&X$L&&X$d&&X$K?X$p=X$Dm.vertexDeclaration:X$h&&X$P&&X$L&&X$q&&X$k&&X$Y?X$p=X$Hm.vertexDeclaration:X$h&&X$P&&X$L&&X$q&&X$k?X$p=X$nm.vertexDeclaration:X$h&&X$P&&X$q&&X$k&&X$Y?X$p=X$lm.vertexDeclaration:X$h&&X$P&&X$q&&X$k?X$p=X$Mm.vertexDeclaration:X$h&&X$P&&X$L&&X$q&&X$Y?X$p=X$Tm.vertexDeclaration:X$h&&X$P&&X$q&&X$Y&&X$D?X$p=X$Gm.vertexDeclaration:X$h&&X$P&&X$L&&X$q?X$p=X$Bm.vertexDeclaration:X$h&&X$P&&X$q&&X$Y?X$p=X$sm.vertexDeclaration:X$h&&X$P&&X$q?X$p=X$Qm.vertexDeclaration:X$h&&X$P&&X$L&&X$Y?X$p=X$Am.vertexDeclaration:X$h&&X$P&&X$L&&(X$p=X$Km.vertexDeclaration),X$p},X$E._attrReg=new RegExp("(\\w+)|([:,;])","g"),X$E._strings=[],X$E._readData=null,X$E._version=null,X$E._mesh=null,X$E._materials=null,X$E._subMeshes=null,X$E._materialMap=null,X$F(X$E,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),X$E}(),X$fm=function(){function X$W(){}return X$$(X$W,"laya.d3.loaders.LoadModelV03"),X$W.parse=function(X$m,X$p,X$h,X$P,X$L){X$W._mesh=X$h,X$W._subMeshes=X$P,X$W._materialMap=X$L,X$W._version=X$p,X$W._readData=X$m,X$W.READ_DATA(),X$W.READ_BLOCK(),X$W.READ_STRINGS();for(var X$q=0,X$k=X$W._BLOCK.count;X$q<X$k;X$q++){X$W._readData.pos=X$W._BLOCK.blockStarts[X$q];var X$Y=X$W._readData.getUint16(),X$d=X$W._strings[X$Y],X$K=X$W["READ_"+X$d];if(null==X$K)throw new Error("model file err,no this function:"+X$Y+" "+X$d);X$K.call()}X$W._strings.length=0,X$W._readData=null,X$W._version=null,X$W._mesh=null,X$W._subMeshes=null,X$W._materialMap=null},X$W._readString=function(){return X$W._strings[X$W._readData.getUint16()]},X$W.READ_DATA=function(){X$W._DATA.offset=X$W._readData.getUint32(),X$W._DATA.size=X$W._readData.getUint32()},X$W.READ_BLOCK=function(){for(var X$m=X$W._BLOCK.count=X$W._readData.getUint16(),X$p=X$W._BLOCK.blockStarts=[],X$h=X$W._BLOCK.blockLengths=[],X$P=0;X$P<X$m;X$P++)X$p.push(X$W._readData.getUint32()),X$h.push(X$W._readData.getUint32())},X$W.READ_STRINGS=function(){var X$m=X$W._readData.getUint32(),X$p=X$W._readData.getUint16(),X$h=X$W._readData.pos;X$W._readData.pos=X$m+X$W._DATA.offset;for(var X$P=0;X$P<X$p;X$P++)X$W._strings[X$P]=X$W._readData.readUTFString();X$W._readData.pos=X$h},X$W.READ_MESH=function(){var X$m,X$p=X$W._readString(),X$h=X$W._readData.__getBuffer(),X$P=0,X$L=X$W._readData.getInt16(),X$q=X$W._DATA.offset;for(X$P=0;X$P<X$L;X$P++){var X$k,X$Y=X$q+X$W._readData.getUint32(),X$d=X$W._readData.getUint32(),X$K=new Float32Array(X$h.slice(X$Y,X$Y+X$d)),X$D=X$W._readString();switch(X$W._version){case"LAYAMODEL:03":X$k=X$W._vertexDeclarationMap_Discard[X$D];break;case"LAYAMODEL:0301":X$k=X$W._vertexDeclarationMap[X$D];break;default:throw new Error("LoadModelV03: unknown version.")}if(!X$k)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+X$W._version+"  bufferAttribute="+X$D+"  name="+X$p+"  url="+(X$W._mesh?X$W._mesh.url:"null"));var X$F=X$wp.create(X$k,4*X$K.length/X$k.vertexStride,35044,!0,X$W._mesh._url+"_"+X$P);X$F.setData(X$K),X$W._mesh._vertexBuffers.push(X$F)}var X$R=X$q+X$W._readData.getUint32(),X$$=X$W._readData.getUint32(),X$A=new Uint16Array(X$h.slice(X$R,X$R+X$$)),X$B=X$zp.create("ushort",X$$/2,35044,!0,X$W._mesh._url);X$B.setData(X$A),X$W._mesh._indexBuffer=X$B;var X$n=X$W._mesh._boneNames=[],X$c=X$W._readData.getUint16();for(X$n.length=X$c,X$P=0;X$P<X$c;X$P++)X$n[X$P]=X$W._strings[X$W._readData.getUint16()];X$W._readData.pos+=8;var X$e=X$W._readData.getUint32(),X$a=X$W._readData.getUint32(),X$Z=new Float32Array(X$h.slice(X$q+X$e,X$q+X$e+X$a));for(X$W._mesh._inverseBindPoses=[],X$P=0,X$m=X$Z.length;X$P<X$m;X$P+=16){var X$H=new X$mp(X$Z[X$P+0],X$Z[X$P+1],X$Z[X$P+2],X$Z[X$P+3],X$Z[X$P+4],X$Z[X$P+5],X$Z[X$P+6],X$Z[X$P+7],X$Z[X$P+8],X$Z[X$P+9],X$Z[X$P+10],X$Z[X$P+11],X$Z[X$P+12],X$Z[X$P+13],X$Z[X$P+14],X$Z[X$P+15]);X$W._mesh._inverseBindPoses.push(X$H)}return X$W._mesh._skinnedDatas=new Float32Array(16*X$Z.length),!0},X$W.READ_SUBMESH=function(){var X$m=X$W._readData.__getBuffer(),X$p=new X$Kp(X$W._mesh),X$h=X$W._readData.getInt16(),X$P=X$W._readData.getUint32(),X$L=X$W._readData.getUint32();X$p._vertexBuffer=X$W._mesh._vertexBuffers[X$h],X$p._vertexStart=X$P,X$p._vertexCount=X$L;var X$q=X$W._readData.getUint32(),X$k=X$W._readData.getUint32(),X$Y=X$W._mesh._indexBuffer;X$p._indexBuffer=X$Y,X$p._indexStart=X$q,X$p._indexCount=X$k,X$p._indices=new Uint16Array(X$Y.getData().buffer,2*X$q,X$k);var X$d=X$W._DATA.offset,X$K=X$p._subIndexBufferStart,X$D=X$p._subIndexBufferCount,X$F=X$p._boneIndicesList,X$R=X$W._readData.getUint16();X$K.length=X$R,X$D.length=X$R,X$F.length=X$R;for(var X$$=0;X$$<X$R;X$$++){X$K[X$$]=X$W._readData.getUint32(),X$D[X$$]=X$W._readData.getUint32();var X$A=X$W._readData.getUint32(),X$B=X$W._readData.getUint32();X$F[X$$]=new Uint8Array(X$m.slice(X$d+X$A,X$d+X$A+X$B))}return X$W._subMeshes.push(X$p),!0},X$W._strings=[],X$W._readData=null,X$W._version=null,X$W._mesh=null,X$W._subMeshes=null,X$W._materialMap=null,X$F(X$W,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":X$am.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":X$cm.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":X$Um.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":X$Sm.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":X$um.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":X$Im.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":X$Wm.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":X$wm.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":X$Jm.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":X$Rm.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":X$Dm.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":X$Hm.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":X$nm.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":X$lm.vertexDeclaration,"POSITION,NORMAL,UV,UV1":X$Mm.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":X$Tm.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":X$Gm.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":X$Bm.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":X$sm.vertexDeclaration,"POSITION,NORMAL,UV":X$Qm.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":X$Am.vertexDeclaration,"POSITION,NORMAL,COLOR":X$Km.vertexDeclaration,"POSITION,NORMAL,TANGENT":X$xm.vertexDeclaration,"POSITION,NORMAL":X$dm.vertexDeclaration,"POSITION,UV":X$ym.vertexDeclaration,POSITION:X$Ym.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":X$em.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":X$cm.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":X$Um.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":X$Nm.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":X$um.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":X$Em.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":X$Wm.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":X$zm.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":X$Jm.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":X$Fm.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":X$Dm.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":X$Zm.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":X$nm.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":X$_m.vertexDeclaration,"POSITION,NORMAL,UV,UV1":X$Mm.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":X$bm.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":X$Gm.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":X$Bm.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":X$Xm.vertexDeclaration,"POSITION,NORMAL,UV":X$Qm.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":X$$m.vertexDeclaration,"POSITION,NORMAL,COLOR":X$Km.vertexDeclaration,"POSITION,NORMAL,TANGENT":X$jm.vertexDeclaration,"POSITION,NORMAL":X$dm.vertexDeclaration,"POSITION,UV":X$ym.vertexDeclaration,POSITION:X$Ym.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),X$W}(),X$im=function(){function X$Y(){}return X$$(X$Y,"laya.d3.loaders.MeshReader"),X$Y.read=function(X$m,X$p,X$h,X$P,X$L){var X$q=new X$W(X$m);X$q.pos=0;var X$k=X$q.readUTFString();switch(X$k){case"LAYAMODEL:01":case"LAYASKINANI:01":X$Y._readVersion01(X$q,X$k,X$p,X$h,X$P,X$L);break;case"LAYAMODEL:02":X$om.parse(X$q,X$k,X$p,X$h,X$P,X$L);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":X$fm.parse(X$q,X$k,X$p,X$P,X$L);break;default:throw new Error("MeshReader: unknown mesh version.")}X$p._setSubMeshes(X$P)},X$Y._readVersion01=function(X$m,X$p,X$h,X$P,X$L,X$q){new X$Vm(X$m,X$p,X$h,X$P,X$L,X$q)},X$Y}(),X$vm=function(){function X$m(X$m,X$p){this.min=null,this.max=null,this.min=X$m,this.max=X$p}X$$(X$m,"laya.d3.math.BoundBox");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p.getCorners=function(X$m){X$m.length=8;var X$p=this.min.elements,X$h=this.max.elements,X$P=X$p[0],X$L=X$p[1],X$q=X$p[2],X$k=X$h[0],X$Y=X$h[1],X$d=X$h[2];X$m[0]=new X$kp(X$P,X$Y,X$d),X$m[1]=new X$kp(X$k,X$Y,X$d),X$m[2]=new X$kp(X$k,X$L,X$d),X$m[3]=new X$kp(X$P,X$L,X$d),X$m[4]=new X$kp(X$P,X$Y,X$q),X$m[5]=new X$kp(X$k,X$Y,X$q),X$m[6]=new X$kp(X$k,X$L,X$q),X$m[7]=new X$kp(X$P,X$L,X$q)},X$p.toDefault=function(){this.min.toDefault(),this.max.toDefault()},X$p.cloneTo=function(X$m){var X$p=X$m;this.min.cloneTo(X$p.min),this.max.cloneTo(X$p.max)},X$p.clone=function(){var X$m=new this.constructor(new X$kp,new X$kp);return this.cloneTo(X$m),X$m},X$m.createfromPoints=function(X$m,X$p){if(null==X$m)throw new Error("points");var X$h=X$p.min,X$P=X$p.max,X$L=X$h.elements;X$L[0]=Number.MAX_VALUE,X$L[1]=Number.MAX_VALUE,X$L[2]=Number.MAX_VALUE;var X$q=X$P.elements;X$q[0]=-Number.MAX_VALUE,X$q[1]=-Number.MAX_VALUE,X$q[2]=-Number.MAX_VALUE;for(var X$k=0,X$Y=X$m.length;X$k<X$Y;++X$k)X$kp.min(X$h,X$m[X$k],X$h),X$kp.max(X$P,X$m[X$k],X$P)},X$m.merge=function(X$m,X$p,X$h){X$kp.min(X$m.min,X$p.min,X$h.min),X$kp.max(X$m.max,X$p.max,X$h.max)},X$m}(),X$gm=function(){function X$K(X$m){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=X$m,this._near=new X$pp(new X$kp),this._far=new X$pp(new X$kp),this._left=new X$pp(new X$kp),this._right=new X$pp(new X$kp),this._top=new X$pp(new X$kp),this._bottom=new X$pp(new X$kp),X$K._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}X$$(X$K,"laya.d3.math.BoundFrustum");var X$m=X$K.prototype;return X$m.equalsBoundFrustum=function(X$m){return this._matrix.equalsOtherMatrix(X$m.matrix)},X$m.equalsObj=function(X$m){if(X$m instanceof laya.d3.math.BoundFrustum){var X$p=X$m;return this.equalsBoundFrustum(X$p)}return!1},X$m.getPlane=function(X$m){switch(X$m){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},X$m.getCorners=function(X$m){X$K._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(X$m[0]),X$K._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(X$m[1]),X$K._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(X$m[2]),X$K._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(X$m[3]),X$K._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(X$m[4]),X$K._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(X$m[5]),X$K._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(X$m[6]),X$K._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(X$m[7])},X$m.containsPoint=function(X$m){for(var X$p=X$pp.PlaneIntersectionType_Front,X$h=X$pp.PlaneIntersectionType_Front,X$P=0;X$P<6;X$P++){switch(X$P){case 0:X$h=Collision.intersectsPlaneAndPoint(this._near,X$m);break;case 1:X$h=Collision.intersectsPlaneAndPoint(this._far,X$m);break;case 2:X$h=Collision.intersectsPlaneAndPoint(this._left,X$m);break;case 3:X$h=Collision.intersectsPlaneAndPoint(this._right,X$m);break;case 4:X$h=Collision.intersectsPlaneAndPoint(this._top,X$m);break;case 5:X$h=Collision.intersectsPlaneAndPoint(this._bottom,X$m)}switch(X$h){case X$pp.PlaneIntersectionType_Back:return 0;case X$pp.PlaneIntersectionType_Intersecting:X$p=X$pp.PlaneIntersectionType_Intersecting}}switch(X$p){case X$pp.PlaneIntersectionType_Intersecting:return 2;default:return 1}},X$m.containsBoundBox=function(X$m){for(var X$p,X$h=X$K._tempV30,X$P=X$K._tempV31,X$L=1,X$q=0;X$q<6;X$q++){if(X$p=this.getPlane(X$q),this._getBoxToPlanePVertexNVertex(X$m,X$p.normal,X$h,X$P),Collision.intersectsPlaneAndPoint(X$p,X$h)===X$pp.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(X$p,X$P)===X$pp.PlaneIntersectionType_Back&&(X$L=2)}return X$L},X$m.containsBoundSphere=function(X$m){for(var X$p=X$pp.PlaneIntersectionType_Front,X$h=X$pp.PlaneIntersectionType_Front,X$P=0;X$P<6;X$P++){switch(X$P){case 0:X$h=Collision.intersectsPlaneAndSphere(this._near,X$m);break;case 1:X$h=Collision.intersectsPlaneAndSphere(this._far,X$m);break;case 2:X$h=Collision.intersectsPlaneAndSphere(this._left,X$m);break;case 3:X$h=Collision.intersectsPlaneAndSphere(this._right,X$m);break;case 4:X$h=Collision.intersectsPlaneAndSphere(this._top,X$m);break;case 5:X$h=Collision.intersectsPlaneAndSphere(this._bottom,X$m)}switch(X$h){case X$pp.PlaneIntersectionType_Back:return 0;case X$pp.PlaneIntersectionType_Intersecting:X$p=X$pp.PlaneIntersectionType_Intersecting}}switch(X$p){case X$pp.PlaneIntersectionType_Intersecting:return 2;default:return 1}},X$m._getBoxToPlanePVertexNVertex=function(X$m,X$p,X$h,X$P){var X$L=X$m.min,X$q=X$L.elements,X$k=X$m.max,X$Y=X$k.elements,X$d=X$p.elements,X$K=X$d[0],X$D=X$d[1],X$F=X$d[2];X$L.cloneTo(X$h);var X$R=X$h.elements;0<=X$K&&(X$R[0]=X$Y[0]),0<=X$D&&(X$R[1]=X$Y[1]),0<=X$F&&(X$R[2]=X$Y[2]),X$k.cloneTo(X$P);var X$$=X$P.elements;0<=X$K&&(X$$[0]=X$q[0]),0<=X$D&&(X$$[1]=X$q[1]),0<=X$F&&(X$$[2]=X$q[2])},X$A(0,X$m,"top",function(){return this._top}),X$A(0,X$m,"matrix",function(){return this._matrix},function(X$m){this._matrix=X$m,X$K._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),X$A(0,X$m,"near",function(){return this._near}),X$A(0,X$m,"far",function(){return this._far}),X$A(0,X$m,"left",function(){return this._left}),X$A(0,X$m,"right",function(){return this._right}),X$A(0,X$m,"bottom",function(){return this._bottom}),X$K._getPlanesFromMatrix=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){var X$Y=X$m.elements,X$d=X$Y[0],X$K=X$Y[1],X$D=X$Y[2],X$F=X$Y[3],X$R=X$Y[4],X$$=X$Y[5],X$A=X$Y[6],X$B=X$Y[7],X$n=X$Y[8],X$c=X$Y[9],X$e=X$Y[10],X$a=X$Y[11],X$Z=X$Y[12],X$H=X$Y[13],X$W=X$Y[14],X$E=X$Y[15],X$I=X$p.normal.elements;X$I[0]=X$F+X$D,X$I[1]=X$B+X$A,X$I[2]=X$a+X$e,X$p.distance=X$E+X$W,X$p.normalize();var X$b=X$h.normal.elements;X$b[0]=X$F-X$D,X$b[1]=X$B-X$A,X$b[2]=X$a-X$e,X$h.distance=X$E-X$W,X$h.normalize();var X$T=X$P.normal.elements;X$T[0]=X$F+X$d,X$T[1]=X$B+X$R,X$T[2]=X$a+X$n,X$P.distance=X$E+X$Z,X$P.normalize();var X$j=X$L.normal.elements;X$j[0]=X$F-X$d,X$j[1]=X$B-X$R,X$j[2]=X$a-X$n,X$L.distance=X$E-X$Z,X$L.normalize();var X$x=X$q.normal.elements;X$x[0]=X$F-X$K,X$x[1]=X$B-X$$,X$x[2]=X$a-X$c,X$q.distance=X$E-X$H,X$q.normalize();var X$Q=X$k.normal.elements;X$Q[0]=X$F+X$K,X$Q[1]=X$B+X$$,X$Q[2]=X$a+X$c,X$k.distance=X$E+X$H,X$k.normalize()},X$K._get3PlaneInterPoint=function(X$m,X$p,X$h){var X$P=X$m.normal,X$L=X$p.normal,X$q=X$h.normal;X$kp.cross(X$L,X$q,X$K._tempV30),X$kp.cross(X$q,X$P,X$K._tempV31),X$kp.cross(X$P,X$L,X$K._tempV32);var X$k=X$kp.dot(X$P,X$K._tempV30),X$Y=X$kp.dot(X$L,X$K._tempV31),X$d=X$kp.dot(X$q,X$K._tempV32);return X$kp.scale(X$K._tempV30,-X$m.distance/X$k,X$K._tempV33),X$kp.scale(X$K._tempV31,-X$p.distance/X$Y,X$K._tempV34),X$kp.scale(X$K._tempV32,-X$h.distance/X$d,X$K._tempV35),X$kp.add(X$K._tempV33,X$K._tempV34,X$K._tempV36),X$kp.add(X$K._tempV35,X$K._tempV36,X$K._tempV37),X$K._tempV37},X$F(X$K,["_tempV30",function(){return this._tempV30=new X$kp},"_tempV31",function(){return this._tempV31=new X$kp},"_tempV32",function(){return this._tempV32=new X$kp},"_tempV33",function(){return this._tempV33=new X$kp},"_tempV34",function(){return this._tempV34=new X$kp},"_tempV35",function(){return this._tempV35=new X$kp},"_tempV36",function(){return this._tempV36=new X$kp},"_tempV37",function(){return this._tempV37=new X$kp}]),X$K}(),X$tm=function(){function X$D(X$m,X$p){this.center=null,this.radius=NaN,this.center=X$m,this.radius=X$p}X$$(X$D,"laya.d3.math.BoundSphere");var X$m=X$D.prototype;return X$H.imps(X$m,{"laya.d3.core.IClone":!0}),X$m.toDefault=function(){this.center.toDefault(),this.radius=0},X$m.intersectsRayDistance=function(X$m){return Collision.intersectsRayAndSphereRD(X$m,this)},X$m.intersectsRayPoint=function(X$m,X$p){return Collision.intersectsRayAndSphereRP(X$m,this,X$p)},X$m.cloneTo=function(X$m){var X$p=X$m;this.center.cloneTo(X$p.center),X$p.radius=this.radius},X$m.clone=function(){var X$m=new this.constructor(new X$kp,new X$kp);return this.cloneTo(X$m),X$m},X$D.createFromSubPoints=function(X$m,X$p,X$h,X$P){if(null==X$m)throw new Error("points");if(X$p<0||X$p>=X$m.length)throw new Error("start"+X$p+"Must be in the range [0, "+(X$m.length-1)+"]");if(X$h<0||X$p+X$h>X$m.length)throw new Error("count"+X$h+"Must be in the range <= "+X$m.length+"}");var X$L=X$p+X$h,X$q=X$D._tempVector3;X$q.elements[0]=0,X$q.elements[1]=0,X$q.elements[2]=0;for(var X$k=X$p;X$k<X$L;++X$k)X$kp.add(X$m[X$k],X$q,X$q);var X$Y=X$P.center;X$kp.scale(X$q,1/X$h,X$Y);var X$d=0;for(X$k=X$p;X$k<X$L;++X$k){var X$K=X$kp.distanceSquared(X$Y,X$m[X$k]);X$d<X$K&&(X$d=X$K)}X$P.radius=Math.sqrt(X$d)},X$D.createfromPoints=function(X$m,X$p){if(null==X$m)throw new Error("points");X$D.createFromSubPoints(X$m,0,X$m.length,X$p)},X$F(X$D,["_tempVector3",function(){return this._tempVector3=new X$kp}]),X$D}(),X$Om=(function(){function X$m(){}X$$(X$m,"laya.d3.math.ContainmentType"),X$m.Disjoint=0,X$m.Contains=1,X$m.Intersects=2}(),function(){function X$h(){}return X$$(X$h,"laya.d3.math.MathUtils3D"),X$h.isZero=function(X$m){return Math.abs(X$m)<X$h.zeroTolerance},X$h.nearEqual=function(X$m,X$p){return!!X$h.isZero(X$m-X$p)},X$h.fastInvSqrt=function(X$m){return X$h.isZero(X$m)?X$m:1/Math.sqrt(X$m)},X$F(X$h,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),X$h}()),X$Cm=function(){function X$d(){var X$m=this.elements=new Float32Array(9);X$m[0]=1,X$m[1]=0,X$m[2]=0,X$m[3]=0,X$m[4]=1,X$m[5]=0,X$m[6]=0,X$m[7]=0,X$m[8]=1}X$$(X$d,"laya.d3.math.Matrix3x3");var X$m=X$d.prototype;return X$H.imps(X$m,{"laya.d3.core.IClone":!0}),X$m.determinant=function(){var X$m=this.elements,X$p=X$m[0],X$h=X$m[1],X$P=X$m[2],X$L=X$m[3],X$q=X$m[4],X$k=X$m[5],X$Y=X$m[6],X$d=X$m[7],X$K=X$m[8];return X$p*(X$K*X$q-X$k*X$d)+X$h*(-X$K*X$L+X$k*X$Y)+X$P*(X$d*X$L-X$q*X$Y)},X$m.translate=function(X$m,X$p){var X$h=X$p.elements,X$P=this.elements,X$L=X$m.elements,X$q=X$P[0],X$k=X$P[1],X$Y=X$P[2],X$d=X$P[3],X$K=X$P[4],X$D=X$P[5],X$F=X$P[6],X$R=X$P[7],X$$=X$P[8],X$A=X$L[0],X$B=X$L[1];X$h[0]=X$q,X$h[1]=X$k,X$h[2]=X$Y,X$h[3]=X$d,X$h[4]=X$K,X$h[5]=X$D,X$h[6]=X$A*X$q+X$B*X$d+X$F,X$h[7]=X$A*X$k+X$B*X$K+X$R,X$h[8]=X$A*X$Y+X$B*X$D+X$$},X$m.rotate=function(X$m,X$p){var X$h=X$p.elements,X$P=this.elements,X$L=X$P[0],X$q=X$P[1],X$k=X$P[2],X$Y=X$P[3],X$d=X$P[4],X$K=X$P[5],X$D=X$P[6],X$F=X$P[7],X$R=X$P[8],X$$=Math.sin(X$m),X$A=Math.cos(X$m);X$h[0]=X$A*X$L+X$$*X$Y,X$h[1]=X$A*X$q+X$$*X$d,X$h[2]=X$A*X$k+X$$*X$K,X$h[3]=X$A*X$Y-X$$*X$L,X$h[4]=X$A*X$d-X$$*X$q,X$h[5]=X$A*X$K-X$$*X$k,X$h[6]=X$D,X$h[7]=X$F,X$h[8]=X$R},X$m.scale=function(X$m,X$p){var X$h=X$p.elements,X$P=this.elements,X$L=X$m.elements,X$q=X$L[0],X$k=X$L[1];X$h[0]=X$q*X$P[0],X$h[1]=X$q*X$P[1],X$h[2]=X$q*X$P[2],X$h[3]=X$k*X$P[3],X$h[4]=X$k*X$P[4],X$h[5]=X$k*X$P[5],X$h[6]=X$P[6],X$h[7]=X$P[7],X$h[8]=X$P[8]},X$m.invert=function(X$m){var X$p=X$m.elements,X$h=this.elements,X$P=X$h[0],X$L=X$h[1],X$q=X$h[2],X$k=X$h[3],X$Y=X$h[4],X$d=X$h[5],X$K=X$h[6],X$D=X$h[7],X$F=X$h[8],X$R=X$F*X$Y-X$d*X$D,X$$=-X$F*X$k+X$d*X$K,X$A=X$D*X$k-X$Y*X$K,X$B=X$P*X$R+X$L*X$$+X$q*X$A;X$B||(X$m=null),X$B=1/X$B,X$p[0]=X$R*X$B,X$p[1]=(-X$F*X$L+X$q*X$D)*X$B,X$p[2]=(X$d*X$L-X$q*X$Y)*X$B,X$p[3]=X$$*X$B,X$p[4]=(X$F*X$P-X$q*X$K)*X$B,X$p[5]=(-X$d*X$P+X$q*X$k)*X$B,X$p[6]=X$A*X$B,X$p[7]=(-X$D*X$P+X$L*X$K)*X$B,X$p[8]=(X$Y*X$P-X$L*X$k)*X$B},X$m.transpose=function(X$m){var X$p=X$m.elements,X$h=this.elements;if(X$m===this){var X$P=X$h[1],X$L=X$h[2],X$q=X$h[5];X$p[1]=X$h[3],X$p[2]=X$h[6],X$p[3]=X$P,X$p[5]=X$h[7],X$p[6]=X$L,X$p[7]=X$q}else X$p[0]=X$h[0],X$p[1]=X$h[3],X$p[2]=X$h[6],X$p[3]=X$h[1],X$p[4]=X$h[4],X$p[5]=X$h[7],X$p[6]=X$h[2],X$p[7]=X$h[5],X$p[8]=X$h[8]},X$m.identity=function(){var X$m=this.elements;X$m[0]=1,X$m[1]=0,X$m[2]=0,X$m[3]=0,X$m[4]=1,X$m[5]=0,X$m[6]=0,X$m[7]=0,X$m[8]=1},X$m.cloneTo=function(X$m){var X$p,X$h,X$P;if((X$h=this.elements)!==(X$P=X$m.elements))for(X$p=0;X$p<9;++X$p)X$P[X$p]=X$h[X$p]},X$m.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$d.createFromTranslation=function(X$m,X$p){X$p.elements;var X$h=X$m.elements;X$p[0]=1,X$p[1]=0,X$p[2]=0,X$p[3]=0,X$p[4]=1,X$p[5]=0,X$p[6]=X$h[0],X$p[7]=X$h[1],X$p[8]=1},X$d.createFromRotation=function(X$m,X$p){var X$h=X$p.elements,X$P=Math.sin(X$m),X$L=Math.cos(X$m);X$h[0]=X$L,X$h[1]=X$P,X$h[2]=0,X$h[3]=-X$P,X$h[4]=X$L,X$h[5]=0,X$h[6]=0,X$h[7]=0,X$h[8]=1},X$d.createFromScaling=function(X$m,X$p){var X$h=X$p.elements,X$P=X$m.elements;X$h[0]=X$P[0],X$h[1]=0,X$h[2]=0,X$h[3]=0,X$h[4]=X$P[1],X$h[5]=0,X$h[6]=0,X$h[7]=0,X$h[8]=1},X$d.createFromMatrix4x4=function(X$m,X$p){X$p[0]=X$m[0],X$p[1]=X$m[1],X$p[2]=X$m[2],X$p[3]=X$m[4],X$p[4]=X$m[5],X$p[5]=X$m[6],X$p[6]=X$m[8],X$p[7]=X$m[9],X$p[8]=X$m[10]},X$d.multiply=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p.elements,X$k=X$L[0],X$Y=X$L[1],X$d=X$L[2],X$K=X$L[3],X$D=X$L[4],X$F=X$L[5],X$R=X$L[6],X$$=X$L[7],X$A=X$L[8],X$B=X$q[0],X$n=X$q[1],X$c=X$q[2],X$e=X$q[3],X$a=X$q[4],X$Z=X$q[5],X$H=X$q[6],X$W=X$q[7],X$E=X$q[8];X$P[0]=X$B*X$k+X$n*X$K+X$c*X$R,X$P[1]=X$B*X$Y+X$n*X$D+X$c*X$$,X$P[2]=X$B*X$d+X$n*X$F+X$c*X$A,X$P[3]=X$e*X$k+X$a*X$K+X$Z*X$R,X$P[4]=X$e*X$Y+X$a*X$D+X$Z*X$$,X$P[5]=X$e*X$d+X$a*X$F+X$Z*X$A,X$P[6]=X$H*X$k+X$W*X$K+X$E*X$R,X$P[7]=X$H*X$Y+X$W*X$D+X$E*X$$,X$P[8]=X$H*X$d+X$W*X$F+X$E*X$A},X$d.lookAt=function(X$m,X$p,X$h,X$P){X$kp.subtract(X$m,X$p,X$d._tempV30),X$kp.normalize(X$d._tempV30,X$d._tempV30),X$kp.cross(X$h,X$d._tempV30,X$d._tempV31),X$kp.normalize(X$d._tempV31,X$d._tempV31),X$kp.cross(X$d._tempV30,X$d._tempV31,X$d._tempV32);var X$L=X$d._tempV30.elements,X$q=X$d._tempV31.elements,X$k=X$d._tempV32.elements,X$Y=X$P.elements;X$Y[0]=X$q[0],X$Y[3]=X$q[1],X$Y[6]=X$q[2],X$Y[1]=X$k[0],X$Y[4]=X$k[1],X$Y[7]=X$k[2],X$Y[2]=X$L[0],X$Y[5]=X$L[1],X$Y[8]=X$L[2]},X$d.DEFAULT=new X$d,X$F(X$d,["_tempV30",function(){return this._tempV30=new X$kp},"_tempV31",function(){return this._tempV31=new X$kp},"_tempV32",function(){return this._tempV32=new X$kp}]),X$d}(),X$mp=function(){function X$b(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D,X$F,X$R,X$$,X$A,X$B){void 0===X$m&&(X$m=1),void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=0),void 0===X$L&&(X$L=0),void 0===X$q&&(X$q=1),void 0===X$k&&(X$k=0),void 0===X$Y&&(X$Y=0),void 0===X$d&&(X$d=0),void 0===X$K&&(X$K=0),void 0===X$D&&(X$D=1),void 0===X$F&&(X$F=0),void 0===X$R&&(X$R=0),void 0===X$$&&(X$$=0),void 0===X$A&&(X$A=0),void 0===X$B&&(X$B=1);var X$n=this.elements=new Float32Array(16);X$n[0]=X$m,X$n[1]=X$p,X$n[2]=X$h,X$n[3]=X$P,X$n[4]=X$L,X$n[5]=X$q,X$n[6]=X$k,X$n[7]=X$Y,X$n[8]=X$d,X$n[9]=X$K,X$n[10]=X$D,X$n[11]=X$F,X$n[12]=X$R,X$n[13]=X$$,X$n[14]=X$A,X$n[15]=X$B}X$$(X$b,"laya.d3.math.Matrix4x4");var X$m=X$b.prototype;return X$H.imps(X$m,{"laya.d3.core.IClone":!0}),X$m.getElementByRowColumn=function(X$m,X$p){if(X$m<0||3<X$m)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(X$p<0||3<X$p)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*X$m+X$p]},X$m.setElementByRowColumn=function(X$m,X$p,X$h){if(X$m<0||3<X$m)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(X$p<0||3<X$p)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*X$m+X$p]=X$h},X$m.equalsOtherMatrix=function(X$m){var X$p=this.elements,X$h=X$m.elements;return X$Om.nearEqual(X$p[0],X$h[0])&&X$Om.nearEqual(X$p[1],X$h[1])&&X$Om.nearEqual(X$p[2],X$h[2])&&X$Om.nearEqual(X$p[3],X$h[3])&&X$Om.nearEqual(X$p[4],X$h[4])&&X$Om.nearEqual(X$p[5],X$h[5])&&X$Om.nearEqual(X$p[6],X$h[6])&&X$Om.nearEqual(X$p[7],X$h[7])&&X$Om.nearEqual(X$p[8],X$h[8])&&X$Om.nearEqual(X$p[9],X$h[9])&&X$Om.nearEqual(X$p[10],X$h[10])&&X$Om.nearEqual(X$p[11],X$h[11])&&X$Om.nearEqual(X$p[12],X$h[12])&&X$Om.nearEqual(X$p[13],X$h[13])&&X$Om.nearEqual(X$p[14],X$h[14])&&X$Om.nearEqual(X$p[15],X$h[15])},X$m.decomposeTransRotScale=function(X$m,X$p,X$h){var X$P=X$b._tempMatrix4x4;return this.decomposeTransRotMatScale(X$m,X$P,X$h)?(X$hp.createFromMatrix4x4(X$P,X$p),!0):(X$p.identity(),!1)},X$m.decomposeTransRotMatScale=function(X$m,X$p,X$h){var X$P=this.elements,X$L=X$m.elements,X$q=X$p.elements,X$k=X$h.elements;X$L[0]=X$P[12],X$L[1]=X$P[13],X$L[2]=X$P[14];var X$Y=X$P[0],X$d=X$P[1],X$K=X$P[2],X$D=X$P[4],X$F=X$P[5],X$R=X$P[6],X$$=X$P[8],X$A=X$P[9],X$B=X$P[10],X$n=X$k[0]=Math.sqrt(X$Y*X$Y+X$d*X$d+X$K*X$K),X$c=X$k[1]=Math.sqrt(X$D*X$D+X$F*X$F+X$R*X$R),X$e=X$k[2]=Math.sqrt(X$$*X$$+X$A*X$A+X$B*X$B);if(X$Om.isZero(X$n)||X$Om.isZero(X$c)||X$Om.isZero(X$e))return X$q[1]=X$q[2]=X$q[3]=X$q[4]=X$q[6]=X$q[7]=X$q[8]=X$q[9]=X$q[11]=X$q[12]=X$q[13]=X$q[14]=0,X$q[0]=X$q[5]=X$q[10]=X$q[15]=1,!1;var X$a=X$b._tempVector0,X$Z=X$a.elements;X$Z[0]=X$$/X$e,X$Z[1]=X$A/X$e,X$Z[2]=X$B/X$e;var X$H=X$b._tempVector1,X$W=X$H.elements;X$W[0]=X$Y/X$n,X$W[1]=X$d/X$n,X$W[2]=X$K/X$n;var X$E=X$b._tempVector2;X$kp.cross(X$a,X$H,X$E);var X$I=X$b._tempVector1;return X$kp.cross(X$E,X$a,X$I),X$q[3]=X$q[7]=X$q[11]=X$q[12]=X$q[13]=X$q[14]=0,X$q[15]=1,X$q[0]=X$I.x,X$q[1]=X$I.y,X$q[2]=X$I.z,X$q[4]=X$E.x,X$q[5]=X$E.y,X$q[6]=X$E.z,X$q[8]=X$a.x,X$q[9]=X$a.y,X$q[10]=X$a.z,X$q[0]*X$Y+X$q[1]*X$d+X$q[2]*X$K<0&&(X$k[0]=-X$n),X$q[4]*X$D+X$q[5]*X$F+X$q[6]*X$R<0&&(X$k[1]=-X$c),X$q[8]*X$$+X$q[9]*X$A+X$q[10]*X$B<0&&(X$k[2]=-X$e),!0},X$m.decomposeYawPitchRoll=function(X$m){var X$p=X$m.elements,X$h=Math.asin(-this.elements[9]);X$p[1]=X$h,Math.cos(X$h)>X$Om.zeroTolerance?(X$p[2]=Math.atan2(this.elements[1],this.elements[5]),X$p[0]=Math.atan2(this.elements[8],this.elements[10])):(X$p[2]=Math.atan2(-this.elements[4],this.elements[0]),X$p[0]=0)},X$m.normalize=function(){var X$m=this.elements,X$p=X$m[0],X$h=X$m[1],X$P=X$m[2],X$L=Math.sqrt(X$p*X$p+X$h*X$h+X$P*X$P);if(!X$L)return X$m[0]=0,X$m[1]=0,void(X$m[2]=0);1!=X$L&&(X$L=1/X$L,X$m[0]=X$p*X$L,X$m[1]=X$h*X$L,X$m[2]=X$P*X$L)},X$m.transpose=function(){var X$m,X$p;return X$p=(X$m=this.elements)[1],X$m[1]=X$m[4],X$m[4]=X$p,X$p=X$m[2],X$m[2]=X$m[8],X$m[8]=X$p,X$p=X$m[3],X$m[3]=X$m[12],X$m[12]=X$p,X$p=X$m[6],X$m[6]=X$m[9],X$m[9]=X$p,X$p=X$m[7],X$m[7]=X$m[13],X$m[13]=X$p,X$p=X$m[11],X$m[11]=X$m[14],X$m[14]=X$p,this},X$m.invert=function(X$m){var X$p=this.elements,X$h=X$m.elements,X$P=X$p[0],X$L=X$p[1],X$q=X$p[2],X$k=X$p[3],X$Y=X$p[4],X$d=X$p[5],X$K=X$p[6],X$D=X$p[7],X$F=X$p[8],X$R=X$p[9],X$$=X$p[10],X$A=X$p[11],X$B=X$p[12],X$n=X$p[13],X$c=X$p[14],X$e=X$p[15],X$a=X$P*X$d-X$L*X$Y,X$Z=X$P*X$K-X$q*X$Y,X$H=X$P*X$D-X$k*X$Y,X$W=X$L*X$K-X$q*X$d,X$E=X$L*X$D-X$k*X$d,X$I=X$q*X$D-X$k*X$K,X$b=X$F*X$n-X$R*X$B,X$T=X$F*X$c-X$$*X$B,X$j=X$F*X$e-X$A*X$B,X$x=X$R*X$c-X$$*X$n,X$Q=X$R*X$e-X$A*X$n,X$M=X$$*X$e-X$A*X$c,X$u=X$a*X$M-X$Z*X$Q+X$H*X$x+X$W*X$j-X$E*X$T+X$I*X$b;0!==Math.abs(X$u)&&(X$u=1/X$u,X$h[0]=(X$d*X$M-X$K*X$Q+X$D*X$x)*X$u,X$h[1]=(X$q*X$Q-X$L*X$M-X$k*X$x)*X$u,X$h[2]=(X$n*X$I-X$c*X$E+X$e*X$W)*X$u,X$h[3]=(X$$*X$E-X$R*X$I-X$A*X$W)*X$u,X$h[4]=(X$K*X$j-X$Y*X$M-X$D*X$T)*X$u,X$h[5]=(X$P*X$M-X$q*X$j+X$k*X$T)*X$u,X$h[6]=(X$c*X$H-X$B*X$I-X$e*X$Z)*X$u,X$h[7]=(X$F*X$I-X$$*X$H+X$A*X$Z)*X$u,X$h[8]=(X$Y*X$Q-X$d*X$j+X$D*X$b)*X$u,X$h[9]=(X$L*X$j-X$P*X$Q-X$k*X$b)*X$u,X$h[10]=(X$B*X$E-X$n*X$H+X$e*X$a)*X$u,X$h[11]=(X$R*X$H-X$F*X$E-X$A*X$a)*X$u,X$h[12]=(X$d*X$T-X$Y*X$x-X$K*X$b)*X$u,X$h[13]=(X$P*X$x-X$L*X$T+X$q*X$b)*X$u,X$h[14]=(X$n*X$Z-X$B*X$W-X$c*X$a)*X$u,X$h[15]=(X$F*X$W-X$R*X$Z+X$$*X$a)*X$u)},X$m.identity=function(){var X$m=this.elements;X$m[1]=X$m[2]=X$m[3]=X$m[4]=X$m[6]=X$m[7]=X$m[8]=X$m[9]=X$m[11]=X$m[12]=X$m[13]=X$m[14]=0,X$m[0]=X$m[5]=X$m[10]=X$m[15]=1},X$m.cloneTo=function(X$m){var X$p,X$h,X$P;if((X$h=this.elements)!==(X$P=X$m.elements))for(X$p=0;X$p<16;++X$p)X$P[X$p]=X$h[X$p]},X$m.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$m.getTranslationVector=function(X$m){var X$p=this.elements,X$h=X$m.elements;X$h[0]=X$p[12],X$h[1]=X$p[13],X$h[2]=X$p[14]},X$m.setTranslationVector=function(X$m){var X$p=this.elements,X$h=X$m.elements;X$p[12]=X$h[0],X$p[13]=X$h[1],X$p[14]=X$h[2]},X$m.getForward=function(X$m){var X$p=this.elements,X$h=X$m.elements;X$h[0]=-X$p[8],X$h[1]=-X$p[9],X$h[2]=-X$p[10]},X$m.setForward=function(X$m){var X$p=this.elements,X$h=X$m.elements;X$p[8]=-X$h[0],X$p[9]=-X$h[1],X$p[10]=-X$h[2]},X$b.createRotationX=function(X$m,X$p){var X$h=X$p.elements,X$P=Math.sin(X$m),X$L=Math.cos(X$m);X$h[1]=X$h[2]=X$h[3]=X$h[4]=X$h[7]=X$h[8]=X$h[11]=X$h[12]=X$h[13]=X$h[14]=0,X$h[0]=X$h[15]=1,X$h[5]=X$h[10]=X$L,X$h[6]=X$P,X$h[9]=-X$P},X$b.createRotationY=function(X$m,X$p){var X$h=X$p.elements,X$P=Math.sin(X$m),X$L=Math.cos(X$m);X$h[1]=X$h[3]=X$h[4]=X$h[6]=X$h[7]=X$h[9]=X$h[11]=X$h[12]=X$h[13]=X$h[14]=0,X$h[5]=X$h[15]=1,X$h[0]=X$h[10]=X$L,X$h[2]=-X$P,X$h[8]=X$P},X$b.createRotationZ=function(X$m,X$p){var X$h=X$p.elements,X$P=Math.sin(X$m),X$L=Math.cos(X$m);X$h[2]=X$h[3]=X$h[6]=X$h[7]=X$h[8]=X$h[9]=X$h[11]=X$h[12]=X$h[13]=X$h[14]=0,X$h[10]=X$h[15]=1,X$h[0]=X$h[5]=X$L,X$h[1]=X$P,X$h[4]=-X$P},X$b.createRotationYawPitchRoll=function(X$m,X$p,X$h,X$P){X$hp.createFromYawPitchRoll(X$m,X$p,X$h,X$b._tempQuaternion),X$b.createRotationQuaternion(X$b._tempQuaternion,X$P)},X$b.createRotationAxis=function(X$m,X$p,X$h){var X$P=X$m.elements,X$L=X$P[0],X$q=X$P[1],X$k=X$P[2],X$Y=Math.cos(X$p),X$d=Math.sin(X$p),X$K=X$L*X$L,X$D=X$q*X$q,X$F=X$k*X$k,X$R=X$L*X$q,X$$=X$L*X$k,X$A=X$q*X$k,X$B=X$h.elements;X$B[3]=X$B[7]=X$B[11]=X$B[12]=X$B[13]=X$B[14]=0,X$B[15]=1,X$B[0]=X$K+X$Y*(1-X$K),X$B[1]=X$R-X$Y*X$R+X$d*X$k,X$B[2]=X$$-X$Y*X$$-X$d*X$q,X$B[4]=X$R-X$Y*X$R-X$d*X$k,X$B[5]=X$D+X$Y*(1-X$D),X$B[6]=X$A-X$Y*X$A+X$d*X$L,X$B[8]=X$$-X$Y*X$$+X$d*X$q,X$B[9]=X$A-X$Y*X$A-X$d*X$L,X$B[10]=X$F+X$Y*(1-X$F)},X$b.createRotationQuaternion=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements,X$L=X$h[0],X$q=X$h[1],X$k=X$h[2],X$Y=X$h[3],X$d=X$L*X$L,X$K=X$q*X$q,X$D=X$k*X$k,X$F=X$L*X$q,X$R=X$k*X$Y,X$$=X$k*X$L,X$A=X$q*X$Y,X$B=X$q*X$k,X$n=X$L*X$Y;X$P[3]=X$P[7]=X$P[11]=X$P[12]=X$P[13]=X$P[14]=0,X$P[15]=1,X$P[0]=1-2*(X$K+X$D),X$P[1]=2*(X$F+X$R),X$P[2]=2*(X$$-X$A),X$P[4]=2*(X$F-X$R),X$P[5]=1-2*(X$D+X$d),X$P[6]=2*(X$B+X$n),X$P[8]=2*(X$$+X$A),X$P[9]=2*(X$B-X$n),X$P[10]=1-2*(X$K+X$d)},X$b.createTranslate=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements;X$P[4]=X$P[8]=X$P[1]=X$P[9]=X$P[2]=X$P[6]=X$P[3]=X$P[7]=X$P[11]=0,X$P[0]=X$P[5]=X$P[10]=X$P[15]=1,X$P[12]=X$h[0],X$P[13]=X$h[1],X$P[14]=X$h[2]},X$b.createScaling=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements;X$P[0]=X$h[0],X$P[5]=X$h[1],X$P[10]=X$h[2],X$P[1]=X$P[4]=X$P[8]=X$P[12]=X$P[9]=X$P[13]=X$P[2]=X$P[6]=X$P[14]=X$P[3]=X$P[7]=X$P[11]=0,X$P[15]=1},X$b.multiply=function(X$m,X$p,X$h){var X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D;for(X$L=X$h.elements,X$q=X$m.elements,X$L===(X$k=X$p.elements)&&(X$k=X$k.slice()),X$P=0;X$P<4;X$P++)X$Y=X$q[X$P],X$d=X$q[X$P+4],X$K=X$q[X$P+8],X$D=X$q[X$P+12],X$L[X$P]=X$Y*X$k[0]+X$d*X$k[1]+X$K*X$k[2]+X$D*X$k[3],X$L[X$P+4]=X$Y*X$k[4]+X$d*X$k[5]+X$K*X$k[6]+X$D*X$k[7],X$L[X$P+8]=X$Y*X$k[8]+X$d*X$k[9]+X$K*X$k[10]+X$D*X$k[11],X$L[X$P+12]=X$Y*X$k[12]+X$d*X$k[13]+X$K*X$k[14]+X$D*X$k[15]},X$b.createFromQuaternion=function(X$m,X$p){var X$h=X$p.elements,X$P=X$m.elements,X$L=X$P[0],X$q=X$P[1],X$k=X$P[2],X$Y=X$P[3],X$d=X$L+X$L,X$K=X$q+X$q,X$D=X$k+X$k,X$F=X$L*X$d,X$R=X$q*X$d,X$$=X$q*X$K,X$A=X$k*X$d,X$B=X$k*X$K,X$n=X$k*X$D,X$c=X$Y*X$d,X$e=X$Y*X$K,X$a=X$Y*X$D;X$h[0]=1-X$$-X$n,X$h[1]=X$R+X$a,X$h[2]=X$A-X$e,X$h[3]=0,X$h[4]=X$R-X$a,X$h[5]=1-X$F-X$n,X$h[6]=X$B+X$c,X$h[7]=0,X$h[8]=X$A+X$e,X$h[9]=X$B-X$c,X$h[10]=1-X$F-X$$,X$h[11]=0,X$h[12]=0,X$h[13]=0,X$h[14]=0,X$h[15]=1},X$b.createAffineTransformation=function(X$m,X$p,X$h,X$P){var X$L=X$m.elements,X$q=X$p.elements,X$k=X$h.elements,X$Y=X$P.elements,X$d=X$q[0],X$K=X$q[1],X$D=X$q[2],X$F=X$q[3],X$R=X$d+X$d,X$$=X$K+X$K,X$A=X$D+X$D,X$B=X$d*X$R,X$n=X$d*X$$,X$c=X$d*X$A,X$e=X$K*X$$,X$a=X$K*X$A,X$Z=X$D*X$A,X$H=X$F*X$R,X$W=X$F*X$$,X$E=X$F*X$A,X$I=X$k[0],X$b=X$k[1],X$T=X$k[2];X$Y[0]=(1-(X$e+X$Z))*X$I,X$Y[1]=(X$n+X$E)*X$I,X$Y[2]=(X$c-X$W)*X$I,X$Y[3]=0,X$Y[4]=(X$n-X$E)*X$b,X$Y[5]=(1-(X$B+X$Z))*X$b,X$Y[6]=(X$a+X$H)*X$b,X$Y[7]=0,X$Y[8]=(X$c+X$W)*X$T,X$Y[9]=(X$a-X$H)*X$T,X$Y[10]=(1-(X$B+X$e))*X$T,X$Y[11]=0,X$Y[12]=X$L[0],X$Y[13]=X$L[1],X$Y[14]=X$L[2],X$Y[15]=1},X$b.createLookAt=function(X$m,X$p,X$h,X$P){var X$L=X$P.elements,X$q=X$b._tempVector0,X$k=X$b._tempVector1,X$Y=X$b._tempVector2;X$kp.subtract(X$m,X$p,X$Y),X$kp.normalize(X$Y,X$Y),X$kp.cross(X$h,X$Y,X$q),X$kp.normalize(X$q,X$q),X$kp.cross(X$Y,X$q,X$k),X$P.identity(),X$L[0]=X$q.x,X$L[4]=X$q.y,X$L[8]=X$q.z,X$L[1]=X$k.x,X$L[5]=X$k.y,X$L[9]=X$k.z,X$L[2]=X$Y.x,X$L[6]=X$Y.y,X$L[10]=X$Y.z,X$L[12]=-X$kp.dot(X$q,X$m),X$L[13]=-X$kp.dot(X$k,X$m),X$L[14]=-X$kp.dot(X$Y,X$m)},X$b.createPerspective=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$L.elements,X$k=1/Math.tan(X$m/2),X$Y=1/(X$h-X$P);X$q[0]=X$k/X$p,X$q[5]=X$k,X$q[10]=(X$P+X$h)*X$Y,X$q[11]=-1,X$q[14]=2*X$P*X$h*X$Y,X$q[1]=X$q[2]=X$q[3]=X$q[4]=X$q[6]=X$q[7]=X$q[8]=X$q[9]=X$q[12]=X$q[13]=X$q[15]=0},X$b.createOrthoOffCenterRH=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){var X$Y=X$k.elements,X$d=1/(X$m-X$p),X$K=1/(X$h-X$P),X$D=1/(X$L-X$q);X$Y[1]=X$Y[2]=X$Y[3]=X$Y[4]=X$Y[6]=X$Y[7]=X$Y[8]=X$Y[9]=X$Y[11]=0,X$Y[15]=1,X$Y[0]=-2*X$d,X$Y[5]=-2*X$K,X$Y[10]=2*X$D,X$Y[12]=(X$m+X$p)*X$d,X$Y[13]=(X$P+X$h)*X$K,X$Y[14]=(X$q+X$L)*X$D},X$b.translation=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements;X$P[0]=X$P[5]=X$P[10]=X$P[15]=1,X$P[12]=X$h[0],X$P[13]=X$h[1],X$P[14]=X$h[2]},X$F(X$b,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new X$b},"_tempVector0",function(){return this._tempVector0=new X$kp},"_tempVector1",function(){return this._tempVector1=new X$kp},"_tempVector2",function(){return this._tempVector2=new X$kp},"_tempQuaternion",function(){return this._tempQuaternion=new X$hp},"DEFAULT",function(){return this.DEFAULT=new X$b},"ZERO",function(){return this.ZERO=new X$b(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),X$b}(),X$pp=(function(){function X$a(X$m,X$p){this.extents=null,this.transformation=null,this.extents=X$m,this.transformation=X$p}X$$(X$a,"laya.d3.math.OrientedBoundBox");var X$m=X$a.prototype;X$m.getCorners=function(X$m){var X$p=X$a._tempV30.elements,X$h=X$a._tempV31.elements,X$P=X$a._tempV32.elements,X$L=this.extents.elements;X$p[0]=X$L[0],X$p[1]=X$p[2]=0,X$h[1]=X$L[1],X$h[0]=X$h[2]=0,X$P[2]=X$L[2],X$P[0]=X$P[1]=0,X$kp.TransformNormal(X$a._tempV30,this.transformation,X$a._tempV30),X$kp.TransformNormal(X$a._tempV31,this.transformation,X$a._tempV31),X$kp.TransformNormal(X$a._tempV32,this.transformation,X$a._tempV32);var X$q=X$a._tempV33;this.transformation.getTranslationVector(X$q),X$m.length=8,X$kp.add(X$q,X$a._tempV30,X$a._tempV34),X$kp.add(X$a._tempV34,X$a._tempV31,X$a._tempV34),X$kp.add(X$a._tempV34,X$a._tempV32,X$m[0]),X$kp.add(X$q,X$a._tempV30,X$a._tempV34),X$kp.add(X$a._tempV34,X$a._tempV31,X$a._tempV34),X$kp.subtract(X$a._tempV34,X$a._tempV32,X$m[1]),X$kp.subtract(X$q,X$a._tempV30,X$a._tempV34),X$kp.add(X$a._tempV34,X$a._tempV31,X$a._tempV34),X$kp.subtract(X$a._tempV34,X$a._tempV32,X$m[2]),X$kp.subtract(X$q,X$a._tempV30,X$a._tempV34),X$kp.add(X$a._tempV34,X$a._tempV31,X$a._tempV34),X$kp.add(X$a._tempV34,X$a._tempV32,X$m[3]),X$kp.add(X$q,X$a._tempV30,X$a._tempV34),X$kp.subtract(X$a._tempV34,X$a._tempV31,X$a._tempV34),X$kp.add(X$a._tempV34,X$a._tempV32,X$m[4]),X$kp.add(X$q,X$a._tempV30,X$a._tempV34),X$kp.subtract(X$a._tempV34,X$a._tempV31,X$a._tempV34),X$kp.subtract(X$a._tempV34,X$a._tempV32,X$m[5]),X$kp.subtract(X$q,X$a._tempV30,X$a._tempV34),X$kp.subtract(X$a._tempV34,X$a._tempV31,X$a._tempV34),X$kp.subtract(X$a._tempV34,X$a._tempV32,X$m[6]),X$kp.subtract(X$q,X$a._tempV30,X$a._tempV34),X$kp.subtract(X$a._tempV34,X$a._tempV31,X$a._tempV34),X$kp.add(X$a._tempV34,X$a._tempV32,X$m[7])},X$m.transform=function(X$m){X$mp.multiply(this.transformation,X$m,this.transformation)},X$m.scale=function(X$m){X$kp.multiply(this.extents,X$m,this.extents)},X$m.translate=function(X$m){this.transformation.getTranslationVector(X$a._tempV30),X$kp.add(X$a._tempV30,X$m,X$a._tempV31),this.transformation.setTranslationVector(X$a._tempV31)},X$m.Size=function(X$m){X$kp.scale(this.extents,2,X$m)},X$m.getSize=function(X$m){var X$p=this.extents.elements;X$a._tempV30.x=X$p[0],X$a._tempV31.y=X$p[1],X$a._tempV32.z=X$p[2],X$kp.TransformNormal(X$a._tempV30,this.transformation,X$a._tempV30),X$kp.TransformNormal(X$a._tempV31,this.transformation,X$a._tempV31),X$kp.TransformNormal(X$a._tempV31,this.transformation,X$a._tempV32);var X$h=X$m.elements;X$h[0]=X$kp.scalarLength(X$a._tempV30),X$h[1]=X$kp.scalarLength(X$a._tempV31),X$h[2]=X$kp.scalarLength(X$a._tempV32)},X$m.getSizeSquared=function(X$m){var X$p=this.extents.elements;X$a._tempV30.x=X$p[0],X$a._tempV31.y=X$p[1],X$a._tempV32.z=X$p[2],X$kp.TransformNormal(X$a._tempV30,this.transformation,X$a._tempV30),X$kp.TransformNormal(X$a._tempV31,this.transformation,X$a._tempV31),X$kp.TransformNormal(X$a._tempV31,this.transformation,X$a._tempV32);var X$h=X$m.elements;X$h[0]=X$kp.scalarLengthSquared(X$a._tempV30),X$h[1]=X$kp.scalarLengthSquared(X$a._tempV31),X$h[2]=X$kp.scalarLengthSquared(X$a._tempV32)},X$m.getCenter=function(X$m){this.transformation.getTranslationVector(X$m)},X$m.containsPoint=function(X$m){var X$p=this.extents.elements,X$h=X$p[0],X$P=X$p[1],X$L=X$p[2];this.transformation.invert(X$a._tempM0),X$kp.transformCoordinate(X$m,X$a._tempM0,X$a._tempV30);var X$q=X$a._tempV30.elements,X$k=Math.abs(X$q[0]),X$Y=Math.abs(X$q[1]),X$d=Math.abs(X$q[2]);return X$Om.nearEqual(X$k,X$h)&&X$Om.nearEqual(X$Y,X$P)&&X$Om.nearEqual(X$d,X$L)?2:X$k<X$h&&X$Y<X$P&&X$d<X$L?1:0},X$m.containsPoints=function(X$m){var X$p=this.extents.elements,X$h=X$p[0],X$P=X$p[1],X$L=X$p[2];this.transformation.invert(X$a._tempM0);for(var X$q=!0,X$k=!1,X$Y=0;X$Y<X$m.length;X$Y++){X$kp.transformCoordinate(X$m[X$Y],X$a._tempM0,X$a._tempV30);var X$d=X$a._tempV30.elements,X$K=Math.abs(X$d[0]),X$D=Math.abs(X$d[1]),X$F=Math.abs(X$d[2]);X$Om.nearEqual(X$K,X$h)&&X$Om.nearEqual(X$D,X$P)&&X$Om.nearEqual(X$F,X$L)&&(X$k=!0),X$K<X$h&&X$D<X$P&&X$F<X$L?X$k=!0:X$q=!1}return X$q?1:X$k?2:0},X$m.containsSphere=function(X$m,X$p){void 0===X$p&&(X$p=!1);var X$h=this.extents.elements,X$P=X$h[0],X$L=X$h[1],X$q=X$h[2],X$k=X$m.radius;this.transformation.invert(X$a._tempM0),X$kp.transformCoordinate(X$m.center,X$a._tempM0,X$a._tempV30);var X$Y=NaN;if(X$Y=X$p?X$k:(X$kp.scale(X$kp.UnitX,X$k,X$a._tempV31),X$kp.TransformNormal(X$a._tempV31,X$a._tempM0,X$a._tempV31),X$kp.scalarLength(X$a._tempV31)),X$kp.scale(this.extents,-1,X$a._tempV32),X$kp.Clamp(X$a._tempV30,X$a._tempV32,this.extents,X$a._tempV33),X$Y*X$Y<X$kp.distanceSquared(X$a._tempV30,X$a._tempV33))return 0;var X$d=X$a._tempV30.elements,X$K=X$d[0],X$D=X$d[1],X$F=X$d[2],X$R=X$a._tempV32.elements,X$$=X$R[0],X$A=X$R[1],X$B=X$R[2];return X$$+X$Y<=X$K&&X$K<=X$P-X$Y&&X$Y<X$P-X$$&&X$A+X$Y<=X$D&&X$D<=X$L-X$Y&&X$Y<X$L-X$A&&X$B+X$Y<=X$F&&X$F<=X$q-X$Y&&X$Y<X$q-X$B?1:2},X$m.containsOrientedBoundBox=function(X$m){var X$p=0,X$h=0;X$m.getCorners(X$a._corners);var X$P=this.containsPoints(X$a._corners);if(0!=X$P)return X$P;var X$L=this.extents.elements;X$m.extents.cloneTo(X$a._tempV35);var X$q=X$a._tempV35.elements;X$a._getRows(this.transformation,X$a._rows1),X$a._getRows(X$m.transformation,X$a._rows2);var X$k=NaN;for(X$p=0;X$p<4;X$p++)for(X$h=0;X$h<4;X$h++)3==X$p||3==X$h?(X$a._tempM0.setElementByRowColumn(X$p,X$h,0),X$a._tempM1.setElementByRowColumn(X$p,X$h,0)):(X$k=X$kp.dot(X$a._rows1[X$p],X$a._rows2[X$h]),X$a._tempM0.setElementByRowColumn(X$p,X$h,X$k),X$a._tempM1.setElementByRowColumn(X$p,X$h,Math.abs(X$k)));X$m.getCenter(X$a._tempV34),this.getCenter(X$a._tempV36),X$kp.subtract(X$a._tempV34,X$a._tempV36,X$a._tempV30);var X$Y=X$a._tempV31.elements;X$Y[0]=X$kp.dot(X$a._tempV30,X$a._rows1[0]),X$Y[1]=X$kp.dot(X$a._tempV30,X$a._rows1[1]),X$Y[2]=X$kp.dot(X$a._tempV30,X$a._rows1[2]);var X$d=X$a._tempV32.elements,X$K=X$a._tempV33.elements;for(X$p=0;X$p<3;X$p++)if(X$d[0]=X$a._tempM1.getElementByRowColumn(X$p,0),X$d[1]=X$a._tempM1.getElementByRowColumn(X$p,1),X$d[2]=X$a._tempM1.getElementByRowColumn(X$p,2),X$L[X$p]+X$kp.dot(X$a._tempV35,X$a._tempV32)<Math.abs(X$Y[X$p]))return 0;for(X$h=0;X$h<3;X$h++)if(X$d[0]=X$a._tempM1.getElementByRowColumn(0,X$h),X$d[1]=X$a._tempM1.getElementByRowColumn(1,X$h),X$d[2]=X$a._tempM1.getElementByRowColumn(2,X$h),X$K[0]=X$a._tempM0.getElementByRowColumn(0,X$h),X$K[1]=X$a._tempM0.getElementByRowColumn(1,X$h),X$K[2]=X$a._tempM0.getElementByRowColumn(2,X$h),X$kp.dot(this.extents,X$a._tempV32)+X$q[X$h]<Math.abs(X$kp.dot(X$a._tempV31,X$a._tempV33)))return 0;for(X$p=0;X$p<3;X$p++)for(X$h=0;X$h<3;X$h++){var X$D=(X$p+1)%3,X$F=(X$p+2)%3,X$R=(X$h+1)%3,X$$=(X$h+2)%3;if(X$L[X$D]*X$a._tempM1.getElementByRowColumn(X$F,X$h)+X$L[X$F]*X$a._tempM1.getElementByRowColumn(X$D,X$h)+(X$q[X$R]*X$a._tempM1.getElementByRowColumn(X$p,X$$)+X$q[X$$]*X$a._tempM1.getElementByRowColumn(X$p,X$R))<Math.abs(X$Y[X$F]*X$a._tempM0.getElementByRowColumn(X$D,X$h)-X$Y[X$D]*X$a._tempM0.getElementByRowColumn(X$F,X$h)))return 0}return 2},X$m.containsLine=function(X$m,X$p){X$a._corners[0]=X$m,X$a._corners[1]=X$p;var X$h=this.containsPoints(X$a._corners);if(0!=X$h)return X$h;var X$P=this.extents.elements,X$L=X$P[0],X$q=X$P[1],X$k=X$P[2];this.transformation.invert(X$a._tempM0),X$kp.transformCoordinate(X$m,X$a._tempM0,X$a._tempV30),X$kp.transformCoordinate(X$p,X$a._tempM0,X$a._tempV31),X$kp.add(X$a._tempV30,X$a._tempV31,X$a._tempV32),X$kp.scale(X$a._tempV32,.5,X$a._tempV32),X$kp.subtract(X$a._tempV30,X$a._tempV32,X$a._tempV33);var X$Y=X$a._tempV33.elements,X$d=X$Y[0],X$K=X$Y[1],X$D=X$Y[2],X$F=X$a._tempV34.elements,X$R=X$F[0]=Math.abs(X$Y[0]),X$$=X$F[1]=Math.abs(X$Y[1]),X$A=X$F[2]=Math.abs(X$Y[2]),X$B=X$a._tempV32.elements,X$n=X$B[0],X$c=X$B[1],X$e=X$B[2];return Math.abs(X$n)>X$L+X$R?0:Math.abs(X$c)>X$q+X$$?0:Math.abs(X$e)>X$k+X$A?0:Math.abs(X$c*X$D-X$e*X$K)>X$q*X$A+X$k*X$$?0:Math.abs(X$n*X$D-X$e*X$d)>X$L*X$A+X$k*X$R?0:Math.abs(X$n*X$K-X$c*X$d)>X$L*X$$+X$q*X$R?0:2},X$m.containsBoundBox=function(X$m){var X$p=0,X$h=0,X$P=X$m.min,X$L=X$m.max;X$m.getCorners(X$a._corners);var X$q=this.containsPoints(X$a._corners);if(0!=X$q)return X$q;X$kp.subtract(X$L,X$P,X$a._tempV30),X$kp.scale(X$a._tempV30,.5,X$a._tempV30),X$kp.add(X$P,X$a._tempV30,X$a._tempV30),X$kp.subtract(X$L,X$a._tempV30,X$a._tempV31);var X$k=this.extents.elements,X$Y=X$a._tempV31.elements;X$a._getRows(this.transformation,X$a._rows1),this.transformation.invert(X$a._tempM0);for(X$p=0;X$p<3;X$p++)for(X$h=0;X$h<3;X$h++)X$a._tempM1.setElementByRowColumn(X$p,X$h,Math.abs(X$a._tempM0.getElementByRowColumn(X$p,X$h)));this.getCenter(X$a._tempV35),X$kp.subtract(X$a._tempV30,X$a._tempV35,X$a._tempV32);var X$d=X$a._tempV31.elements;X$d[0]=X$kp.dot(X$a._tempV32,X$a._rows1[0]),X$d[1]=X$kp.dot(X$a._tempV32,X$a._rows1[1]),X$d[2]=X$kp.dot(X$a._tempV32,X$a._rows1[2]);var X$K=X$a._tempV33.elements,X$D=X$a._tempV34.elements;for(X$p=0;X$p<3;X$p++)if(X$K[0]=X$a._tempM1.getElementByRowColumn(X$p,0),X$K[1]=X$a._tempM1.getElementByRowColumn(X$p,1),X$K[2]=X$a._tempM1.getElementByRowColumn(X$p,2),X$k[X$p]+X$kp.dot(X$a._tempV31,X$a._tempV33)<Math.abs(X$d[X$p]))return 0;for(X$h=0;X$h<3;X$h++)if(X$K[0]=X$a._tempM1.getElementByRowColumn(0,X$h),X$K[1]=X$a._tempM1.getElementByRowColumn(1,X$h),X$K[2]=X$a._tempM1.getElementByRowColumn(2,X$h),X$D[0]=X$a._tempM0.getElementByRowColumn(0,X$h),X$D[1]=X$a._tempM0.getElementByRowColumn(1,X$h),X$D[2]=X$a._tempM0.getElementByRowColumn(2,X$h),X$kp.dot(this.extents,X$a._tempV33)+X$Y[X$h]<Math.abs(X$kp.dot(X$a._tempV31,X$a._tempV34)))return 0;for(X$p=0;X$p<3;X$p++)for(X$h=0;X$h<3;X$h++){var X$F=(X$p+1)%3,X$R=(X$p+2)%3,X$$=(X$h+1)%3,X$A=(X$h+2)%3;if(X$k[X$F]*X$a._tempM1.getElementByRowColumn(X$R,X$h)+X$k[X$R]*X$a._tempM1.getElementByRowColumn(X$F,X$h)+(X$Y[X$$]*X$a._tempM1.getElementByRowColumn(X$p,X$A)+X$Y[X$A]*X$a._tempM1.getElementByRowColumn(X$p,X$$))<Math.abs(X$d[X$R]*X$a._tempM0.getElementByRowColumn(X$F,X$h)-X$d[X$F]*X$a._tempM0.getElementByRowColumn(X$R,X$h)))return 0}return 2},X$m.intersectsRay=function(X$m,X$p){X$kp.scale(this.extents,-1,X$a._tempV30),this.transformation.invert(X$a._tempM0),X$kp.TransformNormal(X$m.direction,X$a._tempM0,X$a._ray.direction),X$kp.transformCoordinate(X$m.origin,X$a._tempM0,X$a._ray.origin),X$a._boxBound1.min=X$a._tempV30,X$a._boxBound1.max=this.extents;var X$h=Collision.intersectsRayAndBoxRP(X$a._ray,X$a._boxBound1,X$p);return-1!==X$h&&X$kp.transformCoordinate(X$p,this.transformation,X$p),X$h},X$m._getLocalCorners=function(X$m){X$m.length=8;var X$p=this.extents.elements;X$a._tempV30.x=X$p[0],X$a._tempV31.y=X$p[1],X$a._tempV32.z=X$p[2],X$kp.add(X$a._tempV30,X$a._tempV31,X$a._tempV33),X$kp.add(X$a._tempV33,X$a._tempV32,X$m[0]),X$kp.add(X$a._tempV30,X$a._tempV31,X$a._tempV33),X$kp.subtract(X$a._tempV33,X$a._tempV32,X$m[1]),X$kp.subtract(X$a._tempV31,X$a._tempV30,X$a._tempV33),X$kp.subtract(X$a._tempV33,X$a._tempV30,X$m[2]),X$kp.subtract(X$a._tempV31,X$a._tempV30,X$a._tempV33),X$kp.add(X$a._tempV33,X$a._tempV32,X$m[3]),X$kp.subtract(X$a._tempV30,X$a._tempV31,X$a._tempV33),X$kp.add(X$a._tempV33,X$a._tempV32,X$m[4]),X$kp.subtract(X$a._tempV30,X$a._tempV31,X$a._tempV33),X$kp.subtract(X$a._tempV33,X$a._tempV32,X$m[5]),X$kp.scale(X$m[0],-1,X$m[6]),X$kp.subtract(X$a._tempV32,X$a._tempV30,X$a._tempV33),X$kp.subtract(X$a._tempV33,X$a._tempV31,X$m[7])},X$m.equals=function(X$m){return this.extents==X$m.extents&&this.transformation==X$m.transformation},X$m.cloneTo=function(X$m){var X$p=X$m;this.extents.cloneTo(X$p.extents),this.transformation.cloneTo(X$p.transformation)},X$a.createByBoundBox=function(X$m,X$p){var X$h=X$m.min,X$P=X$m.max;X$kp.subtract(X$P,X$h,X$a._tempV30),X$kp.scale(X$a._tempV30,.5,X$a._tempV30),X$kp.add(X$h,X$a._tempV30,X$a._tempV31),X$kp.subtract(X$P,X$a._tempV31,X$a._tempV32),X$mp.translation(X$a._tempV31,X$a._tempM0);var X$L=X$a._tempV32.clone(),X$q=X$a._tempM0.clone();X$p.extents=X$L,X$p.transformation=X$q},X$a.createByMinAndMaxVertex=function(X$m,X$p){return X$kp.subtract(X$p,X$m,X$a._tempV30),X$kp.scale(X$a._tempV30,.5,X$a._tempV30),X$kp.add(X$m,X$a._tempV30,X$a._tempV31),X$kp.subtract(X$p,X$a._tempV31,X$a._tempV32),X$mp.translation(X$a._tempV31,X$a._tempM0),new X$a(X$a._tempV32,X$a._tempM0)},X$a._getRows=function(X$m,X$p){X$p.length=3;var X$h=X$m.elements,X$P=X$p[0].elements;X$P[0]=X$h[0],X$P[1]=X$h[1],X$P[2]=X$h[2];var X$L=X$p[1].elements;X$L[0]=X$h[4],X$L[1]=X$h[5],X$L[2]=X$h[6];var X$q=X$p[2].elements;X$q[0]=X$h[8],X$q[1]=X$h[9],X$q[2]=X$h[10]},X$a.getObbtoObbMatrix4x4=function(X$m,X$p,X$h,X$P){var X$L=X$m.transformation,X$q=X$p.transformation;if(X$h){X$a._getRows(X$L,X$a._rows1),X$a._getRows(X$q,X$a._rows2);for(var X$k=0;X$k<3;X$k++)for(var X$Y=0;X$Y<3;X$Y++)X$P.setElementByRowColumn(X$k,X$Y,X$kp.dot(X$a._rows2[X$k],X$a._rows1[X$Y]));X$p.getCenter(X$a._tempV30),X$m.getCenter(X$a._tempV31),X$kp.subtract(X$a._tempV30,X$a._tempV31,X$a._tempV32);var X$d=X$P.elements;X$d[12]=X$kp.dot(X$a._tempV32,X$a._rows1[0]),X$d[13]=X$kp.dot(X$a._tempV32,X$a._rows1[1]),X$d[14]=X$kp.dot(X$a._tempV32,X$a._rows1[2]),X$d[15]=1}else X$L.invert(X$a._tempM0),X$mp.multiply(X$q,X$a._tempM0,X$P)},X$a.merge=function(X$m,X$p,X$h){var X$P=X$m.extents,X$L=X$m.transformation;X$a.getObbtoObbMatrix4x4(X$m,X$p,X$h,X$a._tempM0),X$p._getLocalCorners(X$a._corners),X$kp.transformCoordinate(X$a._corners[0],X$a._tempM0,X$a._corners[0]),X$kp.transformCoordinate(X$a._corners[1],X$a._tempM0,X$a._corners[1]),X$kp.transformCoordinate(X$a._corners[2],X$a._tempM0,X$a._corners[2]),X$kp.transformCoordinate(X$a._corners[3],X$a._tempM0,X$a._corners[3]),X$kp.transformCoordinate(X$a._corners[4],X$a._tempM0,X$a._corners[4]),X$kp.transformCoordinate(X$a._corners[5],X$a._tempM0,X$a._corners[5]),X$kp.transformCoordinate(X$a._corners[6],X$a._tempM0,X$a._corners[6]),X$kp.transformCoordinate(X$a._corners[7],X$a._tempM0,X$a._corners[7]),X$kp.scale(X$P,-1,X$a._boxBound1.min),X$P.cloneTo(X$a._boxBound1.max),X$vm.createfromPoints(X$a._corners,X$a._boxBound2),X$vm.merge(X$a._boxBound2,X$a._boxBound1,X$a._boxBound3);var X$q=X$a._boxBound3.min,X$k=X$a._boxBound3.max;X$kp.subtract(X$k,X$q,X$a._tempV30),X$kp.scale(X$a._tempV30,.5,X$a._tempV30),X$kp.add(X$q,X$a._tempV30,X$a._tempV32),X$kp.subtract(X$k,X$a._tempV32,X$P),X$kp.transformCoordinate(X$a._tempV32,X$L,X$a._tempV33)},X$F(X$a,["_tempV30",function(){return this._tempV30=new X$kp},"_tempV31",function(){return this._tempV31=new X$kp},"_tempV32",function(){return this._tempV32=new X$kp},"_tempV33",function(){return this._tempV33=new X$kp},"_tempV34",function(){return this._tempV34=new X$kp},"_tempV35",function(){return this._tempV35=new X$kp},"_tempV36",function(){return this._tempV36=new X$kp},"_tempM0",function(){return this._tempM0=new X$mp},"_tempM1",function(){return this._tempM1=new X$mp},"_corners",function(){return this._corners=[new X$kp,new X$kp,new X$kp,new X$kp,new X$kp,new X$kp,new X$kp,new X$kp]},"_rows1",function(){return this._rows1=[new X$kp,new X$kp,new X$kp]},"_rows2",function(){return this._rows2=[new X$kp,new X$kp,new X$kp]},"_ray",function(){return this._ray=new X$Lp(new X$kp,new X$kp)},"_boxBound1",function(){return this._boxBound1=new X$vm(new X$kp,new X$kp)},"_boxBound2",function(){return this._boxBound2=new X$vm(new X$kp,new X$kp)},"_boxBound3",function(){return this._boxBound3=new X$vm(new X$kp,new X$kp)}])}(),function(){function X$H(X$m,X$p){this.normal=null,this.distance=NaN,void 0===X$p&&(X$p=0),this.normal=X$m,this.distance=X$p}return X$$(X$H,"laya.d3.math.Plane"),X$H.prototype.normalize=function(){var X$m=this.normal.elements,X$p=X$m[0],X$h=X$m[1],X$P=X$m[2],X$L=1/Math.sqrt(X$p*X$p+X$h*X$h+X$P*X$P);X$m[0]=X$p*X$L,X$m[1]=X$h*X$L,X$m[2]=X$P*X$L,this.distance*=X$L},X$H.createPlaneBy3P=function(X$m,X$p,X$h){var X$P=X$m.elements,X$L=X$p.elements,X$q=X$h.elements,X$k=X$L[0]-X$P[0],X$Y=X$L[1]-X$P[1],X$d=X$L[2]-X$P[2],X$K=X$q[0]-X$P[0],X$D=X$q[1]-X$P[1],X$F=X$q[2]-X$P[2],X$R=X$Y*X$F-X$d*X$D,X$$=X$d*X$K-X$k*X$F,X$A=X$k*X$D-X$Y*X$K,X$B=1/Math.sqrt(X$R*X$R+X$$*X$$+X$A*X$A),X$n=X$R*X$B,X$c=X$$*X$B,X$e=X$A*X$B,X$a=X$H._TEMPVec3.elements;X$a[0]=X$n,X$a[1]=X$c,X$a[2]=X$e;var X$Z=-(X$n*X$P[0]+X$c*X$P[1]+X$e*X$P[2]);return new X$H(X$H._TEMPVec3,X$Z)},X$H.PlaneIntersectionType_Back=0,X$H.PlaneIntersectionType_Front=1,X$H.PlaneIntersectionType_Intersecting=2,X$F(X$H,["_TEMPVec3",function(){return this._TEMPVec3=new X$kp}]),X$H}()),X$hp=function(){function X$L(X$m,X$p,X$h,X$P){this.elements=new Float32Array(4),void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=1),this.elements[0]=X$m,this.elements[1]=X$p,this.elements[2]=X$h,this.elements[3]=X$P}X$$(X$L,"laya.d3.math.Quaternion");var X$m=X$L.prototype;return X$H.imps(X$m,{"laya.d3.core.IClone":!0}),X$m.scaling=function(X$m,X$p){var X$h=X$p.elements,X$P=this.elements;X$h[0]=X$P[0]*X$m,X$h[1]=X$P[1]*X$m,X$h[2]=X$P[2]*X$m,X$h[3]=X$P[3]*X$m},X$m.normalize=function(X$m){var X$p=X$m.elements,X$h=this.elements,X$P=X$h[0],X$L=X$h[1],X$q=X$h[2],X$k=X$h[3],X$Y=X$P*X$P+X$L*X$L+X$q*X$q+X$k*X$k;0<X$Y&&(X$Y=1/Math.sqrt(X$Y),X$p[0]=X$P*X$Y,X$p[1]=X$L*X$Y,X$p[2]=X$q*X$Y,X$p[3]=X$k*X$Y)},X$m.length=function(){var X$m=this.elements,X$p=X$m[0],X$h=X$m[1],X$P=X$m[2],X$L=X$m[3];return Math.sqrt(X$p*X$p+X$h*X$h+X$P*X$P+X$L*X$L)},X$m.rotateX=function(X$m,X$p){var X$h=X$p.elements,X$P=this.elements;X$m*=.5;var X$L=X$P[0],X$q=X$P[1],X$k=X$P[2],X$Y=X$P[3],X$d=Math.sin(X$m),X$K=Math.cos(X$m);X$h[0]=X$L*X$K+X$Y*X$d,X$h[1]=X$q*X$K+X$k*X$d,X$h[2]=X$k*X$K-X$q*X$d,X$h[3]=X$Y*X$K-X$L*X$d},X$m.rotateY=function(X$m,X$p){var X$h=X$p.elements,X$P=this.elements;X$m*=.5;var X$L=X$P[0],X$q=X$P[1],X$k=X$P[2],X$Y=X$P[3],X$d=Math.sin(X$m),X$K=Math.cos(X$m);X$h[0]=X$L*X$K-X$k*X$d,X$h[1]=X$q*X$K+X$Y*X$d,X$h[2]=X$k*X$K+X$L*X$d,X$h[3]=X$Y*X$K-X$q*X$d},X$m.rotateZ=function(X$m,X$p){var X$h=X$p.elements,X$P=this.elements;X$m*=.5;var X$L=X$P[0],X$q=X$P[1],X$k=X$P[2],X$Y=X$P[3],X$d=Math.sin(X$m),X$K=Math.cos(X$m);X$h[0]=X$L*X$K+X$q*X$d,X$h[1]=X$q*X$K-X$L*X$d,X$h[2]=X$k*X$K+X$Y*X$d,X$h[3]=X$Y*X$K-X$k*X$d},X$m.getYawPitchRoll=function(X$m){X$kp.transformQuat(X$kp.ForwardRH,this,X$L.TEMPVector31),X$kp.transformQuat(X$kp.Up,this,X$L.TEMPVector32);var X$p=X$L.TEMPVector32.elements;X$L.angleTo(X$kp.ZERO,X$L.TEMPVector31,X$L.TEMPVector33);var X$h=X$L.TEMPVector33.elements;X$h[0]==Math.PI/2?(X$h[1]=X$L.arcTanAngle(X$p[2],X$p[0]),X$h[2]=0):X$h[0]==-Math.PI/2?(X$h[1]=X$L.arcTanAngle(-X$p[2],-X$p[0]),X$h[2]=0):(X$mp.createRotationY(-X$h[1],X$L.TEMPMatrix0),X$mp.createRotationX(-X$h[0],X$L.TEMPMatrix1),X$kp.transformCoordinate(X$L.TEMPVector32,X$L.TEMPMatrix0,X$L.TEMPVector32),X$kp.transformCoordinate(X$L.TEMPVector32,X$L.TEMPMatrix1,X$L.TEMPVector32),X$h[2]=X$L.arcTanAngle(X$p[1],-X$p[0])),X$h[1]<=-Math.PI&&(X$h[1]=Math.PI),X$h[2]<=-Math.PI&&(X$h[2]=Math.PI),X$h[1]>=Math.PI&&X$h[2]>=Math.PI&&(X$h[1]=0,X$h[2]=0,X$h[0]=Math.PI-X$h[0]);var X$P=X$m.elements;X$P[0]=X$h[1],X$P[1]=X$h[0],X$P[2]=X$h[2]},X$m.invert=function(X$m){var X$p=X$m.elements,X$h=this.elements,X$P=X$h[0],X$L=X$h[1],X$q=X$h[2],X$k=X$h[3],X$Y=X$P*X$P+X$L*X$L+X$q*X$q+X$k*X$k,X$d=X$Y?1/X$Y:0;X$p[0]=-X$P*X$d,X$p[1]=-X$L*X$d,X$p[2]=-X$q*X$d,X$p[3]=X$k*X$d},X$m.identity=function(){var X$m=this.elements;X$m[0]=0,X$m[1]=0,X$m[2]=0,X$m[3]=1},X$m.fromArray=function(X$m,X$p){void 0===X$p&&(X$p=0),this.elements[0]=X$m[X$p+0],this.elements[1]=X$m[X$p+1],this.elements[2]=X$m[X$p+2],this.elements[3]=X$m[X$p+3]},X$m.cloneTo=function(X$m){var X$p,X$h,X$P;if((X$h=this.elements)!==(X$P=X$m.elements))for(X$p=0;X$p<4;++X$p)X$P[X$p]=X$h[X$p]},X$m.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$m.equals=function(X$m){var X$p=this.elements,X$h=X$m.elements;return X$Om.nearEqual(X$p[0],X$h[0])&&X$Om.nearEqual(X$p[1],X$h[1])&&X$Om.nearEqual(X$p[2],X$h[2])&&X$Om.nearEqual(X$p[3],X$h[3])},X$m.lengthSquared=function(){var X$m=this.elements[0],X$p=this.elements[1],X$h=this.elements[2],X$P=this.elements[3];return X$m*X$m+X$p*X$p+X$h*X$h+X$P*X$P},X$A(0,X$m,"x",function(){return this.elements[0]}),X$A(0,X$m,"y",function(){return this.elements[1]}),X$A(0,X$m,"z",function(){return this.elements[2]}),X$A(0,X$m,"w",function(){return this.elements[3]}),X$L.createFromYawPitchRoll=function(X$m,X$p,X$h,X$P){var X$L=.5*X$h,X$q=.5*X$p,X$k=.5*X$m,X$Y=Math.sin(X$L),X$d=Math.cos(X$L),X$K=Math.sin(X$q),X$D=Math.cos(X$q),X$F=Math.sin(X$k),X$R=Math.cos(X$k),X$$=X$P.elements;X$$[0]=X$R*X$K*X$d+X$F*X$D*X$Y,X$$[1]=X$F*X$D*X$d-X$R*X$K*X$Y,X$$[2]=X$R*X$D*X$Y-X$F*X$K*X$d,X$$[3]=X$R*X$D*X$d+X$F*X$K*X$Y},X$L.multiply=function(X$m,X$p,X$h){var X$P=X$m.elements,X$L=X$p.elements,X$q=X$h.elements,X$k=X$P[0],X$Y=X$P[1],X$d=X$P[2],X$K=X$P[3],X$D=X$L[0],X$F=X$L[1],X$R=X$L[2],X$$=X$L[3],X$A=X$Y*X$R-X$d*X$F,X$B=X$d*X$D-X$k*X$R,X$n=X$k*X$F-X$Y*X$D,X$c=X$k*X$D+X$Y*X$F+X$d*X$R;X$q[0]=X$k*X$$+X$D*X$K+X$A,X$q[1]=X$Y*X$$+X$F*X$K+X$B,X$q[2]=X$d*X$$+X$R*X$K+X$n,X$q[3]=X$K*X$$-X$c},X$L.arcTanAngle=function(X$m,X$p){return 0==X$m?1==X$p?Math.PI/2:-Math.PI/2:0<X$m?Math.atan(X$p/X$m):X$m<0?0<X$p?Math.atan(X$p/X$m)+Math.PI:Math.atan(X$p/X$m)-Math.PI:0},X$L.angleTo=function(X$m,X$p,X$h){X$kp.subtract(X$p,X$m,X$L.TEMPVector30),X$kp.normalize(X$L.TEMPVector30,X$L.TEMPVector30),X$h.elements[0]=Math.asin(X$L.TEMPVector30.y),X$h.elements[1]=X$L.arcTanAngle(-X$L.TEMPVector30.z,-X$L.TEMPVector30.x)},X$L.createFromAxisAngle=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements;X$p*=.5;var X$q=Math.sin(X$p);X$P[0]=X$q*X$L[0],X$P[1]=X$q*X$L[1],X$P[2]=X$q*X$L[2],X$P[3]=Math.cos(X$p)},X$L.createFromMatrix3x3=function(X$m,X$p){var X$h,X$P=X$p.elements,X$L=X$m.elements,X$q=X$L[0]+X$L[4]+X$L[8];if(0<X$q)X$h=Math.sqrt(X$q+1),X$P[3]=.5*X$h,X$h=.5/X$h,X$P[0]=(X$L[5]-X$L[7])*X$h,X$P[1]=(X$L[6]-X$L[2])*X$h,X$P[2]=(X$L[1]-X$L[3])*X$h;else{var X$k=0;X$L[4]>X$L[0]&&(X$k=1),X$L[8]>X$L[3*X$k+X$k]&&(X$k=2);var X$Y=(X$k+1)%3,X$d=(X$k+2)%3;X$h=Math.sqrt(X$L[3*X$k+X$k]-X$L[3*X$Y+X$Y]-X$L[3*X$d+X$d]+1),X$P[X$k]=.5*X$h,X$h=.5/X$h,X$P[3]=(X$L[3*X$Y+X$d]-X$L[3*X$d+X$Y])*X$h,X$P[X$Y]=(X$L[3*X$Y+X$k]+X$L[3*X$k+X$Y])*X$h,X$P[X$d]=(X$L[3*X$d+X$k]+X$L[3*X$k+X$d])*X$h}},X$L.createFromMatrix4x4=function(X$m,X$p){var X$h,X$P,X$L=X$m.elements,X$q=X$p.elements,X$k=X$L[0]+X$L[5]+X$L[10];0<X$k?(X$h=Math.sqrt(X$k+1),X$q[3]=.5*X$h,X$h=.5/X$h,X$q[0]=(X$L[6]-X$L[9])*X$h,X$q[1]=(X$L[8]-X$L[2])*X$h,X$q[2]=(X$L[1]-X$L[4])*X$h):X$L[0]>=X$L[5]&&X$L[0]>=X$L[10]?(X$P=.5/(X$h=Math.sqrt(1+X$L[0]-X$L[5]-X$L[10])),X$q[0]=.5*X$h,X$q[1]=(X$L[1]+X$L[4])*X$P,X$q[2]=(X$L[2]+X$L[8])*X$P,X$q[3]=(X$L[6]-X$L[9])*X$P):X$L[5]>X$L[10]?(X$P=.5/(X$h=Math.sqrt(1+X$L[5]-X$L[0]-X$L[10])),X$q[0]=(X$L[4]+X$L[1])*X$P,X$q[1]=.5*X$h,X$q[2]=(X$L[9]+X$L[6])*X$P,X$q[3]=(X$L[8]-X$L[2])*X$P):(X$P=.5/(X$h=Math.sqrt(1+X$L[10]-X$L[0]-X$L[5])),X$q[0]=(X$L[8]+X$L[2])*X$P,X$q[1]=(X$L[9]+X$L[6])*X$P,X$q[2]=.5*X$h,X$q[3]=(X$L[1]-X$L[4])*X$P)},X$L.slerp=function(X$m,X$p,X$h,X$P){var X$L,X$q,X$k,X$Y,X$d,X$K=X$m.elements,X$D=X$p.elements,X$F=X$P.elements,X$R=X$K[0],X$$=X$K[1],X$A=X$K[2],X$B=X$K[3],X$n=X$D[0],X$c=X$D[1],X$e=X$D[2],X$a=X$D[3];return(X$q=X$R*X$n+X$$*X$c+X$A*X$e+X$B*X$a)<0&&(X$q=-X$q,X$n=-X$n,X$c=-X$c,X$e=-X$e,X$a=-X$a),X$d=1e-6<1-X$q?(X$L=Math.acos(X$q),X$k=Math.sin(X$L),X$Y=Math.sin((1-X$h)*X$L)/X$k,Math.sin(X$h*X$L)/X$k):(X$Y=1-X$h,X$h),X$F[0]=X$Y*X$R+X$d*X$n,X$F[1]=X$Y*X$$+X$d*X$c,X$F[2]=X$Y*X$A+X$d*X$e,X$F[3]=X$Y*X$B+X$d*X$a,X$F},X$L.lerp=function(X$m,X$p,X$h,X$P){var X$L=X$P.elements,X$q=X$m.elements,X$k=X$p.elements,X$Y=X$q[0],X$d=X$q[1],X$K=X$q[2],X$D=X$q[3];X$L[0]=X$Y+X$h*(X$k[0]-X$Y),X$L[1]=X$d+X$h*(X$k[1]-X$d),X$L[2]=X$K+X$h*(X$k[2]-X$K),X$L[3]=X$D+X$h*(X$k[3]-X$D)},X$L.add=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p.elements;X$P[0]=X$L[0]+X$q[0],X$P[1]=X$L[1]+X$q[1],X$P[2]=X$L[2]+X$q[2],X$P[3]=X$L[3]+X$q[3]},X$L.dot=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements;return X$h[0]*X$P[0]+X$h[1]*X$P[1]+X$h[2]*X$P[2]+X$h[3]*X$P[3]},X$L.rotationLookAt=function(X$m,X$p,X$h){X$L.lookAt(X$kp.ZERO,X$m,X$p,X$h)},X$L.lookAt=function(X$m,X$p,X$h,X$P){X$Cm.lookAt(X$m,X$p,X$h,X$L._tempMatrix3x3),X$L.rotationMatrix(X$L._tempMatrix3x3,X$P)},X$L.invert=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements,X$L=X$m.lengthSquared();X$Om.isZero(X$L)||(X$L=1/X$L,X$P[0]=-X$h[0]*X$L,X$P[1]=-X$h[1]*X$L,X$P[2]=-X$h[2]*X$L,X$P[3]=X$h[3]*X$L)},X$L.rotationMatrix=function(X$m,X$p){var X$h=X$m.elements,X$P=X$h[0],X$L=X$h[1],X$q=X$h[2],X$k=X$h[3],X$Y=X$h[4],X$d=X$h[5],X$K=X$h[6],X$D=X$h[7],X$F=X$h[8],X$R=X$p.elements,X$$=NaN,X$A=NaN,X$B=X$P+X$Y+X$F;0<X$B?(X$$=Math.sqrt(X$B+1),X$R[3]=.5*X$$,X$$=.5/X$$,X$R[0]=(X$d-X$D)*X$$,X$R[1]=(X$K-X$q)*X$$,X$R[2]=(X$L-X$k)*X$$):X$Y<=X$P&&X$F<=X$P?(X$A=.5/(X$$=Math.sqrt(1+X$P-X$Y-X$F)),X$R[0]=.5*X$$,X$R[1]=(X$L+X$k)*X$A,X$R[2]=(X$q+X$K)*X$A,X$R[3]=(X$d-X$D)*X$A):X$F<X$Y?(X$A=.5/(X$$=Math.sqrt(1+X$Y-X$P-X$F)),X$R[0]=(X$k+X$L)*X$A,X$R[1]=.5*X$$,X$R[2]=(X$D+X$d)*X$A,X$R[3]=(X$K-X$q)*X$A):(X$A=.5/(X$$=Math.sqrt(1+X$F-X$P-X$Y)),X$R[0]=(X$K+X$q)*X$A,X$R[1]=(X$D+X$d)*X$A,X$R[2]=.5*X$$,X$R[3]=(X$L-X$k)*X$A)},X$L.DEFAULT=new X$L,X$F(X$L,["TEMPVector30",function(){return this.TEMPVector30=new X$kp},"TEMPVector31",function(){return this.TEMPVector31=new X$kp},"TEMPVector32",function(){return this.TEMPVector32=new X$kp},"TEMPVector33",function(){return this.TEMPVector33=new X$kp},"TEMPMatrix0",function(){return this.TEMPMatrix0=new X$mp},"TEMPMatrix1",function(){return this.TEMPMatrix1=new X$mp},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new X$Cm},"NAN",function(){return this.NAN=new X$L(NaN,NaN,NaN,NaN)}]),X$L}(),X$Pp=function(){function X$m(X$m){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=X$m,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}X$$(X$m,"laya.d3.math.Rand");var X$p=X$m.prototype;return X$p.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},X$p.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},X$p.getSignedFloat=function(){return 2*this.getFloat()-1},X$A(0,X$p,"seed",function(){return this.seeds[0]},function(X$m){this.seeds[0]=X$m,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),X$m.getFloatFromInt=function(X$m){return 1/8388607*(8388607&X$m)},X$m.getByteFromInt=function(X$m){return(8388607&X$m)>>>15},X$m}(),X$Lp=(function(){function X$L(X$m){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(X$m instanceof Array)||4!==X$m.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|X$m[0],this._state0L=0|X$m[1],this._state1U=0|X$m[2],this._state1L=0|X$m[3]}X$$(X$L,"laya.d3.math.RandX");var X$m=X$L.prototype;X$m.randomint=function(){var X$m=this._state0U,X$p=this._state0L,X$h=this._state1U,X$P=this._state1L,X$L=(X$P>>>0)+(X$p>>>0),X$q=X$h+X$m+(X$L/2>>>31)>>>0,X$k=X$L>>>0,X$Y=0,X$d=0;X$Y=(X$m^=X$Y=X$m<<23|(-512&X$p)>>>9)^(this._state0U=X$h),X$d=(X$p^=X$d=X$p<<23)^(this._state0L=X$P);X$Y^=X$m>>>18,X$d^=X$p>>>18|(262143&X$m)<<14;return X$Y^=X$h>>>5,X$d^=X$P>>>5|(31&X$h)<<27,this._state1U=X$Y,this._state1L=X$d,[X$q,X$k]},X$m.random=function(){var X$m=this.randomint(),X$p=X$m[0],X$h=1023<<20|X$p>>>12,X$P=0|(X$m[1]>>>12|(4095&X$p)<<20);return X$L._CONVERTION_BUFFER.setUint32(0,X$h,!1),X$L._CONVERTION_BUFFER.setUint32(4,X$P,!1),X$Pp._CONVERTION_BUFFER.getFloat64(0,!1)-1},X$F(X$L,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new X$Pp([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function X$m(X$m,X$p){this.origin=null,this.direction=null,this.origin=X$m,this.direction=X$p}return X$$(X$m,"laya.d3.math.Ray"),X$m}()),X$qp=function(){function X$m(X$m,X$p){this.elements=new Float32Array(2),void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0);var X$h=this.elements;X$h[0]=X$m,X$h[1]=X$p}X$$(X$m,"laya.d3.math.Vector2");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p.fromArray=function(X$m,X$p){void 0===X$p&&(X$p=0),this.elements[0]=X$m[X$p+0],this.elements[1]=X$m[X$p+1]},X$p.cloneTo=function(X$m){var X$p=X$m.elements,X$h=this.elements;X$p[0]=X$h[0],X$p[1]=X$h[1]},X$p.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$p,"x",function(){return this.elements[0]},function(X$m){this.elements[0]=X$m}),X$A(0,X$p,"y",function(){return this.elements[1]},function(X$m){this.elements[1]=X$m}),X$m.scale=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements;X$P[0]=X$L[0]*X$p,X$P[1]=X$L[1]*X$p},X$F(X$m,["ZERO",function(){return this.ZERO=new X$m(0,0)},"ONE",function(){return this.ONE=new X$m(1,1)}]),X$m}(),X$kp=function(){function X$D(X$m,X$p,X$h){this.elements=new Float32Array(3),void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0);var X$P=this.elements;X$P[0]=X$m,X$P[1]=X$p,X$P[2]=X$h}X$$(X$D,"laya.d3.math.Vector3");var X$m=X$D.prototype;return X$H.imps(X$m,{"laya.d3.core.IClone":!0}),X$m.fromArray=function(X$m,X$p){void 0===X$p&&(X$p=0),this.elements[0]=X$m[X$p+0],this.elements[1]=X$m[X$p+1],this.elements[2]=X$m[X$p+2]},X$m.cloneTo=function(X$m){var X$p=X$m.elements,X$h=this.elements;X$p[0]=X$h[0],X$p[1]=X$h[1],X$p[2]=X$h[2]},X$m.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$m.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},X$m.reset=function(X$m,X$p,X$h){this.elements[0]=X$m,this.elements[1]=X$p,this.elements[2]=X$h},X$A(0,X$m,"x",function(){return this.elements[0]},function(X$m){this.elements[0]=X$m}),X$A(0,X$m,"y",function(){return this.elements[1]},function(X$m){this.elements[1]=X$m}),X$A(0,X$m,"z",function(){return this.elements[2]},function(X$m){this.elements[2]=X$m}),X$D.distanceSquared=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements,X$L=X$h[0]-X$P[0],X$q=X$h[1]-X$P[1],X$k=X$h[2]-X$P[2];return X$L*X$L+X$q*X$q+X$k*X$k},X$D.distance=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements,X$L=X$h[0]-X$P[0],X$q=X$h[1]-X$P[1],X$k=X$h[2]-X$P[2];return Math.sqrt(X$L*X$L+X$q*X$q+X$k*X$k)},X$D.min=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p.elements;X$P[0]=Math.min(X$L[0],X$q[0]),X$P[1]=Math.min(X$L[1],X$q[1]),X$P[2]=Math.min(X$L[2],X$q[2])},X$D.max=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p.elements;X$P[0]=Math.max(X$L[0],X$q[0]),X$P[1]=Math.max(X$L[1],X$q[1]),X$P[2]=Math.max(X$L[2],X$q[2])},X$D.transformQuat=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p.elements,X$k=X$L[0],X$Y=X$L[1],X$d=X$L[2],X$K=X$q[0],X$D=X$q[1],X$F=X$q[2],X$R=X$q[3],X$$=X$R*X$k+X$D*X$d-X$F*X$Y,X$A=X$R*X$Y+X$F*X$k-X$K*X$d,X$B=X$R*X$d+X$K*X$Y-X$D*X$k,X$n=-X$K*X$k-X$D*X$Y-X$F*X$d;X$P[0]=X$$*X$R+X$n*-X$K+X$A*-X$F-X$B*-X$D,X$P[1]=X$A*X$R+X$n*-X$D+X$B*-X$K-X$$*-X$F,X$P[2]=X$B*X$R+X$n*-X$F+X$$*-X$D-X$A*-X$K},X$D.scalarLength=function(X$m){var X$p=X$m.elements,X$h=X$p[0],X$P=X$p[1],X$L=X$p[2];return Math.sqrt(X$h*X$h+X$P*X$P+X$L*X$L)},X$D.scalarLengthSquared=function(X$m){var X$p=X$m.elements,X$h=X$p[0],X$P=X$p[1],X$L=X$p[2];return X$h*X$h+X$P*X$P+X$L*X$L},X$D.normalize=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements,X$L=X$h[0],X$q=X$h[1],X$k=X$h[2],X$Y=X$L*X$L+X$q*X$q+X$k*X$k;0<X$Y&&(X$Y=1/Math.sqrt(X$Y),X$P[0]=X$h[0]*X$Y,X$P[1]=X$h[1]*X$Y,X$P[2]=X$h[2]*X$Y)},X$D.multiply=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p.elements;X$P[0]=X$L[0]*X$q[0],X$P[1]=X$L[1]*X$q[1],X$P[2]=X$L[2]*X$q[2]},X$D.scale=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements;X$P[0]=X$L[0]*X$p,X$P[1]=X$L[1]*X$p,X$P[2]=X$L[2]*X$p},X$D.lerp=function(X$m,X$p,X$h,X$P){var X$L=X$P.elements,X$q=X$m.elements,X$k=X$p.elements,X$Y=X$q[0],X$d=X$q[1],X$K=X$q[2];X$L[0]=X$Y+X$h*(X$k[0]-X$Y),X$L[1]=X$d+X$h*(X$k[1]-X$d),X$L[2]=X$K+X$h*(X$k[2]-X$K)},X$D.transformV3ToV3=function(X$m,X$p,X$h){var X$P=X$D._tempVector4;X$D.transformV3ToV4(X$m,X$p,X$P);var X$L=X$P.elements,X$q=X$h.elements;X$q[0]=X$L[0],X$q[1]=X$L[1],X$q[2]=X$L[2]},X$D.transformV3ToV4=function(X$m,X$p,X$h){var X$P=X$m.elements,X$L=X$P[0],X$q=X$P[1],X$k=X$P[2],X$Y=X$p.elements,X$d=X$h.elements;X$d[0]=X$L*X$Y[0]+X$q*X$Y[4]+X$k*X$Y[8]+X$Y[12],X$d[1]=X$L*X$Y[1]+X$q*X$Y[5]+X$k*X$Y[9]+X$Y[13],X$d[2]=X$L*X$Y[2]+X$q*X$Y[6]+X$k*X$Y[10]+X$Y[14],X$d[3]=X$L*X$Y[3]+X$q*X$Y[7]+X$k*X$Y[11]+X$Y[15]},X$D.TransformNormal=function(X$m,X$p,X$h){var X$P=X$m.elements,X$L=X$P[0],X$q=X$P[1],X$k=X$P[2],X$Y=X$p.elements,X$d=X$h.elements;X$d[0]=X$L*X$Y[0]+X$q*X$Y[4]+X$k*X$Y[8],X$d[1]=X$L*X$Y[1]+X$q*X$Y[5]+X$k*X$Y[9],X$d[2]=X$L*X$Y[2]+X$q*X$Y[6]+X$k*X$Y[10]},X$D.transformCoordinate=function(X$m,X$p,X$h){var X$P=X$D._tempVector4.elements,X$L=X$m.elements,X$q=X$L[0],X$k=X$L[1],X$Y=X$L[2],X$d=X$p.elements;X$P[0]=X$q*X$d[0]+X$k*X$d[4]+X$Y*X$d[8]+X$d[12],X$P[1]=X$q*X$d[1]+X$k*X$d[5]+X$Y*X$d[9]+X$d[13],X$P[2]=X$q*X$d[2]+X$k*X$d[6]+X$Y*X$d[10]+X$d[14],X$P[3]=1/(X$q*X$d[3]+X$k*X$d[7]+X$Y*X$d[11]+X$d[15]);var X$K=X$h.elements;X$K[0]=X$P[0]*X$P[3],X$K[1]=X$P[1]*X$P[3],X$K[2]=X$P[2]*X$P[3]},X$D.Clamp=function(X$m,X$p,X$h,X$P){var X$L=X$m.elements,X$q=X$L[0],X$k=X$L[1],X$Y=X$L[2],X$d=X$p.elements,X$K=X$d[0],X$D=X$d[1],X$F=X$d[2],X$R=X$h.elements,X$$=X$R[0],X$A=X$R[1],X$B=X$R[2],X$n=X$P.elements;X$q=(X$q=X$$<X$q?X$$:X$q)<X$K?X$K:X$q,X$k=(X$k=X$A<X$k?X$A:X$k)<X$D?X$D:X$k,X$Y=(X$Y=X$B<X$Y?X$B:X$Y)<X$F?X$F:X$Y,X$n[0]=X$q,X$n[1]=X$k,X$n[2]=X$Y},X$D.add=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p.elements;X$P[0]=X$L[0]+X$q[0],X$P[1]=X$L[1]+X$q[1],X$P[2]=X$L[2]+X$q[2]},X$D.subtract=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p.elements;X$P[0]=X$L[0]-X$q[0],X$P[1]=X$L[1]-X$q[1],X$P[2]=X$L[2]-X$q[2]},X$D.cross=function(X$m,X$p,X$h){var X$P=X$m.elements,X$L=X$p.elements,X$q=X$h.elements,X$k=X$P[0],X$Y=X$P[1],X$d=X$P[2],X$K=X$L[0],X$D=X$L[1],X$F=X$L[2];X$q[0]=X$Y*X$F-X$d*X$D,X$q[1]=X$d*X$K-X$k*X$F,X$q[2]=X$k*X$D-X$Y*X$K},X$D.dot=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements;return X$h[0]*X$P[0]+X$h[1]*X$P[1]+X$h[2]*X$P[2]},X$D.equals=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements;return X$Om.nearEqual(Math.abs(X$h[0]),Math.abs(X$P[0]))&&X$Om.nearEqual(Math.abs(X$h[1]),Math.abs(X$P[1]))&&X$Om.nearEqual(Math.abs(X$h[2]),Math.abs(X$P[2]))},X$D.ZERO=new X$D(0,0,0),X$D.ONE=new X$D(1,1,1),X$D.NegativeUnitX=new X$D(-1,0,0),X$D.UnitX=new X$D(1,0,0),X$D.UnitY=new X$D(0,1,0),X$D.UnitZ=new X$D(0,0,1),X$D.ForwardRH=new X$D(0,0,-1),X$D.ForwardLH=new X$D(0,0,1),X$D.Up=new X$D(0,1,0),X$D.NAN=new X$D(NaN,NaN,NaN),X$F(X$D,["_tempVector4",function(){return this._tempVector4=new X$Yp}]),X$D}(),X$Yp=function(){function X$m(X$m,X$p,X$h,X$P){this.elements=new Float32Array(4),void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=0);var X$L=this.elements;X$L[0]=X$m,X$L[1]=X$p,X$L[2]=X$h,X$L[3]=X$P}X$$(X$m,"laya.d3.math.Vector4");var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p.fromArray=function(X$m,X$p){void 0===X$p&&(X$p=0),this.elements[0]=X$m[X$p+0],this.elements[1]=X$m[X$p+1],this.elements[2]=X$m[X$p+2],this.elements[3]=X$m[X$p+3]},X$p.cloneTo=function(X$m){var X$p=X$m.elements,X$h=this.elements;X$p[0]=X$h[0],X$p[1]=X$h[1],X$p[2]=X$h[2],X$p[3]=X$h[3]},X$p.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$p.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},X$p.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},X$A(0,X$p,"x",function(){return this.elements[0]},function(X$m){this.elements[0]=X$m}),X$A(0,X$p,"y",function(){return this.elements[1]},function(X$m){this.elements[1]=X$m}),X$A(0,X$p,"z",function(){return this.elements[2]},function(X$m){this.elements[2]=X$m}),X$A(0,X$p,"w",function(){return this.elements[3]},function(X$m){this.elements[3]=X$m}),X$m.lerp=function(X$m,X$p,X$h,X$P){var X$L=X$P.elements,X$q=X$m.elements,X$k=X$p.elements,X$Y=X$q[0],X$d=X$q[1],X$K=X$q[2],X$D=X$q[3];X$L[0]=X$Y+X$h*(X$k[0]-X$Y),X$L[1]=X$d+X$h*(X$k[1]-X$d),X$L[2]=X$K+X$h*(X$k[2]-X$K),X$L[3]=X$D+X$h*(X$k[3]-X$D)},X$m.transformByM4x4=function(X$m,X$p,X$h){var X$P=X$m.elements,X$L=X$P[0],X$q=X$P[1],X$k=X$P[2],X$Y=X$P[3],X$d=X$p.elements,X$K=X$h.elements;X$K[0]=X$L*X$d[0]+X$q*X$d[4]+X$k*X$d[8]+X$Y*X$d[12],X$K[1]=X$L*X$d[1]+X$q*X$d[5]+X$k*X$d[9]+X$Y*X$d[13],X$K[2]=X$L*X$d[2]+X$q*X$d[6]+X$k*X$d[10]+X$Y*X$d[14],X$K[3]=X$L*X$d[3]+X$q*X$d[7]+X$k*X$d[11]+X$Y*X$d[15]},X$m.equals=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements;return X$Om.nearEqual(Math.abs(X$h[0]),Math.abs(X$P[0]))&&X$Om.nearEqual(Math.abs(X$h[1]),Math.abs(X$P[1]))&&X$Om.nearEqual(Math.abs(X$h[2]),Math.abs(X$P[2]))&&X$Om.nearEqual(Math.abs(X$h[3]),Math.abs(X$P[3]))},X$m.normalize=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements,X$L=X$m.length();0<X$L&&(X$P[0]=X$h[0]*X$L,X$P[1]=X$h[1]*X$L,X$P[2]=X$h[2]*X$L,X$P[3]=X$h[3]*X$L)},X$m.add=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p.elements;X$P[0]=X$L[0]+X$q[0],X$P[1]=X$L[1]+X$q[1],X$P[2]=X$L[2]+X$q[2],X$P[3]=X$L[3]+X$q[3]},X$m.subtract=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p.elements;X$P[0]=X$L[0]-X$q[0],X$P[1]=X$L[1]-X$q[1],X$P[2]=X$L[2]-X$q[2],X$P[3]=X$L[3]-X$q[3]},X$m.multiply=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p.elements;X$P[0]=X$L[0]*X$q[0],X$P[1]=X$L[1]*X$q[1],X$P[2]=X$L[2]*X$q[2],X$P[3]=X$L[3]*X$q[3]},X$m.scale=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements;X$P[0]=X$L[0]*X$p,X$P[1]=X$L[1]*X$p,X$P[2]=X$L[2]*X$p,X$P[3]=X$L[3]*X$p},X$m.Clamp=function(X$m,X$p,X$h,X$P){var X$L=X$m.elements,X$q=X$L[0],X$k=X$L[1],X$Y=X$L[2],X$d=X$L[3],X$K=X$p.elements,X$D=X$K[0],X$F=X$K[1],X$R=X$K[2],X$$=X$K[3],X$A=X$h.elements,X$B=X$A[0],X$n=X$A[1],X$c=X$A[2],X$e=X$A[3],X$a=X$P.elements;X$q=(X$q=X$B<X$q?X$B:X$q)<X$D?X$D:X$q,X$k=(X$k=X$n<X$k?X$n:X$k)<X$F?X$F:X$k,X$Y=(X$Y=X$c<X$Y?X$c:X$Y)<X$R?X$R:X$Y,X$d=(X$d=X$e<X$d?X$e:X$d)<X$$?X$$:X$d,X$a[0]=X$q,X$a[1]=X$k,X$a[2]=X$Y,X$a[3]=X$d},X$m.distanceSquared=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements,X$L=X$h[0]-X$P[0],X$q=X$h[1]-X$P[1],X$k=X$h[2]-X$P[2],X$Y=X$h[3]-X$P[3];return X$L*X$L+X$q*X$q+X$k*X$k+X$Y*X$Y},X$m.distance=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements,X$L=X$h[0]-X$P[0],X$q=X$h[1]-X$P[1],X$k=X$h[2]-X$P[2],X$Y=X$h[3]-X$P[3];return Math.sqrt(X$L*X$L+X$q*X$q+X$k*X$k+X$Y*X$Y)},X$m.dot=function(X$m,X$p){var X$h=X$m.elements,X$P=X$p.elements;return X$h[0]*X$P[0]+X$h[1]*X$P[1]+X$h[2]*X$P[2]+X$h[3]*X$P[3]},X$m.min=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p.elements;X$P[0]=Math.min(X$L[0],X$q[0]),X$P[1]=Math.min(X$L[1],X$q[1]),X$P[2]=Math.min(X$L[2],X$q[2]),X$P[3]=Math.min(X$L[3],X$q[3])},X$m.max=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p.elements;X$P[0]=Math.max(X$L[0],X$q[0]),X$P[1]=Math.max(X$L[1],X$q[1]),X$P[2]=Math.max(X$L[2],X$q[2]),X$P[3]=Math.max(X$L[3],X$q[3])},X$F(X$m,["ZERO",function(){return this.ZERO=new X$m},"ONE",function(){return this.ONE=new X$m(1,1,1,1)},"UnitX",function(){return this.UnitX=new X$m(1,0,0,0)},"UnitY",function(){return this.UnitY=new X$m(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new X$m(0,0,1,0)},"UnitW",function(){return this.UnitW=new X$m(0,0,0,1)}]),X$m}(),X$dp=function(){function X$q(X$m,X$p,X$h,X$P){this.minDepth=0,this.maxDepth=1,this.x=X$m,this.y=X$p,this.width=X$h,this.height=X$P}X$$(X$q,"laya.d3.math.Viewport");var X$m=X$q.prototype;return X$m.project=function(X$m,X$p,X$h){X$kp.transformV3ToV3(X$m,X$p,X$h);var X$P=X$m.elements,X$L=X$p.elements,X$q=X$h.elements,X$k=X$P[0]*X$L[3]+X$P[1]*X$L[7]+X$P[2]*X$L[11]+X$L[15];1!==X$k&&(X$q[0]=X$q[0]/X$k,X$q[1]=X$q[1]/X$k,X$q[2]=X$q[2]/X$k),X$q[0]=.5*(X$q[0]+1)*this.width+this.x,X$q[1]=.5*(1-X$q[1])*this.height+this.y,X$q[2]=X$q[2]*(this.maxDepth-this.minDepth)+this.minDepth},X$m.unprojectFromMat=function(X$m,X$p,X$h){var X$P=X$m.elements,X$L=X$p.elements,X$q=X$h.elements;X$q[0]=(X$P[0]-this.x)/this.width*2-1,X$q[1]=-((X$P[1]-this.y)/this.height*2-1);var X$k=(this.maxDepth-this.minDepth)/2;X$q[2]=(X$P[2]-this.minDepth-X$k)/X$k;var X$Y=X$q[0]*X$L[3]+X$q[1]*X$L[7]+X$q[2]*X$L[11]+X$L[15];X$kp.transformV3ToV3(X$h,X$p,X$h),1!==X$Y&&(X$q[0]=X$q[0]/X$Y,X$q[1]=X$q[1]/X$Y,X$q[2]=X$q[2]/X$Y)},X$m.unprojectFromWVP=function(X$m,X$p,X$h,X$P,X$L){X$mp.multiply(X$p,X$h,X$q._tempMatrix4x4),X$P&&X$mp.multiply(X$q._tempMatrix4x4,X$P,X$q._tempMatrix4x4),X$q._tempMatrix4x4.invert(X$q._tempMatrix4x4),this.unprojectFromMat(X$m,X$q._tempMatrix4x4,X$L)},X$F(X$q,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new X$mp}]),X$q}(),X$Kp=function(){function X$x(X$m){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=X$m,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}X$$(X$x,"laya.d3.resource.models.SubMesh");var X$m=X$x.prototype;return X$H.imps(X$m,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),X$m._getVertexBuffer=function(X$m){return void 0===X$m&&(X$m=0),0===X$m?this._vertexBuffer:null},X$m._getIndexBuffer=function(){return this._indexBuffer},X$m._getStaticBatchBakedVertexs=function(X$m,X$p){var X$h,X$P,X$L=this._vertexBuffer,X$q=X$L.vertexDeclaration,X$k=X$q.getVertexElementByUsage(0).offset/4,X$Y=X$q.getVertexElementByUsage(3).offset/4,X$d=X$p.meshRender.lightmapScaleOffset,X$K=0,X$D=0,X$F=0,X$R=0,X$$=0,X$A=0;if(X$d)if(X$P=X$q.getVertexElementByUsage(15))X$F=X$q.vertexStride/4,X$h=0<this._vertexCount?X$L.getData().slice(this._vertexStart*X$F,(this._vertexStart+this._vertexCount)*X$F):X$L.getData().slice(),X$R=X$P.offset/4;else{X$F=(X$A=X$q.vertexStride/4)+2,X$h=this._vertexCount?new Float32Array(this._vertexCount*(X$L.vertexDeclaration.vertexStride/4+2)):new Float32Array(X$L.vertexCount*(X$L.vertexDeclaration.vertexStride/4+2)),X$R=(X$$=X$q.getVertexElementByUsage(2).offset/4)+2;var X$B=X$L.getData();for(X$K=0,X$D=X$B.length/X$A;X$K<X$D;X$K++){var X$n=0;X$n=0<this._vertexCount?(this._vertexStart+X$K)*X$A:X$K*X$A;var X$c=X$K*X$F,X$e=0;for(X$e=0;X$e<X$R;X$e++)X$h[X$c+X$e]=X$B[X$n+X$e];for(X$e=X$R;X$e<X$A;X$e++)X$h[X$c+X$e+2]=X$B[X$n+X$e]}}else X$F=X$q.vertexStride/4,X$h=this._vertexCount?X$L.getData().slice(this._vertexStart*X$F,(this._vertexStart+this._vertexCount)*X$F):X$L.getData().slice();if(X$m){var X$a=X$m.worldMatrix,X$Z=X$x._tempMatrix4x40;X$a.invert(X$Z);var X$H=X$x._tempMatrix4x41,X$W=X$p.transform.worldMatrix;X$mp.multiply(X$Z,X$W,X$H)}else X$H=X$p.transform.worldMatrix;var X$E=X$x._tempQuaternion0;for(X$H.decomposeTransRotScale(X$x._tempVector30,X$E,X$x._tempVector31),X$K=0,X$D=X$h.length/X$F;X$K<X$D;X$K++){var X$I=X$K*X$F+X$k,X$b=X$K*X$F+X$Y;if(X$np.transformVector3ArrayToVector3ArrayCoordinate(X$h,X$I,X$H,X$h,X$I),X$np.transformVector3ArrayByQuat(X$h,X$b,X$E,X$h,X$b),X$d){var X$T=X$K*X$F+X$R;if(X$P)X$np.transformLightingMapTexcoordByUV1Array(X$h,X$T,X$d,X$h,X$T);else{var X$j=X$K*X$A+X$$;X$np.transformLightingMapTexcoordByUV0Array(X$B,X$j,X$d,X$h,X$T)}}}return X$h},X$m._getVertexBuffers=function(){return null},X$m._beforeRender=function(X$m){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},X$m._render=function(X$m){var X$p,X$h=0,X$P=X$m.renderElement;if(1<this._indexCount){var X$L=this._boneIndicesList.length;if(1<X$L){for(var X$q=0;X$q<X$L;X$q++)(X$p=X$P._skinAnimationDatas||this._skinAnimationDatas)&&(X$P._shaderValue.setValue(0,X$p[X$q]),X$m._shader.uploadRenderElementUniforms(X$P._shaderValue.data)),X$Q.mainContext.drawElements(4,this._subIndexBufferCount[X$q],5123,2*this._subIndexBufferStart[X$q]);X$I.drawCall+=X$L}else(X$p=X$P._skinAnimationDatas||this._skinAnimationDatas)&&(X$P._shaderValue.setValue(0,X$p[0]),X$m._shader.uploadRenderElementUniforms(X$P._shaderValue.data)),X$Q.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),X$I.drawCall++;X$h=this._indexCount}else X$h=this._indexBuffer.indexCount,(X$p=X$P._skinAnimationDatas||this._skinAnimationDatas)&&(X$P._shaderValue.setValue(0,X$p[0]),X$m._shader.uploadRenderElementUniforms(X$P._shaderValue.data)),X$Q.mainContext.drawElements(4,X$h,5123,0),X$I.drawCall++;X$I.trianglesFaces+=X$h/3},X$m.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},X$m.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},X$A(0,X$m,"_vertexBufferCount",function(){return 1}),X$A(0,X$m,"triangleCount",function(){return this._indexBuffer.indexCount/3}),X$F(X$x,["_tempVector30",function(){return this._tempVector30=new X$kp},"_tempVector31",function(){return this._tempVector31=new X$kp},"_tempQuaternion0",function(){return this._tempQuaternion0=new X$hp},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new X$mp},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new X$mp}]),X$x}(),X$Dp=function(){function X$m(X$m){this.defineCounter=0,this.defines=null,X$m?(this.defineCounter=X$m.defineCounter,this.defines=X$m.defines.slice()):(this.defineCounter=0,this.defines=[])}return X$$(X$m,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),X$m.prototype.registerDefine=function(X$m){var X$p=Math.pow(2,this.defineCounter++);return this.defines[X$p]=X$m,X$p},X$m}(),X$Fp=function(){function X$m(){}return X$$(X$m,"laya.d3.shader.ShaderInit3D"),X$m.__init__=function(){var X$m,X$p;X$Ip._globalRegDefine("HIGHPRECISION",X$Ip.SHADERDEFINE_HIGHPRECISION),X$Ip._globalRegDefine("FOG",X$Ip.SHADERDEFINE_FOG),X$Ip._globalRegDefine("DIRECTIONLIGHT",X$Ip.SHADERDEFINE_DIRECTIONLIGHT),X$Ip._globalRegDefine("POINTLIGHT",X$Ip.SHADERDEFINE_POINTLIGHT),X$Ip._globalRegDefine("SPOTLIGHT",X$Ip.SHADERDEFINE_SPOTLIGHT),X$Ip._globalRegDefine("UV",X$Ip.SHADERDEFINE_UV0),X$Ip._globalRegDefine("COLOR",X$Ip.SHADERDEFINE_COLOR),X$Ip._globalRegDefine("UV1",X$Ip.SHADERDEFINE_UV1),X$Ip._globalRegDefine("CASTSHADOW",X$$p.SHADERDEFINE_CAST_SHADOW),X$Ip._globalRegDefine("SHADOWMAP_PSSM1",X$$p.SHADERDEFINE_SHADOW_PSSM1),X$Ip._globalRegDefine("SHADOWMAP_PSSM2",X$$p.SHADERDEFINE_SHADOW_PSSM2),X$Ip._globalRegDefine("SHADOWMAP_PSSM3",X$$p.SHADERDEFINE_SHADOW_PSSM3),X$Ip._globalRegDefine("SHADOWMAP_PCF_NO",X$$p.SHADERDEFINE_SHADOW_PCF_NO),X$Ip._globalRegDefine("SHADOWMAP_PCF1",X$$p.SHADERDEFINE_SHADOW_PCF1),X$Ip._globalRegDefine("SHADOWMAP_PCF2",X$$p.SHADERDEFINE_SHADOW_PCF2),X$Ip._globalRegDefine("SHADOWMAP_PCF3",X$$p.SHADERDEFINE_SHADOW_PCF3),X$Ip._globalRegDefine("DEPTHFOG",X$Ip.SAHDERDEFINE_DEPTHFOG),X$lp.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),X$lp.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),X$m={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},X$p={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var X$h=X$lp.nameKey.add("SIMPLE");shaderCompile=X$Ip.add(X$h,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',X$m,X$p),X$Jp.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),X$Jp.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),X$Jp.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),X$Jp.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),X$Jp.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),X$Jp.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),X$Jp.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),X$Jp.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),X$Jp.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},X$m}(),X$Rp=function(){function X$m(){this._data=null,this._data=[]}X$$(X$m,"laya.d3.shader.ValusArray");var X$p=X$m.prototype;return X$p.setValue=function(X$m,X$p){this._data[X$m]=X$p},X$A(0,X$p,"data",function(){return this._data}),X$m}(),X$$p=function(){function X$m(){}return X$m.SHADERDEFINE_RECEIVE_SHADOW=1,X$m.SHADERDEFINE_CAST_SHADOW=512,X$m.SHADERDEFINE_SHADOW_PSSM1=1024,X$m.SHADERDEFINE_SHADOW_PSSM2=2048,X$m.SHADERDEFINE_SHADOW_PSSM3=4096,X$m.SHADERDEFINE_SHADOW_PCF_NO=8192,X$m.SHADERDEFINE_SHADOW_PCF1=16384,X$m.SHADERDEFINE_SHADOW_PCF2=32768,X$m.SHADERDEFINE_SHADOW_PCF3=65536,X$m.MAX_PSSM_COUNT=3,X$m}(),X$Ap=function(){function X$f(){}return X$$(X$f,"laya.d3.utils.Picker"),X$f.calculateCursorRay=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=X$m.elements[0],X$Y=X$m.elements[1],X$d=X$f._tempVector30,X$K=X$d.elements;X$K[0]=X$k,X$K[1]=X$Y,X$K[2]=X$p.minDepth;var X$D=X$f._tempVector31,X$F=X$D.elements;X$F[0]=X$k,X$F[1]=X$Y,X$F[2]=X$p.maxDepth;var X$R=X$q.origin,X$$=X$f._tempVector32;X$p.unprojectFromWVP(X$d,X$h,X$P,X$L,X$R),X$p.unprojectFromWVP(X$D,X$h,X$P,X$L,X$$);var X$A=X$q.direction.elements;X$A[0]=X$$.x-X$R.x,X$A[1]=X$$.y-X$R.y,X$A[2]=X$$.z-X$R.z,X$kp.normalize(X$q.direction,X$q.direction)},X$f.rayIntersectsPositionsAndIndices=function(X$m,X$p,X$h,X$P,X$L){for(var X$q=X$h.vertexStride/4,X$k=X$h.getVertexElementByUsage(0).offset/4,X$Y=Number.MAX_VALUE,X$d=-1,X$K=-1,X$D=-1,X$F=0;X$F<X$P.length;X$F+=3){var X$R=X$f._tempVector35,X$$=X$R.elements,X$A=X$P[X$F]*X$q,X$B=X$A+X$k;X$$[0]=X$p[X$B],X$$[1]=X$p[1+X$B],X$$[2]=X$p[2+X$B];var X$n=X$f._tempVector36,X$c=X$n.elements,X$e=X$P[X$F+1]*X$q,X$a=X$e+X$k;X$c[0]=X$p[X$a],X$c[1]=X$p[1+X$a],X$c[2]=X$p[2+X$a];var X$Z=X$f._tempVector37,X$H=X$Z.elements,X$W=X$P[X$F+2]*X$q,X$E=X$W+X$k;X$H[0]=X$p[X$E],X$H[1]=X$p[1+X$E],X$H[2]=X$p[2+X$E];var X$I=laya.d3.utils.Picker.rayIntersectsTriangle(X$m,X$R,X$n,X$Z);!isNaN(X$I)&&X$I<X$Y&&(X$Y=X$I,X$d=X$A,X$K=X$e,X$D=X$W)}if(X$Y===Number.MAX_VALUE)return X$L.position.toDefault(),X$L.distance=Number.MAX_VALUE,X$L.trianglePositions[0].toDefault(),X$L.trianglePositions[1].toDefault(),X$L.trianglePositions[2].toDefault(),X$L.triangleNormals[0].toDefault(),X$L.triangleNormals[1].toDefault(),X$L.triangleNormals[2].toDefault(),!1;X$L.distance=X$Y,X$kp.scale(X$m.direction,X$Y,X$L.position),X$kp.add(X$m.origin,X$L.position,X$L.position);var X$b=X$L.trianglePositions,X$T=X$b[0],X$j=X$b[1],X$x=X$b[2],X$Q=X$T.elements,X$M=X$j.elements,X$u=X$x.elements,X$N=X$d+X$k;X$Q[0]=X$p[X$N],X$Q[1]=X$p[X$N+1],X$Q[2]=X$p[X$N+2];var X$S=X$K+X$k;X$M[0]=X$p[X$S],X$M[1]=X$p[X$S+1],X$M[2]=X$p[X$S+2];var X$_=X$D+X$k;X$u[0]=X$p[X$_],X$u[1]=X$p[X$_+1],X$u[2]=X$p[X$_+2];var X$l=X$h.getVertexElementByUsage(3);if(X$l){var X$J=X$l.offset/4,X$z=X$L.triangleNormals,X$w=X$z[0],X$X=X$z[1],X$s=X$z[2],X$G=X$w.elements,X$U=X$X.elements,X$r=X$s.elements,X$y=X$d+X$J;X$G[0]=X$p[X$y],X$G[1]=X$p[X$y+1],X$G[2]=X$p[X$y+2];var X$V=X$K+X$J;X$U[0]=X$p[X$V],X$U[1]=X$p[X$V+1],X$U[2]=X$p[X$V+2];var X$o=X$D+X$J;X$r[0]=X$p[X$o],X$r[1]=X$p[X$o+1],X$r[2]=X$p[X$o+2]}return!0},X$f.rayIntersectsTriangle=function(X$m,X$p,X$h,X$P){var X$L=X$f._tempVector30,X$q=X$f._tempVector31;X$kp.subtract(X$h,X$p,X$L),X$kp.subtract(X$P,X$p,X$q);var X$k,X$Y=X$f._tempVector32;if(X$kp.cross(X$m.direction,X$q,X$Y),(X$k=X$kp.dot(X$L,X$Y))>-Number.MIN_VALUE&&X$k<Number.MIN_VALUE)return Number.NaN;var X$d,X$K=1/X$k,X$D=X$f._tempVector33;if(X$kp.subtract(X$m.origin,X$p,X$D),X$d=X$kp.dot(X$D,X$Y),(X$d*=X$K)<0||1<X$d)return Number.NaN;var X$F,X$R,X$$=X$f._tempVector34;return X$kp.cross(X$D,X$L,X$$),X$F=X$kp.dot(X$m.direction,X$$),(X$F*=X$K)<0||1<X$d+X$F?Number.NaN:(X$R=X$kp.dot(X$q,X$$),(X$R*=X$K)<0?Number.NaN:X$R)},X$F(X$f,["_tempVector30",function(){return this._tempVector30=new X$kp},"_tempVector31",function(){return this._tempVector31=new X$kp},"_tempVector32",function(){return this._tempVector32=new X$kp},"_tempVector33",function(){return this._tempVector33=new X$kp},"_tempVector34",function(){return this._tempVector34=new X$kp},"_tempVector35",function(){return this._tempVector35=new X$kp},"_tempVector36",function(){return this._tempVector36=new X$kp},"_tempVector37",function(){return this._tempVector37=new X$kp}]),X$f}(),X$Bp=(function(){function X$m(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new X$kp,new X$kp,new X$kp],this.trianglePositions.length=3,this.triangleNormals=[new X$kp,new X$kp,new X$kp],this.triangleNormals.length=3,this.position=new X$kp}X$$(X$m,"laya.d3.utils.RaycastHit"),X$m.prototype.cloneTo=function(X$m){X$m.distance=this.distance,this.trianglePositions[0].cloneTo(X$m.trianglePositions[0]),this.trianglePositions[1].cloneTo(X$m.trianglePositions[1]),this.trianglePositions[2].cloneTo(X$m.trianglePositions[2]),this.triangleNormals[0].cloneTo(X$m.triangleNormals[0]),this.triangleNormals[1].cloneTo(X$m.triangleNormals[1]),this.triangleNormals[2].cloneTo(X$m.triangleNormals[2]),this.position.cloneTo(X$m.position),X$m.sprite3D=this.sprite3D}}(),function(){function X$m(X$m,X$p){this._width=0,this._height=0,this._width=X$m,this._height=X$p}X$$(X$m,"laya.d3.utils.Size");var X$p=X$m.prototype;return X$A(0,X$p,"width",function(){return-1===this._width?X$i.clientWidth:this._width}),X$A(0,X$p,"height",function(){return-1===this._height?X$i.clientHeight:this._height}),X$A(1,X$m,"fullScreen",function(){return new X$m(-1,-1)}),X$m}()),X$np=function(){function X$N(){}return X$$(X$N,"laya.d3.utils.Utils3D"),X$N._rotationTransformScaleSkinAnimation=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D,X$F){var X$R,X$$,X$A,X$B,X$n,X$c=X$N._tempArray16_0,X$e=X$N._tempArray16_1,X$a=X$N._tempArray16_2,X$Z=X$P+X$P,X$H=X$L+X$L,X$W=X$q+X$q,X$E=X$P*X$Z,X$I=X$L*X$Z,X$b=X$L*X$H,X$T=X$q*X$Z,X$j=X$q*X$H,X$x=X$q*X$W,X$Q=X$k*X$Z,X$M=X$k*X$H,X$u=X$k*X$W;for(X$c[15]=1,X$c[0]=1-X$b-X$x,X$c[1]=X$I+X$u,X$c[2]=X$T-X$M,X$c[4]=X$I-X$u,X$c[5]=1-X$E-X$x,X$c[6]=X$j+X$Q,X$c[8]=X$T+X$M,X$c[9]=X$j-X$Q,X$c[10]=1-X$E-X$b,X$e[15]=1,X$e[0]=X$Y,X$e[5]=X$d,X$e[10]=X$K,X$R=0;X$R<4;X$R++)X$$=X$c[X$R],X$A=X$c[X$R+4],X$B=X$c[X$R+8],X$n=X$c[X$R+12],X$a[X$R]=X$$,X$a[X$R+4]=X$A,X$a[X$R+8]=X$B,X$a[X$R+12]=X$$*X$m+X$A*X$p+X$B*X$h+X$n;for(X$R=0;X$R<4;X$R++)X$$=X$a[X$R],X$A=X$a[X$R+4],X$B=X$a[X$R+8],X$n=X$a[X$R+12],X$D[X$R+X$F]=X$$*X$e[0]+X$A*X$e[1]+X$B*X$e[2]+X$n*X$e[3],X$D[X$R+X$F+4]=X$$*X$e[4]+X$A*X$e[5]+X$B*X$e[6]+X$n*X$e[7],X$D[X$R+X$F+8]=X$$*X$e[8]+X$A*X$e[9]+X$B*X$e[10]+X$n*X$e[11],X$D[X$R+X$F+12]=X$$*X$e[12]+X$A*X$e[13]+X$B*X$e[14]+X$n*X$e[15]},X$N._createNodeByJson=function(X$m,X$p,X$h,X$P){if(!X$h)switch(X$p.type){case"Sprite3D":X$h=new X$_p;break;case"MeshSprite3D":X$h=new X$fp;break;case"SkinnedMeshSprite3D":X$h=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":X$h=new ShuriKenParticle3D;break;case"TrailSprite3D":X$h=new TrailSprite3D;break;case"Terrain":X$h=new Terrain;break;case"Camera":X$h=new X$op;break;case"DirectionLight":X$h=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var X$L=X$p.props;if(X$L)for(var X$q in X$L)X$h[X$q]=X$L[X$q];var X$k=X$p.customProps;X$k&&(X$h instanceof laya.d3.core.Sprite3D?(X$h._parseBaseCustomProps(X$k),X$h._parseCustomProps(X$m,X$P,X$k,X$p),X$h._parseCustomComponent(X$m,X$P,X$p.components)):X$h._parseCustomProps(X$m,X$P,X$k,X$p));var X$Y=X$p.child;if(X$Y)for(var X$d=0,X$K=X$Y.length;X$d<X$K;X$d++){var X$D=X$N._createNodeByJson(X$m,X$Y[X$d],null,X$P);X$h.addChild(X$D)}return X$h},X$N._computeBoneAndAnimationDatasByBindPoseMatrxix=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k,X$Y,X$d=0,X$K=0,X$D=X$m.length;for(X$k=0;X$k<X$D;X$d+=X$m[X$k].keyframeWidth,X$K+=16,X$k++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(X$p[X$d+0],X$p[X$d+1],X$p[X$d+2],X$p[X$d+3],X$p[X$d+4],X$p[X$d+5],X$p[X$d+6],X$p[X$d+7],X$p[X$d+8],X$p[X$d+9],X$P,X$K),0!=X$k&&(X$Y=16*X$m[X$k].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(X$P,X$Y,X$P,X$K,X$P,X$K));var X$F=X$h.length;for(X$k=0;X$k<X$F;X$k++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(X$P,16*X$q[X$k],X$h[X$k],X$L,16*X$k)},X$N._computeAnimationDatasByArrayAndMatrixFast=function(X$m,X$p,X$h,X$P){for(var X$L=0,X$q=X$m.length;X$L<X$q;X$L++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(X$p,16*X$P[X$L],X$m[X$L],X$h,16*X$L)},X$N._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(X$m,X$p,X$h,X$P,X$L){var X$q,X$k,X$Y=0,X$d=0,X$K=X$m.length;for(X$q=0;X$q<X$K;X$Y+=X$m[X$q].keyframeWidth,X$d+=16,X$q++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(X$p[X$Y+7],X$p[X$Y+8],X$p[X$Y+9],X$p[X$Y+3],X$p[X$Y+4],X$p[X$Y+5],X$p[X$Y+6],X$p[X$Y+0],X$p[X$Y+1],X$p[X$Y+2],X$P,X$d),0!=X$q&&(X$k=16*X$m[X$q].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(X$P,X$k,X$P,X$d,X$P,X$d));var X$D=X$h.length;for(X$q=0;X$q<X$D;X$q++){var X$F=16*X$q;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(X$P,X$F,X$h[X$q],X$L,X$F)}},X$N._computeAnimationDatasByArrayAndMatrixFastOld=function(X$m,X$p,X$h){for(var X$P=X$m.length,X$L=0;X$L<X$P;X$L++){var X$q=16*X$L;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(X$p,X$q,X$m[X$L],X$h,X$q)}},X$N._computeRootAnimationData=function(X$m,X$p,X$h){for(var X$P=0,X$L=0,X$q=0,X$k=X$m.length;X$P<X$k;X$L+=X$m[X$P].keyframeWidth,X$q+=16,X$P++)laya.d3.utils.Utils3D.createAffineTransformationArray(X$p[X$L+0],X$p[X$L+1],X$p[X$L+2],X$p[X$L+3],X$p[X$L+4],X$p[X$L+5],X$p[X$L+6],X$p[X$L+7],X$p[X$L+8],X$p[X$L+9],X$h,X$q)},X$N.transformVector3ArrayByQuat=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$h.elements,X$k=X$m[X$p],X$Y=X$m[X$p+1],X$d=X$m[X$p+2],X$K=X$q[0],X$D=X$q[1],X$F=X$q[2],X$R=X$q[3],X$$=X$R*X$k+X$D*X$d-X$F*X$Y,X$A=X$R*X$Y+X$F*X$k-X$K*X$d,X$B=X$R*X$d+X$K*X$Y-X$D*X$k,X$n=-X$K*X$k-X$D*X$Y-X$F*X$d;X$P[X$L]=X$$*X$R+X$n*-X$K+X$A*-X$F-X$B*-X$D,X$P[X$L+1]=X$A*X$R+X$n*-X$D+X$B*-X$K-X$$*-X$F,X$P[X$L+2]=X$B*X$R+X$n*-X$F+X$$*-X$D-X$A*-X$K},X$N.mulMatrixByArray=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k,X$Y,X$d,X$K,X$D;if(X$L===X$h){for(X$h=X$N._tempArray16_3,X$k=0;X$k<16;++X$k)X$h[X$k]=X$L[X$q+X$k];X$P=0}for(X$k=0;X$k<4;X$k++)X$Y=X$m[X$p+X$k],X$d=X$m[X$p+X$k+4],X$K=X$m[X$p+X$k+8],X$D=X$m[X$p+X$k+12],X$L[X$q+X$k]=X$Y*X$h[X$P+0]+X$d*X$h[X$P+1]+X$K*X$h[X$P+2]+X$D*X$h[X$P+3],X$L[X$q+X$k+4]=X$Y*X$h[X$P+4]+X$d*X$h[X$P+5]+X$K*X$h[X$P+6]+X$D*X$h[X$P+7],X$L[X$q+X$k+8]=X$Y*X$h[X$P+8]+X$d*X$h[X$P+9]+X$K*X$h[X$P+10]+X$D*X$h[X$P+11],X$L[X$q+X$k+12]=X$Y*X$h[X$P+12]+X$d*X$h[X$P+13]+X$K*X$h[X$P+14]+X$D*X$h[X$P+15]},X$N.mulMatrixByArrayFast=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k,X$Y,X$d,X$K,X$D;for(X$k=0;X$k<4;X$k++)X$Y=X$m[X$p+X$k],X$d=X$m[X$p+X$k+4],X$K=X$m[X$p+X$k+8],X$D=X$m[X$p+X$k+12],X$L[X$q+X$k]=X$Y*X$h[X$P+0]+X$d*X$h[X$P+1]+X$K*X$h[X$P+2]+X$D*X$h[X$P+3],X$L[X$q+X$k+4]=X$Y*X$h[X$P+4]+X$d*X$h[X$P+5]+X$K*X$h[X$P+6]+X$D*X$h[X$P+7],X$L[X$q+X$k+8]=X$Y*X$h[X$P+8]+X$d*X$h[X$P+9]+X$K*X$h[X$P+10]+X$D*X$h[X$P+11],X$L[X$q+X$k+12]=X$Y*X$h[X$P+12]+X$d*X$h[X$P+13]+X$K*X$h[X$P+14]+X$D*X$h[X$P+15]},X$N.mulMatrixByArrayAndMatrixFast=function(X$m,X$p,X$h,X$P,X$L){var X$q,X$k,X$Y,X$d,X$K,X$D=X$h.elements,X$F=X$D[0],X$R=X$D[1],X$$=X$D[2],X$A=X$D[3],X$B=X$D[4],X$n=X$D[5],X$c=X$D[6],X$e=X$D[7],X$a=X$D[8],X$Z=X$D[9],X$H=X$D[10],X$W=X$D[11],X$E=X$D[12],X$I=X$D[13],X$b=X$D[14],X$T=X$D[15],X$j=X$p,X$x=X$p+4,X$Q=X$p+8,X$M=X$p+12,X$u=X$L,X$N=X$L+4,X$S=X$L+8,X$_=X$L+12;for(X$q=0;X$q<4;X$q++)X$k=X$m[X$j+X$q],X$Y=X$m[X$x+X$q],X$d=X$m[X$Q+X$q],X$K=X$m[X$M+X$q],X$P[X$u+X$q]=X$k*X$F+X$Y*X$R+X$d*X$$+X$K*X$A,X$P[X$N+X$q]=X$k*X$B+X$Y*X$n+X$d*X$c+X$K*X$e,X$P[X$S+X$q]=X$k*X$a+X$Y*X$Z+X$d*X$H+X$K*X$W,X$P[X$_+X$q]=X$k*X$E+X$Y*X$I+X$d*X$b+X$K*X$T},X$N.createAffineTransformationArray=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D,X$F){var X$R=X$P+X$P,X$$=X$L+X$L,X$A=X$q+X$q,X$B=X$P*X$R,X$n=X$P*X$$,X$c=X$P*X$A,X$e=X$L*X$$,X$a=X$L*X$A,X$Z=X$q*X$A,X$H=X$k*X$R,X$W=X$k*X$$,X$E=X$k*X$A;X$D[X$F+0]=(1-(X$e+X$Z))*X$Y,X$D[X$F+1]=(X$n+X$E)*X$Y,X$D[X$F+2]=(X$c-X$W)*X$Y,X$D[X$F+3]=0,X$D[X$F+4]=(X$n-X$E)*X$d,X$D[X$F+5]=(1-(X$B+X$Z))*X$d,X$D[X$F+6]=(X$a+X$H)*X$d,X$D[X$F+7]=0,X$D[X$F+8]=(X$c+X$W)*X$K,X$D[X$F+9]=(X$a-X$H)*X$K,X$D[X$F+10]=(1-(X$B+X$e))*X$K,X$D[X$F+11]=0,X$D[X$F+12]=X$m,X$D[X$F+13]=X$p,X$D[X$F+14]=X$h,X$D[X$F+15]=1},X$N.transformVector3ArrayToVector3ArrayCoordinate=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$N._tempArray4_0,X$k=X$m[X$p+0],X$Y=X$m[X$p+1],X$d=X$m[X$p+2],X$K=X$h.elements;X$q[0]=X$k*X$K[0]+X$Y*X$K[4]+X$d*X$K[8]+X$K[12],X$q[1]=X$k*X$K[1]+X$Y*X$K[5]+X$d*X$K[9]+X$K[13],X$q[2]=X$k*X$K[2]+X$Y*X$K[6]+X$d*X$K[10]+X$K[14],X$q[3]=1/(X$k*X$K[3]+X$Y*X$K[7]+X$d*X$K[11]+X$K[15]),X$P[X$L+0]=X$q[0]*X$q[3],X$P[X$L+1]=X$q[1]*X$q[3],X$P[X$L+2]=X$q[2]*X$q[3]},X$N.transformLightingMapTexcoordByUV0Array=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$h.elements;X$P[X$L+0]=X$m[X$p+0]*X$q[0]+X$q[2],X$P[X$L+1]=(X$m[X$p+1]-1)*X$q[1]+X$q[3]},X$N.transformLightingMapTexcoordByUV1Array=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$h.elements;X$P[X$L+0]=X$m[X$p+0]*X$q[0]+X$q[2],X$P[X$L+1]=1+X$m[X$p+1]*X$q[1]+X$q[3]},X$N.getURLVerion=function(X$m){var X$p=X$m.indexOf("?");return 0<=X$p?X$m.substr(X$p):null},X$N._quaternionCreateFromYawPitchRollArray=function(X$m,X$p,X$h,X$P){var X$L=.5*X$h,X$q=.5*X$p,X$k=.5*X$m,X$Y=Math.sin(X$L),X$d=Math.cos(X$L),X$K=Math.sin(X$q),X$D=Math.cos(X$q),X$F=Math.sin(X$k),X$R=Math.cos(X$k);X$P[0]=X$R*X$K*X$d+X$F*X$D*X$Y,X$P[1]=X$F*X$D*X$d-X$R*X$K*X$Y,X$P[2]=X$R*X$D*X$Y-X$F*X$K*X$d,X$P[3]=X$R*X$D*X$d+X$F*X$K*X$Y},X$N._createAffineTransformationArray=function(X$m,X$p,X$h,X$P){var X$L=X$p[0],X$q=X$p[1],X$k=X$p[2],X$Y=X$p[3],X$d=X$L+X$L,X$K=X$q+X$q,X$D=X$k+X$k,X$F=X$L*X$d,X$R=X$L*X$K,X$$=X$L*X$D,X$A=X$q*X$K,X$B=X$q*X$D,X$n=X$k*X$D,X$c=X$Y*X$d,X$e=X$Y*X$K,X$a=X$Y*X$D,X$Z=X$h[0],X$H=X$h[1],X$W=X$h[2];X$P[0]=(1-(X$A+X$n))*X$Z,X$P[1]=(X$R+X$a)*X$Z,X$P[2]=(X$$-X$e)*X$Z,X$P[3]=0,X$P[4]=(X$R-X$a)*X$H,X$P[5]=(1-(X$F+X$n))*X$H,X$P[6]=(X$B+X$c)*X$H,X$P[7]=0,X$P[8]=(X$$+X$e)*X$W,X$P[9]=(X$B-X$c)*X$W,X$P[10]=(1-(X$F+X$A))*X$W,X$P[11]=0,X$P[12]=X$m[0],X$P[13]=X$m[1],X$P[14]=X$m[2],X$P[15]=1},X$N._mulMatrixArray=function(X$m,X$p,X$h,X$P){var X$L,X$q,X$k,X$Y,X$d,X$K=X$p.elements,X$D=X$K[0],X$F=X$K[1],X$R=X$K[2],X$$=X$K[3],X$A=X$K[4],X$B=X$K[5],X$n=X$K[6],X$c=X$K[7],X$e=X$K[8],X$a=X$K[9],X$Z=X$K[10],X$H=X$K[11],X$W=X$K[12],X$E=X$K[13],X$I=X$K[14],X$b=X$K[15],X$T=X$P,X$j=X$P+4,X$x=X$P+8,X$Q=X$P+12;for(X$L=0;X$L<4;X$L++)X$q=X$m[X$L],X$k=X$m[X$L+4],X$Y=X$m[X$L+8],X$d=X$m[X$L+12],X$h[X$T+X$L]=X$q*X$D+X$k*X$F+X$Y*X$R+X$d*X$$,X$h[X$j+X$L]=X$q*X$A+X$k*X$B+X$Y*X$n+X$d*X$c,X$h[X$x+X$L]=X$q*X$e+X$k*X$a+X$Y*X$Z+X$d*X$H,X$h[X$Q+X$L]=X$q*X$W+X$k*X$E+X$Y*X$I+X$d*X$b},X$N.getYawPitchRoll=function(X$m,X$p){X$N.transformQuat(X$kp.ForwardRH,X$m,X$hp.TEMPVector31),X$N.transformQuat(X$kp.Up,X$m,X$hp.TEMPVector32);var X$h=X$hp.TEMPVector32.elements;X$N.angleTo(X$kp.ZERO,X$hp.TEMPVector31,X$hp.TEMPVector33);var X$P=X$hp.TEMPVector33.elements;X$P[0]==Math.PI/2?(X$P[1]=X$N.arcTanAngle(X$h[2],X$h[0]),X$P[2]=0):X$P[0]==-Math.PI/2?(X$P[1]=X$N.arcTanAngle(-X$h[2],-X$h[0]),X$P[2]=0):(X$mp.createRotationY(-X$P[1],X$hp.TEMPMatrix0),X$mp.createRotationX(-X$P[0],X$hp.TEMPMatrix1),X$kp.transformCoordinate(X$hp.TEMPVector32,X$hp.TEMPMatrix0,X$hp.TEMPVector32),X$kp.transformCoordinate(X$hp.TEMPVector32,X$hp.TEMPMatrix1,X$hp.TEMPVector32),X$P[2]=X$N.arcTanAngle(X$h[1],-X$h[0])),X$P[1]<=-Math.PI&&(X$P[1]=Math.PI),X$P[2]<=-Math.PI&&(X$P[2]=Math.PI),X$P[1]>=Math.PI&&X$P[2]>=Math.PI&&(X$P[1]=0,X$P[2]=0,X$P[0]=Math.PI-X$P[0]),X$p[0]=X$P[1],X$p[1]=X$P[0],X$p[2]=X$P[2]},X$N.arcTanAngle=function(X$m,X$p){return 0==X$m?1==X$p?Math.PI/2:-Math.PI/2:0<X$m?Math.atan(X$p/X$m):X$m<0?0<X$p?Math.atan(X$p/X$m)+Math.PI:Math.atan(X$p/X$m)-Math.PI:0},X$N.angleTo=function(X$m,X$p,X$h){X$kp.subtract(X$p,X$m,X$hp.TEMPVector30),X$kp.normalize(X$hp.TEMPVector30,X$hp.TEMPVector30),X$h.elements[0]=Math.asin(X$hp.TEMPVector30.y),X$h.elements[1]=X$N.arcTanAngle(-X$hp.TEMPVector30.z,-X$hp.TEMPVector30.x)},X$N.transformQuat=function(X$m,X$p,X$h){var X$P=X$h.elements,X$L=X$m.elements,X$q=X$p,X$k=X$L[0],X$Y=X$L[1],X$d=X$L[2],X$K=X$q[0],X$D=X$q[1],X$F=X$q[2],X$R=X$q[3],X$$=X$R*X$k+X$D*X$d-X$F*X$Y,X$A=X$R*X$Y+X$F*X$k-X$K*X$d,X$B=X$R*X$d+X$K*X$Y-X$D*X$k,X$n=-X$K*X$k-X$D*X$Y-X$F*X$d;X$P[0]=X$$*X$R+X$n*-X$K+X$A*-X$F-X$B*-X$D,X$P[1]=X$A*X$R+X$n*-X$D+X$B*-X$K-X$$*-X$F,X$P[2]=X$B*X$R+X$n*-X$F+X$$*-X$D-X$A*-X$K},X$N.quaterionNormalize=function(X$m,X$p){var X$h=X$m[0],X$P=X$m[1],X$L=X$m[2],X$q=X$m[3],X$k=X$h*X$h+X$P*X$P+X$L*X$L+X$q*X$q;0<X$k&&(X$k=1/Math.sqrt(X$k),X$p[0]=X$h*X$k,X$p[1]=X$P*X$k,X$p[2]=X$L*X$k,X$p[3]=X$q*X$k)},X$N.matrix4x4MultiplyFFF=function(X$m,X$p,X$h){var X$P,X$L,X$q,X$k,X$Y;if(X$h===X$p)for(X$p=new Float32Array(16),X$P=0;X$P<16;++X$P)X$p[X$P]=X$h[X$P];for(X$P=0;X$P<4;X$P++)X$L=X$m[X$P],X$q=X$m[X$P+4],X$k=X$m[X$P+8],X$Y=X$m[X$P+12],X$h[X$P]=X$L*X$p[0]+X$q*X$p[1]+X$k*X$p[2]+X$Y*X$p[3],X$h[X$P+4]=X$L*X$p[4]+X$q*X$p[5]+X$k*X$p[6]+X$Y*X$p[7],X$h[X$P+8]=X$L*X$p[8]+X$q*X$p[9]+X$k*X$p[10]+X$Y*X$p[11],X$h[X$P+12]=X$L*X$p[12]+X$q*X$p[13]+X$k*X$p[14]+X$Y*X$p[15]},X$N.matrix4x4MultiplyMFM=function(X$m,X$p,X$h){X$N.matrix4x4MultiplyFFF(X$m.elements,X$p,X$h.elements)},X$F(X$N,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new X$kp},"_tempVector3_1",function(){return this._tempVector3_1=new X$kp},"_tempVector3_2",function(){return this._tempVector3_2=new X$kp},"_tempVector3_3",function(){return this._tempVector3_3=new X$kp},"_tempVector3_4",function(){return this._tempVector3_4=new X$kp},"_tempVector3_5",function(){return this._tempVector3_5=new X$kp},"_tempVector3_6",function(){return this._tempVector3_6=new X$kp},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),X$N}(),X$cp=function(){function X$M(){}return X$$(X$M,"Laya3D"),X$M._cancelLoadByUrl=function(X$m){X$H.loader.cancelLoadByUrl(X$m),X$M._innerFirstLevelLoaderManager.cancelLoadByUrl(X$m),X$M._innerSecondLevelLoaderManager.cancelLoadByUrl(X$m),X$M._innerThirdLevelLoaderManager.cancelLoadByUrl(X$m),X$M._innerFourthLevelLoaderManager.cancelLoadByUrl(X$m)},X$M._changeWebGLSize=function(X$m,X$p){X$Q.onStageResize(X$m,X$p),X$i.clientWidth=X$m,X$i.clientHeight=X$p},X$M.__init__=function(){var X$m=X$p.createMap;X$m.lh=[X$_p,"SPRITE3DHIERARCHY"],X$m.ls=[X$Sp,"SPRITE3DHIERARCHY"],X$m.lm=[X$Gp,"MESH"],X$m.lmat=[X$Jp,"MATERIAL"],X$m.jpg=[X$rp,"nativeimage"],X$m.jpeg=[X$rp,"nativeimage"],X$m.png=[X$rp,"nativeimage"],X$m.pkm=[X$rp,"arraybuffer"],X$m.raw=[X$Xp,"arraybuffer"],X$m.mipmaps=[X$Xp,"arraybuffer"],X$c.parserMap.SPRITE3DHIERARCHY=X$M._loadHierarchy,X$c.parserMap.MESH=X$M._loadMesh,X$c.parserMap.MATERIAL=X$M._loadMaterial,X$c.parserMap.TEXTURECUBE=X$M._loadTextureCube,X$c.parserMap.TERRAIN=X$M._loadTerrain,X$M._innerFirstLevelLoaderManager.on("error",null,X$M._eventLoadManagerError),X$M._innerSecondLevelLoaderManager.on("error",null,X$M._eventLoadManagerError),X$M._innerThirdLevelLoaderManager.on("error",null,X$M._eventLoadManagerError),X$M._innerFourthLevelLoaderManager.on("error",null,X$M._eventLoadManagerError)},X$M.READ_BLOCK=function(){return X$M._readData.pos+=4,!0},X$M.READ_DATA=function(){return X$M._DATA.offset=X$M._readData.getUint32(),X$M._DATA.size=X$M._readData.getUint32(),!0},X$M.READ_STRINGS=function(){var X$m=[],X$p={offset:0,size:0};X$p.offset=X$M._readData.getUint16(),X$p.size=X$M._readData.getUint16();X$M._readData.pos;X$M._readData.pos=X$p.offset+X$M._DATA.offset;for(var X$h=0;X$h<X$p.size;X$h++){var X$P=X$M._readData.readUTFString();-1===X$P.lastIndexOf(".lmat")&&-1===X$P.lastIndexOf(".lpbr")||X$m.push(X$P)}return X$m},X$M.formatRelativePath=function(X$m,X$p){var X$h;if("."===X$p.charAt(0)){for(var X$P=(X$m+X$p).split("/"),X$L=0,X$q=X$P.length;X$L<X$q;X$L++)if(".."==X$P[X$L]){var X$k=X$L-1;0<X$k&&".."!==X$P[X$k]&&(X$P.splice(X$k,2),X$L-=2)}X$h=X$P.join("/")}else X$h=X$m+X$p;return null!=X$x.customFormat&&(X$h=X$x.customFormat(X$h,null)),X$h},X$M._eventLoadManagerError=function(X$m){X$H.loader.event("error",X$m)},X$M._addHierarchyInnerUrls=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k=X$M.formatRelativePath(X$P,X$L);X$h&&(X$k+=X$h),X$m.push({url:X$k,clas:X$q}),X$p[X$L]=X$k},X$M._getSprite3DHierarchyInnerUrls=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){var X$Y,X$d=0,X$K=0;switch(X$m.type){case"Scene":var X$D=X$m.customProps.lightmaps;for(X$d=0,X$K=X$D.length;X$d<X$K;X$d++){var X$F=X$D[X$d].replace(".exr",".png");X$M._addHierarchyInnerUrls(X$P,X$L,X$q,X$k,X$F,X$rp)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var X$R;if(X$m.instanceParams)(X$R=X$m.instanceParams.loadPath)&&X$M._addHierarchyInnerUrls(X$p,X$L,X$q,X$k,X$R,X$Gp);else{(X$R=(X$Y=X$m.customProps).meshPath)&&X$M._addHierarchyInnerUrls(X$p,X$L,X$q,X$k,X$R,X$Gp);var X$$=X$Y.materials;if(X$$)for(X$d=0,X$K=X$$.length;X$d<X$K;X$d++){for(var X$A=X$$[X$d],X$B=X$A.type.split("."),X$n=X$u.window,X$c=0,X$e=X$B.length;X$c<X$e;++X$c){X$n=X$n[this.clasPaths[X$c]]}if("function"!=typeof X$n)throw"_getSprite3DHierarchyInnerUrls 错误: "+X$A.type+" 不是类";X$M._addHierarchyInnerUrls(X$h,X$L,X$q,X$k,X$A.path,X$n)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var X$a=(X$Y=X$m.customProps).meshPath;X$a&&X$M._addHierarchyInnerUrls(X$p,X$L,X$q,X$k,X$a,X$Gp);var X$Z=X$Y.material;if(X$Z){X$B=X$Z.type.split("."),X$n=X$u.window;for(X$c=0,X$e=X$B.length;X$c<X$e;++X$c){X$n=X$n[this.clasPaths[X$c]]}X$M._addHierarchyInnerUrls(X$h,X$L,X$q,X$k,X$Z.path,X$n)}else{var X$H=X$Y.materialPath;if(X$H)X$M._addHierarchyInnerUrls(X$h,X$L,X$q,X$k,X$H,ShurikenParticleMaterial);else{var X$W=X$Y.texturePath;X$W&&X$M._addHierarchyInnerUrls(X$P,X$L,X$q,X$k,X$W,X$rp)}}break;case"Terrain":X$M._addHierarchyInnerUrls(X$P,X$L,X$q,X$k,X$m.customProps.dataPath,TerrainRes)}var X$E=X$m.components;for(var X$I in X$E){var X$b=X$E[X$I];switch(X$I){case"Animator":var X$T=X$b.avatarPath;if(X$T)X$M._addHierarchyInnerUrls(X$P,X$L,X$q,X$k,X$T,Avatar);else{var X$j=X$b.avatar;X$j&&X$M._addHierarchyInnerUrls(X$P,X$L,X$q,X$k,X$j.path,Avatar)}var X$x=X$b.clipPaths;for(X$d=0,X$K=X$x.length;X$d<X$K;X$d++)X$M._addHierarchyInnerUrls(X$P,X$L,X$q,X$k,X$x[X$d],AnimationClip)}}var X$Q=X$m.child;for(X$d=0,X$K=X$Q.length;X$d<X$K;X$d++)X$M._getSprite3DHierarchyInnerUrls(X$Q[X$d],X$p,X$h,X$P,X$L,X$q,X$k)},X$M._loadHierarchy=function(X$m){X$m.on("loaded",null,X$M._onHierarchylhLoaded,[X$m,X$m._class._getGroup()]),X$m.load(X$m.url,"json",!1,null,!0)},X$M._onHierarchylhLoaded=function(X$m,X$p,X$h){if(X$m._class.destroyed)X$m.endLoad();else{var X$P=X$m.url,X$L=X$np.getURLVerion(X$P),X$q=X$x.getPath(X$P),X$k=[],X$Y=[],X$d=[],X$K={};X$M._getSprite3DHierarchyInnerUrls(X$h,X$k,X$Y,X$d,X$K,X$L,X$q);var X$D=X$k.length+X$Y.length+X$d.length,X$F=X$D+1,X$R=1/X$F;if(X$M._onProcessChange(X$m,0,X$R,1),0<X$d.length){var X$$=X$D/X$F,X$A=X$j.create(null,X$M._onProcessChange,[X$m,X$R,X$$],!1);X$M._innerFourthLevelLoaderManager.create(X$d,X$j.create(null,X$M._onHierarchyInnerForthLevResouLoaded,[X$m,X$p,X$A,X$h,X$K,X$k,X$Y,X$R+X$$*X$d.length,X$$]),X$A,null,null,1,!0,X$p)}else X$M._onHierarchyInnerForthLevResouLoaded(X$m,X$p,null,X$h,X$K,X$k,X$Y,X$R,X$$)}},X$M._onHierarchyInnerForthLevResouLoaded=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){if(X$m._class.destroyed)X$m.endLoad();else if(X$h&&X$h.recover(),0<X$k.length){var X$K=X$j.create(null,X$M._onProcessChange,[X$m,X$Y,X$d],!1);X$M._innerSecondLevelLoaderManager.create(X$k,X$j.create(null,X$M._onHierarchyInnerSecondLevResouLoaded,[X$m,X$p,X$K,X$P,X$L,X$q,X$Y+X$d*X$k.length,X$d]),X$h,null,null,1,!0,X$p)}else X$M._onHierarchyInnerSecondLevResouLoaded(X$m,X$p,null,X$P,X$L,X$q,X$Y,X$d)},X$M._onHierarchyInnerSecondLevResouLoaded=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y){if(X$m._class.destroyed)X$m.endLoad();else if(X$h&&X$h.recover(),0<X$q.length){var X$d=X$j.create(null,X$M._onProcessChange,[X$m,X$k,X$Y],!1);X$M._innerFirstLevelLoaderManager.create(X$q,X$j.create(null,X$M._onHierarchyInnerFirstLevResouLoaded,[X$m,X$d,X$P,X$L]),X$h,null,null,1,!0,X$p)}else X$M._onHierarchyInnerFirstLevResouLoaded(X$m,null,X$P,X$L)},X$M._onHierarchyInnerFirstLevResouLoaded=function(X$m,X$p,X$h,X$P){X$p&&X$p.recover(),X$m.endLoad([X$h,X$P])},X$M._loadTerrain=function(X$m){X$m.on("loaded",null,X$M._onTerrainLtLoaded,[X$m,X$m._class._getGroup()]),X$m.load(X$m.url,"json",!1,null,!0)},X$M._onTerrainLtLoaded=function(X$m,X$p,X$h){if(X$m._class.destroyed)X$m.endLoad();else{var X$P,X$L,X$q=X$m.url,X$k=X$np.getURLVerion(X$q),X$Y=X$x.getPath(X$q),X$d=[],X$K={},X$D=0,X$F=0,X$R=X$h.heightData;X$P=X$R.url,X$L=X$M.formatRelativePath(X$Y,X$P),X$k&&(X$L+=X$k),X$P=X$K[X$P]=X$L;var X$$=X$h.detailTexture;for(X$D=0,X$F=X$$.length;X$D<X$F;X$D++)X$d.push({url:X$$[X$D].diffuse});var X$A=X$h.normalMap;for(X$D=0,X$F=X$A.length;X$D<X$F;X$D++)X$d.push({url:X$A[X$D]});var X$B=X$h.alphaMap;for(X$D=0,X$F=X$B.length;X$D<X$F;X$D++)X$d.push({url:X$B[X$D],params:[!1,!1,6408,!0]});for(X$D=0,X$F=X$d.length;X$D<X$F;X$D++){var X$n=X$d[X$D].url;X$L=X$M.formatRelativePath(X$Y,X$n),X$k&&(X$L+=X$k),X$d[X$D].url=X$L,X$K[X$n]=X$L}var X$c=X$d.length,X$e=X$c+2,X$a=1/X$e;X$M._onProcessChange(X$m,0,X$a,1);var X$Z={heightMapLoaded:!1,texturesLoaded:!1},X$H=X$j.create(null,X$M._onProcessChange,[X$m,X$a,X$a],!1);X$M._innerFourthLevelLoaderManager.create(X$P,X$j.create(null,X$M._onTerrainHeightMapLoaded,[X$m,X$H,X$h,X$K,X$Z]),X$H,null,[X$R.numX,X$R.numZ,X$R.bitType,X$R.value],1,!0,X$p);var X$W=X$j.create(null,X$M._onProcessChange,[X$m,2*X$a,X$c/X$e],!1);X$M._innerFourthLevelLoaderManager.create(X$d,X$j.create(null,X$M._onTerrainTexturesLoaded,[X$m,X$W,X$h,X$K,X$Z]),X$W,null,null,1,!0,X$p)}},X$M._onTerrainHeightMapLoaded=function(X$m,X$p,X$h,X$P,X$L){X$L.heightMapLoaded=!0,X$L.texturesLoaded&&(X$m.endLoad([X$h,X$P]),X$p.recover())},X$M._onTerrainTexturesLoaded=function(X$m,X$p,X$h,X$P,X$L){X$L.texturesLoaded=!0,X$L.heightMapLoaded&&(X$m.endLoad([X$h,X$P]),X$p.recover())},X$M._loadMesh=function(X$m){X$m.on("loaded",null,X$M._onMeshLmLoaded,[X$m,X$m._class._getGroup()]),X$m.load(X$m.url,"arraybuffer",!1,null,!0)},X$M._onMeshLmLoaded=function(X$m,X$p,X$h){if(X$m._class.destroyed)X$m.endLoad();else{var X$P,X$L,X$q,X$k=X$m.url,X$Y=X$np.getURLVerion(X$k),X$d=X$x.getPath(X$k),X$K={},X$D=0,X$F=0;switch((X$M._readData=new X$W(X$h)).pos=0,X$M._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var X$R=X$M._readData.getUint32();X$M._readData.pos=X$M._readData.pos+4,X$F=X$M._readData.getUint16(),X$M._readData.pos=X$M._readData.pos+8*X$F;var X$$=X$M._readData.getUint32();for(X$F=X$M._readData.getUint16(),X$M._readData.pos=X$R+X$$,X$P=[],X$D=0;X$D<X$F;X$D++){var X$A=X$M._readData.readUTFString();-1!==X$A.lastIndexOf(".lmat")&&X$P.push(X$A)}break;default:for(X$M.READ_BLOCK(),X$D=0;X$D<2;X$D++){var X$B=X$M._readData.getUint16(),X$n=X$M._strings[X$B],X$c=X$M["READ_"+X$n];if(null==X$c)throw new Error("model file err,no this function:"+X$B+" "+X$n);1===X$D?X$P=X$c.call():X$c.call()}}for(X$D=0,X$q=X$P.length;X$D<X$q;X$D++){var X$e=X$P[X$D];X$L=X$M.formatRelativePath(X$d,X$e),X$Y&&(X$L+=X$Y),X$P[X$D]=X$L,X$K[X$e]=X$L}if(0<X$P.length){X$M._onProcessChange(X$m,0,.5,1);var X$a=X$j.create(null,X$M._onProcessChange,[X$m,.5,.5],!1);X$M._innerSecondLevelLoaderManager.create(X$P,X$j.create(null,X$M._onMeshMateialLoaded,[X$m,X$a,X$h,X$K]),X$a,null,null,1,!0,X$p)}else X$m.endLoad([X$h,X$K])}},X$M._onMeshMateialLoaded=function(X$m,X$p,X$h,X$P){X$m.endLoad([X$h,X$P]),X$p.recover()},X$M._getMaterialTexturePath=function(X$m,X$p,X$h){var X$P=X$m.length-4;return X$m.indexOf(".dds")!=X$P&&X$m.indexOf(".tga")!=X$P&&X$m.indexOf(".exr")!=X$P&&X$m.indexOf(".DDS")!=X$P&&X$m.indexOf(".TGA")!=X$P&&X$m.indexOf(".EXR")!=X$P||(X$m=X$m.substr(0,X$P)+".png"),X$m=X$M.formatRelativePath(X$h,X$m),X$p&&(X$m+=X$p),X$m},X$M._loadMaterial=function(X$m){X$m.on("loaded",null,X$M._onMaterilLmatLoaded,[X$m,X$m._class._getGroup()]),X$m.load(X$m.url,"json",!1,null,!0)},X$M._onMaterilLmatLoaded=function(X$m,X$p,X$h){if(X$m._class.destroyed)X$m.endLoad();else{var X$P,X$L=X$m.url,X$q=X$np.getURLVerion(X$L),X$k=X$x.getPath(X$L),X$Y=[],X$d={},X$K=X$h.customProps,X$D=X$h.version;if(X$D)switch(X$D){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var X$F=X$h.props.textures,X$R=0,X$$=X$F.length;X$R<X$$;X$R++){var X$A=X$F[X$R],X$B=X$A.path;if(X$B){var X$n=X$B.length-4;X$B.indexOf(".exr")!=X$n&&X$B.indexOf(".EXR")!=X$n||(X$B=X$B.substr(0,X$n)+".png"),X$P=X$M.formatRelativePath(X$k,X$B),X$q&&(X$P+=X$q),X$Y.push({url:X$P,params:X$A.params}),X$d[X$B]=X$P}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var X$c=X$K.diffuseTexture.texture2D;if(X$c&&(X$P=X$M._getMaterialTexturePath(X$c,X$q,X$k),X$Y.push(X$P),X$d[X$c]=X$P),X$K.normalTexture){var X$e=X$K.normalTexture.texture2D;X$e&&(X$P=X$M._getMaterialTexturePath(X$e,X$q,X$k),X$Y.push(X$P),X$d[X$e]=X$P)}if(X$K.specularTexture){var X$a=X$K.specularTexture.texture2D;X$a&&(X$P=X$M._getMaterialTexturePath(X$a,X$q,X$k),X$Y.push(X$P),X$d[X$a]=X$P)}if(X$K.emissiveTexture){var X$Z=X$K.emissiveTexture.texture2D;X$Z&&(X$P=X$M._getMaterialTexturePath(X$Z,X$q,X$k),X$Y.push(X$P),X$d[X$Z]=X$P)}if(X$K.ambientTexture){var X$H=X$K.ambientTexture.texture2D;X$H&&(X$P=X$M._getMaterialTexturePath(X$H,X$q,X$k),X$Y.push(X$P),X$d[X$H]=X$P)}if(X$K.reflectTexture){var X$W=X$K.reflectTexture.texture2D;X$W&&(X$P=X$M._getMaterialTexturePath(X$W,X$q,X$k),X$Y.push(X$P),X$d[X$W]=X$P)}}var X$E=X$Y.length,X$I=X$E+1,X$b=1/X$I;if(X$M._onProcessChange(X$m,0,X$b,1),0<X$E){var X$T=X$j.create(null,X$M._onProcessChange,[X$m,X$b,X$E/X$I],!1);X$M._innerFourthLevelLoaderManager.create(X$Y,X$j.create(null,X$M._onMateialTexturesLoaded,[X$m,X$T,X$h,X$d]),X$T,X$rp,null,1,!0,X$p)}else X$M._onMateialTexturesLoaded(X$m,null,X$h,null)}},X$M._onMateialTexturesLoaded=function(X$m,X$p,X$h,X$P){X$m.endLoad([X$h,X$P]),X$p&&X$p.recover()},X$M._loadTextureCube=function(X$m){X$m.on("loaded",null,X$M._onTextureCubeLtcLoaded,[X$m]),X$m.load(X$m.url,"json",!1,null,!0)},X$M._onTextureCubeLtcLoaded=function(X$m,X$p){if(X$m._class.destroyed)X$m.endLoad();else{var X$h=X$x.getPath(X$m.url),X$P=[X$M.formatRelativePath(X$h,X$p.px),X$M.formatRelativePath(X$h,X$p.nx),X$M.formatRelativePath(X$h,X$p.py),X$M.formatRelativePath(X$h,X$p.ny),X$M.formatRelativePath(X$h,X$p.pz),X$M.formatRelativePath(X$h,X$p.nz)];X$M._onProcessChange(X$m,0,1/7,1);var X$L=X$j.create(null,X$M._onProcessChange,[X$m,1/7,6/7],!1);X$M._innerFourthLevelLoaderManager.load(X$P,X$j.create(null,X$M._onTextureCubeImagesLoaded,[X$m,X$P,X$L]),X$L,"nativeimage")}},X$M._onTextureCubeImagesLoaded=function(X$m,X$p,X$h){var X$P=[];X$P.length=6;for(var X$L=0;X$L<6;X$L++){var X$q=X$p[X$L];X$P[X$L]=X$c.getRes(X$q),X$c.clearRes(X$q)}X$m.endLoad(X$P),X$h.recover()},X$M._onProcessChange=function(X$m,X$p,X$h,X$P){(X$P=X$p+X$P*X$h)<1&&X$m.event("progress",X$P)},X$M.init=function(X$m,X$p,X$h,X$P,X$L,X$q){if(void 0===X$h&&(X$h=!1),void 0===X$P&&(X$P=!1),void 0===X$L&&(X$L=!0),void 0===X$q&&(X$q=!0),X$e.update3DLoop=function(){},X$e.cancelLoadByUrl=function(X$m){X$M._cancelLoadByUrl(X$m)},X$d.isAntialias=X$h,X$d.isAlpha=X$P,X$d.premultipliedAlpha=X$L,X$d.isStencil=X$q,!X$Q.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");X$e.changeWebGLSize=X$M._changeWebGLSize,X$B.is3DMode=!0,X$H.init(X$m,X$p),X$N.__init__(),X$Fp.__init__(),X$fp.__init__(),X$s.__init__(),X$M.__init__(),X$k.maxTextureCount=2,(X$M.debugMode||X$v.debugMode)&&(X$M._debugPhasorSprite=new X$V)},X$M.HIERARCHY="SPRITE3DHIERARCHY",X$M.MESH="MESH",X$M.MATERIAL="MATERIAL",X$M.PBRMATERIAL="PBRMTL",X$M.TEXTURECUBE="TEXTURECUBE",X$M.TERRAIN="TERRAIN",X$M._readData=null,X$M._debugPhasorSprite=null,X$M.debugMode=!1,X$F(X$M,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new X$p},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new X$p},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new X$p},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new X$p}]),X$M}(),X$ep=function(X$m){function X$L(X$m){X$L.__super.call(this),this._owner=X$m,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}X$$(X$L,"laya.d3.animation.AnimationTransform3D",X$q);var X$p=X$L.prototype;return X$p._getlocalMatrix=function(){return this._localUpdate&&(X$np._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},X$p._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var X$m=0,X$p=this._childs.length;X$m<X$p;X$m++)this._childs[X$m]._onWorldTransform()}},X$p._setWorldMatrixAndUpdate=function(X$m){if(this._worldMatrix=X$m,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var X$p=this._getlocalMatrix(),X$h=0;X$h<16;++X$h)this._worldMatrix[X$h]=X$p[X$h];else X$np.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},X$p._setWorldMatrixNoUpdate=function(X$m){this._worldMatrix=X$m},X$p._setWorldMatrixIgnoreUpdate=function(X$m){this._worldMatrix=X$m,this._worldUpdate=!1},X$p.getLocalPosition=function(){return this._localPosition},X$p.setLocalPosition=function(X$m){if(this._parent)this._localPosition=X$m,this._localUpdate=!0,this._onWorldTransform();else{var X$p=this._entity.owner._transform,X$h=this._entity.localPosition,X$P=X$h.elements;X$P[0]=X$m[0],X$P[1]=X$m[1],X$P[2]=X$m[2],X$p.localPosition=X$h}},X$p.getLocalRotation=function(){if(this._localQuaternionUpdate){var X$m=this._localRotationEuler;X$np._quaternionCreateFromYawPitchRollArray(X$m[1]/X$L._angleToRandin,X$m[0]/X$L._angleToRandin,X$m[2]/X$L._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},X$p.setLocalRotation=function(X$m){if(this._parent)this._localRotation=X$m,X$np.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var X$p=this._entity.owner._transform,X$h=this._entity.localRotation,X$P=X$h.elements;X$P[0]=X$m[0],X$P[1]=X$m[1],X$P[2]=X$m[2],X$P[3]=X$m[3],X$p.localRotation=X$h}},X$p.getLocalScale=function(){return this._localScale},X$p.setLocalScale=function(X$m){if(this._parent)this._localScale=X$m,this._localUpdate=!0,this._onWorldTransform();else{var X$p=this._entity.owner._transform,X$h=this._entity.localScale,X$P=X$h.elements;X$P[0]=X$m[0],X$P[1]=X$m[1],X$P[2]=X$m[2],X$p.localScale=X$h}},X$p.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){X$np.getYawPitchRoll(this._localRotation,X$L._tempVector3);var X$m=X$L._tempVector3,X$p=this._localRotationEuler;X$p[0]=X$m[1]*X$L._angleToRandin,X$p[1]=X$m[0]*X$L._angleToRandin,X$p[2]=X$m[2]*X$L._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},X$p.setLocalRotationEuler=function(X$m){if(this._parent)X$np._quaternionCreateFromYawPitchRollArray(X$m[1]/X$L._angleToRandin,X$m[0]/X$L._angleToRandin,X$m[2]/X$L._angleToRandin,this._localRotation),this._localRotationEuler=X$m,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var X$p=this._entity.owner._transform,X$h=this._entity.localRotationEuler,X$P=X$h.elements;X$P[0]=X$m[0],X$P[1]=X$m[1],X$P[2]=X$m[2],X$p.localRotationEuler=X$h}},X$p.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)X$np.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var X$m=this._getlocalMatrix(),X$p=0;X$p<16;++X$p)this._worldMatrix[X$p]=X$m[X$p];this._worldUpdate=!1}return this._worldMatrix},X$p.setParent=function(X$m){if(this._parent!==X$m){if(this._parent){var X$p=this._parent._childs,X$h=X$p.indexOf(this);X$p.splice(X$h,1)}X$m&&(X$m._childs.push(this),X$m&&this._onWorldTransform()),this._parent=X$m}},X$F(X$L,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),X$L}(),X$ap=function(X$m){function X$p(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,X$p.__super.call(this),this._destroyed=!1,this._id=X$p._uniqueIDCounter,X$p._uniqueIDCounter++}X$$(X$p,"laya.d3.component.Component3D",X$q);var X$h=X$p.prototype;return X$H.imps(X$h,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),X$h._initialize=function(X$m){this._owner=X$m,this._enable=!0,this.started=!1,this._load(X$m)},X$h._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},X$h._load=function(X$m){},X$h._start=function(X$m){},X$h._update=function(X$m){},X$h._lateUpdate=function(X$m){},X$h._preRenderUpdate=function(X$m){},X$h._postRenderUpdate=function(X$m){},X$h._unload=function(X$m){this.offAll()},X$h._cloneTo=function(X$m){},X$A(0,X$h,"id",function(){return this._id}),X$A(0,X$h,"destroyed",function(){return this._destroyed}),X$A(0,X$h,"owner",function(){return this._owner}),X$A(0,X$h,"enable",function(){return this._enable},function(X$m){this._enable!==X$m&&(this._enable=X$m,this.event("enablechanged",this._enable))}),X$A(0,X$h,"isSingleton",function(){return X$p._isSingleton}),X$p._isSingleton=!0,X$p._uniqueIDCounter=1,X$p}(),X$Zp=function(X$m){function X$p(){this._destroyed=!1,X$p.__super.call(this),this._destroyed=!1}X$$(X$p,"laya.d3.core.GeometryFilter",X$q);var X$h=X$p.prototype;return X$H.imps(X$h,{"laya.resource.IDestroy":!0}),X$h._destroy=function(){this.offAll(),this._destroyed=!0},X$A(0,X$h,"_isAsyncLoaded",function(){return!0}),X$A(0,X$h,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),X$A(0,X$h,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),X$A(0,X$h,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),X$A(0,X$h,"destroyed",function(){return this._destroyed}),X$p}(),X$Hp=function(X$m){function X$P(X$m){X$P.__super.call(this),this._id=++X$P._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new X$vm(new X$kp,new X$kp),this._boundingBoxCenter=new X$kp,this._boundingSphere=new X$tm(new X$kp,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=X$m,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}X$$(X$P,"laya.d3.core.render.BaseRender",X$q);var X$p=X$P.prototype;return X$H.imps(X$p,{"laya.resource.IDestroy":!0}),X$p._changeMaterialReference=function(X$m,X$p){X$m&&X$m._removeReference(),X$p._addReference()},X$p._getInstanceMaterial=function(X$m,X$p){var X$h=new X$m.constructor;return X$m.cloneTo(X$h),X$h.name=X$h.name+"(Instance)",this._materialsInstance[X$p]=!0,this._changeMaterialReference(this._materials[X$p],X$h),this._materials[X$p]=X$h},X$p._setShaderValuelightMap=function(X$m){this._setShaderValueTexture(3,X$m)},X$p._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},X$p._renderRenderableBoundBox=function(){var X$m=X$cp._debugPhasorSprite,X$p=this.boundingBox,X$h=X$P._tempBoundBoxCorners;X$p.getCorners(X$h),X$m.line(X$h[0],X$P._greenColor,X$h[1],X$P._greenColor),X$m.line(X$h[2],X$P._greenColor,X$h[3],X$P._greenColor),X$m.line(X$h[4],X$P._greenColor,X$h[5],X$P._greenColor),X$m.line(X$h[6],X$P._greenColor,X$h[7],X$P._greenColor),X$m.line(X$h[0],X$P._greenColor,X$h[3],X$P._greenColor),X$m.line(X$h[1],X$P._greenColor,X$h[2],X$P._greenColor),X$m.line(X$h[2],X$P._greenColor,X$h[6],X$P._greenColor),X$m.line(X$h[3],X$P._greenColor,X$h[7],X$P._greenColor),X$m.line(X$h[0],X$P._greenColor,X$h[4],X$P._greenColor),X$m.line(X$h[1],X$P._greenColor,X$h[5],X$P._greenColor),X$m.line(X$h[4],X$P._greenColor,X$h[7],X$P._greenColor),X$m.line(X$h[5],X$P._greenColor,X$h[6],X$P._greenColor)},X$p._calculateBoundingSphere=function(){throw"BaseRender: must override it."},X$p._calculateBoundingBox=function(){throw"BaseRender: must override it."},X$p._setShaderValueTexture=function(X$m,X$p){this._owner._shaderValues.setValue(X$m,X$p)},X$p._setShaderValueMatrix4x4=function(X$m,X$p){this._owner._shaderValues.setValue(X$m,X$p?X$p.elements:null)},X$p._setShaderValueColor=function(X$m,X$p){this._owner._shaderValues.setValue(X$m,X$p?X$p.elements:null)},X$p._setShaderValueBuffer=function(X$m,X$p){this._owner._shaderValues.setValue(X$m,X$p)},X$p._setShaderValueInt=function(X$m,X$p){this._owner._shaderValues.setValue(X$m,X$p)},X$p._setShaderValueBool=function(X$m,X$p){this._owner._shaderValues.setValue(X$m,X$p)},X$p._setShaderValueNumber=function(X$m,X$p){this._owner._shaderValues.setValue(X$m,X$p)},X$p._setShaderValueVector2=function(X$m,X$p){this._owner._shaderValues.setValue(X$m,X$p?X$p.elements:null)},X$p._addShaderDefine=function(X$m){this._owner._shaderDefineValue|=X$m},X$p._removeShaderDefine=function(X$m){this._owner._shaderDefineValue&=~X$m},X$p._renderUpdate=function(X$m){return!0},X$p._applyLightMapParams=function(){if(0<=this._lightmapIndex){var X$m=this._owner.scene;if(X$m){var X$p=X$m.getlightmaps()[this._lightmapIndex];X$p?(this._addShaderDefine(X$Vp.SAHDERDEFINE_LIGHTMAP),X$p.loaded?this._setShaderValuelightMap(X$p):X$p.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(X$Vp.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(X$Vp.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(X$Vp.SAHDERDEFINE_LIGHTMAP)},X$p._updateOctreeNode=function(){var X$m=this._treeNode;X$m&&this._octreeNodeNeedChange&&(X$m.updateObject(this),this._octreeNodeNeedChange=!1)},X$p._destroy=function(){this.offAll();var X$m=0,X$p=0;for(X$m=0,X$p=this._renderElements.length;X$m<X$p;X$m++)this._renderElements[X$m]._destroy();for(X$m=0,X$p=this._materials.length;X$m<X$p;X$m++)this._materials[X$m]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},X$A(0,X$p,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),X$A(0,X$p,"id",function(){return this._id}),X$A(0,X$p,"material",function(){var X$m=this._materials[0];if(X$m&&!this._materialsInstance[0]){var X$p=this._getInstanceMaterial(X$m,0);this.event("materialchanged",[this,0,X$p])}return this._materials[0]},function(X$m){this.sharedMaterial=X$m}),X$A(0,X$p,"sharedMaterial",function(){return this._materials[0]},function(X$m){var X$p=this._materials[0];X$p!==X$m&&(this._materials[0]=X$m,this._materialsInstance[0]=!1,this._changeMaterialReference(X$p,X$m),this.event("materialchanged",[this,0,X$m]))}),X$A(0,X$p,"lightmapIndex",function(){return this._lightmapIndex},function(X$m){this._lightmapIndex=X$m,this._applyLightMapParams()}),X$A(0,X$p,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(X$m){this._lightmapScaleOffset=X$m,this._setShaderValueColor(2,X$m),this._addShaderDefine(X$Vp.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),X$A(0,X$p,"enable",function(){return this._enable},function(X$m){this._enable=X$m,this.event("enablechanged",[this,X$m])}),X$A(0,X$p,"materials",function(){for(var X$m=0,X$p=this._materials.length;X$m<X$p;X$m++)if(!this._materialsInstance[X$m]){var X$h=this._getInstanceMaterial(this._materials[X$m],X$m);this.event("materialchanged",[this,X$m,X$h])}return this._materials.slice()},function(X$m){this.sharedMaterials=X$m}),X$A(0,X$p,"sharedMaterials",function(){return this._materials.slice()},function(X$m){if(!X$m)throw new Error("MeshRender: shadredMaterials value can't be null.");var X$p=X$m.length;this._materialsInstance.length=X$p;for(var X$h=0;X$h<X$p;X$h++){var X$P=this._materials[X$h];X$P!==X$m[X$h]&&(this._materialsInstance[X$h]=!1,this._changeMaterialReference(X$P,X$m[X$h]),this.event("materialchanged",[this,X$h,X$m[X$h]]))}this._materials=X$m}),X$A(0,X$p,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),X$A(0,X$p,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var X$m=this.boundingBox;X$kp.add(X$m.min,X$m.max,this._boundingBoxCenter),X$kp.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),X$A(0,X$p,"receiveShadow",function(){return this._receiveShadow},function(X$m){this._receiveShadow!==X$m&&((this._receiveShadow=X$m)?this._addShaderDefine(X$$p.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(X$$p.SHADERDEFINE_RECEIVE_SHADOW))}),X$A(0,X$p,"destroyed",function(){return this._destroyed}),X$P._uniqueIDCounter=0,X$F(X$P,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new X$kp,new X$kp,new X$kp,new X$kp,new X$kp,new X$kp,new X$kp,new X$kp]},"_greenColor",function(){return this._greenColor=new X$Yp(0,1,0,1)}]),X$P}(),X$Wp=function(X$m){function X$Y(X$m){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,X$Y.__super.call(this),this._localPosition=new X$kp,this._localRotation=new X$hp(0,0,0,1),this._localScale=new X$kp(1,1,1),this._localRotationEuler=new X$kp,this._localMatrix=new X$mp,this._position=new X$kp,this._rotation=new X$hp(0,0,0,1),this._scale=new X$kp(1,1,1),this._worldMatrix=new X$mp,this._forward=new X$kp,this._up=new X$kp,this._right=new X$kp,this._owner=X$m,this._childs=[]}X$$(X$Y,"laya.d3.core.Transform3D",X$q);var X$p=X$Y.prototype;return X$p._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)X$mp.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var X$m=X$Y._tempVector30;X$kp.multiply(this.pivot,this._localScale,X$m);var X$p=X$Y._tempVector31;X$kp.subtract(X$m,this.pivot,X$p);var X$h=X$Y._tempVector32,X$P=this.localRotation;X$kp.transformQuat(X$m,X$P,X$h),X$kp.subtract(X$h,X$m,X$h);var X$L=X$Y._tempVector33;X$kp.subtract(this._localPosition,X$p,X$L),X$kp.subtract(X$L,X$h,X$L),X$mp.createAffineTransformation(X$L,X$P,this._localScale,this._localMatrix)}},X$p._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var X$m=0,X$p=this._childs.length;X$m<X$p;X$m++)this._childs[X$m]._onWorldPositionRotationTransform()}},X$p._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var X$m=0,X$p=this._childs.length;X$m<X$p;X$m++)this._childs[X$m]._onWorldPositionScaleTransform()}},X$p._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var X$m=0,X$p=this._childs.length;X$m<X$p;X$m++)this._childs[X$m]._onWorldPositionTransform()}},X$p._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var X$m=0,X$p=this._childs.length;X$m<X$p;X$m++)this._childs[X$m]._onWorldPositionRotationTransform()}},X$p._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var X$m=0,X$p=this._childs.length;X$m<X$p;X$m++)this._childs[X$m]._onWorldPositionScaleTransform()}},X$p._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var X$m=0,X$p=this._childs.length;X$m<X$p;X$m++)this._childs[X$m]._onWorldTransform()}},X$p.translate=function(X$m,X$p){void 0===X$p&&(X$p=!0),X$p?(X$mp.createFromQuaternion(this.localRotation,X$Y._tempMatrix0),X$kp.transformCoordinate(X$m,X$Y._tempMatrix0,X$Y._tempVector30),X$kp.add(this.localPosition,X$Y._tempVector30,this._localPosition),this.localPosition=this._localPosition):(X$kp.add(this.position,X$m,this._position),this.position=this._position)},X$p.rotate=function(X$m,X$p,X$h){var X$P;void 0===X$p&&(X$p=!0),void 0===X$h&&(X$h=!0),X$P=X$h?X$m:(X$kp.scale(X$m,Math.PI/180,X$Y._tempVector30),X$Y._tempVector30),X$hp.createFromYawPitchRoll(X$P.y,X$P.x,X$P.z,X$Y._tempQuaternion0),X$p?(X$hp.multiply(this._localRotation,X$Y._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(X$hp.multiply(X$Y._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},X$p.lookAt=function(X$m,X$p,X$h){void 0===X$h&&(X$h=!1);var X$P,X$L=X$m.elements;if(X$h){if(X$P=this._localPosition.elements,Math.abs(X$P[0]-X$L[0])<X$Om.zeroTolerance&&Math.abs(X$P[1]-X$L[1])<X$Om.zeroTolerance&&Math.abs(X$P[2]-X$L[2])<X$Om.zeroTolerance)return;X$hp.lookAt(this._localPosition,X$m,X$p,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var X$q=this.position;if(X$P=X$q.elements,Math.abs(X$P[0]-X$L[0])<X$Om.zeroTolerance&&Math.abs(X$P[1]-X$L[1])<X$Om.zeroTolerance&&Math.abs(X$P[2]-X$L[2])<X$Om.zeroTolerance)return;X$hp.lookAt(X$q,X$m,X$p,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},X$A(0,X$p,"_isFrontFaceInvert",function(){var X$m=this.scale,X$p=X$m.x<0;return X$m.y<0&&(X$p=!X$p),X$m.z<0&&(X$p=!X$p),X$p}),X$A(0,X$p,"owner",function(){return this._owner}),X$A(0,X$p,"localRotation",function(){if(this._localQuaternionUpdate){var X$m=this._localRotationEuler.elements;X$hp.createFromYawPitchRoll(X$m[1]/X$Y._angleToRandin,X$m[0]/X$Y._angleToRandin,X$m[2]/X$Y._angleToRandin,this._localRotation)}return this._localRotation},function(X$m){this._localRotation=X$m,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),X$A(0,X$p,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?X$mp.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(X$m){null===this._parent?X$m.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),X$mp.multiply(this._localMatrix,X$m,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=X$m,this._worldUpdate=!1}),X$A(0,X$p,"worldNeedUpdate",function(){return this._worldUpdate}),X$A(0,X$p,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(X$m){this._localMatrix=X$m,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),X$A(0,X$p,"dummy",function(){return this._dummy},function(X$m){this._dummy!==X$m&&(this._dummy&&(this._dummy._entity=null),X$m&&(X$m._entity=this),this._dummy=X$m)}),X$A(0,X$p,"localPosition",function(){return this._localPosition},function(X$m){this._localPosition=X$m,this._localUpdate=!0,this._onWorldPositionTransform()}),X$A(0,X$p,"position",function(){if(this._positionUpdate){if(null!=this._parent){var X$m=this._parent.position;X$kp.multiply(this._localPosition,this._parent.scale,X$Y._tempVector30),X$kp.transformQuat(X$Y._tempVector30,this._parent.rotation,X$Y._tempVector30),X$kp.add(X$m,X$Y._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(X$m){if(null!=this._parent){X$kp.subtract(X$m,this._parent.position,this._localPosition);var X$p=this._parent.scale.elements,X$h=X$p[0],X$P=X$p[1],X$L=X$p[2];if(1!==X$h||1!==X$P||1!==X$L){var X$q=X$Y._tempVector30,X$k=X$q.elements;X$k[0]=1/X$h,X$k[1]=1/X$P,X$k[2]=1/X$L,X$kp.multiply(this._localPosition,X$q,this._localPosition)}this._parent.rotation.invert(X$Y._tempQuaternion0),X$kp.transformQuat(this._localPosition,X$Y._tempQuaternion0,this._localPosition)}else X$m.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=X$m,this._positionUpdate=!1}),X$A(0,X$p,"localScale",function(){return this._localScale},function(X$m){this._localScale=X$m,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),X$A(0,X$p,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(X$Y._tempVector30);var X$m=X$Y._tempVector30.elements,X$p=this._localRotationEuler.elements;X$p[0]=X$m[1]*X$Y._angleToRandin,X$p[1]=X$m[0]*X$Y._angleToRandin,X$p[2]=X$m[2]*X$Y._angleToRandin}return this._localRotationEuler},function(X$m){this._localRotationEuler=X$m,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),X$A(0,X$p,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?X$hp.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(X$m){null!=this._parent?(this._parent.rotation.invert(X$Y._tempQuaternion0),X$hp.multiply(X$m,X$Y._tempQuaternion0,this._localRotation)):X$m.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=X$m,this._rotationUpdate=!1}),X$A(0,X$p,"scale",function(){return this._scaleUpdate&&(null!==this._parent?X$kp.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(X$m){if(null!==this._parent){var X$p=this._parent.scale.elements,X$h=X$Y._tempVector30.elements;X$h[0]=1/X$p[0],X$h[1]=1/X$p[1],X$h[2]=1/X$p[2],X$kp.multiply(X$m,X$Y._tempVector30,this._localScale)}else X$m.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=X$m,this._scaleUpdate=!1}),X$A(0,X$p,"rotationEuler",null,function(X$m){X$hp.createFromYawPitchRoll(X$m.y,X$m.x,X$m.z,this._rotation),this.rotation=this._rotation}),X$A(0,X$p,"forward",function(){var X$m=this.worldMatrix.elements;return this._forward.elements[0]=-X$m[8],this._forward.elements[1]=-X$m[9],this._forward.elements[2]=-X$m[10],this._forward}),X$A(0,X$p,"up",function(){var X$m=this.worldMatrix.elements;return this._up.elements[0]=X$m[4],this._up.elements[1]=X$m[5],this._up.elements[2]=X$m[6],this._up}),X$A(0,X$p,"right",function(){var X$m=this.worldMatrix.elements;return this._right.elements[0]=X$m[0],this._right.elements[1]=X$m[1],this._right.elements[2]=X$m[2],this._right}),X$A(0,X$p,"parent",function(){return this._parent},function(X$m){if(this._parent!==X$m){if(this._parent){var X$p=this._parent._childs,X$h=X$p.indexOf(this);X$p.splice(X$h,1)}X$m&&(X$m._childs.push(this),X$m&&this._onWorldTransform()),this._parent=X$m}}),X$F(X$Y,["_tempVector30",function(){return this._tempVector30=new X$kp},"_tempVector31",function(){return this._tempVector31=new X$kp},"_tempVector32",function(){return this._tempVector32=new X$kp},"_tempVector33",function(){return this._tempVector33=new X$kp},"_tempQuaternion0",function(){return this._tempQuaternion0=new X$hp},"_tempMatrix0",function(){return this._tempMatrix0=new X$mp},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),X$Y}(),X$Ep=(function(X$m){function X$p(){this._rotation=0,this._matNeedUpdte=!1,X$p.__super.call(this),this._matrix=new X$mp,this._offset=new X$qp,this._tiling=new X$qp(1,1)}X$$(X$p,"laya.d3.core.TransformUV",X$q);var X$h=X$p.prototype;X$H.imps(X$h,{"laya.d3.core.IClone":!0}),X$h._updateMatrix=function(){X$p._tempOffsetV3.elements[0]=this._offset.x,X$p._tempOffsetV3.elements[1]=this._offset.y,X$hp.createFromYawPitchRoll(0,0,this._rotation,X$p._tempRotationQua),X$p._tempTitlingV3.elements[0]=this._tiling.x,X$p._tempTitlingV3.elements[1]=this._tiling.y,X$mp.createAffineTransformation(X$p._tempOffsetV3,X$p._tempRotationQua,X$p._tempTitlingV3,this._matrix)},X$h.cloneTo=function(X$m){X$m._matrix=this._matrix.clone(),X$m._offset=this._offset.clone(),X$m._rotation=this._rotation,X$m._tiling=this._tiling.clone()},X$h.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$h,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),X$A(0,X$h,"tiling",function(){return this._tiling},function(X$m){this._tiling=X$m,this._matNeedUpdte=!0}),X$A(0,X$h,"offset",function(){return this._offset},function(X$m){this._offset=X$m,this._matNeedUpdte=!0}),X$A(0,X$h,"rotation",function(){return this._rotation},function(X$m){this._rotation=X$m,this._matNeedUpdte=!0}),X$F(X$p,["_tempOffsetV3",function(){return this._tempOffsetV3=new X$kp(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new X$hp},"_tempTitlingV3",function(){return this._tempTitlingV3=new X$kp(1,1,1)}])}(),function(X$h){function X$m(){this.x=NaN,this.y=NaN,this.z=NaN,X$m.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}X$$(X$m,"laya.d3.core.particleShuriKen.module.shape.BoxShape",X$h);var X$p=X$m.prototype;X$p._getShapeBoundBox=function(X$m){var X$p=X$m.min.elements;X$p[0]=.5*-this.x,X$p[1]=.5*-this.y,X$p[2]=.5*-this.z;var X$h=X$m.max.elements;X$h[0]=.5*this.x,X$h[1]=.5*this.y,X$h[2]=.5*this.z},X$p._getSpeedBoundBox=function(X$m){var X$p=X$m.min.elements;X$p[0]=0,X$p[1]=0,X$p[2]=0;var X$h=X$m.max.elements;X$h[0]=0,X$h[1]=1,X$h[2]=0},X$p.generatePositionAndDirection=function(X$m,X$p,X$h,X$P){var X$L=X$m.elements,X$q=X$p.elements;X$h?(X$h.seed=X$P[16],X$r._randomPointInsideHalfUnitBox(X$m,X$h),X$P[16]=X$h.seed):X$r._randomPointInsideHalfUnitBox(X$m),X$L[0]=this.x*X$L[0],X$L[1]=this.y*X$L[1],X$L[2]=this.z*X$L[2],this.randomDirection?X$h?(X$h.seed=X$P[17],X$r._randomPointUnitSphere(X$p,X$h),X$P[17]=X$h.seed):X$r._randomPointUnitSphere(X$p):(X$q[0]=0,X$q[1]=0,X$q[2]=1)},X$p.cloneTo=function(X$m){X$h.prototype.cloneTo.call(this,X$m);var X$p=X$m;X$p.x=this.x,X$p.y=this.y,X$p.z=this.z,X$p.randomDirection=this.randomDirection}}(X$w),function(X$h){function X$k(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,X$k.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}X$$(X$k,"laya.d3.core.particleShuriKen.module.shape.CircleShape",X$h);var X$m=X$k.prototype;X$m._getShapeBoundBox=function(X$m){var X$p=X$m.min.elements;X$p[0]=X$p[2]=-this.radius,X$p[1]=0;var X$h=X$m.max.elements;X$h[0]=X$h[2]=this.radius,X$h[1]=0},X$m._getSpeedBoundBox=function(X$m){var X$p=X$m.min.elements;X$p[0]=X$p[1]=-1,X$p[2]=0;var X$h=X$m.max.elements;X$h[0]=X$h[1]=1,X$h[2]=0},X$m.generatePositionAndDirection=function(X$m,X$p,X$h,X$P){var X$L=X$m.elements,X$q=X$k._tempPositionPoint.elements;X$h?(X$h.seed=X$P[16],this.emitFromEdge?X$r._randomPointUnitArcCircle(this.arc,X$k._tempPositionPoint,X$h):X$r._randomPointInsideUnitArcCircle(this.arc,X$k._tempPositionPoint,X$h),X$P[16]=X$h.seed):this.emitFromEdge?X$r._randomPointUnitArcCircle(this.arc,X$k._tempPositionPoint):X$r._randomPointInsideUnitArcCircle(this.arc,X$k._tempPositionPoint),X$L[0]=-X$q[0],X$L[1]=X$q[1],X$L[2]=0,X$kp.scale(X$m,this.radius,X$m),this.randomDirection?X$h?(X$h.seed=X$P[17],X$r._randomPointUnitSphere(X$p,X$h),X$P[17]=X$h.seed):X$r._randomPointUnitSphere(X$p):X$m.cloneTo(X$p)},X$m.cloneTo=function(X$m){X$h.prototype.cloneTo.call(this,X$m);var X$p=X$m;X$p.radius=this.radius,X$p.arc=this.arc,X$p.emitFromEdge=this.emitFromEdge,X$p.randomDirection=this.randomDirection},X$F(X$k,["_tempPositionPoint",function(){return this._tempPositionPoint=new X$qp}])}(X$w),function(X$h){function X$R(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,X$R.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}X$$(X$R,"laya.d3.core.particleShuriKen.module.shape.ConeShape",X$h);var X$m=X$R.prototype;X$m._getShapeBoundBox=function(X$m){var X$p=this.radius+this.length*Math.sin(this.angle),X$h=this.length*Math.cos(this.angle),X$P=X$m.min.elements;X$P[0]=X$P[1]=-X$p,X$P[2]=0;var X$L=X$m.max.elements;X$L[0]=X$L[1]=X$p,X$L[2]=X$h},X$m._getSpeedBoundBox=function(X$m){var X$p=Math.sin(this.angle),X$h=X$m.min.elements;X$h[0]=X$h[1]=-X$p,X$h[2]=0;var X$P=X$m.max.elements;X$P[0]=X$h[1]=X$p,X$P[2]=1},X$m.generatePositionAndDirection=function(X$m,X$p,X$h,X$P){var X$L,X$q=X$m.elements,X$k=X$p.elements,X$Y=X$R._tempPositionPoint.elements,X$d=NaN,X$K=NaN,X$D=Math.cos(this.angle),X$F=Math.sin(this.angle);switch(this.emitType){case 0:X$h?(X$h.seed=X$P[16],X$r._randomPointInsideUnitCircle(X$R._tempPositionPoint,X$h),X$P[16]=X$h.seed):X$r._randomPointInsideUnitCircle(X$R._tempPositionPoint),X$d=X$Y[0],X$K=X$Y[1],X$q[0]=X$d*this.radius,X$q[1]=X$K*this.radius,X$q[2]=0,this.randomDirection?(X$h?(X$h.seed=X$P[17],X$r._randomPointInsideUnitCircle(X$R._tempDirectionPoint,X$h),X$P[17]=X$h.seed):X$r._randomPointInsideUnitCircle(X$R._tempDirectionPoint),X$L=X$R._tempDirectionPoint.elements,X$k[0]=X$L[0]*X$F,X$k[1]=X$L[1]*X$F):(X$k[0]=X$d*X$F,X$k[1]=X$K*X$F),X$k[2]=X$D;break;case 1:X$h?(X$h.seed=X$P[16],X$r._randomPointUnitCircle(X$R._tempPositionPoint,X$h),X$P[16]=X$h.seed):X$r._randomPointUnitCircle(X$R._tempPositionPoint),X$d=X$Y[0],X$K=X$Y[1],X$q[0]=X$d*this.radius,X$q[1]=X$K*this.radius,X$q[2]=0,this.randomDirection?(X$h?(X$h.seed=X$P[17],X$r._randomPointInsideUnitCircle(X$R._tempDirectionPoint,X$h),X$P[17]=X$h.seed):X$r._randomPointInsideUnitCircle(X$R._tempDirectionPoint),X$L=X$R._tempDirectionPoint.elements,X$k[0]=X$L[0]*X$F,X$k[1]=X$L[1]*X$F):(X$k[0]=X$d*X$F,X$k[1]=X$K*X$F),X$k[2]=X$D;break;case 2:X$h?(X$h.seed=X$P[16],X$r._randomPointInsideUnitCircle(X$R._tempPositionPoint,X$h)):X$r._randomPointInsideUnitCircle(X$R._tempPositionPoint),X$d=X$Y[0],X$K=X$Y[1],X$q[0]=X$d*this.radius,X$q[1]=X$K*this.radius,X$k[X$q[2]=0]=X$d*X$F,X$k[1]=X$K*X$F,X$k[2]=X$D,X$kp.normalize(X$p,X$p),X$h?(X$kp.scale(X$p,this.length*X$h.getFloat(),X$p),X$P[16]=X$h.seed):X$kp.scale(X$p,this.length*Math.random(),X$p),X$kp.add(X$m,X$p,X$m),this.randomDirection&&(X$h?(X$h.seed=X$P[17],X$r._randomPointUnitSphere(X$p,X$h),X$P[17]=X$h.seed):X$r._randomPointUnitSphere(X$p));break;case 3:X$h?(X$h.seed=X$P[16],X$r._randomPointUnitCircle(X$R._tempPositionPoint,X$h)):X$r._randomPointUnitCircle(X$R._tempPositionPoint),X$d=X$Y[0],X$K=X$Y[1],X$q[0]=X$d*this.radius,X$q[1]=X$K*this.radius,X$k[X$q[2]=0]=X$d*X$F,X$k[1]=X$K*X$F,X$k[2]=X$D,X$kp.normalize(X$p,X$p),X$h?(X$kp.scale(X$p,this.length*X$h.getFloat(),X$p),X$P[16]=X$h.seed):X$kp.scale(X$p,this.length*Math.random(),X$p),X$kp.add(X$m,X$p,X$m),this.randomDirection&&(X$h?(X$h.seed=X$P[17],X$r._randomPointUnitSphere(X$p,X$h),X$P[17]=X$h.seed):X$r._randomPointUnitSphere(X$p));break;default:throw new Error("ConeShape:emitType is invalid.")}},X$m.cloneTo=function(X$m){X$h.prototype.cloneTo.call(this,X$m);var X$p=X$m;X$p.angle=this.angle,X$p.radius=this.radius,X$p.length=this.length,X$p.emitType=this.emitType,X$p.randomDirection=this.randomDirection},X$F(X$R,["_tempPositionPoint",function(){return this._tempPositionPoint=new X$qp},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new X$qp}])}(X$w),function(X$h){function X$m(){this.radius=NaN,this.emitFromShell=!1,X$m.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}X$$(X$m,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",X$h);var X$p=X$m.prototype;X$p._getShapeBoundBox=function(X$m){var X$p=X$m.min.elements;X$p[0]=X$p[1]=X$p[2]=-this.radius;var X$h=X$m.max.elements;X$h[0]=X$h[1]=this.radius,X$h[2]=0},X$p._getSpeedBoundBox=function(X$m){var X$p=X$m.min.elements;X$p[0]=X$p[1]=-1,X$p[2]=0;var X$h=X$m.max.elements;X$h[0]=X$h[1]=X$h[2]=1},X$p.generatePositionAndDirection=function(X$m,X$p,X$h,X$P){var X$L=X$m.elements;X$h?(X$h.seed=X$P[16],this.emitFromShell?X$r._randomPointUnitSphere(X$m,X$h):X$r._randomPointInsideUnitSphere(X$m,X$h),X$P[16]=X$h.seed):this.emitFromShell?X$r._randomPointUnitSphere(X$m):X$r._randomPointInsideUnitSphere(X$m),X$kp.scale(X$m,this.radius,X$m);var X$q=X$L[2];X$q<0&&(X$L[2]=-1*X$q),this.randomDirection?X$h?(X$h.seed=X$P[17],X$r._randomPointUnitSphere(X$p,X$h),X$P[17]=X$h.seed):X$r._randomPointUnitSphere(X$p):X$m.cloneTo(X$p)},X$p.cloneTo=function(X$m){X$h.prototype.cloneTo.call(this,X$m);var X$p=X$m;X$p.radius=this.radius,X$p.emitFromShell=this.emitFromShell,X$p.randomDirection=this.randomDirection}}(X$w),function(X$h){function X$m(){this.radius=NaN,this.emitFromShell=!1,X$m.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}X$$(X$m,"laya.d3.core.particleShuriKen.module.shape.SphereShape",X$h);var X$p=X$m.prototype;X$p._getShapeBoundBox=function(X$m){var X$p=X$m.min.elements;X$p[0]=X$p[1]=X$p[2]=-this.radius;var X$h=X$m.max.elements;X$h[0]=X$h[1]=X$h[2]=this.radius},X$p._getSpeedBoundBox=function(X$m){var X$p=X$m.min.elements;X$p[0]=X$p[1]=X$p[2]=-1;var X$h=X$m.max.elements;X$h[0]=X$h[1]=X$h[2]=1},X$p.generatePositionAndDirection=function(X$m,X$p,X$h,X$P){X$h?(X$h.seed=X$P[16],this.emitFromShell?X$r._randomPointUnitSphere(X$m,X$h):X$r._randomPointInsideUnitSphere(X$m,X$h),X$P[16]=X$h.seed):this.emitFromShell?X$r._randomPointUnitSphere(X$m):X$r._randomPointInsideUnitSphere(X$m),X$kp.scale(X$m,this.radius,X$m),this.randomDirection?X$h?(X$h.seed=X$P[17],X$r._randomPointUnitSphere(X$p,X$h),X$P[17]=X$h.seed):X$r._randomPointUnitSphere(X$p):X$m.cloneTo(X$p)},X$p.cloneTo=function(X$m){X$h.prototype.cloneTo.call(this,X$m);var X$p=X$m;X$p.radius=this.radius,X$p.emitFromShell=this.emitFromShell,X$p.randomDirection=this.randomDirection}}(X$w),function(X$m){function X$p(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,X$p.__super.call(this)}return X$$(X$p,"laya.d3.core.render.SubMeshRenderElement",X$o),X$p}()),X$Ip=function(X$m){function X$n(X$m,X$p,X$h,X$P,X$L,X$q){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=X$m,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[X$$p.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[X$Vp.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[X$Vp.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[X$xp.SHADERDEFINE_ALPHATEST]="ALPHATEST";X$n.__super.call(this,X$m,X$p,X$h,null,{}),this._attributeMap=X$P;var X$k;for(X$k in X$L){var X$Y=X$L[X$k];switch(X$Y[1]){case 0:this._renderElementUniformMap[X$k]=X$Y[0];break;case 1:this._materialUniformMap[X$k]=X$Y[0];break;case 2:this._spriteUniformMap[X$k]=X$Y[0];break;case 3:this._cameraUniformMap[X$k]=X$Y[0];break;case 4:this._sceneUniformMap[X$k]=X$Y[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}X$$(X$n,"laya.d3.shader.ShaderCompile3D",X$a);var X$p=X$n.prototype;return X$p._definesToNameDic=function(X$m,X$p){for(var X$h={},X$P=1,X$L=0;X$L<32&&!(X$m<(X$P=1<<X$L));X$L++)if(X$m&X$P){var X$q=X$p[X$P];X$q&&(X$h[X$q]="")}return X$h},X$p.withCompile=function(X$m,X$p,X$h,X$P){var X$L,X$q,X$k;if(X$q=this.sharders[X$m])if(X$k=X$q[X$p]){if(X$L=X$k[X$h])return X$L}else X$k=X$q[X$p]=[];else X$k=(X$q=this.sharders[X$m]=[])[X$p]=[];var X$Y,X$d=this._definesToNameDic(X$m,X$n._globalInt2name),X$K=this._definesToNameDic(X$p,this._spriteInt2name),X$D=this._definesToNameDic(X$h,this._materialInt2name),X$F={},X$R="";if(X$d)for(X$Y in X$d)X$R+="#define "+X$Y+"\n",X$F[X$Y]=!0;if(X$K)for(X$Y in X$K)X$R+="#define "+X$Y+"\n",X$F[X$Y]=!0;if(X$D)for(X$Y in X$D)X$R+="#define "+X$Y+"\n",X$F[X$Y]=!0;var X$$=X$lp.nameKey.getName(this._name)+" compile ("+X$m+","+X$p+","+X$h+")",X$A=this._VS.toscript(X$F,[]),X$B=this._PS.toscript(X$F,[]);X$u.now();if(X$L=X$lp.create(X$R+X$A.join("\n"),X$R+X$B.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,X$P,X$$),X$k[X$h]=X$L,laya.d3.shader.ShaderCompile3D.debugMode)X$u.now();return X$L},X$p.precompileShaderWithShaderDefine=function(X$m,X$p,X$h){this.withCompile(X$m,X$p,X$h,!0)},X$p.addMaterialDefines=function(X$m){var X$p=X$m.defines;for(var X$h in X$p){var X$P=X$p[X$h],X$L=parseInt(X$h);this._materialInt2name[X$L]=X$P,this._materialName2Int[X$P]=X$L}},X$p.addSpriteDefines=function(X$m){var X$p=X$m.defines;for(var X$h in X$p){var X$P=X$p[X$h],X$L=parseInt(X$h);this._spriteInt2name[X$L]=X$P,this._spriteName2Int[X$P]=X$L}},X$p.getMaterialDefineByName=function(X$m){return this._materialName2Int[X$m]},X$p.registerMaterialDefine=function(X$m){var X$p=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[X$p]=X$m,this._materialName2Int[X$m]=X$p},X$p.registerSpriteDefine=function(X$m){var X$p=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[X$p]=X$m,this._spriteName2Int[X$m]=X$p},X$n._globalRegDefine=function(X$m,X$p){X$n._globalInt2name[X$p]=X$m},X$n.add=function(X$m,X$p,X$h,X$P,X$L){return laya.d3.shader.ShaderCompile3D._preCompileShader[X$m]=new X$n(X$m,X$p,X$h,X$P,X$L,X$a.includes)},X$n.get=function(X$m){return laya.d3.shader.ShaderCompile3D._preCompileShader[X$lp.nameKey.getID(X$m)]},X$n._preCompileShader={},X$n._globalInt2name=[],X$n.debugMode=!1,X$n.SHADERDEFINE_HIGHPRECISION=1,X$n.SHADERDEFINE_FOG=4,X$n.SHADERDEFINE_DIRECTIONLIGHT=8,X$n.SHADERDEFINE_POINTLIGHT=16,X$n.SHADERDEFINE_SPOTLIGHT=32,X$n.SHADERDEFINE_UV0=64,X$n.SHADERDEFINE_COLOR=128,X$n.SHADERDEFINE_UV1=256,X$n.SAHDERDEFINE_DEPTHFOG=131072,X$n}(),X$bp=function(X$m){function X$A(){X$A.__super.call(this)}X$$(X$A,"laya.d3.graphics.MeshSprite3DStaticBatchManager",X$Pm);var X$p=X$A.prototype;return X$p._getStaticBatch=function(X$m,X$p,X$h,X$P){var X$L,X$q;return X$q=X$m?X$m.id.toString()+X$h.id.toString()+X$p.id.toString()+X$P.toString():X$h.id.toString()+X$p.id.toString()+X$P.toString(),this._staticBatches[X$q]?X$L=this._staticBatches[X$q]:this._staticBatches[X$q]=X$L=new X$Tp(X$q,this,X$m,X$p,X$h),X$L},X$p._initStaticBatchs=function(X$m){var X$p,X$h;this._initBatchRenderElements.sort(X$A._sortPrepareStaticBatch);for(var X$P,X$L=!1,X$q=0,X$k=0,X$Y=this._initBatchRenderElements.length;X$k<X$Y;X$k++){var X$d,X$K=this._initBatchRenderElements[X$k],X$D=X$K.renderObj._getVertexBuffer(0);X$K._sprite3D;if(X$h===X$D.vertexDeclaration&&X$p===X$K._material)if(X$L)X$P._addCombineBatchRenderObjTest(X$K)?(X$d=X$K._staticBatch)!==X$P&&(X$d&&X$d._deleteCombineBatchRenderObj(X$K),X$P._addCombineBatchRenderObj(X$K)):(X$L=!1,X$q++);else{var X$F=this._initBatchRenderElements[X$k-1],X$R=X$F.renderObj,X$$=X$K.renderObj;X$L=!(65535<X$R._getVertexBuffer().vertexCount+X$$._getVertexBuffer().vertexCount)&&(X$P=this._getStaticBatch(X$m,X$h,X$p,X$q),(X$d=X$F._staticBatch)!==X$P&&(X$d&&X$d._deleteCombineBatchRenderObj(X$F),X$P._addCombineBatchRenderObj(X$F)),(X$d=X$K._staticBatch)!==X$P&&(X$d&&X$d._deleteCombineBatchRenderObj(X$K),X$P._addCombineBatchRenderObj(X$K)),!0)}else X$L=!1,X$q=0;X$p=X$K._material,X$h=X$D.vertexDeclaration}},X$A._sortPrepareStaticBatch=function(X$m,X$p){var X$h=X$m._render,X$P=X$p._render,X$L=X$h.lightmapIndex-X$P.lightmapIndex;if(0!=X$L)return X$L;var X$q=X$h.receiveShadow-X$P.receiveShadow;if(0!=X$q)return X$q;var X$k=X$m._mainSortID-X$p._mainSortID;return 0==X$k?X$m.renderObj.triangleCount-X$p.renderObj.triangleCount:X$k},X$A}(),X$Tp=function(X$m){function X$q(X$m,X$p,X$h,X$P,X$L){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,X$q.__super.call(this,X$m,X$p,X$h),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=X$P,this._material=X$L}X$$(X$q,"laya.d3.graphics.SubMeshStaticBatch",X$Lm);var X$p=X$q.prototype;return X$p._compareBatchRenderElement=function(X$m,X$p){return X$m._batchIndexStart>X$p._batchIndexStart},X$p._addCombineBatchRenderObjTest=function(X$m){var X$p=X$m.renderObj._vertexCount;return!(65535<(0<X$p?this._currentCombineVertexCount+X$p:this._currentCombineVertexCount+X$m.renderObj._getVertexBuffer().vertexCount))},X$p._addCombineBatchRenderObj=function(X$m){var X$p=X$m.renderObj,X$h=X$p._vertexCount;this._initBatchRenderElements.push(X$m),X$m._staticBatch=this,0<X$h?(this._currentCombineIndexCount+=X$p._indexCount,this._currentCombineVertexCount+=X$h):(this._currentCombineIndexCount=this._currentCombineIndexCount+X$p._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+X$p._getVertexBuffer().vertexCount),this._needFinishCombine=!0},X$p._deleteCombineBatchRenderObj=function(X$m){var X$p=X$m.renderObj,X$h=this._initBatchRenderElements.indexOf(X$m);if(-1!==X$h){this._initBatchRenderElements.splice(X$h,1),X$m._staticBatch=null;var X$P=X$p._vertexCount;0<X$P?(this._currentCombineIndexCount=this._currentCombineIndexCount-X$p._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-X$P):(this._currentCombineIndexCount=this._currentCombineIndexCount-X$p._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-X$p._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},X$p._finishInit=function(){if(this._needFinishCombine){var X$m=0,X$p=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var X$h=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),X$P=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=X$wp.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=X$zp.create("ushort",this._currentCombineIndexCount,35044);for(var X$L=0,X$q=this._initBatchRenderElements.length;X$L<X$q;X$L++){var X$k=this._initBatchRenderElements[X$L],X$Y=X$k.renderObj,X$d=X$Y._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,X$k._sprite3D),X$K=X$Y.getIndices(),X$D=X$k._sprite3D.transform._isFrontFaceInvert,X$F=X$m/(this._vertexDeclaration.vertexStride/4)-X$Y._vertexStart,X$R=X$p,X$$=X$R+X$K.length;X$k._batchIndexStart=X$R,X$k._batchIndexEnd=X$$,X$P.set(X$K,X$p);var X$A=0;if(X$D)for(X$A=X$R;X$A<X$$;X$A+=3){X$P[X$A]=X$F+X$P[X$A];var X$B=X$P[X$A+1],X$n=X$P[X$A+2];X$P[X$A+1]=X$F+X$n,X$P[X$A+2]=X$F+X$B}else for(X$A=X$R;X$A<X$$;X$A+=3)X$P[X$A]=X$F+X$P[X$A],X$P[X$A+1]=X$F+X$P[X$A+1],X$P[X$A+2]=X$F+X$P[X$A+2];X$p+=X$K.length,X$h.set(X$d,X$m),X$m+=X$d.length}this._vertexBuffer.setData(X$h),this._indexBuffer.setData(X$P),this._needFinishCombine=!1}},X$p._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new X$Ep)},X$p._getRenderElement=function(X$m,X$p,X$h){for(var X$P,X$L,X$q=this._batchRenderElements.length,X$k=!0,X$Y=0;X$Y<X$q;X$Y++){var X$d,X$K,X$D=(X$L=this._batchRenderElements[X$Y])._sprite3D._render;if(0!==X$Y&&(X$k=(X$d=(X$P=this._batchRenderElements[X$Y-1])._sprite3D._render).lightmapIndex!==X$D.lightmapIndex||X$d.receiveShadow!==X$D.receiveShadow||X$P._batchIndexEnd!==X$L._batchIndexStart),X$k){(X$K=this._getCombineRenderElementFromPool()).renderObj=this,X$K._material=this._material,X$K._batchIndexStart=X$L._batchIndexStart,X$K._batchIndexEnd=X$L._batchIndexEnd;var X$F=X$D.lightmapIndex,X$R=X$F+1,X$$=this._batchOwnerIndices[X$R];X$$||(X$$=this._batchOwnerIndices[X$R]=[]);var X$A,X$B=X$$[X$L._render.receiveShadow?1:0];void 0===X$B?(X$$[X$D.receiveShadow?1:0]=this._batchOwners.length,(X$A=new X$fp(null,"StaticBatchMeshSprite3D"))._scene=X$p,X$A._transform=this._rootOwner?this._rootOwner._transform:null,X$A._render.lightmapIndex=X$F,X$A._render.receiveShadow=X$L._render.receiveShadow,this._batchOwners.push(X$A)):X$A=this._batchOwners[X$B],X$A._render._renderUpdate(X$h),X$K._sprite3D=X$A,X$m.push(X$K)}else X$K._batchIndexEnd=X$L._batchIndexEnd}},X$p._beforeRender=function(X$m){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},X$p._render=function(X$m){var X$p=X$m.renderElement,X$h=X$p._batchIndexStart,X$P=X$p._batchIndexEnd-X$h;X$Q.mainContext.drawElements(4,X$P,5123,2*X$h),X$I.drawCall++,X$I.trianglesFaces+=X$P/3},X$p.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},X$p._getVertexBuffer=function(X$m){return void 0===X$m&&(X$m=0),this._vertexBuffer},X$q}(),X$jp=function(X$m){function X$p(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,X$p.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}X$$(X$p,"laya.d3.core.ComponentNode",X$K);var X$h=X$p.prototype;return X$h.addComponent=function(X$m){var X$p,X$h=this._componentsMap.indexOf(X$m);if(-1===X$h)X$p=[],this._componentsMap.push(X$m),this._typeComponentsIndices.push(X$p);else if(X$p=this._typeComponentsIndices[X$h],this._components[X$p[0]].isSingleton)throw new Error("无法单实例创建"+X$m+"组件，"+X$m+"组件已存在！");var X$P=X$L.getInstance(X$m);return X$p.push(this._components.length),this._components.push(X$P),X$P instanceof laya.d3.component.Script&&this._scripts.push(X$P),X$P._initialize(this),X$P},X$h._removeComponent=function(X$m,X$p){var X$h=this._typeComponentsIndices[X$m],X$P=X$h[X$p],X$L=this._components[X$P];this._components.splice(X$P,1),X$L instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(X$L),1),X$h.splice(X$p,1),0===X$h.length&&(this._typeComponentsIndices.splice(X$m,1),this._componentsMap.splice(X$m,1));for(var X$q=0,X$k=this._componentsMap.length;X$q<X$k;X$q++)for(var X$Y=(X$h=this._typeComponentsIndices[X$q]).length-1;0<=X$Y;X$Y--){var X$d=X$h[X$Y];if(!(X$P<X$d))break;X$h[X$Y]=--X$d}X$L._destroy()},X$h.getComponentByType=function(X$m,X$p){void 0===X$p&&(X$p=0);var X$h=this._componentsMap.indexOf(X$m);return-1===X$h?null:this._components[this._typeComponentsIndices[X$h][X$p]]},X$h.getComponentsByType=function(X$m,X$p){var X$h=this._componentsMap.indexOf(X$m);if(-1!==X$h){var X$P=this._typeComponentsIndices[X$h],X$L=X$P.length;X$p.length=X$L;for(var X$q=0;X$q<X$L;X$q++)X$p[X$q]=this._components[X$P[X$q]]}else X$p.length=0},X$h.getComponentByIndex=function(X$m){return this._components[X$m]},X$h.removeComponentByType=function(X$m,X$p){void 0===X$p&&(X$p=0);var X$h=this._componentsMap.indexOf(X$m);-1!==X$h&&this._removeComponent(X$h,X$p)},X$h.removeComponentsByType=function(X$m){var X$p=this._componentsMap.indexOf(X$m);if(-1!==X$p)for(var X$h=this._typeComponentsIndices[X$p],X$P=0,X$L=X$h.length;X$P<X$L;X$h.length<X$L?X$L--:X$P++)this._removeComponent(X$p,X$P)},X$h.removeAllComponent=function(){for(var X$m=0,X$p=this._componentsMap.length;X$m<X$p;this._componentsMap.length<X$p?X$p--:X$m++)this.removeComponentsByType(this._componentsMap[X$m])},X$h._updateComponents=function(X$m){for(var X$p=0,X$h=this._components.length;X$p<X$h;X$p++){var X$P=this._components[X$p];!X$P.started&&(X$P._start(X$m),X$P.started=!0),X$P.enable&&X$P._update(X$m)}},X$h._lateUpdateComponents=function(X$m){for(var X$p=0;X$p<this._components.length;X$p++){var X$h=this._components[X$p];!X$h.started&&(X$h._start(X$m),X$h.started=!0),X$h.enable&&X$h._lateUpdate(X$m)}},X$h._preRenderUpdateComponents=function(X$m){for(var X$p=0;X$p<this._components.length;X$p++){var X$h=this._components[X$p];!X$h.started&&(X$h._start(X$m),X$h.started=!0),X$h.enable&&X$h._preRenderUpdate(X$m)}},X$h._postRenderUpdateComponents=function(X$m){for(var X$p=0;X$p<this._components.length;X$p++){var X$h=this._components[X$p];!X$h.started&&(X$h._start(X$m),X$h.started=!0),X$h.enable&&X$h._postRenderUpdate(X$m)}},X$p}(),X$xp=function(X$P){function X$m(){X$m.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new X$Rp,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new X$Yp(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}X$$(X$m,"laya.d3.core.material.BaseMaterial",X$P);var X$p=X$m.prototype;return X$H.imps(X$p,{"laya.d3.core.IClone":!0}),X$p._addShaderDefine=function(X$m){this._shaderDefineValue|=X$m},X$p._removeShaderDefine=function(X$m){this._shaderDefineValue&=~X$m},X$p._addDisablePublicShaderDefine=function(X$m){this._disablePublicShaderDefine|=X$m},X$p._removeDisablePublicShaderDefine=function(X$m){this._disablePublicShaderDefine&=~X$m},X$p._setBuffer=function(X$m,X$p){this._shaderValues.setValue(X$m,X$p),this._values[X$m]=X$p},X$p._getBuffer=function(X$m){return this._values[X$m]},X$p._setMatrix4x4=function(X$m,X$p){this._shaderValues.setValue(X$m,X$p?X$p.elements:null),this._values[X$m]=X$p},X$p._getMatrix4x4=function(X$m){return this._values[X$m]},X$p._setInt=function(X$m,X$p){this._shaderValues.setValue(X$m,X$p),this._values[X$m]=X$p},X$p._getInt=function(X$m){return this._values[X$m]},X$p._setNumber=function(X$m,X$p){this._shaderValues.setValue(X$m,X$p),this._values[X$m]=X$p},X$p._getNumber=function(X$m){return this._values[X$m]},X$p._setBool=function(X$m,X$p){this._shaderValues.setValue(X$m,X$p),this._values[X$m]=X$p},X$p._getBool=function(X$m){return this._values[X$m]},X$p._setVector2=function(X$m,X$p){this._shaderValues.setValue(X$m,X$p?X$p.elements:null),this._values[X$m]=X$p},X$p._getVector2=function(X$m){return this._values[X$m]},X$p._setColor=function(X$m,X$p){this._shaderValues.setValue(X$m,X$p?X$p.elements:null),this._values[X$m]=X$p},X$p._getColor=function(X$m){return this._values[X$m]},X$p._setTexture=function(X$m,X$p){var X$h=this._values[X$m];this._values[X$m]=X$p,this._shaderValues.setValue(X$m,X$p),0<this.referenceCount&&(X$h&&X$h._removeReference(),X$p&&X$p._addReference())},X$p._getTexture=function(X$m){return this._values[X$m]},X$p._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},X$p._getShader=function(X$m,X$p,X$h){var X$P=(X$m|X$p)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(X$P,X$h,this._shaderDefineValue),this._shader},X$p._setRenderStateBlendDepth=function(){var X$m=X$Q.mainContext;switch(X$M.setDepthMask(X$m,this.depthWrite),0===this.depthTest?X$M.setDepthTest(X$m,!1):(X$M.setDepthTest(X$m,!0),X$M.setDepthFunc(X$m,this.depthTest)),this.blend){case 0:X$M.setBlend(X$m,!1);break;case 1:X$M.setBlend(X$m,!0),X$M.setBlendFunc(X$m,this.srcBlend,this.dstBlend);break;case 2:X$M.setBlend(X$m,!0)}},X$p._setRenderStateFrontFace=function(X$m,X$p){var X$h=X$Q.mainContext,X$P=0;switch(this.cull){case 0:X$M.setCullFace(X$h,!1);break;case 1:X$M.setCullFace(X$h,!0),X$P=X$m?X$p&&X$p._isFrontFaceInvert?2305:2304:X$p&&X$p._isFrontFaceInvert?2304:2305,X$M.setFrontFace(X$h,X$P);break;case 2:X$M.setCullFace(X$h,!0),X$P=X$m?X$p&&X$p._isFrontFaceInvert?2304:2305:X$p&&X$p._isFrontFaceInvert?2305:2304,X$M.setFrontFace(X$h,X$P)}},X$p.onAsynLoaded=function(X$m,X$p,X$h){var X$P=X$p[0],X$L=X$p[1];switch(X$P.version){case"LAYAMATERIAL:01":var X$q=0,X$k=0,X$Y=X$P.props;for(var X$d in X$Y)switch(X$d){case"vectors":var X$K=X$Y[X$d];for(X$q=0,X$k=X$K.length;X$q<X$k;X$q++){var X$D=X$K[X$q],X$F=X$D.value;switch(X$F.length){case 2:this[X$D.name]=new X$qp(X$F[0],X$F[1]);break;case 3:this[X$D.name]=new X$kp(X$F[0],X$F[1],X$F[2]);break;case 4:this[X$D.name]=new X$Yp(X$F[0],X$F[1],X$F[2],X$F[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var X$R=X$Y[X$d];for(X$q=0,X$k=X$R.length;X$q<X$k;X$q++){var X$$=X$R[X$q],X$A=X$$.path;X$A&&(this[X$$.name]=X$c.getRes(X$L[X$A]))}break;case"defines":var X$B=X$Y[X$d];for(X$q=0,X$k=X$B.length;X$q<X$k;X$q++){var X$n=this._shaderCompile.getMaterialDefineByName(X$B[X$q]);this._addShaderDefine(X$n)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[X$d]=X$Y[X$d];break;case"renderQueue":switch(X$Y[X$d]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[X$d]=X$Y[X$d]}break;case"LAYAMATERIAL:02":for(X$d in X$Y=X$P.props)switch(X$d){case"vectors":for(X$q=0,X$k=(X$K=X$Y[X$d]).length;X$q<X$k;X$q++)switch((X$F=(X$D=X$K[X$q]).value).length){case 2:this[X$D.name]=new X$qp(X$F[0],X$F[1]);break;case 3:this[X$D.name]=new X$kp(X$F[0],X$F[1],X$F[2]);break;case 4:this[X$D.name]=new X$Yp(X$F[0],X$F[1],X$F[2],X$F[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(X$q=0,X$k=(X$R=X$Y[X$d]).length;X$q<X$k;X$q++)(X$A=(X$$=X$R[X$q]).path)&&(this[X$$.name]=X$c.getRes(X$L[X$A]));break;case"defines":for(X$q=0,X$k=(X$B=X$Y[X$d]).length;X$q<X$k;X$q++)X$n=this._shaderCompile.getMaterialDefineByName(X$B[X$q]),this._addShaderDefine(X$n);break;default:this[X$d]=X$Y[X$d]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},X$p._addReference=function(){X$P.prototype._addReference.call(this);for(var X$m=0,X$p=this._values.length;X$m<X$p;X$m++){var X$h=this._values[X$m];X$h&&X$h instanceof laya.d3.resource.BaseTexture&&X$h._addReference()}},X$p._removeReference=function(){X$P.prototype._removeReference.call(this);for(var X$m=0,X$p=this._values.length;X$m<X$p;X$m++){var X$h=this._values[X$m];X$h&&X$h instanceof laya.d3.resource.BaseTexture&&X$h._removeReference()}},X$p.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},X$p.setShaderName=function(X$m){var X$p=X$lp.nameKey.getID(X$m);if(-1===X$p)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=X$Ip._preCompileShader[X$p]},X$p.cloneTo=function(X$m){var X$p=X$m;X$p.name=this.name,X$p.cull=this.cull,X$p.blend=this.blend,X$p.srcBlend=this.srcBlend,X$p.dstBlend=this.dstBlend,X$p.srcBlendRGB=this.srcBlendRGB,X$p.dstBlendRGB=this.dstBlendRGB,X$p.srcBlendAlpha=this.srcBlendAlpha,X$p.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(X$p.blendConstColor),X$p.blendEquation=this.blendEquation,X$p.blendEquationRGB=this.blendEquationRGB,X$p.blendEquationAlpha=this.blendEquationAlpha,X$p.depthTest=this.depthTest,X$p.depthWrite=this.depthWrite,X$p.renderQueue=this.renderQueue,X$p._shader=this._shader,X$p._disablePublicShaderDefine=this._disablePublicShaderDefine,X$p._shaderDefineValue=this._shaderDefineValue;var X$h,X$P=0,X$L=X$p._shaderValues;X$p._shaderValues.data.length=this._shaderValues.data.length;var X$q=this._values.length,X$k=X$p._values;for(X$P=0,X$h=X$k.length=X$q;X$P<X$h;X$P++){var X$Y=this._values[X$P];if(X$Y)if("number"==typeof X$Y)X$k[X$P]=X$Y,X$L.data[X$P]=X$Y;else if("number"==typeof X$Y&&Math.floor(X$Y)==X$Y)X$k[X$P]=X$Y,X$L.data[X$P]=X$Y;else if("boolean"==typeof X$Y)X$k[X$P]=X$Y,X$L.data[X$P]=X$Y;else if(X$Y instanceof laya.d3.math.Vector2){var X$d=X$k[X$P]||(X$k[X$P]=new X$qp);X$Y.cloneTo(X$d),X$L.data[X$P]=X$d.elements}else if(X$Y instanceof laya.d3.math.Vector3){var X$K=X$k[X$P]||(X$k[X$P]=new X$kp);X$Y.cloneTo(X$K),X$L.data[X$P]=X$K.elements}else if(X$Y instanceof laya.d3.math.Vector4){var X$D=X$k[X$P]||(X$k[X$P]=new X$Yp);X$Y.cloneTo(X$D),X$L.data[X$P]=X$D.elements}else if(X$Y instanceof laya.d3.math.Matrix4x4){var X$F=X$k[X$P]||(X$k[X$P]=new X$mp);X$Y.cloneTo(X$F),X$L.data[X$P]=X$F.elements}else X$Y instanceof laya.d3.resource.BaseTexture&&(X$k[X$P]=X$Y,X$L.data[X$P]=X$Y)}},X$p.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$A(0,X$p,"alphaTestValue",function(){return this._getNumber(0)},function(X$m){this._setNumber(0,X$m)}),X$A(0,X$p,"alphaTest",function(){return this._alphaTest},function(X$m){(this._alphaTest=X$m)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),X$m.__init__=function(){X$m.SHADERDEFINE_ALPHATEST=X$m.shaderDefines.registerDefine("ALPHATEST")},X$m.RENDERQUEUE_OPAQUE=2e3,X$m.RENDERQUEUE_ALPHATEST=2450,X$m.RENDERQUEUE_TRANSPARENT=3e3,X$m.CULL_NONE=0,X$m.CULL_FRONT=1,X$m.CULL_BACK=2,X$m.BLEND_DISABLE=0,X$m.BLEND_ENABLE_ALL=1,X$m.BLEND_ENABLE_SEPERATE=2,X$m.BLENDPARAM_ZERO=0,X$m.BLENDPARAM_ONE=1,X$m.BLENDPARAM_SRC_COLOR=768,X$m.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,X$m.BLENDPARAM_DST_COLOR=774,X$m.BLENDPARAM_ONE_MINUS_DST_COLOR=775,X$m.BLENDPARAM_SRC_ALPHA=770,X$m.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,X$m.BLENDPARAM_DST_ALPHA=772,X$m.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,X$m.BLENDPARAM_SRC_ALPHA_SATURATE=776,X$m.BLENDEQUATION_ADD=0,X$m.BLENDEQUATION_SUBTRACT=1,X$m.BLENDEQUATION_REVERSE_SUBTRACT=2,X$m.DEPTHTEST_OFF=0,X$m.DEPTHTEST_NEVER=512,X$m.DEPTHTEST_LESS=513,X$m.DEPTHTEST_EQUAL=514,X$m.DEPTHTEST_LEQUAL=515,X$m.DEPTHTEST_GREATER=516,X$m.DEPTHTEST_NOTEQUAL=517,X$m.DEPTHTEST_GEQUAL=518,X$m.DEPTHTEST_ALWAYS=519,X$m.SHADERDEFINE_ALPHATEST=1,X$m.ALPHATESTVALUE=0,X$F(X$m,["shaderDefines",function(){return this.shaderDefines=new X$Dp}]),X$m}(X$n),X$Qp=function(X$m){function X$p(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,X$p.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}X$$(X$p,"laya.d3.resource.BaseTexture",X$n);var X$h=X$p.prototype;return X$A(0,X$h,"width",function(){return this._width}),X$A(0,X$h,"repeat",function(){return this._repeat},function(X$m){if(this._repeat!==X$m&&(this._repeat=X$m,this._source)){var X$p=X$Q.mainContext;X$M.bindTexture(X$p,this._type,this._source),X$Z.isPOT(this._width,this._height)&&this._repeat?(X$p.texParameteri(this._type,10242,10497),X$p.texParameteri(this._type,10243,10497)):(X$p.texParameteri(this._type,10242,33071),X$p.texParameteri(this._type,10243,33071))}}),X$A(0,X$h,"height",function(){return this._height}),X$A(0,X$h,"magFifter",function(){return this._magFifter},function(X$m){(this._magFifter=X$m)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(X$m)}),X$A(0,X$h,"wrapModeV",function(){return this._wrapModeV}),X$A(0,X$h,"size",function(){return this._size}),X$A(0,X$h,"wrapModeU",function(){return this._wrapModeU}),X$A(0,X$h,"mipmap",function(){return this._mipmap},function(X$m){this._mipmap=X$m,this._mipmap!=X$m&&this._conchTexture&&this._conchTexture.setMipMap(X$m)}),X$A(0,X$h,"minFifter",function(){return this._minFifter},function(X$m){this._minFifter=X$m,this._minFifter!=X$m&&this._conchTexture&&this._conchTexture.setMinFifter(X$m)}),X$A(0,X$h,"format",function(){return this._format}),X$A(0,X$h,"source",function(){return this.activeResource(),this._source}),X$A(0,X$h,"defaulteTexture",function(){return X$Up.grayTexture}),X$p.WARPMODE_REPEAT=0,X$p.WARPMODE_CLAMP=1,X$p}(),X$Mp=function(X$m){function X$p(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,X$p.__super.call(this),this._boundingBoxCorners=X$P(8,null)}X$$(X$p,"laya.d3.resource.models.BaseMesh",X$n);var X$h=X$p.prototype;return X$h._getPositions=function(){throw new Error("未Override,请重载该属性！")},X$h._generateBoundingObject=function(){this._boundingSphere=new X$tm(new X$kp,0),X$tm.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new X$vm(new X$kp,new X$kp),X$vm.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},X$h.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},X$h.getRenderElement=function(X$m){throw new Error("未Override,请重载该属性！")},X$A(0,X$h,"subMeshCount",function(){return this._subMeshCount}),X$A(0,X$h,"boundingBox",function(){return this._boundingBox}),X$A(0,X$h,"boundingBoxCorners",function(){return this._boundingBoxCorners}),X$A(0,X$h,"boundingSphere",function(){return this._boundingSphere}),X$p}(),X$up=(function(X$m){function X$p(){X$p.__super.call(this)}X$$(X$p,"laya.d3.component.Script",X$ap);var X$h=X$p.prototype;X$h.onTriggerEnter=function(X$m){},X$h.onTriggerExit=function(X$m){},X$h.onTriggerStay=function(X$m){},X$A(0,X$h,"isSingleton",function(){return X$p._isSingleton}),X$p._isSingleton=!1}(),function(X$m){function X$p(X$m){this._owner=null,this._sharedMesh=null,X$p.__super.call(this),this._owner=X$m}X$$(X$p,"laya.d3.core.MeshFilter",X$m);var X$h=X$p.prototype;return X$h._sharedMeshLoaded=function(){this.event("loaded")},X$h._destroy=function(){X$m.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},X$A(0,X$h,"sharedMesh",function(){return this._sharedMesh},function(X$m){var X$p=this._sharedMesh;X$p&&X$p._removeReference(),(this._sharedMesh=X$m)._addReference(),this.event("meshchanged",[this,X$p,X$m]),X$m.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),X$A(0,X$h,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),X$A(0,X$h,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),X$A(0,X$h,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),X$A(0,X$h,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),X$p}(X$Zp)),X$Np=function(X$m){function X$p(X$m){X$p.__super.call(this,X$m),X$m.meshFilter.on("meshchanged",this,this._onMeshChanged)}X$$(X$p,"laya.d3.core.MeshRender",X$Hp);var X$h=X$p.prototype;return X$h._onMeshChanged=function(X$m,X$p,X$h){X$h.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:X$h.once("loaded",this,this._onMeshLoaed)},X$h._onMeshLoaed=function(X$m,X$p){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},X$h._calculateBoundingSphereByInitSphere=function(X$m){var X$p=NaN,X$h=this._owner.transform,X$P=X$h.scale.elements,X$L=Math.abs(X$P[0]),X$q=Math.abs(X$P[1]),X$k=Math.abs(X$P[2]);X$p=X$q<=X$L&&X$k<=X$L?X$L:X$k<=X$q?X$q:X$k,X$kp.transformCoordinate(X$m.center,X$h.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=X$m.radius*X$p},X$h._calculateBoundBoxByInitCorners=function(X$m){for(var X$p=this._owner.transform.worldMatrix,X$h=0;X$h<8;X$h++)X$kp.transformCoordinate(X$m[X$h],X$p,X$Hp._tempBoundBoxCorners[X$h]);X$vm.createfromPoints(X$Hp._tempBoundBoxCorners,this._boundingBox)},X$h._calculateBoundingSphere=function(){var X$m=this._owner.meshFilter.sharedMesh;null==X$m||null==X$m.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(X$m.boundingSphere)},X$h._calculateBoundingBox=function(){var X$m=this._owner.meshFilter.sharedMesh;null==X$m||null==X$m.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(X$m.boundingBoxCorners)},X$h._renderUpdate=function(X$m){var X$p=this._owner.transform;if(X$p){this._setShaderValueMatrix4x4(0,X$p.worldMatrix);var X$h=this._owner.getProjectionViewWorldMatrix(X$m);this._setShaderValueMatrix4x4(1,X$h)}else this._setShaderValueMatrix4x4(0,X$mp.DEFAULT),this._setShaderValueMatrix4x4(1,X$m);return X$cp.debugMode&&this._renderRenderableBoundBox(),!0},X$p}(),X$Sp=function(X$p){function X$P(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,X$P.__super.call(this),this._renderState=new X$i,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new X$Rp,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new X$pm,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new X$kp(.7,.7,.7),this.ambientColor=new X$kp(.212,.227,.259),X$Q.shaderHighPrecision&&this.addShaderDefine(X$Ip.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}X$$(X$P,"laya.d3.core.scene.Scene",X$p);var X$m=X$P.prototype;return X$H.imps(X$m,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),X$m._setUrl=function(X$m){this._url=X$m},X$m._getGroup=function(){return this._group},X$m._setGroup=function(X$m){this._group=X$m},X$m._display=function(){X$H.stage._scenes.push(this),X$H.stage._scenes.sort(X$P._sortScenes);for(var X$m=0,X$p=this._childs.length;X$m<X$p;X$m++){var X$h=this._childs[X$m];X$h.active&&X$h._activeHierarchy()}},X$m._unDisplay=function(){var X$m=X$H.stage._scenes;X$m.splice(X$m.indexOf(this),1);for(var X$p=0,X$h=this._childs.length;X$p<X$h;X$p++){var X$P=this._childs[X$p];X$P.active&&X$P._inActiveHierarchy()}},X$m._addChild3D=function(X$m){X$m.transform._onWorldTransform(),X$m._setBelongScene(this),this.displayedInStage&&X$m.active&&X$m._activeHierarchy()},X$m._removeChild3D=function(X$m){X$m.transform.parent=null,this.displayedInStage&&X$m.active&&X$m._inActiveHierarchy(),X$m._setUnBelongScene()},X$m.initOctree=function(X$m,X$p,X$h,X$P,X$L){void 0===X$L&&(X$L=6),this.treeSize=new X$kp(X$m,X$p,X$h),this.treeLevel=X$L,this.treeRoot=new X$v(this,0),this.treeRoot.init(X$P,this.treeSize)},X$m._prepareUpdateToRenderState=function(X$m,X$p){X$p.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,X$p.scene=this},X$m._prepareSceneToRender=function(X$m){var X$p=this._lights.length;if(0<X$p)for(var X$h=0,X$P=0;X$P<X$p&&!(this._lights[X$P]._prepareToScene(X$m)&&++X$h>=this._enableLightCount);X$P++);},X$m._updateChilds=function(X$m){for(var X$p=0,X$h=this._childs.length;X$p<X$h;++X$p)this._childs[X$p]._update(X$m)},X$m._preRenderScene=function(X$m,X$p,X$h){var X$P,X$L=X$p._viewMatrix,X$q=X$p._projectionMatrix,X$k=X$p._projectionViewMatrix,X$Y=0,X$d=X$p.camera;for(X$d.useOcclusionCulling?this.treeRoot?X$hm.renderObjectCullingOctree(X$h,this,X$d,X$L,X$q,X$k):X$hm.renderObjectCulling(X$h,this,X$d,X$L,X$q,X$k):X$hm.renderObjectCullingNoBoundFrustum(this,X$d,X$L,X$q,X$k),X$Y=0,X$P=this._quenes.length;X$Y<X$P;X$Y++)this._quenes[X$Y]&&this._quenes[X$Y]._preRender(X$p)},X$m._clear=function(X$m,X$p){var X$h=X$p._viewport,X$P=X$p.camera,X$L=X$h.x,X$q=X$P.renderTargetSize.height-X$h.y-X$h.height,X$k=X$h.width,X$Y=X$h.height;X$m.viewport(X$L,X$q,X$k,X$Y);var X$d=256,X$K=X$P.renderTarget;switch(X$P.clearFlag){case 0:var X$D=X$P.clearColor;if(X$D){X$m.enable(3089),X$m.scissor(X$L,X$q,X$k,X$Y);var X$F=X$D.elements;X$m.clearColor(X$F[0],X$F[1],X$F[2],X$F[3]),X$d|=16384}if(X$K)switch(X$D||(X$d=16384),X$K.depthStencilFormat){case 33189:X$d|=256;break;case 36168:X$d|=1024;break;case 34041:X$d|=256,X$d|=1024}X$m.clear(X$d),X$D&&X$m.disable(3089);break;case 1:case 2:if(X$K)switch(X$d=16384,X$K.depthStencilFormat){case 33189:X$d|=256;break;case 36168:X$d|=1024;break;case 34041:X$d|=256,X$d|=1024}X$m.clear(X$d);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},X$m._renderScene=function(X$m,X$p){var X$h,X$P,X$L=X$p.camera,X$q=0;for(X$q=0;X$q<2;X$q++)(X$P=this._quenes[X$q])&&(X$L.renderTarget?X$P._render(X$p,!0):X$P._render(X$p,!1));if(1===X$L.clearFlag){var X$k=X$L.sky;X$k&&(X$M.setCullFace(X$m,!1),X$M.setDepthFunc(X$m,515),X$M.setDepthMask(X$m,!1),X$k._render(X$p),X$M.setDepthFunc(X$m,513),X$M.setDepthMask(X$m,!0))}for(X$q=2,X$h=this._quenes.length;X$q<X$h;X$q++)(X$P=this._quenes[X$q])&&(X$P._sortAlpha(X$p.camera.transform.position),X$L.renderTarget?X$P._render(X$p,!0):X$P._render(X$p,!1))},X$m._set3DRenderConfig=function(X$m){X$m.disable(3042),X$M._blend=!1,X$m.blendFunc(770,771),X$M._sFactor=770,X$M._dFactor=771,X$m.disable(2929),X$M._depthTest=!1,X$m.enable(2884),X$M._cullFace=!0,X$m.depthMask(1),X$M._depthMask=!0,X$m.frontFace(2304),X$M._frontFace=2304},X$m._set2DRenderConfig=function(X$m){X$M.setBlend(X$m,!0),X$M.setBlendFunc(X$m,1,771),X$M.setDepthTest(X$m,!1),X$M.setCullFace(X$m,!1),X$M.setDepthMask(X$m,!0),X$M.setFrontFace(X$m,2305),X$m.viewport(0,0,X$D.width,X$D.height)},X$m._parseCustomProps=function(X$m,X$p,X$h,X$P){var X$L=X$P.customProps.lightmaps,X$q=X$L.length,X$k=this._lightmaps;X$k.length=X$q;for(var X$Y=0;X$Y<X$q;X$Y++)X$k[X$Y]=X$c.getRes(X$p[X$L[X$Y].replace(".exr",".png")]);this.setlightmaps(X$k);var X$d=X$P.customProps.ambientColor;X$d&&(this.ambientColor=new X$kp(X$d[0],X$d[1],X$d[2]));var X$K=X$P.customProps.fogColor;X$K&&(this.fogColor=new X$kp(X$K[0],X$K[1],X$K[2]))},X$m._addLight=function(X$m){this._lights.indexOf(X$m)<0&&this._lights.push(X$m)},X$m._removeLight=function(X$m){var X$p=this._lights.indexOf(X$m);0<=X$p&&this._lights.splice(X$p,1)},X$m._updateScene=function(){var X$m=this._renderState;this._prepareUpdateToRenderState(X$Q.mainContext,X$m),this._updateComponents(X$m),this._updateChilds(X$m),this._lateUpdateComponents(X$m),this._time+=X$m.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},X$m._updateSceneConch=function(){var X$m=this._renderState;this._prepareUpdateToRenderState(X$Q.mainContext,X$m),this._updateComponents(X$m),this._lateUpdateComponents(X$m),this._prepareSceneToRender(X$m);for(var X$p=0,X$h=this._cameraPool.length;X$p<X$h;X$p++){var X$P=this._cameraPool[X$p];(X$m.camera=X$P)._prepareCameraToRender()}},X$m._preRenderShadow=function(X$m,X$p,X$h,X$P,X$L){this.treeRoot?X$hm.renderShadowObjectCullingOctree(this,X$p,X$h,X$P,X$L):X$hm.renderShadowObjectCulling(this,X$p,X$h,X$P,X$L);for(var X$q=0,X$k=X$h.length;X$q<X$k;X$q++)X$h[X$q]&&X$h[X$q]._preRender(X$m)},X$m._renderShadowMap=function(X$m,X$p,X$h){var X$P=this.parallelSplitShadowMaps[0];X$P._calcAllLightCameraInfo(X$h);var X$L,X$q,X$k,X$Y=X$P.PSSMNum;if(this._preRenderShadow(X$p,X$P._lightCulling,X$P._shadowQuenes,X$P._lightVPMatrix[0],X$Y),this.addShaderDefine(X$$p.SHADERDEFINE_CAST_SHADOW),1<X$Y)for(var X$d=0;X$d<X$Y;X$d++)X$L=X$P.getRenderTarget(X$d+1),X$P.beginRenderTarget(X$d+1),X$m.clearColor(1,1,1,1),X$m.clear(16640),X$m.viewport(0,0,X$L.width,X$L.height),X$p.camera=X$k=X$P.getLightCamera(X$d),X$k._prepareCameraToRender(),X$k._prepareCameraViewProject(X$k.viewMatrix,X$k.projectionMatrix),X$p._projectionViewMatrix=X$P._lightVPMatrix[X$d+1],(X$q=X$P._shadowQuenes[X$d])._preRender(X$p),X$q._renderShadow(X$p,!1),X$P.endRenderTarget(X$d+1);else X$L=X$P.getRenderTarget(1),X$P.beginRenderTarget(1),X$m.clearColor(1,1,1,1),X$m.clear(16640),X$m.viewport(0,0,X$L.width,X$L.height),X$p.camera=X$k=X$P.getLightCamera(0),X$k._prepareCameraToRender(),X$k._prepareCameraViewProject(X$k.viewMatrix,X$k.projectionMatrix),X$p._projectionViewMatrix=X$P._lightVPMatrix[0],(X$q=X$P._shadowQuenes[0])._preRender(X$p),X$q._renderShadow(X$p,!0),X$P.endRenderTarget(1);this.removeShaderDefine(X$$p.SHADERDEFINE_CAST_SHADOW)},X$m.addTreeNode=function(X$m){this.treeRoot.addTreeNode(X$m)},X$m.removeTreeNode=function(X$m){this.treeSize&&X$m._treeNode&&X$m._treeNode.removeObject(X$m)},X$m.setlightmaps=function(X$m){this._lightmaps=X$m;for(var X$p=0,X$h=this._renderableSprite3Ds.length;X$p<X$h;X$p++)this._renderableSprite3Ds[X$p]._render._applyLightMapParams()},X$m.getlightmaps=function(){return this._lightmaps},X$m.addChildAt=function(X$m,X$p){if(!(X$m instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(X$m&&X$m.__className));if(!X$m||this.destroyed||X$m===this)return X$m;if(X$m.zOrder&&this._set$P("hasZorder",!0),0<=X$p&&X$p<=this._childs.length){if(X$m._parent===this){var X$h=this.getChildIndex(X$m);this._childs.splice(X$h,1),this._childs.splice(X$p,0,X$m),this.conchModel&&(this.conchModel.removeChild(X$m.conchModel),this.conchModel.addChildAt(X$m.conchModel,X$p)),this._childChanged()}else X$m.parent&&X$m.parent.removeChild(X$m),this._childs===X$K.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(X$p,0,X$m),this.conchModel&&this.conchModel.addChildAt(X$m.conchModel,X$p),(X$m.parent=this)._addChild3D(X$m);return X$m}throw new Error("appendChildAt:The index is out of bounds")},X$m.addChild=function(X$m){if(!(X$m instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!X$m||this.destroyed||X$m===this)return X$m;if(X$m.zOrder&&this._set$P("hasZorder",!0),X$m._parent===this){var X$p=this.getChildIndex(X$m);X$p!==this._childs.length-1&&(this._childs.splice(X$p,1),this._childs.push(X$m),this.conchModel&&(this.conchModel.removeChild(X$m.conchModel),this.conchModel.addChildAt(X$m.conchModel,this._childs.length-1)),this._childChanged())}else X$m.parent&&X$m.parent.removeChild(X$m),this._childs===X$K.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(X$m),this.conchModel&&this.conchModel.addChildAt(X$m.conchModel,this._childs.length-1),(X$m.parent=this)._childChanged(),this._addChild3D(X$m);return X$m},X$m.removeChildAt=function(X$m){var X$p=this.getChildAt(X$m);return X$p&&(this._removeChild3D(X$p),this._childs.splice(X$m,1),this.conchModel&&this.conchModel.removeChild(X$p.conchModel),X$p.parent=null),X$p},X$m.removeChildren=function(X$m,X$p){if(void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=2147483647),this._childs&&0<this._childs.length){var X$h=this._childs;if(0===X$m&&X$q<=X$p){var X$P=X$h;this._childs=X$K.ARRAY_EMPTY}else X$P=X$h.splice(X$m,X$p-X$m);for(var X$L=0,X$q=X$P.length;X$L<X$q;X$L++)this._removeChild3D(X$P[X$L]),X$P[X$L].parent=null,this.conchModel&&this.conchModel.removeChild(X$P[X$L].conchModel)}return this},X$m.addFrustumCullingObject=function(X$m){this.treeRoot?this.addTreeNode(X$m):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(X$m):this._cullingRenders[this._cullingRendersLength]=X$m,X$m._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},X$m.removeFrustumCullingObject=function(X$m){if(this.treeRoot)this.removeTreeNode(X$m);else{this._cullingRendersLength--;var X$p=X$m._indexInSceneFrustumCullingObjects;if(X$p!==this._cullingRendersLength){var X$h=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[X$p]=X$h)._indexInSceneFrustumCullingObjects=X$p,X$m._indexInSceneFrustumCullingObjects=-1}}},X$m.getRenderQueue=function(X$m){return X$m<3e3?this._quenes[1]||(this._quenes[1]=new X$f(this)):this._quenes[2]||(this._quenes[2]=new X$f(this))},X$m.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new X$f(this)},X$m.addShaderDefine=function(X$m){this._shaderDefineValue|=X$m},X$m.removeShaderDefine=function(X$m){this._shaderDefineValue&=~X$m},X$m.addScript=function(X$m){return this._addComponent(X$m)},X$m.getScriptByType=function(X$m,X$p){return void 0===X$p&&(X$p=0),this._getComponentByType(X$m,X$p)},X$m.getScriptsByType=function(X$m,X$p){this._getComponentsByType(X$m,X$p)},X$m.getScriptByIndex=function(X$m){return this._getComponentByIndex(X$m)},X$m.removeScriptByType=function(X$m,X$p){void 0===X$p&&(X$p=0),this._removeComponentByType(X$m,X$p)},X$m.removeScriptsByType=function(X$m){this._removeComponentByType(X$m)},X$m.removeAllScript=function(){this._removeAllComponent()},X$m.render=function(X$m,X$p,X$h){(X$B._context.ctx._renderKey=0)<this._childs.length&&X$m.addRenderObject(this)},X$m.renderSubmit=function(){var X$m=X$Q.mainContext,X$p=this._renderState;this._set3DRenderConfig(X$m),this._prepareSceneToRender(this._renderState);var X$h,X$P=0,X$L=0;if(X$cp.debugMode||X$v.debugMode)for(X$P=0,X$L=this._cameraPool.length;X$P<X$L;X$P++)X$h=this._cameraPool[X$P],X$cp._debugPhasorSprite.begin(1,X$h),X$h.activeInHierarchy&&X$h._renderCamera(X$m,X$p,this),X$cp._debugPhasorSprite.end();else for(X$P=0,X$L=this._cameraPool.length;X$P<X$L;X$P++)(X$h=this._cameraPool[X$P]).activeInHierarchy&&X$h._renderCamera(X$m,X$p,this);return this._set2DRenderConfig(X$m),1},X$m.onAsynLoaded=function(X$m,X$p,X$h){var X$P=X$p[0];if("Scene"!==X$P.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var X$L=X$p[1];X$np._createNodeByJson(this,X$P,this,X$L),this.event("hierarchyloaded",[this]),this.__loaded=!0},X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),this.destroyed||(X$p.prototype.destroy.call(this,X$m),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,X$c.clearRes(this.url),this.loaded||X$cp._cancelLoadByUrl(this.url))},X$m.getRenderType=function(){return 0},X$m.releaseRender=function(){},X$m._addComponent=function(X$m){var X$p,X$h=this._componentsMap.indexOf(X$m);if(-1===X$h)X$p=[],this._componentsMap.push(X$m),this._typeComponentsIndices.push(X$p);else if(X$p=this._typeComponentsIndices[X$h],this._components[X$p[0]].isSingleton)throw new Error("无法单实例创建"+X$m+"组件，"+X$m+"组件已存在！");var X$P=X$L.getInstance(X$m);X$p.push(this._components.length),this._components.push(X$P);return X$P._initialize(this),X$P},X$m._removeComponent=function(X$m,X$p){var X$h=this._typeComponentsIndices[X$m],X$P=X$h[X$p],X$L=this._components[X$P];this._components.splice(X$P,1),X$h.splice(X$p,1),0===X$h.length&&(this._typeComponentsIndices.splice(X$m,1),this._componentsMap.splice(X$m,1));for(var X$q=0,X$k=this._componentsMap.length;X$q<X$k;X$q++)for(var X$Y=(X$h=this._typeComponentsIndices[X$q]).length-1;0<=X$Y;X$Y--){var X$d=X$h[X$Y];if(!(X$P<X$d))break;X$h[X$Y]=--X$d}X$L._destroy()},X$m._getComponentByType=function(X$m,X$p){void 0===X$p&&(X$p=0);var X$h=this._componentsMap.indexOf(X$m);return-1===X$h?null:this._components[this._typeComponentsIndices[X$h][X$p]]},X$m._getComponentsByType=function(X$m,X$p){var X$h=this._componentsMap.indexOf(X$m);if(-1!==X$h){var X$P=this._typeComponentsIndices[X$h],X$L=X$P.length;X$p.length=X$L;for(var X$q=0;X$q<X$L;X$q++)X$p[X$q]=this._components[X$P[X$q]]}else X$p.length=0},X$m._getComponentByIndex=function(X$m){return this._components[X$m]},X$m._removeComponentByType=function(X$m,X$p){void 0===X$p&&(X$p=0);var X$h=this._componentsMap.indexOf(X$m);-1!==X$h&&this._removeComponent(X$h,X$p)},X$m._removeComponentsByType=function(X$m){var X$p=this._componentsMap.indexOf(X$m);if(-1!==X$p)for(var X$h=this._typeComponentsIndices[X$p],X$P=0,X$L=X$h.length;X$P<X$L;X$h.length<X$L?X$L--:X$P++)this._removeComponent(X$p,X$P)},X$m._removeAllComponent=function(){for(var X$m=0,X$p=this._componentsMap.length;X$m<X$p;this._componentsMap.length<X$p?X$p--:X$m++)this._removeComponentsByType(this._componentsMap[X$m])},X$m._updateComponents=function(X$m){for(var X$p=0,X$h=this._components.length;X$p<X$h;X$p++){var X$P=this._components[X$p];!X$P.started&&(X$P._start(X$m),X$P.started=!0),X$P.enable&&X$P._update(X$m)}},X$m._lateUpdateComponents=function(X$m){for(var X$p=0;X$p<this._components.length;X$p++){var X$h=this._components[X$p];!X$h.started&&(X$h._start(X$m),X$h.started=!0),X$h.enable&&X$h._lateUpdate(X$m)}},X$m._preRenderUpdateComponents=function(X$m){for(var X$p=0;X$p<this._components.length;X$p++){var X$h=this._components[X$p];!X$h.started&&(X$h._start(X$m),X$h.started=!0),X$h.enable&&X$h._preRenderUpdate(X$m)}},X$m._postRenderUpdateComponents=function(X$m){for(var X$p=0;X$p<this._components.length;X$p++){var X$h=this._components[X$p];!X$h.started&&(X$h._start(X$m),X$h.started=!0),X$h.enable&&X$h._postRenderUpdate(X$m)}},X$A(0,X$m,"_loaded",null,function(X$m){this.__loaded=X$m}),X$A(0,X$m,"fogColor",function(){return this._fogColor},function(X$m){this._fogColor=X$m,this._shaderValues.setValue(0,X$m.elements)}),X$A(0,X$m,"enableFog",function(){return this._enableFog},function(X$m){this._enableFog!==X$m&&((this._enableFog=X$m)?(this.addShaderDefine(X$Ip.SHADERDEFINE_FOG),this.removeShaderDefine(X$Ip.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(X$Ip.SHADERDEFINE_FOG))}),X$A(0,X$m,"url",function(){return this._url}),X$A(0,X$m,"loaded",function(){return this.__loaded}),X$A(0,X$m,"enableDepthFog",function(){return this._enableDepthFog},function(X$m){this._enableDepthFog!=X$m&&((this._enableDepthFog=X$m)?(this.addShaderDefine(X$Ip.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(X$Ip.SHADERDEFINE_FOG)):this.removeShaderDefine(X$Ip.SAHDERDEFINE_DEPTHFOG))}),X$A(0,X$m,"fogStart",function(){return this._fogStart},function(X$m){this._fogStart=X$m,this._shaderValues.setValue(1,X$m)}),X$A(0,X$m,"fogRange",function(){return this._fogRange},function(X$m){this._fogRange=X$m,this._shaderValues.setValue(2,X$m)}),X$A(0,X$m,"ambientColor",function(){return this._ambientColor},function(X$m){this._ambientColor=X$m,this._shaderValues.setValue(21,X$m.elements)}),X$A(0,X$m,"scene",function(){return this}),X$A(0,X$m,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),X$P._sortScenes=function(X$m,X$p){if(X$m.parent!==X$H.stage||X$p.parent!==X$H.stage)return X$m.parent!==X$H.stage&&X$p.parent!==X$H.stage?X$P._sortScenes(X$m.parent,X$p.parent):X$m.parent===X$H.stage?-1:1;var X$h=X$H.stage._childs;return X$h.indexOf(X$m)-X$h.indexOf(X$p)},X$P.load=function(X$m){return X$H.loader.create(X$m,null,null,X$P)},X$P.FOGCOLOR=0,X$P.FOGSTART=1,X$P.FOGRANGE=2,X$P.LIGHTDIRECTION=3,X$P.LIGHTDIRCOLOR=4,X$P.POINTLIGHTPOS=5,X$P.POINTLIGHTRANGE=6,X$P.POINTLIGHTATTENUATION=7,X$P.POINTLIGHTCOLOR=8,X$P.SPOTLIGHTPOS=9,X$P.SPOTLIGHTDIRECTION=10,X$P.SPOTLIGHTSPOT=11,X$P.SPOTLIGHTRANGE=12,X$P.SPOTLIGHTATTENUATION=13,X$P.SPOTLIGHTCOLOR=14,X$P.SHADOWDISTANCE=15,X$P.SHADOWLIGHTVIEWPROJECT=16,X$P.SHADOWMAPPCFOFFSET=17,X$P.SHADOWMAPTEXTURE1=18,X$P.SHADOWMAPTEXTURE2=19,X$P.SHADOWMAPTEXTURE3=20,X$P.AMBIENTCOLOR=21,X$P.TIME=22,X$P}(X$E),X$_p=function(X$m){function X$p(X$m){X$p.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new X$mp,this._shaderValues=new X$Rp,this._colliders=[],this._id=++X$p._uniqueIDCounter,this._transform=new X$Wp(this),this.name=X$m||"Sprite3D-"+X$p._nameNumberCounter++,this.layer=X$N.currentCreationLayer,this.active=!0}X$$(X$p,"laya.d3.core.Sprite3D",X$jp);var X$h=X$p.prototype;return X$H.imps(X$h,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),X$h._setUrl=function(X$m){this._url=X$m},X$h._getGroup=function(){return this._group},X$h._setGroup=function(X$m){this._group=X$m},X$h._addChild3D=function(X$m){X$m.transform.parent=this.transform,this._hierarchyAnimator&&(!X$m._hierarchyAnimator&&X$m._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(X$m,!0,[X$m.name])),this._scene&&(X$m._setBelongScene(this._scene),this._activeInHierarchy&&X$m._active&&X$m._activeHierarchy())},X$h._removeChild3D=function(X$m){X$m.transform.parent=null,this._scene&&(this._activeInHierarchy&&X$m._active&&X$m._inActiveHierarchy(),X$m._setUnBelongScene()),this._hierarchyAnimator&&(X$m._hierarchyAnimator==this._hierarchyAnimator&&X$m._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(X$m,!1,[X$m.name]))},X$h._parseBaseCustomProps=function(X$m){var X$p=this.transform.localPosition;X$m.translate?(X$p.fromArray(X$m.translate),X$p.x*=100,X$p.y*=100,X$p.z*=100):X$p.elements.fill(0),this.transform.localPosition=X$p;var X$h=this.transform.localRotation;X$m.rotation?X$h.fromArray(X$m.rotation):X$h.fromArray([0,0,0,-1]),this.transform.localRotation=X$h;var X$P=this.transform.localScale;X$m.scale?X$P.fromArray(X$m.scale):X$P.elements.fill(1),this.transform.localScale=X$P;var X$L=X$m.layer;null!=X$L&&(this.layer=X$N.getLayerByNumber(X$L))},X$h._parseCustomComponent=function(X$m,X$p,X$h){for(var X$P in X$h){var X$L=X$h[X$P];switch(X$P){case"Animator":var X$q=this.addComponent(Animator);if(X$L.avatarPath)X$q.avatar=X$c.getRes(X$p[X$L.avatarPath]);else{var X$k=X$L.avatar;if(X$k){X$q.avatar=X$c.getRes(X$p[X$k.path]);var X$Y=X$k.linkSprites;X$Y&&X$m.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[X$q,X$Y])}}for(var X$d=X$L.clipPaths,X$K=X$d.length,X$D=0;X$D<X$K;X$D++)X$q.addClip(X$c.getRes(X$p[X$d[X$D]]));X$q.clip=X$c.getRes(X$p[X$d[0]]);var X$F=X$L.playOnWake;void 0!==X$F&&(X$q.playOnWake=X$F);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var X$R=this.addComponent(SphereCollider);X$R.isTrigger=X$L.isTrigger;var X$$=X$R.center;X$$.fromArray(X$L.center),X$R.center=X$$,X$R.radius=X$L.radius;break;case"BoxCollider":var X$A=this.addComponent(BoxCollider);X$A.isTrigger=X$L.isTrigger,X$A.center.fromArray(X$L.center);var X$B=X$A.size;X$B.fromArray(X$L.size),X$A.size=X$B;break;case"MeshCollider":this.addComponent(MeshCollider)}}},X$h._onRootNodeHierarchyLoaded=function(X$m,X$p){for(var X$h in X$p){for(var X$P=this,X$L=X$p[X$h],X$q=0,X$k=X$L.length;X$q<X$k;X$q++){var X$Y=X$L[X$q];if(""===X$Y)break;if(!(X$P=X$P.getChildByName(X$Y)))break}X$P&&X$m.linkSprite3DToAvatarNode(X$h,X$P)}},X$h._setHierarchyAnimator=function(X$m,X$p){this._changeHierarchyAnimator(X$m);for(var X$h=0,X$P=this._childs.length;X$h<X$P;X$h++){var X$L=this._childs[X$h];X$L._hierarchyAnimator==X$p&&X$L._setHierarchyAnimator(X$m,X$p)}},X$h._clearHierarchyAnimator=function(X$m,X$p){this._changeHierarchyAnimator(X$p);for(var X$h=0,X$P=this._childs.length;X$h<X$P;X$h++){var X$L=this._childs[X$h];X$L._hierarchyAnimator==X$m&&X$L._clearHierarchyAnimator(X$m,X$p)}},X$h._getAnimatorToLinkSprite3D=function(X$m,X$p,X$h){var X$P=this.getComponentByType(Animator);if(X$P&&(X$P.avatar?X$P.avatar._version||X$m._setAnimatorToLinkAvatar(X$P,X$p):X$m._setAnimatorToLinkSprite3DNoAvatar(X$P,X$p,X$h)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){X$h.unshift(this._parent.name);var X$L=this._parent;X$L._hierarchyAnimator&&X$L._getAnimatorToLinkSprite3D(X$m,X$p,X$h)}},X$h._setAnimatorToLinkSprite3DNoAvatar=function(X$m,X$p,X$h){var X$P=0,X$L=0;for(X$P=0,X$L=X$m.getClipCount();X$P<X$L;X$P++)X$m._handleSpriteOwnersBySprite(X$P,X$p,X$h,this);for(X$P=0,X$L=this._childs.length;X$P<X$L;X$P++){var X$q=this._childs[X$P],X$k=X$h.length;X$h.push(X$q.name),X$q._setAnimatorToLinkSprite3DNoAvatar(X$m,X$p,X$h),X$h.splice(X$k,1)}},X$h._changeHierarchyAnimator=function(X$m){this._hierarchyAnimator=X$m},X$h._isLinkSpriteToAnimationNode=function(X$m,X$p,X$h){var X$P=X$m._avatarNodes.indexOf(X$p),X$L=X$m._cacheSpriteToNodesMap;if(X$h)this._transform.dummy=X$p.transform,X$m._cacheNodesToSpriteMap[X$P]=X$L.length,X$L.push(X$P);else{this._transform.dummy=null;var X$q=X$m._cacheNodesToSpriteMap[X$P];X$m._cacheNodesToSpriteMap[X$P]=null,X$L.splice(X$q,1)}},X$h._setBelongScene=function(X$m){this._scene=X$m;for(var X$p=0,X$h=this._childs.length;X$p<X$h;X$p++)this._childs[X$p]._setBelongScene(X$m)},X$h._setUnBelongScene=function(){this._scene=null;for(var X$m=0,X$p=this._childs.length;X$m<X$p;X$m++)this._childs[X$m]._setUnBelongScene()},X$h._activeHierarchy=function(){var X$m=0,X$p=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),X$m=0,X$p=this._colliders.length;X$m<X$p;X$m++)this._layer._addCollider(this._colliders[X$m]);for(this.event("activeinhierarchychanged",!0),X$m=0,X$p=this._childs.length;X$m<X$p;X$m++){var X$h=this._childs[X$m];X$h._active&&X$h._activeHierarchy()}},X$h._inActiveHierarchy=function(){var X$m=0,X$p=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),X$m=0,X$p=this._colliders.length;X$m<X$p;X$m++){var X$h=this._colliders[X$m];X$h._clearCollsionMap(),this._layer._removeCollider(X$h)}for(this.event("activeinhierarchychanged",!1),X$m=0,X$p=this._childs.length;X$m<X$p;X$m++){var X$P=this._childs[X$m];X$P._active&&X$P._inActiveHierarchy()}},X$h.addComponent=function(X$m){var X$p,X$h=this._componentsMap.indexOf(X$m);if(-1===X$h)X$p=[],this._componentsMap.push(X$m),this._typeComponentsIndices.push(X$p);else if(X$p=this._typeComponentsIndices[X$h],this._components[X$p[0]].isSingleton)throw new Error("无法单实例创建"+X$m+"组件，"+X$m+"组件已存在！");var X$P=X$L.getInstance(X$m);return X$p.push(this._components.length),this._components.push(X$P),X$P instanceof laya.d3.component.Script&&this._scripts.push(X$P),X$P._initialize(this),X$P},X$h._removeComponent=function(X$m,X$p){var X$h,X$P=0,X$L=this._typeComponentsIndices[X$m],X$q=X$L[X$p],X$k=this._components[X$q];for(X$k instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(X$k),1),X$L.splice(X$p,1),0===X$L.length&&(this._typeComponentsIndices.splice(X$m,1),this._componentsMap.splice(X$m,1)),X$P=0,X$h=this._componentsMap.length;X$P<X$h;X$P++)for(var X$Y=(X$L=this._typeComponentsIndices[X$P]).length-1;0<=X$Y;X$Y--){var X$d=X$L[X$Y];if(!(X$q<X$d))break;X$L[X$Y]=--X$d}X$k._destroy()},X$h._clearSelfRenderObjects=function(){},X$h._addSelfRenderObjects=function(){},X$h._parseCustomProps=function(X$m,X$p,X$h,X$P){},X$h._updateChilds=function(X$m){var X$p=this._childs.length;if(0!==X$p)for(var X$h=0;X$h<X$p;++X$h)this._childs[X$h]._update(X$m)},X$h._getSortID=function(X$m,X$p){return 1e3*X$p.id+X$m._getVertexBuffer().vertexDeclaration.id},X$h._update=function(X$m){(X$m.owner=this)._activeInHierarchy&&(this._updateComponents(X$m),this._lateUpdateComponents(X$m),X$I.spriteCount++,this._childs.length&&this._updateChilds(X$m))},X$h.getProjectionViewWorldMatrix=function(X$m){return X$mp.multiply(X$m,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},X$h.loadHierarchy=function(X$m){this.addChild(laya.d3.core.Sprite3D.load(X$m))},X$h.addChildAt=function(X$m,X$p){if(!(X$m instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!X$m||this.destroyed||X$m===this)return X$m;if(X$m.zOrder&&this._set$P("hasZorder",!0),0<=X$p&&X$p<=this._childs.length){if(X$m._parent===this){var X$h=this.getChildIndex(X$m);this._childs.splice(X$h,1),this._childs.splice(X$p,0,X$m),this.conchModel&&(this.conchModel.removeChild(X$m.conchModel),this.conchModel.addChildAt(X$m.conchModel,X$p)),this._childChanged()}else X$m.parent&&X$m.parent.removeChild(X$m),this._childs===X$K.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(X$p,0,X$m),this.conchModel&&this.conchModel.addChildAt(X$m.conchModel,X$p),(X$m.parent=this)._addChild3D(X$m);return X$m}throw new Error("appendChildAt:The index is out of bounds")},X$h.addChild=function(X$m){if(!(X$m instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!X$m||this.destroyed||X$m===this)return X$m;if(X$m.zOrder&&this._set$P("hasZorder",!0),X$m._parent===this){var X$p=this.getChildIndex(X$m);X$p!==this._childs.length-1&&(this._childs.splice(X$p,1),this._childs.push(X$m),this.conchModel&&(this.conchModel.removeChild(X$m.conchModel),this.conchModel.addChildAt(X$m.conchModel,this._childs.length-1)),this._childChanged())}else X$m.parent&&X$m.parent.removeChild(X$m),this._childs===X$K.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(X$m),this.conchModel&&this.conchModel.addChildAt(X$m.conchModel,this._childs.length-1),(X$m.parent=this)._childChanged(),this._addChild3D(X$m);return X$m},X$h.removeChildAt=function(X$m){var X$p=this.getChildAt(X$m);return X$p&&(this._removeChild3D(X$p),this._childs.splice(X$m,1),this.conchModel&&this.conchModel.removeChild(X$p.conchModel),X$p.parent=null),X$p},X$h.removeChildren=function(X$m,X$p){if(void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=2147483647),this._childs&&0<this._childs.length){var X$h=this._childs;if(0===X$m&&X$q<=X$p){var X$P=X$h;this._childs=X$K.ARRAY_EMPTY}else X$P=X$h.splice(X$m,X$p-X$m);for(var X$L=0,X$q=X$P.length;X$L<X$q;X$L++)this._removeChild3D(X$P[X$L]),X$P[X$L].parent=null,this.conchModel&&this.conchModel.removeChild(X$P[X$L].conchModel)}return this},X$h.onAsynLoaded=function(X$m,X$p,X$h){var X$P=X$p[0];if("Sprite3D"!==X$P.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var X$L=X$p[1];X$np._createNodeByJson(this,X$P,this,X$L),this.event("hierarchyloaded",[this]),this.__loaded=!0},X$h.cloneTo=function(X$m){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var X$p=X$m;X$p.name=this.name,X$p._destroyed=this._destroyed,X$p.timer=this.timer,X$p._$P=this._$P,X$p.active=this._active;var X$h=X$p.transform.localPosition;this.transform.localPosition.cloneTo(X$h),X$p.transform.localPosition=X$h;var X$P=X$p.transform.localRotation;this.transform.localRotation.cloneTo(X$P),X$p.transform.localRotation=X$P;var X$L=X$p.transform.localScale;this.transform.localScale.cloneTo(X$L),X$p.transform.localScale=X$L,X$p.isStatic=this.isStatic;var X$q=0,X$k=0;for(X$q=0,X$k=this._componentsMap.length;X$q<X$k;X$q++){var X$Y=X$p.addComponent(this._componentsMap[X$q]);this._components[X$q]._cloneTo(X$Y)}for(X$q=0,X$k=this._childs.length;X$q<X$k;X$q++)X$p.addChild(this._childs[X$q].clone());var X$d=X$p.getComponentByType(Animator);if(X$d){var X$K=X$d._linkSpritesData;if(X$K)for(var X$D in X$K){for(var X$F=X$K[X$D],X$R=X$p,X$$=0,X$A=X$F.length;X$$<X$A&&(X$R=X$R.getChildByName(X$F[X$$]));X$$++);if(X$R){var X$B=X$d._avatarNodeMap[X$D];X$R._isLinkSpriteToAnimationNode(X$d,X$B,!0)}}}},X$h.clone=function(){var X$m=new this.constructor;return this.cloneTo(X$m),X$m},X$h.destroy=function(X$m){if(void 0===X$m&&(X$m=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,X$m);var X$p,X$h=0;for(X$h=0,X$p=this._components.length;X$h<X$p;X$h++)this._components[X$h]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,X$c.clearRes(this.url),this.loaded||X$cp._cancelLoadByUrl(this.url)}},X$h._handleSpriteToAvatar=function(X$m,X$p){X$m._avatarNodes;var X$h=X$m._avatarNodeMap[this.name];X$h&&X$h.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(X$m,X$h,X$p)},X$h._setAnimatorToLinkAvatar=function(X$m,X$p){this._handleSpriteToAvatar(X$m,X$p);for(var X$h=0,X$P=this._childs.length;X$h<X$P;X$h++){this._childs[X$h]._setAnimatorToLinkAvatar(X$m,X$p)}},X$A(0,X$h,"activeInHierarchy",function(){return this._activeInHierarchy}),X$A(0,X$h,"_loaded",null,function(X$m){this.__loaded=X$m}),X$A(0,X$h,"active",function(){return this._active},function(X$m){this._active!==X$m&&(this._active=X$m,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(X$m?this._activeHierarchy():this._inActiveHierarchy()))}),X$A(0,X$h,"componentsCount",function(){return this._components.length}),X$A(0,X$h,"loaded",function(){return this.__loaded}),X$A(0,X$h,"id",function(){return this._id}),X$A(0,X$h,"url",function(){return this._url}),X$A(0,X$h,"layer",function(){return this._layer},function(X$m){if(this._layer!==X$m){if(!X$m)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var X$p=0,X$h=this._colliders.length;if(this._layer)for(X$p=0;X$p<X$h;X$p++)this._layer._removeCollider(this._colliders[X$p]);for(X$p=0;X$p<X$h;X$p++)X$m._addCollider(this._colliders[X$p])}this._layer=X$m,this.event("layerchanged",X$m)}}),X$A(0,X$h,"scene",function(){return this._scene}),X$A(0,X$h,"transform",function(){return this._transform}),X$p.instantiate=function(X$m,X$p,X$h,X$P,X$L){void 0===X$h&&(X$h=!0);var X$q=X$m.clone();X$p&&X$p.addChild(X$q);var X$k=X$q.transform;if(X$h){var X$Y=X$k.worldMatrix;X$m.transform.worldMatrix.cloneTo(X$Y),X$k.worldMatrix=X$Y}else X$P&&(X$k.position=X$P),X$L&&(X$k.rotation=X$L);return X$q},X$p.load=function(X$m){return X$H.loader.create(X$m,null,null,X$p)},X$p.WORLDMATRIX=0,X$p.MVPMATRIX=1,X$p._uniqueIDCounter=0,X$p._nameNumberCounter=0,X$p}(),X$lp=function(X$m){function X$D(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],X$D.__super.call(this),!X$m||!X$p)throw"Shader Error";this._id=++X$D._count,this._vs=X$m,this._ps=X$p,this._attributeMap=X$h,this._sceneUniformMap=X$P,this._cameraUniformMap=X$L,this._spriteUniformMap=X$q,this._materialUniformMap=X$k,this._renderElementUniformMap=X$Y,this._precompile=X$d,this._define=X$K,this._precompile&&X$D.extCompileObj&&X$D.extCompileFunc?X$D.extCompileFunc.call(X$D.extCompileObj,X$m,X$p,X$K):this.recreateResource()}X$$(X$D,"laya.d3.shader.Shader3D",X$h);var X$p=X$D.prototype;return X$p.recreateResource=function(){X$u.now();this._compile(),this.completeCreate(),this.memorySize=0},X$p.disposeResource=function(){X$Q.mainContext.deleteShader(this._vshader),X$Q.mainContext.deleteShader(this._pshader),X$Q.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},X$p._compile=function(){if(!X$Q.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var X$m=[this._vs,this._ps],X$p=X$Q.mainContext;if(this._program=X$p.createProgram(),this._vshader=X$D._createShader(X$p,X$m[0],35633),this._pshader=X$D._createShader(X$p,X$m[1],35632),X$p.attachShader(this._program,this._vshader),X$p.attachShader(this._program,this._pshader),X$p.linkProgram(this._program),!X$B.isConchApp&&X$Ip.debugMode&&!X$p.getProgramParameter(this._program,35714))throw X$p.getProgramInfoLog(this._program);var X$h,X$P=0,X$L=0,X$q=0;for(X$q=X$B.isConchApp?X$p.getProgramParameterEx(this._vs,this._ps,"",35721):X$p.getProgramParameter(this._program,35721),X$P=0;X$P<X$q;X$P++){var X$k=null;X$h={vartype:"attribute",ivartype:0,attrib:X$k=X$B.isConchApp?X$p.getActiveAttribEx(this._vs,this._ps,"",X$P):X$p.getActiveAttrib(this._program,X$P),location:X$p.getAttribLocation(this._program,X$k.name),name:X$k.name,type:X$k.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(X$h)}var X$Y=0;for(X$Y=X$B.isConchApp?X$p.getProgramParameterEx(this._vs,this._ps,"",35718):X$p.getProgramParameter(this._program,35718),X$P=0;X$P<X$Y;X$P++){var X$d=null;X$d=X$B.isConchApp?X$p.getActiveUniformEx(this._vs,this._ps,"",X$P):X$p.getActiveUniform(this._program,X$P),0<(X$h={vartype:"uniform",ivartype:1,attrib:X$k,location:X$p.getUniformLocation(this._program,X$d.name),name:X$d.name,type:X$d.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(X$h.name=X$h.name.substr(0,X$h.name.length-3),X$h.isArray=!0,X$h.location=X$p.getUniformLocation(this._program,X$h.name)),this._uniformParams.push(X$h)}for(X$P=0,X$L=this._attributeParams.length;X$P<X$L;X$P++)(X$h=this._attributeParams[X$P]).indexOfParams=X$P,X$h.index=1,X$h.value=[X$h.location,null],X$h.codename=X$h.name,X$h.name=null!=this._attributeMap[X$h.codename]?this._attributeMap[X$h.codename]:X$h.codename,this._attributeParamsMap.push(X$h.name),this._attributeParamsMap.push(X$h),X$h._this=this,X$h.uploadedValue=[],X$h.fun=this._attribute;for(X$P=0,X$L=this._uniformParams.length;X$P<X$L;X$P++)switch((X$h=this._uniformParams[X$P]).indexOfParams=X$P,X$h.index=1,X$h.value=[X$h.location,null],X$h.codename=X$h.name,null!=this._sceneUniformMap[X$h.codename]?(X$h.name=this._sceneUniformMap[X$h.codename],this._sceneUniformParamsMap.push(X$h.name),this._sceneUniformParamsMap.push(X$h)):null!=this._cameraUniformMap[X$h.codename]?(X$h.name=this._cameraUniformMap[X$h.codename],this._cameraUniformParamsMap.push(X$h.name),this._cameraUniformParamsMap.push(X$h)):null!=this._spriteUniformMap[X$h.codename]?(X$h.name=this._spriteUniformMap[X$h.codename],this._spriteUniformParamsMap.push(X$h.name),this._spriteUniformParamsMap.push(X$h)):null!=this._materialUniformMap[X$h.codename]?(X$h.name=this._materialUniformMap[X$h.codename],this._materialUniformParamsMap.push(X$h.name),this._materialUniformParamsMap.push(X$h)):null!=this._renderElementUniformMap[X$h.codename]?(X$h.name=this._renderElementUniformMap[X$h.codename],this._renderElementUniformParamsMap.push(X$h.name),this._renderElementUniformParamsMap.push(X$h)):console.log("Shader:can't find uinform name:"+X$h.codename+" in shader file."),X$h._this=this,X$h.uploadedValue=[],X$h.type){case 5124:X$h.fun=X$h.isArray?this._uniform1iv:this._uniform1i;break;case 5126:X$h.fun=X$h.isArray?this._uniform1fv:this._uniform1f;break;case 35664:X$h.fun=X$h.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:X$h.fun=X$h.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:X$h.fun=X$h.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:X$h.fun=this._uniform_sampler2D;break;case 35680:X$h.fun=this._uniform_samplerCube;break;case 35676:X$h.fun=this._uniformMatrix4fv;break;case 35670:X$h.fun=this._uniform1i;break;case 35674:X$h.fun=this._uinformMatrix2fv;break;case 35675:X$h.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},X$p._attribute=function(X$m,X$p){var X$h=X$Q.mainContext,X$P=X$Y._enableAtributes,X$L=X$m.location;return X$P[X$L]||X$h.enableVertexAttribArray(X$L),X$h.vertexAttribPointer(X$L,X$p[0],X$p[1],X$p[2],X$p[3],X$p[4]),X$P[X$L]=X$Y._bindVertexBuffer,1},X$p._uniform1f=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p?(X$Q.mainContext.uniform1f(X$m.location,X$h[0]=X$p),1):0},X$p._uniform1fv=function(X$m,X$p){if(X$p.length<4){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]||X$h[2]!==X$p[2]||X$h[3]!==X$p[3]?(X$Q.mainContext.uniform1fv(X$m.location,X$p),X$h[0]=X$p[0],X$h[1]=X$p[1],X$h[2]=X$p[2],X$h[3]=X$p[3],1):0}return X$Q.mainContext.uniform1fv(X$m.location,X$p),1},X$p._uniform_vec2=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]?(X$Q.mainContext.uniform2f(X$m.location,X$h[0]=X$p[0],X$h[1]=X$p[1]),1):0},X$p._uniform_vec2v=function(X$m,X$p){if(X$p.length<2){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]||X$h[2]!==X$p[2]||X$h[3]!==X$p[3]?(X$Q.mainContext.uniform2fv(X$m.location,X$p),X$h[0]=X$p[0],X$h[1]=X$p[1],X$h[2]=X$p[2],X$h[3]=X$p[3],1):0}return X$Q.mainContext.uniform2fv(X$m.location,X$p),1},X$p._uniform_vec3=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]||X$h[2]!==X$p[2]?(X$Q.mainContext.uniform3f(X$m.location,X$h[0]=X$p[0],X$h[1]=X$p[1],X$h[2]=X$p[2]),1):0},X$p._uniform_vec3v=function(X$m,X$p){return X$Q.mainContext.uniform3fv(X$m.location,X$p),1},X$p._uniform_vec4=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]||X$h[2]!==X$p[2]||X$h[3]!==X$p[3]?(X$Q.mainContext.uniform4f(X$m.location,X$h[0]=X$p[0],X$h[1]=X$p[1],X$h[2]=X$p[2],X$h[3]=X$p[3]),1):0},X$p._uniform_vec4v=function(X$m,X$p){return X$Q.mainContext.uniform4fv(X$m.location,X$p),1},X$p._uniformMatrix2fv=function(X$m,X$p){return X$Q.mainContext.uniformMatrix2fv(X$m.location,!1,X$p),1},X$p._uniformMatrix3fv=function(X$m,X$p){return X$Q.mainContext.uniformMatrix3fv(X$m.location,!1,X$p),1},X$p._uniformMatrix4fv=function(X$m,X$p){return X$Q.mainContext.uniformMatrix4fv(X$m.location,!1,X$p),1},X$p._uinformMatrix2fv=function(X$m,X$p){return X$Q.mainContext.uniformMatrix2fv(X$m.location,!1,X$p),1},X$p._uinformMatrix3fv=function(X$m,X$p){return X$Q.mainContext.uniformMatrix3fv(X$m.location,!1,X$p),1},X$p._uniform1i=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p?(X$Q.mainContext.uniform1i(X$m.location,X$h[0]=X$p),1):0},X$p._uniform1iv=function(X$m,X$p){return X$Q.mainContext.uniform1iv(X$m.location,X$p),1},X$p._uniform_ivec2=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]?(X$Q.mainContext.uniform2i(X$m.location,X$h[0]=X$p[0],X$h[1]=X$p[1]),1):0},X$p._uniform_ivec2v=function(X$m,X$p){return X$Q.mainContext.uniform2iv(X$m.location,X$p),1},X$p._uniform_vec3i=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]||X$h[2]!==X$p[2]?(X$Q.mainContext.uniform3i(X$m.location,X$h[0]=X$p[0],X$h[1]=X$p[1],X$h[2]=X$p[2]),1):0},X$p._uniform_vec3vi=function(X$m,X$p){return X$Q.mainContext.uniform3iv(X$m.location,X$p),1},X$p._uniform_vec4i=function(X$m,X$p){var X$h=X$m.uploadedValue;return X$h[0]!==X$p[0]||X$h[1]!==X$p[1]||X$h[2]!==X$p[2]||X$h[3]!==X$p[3]?(X$Q.mainContext.uniform4i(X$m.location,X$h[0]=X$p[0],X$h[1]=X$p[1],X$h[2]=X$p[2],X$h[3]=X$p[3]),1):0},X$p._uniform_vec4vi=function(X$m,X$p){return X$Q.mainContext.uniform4iv(X$m.location,X$p),1},X$p._uniform_sampler2D=function(X$m,X$p){var X$h=X$p.source||X$p.defaulteTexture.source,X$P=X$Q.mainContext,X$L=X$m.uploadedValue;if(null!=X$L[0])return X$P.activeTexture(X$D._TEXTURES[X$L[0]]),X$h&&X$M.bindTexture(X$P,3553,X$h),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return X$L[0]=this._curActTexIndex,X$P.uniform1i(X$m.location,this._curActTexIndex),X$P.activeTexture(X$D._TEXTURES[this._curActTexIndex]),X$h&&X$M.bindTexture(X$P,3553,X$h),this._curActTexIndex++,1},X$p._uniform_samplerCube=function(X$m,X$p){var X$h=X$p.source||X$p.defaulteTexture.source,X$P=X$Q.mainContext,X$L=X$m.uploadedValue;if(null!=X$L[0])return X$P.activeTexture(X$D._TEXTURES[X$L[0]]),X$h?X$M.bindTexture(X$P,34067,X$h):X$M.bindTexture(X$P,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return X$L[0]=this._curActTexIndex,X$P.uniform1i(X$m.location,this._curActTexIndex),X$P.activeTexture(X$D._TEXTURES[this._curActTexIndex]),X$h?X$M.bindTexture(X$P,34067,X$h):X$M.bindTexture(X$P,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},X$p._noSetValue=function(X$m){console.log("no....:"+X$m.name)},X$p.bind=function(){return X$h.activeShader=this,(X$h.bindShader=this).activeResource(),X$M.UseProgram(this._program)},X$p.uploadAttributes=function(X$m,X$p){for(var X$h,X$P,X$L=0,X$q=0,X$k=this._attributeParamsMap.length;X$q<X$k;X$q+=2)X$P=this._attributeParamsMap[X$q+1],null!=(X$h=X$m[this._attributeParamsMap[X$q]])&&(X$p&&X$p[X$P.name]&&X$p[X$P.name].bind(),X$L+=X$P.fun.call(this,X$P,X$h));X$I.shaderCall+=X$L},X$p.uploadAttributesX=function(X$m,X$p){for(var X$h,X$P,X$L=0,X$q=0,X$k=this._attributeParamsMap.length;X$q<X$k;X$q+=2)X$P=this._attributeParamsMap[X$q+1],null!=(X$h=X$m[this._attributeParamsMap[X$q]])&&(X$p._bind(),X$L+=X$P.fun.call(this,X$P,X$h));X$I.shaderCall+=X$L},X$p.uploadSceneUniforms=function(X$m){for(var X$p,X$h,X$P=0,X$L=0,X$q=this._sceneUniformParamsMap.length;X$L<X$q;X$L+=2)X$h=this._sceneUniformParamsMap[X$L+1],null!=(X$p=X$m[this._sceneUniformParamsMap[X$L]])&&(X$P+=X$h.fun.call(this,X$h,X$p));X$I.shaderCall+=X$P},X$p.uploadCameraUniforms=function(X$m){for(var X$p,X$h,X$P=0,X$L=0,X$q=this._cameraUniformParamsMap.length;X$L<X$q;X$L+=2)X$h=this._cameraUniformParamsMap[X$L+1],null!=(X$p=X$m[this._cameraUniformParamsMap[X$L]])&&(X$P+=X$h.fun.call(this,X$h,X$p));X$I.shaderCall+=X$P},X$p.uploadSpriteUniforms=function(X$m){for(var X$p,X$h,X$P=0,X$L=0,X$q=this._spriteUniformParamsMap.length;X$L<X$q;X$L+=2)X$h=this._spriteUniformParamsMap[X$L+1],null!=(X$p=X$m[this._spriteUniformParamsMap[X$L]])&&(X$P+=X$h.fun.call(this,X$h,X$p));X$I.shaderCall+=X$P},X$p.uploadMaterialUniforms=function(X$m){for(var X$p,X$h,X$P=0,X$L=0,X$q=this._materialUniformParamsMap.length;X$L<X$q;X$L+=2)X$h=this._materialUniformParamsMap[X$L+1],null!=(X$p=X$m[this._materialUniformParamsMap[X$L]])&&(X$P+=X$h.fun.call(this,X$h,X$p));X$I.shaderCall+=X$P},X$p.uploadRenderElementUniforms=function(X$m){for(var X$p,X$h,X$P=0,X$L=0,X$q=this._renderElementUniformParamsMap.length;X$L<X$q;X$L+=2)X$h=this._renderElementUniformParamsMap[X$L+1],null!=(X$p=X$m[this._renderElementUniformParamsMap[X$L]])&&(X$P+=X$h.fun.call(this,X$h,X$p));X$I.shaderCall+=X$P},X$D.create=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){return new X$D(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K)},X$D.addInclude=function(X$m,X$p){X$a.addInclude(X$m,X$p)},X$D._createShader=function(X$m,X$p,X$h){var X$P=X$m.createShader(X$h);if(X$m.shaderSource(X$P,X$p),X$m.compileShader(X$P),X$Ip.debugMode&&!X$m.getShaderParameter(X$P,35713))throw X$m.getShaderInfoLog(X$P);return X$P},X$D.PERIOD_RENDERELEMENT=0,X$D.PERIOD_MATERIAL=1,X$D.PERIOD_SPRITE=2,X$D.PERIOD_CAMERA=3,X$D.PERIOD_SCENE=4,X$D._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],X$D._count=0,X$D._preCompile=!1,X$D.extCompileFunc=null,X$D.extCompileObj=null,X$F(X$D,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new X$b}]),X$D}(),X$Jp=function(X$Y){function X$d(){this._transformUV=null,X$d.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new X$kp(.6,.6,.6)),this._setColor(10,new X$kp(1,1,1)),this._setColor(11,new X$Yp(1,1,1,8)),this._setColor(12,new X$kp(1,1,1)),this._setColor(7,new X$Yp(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new X$Yp(1,1,0,0)),this.renderMode=1}X$$(X$d,"laya.d3.core.material.StandardMaterial",X$Y);var X$m=X$d.prototype;return X$m.disableLight=function(){this._addDisablePublicShaderDefine(X$Ip.SHADERDEFINE_POINTLIGHT|X$Ip.SHADERDEFINE_SPOTLIGHT|X$Ip.SHADERDEFINE_DIRECTIONLIGHT)},X$m.disableFog=function(){this._addDisablePublicShaderDefine(X$Ip.SHADERDEFINE_FOG)},X$m.onAsynLoaded=function(X$m,X$p,X$h){var X$P=X$p[0];if(X$P.version)X$Y.prototype.onAsynLoaded.call(this,X$m,X$p,X$h);else{var X$L=X$p[1],X$q=X$P.props;for(var X$k in X$q)this[X$k]=X$q[X$k];X$d._parseStandardMaterial(X$L,this,X$P),this._endLoaded()}},X$m.cloneTo=function(X$m){X$Y.prototype.cloneTo.call(this,X$m);var X$p=X$m;this._transformUV&&(X$p._transformUV=this._transformUV.clone())},X$A(0,X$m,"ambientColor",function(){return this._getColor(9)},function(X$m){this._setColor(9,X$m)}),X$A(0,X$m,"ambientTexture",function(){return this._getTexture(5)},function(X$m){X$m?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,X$m)}),X$A(0,X$m,"renderMode",null,function(X$m){switch(X$m){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(X$d.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(X$m)}),X$A(0,X$m,"reflectColor",function(){return this._getColor(12)},function(X$m){this._setColor(12,X$m)}),X$A(0,X$m,"tilingOffset",function(){return this._getColor(15)},function(X$m){if(X$m){var X$p=X$m.elements;1!=X$p[0]||1!=X$p[1]||0!=X$p[2]||0!=X$p[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,X$m)}),X$A(0,X$m,"albedo",function(){return this._getColor(7)},function(X$m){this._setColor(7,X$m)}),X$A(0,X$m,"diffuseColor",function(){return this._getColor(10)},function(X$m){this._setColor(10,X$m)}),X$A(0,X$m,"albedoColor",function(){return this._getColor(7)},function(X$m){this._setColor(7,X$m)}),X$A(0,X$m,"specularColor",function(){return this._getColor(11)},function(X$m){this._setColor(11,X$m)}),X$A(0,X$m,"diffuseTexture",function(){return this._getTexture(1)},function(X$m){X$m?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,X$m)}),X$A(0,X$m,"normalTexture",function(){return this._getTexture(2)},function(X$m){X$m?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,X$m)}),X$A(0,X$m,"specularTexture",function(){return this._getTexture(3)},function(X$m){X$m?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,X$m)}),X$A(0,X$m,"emissiveTexture",function(){return this._getTexture(4)},function(X$m){X$m?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,X$m)}),X$A(0,X$m,"reflectTexture",function(){return this._getTexture(6)},function(X$m){X$m?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,X$m)}),X$A(0,X$m,"transformUV",function(){return this._transformUV},function(X$m){this._transformUV=X$m,this._setMatrix4x4(13,X$m.matrix),X$m?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,X$m.matrix.elements,0)}),X$d.__init__=function(){X$d.SHADERDEFINE_DIFFUSEMAP=X$d.shaderDefines.registerDefine("DIFFUSEMAP"),X$d.SHADERDEFINE_NORMALMAP=X$d.shaderDefines.registerDefine("NORMALMAP"),X$d.SHADERDEFINE_SPECULARMAP=X$d.shaderDefines.registerDefine("SPECULARMAP"),X$d.SHADERDEFINE_EMISSIVEMAP=X$d.shaderDefines.registerDefine("EMISSIVEMAP"),X$d.SHADERDEFINE_AMBIENTMAP=X$d.shaderDefines.registerDefine("AMBIENTMAP"),X$d.SHADERDEFINE_REFLECTMAP=X$d.shaderDefines.registerDefine("REFLECTMAP"),X$d.SHADERDEFINE_UVTRANSFORM=X$d.shaderDefines.registerDefine("UVTRANSFORM"),X$d.SHADERDEFINE_TILINGOFFSET=X$d.shaderDefines.registerDefine("TILINGOFFSET"),X$d.SHADERDEFINE_ADDTIVEFOG=X$d.shaderDefines.registerDefine("ADDTIVEFOG")},X$d.load=function(X$m){return X$H.loader.create(X$m,null,null,X$d)},X$d._parseStandardMaterial=function(X$m,X$p,X$h){var X$P=X$h.customProps,X$L=X$P.ambientColor;X$p.ambientColor=new X$kp(X$L[0],X$L[1],X$L[2]);var X$q=X$P.diffuseColor;X$p.diffuseColor=new X$kp(X$q[0],X$q[1],X$q[2]);var X$k=X$P.specularColor;X$p.specularColor=new X$Yp(X$k[0],X$k[1],X$k[2],X$k[3]);var X$Y=X$P.reflectColor;X$p.reflectColor=new X$kp(X$Y[0],X$Y[1],X$Y[2]);var X$d=X$P.albedoColor;X$d&&(X$p.albedo=new X$Yp(X$d[0],X$d[1],X$d[2],X$d[3]));var X$K=X$P.diffuseTexture.texture2D;X$K&&(X$p.diffuseTexture=X$c.getRes(X$m[X$K]));var X$D=X$P.normalTexture.texture2D;X$D&&(X$p.normalTexture=X$c.getRes(X$m[X$D]));var X$F=X$P.specularTexture.texture2D;X$F&&(X$p.specularTexture=X$c.getRes(X$m[X$F]));var X$R=X$P.emissiveTexture.texture2D;X$R&&(X$p.emissiveTexture=X$c.getRes(X$m[X$R]));var X$$=X$P.ambientTexture.texture2D;X$$&&(X$p.ambientTexture=X$c.getRes(X$m[X$$]));var X$A=X$P.reflectTexture.texture2D;X$A&&(X$p.reflectTexture=X$c.getRes(X$m[X$A]))},X$d.RENDERMODE_OPAQUE=1,X$d.RENDERMODE_OPAQUEDOUBLEFACE=2,X$d.RENDERMODE_CUTOUT=3,X$d.RENDERMODE_CUTOUTDOUBLEFACE=4,X$d.RENDERMODE_TRANSPARENT=13,X$d.RENDERMODE_TRANSPARENTDOUBLEFACE=14,X$d.RENDERMODE_ADDTIVE=15,X$d.RENDERMODE_ADDTIVEDOUBLEFACE=16,X$d.RENDERMODE_DEPTHREAD_TRANSPARENT=5,X$d.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,X$d.RENDERMODE_DEPTHREAD_ADDTIVE=7,X$d.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,X$d.RENDERMODE_NONDEPTH_TRANSPARENT=9,X$d.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,X$d.RENDERMODE_NONDEPTH_ADDTIVE=11,X$d.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,X$d.SHADERDEFINE_DIFFUSEMAP=0,X$d.SHADERDEFINE_NORMALMAP=0,X$d.SHADERDEFINE_SPECULARMAP=0,X$d.SHADERDEFINE_EMISSIVEMAP=0,X$d.SHADERDEFINE_AMBIENTMAP=0,X$d.SHADERDEFINE_REFLECTMAP=0,X$d.SHADERDEFINE_UVTRANSFORM=0,X$d.SHADERDEFINE_TILINGOFFSET=0,X$d.SHADERDEFINE_ADDTIVEFOG=0,X$d.DIFFUSETEXTURE=1,X$d.NORMALTEXTURE=2,X$d.SPECULARTEXTURE=3,X$d.EMISSIVETEXTURE=4,X$d.AMBIENTTEXTURE=5,X$d.REFLECTTEXTURE=6,X$d.ALBEDO=7,X$d.UVANIAGE=8,X$d.MATERIALAMBIENT=9,X$d.MATERIALDIFFUSE=10,X$d.MATERIALSPECULAR=11,X$d.MATERIALREFLECT=12,X$d.UVMATRIX=13,X$d.UVAGE=14,X$d.TILINGOFFSET=15,X$F(X$d,["defaultMaterial",function(){var X$m=new X$d;return X$m.lock=!0,this.defaultMaterial=X$m},"shaderDefines",function(){return this.shaderDefines=new X$Dp(X$xp.shaderDefines)}]),X$d}(X$xp),X$zp=function(X$m){function X$k(X$m,X$p,X$h,X$P,X$L){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===X$h&&(X$h=35044),void 0===X$P&&(X$P=!1),X$k.__super.call(this),this._indexType=X$m,this._indexCount=X$p,this._bufferUsage=X$h,this._bufferType=34963,this._canRead=X$P;var X$q;if("ushort"==X$m)this._indexTypeByteCount=2;else{if("ubyte"!=X$m)throw new Error("unidentification index type.");this._indexTypeByteCount=1}X$q=this._indexTypeByteCount*X$p,this._byteLength=X$q,this._bind(),X$Y._gl.bufferData(this._bufferType,X$q,this._bufferUsage),this.uri=X$L,X$P?("ushort"==X$m?this._buffer=new Uint16Array(X$p):"ubyte"==X$m&&(this._buffer=new Uint8Array(X$p)),this.memorySize=2*X$q):this.memorySize=X$q}X$$(X$k,"laya.d3.graphics.IndexBuffer3D",X$m);var X$p=X$k.prototype;return X$p.setData=function(X$m,X$p,X$h,X$P){void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=4294967295);var X$L=0;if("ushort"==this._indexType?(X$L=2,0===X$h&&4294967295===X$P||(X$m=new Uint16Array(X$m.buffer,X$h*X$L,X$P))):"ubyte"==this._indexType&&(X$L=1,0===X$h&&4294967295===X$P||(X$m=new Uint8Array(X$m.buffer,X$h*X$L,X$P))),this._bind(),X$Y._gl.bufferSubData(this._bufferType,X$p*X$L,X$m),this._canRead)if(0!==X$p||0!==X$h||4294967295!==X$P){var X$q=this._buffer.length-X$p;X$q<X$P&&(X$P=X$q);for(var X$k=0;X$k<X$P;X$k++)this._buffer[X$p+X$k]=X$m[X$k]}else this._buffer=X$m},X$p.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},X$p.disposeResource=function(){X$m.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},X$A(0,X$p,"indexType",function(){return this._indexType}),X$A(0,X$p,"indexTypeByteCount",function(){return this._indexTypeByteCount}),X$A(0,X$p,"indexCount",function(){return this._indexCount}),X$A(0,X$p,"canRead",function(){return this._canRead}),X$k.INDEXTYPE_UBYTE="ubyte",X$k.INDEXTYPE_USHORT="ushort",X$k.create=function(X$m,X$p,X$h,X$P,X$L){return void 0===X$h&&(X$h=35044),void 0===X$P&&(X$P=!1),new X$k(X$m,X$p,X$h,X$P,X$L)},X$k}(X$Y),X$wp=function(X$q){function X$k(X$m,X$p,X$h,X$P,X$L){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===X$P&&(X$P=!1),X$k.__super.call(this),this._vertexDeclaration=X$m,this._vertexCount=X$p,this._bufferUsage=X$h,this._bufferType=34962,this._canRead=X$P,this.uri=X$L,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*X$p,this._bind(),X$Y._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),X$P&&(this._buffer=new Float32Array(this._byteLength/4))}X$$(X$k,"laya.d3.graphics.VertexBuffer3D",X$q);var X$m=X$k.prototype;return X$m.bindWithIndexBuffer=function(X$m){X$m&&X$m._bind(),this._bind()},X$m.setData=function(X$m,X$p,X$h,X$P){if(void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=4294967295),0===X$h&&4294967295===X$P||(X$m=new Float32Array(X$m.buffer,4*X$h,X$P)),this._bind(),X$Y._gl.bufferSubData(this._bufferType,4*X$p,X$m),this._canRead)if(0!==X$p||0!==X$h||4294967295!==X$P){var X$L=this._buffer.length-X$p;X$L<X$P&&(X$P=X$L);for(var X$q=0;X$q<X$P;X$q++)this._buffer[X$p+X$q]=X$m[X$q]}else this._buffer=X$m},X$m.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},X$m.disposeResource=function(){for(var X$m=X$Q.mainContext,X$p=this._vertexDeclaration.getVertexElements(),X$h=X$Y._enableAtributes,X$P=0,X$L=X$p.length;X$P<X$L;X$P++)X$h[X$P]===this._glBuffer&&(X$m.disableVertexAttribArray(X$P),X$h[X$P]=null);X$q.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},X$A(0,X$m,"vertexDeclaration",function(){return this._vertexDeclaration}),X$A(0,X$m,"vertexCount",function(){return this._vertexCount}),X$A(0,X$m,"canRead",function(){return this._canRead}),X$k.create=function(X$m,X$p,X$h,X$P,X$L){return void 0===X$h&&(X$h=35044),void 0===X$P&&(X$P=!1),new X$k(X$m,X$p,X$h,X$P,X$L)},X$k}(X$Y),X$Xp=function(X$m){function X$a(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,X$a.__super.call(this),this._type=3553}X$$(X$a,"laya.d3.resource.DataTexture2D",X$Qp);var X$p=X$a.prototype;return X$p.genDebugMipmaps=function(){var X$m=[];return X$m.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),X$m.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),X$m.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),X$m.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),X$m.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),X$m.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),X$m.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),X$m.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),X$m.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),X$m.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),X$m},X$p._onTextureLoaded=function(X$m){},X$p._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var X$m=X$Q.mainContext,X$p=this._source=X$m.createTexture(),X$h=this._width,X$P=this._height,X$L=X$M.curBindTexTarget,X$q=X$M.curBindTexValue,X$k=!1;if(X$M.bindTexture(X$m,this._type,X$p),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var X$Y=0;X$m.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var X$d=0;X$d<this._mipmaps.length;X$d++){if(this._mipmaps[X$d].byteLength!=X$K*X$D*4)throw"mipmap size error  level:"+X$d;X$m.texSubImage2D(this._type,0,X$a.simLodRect[X$Y++],X$a.simLodRect[X$Y++],X$a.simLodRect[X$Y++],X$a.simLodRect[X$Y++],6408,5121,new Uint8Array(this._mipmaps[X$d]))}this.minFifter=9729,this.magFifter=9729}else{var X$K=this._width,X$D=this._height;for(X$Y=0,X$m.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),X$d=0;X$d<this._mipmaps.length;X$d++){if(this._mipmaps[X$d].byteLength!=X$K*X$D*4)throw"mipmap size error  level:"+X$d;X$m.texImage2D(this._type,X$d,6408,X$K,X$D,0,6408,5121,new Uint8Array(this._mipmaps[X$d])),(X$K/=2)<1&&(X$K=1),(X$D/=2)<1&&(X$D=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&X$m.pixelStorei(X$m.UNPACK_ALIGNMENT,1),X$m.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var X$F=0,X$R=!1,X$$=!1;this._buffer.byteLength==4*X$h*X$P?(X$F=6408,X$R=!0):this._buffer.byteLength==3*X$h*X$P?(X$F=6407,X$$=!0):X$F=this._format,X$R||X$$?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),X$$&&X$m.pixelStorei(X$m.UNPACK_ALIGNMENT,1),X$m.texImage2D(this._type,0,X$F,X$h,X$P,0,X$F,5121,this._buffer)):X$m&&X$F==X$m.ALPHA?(X$m.texImage2D(3553,0,X$F,X$h,X$P,0,X$F,X$m.UNSIGNED_BYTE,this._buffer),X$k=!0):0!=X$F&&(X$m.compressedTexImage2D(3553,0,X$F,X$h,X$P,0,this._buffer),X$k=!0)}var X$A=this._minFifter,X$B=this._magFifter,X$n=0==this._wrapModeU?10497:33071,X$c=0==this._wrapModeV?10497:33071,X$e=X$Z.isPOT(X$h,X$P);X$e?(this._mipmap||this._mipmaps?-1!==X$A||(X$A=9987):-1!==X$A||(X$A=9729),-1!==X$B||(X$B=9729),X$m.texParameteri(this._type,10241,X$A),X$m.texParameteri(this._type,10240,X$B),X$m.texParameteri(this._type,10242,X$n),X$m.texParameteri(this._type,10243,X$c),this._mipmap&&X$m.generateMipmap(this._type)):(-1!==X$A||(X$A=9729),-1!==X$B||(X$B=9729),X$m.texParameteri(this._type,10241,X$A),X$m.texParameteri(this._type,10240,X$B),X$m.texParameteri(this._type,10242,33071),X$m.texParameteri(this._type,10243,33071)),X$L&&X$q&&X$M.bindTexture(X$m,X$L,X$q),this.memorySize=X$k?this._buffer.length:X$e?X$h*X$P*4*(1+1/3):X$h*X$P*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},X$p.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},X$p.onAsynLoaded=function(X$m,X$p,X$h){var X$P;X$h&&(X$P=X$h[0].call(this,X$p)),X$P&&(this._width=X$P.width,this._height=X$P.height,this._buffer=X$P.data),this._src=X$m,this._size=new X$Bp(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},X$p.getPixels=function(){return new Uint8Array(this._buffer)},X$p.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(X$Q.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},X$A(0,X$p,"src",function(){return this._src}),X$a.create=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){if(void 0===X$P&&(X$P=9729),void 0===X$L&&(X$L=9729),void 0===X$q&&(X$q=!0),!X$m||X$m.byteLength<X$p*X$h*4)throw"DataTexture2D create error";var X$Y=new X$a;return X$Y.uri=X$k,X$Y._buffer=X$m,X$Y._width=X$p,X$Y._height=X$h,X$Y._mipmap=X$q,X$Y._magFifter=X$P,X$Y._minFifter=X$L,X$Y._size=new X$Bp(X$Y._width,X$Y._height),X$Y._conchTexture?alert("怎么给runtime传递datatexture数据"):X$Y.activeResource(),X$Y},X$a.load=function(X$m,X$p,X$h,X$P,X$L){if(void 0===X$p&&(X$p=0),void 0===X$h&&(X$h=0),void 0===X$P&&(X$P=9729),void 0===X$L&&(X$L=9729),"mipmaps"===X$T.getFileExtension(X$m)){var X$q=X$H.loader.create(X$m,null,null,X$a,[function(X$m){this._mipmaps=[];var X$p=new Uint32Array(X$m);this._width=X$p[0];var X$h=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,X$h=1024),this._width!=X$h)throw"现在只支持512x256的环境贴图。当前的是"+X$p[0];this._height=X$p[1];for(var X$P=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,X$L=this._height,X$q=8;;){var X$k=X$P*X$L*4;if(X$q+X$k>X$m.byteLength)throw"load mipmaps data size error ";var X$Y=new Uint8Array(X$m,X$q,X$k);if(this._mipmaps.push(X$Y),X$q+=X$k,1==X$P&&1==X$L)break;(X$P/=2)<1&&(X$P=1),(X$L/=2)<1&&(X$L=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){X$q.simLodInfo=new Float32Array(40);for(var X$k=0;X$k<X$q.simLodInfo.length;)X$q.simLodInfo[X$k]=(X$a.simLodRect[X$k]+.5)/1024,X$k++,X$q.simLodInfo[X$k]=(X$a.simLodRect[X$k]+.5)/256,X$k++,X$q.simLodInfo[X$k]=Math.max(X$a.simLodRect[X$k]-1,.1)/1024,X$k++,X$q.simLodInfo[X$k]=Math.max(X$a.simLodRect[X$k]-1.5,.1)/256,X$k++}return X$q}if("number"==typeof X$p)return X$H.loader.create(X$m,null,null,X$a,[function(X$m){return this._width=X$p,this._height=X$h,this._buffer=X$m,null}]);if("function"==typeof X$p)return X$H.loader.create(X$m,null,null,X$a,[X$p]);throw new Error("unknown params.")},X$a.lodasatlas=!1,X$F(X$a,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),X$a}(),X$sp=function(X$m){function X$p(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,X$p.__super.call(this)}X$$(X$p,"laya.d3.resource.models.PrimitiveMesh",X$Mp);var X$h=X$p.prototype;return X$H.imps(X$h,{"laya.d3.core.render.IRenderable":!0}),X$h._getVertexBuffer=function(X$m){return void 0===X$m&&(X$m=0),0===X$m?this._vertexBuffer:null},X$h._getVertexBuffers=function(){return null},X$h._getIndexBuffer=function(){return this._indexBuffer},X$h._getPositions=function(){var X$m,X$p=[],X$h=this._vertexBuffer.vertexDeclaration.getVertexElements(),X$P=0;for(X$P=0;X$P<X$h.length;X$P++){var X$L=X$h[X$P];if("vector3"===X$L.elementFormat&&0===X$L.elementUsage){X$m=X$L;break}}var X$q=this._vertexBuffer.getData();for(X$P=0;X$P<X$q.length;X$P+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var X$k=X$P+X$m.offset/4,X$Y=new X$kp(X$q[X$k+0],X$q[X$k+1],X$q[X$k+2]);X$p.push(X$Y)}return X$p},X$h.getRenderElement=function(X$m){return this},X$h.getRenderElementsCount=function(){return 1},X$h.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},X$h._beforeRender=function(X$m){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},X$h._render=function(X$m){X$Q.mainContext.drawElements(4,this._numberIndices,5123,0),X$I.drawCall++,X$I.trianglesFaces+=this._numberIndices/3},X$A(0,X$h,"_vertexBufferCount",function(){return 1}),X$A(0,X$h,"triangleCount",function(){return this._indexBuffer.indexCount/3}),X$p}(),X$Gp=function(X$m){function X$p(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,X$p.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}X$$(X$p,"laya.d3.resource.models.Mesh",X$Mp);var X$h=X$p.prototype;return X$h._getPositions=function(){var X$m,X$p,X$h,X$P,X$L,X$q=[],X$k=0,X$Y=0,X$d=0;if(0!==this._vertexBuffers.length){var X$K=this._vertexBuffers.length;for(X$k=0;X$k<X$K;X$k++){for(X$h=(X$m=this._vertexBuffers[X$k]).vertexDeclaration.getVertexElements(),X$Y=0;X$Y<X$h.length;X$Y++)if("vector3"===(X$P=X$h[X$Y]).elementFormat&&0===X$P.elementUsage){X$p=X$P;break}for(X$L=X$m.getData(),X$Y=0;X$Y<X$L.length;X$Y+=X$m.vertexDeclaration.vertexStride/4)X$d=X$Y+X$p.offset/4,X$q.push(new X$kp(X$L[X$d+0],X$L[X$d+1],X$L[X$d+2]))}}else{var X$D=this._subMeshes.length;for(X$k=0;X$k<X$D;X$k++){for(X$h=(X$m=this._subMeshes[X$k]._getVertexBuffer()).vertexDeclaration.getVertexElements(),X$Y=0;X$Y<X$h.length;X$Y++)if("vector3"===(X$P=X$h[X$Y]).elementFormat&&0===X$P.elementUsage){X$p=X$P;break}for(X$L=X$m.getData(),X$Y=0;X$Y<X$L.length;X$Y+=X$m.vertexDeclaration.vertexStride/4)X$d=X$Y+X$p.offset/4,X$q.push(new X$kp(X$L[X$d+0],X$L[X$d+1],X$L[X$d+2]))}}return X$q},X$h._setSubMeshes=function(X$m){this._subMeshes=X$m,this._subMeshCount=X$m.length;for(var X$p=0;X$p<this._subMeshCount;X$p++)X$m[X$p]._indexInMesh=X$p;this._positions=this._getPositions(),this._generateBoundingObject()},X$h.onAsynLoaded=function(X$m,X$p,X$h){var X$P=X$p[0],X$L=X$p[1];X$im.read(X$P,this,this._materials,this._subMeshes,X$L),this.completeCreate(),this._endLoaded()},X$h.getSubMesh=function(X$m){return this._subMeshes[X$m]},X$h.getSubMeshCount=function(){return this._subMeshes.length},X$h.getRenderElementsCount=function(){return this._subMeshes.length},X$h.getRenderElement=function(X$m){return this._subMeshes[X$m]},X$h.disposeResource=function(){for(var X$m=0;X$m<this._subMeshes.length;X$m++)this._subMeshes[X$m].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},X$A(0,X$h,"materials",function(){return this._materials.slice()}),X$A(0,X$h,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),X$p.load=function(X$m){return X$H.loader.create(X$m,null,null,X$p)},X$p}(),X$Up=(function(X$m){function X$K(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===X$h&&(X$h=6408),void 0===X$P&&(X$P=5121),void 0===X$L&&(X$L=33189),void 0===X$q&&(X$q=!1),void 0===X$k&&(X$k=!1),void 0===X$Y&&(X$Y=-1),void 0===X$d&&(X$d=-1),X$K.__super.call(this),this._type=3553,this._width=X$m,this._height=X$p,this._size=new X$Bp(X$m,X$p),this._surfaceFormat=X$h,this._surfaceType=X$P,this._depthStencilFormat=X$L,X$B.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=X$q,this._repeat=X$k,this._minFifter=X$Y,this._magFifter=X$d,this.activeResource(),this._alreadyResolved=!0}X$$(X$K,"laya.d3.resource.RenderTexture",X$Qp);var X$p=X$K.prototype;X$p.recreateResource=function(){var X$m=X$Q.mainContext;this._frameBuffer=X$m.createFramebuffer(),this._source=X$m.createTexture();var X$p=X$M.curBindTexTarget,X$h=X$M.curBindTexValue;X$M.bindTexture(X$m,this._type,this._source),X$m.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var X$P=this._minFifter,X$L=this._magFifter,X$q=this._repeat?10497:33071;if(X$Z.isPOT(this._width,this._height)?(this._mipmap?-1!==X$P||(X$P=9987):-1!==X$P||(X$P=9729),-1!==X$L||(X$L=9729),X$m.texParameteri(this._type,10241,X$P),X$m.texParameteri(this._type,10240,X$L),X$m.texParameteri(this._type,10242,X$q),X$m.texParameteri(this._type,10243,X$q),this._mipmap&&X$m.generateMipmap(this._type)):(-1!==X$P||(X$P=9729),-1!==X$L||(X$L=9729),X$m.texParameteri(this._type,10241,X$P),X$m.texParameteri(this._type,10240,X$L),X$m.texParameteri(this._type,10242,33071),X$m.texParameteri(this._type,10243,33071)),X$p&&X$h&&X$M.bindTexture(X$m,X$p,X$h),X$m.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=X$m.createRenderbuffer(),X$m.bindRenderbuffer(36161,this._depthStencilBuffer),X$m.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),X$m.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:X$m.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:X$m.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:X$m.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}X$m.framebufferTexture2D(36160,36064,3553,this._source,0),X$m.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},X$p.start=function(){X$Q.mainContext.bindFramebuffer(36160,this.frameBuffer),(X$K._currentRenderTarget=this)._alreadyResolved=!1},X$p.end=function(){X$Q.mainContext.bindFramebuffer(36160,null),X$K._currentRenderTarget=null,this._alreadyResolved=!0},X$p.getData=function(X$m,X$p,X$h,X$P){var X$L=X$Q.mainContext;if(X$L.bindFramebuffer(36160,this._frameBuffer),!(36053===X$L.checkFramebufferStatus(36160)))return X$L.bindFramebuffer(36160,null),null;var X$q=new Uint8Array(this._width*this._height*4);return X$L.readPixels(X$m,X$p,X$h,X$P,this._surfaceFormat,this._surfaceType,X$q),X$L.bindFramebuffer(36160,null),X$q},X$p.disposeResource=function(){if(this._frameBuffer){var X$m=X$Q.mainContext;X$m.deleteTexture(this._source),X$m.deleteFramebuffer(this._frameBuffer),X$m.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},X$A(0,X$p,"surfaceFormat",function(){return this._surfaceFormat}),X$A(0,X$p,"surfaceType",function(){return this._surfaceType}),X$A(0,X$p,"depthStencilFormat",function(){return this._depthStencilFormat}),X$A(0,X$p,"source",function(){return this._alreadyResolved?X$H.superGet(X$Qp,this,"source"):null}),X$A(0,X$p,"depthStencilBuffer",function(){return this._depthStencilBuffer}),X$A(0,X$p,"frameBuffer",function(){return this._frameBuffer}),X$K._currentRenderTarget=null}(),function(X$m){function X$p(X$m){this._color=null,this._pixels=null,X$p.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new X$Bp(this.width,this.height),this._color=X$m,this._pixels=new Uint8Array([255*X$m.x,255*X$m.y,255*X$m.z,255*X$m.w]),this.uri="SolidColorTexture2D_"+this.id}X$$(X$p,"laya.d3.resource.SolidColorTexture2D",X$Qp);var X$h=X$p.prototype;return X$h._createWebGlTexture=function(){var X$m=X$Q.mainContext,X$p=this._source=X$m.createTexture(),X$h=this._width,X$P=this._height,X$L=X$M.curBindTexTarget,X$q=X$M.curBindTexValue;X$M.bindTexture(X$m,this._type,X$p),X$m.texImage2D(this._type,0,6408,X$h,X$P,0,6408,5121,this._pixels);var X$k=this._minFifter,X$Y=this._magFifter,X$d=this._repeat?10497:33071,X$K=X$Z.isPOT(X$h,X$P);X$K?(this._mipmap?-1!==X$k||(X$k=9987):-1!==X$k||(X$k=9729),-1!==X$Y||(X$Y=9729),X$m.texParameteri(this._type,10241,X$k),X$m.texParameteri(this._type,10240,X$Y),X$m.texParameteri(this._type,10242,X$d),X$m.texParameteri(this._type,10243,X$d),this._mipmap&&X$m.generateMipmap(this._type)):(-1!==X$k||(X$k=9729),-1!==X$Y||(X$Y=9729),X$m.texParameteri(this._type,10241,X$k),X$m.texParameteri(this._type,10240,X$Y),X$m.texParameteri(this._type,10242,33071),X$m.texParameteri(this._type,10243,33071)),X$L&&X$q&&X$M.bindTexture(X$m,X$L,X$q),this.memorySize=X$K?X$h*X$P*4*(1+1/3):X$h*X$P*4},X$h.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},X$h.disposeResource=function(){this._source&&(X$Q.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},X$F(X$p,["magentaTexture",function(){var X$m=new X$p(new X$Yp(1,0,1,1));return X$m.lock=!0,this.magentaTexture=X$m},"grayTexture",function(){var X$m=new X$p(new X$Yp(.5,.5,.5,1));return X$m.lock=!0,this.grayTexture=X$m}]),X$p}()),X$rp=function(X$m){function X$L(X$m,X$p,X$h,X$P){this._canRead=!1,this._image=null,this._pixels=null,void 0===X$m&&(X$m=!1),void 0===X$p&&(X$p=!0),void 0===X$h&&(X$h=6408),void 0===X$P&&(X$P=!0),X$L.__super.call(this),this._type=3553,this._repeat=X$p,this._canRead=X$m,this._format=X$h,this._mipmap=X$P}X$$(X$L,"laya.d3.resource.Texture2D",X$Qp);var X$p=X$L.prototype;return X$p._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var X$m=X$Q.mainContext,X$p=this._source=X$m.createTexture(),X$h=this._width,X$P=this._height,X$L=X$M.curBindTexTarget,X$q=X$M.curBindTexValue;switch(X$M.bindTexture(X$m,this._type,X$p),this._format){case 6407:case 6408:this._canRead?X$m.texImage2D(this._type,0,this._format,X$h,X$P,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?X$m.texImage2D(this._type,0,this._image._format,X$h,X$P,0,this._image._format,5121,this._image.atlasSource):X$m.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case X$Q.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:X$m.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var X$k=this._minFifter,X$Y=this._magFifter,X$d=this._repeat?10497:33071,X$K=0==this._wrapModeU?10497:33071,X$D=0==this._wrapModeV?10497:33071,X$F=X$Z.isPOT(X$h,X$P);X$F?(this._mipmap?-1!==X$k||(X$k=9987):-1!==X$k||(X$k=9729),-1!==X$Y||(X$Y=9729),X$m.texParameteri(this._type,10241,X$k),X$m.texParameteri(this._type,10240,X$Y),X$m.texParameteri(this._type,10242,X$d),X$m.texParameteri(this._type,10243,X$d),X$m.texParameteri(this._type,10242,X$K),X$m.texParameteri(this._type,10243,X$D),this._mipmap&&X$m.generateMipmap(this._type)):(-1!==X$k||(X$k=9729),-1!==X$Y||(X$Y=9729),X$m.texParameteri(this._type,10241,X$k),X$m.texParameteri(this._type,10240,X$Y),X$m.texParameteri(this._type,10242,33071),X$m.texParameteri(this._type,10243,33071)),X$L&&X$q&&X$M.bindTexture(X$m,X$L,X$q),this._image.onload=null,this._image=null,this.memorySize=X$F?X$h*X$P*4*(1+1/3):X$h*X$P*4},X$p.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},X$p.onAsynLoaded=function(X$m,X$p,X$h){if(X$h){var X$P=X$h[0];void 0!==X$P&&(this._canRead=X$P);var X$L=X$h[1];void 0!==X$L&&(this._repeat=X$L);var X$q=X$h[2];void 0!==X$q&&(this._format=X$q);var X$k=X$h[3];void 0!==X$k&&(this._mipmap=X$k);var X$Y=X$h.wrapModeU;void 0!==X$Y&&(this._wrapModeU=X$Y);var X$d=X$h.wrapModeV;void 0!==X$d&&(this._wrapModeV=X$d)}switch(this._format){case 6407:case 6408:var X$K=(this._image=X$p).width,X$D=X$p.height;this._width=X$K,this._height=X$D,this._size=new X$Bp(X$K,X$D),this._canRead&&(X$B.isConchApp?X$p instanceof X$R.HTMLElement&&(this._pixels=new Uint8Array(X$p.getImageData(0,0,X$K,X$D))):(X$u.canvas.size(X$K,X$D),X$u.canvas.clear(),X$u.context.drawImage(X$p,0,0,X$K,X$D),this._pixels=new Uint8Array(X$u.context.getImageData(0,0,X$K,X$D).data.buffer)));break;case X$Q.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var X$F=new X$W(X$p);X$F.readUTFBytes(4),X$F.readUTFBytes(2),X$F.getInt16();X$F.endian="bigEndian",this._width=X$F.getInt16(),this._height=X$F.getInt16(),this._size=new X$Bp(this._width,this._height);X$F.getInt16(),X$F.getInt16();this._image=new Uint8Array(X$p,X$F.pos)}this.recreateResource(),this._endLoaded()},X$p.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},X$p.disposeResource=function(){this._source&&(X$Q.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},X$A(0,X$p,"_src",function(){return this.url}),X$A(0,X$p,"src",function(){return this.url}),X$L.load=function(X$m){return X$H.loader.create(X$m,null,null,X$L)},X$L}(),X$yp=function(X$p){function X$h(X$m,X$p){X$h.__super.call(this),void 0===X$m&&(X$m=.3),void 0===X$p&&(X$p=1e3),this._tempVector3=new X$kp,this._position=new X$kp,this._up=new X$kp,this._forward=new X$kp,this._right=new X$kp,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=X$Bp.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=X$m,this._farPlane=X$p,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),X$H.stage.on("resize",this,this._onScreenSizeChanged)}X$$(X$h,"laya.d3.core.BaseCamera",X$p);var X$m=X$h.prototype;return X$m._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var X$m=this.scene._cameraPool,X$p=X$m.length-1,X$h=0;X$h<X$p;X$h++)if(X$m[X$h].renderingOrder>X$m[X$p].renderingOrder){var X$P=X$m[X$h];X$m[X$h]=X$m[X$p],X$m[X$p]=X$P}},X$m._calculateProjectionMatrix=function(){},X$m._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},X$m._prepareCameraToRender=function(){X$N._currentCameraCullingMask=this.cullingMask;var X$m=this._shaderValues;X$m.setValue(0,this.transform.position.elements),X$m.setValue(5,this.forward.elements),X$m.setValue(6,this.up.elements)},X$m._prepareCameraViewProject=function(X$m,X$p){var X$h=this._shaderValues;X$h.setValue(1,X$m.elements),X$h.setValue(2,X$p.elements)},X$m._renderCamera=function(X$m,X$p,X$h){},X$m.addLayer=function(X$m){29!==X$m.number&&30!=X$m.number&&(this.cullingMask=this.cullingMask|X$m.mask)},X$m.removeLayer=function(X$m){29!==X$m.number&&30!=X$m.number&&(this.cullingMask=this.cullingMask&~X$m.mask)},X$m.addAllLayers=function(){this.cullingMask=2147483647},X$m.removeAllLayers=function(){this.cullingMask=0|X$N.getLayerByNumber(29).mask|X$N.getLayerByNumber(30).mask},X$m.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},X$m.moveForward=function(X$m){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=X$m,this.transform.translate(this._tempVector3)},X$m.moveRight=function(X$m){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=X$m,this.transform.translate(this._tempVector3)},X$m.moveVertical=function(X$m){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=X$m,this.transform.translate(this._tempVector3,!1)},X$m._addSelfRenderObjects=function(){var X$m=this.scene._cameraPool,X$p=X$m.length;if(0<X$p){for(var X$h=X$p-1;0<=X$h;X$h--)if(this.renderingOrder<=X$m[X$h].renderingOrder){X$m.splice(X$h+1,0,this);break}}else X$m.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},X$m._clearSelfRenderObjects=function(){var X$m=this.scene._cameraPool;X$m.splice(X$m.indexOf(this),1)},X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,X$H.stage.off("resize",this,this._onScreenSizeChanged),X$p.prototype.destroy.call(this,X$m)},X$A(0,X$m,"sky",function(){return this._sky},function(X$m){(this._sky=X$m)._ownerCamera=this}),X$A(0,X$m,"forward",function(){var X$m=this.transform.worldMatrix.elements,X$p=this._forward.elements;return X$p[0]=-X$m[8],X$p[1]=-X$m[9],X$p[2]=-X$m[10],this._forward}),X$A(0,X$m,"position",function(){var X$m=this.transform.worldMatrix.elements,X$p=this._position.elements;return X$p[0]=X$m[12],X$p[1]=X$m[13],X$p[2]=X$m[14],this._position}),X$A(0,X$m,"renderTarget",function(){return this._renderTarget},function(X$m){null!=(this._renderTarget=X$m)&&(this._renderTargetSize=X$m.size)}),X$A(0,X$m,"up",function(){var X$m=this.transform.worldMatrix.elements,X$p=this._up.elements;return X$p[0]=X$m[4],X$p[1]=X$m[5],X$p[2]=X$m[6],this._up}),X$A(0,X$m,"right",function(){var X$m=this.transform.worldMatrix.elements,X$p=this._right.elements;return X$p[0]=X$m[0],X$p[1]=X$m[1],X$p[2]=X$m[2],this._right}),X$A(0,X$m,"renderTargetSize",function(){return this._renderTargetSize},function(X$m){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=X$m,this._calculateProjectionMatrix()}),X$A(0,X$m,"fieldOfView",function(){return this._fieldOfView},function(X$m){this._fieldOfView=X$m,this._calculateProjectionMatrix()}),X$A(0,X$m,"nearPlane",function(){return this._nearPlane},function(X$m){this._nearPlane=X$m,this._calculateProjectionMatrix()}),X$A(0,X$m,"farPlane",function(){return this._farPlane},function(X$m){this._farPlane=X$m,this._calculateProjectionMatrix()}),X$A(0,X$m,"orthographic",function(){return this._orthographic},function(X$m){this._orthographic=X$m,this._calculateProjectionMatrix()}),X$A(0,X$m,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(X$m){this._orthographicVerticalSize=X$m,this._calculateProjectionMatrix()}),X$A(0,X$m,"renderingOrder",function(){return this._renderingOrder},function(X$m){this._renderingOrder=X$m,this._sortCamerasByRenderingOrder()}),X$h.CAMERAPOS=0,X$h.VIEWMATRIX=1,X$h.PROJECTMATRIX=2,X$h.VPMATRIX=3,X$h.VPMATRIX_NO_TRANSLATE=4,X$h.CAMERADIRECTION=5,X$h.CAMERAUP=6,X$h.ENVIRONMENTDIFFUSE=7,X$h.ENVIRONMENTSPECULAR=8,X$h.SIMLODINFO=9,X$h.DIFFUSEIRRADMATR=10,X$h.DIFFUSEIRRADMATG=11,X$h.DIFFUSEIRRADMATB=12,X$h.HDREXPOSURE=13,X$h.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",X$h.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",X$h.CLEARFLAG_SOLIDCOLOR=0,X$h.CLEARFLAG_SKY=1,X$h.CLEARFLAG_DEPTHONLY=2,X$h.CLEARFLAG_NONE=3,X$F(X$h,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new X$mp(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new X$mp},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new X$mp}]),X$h}(X$_p),X$Vp=function(X$h){function X$p(X$m){this._render=null,this._geometryFilter=null,X$p.__super.call(this,X$m)}X$$(X$p,"laya.d3.core.RenderableSprite3D",X$h);var X$m=X$p.prototype;return X$m._addToInitStaticBatchManager=function(){},X$m._setBelongScene=function(X$m){X$h.prototype._setBelongScene.call(this,X$m),X$m._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},X$m._setUnBelongScene=function(){var X$m=this._scene._renderableSprite3Ds,X$p=X$m.indexOf(this);X$m.splice(X$p,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),X$h.prototype._setUnBelongScene.call(this)},X$m._update=function(X$m){(X$m.owner=this)._activeInHierarchy&&(this._updateComponents(X$m),this._render._updateOctreeNode(),this._lateUpdateComponents(X$m),X$I.spriteCount++,this._childs.length&&this._updateChilds(X$m))},X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),X$h.prototype.destroy.call(this,X$m),this._render._destroy(),this._render=null},X$p.__init__=function(){X$p.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=X$p.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),X$p.SAHDERDEFINE_LIGHTMAP=X$p.shaderDefines.registerDefine("LIGHTMAP")},X$p.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,X$p.SAHDERDEFINE_LIGHTMAP=4,X$p.LIGHTMAPSCALEOFFSET=2,X$p.LIGHTMAP=3,X$F(X$p,["shaderDefines",function(){return this.shaderDefines=new X$Dp}]),X$p}(X$_p),X$op=(function(X$m){function X$P(X$m,X$p,X$h){this._long=NaN,this._width=NaN,this._height=NaN,void 0===X$m&&(X$m=1),void 0===X$p&&(X$p=1),void 0===X$h&&(X$h=1),X$P.__super.call(this),this._long=X$m,this._width=X$p,this._height=X$h,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}X$$(X$P,"laya.d3.resource.models.BoxMesh",X$sp);var X$p=X$P.prototype;X$p.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var X$m=X$Qm.vertexDeclaration,X$p=(X$m.vertexStride,this._long/2),X$h=this._height/2,X$P=this._width/2,X$L=new Float32Array([-X$p,X$h,-X$P,0,1,0,0,0,X$p,X$h,-X$P,0,1,0,1,0,X$p,X$h,X$P,0,1,0,1,1,-X$p,X$h,X$P,0,1,0,0,1,-X$p,-X$h,-X$P,0,-1,0,0,1,X$p,-X$h,-X$P,0,-1,0,1,1,X$p,-X$h,X$P,0,-1,0,1,0,-X$p,-X$h,X$P,0,-1,0,0,0,-X$p,X$h,-X$P,-1,0,0,0,0,-X$p,X$h,X$P,-1,0,0,1,0,-X$p,-X$h,X$P,-1,0,0,1,1,-X$p,-X$h,-X$P,-1,0,0,0,1,X$p,X$h,-X$P,1,0,0,1,0,X$p,X$h,X$P,1,0,0,0,0,X$p,-X$h,X$P,1,0,0,0,1,X$p,-X$h,-X$P,1,0,0,1,1,-X$p,X$h,X$P,0,0,1,0,0,X$p,X$h,X$P,0,0,1,1,0,X$p,-X$h,X$P,0,0,1,1,1,-X$p,-X$h,X$P,0,0,1,0,1,-X$p,X$h,-X$P,0,0,-1,1,0,X$p,X$h,-X$P,0,0,-1,0,0,X$p,-X$h,-X$P,0,0,-1,0,1,-X$p,-X$h,-X$P,0,0,-1,1,1]),X$q=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new X$wp(X$m,this._numberVertices,35044,!0),this._indexBuffer=new X$zp("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(X$L),this._indexBuffer.setData(X$q),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},X$A(0,X$p,"long",function(){return this._long},function(X$m){this._long!==X$m&&(this._long=X$m,this.releaseResource(),this.activeResource())}),X$A(0,X$p,"width",function(){return this._width},function(X$m){this._width!==X$m&&(this._width=X$m,this.releaseResource(),this.activeResource())}),X$A(0,X$p,"height",function(){return this._height},function(X$m){this._height!==X$m&&(this._height=X$m,this.releaseResource(),this.activeResource())})}(),function(X$m){function X$L(X$m,X$p,X$h,X$P){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===X$m&&(X$m=10),void 0===X$p&&(X$p=10),void 0===X$h&&(X$h=10),void 0===X$P&&(X$P=10),X$L.__super.call(this),this._long=X$m,this._width=X$p,this._stacks=X$h,this._slices=X$P,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}X$$(X$L,"laya.d3.resource.models.PlaneMesh",X$sp);var X$p=X$L.prototype;X$p.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var X$m=new Uint16Array(this._numberIndices),X$p=X$Qm.vertexDeclaration,X$h=X$p.vertexStride/4,X$P=new Float32Array(this._numberVertices*X$h),X$L=this._long/2,X$q=this._width/2,X$k=this._long/this._stacks,X$Y=this._width/this._slices,X$d=0,X$K=0;X$K<=this._slices;X$K++)for(var X$D=0;X$D<=this._stacks;X$D++)X$P[X$d++]=X$D*X$k-X$L,X$P[X$d++]=0,X$P[X$d++]=X$K*X$Y-X$q,X$P[X$d++]=0,X$P[X$d++]=1,X$P[X$d++]=0,X$P[X$d++]=1*X$D/this._stacks,X$P[X$d++]=1*X$K/this._slices;var X$F=0;for(X$K=0;X$K<this._slices;X$K++)for(X$D=0;X$D<this._stacks;X$D++)X$m[X$F++]=(X$K+1)*(this._stacks+1)+X$D,X$m[X$F++]=X$K*(this._stacks+1)+X$D,X$m[X$F++]=(X$K+1)*(this._stacks+1)+X$D+1,X$m[X$F++]=X$K*(this._stacks+1)+X$D,X$m[X$F++]=X$K*(this._stacks+1)+X$D+1,X$m[X$F++]=(X$K+1)*(this._stacks+1)+X$D+1;this._vertexBuffer=new X$wp(X$p,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new X$zp("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData(X$P),this._indexBuffer.setData(X$m),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},X$A(0,X$p,"long",function(){return this._long},function(X$m){this._long!==X$m&&(this._long=X$m,this.releaseResource(),this.activeResource())}),X$A(0,X$p,"width",function(){return this._width},function(X$m){this._width!==X$m&&(this._width=X$m,this.releaseResource(),this.activeResource())}),X$A(0,X$p,"stacks",function(){return this._stacks},function(X$m){this._stacks!==X$m&&(this._stacks=X$m,this.releaseResource(),this.activeResource())}),X$A(0,X$p,"slices",function(){return this._slices},function(X$m){this._slices!==X$m&&(this._slices=X$m,this.releaseResource(),this.activeResource())})}(),function(X$m){function X$k(X$m,X$p,X$h){void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=.3),void 0===X$h&&(X$h=1e3),this._viewMatrix=new X$mp,this._projectionMatrix=new X$mp,this._projectionViewMatrix=new X$mp,this._viewport=new X$dp(0,0,0,0),this._normalizedViewport=new X$dp(0,0,1,1),this._aspectRatio=X$m,this._boundFrustumUpdate=!0,this._boundFrustum=new X$gm(X$mp.DEFAULT),X$k.__super.call(this,X$p,X$h),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}X$$(X$k,"laya.d3.core.Camera",X$yp);var X$p=X$k.prototype;return X$p._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},X$p._parseCustomProps=function(X$m,X$p,X$h,X$P){var X$L=X$h.clearColor;this.clearColor=new X$Yp(X$L[0],X$L[1],X$L[2],X$L[3]);var X$q=X$h.viewport;this.normalizedViewport=new X$dp(X$q[0],X$q[1],X$q[2],X$q[3])},X$p._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var X$m=this.orthographicVerticalSize*this.aspectRatio*.5,X$p=.5*this.orthographicVerticalSize;X$mp.createOrthoOffCenterRH(-X$m,X$m,-X$p,X$p,this.nearPlane,this.farPlane,this._projectionMatrix)}else X$mp.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},X$p._update=function(X$m){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,X$m)},X$p._renderCamera=function(X$m,X$p,X$h){var X$P,X$L;X$h.parallelSplitShadowMaps[0]&&X$h._renderShadowMap(X$m,X$p,this),(X$p.camera=this)._prepareCameraToRender(),X$h._preRenderUpdateComponents(X$p),X$P=X$p._viewMatrix=this.viewMatrix;var X$q=this._renderTarget;X$q?(X$q.start(),X$mp.multiply(X$yp._invertYScaleMatrix,this._projectionMatrix,X$yp._invertYProjectionMatrix),X$mp.multiply(X$yp._invertYScaleMatrix,this.projectionViewMatrix,X$yp._invertYProjectionViewMatrix),X$L=X$p._projectionMatrix=X$yp._invertYProjectionMatrix,X$p._projectionViewMatrix=X$yp._invertYProjectionViewMatrix):(X$L=X$p._projectionMatrix=this._projectionMatrix,X$p._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(X$P,X$L),X$p._viewport=this.viewport,X$h._preRenderScene(X$m,X$p,this.boundFrustum),X$h._clear(X$m,X$p),X$h._renderScene(X$m,X$p),X$h._postRenderUpdateComponents(X$p),X$q&&X$q.end()},X$p.viewportPointToRay=function(X$m,X$p){X$Ap.calculateCursorRay(X$m,this.viewport,this._projectionMatrix,this.viewMatrix,null,X$p)},X$p.normalizedViewportPointToRay=function(X$m,X$p){var X$h=X$k._tempVector20,X$P=this.viewport,X$L=X$m.elements,X$q=X$h.elements;X$q[0]=X$L[0]*X$P.width,X$q[1]=X$L[1]*X$P.height,X$Ap.calculateCursorRay(X$h,this.viewport,this._projectionMatrix,this.viewMatrix,null,X$p)},X$p.worldToViewportPoint=function(X$m,X$p){X$mp.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(X$m,this._projectionViewMatrix,X$p);var X$h=X$p.elements;X$h[0]=X$h[0]/X$H.stage.clientScaleX,X$h[1]=X$h[1]/X$H.stage.clientScaleY},X$p.worldToNormalizedViewportPoint=function(X$m,X$p){X$mp.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(X$m,this._projectionViewMatrix,X$p);var X$h=X$p.elements;X$h[0]=X$h[0]/X$H.stage.clientScaleX,X$h[1]=X$h[1]/X$H.stage.clientScaleY},X$p.convertScreenCoordToOrthographicCoord=function(X$m,X$p){if(this._orthographic){var X$h=X$i.clientWidth,X$P=X$i.clientHeight,X$L=this.orthographicVerticalSize*this.aspectRatio/X$h,X$q=this.orthographicVerticalSize/X$P,X$k=X$m.elements,X$Y=X$p.elements;return X$Y[0]=(-X$h/2+X$k[0])*X$L,X$Y[1]=(X$P/2-X$k[1])*X$q,X$Y[2]=(this.nearPlane-this.farPlane)*(X$k[2]+1)/2-this.nearPlane,X$kp.transformCoordinate(X$p,this.transform.worldMatrix,X$p),!0}return!1},X$A(0,X$p,"projectionViewMatrix",function(){return X$mp.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),X$A(0,X$p,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var X$m=this.viewport;return X$m.width/X$m.height},function(X$m){if(X$m<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=X$m,this._calculateProjectionMatrix()}),X$A(0,X$p,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),X$A(0,X$p,"needViewport",function(){var X$m=this.normalizedViewport;return 0===X$m.x&&0===X$m.y&&1===X$m.width&&1===X$m.height}),X$A(0,X$p,"viewport",function(){if(this._viewportExpressedInClipSpace){var X$m=this._normalizedViewport,X$p=this.renderTargetSize,X$h=X$p.width,X$P=X$p.height;this._viewport.x=X$m.x*X$h,this._viewport.y=X$m.y*X$P,this._viewport.width=X$m.width*X$h,this._viewport.height=X$m.height*X$P}return this._viewport},function(X$m){if(null!=this.renderTarget&&(X$m.x<0||X$m.y<0||0==X$m.width||0==X$m.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=X$m,this._calculateProjectionMatrix()}),X$A(0,X$p,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var X$m=this._viewport,X$p=this.renderTargetSize,X$h=X$p.width,X$P=X$p.height;this._normalizedViewport.x=X$m.x/X$h,this._normalizedViewport.y=X$m.y/X$P,this._normalizedViewport.width=X$m.width/X$h,this._normalizedViewport.height=X$m.height/X$P}return this._normalizedViewport},function(X$m){X$m.x<0&&(X$m.x=0,console.warn("Camera: viewport.x must large than 0.0.")),X$m.y<0&&(X$m.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<X$m.x+X$m.width&&(X$m.width=1-X$m.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<X$m.y+X$m.height&&(X$m.height=1-X$m.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=X$m,this._calculateProjectionMatrix()}),X$A(0,X$p,"projectionMatrix",function(){return this._projectionMatrix},function(X$m){this._projectionMatrix=X$m,this._useUserProjectionMatrix=!0}),X$A(0,X$p,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),X$F(X$k,["_tempVector20",function(){return this._tempVector20=new X$qp}]),X$k}()),X$fp=function(X$h){function X$P(X$m,X$p){X$P.__super.call(this,X$p),this._geometryFilter=new X$up(this),this._render=new X$Np(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),X$m&&(this._geometryFilter.sharedMesh=X$m)instanceof laya.d3.resource.models.Mesh&&(X$m.loaded?this._render.sharedMaterials=X$m.materials:X$m.once("loaded",this,this._applyMeshMaterials))}X$$(X$P,"laya.d3.core.MeshSprite3D",X$h);var X$m=X$P.prototype;return X$m._changeRenderObjectByMesh=function(X$m){var X$p=this._render._renderElements,X$h=X$p[X$m];X$h||(X$h=X$p[X$m]=new X$Ep),X$h._render=this._render;var X$P=this._render.sharedMaterials[X$m];X$P||(X$P=X$Jp.defaultMaterial);var X$L=this._geometryFilter.sharedMesh.getRenderElement(X$m);return X$h._mainSortID=this._getSortID(X$L,X$P),X$h._sprite3D=this,X$h.renderObj=X$L,X$h._material=X$P,X$h},X$m._changeRenderObjectByMaterial=function(X$m,X$p){var X$h=this._render._renderElements[X$m];X$p||(X$p=X$Jp.defaultMaterial);var X$P=this._geometryFilter.sharedMesh.getRenderElement(X$m);return X$h._mainSortID=this._getSortID(X$P,X$p),X$h._sprite3D=this,X$h.renderObj=X$P,X$h._material=X$p,X$h},X$m._changeRenderObjectsByMesh=function(){var X$m=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=X$m;for(var X$p=0;X$p<X$m;X$p++)this._changeRenderObjectByMesh(X$p)},X$m._onMeshChanged=function(X$m){var X$p=X$m.sharedMesh;X$p.loaded?this._changeRenderObjectsByMesh():X$p.once("loaded",this,this._onMeshLoaded)},X$m._onMeshLoaded=function(X$m){X$m===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},X$m._onMaterialChanged=function(X$m,X$p,X$h){X$p<this._render._renderElements.length&&this._changeRenderObjectByMaterial(X$p,X$h)},X$m._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},X$m._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},X$m._parseCustomProps=function(X$m,X$p,X$h,X$P){var X$L=this.meshRender,X$q=X$h.lightmapIndex;null!=X$q&&(X$L.lightmapIndex=X$q);var X$k,X$Y,X$d=X$h.lightmapScaleOffset;if(X$d&&(X$L.lightmapScaleOffset=new X$Yp(X$d[0],X$d[1],X$d[2],X$d[3])),X$P.instanceParams)(X$k=X$P.instanceParams.loadPath)&&(X$Y=X$c.getRes(X$p[X$k]),(this.meshFilter.sharedMesh=X$Y).loaded?X$L.sharedMaterials=X$Y.materials:X$Y.once("loaded",this,this._applyMeshMaterials));else{(X$k=X$h.meshPath)&&(X$Y=X$c.getRes(X$p[X$k]),this.meshFilter.sharedMesh=X$Y);var X$K=X$h.materials;if(X$K){var X$D=X$L.sharedMaterials,X$F=X$K.length;X$D.length=X$F;for(var X$R=0;X$R<X$F;X$R++)X$D[X$R]=X$c.getRes(X$p[X$K[X$R].path]);X$L.sharedMaterials=X$D}}},X$m._applyMeshMaterials=function(X$m){for(var X$p=this._render.sharedMaterials,X$h=X$m.materials,X$P=0,X$L=X$h.length;X$P<X$L;X$P++)X$p[X$P]||(X$p[X$P]=X$h[X$P]);this._render.sharedMaterials=X$p},X$m._addToInitStaticBatchManager=function(){X$P._staticBatchManager._addInitBatchSprite(this)},X$m.cloneTo=function(X$m){var X$p=X$m;X$p._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var X$h=this._render,X$P=X$p._render;X$P.enable=X$h.enable,X$P.sharedMaterials=X$h.sharedMaterials,X$P.castShadow=X$h.castShadow;var X$L=X$h.lightmapScaleOffset;X$L&&(X$P.lightmapScaleOffset=X$L.clone()),X$P.lightmapIndex=X$h.lightmapIndex,X$P.receiveShadow=X$h.receiveShadow,X$P.sortingFudge=X$h.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,X$m)},X$m.destroy=function(X$m){if(void 0===X$m&&(X$m=!0),!this.destroyed){var X$p=this.meshFilter.sharedMesh;null!=X$p&&(X$p.loaded||X$p.off("loaded",this,this._applyMeshMaterials)),X$h.prototype.destroy.call(this,X$m),this._geometryFilter._destroy()}},X$A(0,X$m,"meshFilter",function(){return this._geometryFilter}),X$A(0,X$m,"meshRender",function(){return this._render}),X$P.__init__=function(){X$Pm._staticBatchManagers.push(X$P._staticBatchManager)},X$P.load=function(X$m){return X$H.loader.create(X$m,null,null,X$P)},X$F(X$P,["_staticBatchManager",function(){return this._staticBatchManager=new X$bp}]),X$P}(X$Vp)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(X$m,X$p){"use strict";for(var X$h in Object.defineProperty(X$p,"__esModule",{value:!0}),Laya){var X$P=Laya[X$h];X$P&&X$P.__isclass&&(X$p[X$h]=X$P)}}),function(X$m,X$p,X$Lm){X$Lm.un,X$Lm.uns;var X$h=X$Lm.static,X$P=X$Lm.class,X$q=X$Lm.getset,X$B=X$Lm.__newvec,X$Y=laya.maths.Bezier,X$F=laya.utils.Browser,X$Qm=laya.utils.Byte,X$L=(laya.events.Event,laya.events.EventDispatcher),X$k=laya.display.Graphics,X$d=(laya.resource.HTMLCanvas,laya.utils.Handler),X$K=laya.net.Loader,X$R=laya.maths.MathUtil,X$Mm=laya.maths.Matrix,X$n=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),X$D=(laya.renders.RenderContext,laya.resource.Resource),X$$=laya.utils.RunDriver,X$qm=laya.display.Sprite,X$A=laya.utils.Stat,X$um=laya.resource.Texture,X$c=(laya.net.URL,laya.utils.Utils),X$M=function(){function X$m(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return X$P(X$m,"laya.ani.AnimationContent"),X$m}(),X$u=function(){function X$m(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return X$P(X$m,"laya.ani.AnimationNodeContent"),X$m}(),X$a=function(){function X$m(){}return X$P(X$m,"laya.ani.AnimationParser01"),X$m.parse=function(X$m,X$p){var X$h=X$p.__getBuffer(),X$P=0,X$L=0,X$q=0,X$k=0,X$Y=0,X$d=0,X$K=0,X$D=X$p.readUTFString();X$m._aniClassName=X$D;var X$F,X$R=X$p.readUTFString().split("\n"),X$$=X$p.getUint8(),X$A=X$p.getUint32(),X$B=X$p.getUint32();0<X$A&&(X$F=X$h.slice(X$A,X$B));var X$n=new X$Qm(X$F);for(0<X$B&&(X$m._publicExtData=X$h.slice(X$B,X$h.byteLength)),X$m._useParent=!!X$p.getUint8(),X$m._anis.length=X$$,X$P=0;X$P<X$$;X$P++){var X$c=X$m._anis[X$P]=new X$M;X$c.nodes=new Array;var X$e=X$c.name=X$R[X$p.getUint16()];X$m._aniMap[X$e]=X$P,X$c.bone3DMap={},X$c.playTime=X$p.getFloat32(),X$c.playTime<=0&&console.error("播放时间不能为0  url="+X$m.url+" name="+X$c.name);var X$a=X$c.nodes.length=X$p.getUint8();for(X$L=X$c.totalKeyframeDatasLength=0;X$L<X$a;X$L++){var X$Z=X$c.nodes[X$L]=new X$u;X$Z.childs=[];var X$H=X$p.getInt16();0<=X$H&&(X$Z.name=X$R[X$H],X$c.bone3DMap[X$Z.name]=X$L),X$Z.keyFrame=new Array,X$Z.parentIndex=X$p.getInt16(),-1==X$Z.parentIndex?X$Z.parent=null:X$Z.parent=X$c.nodes[X$Z.parentIndex],X$Z.lerpType=X$p.getUint8();var X$W=X$p.getUint32();X$n.pos=X$W;var X$E=X$Z.keyframeWidth=X$n.getUint16();if(X$c.totalKeyframeDatasLength+=X$E,0===X$Z.lerpType||1===X$Z.lerpType)for(X$Z.interpolationMethod=[],X$Z.interpolationMethod.length=X$E,X$q=0;X$q<X$E;X$q++)X$Z.interpolationMethod[X$q]=X$_.interpolation[X$n.getUint8()];null!=X$Z.parent&&X$Z.parent.childs.push(X$Z);var X$I=X$p.getUint16();0<X$I&&(X$Z.extenData=X$h.slice(X$p.pos,X$p.pos+X$I),X$p.pos+=X$I);var X$b,X$T=X$p.getUint16(),X$j=0;for(X$q=0,X$k=X$Z.keyFrame.length=X$T;X$q<X$k;X$q++){if((X$b=X$Z.keyFrame[X$q]=new X$N).duration=X$p.getFloat32(),X$b.startTime=X$j,2===X$Z.lerpType){X$b.interpolationData=[];var X$x,X$Q=X$p.getUint8();switch(X$x=X$p.getFloat32()){case 254:for(X$b.interpolationData.length=X$E,X$K=0;X$K<X$E;X$K++)X$b.interpolationData[X$K]=0;break;case 255:for(X$b.interpolationData.length=X$E,X$K=0;X$K<X$E;X$K++)X$b.interpolationData[X$K]=5;break;default:for(X$b.interpolationData.push(X$x),X$d=1;X$d<X$Q;X$d++)X$b.interpolationData.push(X$p.getFloat32())}}for(X$b.data=new Float32Array(X$E),X$Y=0;X$Y<X$E;X$Y++)X$b.data[X$Y]=X$p.getFloat32(),-1e-8<X$b.data[X$Y]&&X$b.data[X$Y]<1e-8&&(X$b.data[X$Y]=0);X$j+=X$b.duration}X$b.startTime=X$c.playTime,X$Z.playTime=X$c.playTime,X$m._calculateKeyFrame(X$Z,X$T,X$E)}}},X$m}(),X$Z=function(){function X$H(){}return X$P(X$H,"laya.ani.AnimationParser02"),X$H.READ_DATA=function(){X$H._DATA.offset=X$H._reader.getUint32(),X$H._DATA.size=X$H._reader.getUint32()},X$H.READ_BLOCK=function(){for(var X$m=X$H._BLOCK.count=X$H._reader.getUint16(),X$p=X$H._BLOCK.blockStarts=[],X$h=X$H._BLOCK.blockLengths=[],X$P=0;X$P<X$m;X$P++)X$p.push(X$H._reader.getUint32()),X$h.push(X$H._reader.getUint32())},X$H.READ_STRINGS=function(){var X$m=X$H._reader.getUint32(),X$p=X$H._reader.getUint16(),X$h=X$H._reader.pos;X$H._reader.pos=X$m+X$H._DATA.offset;for(var X$P=0;X$P<X$p;X$P++)X$H._strings[X$P]=X$H._reader.readUTFString();X$H._reader.pos=X$h},X$H.parse=function(X$m,X$p){X$H._templet=X$m;(X$H._reader=X$p).__getBuffer();X$H.READ_DATA(),X$H.READ_BLOCK(),X$H.READ_STRINGS();for(var X$h=0,X$P=X$H._BLOCK.count;X$h<X$P;X$h++){var X$L=X$p.getUint16(),X$q=X$H._strings[X$L],X$k=X$H["READ_"+X$q];if(null==X$k)throw new Error("model file err,no this function:"+X$L+" "+X$q);X$k.call()}},X$H.READ_ANIMATIONS=function(){var X$m=X$H._reader,X$p=X$m.__getBuffer(),X$h=0,X$P=0,X$L=0,X$q=0,X$k=X$m.getUint16(),X$Y=[];for(X$Y.length=X$k,X$h=0;X$h<X$k;X$h++)X$Y[X$h]=X$_.interpolation[X$m.getByte()];var X$d=X$m.getUint8();for(X$H._templet._anis.length=X$d,X$h=0;X$h<X$d;X$h++){var X$K=X$H._templet._anis[X$h]={};X$K.nodes=new Array;var X$D=X$K.name=X$H._strings[X$m.getUint16()];X$H._templet._aniMap[X$D]=X$h,X$K.bone3DMap={},X$K.playTime=X$m.getFloat32();var X$F=X$K.nodes.length=X$m.getInt16();for(X$P=X$K.totalKeyframeDatasLength=0;X$P<X$F;X$P++){var X$R=X$K.nodes[X$P]={};X$R.keyframeWidth=X$k,X$R.childs=[];var X$$=X$m.getUint16();0<=X$$&&(X$R.name=X$H._strings[X$$],X$K.bone3DMap[X$R.name]=X$P),X$R.keyFrame=new Array,X$R.parentIndex=X$m.getInt16(),-1==X$R.parentIndex?X$R.parent=null:X$R.parent=X$K.nodes[X$R.parentIndex],X$K.totalKeyframeDatasLength+=X$k,X$R.interpolationMethod=X$Y,null!=X$R.parent&&X$R.parent.childs.push(X$R);var X$A=X$m.getUint16(),X$B=null,X$n=null;for(X$L=0,X$q=X$R.keyFrame.length=X$A;X$L<X$q;X$L++){(X$B=X$R.keyFrame[X$L]={}).startTime=X$m.getFloat32(),X$n&&(X$n.duration=X$B.startTime-X$n.startTime);var X$c=X$H._DATA.offset,X$e=X$m.getUint32(),X$a=4*X$k,X$Z=X$p.slice(X$c+X$e,X$c+X$e+X$a);X$B.data=new Float32Array(X$Z),X$n=X$B}X$B.duration=0,X$R.playTime=X$K.playTime,X$H._templet._calculateKeyFrame(X$R,X$A,X$k)}}},X$H._templet=null,X$H._reader=null,X$H._strings=[],X$h(X$H,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),X$H}(),X$Nm=(function(){function X$m(){}X$P(X$m,"laya.ani.AnimationState"),X$m.stopped=0,X$m.paused=1,X$m.playing=2}(),function(){function X$L(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new X$Vm,this.resultMatrix=new X$Mm,this._children=[]}X$P(X$L,"laya.ani.bone.Bone");var X$m=X$L.prototype;return X$m.setTempMatrix=function(X$m){this._tempMatrix=X$m;var X$p,X$h=0;for(X$h=0,X$p=this._children.length;X$h<X$p;X$h++)this._children[X$h].setTempMatrix(this._tempMatrix)},X$m.update=function(X$m){var X$p;if(this.rotation=this.transform.skX,X$m)X$p=this.resultTransform.getMatrix(),X$Mm.mul(X$p,X$m,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)X$p=this.resultTransform.getMatrix(),X$Mm.mul(X$p,this.parentBone.resultMatrix,this.resultMatrix);else{var X$h=this.parentBone,X$P=NaN,X$L=NaN,X$q=NaN,X$k=this.parentBone.resultMatrix;X$p=this.resultTransform.getMatrix();var X$Y=X$k.a*X$p.tx+X$k.c*X$p.ty+X$k.tx,X$d=X$k.b*X$p.tx+X$k.d*X$p.ty+X$k.ty,X$K=new X$Mm;this.inheritRotation?(X$P=Math.atan2(X$h.resultMatrix.b,X$h.resultMatrix.a),X$L=Math.cos(X$P),X$q=Math.sin(X$P),X$K.setTo(X$L,X$q,-X$q,X$L,0,0),X$Mm.mul(this._tempMatrix,X$K,X$Mm.TEMP),X$Mm.TEMP.copyTo(X$K),X$p=this.resultTransform.getMatrix(),X$Mm.mul(X$p,X$K,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,X$p=this.resultTransform.getMatrix(),X$Mm.TEMP.identity(),X$Mm.TEMP.d=this.d,X$Mm.mul(X$p,X$Mm.TEMP,this.resultMatrix)),this.resultMatrix.tx=X$Y,this.resultMatrix.ty=X$d}else(X$p=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var X$D,X$F=0;for(X$F=0,X$D=this._children.length;X$F<X$D;X$F++)this._children[X$F].update()},X$m.updateChild=function(){var X$m,X$p=0;for(X$p=0,X$m=this._children.length;X$p<X$m;X$p++)this._children[X$p].update()},X$m.setRotation=function(X$m){this._sprite&&(this._sprite.rotation=180*X$m/Math.PI)},X$m.updateDraw=function(X$m,X$p){X$L.ShowBones&&!X$L.ShowBones[this.name]||(this._sprite||(this._sprite=new X$qm,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),X$Lm.stage.addChild(this._sprite)),this._sprite.x=X$m+this.resultMatrix.tx,this._sprite.y=X$p+this.resultMatrix.ty);var X$h,X$P=0;for(X$P=0,X$h=this._children.length;X$P<X$h;X$P++)this._children[X$P].updateDraw(X$m,X$p)},X$m.addChild=function(X$m){this._children.push(X$m),X$m.parentBone=this},X$m.findBone=function(X$m){if(this.name==X$m)return this;var X$p,X$h,X$P=0;for(X$P=0,X$p=this._children.length;X$P<X$p;X$P++)if(X$h=this._children[X$P].findBone(X$m))return X$h;return null},X$m.localToWorld=function(X$m){var X$p=X$m[0],X$h=X$m[1];X$m[0]=X$p*this.resultMatrix.a+X$h*this.resultMatrix.c+this.resultMatrix.tx,X$m[1]=X$p*this.resultMatrix.b+X$h*this.resultMatrix.d+this.resultMatrix.ty},X$L.ShowBones={},X$L}()),X$Sm=function(){function X$B(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}X$P(X$B,"laya.ani.bone.BoneSlot");var X$m=X$B.prototype;return X$m.showSlotData=function(X$m,X$p){void 0===X$p&&(X$p=!0),this.currSlotData=X$m,X$p&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},X$m.showDisplayByName=function(X$m){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(X$m))},X$m.replaceDisplayByName=function(X$m,X$p){if(this.currSlotData){var X$h;X$h=this.currSlotData.getDisplayByName(X$m);var X$P;X$P=this.currSlotData.getDisplayByName(X$p),this.replaceDisplayByIndex(X$h,X$P)}},X$m.replaceDisplayByIndex=function(X$m,X$p){this.currSlotData&&(this._replaceDic[X$m]=X$p,this.displayIndex==X$m&&this.showDisplayByIndex(X$m))},X$m.showDisplayByIndex=function(X$m){if(null!=this._replaceDic[X$m]&&(X$m=this._replaceDic[X$m]),this.currSlotData&&-1<X$m&&X$m<this.currSlotData.displayArr.length){if(this.displayIndex=X$m,this.currDisplayData=this.currSlotData.displayArr[X$m],this.currDisplayData){var X$p=this.currDisplayData.name;this.currTexture=this.templet.getTexture(X$p),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!X$n.isConchApp||X$n.isConchApp&&"0.9.15"<X$qm.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},X$m.replaceSkin=function(X$m){this._diyTexture=X$m,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},X$m.setParentMatrix=function(X$m){this._parentMatrix=X$m},X$m.draw=function(X$m,X$p,X$h,X$P){if(void 0===X$h&&(X$h=!1),void 0===X$P&&(X$P=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var X$L,X$q=this.currTexture;switch(this._diyTexture&&(X$q=this._diyTexture),this.currDisplayData.type){case 0:if(X$m){var X$k=this.getDisplayMatrix();if(this._parentMatrix){var X$Y=!1;if(X$k){var X$d;if(X$Mm.mul(X$k,this._parentMatrix,X$Mm.TEMP),X$d=X$h?(null==this._resultMatrix&&(this._resultMatrix=new X$Mm),this._resultMatrix):new X$Mm,!X$n.isWebGL&&this.currDisplayData.uvs||X$n.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var X$K=X$B._tempMatrix;X$K.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(X$K.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(X$Y=!0,X$K.rotate(-Math.PI/2)),X$Mm.mul(X$K,X$Mm.TEMP,X$d)}else X$Mm.TEMP.copyTo(X$d);X$Y?X$m.drawTexture(X$q,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,X$d):X$m.drawTexture(X$q,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,X$d)}}}break;case 1:if(null==(X$L=X$h?(null==this._skinSprite&&(this._skinSprite=X$B.createSkinMesh()),this._skinSprite):X$B.createSkinMesh()))return;var X$D;if(null==this.currDisplayData.bones){var X$F,X$R=this.currDisplayData.weights;this.deformData&&(X$R=this.deformData),X$F=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=X$E.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=X$E.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=X$R;this.currDisplayData.triangles.length;X$D=this.currDisplayData.triangles,X$L.init2(X$q,null,X$D,this._mVerticleArr,X$F);var X$$,X$A=this.getDisplayMatrix();if(this._parentMatrix)if(X$A)X$Mm.mul(X$A,this._parentMatrix,X$Mm.TEMP),X$$=X$h?(null==this._resultMatrix&&(this._resultMatrix=new X$Mm),this._resultMatrix):new X$Mm,X$Mm.TEMP.copyTo(X$$),X$L.transform=X$$}else this.skinMesh(X$p,X$L,X$P);X$m.drawSkin(X$L);break;case 2:if(null==(X$L=X$h?(null==this._skinSprite&&(this._skinSprite=X$B.createSkinMesh()),this._skinSprite):X$B.createSkinMesh()))return;this.skinMesh(X$p,X$L,X$P),X$m.drawSkin(X$L)}}},X$m.skinMesh=function(X$m,X$p,X$h){var X$P,X$L=this.currTexture,X$q=this.currDisplayData.bones;X$P=this._diyTexture?(X$L=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=X$E.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=X$E.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var X$k,X$Y,X$d=this.currDisplayData.weights,X$K=this.currDisplayData.triangles,X$D=0,X$F=0,X$R=0,X$$=NaN,X$A=NaN,X$B=0,X$n=0,X$c=[],X$e=0,X$a=0;if(this.deformData&&0<this.deformData.length){var X$Z=0;for(X$e=0,X$a=X$q.length;X$e<X$a;){for(X$R=X$q[X$e++]+X$e,X$F=X$D=0;X$e<X$R;X$e++)X$Y=X$m[X$q[X$e]],X$$=X$d[X$B]+this.deformData[X$Z++],X$A=X$d[X$B+1]+this.deformData[X$Z++],X$n=X$d[X$B+2],X$D+=(X$$*X$Y.a+X$A*X$Y.c+X$Y.tx)*X$n,X$F+=(X$$*X$Y.b+X$A*X$Y.d+X$Y.ty)*X$n,X$B+=3;X$c.push(X$D,X$F)}}else for(X$e=0,X$a=X$q.length;X$e<X$a;){for(X$R=X$q[X$e++]+X$e,X$F=X$D=0;X$e<X$R;X$e++)X$Y=X$m[X$q[X$e]],X$$=X$d[X$B],X$A=X$d[X$B+1],X$n=X$d[X$B+2],X$D+=(X$$*X$Y.a+X$A*X$Y.c+X$Y.tx)*X$n,X$F+=(X$$*X$Y.b+X$A*X$Y.d+X$Y.ty)*X$n,X$B+=3;X$c.push(X$D,X$F)}this._mVerticleArr=X$c,X$k=X$K,X$p.init2(X$L,null,X$k,this._mVerticleArr,X$P)},X$m.drawBonePoint=function(X$m){X$m&&this._parentMatrix&&X$m.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},X$m.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},X$m.getMatrix=function(){return this._resultMatrix},X$m.copy=function(){var X$m=new X$B;return X$m.type="copy",X$m.name=this.name,X$m.attachmentName=this.attachmentName,X$m.srcDisplayIndex=this.srcDisplayIndex,X$m.parent=this.parent,X$m.displayIndex=this.displayIndex,X$m.templet=this.templet,X$m.currSlotData=this.currSlotData,X$m.currTexture=this.currTexture,X$m.currDisplayData=this.currDisplayData,X$m},X$B.createSkinMesh=function(){return X$n.isWebGL||X$n.isConchApp?X$$.skinAniSprite():(X$n.isWebGL,null)},X$h(X$B,["_tempMatrix",function(){return this._tempMatrix=new X$Mm}]),X$B}(),X$_m=function(){function X$m(){this.skinName=null,this.deformSlotDataList=[]}return X$P(X$m,"laya.ani.bone.DeformAniData"),X$m}(),X$lm=function(){function X$m(){this.deformSlotDisplayList=[]}return X$P(X$m,"laya.ani.bone.DeformSlotData"),X$m}(),X$Jm=function(){function X$m(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}X$P(X$m,"laya.ani.bone.DeformSlotDisplayData");var X$p=X$m.prototype;return X$p.binarySearch1=function(X$m,X$p){var X$h=0,X$P=X$m.length-2;if(0==X$P)return 1;for(var X$L=X$P>>>1;;){if(X$m[Math.floor(X$L+1)]<=X$p?X$h=X$L+1:X$P=X$L,X$h==X$P)return X$h+1;X$L=X$h+X$P>>>1}return 0},X$p.apply=function(X$m,X$p,X$h){if(void 0===X$h&&(X$h=1),X$m+=.05,!(this.timeList.length<=0)){var X$P=0;if(!(X$m<this.timeList[0])){var X$L=this.vectices[0].length,X$q=[],X$k=this.binarySearch1(this.timeList,X$m);if(this.frameIndex=X$k,X$m>=this.timeList[this.timeList.length-1]){var X$Y=this.vectices[this.vectices.length-1];if(X$h<1)for(X$P=0;X$P<X$L;X$P++)X$q[X$P]+=(X$Y[X$P]-X$q[X$P])*X$h;else for(X$P=0;X$P<X$L;X$P++)X$q[X$P]=X$Y[X$P];this.deformData=X$q}else{this.tweenKeyList[this.frameIndex];var X$d=this.vectices[this.frameIndex-1],X$K=this.vectices[this.frameIndex],X$D=this.timeList[this.frameIndex-1],X$F=this.timeList[this.frameIndex];X$h=this.tweenKeyList[X$k-1]?(X$m-X$D)/(X$F-X$D):0;var X$R=NaN;for(X$P=0;X$P<X$L;X$P++)X$R=X$d[X$P],X$q[X$P]=X$R+(X$K[X$P]-X$R)*X$h;this.deformData=X$q}}}},X$m}(),X$zm=function(){function X$m(){this.time=NaN,this.drawOrder=[]}return X$P(X$m,"laya.ani.bone.DrawOrderData"),X$m}(),X$wm=function(){function X$m(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return X$P(X$m,"laya.ani.bone.EventData"),X$m}(),X$e=function(){function X$Pm(X$m,X$p){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=X$m,this._targetBone=X$p[X$m.targetBoneIndex],this.isSpine=X$m.isSpine,null==this._bones&&(this._bones=[]);for(var X$h=this._bones.length=0,X$P=X$m.boneIndexs.length;X$h<X$P;X$h++)this._bones.push(X$p[X$m.boneIndexs[X$h]]);this.name=X$m.name,this.mix=X$m.mix,this.bendDirection=X$m.bendDirection}X$P(X$Pm,"laya.ani.bone.IkConstraint");var X$m=X$Pm.prototype;return X$m.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},X$m._applyIk1=function(X$m,X$p,X$h,X$P){var X$L=X$m.parentBone,X$q=1/(X$L.resultMatrix.a*X$L.resultMatrix.d-X$L.resultMatrix.b*X$L.resultMatrix.c),X$k=X$p-X$L.resultMatrix.tx,X$Y=X$h-X$L.resultMatrix.ty,X$d=(X$k*X$L.resultMatrix.d-X$Y*X$L.resultMatrix.c)*X$q-X$m.transform.x,X$K=(X$Y*X$L.resultMatrix.a-X$k*X$L.resultMatrix.b)*X$q-X$m.transform.y,X$D=Math.atan2(X$K,X$d)*X$Pm.radDeg-0-X$m.transform.skX;X$m.transform.scX<0&&(X$D+=180),180<X$D?X$D-=360:X$D<-180&&(X$D+=360),X$m.transform.skX=X$m.transform.skY=X$m.transform.skX+X$D*X$P,X$m.update()},X$m.updatePos=function(X$m,X$p){this._sp&&this._sp.pos(X$m,X$p)},X$m._applyIk2=function(X$m,X$p,X$h,X$P,X$L,X$q){if(0!=X$q){var X$k=X$m.resultTransform.x,X$Y=X$m.resultTransform.y,X$d=X$m.transform.scX,X$K=X$m.transform.scY,X$D=X$p.transform.scX,X$F=0,X$R=0,X$$=0;X$$=X$d<0?(X$d=-X$d,X$F=180,-1):(X$F=0,1),X$K<0&&(X$K=-X$K,X$$=-X$$),X$R=X$D<0?(X$D=-X$D,180):0;var X$A=X$p.resultTransform.x,X$B=NaN,X$n=NaN,X$c=NaN,X$e=X$m.resultMatrix.a,X$a=X$m.resultMatrix.c,X$Z=X$m.resultMatrix.b,X$H=X$m.resultMatrix.d,X$W=Math.abs(X$d-X$K)<=1e-4;X$c=X$W?(X$n=X$e*X$A+X$a*(X$B=X$p.resultTransform.y)+X$m.resultMatrix.tx,X$Z*X$A+X$H*X$B+X$m.resultMatrix.ty):(X$B=0,X$n=X$e*X$A+X$m.resultMatrix.tx,X$Z*X$A+X$m.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new X$qm,X$Lm.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(X$h,X$P,15,"#ffff00"),this._sp.graphics.drawCircle(X$n,X$c,15,"#ff00ff")),X$m.setRotation(Math.atan2(X$c-X$m.resultMatrix.ty,X$n-X$m.resultMatrix.tx));var X$E=X$m.parentBone;X$e=X$E.resultMatrix.a,X$a=X$E.resultMatrix.c,X$Z=X$E.resultMatrix.b;var X$I=1/(X$e*(X$H=X$E.resultMatrix.d)-X$a*X$Z),X$b=X$h-X$E.resultMatrix.tx,X$T=X$P-X$E.resultMatrix.ty,X$j=(X$b*X$H-X$T*X$a)*X$I-X$k,X$x=(X$T*X$e-X$b*X$Z)*X$I-X$Y,X$Q=((X$b=X$n-X$E.resultMatrix.tx)*X$H-(X$T=X$c-X$E.resultMatrix.ty)*X$a)*X$I-X$k,X$M=(X$T*X$e-X$b*X$Z)*X$I-X$Y,X$u=Math.sqrt(X$Q*X$Q+X$M*X$M),X$N=X$p.length*X$D,X$S=NaN,X$_=NaN;if(X$W){var X$l=(X$j*X$j+X$x*X$x-X$u*X$u-(X$N*=X$d)*X$N)/(2*X$u*X$N);X$l<-1?X$l=-1:1<X$l&&(X$l=1),X$_=Math.acos(X$l)*X$L,X$e=X$u+X$N*X$l,X$a=X$N*Math.sin(X$_),X$S=Math.atan2(X$x*X$e-X$j*X$a,X$j*X$e+X$x*X$a)}else{var X$J=(X$e=X$d*X$N)*X$e,X$z=(X$a=X$K*X$N)*X$a,X$w=X$j*X$j+X$x*X$x,X$X=Math.atan2(X$x,X$j),X$s=-2*X$z*X$u,X$G=X$z-X$J;if(0<(X$H=X$s*X$s-4*X$G*(X$Z=X$z*X$u*X$u+X$J*X$w-X$J*X$z))){var X$U=Math.sqrt(X$H);X$s<0&&(X$U=-X$U);var X$r=(X$U=-(X$s+X$U)/2)/X$G,X$y=X$Z/X$U,X$V=Math.abs(X$r)<Math.abs(X$y)?X$r:X$y;X$V*X$V<=X$w&&(X$T=Math.sqrt(X$w-X$V*X$V)*X$L,X$S=X$X-Math.atan2(X$T,X$V),X$_=Math.atan2(X$T/X$K,(X$V-X$u)/X$d))}var X$o=0,X$f=Number.MAX_VALUE,X$i=0,X$v=0,X$g=0,X$t=0,X$O=0,X$C=0;X$t<(X$H=(X$b=X$u+X$e)*X$b)&&(X$g=0,X$t=X$H,X$O=X$b),(X$H=(X$b=X$u-X$e)*X$b)<X$f&&(X$o=Math.PI,X$f=X$H,X$i=X$b);var X$mm=Math.acos(-X$e*X$u/(X$J-X$z));(X$H=(X$b=X$e*Math.cos(X$mm)+X$u)*X$b+(X$T=X$a*Math.sin(X$mm))*X$T)<X$f&&(X$o=X$mm,X$f=X$H,X$i=X$b,X$v=X$T),X$t<X$H&&(X$g=X$mm,X$t=X$H,X$O=X$b,X$C=X$T),X$_=X$w<=(X$f+X$t)/2?(X$S=X$X-Math.atan2(X$v*X$L,X$i),X$o*X$L):(X$S=X$X-Math.atan2(X$C*X$L,X$O),X$g*X$L)}var X$pm=Math.atan2(X$B,X$A)*X$$,X$hm=X$m.resultTransform.skX;180<(X$S=(X$S-X$pm)*X$Pm.radDeg+X$F-X$hm)?X$S-=360:X$S<-180&&(X$S+=360),X$m.resultTransform.x=X$k,X$m.resultTransform.y=X$Y,X$m.resultTransform.skX=X$m.resultTransform.skY=X$hm+X$S*X$q,X$hm=X$p.resultTransform.skX,180<(X$_=((X$_+X$pm)*X$Pm.radDeg-0)*X$$+X$R-(X$hm%=360))?X$_-=360:X$_<-180&&(X$_+=360),X$p.resultTransform.x=X$A,X$p.resultTransform.y=X$B,X$p.resultTransform.skX=X$p.resultTransform.skY=X$p.resultTransform.skY+X$_*X$q,X$m.update()}},X$m._applyIk3=function(X$m,X$p,X$h,X$P,X$L,X$q){if(0!=X$q){var X$k,X$Y,X$d=X$p.resultMatrix.a*X$p.length,X$K=X$p.resultMatrix.b*X$p.length,X$D=X$d*X$d+X$K*X$K,X$F=Math.sqrt(X$D),X$R=X$m.resultMatrix.tx,X$$=X$m.resultMatrix.ty,X$A=X$p.resultMatrix.tx,X$B=X$p.resultMatrix.ty,X$n=X$A-X$R,X$c=X$B-X$$,X$e=X$n*X$n+X$c*X$c,X$a=Math.sqrt(X$e),X$Z=(X$n=X$h-X$m.resultMatrix.tx)*X$n+(X$c=X$P-X$m.resultMatrix.ty)*X$c,X$H=Math.sqrt(X$Z);if(X$F+X$a<=X$H||X$H+X$F<=X$a||X$H+X$a<=X$F){var X$W=NaN;X$A=X$R+(X$W=X$F+X$a<=X$H?1:-1)*(X$h-X$R)*X$a/X$H,X$B=X$$+X$W*(X$P-X$$)*X$a/X$H}else{var X$E=(X$e-X$D+X$Z)/(2*X$Z),X$I=Math.sqrt(X$e-X$E*X$E*X$Z)/X$H,X$b=X$R+X$n*X$E,X$T=X$$+X$c*X$E,X$j=-X$c*X$I,X$x=X$n*X$I;X$B=0<X$L?(X$A=X$b-X$j,X$T-X$x):(X$A=X$b+X$j,X$T+X$x)}X$k=X$A,X$Y=X$B,this.isDebug&&(this._sp||(this._sp=new X$qm,X$Lm.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(X$R,X$$,15,"#ff00ff"),this._sp.graphics.drawCircle(X$h,X$P,15,"#ffff00"),this._sp.graphics.drawCircle(X$k,X$Y,15,"#ff00ff"));var X$Q,X$M;X$Q=Math.atan2(X$Y-X$m.resultMatrix.ty,X$k-X$m.resultMatrix.tx),X$m.setRotation(X$Q),(X$M=X$Pm._tempMatrix).identity(),X$M.rotate(X$Q),X$M.scale(X$m.resultMatrix.getScaleX(),X$m.resultMatrix.getScaleY()),X$M.translate(X$m.resultMatrix.tx,X$m.resultMatrix.ty),X$M.copyTo(X$m.resultMatrix),X$m.updateChild();var X$u,X$N;X$u=Math.atan2(X$P-X$Y,X$h-X$k),X$p.setRotation(X$u),(X$N=X$Pm._tempMatrix).identity(),X$N.rotate(X$u),X$N.scale(X$p.resultMatrix.getScaleX(),X$p.resultMatrix.getScaleY()),X$N.translate(X$k,X$Y),X$M.copyTo(X$p.resultMatrix),X$p.updateChild()}},X$h(X$Pm,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new X$Mm}]),X$Pm}(),X$Xm=function(){function X$m(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return X$P(X$m,"laya.ani.bone.IkConstraintData"),X$m}(),X$H=function(){function X$N(X$m,X$p){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=X$m,this.position=X$m.position,this.spacing=X$m.spacing,this.rotateMix=X$m.rotateMix,this.translateMix=X$m.translateMix,this.bones=[];for(var X$h=this.data.bones,X$P=0,X$L=X$h.length;X$P<X$L;X$P++)this.bones.push(X$p[X$h[X$P]])}X$P(X$N,"laya.ani.bone.PathConstraint");var X$m=X$N.prototype;return X$m.apply=function(X$m,X$p){if(this.target){var X$h=this.translateMix,X$P=this.translateMix,X$L=0<X$P,X$q=this.data.spacingMode,X$k="length"==X$q,X$Y=this.data.rotateMode,X$d="tangent"==X$Y,X$K="chainScale"==X$Y,X$D=[],X$F=this.bones.length,X$R=X$d?X$F:X$F+1,X$$=[];(this._spaces=X$$)[0]=this.position;var X$A=this.spacing;if(X$K||X$k)for(var X$B=0,X$n=X$R-1;X$B<X$n;){var X$c=this.bones[X$B],X$e=X$c.length,X$a=X$e*X$c.resultMatrix.a,X$Z=X$e*X$c.resultMatrix.b;X$e=Math.sqrt(X$a*X$a+X$Z*X$Z),X$K&&(X$D[X$B]=X$e),X$$[++X$B]=X$k?Math.max(0,X$e+X$A):X$A}else for(X$B=1;X$B<X$R;X$B++)X$$[X$B]=X$A;var X$H=this.computeWorldPositions(this.target,X$m,X$p,X$R,X$d,"percent"==this.data.positionMode,"percent"==X$q);if(this._debugKey){for(X$B=0;X$B<X$H.length;X$B++)X$p.drawCircle(X$H[X$B++],X$H[X$B++],5,"#00ff00");var X$W=[];for(X$B=0;X$B<X$H.length;X$B++)X$W.push(X$H[X$B++],X$H[X$B++]);X$p.drawLines(0,0,X$W,"#ff0000")}var X$E=X$H[0],X$I=X$H[1],X$b=this.data.offsetRotation,X$T="chain"==X$Y&&0==X$b,X$j=NaN;for(X$B=0,X$j=3;X$B<X$F;X$B++,X$j+=3){(X$c=this.bones[X$B]).resultMatrix.tx+=(X$E-X$c.resultMatrix.tx)*X$h,X$c.resultMatrix.ty+=(X$I-X$c.resultMatrix.ty)*X$h;var X$x=(X$a=X$H[X$j])-X$E,X$Q=(X$Z=X$H[X$j+1])-X$I;if(X$K&&0!=(X$e=X$D[X$B])){var X$M=(Math.sqrt(X$x*X$x+X$Q*X$Q)/X$e-1)*X$P+1;X$c.resultMatrix.a*=X$M,X$c.resultMatrix.c*=X$M}if(X$E=X$a,X$I=X$Z,X$L){var X$u=X$c.resultMatrix.a,X$N=X$c.resultMatrix.c,X$S=X$c.resultMatrix.b,X$_=X$c.resultMatrix.d,X$l=NaN,X$J=NaN,X$z=NaN;X$l=X$d?X$H[X$j-1]:0==X$$[X$B+1]?X$H[X$j+2]:Math.atan2(X$Q,X$x),X$l-=Math.atan2(X$S,X$u)-X$b/180*Math.PI,X$T&&(X$J=Math.cos(X$l),X$z=Math.sin(X$l),X$E+=((X$e=X$c.length)*(X$J*X$u-X$z*X$S)-X$x)*X$P,X$I+=(X$e*(X$z*X$u+X$J*X$S)-X$Q)*X$P),X$l>Math.PI?X$l-=2*Math.PI:X$l<-Math.PI&&(X$l+=2*Math.PI),X$l*=X$P,X$J=Math.cos(X$l),X$z=Math.sin(X$l),X$c.resultMatrix.a=X$J*X$u-X$z*X$S,X$c.resultMatrix.c=X$J*X$N-X$z*X$_,X$c.resultMatrix.b=X$z*X$u+X$J*X$S,X$c.resultMatrix.d=X$z*X$N+X$J*X$_}}}},X$m.computeWorldVertices2=function(X$m,X$p,X$h,X$P,X$L,X$q){var X$k,X$Y,X$d=X$m.currDisplayData.bones,X$K=X$m.currDisplayData.weights,X$D=X$m.currDisplayData.triangles,X$F=0,X$R=0,X$$=0,X$A=0,X$B=0,X$n=0,X$c=0,X$e=0,X$a=0,X$Z=0,X$H=0;if(null!=X$d){for(X$F=0;X$F<X$h;X$F+=2)X$R+=(X$A=X$d[X$R])+1,X$$+=X$A;var X$W=X$p;for(X$B=X$q,X$n=3*X$$;X$B<X$P;X$B+=2){for(X$e=X$c=0,X$A=X$d[X$R++],X$A+=X$R;X$R<X$A;X$R++,X$n+=3){X$k=X$W[X$d[X$R]].resultMatrix,X$a=X$K[X$n],X$Z=X$K[X$n+1];var X$E=X$K[X$n+2];X$c+=(X$a*X$k.a+X$Z*X$k.c+X$k.tx)*X$E,X$e+=(X$a*X$k.b+X$Z*X$k.d+X$k.ty)*X$E}X$L[X$B]=X$c,X$L[X$B+1]=X$e}}else{var X$I,X$b;if(X$D||(X$D=X$K),X$m.deformData&&(X$D=X$m.deformData),X$I=X$m.parent,X$p)for(X$H=X$p.length,X$F=0;X$F<X$H;X$F++)if(X$p[X$F].name==X$I){X$Y=X$p[X$F];break}X$Y&&(X$b=X$Y.resultMatrix),X$b||(X$b=X$N._tempMt);var X$T=X$b.tx,X$j=X$b.ty,X$x=X$b.a,X$Q=X$b.b,X$M=X$b.c,X$u=X$b.d;for(X$Y&&(X$u*=X$Y.d),X$R=X$h,X$B=X$q;X$B<X$P;X$R+=2,X$B+=2)X$a=X$D[X$R],X$Z=X$D[X$R+1],X$L[X$B]=X$a*X$x+X$Z*X$Q+X$T,X$L[X$B+1]=-(X$a*X$M+X$Z*X$u+X$j)}},X$m.computeWorldPositions=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k){X$m.currDisplayData.bones,X$m.currDisplayData.weights,X$m.currDisplayData.triangles;var X$Y=[],X$d=0,X$K=X$m.currDisplayData.verLen,X$D=this.position,X$F=this._spaces,X$R=[],X$$=[],X$A=X$K/6,X$B=-1,X$n=NaN,X$c=0,X$e=0,X$a=NaN,X$Z=NaN,X$H=NaN,X$W=NaN;if(X$A--,X$K-=4,this.computeWorldVertices2(X$m,X$p,2,X$K,X$Y,0),this._debugKey)for(X$d=0;X$d<X$Y.length;)X$h.drawCircle(X$Y[X$d++],X$Y[X$d++],10,"#ff0000");X$R=X$Y,this._curves.length=X$A;var X$E=this._curves,X$I=X$R[X$n=0],X$b=X$R[1],X$T=0,X$j=0,X$x=0,X$Q=0,X$M=0,X$u=0,X$N=NaN,X$S=NaN,X$_=NaN,X$l=NaN,X$J=NaN,X$z=NaN,X$w=NaN,X$X=NaN,X$s=0;for(X$d=0,X$s=2;X$d<X$A;X$d++,X$s+=6)X$T=X$R[X$s],X$j=X$R[X$s+1],X$x=X$R[X$s+2],X$Q=X$R[X$s+3],X$J=2*(X$N=.1875*(X$I-2*X$T+X$x))+(X$_=.09375*(3*(X$T-X$x)-X$I+(X$M=X$R[X$s+4]))),X$z=2*(X$S=.1875*(X$b-2*X$j+X$Q))+(X$l=.09375*(3*(X$j-X$Q)-X$b+(X$u=X$R[X$s+5]))),X$w=.75*(X$T-X$I)+X$N+.16666667*X$_,X$X=.75*(X$j-X$b)+X$S+.16666667*X$l,X$n+=Math.sqrt(X$w*X$w+X$X*X$X),X$w+=X$J,X$X+=X$z,X$J+=X$_,X$z+=X$l,X$n+=Math.sqrt(X$w*X$w+X$X*X$X),X$w+=X$J,X$X+=X$z,X$n+=Math.sqrt(X$w*X$w+X$X*X$X),X$w+=X$J+X$_,X$X+=X$z+X$l,X$n+=Math.sqrt(X$w*X$w+X$X*X$X),X$E[X$d]=X$n,X$I=X$M,X$b=X$u;if(X$q&&(X$D*=X$n),X$k)for(X$d=0;X$d<X$P;X$d++)X$F[X$d]*=X$n;var X$G=this._segments,X$U=0,X$r=0;for(X$r=X$e=X$c=X$d=0;X$d<X$P;X$d++,X$c+=3)if((X$a=X$D+=X$Z=X$F[X$d])<0)this.addBeforePosition(X$a,X$R,0,X$$,X$c);else if(X$n<X$a)this.addAfterPosition(X$a-X$n,X$R,X$K-4,X$$,X$c);else{for(;;X$e++)if(!((X$W=X$E[X$e])<X$a)){0==X$e?X$a/=X$W:X$a=(X$a-(X$H=X$E[X$e-1]))/(X$W-X$H);break}if(X$e!=X$B){var X$y=6*(X$B=X$e);for(X$I=X$R[X$y],X$b=X$R[X$y+1],X$T=X$R[X$y+2],X$j=X$R[X$y+3],X$x=X$R[X$y+4],X$Q=X$R[X$y+5],X$J=2*(X$N=.03*(X$I-2*X$T+X$x))+(X$_=.006*(3*(X$T-X$x)-X$I+(X$M=X$R[X$y+6]))),X$z=2*(X$S=.03*(X$b-2*X$j+X$Q))+(X$l=.006*(3*(X$j-X$Q)-X$b+(X$u=X$R[X$y+7]))),X$w=.3*(X$T-X$I)+X$N+.16666667*X$_,X$X=.3*(X$j-X$b)+X$S+.16666667*X$l,X$U=Math.sqrt(X$w*X$w+X$X*X$X),X$G[0]=X$U,X$y=1;X$y<8;X$y++)X$w+=X$J,X$X+=X$z,X$J+=X$_,X$z+=X$l,X$U+=Math.sqrt(X$w*X$w+X$X*X$X),X$G[X$y]=X$U;X$w+=X$J,X$X+=X$z,X$U+=Math.sqrt(X$w*X$w+X$X*X$X),X$G[8]=X$U,X$w+=X$J+X$_,X$X+=X$z+X$l,X$U+=Math.sqrt(X$w*X$w+X$X*X$X),X$G[9]=X$U,X$r=0}for(X$a*=X$U;;X$r++)if(!((X$W=X$G[X$r])<X$a)){0==X$r?X$a/=X$W:X$a=X$r+(X$a-(X$H=X$G[X$r-1]))/(X$W-X$H);break}this.addCurvePosition(.1*X$a,X$I,X$b,X$T,X$j,X$x,X$Q,X$M,X$u,X$$,X$c,X$L||0<X$d&&0==X$Z)}return X$$},X$m.addBeforePosition=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$p[X$h],X$k=X$p[X$h+1],X$Y=X$p[X$h+2]-X$q,X$d=X$p[X$h+3]-X$k,X$K=Math.atan2(X$d,X$Y);X$P[X$L]=X$q+X$m*Math.cos(X$K),X$P[X$L+1]=X$k+X$m*Math.sin(X$K),X$P[X$L+2]=X$K},X$m.addAfterPosition=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$p[X$h+2],X$k=X$p[X$h+3],X$Y=X$q-X$p[X$h],X$d=X$k-X$p[X$h+1],X$K=Math.atan2(X$d,X$Y);X$P[X$L]=X$q+X$m*Math.cos(X$K),X$P[X$L+1]=X$k+X$m*Math.sin(X$K),X$P[X$L+2]=X$K},X$m.addCurvePosition=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D,X$F){0==X$m&&(X$m=1e-4);var X$R=X$m*X$m,X$$=X$R*X$m,X$A=1-X$m,X$B=X$A*X$A,X$n=X$B*X$A,X$c=X$A*X$m,X$e=3*X$c,X$a=X$A*X$e,X$Z=X$e*X$m,X$H=X$p*X$n+X$P*X$a+X$q*X$Z+X$Y*X$$,X$W=X$h*X$n+X$L*X$a+X$k*X$Z+X$d*X$$;X$K[X$D]=X$H,X$K[X$D+1]=X$W,X$K[X$D+2]=X$F?Math.atan2(X$W-(X$h*X$B+X$L*X$c*2+X$k*X$R),X$H-(X$p*X$B+X$P*X$c*2+X$q*X$R)):0},X$N.NONE=-1,X$N.BEFORE=-2,X$N.AFTER=-3,X$h(X$N,["_tempMt",function(){return this._tempMt=new X$Mm}]),X$N}(),X$sm=function(){function X$m(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return X$P(X$m,"laya.ani.bone.PathConstraintData"),X$m}(),X$Gm=function(){function X$m(){this.name=null,this.slotArr=[]}return X$P(X$m,"laya.ani.bone.SkinData"),X$m}(),X$Um=function(){function X$m(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}X$P(X$m,"laya.ani.bone.SkinSlotDisplayData");var X$p=X$m.prototype;return X$p.createTexture=function(X$m){return this.texture||(this.texture=new X$um(X$m.bitmap,this.uvs),X$m.bitmap.alphaTexture&&(this.texture.alphaTexture=new X$um(X$m.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=X$m.height,this.texture.height=X$m.width,this.texture.offsetX=-X$m.offsetX,this.texture.offsetY=-X$m.offsetY,this.texture.sourceWidth=X$m.sourceHeight,this.texture.sourceHeight=X$m.sourceWidth):(this.texture.width=X$m.width,this.texture.height=X$m.height,this.texture.offsetX=-X$m.offsetX,this.texture.offsetY=-X$m.offsetY,this.texture.sourceWidth=X$m.sourceWidth,this.texture.sourceHeight=X$m.sourceHeight),X$n.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},X$p.destory=function(){this.texture&&this.texture.destroy()},X$m}(),X$rm=function(){function X$m(){this.name=null,this.displayArr=[]}return X$P(X$m,"laya.ani.bone.SlotData"),X$m.prototype.getDisplayByName=function(X$m){for(var X$p=0,X$h=this.displayArr.length;X$p<X$h;X$p++)if(this.displayArr[X$p].attachmentName==X$m)return X$p;return-1},X$m}(),X$W=function(){function X$m(X$m,X$p){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=X$B(2,0),this._data=X$m,null==this._bones&&(this._bones=[]),this.target=X$p[X$m.targetIndex];var X$h,X$P=0;for(X$P=0,X$h=X$m.boneIndexs.length;X$P<X$h;X$P++)this._bones.push(X$p[X$m.boneIndexs[X$P]]);this.rotateMix=X$m.rotateMix,this.translateMix=X$m.translateMix,this.scaleMix=X$m.scaleMix,this.shearMix=X$m.shearMix}return X$P(X$m,"laya.ani.bone.TfConstraint"),X$m.prototype.apply=function(){for(var X$m,X$p=this.target.resultMatrix.a,X$h=this.target.resultMatrix.b,X$P=this.target.resultMatrix.c,X$L=this.target.resultMatrix.d,X$q=0,X$k=this._bones.length;X$q<X$k;X$q++){if(X$m=this._bones[X$q],0<this.rotateMix){var X$Y=X$m.resultMatrix.a,X$d=X$m.resultMatrix.b,X$K=X$m.resultMatrix.c,X$D=X$m.resultMatrix.d,X$F=Math.atan2(X$P,X$p)-Math.atan2(X$K,X$Y)+this._data.offsetRotation*Math.PI/180;X$F>Math.PI?X$F-=2*Math.PI:X$F<-Math.PI&&(X$F+=2*Math.PI),X$F*=this.rotateMix;var X$R=Math.cos(X$F),X$$=Math.sin(X$F);X$m.resultMatrix.a=X$R*X$Y-X$$*X$K,X$m.resultMatrix.b=X$R*X$d-X$$*X$D,X$m.resultMatrix.c=X$$*X$Y+X$R*X$K,X$m.resultMatrix.d=X$$*X$d+X$R*X$D}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),X$m.resultMatrix.tx+=(this._temp[0]-X$m.resultMatrix.tx)*this.translateMix,X$m.resultMatrix.ty+=(this._temp[1]-X$m.resultMatrix.ty)*this.translateMix,X$m.updateChild()),0<this.scaleMix){var X$A=Math.sqrt(X$m.resultMatrix.a*X$m.resultMatrix.a+X$m.resultMatrix.c*X$m.resultMatrix.c),X$B=Math.sqrt(X$p*X$p+X$P*X$P),X$n=1e-5<X$A?(X$A+(X$B-X$A+this._data.offsetScaleX)*this.scaleMix)/X$A:0;X$m.resultMatrix.a*=X$n,X$m.resultMatrix.c*=X$n,X$A=Math.sqrt(X$m.resultMatrix.b*X$m.resultMatrix.b+X$m.resultMatrix.d*X$m.resultMatrix.d),X$B=Math.sqrt(X$h*X$h+X$L*X$L),X$n=1e-5<X$A?(X$A+(X$B-X$A+this._data.offsetScaleY)*this.scaleMix)/X$A:0,X$m.resultMatrix.b*=X$n,X$m.resultMatrix.d*=X$n}if(0<this.shearMix){X$d=X$m.resultMatrix.b,X$D=X$m.resultMatrix.d;var X$c=Math.atan2(X$D,X$d);(X$F=Math.atan2(X$L,X$h)-Math.atan2(X$P,X$p)-(X$c-Math.atan2(X$m.resultMatrix.c,X$m.resultMatrix.a)))>Math.PI?X$F-=2*Math.PI:X$F<-Math.PI&&(X$F+=2*Math.PI),X$F=X$c+(X$F+this._data.offsetShearY*Math.PI/180)*this.shearMix,X$n=Math.sqrt(X$d*X$d+X$D*X$D),X$m.resultMatrix.b=Math.cos(X$F)*X$n,X$m.resultMatrix.d=Math.sin(X$F)*X$n}}},X$m}(),X$ym=function(){function X$m(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return X$P(X$m,"laya.ani.bone.TfConstraintData"),X$m}(),X$Vm=function(){function X$m(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}X$P(X$m,"laya.ani.bone.Transform");var X$p=X$m.prototype;return X$p.initData=function(X$m){null!=X$m.x&&(this.x=X$m.x),null!=X$m.y&&(this.y=X$m.y),null!=X$m.skX&&(this.skX=X$m.skX),null!=X$m.skY&&(this.skY=X$m.skY),null!=X$m.scX&&(this.scX=X$m.scX),null!=X$m.scY&&(this.scY=X$m.scY)},X$p.getMatrix=function(){var X$m;return(X$m=this.mMatrix?this.mMatrix:this.mMatrix=new X$Mm).identity(),X$m.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(X$m,this.skewX*Math.PI/180,this.skewY*Math.PI/180),X$m.rotate(this.skX*Math.PI/180),X$m.translate(this.x,this.y),X$m},X$p.skew=function(X$m,X$p,X$h){var X$P=Math.sin(X$h),X$L=Math.cos(X$h),X$q=Math.sin(X$p),X$k=Math.cos(X$p);return X$m.setTo(X$m.a*X$k-X$m.b*X$P,X$m.a*X$q+X$m.b*X$L,X$m.c*X$k-X$m.d*X$P,X$m.c*X$q+X$m.d*X$L,X$m.tx*X$k-X$m.ty*X$P,X$m.tx*X$q+X$m.ty*X$L),X$m},X$m}(),X$E=function(){function X$m(){}return X$P(X$m,"laya.ani.bone.UVTools"),X$m.getRelativeUV=function(X$m,X$p,X$h){var X$P=X$m[0],X$L=X$m[2]-X$m[0],X$q=X$m[1],X$k=X$m[5]-X$m[1];X$h||(X$h=[]),X$h.length=X$p.length;var X$Y,X$d=0;X$Y=X$h.length;var X$K=1/X$L,X$D=1/X$k;for(X$d=0;X$d<X$Y;X$d+=2)X$h[X$d]=(X$p[X$d]-X$P)*X$K,X$h[X$d+1]=(X$p[X$d+1]-X$q)*X$D;return X$h},X$m.getAbsoluteUV=function(X$m,X$p,X$h){if(0==X$m[0]&&0==X$m[1]&&1==X$m[4]&&1==X$m[5])return X$h?(X$c.copyArray(X$h,X$p),X$h):X$p;var X$P=X$m[0],X$L=X$m[2]-X$m[0],X$q=X$m[1],X$k=X$m[5]-X$m[1];X$h||(X$h=[]),X$h.length=X$p.length;var X$Y,X$d=0;for(X$Y=X$h.length,X$d=0;X$d<X$Y;X$d+=2)X$h[X$d]=X$p[X$d]*X$L+X$P,X$h[X$d+1]=X$p[X$d+1]*X$k+X$q;return X$h},X$m}(),X$N=function(){function X$m(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return X$P(X$m,"laya.ani.KeyFramesContent"),X$m}(),X$I=function(){function X$D(){}return X$P(X$D,"laya.ani.math.BezierLerp"),X$D.getBezierRate=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$D._getBezierParamKey(X$p,X$h,X$P,X$L),X$k=100*X$q+X$m;if(X$D._bezierResultCache[X$k])return X$D._bezierResultCache[X$k];var X$Y,X$d=X$D._getBezierPoints(X$p,X$h,X$P,X$L,X$q),X$K=0;for(X$Y=X$d.length,X$K=0;X$K<X$Y;X$K+=2)if(X$m<=X$d[X$K])return X$D._bezierResultCache[X$k]=X$d[X$K+1],X$d[X$K+1];return X$D._bezierResultCache[X$k]=1},X$D._getBezierParamKey=function(X$m,X$p,X$h,X$P){return 100*(100*(100*(100*X$m+X$p)+X$h)+X$P)},X$D._getBezierPoints=function(X$m,X$p,X$h,X$P,X$L){return X$D._bezierPointsCache[X$L]?X$D._bezierPointsCache[X$L]:(X$q=[0,0,X$m,X$p,X$h,X$P,1,1],X$k=(new X$Y).getBezierPoints(X$q,100,3),X$D._bezierPointsCache[X$L]=X$k);var X$q,X$k},X$D._bezierResultCache={},X$D._bezierPointsCache={},X$D}(),X$b=function(X$m){function X$p(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,X$p.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}X$P(X$p,"laya.ani.AnimationPlayer",X$L);var X$h=X$p.prototype;return X$Lm.imps(X$h,{"laya.resource.IDestroy":!0}),X$h._onTempletLoadedComputeFullKeyframeIndices=function(X$m,X$p,X$h){this._templet===X$h&&this._cachePlayRate===X$m&&this._cacheFrameRate===X$p&&this._computeFullKeyframeIndices()},X$h._computeFullKeyframeIndices=function(){for(var X$m=this._fullFrames=[],X$p=this._templet,X$h=this._cacheFrameRateInterval*this._cachePlayRate,X$P=0,X$L=X$p.getAnimationCount();X$P<X$L;X$P++){for(var X$q=[],X$k=0,X$Y=X$p.getAnimation(X$P).nodes.length;X$k<X$Y;X$k++){for(var X$d=X$p.getAnimation(X$P).nodes[X$k],X$K=Math.floor(X$d.playTime/X$h+.01),X$D=new Uint16Array(X$K+1),X$F=-1,X$R=0,X$$=X$d.keyFrame.length;X$R<X$$;X$R++){var X$A=X$d.keyFrame[X$R],X$B=X$A.startTime,X$n=X$B+X$A.duration+X$h;do{for(var X$c=Math.floor(X$B/X$h+.5),X$e=X$F+1;X$e<X$c;X$e++)X$D[X$e]=X$R;X$D[X$F=X$c]=X$R,X$B+=X$h}while(X$B<=X$n)}X$q.push(X$D)}X$m.push(X$q)}},X$h._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},X$h._calculatePlayDuration=function(){if(0!==this.state){var X$m=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=X$m),this._playEnd>X$m&&(this._playEnd=X$m),this._playDuration=this._playEnd-this._playStart}},X$h._setPlayParams=function(X$m,X$p){this._currentTime=X$m,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/X$p+.01),0),this._currentFrameTime=this._currentKeyframeIndex*X$p},X$h._setPlayParamsWhenStop=function(X$m,X$p){this._currentTime=X$m,this._currentKeyframeIndex=Math.max(Math.floor(X$m/X$p+.01),0),this._currentFrameTime=this._currentKeyframeIndex*X$p,this._currentAnimationClipIndex=-1},X$h._update=function(X$m){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var X$p=this._cacheFrameRateInterval*this._cachePlayRate,X$h=0;this._startUpdateLoopCount!==X$A.loopCount&&(X$h=X$m*this.playbackRate,this._elapsedPlaybackTime+=X$h);var X$P=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=X$P)return this._setPlayParamsWhenStop(X$P,X$p),void this.event("stopped");if(X$h+=this._currentTime,0<X$P)if(X$P<=X$h)do{if(X$h-=X$P,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(X$P,X$p),this._stopWhenCircleFinish=!1,void this.event("stopped");X$h<X$P&&(this._setPlayParams(X$h,X$p),this.event("complete"))}while(X$P<=X$h);else this._setPlayParams(X$h,X$p);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(X$P,X$p),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},X$h._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},X$h.play=function(X$m,X$p,X$h,X$P,X$L){if(void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=1),void 0===X$h&&(X$h=2147483647),void 0===X$P&&(X$P=0),void 0===X$L&&(X$L=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(X$h<0||X$P<0||X$L<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==X$L&&X$L<X$P)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=X$p,this._overallDuration=X$h,this._playStart=X$P,this._playEnd=X$L,this._paused=!1,this._currentAnimationClipIndex=X$m,this._currentKeyframeIndex=0,this._startUpdateLoopCount=X$A.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},X$h.playByFrame=function(X$m,X$p,X$h,X$P,X$L,X$q){void 0===X$m&&(X$m=0),void 0===X$p&&(X$p=1),void 0===X$h&&(X$h=2147483647),void 0===X$P&&(X$P=0),void 0===X$L&&(X$L=0),void 0===X$q&&(X$q=30);var X$k=1e3/X$q;this.play(X$m,X$p,X$h,X$P*X$k,X$L*X$k)},X$h.stop=function(X$m){void 0===X$m&&(X$m=!0),X$m?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},X$q(0,X$h,"playEnd",function(){return this._playEnd}),X$q(0,X$h,"templet",function(){return this._templet},function(X$m){0===!this.state&&this.stop(!0),this._templet!==X$m&&((this._templet=X$m).loaded?this._computeFullKeyframeIndices():X$m.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),X$q(0,X$h,"playStart",function(){return this._playStart}),X$q(0,X$h,"playDuration",function(){return this._playDuration}),X$q(0,X$h,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),X$q(0,X$h,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),X$q(0,X$h,"overallDuration",function(){return this._overallDuration}),X$q(0,X$h,"currentFrameTime",function(){return this._currentFrameTime}),X$q(0,X$h,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),X$q(0,X$h,"currentPlayTime",function(){return this._currentTime+this._playStart}),X$q(0,X$h,"cachePlayRate",function(){return this._cachePlayRate},function(X$m){this._cachePlayRate!==X$m&&(this._cachePlayRate=X$m,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[X$m,this._cacheFrameRate])))}),X$q(0,X$h,"cacheFrameRate",function(){return this._cacheFrameRate},function(X$m){this._cacheFrameRate!==X$m&&(this._cacheFrameRate=X$m,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,X$m])))}),X$q(0,X$h,"currentTime",null,function(X$m){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(X$m<this._playStart||X$m>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=X$A.loopCount;var X$p=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=X$m,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/X$p),0),this._currentFrameTime=this._currentKeyframeIndex*X$p}}),X$q(0,X$h,"paused",function(){return this._paused},function(X$m){(this._paused=X$m)&&this.event("paused")}),X$q(0,X$h,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),X$q(0,X$h,"destroyed",function(){return this._destroyed}),X$p}(),X$S=function(X$m){function X$p(){X$p.__super.call(this),X$n.isConchNode&&(this.drawSkin=function(X$m){X$m.transform||(X$m.transform=X$Mm.EMPTY),this._addCmd([X$m]),this.setSkinMesh&&this.setSkinMesh(X$m._ps,X$m.mVBData,X$m.mEleNum,0,X$m.mTexture,X$m.transform)})}return X$P(X$p,"laya.ani.GraphicsAni",X$k),X$p.prototype.drawSkin=function(X$m){var X$p=[X$m];this._saveToCmd(X$n._context._drawSkin,X$p)},X$p.create=function(){return X$p._caches.pop()||new X$p},X$p.recycle=function(X$m){X$m.clear(),X$p._caches.push(X$m)},X$p._caches=[],X$p}(),X$_=function(X$m){function X$e(){this._aniMap={},this.unfixedLastAniIndex=-1,X$e.__super.call(this),this._anis=new Array}X$P(X$e,"laya.ani.AnimationTemplet",X$D);var X$p=X$e.prototype;return X$p.parse=function(X$m){var X$p=new X$Qm(X$m);this._aniVersion=X$p.readUTFString(),X$a.parse(this,X$p)},X$p._calculateKeyFrame=function(X$m,X$p,X$h){var X$P=X$m.keyFrame;X$P[X$p]=X$P[0];for(var X$L=0;X$L<X$p;X$L++){var X$q=X$P[X$L];X$q.nextData=0===X$q.duration?X$q.data:X$P[X$L+1].data}X$P.length--},X$p.onAsynLoaded=function(X$m,X$p,X$h){var X$P=new X$Qm(X$p);switch(this._aniVersion=X$P.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":X$Z.parse(this,X$P);break;default:X$a.parse(this,X$P)}this._endLoaded()},X$p.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},X$p.getAnimationCount=function(){return this._anis.length},X$p.getAnimation=function(X$m){return this._anis[X$m]},X$p.getAniDuration=function(X$m){return this._anis[X$m].playTime},X$p.getNodes=function(X$m){return this._anis[X$m].nodes},X$p.getNodeIndexWithName=function(X$m,X$p){return this._anis[X$m].bone3DMap[X$p]},X$p.getNodeCount=function(X$m){return this._anis[X$m].nodes.length},X$p.getTotalkeyframesLength=function(X$m){return this._anis[X$m].totalKeyframeDatasLength},X$p.getPublicExtData=function(){return this._publicExtData},X$p.getAnimationDataWithCache=function(X$m,X$p,X$h,X$P){var X$L=X$p[X$h];if(X$L){var X$q=X$L[X$m];return X$q?X$q[X$P]:null}return null},X$p.setAnimationDataWithCache=function(X$m,X$p,X$h,X$P,X$L){var X$q=X$p[X$h]||(X$p[X$h]={});(X$q[X$m]||(X$q[X$m]=[]))[X$P]=X$L},X$p.getOriginalData=function(X$m,X$p,X$h,X$P,X$L){for(var X$q=this._anis[X$m].nodes,X$k=0,X$Y=0,X$d=X$q.length,X$K=0;X$Y<X$d;X$Y++){var X$D,X$F=X$q[X$Y];X$D=X$F.keyFrame[X$h[X$Y][X$P]],X$F.dataOffset=X$K;var X$R=X$L-X$D.startTime,X$$=X$F.lerpType;if(X$$)switch(X$$){case 0:case 1:for(X$k=0;X$k<X$F.keyframeWidth;)X$k+=X$F.interpolationMethod[X$k](X$F,X$k,X$p,X$K+X$k,X$D.data,X$R,null,X$D.duration,X$D.nextData);break;case 2:var X$A=X$D.interpolationData,X$B=X$A.length,X$n=0;for(X$k=0;X$k<X$B;){var X$c=X$A[X$k];switch(X$c){case 6:case 7:X$k+=X$e.interpolation[X$c](X$F,X$n,X$p,X$K+X$n,X$D.data,X$R,null,X$D.duration,X$D.nextData,X$A,X$k+1);break;default:X$k+=X$e.interpolation[X$c](X$F,X$n,X$p,X$K+X$n,X$D.data,X$R,null,X$D.duration,X$D.nextData)}X$n++}}else for(X$k=0;X$k<X$F.keyframeWidth;)X$k+=X$F.interpolationMethod[X$k](X$F,X$k,X$p,X$K+X$k,X$D.data,X$R,null,X$D.duration,X$D.nextData);X$K+=X$F.keyframeWidth}},X$p.getNodesCurrentFrameIndex=function(X$m,X$p){var X$h=this._anis[X$m].nodes;X$m!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(X$h.length),this.unfixedCurrentTimes=new Float32Array(X$h.length),this.unfixedLastAniIndex=X$m);for(var X$P=0,X$L=X$h.length;X$P<X$L;X$P++){var X$q=X$h[X$P];for(X$p<this.unfixedCurrentTimes[X$P]&&(this.unfixedCurrentFrameIndexes[X$P]=0),this.unfixedCurrentTimes[X$P]=X$p;this.unfixedCurrentFrameIndexes[X$P]<X$q.keyFrame.length&&!(X$q.keyFrame[this.unfixedCurrentFrameIndexes[X$P]].startTime>this.unfixedCurrentTimes[X$P]);)this.unfixedCurrentFrameIndexes[X$P]++;this.unfixedCurrentFrameIndexes[X$P]--}return this.unfixedCurrentFrameIndexes},X$p.getOriginalDataUnfixedRate=function(X$m,X$p,X$h){var X$P=this._anis[X$m].nodes;X$m!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(X$P.length),this.unfixedCurrentTimes=new Float32Array(X$P.length),this.unfixedKeyframes=X$B(X$P.length),this.unfixedLastAniIndex=X$m);for(var X$L=0,X$q=0,X$k=X$P.length,X$Y=0;X$q<X$k;X$q++){var X$d=X$P[X$q];for(X$h<this.unfixedCurrentTimes[X$q]&&(this.unfixedCurrentFrameIndexes[X$q]=0),this.unfixedCurrentTimes[X$q]=X$h;this.unfixedCurrentFrameIndexes[X$q]<X$d.keyFrame.length&&!(X$d.keyFrame[this.unfixedCurrentFrameIndexes[X$q]].startTime>this.unfixedCurrentTimes[X$q]);)this.unfixedKeyframes[X$q]=X$d.keyFrame[this.unfixedCurrentFrameIndexes[X$q]],this.unfixedCurrentFrameIndexes[X$q]++;var X$K=this.unfixedKeyframes[X$q];X$d.dataOffset=X$Y;var X$D=X$h-X$K.startTime;if(X$d.lerpType)switch(X$d.lerpType){case 0:case 1:for(X$L=0;X$L<X$d.keyframeWidth;)X$L+=X$d.interpolationMethod[X$L](X$d,X$L,X$p,X$Y+X$L,X$K.data,X$D,null,X$K.duration,X$K.nextData);break;case 2:var X$F=X$K.interpolationData,X$R=X$F.length,X$$=0;for(X$L=0;X$L<X$R;){var X$A=X$F[X$L];switch(X$A){case 6:case 7:X$L+=X$e.interpolation[X$A](X$d,X$$,X$p,X$Y+X$$,X$K.data,X$D,null,X$K.duration,X$K.nextData,X$F,X$L+1);break;default:X$L+=X$e.interpolation[X$A](X$d,X$$,X$p,X$Y+X$$,X$K.data,X$D,null,X$K.duration,X$K.nextData)}X$$++}}else for(X$L=0;X$L<X$d.keyframeWidth;)X$L+=X$d.interpolationMethod[X$L](X$d,X$L,X$p,X$Y+X$L,X$K.data,X$D,null,X$K.duration,X$K.nextData);X$Y+=X$d.keyframeWidth}},X$e._LinearInterpolation_0=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){var X$D=0===X$Y?0:X$q/X$Y;return X$h[X$P]=(1-X$D)*X$L[X$p]+X$D*X$d[X$p],1},X$e._QuaternionInterpolation_1=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){var X$D=0===X$Y?0:X$q/X$Y;return X$R.slerpQuaternionArray(X$L,X$p,X$d,X$p,X$D,X$h,X$P),4},X$e._AngleInterpolation_2=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){return 0},X$e._RadiansInterpolation_3=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){return 0},X$e._Matrix4x4Interpolation_4=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){for(var X$D=0;X$D<16;X$D++,X$p++)X$h[X$P+X$D]=X$L[X$p]+X$q*X$k[X$p];return 16},X$e._NoInterpolation_5=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K){return X$h[X$P]=X$L[X$p],1},X$e._BezierInterpolation_6=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D){return void 0===X$D&&(X$D=0),X$h[X$P]=X$L[X$p]+(X$d[X$p]-X$L[X$p])*X$I.getBezierRate(X$q/X$Y,X$K[X$D],X$K[X$D+1],X$K[X$D+2],X$K[X$D+3]),5},X$e._BezierInterpolation_7=function(X$m,X$p,X$h,X$P,X$L,X$q,X$k,X$Y,X$d,X$K,X$D){return void 0===X$D&&(X$D=0),X$h[X$P]=X$K[X$D+4]+X$K[X$D+5]*X$I.getBezierRate((.001*X$q+X$K[X$D+6])/X$K[X$D+7],X$K[X$D],X$K[X$D+1],X$K[X$D+2],X$K[X$D+3]),9},X$e.load=function(X$m){return X$Lm.loader.create(X$m,null,null,X$e)},X$e.interpolation=[X$e._LinearInterpolation_0,X$e._QuaternionInterpolation_1,X$e._AngleInterpolation_2,X$e._RadiansInterpolation_3,X$e._Matrix4x4Interpolation_4,X$e._NoInterpolation_5,X$e._BezierInterpolation_6,X$e._BezierInterpolation_7],X$e}(),X$T=function(X$p){function X$h(X$m,X$p){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,X$h.__super.call(this),void 0===X$p&&(X$p=0),X$m&&this.init(X$m,X$p)}X$P(X$h,"laya.ani.bone.Skeleton",X$p);var X$m=X$h.prototype;return X$m.init=function(X$m,X$p){void 0===X$p&&(X$p=0);var X$h,X$P,X$L,X$q=0,X$k=0;if(1==X$p)for(this._graphicsCache=[],X$q=0,X$k=X$m.getAnimationCount();X$q<X$k;X$q++)this._graphicsCache.push([]);if(this._yReverseMatrix=X$m.yReverseMatrix,this._aniMode=X$p,this._templet=X$m,this._player=new X$b,this._player.cacheFrameRate=X$m.rate,this._player.templet=X$m,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=X$m.mBoneArr,this._rootBone=X$m.mRootBone,this._aniSectionDic=X$m.aniSectionDic,0<X$m.ikArr.length)for(this._ikArr=[],X$q=0,X$k=X$m.ikArr.length;X$q<X$k;X$q++)this._ikArr.push(new X$e(X$m.ikArr[X$q],this._boneList));if(0<X$m.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),X$q=0,X$k=X$m.pathArr.length;X$q<X$k;X$q++)X$h=X$m.pathArr[X$q],X$P=new X$H(X$h,this._boneList),(X$L=this._boneSlotDic[X$h.name])&&((X$P=new X$H(X$h,this._boneList)).target=X$L),this._pathDic[X$h.name]=X$P;if(0<X$m.tfArr.length)for(this._tfArr=[],X$q=0,X$k=X$m.tfArr.length;X$q<X$k;X$q++)this._tfArr.push(new X$W(X$m.tfArr[X$q],this._boneList));if(0<X$m.skinDataArray.length){var X$Y=this._templet.skinDataArray[this._skinIndex];this._skinName=X$Y.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},X$m.load=function(X$m,X$p,X$h){},X$m._onLoaded=function(){},X$m._parseComplete=function(){var X$m=X$j.TEMPLET_DICTIONARY[this._aniPath];X$m&&(this.init(X$m,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},X$m._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},X$m._onPlay=function(){this.event("played")},X$m._onStop=function(){var X$m,X$p=this._templet.eventAniArr[this._aniClipIndex];if(X$p&&this._eventIndex<X$p.length)for(;this._eventIndex<X$p.length;this._eventIndex++)(X$m=X$p[this._eventIndex]).time>=this._player.playStart&&X$m.time<=this._player.playEnd&&this.event("label",X$m);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},X$m._onPause=function(){this.event("paused")},X$m._parseSrcBoneMatrix=function(){var X$m=0,X$p=0;for(X$p=this._templet.srcBoneMatrixArr.length,X$m=0;X$m<X$p;X$m++)this._boneMatrixArray.push(new X$Mm);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var X$h,X$P,X$L=this._templet.boneSlotArray;for(X$m=0,X$p=X$L.length;X$m<X$p;X$m++)X$h=X$L[X$m],null==(X$P=this._bindBoneBoneSlotDic[X$h.parent])&&(this._bindBoneBoneSlotDic[X$h.parent]=X$P=[]),this._boneSlotDic[X$h.name]=X$h=X$h.copy(),X$P.push(X$h),this._boneSlotArray.push(X$h)}},X$m._emitMissedEvents=function(X$m,X$p,X$h){void 0===X$h&&(X$h=0);var X$P=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(X$P){var X$L,X$q,X$k=0;for(X$L=X$P.length,X$k=X$h;X$k<X$L;X$k++)(X$q=X$P[X$k]).time>=this._player.playStart&&X$q.time<=this._player.playEnd&&this.event("label",X$q)}},X$m._update=function(X$m){if(void 0===X$m&&(X$m=!0),!(this._pause||X$m&&this._indexControl)){var X$p=this.timer.currTimer,X$h=this._player.currentKeyframeIndex,X$P=X$p-this._lastTime;if(X$m?this._player._update(X$P):X$h=-1,this._lastTime=X$p,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<X$P&&this._clipIndex==X$h&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var X$L;this._lastUpdateAniClipIndex=this._aniClipIndex,X$h>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var X$q,X$k=this._templet.eventAniArr[this._aniClipIndex];if(X$k&&this._eventIndex<X$k.length&&((X$L=X$k[this._eventIndex]).time>=this._player.playStart&&X$L.time<=this._player.playEnd?this._player.currentPlayTime>=X$L.time&&(this.event("label",X$L),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(X$q=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=X$q&&(this.graphics=X$q));var X$Y=0,X$d=0;for(X$d=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,X$d-1)&&0<X$d;)X$d--;if(X$d<this._clipIndex)for(X$Y=X$d;X$Y<this._clipIndex;X$Y++)this._createGraphics(X$Y)}else if(1==this._aniMode){if(X$q=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=X$q&&(this.graphics=X$q));for(X$d=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,X$d-1)&&0<X$d;)X$d--;if(X$d<this._clipIndex)for(X$Y=X$d;X$Y<this._clipIndex;X$Y++)this._createGraphics(X$Y)}this._createGraphics()}}},X$m._createGraphics=function(X$m){void 0===X$m&&(X$m=-1),-1==X$m&&(X$m=this._clipIndex);var X$p,X$h,X$P=X$m*this._player.cacheFrameRateInterval,X$L=this._templet.drawOrderAniArr[this._aniClipIndex];if(X$L&&0<X$L.length)for(this._drawOrderIndex=0,X$p=X$L[this._drawOrderIndex];X$P>=X$p.time&&(this._drawOrder=X$p.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=X$L.length));)X$p=X$L[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=X$S.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=X$S.create(),X$h=this.graphics;var X$q=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],X$m,X$P);var X$k,X$Y,X$d,X$K,X$D=this._aniSectionDic[this._aniClipIndex],X$F=0,X$R=0,X$$=0,X$A=0,X$B=0,X$n=this._templet.srcBoneMatrixArr.length;for(X$B=X$D[X$R=0];X$R<X$n;X$R++)X$K=this._boneList[X$R],X$d=this._templet.srcBoneMatrixArr[X$R],X$K.resultTransform.scX=X$d.scX*this._curOriginalData[X$F++],X$K.resultTransform.skX=X$d.skX+this._curOriginalData[X$F++],X$K.resultTransform.skY=X$d.skY+this._curOriginalData[X$F++],X$K.resultTransform.scY=X$d.scY*this._curOriginalData[X$F++],X$K.resultTransform.x=X$d.x+this._curOriginalData[X$F++],X$K.resultTransform.y=X$d.y+this._curOriginalData[X$F++],8===this._templet.tMatrixDataLen&&(X$K.resultTransform.skewX=X$d.skewX+this._curOriginalData[X$F++],X$K.resultTransform.skewY=X$d.skewY+this._curOriginalData[X$F++]);var X$c,X$e={},X$a={};for(X$B+=X$D[1];X$R<X$B;X$R++)X$e[(X$c=X$q[X$R]).name]=this._curOriginalData[X$F++],X$a[X$c.name]=this._curOriginalData[X$F++],this._curOriginalData[X$F++],this._curOriginalData[X$F++],this._curOriginalData[X$F++],this._curOriginalData[X$F++];var X$Z,X$H,X$W={},X$E={};for(X$B+=X$D[2];X$R<X$B;X$R++)X$W[(X$c=X$q[X$R]).name]=this._curOriginalData[X$F++],X$E[X$c.name]=this._curOriginalData[X$F++],this._curOriginalData[X$F++],this._curOriginalData[X$F++],this._curOriginalData[X$F++],this._curOriginalData[X$F++];if(this._pathDic)for(X$B+=X$D[3];X$R<X$B;X$R++){if(X$c=X$q[X$R],X$Z=this._pathDic[X$c.name])switch(new X$Qm(X$c.extenData).getByte()){case 1:X$Z.position=this._curOriginalData[X$F++];break;case 2:X$Z.spacing=this._curOriginalData[X$F++];break;case 3:X$Z.rotateMix=this._curOriginalData[X$F++],X$Z.translateMix=this._curOriginalData[X$F++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(X$Mm.TEMP.identity()),this._ikArr)for(X$R=0,X$B=this._ikArr.length;X$R<X$B;X$R++)X$H=this._ikArr[X$R],X$W.hasOwnProperty(X$H.name)&&(X$H.bendDirection=X$W[X$H.name]),X$E.hasOwnProperty(X$H.name)&&(X$H.mix=X$E[X$H.name]),X$H.apply();if(this._pathDic)for(var X$I in this._pathDic)(X$Z=this._pathDic[X$I]).apply(this._boneList,X$h);if(this._tfArr)for(X$R=0,X$A=this._tfArr.length;X$R<X$A;X$R++)this._tfArr[X$R].apply();for(X$R=0,X$A=this._boneList.length;X$R<X$A;X$R++)if(X$K=this._boneList[X$R],X$Y=this._bindBoneBoneSlotDic[X$K.name],X$K.resultMatrix.copyTo(this._boneMatrixArray[X$R]),X$Y)for(X$$=0,X$B=X$Y.length;X$$<X$B;X$$++)(X$k=X$Y[X$$])&&X$k.setParentMatrix(X$K.resultMatrix);var X$b,X$T,X$j,X$x,X$Q={},X$M=this._templet.deformAniArr;if(X$M&&0<X$M.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,X$R=0,X$B=this._boneSlotArray.length;X$R<X$B;X$R++)(X$k=this._boneSlotArray[X$R]).deformData=null;var X$u,X$N=X$M[this._aniClipIndex];for(X$u in X$b=X$N.default,this._setDeform(X$b,X$Q,this._boneSlotArray,X$P),X$N)"default"!=X$u&&X$u!=this._skinName&&(X$b=X$N[X$u],this._setDeform(X$b,X$Q,this._boneSlotArray,X$P));X$b=X$N[this._skinName],this._setDeform(X$b,X$Q,this._boneSlotArray,X$P)}if(this._drawOrder)for(X$R=0,X$B=this._drawOrder.length;X$R<X$B;X$R++)X$T=X$e[(X$k=this._boneSlotArray[this._drawOrder[X$R]]).name],X$j=X$a[X$k.name],isNaN(X$j)||(X$h.save(),X$h.alpha(X$j)),isNaN(X$T)||-2==X$T||(this._templet.attachmentNames?X$k.showDisplayByName(this._templet.attachmentNames[X$T]):X$k.showDisplayByIndex(X$T)),X$Q[this._drawOrder[X$R]]?(X$x=X$Q[this._drawOrder[X$R]],X$k.currDisplayData&&X$x[X$k.currDisplayData.attachmentName]?X$k.deformData=X$x[X$k.currDisplayData.attachmentName]:X$k.deformData=null):X$k.deformData=null,isNaN(X$j)?X$k.draw(X$h,this._boneMatrixArray,2==this._aniMode):X$k.draw(X$h,this._boneMatrixArray,2==this._aniMode,X$j),isNaN(X$j)||X$h.restore();else for(X$R=0,X$B=this._boneSlotArray.length;X$R<X$B;X$R++)X$T=X$e[(X$k=this._boneSlotArray[X$R]).name],X$j=X$a[X$k.name],isNaN(X$j)||(X$h.save(),X$h.alpha(X$j)),isNaN(X$T)||-2==X$T||(this._templet.attachmentNames?X$k.showDisplayByName(this._templet.attachmentNames[X$T]):X$k.showDisplayByIndex(X$T)),X$Q[X$R]?(X$x=X$Q[X$R],X$k.currDisplayData&&X$x[X$k.currDisplayData.attachmentName]?X$k.deformData=X$x[X$k.currDisplayData.attachmentName]:X$k.deformData=null):X$k.deformData=null,isNaN(X$j)?X$k.draw(X$h,this._boneMatrixArray,2==this._aniMode):X$k.draw(X$h,this._boneMatrixArray,2==this._aniMode,X$j),isNaN(X$j)||X$h.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,X$m,X$h):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,X$m,X$h)},X$m._setDeform=function(X$m,X$p,X$h,X$P){if(X$m){var X$L,X$q,X$k,X$Y=0,X$d=0,X$K=0;if(X$m)for(X$Y=0,X$d=X$m.deformSlotDataList.length;X$Y<X$d;X$Y++)for(X$L=X$m.deformSlotDataList[X$Y],X$K=0;X$K<X$L.deformSlotDisplayList.length;X$K++)X$k=X$h[(X$q=X$L.deformSlotDisplayList[X$K]).slotIndex],X$q.apply(X$P,X$k),X$p[X$q.slotIndex]||(X$p[X$q.slotIndex]={}),X$p[X$q.slotIndex][X$q.attachment]=X$q.deformData}},X$m.getAnimNum=function(){return this._templet.getAnimationCount()},X$m.getAniNameByIndex=function(X$m){return this._templet.getAniNameByIndex(X$m)},X$m.getSlotByName=function(X$m){return this._boneSlotDic[X$m]},X$m.showSkinByName=function(X$m,X$p){void 0===X$p&&(X$p=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(X$m),X$p)},X$m.showSkinByIndex=function(X$m,X$p){void 0===X$p&&(X$p=!0);for(var X$h=0;X$h<this._boneSlotArray.length;X$h++)this._boneSlotArray[X$h].showSlotData(null,X$p);if(this._templet.showSkinByIndex(this._boneSlotDic,X$m,X$p)){var X$P=this._templet.skinDataArray[X$m];this._skinIndex=X$m,this._skinName=X$P.name}this._clearCache()},X$m.showSlotSkinByIndex=function(X$m,X$p){if(0!=this._aniMode){var X$h=this.getSlotByName(X$m);X$h&&X$h.showDisplayByIndex(X$p),this._clearCache()}},X$m.showSlotSkinByName=function(X$m,X$p){if(0!=this._aniMode){var X$h=this.getSlotByName(X$m);X$h&&X$h.showDisplayByName(X$p),this._clearCache()}},X$m.replaceSlotSkinName=function(X$m,X$p,X$h){if(0!=this._aniMode){var X$P=this.getSlotByName(X$m);X$P&&X$P.replaceDisplayByName(X$p,X$h),this._clearCache()}},X$m.replaceSlotSkinByIndex=function(X$m,X$p,X$h){if(0!=this._aniMode){var X$P=this.getSlotByName(X$m);X$P&&X$P.replaceDisplayByIndex(X$p,X$h),this._clearCache()}},X$m.setSlotSkin=function(X$m,X$p){if(0!=this._aniMode){var X$h=this.getSlotByName(X$m);X$h&&X$h.replaceSkin(X$p),this._clearCache()}},X$m._clearCache=function(){if(1==this._aniMode)for(var X$m=0,X$p=this._graphicsCache.length;X$m<X$p;X$m++){for(var X$h=0,X$P=this._graphicsCache[X$m].length;X$h<X$P;X$h++){var X$L=this._graphicsCache[X$m][X$h];X$L!=this.graphics&&X$S.recycle(X$L)}this._graphicsCache[X$m].length=0}},X$m.play=function(X$m,X$p,X$h,X$P,X$L,X$q){void 0===X$h&&(X$h=!0),void 0===X$P&&(X$P=0),void 0===X$L&&(X$L=0),void 0===X$q&&(X$q=!0),this._indexControl=!1;var X$k=-1,X$Y=NaN;if(X$Y=X$p?2147483647:0,"string"==typeof X$m)for(var X$d=0,X$K=this._templet.getAnimationCount();X$d<X$K;X$d++){var X$D=this._templet.getAnimation(X$d);if(X$D&&X$m==X$D.name){X$k=X$d;break}}else X$k=X$m;-1<X$k&&X$k<this.getAnimNum()&&(this._aniClipIndex=X$k,(X$h||this._pause||this._currAniIndex!=X$k)&&(this._currAniIndex=X$k,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(X$k)),this._drawOrder=null,this._eventIndex=0,this._player.play(X$k,this._player.playbackRate,X$Y,X$P,X$L),X$q&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=X$F.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},X$m.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},X$m.playbackRate=function(X$m){this._player&&(this._player.playbackRate=X$m)},X$m.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},X$m.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=X$F.now(),this.timer.frameLoop(1,this,this._update,null,!0))},X$m._getGrahicsDataWithCache=function(X$m,X$p){return this._graphicsCache[X$m][X$p]},X$m._setGrahicsDataWithCache=function(X$m,X$p,X$h){this._graphicsCache[X$m][X$p]=X$h},X$m.destroy=function(X$m){void 0===X$m&&(X$m=!0),X$p.prototype.destroy.call(this,X$m),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},X$q(0,X$m,"url",function(){return this._aniPath},function(X$m){this.load(X$m)}),X$q(0,X$m,"index",function(){return this._index},function(X$m){this.player&&(this._index=X$m,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),X$q(0,X$m,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),X$q(0,X$m,"templet",function(){return this._templet}),X$q(0,X$m,"player",function(){return this._player}),X$h.useSimpleMeshInCanvas=!1,X$h}(X$qm),X$j=function(X$p){function X$L(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,X$L.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}X$P(X$L,"laya.ani.bone.Templet",X$p);var X$m=X$L.prototype;return X$m.getLoadList=function(){return this._loadList},X$m.loadAni=function(X$m){this._skBufferUrl=X$m,X$Lm.loader.load(X$m,X$d.create(this,this.onComplete),null,"arraybuffer")},X$m.onComplete=function(X$m){if(this._isDestroyed)this.destroy();else{var X$p=X$K.getRes(this._skBufferUrl);X$p?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,X$p)):this.event("error","load failed:"+this._skBufferUrl)}},X$m.parseData=function(X$m,X$p,X$h){void 0===X$h&&(X$h=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=X$m,this._mainTexture&&X$n.isWebGL&&X$m.bitmap&&(X$m.bitmap.enableMerageInAtlas=!1),this._rate=X$h,this.parse(X$p)},X$m.buildArmature=function(X$m){return void 0===X$m&&(X$m=0),new X$T(this,X$m)},X$m.parse=function(X$m){X$p.prototype.parse.call(this,X$m),this._endLoaded(),this._aniVersion!=X$L.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+X$L.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},X$m._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var X$m=0;this._loadList=[];var X$p,X$h=new X$Qm(this.getPublicExtData()),X$P=0,X$L=0,X$q=0,X$k=X$h.getInt32(),X$Y=X$h.readUTFString(),X$d=X$Y.split("\n");for(X$m=0;X$m<X$k;X$m++)X$p=this._path+X$d[2*X$m],X$Y=X$d[2*X$m+1],X$h.getFloat32(),X$h.getFloat32(),X$P=X$h.getFloat32(),X$L=X$h.getFloat32(),X$q=X$h.getFloat32(),isNaN(X$q)?0:X$q,X$q=X$h.getFloat32(),isNaN(X$q)?0:X$q,X$q=X$h.getFloat32(),isNaN(X$q)?X$P:X$q,X$q=X$h.getFloat32(),isNaN(X$q)?X$L:X$q,-1==this._loadList.indexOf(X$p)&&this._loadList.push(X$p);this.event("inited",this)}},X$m._textureComplete=function(){for(var X$m,X$p,X$h=0,X$P=this._loadList.length;X$h<X$P;X$h++)X$p=this._loadList[X$h],X$m=this._textureDic[X$p]=X$K.getRes(X$p),X$n.isWebGL&&X$m&&X$m.bitmap&&(X$m.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},X$m._parsePublicExtData=function(){var X$m=0,X$p=0,X$h=0,X$P=0,X$L=0;for(X$m=0,X$L=this.getAnimationCount();X$m<X$L;X$m++)this._graphicsCache.push([]);var X$q;X$q="Dragon"!=this._aniClassName;var X$k,X$Y,X$d=new X$Qm(this.getPublicExtData()),X$K=0,X$D=0,X$F=0,X$R=0,X$$=0,X$A=0,X$B=0,X$n=0,X$c=0,X$e=X$d.getInt32(),X$a=X$d.readUTFString(),X$Z=X$a.split("\n");for(X$m=0;X$m<X$e;X$m++){if(X$k=this._mainTexture,X$Y=this._path+X$Z[2*X$m],X$a=X$Z[2*X$m+1],null==this._mainTexture&&(X$k=this._textureDic[X$Y]),!X$k)return this.event("error",this),void(this.isParseFail=!0);X$K=X$d.getFloat32(),X$D=X$d.getFloat32(),X$F=X$d.getFloat32(),X$R=X$d.getFloat32(),X$c=X$d.getFloat32(),X$$=isNaN(X$c)?0:X$c,X$c=X$d.getFloat32(),X$A=isNaN(X$c)?0:X$c,X$c=X$d.getFloat32(),X$B=isNaN(X$c)?X$F:X$c,X$c=X$d.getFloat32(),X$n=isNaN(X$c)?X$R:X$c,this.subTextureDic[X$a]=X$um.create(X$k,X$K,X$D,X$F,X$R,-X$$,-X$A,X$B,X$n),X$k.alphaTexture&&(this.subTextureDic[X$a].alphaTexture=X$um.create(X$k.alphaTexture,X$K,X$D,X$F,X$R,-X$$,-X$A,X$B,X$n))}this._mainTexture=X$k;var X$H,X$W,X$E,X$I,X$b,X$T=X$d.getUint16();for(X$m=0;X$m<X$T;X$m++)(X$H=[]).push(X$d.getUint16()),X$H.push(X$d.getUint16()),X$H.push(X$d.getUint16()),X$H.push(X$d.getUint16()),this.aniSectionDic[X$m]=X$H;var X$j,X$x=X$d.getInt16(),X$Q={};for(X$m=0;X$m<X$x;X$m++)X$W=new X$Nm,0==X$m?X$j=X$W:X$W.root=X$j,X$W.d=X$q?-1:1,X$I=X$d.readUTFString(),X$b=X$d.readUTFString(),X$W.length=X$d.getFloat32(),1==X$d.getByte()&&(X$W.inheritRotation=!1),1==X$d.getByte()&&(X$W.inheritScale=!1),X$W.name=X$I,X$b&&((X$E=X$Q[X$b])?X$E.addChild(X$W):this.mRootBone=X$W),X$Q[X$I]=X$W,this.mBoneArr.push(X$W);this.tMatrixDataLen=X$d.getUint16();var X$M,X$u,X$N=X$d.getUint16(),X$S=Math.floor(X$N/this.tMatrixDataLen),X$_=this.srcBoneMatrixArr;for(X$m=0;X$m<X$S;X$m++)(X$M=new X$Vm).scX=X$d.getFloat32(),X$M.skX=X$d.getFloat32(),X$M.skY=X$d.getFloat32(),X$M.scY=X$d.getFloat32(),X$M.x=X$d.getFloat32(),X$M.y=X$d.getFloat32(),8===this.tMatrixDataLen&&(X$M.skewX=X$d.getFloat32(),X$M.skewY=X$d.getFloat32()),X$_.push(X$M),(X$W=this.mBoneArr[X$m]).transform=X$M;var X$l,X$J=X$d.getUint16(),X$z=0;for(X$m=0;X$m<X$J;X$m++){for(X$u=new X$Xm,X$z=X$d.getUint16(),X$p=0;X$p<X$z;X$p++)X$u.boneNames.push(X$d.readUTFString()),X$u.boneIndexs.push(X$d.getInt16());X$u.name=X$d.readUTFString(),X$u.targetBoneName=X$d.readUTFString(),X$u.targetBoneIndex=X$d.getInt16(),X$u.bendDirection=X$d.getFloat32(),X$u.mix=X$d.getFloat32(),X$u.isSpine=X$q,this.ikArr.push(X$u)}var X$w,X$X=X$d.getUint16(),X$s=0;for(X$m=0;X$m<X$X;X$m++){for(X$l=new X$ym,X$s=X$d.getUint16(),X$p=0;X$p<X$s;X$p++)X$l.boneIndexs.push(X$d.getInt16());X$l.name=X$d.getUTFString(),X$l.targetIndex=X$d.getInt16(),X$l.rotateMix=X$d.getFloat32(),X$l.translateMix=X$d.getFloat32(),X$l.scaleMix=X$d.getFloat32(),X$l.shearMix=X$d.getFloat32(),X$l.offsetRotation=X$d.getFloat32(),X$l.offsetX=X$d.getFloat32(),X$l.offsetY=X$d.getFloat32(),X$l.offsetScaleX=X$d.getFloat32(),X$l.offsetScaleY=X$d.getFloat32(),X$l.offsetShearY=X$d.getFloat32(),this.tfArr.push(X$l)}var X$G=X$d.getUint16(),X$U=0;for(X$m=0;X$m<X$G;X$m++){for((X$w=new X$sm).name=X$d.readUTFString(),X$U=X$d.getUint16(),X$p=0;X$p<X$U;X$p++)X$w.bones.push(X$d.getInt16());X$w.target=X$d.readUTFString(),X$w.positionMode=X$d.readUTFString(),X$w.spacingMode=X$d.readUTFString(),X$w.rotateMode=X$d.readUTFString(),X$w.offsetRotation=X$d.getFloat32(),X$w.position=X$d.getFloat32(),X$w.spacing=X$d.getFloat32(),X$w.rotateMix=X$d.getFloat32(),X$w.translateMix=X$d.getFloat32(),this.pathArr.push(X$w)}var X$r,X$y,X$V,X$o,X$f,X$i=0,X$v=0,X$g=0,X$t=NaN,X$O=0,X$C=X$d.getInt16();for(X$m=0;X$m<X$C;X$m++){var X$mm=X$d.getUint8(),X$pm={};this.deformAniArr.push(X$pm);for(var X$hm=0;X$hm<X$mm;X$hm++)for((X$r=new X$_m).skinName=X$d.getUTFString(),X$pm[X$r.skinName]=X$r,X$i=X$d.getInt16(),X$p=0;X$p<X$i;X$p++)for(X$y=new X$lm,X$r.deformSlotDataList.push(X$y),X$v=X$d.getInt16(),X$h=0;X$h<X$v;X$h++)for(X$V=new X$Jm,X$y.deformSlotDisplayList.push(X$V),X$V.slotIndex=X$d.getInt16(),X$V.attachment=X$d.getUTFString(),X$g=X$d.getInt16(),X$P=0;X$P<X$g;X$P++)for(1==X$d.getByte()?X$V.tweenKeyList.push(!0):X$V.tweenKeyList.push(!1),X$t=X$d.getFloat32(),X$V.timeList.push(X$t),X$o=[],X$V.vectices.push(X$o),X$O=X$d.getInt16(),X$L=0;X$L<X$O;X$L++)X$o.push(X$d.getFloat32())}var X$Pm,X$Lm,X$qm=X$d.getInt16(),X$km=0,X$Ym=0;for(X$m=0;X$m<X$qm;X$m++){for(X$km=X$d.getInt16(),X$f=[],X$p=0;X$p<X$km;X$p++){for((X$Pm=new X$zm).time=X$d.getFloat32(),X$Ym=X$d.getInt16(),X$h=0;X$h<X$Ym;X$h++)X$Pm.drawOrder.push(X$d.getInt16());X$f.push(X$Pm)}this.drawOrderAniArr.push(X$f)}var X$dm,X$Km=X$d.getInt16(),X$Dm=0;for(X$m=0;X$m<X$Km;X$m++){for(X$Dm=X$d.getInt16(),X$Lm=[],X$p=0;X$p<X$Dm;X$p++)(X$dm=new X$wm).name=X$d.getUTFString(),X$dm.intValue=X$d.getInt32(),X$dm.floatValue=X$d.getFloat32(),X$dm.stringValue=X$d.getUTFString(),X$dm.time=X$d.getFloat32(),X$Lm.push(X$dm);this.eventAniArr.push(X$Lm)}var X$Fm=X$d.getInt16();if(0<X$Fm)for(this.attachmentNames=[],X$m=0;X$m<X$Fm;X$m++)this.attachmentNames.push(X$d.getUTFString());var X$Rm,X$$m,X$Am=X$d.getInt16();for(X$m=0;X$m<X$Am;X$m++)(X$Rm=new X$Sm).name=X$d.readUTFString(),X$Rm.parent=X$d.readUTFString(),X$Rm.attachmentName=X$d.readUTFString(),X$Rm.srcDisplayIndex=X$Rm.displayIndex=X$d.getInt16(),(X$Rm.templet=this).boneSlotDic[X$Rm.name]=X$Rm,null==(X$$m=this.bindBoneBoneSlotDic[X$Rm.parent])&&(this.bindBoneBoneSlotDic[X$Rm.parent]=X$$m=[]),X$$m.push(X$Rm),this.boneSlotArray.push(X$Rm);var X$Bm,X$nm,X$cm,X$em=X$d.readUTFString().split("\n"),X$am=0,X$Zm=X$d.getUint8(),X$Hm=0,X$Wm=0,X$Em=0,X$Im=0,X$bm=0,X$Tm=0,X$jm=0;for(X$m=0;X$m<X$Zm;X$m++){for((X$Bm=new X$Gm).name=X$em[X$am++],X$Hm=X$d.getUint8(),X$p=0;X$p<X$Hm;X$p++){for((X$nm=new X$rm).name=X$em[X$am++],X$Rm=this.boneSlotDic[X$nm.name],X$Wm=X$d.getUint8(),X$h=0;X$h<X$Wm;X$h++){if(X$cm=new X$Um,this.skinSlotDisplayDataArr.push(X$cm),X$cm.name=X$em[X$am++],X$cm.attachmentName=X$em[X$am++],X$cm.transform=new X$Vm,X$cm.transform.scX=X$d.getFloat32(),X$cm.transform.skX=X$d.getFloat32(),X$cm.transform.skY=X$d.getFloat32(),X$cm.transform.scY=X$d.getFloat32(),X$cm.transform.x=X$d.getFloat32(),X$cm.transform.y=X$d.getFloat32(),X$nm.displayArr.push(X$cm),X$cm.width=X$d.getFloat32(),X$cm.height=X$d.getFloat32(),X$cm.type=X$d.getUint8(),X$cm.verLen=X$d.getUint16(),0<(X$x=X$d.getUint16()))for(X$cm.bones=[],X$P=0;X$P<X$x;X$P++){var X$xm=X$d.getUint16();X$cm.bones.push(X$xm)}if(0<(X$Em=X$d.getUint16()))for(X$cm.uvs=[],X$P=0;X$P<X$Em;X$P++)X$cm.uvs.push(X$d.getFloat32());if(0<(X$Im=X$d.getUint16()))for(X$cm.weights=[],X$P=0;X$P<X$Im;X$P++)X$cm.weights.push(X$d.getFloat32());if(0<(X$bm=X$d.getUint16()))for(X$cm.triangles=[],X$P=0;X$P<X$bm;X$P++)X$cm.triangles.push(X$d.getUint16());if(0<(X$Tm=X$d.getUint16()))for(X$cm.vertices=[],X$P=0;X$P<X$Tm;X$P++)X$cm.vertices.push(X$d.getFloat32());if(0<(X$jm=X$d.getUint16()))for(X$cm.lengths=[],X$P=0;X$P<X$jm;X$P++)X$cm.lengths.push(X$d.getFloat32())}X$Bm.slotArr.push(X$nm)}this.skinDic[X$Bm.name]=X$Bm,this.skinDataArray.push(X$Bm)}1==X$d.getUint8()?(this.yReverseMatrix=new X$Mm(1,0,0,-1,0,0),X$j&&X$j.setTempMatrix(this.yReverseMatrix)):X$j&&X$j.setTempMatrix(new X$Mm),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},X$m.getTexture=function(X$m){var X$p=this.subTextureDic[X$m];return X$p||(X$p=this.subTextureDic[X$m.substr(0,X$m.length-1)]),null==X$p?this._mainTexture:X$p},X$m.showSkinByIndex=function(X$m,X$p,X$h){if(void 0===X$h&&(X$h=!0),X$p<0&&X$p>=this.skinDataArray.length)return!1;var X$P,X$L,X$q=0,X$k=0,X$Y=this.skinDataArray[X$p];if(X$Y){for(X$q=0,X$k=X$Y.slotArr.length;X$q<X$k;X$q++)(X$L=X$Y.slotArr[X$q])&&(X$P=X$m[X$L.name])&&(X$P.showSlotData(X$L,X$h),X$h&&"undefined"!=X$P.attachmentName&&"null"!=X$P.attachmentName?X$P.showDisplayByName(X$P.attachmentName):X$P.showDisplayByIndex(X$P.displayIndex));return!0}return!1},X$m.getSkinIndexByName=function(X$m){for(var X$p=0,X$h=this.skinDataArray.length;X$p<X$h;X$p++)if(this.skinDataArray[X$p].name==X$m)return X$p;return-1},X$m.getGrahicsDataWithCache=function(X$m,X$p){return this._graphicsCache[X$m][X$p]},X$m.setGrahicsDataWithCache=function(X$m,X$p,X$h){this._graphicsCache[X$m][X$p]=X$h},X$m.destroy=function(){var X$m;for(var X$p in this._isDestroyed=!0,this.subTextureDic)(X$m=this.subTextureDic[X$p])&&X$m.destroy();for(X$p in this._textureDic)(X$m=this._textureDic[X$p])&&X$m.destroy();for(var X$h=0,X$P=this.skinSlotDisplayDataArr.length;X$h<X$P;X$h++)this.skinSlotDisplayDataArr[X$h].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete X$L.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},X$m.getAniNameByIndex=function(X$m){var X$p=this.getAnimation(X$m);return X$p?X$p.name:null},X$q(0,X$m,"rate",function(){return this._rate},function(X$m){this._rate=X$m}),X$L.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",X$L.TEMPLET_DICTIONARY=null,X$L}(X$_)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(X$m,X$p){"use strict";for(var X$h in Object.defineProperty(X$p,"__esModule",{value:!0}),Laya){var X$P=Laya[X$h];X$P&&X$P.__isclass&&(X$p[X$h]=X$P)}});