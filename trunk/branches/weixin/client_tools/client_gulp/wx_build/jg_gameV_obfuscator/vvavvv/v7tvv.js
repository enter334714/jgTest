var Q=wx.$v;import sdk from"../utils/gameSDK.bundle";var config={game_id:256,game_pkg:Q[361795],partner_label:"kk",partner_id:Q[361796],game_ver:Q[361797],is_auth:!1,tmpId:{1:"",2:"",3:""}};window.config=config;var _v6KDO$=_v6D$OK();var HOST=Q[361798];var _v6KD$O=null;var _v6DO$K=null;var sysInfo=wx.getSystemInfoSync();var platform=sysInfo.platform;var partner_user_info=null;function _v6D$OK(){var o={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0;console.log(Q[361799]);var t=this;var n;n=wx.getStorageSync(Q[361800])?0:(n=t.uuid(16,32),wx.setStorageSync(Q[361800],n),1),wx.getStorageSync(Q[361801])||(o=t.uuid(16,32),wx.setStorageSync(Q[361801],o));var o=wx.getLaunchOptionsSync();var a=o.scene||"";n&&o.query&&o.query.ad_code&&wx.setStorageSync(Q[361802],o.query.ad_code),t.log(Q[361803],{install:n,scene:a}),wx.showShareMenu();t=o.query&&o.query.invite?o.query.invite:"";o=o.query&&o.query.invite_type?o.query.invite_type:"";t&&(_v6DO$K={invite:t,invite_type:o,is_new:n,scene:a}),e&&this.checkGameVersion(e,function(e){r&&r(e)})},login:function(e,r){console.log(Q[361804]),o[Q[360259]]=typeof r==Q[361007]?r:null;var t=this;wx.getLaunchOptionsSync();sdk.init(()=>{console.log(Q[361805],Date.parse(new Date)/1e3),sdk.entryGame(()=>{console.log(Q[361806]),console.log(Q[361807],Date.parse(new Date)/1e3),sdk.cpSDK.loginUserInfo(e=>{wx.setStorageSync(Q[361808],e.openid),partner_user_info=e,t.do_login(e)})},e=>{console.log(Q[361809],e)})},e=>{console.log(Q[361810],e)})},do_login:function(e){var t=this;var r=t.getPublicData();if(r[Q[361811]]=JSON.stringify(e),_v6DO$K&&typeof _v6DO$K==Q[360907])for(var n in _v6DO$K)r[n]=_v6DO$K[n];wx.request({url:Q[361812]+HOST+Q[361813],method:Q[360224],dataType:Q[361252],header:{"content-type":Q[360404]},data:r,success:function(e){if(console.log(Q[361814]+JSON.stringify(e)),200==e.statusCode){e=e.data;if(e.state){try{wx.setStorageSync(Q[361815],e.data.sdk_token),wx.setStorageSync(Q[361816],e.data.user_id),wx.setStorageSync(Q[361817],e.data.username),e.data.ext&&wx.setStorageSync(Q[361818],e.data.ext)}catch(e){}var r={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};o[Q[360259]]&&o[Q[360259]](0,r)}else o[Q[360259]]&&o[Q[360259]](1,{errMsg:e.msg});t.getShareInfo(Q[361819],function(e){console.log(Q[361820]),wx.onShareAppMessage(function(){return t.logStartShare(Q[361819]),{title:e.title,imageUrl:e.img,query:e.query}})})}else o[Q[360259]]&&o[Q[360259]](1,{errMsg:Q[361821]})}})},share:function(e){o[Q[360361]]=typeof callback==Q[361007]?callback:null;var r=e.type||Q[360361];console.log(Q[361822]+r);var t=this;this.getShareInfo(r,function(e){t.logStartShare(r);e.query;t.logStartShare(r),wx.shareAppMessage({title:e.title,imageUrl:e.img,query:e.query})})},logStartShare:function(e){var r=wx.getStorageSync(Q[361815]);wx.request({url:Q[361812]+HOST+Q[361823],method:Q[360224],dataType:Q[361252],header:{"content-type":Q[360404]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:_v6KD$O?_v6KD$O.server_id:"",role_id:_v6KD$O?_v6KD$O.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,t){console.log(Q[361824]);wx.getStorageSync(Q[361815]);wx.request({url:Q[361812]+HOST+Q[361825],method:Q[360224],dataType:Q[361252],header:{"content-type":Q[360404]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(Q[361826]+JSON.stringify(e)),200==e.statusCode&&(r=e.data).state?t&&t(r.data):t&&t({develop:0})}})},getShareInfo:function(e,r){console.log(Q[361827]);var t=wx.getStorageSync(Q[361815]);wx.request({url:Q[361812]+HOST+Q[361828],method:Q[360224],dataType:Q[361252],header:{"content-type":Q[360404]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,type:e,server_id:_v6KD$O?_v6KD$O.server_id:"",role_id:_v6KD$O?_v6KD$O.role_id:"",no_log:1},success:function(e){console.log(Q[361829]),console.log(e),200==e.statusCode?(e=e.data).state?r&&r(e.data):o[Q[360361]]&&o[Q[360361]](1,{errMsg:Q[361830]+e.msg}):o[Q[360361]]&&o[Q[360361]](1,{errMsg:Q[361831]})}})},updateShare:function(e,r,t,n,o,a){console.log(Q[361832]);var i=wx.getStorageSync(Q[361815]);wx.request({url:Q[361812]+HOST+Q[361833],method:Q[360224],dataType:Q[361252],header:{"content-type":Q[360404]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:r,is_new:t,role_id:n,sever_id:o,scene:a},success:function(e){console.log(Q[361834]+JSON.stringify(e))}})},msgCheck:function(e,r){console.log(Q[361835]+e);let t={data:{}};var n=wx.getStorageSync(Q[361808]);wx.request({url:Q[361812]+HOST+Q[361836]+config.partner_id+"/"+config.game_pkg,method:Q[360224],dataType:Q[361252],header:{"content-type":Q[360404]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,content:e,open_id:n},success:function(e){1==e.data.state?(t.statusCode=200,t.data.state=1):(t.statusCode=0,t.data.state=0),console.log(Q[361837]),console.log(e),r&&r(t)}})},pay:function(e,r){this.startPay(e,r)},startPay:function(e,r){console.log(Q[361838]+JSON.stringify(e));o[Q[360343]]=typeof r==Q[361007]?r:null;r=wx.getStorageSync(Q[361815]);var t=wx.getStorageSync(Q[361818]);r?(e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:r,session_key:t,platform:platform,uid:partner_user_info.uid},this.order_data=e,(r=this.getPublicData())[Q[361840]]=JSON.stringify(e),wx.request({url:Q[361812]+HOST+Q[361841],method:Q[360224],dataType:Q[361252],header:{"content-type":Q[360404]},data:r,success:function(e){console.log(Q[361842]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?sdk.cpSDK.makePayment(e.data.pay_data):o[Q[360343]]&&o[Q[360343]](1,{errMsg:e.msg}):o[Q[360259]]&&o[Q[360259]](1,{errMsg:Q[361821]})}})):o[Q[360343]]&&o[Q[360343]](1,{errMsg:Q[361839]})},logCreateRole:function(e){var r=wx.getStorageSync(Q[361816]);var t=wx.getStorageSync(Q[361817]);var n={};n[Q[361843]]=r,n[Q[361844]]=t,n[Q[361845]]=e.roleid,n[Q[361846]]=e.rolelevel,n[Q[361847]]=e.rolename,n[Q[360023]]=e.serverid,e.roleid&&e.serverid&&(_v6KD$O={role_id:e.roleid,server_id:e.serverid}),this.log(Q[360484],n);r={data_type:2,zone_id:e.serverid,zone_name:e.servername,role_id:e.roleid,role_name:e.rolename,role_level:e.rolelevel,role_currency:1};sdk.cpSDK.dataReport(r)},logEnterGame:function(e){var r=wx.getStorageSync(Q[361816]);var t=wx.getStorageSync(Q[361817]);var n={};n[Q[361843]]=r,n[Q[361844]]=t,n[Q[361845]]=e.roleid,n[Q[361846]]=e.rolelevel,n[Q[361847]]=e.rolename,n[Q[360023]]=e.serverid,e.roleid&&e.serverid&&(_v6KD$O={role_id:e.roleid,server_id:e.serverid}),this.log(Q[361848],n),_v6DO$K&&this.updateShare(_v6DO$K.invite,_v6DO$K.invite_type,_v6DO$K.is_new,e.roleid,e.serverid,_v6DO$K.scene);r={data_type:3,zone_id:e.serverid,zone_name:e.servername,role_id:e.roleid,role_name:e.rolename,role_level:e.rolelevel,role_currency:1};sdk.cpSDK.dataReport(r)},logRoleUpLevel:function(e){var r=wx.getStorageSync(Q[361816]);var t=wx.getStorageSync(Q[361817]);var n={};n[Q[361843]]=r,n[Q[361844]]=t,n[Q[361845]]=e.roleid,n[Q[361846]]=e.rolelevel,n[Q[361847]]=e.rolename,n[Q[360023]]=e.serverid,e.roleid&&e.serverid&&(_v6KD$O={role_id:e.roleid,server_id:e.serverid}),this.log(Q[361849],n);r={data_type:4,zone_id:e.serverid,zone_name:e.servername,role_id:e.roleid,role_name:e.rolename,role_level:e.rolelevel,role_currency:1};sdk.cpSDK.dataReport(r)},uuid:function(e,r){var t=Q[361850].split("");var n,o=[];var a;if(e=e||t.length,r)for(n=0;n<r;n++)o[n]=t[0|Math.random()*e];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",n=0;n<36;n++)o[n]||(a=0|16*Math.random(),o[n]=t[19==n?3&a|8:a]);return o.join("")},getPublicData:function(){var e=wx.getStorageSync(Q[361800]);var r=wx.getStorageSync(Q[361801]);var t=wx.getStorageSync(Q[361802]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:t,uuid:e,idfv:r,mac:Q[361851],is_from_min:1,dname:sysInfo.model,net_type:0==sysInfo.wifiSignal?"4G":Q[361852],os_ver:sysInfo.system,sdk_ver:sysInfo.version,game_ver:config.game_ver,device:sysInfo.platform==Q[360110]?1:2}},subscribeMessage:function(e,r){console.log(Q[361853]+e),o[Q[360372]]=typeof r==Q[361007]?r:null,wx.requestSubscribeMessage({tmplIds:e,success(e){console.log(Q[361854]),console.log(e),o[Q[360372]]&&o[Q[360372]](e)},fail(e){console.log(Q[361855]),console.log(e),o[Q[360372]]&&o[Q[360372]](e)}})},log:function(e,r){var t=this.getPublicData();for(var n in r)t[n]=r[n];console.log(Q[361856]+e),console.log(t),wx.request({url:Q[361812]+HOST+Q[361857]+e+Q[361858]+encodeURIComponent(JSON.stringify(t))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(){},setMessageToFriendQuery:function(e,r){e=e.activity_id;r(wx.setMessageToFriendQuery({shareMessageToFriendScene:e}))}}}function run(e,r,t){e in _v6KDO$&&_v6KDO$[e](r,t)}exports.init=function(e,r){run(Q[360237],e,r)},exports.subscribeMessage=function(e,r){run(Q[360372],e,r)},exports.login=function(e){run(Q[360259],"",e)},exports.login=function(e){run(Q[360259],"",e)},exports.pay=function(e,r){run(Q[360343],e,r)},exports.openService=function(){run(Q[360362])},exports.logCreateRole=function(e,r,t,n,o){run(Q[360356],{serverid:e,servername:r,roleid:t,rolename:n,rolelevel:o})},exports.logEnterGame=function(e,r,t,n,o){run(Q[360358],{serverid:e,servername:r,roleid:t,rolename:n,rolelevel:o})},exports.logRoleUpLevel=function(e,r,t,n,o){run(Q[360360],{serverid:e,servername:r,roleid:t,rolename:n,rolelevel:o})},exports.share=function(e){run(Q[360361],{type:e})},exports.msgCheck=function(e,r){run(Q[360200],e,r)},exports.downloadClient=function(){run(Q[361859])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(Q[361860])},exports.weiduanHelper=function(){run(Q[360364])},exports.setMessageToFriendQuery=function(e,r){run(Q[361861],e,r)};