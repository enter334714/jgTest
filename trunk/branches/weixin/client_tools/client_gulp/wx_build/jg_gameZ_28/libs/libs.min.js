var Laya=window.Laya=function($H,$I){var $B={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function($I,$M){return 1==arguments.length?$B.__presubstr.call(this,$I):$B.__presubstr.call(this,$I,0<$M?$M:this.length+$M)},__init:function($I){$I.forEach(function($I){$I.__init$&&$I.__init$()})},__isClass:function($I){return $I&&($I.__isclass||$I==Object||$I==String||$I==Array)},__newvec:function($I,$M){var $E=[];$E.length=$I;for(var $Z=0;$Z<$I;$Z++)$E[$Z]=$M;return $E},__extend:function($I,$M){for(var $E in $M)if($M.hasOwnProperty($E)){var $Z=Object.getOwnPropertyDescriptor($M,$E),$i=$Z.get,$n=$Z.set;$i||$n?$i&&$n?Object.defineProperty($I,$E,$Z):($i&&Object.defineProperty($I,$E,$i),$n&&Object.defineProperty($I,$E,$n)):$I[$E]=$M[$E]}function $c(){$B.un(this,"constructor",$I)}$c.prototype=$M.prototype,$I.prototype=new $c,$B.un($I.prototype,"__imps",$B.__copy({},$M.prototype.__imps))},__copy:function($I,$M){if(!$M)return null;for(var $E in $I=$I||{},$M)$I[$E]=$M[$E];return $I},__package:function($I,$M){if(!$B.__packages[$I]){$B.__packages[$I]=!0;var $E=$H,$Z=$I.split(".");if(1<$Z.length)for(var $i=0,$n=$Z.length-1;$i<$n;$i++){var $c=$E[$Z[$i]];$E=$c||($E[$Z[$i]]={})}$E[$Z[$Z.length-1]]||($E[$Z[$Z.length-1]]=$M||{})}},__hasOwnProperty:function($I,$M){return $M=$M||this,Object.hasOwnProperty.call($M,$I)||function $I($M,$E){if(Object.hasOwnProperty.call($E.prototype,$M))return!0;var $Z=$E.prototype.__super;return null==$Z?null:$I($M,$Z)}($I,$M.__class)},__typeof:function($I,$M){if(!$I||!$M)return!1;if($M===String)return"string"==typeof $I;if($M===Number)return"number"==typeof $I;if($M.__interface__)$M=$M.__interface__;else if("string"!=typeof $M)return $I instanceof $M;return $I.__imps&&$I.__imps[$M]||$I.__class==$M},__as:function($I,$M){return this.__typeof($I,$M)?$I:null},__int:function($I){return $I?parseInt($I):0},interface:function($I,$M){$B.__package($I,{});var $E=$B.__internals,$Z=$E[$I]=$E[$I]||{self:$I};if($M){var $i=$M.split(",");$Z.extend=[];for(var $n=0;$n<$i.length;$n++){var $c=$i[$n];$E[$c]=$E[$c]||{self:$c},$Z.extend.push($E[$c])}}var $f=$H,$d=$I.split(".");for($n=0;$n<$d.length-1;$n++)$f=$f[$d[$n]];$f[$d[$d.length-1]]={__interface__:$I}},class:function($I,$M,$E,$Z){if($E&&$B.__extend($I,$E),$M)if($B.__package($M,$I),$B.__classmap[$M]=$I,0<$M.indexOf(".")){if(0==$M.indexOf("laya.")){var $i=$M.split(".");$Z=$Z||$i[$i.length-1],$B[$Z]&&console.log("Warning!,this class["+$Z+"] already exist:",$B[$Z]),$B[$Z]=$I}}else"Main"==$M?$H.Main=$I:"MainWX"==$M?$H.MainWX=$I:($B[$M]&&console.log("Error!,this class["+$M+"] already exist:",$B[$M]),$B[$M]=$I);var $n=$B.un,$c=$I.prototype;$n($c,"hasOwnProperty",$B.__hasOwnProperty),$n($c,"__class",$I),$n($c,"__super",$E),$n($c,"__className",$M),$n($I,"__super",$E),$n($I,"__className",$M),$n($I,"__isclass",!0),$n($I,"super",function($I){this.__super.call($I)})},imps:function($I,$M){if(!$M)return null;var $i=$I.__imps||$B.un($I,"__imps",{});function $n($I){var $M,$E;if(($M=$B.__internals[$I])&&($i[$I]=!0,$E=$M.extend))for(var $Z=0;$Z<$E.length;$Z++)$n($E[$Z].self)}for(var $E in $M)$n($E)},superSet:function($I,$M,$E,$Z){var $i=$I.prototype["_$set_"+$E];$i&&$i.call($M,$Z)},superGet:function($I,$M,$E){var $Z=$I.prototype["_$get_"+$E];return $Z?$Z.call($M):null},getset:function($I,$M,$E,$Z,$i){$I?($Z&&($M["_$GET_"+$E]=$Z),$i&&($M["_$SET_"+$E]=$i)):($Z&&$B.un($M,"_$get_"+$E,$Z),$i&&$B.un($M,"_$set_"+$E,$i)),$Z&&$i?Object.defineProperty($M,$E,{get:$Z,set:$i,enumerable:!1,configurable:!0}):($Z&&Object.defineProperty($M,$E,{get:$Z,enumerable:!1,configurable:!0}),$i&&Object.defineProperty($M,$E,{set:$i,enumerable:!1,configurable:!0}))},static:function($E,$Z){for(var $i=0,$I=$Z.length;$i<$I;$i+=2)if("length"==$Z[$i])$E.length=$Z[$i+1].call($E);else{function $M(){var $M=$Z[$i],$I=$Z[$i+1];Object.defineProperty($E,$M,{get:function(){return delete this[$M],this[$M]=$I.call(this)},set:function($I){delete this[$M],this[$M]=$I},enumerable:!0,configurable:!0})}$M()}},un:function($I,$M,$E){return $E||($E=$I[$M]),$B.__propun.value=$E,Object.defineProperty($I,$M,$B.__propun),$E},uns:function($M,$I){$I.forEach(function($I){$B.un($M,$I)})}};return $H.console=$H.console||{log:function(){}},$H.trace=$H.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),$B}(window,document);!function($I,$M,$E){$E.un,$E.uns,$E.static,$E.class,$E.getset,$E.__newvec}(window,document,Laya),function($c,$M,$a){$a.un,$a.uns;var $d=$a.static,$V=$a.class,$B=$a.getset;$a.__newvec;$a.interface("laya.runtime.IMarket"),$a.interface("laya.filters.IFilter"),$a.interface("laya.display.ILayout"),$a.interface("laya.resource.IDispose"),$a.interface("laya.runtime.IPlatform"),$a.interface("laya.resource.IDestroy"),$a.interface("laya.runtime.IConchNode"),$a.interface("laya.filters.IFilterAction"),$a.interface("laya.runtime.ICPlatformClass"),$a.interface("laya.resource.ICreateResource"),$a.interface("laya.runtime.IConchRenderObject"),$a.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var $W=function(){function $n(){}return $V($n,"laya.utils.RunDriver"),$n.FILTER_ACTIONS=[],$n.pixelRatio=-1,$n._charSizeTestDiv=null,$n.now=function(){return Date.now()},$n.getWindow=function(){return $c},$n.getPixelRatio=function(){if($n.pixelRatio<0){var $I=$x.context,$M=$I.backingStorePixelRatio||$I.webkitBackingStorePixelRatio||$I.mozBackingStorePixelRatio||$I.msBackingStorePixelRatio||$I.oBackingStorePixelRatio||$I.backingStorePixelRatio||1;($n.pixelRatio=($x.window.devicePixelRatio||1)/$M)<1&&($n.pixelRatio=1)}return $n.pixelRatio},$n.getIncludeStr=function($I){return null},$n.createShaderCondition=function($I){var $M="(function() {return "+$I+";})";return $a._runScript($M)},$n.fontMap=[],$n.measureText=function($I,$M){var $E=$n.hanzi.test($I);if($E&&$n.fontMap[$M])return $n.fontMap[$M];var $Z=$x.context;$Z.font=$M;var $i=$Z.measureText($I);return $i||($i={width:16,height:16}),$E&&($n.fontMap[$M]=$i),$i},$n.getWebGLContext=function($I){},$n.beginFlush=function(){},$n.endFinish=function(){},$n.addToAtlas=null,$n.flashFlushImage=function($I){},$n.drawToCanvas=function($I,$M,$E,$Z,$i,$n){var $c=$$I.create("2D"),$f=new $S($E,$Z,$c);return $X.renders[$M]._fun($I,$f,$i,$n),$c},$n.createParticleTemplate2D=null,$n.createGLTextur=null,$n.createWebGLContext2D=null,$n.changeWebGLSize=function($I,$M){},$n.createRenderSprite=function($I,$M){return new $X($I,$M)},$n.createFilterAction=function($I){return new $$},$n.createGraphics=function(){return new $Q},$n.clear=function($I){$o._context.ctx.clear()},$n.cancelLoadByUrl=function($I){},$n.clearAtlas=function($I){},$n.isAtlas=function($I){return!1},$n.addTextureToAtlas=function($I){},$n.getTexturePixels=function($I,$M,$E,$Z,$i){return null},$n.skinAniSprite=function(){return null},$n.update3DLoop=function(){},$d($n,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),$n}(),$Z=($B(1,$a,"alertGlobalError",null,function($I){var $n=0;$x.window.onerror=$I?function($I,$M,$E,$Z,$i){$n++<5&&$i&&alert($i.stack||$i)}:null}),$a.init=function($I,$M,$E){for(var $Z=[],$i=2,$n=arguments.length;$i<$n;$i++)$Z.push(arguments[$i]);if(!$a._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=$a._arrayBufferSlice),$a._isinit=!0,$x.__init__(),$C.__init__(),$Q.__init__(),$a.timer=new $G,$a.scaleTimer=new $G,$a.loader=new $dI,$b.__init__(),$i=0;for(var $c=$Z.length;$i<$c;$i++)$Z[$i].enable&&$Z[$i].enable();return $p.__init__(),$f.__init__(),$J.__init__(),$r.beginCheck(),$a._currentStage=$a.stage=new $NI,$a.stage.conchModel&&$a.stage.conchModel.setRootNode(),$a._getUrlPath(),$a.render=new $o(0,0),$a.stage.size($I,$M),$X.__init__(),$A.__init__(),$t.instance.__init__($a.stage,$o.canvas),$gI.__init__(),$v.autoStopMusic=!0,$T.__init__(),$o.canvas}},$a._getUrlPath=function(){var $I=$x.window.location,$M=$I.pathname;$M=$M&&":"==$M.charAt(2)?$M.substring(1):$M,$L.rootPath=$L.basePath=$L.getPath("file:"==$I.protocol?$M:$I.protocol+"//"+$I.host+$I.pathname)},$a._arrayBufferSlice=function($I,$M){var $E=new Uint8Array(this,$I,$M-$I),$Z=new Uint8Array($E.length);return $Z.set($E),$Z.buffer},$a._runScript=function($I){return $x.window[$a._evcode]($I)},$a.stage=null,$a.timer=null,$a.scaleTimer=null,$a.loader=null,$a.version="1.8.6",$a.render=null,$a._currentStage=null,$a._isinit=!1,$a.isDebug=!1,$a.MiniAdpter={init:function(){$c.navigator&&$c.navigator.userAgent&&-1<$c.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},$d($a,["conchMarket",function(){return this.conchMarket=$c.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=$c.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function $I(){}return $V($I,"Config"),$I.WebGLTextCacheCount=500,$I.atlasEnable=!1,$I.showCanvasMark=!1,$I.animationInterval=50,$I.isAntialias=!1,$I.isAlpha=!1,$I.premultipliedAlpha=!0,$I.isStencil=!0,$I.preserveDrawingBuffer=!1,$I}()),$H=function(){function $H(){this._events=null}$V($H,"laya.events.EventDispatcher");var $I=$H.prototype;return $I.hasListener=function($I){return!!(this._events&&this._events[$I])},$I.getListener=function($I){return this._events?this._events[$I]:null},$I.event=function($I,$M){if(!this._events||!this._events[$I])return!1;var $E=this._events[$I];if($E.lock)$E.queue||($E.queue=[]),$E.queue.push($M);else{var $Z;for($E.lock=!0,$E.cursor=$E.head;$E.cursor;)($Z=$E.cursor).recover?($E.head=$E.tail=$E.cursor=null,console.error("node is recover："+$Z.id)):($E.cursor=$Z.next,$Z.once&&$H.delNode($E,$Z),$Z.method&&(null!=$M?$Z.args?$Z.method.apply($Z.caller,$Z.args.concat($M)):$M instanceof Array?$Z.method.apply($Z.caller,$M):$Z.caller?$Z.method.call($Z.caller,$M):$a.recordError("事件派发错误","node.caller:"+$Z.caller+"node.method:"+$Z.method+"data:"+$M+"node.prev"+$Z.prev):$Z.method.apply($Z.caller,$Z.args)),$Z.once&&$H.recoverHandler($Z));$E.lock=!1,!$E.head&&this._events&&this._events[$I]==$E&&delete this._events[$I],$E.queue&&$E.queue.length&&this.event($I,$E.queue.shift())}return!0},$I.on=function($I,$M,$E,$Z){return this._createListener($I,$M,$E,$Z,!1)},$I.once=function($I,$M,$E,$Z){return this._createListener($I,$M,$E,$Z,!0)},$I._createListener=function($I,$M,$E,$Z,$i,$n){void 0===$n&&($n=!0),$n&&this.off($I,$M,$E,$i);var $c=$H.createHandler($M||this,$E,$Z,$i);this._events||(this._events={});var $f=this._events,$d=$f[$I];return $d?$d.tail?($c.prev=$d.tail,$d.tail.next=$c,$d.tail=$c):$d.head=$d.tail=$c:$f[$I]={head:$c,tail:$c,cursor:null,lock:!1},this},$I.off=function($I,$M,$E,$Z){if(void 0===$Z&&($Z=!1),!this._events||!this._events[$I])return this;for(var $i=this._events[$I],$n=$i.head;$n;){if((!$M||$n.caller===$M)&&$n.method===$E&&(!$Z||$n.once)){$H.delNode($i,$n),$i.cursor==$n&&($i.cursor=$n.next),$H.recoverHandler($n);break}$n=$n.next}return this},$I.offAll=function($I){var $M=this._events;if(!$M)return this;if($I)this._recoverHandlers($M[$I]),delete $M[$I];else{for(var $E in $M)this._recoverHandlers($M[$E]);this._events=null}return this},$I._recoverHandlers=function($I){if($I){for(var $M=$I.head;$M;){$H.delNode($I,$M);var $E=$M.next;$H.recoverHandler($M),$M=$E}$I.cursor=null}},$I.isMouseEvent=function($I){return $H.MOUSE_EVENTS[$I]},$H.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},$H.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},$H.delNode=function($I,$M){$M.prev?$M.prev.next=$M.next:$I.head=$M.next,$M.next?$M.next.prev=$M.prev:$I.tail=$M.prev},$H.createHandler=function($I,$M,$E,$Z){var $i=500<$H._freeHandler.length?$H._freeHandler.shift():null;if($i)if($i.recover)$i.recover=!1,$i.caller=$I,$i.method=$M,$i.args=$E,$i.once=$Z;else{var $n="";try{arguments.propertyIsEnumerable.caller}catch($I){$n=$I.stack}var $c=$i.caller?($i.caller.__proto__&&$i.caller.__proto__.constructor&&$i.caller.__proto__.constructor.name)+"|"+$i.caller.__className+"|"+$i.caller.name:"",$f=$i.method?$i.method.name:"";$a.recordError("EventDispatcher重复创建","caller="+$c+"  method="+$f+"  stack="+$n),$i={id:++$H._nodeCount,caller:$I,method:$M,args:$E,once:$Z,recover:!1}}else $i={id:++$H._nodeCount,caller:$I,method:$M,args:$E,once:$Z,recover:!1};return $i.prev=$i.next=null,$i},$H.recoverHandler=function($I){if($I.recover){if($H._errorCount<5){$H._errorCount++;var $M="";try{arguments.propertyIsEnumerable.caller}catch($I){$M=$I.stack}var $E=$I.caller?($I.caller.__proto__&&$I.caller.__proto__.constructor&&$I.caller.__proto__.constructor.name)+"|"+$I.caller.__className+"|"+$I.caller.name:"",$Z=$I.method?$I.method.name:"";$a.recordError("EventDispatcher重复回收","id="+$I.id+"  caller="+$E+"  method="+$Z+"  stack="+$M)}$I.caller=$I.method=$I.args=$I.prev=null}else $I.recover=!0,$I.caller=$I.method=$I.args=$I.prev=$I.next=null,$H._freeHandler&&$H._freeHandler.length<3e3&&$H._freeHandler.push($I)},$H._freeHandler=[],$H._nodeCount=0,$H._errorCount=0,$H}(),$y=function(){function $i($I,$M,$E,$Z){this.once=!1,void(this._id=0)===$Z&&($Z=!1),this.setTo($I,$M,$E,$Z)}$V($i,"laya.utils.Handler");var $I=$i.prototype;return $I.setTo=function($I,$M,$E,$Z){return this._id=$i._gid++,this.caller=$I,this.method=$M,this.args=$E,this.once=$Z,this},$I.run=function(){if(null==this.method)return null;var $I=this._id,$M=this.method.apply(this.caller,this.args);return this._id===$I&&this.once&&this.recover(),$M},$I.runWith=function($I){if(null==this.method)return null;var $M=this._id;if(null==$I)var $E=this.method.apply(this.caller,this.args);else $E=this.args||$I.unshift?this.args?this.method.apply(this.caller,this.args.concat($I)):this.method.apply(this.caller,$I):this.method.call(this.caller,$I);return this._id===$M&&this.once&&this.recover(),$E},$I.clear=function(){return this.caller=null,this.method=null,this.args=null,this},$I.recover=function(){0<this._id&&(this._id=0,this.clear())},$i.create=function($I,$M,$E,$Z){return void 0===$Z&&($Z=!0),new $i($I,$M,$E,$Z)},$i._gid=1,$i}(),$q=function(){function $I(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}$V($I,"laya.display.BitmapFont");var $M=$I.prototype;return $M.loadFont=function($I,$M){this._path=$I,this._complete=$M,$a.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],$y.create(this,this.onLoaded))},$M.onLoaded=function(){this.parseFont($fI.getRes(this._path),$fI.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},$M.parseFont=function($I,$M){if(null!=$I&&null!=$M){this._texture=$M;var $E=$I.getElementsByTagName("info");if(!$E[0].getAttributeNode)return this.parseFont2($I,$M);this.fontSize=parseInt($E[0].getAttributeNode("size").nodeValue);var $Z,$i=$E[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt($i[0]),parseInt($i[1]),parseInt($i[2]),parseInt($i[3])],$Z=$I.getElementsByTagName("char");var $n=0;for($n=0;$n<$Z.length;$n++){var $c=$Z[$n],$f=parseInt($c.getAttributeNode("id").nodeValue),$d=parseInt($c.getAttributeNode("xoffset").nodeValue)/1,$H=parseInt($c.getAttributeNode("yoffset").nodeValue)/1,$B=parseInt($c.getAttributeNode("xadvance").nodeValue)/1,$A=new $j;$A.x=parseInt($c.getAttributeNode("x").nodeValue),$A.y=parseInt($c.getAttributeNode("y").nodeValue),$A.width=parseInt($c.getAttributeNode("width").nodeValue),$A.height=parseInt($c.getAttributeNode("height").nodeValue);var $Q=$BI.create($M,$A.x,$A.y,$A.width,$A.height,$d,$H);this._maxWidth=Math.max(this._maxWidth,$B+this.letterSpacing),this._fontCharDic[$f]=$Q,this._fontWidthMap[$f]=$B}}},$M.parseFont2=function($I,$M){if(null!=$I&&null!=$M){this._texture=$M;var $E=$I.getElementsByTagName("info");this.fontSize=parseInt($E[0].attributes.size.nodeValue);var $Z=$E[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt($Z[0]),parseInt($Z[1]),parseInt($Z[2]),parseInt($Z[3])];var $i=$I.getElementsByTagName("char"),$n=0;for($n=0;$n<$i.length;$n++){var $c=$i[$n].attributes,$f=parseInt($c.id.nodeValue),$d=parseInt($c.xoffset.nodeValue)/1,$H=parseInt($c.yoffset.nodeValue)/1,$B=parseInt($c.xadvance.nodeValue)/1,$A=new $j;$A.x=parseInt($c.x.nodeValue),$A.y=parseInt($c.y.nodeValue),$A.width=parseInt($c.width.nodeValue),$A.height=parseInt($c.height.nodeValue);var $Q=$BI.create($M,$A.x,$A.y,$A.width,$A.height,$d,$H);this._maxWidth=Math.max(this._maxWidth,$B+this.letterSpacing),this._fontCharDic[$f]=$Q,this._fontWidthMap[$f]=$B}}},$M.getCharTexture=function($I){return this._fontCharDic[$I.charCodeAt(0)]},$M.destroy=function(){if(this._texture){for(var $I in this._fontCharDic){var $M=this._fontCharDic[$I];$M&&$M.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},$M.setSpaceWidth=function($I){this._spaceWidth=$I},$M.getCharWidth=function($I){var $M=$I.charCodeAt(0);return this._fontWidthMap[$M]?this._fontWidthMap[$M]+this.letterSpacing:" "==$I?this._spaceWidth+this.letterSpacing:0},$M.getTextWidth=function($I){for(var $M=0,$E=0,$Z=$I.length;$E<$Z;$E++)$M+=this.getCharWidth($I.charAt($E));return $M},$M.getMaxWidth=function(){return this._maxWidth},$M.getMaxHeight=function(){return this.fontSize},$M.drawText=function($I,$M,$E,$Z,$i,$n){var $c,$f=this.getTextWidth($I),$d=0;"center"===$i&&($d=($n-$f)/2),"right"===$i&&($d=$n-$f);for(var $H=0,$B=0,$A=$I.length;$B<$A;$B++)($c=this.getCharTexture($I.charAt($B)))&&($M.graphics.drawTexture($c,$E+$H+$d,$Z),$H+=this.getCharWidth($I.charAt($B)))},$I}(),$f=function(){function $E(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=$E._TF_EMPTY}$V($E,"laya.display.css.Style");var $I=$E.prototype;return $I.getTransform=function(){return this._tf},$I.setTransform=function($I){this._tf="none"!==$I&&$I?$I:$E._TF_EMPTY},$I.setTranslateX=function($I){this._tf===$E._TF_EMPTY&&(this._tf=new $i),this._tf.translateX=$I},$I.setTranslateY=function($I){this._tf===$E._TF_EMPTY&&(this._tf=new $i),this._tf.translateY=$I},$I.setScaleX=function($I){this._tf===$E._TF_EMPTY&&(this._tf=new $i),this._tf.scaleX=$I},$I.setScale=function($I,$M){this._tf===$E._TF_EMPTY&&(this._tf=new $i),this._tf.scaleX=$I,this._tf.scaleY=$M},$I.setScaleY=function($I){this._tf===$E._TF_EMPTY&&(this._tf=new $i),this._tf.scaleY=$I},$I.setRotate=function($I){this._tf===$E._TF_EMPTY&&(this._tf=new $i),this._tf.rotate=$I},$I.setSkewX=function($I){this._tf===$E._TF_EMPTY&&(this._tf=new $i),this._tf.skewX=$I},$I.setSkewY=function($I){this._tf===$E._TF_EMPTY&&(this._tf=new $i),this._tf.skewY=$I},$I.destroy=function(){this.scrollRect=null},$I.render=function($I,$M,$E,$Z){},$I.getCSSStyle=function(){return $MI.EMPTY},$I._enableLayout=function(){return!1},$B(0,$I,"scaleX",function(){return this._tf.scaleX},function($I){this.setScaleX($I)}),$B(0,$I,"transform",function(){return this.getTransform()},function($I){this.setTransform($I)}),$B(0,$I,"translateX",function(){return this._tf.translateX},function($I){this.setTranslateX($I)}),$B(0,$I,"translateY",function(){return this._tf.translateY},function($I){this.setTranslateY($I)}),$B(0,$I,"scaleY",function(){return this._tf.scaleY},function($I){this.setScaleY($I)}),$B(0,$I,"block",function(){return 0!=(1&this._type)}),$B(0,$I,"skewY",function(){return this._tf.skewY},function($I){this.setSkewY($I)}),$B(0,$I,"rotate",function(){return this._tf.rotate},function($I){this.setRotate($I)}),$B(0,$I,"skewX",function(){return this._tf.skewX},function($I){this.setSkewX($I)}),$B(0,$I,"paddingLeft",function(){return 0}),$B(0,$I,"paddingTop",function(){return 0}),$B(0,$I,"absolute",function(){return!0}),$E.__init__=function(){$E._TF_EMPTY=new $i,$E.EMPTY=new $E},$E.EMPTY=null,$E._TF_EMPTY=null,$E}(),$p=function(){function $M($I){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=$F.create($M.defaultColor),this.family=$M.defaultFamily,this.stroke=$M._STROKE,this.size=$M.defaultSize,$I&&$I!==$M.EMPTY&&$I.copyTo(this)}$V($M,"laya.display.css.Font");var $I=$M.prototype;return $I.set=function($I){this._text=null;for(var $M=$I.split(" "),$E=0,$Z=$M.length;$E<$Z;$E++){var $i=$M[$E];switch($i){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<$i.indexOf("px")&&(this.size=parseInt($i),this.family=$M[$E+1],$E++)}},$I.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},$I.copyTo=function($I){$I._type=this._type,$I._text=this._text,$I._weight=this._weight,$I._color=this._color,$I.family=this.family,$I.stroke=this.stroke!=$M._STROKE?this.stroke.slice():$M._STROKE,$I.indent=this.indent,$I.size=this.size},$B(0,$I,"password",function(){return 0!=(1024&this._type)},function($I){$I?this._type|=1024:this._type&=-1025}),$B(0,$I,"color",function(){return this._color.strColor},function($I){this._color=$F.create($I)}),$B(0,$I,"italic",function(){return 0!=(512&this._type)},function($I){$I?this._type|=512:this._type&=-513}),$B(0,$I,"bold",function(){return 0!=(2048&this._type)},function($I){$I?this._type|=2048:this._type&=-2049}),$B(0,$I,"weight",function(){return""+this._weight},function($I){var $M=0;switch($I){case"normal":break;case"bold":this.bold=!0,$M=700;break;case"bolder":$M=800;break;case"lighter":$M=100;break;default:$M=parseInt($I)}this._weight=$M,this._text=null}),$B(0,$I,"decoration",function(){return this._decoration?this._decoration.value:null},function($I){var $M=$I.split(" ");switch(this._decoration||(this._decoration={}),$M[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=$M[0]}$M[1]&&(this._decoration.color=$F.create($M)),this._decoration.value=$I}),$M.__init__=function(){$M.EMPTY=new $M(null)},$M.EMPTY=null,$M.defaultColor="#000000",$M.defaultSize=12,$M.defaultFamily="Arial",$M.defaultFont="12px Arial",$M._STROKE=[0,"#000000"],$M._ITALIC=512,$M._PASSWORD=1024,$M._BOLD=2048,$M}(),$i=function(){function $I(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return $V($I,"laya.display.css.TransformInfo"),$I}(),$Q=function(){function $A(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,$o.isConchNode){this._nativeObj=new $c._conchGraphics,this.id=this._nativeObj.conchID}}$V($A,"laya.display.Graphics");var $I=$A.prototype;return $I.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},$I.clear=function($I){void 0===$I&&($I=!1);var $M=0,$E=0;if($I){var $Z=this._one;if(this._cmds){for($E=this._cmds.length,$M=0;$M<$E;$M++)!($Z=this._cmds[$M])||$Z.callee!==$o._context._drawTexture&&$Z.callee!==$o._context._drawTextureWithTransform||($Z[0]=null,$A._cache.push($Z));this._cmds.length=0}else $Z&&(!$Z||$Z.callee!==$o._context._drawTexture&&$Z.callee!==$o._context._drawTextureWithTransform||($Z[0]=null,$A._cache.push($Z)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for($M=0,$E=this._vectorgraphArray.length;$M<$E;$M++)$s.getInstance().deleteShape(this._vectorgraphArray[$M]);this._vectorgraphArray.length=0}},$I._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},$I._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new $E,this._graphicBounds._graphics=this)},$I._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},$I._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},$I.getBounds=function($I){return void 0===$I&&($I=!1),this._initGraphicBounds(),this._graphicBounds.getBounds($I)},$I.getBoundPoints=function($I){return void 0===$I&&($I=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints($I)},$I._addCmd=function($I){this._cmds=this._cmds||[],$I.callee=$I.shift(),this._cmds.push($I)},$I.setFilters=function($I){this._saveToCmd($o._context._setFilters,$I)},$I.drawTexture=function($I,$M,$E,$Z,$i,$n,$c){if(void 0===$M&&($M=0),void 0===$E&&($E=0),void 0===$Z&&($Z=0),void 0===$i&&($i=0),void 0===$c&&($c=1),!$I||$c<.01)return null;$Z||($Z=$I.sourceWidth),$i||($i=$I.sourceHeight),$c=$c<0?0:1<$c?1:$c;var $f,$d=!$o.isWebGL&&($x.onFirefox||$x.onEdge||$x.onIE||$x.onSafari)?.5:0,$H=$Z/$I.sourceWidth,$B=$i/$I.sourceHeight;return $Z=$I.width*$H,$i=$I.height*$B,$I.loaded&&($Z<=0||$i<=0)?null:($M+=$I.offsetX*$H,$E+=$I.offsetY*$B,this._sp&&(this._sp._renderType|=512),$M-=$d,$E-=$d,$Z+=2*$d,$i+=2*$d,$A._cache.length?(($f=$A._cache.pop())[0]=$I,$f[1]=$M,$f[2]=$E,$f[3]=$Z,$f[4]=$i,$f[5]=$n,$f[6]=$c):$f=[$I,$M,$E,$Z,$i,$n,$c],$f.callee=$n||1!=$c?$o._context._drawTextureWithTransform:$o._context._drawTexture,null!=this._one||$n||1!=$c?this._saveToCmd($f.callee,$f):(this._one=$f,this._render=this._renderOneImg),$I.loaded||$I.once("loaded",this,this._textureLoaded,[$I,$f]),this._repaint(),$f)},$I.cleanByTexture=function($I,$M,$E,$Z,$i){if(void 0===$Z&&($Z=0),void 0===$i&&($i=0),!$I)return this.clear();if(this._one&&this._render===this._renderOneImg){$Z||($Z=$I.sourceWidth),$i||($i=$I.sourceHeight);var $n=$Z/$I.sourceWidth,$c=$i/$I.sourceHeight;$Z=$I.width*$n,$i=$I.height*$c,$M+=$I.offsetX*$n,$E+=$I.offsetY*$c,this._one[0]=$I,this._one[1]=$M,this._one[2]=$E,this._one[3]=$Z,this._one[4]=$i,this._repaint()}else this.clear(),$I&&this.drawTexture($I,$M,$E,$Z,$i)},$I.drawTextures=function($I,$M){$I&&this._saveToCmd($o._context._drawTextures,[$I,$M])},$I.fillTexture=function($I,$M,$E,$Z,$i,$n,$c){if(void 0===$Z&&($Z=0),void 0===$i&&($i=0),void 0===$n&&($n="repeat"),$I){var $f=[$I,$M,$E,$Z,$i,$n,$c||$m.EMPTY,{}];$I.loaded||$I.once("loaded",this,this._textureLoaded,[$I,$f]),this._saveToCmd($o._context._fillTexture,$f)}},$I._textureLoaded=function($I,$M){$M[3]=$M[3]||$I.width,$M[4]=$M[4]||$I.height,this._repaint()},$I.fillCircle=function($I,$M,$E,$Z,$i,$n,$c){$E.bitmap.enableMerageInAtlas=!1;var $f=new Float32Array(2*($c+1)),$d=new Float32Array(2*($c+1)),$H=new Uint16Array(3*$c),$B=2*Math.PI/$c,$A=0;$f[0]=$Z,$f[1]=$i,$d[0]=$Z/$E.width,$d[1]=$i/$E.height;for(var $Q=2,$p=0;$p<$c;$p++){var $t=$n*Math.cos($A)+$Z,$V=$n*Math.sin($A)+$i;$f[$Q]=$t,$f[$Q+1]=$V,$d[$Q]=$t/$E.width,$d[$Q+1]=$V/$E.height,$A+=$B,$Q+=2}for($p=$Q=0;$p<$c;$p++)$H[$Q++]=0,$H[$Q++]=$p+1,$H[$Q++]=$c+1<=$p+2?1:$p+2;this.drawTriangles($E,$I,$M,$f,$d,$H)},$I.drawTriangles=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){void 0===$f&&($f=1),this._saveToCmd($o._context.drawTriangles,[$I,$M,$E,$Z,$i,$n,$c,$f,$d,$H])},$I._saveToCmd=function($I,$M){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=$M,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push($M)),$M.callee=$I,this._repaint(),$M},$I.clipRect=function($I,$M,$E,$Z){this._saveToCmd($o._context._clipRect,[$I,$M,$E,$Z])},$I.fillText=function($I,$M,$E,$Z,$i,$n,$c){void 0===$c&&($c=0),this._saveToCmd($o._context._fillText,[$I,$M,$E,$Z||$p.defaultFont,$i,$n])},$I.fillBorderText=function($I,$M,$E,$Z,$i,$n,$c,$f){this._saveToCmd($o._context._fillBorderText,[$I,$M,$E,$Z||$p.defaultFont,$i,$n,$c,$f])},$I.strokeText=function($I,$M,$E,$Z,$i,$n,$c){this._saveToCmd($o._context._strokeText,[$I,$M,$E,$Z||$p.defaultFont,$i,$n,$c])},$I.alpha=function($I){$I=$I<0?0:1<$I?1:$I,this._saveToCmd($o._context._alpha,[$I])},$I.setAlpha=function($I){$I=$I<0?0:1<$I?1:$I,this._saveToCmd($o._context._setAlpha,[$I])},$I.transform=function($I,$M,$E){void 0===$M&&($M=0),void 0===$E&&($E=0),this._saveToCmd($o._context._transform,[$I,$M,$E])},$I.rotate=function($I,$M,$E){void 0===$M&&($M=0),void 0===$E&&($E=0),this._saveToCmd($o._context._rotate,[$I,$M,$E])},$I.scale=function($I,$M,$E,$Z){void 0===$E&&($E=0),void 0===$Z&&($Z=0),this._saveToCmd($o._context._scale,[$I,$M,$E,$Z])},$I.translate=function($I,$M){this._saveToCmd($o._context._translate,[$I,$M])},$I.save=function(){this._saveToCmd($o._context._save,[])},$I.restore=function(){this._saveToCmd($o._context._restore,[])},$I.replaceText=function($I){this._repaint();var $M=this._cmds;if($M){for(var $E=$M.length-1;-1<$E;$E--)if(this._isTextCmd($M[$E].callee))return $M[$E][0].toUpperCase?$M[$E][0]=$I:$M[$E][0].setText($I),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=$I:this._one[0].setText($I),!0;return!1},$I._isTextCmd=function($I){return $I===$o._context._fillText||$I===$o._context._fillBorderText||$I===$o._context._strokeText},$I.replaceTextColor=function($I){this._repaint();var $M=this._cmds;if($M)for(var $E=$M.length-1;-1<$E;$E--)this._isTextCmd($M[$E].callee)&&($M[$E][4]=$I,$M[$E][0].toUpperCase||($M[$E][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=$I,this._one[0].toUpperCase||(this._one[0].changed=!0))},$I.loadImage=function($I,$M,$E,$Z,$i,$n){var $c=this;void 0===$M&&($M=0),void 0===$E&&($E=0),void 0===$Z&&($Z=0),void 0===$i&&($i=0);var $f=$fI.getRes($I);function $d($I){$I&&($c.drawTexture($I,$M,$E,$Z,$i),null!=$n&&$n.call($c._sp,$I))}$f?$d($f):$a.loader.load($I,$y.create(null,$d),null,"image")},$I._renderEmpty=function($I,$M,$E,$Z){},$I._renderAll=function($I,$M,$E,$Z){for(var $i,$n=this._cmds,$c=0,$f=$n.length;$c<$f;$c++)($i=$n[$c]).callee.call($M,$E,$Z,$i)},$I._renderOne=function($I,$M,$E,$Z){this._one.callee.call($M,$E,$Z,this._one)},$I._renderOneImg=function($I,$M,$E,$Z){this._one.callee.call($M,$E,$Z,this._one),2305!==$I._renderType&&($I._renderType|=1)},$I.drawLine=function($I,$M,$E,$Z,$i,$n){void 0===$n&&($n=1);var $c=0;$o.isWebGL&&($c=$s.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($c));var $f=$n%2==0?0:.5,$d=[$I+$f,$M+$f,$E+$f,$Z+$f,$i,$n,$c];this._saveToCmd($o._context._drawLine,$d)},$I.drawLines=function($I,$M,$E,$Z,$i){void 0===$i&&($i=1);var $n=0;if($E&&!($E.length<4)){$o.isWebGL&&($n=$s.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($n));var $c=$i%2==0?0:.5,$f=[$I+$c,$M+$c,$E,$Z,$i,$n];this._saveToCmd($o._context._drawLines,$f)}},$I.drawCurves=function($I,$M,$E,$Z,$i){void 0===$i&&($i=1);var $n=[$I,$M,$E,$Z,$i];this._saveToCmd($o._context._drawCurves,$n)},$I.drawRect=function($I,$M,$E,$Z,$i,$n,$c){void 0===$c&&($c=1);var $f=$n?$c/2:0,$d=$n?$c:0,$H=[$I+$f,$M+$f,$E-$d,$Z-$d,$i,$n,$c];this._saveToCmd($o._context._drawRect,$H)},$I.drawCircle=function($I,$M,$E,$Z,$i,$n){void 0===$n&&($n=1);var $c=$i?$n/2:0,$f=0;$o.isWebGL&&($f=$s.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($f));var $d=[$I,$M,$E-$c,$Z,$i,$n,$f];this._saveToCmd($o._context._drawCircle,$d)},$I.drawPie=function($I,$M,$E,$Z,$i,$n,$c,$f){void 0===$f&&($f=1);var $d=$c?$f/2:0,$H=$c?$f:0,$B=0;$o.isWebGL&&($B=$s.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($B));var $A=[$I+$d,$M+$d,$E-$H,$Z,$i,$n,$c,$f,$B];$A[3]=$K.toRadian($Z),$A[4]=$K.toRadian($i),this._saveToCmd($o._context._drawPie,$A)},$I.drawPoly=function($I,$M,$E,$Z,$i,$n){void 0===$n&&($n=1);var $c=0,$f=!1;$o.isWebGL&&($c=$s.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push($c),$f=!(6<$E.length));var $d=$i?$n%2==0?0:.5:0,$H=[$I+$d,$M+$d,$E,$Z,$i,$n,$c,$f];this._saveToCmd($o._context._drawPoly,$H)},$I.drawPath=function($I,$M,$E,$Z,$i){var $n=[$I,$M,$E,$Z,$i];this._saveToCmd($o._context._drawPath,$n)},$B(0,$I,"cmds",function(){return this._cmds},function($I){this._sp&&(this._sp._renderType|=512),this._cmds=$I,this._render=this._renderAll,this._repaint()}),$A.__init__=function(){if($o.isConchNode){for(var $I=laya.display.Graphics.prototype,$M=$x.window.ConchGraphics.prototype,$E=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],$Z=0,$i=$E.length;$Z<=$i;$Z++){var $n=$E[$Z];$I[$n]=$M[$n]}$I._saveToCmd=null,$M.drawImageS&&($I.drawTextures=function($I,$M){if($I&&$I.loaded&&$I.bitmap&&$I.source){var $E=$I.uv,$Z=$I.bitmap.width,$i=$I.bitmap.height;this.drawImageS($I.bitmap.source,$E[0]*$Z,$E[1]*$i,($E[2]-$E[0])*$Z,($E[5]-$E[3])*$i,$I.offsetX,$I.offsetY,$I.width,$I.height,$M)}}),$I.drawTexture=function($I,$M,$E,$Z,$i,$n,$c){if(void 0===$M&&($M=0),void 0===$E&&($E=0),void 0===$Z&&($Z=0),void 0===$i&&($i=0),void 0===$c&&($c=1),$I)if($I.loaded){if($I.loaded&&$I.bitmap&&$I.source&&($Z||($Z=$I.sourceWidth),$i||($i=$I.sourceHeight),$c=$c<0?0:1<$c?1:$c,$Z=$Z-$I.sourceWidth+$I.width,$i=$i-$I.sourceHeight+$I.height,!($Z<=0||$i<=0))){$M+=$I.offsetX,$E+=$I.offsetY;var $f=$I.uv,$d=$I.bitmap.width,$H=$I.bitmap.height;$f[4]<$f[0]&&$f[5]<$f[1]?this.drawImageM($I.bitmap.source,$f[4]*$d,$f[5]*$H,($f[0]-$f[4])*$d,($f[1]-$f[5])*$H,$M,$E,$Z,$i,$n,$c):this.drawImageM($I.bitmap.source,$f[0]*$d,$f[1]*$H,($f[2]-$f[0])*$d,($f[5]-$f[3])*$H,$M,$E,$Z,$i,$n,$c),this._repaint()}}else $I.once("loaded",this,function(){this.drawTexture($I,$M,$E,$Z,$i,$n)})},$I.fillTexture=function($I,$M,$E,$Z,$i,$n,$c){if(void 0===$Z&&($Z=0),void 0===$i&&($i=0),void 0===$n&&($n="repeat"),$I&&$I.loaded){var $f,$d=$o._context.ctx,$H=$I.bitmap.width,$B=$I.bitmap.height,$A=$I.uv;$f=$I.uv!=$BI.DEF_UV?$d.createPattern($I.bitmap.source,$n,$A[0]*$H,$A[1]*$B,($A[2]-$A[0])*$H,($A[5]-$A[3])*$B):$d.createPattern($I.bitmap.source,$n);var $Q=0,$p=0;$c&&($M+=$c.x%$I.width,$E+=$c.y%$I.height,$Q-=$c.x%$I.width,$p-=$c.y%$I.height),this._fillImage($f,$M,$E,$Q,$p,$Z,$i)}}}},$A._cache=[],$A}(),$E=function(){function $$(){this._cacheBoundsType=!1}$V($$,"laya.display.GraphicsBounds");var $I=$$.prototype;return $I.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},$I.reset=function(){this._temp&&(this._temp.length=0)},$I.getBounds=function($I){return void 0===$I&&($I=!1),(!this._bounds||!this._temp||this._temp.length<1||$I!=this._cacheBoundsType)&&(this._bounds=$j._getWrapRec(this.getBoundPoints($I),this._bounds)),this._cacheBoundsType=$I,this._bounds},$I.getBoundPoints=function($I){return void 0===$I&&($I=!1),(!this._temp||this._temp.length<1||$I!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints($I)),this._cacheBoundsType=$I,this._rstBoundPoints=$K.copyArray(this._rstBoundPoints,this._temp)},$I._getCmdPoints=function($I){void 0===$I&&($I=!1);var $M,$E,$Z=$o._context,$i=this._graphics.cmds;if(($M=this._temp||(this._temp=[])).length=0,$i||null==this._graphics._one||($$._tempCmds.length=0,$$._tempCmds.push(this._graphics._one),$i=$$._tempCmds),!$i)return $M;($E=$$._tempMatrixArrays).length=0;var $n=$$._initMatrix;$n.identity();for(var $c,$f,$d=$$._tempMatrix,$H=NaN,$B=NaN,$A=NaN,$Q=NaN,$p=NaN,$t=NaN,$V=0,$u=$i.length;$V<$u;$V++)if(($c=$i[$V]).callee)switch($c.callee){case $Z._save:case 7:$E.push($n),$n=$n.clone();break;case $Z._restore:case 8:$n=$E.pop();break;case $Z._scale:case 5:$d.identity(),$d.translate(-$c[2],-$c[3]),$d.scale($c[0],$c[1]),$d.translate($c[2],$c[3]),this._switchMatrix($n,$d);break;case $Z._rotate:case 3:$d.identity(),$d.translate(-$c[1],-$c[2]),$d.rotate($c[0]),$d.translate($c[1],$c[2]),this._switchMatrix($n,$d);break;case $Z._translate:case 6:$d.identity(),$d.translate($c[0],$c[1]),this._switchMatrix($n,$d);break;case $Z._transform:case 4:$d.identity(),$d.translate(-$c[1],-$c[2]),$d.concat($c[0]),$d.translate($c[1],$c[2]),this._switchMatrix($n,$d);break;case 16:case 24:$$._addPointArrToRst($M,$j._getBoundPointS($c[0],$c[1],$c[2],$c[3]),$n);break;case 17:$n.copyTo($d),$d.concat($c[4]),$$._addPointArrToRst($M,$j._getBoundPointS($c[0],$c[1],$c[2],$c[3]),$d);break;case $Z._drawTexture:$f=$c[0],$I?$c[3]&&$c[4]?$$._addPointArrToRst($M,$j._getBoundPointS($c[1],$c[2],$c[3],$c[4]),$n):($f=$c[0],$$._addPointArrToRst($M,$j._getBoundPointS($c[1],$c[2],$f.width,$f.height),$n)):($H=($c[3]||$f.sourceWidth)/$f.width,$B=($c[4]||$f.sourceHeight)/$f.height,$A=$H*$f.sourceWidth,$Q=$B*$f.sourceHeight,$p=0<$f.offsetX?$f.offsetX:0,$t=0<$f.offsetY?$f.offsetY:0,$p*=$H,$t*=$B,$$._addPointArrToRst($M,$j._getBoundPointS($c[1]-$p,$c[2]-$t,$A,$Q),$n));break;case $Z._fillTexture:$c[3]&&$c[4]?$$._addPointArrToRst($M,$j._getBoundPointS($c[1],$c[2],$c[3],$c[4]),$n):($f=$c[0],$$._addPointArrToRst($M,$j._getBoundPointS($c[1],$c[2],$f.width,$f.height),$n));break;case $Z._drawTextureWithTransform:var $N;$N=$c[5]?($n.copyTo($d),$d.concat($c[5]),$d):$n,$I?$c[3]&&$c[4]?$$._addPointArrToRst($M,$j._getBoundPointS($c[1],$c[2],$c[3],$c[4]),$N):($f=$c[0],$$._addPointArrToRst($M,$j._getBoundPointS($c[1],$c[2],$f.width,$f.height),$N)):($f=$c[0],$H=($c[3]||$f.sourceWidth)/$f.width,$B=($c[4]||$f.sourceHeight)/$f.height,$A=$H*$f.sourceWidth,$Q=$B*$f.sourceHeight,$p=0<$f.offsetX?$f.offsetX:0,$t=0<$f.offsetY?$f.offsetY:0,$p*=$H,$t*=$B,$$._addPointArrToRst($M,$j._getBoundPointS($c[1]-$p,$c[2]-$t,$A,$Q),$N));break;case $Z._drawRect:case 13:$$._addPointArrToRst($M,$j._getBoundPointS($c[0],$c[1],$c[2],$c[3]),$n);break;case $Z._drawCircle:case $Z._fillCircle:case 14:$$._addPointArrToRst($M,$j._getBoundPointS($c[0]-$c[2],$c[1]-$c[2],$c[2]+$c[2],$c[2]+$c[2]),$n);break;case $Z._drawLine:case 20:$$._tempPoints.length=0;var $y;$y=.5*$c[5],$c[0]==$c[2]?$$._tempPoints.push($c[0]+$y,$c[1],$c[2]+$y,$c[3],$c[0]-$y,$c[1],$c[2]-$y,$c[3]):$c[1]==$c[3]?$$._tempPoints.push($c[0],$c[1]+$y,$c[2],$c[3]+$y,$c[0],$c[1]-$y,$c[2],$c[3]-$y):$$._tempPoints.push($c[0],$c[1],$c[2],$c[3]),$$._addPointArrToRst($M,$$._tempPoints,$n);break;case $Z._drawCurves:case 22:$$._addPointArrToRst($M,$w.I.getBezierPoints($c[2]),$n,$c[0],$c[1]);break;case $Z._drawPoly:case $Z._drawLines:case 18:$$._addPointArrToRst($M,$c[2],$n,$c[0],$c[1]);break;case $Z._drawPath:case 19:$$._addPointArrToRst($M,this._getPathPoints($c[2]),$n,$c[0],$c[1]);break;case $Z._drawPie:case 15:$$._addPointArrToRst($M,this._getPiePoints($c[0],$c[1],$c[2],$c[3],$c[4]),$n)}return 200<$M.length?$M=$K.copyArray($M,$j._getWrapRec($M)._getBoundPoints()):8<$M.length&&($M=$g.scanPList($M)),$M},$I._switchMatrix=function($I,$M){$M.concat($I),$M.copyTo($I)},$I._getPiePoints=function($I,$M,$E,$Z,$i){var $n=$$._tempPoints;$$._tempPoints.length=0,$n.push($I,$M);var $c=($i-$Z)%(2*Math.PI)/10,$f=NaN,$d=$Z;for($f=0;$f<=10;$f++)$n.push($I+$E*Math.cos($d),$M+$E*Math.sin($d)),$d+=$c;return $n},$I._getPathPoints=function($I){var $M,$E,$Z=0,$i=$$._tempPoints;for($i.length=0,$M=$I.length,$Z=0;$Z<$M;$Z++)1<($E=$I[$Z]).length&&($i.push($E[1],$E[2]),3<$E.length&&$i.push($E[3],$E[4]));return $i},$$._addPointArrToRst=function($I,$M,$E,$Z,$i){void 0===$Z&&($Z=0),void 0===$i&&($i=0);var $n,$c=0;for($n=$M.length,$c=0;$c<$n;$c+=2)$$._addPointToRst($I,$M[$c]+$Z,$M[$c+1]+$i,$E)},$$._addPointToRst=function($I,$M,$E,$Z){var $i=$m.TEMP;$i.setTo($M||0,$E||0),$Z.transformPoint($i),$I.push($i.x,$i.y)},$$._tempPoints=[],$$._tempMatrixArrays=[],$$._tempCmds=[],$d($$,["_tempMatrix",function(){return this._tempMatrix=new $R},"_initMatrix",function(){return this._initMatrix=new $R}]),$$}(),$n=function(){function $I(){}$V($I,"laya.events.Event");var $M=$I.prototype;return $M.setTo=function($I,$M,$E){return this.type=$I,this.currentTarget=$M,this.target=$E,this},$M.stopPropagation=function(){this._stoped=!0},$B(0,$M,"stageY",function(){return $a.stage.mouseY}),$B(0,$M,"charCode",function(){return this.nativeEvent.charCode}),$B(0,$M,"touches",function(){var $I=this.nativeEvent.touches;if($I)for(var $M=$a.stage,$E=0,$Z=$I.length;$E<$Z;$E++){var $i=$I[$E],$n=$m.TEMP;$n.setTo($i.clientX,$i.clientY),$M._canvasTransform.invertTransformPoint($n),$M.transform.invertTransformPoint($n),$i.stageX=$n.x,$i.stageY=$n.y}return $I}),$B(0,$M,"keyLocation",function(){return this.nativeEvent.keyLocation}),$B(0,$M,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),$B(0,$M,"altKey",function(){return this.nativeEvent.altKey}),$B(0,$M,"shiftKey",function(){return this.nativeEvent.shiftKey}),$B(0,$M,"stageX",function(){return $a.stage.mouseX}),$I.EMPTY=new $I,$I.MOUSE_DOWN="mousedown",$I.MOUSE_UP="mouseup",$I.CLICK="click",$I.RIGHT_MOUSE_DOWN="rightmousedown",$I.RIGHT_MOUSE_UP="rightmouseup",$I.RIGHT_CLICK="rightclick",$I.MOUSE_MOVE="mousemove",$I.MOUSE_OVER="mouseover",$I.MOUSE_OUT="mouseout",$I.MOUSE_WHEEL="mousewheel",$I.ROLL_OVER="mouseover",$I.ROLL_OUT="mouseout",$I.DOUBLE_CLICK="doubleclick",$I.CHANGE="change",$I.CHANGED="changed",$I.RESIZE="resize",$I.ADDED="added",$I.REMOVED="removed",$I.DISPLAY="display",$I.UNDISPLAY="undisplay",$I.ERROR="error",$I.COMPLETE="complete",$I.LOADED="loaded",$I.INITED="inited",$I.PROGRESS="progress",$I.INPUT="input",$I.RENDER="render",$I.OPEN="open",$I.MESSAGE="message",$I.CLOSE="close",$I.KEY_DOWN="keydown",$I.KEY_PRESS="keypress",$I.KEY_UP="keyup",$I.FRAME="enterframe",$I.DRAG_START="dragstart",$I.DRAG_MOVE="dragmove",$I.DRAG_END="dragend",$I.ENTER="enter",$I.SELECT="select",$I.BLUR="blur",$I.FOCUS="focus",$I.VISIBILITY_CHANGE="visibilitychange",$I.FOCUS_CHANGE="focuschange",$I.PLAYED="played",$I.PAUSED="paused",$I.STOPPED="stopped",$I.START="start",$I.END="end",$I.ENABLE_CHANGED="enablechanged",$I.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",$I.COMPONENT_ADDED="componentadded",$I.COMPONENT_REMOVED="componentremoved",$I.LAYER_CHANGED="layerchanged",$I.HIERARCHY_LOADED="hierarchyloaded",$I.RECOVERED="recovered",$I.RELEASED="released",$I.LINK="link",$I.LABEL="label",$I.FULL_SCREEN_CHANGE="fullscreenchange",$I.DEVICE_LOST="devicelost",$I.MESH_CHANGED="meshchanged",$I.MATERIAL_CHANGED="materialchanged",$I.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",$I.ANIMATION_CHANGED="animationchanged",$I.TRIGGER_ENTER="triggerenter",$I.TRIGGER_STAY="triggerstay",$I.TRIGGER_EXIT="triggerexit",$I.TRAIL_FILTER_CHANGE="trailfilterchange",$I.DOMINO_FILTER_CHANGE="dominofilterchange",$I}(),$A=(function(){function $I(){}$V($I,"laya.events.Keyboard"),$I.NUMBER_0=48,$I.NUMBER_1=49,$I.NUMBER_2=50,$I.NUMBER_3=51,$I.NUMBER_4=52,$I.NUMBER_5=53,$I.NUMBER_6=54,$I.NUMBER_7=55,$I.NUMBER_8=56,$I.NUMBER_9=57,$I.A=65,$I.B=66,$I.C=67,$I.D=68,$I.E=69,$I.F=70,$I.G=71,$I.H=72,$I.I=73,$I.J=74,$I.K=75,$I.L=76,$I.M=77,$I.N=78,$I.O=79,$I.P=80,$I.Q=81,$I.R=82,$I.S=83,$I.T=84,$I.U=85,$I.V=86,$I.W=87,$I.X=88,$I.Y=89,$I.Z=90,$I.F1=112,$I.F2=113,$I.F3=114,$I.F4=115,$I.F5=116,$I.F6=117,$I.F7=118,$I.F8=119,$I.F9=120,$I.F10=121,$I.F11=122,$I.F12=123,$I.F13=124,$I.F14=125,$I.F15=126,$I.NUMPAD=21,$I.NUMPAD_0=96,$I.NUMPAD_1=97,$I.NUMPAD_2=98,$I.NUMPAD_3=99,$I.NUMPAD_4=100,$I.NUMPAD_5=101,$I.NUMPAD_6=102,$I.NUMPAD_7=103,$I.NUMPAD_8=104,$I.NUMPAD_9=105,$I.NUMPAD_ADD=107,$I.NUMPAD_DECIMAL=110,$I.NUMPAD_DIVIDE=111,$I.NUMPAD_ENTER=108,$I.NUMPAD_MULTIPLY=106,$I.NUMPAD_SUBTRACT=109,$I.SEMICOLON=186,$I.EQUAL=187,$I.COMMA=188,$I.MINUS=189,$I.PERIOD=190,$I.SLASH=191,$I.BACKQUOTE=192,$I.LEFTBRACKET=219,$I.BACKSLASH=220,$I.RIGHTBRACKET=221,$I.QUOTE=222,$I.ALTERNATE=18,$I.BACKSPACE=8,$I.CAPS_LOCK=20,$I.COMMAND=15,$I.CONTROL=17,$I.DELETE=46,$I.ENTER=13,$I.ESCAPE=27,$I.PAGE_UP=33,$I.PAGE_DOWN=34,$I.END=35,$I.HOME=36,$I.LEFT=37,$I.UP=38,$I.RIGHT=39,$I.DOWN=40,$I.SHIFT=16,$I.SPACE=32,$I.TAB=9,$I.INSERT=45}(),function(){function $i(){}return $V($i,"laya.events.KeyBoardManager"),$i.__init__=function(){$i._addEvent("keydown"),$i._addEvent("keypress"),$i._addEvent("keyup")},$i._addEvent=function($M){$x.document.addEventListener($M,function($I){laya.events.KeyBoardManager._dispatch($I,$M)},!0)},$i._dispatch=function($I,$M){if($i.enabled){$i._event._stoped=!1,$i._event.nativeEvent=$I,$i._event.keyCode=$I.keyCode||$I.which||$I.charCode,"keydown"===$M?$i._pressKeys[$i._event.keyCode]=!0:"keyup"===$M&&($i._pressKeys[$i._event.keyCode]=null);for(var $E=$a.stage.focus&&null!=$a.stage.focus.event&&$a.stage.focus.displayedInStage?$a.stage.focus:$a.stage,$Z=$E;$Z;)$Z.event($M,$i._event.setTo($M,$Z,$E)),$Z=$Z.parent}},$i.hasKeyDown=function($I){return $i._pressKeys[$I]},$i._pressKeys={},$i.enabled=!0,$d($i,["_event",function(){return this._event=new $n}]),$i}()),$t=(function(){function $I(){}$V($I,"laya.events.KeyLocation"),$I.STANDARD=0,$I.LEFT=1,$I.RIGHT=2,$I.NUM_PAD=3}(),function(){function $B(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=$x.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new $n,this._matrix=new $R,this._point=new $m,this._rect=new $j,this._prePoint=new $m,this._curTouchID=NaN}$V($B,"laya.events.MouseManager");var $I=$B.prototype;return $I.__init__=function($I,$M){var $E=this;this._stage=$I;var $Z=this,$i=this._eventList;$M.oncontextmenu=function($I){if($B.enabled)return!1},$M.addEventListener("mousedown",function($I){$B.enabled&&($x.onIE||$I.preventDefault(),$i.push($I),$Z.mouseDownTime=$x.now())}),$M.addEventListener("mouseup",function($I){$B.enabled&&($I.preventDefault(),$i.push($I),$Z.mouseDownTime=-$x.now())},!0),$M.addEventListener("mousemove",function($I){if($B.enabled){$I.preventDefault();var $M=$x.now();if($M-$Z._lastMoveTimer<10)return;$Z._lastMoveTimer=$M,$i.push($I)}},!0),$M.addEventListener("mouseout",function($I){$B.enabled&&$i.push($I)}),$M.addEventListener("mouseover",function($I){$B.enabled&&$i.push($I)}),$M.addEventListener("touchstart",function($I){$B.enabled&&($i.push($I),$B._isFirstTouch||$gI.isInputting||$I.preventDefault(),$Z.mouseDownTime=$x.now())}),$M.addEventListener("touchend",function($I){$B.enabled?($B._isFirstTouch||$gI.isInputting||$I.preventDefault(),$B._isFirstTouch=!1,$i.push($I),$Z.mouseDownTime=-$x.now()):$E._curTouchID=NaN},!0),$M.addEventListener("touchmove",function($I){$B.enabled&&($I.preventDefault(),$i.push($I))},!0),$M.addEventListener("touchcancel",function($I){$B.enabled?($I.preventDefault(),$i.push($I)):$E._curTouchID=NaN},!0),$M.addEventListener("mousewheel",function($I){$B.enabled&&$i.push($I)}),$M.addEventListener("DOMMouseScroll",function($I){$B.enabled&&$i.push($I)})},$I.initEvent=function($I,$M){var $E;this._event._stoped=!1,this._event.nativeEvent=$M||$I,this._target=null,this._point.setTo($I.pageX||$I.clientX,$I.pageY||$I.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=$I.identifier||0,this._tTouchID=this._event.touchId,($E=$u.I._event)._stoped=!1,$E.nativeEvent=this._event.nativeEvent,$E.touchId=this._event.touchId},$I.checkMouseWheel=function($I){this._event.delta=$I.wheelDelta?.025*$I.wheelDelta:-$I.detail;for(var $M=$u.I.getLastOvers(),$E=0,$Z=$M.length;$E<$Z;$E++){var $i=$M[$E];$i.event("mousewheel",this._event.setTo("mousewheel",$i,this._target))}},$I.onMouseMove=function($I){$u.I.onMouseMove($I,this._tTouchID)},$I.onMouseDown=function($I){if($gI.isInputting&&$a.stage.focus&&$a.stage.focus.focus&&!$a.stage.focus.contains(this._target)){var $M=$a.stage.focus._tf||$a.stage.focus,$E=$I._tf||$I;$E instanceof laya.display.Input&&$E.multiline==$M.multiline?$M._focusOut():$M.focus=!1}$u.I.onMouseDown($I,this._tTouchID,this._isLeftMouse)},$I.onMouseUp=function($I){$u.I.onMouseUp($I,this._tTouchID,this._isLeftMouse)},$I.check=function($I,$M,$E,$Z){this._point.setTo($M,$E),$I.fromParentPoint(this._point),$M=this._point.x,$E=this._point.y;var $i=$I.scrollRect;if($i&&(this._rect.setTo($i.x,$i.y,$i.width,$i.height),!this._rect.contains($M,$E)))return!1;if(!this.disableMouseEvent){if($I.hitTestPrior&&!$I.mouseThrough&&!this.hitTest($I,$M,$E))return!1;for(var $n=$I._childs.length-1;-1<$n;$n--){var $c=$I._childs[$n];if(!$c.destroyed&&$c.mouseEnabled&&$c.visible&&this.check($c,$M,$E,$Z))return!0}}var $f=!(!$I.hitTestPrior||$I.mouseThrough||this.disableMouseEvent)||this.hitTest($I,$M,$E);return $f?(this._target=$I,$Z.call(this,$I)):$Z===this.onMouseUp&&$I===this._stage&&(this._target=this._stage,$Z.call(this,this._target)),$f},$I.hitTest=function($I,$M,$E){var $Z=!1;if($I.scrollRect&&($M-=$I.scrollRect.x,$E-=$I.scrollRect.y),$I.hitArea instanceof laya.utils.HitArea)return $I.hitArea.isHit($M,$E);if(0<$I.width&&0<$I.height||$I.mouseThrough||$I.hitArea)if($I.mouseThrough)$Z=$I.getGraphicBounds().contains($M,$E);else{var $i=this._rect;$I.hitArea?$i=$I.hitArea:$i.setTo(0,0,$I.width,$I.height),$Z=$i.contains($M,$E)}return $Z},$I.runEvent=function(){var $I=this._eventList.length;if($I){var $M=this;$M.mouseEventTime=$x.now();var $E,$Z=0,$i=0,$n=0;try{for(;$Z<$I;){var $c=this._eventList[$Z];switch("mousemove"!==$c.type&&(this._prePoint.x=this._prePoint.y=-1e6),$c.type){case"mousedown":this._touchIDs[0]=this._id++,$B._isTouchRespond?$B._isTouchRespond=!1:($M._isLeftMouse=0===$c.button,$M.initEvent($c),$M.check($M._stage,$M.mouseX,$M.mouseY,$M.onMouseDown));break;case"mouseup":$M._isLeftMouse=0===$c.button,$M.initEvent($c),$M.check($M._stage,$M.mouseX,$M.mouseY,$M.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-$c.clientX)+Math.abs(this._prePoint.y-$c.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=$c.clientX,this._prePoint.y=$c.clientY,$M.initEvent($c),$M.check($M._stage,$M.mouseX,$M.mouseY,$M.onMouseMove));break;case"touchstart":$B._isTouchRespond=!0,$M._isLeftMouse=!0;var $f=$c.changedTouches;for($i=0,$n=$f.length;$i<$n;$i++)$E=$f[$i],($B.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=$E.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[$E.identifier]=this._id++,$M.initEvent($E,$c),$M.check($M._stage,$M.mouseX,$M.mouseY,$M.onMouseDown));break;case"touchend":case"touchcancel":$B._isTouchRespond=!0,$M._isLeftMouse=!0;var $d=$c.changedTouches;for($i=0,$n=$d.length;$i<$n;$i++)if($E=$d[$i],$B.multiTouchEnabled||$E.identifier==this._curTouchID){this._curTouchID=NaN,$M.initEvent($E,$c);$M.check($M._stage,$M.mouseX,$M.mouseY,$M.onMouseUp)||$M.onMouseUp(null)}break;case"touchmove":var $H=$c.changedTouches;for($i=0,$n=$H.length;$i<$n;$i++)$E=$H[$i],($B.multiTouchEnabled||$E.identifier==this._curTouchID)&&($M.initEvent($E,$c),$M.check($M._stage,$M.mouseX,$M.mouseY,$M.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":$M.checkMouseWheel($c);break;case"mouseout":$u.I.stageMouseOut();break;case"mouseover":$M._stage.event("mouseover",$M._event.setTo("mouseover",$M._stage,$M._stage))}$Z++}}catch($I){throw this._eventList.length=0,$I}this._eventList.length=0}},$B.enabled=!0,$B.multiTouchEnabled=!0,$B._isTouchRespond=!1,$B._isFirstTouch=!0,$d($B,["instance",function(){return this.instance=new $B}]),$B}()),$u=function(){function $t(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new $n}$V($t,"laya.events.TouchManager");var $I=$t.prototype;return $I._clearTempArrs=function(){$t._oldArr.length=0,$t._newArr.length=0,$t._tEleArr.length=0},$I.getTouchFromArr=function($I,$M){var $E,$Z,$i=0;for($E=$M.length,$i=0;$i<$E;$i++)if(($Z=$M[$i]).id==$I)return $Z;return null},$I.removeTouchFromArr=function($I,$M){var $E=0;for($E=$M.length-1;0<=$E;$E--)$M[$E].id==$I&&$M.splice($E,1)},$I.createTouchO=function($I,$M){var $E;return($E=$P.getItem("TouchData")||{}).id=$M,$E.tar=$I,$E},$I.onMouseDown=function($I,$M,$E){var $Z,$i,$n,$c;(void 0===$E&&($E=!1),this.enable)&&($Z=this.getTouchFromArr($M,this.preOvers),$n=this.getEles($I,null,$t._tEleArr),$Z?$Z.tar=$I:($i=this.createTouchO($I,$M),this.preOvers.push($i)),$x.onMobile&&this.sendEvents($n,"mouseover",$M),$c=$E?this.preDowns:this.preRightDowns,($Z=this.getTouchFromArr($M,$c))?$Z.tar=$I:($i=this.createTouchO($I,$M),$c.push($i)),this.sendEvents($n,$E?"mousedown":"rightmousedown",$M),this._clearTempArrs())},$I.sendEvents=function($I,$M,$E){void 0===$E&&($E=0);var $Z,$i,$n,$c=0;for($Z=$I.length,this._event._stoped=!1,$i=$I[0],$c=0;$c<$Z;$c++){if(($n=$I[$c]).destroyed)return;if($n.event($M,this._event.setTo($M,$n,$i)),this._event._stoped)break}},$I.getEles=function($I,$M,$E){for($E?$E.length=0:$E=[];$I&&$I!=$M;)$E.push($I),$I=$I.parent;return $E},$I.checkMouseOutAndOverOfMove=function($I,$M,$E){if(void 0===$E&&($E=0),$M!=$I){var $Z,$i,$n=0,$c=0;if($M.contains($I))$i=this.getEles($I,$M,$t._tEleArr),this.sendEvents($i,"mouseover",$E);else if($I.contains($M))$i=this.getEles($M,$I,$t._tEleArr),this.sendEvents($i,"mouseout",$E);else{var $f,$d;($i=$t._tEleArr).length=0,$f=this.getEles($M,null,$t._oldArr),$d=this.getEles($I,null,$t._newArr),$c=$f.length;var $H=0;for($n=0;$n<$c;$n++){if($Z=$f[$n],0<=($H=$d.indexOf($Z))){$d.splice($H,$d.length-$H);break}$i.push($Z)}0<$i.length&&this.sendEvents($i,"mouseout",$E),0<$d.length&&this.sendEvents($d,"mouseover",$E)}}},$I.onMouseMove=function($I,$M){var $E,$Z;this.enable&&(($E=this.getTouchFromArr($M,this.preOvers))?(this.checkMouseOutAndOverOfMove($I,$E.tar),$E.tar=$I,$Z=this.getEles($I,null,$t._tEleArr)):($Z=this.getEles($I,null,$t._tEleArr),this.sendEvents($Z,"mouseover",$M),this.preOvers.push(this.createTouchO($I,$M))),this.sendEvents($Z,"mousemove",$M),this._clearTempArrs())},$I.getLastOvers=function(){return($t._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,$t._tEleArr):($t._tEleArr.push($a.stage),$t._tEleArr)},$I.stageMouseOut=function(){var $I;$I=this.getLastOvers(),this.preOvers.length=0,this.sendEvents($I,"mouseout",0)},$I.onMouseUp=function($I,$M,$E){if(void 0===$E&&($E=!1),this.enable){var $Z,$i,$n,$c,$f,$d,$H=0,$B=0,$A=$x.onMobile;if($i=this.getEles($I,null,$t._tEleArr),this.sendEvents($i,$E?"mouseup":"rightmouseup",$M),$d=$E?this.preDowns:this.preRightDowns,$Z=this.getTouchFromArr($M,$d)){var $Q,$p=$x.now();if($Q=$p-this._lastClickTime<300,this._lastClickTime=$p,$I==$Z.tar)$f=$i;else for($n=this.getEles($Z.tar,null,$t._oldArr),($f=$t._newArr).length=0,$B=$n.length,$H=0;$H<$B;$H++)$c=$n[$H],0<=$i.indexOf($c)&&$f.push($c);0<$f.length&&this.sendEvents($f,$E?"click":"rightclick",$M),$E&&$Q&&this.sendEvents($f,"doubleclick",$M),this.removeTouchFromArr($M,$d),$Z.tar=null,$P.recover("TouchData",$Z)}else;($Z=this.getTouchFromArr($M,this.preOvers))&&$A&&(($f=this.getEles($Z.tar,null,$f))&&0<$f.length&&this.sendEvents($f,"mouseout",$M),this.removeTouchFromArr($M,this.preOvers),$Z.tar=null,$P.recover("TouchData",$Z)),this._clearTempArrs()}},$t._oldArr=[],$t._newArr=[],$t._tEleArr=[],$d($t,["I",function(){return this.I=new $t}]),$t}(),$N=function(){function $I(){this._action=null}$V($I,"laya.filters.Filter");var $M=$I.prototype;return $a.imps($M,{"laya.filters.IFilter":!0}),$M.callNative=function($I){},$B(0,$M,"type",function(){return-1}),$B(0,$M,"action",function(){return this._action}),$I.BLUR=16,$I.COLOR=32,$I.GLOW=8,$I._filterStart=null,$I._filterEnd=null,$I._EndTarget=null,$I._recycleScope=null,$I._filter=null,$I._useSrc=null,$I._endSrc=null,$I._useOut=null,$I._endOut=null,$I}(),$$=function(){function $I(){this.data=null}$V($I,"laya.filters.ColorFilterAction");var $M=$I.prototype;return $a.imps($M,{"laya.filters.IFilterAction":!0}),$M.apply=function($I){var $M=$I.ctx.ctx,$E=$I.ctx.ctx.canvas;if(0==$E.width||0==$E.height)return $E;for(var $Z,$i=$M.getImageData(0,0,$E.width,$E.height),$n=$i.data,$c=0,$f=$n.length;$c<$f;$c+=4)$Z=this.getColor($n[$c],$n[$c+1],$n[$c+2],$n[$c+3]),0!=$n[$c+3]&&($n[$c]=$Z[0],$n[$c+1]=$Z[1],$n[$c+2]=$Z[2],$n[$c+3]=$Z[3]);return $M.putImageData($i,0,0),$I},$M.getColor=function($I,$M,$E,$Z){var $i=[];if(this.data._mat&&this.data._alpha){var $n=this.data._mat,$c=this.data._alpha;$i[0]=$n[0]*$I+$n[1]*$M+$n[2]*$E+$n[3]*$Z+$c[0],$i[1]=$n[4]*$I+$n[5]*$M+$n[6]*$E+$n[7]*$Z+$c[1],$i[2]=$n[8]*$I+$n[9]*$M+$n[10]*$E+$n[11]*$Z+$c[2],$i[3]=$n[12]*$I+$n[13]*$M+$n[14]*$E+$n[15]*$Z+$c[3]}return $i},$I}(),$w=(function(){function $I(){}$V($I,"laya.maths.Arith"),$I.formatR=function($I){return $I>Math.PI&&($I-=2*Math.PI),$I<-Math.PI&&($I+=2*Math.PI),$I},$I.isPOT=function($I,$M){return 0<$I&&0==($I&$I-1)&&0<$M&&0==($M&$M-1)},$I.setMatToArray=function($I,$M){$I.a,$I.b,$I.c,$I.d,$I.tx,$I.ty,$M[0]=$I.a,$M[1]=$I.b,$M[4]=$I.c,$M[5]=$I.d,$M[12]=$I.tx,$M[13]=$I.ty}}(),function(){function $I(){this._controlPoints=[new $m,new $m,new $m],this._calFun=this.getPoint2}$V($I,"laya.maths.Bezier");var $M=$I.prototype;return $M._switchPoint=function($I,$M){var $E=this._controlPoints.shift();$E.setTo($I,$M),this._controlPoints.push($E)},$M.getPoint2=function($I,$M){var $E=this._controlPoints[0],$Z=this._controlPoints[1],$i=this._controlPoints[2],$n=Math.pow(1-$I,2)*$E.x+2*$I*(1-$I)*$Z.x+Math.pow($I,2)*$i.x,$c=Math.pow(1-$I,2)*$E.y+2*$I*(1-$I)*$Z.y+Math.pow($I,2)*$i.y;$M.push($n,$c)},$M.getPoint3=function($I,$M){var $E=this._controlPoints[0],$Z=this._controlPoints[1],$i=this._controlPoints[2],$n=this._controlPoints[3],$c=Math.pow(1-$I,3)*$E.x+3*$Z.x*$I*(1-$I)*(1-$I)+3*$i.x*$I*$I*(1-$I)+$n.x*Math.pow($I,3),$f=Math.pow(1-$I,3)*$E.y+3*$Z.y*$I*(1-$I)*(1-$I)+3*$i.y*$I*$I*(1-$I)+$n.y*Math.pow($I,3);$M.push($c,$f)},$M.insertPoints=function($I,$M){var $E,$Z=NaN;for($E=1/($I=0<$I?$I:5),$Z=0;$Z<=1;$Z+=$E)this._calFun($Z,$M)},$M.getBezierPoints=function($I,$M,$E){void 0===$M&&($M=5),void 0===$E&&($E=2);var $Z,$i,$n=0;if(($Z=$I.length)<2*($E+1))return[];switch($i=[],$E){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=$E;)this._controlPoints.push(new $m);for($n=0;$n<2*$E;$n+=2)this._switchPoint($I[$n],$I[$n+1]);for($n=2*$E;$n<$Z;$n+=2)this._switchPoint($I[$n],$I[$n+1]),$n/2%$E==0&&this.insertPoints($M,$i);return $i},$d($I,["I",function(){return this.I=new $I}]),$I}()),$g=function(){function $H(){}return $V($H,"laya.maths.GrahamScan"),$H.multiply=function($I,$M,$E){return($I.x-$E.x)*($M.y-$E.y)-($M.x-$E.x)*($I.y-$E.y)},$H.dis=function($I,$M){return($I.x-$M.x)*($I.x-$M.x)+($I.y-$M.y)*($I.y-$M.y)},$H._getPoints=function($I,$M,$E){for(void 0===$M&&($M=!1),$H._mPointList||($H._mPointList=[]);$H._mPointList.length<$I;)$H._mPointList.push(new $m);return $E||($E=[]),$E.length=0,$M?$H.getFrom($E,$H._mPointList,$I):$H.getFromR($E,$H._mPointList,$I),$E},$H.getFrom=function($I,$M,$E){var $Z=0;for($Z=0;$Z<$E;$Z++)$I.push($M[$Z]);return $I},$H.getFromR=function($I,$M,$E){var $Z=0;for($Z=0;$Z<$E;$Z++)$I.push($M.pop());return $I},$H.pListToPointList=function($I,$M){void 0===$M&&($M=!1);var $E=0,$Z=$I.length/2,$i=$H._getPoints($Z,$M,$H._tempPointList);for($E=0;$E<$Z;$E++)$i[$E].setTo($I[$E+$E],$I[$E+$E+1]);return $i},$H.pointListToPlist=function($I){var $M,$E=0,$Z=$I.length,$i=$H._temPList;for($E=$i.length=0;$E<$Z;$E++)$M=$I[$E],$i.push($M.x,$M.y);return $i},$H.scanPList=function($I){return $K.copyArray($I,$H.pointListToPlist($H.scan($H.pListToPointList($I,!0))))},$H.scan=function($I){var $M,$E,$Z,$i=0,$n=0,$c=0,$f=$I.length,$d={};for(($E=$H._temArr).length=0,$i=($f=$I.length)-1;0<=$i;$i--)$Z=($M=$I[$i]).x+"_"+$M.y,$d.hasOwnProperty($Z)||($d[$Z]=!0,$E.push($M));for($f=$E.length,$K.copyArray($I,$E),$i=1;$i<$f;$i++)($I[$i].y<$I[$c].y||$I[$i].y==$I[$c].y&&$I[$i].x<$I[$c].x)&&($c=$i);for($M=$I[0],$I[0]=$I[$c],$I[$c]=$M,$i=1;$i<$f-1;$i++){for($n=($c=$i)+1;$n<$f;$n++)(0<$H.multiply($I[$n],$I[$c],$I[0])||0==$H.multiply($I[$n],$I[$c],$I[0])&&$H.dis($I[0],$I[$n])<$H.dis($I[0],$I[$c]))&&($c=$n);$M=$I[$i],$I[$i]=$I[$c],$I[$c]=$M}if(($E=$H._temArr).length=0,$I.length<3)return $K.copyArray($E,$I);for($E.push($I[0],$I[1],$I[2]),$i=3;$i<$f;$i++){for(;2<=$E.length&&0<=$H.multiply($I[$i],$E[$E.length-1],$E[$E.length-2]);)$E.pop();$I[$i]&&$E.push($I[$i])}return $E},$H._mPointList=null,$H._tempPointList=[],$H._temPList=[],$H._temArr=[],$H}(),$O=function(){function $i(){}return $V($i,"laya.maths.MathUtil"),$i.subtractVector3=function($I,$M,$E){$E[0]=$I[0]-$M[0],$E[1]=$I[1]-$M[1],$E[2]=$I[2]-$M[2]},$i.lerp=function($I,$M,$E){return $I*(1-$E)+$M*$E},$i.scaleVector3=function($I,$M,$E){$E[0]=$I[0]*$M,$E[1]=$I[1]*$M,$E[2]=$I[2]*$M},$i.lerpVector3=function($I,$M,$E,$Z){var $i=$I[0],$n=$I[1],$c=$I[2];$Z[0]=$i+$E*($M[0]-$i),$Z[1]=$n+$E*($M[1]-$n),$Z[2]=$c+$E*($M[2]-$c)},$i.lerpVector4=function($I,$M,$E,$Z){var $i=$I[0],$n=$I[1],$c=$I[2],$f=$I[3];$Z[0]=$i+$E*($M[0]-$i),$Z[1]=$n+$E*($M[1]-$n),$Z[2]=$c+$E*($M[2]-$c),$Z[3]=$f+$E*($M[3]-$f)},$i.slerpQuaternionArray=function($I,$M,$E,$Z,$i,$n,$c){var $f,$d,$H,$B,$A,$Q=$I[$M+0],$p=$I[$M+1],$t=$I[$M+2],$V=$I[$M+3],$u=$E[$Z+0],$N=$E[$Z+1],$y=$E[$Z+2],$$=$E[$Z+3];return($d=$Q*$u+$p*$N+$t*$y+$V*$$)<0&&($d=-$d,$u=-$u,$N=-$N,$y=-$y,$$=-$$),$A=1e-6<1-$d?($f=Math.acos($d),$H=Math.sin($f),$B=Math.sin((1-$i)*$f)/$H,Math.sin($i*$f)/$H):($B=1-$i,$i),$n[$c+0]=$B*$Q+$A*$u,$n[$c+1]=$B*$p+$A*$N,$n[$c+2]=$B*$t+$A*$y,$n[$c+3]=$B*$V+$A*$$,$n},$i.getRotation=function($I,$M,$E,$Z){return Math.atan2($Z-$M,$E-$I)/Math.PI*180},$i.sortBigFirst=function($I,$M){return $I==$M?0:$I<$M?1:-1},$i.sortSmallFirst=function($I,$M){return $I==$M?0:$I<$M?-1:1},$i.sortNumBigFirst=function($I,$M){return parseFloat($M)-parseFloat($I)},$i.sortNumSmallFirst=function($I,$M){return parseFloat($I)-parseFloat($M)},$i.sortByKey=function($E,$I,$M){var $Z;return void 0===$I&&($I=!1),void 0===$M&&($M=!0),$Z=$I?$M?$i.sortNumBigFirst:$i.sortBigFirst:$M?$i.sortNumSmallFirst:$i.sortSmallFirst,function($I,$M){return $Z($I[$E],$M[$E])}},$i}(),$R=function(){function $E($I,$M,$E,$Z,$i,$n){this.inPool=!1,this.bTransform=!1,void 0===$I&&($I=1),void 0===$M&&($M=0),void 0===$E&&($E=0),void 0===$Z&&($Z=1),void 0===$i&&($i=0),void 0===$n&&($n=0),this.a=$I,this.b=$M,this.c=$E,this.d=$Z,this.tx=$i,this.ty=$n,this._checkTransform()}$V($E,"laya.maths.Matrix");var $I=$E.prototype;return $I.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},$I._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},$I.setTranslate=function($I,$M){return this.tx=$I,this.ty=$M,this},$I.translate=function($I,$M){return this.tx+=$I,this.ty+=$M,this},$I.scale=function($I,$M){this.a*=$I,this.d*=$M,this.c*=$I,this.b*=$M,this.tx*=$I,this.ty*=$M,this.bTransform=!0},$I.rotate=function($I){var $M=Math.cos($I),$E=Math.sin($I),$Z=this.a,$i=this.c,$n=this.tx;this.a=$Z*$M-this.b*$E,this.b=$Z*$E+this.b*$M,this.c=$i*$M-this.d*$E,this.d=$i*$E+this.d*$M,this.tx=$n*$M-this.ty*$E,this.ty=$n*$E+this.ty*$M,this.bTransform=!0},$I.skew=function($I,$M){var $E=Math.tan($I),$Z=Math.tan($M),$i=this.a,$n=this.b;return this.a+=$Z*this.c,this.b+=$Z*this.d,this.c+=$E*$i,this.d+=$E*$n,this},$I.invertTransformPoint=function($I){var $M=this.a,$E=this.b,$Z=this.c,$i=this.d,$n=this.tx,$c=$M*$i-$E*$Z,$f=$i/$c,$d=-$E/$c,$H=-$Z/$c,$B=$M/$c,$A=($Z*this.ty-$i*$n)/$c,$Q=-($M*this.ty-$E*$n)/$c;return $I.setTo($f*$I.x+$H*$I.y+$A,$d*$I.x+$B*$I.y+$Q)},$I.transformPoint=function($I){return $I.setTo(this.a*$I.x+this.c*$I.y+this.tx,this.b*$I.x+this.d*$I.y+this.ty)},$I.transformPointN=function($I){return $I.setTo(this.a*$I.x+this.c*$I.y,this.b*$I.x+this.d*$I.y)},$I.transformPointArray=function($I,$M){for(var $E=$I.length,$Z=0;$Z<$E;$Z+=2){var $i=$I[$Z],$n=$I[$Z+1];$M[$Z]=this.a*$i+this.c*$n+this.tx,$M[$Z+1]=this.b*$i+this.d*$n+this.ty}return $M},$I.transformPointArrayScale=function($I,$M){for(var $E=$I.length,$Z=0;$Z<$E;$Z+=2){var $i=$I[$Z],$n=$I[$Z+1];$M[$Z]=this.a*$i+this.c*$n,$M[$Z+1]=this.b*$i+this.d*$n}return $M},$I.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},$I.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},$I.invert=function(){var $I=this.a,$M=this.b,$E=this.c,$Z=this.d,$i=this.tx,$n=$I*$Z-$M*$E;return this.a=$Z/$n,this.b=-$M/$n,this.c=-$E/$n,this.d=$I/$n,this.tx=($E*this.ty-$Z*$i)/$n,this.ty=-($I*this.ty-$M*$i)/$n,this},$I.setTo=function($I,$M,$E,$Z,$i,$n){return this.a=$I,this.b=$M,this.c=$E,this.d=$Z,this.tx=$i,this.ty=$n,this},$I.concat=function($I){var $M=this.a,$E=this.c,$Z=this.tx;return this.a=$M*$I.a+this.b*$I.c,this.b=$M*$I.b+this.b*$I.d,this.c=$E*$I.a+this.d*$I.c,this.d=$E*$I.b+this.d*$I.d,this.tx=$Z*$I.a+this.ty*$I.c+$I.tx,this.ty=$Z*$I.b+this.ty*$I.d+$I.ty,this},$I.scaleEx=function($I,$M){var $E=this.a,$Z=this.b,$i=this.c,$n=this.d;0!==$Z||0!==$i?(this.a=$I*$E,this.b=$I*$Z,this.c=$M*$i):(this.a=$I*$E,this.b=0*$n,this.c=0*$E),this.d=$M*$n,this.bTransform=!0},$I.rotateEx=function($I){var $M=Math.cos($I),$E=Math.sin($I),$Z=this.a,$i=this.b,$n=this.c,$c=this.d;0!==$i||0!==$n?(this.a=$M*$Z+$E*$n,this.b=$M*$i+$E*$c,this.c=-$E*$Z+$M*$n,this.d=-$E*$i+$M*$c):(this.a=$M*$Z,this.b=$E*$c,this.c=-$E*$Z,this.d=$M*$c),this.bTransform=!0},$I.clone=function(){var $I=$E.create();return $I.a=this.a,$I.b=this.b,$I.c=this.c,$I.d=this.d,$I.tx=this.tx,$I.ty=this.ty,$I.bTransform=this.bTransform,$I},$I.copyTo=function($I){return $I.a=this.a,$I.b=this.b,$I.c=this.c,$I.d=this.d,$I.tx=this.tx,$I.ty=this.ty,$I.bTransform=this.bTransform,$I},$I.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},$I.destroy=function(){if(!this.inPool){var $I=$E._cache;this.inPool=!0,$I._length||($I._length=0),($I[$I._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},$E.mul=function($I,$M,$E){var $Z=$I.a,$i=$I.b,$n=$I.c,$c=$I.d,$f=$I.tx,$d=$I.ty,$H=$M.a,$B=$M.b,$A=$M.c,$Q=$M.d,$p=$M.tx,$t=$M.ty;return 0!==$B||0!==$A?($E.a=$Z*$H+$i*$A,$E.b=$Z*$B+$i*$Q,$E.c=$n*$H+$c*$A,$E.d=$n*$B+$c*$Q,$E.tx=$H*$f+$A*$d+$p,$E.ty=$B*$f+$Q*$d+$t):($E.a=$Z*$H,$E.b=$i*$Q,$E.c=$n*$H,$E.d=$c*$Q,$E.tx=$H*$f+$p,$E.ty=$Q*$d+$t),$E},$E.mul16=function($I,$M,$E){var $Z=$I.a,$i=$I.b,$n=$I.c,$c=$I.d,$f=$I.tx,$d=$I.ty,$H=$M.a,$B=$M.b,$A=$M.c,$Q=$M.d,$p=$M.tx,$t=$M.ty;return 0!==$B||0!==$A?($E[0]=$Z*$H+$i*$A,$E[1]=$Z*$B+$i*$Q,$E[4]=$n*$H+$c*$A,$E[5]=$n*$B+$c*$Q,$E[12]=$H*$f+$A*$d+$p,$E[13]=$B*$f+$Q*$d+$t):($E[0]=$Z*$H,$E[1]=$i*$Q,$E[4]=$n*$H,$E[5]=$c*$Q,$E[12]=$H*$f+$p,$E[13]=$Q*$d+$t),$E},$E.mulPre=function($I,$M,$E,$Z,$i,$n,$c,$f){var $d=$I.a,$H=$I.b,$B=$I.c,$A=$I.d,$Q=$I.tx,$p=$I.ty;return 0!==$E||0!==$Z?($f.a=$d*$M+$H*$Z,$f.b=$d*$E+$H*$i,$f.c=$B*$M+$A*$Z,$f.d=$B*$E+$A*$i,$f.tx=$M*$Q+$Z*$p+$n,$f.ty=$E*$Q+$i*$p+$c):($f.a=$d*$M,$f.b=$H*$i,$f.c=$B*$M,$f.d=$A*$i,$f.tx=$M*$Q+$n,$f.ty=$i*$p+$c),$f},$E.mulPos=function($I,$M,$E,$Z,$i,$n,$c,$f){var $d=$I.a,$H=$I.b,$B=$I.c,$A=$I.d,$Q=$I.tx,$p=$I.ty;return 0!==$H||0!==$B?($f.a=$M*$d+$E*$B,$f.b=$M*$H+$E*$A,$f.c=$Z*$d+$i*$B,$f.d=$Z*$H+$i*$A,$f.tx=$d*$n+$B*$c+$Q,$f.ty=$H*$n+$A*$c+$p):($f.a=$M*$d,$f.b=$E*$A,$f.c=$Z*$d,$f.d=$i*$A,$f.tx=$d*$n+$Q,$f.ty=$A*$c+$p),$f},$E.preMul=function($I,$M,$E){var $Z=$I.a,$i=$I.b,$n=$I.c,$c=$I.d,$f=$M.a,$d=$M.b,$H=$M.c,$B=$M.d,$A=$M.tx,$Q=$M.ty;return $E.a=$f*$Z,$E.b=$E.c=0,$E.d=$B*$c,$E.tx=$A*$Z+$I.tx,$E.ty=$Q*$c+$I.ty,0===$d&&0===$H&&0===$i&&0===$n||($E.a+=$d*$n,$E.d+=$H*$i,$E.b+=$f*$i+$d*$c,$E.c+=$H*$Z+$B*$n,$E.tx+=$Q*$n,$E.ty+=$A*$i),$E},$E.preMulXY=function($I,$M,$E,$Z){var $i=$I.a,$n=$I.b,$c=$I.c,$f=$I.d;return $Z.a=$i,$Z.b=$n,$Z.c=$c,$Z.d=$f,$Z.tx=$M*$i+$I.tx+$E*$c,$Z.ty=$E*$f+$I.ty+$M*$n,$Z},$E.create=function(){var $I=$E._cache,$M=$I._length?$I[--$I._length]:new $E;return $M.inPool=!1,$M},$E.EMPTY=new $E,$E.TEMP=new $E,$E._cache=[],$E}(),$m=function(){function $I($I,$M){void 0===$I&&($I=0),void 0===$M&&($M=0),this.x=$I,this.y=$M}$V($I,"laya.maths.Point");var $M=$I.prototype;return $M.setTo=function($I,$M){return this.x=$I,this.y=$M,this},$M.distance=function($I,$M){return Math.sqrt((this.x-$I)*(this.x-$I)+(this.y-$M)*(this.y-$M))},$M.toString=function(){return this.x+","+this.y},$M.normalize=function(){var $I=Math.sqrt(this.x*this.x+this.y*this.y);if(0<$I){var $M=1/$I;this.x*=$M,this.y*=$M}},$I.TEMP=new $I,$I.EMPTY=new $I,$I}(),$j=function(){function $H($I,$M,$E,$Z){void 0===$I&&($I=0),void 0===$M&&($M=0),void 0===$E&&($E=0),void 0===$Z&&($Z=0),this.x=$I,this.y=$M,this.width=$E,this.height=$Z}$V($H,"laya.maths.Rectangle");var $I=$H.prototype;return $I.setTo=function($I,$M,$E,$Z){return this.x=$I,this.y=$M,this.width=$E,this.height=$Z,this},$I.copyFrom=function($I){return this.x=$I.x,this.y=$I.y,this.width=$I.width,this.height=$I.height,this},$I.contains=function($I,$M){return!(this.width<=0||this.height<=0)&&($I>=this.x&&$I<this.right&&$M>=this.y&&$M<this.bottom)},$I.intersects=function($I){return!($I.x>this.x+this.width||$I.x+$I.width<this.x||$I.y>this.y+this.height||$I.y+$I.height<this.y)},$I.intersection=function($I,$M){return this.intersects($I)?($M||($M=new $H),$M.x=Math.max(this.x,$I.x),$M.y=Math.max(this.y,$I.y),$M.width=Math.min(this.right,$I.right)-$M.x,$M.height=Math.min(this.bottom,$I.bottom)-$M.y,$M):null},$I.union=function($I,$M){return $M||($M=new $H),this.clone($M),$I.width<=0||$I.height<=0?$M:($M.addPoint($I.x,$I.y),$M.addPoint($I.right,$I.bottom),this)},$I.clone=function($I){return $I||($I=new $H),$I.x=this.x,$I.y=this.y,$I.width=this.width,$I.height=this.height,$I},$I.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},$I.equals=function($I){return!(!$I||$I.x!==this.x||$I.y!==this.y||$I.width!==this.width||$I.height!==this.height)},$I.addPoint=function($I,$M){return this.x>$I&&(this.width+=this.x-$I,this.x=$I),this.y>$M&&(this.height+=this.y-$M,this.y=$M),this.width<$I-this.x&&(this.width=$I-this.x),this.height<$M-this.y&&(this.height=$M-this.y),this},$I._getBoundPoints=function(){var $I=$H._temB;return($I.length=0)==this.width||0==this.height||$I.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),$I},$I.isEmpty=function(){return this.width<=0||this.height<=0},$B(0,$I,"right",function(){return this.x+this.width}),$B(0,$I,"bottom",function(){return this.y+this.height}),$H._getBoundPointS=function($I,$M,$E,$Z){var $i=$H._temA;return($i.length=0)==$E||0==$Z||$i.push($I,$M,$I+$E,$M,$I,$M+$Z,$I+$E,$M+$Z),$i},$H._getWrapRec=function($I,$M){if(!$I||$I.length<1)return $M?$M.setTo(0,0,0,0):$H.TEMP.setTo(0,0,0,0);$M=$M||new $H;var $E,$Z,$i,$n,$c,$f=$I.length,$d=$m.TEMP;for($i=$c=-($Z=$n=99999),$E=0;$E<$f;$E+=2)$d.x=$I[$E],$d.y=$I[$E+1],$Z=$Z<$d.x?$Z:$d.x,$n=$n<$d.y?$n:$d.y,$i=$i>$d.x?$i:$d.x,$c=$c>$d.y?$c:$d.y;return $M.setTo($Z,$n,$i-$Z,$c-$n)},$H.EMPTY=new $H,$H.TEMP=new $H,$H._temB=[],$H._temA=[],$H}(),$v=function(){function $d(){}return $V($d,"laya.media.SoundManager"),$B(1,$d,"useAudioMusic",function(){return $d._useAudioMusic},function($I){$d._useAudioMusic=$I,$d._musicClass=$I?$EI:null}),$B(1,$d,"autoStopMusic",function(){return $d._autoStopMusic},function($I){$a.stage.off("blur",null,$d._stageOnBlur),$a.stage.off("focus",null,$d._stageOnFocus),$a.stage.off("visibilitychange",null,$d._visibilityChange),($d._autoStopMusic=$I)&&($a.stage.on("blur",null,$d._stageOnBlur),$a.stage.on("focus",null,$d._stageOnFocus),$a.stage.on("visibilitychange",null,$d._visibilityChange))}),$B(1,$d,"muted",function(){return $d._muted},function($I){$I!=$d._muted&&($I&&$d.stopAllSound(),$d.musicMuted=$I,$d._muted=$I)}),$B(1,$d,"musicMuted",function(){return $d._musicMuted},function($I){$I!=$d._musicMuted&&($I?($d._tMusic&&$d._musicChannel&&!$d._musicChannel.isStopped?$d._musicChannel.pause():$d._musicChannel=null,$d._musicMuted=$I):($d._musicMuted=$I,$d._tMusic&&$d._musicChannel&&$d._musicChannel.resume()))}),$B(1,$d,"soundMuted",function(){return $d._soundMuted},function($I){$d._soundMuted=$I}),$d.addChannel=function($I){0<=$d._channels.indexOf($I)||($d._channels.push($I),$d.autoReleaseSound&&0!=$d._notUsedCount&&$d._notUsedUrls[$I.url]&&(delete $d._notUsedUrls[$I.url],0==--$d._notUsedCount&&$a.timer.clear($d,$d.disposeSoundIfNotUsed)))},$d.removeChannel=function($I){var $M=$d._channels,$E=$M.indexOf($I);if(-1!=$E&&($M.splice($E,1),$d.autoReleaseSound)){var $Z=$I.url,$i=$d.defaultIntervals[$Z]||2e4;if(0<$i){var $n=!0;for($E=$M.length-1;0<=$E;$E--)if($M[$E].url==$Z){$n=!1;break}$n&&($d._notUsedUrls[$Z]=Date.now()+$i,0==$d._notUsedCount++&&$a.timer.loop(1e4,$d,$d.disposeSoundIfNotUsed))}}},$d.disposeSoundIfNotUsed=function(){var $I=$d._notUsedUrls;if(0!=$d._notUsedCount){var $M=Date.now();for(var $E in $I)$M>=$I[$E]&&(delete $I[$E],--$d._notUsedCount,$d.destroySound($E));if(0!=$d._notUsedCount)return}$a.timer.clear($d,$d.disposeSoundIfNotUsed)},$d._visibilityChange=function(){$a.stage.isVisibility?$d._stageOnFocus():$d._stageOnBlur()},$d._stageOnBlur=function(){$d._isActive=!1,$d._musicChannel&&($d._musicChannel.isStopped||($d._blurPaused=!0,$d._musicChannel.pause())),$d.stopAllSound(),$a.stage.once("mousedown",null,$d._stageOnFocus)},$d._recoverWebAudio=function(){$nI.ctx&&"running"!=$nI.ctx.state&&$nI.ctx.resume&&$nI.ctx.resume()},$d._stageOnFocus=function(){if($d._isActive=!0,$d._recoverWebAudio(),$a.stage.off("mousedown",null,$d._stageOnFocus),$d._blurPaused){var $I=$d._musicChannel;$I&&$d._music&&$I.isStopped&&($d._blurPaused=!1,$d._music._disposed?$d.playMusic($I.url,$I.loops,$I.startHandler,$I.completeHandler,$I.startTime):$I.audioBuffer?$I.resume():$d._music.play($I.startTime,$I.loops,$I.startHandler,$I))}},$d.playSound=function($I,$M,$E,$Z,$i,$n){if(void 0===$M&&($M=1),void 0===$n&&($n=0),!$I)return null;if($d._muted)return null;if($d._recoverWebAudio(),$I==$d._tMusic){if($d._musicMuted)return null}else{if(!$d._isActive)return null;if($d._soundMuted)return null}var $c,$f=$d._pool[$I];return $i||($i=$d._soundClass),$f||(($f=new $i).load($I),$d._pool[$I]=$f),($c=$f.play($n,$M,$E))?($I==$d._tMusic&&($d._music=$f,$d._isActive||($d._blurPaused=!0,$c.pause())),$c.url=$I,$c.volume=$I==$d._tMusic?$d.musicVolume:$d.soundVolume,$c.completeHandler=$Z,$c):null},$d.destroySound=function($I){var $M=$d._pool[$I];$M&&(delete $d._pool[$I],$M.dispose())},$d.playMusic=function($I,$M,$E,$Z,$i){return void 0===$M&&($M=0),void 0===$i&&($i=0),$d._tMusic=$I,$d._musicChannel&&$d._musicChannel.stop(),$d._musicChannel=$d.playSound($I,$M,$E,$Z,null,$i)},$d.stopSound=function($I){for(var $M,$E=$d._channels.length-1;0<=$E;$E--)($M=$d._channels[$E]).url==$I&&$M.stop()},$d.stopAll=function(){$d._tMusic=null;var $I=0;for($I=$d._channels.length-1;0<=$I;$I--)$d._channels[$I].stop()},$d.stopAllSound=function(){var $I,$M=0;for($M=$d._channels.length-1;0<=$M;$M--)($I=$d._channels[$M]).url!=$d._tMusic&&$I.stop()},$d.stopMusic=function(){$d._musicChannel&&$d._musicChannel.stop(),$d._tMusic=null},$d.setSoundVolume=function($I,$M){if($M)$d._setVolume($M,$I);else{$d.soundVolume=$I;var $E,$Z=0;for($Z=$d._channels.length-1;0<=$Z;$Z--)($E=$d._channels[$Z]).url!=$d._tMusic&&($E.volume=$I)}},$d.setMusicVolume=function($I){$d.musicVolume=$I,$d._setVolume($d._tMusic,$I)},$d._setVolume=function($I,$M){for(var $E,$Z=$d._channels.length-1;0<=$Z;$Z--)($E=$d._channels[$Z]).url==$I&&($E.volume=$M)},$d.musicVolume=1,$d.soundVolume=1,$d.playbackRate=1,$d._useAudioMusic=!0,$d._muted=!1,$d._soundMuted=!1,$d._musicMuted=!1,$d._tMusic=null,$d._musicChannel=null,$d._music=null,$d._channels=[],$d._autoStopMusic=!1,$d._blurPaused=!1,$d._isActive=!0,$d._soundClass=null,$d._musicClass=null,$d.autoReleaseSound=!0,$d._pool={},$d.defaultIntervals={},$d._notUsedUrls={},$d._notUsedCount=0,$d}(),$T=function(){var $I;function $E(){}return $V($E,"laya.net.LocalStorage"),$E.__init__=function(){$E._baseClass||($E._baseClass=$I).init(),$E.items=$E._baseClass.items,$E.support=$E._baseClass.support},$E.setItem=function($I,$M){$E._baseClass.setItem($I,$M)},$E.getItem=function($I){return $E._baseClass.getItem($I)},$E.setJSON=function($I,$M){$E._baseClass.setJSON($I,$M)},$E.getJSON=function($I){return $E._baseClass.getJSON($I)},$E.removeItem=function($I){$E._baseClass.removeItem($I)},$E.clear=function(){$E._baseClass.clear()},$E._baseClass=null,$E.items=null,$E.support=!1,$E.__init$=function(){$I=function(){function $E(){}return $V($E,""),$E.init=function(){try{$E.support=!0,$E.items=$c.localStorage,$E.setItem("laya","1"),$E.removeItem("laya")}catch($I){$E.support=!1}$E.support||console.log("LocalStorage is not supprot or browser is private mode.")},$E.setItem=function($I,$M){try{$E.support&&$E.items.setItem($I,$M)}catch($I){console.warn("set localStorage failed",$I)}},$E.getItem=function($I){return $E.support?$E.items.getItem($I):null},$E.setJSON=function($I,$M){try{$E.support&&$E.items.setItem($I,JSON.stringify($M))}catch($I){console.warn("set localStorage failed",$I)}},$E.getJSON=function($I){return JSON.parse($E.support?$E.items.getItem($I):null)},$E.removeItem=function($I){$E.support&&$E.items.removeItem($I)},$E.clear=function(){$E.support&&$E.items.clear()},$E.items=null,$E.support=!1,$E}()},$E}(),$z=(function(){function $Z(){}$V($Z,"laya.net.ResourceVersion"),$Z.enable=function($I,$M,$E){void 0===$E&&($E=2),laya.net.ResourceVersion.type=$E,$a.loader.load($I,$y.create(null,$Z.onManifestLoaded,[$M]),null,"json"),$L.customFormat=$Z.addVersionPrefix},$Z.onManifestLoaded=function($I,$M){$Z.manifest=$M,$I.run(),$M||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},$Z.addVersionPrefix=function($I){return $Z.manifest&&$Z.manifest[$I]?2==$Z.type?$Z.manifest[$I]:$Z.manifest[$I]+"/"+$I:$I},$Z.FOLDER_VERSION=1,$Z.FILENAME_VERSION=2,$Z.manifest=null,$Z.type=1}(),function(){function $I(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}$V($I,"laya.net.TTFLoader");var $M=$I.prototype;return $M.load=function($I){var $M=(this._url=$I).split(".ttf")[0].split("/");this.fontName=$M[$M.length-1],$x.window.conch?this._loadConch():$x.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},$M._loadConch=function(){this._http=new $cI,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},$M._onHttpLoaded=function($I){$x.window.conch.setFontFaceFromBuffer(this.fontName,$I),this._clearHttp(),this._complete()},$M._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},$M._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},$M._complete=function(){$a.timer.clear(this,this._complete),$a.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},$M._checkComplete=function(){$W.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},$M._loadWithFontFace=function(){var $I=new $x.window.FontFace(this.fontName,"url('"+this._url+"')");$x.window.document.fonts.add($I);var $M=this;$I.loaded.then(function(){$M._complete()}),$I.load()},$M._createDiv=function(){this._div=$x.createElement("div"),this._div.innerHTML="laya";var $I=this._div.style;$I.fontFamily=this.fontName,$I.position="absolute",$I.left="-100px",$I.top="-100px",$x.document.body.appendChild(this._div)},$M._loadWithCSS=function(){var $I=this,$M=$x.createElement("style");$M.type="text/css",$x.document.body.appendChild($M),$M.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=$W.measureText("LayaTTFFont",this._fontTxt).width;var $E=this;$M.onload=function(){$a.timer.once(1e4,$E,$I._complete)},$a.timer.loop(20,this,this._checkComplete),this._createDiv()},$I._testString="LayaTTFFont",$I}()),$L=function(){function $Z($I){this._url=null,this._path=null,this._url=$Z.formatURL($I),this._path=$Z.getPath($I)}$V($Z,"laya.net.URL");var $I=$Z.prototype;return $B(0,$I,"path",function(){return this._path}),$B(0,$I,"url",function(){return this._url}),$Z.formatURL=function($I,$M){if(!$I)return"null path";if(0<$I.indexOf(":"))return $I;null!=$Z.customFormat&&($I=$Z.customFormat($I,$M));var $E=$I.charAt(0);if("."===$E)return $Z.formatRelativePath(($M||$Z.basePath)+$I);if("~"===$E)return $Z.rootPath+$I.substring(1);if("d"===$E){if(0===$I.indexOf("data:image"))return $I}else if("/"===$E)return $I;return($M||$Z.basePath)+$I},$Z.formatRelativePath=function($I){for(var $M=$I.split("/"),$E=0,$Z=$M.length;$E<$Z;$E++)".."==$M[$E]&&($M.splice($E-1,2),$E-=2);return $M.join("/")},$Z.isAbsolute=function($I){return 0<$I.indexOf(":")||"/"==$I.charAt(0)},$Z.getPath=function($I){var $M=$I.lastIndexOf("/");return 0<$M?$I.substr(0,$M+1):""},$Z.getFileName=function($I){var $M=$I.lastIndexOf("/");return 0<$M?$I.substr($M+1):$I},$Z.version={},$Z.basePath="",$Z.rootPath="",$Z.customFormat=function($I){var $M=$Z.version[$I];return!$o.isConchApp&&$M&&($I+="?v="+$M),$I},$Z}(),$o=function(){function $i($I,$M){this._timeId=0;var $E=$i._mainCanvas.source.style;$E.position="absolute",$E.top=$E.left="0px",$E.background="#000000",$i._mainCanvas.source.id="layaCanvas";var $Z=laya.renders.Render.isWebGL;$i._mainCanvas.source.width=$I,$i._mainCanvas.source.height=$M,$Z&&$i.WebGL.init($i._mainCanvas,$I,$M),$x.container.appendChild($i._mainCanvas.source),($i._context=new $S($I,$M,$Z?null:$i._mainCanvas)).ctx.setIsMainContext(),$x.window.requestAnimationFrame(function $I($M){$x.window.requestAnimationFrame($I);$a.stage._loop()}),$a.stage.on("visibilitychange",this,this._onVisibilitychange)}$V($i,"laya.renders.Render");var $I=$i.prototype;return $I._onVisibilitychange=function(){$a.stage.isVisibility?0!=this._timeId&&$x.window.clearInterval(this._timeId):this._timeId=$x.window.setInterval(this._enterFrame,1e3)},$I._enterFrame=function($I){$a.stage._loop()},$B(1,$i,"context",function(){return $i._context}),$B(1,$i,"canvas",function(){return $i._mainCanvas.source}),$i._context=null,$i._mainCanvas=null,$i.WebGL=null,$i.isConchNode=!1,$i.isConchApp=!1,$i.isConchWebGL=!1,$i.isWebGL=!1,$i.is3DMode=!1,$i.optimizeTextureMemory=function($I,$M){return!0},$i.__init$=function(){$c.ConchRenderType=$c.ConchRenderType||1,$c.ConchRenderType|=$c.conch?4:0,$i.isConchNode=5==(5&$c.ConchRenderType),$i.isConchApp=4==(4&$c.ConchRenderType),$i.isConchWebGL=6==$c.ConchRenderType},$i}(),$S=function(){function $c($I,$M,$E){this.x=0,this.y=0,this._drawTexture=function($I,$M,$E){$E[0].loaded&&this.ctx.drawTexture($E[0],$E[1],$E[2],$E[3],$E[4],$I,$M)},this._fillTexture=function($I,$M,$E){$E[0].loaded&&this.ctx.fillTexture($E[0],$E[1]+$I,$E[2]+$M,$E[3],$E[4],$E[5],$E[6],$E[7])},this._drawTextureWithTransform=function($I,$M,$E){$E[0].loaded&&this.ctx.drawTextureWithTransform($E[0],$E[1],$E[2],$E[3],$E[4],$E[5],$I,$M,$E[6])},this._fillQuadrangle=function($I,$M,$E){this.ctx.fillQuadrangle($E[0],$E[1],$E[2],$E[3],$E[4])},this._drawRect=function($I,$M,$E){var $Z=this.ctx;null!=$E[4]&&($Z.fillStyle=$E[4],$Z.fillRect($I+$E[0],$M+$E[1],$E[2],$E[3],null)),null!=$E[5]&&($Z.strokeStyle=$E[5],$Z.lineWidth=$E[6],$Z.strokeRect($I+$E[0],$M+$E[1],$E[2],$E[3],$E[6]))},this._drawPie=function($I,$M,$E){var $Z=this.ctx;$o.isWebGL&&$Z.setPathId($E[8]),$Z.beginPath(),$o.isWebGL?($Z.movePath($E[0]+$I,$E[1]+$M),$Z.moveTo(0,0)):$Z.moveTo($I+$E[0],$M+$E[1]),$Z.arc($I+$E[0],$M+$E[1],$E[2],$E[3],$E[4]),$Z.closePath(),this._fillAndStroke($E[5],$E[6],$E[7],!0)},this._clipRect=function($I,$M,$E){this.ctx.clipRect($I+$E[0],$M+$E[1],$E[2],$E[3])},this._fillRect=function($I,$M,$E){this.ctx.fillRect($I+$E[0],$M+$E[1],$E[2],$E[3],$E[4])},this._drawCircle=function($I,$M,$E){var $Z=this.ctx;$o.isWebGL&&$Z.setPathId($E[6]),$D.drawCall++,$Z.beginPath(),$o.isWebGL&&$Z.movePath($E[0]+$I,$E[1]+$M),$Z.arc($E[0]+$I,$E[1]+$M,$E[2],0,$c.PI2),$Z.closePath(),this._fillAndStroke($E[3],$E[4],$E[5],!0)},this._fillCircle=function($I,$M,$E){$D.drawCall++;var $Z=this.ctx;$Z.beginPath(),$Z.fillStyle=$E[3],$Z.arc($E[0]+$I,$E[1]+$M,$E[2],0,$c.PI2),$Z.fill()},this._setShader=function($I,$M,$E){this.ctx.setShader($E[0])},this._drawLine=function($I,$M,$E){var $Z=this.ctx;$o.isWebGL&&$Z.setPathId($E[6]),$Z.beginPath(),$Z.strokeStyle=$E[4],$Z.lineWidth=$E[5],$o.isWebGL?($Z.movePath($I,$M),$Z.moveTo($E[0],$E[1]),$Z.lineTo($E[2],$E[3])):($Z.moveTo($I+$E[0],$M+$E[1]),$Z.lineTo($I+$E[2],$M+$E[3])),$Z.stroke()},this._drawLines=function($I,$M,$E){var $Z=this.ctx;$o.isWebGL&&$Z.setPathId($E[5]),$Z.beginPath(),$I+=$E[0],$M+=$E[1],$o.isWebGL&&$Z.movePath($I,$M),$Z.strokeStyle=$E[3],$Z.lineWidth=$E[4];var $i=$E[2],$n=2,$c=$i.length;if($o.isWebGL)for($Z.moveTo($i[0],$i[1]);$n<$c;)$Z.lineTo($i[$n++],$i[$n++]);else for($Z.moveTo($I+$i[0],$M+$i[1]);$n<$c;)$Z.lineTo($I+$i[$n++],$M+$i[$n++]);$Z.stroke()},this._drawLinesWebGL=function($I,$M,$E){this.ctx.drawLines($I+this.x+$E[0],$M+this.y+$E[1],$E[2],$E[3],$E[4])},this._drawCurves=function($I,$M,$E){this.ctx.drawCurves($I,$M,$E)},this._draw=function($I,$M,$E){$E[0].call(null,this,$I,$M)},this._transformByMatrix=function($I,$M,$E){this.ctx.transformByMatrix($E[0])},this._setTransform=function($I,$M,$E){this.ctx.setTransform($E[0],$E[1],$E[2],$E[3],$E[4],$E[5])},this._setTransformByMatrix=function($I,$M,$E){this.ctx.setTransformByMatrix($E[0])},this._save=function($I,$M,$E){this.ctx.save()},this._restore=function($I,$M,$E){this.ctx.restore()},this._translate=function($I,$M,$E){this.ctx.translate($E[0],$E[1])},this._transform=function($I,$M,$E){this.ctx.translate($E[1]+$I,$E[2]+$M);var $Z=$E[0];this.ctx.transform($Z.a,$Z.b,$Z.c,$Z.d,$Z.tx,$Z.ty),this.ctx.translate(-$I-$E[1],-$M-$E[2])},this._rotate=function($I,$M,$E){this.ctx.translate($E[1]+$I,$E[2]+$M),this.ctx.rotate($E[0]),this.ctx.translate(-$I-$E[1],-$M-$E[2])},this._scale=function($I,$M,$E){this.ctx.translate($E[2]+$I,$E[3]+$M),this.ctx.scale($E[0],$E[1]),this.ctx.translate(-$I-$E[2],-$M-$E[3])},this._alpha=function($I,$M,$E){this.ctx.globalAlpha*=$E[0]},this._setAlpha=function($I,$M,$E){this.ctx.globalAlpha=$E[0]},this._fillText=function($I,$M,$E){this.ctx.fillText($E[0],$E[1]+$I,$E[2]+$M,$E[3],$E[4],$E[5])},this._strokeText=function($I,$M,$E){this.ctx.strokeText($E[0],$E[1]+$I,$E[2]+$M,$E[3],$E[4],$E[5],$E[6])},this._fillBorderText=function($I,$M,$E){this.ctx.fillBorderText($E[0],$E[1]+$I,$E[2]+$M,$E[3],$E[4],$E[5],$E[6],$E[7])},this._blendMode=function($I,$M,$E){this.ctx.globalCompositeOperation=$E[0]},this._beginClip=function($I,$M,$E){this.ctx.beginClip&&this.ctx.beginClip($I+$E[0],$M+$E[1],$E[2],$E[3])},this._setIBVB=function($I,$M,$E){this.ctx.setIBVB($E[0]+$I,$E[1]+$M,$E[2],$E[3],$E[4],$E[5],$E[6],$E[7])},this._fillTrangles=function($I,$M,$E){this.ctx.fillTrangles($E[0],$E[1]+$I,$E[2]+$M,$E[3],$E[4])},this._drawPath=function($I,$M,$E){var $Z=this.ctx;$o.isWebGL&&$Z.setPathId(-1),$Z.beginPath(),$I+=$E[0],$M+=$E[1],$o.isWebGL&&$Z.movePath($I,$M);for(var $i=$E[2],$n=0,$c=$i.length;$n<$c;$n++){var $f=$i[$n];switch($f[0]){case"moveTo":$o.isWebGL?$Z.moveTo($f[1],$f[2]):$Z.moveTo($I+$f[1],$M+$f[2]);break;case"lineTo":$o.isWebGL?$Z.lineTo($f[1],$f[2]):$Z.lineTo($I+$f[1],$M+$f[2]);break;case"arcTo":$o.isWebGL?$Z.arcTo($f[1],$f[2],$f[3],$f[4],$f[5]):$Z.arcTo($I+$f[1],$M+$f[2],$I+$f[3],$M+$f[4],$f[5]);break;case"closePath":$Z.closePath()}}var $d=$E[3];null!=$d&&($Z.fillStyle=$d.fillStyle,$Z.fill());var $H=$E[4];null!=$H&&($Z.strokeStyle=$H.strokeStyle,$Z.lineWidth=$H.lineWidth||1,$Z.lineJoin=$H.lineJoin,$Z.lineCap=$H.lineCap,$Z.miterLimit=$H.miterLimit,$Z.stroke())},this.drawPoly=function($I,$M,$E){this.ctx.drawPoly($I+this.x+$E[0],$M+this.y+$E[1],$E[2],$E[3],$E[4],$E[5],$E[6])},this._drawPoly=function($I,$M,$E){var $Z=this.ctx,$i=$E[2],$n=2,$c=$i.length;if($o.isWebGL)for($Z.setPathId($E[6]),$Z.beginPath(),$I+=$E[0],$M+=$E[1],$Z.movePath($I,$M),$Z.moveTo($i[0],$i[1]);$n<$c;)$Z.lineTo($i[$n++],$i[$n++]);else for($Z.beginPath(),$I+=$E[0],$M+=$E[1],$Z.moveTo($I+$i[0],$M+$i[1]);$n<$c;)$Z.lineTo($I+$i[$n++],$M+$i[$n++]);$Z.closePath(),this._fillAndStroke($E[3],$E[4],$E[5],$E[7])},this._drawSkin=function($I,$M,$E){var $Z=$E[0];if($Z){var $i=this.ctx;$Z.render($i,$I,$M)}},this._drawParticle=function($I,$M,$E){this.ctx.drawParticle($I+this.x,$M+this.y,$E[0])},this._setFilters=function($I,$M,$E){this.ctx.setFilters($E)},$E?this.ctx=$E.getContext("2d"):($E=$$I.create("3D"),this.ctx=$W.createWebGLContext2D($E),$E._setContext(this.ctx)),$E.size($I,$M),this.canvas=$E}$V($c,"laya.renders.RenderContext");var $I=$c.prototype;return $I.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},$I.drawTexture=function($I,$M,$E,$Z,$i){$I.loaded&&this.ctx.drawTexture($I,$M,$E,$Z,$i,this.x,this.y)},$I._drawTextures=function($I,$M,$E){$E[0].loaded&&this.ctx.drawTextures($E[0],$E[1],$I+this.x,$M+this.y)},$I.drawTextureWithTransform=function($I,$M,$E,$Z,$i,$n,$c){$I.loaded&&this.ctx.drawTextureWithTransform($I,$M,$E,$Z,$i,$n,this.x,this.y,$c)},$I.fillQuadrangle=function($I,$M,$E,$Z,$i){this.ctx.fillQuadrangle($I,$M,$E,$Z,$i)},$I.drawCanvas=function($I,$M,$E,$Z,$i){this.ctx.drawCanvas($I,$M+this.x,$E+this.y,$Z,$i)},$I.drawRect=function($I,$M,$E,$Z,$i,$n){void 0===$n&&($n=1);var $c=this.ctx;$c.strokeStyle=$i,$c.lineWidth=$n,$c.strokeRect($I+this.x,$M+this.y,$E,$Z,$n)},$I._fillAndStroke=function($I,$M,$E,$Z){void 0===$Z&&($Z=!1);var $i=this.ctx;null!=$I&&($i.fillStyle=$I,$o.isWebGL?$i.fill($Z):$i.fill()),null!=$M&&0<$E&&($i.strokeStyle=$M,$i.lineWidth=$E,$i.stroke())},$I.clipRect=function($I,$M,$E,$Z){this.ctx.clipRect($I+this.x,$M+this.y,$E,$Z)},$I.fillRect=function($I,$M,$E,$Z,$i){this.ctx.fillRect($I+this.x,$M+this.y,$E,$Z,$i)},$I.drawCircle=function($I,$M,$E,$Z,$i){void 0===$i&&($i=1),$D.drawCall++;var $n=this.ctx;$n.beginPath(),$n.strokeStyle=$Z,$n.lineWidth=$i,$n.arc($I+this.x,$M+this.y,$E,0,$c.PI2),$n.stroke()},$I.drawTriangles=function($I,$M,$E){if($o.isWebGL)this.ctx.drawTriangles($E[0],$I+$E[1],$M+$E[2],$E[3],$E[4],$E[5],$E[6],$E[7],$E[8],$E[9]);else{var $Z=$E[5],$i=0,$n=$Z.length,$c=this.ctx;for($i=0;$i<$n;$i+=3){var $f=2*$Z[$i],$d=2*$Z[$i+1],$H=2*$Z[$i+2];$c.drawTriangle($E[0],$E[3],$E[4],$f,$d,$H,$E[6],!0)}}},$I.fillCircle=function($I,$M,$E,$Z){$D.drawCall++;var $i=this.ctx;$i.beginPath(),$i.fillStyle=$Z,$i.arc($I+this.x,$M+this.y,$E,0,$c.PI2),$i.fill()},$I.setShader=function($I){this.ctx.setShader($I)},$I.drawLine=function($I,$M,$E,$Z,$i,$n){void 0===$n&&($n=1);var $c=this.ctx;$c.beginPath(),$c.strokeStyle=$i,$c.lineWidth=$n,$c.moveTo(this.x+$I,this.y+$M),$c.lineTo(this.x+$E,this.y+$Z),$c.stroke()},$I.clear=function(){this.ctx.clear()},$I.transformByMatrix=function($I){this.ctx.transformByMatrix($I)},$I.setTransform=function($I,$M,$E,$Z,$i,$n){this.ctx.setTransform($I,$M,$E,$Z,$i,$n)},$I.setTransformByMatrix=function($I){this.ctx.setTransformByMatrix($I)},$I.save=function(){this.ctx.save()},$I.restore=function(){this.ctx.restore()},$I.translate=function($I,$M){this.ctx.translate($I,$M)},$I.transform=function($I,$M,$E,$Z,$i,$n){this.ctx.transform($I,$M,$E,$Z,$i,$n)},$I.rotate=function($I){this.ctx.rotate($I)},$I.scale=function($I,$M){this.ctx.scale($I,$M)},$I.alpha=function($I){this.ctx.globalAlpha*=$I},$I.setAlpha=function($I){this.ctx.globalAlpha=$I},$I.fillWords=function($I,$M,$E,$Z,$i,$n){void 0===$n&&($n=0),this.ctx.fillWords($I,$M,$E,$Z,$i,$n)},$I.fillBorderWords=function($I,$M,$E,$Z,$i,$n,$c){this.ctx.fillBorderWords($I,$M,$E,$Z,$i,$n,$c)},$I.fillText=function($I,$M,$E,$Z,$i,$n){this.ctx.fillText($I,$M+this.x,$E+this.y,$Z,$i,$n)},$I.strokeText=function($I,$M,$E,$Z,$i,$n,$c){this.ctx.strokeText($I,$M+this.x,$E+this.y,$Z,$i,$n,$c)},$I.blendMode=function($I){this.ctx.globalCompositeOperation=$I},$I.flush=function(){this.ctx.flush&&this.ctx.flush()},$I.addRenderObject=function($I){this.ctx.addRenderObject($I)},$I.beginClip=function($I,$M,$E,$Z){this.ctx.beginClip&&this.ctx.beginClip($I,$M,$E,$Z)},$I.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},$I.fillTrangles=function($I,$M,$E){this.ctx.fillTrangles($E[0],$E[1],$E[2],$E[3],4<$E.length?$E[4]:null)},$c.PI2=2*Math.PI,$c}(),$X=function(){function $c($I,$M){switch(this._next=$M||$c.NORENDER,$I){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=$N._filter);case 69905:return void(this._fun=$c._initRenderFun)}this.onCreate($I)}$V($c,"laya.renders.RenderSprite");var $I=$c.prototype;return $I.onCreate=function($I){},$I._style=function($I,$M,$E,$Z){$I._style.render($I,$M,$E,$Z);var $i=this._next;$i._fun.call($i,$I,$M,$E,$Z)},$I._no=function($I,$M,$E,$Z){},$I._custom=function($I,$M,$E,$Z){$I.customRender($M,$E,$Z);var $i=$I._style._tf;this._next._fun.call(this._next,$I,$M,$E-$i.translateX,$Z-$i.translateY)},$I._clip=function($I,$M,$E,$Z){var $i=this._next;if($i!=$c.NORENDER){var $n=$I._style.scrollRect;$M.ctx.save(),$M.ctx.clipRect($E,$Z,$n.width,$n.height),$i._fun.call($i,$I,$M,$E-$n.x,$Z-$n.y),$M.ctx.restore()}},$I._blend=function($I,$M,$E,$Z){var $i=$I._style;$i.blendMode&&($M.ctx.globalCompositeOperation=$i.blendMode);var $n=this._next;$n._fun.call($n,$I,$M,$E,$Z),$M.ctx.globalCompositeOperation="source-over"},$I._mask=function($I,$M,$E,$Z){var $i=this._next;$i._fun.call($i,$I,$M,$E,$Z);var $n=$I.mask;$n&&($M.ctx.globalCompositeOperation="destination-in",(0<$n.numChildren||!$n.graphics._isOnlyOne())&&($n.cacheAsBitmap=!0),$n.render($M,$E-$I.pivotX,$Z-$I.pivotY)),$M.ctx.globalCompositeOperation="source-over"},$I._graphics=function($I,$M,$E,$Z){var $i=$I._style._tf;$I._graphics&&$I._graphics._render($I,$M,$E-$i.translateX,$Z-$i.translateY);var $n=this._next;$n._fun.call($n,$I,$M,$E,$Z)},$I._image=function($I,$M,$E,$Z){var $i=$I._style;$M.ctx.drawTexture2($E,$Z,$i._tf.translateX,$i._tf.translateY,$I.transform,$i.alpha,$i.blendMode,$I._graphics._one)},$I._image2=function($I,$M,$E,$Z){var $i=$I._style._tf;$M.ctx.drawTexture2($E,$Z,$i.translateX,$i.translateY,$I.transform,1,null,$I._graphics._one)},$I._alpha=function($I,$M,$E,$Z){var $i;if(.01<($i=$I._style.alpha)||$I._needRepaint()){var $n=$M.ctx.globalAlpha;$M.ctx.globalAlpha*=$i;var $c=this._next;$c._fun.call($c,$I,$M,$E,$Z),$M.ctx.globalAlpha=$n}},$I._transform=function($I,$M,$E,$Z){var $i=$I.transform,$n=this._next;$i&&$n!=$c.NORENDER?($M.save(),$M.transform($i.a,$i.b,$i.c,$i.d,$i.tx+$E,$i.ty+$Z),$n._fun.call($n,$I,$M,0,0),$M.restore()):$n._fun.call($n,$I,$M,$E,$Z)},$I._childs=function($I,$M,$E,$Z){var $i=$I._style,$n=$i._tf;if($E=$E-$n.translateX+$i.paddingLeft,$Z=$Z-$n.translateY+$i.paddingTop,$i._calculation){var $c=$I._getWords();if($c){var $f=$i;$f&&($f.stroke?$M.fillBorderWords($c,$E,$Z,$f.font,$f.color,$f.strokeColor,$f.stroke):$M.fillWords($c,$E,$Z,$f.font,$f.color,"none"!=$f.textDecoration&&$f.underLine?1:0))}}var $d,$H=$I._childs,$B=$H.length;if($I.viewport||$I.optimizeScrollRect&&$I._style.scrollRect){var $A=$I.viewport||$I._style.scrollRect,$Q=$A.x,$p=$A.y,$t=$A.right,$V=$A.bottom,$u=NaN,$N=NaN;for($y=0;$y<$B;++$y)($d=$H[$y]).visible&&($u=$d._x)<$t&&$u+$d.width>$Q&&($N=$d._y)<$V&&$N+$d.height>$p&&$d.render($M,$E,$Z)}else for(var $y=0;$y<$B;++$y)($d=$H[$y])._style.visible&&$d.render($M,$E,$Z)},$I._canvas=function($I,$M,$E,$Z){var $i=$I._$P.cacheCanvas;if($i){"bitmap"===$i.type?$D.canvasBitmap++:$D.canvasNormal++;var $n=$i.ctx;if($I._needRepaint()||!$n)this._canvas_repaint($I,$M,$E,$Z);else{var $c=$i._cacheRec;$M.drawCanvas($n.canvas,$E+$c.x,$Z+$c.y,$c.width,$c.height)}}else this._next._fun.call(this._next,$I,$M,$E,$Z)},$I._canvas_repaint=function($I,$M,$E,$Z){var $i=$I._$P.cacheCanvas,$n=this._next;if($i){var $c,$f,$d,$H,$B=$i.ctx,$A=$I._needRepaint()||!$B,$Q=$i.type;if("bitmap"===$Q?$D.canvasBitmap++:$D.canvasNormal++,$A){var $p,$t;$i._cacheRec||($i._cacheRec=new $j),$o.isWebGL&&"bitmap"!==$Q?$i._cacheRec.setTo(-$I.pivotX,-$I.pivotY,1,1):(($H=$I.getSelfBounds()).x=$H.x-$I.pivotX,$H.y=$H.y-$I.pivotY,$H.x=$H.x-16,$H.y=$H.y-16,$H.width=$H.width+32,$H.height=$H.height+32,$H.x=Math.floor($H.x+$E)-$E,$H.y=Math.floor($H.y+$Z)-$Z,$H.width=Math.floor($H.width),$H.height=Math.floor($H.height),$i._cacheRec.copyFrom($H)),$H=$i._cacheRec;var $V,$u=$o.isWebGL?1:$x.pixelRatio*$a.stage.clientScaleX,$N=$o.isWebGL?1:$x.pixelRatio*$a.stage.clientScaleY;if(!$o.isWebGL){var $y,$$=1,$w=1;for($y=$I;$y&&$y!=$a.stage;)$$*=$y.scaleX,$w*=$y.scaleY,$y=$y.parent;$o.isWebGL?($$<1&&($u*=$$),$w<1&&($N*=$w)):(1<$$&&($u*=$$),1<$w&&($N*=$w))}if($I.scrollRect){var $g=$I.scrollRect;$H.x-=$g.x,$H.y-=$g.y}if($p=$H.width*$u,$t=$H.height*$N,$f=$H.x,$d=$H.y,$o.isWebGL&&"bitmap"===$Q&&(2048<$p||2048<$t))return console.warn("cache bitmap size larger than 2048,cache ignored"),$i.ctx&&($P.recover("RenderContext",$i.ctx),$i.ctx.canvas.size(0,0),$i.ctx=null),void $n._fun.call($n,$I,$M,$E,$Z);if($B||($B=$i.ctx=$P.getItem("RenderContext")||new $S($p,$t,$$I.create("AUTO"))),$B.ctx.sprite=$I,($c=$B.canvas).clear(),($c.width!=$p||$c.height!=$t)&&$c.size($p,$t),"bitmap"===$Q?$c.context.asBitmap=!0:"normal"===$Q&&($c.context.asBitmap=!1),1!=$u||1!=$N){var $O=$B.ctx;$O.save(),$O.scale($u,$N),!$o.isConchWebGL&&$o.isConchApp&&($V=$I._$P.cf)&&$O.setFilterMatrix&&$O.setFilterMatrix($V._mat,$V._alpha),$n._fun.call($n,$I,$B,-$f,-$d),$O.restore(),$o.isConchApp&&!$o.isConchWebGL||$I._applyFilters()}else $O=$B.ctx,!$o.isConchWebGL&&$o.isConchApp&&($V=$I._$P.cf)&&$O.setFilterMatrix&&$O.setFilterMatrix($V._mat,$V._alpha),$n._fun.call($n,$I,$B,-$f,-$d),$o.isConchApp&&!$o.isConchWebGL||$I._applyFilters();$I._$P.staticCache&&($i.reCache=!1),$D.canvasReCache++}else $f=($H=$i._cacheRec).x,$d=$H.y,$c=$B.canvas;$M.drawCanvas($c,$E+$f,$Z+$d,$H.width,$H.height)}else $n._fun.call($n,$I,$B,$E,$Z)},$c.__init__=function(){var $I,$M,$E=0;for($M=$W.createRenderSprite(69905,null),$I=$c.renders.length=4096,$E=0;$E<$I;$E++)$c.renders[$E]=$M;$c.renders[0]=$W.createRenderSprite(0,null),function($I,$M){for(var $E=0,$Z=0;$Z<$I.length;$Z++)$E|=$I[$Z],$c.renders[$E]=$M}([1,512,4,2],new $c(1,null)),$c.renders[513]=$W.createRenderSprite(513,null),$c.renders[517]=new $c(517,null)},$c._initRenderFun=function($I,$M,$E,$Z){var $i=$I._renderType;($c.renders[$i]=$c._getTypeRender($i))._fun($I,$M,$E,$Z)},$c._getTypeRender=function($I){for(var $M=null,$E=2048;1<$E;)$E&$I&&($M=$W.createRenderSprite($E,$M)),$E>>=1;return $M},$c.IMAGE=1,$c.ALPHA=2,$c.TRANSFORM=4,$c.BLEND=8,$c.CANVAS=16,$c.FILTERS=32,$c.MASK=64,$c.CLIP=128,$c.STYLE=256,$c.GRAPHICS=512,$c.CUSTOM=1024,$c.CHILDS=2048,$c.INIT=69905,$c.renders=[],$c.NORENDER=new $c(0,null),$c}(),$C=function(){function $f(){this._repaint=!1}$V($f,"laya.resource.Context");var $I=$f.prototype;return $I.replaceReset=function(){var $I,$M,$E=0;for($I=$f.replaceKeys.length,$E=0;$E<$I;$E++)$M=$f.replaceKeys[$E],this[$f.newKeys[$E]]=this[$M]},$I.replaceResotre=function(){this.__restore(),this.__reset()},$I.setIsMainContext=function(){},$I.drawTextures=function($I,$M,$E,$Z){$D.drawCall+=$M.length/2;for(var $i=$I.width,$n=$I.height,$c=0,$f=$M.length;$c<$f;$c+=2)this.drawTexture($I,$M[$c],$M[$c+1],$i,$n,$E,$Z)},$I.drawCanvas=function($I,$M,$E,$Z,$i){$D.drawCall++,this.drawImage($I.source,$M,$E,$Z,$i)},$I.fillRect=function($I,$M,$E,$Z,$i){$D.drawCall++,$i&&(this.fillStyle=$i),this.__fillRect($I,$M,$E,$Z)},$I.fillText=function($I,$M,$E,$Z,$i,$n){$D.drawCall++,3<arguments.length&&null!=$Z&&(this.font=$Z,this.fillStyle=$i,this.textAlign=$n,this.textBaseline="top"),this.__fillText($I,$M,$E)},$I.fillBorderText=function($I,$M,$E,$Z,$i,$n,$c,$f){$D.drawCall++,this.font=$Z,this.fillStyle=$i,this.textBaseline="top",this.strokeStyle=$n,this.lineWidth=$c,this.textAlign=$f,this.__strokeText($I,$M,$E),this.__fillText($I,$M,$E)},$I.strokeText=function($I,$M,$E,$Z,$i,$n,$c){$D.drawCall++,3<arguments.length&&null!=$Z&&(this.font=$Z,this.strokeStyle=$i,this.lineWidth=$n,this.textAlign=$c,this.textBaseline="top"),this.__strokeText($I,$M,$E)},$I.transformByMatrix=function($I){this.transform($I.a,$I.b,$I.c,$I.d,$I.tx,$I.ty)},$I.setTransformByMatrix=function($I){this.setTransform($I.a,$I.b,$I.c,$I.d,$I.tx,$I.ty)},$I.clipRect=function($I,$M,$E,$Z){$D.drawCall++,this.beginPath(),this.rect($I,$M,$E,$Z),this.clip()},$I.drawTexture=function($I,$M,$E,$Z,$i,$n,$c){$D.drawCall++;var $f=$I.uv,$d=$I.bitmap.width,$H=$I.bitmap.height;this.drawImage($I.source,$f[0]*$d,$f[1]*$H,($f[2]-$f[0])*$d,($f[5]-$f[3])*$H,$M+$n,$E+$c,$Z,$i)},$I.drawTextureWithTransform=function($I,$M,$E,$Z,$i,$n,$c,$f,$d){$D.drawCall++;var $H=$I.uv,$B=$I.bitmap.width,$A=$I.bitmap.height;this.save(),1!=$d&&(this.globalAlpha*=$d),$n?(this.transform($n.a,$n.b,$n.c,$n.d,$n.tx+$c,$n.ty+$f),this.drawImage($I.source,$H[0]*$B,$H[1]*$A,($H[2]-$H[0])*$B,($H[5]-$H[3])*$A,$M,$E,$Z,$i)):this.drawImage($I.source,$H[0]*$B,$H[1]*$A,($H[2]-$H[0])*$B,($H[5]-$H[3])*$A,$M+$c,$E+$f,$Z,$i),this.restore()},$I.drawTexture2=function($I,$M,$E,$Z,$i,$n,$c,$f){var $d=$f[0];if($d.loaded&&$d.bitmap&&$d.source){$D.drawCall++;var $H=1!==$n;if($H){var $B=this.globalAlpha;this.globalAlpha*=$n}var $A=$d.uv,$Q=$d.bitmap.width,$p=$d.bitmap.height;$i?(this.save(),this.transform($i.a,$i.b,$i.c,$i.d,$i.tx+$I,$i.ty+$M),this.drawImage($d.source,$A[0]*$Q,$A[1]*$p,($A[2]-$A[0])*$Q,($A[5]-$A[3])*$p,$f[1]-$E,$f[2]-$Z,$f[3],$f[4]),this.restore()):this.drawImage($d.source,$A[0]*$Q,$A[1]*$p,($A[2]-$A[0])*$Q,($A[5]-$A[3])*$p,$f[1]-$E+$I,$f[2]-$Z+$M,$f[3],$f[4]),$H&&(this.globalAlpha=$B)}},$I.fillTexture=function($I,$M,$E,$Z,$i,$n,$c,$f){if(!$f.pat){if($I.uv!=$BI.DEF_UV){var $d=new $$I("2D");$d.getContext("2d"),$d.size($I.width,$I.height),$d.context.drawTexture($I,0,0,$I.width,$I.height,0,0),$I=new $BI($d)}$f.pat=this.createPattern($I.bitmap.source,$n)}var $H=$M,$B=$E,$A=0,$Q=0;$c&&($H+=$c.x%$I.width,$B+=$c.y%$I.height,$A-=$c.x%$I.width,$Q-=$c.y%$I.height),this.translate($H,$B),this.fillRect($A,$Q,$Z,$i,$f.pat),this.translate(-$H,-$B)},$I.drawTriangle=function($I,$M,$E,$Z,$i,$n,$c,$f){var $d=$I.bitmap,$H=$d.source,$B=$I.width,$A=$I.height,$Q=$d.width,$p=$d.height,$t=$E[$Z]*$Q,$V=$E[$i]*$Q,$u=$E[$n]*$Q,$N=$E[$Z+1]*$p,$y=$E[$i+1]*$p,$$=$E[$n+1]*$p,$w=$M[$Z],$g=$M[$i],$O=$M[$n],$a=$M[$Z+1],$m=$M[$i+1],$j=$M[$n+1];if($f){var $T=($w+$g+$O)/3,$q=($a+$m+$j)/3,$v=$w-$T,$W=$a-$q,$R=Math.sqrt($v*$v+$W*$W);$w=$T+$v/$R*($R+1),$a=$q+$W/$R*($R+1),$W=$m-$q,$g=$T+($v=$g-$T)/($R=Math.sqrt($v*$v+$W*$W))*($R+1),$m=$q+$W/$R*($R+1),$W=$j-$q,$O=$T+($v=$O-$T)/($R=Math.sqrt($v*$v+$W*$W))*($R+1),$j=$q+$W/$R*($R+1)}this.save(),$c&&this.transform($c.a,$c.b,$c.c,$c.d,$c.tx,$c.ty),this.beginPath(),this.moveTo($w,$a),this.lineTo($g,$m),this.lineTo($O,$j),this.closePath(),this.clip();var $z=1/($t*$y+$N*$u+$V*$$-$y*$u-$N*$V-$t*$$),$L=$w*$y+$N*$O+$g*$$-$y*$O-$N*$g-$w*$$,$o=$t*$g+$w*$u+$V*$O-$g*$u-$w*$V-$t*$O,$S=$t*$y*$O+$N*$g*$u+$w*$V*$$-$w*$y*$u-$N*$V*$O-$t*$g*$$,$X=$a*$y+$N*$j+$m*$$-$y*$j-$N*$m-$a*$$,$C=$t*$m+$a*$u+$V*$j-$m*$u-$a*$V-$t*$j,$J=$t*$y*$j+$N*$m*$u+$a*$V*$$-$a*$y*$u-$N*$V*$j-$t*$m*$$;this.transform($L*$z,$X*$z,$o*$z,$C*$z,$S*$z,$J*$z),this.drawImage($H,$I.uv[0]*$Q,$I.uv[1]*$p,$B,$A,$I.uv[0]*$Q,$I.uv[1]*$p,$B,$A),this.restore()},$I.flush=function(){return 0},$I.fillWords=function($I,$M,$E,$Z,$i,$n){$Z&&(this.font=$Z),$i&&(this.fillStyle=$i);this.textBaseline="top",this.textAlign="left";for(var $c=0,$f=$I.length;$c<$f;$c++){var $d=$I[$c];if(this.__fillText($d.char,$d.x+$M,$d.y+$E),1===$n){var $H=$d.height,$B=.5*$d.style.letterSpacing;$B||($B=0),this.beginPath(),this.strokeStyle=$i,this.lineWidth=1,this.moveTo($M+$d.x-$B+.5,$E+$d.y+$H+.5),this.lineTo($M+$d.x+$d.width+$B+.5,$E+$d.y+$H+.5),this.stroke()}}},$I.fillBorderWords=function($I,$M,$E,$Z,$i,$n,$c){$Z&&(this.font=$Z),$i&&(this.fillStyle=$i),this.textBaseline="top",this.lineWidth=$c,this.textAlign="left",this.strokeStyle=$n;for(var $f=0,$d=$I.length;$f<$d;$f++){var $H=$I[$f];this.__strokeText($H.char,$H.x+$M,$H.y+$E),this.__fillText($H.char,$H.x+$M,$H.y+$E)}},$I.destroy=function(){this.canvas.width=this.canvas.height=0},$I.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},$I.drawCurves=function($I,$M,$E){this.beginPath(),this.strokeStyle=$E[3],this.lineWidth=$E[4];var $Z=$E[2];$I+=$E[0],$M+=$E[1],this.moveTo($I+$Z[0],$M+$Z[1]);for(var $i=2,$n=$Z.length;$i<$n;)this.quadraticCurveTo($I+$Z[$i++],$M+$Z[$i++],$I+$Z[$i++],$M+$Z[$i++]);this.stroke()},$f.__init__=function($M){var $E=laya.resource.Context.prototype;if(!($M=$M||CanvasRenderingContext2D.prototype).inited){$M.inited=!0,$M.__fillText=$M.fillText,$M.__fillRect=$M.fillRect,$M.__strokeText=$M.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function($I){$M[$I]=$E[$I]})}},$f.replaceCanvasGetSet=function($I,$M){var $E=Object.getOwnPropertyDescriptor($I,$M);if(!$E||!$E.configurable)return!1;var $Z,$i={};for($Z in $E)"set"!=$Z&&($i[$Z]=$E[$Z]);var $n=$E.set;return $i.set=function($I){$n.call(this,$I);var $M=this.getContext("2d");$M&&"__reset"in $M&&$M.__reset()},Object.defineProperty($I,$M,$i),!0},$f.replaceGetSet=function($I,$M){var $E=Object.getOwnPropertyDescriptor($I,$M);if(!$E||!$E.configurable)return!1;var $Z,$i={};for($Z in $E)"set"!=$Z&&($i[$Z]=$E[$Z]);var $n=$E.set,$c="___"+$M+"__";return $f.newKeys.push($c),$i.set=function($I){$I!=this[$c]&&(this[$c]=$I,$n.call(this,$I))},Object.defineProperty($I,$M,$i),!0},$f._default=new $f,$f.newKeys=[],$d($f,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),$f}(),$J=function(){function $n($I){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++$n._uniqueIDCounter,this._name=$I||"Content Manager",$n._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,$n._resourceManagers.push(this),this._resources=[],this._records={}}$V($n,"laya.resource.ResourceManager");var $I=$n.prototype;return $a.imps($I,{"laya.resource.IDispose":!0}),$I.getResourceByIndex=function($I){return this._resources[$I]},$I.getResourcesLength=function(){return this._resources.length},$I.addResource=function($I){return $I.resourceManager&&$I.resourceManager.removeResource($I),-1===this._resources.indexOf($I)&&(($I._resourceManager=this)._resources.push($I),this.addRecord($I.uri,$I.__className,$I.memorySize),this.addSize($I.memorySize),!0)},$I.removeResource=function($I){var $M=this._resources.indexOf($I);return-1!==$M&&(this._resources.splice($M,1),$I._resourceManager=null,this._memorySize-=$I.memorySize,this.addRecord($I.uri,$I.__className,-$I.memorySize),!0)},$I.unload=function(){for(var $I=this._resources.slice(0,this._resources.length),$M=0;$M<$I.length;$M++){$I[$M].destroy()}$I.length=0},$I.dispose=function(){if(this===$n._systemResourceManager)throw new Error("systemResourceManager不能被释放！");$n._resourceManagers.splice($n._resourceManagers.indexOf(this),1),$n._isResourceManagersSorted=!1;for(var $I=this._resources.slice(0,this._resources.length),$M=0;$M<$I.length;$M++){var $E=$I[$M];$E.resourceManager.removeResource($E),$E.destroy()}$I.length=0},$I.addSize=function($I){$I&&(this.autoRelease&&0<$I&&this._memorySize+$I>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=$I)},$I.addRecord=function($I,$M,$E){DEBUG&&$E&&!$I&&console.error($I,$M,$E)},$I.garbageCollection=function($I){var $M=this._resources;($M=$M.slice()).sort(function($I,$M){if(!$I||!$M)throw new Error("a或b不能为空！");return $I.released&&$M.released?0:$I.released?1:$M.released?-1:$I._lastUseFrameCount-$M._lastUseFrameCount});for(var $E=$D.loopCount,$Z=0,$i=$M.length;$Z<$i;$Z++){var $n=$M[$Z];if(!(1<$E-$n._lastUseFrameCount))return void(this._memorySize>=$I&&(this._isOverflow=!0));if($n.releaseResource(),this._memorySize<$I)return void(this._isOverflow=!1)}},$B(0,$I,"id",function(){return this._id}),$B(0,$I,"name",function(){return this._name},function($I){!$I&&""===$I||this._name===$I||(this._name=$I,$n._isResourceManagersSorted=!1)}),$B(0,$I,"memorySize",function(){return this._memorySize}),$B(0,$I,"records",function(){return this._records}),$B(1,$n,"systemResourceManager",function(){return $n._systemResourceManager}),$n.__init__=function(){$n.currentResourceManager=$n.systemResourceManager},$n.getLoadedResourceManagerByIndex=function($I){return $n._resourceManagers[$I]},$n.getLoadedResourceManagersCount=function(){return $n._resourceManagers.length},$n.recreateContentManagers=function($I){void 0===$I&&($I=!1);for(var $M=$n.currentResourceManager,$E=0;$E<$n._resourceManagers.length;$E++){$n.currentResourceManager=$n._resourceManagers[$E];for(var $Z=0;$Z<$n.currentResourceManager._resources.length;$Z++)$n.currentResourceManager._resources[$Z].releaseResource($I),$n.currentResourceManager._resources[$Z].activeResource($I)}$n.currentResourceManager=$M},$n.releaseContentManagers=function($I){void 0===$I&&($I=!1);for(var $M=$n.currentResourceManager,$E=0;$E<$n._resourceManagers.length;$E++){$n.currentResourceManager=$n._resourceManagers[$E];for(var $Z=0;$Z<$n.currentResourceManager._resources.length;$Z++){var $i=$n.currentResourceManager._resources[$Z];!$i.released&&$i.releaseResource($I)}}$n.currentResourceManager=$M},$n._uniqueIDCounter=0,$n._isResourceManagersSorted=!1,$n._resourceManagers=[],$d($n,["_systemResourceManager",function(){return this._systemResourceManager=new $n("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=$n._systemResourceManager}]),$n}(),$x=(function(){function $I(){}$V($I,"laya.system.System"),$I.changeDefinition=function($I,$M){$a[$I]=$M;var $E=$I+"=classObj";$a._runScript($E)},$I.__init__=function(){$o.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function $E(){}return $V($E,"laya.utils.Browser"),$B(1,$E,"pixelRatio",function(){return $E.__init__(),-1<$E.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:$W.getPixelRatio()}),$B(1,$E,"height",function(){return $E.__init__(),($a.stage&&$a.stage.canvasRotation?$E.clientWidth:$E.clientHeight)*$E.pixelRatio}),$B(1,$E,"clientWidth",function(){return $E.__init__(),$E.window.innerWidth||$E.document.body.clientWidth}),$B(1,$E,"window",function(){return $E.__init__(),$E._window}),$B(1,$E,"clientHeight",function(){return $E.__init__(),$E.window.innerHeight||$E.document.body.clientHeight||$E.document.documentElement.clientHeight}),$B(1,$E,"width",function(){return $E.__init__(),($a.stage&&$a.stage.canvasRotation?$E.clientHeight:$E.clientWidth)*$E.pixelRatio}),$B(1,$E,"container",function(){return $E.__init__(),$E._container||(($E._container=$E.createElement("div")).id="layaContainer",$E.document.body.appendChild($E._container)),$E._container},function($I){$E._container=$I}),$B(1,$E,"document",function(){return $E.__init__(),$E._document}),$E.__init__=function(){if(!$E._window){$E._window=$W.getWindow(),$E._document=$E.window.document,$E._window.addEventListener("message",function($I){laya.utils.Browser._onMessage($I)},!1),$E.document.__createElement=$E.document.createElement,$c.requestAnimationFrame=$c.requestAnimationFrame||$c.webkitRequestAnimationFrame||$c.mozRequestAnimationFrame||$c.oRequestAnimationFrame||$c.msRequestAnimationFrame||function($I){return $c.setTimeout($I,1e3/60)};var $I=$c.document.body.style;$I["-webkit-user-select"]="none",$I["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",$E.userAgent=$E.window.navigator.userAgent,$E.onIOS=!!($E.u=$E.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),$E.onMobile=-1<$E.u.indexOf("Mobile"),$E.onIPhone=-1<$E.u.indexOf("iPhone"),$E.onMac=-1<$E.u.indexOf("Mac OS X"),$E.onIPad=-1<$E.u.indexOf("iPad"),$E.onAndroid=-1<$E.u.indexOf("Android")||-1<$E.u.indexOf("Adr"),$E.onWP=-1<$E.u.indexOf("Windows Phone"),$E.onQQBrowser=-1<$E.u.indexOf("QQBrowser"),$E.onMQQBrowser=-1<$E.u.indexOf("MQQBrowser")||-1<$E.u.indexOf("Mobile")&&-1<$E.u.indexOf("QQ"),$E.onIE=!!$E.window.ActiveXObject||"ActiveXObject"in $E.window,$E.onWeiXin=-1<$E.u.indexOf("MicroMessenger"),$E.onPC=!$E.onMobile,$E.onSafari=-1<$E.u.indexOf("Safari"),$E.onFirefox=-1<$E.u.indexOf("Firefox"),$E.onEdge=-1<$E.u.indexOf("Edge"),$E.onMiniGame=-1<$E.u.indexOf("MiniGame"),$E.onLimixiu=-1<$E.u.indexOf("limixiu"),$E.httpProtocol="http:"==$E.window.location.protocol,$E.onMiniGame&&null==$E.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),$E.webAudioEnabled=!!($E.window.AudioContext||$E.window.webkitAudioContext||$E.window.mozAudioContext),$E.soundType=$E.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",$iI=$E.webAudioEnabled?$nI:$EI,$E.webAudioEnabled&&$nI.initWebAudio(),$EI._initMusicAudio(),$E.enableTouch="ontouchstart"in $c||$c.DocumentTouch&&$M instanceof DocumentTouch,$c.focus(),$v._soundClass=$iI,$v._musicClass=$EI,$o._mainCanvas=$o._mainCanvas||$$I.create("2D"),$E.canvas||($E.canvas=$$I.create("2D"),$E.context=$E.canvas.getContext("2d"))}},$E._onMessage=function($I){if($I.data&&"size"==$I.data.name){if($E.window.innerWidth=$I.data.width,$E.window.innerHeight=$I.data.height,$E.window.__innerHeight=$I.data.clientHeight,!$E.document.createEvent)return void console.warn("no document.createEvent");var $M=$E.document.createEvent("HTMLEvents");return $M.initEvent("resize",!1,!1),void $E.window.dispatchEvent($M)}},$E.createElement=function($I){return $E.__init__(),$E.document.__createElement($I)},$E.getElementById=function($I){return $E.__init__(),$E.document.getElementById($I)},$E.removeElement=function($I){$I&&$I.parentNode&&$I.parentNode.removeChild($I)},$E.now=function(){return $W.now()},$E._window=null,$E._document=null,$E._container=null,$E.userAgent=null,$E.u=null,$E.onIOS=!1,$E.onMac=!1,$E.onMobile=!1,$E.onIPhone=!1,$E.onIPad=!1,$E.onAndroid=!1,$E.onWP=!1,$E.onQQBrowser=!1,$E.onMQQBrowser=!1,$E.onSafari=!1,$E.onFirefox=!1,$E.onEdge=!1,$E.onIE=!1,$E.onWeiXin=!1,$E.onMiniGame=!1,$E.onLimixiu=!1,$E.onPC=!1,$E.httpProtocol=!1,$E.webAudioEnabled=!1,$E.soundType=null,$E.enableTouch=!1,$E.canvas=null,$E.context=null,$E.__init$=function(){},$E}()),$k=function(){function $M($I){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,$I?(this._u8d_=new Uint8Array($I),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}$V($M,"laya.utils.Byte");var $I=$M.prototype;return $I.___resizeBuffer=function($M){try{var $I=new Uint8Array($M);null!=this._u8d_&&(this._u8d_.length<=$M?$I.set(this._u8d_):$I.set(this._u8d_.subarray(0,$M))),this._u8d_=$I,this._d_=new DataView($I.buffer)}catch($I){throw"___resizeBuffer err:"+$M}},$I.getString=function(){return this.rUTF(this.getUint16())},$I.getFloat32Array=function($I,$M){var $E=$I+$M;$E=$E>this._length?this._length:$E;var $Z=new Float32Array(this._d_.buffer.slice($I,$E));return this._pos_=$E,$Z},$I.getUint8Array=function($I,$M){var $E=$I+$M;$E=$E>this._length?this._length:$E;var $Z=new Uint8Array(this._d_.buffer.slice($I,$E));return this._pos_=$E,$Z},$I.getInt16Array=function($I,$M){var $E=$I+$M;$E=$E>this._length?this._length:$E;var $Z=new Int16Array(this._d_.buffer.slice($I,$E));return this._pos_=$E,$Z},$I.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var $I=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,$I},$I.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var $I=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,$I},$I.writeFloat32=function($I){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,$I,this._xd_),this._pos_+=4},$I.writeFloat64=function($I){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,$I,this._xd_),this._pos_+=8},$I.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var $I=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,$I},$I.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var $I=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,$I},$I.writeInt32=function($I){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,$I,this._xd_),this._pos_+=4},$I.writeUint32=function($I){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,$I,this._xd_),this._pos_+=4},$I.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var $I=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,$I},$I.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var $I=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,$I},$I.writeUint16=function($I){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,$I,this._xd_),this._pos_+=2},$I.writeInt16=function($I){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,$I,this._xd_),this._pos_+=2},$I.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},$I.writeUint8=function($I){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,$I),this._pos_++},$I._getUInt8=function($I){return this._d_.getUint8($I)},$I._getUint16=function($I){return this._d_.getUint16($I,this._xd_)},$I._getMatrix=function(){return new $R(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},$I.rUTF=function($I){for(var $M=[],$E=this._pos_+$I,$Z=0,$i=0,$n=0,$c=String.fromCharCode,$f=this._u8d_;this._pos_<$E;)($Z=$f[this._pos_++])<128?0!=$Z&&$M.push($c($Z)):$Z<224?$M.push($c((63&$Z)<<6|127&$f[this._pos_++])):$Z<240?($i=$f[this._pos_++],$M.push($c((31&$Z)<<12|(127&$i)<<6|127&$f[this._pos_++]))):($i=$f[this._pos_++],$n=$f[this._pos_++],$M.push($c((15&$Z)<<18|(127&$i)<<12|$n<<6&127|127&$f[this._pos_++]))),0;return $M.join("")},$I.getCustomString=function($I){for(var $M=[],$E=0,$Z=0,$i=0,$n=String.fromCharCode,$c=this._u8d_;0<$I;)if(($Z=$c[this._pos_])<128)$M.push($n($Z)),this._pos_++,$I--;else for($E=$Z-128,this._pos_++,$I-=$E;0<$E;)$Z=$c[this._pos_++],$i=$c[this._pos_++],$M.push($n($i<<8|$Z)),$E--;return $M.join("")},$I.clear=function(){this._pos_=0,this.length=0},$I.__getBuffer=function(){return this._d_.buffer},$I.writeUTFBytes=function($I){for(var $M=0,$E=($I+="").length;$M<$E;$M++){var $Z=$I.charCodeAt($M);$Z<=127?this.writeByte($Z):$Z<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|$Z>>6,128|63&$Z],this._pos_),this._pos_+=2):$Z<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|$Z>>12,128|$Z>>6&63,128|63&$Z],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|$Z>>18,128|$Z>>12&63,128|$Z>>6&63,128|63&$Z],this._pos_),this._pos_+=4)}},$I.writeUTFString=function($I){var $M=this.pos;this.writeUint16(1),this.writeUTFBytes($I);var $E=this.pos-$M-2;if(65536<=$E)throw"writeUTFString byte len more than 65536";this._d_.setUint16($M,$E,this._xd_)},$I.readUTFString=function(){return this.readUTFBytes(this.getUint16())},$I.getUTFString=function(){return this.readUTFString()},$I.readUTFBytes=function($I){if(void 0===$I&&($I=-1),0==$I)return"";var $M=this.bytesAvailable;if($M<$I)throw"readUTFBytes error - Out of bounds";return $I=0<$I?$I:$M,this.rUTF($I)},$I.getUTFBytes=function($I){return void 0===$I&&($I=-1),this.readUTFBytes($I)},$I.writeByte=function($I){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,$I),this._pos_+=1},$I.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},$I.getByte=function(){return this.readByte()},$I.ensureWrite=function($I){this._length<$I&&(this._length=$I),this._allocated_<$I&&(this.length=$I)},$I.writeArrayBuffer=function($I,$M,$E){if(void 0===$M&&($M=0),void 0===$E&&($E=0),$M<0||$E<0)throw"writeArrayBuffer error - Out of bounds";0==$E&&($E=$I.byteLength-$M),this.ensureWrite(this._pos_+$E);var $Z=new Uint8Array($I);this._u8d_.set($Z.subarray($M,$M+$E),this._pos_),this._pos_+=$E},$B(0,$I,"buffer",function(){var $I=this._d_.buffer;return $I.byteLength==this.length?$I:$I.slice(0,this.length)}),$B(0,$I,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function($I){this._xd_="littleEndian"==$I}),$B(0,$I,"length",function(){return this._length},function($I){this._allocated_<$I?this.___resizeBuffer(this._allocated_=Math.floor(Math.max($I,2*this._allocated_))):this._allocated_>$I&&this.___resizeBuffer(this._allocated_=$I),this._length=$I}),$B(0,$I,"pos",function(){return this._pos_},function($I){this._pos_=$I}),$B(0,$I,"bytesAvailable",function(){return this._length-this._pos_}),$M.getSystemEndian=function(){if(!$M._sysEndian){var $I=new ArrayBuffer(2);new DataView($I).setInt16(0,256,!0),$M._sysEndian=256===new Int16Array($I)[0]?"littleEndian":"bigEndian"}return $M._sysEndian},$M.BIG_ENDIAN="bigEndian",$M.LITTLE_ENDIAN="littleEndian",$M._sysEndian=null,$M}(),$r=function(){function $i(){}return $V($i,"laya.utils.CacheManager"),$i.regCacheByFunction=function($I,$M){var $E;$i.unRegCacheByFunction($I,$M),$E={tryDispose:$I,getCacheList:$M},$i._cacheList.push($E)},$i.unRegCacheByFunction=function($I,$M){var $E,$Z=0;for($E=$i._cacheList.length,$Z=0;$Z<$E;$Z++)if($i._cacheList[$Z].tryDispose==$I&&$i._cacheList[$Z].getCacheList==$M)return void $i._cacheList.splice($Z,1)},$i.forceDispose=function(){var $I=0,$M=$i._cacheList.length;for($I=0;$I<$M;$I++)$i._cacheList[$I].tryDispose(!0)},$i.beginCheck=function($I){void 0===$I&&($I=15e3),$a.timer.loop($I,null,$i._checkLoop)},$i.stopCheck=function(){$a.timer.clear(null,$i._checkLoop)},$i._checkLoop=function(){var $I=$i._cacheList;if(!($I.length<1)){var $M,$E=$x.now(),$Z=0;for($M=$Z=$I.length;0<$Z&&($I[$i._index=++$i._index%$M].tryDispose(!1),!($x.now()-$E>$i.loopTimeLimit));)$Z--}},$i.loopTimeLimit=2,$i._cacheList=[],$i._index=0,$i}(),$l=function(){function $p(){}return $V($p,"laya.utils.ClassUtils"),$p.regClass=function($I,$M){$p._classMap[$I]=$M},$p.getRegClass=function($I){return $p._classMap[$I]},$p.getInstance=function($I){var $M=$p.getClass($I);return $M?new $M:(console.warn("[error] Undefined class:",$I),null)},$p.createByJson=function($I,$M,$E,$Z,$i){"string"==typeof $I&&($I=JSON.parse($I));var $n=$I.props;if(!$M&&!($M=$i?$i.runWith($I):$p.getInstance($n.runtime||$I.type)))return null;var $c=$I.child;if($c)for(var $f=0,$d=$c.length;$f<$d;$f++){var $H=$c[$f];if("render"!==$H.props.name&&"render"!==$H.props.renderType||!$M._$set_itemRender)if("Graphic"==$H.type)$p.addGraphicsToSprite($H,$M);else if($p.isDrawType($H.type))$p.addGraphicToSprite($H,$M,!0);else{var $B=$p.createByJson($H,null,$E,$Z,$i);"Script"==$H.type?$B.hasOwnProperty("owner")?$B.owner=$M:$B.hasOwnProperty("target")&&($B.target=$M):"mask"==$H.props.renderType?$M.mask=$B:$M.addChild($B)}else $M.itemRender=$H}if($n)for(var $A in $n){var $Q=$n[$A];"var"===$A&&$E?$E[$Q]=$M:$Q instanceof Array&&"function"==typeof $M[$A]?$M[$A].apply($M,$Q):$M[$A]=$Q}return $Z&&$I.customProps&&$Z.runWith([$M,$I]),$M.created&&$M.created(),$M},$p.addGraphicsToSprite=function($I,$M){var $E;if(($E=$I.child)&&!($E.length<1)){var $Z;$Z=$p._getGraphicsFromSprite($I,$M);var $i=0,$n=0;$I.props&&($i=$p._getObjVar($I.props,"x",0),$n=$p._getObjVar($I.props,"y",0)),0!=$i&&0!=$n&&$Z.translate($i,$n);var $c,$f=0;for($c=$E.length,$f=0;$f<$c;$f++)$p._addGraphicToGraphics($E[$f],$Z);0!=$i&&0!=$n&&$Z.translate(-$i,-$n)}},$p.addGraphicToSprite=function($I,$M,$E){var $Z;void 0===$E&&($E=!1),$Z=$E?$p._getGraphicsFromSprite($I,$M):$M.graphics,$p._addGraphicToGraphics($I,$Z)},$p._getGraphicsFromSprite=function($I,$M){var $E,$Z;if(!$I||!$I.props)return $M.graphics;switch($Z=$I.props.renderType){case"hit":case"unHit":var $i;$M.hitArea||($M.hitArea=new $h),($i=$M.hitArea)[$Z]||($i[$Z]=new $Q),$E=$i[$Z]}return $E||($E=$M.graphics),$E},$p._getTransformData=function($I){var $M;($I.hasOwnProperty("pivotX")||$I.hasOwnProperty("pivotY"))&&($M=$M||new $R).translate(-$p._getObjVar($I,"pivotX",0),-$p._getObjVar($I,"pivotY",0));var $E=$p._getObjVar($I,"scaleX",1),$Z=$p._getObjVar($I,"scaleY",1),$i=$p._getObjVar($I,"rotation",0);$p._getObjVar($I,"skewX",0),$p._getObjVar($I,"skewY",0);return 1==$E&&1==$Z&&0==$i||(($M=$M||new $R).scale($E,$Z),$M.rotate(.0174532922222222*$i)),$M},$p._addGraphicToGraphics=function($I,$M){var $E,$Z;if(($E=$I.props)&&($Z=$p.DrawTypeDic[$I.type])){var $i,$n;$i=$M;var $c=$p._getParams($E,$Z[1],$Z[2],$Z[3]);(($n=$p._tM)||1!=$p._alpha)&&($i.save(),$n&&$i.transform($n),1!=$p._alpha&&$i.alpha($p._alpha)),$i[$Z[0]].apply($i,$c),($n||1!=$p._alpha)&&$i.restore()}},$p._adptLineData=function($I){return $I[2]=parseFloat($I[0])+parseFloat($I[2]),$I[3]=parseFloat($I[1])+parseFloat($I[3]),$I},$p._adptTextureData=function($I){return $I[0]=$fI.getRes($I[0]),$I},$p._adptLinesData=function($I){return $I[2]=$p._getPointListByStr($I[2]),$I},$p.isDrawType=function($I){return"Image"!=$I&&$p.DrawTypeDic.hasOwnProperty($I)},$p._getParams=function($I,$M,$E,$Z){var $i;void 0===$E&&($E=0),($i=$p._temParam).length=$M.length;var $n,$c,$f=0;for($n=$M.length,$f=0;$f<$n;$f++)$i[$f]=$p._getObjVar($I,$M[$f][0],$M[$f][1]);return $p._alpha=$p._getObjVar($I,"alpha",1),$c=$p._getTransformData($I),$p._tM=$c?($E||($E=0),$c.translate($i[$E],$i[$E+1]),$i[$E]=$i[$E+1]=0,$c):null,$Z&&$p[$Z]&&($i=$p[$Z]($i)),$i},$p._getPointListByStr=function($I){var $M,$E,$Z=0;for($E=($M=$I.split(",")).length,$Z=0;$Z<$E;$Z++)$M[$Z]=parseFloat($M[$Z]);return $M},$p._getObjVar=function($I,$M,$E){return $I.hasOwnProperty($M)?$I[$M]:$E},$p._temParam=[],$p._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},$p.getClass=function($I){var $M=$p._classMap[$I]||$I;return"string"==typeof $M?$a.__classmap[$M]:$M},$p._tM=null,$p._alpha=NaN,$d($p,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),$p}(),$F=function(){function $n($I){if(this._color=[],"string"==typeof $I){null===(this.strColor=$I)&&($I="#000000"),"#"==$I.charAt(0)&&($I=$I.substr(1));var $M=$I.length;if(3==$M||4==$M){for(var $E="",$Z=0;$Z<$M;$Z++)$E+=$I[$Z]+$I[$Z];$I=$E}var $i=this.numColor=parseInt($I,16);if(8==$I.length)return void(this._color=[parseInt($I.substr(0,2),16)/255,((16711680&$i)>>16)/255,((65280&$i)>>8)/255,(255&$i)/255])}else $i=this.numColor=$I,this.strColor=$K.toHexColor($i);this._color=[((16711680&$i)>>16)/255,((65280&$i)>>8)/255,(255&$i)/255,1],this._color.__id=++$n._COLODID}return $V($n,"laya.utils.Color"),$n._initDefault=function(){for(var $I in $n._DEFAULT={},$n._COLOR_MAP)$n._SAVE[$I]=$n._DEFAULT[$I]=new $n($n._COLOR_MAP[$I]);return $n._DEFAULT},$n._initSaveMap=function(){for(var $I in $n._SAVE_SIZE=0,$n._SAVE={},$n._DEFAULT)$n._SAVE[$I]=$n._DEFAULT[$I]},$n.create=function($I){var $M=$n._SAVE[$I+""];return null!=$M?$M:($n._SAVE_SIZE<1e3||$n._initSaveMap(),$n._SAVE[$I+""]=new $n($I))},$n._SAVE={},$n._SAVE_SIZE=0,$n._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},$n._DEFAULT=$n._initDefault(),$n._COLODID=1,$n}(),$e=(function(){function $I(){this._values=[],this._keys=[]}$V($I,"laya.utils.Dictionary");var $M=$I.prototype;$M.set=function($I,$M){var $E=this.indexOf($I);0<=$E?this._values[$E]=$M:(this._keys.push($I),this._values.push($M))},$M.indexOf=function($I){var $M=this._keys.indexOf($I);return 0<=$M?$M:($I="string"==typeof $I?Number($I):"number"==typeof $I?$I.toString():$I,this._keys.indexOf($I))},$M.get=function($I){var $M=this.indexOf($I);return $M<0?null:this._values[$M]},$M.remove=function($I){var $M=this.indexOf($I);return 0<=$M&&(this._keys.splice($M,1),this._values.splice($M,1),!0)},$M.clear=function(){this._values.length=0,this._keys.length=0},$B(0,$M,"values",function(){return this._values}),$B(0,$M,"keys",function(){return this._keys})}(),function(){function $I(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}$V($I,"laya.utils.Dragging");var $M=$I.prototype;return $M.start=function($I,$M,$E,$Z,$i,$n,$c,$f){void 0===$f&&($f=.92),this.clearTimer(),this.target=$I,this.area=$M,this.hasInertia=$E,this.elasticDistance=$M?$Z:0,this.elasticBackTime=$i,this.data=$n,this._disableMouseEvent=$c,this.ratio=$f,1!=$I.globalScaleX||1!=$I.globalScaleY?this._parent=$I.parent:this._parent=$a.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,$a.stage.on("mouseup",this,this.onStageMouseUp),$a.stage.on("mouseout",this,this.onStageMouseUp),$a.timer.frameLoop(1,this,this.loop)},$M.clearTimer=function(){$a.timer.clear(this,this.loop),$a.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},$M.stop=function(){this._dragging&&($t.instance.disableMouseEvent=!1,$a.stage.off("mouseup",this,this.onStageMouseUp),$a.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},$M.loop=function(){var $I=this._parent.getMousePoint(),$M=$I.x,$E=$I.y,$Z=$M-this._lastX,$i=$E-this._lastY;if(this._clickOnly){if(!(1<Math.abs($Z*$a.stage._canvasTransform.getScaleX())||1<Math.abs($i*$a.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),$t.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push($Z,$i);0==$Z&&0==$i||(this._lastX=$M,this._lastY=$E,this.target.x+=$Z*this._elasticRateX,this.target.y+=$i*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},$M.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var $I=this.area.x-this.target.x;else $I=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-$I/this.elasticDistance),this.target.y<this.area.y)var $M=this.area.y-this.target.y;else $M=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-$M/this.elasticDistance)}},$M.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},$M.onStageMouseUp=function($I){if($t.instance.disableMouseEvent=!1,$a.stage.off("mouseup",this,this.onStageMouseUp),$a.stage.off("mouseout",this,this.onStageMouseUp),$a.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var $M=this._offsets.length,$E=Math.min($M,6),$Z=this._offsets.length-$E,$i=$M-1;$Z<$i;$i--)this._offsetY+=this._offsets[$i--],this._offsetX+=this._offsets[$i];this._offsetX=this._offsetX/$E*2,this._offsetY=this._offsetY/$E*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),$a.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},$M.checkElastic=function(){var $I=NaN,$M=NaN;if(this.target.x<this.area.x?$I=this.area.x:this.target.x>this.area.x+this.area.width&&($I=this.area.x+this.area.width),this.target.y<this.area.y?$M=this.area.y:this.target.y>this.area.y+this.area.height&&($M=this.area.y+this.area.height),isNaN($I)&&isNaN($M))this.clear();else{var $E={};isNaN($I)||($E.x=$I),isNaN($M)||($E.y=$M),this._tween=$Y.to(this.target,$E,this.elasticBackTime,$_.sineOut,$y.create(this,this.clear),0,!1,!1)}},$M.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&($a.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},$M.clear=function(){if(this.target){this.clearTimer();var $I=this.target;this.target=null,this._parent=null,$I.event("dragend",this.data)}},$I}()),$_=function(){function $f(){}return $V($f,"laya.utils.Ease"),$f.linearNone=function($I,$M,$E,$Z){return $E*$I/$Z+$M},$f.linearIn=function($I,$M,$E,$Z){return $E*$I/$Z+$M},$f.linearInOut=function($I,$M,$E,$Z){return $E*$I/$Z+$M},$f.linearOut=function($I,$M,$E,$Z){return $E*$I/$Z+$M},$f.bounceIn=function($I,$M,$E,$Z){return $E-$f.bounceOut($Z-$I,0,$E,$Z)+$M},$f.bounceInOut=function($I,$M,$E,$Z){return $I<.5*$Z?.5*$f.bounceIn(2*$I,0,$E,$Z)+$M:.5*$f.bounceOut(2*$I-$Z,0,$E,$Z)+.5*$E+$M},$f.bounceOut=function($I,$M,$E,$Z){return($I/=$Z)<1/2.75?$E*(7.5625*$I*$I)+$M:$I<2/2.75?$E*(7.5625*($I-=1.5/2.75)*$I+.75)+$M:$I<2.5/2.75?$E*(7.5625*($I-=2.25/2.75)*$I+.9375)+$M:$E*(7.5625*($I-=2.625/2.75)*$I+.984375)+$M},$f.backIn=function($I,$M,$E,$Z,$i){return void 0===$i&&($i=1.70158),$E*($I/=$Z)*$I*(($i+1)*$I-$i)+$M},$f.backInOut=function($I,$M,$E,$Z,$i){return void 0===$i&&($i=1.70158),($I/=.5*$Z)<1?.5*$E*($I*$I*((1+($i*=1.525))*$I-$i))+$M:$E/2*(($I-=2)*$I*((1+($i*=1.525))*$I+$i)+2)+$M},$f.backOut=function($I,$M,$E,$Z,$i){return void 0===$i&&($i=1.70158),$E*(($I=$I/$Z-1)*$I*(($i+1)*$I+$i)+1)+$M},$f.elasticIn=function($I,$M,$E,$Z,$i,$n){var $c;return void 0===$i&&($i=0),void 0===$n&&($n=0),0==$I?$M:1==($I/=$Z)?$M+$E:($n||($n=.3*$Z),$c=!$i||0<$E&&$i<$E||$E<0&&$i<-$E?($i=$E,$n/4):$n/$f.PI2*Math.asin($E/$i),-$i*Math.pow(2,10*($I-=1))*Math.sin(($I*$Z-$c)*$f.PI2/$n)+$M)},$f.elasticInOut=function($I,$M,$E,$Z,$i,$n){var $c;return void 0===$i&&($i=0),void 0===$n&&($n=0),0==$I?$M:2==($I/=.5*$Z)?$M+$E:($n||($n=$Z*(.3*1.5)),$c=!$i||0<$E&&$i<$E||$E<0&&$i<-$E?($i=$E,$n/4):$n/$f.PI2*Math.asin($E/$i),$I<1?$i*Math.pow(2,10*($I-=1))*Math.sin(($I*$Z-$c)*$f.PI2/$n)*-.5+$M:$i*Math.pow(2,-10*($I-=1))*Math.sin(($I*$Z-$c)*$f.PI2/$n)*.5+$E+$M)},$f.elasticOut=function($I,$M,$E,$Z,$i,$n){var $c;return void 0===$i&&($i=0),void 0===$n&&($n=0),0==$I?$M:1==($I/=$Z)?$M+$E:($n||($n=.3*$Z),$c=!$i||0<$E&&$i<$E||$E<0&&$i<-$E?($i=$E,$n/4):$n/$f.PI2*Math.asin($E/$i),$i*Math.pow(2,-10*$I)*Math.sin(($I*$Z-$c)*$f.PI2/$n)+$E+$M)},$f.strongIn=function($I,$M,$E,$Z){return $E*($I/=$Z)*$I*$I*$I*$I+$M},$f.strongInOut=function($I,$M,$E,$Z){return($I/=.5*$Z)<1?.5*$E*$I*$I*$I*$I*$I+$M:.5*$E*(($I-=2)*$I*$I*$I*$I+2)+$M},$f.strongOut=function($I,$M,$E,$Z){return $E*(($I=$I/$Z-1)*$I*$I*$I*$I+1)+$M},$f.sineInOut=function($I,$M,$E,$Z){return.5*-$E*(Math.cos(Math.PI*$I/$Z)-1)+$M},$f.sineIn=function($I,$M,$E,$Z){return-$E*Math.cos($I/$Z*$f.HALF_PI)+$E+$M},$f.sineOut=function($I,$M,$E,$Z){return $E*Math.sin($I/$Z*$f.HALF_PI)+$M},$f.quintIn=function($I,$M,$E,$Z){return $E*($I/=$Z)*$I*$I*$I*$I+$M},$f.quintInOut=function($I,$M,$E,$Z){return($I/=.5*$Z)<1?.5*$E*$I*$I*$I*$I*$I+$M:.5*$E*(($I-=2)*$I*$I*$I*$I+2)+$M},$f.quintOut=function($I,$M,$E,$Z){return $E*(($I=$I/$Z-1)*$I*$I*$I*$I+1)+$M},$f.quartIn=function($I,$M,$E,$Z){return $E*($I/=$Z)*$I*$I*$I+$M},$f.quartInOut=function($I,$M,$E,$Z){return($I/=.5*$Z)<1?.5*$E*$I*$I*$I*$I+$M:.5*-$E*(($I-=2)*$I*$I*$I-2)+$M},$f.quartOut=function($I,$M,$E,$Z){return-$E*(($I=$I/$Z-1)*$I*$I*$I-1)+$M},$f.cubicIn=function($I,$M,$E,$Z){return $E*($I/=$Z)*$I*$I+$M},$f.cubicInOut=function($I,$M,$E,$Z){return($I/=.5*$Z)<1?.5*$E*$I*$I*$I+$M:.5*$E*(($I-=2)*$I*$I+2)+$M},$f.cubicOut=function($I,$M,$E,$Z){return $E*(($I=$I/$Z-1)*$I*$I+1)+$M},$f.quadIn=function($I,$M,$E,$Z){return $E*($I/=$Z)*$I+$M},$f.quadInOut=function($I,$M,$E,$Z){return($I/=.5*$Z)<1?.5*$E*$I*$I+$M:.5*-$E*(--$I*($I-2)-1)+$M},$f.quadOut=function($I,$M,$E,$Z){return-$E*($I/=$Z)*($I-2)+$M},$f.expoIn=function($I,$M,$E,$Z){return 0==$I?$M:$E*Math.pow(2,10*($I/$Z-1))+$M-.001*$E},$f.expoInOut=function($I,$M,$E,$Z){return 0==$I?$M:$I==$Z?$M+$E:($I/=.5*$Z)<1?.5*$E*Math.pow(2,10*($I-1))+$M:.5*$E*(2-Math.pow(2,-10*--$I))+$M},$f.expoOut=function($I,$M,$E,$Z){return $I==$Z?$M+$E:$E*(1-Math.pow(2,-10*$I/$Z))+$M},$f.circIn=function($I,$M,$E,$Z){return-$E*(Math.sqrt(1-($I/=$Z)*$I)-1)+$M},$f.circInOut=function($I,$M,$E,$Z){return($I/=.5*$Z)<1?.5*-$E*(Math.sqrt(1-$I*$I)-1)+$M:.5*$E*(Math.sqrt(1-($I-=2)*$I)+1)+$M},$f.circOut=function($I,$M,$E,$Z){return $E*Math.sqrt(1-($I=$I/$Z-1)*$I)+$M},$f.HALF_PI=.5*Math.PI,$f.PI2=2*Math.PI,$f}(),$h=function(){function $A(){this._hit=null,this._unHit=null}$V($A,"laya.utils.HitArea");var $I=$A.prototype;return $I.isHit=function($I,$M){return!!$A.isHitGraphic($I,$M,this.hit)&&!$A.isHitGraphic($I,$M,this.unHit)},$I.contains=function($I,$M){return this.isHit($I,$M)},$B(0,$I,"hit",function(){return this._hit||(this._hit=new $Q),this._hit},function($I){this._hit=$I}),$B(0,$I,"unHit",function(){return this._unHit||(this._unHit=new $Q),this._unHit},function($I){this._unHit=$I}),$A.isHitGraphic=function($I,$M,$E){if(!$E)return!1;var $Z;if(!($Z=$E.cmds)&&$E._one&&(($Z=$A._cmds).length=1,$Z[0]=$E._one),!$Z)return!1;var $i,$n,$c=0;for($i=$Z.length,$c=0;$c<$i;$c++)if($n=$Z[$c]){var $f=$o._context;switch($n.callee){case $f._translate:case 6:$I-=$n[0],$M-=$n[1]}if($A.isHitCmd($I,$M,$n))return!0}return!1},$A.isHitCmd=function($I,$M,$E){if(!$E)return!1;var $Z=$o._context,$i=!1;switch($E.callee){case $Z._drawRect:case 13:$A._rec.setTo($E[0],$E[1],$E[2],$E[3]),$i=$A._rec.contains($I,$M);break;case $Z._drawCircle:case $Z._fillCircle:case 14:$i=($I-=$E[0])*$I+($M-=$E[1])*$M<$E[2]*$E[2];break;case $Z._drawPoly:case 18:$I-=$E[0],$M-=$E[1],$i=$A.ptInPolygon($I,$M,$E[2])}return $i},$A.ptInPolygon=function($I,$M,$E){var $Z;($Z=$A._ptPoint).setTo($I,$M);var $i,$n=0,$c=NaN,$f=NaN,$d=NaN,$H=NaN;$i=$E.length;for(var $B=0;$B<$i;$B+=2){if($c=$E[$B],$f=$E[$B+1],$d=$E[($B+2)%$i],$f!=($H=$E[($B+3)%$i]))if(!($Z.y<Math.min($f,$H)))if(!($Z.y>=Math.max($f,$H)))($Z.y-$f)*($d-$c)/($H-$f)+$c>$Z.x&&$n++}return $n%2==1},$A._cmds=[],$d($A,["_rec",function(){return this._rec=new $j},"_ptPoint",function(){return this._ptPoint=new $m}]),$A}(),$P=(function(){function $i($I,$M,$E,$Z){this.char=$I,this.charNum=$I.charCodeAt(0),this._x=this._y=0,this.width=$M,this.height=$E,this.style=$Z,this.isWord=!$i._isWordRegExp.test($I)}$V($i,"laya.utils.HTMLChar");var $I=$i.prototype;$a.imps($I,{"laya.display.ILayout":!0}),$I.setSprite=function($I){this._sprite=$I},$I.getSprite=function(){return this._sprite},$I._isChar=function(){return!0},$I._getCSSStyle=function(){return this.style},$B(0,$I,"width",function(){return this._w},function($I){this._w=$I}),$B(0,$I,"x",function(){return this._x},function($I){this._sprite&&(this._sprite.x=$I),this._x=$I}),$B(0,$I,"y",function(){return this._y},function($I){this._sprite&&(this._sprite.y=$I),this._y=$I}),$B(0,$I,"height",function(){return this._h},function($I){this._h=$I}),$i._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function $M(){}$V($M,"laya.utils.Log"),$M.enable=function(){$M._logdiv||($M._logdiv=$x.window.document.createElement("div"),$x.window.document.body.appendChild($M._logdiv),$M._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},$M.toggle=function(){var $I=$M._logdiv.style;"1px"==$I.width?$I.width=$I.height="50%":$I.width=$I.height="1px"},$M.print=function($I){$M._logdiv&&($M.maxCount<=$M._count&&$M.clear(),$M._count++,$M._logdiv.innerText+=$I+"\n",$M._logdiv.scrollTop=$M._logdiv.scrollHeight)},$M.clear=function(){$M._logdiv.innerText="",$M._count=0},$M._logdiv=null,$M._count=0,$M.maxCount=20}(),function(){function $M(){}$V($M,"laya.utils.Mouse"),$B(1,$M,"cursor",function(){return $M._style.cursor},function($I){$M._style.cursor=$I}),$M.hide=function(){"none"!=$M.cursor&&($M._preCursor=$M.cursor,$M.cursor="none")},$M.show=function(){"none"==$M.cursor&&($M.cursor=$M._preCursor?$M._preCursor:"auto")},$M._preCursor=null,$d($M,["_style",function(){return this._style=$x.document.body.style}])}(),function(){function $n(){}return $V($n,"laya.utils.Pool"),$n.getPoolBySign=function($I){return $n._poolDic[$I]||($n._poolDic[$I]=[])},$n.clearBySign=function($I){$n._poolDic[$I]&&($n._poolDic[$I].length=0)},$n.recover=function($I,$M){$M.__InPool||($M.__InPool=!0,$n.getPoolBySign($I).push($M))},$n.getItemByClass=function($I,$M){var $E=$n.getPoolBySign($I),$Z=$E.length?$E.pop():new $M;return $Z.__InPool=!1,$Z},$n.getItemByCreateFun=function($I,$M,$E){var $Z=$n.getPoolBySign($I),$i=$Z.length?$Z.pop():$M.call($E);return $i.__InPool=!1,$i},$n.getItem=function($I){var $M=$n.getPoolBySign($I),$E=$M.length?$M.pop():null;return $E&&($E.__InPool=!1),$E},$n._poolDic={},$n.InPoolSign="__InPool",$n}()),$D=function(){function $d(){}return $V($d,"laya.utils.Stat"),$B(1,$d,"onclick",null,function($I){$d._sp&&$d._sp.on("click",$d._sp,$I),$d._canvas&&($d._canvas.source.onclick=$I,$d._canvas.source.style.pointerEvents="")}),$d.show=function($I,$M,$E){if(void 0===$I&&($I=0),void 0===$M&&($M=0),void 0===$E&&($E=0),!$o.isConchApp||$o.isConchWebGL){if($o.isConchWebGL||$x.onMiniGame||$x.onLimixiu||($d._useCanvas=!0),$d._show=!0,$d._fpsData.length=60,$d._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},$d._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},$d._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},$d._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},$o.isWebGL)if($d._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},$o.is3DMode){if($d._view[0].title="FPS(3D)",$d._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},$d._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},$d._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==$E){var $Z=8;$d._view[$Z++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},$d._view[$Z++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$d._view[$Z++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},$d._view[$Z++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$d._view[$Z++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$d._view[$Z++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},$d._view[$Z++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},$d._view[$Z++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},$d._view[$Z++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==$E){$Z=8;$d._view[$Z++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},$d._view[$Z++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},$d._view[$Z++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},$d._view[$Z++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},$d._view[$Z++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},$d._view[$Z++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},$d._view[$Z++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else $d._view[0].title="FPS(WebGL)",$d._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else $d._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};$d._useCanvas?$d.createUIPre($I,$M):$d.createUI($I,$M),$d.enable()}else $x.window.conch.showFPS&&$x.window.conch.showFPS($I,$M)},$d.createUIPre=function($I,$M){var $E=$x.pixelRatio;$d._width=170*$E,$d._vx=75*$E,$d._height=$E*(12*$d._view.length+3*$E)+4,$d._fontSize=12*$E;for(var $Z=0;$Z<$d._view.length;$Z++)$d._view[$Z].x=4,$d._view[$Z].y=$Z*$d._fontSize+2*$E;$d._canvas||(($d._canvas=new $$I("2D")).size($d._width,$d._height),($d._ctx=$d._canvas.getContext("2d")).textBaseline="top",$d._ctx.font=$d._fontSize+"px Sans-serif",$d._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+$I+"px;top:"+$M+"px;width:"+$d._width/$E+"px;height:"+$d._height/$E+"px;"),$d._first=!0,$d.loop(),$d._first=!1,$x.container.appendChild($d._canvas.source)},$d.createUI=function($I,$M){var $E=$d._sp,$Z=$x.pixelRatio;$E||($E=new $AI,($d._leftText=new $uI).pos(5,5),$d._leftText.color="#ffffff",$E.addChild($d._leftText),($d._txt=new $uI).pos(80*$Z,5),$d._txt.color="#ffffff",$E.addChild($d._txt),$d._sp=$E),$E.pos($I,$M);for(var $i="",$n=0;$n<$d._view.length;$n++){$i+=$d._view[$n].title+"\n"}$d._leftText.text=$i;var $c=170*$Z,$f=$Z*(12*$d._view.length+3*$Z)+4;$d._txt.fontSize=$d._fontSize*$Z,$d._leftText.fontSize=$d._fontSize*$Z,$E.size($c,$f),$E.graphics.clear(),$E.graphics.setAlpha(.5),$E.graphics.drawRect(0,0,$c,$f,"#999999"),$E.graphics.setAlpha(1),$d.loop()},$d.enable=function(){$a.timer.frameLoop(1,$d,$d.loop)},$d.hide=function(){$d._show=!1,$a.timer.clear($d,$d.loop),$d._canvas&&$x.removeElement($d._canvas.source)},$d.clear=function(){$d.trianglesFaces=$d.drawCall=$d.shaderCall=$d.spriteCount=$d.spriteRenderUseCacheCount=$d.treeNodeCollision=$d.treeSpriteCollision=$d.canvasNormal=$d.canvasBitmap=$d.canvasReCache=0},$d.loop=function(){$d._count++;var $I=$x.now();if(!($I-$d._timer<1e3)){var $M=$d._count;if($d.FPS=Math.round(1e3*$M/($I-$d._timer)),$d._show){$d.trianglesFaces=Math.round($d.trianglesFaces/$M),$d.spriteCount=$d._useCanvas?($d.drawCall=Math.round($d.drawCall/$M)-2,$d.shaderCall=Math.round($d.shaderCall/$M),Math.round($d.spriteCount/$M)-1):($d.drawCall=Math.round($d.drawCall/$M)-2,$d.shaderCall=Math.round($d.shaderCall/$M)-4,Math.round($d.spriteCount/$M)-4),$d.spriteRenderUseCacheCount=Math.round($d.spriteRenderUseCacheCount/$M),$d.canvasNormal=Math.round($d.canvasNormal/$M),$d.canvasBitmap=Math.round($d.canvasBitmap/$M),$d.canvasReCache=Math.ceil($d.canvasReCache/$M),$d.treeNodeCollision=Math.round($d.treeNodeCollision/$M),$d.treeSpriteCollision=Math.round($d.treeSpriteCollision/$M);var $E=0<$d.FPS?Math.floor(1e3/$d.FPS).toString():" ";$d._fpsStr=$d.FPS+($d.renderSlow?" slow":"")+" "+$E,$d._spriteStr=$d.spriteCount+($d.spriteRenderUseCacheCount?"/"+$d.spriteRenderUseCacheCount:""),$d._canvasStr=$d.canvasReCache+"/"+$d.canvasNormal+"/"+$d.canvasBitmap,$d.currentMemorySize=$J.systemResourceManager.memorySize,$d._useCanvas?$d.renderInfoPre():$d.renderInfo(),$d.clear()}$d._count=0,$d._timer=$I}},$d.renderInfoPre=function(){if($d._canvas){var $I=$d._ctx;$I.clearRect($d._first?0:$d._vx,0,$d._width,$d._height);for(var $M=$o.WebGL.mainContext,$E=0;$E<$d._view.length;$E++){var $Z=$d._view[$E];$d._first&&($I.fillStyle="white",$I.fillText($Z.title,$Z.x,$Z.y,null,null,null)),$I.fillStyle=$Z.color;var $i=-1;if(($Z=$d._view[$E]).varying){if($M)switch($Z.varying){case 1:$i=$M.getParameter($M[$Z.value]);break;case 2:$i=$M.getExtension($Z.value)}}else $i=$d[$Z.value];"M"==$Z.units&&($i=Math.floor($i/1048576*100)/100+" M"),"K"==$Z.units&&($i=Math.floor($i/1024*100)/100+" K"),"string"==$Z.units&&($i=$i.match(/\d+\.?\d/i)),$I.fillText($i+"",$Z.x+$d._vx,$Z.y,null,null,null)}}},$d.renderInfo=function(){for(var $I="",$M=$o.WebGL.mainContext,$E=0;$E<$d._view.length;$E++){var $Z=$d._view[$E],$i=-1;if($Z.varying){if($M)switch($Z.varying){case 1:$i=$M.getParameter($M[$Z.value]);break;case 2:$i=$M.getExtension($Z.value)}}else $i=$d[$Z.value];"M"==$Z.units&&($i=Math.floor($i/1048576*100)/100+" M"),"K"==$Z.units&&($i=Math.floor($i/1024*100)/100+" K"),"string"==$Z.units&&($i=$i.match(/\d+\.?\d/i)),$I+=$i+"\n"}$d._txt.text=$I},$d.FPS=0,$d.loopCount=0,$d.shaderCall=0,$d.drawCall=0,$d.trianglesFaces=0,$d.spriteCount=0,$d.spriteRenderUseCacheCount=0,$d.treeNodeCollision=0,$d.treeSpriteCollision=0,$d.canvasNormal=0,$d.canvasBitmap=0,$d.canvasReCache=0,$d.renderSlow=!1,$d.currentMemorySize=0,$d._fpsStr=null,$d._canvasStr=null,$d._spriteStr=null,$d._fpsData=[],$d._timer=0,$d._count=0,$d._view=[],$d._fontSize=12,$d._txt=null,$d._leftText=null,$d._sp=null,$d._show=!1,$d._useCanvas=!1,$d._canvas=null,$d._ctx=null,$d._first=!1,$d._vx=NaN,$d._width=0,$d._height=100,$d}(),$G=(function(){function $I(){this._strsToID={},this._idToStrs=[],this._length=0}$V($I,"laya.utils.StringKey");var $M=$I.prototype;$M.add=function($I){var $M=this._strsToID[$I];return null!=$M?$M:(this._idToStrs[this._length]=$I,this._strsToID[$I]=this._length++)},$M.getID=function($I){var $M=this._strsToID[$I];return null==$M?-1:$M},$M.getName=function($I){var $M=this._idToStrs[$I];return null==$M?void 0:$M}}(),function(){var $H;function $I(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}$V($I,"laya.utils.Timer");var $M=$I.prototype;return $M._init=function(){$a.timer&&$a.timer.frameLoop(1,this,this._update)},$M._now=function(){return Date.now()},$M._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var $I=this.currFrame=this.currFrame+this.scale,$M=this._now();this._delta=($M-this._lastTimer)*this.scale;var $E=this.currTimer=this.currTimer+this._delta;$a.isDebug&&6e4<Math.abs($M-this._lastTimer)&&console.error("系统时间错误！"+($M-this._lastTimer)),this._lastTimer=$M;var $Z=this._handlers;for($c=this._count=0,$f=$Z.length;$c<$f;$c++)if(null!==($d=$Z[$c]).method){var $i=$d.userFrame?$I:$E;if($i>=$d.exeTime)if($d.repeat)if($d.jumpFrame)for(;$i>=$d.exeTime;)$d.exeTime+=$d.delay,$d.run(!1);else $d.exeTime+=$d.delay,$d.run(!1),$i>$d.exeTime&&($d.exeTime+=Math.ceil(($i-$d.exeTime)/$d.delay)*$d.delay);else $d.run(!0)}else this._count++;(30<this._count||$I%200==0)&&this._clearHandlers();for(var $n=this._laters,$c=0,$f=$n.length-1;$c<=$f;$c++){var $d=$n[$c];this._isIgnoreRecover($d)||(null!==$d.method&&(delete this._map[$d.key],$d.run(!1)),this._recoverHandler($d)),$c===$f&&($f=$n.length-1)}$n.length=0}},$M._clearHandlers=function(){for(var $I=this._handlers,$M=0,$E=$I.length;$M<$E;$M++){var $Z=$I[$M];null!==$Z.method?this._temp.push($Z):this._isIgnoreRecover($Z)?this._temp.push($Z):this._recoverHandler($Z)}this._handlers=this._temp,this._temp=$I,this._temp.length=0},$M._recoverHandler=function($I){this._map[$I.key]==$I&&delete this._map[$I.key],$I.recover()},$M._create=function($I,$M,$E,$Z,$i,$n,$c,$f){if(!$E)return $i.apply($Z,$n),null;if($c){var $d=this._getHandler($Z,$i);if($d)return $d.repeat=$M,$d.userFrame=$I,$d.delay=$E,$d.ignoreRecover=$f,$d.caller=$Z,$d.method=$i,$d.args=$n,$d.exeTime=$E+($I?this.currFrame:this.currTimer+this._now()-this._lastTimer),$d}return($d=$H.create()).repeat=$M,$d.userFrame=$I,$d.delay=$E,$d.ignoreRecover=$f,$d.caller=$Z,$d.method=$i,$d.args=$n,$d.exeTime=$E+($I?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler($d),this._handlers.push($d),$d},$M._indexHandler=function($I){var $M=$I.caller,$E=$I.method,$Z=$M?$M.$_GID||($M.$_GID=$K.getGID()):0,$i=$E.$_TID||($E.$_TID=this._mid++);$I.key=$Z+"_"+$i,this._map[$I.key]=$I},$M.once=function($I,$M,$E,$Z,$i){void 0===$i&&($i=!0),this._create(!1,!1,$I,$M,$E,$Z,$i,!1)},$M.loop=function($I,$M,$E,$Z,$i,$n,$c){void 0===$i&&($i=!0),void 0===$n&&($n=!1),void 0===$c&&($c=!1);var $f=this._create(!1,!0,$I,$M,$E,$Z,$i,$c);$f&&($f.jumpFrame=$n)},$M.frameOnce=function($I,$M,$E,$Z,$i){void 0===$i&&($i=!0),this._create(!0,!1,$I,$M,$E,$Z,$i,!1)},$M.frameLoop=function($I,$M,$E,$Z,$i,$n){void 0===$i&&($i=!0),void 0===$n&&($n=!1),this._create(!0,!0,$I,$M,$E,$Z,$i,$n)},$M.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+$H._freeCount},$M.clear=function($I,$M){var $E=this._getHandler($I,$M);return!(!$E||this._isIgnoreRecover($E))&&(delete this._map[$E.key],$E.key=null,$E.clear(),!0)},$M.clearAll=function($I){if($I)for(var $M=0,$E=this._handlers.length;$M<$E;$M++){var $Z=this._handlers[$M];$Z.caller===$I&&(this._isIgnoreRecover($Z)||(delete this._map[$Z.key],$Z.key=null,$Z.clear()))}},$M._getHandler=function($I,$M){var $E=$I?$I.$_GID||($I.$_GID=$K.getGID()):0,$Z=$M.$_TID||($M.$_TID=this._mid++);return this._map[$E+"_"+$Z]},$M._isIgnoreRecover=function($I){if($I.ignoreRecover||$I.caller&&"IgnoreRecover"==$I.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var $M="";try{arguments.propertyIsEnumerable.caller}catch($I){$M=$I.stack}$a.recordError("报错：核心定时器销毁忽略  "+$M)}return!0}return!1},$M.hasHandler=function($I,$M){return this._map[$I.$_GID+"_"+$M.$_TID]},$M.callLater=function($I,$M,$E){if(null==this._getHandler($I,$M)){var $Z=$H.create();$Z.caller=$I,$Z.method=$M,$Z.args=$E,this._indexHandler($Z),this._laters.push($Z)}},$M.runCallLater=function($I,$M){var $E=this._getHandler($I,$M);$E&&null!=$E.method&&(this._isIgnoreRecover($E)||(delete this._map[$E.key],$E.run(!0)))},$M.runTimer=function($I,$M){this.runCallLater($I,$M)},$B(0,$M,"delta",function(){return this._delta}),$I.__init$=function(){$H=function(){function $M(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}$V($M,"");var $I=$M.prototype;return $I.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},$I.recover=function(){this.clear(),this.args=$M._freeHandler,$M._freeHandler=this,$M._freeCount++},$I.run=function($I){var $M=this.caller;if($M&&$M.destroyed)return this.clear();var $E=this.method,$Z=this.args;$I&&this.clear(),null!=$E&&($Z?$E.apply($M,$Z):$E.call($M))},$M._freeHandler=null,$M._freeCount=0,$M.create=function(){var $I=$M._freeHandler;return $I?($M._freeHandler=$I.args,--$M._freeCount,$I.args=null,$I):new $M},$M}()},$I}()),$Y=function(){function $A(){this.gid=0}$V($A,"laya.utils.Tween");var $I=$A.prototype;return $I.to=function($I,$M,$E,$Z,$i,$n,$c){return void 0===$n&&($n=0),void 0===$c&&($c=!1),this._create($I,$M,$E,$Z,$i,$n,$c,!0,!1,!0)},$I.from=function($I,$M,$E,$Z,$i,$n,$c){return void 0===$n&&($n=0),void 0===$c&&($c=!1),this._create($I,$M,$E,$Z,$i,$n,$c,!1,!1,!0)},$I._create=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){if(!$I)throw new Error("Tween:target is null");this._target=$I,this._duration=$E,this._ease=$Z||$M.ease||$A.easeNone,this._complete=$i||$M.complete,this._delay=$n,this._props=[],this._usedTimer=0,this._startTimer=$x.now(),this._usedPool=$d,this._delayParam=null,this.update=$M.update;var $B=$I.$_GID||($I.$_GID=$K.getGID());return $A.tweenMap[$B]?($c&&$A.clearTween($I),$A.tweenMap[$B].push(this)):$A.tweenMap[$B]=[this],$H?$n<=0?this.firstStart($I,$M,$f):(this._delayParam=[$I,$M,$f],$a.scaleTimer.once($n,this,this.firstStart,this._delayParam)):this._initProps($I,$M,$f),this},$I.firstStart=function($I,$M,$E){this._delayParam=null,$I.destroyed?this.clear():(this._initProps($I,$M,$E),this._beginLoop())},$I._initProps=function($I,$M,$E){for(var $Z in $M)if("number"==typeof $I[$Z]){var $i=$E?$I[$Z]:$M[$Z],$n=$E?$M[$Z]:$I[$Z];this._props.push([$Z,$i,$n-$i]),$E||($I[$Z]=$i)}},$I._beginLoop=function(){$a.scaleTimer.frameLoop(1,this,this._doEase)},$I._doEase=function(){this._updateEase($x.now())},$I._updateEase=function($I){var $M=this._target;if($M){if($M.destroyed)return $A.clearTween($M);var $E=this._usedTimer=$I-this._startTimer-this._delay;if(!($E<0)){if($E>=this._duration)return this.complete();for(var $Z=0<$E?this._ease($E,0,1,this._duration):0,$i=this._props,$n=0,$c=$i.length;$n<$c;$n++){var $f=$i[$n];$M[$f[0]]=$f[1]+$Z*$f[2]}this.update&&this.update.run()}}},$I.complete=function(){if(this._target){$a.scaleTimer.runTimer(this,this.firstStart);for(var $I=this._target,$M=this._props,$E=this._complete,$Z=0,$i=$M.length;$Z<$i;$Z++){var $n=$M[$Z];$I[$n[0]]=$n[1]+$n[2]}this.update&&this.update.run(),this.clear(),$E&&$E.run()}},$I.pause=function(){$a.scaleTimer.clear(this,this._beginLoop),$a.scaleTimer.clear(this,this._doEase),$a.scaleTimer.clear(this,this.firstStart);var $I;($I=$x.now()-this._startTimer-this._delay)<0&&(this._usedTimer=$I)},$I.setStartTime=function($I){this._startTimer=$I},$I.clear=function(){this._target&&(this._remove(),this._clear())},$I._clear=function(){this.pause(),$a.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,$P.recover("tween",this))},$I.recover=function(){this._usedPool=!0,this._clear()},$I._remove=function(){var $I=$A.tweenMap[this._target.$_GID];if($I)for(var $M=0,$E=$I.length;$M<$E;$M++)if($I[$M]===this){$I.splice($M,1);break}},$I.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=$x.now(),this._delayParam)$a.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var $I=this._props,$M=0,$E=$I.length;$M<$E;$M++){var $Z=$I[$M];this._target[$Z[0]]=$Z[1]}$a.scaleTimer.once(this._delay,this,this._beginLoop)}},$I.resume=function(){this._usedTimer>=this._duration||(this._startTimer=$x.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?$a.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},$B(0,$I,"progress",null,function($I){var $M=$I*this._duration;this._startTimer=$x.now()-this._delay-$M}),$A.to=function($I,$M,$E,$Z,$i,$n,$c,$f){return void 0===$n&&($n=0),void 0===$c&&($c=!1),void 0===$f&&($f=!0),$P.getItemByClass("tween",$A)._create($I,$M,$E,$Z,$i,$n,$c,!0,$f,!0)},$A.from=function($I,$M,$E,$Z,$i,$n,$c,$f){return void 0===$n&&($n=0),void 0===$c&&($c=!1),void 0===$f&&($f=!0),$P.getItemByClass("tween",$A)._create($I,$M,$E,$Z,$i,$n,$c,!1,$f,!0)},$A.clearAll=function($I){if($I&&$I.$_GID){var $M=$A.tweenMap[$I.$_GID];if($M){for(var $E=0,$Z=$M.length;$E<$Z;$E++)$M[$E]._clear();$M.length=0}}},$A.clear=function($I){$I.clear()},$A.clearTween=function($I){$A.clearAll($I)},$A.easeNone=function($I,$M,$E,$Z){return $E*$I/$Z+$M},$A.tweenMap={},$A}(),$K=function(){function $f(){}return $V($f,"laya.utils.Utils"),$f.toRadian=function($I){return $I*$f._pi2},$f.toAngle=function($I){return $I*$f._pi},$f.toHexColor=function($I){if($I<0||isNaN($I))return null;for(var $M=$I.toString(16);$M.length<6;)$M="0"+$M;return"#"+$M},$f.getGID=function(){return $f._gid++},$f.concatArray=function($I,$M){if(!$M)return $I;if(!$I)return $M;var $E=0,$Z=$M.length;for($E=0;$E<$Z;$E++)$I.push($M[$E]);return $I},$f.clearArray=function($I){return $I&&($I.length=0),$I},$f.copyArray=function($I,$M){if($I||($I=[]),!$M)return $I;$I.length=$M.length;var $E=0,$Z=$M.length;for($E=0;$E<$Z;$E++)$I[$E]=$M[$E];return $I},$f.getGlobalRecByPoints=function($I,$M,$E,$Z,$i){var $n,$c;return $n=new $m($M,$E),$n=$I.localToGlobal($n),$c=new $m($Z,$i),$c=$I.localToGlobal($c),$j._getWrapRec([$n.x,$n.y,$c.x,$c.y])},$f.getGlobalPosAndScale=function($I){return $f.getGlobalRecByPoints($I,0,0,1,1)},$f.bind=function($I,$M){return $I.bind($M)},$f.measureText=function($I,$M){return $W.measureText($I,$M)},$f.contextMeasureText=function($I){var $M=$x.context.measureText($I);return $M||($M={width:16,height:16}),$M},$f.updateOrder=function($I){if(!$I||$I.length<2)return!1;for(var $M,$E=1,$Z=0,$i=$I.length,$n=NaN;$E<$i;){for($M=$I[$Z=$E],$n=$I[$Z]._zOrder;-1<--$Z&&$I[$Z]._zOrder>$n;)$I[$Z+1]=$I[$Z];$I[$Z+1]=$M,$E++}var $c=$M.parent.conchModel;if($c)if(null!=$c.updateZOrder)$c.updateZOrder();else{for($E=0;$E<$i;$E++)$c.removeChild($I[$E].conchModel);for($E=0;$E<$i;$E++)$c.addChildAt($I[$E].conchModel,$E)}return!0},$f.transPointList=function($I,$M,$E){var $Z=0,$i=$I.length;for($Z=0;$Z<$i;$Z+=2)$I[$Z]+=$M,$I[$Z+1]+=$E},$f.parseInt=function($I,$M){void 0===$M&&($M=0);var $E=$x.window.parseInt($I,$M);return isNaN($E)?0:$E},$f.getFileExtension=function($I){$f._extReg.lastIndex=$I.lastIndexOf(".");var $M=$f._extReg.exec($I);return $M&&1<$M.length?$M[1].toLowerCase():null},$f.getTransformRelativeToWindow=function($I,$M,$E){var $Z=$a.stage,$i=laya.utils.Utils.getGlobalPosAndScale($I),$n=$Z._canvasTransform.clone(),$c=$n.tx,$f=$n.ty;$n.rotate(-Math.PI/180*$a.stage.canvasDegree),$n.scale($a.stage.clientScaleX,$a.stage.clientScaleY);var $d=$a.stage.canvasDegree%180!=0,$H=NaN,$B=NaN;$d?($H=$E+$i.y,$B=$M+$i.x,$H*=$n.d,$B*=$n.a,90==$a.stage.canvasDegree?($H=$c-$H,$B+=$f):($H+=$c,$B=$f-$B)):($H=$M+$i.x,$B=$E+$i.y,$H*=$n.a,$B*=$n.d,$H+=$c,$B+=$f);var $A=NaN,$Q=NaN;return $Q=$d?($A=$n.d*$i.height,$n.a*$i.width):($A=$n.a*$i.width,$n.d*$i.height),{x:$H,y:$B,scaleX:$A,scaleY:$Q}},$f.fitDOMElementInArea=function($I,$M,$E,$Z,$i,$n){$I._fitLayaAirInitialized||($I._fitLayaAirInitialized=!0,$I.style.transformOrigin=$I.style.webKittransformOrigin="left top",$I.style.position="absolute");var $c=$f.getTransformRelativeToWindow($M,$E,$Z);$I.style.transform=$I.style.webkitTransform="scale("+$c.scaleX+","+$c.scaleY+") rotate("+$a.stage.canvasDegree+"deg)",$I.style.width=$i+"px",$I.style.height=$n+"px",$I.style.left=$c.x+"px",$I.style.top=$c.y+"px"},$f.isOkTextureList=function($I){if(!$I)return!1;var $M,$E=0,$Z=$I.length;for($E=0;$E<$Z;$E++)if(!($M=$I[$E])||!$M.source)return!1;return!0},$f.isOKCmdList=function($I){if(!$I)return!1;var $M,$E,$Z=0,$i=$I.length,$n=$o._context;for($Z=0;$Z<$i;$Z++)switch(($M=$I[$Z]).callee){case $n._drawTexture:case $n._fillTexture:case $n._drawTextureWithTransform:if(!($E=$M[0])||!$E.source)return!1}return!0},$f._gid=1,$f._pi=180/Math.PI,$f._pi2=Math.PI/180,$f._extReg=/\.(\w+)\??/g,$f.parseXMLFromString=function($I){var $M;if($I=$I.replace(/>\s+</g,"><"),-1<($M=(new DOMParser).parseFromString($I,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error($M.firstChild.firstChild.textContent);return $M},$f}(),$s=function(){function $I(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],$o.isWebGL&&$r.regCacheByFunction($K.bind(this.startDispose,this),$K.bind(this.getCacheList,this))}$V($I,"laya.utils.VectorGraphManager");var $M=$I.prototype;return $M.getId=function(){return this._id++},$M.addShape=function($I,$M){this.shapeDic[$I]=$M,this.useDic[$I]||(this.useDic[$I]=!0)},$M.addLine=function($I,$M){this.shapeLineDic[$I]=$M,this.shapeLineDic[$I]||(this.shapeLineDic[$I]=!0)},$M.getShape=function($I){this._checkKey&&null!=this.useDic[$I]&&(this.useDic[$I]=!0)},$M.deleteShape=function($I){this.shapeDic[$I]&&(this.shapeDic[$I]=null,delete this.shapeDic[$I]),this.shapeLineDic[$I]&&(this.shapeLineDic[$I]=null,delete this.shapeLineDic[$I]),null!=this.useDic[$I]&&delete this.useDic[$I]},$M.getCacheList=function(){var $I,$M=[];for($I in this.shapeDic)$M.push(this.shapeDic[$I]);for($I in this.shapeLineDic)$M.push(this.shapeLineDic[$I]);return $M},$M.startDispose=function($I){var $M;for($M in this.useDic)this.useDic[$M]=!1;this._checkKey=!0},$M.endDispose=function(){if(this._checkKey){var $I;for($I in this.useDic)this.useDic[$I]||this.deleteShape($I);this._checkKey=!1}},$I.getInstance=function(){return $I.instance=$I.instance||new $I},$I.instance=null,$I}(),$b=function(){function $Z(){this._obj=null,this._obj=$Z.supportWeakMap?new $x.window.WeakMap:{},$Z.supportWeakMap||$Z._maps.push(this)}$V($Z,"laya.utils.WeakObject");var $I=$Z.prototype;return $I.set=function($I,$M){if(null!=$I)if($Z.supportWeakMap){var $E=$I;"string"!=typeof $I&&"number"!=typeof $I||($E=$Z._keys[$I])||($E=$Z._keys[$I]={k:$I}),this._obj.set($E,$M)}else"string"==typeof $I||"number"==typeof $I?this._obj[$I]=$M:($I.$_GID||($I.$_GID=$K.getGID()),this._obj[$I.$_GID]=$M)},$I.get=function($I){if(null==$I)return null;if($Z.supportWeakMap){var $M="string"==typeof $I||"number"==typeof $I?$Z._keys[$I]:$I;return $M?this._obj.get($M):null}return"string"==typeof $I||"number"==typeof $I?this._obj[$I]:this._obj[$I.$_GID]},$I.del=function($I){if(null!=$I)if($Z.supportWeakMap){var $M="string"==typeof $I||"number"==typeof $I?$Z._keys[$I]:$I;if(!$M)return;this._obj.delete($M)}else"string"==typeof $I||"number"==typeof $I?delete this._obj[$I]:delete this._obj[this._obj.$_GID]},$I.has=function($I){if(null==$I)return!1;if($Z.supportWeakMap){var $M="string"==typeof $I||"number"==typeof $I?$Z._keys[$I]:$I;return this._obj.has($M)}return"string"==typeof $I||"number"==typeof $I?null!=this._obj[$I]:null!=this._obj[this._obj.$_GID]},$Z.__init__=function(){($Z.supportWeakMap=null!=$x.window.WeakMap)||$a.timer.loop($Z.delInterval,null,$Z.clearCache)},$Z.clearCache=function(){for(var $I=0,$M=$Z._maps.length;$I<$M;$I++){$Z._maps[$I]._obj={}}},$Z.supportWeakMap=!1,$Z.delInterval=3e5,$Z._keys={},$Z._maps=[],$d($Z,["I",function(){return this.I=new $Z}]),$Z}(),$U=function(){function $I(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}$V($I,"laya.utils.WordText");var $M=$I.prototype;return $M.setText=function($I){this.changed=!0,this._text=$I},$M.toString=function(){return this._text},$M.charCodeAt=function($I){return this._text?this._text.charCodeAt($I):NaN},$M.charAt=function($I){return this._text?this._text.charAt($I):null},$B(0,$M,"length",function(){return this._text?this._text.length:0}),$I}(),$II=function($I){function $c(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,$c.__super.call(this),this._childs=$c.ARRAY_EMPTY,this._$P=$c.PROP_EMPTY,this.timer=$a.scaleTimer,this.conchModel=$o.isConchNode?this.createConchModel():null}$V($c,"laya.display.Node",$H);var $M=$c.prototype;return $M._setBit=function($I,$M){1==$I&&(this._getBit($I)!=$M&&this._updateDisplayedInstage());$M?this._bits|=$I:this._bits&=~$I},$M._getBit=function($I){return 0!=(this._bits&$I)},$M._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},$M._setUpNoticeType=function($I){var $M=this;for($M._setBit($I,!0),$M=$M.parent;$M;){if($M._getBit($I))return;$M._setBit($I,!0),$M=$M.parent}},$M.on=function($I,$M,$E,$Z){return"display"!==$I&&"undisplay"!==$I||this._getBit(1)||this._setUpNoticeType(1),this._createListener($I,$M,$E,$Z,!1)},$M.once=function($I,$M,$E,$Z){return"display"!==$I&&"undisplay"!==$I||this._getBit(1)||this._setUpNoticeType(1),this._createListener($I,$M,$E,$Z,!0)},$M.createConchModel=function(){return null},$M.destroy=function($I){void 0===$I&&($I=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&($I?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},$M.destroyChildren=function(){if(this._childs)for(var $I=this._childs.length-1;-1<$I;$I--)this._childs[$I].destroy(!0)},$M.addChild=function($I){if(!$I||this.destroyed||$I===this)return $I;if($I.zOrder&&this._set$P("hasZorder",!0),$I._parent===this){var $M=this.getChildIndex($I);$M!==this._childs.length-1&&(this._childs.splice($M,1),this._childs.push($I),this.conchModel&&(this.conchModel.removeChild($I.conchModel),this.conchModel.addChildAt($I.conchModel,this._childs.length-1)),this._childChanged())}else $I.parent&&$I.parent.removeChild($I),this._childs===$c.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($I),this.conchModel&&this.conchModel.addChildAt($I.conchModel,this._childs.length-1),($I.parent=this)._childChanged();return $I},$M.addChildren=function($I){for(var $M=arguments,$E=0,$Z=$M.length;$E<$Z;)this.addChild($M[$E++])},$M.addChildAt=function($I,$M){if(!$I||this.destroyed||$I===this)return $I;if($I.zOrder&&this._set$P("hasZorder",!0),0<=$M&&$M<=this._childs.length){if($I._parent===this){var $E=this.getChildIndex($I);this._childs.splice($E,1),this._childs.splice($M,0,$I),this.conchModel&&(this.conchModel.removeChild($I.conchModel),this.conchModel.addChildAt($I.conchModel,$M)),this._childChanged()}else $I.parent&&$I.parent.removeChild($I),this._childs===$c.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($M,0,$I),this.conchModel&&this.conchModel.addChildAt($I.conchModel,$M),$I.parent=this;return $I}throw new Error("appendChildAt:The index is out of bounds")},$M.getChildIndex=function($I){return this._childs.indexOf($I)},$M.getChildByName=function($I){var $M=this._childs;if($M)for(var $E=0,$Z=$M.length;$E<$Z;$E++){var $i=$M[$E];if($i.name===$I)return $i}return null},$M._get$P=function($I){return this._$P[$I]},$M._set$P=function($I,$M){return this.destroyed||(this._$P===$c.PROP_EMPTY&&(this._$P={}),this._$P[$I]=$M),$M},$M.getChildAt=function($I){return this._childs[$I]},$M.setChildIndex=function($I,$M){var $E=this._childs;if($M<0||$M>=$E.length)throw new Error("setChildIndex:The index is out of bounds.");var $Z=this.getChildIndex($I);if($Z<0)throw new Error("setChildIndex:node is must child of this object.");return $E.splice($Z,1),$E.splice($M,0,$I),this.conchModel&&(this.conchModel.removeChild($I.conchModel),this.conchModel.addChildAt($I.conchModel,$M)),this._childChanged(),$I},$M._childChanged=function($I){},$M.removeChild=function($I){if(!this._childs)return $I;var $M=this._childs.indexOf($I);return this.removeChildAt($M)},$M.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},$M.removeChildByName=function($I){var $M=this.getChildByName($I);return $M&&this.removeChild($M),$M},$M.removeChildAt=function($I){var $M=this.getChildAt($I);if($M){for(var $E=this._childs.length-1,$Z=$I;$Z<$E;++$Z)this._childs[$Z]=this._childs[$Z+1];this._childs.length=$E,this.conchModel&&this.conchModel.removeChild($M.conchModel),$M.parent=null}return $M},$M.removeChildren=function($I,$M){if(void 0===$I&&($I=0),void 0===$M&&($M=2147483647),this._childs&&0<this._childs.length){var $E=this._childs;if(0===$I&&$n<=$M){var $Z=$E;this._childs=$c.ARRAY_EMPTY}else $Z=$E.splice($I,$M-$I);for(var $i=0,$n=$Z.length;$i<$n;$i++)$Z[$i].parent=null,this.conchModel&&this.conchModel.removeChild($Z[$i].conchModel)}return this},$M.replaceChild=function($I,$M){var $E=this._childs.indexOf($M);return-1<$E?(this._childs.splice($E,1,$I),this.conchModel&&(this.conchModel.removeChild($M.conchModel),this.conchModel.addChildAt($I.conchModel,$E)),$M.parent=null,$I.parent=this,$I):null},$M._updateDisplayedInstage=function(){var $I;$I=this;var $M=$a.stage;for(this._displayedInStage=!1;$I;){if($I._getBit(1)){this._displayedInStage=$I._displayedInStage;break}if($I==$M||$I._displayedInStage){this._displayedInStage=!0;break}$I=$I.parent}},$M._setDisplay=function($I){this._displayedInStage!==$I&&((this._displayedInStage=$I)?this.event("display"):this.event("undisplay"))},$M._displayChild=function($I,$M){var $E=$I._childs;if($E)for(var $Z=0;$Z<$E.length;$Z++){var $i=$E[$Z];$i&&$i._getBit(1)&&(0<$i._childs.length?this._displayChild($i,$M):$i._setDisplay($M))}$I._setDisplay($M)},$M.contains=function($I){if($I===this)return!0;for(;$I;){if($I.parent===this)return!0;$I=$I.parent}return!1},$M.timerLoop=function($I,$M,$E,$Z,$i,$n){void 0===$i&&($i=!0),void 0===$n&&($n=!1),this.timer.loop($I,$M,$E,$Z,$i,$n)},$M.timerOnce=function($I,$M,$E,$Z,$i){void 0===$i&&($i=!0),this.timer._create(!1,!1,$I,$M,$E,$Z,$i)},$M.frameLoop=function($I,$M,$E,$Z,$i){void 0===$i&&($i=!0),this.timer._create(!0,!0,$I,$M,$E,$Z,$i)},$M.frameOnce=function($I,$M,$E,$Z,$i){void 0===$i&&($i=!0),this.timer._create(!0,!1,$I,$M,$E,$Z,$i)},$M.clearTimer=function($I,$M){this.timer.clear($I,$M)},$B(0,$M,"numChildren",function(){return this._childs.length}),$B(0,$M,"destroyed",function(){return this._destroyed}),$B(0,$M,"parent",function(){return this._parent},function($I){this._parent!==$I&&($I?(this._parent=$I,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),$I.displayedInStage&&this._displayChild(this,!0)),$I._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=$I))}),$B(0,$M,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),$c.ARRAY_EMPTY=[],$c.PROP_EMPTY={},$c.NOTICE_DISPLAY=1,$c.MOUSEENABLE=2,$c}(),$MI=function($I){function $Q($I){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,$Q.__super.call(this),this._padding=$Q._PADDING,this._spacing=$Q._SPACING,this._aligns=$Q._ALIGNS,this._font=$p.EMPTY,this._ower=$I}$V($Q,"laya.display.css.CSSStyle",$I);var $M=$Q.prototype;return $M.destroy=function(){this._ower=null,this._font=null,this._rect=null},$M.inherit=function($I){this._font=$I._font,this._spacing=$I._spacing===$Q._SPACING?$Q._SPACING:$I._spacing.slice(),this.lineHeight=$I.lineHeight},$M._widthAuto=function(){return 0!=(262144&this._type)},$M.widthed=function($I){return 0!=(8&this._type)},$M._calculation=function($I,$M){if($M.indexOf("%")<0)return!1;var $Z=this._ower,$i=$Z.parent,$n=this._rect;function $c($I,$M,$E){return $I*$E[0]+$M*$E[1]+$E[2]}function $E($I){var $M=$i.width,$E=$Z.width;$n.width&&($Z.width=$c($M,$E,$n.width)),$n.height&&($Z.height=$c($M,$E,$n.height)),$n.left&&($Z.x=$c($M,$E,$n.left)),$n.top&&($Z.y=$c($M,$E,$n.top))}null===$n&&($i._getCSSStyle()._type|=524288,$i.on("resize",this,$E),this._rect=$n={input:{}});var $f=$M.split(" ");return $f[0]=parseFloat($f[0])/100,1==$f.length?$f[1]=$f[2]=0:($f[1]=parseFloat($f[1])/100,$f[2]=parseFloat($f[2])),$n[$I]=$f,$n.input[$I]=$M,$E(),!0},$M.heighted=function($I){return 0!=(8192&this._type)},$M.size=function($I,$M){var $E=this._ower,$Z=!1;-1!==$I&&$I!=this._ower.width&&(this._type|=8,this._ower.width=$I,$Z=!0),-1!==$M&&$M!=this._ower.height&&(this._type|=8192,this._ower.height=$M,$Z=!0),$Z&&($E._layoutLater(),524288&this._type&&$E.event("resize",this))},$M._getAlign=function(){return this._aligns[0]},$M._getValign=function(){return this._aligns[1]},$M._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},$M._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new $p(this._font))},$M.render=function($I,$M,$E,$Z){var $i=$I.width,$n=$I.height;$E-=$I.pivotX,$Z-=$I.pivotY,this._bgground&&null!=this._bgground.color&&$M.ctx.fillRect($E,$Z,$i,$n,this._bgground.color),this._border&&this._border.color&&$M.drawRect($E,$Z,$i,$n,this._border.color.strColor,this._border.size)},$M.getCSSStyle=function(){return this},$M.cssText=function($I){this.attrs($Q.parseOneCSS($I,";"))},$M.attrs=function($I){if($I)for(var $M=0,$E=$I.length;$M<$E;$M++){var $Z=$I[$M];this[$Z[0]]=$Z[1]}},$M.setTransform=function($I){"none"===$I?this._tf=$f._TF_EMPTY:this.attrs($Q.parseOneCSS($I,","))},$M.translate=function($I,$M){this._tf===$f._TF_EMPTY&&(this._tf=new $i),this._tf.translateX=$I,this._tf.translateY=$M},$M.scale=function($I,$M){this._tf===$f._TF_EMPTY&&(this._tf=new $i),this._tf.scaleX=$I,this._tf.scaleY=$M},$M._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},$B(0,$M,"block",$I.prototype._$get_block,function($I){$I?this._type|=1:this._type&=-2}),$B(0,$M,"valign",function(){return $Q._valigndef[this._aligns[1]]},function($I){this._aligns===$Q._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=$Q._valigndef[$I]}),$B(0,$M,"height",null,function($I){if(this._type|=8192,"string"==typeof $I){if(this._calculation("height",$I))return;$I=parseInt($I)}this.size(-1,$I)}),$B(0,$M,"width",null,function($I){if(this._type|=8,"string"==typeof $I){var $M=$I.indexOf("auto");if(0<=$M&&(this._type|=262144,$I=$I.substr(0,$M)),this._calculation("width",$I))return;$I=parseInt($I)}this.size($I,-1)}),$B(0,$M,"fontWeight",function(){return this._font.weight},function($I){this._createFont().weight=$I}),$B(0,$M,"left",null,function($I){var $M=this._ower;if("string"==typeof $I){if("center"===$I?$I="50% -50% 0":"right"===$I&&($I="100% -100% 0"),this._calculation("left",$I))return;$I=parseInt($I)}$M.x=$I}),$B(0,$M,"_translate",null,function($I){this.translate($I[0],$I[1])}),$B(0,$M,"absolute",function(){return 0!=(4&this._type)}),$B(0,$M,"top",null,function($I){var $M=this._ower;if("string"==typeof $I){if("middle"===$I?$I="50% -50% 0":"bottom"===$I&&($I="100% -100% 0"),this._calculation("top",$I))return;$I=parseInt($I)}$M.y=$I}),$B(0,$M,"align",function(){return $Q._aligndef[this._aligns[0]]},function($I){this._aligns===$Q._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=$Q._aligndef[$I]}),$B(0,$M,"bold",function(){return this._font.bold},function($I){this._createFont().bold=$I}),$B(0,$M,"padding",function(){return this._padding},function($I){this._padding=$I}),$B(0,$M,"leading",function(){return this._spacing[1]},function($I){"string"==typeof $I&&($I=parseInt($I+"")),this._spacing===$Q._SPACING&&(this._spacing=[0,0]),this._spacing[1]=$I}),$B(0,$M,"lineElement",function(){return 0!=(65536&this._type)},function($I){$I?this._type|=65536:this._type&=-65537}),$B(0,$M,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function($I){this.lineElement=!1,"right"===$I?this._type|=32768:this._type&=-32769}),$B(0,$M,"textDecoration",function(){return this._font.decoration},function($I){this._createFont().decoration=$I}),$B(0,$M,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function($I){"nowrap"===$I&&(this._type|=131072),"none"===$I&&(this._type&=-131073)}),$B(0,$M,"background",null,function($I){$I?(this._bgground||(this._bgground={}),this._bgground.color=$I,this._ower.conchModel&&this._ower.conchModel.bgColor($I),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),$B(0,$M,"wordWrap",function(){return 0==(131072&this._type)},function($I){$I?this._type&=-131073:this._type|=131072}),$B(0,$M,"color",function(){return this._font.color},function($I){this._createFont().color=$I}),$B(0,$M,"password",function(){return this._font.password},function($I){this._createFont().password=$I}),$B(0,$M,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function($I){"none"===$I?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=$I),this._ower.conchModel&&this._ower.conchModel.bgColor($I),this._ower._renderType|=256}),$B(0,$M,"font",function(){return this._font.toString()},function($I){this._createFont().set($I)}),$B(0,$M,"weight",null,function($I){this._createFont().weight=$I}),$B(0,$M,"letterSpacing",function(){return this._spacing[0]},function($I){"string"==typeof $I&&($I=parseInt($I+"")),this._spacing===$Q._SPACING&&(this._spacing=[0,0]),this._spacing[0]=$I}),$B(0,$M,"fontSize",function(){return this._font.size},function($I){this._createFont().size=$I}),$B(0,$M,"italic",function(){return this._font.italic},function($I){this._createFont().italic=$I}),$B(0,$M,"fontFamily",function(){return this._font.family},function($I){this._createFont().family=$I}),$B(0,$M,"stroke",function(){return this._font.stroke[0]},function($I){this._createFont().stroke===$p._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=$I}),$B(0,$M,"strokeColor",function(){return this._font.stroke[1]},function($I){this._createFont().stroke===$p._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=$I}),$B(0,$M,"border",function(){return this._border?this._border.value:""},function($I){if("none"!=$I){this._border||(this._border={});var $M=(this._border.value=$I).split(" ");if(this._border.color=$F.create($M[$M.length-1]),1==$M.length)return this._border.size=1,void(this._border.type="solid");var $E=0;0<$M[0].indexOf("px")?(this._border.size=parseInt($M[0]),$E++):this._border.size=1,this._border.type=$M[$E],this._ower._renderType|=256}else this._border=null}),$B(0,$M,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function($I){$I?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==$I?null:$F.create($I),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),$B(0,$M,"position",function(){return 4&this._type?"absolute":""},function($I){"absolute"==$I?this._type|=4:this._type&=-5}),$B(0,$M,"display",null,function($I){switch($I){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),$B(0,$M,"paddingLeft",function(){return this.padding[3]}),$B(0,$M,"paddingTop",function(){return this.padding[0]}),$B(0,$M,"_scale",null,function($I){this._ower.scale($I[0],$I[1])}),$B(0,$M,"_rotate",null,function($I){this._ower.rotation=$I}),$Q.parseOneCSS=function($I,$M){for(var $E,$Z=[],$i=$I.split($M),$n=0,$c=$i.length;$n<$c;$n++){var $f=$i[$n],$d=$f.indexOf(":"),$H=$f.substr(0,$d).replace(/^\s+|\s+$/g,"");if(0!=$H.length){var $B=$f.substr($d+1).replace(/^\s+|\s+$/g,""),$A=[$H,$B];switch($H){case"italic":case"bold":$A[1]="true"==$B;break;case"line-height":$A[0]="lineHeight",$A[1]=parseInt($B);break;case"font-size":$A[0]="fontSize",$A[1]=parseInt($B);break;case"padding":1<($E=$B.split(" ")).length||($E[1]=$E[2]=$E[3]=$E[0]),$A[1]=[parseInt($E[0]),parseInt($E[1]),parseInt($E[2]),parseInt($E[3])];break;case"rotate":$A[0]="_rotate",$A[1]=parseFloat($B);break;case"scale":$E=$B.split(" "),$A[0]="_scale",$A[1]=[parseFloat($E[0]),parseFloat($E[1])];break;case"translate":$E=$B.split(" "),$A[0]="_translate",$A[1]=[parseInt($E[0]),parseInt($E[1])];break;default:($A[0]=$Q._CSSTOVALUE[$H])||($A[0]=$H)}$Z.push($A)}}return $Z},$Q.parseCSS=function($I,$M){for(var $E;null!=($E=$Q._parseCSSRegExp.exec($I));)$Q.styleSheets[$E[1]]=$Q.parseOneCSS($E[2],";")},$Q.EMPTY=new $Q(null),$Q._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},$Q._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),$Q._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},$Q._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},$Q.styleSheets={},$Q.ALIGN_CENTER=1,$Q.ALIGN_RIGHT=2,$Q.VALIGN_MIDDLE=1,$Q.VALIGN_BOTTOM=2,$Q._CSS_BLOCK=1,$Q._DISPLAY_NONE=2,$Q._ABSOLUTE=4,$Q._WIDTH_SET=8,$Q._PADDING=[0,0,0,0],$Q._RECT=[-1,-1,-1,-1],$Q._SPACING=[0,0],$Q._ALIGNS=[0,0,0],$Q.ADDLAYOUTED=512,$Q._NEWFONT=4096,$Q._HEIGHT_SET=8192,$Q._BACKGROUND_SET=16384,$Q._FLOAT_RIGHT=32768,$Q._LINE_ELEMENT=65536,$Q._NOWARP=131072,$Q._WIDTHAUTO=262144,$Q._LISTERRESZIE=524288,$Q}($f),$EI=function($I){function $c(){this.url=null,this.audio=null,this.loaded=!1,$c.__super.call(this)}$V($c,"laya.media.h5audio.AudioSound",$H);var $M=$c.prototype;return $M.dispose=function(){var $I=$c._audioCache[this.url];$I&&($I.src="",delete $c._audioCache[this.url])},$M.load=function($I){var $M;if($I=$L.formatURL($I),(this.url=$I)==$v._tMusic?($c._initMusicAudio(),($M=$c._musicAudio).src!=$I&&($c._audioCache[$M.src]=null,$M=null)):$M=$c._audioCache[$I],$M&&2<=$M.readyState)this.event("complete");else{$M||($M=$I==$v._tMusic?($c._initMusicAudio(),$c._musicAudio):$x.createElement("audio"),($c._audioCache[$I]=$M).src=$I),$M.addEventListener("canplaythrough",$Z),$M.addEventListener("error",$i);var $E=this;(this.audio=$M).load?$M.load():$i()}function $Z(){$n(),$E.loaded=!0,$E.event("complete")}function $i(){$M.load=null,$n(),$E.event("error")}function $n(){$M.removeEventListener("canplaythrough",$Z),$M.removeEventListener("error",$i)}},$M.play=function($I,$M,$E){if(void 0===$I&&($I=0),void 0===$M&&($M=0),!this.url)return null;var $Z,$i;if(!($Z=this.url==$v._tMusic?$c._musicAudio:$c._audioCache[this.url]))return null;$i=$P.getItem("audio:"+this.url),$o.isConchApp?$i||(($i=$x.createElement("audio")).src=this.url):this.url==$v._tMusic?($c._initMusicAudio(),($i=$c._musicAudio).src=this.url):$i=$i||$Z.cloneNode(!0);var $n=new $QI($i);return $n.url=this.url,$n.loops=$M,$n.startTime=$I,$n.startHandler=$E,$n.play(!1),$v.addChannel($n),$n},$B(0,$M,"duration",function(){var $I;return($I=$c._audioCache[this.url])?$I.duration:0}),$c._initMusicAudio=function(){$c._musicAudio||($c._musicAudio||($c._musicAudio=$x.createElement("audio")),$o.isConchApp||$x.document.addEventListener("mousedown",$c._makeMusicOK))},$c._makeMusicOK=function(){$x.document.removeEventListener("mousedown",$c._makeMusicOK),$c._musicAudio.src?$c._musicAudio.play():($c._musicAudio.src="",$c._musicAudio.load())},$c._audioCache={},$c._musicAudio=null,$c}(),$ZI=function($I){function $M(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,$M.__super.call(this)}$V($M,"laya.media.SoundChannel",$H);var $E=$M.prototype;return $E.play=function(){},$E.stop=function(){},$E.pause=function(){},$E.resume=function(){},$E.__runComplete=function($I){$I&&$I.run()},$B(0,$E,"volume",function(){return 1},function($I){}),$B(0,$E,"position",function(){return 0}),$B(0,$E,"duration",function(){return 0}),$M}(),$iI=function($I){function $M(){$M.__super.call(this)}$V($M,"laya.media.Sound",$H);var $E=$M.prototype;return $E.load=function($I){},$E.play=function($I,$M,$E){return void 0===$I&&($I=0),void 0===$M&&($M=0),null},$E.dispose=function(){},$B(0,$E,"duration",function(){return 0}),$M}(),$nI=function($I){function $i(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,$i.__super.call(this)}$V($i,"laya.media.webaudio.WebAudioSound",$H);var $M=$i.prototype;return $M.load=function($I){this.url=$I,this.audioBuffer=$i._dataCache[$I],this.audioBuffer?this._loaded(this.audioBuffer):($i.e.on("loaded:"+$I,this,this._loaded),$i.e.on("err:"+$I,this,this._err),$i.__loadingSound[$I]||($i.__loadingSound[$I]=!0,$a.loader.load($I,$y.create(this,this.onloaded),null,$fI.BUFFER,4,!1,null,!0)))},$M.onloaded=function($I){$I||this._err(),this._disposed?this._removeLoadEvents():(this.data=$I,$i.buffs.push({buffer:this.data,url:this.url}),$i.decode())},$M._err=function(){if(this._removeLoadEvents(),$i.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var $I,$M,$E,$Z=0;for($I=($M=this.__toPlays).length,$Z=0;$Z<$I;$Z++)($E=$M[$Z])[3]&&!$E[3].isStopped&&$E[3].event("error");this.__toPlays.length=0}},$M._loaded=function($I){this._removeLoadEvents(),this._disposed||(this.audioBuffer=$I,this.loaded=!0,this.event("complete"))},$M._removeLoadEvents=function(){$i.e.off("loaded:"+this.url,this,this._loaded),$i.e.off("err:"+this.url,this,this._err)},$M.__playAfterLoaded=function(){if(this.__toPlays){var $I,$M,$E,$Z=0;for($I=($M=this.__toPlays).length,$Z=0;$Z<$I;$Z++)($E=$M[$Z])[3]&&!$E[3].isStopped&&this.play($E[0],$E[1],$E[2],$E[3]);this.__toPlays.length=0}},$M.play=function($I,$M,$E,$Z){return void 0===$I&&($I=0),void 0===$M&&($M=0),$Z=$Z||new $pI,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([$I,$M,$E,$Z]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),$Z.url=this.url,$Z.loops=$M,$Z.audioBuffer=this.audioBuffer,$Z.startTime=$I,$Z.startHandler=$E,$Z.play(!1),$v.addChannel($Z),$Z},$M.dispose=function(){this._disposed=!0,delete $i._dataCache[this.url],delete $i.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},$B(0,$M,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$i.decode=function(){if(!($i.buffs.length<=0||$i.isDecoding))if($i.isDecoding=!0,($i.tInfo=$i.buffs.shift())&&$i.tInfo.buffer&&$i.tInfo.buffer.byteLength)try{$i.ctx.decodeAudioData($i.tInfo.buffer,$i._done,$i._fail)}catch($I){console.error("decodeAudioData error  byteLength:"+$i.tInfo.buffer.byteLength+"  url:"+$i.tInfo.url)}else $i._fail()},$i._done=function($I){$i.e.event("loaded:"+$i.tInfo.url,$I),$i._dataCache[$i.tInfo.url]=$I,$i.isDecoding=!1,$i.decode()},$i._fail=function(){$i.e.event("err:"+$i.tInfo.url,null),$i.isDecoding=!1,$i.decode()},$i._playEmptySound=function(){if(null!=$i.ctx){if($i._emptySource&&($i._emptySource.stop(),$i._emptySource.disconnect(0),!$pI._tryCleanFailed))try{$i._emptySource.buffer=null}catch($I){$pI._tryCleanFailed=!0}var $I=$i.ctx.createBufferSource();$I.buffer=$i._miniBuffer,$I.connect($i.ctx.destination),$I.start(0,0,0),$i._emptySource=$I}},$i._unlock=function(){$i._unlocked||($i._playEmptySound(),"running"==$i.ctx.state?($x.document.removeEventListener("mousedown",$i._unlock,!0),$x.document.removeEventListener("touchend",$i._unlock,!0),$x.document.removeEventListener("touchstart",$i._unlock,!0),$i._unlocked=!0):"suspended"==$i.ctx.state&&$v._recoverWebAudio())},$i.initWebAudio=function(){"running"!=$i.ctx.state&&($i._unlock(),$x.document.addEventListener("mousedown",$i._unlock,!0),$x.document.addEventListener("touchend",$i._unlock,!0),$x.document.addEventListener("touchstart",$i._unlock,!0))},$i._emptySource=null,$i._dataCache={},$i.buffs=[],$i.isDecoding=!1,$i._unlocked=!1,$i.tInfo=null,$i.__loadingSound={},$d($i,["window",function(){return this.window=$x.window},"webAudioEnabled",function(){return this.webAudioEnabled=$i.window.AudioContext||$i.window.webkitAudioContext||$i.window.mozAudioContext},"ctx",function(){return this.ctx=$i.webAudioEnabled?new($i.window.AudioContext||$i.window.webkitAudioContext||$i.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=$i.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new $H}]),$i}(),$cI=function($I){function $M(){this._responseType=null,this._data=null,$M.__super.call(this),this._http=new $x.window.XMLHttpRequest}$V($M,"laya.net.HttpRequest",$H);var $E=$M.prototype;return $E.send=function($I,$M,$E,$Z,$i){void 0===$E&&($E="get"),void 0===$Z&&($Z="text"),this._responseType=$Z,this._data=null;var $n=this,$c=this._http;if($c.open($E,$I,!0),$i)for(var $f=0;$f<$i.length;$f++)$c.setRequestHeader($i[$f++],$i[$f]);else $o.isConchApp||($M&&"string"!=typeof $M?$c.setRequestHeader("Content-Type","application/json"):$c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));$c.responseType="arraybuffer"!==$Z?"text":"arraybuffer",$c.onerror=function($I){$n._onError($I)},$c.onabort=function($I){$n._onAbort($I)},$c.onprogress=function($I){$n._onProgress($I)},$c.onload=function($I){$n._onLoad($I)},$c.send($M)},$E._onProgress=function($I){$I&&$I.lengthComputable&&this.event("progress",$I.loaded/$I.total)},$E._onAbort=function($I){this.error("Request was aborted by user")},$E._onError=function($I){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},$E._onLoad=function($I){var $M=this._http,$E=void 0!==$M.status?$M.status:200;200===$E||204===$E||0===$E?this.complete():this.error("["+$M.status+"]"+$M.statusText+":"+$M.responseURL)},$E.error=function($I){this.clear(),this.event("error",$I)},$E.complete=function(){this.clear();var $M=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=$K.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch($I){$M=!1,this.error($I.message)}$M&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},$E.clear=function(){var $I=this._http;$I.onerror=$I.onabort=$I.onprogress=$I.onload=null},$B(0,$E,"url",function(){return this._http.responseURL}),$B(0,$E,"http",function(){return this._http}),$B(0,$E,"data",function(){return this._data}),$M}(),$fI=function($I){function $T(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,$T.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}$V($T,"laya.net.Loader",$H);var $M=$T.prototype;return $M.load=function($I,$M,$E,$Z,$i){if($I&&""!=$I||console.error("Loader 加载的url不合法 "+$I),void 0===$E&&($E=!0),void 0===$i&&($i=!1),0===(this._url=$I).indexOf("data:image")?this._type=$M="image":this._type=$M||($M=this.getTypeFromUrl($I)),this._cache=$E,this._data=null,!$i&&$T.loadedMap[$I])return this._data=$T.loadedMap[$I],this.event("progress",1),void this.event("complete",this._data);if($Z&&$T.setGroup($I,$Z),null!=$T.parserMap[$M])return this._customParse=!0,void($T.parserMap[$M]instanceof laya.utils.Handler?$T.parserMap[$M].runWith(this):$T.parserMap[$M].call(null,this));if("image"===$M||"htmlimage"===$M||"nativeimage"===$M)return this._loadImage($I);if("ttf"===$M)return this._loadTTF($I);switch($M){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:$M}$T.preLoadedMap[$I]?this.onLoaded($T.preLoadedMap[$I]):$c.resMgrLoad($I,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},$M.getTypeFromUrl=function($I){var $M=$K.getFileExtension($I);return $M?$T.typeMap[$M]:(console.warn("Not recognize the resources suffix",$I),"text")},$M._loadTTF=function($I){$I=$L.formatURL($I);var $M=new $z;$M.complete=$y.create(this,this.onLoaded),$M.load($I)},$M._loadImage=function($I){$c.imgMgrLoad($I,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},$M._loadImageComplete=function($I,$M,$E){if(null!=$E)if($E instanceof ArrayBuffer){var $Z=new DataView($E),$i=new laya.webgl.resource.WebGLImage(new Uint8Array($E,8),$I,0,!1,$Z.getUint32(0),$Z.getUint32(4));this.onLoaded($i)}else if($E instanceof $BI)$T.imgMgrSet[$I]=$M,$c.imgMgrLock($I,$T.imgMgrSet[$I]),this._url=$I,this.complete($E);else{var $n=-1!=$I.indexOf(".png",$I.length-4)?6408:6407;$i=new laya.webgl.resource.WebGLImage($E,$I,$n,!1,$E.width,$E.height);this.onLoaded($i)}else this.event("error","Load image failed")},$M.imageCancel=function($I,$M,$E){$c.imgMgrCancel&&$c.imgMgrCancel($I,this._onImageCallback)},$M._loadSound=function($I){var $M=new $v._soundClass,$E=this;function $Z(){$M.offAll()}$M.on("complete",this,function(){$Z(),$E.onLoaded($M)}),$M.on("error",this,function(){$Z(),$M.dispose(),$E.event("error","Load sound failed")}),$M.load($I)},$M.onProgress=function($I){"atlas"===this._type?this.event("progress",.3*$I):this.event("progress",$I)},$M.onError=function($I){this.event("error",$I)},$M._loadedComplete=function($I,$M,$E){if(null!=$E)switch(this._type){case"atlas":case"plf":case"json":var $Z=new $k($E);this.onLoaded(JSON.parse($Z.readUTFBytes()));break;case"font":$Z=new $k($E);this.onLoaded($K.parseXMLFromString($Z.readUTFBytes()));break;default:this.onLoaded($E)}else this.event("error",$I)},$M.onLoaded=function($I){var $M=this._type;if("plf"==$M)this.parsePLFData($I),this.complete($I);else if("image"===$M){var $E=new $BI($I);$E.url=this._url,this.complete($E)}else if("sound"===$M||"htmlimage"===$M||"nativeimage"===$M)this.complete($I);else if("atlas"===$M){if(!$I.src&&!$I._setContext){if(!this._data){if((this._data=$I).meta&&$I.meta.image)for(var $Z=$I.meta.image.split(","),$i=0<=this._url.indexOf("/")?"/":"\\",$n=this._url.lastIndexOf($i),$c=0<=$n?this._url.substr(0,$n+1):"",$f=0,$d=$Z.length;$f<$d;$f++)$Z[$f]=$c+$Z[$f];else $Z=[this._url.replace(".json",".png")];$Z.reverse(),$I.toLoads=$Z,$I.pics=[]}return this.event("progress",.3+1/$Z.length*.6),this._loadImage($Z.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push($I),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var $H=this._data.frames,$B=this._url.split("?")[0],$A=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:$B.substring(0,$B.lastIndexOf("."))+"/",$Q=this._data.pics,$p=$L.formatURL(this._url),$t=$T.atlasMap[$p]||($T.atlasMap[$p]=[]);$t.dir=$A;var $V=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var $u in $V=parseFloat(this._data.meta.scale),$H){var $N,$y=$H[$u],$$=$Q[$y.frame.idx?$y.frame.idx:0],$w=$L.formatURL($A+$u);$$.scaleRate=$V,$N=$BI.create($$,$y.frame.x,$y.frame.y,$y.frame.w,$y.frame.h,$y.spriteSourceSize.x,$y.spriteSourceSize.y,$y.sourceSize.w,$y.sourceSize.h),$T.cacheRes($w,$N),$T.keepCache(this._url,$A+$u),$N.url=$w,$t.push($w)}else for($u in $H)$$=$Q[($y=$H[$u]).frame.idx?$y.frame.idx:0],$w=$L.formatURL($A+$u),$T.cacheRes($w,$BI.create($$,$y.frame.x,$y.frame.y,$y.frame.w,$y.frame.h,$y.spriteSourceSize.x,$y.spriteSourceSize.y,$y.sourceSize.w,$y.sourceSize.h)),$T.loadedMap[$w].url=$w,$T.keepCache(this._url,$A+$u),$t.push($w);delete this._data.pics,this.complete(this._data)}else if("font"==$M){if(!$I.src)return this._data=$I,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var $g=new $q;$g.parseFont(this._data,$I);var $O=this._url.split(".fnt")[0].split("/"),$a=$O[$O.length-1];$uI.registerBitmapFont($a,$g),this._data=$g,this.complete(this._data)}else if("pkm"==$M){var $m=$OI.create($I,this._url),$j=new $BI($m);$j.url=this._url,this.complete($j)}else this.complete($I)},$M.parsePLFData=function($I){var $M,$E,$Z;for($M in $I)switch($Z=$I[$M],$M){case"json":case"text":for($E in $Z)$T.preLoadedMap[$L.formatURL($E)]=$Z[$E];break;default:for($E in $Z)$T.preLoadedMap[$L.formatURL($E)]=$Z[$E]}},$M.complete=function($I){this._data=$I,this._customParse?this.event("loaded",$I instanceof Array?[$I]:$I):($T._loaders.push(this),$T._isWorking||$T.checkNext())},$M.endLoad=function($I){$I&&(this._data=$I),this._cache&&$T.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},$B(0,$M,"url",function(){return this._url}),$B(0,$M,"data",function(){return this._data}),$B(0,$M,"cache",function(){return this._cache}),$B(0,$M,"type",function(){return this._type}),$T.checkNext=function(){$T._isWorking=!0;for(var $I=$x.now();$T._startIndex<$T._loaders.length;)if($x.now(),$T._loaders[$T._startIndex].endLoad(),$T._startIndex++,$x.now()-$I>$T.maxTimeOut)return console.warn("loader callback cost a long time:"+($x.now()-$I)+" url="+$T._loaders[$T._startIndex-1].url),void $a.timer.frameOnce(1,null,$T.checkNext);$T._loaders.length=0,$T._startIndex=0,$T._isWorking=!1},$T.clearRes=function($I,$M){if(null!=$I){void 0===$M&&($M=!1),$I=$L.formatURL($I);var $E=$T.getAtlas($I);if($E){for(var $Z=0,$i=$E.length;$Z<$i;$Z++){var $n=$E[$Z],$c=$T.getRes($n);delete $T.loadedMap[$n],$T.clearCache($I.substring($L.basePath.length),$n.substring($L.basePath.length)),$c&&$c.destroy($M)}$E.length=0,delete $T.atlasMap[$I],delete $T.loadedMap[$I]}else{var $f=$T.loadedMap[$I];$f&&(delete $T.loadedMap[$I],$f instanceof laya.resource.Texture&&$f.bitmap&&$f.destroy($M))}}},$T.clearTextureRes=function($I){$I=$L.formatURL($I);var $M=laya.net.Loader.getAtlas($I),$E=$M&&0<$M.length?laya.net.Loader.getRes($M[0]):laya.net.Loader.getRes($I);$E&&$E.bitmap&&($o.isConchApp&&!$o.isConchWebGL?$E.bitmap.source.releaseTexture&&$E.bitmap.source.releaseTexture():null==$E.bitmap._atlaser&&$E.bitmap.releaseResource(!0))},$T.getRes=function($I){return $T.loadedMap[$L.formatURL($I)]},$T.getAtlas=function($I){return $T.atlasMap[$L.formatURL($I)]},$T.cacheRes=function($I,$M){$I=$L.formatURL($I),null!=$T.loadedMap[$I]?console.warn("Resources already exist,is repeated loading:",$I):$T.loadedMap[$I]=$M},$T.setGroup=function($I,$M){$T.groupMap[$M]||($T.groupMap[$M]=[]),$T.groupMap[$M].push($I)},$T.clearResByGroup=function($I){if($T.groupMap[$I]){var $M=$T.groupMap[$I],$E=0,$Z=$M.length;for($E=0;$E<$Z;$E++)$T.clearRes($M[$E]);$M.length=0}},$T.keepCache=function($I,$M){if($I&&$M){var $E=$T.cacheSet[$M];$E?-1==$E.indexOf($I)&&$E.push($I):$T.cacheSet[$M]=[$I]}},$T.clearCache=function($I,$M){if($I&&$M){var $E=$T.cacheSet[$M];if($E){var $Z=$E.indexOf($I);if(-1!==$Z){var $i=$E.length-1;0==$i?(delete $T.cacheSet[$M],0<$T.imgMgrSet[$M]?$c.imgMgrFree($M,$T.imgMgrSet[$M]):$T.clearRes($M,!0)):($E[$Z]=$E[$i],$E.length=$i)}}}},$T.saveObject=function($I,$M,$E){if($M&&$I){var $Z=$T.objectSet[$I];$Z?(console.warn("Loader.saveObject: "+$I),$Z[0]=$M,$Z[1]=$E):$T.objectSet[$I]=[$M,$E,[]]}},$T.findObject=function($I){if($I){var $M=$T.objectSet[$I];if($M)return $M[0]}return null},$T.keepObject=function($I,$M){if($I&&$M){var $E=$T.objectSet[$M];$E&&-1===$E[2].indexOf($I)&&$E[2].push($I)}},$T.clearObject=function($I,$M){if($I&&$M){var $E=$T.objectSet[$M];if($E){var $Z=$E[2],$i=$Z.indexOf($I);if(-1!==$i){var $n=$Z.length-1;0==$n?(delete $T.objectSet[$M],$E[1]&&$E[1].call(null,$E[0])):($Z[$i]=$Z[$n],$Z.length=$n)}}}},$T.TEXT="text",$T.JSON="json",$T.XML="xml",$T.BUFFER="arraybuffer",$T.IMAGE="image",$T.SOUND="sound",$T.ATLAS="atlas",$T.FONT="font",$T.TTF="ttf",$T.PLF="plf",$T.PKM="pkm",$T.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},$T.parserMap={},$T.groupMap={},$T.maxTimeOut=100,$T.loadedMap={},$T.preLoadedMap={},$T.atlasMap={},$T._loaders=[],$T._isWorking=!1,$T._startIndex=0,$T.imgCache={},$T.cacheSet={},$T.objectSet={},$T.imgMgrSet={},$T}(),$dI=function($I){var $Q;function $p(){this.retryNum=0,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._loaderMap={},this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},$p.__super.call(this);for(var $I=0;$I<this._maxPriority;$I++)this._resInfos[$I]=[]}$V($p,"laya.net.LoaderManager",$H);var $M=$p.prototype;return $M.create=function($I,$E,$M,$Z,$i,$n,$c,$f){if(null==$n&&($n=2),null==$c&&($c=!0),$I instanceof Array){var $d=$I,$H=$d.length,$B=0;if($M)var $A=$y.create($M.caller,$M.method,$M.args,!1);for(var $Q=0;$Q<$H;$Q++){var $p=$d[$Q];"string"==typeof $p&&($p=$d[$Q]={url:$p}),$p.progress=0}for($Q=0;$Q<$H;$Q++){$p=$d[$Q];var $t=$M?$y.create(null,$N,[$p],!1):null,$V=$M||$E?$y.create(null,$u,[$p]):null;this._create($p.url,$V,$t,$p.clas||$Z,$p.params||$i,null!=$p.priority&&0<=$p.priority?$p.priority:$n,$c,$p.group||$f)}function $u($I,$M){$B++,$I.progress=1,$B===$H&&$E&&$E.run()}function $N($I,$M){$I.progress=$M;for(var $E=0,$Z=0;$Z<$H;$Z++){$E+=$d[$Z].progress}var $i=$E/$H;$A.runWith($i)}return!0}return this._create($I,$E,$M,$Z,$i,$n,$c,$f)},$M._create=function($M,$E,$I,$Z,$i,$n,$c,$f){$M&&""!=$M||console.error("加载的url不合法 "+$M),null==$n&&($n=2),null==$c&&($c=!0);var $d=$L.formatURL($M),$H=this.getRes($d);if($H)!$H.hasOwnProperty("loaded")||$H.loaded?($I&&$I.runWith(1),$E&&$E.run()):$E&&$a.loader._createListener($M,$E.caller,$E.method,$E.args,!0,!1);else{var $B=$K.getFileExtension($M),$A=$p.createMap[$B];if(!$A)throw new Error("LoaderManager:unknown file("+$M+") extension with: "+$B+".");$Z||($Z=$A[0]);var $Q=$A[1];if("atlas"==$B)this.load($M,$E,$I,$Q,$n,$c);else{$Z===$BI&&($Q="htmlimage"),($H=$Z?new $Z:null).hasOwnProperty("_loaded")&&($H._loaded=!1),$H._setUrl($M),$f&&$H._setGroup($f),this._createLoad($H,$M,$y.create(null,function($I){$H&&!$H.destroyed&&$I&&$H.onAsynLoaded.call($H,$M,$I,$i),$E&&$E.run();$a.loader.event($M)}),$I,$Q,$n,!1,$f,!0),$c&&this.cacheRes($d,$H)}}return $H},$M.load=function($I,$M,$E,$Z,$i,$n,$c,$f){$I&&""!=$I||console.error("加载的url不合法 "+$I);var $d=this;if(null==$i&&($i=2),null==$n&&($n=!0),void 0===$f&&($f=!1),$I instanceof Array)return this._loadAssets($I,$M,$E,$Z,$i,$n,$c);var $H=$fI.getRes($I);if(null!=$H)$a.timer.frameOnce(1,null,function(){$E&&$E.runWith(1),$M&&$M.runWith($H),$d._loaderCount||$d.event("complete")});else{var $B=$p._resMap[$I];$B?($M&&$B._createListener("complete",$M.caller,$M.method,$M.args,!1,!1),$E&&$B._createListener("progress",$E.caller,$E.method,$E.args,!1,!1)):(($B=this._infoPool.length?this._infoPool.pop():new $Q).url=$I,$B.clas=null,$B.type=$Z,$B.cache=$n,$B.group=$c,$B.ignoreCache=$f,$B.priority=$i,$M&&$B.on("complete",$M.caller,$M.method,$M.args),$E&&$B.on("progress",$E.caller,$E.method,$E.args),$p._resMap[$I]=$B,$i=$i<this._maxPriority?0<=$i?$i:0:this._maxPriority-1,this._resInfos[$i].push($B),this._next())}return this},$M.cancel=function($I,$M,$E){if($H=$p._resMap[$I]){$M&&$H.off("complete",$M.caller,$M.method,!1),$E&&$H.off("progress",$E.caller,$E.method,!1);var $Z=$H.getListener("complete"),$i=$H.getListener("progress");if(!($Z&&$Z.head||$i&&$i.head)){if($H.loader){var $n=$H.loader;$n.imageCancel($I),$n.offAll(),$n._data=null,$n._customParse=!1,$n._url=null,$n._class=null,$n._type=null,this._loaders.push($n),this._loaderCount--,delete this._loaderMap[$H.url]}for(var $c=0;$c<this._maxPriority;$c++)for(var $f=this._resInfos[$c],$d=$f.length-1;-1<$d;$d--){var $H;($H=$f[$d])&&$H.url===$I&&($f[$d]=null,$H.destroy(),$H.offAll(),this._infoPool.push($H))}delete $p._resMap[$I],this._next()}}},$M._createLoad=function($I,$M,$E,$Z,$i,$n,$c,$f,$d){var $H=this;if(null==$n&&($n=2),null==$c&&($c=!0),void 0===$d&&($d=!1),$M instanceof Array)return this._loadAssets($M,$E,$Z,$i,$n,$c,$f);var $B=$fI.getRes($M);if(null!=$B)$a.timer.frameOnce(1,null,function(){$Z&&$Z.runWith(1),$E&&$E.runWith($B),$H._loaderCount||$H.event("complete")});else{var $A=$p._resMap[$M];$A?($E&&$A._createListener("complete",$E.caller,$E.method,$E.args,!1,!1),$Z&&$A._createListener("progress",$Z.caller,$Z.method,$Z.args,!1,!1)):(($A=this._infoPool.length?this._infoPool.pop():new $Q).url=$M,$A.clas=$I,$A.type=$i,$A.cache=$c,$A.group=$f,$A.ignoreCache=$d,$A.priority=$n,$E&&$A.on("complete",$E.caller,$E.method,$E.args),$Z&&$A.on("progress",$Z.caller,$Z.method,$Z.args),$p._resMap[$M]=$A,$n=$n<this._maxPriority?0<=$n?$n:0:this._maxPriority-1,this._resInfos[$n].push($A),this._next())}return this},$M._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var $I=0;$I<this._maxPriority;$I++)for(var $M=this._resInfos[$I];0<$M.length;){var $E=$M.shift();if($E)return this._doLoad($E)}this._loaderCount||this.event("complete")}},$M._doLoad=function($M){var $E=this._loaders.length?this._loaders.pop():new $fI;this._loaderCount++,(this._loaderMap[$M.url]=$E).on("complete",null,$i),$E.on("progress",null,function($I){$M.event("progress",$I)}),$E.on("error",null,function($I){$i(null)}),$M.loader=$E;var $Z=this;function $i($I){$E.offAll(),$E._data=null,$E._customParse=!1,$E._url=null,$E._class=null,$E._type=null,$Z._loaders.push($E),$Z._loaderCount--,delete $Z._loaderMap[$M.url],$Z._endLoad($M,$I instanceof Array?[$I]:$I),$Z._next()}$E._class=$M.clas,1<=$M.priority?($E.priority=$M.priority,$E.realTime=!1):($E.priority=0,$E.realTime=!0),$E.load($M.url,$M.type,$M.cache,$M.group,$M.ignoreCache)},$M._endLoad=function($I,$M){var $E=$I.url;if(null==$M){var $Z=this._failRes[$E]||0;if($Z<this.retryNum)return console.warn("[warn]Retry to load:",$E),this._failRes[$E]=$Z+1,void $a.timer.once(this.retryDelay,this,this._addReTry,[$I],!1);console.warn("[error]Failed to load:",$E),this.event("error",$E)}this._failRes[$E]&&(this._failRes[$E]=0),delete $p._resMap[$E],$I.event("complete",$M),$I.destroy(),$I.offAll(),this._infoPool.push($I)},$M._addReTry=function($I){this._resInfos[this._maxPriority-1].push($I),this._next()},$M.clearRes=function($I,$M){void 0===$M&&($M=!1),$fI.clearRes($I,$M)},$M.getRes=function($I){return $fI.getRes($I)},$M.cacheRes=function($I,$M){$fI.cacheRes($I,$M)},$M.clearTextureRes=function($I){$fI.clearTextureRes($I)},$M.setGroup=function($I,$M){$fI.setGroup($I,$M)},$M.clearResByGroup=function($I){$fI.clearResByGroup($I)},$M.clearUnLoaded=function(){for(var $I=0;$I<this._maxPriority;$I++){for(var $M=this._resInfos[$I],$E=$M.length-1;-1<$E;$E--){var $Z=$M[$E];$Z&&($Z.destroy(),$Z.offAll(),this._infoPool.push($Z))}$M.length=0}this._loaderCount=0,$p._resMap={}},$M.cancelLoadByUrls=function($I){if($I)for(var $M=0,$E=$I.length;$M<$E;$M++)this.cancelLoadByUrl($I[$M])},$M.cancelLoadByUrl=function($I){for(var $M=0;$M<this._maxPriority;$M++)for(var $E=this._resInfos[$M],$Z=$E.length-1;-1<$Z;$Z--){var $i=$E[$Z];$i&&$i.url===$I&&($E[$Z]=null,$i.destroy(),$i.offAll(),this._infoPool.push($i))}$p._resMap[$I]&&delete $p._resMap[$I]},$M._loadAssets=function($I,$E,$c,$M,$Z,$i,$n){null==$Z&&($Z=2),null==$i&&($i=!0);for(var $f=$I.length,$d=0,$H=0,$B=[],$A=!0,$Q=0;$Q<$f;$Q++){var $p=$I[$Q];if(!$p)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+$I);"string"==typeof $p&&($p={url:$p,type:$M,size:1,priority:$Z}),$p.size||($p.size=1),$p.progress=0,$H+=$p.size,$B.push($p);var $t=$c?$y.create(null,$N,[$p],!1):null,$V=$E||$c?$y.create(null,$u,[$p]):null;this.load($p.url,$V,$t,$p.type,null!=$p.priority&&0<=$p.priority?$p.priority:2,$i,$p.group||$n)}function $u($I,$M){$d++,$I.progress=1,$M||($A=!1),$d===$f&&$E&&$E.runWith($A)}function $N($I,$M){if(null!=$c){$I.progress=$M;for(var $E=0,$Z=0;$Z<$B.length;$Z++){var $i=$B[$Z];$E+=$i.size*$i.progress}var $n=$E/$H;$c.runWith($n)}}return this},$p.cacheRes=function($I,$M){$fI.cacheRes($I,$M)},$p._resMap={},$d($p,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),$p.__init$=function(){$Q=function($I){function $M(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=null,this.priority=-1,$M.__super.call(this)}return $V($M,"",$H),$M.prototype.destroy=function(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.loader=void 0,this.priority=-1},$M}()},$p}(),$HI=(function($I){function $i($I){$i.__super.call(this),$I||($I=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var $M=0,$E=0,$Z=0;$Z<20;$Z++)$Z%5!=4?this._mat[$M++]=$I[$Z]:this._alpha[$E++]=$I[$Z];this._action=$W.createFilterAction(32),this._action.data=this}$V($i,"laya.filters.ColorFilter",$N);var $M=$i.prototype;$a.imps($M,{"laya.filters.IFilter":!0}),$M.callNative=function($I){$I._$P.cf=this;$I.conchModel&&$I.conchModel.setFilterMatrix&&$I.conchModel.setFilterMatrix(this._mat,this._alpha)},$B(0,$M,"type",function(){return 32}),$B(0,$M,"action",function(){return this._action})}(),function($I){function $Z($I,$M,$E){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===$M&&($M=0),$Z.__super.call(this),this._byteClass=$E||$k,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,$I&&0<$M&&$M<65535&&this.connect($I,$M)}$V($Z,"laya.net.Socket",$H);var $M=$Z.prototype;$M.connect=function($I,$M){var $E="ws://"+$I+":"+$M;$E="https:"==$x.window.location.protocol?"wss://"+$I+":"+$M:"ws://"+$I+":"+$M,this.connectByUrl($E)},$M.connectByUrl=function($I){var $M=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new $x.window.WebSocket($I,this.protocols):this._socket=new $x.window.WebSocket($I),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function($I){$M._onOpen($I)},this._socket.onmessage=function($I){$M._onMessage($I)},this._socket.onclose=function($I){$M._onClose($I)},this._socket.onerror=function($I){$M._onError($I)}},$M.cleanSocket=function(){try{this._socket.close()}catch($I){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},$M.close=function(){if(null!=this._socket)try{this._socket.close()}catch($I){}},$M._onOpen=function($I){this._connected=!0,this.event("open",$I)},$M._onMessage=function($I){if($I&&$I.data){var $M=$I.data;if(this.disableInput&&$M)this.event("message",$M);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var $E=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,$M&&("string"==typeof $M?this._input.writeUTFBytes($M):this._input.writeArrayBuffer($M),this._addInputPosition=this._input.pos,this._input.pos=$E),this.event("message",$M)}}},$M._onClose=function($I){this._connected=!1,this.event("close",$I)},$M._onError=function($I){this.event("error",$I)},$M.send=function($I){this._socket.send($I)},$M.flush=function(){if(this._output&&0<this._output.length){var $M;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch($I){$M=$I}this._output.endian=this.endian,this._output.clear(),$M&&this.event("error",$M)}},$B(0,$M,"input",function(){return this._input}),$B(0,$M,"output",function(){return this._output}),$B(0,$M,"connected",function(){return this._connected}),$B(0,$M,"endian",function(){return this._endian},function($I){this._endian=$I,null!=this._input&&(this._input.endian=$I),null!=this._output&&(this._output.endian=$I)}),$Z.LITTLE_ENDIAN="littleEndian",$Z.BIG_ENDIAN="bigEndian"}(),function($I){function $f(){$f.__super.call(this),this._$1__id=++$f._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,($f._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,$J.currentResourceManager&&$J.currentResourceManager.addResource(this)}$V($f,"laya.resource.Resource",$H);var $M=$f.prototype;return $a.imps($M,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),$M._setUrl=function($I){var $M;this._url!==$I&&(this._url&&(($M=$f._urlResourcesMap[this._url]).splice($M.indexOf(this),1),0===$M.length&&delete $f._urlResourcesMap[this._url]),$I&&(($M=$f._urlResourcesMap[$I])||($f._urlResourcesMap[$I]=$M=[]),$M.push(this)),this._url=$I)},$M._getGroup=function(){return this._group},$M._setGroup=function($I){var $M;this._group!==$I&&(this._group&&(($M=$f._groupResourcesMap[this._group]).splice($M.indexOf(this),1),0===$M.length&&delete $f._groupResourcesMap[this._group]),$I&&(($M=$f._groupResourcesMap[$I])||($f._groupResourcesMap[$I]=$M=[]),$M.push(this)),this._group=$I)},$M._addReference=function(){this._referenceCount++},$M._removeReference=function(){this._referenceCount--},$M._clearReference=function(){this._referenceCount=0},$M._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},$M.recreateResource=function(){this.completeCreate()},$M.disposeResource=function(){},$M.activeResource=function($I){void 0===$I&&($I=!1),this._lastUseFrameCount=$D.loopCount,!this._destroyed&&this.__loaded&&(this._released||$I)&&this.recreateResource()},$M.releaseResource=function($I){return void 0===$I&&($I=!0),!(!$I&&this.lock)&&(!(this._released&&!$I)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},$M.onAsynLoaded=function($I,$M,$E){throw new Error("Resource: must override this function!")},$M.destroy=function(){var $I;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete $f._idResourcesMap[this.id],this._url&&(($I=$f._urlResourcesMap[this._url])&&($I.splice($I.indexOf(this),1),0===$I.length&&delete $f._urlResourcesMap[this.url]),$fI.clearRes(this._url),this.__loaded||$W.cancelLoadByUrl(this._url)),this._group&&(($I=$f._groupResourcesMap[this._group]).splice($I.indexOf(this),1),0===$I.length&&delete $f._groupResourcesMap[this.url]))},$M.completeCreate=function(){this._released=!1,this.event("recovered",this)},$M.dispose=function(){this.destroy()},$B(0,$M,"memorySize",function(){return this._memorySize},function($I){var $M=$I-this._memorySize;this._memorySize=$I,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,$M),this.resourceManager&&this.resourceManager.addSize($M)}),$B(0,$M,"_loaded",null,function($I){this.__loaded=$I}),$B(0,$M,"loaded",function(){return this.__loaded}),$B(0,$M,"id",function(){return this._$1__id}),$B(0,$M,"destroyed",function(){return this._destroyed}),$B(0,$M,"group",function(){return this._getGroup()},function($I){this._setGroup($I)}),$B(0,$M,"resourceManager",function(){return this._resourceManager}),$B(0,$M,"url",function(){return this._url}),$B(0,$M,"released",function(){return this._released}),$B(0,$M,"referenceCount",function(){return this._referenceCount}),$f.getResourceByID=function($I){return $f._idResourcesMap[$I]},$f.getResourceByURL=function($I,$M){return void 0===$M&&($M=0),null==$f._urlResourcesMap[$I]?null:$f._urlResourcesMap[$I][$M]},$f.getResourceCountByURL=function($I){return $f._urlResourcesMap[$I].length},$f.destroyUnusedResources=function($I){var $M;if($I){var $E=$f._groupResourcesMap[$I];if($E)for(var $Z=$E.slice(),$i=0,$n=$Z.length;$i<$n;$i++)($M=$Z[$i]).lock||0!==$M._referenceCount||$M.destroy()}else for(var $c in $f._idResourcesMap)($M=$f._idResourcesMap[$c]).lock||0!==$M._referenceCount||$M.destroy()},$f._uniqueIDCounter=0,$f._idResourcesMap={},$f._urlResourcesMap={},$f._groupResourcesMap={},$f}()),$BI=function($I){function $T($I,$M){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,$T.__super.call(this),$I&&null!=$I._addReference&&$I._addReference(),this.setTo($I,$M)}$V($T,"laya.resource.Texture",$H);var $M=$T.prototype;return $M._setUrl=function($I){this.url=$I},$M.setTo=function($I,$M){if($I instanceof $c.HTMLElement){var $E=$$I.create("2D",$I);this.bitmap=$E}else this.bitmap=$I;if(this.uv=$M||$T.DEF_UV,$I){this._w=$I.width,this._h=$I.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var $Z=this;if(this._loaded)$W.addToAtlas&&$W.addToAtlas($Z);else{var $i=$I;$i instanceof laya.resource.HTMLImage&&$i.image&&$i.image.addEventListener("load",function($I){$W.addToAtlas&&$W.addToAtlas($Z)},!1)}}},$M.active=function(){this.bitmap&&this.bitmap.activeResource()},$M.destroy=function($I){if(void 0===$I&&($I=!1),this.alphaTexture&&(this.alphaTexture.destroy($I),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var $M=this.bitmap;$I?($o.isConchApp&&$M.source&&$M.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$M.dispose(),$M._clearReference()):($M._removeReference(),0==$M.referenceCount&&($o.isConchApp&&$M.source&&$M.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,$M.dispose())),this.url&&this===$a.loader.getRes(this.url)&&$a.loader.clearRes(this.url,$I),this._loaded=!1}},$M.load=function($I){var $M=this;this._loaded=!1,$I=$L.customFormat($I);var $E=this.bitmap||(this.bitmap=$OI.create($I));$E.uri=$I,$E&&$E._addReference();var $Z=this;$E.onload=function(){$E.onload=null,$Z._loaded=!0,$M.sourceWidth=$M._w=$E.width,$M.sourceHeight=$M._h=$E.height,$Z.event("loaded",this),$W.addToAtlas&&$W.addToAtlas($Z)}},$M.addTextureToAtlas=function($I){$W.addTextureToAtlas(this)},$M.getPixels=function($I,$M,$E,$Z){if($o.isConchApp){var $i=this.bitmap;if($i.source&&$i.source.getImageData){var $n=$i.source.getImageData($I,$M,$E,$Z),$c=new Uint8Array($n);return Array.from($c)}return null}return $o.isWebGL?$W.getTexturePixels(this,$I,$M,$E,$Z):($x.canvas.size($E,$Z),$x.canvas.clear(),$x.context.drawTexture(this,-$I,-$M,this.width,this.height,0,0),$x.context.getImageData(0,0,$E,$Z).data)},$M.onAsynLoaded=function($I,$M){if($M){if("function"!=typeof $M._addReference)throw new Error("bitmap._addReference is not a function. "+$M.className+" "+typeof $M._addReference+" "+$M.constructor);$M._addReference()}this.setTo($M,this.uv),this._loaded&&this.event("loaded",this)},$B(0,$M,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),$B(0,$M,"loaded",function(){return this._loaded}),$B(0,$M,"released",function(){return!this.bitmap||this.bitmap.released}),$B(0,$M,"width",function(){return this._w?this._w:this.uv&&this.uv!==$T.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function($I){this._w=$I,this.sourceWidth||(this.sourceWidth=$I)}),$B(0,$M,"repeat",function(){return!$o.isWebGL||!this.bitmap||this.bitmap.repeat},function($I){$I&&$o.isWebGL&&this.bitmap&&(this.bitmap.repeat=$I)&&(this.bitmap.enableMerageInAtlas=!1)}),$B(0,$M,"height",function(){return this._h?this._h:this.uv&&this.uv!==$T.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function($I){this._h=$I,this.sourceHeight||(this.sourceHeight=$I)}),$B(0,$M,"isLinearSampling",function(){return!$o.isWebGL||9728!=this.bitmap.minFifter},function($I){!$I&&$o.isWebGL&&($I||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),$T.moveUV=function($I,$M,$E){for(var $Z=0;$Z<8;$Z+=2)$E[$Z]+=$I,$E[$Z+1]+=$M;return $E},$T.create=function($I,$M,$E,$Z,$i,$n,$c,$f,$d){void 0===$n&&($n=0),void 0===$c&&($c=0),void 0===$f&&($f=0),void 0===$d&&($d=0);var $H=$I instanceof laya.resource.Texture,$B=$H?$I.uv:$T.DEF_UV,$A=$H?$I.bitmap:$I,$Q=$W.isAtlas($A);if($Q){var $p=$A._atlaser,$t=$I._atlasID;if(-1==$t)throw new Error("create texture error");$A=$p._inAtlasTextureBitmapValue[$t],$B=$p._inAtlasTextureOriUVValue[$t]}var $V=new $T($A,null);$A.width&&$M+$Z>$A.width&&($Z=$A.width-$M),$A.height&&$E+$i>$A.height&&($i=$A.height-$E),$V.width=$Z,$V.height=$i,$V.offsetX=$n,$V.offsetY=$c,$V.sourceWidth=$f||$Z,$V.sourceHeight=$d||$i;var $u=1/$A.width,$N=1/$A.height;$M*=$u,$E*=$N,$Z*=$u,$i*=$N;var $y=$V.uv[0],$$=$V.uv[1],$w=$V.uv[4],$g=$V.uv[5],$O=$w-$y,$a=$g-$$,$m=$T.moveUV($B[0],$B[1],[$M,$E,$M+$Z,$E,$M+$Z,$E+$i,$M,$E+$i]);$V.uv=[$y+$m[0]*$O,$$+$m[1]*$a,$w-(1-$m[2])*$O,$$+$m[3]*$a,$w-(1-$m[4])*$O,$g-(1-$m[5])*$a,$y+$m[6]*$O,$g-(1-$m[7])*$a],$Q&&$V.addTextureToAtlas();var $j=$A.scaleRate;return $j&&1!=$j?($V.sourceWidth/=$j,$V.sourceHeight/=$j,$V.width/=$j,$V.height/=$j,$V.scaleRate=$j,$V.offsetX/=$j,$V.offsetY/=$j):$V.scaleRate=1,$V},$T.createFromTexture=function($I,$M,$E,$Z,$i){var $n=$I.scaleRate;1!=$n&&($M*=$n,$E*=$n,$Z*=$n,$i*=$n);var $c=$j.TEMP.setTo($M-$I.offsetX,$E-$I.offsetY,$Z,$i),$f=$c.intersection($T._rect1.setTo(0,0,$I.width,$I.height),$T._rect2);if(!$f)return null;var $d=$T.create($I,$f.x,$f.y,$f.width,$f.height,$f.x-$c.x,$f.y-$c.y,$Z,$i);if($d.bitmap&&$d.bitmap._removeReference)return $d.bitmap._removeReference(),$d;var $H="bitmap:"+($d.bitmap?$d.bitmap.constructor?$d.bitmap.constructor.name:$d.bitmap.__className:"")+", url:"+($I.url+" | "+($d.bitmap?$d.bitmap.url:$I.url))+", x="+$M+",y="+$E+",width="+$Z+",height="+$i+", result="+($f?$f.x+","+$f.y+","+$f.width+","+$f.height:"null")+", rect="+$c.x+","+$c.y+","+$c.width+","+$c.height;throw new Error("报错：bitmap._removeReference is not a function  "+$H)},$T.DEF_UV=[0,0,1,0,1,1,0,1],$T.INV_UV=[0,1,1,1,1,0,0,0],$T._rect1=new $j,$T._rect2=new $j,$T}(),$I=function($I){var $f;function $n(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,$n.__super.call(this)}$V($n,"laya.utils.TimeLine",$H);var $M=$n.prototype;return $M.to=function($I,$M,$E,$Z,$i){return void 0===$i&&($i=0),this._create($I,$M,$E,$Z,$i,!0)},$M.from=function($I,$M,$E,$Z,$i){return void 0===$i&&($i=0),this._create($I,$M,$E,$Z,$i,!1)},$M._create=function($I,$M,$E,$Z,$i,$n){var $c=$P.getItemByClass("tweenData",$f);return $c.isTo=$n,$c.type=0,$c.target=$I,$c.duration=$E,$c.data=$M,$c.startTime=this._startTime+$i,$c.endTime=$c.startTime+$c.duration,$c.ease=$Z,this._startTime=Math.max($c.endTime,this._startTime),this._tweenDataList.push($c),this._startTimeSort=!0,this._endTimeSort=!0,this},$M.addLabel=function($I,$M){var $E=$P.getItemByClass("tweenData",$f);return $E.type=1,$E.data=$I,$E.endTime=$E.startTime=this._startTime+$M,this._labelDic||(this._labelDic={}),this._labelDic[$I]=$E,this._tweenDataList.push($E),this},$M.removeLabel=function($I){if(this._labelDic&&this._labelDic[$I]){var $M=this._labelDic[$I];if($M){var $E=this._tweenDataList.indexOf($M);-1<$E&&this._tweenDataList.splice($E,1)}delete this._labelDic[$I]}},$M.gotoTime=function($I){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var $M,$E,$Z,$i;for(var $n in this._firstTweenDic)if($E=this._firstTweenDic[$n])for(var $c in $E)$E.diyTarget.hasOwnProperty($c)&&($E.diyTarget[$c]=$E[$c]);for($n in this._tweenDic)($M=this._tweenDic[$n]).clear(),delete this._tweenDic[$n];if(this._index=0,this._gidIndex=0,this._currTime=$I,this._lastTime=$x.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=$Z=this._tweenDataList.concat(),$Z.sort(function($I,$M){return $I.endTime>$M.endTime?1:$I.endTime<$M.endTime?-1:0})}else $Z=this._endTweenDataList;for(var $f=0,$d=$Z.length;$f<$d;$f++)if(0==($i=$Z[$f]).type){if(!($I>=$i.endTime))break;this._index=Math.max(this._index,$f+1);var $H=$i.data;if($i.isTo)for(var $B in $H)$i.target[$B]=$H[$B]}for($f=0,$d=this._tweenDataList.length;$f<$d;$f++)0==($i=this._tweenDataList[$f]).type&&$I>=$i.startTime&&$I<$i.endTime&&(this._index=Math.max(this._index,$f+1),this._gidIndex++,($M=$P.getItemByClass("tween",$Y))._create($i.target,$i.data,$i.duration,$i.ease,$y.create(this,this._animComplete,[this._gidIndex]),0,!1,$i.isTo,!0,!1),$M.setStartTime(this._currTime-($I-$i.startTime)),$M._updateEase(this._currTime),$M.gid=this._gidIndex,this._tweenDic[this._gidIndex]=$M)}},$M.gotoLabel=function($I){if(null!=this._labelDic){var $M=this._labelDic[$I];$M&&this.gotoTime($M.startTime)}},$M.pause=function(){$a.timer.clear(this,this._update)},$M.resume=function(){this.play(this._currTime,this._loopKey)},$M.play=function($I,$M){if(void 0===$I&&($I=0),void 0===$M&&($M=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function($I,$M){return $I.startTime>$M.startTime?1:$I.startTime<$M.startTime?-1:0});for(var $E=0,$Z=this._tweenDataList.length;$E<$Z;$E++){var $i=this._tweenDataList[$E];if(null!=$i&&0==$i.type){var $n=$i.target,$c=$n.$_GID||($n.$_GID=$K.getGID()),$f=null;for(var $d in null==this._firstTweenDic[$c]?(($f={}).diyTarget=$n,this._firstTweenDic[$c]=$f):$f=this._firstTweenDic[$c],$i.data)null==$f[$d]&&($f[$d]=$n[$d])}}}"string"==typeof $I?this.gotoLabel($I):this.gotoTime($I),this._loopKey=$M,this._lastTime=$x.now(),$a.timer.frameLoop(1,this,this._update)}},$M._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var $I in this._tweenDic)($M=this._tweenDic[$I]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var $M,$E=$x.now(),$Z=$E-this._lastTime,$i=this._currTime+=$Z*this.scale;for($I in this._lastTime=$E,this._tweenDic)($M=this._tweenDic[$I])._updateEase($i);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var $n=this._tweenDataList[this._index];$i>=$n.startTime&&(this._index++,0==$n.type?(this._gidIndex++,($M=$P.getItemByClass("tween",$Y))._create($n.target,$n.data,$n.duration,$n.ease,$y.create(this,this._animComplete,[this._gidIndex]),0,!1,$n.isTo,!0,!1),$M.setStartTime($i),$M.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=$M)._updateEase($i)):this.event("label",$n.data))}},$M._animComplete=function($I){this._tweenDic[$I]&&delete this._tweenDic[$I]},$M._complete=function(){this.event("complete")},$M.reset=function(){var $I;if(this._labelDic)for($I in this._labelDic)delete this._labelDic[$I];for($I in this._tweenDic)this._tweenDic[$I].clear(),delete this._tweenDic[$I];for($I in this._firstTweenDic)delete this._firstTweenDic[$I];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var $M,$E=0;for($M=this._tweenDataList.length,$E=0;$E<$M;$E++)this._tweenDataList[$E]&&this._tweenDataList[$E].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,$a.timer.clear(this,this._update)},$M.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},$B(0,$M,"index",function(){return this._frameIndex},function($I){this._frameIndex=$I,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),$B(0,$M,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),$n.to=function($I,$M,$E,$Z,$i){return void 0===$i&&($i=0),(new $n).to($I,$M,$E,$Z,$i)},$n.from=function($I,$M,$E,$Z,$i){return void 0===$i&&($i=0),(new $n).from($I,$M,$E,$Z,$i)},$n.__init$=function(){$f=function(){function $I(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return $V($I,""),$I.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,$P.recover("tweenData",this)},$I}()},$n}(),$AI=function($i){function $E(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,$E.__super.call(this),this._style=$f.EMPTY}$V($E,"laya.display.Sprite",$i);var $I=$E.prototype;return $a.imps($I,{"laya.display.ILayout":!0}),$I.createConchModel=function(){return new ConchNode},$I.destroy=function($I){if(void 0===$I&&($I=!0),this._releaseMem(),!this._destroyed){this.filters=null;var $M=this.mask;$M&&(this.mask=null,$M.destroy($I))}$i.prototype.destroy.call(this,$I),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},$I.updateZOrder=function(){$K.updateOrder(this._childs)&&this.repaint()},$I.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},$I.setBounds=function($I){this._set$P("uBounds",$I)},$I.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new $j),$j._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},$I.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new $j),$j._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},$I._boundPointsToParent=function($I){void 0===$I&&($I=!1);var $M=0,$E=0;this._style&&($M=this._style._tf.translateX,$E=this._style._tf.translateY,$I=$I||0!==this._style._tf.rotate,this._style.scrollRect&&($M+=this._style.scrollRect.x,$E+=this._style.scrollRect.y));var $Z=this._getBoundPointsM($I);if(!$Z||$Z.length<1)return $Z;if(8!=$Z.length&&($Z=$I?$g.scanPList($Z):$j._getWrapRec($Z,$j.TEMP)._getBoundPoints()),!this.transform)return $K.transPointList($Z,this._x-$M,this._y-$E),$Z;var $i=$m.TEMP,$n=0,$c=$Z.length;for($n=0;$n<$c;$n+=2)$i.x=$Z[$n],$i.y=$Z[$n+1],this.toParentPoint($i),$Z[$n]=$i.x,$Z[$n+1]=$i.y;return $Z},$I.getGraphicBounds=function($I){return void 0===$I&&($I=!1),this._graphics?this._graphics.getBounds($I):$j.TEMP.setTo(0,0,0,0)},$I._getBoundPointsM=function($I){if(void 0===$I&&($I=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var $M=$K.clearArray(this._$P.temBM),$E=$j.TEMP;return $E.copyFrom(this.scrollRect),$K.concatArray($M,$E._getBoundPoints()),$M}for(var $Z,$i,$n,$c=this._graphics?this._graphics.getBoundPoints():$K.clearArray(this._$P.temBM),$f=0,$d=($n=this._childs).length;$f<$d;$f++)($Z=$n[$f])instanceof laya.display.Sprite&&1==$Z.visible&&($i=$Z._boundPointsToParent($I))&&($c=$c?$K.concatArray($c,$i):$i);return $c},$I.getStyle=function(){return this._style===$f.EMPTY&&(this._style=new $f),this._style},$I.setStyle=function($I){this._style=$I},$I._adjustTransform=function(){this._tfChanged=!1;var $I,$M=this._style._tf,$E=$M.scaleX,$Z=$M.scaleY;if($M.rotate||1!==$E||1!==$Z||$M.skewX||$M.skewY){($I=this._transform||(this._transform=$R.create())).bTransform=!0;var $i=.0174532922222222*($M.rotate-$M.skewX),$n=.0174532922222222*($M.rotate+$M.skewY),$c=Math.cos($n),$f=Math.sin($n),$d=Math.sin($i),$H=Math.cos($i);return $I.a=$E*$c,$I.b=$E*$f,$I.c=-$Z*$d,$I.d=$Z*$H,$I.tx=$I.ty=0,$I}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,$I},$I.pos=function($I,$M,$E){if(void 0===$E&&($E=!1),this._x!==$I||this._y!==$M){if(this.destroyed)return this;if($E){this._x=$I,this._y=$M,this.conchModel&&this.conchModel.pos(this._x,this._y);var $Z=this._parent;$Z&&0===$Z._repaint&&($Z._repaint=1,$Z.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=$I,this.y=$M}return this},$I.pivot=function($I,$M){return this.pivotX=$I,this.pivotY=$M,this},$I.size=function($I,$M){return this.width=$I,this.height=$M,this},$I.scale=function($I,$M,$E){void 0===$E&&($E=!1);var $Z=this.getStyle(),$i=$Z._tf;if($i.scaleX!=$I||$i.scaleY!=$M){if(this.destroyed)return this;if($E){$Z.setScale($I,$M),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($I,$M),this._renderType|=4;var $n=this._parent;$n&&0===$n._repaint&&($n._repaint=1,$n.parentRepaint())}else this.scaleX=$I,this.scaleY=$M}return this},$I.skew=function($I,$M){return this.skewX=$I,this.skewY=$M,this},$I.render=function($I,$M,$E){$D.spriteCount++,$X.renders[this._renderType]._fun(this,$I,$M+this._x,$E+this._y),this._repaint=0},$I.drawToCanvas=function($I,$M,$E,$Z){if($o.isConchNode){var $i=$$I.create("2D");return new $S($I,$M,$i).ctx.setCanvasType(1),this.conchModel.drawToCanvas($i.source,$E,$Z),$i}return $W.drawToCanvas(this,this._renderType,$I,$M,$E,$Z)},$I.customRender=function($I,$M,$E){this._renderType|=1024},$I._applyFilters=function(){var $I;if(!$o.isWebGL&&(($I=this._$P.filters)&&!($I.length<1)))for(var $M=0,$E=$I.length;$M<$E;$M++)$I[$M].action.apply(this._$P.cacheCanvas)},$I._isHaveGlowFilter=function(){var $I,$M=0;if(this.filters)for($M=0;$M<this.filters.length;$M++)if(8==this.filters[$M].type)return!0;for($M=0,$I=this._childs.length;$M<$I;$M++)if(this._childs[$M]._isHaveGlowFilter())return!0;return!1},$I.localToGlobal=function($I,$M){void 0===$M&&($M=!1),!0===$M&&($I=new $m($I.x,$I.y));for(var $E=this;$E&&$E!=$a.stage;)$I=$E.toParentPoint($I),$E=$E.parent;return $I},$I.globalToLocal=function($I,$M){void 0===$M&&($M=!1),$M&&($I=new $m($I.x,$I.y));for(var $E=this,$Z=[];$E&&$E!=$a.stage;)$Z.push($E),$E=$E.parent;for(var $i=$Z.length-1;0<=$i;)$I=($E=$Z[$i]).fromParentPoint($I),$i--;return $I},$I.toParentPoint=function($I){if(!$I)return $I;$I.x-=this.pivotX,$I.y-=this.pivotY,this.transform&&this._transform.transformPoint($I),$I.x+=this._x,$I.y+=this._y;var $M=this._style.scrollRect;return $M&&($I.x-=$M.x,$I.y-=$M.y),$I},$I.fromParentPoint=function($I){if(!$I)return $I;$I.x-=this._x,$I.y-=this._y;var $M=this._style.scrollRect;return $M&&($I.x+=$M.x,$I.y+=$M.y),this.transform&&this._transform.invertTransformPoint($I),$I.x+=this.pivotX,$I.y+=this.pivotY,$I},$I.on=function($I,$M,$E,$Z){return 1!==this._mouseEnableState&&this.isMouseEvent($I)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($I,$M,$E,$Z,!1)):$i.prototype.on.call(this,$I,$M,$E,$Z)},$I.once=function($I,$M,$E,$Z){return 1!==this._mouseEnableState&&this.isMouseEvent($I)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener($I,$M,$E,$Z,!0)):$i.prototype.once.call(this,$I,$M,$E,$Z)},$I._$2__onDisplay=function(){if(1!==this._mouseEnableState){var $I=this;for($I=$I.parent;$I&&1!==$I._mouseEnableState&&!$I._getBit(2);)$I.mouseEnabled=!0,$I._setBit(2,!0),$I=$I.parent}},$I.loadImage=function($I,$M,$E,$Z,$i,$n){var $c=this;return void 0===$M&&($M=0),void 0===$E&&($E=0),void 0===$Z&&($Z=0),void 0===$i&&($i=0),this.graphics.loadImage($I,$M,$E,$Z,$i,function($I){$c.destroyed||($c.size($M+($Z||$I.width),$E+($i||$I.height)),$c.repaint(),$n&&$n.runWith($I))}),this},$I.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},$I._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},$I._childChanged=function($I){this._childs.length?this._renderType|=2048:this._renderType&=-2049,$I&&this._get$P("hasZorder")&&$a.timer.callLater(this,this.updateZOrder),this.repaint()},$I.parentRepaint=function(){var $I=this._parent;$I&&0===$I._repaint&&($I._repaint=1,$I.parentRepaint())},$I.startDrag=function($I,$M,$E,$Z,$i,$n,$c){void 0===$M&&($M=!1),void 0===$E&&($E=0),void 0===$Z&&($Z=300),void 0===$n&&($n=!1),void 0===$c&&($c=.92),this._$P.dragging||this._set$P("dragging",new $e),this._$P.dragging.start(this,$I,$M,$E,$Z,$i,$n,$c)},$I.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},$I._releaseMem=function(){if(this._$P){var $I=this._$P.cacheCanvas;$I&&$I.ctx&&($P.recover("RenderContext",$I.ctx),$I.ctx.canvas.size(0,0),$I.ctx=null);var $M=this._$P._filterCache;$M&&($M.destroy(),$M.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},$I._setDisplay=function($I){$I||this._releaseMem(),$i.prototype._setDisplay.call(this,$I)},$I.hitTestPoint=function($I,$M){var $E=this.globalToLocal($m.TEMP.setTo($I,$M));return $I=$E.x,$M=$E.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?$j.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains($I,$M)},$I.getMousePoint=function(){return this.globalToLocal($m.TEMP.setTo($a.stage.mouseX,$a.stage.mouseY))},$I._getWords=function(){return null},$I._addChildsToLayout=function($I){var $M=this._getWords();if(null==$M&&0==this._childs.length)return!1;if($M)for(var $E=0,$Z=$M.length;$E<$Z;$E++)$I.push($M[$E]);$E=0;for(var $i=this._childs.length;$E<$i;++$E){var $n=this._childs[$E];$n._style._enableLayout()&&$n._addToLayout($I)}return!0},$I._addToLayout=function($I){this._style.absolute||(this._style.block?$I.push(this):this._addChildsToLayout($I)&&(this.x=this.y=0))},$I._isChar=function(){return!1},$I._getCSSStyle=function(){return this._style.getCSSStyle()},$I._setAttributes=function($I,$M){switch($I){case"x":this.x=parseFloat($M);break;case"y":this.y=parseFloat($M);break;case"width":this.width=parseFloat($M);break;case"height":this.height=parseFloat($M);break;default:this[$I]=$M}},$I._layoutLater=function(){this.parent&&this.parent._layoutLater()},$B(0,$I,"optimizeScrollRect",function(){return this._optimizeScrollRect},function($I){this._optimizeScrollRect!=$I&&(this._optimizeScrollRect=$I,this.conchModel&&this.conchModel.optimizeScrollRect($I))}),$B(0,$I,"customRenderEnable",null,function($I){if($I&&(this._renderType|=1024,$o.isConchNode)){$E.CustomList.push(this);var $M=new $$I("2d");$M._setContext(new CanvasRenderingContext2D),this.customContext=new $S(0,0,$M),$M.context.setCanvasType&&$M.context.setCanvasType(2),this.conchModel.custom($M.context)}}),$B(0,$I,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function($I){this.cacheAs=$I?this._$P.hasFilter?"none":"normal":"none"}),$B(0,$I,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function($I){var $M=this._$P.cacheCanvas;if($I!==($M?$M.type:"none")){if("none"!==$I)this._getBit(1)||this._setUpNoticeType(1),$M||($M=this._set$P("cacheCanvas",$P.getItemByClass("cacheCanvas",Object))),$M.type=$I,$M.reCache=!0,this._renderType|=16,"bitmap"==$I&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if($M){var $E=$M;$E&&$E.ctx&&($P.recover("RenderContext",$E.ctx),$E.ctx.canvas.size(0,0),$E.ctx=null),$P.recover("cacheCanvas",$M)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),$B(0,$I,"zOrder",function(){return this._zOrder},function($I){this._zOrder!=$I&&(this._zOrder=$I,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder($I),this._parent&&($I&&this._parent._set$P("hasZorder",!0),$a.timer.callLater(this._parent,this.updateZOrder)))}),$B(0,$I,"rotation",function(){return this._style._tf.rotate},function($I){var $M=this.getStyle();if($M._tf.rotate!==$I){$M.setRotate($I),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate($I),this._renderType|=4;var $E=this._parent;$E&&0===$E._repaint&&($E._repaint=1,$E.parentRepaint())}}),$B(0,$I,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($I){this._width!==$I&&(this._width=$I,this.conchModel&&this.conchModel.size($I,this._height),this.repaint())}),$B(0,$I,"x",function(){return this._x},function($I){if(this._x!==$I){if(this.destroyed)return;this._x=$I,this.conchModel&&this.conchModel.pos($I,this._y);var $M=this._parent;$M&&0===$M._repaint&&($M._repaint=1,$M.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$B(0,$I,"globalScaleY",function(){for(var $I=1,$M=this;$M&&$M!==$a.stage;)$I*=$M.scaleY,$M=$M.parent;return $I}),$B(0,$I,"hitArea",function(){return this._$P.hitArea},function($I){this._set$P("hitArea",$I)}),$B(0,$I,"staticCache",function(){return this._$P.staticCache},function($I){this._set$P("staticCache",$I),$I||this.reCache()}),$B(0,$I,"texture",function(){return this._texture},function($I){this._texture!=$I&&(this._texture=$I,this.graphics.cleanByTexture($I,0,0))}),$B(0,$I,"y",function(){return this._y},function($I){if(this._y!==$I){if(this.destroyed)return;this._y=$I,this.conchModel&&this.conchModel.pos(this._x,$I);var $M=this._parent;$M&&0===$M._repaint&&($M._repaint=1,$M.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),$B(0,$I,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($I){this._height!==$I&&(this._height=$I,this.conchModel&&this.conchModel.size(this._width,$I),this.repaint())}),$B(0,$I,"blendMode",function(){return this._style.blendMode},function($I){this.getStyle().blendMode=$I,this.conchModel&&this.conchModel.blendMode($I),$I&&"source-over"!=$I?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),$B(0,$I,"scaleX",function(){return this._style._tf.scaleX},function($I){var $M=this.getStyle();if($M._tf.scaleX!==$I){$M.setScaleX($I),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($I,$M._tf.scaleY),this._renderType|=4;var $E=this._parent;$E&&0===$E._repaint&&($E._repaint=1,$E.parentRepaint())}}),$B(0,$I,"scaleY",function(){return this._style._tf.scaleY},function($I){var $M=this.getStyle();if($M._tf.scaleY!==$I){$M.setScaleY($I),this._tfChanged=!0,this.conchModel&&this.conchModel.scale($M._tf.scaleX,$I),this._renderType|=4;var $E=this._parent;$E&&0===$E._repaint&&($E._repaint=1,$E.parentRepaint())}}),$B(0,$I,"stage",function(){return $a.stage}),$B(0,$I,"skewX",function(){return this._style._tf.skewX},function($I){var $M=this.getStyle();if($M._tf.skewX!==$I){$M.setSkewX($I),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($I,$M._tf.skewY),this._renderType|=4;var $E=this._parent;$E&&0===$E._repaint&&($E._repaint=1,$E.parentRepaint())}}),$B(0,$I,"scrollRect",function(){return this._style.scrollRect},function($I){this.getStyle().scrollRect=$I,this.repaint(),$I?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect($I.x,$I.y,$I.width,$I.height)):(this._renderType&=-129,this.conchModel&&($E.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),$B(0,$I,"skewY",function(){return this._style._tf.skewY},function($I){var $M=this.getStyle();if($M._tf.skewY!==$I){$M.setSkewY($I),this._tfChanged=!0,this.conchModel&&this.conchModel.skew($M._tf.skewX,$I),this._renderType|=4;var $E=this._parent;$E&&0===$E._repaint&&($E._repaint=1,$E.parentRepaint())}}),$B(0,$I,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function($I){this._tfChanged=!1,(this._transform=$I)&&(this._x=$I.tx,this._y=$I.ty,$I.tx=$I.ty=0,this.conchModel&&this.conchModel.transform($I.a,$I.b,$I.c,$I.d,this._x,this._y)),$I?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),$B(0,$I,"pivotX",function(){return this._style._tf.translateX},function($I){this.getStyle().setTranslateX($I),this.conchModel&&this.conchModel.pivot($I,this._style._tf.translateY),this.repaint()}),$B(0,$I,"pivotY",function(){return this._style._tf.translateY},function($I){this.getStyle().setTranslateY($I),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,$I),this.repaint()}),$B(0,$I,"alpha",function(){return this._style.alpha},function($I){this._style&&this._style.alpha!==$I&&($I=$I<0?0:1<$I?1:$I,this.getStyle().alpha=$I,this.conchModel&&this.conchModel.alpha($I),1!==$I?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),$B(0,$I,"visible",function(){return this._style.visible},function($I){this._style&&this._style.visible!==$I&&(this.getStyle().visible=$I,this.conchModel&&this.conchModel.visible($I),this.parentRepaint())}),$B(0,$I,"graphics",function(){return this._graphics||(this.graphics=$W.createGraphics())},function($I){this._graphics&&(this._graphics._sp=null),(this._graphics=$I)?(this._renderType&=-2,this._renderType|=512,($I._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&($E.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),$B(0,$I,"filters",function(){return this._$P.filters},function($I){$I&&0===$I.length&&($I=null),this._$P.filters!=$I&&(this._set$P("filters",$I?$I.slice():null),$o.isConchApp&&(this.conchModel&&($E.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),$o.isWebGL&&($I&&$I.length?this._renderType|=32:this._renderType&=-33),$I&&0<$I.length?(this._getBit(1)||this._setUpNoticeType(1),$o.isWebGL&&1==$I.length&&$I[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&($o.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),$B(0,$I,"parent",$i.prototype._$get_parent,function($I){$a.superSet($II,this,"parent",$I),$I&&this._getBit(2)&&this._$2__onDisplay()}),$B(0,$I,"mask",function(){return this._$P._mask},function($I){$I&&this.mask&&this.mask._$P.maskParent||($I?(this.cacheAs="bitmap",this._set$P("_mask",$I),$I._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",$I),this.cacheAs="none"),this.conchModel&&this.conchModel.mask($I?$I.conchModel:null),this._renderType|=64,this.parentRepaint())}),$B(0,$I,"mouseEnabled",function(){return 1<this._mouseEnableState},function($I){this._mouseEnableState=$I?2:1}),$B(0,$I,"globalScaleX",function(){for(var $I=1,$M=this;$M&&$M!==$a.stage;)$I*=$M.scaleX,$M=$M.parent;return $I}),$B(0,$I,"mouseX",function(){return this.getMousePoint().x}),$B(0,$I,"mouseY",function(){return this.getMousePoint().y}),$E.fromImage=function($I){return(new $E).loadImage($I)},$E._cachePool=[],$E.CustomList=[],$d($E,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=$c.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),$E}($II),$QI=function($I){function $M($I){this._audio=null,this._onEnd=null,this._resumePlay=null,$M.__super.call(this),this._onEnd=$K.bind(this.__onEnd,this),this._resumePlay=$K.bind(this.__resumePlay,this),$I.addEventListener("ended",this._onEnd),this._audio=$I}$V($M,"laya.media.h5audio.AudioSoundChannel",$ZI);var $E=$M.prototype;return $E.__onEnd=function(){if(1==this.loops)return this.completeHandler&&($a.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$E.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,$x.container.appendChild(this._audio),this._audio.play()}catch($I){this.event("error")}},$E.play=function($I){this.isStopped=!1;try{this._audio.playbackRate=$v.playbackRate,this._audio.currentTime=this.startTime}catch($I){return void this._audio.addEventListener("canplay",this._resumePlay)}$v.addChannel(this),$x.container.appendChild(this._audio),!$I&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},$E.stop=function(){this.isStopped=!0,$v.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&$o.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),$x.onIE||this._audio!=$EI._musicAudio&&$P.recover("audio:"+this.url,this._audio),$x.removeElement(this._audio),this._audio=null)},$E.pause=function(){this.isStopped=!0,$v.removeChannel(this),"pause"in this._audio&&this._audio.pause()},$E.resume=function(){this._audio&&(this.isStopped=!1,$v.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},$B(0,$E,"position",function(){return this._audio?this._audio.currentTime:0}),$B(0,$E,"duration",function(){return this._audio?this._audio.duration:0}),$B(0,$E,"volume",function(){return this._audio?this._audio.volume:1},function($I){this._audio&&(this._audio.volume=$I)}),$M}(),$pI=function($I){function $M(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=$nI.ctx,$M.__super.call(this),this._onPlayEnd=$K.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}$V($M,"laya.media.webaudio.WebAudioSoundChannel",$ZI);var $E=$M.prototype;return $E.play=function($I){if($v.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var $M=this.context,$E=this.gain,$Z=$M.createBufferSource();(this.bufferSource=$Z).buffer=this.audioBuffer,$Z.connect($E),$E&&$E.disconnect(),$E.connect($M.destination),$Z.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=$x.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&($Z.loop=!0),$Z.playbackRate.setTargetAtTime?$Z.playbackRate.setTargetAtTime($v.playbackRate,this.context.currentTime,.1):$Z.playbackRate.value=$v.playbackRate,$Z.start(0,this.startTime),!$I&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},$E.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&($a.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},$E._clearBufferSource=function(){if(this.bufferSource){var $I=this.bufferSource;$I.stop?$I.stop(0):$I.noteOff(0),$I.disconnect(0),$I.onended=null,$M._tryCleanFailed||this._tryClearBuffer($I),this.bufferSource=null}},$E._tryClearBuffer=function($I){try{$I.buffer=null}catch($I){$M._tryCleanFailed=!0}},$E.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,$v.removeChannel(this),this.startHandler=null,this.completeHandler=null},$E.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,$v.removeChannel(this)},$E.resume=function(){this.startTime=this._pauseTime,this.play(!1)},$B(0,$E,"position",function(){return this.bufferSource?($x.now()-this._startTime)/1e3+this.startTime:0}),$B(0,$E,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),$B(0,$E,"volume",function(){return this._volume},function($I){this.isStopped||(this._volume=$I,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime($I,this.context.currentTime,.1):this.gain.gain.value=$I)}),$M._tryCleanFailed=!1,$M}(),$tI=function($I){function $M(){$M.__super.call(this),this._w=0,this._h=0}$V($M,"laya.resource.Bitmap",$HI);var $E=$M.prototype;return $B(0,$E,"width",function(){return this._w}),$B(0,$E,"height",function(){return this._h}),$B(0,$E,"source",function(){return this._source}),$M}(),$VI=function($M){function $I(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,$I.__super.call(this),this._interval=$Z.animationInterval,this._setUpNoticeType(1)}$V($I,"laya.display.AnimationPlayerBase",$M);var $E=$I.prototype;return $E.play=function($I,$M,$E,$Z){void 0===$I&&($I=0),void 0===$M&&($M=!0),void 0===$E&&($E=""),void 0===$Z&&($Z=!0),this._isPlaying=!0,this.index="string"==typeof $I?this._getFrameByLabel($I):$I,this.loop=$M,this._actionName=$E,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$E._getFrameByLabel=function($I){var $M=0;for($M=0;$M<this._count;$M++)if(this._labels[$M]&&0<=this._labels[$M].indexOf($I))return $M;return 0},$E._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},$E._setControlNode=function($I){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=$I)&&$I!=this&&($I.on("display",this,this._checkResumePlaying),$I.on("undisplay",this,this._checkResumePlaying))},$E._setDisplay=function($I){$M.prototype._setDisplay.call(this,$I),this._checkResumePlaying()},$E._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},$E.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},$E.addLabel=function($I,$M){this._labels||(this._labels={}),this._labels[$M]||(this._labels[$M]=[]),this._labels[$M].push($I)},$E.removeLabel=function($I){if($I){if(this._labels)for(var $M in this._labels)this._removeLabelFromLabelList(this._labels[$M],$I)}else this._labels=null},$E._removeLabelFromLabelList=function($I,$M){if($I)for(var $E=$I.length-1;0<=$E;$E--)$I[$E]==$M&&$I.splice($E,1)},$E.gotoAndStop=function($I){this.index="string"==typeof $I?this._getFrameByLabel($I):$I,this.stop()},$E._displayToIndex=function($I){},$E.clear=function(){this.stop(),this._labels=null},$B(0,$E,"interval",function(){return this._interval},function($I){this._interval!=$I&&(this._frameRateChanged=!0,this._interval=$I,this._isPlaying&&0<$I&&this.timerLoop($I,this,this._frameLoop,null,!0,!0))}),$B(0,$E,"isPlaying",function(){return this._isPlaying}),$B(0,$E,"index",function(){return this._index},function($I){if(this._index=$I,this._displayToIndex($I),this._labels&&this._labels[$I])for(var $M=this._labels[$I],$E=0,$Z=$M.length;$E<$Z;$E++)this.event("label",$M[$E])}),$B(0,$E,"count",function(){return this._count}),$I.WRAP_POSITIVE=0,$I.WRAP_REVERSE=1,$I.WRAP_PINGPONG=2,$I}($AI),$uI=function($M){function $p(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,$p.__super.call(this),this.overflow=$p.VISIBLE,this._style=new $MI(this),this._style.wordWrap=!1}$V($p,"laya.display.Text",$M);var $I=$p.prototype;return $I.destroy=function($I){void 0===$I&&($I=!0),$M.prototype.destroy.call(this,$I),this._lines=null,this._words&&(this._words.length=0,this._words=null)},$I._getBoundPointsM=function($I){void 0===$I&&($I=!1);var $M=$j.TEMP;return $M.setTo(0,0,this.width,this.height),$M._getBoundPoints()},$I.getGraphicBounds=function($I){void 0===$I&&($I=!1);var $M=$j.TEMP;return $M.setTo(0,0,this.width,this.height),$M},$I._getCSSStyle=function(){return this._style},$I.lang=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B){if($I=$p.langPacks&&$p.langPacks[$I]?$p.langPacks[$I]:$I,arguments.length<2)this._text=$I;else{for(var $A=0,$Q=arguments.length;$A<$Q;$A++)$I=$I.replace("{"+$A+"}",arguments[$A+1]);this._text=$I}},$I._isPassWordMode=function(){var $I=this._style.password;return"prompt"in this&&this.prompt==this._text&&($I=!1),$I},$I._getPassWordTxt=function($I){var $M;$M="";for(var $E=$I.length;0<$E;$E--)$M+="●";return $M},$I.renderText=function($I,$M){var $E=this.graphics;$E.clear(!0);var $Z=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+($x.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);$x.context.font=$Z;var $i=this.padding,$n=$i[3],$c="left",$f=this._lines,$d=this.leading+this._charSize.height,$H=this._currBitmapFont;$H&&($d=this.leading+$H.getMaxHeight());var $B=$i[0];if(!$H&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?($c="right",$n=this._width-$i[1]):"center"==this.align&&($c="center",$n=.5*this._width+$i[3]-$i[1])),0<this._height){var $A=this._textHeight>this._height?"top":this.valign;"middle"===$A?$B=.5*(this._height-$M*$d)+$i[0]-$i[2]:"bottom"===$A&&($B=this._height-$M*$d-$i[2])}var $Q=this._style;if($H&&$H.autoScaleSize)var $p=$H.fontSize/this.fontSize;if(this._clipPoint)if($E.save(),$H&&$H.autoScaleSize){var $t=0,$V=0;$t=this._width?this._width-$i[3]-$i[1]:this._textWidth,$V=this._height?this._height-$i[0]-$i[2]:this._textHeight,$t*=$p,$V*=$p,$E.clipRect($i[3],$i[0],$t,$V)}else $E.clipRect($i[3],$i[0],this._width?this._width-$i[3]-$i[1]:this._textWidth,this._height?this._height-$i[0]-$i[2]:this._textHeight);var $u=$Q.password;"prompt"in this&&this.prompt==this._text&&($u=!1);for(var $N=0,$y=0,$$=Math.min(this._lines.length,$M+$I)||1,$w=$I;$w<$$;$w++){var $g,$O=$f[$w];if($u){var $a=$O.length;$O="";for(var $m=$a;0<$m;$m--)$O+="●"}if($N=$n-(this._clipPoint?this._clipPoint.x:0),$y=$B+$d*$w-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline($c,$N,$y,$w),$H){var $j=this.width;$H.autoScaleSize&&($j=this.width*$p),$H.drawText($O,this,$N,$y,this.align,$j)}else $o.isWebGL?(this._words||(this._words=[]),($g=this._words.length>$w-$I?this._words[$w-$I]:new $U).setText($O)):$g=$O,$Q.stroke?$E.fillBorderText($g,$N,$y,$Z,this.color,$Q.strokeColor,$Q.stroke,$c):$E.fillText($g,$N,$y,$Z,this.color,$c)}if($H&&$H.autoScaleSize){var $T=1/$p;this.scale($T,$T)}this._clipPoint&&$E.restore(),this._startX=$n,this._startY=$B},$I.drawUnderline=function($I,$M,$E,$Z){var $i=this._lineWidths[$Z];switch($I){case"center":$M-=$i/2;break;case"right":$M-=$i}$E+=this._charSize.height,this._graphics.drawLine($M,$E,$M+$i,$E,this.underlineColor||this.color,1)},$I.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);$x.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new $m(0,0)):this._clipPoint=null;var $I=this._lines.length;if(this.overflow!=$p.VISIBLE){var $M=this.overflow==$p.HIDDEN?Math.floor:Math.ceil;$I=Math.min($I,$M((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var $E=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText($E,$I),this.repaint()},$I.evalTextSize=function(){var $I,$M=NaN;$I=Math.max.apply(this,this._lineWidths),$M=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],$I==this._textWidth&&$M==this._textHeight||(this._textWidth=$I,this._textHeight=$M,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},$I.checkEnabledViewportOrNot=function(){return this.overflow==$p.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},$I.changeText=function($I){this._text!==$I&&(this.lang($I+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},$I.parseLines=function($I){var $M=this.wordWrap||this.overflow==$p.HIDDEN;if($M)var $E=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var $Z=$K.contextMeasureText($p._testWord);$o.isConchApp&&0===$Z.width&&0===$Z.height&&($Z=$K.contextMeasureText("W")),this._charSize.width=$Z.width,this._charSize.height=$Z.height||this.fontSize}for(var $i=$I.replace(/\r\n/g,"\n").split("\n"),$n=0,$c=$i.length;$n<$c;$n++){var $f=$i[$n];$M?this.parseLine($f,$E):(this._lineWidths.push(this.getTextWidth($f)),this._lines.push($f))}},$I.parseLine=function($I,$M){$x.context;var $E,$Z=this._lines,$i=0,$n=NaN,$c=NaN,$f=0;if(($n=this.getTextWidth($I))<=$M)return $Z.push($I),void this._lineWidths.push($n);$n=this._charSize.width,0==($i=Math.floor($M/$n))&&($i=1),$c=$n=this.getTextWidth($I.substring(0,$i));for(var $d=$i,$H=$I.length;$d<$H;$d++)if($M<($c+=$n=this.getTextWidth($I.charAt($d))))if(this.wordWrap){var $B=$I.substring($f,$d);if($B.charCodeAt($B.length-1)<255?($E=/(?:\w|-)+$/.exec($B))&&($d=$E.index+$f,0==$E.index?$d+=$B.length:$B=$I.substring($f,$d)):$p.RightToLeft&&($E=/([\u0600-\u06FF])+$/.exec($B))&&($d=$E.index+$f,0==$E.index?$d+=$B.length:$B=$I.substring($f,$d)),$Z.push($B),this._lineWidths.push($c-$n),!(($f=$d)+$i<$H)){$Z.push($I.substring($f,$H)),this._lineWidths.push(this.getTextWidth($Z[$Z.length-1])),$f=-1;break}$d+=$i,$c=$n=this.getTextWidth($I.substring($f,$d)),$d--}else if(this.overflow==$p.HIDDEN)return $Z.push($I.substring(0,$d)),void this._lineWidths.push(this.getTextWidth($Z[$Z.length-1]));this.wordWrap&&-1!=$f&&($Z.push($I.substring($f,$H)),this._lineWidths.push(this.getTextWidth($Z[$Z.length-1])))},$I.getTextWidth=function($I){return this._currBitmapFont?this._currBitmapFont.getTextWidth($I):$K.contextMeasureText($I).width},$I.getWordWrapWidth=function(){var $I=this.padding,$M=NaN;return($M=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&($M=this.wordWrap?100:$x.width),$M<=0&&($M=100),$M-$I[3]-$I[1]},$I.getCharPoint=function($I,$M){this._isChanged&&$a.timer.runCallLater(this,this.typeset);for(var $E=0,$Z=this._lines,$i=0,$n=0,$c=$Z.length;$n<$c;$n++){if($I<($E+=$Z[$n].length)){var $f=$n;break}$i=$E}var $d=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;$x.context.font=$d;var $H=this.getTextWidth(this._text.substring($i,$I));return($M||new $m).setTo(this._startX+$H-(this._clipPoint?this._clipPoint.x:0),this._startY+$f*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},$B(0,$I,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function($I){$I!=this._width&&($a.superSet($AI,this,"width",$I),this.isChanged=!0)}),$B(0,$I,"textWidth",function(){return this._isChanged&&$a.timer.runCallLater(this,this.typeset),this._textWidth}),$B(0,$I,"height",function(){return this._height?this._height:this.textHeight},function($I){$I!=this._height&&($a.superSet($AI,this,"height",$I),this.isChanged=!0)}),$B(0,$I,"textHeight",function(){return this._isChanged&&$a.timer.runCallLater(this,this.typeset),this._textHeight}),$B(0,$I,"padding",function(){return this._getCSSStyle().padding},function($I){this._getCSSStyle().padding=$I,this.isChanged=!0}),$B(0,$I,"bold",function(){return this._getCSSStyle().bold},function($I){this._getCSSStyle().bold=$I,this.isChanged=!0}),$B(0,$I,"text",function(){return this._text||""},function($I){this._text!==$I&&(this.lang($I+""),this.isChanged=!0,this.event("change"))}),$B(0,$I,"color",function(){return this._getCSSStyle().color},function($I){this._getCSSStyle().color!=$I&&(this._getCSSStyle().color=$I,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),$B(0,$I,"font",function(){return this._getCSSStyle().fontFamily},function($I){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),$p._bitmapFonts&&$p._bitmapFonts[$I]&&(this._currBitmapFont=$p._bitmapFonts[$I]),this._getCSSStyle().fontFamily=$I,this.isChanged=!0}),$B(0,$I,"fontSize",function(){return this._getCSSStyle().fontSize},function($I){this._getCSSStyle().fontSize=$I,this.isChanged=!0}),$B(0,$I,"italic",function(){return this._getCSSStyle().italic},function($I){this._getCSSStyle().italic=$I,this.isChanged=!0}),$B(0,$I,"align",function(){return this._getCSSStyle().align},function($I){this._getCSSStyle().align=$I,this.isChanged=!0}),$B(0,$I,"valign",function(){return this._getCSSStyle().valign},function($I){this._getCSSStyle().valign=$I,this.isChanged=!0}),$B(0,$I,"wordWrap",function(){return this._getCSSStyle().wordWrap},function($I){this._getCSSStyle().wordWrap=$I,this.isChanged=!0}),$B(0,$I,"leading",function(){return this._getCSSStyle().leading},function($I){this._getCSSStyle().leading=$I,this.isChanged=!0}),$B(0,$I,"bgColor",function(){return this._getCSSStyle().backgroundColor},function($I){this._getCSSStyle().backgroundColor=$I,this.isChanged=!0}),$B(0,$I,"borderColor",function(){return this._getCSSStyle().borderColor},function($I){this._getCSSStyle().borderColor=$I,this.isChanged=!0}),$B(0,$I,"stroke",function(){return this._getCSSStyle().stroke},function($I){this._getCSSStyle().stroke=$I,this.isChanged=!0}),$B(0,$I,"strokeColor",function(){return this._getCSSStyle().strokeColor},function($I){this._getCSSStyle().strokeColor=$I,this.isChanged=!0}),$B(0,$I,"isChanged",null,function($I){this._isChanged!==$I&&(this._isChanged=$I)&&$a.timer.callLater(this,this.typeset)}),$B(0,$I,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function($I){if(!(this.overflow!=$p.SCROLL||this.textWidth<this._width)&&this._clipPoint){$I=$I<this.padding[3]?this.padding[3]:$I;var $M=this._textWidth-this._width;$I=$M<$I?$M:$I;var $E=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=$I,this.renderText(this._lastVisibleLineIndex,$E)}}),$B(0,$I,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function($I){if(!(this.overflow!=$p.SCROLL||this.textHeight<this._height)&&this._clipPoint){$I=$I<this.padding[0]?this.padding[0]:$I;var $M=this._textHeight-this._height,$E=($I=$M<$I?$M:$I)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=$E;var $Z=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=$I,this.renderText($E,$Z)}}),$B(0,$I,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),$B(0,$I,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),$B(0,$I,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),$B(0,$I,"underlineColor",function(){return this._underlineColor},function($I){this._underlineColor=$I,this._isChanged=!0,this.typeset()}),$p.registerBitmapFont=function($I,$M){$p._bitmapFonts||($p._bitmapFonts={}),$p._bitmapFonts[$I]=$M},$p.unregisterBitmapFont=function($I,$M){if(void 0===$M&&($M=!0),$p._bitmapFonts&&$p._bitmapFonts[$I]){var $E=$p._bitmapFonts[$I];$M&&$E.destroy(),delete $p._bitmapFonts[$I]}},$p.setTextRightToLeft=function(){var $I;($I=$x.canvas.source.style).display="none",$I.position="absolute",$I.direction="rtl",$o._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,$x.document.body.appendChild($x.canvas.source)},$p.supportFont=function($I){$x.context.font="10px sans-serif";var $M=$K.contextMeasureText("abcji").width;$x.context.font="10px "+$I;var $E=$K.contextMeasureText("abcji").width;return console.log($M,$E),$M!==$E},$p._testWord="游",$p.langPacks=null,$p.VISIBLE="visible",$p.SCROLL="scroll",$p.HIDDEN="hidden",$p.CharacterCache=!0,$p.RightToLeft=!1,$p._bitmapFonts=null,$d($p,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),$p}($AI),$NI=function($A){function $c(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",$c.__super.call(this),this.offset=new $m,this._canvasTransform=new $R,this._previousOrientation=$x.window.orientation;var $M=this;this.transform=$R.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var $I=$x.window,$E=this;$I.addEventListener("focus",function(){$M._isFocused=!0,$E.event("focus"),$E.event("focuschange")}),$I.addEventListener("blur",function(){$M._isFocused=!1,$E.event("blur"),$E.event("focuschange"),$E._isInputting()&&($gI.inputElement.target.focus=!1)});var $Z="visibilityState",$i="visibilitychange",$n=$I.document;void 0!==$n.hidden?($i="visibilitychange",$Z="visibilityState"):void 0!==$n.mozHidden?($i="mozvisibilitychange",$Z="mozVisibilityState"):void 0!==$n.msHidden?($i="msvisibilitychange",$Z="msVisibilityState"):void 0!==$n.webkitHidden&&($i="webkitvisibilitychange",$Z="webkitVisibilityState"),$I.document.addEventListener($i,function(){"hidden"==$x.document[$Z]?$E._setStageVisible(!1):$E._setStageVisible(!0)}),$I.document.addEventListener("qbrowserVisibilityChange",function($I){$E._setStageVisible(!$I.hidden)}),$I.addEventListener("resize",function(){var $I=$x.window.orientation;null!=$I&&$I!=$M._previousOrientation&&$E._isInputting()&&($gI.inputElement.target.focus=!1),$M._previousOrientation=$I,$E._isInputting()||$E._resetCanvas()}),$I.addEventListener("orientationchange",function($I){$E._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),$x.onMobile&&this.on("mousedown",this,this._onmouseMove)}$V($c,"laya.display.Stage",$A);var $I=$c.prototype;return $I._setStageVisible=function($I){this._isVisibility!=$I&&(this._isVisibility=$I,this._isVisibility||this._isInputting()&&($gI.inputElement.target.focus=!1),this.event("visibilitychange"))},$I._isInputting=function(){return $x.onMobile&&$gI.isInputting},$I._changeCanvasSize=function(){this.setScreenSize($x.clientWidth*$x.pixelRatio,$x.clientHeight*$x.pixelRatio)},$I._resetCanvas=function(){if(this.screenAdaptationEnabled){var $I=$o._mainCanvas;$I.source.style;$I.size(1,1),$a.timer.once(100,this,this._changeCanvasSize)}},$I.setScreenSize=function($I,$M){var $E=!1;if("none"!==this._screenMode&&($E=($I/$M<1?"vertical":"horizontal")!==this._screenMode)){var $Z=$M;$M=$I,$I=$Z}this.canvasRotation=$E;var $i=$o._mainCanvas,$n=$i.source.style,$c=this._canvasTransform.identity(),$f=this._scaleMode,$d=$I/this.designWidth,$H=$M/this.designHeight,$B=this.designWidth,$A=this.designHeight,$Q=$I,$p=$M,$t=$x.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,$f){case"noscale":$d=$H=1,$Q=this.designWidth,$p=this.designHeight;break;case"showall":$d=$H=Math.min($d,$H),$B=$Q=Math.round(this.designWidth*$d),$A=$p=Math.round(this.designHeight*$H);break;case"noborder":$d=$H=Math.max($d,$H),$Q=Math.round(this.designWidth*$d),$p=Math.round(this.designHeight*$H);break;case"full":$d=$H=1,this._width=$B=$I,this._height=$A=$M;break;case"fixedwidth":$H=$d,this._height=$A=Math.round($M/$d);break;case"fixedheight":$d=$H,this._width=$B=Math.round($I/$H);break;case"fixedauto":$I/$M<this.designWidth/this.designHeight?($H=$d,this._height=$A=Math.round($M/$d)):($d=$H,this._width=$B=Math.round($I/$H))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,$B=$B+1&2147483646,$A=$A+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),$d*=this.scaleX,$H*=this.scaleY,1===$d&&1===$H?this.transform.identity():(this.transform.a=this._formatData($d/($Q/$B)),this.transform.d=this._formatData($H/($p/$A)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),$i.size($B,$A),$W.changeWebGLSize($B,$A),$c.scale($Q/$B/$t,$p/$A/$t),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=($I-$Q)/$t:this.offset.x=.5*($I-$Q)/$t,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=($M-$p)/$t:this.offset.y=.5*($M-$p)/$t,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),$c.translate(this.offset.x,this.offset.y),this.canvasDegree=0,$E&&("horizontal"===this._screenMode?($c.rotate(Math.PI/2),$c.translate($M/$t,0),this.canvasDegree=90):($c.rotate(-Math.PI/2),$c.translate(0,$I/$t),this.canvasDegree=-90)),$c.a=this._formatData($c.a),$c.d=this._formatData($c.d),$c.tx=this._formatData($c.tx),$c.ty=this._formatData($c.ty),$n.transformOrigin=$n.webkitTransformOrigin=$n.msTransformOrigin=$n.mozTransformOrigin=$n.oTransformOrigin="0px 0px 0px",$n.transform=$n.webkitTransform=$n.msTransform=$n.mozTransform=$n.oTransform="matrix("+$c.toString()+")",$c.translate(parseInt($n.left)||0,parseInt($n.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},$I._formatData=function($I){return Math.abs($I)<1e-6?0:Math.abs(1-$I)<.001?0<$I?1:-1:$I},$I.getMousePoint=function(){return $m.TEMP.setTo(this.mouseX,this.mouseY)},$I.repaint=function(){this._repaint=1},$I.parentRepaint=function(){},$I._loop=function(){return this.render($o.context,0,0),!0},$I._onmouseMove=function($I){this._mouseMoveTime=$x.now()},$I.getTimeFromFrameStart=function(){return $x.now()-this._frameStartTime},$I.render=function($I,$M,$E){if("sleep"===this._frameRate&&!$o.isConchApp){var $Z=$x.now();if(!(1e3<=$Z-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&($D.loopCount++,$t.instance.runEvent(),$a.timer._update()));this._frameStartTime=$Z}if(this._renderCount++,$o.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=$x.now();var $i="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),$n=this._renderCount%2==0;if($D.renderSlow=!$i,$i||$n||$o.isConchApp){var $c;$D.loopCount++,$t.instance.runEvent(),$a.timer._update(),$W.update3DLoop();var $f=0,$d=0;if($o.isConchNode)for($f=0,$d=this._scenes.length;$f<$d;$f++)($c=this._scenes[$f])&&$c._updateSceneConch();else for($f=0,$d=this._scenes.length;$f<$d;$f++)($c=this._scenes[$f])&&$c._updateScene();if($o.isConchNode){var $H=$AI.CustomList;for($f=0,$d=$H.length;$f<$d;$f++){var $B=$H[$f];$B.customRender($B.customContext,0,0)}return}}$o.isConchNode||this.renderingEnabled&&($i||!$n||$o.isConchWebGL)&&($o.isWebGL?$o.WebGL.mainContext&&!$o.WebGL.mainContext.isContextLost()&&($I.clear(),$A.prototype.render.call(this,$I,$M,$E),$D._show&&$D._sp&&$D._sp.render($I,$M,$E),$W.clear(this._bgColor),$W.beginFlush(),$I.flush(),$W.endFinish(),$s.instance&&$s.getInstance().endDispose()):($W.clear(this._bgColor),$A.prototype.render.call(this,$I,$M,$E),$D._show&&$D._sp&&$D._sp.render($I,$M,$E)))}else this._renderCount%5==0&&($D.loopCount++,$t.instance.runEvent(),$a.timer._update())},$I._requestFullscreen=function(){var $I=$x.document.documentElement;$I.requestFullscreen?$I.requestFullscreen():$I.mozRequestFullScreen?$I.mozRequestFullScreen():$I.webkitRequestFullscreen?$I.webkitRequestFullscreen():$I.msRequestFullscreen&&$I.msRequestFullscreen()},$I._fullScreenChanged=function(){$a.stage.event("fullscreenchange")},$I.exitFullscreen=function(){var $I=$x.document;$I.exitFullscreen?$I.exitFullscreen():$I.mozCancelFullScreen?$I.mozCancelFullScreen():$I.webkitExitFullscreen&&$I.webkitExitFullscreen()},$B(0,$I,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),$B(0,$I,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),$B(0,$I,"frameRate",function(){return this._frameRate},function($I){if(this._frameRate=$I,$o.isConchApp)switch(this._frameRate){case"slow":$x.window.conch&&$x.window.conchConfig.setSlowFrame&&$x.window.conchConfig.setSlowFrame(!0);break;case"fast":$x.window.conch&&$x.window.conchConfig.setSlowFrame&&$x.window.conchConfig.setSlowFrame(!1);break;case"mouse":$x.window.conch&&$x.window.conchConfig.setMouseFrame&&$x.window.conchConfig.setMouseFrame(2e3);break;case"sleep":$x.window.conch&&$x.window.conchConfig.setLimitFPS&&$x.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),$B(0,$I,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),$B(0,$I,"width",$A.prototype._$get_width,function($I){this.designWidth=$I,$a.superSet($AI,this,"width",$I),$a.timer.callLater(this,this._changeCanvasSize)}),$B(0,$I,"alignH",function(){return this._alignH},function($I){this._alignH=$I,$a.timer.callLater(this,this._changeCanvasSize)}),$B(0,$I,"isFocused",function(){return this._isFocused}),$B(0,$I,"height",$A.prototype._$get_height,function($I){this.designHeight=$I,$a.superSet($AI,this,"height",$I),$a.timer.callLater(this,this._changeCanvasSize)}),$B(0,$I,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||$R.create()},$A.prototype._$set_transform),$B(0,$I,"isVisibility",function(){return this._isVisibility}),$B(0,$I,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),$B(0,$I,"scaleMode",function(){return this._scaleMode},function($I){this._scaleMode=$I,$a.timer.callLater(this,this._changeCanvasSize)}),$B(0,$I,"alignV",function(){return this._alignV},function($I){this._alignV=$I,$a.timer.callLater(this,this._changeCanvasSize)}),$B(0,$I,"bgColor",function(){return this._bgColor},function($I){this._bgColor=$I,this.conchModel&&this.conchModel.bgColor($I),$o.isWebGL&&($I?$c._wgColor=$F.create($I)._color:$x.onMiniGame||($c._wgColor=null)),$x.onLimixiu?$c._wgColor=$F.create($I)._color:$o.canvas.style.background=$I||"none"}),$B(0,$I,"mouseX",function(){return Math.round($t.instance.mouseX/this.clientScaleX)}),$B(0,$I,"mouseY",function(){return Math.round($t.instance.mouseY/this.clientScaleY)}),$B(0,$I,"screenMode",function(){return this._screenMode},function($I){this._screenMode=$I}),$B(0,$I,"visible",$A.prototype._$get_visible,function($I){this.visible!==$I&&($a.superSet($AI,this,"visible",$I),$o._mainCanvas.source.style.visibility=$I?"visible":"hidden")}),$B(0,$I,"fullScreenEnabled",null,function($I){var $M=$x.document,$E=$o.canvas;$I?($E.addEventListener("mousedown",this._requestFullscreen),$E.addEventListener("touchstart",this._requestFullscreen),$M.addEventListener("fullscreenchange",this._fullScreenChanged),$M.addEventListener("mozfullscreenchange",this._fullScreenChanged),$M.addEventListener("webkitfullscreenchange",this._fullScreenChanged),$M.addEventListener("msfullscreenchange",this._fullScreenChanged)):($E.removeEventListener("mousedown",this._requestFullscreen),$E.removeEventListener("touchstart",this._requestFullscreen),$M.removeEventListener("fullscreenchange",this._fullScreenChanged),$M.removeEventListener("mozfullscreenchange",this._fullScreenChanged),$M.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),$M.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),$c.SCALE_NOSCALE="noscale",$c.SCALE_EXACTFIT="exactfit",$c.SCALE_SHOWALL="showall",$c.SCALE_NOBORDER="noborder",$c.SCALE_FULL="full",$c.SCALE_FIXED_WIDTH="fixedwidth",$c.SCALE_FIXED_HEIGHT="fixedheight",$c.SCALE_FIXED_AUTO="fixedauto",$c.ALIGN_LEFT="left",$c.ALIGN_RIGHT="right",$c.ALIGN_CENTER="center",$c.ALIGN_TOP="top",$c.ALIGN_MIDDLE="middle",$c.ALIGN_BOTTOM="bottom",$c.SCREEN_NONE="none",$c.SCREEN_HORIZONTAL="horizontal",$c.SCREEN_VERTICAL="vertical",$c.FRAME_FAST="fast",$c.FRAME_SLOW="slow",$c.FRAME_MOUSE="mouse",$c.FRAME_SLEEP="sleep",$c.FRAME_MOUSE_THREDHOLD=2e3,$d($c,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),$c}($AI),$yI=(function($I){function $M(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,$M.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}$V($M,"laya.media.SoundNode",$AI);var $E=$M.prototype;$E._onParentChange=function(){this.target=this.parent},$E.play=function($I,$M){void 0===$I&&($I=1),isNaN($I)&&($I=1),this.url&&(this.stop(),this._channel=$v.playSound(this.url,$I,null,$M))},$E.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},$E._setPlayAction=function($I,$M,$E,$Z){void 0===$Z&&($Z=!0),this[$E]&&$I&&($Z?$I.on($M,this,this[$E]):$I.off($M,this,this[$E]))},$E._setPlayActions=function($I,$M,$E,$Z){if(void 0===$Z&&($Z=!0),$I&&$M){var $i,$n=$M.split(","),$c=0;for($i=$n.length,$c=0;$c<$i;$c++)this._setPlayAction($I,$n[$c],$E,$Z)}},$B(0,$E,"playEvent",null,function($I){(this._playEvents=$I)&&this._tar&&this._setPlayActions(this._tar,$I,"play")}),$B(0,$E,"target",null,function($I){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=$I,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),$B(0,$E,"stopEvent",null,function($I){(this._stopEvents=$I)&&this._tar&&this._setPlayActions(this._tar,$I,"stop")})}(),function($I){function $M(){this._src=null,this._onload=null,this._onerror=null,$M.__super.call(this)}$V($M,"laya.resource.FileBitmap",$tI);var $E=$M.prototype;return $B(0,$E,"src",function(){return this._src},function($I){this._src=$I}),$B(0,$E,"onload",null,function($I){}),$B(0,$E,"onerror",null,function($I){}),$M}()),$$I=function($I){function $E($I,$M){this._is2D=!1,$E.__super.call(this);var $Z=this;if(this._source=this,"2D"===$I||"AUTO"===$I&&!$o.isWebGL){this._is2D=!0,this._source=$M||$x.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var $i=this;$i.getContext=function($I,$M){if($Z._ctx)return $Z._ctx;var $E=$Z._ctx=$Z._source.getContext($I,$M);return $E&&($E._canvas=$i,$o.isFlash||$x.onLimixiu||($E.size=function($I,$M){})),$E}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}$V($E,"laya.resource.HTMLCanvas",$tI);var $M=$E.prototype;return $M.clear=function(){this._ctx&&this._ctx.clear()},$M.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$M.release=function(){},$M._setContext=function($I){this._ctx=$I},$M.getContext=function($I,$M){return this._ctx?this._ctx:this._ctx=$E._createContext(this)},$M.getMemSize=function(){return 0},$M.size=function($I,$M){(this._w!=$I||this._h!=$M||this._source&&(this._source.width!=$I||this._source.height!=$M))&&(this._w=$I,this._h=$M,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size($I,$M),this._source&&(this._source.height=$M,this._source.width=$I))},$M.getCanvas=function(){return this._source},$M.toBase64=function($I,$M,$E){if(this._source)if($o.isConchApp&&this._source.toBase64)this._source.toBase64($I,$M,$E);else{var $Z=this._source.toDataURL($I,$M);$E.call(this,$Z)}},$B(0,$M,"context",function(){return this._ctx}),$B(0,$M,"asBitmap",null,function($I){}),$E.create=function($I,$M){return new $E($I,$M)},$E.TYPE2D="2D",$E.TYPE3D="3D",$E.TYPEAUTO="AUTO",$E._createContext=null,$E}(),$wI=(function($I){function $d($I,$M,$E,$Z,$i,$n,$c,$f){throw $d.__super.call(this),new Error("不允许new！")}$V($d,"laya.resource.HTMLSubImage",$tI),$d.create=function($I,$M,$E,$Z,$i,$n,$c,$f){return void 0===$f&&($f=!1),new $d($I,$M,$E,$Z,$i,$n,$c,$f)}}(),function($I){function $A(){this._frames=null,this._url=null,$A.__super.call(this),this._setControlNode(this)}$V($A,"laya.display.Animation",$I);var $M=$A.prototype;$M.destroy=function($I){void 0===$I&&($I=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,$I),this._frames=null,this._labels=null},$M.play=function($I,$M,$E,$Z){void 0===$I&&($I=0),void 0===$M&&($M=!0),void 0===$E&&($E=""),void 0===$Z&&($Z=!0),$E&&this._setFramesFromCache($E,$Z),this._isPlaying=!0,this.index="string"==typeof $I?this._getFrameByLabel($I):$I,this.loop=$M,this._actionName=$E,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},$M._setFramesFromCache=function($I,$M){var $E;return void 0===$M&&($M=!1),this._url&&($I=this._url+"#"+$I),$I&&$A.framesMap[$I]?(($E=$A.framesMap[$I])instanceof Array?(this._frames=$A.framesMap[$I],this._count=this._frames.length):($E.nodeRoot&&($A.framesMap[$I]=this._parseGraphicAnimationByData($E),$E=$A.framesMap[$I]),this._frames=$E.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=$E.interval),this._labels=this._copyLabels($E.labels)),!0):($M&&console.log("ani not found:",$I),!1)},$M._copyLabels=function($I){if(!$I)return null;var $M,$E;for($E in $M={},$I)$M[$E]=$K.copyArray([],$I[$E]);return $M},$M._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&$I.prototype._frameLoop.call(this)},$M._displayToIndex=function($I){this._frames&&(this.graphics=this._frames[$I])},$M.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},$M.loadImages=function($I,$M){return void 0===$M&&($M=""),this._url="",this._setFramesFromCache($M)||(this.frames=$A.framesMap[$M]?$A.framesMap[$M]:$A.createFrames($I,$M)),this},$M.loadAtlas=function($M,$E,$Z){void 0===$Z&&($Z=""),this._url="";var $i=this;function $I($I){$M===$I&&($i.frames=$A.framesMap[$Z]?$A.framesMap[$Z]:$A.createFrames($M,$Z),$E&&$E.run())}return $i._setFramesFromCache($Z)||($fI.getAtlas($M)?$I($M):$a.loader.load($M,$y.create(null,$I,[$M]),null,"atlas")),this},$M.loadAnimation=function($I,$M,$E){this._url=$I;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,$M&&$M.run()):!$E||$fI.getAtlas($E)?this._loadAnimationData($I,$M,$E):$a.loader.load($E,$y.create(this,this._loadAnimationData,[$I,$M,$E]),null,"atlas"),this},$M._loadAnimationData=function($f,$d,$I){var $H=this;if(!$I||$fI.getAtlas($I)){var $B=this;$fI.getRes($f)?$M($f):$a.loader.load($f,$y.create(null,$M,[$f]),null,"json"),$fI.clearRes($f)}else console.warn("atlas load fail:"+$I);function $M($I){if($fI.getRes($I)&&$f===$I){var $M;if($A.framesMap[$f+"#"])$B._setFramesFromCache($H._actionName,!0),$H.index=0,$H._checkResumePlaying();else{var $E=$B._parseGraphicAnimation($fI.getRes($f));if(!$E)return;var $Z,$i=$E.animationList,$n=0,$c=$i.length;for($n=0;$n<$c;$n++)$M=$i[$n],$A.framesMap[$f+"#"+$M.name]=$M,$Z||($Z=$M);$Z&&($A.framesMap[$f+"#"]=$Z,$B._setFramesFromCache($H._actionName,!0),$H.index=0),$H._checkResumePlaying()}$d&&$d.run()}}},$M._parseGraphicAnimation=function($I){return $aI.parseAnimationData($I)},$M._parseGraphicAnimationByData=function($I){return $aI.parseAnimationByData($I)},$B(0,$M,"frames",function(){return this._frames},function($I){(this._frames=$I)&&(this._count=$I.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),$B(0,$M,"autoPlay",null,function($I){$I?this.play():this.stop()}),$B(0,$M,"source",null,function($I){-1<$I.indexOf(".ani")?this.loadAnimation($I):-1<$I.indexOf(".json")||-1<$I.indexOf("als")||-1<$I.indexOf("atlas")?this.loadAtlas($I):this.loadImages($I.split(","))}),$B(0,$M,"autoAnimation",null,function($I){this.play(0,!0,$I,!1)}),$A.createFrames=function($I,$M){var $E,$Z,$i=0,$n=0;if("string"==typeof $I){var $c=$fI.getAtlas($I);if($c&&$c.length)for($E=[],$i=0,$n=$c.length;$i<$n;$i++)($Z=new $W.createGraphics).drawTexture($fI.getRes($c[$i]),0,0),$E.push($Z)}else if($I instanceof Array)for($E=[],$i=0,$n=$I.length;$i<$n;$i++)($Z=new $W.createGraphics).loadImage($I[$i],0,0),$E.push($Z);return $M&&($A.framesMap[$M]=$E),$E},$A.clearCache=function($I){var $M,$E=$A.framesMap,$Z=$I+"#";for($M in $E)$M!==$I&&0!=$M.indexOf($Z)||delete $A.framesMap[$M]},$A.framesMap={}}($VI),function($I){function $n(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,$n.__super.call(this),null==$n._sortIndexFun&&($n._sortIndexFun=$O.sortByKey("index",!1,!0))}$V($n,"laya.display.FrameAnimation",$I);var $M=$n.prototype;return $M._setUp=function($I,$M){this._labels=null,this._animationNewFrames=null,this._targetDic=$I,this._animationData=$M,this.interval=1e3/$M.frameRate,$M.parsed?(this._count=$M.count,this._labels=$M.labels,this._animationNewFrames=$M.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),$M.parsed=!0,$M.labels=this._labels,$M.count=this._count,$M.animationNewFrames=this._animationNewFrames},$M.clear=function(){$I.prototype.clear.call(this),this._targetDic=null,this._animationData=null},$M._displayToIndex=function($I){if(this._animationData){$I<0&&($I=0),$I>this._count&&($I=this._count);var $M=this._animationData.nodes,$E=0,$Z=$M.length;for($E=0;$E<$Z;$E++)this._displayNodeToFrame($M[$E],$I)}},$M._displayNodeToFrame=function($I,$M,$E){$E||($E=this._targetDic);var $Z=$E[$I.target];if($Z){var $i,$n,$c,$f=$I.frames,$d=$I.keys,$H=0,$B=$d.length;for($H=0;$H<$B;$H++)$c=($n=$f[$i=$d[$H]]).length>$M?$n[$M]:$n[$n.length-1],$Z[$i]=$c}},$M._calculateDatas=function(){if(this._animationData){var $I,$M=this._animationData.nodes,$E=0,$Z=$M.length;for($E=this._count=0;$E<$Z;$E++)$I=$M[$E],this._calculateNodeKeyFrames($I);this._count+=1}},$M._calculateNodeKeyFrames=function($I){var $M,$E,$Z=$I.keyframes,$i=$I.target;for($M in $I.frames||($I.frames={}),$I.keys?$I.keys.length=0:$I.keys=[],$I.initValues||($I.initValues={}),$Z)$E=$Z[$M],$I.frames[$M]||($I.frames[$M]=[]),this._targetDic&&this._targetDic[$i]&&($I.initValues[$M]=this._targetDic[$i][$M]),$E.sort($n._sortIndexFun),$I.keys.push($M),this._calculateNodePropFrames($E,$I.frames[$M],$M,$i)},$M.resetToInitState=function(){if(this._targetDic&&this._animationData){var $I,$M,$E=this._animationData.nodes,$Z=0,$i=$E.length;for($Z=0;$Z<$i;$Z++)if($M=($I=$E[$Z]).initValues){var $n,$c=this._targetDic[$I.target];if($c)for($n in $M)$c[$n]=$M[$n]}}},$M._calculateNodePropFrames=function($I,$M,$E,$Z){var $i=0,$n=$I.length-1;if(0<$n){for($M.length=$I[$n].index+1,$i=0;$i<$n;$i++)this._dealKeyFrame($I[$i]),this._calculateFrameValues($I[$i],$I[$i+1],$M);this._dealKeyFrame($I[$i])}0==$n&&($M[$I[0].index]=$I[0].value,this._animationNewFrames&&(this._animationNewFrames[$I[0].index]=!0))},$M._dealKeyFrame=function($I){$I.label&&""!=$I.label&&this.addLabel($I.label,$I.index)},$M._calculateFrameValues=function($I,$M,$E){var $Z,$i=0,$n=$I.index,$c=$M.index,$f=$I.value,$d=$M.value-$I.value,$H=$c-$n;if($c>this._count&&(this._count=$c),$I.tween)for(null==($Z=$_[$I.tweenMethod])&&($Z=$_.linearNone),$i=$n;$i<$c;$i++)$E[$i]=$Z($i-$n,$f,$d,$H),this._animationNewFrames&&(this._animationNewFrames[$i]=!0);else for($i=$n;$i<$c;$i++)$E[$i]=$f;this._animationNewFrames&&(this._animationNewFrames[$I.index]=!0,this._animationNewFrames[$M.index]=!0),$E[$M.index]=$M.value},$n._sortIndexFun=null,$n}($VI)),$gI=function($M){function $i(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",$i.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=$uI.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}$V($i,"laya.display.Input",$M);var $I=$i.prototype;return $I.setSelection=function($I,$M){this.focus=!0,laya.display.Input.inputElement.selectionStart=$I,laya.display.Input.inputElement.selectionEnd=$M},$I._onUnDisplay=function($I){this.focus=!1},$I._onMouseDown=function($I){this.focus=!0},$I._syncInputTransform=function(){var $I=this.nativeInput,$M=$K.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),$E=this._width-this.padding[1]-this.padding[3],$Z=this._height-this.padding[0]-this.padding[2];$o.isConchApp?($I.setScale($M.scaleX,$M.scaleY),$I.setSize($E,$Z),$I.setPos($M.x,$M.y)):($i.inputContainer.style.transform=$i.inputContainer.style.webkitTransform="scale("+$M.scaleX+","+$M.scaleY+") rotate("+$a.stage.canvasDegree+"deg)",$I.style.width=$E+"px",$I.style.height=$Z+"px",$i.inputContainer.style.left=$M.x+"px",$i.inputContainer.style.top=$M.y+"px")},$I.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},$I._setInputMethod=function(){$i.input.parentElement&&$i.inputContainer.removeChild($i.input),$i.area.parentElement&&$i.inputContainer.removeChild($i.area),$i.inputElement=this._multiline?$i.area:$i.input,$i.inputContainer.appendChild($i.inputElement),$uI.RightToLeft&&($i.inputElement.style.direction="rtl")},$I._focusIn=function(){laya.display.Input.isInputting=!0;var $I=this.nativeInput;this._focus=!0;var $M=$I.style;$M.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),$I.readOnly=!this._editable,$o.isConchApp&&($I.setType(this._type),$I.setForbidEdit(!this._editable)),$I.maxLength=this._maxChars;this.padding;if($I.type=this._type,$I.value=this._content,$I.placeholder=this._prompt,$a.stage.off("keydown",this,this._onKeyDown),$a.stage.on("keydown",this,this._onKeyDown),($a.stage.focus=this).event("focus"),$x.onPC&&$I.focus(),!$x.onMiniGame){this._text;this._text=null}this.typeset(),$I.setColor(this._originColor),$I.setFontSize(this.fontSize),$I.setFontFace($x.onIPhone&&$uI._fontFamilyMap[this.font]||this.font),$o.isConchApp&&$I.setMultiAble&&$I.setMultiAble(this._multiline),$M.lineHeight=this.leading+this.fontSize+"px",$M.fontStyle=this.italic?"italic":"normal",$M.fontWeight=this.bold?"bold":"normal",$M.textAlign=this.align,$M.padding="0 0",this._syncInputTransform(),!$o.isConchApp&&$x.onPC&&$a.timer.frameLoop(1,this,this._syncInputTransform)},$I._setPromptColor=function(){($i.promptStyleDOM=$x.getElementById("promptStyle"))||(($i.promptStyleDOM=$x.createElement("style")).setAttribute("id","promptStyle"),$x.document.head.appendChild($i.promptStyleDOM)),$i.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},$I._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?($a.superSet($uI,this,"text",this._content),$a.superSet($uI,this,"color",this._originColor)):($a.superSet($uI,this,"text",this._prompt),$a.superSet($uI,this,"color",this._promptColor)),$a.stage.off("keydown",this,this._onKeyDown),$a.stage.focus=null,this.event("blur"),$o.isConchApp&&this.nativeInput.blur(),$x.onPC&&$a.timer.clear(this,this._syncInputTransform)},$I._onKeyDown=function($I){13===$I.keyCode&&($x.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},$I.changeText=function($I){this._content=$I,this._focus?(this.nativeInput.value=$I||"",this.event("change")):$M.prototype.changeText.call(this,$I)},$B(0,$I,"color",$M.prototype._$get_color,function($I){this._focus&&this.nativeInput.setColor($I),$a.superSet($uI,this,"color",this._content?$I:this._promptColor),this._originColor=$I}),$B(0,$I,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function($I){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),$B(0,$I,"multiline",function(){return this._multiline},function($I){this._multiline=$I,this.valign=$I?"top":"middle"}),$B(0,$I,"maxChars",function(){return this._maxChars},function($I){$I<=0&&($I=1e5),this._maxChars=$I}),$B(0,$I,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function($I){$a.superSet($uI,this,"color",this._originColor),$I+="",this._focus?(this.nativeInput.value=$I||"",this.event("change")):(this._multiline||($I=$I.replace(/\r?\n/g,"")),(this._content=$I)?$a.superSet($uI,this,"text",$I):($a.superSet($uI,this,"text",this._prompt),$a.superSet($uI,this,"color",this.promptColor)))}),$B(0,$I,"nativeInput",function(){return this._multiline?$i.area:$i.input}),$B(0,$I,"prompt",function(){return this._prompt},function($I){!this._text&&$I&&$a.superSet($uI,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?$a.superSet($uI,this,"text",this._text==this._prompt?$I:this._text):$a.superSet($uI,this,"text",$I),this._prompt=$uI.langPacks&&$uI.langPacks[$I]?$uI.langPacks[$I]:$I}),$B(0,$I,"focus",function(){return this._focus},function($I){var $M=this.nativeInput;this._focus!==$I&&($I?($M.target?$M.target._focusOut():this._setInputMethod(),($M.target=this)._focusIn()):($M.target=null,this._focusOut(),$x.document.body.scrollTop=0,$M.blur(),$o.isConchApp?$M.setPos(-1e4,-1e4):$i.inputContainer.contains($M)&&$i.inputContainer.removeChild($M)))}),$B(0,$I,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function($I){$I?(-1<($I="[^"+$I+"]").indexOf("^^")&&($I=$I.replace("^^","")),this._restrictPattern=new RegExp($I,"g")):this._restrictPattern=null}),$B(0,$I,"editable",function(){return this._editable},function($I){this._editable=$I,$o.isConchApp&&$i.input.setForbidEdit(!$I)}),$B(0,$I,"promptColor",function(){return this._promptColor},function($I){this._promptColor=$I,this._content||$a.superSet($uI,this,"color",$I)}),$B(0,$I,"type",function(){return this._type},function($I){this._getCSSStyle().password="password"==$I,this._type=$I,$o.isConchApp&&this.nativeInput.setType($I)}),$B(0,$I,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function($I){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),$B(0,$I,"asPassword",function(){return this._getCSSStyle().password},function($I){this._getCSSStyle().password=$I,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),$i.__init__=function(){$i._createInputElement(),$x.onMobile&&$o.canvas.addEventListener($i.IOS_IFRAME?$x.onMiniGame?"touchend":"click":"touchend",$i._popupInputMethod)},$i._popupInputMethod=function($I){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},$i._createInputElement=function(){$i._initInput($i.area=$x.createElement("textarea")),$i._initInput($i.input=$x.createElement("input")),($i.inputContainer=$x.createElement("div")).style.position="absolute",$i.inputContainer.style.zIndex=1e5,$x.container.appendChild($i.inputContainer),$i.inputContainer.setPos=function($I,$M){$i.inputContainer.style.left=$I+"px",$i.inputContainer.style.top=$M+"px"}},$i._initInput=function($M){var $I=$M.style;$I.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",$I.resize="none",$I.backgroundColor="transparent",$I.border="none",$I.outline="none",$I.zIndex=1,$M.addEventListener("input",$i._processInputting),$M.addEventListener("mousemove",$i._stopEvent),$M.addEventListener("mousedown",$i._stopEvent),$M.addEventListener("touchmove",$i._stopEvent),$M.setFontFace=function($I){$M.style.fontFamily=$I},$o.isConchApp||($M.setColor=function($I){$M.style.color=$I},$M.setFontSize=function($I){$M.style.fontSize=$I+"px"})},$i._processInputting=function($I){var $M=laya.display.Input.inputElement.target;if($M){var $E=laya.display.Input.inputElement.value;$M._restrictPattern&&($E=$E.replace(/\u2006|\x27/g,""),$M._restrictPattern.test($E)&&($E=$E.replace($M._restrictPattern,""),laya.display.Input.inputElement.value=$E)),$M._text=$E,$M.event("input")}},$i._stopEvent=function($I){"touchmove"==$I.type&&$I.preventDefault(),$I.stopPropagation&&$I.stopPropagation()},$i.TYPE_TEXT="text",$i.TYPE_PASSWORD="password",$i.TYPE_EMAIL="email",$i.TYPE_URL="url",$i.TYPE_NUMBER="number",$i.TYPE_RANGE="range",$i.TYPE_DATE="date",$i.TYPE_MONTH="month",$i.TYPE_WEEK="week",$i.TYPE_TIME="time",$i.TYPE_DATE_TIME="datetime",$i.TYPE_DATE_TIME_LOCAL="datetime-local",$i.TYPE_SEARCH="search",$i.input=null,$i.area=null,$i.inputElement=null,$i.inputContainer=null,$i.confirmButton=null,$i.promptStyleDOM=null,$i.inputHeight=45,$i.isInputting=!1,$i.stageMatrix=null,$d($i,["IOS_IFRAME",function(){return this.IOS_IFRAME=$x.onIOS&&$x.window.top!=$x.window.self}]),$i}($uI),$OI=function($I){function $E($I,$M){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,$E.__super.call(this),$I&&this._init_($I,$M)}$V($E,"laya.resource.HTMLImage",$yI);var $M=$E.prototype;return $M._init_=function($I,$M){this._src=$I,this._source=new $x.window.Image,$M&&($M.onload&&(this.onload=$M.onload),$M.onerror&&(this.onerror=$M.onerror),$M.onCreate&&$M.onCreate(this)),0!=$I.indexOf("data:image")&&(this._source.crossOrigin=""),$I&&(this._source.src=$I)},$M.recreateResource=function(){var $I=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var $M=this;this._source=new $x.window.Image,this._source.crossOrigin="",this._source.onload=function(){if($M._needReleaseAgain)return $M._needReleaseAgain=!1,$M._source.onload=null,void($M._source=null);$M._source.onload=null,$M.memorySize=$I._w*$I._h*4,$M._recreateLock=!1,$M.completeCreate()},this._source.src=this._src}},$M.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},$M.onresize=function(){this._w=this._source.width,this._h=this._source.height},$B(0,$M,"onload",null,function($I){var $M=this;this._onload=$I,this._source&&(this._source.onload=null!=this._onload?function(){$M.onresize(),$M._onload()}:null)}),$B(0,$M,"onerror",null,function($I){var $M=this;this._onerror=$I,this._source&&(this._source.onerror=null!=this._onerror?function(){$M._onerror()}:null)}),$B(0,$M,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($I){this._enableMerageInAtlas=$I,$o.isConchApp&&this._source&&(this._source.enableMerageInAtlas=$I)}),$E.create=function($I,$M){return new $E($I,$M)},$E}(),$aI=(function($n){function $I(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,$I.__super.call(this)}$V($I,"laya.display.EffectAnimation",$n);var $M=$I.prototype;$M._onOtherBegin=function($I){$I!=this&&this.stop()},$M.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},$M._onPlayAction=function(){this.play(0,!1)},$M.play=function($I,$M,$E,$Z){void 0===$I&&($I=0),void 0===$M&&($M=!0),void 0===$E&&($E=""),void 0===$Z&&($Z=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,$I,$M,$E,$Z))},$M._recordInitData=function(){if(this._aniKeys){var $I,$M,$E=0;for($I=this._aniKeys.length,$E=0;$E<$I;$E++)$M=this._aniKeys[$E],this._initData[$M]=this._target[$M]}},$M._displayToIndex=function($I){if(this._animationData){$I<0&&($I=0),$I>this._count&&($I=this._count);var $M=this._animationData.nodes,$E=0,$Z=$M.length;for($Z=1<$Z?1:$Z,$E=0;$E<$Z;$E++)this._displayNodeToFrame($M[$E],$I)}},$M._displayNodeToFrame=function($I,$M,$E){if(this._target){var $Z;$Z=this._target;var $i,$n,$c,$f,$d=$I.frames,$H=$I.keys,$B=0,$A=$H.length;$f=$I.secondFrames;var $Q,$p,$t,$V,$u=0;for($B=0;$B<$A;$B++)$n=$d[$i=$H[$B]],$c=-1==($u=$f[$i])?this._initData[$i]:$M<$u?($t=($p=$I.keyframes[$i])[0]).tween?(null==($Q=$_[$t.tweenMethod])&&($Q=$_.linearNone),$V=$p[1],$Q($M,this._initData[$i],$V.value-this._initData[$i],$V.index)):this._initData[$i]:$n.length>$M?$n[$M]:$n[$n.length-1],$Z[$i]=$c}},$M._calculateNodeKeyFrames=function($I){$n.prototype._calculateNodeKeyFrames.call(this,$I);var $M,$E,$Z,$i=$I.keyframes;$I.target;for($M in $Z={},$I.secondFrames=$Z,$i)($E=$i[$M]).length<=1?$Z[$M]=-1:$Z[$M]=$E[1].index},$B(0,$M,"target",function(){return this._target},function($I){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=$I,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),$B(0,$M,"playEvent",null,function($I){(this._playEvents=$I)&&this.addEvent()}),$B(0,$M,"effectData",null,function($I){var $M;$I&&(($M=$I.animations)&&$M[0]&&(this._setUp({},$M[0]),$M[0].nodes&&$M[0].nodes[0]&&(this._aniKeys=$M[0].nodes[0].keys)))}),$B(0,$M,"effectClass",null,function($I){var $M,$E;(this._effectClass=$l.getClass($I),this._effectClass)&&(($M=this._effectClass.uiView)&&($E=$M.animations)&&$E[0]&&(this._setUp({},$E[0]),$E[0].nodes&&$E[0].nodes[0]&&(this._aniKeys=$E[0].nodes[0].keys)))}),$I.EffectAnimationBegin="effectanimationbegin"}($wI),function($M){var $q;function $v(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,$v.__super.call(this)}$V($v,"laya.utils.GraphicAnimation",$M);var $I=$v.prototype;return $I._parseNodeList=function($I){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[$I.compId]=$I.props,$I.compId&&this._nodeList.push($I.compId);var $M=$I.child;if($M){var $E=0,$Z=$M.length;for($E=0;$E<$Z;$E++)this._parseNodeList($M[$E])}},$I._calGraphicData=function($I){var $M;if(this._setUp(null,$I),this._createGraphicData(),this._nodeIDAniDic)for($M in this._nodeIDAniDic)this._nodeIDAniDic[$M]=null},$I._createGraphicData=function(){var $I,$M=[],$E=0,$Z=this.count,$i=this._animationNewFrames;for($i||($i=[]),$E=0;$E<$Z;$E++)!$i[$E]&&$I||($I=this._createFrameGraphic($E)),$M.push($I);this._gList=$M},$I._createFrameGraphic=function($I){var $M=$W.createGraphics();return $v._rootMatrix||($v._rootMatrix=new $R),this._updateNodeGraphic(this._rootNode,$I,$v._rootMatrix,$M),$M},$I._updateNodeGraphic=function($I,$M,$E,$Z,$i){var $n;void 0===$i&&($i=1);var $c,$f,$d,$H=($n=this._nodeGDic[$I.compId]=this._getNodeGraphicData($I.compId,$M,this._nodeGDic[$I.compId])).alpha*$i;if(!($H<.01)&&($n.resultTransform||($n.resultTransform=$R.create()),$c=$n.resultTransform,$R.mul($n.transform,$E,$c),$n.skin&&($f=this._getTextureByUrl($n.skin))&&($c._checkTransform()?($Z.drawTexture($f,0,0,$n.width,$n.height,$c,$H),$n.resultTransform=null):$Z.drawTexture($f,$c.tx,$c.ty,$n.width,$n.height,null,$H)),$d=$I.child)){var $B,$A=0;for($B=$d.length,$A=0;$A<$B;$A++)this._updateNodeGraphic($d[$A],$M,$c,$Z,$H)}},$I._updateNoChilds=function($I,$M){if($I.skin){var $E=this._getTextureByUrl($I.skin);if($E){var $Z=$I.transform;$Z._checkTransform();!$Z.bTransform?$M.drawTexture($E,$Z.tx,$Z.ty,$I.width,$I.height,null,$I.alpha):$M.drawTexture($E,0,0,$I.width,$I.height,$Z.clone(),$I.alpha)}}},$I._updateNodeGraphic2=function($I,$M,$E){var $Z;if($Z=this._nodeGDic[$I.compId]=this._getNodeGraphicData($I.compId,$M,this._nodeGDic[$I.compId]),$I.child){var $i=$Z.transform;$i._checkTransform();var $n,$c;$c=($n=!$i.bTransform)&&(0!=$i.tx||0!=$i.ty);var $f,$d,$H;if(($f=$i.bTransform||1!=$Z.alpha)&&$E.save(),1!=$Z.alpha&&$E.alpha($Z.alpha),$n?$c&&$E.translate($i.tx,$i.ty):$E.transform($i.clone()),$d=$I.child,$Z.skin&&($H=this._getTextureByUrl($Z.skin))&&$E.drawTexture($H,0,0,$Z.width,$Z.height),$d){var $B,$A=0;for($B=$d.length,$A=0;$A<$B;$A++)this._updateNodeGraphic2($d[$A],$M,$E)}$f?$E.restore():$n?$c&&$E.translate(-$i.tx,-$i.ty):$E.transform($i.clone().invert())}else this._updateNoChilds($Z,$E)},$I._calculateNodeKeyFrames=function($I){$M.prototype._calculateNodeKeyFrames.call(this,$I),this._nodeIDAniDic[$I.target]=$I},$I.getNodeDataByID=function($I){return this._nodeIDAniDic[$I]},$I._getParams=function($I,$M,$E,$Z){var $i=$v._temParam;$i.length=$M.length;var $n=0,$c=$M.length;for($n=0;$n<$c;$n++)$i[$n]=this._getObjVar($I,$M[$n][0],$E,$M[$n][1],$Z);return $i},$I._getObjVar=function($I,$M,$E,$Z,$i){if($I.hasOwnProperty($M)){var $n=$I[$M];if($E>=$n.length&&($E=$n.length-1),null!=$I[$M][$E])return $I[$M][$E]}return $i.hasOwnProperty($M)?$i[$M]:$Z},$I._getNodeGraphicData=function($I,$M,$E){$E||($E=$q.create()),$E.transform?$E.transform.identity():$E.transform=$R.create();var $Z=this.getNodeDataByID($I);if(!$Z)return $E;var $i,$n,$c=$Z.frames,$f=this._getParams($c,$v._drawTextureCmd,$M,this._nodeDefaultProps[$I]),$d=$f[0],$H=NaN,$B=NaN,$A=$f[5],$Q=$f[6],$p=$f[13],$t=$f[14],$V=$f[7],$u=$f[8],$N=$f[9],$y=$f[11],$$=$f[12];$H=$f[3],$B=$f[4],0!=$H&&0!=$B||($d=null),-1==$H&&($H=0),-1==$B&&($B=0),$E.skin=$d,$E.width=$H,$E.height=$B,$d&&(($i=this._getTextureByUrl($d))?($H||($H=$i.sourceWidth),$B||($B=$i.sourceHeight)):console.warn("lost skin:",$d,",you may load pics first")),$E.alpha=$f[10],$n=$E.transform,0!=$p&&($A=$p*$H),0!=$t&&($Q=$t*$B),0==$A&&0==$Q||$n.translate(-$A,-$Q);var $w=null;if($N||1!==$V||1!==$u||$y||$$){($w=$v._tempMt).identity(),$w.bTransform=!0;var $g=.0174532922222222*($N-$y),$O=.0174532922222222*($N+$$),$a=Math.cos($O),$m=Math.sin($O),$j=Math.sin($g),$T=Math.cos($g);$w.a=$V*$a,$w.b=$V*$m,$w.c=-$u*$j,$w.d=$u*$T,$w.tx=$w.ty=0}return $w&&($n=$R.mul($n,$w,$n)),$n.translate($f[1],$f[2]),$E},$I._getTextureByUrl=function($I){return $fI.getRes($I)},$I.setAniData=function($I,$M){if($I.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$I,this._parseNodeList($I);var $E,$Z={},$i=[],$n=$I.animations,$c=0,$f=$n.length;for($c=0;$c<$f;$c++)if($E=$n[$c],this._labels=null,(!$M||$M==$E.name)&&$E){try{this._calGraphicData($E)}catch($I){console.warn("parse animation fail:"+$E.name+",empty animation created"),this._gList=[]}var $d={};$d.interval=1e3/$E.frameRate,$d.frames=this._gList,$d.labels=this._labels,$d.name=$E.name,$i.push($d),$Z[$E.name]=$d}this.animationList=$i,this.animationDic=$Z}$v._temParam.length=0},$I.parseByData=function($I){var $M,$E;$M=$I.nodeRoot,$E=$I.aniO,delete $I.nodeRoot,delete $I.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=$M,this._parseNodeList($M),this._labels=null;try{this._calGraphicData($E)}catch($I){console.warn("parse animation fail:"+$E.name+",empty animation created"),this._gList=[]}var $Z=$I;return $Z.interval=1e3/$E.frameRate,$Z.frames=this._gList,$Z.labels=this._labels,$Z.name=$E.name,$Z},$I.setUpAniData=function($I){if($I.animations){var $M,$E={},$Z=[],$i=$I.animations,$n=0,$c=$i.length;for($n=0;$n<$c;$n++)if($M=$i[$n]){var $f={};$f.name=$M.name,$f.aniO=$M,$f.nodeRoot=$I,$Z.push($f),$E[$M.name]=$f}this.animationList=$Z,this.animationDic=$E}},$I._clear=function(){var $I,$M;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for($I in this._nodeGDic)($M=this._nodeGDic[$I])&&$M.recover();this._nodeGDic=null},$v.parseAnimationByData=function($I){var $M;return $v._I||($v._I=new $v),$M=$v._I.parseByData($I),$v._I._clear(),$M},$v.parseAnimationData=function($I){var $M;return $v._I||($v._I=new $v),$v._I.setUpAniData($I),($M={}).animationList=$v._I.animationList,$M.animationDic=$v._I.animationDic,$v._I._clear(),$M},$v._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],$v._temParam=[],$v._I=null,$v._rootMatrix=null,$d($v,["_tempMt",function(){return this._tempMt=new $R}]),$v.__init$=function(){$q=function(){function $I(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return $V($I,""),$I.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),$P.recover("GraphicNode",this)},$I.create=function(){return $P.getItemByClass("GraphicNode",$I)},$I}()},$v}($wI));$a.__init([$H,$dI,$o,$x,$G,$T,$I,$aI])}(window,document,Laya),function($I,$M,$E){$E.un,$E.uns,$E.static;var $Z=$E.class;$E.getset,$E.__newvec;new(function(){function $I(){}return $Z($I,"LayaMain"),$I}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($I,$M){"use strict";for(var $E in Object.defineProperty($M,"__esModule",{value:!0}),Laya){var $Z=Laya[$E];$Z&&$Z.__isclass&&($M[$E]=$Z)}}),function($I,$M,$O){$O.un,$O.uns;var $c=$O.static,$Q=$O.class,$Z=$O.getset,$n=$O.__newvec,$B=laya.maths.Arith,$A=laya.maths.Bezier,$E=laya.resource.Bitmap,$p=laya.utils.Browser,$d=laya.utils.Byte,$t=laya.utils.Color,$a=(laya.filters.ColorFilter,$O.Config),$i=laya.resource.Context,$m=(laya.events.Event,laya.filters.Filter),$f=laya.display.Graphics,$H=laya.resource.HTMLCanvas,$V=(laya.utils.HTMLChar,laya.resource.HTMLImage),$u=laya.resource.HTMLSubImage,$j=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),$T=laya.maths.Point,$q=laya.maths.Rectangle,$N=laya.renders.Render,$y=(laya.renders.RenderContext,laya.renders.RenderSprite),$$=laya.resource.Resource,$w=laya.resource.ResourceManager,$g=laya.utils.RunDriver,$v=laya.display.Sprite,$W=laya.display.Stage,$R=laya.utils.Stat,$z=laya.utils.StringKey,$L=(laya.display.css.Style,laya.system.System),$o=laya.display.Text,$S=laya.resource.Texture,$X=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),$C=laya.utils.VectorGraphManager;laya.utils.WordText;$O.interface("laya.webgl.shapes.IShape"),$O.interface("laya.webgl.submit.ISubmit"),$O.interface("laya.webgl.text.ICharSegment"),$O.interface("laya.webgl.canvas.save.ISaveData"),$O.interface("laya.webgl.resource.IMergeAtlasBitmap"),$O.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var $J=function(){function $I(){}$Q($I,"laya.filters.webgl.FilterActionGL");var $M=$I.prototype;return $O.imps($M,{"laya.filters.IFilterActionGL":!0}),$M.setValue=function($I){},$M.setValueMix=function($I){},$M.apply3d=function($I,$M,$E,$Z,$i){return null},$M.apply=function($I){return null},$Z(0,$M,"typeMix",function(){return 0}),$I}(),$x=function(){function $I(){}return $Q($I,"laya.webgl.shader.ShaderValue"),$I}(),$k=function(){var $Z,$i;function $I($I,$M,$E){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new $i,void 0===$I&&($I=0),void 0===$M&&($M=0),void 0===$E&&($E=0),this._cells=null,this._rowInfo=null,this._init($I,$M),this._atlasID=$E}$Q($I,"laya.webgl.atlas.AtlasGrid");var $M=$I.prototype;return $M.getAltasID=function(){return this._atlasID},$M.setAltasID=function($I){0<=$I&&(this._atlasID=$I)},$M.addTex=function($I,$M,$E){var $Z=this._get($M,$E);return 0==$Z.ret||(this._fill($Z.x,$Z.y,$M,$E,$I),this._texCount++),$Z},$M._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},$M._init=function($I,$M){if(this._width=$I,this._height=$M,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=$n(this._height);for(var $E=0;$E<this._height;$E++)this._rowInfo[$E]=new $Z;return this._clear(),!0},$M._get=function($I,$M){var $E=new $l;if($I>=this._failSize.width&&$M>=this._failSize.height)return $E;for(var $Z=-1,$i=-1,$n=this._width,$c=this._height,$f=this._cells,$d=0;$d<$c;$d++)if(!(this._rowInfo[$d].spaceCount<$I))for(var $H=0;$H<$n;){var $B=3*($d*$n+$H);if(0!=$f[$B]||$f[1+$B]<$I||$f[2+$B]<$M)$H+=$f[1+$B];else{$Z=$H,$i=$d;for(var $A=0;$A<$I;$A++)if($f[3*$A+$B+2]<$M){$Z=-1;break}if(!($Z<0))return $E.ret=!0,$E.x=$Z,$E.y=$i,$E;$H+=$f[1+$B]}}return $E},$M._fill=function($I,$M,$E,$Z,$i){var $n=this._width,$c=this._height;this._check($I+$E<=$n&&$M+$Z<=$c);for(var $f=$M;$f<$Z+$M;++$f){this._check(this._rowInfo[$f].spaceCount>=$E),this._rowInfo[$f].spaceCount-=$E;for(var $d=0;$d<$E;$d++){var $H=3*($I+$f*$n+$d);this._check(0==this._cells[$H]),this._cells[$H]=$i,this._cells[1+$H]=$E,this._cells[2+$H]=$Z}}if(0<$I)for($f=0;$f<$Z;++$f){var $B=0;for($d=$I-1;0<=$d&&0==this._cells[3*(($M+$f)*$n+$d)];--$d,++$B);for($d=$B;0<$d;--$d)this._cells[3*(($M+$f)*$n+$I-$d)+1]=$d,this._check(0<$d)}if(0<$M)for($d=$I;$d<$I+$E;++$d){for($B=0,$f=$M-1;0<=$f&&0==this._cells[3*($d+$f*$n)];--$f,$B++);for($f=$B;0<$f;--$f)this._cells[3*($d+($M-$f)*$n)+2]=$f,this._check(0<$f)}},$M._check=function($I){0==$I&&console.log("xtexMerger 错误啦")},$M._clear=function(){for(var $I=this._texCount=0;$I<this._height;$I++)this._rowInfo[$I].spaceCount=this._width;for(var $M=0;$M<this._height;$M++)for(var $E=0;$E<this._width;$E++){var $Z=3*($M*this._width+$E);this._cells[$Z]=0,this._cells[1+$Z]=this._width-$E,this._cells[2+$Z]=this._width-$M}this._failSize.width=this._width+1,this._failSize.height=this._height+1},$I.__init$=function(){$Z=function(){function $I(){this.spaceCount=0}return $Q($I,""),$I}(),$i=function(){function $I(){this.width=0,this.height=0}return $Q($I,""),$I}()},$I}(),$r=function(){function $N($I,$M,$E,$Z){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=$I,this._height=$M,this._gridSize=$E,this._maxAtlaserCount=$Z,this._gridNumX=$I/$E,this._gridNumY=$M/$E,this._curAtlasIndex=0,this._atlaserArray=[]}$Q($N,"laya.webgl.atlas.AtlasResourceManager");var $I=$N.prototype;return $I.setAtlasParam=function($I,$M,$E,$Z){if(1==this._setAtlasParam)return $N._sid_=0,this._width=$I,this._height=$M,this._gridSize=$E,this._maxAtlaserCount=$Z,this._gridNumX=$I/$E,this._gridNumY=$M/$E,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},$I.pushData=function($I){var $M,$E=$I.bitmap,$Z=-1,$i=null,$n=0,$c=0;for($n=0,$M=this._atlaserArray.length;$n<$M&&($c=(this._curAtlasIndex+$n)%$M,-1==($Z=($i=this._atlaserArray[$c]).findBitmapIsExist($E)));$n++);if(-1!=$Z){var $f=$i.InAtlasWebGLImagesOffsetValue[$Z];return $t=$f[0],$V=$f[1],$i.addToAtlas($I,$t,$V),!0}this._setAtlasParam=!1;for(var $d=Math.ceil(($I.bitmap.width+2)/this._gridSize),$H=Math.ceil(($I.bitmap.height+2)/this._gridSize),$B=!1,$A=0;$A<2;$A++){var $Q=this._maxAtlaserCount;for($n=0;$n<$Q;$n++){$c=(this._curAtlasIndex+$n)%$Q,this._atlaserArray.length-1>=$c||this._atlaserArray.push(new $qI(this._gridNumX,this._gridNumY,this._width,this._height,$N._sid_++));var $p=this._atlaserArray[$c],$t=0,$V=0,$u=$p.addTex(1,$d,$H);if($u.ret){$t=$u.x*this._gridSize+1,$V=$u.y*this._gridSize+1,$E.lock=!0,$p.addToAtlasTexture($E,$t,$V),$p.addToAtlas($I,$t,$V),$B=!0,this._curAtlasIndex=$c;break}}if($B)break;this._atlaserArray.push(new $qI(this._gridNumX,this._gridNumY,this._width,this._height,$N._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return $B||console.log(">>>AtlasManager pushData error"),$B},$I.addToAtlas=function($I){laya.webgl.atlas.AtlasResourceManager.instance.pushData($I)},$I.garbageCollection=function(){if(!0===this._needGC){for(var $I=this._atlaserArray.length-this._maxAtlaserCount,$M=0;$M<$I;$M++)this._atlaserArray[$M].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+$I),this._atlaserArray.splice(0,$I),this._needGC=!1}return!0},$I.freeAll=function(){for(var $I=0,$M=this._atlaserArray.length;$I<$M;$I++)this._atlaserArray[$I].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},$I.getAtlaserCount=function(){return this._atlaserArray.length},$I.getAtlaserByIndex=function($I){return this._atlaserArray[$I]},$Z(1,$N,"instance",function(){return $N._Instance||($N._Instance=new $N(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),$N._Instance}),$Z(1,$N,"enabled",function(){return $a.atlasEnable}),$Z(1,$N,"atlasLimitWidth",function(){return $N._atlasLimitWidth},function($I){$N._atlasLimitWidth=$I}),$Z(1,$N,"atlasLimitHeight",function(){return $N._atlasLimitHeight},function($I){$N._atlasLimitHeight=$I}),$N._enable=function(){$a.atlasEnable=!0},$N._disable=function(){$a.atlasEnable=!1},$N.__init__=function(){$N.atlasTextureWidth=2048,$N.atlasTextureHeight=2048,$N.maxTextureCount=6,$N.atlasLimitWidth=512,$N.atlasLimitHeight=512},$N._atlasLimitWidth=0,$N._atlasLimitHeight=0,$N.gridSize=16,$N.atlasTextureWidth=0,$N.atlasTextureHeight=0,$N.maxTextureCount=0,$N._atlasRestore=0,$N.BOARDER_TYPE_NO=0,$N.BOARDER_TYPE_RIGHT=1,$N.BOARDER_TYPE_LEFT=2,$N.BOARDER_TYPE_BOTTOM=4,$N.BOARDER_TYPE_TOP=8,$N.BOARDER_TYPE_ALL=15,$N._sid_=0,$N._Instance=null,$N}(),$l=function(){function $I(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return $Q($I,"laya.webgl.atlas.MergeFillInfo"),$I}(),$F=function(){function $M(){}return $Q($M,"laya.webgl.canvas.BlendMode"),$M._init_=function($I){$M.fns=[$M.BlendNormal,$M.BlendAdd,$M.BlendMultiply,$M.BlendScreen,$M.BlendOverlay,$M.BlendLight,$M.BlendMask,$M.BlendDestinationOut],$M.targetFns=[$M.BlendNormalTarget,$M.BlendAddTarget,$M.BlendMultiplyTarget,$M.BlendScreenTarget,$M.BlendOverlayTarget,$M.BlendLightTarget,$M.BlendMask,$M.BlendDestinationOut]},$M.BlendNormal=function($I){$I.blendFunc(1,771)},$M.BlendAdd=function($I){$I.blendFunc(1,772)},$M.BlendMultiply=function($I){$I.blendFunc(774,771)},$M.BlendScreen=function($I){$I.blendFunc(1,1)},$M.BlendOverlay=function($I){$I.blendFunc(1,769)},$M.BlendLight=function($I){$I.blendFunc(1,1)},$M.BlendNormalTarget=function($I){$I.blendFunc(1,771)},$M.BlendAddTarget=function($I){$I.blendFunc(1,772)},$M.BlendMultiplyTarget=function($I){$I.blendFunc(774,771)},$M.BlendScreenTarget=function($I){$I.blendFunc(1,1)},$M.BlendOverlayTarget=function($I){$I.blendFunc(1,769)},$M.BlendLightTarget=function($I){$I.blendFunc(1,1)},$M.BlendMask=function($I){$I.blendFunc(0,770)},$M.BlendDestinationOut=function($I){$I.blendFunc(0,0)},$M.activeBlendFunction=null,$M.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],$M.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},$M.NORMAL="normal",$M.ADD="add",$M.MULTIPLY="multiply",$M.SCREEN="screen",$M.LIGHT="light",$M.OVERLAY="overlay",$M.DESTINATIONOUT="destination-out",$M.fns=[],$M.targetFns=[],$M}(),$e=function(){function $E($I){this._color=$t.create("black"),this.setValue($I)}$Q($E,"laya.webgl.canvas.DrawStyle");var $I=$E.prototype;return $I.setValue=function($I){if($I){if("string"==typeof $I)return void(this._color=$t.create($I));if($I instanceof laya.utils.Color)return void(this._color=$I)}},$I.reset=function(){this._color=$t.create("black")},$I.equal=function($I){return"string"==typeof $I?this._color.strColor===$I:$I instanceof laya.utils.Color&&this._color.numColor===$I.numColor},$I.toColorStr=function(){return this._color.strColor},$E.create=function($I){var $M;if($I&&("string"==typeof $I?$M=$t.create($I):$I instanceof laya.utils.Color&&($M=$I),$M))return $M._drawStyle||($M._drawStyle=new $E($I));return laya.webgl.canvas.DrawStyle.DEFAULT},$c($E,["DEFAULT",function(){return this.DEFAULT=new $E("#000000")}]),$E}(),$_=function(){function $I(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];$wI.mainContext;this.ib=$bI.create(35048),this.vb=$UI.create(5)}$Q($I,"laya.webgl.canvas.Path");var $M=$I.prototype;return $M.addPoint=function($I,$M){this.tempArray.push($I,$M)},$M.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},$M.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},$M.polygon=function($I,$M,$E,$Z,$i,$n){var $c;return this.geomatrys.push(this._curGeomatry=$c=new $zI($I,$M,$E,$Z,$i,$n)),$Z||($c.fill=!1),null==$n&&($c.borderWidth=0),$c},$M.setGeomtry=function($I){this.geomatrys.push(this._curGeomatry=$I)},$M.drawLine=function($I,$M,$E,$Z,$i){var $n;return this.closePath?this.geomatrys.push(this._curGeomatry=$n=new $RI($I,$M,$E,$Z,$i)):this.geomatrys.push(this._curGeomatry=$n=new $WI($I,$M,$E,$Z,$i)),$n.fill=!1,$n},$M.update=function(){var $I=this.ib._byteLength,$M=this.geomatrys.length;this.offset=$I;for(var $E=this.geoStart;$E<$M;$E++)this.geomatrys[$E].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=$M,this.count=(this.ib._byteLength-$I)/$VI.BYTES_PIDX},$M.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},$M.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},$I}(),$h=function(){function $f(){}$Q($f,"laya.webgl.canvas.save.SaveBase");var $I=$f.prototype;return $O.imps($I,{"laya.webgl.canvas.save.ISaveData":!0}),$I.isSaveMark=function(){return!1},$I.restore=function($I){this._dataObj[this._valueName]=this._value,($f._cache[$f._cache._length++]=this)._newSubmit&&($I._curSubmit=$nI.RENDERBASE,$I._renderKey=0)},$f._createArray=function(){var $I=[];return $I._length=0,$I},$f._init=function(){var $I=$f._namemap={};return $I[1]="ALPHA",$I[2]="fillStyle",$I[8]="font",$I[256]="lineWidth",$I[512]="strokeStyle",$I[8192]="_mergeID",$I[1024]=$I[2048]=$I[4096]=[],$I[16384]="textBaseline",$I[32768]="textAlign",$I[65536]="_nBlendType",$I[1048576]="shader",$I[2097152]="filters",$I},$f.save=function($I,$M,$E,$Z){if(($I._saveMark._saveuse&$M)!==$M){$I._saveMark._saveuse|=$M;var $i=$f._cache,$n=0<$i._length?$i[--$i._length]:new $f;$n._value=$E[$n._valueName=$f._namemap[$M]],$n._dataObj=$E,$n._newSubmit=$Z;var $c=$I._save;$c[$c._length++]=$n}},$f._cache=laya.webgl.canvas.save.SaveBase._createArray(),$f._namemap=$f._init(),$f}(),$P=function(){function $n(){this._clipRect=new $q}$Q($n,"laya.webgl.canvas.save.SaveClipRect");var $I=$n.prototype;return $O.imps($I,{"laya.webgl.canvas.save.ISaveData":!0}),$I.isSaveMark=function(){return!1},$I.restore=function($I){$I._clipRect=this._clipSaveRect,($n._cache[$n._cache._length++]=this)._submitScissor.submitLength=$I._submits._length-this._submitScissor.submitIndex,$I._curSubmit=$nI.RENDERBASE,$I._renderKey=0},$n.save=function($I,$M){if(131072!=(131072&$I._saveMark._saveuse)){$I._saveMark._saveuse|=131072;var $E=$n._cache,$Z=0<$E._length?$E[--$E._length]:new $n;$Z._clipSaveRect=$I._clipRect,$I._clipRect=$Z._clipRect.copyFrom($I._clipRect),$Z._submitScissor=$M;var $i=$I._save;$i[$i._length++]=$Z}},$c($n,["_cache",function(){return this._cache=$h._createArray()}]),$n}(),$D=function(){function $p(){this._contextX=0,this._contextY=0,this._clipRect=new $q,this._rect=new $q,this._matrix=new $j}$Q($p,"laya.webgl.canvas.save.SaveClipRectStencil");var $I=$p.prototype;return $O.imps($I,{"laya.webgl.canvas.save.ISaveData":!0}),$I.isSaveMark=function(){return!1},$I.restore=function($I){$BI.restore($I,this._rect,this._saveMatrix,this._contextX,this._contextY),$I._clipRect=this._clipSaveRect,$I._curMat=this._saveMatrix,$I._x=this._contextX,$I._y=this._contextY,$p._cache[$p._cache._length++]=this,$I._curSubmit=$nI.RENDERBASE},$p.save=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){if(262144!=(262144&$I._saveMark._saveuse)){$I._saveMark._saveuse|=262144;var $B=$p._cache,$A=0<$B._length?$B[--$B._length]:new $p;$A._clipSaveRect=$I._clipRect,$A._clipRect.setTo($c,$f,$d,$H),$I._clipRect=$A._clipRect,$A._rect.x=$E,$A._rect.y=$Z,$A._rect.width=$i,$A._rect.height=$n,$A._contextX=$I._x,$A._contextY=$I._y,$A._saveMatrix=$I._curMat,$I._curMat.copyTo($A._matrix),$I._curMat=$A._matrix,$A._submitStencil=$M;var $Q=$I._save;$Q[$Q._length++]=$A}},$c($p,["_cache",function(){return this._cache=$h._createArray()}]),$p}(),$G=function(){function $Z(){this._saveuse=0}$Q($Z,"laya.webgl.canvas.save.SaveMark");var $I=$Z.prototype;return $O.imps($I,{"laya.webgl.canvas.save.ISaveData":!0}),$I.isSaveMark=function(){return!0},$I.restore=function($I){$I._saveMark=this._preSaveMark,$Z._no[$Z._no._length++]=this},$Z.Create=function($I){var $M=$Z._no,$E=0<$M._length?$M[--$M._length]:new $Z;return $E._saveuse=0,$E._preSaveMark=$I._saveMark,$I._saveMark=$E},$c($Z,["_no",function(){return this._no=$h._createArray()}]),$Z}(),$Y=function(){function $n(){this._matrix=new $j}$Q($n,"laya.webgl.canvas.save.SaveTransform");var $I=$n.prototype;return $O.imps($I,{"laya.webgl.canvas.save.ISaveData":!0}),$I.isSaveMark=function(){return!1},$I.restore=function($I){$I._curMat=this._savematrix,$n._no[$n._no._length++]=this},$n.save=function($I){var $M=$I._saveMark;if(2048!=(2048&$M._saveuse)){$M._saveuse|=2048;var $E=$n._no,$Z=0<$E._length?$E[--$E._length]:new $n;$Z._savematrix=$I._curMat,$I._curMat=$I._curMat.copyTo($Z._matrix);var $i=$I._save;$i[$i._length++]=$Z}},$c($n,["_no",function(){return this._no=$h._createArray()}]),$n}(),$K=function(){function $i(){}$Q($i,"laya.webgl.canvas.save.SaveTranslate");var $I=$i.prototype;return $O.imps($I,{"laya.webgl.canvas.save.ISaveData":!0}),$I.isSaveMark=function(){return!1},$I.restore=function($I){$I._curMat;$I._x=this._x,$I._y=this._y,$i._no[$i._no._length++]=this},$i.save=function($I){var $M=$i._no,$E=0<$M._length?$M[--$M._length]:new $i;$E._x=$I._x,$E._y=$I._y;var $Z=$I._save;$Z[$Z._length++]=$E},$c($i,["_no",function(){return this._no=$h._createArray()}]),$i}(),$s=function(){function $I(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new $q}$Q($I,"laya.webgl.resource.RenderTargetMAX");var $M=$I.prototype;return $M.setSP=function($I){this._sp=$I},$M.size=function($I,$M){var $E=this;this._width!==$I||this._height!==$M?(this.repaint=!0,this._width=$I,this._height=$M,this.target?this.target.size($I,$M):this.target=$CI.create($I,$M),this.target.hasListener("recovered")||this.target.on("recovered",this,function($I){$O.timer.callLater($E._sp,$E._sp.repaint)})):this.target.size($I,$M)},$M._flushToTarget=function($I,$M){if(!$M._destroy){var $E=$yI.worldScissorTest,$Z=$yI.worldClipRect;$yI.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,$yI.worldScissorTest=!1,$wI.mainContext.disable(3089);var $i=$yI.worldAlpha,$n=$yI.worldMatrix4,$c=$yI.worldMatrix,$f=$yI.worldFilters,$d=$yI.worldShaderDefines;if($yI.worldMatrix=$j.EMPTY,$yI.restoreTempArray(),$yI.worldMatrix4=$yI.TEMPMAT4_ARRAY,$yI.worldAlpha=1,$yI.worldFilters=null,$yI.worldShaderDefines=null,$XI.activeShader=null,$M.start(),$a.showCanvasMark?$M.clear(0,1,0,.3):$M.clear(0,0,0,0),$I.flush(),$M.end(),$XI.activeShader=null,$yI.worldAlpha=$i,$yI.worldMatrix4=$n,$yI.worldMatrix=$c,$yI.worldFilters=$f,$yI.worldShaderDefines=$d,$yI.worldScissorTest=$E){var $H=$yI.height-$Z.y-$Z.height;$wI.mainContext.scissor($Z.x,$H,$Z.width,$Z.height),$wI.mainContext.enable(3089)}$yI.worldClipRect=$Z}},$M.flush=function($I){this.repaint&&(this._flushToTarget($I,this.target),this.repaint=!1)},$M.drawTo=function($I,$M,$E,$Z,$i){$I.drawTexture(this.target.getTexture(),$M,$E,$Z,$i,0,0)},$M.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},$I}(),$b=function(){function $I(){this.ALPHA=1,this.shaderType=0,this.defines=new $vI}return $Q($I,"laya.webgl.shader.d2.Shader2D"),$I.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},$I.__init__=function(){var $I,$M;$GI.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),$GI.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),$GI.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),$GI.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),$GI.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),$GI.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),$GI.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),$GI.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),$I="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$M='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$GI.preCompile2D(0,1,$I,$M,null),$I="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",$M='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',$GI.preCompile2D(0,2,$I,$M,null),$I="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",$M="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",$GI.preCompile2D(0,4,$I,$M,null),$I="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",$M='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',$GI.preCompile2D(0,256,$I,$M,null),$I="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",$M="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",$GI.preCompile2D(0,512,$I,$M,null)},$I}(),$U=function(){function $M($I,$M,$E){this._value=0,this._name2int=$I,this._int2name=$M,this._int2nameMap=$E}$Q($M,"laya.webgl.shader.ShaderDefines");var $I=$M.prototype;return $I.add=function($I){return"string"==typeof $I&&($I=this._name2int[$I]),this._value|=$I,this._value},$I.addInt=function($I){return this._value|=$I,this._value},$I.remove=function($I){return"string"==typeof $I&&($I=this._name2int[$I]),this._value&=~$I,this._value},$I.isDefine=function($I){return(this._value&$I)===$I},$I.getValue=function(){return this._value},$I.setValue=function($I){this._value=$I},$I.toNameDic=function(){var $I=this._int2nameMap[this._value];return $I||$M._toText(this._value,this._int2name,this._int2nameMap)},$M._reg=function($I,$M,$E,$Z){$Z[$E[$I]=$M]=$I},$M._toText=function($I,$M,$E){var $Z=$E[$I];if($Z)return $Z;for(var $i={},$n=1,$c=0;$c<32&&!($I<($n=1<<$c));$c++)if($I&$n){var $f=$M[$n];$f&&($i[$f]="")}return $E[$I]=$i},$M._toInt=function($I,$M){for(var $E=$I.split("."),$Z=0,$i=0,$n=$E.length;$i<$n;$i++){var $c=$M[$E[$i]];if(!$c)throw new Error("Defines to int err:"+$I+"/"+$E[$i]);$Z|=$c}return $Z},$M}(),$II=function(){function $c(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new $j}$Q($c,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var $I=$c.prototype;return $I.init=function($I,$M,$E){if($M)this._vs=$M;else{this._vs=[];var $Z=$I.width,$i=$I.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push($Z,0,1,0,1,1,1,1),this._vs.push($Z,$i,1,1,1,1,1,1),this._vs.push(0,$i,0,1,1,1,1,1)}$E?this._ps=$E:($c._defaultPS||($c._defaultPS=[]).push(0,1,3,3,1,2),this._ps=$c._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=$I},$I.init2=function($I,$M,$E,$Z,$i){this.transform&&(this.transform=null),$E?this._ps=$E:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=$Z,this._uvs=$i,this.mEleNum=this._ps.length,this.mTexture=$I,($N.isConchNode||$N.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},$I._initMyData=function(){var $I=0,$M=0,$E=4*this._verticles.length;this._vs=$c._tempVS;var $Z=!1;if($N.isConchNode||$N.isConchApp?(this._vs.length=$E,$Z=!0):this._vs.length<$E&&(this._vs.length=$E,$Z=!0),$c._tVSLen=$E,$Z)for(;$I<$E;)this._vs[$I]=this._verticles[$M],this._vs[$I+1]=this._verticles[$M+1],this._vs[$I+2]=this._uvs[$M],this._vs[$I+3]=this._uvs[$M+1],this._vs[$I+4]=1,this._vs[$I+5]=1,this._vs[$I+6]=1,this._vs[$I+7]=1,$I+=8,$M+=2;else for(;$I<$E;)this._vs[$I]=this._verticles[$M],this._vs[$I+1]=this._verticles[$M+1],this._vs[$I+2]=this._uvs[$M],this._vs[$I+3]=this._uvs[$M+1],$I+=8,$M+=2},$I.getData2=function($I,$M,$E){var $Z;this.mVBBuffer=$I,this.mIBBuffer=$M,this._initMyData(),$I.appendEx2(this._vs,Float32Array,$c._tVSLen,4),this._indexStart=$M._byteLength,($Z=$c._tempIB).length<this._ps.length&&($Z.length=this._ps.length);for(var $i=0,$n=this._ps.length;$i<$n;$i++)$Z[$i]=this._ps[$i]+$E;$M.appendEx2($Z,Uint16Array,this._ps.length,2)},$I.getData=function($I,$M,$E){if(this.mVBBuffer=$I,this.mIBBuffer=$M,$I.append(this.mVBData),this._indexStart=$M._byteLength,this.mIBData.start!=$E){for(var $Z=0,$i=this._ps.length;$Z<$i;$Z++)this.mIBData[$Z]=this._ps[$Z]+$E;this.mIBData.start=$E}$M.append(this.mIBData)},$I.render=function($I,$M,$E){if($N.isWebGL&&this.mTexture){$I._renderKey=0,$I._shader2D.glTexture=null,$MI.getInstance().addSkinMesh(this);var $Z=$nI.createShape($I,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,$mI.create(512,0));this.transform||(this.transform=$j.EMPTY),this.transform.translate($M,$E),$j.mul(this.transform,$I._curMat,this._tempMatrix),this.transform.translate(-$M,-$E);var $i=$Z.shaderValue,$n=$i.u_mmat2||$yI.getMatrArray();$yI.mat2MatArray(this._tempMatrix,$n),$i.textureHost=this.mTexture,$i.offsetX=0,$i.offsetY=0,$i.u_mmat2=$n,$i.ALPHA=$I._shader2D.ALPHA,$I._submits[$I._submits._length++]=$Z}else $N.isConchApp&&this.mTexture&&(this.transform||(this.transform=$j.EMPTY),$I.setSkinMesh&&$I.setSkinMesh($M,$E,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},$c._tempVS=[],$c._tempIB=[],$c._defaultPS=null,$c._tVSLen=0,$c}(),$MI=function(){function $I(){this.ib=null,this.vb=null;$wI.mainContext;this.ib=$bI.create(35048),this.vb=$UI.create(8)}$Q($I,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var $M=$I.prototype;return $M.addSkinMesh=function($I){$I.getData2(this.vb,this.ib,this.vb._byteLength/32)},$M.reset=function(){this.vb.clear(),this.ib.clear()},$I.getInstance=function(){return $I.instance=$I.instance||new $I},$I.instance=null,$I}(),$EI=function(){function $I($I,$M,$E,$Z,$i,$n,$c,$f,$d){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===$d&&($d=0),this.x=$I,this.y=$M,this.width=$E,this.height=$Z,this.edges=$i,this.color=$n,this.borderWidth=$c,this.borderColor=$f}$Q($I,"laya.webgl.shapes.BasePoly");var $M=$I.prototype;return $O.imps($M,{"laya.webgl.shapes.IShape":!0}),$M.getData=function($I,$M,$E){},$M.rebuild=function($I){},$M.setMatrix=function($I){},$M.needUpdate=function($I){return!0},$M.sector=function($I,$M,$E){var $Z=this.x,$i=this.y,$n=this.edges,$c=(this.r1-this.r0)/$n,$f=this.width,$d=this.height,$H=this.color,$B=($H>>16&255)/255,$A=($H>>8&255)/255,$Q=(255&$H)/255;$I.push($Z,$i,$B,$A,$Q);for(var $p=0;$p<$n+1;$p++)$I.push($Z+Math.sin($c*$p+this.r0)*$f,$i+Math.cos($c*$p+this.r0)*$d),$I.push($B,$A,$Q);for($p=0;$p<$n;$p++)$M.push($E,$E+$p+1,$E+$p+2)},$M.createLine2=function($I,$M,$E,$Z,$i,$n){var $c,$f,$d,$H,$B,$A,$Q,$p,$t,$V,$u,$N,$y,$$,$w,$g,$O,$a,$m,$j,$T=$I.concat(),$q=$i,$v=this.borderColor,$W=($v>>16&255)/255,$R=($v>>8&255)/255,$z=(255&$v)/255,$L=$T.length/2,$o=$Z,$S=$E/2;$d=$T[0],$H=$T[1],$V=$d-($B=$T[2]),$t=($t=-($H-($A=$T[3])))/($j=Math.sqrt($t*$t+$V*$V))*$S,$V=$V/$j*$S,$q.push($d-$t+this.x,$H-$V+this.y,$W,$R,$z,$d+$t+this.x,$H+$V+this.y,$W,$R,$z);for(var $X=1;$X<$L-1;$X++)$d=$T[2*($X-1)],$H=$T[2*($X-1)+1],$B=$T[2*$X],$A=$T[2*$X+1],$Q=$T[2*($X+1)],$p=$T[2*($X+1)+1],$V=$d-$B,$N=$B-$Q,$w=(-($t=($t=-($H-$A))/($j=Math.sqrt($t*$t+$V*$V))*$S)+$d)*(-($V=$V/$j*$S)+$A)-(-$t+$B)*(-$V+$H),$a=(-($u=($u=-($A-$p))/($j=Math.sqrt($u*$u+$N*$N))*$S)+$Q)*(-($N=$N/$j*$S)+$A)-(-$u+$B)*(-$N+$p),$m=($y=-$V+$H-(-$V+$A))*($O=-$u+$B-(-$u+$Q))-($g=-$N+$p-(-$N+$A))*($$=-$t+$B-(-$t+$d)),Math.abs($m)<.1?($m+=10.1,$q.push($B-$t+this.x,$A-$V+this.y,$W,$R,$z,$B+$t+this.x,$A+$V+this.y,$W,$R,$z)):((($c=($$*$a-$O*$w)/$m)-$B)*($c-$B)+(($f=($g*$w-$y*$a)/$m)-$A)+($f-$A),$q.push($c+this.x,$f+this.y,$W,$R,$z,$B-($c-$B)+this.x,$A-($f-$A)+this.y,$W,$R,$z));$d=$T[$T.length-4],$H=$T[$T.length-3],$V=$d-($B=$T[$T.length-2]),$t=($t=-($H-($A=$T[$T.length-1])))/($j=Math.sqrt($t*$t+$V*$V))*$S,$V=$V/$j*$S,$q.push($B-$t+this.x,$A-$V+this.y,$W,$R,$z,$B+$t+this.x,$A+$V+this.y,$W,$R,$z);var $C=$n;for($X=1;$X<$C;$X++)$M.push($o+2*($X-1),$o+2*($X-1)+1,$o+2*$X+1,$o+2*$X+1,$o+2*$X,$o+2*($X-1));return $q},$M.createLine=function($I,$M,$E,$Z){var $i=$I.concat(),$n=$I,$c=this.borderColor,$f=($c>>16&255)/255,$d=($c>>8&255)/255,$H=(255&$c)/255;$i.splice(0,5);var $B,$A,$Q,$p,$t,$V,$u,$N,$y,$$,$w,$g,$O,$a,$m,$j,$T,$q,$v,$W,$R=$i.length/5,$z=$Z,$L=$E/2;$Q=$i[0],$p=$i[1],$$=$Q-($t=$i[5]),$y=($y=-($p-($V=$i[6])))/($W=Math.sqrt($y*$y+$$*$$))*$L,$$=$$/$W*$L,$n.push($Q-$y,$p-$$,$f,$d,$H,$Q+$y,$p+$$,$f,$d,$H);for(var $o=1;$o<$R-1;$o++)$Q=$i[5*($o-1)],$p=$i[5*($o-1)+1],$t=$i[5*$o],$V=$i[5*$o+1],$u=$i[5*($o+1)],$N=$i[5*($o+1)+1],$$=$Q-$t,$g=$t-$u,$m=(-($y=($y=-($p-$V))/($W=Math.sqrt($y*$y+$$*$$))*$L)+$Q)*(-($$=$$/$W*$L)+$V)-(-$y+$t)*(-$$+$p),$q=(-($w=($w=-($V-$N))/($W=Math.sqrt($w*$w+$g*$g))*$L)+$u)*(-($g=$g/$W*$L)+$V)-(-$w+$t)*(-$g+$N),$v=($O=-$$+$p-(-$$+$V))*($T=-$w+$t-(-$w+$u))-($j=-$g+$N-(-$g+$V))*($a=-$y+$t-(-$y+$Q)),Math.abs($v)<.1?($v+=10.1,$n.push($t-$y,$V-$$,$f,$d,$H,$t+$y,$V+$$,$f,$d,$H)):((($B=($a*$q-$T*$m)/$v)-$t)*($B-$t)+(($A=($j*$m-$O*$q)/$v)-$V)+($A-$V),$n.push($B,$A,$f,$d,$H,$t-($B-$t),$V-($A-$V),$f,$d,$H));$Q=$i[$i.length-10],$p=$i[$i.length-9],$$=$Q-($t=$i[$i.length-5]),$y=($y=-($p-($V=$i[$i.length-4])))/($W=Math.sqrt($y*$y+$$*$$))*$L,$$=$$/$W*$L,$n.push($t-$y,$V-$$,$f,$d,$H,$t+$y,$V+$$,$f,$d,$H);var $S=this.edges+1;for($o=1;$o<$S;$o++)$M.push($z+2*($o-1),$z+2*($o-1)+1,$z+2*$o+1,$z+2*$o+1,$z+2*$o,$z+2*($o-1));return $n},$M.createLoopLine=function($I,$M,$E,$Z,$i,$n){var $c=$I.concat(),$f=$i||$I,$d=this.borderColor,$H=($d>>16&255)/255,$B=($d>>8&255)/255,$A=(255&$d)/255;$c.splice(0,5);var $Q=[$c[0],$c[1]],$p=[$c[$c.length-5],$c[$c.length-4]],$t=$p[0]+.5*($Q[0]-$p[0]),$V=$p[1]+.5*($Q[1]-$p[1]);$c.unshift($t,$V,0,0,0),$c.push($t,$V,0,0,0);var $u,$N,$y,$$,$w,$g,$O,$a,$m,$j,$T,$q,$v,$W,$R,$z,$L,$o,$S,$X,$C=$c.length/5,$J=$Z,$x=$E/2;$y=$c[0],$$=$c[1],$j=$y-($w=$c[5]),$m=($m=-($$-($g=$c[6])))/($X=Math.sqrt($m*$m+$j*$j))*$x,$j=$j/$X*$x,$f.push($y-$m,$$-$j,$H,$B,$A,$y+$m,$$+$j,$H,$B,$A);for(var $k=1;$k<$C-1;$k++)$y=$c[5*($k-1)],$$=$c[5*($k-1)+1],$w=$c[5*$k],$g=$c[5*$k+1],$O=$c[5*($k+1)],$a=$c[5*($k+1)+1],$j=$y-$w,$q=$w-$O,$R=(-($m=($m=-($$-$g))/($X=Math.sqrt($m*$m+$j*$j))*$x)+$y)*(-($j=$j/$X*$x)+$g)-(-$m+$w)*(-$j+$$),$o=(-($T=($T=-($g-$a))/($X=Math.sqrt($T*$T+$q*$q))*$x)+$O)*(-($q=$q/$X*$x)+$g)-(-$T+$w)*(-$q+$a),$S=($v=-$j+$$-(-$j+$g))*($L=-$T+$w-(-$T+$O))-($z=-$q+$a-(-$q+$g))*($W=-$m+$w-(-$m+$y)),Math.abs($S)<.1?($S+=10.1,$f.push($w-$m,$g-$j,$H,$B,$A,$w+$m,$g+$j,$H,$B,$A)):((($u=($W*$o-$L*$R)/$S)-$w)*($u-$w)+(($N=($z*$R-$v*$o)/$S)-$g)+($N-$g),$f.push($u,$N,$H,$B,$A,$w-($u-$w),$g-($N-$g),$H,$B,$A));$n&&($M=$n);var $r=this.edges+1;for($k=1;$k<$r;$k++)$M.push($J+2*($k-1),$J+2*($k-1)+1,$J+2*$k+1,$J+2*$k+1,$J+2*$k,$J+2*($k-1));return $M.push($J+2*($k-1),$J+2*($k-1)+1,$J+1,$J+1,$J,$J+2*($k-1)),$f},$I}(),$ZI=function(){function $V(){}return $Q($V,"laya.webgl.shapes.Earcut"),$V.earcut=function($I,$M,$E){$E=$E||2;var $Z,$i,$n,$c,$f,$d,$H,$B=$M&&$M.length,$A=$B?$M[0]*$E:$I.length,$Q=$V.linkedList($I,0,$A,$E,!0),$p=[];if(!$Q)return $p;if($B&&($Q=$V.eliminateHoles($I,$M,$Q,$E)),$I.length>80*$E){$Z=$n=$I[0],$i=$c=$I[1];for(var $t=$E;$t<$A;$t+=$E)($f=$I[$t])<$Z&&($Z=$f),($d=$I[$t+1])<$i&&($i=$d),$n<$f&&($n=$f),$c<$d&&($c=$d);$H=0!==($H=Math.max($n-$Z,$c-$i))?1/$H:0}return $V.earcutLinked($Q,$p,$E,$Z,$i,$H),$p},$V.linkedList=function($I,$M,$E,$Z,$i){var $n,$c;if($i===0<$V.signedArea($I,$M,$E,$Z))for($n=$M;$n<$E;$n+=$Z)$c=$V.insertNode($n,$I[$n],$I[$n+1],$c);else for($n=$E-$Z;$M<=$n;$n-=$Z)$c=$V.insertNode($n,$I[$n],$I[$n+1],$c);return $c&&$V.equals($c,$c.next)&&($V.removeNode($c),$c=$c.next),$c},$V.filterPoints=function($I,$M){if(!$I)return $I;$M||($M=$I);var $E,$Z=$I;do{if($E=!1,$Z.steiner||!$V.equals($Z,$Z.next)&&0!==$V.area($Z.prev,$Z,$Z.next))$Z=$Z.next;else{if($V.removeNode($Z),($Z=$M=$Z.prev)===$Z.next)break;$E=!0}}while($E||$Z!==$M);return $M},$V.earcutLinked=function($I,$M,$E,$Z,$i,$n,$c){if($I){!$c&&$n&&$V.indexCurve($I,$Z,$i,$n);for(var $f,$d,$H=$I;$I.prev!==$I.next;)if($f=$I.prev,$d=$I.next,$n?$V.isEarHashed($I,$Z,$i,$n):$V.isEar($I))$M.push($f.i/$E),$M.push($I.i/$E),$M.push($d.i/$E),$V.removeNode($I),$I=$d.next,$H=$d.next;else if(($I=$d)===$H){$c?1===$c?($I=$V.cureLocalIntersections($I,$M,$E),$V.earcutLinked($I,$M,$E,$Z,$i,$n,2)):2===$c&&$V.splitEarcut($I,$M,$E,$Z,$i,$n):$V.earcutLinked($V.filterPoints($I,null),$M,$E,$Z,$i,$n,1);break}}},$V.isEar=function($I){var $M=$I.prev,$E=$I,$Z=$I.next;if(0<=$V.area($M,$E,$Z))return!1;for(var $i=$I.next.next;$i!==$I.prev;){if($V.pointInTriangle($M.x,$M.y,$E.x,$E.y,$Z.x,$Z.y,$i.x,$i.y)&&0<=$V.area($i.prev,$i,$i.next))return!1;$i=$i.next}return!0},$V.isEarHashed=function($I,$M,$E,$Z){var $i=$I.prev,$n=$I,$c=$I.next;if(0<=$V.area($i,$n,$c))return!1;for(var $f=$i.x<$n.x?$i.x<$c.x?$i.x:$c.x:$n.x<$c.x?$n.x:$c.x,$d=$i.y<$n.y?$i.y<$c.y?$i.y:$c.y:$n.y<$c.y?$n.y:$c.y,$H=$i.x>$n.x?$i.x>$c.x?$i.x:$c.x:$n.x>$c.x?$n.x:$c.x,$B=$i.y>$n.y?$i.y>$c.y?$i.y:$c.y:$n.y>$c.y?$n.y:$c.y,$A=$V.zOrder($f,$d,$M,$E,$Z),$Q=$V.zOrder($H,$B,$M,$E,$Z),$p=$I.nextZ;$p&&$p.z<=$Q;){if($p!==$I.prev&&$p!==$I.next&&$V.pointInTriangle($i.x,$i.y,$n.x,$n.y,$c.x,$c.y,$p.x,$p.y)&&0<=$V.area($p.prev,$p,$p.next))return!1;$p=$p.nextZ}for($p=$I.prevZ;$p&&$p.z>=$A;){if($p!==$I.prev&&$p!==$I.next&&$V.pointInTriangle($i.x,$i.y,$n.x,$n.y,$c.x,$c.y,$p.x,$p.y)&&0<=$V.area($p.prev,$p,$p.next))return!1;$p=$p.prevZ}return!0},$V.cureLocalIntersections=function($I,$M,$E){var $Z=$I;do{var $i=$Z.prev,$n=$Z.next.next;!$V.equals($i,$n)&&$V.intersects($i,$Z,$Z.next,$n)&&$V.locallyInside($i,$n)&&$V.locallyInside($n,$i)&&($M.push($i.i/$E),$M.push($Z.i/$E),$M.push($n.i/$E),$V.removeNode($Z),$V.removeNode($Z.next),$Z=$I=$n),$Z=$Z.next}while($Z!==$I);return $Z},$V.splitEarcut=function($I,$M,$E,$Z,$i,$n){var $c=$I;do{for(var $f=$c.next.next;$f!==$c.prev;){if($c.i!==$f.i&&$V.isValidDiagonal($c,$f)){var $d=$V.splitPolygon($c,$f);return $c=$V.filterPoints($c,$c.next),$d=$V.filterPoints($d,$d.next),$V.earcutLinked($c,$M,$E,$Z,$i,$n),void $V.earcutLinked($d,$M,$E,$Z,$i,$n)}$f=$f.next}$c=$c.next}while($c!==$I)},$V.eliminateHoles=function($I,$M,$E,$Z){var $i,$n,$c,$f,$d,$H=[];for($i=0,$n=$M.length;$i<$n;$i++)$c=$M[$i]*$Z,$f=$i<$n-1?$M[$i+1]*$Z:$I.length,($d=$V.linkedList($I,$c,$f,$Z,!1))===$d.next&&($d.steiner=!0),$H.push($V.getLeftmost($d));for($H.sort($V.compareX),$i=0;$i<$H.length;$i++)$V.eliminateHole($H[$i],$E),$E=$V.filterPoints($E,$E.next);return $E},$V.compareX=function($I,$M){return $I.x-$M.x},$V.eliminateHole=function($I,$M){if($M=$V.findHoleBridge($I,$M)){var $E=$V.splitPolygon($M,$I);$V.filterPoints($E,$E.next)}},$V.findHoleBridge=function($I,$M){var $E,$Z=$M,$i=$I.x,$n=$I.y,$c=-1/0;do{if($n<=$Z.y&&$n>=$Z.next.y&&$Z.next.y!==$Z.y){var $f=$Z.x+($n-$Z.y)*($Z.next.x-$Z.x)/($Z.next.y-$Z.y);if($f<=$i&&$c<$f){if(($c=$f)===$i){if($n===$Z.y)return $Z;if($n===$Z.next.y)return $Z.next}$E=$Z.x<$Z.next.x?$Z:$Z.next}}$Z=$Z.next}while($Z!==$M);if(!$E)return null;if($i===$c)return $E.prev;var $d,$H=$E,$B=$E.x,$A=$E.y,$Q=1/0;for($Z=$E.next;$Z!==$H;)$i>=$Z.x&&$Z.x>=$B&&$i!==$Z.x&&$V.pointInTriangle($n<$A?$i:$c,$n,$B,$A,$n<$A?$c:$i,$n,$Z.x,$Z.y)&&(($d=Math.abs($n-$Z.y)/($i-$Z.x))<$Q||$d===$Q&&$Z.x>$E.x)&&$V.locallyInside($Z,$I)&&($E=$Z,$Q=$d),$Z=$Z.next;return $E},$V.indexCurve=function($I,$M,$E,$Z){for(var $i=$I;null===$i.z&&($i.z=$V.zOrder($i.x,$i.y,$M,$E,$Z)),$i.prevZ=$i.prev,$i.nextZ=$i.next,($i=$i.next)!==$I;);$i.prevZ.nextZ=null,$i.prevZ=null,$V.sortLinked($i)},$V.sortLinked=function($I){var $M,$E,$Z,$i,$n,$c,$f,$d,$H=1;do{for($E=$I,$n=$I=null,$c=0;$E;){for($c++,$Z=$E,$M=$f=0;$M<$H&&($f++,$Z=$Z.nextZ);$M++);for($d=$H;0<$f||0<$d&&$Z;)0!==$f&&(0===$d||!$Z||$E.z<=$Z.z)?($E=($i=$E).nextZ,$f--):($Z=($i=$Z).nextZ,$d--),$n?$n.nextZ=$i:$I=$i,$i.prevZ=$n,$n=$i;$E=$Z}$n.nextZ=null,$H*=2}while(1<$c);return $I},$V.zOrder=function($I,$M,$E,$Z,$i){return($I=1431655765&(($I=858993459&(($I=252645135&(($I=16711935&(($I=32767*($I-$E)*$i)|$I<<8))|$I<<4))|$I<<2))|$I<<1))|($M=1431655765&(($M=858993459&(($M=252645135&(($M=16711935&(($M=32767*($M-$Z)*$i)|$M<<8))|$M<<4))|$M<<2))|$M<<1))<<1},$V.getLeftmost=function($I){for(var $M=$I,$E=$I;$M.x<$E.x&&($E=$M),($M=$M.next)!==$I;);return $E},$V.pointInTriangle=function($I,$M,$E,$Z,$i,$n,$c,$f){return 0<=($i-$c)*($M-$f)-($I-$c)*($n-$f)&&0<=($I-$c)*($Z-$f)-($E-$c)*($M-$f)&&0<=($E-$c)*($n-$f)-($i-$c)*($Z-$f)},$V.isValidDiagonal=function($I,$M){return $I.next.i!==$M.i&&$I.prev.i!==$M.i&&!$V.intersectsPolygon($I,$M)&&$V.locallyInside($I,$M)&&$V.locallyInside($M,$I)&&$V.middleInside($I,$M)},$V.area=function($I,$M,$E){return($M.y-$I.y)*($E.x-$M.x)-($M.x-$I.x)*($E.y-$M.y)},$V.equals=function($I,$M){return $I.x===$M.x&&$I.y===$M.y},$V.intersects=function($I,$M,$E,$Z){return!!($V.equals($I,$M)&&$V.equals($E,$Z)||$V.equals($I,$Z)&&$V.equals($E,$M))||0<$V.area($I,$M,$E)!=0<$V.area($I,$M,$Z)&&0<$V.area($E,$Z,$I)!=0<$V.area($E,$Z,$M)},$V.intersectsPolygon=function($I,$M){var $E=$I;do{if($E.i!==$I.i&&$E.next.i!==$I.i&&$E.i!==$M.i&&$E.next.i!==$M.i&&$V.intersects($E,$E.next,$I,$M))return!0;$E=$E.next}while($E!==$I);return!1},$V.locallyInside=function($I,$M){return $V.area($I.prev,$I,$I.next)<0?0<=$V.area($I,$M,$I.next)&&0<=$V.area($I,$I.prev,$M):$V.area($I,$M,$I.prev)<0||$V.area($I,$I.next,$M)<0},$V.middleInside=function($I,$M){for(var $E=$I,$Z=!1,$i=($I.x+$M.x)/2,$n=($I.y+$M.y)/2;$E.y>$n!=$E.next.y>$n&&$E.next.y!==$E.y&&$i<($E.next.x-$E.x)*($n-$E.y)/($E.next.y-$E.y)+$E.x&&($Z=!$Z),($E=$E.next)!==$I;);return $Z},$V.splitPolygon=function($I,$M){var $E=new $iI($I.i,$I.x,$I.y),$Z=new $iI($M.i,$M.x,$M.y),$i=$I.next,$n=$M.prev;return($I.next=$M).prev=$I,($E.next=$i).prev=$E,($Z.next=$E).prev=$Z,($n.next=$Z).prev=$n,$Z},$V.insertNode=function($I,$M,$E,$Z){var $i=new $iI($I,$M,$E);return $Z?($i.next=$Z.next,($i.prev=$Z).next.prev=$i,$Z.next=$i):($i.prev=$i).next=$i,$i},$V.removeNode=function($I){$I.next.prev=$I.prev,$I.prev.next=$I.next,$I.prevZ&&($I.prevZ.nextZ=$I.nextZ),$I.nextZ&&($I.nextZ.prevZ=$I.prevZ)},$V.signedArea=function($I,$M,$E,$Z){for(var $i=0,$n=$M,$c=$E-$Z;$n<$E;$n+=$Z)$i+=($I[$c]-$I[$n])*($I[$n+1]+$I[$c+1]),$c=$n;return $i},$V}(),$iI=function(){function $I($I,$M,$E){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=$I,this.x=$M,this.y=$E,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return $Q($I,"laya.webgl.shapes.EarcutNode"),$I}(),$nI=(function(){function $I($I,$M,$E,$Z,$i,$n,$c){this.lineWidth=$I,this.lineColor=$M,this.lineAlpha=$E,this.fillColor=$Z,this.fillAlpha=$i,this.shape=$c,this.fill=$n}$Q($I,"laya.webgl.shapes.GeometryData");var $M=$I.prototype;$M.clone=function(){return new $I(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},$M.getIndexData=function(){return null},$M.getVertexData=function(){return null},$M.destroy=function(){this.shape=null}}(),function(){function $I($I){if($I instanceof Float32Array)this.points=$I;else if($I instanceof Array){$I.length;this.points=new Float32Array($I)}}$Q($I,"laya.webgl.shapes.Vertex");var $M=$I.prototype;$O.imps($M,{"laya.webgl.shapes.IShape":!0}),$M.getData=function($I,$M,$E){},$M.needUpdate=function($I){return!1},$M.rebuild=function($I){},$M.setMatrix=function($I){}}(),function(){function $d($I){void 0===$I&&($I=1e4),this._renderType=$I}$Q($d,"laya.webgl.submit.Submit");var $I=$d.prototype;return $O.imps($I,{"laya.webgl.submit.ISubmit":!0}),$I.releaseRender=function(){var $I=$d._cache;($I[$I._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$I.getRenderType=function(){return this._renderType},$I.renderSubmit=function(){if(0===this._numEle)return 1;var $I=this.shaderValue.textureHost;if($I){var $M=$I.source;if(!$I.bitmap||!$M)return 1;this.shaderValue.texture=$M,$I.alphaTexture&&$I.alphaTexture.source&&(this.shaderValue.texture1=$I.alphaTexture.source)}this._vb.bind_upload(this._ib);var $E=$wI.mainContext;return this.shaderValue.upload(),$F.activeBlendFunction!==this._blendFn&&($E.enable(3042),this._blendFn($E),$F.activeBlendFunction=this._blendFn),$R.drawCall++,$R.trianglesFaces+=this._numEle/3,$E.drawElements(4,this._numEle,5123,this._startIdx),1},$d.__init__=function(){var $I=$d.RENDERBASE=new $d(-1);$I.shaderValue=new $mI(0,0),$I.shaderValue.ALPHA=-1234},$d.createSubmit=function($I,$M,$E,$Z,$i){var $n=$d._cache._length?$d._cache[--$d._cache._length]:new $d;null==$E&&(($E=$n._selfVb||($n._selfVb=$UI.create(-1))).clear(),$Z=0),$n._ib=$M,$n._vb=$E,$n._startIdx=$Z*$VI.BYTES_PIDX,$n._numEle=0;var $c=$I._nBlendType;$n._blendFn=$I._targets?$F.targetFns[$c]:$F.fns[$c],$n.shaderValue=$i,$n.shaderValue.setValue($I._shader2D);var $f=$I._shader2D.filters;return $f&&$n.shaderValue.setFilters($f),$n},$d.createShape=function($I,$M,$E,$Z,$i,$n){var $c=$d._cache._length?$d._cache[--$d._cache._length]:new $d;$c._ib=$M,$c._vb=$E,$c._numEle=$Z,$c._startIdx=$i,$c.shaderValue=$n,$c.shaderValue.setValue($I._shader2D);var $f=$I._nBlendType;return $c._blendFn=$I._targets?$F.targetFns[$f]:$F.fns[$f],$c},$d.TYPE_2D=1e4,$d.TYPE_CANVAS=10003,$d.TYPE_CMDSETRT=10004,$d.TYPE_CUSTOM=10005,$d.TYPE_BLURRT=10006,$d.TYPE_CMDDESTORYPRERT=10007,$d.TYPE_DISABLESTENCIL=10008,$d.TYPE_OTHERIBVB=10009,$d.TYPE_PRIMITIVE=10010,$d.TYPE_RT=10011,$d.TYPE_BLUR_RT=10012,$d.TYPE_TARGET=10013,$d.TYPE_CHANGE_VALUE=10014,$d.TYPE_SHAPE=10015,$d.TYPE_TEXTURE=10016,$d.TYPE_FILLTEXTURE=10017,$d.RENDERBASE=null,$d._cache=(($d._cache=[])._length=0,$d._cache),$d}()),$cI=function(){function $Z(){this.fun=null,this.args=null}$Q($Z,"laya.webgl.submit.SubmitCMD");var $I=$Z.prototype;return $O.imps($I,{"laya.webgl.submit.ISubmit":!0}),$I.renderSubmit=function(){return this.fun.apply(null,this.args),1},$I.getRenderType=function(){return 0},$I.releaseRender=function(){var $I=$Z._cache;$I[$I._length++]=this},$Z.create=function($I,$M){var $E=$Z._cache._length?$Z._cache[--$Z._cache._length]:new $Z;return $E.fun=$M,$E.args=$I,$E},$Z._cache=(($Z._cache=[])._length=0,$Z._cache),$Z}(),$fI=function(){function $M(){this.variables={}}$Q($M,"laya.webgl.submit.SubmitCMDScope");var $I=$M.prototype;return $I.getValue=function($I){return this.variables[$I]},$I.addValue=function($I,$M){return this.variables[$I]=$M},$I.setValue=function($I,$M){return this.variables.hasOwnProperty($I)?this.variables[$I]=$M:null},$I.clear=function(){for(var $I in this.variables)delete this.variables[$I]},$I.recycle=function(){this.clear(),$M.POOL.push(this)},$M.create=function(){var $I=$M.POOL.pop();return $I||($I=new $M),$I},$M.POOL=[],$M}(),$dI=function(){function $A(){this.offset=0,this.startIndex=0,this._mat=$j.create()}$Q($A,"laya.webgl.submit.SubmitOtherIBVB");var $I=$A.prototype;return $O.imps($I,{"laya.webgl.submit.ISubmit":!0}),$I.releaseRender=function(){var $I=$A._cache;($I[$I._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$I.getRenderType=function(){return 10009},$I.renderSubmit=function(){var $I=this._shaderValue.textureHost;if($I){var $M=$I.source;if(!$I.bitmap||!$M)return 1;this._shaderValue.texture=$M}this._vb.bind_upload(this._ib);var $E=$yI.worldMatrix4,$Z=$j.TEMP;$j.mulPre(this._mat,$E[0],$E[1],$E[4],$E[5],$E[12],$E[13],$Z);var $i=$yI.worldMatrix4=$A.tempMatrix4;$i[0]=$Z.a,$i[1]=$Z.b,$i[4]=$Z.c,$i[5]=$Z.d,$i[12]=$Z.tx,$i[13]=$Z.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var $n=$wI.mainContext;return $F.activeBlendFunction!==this._blendFn&&($n.enable(3042),this._blendFn($n),$F.activeBlendFunction=this._blendFn),$R.drawCall++,$R.trianglesFaces+=this._numEle/3,$n.drawElements(4,this._numEle,5123,this.startIndex),$yI.worldMatrix4=$E,$XI.activeShader=null,1},$A.create=function($I,$M,$E,$Z,$i,$n,$c,$f,$d){void 0===$d&&($d=0);var $H=$A._cache._length?$A._cache[--$A._cache._length]:new $A;$H._ib=$E,$H._vb=$M,$H._numEle=$Z,$H._shader=$i,$H._shaderValue=$n;var $B=$I._nBlendType;switch($H._blendFn=$I._targets?$F.targetFns[$B]:$F.fns[$B],$d){case 0:$H.offset=0,$H.startIndex=$f/($VI.BYTES_PE*$M.vertexStride)*1.5,$H.startIndex*=$VI.BYTES_PIDX;break;case 1:$H.startIndex=$c,$H.offset=$f}return $H},$A._cache=(($A._cache=[])._length=0,$A._cache),$A.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$A}(),$HI=function(){function $E(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new $q,this.screenRect=new $q}$Q($E,"laya.webgl.submit.SubmitScissor");var $I=$E.prototype;return $O.imps($I,{"laya.webgl.submit.ISubmit":!0}),$I._scissor=function($I,$M,$E,$Z){var $i=$yI.worldMatrix4,$n=$i[0],$c=$i[5],$f=$i[12],$d=$i[13];if($Z*=$c,($E*=$n)<1||$Z<1)return!1;var $H=($I=$I*$n+$f)+$E,$B=($M=$M*$c+$d)+$Z;$I<0&&($E=$H-($I=0)),$M<0&&($Z=$B-($M=0));var $A=$yI.worldClipRect;if($I=Math.max($I,$A.x),$M=Math.max($M,$A.y),$E=Math.min($H,$A.right)-$I,$Z=Math.min($B,$A.bottom)-$M,$E<1||$Z<1)return!1;var $Q=$yI.worldScissorTest;return this.screenRect.copyFrom($A),$A.x=$I,$A.y=$M,$A.width=$E,$A.height=$Z,$yI.worldScissorTest=!0,$M=$yI.height-$M-$Z,$wI.mainContext.scissor($I,$M,$E,$Z),$wI.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$Q?($M=$yI.height-this.screenRect.y-this.screenRect.height,$wI.mainContext.scissor(this.screenRect.x,$M,this.screenRect.width,this.screenRect.height),$wI.mainContext.enable(3089)):($wI.mainContext.disable(3089),$yI.worldScissorTest=!1),$A.copyFrom(this.screenRect),!0},$I._scissorWithTagart=function($I,$M,$E,$Z){if($E<1||$Z<1)return!1;var $i=$I+$E,$n=$M+$Z;$I<0&&($E=$i-($I=0)),$M<0&&($Z=$n-($M=0));var $c=$yI.worldClipRect;if($I=Math.max($I,$c.x),$M=Math.max($M,$c.y),$E=Math.min($i,$c.right)-$I,$Z=Math.min($n,$c.bottom)-$M,$E<1||$Z<1)return!1;var $f=$yI.worldScissorTest;return this.screenRect.copyFrom($c),$yI.worldScissorTest=!0,$c.x=$I,$c.y=$M,$c.width=$E,$c.height=$Z,$M=$yI.height-$M-$Z,$wI.mainContext.scissor($I,$M,$E,$Z),$wI.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),$f?($M=$yI.height-this.screenRect.y-this.screenRect.height,$wI.mainContext.scissor(this.screenRect.x,$M,this.screenRect.width,this.screenRect.height),$wI.mainContext.enable(3089)):($wI.mainContext.disable(3089),$yI.worldScissorTest=!1),$c.copyFrom(this.screenRect),!0},$I.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},$I.getRenderType=function(){return 0},$I.releaseRender=function(){var $I=$E._cache;($I[$I._length++]=this).context=null},$E.create=function($I){var $M=$E._cache._length?$E._cache[--$E._cache._length]:new $E;return $M.context=$I,$M},$E._cache=(($E._cache=[])._length=0,$E._cache),$E}(),$BI=function(){function $d(){this.step=0,this.blendMode=null,this.level=0}$Q($d,"laya.webgl.submit.SubmitStencil");var $I=$d.prototype;return $O.imps($I,{"laya.webgl.submit.ISubmit":!0}),$I.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},$I.getRenderType=function(){return 0},$I.releaseRender=function(){var $I=$d._cache;$I[$I._length++]=this},$I.do1=function(){var $I=$wI.mainContext;$I.enable(2960),$I.clear(1024),$I.colorMask(!1,!1,!1,!1),$I.stencilFunc(514,this.level,255),$I.stencilOp(7680,7680,7682)},$I.do2=function(){var $I=$wI.mainContext;$I.stencilFunc(514,this.level+1,255),$I.colorMask(!0,!0,!0,!0),$I.stencilOp(7680,7680,7680)},$I.do3=function(){var $I=$wI.mainContext;$I.colorMask(!0,!0,!0,!0),$I.stencilOp(7680,7680,7680),$I.clear(1024),$I.disable(2960)},$I.do4=function(){var $I=$wI.mainContext;0==this.level&&($I.enable(2960),$I.clear(1024)),$I.colorMask(!1,!1,!1,!1),$I.stencilFunc(519,0,255),$I.stencilOp(7680,7680,7682)},$I.do5=function(){var $I=$wI.mainContext;$I.stencilFunc(514,this.level,255),$I.colorMask(!0,!0,!0,!0),$I.stencilOp(7680,7680,7680)},$I.do6=function(){var $I=$wI.mainContext;$F.targetFns[$F.TOINT[this.blendMode]]($I)},$I.do7=function(){var $I=$wI.mainContext;$I.colorMask(!1,!1,!1,!1),$I.stencilOp(7680,7680,7683)},$I.do8=function(){var $I=$wI.mainContext;$I.colorMask(!0,!0,!0,!0),$I.stencilFunc(514,this.level,255),$I.stencilOp(7680,7680,7680)},$d.restore=function($I,$M,$E,$Z,$i){var $n;if(($I._renderKey=0)<$d._mask&&$d._mask--,0==$d._mask)$n=laya.webgl.submit.SubmitStencil.create(3),$I.addRenderObject($n),$I._curSubmit=$nI.RENDERBASE;else{$n=laya.webgl.submit.SubmitStencil.create(7),$I.addRenderObject($n);var $c=$I._vb;$c._byteLength;if($uI.fillRectImgVb($c,null,$M.x,$M.y,$M.width,$M.height,$S.DEF_UV,$E,$Z,$i,0,0)){$I._shader2D.glTexture=null;var $f=$I._curSubmit=$nI.createSubmit($I,$I._ib,$c,($c._byteLength-64)/32*3,$mI.create(2,0));$f.shaderValue.ALPHA=1,$I._submits[$I._submits._length++]=$f,$I._curSubmit._numEle+=6,$I._curSubmit=$nI.RENDERBASE}else alert("clipRect calc stencil rect error");$n=laya.webgl.submit.SubmitStencil.create(8),$I.addRenderObject($n)}},$d.restore2=function($I,$M){var $E;($I._renderKey=0)<$d._mask&&$d._mask--,0==$d._mask?($E=laya.webgl.submit.SubmitStencil.create(3),$I.addRenderObject($E),$I._curSubmit=$nI.RENDERBASE):($E=laya.webgl.submit.SubmitStencil.create(7),$I.addRenderObject($E),$I._submits[$I._submits._length++]=$M,$E=laya.webgl.submit.SubmitStencil.create(8),$I.addRenderObject($E))},$d.create=function($I){var $M=$d._cache._length?$d._cache[--$d._cache._length]:new $d;return 5==($M.step=$I)&&++$d._mask,$M.level=$d._mask,$M},$d._cache=(($d._cache=[])._length=0,$d._cache),$d._mask=0,$d}(),$AI=function(){function $f(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}$Q($f,"laya.webgl.submit.SubmitTarget");var $I=$f.prototype;return $O.imps($I,{"laya.webgl.submit.ISubmit":!0}),$I.renderSubmit=function(){this._vb.bind_upload(this._ib);var $I=this.scope.getValue(this.proName);return $I&&(this.shaderValue.texture=$I.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[$I.width,$I.height]),this.shaderValue.upload(),this.blend(),$R.drawCall++,$R.trianglesFaces+=this._numEle/3,$wI.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},$I.blend=function(){if($F.activeBlendFunction!==$F.fns[this.blendType]){var $I=$wI.mainContext;$I.enable(3042),$F.fns[this.blendType]($I),$F.activeBlendFunction=$F.fns[this.blendType]}},$I.getRenderType=function(){return 0},$I.releaseRender=function(){var $I=$f._cache;($I[$I._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},$f.create=function($I,$M,$E,$Z,$i,$n){var $c=$f._cache._length?$f._cache[--$f._cache._length]:new $f;return $c._ib=$M,$c._vb=$E,$c.proName=$n,$c._startIdx=$Z*$VI.BYTES_PIDX,$c._numEle=0,$c.blendType=$I._nBlendType,$c.shaderValue=$i,$c.shaderValue.setValue($I._shader2D),$c},$f._cache=(($f._cache=[])._length=0,$f._cache),$f}(),$QI=function(){function $I(){this._sourceStr=null}$Q($I,"laya.webgl.text.CharSegment");var $M=$I.prototype;return $O.imps($M,{"laya.webgl.text.ICharSegment":!0}),$M.textToSpit=function($I){this._sourceStr=$I},$M.getChar=function($I){return this._sourceStr.charAt($I)},$M.getCharCode=function($I){return this._sourceStr.charCodeAt($I)},$M.length=function(){return this._sourceStr.length},$I}(),$pI=function(){var $I;function $R(){}return $Q($R,"laya.webgl.text.DrawText"),$R.__init__=function(){$R._charsTemp=new Array,$R._drawValue=new $I,$R._charSeg=new $QI},$R.customCharSeg=function($I){$R._charSeg=$I},$R.getChar=function($I,$M,$E){var $Z=$hI.createOneChar($I,$E);return-1!=$M&&($R._charsCache[$M]=$Z),$Z},$R._drawSlow=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B,$A,$Q,$p,$t){var $V,$u,$N=$R._drawValue.value($n,$f,$d,$H,$Q,$p,$t),$y=0,$$=0,$w=$R._charsTemp,$g=0,$O=NaN;if($Z)for($w.length=$Z.length,$y=0,$$=$Z.length;$y<$$;$y++)($u=$Z[$y])&&($O=$u.charNum+$N.txtID,$w[$y]=$V=$R._charsCache[$O]||$R.getChar($u.char,$O,$N),$V.active());else{var $a=$E instanceof laya.utils.WordText?$E.toString():$E;if($o.CharacterCache){$R._charSeg.textToSpit($a);var $m=$R._charSeg.length();for($y=0,$$=$w.length=$m;$y<$$;$y++)$O=$R._charSeg.getCharCode($y)+$N.txtID,$w[$y]=$V=$R._charsCache[$O]||$R.getChar($R._charSeg.getChar($y),$O,$N),$V.active(),$g+=$V.cw}else $w.length=0,($V=$R.getChar($a,-1,$N)).active(),$g+=$V.cw,$w[0]=$V}var $j=0;null!==$c&&"left"!==$c&&($j=-("center"==$c?$g/2:$g));var $T,$q,$v=NaN,$W=0;if($Z)for($y=0,$$=$w.length;$y<$$;$y++)$V=$w[$y],$u=$Z[$y],$V&&$u&&!$V.isSpace&&($v=$V.borderSize,$T=$V.texture,$M._drawText($T,$B+$j+$u.x*$Q-$v,$A+$u.y*$p-$v,$T.width,$T.height,$i,0,0,0,0));else{for($y=0,$$=$w.length;$y<$$;$y++)($V=$w[$y])&&!$V.isSpace&&($v=$V.borderSize,$T=$V.texture,$M._drawText($T,$B+$j-$v,$A-$v,$T.width,$T.height,$i,0,0,0,0),$I&&(($q=$I[$W++])||($q=$I[$W-1]=[]),$q[0]=$T,$q[1]=$j-$v,$q[2]=-$v)),$j+=$V.cw;$I&&($I.length=$W)}},$R._drawFast=function($I,$M,$E,$Z,$i){for(var $n,$c,$f=0,$d=$I.length;$f<$d;$f++)($n=($c=$I[$f])[0]).active(),$M._drawText($n,$Z+$c[1],$i+$c[2],$n.width,$n.height,$E,0,0,0,0)},$R.drawText=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B,$A){if(void 0===$A&&($A=0),!($M&&0===$M.length||$E&&0===$E.length)){var $Q=$Z.a,$p=$Z.d;(0!==$Z.b||0!==$Z.c)&&($Q=$p=1);var $t=1!==$Q||1!==$p;if($t&&$O.stage.transform){var $V=$O.stage.transform;$t=$V.a===$Q&&$V.d===$p}else $t=!1;if($t){var $u=($Z=$Z.copyTo($aI._tmpMatrix)).tx,$N=$Z.ty;$Z.scale(1/$Q,1/$p),$Z._checkTransform(),$H*=$Q,$B*=$p,$H+=$u-$Z.tx,$B+=$N-$Z.ty}else $Q=$p=1;if($E)$R._drawSlow(null,$I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B,$Q,$p,$A);else{if(null===$M.toUpperCase){var $y=$Q+1e5*$p,$$=$M;return void($$.changed||$$.id!==$y?($$.id=$y,$$.changed=!1,$R._drawSlow($$.save,$I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B,$Q,$p,$A)):$R._drawFast($$.save,$I,$Z,$H,$B))}var $w=$M+$i.toString()+$c+$f+$d+$Q+$p+$n,$g=$R._textsCache[$w];$o.CharacterCache?$g?$R._drawFast($g,$I,$Z,$H,$B):($R._textsCache.__length||($R._textsCache.__length=0),$R._textsCache.__length>$a.WebGLTextCacheCount&&(($R._textsCache={}).__length=0,$R._curPoolIndex=0),$R._textCachesPool[$R._curPoolIndex]?($g=$R._textsCache[$w]=$R._textCachesPool[$R._curPoolIndex]).length=0:$R._textCachesPool[$R._curPoolIndex]=$g=$R._textsCache[$w]=[],$R._textsCache.__length++,$R._curPoolIndex++,$R._drawSlow($g,$I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B,$Q,$p,$A)):$R._drawSlow($g,$I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B,$Q,$p,$A)}}},$R._charsTemp=null,$R._textCachesPool=[],$R._curPoolIndex=0,$R._charsCache={},$R._textsCache={},$R._drawValue=null,$R.d=[],$R._charSeg=null,$R.__init$=function(){$I=function(){function $d(){}return $Q($d,""),$d.prototype.value=function($I,$M,$E,$Z,$i,$n,$c){this.font=$I,this.fillColor=$M,this.borderColor=$E,this.lineWidth=$Z,this.scaleX=$i,this.scaleY=$n,this.underLine=$c;var $f=$I.toString()+$i+$n+$Z+($M?$M.toLowerCase():" ")+($E?$E.toLowerCase():" ")+$c;return this.txtID=$d._keymap[$f],this.txtID||(this.txtID=1e-7*++$d._keymapCount,$d._keymap[$f]=this.txtID),this},$d.clear=function(){$d._keymap={},$d._keymapCount=1},$d._keymap={},$d._keymapCount=1,$d}()},$R}(),$tI=function(){function $i($I){this._index=0,this._size=14,this._italic=-2,$i._cache2=$i._cache2||[],this.setFont($I||"14px Arial")}$Q($i,"laya.webgl.text.FontInContext");var $I=$i.prototype;return $I.setFont=function($I){var $M=$i._cache2[$I];if($M)this._words=$M[0],this._size=$M[1];else{this._words=$I.split(" ");for(var $E=0,$Z=this._words.length;$E<$Z;$E++)if(0<this._words[$E].indexOf("px")){this._index=$E;break}this._size=parseInt(this._words[this._index]),$i._cache2[$I]=[this._words,this._size]}this._text=null,this._italic=-2},$I.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},$I.hasType=function($I){for(var $M=0,$E=this._words.length;$M<$E;$M++)if(this._words[$M]===$I)return $M;return-1},$I.removeType=function($I){for(var $M=0,$E=this._words.length;$M<$E;$M++)if(this._words[$M]===$I){this._words.splice($M,1),this._index>$M&&this._index--;break}this._text=null,this._italic=-2},$I.copyTo=function($I){return $I._text=this._text,$I._size=this._size,$I._index=this._index,$I._words=this._words.slice(),$I._italic=-2,$I},$I.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},$Z(0,$I,"size",function(){return this._size},function($I){this._size=$I,this._words[this._index]=$I+"px",this._text=null}),$i.create=function($I){var $M=$i._cache[$I];return $M||($M=$i._cache[$I]=new $i($I))},$i.EMPTY=new $i,$i._cache={},$i._cache2=null,$i}(),$VI=function(){function $I(){}return $Q($I,"laya.webgl.utils.CONST3D2D"),$I.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$I.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],$I.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],$I._TMPARRAY=[],$I._OFFSETX=0,$I._OFFSETY=0,$c($I,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),$I}(),$uI=function(){function $t(){}return $Q($t,"laya.webgl.utils.GlUtils"),$t.make2DProjection=function($I,$M,$E){return[2/$I,0,0,0,0,-2/$M,0,0,0,0,2/$E,0,-1,1,0,1]},$t.fillIBQuadrangle=function($I,$M){if(65535/4<$M)throw Error("IBQuadrangle count:"+$M+" must<:"+Math.floor(65535/4));$M=Math.floor($M),$I._resizeBuffer(6*($M+1)*2,!1),$I.byteLength=$I.bufferLength;for(var $E=$I.getUint16Array(),$Z=0,$i=0;$i<$M;$i++)$E[$Z++]=4*$i,$E[$Z++]=4*$i+2,$E[$Z++]=4*$i+1,$E[$Z++]=4*$i,$E[$Z++]=4*$i+3,$E[$Z++]=4*$i+2;return $I.setNeedUpload(),!0},$t.expandIBQuadrangle=function($I,$M){$I.bufferLength>=6*$M*2||$t.fillIBQuadrangle($I,$M)},$t.mathCeilPowerOfTwo=function($I){return $I--,$I|=$I>>1,$I|=$I>>2,$I|=$I>>4,$I|=$I>>8,$I|=$I>>16,++$I},$t.fillQuadrangleImgVb=function($I,$M,$E,$Z,$i,$n,$c,$f){var $d=16+($I._byteLength>>2);$I.byteLength=$d<<2;var $H=$I.getFloat32Array();$H[($d-=16)+2]=$i[0],$H[$d+3]=$i[1],$H[$d+6]=$i[2],$H[$d+7]=$i[3],$H[$d+10]=$i[4],$H[$d+11]=$i[5],$H[$d+14]=$i[6],$H[$d+15]=$i[7];var $B=$n.a,$A=$n.b,$Q=$n.c,$p=$n.d;if(1!==$B||0!==$A||0!==$Q||1!==$p){$n.bTransform=!0;var $t=$n.tx+$c,$V=$n.ty+$f;$H[$d]=($Z[0]+$M)*$B+($Z[1]+$E)*$Q+$t,$H[$d+1]=($Z[0]+$M)*$A+($Z[1]+$E)*$p+$V,$H[$d+4]=($Z[2]+$M)*$B+($Z[3]+$E)*$Q+$t,$H[$d+5]=($Z[2]+$M)*$A+($Z[3]+$E)*$p+$V,$H[$d+8]=($Z[4]+$M)*$B+($Z[5]+$E)*$Q+$t,$H[$d+9]=($Z[4]+$M)*$A+($Z[5]+$E)*$p+$V,$H[$d+12]=($Z[6]+$M)*$B+($Z[7]+$E)*$Q+$t,$H[$d+13]=($Z[6]+$M)*$A+($Z[7]+$E)*$p+$V}else $n.bTransform=!1,$M+=$n.tx+$c,$E+=$n.ty+$f,$H[$d]=$M+$Z[0],$H[$d+1]=$E+$Z[1],$H[$d+4]=$M+$Z[2],$H[$d+5]=$E+$Z[3],$H[$d+8]=$M+$Z[4],$H[$d+9]=$E+$Z[5],$H[$d+12]=$M+$Z[6],$H[$d+13]=$E+$Z[7];return $I._upload=!0},$t.fillTranglesVB=function($I,$M,$E,$Z,$i,$n,$c){var $f=($I._byteLength>>2)+$Z.length;$I.byteLength=$f<<2;var $d=$I.getFloat32Array();$f-=$Z.length;for(var $H=$Z.length,$B=$i.a,$A=$i.b,$Q=$i.c,$p=$i.d,$t=0;$t<$H;$t+=4)if($d[$f+$t+2]=$Z[$t+2],$d[$f+$t+3]=$Z[$t+3],1!==$B||0!==$A||0!==$Q||1!==$p){$i.bTransform=!0;var $V=$i.tx+$n,$u=$i.ty+$c;$d[$f+$t]=($Z[$t]+$M)*$B+($Z[$t+1]+$E)*$Q+$V,$d[$f+$t+1]=($Z[$t]+$M)*$A+($Z[$t+1]+$E)*$p+$u}else $i.bTransform=!1,$M+=$i.tx+$n,$E+=$i.ty+$c,$d[$f+$t]=$M+$Z[$t],$d[$f+$t+1]=$E+$Z[$t+1];return $I._upload=!0},$t.copyPreImgVb=function($I,$M,$E){var $Z=$I._byteLength>>2;$I.byteLength=$Z+16<<2;for(var $i=$I.getFloat32Array(),$n=0,$c=$Z-16;$n<4;$n++)$i[$Z]=$i[$c]+$M,++$c,$i[++$Z]=$i[$c]+$E,++$c,$i[++$Z]=$i[$c],++$c,$i[++$Z]=$i[$c],++$Z,++$c;$I._upload=!0},$t.fillRectImgVb=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B,$A,$Q){void 0===$Q&&($Q=!1);var $p,$t,$V,$u,$N,$y,$$,$w,$g,$O,$a,$m,$j,$T,$q,$v,$W=1,$R=$f.a,$z=$f.b,$L=$f.c,$o=$f.d,$S=$M&&$M.width<99999999;if(1!==$R||0!==$z||0!==$L||1!==$o?($f.bTransform=!0,0===$z&&0===$L&&($W=23,$g=$i+$E,$O=$n+$Z,$p=$R*$E+($a=$f.tx+$d),$V=$R*$g+$a,$t=$o*$Z+($m=$f.ty+$H),$u=$o*$O+$m)):($W=23,$f.bTransform=!1,$V=($p=$E+$f.tx+$d)+$i,$u=($t=$Z+$f.ty+$H)+$n),$S&&($N=$M.x,$y=$M.y,$$=$M.width+$N,$w=$M.height+$y),1!==$W){if(Math.min($p,$V)>=$$)return!1;if(Math.min($t,$u)>=$w)return!1;if(Math.max($V,$p)<=$N)return!1;if(Math.max($u,$t)<=$y)return!1}var $X=$I._byteLength>>2;$I.byteLength=16+$X<<2;var $C=$I.getFloat32Array();switch($C[2+$X]=$c[0],$C[3+$X]=$c[1],$C[6+$X]=$c[2],$C[7+$X]=$c[3],$C[10+$X]=$c[4],$C[11+$X]=$c[5],$C[14+$X]=$c[6],$C[15+$X]=$c[7],$W){case 1:$a=$f.tx+$d,$m=$f.ty+$H;var $J=$R*$E,$x=$L*$Z,$k=$o*$Z,$r=$z*$E,$l=$R*($g=$i+$E),$F=$L*($O=$n+$Z),$e=$o*$O,$_=$z*$g;$Q?($j=$J+$x+$a,$q=Math.round($j)-$j,$T=$k+$r+$m,$v=Math.round($T)-$T,$C[$X]=$j+$q,$C[1+$X]=$T+$v,$C[4+$X]=$l+$x+$a+$q,$C[5+$X]=$k+$_+$m+$v,$C[8+$X]=$l+$F+$a+$q,$C[9+$X]=$e+$_+$m+$v,$C[12+$X]=$J+$F+$a+$q,$C[13+$X]=$e+$r+$m+$v):($C[$X]=$J+$x+$a,$C[1+$X]=$k+$r+$m,$C[4+$X]=$l+$x+$a,$C[5+$X]=$k+$_+$m,$C[8+$X]=$l+$F+$a,$C[9+$X]=$e+$_+$m,$C[12+$X]=$J+$F+$a,$C[13+$X]=$e+$r+$m);break;case 23:$Q?($j=$p+$B,$q=Math.round($j)-$j,$T=$t,$v=Math.round($T)-$T,$C[$X]=$j+$q,$C[1+$X]=$T+$v,$C[4+$X]=$V+$B+$q,$C[5+$X]=$t+$v,$C[8+$X]=$V+$q,$C[9+$X]=$u+$v,$C[12+$X]=$p+$q,$C[13+$X]=$u+$v):($C[$X]=$p+$B,$C[1+$X]=$t,$C[4+$X]=$V+$B,$C[5+$X]=$t,$C[8+$X]=$V,$C[9+$X]=$u,$C[12+$X]=$p,$C[13+$X]=$u)}return $I._upload=!0},$t.fillLineVb=function($I,$M,$E,$Z,$i,$n,$c,$f){var $d=.5*$c,$H=$t._fillLineArray,$B=-($Z-$n),$A=$E-$i,$Q=Math.sqrt($B*$B+$A*$A);$B/=$Q,$A/=$Q,$B*=$d,$A*=$d,$H[0]=$E-$B,$H[1]=$Z-$A,$H[4]=$E+$B,$H[5]=$Z+$A,$H[8]=$i+$B,$H[9]=$n+$A,$H[12]=$i-$B,$H[13]=$n-$A,$f&&$f.transformPointArray($H,$H);var $p=16+($I._byteLength>>2);return $I.byteLength=$p<<2,$I.insertData($H,$p-16),!0},$t._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],$t}(),$NI=(function(){function $d(){}$Q($d,"laya.webgl.utils.MatirxArray"),$d.ArrayMul=function($I,$M,$E){if($I)if($M)for(var $Z=NaN,$i=NaN,$n=NaN,$c=NaN,$f=0;$f<4;$f++)$Z=$I[$f],$i=$I[$f+4],$n=$I[$f+8],$c=$I[$f+12],$E[$f]=$Z*$M[0]+$i*$M[1]+$n*$M[2]+$c*$M[3],$E[$f+4]=$Z*$M[4]+$i*$M[5]+$n*$M[6]+$c*$M[7],$E[$f+8]=$Z*$M[8]+$i*$M[9]+$n*$M[10]+$c*$M[11],$E[$f+12]=$Z*$M[12]+$i*$M[13]+$n*$M[14]+$c*$M[15];else $d.copyArray($I,$E);else $d.copyArray($M,$E)},$d.copyArray=function($I,$M){if($I&&$M)for(var $E=0;$E<$I.length;$E++)$M[$E]=$I[$E]}}(),function(){function $M($I,$M,$E){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=$I,this._vb=new $UI($I,35048),$M&&this._vb._resizeBuffer($M,!1),this._ib=new $bI,$E&&this._ib._resizeBuffer($E,!1)}$Q($M,"laya.webgl.utils.Mesh2D");var $I=$M.prototype;return $I.cloneWithNewVB=function(){var $I=new $M(this._stride,0,0);return $I._ib=this._ib,$I._quadNum=this._quadNum,$I._attribInfo=this._attribInfo,$I},$I.cloneWithNewVBIB=function(){var $I=new $M(this._stride,0,0);return $I._attribInfo=this._attribInfo,$I},$I.getVBW=function(){return this._vb.setNeedUpload(),this._vb},$I.getVBR=function(){return this._vb},$I.getIBR=function(){return this._ib},$I.getIBW=function(){return this._ib.setNeedUpload(),this._ib},$I.createQuadIB=function($I){this._quadNum=$I,this._ib._resizeBuffer(6*$I*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var $M=this._ib.getUint16Array(),$E=0,$Z=0,$i=0;$i<$I;$i++)$M[$E++]=$Z,$M[$E++]=$Z+2,$M[$E++]=$Z+1,$M[$E++]=$Z,$M[$E++]=$Z+3,$M[$E++]=$Z+2,$Z+=4;this._ib.setNeedUpload()},$I.setAttributes=function($I){if(this._attribInfo=$I,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},$I.getEleNum=function(){return this._ib.getBuffer().byteLength/2},$I.releaseMesh=function(){},$I.destroy=function(){},$I.clearVB=function(){this._vb.clear()},$M._gvaoid=0,$M}()),$yI=function(){function $i(){}return $Q($i,"laya.webgl.utils.RenderState2D"),$i.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},$i.mat2MatArray=function($I,$M){var $E=$I,$Z=$M;return $Z[0]=$E.a,$Z[1]=$E.b,$Z[2]=$i.EMPTYMAT4_ARRAY[2],$Z[3]=$i.EMPTYMAT4_ARRAY[3],$Z[4]=$E.c,$Z[5]=$E.d,$Z[6]=$i.EMPTYMAT4_ARRAY[6],$Z[7]=$i.EMPTYMAT4_ARRAY[7],$Z[8]=$i.EMPTYMAT4_ARRAY[8],$Z[9]=$i.EMPTYMAT4_ARRAY[9],$Z[10]=$i.EMPTYMAT4_ARRAY[10],$Z[11]=$i.EMPTYMAT4_ARRAY[11],$Z[12]=$E.tx,$Z[13]=$E.ty,$Z[14]=$i.EMPTYMAT4_ARRAY[14],$Z[15]=$i.EMPTYMAT4_ARRAY[15],$M},$i.restoreTempArray=function(){$i.TEMPMAT4_ARRAY[0]=1,$i.TEMPMAT4_ARRAY[1]=0,$i.TEMPMAT4_ARRAY[4]=0,$i.TEMPMAT4_ARRAY[5]=1,$i.TEMPMAT4_ARRAY[12]=0,$i.TEMPMAT4_ARRAY[13]=0},$i.clear=function(){$i.worldScissorTest=!1,$i.worldShaderDefines=null,$i.worldFilters=null,$i.worldAlpha=1,$i.worldClipRect.x=$i.worldClipRect.y=0,$i.worldClipRect.width=$i.width,$i.worldClipRect.height=$i.height,$i.curRenderTarget=null},$i._MAXSIZE=99999999,$i.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$i.worldMatrix4=$i.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$i.worldAlpha=1,$i.worldScissorTest=!1,$i.worldFilters=null,$i.worldShaderDefines=null,$i.curRenderTarget=null,$i.width=0,$i.height=0,$c($i,["worldMatrix",function(){return this.worldMatrix=new $j},"worldClipRect",function(){return this.worldClipRect=new $q(0,0,99999999,99999999)}]),$i}(),$$I=function(){var $y,$E;function $$($I,$M,$E,$Z,$i){var $n=this;function $c($I){var $M=[],$E=new $y($M);return $n._compileToTree($E,$I.split("\n"),0,$M,$i),$E}var $f=$p.now();this._VS=$c($M),this._PS=$c($E),this._nameMap=$Z,2<$p.now()-$f&&console.log("ShaderCompile use time:"+($p.now()-$f)+"  size:"+$M.length+"/"+$E.length)}$Q($$,"laya.webgl.utils.ShaderCompile");var $I=$$.prototype;return $I._compileToTree=function($I,$M,$E,$Z,$i){var $n,$c,$f,$d,$H,$B,$A,$Q=0,$p=0,$t=0,$V=0;for($p=$E;$p<$M.length;$p++)if(!(($f=$M[$p]).length<1)&&0!==($Q=$f.indexOf("//"))){if(0<=$Q&&($f=$f.substr(0,$Q)),$n=$A||new $y($Z),$A=null,$n.text=$f,$n.noCompile=!0,0<=($Q=$f.indexOf("#"))){for($d="#",$V=$Q+1,$t=$f.length;$V<$t;$V++){var $u=$f.charAt($V);if(" "===$u||"\t"===$u||"\r"===$u||"\n"===$u||"?"===$u)break;$d+=$u}switch($n.name=$d){case"#ifdef":case"#ifndef":if($n.src=$f,$n.noCompile=null!=$f.match(/[!&|()=<>]/),$n.noCompile?console.log("function():Boolean{return "+$f.substr($Q+$n.name.length)+"}"):($B=$f.replace(/^\s*/,"").split(/\s+/),$n.setCondition($B[1],"#ifdef"===$d?1:2),$n.text="//"+$n.text),$n.setParent($I),$I=$n,$i)for($B=$f.substr($V).split($$._splitToWordExps3),$V=0;$V<$B.length;$V++)($f=$B[$V]).length&&($i[$f]=!0);continue;case"#if":if($n.src=$f,$n.noCompile=!0,$n.setParent($I),$I=$n,$i)for($B=$f.substr($V).split($$._splitToWordExps3),$V=0;$V<$B.length;$V++)($f=$B[$V]).length&&"defined"!=$f&&($i[$f]=!0);continue;case"#else":$n.src=$f,$c=($I=$I.parent).childs[$I.childs.length-1],$n.noCompile=$c.noCompile,$n.noCompile||($n.condition=$c.condition,$n.conditionType=1==$c.conditionType?2:1,$n.text="//"+$n.text+" "+$c.text+" "+$n.conditionType),$n.setParent($I),$I=$n;continue;case"#endif":$c=($I=$I.parent).childs[$I.childs.length-1],$n.noCompile=$c.noCompile,$n.noCompile||($n.text="//"+$n.text),$n.setParent($I);continue;case"#include":$B=$$.splitToWords($f,null);var $N=$$.includes[$B[1]];if(!$N)throw"ShaderCompile error no this include file:"+$B[1];if(($Q=$B[0].indexOf("?"))<0){$n.setParent($I),$f=$N.getWith("with"==$B[2]?$B[3]:null),this._compileToTree($n,$f.split("\n"),0,$Z,$i),$n.text="";continue}$n.setCondition($B[0].substr($Q+1),1),$n.text=$N.getWith("with"==$B[2]?$B[3]:null);break;case"#import":$H=($B=$$.splitToWords($f,null))[1],$Z.push({node:$n,file:$$.includes[$H],ofs:$n.text.length});continue}}else{if(($c=$I.childs[$I.childs.length-1])&&!$c.name){0<$Z.length&&$$.splitToWords($f,$c),$A=$n,$c.text+="\n"+$f;continue}0<$Z.length&&$$.splitToWords($f,$n)}$n.setParent($I)}},$I.createShader=function($I,$M,$E){var $Z={},$i="";if($I)for(var $n in $I)$i+="#define "+$n+"\n",$Z[$n]=!0;var $c=this._VS.toscript($Z,[]),$f=this._PS.toscript($Z,[]);return($E||$GI.create)($i+$c.join("\n"),$i+$f.join("\n"),$M,this._nameMap)},$$._parseOne=function($I,$M,$E,$Z,$i,$n){var $c={type:$$.shaderParamsMap[$E[$Z+1]],name:$E[$Z+2],size:isNaN(parseInt($E[$Z+3]))?1:parseInt($E[$Z+3])};return $n&&("attribute"==$i?$I.push($c):$M.push($c)),":"==$E[$Z+3]&&($c.type=$E[$Z+4],$Z+=2),$Z+=2},$$.addInclude=function($I,$M){if(!$M||0===$M.length)throw new Error("add shader include file err:"+$I);if($$.includes[$I])throw new Error("add shader include file err, has add:"+$I);$$.includes[$I]=new $E($M)},$$.preGetParams=function($I,$M){var $E=[$I,$M],$Z={},$i=[],$n=[],$c={},$f=[];$Z.attributes=$i,$Z.uniforms=$n,$Z.defines=$c;for(var $d=0,$H=0,$B=0;$B<2;$B++){$E[$B]=$E[$B].replace($$._removeAnnotation,"");var $A,$Q=$E[$B].match($$._reg);for($d=0,$H=$Q.length;$d<$H;$d++){var $p=$Q[$d];if("attribute"==$p||"uniform"==$p)$d=$$._parseOne($i,$n,$Q,$d,$p,!0);else{if("#define"==$p){$f[$p=$Q[++$d]]=1;continue}if("#ifdef"==$p){$c[$A=$Q[++$d]]=$c[$A]||[];for($d++;$d<$H;$d++)if("attribute"==($p=$Q[$d])||"uniform"==$p)$d=$$._parseOne($i,$n,$Q,$d,$p,$f[$A]);else if("#else"==$p)for($d++;$d<$H;$d++)if("attribute"==($p=$Q[$d])||"uniform"==$p)$d=$$._parseOne($i,$n,$Q,$d,$p,!$f[$A]);else if("#endif"==$p)break}}}}return $Z},$$.splitToWords=function($I,$M){for(var $E,$Z,$i=[],$n=-1,$c=0,$f=$I.length;$c<$f;$c++)if($E=$I.charAt($c),0<=" \t=+-*/&%!<>()'\",;".indexOf($E)){if(0<=$n&&1<$c-$n&&($Z=$I.substr($n,$c-$n),$i.push($Z)),'"'==$E||"'"==$E){var $d=$I.indexOf($E,$c+1);if($d<0)throw"Sharder err:"+$I;$i.push($I.substr($c+1,$d-$c-1)),$c=$d,$n=-1;continue}"("==$E&&$M&&0<$i.length&&($Z=$i[$i.length-1]+";","vec4;main;".indexOf($Z)<0&&($M.useFuns+=$Z)),$n=-1}else $n<0&&($n=$c);return $n<$f&&1<$f-$n&&($Z=$I.substr($n,$f-$n),$i.push($Z)),$i},$$.IFDEF_NO=0,$$.IFDEF_YES=1,$$.IFDEF_ELSE=2,$$.IFDEF_PARENT=3,$$._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),$$._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),$$._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),$$.includes={},$c($$,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),$$.__init$=function(){$y=function(){function $E($I){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=$I}$Q($E,"");var $I=$E.prototype;return $I.setParent=function($I){$I.childs.push(this),this.z=$I.z+1,this.parent=$I},$I.setCondition=function($I,$M){$I&&(this.conditionType=$M,$I=$I.replace(/(\s*$)/g,""),this.condition=function(){return this[$I]},this.condition.__condition=$I)},$I.toscript=function($I,$M){return this._toscript($I,$M,++$E.__id)},$I._toscript=function($Z,$i,$n){if(this.childs.length<1&&!this.text)return $i;$i.length;if(this.condition){var $I=!!this.condition.call($Z);if(2===this.conditionType&&($I=!$I),!$I)return $i}if(this.text&&$i.push(this.text),0<this.childs.length&&this.childs.forEach(function($I,$M,$E){$I._toscript($Z,$i,$n)}),0<this.includefiles.length&&0<this.useFuns.length)for(var $M,$E=0,$c=this.includefiles.length;$E<$c;$E++)this.includefiles[$E].curUseID!=$n&&0<($M=this.includefiles[$E].file.getFunsScript(this.useFuns)).length&&(this.includefiles[$E].curUseID=$n,$i[0]=$M+$i[0]);return $i},$E.__id=1,$E}(),$E=function(){function $I($I){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=$I;for(var $M=0,$E=0,$Z=0;!(($M=$I.indexOf("#begin",$M))<0);){for($Z=$M+5;!(($Z=$I.indexOf("#end",$Z))<0)&&"i"===$I.charAt($Z+4);)$Z+=5;if($Z<0)throw"add include err,no #end:"+$I;$E=$I.indexOf("\n",$M);var $i=$$.splitToWords($I.substr($M,$E-$M),null);"code"==$i[1]?this.codes[$i[2]]=$I.substr($E+1,$Z-$E-1):"function"==$i[1]&&($E=$I.indexOf("function",$M),$E+="function".length,this.funs[$i[3]]=$I.substr($E+1,$Z-$E-1),this.funnames+=$i[3]+";"),$M=$Z+1}}$Q($I,"");var $M=$I.prototype;return $M.getWith=function($I){var $M=$I?this.codes[$I]:this.script;if(!$M)throw"get with error:"+$I;return $M},$M.getFunsScript=function($I){var $M="";for(var $E in this.funs)0<=$I.indexOf($E+";")&&($M+=this.funs[$E]);return $M},$I}()},$$}(),$wI=function(){function $c(){}return $Q($c,"laya.webgl.WebGL"),$c._uint8ArraySlice=function(){for(var $I=this.length,$M=new Uint8Array(this.length),$E=0;$E<$I;$E++)$M[$E]=this[$E];return $M},$c._float32ArraySlice=function(){for(var $I=this.length,$M=new Float32Array(this.length),$E=0;$E<$I;$E++)$M[$E]=this[$E];return $M},$c._uint16ArraySlice=function($I){var $M,$E=arguments,$Z=0,$i=0;if(0===$E.length)for($Z=this.length,$M=new Uint16Array($Z),$i=0;$i<$Z;$i++)$M[$i]=this[$i];else if(2===$E.length){var $n=$E[0],$c=$E[1];if($n<$c)for($Z=$c-$n,$M=new Uint16Array($Z),$i=$n;$i<$c;$i++)$M[$i-$n]=this[$i];else $M=new Uint16Array(0)}return $M},$c.expandContext=function(){var $I=$i.prototype,$M=CanvasRenderingContext2D.prototype;$M.fillTrangles=$I.fillTrangles,$YI.__int__(null),$M.setIBVB=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){void 0===$d&&($d=0),void 0===$H&&($H=0),null===$E&&(this._ib=this._ib||$bI.QuadrangleIB,$E=this._ib,$uI.expandIBQuadrangle($E,$Z._byteLength/64+8)),this._setIBVB($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H)},$M.fillTrangles=function($I,$M,$E,$Z,$i){this._curMat=this._curMat||$j.create(),this._vb=this._vb||$UI.create(),this._ib||(this._ib=$bI.create(),$uI.fillIBQuadrangle(this._ib,$c/4));var $n=this._vb,$c=$Z.length>>4;$uI.fillTranglesVB($n,$M,$E,$Z,$i||this._curMat,0,0),$uI.expandIBQuadrangle(this._ib,$n._byteLength/64+8);var $f=new $mI(1,0);$f.textureHost=$I;var $d=new $sI("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");$n._vertType=3,this._setIBVB($M,$E,this._ib,$n,6*$c,$i,$d,$f,0,0)}},$c.enable=function(){if($p.__init__(),$N.isConchApp&&!$N.isConchWebGL)return $g.skinAniSprite=function(){return new $II},$c.expandContext(),!1;if($g.getWebGLContext=function($I){for(var $M,$E=["webgl","experimental-webgl","webkit-3d","moz-webgl"],$Z=0;$Z<$E.length;$Z++){try{$M=$I.getContext($E[$Z],{stencil:$a.isStencil,alpha:$a.isAlpha,antialias:$a.isAntialias,premultipliedAlpha:$a.premultipliedAlpha,preserveDrawingBuffer:$a.preserveDrawingBuffer})}catch($I){}if($M)return $M}return null},null==($c.mainContext=$c.mainContext||$g.getWebGLContext($N._mainCanvas)))return!1;if($N.isWebGL)return!0;$V.create=function($I,$M){return new $IM($I,$M)},$u.create=function($I,$M,$E,$Z,$i,$n,$c){return new $DI($I,$M,$E,$Z,$i,$n,$c)},$N.WebGL=$c,$N.isWebGL=!0,$pI.__init__(),$g.createRenderSprite=function($I,$M){return new $jI($I,$M)},$g.createWebGLContext2D=function($I){return new $aI($I)},$g.changeWebGLSize=function($I,$M){laya.webgl.WebGL.onStageResize($I,$M)},$g.createGraphics=function(){return new $OI};var $I=$g.createFilterAction;return $g.createFilterAction=$I||function($I){return new $TI},$g.clear=function($I){$yI.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var $M=$N.context.ctx,$E=0==$M._submits._length||$a.preserveDrawingBuffer?$t.create($I)._color:$W._wgColor;$E&&$M.clearBG($E[0],$E[1],$E[2],$E[3]),$yI.clear()},$g.addToAtlas=function($I,$M){void 0===$M&&($M=!1);var $E=$I.bitmap;$N.optimizeTextureMemory($I.url,$I)?$O.__typeof($E,"laya.webgl.resource.IMergeAtlasBitmap")&&$E.allowMerageInAtlas&&$E.on("recovered",$I,$I.addTextureToAtlas):$E.enableMerageInAtlas=!1},$g.isAtlas=function($I){return $I instanceof laya.webgl.atlas.AtlasWebGLCanvas},$r._enable(),$g.beginFlush=function(){for(var $I=$r.instance,$M=$I.getAtlaserCount(),$E=0;$E<$M;$E++){var $Z=$I.getAtlaserByIndex($E).texture;$Z._flashCacheImageNeedFlush&&$g.flashFlushImage($Z)}},$g.drawToCanvas=function($I,$M,$E,$Z,$i,$n){($E<=0||$Z<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),$E|=0,$Z|=0,$i|=0,$n|=0;var $c=$CI.create($E,$Z,6408,5121,0,!1);$c.start(),$c.clear(0,0,0,0),$N.context.clear(),$y.renders[$M]._fun($I,$N.context,$i,$yI.height-$Z+$n),$N.context.flush(),$c.end();var $f=$c.getData(0,0,$E,$Z);if($c.recycle(),$f.byteLength==$E*$Z*4){var $d=new $_I;$d._canvas=$p.createElement("canvas"),$d.size($E,$Z);var $H=$d._canvas.getContext("2d");$p.canvas.size($E,$Z);var $B=$p.context,$A=$B.createImageData($E,$Z);return $A.data.set(new Uint8ClampedArray($f.buffer)),$d._imgData=$A,$B.putImageData($A,0,0),$H.save(),$H.translate(0,$Z),$H.scale(1,-1),$H.drawImage($p.canvas.source,0,0),$H.restore(),$d}console.log("drawToCanvas error: w:"+$E+",h:"+$Z+",datalen:"+$f.byteLength)},$g.createFilterAction=function($I){var $M;switch($I){case 32:$M=new $TI}return $M},$g.addTextureToAtlas=function($I){$I._uvID++,$r._atlasRestore++,$I.bitmap.enableMerageInAtlas&&$r.instance.addToAtlas($I)},$g.getTexturePixels=function($I,$M,$E,$Z,$i){$N.context.ctx.clear();var $n=new $v;$n.graphics.drawTexture($I,-$M,-$E);var $c=$CI.create($Z,$i);$c.start(),$c.clear(0,0,0,0),$n.render($N.context,0,0),$N.context.ctx.flush(),$c.end();for(var $f=$c.getData(0,0,$Z,$i),$d=[],$H=0,$B=$i-1;0<=$B;$B--)for(var $A=0;$A<$Z;$A++)$H=4*($B*$Z+$A),$d.push($f[$H]),$d.push($f[$H+1]),$d.push($f[$H+2]),$d.push($f[$H+3]);return $d},$g.skinAniSprite=function(){return new $II},$H.create=function($I,$M){var $E=new $_I;return $E._imgData=$M,$E.flipY=!1,$E},$m._filterStart=function($I,$M,$E,$Z,$i){var $n=$I.getValue("bounds"),$c=$CI.create($n.width,$n.height);if($c.start(),$c.clear(0,0,0,0),$I.addValue("src",$c),$I.addValue("ScissorTest",$yI.worldScissorTest),$yI.worldScissorTest){var $f=new $q;$f.copyFrom($E.ctx._clipRect),$I.addValue("clipRect",$f),$yI.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},$m._filterEnd=function($I,$M,$E,$Z,$i){var $n=$I.getValue("bounds");$I.getValue("src").end();var $c=$CI.create($n.width,$n.height);$c.start(),$c.clear(0,0,0,0),$I.addValue("out",$c),$M._set$P("_filterCache",$c),$M._set$P("_isHaveGlowFilter",$I.getValue("_isHaveGlowFilter"))},$m._EndTarget=function($I,$M){if($I.getValue("src").recycle(),$I.getValue("out").end(),$I.getValue("ScissorTest")){$yI.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),$M.ctx.save();var $E=$I.getValue("clipRect");$M.ctx.clipRect($E.x,$E.y,$E.width,$E.height)}},$m._useSrc=function($I){var $M=$I.getValue("out");$M.end(),($M=$I.getValue("src")).start(),$M.clear(0,0,0,0)},$m._endSrc=function($I){$I.getValue("src").end()},$m._useOut=function($I){var $M=$I.getValue("src");$M.end(),($M=$I.getValue("out")).start(),$M.clear(0,0,0,0)},$m._endOut=function($I){$I.getValue("out").end()},$m._recycleScope=function($I){$I.recycle()},$m._filter=function($I,$M,$E,$Z){var $i=this._next;if($i){var $n,$c,$f=$I.filters,$d=$f.length;if(1==$d&&32==$f[0].type)return $M.ctx.save(),$M.ctx.setFilters([$f[0]]),$i._fun.call($i,$I,$M,$E,$Z),void $M.ctx.restore();var $H=$fI.create(),$B=$T.TEMP,$A=$M.ctx._getTransformMatrix(),$Q=$j.create();$A.copyTo($Q);var $p=0,$t=0,$V=!1,$u=$I._$P._filterCache?$I._$P._filterCache:null;if(!$u||$I._repaint){$V=$I._isHaveGlowFilter(),$H.addValue("_isHaveGlowFilter",$V),$V&&($p=50,$t=25),($c=new $q).copyFrom($I.getSelfBounds()),$c.x+=$I.x,$c.y+=$I.y,$c.x-=$I.pivotX+4,$c.y-=$I.pivotY+4;var $N=$c.x,$y=$c.y;if($c.width+=$p+8,$c.height+=$p+8,$B.x=$c.x*$Q.a+$c.y*$Q.c,$B.y=$c.y*$Q.d+$c.x*$Q.b,$c.x=$B.x,$c.y=$B.y,$B.x=$c.width*$Q.a+$c.height*$Q.c,$B.y=$c.height*$Q.d+$c.width*$Q.b,$c.width=$B.x,$c.height=$B.y,$c.width<=0||$c.height<=0)return;$u&&$u.recycle(),$H.addValue("bounds",$c);var $$=$cI.create([$H,$I,$M,0,0],$m._filterStart);$M.addRenderObject($$),$M.ctx._renderKey=0,$M.ctx._shader2D.glTexture=null;var $w=$I.x-$N+$t,$g=$I.y-$y+$t;$i._fun.call($i,$I,$M,$w,$g),$$=$cI.create([$H,$I,$M,0,0],$m._filterEnd),$M.addRenderObject($$);for(var $O=0;$O<$d;$O++){0!=$O&&($$=$cI.create([$H],$m._useSrc),$M.addRenderObject($$),$n=$mI.create(1,0),$j.TEMP.identity(),$M.ctx.drawTarget($H,0,0,$c.width,$c.height,$j.TEMP,"out",$n,null,$F.TOINT.overlay),$$=$cI.create([$H],$m._useOut),$M.addRenderObject($$)),$f[$O].action.apply3d($H,$I,$M,0,0)}$$=$cI.create([$H,$M],$m._EndTarget),$M.addRenderObject($$)}else{if(($V=!!$I._$P._isHaveGlowFilter&&$I._$P._isHaveGlowFilter)&&($p=50,$t=25),($c=$I.getBounds()).width<=0||$c.height<=0)return;$c.width+=$p,$c.height+=$p,$B.x=$c.x*$Q.a+$c.y*$Q.c,$B.y=$c.y*$Q.d+$c.x*$Q.b,$c.x=$B.x,$c.y=$B.y,$B.x=$c.width*$Q.a+$c.height*$Q.c,$B.y=$c.height*$Q.d+$c.width*$Q.b,$c.width=$B.x,$c.height=$B.y,$H.addValue("out",$u)}$E=$E-$t-$I.x,$Z=$Z-$t-$I.y,$B.setTo($E,$Z),$Q.transformPoint($B),$E=$B.x+$c.x,$Z=$B.y+$c.y,$n=$mI.create(1,0),$j.TEMP.identity(),$M.ctx.drawTarget($H,$E,$Z,$c.width,$c.height,$j.TEMP,"out",$n,null,$F.TOINT.overlay),$$=$cI.create([$H],$m._recycleScope),$M.addRenderObject($$),$Q.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=$c._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=$c._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=$c._uint8ArraySlice),!0},$c.onStageResize=function($I,$M){null!=$c.mainContext&&($c.mainContext.viewport(0,0,$I,$M),$yI.width=$I,$yI.height=$M)},$c.onInvalidGLRes=function(){$r.instance.freeAll(),$w.releaseContentManagers(!0),$c.doNodeRepaint($O.stage),$c.mainContext.viewport(0,0,$yI.width,$yI.height),$O.stage.event("devicelost")},$c.doNodeRepaint=function($I){0==$I.numChildren&&$I.repaint();for(var $M=0;$M<$I.numChildren;$M++)$c.doNodeRepaint($I.getChildAt($M))},$c.init=function($I,$M,$E){$c.mainCanvas=$I,$H._createContext=function($I){return new $aI($I)},$_I._createContext=function($I){return new $aI($I)};var $Z=laya.webgl.WebGL.mainContext;if(null!=$Z.getShaderPrecisionFormat){var $i=$Z.getShaderPrecisionFormat(35633,36338),$n=$Z.getShaderPrecisionFormat(35632,36338);$c.shaderHighPrecision=!(!$i.precision||!$n.precision)}else $c.shaderHighPrecision=!1;if($c.compressAstc=$Z.getExtension("WEBGL_compressed_texture_astc"),$c.compressAtc=$Z.getExtension("WEBGL_compressed_texture_atc"),$c.compressEtc=$Z.getExtension("WEBGL_compressed_texture_etc"),$c.compressEtc1=$Z.getExtension("WEBGL_compressed_texture_etc1"),$c.compressPvrtc=$Z.getExtension("WEBGL_compressed_texture_pvrtc"),$c.compressS3tc=$Z.getExtension("WEBGL_compressed_texture_s3tc"),$c.compressS3tc_srgb=$Z.getExtension("WEBGL_compressed_texture_s3tc_srgb"),$c.compressAstc=$c.compressAstc?$c.compressAstc:{},$c.compressAtc=$c.compressAtc?$c.compressAtc:{},$c.compressEtc=$c.compressEtc?$c.compressEtc:{},$c.compressEtc1=$c.compressEtc1?$c.compressEtc1:{},$c.compressPvrtc=$c.compressPvrtc?$c.compressPvrtc:{},$c.compressS3tc=$c.compressS3tc?$c.compressS3tc:{},$c.compressS3tc_srgb=$c.compressS3tc_srgb?$c.compressS3tc_srgb:{},$Z.deleteTexture1=$Z.deleteTexture,$Z.deleteTexture=function($I){$I==$gI.curBindTexValue&&($gI.curBindTexValue=null),$Z.deleteTexture1($I)},$c.onStageResize($M,$E),null==$c.mainContext)throw new Error("webGL getContext err!");$L.__init__(),$r.__init__(),$vI.__init__(),$nI.__init__(),$aI.__init__(),$mI.__init__(),$b.__init__(),$YI.__int__($Z),$F._init_($Z),$N.isConchApp&&conch.setOnInvalidGLRes($c.onInvalidGLRes)},$c.mainCanvas=null,$c.antialias=!0,$c.shaderHighPrecision=!1,$c._bg_null=[0,0,0,0],$c}(),$gI=function(){function $Z(){}return $Q($Z,"laya.webgl.WebGLContext"),$Z.UseProgram=function($I){return $Z._useProgram!==$I&&($wI.mainContext.useProgram($I),$Z._useProgram=$I,!0)},$Z.setDepthTest=function($I,$M){$M!==$Z._depthTest&&(($Z._depthTest=$M)?$I.enable(2929):$I.disable(2929))},$Z.setDepthMask=function($I,$M){$M!==$Z._depthMask&&($Z._depthMask=$M,$I.depthMask($M))},$Z.setDepthFunc=function($I,$M){$M!==$Z._depthFunc&&($Z._depthFunc=$M,$I.depthFunc($M))},$Z.setBlend=function($I,$M){$M!==$Z._blend&&(($Z._blend=$M)?$I.enable(3042):$I.disable(3042))},$Z.setBlendFunc=function($I,$M,$E){($M!==$Z._sFactor||$E!==$Z._dFactor)&&($Z._sFactor=$M,$Z._dFactor=$E,$I.blendFunc($M,$E))},$Z.setCullFace=function($I,$M){$M!==$Z._cullFace&&(($Z._cullFace=$M)?$I.enable(2884):$I.disable(2884))},$Z.setFrontFace=function($I,$M){$M!==$Z._frontFace&&($Z._frontFace=$M,$I.frontFace($M))},$Z.bindTexture=function($I,$M,$E){$I.bindTexture($M,$E),$Z.curBindTexTarget=$M,$Z.curBindTexValue=$E},$Z.DEPTH_BUFFER_BIT=256,$Z.STENCIL_BUFFER_BIT=1024,$Z.COLOR_BUFFER_BIT=16384,$Z.POINTS=0,$Z.LINES=1,$Z.LINE_LOOP=2,$Z.LINE_STRIP=3,$Z.TRIANGLES=4,$Z.TRIANGLE_STRIP=5,$Z.TRIANGLE_FAN=6,$Z.ZERO=0,$Z.ONE=1,$Z.SRC_COLOR=768,$Z.ONE_MINUS_SRC_COLOR=769,$Z.SRC_ALPHA=770,$Z.ONE_MINUS_SRC_ALPHA=771,$Z.DST_ALPHA=772,$Z.ONE_MINUS_DST_ALPHA=773,$Z.DST_COLOR=774,$Z.ONE_MINUS_DST_COLOR=775,$Z.SRC_ALPHA_SATURATE=776,$Z.FUNC_ADD=32774,$Z.BLEND_EQUATION=32777,$Z.BLEND_EQUATION_RGB=32777,$Z.BLEND_EQUATION_ALPHA=34877,$Z.FUNC_SUBTRACT=32778,$Z.FUNC_REVERSE_SUBTRACT=32779,$Z.BLEND_DST_RGB=32968,$Z.BLEND_SRC_RGB=32969,$Z.BLEND_DST_ALPHA=32970,$Z.BLEND_SRC_ALPHA=32971,$Z.CONSTANT_COLOR=32769,$Z.ONE_MINUS_CONSTANT_COLOR=32770,$Z.CONSTANT_ALPHA=32771,$Z.ONE_MINUS_CONSTANT_ALPHA=32772,$Z.BLEND_COLOR=32773,$Z.ARRAY_BUFFER=34962,$Z.ELEMENT_ARRAY_BUFFER=34963,$Z.ARRAY_BUFFER_BINDING=34964,$Z.ELEMENT_ARRAY_BUFFER_BINDING=34965,$Z.STREAM_DRAW=35040,$Z.STATIC_DRAW=35044,$Z.DYNAMIC_DRAW=35048,$Z.BUFFER_SIZE=34660,$Z.BUFFER_USAGE=34661,$Z.CURRENT_VERTEX_ATTRIB=34342,$Z.FRONT=1028,$Z.BACK=1029,$Z.CULL_FACE=2884,$Z.FRONT_AND_BACK=1032,$Z.BLEND=3042,$Z.DITHER=3024,$Z.STENCIL_TEST=2960,$Z.DEPTH_TEST=2929,$Z.SCISSOR_TEST=3089,$Z.POLYGON_OFFSET_FILL=32823,$Z.SAMPLE_ALPHA_TO_COVERAGE=32926,$Z.SAMPLE_COVERAGE=32928,$Z.NO_ERROR=0,$Z.INVALID_ENUM=1280,$Z.INVALID_VALUE=1281,$Z.INVALID_OPERATION=1282,$Z.OUT_OF_MEMORY=1285,$Z.CW=2304,$Z.CCW=2305,$Z.LINE_WIDTH=2849,$Z.ALIASED_POINT_SIZE_RANGE=33901,$Z.ALIASED_LINE_WIDTH_RANGE=33902,$Z.CULL_FACE_MODE=2885,$Z.FRONT_FACE=2886,$Z.DEPTH_RANGE=2928,$Z.DEPTH_WRITEMASK=2930,$Z.DEPTH_CLEAR_VALUE=2931,$Z.DEPTH_FUNC=2932,$Z.STENCIL_CLEAR_VALUE=2961,$Z.STENCIL_FUNC=2962,$Z.STENCIL_FAIL=2964,$Z.STENCIL_PASS_DEPTH_FAIL=2965,$Z.STENCIL_PASS_DEPTH_PASS=2966,$Z.STENCIL_REF=2967,$Z.STENCIL_VALUE_MASK=2963,$Z.STENCIL_WRITEMASK=2968,$Z.STENCIL_BACK_FUNC=34816,$Z.STENCIL_BACK_FAIL=34817,$Z.STENCIL_BACK_PASS_DEPTH_FAIL=34818,$Z.STENCIL_BACK_PASS_DEPTH_PASS=34819,$Z.STENCIL_BACK_REF=36003,$Z.STENCIL_BACK_VALUE_MASK=36004,$Z.STENCIL_BACK_WRITEMASK=36005,$Z.VIEWPORT=2978,$Z.SCISSOR_BOX=3088,$Z.COLOR_CLEAR_VALUE=3106,$Z.COLOR_WRITEMASK=3107,$Z.UNPACK_ALIGNMENT=3317,$Z.PACK_ALIGNMENT=3333,$Z.MAX_TEXTURE_SIZE=3379,$Z.MAX_VIEWPORT_DIMS=3386,$Z.SUBPIXEL_BITS=3408,$Z.RED_BITS=3410,$Z.GREEN_BITS=3411,$Z.BLUE_BITS=3412,$Z.ALPHA_BITS=3413,$Z.DEPTH_BITS=3414,$Z.STENCIL_BITS=3415,$Z.POLYGON_OFFSET_UNITS=10752,$Z.POLYGON_OFFSET_FACTOR=32824,$Z.TEXTURE_BINDING_2D=32873,$Z.SAMPLE_BUFFERS=32936,$Z.SAMPLES=32937,$Z.SAMPLE_COVERAGE_VALUE=32938,$Z.SAMPLE_COVERAGE_INVERT=32939,$Z.NUM_COMPRESSED_TEXTURE_FORMATS=34466,$Z.COMPRESSED_TEXTURE_FORMATS=34467,$Z.DONT_CARE=4352,$Z.FASTEST=4353,$Z.NICEST=4354,$Z.GENERATE_MIPMAP_HINT=33170,$Z.BYTE=5120,$Z.UNSIGNED_BYTE=5121,$Z.SHORT=5122,$Z.UNSIGNED_SHORT=5123,$Z.INT=5124,$Z.UNSIGNED_INT=5125,$Z.FLOAT=5126,$Z.DEPTH_COMPONENT=6402,$Z.ALPHA=6406,$Z.RGB=6407,$Z.RGBA=6408,$Z.LUMINANCE=6409,$Z.LUMINANCE_ALPHA=6410,$Z.UNSIGNED_SHORT_4_4_4_4=32819,$Z.UNSIGNED_SHORT_5_5_5_1=32820,$Z.UNSIGNED_SHORT_5_6_5=33635,$Z.FRAGMENT_SHADER=35632,$Z.VERTEX_SHADER=35633,$Z.MAX_VERTEX_ATTRIBS=34921,$Z.MAX_VERTEX_UNIFORM_VECTORS=36347,$Z.MAX_VARYING_VECTORS=36348,$Z.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,$Z.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,$Z.MAX_TEXTURE_IMAGE_UNITS=34930,$Z.MAX_FRAGMENT_UNIFORM_VECTORS=36349,$Z.SHADER_TYPE=35663,$Z.DELETE_STATUS=35712,$Z.LINK_STATUS=35714,$Z.VALIDATE_STATUS=35715,$Z.ATTACHED_SHADERS=35717,$Z.ACTIVE_UNIFORMS=35718,$Z.ACTIVE_ATTRIBUTES=35721,$Z.SHADING_LANGUAGE_VERSION=35724,$Z.CURRENT_PROGRAM=35725,$Z.NEVER=512,$Z.LESS=513,$Z.EQUAL=514,$Z.LEQUAL=515,$Z.GREATER=516,$Z.NOTEQUAL=517,$Z.GEQUAL=518,$Z.ALWAYS=519,$Z.KEEP=7680,$Z.REPLACE=7681,$Z.INCR=7682,$Z.DECR=7683,$Z.INVERT=5386,$Z.INCR_WRAP=34055,$Z.DECR_WRAP=34056,$Z.VENDOR=7936,$Z.RENDERER=7937,$Z.VERSION=7938,$Z.NEAREST=9728,$Z.LINEAR=9729,$Z.NEAREST_MIPMAP_NEAREST=9984,$Z.LINEAR_MIPMAP_NEAREST=9985,$Z.NEAREST_MIPMAP_LINEAR=9986,$Z.LINEAR_MIPMAP_LINEAR=9987,$Z.TEXTURE_MAG_FILTER=10240,$Z.TEXTURE_MIN_FILTER=10241,$Z.TEXTURE_WRAP_S=10242,$Z.TEXTURE_WRAP_T=10243,$Z.TEXTURE_2D=3553,$Z.TEXTURE=5890,$Z.TEXTURE_CUBE_MAP=34067,$Z.TEXTURE_BINDING_CUBE_MAP=34068,$Z.TEXTURE_CUBE_MAP_POSITIVE_X=34069,$Z.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,$Z.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,$Z.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,$Z.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,$Z.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,$Z.MAX_CUBE_MAP_TEXTURE_SIZE=34076,$Z.TEXTURE0=33984,$Z.TEXTURE1=33985,$Z.TEXTURE2=33986,$Z.TEXTURE3=33987,$Z.TEXTURE4=33988,$Z.TEXTURE5=33989,$Z.TEXTURE6=33990,$Z.TEXTURE7=33991,$Z.TEXTURE8=33992,$Z.TEXTURE9=33993,$Z.TEXTURE10=33994,$Z.TEXTURE11=33995,$Z.TEXTURE12=33996,$Z.TEXTURE13=33997,$Z.TEXTURE14=33998,$Z.TEXTURE15=33999,$Z.TEXTURE16=34e3,$Z.TEXTURE17=34001,$Z.TEXTURE18=34002,$Z.TEXTURE19=34003,$Z.TEXTURE20=34004,$Z.TEXTURE21=34005,$Z.TEXTURE22=34006,$Z.TEXTURE23=34007,$Z.TEXTURE24=34008,$Z.TEXTURE25=34009,$Z.TEXTURE26=34010,$Z.TEXTURE27=34011,$Z.TEXTURE28=34012,$Z.TEXTURE29=34013,$Z.TEXTURE30=34014,$Z.TEXTURE31=34015,$Z.ACTIVE_TEXTURE=34016,$Z.REPEAT=10497,$Z.CLAMP_TO_EDGE=33071,$Z.MIRRORED_REPEAT=33648,$Z.FLOAT_VEC2=35664,$Z.FLOAT_VEC3=35665,$Z.FLOAT_VEC4=35666,$Z.INT_VEC2=35667,$Z.INT_VEC3=35668,$Z.INT_VEC4=35669,$Z.BOOL=35670,$Z.BOOL_VEC2=35671,$Z.BOOL_VEC3=35672,$Z.BOOL_VEC4=35673,$Z.FLOAT_MAT2=35674,$Z.FLOAT_MAT3=35675,$Z.FLOAT_MAT4=35676,$Z.SAMPLER_2D=35678,$Z.SAMPLER_CUBE=35680,$Z.VERTEX_ATTRIB_ARRAY_ENABLED=34338,$Z.VERTEX_ATTRIB_ARRAY_SIZE=34339,$Z.VERTEX_ATTRIB_ARRAY_STRIDE=34340,$Z.VERTEX_ATTRIB_ARRAY_TYPE=34341,$Z.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,$Z.VERTEX_ATTRIB_ARRAY_POINTER=34373,$Z.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,$Z.COMPILE_STATUS=35713,$Z.LOW_FLOAT=36336,$Z.MEDIUM_FLOAT=36337,$Z.HIGH_FLOAT=36338,$Z.LOW_INT=36339,$Z.MEDIUM_INT=36340,$Z.HIGH_INT=36341,$Z.FRAMEBUFFER=36160,$Z.RENDERBUFFER=36161,$Z.RGBA4=32854,$Z.RGB5_A1=32855,$Z.RGB565=36194,$Z.DEPTH_COMPONENT16=33189,$Z.STENCIL_INDEX=6401,$Z.STENCIL_INDEX8=36168,$Z.DEPTH_STENCIL=34041,$Z.RENDERBUFFER_WIDTH=36162,$Z.RENDERBUFFER_HEIGHT=36163,$Z.RENDERBUFFER_INTERNAL_FORMAT=36164,$Z.RENDERBUFFER_RED_SIZE=36176,$Z.RENDERBUFFER_GREEN_SIZE=36177,$Z.RENDERBUFFER_BLUE_SIZE=36178,$Z.RENDERBUFFER_ALPHA_SIZE=36179,$Z.RENDERBUFFER_DEPTH_SIZE=36180,$Z.RENDERBUFFER_STENCIL_SIZE=36181,$Z.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,$Z.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,$Z.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,$Z.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,$Z.COLOR_ATTACHMENT0=36064,$Z.DEPTH_ATTACHMENT=36096,$Z.STENCIL_ATTACHMENT=36128,$Z.DEPTH_STENCIL_ATTACHMENT=33306,$Z.NONE=0,$Z.FRAMEBUFFER_COMPLETE=36053,$Z.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,$Z.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,$Z.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,$Z.FRAMEBUFFER_UNSUPPORTED=36061,$Z.FRAMEBUFFER_BINDING=36006,$Z.RENDERBUFFER_BINDING=36007,$Z.MAX_RENDERBUFFER_SIZE=34024,$Z.INVALID_FRAMEBUFFER_OPERATION=1286,$Z.UNPACK_FLIP_Y_WEBGL=37440,$Z.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,$Z.CONTEXT_LOST_WEBGL=37442,$Z.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,$Z.BROWSER_DEFAULT_WEBGL=37444,$Z._useProgram=null,$Z._depthTest=!0,$Z._depthMask=!0,$Z._blend=!1,$Z._cullFace=!1,$Z.curBindTexTarget=null,$Z.curBindTexValue=null,$c($Z,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),$Z}(),$OI=function($I){function $M(){$M.__super.call(this)}$Q($M,"laya.webgl.display.GraphicsGL",$f);var $E=$M.prototype;return $E.setShader=function($I){this._saveToCmd($N.context._setShader,[$I])},$E.setIBVB=function($I,$M,$E,$Z,$i,$n){this._saveToCmd($N.context._setIBVB,[$I,$M,$E,$Z,$i,$n])},$E.drawParticle=function($I,$M,$E){var $Z=$g.createParticleTemplate2D($E);$Z.x=$I,$Z.y=$M,this._saveToCmd($N.context._drawParticle,[$Z])},$M}(),$aI=function($I){var $E;function $k($I){this._x=0,this._y=0,this._id=++$k._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,$k.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=$k.MAXCLIPRECT,this.mOutPoint,this._canvas=$I,this._canvas._addReference(),$k._contextcount++,$N.isFlash?(this._ib=$bI.create(35044),$uI.fillIBQuadrangle(this._ib,16)):this._ib=$bI.QuadrangleIB,this.clear()}$Q($k,"laya.webgl.canvas.WebGLContext2D",$i);var $M=$k.prototype;return $M.setIsMainContext=function(){this._isMain=!0},$M.clearBG=function($I,$M,$E,$Z){var $i=$wI.mainContext;$i.clearColor($I,$M,$E,$Z),$i.clear(16384)},$M._getSubmits=function(){return this._submits},$M._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var $I=0,$M=this._submits._length;$I<$M;$I++)this._submits[$I].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},$M.destroy=function(){--$k._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=$bI.QuadrangleIB&&this._ib.releaseResource()},$M.clear=function(){this._submits||(this._other=$E.DEFAULT,this._curMat=$j.create(),this._vb=$UI.create(-1),this._submits=[],this._save=[$G.Create(this)],this._save.length=10,this._shader2D=new $b,this._triangleMesh=$SI.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=$E.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=$k.MAXCLIPRECT,this._curSubmit=$nI.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=$e.DEFAULT;for(var $I=0,$M=this._submits._length;$I<$M;$I++)this._submits[$I].releaseRender(),this._submits[$I]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},$M.size=function($I,$M){if(this._width!=$I||this._height!=$M)if(0==$I||0==$M){0!=this._vb._byteLength&&(this._width=$I,this._height=$M,this._vb.clear(),this._vb.upload());for(var $E=0,$Z=this._submits._length;$E<$Z;$E++)this._submits[$E].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=$I,this._height=$M,this._targets&&this._targets.size($I,$M),this._canvas.memorySize-=this._canvas.memorySize;0===$I&&0===$M&&this._releaseMem()},$M._getTransformMatrix=function(){return this._curMat},$M.translate=function($I,$M){0===$I&&0===$M||($K.save(this),this._curMat.bTransform&&($Y.save(this),this._curMat.transformPointN($T.TEMP.setTo($I,$M)),$I=$T.TEMP.x,$M=$T.TEMP.y),this._x+=$I,this._y+=$M)},$M.save=function(){this._save[this._save._length++]=$G.Create(this)},$M.restore=function(){var $I=this._save._length;if(!($I<1))for(var $M=$I-1;0<=$M;$M--){var $E=this._save[$M];if($E.restore(this),$E.isSaveMark())return void(this._save._length=$M)}},$M._fillText=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){void 0===$H&&($H=0);var $B=this._shader2D,$A=this._curSubmit.shaderValue,$Q=$i?$tI.create($i):this._other.font;if($r.enabled)$B.ALPHA!==$A.ALPHA&&($B.glTexture=null),$pI.drawText(this,$I,$M,this._curMat,$Q,$d||this._other.textAlign,$n,$c,$f,$E,$Z,$H);else{this._shader2D.defines.getValue();var $p=$n?$t.create($n)._color:$B.colorAdd;$B.ALPHA===$A.ALPHA&&$p===$B.colorAdd&&$A.colorAdd===$B.colorAdd||($B.glTexture=null,$B.colorAdd=$p),$pI.drawText(this,$I,$M,this._curMat,$Q,$d||this._other.textAlign,$n,$c,$f,$E,$Z,$H)}},$M.fillWords=function($I,$M,$E,$Z,$i,$n){this._fillText(null,$I,$M,$E,$Z,$i,null,-1,null,$n)},$M.fillBorderWords=function($I,$M,$E,$Z,$i,$n,$c){this._fillBorderText(null,$I,$M,$E,$Z,$i,$n,$c,null)},$M.fillText=function($I,$M,$E,$Z,$i,$n){this._fillText($I,null,$M,$E,$Z,$i,null,-1,$n)},$M.strokeText=function($I,$M,$E,$Z,$i,$n,$c){this._fillText($I,null,$M,$E,$Z,null,$i,$n||1,$c)},$M.fillBorderText=function($I,$M,$E,$Z,$i,$n,$c,$f){this._fillBorderText($I,null,$M,$E,$Z,$i,$n,$c,$f)},$M._fillBorderText=function($I,$M,$E,$Z,$i,$n,$c,$f,$d){if(!$r.enabled)return this._fillText($I,$M,$E,$Z,$i,null,$c,$f||1,$d),void this._fillText($I,$M,$E,$Z,$i,$n,null,-1,$d);var $H=this._shader2D,$B=this._curSubmit.shaderValue;$H.ALPHA!==$B.ALPHA&&($H.glTexture=null);var $A=$i?($k._fontTemp.setFont($i),$k._fontTemp):this._other.font;$pI.drawText(this,$I,$M,this._curMat,$A,$d||this._other.textAlign,$n,$c,$f||1,$E,$Z,0)},$M.fillRect=function($I,$M,$E,$Z,$i){var $n=this._vb;if($uI.fillRectImgVb($n,this._clipRect,$I,$M,$E,$Z,$S.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $c=this._shader2D.fillStyle;$i&&(this._shader2D.fillStyle=$e.create($i));var $f=this._shader2D,$d=this._curSubmit.shaderValue;if($f.fillStyle!==$d.fillStyle||$f.ALPHA!==$d.ALPHA){$f.glTexture=null;var $H=this._curSubmit=$nI.createSubmit(this,this._ib,$n,($n._byteLength-64)/32*3,$mI.create(2,0));$H.shaderValue.color=$f.fillStyle._color._color,$H.shaderValue.ALPHA=$f.ALPHA,this._submits[this._submits._length++]=$H}this._curSubmit._numEle+=6,this._shader2D.fillStyle=$c}},$M.fillTexture=function($I,$M,$E,$Z,$i,$n,$c,$f){if($I.loaded&&$I.bitmap&&$I.source){var $d=this._vb,$H=$I.bitmap.width,$B=$I.bitmap.height,$A=$I.uv,$Q=$c.x%$I.width,$p=$c.y%$I.height;if($H!=$f.w||$B!=$f.h){if(!$f.w&&!$f.h)switch($f.oy=$f.ox=0,$n){case"repeat":$f.width=$Z,$f.height=$i;break;case"repeat-x":$f.width=$Z,$p<0?$I.height+$p>$i?$f.height=$i:$f.height=$I.height+$p:($f.oy=$p,$I.height+$p>$i?$f.height=$i-$p:$f.height=$I.height);break;case"repeat-y":$Q<0?$I.width+$Q>$Z?$f.width=$Z:$f.width=$I.width+$Q:($f.ox=$Q,$I.width+$Q>$Z?$f.width=$Z-$Q:$f.width=$I.width),$f.height=$i;break;case"no-repeat":$Q<0?$I.width+$Q>$Z?$f.width=$Z:$f.width=$I.width+$Q:($f.ox=$Q,$I.width+$Q>$Z?$f.width=$Z-$Q:$f.width=$I.width),$p<0?$I.height+$p>$i?$f.height=$i:$f.height=$I.height+$p:($f.oy=$p,$I.height+$p>$i?$f.height=$i-$p:$f.height=$I.height);break;default:$f.width=$Z,$f.height=$i}$f.w=$H,$f.h=$B,$f.uv=[0,0,$f.width/$H,0,$f.width/$H,$f.height/$B,0,$f.height/$B]}if($M+=$f.ox,$E+=$f.oy,$Q-=$f.ox,$p-=$f.oy,$uI.fillRectImgVb($d,this._clipRect,$M,$E,$f.width,$f.height,$f.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var $t=$oI.create(this,this._ib,$d,($d._byteLength-64)/32*3,$mI.create(256,0)),$V=(this._submits[this._submits._length++]=$t).shaderValue;$V.textureHost=$I;var $u=$A[0]*$H,$N=$A[1]*$B,$y=($A[2]-$A[0])*$H,$$=($A[5]-$A[3])*$B,$w=-$Q/$H,$g=-$p/$B;$V.u_TexRange[0]=$u/$H,$V.u_TexRange[1]=$y/$H,$V.u_TexRange[2]=$N/$B,$V.u_TexRange[3]=$$/$B,$V.u_offset[0]=$w,$V.u_offset[1]=$g,$r.enabled&&!this._isMain&&$t.addTexture($I,($d._byteLength>>2)-16),(this._curSubmit=$t)._renderType=10017,$t._numEle+=6}}else this.sprite&&$O.timer.callLater(this,this._repaintSprite)},$M.setShader=function($I){$h.save(this,1048576,this._shader2D,!0),this._shader2D.shader=$I},$M.setFilters=function($I){$h.save(this,2097152,this._shader2D,!0),this._shader2D.filters=$I,this._curSubmit=$nI.RENDERBASE,this._renderKey=0,this._drawCount++},$M.drawTexture=function($I,$M,$E,$Z,$i,$n,$c){this._drawTextureM($I,$M,$E,$Z,$i,$n,$c,null,1)},$M.addTextureVb=function($I,$M,$E){var $Z=this._curSubmit._vb||this._vb,$i=$Z._byteLength>>2;$Z.byteLength=$i+16<<2;for(var $n=$Z.getFloat32Array(),$c=0;$c<16;$c+=4)$n[$i++]=$I[$c]+$M,$n[$i++]=$I[$c+1]+$E,$n[$i++]=$I[$c+2],$n[$i++]=$I[$c+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),$Z._upload=!0},$M.willDrawTexture=function($I,$M){if(!($I.loaded&&$I.bitmap&&$I.source))return this.sprite&&$O.timer.callLater(this,this._repaintSprite),0;var $E=$I.bitmap,$Z=$E.id+this._shader2D.ALPHA*$M+10016;if($Z==this._renderKey)return $Z;var $i=this._shader2D,$n=$i.ALPHA,$c=this._curSubmit.shaderValue;$i.ALPHA*=$M,this._renderKey=$Z,this._drawCount++,$i.glTexture=$E;var $f=this._vb,$d=null,$H=$f._byteLength/32*3,$B=$c.textureHost&&$c.textureHost==$I&&$c.textureHost.alphaTexture==$I.alphaTexture;return $d=$oI.create(this,this._ib,$f,$H,$mI.create(1,0)),(this._submits[this._submits._length++]=$d).shaderValue.textureHost=$I,$d._renderType=10016,$d._preIsSameTextureShader=10016===this._curSubmit._renderType&&$i.ALPHA===$c.ALPHA&&$B,this._curSubmit=$d,$i.ALPHA=$n,$Z},$M.drawTextures=function($I,$M,$E,$Z){if($I.loaded&&$I.bitmap&&$I.source){var $i=this._clipRect;if(this._clipRect=$k.MAXCLIPRECT,this._drawTextureM($I,$M[0],$M[1],$I.width,$I.height,$E,$Z,null,1)){if(this._clipRect=$i,$R.drawCall++,!($M.length<4)){for(var $n=this._curSubmit._vb||this._vb,$c=this._curMat.a,$f=this._curMat.d,$d=2,$H=$M.length;$d<$H;$d+=2)$uI.copyPreImgVb($n,($M[$d]-$M[$d-2])*$c,($M[$d+1]-$M[$d-1])*$f),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&$O.timer.callLater(this,this._repaintSprite)},$M._drawTextureM=function($I,$M,$E,$Z,$i,$n,$c,$f,$d){if(!$I.loaded||!$I.source)return this.sprite&&$O.timer.callLater(this,this._repaintSprite),!1;var $H=this._curSubmit._vb||this._vb,$B=$I.bitmap;$M+=$n,$E+=$c,this._drawCount++;var $A=$B.id+this._shader2D.ALPHA*$d+10016;if($A!=this._renderKey){this._renderKey=$A;var $Q=this._curSubmit.shaderValue,$p=this._shader2D,$t=$p.ALPHA;$p.ALPHA*=$d,$p.glTexture=$B;var $V=this._vb,$u=null,$N=$V._byteLength/32*3,$y=$Q.textureHost&&$Q.textureHost==$I&&$Q.textureHost.alphaTexture==$I.alphaTexture;$u=$oI.create(this,this._ib,$V,$N,$mI.create(1,0)),(this._submits[this._submits._length++]=$u).shaderValue.textureHost=$I,$u._renderType=10016,$u._preIsSameTextureShader=10016===this._curSubmit._renderType&&$p.ALPHA===$Q.ALPHA&&$y,this._curSubmit=$u,$H=this._curSubmit._vb||this._vb,$p.ALPHA=$t}return!!$uI.fillRectImgVb($H,this._clipRect,$M,$E,$Z||$I.width,$i||$I.height,$I.uv,$f||this._curMat,this._x,this._y,0,0)&&($r.enabled&&!this._isMain&&this._curSubmit.addTexture($I,($H._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},$M._repaintSprite=function(){this.sprite&&this.sprite.repaint()},$M._drawText=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){var $B=$I.bitmap;this._drawCount++;var $A=$B.id+this._shader2D.ALPHA+10016;if($A!=this._renderKey){this._renderKey=$A;var $Q=this._curSubmit.shaderValue,$p=this._shader2D;$p.glTexture=$B;var $t=this._vb,$V=null,$u=$t._byteLength/32*3,$N=$Q.textureHost&&$Q.textureHost==$I&&$Q.textureHost.alphaTexture==$I.alphaTexture;($V=$r.enabled?$oI.create(this,this._ib,$t,$u,$mI.create(1,0)):$oI.create(this,this._ib,$t,$u,$KI.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&$p.ALPHA===$Q.ALPHA&&$N,(this._submits[this._submits._length++]=$V).shaderValue.textureHost=$I,$V._renderType=10016,this._curSubmit=$V}$I.active();var $y=this._curSubmit._vb||this._vb;$uI.fillRectImgVb($y,this._clipRect,$M+$c,$E+$f,$Z||$I.width,$i||$I.height,$I.uv,$n||this._curMat,this._x,this._y,$d,$H,!0)&&($r.enabled&&!this._isMain&&this._curSubmit.addTexture($I,($y._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},$M.drawTextureWithTransform=function($I,$M,$E,$Z,$i,$n,$c,$f,$d){if($n){var $H=this._curMat,$B=this._x,$A=this._y;(0!==$c||0!==$f)&&(this._x=$c*$H.a+$f*$H.c,this._y=$f*$H.d+$c*$H.b),$n&&$H.bTransform?($j.mul($n,$H,$k._tmpMatrix),($n=$k._tmpMatrix)._checkTransform()):(this._x+=$H.tx,this._y+=$H.ty),this._drawTextureM($I,$M,$E,$Z,$i,0,0,$n,$d),this._x=$B,this._y=$A}else this._drawTextureM($I,$M,$E,$Z,$i,$c,$f,null,$d)},$M.fillQuadrangle=function($I,$M,$E,$Z,$i){var $n=this._curSubmit,$c=this._vb,$f=this._shader2D,$d=$n.shaderValue;if(this._renderKey=0,$I.bitmap){var $H=$I.bitmap;$f.glTexture==$H&&$f.ALPHA===$d.ALPHA||($f.glTexture=$H,($n=this._curSubmit=$nI.createSubmit(this,this._ib,$c,$c._byteLength/32*3,$mI.create(1,0))).shaderValue.glTexture=$H,this._submits[this._submits._length++]=$n),$uI.fillQuadrangleImgVb($c,$M,$E,$Z,$I.uv,$i||this._curMat,this._x,this._y)}else $n.shaderValue.fillStyle&&$n.shaderValue.fillStyle.equal($I)&&$f.ALPHA===$d.ALPHA||($f.glTexture=null,($n=this._curSubmit=$nI.createSubmit(this,this._ib,$c,$c._byteLength/32*3,$mI.create(2,0))).shaderValue.defines.add(2),$n.shaderValue.fillStyle=$e.create($I),this._submits[this._submits._length++]=$n),$uI.fillQuadrangleImgVb($c,$M,$E,$Z,$S.DEF_UV,$i||this._curMat,this._x,this._y);$n._numEle+=6},$M.drawTexture2=function($I,$M,$E,$Z,$i,$n,$c,$f){if(0!=$n){var $d=this._curMat;if(this._x=$I*$d.a+$M*$d.c,this._y=$M*$d.d+$I*$d.b,$i&&($i=$d.bTransform||$i.bTransform?($j.mul($i,$d,$k._tmpMatrix),$k._tmpMatrix):(this._x+=$i.tx+$d.tx,this._y+=$i.ty+$d.ty,$j.EMPTY)),1!==$n||$c){var $H=this._shader2D.ALPHA,$B=this._nBlendType;this._shader2D.ALPHA=$n,$c&&(this._nBlendType=$F.TOINT($c)),this._drawTextureM($f[0],$f[1]-$E,$f[2]-$Z,$f[3],$f[4],0,0,$i,1),this._shader2D.ALPHA=$H,this._nBlendType=$B}else this._drawTextureM($f[0],$f[1]-$E,$f[2]-$Z,$f[3],$f[4],0,0,$i,1);this._x=this._y=0}},$M.drawCanvas=function($I,$M,$E,$Z,$i){var $n=$I.context;if(this._renderKey=0,$n._targets)this._submits[this._submits._length++]=$LI.create($n,0,null),this._curSubmit=$nI.RENDERBASE,$n._targets.drawTo(this,$M,$E,$Z,$i);else{var $c=this._submits[this._submits._length++]=$LI.create($n,this._shader2D.ALPHA,this._shader2D.filters),$f=$Z/$I.width,$d=$i/$I.height,$H=$c._matrix;this._curMat.copyTo($H),1!=$f&&1!=$d&&$H.scale($f,$d);var $B=$H.tx,$A=$H.ty;$H.tx=$H.ty=0,$H.transformPoint($T.TEMP.setTo($M,$E)),$H.translate($T.TEMP.x+$B,$T.TEMP.y+$A),this._curSubmit=$nI.RENDERBASE}$a.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=$n._targets?"yellow":"green",this.strokeRect($M-1,$E-1,$Z+2,$i+2,1),this.strokeRect($M,$E,$Z,$i,1),this.restore())},$M.drawTarget=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){void 0===$H&&($H=-1);var $B=this._vb;if($uI.fillRectImgVb($B,this._clipRect,$M,$E,$Z,$i,$d||$S.DEF_UV,$n||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var $A=this._curSubmit=$AI.create(this,this._ib,$B,($B._byteLength-64)/32*3,$f,$c);$A.blendType=-1==$H?this._nBlendType:$H,$A.scope=$I,this._submits[this._submits._length++]=$A,this._curSubmit._numEle+=6}},$M.mixRGBandAlpha=function($I){return this._mixRGBandAlpha($I,this._shader2D.ALPHA)},$M._mixRGBandAlpha=function($I,$M){var $E=(4278190080&$I)>>>24;return 0!=$E?$E*=$M:$E=255*$M,16777215&$I|$E<<24},$M.drawTriangles=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){if(!$I.loaded||!$I.source)return this.sprite&&$O.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;$I.bitmap;var $B=this._mixRGBandAlpha(4294967295,$f),$A=($Z.length,$n.length);this._renderKey=-1;var $Q=this._curSubmit=$oI.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,$mI.create(1,0));return $Q.shaderValue.textureHost=$I,$Q._renderType=10016,this._submits[this._submits._length++]=$Q,$c?($k._tmpMatrix.a=$c.a,$k._tmpMatrix.b=$c.b,$k._tmpMatrix.c=$c.c,$k._tmpMatrix.d=$c.d,$k._tmpMatrix.tx=$c.tx+$M,$k._tmpMatrix.ty=$c.ty+$E,$j.mul($k._tmpMatrix,this._curMat,$k._tmpMatrix)):($k._tmpMatrix.a=this._curMat.a,$k._tmpMatrix.b=this._curMat.b,$k._tmpMatrix.c=this._curMat.c,$k._tmpMatrix.d=this._curMat.d,$k._tmpMatrix.tx=this._curMat.tx+$M,$k._tmpMatrix.ty=this._curMat.ty+$E),this._triangleMesh.addData($Z,$i,$n,$k._tmpMatrix,$B,this),this._curSubmit._numEle+=$A,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},$M.transform=function($I,$M,$E,$Z,$i,$n){$Y.save(this),$j.mul($j.TEMP.setTo($I,$M,$E,$Z,$i,$n),this._curMat,this._curMat),this._curMat._checkTransform()},$M.setTransformByMatrix=function($I){$I.copyTo(this._curMat)},$M.transformByMatrix=function($I){$Y.save(this),$j.mul($I,this._curMat,this._curMat),this._curMat._checkTransform()},$M.rotate=function($I){$Y.save(this),this._curMat.rotateEx($I)},$M.scale=function($I,$M){$Y.save(this),this._curMat.scaleEx($I,$M)},$M.clipRect=function($I,$M,$E,$Z){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var $i=$BI.create(4);this.addRenderObject($i);var $n=this._vb,$c=$n._byteLength>>2;if($uI.fillRectImgVb($n,null,$I,$M,$E,$Z,$S.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var $f=this._curSubmit=$nI.createSubmit(this,this._ib,$n,($n._byteLength-64)/32*3,$mI.create(2,0));$f.shaderValue.ALPHA=1,this._submits[this._submits._length++]=$f,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var $d=$BI.create(5);this.addRenderObject($d);var $H=$n.getFloat32Array(),$B=Math.min(Math.min(Math.min($H[0+$c],$H[4+$c]),$H[8+$c]),$H[12+$c]),$A=Math.max(Math.max(Math.max($H[0+$c],$H[4+$c]),$H[8+$c]),$H[12+$c]),$Q=Math.min(Math.min(Math.min($H[1+$c],$H[5+$c]),$H[9+$c]),$H[13+$c]),$p=Math.max(Math.max(Math.max($H[1+$c],$H[5+$c]),$H[9+$c]),$H[13+$c]);$D.save(this,$d,$I,$M,$E,$Z,$B,$Q,$A-$B,$p-$Q),this._curSubmit=$nI.RENDERBASE}else{$E*=this._curMat.a,$Z*=this._curMat.d;var $t=$T.TEMP;this._curMat.transformPoint($t.setTo($I,$M)),$E<0&&($t.x=$t.x+$E,$E=-$E),$Z<0&&($t.y=$t.y+$Z,$Z=-$Z),this._renderKey=0;var $V=this._curSubmit=$HI.create(this);(this._submits[this._submits._length++]=$V).submitIndex=this._submits._length,$V.submitLength=9999999,$P.save(this,$V);var $u=this._clipRect,$N=$u.x,$y=$u.y,$$=$t.x+$E,$w=$t.y+$Z;$N<$t.x&&($u.x=$t.x),$y<$t.y&&($u.y=$t.y),$u.width=Math.min($$,$N+$u.width)-$u.x,$u.height=Math.min($w,$y+$u.height)-$u.y,this._shader2D.glTexture=null,$V.clipRect.copyFrom($u),this._curSubmit=$nI.RENDERBASE}},$M.setIBVB=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B){if(void 0===$d&&($d=0),void 0===$H&&($H=0),void 0===$B&&($B=0),null===$E){if($N.isFlash){var $A=$Z;$A._selfIB||($A._selfIB=$bI.create(35044)),$A._selfIB.clear(),$E=$A._selfIB}else $E=this._ib;$uI.expandIBQuadrangle($E,$Z._byteLength/(4*$Z.vertexStride*4))}if(!$f||!$c)throw Error("setIBVB must input:shader shaderValues");var $Q=$dI.create(this,$Z,$E,$i,$c,$f,$d,$H,$B);$n||($n=$j.EMPTY),$n.translate($I,$M),$j.mul($n,this._curMat,$Q._mat),$n.translate(-$I,-$M),this._submits[this._submits._length++]=$Q,this._curSubmit=$nI.RENDERBASE,this._renderKey=0},$M.addRenderObject=function($I){this._submits[this._submits._length++]=$I},$M.fillTrangles=function($I,$M,$E,$Z,$i){var $n=this._curSubmit,$c=this._vb,$f=this._shader2D,$d=$n.shaderValue,$H=$Z.length>>4,$B=$I.bitmap;this._renderKey=0,$f.glTexture==$B&&$f.ALPHA===$d.ALPHA||(($n=this._curSubmit=$nI.createSubmit(this,this._ib,$c,$c._byteLength/32*3,$mI.create(1,0))).shaderValue.textureHost=$I,this._submits[this._submits._length++]=$n),$uI.fillTranglesVB($c,$M,$E,$Z,$i||this._curMat,this._x,this._y),$n._numEle+=6*$H},$M.submitElement=function($I,$M){var $E=this._submits;for($M<0&&($M=$E._length);$I<$M;)$I+=$E[$I].renderSubmit()},$M.finish=function(){$wI.mainContext.finish()},$M.flush=function(){var $I=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if($I>this._ib.bufferLength/12&&$uI.expandIBQuadrangle(this._ib,$I),!this._isMain&&$r.enabled&&$r._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=$r._atlasRestore;for(var $M=this._submits,$E=0,$Z=$M._length;$E<$Z;$E++){var $i=$M[$E];10016===$i.getRenderType()&&$i.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),$MI.instance&&$MI.getInstance().reset();var $n;for($E=0,$n=this.meshlist.length;$E<$n;$E++){var $c=this.meshlist[$E];$c.canReuse?$c.releaseMesh():$c.destroy()}return this.meshlist.length=0,this._curSubmit=$nI.RENDERBASE,this._renderKey=0,this._triangleMesh=$SI.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},$M.setPathId=function($I){if(this.mId=$I,-1!=this.mId){this.mHaveKey=!1;var $M=$C.getInstance();$M.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,$M.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},$M.movePath=function($I,$M){var $E=$I,$Z=$M;$I=this._curMat.a*$E+this._curMat.c*$Z+this._curMat.tx,$M=this._curMat.b*$E+this._curMat.d*$Z+this._curMat.ty,this.mX+=$I,this.mY+=$M},$M.beginPath=function(){var $I=this._getPath();$I.tempArray.length=0,$I.closePath=!1,this.mX=0,this.mY=0},$M.closePath=function(){this._path.closePath=!0},$M.fill=function($I){void 0===$I&&($I=!1);var $M=this._getPath();this.drawPoly(0,0,$M.tempArray,this.fillStyle._color.numColor,0,0,$I)},$M.stroke=function(){var $I=this._getPath();if(0<this.lineWidth){if(-1==this.mId)$I.drawLine(0,0,$I.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var $M=$C.getInstance().shapeLineDic[this.mId];$M.rebuild($I.tempArray),$I.setGeomtry($M)}else $C.getInstance().addLine(this.mId,$I.drawLine(0,0,$I.tempArray,this.lineWidth,this.strokeStyle._color.numColor));$I.update();var $E=[this.mX,this.mY],$Z=$nI.createShape(this,$I.ib,$I.vb,$I.count,$I.offset,$mI.create(4,0));$Z.shaderValue.ALPHA=this._shader2D.ALPHA,$Z.shaderValue.u_pos=$E,$Z.shaderValue.u_mmat2=$yI.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=$Z,this._renderKey=-1}},$M.line=function($I,$M,$E,$Z,$i,$n){var $c=this._curSubmit,$f=this._vb;if($uI.fillLineVb($f,this._clipRect,$I,$M,$E,$Z,$i,$n)){this._renderKey=0;var $d=this._shader2D,$H=$c.shaderValue;$d.strokeStyle===$H.strokeStyle&&$d.ALPHA===$H.ALPHA||($d.glTexture=null,($c=this._curSubmit=$nI.createSubmit(this,this._ib,$f,($f._byteLength-64)/32*3,$mI.create(2,0))).shaderValue.strokeStyle=$d.strokeStyle,$c.shaderValue.mainID=2,$c.shaderValue.ALPHA=$d.ALPHA,this._submits[this._submits._length++]=$c),$c._numEle+=6}},$M.moveTo=function($I,$M,$E){void 0===$E&&($E=!0);var $Z=this._getPath();if($E){var $i=$I,$n=$M;$I=this._curMat.a*$i+this._curMat.c*$n,$M=this._curMat.b*$i+this._curMat.d*$n}$Z.addPoint($I,$M)},$M.lineTo=function($I,$M,$E){void 0===$E&&($E=!0);var $Z=this._getPath();if($E){var $i=$I,$n=$M;$I=this._curMat.a*$i+this._curMat.c*$n,$M=this._curMat.b*$i+this._curMat.d*$n}$Z.addPoint($I,$M)},$M.drawCurves=function($I,$M,$E){this.setPathId(-1),this.beginPath(),this.strokeStyle=$E[3],this.lineWidth=$E[4];var $Z=$E[2];$I+=$E[0],$M+=$E[1],this.movePath($I,$M),this.moveTo($Z[0],$Z[1]);for(var $i=2,$n=$Z.length;$i<$n;)this.quadraticCurveTo($Z[$i++],$Z[$i++],$Z[$i++],$Z[$i++]);this.stroke()},$M.arcTo=function($I,$M,$E,$Z,$i){if(-1==this.mId||!this.mHaveKey){var $n=0,$c=0,$f=0,$d=this._getPath();this._curMat.copyTo($k._tmpMatrix),$k._tmpMatrix.tx=$k._tmpMatrix.ty=0,$k._tempPoint.setTo($d.getEndPointX(),$d.getEndPointY()),$k._tmpMatrix.invertTransformPoint($k._tempPoint);var $H=$k._tempPoint.x-$I,$B=$k._tempPoint.y-$M,$A=Math.sqrt($H*$H+$B*$B);if(!($A<=1e-6)){var $Q=$H/$A,$p=$B/$A,$t=$E-$I,$V=$Z-$M,$u=$t*$t+$V*$V,$N=Math.sqrt($u);if(!($N<=1e-6)){var $y=$t/$N,$$=$V/$N,$w=$Q+$y,$g=$p+$$,$O=Math.sqrt($w*$w+$g*$g);if(!($O<=1e-6)){var $a=$w/$O,$m=$g/$O,$j=Math.acos($a*$Q+$m*$p),$T=Math.PI/2-$j,$q=($A=$i/Math.tan($T))*$Q+$I,$v=$A*$p+$M,$W=Math.sqrt($A*$A+$i*$i),$R=$I+$a*$W,$z=$M+$m*$W,$L=0,$o=0;if(0<=$Q*$$-$p*$y){var $S=2*$T/$k.SEGNUM;$L=Math.sin($S),$o=Math.cos($S)}else $S=2*-$T/$k.SEGNUM,$L=Math.sin($S),$o=Math.cos($S);$c=this._curMat.a*$q+this._curMat.c*$v,$f=this._curMat.b*$q+this._curMat.d*$v,$c==this._path.getEndPointX()&&$f==this._path.getEndPointY()||$d.addPoint($c,$f);var $X=$q-$R,$C=$v-$z;for($n=0;$n<$k.SEGNUM;$n++){var $J=$X*$o+$C*$L,$x=-$X*$L+$C*$o;$c=$J+$R,$f=$x+$z,$I=this._curMat.a*$c+this._curMat.c*$f,$f=$M=this._curMat.b*$c+this._curMat.d*$f,($c=$I)==this._path.getEndPointX()&&$f==this._path.getEndPointY()||$d.addPoint($c,$f),$X=$J,$C=$x}}}}}},$M.arc=function($I,$M,$E,$Z,$i,$n,$c){if(void 0===$n&&($n=!1),void 0===$c&&($c=!0),-1!=this.mId){var $f=$C.getInstance().shapeDic[this.mId];if($f&&this.mHaveKey&&!$f.needUpdate(this._curMat))return;$M=$I=0}var $d,$H=0,$B=0,$A=0,$Q=0,$p=0,$t=0,$V=0;if($B=$i-$Z,$n)if(Math.abs($B)>=2*Math.PI)$B=2*-Math.PI;else for(;0<$B;)$B-=2*Math.PI;else if(Math.abs($B)>=2*Math.PI)$B=2*Math.PI;else for(;$B<0;)$B+=2*Math.PI;$d=$B/($V=$E<101?Math.max(10,$B*$E/5):$E<201?Math.max(10,$B*$E/20):Math.max(10,$B*$E/40))/2,$A=Math.abs(4/3*(1-Math.cos($d))/Math.sin($d)),$n&&($A=-$A);var $u=this._getPath(),$N=NaN,$y=NaN;for($t=0;$t<=$V;$t++)$H=$Z+$B*($t/$V),$Q=$I+Math.cos($H)*$E,$p=$M+Math.sin($H)*$E,$c&&($N=$Q,$y=$p,$Q=this._curMat.a*$N+this._curMat.c*$y,$p=this._curMat.b*$N+this._curMat.d*$y),$Q==this._path.getEndPointX()&&$p==this._path.getEndPointY()||$u.addPoint($Q,$p);$Q=$I+Math.cos($i)*$E,$p=$M+Math.sin($i)*$E,$c&&($N=$Q,$y=$p,$Q=this._curMat.a*$N+this._curMat.c*$y,$p=this._curMat.b*$N+this._curMat.d*$y),$Q==this._path.getEndPointX()&&$p==this._path.getEndPointY()||$u.addPoint($Q,$p)},$M.quadraticCurveTo=function($I,$M,$E,$Z){var $i=$A.I,$n=$E,$c=$Z;$E=this._curMat.a*$n+this._curMat.c*$c,$Z=this._curMat.b*$n+this._curMat.d*$c,$n=$I,$c=$M,$I=this._curMat.a*$n+this._curMat.c*$c,$M=this._curMat.b*$n+this._curMat.d*$c;for(var $f=$i.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),$I,$M,$E,$Z],30,2),$d=0,$H=$f.length/2;$d<$H;$d++)this.lineTo($f[2*$d],$f[2*$d+1],!1);this.lineTo($E,$Z,!1)},$M.rect=function($I,$M,$E,$Z){this._other=this._other.make(),this._other.path||(this._other.path=new $_),this._other.path.rect($I,$M,$E,$Z)},$M.strokeRect=function($I,$M,$E,$Z,$i){var $n=.5*$i;this.line($I-$n,$M,$I+$E+$n,$M,$i,this._curMat),this.line($I+$E,$M,$I+$E,$M+$Z,$i,this._curMat),this.line($I,$M,$I,$M+$Z,$i,this._curMat),this.line($I-$n,$M+$Z,$I+$E+$n,$M+$Z,$i,this._curMat)},$M.clip=function(){},$M.drawPoly=function($I,$M,$E,$Z,$i,$n,$c){void 0===$c&&($c=!1),this._renderKey=0,this._shader2D.glTexture=null;var $f=this._getPath();if(-1==this.mId)$f.polygon($I,$M,$E,$Z,$i||1,$n);else if(this.mHaveKey){var $d=$C.getInstance().shapeDic[this.mId];$d.setMatrix(this._curMat),$d.rebuild($f.tempArray),$f.setGeomtry($d)}else{var $H=$f.polygon($I,$M,$E,$Z,$i||1,$n);$C.getInstance().addShape(this.mId,$H),$H.setMatrix(this._curMat)}$f.update();var $B,$A=[this.mX,this.mY];if(($B=$nI.createShape(this,$f.ib,$f.vb,$f.count,$f.offset,$mI.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$B.shaderValue.u_pos=$A,$B.shaderValue.u_mmat2=$yI.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$B,0<$i){if(this.mHaveLineKey){var $Q=$C.getInstance().shapeLineDic[this.mId];$Q.rebuild($f.tempArray),$f.setGeomtry($Q)}else $C.getInstance().addShape(this.mId,$f.drawLine($I,$M,$E,$i,$n));$f.update(),($B=$nI.createShape(this,$f.ib,$f.vb,$f.count,$f.offset,$mI.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,$B.shaderValue.u_mmat2=$yI.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=$B}},$M.drawParticle=function($I,$M,$E){$E.x=$I,$E.y=$M,this._submits[this._submits._length++]=$E},$M._getPath=function(){return this._path||(this._path=new $_)},$Z(0,$M,"globalCompositeOperation",function(){return $F.NAMES[this._nBlendType]},function($I){var $M=$F.TOINT[$I];null==$M||this._nBlendType===$M||($h.save(this,65536,this,!0),this._curSubmit=$nI.RENDERBASE,this._renderKey=0,this._nBlendType=$M)}),$Z(0,$M,"strokeStyle",function(){return this._shader2D.strokeStyle},function($I){this._shader2D.strokeStyle.equal($I)||($h.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=$e.create($I))}),$Z(0,$M,"globalAlpha",function(){return this._shader2D.ALPHA},function($I){($I=Math.floor(1e3*$I)/1e3)!=this._shader2D.ALPHA&&($h.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=$I)}),$Z(0,$M,"asBitmap",null,function($I){if($I){if(this._targets||(this._targets=new $s),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),$Z(0,$M,"fillStyle",function(){return this._shader2D.fillStyle},function($I){this._shader2D.fillStyle.equal($I)||($h.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=$e.create($I))}),$Z(0,$M,"textAlign",function(){return this._other.textAlign},function($I){this._other.textAlign===$I||(this._other=this._other.make(),$h.save(this,32768,this._other,!1),this._other.textAlign=$I)}),$Z(0,$M,"lineWidth",function(){return this._other.lineWidth},function($I){this._other.lineWidth===$I||(this._other=this._other.make(),$h.save(this,256,this._other,!1),this._other.lineWidth=$I)}),$Z(0,$M,"textBaseline",function(){return this._other.textBaseline},function($I){this._other.textBaseline===$I||(this._other=this._other.make(),$h.save(this,16384,this._other,!1),this._other.textBaseline=$I)}),$Z(0,$M,"font",null,function($I){$I!=this._other.font.toString()&&(this._other=this._other.make(),$h.save(this,8,this._other,!1),this._other.font===$tI.EMPTY?this._other.font=new $tI($I):this._other.font.setFont($I))}),$k.__init__=function(){$E.DEFAULT=new $E},$k._tempPoint=new $T,$k._SUBMITVBSIZE=32e3,$k._MAXSIZE=99999999,$k._RECTVBSIZE=16,$k.MAXCLIPRECT=new $q(0,0,99999999,99999999),$k._COUNT=0,$k._tmpMatrix=new $j,$k.SEGNUM=32,$k._contextcount=0,$c($k,["_fontTemp",function(){return this._fontTemp=new $tI},"_drawStyleTemp",function(){return this._drawStyleTemp=new $e(null)}]),$k.__init$=function(){$E=function(){function $I(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=$tI.EMPTY}$Q($I,"");var $M=$I.prototype;return $M.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=$tI.EMPTY},$M.make=function(){return this===$I.DEFAULT?new $I:this},$I.DEFAULT=null,$I}()},$k}(),$mI=function($I){function $Z($I,$M){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,$Z.__super.call(this),this.defines=new $vI,this.position=$Z._POSITION,this.mainID=$I,this.subID=$M,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=$I|$M,this._inClassCache=$Z._cache[this._cacheID],0<$I&&!this._inClassCache&&(this._inClassCache=$Z._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}$Q($Z,"laya.webgl.shader.d2.value.Value2D",$x);var $M=$Z.prototype;return $M.setValue=function($I){},$M.refresh=function(){var $I=this.size;return $I[0]=$yI.width,$I[1]=$yI.height,this.alpha=this.ALPHA*$yI.worldAlpha,this.mmat=$yI.worldMatrix4,this},$M._ShaderWithCompile=function(){return $GI.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,$sI.create)},$M._withWorldShaderDefines=function(){var $I=$yI.worldShaderDefines,$M=$GI.sharders[this.mainID|this.defines._value|$I.getValue()];if(!$M){var $E,$Z={};for($E in this.defines.toNameDic())$Z[$E]="";for($E in $I.toNameDic())$Z[$E]="";$M=$GI.withCompile2D(0,this.mainID,$Z,this.mainID|this.defines._value|$I.getValue(),$sI.create)}var $i=$yI.worldFilters;if(!$i)return $M;for(var $n,$c=$i.length,$f=0;$f<$c;$f++)($n=$i[$f])&&$n.action.setValue(this);return $M},$M.upload=function(){var $I=$yI;this.alpha=this.ALPHA*$I.worldAlpha,$yI.worldMatrix4!==$yI.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),$wI.shaderHighPrecision&&this.defines.add(1024);var $M,$E=$I.worldShaderDefines?this._withWorldShaderDefines():$GI.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=$I.width,this.size[1]=$I.height,this.mmat=$I.worldMatrix4,$XI.activeShader!==$E?$E._shaderValueWidth!==$I.width||$E._shaderValueHeight!==$I.height?($E._shaderValueWidth=$I.width,$E._shaderValueHeight=$I.height):$M=$E._params2dQuick2||$E._make2dQuick2():$E._shaderValueWidth!==$I.width||$E._shaderValueHeight!==$I.height?($E._shaderValueWidth=$I.width,$E._shaderValueHeight=$I.height):$M=$E._params2dQuick1||$E._make2dQuick1(),$E.upload(this,$M)},$M.setFilters=function($I){if(this.filters=$I)for(var $M,$E=$I.length,$Z=0;$Z<$E;$Z++)($M=$I[$Z])&&(this.defines.add($M.type),$M.action.setValue(this))},$M.clear=function(){this.defines.setValue(this.subID)},$M.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},$Z._initone=function($I,$M){$Z._typeClass[$I]=$M,$Z._cache[$I]=[],$Z._cache[$I]._length=0},$Z.__init__=function(){$Z._POSITION=[2,5126,!1,4*$VI.BYTES_PE,0],$Z._TEXCOORD=[2,5126,!1,4*$VI.BYTES_PE,2*$VI.BYTES_PE],$Z._initone(2,$kI),$Z._initone(4,$FI),$Z._initone(256,$rI),$Z._initone(512,$xI),$Z._initone(1,$lI),$Z._initone(65,$KI),$Z._initone(9,$lI)},$Z.create=function($I,$M){var $E=$Z._cache[$I|$M];return $E._length?$E[--$E._length]:new $Z._typeClass[$I|$M]($M)},$Z._POSITION=null,$Z._TEXCOORD=null,$Z._cache=[],$Z._typeClass=[],$Z.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],$Z}(),$jI=function($I){function $u($I,$M){$u.__super.call(this,$I,$M)}$Q($u,"laya.webgl.utils.RenderSprite3D",$y);var $M=$u.prototype;return $M.onCreate=function($I){switch($I){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},$M._mask=function($I,$M,$E,$Z){var $i,$n,$c=this._next,$f=$I.mask;if($f){$M.ctx.save();var $d=$M.ctx.globalCompositeOperation,$H=new $q;if($H.copyFrom($f.getBounds()),$H.width=Math.round($H.width),$H.height=Math.round($H.height),$H.x=Math.round($H.x),$H.y=Math.round($H.y),0<$H.width&&0<$H.height){var $B=$I._style._tf,$A=$fI.create();$A.addValue("bounds",$H),$i=$cI.create([$A,$M],laya.webgl.utils.RenderSprite3D.tmpTarget),$M.addRenderObject($i),$f.render($M,-$H.x,-$H.y),$i=$cI.create([$A],laya.webgl.utils.RenderSprite3D.endTmpTarget),$M.addRenderObject($i),$M.ctx.save(),$M.clipRect($E-$B.translateX+$H.x,$Z-$B.translateY+$H.y,$H.width,$H.height),$c._fun.call($c,$I,$M,$E,$Z),$M.ctx.restore(),$n=$BI.create(6),$d=$M.ctx.globalCompositeOperation,$n.blendMode="mask",$M.addRenderObject($n),$j.TEMP.identity();var $Q=$mI.create(1,0),$p=$S.INV_UV,$t=$H.width,$V=$H.height;($H.width<32||$H.height<32)&&(($p=$u.tempUV)[0]=0,$p[1]=0,$p[2]=32<=$H.width?1:$H.width/32,$p[3]=0,$p[4]=32<=$H.width?1:$H.width/32,$p[5]=32<=$H.height?1:$H.height/32,$p[6]=0,$p[7]=32<=$H.height?1:$H.height/32,$H.width=32<=$H.width?$H.width:32,$H.height=32<=$H.height?$H.height:32,$p[1]*=-1,$p[3]*=-1,$p[5]*=-1,$p[7]*=-1,$p[1]+=1,$p[3]+=1,$p[5]+=1,$p[7]+=1),$M.ctx.drawTarget($A,$E+$H.x-$B.translateX,$Z+$H.y-$B.translateY,$t,$V,$j.TEMP,"tmpTarget",$Q,$p,6),$i=$cI.create([$A],laya.webgl.utils.RenderSprite3D.recycleTarget),$M.addRenderObject($i),($n=$BI.create(6)).blendMode=$d,$M.addRenderObject($n)}$M.ctx.restore()}else $c._fun.call($c,$I,$M,$E,$Z)},$M._blend=function($I,$M,$E,$Z){var $i=$I._style,$n=this._next;$i.blendMode?($M.ctx.save(),$M.ctx.globalCompositeOperation=$i.blendMode,$n._fun.call($n,$I,$M,$E,$Z),$M.ctx.restore()):$n._fun.call($n,$I,$M,$E,$Z)},$M._transform=function($I,$M,$E,$Z){var $i=$I.transform,$n=this._next;if($i&&$n!=$y.NORENDER){var $c=$M.ctx;$I._style;$i.tx=$E,$i.ty=$Z;var $f=$c._getTransformMatrix(),$d=$f.clone();$j.mul($i,$f,$f),$f._checkTransform(),$i.tx=$i.ty=0,$n._fun.call($n,$I,$M,0,0),$d.copyTo($f),$d.destroy()}else $n._fun.call($n,$I,$M,$E,$Z)},$u.tmpTarget=function($I,$M){var $E=$I.getValue("bounds"),$Z=$CI.create($E.width,$E.height);$Z.start(),$Z.clear(0,0,0,0),$I.addValue("tmpTarget",$Z)},$u.endTmpTarget=function($I){$I.getValue("tmpTarget").end()},$u.recycleTarget=function($I){$I.getValue("tmpTarget").recycle(),$I.recycle()},$c($u,["tempUV",function(){return this.tempUV=new Array(8)}]),$u}(),$TI=function($I){function $M(){this.data=null,$M.__super.call(this)}$Q($M,"laya.filters.webgl.ColorFilterActionGL",$J);var $E=$M.prototype;return $O.imps($E,{"laya.filters.IFilterActionGL":!0}),$E.setValue=function($I){$I.colorMat=this.data._mat,$I.colorAlpha=this.data._alpha},$E.apply3d=function($I,$M,$E,$Z,$i){var $n=$I.getValue("bounds"),$c=$mI.create(1,0);$c.setFilters([this.data]);var $f=$j.TEMP;$f.identity(),$E.ctx.drawTarget($I,0,0,$n.width,$n.height,$f,"src",$c)},$M}(),$qI=function($I){function $n($I,$M,$E,$Z,$i){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,$n.__super.call(this,$I,$M,$i),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new $eI,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=$E,this._atlasCanvas.height=$Z,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}$Q($n,"laya.webgl.atlas.Atlaser",$k);var $M=$n.prototype;return $M.computeUVinAtlasTexture=function($I,$M,$E,$Z){var $i=$r.atlasTextureWidth,$n=$r.atlasTextureHeight,$c=$E/$i,$f=$Z/$n,$d=($E+$I.bitmap.width)/$i,$H=($Z+$I.bitmap.height)/$n,$B=$I.bitmap.width/$i,$A=$I.bitmap.height/$n;$I.uv=[$c+$M[0]*$B,$f+$M[1]*$A,$d-(1-$M[2])*$B,$f+$M[3]*$A,$d-(1-$M[4])*$B,$H-(1-$M[5])*$A,$c+$M[6]*$B,$H-(1-$M[7])*$A]},$M.findBitmapIsExist=function($I){if($I instanceof laya.webgl.resource.WebGLImage){var $M=$I,$E=$M.url,$Z=this._InAtlasWebGLImagesKey[$E||$M.id];if($Z)return $Z.offsetInfoID}return-1},$M.addToAtlasTexture=function($I,$M,$E){if($I instanceof laya.webgl.resource.WebGLImage){var $Z=$I,$i=$Z.url;this._InAtlasWebGLImagesKey[$i||$Z.id]={bitmap:$I,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([$M,$E])}this._atlasCanvas.texSubImage2D($M,$E,$I.atlasSource),$I.clearAtlasSource()},$M.addToAtlas=function($I,$M,$E){$I._atlasID=this._inAtlasTextureKey.length;var $Z=$I.uv.slice(),$i=$I.bitmap;this._inAtlasTextureKey.push($I),this._inAtlasTextureOriUVValue.push($Z),this._inAtlasTextureBitmapValue.push($i),this.computeUVinAtlasTexture($I,$Z,$M,$E),$I.bitmap=this._atlasCanvas},$M.clear=function(){for(var $I=0,$M=this._inAtlasTextureKey.length;$I<$M;$I++)this._inAtlasTextureKey[$I].bitmap=this._inAtlasTextureBitmapValue[$I],this._inAtlasTextureKey[$I].uv=this._inAtlasTextureOriUVValue[$I],this._inAtlasTextureKey[$I]._atlasID=-1,this._inAtlasTextureKey[$I].bitmap.lock=!1,this._inAtlasTextureKey[$I].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},$M.dispose=function(){this.clear(),this._atlasCanvas.destroy()},$Z(0,$M,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),$Z(0,$M,"texture",function(){return this._atlasCanvas}),$Z(0,$M,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),$n}(),$vI=function($I){function $E(){$E.__super.call(this,$E.__name2int,$E.__int2name,$E.__int2nameMap)}return $Q($E,"laya.webgl.shader.d2.ShaderDefines2D",$U),$E.__init__=function(){$E.reg("TEXTURE2D",1),$E.reg("COLOR2D",2),$E.reg("PRIMITIVE",4),$E.reg("GLOW_FILTER",8),$E.reg("BLUR_FILTER",16),$E.reg("COLOR_FILTER",32),$E.reg("COLOR_ADD",64),$E.reg("WORLDMAT",128),$E.reg("FILLTEXTURE",256),$E.reg("FSHIGHPRECISION",1024),$E.reg("TXTALPHA",2048),$E.reg("TXTCOMPRESS",4096)},$E.reg=function($I,$M){$U._reg($I,$M,$E.__name2int,$E.__int2name)},$E.toText=function($I,$M,$E){return $U._toText($I,$M,$E)},$E.toInt=function($I){return $U._toInt($I,$E.__name2int)},$E.TEXTURE2D=1,$E.COLOR2D=2,$E.PRIMITIVE=4,$E.FILTERGLOW=8,$E.FILTERBLUR=16,$E.FILTERCOLOR=32,$E.COLORADD=64,$E.WORLDMAT=128,$E.FILLTEXTURE=256,$E.SKINMESH=512,$E.SHADERDEFINE_FSHIGHPRECISION=1024,$E.TXTALPHA=2048,$E.TXTCOMPRESS=4096,$E.__name2int={},$E.__int2name=[],$E.__int2nameMap=[],$E}(),$WI=(function($I){function $f($I,$M,$E,$Z,$i,$n,$c){$f.__super.call(this,$I,$M,$E,$Z,40,$i,$n,$c)}$Q($f,"laya.webgl.shapes.Ellipse",$EI)}(),function($I){function $n($I,$M,$E,$Z,$i){this._points=[],this.rebuild($E),$n.__super.call(this,$I,$M,0,0,0,$i,$Z,$i,0)}$Q($n,"laya.webgl.shapes.Line",$EI);var $M=$n.prototype;return $M.rebuild=function($I){var $M=$I.length;$M!=this._points.length&&(this.mUint16Array=new Uint16Array(6*($M/2-1)),this.mFloat32Array=new Float32Array(5*$M)),this._points.length=0;for(var $E=NaN,$Z=NaN,$i=-1,$n=-1,$c=$I.length/2,$f=0;$f<$c;$f++)$E=$I[2*$f],$Z=$I[2*$f+1],(.01<Math.abs($i-$E)||.01<Math.abs($n-$Z))&&this._points.push($E,$Z),$i=$E,$n=$Z},$M.getData=function($I,$M,$E){var $Z=[],$i=[];0<this.borderWidth&&this.createLine2(this._points,$Z,this.borderWidth,$E,$i,this._points.length/2),this.mUint16Array.set($Z,0),this.mFloat32Array.set($i,0),$I.append(this.mUint16Array),$M.append(this.mFloat32Array)},$n}()),$RI=function($I){function $A($I,$M,$E,$Z,$i){this._points=[];for(var $n=NaN,$c=NaN,$f=-1,$d=-1,$H=$E.length/2-1,$B=0;$B<$H;$B++)$n=$E[2*$B],$c=$E[2*$B+1],(.01<Math.abs($f-$n)||.01<Math.abs($d-$c))&&this._points.push($n,$c),$f=$n,$d=$c;$n=$E[2*$H],$c=$E[2*$H+1],$f=this._points[0],$d=this._points[1],(.01<Math.abs($f-$n)||.01<Math.abs($d-$c))&&this._points.push($n,$c),$A.__super.call(this,$I,$M,0,0,this._points.length/2,0,$Z,$i)}$Q($A,"laya.webgl.shapes.LoopLine",$EI);var $M=$A.prototype;return $M.getData=function($I,$M,$E){if(0<this.borderWidth){for(var $Z=this.color,$i=($Z>>16&255)/255,$n=($Z>>8&255)/255,$c=(255&$Z)/255,$f=[],$d=0,$H=0,$B=[],$A=Math.floor(this._points.length/2),$Q=0;$Q<$A;$Q++)$d=this._points[2*$Q],$H=this._points[2*$Q+1],$f.push(this.x+$d,this.y+$H,$i,$n,$c);this.createLoopLine($f,$B,this.borderWidth,$E+$f.length/5),$I.append(new Uint16Array($B)),$M.append(new Float32Array($f))}},$M.createLoopLine=function($I,$M,$E,$Z,$i,$n){$I.length;var $c=$I.concat(),$f=$i||$I,$d=this.borderColor,$H=($d>>16&255)/255,$B=($d>>8&255)/255,$A=(255&$d)/255,$Q=[$c[0],$c[1]],$p=[$c[$c.length-5],$c[$c.length-4]],$t=$p[0]+.5*($Q[0]-$p[0]),$V=$p[1]+.5*($Q[1]-$p[1]);$c.unshift($t,$V,0,0,0),$c.push($t,$V,0,0,0);var $u,$N,$y,$$,$w,$g,$O,$a,$m,$j,$T,$q,$v,$W,$R,$z,$L,$o,$S,$X,$C=$c.length/5,$J=$Z,$x=$E/2;$y=$c[0],$$=$c[1],$j=$y-($w=$c[5]),$m=($m=-($$-($g=$c[6])))/($X=Math.sqrt($m*$m+$j*$j))*$x,$j=$j/$X*$x,$f.push($y-$m,$$-$j,$H,$B,$A,$y+$m,$$+$j,$H,$B,$A);for(var $k=1;$k<$C-1;$k++)$y=$c[5*($k-1)],$$=$c[5*($k-1)+1],$w=$c[5*$k],$g=$c[5*$k+1],$O=$c[5*($k+1)],$a=$c[5*($k+1)+1],$j=$y-$w,$q=$w-$O,$R=(-($m=($m=-($$-$g))/($X=Math.sqrt($m*$m+$j*$j))*$x)+$y)*(-($j=$j/$X*$x)+$g)-(-$m+$w)*(-$j+$$),$o=(-($T=($T=-($g-$a))/($X=Math.sqrt($T*$T+$q*$q))*$x)+$O)*(-($q=$q/$X*$x)+$g)-(-$T+$w)*(-$q+$a),$S=($v=-$j+$$-(-$j+$g))*($L=-$T+$w-(-$T+$O))-($z=-$q+$a-(-$q+$g))*($W=-$m+$w-(-$m+$y)),Math.abs($S)<.1?($S+=10.1,$f.push($w-$m,$g-$j,$H,$B,$A,$w+$m,$g+$j,$H,$B,$A)):((($u=($W*$o-$L*$R)/$S)-$w)*($u-$w)+(($N=($z*$R-$v*$o)/$S)-$g)+($N-$g),$f.push($u,$N,$H,$B,$A,$w-($u-$w),$g-($N-$g),$H,$B,$A));$n&&($M=$n);var $r=this.edges+1;for($k=1;$k<$r;$k++)$M.push($J+2*($k-1),$J+2*($k-1)+1,$J+2*$k+1,$J+2*$k+1,$J+2*$k,$J+2*($k-1));return $M.push($J+2*($k-1),$J+2*($k-1)+1,$J+1,$J+1,$J,$J+2*($k-1)),$f},$A}(),$zI=function($I){function $c($I,$M,$E,$Z,$i,$n){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=$j.create(),this._points=$E.slice(0,$E.length),$c.__super.call(this,$I,$M,0,0,this._points.length/2,$Z,$i,$n)}$Q($c,"laya.webgl.shapes.Polygon",$EI);var $M=$c.prototype;return $M.rebuild=function($I){this._repaint||(this._points.length=0,this._points=this._points.concat($I))},$M.setMatrix=function($I){$I.copyTo(this._mat)},$M.needUpdate=function($I){return this._repaint=this._mat.a==$I.a&&this._mat.b==$I.b&&this._mat.c==$I.c&&this._mat.d==$I.d&&this._mat.tx==$I.tx&&this._mat.ty==$I.ty,!this._repaint},$M.getData=function($I,$M,$E){var $Z,$i=0,$n=this._points,$c=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=$E){for(this._start=$E,$Z=[],$c=this.earcutTriangles.length,$i=0;$i<$c;$i++)$Z.push(this.earcutTriangles[$i]+$E);this.mUint16Array=new Uint16Array($Z)}}else{this._start=$E,$Z=[];var $f=[],$d=[],$H=this.color,$B=($H>>16&255)/255,$A=($H>>8&255)/255,$Q=(255&$H)/255;for($c=Math.floor($n.length/2),$i=0;$i<$c;$i++)$f.push(this.x+$n[2*$i],this.y+$n[2*$i+1],$B,$A,$Q),$d.push(this.x+$n[2*$i],this.y+$n[2*$i+1]);for(this.earcutTriangles=$ZI.earcut($d,null,2),$c=this.earcutTriangles.length,$i=0;$i<$c;$i++)$Z.push(this.earcutTriangles[$i]+$E);this.mUint16Array=new Uint16Array($Z),this.mFloat32Array=new Float32Array($f)}$I.append(this.mUint16Array),$M.append(this.mFloat32Array)},$c}(),$LI=function($I){function $n(){this._matrix=new $j,this._matrix4=$VI.defaultMatrix4.concat(),$n.__super.call(this,1e4),this.shaderValue=new $mI(0,0)}$Q($n,"laya.webgl.submit.SubmitCanvas",$nI);var $M=$n.prototype;return $M.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var $I=$yI.worldAlpha,$M=$yI.worldMatrix4,$E=$yI.worldMatrix,$Z=$yI.worldFilters,$i=$yI.worldShaderDefines,$n=this.shaderValue,$c=this._matrix,$f=this._matrix4,$d=$j.TEMP;return $j.mul($c,$E,$d),$f[0]=$d.a,$f[1]=$d.b,$f[4]=$d.c,$f[5]=$d.d,$f[12]=$d.tx,$f[13]=$d.ty,$yI.worldMatrix=$d.clone(),$yI.worldMatrix4=$f,$yI.worldAlpha=$yI.worldAlpha*$n.alpha,$n.filters&&$n.filters.length&&($yI.worldFilters=$n.filters,$yI.worldShaderDefines=$n.defines),this._ctx_src.flush(),$yI.worldAlpha=$I,$yI.worldMatrix4=$M,$yI.worldMatrix.destroy(),$yI.worldMatrix=$E,$yI.worldFilters=$Z,$yI.worldShaderDefines=$i,1},$M.releaseRender=function(){var $I=$n._cache;this._ctx_src=null,$I[$I._length++]=this},$M.getRenderType=function(){return 10003},$n.create=function($I,$M,$E){var $Z=$n._cache._length?$n._cache[--$n._cache._length]:new $n;$Z._ctx_src=$I;var $i=$Z.shaderValue;return $i.alpha=$M,$i.defines.setValue(0),$E&&$E.length&&$i.setFilters($E),$Z},$n._cache=(($n._cache=[])._length=0,$n._cache),$n}(),$oI=function($I){function $H($I){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===$I&&($I=1e4),$H.__super.call(this,$I)}$Q($H,"laya.webgl.submit.SubmitTexture",$nI);var $M=$H.prototype;return $M.releaseRender=function(){var $I=$H._cache;($I[$I._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},$M.addTexture=function($I,$M){this._texsID[this._texs.length]=$I._uvID,this._texs.push($I),this._vbPos.push($M)},$M.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var $I=this.shaderValue.textureHost.bitmap;if(null!==$I)for(var $M=this._vb.getFloat32Array(),$E=0,$Z=this._texs.length;$E<$Z;$E++){var $i=this._texs[$E];$i.active();var $n=$i.uv;if(this._texsID[$E]!==$i._uvID){this._texsID[$E]=$i._uvID;var $c=this._vbPos[$E];$M[$c+2]=$n[0],$M[$c+3]=$n[1],$M[$c+6]=$n[2],$M[$c+7]=$n[3],$M[$c+10]=$n[4],$M[$c+11]=$n[5],$M[$c+14]=$n[6],$M[$c+15]=$n[7],this._vb.setNeedUpload()}$i.bitmap!==$I&&(this._isSameTexture=!1)}}},$M.renderSubmit=function(){if(0===this._numEle)return $H._shaderSet=!1,1;var $I=this.shaderValue.textureHost;if($I){var $M=$I.source;if(!$I.bitmap||!$M)return $H._shaderSet=!1,1;this.shaderValue.texture=$M,$I.alphaTexture&&$I.alphaTexture.source&&(this.shaderValue.texture1=$I.alphaTexture.source)}this._vb.bind_upload(this._ib);var $E=$wI.mainContext;if($F.activeBlendFunction!==this._blendFn&&($E.enable(3042),this._blendFn($E),$F.activeBlendFunction=this._blendFn),$R.drawCall++,$R.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&$XI.activeShader&&$H._shaderSet?($XI.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&$XI.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),$H._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var $Z=$I.bitmap,$i=0,$n=$XI.activeShader,$c=0,$f=this._texs.length;$c<$f;$c++){var $d=this._texs[$c];$d.bitmap===$Z&&$c+1!==$f||($n.uploadTexture2D($d.source),$E.drawElements(4,6*($c-$i+1),5123,this._startIdx+6*$i*$VI.BYTES_PIDX),$Z=$d.bitmap,$i=$c)}else $E.drawElements(4,this._numEle,5123,this._startIdx);return 1},$H.create=function($I,$M,$E,$Z,$i){var $n=$H._cache._length?$H._cache[--$H._cache._length]:new $H;null==$E&&(($E=$n._selfVb||($n._selfVb=$UI.create(-1))).clear(),$Z=0),$n._ib=$M,$n._vb=$E,$n._startIdx=$Z*$VI.BYTES_PIDX,$n._numEle=0;var $c=$I._nBlendType;$n._blendFn=$I._targets?$F.targetFns[$c]:$F.fns[$c],$n.shaderValue=$i,$n.shaderValue.setValue($I._shader2D);var $f=$I._shader2D.filters;return $f&&$n.shaderValue.setFilters($f),$n},$H._cache=(($H._cache=[])._length=0,$H._cache),$H._shaderSet=!0,$H}(),$SI=function($I){function $N(){$N.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}$Q($N,"laya.webgl.utils.MeshTexture",$NI);var $M=$N.prototype;return $M.addData=function($I,$M,$E,$Z,$i,$n){for(var $c=$I.length/2,$f=this._vb.needSize($c*$N.const_stride)>>2,$d=this._vb.getFloat32Array(),$H=0,$B=0;$B<$c;$B++){var $A=$I[$H],$Q=$I[$H+1],$p=$A*$Z.a+$Q*$Z.c+$Z.tx,$t=$A*$Z.b+$Q*$Z.d+$Z.ty;$d[$f++]=$p,$d[$f++]=$t,$d[$f++]=$M[$H],$d[$f++]=$M[$H+1],$H+=2}this._vb.setNeedUpload();var $V=this.vertNum;if(0<$V){($c=$E.length)>$N.tmpIdx.length&&($N.tmpIdx=new Uint16Array($c));for(var $u=0;$u<$c;$u++)$N.tmpIdx[$u]=$E[$u]+$V;this._ib.appendU16Array($N.tmpIdx,$E.length)}else this._ib.append($E);this._ib.setNeedUpload(),this.vertNum+=$c,this.indexNum+=$E.length},$M.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},$M.destroy=function(){this._ib.destroy(),this._vb.destroy()},$N.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new $N},$N.const_stride=16,$N._POOL=[],$c($N,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),$N}(),$XI=function($I){function $M(){$M.__super.call(this),this.lock=!0}return $Q($M,"laya.webgl.shader.BaseShader",$$),$M.activeShader=null,$M.bindShader=null,$M}(),$CI=function($M){function $B($I,$M,$E,$Z,$i,$n,$c,$f,$d){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===$E&&($E=6408),void 0===$Z&&($Z=5121),void 0===$i&&($i=34041),void 0===$n&&($n=!1),void 0===$c&&($c=!1),void 0===$f&&($f=-1),void 0===$d&&($d=-1),this._type=1,this._w=$I,this._h=$M,this._surfaceFormat=$E,this._surfaceType=$Z,this._depthStencilFormat=$i,$N.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=$n,this._repeat=$c,this._minFifter=$f,this._magFifter=$d,this._createWebGLRenderTarget(),this.bitmap.lock=!0,$B.__super.call(this,this.bitmap,$S.INV_UV)}$Q($B,"laya.webgl.resource.RenderTarget2D",$M);var $I=$B.prototype;return $O.imps($I,{"laya.resource.IDispose":!0}),$I.getType=function(){return this._type},$I.getTexture=function(){return this},$I.size=function($I,$M){this._w==$I&&this._h==$M||(this._w=$I,this._h=$M,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},$I.release=function(){this.destroy()},$I.recycle=function(){$B.POOL.push(this)},$I.start=function(){var $I=$wI.mainContext;return this._preRenderTarget=$yI.curRenderTarget,$yI.curRenderTarget=this,$I.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&($I.viewport(0,0,this._w,this._h),this._svWidth=$yI.width,this._svHeight=$yI.height,$yI.width=this._w,$yI.height=this._h,$XI.activeShader=null),this},$I.clear=function($I,$M,$E,$Z){void 0===$I&&($I=0),void 0===$M&&($M=0),void 0===$E&&($E=0),void 0===$Z&&($Z=1);var $i=$wI.mainContext;$i.clearColor($I,$M,$E,$Z);var $n=16384;switch(this._depthStencilFormat){case 33189:$n|=256;break;case 36168:$n|=1024;break;case 34041:$n|=256,$n|=1024}$i.clear($n)},$I.end=function(){var $I=$wI.mainContext;$I.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,$yI.curRenderTarget=this._preRenderTarget,1==this._type?($I.viewport(0,0,this._svWidth,this._svHeight),$yI.width=this._svWidth,$yI.height=this._svHeight,$XI.activeShader=null):$I.viewport(0,0,$O.stage.width,$O.stage.height)},$I.getData=function($I,$M,$E,$Z){var $i=$wI.mainContext;if($i.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===$i.checkFramebufferStatus(36160)))return $i.bindFramebuffer(36160,null),null;var $n=new Uint8Array(this._w*this._h*4);return $i.readPixels($I,$M,$E,$Z,this._surfaceFormat,this._surfaceType,$n),$i.bindFramebuffer(36160,null),$n},$I.destroy=function($I){void 0===$I&&($I=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,$M.prototype.destroy.call(this))},$I.dispose=function(){},$I._createWebGLRenderTarget=function(){this.bitmap=new $PI(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function($I){this.event("recovered")})},$Z(0,$I,"surfaceFormat",function(){return this._surfaceFormat}),$Z(0,$I,"magFifter",function(){return this._magFifter}),$Z(0,$I,"surfaceType",function(){return this._surfaceType}),$Z(0,$I,"mipMap",function(){return this._mipMap}),$Z(0,$I,"depthStencilFormat",function(){return this._depthStencilFormat}),$Z(0,$I,"minFifter",function(){return this._minFifter}),$Z(0,$I,"source",function(){return this._alreadyResolved?$O.superGet($S,this,"source"):null}),$B.create=function($I,$M,$E,$Z,$i,$n,$c,$f,$d){void 0===$E&&($E=6408),void 0===$Z&&($Z=5121),void 0===$i&&($i=34041),void 0===$n&&($n=!1),void 0===$c&&($c=!1),void 0===$f&&($f=-1),void 0===$d&&($d=-1);var $H=$B.POOL.pop();return $H||($H=new $B($I,$M)),$H.bitmap&&$H._w==$I&&$H._h==$M&&$H._surfaceFormat==$E&&$H._surfaceType==$Z&&$H._depthStencilFormat==$i&&$H._mipMap==$n&&$H._repeat==$c&&$H._minFifter==$f&&$H._magFifter==$d||($H._w=$I,$H._h=$M,$H._surfaceFormat=$E,$H._surfaceType=$Z,$H._depthStencilFormat=$i,$N.isConchWebGL&&34041===$H._depthStencilFormat&&($H._depthStencilFormat=33189),$H._mipMap=$n,$H._repeat=$c,$H._minFifter=$f,$H._magFifter=$d,$H.release(),$H._createWebGLRenderTarget()),$H},$B.TYPE2D=1,$B.TYPE3D=2,$B.POOL=[],$B}($S),$JI=function($I){function $M(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,$M.__super.call(this),$M._gl=$wI.mainContext}$Q($M,"laya.webgl.utils.Buffer",$$);var $E=$M.prototype;return $E._bind=function(){this.activeResource(),$M._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&($M._bindVertexBuffer=this._glBuffer),$M._gl.bindBuffer(this._bufferType,$M._bindActive[this._bufferType]=this._glBuffer),$XI.activeShader=null)},$E.recreateResource=function(){this._glBuffer||(this._glBuffer=$M._gl.createBuffer()),this.completeCreate()},$E.disposeResource=function(){this._glBuffer&&($wI.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},$Z(0,$E,"bufferUsage",function(){return this._bufferUsage}),$M._gl=null,$M._bindActive={},$M._bindVertexBuffer=null,$M._enableAtributes=[],$M}(),$xI=function($I){function $E($I){this.texcoord=null,this.offsetX=300,this.offsetY=0,$E.__super.call(this,512,0);var $M=8*$VI.BYTES_PE;this.position=[2,5126,!1,$M,0],this.texcoord=[2,5126,!1,$M,2*$VI.BYTES_PE],this.color=[4,5126,!1,$M,4*$VI.BYTES_PE]}return $Q($E,"laya.webgl.shader.d2.skinAnishader.SkinSV",$mI),$E}(),$kI=function($I){function $M($I){$M.__super.call(this,2,0),this.color=[]}return $Q($M,"laya.webgl.shader.d2.value.Color2dSV",$mI),$M.prototype.setValue=function($I){$I.fillStyle&&(this.color=$I.fillStyle._color._color),$I.strokeStyle&&(this.color=$I.strokeStyle._color._color)},$M}(),$rI=function($I){function $M($I){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=$mI._TEXCOORD,$M.__super.call(this,256,0)}$Q($M,"laya.webgl.shader.d2.value.FillTextureSV",$mI);var $E=$M.prototype;return $E.setValue=function($I){this.ALPHA=$I.ALPHA,$I.filters&&this.setFilters($I.filters)},$E.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$M}(),$lI=function($I){function $M($I){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=$mI._TEXCOORD,void 0===$I&&($I=0),$M.__super.call(this,1,$I)}$Q($M,"laya.webgl.shader.d2.value.TextureSV",$mI);var $E=$M.prototype;return $E.setValue=function($I){this.ALPHA=$I.ALPHA,$I.filters&&this.setFilters($I.filters)},$E.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},$M}(),$FI=function($I){function $M($I){this.a_color=null,this.u_pos=[0,0],$M.__super.call(this,4,0),this.position=[2,5126,!1,5*$VI.BYTES_PE,0],this.a_color=[3,5126,!1,5*$VI.BYTES_PE,2*$VI.BYTES_PE]}return $Q($M,"laya.webgl.shader.d2.value.PrimitiveSV",$mI),$M}(),$eI=function($I){function $M(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,$M.__super.call(this)}$Q($M,"laya.webgl.atlas.AtlasWebGLCanvas",$I);var $E=$M.prototype;return $E.recreateResource=function(){var $I=$wI.mainContext,$M=this._source=$I.createTexture(),$E=$gI.curBindTexTarget,$Z=$gI.curBindTexValue;$gI.bindTexture($I,3553,$M),$I.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),$I.texParameteri(3553,10241,9729),$I.texParameteri(3553,10240,9729),$I.texParameteri(3553,10242,33071),$I.texParameteri(3553,10243,33071),$E&&$Z&&$gI.bindTexture($I,$E,$Z),this.memorySize=this._w*this._h*4,this.completeCreate()},$E.disposeResource=function(){this._source&&($wI.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$E.texSubImage2D=function($I,$M,$E){if($N.isFlash){this._flashCacheImage||(this._flashCacheImage=$V.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var $Z=$E.bitmapdata;this._flashCacheImage._image.copyPixels($Z,0,0,$Z.width,$Z.height,$I,$M),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var $i=$wI.mainContext,$n=$gI.curBindTexTarget,$c=$gI.curBindTexValue;$gI.bindTexture($i,3553,this._source),$i.pixelStorei(37441,!0),0<=$I-1&&$i.texSubImage2D(3553,0,$I-1,$M,6408,5121,$E),$I+1<=this._w&&$i.texSubImage2D(3553,0,$I+1,$M,6408,5121,$E),0<=$M-1&&$i.texSubImage2D(3553,0,$I,$M-1,6408,5121,$E),$M+1<=this._h&&$i.texSubImage2D(3553,0,$I,$M+1,6408,5121,$E),$i.texSubImage2D(3553,0,$I,$M,6408,5121,$E),$i.pixelStorei(37441,!1),$n&&$c&&$gI.bindTexture($i,$n,$c)}},$E.texSubImage2DPixel=function($I,$M,$E,$Z,$i){var $n=$wI.mainContext,$c=$gI.curBindTexTarget,$f=$gI.curBindTexValue;$gI.bindTexture($n,3553,this._source);var $d=new Uint8Array($i.data);$n.pixelStorei(37441,!0),$n.texSubImage2D(3553,0,$I,$M,$E,$Z,6408,5121,$d),$n.pixelStorei(37441,!1),$c&&$f&&$gI.bindTexture($n,$c,$f)},$Z(0,$E,"width",$I.prototype._$get_width,function($I){this._w=$I}),$Z(0,$E,"height",$I.prototype._$get_height,function($I){this._h=$I}),$M}($E),$_I=function($I){function $i(){this.flipY=!0,this.alwaysChange=!1,$i.__super.call(this)}$Q($i,"laya.webgl.resource.WebGLCanvas",$E);var $M=$i.prototype;return $M.getCanvas=function(){return this._canvas},$M.clear=function(){this._ctx&&this._ctx.clear()},$M.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},$M._setContext=function($I){this._ctx=$I},$M.getContext=function($I,$M){return this._ctx?this._ctx:this._ctx=$i._createContext(this)},$M.size=function($I,$M){this._w==$I&&this._h==$M||(this._w=$I,this._h=$M,this._ctx&&this._ctx.size($I,$M),this._canvas&&(this._canvas.height=$M,this._canvas.width=$I))},$M.activeResource=function($I){void 0===$I&&($I=!1),this._source||this.recreateResource()},$M.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},$M.disposeResource=function(){this._source&&!this.iscpuSource&&($wI.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$M.createWebGlTexture=function(){var $I=$wI.mainContext;this._canvas;var $M=this._source=$I.createTexture();this.iscpuSource=!1;var $E=$gI.curBindTexTarget,$Z=$gI.curBindTexValue;$gI.bindTexture($I,3553,$M),$I.pixelStorei(37440,this.flipY?1:0),$i.premulAlpha&&$I.pixelStorei(37441,!0),$I.texImage2D(3553,0,6408,6408,5121,this._imgData),$i.premulAlpha&&$I.pixelStorei(37441,!1),$I.texParameteri(3553,10240,9729),$I.texParameteri(3553,10241,9729),$I.texParameteri(3553,10242,33071),$I.texParameteri(3553,10243,33071),$I.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,$E&&$Z&&$gI.bindTexture($I,$E,$Z)},$M.reloadCanvasData=function(){var $I=$wI.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var $M=$gI.curBindTexTarget,$E=$gI.curBindTexValue;$gI.bindTexture($I,3553,this._source),$i.premulAlpha&&$I.pixelStorei(37441,!0),$I.texImage2D(3553,0,6408,6408,5121,this._imgData),$i.premulAlpha&&$I.pixelStorei(37441,!1),$I.pixelStorei(37440,0),$M&&$E&&$gI.bindTexture($I,$M,$E)},$M.texSubImage2D=function($I,$M,$E){var $Z=$wI.mainContext,$i=$gI.curBindTexTarget,$n=$gI.curBindTexValue;$gI.bindTexture($Z,3553,this._source),$Z.pixelStorei(37441,!0),$Z.texSubImage2D(3553,0,$M,$E,6408,5121,$I._source),$Z.pixelStorei(37441,!1),$i&&$n&&$gI.bindTexture($Z,$i,$n)},$M.toBase64=function($I,$M,$E){var $Z=null;this._canvas&&($Z=this._canvas.toDataURL($I,$M)),$E.call(this,$Z)},$Z(0,$M,"context",function(){return this._ctx}),$Z(0,$M,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),$Z(0,$M,"asBitmap",null,function($I){this._ctx&&(this._ctx.asBitmap=$I)}),$i._createContext=null,$i.premulAlpha=!1,$i}(),$hI=function($I){function $n($I,$M){this.CborderSize=12,$n.__super.call(this),this.char=$I,this.isSpace=" "===$I,this.xs=$M.scaleX,this.ys=$M.scaleY,this.font=$M.font.toString(),this.fontSize=$M.font.size,this.fillColor=$M.fillColor,this.borderColor=$M.borderColor,this.lineWidth=$M.lineWidth,this.underLine=$M.underLine;var $E,$Z=$N.isConchApp;$Z?(($E=ConchTextCanvas)._source=ConchTextCanvas,$E._source.canvas=ConchTextCanvas):$E=$p.canvas.source,this.canvas=$E,this._enableMerageInAtlas=!0,this._ctx=$Z?$E:this.canvas.getContext("2d",void 0);var $i=$X.measureText(this.char,this.font);this.cw=$i.width*this.xs,this.ch=($i.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new $S(this)}$Q($n,"laya.webgl.resource.WebGLCharImage",$E);var $M=$n.prototype;return $O.imps($M,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$M.active=function(){this.texture.active()},$M.recreateResource=function(){var $I=$N.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),$I){var $M=this.fontSize;1==this.xs&&1==this.ys||($M=parseInt($M*(this.xs>this.ys?this.xs:this.ys)+""));var $E="normal 100 "+this.font;$E=$E.replace($n._fontSizeReg,$M),this.borderColor&&($E+=" 1 "+this.borderColor),this._ctx.font=$E,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,$o.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var $Z=this._ctx.measureText(this.char);$Z||($Z={width:16});var $i=$Z.width+1;this._ctx.lineTo($i,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},$M.onresize=function($I,$M){this._w=$I,this._h=$M,this._allowMerageInAtlas=!0},$M.clearAtlasSource=function(){},$Z(0,$M,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$Z(0,$M,"atlasSource",function(){return this.canvas}),$Z(0,$M,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function($I){this._enableMerageInAtlas=$I}),$n.createOneChar=function($I,$M){return new $n($I,$M)},$n._fontSizeReg=new RegExp("\\d+(?=px)","g"),$n}(),$PI=function($I){function $H($I,$M,$E,$Z,$i,$n,$c,$f,$d){void 0===$E&&($E=6408),void 0===$Z&&($Z=5121),void 0===$i&&($i=34041),void 0===$n&&($n=!1),void 0===$c&&($c=!1),void 0===$f&&($f=-1),void 0===$d&&($d=1),$H.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=$I,this._h=$M,this._surfaceFormat=$E,this._surfaceType=$Z,this._depthStencilFormat=$i,this._mipMap=$n,this._repeat=$c,this._minFifter=$f,this._magFifter=$d}$Q($H,"laya.webgl.resource.WebGLRenderTarget",$E);var $M=$H.prototype;return $M.recreateResource=function(){var $I=$wI.mainContext;this._frameBuffer||(this._frameBuffer=$I.createFramebuffer()),this._source||(this._source=$I.createTexture());var $M=$gI.curBindTexTarget,$E=$gI.curBindTexValue;$gI.bindTexture($I,3553,this._source),$I.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var $Z=this._minFifter,$i=this._magFifter,$n=this._repeat?10497:33071,$c=$B.isPOT(this._w,this._h);if($c?(this._mipMap?-1!==$Z||($Z=9987):-1!==$Z||($Z=9729),-1!==$i||($i=9729),$I.texParameteri(3553,10241,$Z),$I.texParameteri(3553,10240,$i),$I.texParameteri(3553,10242,$n),$I.texParameteri(3553,10243,$n),this._mipMap&&$I.generateMipmap(3553)):(-1!==$Z||($Z=9729),-1!==$i||($i=9729),$I.texParameteri(3553,10241,$Z),$I.texParameteri(3553,10240,$i),$I.texParameteri(3553,10242,33071),$I.texParameteri(3553,10243,33071)),$I.bindFramebuffer(36160,this._frameBuffer),$I.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=$I.createRenderbuffer()),$I.bindRenderbuffer(36161,this._depthStencilBuffer),$I.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:$I.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$I.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$I.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$I.bindFramebuffer(36160,null),$M&&$E&&$gI.bindTexture($I,$M,$E),$I.bindRenderbuffer(36161,null),$c&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},$M.disposeResource=function(){this._frameBuffer&&($wI.mainContext.deleteTexture(this._source),$wI.mainContext.deleteFramebuffer(this._frameBuffer),$wI.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0,this.uri=null)},$Z(0,$M,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$Z(0,$M,"frameBuffer",function(){return this._frameBuffer}),$H}(),$DI=function($I){function $f($I,$M,$E,$Z,$i,$n,$c){this.offsetX=0,this.offsetY=0,$f.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=$n,this.canvas=$I,this._ctx=$I.getContext("2d",void 0),this._w=$Z,this._h=$i,this.offsetX=$M,this.offsetY=$E,this.src=$c,this._enableMerageInAtlas=!0,$r.enabled&&this._w<$r.atlasLimitWidth&&this._h<$r.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}$Q($f,"laya.webgl.resource.WebGLSubImage",$E);var $M=$f.prototype;return $O.imps($M,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$M.size=function($I,$M){this._w=$I,this._h=$M,this._ctx&&this._ctx.size($I,$M),this.canvas&&(this.canvas.height=$M,this.canvas.width=$I)},$M.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},$M.createWebGlTexture=function(){var $I=$wI.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var $M=this._source=$I.createTexture(),$E=$gI.curBindTexTarget,$Z=$gI.curBindTexValue;$gI.bindTexture($I,3553,$M),$I.pixelStorei(37441,!0),$I.texImage2D(3553,0,6408,6408,5121,this.canvas),$I.pixelStorei(37441,!1);var $i=this.minFifter,$n=this.magFifter,$c=this.repeat?10497:33071,$f=$B.isPOT(this.width,this.height);$f?(this.mipmap?-1!==$i||($i=9987):-1!==$i||($i=9729),-1!==$n||($n=9729),$I.texParameteri(3553,10240,$n),$I.texParameteri(3553,10241,$i),$I.texParameteri(3553,10242,$c),$I.texParameteri(3553,10243,$c),this.mipmap&&$I.generateMipmap(3553)):(-1!==$i||($i=9729),-1!==$n||($n=9729),$I.texParameteri(3553,10241,$i),$I.texParameteri(3553,10240,$n),$I.texParameteri(3553,10242,33071),$I.texParameteri(3553,10243,33071)),$E&&$Z&&$gI.bindTexture($I,$E,$Z),this.canvas=null,$f&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},$M.disposeResource=function(){$r.enabled&&this._allowMerageInAtlas||!this._source||($wI.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$M.clearAtlasSource=function(){},$Z(0,$M,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$Z(0,$M,"atlasSource",function(){return this.canvas}),$Z(0,$M,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function($I){this._allowMerageInAtlas=$I}),$f}(),$GI=function($I){function $H($I,$M,$E,$Z){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,$H.__super.call(this),!$I||!$M)throw"Shader Error";this._id=++$H._count,this._vs=$I,this._ps=$M,this._nameMap=$Z||{},null!=$E&&($H.sharders[$E]=this)}$Q($H,"laya.webgl.shader.Shader",$XI);var $M=$H.prototype;return $M.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},$M.disposeResource=function(){$wI.mainContext.deleteShader(this._vshader),$wI.mainContext.deleteShader(this._pshader),$wI.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},$M._compile=function(){if(!$wI.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var $I=[this._vs,this._ps],$M=$wI.mainContext;if(this._program=$M.createProgram(),this._vshader=$H._createShader($M,$I[0],35633),this._pshader=$H._createShader($M,$I[1],35632),$M.attachShader(this._program,this._vshader),$M.attachShader(this._program,this._pshader),$M.linkProgram(this._program),!$N.isConchApp&&!$M.getProgramParameter(this._program,35714))throw $M.getProgramInfoLog(this._program);var $E,$Z,$i=0,$n=0;for($n=$N.isConchApp?$M.getProgramParameterEx(this._vs,this._ps,"",35721):$M.getProgramParameter(this._program,35721),$i=0;$i<$n;$i++){var $c=null;$E={vartype:"attribute",glfun:null,ivartype:0,attrib:$c=$N.isConchApp?$M.getActiveAttribEx(this._vs,this._ps,"",$i):$M.getActiveAttrib(this._program,$i),location:$M.getAttribLocation(this._program,$c.name),name:$c.name,type:$c.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push($E)}var $f=0;for($f=$N.isConchApp?$M.getProgramParameterEx(this._vs,this._ps,"",35718):$M.getProgramParameter(this._program,35718),$i=0;$i<$f;$i++){var $d=null;$d=$N.isConchApp?$M.getActiveUniformEx(this._vs,this._ps,"",$i):$M.getActiveUniform(this._program,$i),0<($E={vartype:"uniform",glfun:null,ivartype:1,attrib:$c,location:$M.getUniformLocation(this._program,$d.name),name:$d.name,type:$d.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($E.name=$E.name.substr(0,$E.name.length-3),$E.isArray=!0,$E.location=$M.getUniformLocation(this._program,$E.name)),this._params.push($E)}for($i=0,$Z=this._params.length;$i<$Z;$i++)if(($E=this._params[$i]).indexOfParams=$i,$E.index=1,$E.value=[$E.location,null],$E.codename=$E.name,$E.name=this._nameMap[$E.codename]?this._nameMap[$E.codename]:$E.codename,(this._paramsMap[$E.name]=$E)._this=this,$E.uploadedValue=[],"attribute"!==$E.vartype)switch($E.type){case 5124:$E.fun=$E.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$E.fun=$E.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$E.fun=$E.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$E.fun=$E.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$E.fun=$E.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$E.fun=this._uniform_sampler2D;break;case 35680:$E.fun=this._uniform_samplerCube;break;case 35676:$E.glfun=$M.uniformMatrix4fv,$E.fun=this._uniformMatrix4fv;break;case 35670:$E.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else $E.fun=this._attribute}},$M.getUniform=function($I){return this._paramsMap[$I]},$M._attribute=function($I,$M){var $E=$wI.mainContext,$Z=$JI._enableAtributes,$i=$I.location;return $Z[$i]||$E.enableVertexAttribArray($i),$E.vertexAttribPointer($i,$M[0],$M[1],$M[2],$M[3],$M[4]+this._offset),$Z[$i]=$JI._bindVertexBuffer,1},$M._uniform1f=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M?($wI.mainContext.uniform1f($I.location,$E[0]=$M),1):0},$M._uniform1fv=function($I,$M){if($M.length<4){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]||$E[2]!==$M[2]||$E[3]!==$M[3]?($wI.mainContext.uniform1fv($I.location,$M),$E[0]=$M[0],$E[1]=$M[1],$E[2]=$M[2],$E[3]=$M[3],1):0}return $wI.mainContext.uniform1fv($I.location,$M),1},$M._uniform_vec2=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]?($wI.mainContext.uniform2f($I.location,$E[0]=$M[0],$E[1]=$M[1]),1):0},$M._uniform_vec2v=function($I,$M){if($M.length<2){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]||$E[2]!==$M[2]||$E[3]!==$M[3]?($wI.mainContext.uniform2fv($I.location,$M),$E[0]=$M[0],$E[1]=$M[1],$E[2]=$M[2],$E[3]=$M[3],1):0}return $wI.mainContext.uniform2fv($I.location,$M),1},$M._uniform_vec3=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]||$E[2]!==$M[2]?($wI.mainContext.uniform3f($I.location,$E[0]=$M[0],$E[1]=$M[1],$E[2]=$M[2]),1):0},$M._uniform_vec3v=function($I,$M){return $wI.mainContext.uniform3fv($I.location,$M),1},$M._uniform_vec4=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]||$E[2]!==$M[2]||$E[3]!==$M[3]?($wI.mainContext.uniform4f($I.location,$E[0]=$M[0],$E[1]=$M[1],$E[2]=$M[2],$E[3]=$M[3]),1):0},$M._uniform_vec4v=function($I,$M){return $wI.mainContext.uniform4fv($I.location,$M),1},$M._uniformMatrix2fv=function($I,$M){return $wI.mainContext.uniformMatrix2fv($I.location,!1,$M),1},$M._uniformMatrix3fv=function($I,$M){return $wI.mainContext.uniformMatrix3fv($I.location,!1,$M),1},$M._uniformMatrix4fv=function($I,$M){return $wI.mainContext.uniformMatrix4fv($I.location,!1,$M),1},$M._uniform1i=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M?($wI.mainContext.uniform1i($I.location,$E[0]=$M),1):0},$M._uniform1iv=function($I,$M){return $wI.mainContext.uniform1iv($I.location,$M),1},$M._uniform_ivec2=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]?($wI.mainContext.uniform2i($I.location,$E[0]=$M[0],$E[1]=$M[1]),1):0},$M._uniform_ivec2v=function($I,$M){return $wI.mainContext.uniform2iv($I.location,$M),1},$M._uniform_vec3i=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]||$E[2]!==$M[2]?($wI.mainContext.uniform3i($I.location,$E[0]=$M[0],$E[1]=$M[1],$E[2]=$M[2]),1):0},$M._uniform_vec3vi=function($I,$M){return $wI.mainContext.uniform3iv($I.location,$M),1},$M._uniform_vec4i=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]||$E[2]!==$M[2]||$E[3]!==$M[3]?($wI.mainContext.uniform4i($I.location,$E[0]=$M[0],$E[1]=$M[1],$E[2]=$M[2],$E[3]=$M[3]),1):0},$M._uniform_vec4vi=function($I,$M){return $wI.mainContext.uniform4iv($I.location,$M),1},$M._uniform_sampler2D=function($I,$M){var $E=$wI.mainContext,$Z=$I.uploadedValue;return null==$Z[0]?($Z[0]=this._curActTexIndex,$E.uniform1i($I.location,this._curActTexIndex),$E.activeTexture($H._TEXTURES[this._curActTexIndex]),$gI.bindTexture($E,3553,$M),this._curActTexIndex++,1):($E.activeTexture($H._TEXTURES[$Z[0]]),$gI.bindTexture($E,3553,$M),0)},$M._uniform_samplerCube=function($I,$M){var $E=$wI.mainContext,$Z=$I.uploadedValue;return null==$Z[0]?($Z[0]=this._curActTexIndex,$E.uniform1i($I.location,this._curActTexIndex),$E.activeTexture($H._TEXTURES[this._curActTexIndex]),$gI.bindTexture($E,34067,$M),this._curActTexIndex++,1):($E.activeTexture($H._TEXTURES[$Z[0]]),$gI.bindTexture($E,34067,$M),0)},$M._noSetValue=function($I){console.log("no....:"+$I.name)},$M.uploadOne=function($I,$M){this.activeResource(),$gI.UseProgram(this._program);var $E=this._paramsMap[$I];$E.fun.call(this,$E,$M)},$M.uploadTexture2D=function($I){$R.shaderCall++;var $M=$wI.mainContext;$M.activeTexture(33984),$gI.bindTexture($M,3553,$I)},$M.uploadTexture2D1=function($I){$R.shaderCall++;var $M=$wI.mainContext;$M.activeTexture(33985),$gI.bindTexture($M,3553,$I)},$M.upload=function($I,$M){$XI.activeShader=$XI.bindShader=this,this._lastUseFrameCount===$R.loopCount||this.activeResource(),$gI.UseProgram(this._program),this._reCompile?($M=this._params,this._reCompile=!1):$M=$M||this._params;$wI.mainContext;for(var $E,$Z,$i=$M.length,$n=0,$c=0;$c<$i;$c++)null!==($Z=$I[($E=$M[$c]).name])&&($n+=$E.fun.call(this,$E,$Z));$R.shaderCall+=$n},$M.uploadArray=function($I,$M,$E){$XI.activeShader=this,($XI.bindShader=this).activeResource(),$gI.UseProgram(this._program);this._params;for(var $Z,$i,$n=0,$c=$M-2;0<=$c;$c-=2)($i=this._paramsMap[$I[$c]])&&null!=($Z=$I[$c+1])&&($E&&$E[$i.name]&&$E[$i.name].bind(),$n+=$i.fun.call(this,$i,$Z));$R.shaderCall+=$n},$M.getParams=function(){return this._params},$H.getShader=function($I){return $H.sharders[$I]},$H.create=function($I,$M,$E,$Z){return new $H($I,$M,$E,$Z)},$H.withCompile=function($I,$M,$E,$Z){if($E&&$H.sharders[$E])return $H.sharders[$E];var $i=$H._preCompileShader[2e-4*$I];if(!$i)throw new Error("withCompile shader err!"+$I);return $i.createShader($M,$E,$Z)},$H.withCompile2D=function($I,$M,$E,$Z,$i){if($Z&&$H.sharders[$Z])return $H.sharders[$Z];var $n=$H._preCompileShader[2e-4*$I+$M];if(!$n)throw new Error("withCompile shader err!"+$I+" "+$M);return $n.createShader($E,$Z,$i)},$H.addInclude=function($I,$M){$$I.addInclude($I,$M)},$H.preCompile=function($I,$M,$E,$Z){var $i=2e-4*$I;$H._preCompileShader[$i]=new $$I($i,$M,$E,$Z)},$H.preCompile2D=function($I,$M,$E,$Z,$i){var $n=2e-4*$I+$M;$H._preCompileShader[$n]=new $$I($n,$E,$Z,$i)},$H._createShader=function($I,$M,$E){var $Z=$I.createShader($E);return $I.shaderSource($Z,$M),$I.compileShader($Z),$Z},$H._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],$H._count=0,$H._preCompileShader={},$H.SHADERNAME2ID=2e-4,$H.sharders=(($H.sharders=[]).length=32,$H.sharders),$c($H,["nameKey",function(){return this.nameKey=new $z}]),$H}(),$YI=function($I){function $M(){this._maxsize=0,this._upload=!0,this._uploadSize=0,$M.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}$Q($M,"laya.webgl.utils.Buffer2D",$I);var $E=$M.prototype;return $E.needSize=function($I){var $M=this._byteLength;if($I){var $E=this._byteLength+$I;$E<=this._buffer.byteLength||this._resizeBuffer($E<<1,!0),this._byteLength=$E}return $M},$E._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),$R.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$JI._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$JI._gl.bufferSubData(this._bufferType,0,this._buffer)},$E._bufferSubData=function($I,$M,$E){if(void 0===$I&&($I=0),void 0===$M&&($M=0),void 0===$E&&($E=0),this._maxsize=Math.max(this._maxsize,this._byteLength),$R.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,$JI._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),$M||$E){var $Z=this._buffer.slice($M,$E);$JI._gl.bufferSubData(this._bufferType,$I,$Z)}else $JI._gl.bufferSubData(this._bufferType,$I,this._buffer)},$E._checkArrayUse=function(){},$E._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},$E._bind_subUpload=function($I,$M,$E){return void 0===$I&&($I=0),void 0===$M&&($M=0),void 0===$E&&($E=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData($I,$M,$E),!0)},$E._resizeBuffer=function($I,$M){if($I<this._buffer.byteLength)return this;if(this.memorySize=$I,$M&&this._buffer&&0<this._buffer.byteLength){var $E=new ArrayBuffer($I);new Uint8Array($E).set(new Uint8Array(this._buffer),0),this._buffer=$E}else this._buffer=new ArrayBuffer($I);return this._checkArrayUse(),this._upload=!0,this},$E.append=function($I){this._upload=!0;var $M,$E;$M=$I.byteLength,$I instanceof Uint8Array?(this._resizeBuffer(this._byteLength+$M,!0),$E=new Uint8Array(this._buffer,this._byteLength)):$I instanceof Uint16Array?(this._resizeBuffer(this._byteLength+$M,!0),$E=new Uint16Array(this._buffer,this._byteLength)):$I instanceof Float32Array&&(this._resizeBuffer(this._byteLength+$M,!0),$E=new Float32Array(this._buffer,this._byteLength)),$E.set($I,0),this._byteLength+=$M,this._checkArrayUse()},$E.appendU16Array=function($I,$M){this._resizeBuffer(this._byteLength+2*$M,!0);for(var $E=new Uint16Array(this._buffer,this._byteLength,$M),$Z=0;$Z<$M;$Z++)$E[$Z]=$I[$Z];this._byteLength+=2*$M,this._checkArrayUse()},$E.appendEx=function($I,$M){this._upload=!0;var $E;$E=$I.byteLength,this._resizeBuffer(this._byteLength+$E,!0),new $M(this._buffer,this._byteLength).set($I,0),this._byteLength+=$E,this._checkArrayUse()},$E.appendEx2=function($I,$M,$E,$Z){void 0===$Z&&($Z=1),this._upload=!0;var $i,$n;$i=$E*$Z,this._resizeBuffer(this._byteLength+$i,!0),$n=new $M(this._buffer,this._byteLength);var $c=0;for($c=0;$c<$E;$c++)$n[$c]=$I[$c];this._byteLength+=$i,this._checkArrayUse()},$E.getBuffer=function(){return this._buffer},$E.setNeedUpload=function(){this._upload=!0},$E.getNeedUpload=function(){return this._upload},$E.upload=function(){var $I=this._bind_upload();return $JI._gl.bindBuffer(this._bufferType,null),$JI._bindActive[this._bufferType]=null,$XI.activeShader=null,$I},$E.subUpload=function($I,$M,$E){void 0===$I&&($I=0),void 0===$M&&($M=0),void 0===$E&&($E=0);var $Z=this._bind_subUpload();return $JI._gl.bindBuffer(this._bufferType,null),$JI._bindActive[this._bufferType]=null,$XI.activeShader=null,$Z},$E.disposeResource=function(){$I.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},$E.clear=function(){this._byteLength=0,this._upload=!0},$Z(0,$E,"bufferLength",function(){return this._buffer.byteLength}),$Z(0,$E,"byteLength",null,function($I){this._byteLength!==$I&&($I<=this._buffer.byteLength||this._resizeBuffer(2*$I+256,!0),this._byteLength=$I)}),$M.__int__=function($I){$bI.QuadrangleIB=$bI.create(35044),$uI.fillIBQuadrangle($bI.QuadrangleIB,16)},$M.FLOAT32=4,$M.SHORT=2,$M}($JI),$KI=(function($M){function $E($I){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,$E.__super.call(this,9)}$Q($E,"laya.webgl.shader.d2.value.GlowSV",$M);var $I=$E.prototype;$I.setValue=function($I){$M.prototype.setValue.call(this,$I)},$I.clear=function(){$M.prototype.clear.call(this)}}($lI),function($I){function $M($I){$M.__super.call(this,64),this.defines.add(64)}$Q($M,"laya.webgl.shader.d2.value.TextSV",$I);var $E=$M.prototype;return $E.release=function(){($M.pool[$M._length++]=this).clear()},$E.clear=function(){$I.prototype.clear.call(this)},$M.create=function(){return $M._length?$M.pool[--$M._length]:new $M(null)},$M.pool=[],$M._length=0,$M}($lI)),$sI=function($I){function $i($I,$M,$E,$Z){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,$i.__super.call(this,$I,$M,$E,$Z)}$Q($i,"laya.webgl.shader.d2.Shader2X",$I);var $M=$i.prototype;return $M.upload2dQuick1=function($I){this.upload($I,this._params2dQuick1||this._make2dQuick1())},$M._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var $I,$M=this._params,$E=0,$Z=$M.length;$E<$Z;$E++)$I=$M[$E],($N.isFlash||"size"!==$I.name&&"position"!==$I.name&&"texcoord"!==$I.name)&&this._params2dQuick1.push($I)}return this._params2dQuick1},$M.disposeResource=function(){$I.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},$M.upload2dQuick2=function($I){this.upload($I,this._params2dQuick2||this._make2dQuick2())},$M._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var $I,$M=this._params,$E=0,$Z=$M.length;$E<$Z;$E++)$I=$M[$E],($N.isFlash||"size"!==$I.name)&&this._params2dQuick2.push($I)}return this._params2dQuick2},$i.create=function($I,$M,$E,$Z){return new $i($I,$M,$E,$Z)},$i}($GI),$bI=function($I){function $M($I){this._uint8Array=null,this._uint16Array=null,void 0===$I&&($I=35044),$M.__super.call(this),this._bufferUsage=$I,this._bufferType=34963,$N.isFlash||(this._buffer=new ArrayBuffer(8))}$Q($M,"laya.webgl.utils.IndexBuffer2D",$YI);var $E=$M.prototype;return $E._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},$E.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},$E.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},$E.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},$M.QuadrangleIB=null,$M.create=function($I){return void 0===$I&&($I=35044),new $M($I)},$M}(),$UI=function($I){function $E($I,$M){this._floatArray32=null,this._vertexStride=0,$E.__super.call(this),this._vertexStride=$I,this._bufferUsage=$M,this._bufferType=34962,$N.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}$Q($E,"laya.webgl.utils.VertexBuffer2D",$I);var $M=$E.prototype;return $M.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},$M.bind=function($I){$I&&$I._bind(),this._bind()},$M.insertData=function($I,$M){this.getFloat32Array().set($I,$M),this._upload=!0},$M.bind_upload=function($I){$I._bind_upload()||$I._bind(),this._bind_upload()||this._bind()},$M._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},$M.disposeResource=function(){$I.prototype.disposeResource.call(this)},$M.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},$Z(0,$M,"vertexStride",function(){return this._vertexStride}),$E.create=function($I,$M){return void 0===$M&&($M=35048),new $E($I,$M)},$E}($YI),$IM=function($I){function $f($I,$M,$E,$Z,$i,$n){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===$E&&($E=6408),void 0===$Z&&($Z=!0),$f.__super.call(this,$I,$M),$I){if(this._format=$E,this._mipmap=$Z,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof $I)this._url=$I,this._src=$I,this._image=new $p.window.Image,$M&&($M.onload&&(this.onload=$M.onload),$M.onerror&&(this.onerror=$M.onerror),$M.onCreate&&$M.onCreate(this)),this._image.crossOrigin=$I&&0==$I.indexOf("data:")?null:"",$I&&(this._image.src=$I);else if($I instanceof ArrayBuffer){this._src=$M,this._url=this._src;var $c=new $d($I);$c.readUTFBytes(4),$c.readUTFBytes(2),$c.getInt16();$c.endian="bigEndian",this._w=$c.getInt16(),this._h=$c.getInt16();$c.getInt16(),$c.getInt16();this._image=new Uint8Array($I,$c.pos),this._format=$wI.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,$r.enabled&&this._w<$r.atlasLimitWidth&&this._h<$r.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!($I instanceof Uint8Array))return this._src=$M,this._url=this._src,this._image=$I.source||$I,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=$M,this._url=this._src,this._w=$i,this._h=$n,this._image=$I,this._format=0===$E?$I.byteLength/($i*$n)==4?6408:6407:$E}this._$5__enableMerageInAtlas=!0}}$Q($f,"laya.webgl.resource.WebGLImage",$V);var $M=$f.prototype;return $O.imps($M,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),$M._init_=function($I,$M){},$M._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $I=$wI.mainContext,$M=this._source=$I.createTexture(),$E=$gI.curBindTexTarget,$Z=$gI.curBindTexValue;$gI.bindTexture($I,3553,$M);var $i=this.minFifter,$n=this.magFifter,$c=this.repeat?10497:33071,$f=$B.isPOT(this._w,this._h),$d=!1;switch($f?(this.mipmap?-1!==$i||($i=9987):-1!==$i||($i=9729),-1!==$n||($n=9729),$I.texParameteri(3553,10241,$i),$I.texParameteri(3553,10240,$n),$I.texParameteri(3553,10242,$c),$I.texParameteri(3553,10243,$c),this.mipmap&&$I.generateMipmap(3553)):(-1!==$i||($i=9729),-1!==$n||($n=9729),$I.texParameteri(3553,10241,$i),$I.texParameteri(3553,10240,$n),$I.texParameteri(3553,10242,33071),$I.texParameteri(3553,10243,33071)),$I.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&$I.pixelStorei($I.UNPACK_ALIGNMENT,1),$I.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&$I.pixelStorei($I.UNPACK_ALIGNMENT,1),$I.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:$d=!0,$I.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case $wI.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$d=!0,$I.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}$I.pixelStorei(37441,!1),$E&&$Z&&$gI.bindTexture($I,$E,$Z),this.uri||(this.uri=this._url),$d?this.memorySize=this._image.length:$f&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},$M.recreateResource=function(){var $I=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var $M=this;this._image=new $p.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if($M._needReleaseAgain)return $M._needReleaseAgain=!1,$M._image.onload=null,void($M._image=null);$M._allowMerageInAtlas&&$M._enableMerageInAtlas?($I.memorySize=0,$I._recreateLock=!1):$M._createWebGlTexture(),$M.completeCreate()},this._image.src=this._src}},$M.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&$wI.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},$M.onresize=function(){this._w=this._image.width,this._h=this._image.height,$r.enabled&&this._w<$r.atlasLimitWidth&&this._h<$r.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},$M.clearAtlasSource=function(){this._image=null},$Z(0,$M,"format",function(){return this._format}),$Z(0,$M,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function($I){this._$5__enableMerageInAtlas=$I}),$Z(0,$M,"mipmap",function(){return this._mipmap}),$Z(0,$M,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),$Z(0,$M,"atlasSource",function(){return this._image}),$Z(0,$M,"onload",null,function($I){var $M=this;this._onload=$I,this._image&&(this._image.onload=null!=this._onload?function(){$M.onresize(),$M._onload()}:null)}),$Z(0,$M,"onerror",null,function($I){var $M=this;this._onerror=$I,this._image&&(this._image.onerror=null!=this._onerror?function(){$M._onerror()}:null)}),$f}();$O.__init([$pI,$k,$aI,$$I])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($I,$M){"use strict";for(var $E in Object.defineProperty($M,"__esModule",{value:!0}),Laya){var $Z=Laya[$E];$Z&&$Z.__isclass&&($M[$E]=$Z)}}),function($n,$I,$Z){$Z.un,$Z.uns;var $i=$Z.static,$c=$Z.class,$f=$Z.getset,$d=($Z.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),$t=laya.utils.ClassUtils,$A=(laya.events.Event,laya.utils.HTMLChar),$H=laya.net.Loader,$B=(laya.display.Node,laya.maths.Rectangle),$Q=laya.renders.Render,$p=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),$V=laya.utils.Stat,$X=laya.display.Text,$u=laya.resource.Texture,$N=laya.net.URL,$y=laya.utils.Utils,$$=function(){function $p(){}return $c($p,"laya.html.utils.HTMLParse"),$p.parse=function($I,$M,$E){$M=($M="<root>"+($M=$M.replace(/<br>/g,"<br/>"))+"</root>").replace($p.spacePattern,$p.char255);var $Z=$y.parseXMLFromString($M);$p._parseXML($I,$Z.childNodes[0].childNodes,$E)},$p._parseXML=function($I,$M,$E,$Z){var $i=0,$n=0;if($M.join||$M.item)for($i=0,$n=$M.length;$i<$n;++$i)$p._parseXML($I,$M[$i],$E,$Z);else{var $c,$f,$d;if(3==$M.nodeType)return void($I instanceof laya.html.dom.HTMLDivElement?(null==$M.nodeName&&($M.nodeName="#text"),$f=$M.nodeName.toLowerCase(),0<($d=$M.textContent.replace(/^\s+|\s+$/g,"")).length&&($c=$t.getInstance($f))&&($I.addChild($c),$c.innerTEXT=$d.replace($p.char255AndOneSpacePattern," "))):0<($d=$M.textContent.replace(/^\s+|\s+$/g,"")).length&&($I.innerTEXT=$d.replace($p.char255AndOneSpacePattern," ")));if("#comment"==($f=$M.nodeName.toLowerCase()))return;if($c=$t.getInstance($f)){($c=$I.addChild($c)).URI=$E,$c.href=$Z;var $H=$M.attributes;if($H&&0<$H.length)for($i=0,$n=$H.length;$i<$n;++$i){var $B=$H[$i],$A=$B.nodeName,$Q=$B.value;$c._setAttributes($A,$Q)}$p._parseXML($c,$M.childNodes,$E,$c.href)}else $p._parseXML($I,$M.childNodes,$E,$Z)}},$p.char255=String.fromCharCode(255),$p.spacePattern=/&nbsp;|&#160;/g,$p.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),$p}(),$w=function(){function $S(){}return $c($S,"laya.html.utils.Layout"),$S.later=function($I){null==$S._will&&($S._will=[],$Z.stage.frameLoop(1,null,function(){if(!($S._will.length<1)){for(var $I=0;$I<$S._will.length;$I++)laya.html.utils.Layout.layout($S._will[$I]);$S._will.length=0}})),$S._will.push($I)},$S.layout=function($I){if(!$I||!$I._style)return null;if(0==(512&$I._style._type))return null;$I.getStyle()._type&=-513;var $M=$S._multiLineLayout($I);return $Q.isConchApp&&$I.layaoutCallNative&&$I.layaoutCallNative(),$M},$S._multiLineLayout=function($I){if($X.RightToLeft)return $S._multiLineLayout2($I);var $M=new Array;$I._addChildsToLayout($M);var $E,$Z,$i,$n,$c,$f=0,$d=$M.length,$H=$I._getCSSStyle(),$B=$H.letterSpacing,$A=$H.leading,$Q=$H.lineHeight,$p=$H._widthAuto()||!$H.wordWrap,$t=$p?999999:$I.width,$V=($I.height,0),$u=$H.italic?$H.fontSize/3:0,$N=$H._getAlign(),$y=$H._getValign(),$$=0!==$y||0!==$N||0!=$Q,$w=0,$g=0,$O=0,$a=0,$m=new Array,$j=$m[0]=new $C,$T=!1,$q=!1;$j.h=0,$H.italic&&($t-=$H.fontSize/3);var $v=0,$W=!0;function $R(){$j.y=$g,$g+=$j.h+$A,0==$j.h&&($g+=$Q),$j.mWidth=$v,$v=0,$j=new $C,$m.push($j),$j.h=0,$T=!($W=!($w=0))}for($f=0;$f<$d;$f++)if(null!=($E=$M[$f]))if($W=!1,$E instanceof laya.html.dom.HTMLBrElement)$R(),$j.y=$g;else{if($E._isChar()){if(($n=$E).isWord)$T=$q||"\n"===$n.char,$j.wordStartIndex=$j.elements.length;else{if($O=$n.width+$n.style.letterSpacin,0<$m.length&&$t<$w+$O&&0<$j.wordStartIndex){var $z;$z=$j.elements.length-$j.wordStartIndex+1,$j.elements.length=$j.wordStartIndex,$f-=$z,$R();continue}$T=!1,$v+=$n.width}$O=$n.width+$B,$a=$n.height,$q=!1,($T=$T||$t<$w+$O)&&$R(),$j.minTextHeight=Math.min($j.minTextHeight,$E.height)}else $Z=$E._getCSSStyle(),$c=$E,$i=$Z.padding,0===$Z._getCssFloat()||($$=!0),$T=$q||$Z.lineElement,$O=$c.width*$c._style._tf.scaleX+$i[1]+$i[3]+$B,$a=$c.height*$c._style._tf.scaleY+$i[0]+$i[2],$q=$Z.lineElement,($T=$T||$t<$w+$O&&$Z.wordWrap)&&$R();$j.elements.push($E),$j.h=Math.max($j.h,$a),$E.x=$w,$E.y=$g,$w+=$O,$j.w=$w-$B,$j.y=$g,$V=Math.max($w+$u,$V)}else $W||($w+=$S.DIV_ELEMENT_PADDING),$j.wordStartIndex=$j.elements.length;if($g=$j.y+$j.h,$$){var $L=0,$o=$t;for($p&&0<$I.width&&($o=$I.width),$f=0,$d=$m.length;$f<$d;$f++)$m[$f].updatePos(0,$o,$f,$L,$N,$y,$Q),$L+=Math.max($Q,$m[$f].h+$A);$g=$L}return $p&&($I.width=$V),$g>$I.height&&($I.height=$g),[$V,$g]},$S._multiLineLayout2=function($I){var $M=new Array;$I._addChildsToLayout($M);var $E,$Z,$i,$n,$c,$f=0,$d=$M.length,$H=$I._getCSSStyle(),$B=$H.letterSpacing,$A=$H.leading,$Q=$H.lineHeight,$p=$H._widthAuto()||!$H.wordWrap,$t=$p?999999:$I.width,$V=($I.height,0),$u=$H.italic?$H.fontSize/3:0,$N=2-$H._getAlign(),$y=$H._getValign(),$$=0!==$y||0!=$N||0!=$Q,$w=0,$g=0,$O=0,$a=0,$m=new Array,$j=$m[0]=new $C,$T=!1,$q=!1;$j.h=0,$H.italic&&($t-=$H.fontSize/3);var $v=0,$W=!0;function $R(){$j.y=$g,$g+=$j.h+$A,0==$j.h&&($g+=$Q),$j.mWidth=$v,$v=0,$j=new $C,$m.push($j),$j.h=0,$T=!($W=!($w=0))}for($f=0;$f<$d;$f++)if(null!=($E=$M[$f]))if($W=!1,$E instanceof laya.html.dom.HTMLBrElement)$R(),$j.y=$g;else{if($E._isChar()){if(($n=$E).isWord)$T=$q||"\n"===$n.char,$j.wordStartIndex=$j.elements.length;else{if(0<$m.length&&$t<$w+$O&&0<$j.wordStartIndex){var $z;$z=$j.elements.length-$j.wordStartIndex+1,$j.elements.length=$j.wordStartIndex,$f-=$z,$R();continue}$T=!1,$v+=$n.width}$O=$n.width+$B,$a=$n.height,$q=!1,($T=$T||$t<$w+$O)&&$R(),$j.minTextHeight=Math.min($j.minTextHeight,$E.height)}else $Z=$E._getCSSStyle(),$c=$E,$i=$Z.padding,0===$Z._getCssFloat()||($$=!0),$T=$q||$Z.lineElement,$O=$c.width*$c._style._tf.scaleX+$i[1]+$i[3]+$B,$a=$c.height*$c._style._tf.scaleY+$i[0]+$i[2],$q=$Z.lineElement,($T=$T||$t<$w+$O&&$Z.wordWrap)&&$R();$j.elements.push($E),$j.h=Math.max($j.h,$a),$E.x=$w,$E.y=$g,$w+=$O,$j.w=$w-$B,$j.y=$g,$V=Math.max($w+$u,$V)}else $W||($w+=$S.DIV_ELEMENT_PADDING),$j.wordStartIndex=$j.elements.length;if($g=$j.y+$j.h,$$){var $L=0,$o=$t;for($f=0,$d=$m.length;$f<$d;$f++)$m[$f].updatePos(0,$o,$f,$L,$N,$y,$Q),$L+=Math.max($Q,$m[$f].h+$A);$g=$L}for($p&&($I.width=$V),$g>$I.height&&($I.height=$g),$f=0,$d=$m.length;$f<$d;$f++)$m[$f].revertOrder($t);return[$V,$g]},$S._will=null,$S.DIV_ELEMENT_PADDING=0,$S}(),$C=function(){function $I(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}$c($I,"laya.html.utils.LayoutLine");var $M=$I.prototype;return $M.updatePos=function($I,$M,$E,$Z,$i,$n,$c){var $f,$d=0;0<this.elements.length&&($d=($f=this.elements[this.elements.length-1]).x+$f.width-this.elements[0].x);var $H=0,$B=NaN;1===$i&&($H=($M-$d)/2),2===$i&&($H=$M-$d),0===$c||0!=$n||($n=1);for(var $A=0,$Q=this.elements.length;$A<$Q;$A++){var $p=($f=this.elements[$A])._getCSSStyle();switch(0!==$H&&($f.x+=$H),$p._getValign()){case 0:$f.y=$Z;break;case 1:var $t=0;99999!=this.minTextHeight&&($t=this.minTextHeight);var $V=($t+$c)/2;$V=Math.max($V,this.h),$B=(laya.html.dom.HTMLImageElement,$Z+$V-$f.height),$f.y=$B;break;case 2:$f.y=$Z+($c-$f.height)}}},$M.revertOrder=function($I){var $M;if(0<this.elements.length){var $E,$Z=0;for($E=this.elements.length,$Z=0;$Z<$E;$Z++)($M=this.elements[$Z]).x=$I-$M.x-$M.width}},$I}(),$g=function($E){function $M(){this.URI=null,this._href=null,$M.__super.call(this),this._text=$M._EMPTYTEXT,this.setStyle(new $d(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}$c($M,"laya.html.dom.HTMLElement",$E);var $I=$M.prototype;return $I.layaoutCallNative=function(){var $I=0;if(this._childs&&0<($I=this._childs.length))for(var $M=0;$M<$I;$M++)this._childs[$M].layaoutCallNative&&this._childs[$M].layaoutCallNative();var $E=this._getWords();$E?laya.html.dom.HTMLElement.fillWords(this,$E,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},$I.appendChild=function($I){return this.addChild($I)},$I._getWords2=function(){var $I=this._text.text;if(!$I||0===$I.length)return null;var $M,$E,$Z=0,$i=0;if(this._text.drawWords)$E=this._text.drawWords;else{for($i=($M=$I.split(" ")).length-1,$E=[],$Z=0;$Z<$i;$Z++)$E.push($M[$Z]," ");0<=$i&&$E.push($M[$i]),this._text.drawWords=$E}var $n,$c=this._text.words;if($c&&$c.length===$E.length)return $c;null===$c&&(this._text.words=$c=[]),$c.length=$E.length;var $f=this.style,$d=$f.font;for($Z=0,$i=$E.length;$Z<$i;$Z++){$n=$y.measureText($E[$Z],$d);var $H=$c[$Z]=new $A($E[$Z],$n.width,$n.height||$f.fontSize,$f);if(1<$H.char.length&&($H.charNum=$H.char),this.href){var $B=new $p;this.addChild($B),$H.setSprite($B)}}return $c},$I._getWords=function(){if(!$X.CharacterCache)return this._getWords2();var $I=this._text.text;if(!$I||0===$I.length)return null;var $M,$E=this._text.words;if($E&&$E.length===$I.length)return $E;null===$E&&(this._text.words=$E=[]),$E.length=$I.length;for(var $Z=this.style,$i=$Z.font,$n=0,$c=$I.length;$n<$c;$n++)if($M=$y.measureText($I.charAt($n),$i)){var $f=$E[$n]=new $A($I.charAt($n),$M.width,$M.height||$Z.fontSize,$Z);if(this.href){var $d=new $p;this.addChild($d),$f.setSprite($d)}}else console.warn("_getWords size is null"+$I.charAt($n),$i);return $E},$I.showLinkSprite=function(){var $I=this._text.words;if($I)for(var $M,$E,$Z=[],$i=0;$i<$I.length;$i++)$E=$I[$i],($M=new $p).graphics.drawRect(0,0,$E.width,$E.height,"#ff0000"),$M.width=$E.width,$M.height=$E.height,this.addChild($M),$Z.push($M)},$I._layoutLater=function(){var $I=this.style;512&$I._type||($I.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&$I.block?($w.later(this),$I._type|=512):this.parent&&this.parent._layoutLater())},$I._setAttributes=function($I,$M){switch($I){case"style":return void this.style.cssText($M);case"class":return void(this.className=$M)}$E.prototype._setAttributes.call(this,$I,$M)},$I.updateHref=function(){if(null!=this._href){var $I=this._getWords();if($I)for(var $M,$E,$Z=0;$Z<$I.length;$Z++)($E=($M=$I[$Z]).getSprite())&&($E.size($M.width,$M.height),$E.on("click",this,this.onLinkHandler))}},$I.onLinkHandler=function($I){switch($I.type){case"click":for(var $M=this;$M;)$M.event("link",[this.href]),$M=$M.parent}},$I.formatURL=function($I){return this.URI?$N.formatURL($I,this.URI?this.URI.path:null):$I},$f(0,$I,"href",function(){return this._href},function($I){null!=(this._href=$I)&&(this._getCSSStyle().underLine=1,this.updateHref())}),$f(0,$I,"color",null,function($I){this.style.color=$I}),$f(0,$I,"onClick",null,function($I){$Z._runScript("fn=function(event){"+$I+";}"),this.on("click",this,void 0)}),$f(0,$I,"id",null,function($I){$O.document.setElementById($I,this)}),$f(0,$I,"innerTEXT",function(){return this._text.text},function($I){this.text=$I}),$f(0,$I,"style",function(){return this._style}),$f(0,$I,"text",function(){return this._text.text},function($I){this._text==$M._EMPTYTEXT?this._text={text:$I,words:null}:(this._text.text=$I,this._text.words&&(this._text.words.length=0)),$Q.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),$f(0,$I,"parent",$E.prototype._$get_parent,function($I){if($I instanceof laya.html.dom.HTMLElement){var $M=$I;this.URI||(this.URI=$M.URI),this.style.inherit($M.style)}$Z.superSet($p,this,"parent",$I)}),$f(0,$I,"className",null,function($I){this.style.attrs($O.document.styleSheets["."+$I])}),$M.fillWords=function($I,$M,$E,$Z,$i,$n,$c){$I.graphics.clear();for(var $f=0,$d=$M.length;$f<$d;$f++){var $H=$M[$f];$I.graphics.fillText($H.char,$H.x+$E,$H.y+$Z,$i,$n,"left",$c)}},$M._EMPTYTEXT={text:null,words:null},$M}($p),$M=(function($I){function $M(){$M.__super.call(this),this.style.lineElement=!0,this.style.block=!0}$c($M,"laya.html.dom.HTMLBrElement",$g)}(),function($I){function $M(){this.contextHeight=NaN,this.contextWidth=NaN,$M.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}$c($M,"laya.html.dom.HTMLDivElement",$I);var $E=$M.prototype;return $E.appendHTML=function($I){$$.parse(this,$I,this.URI),this.layout()},$E._addChildsToLayout=function($M){var $I=this._getWords();if(null==$I&&0==this._childs.length)return!1;$I&&$I.forEach(function($I){$M.push($I)});for(var $E=!0,$Z=0,$i=this._childs.length;$Z<$i;$Z++){var $n=this._childs[$Z];$E?$E=!1:$M.push(null),$n._addToLayout($M)}return!0},$E._addToLayout=function($I){this.layout()},$E.layout=function(){if(this.style){this.style._type|=512;var $I=$w.layout(this);if($I){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new $B);var $M=this._$P.mHtmlBounds;$M.x=$M.y=0,$M.width=this.contextWidth=$I[0],$M.height=this.contextHeight=$I[1],this.setBounds($M)}}},$f(0,$E,"height",function(){return this._height?this._height:this.contextHeight},$I.prototype._$set_height),$f(0,$E,"innerHTML",null,function($I){this.destroyChildren(),this.appendHTML($I)}),$f(0,$E,"width",function(){return this._width?this._width:this.contextWidth},function($I){var $M=!1;$M=0===$I?$I!=this._width:$I!=this.width,$Z.superSet($g,this,"width",$I),$M&&this.layout()}),$M}($g)),$O=function($I){function $M(){this.all=new Array,this.styleSheets=$d.styleSheets,$M.__super.call(this)}$c($M,"laya.html.dom.HTMLDocument",$g);var $E=$M.prototype;return $E.getElementById=function($I){return this.all[$I]},$E.setElementById=function($I,$M){this.all[$I]=$M},$i($M,["document",function(){return this.document=new $M}]),$M}();(function($I){function $M(){this._tex=null,this._url=null,this._renderArgs=[],$M.__super.call(this),this.style.block=!0}$c($M,"laya.html.dom.HTMLImageElement",$g);var $E=$M.prototype;$E._addToLayout=function($I){!this._style.absolute&&$I.push(this)},$E.render=function($I,$M,$E){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||($V.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,$I.ctx.drawTexture2($M,$E,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},$E.layaoutCallNative=function(){var $I=0;if(this._childs&&0<($I=this._childs.length))for(var $M=0;$M<$I;$M++)this._childs[$M].layaoutCallNative&&this._childs[$M].layaoutCallNative()},$f(0,$E,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function($I){this._width!==$I&&(this._width=$I,this._style.width=$I,this.repaint())}),$f(0,$E,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function($I){this._height!==$I&&(this._height=$I,this._style.height=$I,this.repaint())}),$E.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),$H.clearCache(this,this._url),this._tex=null),$g.prototype.destroy.call(this)},$E.onloaded=function(){var $I=this._style;$I&&!$I.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),$I&&!$I.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),$Q.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},$E._loadImageComplete=function($I,$M,$E){if(!this._destroyed)if(null!=$E)if($E instanceof ArrayBuffer){var $Z=new DataView($E);new laya.webgl.resource.WebGLImage(new Uint8Array($E,8),$I,0,!1,$Z.getUint32(0),$Z.getUint32(4));this.onloaded()}else if($E instanceof $u)$H.imgMgrSet[$I]=$M,$n.imgMgrLock($I,$H.imgMgrSet[$I]),this._url=$I,this._tex=$E,$H.keepCache(this,$I),$H.cacheRes($I,this._tex),this.onloaded();else{var $i=-1!=$I.indexOf(".png",$I.length-4)?6408:6407;new laya.webgl.resource.WebGLImage($E,$I,$i,!1,$E.width,$E.height);this.onloaded()}else this.event("error","Load image failed")},$f(0,$E,"src",null,function($I){($I=this.formatURL($I),this._url!=$I)&&(null!=this._tex&&($H.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=$I,(this._tex=$H.getRes($I))?($H.keepCache(this,$I),this.onloaded()):$n.imgMgrLoad($I,this._loadImageComplete.bind(this),2,!1))})})(),function($I){function $M(){this.type=null,$M.__super.call(this),this.visible=!1}$c($M,"laya.html.dom.HTMLLinkElement",$I);var $E=$M.prototype;$E._onload=function($I){switch(this.type){case"text/css":$d.parseCSS($I,this.URI)}},$f(0,$E,"href",$I.prototype._$get_href,function($I){var $M=this;$I=this.formatURL($I),this.URI=new $N($I);var $E=new $H;$E.once("complete",null,function($I){$M._onload($I)}),$E.load($I,"text")}),$M._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}($g),function($I){function $M(){$M.__super.call(this),this.visible=!1}$c($M,"laya.html.dom.HTMLStyleElement",$I),$f(0,$M.prototype,"text",$I.prototype._$get_text,function($I){$d.parseCSS($I,null)})}($g),function($I){function $M(){$M.__super.call(this),this._getCSSStyle().valign="middle"}$c($M,"laya.html.dom.HTMLIframeElement",$I),$f(0,$M.prototype,"href",$I.prototype._$get_href,function($E){var $Z=this;$E=this.formatURL($E);var $I=new $H;$I.once("complete",null,function($I){var $M=$Z.URI;$Z.URI=new $N($E),$Z.innerHTML=$I,!$M||($Z.URI=$M)}),$I.load($E,"text")})}($M)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($I,$M){"use strict";for(var $E in Object.defineProperty($M,"__esModule",{value:!0}),Laya){var $Z=Laya[$E];$Z&&$Z.__isclass&&($M[$E]=$Z)}}),function($i,$I,$V){$V.un,$V.uns;var $Z=$V.static,$n=$V.class,$c=$V.getset,$E=($V.__newvec,laya.display.Animation),$u=(laya.utils.Browser,laya.utils.ClassUtils),$f=laya.filters.ColorFilter,$d=laya.utils.Ease,$H=laya.events.Event,$B=(laya.events.EventDispatcher,laya.display.css.Font),$A=laya.display.FrameAnimation,$M=laya.display.Graphics,$Q=laya.utils.Handler,$p=laya.display.Input,$y=laya.net.Loader,$t=(laya.display.Node,laya.maths.Point),$N=laya.maths.Rectangle,$$=laya.renders.Render,$w=laya.display.Sprite,$g=laya.display.Text,$O=laya.resource.Texture,$a=laya.utils.Tween,$m=laya.utils.Utils,$j=laya.utils.WeakObject;$V.interface("laya.ui.IItem"),$V.interface("laya.ui.ISelect"),$V.interface("laya.ui.IRender"),$V.interface("laya.ui.IComponent"),$V.interface("laya.ui.IBox","IComponent");var $T=function(){function $I(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return $n($I,"laya.ui.LayoutStyle"),$Z($I,["EMPTY",function(){return this.EMPTY=new $I}]),$I}(),$q=function(){function $I(){}return $n($I,"laya.ui.Styles"),$I.labelColor="#000000",$I.buttonStateNum=3,$I.scrollBarMinNum=15,$I.scrollBarDelayTime=500,$Z($I,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),$I}(),$v=function(){function $i(){}return $n($i,"laya.ui.UIUtils"),$i.fillArray=function($I,$M,$E){var $Z=$I.concat();if($M)for(var $i=$M.split(","),$n=0,$c=Math.min($Z.length,$i.length);$n<$c;$n++){var $f=$i[$n];$Z[$n]="true"==$f||"false"!=$f&&$f,null!=$E&&($Z[$n]=$E($f))}return $Z},$i.toColor=function($I){return $m.toHexColor($I)},$i.gray=function($I,$M){void 0===$M&&($M=!0),$M?$i.addFilter($I,$i.grayFilter):$i.clearFilter($I,$f)},$i.addFilter=function($I,$M){var $E=$I.filters||[];$E.push($M),$I.filters=$E},$i.clearFilter=function($I,$M){var $E=$I.filters;if(null!=$E&&0<$E.length){for(var $Z=$E.length-1;-1<$Z;$Z--){var $i=$E[$Z];$V.__typeof($i,$M)&&$E.splice($Z,1)}$I.filters=$E}},$i._getReplaceStr=function($I){return $i.escapeSequence[$I]},$i.adptString=function($I){return $I.replace(/\\(\w)/g,$i._getReplaceStr)},$i.getBindFun=function($I){var $M=$i._funMap.get($I);if(null==$M){var $E='"'+$I+'"',$Z="(function(data){if(data==null)return;with(data){try{\nreturn "+($E=$E.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";$M=$V._runScript($Z),$i._funMap.set($I,$M)}return $M},$Z($i,["grayFilter",function(){return this.grayFilter=new $f([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new $j}]),$i}(),$W=function(){function $I(){}return $n($I,"UIConfig"),$I.touchScrollEnable=!0,$I.mouseWheelEnable=!0,$I.showButtons=!0,$I.popupBgColor="#000000",$I.popupBgAlpha=.5,$I.closeDialogOnSide=!0,$I}(),$R=function($E){function $N(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,$N.__super.call(this),this._weakKeys=[]}$n($N,"laya.ui.AutoBitmap",$E);var $I=$N.prototype;return $I.destroy=function(){if($y.clearObject(this,this._weakKey),this._weakKeys){for(var $I=0,$M=this._weakKeys.length;$I<$M;++$I)$y.clearObject(this,this._weakKeys[$I]);this._weakKeys=null}$E.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},$I._setChanged=function(){this._isChanged||(this._isChanged=!0,$V.timer.callLater(this,this.changeSource))},$I.changeSource=function(){this._isChanged=!1;var $I=this._source;if($I&&$I.bitmap){var $M=this.width,$E=this.height,$Z=this._sizeGrid,$i=$I.sourceWidth,$n=$I.sourceHeight;if(!$Z||$i===$M&&$n===$E)this.cleanByTexture($I,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,$M,$E);else{$y.clearObject(this,this._weakKey),$I.$_GID||($I.$_GID=$m.getGID());var $c=$I.$_GID+"."+$M+"."+$E+"."+$Z.join("."),$f=$y.findObject($c);if($m.isOKCmdList($f))return this._weakKey=$c,$y.keepObject(this,this._weakKey),void(this.cmds=$f);this.clear();var $d,$H,$B=$Z[0],$A=$Z[1],$Q=$Z[2],$p=$Z[3],$t=$Z[4],$V=!1;if($M==$i&&($p=$A=0),$E==$n&&($B=$Q=0),$M<$p+$A){var $u=$M;$V=!0,$M=$p+$A,this.save(),this.clipRect(0,0,$u,$E)}$p&&$B&&($d=$N.getTexture($I,0,0,$p,$B),$H=this._weakKeys[0],$d?($H!=$d.weakKey&&($y.clearObject(this,$H),$y.keepObject(this,$d.weakKey),this._weakKeys[0]=$d.weakKey),this.drawTexture($d,0,0,$p,$B)):($y.clearObject(this,$H),this._weakKeys[0]="")),$A&&$B&&($d=$N.getTexture($I,$i-$A,0,$A,$B),$H=this._weakKeys[1],$d?($H!=$d.weakKey&&($y.clearObject(this,$H),$y.keepObject(this,$d.weakKey),this._weakKeys[1]=$d.weakKey),this.drawTexture($d,$M-$A,0,$A,$B)):($y.clearObject(this,$H),this._weakKeys[1]="")),$p&&$Q&&($d=$N.getTexture($I,0,$n-$Q,$p,$Q),$H=this._weakKeys[2],$d?($H!=$d.weakKey&&($y.clearObject(this,$H),$y.keepObject(this,$d.weakKey),this._weakKeys[2]=$d.weakKey),this.drawTexture($d,0,$E-$Q,$p,$Q)):($y.clearObject(this,$H),this._weakKeys[2]="")),$A&&$Q&&($d=$N.getTexture($I,$i-$A,$n-$Q,$A,$Q),$H=this._weakKeys[3],$d?($H!=$d.weakKey&&($y.clearObject(this,$H),$y.keepObject(this,$d.weakKey),this._weakKeys[3]=$d.weakKey),this.drawTexture($d,$M-$A,$E-$Q,$A,$Q)):($y.clearObject(this,$H),this._weakKeys[3]="")),$B&&($d=$N.getTexture($I,$p,0,$i-$p-$A,$B),$H=this._weakKeys[4],$d?($H!=$d.weakKey&&($y.clearObject(this,$H),$y.keepObject(this,$d.weakKey),this._weakKeys[4]=$d.weakKey),this.drawBitmap($t,$d,$p,0,$M-$p-$A,$B)):($y.clearObject(this,$H),this._weakKeys[4]="")),$Q&&($d=$N.getTexture($I,$p,$n-$Q,$i-$p-$A,$Q),$H=this._weakKeys[5],$d?($H!=$d.weakKey&&($y.clearObject(this,$H),$y.keepObject(this,$d.weakKey),this._weakKeys[5]=$d.weakKey),this.drawBitmap($t,$d,$p,$E-$Q,$M-$p-$A,$Q)):($y.clearObject(this,$H),this._weakKeys[5]="")),$p&&($d=$N.getTexture($I,0,$B,$p,$n-$B-$Q),$H=this._weakKeys[6],$d?($H!=$d.weakKey&&($y.clearObject(this,$H),$y.keepObject(this,$d.weakKey),this._weakKeys[6]=$d.weakKey),this.drawBitmap($t,$d,0,$B,$p,$E-$B-$Q)):($y.clearObject(this,$H),this._weakKeys[6]="")),$A&&($d=$N.getTexture($I,$i-$A,$B,$A,$n-$B-$Q),$H=this._weakKeys[7],$d?($H!=$d.weakKey&&($y.clearObject(this,$H),$y.keepObject(this,$d.weakKey),this._weakKeys[7]=$d.weakKey),this.drawBitmap($t,$d,$M-$A,$B,$A,$E-$B-$Q)):($y.clearObject(this,$H),this._weakKeys[7]="")),$d=$N.getTexture($I,$p,$B,$i-$p-$A,$n-$B-$Q),$H=this._weakKeys[8],$d?($H!=$d.weakKey&&($y.clearObject(this,$H),$y.keepObject(this,$d.weakKey),this._weakKeys[8]=$d.weakKey),this.drawBitmap($t,$d,$p,$B,$M-$p-$A,$E-$B-$Q)):($y.clearObject(this,$H),this._weakKeys[8]=""),$V&&this.restore(),this.autoCacheCmd&&!$$.isConchApp&&($y.saveObject($c,this.cmds,null),this._weakKey=$c,$y.keepObject(this,this._weakKey))}this._repaint()}},$I.drawBitmap=function($I,$M,$E,$Z,$i,$n){void 0===$i&&($i=0),void 0===$n&&($n=0),$i<.1||$n<.1||(!$I||$M.width==$i&&$M.height==$n?this.drawTexture($M,$E,$Z,$i,$n):this.fillTexture($M,$E,$Z,$i,$n))},$I.clear=function($I){void 0===$I&&($I=!0),$E.prototype.clear.call(this,!1)},$c(0,$I,"sizeGrid",function(){return this._sizeGrid},function($I){this._sizeGrid=$I,this._setChanged()}),$c(0,$I,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function($I){this._width!=$I&&(this._width=$I,this._setChanged())}),$c(0,$I,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function($I){this._height!=$I&&(this._height=$I,this._setChanged())}),$c(0,$I,"source",function(){return this._source},function($I){$I?(this._source=$I,this._setChanged()):(this._source=null,this.clear())}),$N.getTexture=function($I,$M,$E,$Z,$i){$Z<=0&&($Z=1),$i<=0&&($i=1),$I.$_GID||($I.$_GID=$m.getGID());var $n=$I.$_GID+"."+$M+"."+$E+"."+$Z+"."+$i,$c=$y.findObject($n);if((!$c||!$c.source)&&($c=$O.createFromTexture($I,$M,$E,$Z,$i))){if($I.alphaTexture){var $f=$I.width/$I.alphaTexture.width;$c.alphaTexture=$O.createFromTexture($I.alphaTexture,$M/$f,$E/$f,$Z/$f,$i/$f)}$y.saveObject($n,$c),$c.weakKey=$n}return $c},$N}($M),$z=(function($I){function $M(){$M.__super.call(this)}$n($M,"laya.ui.UIEvent",$H),$M.SHOW_TIP="showtip",$M.HIDE_TIP="hidetip"}(),function($M){function $I(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,$I.__super.call(this),this._layout=$T.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}$n($I,"laya.ui.Component",$M);var $E=$I.prototype;return $V.imps($E,{"laya.ui.IComponent":!0}),$E.destroy=function($I){void 0===$I&&($I=!0),$M.prototype.destroy.call(this,$I),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},$E.preinitialize=function(){},$E.createChildren=function(){},$E.initialize=function(){},$E.callLater=function($I,$M){$V.timer.callLater(this,$I,$M)},$E.runCallLater=function($I){$V.timer.runCallLater(this,$I)},$E.commitMeasure=function(){},$E.changeSize=function(){this.event("resize")},$E.getLayout=function(){return this._layout===$T.EMPTY&&(this._layout=new $T),this._layout},$E._setLayoutEnabled=function($I){this._layout&&this._layout.enable!=$I&&(this._layout.enable=$I,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},$E.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},$E.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},$E.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},$E.resetLayoutX=function(){var $I=this._layout;if(isNaN($I.anchorX)||(this.pivotX=$I.anchorX*this.width),this.layoutEnabled){var $M=this.parent;$M&&(isNaN($I.centerX)?isNaN($I.left)?isNaN($I.right)||(this.x=Math.round($M.width-this.displayWidth-$I.right+this.pivotX*this.scaleX)):(this.x=Math.round($I.left+this.pivotX*this.scaleX),isNaN($I.right)||(this.width=($M._width-$I.left-$I.right)/(this.scaleX||.01))):this.x=Math.round(.5*($M.width-this.displayWidth)+$I.centerX+this.pivotX*this.scaleX))}},$E.resetLayoutY=function(){var $I=this._layout;if(isNaN($I.anchorY)||(this.pivotY=$I.anchorY*this.height),this.layoutEnabled){var $M=this.parent;$M&&(isNaN($I.centerY)?isNaN($I.top)?isNaN($I.bottom)||(this.y=Math.round($M.height-this.displayHeight-$I.bottom+this.pivotY*this.scaleY)):(this.y=Math.round($I.top+this.pivotY*this.scaleY),isNaN($I.bottom)||(this.height=($M._height-$I.top-$I.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*($M.height-this.displayHeight)+$I.centerY+this.pivotY*this.scaleY))}},$E.onMouseOver=function($I){$V.stage.event("showtip",this._toolTip)},$E.onMouseOut=function($I){$V.stage.event("hidetip",this._toolTip)},$c(0,$E,"displayWidth",function(){return this.width*this.scaleX}),$c(0,$E,"width",function(){return this._width?this._width:this.measureWidth},function($I){this._width!=$I&&(this._width=$I,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),$c(0,$E,"measureWidth",function(){var $I=0;this.commitMeasure();for(var $M=this.numChildren-1;-1<$M;$M--){var $E=this.getChildAt($M);$E.visible&&($I=Math.max($E.x+$E.width*$E.scaleX,$I))}return $I}),$c(0,$E,"displayHeight",function(){return this.height*this.scaleY}),$c(0,$E,"height",function(){return this._height?this._height:this.measureHeight},function($I){this._height!=$I&&(this._height=$I,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),$c(0,$E,"dataSource",function(){return this._dataSource},function($I){for(var $M in this._dataSource=$I,this._dataSource)this.hasOwnProperty($M)&&"function"!=typeof this[$M]&&(this[$M]=this._dataSource[$M])}),$c(0,$E,"scaleY",$M.prototype._$get_scaleY,function($I){$V.superGet($w,this,"scaleY")!=$I&&($V.superSet($w,this,"scaleY",$I),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),$c(0,$E,"measureHeight",function(){var $I=0;this.commitMeasure();for(var $M=this.numChildren-1;-1<$M;$M--){var $E=this.getChildAt($M);$E.visible&&($I=Math.max($E.y+$E.height*$E.scaleY,$I))}return $I}),$c(0,$E,"scaleX",$M.prototype._$get_scaleX,function($I){$V.superGet($w,this,"scaleX")!=$I&&($V.superSet($w,this,"scaleX",$I),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),$c(0,$E,"top",function(){return this._layout.top},function($I){$I!=this._layout.top&&(this.getLayout().top=$I,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$c(0,$E,"bottom",function(){return this._layout.bottom},function($I){$I!=this._layout.bottom&&(this.getLayout().bottom=$I,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$c(0,$E,"left",function(){return this._layout.left},function($I){$I!=this._layout.left&&(this.getLayout().left=$I,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$c(0,$E,"right",function(){return this._layout.right},function($I){$I!=this._layout.right&&(this.getLayout().right=$I,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$c(0,$E,"centerX",function(){return this._layout.centerX},function($I){$I!=this._layout.centerX&&(this.getLayout().centerX=$I,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$c(0,$E,"centerY",function(){return this._layout.centerY},function($I){$I!=this._layout.centerY&&(this.getLayout().centerY=$I,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$c(0,$E,"anchorX",function(){return this._layout.anchorX},function($I){$I!=this._layout.anchorX&&(this.getLayout().anchorX=$I,this._setLayoutEnabled(!0)),this.resetLayoutX()}),$c(0,$E,"anchorY",function(){return this._layout.anchorY},function($I){$I!=this._layout.anchorY&&(this.getLayout().anchorY=$I,this._setLayoutEnabled(!0)),this.resetLayoutY()}),$c(0,$E,"tag",function(){return this._tag},function($I){this._tag=$I}),$c(0,$E,"toolTip",function(){return this._toolTip},function($I){this._toolTip!=$I&&(null!=(this._toolTip=$I)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),$c(0,$E,"comXml",function(){return this._comXml},function($I){this._comXml=$I}),$c(0,$E,"gray",function(){return this._gray},function($I){$I!==this._gray&&(this._gray=$I,$v.gray(this,$I))}),$c(0,$E,"disabled",function(){return this._disabled},function($I){$I!==this._disabled&&(this.gray=this._disabled=$I,this.mouseEnabled=!$I)}),$I}($w)),$L=function($I){function $M(){this.lockLayer=null,this.popupEffect=function($I){$I.scale(1,1),$a.from($I,{x:$V.stage.width/2,y:$V.stage.height/2,scaleX:0,scaleY:0},300,$d.backOut,$Q.create(this,this.doOpen,[$I]))},this.closeEffect=function($I,$M){$a.to($I,{x:$V.stage.width/2,y:$V.stage.height/2,scaleX:0,scaleY:0},300,$d.strongOut,$Q.create(this,this.doClose,[$I,$M]))},$M.__super.call(this),this.maskLayer=new $w,this.popupEffectHandler=$Q.create(this,this.popupEffect,null,!1),this.closeEffectHandler=$Q.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,$V.stage.addChild(this),$V.stage.on("resize",this,this._onResize),$W.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}$n($M,"laya.ui.DialogManager",$w);var $E=$M.prototype;return $E._closeOnSide=function(){var $I=this.getChildAt(this.numChildren-1);$I instanceof laya.ui.Dialog&&$I.close("side")},$E.setLockView=function($I){this.lockLayer||(this.lockLayer=new $o,this.lockLayer.mouseEnabled=!0,this.lockLayer.size($V.stage.width,$V.stage.height)),this.lockLayer.removeChildren(),$I&&($I.centerX=$I.centerY=0,this.lockLayer.addChild($I))},$E._onResize=function($I){var $M=this.maskLayer.width=$V.stage.width,$E=this.maskLayer.height=$V.stage.height;this.lockLayer&&this.lockLayer.size($M,$E),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,$M,$E,$W.popupBgColor),this.maskLayer.alpha=$W.popupBgAlpha;for(var $Z=this.numChildren-1;-1<$Z;$Z--){var $i=this.getChildAt($Z);$i.popupCenter&&this._centerDialog($i)}},$E._centerDialog=function($I){$I.x=Math.round(($V.stage.width-$I.width>>1)+$I.pivotX),$I.y=Math.round(($V.stage.height-$I.height>>1)+$I.pivotY)},$E.open=function($I,$M,$E){void 0===$M&&($M=!1),void 0===$E&&($E=!1),$M&&this._closeAll(),$I.popupCenter&&this._centerDialog($I),this.addChild($I),($I.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),$E&&null!=$I.popupEffect?$I.popupEffect.runWith($I):this.doOpen($I),this.event("open")},$E.doOpen=function($I){$I.onOpened()},$E.lock=function($I){this.lockLayer&&($I?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},$E.close=function($I,$M,$E){void 0===$E&&($E=!1),$E&&null!=$I.closeEffect?$I.closeEffect.runWith([$I,$M]):this.doClose($I,$M),this.event("close")},$E.doClose=function($I,$M){$I.removeSelf(),$I.isModal&&this._checkMask(),$I.closeHandler&&$I.closeHandler.runWith($M),$I.onClosed($M)},$E.closeAll=function(){this._closeAll(),this.event("close")},$E._closeAll=function(){for(var $I=this.numChildren-1;-1<$I;$I--){var $M=this.getChildAt($I);$M&&null!=$M.close&&this.doClose($M)}},$E.getDialogsByGroup=function($I){for(var $M=[],$E=this.numChildren-1;-1<$E;$E--){var $Z=this.getChildAt($E);$Z&&$Z.group===$I&&$M.push($Z)}return $M},$E.closeByGroup=function($I){for(var $M=[],$E=this.numChildren-1;-1<$E;$E--){var $Z=this.getChildAt($E);$Z&&$Z.group===$I&&($Z.close(),$M.push($Z))}return $M},$E._checkMask=function(){this.maskLayer.removeSelf();for(var $I=this.numChildren-1;-1<$I;$I--){var $M=this.getChildAt($I);if($M&&$M.isModal)return void this.addChildAt(this.maskLayer,$I)}},$M}(),$o=function($I){function $M(){$M.__super.call(this)}$n($M,"laya.ui.Box",$I);var $E=$M.prototype;return $V.imps($E,{"laya.ui.IBox":!0}),$c(0,$E,"dataSource",$I.prototype._$get_dataSource,function($I){for(var $M in this._dataSource=$I){var $E=this.getChildByName($M);$E?$E.dataSource=$I[$M]:this.hasOwnProperty($M)&&"function"!=typeof this[$M]&&(this[$M]=$I[$M])}}),$M}($z),$S=function($M){function $E($I,$M){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,$E.__super.call(this),this._labelColors=$q.buttonLabelColors,this._stateNum=$q.buttonStateNum,void 0===$M&&($M=""),this.skin=$I,this.label=$M}$n($E,"laya.ui.Button",$M);var $I=$E.prototype;return $V.imps($I,{"laya.ui.ISelect":!0}),$I.destroy=function($I){this.clearEvent(),$y.clearCache(this,this._skin),$y.clearObject(this,this._weakKey),void 0===$I&&($I=!0),$M.prototype.destroy.call(this,$I),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy($I),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},$I.clearEvent=function(){this._skin&&$i.atalsNotify&&$i.atalsNotify.off(this._skin,this,this._setBtnSource)},$I.createChildren=function(){this.graphics=this._bitmap=new $R},$I.createText=function(){this._text||(this._text=new $g,this._text.overflow=$g.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},$I.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},$I.onMouse=function($I){if(!1!==this.toggle||!this._selected)return"click"===$I.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=$E.stateMap[$I.type]))},$I.changeClips=function(){var $I=$y.getRes(this._skin);if($I)if(this._skin&&""!=this._skin){$y.clearObject(this,this._weakKey);var $M=$I.sourceWidth,$E=$I.sourceHeight/this._stateNum;$I.$_GID||($I.$_GID=$m.getGID());var $Z=$I.$_GID+"-"+this._stateNum,$i=$y.findObject($Z);if($m.isOkTextureList($i)||($i=null),$i)this._weakKey=$Z,$y.keepObject(this,this._weakKey),this._sources=$i;else{if(this._sources=[],1===this._stateNum)this._sources.push($I);else for(var $n=0;$n<this._stateNum;$n++){var $c=$O.createFromTexture($I,0,$E*$n,$M,$E);if($I.alphaTexture){var $f=$I.width/$I.alphaTexture.width;$c.alphaTexture=$O.createFromTexture($I.alphaTexture,0/$f,$E*$n/$f,$M/$f,$E/$f)}this._sources.push($c)}$y.saveObject($Z,this._sources),this._weakKey=$Z,$y.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||$M,this._bitmap.height=this._height||$E,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=$M)}else console.warn("lose skin ",this._skin,this.name,this.__className)},$I.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var $I=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[$I]),this.label&&(this._text.color=this._labelColors[$I],this._strokeColors&&(this._text.strokeColor=this._strokeColors[$I]))},$I._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},$c(0,$I,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function($I){this.createText(),this._text.strokeColor=$I}),$c(0,$I,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),$c(0,$I,"skin",function(){return this._skin},function($I){if(this._skin!=$I)if(this.clearEvent(),$y.clearCache(this,this._skin),this._skin=$I,$y.keepCache(this,this._skin),$y.getRes(this._skin))this.callLater(this.changeClips),this._setStateChanged();else{var $M=$i.resAtalsObj&&$i.resAtalsObj[this._skin];$M?($i.atalsNotify&&$i.atalsNotify.once(this._skin,this,this._setBtnSource),0==this.width&&(this.width=$M.sourceW),0==this.height&&(this.height=$M.sourceH/this._stateNum)):console.warn("lose button skin ",this._skin,this.name,this.__className)}}),$I._setBtnSource=function($I,$M){$I===this._skin&&$M&&(this.callLater(this.changeClips),this._setStateChanged(),this.clearEvent())},$c(0,$I,"state",function(){return this._state},function($I){this._state!=$I&&(this._state=$I,this._setStateChanged())}),$c(0,$I,"text",function(){return this.createText(),this._text}),$c(0,$I,"stateNum",function(){return this._stateNum},function($I){"string"==typeof $I&&($I=parseInt($I)),this._stateNum!=$I&&(this._stateNum=$I<1?1:3<$I?3:$I,this.callLater(this.changeClips))}),$c(0,$I,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function($I){this._strokeColors=$v.fillArray($q.buttonLabelColors,$I,String),this._setStateChanged()}),$c(0,$I,"labelColors",function(){return this._labelColors.join(",")},function($I){this._labelColors=$v.fillArray($q.buttonLabelColors,$I,String),this._setStateChanged()}),$c(0,$I,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),$c(0,$I,"label",function(){return this._text?this._text.text:null},function($I){(this._text||$I)&&(this.createText(),this._text.text!=$I&&($I&&!this._text.parent&&this.addChild(this._text),this._text.text=($I+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),$c(0,$I,"selected",function(){return this._selected},function($I){this._selected!=$I&&(this._selected=$I,this.state=this._selected?2:0,this.event("change"))}),$c(0,$I,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function($I){this.createText(),this._text.padding=$v.fillArray($q.labelPadding,$I,Number)}),$c(0,$I,"labelSize",function(){return this.createText(),this._text.fontSize},function($I){this.createText(),this._text.fontSize=$I}),$c(0,$I,"labelStroke",function(){return this.createText(),this._text.stroke},function($I){this.createText(),this._text.stroke=$I}),$c(0,$I,"labelBold",function(){return this.createText(),this._text.bold},function($I){this.createText(),this._text.bold=$I}),$c(0,$I,"labelFont",function(){return this.createText(),this._text.font},function($I){this.createText(),this._text.font=$I}),$c(0,$I,"labelAlign",function(){return this.createText(),this._text.align},function($I){this.createText(),this._text.align=$I}),$c(0,$I,"clickHandler",function(){return this._clickHandler},function($I){this._clickHandler=$I}),$c(0,$I,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($I){this._bitmap.sizeGrid=$v.fillArray($q.defaultSizeGrid,$I,Number)}),$c(0,$I,"width",$M.prototype._$get_width,function($I){$V.superSet($z,this,"width",$I),this._autoSize&&(this._bitmap.width=$I,this._text&&(this._text.width=$I))}),$c(0,$I,"height",$M.prototype._$get_height,function($I){$V.superSet($z,this,"height",$I),this._autoSize&&(this._bitmap.height=$I,this._text&&(this._text.height=$I))}),$c(0,$I,"dataSource",$M.prototype._$get_dataSource,function($I){"number"==typeof(this._dataSource=$I)||"string"==typeof $I?this.label=$I+"":$V.superSet($z,this,"dataSource",$I)}),$c(0,$I,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function($I){this._bitmap._offset=$I?$v.fillArray([1,1],$I,Number):[]}),$Z($E,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),$E}($z),$X=function($M){function $Z($I,$M,$E){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,this._complete=null,this._progress=null,$Z.__super.call(this),void 0===$M&&($M=1),void 0===$E&&($E=1),this._clipX=$M,this._clipY=$E,this.skin=$I}$n($Z,"laya.ui.Clip",$M);var $I=$Z.prototype;return $I.destroy=function($I){this.clearEvent(),this.clearLoad(),$y.clearCache(this,this._skin),$y.clearObject(this,this._weakKey),void 0===$I&&($I=!0),$M.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},$I.dispose=function(){this.destroy(!0),$V.loader.clearRes(this._skin)},$I.createChildren=function(){this.graphics=this._bitmap=new $R},$I._onDisplay=function($I){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},$I.changeClip=function(){if(this._clipChanged=!1,this._skin){var $I=$y.getRes(this._skin);if($I)this.loadComplete(this._skin,$I);else{if($i.resAtalsObj&&$i.resAtalsObj[this._skin])return;this.clearLoad(),this._complete=$Q.create(this,this.loadComplete,[this._skin]),this._progress=null,$V.loader.load(this._skin,this._complete,this._progress)}}},$I.loadComplete=function($I,$M){if($I===this._skin&&$M){$y.clearObject(this,this._weakKey);var $E=this._clipWidth||Math.ceil($M.sourceWidth/this._clipX),$Z=this._clipHeight||Math.ceil($M.sourceHeight/this._clipY),$i=this._skin+$E+$Z,$n=$y.findObject($i);if($m.isOkTextureList($n)||($n=null),$n)this._weakKey=$i,$y.keepObject(this,this._weakKey),this._sources=$n;else{this._sources=[];for(var $c=0;$c<this._clipY;$c++)for(var $f=0;$f<this._clipX;$f++){var $d=$O.createFromTexture($M,$E*$f,$Z*$c,$E,$Z);if($M.alphaTexture){var $H=$M.width/$M.alphaTexture.width;$d.alphaTexture=$O.createFromTexture($M.alphaTexture,$E*$f/$H,$Z*$c/$H,$E/$H,$Z/$H)}this._sources.push($d)}$y.saveObject($i,this._sources),this._weakKey=$i,$y.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},$I.play=function($I,$M){void 0===$I&&($I=0),void 0===$M&&($M=-1),this._isPlaying=!0,this.index=$I,this._toIndex=$M,this._index++,$V.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},$I._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},$I.stop=function(){this._isPlaying=!1,$V.timer.clear(this,this._loop),this.event("complete")},$I._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},$c(0,$I,"interval",function(){return this._interval},function($I){this._interval!=$I&&(this._interval=$I,this._isPlaying&&this.play())}),$I.clearEvent=function(){this._skin&&$i.atalsNotify&&$i.atalsNotify.off(this._skin,this,this._setBtnSource)},$I.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$V.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$c(0,$I,"skin",function(){return this._skin},function($I){if(this._skin!=$I)if(this.clearLoad(),this.clearEvent(),$y.clearCache(this,this._skin),this._skin=$I){$y.keepCache(this,this._skin);var $M=$y.getRes($I),$E=$i.resAtalsObj&&$i.resAtalsObj[this._skin];!$M&&$E?$i.atalsNotify&&$i.atalsNotify.once(this._skin,this,this._setBtnSource):this._setClipChanged()}else this._bitmap.source=null}),$I._setBtnSource=function($I,$M){$I===this._skin&&$M&&(this.loadComplete($I,$M),this.clearEvent())},$c(0,$I,"sources",function(){return this._sources},function($I){this._sources=$I,this.index=this._index,this.event("loaded")}),$c(0,$I,"clipX",function(){return this._clipX},function($I){this._clipX=$I||1,this._setClipChanged()}),$c(0,$I,"clipY",function(){return this._clipY},function($I){this._clipY=$I||1,this._setClipChanged()}),$c(0,$I,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),$c(0,$I,"clipWidth",function(){return this._clipWidth},function($I){this._clipWidth=$I,this._setClipChanged()}),$c(0,$I,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($I){this._bitmap.sizeGrid=$v.fillArray($q.defaultSizeGrid,$I,Number)}),$c(0,$I,"group",function(){return this._group},function($I){$I&&this._skin&&$y.setGroup(this._skin,$I),this._group=$I}),$c(0,$I,"clipHeight",function(){return this._clipHeight},function($I){this._clipHeight=$I,this._setClipChanged()}),$c(0,$I,"width",$M.prototype._$get_width,function($I){$V.superSet($z,this,"width",$I),this._bitmap.width=$I}),$c(0,$I,"height",$M.prototype._$get_height,function($I){$V.superSet($z,this,"height",$I),this._bitmap.height=$I}),$c(0,$I,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),$c(0,$I,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),$c(0,$I,"index",function(){return this._index},function($I){this._index=$I,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[$I]),this.event("change")}),$c(0,$I,"autoPlay",function(){return this._autoPlay},function($I){this._autoPlay!=$I&&((this._autoPlay=$I)?this.play():this.stop())}),$c(0,$I,"isPlaying",function(){return this._isPlaying},function($I){this._isPlaying=$I}),$c(0,$I,"dataSource",$M.prototype._$get_dataSource,function($I){"number"==typeof(this._dataSource=$I)&&Math.floor($I)==$I||"string"==typeof $I?this.index=parseInt($I):$V.superSet($z,this,"dataSource",$I)}),$c(0,$I,"bitmap",function(){return this._bitmap}),$Z}($z),$C=function($M){function $I(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,$I.__super.call(this)}$n($I,"laya.ui.ColorPicker",$M);var $E=$I.prototype;return $E.destroy=function($I){void 0===$I&&($I=!0),$M.prototype.destroy.call(this,$I),this._colorPanel&&this._colorPanel.destroy($I),this._colorButton&&this._colorButton.destroy($I),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},$E.createChildren=function(){this.addChild(this._colorButton=new $S),this._colorPanel=new $o,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new $w),this._colorPanel.addChild(this._colorBlock=new $w),this._colorPanel.addChild(this._colorInput=new $p)},$E.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},$E.onPanelMouseDown=function($I){$I.stopPropagation()},$E.changePanel=function(){this._panelChanged=!1;var $I=this._colorPanel.graphics;$I.clear(),$I.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,($I=this._colorTiles.graphics).clear();for(var $M=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],$E=0;$E<12;$E++)for(var $Z=0;$Z<20;$Z++){var $i=0;$i=0===$Z?$M[$E]:1===$Z?0:51*(((3*$E+$Z/6)%3<<0)+3*($E/6<<0))<<16|$Z%6*51<<8|($E<<0)%6*51;var $n=$v.toColor($i);this._colors.push($n);var $c=$Z*this._gridSize,$f=$E*this._gridSize;$I.drawRect($c,$f,this._gridSize,this._gridSize,$n,"#000000")}},$E.onColorButtonClick=function($I){this._colorPanel.parent?this.close():this.open()},$E.open=function(){var $I=this.localToGlobal(new $t),$M=$I.x+this._colorPanel.width<=$V.stage.width?$I.x:$V.stage.width-this._colorPanel.width,$E=$I.y+this._colorButton.height;$E=$E+this._colorPanel.height<=$V.stage.height?$E:$I.y-this._colorPanel.height,this._colorPanel.pos($M,$E),this._colorPanel.zOrder=1001,$V._currentStage.addChild(this._colorPanel),$V.stage.on("mousedown",this,this.removeColorBox)},$E.close=function(){$V.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},$E.removeColorBox=function($I){this.close()},$E.onColorFieldKeyDown=function($I){13==$I.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),$I.stopPropagation())},$E.onColorInputChange=function($I){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},$E.onColorTilesClick=function($I){this.selectedColor=this.getColorByMouse(),this.close()},$E.onColorTilesMouseMove=function($I){this._colorInput.focus=!1;var $M=this.getColorByMouse();this._colorInput.text=$M,this.drawBlock($M)},$E.getColorByMouse=function(){var $I=this._colorTiles.getMousePoint(),$M=Math.floor($I.x/this._gridSize),$E=Math.floor($I.y/this._gridSize);return this._colors[20*$E+$M]},$E.drawBlock=function($I){var $M=this._colorBlock.graphics;$M.clear();var $E=$I||"#ffffff";$M.drawRect(0,0,50,20,$E,this._borderColor),$I||$M.drawLine(0,0,50,20,"#ff0000")},$E.changeColor=function(){var $I=this.graphics;$I.clear();var $M=this._selectedColor||"#000000";$I.drawRect(0,0,this._colorButton.width,this._colorButton.height,$M)},$E._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},$c(0,$E,"inputBgColor",function(){return this._inputBgColor},function($I){this._inputBgColor=$I,this._setPanelChanged()}),$c(0,$E,"selectedColor",function(){return this._selectedColor},function($I){this._selectedColor!=$I&&(this._selectedColor=this._colorInput.text=$I,this.drawBlock($I),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",$H.EMPTY.setTo("change",this,this)))}),$c(0,$E,"skin",function(){return this._colorButton.skin},function($I){this._colorButton.skin=$I,this.changeColor()}),$c(0,$E,"bgColor",function(){return this._bgColor},function($I){this._bgColor=$I,this._setPanelChanged()}),$c(0,$E,"borderColor",function(){return this._borderColor},function($I){this._borderColor=$I,this._setPanelChanged()}),$c(0,$E,"inputColor",function(){return this._inputColor},function($I){this._inputColor=$I,this._setPanelChanged()}),$I}($z),$J=function($M){function $E($I,$M){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,$E.__super.call(this),this._itemColors=$q.comboBoxItemColors,this.skin=$I,this.labels=$M}$n($E,"laya.ui.ComboBox",$M);var $I=$E.prototype;return $I.destroy=function($I){void 0===$I&&($I=!0),$M.prototype.destroy.call(this,$I),this._button&&this._button.destroy($I),this._list&&this._list.destroy($I),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},$I.createChildren=function(){this.addChild(this._button=new $S),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},$I._createList=function(){this._list=new $D,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},$I._setListEvent=function($I){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=$Q.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},$I.onListDown=function($I){$I.stopPropagation()},$I.onScrollBarDown=function($I){$I.stopPropagation()},$I.onButtonMouseDown=function($I){this.callLater(this.switchTo,[!this._isOpen])},$I.changeList=function(){this._listChanged=!1;var $I=this.width-2,$M=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:$I,height:this._itemHeight,fontSize:this._itemSize,color:$M}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},$I.onlistItemMouse=function($I,$M){var $E=$I.type;if("mouseover"===$E||"mouseout"===$E){if(this._isCustomList)return;var $Z=this._list.getCell($M);if(!$Z)return;var $i=$Z.getChildByName("label");$i&&("mouseover"===$E?($i.bgColor=this._itemColors[0],$i.color=this._itemColors[1]):($i.bgColor=null,$i.color=this._itemColors[2]))}else"click"===$E&&(this.selectedIndex=$M,this.isOpen=!1)},$I.switchTo=function($I){this.isOpen=$I},$I.changeOpen=function(){this.isOpen=!this._isOpen},$I.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var $I=this._list.graphics;$I.clear(),$I.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var $M=this._list.array||[],$E=$M.length=0,$Z=this._labels.length;$E<$Z;$E++)$M.push({label:this._labels[$E]});this._list.height=this._listHeight,this._list.array=$M},$I.changeSelected=function(){this._button.label=this.selectedLabel},$I._onStageMouseWheel=function($I){this._list&&!this._list.contains($I.target)&&this.removeList(null)},$I.removeList=function($I){$V.stage.off("mousedown",this,this.removeList),$V.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},$c(0,$I,"selectedIndex",function(){return this._selectedIndex},function($I){this._selectedIndex!=$I&&(this._selectedIndex=$I,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[$H.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),$c(0,$I,"measureHeight",function(){return this._button.height}),$c(0,$I,"skin",function(){return this._button.skin},function($I){this._button.skin!=$I&&(this._button.skin=$I,this._listChanged=!0)}),$c(0,$I,"measureWidth",function(){return this._button.width}),$c(0,$I,"width",$M.prototype._$get_width,function($I){$V.superSet($z,this,"width",$I),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),$c(0,$I,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function($I){this.selectedIndex=this._labels.indexOf($I)}),$c(0,$I,"labels",function(){return this._labels.join(",")},function($I){0<this._labels.length&&(this.selectedIndex=-1),$I?this._labels=$I.split(","):this._labels.length=0,this._itemChanged=!0}),$c(0,$I,"height",$M.prototype._$get_height,function($I){$V.superSet($z,this,"height",$I),this._button.height=this._height}),$c(0,$I,"selectHandler",function(){return this._selectHandler},function($I){this._selectHandler=$I}),$c(0,$I,"visibleNum",function(){return this._visibleNum},function($I){this._visibleNum=$I,this._listChanged=!0}),$c(0,$I,"labelBold",function(){return this._button.text.bold},function($I){this._button.text.bold=$I}),$c(0,$I,"itemColors",function(){return String(this._itemColors)},function($I){this._itemColors=$v.fillArray(this._itemColors,$I,String),this._listChanged=!0}),$c(0,$I,"itemSize",function(){return this._itemSize},function($I){this._itemSize=$I,this._listChanged=!0}),$c(0,$I,"scrollBar",function(){return this.list.scrollBar}),$c(0,$I,"isOpen",function(){return this._isOpen},function($I){if(this._isOpen!=$I)if(this._isOpen=$I,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var $M=this.localToGlobal($t.TEMP.setTo(0,0)),$E=$M.y+this._button.height;$E=$E+this._listHeight<=$V.stage.height?$E:$M.y-this._listHeight,this._list.pos($M.x,$E),this._list.zOrder=1001,$V._currentStage.addChild(this._list),$V.stage.once("mousedown",this,this.removeList),$V.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),$c(0,$I,"scrollBarSkin",function(){return this._scrollBarSkin},function($I){this._scrollBarSkin=$I}),$c(0,$I,"sizeGrid",function(){return this._button.sizeGrid},function($I){this._button.sizeGrid=$I}),$c(0,$I,"button",function(){return this._button}),$c(0,$I,"list",function(){return this._list||this._createList(),this._list},function($I){$I&&($I.removeSelf(),this._isCustomList=!0,this._list=$I,this._setListEvent($I),this._itemHeight=$I.getCell(0).height+$I.spaceY)}),$c(0,$I,"dataSource",$M.prototype._$get_dataSource,function($I){"number"==typeof(this._dataSource=$I)&&Math.floor($I)==$I||"string"==typeof $I?this.selectedIndex=parseInt($I):$I instanceof Array?this.labels=$I.join(","):$V.superSet($z,this,"dataSource",$I)}),$c(0,$I,"labelColors",function(){return this._button.labelColors},function($I){this._button.labelColors!=$I&&(this._button.labelColors=$I)}),$c(0,$I,"labelPadding",function(){return this._button.text.padding.join(",")},function($I){this._button.text.padding=$v.fillArray($q.labelPadding,$I,Number)}),$c(0,$I,"labelSize",function(){return this._button.text.fontSize},function($I){this._button.text.fontSize=$I}),$c(0,$I,"labelFont",function(){return this._button.text.font},function($I){this._button.text.font=$I}),$c(0,$I,"stateNum",function(){return this._button.stateNum},function($I){this._button.stateNum=$I}),$E}($z),$x=function($M){function $E($I){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,$E.__super.call(this),this._showButtons=$W.showButtons,this._touchScrollEnable=$W.touchScrollEnable,this._mouseWheelEnable=$W.mouseWheelEnable,this.skin=$I,this.max=1}$n($E,"laya.ui.ScrollBar",$M);var $I=$E.prototype;return $I.destroy=function($I){void 0===$I&&($I=!0),this.stopScroll(),this.target=null,$M.prototype.destroy.call(this,$I),this.upButton&&this.upButton.destroy($I),this.downButton&&this.downButton.destroy($I),this.slider&&this.slider.destroy($I),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},$I.createChildren=function(){this.addChild(this.slider=new $k),this.addChild(this.upButton=new $S),this.addChild(this.downButton=new $S)},$I.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},$I.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},$I.onButtonMouseDown=function($I){var $M=$I.currentTarget===this.upButton;this.slide($M),$V.timer.once($q.scrollBarDelayTime,this,this.startLoop,[$M]),$V.stage.once("mouseup",this,this.onStageMouseUp)},$I.startLoop=function($I){$V.timer.frameLoop(1,this,this.slide,[$I])},$I.slide=function($I){$I?this.value-=this._scrollSize:this.value+=this._scrollSize},$I.onStageMouseUp=function($I){$V.timer.clear(this,this.startLoop),$V.timer.clear(this,this.slide)},$I.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},$I.changeSize=function(){$M.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},$I.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},$I.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},$I.setScroll=function($I,$M,$E){this.runCallLater(this.changeSize),this.slider.setSlider($I,$M,$E),this.slider.bar.visible=0<$M,!this._hide&&this.autoHide&&(this.visible=!1)},$I.onTargetMouseWheel=function($I){this.value-=$I.delta*this._scrollSize,this.target=this._target},$I.onTargetMouseDown=function($I){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new $t),this._lastPoint.setTo($V.stage.mouseX,$V.stage.mouseY),$V.timer.clear(this,this.tweenMove),$a.clearTween(this),$V.stage.once("mouseup",this,this.onStageMouseUp2),$V.stage.once("mouseout",this,this.onStageMouseUp2),$V.timer.frameLoop(1,this,this.loop)},$I.loop=function(){var $I=$V.stage.mouseY,$M=$V.stage.mouseX;if(this._lastOffset=this.isVertical?$I-this._lastPoint.y:$M-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?$V.stage._canvasTransform.getScaleY():$V.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=$M,this._lastPoint.y=$I,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},$I.onStageMouseUp2=function($I){if($V.stage.off("mouseup",this,this.onStageMouseUp2),$V.stage.off("mouseout",this,this.onStageMouseUp2),$V.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?$a.to(this,{value:this.min},this.elasticBackTime,$d.sineOut,$Q.create(this,this.elasticOver)):this._value>this.max&&$a.to(this,{value:this.max},this.elasticBackTime,$d.sineOut,$Q.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?$V.stage.mouseY-this._lastPoint.y:$V.stage.mouseX-this._lastPoint.x);for(var $M=0,$E=Math.min(this._offsets.length,3),$Z=0;$Z<$E;$Z++)$M+=this._offsets[this._offsets.length-1-$Z];if(this._lastOffset=$M/$E,($M=Math.abs(this._lastOffset))<2)return void this.event("end");60<$M&&(this._lastOffset=0<this._lastOffset?60:-60);var $i=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));$V.timer.frameLoop(1,this,this.tweenMove,[$i])}},$I.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&$a.to(this,{alpha:0},500),this.event("end")},$I.tweenMove=function($I){this._lastOffset*=this.rollRatio;var $M=NaN;if(0<$I&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,$M=.5*-(this.min-$I-this.value),this._lastOffset>$M&&(this._lastOffset=$M)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,$M=.5*-(this.max+$I-this.value),this._lastOffset<$M&&(this._lastOffset=$M))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if($V.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?$a.to(this,{value:this.min},this.elasticBackTime,$d.sineOut,$Q.create(this,this.elasticOver)):this._value>this.max?$a.to(this,{value:this.max},this.elasticBackTime,$d.sineOut,$Q.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&$a.to(this,{alpha:0},500)}},$I.stopScroll=function(){this.onStageMouseUp2(null),$V.timer.clear(this,this.tweenMove),$a.clearTween(this)},$c(0,$I,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),$c(0,$I,"skin",function(){return this._skin},function($I){this._skin!=$I&&(this._skin=$I,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),$c(0,$I,"max",function(){return this.slider.max},function($I){this.slider.max=$I}),$c(0,$I,"showButtons",function(){return this._showButtons},function($I){this._showButtons=$I,this.callLater(this.changeScrollBar)}),$c(0,$I,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),$c(0,$I,"min",function(){return this.slider.min},function($I){this.slider.min=$I}),$c(0,$I,"value",function(){return this._value},function($I){$I!==this._value&&(this._value=$I,this._isElastic||(this.slider._value!=$I&&(this.slider._value=$I,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),$c(0,$I,"isVertical",function(){return this.slider.isVertical},function($I){this.slider.isVertical=$I}),$c(0,$I,"sizeGrid",function(){return this.slider.sizeGrid},function($I){this.slider.sizeGrid=$I}),$c(0,$I,"scrollSize",function(){return this._scrollSize},function($I){this._scrollSize=$I}),$c(0,$I,"dataSource",$M.prototype._$get_dataSource,function($I){"number"==typeof(this._dataSource=$I)||"string"==typeof $I?this.value=Number($I):$V.superSet($z,this,"dataSource",$I)}),$c(0,$I,"thumbPercent",function(){return this._thumbPercent},function($I){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),$I=1<=$I?.99:$I,this._thumbPercent=$I,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*$I,$q.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*$I,$q.scrollBarMinNum))}),$c(0,$I,"target",function(){return this._target},function($I){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=$I)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),$c(0,$I,"hide",function(){return this._hide},function($I){this._hide=$I,this.visible=!$I}),$c(0,$I,"touchScrollEnable",function(){return this._touchScrollEnable},function($I){this._touchScrollEnable=$I,this.target=this._target}),$c(0,$I,"mouseWheelEnable",function(){return this._mouseWheelEnable},function($I){this._mouseWheelEnable=$I,this.target=this._target}),$c(0,$I,"tick",function(){return this.slider.tick},function($I){this.slider.tick=$I}),$E}($z),$k=function($M){function $E($I){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,$E.__super.call(this),this.skin=$I}$n($E,"laya.ui.Slider",$M);var $I=$E.prototype;return $I.destroy=function($I){void 0===$I&&($I=!0),$M.prototype.destroy.call(this,$I),this._bg&&this._bg.destroy($I),this._bar&&this._bar.destroy($I),this._progress&&this._progress.destroy($I),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},$I.createChildren=function(){this.addChild(this._bg=new $r),this.addChild(this._bar=new $S)},$I.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},$I.onBarMouseDown=function($I){this._globalSacle||(this._globalSacle=new $t),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=$V.stage.mouseX,this._ty=$V.stage.mouseY,$V.stage.on("mousemove",this,this.mouseMove),$V.stage.once("mouseup",this,this.mouseUp),$V.stage.once("mouseout",this,this.mouseUp),this.showValueText()},$I.showValueText=function(){if(this.showLabel){var $I=laya.ui.Slider.label;this.addChild($I),$I.textField.changeText(this._value+""),this.isVertical?($I.x=this._bar.x+20,$I.y=.5*(this._bar.height-$I.height)+this._bar.y):($I.y=this._bar.y-20,$I.x=.5*(this._bar.width-$I.width)+this._bar.x)}},$I.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},$I.mouseUp=function($I){$V.stage.off("mousemove",this,this.mouseMove),$V.stage.off("mouseup",this,this.mouseUp),$V.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},$I.mouseMove=function($I){var $M=this._value;this.isVertical?(this._bar.y+=($V.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=($V.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=$V.stage.mouseX,this._ty=$V.stage.mouseY;var $E=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$E)/$E,this._value!=$M&&this.sendChangeEvent(),this.showValueText()},$I.sendChangeEvent=function($I){void 0===$I&&($I="change"),this.event($I),this.changeHandler&&this.changeHandler.runWith(this._value)},$I.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},$I.changeSize=function(){$M.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},$I.setSlider=function($I,$M,$E){this._value=-1,this._min=$I,this._max=$I<$M?$M:$I,this.value=$E<$I?$I:$M<$E?$M:$E},$I.changeValue=function(){var $I=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*$I)/$I,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var $M=this._max-this._min;0===$M&&($M=1),this.isVertical?(this._bar.y=(this._value-this._min)/$M*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/$M*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},$I.onBgMouseDown=function($I){var $M=this._bg.getMousePoint();this.isVertical?this.value=$M.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=$M.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},$c(0,$I,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),$c(0,$I,"skin",function(){return this._skin},function($I){if(this._skin!=$I){this._skin=$I,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var $M=this._skin.replace(".png","$progress.png");$y.getRes($M)&&(this._progress||(this.addChild(this._progress=new $r),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=$M),this.setBarPoint(),this.callLater(this.changeValue)}}),$c(0,$I,"allowClickBack",function(){return this._allowClickBack},function($I){this._allowClickBack!=$I&&((this._allowClickBack=$I)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),$c(0,$I,"max",function(){return this._max},function($I){this._max!=$I&&(this._max=$I,this.callLater(this.changeValue))}),$c(0,$I,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),$c(0,$I,"tick",function(){return this._tick},function($I){this._tick!=$I&&(this._tick=$I,this.callLater(this.changeValue))}),$c(0,$I,"sizeGrid",function(){return this._bg.sizeGrid},function($I){this._bg.sizeGrid=$I,this._bar.sizeGrid=$I,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),$c(0,$I,"min",function(){return this._min},function($I){this._min!=$I&&(this._min=$I,this.callLater(this.changeValue))}),$c(0,$I,"value",function(){return this._value},function($I){if(this._value!=$I){var $M=this._value;this._value=$I,this.changeValue(),this._value!=$M&&this.sendChangeEvent()}}),$c(0,$I,"dataSource",$M.prototype._$get_dataSource,function($I){"number"==typeof(this._dataSource=$I)||"string"==typeof $I?this.value=Number($I):$V.superSet($z,this,"dataSource",$I)}),$c(0,$I,"bar",function(){return this._bar}),$Z($E,["label",function(){return this.label=new $l}]),$E}($z),$r=function($M){function $E($I){this._bitmap=null,this._skin=null,this._group=null,this._complete=null,this._progress=null,$E.__super.call(this),this.skin=$I}$n($E,"laya.ui.Image",$M);var $I=$E.prototype;return $I.destroy=function($I){void 0===$I&&($I=!0),$M.prototype.destroy.call(this,!0),this.clearLoad(),this.clearEvent(),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,$y.clearCache(this,this._skin)},$I.dispose=function(){this.destroy(!0),$y.clearCache(this,this._skin),this.clearEvent()},$I.createChildren=function(){this.graphics=this._bitmap=new $R},$I.setSource=function($I,$M){this.destroyed||$I===this._skin&&$M&&(this.source=$M,this.onCompResize(),this.clearEvent())},$I.clearEvent=function(){this._skin&&$i.atalsNotify&&$i.atalsNotify.off(this._skin,this,this.setSource)},$I.clearLoad=function(){this._skin&&((this._complete||this._progress)&&$V.loader.cancel(this._skin,this._complete,this._progress),this._complete=this._progress=null)},$c(0,$I,"source",function(){return this._bitmap.source},function($I){this._bitmap&&(this._bitmap.source=$I,this.event("loaded"),this.repaint())}),$c(0,$I,"dataSource",$M.prototype._$get_dataSource,function($I){"string"==typeof(this._dataSource=$I)?this.skin=$I:$V.superSet($z,this,"dataSource",$I)}),$c(0,$I,"measureHeight",function(){return this._bitmap.height}),$c(0,$I,"skin",function(){return this._skin},function($I){if(this._skin!=$I)if($y.clearCache(this,this._skin),this.clearEvent(),this.clearLoad(),this._skin=$I){$y.keepCache(this,this._skin);var $M=$y.getRes($I),$E=$i.resAtalsObj&&$i.resAtalsObj[this._skin];$M?(this.source=$M,this.onCompResize()):$E?($i.atalsNotify&&$i.atalsNotify.once(this._skin,this,this.setSource),0==this.width&&(this.width=$E.sourceW),0==this.height&&(this.height=$E.sourceH)):(this._complete=$Q.create(this,this.setSource,[this._skin]),this._progress=null,$V.loader.load(this._skin,this._complete,this._progress,"image",1,!0,this._group))}else this.source=null}),$c(0,$I,"group",function(){return this._group},function($I){$I&&this._skin&&$y.setGroup(this._skin,$I),this._group=$I}),$c(0,$I,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function($I){this._bitmap.sizeGrid=$v.fillArray($q.defaultSizeGrid,$I,Number)}),$c(0,$I,"measureWidth",function(){return this._bitmap.width}),$c(0,$I,"width",$M.prototype._$get_width,function($I){$V.superSet($z,this,"width",$I),this._bitmap.width=0==$I?1e-7:$I}),$c(0,$I,"height",$M.prototype._$get_height,function($I){$V.superSet($z,this,"height",$I),this._bitmap.height=0==$I?1e-7:$I}),$E}($z),$l=function($M){function $E($I){this._tf=null,$E.__super.call(this),void 0===$I&&($I=""),$B.defaultColor=$q.labelColor,this.text=$I}$n($E,"laya.ui.Label",$M);var $I=$E.prototype;return $I.destroy=function($I){void 0===$I&&($I=!0),$M.prototype.destroy.call(this,$I),this._tf=null},$I.createChildren=function(){this.addChild(this._tf=new $g)},$I.changeText=function($I){this._tf.changeText($I)},$c(0,$I,"padding",function(){return this._tf.padding.join(",")},function($I){this._tf.padding=$v.fillArray($q.labelPadding,$I,Number)}),$c(0,$I,"bold",function(){return this._tf.bold},function($I){this._tf.bold=$I}),$c(0,$I,"align",function(){return this._tf.align},function($I){this._tf.align=$I}),$c(0,$I,"text",function(){return this._tf.text},function($I){this._tf.text!=$I&&($I&&($I=$v.adptString($I+"")),this._tf.text=$I,this.event("change"),this._width&&this._height||this.onCompResize())}),$c(0,$I,"italic",function(){return this._tf.italic},function($I){this._tf.italic=$I}),$c(0,$I,"wordWrap",function(){return this._tf.wordWrap},function($I){this._tf.wordWrap=$I}),$c(0,$I,"font",function(){return this._tf.font},function($I){this._tf.font=$I}),$c(0,$I,"dataSource",$M.prototype._$get_dataSource,function($I){"number"==typeof(this._dataSource=$I)||"string"==typeof $I?this.text=$I+"":$V.superSet($z,this,"dataSource",$I)}),$c(0,$I,"color",function(){return this._tf.color},function($I){this._tf.color=$I}),$c(0,$I,"valign",function(){return this._tf.valign},function($I){this._tf.valign=$I}),$c(0,$I,"leading",function(){return this._tf.leading},function($I){this._tf.leading=$I}),$c(0,$I,"fontSize",function(){return this._tf.fontSize},function($I){this._tf.fontSize=$I}),$c(0,$I,"bgColor",function(){return this._tf.bgColor},function($I){this._tf.bgColor=$I}),$c(0,$I,"borderColor",function(){return this._tf.borderColor},function($I){this._tf.borderColor=$I}),$c(0,$I,"stroke",function(){return this._tf.stroke},function($I){this._tf.stroke=$I}),$c(0,$I,"strokeColor",function(){return this._tf.strokeColor},function($I){this._tf.strokeColor=$I}),$c(0,$I,"textField",function(){return this._tf}),$c(0,$I,"measureWidth",function(){return this._tf.width}),$c(0,$I,"measureHeight",function(){return this._tf.height}),$c(0,$I,"width",function(){return this._width||this._tf.text?$V.superGet($z,this,"width"):0},function($I){$V.superSet($z,this,"width",$I),this._tf.width=$I}),$c(0,$I,"height",function(){return this._height||this._tf.text?$V.superGet($z,this,"height"):0},function($I){$V.superSet($z,this,"height",$I),this._tf.height=$I}),$c(0,$I,"overflow",function(){return this._tf.overflow},function($I){this._tf.overflow=$I}),$c(0,$I,"underline",function(){return this._tf.underline},function($I){this._tf.underline=$I}),$c(0,$I,"underlineColor",function(){return this._tf.underlineColor},function($I){this._tf.underlineColor=$I}),$E}($z),$F=function($M){function $E($I){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,$E.__super.call(this),this.skin=$I}$n($E,"laya.ui.ProgressBar",$M);var $I=$E.prototype;return $I.destroy=function($I){void 0===$I&&($I=!0),$M.prototype.destroy.call(this,$I),this._bg&&this._bg.destroy($I),this._bar&&this._bar.destroy($I),this._bg=this._bar=null,this.changeHandler=null},$I.createChildren=function(){this.addChild(this._bg=new $r),this.addChild(this._bar=new $r)},$I.changeValue=function(){if(this.sizeGrid){var $I=this.sizeGrid.split(","),$M=Number($I[3]),$E=Number($I[1]),$Z=(this.width-$M-$E)*this._value;this._bar.width=$M+$E+$Z,this._bar.visible=this._bar.width>$M+$E}else this._bar.width=this.width*this._value},$c(0,$I,"measureHeight",function(){return this._bg.height}),$c(0,$I,"skin",function(){return this._skin},function($I){this._skin!=$I&&(this._skin=$I,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),$c(0,$I,"measureWidth",function(){return this._bg.width}),$c(0,$I,"height",$M.prototype._$get_height,function($I){$V.superSet($z,this,"height",$I),this._bg.height=this._height,this._bar.height=this._height}),$c(0,$I,"bar",function(){return this._bar}),$c(0,$I,"value",function(){return this._value},function($I){this._value!=$I&&($I=1<$I?1:$I<0?0:$I,this._value=$I,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith($I))}),$c(0,$I,"bg",function(){return this._bg}),$c(0,$I,"sizeGrid",function(){return this._bg.sizeGrid},function($I){this._bg.sizeGrid=this._bar.sizeGrid=$I}),$c(0,$I,"width",$M.prototype._$get_width,function($I){$V.superSet($z,this,"width",$I),this._bg.width=this._width,this.callLater(this.changeValue)}),$c(0,$I,"dataSource",$M.prototype._$get_dataSource,function($I){"number"==typeof(this._dataSource=$I)||"string"==typeof $I?this.value=Number($I):$V.superSet($z,this,"dataSource",$I)}),$E}($z),$e=(function($I){function $E(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,$E.__super.call(this),this._tipBox=new $z,this._tipBox.addChild(this._tipText=new $g),this._tipText.x=this._tipText.y=5,this._tipText.color=$E.tipTextColor,this._defaultTipHandler=this._showDefaultTip,$V.stage.on("showtip",this,this._onStageShowTip),$V.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}$n($E,"laya.ui.TipManager",$z);var $M=$E.prototype;$M._onStageHideTip=function($I){$V.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},$M._onStageShowTip=function($I){$V.timer.once($E.tipDelay,this,this._showTip,[$I],!0)},$M._showTip=function($I){if("string"==typeof $I){var $M=String($I);Boolean($M)&&this._defaultTipHandler($M)}else $I instanceof laya.utils.Handler?$I.run():"function"==typeof $I&&$I.apply();$V.stage.on("mousemove",this,this._onStageMouseMove),$V.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},$M._onStageMouseDown=function($I){this.closeAll()},$M._onStageMouseMove=function($I){this._showToStage(this,$E.offsetX,$E.offsetY)},$M._showToStage=function($I,$M,$E){void 0===$M&&($M=0),void 0===$E&&($E=0);var $Z=$I.getBounds();$I.x=$V.stage.mouseX+$M,$I.y=$V.stage.mouseY+$E,$I.x+$Z.width>$V.stage.width&&($I.x-=$Z.width+$M),$I.y+$Z.height>$V.stage.height&&($I.y-=$Z.height+$E)},$M.closeAll=function(){$V.timer.clear(this,this._showTip),$V.stage.off("mousemove",this,this._onStageMouseMove),$V.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},$M.showDislayTip=function($I){this.addChild($I),this._showToStage(this),$V._currentStage.addChild(this)},$M._showDefaultTip=function($I){this._tipText.text=$I;var $M=this._tipBox.graphics;$M.clear(),$M.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,$E.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),$V._currentStage.addChild(this)},$c(0,$M,"defaultTipHandler",function(){return this._defaultTipHandler},function($I){this._defaultTipHandler=$I}),$E.offsetX=10,$E.offsetY=15,$E.tipTextColor="#ffffff",$E.tipBackColor="#111111",$E.tipDelay=200}(),function($I){var $p;function $t(){this._idMap=null,this._aniList=null,this._watchMap={},$t.__super.call(this)}$n($t,"laya.ui.View",$o);var $M=$t.prototype;return $M.createView=function($I){if($I.animations&&!this._idMap&&(this._idMap={}),$t.createComp($I,this,this),$I.animations){var $M,$E,$Z=[],$i=$I.animations,$n=0,$c=$i.length;for($n=0;$n<$c;$n++){switch($M=new $A,$E=$i[$n],$M._setUp(this._idMap,$E),(this[$E.name]=$M)._setControlNode(this),$E.action){case 1:$M.play(0,!1);break;case 2:$M.play(0,!0)}$Z.push($M)}this._aniList=$Z}0<this._width&&null==$I.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},$M.onEvent=function($I,$M){},$M.loadUI=function($I){var $M=$t.uiMap[$I];$M&&this.createView($M)},$M.destroy=function($I){void 0===$I&&($I=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,$I)},$M.changeData=function($I){var $M=this._watchMap[$I];if($M){console.log("change",$I);for(var $E=0,$Z=$M.length;$E<$Z;$E++){$M[$E].exe(this)}}},$t._regs=function(){for(var $I in $t.uiClassMap)$u.regClass($I,$t.uiClassMap[$I])},$t.createComp=function($I,$M,$E,$Z){if(!($M=$M||$t.getCompInstance($I)))return console.warn("can not create:"+$I.type),null;var $i=$I.child;if($i)for(var $n=$M instanceof laya.ui.List,$c=0,$f=$i.length;$c<$f;$c++){var $d=$i[$c];if(!$M.hasOwnProperty("itemRender")||"render"!=$d.props.name&&"render"!==$d.props.renderType)if("Graphic"==$d.type)$u.addGraphicsToSprite($d,$M);else if($u.isDrawType($d.type))$u.addGraphicToSprite($d,$M,!0);else{if($n){var $H=[],$B=$t.createComp($d,null,$E,$H);$H.length&&($B._$bindData=$H)}else $B=$t.createComp($d,null,$E,$Z);"Script"==$d.type?"owner"in $B?$B.owner=$M:"target"in $B&&($B.target=$M):"mask"==$d.props.renderType||"mask"==$d.props.name?$M.mask=$B:$B instanceof laya.display.Sprite&&$M.addChild($B)}else $M.itemRender=$d}var $A=$I.props;for(var $Q in $A){var $p=$A[$Q];$t.eventDic[$Q]?$p&&$E&&$M.on($Q,$E,$E.onEvent,[$p]):$t.setCompValue($M,$Q,$p,$E,$Z)}return $V.__typeof($M,"laya.ui.IItem")&&$M.initItems(),$I.compId&&$E&&$E._idMap&&($E._idMap[$I.compId]=$M),$M},$t.setCompValue=function($I,$M,$E,$Z,$i){if("string"==typeof $E&&-1<$E.indexOf("${")){if($t._sheet||($t._sheet=$u.getClass("laya.data.Table")),!$t._sheet)return void console.warn("Can not find class Sheet");if($i)$i.push($I,$M,$E);else if($Z){-1==$E.indexOf("].")&&($E=$E.replace(".","[0]."));var $n,$c,$f=new $p($I,$M,$E);$f.exe($Z);for(var $d=$E.replace(/\[.*?\]\./g,".");null!=($n=$t._parseWatchData.exec($d));){for(var $H=$n[1];null!=($c=$t._parseKeyWord.exec($H));){var $B=$c[0],$A=$Z._watchMap[$B]||($Z._watchMap[$B]=[]);$A.push($f),$t._sheet.I.notifer.on($B,$Z,$Z.changeData,[$B])}($A=$Z._watchMap[$H]||($Z._watchMap[$H]=[])).push($f),$t._sheet.I.notifer.on($H,$Z,$Z.changeData,[$H])}}}else if("var"===$M&&$Z)$Z[$E]=$I;else if("onClick"==$M){var $Q=$V._runScript("(function(){"+$E+"})");$I.on("click",$Z,$Q)}else $I[$M]="true"===$E||"false"!==$E&&$E},$t.getCompInstance=function($I){var $M,$E=$I.props?$I.props.runtime:null;return $M=$E?$t.viewClassMap[$E]||$t.uiClassMap[$E]||$V.__classmap[$E]:$t.uiClassMap[$I.type],$I.props&&$I.props.hasOwnProperty("renderType")&&"instance"==$I.props.renderType?$M.instance:$M?new $M:null},$t.regComponent=function($I,$M){$t.uiClassMap[$I]=$M,$u.regClass($I,$M)},$t.regViewRuntime=function($I,$M){$t.viewClassMap[$I]=$M},$t.uiMap={},$t.viewClassMap={},$t._sheet=null,$Z($t,["uiClassMap",function(){return this.uiClassMap={ViewStack:$II,LinkButton:$S,TextArea:$HI,ColorPicker:$C,Box:$o,Button:$S,CheckBox:$_,Clip:$X,ComboBox:$J,Component:$z,HScrollBar:$G,HSlider:$K,Image:$r,Label:$l,List:$D,Panel:$Y,ProgressBar:$F,Radio:$b,RadioGroup:$fI,ScrollBar:$x,Slider:$k,Tab:$dI,TextInput:$EI,View:$t,VScrollBar:$MI,VSlider:$ZI,Tree:$U,HBox:$nI,VBox:$cI,Sprite:$w,Animation:$E,Text:$g,FontClip:$P}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),$t.__init$=function(){$t._regs(),$p=function(){function $I($I,$M,$E){this.comp=null,this.prop=null,this.value=null,this.comp=$I,this.prop=$M,this.value=$E}return $n($I,""),$I.prototype.exe=function($I){var $M=$v.getBindFun(this.value);this.comp[this.prop]=$M.call(this,$I)},$I}()},$t}()),$_=function($I){function $E($I,$M){void 0===$M&&($M=""),$E.__super.call(this,$I,$M)}$n($E,"laya.ui.CheckBox",$I);var $M=$E.prototype;return $M.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},$M.initialize=function(){$I.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},$c(0,$M,"dataSource",$I.prototype._$get_dataSource,function($I){"boolean"==typeof(this._dataSource=$I)?this.selected=$I:"string"==typeof $I?this.selected="true"===$I:$V.superSet($S,this,"dataSource",$I)}),$E}($S),$h=function($I){function $M(){this._space=0,this._align="none",this._itemChanged=!1,$M.__super.call(this)}$n($M,"laya.ui.LayoutBox",$o);var $E=$M.prototype;return $E.addChild=function($I){return $I.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,$I)},$E.onResize=function($I){this._setItemChanged()},$E.addChildAt=function($I,$M){return $I.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,$I,$M)},$E.removeChild=function($I){return $I.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,$I)},$E.removeChildAt=function($I){return this.getChildAt($I).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,$I)},$E.refresh=function(){this._setItemChanged()},$E.changeItems=function(){this._itemChanged=!1},$E.sortItem=function($I){$I&&$I.sort(function($I,$M){return $I.y-$M.y})},$E._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},$c(0,$E,"space",function(){return this._space},function($I){this._space=$I,this._setItemChanged()}),$c(0,$E,"align",function(){return this._align},function($I){this._align=$I,this._setItemChanged()}),$M}(),$P=function($M){function $E($I,$M){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,$E.__super.call(this),$I&&(this.skin=$I),$M&&(this.sheet=$M)}$n($E,"laya.ui.FontClip",$M);var $I=$E.prototype;return $I.createChildren=function(){this._bitmap=new $R,this.on("loaded",this,this._onClipLoaded)},$I._onClipLoaded=function(){this.callLater(this.changeValue)},$I.changeValue=function(){var $I;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),$I=this._sources[0]))){var $M="horizontal"===this._direction;$M?(this._wordsW=this._valueArr.length*($I.sourceWidth+this.spaceX),this._wordsH=$I.sourceHeight):(this._wordsW=$I.sourceWidth,this._wordsH=($I.sourceHeight+this.spaceY)*this._valueArr.length);var $E=0;if(this._width)switch(this._align){case"center":$E=.5*(this._width-this._wordsW);break;case"right":$E=this._width-this._wordsW;break;default:$E=0}for(var $Z=0,$i=this._valueArr.length;$Z<$i;$Z++){var $n=this._indexMap[this._valueArr.charAt($Z)];this.sources[$n]&&($I=this.sources[$n],$M?this.graphics.drawTexture($I,$E+$Z*($I.sourceWidth+this.spaceX),0,$I.sourceWidth,$I.sourceHeight):this.graphics.drawTexture($I,0+$E,$Z*($I.sourceHeight+this.spaceY),$I.sourceWidth,$I.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},$I.destroy=function($I){void 0===$I&&($I=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),$M.prototype.destroy.call(this,$I)},$c(0,$I,"sheet",function(){return this._sheet},function($I){$I+="";var $M=(this._sheet=$I).split(" ");this._clipX=String($M[0]).length,this.clipY=$M.length,this._indexMap={};for(var $E=0;$E<this._clipY;$E++)for(var $Z=$M[$E].split(""),$i=0,$n=$Z.length;$i<$n;$i++)this._indexMap[$Z[$i]]=$E*this._clipX+$i}),$c(0,$I,"height",$M.prototype._$get_height,function($I){$V.superSet($X,this,"height",$I),this.callLater(this.changeValue)}),$c(0,$I,"direction",function(){return this._direction},function($I){this._direction=$I,this.callLater(this.changeValue)}),$c(0,$I,"value",function(){return this._valueArr?this._valueArr:""},function($I){$I+="",this._valueArr=$I,this.callLater(this.changeValue)}),$c(0,$I,"width",$M.prototype._$get_width,function($I){$V.superSet($X,this,"width",$I),this.callLater(this.changeValue)}),$c(0,$I,"spaceX",function(){return this._spaceX},function($I){this._spaceX=$I,"horizontal"===this._direction&&this.callLater(this.changeValue)}),$c(0,$I,"spaceY",function(){return this._spaceY},function($I){this._spaceY=$I,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),$c(0,$I,"align",function(){return this._align},function($I){this._align=$I,this.callLater(this.changeValue)}),$c(0,$I,"measureWidth",function(){return this._wordsW}),$c(0,$I,"measureHeight",function(){return this._wordsH}),$E}($X),$D=function($I){function $M(){this.selectHandler=null,this.renderHandler=null,this.renderTwHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this._twSwitch=!0,this._twDone=!0,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new $t,$M.__super.call(this)}$n($M,"laya.ui.List",$I);var $E=$M.prototype;return $V.imps($E,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),$E.destroy=function($I){void 0===$I&&($I=!0),this._content&&this._content.destroy($I),this._scrollBar&&this._scrollBar.destroy($I),laya.ui.Component.prototype.destroy.call(this,$I),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this._twSwitch=null,this._twDone=null,this.selectHandler=this.renderHandler=this.mouseHandler=this.renderTwHandler=null},$E.createChildren=function(){this.addChild(this._content=new $o)},$E.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$V.superGet($o,this,"cacheAs")),$V.superSet($o,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},$E.onScrollEnd=function(){$V.superSet($o,this,"cacheAs",this._$P.cacheAs)},$E._removePreScrollBar=function(){var $I=this.removeChildByName("scrollBar");$I&&$I.destroy(!0)},$E.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var $I=this._getOneCell(),$M=$I.width+this._spaceX||1,$E=$I.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/$M):Math.ceil(this._width/$M)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/$E):Math.round(this._height/$E));var $Z=this._width?this._width:$M*this.repeatX-this._spaceX,$i=this._height?this._height:$E*this.repeatY-this._spaceY;this._cellSize=this._isVertical?$E:$M,this._cellOffset=this._isVertical?$E*Math.max(this._repeatY2,this._repeatY)-$i-this._spaceY:$M*Math.max(this._repeatX2,this._repeatX)-$Z-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=$i:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=$Z),this.setContentSize($Z,$i);var $n=this._isVertical?this.repeatX:this.repeatY,$c=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,$n,$c),this._createdLine=$c,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},$E._getOneCell=function(){if(0===this._cells.length){var $I=this.createItem();if(this._offset.setTo($I.x,$I.y),this.cacheContent)return $I;this._cells.push($I)}return this._cells[0]},$E._createItems=function($I,$M,$E){var $Z=this._content,$i=this._getOneCell(),$n=$i.width+this._spaceX,$c=$i.height+this._spaceY;if(this.cacheContent){var $f=new $o;$f.cacheAsBitmap=!0,$f.pos((this._isVertical?0:$I)*$n,(this._isVertical?$I:0)*$c),this._content.addChild($f),this._content.optimizeScrollRect=!0,$Z=$f}else{for(var $d=[],$H=this._cells.length-1;-1<$H;$H--){var $B=this._cells[$H];$B.removeSelf(),$d.push($B)}this._cells.length=0}for(var $A=$I;$A<$E;$A++)for(var $Q=0;$Q<$M;$Q++)($i=$d&&$d.length?$d.pop():this.createItem()).x=(this._isVertical?$Q:$A)*$n-$Z.x,$i.y=(this._isVertical?$A:$Q)*$c-$Z.y,$i.name="item"+($A*$M+$Q),$Z.addChild($i),this.addCell($i)},$E.createItem=function(){var $I=[];if("function"==typeof this._itemRender)var $M=new this._itemRender;else $M=$e.createComp(this._itemRender,null,null,$I);if(0==$I.length&&$M._watchMap){var $E=$M._watchMap;for(var $Z in $E)for(var $i=$E[$Z],$n=0;$n<$i.length;$n++){var $c=$i[$n];$I.push($c.comp,$c.prop,$c.value)}}return $I.length&&($M._$bindData=$I),$M},$E.addCell=function($I){$I.on("click",this,this.onCellMouse),$I.on("rightclick",this,this.onCellMouse),$I.on("mouseover",this,this.onCellMouse),$I.on("mouseout",this,this.onCellMouse),$I.on("mousedown",this,this.onCellMouse),$I.on("mouseup",this,this.onCellMouse),this._cells.push($I)},$E.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var $I=0,$M=$I=0;$M<1e4;$M++){var $E=this.getChildByName("item"+$M);if(!$E)break;this.addCell($E),$I++}this.repeatY=$I}},$E.setContentSize=function($I,$M){this._content.width=$I,this._content.height=$M,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new $N),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,$I,$M),this._content.scrollRect=this._content.scrollRect),this.event("resize")},$E.onCellMouse=function($I){"mousedown"===$I.type&&(this._isMoved=!1);var $M=$I.currentTarget,$E=this._startIndex+this._cells.indexOf($M);$E<0||("click"===$I.type||"rightclick"===$I.type?this.selectEnable&&!this._isMoved?this.selectedIndex=$E:this.changeCellState($M,!0,0):"mouseover"!==$I.type&&"mouseout"!==$I.type||this._selectedIndex===$E||this.changeCellState($M,"mouseover"===$I.type,0),this.mouseHandler&&this.mouseHandler.runWith([$I,$E]))},$E.changeCellState=function($I,$M,$E){var $Z=$I.getChildByName("selectBox");$Z&&(this.selectEnable=!0,$Z.visible=$M,$Z.index=$E)},$E.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},$E.onScrollBarChange=function($I){this.runCallLater(this.changeCells);var $M=this._scrollBar.value,$E=this._isVertical?this.repeatX:this.repeatY,$Z=this._isVertical?this.repeatY:this.repeatX,$i=Math.floor($M/this._cellSize);if(this.cacheContent)$c=$Z+1,this._createdLine-$i<$c&&(this._createItems(this._createdLine,$E,this._createdLine+$c),this.renderItems(this._createdLine*$E,0),this._createdLine+=$c);else{var $n=$i*$E,$c=0;if($n>this._startIndex){$c=$n-this._startIndex;var $f=!0,$d=this._startIndex+$E*($Z+1);this._isMoved=!0}else $n<this._startIndex&&($c=this._startIndex-$n,$f=!1,$d=this._startIndex-1,this._isMoved=!0);for(var $H=0;$H<$c;$H++){if($f){var $B=this._cells.shift();this._cells[this._cells.length]=$B;var $A=$d+$H}else $B=this._cells.pop(),this._cells.unshift($B),$A=$d-$H;var $Q=Math.floor($A/$E)*this._cellSize;this._isVertical?$B.y=$Q:$B.x=$Q,this.renderItem($B,$A)}this._startIndex=$n,this.changeSelectStatus()}var $p=this._content.scrollRect;this._isVertical?($p.y=$M-this._offset.y,$p.x=-this._offset.x):($p.y=-this._offset.y,$p.x=$M-this._offset.x),this._content.scrollRect=$p},$E.posCell=function($I,$M){if(this._scrollBar){var $E=this._isVertical?this.repeatX:this.repeatY,$Z=(this._isVertical?this.repeatY:this.repeatX,Math.floor($M/$E)*this._cellSize);this._isVertical?$I.y=$Z:$I.x=$Z}},$E.changeSelectStatus=function(){for(var $I=0,$M=this._cells.length;$I<$M;$I++)this.changeCellState(this._cells[$I],this._selectedIndex===this._startIndex+$I,1)},$E.renderItems=function($I,$M){void 0===$I&&($I=0),void 0===$M&&($M=0);for(var $E=$I,$Z=$M||this._cells.length;$E<$Z;$E++)this.renderItem(this._cells[$E],this._startIndex+$E);this.changeSelectStatus(),this._twDone=!0},$E.renderItem=function($I,$M){this._array&&0<=$M&&$M<this._array.length?($I.visible=!0,$I._$bindData?($I._dataSource=this._array[$M],this._bindData($I,this._array[$M])):$I.dataSource=this._array[$M],this.cacheContent||this.posCell($I,$M),this.hasListener("render")&&this.event("render",[$I,$M]),this.renderHandler&&this.renderHandler.runWith([$I,$M]),this.renderTwHandler&&this.renderTwHandler.runWith([$I,$M])):($I.visible=!1,$I.dataSource=null)},$E._bindData=function($I,$M){for(var $E=$I._$bindData,$Z=0,$i=$E.length;$Z<$i;$Z++){var $n=$E[$Z++],$c=$E[$Z++],$f=$E[$Z],$d=$v.getBindFun($f);$n[$c]=$d.call(this,$M)}},$E.refresh=function(){this.array=this._array},$E.getItem=function($I){return-1<$I&&$I<this._array.length?this._array[$I]:null},$E.changeItem=function($I,$M){-1<$I&&$I<this._array.length&&(this._array[$I]=$M,$I>=this._startIndex&&$I<this._startIndex+this._cells.length&&this.renderItem(this.getCell($I),$I))},$E.setItem=function($I,$M){this.changeItem($I,$M)},$E.addItem=function($I){this._array.push($I),this.array=this._array},$E.addItemAt=function($I,$M){this._array.splice($M,0,$I),this.array=this._array},$E.deleteItem=function($I){this._array.splice($I,1),this.array=this._array},$E.getCell=function($I){return this.runCallLater(this.changeCells),-1<$I&&this._cells?this._cells[($I-this._startIndex)%this._cells.length]:null},$E.scrollTo=function($I){if(this._scrollBar){var $M=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor($I/$M)*this._cellSize}else this.startIndex=$I},$E.tweenTo=function($I,$M,$E){if(void 0===$M&&($M=200),this._scrollBar){var $Z=this._isVertical?this.repeatX:this.repeatY;$a.to(this._scrollBar,{value:Math.floor($I/$Z)*this._cellSize},$M,null,$E,0,!0)}else this.startIndex=$I,$E&&$E.run()},$E._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},$E.commitMeasure=function(){this.runCallLater(this.changeCells)},$c(0,$E,"cacheAs",$I.prototype._$get_cacheAs,function($I){$V.superSet($o,this,"cacheAs",$I),this._scrollBar&&(this._$P.cacheAs=null,"none"!==$I?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),$c(0,$E,"content",function(){return this._content}),$c(0,$E,"height",$I.prototype._$get_height,function($I){$I!=this._height&&($V.superSet($o,this,"height",$I),this._setCellChanged())}),$c(0,$E,"itemRender",function(){return this._itemRender},function($I){if(this._itemRender!=$I){this._itemRender=$I;for(var $M=this._cells.length-1;-1<$M;$M--)this._cells[$M].destroy();this._cells.length=0,this._setCellChanged()}}),$c(0,$E,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($I){this._removePreScrollBar();var $M=new $MI;$M.name="scrollBar",$M.right=0,$I&&" "!=$I&&($M.skin=$I),this.scrollBar=$M,this.addChild($M),this._setCellChanged()}),$c(0,$E,"page",function(){return this._page},function($I){this._page=$I,this._array&&(this._page=0<$I?$I:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),$c(0,$E,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function($I){this._removePreScrollBar();var $M=new $G;$M.name="scrollBar",$M.bottom=0,$I&&" "!=$I&&($M.skin=$I),this.scrollBar=$M,this.addChild($M),this._setCellChanged()}),$c(0,$E,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function($I){this._repeatX=$I,this._setCellChanged()}),$c(0,$E,"scrollBar",function(){return this._scrollBar},function($I){this._scrollBar!=$I&&(this._scrollBar=$I)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),$c(0,$E,"width",$I.prototype._$get_width,function($I){$I!=this._width&&($V.superSet($o,this,"width",$I),this._setCellChanged())}),$c(0,$E,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function($I){this._repeatY=$I,this._setCellChanged()}),$c(0,$E,"spaceX",function(){return this._spaceX},function($I){this._spaceX=$I,this._setCellChanged()}),$c(0,$E,"spaceY",function(){return this._spaceY},function($I){this._spaceY=$I,this._setCellChanged()}),$c(0,$E,"selectedIndex",function(){return this._selectedIndex},function($I){this._selectedIndex!=$I&&(this._selectedIndex=$I,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith($I),this.startIndex=this._startIndex)}),$c(0,$E,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function($I){this.selectedIndex=this._array.indexOf($I)}),$c(0,$E,"length",function(){return this._array?this._array.length:0}),$c(0,$E,"selection",function(){return this.getCell(this._selectedIndex)},function($I){this.selectedIndex=this._startIndex+this._cells.indexOf($I)}),$c(0,$E,"startIndex",function(){return this._startIndex},function($I){this._startIndex=0<$I?$I:0,this.callLater(this.renderItems)}),$c(0,$E,"twSwitch",function(){return this._twSwitch},function($I){this._twSwitch=$I}),$c(0,$E,"twDone",function(){return this._twDone},function($I){this._twDone=$I}),$c(0,$E,"array",function(){return this._array},function($I){this.runCallLater(this.changeCells),this._array=$I||[];var $M=this._array.length;if(this.totalPage=Math.ceil($M/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<$M?this._selectedIndex:$M-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var $E=this._isVertical?this.repeatX:this.repeatY,$Z=this._isVertical?this.repeatY:this.repeatX,$i=Math.ceil($M/$E);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=$Z/$i,this._scrollBar.setScroll(0,($i-$Z)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),$c(0,$E,"dataSource",$I.prototype._$get_dataSource,function($I){"number"==typeof(this._dataSource=$I)&&Math.floor($I)==$I||"string"==typeof $I?this.selectedIndex=parseInt($I):$I instanceof Array?this.array=$I:$V.superSet($o,this,"dataSource",$I)}),$c(0,$E,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),$M}($o),$G=function($I){function $M(){$M.__super.call(this)}return $n($M,"laya.ui.HScrollBar",$I),$M.prototype.initialize=function(){$I.prototype.initialize.call(this),this.slider.isVertical=!1},$M}($x),$Y=function($I){function $M(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,$M.__super.call(this),this.width=this.height=100}$n($M,"laya.ui.Panel",$I);var $E=$M.prototype;return $E.destroy=function($I){void 0===$I&&($I=!0),laya.ui.Component.prototype.destroy.call(this,$I),this._content&&this._content.destroy($I),this._vScrollBar&&this._vScrollBar.destroy($I),this._hScrollBar&&this._hScrollBar.destroy($I),this._vScrollBar=null,this._hScrollBar=null,this._content=null},$E.destroyChildren=function(){this._content.destroyChildren()},$E.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new $o)},$E.addChild=function($I){return $I.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild($I)},$E.onResize=function(){this._setScrollChanged()},$E.addChildAt=function($I,$M){return $I.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt($I,$M)},$E.removeChild=function($I){return $I.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild($I)},$E.removeChildAt=function($I){return this.getChildAt($I).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt($I)},$E.removeChildren=function($I,$M){return void 0===$I&&($I=0),void 0===$M&&($M=2147483647),this._content.removeChildren($I,$M),this._setScrollChanged(),this},$E.getChildAt=function($I){return this._content.getChildAt($I)},$E.getChildByName=function($I){return this._content.getChildByName($I)},$E.getChildIndex=function($I){return this._content.getChildIndex($I)},$E.changeScroll=function(){this._scrollChanged=!1;var $I=this.contentWidth||1,$M=this.contentHeight||1,$E=this._vScrollBar,$Z=this._hScrollBar,$i=$E&&$M>this._height,$n=$Z&&$I>this._width,$c=$i?this._width-$E.width:this._width,$f=$n?this._height-$Z.height:this._height;$E&&($E.x=this._width-$E.width,$E.y=0,$E.height=this._height-($n?$Z.height:0),$E.scrollSize=Math.max(.033*this._height,1),$E.thumbPercent=$f/$M,$E.setScroll(0,$M-$f,$E.value)),$Z&&($Z.x=0,$Z.y=this._height-$Z.height,$Z.width=this._width-($i?$E.width:0),$Z.scrollSize=Math.max(.033*this._width,1),$Z.thumbPercent=$c/$I,$Z.setScroll(0,$I-$c,$Z.value))},$E.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},$E.setContentSize=function($I,$M){var $E=this._content;$E.width=$I,$E.height=$M,$E.scrollRect||($E.scrollRect=new $N),$E.scrollRect.setTo(0,0,$I,$M),$E.scrollRect=$E.scrollRect},$E.onScrollBarChange=function($I){var $M=this._content.scrollRect;if($M){var $E=Math.round($I.value);$I.isVertical?$M.y=$E:$M.x=$E,this._content.scrollRect=$M}},$E.scrollTo=function($I,$M){void 0===$I&&($I=0),void 0===$M&&($M=0),this.vScrollBar&&(this.vScrollBar.value=$M),this.hScrollBar&&(this.hScrollBar.value=$I)},$E.refresh=function(){this.changeScroll()},$E.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=$V.superGet($o,this,"cacheAs")),$V.superSet($o,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},$E.onScrollEnd=function(){$V.superSet($o,this,"cacheAs",this._$P.cacheAs)},$E._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},$c(0,$E,"numChildren",function(){return this._content.numChildren}),$c(0,$E,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($I){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new $G),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=$I}),$c(0,$E,"contentWidth",function(){for(var $I=0,$M=this._content.numChildren-1;-1<$M;$M--){var $E=this._content.getChildAt($M);$I=Math.max($E.x+$E.width*$E.scaleX,$I)}return $I}),$c(0,$E,"contentHeight",function(){for(var $I=0,$M=this._content.numChildren-1;-1<$M;$M--){var $E=this._content.getChildAt($M);$I=Math.max($E.y+$E.height*$E.scaleY,$I)}return $I}),$c(0,$E,"width",$I.prototype._$get_width,function($I){$V.superSet($o,this,"width",$I),this._setScrollChanged()}),$c(0,$E,"hScrollBar",function(){return this._hScrollBar}),$c(0,$E,"content",function(){return this._content}),$c(0,$E,"height",$I.prototype._$get_height,function($I){$V.superSet($o,this,"height",$I),this._setScrollChanged()}),$c(0,$E,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($I){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new $MI),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=$I}),$c(0,$E,"vScrollBar",function(){return this._vScrollBar}),$c(0,$E,"cacheAs",$I.prototype._$get_cacheAs,function($I){$V.superSet($o,this,"cacheAs",$I),this._$P.cacheAs=null,"none"!==$I?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),$M}($o),$K=function($I){function $M($I){$M.__super.call(this,$I),this.isVertical=!1}return $n($M,"laya.ui.HSlider",$k),$M}(),$s=function($I){function $E($I,$M){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,$E.__super.call(this),this.skin=$M,this.labels=$I}$n($E,"laya.ui.UIGroup",$I);var $M=$E.prototype;return $V.imps($M,{"laya.ui.IItem":!0}),$M.preinitialize=function(){this.mouseEnabled=!0},$M.destroy=function($I){void 0===$I&&($I=!0),laya.ui.Component.prototype.destroy.call(this,$I),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},$M.addItem=function($I,$M){void 0===$M&&($M=!0);var $E=$I,$Z=this._items.length;if($E.name="item"+$Z,this.addChild($E),this.initItems(),$M&&0<$Z){var $i=this._items[$Z-1];"horizontal"==this._direction?$E.x=$i.x+$i.width+this._space:$E.y=$i.y+$i.height+this._space}else $M&&($E.x=0,$E.y=0);return $Z},$M.delItem=function($I,$M){void 0===$M&&($M=!0);var $E=this._items.indexOf($I);if(-1!=$E){var $Z=$I;this.removeChild($Z);for(var $i=$E+1,$n=this._items.length;$i<$n;$i++){var $c=this._items[$i];$c.name="item"+($i-1),$M&&("horizontal"==this._direction?$c.x-=$Z.width+this._space:$c.y-=$Z.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var $f;$f=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=$f}}},$M.initItems=function(){this._items||(this._items=[]);for(var $I=this._items.length=0;$I<1e4;$I++){var $M=this.getChildByName("item"+$I);if(null==$M)break;this._items.push($M),$M.selected=$I===this._selectedIndex,$M.clickHandler=$Q.create(this,this.itemClick,[$I],!1)}},$M.itemClick=function($I){this.selectedIndex=$I},$M.setSelect=function($I,$M){this._items&&-1<$I&&$I<this._items.length&&(this._items[$I].selected=$M)},$M.createItem=function($I,$M){return null},$M.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var $I=0,$M=0,$E=this._items.length;$M<$E;$M++){var $Z=this._items[$M];this._skin&&($Z.skin=this._skin),this._labelColors&&($Z.labelColors=this._labelColors),this._labelSize&&($Z.labelSize=this._labelSize),this._labelStroke&&($Z.labelStroke=this._labelStroke),this._labelStrokeColor&&($Z.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&($Z.strokeColors=this._strokeColors),this._labelBold&&($Z.labelBold=this._labelBold),this._labelPadding&&($Z.labelPadding=this._labelPadding),this._labelAlign&&($Z.labelAlign=this._labelAlign),this._stateNum&&($Z.stateNum=this._stateNum),this._labelFont&&($Z.labelFont=this._labelFont),"horizontal"===this._direction?($Z.y=0,$Z.x=$I,$I+=$Z.width+this._space):($Z.x=0,$Z.y=$I,$I+=$Z.height+this._space)}this.changeSize()},$M.commitMeasure=function(){this.runCallLater(this.changeLabels)},$M._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},$c(0,$M,"labelStrokeColor",function(){return this._labelStrokeColor},function($I){this._labelStrokeColor!=$I&&(this._labelStrokeColor=$I,this._setLabelChanged())}),$c(0,$M,"skin",function(){return this._skin},function($I){this._skin!=$I&&(this._skin=$I,this._setLabelChanged())}),$c(0,$M,"selectedIndex",function(){return this._selectedIndex},function($I){this._selectedIndex!=$I&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$I,this.setSelect($I,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),$c(0,$M,"labels",function(){return this._labels},function($I){if(this._labels!=$I){if(this._labels=$I,this.removeChildren(),this._setLabelChanged(),this._labels)for(var $M=this._labels.split(","),$E=0,$Z=$M.length;$E<$Z;$E++){var $i=this.createItem(this._skin,$M[$E]);$i.name="item"+$E,this.addChild($i)}this.initItems()}}),$c(0,$M,"strokeColors",function(){return this._strokeColors},function($I){this._strokeColors!=$I&&(this._strokeColors=$I,this._setLabelChanged())}),$c(0,$M,"labelColors",function(){return this._labelColors},function($I){this._labelColors!=$I&&(this._labelColors=$I,this._setLabelChanged())}),$c(0,$M,"labelStroke",function(){return this._labelStroke},function($I){this._labelStroke!=$I&&(this._labelStroke=$I,this._setLabelChanged())}),$c(0,$M,"labelSize",function(){return this._labelSize},function($I){this._labelSize!=$I&&(this._labelSize=$I,this._setLabelChanged())}),$c(0,$M,"stateNum",function(){return this._stateNum},function($I){this._stateNum!=$I&&(this._stateNum=$I,this._setLabelChanged())}),$c(0,$M,"labelBold",function(){return this._labelBold},function($I){this._labelBold!=$I&&(this._labelBold=$I,this._setLabelChanged())}),$c(0,$M,"labelFont",function(){return this._labelFont},function($I){this._labelFont!=$I&&(this._labelFont=$I,this._setLabelChanged())}),$c(0,$M,"labelPadding",function(){return this._labelPadding},function($I){this._labelPadding!=$I&&(this._labelPadding=$I,this._setLabelChanged())}),$c(0,$M,"direction",function(){return this._direction},function($I){this._direction=$I,this._setLabelChanged()}),$c(0,$M,"space",function(){return this._space},function($I){this._space=$I,this._setLabelChanged()}),$c(0,$M,"items",function(){return this._items}),$c(0,$M,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($I){this.selectedIndex=this._items.indexOf($I)}),$c(0,$M,"dataSource",$I.prototype._$get_dataSource,function($I){"number"==typeof(this._dataSource=$I)&&Math.floor($I)==$I||"string"==typeof $I?this.selectedIndex=parseInt($I):$I instanceof Array?this.labels=$I.join(","):$V.superSet($o,this,"dataSource",$I)}),$E}($o),$b=function($M){function $E($I,$M){this._value=null,void 0===$M&&($M=""),$E.__super.call(this,$I,$M)}$n($E,"laya.ui.Radio",$M);var $I=$E.prototype;return $I.destroy=function($I){void 0===$I&&($I=!0),$M.prototype.destroy.call(this,$I),this._value=null},$I.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},$I.initialize=function(){$M.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},$I.onClick=function($I){this.selected=!0},$c(0,$I,"value",function(){return null!=this._value?this._value:this.label},function($I){this._value=$I}),$E}($S),$U=function($I){function $M(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,$M.__super.call(this),this.width=this.height=200}$n($M,"laya.ui.Tree",$I);var $E=$M.prototype;return $V.imps($E,{"laya.ui.IRender":!0}),$E.destroy=function($I){void 0===$I&&($I=!0),laya.ui.Component.prototype.destroy.call(this,$I),this._list&&this._list.destroy($I),this._list=null,this._source=null,this._renderHandler=null},$E.createChildren=function(){this.addChild(this._list=new $D),this._list.renderHandler=$Q.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},$E.onListChange=function($I){this.event("change")},$E.getArray=function(){var $I,$M=[];for(var $E in this._source)$I=this._source[$E],this.getParentOpenStatus($I)&&($I.x=this._spaceLeft*this.getDepth($I),$M.push($I));return $M},$E.getDepth=function($I,$M){return void 0===$M&&($M=0),null==$I.nodeParent?$M:this.getDepth($I.nodeParent,$M+1)},$E.getParentOpenStatus=function($I){var $M=$I.nodeParent;return null==$M||!!$M.isOpen&&(null==$M.nodeParent||this.getParentOpenStatus($M))},$E.renderItem=function($I,$M){var $E=$I.dataSource;if($E){$I.left=$E.x;var $Z=$I.getChildByName("arrow");$Z&&($E.hasChild?($Z.visible=!0,$Z.index=$E.isOpen?1:0,$Z.tag=$M,$Z.off("click",this,this.onArrowClick),$Z.on("click",this,this.onArrowClick)):$Z.visible=!1);var $i=$I.getChildByName("folder");$i&&(2==$i.clipY?$i.index=$E.isDirectory?0:1:$i.index=$E.isDirectory?$E.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([$I,$M])}},$E.onArrowClick=function($I){var $M=$I.currentTarget.tag;this._list.array[$M].isOpen=!this._list.array[$M].isOpen,this.event("open"),this._list.array=this.getArray()},$E.setItemState=function($I,$M){this._list.array[$I]&&(this._list.array[$I].isOpen=$M,this._list.array=this.getArray())},$E.fresh=function(){this._list.array=this.getArray(),this.repaint()},$E.parseXml=function($I,$M,$E,$Z){var $i,$n=$I.childNodes,$c=$n.length;if(!$Z){$i={};var $f,$d=$I.attributes;for(var $H in $d){var $B=($f=$d[$H]).nodeName,$A=$f.nodeValue;$i[$B]="true"==$A||"false"!=$A&&$A}$i.nodeParent=$E,0<$c&&($i.isDirectory=!0),$i.hasChild=0<$c,$M.push($i)}for(var $Q=0;$Q<$c;$Q++){var $p=$n[$Q];this.parseXml($p,$M,$i,!1)}},$E.parseOpenStatus=function($I,$M){for(var $E=0,$Z=$M.length;$E<$Z;$E++){var $i=$M[$E];if($i.isDirectory)for(var $n=0,$c=$I.length;$n<$c;$n++){var $f=$I[$n];if($f.isDirectory&&this.isSameParent($f,$i)&&$i.label==$f.label){$i.isOpen=$f.isOpen;break}}}},$E.isSameParent=function($I,$M){return null==$I.nodeParent&&null==$M.nodeParent||null!=$I.nodeParent&&null!=$M.nodeParent&&($I.nodeParent.label==$M.nodeParent.label&&this.isSameParent($I.nodeParent,$M.nodeParent))},$E.filter=function($I){if(Boolean($I)){var $M=[];this.getFilterSource(this._source,$M,$I),this._list.array=$M}else this._list.array=this.getArray()},$E.getFilterSource=function($I,$M,$E){var $Z;for(var $i in $E=$E.toLocaleLowerCase(),$I)!($Z=$I[$i]).isDirectory&&-1<String($Z.label).toLowerCase().indexOf($E)&&($Z.x=0,$M.push($Z)),$Z.child&&0<$Z.child.length&&this.getFilterSource($Z.child,$M,$E)},$c(0,$E,"spaceBottom",function(){return this._list.spaceY},function($I){this._list.spaceY=$I}),$c(0,$E,"keepStatus",function(){return this._keepStatus},function($I){this._keepStatus=$I}),$c(0,$E,"itemRender",function(){return this._list.itemRender},function($I){this._list.itemRender=$I}),$c(0,$E,"array",function(){return this._list.array},function($I){this._keepStatus&&this._list.array&&$I&&this.parseOpenStatus(this._list.array,$I),this._source=$I,this._list.array=this.getArray()}),$c(0,$E,"mouseHandler",function(){return this._list.mouseHandler},function($I){this._list.mouseHandler=$I}),$c(0,$E,"dataSource",$I.prototype._$get_dataSource,function($I){this._dataSource=$I,$V.superSet($o,this,"dataSource",$I)}),$c(0,$E,"source",function(){return this._source}),$c(0,$E,"scrollBar",function(){return this._list.scrollBar}),$c(0,$E,"list",function(){return this._list}),$c(0,$E,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function($I){this._list.vScrollBarSkin=$I}),$c(0,$E,"renderHandler",function(){return this._renderHandler},function($I){this._renderHandler=$I}),$c(0,$E,"selectedIndex",function(){return this._list.selectedIndex},function($I){this._list.selectedIndex=$I}),$c(0,$E,"spaceLeft",function(){return this._spaceLeft},function($I){this._spaceLeft=$I}),$c(0,$E,"selectedItem",function(){return this._list.selectedItem},function($I){this._list.selectedItem=$I}),$c(0,$E,"width",$I.prototype._$get_width,function($I){$V.superSet($o,this,"width",$I),this._list.width=$I}),$c(0,$E,"height",$I.prototype._$get_height,function($I){$V.superSet($o,this,"height",$I),this._list.height=$I}),$c(0,$E,"xml",null,function($I){var $M=[];this.parseXml($I.childNodes[0],$M,null,!0),this.array=$M}),$c(0,$E,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),$M}($o),$II=function($I){function $M(){this._items=null,this._selectedIndex=0,$M.__super.call(this),this._setIndexHandler=$Q.create(this,this.setIndex,null,!1)}$n($M,"laya.ui.ViewStack",$I);var $E=$M.prototype;return $V.imps($E,{"laya.ui.IItem":!0}),$E.setItems=function($I){this.removeChildren();for(var $M=0,$E=0,$Z=$I.length;$E<$Z;$E++){var $i=$I[$E];$i&&($i.name="item"+$M,this.addChild($i),$M++)}this.initItems()},$E.addItem=function($I){$I.name="item"+this._items.length,this.addChild($I),this.initItems()},$E.initItems=function(){this._items=[];for(var $I=0;$I<1e4;$I++){var $M=this.getChildByName("item"+$I);if(null==$M)break;this._items.push($M),$M.visible=$I==this._selectedIndex}},$E.setSelect=function($I,$M){this._items&&-1<$I&&$I<this._items.length&&(this._items[$I].visible=$M)},$E.setIndex=function($I){this.selectedIndex=$I},$c(0,$E,"dataSource",$I.prototype._$get_dataSource,function($I){if("number"==typeof(this._dataSource=$I)&&Math.floor($I)==$I||"string"==typeof $I)this.selectedIndex=parseInt($I);else for(var $M in this._dataSource)this.hasOwnProperty($M)&&(this[$M]=this._dataSource[$M])}),$c(0,$E,"selectedIndex",function(){return this._selectedIndex},function($I){this._selectedIndex!=$I&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=$I,this.setSelect(this._selectedIndex,!0))}),$c(0,$E,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function($I){this.selectedIndex=this._items.indexOf($I)}),$c(0,$E,"items",function(){return this._items}),$c(0,$E,"setIndexHandler",function(){return this._setIndexHandler},function($I){this._setIndexHandler=$I}),$M}($o),$MI=function($I){function $M(){$M.__super.call(this)}return $n($M,"laya.ui.VScrollBar",$x),$M}(),$EI=function($M){function $E($I){this._bg=null,this._skin=null,$E.__super.call(this),void 0===$I&&($I=""),this.text=$I,this.skin=this.skin}$n($E,"laya.ui.TextInput",$M);var $I=$E.prototype;return $I.preinitialize=function(){this.mouseEnabled=!0},$I.destroy=function($I){$y.clearCache(this,this._skin),void 0===$I&&($I=!0),$M.prototype.destroy.call(this,$I),this._bg&&this._bg.destroy(),this._bg=null},$I.createChildren=function(){this.addChild(this._tf=new $p),this._tf.padding=$q.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},$I._onFocus=function(){this.event("focus",this)},$I._onBlur=function(){this.event("blur",this)},$I._onInput=function(){this.event("input",this)},$I._onEnter=function(){this.event("enter",this)},$I.initialize=function(){this.width=128,this.height=22},$I.select=function(){this._tf.select()},$I.setSelection=function($I,$M){this._tf.setSelection($I,$M)},$c(0,$I,"text",$M.prototype._$get_text,function($I){this._tf.text!=$I&&($I+="",this._tf.text=$I,this.event("change"))}),$c(0,$I,"bg",function(){return this._bg},function($I){this.graphics=this._bg=$I}),$c(0,$I,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function($I){this._tf.inputElementYAdjuster=$I}),$c(0,$I,"multiline",function(){return this._tf.multiline},function($I){this._tf.multiline=$I}),$c(0,$I,"skin",function(){return this._skin},function($I){this._skin!=$I&&($y.clearCache(this,this._skin),this._skin=$I,this._bg||(this.graphics=this._bg=new $R),$y.keepCache(this,this._skin),this._bg.source=$y.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),$c(0,$I,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function($I){this._bg||(this.graphics=this._bg=new $R),this._bg.sizeGrid=$v.fillArray($q.defaultSizeGrid,$I,Number)}),$c(0,$I,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function($I){this._tf.inputElementXAdjuster=$I}),$c(0,$I,"width",$M.prototype._$get_width,function($I){$V.superSet($l,this,"width",$I),this._bg&&(this._bg.width=$I)}),$c(0,$I,"height",$M.prototype._$get_height,function($I){$V.superSet($l,this,"height",$I),this._bg&&(this._bg.height=$I)}),$c(0,$I,"editable",function(){return this._tf.editable},function($I){this._tf.editable=$I}),$c(0,$I,"restrict",function(){return this._tf.restrict},function($I){this._tf.restrict=$I}),$c(0,$I,"prompt",function(){return this._tf.prompt},function($I){this._tf.prompt=$I}),$c(0,$I,"promptColor",function(){return this._tf.promptColor},function($I){this._tf.promptColor=$I}),$c(0,$I,"maxChars",function(){return this._tf.maxChars},function($I){this._tf.maxChars=$I}),$c(0,$I,"focus",function(){return this._tf.focus},function($I){this._tf.focus=$I}),$c(0,$I,"type",function(){return this._tf.type},function($I){this._tf.type=$I}),$c(0,$I,"asPassword",function(){return this._tf.asPassword},function($I){this._tf.asPassword=$I}),$E}($l),$ZI=function($I){function $M(){$M.__super.call(this)}return $n($M,"laya.ui.VSlider",$k),$M}(),$iI=function($I){function $Z(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,$Z.__super.call(this)}$n($Z,"laya.ui.Dialog",$I);var $M=$Z.prototype;return $M.initialize=function(){this.popupEffect=$Z.manager.popupEffectHandler,this.closeEffect=$Z.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},$M._dealDragArea=function(){var $I=this.getChildByName("drag");$I&&(this.dragArea=$I.x+","+$I.y+","+$I.width+","+$I.height,$I.removeSelf())},$M._onClick=function($I){var $M=$I.target;if($M)switch($M.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close($M.name)}},$M.show=function($I,$M){void 0===$I&&($I=!1),void 0===$M&&($M=!0),this._open(!1,$I,$M)},$M.popup=function($I,$M){void 0===$I&&($I=!1),void 0===$M&&($M=!0),this._open(!0,$I,$M)},$M._open=function($I,$M,$E){$Z.manager.lock(!1),this.isModal=$I,$Z.manager.open(this,$M,$E)},$M.onOpened=function(){},$M.close=function($I,$M){void 0===$M&&($M=!0),$Z.manager.close(this,$I,$M)},$M.onClosed=function($I){},$M._onMouseDown=function($I){var $M=this.getMousePoint();this._dragArea.contains($M.x,$M.y)?this.startDrag():this.stopDrag()},$c(0,$M,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function($I){if($I){var $M=$v.fillArray([0,0,0,0],$I,Number);this._dragArea=new $N($M[0],$M[1],$M[2],$M[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),$c(0,$M,"isPopup",function(){return null!=this.parent}),$c(0,$M,"zOrder",$I.prototype._$get_zOrder,function($I){$V.superSet($e,this,"zOrder",$I),$Z.manager._checkMask()}),$c(1,$Z,"manager",function(){return $Z._manager=$Z._manager||new $L},function($I){$Z._manager=$I}),$Z.setLockView=function($I){$Z.manager.setLockView($I)},$Z.lock=function($I){$Z.manager.lock($I)},$Z.closeAll=function(){$Z.manager.closeAll()},$Z.getDialogsByGroup=function($I){return $Z.manager.getDialogsByGroup($I)},$Z.closeByGroup=function($I){return $Z.manager.closeByGroup($I)},$Z.CLOSE="close",$Z.CANCEL="cancel",$Z.SURE="sure",$Z.NO="no",$Z.OK="ok",$Z.YES="yes",$Z._manager=null,$Z}($e),$nI=function($I){function $M(){$M.__super.call(this)}$n($M,"laya.ui.HBox",$I);var $E=$M.prototype;return $E.sortItem=function($I){$I&&$I.sort(function($I,$M){return $I.x-$M.x})},$E.changeItems=function(){this._itemChanged=!1;for(var $I=[],$M=0,$E=0,$Z=this.numChildren;$E<$Z;$E++){var $i=this.getChildAt($E);$i&&$i.layoutEnabled&&($I.push($i),$M=this._height?this._height:Math.max($M,$i.height*$i.scaleY))}this.sortItem($I);var $n=0;for($E=0,$Z=$I.length;$E<$Z;$E++)($i=$I[$E]).x=$n,$n+=$i.width*$i.scaleX+this._space,"top"==this._align?$i.y=0:"middle"==this._align?$i.y=.5*($M-$i.height*$i.scaleY):"bottom"==this._align&&($i.y=$M-$i.height*$i.scaleY);this.changeSize()},$c(0,$E,"height",$I.prototype._$get_height,function($I){this._height!=$I&&($V.superSet($h,this,"height",$I),this.callLater(this.changeItems))}),$M.NONE="none",$M.TOP="top",$M.MIDDLE="middle",$M.BOTTOM="bottom",$M}($h),$cI=function($I){function $M(){$M.__super.call(this)}$n($M,"laya.ui.VBox",$I);var $E=$M.prototype;return $E.changeItems=function(){this._itemChanged=!1;for(var $I=[],$M=0,$E=0,$Z=this.numChildren;$E<$Z;$E++){var $i=this.getChildAt($E);$i&&$i.layoutEnabled&&($I.push($i),$M=this._width?this._width:Math.max($M,$i.width*$i.scaleX))}this.sortItem($I);var $n=0;for($E=0,$Z=$I.length;$E<$Z;$E++)($i=$I[$E]).y=$n,$n+=$i.height*$i.scaleY+this._space,"left"==this._align?$i.x=0:"center"==this._align?$i.x=.5*($M-$i.width*$i.scaleX):"right"==this._align&&($i.x=$M-$i.width*$i.scaleX);this.changeSize()},$c(0,$E,"width",$I.prototype._$get_width,function($I){this._width!=$I&&($V.superSet($h,this,"width",$I),this.callLater(this.changeItems))}),$M.NONE="none",$M.LEFT="left",$M.CENTER="center",$M.RIGHT="right",$M}($h),$fI=function($I){function $M(){$M.__super.call(this)}return $n($M,"laya.ui.RadioGroup",$s),$M.prototype.createItem=function($I,$M){return new $b($I,$M)},$M}(),$dI=function($I){function $M(){$M.__super.call(this)}return $n($M,"laya.ui.Tab",$s),$M.prototype.createItem=function($I,$M){return new $S($I,$M)},$M}(),$HI=function($M){function $E($I){this._vScrollBar=null,this._hScrollBar=null,void 0===$I&&($I=""),$E.__super.call(this,$I)}$n($E,"laya.ui.TextArea",$M);var $I=$E.prototype;return $I.destroy=function($I){void 0===$I&&($I=!0),$M.prototype.destroy.call(this,$I),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},$I.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},$I.onVBarChanged=function($I){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},$I.onHBarChanged=function($I){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},$I.changeScroll=function(){var $I=this._vScrollBar&&0<this._tf.maxScrollY,$M=this._hScrollBar&&0<this._tf.maxScrollX,$E=$I?this._width-this._vScrollBar.width:this._width,$Z=$M?this._height-this._hScrollBar.height:this._height,$i=this._tf.padding||$q.labelPadding;this._tf.width=$E,this._tf.height=$Z,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-$i[2],this._vScrollBar.y=$i[1],this._vScrollBar.height=this._height-($M?this._hScrollBar.height:0)-$i[1]-$i[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=$Z/Math.max(this._tf.textHeight,$Z),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=$I),this._hScrollBar&&(this._hScrollBar.x=$i[0],this._hScrollBar.y=this._height-this._hScrollBar.height-$i[3],this._hScrollBar.width=this._width-($I?this._vScrollBar.width:0)-$i[0]-$i[2],this._hScrollBar.scrollSize=Math.max(.033*$E,1),this._hScrollBar.thumbPercent=$E/Math.max(this._tf.textWidth,$E),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=$M)},$I.scrollTo=function($I){this.commitMeasure(),this._tf.scrollY=$I},$c(0,$I,"scrollY",function(){return this._tf.scrollY}),$c(0,$I,"width",$M.prototype._$get_width,function($I){$V.superSet($EI,this,"width",$I),this.callLater(this.changeScroll)}),$c(0,$I,"hScrollBar",function(){return this._hScrollBar}),$c(0,$I,"height",$M.prototype._$get_height,function($I){$V.superSet($EI,this,"height",$I),this.callLater(this.changeScroll)}),$c(0,$I,"maxScrollX",function(){return this._tf.maxScrollX}),$c(0,$I,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function($I){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new $MI),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=$I}),$c(0,$I,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function($I){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new $G),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=$I}),$c(0,$I,"vScrollBar",function(){return this._vScrollBar}),$c(0,$I,"maxScrollY",function(){return this._tf.maxScrollY}),$c(0,$I,"scrollX",function(){return this._tf.scrollX}),$E}($EI);!function($I){function $M(){this._uiView=null,this.isCloseOther=!1,$M.__super.call(this)}$n($M,"laya.ui.AsynDialog",$iI);var $E=$M.prototype;$E.createView=function($I){this._uiView=$I},$E._open=function($I,$M,$E){this.isModal=$I,this.isCloseOther=$M,$iI.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},$E.onCreated=function(){this.createUI(),this.onOpen()},$E.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},$E.onOpen=function(){$iI.manager.open(this,this.isCloseOther),$iI.manager.lock(!1)},$E.close=function($I,$M){void 0===$M&&($M=!0),$iI.manager.close(this),this.onClose()},$E.onClose=function(){},$E.destroy=function($I){void 0===$I&&($I=!0),laya.ui.View.prototype.destroy.call(this,$I),this._uiView=null,this.onDestroy()},$E.onDestroy=function(){}}();$V.__init([$e])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($I,$M){"use strict";for(var $E in Object.defineProperty($M,"__esModule",{value:!0}),Laya){var $Z=Laya[$E];$Z&&$Z.__isclass&&($M[$E]=$Z)}}),function($Q,$I,$g){$g.un,$g.uns;var $A=$g.static,$p=$g.class,$t=$g.getset,$Z=$g.__newvec,$w=laya.maths.Arith,$c=laya.webgl.atlas.AtlasResourceManager,$E=laya.webgl.shader.BaseShader,$z=laya.utils.Browser,$f=laya.webgl.utils.Buffer,$O=laya.utils.Byte,$i=laya.utils.ClassUtils,$d=$g.Config,$n=(laya.events.Event,laya.events.EventDispatcher),$q=laya.utils.Handler,$N=laya.net.Loader,$M=laya.net.LoaderManager,$H=(laya.maths.MathUtil,laya.display.Node),$V=laya.renders.Render,$B=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),$u=laya.resource.Resource,$y=laya.utils.RunDriver,$$=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),$a=laya.display.Sprite,$m=laya.utils.Stat,$j=laya.utils.StringKey,$v=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),$T=laya.utils.Utils,$W=laya.webgl.WebGL,$R=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;$g.interface("laya.d3.core.IClone"),$g.interface("laya.d3.graphics.IVertex"),$g.interface("laya.d3.core.render.IUpdate"),$g.interface("laya.d3.core.scene.ITreeNode"),$g.interface("laya.d3.core.render.IRenderable");(function(){function $S(){}$p($S,"laya.d3.animation.AnimationClipParser01"),$S.READ_DATA=function(){$S._DATA.offset=$S._reader.getUint32(),$S._DATA.size=$S._reader.getUint32()},$S.READ_BLOCK=function(){for(var $I=$S._BLOCK.count=$S._reader.getUint16(),$M=$S._BLOCK.blockStarts=[],$E=$S._BLOCK.blockLengths=[],$Z=0;$Z<$I;$Z++)$M.push($S._reader.getUint32()),$E.push($S._reader.getUint32())},$S.READ_STRINGS=function(){var $I=$S._reader.getUint32(),$M=$S._reader.getUint16(),$E=$S._reader.pos;$S._reader.pos=$I+$S._DATA.offset;for(var $Z=0;$Z<$M;$Z++)$S._strings[$Z]=$S._reader.readUTFString();$S._reader.pos=$E},$S.parse=function($I,$M){$S._animationClip=$I;($S._reader=$M).__getBuffer();$S.READ_DATA(),$S.READ_BLOCK(),$S.READ_STRINGS();for(var $E=0,$Z=$S._BLOCK.count;$E<$Z;$E++){var $i=$M.getUint16(),$n=$S._strings[$i],$c=$S["READ_"+$n];if(null==$c)throw new Error("model file err,no this function:"+$i+" "+$n);$c.call()}},$S.READ_ANIMATIONS=function(){var $I,$M=0,$E=0,$Z=$S._reader,$i=$Z.__getBuffer(),$n=[],$c=$Z.getUint8();for($n.length=$c,$M=0;$M<$c;$M++)$n[$M]=$Z.getUint16();var $f=[],$d=$Z.getUint16();for($f.length=$d,$M=0;$M<$d;$M++)$f[$M]=$Z.getFloat32();var $H=$S._animationClip;$H.name=$S._strings[$Z.getUint16()];var $B=$H._duration=$Z.getFloat32();$H.islooping=!!$Z.getByte(),$H._frameRate=$Z.getInt16();var $A=$Z.getInt16(),$Q=$H._nodes=new Array;$Q.length=$A,($H._publicClipDatas=[]).length=$A;var $p=$H._nodesMap={},$t=0,$V=0;for($M=0;$M<$A;$M++){$I=$Q[$M]=new $F;var $u=$Z.getUint16(),$N=$I.path=[];for($N.length=$u,$E=0;$E<$u;$E++)$N[$E]=$S._strings[$Z.getUint16()];var $y=$N.join("/"),$$=$p[$y];$$||($p[$y]=$$=[]),$$.push($I);var $w=$Z.getInt16();-1!==$w&&($I.componentType=$S._strings[$w]);var $g=$r._propertyIndexDic[$S._strings[$Z.getUint16()]];if(null==$g)throw new Error("AnimationClipParser01:unknown property name.");var $O=$g<4,$a=!$O||$O&&""===$N[0];($I._cacheProperty=$a)?$t++:$V++,$I.propertyNameID=$g;var $m=$n[$Z.getUint8()];$I.keyFrameWidth=$m/4;var $j=$I.keyFrames=[],$T=$j.length=$Z.getUint16(),$q=null,$v=NaN;for($E=0;$E<$T;$E++){var $W=$j[$E]=new $l;$v=$W.startTime=$f[$Z.getUint16()];var $R=$Z.pos;$W.inTangent=new Float32Array($i.slice($R,$R+$m)),$Z.pos+=$m,$R=$Z.pos,$W.outTangent=new Float32Array($i.slice($R,$R+$m)),$Z.pos+=$m,$R=$Z.pos,$W.data=new Float32Array($i.slice($R,$R+$m)),$Z.pos+=$m,$q&&($q.next=$W,$q.duration=$v-$q.startTime),$q=$W}$W.next=null,$W.duration=$B-$v}var $z=$H._nodeToCachePropertyMap=new Int32Array($A),$L=$H._cachePropertyMap=new Int32Array($t),$o=$H._unCachePropertyMap=new Int32Array($V);for($t=$V=0,$M=0;$M<$A;$M++)($I=$Q[$M])._cacheProperty?($z[$M]=$t,$L[$t++]=$M):$o[$V++]=$M},$S._animationClip=null,$S._reader=null,$S._strings=[],$A($S,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function $x(){}$p($x,"laya.d3.animation.AnimationClipParser02"),$x.READ_DATA=function(){$x._DATA.offset=$x._reader.getUint32(),$x._DATA.size=$x._reader.getUint32()},$x.READ_BLOCK=function(){for(var $I=$x._BLOCK.count=$x._reader.getUint16(),$M=$x._BLOCK.blockStarts=[],$E=$x._BLOCK.blockLengths=[],$Z=0;$Z<$I;$Z++)$M.push($x._reader.getUint32()),$E.push($x._reader.getUint32())},$x.READ_STRINGS=function(){var $I=$x._reader.getUint32(),$M=$x._reader.getUint16(),$E=$x._reader.pos;$x._reader.pos=$I+$x._DATA.offset;for(var $Z=0;$Z<$M;$Z++)$x._strings[$Z]=$x._reader.readUTFString();$x._reader.pos=$E},$x.parse=function($I,$M){$x._animationClip=$I;($x._reader=$M).__getBuffer();$x.READ_DATA(),$x.READ_BLOCK(),$x.READ_STRINGS();for(var $E=0,$Z=$x._BLOCK.count;$E<$Z;$E++){var $i=$M.getUint16(),$n=$x._strings[$i],$c=$x["READ_"+$n];if(null==$c)throw new Error("model file err,no this function:"+$i+" "+$n);$c.call()}},$x.READ_ANIMATIONS=function(){var $I,$M=0,$E=0,$Z=$x._reader,$i=$Z.__getBuffer(),$n=[],$c=$Z.getUint8();for($n.length=$c,$M=0;$M<$c;$M++)$n[$M]=$Z.getUint16();var $f=[],$d=$Z.getUint16();for($f.length=$d,$M=0;$M<$d;$M++)$f[$M]=$Z.getFloat32();var $H=$x._animationClip;$H.name=$x._strings[$Z.getUint16()];var $B=$H._duration=$Z.getFloat32();$H.islooping=!!$Z.getByte(),$H._frameRate=$Z.getInt16();var $A=$Z.getInt16(),$Q=$H._nodes=new Array;$Q.length=$A,($H._publicClipDatas=[]).length=$A;var $p=$H._nodesMap={},$t=0,$V=0;for($M=0;$M<$A;$M++){$I=$Q[$M]=new $F;var $u=$Z.getUint16(),$N=$I.path=[];for($N.length=$u,$E=0;$E<$u;$E++)$N[$E]=$x._strings[$Z.getUint16()];var $y=$N.join("/"),$$=$p[$y];$$||($p[$y]=$$=[]),$$.push($I);var $w=$Z.getInt16();-1!==$w&&($I.componentType=$x._strings[$w]);var $g=$r._propertyIndexDic[$x._strings[$Z.getUint16()]];if(null==$g)throw new Error("AnimationClipParser02:unknown property name.");var $O=$g<4,$a=!$O||$O&&""===$N[0];($I._cacheProperty=$a)?$t++:$V++,$I.propertyNameID=$g;var $m=$n[$Z.getUint8()];$I.keyFrameWidth=$m/4;var $j=$I.keyFrames=[],$T=$j.length=$Z.getUint16(),$q=null,$v=NaN;for($E=0;$E<$T;$E++){var $W=$j[$E]=new $l;$v=$W.startTime=$f[$Z.getUint16()];var $R=$Z.pos;$W.inTangent=new Float32Array($i.slice($R,$R+$m)),$Z.pos+=$m,$R=$Z.pos,$W.outTangent=new Float32Array($i.slice($R,$R+$m)),$Z.pos+=$m,$R=$Z.pos,$W.data=new Float32Array($i.slice($R,$R+$m)),$Z.pos+=$m,$q&&($q.next=$W,$q.duration=$v-$q.startTime),$q=$W}$W.next=null,$W.duration=$B-$v}var $z=$Z.getUint16();for($M=0;$M<$z;$M++){var $L,$o=new $k;$o.time=$Z.getFloat32(),$o.eventName=$x._strings[$Z.getUint16()];var $S=$Z.getUint16();for(0<$S&&($o.params=$L=[]),$E=0;$E<$S;$E++){switch($Z.getByte()){case 0:$L.push(!!$Z.getByte());break;case 1:$L.push($Z.getInt32());break;case 2:$L.push($Z.getFloat32());break;case 3:$L.push($x._strings[$Z.getUint16()]);break;default:throw new Error("unknown type.")}}$H.addEvent($o)}var $X=$H._nodeToCachePropertyMap=new Int32Array($A),$C=$H._cachePropertyMap=new Int32Array($t),$J=$H._unCachePropertyMap=new Int32Array($V);for($t=$V=0,$M=0;$M<$A;$M++)($I=$Q[$M])._cacheProperty?($X[$M]=$t,$C[$t++]=$M):$J[$V++]=$M},$x._animationClip=null,$x._reader=null,$x._strings=[],$A($x,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var $k=function(){function $I(){this.time=NaN,this.eventName=null,this.params=null}return $p($I,"laya.d3.animation.AnimationEvent"),$I}(),$r=function(){function $Z(){this._childs=[],this.transform=new $yM(this)}$p($Z,"laya.d3.animation.AnimationNode");var $I=$Z.prototype;return $g.imps($I,{"laya.d3.core.IClone":!0}),$I.addChild=function($I){$I._parent=this,$I.transform.setParent(this.transform),this._childs.push($I)},$I.removeChild=function($I){var $M=this._childs.indexOf($I);-1!==$M&&this._childs.splice($M,1)},$I.getChildByName=function($I){for(var $M=0,$E=this._childs.length;$M<$E;$M++){var $Z=this._childs[$M];if($Z.name===$I)return $Z}return null},$I.getChildByIndex=function($I){return this._childs[$I]},$I.getChildCount=function(){return this._childs.length},$I.cloneTo=function($I){var $M=$I;$M.name=this.name;for(var $E=0,$Z=this._childs.length;$E<$Z;$E++){var $i=this._childs[$E],$n=$i.clone();$M.addChild($n);var $c=$i.transform,$f=$n.transform;$f.setLocalPosition($c.getLocalPosition()),$f.setLocalRotation($c.getLocalRotation()),$f.setLocalScale($c.getLocalScale()),$f._localRotationEuler=$c._localRotationEuler,$f._setWorldMatrixIgnoreUpdate($c.getWorldMatrix())}},$I.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$Z.__init__=function(){$Z.registerAnimationNodeProperty("localPosition",$Z._getLocalPosition,$Z._setLocalPosition),$Z.registerAnimationNodeProperty("localRotation",$Z._getLocalRotation,$Z._setLocalRotation),$Z.registerAnimationNodeProperty("localScale",$Z._getLocalScale,$Z._setLocalScale),$Z.registerAnimationNodeProperty("localRotationEuler",$Z._getLocalRotationEuler,$Z._setLocalRotationEuler),$Z.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",$Z._getParticleRenderSharedMaterialTintColor,$Z._setParticleRenderSharedMaterialTintColor),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",$Z._getMeshRenderSharedMaterialTilingOffset,$Z._setMeshRenderSharedMaterialTilingOffset),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",$Z._getMeshRenderSharedMaterialAlbedo,$Z._setMeshRenderSharedMaterialAlbedo),$Z.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",$Z._getSkinnedMeshRenderSharedMaterialTilingOffset,$Z._setSkinnedMeshRenderSharedMaterialTilingOffset),$Z.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",$Z._getSkinnedMeshRenderSharedMaterialAlbedo,$Z._setSkinnedMeshRenderSharedMaterialAlbedo),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",$Z._getMeshRenderSharedMaterialAlbedo,$Z._setMeshRenderSharedMaterialAlbedo),$Z.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",$Z._getSkinnedMeshRenderSharedMaterialAlbedo,$Z._setSkinnedMeshRenderSharedMaterialAlbedo),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",$Z._getMeshRenderSharedMaterialIntensity,$Z._setMeshRenderSharedMaterialIntensity),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",$Z._getMeshRenderSharedMaterialAlpha,$Z._setMeshRenderSharedMaterialAlpha),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",$Z._getMeshRenderSharedMaterialAlphaColor,$Z._setMeshRenderSharedMaterialAlphaColor),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",$Z._getMeshRenderSharedMaterialBaseColor,$Z._setMeshRenderSharedMaterialBaseColor),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",$Z._getMeshRenderSharedMaterialDissolve,$Z._setMeshRenderSharedMaterialDissolve),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",$Z._getMeshRenderSharedMaterialDissolveSpeed,$Z._setMeshRenderSharedMaterialDissolveSpeed),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",$Z._getMeshRenderSharedMaterialMMultiplier,$Z._setMeshRenderSharedMaterialMMultiplier),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",$Z._getMeshRenderSharedMaterialBaseScrollSpeedX,$Z._setMeshRenderSharedMaterialBaseScrollSpeedX),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",$Z._getMeshRenderSharedMaterialBaseScrollSpeedY,$Z._setMeshRenderSharedMaterialBaseScrollSpeedY),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",$Z._getMeshRenderSharedMaterialSecondScrollSpeedX,$Z._setMeshRenderSharedMaterialSecondScrollSpeedX),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",$Z._getMeshRenderSharedMaterialSecondScrollSpeedY,$Z._setMeshRenderSharedMaterialSecondScrollSpeedY),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",$Z._getMeshRenderSharedMaterialDetailTilingOffset,$Z._setMeshRenderSharedMaterialDetailTilingOffset),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",$Z._getMeshRenderSharedMaterialDissolveTilingOffset,$Z._setMeshRenderSharedMaterialDissolveTilingOffset),$Z.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",$Z._getMeshRenderSharedMaterialMaskTilingOffset,$Z._setMeshRenderSharedMaterialMaskTilingOffset)},$Z.registerAnimationNodeProperty=function($I,$M,$E){if($Z._propertyIndexDic[$I])throw new Error("AnimationNode: this propertyName has registered.");$Z._propertyIndexDic[$I]=$Z._propertyIDCounter,$Z._propertyGetFuncs[$Z._propertyIDCounter]=$M,$Z._propertySetFuncs[$Z._propertyIDCounter]=$E,$Z._propertyIDCounter++},$Z._getLocalPosition=function($I,$M){return $I?$I.transform.getLocalPosition():$M._transform.localPosition.elements},$Z._setLocalPosition=function($I,$M,$E){if($I)$I.transform.setLocalPosition($E);else{var $Z=$M._transform,$i=$Z.localPosition;$i.elements=$E,$Z.localPosition=$i}},$Z._getLocalRotation=function($I,$M){return $I?$I.transform.getLocalRotation():$M._transform.localRotation.elements},$Z._setLocalRotation=function($I,$M,$E){if($I)$I.transform.setLocalRotation($E);else{var $Z=$M._transform,$i=$Z.localRotation;$i.elements=$E,$Z.localRotation=$i}},$Z._getLocalScale=function($I,$M){return $I?$I.transform.getLocalScale():$M._transform.localScale.elements},$Z._setLocalScale=function($I,$M,$E){if($I)$I.transform.setLocalScale($E);else{var $Z=$M._transform,$i=$Z.localScale;$i.elements=$E,$Z.localScale=$i}},$Z._getLocalRotationEuler=function($I,$M){return $I?$I.transform.getLocalRotationEuler():$M._transform.localRotationEuler.elements},$Z._setLocalRotationEuler=function($I,$M,$E){if($I)$I.transform.setLocalRotationEuler($E);else{var $Z=$M._transform,$i=$Z.localRotationEuler;$i.elements=$E,$Z.localRotationEuler=$i}},$Z._getMeshRenderSharedMaterialTilingOffset=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return $M.meshRender.sharedMaterial.tilingOffset.elements},$Z._setMeshRenderSharedMaterialTilingOffset=function($I,$M,$E){var $Z,$i;if($I){var $n=$I.transform._entity;$n&&(($i=($Z=$n.owner.meshRender.material).tilingOffset).elements=$E,$Z.tilingOffset=$i)}else($i=($Z=$M.meshRender.material).tilingOffset).elements=$E,$Z.tilingOffset=$i},$Z._getMeshRenderSharedMaterialAlbedo=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.albedoColor.elements:null}return $M.meshRender.sharedMaterial.albedoColor.elements},$Z._setMeshRenderSharedMaterialAlbedo=function($I,$M,$E){var $Z,$i;if($I){var $n=$I.transform._entity;$n&&(($i=($Z=$n.owner.meshRender.material).albedoColor).elements=$E,$Z.albedoColor=$i)}else($i=($Z=$M.meshRender.material).albedoColor).elements=$E,$Z.albedoColor=$i},$Z._getSkinnedMeshRenderSharedMaterialTilingOffset=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return $M.skinnedMeshRender.sharedMaterial.tilingOffset.elements},$Z._setSkinnedMeshRenderSharedMaterialTilingOffset=function($I,$M,$E){var $Z,$i;if($I){var $n=$I.transform._entity;$n&&(($i=($Z=$n.owner.skinnedMeshRender.material).tilingOffset).elements=$E,$Z.tilingOffset=$i)}else($i=($Z=$M.skinnedMeshRender.material).tilingOffset).elements=$E,$Z.tilingOffset=$i},$Z._getSkinnedMeshRenderSharedMaterialAlbedo=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return $M.skinnedMeshRender.sharedMaterial.albedoColor.elements},$Z._setSkinnedMeshRenderSharedMaterialAlbedo=function($I,$M,$E){var $Z,$i;if($I){var $n=$I.transform._entity;$n&&(($i=($Z=$n.owner.skinnedMeshRender.material).albedoColor).elements=$E,$Z.albedoColor=$i)}else($i=($Z=$M.skinnedMeshRender.material).albedoColor).elements=$E,$Z.albedoColor=$i},$Z._getParticleRenderSharedMaterialTintColor=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.particleRender.sharedMaterial.tintColor.elements:null}return $M.particleRender.sharedMaterial.tintColor.elements},$Z._setParticleRenderSharedMaterialTintColor=function($I,$M,$E){var $Z,$i;if($I){var $n=$I.transform._entity;$n&&(($i=($Z=$n.owner.particleRender.material).tintColor).elements=$E,$Z.tintColor=$i)}else($i=($Z=$M.particleRender.material).tintColor).elements=$E,$Z.tintColor=$i},$Z._getMeshRenderSharedMaterialAlphaColor=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.alphaColor.elements:null}return $M.meshRender.sharedMaterial.alphaColor.elements},$Z._setMeshRenderSharedMaterialAlphaColor=function($I,$M,$E){var $Z,$i;if($I){var $n=$I.transform._entity;$n&&(($i=($Z=$n.owner.meshRender.material).alphaColor).elements=$E,$Z.alphaColor=$i)}else($i=($Z=$M.meshRender.material).alphaColor).elements=$E,$Z.alphaColor=$i},$Z._getMeshRenderSharedMaterialBaseColor=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.baseColor.elements:null}return $M.meshRender.sharedMaterial.baseColor.elements},$Z._setMeshRenderSharedMaterialBaseColor=function($I,$M,$E){var $Z,$i;if($I){var $n=$I.transform._entity;$n&&(($i=($Z=$n.owner.meshRender.material).baseColor).elements=$E,$Z.baseColor=$i)}else($i=($Z=$M.meshRender.material).baseColor).elements=$E,$Z.baseColor=$i},$Z._getMeshRenderSharedMaterialDissolve=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.dissolve:0}return $M.meshRender.sharedMaterial.dissolve},$Z._setMeshRenderSharedMaterialDissolve=function($I,$M,$E){if($I){var $Z=$I.transform._entity;$Z&&($Z.owner.meshRender.material.dissolve=$E[0])}else $M.meshRender.material.dissolve=$E[0]},$Z._getMeshRenderSharedMaterialDissolveSpeed=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.dissolveSpeed:0}return $M.meshRender.sharedMaterial.dissolveSpeed},$Z._setMeshRenderSharedMaterialDissolveSpeed=function($I,$M,$E){if($I){var $Z=$I.transform._entity;$Z&&($Z.owner.meshRender.material.dissolveSpeed=$E[0])}else $M.meshRender.material.dissolveSpeed=$E[0]},$Z._getMeshRenderSharedMaterialMMultiplier=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.mMultiplier:0}return $M.meshRender.sharedMaterial.mMultiplier},$Z._setMeshRenderSharedMaterialMMultiplier=function($I,$M,$E){if($I){var $Z=$I.transform._entity;$Z&&($Z.owner.meshRender.material.mMultiplier=$E[0])}else $M.meshRender.material.mMultiplier=$E[0]},$Z._getMeshRenderSharedMaterialBaseScrollSpeedX=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return $M.meshRender.sharedMaterial.baseScrollSpeedX},$Z._setMeshRenderSharedMaterialBaseScrollSpeedX=function($I,$M,$E){if($I){var $Z=$I.transform._entity;$Z&&($Z.owner.meshRender.material.baseScrollSpeedX=$E[0])}else $M.meshRender.material.baseScrollSpeedX=$E[0]},$Z._getMeshRenderSharedMaterialBaseScrollSpeedY=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return $M.meshRender.sharedMaterial.baseScrollSpeedY},$Z._setMeshRenderSharedMaterialBaseScrollSpeedY=function($I,$M,$E){if($I){var $Z=$I.transform._entity;$Z&&($Z.owner.meshRender.material.baseScrollSpeedY=$E[0])}else $M.meshRender.material.baseScrollSpeedY=$E[0]},$Z._getMeshRenderSharedMaterialSecondScrollSpeedX=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return $M.meshRender.sharedMaterial.secondScrollSpeedX},$Z._setMeshRenderSharedMaterialSecondScrollSpeedX=function($I,$M,$E){if($I){var $Z=$I.transform._entity;$Z&&($Z.owner.meshRender.material.secondScrollSpeedX=$E[0])}else $M.meshRender.material.secondScrollSpeedX=$E[0]},$Z._getMeshRenderSharedMaterialSecondScrollSpeedY=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return $M.meshRender.sharedMaterial.secondScrollSpeedY},$Z._setMeshRenderSharedMaterialSecondScrollSpeedY=function($I,$M,$E){if($I){var $Z=$I.transform._entity;$Z&&($Z.owner.meshRender.material.secondScrollSpeedY=$E[0])}else $M.meshRender.material.secondScrollSpeedY=$E[0]},$Z._getMeshRenderSharedMaterialAlpha=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.alpha:0}return $M.meshRender.sharedMaterial.alpha},$Z._setMeshRenderSharedMaterialAlpha=function($I,$M,$E){if($I){var $Z=$I.transform._entity;$Z&&($Z.owner.meshRender.material.alpha=$E[0])}else $M.meshRender.material.alpha=$E[0]},$Z._getMeshRenderSharedMaterialIntensity=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.intensity:0}return $M.meshRender.sharedMaterial.intensity},$Z._setMeshRenderSharedMaterialIntensity=function($I,$M,$E){if($I){var $Z=$I.transform._entity;$Z&&($Z.owner.meshRender.material.intensity=$E[0])}else $M.meshRender.material.intensity=$E[0]},$Z._getMeshRenderSharedMaterialDetailTilingOffset=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return $M.meshRender.sharedMaterial.detailTilingOffset.elements},$Z._setMeshRenderSharedMaterialDetailTilingOffset=function($I,$M,$E){var $Z,$i;if($I){var $n=$I.transform._entity;$n&&(($i=($Z=$n.owner.meshRender.material).detailTilingOffset).elements=$E,$Z.detailTilingOffset=$i)}else($i=($Z=$M.meshRender.material).detailTilingOffset).elements=$E,$Z.detailTilingOffset=$i},$Z._getMeshRenderSharedMaterialDissolveTilingOffset=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return $M.meshRender.sharedMaterial.dissolveTilingOffset.elements},$Z._setMeshRenderSharedMaterialDissolveTilingOffset=function($I,$M,$E){var $Z,$i;if($I){var $n=$I.transform._entity;$n&&(($i=($Z=$n.owner.meshRender.material).dissolveTilingOffset).elements=$E,$Z.dissolveTilingOffset=$i)}else($i=($Z=$M.meshRender.material).dissolveTilingOffset).elements=$E,$Z.dissolveTilingOffset=$i},$Z._getMeshRenderSharedMaterialMaskTilingOffset=function($I,$M){if($I){var $E=$I.transform._entity;return $E?$E.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return $M.meshRender.sharedMaterial.maskTilingOffset.elements},$Z._setMeshRenderSharedMaterialMaskTilingOffset=function($I,$M,$E){var $Z,$i;if($I){var $n=$I.transform._entity;$n&&(($i=($Z=$n.owner.meshRender.material).maskTilingOffset).elements=$E,$Z.maskTilingOffset=$i)}else($i=($Z=$M.meshRender.material).maskTilingOffset).elements=$E,$Z.maskTilingOffset=$i},$Z._propertyIDCounter=0,$Z._propertyIndexDic={},$Z._propertySetFuncs=[],$Z._propertyGetFuncs=[],$Z}(),$l=function(){function $I(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return $p($I,"laya.d3.animation.Keyframe"),$I}(),$F=function(){function $I(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return $p($I,"laya.d3.animation.KeyframeNode"),$I}(),$L=(function(){function $I(){this._tempVector30=new $cM,this._tempVector31=new $cM,this._tempVector32=new $cM,this._a=new $cM,this._b=new $cM,this._c=new $cM,this._d=new $cM}$p($I,"laya.d3.core.glitter.SplineCurvePositionVelocity");var $M=$I.prototype;$M.Init=function($I,$M,$E,$Z){$I.cloneTo(this._d),$M.cloneTo(this._c),$cM.scale($I,2,this._a),$cM.scale($E,2,this._tempVector30),$cM.subtract(this._a,this._tempVector30,this._a),$cM.add(this._a,$M,this._a),$cM.add(this._a,$Z,this._a),$cM.scale($E,3,this._b),$cM.scale($I,3,this._tempVector30),$cM.subtract(this._b,this._tempVector30,this._b),$cM.subtract(this._b,$Z,this._b),$cM.scale($M,2,this._tempVector30),$cM.subtract(this._b,this._tempVector30,this._b)},$M.Slerp=function($I,$M){$cM.scale(this._a,$I*$I*$I,this._tempVector30),$cM.scale(this._b,$I*$I,this._tempVector31),$cM.scale(this._c,$I,this._tempVector32),$cM.add(this._tempVector30,this._tempVector31,$M),$cM.add($M,this._tempVector32,$M),$cM.add($M,this._d,$M)}}(),function(){function $C($I,$M,$E,$Z){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=$I,this._h=$M,this._minHeight=$E,this._maxHeight=$Z}$p($C,"laya.d3.core.HeightMap");var $I=$C.prototype;$I._inBounds=function($I,$M){return 0<=$I&&$I<this._h&&0<=$M&&$M<this._w},$I.getHeight=function($I,$M){return this._inBounds($I,$M)?this._datas[$I][$M]:NaN},$t(0,$I,"width",function(){return this._w}),$t(0,$I,"height",function(){return this._h}),$t(0,$I,"maxHeight",function(){return this._maxHeight}),$t(0,$I,"minHeight",function(){return this._minHeight}),$C.creatFromMesh=function($I,$M,$E,$Z){for(var $i=[],$n=[],$c=$I.getSubMeshCount(),$f=0;$f<$c;$f++){for(var $d=$I.getSubMesh($f),$H=$d._getVertexBuffer(),$B=$H.getData(),$A=[],$Q=0;$Q<$B.length;$Q+=$H.vertexDeclaration.vertexStride/4){var $p=new $cM($B[$Q+0],$B[$Q+1],$B[$Q+2]);$A.push($p)}$i.push($A);var $t=$d._getIndexBuffer();$n.push($t.getData())}var $V=$I.boundingBox,$u=$V.min.x,$N=$V.min.z,$y=$V.max.x,$$=$V.max.z,$w=$V.min.y,$g=$V.max.y,$O=$y-$u,$a=$$-$N,$m=$Z.elements[0]=$O/($M-1),$j=$Z.elements[1]=$a/($E-1),$T=new $C($M,$E,$w,$g),$q=$C._tempRay,$v=$q.direction.elements;$v[0]=0,$v[1]=-1,$v[2]=0;var $W=$g+.1;$q.origin.elements[1]=$W;for(var $R=0;$R<$E;$R++){var $z=$N+$R*$j;$T._datas[$R]=[];for(var $L=0;$L<$M;$L++){var $o=$u+$L*$m,$S=$q.origin.elements;$S[0]=$o,$S[2]=$z;var $X=$C._getPosition($q,$i,$n);$T._datas[$R][$L]=$X===Number.MAX_VALUE?NaN:$W-$X}}return $T},$C.createFromImage=function($I,$M,$E){for(var $Z=$I.width,$i=$I.height,$n=new $C($Z,$i,$M,$E),$c=($E-$M)/254,$f=$I.getPixels(),$d=0,$H=0;$H<$i;$H++)for(var $B=$n._datas[$H]=[],$A=0;$A<$Z;$A++){var $Q=$f[$d++],$p=$f[$d++],$t=$f[$d++],$V=$f[$d++];$B[$A]=255==$Q&&255==$p&&255==$t&&255==$V?NaN:($Q+$p+$t)/3*$c+$M}return $n},$C._getPosition=function($I,$M,$E){for(var $Z=Number.MAX_VALUE,$i=0;$i<$M.length;$i++)for(var $n=$M[$i],$c=$E[$i],$f=0;$f<$c.length;$f+=3){var $d=$n[$c[$f+0]],$H=$n[$c[$f+1]],$B=$n[$c[$f+2]],$A=$tM.rayIntersectsTriangle($I,$d,$H,$B);!isNaN($A)&&$A<$Z&&($Z=$A)}return $Z},$A($C,["_tempRay",function(){return this._tempRay=new $iM(new $cM,new $cM)}])}(),function(){function $i(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}$p($i,"laya.d3.core.Layer");var $I=$i.prototype;return $I._binarySearchIndex=function(){for(var $I=0,$M=$i._collsionTestList.length-1,$E=0;$I<=$M;){$E=Math.floor(($I+$M)/2);var $Z=$i._collsionTestList[$E];if($Z==this._number)return $E;$Z>this._number?$M=$E-1:$I=$E+1}return $I},$I._addCollider=function($I){0===this._colliders.length&&$i._collsionTestList.splice(this._binarySearchIndex(),0,this._number),$I._isRigidbody?(this._colliders.unshift($I),this._nonRigidbodyOffset++):this._colliders.push($I)},$I._removeCollider=function($I){var $M=this._colliders.indexOf($I);$M<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice($M,1),0===this._colliders.length&&$i._collsionTestList.splice($i._collsionTestList.indexOf(this._number),1)},$t(0,$I,"number",function(){return this._number}),$t(0,$I,"visible",function(){return this._visible},function($I){this._visible=$I,$i._visibleLayers=$I?$i._visibleLayers|this.mask:$i._visibleLayers&~this.mask}),$t(0,$I,"mask",function(){return this._mask}),$t(1,$i,"visibleLayers",function(){return $i._visibleLayers},function($I){$i._visibleLayers=$I;for(var $M=0,$E=$i._layerList.length;$M<$E;$M++){var $Z=$i._layerList[$M];$Z._visible=0!=($Z._mask&$i._visibleLayers)}}),$i.__init__=function(){$i._layerList.length=31;for(var $I=0;$I<31;$I++){var $M=new $i;$i._layerList[$I]=$M,0===$I?($M.name="Default Layer",$M.visible=!0):($M.name="Layer-"+$I,$M.visible=!1),$M._number=$I,$M._mask=Math.pow(2,$I)}$i.currentCreationLayer=$i._layerList[0]},$i.getLayerByNumber=function($I){if($I<0||30<$I)throw new Error("无法返回指定Layer，该number超出范围！");return $i._layerList[$I]},$i.getLayerByName=function($I){for(var $M=0;$M<31;$M++)if($i._layerList[$M].name===$I)return $i._layerList[$M];throw new Error("无法返回指定Layer,该name不存在")},$i.isVisible=function($I){return 0!=($I&$i._currentCameraCullingMask&$i._visibleLayers)},$i._layerList=[],$i._visibleLayers=2147483647,$i._collsionTestList=[],$i._currentCameraCullingMask=2147483647,$i.maxCount=31,$i.currentCreationLayer=null,$i}()),$o=(function(){function $I($I,$M,$E){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=$I,this._minCount=$M,this._maxCount=$E}$p($I,"laya.d3.core.particleShuriKen.module.Burst");var $M=$I.prototype;$g.imps($M,{"laya.d3.core.IClone":!0}),$M.cloneTo=function($I){var $M=$I;$M._time=this._time,$M._minCount=this._minCount,$M._maxCount=this._maxCount},$M.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$M,"time",function(){return this._time}),$t(0,$M,"minCount",function(){return this._minCount}),$t(0,$M,"maxCount",function(){return this._maxCount})}(),function(){function $I($I){this._color=null,this.enbale=!1,this._color=$I}$p($I,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var $M=$I.prototype;$M.cloneTo=function($I){var $M=$I;this._color.cloneTo($M._color),$M.enbale=this.enbale},$M.clone=function(){var $I;switch(this._color.type){case 0:$I=$X.createByConstant(this._color.constant.clone());break;case 1:$I=$X.createByGradient(this._color.gradient.clone());break;case 2:$I=$X.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:$I=$X.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var $M=new this.constructor($I);return $M.enbale=this.enbale,$M},$t(0,$M,"color",function(){return this._color})}(),function(){function $I(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}$p($I,"laya.d3.core.particleShuriKen.module.Emission");var $M=$I.prototype;$g.imps($M,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),$M._destroy=function(){this._bursts=null,this._destroyed=!0},$M.getBurstsCount=function(){return this._bursts.length},$M.getBurstByIndex=function($I){return this._bursts[$I]},$M.addBurst=function($I){var $M=this._bursts.length;if(0<$M)for(var $E=0;$E<$M;$E++)this._bursts[$E].time>$I.time&&this._bursts.splice($E,0,$I);this._bursts.push($I)},$M.removeBurst=function($I){var $M=this._bursts.indexOf($I);-1!==$M&&this._bursts.splice($M,1)},$M.removeBurstByIndex=function($I){this._bursts.splice($I,1)},$M.clearBurst=function(){this._bursts.length=0},$M.cloneTo=function($I){var $M=$I,$E=$M._bursts;$E.length=this._bursts.length;for(var $Z=0,$i=this._bursts.length;$Z<$i;$Z++){var $n=$E[$Z];$n?this._bursts[$Z].cloneTo($n):$E[$Z]=this._bursts[$Z].clone()}$M._emissionRate=this._emissionRate,$M.enbale=this.enbale},$M.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$M,"destroyed",function(){return this._destroyed}),$t(0,$M,"emissionRate",function(){return this._emissionRate},function($I){if($I<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=$I})}(),function(){function $Z(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}$p($Z,"laya.d3.core.particleShuriKen.module.FrameOverTime");var $I=$Z.prototype;return $g.imps($I,{"laya.d3.core.IClone":!0}),$I.cloneTo=function($I){var $M=$I;$M._type=this._type,$M._constant=this._constant,this._overTime.cloneTo($M._overTime),$M._constantMin=this._constantMin,$M._constantMax=this._constantMax,this._overTimeMin.cloneTo($M._overTimeMin),this._overTimeMax.cloneTo($M._overTimeMax)},$I.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$I,"frameOverTimeData",function(){return this._overTime}),$t(0,$I,"constant",function(){return this._constant}),$t(0,$I,"type",function(){return this._type}),$t(0,$I,"frameOverTimeDataMin",function(){return this._overTimeMin}),$t(0,$I,"constantMin",function(){return this._constantMin}),$t(0,$I,"frameOverTimeDataMax",function(){return this._overTimeMax}),$t(0,$I,"constantMax",function(){return this._constantMax}),$Z.createByConstant=function($I){var $M=new $Z;return $M._type=0,$M._constant=$I,$M},$Z.createByOverTime=function($I){var $M=new $Z;return $M._type=1,$M._overTime=$I,$M},$Z.createByRandomTwoConstant=function($I,$M){var $E=new $Z;return $E._type=2,$E._constantMin=$I,$E._constantMax=$M,$E},$Z.createByRandomTwoOverTime=function($I,$M){var $E=new $Z;return $E._type=3,$E._overTimeMin=$I,$E._overTimeMax=$M,$E},$Z}()),$S=function(){function $H(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}$p($H,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var $I=$H.prototype;return $g.imps($I,{"laya.d3.core.IClone":!0}),$I.cloneTo=function($I){var $M=$I;$M._type=this._type,$M._separateAxes=this._separateAxes,$M._constant=this._constant,this._constantSeparate.cloneTo($M._constantSeparate),this._gradient.cloneTo($M._gradient),this._gradientX.cloneTo($M._gradientX),this._gradientY.cloneTo($M._gradientY),this._gradientZ.cloneTo($M._gradientZ),$M._constantMin=this._constantMin,$M._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($M._constantMinSeparate),this._constantMaxSeparate.cloneTo($M._constantMaxSeparate),this._gradientMin.cloneTo($M._gradientMin),this._gradientMax.cloneTo($M._gradientMax),this._gradientXMin.cloneTo($M._gradientXMin),this._gradientXMax.cloneTo($M._gradientXMax),this._gradientYMin.cloneTo($M._gradientYMin),this._gradientYMax.cloneTo($M._gradientYMax),this._gradientZMin.cloneTo($M._gradientZMin),this._gradientZMax.cloneTo($M._gradientZMax)},$I.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$I,"gradientZ",function(){return this._gradientZ}),$t(0,$I,"constant",function(){return this._constant}),$t(0,$I,"gradient",function(){return this._gradient}),$t(0,$I,"separateAxes",function(){return this._separateAxes}),$t(0,$I,"type",function(){return this._type}),$t(0,$I,"constantSeparate",function(){return this._constantSeparate}),$t(0,$I,"gradientX",function(){return this._gradientX}),$t(0,$I,"gradientY",function(){return this._gradientY}),$t(0,$I,"gradientW",function(){return this._gradientW}),$t(0,$I,"gradientMin",function(){return this._gradientMin}),$t(0,$I,"constantMin",function(){return this._constantMin}),$t(0,$I,"gradientMax",function(){return this._gradientMax}),$t(0,$I,"constantMax",function(){return this._constantMax}),$t(0,$I,"gradientWMin",function(){return this._gradientWMin}),$t(0,$I,"constantMinSeparate",function(){return this._constantMinSeparate}),$t(0,$I,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$t(0,$I,"gradientXMin",function(){return this._gradientXMin}),$t(0,$I,"gradientXMax",function(){return this._gradientXMax}),$t(0,$I,"gradientWMax",function(){return this._gradientWMax}),$t(0,$I,"gradientYMin",function(){return this._gradientYMin}),$t(0,$I,"gradientYMax",function(){return this._gradientYMax}),$t(0,$I,"gradientZMin",function(){return this._gradientZMin}),$t(0,$I,"gradientZMax",function(){return this._gradientZMax}),$H.createByConstant=function($I){var $M=new $H;return $M._type=0,$M._separateAxes=!1,$M._constant=$I,$M},$H.createByConstantSeparate=function($I){var $M=new $H;return $M._type=0,$M._separateAxes=!0,$M._constantSeparate=$I,$M},$H.createByGradient=function($I){var $M=new $H;return $M._type=1,$M._separateAxes=!1,$M._gradient=$I,$M},$H.createByGradientSeparate=function($I,$M,$E,$Z){var $i=new $H;return $i._type=1,$i._separateAxes=!0,$i._gradientX=$I,$i._gradientY=$M,$i._gradientZ=$E,$i._gradientW=$Z,$i},$H.createByRandomTwoConstant=function($I,$M){var $E=new $H;return $E._type=2,$E._separateAxes=!1,$E._constantMin=$I,$E._constantMax=$M,$E},$H.createByRandomTwoConstantSeparate=function($I,$M){var $E=new $H;return $E._type=2,$E._separateAxes=!0,$E._constantMinSeparate=$I,$E._constantMaxSeparate=$M,$E},$H.createByRandomTwoGradient=function($I,$M){var $E=new $H;return $E._type=3,$E._separateAxes=!1,$E._gradientMin=$I,$E._gradientMax=$M,$E},$H.createByRandomTwoGradientSeparate=function($I,$M,$E,$Z,$i,$n,$c,$f){var $d=new $H;return $d._type=3,$d._separateAxes=!0,$d._gradientXMin=$I,$d._gradientXMax=$M,$d._gradientYMin=$E,$d._gradientYMax=$Z,$d._gradientZMin=$i,$d._gradientZMax=$n,$d._gradientWMin=$c,$d._gradientWMax=$f,$d},$H}(),$X=function(){function $Z(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}$p($Z,"laya.d3.core.particleShuriKen.module.GradientColor");var $I=$Z.prototype;return $g.imps($I,{"laya.d3.core.IClone":!0}),$I.cloneTo=function($I){var $M=$I;$M._type=this._type,this._constant.cloneTo($M._constant),this._constantMin.cloneTo($M._constantMin),this._constantMax.cloneTo($M._constantMax),this._gradient.cloneTo($M._gradient),this._gradientMin.cloneTo($M._gradientMin),this._gradientMax.cloneTo($M._gradientMax)},$I.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$I,"gradient",function(){return this._gradient}),$t(0,$I,"constant",function(){return this._constant}),$t(0,$I,"type",function(){return this._type}),$t(0,$I,"gradientMin",function(){return this._gradientMin}),$t(0,$I,"constantMin",function(){return this._constantMin}),$t(0,$I,"gradientMax",function(){return this._gradientMax}),$t(0,$I,"constantMax",function(){return this._constantMax}),$Z.createByConstant=function($I){var $M=new $Z;return $M._type=0,$M._constant=$I,$M},$Z.createByGradient=function($I){var $M=new $Z;return $M._type=1,$M._gradient=$I,$M},$Z.createByRandomTwoConstant=function($I,$M){var $E=new $Z;return $E._type=2,$E._constantMin=$I,$E._constantMax=$M,$E},$Z.createByRandomTwoGradient=function($I,$M){var $E=new $Z;return $E._type=3,$E._gradientMin=$I,$E._gradientMax=$M,$E},$Z}(),$C=(function(){function $I(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}$p($I,"laya.d3.core.particleShuriKen.module.GradientDataColor");var $M=$I.prototype;$g.imps($M,{"laya.d3.core.IClone":!0}),$M.addAlpha=function($I,$M){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==$I&&($I=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=$I,this._alphaElements[this._alphaCurrentLength++]=$M):DEBUG},$M.addRGB=function($I,$M){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==$I&&($I=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=$I,this._rgbElements[this._rgbCurrentLength++]=$M.x,this._rgbElements[this._rgbCurrentLength++]=$M.y,this._rgbElements[this._rgbCurrentLength++]=$M.z):DEBUG},$M.cloneTo=function($I){var $M=$I,$E=0,$Z=0;$M._alphaCurrentLength=this._alphaCurrentLength;var $i=$M._alphaElements;for($i.length=this._alphaElements.length,$E=0,$Z=this._alphaElements.length;$E<$Z;$E++)$i[$E]=this._alphaElements[$E];$M._rgbCurrentLength=this._rgbCurrentLength;var $n=$M._rgbElements;for($n.length=this._rgbElements.length,$E=0,$Z=this._rgbElements.length;$E<$Z;$E++)$n[$E]=this._rgbElements[$E]},$M.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$M,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),$t(0,$M,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function $I(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$p($I,"laya.d3.core.particleShuriKen.module.GradientDataInt");var $M=$I.prototype;$g.imps($M,{"laya.d3.core.IClone":!0}),$M.add=function($I,$M){this._currentLength<8?(6===this._currentLength&&1!==$I&&($I=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$I,this._elements[this._currentLength++]=$M):console.log("Warning:data count must lessEqual than 4")},$M.cloneTo=function($I){var $M=$I;$M._currentLength=this._currentLength;var $E=$M._elements;$E.length=this._elements.length;for(var $Z=0,$i=this._elements.length;$Z<$i;$Z++)$E[$Z]=this._elements[$Z]},$M.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$M,"gradientCount",function(){return this._currentLength/2})}(),function(){function $I(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}$p($I,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var $M=$I.prototype;$g.imps($M,{"laya.d3.core.IClone":!0}),$M.add=function($I,$M){this._currentLength<8?(6===this._currentLength&&1!==$I&&($I=1,DEBUG),this._elements[this._currentLength++]=$I,this._elements[this._currentLength++]=$M):DEBUG},$M.getKeyByIndex=function($I){return this._elements[2*$I]},$M.getValueByIndex=function($I){return this._elements[2*$I+1]},$M.getAverageValue=function(){for(var $I=0,$M=this._currentLength-2;$I<$M;$I+=2){this._elements[$I+1];this._elements[$I+3],this._elements[$I+2]-this._elements[$I]}return 0},$M.cloneTo=function($I){var $M=$I;$M._currentLength=this._currentLength;var $E=$M._elements;$E.length=this._elements.length;for(var $Z=0,$i=this._elements.length;$Z<$i;$Z++)$E[$Z]=this._elements[$Z]},$M.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$M,"gradientCount",function(){return this._currentLength/2})}(),function(){function $I(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}$p($I,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var $M=$I.prototype;$g.imps($M,{"laya.d3.core.IClone":!0}),$M.add=function($I,$M){this._currentLength<8?(6===this._currentLength&&1!==$I&&($I=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=$I,this._elements[this._currentLength++]=$M.x,this._elements[this._currentLength++]=$M.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},$M.cloneTo=function($I){var $M=$I;$M._currentLength=this._currentLength;var $E=$M._elements;$E.length=this._elements.length;for(var $Z=0,$i=this._elements.length;$Z<$i;$Z++)$E[$Z]=this._elements[$Z]},$M.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$M,"gradientCount",function(){return this._currentLength/3})}(),function(){function $f(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$p($f,"laya.d3.core.particleShuriKen.module.GradientSize");var $I=$f.prototype;return $g.imps($I,{"laya.d3.core.IClone":!0}),$I.getMaxSizeInGradient=function(){var $I=0,$M=0,$E=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for($I=0,$M=this._gradientX.gradientCount;$I<$M;$I++)$E=Math.max($E,this._gradientX.getValueByIndex($I));for($I=0,$M=this._gradientY.gradientCount;$I<$M;$I++)$E=Math.max($E,this._gradientY.getValueByIndex($I))}else for($I=0,$M=this._gradient.gradientCount;$I<$M;$I++)$E=Math.max($E,this._gradient.getValueByIndex($I));break;case 1:$E=this._separateAxes?($E=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),$E=Math.max($E,this._constantMinSeparate.y),Math.max($E,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for($I=0,$M=this._gradientXMin.gradientCount;$I<$M;$I++)$E=Math.max($E,this._gradientXMin.getValueByIndex($I));for($I=0,$M=this._gradientXMax.gradientCount;$I<$M;$I++)$E=Math.max($E,this._gradientXMax.getValueByIndex($I));for($I=0,$M=this._gradientYMin.gradientCount;$I<$M;$I++)$E=Math.max($E,this._gradientYMin.getValueByIndex($I));for($I=0,$M=this._gradientZMax.gradientCount;$I<$M;$I++)$E=Math.max($E,this._gradientZMax.getValueByIndex($I))}else{for($I=0,$M=this._gradientMin.gradientCount;$I<$M;$I++)$E=Math.max($E,this._gradientMin.getValueByIndex($I));for($I=0,$M=this._gradientMax.gradientCount;$I<$M;$I++)$E=Math.max($E,this._gradientMax.getValueByIndex($I))}}return $E},$I.cloneTo=function($I){var $M=$I;$M._type=this._type,$M._separateAxes=this._separateAxes,this._gradient.cloneTo($M._gradient),this._gradientX.cloneTo($M._gradientX),this._gradientY.cloneTo($M._gradientY),this._gradientZ.cloneTo($M._gradientZ),$M._constantMin=this._constantMin,$M._constantMax=this._constantMax,this._constantMinSeparate.cloneTo($M._constantMinSeparate),this._constantMaxSeparate.cloneTo($M._constantMaxSeparate),this._gradientMin.cloneTo($M._gradientMin),this._gradientMax.cloneTo($M._gradientMax),this._gradientXMin.cloneTo($M._gradientXMin),this._gradientXMax.cloneTo($M._gradientXMax),this._gradientYMin.cloneTo($M._gradientYMin),this._gradientYMax.cloneTo($M._gradientYMax),this._gradientZMin.cloneTo($M._gradientZMin),this._gradientZMax.cloneTo($M._gradientZMax)},$I.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$I,"gradientZ",function(){return this._gradientZ}),$t(0,$I,"gradient",function(){return this._gradient}),$t(0,$I,"separateAxes",function(){return this._separateAxes}),$t(0,$I,"type",function(){return this._type}),$t(0,$I,"gradientMin",function(){return this._gradientMin}),$t(0,$I,"constantMin",function(){return this._constantMin}),$t(0,$I,"gradientX",function(){return this._gradientX}),$t(0,$I,"gradientY",function(){return this._gradientY}),$t(0,$I,"gradientMax",function(){return this._gradientMax}),$t(0,$I,"constantMax",function(){return this._constantMax}),$t(0,$I,"constantMinSeparate",function(){return this._constantMinSeparate}),$t(0,$I,"constantMaxSeparate",function(){return this._constantMaxSeparate}),$t(0,$I,"gradientXMin",function(){return this._gradientXMin}),$t(0,$I,"gradientXMax",function(){return this._gradientXMax}),$t(0,$I,"gradientYMin",function(){return this._gradientYMin}),$t(0,$I,"gradientYMax",function(){return this._gradientYMax}),$t(0,$I,"gradientZMin",function(){return this._gradientZMin}),$t(0,$I,"gradientZMax",function(){return this._gradientZMax}),$f.createByGradient=function($I){var $M=new $f;return $M._type=0,$M._separateAxes=!1,$M._gradient=$I,$M},$f.createByGradientSeparate=function($I,$M,$E){var $Z=new $f;return $Z._type=0,$Z._separateAxes=!0,$Z._gradientX=$I,$Z._gradientY=$M,$Z._gradientZ=$E,$Z},$f.createByRandomTwoConstant=function($I,$M){var $E=new $f;return $E._type=1,$E._separateAxes=!1,$E._constantMin=$I,$E._constantMax=$M,$E},$f.createByRandomTwoConstantSeparate=function($I,$M){var $E=new $f;return $E._type=1,$E._separateAxes=!0,$E._constantMinSeparate=$I,$E._constantMaxSeparate=$M,$E},$f.createByRandomTwoGradient=function($I,$M){var $E=new $f;return $E._type=2,$E._separateAxes=!1,$E._gradientMin=$I,$E._gradientMax=$M,$E},$f.createByRandomTwoGradientSeparate=function($I,$M,$E,$Z,$i,$n){var $c=new $f;return $c._type=2,$c._separateAxes=!0,$c._gradientXMin=$I,$c._gradientXMax=$M,$c._gradientYMin=$E,$c._gradientYMax=$Z,$c._gradientZMin=$i,$c._gradientZMax=$n,$c},$f}()),$J=function(){function $f(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}$p($f,"laya.d3.core.particleShuriKen.module.GradientVelocity");var $I=$f.prototype;return $g.imps($I,{"laya.d3.core.IClone":!0}),$I.cloneTo=function($I){var $M=$I;$M._type=this._type,this._constant.cloneTo($M._constant),this._gradientX.cloneTo($M._gradientX),this._gradientY.cloneTo($M._gradientY),this._gradientZ.cloneTo($M._gradientZ),this._constantMin.cloneTo($M._constantMin),this._constantMax.cloneTo($M._constantMax),this._gradientXMin.cloneTo($M._gradientXMin),this._gradientXMax.cloneTo($M._gradientXMax),this._gradientYMin.cloneTo($M._gradientYMin),this._gradientYMax.cloneTo($M._gradientYMax),this._gradientZMin.cloneTo($M._gradientZMin),this._gradientZMax.cloneTo($M._gradientZMax)},$I.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$I,"gradientZ",function(){return this._gradientZ}),$t(0,$I,"constant",function(){return this._constant}),$t(0,$I,"type",function(){return this._type}),$t(0,$I,"gradientXMax",function(){return this._gradientXMax}),$t(0,$I,"constantMin",function(){return this._constantMin}),$t(0,$I,"gradientX",function(){return this._gradientX}),$t(0,$I,"gradientY",function(){return this._gradientY}),$t(0,$I,"gradientXMin",function(){return this._gradientXMin}),$t(0,$I,"constantMax",function(){return this._constantMax}),$t(0,$I,"gradientYMin",function(){return this._gradientYMin}),$t(0,$I,"gradientYMax",function(){return this._gradientYMax}),$t(0,$I,"gradientZMin",function(){return this._gradientZMin}),$t(0,$I,"gradientZMax",function(){return this._gradientZMax}),$f.createByConstant=function($I){var $M=new $f;return $M._type=0,$M._constant=$I,$M},$f.createByGradient=function($I,$M,$E){var $Z=new $f;return $Z._type=1,$Z._gradientX=$I,$Z._gradientY=$M,$Z._gradientZ=$E,$Z},$f.createByRandomTwoConstant=function($I,$M){var $E=new $f;return $E._type=2,$E._constantMin=$I,$E._constantMax=$M,$E},$f.createByRandomTwoGradient=function($I,$M,$E,$Z,$i,$n){var $c=new $f;return $c._type=3,$c._gradientXMin=$I,$c._gradientXMax=$M,$c._gradientYMin=$E,$c._gradientYMax=$Z,$c._gradientZMin=$i,$c._gradientZMax=$n,$c},$f}(),$x=(function(){function $I($I){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=$I}$p($I,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var $M=$I.prototype;$g.imps($M,{"laya.d3.core.IClone":!0}),$M.cloneTo=function($I){var $M=$I;this._angularVelocity.cloneTo($M._angularVelocity),$M.enbale=this.enbale},$M.clone=function(){var $I;switch(this._angularVelocity.type){case 0:$I=this._angularVelocity.separateAxes?$S.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):$S.createByConstant(this._angularVelocity.constant);break;case 1:$I=this._angularVelocity.separateAxes?$S.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):$S.createByGradient(this._angularVelocity.gradient.clone());break;case 2:$I=this._angularVelocity.separateAxes?$S.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):$S.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:$I=this._angularVelocity.separateAxes?$S.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):$S.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var $M=new this.constructor($I);return $M.enbale=this.enbale,$M},$t(0,$M,"angularVelocity",function(){return this._angularVelocity})}(),function(){function $I(){this.enable=!1,this.randomDirection=!1}$p($I,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var $M=$I.prototype;return $g.imps($M,{"laya.d3.core.IClone":!0}),$M._getShapeBoundBox=function($I){throw new Error("BaseShape: must override it.")},$M._getSpeedBoundBox=function($I){throw new Error("BaseShape: must override it.")},$M.generatePositionAndDirection=function($I,$M,$E,$Z){throw new Error("BaseShape: must override it.")},$M._calculateProceduralBounds=function($I,$M,$E){this._getShapeBoundBox($I);var $Z=$I.min,$i=$I.max;$cM.multiply($Z,$M,$Z),$cM.multiply($i,$M,$i);var $n=new $YI(new $cM,new $cM);this.randomDirection?($n.min=new $cM(-1,-1,-1),$n.max=new $cM(1,1,1)):this._getSpeedBoundBox($n);var $c=new $YI(new $cM,new $cM),$f=$c.min,$d=$c.max;$cM.scale($n.min,$E.y,$f),$cM.scale($n.max,$E.y,$d),$cM.add($I.min,$f,$f),$cM.add($I.max,$d,$d),$cM.min($I.min,$f,$I.min),$cM.max($I.max,$f,$I.max);var $H=new $YI(new $cM,new $cM),$B=$H.min,$A=$H.max;$cM.scale($n.min,$E.x,$B),$cM.scale($n.max,$E.x,$A),$cM.min($H.min,$A,$f),$cM.max($H.min,$A,$d),$cM.min($I.min,$f,$I.min),$cM.max($I.max,$f,$I.max)},$M.cloneTo=function($I){$I.enable=this.enable},$M.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$I}()),$e=function(){function $n(){}return $p($n,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),$n._randomPointUnitArcCircle=function($I,$M,$E){var $Z=$M.elements,$i=NaN;$i=$E?$E.getFloat()*$I:Math.random()*$I,$Z[0]=Math.cos($i),$Z[1]=Math.sin($i)},$n._randomPointInsideUnitArcCircle=function($I,$M,$E){var $Z=$M.elements;$n._randomPointUnitArcCircle($I,$M,$E);var $i=NaN;$i=$E?Math.pow($E.getFloat(),.5):Math.pow(Math.random(),.5),$Z[0]=$Z[0]*$i,$Z[1]=$Z[1]*$i},$n._randomPointUnitCircle=function($I,$M){var $E=$I.elements,$Z=NaN;$Z=$M?$M.getFloat()*Math.PI*2:Math.random()*Math.PI*2,$E[0]=Math.cos($Z),$E[1]=Math.sin($Z)},$n._randomPointInsideUnitCircle=function($I,$M){var $E=$I.elements;$n._randomPointUnitCircle($I);var $Z=NaN;$Z=$M?Math.pow($M.getFloat(),.5):Math.pow(Math.random(),.5),$E[0]=$E[0]*$Z,$E[1]=$E[1]*$Z},$n._randomPointUnitSphere=function($I,$M){var $E=$I.elements,$Z=NaN,$i=NaN;$i=$M?($Z=$E[2]=2*$M.getFloat()-1,$M.getFloat()*Math.PI*2):($Z=$E[2]=2*Math.random()-1,Math.random()*Math.PI*2);var $n=Math.sqrt(1-$Z*$Z);$E[0]=$n*Math.cos($i),$E[1]=$n*Math.sin($i)},$n._randomPointInsideUnitSphere=function($I,$M){var $E=$I.elements;$n._randomPointUnitSphere($I);var $Z=NaN;$Z=$M?Math.pow($M.getFloat(),1/3):Math.pow(Math.random(),1/3),$E[0]=$E[0]*$Z,$E[1]=$E[1]*$Z,$E[2]=$E[2]*$Z},$n._randomPointInsideHalfUnitBox=function($I,$M){var $E=$I.elements;$M?($E[0]=$M.getFloat()-.5,$E[1]=$M.getFloat()-.5,$E[2]=$M.getFloat()-.5):($E[0]=Math.random()-.5,$E[1]=Math.random()-.5,$E[2]=Math.random()-.5)},$n}(),$_=(function(){function $I($I){this._size=null,this.enbale=!1,this._size=$I}$p($I,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var $M=$I.prototype;$g.imps($M,{"laya.d3.core.IClone":!0}),$M.cloneTo=function($I){var $M=$I;this._size.cloneTo($M._size),$M.enbale=this.enbale},$M.clone=function(){var $I;switch(this._size.type){case 0:$I=this._size.separateAxes?$C.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):$C.createByGradient(this._size.gradient.clone());break;case 1:$I=this._size.separateAxes?$C.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):$C.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:$I=this._size.separateAxes?$C.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):$C.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var $M=new this.constructor($I);return $M.enbale=this.enbale,$M},$t(0,$M,"size",function(){return this._size})}(),function(){function $Z(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}$p($Z,"laya.d3.core.particleShuriKen.module.StartFrame");var $I=$Z.prototype;return $g.imps($I,{"laya.d3.core.IClone":!0}),$I.cloneTo=function($I){var $M=$I;$M._type=this._type,$M._constant=this._constant,$M._constantMin=this._constantMin,$M._constantMax=this._constantMax},$I.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$I,"constant",function(){return this._constant}),$t(0,$I,"type",function(){return this._type}),$t(0,$I,"constantMin",function(){return this._constantMin}),$t(0,$I,"constantMax",function(){return this._constantMax}),$Z.createByConstant=function($I){var $M=new $Z;return $M._type=0,$M._constant=$I,$M},$Z.createByRandomTwoConstant=function($I,$M){var $E=new $Z;return $E._type=1,$E._constantMin=$I,$E._constantMax=$M,$E},$Z}()),$h=(function(){function $I($I,$M){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new $nM(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=$I,this._startFrame=$M}$p($I,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var $M=$I.prototype;$g.imps($M,{"laya.d3.core.IClone":!0}),$M.cloneTo=function($I){var $M=$I;this.tiles.cloneTo($M.tiles),$M.type=this.type,$M.randomRow=this.randomRow,this._frame.cloneTo($M._frame),this._startFrame.cloneTo($M._startFrame),$M.cycles=this.cycles,$M.enableUVChannels=this.enableUVChannels,$M.enable=this.enable},$M.clone=function(){var $I,$M;switch(this._frame.type){case 0:$I=$o.createByConstant(this._frame.constant);break;case 1:$I=$o.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:$I=$o.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:$I=$o.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:$M=$_.createByConstant(this._startFrame.constant);break;case 1:$M=$_.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var $E=new this.constructor($I,$M);return this.tiles.cloneTo($E.tiles),$E.type=this.type,$E.randomRow=this.randomRow,$E.cycles=this.cycles,$E.enableUVChannels=this.enableUVChannels,$E.enable=this.enable,$E},$t(0,$M,"frame",function(){return this._frame}),$t(0,$M,"startFrame",function(){return this._startFrame})}(),function(){function $I($I){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=$I}$p($I,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var $M=$I.prototype;$g.imps($M,{"laya.d3.core.IClone":!0}),$M.cloneTo=function($I){var $M=$I;this._velocity.cloneTo($M._velocity),$M.enbale=this.enbale,$M.space=this.space},$M.clone=function(){var $I;switch(this._velocity.type){case 0:$I=$J.createByConstant(this._velocity.constant.clone());break;case 1:$I=$J.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:$I=$J.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:$I=$J.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var $M=new this.constructor($I);return $M.enbale=this.enbale,$M.space=this.space,$M},$t(0,$M,"velocity",function(){return this._velocity})}(),function(){function $I(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new $QM,this._vb=$xM.create($I._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=$JM.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=$XM.nameKey.getID("LINE"),this._shaderCompile=$mM._preCompileShader[this._sharderNameID]}$p($I,"laya.d3.core.PhasorSpriter3D");var $M=$I.prototype;return $M.line=function($I,$M,$E,$Z){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($I.x,$I.y,$I.z,$M.x,$M.y,$M.z,$M.w),this.addVertex($E.x,$E.y,$E.z,$Z.x,$Z.y,$Z.z,$Z.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},$M.circle=function($I,$M,$E,$Z,$i,$n){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*$M,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/$M,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*$I,Math.cos(this._tempNumver0)*$I,0,$E,$Z,$i,$n),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},$M.plane=function($I,$M,$E,$Z,$i,$n,$c,$f,$d){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=$Z/2,this._tempNumver1=$i/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($I-this._tempNumver0,$M+this._tempNumver1,$E,$n,$c,$f,$d),this.addVertex($I+this._tempNumver0,$M+this._tempNumver1,$E,$n,$c,$f,$d),this.addVertex($I-this._tempNumver0,$M-this._tempNumver1,$E,$n,$c,$f,$d),this.addVertex($I+this._tempNumver0,$M-this._tempNumver1,$E,$n,$c,$f,$d),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},$M.box=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=$Z/2,this._tempNumver1=$i/2,this._tempNumver2=$n/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($I-this._tempNumver0,$M+this._tempNumver1,$E+this._tempNumver2,$c,$f,$d,$H),this.addVertex($I+this._tempNumver0,$M+this._tempNumver1,$E+this._tempNumver2,$c,$f,$d,$H),this.addVertex($I-this._tempNumver0,$M-this._tempNumver1,$E+this._tempNumver2,$c,$f,$d,$H),this.addVertex($I+this._tempNumver0,$M-this._tempNumver1,$E+this._tempNumver2,$c,$f,$d,$H),this.addVertex($I+this._tempNumver0,$M+this._tempNumver1,$E-this._tempNumver2,$c,$f,$d,$H),this.addVertex($I-this._tempNumver0,$M+this._tempNumver1,$E-this._tempNumver2,$c,$f,$d,$H),this.addVertex($I+this._tempNumver0,$M-this._tempNumver1,$E-this._tempNumver2,$c,$f,$d,$H),this.addVertex($I-this._tempNumver0,$M-this._tempNumver1,$E-this._tempNumver2,$c,$f,$d,$H),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},$M.cone=function($I,$M,$E,$Z,$i,$n,$c){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*$E+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*$E>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/$E,this.addVertexIndex(0,$M,0,$Z,$i,$n,$c,this._tempUint0),this.addVertexIndex(0,0,0,$Z,$i,$n,$c,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<$E;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex($I*this._tempNumver2,0,$I*this._tempNumver3,$Z,$i,$n,$c,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==$E-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex($I*this._tempNumver2,0,$I*this._tempNumver3,$Z,$i,$n,$c,this._tempUint0+(this._tempInt0+$E)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==$E-1?this.addIndexes(this._tempUint1+$E+2):this.addIndexes(this._tempUint1+this._tempInt0+$E+1),this.addIndexes(this._tempUint1+this._tempInt0+$E),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},$M.boundingBoxLine=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex($I,$i,$n,$c,$f,$d,$H),this.addVertex($Z,$i,$n,$c,$f,$d,$H),this.addVertex($I,$M,$n,$c,$f,$d,$H),this.addVertex($Z,$M,$n,$c,$f,$d,$H),this.addVertex($Z,$i,$E,$c,$f,$d,$H),this.addVertex($I,$i,$E,$c,$f,$d,$H),this.addVertex($Z,$M,$E,$c,$f,$d,$H),this.addVertex($I,$M,$E,$c,$f,$d,$H),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},$M.addVertex=function($I,$M,$E,$Z,$i,$n,$c){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=$I,this._vbData[this._posInVBData+1]=$M,this._vbData[this._posInVBData+2]=$E,this._vbData[this._posInVBData+3]=$Z,this._vbData[this._posInVBData+4]=$i,this._vbData[this._posInVBData+5]=$n,this._vbData[this._posInVBData+6]=$c,this._posInVBData+=this._floatSizePerVer,this},$M.addVertexIndex=function($I,$M,$E,$Z,$i,$n,$c,$f){return this._hasBegun||this.addVertexIndexException(),this._vbData[$f]=$I,this._vbData[$f+1]=$M,this._vbData[$f+2]=$E,this._vbData[$f+3]=$Z,this._vbData[$f+4]=$i,this._vbData[$f+5]=$n,this._vbData[$f+6]=$c,($f+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=$f),this},$M.addIndexes=function($I){var $M=arguments;this._hasBegun||this.addVertexIndexException();for(var $E=0;$E<$M.length;$E++)this._ibData[this._posInIBData]=$M[$E],this._posInIBData++;return this},$M.begin=function($I,$M){return this._hasBegun&&this.beginException0(),1!==$I&&4!==$I&&this.beginException1(),this._primitiveType=$I,this._camera=$M,this._hasBegun=!0,this},$M.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},$M.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes($I._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),$m.drawCall++,$W.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},$M.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},$M.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},$M.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},$M.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},$M.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},$M.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(28,[new $cI(0,"vector3",0),new $cI(12,"vector4",1)])}]),$I}()),$P=function(){function $I(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++$I._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new $QM}$p($I,"laya.d3.core.render.RenderElement");var $M=$I.prototype;return $M.getDynamicBatchBakedVertexs=function($I){for(var $M=this._renderObj._getVertexBuffer($I),$E=$M.getData().slice(),$Z=$M.vertexDeclaration,$i=$Z.getVertexElementByUsage(0).offset/4,$n=$Z.getVertexElementByUsage(3).offset/4,$c=this._sprite3D.transform,$f=$c.worldMatrix,$d=$c.rotation,$H=$Z.vertexStride/4,$B=0,$A=$E.length;$B<$A;$B+=$H){var $Q=$B+$i,$p=$B+$n;$uM.transformVector3ArrayToVector3ArrayCoordinate($E,$Q,$f,$E,$Q),$uM.transformVector3ArrayByQuat($E,$p,$d,$E,$p)}return $E},$M.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},$M._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},$t(0,$M,"id",function(){return this._id}),$t(0,$M,"renderObj",function(){return this._renderObj},function($I){this._renderObj!==$I&&(this._renderObj=$I)}),$I._uniqueIDCounter=0,$I}(),$D=function(){function $M($I){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++$M._uniqueIDCounter,this._needSort=!1,this._scene=$I,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}$p($M,"laya.d3.core.render.RenderQueue");var $I=$M.prototype;return $I._sortOpaqueFunc=function($I,$M){if($I._render&&$M._render){var $E=$I._material.renderQueue-$M._material.renderQueue;return 0==$E?$I._render._distanceForSort-$M._render._distanceForSort:$E}return 0},$I._sortAlphaFunc=function($I,$M){if($I._render&&$M._render){var $E=$I._material.renderQueue-$M._material.renderQueue;return 0==$E?$M._render._distanceForSort-$I._render._distanceForSort:$E}return 0},$I._begainRenderElement=function($I,$M,$E){return!!$M._beforeRender($I)},$I._sortAlpha=function($I){$M._cameraPosition=$I,this._finalElements.sort(this._sortAlphaFunc)},$I._sortOpaque=function($I){$M._cameraPosition=$I,this._finalElements.sort(this._sortOpaqueFunc)},$I._preRender=function($I){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},$I._render=function($I,$M){for(var $E,$Z,$i,$n,$c,$f,$d=$m.loopCount,$H=this._scene,$B=$I.camera,$A=($B.id,!1),$Q=0,$p=this._finalElements.length;$Q<$p;$Q++){var $t,$V,$u,$N=this._finalElements[$Q];if(null!=$N._onPreRenderFunction&&$N._onPreRenderFunction.call($N._sprite3D,$I),0===$N._type){if($I.owner=$u=$N._sprite3D,$I.renderElement=$N,$u._preRenderUpdateComponents($I),$t=$N.renderObj,$V=$N._material,this._begainRenderElement($I,$t,$V)){if($E=$t._getVertexBuffers(),!($i=($Z=$t._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[$Z.id]){this._errorRecord[$Z.id]=1;var $y="vertexBuffer:"+("("+$Z._destroyed+","+$Z._released+","+$Z._referenceCount+","+$Z._buffer+")")+", material:"+($V?$V.__className+"("+$V._destroyed+","+$V._released+")":"null")+", owner:"+($u?$u.__className+"("+$u._destroyed+","+$u._activeInHierarchy+","+$u._displayedInStage+")":"null")+", renderObj:"+($t?$t.__className+"("+$t._destroyed+","+$t._released+","+$t._referenceCount+")":"")+", parent:, url:"+($u?$u.url:"")+", disposeStack:"+$Z.disposeStack;$g.recordError("报错：unknown vertexDeclaration  "+$y)}continue}if($A=($n=$I._shader=$V._getShader($H._shaderDefineValue,$i.shaderDefineValue,$u._shaderDefineValue)).bind()||$d!==$n._uploadLoopCount,$E){if($n._uploadVertexBuffer!==$E||$A){for(var $$=0;$$<$E.length;$$++){var $w=$E[$$];$n.uploadAttributesX($w.vertexDeclaration.shaderValues.data,$w)}$n._uploadVertexBuffer=$E}}else($n._uploadVertexBuffer!==$Z||$A)&&($n.uploadAttributes($i.shaderValues.data,null),$n._uploadVertexBuffer=$Z);($n._uploadScene!==$H||$A)&&($n.uploadSceneUniforms($H._shaderValues.data),$n._uploadScene=$H),($B!==$n._uploadCamera||$n._uploadSprite3D!==$u||$A)&&($n.uploadSpriteUniforms($u._shaderValues.data),$n._uploadSprite3D=$u),($B!==$n._uploadCamera||$A)&&($n.uploadCameraUniforms($B._shaderValues.data),$n._uploadCamera=$B),($n._uploadMaterial!==$V||$A)&&($V._upload(),$n._uploadMaterial=$V),$c!==$V?($V._setRenderStateBlendDepth(),$V._setRenderStateFrontFace($M,$u.transform),$c=$V,$f=$u):$f!==$u&&($V._setRenderStateFrontFace($M,$u.transform),$f=$u),$t._render($I),$n._uploadLoopCount=$d}$u._postRenderUpdateComponents($I)}else if(2===$N._type){$N.renderObj;$I.owner=$u=$N._sprite3D,$I.renderElement=$N,$I._batchIndexStart=$N._tempBatchIndexStart,$I._batchIndexEnd=$N._tempBatchIndexEnd,$t=$N.renderObj,$V=$N._material,this._begainRenderElement($I,$t,$V)&&($i=($Z=$t._getVertexBuffer(0)).vertexDeclaration,$A=($n=$I._shader=$V._getShader($H._shaderDefineValue,$i.shaderDefineValue,$u._shaderDefineValue)).bind()||$d!==$n._uploadLoopCount,($n._uploadVertexBuffer!==$Z||$A)&&($n.uploadAttributes($i.shaderValues.data,null),$n._uploadVertexBuffer=$Z),($n._uploadScene!==$H||$A)&&($n.uploadSceneUniforms($H._shaderValues.data),$n._uploadScene=$H),($B!==$n._uploadCamera||$n._uploadSprite3D!==$u||$A)&&($n.uploadSpriteUniforms($u._shaderValues.data),$n._uploadSprite3D=$u),($B!==$n._uploadCamera||$A)&&($n.uploadCameraUniforms($B._shaderValues.data),$n._uploadCamera=$B),($n._uploadMaterial!==$V||$A)&&($V._upload(),$n._uploadMaterial=$V),$c!==$V?($V._setRenderStateBlendDepth(),$V._setRenderStateFrontFace($M,$u.transform),$c=$V,$f=$u):$f!==$u&&($V._setRenderStateFrontFace($M,$u.transform),$f=$u),$t._render($I),$n._uploadLoopCount=$d)}}},$I._renderShadow=function($I,$M){for(var $E,$Z,$i,$n,$c,$f=$m.loopCount,$d=this._scene,$H=$I.camera,$B=!1,$A=0,$Q=this._finalElements.length;$A<$Q;$A++){var $p,$t,$V,$u=this._finalElements[$A];0===$u._type&&($I.owner=$V=$u._sprite3D,$M||$V._projectionViewWorldUpdateCamera===$H&&$V._projectionViewWorldUpdateLoopCount===$m.loopCount||($V._render._renderUpdate($I._projectionViewMatrix),$V._projectionViewWorldUpdateLoopCount=$m.loopCount,$V._projectionViewWorldUpdateCamera=$H),$I.renderElement=$u,$V._preRenderUpdateComponents($I),$p=$u.renderObj,$t=$u._material,this._begainRenderElement($I,$p,null)&&($Z=($E=$p._getVertexBuffer(0)).vertexDeclaration,$B=($i=$I._shader=$t._getShader($d._shaderDefineValue,$Z.shaderDefineValue,$V._shaderDefineValue)).bind()||$f!==$i._uploadLoopCount,($i._uploadVertexBuffer!==$E||$B)&&($i.uploadAttributes($Z.shaderValues.data,null),$i._uploadVertexBuffer=$E),($H!==$i._uploadCamera||$i._uploadSprite3D!==$V||$B)&&($i.uploadSpriteUniforms($V._shaderValues.data),$i._uploadSprite3D=$V),($H!==$i._uploadCamera||$B)&&($i.uploadCameraUniforms($H._shaderValues.data),$i._uploadCamera=$H),($i._uploadMaterial!==$t||$B)&&($t._upload(),$i._uploadMaterial=$t),$i._uploadRenderElement,$n!==$t?($t._setRenderStateFrontFace(!1,$V.transform),$n=$t,$c=$V):$c!==$V&&($t._setRenderStateFrontFace(!1,$V.transform),$c=$V),$p._render($I),$i._uploadLoopCount=$f),$V._postRenderUpdateComponents($I))}},$I._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},$I._addRenderElement=function($I){this._renderElements.push($I),this._needSort=!0},$I._addDynamicBatchElement=function($I){this._dynamicBatchCombineRenderElements.push($I)},$t(0,$I,"id",function(){return this._id}),$M._uniqueIDCounter=0,$M._cameraPosition=null,$M}(),$G=function(){function $I(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return $p($I,"laya.d3.core.render.RenderState"),$I.clientWidth=0,$I.clientHeight=0,$I}(),$Y=function(){function $c($I,$M){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new $sI(new $cM,0),this._corners=[new $cM,new $cM,new $cM,new $cM,new $cM,new $cM,new $cM,new $cM],this._boundingBoxCenter=new $cM,this._children=$Z(8),this._objects=[],this._tempBoundBoxCorners=[new $cM,new $cM,new $cM,new $cM,new $cM,new $cM,new $cM,new $cM],this._scene=$I,this._currentDepth=$M}$p($c,"laya.d3.core.scene.OctreeNode");var $I=$c.prototype;return $g.imps($I,{"laya.d3.core.scene.ITreeNode":!0}),$I.init=function($I,$M){var $E=new $cM,$Z=new $cM;$cM.scale($M,-.5,$E),$cM.scale($M,.5,$Z),$cM.add($E,$I,$E),$cM.add($Z,$I,$Z),this.exactBox=new $YI($E,$Z),this.relaxBox=new $YI($E,$Z)},$I.addTreeNode=function($I){1===Collision.boxContainsBox(this._relaxBox,$I.boundingBox)?this.addNodeDown($I,0):this.addObject($I)},$I.addChild=function($I){var $M=this._children[$I];if(null==$M){$M=new $c(this._scene,this._currentDepth+1),(this._children[$I]=$M)._parent=this,$cM.subtract(this._exactBox.max,this._exactBox.min,$c.tempSize),$cM.multiply($c.tempSize,$c._octreeSplit[$I],$c.tempCenter),$cM.add(this._exactBox.min,$c.tempCenter,$c.tempCenter),$cM.scale($c.tempSize,.25,$c.tempSize);var $E=new $cM,$Z=new $cM;$cM.subtract($c.tempCenter,$c.tempSize,$E),$cM.add($c.tempCenter,$c.tempSize,$Z),$M.exactBox=new $YI($E,$Z),$cM.scale($c.tempSize,$c.relax,$c.tempSize);var $i=new $cM,$n=new $cM;$cM.subtract($c.tempCenter,$c.tempSize,$i),$cM.add($c.tempCenter,$c.tempSize,$n),$M.relaxBox=new $YI($i,$n)}return $M},$I.addObject=function($I){($I._treeNode=this)._objects.push($I)},$I.removeObject=function($I){if($I._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var $M=this._objects.indexOf($I);return-1!==$M&&(this._objects.splice($M,1),!0)},$I.clearObject=function(){this._objects.length=0},$I.addNodeUp=function($I,$M){this._parent&&1!==Collision.boxContainsBox(this._exactBox,$I.boundingBox)?this._parent.addNodeUp($I,$M-1):this.addNodeDown($I,$M)},$I.addNodeDown=function($I,$M){if($M<this._scene.treeLevel){var $E=this.inChildIndex($I.boundingBoxCenter),$Z=this.addChild($E);1===Collision.boxContainsBox($Z._relaxBox,$I.boundingBox)?$Z.addNodeDown($I,++$M):this.addObject($I)}else this.addObject($I)},$I.inChildIndex=function($I){return 4*($I.z<this._boundingBoxCenter.z?0:1)+2*($I.y<this._boundingBoxCenter.y?0:1)+($I.x<this._boundingBoxCenter.x?0:1)},$I.updateObject=function($I){1===Collision.boxContainsBox(this._relaxBox,$I.boundingBox)?(this.removeObject($I),$I._treeNode=null,this.addNodeDown($I,this._currentDepth)):this._parent&&(this.removeObject($I),$I._treeNode=null,this._parent.addNodeUp($I,this._currentDepth-1))},$I.cullingObjects=function($I,$M,$E,$Z,$i){var $n,$c=0,$f=0,$d=0,$H=this._scene._dynamicBatchManager;for($c=0,$n=this._objects.length;$c<$n;$c++){var $B=this._objects[$c];if($L.isVisible($B._owner.layer.mask)&&$B.enable){if($M&&($m.treeSpriteCollision+=1,0===$I.containsBoundSphere($B.boundingSphere)))continue;$B._renderUpdate($i),$B._distanceForSort=$cM.distance($B.boundingSphere.center,$Z)+$B.sortingFudge;var $A=$B._renderElements;for($f=0,$d=$A.length;$f<$d;$f++){var $Q=$A[$f],$p=$Q._staticBatch;if($p&&$p._material===$Q._material)$p._addBatchRenderElement($Q);else{var $t=$Q.renderObj;$t.triangleCount<10&&1===$t._vertexBufferCount&&$t._getIndexBuffer()&&$Q._material.renderQueue<2&&$Q._canDynamicBatch&&!$B._owner.isStatic?$H._addPrepareRenderElement($Q):this._scene.getRenderQueue($Q._material.renderQueue)._addRenderElement($Q)}}}}for($c=0;$c<8;$c++){var $V=this._children[$c];if(null!=$V){var $u=$M;if($M){var $N=$I.containsBoundBox($V._relaxBox);if($m.treeNodeCollision+=1,0===$N)continue;$u=2===$N}$V.cullingObjects($I,$u,$E,$Z,$i)}}},$I.cullingShadowObjects=function($I,$M,$E,$Z,$i){var $n,$c=0,$f=0,$d=0;this._scene._dynamicBatchManager;for($c=0,$n=this._objects.length;$c<$n;$c++){var $H=this._objects[$c];if($H.castShadow&&$L.isVisible($H._owner.layer.mask)&&$H.enable){if($E&&0===$I[0].containsBoundSphere($H.boundingSphere))continue;for(var $B=1,$A=$I.length;$B<$A;$B++){var $Q=$M[$B-1];if(0!==$I[$B].containsBoundSphere($H.boundingSphere)){var $p=$H._renderElements;for($f=0,$d=$p.length;$f<$d;$f++)$Q._addRenderElement($p[$f])}}}}for($c=0;$c<8;$c++){var $t=this._children[$c];if(null!=$t){var $V=$E;if($E){var $u=$I[0].containsBoundBox($t._relaxBox);if(0===$u)continue;$V=2===$u}$t.cullingShadowObjects($I,$M,$V,$Z,$i)}}},$I.cullingShadowObjectsOnePSSM=function($I,$M,$E,$Z,$i,$n){var $c,$f=$M[0],$d=0,$H=0,$B=0;for($d=0,$c=this._objects.length;$d<$c;$d++){var $A=this._objects[$d];if($A.castShadow&&$L.isVisible($A._owner.layer.mask)&&$A.enable){if($Z&&0===$I.containsBoundSphere($A.boundingSphere))continue;$A._renderUpdate($E);var $Q=$A._renderElements;for($H=0,$B=$Q.length;$H<$B;$H++)$f._addRenderElement($Q[$H])}}for($d=0;$d<8;$d++){var $p=this._children[$d];if(null!=$p){var $t=$Z;if($Z){var $V=$I.containsBoundBox($p._relaxBox);if(0===$V)continue;$t=2===$V}$p.cullingShadowObjectsOnePSSM($I,$M,$E,$t,$i,$n)}}},$I.renderBoudingBox=function($I){this._renderBoudingBox($I);for(var $M=0;$M<8;++$M){var $E=this._children[$M];$E&&$E.renderBoudingBox($I)}},$I.buildAllChild=function($I){if($I<this._scene.treeLevel)for(var $M=0;$M<8;$M++){this.addChild($M).buildAllChild($I+1)}},$I._renderBoudingBox=function($I){},$t(0,$I,"exactBox",function(){return this._exactBox},function($I){this._exactBox=$I,$cM.add($I.min,$I.max,this._boundingBoxCenter),$cM.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),$t(0,$I,"relaxBox",function(){return this._relaxBox},function($I){(this._relaxBox=$I).getCorners(this._corners),$sI.createfromPoints(this._corners,this._boundingSphere)}),$c.debugMode=!1,$c.relax=1.15,$c.CHILDNUM=8,$A($c,["tempVector0",function(){return this.tempVector0=new $cM},"tempSize",function(){return this.tempSize=new $cM},"tempCenter",function(){return this.tempCenter=new $cM},"_octreeSplit",function(){return this._octreeSplit=[new $cM(.25,.25,.25),new $cM(.75,.25,.25),new $cM(.25,.75,.25),new $cM(.75,.75,.25),new $cM(.25,.25,.75),new $cM(.75,.25,.75),new $cM(.25,.75,.75),new $cM(.75,.75,.75)]}]),$c}(),$K=(function(){function $I(){}$p($I,"laya.d3.core.scene.SceneManager")}(),function(){function $I($I,$M,$E,$Z){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===$I&&($I=1),void 0===$M&&($M=1),void 0===$E&&($E=1),void 0===$Z&&($Z=1),this._r=$I,this._g=$M,this._b=$E,this._a=$Z}return $p($I,"laya.d3.core.trail.module.Color",null,"Color$1"),$I.prototype.cloneTo=function($I){$I._r=this._r,$I._g=this._g,$I._b=this._b,$I._a=this._a},$A($I,["RED",function(){return this.RED=new $I(1,0,0,1)},"GREEN",function(){return this.GREEN=new $I(0,1,0,1)},"BLUE",function(){return this.BLUE=new $I(0,0,1,1)},"CYAN",function(){return this.CYAN=new $I(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new $I(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new $I(1,0,1,1)},"GRAY",function(){return this.GRAY=new $I(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new $I(1,1,1,1)},"BLACK",function(){return this.BLACK=new $I(0,0,0,1)}]),$I}()),$s=(function(){function $I(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}$p($I,"laya.d3.core.trail.module.Gradient");var $M=$I.prototype;$M.setKeys=function($I,$M){var $E,$Z;this._colorKeys=$I;for(var $i=this.index=0;$i<$I.length;$i++){var $n=($E=$I[$i]).color;this._colorKeyData[this.index++]=$n._r,this._colorKeyData[this.index++]=$n._g,this._colorKeyData[this.index++]=$n._b,this._colorKeyData[this.index++]=$E.time}this._alphaKeys=$M;for(var $c=this.index=0;$c<$M.length;$c++)$Z=$M[$c],this._alphaKeyData[this.index++]=$Z.alpha,this._alphaKeyData[this.index++]=$Z.time},$M.cloneTo=function($I){var $M=0,$E=0,$Z=this.colorKeys,$i=[];for($M=0,$E=$Z.length;$M<$E;$M++){var $n=new $b;$Z[$M].cloneTo($n),$i.push($n)}var $c=this.alphaKeys,$f=[];for($M=0,$E=$c.length;$M<$E;$M++){var $d=new $s;$c[$M].cloneTo($d),$f.push($d)}$I.setKeys($i,$f)},$t(0,$M,"mode",function(){return this._mode},function($I){this._mode=$I}),$t(0,$M,"colorKeys",function(){return this._colorKeys},function($I){this._colorKeys=$I;for(var $M=this.index=0;$M<$I.length;$M++){var $E=$I[$M],$Z=$E.color;this._colorKeyData[this.index++]=$Z._r,this._colorKeyData[this.index++]=$Z._g,this._colorKeyData[this.index++]=$Z._b,this._colorKeyData[this.index++]=$E.time}}),$t(0,$M,"alphaKeys",function(){return this._alphaKeys},function($I){this._alphaKeys=$I;for(var $M=this.index=0;$M<$I.length;$M++){var $E=$I[$M];this._alphaKeyData[this.index++]=$E.alpha,this._alphaKeyData[this.index++]=$E.time}})}(),function(){function $I($I,$M){this._alpha=NaN,this._time=NaN,void 0===$I&&($I=0),void 0===$M&&($M=0),this._alpha=$I,this._time=$M}$p($I,"laya.d3.core.trail.module.GradientAlphaKey");var $M=$I.prototype;return $M.cloneTo=function($I){$I.alpha=this.alpha,$I.time=this.time},$t(0,$M,"alpha",function(){return this._alpha},function($I){this._alpha=$I}),$t(0,$M,"time",function(){return this._time},function($I){this._time=$I}),$I}()),$b=function(){function $I($I,$M){this._color=null,this._time=NaN,void 0===$M&&($M=0),this._color=$I||new $K,this._time=$M}$p($I,"laya.d3.core.trail.module.GradientColorKey");var $M=$I.prototype;return $M.cloneTo=function($I){this.color.cloneTo($I.color),$I.time=this.time},$t(0,$M,"color",function(){return this._color},function($I){this._color=$I}),$t(0,$M,"time",function(){return this._time},function($I){this._time=$I}),$I}(),$U=(function(){function $I(){}$p($I,"laya.d3.core.trail.module.GradientMode"),$I.Blend=0,$I.Fixed=1}(),function(){function $I(){}$p($I,"laya.d3.core.trail.module.TextureMode"),$I.Stretch=0,$I.Tile=1}(),function(){function $I(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}$p($I,"laya.d3.core.trail.module.TrailKeyFrame"),$I.prototype.cloneTo=function($I){$I.time=this.time,$I.inTangent=this.inTangent,$I.outTangent=this.outTangent,$I.value=this.value}}(),function(){function $M($I){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new $cM,this._curPosition=new $cM,this._delVector3=new $cM,this._lastFixedVertexPosition=new $cM,this._pointAtoBVector3=new $cM,this._pointA=new $cM,this._pointB=new $cM,this._owner=$I,this._id=$M.renderElementCount++,0==this._id?$I._owner.transform.position.cloneTo(this._lastPosition):$I._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new $xM($U.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new $xM($U.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}$p($M,"laya.d3.core.trail.TrailRenderElement");var $I=$M.prototype;$g.imps($I,{"laya.d3.core.render.IRenderable":!0}),$I._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},$I._addTrailByFirstPosition=function($I,$M){$cM.subtract($M,$I,this._delVector3),$cM.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$cM.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$cM.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition($I),$I.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},$I._addTrailByNextPosition=function($I){$cM.subtract($I,this._lastFixedVertexPosition,this._delVector3),$cM.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),$cM.normalize(this._pointAtoBVector3,this._pointAtoBVector3),$cM.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=$cM.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=$bI.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition($I),$I.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition($I),this._virtualVerticesCount=2)},$I._updateVerticesByPosition=function($I){this._pointe=$I.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},$I._updateVertexBuffer2=function(){var $I,$M=0,$E=0,$Z=0;for($Z=0,$I=(this._verticesCount+this._virtualVerticesCount)/2;$Z<$I;$Z++)$E=0==this._owner.textureMode?(this._VerticesToTailLength[$Z]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[$Z],this._vertices2[$M++]=1-$E,this._vertices2[$M++]=1-$E;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},$I._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},$I._updateDisappear=function(){var $I,$M=0;for($M=this._curDisappearIndex,$I=(this._verticesCount+this._virtualVerticesCount)/2;$M<$I;$M++)this._owner._curtime-this._everyGroupVertexBirthTime[$M]>=this._owner.time+$bI.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},$I._beforeRender=function($I){return this._camera=$I.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),$cM.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},$I._render=function($I){this._isDead||($W.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),$m.drawCall++,$m.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},$I._getVertexBuffer=function($I){return void 0===$I&&($I=0),0===$I?this._vertexBuffer1:1===$I?this._vertexBuffer2:null},$I._getVertexBuffers=function(){return this._vertexBuffers},$I._getIndexBuffer=function(){return null},$I.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},$I._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},$t(0,$I,"_vertexBufferCount",function(){return this._vertexBuffers.length}),$t(0,$I,"triangleCount",function(){return 0}),$M.renderElementCount=0}(),function(){function $I(){}$p($I,"laya.d3.core.trail.VertexTrail");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration1}),$t(1,$I,"vertexDeclaration1",function(){return $I._vertexDeclaration1}),$t(1,$I,"vertexDeclaration2",function(){return $I._vertexDeclaration2}),$A($I,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new $nI(32,[new $cI(0,"vector3",0),new $cI(12,"vector3",41),new $cI(24,"single",33),new $cI(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new $nI(4,[new $cI(0,"single",38)])}]),$I}()),$II=function(){function $w($I){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=$I}$p($w,"laya.d3.graphics.DynamicBatch");var $I=$w.prototype;return $g.imps($I,{"laya.d3.core.render.IRenderable":!0}),$I._getVertexBuffer=function($I){return void 0===$I&&($I=0),0===$I?this._vertexBuffer:null},$I._getIndexBuffer=function(){return this._indexBuffer},$I._getCombineRenderElementFromPool=function($I,$M,$E){var $Z=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return $Z||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=$Z=new $P,$Z._sprite3D=new $DM),$Z._sprite3D._render._renderUpdate($E),$Z},$I._getRenderElement=function($I,$M,$E){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*$w.maxVertexCount),this._indexDatas=new Uint16Array($w.maxIndexCount),this._vertexBuffer=$xM.create(this._vertexDeclaration,$w.maxVertexCount,35048),this._indexBuffer=$JM.create("ushort",$w.maxIndexCount,35048));for(var $Z=this._merageElements.length=0,$i=0,$n=0,$c=this._combineRenderElements.length;$n<$c;$n++){var $f=this._combineRenderElements[$n],$d=$f.getDynamicBatchBakedVertexs(0),$H=$f.getBakedIndices(),$B=$f._sprite3D.transform._isFrontFaceInvert,$A=$Z/(this._vertexDeclaration.vertexStride/4),$Q=$i,$p=$Q+$H.length;$f._tempBatchIndexStart=$Q,$f._tempBatchIndexEnd=$p,this._indexDatas.set($H,$i);var $t=0;if($B)for($t=$Q;$t<$p;$t+=3){this._indexDatas[$t]=$A+this._indexDatas[$t];var $V=this._indexDatas[$t+1],$u=this._indexDatas[$t+2];this._indexDatas[$t+1]=$A+$u,this._indexDatas[$t+2]=$A+$V}else for($t=$Q;$t<$p;$t+=3)this._indexDatas[$t]=$A+this._indexDatas[$t],this._indexDatas[$t+1]=$A+this._indexDatas[$t+1],this._indexDatas[$t+2]=$A+this._indexDatas[$t+2];$i+=$H.length,this._vertexDatas.set($d,$Z),$Z+=$d.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),$n=this._combineRenderElementPoolIndex=0,$c=this._materials.length;$n<$c;$n++){var $N=this._getCombineRenderElementFromPool($I,$M,$E);$N._type=2,$N._staticBatch=null;var $y=($N.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[$n]]._tempBatchIndexStart,$$=$n+1===this._materialToRenderElementsOffsets.length?$i:this._combineRenderElements[this._materialToRenderElementsOffsets[$n+1]]._tempBatchIndexStart;$N._tempBatchIndexStart=$y,$N._tempBatchIndexEnd=$$,$N._material=this._materials[$n],this._merageElements.push($N)}},$I._addCombineRenderObjTest=function($I){var $M=$I.renderObj,$E=this._currentCombineIndexCount+$M._getIndexBuffer().indexCount,$Z=this._currentCombineVertexCount+$M._getVertexBuffer().vertexCount;return!($w.maxVertexCount<$Z||$w.maxIndexCount<$E)},$I._addCombineRenderObj=function($I){var $M=$I.renderObj;this._combineRenderElements.push($I),this._currentCombineIndexCount=this._currentCombineIndexCount+$M._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$M._getVertexBuffer().vertexCount},$I._addCombineMaterial=function($I){this._materials.push($I)},$I._addMaterialToRenderElementOffset=function($I){this._materialToRenderElementsOffsets.push($I)},$I._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},$I._addToRenderQueue=function($I,$M,$E,$Z){this._getRenderElement($M,$E,$Z);for(var $i=0,$n=this._materials.length;$i<$n;$i++)$I.getRenderQueue(this._materials[$i].renderQueue)._addDynamicBatchElement(this._merageElements[$i])},$I._beforeRender=function($I){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$I._render=function($I){var $M=$I._batchIndexEnd-$I._batchIndexStart;$W.mainContext.drawElements(4,$M,5123,2*$I._batchIndexStart),$m.drawCall++,$m.trianglesFaces+=$M/3},$I._getVertexBuffers=function(){return null},$t(0,$I,"_vertexBufferCount",function(){return 1}),$t(0,$I,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$t(0,$I,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),$w.maxVertexCount=2e4,$w.maxIndexCount=4e4,$w.maxCombineTriangleCount=10,$w}(),$MI=function(){function $w(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}$p($w,"laya.d3.graphics.DynamicBatchManager");var $I=$w.prototype;return $I.getDynamicBatch=function($I,$M){var $E,$Z=$I.id.toString()+$M;return this._dynamicBatches[$Z]?$E=this._dynamicBatches[$Z]:this._dynamicBatches[$Z]=$E=new $II($I),$E},$I._garbageCollection=function(){for(var $I in this._dynamicBatches)0===this._dynamicBatches[$I].combineRenderElementsCount&&delete this._dynamicBatches[$I]},$I._addPrepareRenderElement=function($I){this._prepareDynamicBatchCombineElements.push($I)},$I._finishCombineDynamicBatch=function($I){var $M,$E,$Z;this._prepareDynamicBatchCombineElements.sort($w._sortPrepareDynamicBatch);for(var $i,$n,$c,$f,$d,$H=-1,$B=!0,$A=0,$Q=-1,$p=0,$t=this._prepareDynamicBatchCombineElements.length;$p<$t;$p++){var $V=($n=this._prepareDynamicBatchCombineElements[$p]).renderObj._getVertexBuffer(0).vertexDeclaration,$u=$E!==$V;$u&&($A=0,$E=$V);var $N=$A!==$H;if($N&&($H=$A),($u||$N)&&($c=this.getDynamicBatch($V,$A),$M=null),$B)if($c._addCombineRenderObjTest($n)){if($M!==($i=$n._material))$f&&($I.getRenderQueue($d._material.renderQueue)._addRenderElement($d),$d=$f=null,$Q=-1),$f=$i,$Q=$c.combineRenderElementsCount,$d=$n,$M=$i;else if($f){var $y=$d.renderObj,$$=$n.renderObj;$y._getVertexBuffer().vertexCount+$$._getVertexBuffer().vertexCount>$II.maxVertexCount||$y._getIndexBuffer().indexCount+$$._getIndexBuffer().indexCount>$II.maxIndexCount?($I.getRenderQueue($d._material.renderQueue)._addRenderElement($d),$f=$i,$Q=$c.combineRenderElementsCount,$d=$n):($c._addCombineMaterial($f),$c._addMaterialToRenderElementOffset($Q),$c._addCombineRenderObj($d),$d=$f=null,$Q=-1,$c._addCombineRenderObj($n))}else $c._addCombineRenderObj($n);$B=!0}else $f&&($I.getRenderQueue($d._material.renderQueue)._addRenderElement($d),$d=$f=null,$Q=-1),$A++,$B=!1;else $Z=this._prepareDynamicBatchCombineElements[$p-1],$c._addMaterialToRenderElementOffset($c.combineRenderElementsCount),$M=$Z._material,$c._addCombineMaterial($M),$c._addCombineRenderObj($Z),$B=!0,$M!==($i=$n._material)?($f=$i,$Q=$c.combineRenderElementsCount,$d=$n):$c._addCombineRenderObj($n),$M=$i}$f&&($I.getRenderQueue($d._material.renderQueue)._addRenderElement($d),$d=$f=null,$Q=-1),this._prepareDynamicBatchCombineElements.length=0},$I._clearRenderElements=function(){for(var $I in this._dynamicBatches)this._dynamicBatches[$I]._clearRenderElements()},$I._addToRenderQueue=function($I,$M,$E,$Z){for(var $i in this._dynamicBatches){var $n=this._dynamicBatches[$i];0<$n.combineRenderElementsCount&&$n._addToRenderQueue($I,$M,$E,$Z)}},$I.dispose=function(){this._dynamicBatches=null},$w._sortPrepareDynamicBatch=function($I,$M){return $I._mainSortID-$M._mainSortID},$w}(),$EI=function(){function $I(){}return $p($I,"laya.d3.graphics.FrustumCulling"),$I.renderShadowObjectCulling=function($I,$M,$E,$Z,$i){var $n=0,$c=0,$f=0,$d=0;for($n=0,$f=$E.length;$n<$f;$n++){var $H=$E[$n];$H&&$H._clearRenderElements()}var $B,$A,$Q,$p=$I._cullingRenders;if(1<$i){for($n=0,$f=$I._cullingRendersLength;$n<$f;$n++)if(($B=$p[$n]).castShadow&&$L.isVisible($B._owner.layer.mask)&&$B.enable)for(var $t=1,$V=$M.length;$t<$V;$t++)if($A=$E[$t-1],0!==$M[$t].containsBoundSphere($B.boundingSphere))for($c=0,$d=($Q=$B._renderElements).length;$c<$d;$c++)$A._addRenderElement($Q[$c])}else for($n=0,$f=$I._cullingRendersLength;$n<$f;$n++)if(($B=$p[$n]).castShadow&&$L.isVisible($B._owner.layer.mask)&&$B.enable&&0!==$M[0].containsBoundSphere($B.boundingSphere))for($B._renderUpdate($Z),$A=$E[0],$c=0,$d=($Q=$B._renderElements).length;$c<$d;$c++)$A._addRenderElement($Q[$c])},$I.renderShadowObjectCullingOctree=function($I,$M,$E,$Z,$i){for(var $n=0,$c=$E.length;$n<$c;$n++){var $f=$E[$n];$f&&$f._clearRenderElements()}1<$i?$I.treeRoot.cullingShadowObjects($M,$E,!0,0,$I):$I.treeRoot.cullingShadowObjectsOnePSSM($M[0],$E,$Z,!0,0,$I)},$I.renderObjectCulling=function($I,$M,$E,$Z,$i,$n){var $c=0,$f=0,$d=0,$H=0,$B=$M._quenes,$A=$M._dynamicBatchManager,$Q=$M._cullingRenders;for($c=0,$f=$B.length;$c<$f;$c++){var $p=$B[$c];$p&&$p._clearRenderElements()}var $t=$ZI._staticBatchManagers;for($c=0,$f=$t.length;$c<$f;$c++)$t[$c]._clearRenderElements();$A._clearRenderElements();var $V=$E.transform.position;for($c=0,$f=$M._cullingRendersLength;$c<$f;$c++){var $u=$Q[$c];if($L.isVisible($u._owner.layer.mask)&&$u.enable&&0!==$I.containsBoundSphere($u.boundingSphere)&&$u._renderUpdate($n)){$u._distanceForSort=$cM.distance($u.boundingSphere.center,$V)+$u.sortingFudge;var $N=$u._renderElements;for($d=0,$H=$N.length;$d<$H;$d++){var $y=$N[$d],$$=$y._staticBatch;if($$&&$$._material===$y._material)$$._addBatchRenderElement($y);else{var $w=$y.renderObj;$w.triangleCount<10&&1===$w._vertexBufferCount&&$w._getIndexBuffer()&&$y._material.renderQueue<2&&$y._canDynamicBatch&&!$u._owner.isStatic?$A._addPrepareRenderElement($y):$M.getRenderQueue($y._material.renderQueue)._addRenderElement($y)}}}}for($c=0,$f=$t.length;$c<$f;$c++)$t[$c]._addToRenderQueue($M,$Z,$i,$n);$A._finishCombineDynamicBatch($M),$A._addToRenderQueue($M,$Z,$i,$n)},$I.renderObjectCullingOctree=function($I,$M,$E,$Z,$i,$n){var $c=0,$f=0,$d=$M._quenes,$H=$M._dynamicBatchManager;for($c=0,$f=$d.length;$c<$f;$c++){var $B=$d[$c];$B&&$B._clearRenderElements()}var $A=$ZI._staticBatchManagers;for($c=0,$f=$A.length;$c<$f;$c++)$A[$c]._clearRenderElements();for($H._clearRenderElements(),$M._cullingRenders.length=0,$M.treeRoot.cullingObjects($I,!0,0,$E.transform.position,$n),$c=0,$f=$A.length;$c<$f;$c++)$A[$c]._addToRenderQueue($M,$Z,$i,$n);$H._finishCombineDynamicBatch($M),$H._addToRenderQueue($M,$Z,$i,$n)},$I.renderObjectCullingNoBoundFrustum=function($I,$M,$E,$Z,$i){var $n=0,$c=0,$f=0,$d=0,$H=$I._quenes,$B=$I._dynamicBatchManager,$A=$I._cullingRenders;for($n=0,$c=$H.length;$n<$c;$n++){var $Q=$H[$n];$Q&&$Q._clearRenderElements()}var $p=$ZI._staticBatchManagers;for($n=0,$c=$p.length;$n<$c;$n++)$p[$n]._clearRenderElements();$B._clearRenderElements();var $t=$M.transform.position;for($n=0,$c=$I._cullingRendersLength;$n<$c;$n++){var $V=$A[$n];if($L.isVisible($V._owner.layer.mask)&&$V.enable){$V._renderUpdate($i),$V._distanceForSort=$cM.distance($V.boundingSphere.center,$t)+$V.sortingFudge;var $u=$V._renderElements;for($f=0,$d=$u.length;$f<$d;$f++){var $N=$u[$f],$y=$N._staticBatch;if($y&&$y._material===$N._material)$y._addBatchRenderElement($N);else{var $$=$N.renderObj;$$.triangleCount<10&&1===$$._vertexBufferCount&&$$._getIndexBuffer()&&$N._material.renderQueue<2&&$N._canDynamicBatch&&!$V._owner.isStatic?$B._addPrepareRenderElement($N):$I.getRenderQueue($N._material.renderQueue)._addRenderElement($N)}}}}for($n=0,$c=$p.length;$n<$c;$n++)$p[$n]._addToRenderQueue($I,$E,$Z,$i);$B._finishCombineDynamicBatch($I),$B._addToRenderQueue($I,$E,$Z,$i)},$I}(),$ZI=function(){function $n(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}$p($n,"laya.d3.graphics.StaticBatchManager");var $I=$n.prototype;return $I._finishInit=function(){for(var $I in this._staticBatches)this._staticBatches[$I]._finishInit();this._initBatchRenderElements.length=0},$I._initStaticBatchs=function($I){throw new Error("StaticBatchManager:must override this function.")},$I._addInitBatchSprite=function($I){for(var $M=$I._render._renderElements,$E=0,$Z=$M.length;$E<$Z;$E++)this._initBatchRenderElements.push($M[$E])},$I._clearRenderElements=function(){for(var $I in this._staticBatches)this._staticBatches[$I]._clearRenderElements()},$I._garbageCollection=function($I){var $M=$I._staticBatch,$E=$M._initBatchRenderElements,$Z=$E.indexOf($I);$E.splice($Z,1),0===$E.length&&($M.dispose(),delete this._staticBatches[$M._key])},$I._addToRenderQueue=function($I,$M,$E,$Z){for(var $i in this._staticBatches){var $n=this._staticBatches[$i];0<$n._batchRenderElements.length&&$n._updateToRenderQueue($I,$Z)}},$I.dispose=function(){this._staticBatches=null},$n._addToStaticBatchQueue=function($I){$I instanceof laya.d3.core.RenderableSprite3D&&$I._addToInitStaticBatchManager();for(var $M=0,$E=$I.numChildren;$M<$E;$M++)$n._addToStaticBatchQueue($I._childs[$M])},$n.combine=function($I,$M){var $E,$Z=0,$i=0;if($M)for($Z=0,$i=$M.length;$Z<$i;$Z++){$M[$Z]._addToInitStaticBatchManager()}else $I&&$n._addToStaticBatchQueue($I);for($Z=0,$i=$n._staticBatchManagers.length;$Z<$i;$Z++)($E=$n._staticBatchManagers[$Z])._initStaticBatchs($I),$E._finishInit()},$n._staticBatchManagers=[],$n}(),$iI=function(){function $I($I,$M,$E){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=$I,this._manager=$M,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=$E}$p($I,"laya.d3.graphics.StaticBatch");var $M=$I.prototype;return $g.imps($M,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$M._binarySearch=function($I){for(var $M=0,$E=this._batchRenderElements.length-1,$Z=0;$M<=$E;)$Z=Math.floor(($M+$E)/2),this._compareBatchRenderElement(this._batchRenderElements[$Z],$I)?$E=$Z-1:$M=$Z+1;return $M},$M._compareBatchRenderElement=function($I,$M){throw new Error("StaticBatch:must override this function.")},$M._getVertexDecLightMap=function($I){return $I===$JI.vertexDeclaration?$LI.vertexDeclaration:$I===$CI.vertexDeclaration?$zI.vertexDeclaration:$I===$jI.vertexDeclaration?$wI.vertexDeclaration:$I===$lI.vertexDeclaration?null:$I===$VI.vertexDeclaration?$uI.vertexDeclaration:$I===$kI.vertexDeclaration?$SI.vertexDeclaration:$I===$WI.vertexDeclaration?$RI.vertexDeclaration:$I===$xI.vertexDeclaration?$oI.vertexDeclaration:$I===$CI.vertexDeclaration?$zI.vertexDeclaration:$I===$TI.vertexDeclaration?$gI.vertexDeclaration:$I===$lI.vertexDeclaration?null:$I===$VI.vertexDeclaration?$uI.vertexDeclaration:$I===$rI.vertexDeclaration?$XI.vertexDeclaration:$I===$WI.vertexDeclaration?$RI.vertexDeclaration:$I},$M._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},$M._addBatchRenderElement=function($I){this._batchRenderElements.splice(this._binarySearch($I),0,$I)},$M._updateToRenderQueue=function($I,$M){this._combineRenderElementPoolIndex=0,this._getRenderElement($I.getRenderQueue(this._material.renderQueue)._renderElements,$I,$M)},$M._getRenderElement=function($I,$M,$E){throw new Error("StaticBatch:must override this function.")},$M._finishInit=function(){throw new Error("StaticBatch:must override this function.")},$M._clearRenderElements=function(){this._batchRenderElements.length=0},$M.dispose=function(){},$M._getVertexBuffer=function($I){return void 0===$I&&($I=0),null},$M._getIndexBuffer=function(){return null},$M._beforeRender=function($I){return!0},$M._render=function($I){},$M._getVertexBuffers=function(){return null},$t(0,$M,"_vertexBufferCount",function(){return 1}),$t(0,$M,"triangleCount",function(){return 0}),$I.combine=function($I){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),$ZI.combine($I)},$I.maxBatchVertexCount=65535,$I}(),$nI=function(){function $c($I,$M){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++$c._uniqueIDCounter,this._id>$c.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",$c.maxVertexDeclaration);this._shaderValues=new $QM,this._vertexElementsDic={},this._vertexStride=$I,this._vertexElements=$M;for(var $E=0;$E<$M.length;$E++){var $Z=$M[$E],$i=$Z.elementUsage;this._vertexElementsDic[$i]=$Z;var $n=[$c._getTypeSize($Z.elementFormat)/4,5126,!1,this._vertexStride,$Z.offset];switch(this._shaderValues.setValue($i,$n),$i){case 1:this._addShaderDefine($mM.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine($mM.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine($mM.SHADERDEFINE_UV1)}}}$p($c,"laya.d3.graphics.VertexDeclaration");var $I=$c.prototype;return $I._addShaderDefine=function($I){this._shaderDefineValue|=$I},$I._removeShaderDefine=function($I){this._shaderDefineValue&=~$I},$I.getVertexElements=function(){return this._vertexElements.slice()},$I.getVertexElementByUsage=function($I){return this._vertexElementsDic[$I]},$I.unBinding=function(){},$t(0,$I,"shaderDefineValue",function(){return this._shaderDefineValue}),$t(0,$I,"id",function(){return this._id}),$t(0,$I,"vertexStride",function(){return this._vertexStride}),$t(0,$I,"shaderValues",function(){return this._shaderValues}),$c._getTypeSize=function($I){switch($I){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},$c.getVertexStride=function($I){for(var $M=0,$E=0;$E<$I.Length;$E++){var $Z=$I[$E],$i=$Z.offset+$c._getTypeSize($Z.elementFormat);$M<$i&&($M=$i)}return $M},$c._maxVertexDeclarationBit=1e3,$c._uniqueIDCounter=1,$A($c,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),$c}(),$cI=function(){function $I($I,$M,$E){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=$I,this.elementFormat=$M,this.elementUsage=$E}return $p($I,"laya.d3.graphics.VertexElement"),$I}(),$fI=(function(){function $I(){}$p($I,"laya.d3.graphics.VertexElementFormat"),$I.Single="single",$I.Vector2="vector2",$I.Vector3="vector3",$I.Vector4="vector4",$I.Color="color",$I.Byte4="byte4",$I.Short2="short2",$I.Short4="short4",$I.NormalizedShort2="normalizedshort2",$I.NormalizedShort4="normalizedshort4",$I.HalfVector2="halfvector2",$I.HalfVector4="halfvector4"}(),function(){function $I(){}$p($I,"laya.d3.graphics.VertexElementUsage"),$I.POSITION0=0,$I.COLOR0=1,$I.TEXTURECOORDINATE0=2,$I.NORMAL0=3,$I.BINORMAL0=4,$I.TANGENT0=5,$I.BLENDINDICES0=6,$I.BLENDWEIGHT0=7,$I.DEPTH0=8,$I.FOG0=9,$I.POINTSIZE0=10,$I.SAMPLE0=11,$I.TESSELLATEFACTOR0=12,$I.COLOR1=13,$I.NEXTTEXTURECOORDINATE0=14,$I.TEXTURECOORDINATE1=15,$I.NEXTTEXTURECOORDINATE1=16,$I.CORNERTEXTURECOORDINATE0=17,$I.VELOCITY0=18,$I.STARTCOLOR0=19,$I.STARTSIZE=20,$I.AGEADDSCALE0=21,$I.STARTROTATION=22,$I.ENDCOLOR0=23,$I.STARTLIFETIME=24,$I.TIME0=33,$I.SHAPEPOSITIONSTARTLIFETIME=30,$I.DIRECTIONTIME=32,$I.SIZEROTATION0=27,$I.RADIUS0=28,$I.RADIAN0=29,$I.STARTSPEED=31,$I.RANDOM0=34,$I.RANDOM1=35,$I.SIMULATIONWORLDPOSTION=36,$I.SIMULATIONWORLDROTATION=37,$I.TEXTURECOORDINATE0X=38,$I.TEXTURECOORDINATE0X1=39,$I.TEXTURECOORDINATE0Y=40,$I.OFFSETVECTOR=41}(),function(){function $I($I,$M,$E){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=$I,this._textureCoordinate0=$M,this._time=$E}$p($I,"laya.d3.graphics.VertexGlitter");var $M=$I.prototype;$g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate0}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"time",function(){return this._time}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(24,[new $cI(0,"vector3",0),new $cI(12,"vector2",2),new $cI(20,"single",33)])}])}(),function(){function $I($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=$I,this._position=$M,this._velocity=$E,this._startColor=$Z,this._endColor=$i,this._sizeRotation=$n,this._radius=$c,this._radian=$f,this._ageAddScale=$d,this._time=$H}$p($I,"laya.d3.graphics.VertexParticle");var $M=$I.prototype;$g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"endColor",function(){return this._endColor}),$t(0,$M,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$t(0,$M,"sizeRotation",function(){return this._sizeRotation}),$t(0,$M,"velocity",function(){return this._velocity}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"startColor",function(){return this._startColor}),$t(0,$M,"radius",function(){return this._radius}),$t(0,$M,"radian",function(){return this._radian}),$t(0,$M,"ageAddScale",function(){return this._ageAddScale}),$t(0,$M,"time",function(){return this._time}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(116,[new $cI(0,"vector4",17),new $cI(16,"vector3",0),new $cI(28,"vector3",18),new $cI(40,"vector4",19),new $cI(56,"vector4",23),new $cI(72,"vector3",27),new $cI(84,"vector2",28),new $cI(92,"vector4",29),new $cI(108,"single",24),new $cI(112,"single",33)])}])}(),function(){function $I($I){this._position=null,this._position=$I}$p($I,"laya.d3.graphics.VertexPosition");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(12,[new $cI(0,"vector3",0)])}]),$I}()),$dI=function(){function $I($I,$M){this._position=null,this._normal=null,this._position=$I,this._normal=$M}$p($I,"laya.d3.graphics.VertexPositionNormal");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(24,[new $cI(0,"vector3",0),new $cI(12,"vector3",3)])}]),$I}(),$HI=function(){function $I($I,$M,$E){this._position=null,this._normal=null,this._color=null,this._position=$I,this._normal=$M,this._color=$E}$p($I,"laya.d3.graphics.VertexPositionNormalColor");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(40,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1)])}]),$I}(),$BI=function(){function $I($I,$M,$E,$Z,$i){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=$I,this._normal=$M,this._color=$E,this._blendIndex=$Z,this._blendWeight=$i}$p($I,"laya.d3.graphics.VertexPositionNormalColorSkin");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(72,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector4",7),new $cI(56,"vector4",6)])}]),$I}(),$AI=function(){function $I($I,$M,$E,$Z,$i,$n){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$I,this._normal=$M,this._color=$E,this._tangent=$Z,this._blendIndex=$i,this._blendWeight=$n}$p($I,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(88,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector4",7),new $cI(56,"vector4",6),new $cI(72,"vector4",5)])}]),$I}(),$QI=function(){function $I($I,$M,$E,$Z,$i,$n){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$I,this._normal=$M,this._color=$E,this._tangent=$Z,this._blendIndex=$i,this._blendWeight=$n}$p($I,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(84,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector4",7),new $cI(56,"vector4",6),new $cI(72,"vector3",5)])}]),$I}(),$pI=function(){function $I($I,$M,$E,$Z){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$I,this._normal=$M,this._color=$E,this._tangent=$Z}$p($I,"laya.d3.graphics.VertexPositionNormalColorSTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(56,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector4",5)])}]),$I}(),$tI=function(){function $I($I,$M,$E,$Z){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=$I,this._normal=$M,this._color=$E,this._tangent=$Z}$p($I,"laya.d3.graphics.VertexPositionNormalColorTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(52,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector3",5)])}]),$I}(),$VI=function(){function $I($I,$M,$E,$Z){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=$I,this._normal=$M,this._color=$E,this._textureCoordinate=$Z}$p($I,"laya.d3.graphics.VertexPositionNormalColorTexture");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(48,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector2",2)])}]),$I}(),$uI=function(){function $I($I,$M,$E,$Z,$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$I,this._normal=$M,this._color=$E,this._textureCoordinate0=$Z,this._textureCoordinate1=$i}$p($I,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(0,$M,"textureCoordinate1",function(){return this._textureCoordinate1}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(56,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector2",2),new $cI(48,"vector2",15)])}]),$I}(),$NI=function(){function $I($I,$M,$E,$Z,$i,$n,$c){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$I,this._normal=$M,this._color=$E,this._textureCoordinate0=$Z,this._textureCoordinate1=$i,this._blendIndex=$n,this._blendWeight=$c}$p($I,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(0,$M,"textureCoordinate1",function(){return this._textureCoordinate1}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(88,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector2",2),new $cI(48,"vector2",15),new $cI(56,"vector4",7),new $cI(72,"vector4",6)])}]),$I}(),$yI=function(){function $I($I,$M,$E,$Z,$i,$n,$c,$f){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$I,this._normal=$M,this._color=$E,this._textureCoordinate0=$Z,this._textureCoordinate1=$i,this._tangent=$n,this._blendIndex=$c,this._blendWeight=$f}$p($I,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(0,$M,"textureCoordinate1",function(){return this._textureCoordinate1}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(104,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector2",2),new $cI(48,"vector2",15),new $cI(56,"vector4",7),new $cI(72,"vector4",6),new $cI(88,"vector4",5)])}]),$I}(),$$I=function(){function $I(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$p($I,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$M.VertexPositionNormalColorTexture0SkinTangent=function($I,$M,$E,$Z,$i,$n,$c,$f){this._position=$I,this._normal=$M,this._color=$E,this._textureCoordinate0=$Z,this._textureCoordinate1=$i,this._tangent=$n,this._blendIndex=$c,this._blendWeight=$f},$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(0,$M,"textureCoordinate1",function(){return this._textureCoordinate1}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(100,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector2",2),new $cI(48,"vector2",15),new $cI(56,"vector4",7),new $cI(72,"vector4",6),new $cI(88,"vector3",5)])}]),$I}(),$wI=function(){function $I($I,$M,$E,$Z,$i,$n){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$I,this._normal=$M,this._color=$E,this._textureCoordinate0=$Z,this._textureCoordinate1=$i,this._tangent=$n}$p($I,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(0,$M,"textureCoordinate1",function(){return this._textureCoordinate1}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(72,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector2",2),new $cI(48,"vector2",15),new $cI(56,"vector4",5)])}]),$I}(),$gI=function(){function $I(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$p($I,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$M.VertexPositionNormalColorTexture0Tangent=function($I,$M,$E,$Z,$i,$n){this._position=$I,this._normal=$M,this._color=$E,this._textureCoordinate0=$Z,this._textureCoordinate1=$i,this._tangent=$n},$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(0,$M,"textureCoordinate1",function(){return this._textureCoordinate1}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(68,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector2",2),new $cI(48,"vector2",15),new $cI(56,"vector3",5)])}]),$I}(),$OI=function(){function $I($I,$M,$E,$Z,$i,$n){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$I,this._normal=$M,this._color=$E,this._textureCoordinate=$Z,this._blendIndex=$i,this._blendWeight=$n}$p($I,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(80,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector2",2),new $cI(48,"vector4",7),new $cI(64,"vector4",6)])}]),$I}(),$aI=function(){function $I($I,$M,$E,$Z,$i,$n,$c){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$I,this._normal=$M,this._color=$E,this._textureCoordinate=$Z,this._tangent=$i,this._blendIndex=$n,this._blendWeight=$c}$p($I,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(96,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector2",2),new $cI(48,"vector4",7),new $cI(64,"vector4",6),new $cI(80,"vector4",5)])}]),$I}(),$mI=function(){function $I($I,$M,$E,$Z,$i,$n,$c){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$I,this._normal=$M,this._color=$E,this._textureCoordinate=$Z,this._tangent=$i,this._blendIndex=$n,this._blendWeight=$c}$p($I,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(92,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector2",2),new $cI(48,"vector4",7),new $cI(64,"vector4",6),new $cI(80,"vector3",5)])}]),$I}(),$jI=function(){function $I($I,$M,$E,$Z,$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$I,this._normal=$M,this._color=$E,this._textureCoordinate=$Z,this._tangent=$i}$p($I,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(64,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector2",2),new $cI(48,"vector4",5)])}]),$I}(),$TI=function(){function $I($I,$M,$E,$Z,$i){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=$I,this._normal=$M,this._color=$E,this._textureCoordinate=$Z,this._tangent=$i}$p($I,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"color",function(){return this._color}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(60,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",1),new $cI(40,"vector2",2),new $cI(48,"vector3",5)])}]),$I}(),$qI=function(){function $I($I,$M,$E){this._position=null,this._normal=null,this._tangent=null,this._position=$I,this._normal=$M,this._tangent=$E}$p($I,"laya.d3.graphics.VertexPositionNormalSTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(40,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector4",5)])}]),$I}(),$vI=function(){function $I($I,$M,$E){this._position=null,this._normal=null,this._tangent=null,this._position=$I,this._normal=$M,this._tangent=$E}$p($I,"laya.d3.graphics.VertexPositionNormalTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(36,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector3",5)])}]),$I}(),$WI=function(){function $I($I,$M,$E){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$I,this._normal=$M,this._textureCoordinate=$E}$p($I,"laya.d3.graphics.VertexPositionNormalTexture");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(32,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector2",2)])}]),$I}(),$RI=function(){function $I($I,$M,$E,$Z){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=$I,this._normal=$M,this._textureCoordinate0=$E,this._textureCoordinate1=$Z}$p($I,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(0,$M,"textureCoordinate1",function(){return this._textureCoordinate1}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(40,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector2",2),new $cI(32,"vector2",15)])}]),$I}(),$zI=function(){function $I($I,$M,$E,$Z,$i,$n){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=$I,this._normal=$M,this._textureCoordinate0=$E,this._textureCoordinate1=$Z,this._blendIndex=$i,this._blendWeight=$n}$p($I,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(0,$M,"textureCoordinate1",function(){return this._textureCoordinate1}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(72,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector2",2),new $cI(32,"vector2",15),new $cI(40,"vector4",7),new $cI(56,"vector4",6)])}]),$I}(),$LI=function(){function $I($I,$M,$E,$Z,$i,$n,$c){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$I,this._normal=$M,this._textureCoordinate0=$E,this._textureCoordinate1=$Z,this._tangent=$i,this._blendIndex=$n,this._blendWeight=$c}$p($I,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(0,$M,"textureCoordinate1",function(){return this._textureCoordinate1}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(88,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector2",2),new $cI(32,"vector2",15),new $cI(40,"vector4",7),new $cI(56,"vector4",6),new $cI(72,"vector4",5)])}]),$I}(),$oI=function(){function $I(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}$p($I,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$M.VertexPositionNormalTexture0SkinTangent=function($I,$M,$E,$Z,$i,$n,$c){this._position=$I,this._normal=$M,this._textureCoordinate0=$E,this._textureCoordinate1=$Z,this._tangent=$i,this._blendIndex=$n,this._blendWeight=$c},$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(0,$M,"textureCoordinate1",function(){return this._textureCoordinate1}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(84,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector2",2),new $cI(32,"vector2",15),new $cI(40,"vector4",7),new $cI(56,"vector4",6),new $cI(72,"vector3",5)])}]),$I}(),$SI=function(){function $I($I,$M,$E,$Z,$i){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=$I,this._normal=$M,this._textureCoordinate0=$E,this._textureCoordinate1=$Z,this._tangent=$i}$p($I,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(0,$M,"textureCoordinate1",function(){return this._textureCoordinate1}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(56,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector2",2),new $cI(32,"vector2",15),new $cI(40,"vector4",5)])}]),$I}(),$XI=function(){function $I(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}$p($I,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$M.VertexPositionNormalTexture0Tangent=function($I,$M,$E,$Z,$i){this._position=$I,this._normal=$M,this._textureCoordinate0=$E,this._textureCoordinate1=$Z,this._tangent=$i},$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(0,$M,"textureCoordinate1",function(){return this._textureCoordinate1}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(52,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector2",2),new $cI(32,"vector2",15),new $cI(40,"vector3",5)])}]),$I}(),$CI=function(){function $I($I,$M,$E,$Z,$i){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=$I,this._normal=$M,this._textureCoordinate=$E,this._blendIndex=$Z,this._blendWeight=$i}$p($I,"laya.d3.graphics.VertexPositionNormalTextureSkin");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(64,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector2",2),new $cI(32,"vector4",7),new $cI(48,"vector4",6)])}]),$I}(),$JI=function(){function $I($I,$M,$E,$Z,$i,$n){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$I,this._normal=$M,this._textureCoordinate=$E,this._tangent=$Z,this._blendIndex=$i,this._blendWeight=$n}$p($I,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(80,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector2",2),new $cI(32,"vector4",7),new $cI(48,"vector4",6),new $cI(64,"vector4",5)])}]),$I}(),$xI=function(){function $I($I,$M,$E,$Z,$i,$n){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=$I,this._normal=$M,this._textureCoordinate=$E,this._tangent=$Z,this._blendIndex=$i,this._blendWeight=$n}$p($I,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(76,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector2",2),new $cI(32,"vector4",7),new $cI(48,"vector4",6),new $cI(64,"vector3",5)])}]),$I}(),$kI=function(){function $I($I,$M,$E,$Z){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$I,this._normal=$M,this._textureCoordinate=$E,this._tangent=$Z}$p($I,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(48,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector2",2),new $cI(32,"vector4",5)])}]),$I}(),$rI=function(){function $I($I,$M,$E,$Z){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=$I,this._normal=$M,this._textureCoordinate=$E,this._tangent=$Z}$p($I,"laya.d3.graphics.VertexPositionNormalTextureTangent");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(44,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector2",2),new $cI(32,"vector3",5)])}]),$I}(),$lI=function(){function $I($I,$M,$E){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$I,this._normal=$M,this._textureCoordinate=$E}$p($I,"laya.d3.graphics.VertexPositionNTBTexture");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(56,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector3",5),new $cI(36,"vector3",4),new $cI(48,"vector2",2)])}]),$I}(),$FI=function(){function $I($I,$M,$E,$Z,$i,$n,$c,$f){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=$I,this._normal=$M,this._textureCoordinate0=$Z,this._textureCoordinate1=$i,this._tangent=$n,$E=$E,this._blendIndex=$c,this._blendWeight=$f}$p($I,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"tangent",function(){return this._tangent}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(0,$M,"textureCoordinate1",function(){return this._textureCoordinate1}),$t(0,$M,"blendIndex",function(){return this._blendIndex}),$t(0,$M,"blendWeight",function(){return this._blendWeight}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(96,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector3",5),new $cI(36,"vector3",4),new $cI(48,"vector2",2),new $cI(56,"vector2",15),new $cI(64,"vector4",7),new $cI(80,"vector4",6)])}]),$I}(),$eI=function(){function $I($I,$M,$E){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=$I,this._normal=$M,this._textureCoordinate=$E}$p($I,"laya.d3.graphics.VertexPositionNTBTextureSkin");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"textureCoordinate",function(){return this._textureCoordinate}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(88,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector3",5),new $cI(36,"vector3",4),new $cI(48,"vector2",2),new $cI(56,"vector4",7),new $cI(72,"vector4",6)])}]),$I}(),$_I=(function(){function $I($I,$M,$E,$Z){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=$I,this._normal=$M,this._textureCoord0=$E,this._textureCoord1=$Z}$p($I,"laya.d3.graphics.VertexPositionTerrain");var $M=$I.prototype;$g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"normal",function(){return this._normal}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"textureCoord0",function(){return this._textureCoord0}),$t(0,$M,"textureCoord1",function(){return this._textureCoord1}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(40,[new $cI(0,"vector3",0),new $cI(12,"vector3",3),new $cI(24,"vector2",2),new $cI(32,"vector2",15)])}])}(),function(){function $I($I,$M){this._position=null,this._textureCoordinate0=null,this._position=$I,this._textureCoordinate0=$M}$p($I,"laya.d3.graphics.VertexPositionTexture0");var $M=$I.prototype;return $g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"position",function(){return this._position}),$t(0,$M,"textureCoordinate0",function(){return this._textureCoordinate0}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(20,[new $cI(0,"vector3",0),new $cI(12,"vector2",2)])}]),$I}()),$hI=(function(){function $I($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B,$A,$Q,$p){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$I,this._positionStartLifeTime=$M,this._velocity=$E,this._startColor=$Z,this._startSize=$i,this._startRotation0=$n,this._startRotation1=$c,this._startRotation2=$f,this._startLifeTime=$d,this._time=$H,this._startSpeed=$B,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$p}$p($I,"laya.d3.graphics.VertexShurikenParticleBillboard");var $M=$I.prototype;$g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$t(0,$M,"random1",function(){return this._randoms1}),$t(0,$M,"startRotation2",function(){return this._startRotation2}),$t(0,$M,"positionStartLifeTime",function(){return this._positionStartLifeTime}),$t(0,$M,"velocity",function(){return this._velocity}),$t(0,$M,"random0",function(){return this._randoms0}),$t(0,$M,"startSize",function(){return this._startSize}),$t(0,$M,"startColor",function(){return this._startColor}),$t(0,$M,"startRotation0",function(){return this._startRotation0}),$t(0,$M,"startRotation1",function(){return this._startRotation1}),$t(0,$M,"startLifeTime",function(){return this._startLifeTime}),$t(0,$M,"time",function(){return this._time}),$t(0,$M,"startSpeed",function(){return this._startSpeed}),$t(0,$M,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(152,[new $cI(0,"vector4",17),new $cI(16,"vector4",30),new $cI(32,"vector4",32),new $cI(48,"vector4",19),new $cI(64,"vector3",20),new $cI(76,"vector3",22),new $cI(88,"single",31),new $cI(92,"vector4",34),new $cI(108,"vector4",35),new $cI(124,"vector3",36),new $cI(136,"vector4",37)])}])}(),function(){function $I($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B,$A,$Q,$p){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=$I,this._positionStartLifeTime=$M,this._velocity=$E,this._startColor=$Z,this._startSize=$i,this._startRotation0=$n,this._startRotation1=$c,this._startRotation2=$f,this._startLifeTime=$d,this._time=$H,this._startSpeed=$B,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=$p}$p($I,"laya.d3.graphics.VertexShurikenParticleMesh");var $M=$I.prototype;$g.imps($M,{"laya.d3.graphics.IVertex":!0}),$t(0,$M,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),$t(0,$M,"velocity",function(){return this._velocity}),$t(0,$M,"position",function(){return this._positionStartLifeTime}),$t(0,$M,"random0",function(){return this._randoms0}),$t(0,$M,"startSize",function(){return this._startSize}),$t(0,$M,"startColor",function(){return this._startColor}),$t(0,$M,"startRotation0",function(){return this._startRotation0}),$t(0,$M,"startRotation1",function(){return this._startRotation1}),$t(0,$M,"random1",function(){return this._randoms1}),$t(0,$M,"startRotation2",function(){return this._startRotation2}),$t(0,$M,"startLifeTime",function(){return this._startLifeTime}),$t(0,$M,"time",function(){return this._time}),$t(0,$M,"startSpeed",function(){return this._startSpeed}),$t(0,$M,"simulationWorldPostion",function(){return this._simulationWorldPostion}),$t(0,$M,"vertexDeclaration",function(){return $I._vertexDeclaration}),$t(1,$I,"vertexDeclaration",function(){return $I._vertexDeclaration}),$A($I,["_vertexDeclaration",function(){return this._vertexDeclaration=new $nI(172,[new $cI(0,"vector3",0),new $cI(12,"vector4",1),new $cI(28,"vector2",2),new $cI(36,"vector4",30),new $cI(52,"vector4",32),new $cI(68,"vector4",19),new $cI(84,"vector3",20),new $cI(96,"vector3",22),new $cI(108,"single",31),new $cI(112,"vector4",34),new $cI(128,"vector4",35),new $cI(144,"vector3",36),new $cI(156,"vector4",37)])}])}(),function(){function $$($I,$M,$E,$Z,$i,$n){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=$E,this._materials=$Z,this._subMeshes=$i,this._materialMap=$n,this._version=$M,this._onLoaded($I)}$p($$,"laya.d3.loaders.LoadModelV01");var $I=$$.prototype;return $I._onLoaded=function($I){this._readData=$I,this.READ_BLOCK();for(var $M=0;$M<this._BLOCK.count;$M++){var $E=this._readData.getUint16(),$Z=this._strings[$E],$i=this["READ_"+$Z];if(null==$i)throw new Error("model file err,no this function:"+$E+" "+$Z);if(!$i.call(this))break}return this._mesh},$I.onError=function(){},$I._readString=function(){return this._strings[this._readData.getUint16()]},$I.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},$I.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},$I.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var $I=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var $M=0;$M<this._STRINGS.size;$M++)this._strings[$M]=this._readData.readUTFString();return this._readData.pos=$I,!0},$I.READ_MATERIAL=function(){var $I=this._readData.getUint16(),$M=(this._readString(),this._readString());return this._materials[$I]="null"!==$M?$N.getRes(this._materialMap[$M]):new $vM,!0},$I.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var $I,$M=this._readData.__getBuffer(),$E=0,$Z=this._readData.getUint32(),$i=this._readData.getUint32(),$n=(new Float32Array($M.slice($Z+this._DATA.offset,$Z+this._DATA.offset+$i)),this._readData.getUint32()),$c=this._readData.getUint32(),$f=new Float32Array($M.slice($n+this._DATA.offset,$n+this._DATA.offset+$c));for(this.mesh._inverseBindPoses=[],$E=0,$I=$f.length;$E<$I;$E+=16){var $d=new $IM($f[$E+0],$f[$E+1],$f[$E+2],$f[$E+3],$f[$E+4],$f[$E+5],$f[$E+6],$f[$E+7],$f[$E+8],$f[$E+9],$f[$E+10],$f[$E+11],$f[$E+12],$f[$E+13],$f[$E+14],$f[$E+15]);this.mesh._inverseBindPoses.push($d)}break;default:throw new Error("LoadModel:unknown version.")}return!0},$I.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var $I=this._readString();this._shaderAttributes=$I.match($$._attrReg);var $M=this._readData.getUint32(),$E=this._readData.getUint32(),$Z=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),$i=this._readData.getUint32(),$n=this._readData.getUint32(),$c=this._readData.getUint32(),$f=this._readData.__getBuffer(),$d=new $HM(this._mesh),$H=this._getVertexDeclaration(),$B=$xM.create($H,$i/$H.vertexStride,35044,!0),$A=$Z+this._DATA.offset,$Q=$f.slice($A,$A+$i);$B.setData(new Float32Array($Q));for(var $p=($d._vertexBuffer=$B).vertexDeclaration.getVertexElements(),$t=0;$t<$p.length;$t++)$d._bufferUsage[$p[$t].elementUsage]=$B;var $V=$JM.create("ushort",$E/2,35044,!0),$u=$M+this._DATA.offset,$N=$f.slice($u,$u+$E);$V.setData(new Uint16Array($N)),$d._indexBuffer=$V;var $y=$f.slice($n+this._DATA.offset,$n+this._DATA.offset+$c);return $d._boneIndicesList[0]=new Uint8Array($y),this._subMeshes.push($d),!0},$I.READ_DATAAREA=function(){return!1},$I._getVertexDeclaration=function(){for(var $I,$M=!1,$E=!1,$Z=!1,$i=!1,$n=!1,$c=!1,$f=!1,$d=!1,$H=!1,$B=0;$B<this._shaderAttributes.length;$B+=8)switch(this._shaderAttributes[$B]){case"POSITION":$M=!0;break;case"NORMAL":$E=!0;break;case"COLOR":$Z=!0;break;case"UV":$i=!0;break;case"UV1":$n=!0;break;case"BLENDWEIGHT":$f=!0;break;case"BLENDINDICES":$d=!0;break;case"TANGENT":$c=!0;break;case"BINORMAL":$H=!0}return $M&&$E&&$Z&&$i&&$n&&$f&&$d&&$c?$I=$$I.vertexDeclaration:$M&&$E&&$Z&&$i&&$n&&$f&&$d?$I=$NI.vertexDeclaration:$M&&$E&&$i&&$n&&$f&&$d&&$c?$I=$oI.vertexDeclaration:$M&&$E&&$i&&$n&&$f&&$d?$I=$zI.vertexDeclaration:$M&&$E&&$Z&&$i&&$f&&$d&&$c?$I=$mI.vertexDeclaration:$M&&$E&&$Z&&$i&&$f&&$d?$I=$OI.vertexDeclaration:$M&&$E&&$c&&$H&&$i&&$f&&$d?$I=$eI.vertexDeclaration:$M&&$E&&$i&&$f&&$d&&$c?$I=$xI.vertexDeclaration:$M&&$E&&$i&&$f&&$d?$I=$CI.vertexDeclaration:$M&&$E&&$Z&&$f&&$d&&$c?$I=$QI.vertexDeclaration:$M&&$E&&$Z&&$f&&$d?$I=$BI.vertexDeclaration:$M&&$E&&$Z&&$i&&$n&&$c?$I=$gI.vertexDeclaration:$M&&$E&&$Z&&$i&&$n?$I=$uI.vertexDeclaration:$M&&$E&&$i&&$n&&$c?$I=$XI.vertexDeclaration:$M&&$E&&$i&&$n?$I=$RI.vertexDeclaration:$M&&$E&&$Z&&$i&&$c?$I=$TI.vertexDeclaration:$M&&$E&&$i&&$c&&$H?$I=$lI.vertexDeclaration:$M&&$E&&$Z&&$i?$I=$VI.vertexDeclaration:$M&&$E&&$i&&$c?$I=$rI.vertexDeclaration:$M&&$E&&$i?$I=$WI.vertexDeclaration:$M&&$E&&$Z&&$c?$I=$tI.vertexDeclaration:$M&&$E&&$Z&&($I=$HI.vertexDeclaration),$I},$t(0,$I,"mesh",function(){return this._mesh}),$$._attrReg=new RegExp("(\\w+)|([:,;])","g"),$$}()),$PI=function(){function $a(){}return $p($a,"laya.d3.loaders.LoadModelV02"),$a.parse=function($I,$M,$E,$Z,$i,$n){$a._mesh=$E,$a._materials=$Z,$a._subMeshes=$i,$a._materialMap=$n,$a._version=$M,$a._readData=$I,$a.READ_DATA(),$a.READ_BLOCK(),$a.READ_STRINGS();for(var $c=0,$f=$a._BLOCK.count;$c<$f;$c++){$a._readData.pos=$a._BLOCK.blockStarts[$c];var $d=$a._readData.getUint16(),$H=$a._strings[$d],$B=$a["READ_"+$H];if(null==$B)throw new Error("model file err,no this function:"+$d+" "+$H);$B.call()}$a._strings.length=0,$a._readData=null,$a._version=null,$a._mesh=null,$a._materials=null,$a._subMeshes=null,$a._materialMap=null},$a._readString=function(){return $a._strings[$a._readData.getUint16()]},$a.READ_DATA=function(){$a._DATA.offset=$a._readData.getUint32(),$a._DATA.size=$a._readData.getUint32()},$a.READ_BLOCK=function(){for(var $I=$a._BLOCK.count=$a._readData.getUint16(),$M=$a._BLOCK.blockStarts=[],$E=$a._BLOCK.blockLengths=[],$Z=0;$Z<$I;$Z++)$M.push($a._readData.getUint32()),$E.push($a._readData.getUint32())},$a.READ_STRINGS=function(){var $I=$a._readData.getUint32(),$M=$a._readData.getUint16(),$E=$a._readData.pos;$a._readData.pos=$I+$a._DATA.offset;for(var $Z=0;$Z<$M;$Z++)$a._strings[$Z]=$a._readData.readUTFString();$a._readData.pos=$E},$a.READ_MATERIAL=function(){$a._readString(),$a._readString();var $I=$a._readString();return""!==$I&&$a._materials.push($N.getRes($a._materialMap[$I])),!0},$a.READ_MESH=function(){$a._readString();var $I,$M=$a._readData.__getBuffer(),$E=0,$Z=$a._readData.getInt16(),$i=$a._DATA.offset;for($E=0;$E<$Z;$E++){var $n=$i+$a._readData.getUint32(),$c=$a._readData.getUint32(),$f=new Float32Array($M.slice($n,$n+$c)),$d=$a._readString().match($a._attrReg),$H=$a._getVertexDeclaration($d),$B=$xM.create($H,4*$f.length/$H.vertexStride,35044,!0);$B.setData($f),$a._mesh._vertexBuffers.push($B)}var $A=$i+$a._readData.getUint32(),$Q=$a._readData.getUint32(),$p=new Uint16Array($M.slice($A,$A+$Q)),$t=$JM.create("ushort",$Q/2,35044,!0);$t.setData($p),$a._mesh._indexBuffer=$t;var $V=$a._mesh._boneNames=[],$u=$a._readData.getUint16();for($V.length=$u,$E=0;$E<$u;$E++)$V[$E]=$a._strings[$a._readData.getUint16()];var $N=$a._readData.getUint32(),$y=$a._readData.getUint32(),$$=(new Float32Array($M.slice($i+$N,$i+$N+$y)),$a._readData.getUint32()),$w=$a._readData.getUint32(),$g=new Float32Array($M.slice($i+$$,$i+$$+$w));for($a._mesh._inverseBindPoses=[],$E=0,$I=$g.length;$E<$I;$E+=16){var $O=new $IM($g[$E+0],$g[$E+1],$g[$E+2],$g[$E+3],$g[$E+4],$g[$E+5],$g[$E+6],$g[$E+7],$g[$E+8],$g[$E+9],$g[$E+10],$g[$E+11],$g[$E+12],$g[$E+13],$g[$E+14],$g[$E+15]);$a._mesh._inverseBindPoses.push($O)}return $a._mesh._skinnedDatas=new Float32Array(16*$g.length),!0},$a.READ_SUBMESH=function(){var $I=$a._readData.__getBuffer(),$M=new $HM($a._mesh),$E=$a._readData.getInt16(),$Z=$a._readData.getUint32(),$i=$a._readData.getUint32();$M._vertexBuffer=$a._mesh._vertexBuffers[$E],$M._vertexStart=$Z,$M._vertexCount=$i;var $n=$a._readData.getUint32(),$c=$a._readData.getUint32(),$f=$a._mesh._indexBuffer;$M._indexBuffer=$f,$M._indexStart=$n,$M._indexCount=$c,$M._indices=new Uint16Array($f.getData().buffer,2*$n,$c);var $d=$a._DATA.offset,$H=$M._subIndexBufferStart,$B=$M._subIndexBufferCount,$A=$M._boneIndicesList,$Q=$a._readData.getUint16();$H.length=$Q,$B.length=$Q,$A.length=$Q;for(var $p=0;$p<$Q;$p++){$H[$p]=$a._readData.getUint32(),$B[$p]=$a._readData.getUint32();var $t=$a._readData.getUint32(),$V=$a._readData.getUint32();$M._boneIndicesList[$p]=new Uint8Array($I.slice($d+$t,$d+$t+$V))}return $a._subMeshes.push($M),!0},$a._getVertexDeclaration=function($I){for(var $M,$E=!1,$Z=!1,$i=!1,$n=!1,$c=!1,$f=!1,$d=!1,$H=!1,$B=!1,$A=0;$A<$I.length;$A++)switch($I[$A]){case"POSITION":$E=!0;break;case"NORMAL":$Z=!0;break;case"COLOR":$i=!0;break;case"UV":$n=!0;break;case"UV1":$c=!0;break;case"BLENDWEIGHT":$d=!0;break;case"BLENDINDICES":$H=!0;break;case"TANGENT":$f=!0;break;case"BINORMAL":$B=!0}return $E&&$Z&&$i&&$n&&$c&&$d&&$H&&$f?$M=$$I.vertexDeclaration:$E&&$Z&&$i&&$n&&$c&&$d&&$H?$M=$NI.vertexDeclaration:$E&&$Z&&$n&&$c&&$d&&$H&&$f?$M=$oI.vertexDeclaration:$E&&$Z&&$n&&$c&&$d&&$H?$M=$zI.vertexDeclaration:$E&&$Z&&$i&&$n&&$d&&$H&&$f?$M=$mI.vertexDeclaration:$E&&$Z&&$i&&$n&&$d&&$H?$M=$OI.vertexDeclaration:$E&&$Z&&$n&&$d&&$H&&$f?$M=$xI.vertexDeclaration:$E&&$Z&&$n&&$d&&$H?$M=$CI.vertexDeclaration:$E&&$Z&&$i&&$d&&$H&&$f?$M=$QI.vertexDeclaration:$E&&$Z&&$i&&$d&&$H?$M=$BI.vertexDeclaration:$E&&$Z&&$i&&$n&&$c&&$f?$M=$gI.vertexDeclaration:$E&&$Z&&$i&&$n&&$c?$M=$uI.vertexDeclaration:$E&&$Z&&$n&&$c&&$f?$M=$XI.vertexDeclaration:$E&&$Z&&$n&&$c?$M=$RI.vertexDeclaration:$E&&$Z&&$i&&$n&&$f?$M=$TI.vertexDeclaration:$E&&$Z&&$n&&$f&&$B?$M=$lI.vertexDeclaration:$E&&$Z&&$i&&$n?$M=$VI.vertexDeclaration:$E&&$Z&&$n&&$f?$M=$rI.vertexDeclaration:$E&&$Z&&$n?$M=$WI.vertexDeclaration:$E&&$Z&&$i&&$f?$M=$tI.vertexDeclaration:$E&&$Z&&$i&&($M=$HI.vertexDeclaration),$M},$a._attrReg=new RegExp("(\\w+)|([:,;])","g"),$a._strings=[],$a._readData=null,$a._version=null,$a._mesh=null,$a._materials=null,$a._subMeshes=null,$a._materialMap=null,$A($a,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$a}(),$DI=function(){function $O(){}return $p($O,"laya.d3.loaders.LoadModelV03"),$O.parse=function($I,$M,$E,$Z,$i){$O._mesh=$E,$O._subMeshes=$Z,$O._materialMap=$i,$O._version=$M,$O._readData=$I,$O.READ_DATA(),$O.READ_BLOCK(),$O.READ_STRINGS();for(var $n=0,$c=$O._BLOCK.count;$n<$c;$n++){$O._readData.pos=$O._BLOCK.blockStarts[$n];var $f=$O._readData.getUint16(),$d=$O._strings[$f],$H=$O["READ_"+$d];if(null==$H)throw new Error("model file err,no this function:"+$f+" "+$d);$H.call()}$O._strings.length=0,$O._readData=null,$O._version=null,$O._mesh=null,$O._subMeshes=null,$O._materialMap=null},$O._readString=function(){return $O._strings[$O._readData.getUint16()]},$O.READ_DATA=function(){$O._DATA.offset=$O._readData.getUint32(),$O._DATA.size=$O._readData.getUint32()},$O.READ_BLOCK=function(){for(var $I=$O._BLOCK.count=$O._readData.getUint16(),$M=$O._BLOCK.blockStarts=[],$E=$O._BLOCK.blockLengths=[],$Z=0;$Z<$I;$Z++)$M.push($O._readData.getUint32()),$E.push($O._readData.getUint32())},$O.READ_STRINGS=function(){var $I=$O._readData.getUint32(),$M=$O._readData.getUint16(),$E=$O._readData.pos;$O._readData.pos=$I+$O._DATA.offset;for(var $Z=0;$Z<$M;$Z++)$O._strings[$Z]=$O._readData.readUTFString();$O._readData.pos=$E},$O.READ_MESH=function(){var $I,$M=$O._readString(),$E=$O._readData.__getBuffer(),$Z=0,$i=$O._readData.getInt16(),$n=$O._DATA.offset;for($Z=0;$Z<$i;$Z++){var $c,$f=$n+$O._readData.getUint32(),$d=$O._readData.getUint32(),$H=new Float32Array($E.slice($f,$f+$d)),$B=$O._readString();switch($O._version){case"LAYAMODEL:03":$c=$O._vertexDeclarationMap_Discard[$B];break;case"LAYAMODEL:0301":$c=$O._vertexDeclarationMap[$B];break;default:throw new Error("LoadModelV03: unknown version.")}if(!$c)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+$O._version+"  bufferAttribute="+$B+"  name="+$M+"  url="+($O._mesh?$O._mesh.url:"null"));var $A=$xM.create($c,4*$H.length/$c.vertexStride,35044,!0,$O._mesh._url+"_"+$Z);$A.setData($H),$O._mesh._vertexBuffers.push($A)}var $Q=$n+$O._readData.getUint32(),$p=$O._readData.getUint32(),$t=new Uint16Array($E.slice($Q,$Q+$p)),$V=$JM.create("ushort",$p/2,35044,!0,$O._mesh._url);$V.setData($t),$O._mesh._indexBuffer=$V;var $u=$O._mesh._boneNames=[],$N=$O._readData.getUint16();for($u.length=$N,$Z=0;$Z<$N;$Z++)$u[$Z]=$O._strings[$O._readData.getUint16()];$O._readData.pos+=8;var $y=$O._readData.getUint32(),$$=$O._readData.getUint32(),$w=new Float32Array($E.slice($n+$y,$n+$y+$$));for($O._mesh._inverseBindPoses=[],$Z=0,$I=$w.length;$Z<$I;$Z+=16){var $g=new $IM($w[$Z+0],$w[$Z+1],$w[$Z+2],$w[$Z+3],$w[$Z+4],$w[$Z+5],$w[$Z+6],$w[$Z+7],$w[$Z+8],$w[$Z+9],$w[$Z+10],$w[$Z+11],$w[$Z+12],$w[$Z+13],$w[$Z+14],$w[$Z+15]);$O._mesh._inverseBindPoses.push($g)}return $O._mesh._skinnedDatas=new Float32Array(16*$w.length),!0},$O.READ_SUBMESH=function(){var $I=$O._readData.__getBuffer(),$M=new $HM($O._mesh),$E=$O._readData.getInt16(),$Z=$O._readData.getUint32(),$i=$O._readData.getUint32();$M._vertexBuffer=$O._mesh._vertexBuffers[$E],$M._vertexStart=$Z,$M._vertexCount=$i;var $n=$O._readData.getUint32(),$c=$O._readData.getUint32(),$f=$O._mesh._indexBuffer;$M._indexBuffer=$f,$M._indexStart=$n,$M._indexCount=$c,$M._indices=new Uint16Array($f.getData().buffer,2*$n,$c);var $d=$O._DATA.offset,$H=$M._subIndexBufferStart,$B=$M._subIndexBufferCount,$A=$M._boneIndicesList,$Q=$O._readData.getUint16();$H.length=$Q,$B.length=$Q,$A.length=$Q;for(var $p=0;$p<$Q;$p++){$H[$p]=$O._readData.getUint32(),$B[$p]=$O._readData.getUint32();var $t=$O._readData.getUint32(),$V=$O._readData.getUint32();$A[$p]=new Uint8Array($I.slice($d+$t,$d+$t+$V))}return $O._subMeshes.push($M),!0},$O._strings=[],$O._readData=null,$O._version=null,$O._mesh=null,$O._subMeshes=null,$O._materialMap=null,$A($O,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$$I.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$NI.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$FI.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$oI.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$zI.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$mI.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$OI.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$xI.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$CI.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$QI.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$BI.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$gI.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$uI.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$XI.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$RI.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$TI.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$lI.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$VI.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$rI.vertexDeclaration,"POSITION,NORMAL,UV":$WI.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$tI.vertexDeclaration,"POSITION,NORMAL,COLOR":$HI.vertexDeclaration,"POSITION,NORMAL,TANGENT":$vI.vertexDeclaration,"POSITION,NORMAL":$dI.vertexDeclaration,"POSITION,UV":$_I.vertexDeclaration,POSITION:$fI.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$yI.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":$NI.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":$FI.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":$LI.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":$zI.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$aI.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":$OI.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":$JI.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":$CI.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":$AI.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":$BI.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":$wI.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":$uI.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":$SI.vertexDeclaration,"POSITION,NORMAL,UV,UV1":$RI.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":$jI.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":$lI.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":$VI.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":$kI.vertexDeclaration,"POSITION,NORMAL,UV":$WI.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":$pI.vertexDeclaration,"POSITION,NORMAL,COLOR":$HI.vertexDeclaration,"POSITION,NORMAL,TANGENT":$qI.vertexDeclaration,"POSITION,NORMAL":$dI.vertexDeclaration,"POSITION,UV":$_I.vertexDeclaration,POSITION:$fI.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$O}(),$GI=function(){function $f(){}return $p($f,"laya.d3.loaders.MeshReader"),$f.read=function($I,$M,$E,$Z,$i){var $n=new $O($I);$n.pos=0;var $c=$n.readUTFString();switch($c){case"LAYAMODEL:01":case"LAYASKINANI:01":$f._readVersion01($n,$c,$M,$E,$Z,$i);break;case"LAYAMODEL:02":$PI.parse($n,$c,$M,$E,$Z,$i);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":$DI.parse($n,$c,$M,$Z,$i);break;default:throw new Error("MeshReader: unknown mesh version.")}$M._setSubMeshes($Z)},$f._readVersion01=function($I,$M,$E,$Z,$i,$n){new $hI($I,$M,$E,$Z,$i,$n)},$f}(),$YI=function(){function $I($I,$M){this.min=null,this.max=null,this.min=$I,this.max=$M}$p($I,"laya.d3.math.BoundBox");var $M=$I.prototype;return $g.imps($M,{"laya.d3.core.IClone":!0}),$M.getCorners=function($I){$I.length=8;var $M=this.min.elements,$E=this.max.elements,$Z=$M[0],$i=$M[1],$n=$M[2],$c=$E[0],$f=$E[1],$d=$E[2];$I[0]=new $cM($Z,$f,$d),$I[1]=new $cM($c,$f,$d),$I[2]=new $cM($c,$i,$d),$I[3]=new $cM($Z,$i,$d),$I[4]=new $cM($Z,$f,$n),$I[5]=new $cM($c,$f,$n),$I[6]=new $cM($c,$i,$n),$I[7]=new $cM($Z,$i,$n)},$M.toDefault=function(){this.min.toDefault(),this.max.toDefault()},$M.cloneTo=function($I){var $M=$I;this.min.cloneTo($M.min),this.max.cloneTo($M.max)},$M.clone=function(){var $I=new this.constructor(new $cM,new $cM);return this.cloneTo($I),$I},$I.createfromPoints=function($I,$M){if(null==$I)throw new Error("points");var $E=$M.min,$Z=$M.max,$i=$E.elements;$i[0]=Number.MAX_VALUE,$i[1]=Number.MAX_VALUE,$i[2]=Number.MAX_VALUE;var $n=$Z.elements;$n[0]=-Number.MAX_VALUE,$n[1]=-Number.MAX_VALUE,$n[2]=-Number.MAX_VALUE;for(var $c=0,$f=$I.length;$c<$f;++$c)$cM.min($E,$I[$c],$E),$cM.max($Z,$I[$c],$Z)},$I.merge=function($I,$M,$E){$cM.min($I.min,$M.min,$E.min),$cM.max($I.max,$M.max,$E.max)},$I}(),$KI=function(){function $H($I){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=$I,this._near=new $MM(new $cM),this._far=new $MM(new $cM),this._left=new $MM(new $cM),this._right=new $MM(new $cM),this._top=new $MM(new $cM),this._bottom=new $MM(new $cM),$H._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}$p($H,"laya.d3.math.BoundFrustum");var $I=$H.prototype;return $I.equalsBoundFrustum=function($I){return this._matrix.equalsOtherMatrix($I.matrix)},$I.equalsObj=function($I){if($I instanceof laya.d3.math.BoundFrustum){var $M=$I;return this.equalsBoundFrustum($M)}return!1},$I.getPlane=function($I){switch($I){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},$I.getCorners=function($I){$H._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo($I[0]),$H._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo($I[1]),$H._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo($I[2]),$H._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo($I[3]),$H._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo($I[4]),$H._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo($I[5]),$H._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo($I[6]),$H._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo($I[7])},$I.containsPoint=function($I){for(var $M=$MM.PlaneIntersectionType_Front,$E=$MM.PlaneIntersectionType_Front,$Z=0;$Z<6;$Z++){switch($Z){case 0:$E=Collision.intersectsPlaneAndPoint(this._near,$I);break;case 1:$E=Collision.intersectsPlaneAndPoint(this._far,$I);break;case 2:$E=Collision.intersectsPlaneAndPoint(this._left,$I);break;case 3:$E=Collision.intersectsPlaneAndPoint(this._right,$I);break;case 4:$E=Collision.intersectsPlaneAndPoint(this._top,$I);break;case 5:$E=Collision.intersectsPlaneAndPoint(this._bottom,$I)}switch($E){case $MM.PlaneIntersectionType_Back:return 0;case $MM.PlaneIntersectionType_Intersecting:$M=$MM.PlaneIntersectionType_Intersecting}}switch($M){case $MM.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$I.containsBoundBox=function($I){for(var $M,$E=$H._tempV30,$Z=$H._tempV31,$i=1,$n=0;$n<6;$n++){if($M=this.getPlane($n),this._getBoxToPlanePVertexNVertex($I,$M.normal,$E,$Z),Collision.intersectsPlaneAndPoint($M,$E)===$MM.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint($M,$Z)===$MM.PlaneIntersectionType_Back&&($i=2)}return $i},$I.containsBoundSphere=function($I){for(var $M=$MM.PlaneIntersectionType_Front,$E=$MM.PlaneIntersectionType_Front,$Z=0;$Z<6;$Z++){switch($Z){case 0:$E=Collision.intersectsPlaneAndSphere(this._near,$I);break;case 1:$E=Collision.intersectsPlaneAndSphere(this._far,$I);break;case 2:$E=Collision.intersectsPlaneAndSphere(this._left,$I);break;case 3:$E=Collision.intersectsPlaneAndSphere(this._right,$I);break;case 4:$E=Collision.intersectsPlaneAndSphere(this._top,$I);break;case 5:$E=Collision.intersectsPlaneAndSphere(this._bottom,$I)}switch($E){case $MM.PlaneIntersectionType_Back:return 0;case $MM.PlaneIntersectionType_Intersecting:$M=$MM.PlaneIntersectionType_Intersecting}}switch($M){case $MM.PlaneIntersectionType_Intersecting:return 2;default:return 1}},$I._getBoxToPlanePVertexNVertex=function($I,$M,$E,$Z){var $i=$I.min,$n=$i.elements,$c=$I.max,$f=$c.elements,$d=$M.elements,$H=$d[0],$B=$d[1],$A=$d[2];$i.cloneTo($E);var $Q=$E.elements;0<=$H&&($Q[0]=$f[0]),0<=$B&&($Q[1]=$f[1]),0<=$A&&($Q[2]=$f[2]),$c.cloneTo($Z);var $p=$Z.elements;0<=$H&&($p[0]=$n[0]),0<=$B&&($p[1]=$n[1]),0<=$A&&($p[2]=$n[2])},$t(0,$I,"top",function(){return this._top}),$t(0,$I,"matrix",function(){return this._matrix},function($I){this._matrix=$I,$H._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),$t(0,$I,"near",function(){return this._near}),$t(0,$I,"far",function(){return this._far}),$t(0,$I,"left",function(){return this._left}),$t(0,$I,"right",function(){return this._right}),$t(0,$I,"bottom",function(){return this._bottom}),$H._getPlanesFromMatrix=function($I,$M,$E,$Z,$i,$n,$c){var $f=$I.elements,$d=$f[0],$H=$f[1],$B=$f[2],$A=$f[3],$Q=$f[4],$p=$f[5],$t=$f[6],$V=$f[7],$u=$f[8],$N=$f[9],$y=$f[10],$$=$f[11],$w=$f[12],$g=$f[13],$O=$f[14],$a=$f[15],$m=$M.normal.elements;$m[0]=$A+$B,$m[1]=$V+$t,$m[2]=$$+$y,$M.distance=$a+$O,$M.normalize();var $j=$E.normal.elements;$j[0]=$A-$B,$j[1]=$V-$t,$j[2]=$$-$y,$E.distance=$a-$O,$E.normalize();var $T=$Z.normal.elements;$T[0]=$A+$d,$T[1]=$V+$Q,$T[2]=$$+$u,$Z.distance=$a+$w,$Z.normalize();var $q=$i.normal.elements;$q[0]=$A-$d,$q[1]=$V-$Q,$q[2]=$$-$u,$i.distance=$a-$w,$i.normalize();var $v=$n.normal.elements;$v[0]=$A-$H,$v[1]=$V-$p,$v[2]=$$-$N,$n.distance=$a-$g,$n.normalize();var $W=$c.normal.elements;$W[0]=$A+$H,$W[1]=$V+$p,$W[2]=$$+$N,$c.distance=$a+$g,$c.normalize()},$H._get3PlaneInterPoint=function($I,$M,$E){var $Z=$I.normal,$i=$M.normal,$n=$E.normal;$cM.cross($i,$n,$H._tempV30),$cM.cross($n,$Z,$H._tempV31),$cM.cross($Z,$i,$H._tempV32);var $c=$cM.dot($Z,$H._tempV30),$f=$cM.dot($i,$H._tempV31),$d=$cM.dot($n,$H._tempV32);return $cM.scale($H._tempV30,-$I.distance/$c,$H._tempV33),$cM.scale($H._tempV31,-$M.distance/$f,$H._tempV34),$cM.scale($H._tempV32,-$E.distance/$d,$H._tempV35),$cM.add($H._tempV33,$H._tempV34,$H._tempV36),$cM.add($H._tempV35,$H._tempV36,$H._tempV37),$H._tempV37},$A($H,["_tempV30",function(){return this._tempV30=new $cM},"_tempV31",function(){return this._tempV31=new $cM},"_tempV32",function(){return this._tempV32=new $cM},"_tempV33",function(){return this._tempV33=new $cM},"_tempV34",function(){return this._tempV34=new $cM},"_tempV35",function(){return this._tempV35=new $cM},"_tempV36",function(){return this._tempV36=new $cM},"_tempV37",function(){return this._tempV37=new $cM}]),$H}(),$sI=function(){function $B($I,$M){this.center=null,this.radius=NaN,this.center=$I,this.radius=$M}$p($B,"laya.d3.math.BoundSphere");var $I=$B.prototype;return $g.imps($I,{"laya.d3.core.IClone":!0}),$I.toDefault=function(){this.center.toDefault(),this.radius=0},$I.intersectsRayDistance=function($I){return Collision.intersectsRayAndSphereRD($I,this)},$I.intersectsRayPoint=function($I,$M){return Collision.intersectsRayAndSphereRP($I,this,$M)},$I.cloneTo=function($I){var $M=$I;this.center.cloneTo($M.center),$M.radius=this.radius},$I.clone=function(){var $I=new this.constructor(new $cM,new $cM);return this.cloneTo($I),$I},$B.createFromSubPoints=function($I,$M,$E,$Z){if(null==$I)throw new Error("points");if($M<0||$M>=$I.length)throw new Error("start"+$M+"Must be in the range [0, "+($I.length-1)+"]");if($E<0||$M+$E>$I.length)throw new Error("count"+$E+"Must be in the range <= "+$I.length+"}");var $i=$M+$E,$n=$B._tempVector3;$n.elements[0]=0,$n.elements[1]=0,$n.elements[2]=0;for(var $c=$M;$c<$i;++$c)$cM.add($I[$c],$n,$n);var $f=$Z.center;$cM.scale($n,1/$E,$f);var $d=0;for($c=$M;$c<$i;++$c){var $H=$cM.distanceSquared($f,$I[$c]);$d<$H&&($d=$H)}$Z.radius=Math.sqrt($d)},$B.createfromPoints=function($I,$M){if(null==$I)throw new Error("points");$B.createFromSubPoints($I,0,$I.length,$M)},$A($B,["_tempVector3",function(){return this._tempVector3=new $cM}]),$B}(),$bI=(function(){function $I(){}$p($I,"laya.d3.math.ContainmentType"),$I.Disjoint=0,$I.Contains=1,$I.Intersects=2}(),function(){function $E(){}return $p($E,"laya.d3.math.MathUtils3D"),$E.isZero=function($I){return Math.abs($I)<$E.zeroTolerance},$E.nearEqual=function($I,$M){return!!$E.isZero($I-$M)},$E.fastInvSqrt=function($I){return $E.isZero($I)?$I:1/Math.sqrt($I)},$A($E,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),$E}()),$UI=function(){function $d(){var $I=this.elements=new Float32Array(9);$I[0]=1,$I[1]=0,$I[2]=0,$I[3]=0,$I[4]=1,$I[5]=0,$I[6]=0,$I[7]=0,$I[8]=1}$p($d,"laya.d3.math.Matrix3x3");var $I=$d.prototype;return $g.imps($I,{"laya.d3.core.IClone":!0}),$I.determinant=function(){var $I=this.elements,$M=$I[0],$E=$I[1],$Z=$I[2],$i=$I[3],$n=$I[4],$c=$I[5],$f=$I[6],$d=$I[7],$H=$I[8];return $M*($H*$n-$c*$d)+$E*(-$H*$i+$c*$f)+$Z*($d*$i-$n*$f)},$I.translate=function($I,$M){var $E=$M.elements,$Z=this.elements,$i=$I.elements,$n=$Z[0],$c=$Z[1],$f=$Z[2],$d=$Z[3],$H=$Z[4],$B=$Z[5],$A=$Z[6],$Q=$Z[7],$p=$Z[8],$t=$i[0],$V=$i[1];$E[0]=$n,$E[1]=$c,$E[2]=$f,$E[3]=$d,$E[4]=$H,$E[5]=$B,$E[6]=$t*$n+$V*$d+$A,$E[7]=$t*$c+$V*$H+$Q,$E[8]=$t*$f+$V*$B+$p},$I.rotate=function($I,$M){var $E=$M.elements,$Z=this.elements,$i=$Z[0],$n=$Z[1],$c=$Z[2],$f=$Z[3],$d=$Z[4],$H=$Z[5],$B=$Z[6],$A=$Z[7],$Q=$Z[8],$p=Math.sin($I),$t=Math.cos($I);$E[0]=$t*$i+$p*$f,$E[1]=$t*$n+$p*$d,$E[2]=$t*$c+$p*$H,$E[3]=$t*$f-$p*$i,$E[4]=$t*$d-$p*$n,$E[5]=$t*$H-$p*$c,$E[6]=$B,$E[7]=$A,$E[8]=$Q},$I.scale=function($I,$M){var $E=$M.elements,$Z=this.elements,$i=$I.elements,$n=$i[0],$c=$i[1];$E[0]=$n*$Z[0],$E[1]=$n*$Z[1],$E[2]=$n*$Z[2],$E[3]=$c*$Z[3],$E[4]=$c*$Z[4],$E[5]=$c*$Z[5],$E[6]=$Z[6],$E[7]=$Z[7],$E[8]=$Z[8]},$I.invert=function($I){var $M=$I.elements,$E=this.elements,$Z=$E[0],$i=$E[1],$n=$E[2],$c=$E[3],$f=$E[4],$d=$E[5],$H=$E[6],$B=$E[7],$A=$E[8],$Q=$A*$f-$d*$B,$p=-$A*$c+$d*$H,$t=$B*$c-$f*$H,$V=$Z*$Q+$i*$p+$n*$t;$V||($I=null),$V=1/$V,$M[0]=$Q*$V,$M[1]=(-$A*$i+$n*$B)*$V,$M[2]=($d*$i-$n*$f)*$V,$M[3]=$p*$V,$M[4]=($A*$Z-$n*$H)*$V,$M[5]=(-$d*$Z+$n*$c)*$V,$M[6]=$t*$V,$M[7]=(-$B*$Z+$i*$H)*$V,$M[8]=($f*$Z-$i*$c)*$V},$I.transpose=function($I){var $M=$I.elements,$E=this.elements;if($I===this){var $Z=$E[1],$i=$E[2],$n=$E[5];$M[1]=$E[3],$M[2]=$E[6],$M[3]=$Z,$M[5]=$E[7],$M[6]=$i,$M[7]=$n}else $M[0]=$E[0],$M[1]=$E[3],$M[2]=$E[6],$M[3]=$E[1],$M[4]=$E[4],$M[5]=$E[7],$M[6]=$E[2],$M[7]=$E[5],$M[8]=$E[8]},$I.identity=function(){var $I=this.elements;$I[0]=1,$I[1]=0,$I[2]=0,$I[3]=0,$I[4]=1,$I[5]=0,$I[6]=0,$I[7]=0,$I[8]=1},$I.cloneTo=function($I){var $M,$E,$Z;if(($E=this.elements)!==($Z=$I.elements))for($M=0;$M<9;++$M)$Z[$M]=$E[$M]},$I.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$d.createFromTranslation=function($I,$M){$M.elements;var $E=$I.elements;$M[0]=1,$M[1]=0,$M[2]=0,$M[3]=0,$M[4]=1,$M[5]=0,$M[6]=$E[0],$M[7]=$E[1],$M[8]=1},$d.createFromRotation=function($I,$M){var $E=$M.elements,$Z=Math.sin($I),$i=Math.cos($I);$E[0]=$i,$E[1]=$Z,$E[2]=0,$E[3]=-$Z,$E[4]=$i,$E[5]=0,$E[6]=0,$E[7]=0,$E[8]=1},$d.createFromScaling=function($I,$M){var $E=$M.elements,$Z=$I.elements;$E[0]=$Z[0],$E[1]=0,$E[2]=0,$E[3]=0,$E[4]=$Z[1],$E[5]=0,$E[6]=0,$E[7]=0,$E[8]=1},$d.createFromMatrix4x4=function($I,$M){$M[0]=$I[0],$M[1]=$I[1],$M[2]=$I[2],$M[3]=$I[4],$M[4]=$I[5],$M[5]=$I[6],$M[6]=$I[8],$M[7]=$I[9],$M[8]=$I[10]},$d.multiply=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M.elements,$c=$i[0],$f=$i[1],$d=$i[2],$H=$i[3],$B=$i[4],$A=$i[5],$Q=$i[6],$p=$i[7],$t=$i[8],$V=$n[0],$u=$n[1],$N=$n[2],$y=$n[3],$$=$n[4],$w=$n[5],$g=$n[6],$O=$n[7],$a=$n[8];$Z[0]=$V*$c+$u*$H+$N*$Q,$Z[1]=$V*$f+$u*$B+$N*$p,$Z[2]=$V*$d+$u*$A+$N*$t,$Z[3]=$y*$c+$$*$H+$w*$Q,$Z[4]=$y*$f+$$*$B+$w*$p,$Z[5]=$y*$d+$$*$A+$w*$t,$Z[6]=$g*$c+$O*$H+$a*$Q,$Z[7]=$g*$f+$O*$B+$a*$p,$Z[8]=$g*$d+$O*$A+$a*$t},$d.lookAt=function($I,$M,$E,$Z){$cM.subtract($I,$M,$d._tempV30),$cM.normalize($d._tempV30,$d._tempV30),$cM.cross($E,$d._tempV30,$d._tempV31),$cM.normalize($d._tempV31,$d._tempV31),$cM.cross($d._tempV30,$d._tempV31,$d._tempV32);var $i=$d._tempV30.elements,$n=$d._tempV31.elements,$c=$d._tempV32.elements,$f=$Z.elements;$f[0]=$n[0],$f[3]=$n[1],$f[6]=$n[2],$f[1]=$c[0],$f[4]=$c[1],$f[7]=$c[2],$f[2]=$i[0],$f[5]=$i[1],$f[8]=$i[2]},$d.DEFAULT=new $d,$A($d,["_tempV30",function(){return this._tempV30=new $cM},"_tempV31",function(){return this._tempV31=new $cM},"_tempV32",function(){return this._tempV32=new $cM}]),$d}(),$IM=function(){function $j($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B,$A,$Q,$p,$t,$V){void 0===$I&&($I=1),void 0===$M&&($M=0),void 0===$E&&($E=0),void 0===$Z&&($Z=0),void 0===$i&&($i=0),void 0===$n&&($n=1),void 0===$c&&($c=0),void 0===$f&&($f=0),void 0===$d&&($d=0),void 0===$H&&($H=0),void 0===$B&&($B=1),void 0===$A&&($A=0),void 0===$Q&&($Q=0),void 0===$p&&($p=0),void 0===$t&&($t=0),void 0===$V&&($V=1);var $u=this.elements=new Float32Array(16);$u[0]=$I,$u[1]=$M,$u[2]=$E,$u[3]=$Z,$u[4]=$i,$u[5]=$n,$u[6]=$c,$u[7]=$f,$u[8]=$d,$u[9]=$H,$u[10]=$B,$u[11]=$A,$u[12]=$Q,$u[13]=$p,$u[14]=$t,$u[15]=$V}$p($j,"laya.d3.math.Matrix4x4");var $I=$j.prototype;return $g.imps($I,{"laya.d3.core.IClone":!0}),$I.getElementByRowColumn=function($I,$M){if($I<0||3<$I)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($M<0||3<$M)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*$I+$M]},$I.setElementByRowColumn=function($I,$M,$E){if($I<0||3<$I)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if($M<0||3<$M)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*$I+$M]=$E},$I.equalsOtherMatrix=function($I){var $M=this.elements,$E=$I.elements;return $bI.nearEqual($M[0],$E[0])&&$bI.nearEqual($M[1],$E[1])&&$bI.nearEqual($M[2],$E[2])&&$bI.nearEqual($M[3],$E[3])&&$bI.nearEqual($M[4],$E[4])&&$bI.nearEqual($M[5],$E[5])&&$bI.nearEqual($M[6],$E[6])&&$bI.nearEqual($M[7],$E[7])&&$bI.nearEqual($M[8],$E[8])&&$bI.nearEqual($M[9],$E[9])&&$bI.nearEqual($M[10],$E[10])&&$bI.nearEqual($M[11],$E[11])&&$bI.nearEqual($M[12],$E[12])&&$bI.nearEqual($M[13],$E[13])&&$bI.nearEqual($M[14],$E[14])&&$bI.nearEqual($M[15],$E[15])},$I.decomposeTransRotScale=function($I,$M,$E){var $Z=$j._tempMatrix4x4;return this.decomposeTransRotMatScale($I,$Z,$E)?($EM.createFromMatrix4x4($Z,$M),!0):($M.identity(),!1)},$I.decomposeTransRotMatScale=function($I,$M,$E){var $Z=this.elements,$i=$I.elements,$n=$M.elements,$c=$E.elements;$i[0]=$Z[12],$i[1]=$Z[13],$i[2]=$Z[14];var $f=$Z[0],$d=$Z[1],$H=$Z[2],$B=$Z[4],$A=$Z[5],$Q=$Z[6],$p=$Z[8],$t=$Z[9],$V=$Z[10],$u=$c[0]=Math.sqrt($f*$f+$d*$d+$H*$H),$N=$c[1]=Math.sqrt($B*$B+$A*$A+$Q*$Q),$y=$c[2]=Math.sqrt($p*$p+$t*$t+$V*$V);if($bI.isZero($u)||$bI.isZero($N)||$bI.isZero($y))return $n[1]=$n[2]=$n[3]=$n[4]=$n[6]=$n[7]=$n[8]=$n[9]=$n[11]=$n[12]=$n[13]=$n[14]=0,$n[0]=$n[5]=$n[10]=$n[15]=1,!1;var $$=$j._tempVector0,$w=$$.elements;$w[0]=$p/$y,$w[1]=$t/$y,$w[2]=$V/$y;var $g=$j._tempVector1,$O=$g.elements;$O[0]=$f/$u,$O[1]=$d/$u,$O[2]=$H/$u;var $a=$j._tempVector2;$cM.cross($$,$g,$a);var $m=$j._tempVector1;return $cM.cross($a,$$,$m),$n[3]=$n[7]=$n[11]=$n[12]=$n[13]=$n[14]=0,$n[15]=1,$n[0]=$m.x,$n[1]=$m.y,$n[2]=$m.z,$n[4]=$a.x,$n[5]=$a.y,$n[6]=$a.z,$n[8]=$$.x,$n[9]=$$.y,$n[10]=$$.z,$n[0]*$f+$n[1]*$d+$n[2]*$H<0&&($c[0]=-$u),$n[4]*$B+$n[5]*$A+$n[6]*$Q<0&&($c[1]=-$N),$n[8]*$p+$n[9]*$t+$n[10]*$V<0&&($c[2]=-$y),!0},$I.decomposeYawPitchRoll=function($I){var $M=$I.elements,$E=Math.asin(-this.elements[9]);$M[1]=$E,Math.cos($E)>$bI.zeroTolerance?($M[2]=Math.atan2(this.elements[1],this.elements[5]),$M[0]=Math.atan2(this.elements[8],this.elements[10])):($M[2]=Math.atan2(-this.elements[4],this.elements[0]),$M[0]=0)},$I.normalize=function(){var $I=this.elements,$M=$I[0],$E=$I[1],$Z=$I[2],$i=Math.sqrt($M*$M+$E*$E+$Z*$Z);if(!$i)return $I[0]=0,$I[1]=0,void($I[2]=0);1!=$i&&($i=1/$i,$I[0]=$M*$i,$I[1]=$E*$i,$I[2]=$Z*$i)},$I.transpose=function(){var $I,$M;return $M=($I=this.elements)[1],$I[1]=$I[4],$I[4]=$M,$M=$I[2],$I[2]=$I[8],$I[8]=$M,$M=$I[3],$I[3]=$I[12],$I[12]=$M,$M=$I[6],$I[6]=$I[9],$I[9]=$M,$M=$I[7],$I[7]=$I[13],$I[13]=$M,$M=$I[11],$I[11]=$I[14],$I[14]=$M,this},$I.invert=function($I){var $M=this.elements,$E=$I.elements,$Z=$M[0],$i=$M[1],$n=$M[2],$c=$M[3],$f=$M[4],$d=$M[5],$H=$M[6],$B=$M[7],$A=$M[8],$Q=$M[9],$p=$M[10],$t=$M[11],$V=$M[12],$u=$M[13],$N=$M[14],$y=$M[15],$$=$Z*$d-$i*$f,$w=$Z*$H-$n*$f,$g=$Z*$B-$c*$f,$O=$i*$H-$n*$d,$a=$i*$B-$c*$d,$m=$n*$B-$c*$H,$j=$A*$u-$Q*$V,$T=$A*$N-$p*$V,$q=$A*$y-$t*$V,$v=$Q*$N-$p*$u,$W=$Q*$y-$t*$u,$R=$p*$y-$t*$N,$z=$$*$R-$w*$W+$g*$v+$O*$q-$a*$T+$m*$j;0!==Math.abs($z)&&($z=1/$z,$E[0]=($d*$R-$H*$W+$B*$v)*$z,$E[1]=($n*$W-$i*$R-$c*$v)*$z,$E[2]=($u*$m-$N*$a+$y*$O)*$z,$E[3]=($p*$a-$Q*$m-$t*$O)*$z,$E[4]=($H*$q-$f*$R-$B*$T)*$z,$E[5]=($Z*$R-$n*$q+$c*$T)*$z,$E[6]=($N*$g-$V*$m-$y*$w)*$z,$E[7]=($A*$m-$p*$g+$t*$w)*$z,$E[8]=($f*$W-$d*$q+$B*$j)*$z,$E[9]=($i*$q-$Z*$W-$c*$j)*$z,$E[10]=($V*$a-$u*$g+$y*$$)*$z,$E[11]=($Q*$g-$A*$a-$t*$$)*$z,$E[12]=($d*$T-$f*$v-$H*$j)*$z,$E[13]=($Z*$v-$i*$T+$n*$j)*$z,$E[14]=($u*$w-$V*$O-$N*$$)*$z,$E[15]=($A*$O-$Q*$w+$p*$$)*$z)},$I.identity=function(){var $I=this.elements;$I[1]=$I[2]=$I[3]=$I[4]=$I[6]=$I[7]=$I[8]=$I[9]=$I[11]=$I[12]=$I[13]=$I[14]=0,$I[0]=$I[5]=$I[10]=$I[15]=1},$I.cloneTo=function($I){var $M,$E,$Z;if(($E=this.elements)!==($Z=$I.elements))for($M=0;$M<16;++$M)$Z[$M]=$E[$M]},$I.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$I.getTranslationVector=function($I){var $M=this.elements,$E=$I.elements;$E[0]=$M[12],$E[1]=$M[13],$E[2]=$M[14]},$I.setTranslationVector=function($I){var $M=this.elements,$E=$I.elements;$M[12]=$E[0],$M[13]=$E[1],$M[14]=$E[2]},$I.getForward=function($I){var $M=this.elements,$E=$I.elements;$E[0]=-$M[8],$E[1]=-$M[9],$E[2]=-$M[10]},$I.setForward=function($I){var $M=this.elements,$E=$I.elements;$M[8]=-$E[0],$M[9]=-$E[1],$M[10]=-$E[2]},$j.createRotationX=function($I,$M){var $E=$M.elements,$Z=Math.sin($I),$i=Math.cos($I);$E[1]=$E[2]=$E[3]=$E[4]=$E[7]=$E[8]=$E[11]=$E[12]=$E[13]=$E[14]=0,$E[0]=$E[15]=1,$E[5]=$E[10]=$i,$E[6]=$Z,$E[9]=-$Z},$j.createRotationY=function($I,$M){var $E=$M.elements,$Z=Math.sin($I),$i=Math.cos($I);$E[1]=$E[3]=$E[4]=$E[6]=$E[7]=$E[9]=$E[11]=$E[12]=$E[13]=$E[14]=0,$E[5]=$E[15]=1,$E[0]=$E[10]=$i,$E[2]=-$Z,$E[8]=$Z},$j.createRotationZ=function($I,$M){var $E=$M.elements,$Z=Math.sin($I),$i=Math.cos($I);$E[2]=$E[3]=$E[6]=$E[7]=$E[8]=$E[9]=$E[11]=$E[12]=$E[13]=$E[14]=0,$E[10]=$E[15]=1,$E[0]=$E[5]=$i,$E[1]=$Z,$E[4]=-$Z},$j.createRotationYawPitchRoll=function($I,$M,$E,$Z){$EM.createFromYawPitchRoll($I,$M,$E,$j._tempQuaternion),$j.createRotationQuaternion($j._tempQuaternion,$Z)},$j.createRotationAxis=function($I,$M,$E){var $Z=$I.elements,$i=$Z[0],$n=$Z[1],$c=$Z[2],$f=Math.cos($M),$d=Math.sin($M),$H=$i*$i,$B=$n*$n,$A=$c*$c,$Q=$i*$n,$p=$i*$c,$t=$n*$c,$V=$E.elements;$V[3]=$V[7]=$V[11]=$V[12]=$V[13]=$V[14]=0,$V[15]=1,$V[0]=$H+$f*(1-$H),$V[1]=$Q-$f*$Q+$d*$c,$V[2]=$p-$f*$p-$d*$n,$V[4]=$Q-$f*$Q-$d*$c,$V[5]=$B+$f*(1-$B),$V[6]=$t-$f*$t+$d*$i,$V[8]=$p-$f*$p+$d*$n,$V[9]=$t-$f*$t-$d*$i,$V[10]=$A+$f*(1-$A)},$j.createRotationQuaternion=function($I,$M){var $E=$I.elements,$Z=$M.elements,$i=$E[0],$n=$E[1],$c=$E[2],$f=$E[3],$d=$i*$i,$H=$n*$n,$B=$c*$c,$A=$i*$n,$Q=$c*$f,$p=$c*$i,$t=$n*$f,$V=$n*$c,$u=$i*$f;$Z[3]=$Z[7]=$Z[11]=$Z[12]=$Z[13]=$Z[14]=0,$Z[15]=1,$Z[0]=1-2*($H+$B),$Z[1]=2*($A+$Q),$Z[2]=2*($p-$t),$Z[4]=2*($A-$Q),$Z[5]=1-2*($B+$d),$Z[6]=2*($V+$u),$Z[8]=2*($p+$t),$Z[9]=2*($V-$u),$Z[10]=1-2*($H+$d)},$j.createTranslate=function($I,$M){var $E=$I.elements,$Z=$M.elements;$Z[4]=$Z[8]=$Z[1]=$Z[9]=$Z[2]=$Z[6]=$Z[3]=$Z[7]=$Z[11]=0,$Z[0]=$Z[5]=$Z[10]=$Z[15]=1,$Z[12]=$E[0],$Z[13]=$E[1],$Z[14]=$E[2]},$j.createScaling=function($I,$M){var $E=$I.elements,$Z=$M.elements;$Z[0]=$E[0],$Z[5]=$E[1],$Z[10]=$E[2],$Z[1]=$Z[4]=$Z[8]=$Z[12]=$Z[9]=$Z[13]=$Z[2]=$Z[6]=$Z[14]=$Z[3]=$Z[7]=$Z[11]=0,$Z[15]=1},$j.multiply=function($I,$M,$E){var $Z,$i,$n,$c,$f,$d,$H,$B;for($i=$E.elements,$n=$I.elements,$i===($c=$M.elements)&&($c=$c.slice()),$Z=0;$Z<4;$Z++)$f=$n[$Z],$d=$n[$Z+4],$H=$n[$Z+8],$B=$n[$Z+12],$i[$Z]=$f*$c[0]+$d*$c[1]+$H*$c[2]+$B*$c[3],$i[$Z+4]=$f*$c[4]+$d*$c[5]+$H*$c[6]+$B*$c[7],$i[$Z+8]=$f*$c[8]+$d*$c[9]+$H*$c[10]+$B*$c[11],$i[$Z+12]=$f*$c[12]+$d*$c[13]+$H*$c[14]+$B*$c[15]},$j.createFromQuaternion=function($I,$M){var $E=$M.elements,$Z=$I.elements,$i=$Z[0],$n=$Z[1],$c=$Z[2],$f=$Z[3],$d=$i+$i,$H=$n+$n,$B=$c+$c,$A=$i*$d,$Q=$n*$d,$p=$n*$H,$t=$c*$d,$V=$c*$H,$u=$c*$B,$N=$f*$d,$y=$f*$H,$$=$f*$B;$E[0]=1-$p-$u,$E[1]=$Q+$$,$E[2]=$t-$y,$E[3]=0,$E[4]=$Q-$$,$E[5]=1-$A-$u,$E[6]=$V+$N,$E[7]=0,$E[8]=$t+$y,$E[9]=$V-$N,$E[10]=1-$A-$p,$E[11]=0,$E[12]=0,$E[13]=0,$E[14]=0,$E[15]=1},$j.createAffineTransformation=function($I,$M,$E,$Z){var $i=$I.elements,$n=$M.elements,$c=$E.elements,$f=$Z.elements,$d=$n[0],$H=$n[1],$B=$n[2],$A=$n[3],$Q=$d+$d,$p=$H+$H,$t=$B+$B,$V=$d*$Q,$u=$d*$p,$N=$d*$t,$y=$H*$p,$$=$H*$t,$w=$B*$t,$g=$A*$Q,$O=$A*$p,$a=$A*$t,$m=$c[0],$j=$c[1],$T=$c[2];$f[0]=(1-($y+$w))*$m,$f[1]=($u+$a)*$m,$f[2]=($N-$O)*$m,$f[3]=0,$f[4]=($u-$a)*$j,$f[5]=(1-($V+$w))*$j,$f[6]=($$+$g)*$j,$f[7]=0,$f[8]=($N+$O)*$T,$f[9]=($$-$g)*$T,$f[10]=(1-($V+$y))*$T,$f[11]=0,$f[12]=$i[0],$f[13]=$i[1],$f[14]=$i[2],$f[15]=1},$j.createLookAt=function($I,$M,$E,$Z){var $i=$Z.elements,$n=$j._tempVector0,$c=$j._tempVector1,$f=$j._tempVector2;$cM.subtract($I,$M,$f),$cM.normalize($f,$f),$cM.cross($E,$f,$n),$cM.normalize($n,$n),$cM.cross($f,$n,$c),$Z.identity(),$i[0]=$n.x,$i[4]=$n.y,$i[8]=$n.z,$i[1]=$c.x,$i[5]=$c.y,$i[9]=$c.z,$i[2]=$f.x,$i[6]=$f.y,$i[10]=$f.z,$i[12]=-$cM.dot($n,$I),$i[13]=-$cM.dot($c,$I),$i[14]=-$cM.dot($f,$I)},$j.createPerspective=function($I,$M,$E,$Z,$i){var $n=$i.elements,$c=1/Math.tan($I/2),$f=1/($E-$Z);$n[0]=$c/$M,$n[5]=$c,$n[10]=($Z+$E)*$f,$n[11]=-1,$n[14]=2*$Z*$E*$f,$n[1]=$n[2]=$n[3]=$n[4]=$n[6]=$n[7]=$n[8]=$n[9]=$n[12]=$n[13]=$n[15]=0},$j.createOrthoOffCenterRH=function($I,$M,$E,$Z,$i,$n,$c){var $f=$c.elements,$d=1/($I-$M),$H=1/($E-$Z),$B=1/($i-$n);$f[1]=$f[2]=$f[3]=$f[4]=$f[6]=$f[7]=$f[8]=$f[9]=$f[11]=0,$f[15]=1,$f[0]=-2*$d,$f[5]=-2*$H,$f[10]=2*$B,$f[12]=($I+$M)*$d,$f[13]=($Z+$E)*$H,$f[14]=($n+$i)*$B},$j.translation=function($I,$M){var $E=$I.elements,$Z=$M.elements;$Z[0]=$Z[5]=$Z[10]=$Z[15]=1,$Z[12]=$E[0],$Z[13]=$E[1],$Z[14]=$E[2]},$A($j,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $j},"_tempVector0",function(){return this._tempVector0=new $cM},"_tempVector1",function(){return this._tempVector1=new $cM},"_tempVector2",function(){return this._tempVector2=new $cM},"_tempQuaternion",function(){return this._tempQuaternion=new $EM},"DEFAULT",function(){return this.DEFAULT=new $j},"ZERO",function(){return this.ZERO=new $j(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),$j}(),$MM=(function(){function $$($I,$M){this.extents=null,this.transformation=null,this.extents=$I,this.transformation=$M}$p($$,"laya.d3.math.OrientedBoundBox");var $I=$$.prototype;$I.getCorners=function($I){var $M=$$._tempV30.elements,$E=$$._tempV31.elements,$Z=$$._tempV32.elements,$i=this.extents.elements;$M[0]=$i[0],$M[1]=$M[2]=0,$E[1]=$i[1],$E[0]=$E[2]=0,$Z[2]=$i[2],$Z[0]=$Z[1]=0,$cM.TransformNormal($$._tempV30,this.transformation,$$._tempV30),$cM.TransformNormal($$._tempV31,this.transformation,$$._tempV31),$cM.TransformNormal($$._tempV32,this.transformation,$$._tempV32);var $n=$$._tempV33;this.transformation.getTranslationVector($n),$I.length=8,$cM.add($n,$$._tempV30,$$._tempV34),$cM.add($$._tempV34,$$._tempV31,$$._tempV34),$cM.add($$._tempV34,$$._tempV32,$I[0]),$cM.add($n,$$._tempV30,$$._tempV34),$cM.add($$._tempV34,$$._tempV31,$$._tempV34),$cM.subtract($$._tempV34,$$._tempV32,$I[1]),$cM.subtract($n,$$._tempV30,$$._tempV34),$cM.add($$._tempV34,$$._tempV31,$$._tempV34),$cM.subtract($$._tempV34,$$._tempV32,$I[2]),$cM.subtract($n,$$._tempV30,$$._tempV34),$cM.add($$._tempV34,$$._tempV31,$$._tempV34),$cM.add($$._tempV34,$$._tempV32,$I[3]),$cM.add($n,$$._tempV30,$$._tempV34),$cM.subtract($$._tempV34,$$._tempV31,$$._tempV34),$cM.add($$._tempV34,$$._tempV32,$I[4]),$cM.add($n,$$._tempV30,$$._tempV34),$cM.subtract($$._tempV34,$$._tempV31,$$._tempV34),$cM.subtract($$._tempV34,$$._tempV32,$I[5]),$cM.subtract($n,$$._tempV30,$$._tempV34),$cM.subtract($$._tempV34,$$._tempV31,$$._tempV34),$cM.subtract($$._tempV34,$$._tempV32,$I[6]),$cM.subtract($n,$$._tempV30,$$._tempV34),$cM.subtract($$._tempV34,$$._tempV31,$$._tempV34),$cM.add($$._tempV34,$$._tempV32,$I[7])},$I.transform=function($I){$IM.multiply(this.transformation,$I,this.transformation)},$I.scale=function($I){$cM.multiply(this.extents,$I,this.extents)},$I.translate=function($I){this.transformation.getTranslationVector($$._tempV30),$cM.add($$._tempV30,$I,$$._tempV31),this.transformation.setTranslationVector($$._tempV31)},$I.Size=function($I){$cM.scale(this.extents,2,$I)},$I.getSize=function($I){var $M=this.extents.elements;$$._tempV30.x=$M[0],$$._tempV31.y=$M[1],$$._tempV32.z=$M[2],$cM.TransformNormal($$._tempV30,this.transformation,$$._tempV30),$cM.TransformNormal($$._tempV31,this.transformation,$$._tempV31),$cM.TransformNormal($$._tempV31,this.transformation,$$._tempV32);var $E=$I.elements;$E[0]=$cM.scalarLength($$._tempV30),$E[1]=$cM.scalarLength($$._tempV31),$E[2]=$cM.scalarLength($$._tempV32)},$I.getSizeSquared=function($I){var $M=this.extents.elements;$$._tempV30.x=$M[0],$$._tempV31.y=$M[1],$$._tempV32.z=$M[2],$cM.TransformNormal($$._tempV30,this.transformation,$$._tempV30),$cM.TransformNormal($$._tempV31,this.transformation,$$._tempV31),$cM.TransformNormal($$._tempV31,this.transformation,$$._tempV32);var $E=$I.elements;$E[0]=$cM.scalarLengthSquared($$._tempV30),$E[1]=$cM.scalarLengthSquared($$._tempV31),$E[2]=$cM.scalarLengthSquared($$._tempV32)},$I.getCenter=function($I){this.transformation.getTranslationVector($I)},$I.containsPoint=function($I){var $M=this.extents.elements,$E=$M[0],$Z=$M[1],$i=$M[2];this.transformation.invert($$._tempM0),$cM.transformCoordinate($I,$$._tempM0,$$._tempV30);var $n=$$._tempV30.elements,$c=Math.abs($n[0]),$f=Math.abs($n[1]),$d=Math.abs($n[2]);return $bI.nearEqual($c,$E)&&$bI.nearEqual($f,$Z)&&$bI.nearEqual($d,$i)?2:$c<$E&&$f<$Z&&$d<$i?1:0},$I.containsPoints=function($I){var $M=this.extents.elements,$E=$M[0],$Z=$M[1],$i=$M[2];this.transformation.invert($$._tempM0);for(var $n=!0,$c=!1,$f=0;$f<$I.length;$f++){$cM.transformCoordinate($I[$f],$$._tempM0,$$._tempV30);var $d=$$._tempV30.elements,$H=Math.abs($d[0]),$B=Math.abs($d[1]),$A=Math.abs($d[2]);$bI.nearEqual($H,$E)&&$bI.nearEqual($B,$Z)&&$bI.nearEqual($A,$i)&&($c=!0),$H<$E&&$B<$Z&&$A<$i?$c=!0:$n=!1}return $n?1:$c?2:0},$I.containsSphere=function($I,$M){void 0===$M&&($M=!1);var $E=this.extents.elements,$Z=$E[0],$i=$E[1],$n=$E[2],$c=$I.radius;this.transformation.invert($$._tempM0),$cM.transformCoordinate($I.center,$$._tempM0,$$._tempV30);var $f=NaN;if($f=$M?$c:($cM.scale($cM.UnitX,$c,$$._tempV31),$cM.TransformNormal($$._tempV31,$$._tempM0,$$._tempV31),$cM.scalarLength($$._tempV31)),$cM.scale(this.extents,-1,$$._tempV32),$cM.Clamp($$._tempV30,$$._tempV32,this.extents,$$._tempV33),$f*$f<$cM.distanceSquared($$._tempV30,$$._tempV33))return 0;var $d=$$._tempV30.elements,$H=$d[0],$B=$d[1],$A=$d[2],$Q=$$._tempV32.elements,$p=$Q[0],$t=$Q[1],$V=$Q[2];return $p+$f<=$H&&$H<=$Z-$f&&$f<$Z-$p&&$t+$f<=$B&&$B<=$i-$f&&$f<$i-$t&&$V+$f<=$A&&$A<=$n-$f&&$f<$n-$V?1:2},$I.containsOrientedBoundBox=function($I){var $M=0,$E=0;$I.getCorners($$._corners);var $Z=this.containsPoints($$._corners);if(0!=$Z)return $Z;var $i=this.extents.elements;$I.extents.cloneTo($$._tempV35);var $n=$$._tempV35.elements;$$._getRows(this.transformation,$$._rows1),$$._getRows($I.transformation,$$._rows2);var $c=NaN;for($M=0;$M<4;$M++)for($E=0;$E<4;$E++)3==$M||3==$E?($$._tempM0.setElementByRowColumn($M,$E,0),$$._tempM1.setElementByRowColumn($M,$E,0)):($c=$cM.dot($$._rows1[$M],$$._rows2[$E]),$$._tempM0.setElementByRowColumn($M,$E,$c),$$._tempM1.setElementByRowColumn($M,$E,Math.abs($c)));$I.getCenter($$._tempV34),this.getCenter($$._tempV36),$cM.subtract($$._tempV34,$$._tempV36,$$._tempV30);var $f=$$._tempV31.elements;$f[0]=$cM.dot($$._tempV30,$$._rows1[0]),$f[1]=$cM.dot($$._tempV30,$$._rows1[1]),$f[2]=$cM.dot($$._tempV30,$$._rows1[2]);var $d=$$._tempV32.elements,$H=$$._tempV33.elements;for($M=0;$M<3;$M++)if($d[0]=$$._tempM1.getElementByRowColumn($M,0),$d[1]=$$._tempM1.getElementByRowColumn($M,1),$d[2]=$$._tempM1.getElementByRowColumn($M,2),$i[$M]+$cM.dot($$._tempV35,$$._tempV32)<Math.abs($f[$M]))return 0;for($E=0;$E<3;$E++)if($d[0]=$$._tempM1.getElementByRowColumn(0,$E),$d[1]=$$._tempM1.getElementByRowColumn(1,$E),$d[2]=$$._tempM1.getElementByRowColumn(2,$E),$H[0]=$$._tempM0.getElementByRowColumn(0,$E),$H[1]=$$._tempM0.getElementByRowColumn(1,$E),$H[2]=$$._tempM0.getElementByRowColumn(2,$E),$cM.dot(this.extents,$$._tempV32)+$n[$E]<Math.abs($cM.dot($$._tempV31,$$._tempV33)))return 0;for($M=0;$M<3;$M++)for($E=0;$E<3;$E++){var $B=($M+1)%3,$A=($M+2)%3,$Q=($E+1)%3,$p=($E+2)%3;if($i[$B]*$$._tempM1.getElementByRowColumn($A,$E)+$i[$A]*$$._tempM1.getElementByRowColumn($B,$E)+($n[$Q]*$$._tempM1.getElementByRowColumn($M,$p)+$n[$p]*$$._tempM1.getElementByRowColumn($M,$Q))<Math.abs($f[$A]*$$._tempM0.getElementByRowColumn($B,$E)-$f[$B]*$$._tempM0.getElementByRowColumn($A,$E)))return 0}return 2},$I.containsLine=function($I,$M){$$._corners[0]=$I,$$._corners[1]=$M;var $E=this.containsPoints($$._corners);if(0!=$E)return $E;var $Z=this.extents.elements,$i=$Z[0],$n=$Z[1],$c=$Z[2];this.transformation.invert($$._tempM0),$cM.transformCoordinate($I,$$._tempM0,$$._tempV30),$cM.transformCoordinate($M,$$._tempM0,$$._tempV31),$cM.add($$._tempV30,$$._tempV31,$$._tempV32),$cM.scale($$._tempV32,.5,$$._tempV32),$cM.subtract($$._tempV30,$$._tempV32,$$._tempV33);var $f=$$._tempV33.elements,$d=$f[0],$H=$f[1],$B=$f[2],$A=$$._tempV34.elements,$Q=$A[0]=Math.abs($f[0]),$p=$A[1]=Math.abs($f[1]),$t=$A[2]=Math.abs($f[2]),$V=$$._tempV32.elements,$u=$V[0],$N=$V[1],$y=$V[2];return Math.abs($u)>$i+$Q?0:Math.abs($N)>$n+$p?0:Math.abs($y)>$c+$t?0:Math.abs($N*$B-$y*$H)>$n*$t+$c*$p?0:Math.abs($u*$B-$y*$d)>$i*$t+$c*$Q?0:Math.abs($u*$H-$N*$d)>$i*$p+$n*$Q?0:2},$I.containsBoundBox=function($I){var $M=0,$E=0,$Z=$I.min,$i=$I.max;$I.getCorners($$._corners);var $n=this.containsPoints($$._corners);if(0!=$n)return $n;$cM.subtract($i,$Z,$$._tempV30),$cM.scale($$._tempV30,.5,$$._tempV30),$cM.add($Z,$$._tempV30,$$._tempV30),$cM.subtract($i,$$._tempV30,$$._tempV31);var $c=this.extents.elements,$f=$$._tempV31.elements;$$._getRows(this.transformation,$$._rows1),this.transformation.invert($$._tempM0);for($M=0;$M<3;$M++)for($E=0;$E<3;$E++)$$._tempM1.setElementByRowColumn($M,$E,Math.abs($$._tempM0.getElementByRowColumn($M,$E)));this.getCenter($$._tempV35),$cM.subtract($$._tempV30,$$._tempV35,$$._tempV32);var $d=$$._tempV31.elements;$d[0]=$cM.dot($$._tempV32,$$._rows1[0]),$d[1]=$cM.dot($$._tempV32,$$._rows1[1]),$d[2]=$cM.dot($$._tempV32,$$._rows1[2]);var $H=$$._tempV33.elements,$B=$$._tempV34.elements;for($M=0;$M<3;$M++)if($H[0]=$$._tempM1.getElementByRowColumn($M,0),$H[1]=$$._tempM1.getElementByRowColumn($M,1),$H[2]=$$._tempM1.getElementByRowColumn($M,2),$c[$M]+$cM.dot($$._tempV31,$$._tempV33)<Math.abs($d[$M]))return 0;for($E=0;$E<3;$E++)if($H[0]=$$._tempM1.getElementByRowColumn(0,$E),$H[1]=$$._tempM1.getElementByRowColumn(1,$E),$H[2]=$$._tempM1.getElementByRowColumn(2,$E),$B[0]=$$._tempM0.getElementByRowColumn(0,$E),$B[1]=$$._tempM0.getElementByRowColumn(1,$E),$B[2]=$$._tempM0.getElementByRowColumn(2,$E),$cM.dot(this.extents,$$._tempV33)+$f[$E]<Math.abs($cM.dot($$._tempV31,$$._tempV34)))return 0;for($M=0;$M<3;$M++)for($E=0;$E<3;$E++){var $A=($M+1)%3,$Q=($M+2)%3,$p=($E+1)%3,$t=($E+2)%3;if($c[$A]*$$._tempM1.getElementByRowColumn($Q,$E)+$c[$Q]*$$._tempM1.getElementByRowColumn($A,$E)+($f[$p]*$$._tempM1.getElementByRowColumn($M,$t)+$f[$t]*$$._tempM1.getElementByRowColumn($M,$p))<Math.abs($d[$Q]*$$._tempM0.getElementByRowColumn($A,$E)-$d[$A]*$$._tempM0.getElementByRowColumn($Q,$E)))return 0}return 2},$I.intersectsRay=function($I,$M){$cM.scale(this.extents,-1,$$._tempV30),this.transformation.invert($$._tempM0),$cM.TransformNormal($I.direction,$$._tempM0,$$._ray.direction),$cM.transformCoordinate($I.origin,$$._tempM0,$$._ray.origin),$$._boxBound1.min=$$._tempV30,$$._boxBound1.max=this.extents;var $E=Collision.intersectsRayAndBoxRP($$._ray,$$._boxBound1,$M);return-1!==$E&&$cM.transformCoordinate($M,this.transformation,$M),$E},$I._getLocalCorners=function($I){$I.length=8;var $M=this.extents.elements;$$._tempV30.x=$M[0],$$._tempV31.y=$M[1],$$._tempV32.z=$M[2],$cM.add($$._tempV30,$$._tempV31,$$._tempV33),$cM.add($$._tempV33,$$._tempV32,$I[0]),$cM.add($$._tempV30,$$._tempV31,$$._tempV33),$cM.subtract($$._tempV33,$$._tempV32,$I[1]),$cM.subtract($$._tempV31,$$._tempV30,$$._tempV33),$cM.subtract($$._tempV33,$$._tempV30,$I[2]),$cM.subtract($$._tempV31,$$._tempV30,$$._tempV33),$cM.add($$._tempV33,$$._tempV32,$I[3]),$cM.subtract($$._tempV30,$$._tempV31,$$._tempV33),$cM.add($$._tempV33,$$._tempV32,$I[4]),$cM.subtract($$._tempV30,$$._tempV31,$$._tempV33),$cM.subtract($$._tempV33,$$._tempV32,$I[5]),$cM.scale($I[0],-1,$I[6]),$cM.subtract($$._tempV32,$$._tempV30,$$._tempV33),$cM.subtract($$._tempV33,$$._tempV31,$I[7])},$I.equals=function($I){return this.extents==$I.extents&&this.transformation==$I.transformation},$I.cloneTo=function($I){var $M=$I;this.extents.cloneTo($M.extents),this.transformation.cloneTo($M.transformation)},$$.createByBoundBox=function($I,$M){var $E=$I.min,$Z=$I.max;$cM.subtract($Z,$E,$$._tempV30),$cM.scale($$._tempV30,.5,$$._tempV30),$cM.add($E,$$._tempV30,$$._tempV31),$cM.subtract($Z,$$._tempV31,$$._tempV32),$IM.translation($$._tempV31,$$._tempM0);var $i=$$._tempV32.clone(),$n=$$._tempM0.clone();$M.extents=$i,$M.transformation=$n},$$.createByMinAndMaxVertex=function($I,$M){return $cM.subtract($M,$I,$$._tempV30),$cM.scale($$._tempV30,.5,$$._tempV30),$cM.add($I,$$._tempV30,$$._tempV31),$cM.subtract($M,$$._tempV31,$$._tempV32),$IM.translation($$._tempV31,$$._tempM0),new $$($$._tempV32,$$._tempM0)},$$._getRows=function($I,$M){$M.length=3;var $E=$I.elements,$Z=$M[0].elements;$Z[0]=$E[0],$Z[1]=$E[1],$Z[2]=$E[2];var $i=$M[1].elements;$i[0]=$E[4],$i[1]=$E[5],$i[2]=$E[6];var $n=$M[2].elements;$n[0]=$E[8],$n[1]=$E[9],$n[2]=$E[10]},$$.getObbtoObbMatrix4x4=function($I,$M,$E,$Z){var $i=$I.transformation,$n=$M.transformation;if($E){$$._getRows($i,$$._rows1),$$._getRows($n,$$._rows2);for(var $c=0;$c<3;$c++)for(var $f=0;$f<3;$f++)$Z.setElementByRowColumn($c,$f,$cM.dot($$._rows2[$c],$$._rows1[$f]));$M.getCenter($$._tempV30),$I.getCenter($$._tempV31),$cM.subtract($$._tempV30,$$._tempV31,$$._tempV32);var $d=$Z.elements;$d[12]=$cM.dot($$._tempV32,$$._rows1[0]),$d[13]=$cM.dot($$._tempV32,$$._rows1[1]),$d[14]=$cM.dot($$._tempV32,$$._rows1[2]),$d[15]=1}else $i.invert($$._tempM0),$IM.multiply($n,$$._tempM0,$Z)},$$.merge=function($I,$M,$E){var $Z=$I.extents,$i=$I.transformation;$$.getObbtoObbMatrix4x4($I,$M,$E,$$._tempM0),$M._getLocalCorners($$._corners),$cM.transformCoordinate($$._corners[0],$$._tempM0,$$._corners[0]),$cM.transformCoordinate($$._corners[1],$$._tempM0,$$._corners[1]),$cM.transformCoordinate($$._corners[2],$$._tempM0,$$._corners[2]),$cM.transformCoordinate($$._corners[3],$$._tempM0,$$._corners[3]),$cM.transformCoordinate($$._corners[4],$$._tempM0,$$._corners[4]),$cM.transformCoordinate($$._corners[5],$$._tempM0,$$._corners[5]),$cM.transformCoordinate($$._corners[6],$$._tempM0,$$._corners[6]),$cM.transformCoordinate($$._corners[7],$$._tempM0,$$._corners[7]),$cM.scale($Z,-1,$$._boxBound1.min),$Z.cloneTo($$._boxBound1.max),$YI.createfromPoints($$._corners,$$._boxBound2),$YI.merge($$._boxBound2,$$._boxBound1,$$._boxBound3);var $n=$$._boxBound3.min,$c=$$._boxBound3.max;$cM.subtract($c,$n,$$._tempV30),$cM.scale($$._tempV30,.5,$$._tempV30),$cM.add($n,$$._tempV30,$$._tempV32),$cM.subtract($c,$$._tempV32,$Z),$cM.transformCoordinate($$._tempV32,$i,$$._tempV33)},$A($$,["_tempV30",function(){return this._tempV30=new $cM},"_tempV31",function(){return this._tempV31=new $cM},"_tempV32",function(){return this._tempV32=new $cM},"_tempV33",function(){return this._tempV33=new $cM},"_tempV34",function(){return this._tempV34=new $cM},"_tempV35",function(){return this._tempV35=new $cM},"_tempV36",function(){return this._tempV36=new $cM},"_tempM0",function(){return this._tempM0=new $IM},"_tempM1",function(){return this._tempM1=new $IM},"_corners",function(){return this._corners=[new $cM,new $cM,new $cM,new $cM,new $cM,new $cM,new $cM,new $cM]},"_rows1",function(){return this._rows1=[new $cM,new $cM,new $cM]},"_rows2",function(){return this._rows2=[new $cM,new $cM,new $cM]},"_ray",function(){return this._ray=new $iM(new $cM,new $cM)},"_boxBound1",function(){return this._boxBound1=new $YI(new $cM,new $cM)},"_boxBound2",function(){return this._boxBound2=new $YI(new $cM,new $cM)},"_boxBound3",function(){return this._boxBound3=new $YI(new $cM,new $cM)}])}(),function(){function $g($I,$M){this.normal=null,this.distance=NaN,void 0===$M&&($M=0),this.normal=$I,this.distance=$M}return $p($g,"laya.d3.math.Plane"),$g.prototype.normalize=function(){var $I=this.normal.elements,$M=$I[0],$E=$I[1],$Z=$I[2],$i=1/Math.sqrt($M*$M+$E*$E+$Z*$Z);$I[0]=$M*$i,$I[1]=$E*$i,$I[2]=$Z*$i,this.distance*=$i},$g.createPlaneBy3P=function($I,$M,$E){var $Z=$I.elements,$i=$M.elements,$n=$E.elements,$c=$i[0]-$Z[0],$f=$i[1]-$Z[1],$d=$i[2]-$Z[2],$H=$n[0]-$Z[0],$B=$n[1]-$Z[1],$A=$n[2]-$Z[2],$Q=$f*$A-$d*$B,$p=$d*$H-$c*$A,$t=$c*$B-$f*$H,$V=1/Math.sqrt($Q*$Q+$p*$p+$t*$t),$u=$Q*$V,$N=$p*$V,$y=$t*$V,$$=$g._TEMPVec3.elements;$$[0]=$u,$$[1]=$N,$$[2]=$y;var $w=-($u*$Z[0]+$N*$Z[1]+$y*$Z[2]);return new $g($g._TEMPVec3,$w)},$g.PlaneIntersectionType_Back=0,$g.PlaneIntersectionType_Front=1,$g.PlaneIntersectionType_Intersecting=2,$A($g,["_TEMPVec3",function(){return this._TEMPVec3=new $cM}]),$g}()),$EM=function(){function $i($I,$M,$E,$Z){this.elements=new Float32Array(4),void 0===$I&&($I=0),void 0===$M&&($M=0),void 0===$E&&($E=0),void 0===$Z&&($Z=1),this.elements[0]=$I,this.elements[1]=$M,this.elements[2]=$E,this.elements[3]=$Z}$p($i,"laya.d3.math.Quaternion");var $I=$i.prototype;return $g.imps($I,{"laya.d3.core.IClone":!0}),$I.scaling=function($I,$M){var $E=$M.elements,$Z=this.elements;$E[0]=$Z[0]*$I,$E[1]=$Z[1]*$I,$E[2]=$Z[2]*$I,$E[3]=$Z[3]*$I},$I.normalize=function($I){var $M=$I.elements,$E=this.elements,$Z=$E[0],$i=$E[1],$n=$E[2],$c=$E[3],$f=$Z*$Z+$i*$i+$n*$n+$c*$c;0<$f&&($f=1/Math.sqrt($f),$M[0]=$Z*$f,$M[1]=$i*$f,$M[2]=$n*$f,$M[3]=$c*$f)},$I.length=function(){var $I=this.elements,$M=$I[0],$E=$I[1],$Z=$I[2],$i=$I[3];return Math.sqrt($M*$M+$E*$E+$Z*$Z+$i*$i)},$I.rotateX=function($I,$M){var $E=$M.elements,$Z=this.elements;$I*=.5;var $i=$Z[0],$n=$Z[1],$c=$Z[2],$f=$Z[3],$d=Math.sin($I),$H=Math.cos($I);$E[0]=$i*$H+$f*$d,$E[1]=$n*$H+$c*$d,$E[2]=$c*$H-$n*$d,$E[3]=$f*$H-$i*$d},$I.rotateY=function($I,$M){var $E=$M.elements,$Z=this.elements;$I*=.5;var $i=$Z[0],$n=$Z[1],$c=$Z[2],$f=$Z[3],$d=Math.sin($I),$H=Math.cos($I);$E[0]=$i*$H-$c*$d,$E[1]=$n*$H+$f*$d,$E[2]=$c*$H+$i*$d,$E[3]=$f*$H-$n*$d},$I.rotateZ=function($I,$M){var $E=$M.elements,$Z=this.elements;$I*=.5;var $i=$Z[0],$n=$Z[1],$c=$Z[2],$f=$Z[3],$d=Math.sin($I),$H=Math.cos($I);$E[0]=$i*$H+$n*$d,$E[1]=$n*$H-$i*$d,$E[2]=$c*$H+$f*$d,$E[3]=$f*$H-$c*$d},$I.getYawPitchRoll=function($I){$cM.transformQuat($cM.ForwardRH,this,$i.TEMPVector31),$cM.transformQuat($cM.Up,this,$i.TEMPVector32);var $M=$i.TEMPVector32.elements;$i.angleTo($cM.ZERO,$i.TEMPVector31,$i.TEMPVector33);var $E=$i.TEMPVector33.elements;$E[0]==Math.PI/2?($E[1]=$i.arcTanAngle($M[2],$M[0]),$E[2]=0):$E[0]==-Math.PI/2?($E[1]=$i.arcTanAngle(-$M[2],-$M[0]),$E[2]=0):($IM.createRotationY(-$E[1],$i.TEMPMatrix0),$IM.createRotationX(-$E[0],$i.TEMPMatrix1),$cM.transformCoordinate($i.TEMPVector32,$i.TEMPMatrix0,$i.TEMPVector32),$cM.transformCoordinate($i.TEMPVector32,$i.TEMPMatrix1,$i.TEMPVector32),$E[2]=$i.arcTanAngle($M[1],-$M[0])),$E[1]<=-Math.PI&&($E[1]=Math.PI),$E[2]<=-Math.PI&&($E[2]=Math.PI),$E[1]>=Math.PI&&$E[2]>=Math.PI&&($E[1]=0,$E[2]=0,$E[0]=Math.PI-$E[0]);var $Z=$I.elements;$Z[0]=$E[1],$Z[1]=$E[0],$Z[2]=$E[2]},$I.invert=function($I){var $M=$I.elements,$E=this.elements,$Z=$E[0],$i=$E[1],$n=$E[2],$c=$E[3],$f=$Z*$Z+$i*$i+$n*$n+$c*$c,$d=$f?1/$f:0;$M[0]=-$Z*$d,$M[1]=-$i*$d,$M[2]=-$n*$d,$M[3]=$c*$d},$I.identity=function(){var $I=this.elements;$I[0]=0,$I[1]=0,$I[2]=0,$I[3]=1},$I.fromArray=function($I,$M){void 0===$M&&($M=0),this.elements[0]=$I[$M+0],this.elements[1]=$I[$M+1],this.elements[2]=$I[$M+2],this.elements[3]=$I[$M+3]},$I.cloneTo=function($I){var $M,$E,$Z;if(($E=this.elements)!==($Z=$I.elements))for($M=0;$M<4;++$M)$Z[$M]=$E[$M]},$I.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$I.equals=function($I){var $M=this.elements,$E=$I.elements;return $bI.nearEqual($M[0],$E[0])&&$bI.nearEqual($M[1],$E[1])&&$bI.nearEqual($M[2],$E[2])&&$bI.nearEqual($M[3],$E[3])},$I.lengthSquared=function(){var $I=this.elements[0],$M=this.elements[1],$E=this.elements[2],$Z=this.elements[3];return $I*$I+$M*$M+$E*$E+$Z*$Z},$t(0,$I,"x",function(){return this.elements[0]}),$t(0,$I,"y",function(){return this.elements[1]}),$t(0,$I,"z",function(){return this.elements[2]}),$t(0,$I,"w",function(){return this.elements[3]}),$i.createFromYawPitchRoll=function($I,$M,$E,$Z){var $i=.5*$E,$n=.5*$M,$c=.5*$I,$f=Math.sin($i),$d=Math.cos($i),$H=Math.sin($n),$B=Math.cos($n),$A=Math.sin($c),$Q=Math.cos($c),$p=$Z.elements;$p[0]=$Q*$H*$d+$A*$B*$f,$p[1]=$A*$B*$d-$Q*$H*$f,$p[2]=$Q*$B*$f-$A*$H*$d,$p[3]=$Q*$B*$d+$A*$H*$f},$i.multiply=function($I,$M,$E){var $Z=$I.elements,$i=$M.elements,$n=$E.elements,$c=$Z[0],$f=$Z[1],$d=$Z[2],$H=$Z[3],$B=$i[0],$A=$i[1],$Q=$i[2],$p=$i[3],$t=$f*$Q-$d*$A,$V=$d*$B-$c*$Q,$u=$c*$A-$f*$B,$N=$c*$B+$f*$A+$d*$Q;$n[0]=$c*$p+$B*$H+$t,$n[1]=$f*$p+$A*$H+$V,$n[2]=$d*$p+$Q*$H+$u,$n[3]=$H*$p-$N},$i.arcTanAngle=function($I,$M){return 0==$I?1==$M?Math.PI/2:-Math.PI/2:0<$I?Math.atan($M/$I):$I<0?0<$M?Math.atan($M/$I)+Math.PI:Math.atan($M/$I)-Math.PI:0},$i.angleTo=function($I,$M,$E){$cM.subtract($M,$I,$i.TEMPVector30),$cM.normalize($i.TEMPVector30,$i.TEMPVector30),$E.elements[0]=Math.asin($i.TEMPVector30.y),$E.elements[1]=$i.arcTanAngle(-$i.TEMPVector30.z,-$i.TEMPVector30.x)},$i.createFromAxisAngle=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements;$M*=.5;var $n=Math.sin($M);$Z[0]=$n*$i[0],$Z[1]=$n*$i[1],$Z[2]=$n*$i[2],$Z[3]=Math.cos($M)},$i.createFromMatrix3x3=function($I,$M){var $E,$Z=$M.elements,$i=$I.elements,$n=$i[0]+$i[4]+$i[8];if(0<$n)$E=Math.sqrt($n+1),$Z[3]=.5*$E,$E=.5/$E,$Z[0]=($i[5]-$i[7])*$E,$Z[1]=($i[6]-$i[2])*$E,$Z[2]=($i[1]-$i[3])*$E;else{var $c=0;$i[4]>$i[0]&&($c=1),$i[8]>$i[3*$c+$c]&&($c=2);var $f=($c+1)%3,$d=($c+2)%3;$E=Math.sqrt($i[3*$c+$c]-$i[3*$f+$f]-$i[3*$d+$d]+1),$Z[$c]=.5*$E,$E=.5/$E,$Z[3]=($i[3*$f+$d]-$i[3*$d+$f])*$E,$Z[$f]=($i[3*$f+$c]+$i[3*$c+$f])*$E,$Z[$d]=($i[3*$d+$c]+$i[3*$c+$d])*$E}},$i.createFromMatrix4x4=function($I,$M){var $E,$Z,$i=$I.elements,$n=$M.elements,$c=$i[0]+$i[5]+$i[10];0<$c?($E=Math.sqrt($c+1),$n[3]=.5*$E,$E=.5/$E,$n[0]=($i[6]-$i[9])*$E,$n[1]=($i[8]-$i[2])*$E,$n[2]=($i[1]-$i[4])*$E):$i[0]>=$i[5]&&$i[0]>=$i[10]?($Z=.5/($E=Math.sqrt(1+$i[0]-$i[5]-$i[10])),$n[0]=.5*$E,$n[1]=($i[1]+$i[4])*$Z,$n[2]=($i[2]+$i[8])*$Z,$n[3]=($i[6]-$i[9])*$Z):$i[5]>$i[10]?($Z=.5/($E=Math.sqrt(1+$i[5]-$i[0]-$i[10])),$n[0]=($i[4]+$i[1])*$Z,$n[1]=.5*$E,$n[2]=($i[9]+$i[6])*$Z,$n[3]=($i[8]-$i[2])*$Z):($Z=.5/($E=Math.sqrt(1+$i[10]-$i[0]-$i[5])),$n[0]=($i[8]+$i[2])*$Z,$n[1]=($i[9]+$i[6])*$Z,$n[2]=.5*$E,$n[3]=($i[1]-$i[4])*$Z)},$i.slerp=function($I,$M,$E,$Z){var $i,$n,$c,$f,$d,$H=$I.elements,$B=$M.elements,$A=$Z.elements,$Q=$H[0],$p=$H[1],$t=$H[2],$V=$H[3],$u=$B[0],$N=$B[1],$y=$B[2],$$=$B[3];return($n=$Q*$u+$p*$N+$t*$y+$V*$$)<0&&($n=-$n,$u=-$u,$N=-$N,$y=-$y,$$=-$$),$d=1e-6<1-$n?($i=Math.acos($n),$c=Math.sin($i),$f=Math.sin((1-$E)*$i)/$c,Math.sin($E*$i)/$c):($f=1-$E,$E),$A[0]=$f*$Q+$d*$u,$A[1]=$f*$p+$d*$N,$A[2]=$f*$t+$d*$y,$A[3]=$f*$V+$d*$$,$A},$i.lerp=function($I,$M,$E,$Z){var $i=$Z.elements,$n=$I.elements,$c=$M.elements,$f=$n[0],$d=$n[1],$H=$n[2],$B=$n[3];$i[0]=$f+$E*($c[0]-$f),$i[1]=$d+$E*($c[1]-$d),$i[2]=$H+$E*($c[2]-$H),$i[3]=$B+$E*($c[3]-$B)},$i.add=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M.elements;$Z[0]=$i[0]+$n[0],$Z[1]=$i[1]+$n[1],$Z[2]=$i[2]+$n[2],$Z[3]=$i[3]+$n[3]},$i.dot=function($I,$M){var $E=$I.elements,$Z=$M.elements;return $E[0]*$Z[0]+$E[1]*$Z[1]+$E[2]*$Z[2]+$E[3]*$Z[3]},$i.rotationLookAt=function($I,$M,$E){$i.lookAt($cM.ZERO,$I,$M,$E)},$i.lookAt=function($I,$M,$E,$Z){$UI.lookAt($I,$M,$E,$i._tempMatrix3x3),$i.rotationMatrix($i._tempMatrix3x3,$Z)},$i.invert=function($I,$M){var $E=$I.elements,$Z=$M.elements,$i=$I.lengthSquared();$bI.isZero($i)||($i=1/$i,$Z[0]=-$E[0]*$i,$Z[1]=-$E[1]*$i,$Z[2]=-$E[2]*$i,$Z[3]=$E[3]*$i)},$i.rotationMatrix=function($I,$M){var $E=$I.elements,$Z=$E[0],$i=$E[1],$n=$E[2],$c=$E[3],$f=$E[4],$d=$E[5],$H=$E[6],$B=$E[7],$A=$E[8],$Q=$M.elements,$p=NaN,$t=NaN,$V=$Z+$f+$A;0<$V?($p=Math.sqrt($V+1),$Q[3]=.5*$p,$p=.5/$p,$Q[0]=($d-$B)*$p,$Q[1]=($H-$n)*$p,$Q[2]=($i-$c)*$p):$f<=$Z&&$A<=$Z?($t=.5/($p=Math.sqrt(1+$Z-$f-$A)),$Q[0]=.5*$p,$Q[1]=($i+$c)*$t,$Q[2]=($n+$H)*$t,$Q[3]=($d-$B)*$t):$A<$f?($t=.5/($p=Math.sqrt(1+$f-$Z-$A)),$Q[0]=($c+$i)*$t,$Q[1]=.5*$p,$Q[2]=($B+$d)*$t,$Q[3]=($H-$n)*$t):($t=.5/($p=Math.sqrt(1+$A-$Z-$f)),$Q[0]=($H+$n)*$t,$Q[1]=($B+$d)*$t,$Q[2]=.5*$p,$Q[3]=($i-$c)*$t)},$i.DEFAULT=new $i,$A($i,["TEMPVector30",function(){return this.TEMPVector30=new $cM},"TEMPVector31",function(){return this.TEMPVector31=new $cM},"TEMPVector32",function(){return this.TEMPVector32=new $cM},"TEMPVector33",function(){return this.TEMPVector33=new $cM},"TEMPMatrix0",function(){return this.TEMPMatrix0=new $IM},"TEMPMatrix1",function(){return this.TEMPMatrix1=new $IM},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new $UI},"NAN",function(){return this.NAN=new $i(NaN,NaN,NaN,NaN)}]),$i}(),$ZM=function(){function $I($I){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=$I,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}$p($I,"laya.d3.math.Rand");var $M=$I.prototype;return $M.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},$M.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},$M.getSignedFloat=function(){return 2*this.getFloat()-1},$t(0,$M,"seed",function(){return this.seeds[0]},function($I){this.seeds[0]=$I,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),$I.getFloatFromInt=function($I){return 1/8388607*(8388607&$I)},$I.getByteFromInt=function($I){return(8388607&$I)>>>15},$I}(),$iM=(function(){function $i($I){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!($I instanceof Array)||4!==$I.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|$I[0],this._state0L=0|$I[1],this._state1U=0|$I[2],this._state1L=0|$I[3]}$p($i,"laya.d3.math.RandX");var $I=$i.prototype;$I.randomint=function(){var $I=this._state0U,$M=this._state0L,$E=this._state1U,$Z=this._state1L,$i=($Z>>>0)+($M>>>0),$n=$E+$I+($i/2>>>31)>>>0,$c=$i>>>0,$f=0,$d=0;$f=($I^=$f=$I<<23|(-512&$M)>>>9)^(this._state0U=$E),$d=($M^=$d=$M<<23)^(this._state0L=$Z);$f^=$I>>>18,$d^=$M>>>18|(262143&$I)<<14;return $f^=$E>>>5,$d^=$Z>>>5|(31&$E)<<27,this._state1U=$f,this._state1L=$d,[$n,$c]},$I.random=function(){var $I=this.randomint(),$M=$I[0],$E=1023<<20|$M>>>12,$Z=0|($I[1]>>>12|(4095&$M)<<20);return $i._CONVERTION_BUFFER.setUint32(0,$E,!1),$i._CONVERTION_BUFFER.setUint32(4,$Z,!1),$ZM._CONVERTION_BUFFER.getFloat64(0,!1)-1},$A($i,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new $ZM([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function $I($I,$M){this.origin=null,this.direction=null,this.origin=$I,this.direction=$M}return $p($I,"laya.d3.math.Ray"),$I}()),$nM=function(){function $I($I,$M){this.elements=new Float32Array(2),void 0===$I&&($I=0),void 0===$M&&($M=0);var $E=this.elements;$E[0]=$I,$E[1]=$M}$p($I,"laya.d3.math.Vector2");var $M=$I.prototype;return $g.imps($M,{"laya.d3.core.IClone":!0}),$M.fromArray=function($I,$M){void 0===$M&&($M=0),this.elements[0]=$I[$M+0],this.elements[1]=$I[$M+1]},$M.cloneTo=function($I){var $M=$I.elements,$E=this.elements;$M[0]=$E[0],$M[1]=$E[1]},$M.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$M,"x",function(){return this.elements[0]},function($I){this.elements[0]=$I}),$t(0,$M,"y",function(){return this.elements[1]},function($I){this.elements[1]=$I}),$I.scale=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements;$Z[0]=$i[0]*$M,$Z[1]=$i[1]*$M},$A($I,["ZERO",function(){return this.ZERO=new $I(0,0)},"ONE",function(){return this.ONE=new $I(1,1)}]),$I}(),$cM=function(){function $B($I,$M,$E){this.elements=new Float32Array(3),void 0===$I&&($I=0),void 0===$M&&($M=0),void 0===$E&&($E=0);var $Z=this.elements;$Z[0]=$I,$Z[1]=$M,$Z[2]=$E}$p($B,"laya.d3.math.Vector3");var $I=$B.prototype;return $g.imps($I,{"laya.d3.core.IClone":!0}),$I.fromArray=function($I,$M){void 0===$M&&($M=0),this.elements[0]=$I[$M+0],this.elements[1]=$I[$M+1],this.elements[2]=$I[$M+2]},$I.cloneTo=function($I){var $M=$I.elements,$E=this.elements;$M[0]=$E[0],$M[1]=$E[1],$M[2]=$E[2]},$I.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$I.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},$I.reset=function($I,$M,$E){this.elements[0]=$I,this.elements[1]=$M,this.elements[2]=$E},$t(0,$I,"x",function(){return this.elements[0]},function($I){this.elements[0]=$I}),$t(0,$I,"y",function(){return this.elements[1]},function($I){this.elements[1]=$I}),$t(0,$I,"z",function(){return this.elements[2]},function($I){this.elements[2]=$I}),$B.distanceSquared=function($I,$M){var $E=$I.elements,$Z=$M.elements,$i=$E[0]-$Z[0],$n=$E[1]-$Z[1],$c=$E[2]-$Z[2];return $i*$i+$n*$n+$c*$c},$B.distance=function($I,$M){var $E=$I.elements,$Z=$M.elements,$i=$E[0]-$Z[0],$n=$E[1]-$Z[1],$c=$E[2]-$Z[2];return Math.sqrt($i*$i+$n*$n+$c*$c)},$B.min=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M.elements;$Z[0]=Math.min($i[0],$n[0]),$Z[1]=Math.min($i[1],$n[1]),$Z[2]=Math.min($i[2],$n[2])},$B.max=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M.elements;$Z[0]=Math.max($i[0],$n[0]),$Z[1]=Math.max($i[1],$n[1]),$Z[2]=Math.max($i[2],$n[2])},$B.transformQuat=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M.elements,$c=$i[0],$f=$i[1],$d=$i[2],$H=$n[0],$B=$n[1],$A=$n[2],$Q=$n[3],$p=$Q*$c+$B*$d-$A*$f,$t=$Q*$f+$A*$c-$H*$d,$V=$Q*$d+$H*$f-$B*$c,$u=-$H*$c-$B*$f-$A*$d;$Z[0]=$p*$Q+$u*-$H+$t*-$A-$V*-$B,$Z[1]=$t*$Q+$u*-$B+$V*-$H-$p*-$A,$Z[2]=$V*$Q+$u*-$A+$p*-$B-$t*-$H},$B.scalarLength=function($I){var $M=$I.elements,$E=$M[0],$Z=$M[1],$i=$M[2];return Math.sqrt($E*$E+$Z*$Z+$i*$i)},$B.scalarLengthSquared=function($I){var $M=$I.elements,$E=$M[0],$Z=$M[1],$i=$M[2];return $E*$E+$Z*$Z+$i*$i},$B.normalize=function($I,$M){var $E=$I.elements,$Z=$M.elements,$i=$E[0],$n=$E[1],$c=$E[2],$f=$i*$i+$n*$n+$c*$c;0<$f&&($f=1/Math.sqrt($f),$Z[0]=$E[0]*$f,$Z[1]=$E[1]*$f,$Z[2]=$E[2]*$f)},$B.multiply=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M.elements;$Z[0]=$i[0]*$n[0],$Z[1]=$i[1]*$n[1],$Z[2]=$i[2]*$n[2]},$B.scale=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements;$Z[0]=$i[0]*$M,$Z[1]=$i[1]*$M,$Z[2]=$i[2]*$M},$B.lerp=function($I,$M,$E,$Z){var $i=$Z.elements,$n=$I.elements,$c=$M.elements,$f=$n[0],$d=$n[1],$H=$n[2];$i[0]=$f+$E*($c[0]-$f),$i[1]=$d+$E*($c[1]-$d),$i[2]=$H+$E*($c[2]-$H)},$B.transformV3ToV3=function($I,$M,$E){var $Z=$B._tempVector4;$B.transformV3ToV4($I,$M,$Z);var $i=$Z.elements,$n=$E.elements;$n[0]=$i[0],$n[1]=$i[1],$n[2]=$i[2]},$B.transformV3ToV4=function($I,$M,$E){var $Z=$I.elements,$i=$Z[0],$n=$Z[1],$c=$Z[2],$f=$M.elements,$d=$E.elements;$d[0]=$i*$f[0]+$n*$f[4]+$c*$f[8]+$f[12],$d[1]=$i*$f[1]+$n*$f[5]+$c*$f[9]+$f[13],$d[2]=$i*$f[2]+$n*$f[6]+$c*$f[10]+$f[14],$d[3]=$i*$f[3]+$n*$f[7]+$c*$f[11]+$f[15]},$B.TransformNormal=function($I,$M,$E){var $Z=$I.elements,$i=$Z[0],$n=$Z[1],$c=$Z[2],$f=$M.elements,$d=$E.elements;$d[0]=$i*$f[0]+$n*$f[4]+$c*$f[8],$d[1]=$i*$f[1]+$n*$f[5]+$c*$f[9],$d[2]=$i*$f[2]+$n*$f[6]+$c*$f[10]},$B.transformCoordinate=function($I,$M,$E){var $Z=$B._tempVector4.elements,$i=$I.elements,$n=$i[0],$c=$i[1],$f=$i[2],$d=$M.elements;$Z[0]=$n*$d[0]+$c*$d[4]+$f*$d[8]+$d[12],$Z[1]=$n*$d[1]+$c*$d[5]+$f*$d[9]+$d[13],$Z[2]=$n*$d[2]+$c*$d[6]+$f*$d[10]+$d[14],$Z[3]=1/($n*$d[3]+$c*$d[7]+$f*$d[11]+$d[15]);var $H=$E.elements;$H[0]=$Z[0]*$Z[3],$H[1]=$Z[1]*$Z[3],$H[2]=$Z[2]*$Z[3]},$B.Clamp=function($I,$M,$E,$Z){var $i=$I.elements,$n=$i[0],$c=$i[1],$f=$i[2],$d=$M.elements,$H=$d[0],$B=$d[1],$A=$d[2],$Q=$E.elements,$p=$Q[0],$t=$Q[1],$V=$Q[2],$u=$Z.elements;$n=($n=$p<$n?$p:$n)<$H?$H:$n,$c=($c=$t<$c?$t:$c)<$B?$B:$c,$f=($f=$V<$f?$V:$f)<$A?$A:$f,$u[0]=$n,$u[1]=$c,$u[2]=$f},$B.add=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M.elements;$Z[0]=$i[0]+$n[0],$Z[1]=$i[1]+$n[1],$Z[2]=$i[2]+$n[2]},$B.subtract=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M.elements;$Z[0]=$i[0]-$n[0],$Z[1]=$i[1]-$n[1],$Z[2]=$i[2]-$n[2]},$B.cross=function($I,$M,$E){var $Z=$I.elements,$i=$M.elements,$n=$E.elements,$c=$Z[0],$f=$Z[1],$d=$Z[2],$H=$i[0],$B=$i[1],$A=$i[2];$n[0]=$f*$A-$d*$B,$n[1]=$d*$H-$c*$A,$n[2]=$c*$B-$f*$H},$B.dot=function($I,$M){var $E=$I.elements,$Z=$M.elements;return $E[0]*$Z[0]+$E[1]*$Z[1]+$E[2]*$Z[2]},$B.equals=function($I,$M){var $E=$I.elements,$Z=$M.elements;return $bI.nearEqual(Math.abs($E[0]),Math.abs($Z[0]))&&$bI.nearEqual(Math.abs($E[1]),Math.abs($Z[1]))&&$bI.nearEqual(Math.abs($E[2]),Math.abs($Z[2]))},$B.ZERO=new $B(0,0,0),$B.ONE=new $B(1,1,1),$B.NegativeUnitX=new $B(-1,0,0),$B.UnitX=new $B(1,0,0),$B.UnitY=new $B(0,1,0),$B.UnitZ=new $B(0,0,1),$B.ForwardRH=new $B(0,0,-1),$B.ForwardLH=new $B(0,0,1),$B.Up=new $B(0,1,0),$B.NAN=new $B(NaN,NaN,NaN),$A($B,["_tempVector4",function(){return this._tempVector4=new $fM}]),$B}(),$fM=function(){function $I($I,$M,$E,$Z){this.elements=new Float32Array(4),void 0===$I&&($I=0),void 0===$M&&($M=0),void 0===$E&&($E=0),void 0===$Z&&($Z=0);var $i=this.elements;$i[0]=$I,$i[1]=$M,$i[2]=$E,$i[3]=$Z}$p($I,"laya.d3.math.Vector4");var $M=$I.prototype;return $g.imps($M,{"laya.d3.core.IClone":!0}),$M.fromArray=function($I,$M){void 0===$M&&($M=0),this.elements[0]=$I[$M+0],this.elements[1]=$I[$M+1],this.elements[2]=$I[$M+2],this.elements[3]=$I[$M+3]},$M.cloneTo=function($I){var $M=$I.elements,$E=this.elements;$M[0]=$E[0],$M[1]=$E[1],$M[2]=$E[2],$M[3]=$E[3]},$M.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$M.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},$M.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},$t(0,$M,"x",function(){return this.elements[0]},function($I){this.elements[0]=$I}),$t(0,$M,"y",function(){return this.elements[1]},function($I){this.elements[1]=$I}),$t(0,$M,"z",function(){return this.elements[2]},function($I){this.elements[2]=$I}),$t(0,$M,"w",function(){return this.elements[3]},function($I){this.elements[3]=$I}),$I.lerp=function($I,$M,$E,$Z){var $i=$Z.elements,$n=$I.elements,$c=$M.elements,$f=$n[0],$d=$n[1],$H=$n[2],$B=$n[3];$i[0]=$f+$E*($c[0]-$f),$i[1]=$d+$E*($c[1]-$d),$i[2]=$H+$E*($c[2]-$H),$i[3]=$B+$E*($c[3]-$B)},$I.transformByM4x4=function($I,$M,$E){var $Z=$I.elements,$i=$Z[0],$n=$Z[1],$c=$Z[2],$f=$Z[3],$d=$M.elements,$H=$E.elements;$H[0]=$i*$d[0]+$n*$d[4]+$c*$d[8]+$f*$d[12],$H[1]=$i*$d[1]+$n*$d[5]+$c*$d[9]+$f*$d[13],$H[2]=$i*$d[2]+$n*$d[6]+$c*$d[10]+$f*$d[14],$H[3]=$i*$d[3]+$n*$d[7]+$c*$d[11]+$f*$d[15]},$I.equals=function($I,$M){var $E=$I.elements,$Z=$M.elements;return $bI.nearEqual(Math.abs($E[0]),Math.abs($Z[0]))&&$bI.nearEqual(Math.abs($E[1]),Math.abs($Z[1]))&&$bI.nearEqual(Math.abs($E[2]),Math.abs($Z[2]))&&$bI.nearEqual(Math.abs($E[3]),Math.abs($Z[3]))},$I.normalize=function($I,$M){var $E=$I.elements,$Z=$M.elements,$i=$I.length();0<$i&&($Z[0]=$E[0]*$i,$Z[1]=$E[1]*$i,$Z[2]=$E[2]*$i,$Z[3]=$E[3]*$i)},$I.add=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M.elements;$Z[0]=$i[0]+$n[0],$Z[1]=$i[1]+$n[1],$Z[2]=$i[2]+$n[2],$Z[3]=$i[3]+$n[3]},$I.subtract=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M.elements;$Z[0]=$i[0]-$n[0],$Z[1]=$i[1]-$n[1],$Z[2]=$i[2]-$n[2],$Z[3]=$i[3]-$n[3]},$I.multiply=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M.elements;$Z[0]=$i[0]*$n[0],$Z[1]=$i[1]*$n[1],$Z[2]=$i[2]*$n[2],$Z[3]=$i[3]*$n[3]},$I.scale=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements;$Z[0]=$i[0]*$M,$Z[1]=$i[1]*$M,$Z[2]=$i[2]*$M,$Z[3]=$i[3]*$M},$I.Clamp=function($I,$M,$E,$Z){var $i=$I.elements,$n=$i[0],$c=$i[1],$f=$i[2],$d=$i[3],$H=$M.elements,$B=$H[0],$A=$H[1],$Q=$H[2],$p=$H[3],$t=$E.elements,$V=$t[0],$u=$t[1],$N=$t[2],$y=$t[3],$$=$Z.elements;$n=($n=$V<$n?$V:$n)<$B?$B:$n,$c=($c=$u<$c?$u:$c)<$A?$A:$c,$f=($f=$N<$f?$N:$f)<$Q?$Q:$f,$d=($d=$y<$d?$y:$d)<$p?$p:$d,$$[0]=$n,$$[1]=$c,$$[2]=$f,$$[3]=$d},$I.distanceSquared=function($I,$M){var $E=$I.elements,$Z=$M.elements,$i=$E[0]-$Z[0],$n=$E[1]-$Z[1],$c=$E[2]-$Z[2],$f=$E[3]-$Z[3];return $i*$i+$n*$n+$c*$c+$f*$f},$I.distance=function($I,$M){var $E=$I.elements,$Z=$M.elements,$i=$E[0]-$Z[0],$n=$E[1]-$Z[1],$c=$E[2]-$Z[2],$f=$E[3]-$Z[3];return Math.sqrt($i*$i+$n*$n+$c*$c+$f*$f)},$I.dot=function($I,$M){var $E=$I.elements,$Z=$M.elements;return $E[0]*$Z[0]+$E[1]*$Z[1]+$E[2]*$Z[2]+$E[3]*$Z[3]},$I.min=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M.elements;$Z[0]=Math.min($i[0],$n[0]),$Z[1]=Math.min($i[1],$n[1]),$Z[2]=Math.min($i[2],$n[2]),$Z[3]=Math.min($i[3],$n[3])},$I.max=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M.elements;$Z[0]=Math.max($i[0],$n[0]),$Z[1]=Math.max($i[1],$n[1]),$Z[2]=Math.max($i[2],$n[2]),$Z[3]=Math.max($i[3],$n[3])},$A($I,["ZERO",function(){return this.ZERO=new $I},"ONE",function(){return this.ONE=new $I(1,1,1,1)},"UnitX",function(){return this.UnitX=new $I(1,0,0,0)},"UnitY",function(){return this.UnitY=new $I(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new $I(0,0,1,0)},"UnitW",function(){return this.UnitW=new $I(0,0,0,1)}]),$I}(),$dM=function(){function $n($I,$M,$E,$Z){this.minDepth=0,this.maxDepth=1,this.x=$I,this.y=$M,this.width=$E,this.height=$Z}$p($n,"laya.d3.math.Viewport");var $I=$n.prototype;return $I.project=function($I,$M,$E){$cM.transformV3ToV3($I,$M,$E);var $Z=$I.elements,$i=$M.elements,$n=$E.elements,$c=$Z[0]*$i[3]+$Z[1]*$i[7]+$Z[2]*$i[11]+$i[15];1!==$c&&($n[0]=$n[0]/$c,$n[1]=$n[1]/$c,$n[2]=$n[2]/$c),$n[0]=.5*($n[0]+1)*this.width+this.x,$n[1]=.5*(1-$n[1])*this.height+this.y,$n[2]=$n[2]*(this.maxDepth-this.minDepth)+this.minDepth},$I.unprojectFromMat=function($I,$M,$E){var $Z=$I.elements,$i=$M.elements,$n=$E.elements;$n[0]=($Z[0]-this.x)/this.width*2-1,$n[1]=-(($Z[1]-this.y)/this.height*2-1);var $c=(this.maxDepth-this.minDepth)/2;$n[2]=($Z[2]-this.minDepth-$c)/$c;var $f=$n[0]*$i[3]+$n[1]*$i[7]+$n[2]*$i[11]+$i[15];$cM.transformV3ToV3($E,$M,$E),1!==$f&&($n[0]=$n[0]/$f,$n[1]=$n[1]/$f,$n[2]=$n[2]/$f)},$I.unprojectFromWVP=function($I,$M,$E,$Z,$i){$IM.multiply($M,$E,$n._tempMatrix4x4),$Z&&$IM.multiply($n._tempMatrix4x4,$Z,$n._tempMatrix4x4),$n._tempMatrix4x4.invert($n._tempMatrix4x4),this.unprojectFromMat($I,$n._tempMatrix4x4,$i)},$A($n,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new $IM}]),$n}(),$HM=function(){function $v($I){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=$I,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}$p($v,"laya.d3.resource.models.SubMesh");var $I=$v.prototype;return $g.imps($I,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),$I._getVertexBuffer=function($I){return void 0===$I&&($I=0),0===$I?this._vertexBuffer:null},$I._getIndexBuffer=function(){return this._indexBuffer},$I._getStaticBatchBakedVertexs=function($I,$M){var $E,$Z,$i=this._vertexBuffer,$n=$i.vertexDeclaration,$c=$n.getVertexElementByUsage(0).offset/4,$f=$n.getVertexElementByUsage(3).offset/4,$d=$M.meshRender.lightmapScaleOffset,$H=0,$B=0,$A=0,$Q=0,$p=0,$t=0;if($d)if($Z=$n.getVertexElementByUsage(15))$A=$n.vertexStride/4,$E=0<this._vertexCount?$i.getData().slice(this._vertexStart*$A,(this._vertexStart+this._vertexCount)*$A):$i.getData().slice(),$Q=$Z.offset/4;else{$A=($t=$n.vertexStride/4)+2,$E=this._vertexCount?new Float32Array(this._vertexCount*($i.vertexDeclaration.vertexStride/4+2)):new Float32Array($i.vertexCount*($i.vertexDeclaration.vertexStride/4+2)),$Q=($p=$n.getVertexElementByUsage(2).offset/4)+2;var $V=$i.getData();for($H=0,$B=$V.length/$t;$H<$B;$H++){var $u=0;$u=0<this._vertexCount?(this._vertexStart+$H)*$t:$H*$t;var $N=$H*$A,$y=0;for($y=0;$y<$Q;$y++)$E[$N+$y]=$V[$u+$y];for($y=$Q;$y<$t;$y++)$E[$N+$y+2]=$V[$u+$y]}}else $A=$n.vertexStride/4,$E=this._vertexCount?$i.getData().slice(this._vertexStart*$A,(this._vertexStart+this._vertexCount)*$A):$i.getData().slice();if($I){var $$=$I.worldMatrix,$w=$v._tempMatrix4x40;$$.invert($w);var $g=$v._tempMatrix4x41,$O=$M.transform.worldMatrix;$IM.multiply($w,$O,$g)}else $g=$M.transform.worldMatrix;var $a=$v._tempQuaternion0;for($g.decomposeTransRotScale($v._tempVector30,$a,$v._tempVector31),$H=0,$B=$E.length/$A;$H<$B;$H++){var $m=$H*$A+$c,$j=$H*$A+$f;if($uM.transformVector3ArrayToVector3ArrayCoordinate($E,$m,$g,$E,$m),$uM.transformVector3ArrayByQuat($E,$j,$a,$E,$j),$d){var $T=$H*$A+$Q;if($Z)$uM.transformLightingMapTexcoordByUV1Array($E,$T,$d,$E,$T);else{var $q=$H*$t+$p;$uM.transformLightingMapTexcoordByUV0Array($V,$q,$d,$E,$T)}}}return $E},$I._getVertexBuffers=function(){return null},$I._beforeRender=function($I){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$I._render=function($I){var $M,$E=0,$Z=$I.renderElement;if(1<this._indexCount){var $i=this._boneIndicesList.length;if(1<$i){for(var $n=0;$n<$i;$n++)($M=$Z._skinAnimationDatas||this._skinAnimationDatas)&&($Z._shaderValue.setValue(0,$M[$n]),$I._shader.uploadRenderElementUniforms($Z._shaderValue.data)),$W.mainContext.drawElements(4,this._subIndexBufferCount[$n],5123,2*this._subIndexBufferStart[$n]);$m.drawCall+=$i}else($M=$Z._skinAnimationDatas||this._skinAnimationDatas)&&($Z._shaderValue.setValue(0,$M[0]),$I._shader.uploadRenderElementUniforms($Z._shaderValue.data)),$W.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),$m.drawCall++;$E=this._indexCount}else $E=this._indexBuffer.indexCount,($M=$Z._skinAnimationDatas||this._skinAnimationDatas)&&($Z._shaderValue.setValue(0,$M[0]),$I._shader.uploadRenderElementUniforms($Z._shaderValue.data)),$W.mainContext.drawElements(4,$E,5123,0),$m.drawCall++;$m.trianglesFaces+=$E/3},$I.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},$I.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},$t(0,$I,"_vertexBufferCount",function(){return 1}),$t(0,$I,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$A($v,["_tempVector30",function(){return this._tempVector30=new $cM},"_tempVector31",function(){return this._tempVector31=new $cM},"_tempQuaternion0",function(){return this._tempQuaternion0=new $EM},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new $IM},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new $IM}]),$v}(),$BM=function(){function $I($I){this.defineCounter=0,this.defines=null,$I?(this.defineCounter=$I.defineCounter,this.defines=$I.defines.slice()):(this.defineCounter=0,this.defines=[])}return $p($I,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),$I.prototype.registerDefine=function($I){var $M=Math.pow(2,this.defineCounter++);return this.defines[$M]=$I,$M},$I}(),$AM=function(){function $I(){}return $p($I,"laya.d3.shader.ShaderInit3D"),$I.__init__=function(){var $I,$M;$mM._globalRegDefine("HIGHPRECISION",$mM.SHADERDEFINE_HIGHPRECISION),$mM._globalRegDefine("FOG",$mM.SHADERDEFINE_FOG),$mM._globalRegDefine("DIRECTIONLIGHT",$mM.SHADERDEFINE_DIRECTIONLIGHT),$mM._globalRegDefine("POINTLIGHT",$mM.SHADERDEFINE_POINTLIGHT),$mM._globalRegDefine("SPOTLIGHT",$mM.SHADERDEFINE_SPOTLIGHT),$mM._globalRegDefine("UV",$mM.SHADERDEFINE_UV0),$mM._globalRegDefine("COLOR",$mM.SHADERDEFINE_COLOR),$mM._globalRegDefine("UV1",$mM.SHADERDEFINE_UV1),$mM._globalRegDefine("CASTSHADOW",$pM.SHADERDEFINE_CAST_SHADOW),$mM._globalRegDefine("SHADOWMAP_PSSM1",$pM.SHADERDEFINE_SHADOW_PSSM1),$mM._globalRegDefine("SHADOWMAP_PSSM2",$pM.SHADERDEFINE_SHADOW_PSSM2),$mM._globalRegDefine("SHADOWMAP_PSSM3",$pM.SHADERDEFINE_SHADOW_PSSM3),$mM._globalRegDefine("SHADOWMAP_PCF_NO",$pM.SHADERDEFINE_SHADOW_PCF_NO),$mM._globalRegDefine("SHADOWMAP_PCF1",$pM.SHADERDEFINE_SHADOW_PCF1),$mM._globalRegDefine("SHADOWMAP_PCF2",$pM.SHADERDEFINE_SHADOW_PCF2),$mM._globalRegDefine("SHADOWMAP_PCF3",$pM.SHADERDEFINE_SHADOW_PCF3),$mM._globalRegDefine("DEPTHFOG",$mM.SAHDERDEFINE_DEPTHFOG),$XM.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),$XM.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),$I={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},$M={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var $E=$XM.nameKey.add("SIMPLE");shaderCompile=$mM.add($E,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',$I,$M),$CM.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),$CM.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),$CM.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),$CM.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),$CM.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),$CM.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),$CM.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),$CM.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),$CM.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},$I}(),$QM=function(){function $I(){this._data=null,this._data=[]}$p($I,"laya.d3.shader.ValusArray");var $M=$I.prototype;return $M.setValue=function($I,$M){this._data[$I]=$M},$t(0,$M,"data",function(){return this._data}),$I}(),$pM=function(){function $I(){}return $I.SHADERDEFINE_RECEIVE_SHADOW=1,$I.SHADERDEFINE_CAST_SHADOW=512,$I.SHADERDEFINE_SHADOW_PSSM1=1024,$I.SHADERDEFINE_SHADOW_PSSM2=2048,$I.SHADERDEFINE_SHADOW_PSSM3=4096,$I.SHADERDEFINE_SHADOW_PCF_NO=8192,$I.SHADERDEFINE_SHADOW_PCF1=16384,$I.SHADERDEFINE_SHADOW_PCF2=32768,$I.SHADERDEFINE_SHADOW_PCF3=65536,$I.MAX_PSSM_COUNT=3,$I}(),$tM=function(){function $D(){}return $p($D,"laya.d3.utils.Picker"),$D.calculateCursorRay=function($I,$M,$E,$Z,$i,$n){var $c=$I.elements[0],$f=$I.elements[1],$d=$D._tempVector30,$H=$d.elements;$H[0]=$c,$H[1]=$f,$H[2]=$M.minDepth;var $B=$D._tempVector31,$A=$B.elements;$A[0]=$c,$A[1]=$f,$A[2]=$M.maxDepth;var $Q=$n.origin,$p=$D._tempVector32;$M.unprojectFromWVP($d,$E,$Z,$i,$Q),$M.unprojectFromWVP($B,$E,$Z,$i,$p);var $t=$n.direction.elements;$t[0]=$p.x-$Q.x,$t[1]=$p.y-$Q.y,$t[2]=$p.z-$Q.z,$cM.normalize($n.direction,$n.direction)},$D.rayIntersectsPositionsAndIndices=function($I,$M,$E,$Z,$i){for(var $n=$E.vertexStride/4,$c=$E.getVertexElementByUsage(0).offset/4,$f=Number.MAX_VALUE,$d=-1,$H=-1,$B=-1,$A=0;$A<$Z.length;$A+=3){var $Q=$D._tempVector35,$p=$Q.elements,$t=$Z[$A]*$n,$V=$t+$c;$p[0]=$M[$V],$p[1]=$M[1+$V],$p[2]=$M[2+$V];var $u=$D._tempVector36,$N=$u.elements,$y=$Z[$A+1]*$n,$$=$y+$c;$N[0]=$M[$$],$N[1]=$M[1+$$],$N[2]=$M[2+$$];var $w=$D._tempVector37,$g=$w.elements,$O=$Z[$A+2]*$n,$a=$O+$c;$g[0]=$M[$a],$g[1]=$M[1+$a],$g[2]=$M[2+$a];var $m=laya.d3.utils.Picker.rayIntersectsTriangle($I,$Q,$u,$w);!isNaN($m)&&$m<$f&&($f=$m,$d=$t,$H=$y,$B=$O)}if($f===Number.MAX_VALUE)return $i.position.toDefault(),$i.distance=Number.MAX_VALUE,$i.trianglePositions[0].toDefault(),$i.trianglePositions[1].toDefault(),$i.trianglePositions[2].toDefault(),$i.triangleNormals[0].toDefault(),$i.triangleNormals[1].toDefault(),$i.triangleNormals[2].toDefault(),!1;$i.distance=$f,$cM.scale($I.direction,$f,$i.position),$cM.add($I.origin,$i.position,$i.position);var $j=$i.trianglePositions,$T=$j[0],$q=$j[1],$v=$j[2],$W=$T.elements,$R=$q.elements,$z=$v.elements,$L=$d+$c;$W[0]=$M[$L],$W[1]=$M[$L+1],$W[2]=$M[$L+2];var $o=$H+$c;$R[0]=$M[$o],$R[1]=$M[$o+1],$R[2]=$M[$o+2];var $S=$B+$c;$z[0]=$M[$S],$z[1]=$M[$S+1],$z[2]=$M[$S+2];var $X=$E.getVertexElementByUsage(3);if($X){var $C=$X.offset/4,$J=$i.triangleNormals,$x=$J[0],$k=$J[1],$r=$J[2],$l=$x.elements,$F=$k.elements,$e=$r.elements,$_=$d+$C;$l[0]=$M[$_],$l[1]=$M[$_+1],$l[2]=$M[$_+2];var $h=$H+$C;$F[0]=$M[$h],$F[1]=$M[$h+1],$F[2]=$M[$h+2];var $P=$B+$C;$e[0]=$M[$P],$e[1]=$M[$P+1],$e[2]=$M[$P+2]}return!0},$D.rayIntersectsTriangle=function($I,$M,$E,$Z){var $i=$D._tempVector30,$n=$D._tempVector31;$cM.subtract($E,$M,$i),$cM.subtract($Z,$M,$n);var $c,$f=$D._tempVector32;if($cM.cross($I.direction,$n,$f),($c=$cM.dot($i,$f))>-Number.MIN_VALUE&&$c<Number.MIN_VALUE)return Number.NaN;var $d,$H=1/$c,$B=$D._tempVector33;if($cM.subtract($I.origin,$M,$B),$d=$cM.dot($B,$f),($d*=$H)<0||1<$d)return Number.NaN;var $A,$Q,$p=$D._tempVector34;return $cM.cross($B,$i,$p),$A=$cM.dot($I.direction,$p),($A*=$H)<0||1<$d+$A?Number.NaN:($Q=$cM.dot($n,$p),($Q*=$H)<0?Number.NaN:$Q)},$A($D,["_tempVector30",function(){return this._tempVector30=new $cM},"_tempVector31",function(){return this._tempVector31=new $cM},"_tempVector32",function(){return this._tempVector32=new $cM},"_tempVector33",function(){return this._tempVector33=new $cM},"_tempVector34",function(){return this._tempVector34=new $cM},"_tempVector35",function(){return this._tempVector35=new $cM},"_tempVector36",function(){return this._tempVector36=new $cM},"_tempVector37",function(){return this._tempVector37=new $cM}]),$D}(),$VM=(function(){function $I(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new $cM,new $cM,new $cM],this.trianglePositions.length=3,this.triangleNormals=[new $cM,new $cM,new $cM],this.triangleNormals.length=3,this.position=new $cM}$p($I,"laya.d3.utils.RaycastHit"),$I.prototype.cloneTo=function($I){$I.distance=this.distance,this.trianglePositions[0].cloneTo($I.trianglePositions[0]),this.trianglePositions[1].cloneTo($I.trianglePositions[1]),this.trianglePositions[2].cloneTo($I.trianglePositions[2]),this.triangleNormals[0].cloneTo($I.triangleNormals[0]),this.triangleNormals[1].cloneTo($I.triangleNormals[1]),this.triangleNormals[2].cloneTo($I.triangleNormals[2]),this.position.cloneTo($I.position),$I.sprite3D=this.sprite3D}}(),function(){function $I($I,$M){this._width=0,this._height=0,this._width=$I,this._height=$M}$p($I,"laya.d3.utils.Size");var $M=$I.prototype;return $t(0,$M,"width",function(){return-1===this._width?$G.clientWidth:this._width}),$t(0,$M,"height",function(){return-1===this._height?$G.clientHeight:this._height}),$t(1,$I,"fullScreen",function(){return new $I(-1,-1)}),$I}()),$uM=function(){function $L(){}return $p($L,"laya.d3.utils.Utils3D"),$L._rotationTransformScaleSkinAnimation=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B,$A){var $Q,$p,$t,$V,$u,$N=$L._tempArray16_0,$y=$L._tempArray16_1,$$=$L._tempArray16_2,$w=$Z+$Z,$g=$i+$i,$O=$n+$n,$a=$Z*$w,$m=$i*$w,$j=$i*$g,$T=$n*$w,$q=$n*$g,$v=$n*$O,$W=$c*$w,$R=$c*$g,$z=$c*$O;for($N[15]=1,$N[0]=1-$j-$v,$N[1]=$m+$z,$N[2]=$T-$R,$N[4]=$m-$z,$N[5]=1-$a-$v,$N[6]=$q+$W,$N[8]=$T+$R,$N[9]=$q-$W,$N[10]=1-$a-$j,$y[15]=1,$y[0]=$f,$y[5]=$d,$y[10]=$H,$Q=0;$Q<4;$Q++)$p=$N[$Q],$t=$N[$Q+4],$V=$N[$Q+8],$u=$N[$Q+12],$$[$Q]=$p,$$[$Q+4]=$t,$$[$Q+8]=$V,$$[$Q+12]=$p*$I+$t*$M+$V*$E+$u;for($Q=0;$Q<4;$Q++)$p=$$[$Q],$t=$$[$Q+4],$V=$$[$Q+8],$u=$$[$Q+12],$B[$Q+$A]=$p*$y[0]+$t*$y[1]+$V*$y[2]+$u*$y[3],$B[$Q+$A+4]=$p*$y[4]+$t*$y[5]+$V*$y[6]+$u*$y[7],$B[$Q+$A+8]=$p*$y[8]+$t*$y[9]+$V*$y[10]+$u*$y[11],$B[$Q+$A+12]=$p*$y[12]+$t*$y[13]+$V*$y[14]+$u*$y[15]},$L._createNodeByJson=function($I,$M,$E,$Z){if(!$E)switch($M.type){case"Sprite3D":$E=new $SM;break;case"MeshSprite3D":$E=new $DM;break;case"SkinnedMeshSprite3D":$E=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":$E=new ShuriKenParticle3D;break;case"TrailSprite3D":$E=new TrailSprite3D;break;case"Terrain":$E=new Terrain;break;case"Camera":$E=new $PM;break;case"DirectionLight":$E=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var $i=$M.props;if($i)for(var $n in $i)$E[$n]=$i[$n];var $c=$M.customProps;$c&&($E instanceof laya.d3.core.Sprite3D?($E._parseBaseCustomProps($c),$E._parseCustomProps($I,$Z,$c,$M),$E._parseCustomComponent($I,$Z,$M.components)):$E._parseCustomProps($I,$Z,$c,$M));var $f=$M.child;if($f)for(var $d=0,$H=$f.length;$d<$H;$d++){var $B=$L._createNodeByJson($I,$f[$d],null,$Z);$E.addChild($B)}return $E},$L._computeBoneAndAnimationDatasByBindPoseMatrxix=function($I,$M,$E,$Z,$i,$n){var $c,$f,$d=0,$H=0,$B=$I.length;for($c=0;$c<$B;$d+=$I[$c].keyframeWidth,$H+=16,$c++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($M[$d+0],$M[$d+1],$M[$d+2],$M[$d+3],$M[$d+4],$M[$d+5],$M[$d+6],$M[$d+7],$M[$d+8],$M[$d+9],$Z,$H),0!=$c&&($f=16*$I[$c].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($Z,$f,$Z,$H,$Z,$H));var $A=$E.length;for($c=0;$c<$A;$c++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($Z,16*$n[$c],$E[$c],$i,16*$c)},$L._computeAnimationDatasByArrayAndMatrixFast=function($I,$M,$E,$Z){for(var $i=0,$n=$I.length;$i<$n;$i++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($M,16*$Z[$i],$I[$i],$E,16*$i)},$L._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function($I,$M,$E,$Z,$i){var $n,$c,$f=0,$d=0,$H=$I.length;for($n=0;$n<$H;$f+=$I[$n].keyframeWidth,$d+=16,$n++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation($M[$f+7],$M[$f+8],$M[$f+9],$M[$f+3],$M[$f+4],$M[$f+5],$M[$f+6],$M[$f+0],$M[$f+1],$M[$f+2],$Z,$d),0!=$n&&($c=16*$I[$n].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray($Z,$c,$Z,$d,$Z,$d));var $B=$E.length;for($n=0;$n<$B;$n++){var $A=16*$n;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($Z,$A,$E[$n],$i,$A)}},$L._computeAnimationDatasByArrayAndMatrixFastOld=function($I,$M,$E){for(var $Z=$I.length,$i=0;$i<$Z;$i++){var $n=16*$i;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast($M,$n,$I[$i],$E,$n)}},$L._computeRootAnimationData=function($I,$M,$E){for(var $Z=0,$i=0,$n=0,$c=$I.length;$Z<$c;$i+=$I[$Z].keyframeWidth,$n+=16,$Z++)laya.d3.utils.Utils3D.createAffineTransformationArray($M[$i+0],$M[$i+1],$M[$i+2],$M[$i+3],$M[$i+4],$M[$i+5],$M[$i+6],$M[$i+7],$M[$i+8],$M[$i+9],$E,$n)},$L.transformVector3ArrayByQuat=function($I,$M,$E,$Z,$i){var $n=$E.elements,$c=$I[$M],$f=$I[$M+1],$d=$I[$M+2],$H=$n[0],$B=$n[1],$A=$n[2],$Q=$n[3],$p=$Q*$c+$B*$d-$A*$f,$t=$Q*$f+$A*$c-$H*$d,$V=$Q*$d+$H*$f-$B*$c,$u=-$H*$c-$B*$f-$A*$d;$Z[$i]=$p*$Q+$u*-$H+$t*-$A-$V*-$B,$Z[$i+1]=$t*$Q+$u*-$B+$V*-$H-$p*-$A,$Z[$i+2]=$V*$Q+$u*-$A+$p*-$B-$t*-$H},$L.mulMatrixByArray=function($I,$M,$E,$Z,$i,$n){var $c,$f,$d,$H,$B;if($i===$E){for($E=$L._tempArray16_3,$c=0;$c<16;++$c)$E[$c]=$i[$n+$c];$Z=0}for($c=0;$c<4;$c++)$f=$I[$M+$c],$d=$I[$M+$c+4],$H=$I[$M+$c+8],$B=$I[$M+$c+12],$i[$n+$c]=$f*$E[$Z+0]+$d*$E[$Z+1]+$H*$E[$Z+2]+$B*$E[$Z+3],$i[$n+$c+4]=$f*$E[$Z+4]+$d*$E[$Z+5]+$H*$E[$Z+6]+$B*$E[$Z+7],$i[$n+$c+8]=$f*$E[$Z+8]+$d*$E[$Z+9]+$H*$E[$Z+10]+$B*$E[$Z+11],$i[$n+$c+12]=$f*$E[$Z+12]+$d*$E[$Z+13]+$H*$E[$Z+14]+$B*$E[$Z+15]},$L.mulMatrixByArrayFast=function($I,$M,$E,$Z,$i,$n){var $c,$f,$d,$H,$B;for($c=0;$c<4;$c++)$f=$I[$M+$c],$d=$I[$M+$c+4],$H=$I[$M+$c+8],$B=$I[$M+$c+12],$i[$n+$c]=$f*$E[$Z+0]+$d*$E[$Z+1]+$H*$E[$Z+2]+$B*$E[$Z+3],$i[$n+$c+4]=$f*$E[$Z+4]+$d*$E[$Z+5]+$H*$E[$Z+6]+$B*$E[$Z+7],$i[$n+$c+8]=$f*$E[$Z+8]+$d*$E[$Z+9]+$H*$E[$Z+10]+$B*$E[$Z+11],$i[$n+$c+12]=$f*$E[$Z+12]+$d*$E[$Z+13]+$H*$E[$Z+14]+$B*$E[$Z+15]},$L.mulMatrixByArrayAndMatrixFast=function($I,$M,$E,$Z,$i){var $n,$c,$f,$d,$H,$B=$E.elements,$A=$B[0],$Q=$B[1],$p=$B[2],$t=$B[3],$V=$B[4],$u=$B[5],$N=$B[6],$y=$B[7],$$=$B[8],$w=$B[9],$g=$B[10],$O=$B[11],$a=$B[12],$m=$B[13],$j=$B[14],$T=$B[15],$q=$M,$v=$M+4,$W=$M+8,$R=$M+12,$z=$i,$L=$i+4,$o=$i+8,$S=$i+12;for($n=0;$n<4;$n++)$c=$I[$q+$n],$f=$I[$v+$n],$d=$I[$W+$n],$H=$I[$R+$n],$Z[$z+$n]=$c*$A+$f*$Q+$d*$p+$H*$t,$Z[$L+$n]=$c*$V+$f*$u+$d*$N+$H*$y,$Z[$o+$n]=$c*$$+$f*$w+$d*$g+$H*$O,$Z[$S+$n]=$c*$a+$f*$m+$d*$j+$H*$T},$L.createAffineTransformationArray=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B,$A){var $Q=$Z+$Z,$p=$i+$i,$t=$n+$n,$V=$Z*$Q,$u=$Z*$p,$N=$Z*$t,$y=$i*$p,$$=$i*$t,$w=$n*$t,$g=$c*$Q,$O=$c*$p,$a=$c*$t;$B[$A+0]=(1-($y+$w))*$f,$B[$A+1]=($u+$a)*$f,$B[$A+2]=($N-$O)*$f,$B[$A+3]=0,$B[$A+4]=($u-$a)*$d,$B[$A+5]=(1-($V+$w))*$d,$B[$A+6]=($$+$g)*$d,$B[$A+7]=0,$B[$A+8]=($N+$O)*$H,$B[$A+9]=($$-$g)*$H,$B[$A+10]=(1-($V+$y))*$H,$B[$A+11]=0,$B[$A+12]=$I,$B[$A+13]=$M,$B[$A+14]=$E,$B[$A+15]=1},$L.transformVector3ArrayToVector3ArrayCoordinate=function($I,$M,$E,$Z,$i){var $n=$L._tempArray4_0,$c=$I[$M+0],$f=$I[$M+1],$d=$I[$M+2],$H=$E.elements;$n[0]=$c*$H[0]+$f*$H[4]+$d*$H[8]+$H[12],$n[1]=$c*$H[1]+$f*$H[5]+$d*$H[9]+$H[13],$n[2]=$c*$H[2]+$f*$H[6]+$d*$H[10]+$H[14],$n[3]=1/($c*$H[3]+$f*$H[7]+$d*$H[11]+$H[15]),$Z[$i+0]=$n[0]*$n[3],$Z[$i+1]=$n[1]*$n[3],$Z[$i+2]=$n[2]*$n[3]},$L.transformLightingMapTexcoordByUV0Array=function($I,$M,$E,$Z,$i){var $n=$E.elements;$Z[$i+0]=$I[$M+0]*$n[0]+$n[2],$Z[$i+1]=($I[$M+1]-1)*$n[1]+$n[3]},$L.transformLightingMapTexcoordByUV1Array=function($I,$M,$E,$Z,$i){var $n=$E.elements;$Z[$i+0]=$I[$M+0]*$n[0]+$n[2],$Z[$i+1]=1+$I[$M+1]*$n[1]+$n[3]},$L.getURLVerion=function($I){var $M=$I.indexOf("?");return 0<=$M?$I.substr($M):null},$L._quaternionCreateFromYawPitchRollArray=function($I,$M,$E,$Z){var $i=.5*$E,$n=.5*$M,$c=.5*$I,$f=Math.sin($i),$d=Math.cos($i),$H=Math.sin($n),$B=Math.cos($n),$A=Math.sin($c),$Q=Math.cos($c);$Z[0]=$Q*$H*$d+$A*$B*$f,$Z[1]=$A*$B*$d-$Q*$H*$f,$Z[2]=$Q*$B*$f-$A*$H*$d,$Z[3]=$Q*$B*$d+$A*$H*$f},$L._createAffineTransformationArray=function($I,$M,$E,$Z){var $i=$M[0],$n=$M[1],$c=$M[2],$f=$M[3],$d=$i+$i,$H=$n+$n,$B=$c+$c,$A=$i*$d,$Q=$i*$H,$p=$i*$B,$t=$n*$H,$V=$n*$B,$u=$c*$B,$N=$f*$d,$y=$f*$H,$$=$f*$B,$w=$E[0],$g=$E[1],$O=$E[2];$Z[0]=(1-($t+$u))*$w,$Z[1]=($Q+$$)*$w,$Z[2]=($p-$y)*$w,$Z[3]=0,$Z[4]=($Q-$$)*$g,$Z[5]=(1-($A+$u))*$g,$Z[6]=($V+$N)*$g,$Z[7]=0,$Z[8]=($p+$y)*$O,$Z[9]=($V-$N)*$O,$Z[10]=(1-($A+$t))*$O,$Z[11]=0,$Z[12]=$I[0],$Z[13]=$I[1],$Z[14]=$I[2],$Z[15]=1},$L._mulMatrixArray=function($I,$M,$E,$Z){var $i,$n,$c,$f,$d,$H=$M.elements,$B=$H[0],$A=$H[1],$Q=$H[2],$p=$H[3],$t=$H[4],$V=$H[5],$u=$H[6],$N=$H[7],$y=$H[8],$$=$H[9],$w=$H[10],$g=$H[11],$O=$H[12],$a=$H[13],$m=$H[14],$j=$H[15],$T=$Z,$q=$Z+4,$v=$Z+8,$W=$Z+12;for($i=0;$i<4;$i++)$n=$I[$i],$c=$I[$i+4],$f=$I[$i+8],$d=$I[$i+12],$E[$T+$i]=$n*$B+$c*$A+$f*$Q+$d*$p,$E[$q+$i]=$n*$t+$c*$V+$f*$u+$d*$N,$E[$v+$i]=$n*$y+$c*$$+$f*$w+$d*$g,$E[$W+$i]=$n*$O+$c*$a+$f*$m+$d*$j},$L.getYawPitchRoll=function($I,$M){$L.transformQuat($cM.ForwardRH,$I,$EM.TEMPVector31),$L.transformQuat($cM.Up,$I,$EM.TEMPVector32);var $E=$EM.TEMPVector32.elements;$L.angleTo($cM.ZERO,$EM.TEMPVector31,$EM.TEMPVector33);var $Z=$EM.TEMPVector33.elements;$Z[0]==Math.PI/2?($Z[1]=$L.arcTanAngle($E[2],$E[0]),$Z[2]=0):$Z[0]==-Math.PI/2?($Z[1]=$L.arcTanAngle(-$E[2],-$E[0]),$Z[2]=0):($IM.createRotationY(-$Z[1],$EM.TEMPMatrix0),$IM.createRotationX(-$Z[0],$EM.TEMPMatrix1),$cM.transformCoordinate($EM.TEMPVector32,$EM.TEMPMatrix0,$EM.TEMPVector32),$cM.transformCoordinate($EM.TEMPVector32,$EM.TEMPMatrix1,$EM.TEMPVector32),$Z[2]=$L.arcTanAngle($E[1],-$E[0])),$Z[1]<=-Math.PI&&($Z[1]=Math.PI),$Z[2]<=-Math.PI&&($Z[2]=Math.PI),$Z[1]>=Math.PI&&$Z[2]>=Math.PI&&($Z[1]=0,$Z[2]=0,$Z[0]=Math.PI-$Z[0]),$M[0]=$Z[1],$M[1]=$Z[0],$M[2]=$Z[2]},$L.arcTanAngle=function($I,$M){return 0==$I?1==$M?Math.PI/2:-Math.PI/2:0<$I?Math.atan($M/$I):$I<0?0<$M?Math.atan($M/$I)+Math.PI:Math.atan($M/$I)-Math.PI:0},$L.angleTo=function($I,$M,$E){$cM.subtract($M,$I,$EM.TEMPVector30),$cM.normalize($EM.TEMPVector30,$EM.TEMPVector30),$E.elements[0]=Math.asin($EM.TEMPVector30.y),$E.elements[1]=$L.arcTanAngle(-$EM.TEMPVector30.z,-$EM.TEMPVector30.x)},$L.transformQuat=function($I,$M,$E){var $Z=$E.elements,$i=$I.elements,$n=$M,$c=$i[0],$f=$i[1],$d=$i[2],$H=$n[0],$B=$n[1],$A=$n[2],$Q=$n[3],$p=$Q*$c+$B*$d-$A*$f,$t=$Q*$f+$A*$c-$H*$d,$V=$Q*$d+$H*$f-$B*$c,$u=-$H*$c-$B*$f-$A*$d;$Z[0]=$p*$Q+$u*-$H+$t*-$A-$V*-$B,$Z[1]=$t*$Q+$u*-$B+$V*-$H-$p*-$A,$Z[2]=$V*$Q+$u*-$A+$p*-$B-$t*-$H},$L.quaterionNormalize=function($I,$M){var $E=$I[0],$Z=$I[1],$i=$I[2],$n=$I[3],$c=$E*$E+$Z*$Z+$i*$i+$n*$n;0<$c&&($c=1/Math.sqrt($c),$M[0]=$E*$c,$M[1]=$Z*$c,$M[2]=$i*$c,$M[3]=$n*$c)},$L.matrix4x4MultiplyFFF=function($I,$M,$E){var $Z,$i,$n,$c,$f;if($E===$M)for($M=new Float32Array(16),$Z=0;$Z<16;++$Z)$M[$Z]=$E[$Z];for($Z=0;$Z<4;$Z++)$i=$I[$Z],$n=$I[$Z+4],$c=$I[$Z+8],$f=$I[$Z+12],$E[$Z]=$i*$M[0]+$n*$M[1]+$c*$M[2]+$f*$M[3],$E[$Z+4]=$i*$M[4]+$n*$M[5]+$c*$M[6]+$f*$M[7],$E[$Z+8]=$i*$M[8]+$n*$M[9]+$c*$M[10]+$f*$M[11],$E[$Z+12]=$i*$M[12]+$n*$M[13]+$c*$M[14]+$f*$M[15]},$L.matrix4x4MultiplyMFM=function($I,$M,$E){$L.matrix4x4MultiplyFFF($I.elements,$M,$E.elements)},$A($L,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new $cM},"_tempVector3_1",function(){return this._tempVector3_1=new $cM},"_tempVector3_2",function(){return this._tempVector3_2=new $cM},"_tempVector3_3",function(){return this._tempVector3_3=new $cM},"_tempVector3_4",function(){return this._tempVector3_4=new $cM},"_tempVector3_5",function(){return this._tempVector3_5=new $cM},"_tempVector3_6",function(){return this._tempVector3_6=new $cM},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),$L}(),$NM=function(){function $R(){}return $p($R,"Laya3D"),$R._cancelLoadByUrl=function($I){$g.loader.cancelLoadByUrl($I),$R._innerFirstLevelLoaderManager.cancelLoadByUrl($I),$R._innerSecondLevelLoaderManager.cancelLoadByUrl($I),$R._innerThirdLevelLoaderManager.cancelLoadByUrl($I),$R._innerFourthLevelLoaderManager.cancelLoadByUrl($I)},$R._changeWebGLSize=function($I,$M){$W.onStageResize($I,$M),$G.clientWidth=$I,$G.clientHeight=$M},$R.__init__=function(){var $I=$M.createMap;$I.lh=[$SM,"SPRITE3DHIERARCHY"],$I.ls=[$oM,"SPRITE3DHIERARCHY"],$I.lm=[$lM,"MESH"],$I.lmat=[$CM,"MATERIAL"],$I.jpg=[$eM,"nativeimage"],$I.jpeg=[$eM,"nativeimage"],$I.png=[$eM,"nativeimage"],$I.pkm=[$eM,"arraybuffer"],$I.raw=[$kM,"arraybuffer"],$I.mipmaps=[$kM,"arraybuffer"],$N.parserMap.SPRITE3DHIERARCHY=$R._loadHierarchy,$N.parserMap.MESH=$R._loadMesh,$N.parserMap.MATERIAL=$R._loadMaterial,$N.parserMap.TEXTURECUBE=$R._loadTextureCube,$N.parserMap.TERRAIN=$R._loadTerrain,$R._innerFirstLevelLoaderManager.on("error",null,$R._eventLoadManagerError),$R._innerSecondLevelLoaderManager.on("error",null,$R._eventLoadManagerError),$R._innerThirdLevelLoaderManager.on("error",null,$R._eventLoadManagerError),$R._innerFourthLevelLoaderManager.on("error",null,$R._eventLoadManagerError)},$R.READ_BLOCK=function(){return $R._readData.pos+=4,!0},$R.READ_DATA=function(){return $R._DATA.offset=$R._readData.getUint32(),$R._DATA.size=$R._readData.getUint32(),!0},$R.READ_STRINGS=function(){var $I=[],$M={offset:0,size:0};$M.offset=$R._readData.getUint16(),$M.size=$R._readData.getUint16();$R._readData.pos;$R._readData.pos=$M.offset+$R._DATA.offset;for(var $E=0;$E<$M.size;$E++){var $Z=$R._readData.readUTFString();-1===$Z.lastIndexOf(".lmat")&&-1===$Z.lastIndexOf(".lpbr")||$I.push($Z)}return $I},$R.formatRelativePath=function($I,$M){var $E;if("."===$M.charAt(0)){for(var $Z=($I+$M).split("/"),$i=0,$n=$Z.length;$i<$n;$i++)if(".."==$Z[$i]){var $c=$i-1;0<$c&&".."!==$Z[$c]&&($Z.splice($c,2),$i-=2)}$E=$Z.join("/")}else $E=$I+$M;return null!=$v.customFormat&&($E=$v.customFormat($E,null)),$E},$R._eventLoadManagerError=function($I){$g.loader.event("error",$I)},$R._addHierarchyInnerUrls=function($I,$M,$E,$Z,$i,$n){var $c=$R.formatRelativePath($Z,$i);$E&&($c+=$E),$I.push({url:$c,clas:$n}),$M[$i]=$c},$R._getSprite3DHierarchyInnerUrls=function($I,$M,$E,$Z,$i,$n,$c){var $f,$d=0,$H=0;switch($I.type){case"Scene":var $B=$I.customProps.lightmaps;for($d=0,$H=$B.length;$d<$H;$d++){var $A=$B[$d].replace(".exr",".png");$R._addHierarchyInnerUrls($Z,$i,$n,$c,$A,$eM)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var $Q;if($I.instanceParams)($Q=$I.instanceParams.loadPath)&&$R._addHierarchyInnerUrls($M,$i,$n,$c,$Q,$lM);else{($Q=($f=$I.customProps).meshPath)&&$R._addHierarchyInnerUrls($M,$i,$n,$c,$Q,$lM);var $p=$f.materials;if($p)for($d=0,$H=$p.length;$d<$H;$d++){for(var $t=$p[$d],$V=$t.type.split("."),$u=$z.window,$N=0,$y=$V.length;$N<$y;++$N){$u=$u[this.clasPaths[$N]]}if("function"!=typeof $u)throw"_getSprite3DHierarchyInnerUrls 错误: "+$t.type+" 不是类";$R._addHierarchyInnerUrls($E,$i,$n,$c,$t.path,$u)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var $$=($f=$I.customProps).meshPath;$$&&$R._addHierarchyInnerUrls($M,$i,$n,$c,$$,$lM);var $w=$f.material;if($w){$V=$w.type.split("."),$u=$z.window;for($N=0,$y=$V.length;$N<$y;++$N){$u=$u[this.clasPaths[$N]]}$R._addHierarchyInnerUrls($E,$i,$n,$c,$w.path,$u)}else{var $g=$f.materialPath;if($g)$R._addHierarchyInnerUrls($E,$i,$n,$c,$g,ShurikenParticleMaterial);else{var $O=$f.texturePath;$O&&$R._addHierarchyInnerUrls($Z,$i,$n,$c,$O,$eM)}}break;case"Terrain":$R._addHierarchyInnerUrls($Z,$i,$n,$c,$I.customProps.dataPath,TerrainRes)}var $a=$I.components;for(var $m in $a){var $j=$a[$m];switch($m){case"Animator":var $T=$j.avatarPath;if($T)$R._addHierarchyInnerUrls($Z,$i,$n,$c,$T,Avatar);else{var $q=$j.avatar;$q&&$R._addHierarchyInnerUrls($Z,$i,$n,$c,$q.path,Avatar)}var $v=$j.clipPaths;for($d=0,$H=$v.length;$d<$H;$d++)$R._addHierarchyInnerUrls($Z,$i,$n,$c,$v[$d],AnimationClip)}}var $W=$I.child;for($d=0,$H=$W.length;$d<$H;$d++)$R._getSprite3DHierarchyInnerUrls($W[$d],$M,$E,$Z,$i,$n,$c)},$R._loadHierarchy=function($I){$I.on("loaded",null,$R._onHierarchylhLoaded,[$I,$I._class._getGroup()]),$I.load($I.url,"json",!1,null,!0)},$R._onHierarchylhLoaded=function($I,$M,$E){if($I._class.destroyed)$I.endLoad();else{var $Z=$I.url,$i=$uM.getURLVerion($Z),$n=$v.getPath($Z),$c=[],$f=[],$d=[],$H={};$R._getSprite3DHierarchyInnerUrls($E,$c,$f,$d,$H,$i,$n);var $B=$c.length+$f.length+$d.length,$A=$B+1,$Q=1/$A;if($R._onProcessChange($I,0,$Q,1),0<$d.length){var $p=$B/$A,$t=$q.create(null,$R._onProcessChange,[$I,$Q,$p],!1);$R._innerFourthLevelLoaderManager.create($d,$q.create(null,$R._onHierarchyInnerForthLevResouLoaded,[$I,$M,$t,$E,$H,$c,$f,$Q+$p*$d.length,$p]),$t,null,null,1,!0,$M)}else $R._onHierarchyInnerForthLevResouLoaded($I,$M,null,$E,$H,$c,$f,$Q,$p)}},$R._onHierarchyInnerForthLevResouLoaded=function($I,$M,$E,$Z,$i,$n,$c,$f,$d){if($I._class.destroyed)$I.endLoad();else if($E&&$E.recover(),0<$c.length){var $H=$q.create(null,$R._onProcessChange,[$I,$f,$d],!1);$R._innerSecondLevelLoaderManager.create($c,$q.create(null,$R._onHierarchyInnerSecondLevResouLoaded,[$I,$M,$H,$Z,$i,$n,$f+$d*$c.length,$d]),$E,null,null,1,!0,$M)}else $R._onHierarchyInnerSecondLevResouLoaded($I,$M,null,$Z,$i,$n,$f,$d)},$R._onHierarchyInnerSecondLevResouLoaded=function($I,$M,$E,$Z,$i,$n,$c,$f){if($I._class.destroyed)$I.endLoad();else if($E&&$E.recover(),0<$n.length){var $d=$q.create(null,$R._onProcessChange,[$I,$c,$f],!1);$R._innerFirstLevelLoaderManager.create($n,$q.create(null,$R._onHierarchyInnerFirstLevResouLoaded,[$I,$d,$Z,$i]),$E,null,null,1,!0,$M)}else $R._onHierarchyInnerFirstLevResouLoaded($I,null,$Z,$i)},$R._onHierarchyInnerFirstLevResouLoaded=function($I,$M,$E,$Z){$M&&$M.recover(),$I.endLoad([$E,$Z])},$R._loadTerrain=function($I){$I.on("loaded",null,$R._onTerrainLtLoaded,[$I,$I._class._getGroup()]),$I.load($I.url,"json",!1,null,!0)},$R._onTerrainLtLoaded=function($I,$M,$E){if($I._class.destroyed)$I.endLoad();else{var $Z,$i,$n=$I.url,$c=$uM.getURLVerion($n),$f=$v.getPath($n),$d=[],$H={},$B=0,$A=0,$Q=$E.heightData;$Z=$Q.url,$i=$R.formatRelativePath($f,$Z),$c&&($i+=$c),$Z=$H[$Z]=$i;var $p=$E.detailTexture;for($B=0,$A=$p.length;$B<$A;$B++)$d.push({url:$p[$B].diffuse});var $t=$E.normalMap;for($B=0,$A=$t.length;$B<$A;$B++)$d.push({url:$t[$B]});var $V=$E.alphaMap;for($B=0,$A=$V.length;$B<$A;$B++)$d.push({url:$V[$B],params:[!1,!1,6408,!0]});for($B=0,$A=$d.length;$B<$A;$B++){var $u=$d[$B].url;$i=$R.formatRelativePath($f,$u),$c&&($i+=$c),$d[$B].url=$i,$H[$u]=$i}var $N=$d.length,$y=$N+2,$$=1/$y;$R._onProcessChange($I,0,$$,1);var $w={heightMapLoaded:!1,texturesLoaded:!1},$g=$q.create(null,$R._onProcessChange,[$I,$$,$$],!1);$R._innerFourthLevelLoaderManager.create($Z,$q.create(null,$R._onTerrainHeightMapLoaded,[$I,$g,$E,$H,$w]),$g,null,[$Q.numX,$Q.numZ,$Q.bitType,$Q.value],1,!0,$M);var $O=$q.create(null,$R._onProcessChange,[$I,2*$$,$N/$y],!1);$R._innerFourthLevelLoaderManager.create($d,$q.create(null,$R._onTerrainTexturesLoaded,[$I,$O,$E,$H,$w]),$O,null,null,1,!0,$M)}},$R._onTerrainHeightMapLoaded=function($I,$M,$E,$Z,$i){$i.heightMapLoaded=!0,$i.texturesLoaded&&($I.endLoad([$E,$Z]),$M.recover())},$R._onTerrainTexturesLoaded=function($I,$M,$E,$Z,$i){$i.texturesLoaded=!0,$i.heightMapLoaded&&($I.endLoad([$E,$Z]),$M.recover())},$R._loadMesh=function($I){$I.on("loaded",null,$R._onMeshLmLoaded,[$I,$I._class._getGroup()]),$I.load($I.url,"arraybuffer",!1,null,!0)},$R._onMeshLmLoaded=function($I,$M,$E){if($I._class.destroyed)$I.endLoad();else{var $Z,$i,$n,$c=$I.url,$f=$uM.getURLVerion($c),$d=$v.getPath($c),$H={},$B=0,$A=0;switch(($R._readData=new $O($E)).pos=0,$R._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var $Q=$R._readData.getUint32();$R._readData.pos=$R._readData.pos+4,$A=$R._readData.getUint16(),$R._readData.pos=$R._readData.pos+8*$A;var $p=$R._readData.getUint32();for($A=$R._readData.getUint16(),$R._readData.pos=$Q+$p,$Z=[],$B=0;$B<$A;$B++){var $t=$R._readData.readUTFString();-1!==$t.lastIndexOf(".lmat")&&$Z.push($t)}break;default:for($R.READ_BLOCK(),$B=0;$B<2;$B++){var $V=$R._readData.getUint16(),$u=$R._strings[$V],$N=$R["READ_"+$u];if(null==$N)throw new Error("model file err,no this function:"+$V+" "+$u);1===$B?$Z=$N.call():$N.call()}}for($B=0,$n=$Z.length;$B<$n;$B++){var $y=$Z[$B];$i=$R.formatRelativePath($d,$y),$f&&($i+=$f),$Z[$B]=$i,$H[$y]=$i}if(0<$Z.length){$R._onProcessChange($I,0,.5,1);var $$=$q.create(null,$R._onProcessChange,[$I,.5,.5],!1);$R._innerSecondLevelLoaderManager.create($Z,$q.create(null,$R._onMeshMateialLoaded,[$I,$$,$E,$H]),$$,null,null,1,!0,$M)}else $I.endLoad([$E,$H])}},$R._onMeshMateialLoaded=function($I,$M,$E,$Z){$I.endLoad([$E,$Z]),$M.recover()},$R._getMaterialTexturePath=function($I,$M,$E){var $Z=$I.length-4;return $I.indexOf(".dds")!=$Z&&$I.indexOf(".tga")!=$Z&&$I.indexOf(".exr")!=$Z&&$I.indexOf(".DDS")!=$Z&&$I.indexOf(".TGA")!=$Z&&$I.indexOf(".EXR")!=$Z||($I=$I.substr(0,$Z)+".png"),$I=$R.formatRelativePath($E,$I),$M&&($I+=$M),$I},$R._loadMaterial=function($I){$I.on("loaded",null,$R._onMaterilLmatLoaded,[$I,$I._class._getGroup()]),$I.load($I.url,"json",!1,null,!0)},$R._onMaterilLmatLoaded=function($I,$M,$E){if($I._class.destroyed)$I.endLoad();else{var $Z,$i=$I.url,$n=$uM.getURLVerion($i),$c=$v.getPath($i),$f=[],$d={},$H=$E.customProps,$B=$E.version;if($B)switch($B){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var $A=$E.props.textures,$Q=0,$p=$A.length;$Q<$p;$Q++){var $t=$A[$Q],$V=$t.path;if($V){var $u=$V.length-4;$V.indexOf(".exr")!=$u&&$V.indexOf(".EXR")!=$u||($V=$V.substr(0,$u)+".png"),$Z=$R.formatRelativePath($c,$V),$n&&($Z+=$n),$f.push({url:$Z,params:$t.params}),$d[$V]=$Z}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var $N=$H.diffuseTexture.texture2D;if($N&&($Z=$R._getMaterialTexturePath($N,$n,$c),$f.push($Z),$d[$N]=$Z),$H.normalTexture){var $y=$H.normalTexture.texture2D;$y&&($Z=$R._getMaterialTexturePath($y,$n,$c),$f.push($Z),$d[$y]=$Z)}if($H.specularTexture){var $$=$H.specularTexture.texture2D;$$&&($Z=$R._getMaterialTexturePath($$,$n,$c),$f.push($Z),$d[$$]=$Z)}if($H.emissiveTexture){var $w=$H.emissiveTexture.texture2D;$w&&($Z=$R._getMaterialTexturePath($w,$n,$c),$f.push($Z),$d[$w]=$Z)}if($H.ambientTexture){var $g=$H.ambientTexture.texture2D;$g&&($Z=$R._getMaterialTexturePath($g,$n,$c),$f.push($Z),$d[$g]=$Z)}if($H.reflectTexture){var $O=$H.reflectTexture.texture2D;$O&&($Z=$R._getMaterialTexturePath($O,$n,$c),$f.push($Z),$d[$O]=$Z)}}var $a=$f.length,$m=$a+1,$j=1/$m;if($R._onProcessChange($I,0,$j,1),0<$a){var $T=$q.create(null,$R._onProcessChange,[$I,$j,$a/$m],!1);$R._innerFourthLevelLoaderManager.create($f,$q.create(null,$R._onMateialTexturesLoaded,[$I,$T,$E,$d]),$T,$eM,null,1,!0,$M)}else $R._onMateialTexturesLoaded($I,null,$E,null)}},$R._onMateialTexturesLoaded=function($I,$M,$E,$Z){$I.endLoad([$E,$Z]),$M&&$M.recover()},$R._loadTextureCube=function($I){$I.on("loaded",null,$R._onTextureCubeLtcLoaded,[$I]),$I.load($I.url,"json",!1,null,!0)},$R._onTextureCubeLtcLoaded=function($I,$M){if($I._class.destroyed)$I.endLoad();else{var $E=$v.getPath($I.url),$Z=[$R.formatRelativePath($E,$M.px),$R.formatRelativePath($E,$M.nx),$R.formatRelativePath($E,$M.py),$R.formatRelativePath($E,$M.ny),$R.formatRelativePath($E,$M.pz),$R.formatRelativePath($E,$M.nz)];$R._onProcessChange($I,0,1/7,1);var $i=$q.create(null,$R._onProcessChange,[$I,1/7,6/7],!1);$R._innerFourthLevelLoaderManager.load($Z,$q.create(null,$R._onTextureCubeImagesLoaded,[$I,$Z,$i]),$i,"nativeimage")}},$R._onTextureCubeImagesLoaded=function($I,$M,$E){var $Z=[];$Z.length=6;for(var $i=0;$i<6;$i++){var $n=$M[$i];$Z[$i]=$N.getRes($n),$N.clearRes($n)}$I.endLoad($Z),$E.recover()},$R._onProcessChange=function($I,$M,$E,$Z){($Z=$M+$Z*$E)<1&&$I.event("progress",$Z)},$R.init=function($I,$M,$E,$Z,$i,$n){if(void 0===$E&&($E=!1),void 0===$Z&&($Z=!1),void 0===$i&&($i=!0),void 0===$n&&($n=!0),$y.update3DLoop=function(){},$y.cancelLoadByUrl=function($I){$R._cancelLoadByUrl($I)},$d.isAntialias=$E,$d.isAlpha=$Z,$d.premultipliedAlpha=$i,$d.isStencil=$n,!$W.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");$y.changeWebGLSize=$R._changeWebGLSize,$V.is3DMode=!0,$g.init($I,$M),$L.__init__(),$AM.__init__(),$DM.__init__(),$r.__init__(),$R.__init__(),$c.maxTextureCount=2,($R.debugMode||$Y.debugMode)&&($R._debugPhasorSprite=new $h)},$R.HIERARCHY="SPRITE3DHIERARCHY",$R.MESH="MESH",$R.MATERIAL="MATERIAL",$R.PBRMATERIAL="PBRMTL",$R.TEXTURECUBE="TEXTURECUBE",$R.TERRAIN="TERRAIN",$R._readData=null,$R._debugPhasorSprite=null,$R.debugMode=!1,$A($R,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new $M},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new $M},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new $M},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new $M}]),$R}(),$yM=function($I){function $i($I){$i.__super.call(this),this._owner=$I,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}$p($i,"laya.d3.animation.AnimationTransform3D",$n);var $M=$i.prototype;return $M._getlocalMatrix=function(){return this._localUpdate&&($uM._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},$M._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var $I=0,$M=this._childs.length;$I<$M;$I++)this._childs[$I]._onWorldTransform()}},$M._setWorldMatrixAndUpdate=function($I){if(this._worldMatrix=$I,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var $M=this._getlocalMatrix(),$E=0;$E<16;++$E)this._worldMatrix[$E]=$M[$E];else $uM.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},$M._setWorldMatrixNoUpdate=function($I){this._worldMatrix=$I},$M._setWorldMatrixIgnoreUpdate=function($I){this._worldMatrix=$I,this._worldUpdate=!1},$M.getLocalPosition=function(){return this._localPosition},$M.setLocalPosition=function($I){if(this._parent)this._localPosition=$I,this._localUpdate=!0,this._onWorldTransform();else{var $M=this._entity.owner._transform,$E=this._entity.localPosition,$Z=$E.elements;$Z[0]=$I[0],$Z[1]=$I[1],$Z[2]=$I[2],$M.localPosition=$E}},$M.getLocalRotation=function(){if(this._localQuaternionUpdate){var $I=this._localRotationEuler;$uM._quaternionCreateFromYawPitchRollArray($I[1]/$i._angleToRandin,$I[0]/$i._angleToRandin,$I[2]/$i._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},$M.setLocalRotation=function($I){if(this._parent)this._localRotation=$I,$uM.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $M=this._entity.owner._transform,$E=this._entity.localRotation,$Z=$E.elements;$Z[0]=$I[0],$Z[1]=$I[1],$Z[2]=$I[2],$Z[3]=$I[3],$M.localRotation=$E}},$M.getLocalScale=function(){return this._localScale},$M.setLocalScale=function($I){if(this._parent)this._localScale=$I,this._localUpdate=!0,this._onWorldTransform();else{var $M=this._entity.owner._transform,$E=this._entity.localScale,$Z=$E.elements;$Z[0]=$I[0],$Z[1]=$I[1],$Z[2]=$I[2],$M.localScale=$E}},$M.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){$uM.getYawPitchRoll(this._localRotation,$i._tempVector3);var $I=$i._tempVector3,$M=this._localRotationEuler;$M[0]=$I[1]*$i._angleToRandin,$M[1]=$I[0]*$i._angleToRandin,$M[2]=$I[2]*$i._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},$M.setLocalRotationEuler=function($I){if(this._parent)$uM._quaternionCreateFromYawPitchRollArray($I[1]/$i._angleToRandin,$I[0]/$i._angleToRandin,$I[2]/$i._angleToRandin,this._localRotation),this._localRotationEuler=$I,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var $M=this._entity.owner._transform,$E=this._entity.localRotationEuler,$Z=$E.elements;$Z[0]=$I[0],$Z[1]=$I[1],$Z[2]=$I[2],$M.localRotationEuler=$E}},$M.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)$uM.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var $I=this._getlocalMatrix(),$M=0;$M<16;++$M)this._worldMatrix[$M]=$I[$M];this._worldUpdate=!1}return this._worldMatrix},$M.setParent=function($I){if(this._parent!==$I){if(this._parent){var $M=this._parent._childs,$E=$M.indexOf(this);$M.splice($E,1)}$I&&($I._childs.push(this),$I&&this._onWorldTransform()),this._parent=$I}},$A($i,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$i}(),$$M=function($I){function $M(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,$M.__super.call(this),this._destroyed=!1,this._id=$M._uniqueIDCounter,$M._uniqueIDCounter++}$p($M,"laya.d3.component.Component3D",$n);var $E=$M.prototype;return $g.imps($E,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),$E._initialize=function($I){this._owner=$I,this._enable=!0,this.started=!1,this._load($I)},$E._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},$E._load=function($I){},$E._start=function($I){},$E._update=function($I){},$E._lateUpdate=function($I){},$E._preRenderUpdate=function($I){},$E._postRenderUpdate=function($I){},$E._unload=function($I){this.offAll()},$E._cloneTo=function($I){},$t(0,$E,"id",function(){return this._id}),$t(0,$E,"destroyed",function(){return this._destroyed}),$t(0,$E,"owner",function(){return this._owner}),$t(0,$E,"enable",function(){return this._enable},function($I){this._enable!==$I&&(this._enable=$I,this.event("enablechanged",this._enable))}),$t(0,$E,"isSingleton",function(){return $M._isSingleton}),$M._isSingleton=!0,$M._uniqueIDCounter=1,$M}(),$wM=function($I){function $M(){this._destroyed=!1,$M.__super.call(this),this._destroyed=!1}$p($M,"laya.d3.core.GeometryFilter",$n);var $E=$M.prototype;return $g.imps($E,{"laya.resource.IDestroy":!0}),$E._destroy=function(){this.offAll(),this._destroyed=!0},$t(0,$E,"_isAsyncLoaded",function(){return!0}),$t(0,$E,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),$t(0,$E,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),$t(0,$E,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),$t(0,$E,"destroyed",function(){return this._destroyed}),$M}(),$gM=function($I){function $Z($I){$Z.__super.call(this),this._id=++$Z._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new $YI(new $cM,new $cM),this._boundingBoxCenter=new $cM,this._boundingSphere=new $sI(new $cM,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=$I,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}$p($Z,"laya.d3.core.render.BaseRender",$n);var $M=$Z.prototype;return $g.imps($M,{"laya.resource.IDestroy":!0}),$M._changeMaterialReference=function($I,$M){$I&&$I._removeReference(),$M._addReference()},$M._getInstanceMaterial=function($I,$M){var $E=new $I.constructor;return $I.cloneTo($E),$E.name=$E.name+"(Instance)",this._materialsInstance[$M]=!0,this._changeMaterialReference(this._materials[$M],$E),this._materials[$M]=$E},$M._setShaderValuelightMap=function($I){this._setShaderValueTexture(3,$I)},$M._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},$M._renderRenderableBoundBox=function(){var $I=$NM._debugPhasorSprite,$M=this.boundingBox,$E=$Z._tempBoundBoxCorners;$M.getCorners($E),$I.line($E[0],$Z._greenColor,$E[1],$Z._greenColor),$I.line($E[2],$Z._greenColor,$E[3],$Z._greenColor),$I.line($E[4],$Z._greenColor,$E[5],$Z._greenColor),$I.line($E[6],$Z._greenColor,$E[7],$Z._greenColor),$I.line($E[0],$Z._greenColor,$E[3],$Z._greenColor),$I.line($E[1],$Z._greenColor,$E[2],$Z._greenColor),$I.line($E[2],$Z._greenColor,$E[6],$Z._greenColor),$I.line($E[3],$Z._greenColor,$E[7],$Z._greenColor),$I.line($E[0],$Z._greenColor,$E[4],$Z._greenColor),$I.line($E[1],$Z._greenColor,$E[5],$Z._greenColor),$I.line($E[4],$Z._greenColor,$E[7],$Z._greenColor),$I.line($E[5],$Z._greenColor,$E[6],$Z._greenColor)},$M._calculateBoundingSphere=function(){throw"BaseRender: must override it."},$M._calculateBoundingBox=function(){throw"BaseRender: must override it."},$M._setShaderValueTexture=function($I,$M){this._owner._shaderValues.setValue($I,$M)},$M._setShaderValueMatrix4x4=function($I,$M){this._owner._shaderValues.setValue($I,$M?$M.elements:null)},$M._setShaderValueColor=function($I,$M){this._owner._shaderValues.setValue($I,$M?$M.elements:null)},$M._setShaderValueBuffer=function($I,$M){this._owner._shaderValues.setValue($I,$M)},$M._setShaderValueInt=function($I,$M){this._owner._shaderValues.setValue($I,$M)},$M._setShaderValueBool=function($I,$M){this._owner._shaderValues.setValue($I,$M)},$M._setShaderValueNumber=function($I,$M){this._owner._shaderValues.setValue($I,$M)},$M._setShaderValueVector2=function($I,$M){this._owner._shaderValues.setValue($I,$M?$M.elements:null)},$M._addShaderDefine=function($I){this._owner._shaderDefineValue|=$I},$M._removeShaderDefine=function($I){this._owner._shaderDefineValue&=~$I},$M._renderUpdate=function($I){return!0},$M._applyLightMapParams=function(){if(0<=this._lightmapIndex){var $I=this._owner.scene;if($I){var $M=$I.getlightmaps()[this._lightmapIndex];$M?(this._addShaderDefine($hM.SAHDERDEFINE_LIGHTMAP),$M.loaded?this._setShaderValuelightMap($M):$M.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine($hM.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($hM.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine($hM.SAHDERDEFINE_LIGHTMAP)},$M._updateOctreeNode=function(){var $I=this._treeNode;$I&&this._octreeNodeNeedChange&&($I.updateObject(this),this._octreeNodeNeedChange=!1)},$M._destroy=function(){this.offAll();var $I=0,$M=0;for($I=0,$M=this._renderElements.length;$I<$M;$I++)this._renderElements[$I]._destroy();for($I=0,$M=this._materials.length;$I<$M;$I++)this._materials[$I]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},$t(0,$M,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),$t(0,$M,"id",function(){return this._id}),$t(0,$M,"material",function(){var $I=this._materials[0];if($I&&!this._materialsInstance[0]){var $M=this._getInstanceMaterial($I,0);this.event("materialchanged",[this,0,$M])}return this._materials[0]},function($I){this.sharedMaterial=$I}),$t(0,$M,"sharedMaterial",function(){return this._materials[0]},function($I){var $M=this._materials[0];$M!==$I&&(this._materials[0]=$I,this._materialsInstance[0]=!1,this._changeMaterialReference($M,$I),this.event("materialchanged",[this,0,$I]))}),$t(0,$M,"lightmapIndex",function(){return this._lightmapIndex},function($I){this._lightmapIndex=$I,this._applyLightMapParams()}),$t(0,$M,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function($I){this._lightmapScaleOffset=$I,this._setShaderValueColor(2,$I),this._addShaderDefine($hM.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),$t(0,$M,"enable",function(){return this._enable},function($I){this._enable=$I,this.event("enablechanged",[this,$I])}),$t(0,$M,"materials",function(){for(var $I=0,$M=this._materials.length;$I<$M;$I++)if(!this._materialsInstance[$I]){var $E=this._getInstanceMaterial(this._materials[$I],$I);this.event("materialchanged",[this,$I,$E])}return this._materials.slice()},function($I){this.sharedMaterials=$I}),$t(0,$M,"sharedMaterials",function(){return this._materials.slice()},function($I){if(!$I)throw new Error("MeshRender: shadredMaterials value can't be null.");var $M=$I.length;this._materialsInstance.length=$M;for(var $E=0;$E<$M;$E++){var $Z=this._materials[$E];$Z!==$I[$E]&&(this._materialsInstance[$E]=!1,this._changeMaterialReference($Z,$I[$E]),this.event("materialchanged",[this,$E,$I[$E]]))}this._materials=$I}),$t(0,$M,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),$t(0,$M,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var $I=this.boundingBox;$cM.add($I.min,$I.max,this._boundingBoxCenter),$cM.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),$t(0,$M,"receiveShadow",function(){return this._receiveShadow},function($I){this._receiveShadow!==$I&&((this._receiveShadow=$I)?this._addShaderDefine($pM.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine($pM.SHADERDEFINE_RECEIVE_SHADOW))}),$t(0,$M,"destroyed",function(){return this._destroyed}),$Z._uniqueIDCounter=0,$A($Z,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new $cM,new $cM,new $cM,new $cM,new $cM,new $cM,new $cM,new $cM]},"_greenColor",function(){return this._greenColor=new $fM(0,1,0,1)}]),$Z}(),$OM=function($I){function $f($I){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,$f.__super.call(this),this._localPosition=new $cM,this._localRotation=new $EM(0,0,0,1),this._localScale=new $cM(1,1,1),this._localRotationEuler=new $cM,this._localMatrix=new $IM,this._position=new $cM,this._rotation=new $EM(0,0,0,1),this._scale=new $cM(1,1,1),this._worldMatrix=new $IM,this._forward=new $cM,this._up=new $cM,this._right=new $cM,this._owner=$I,this._childs=[]}$p($f,"laya.d3.core.Transform3D",$n);var $M=$f.prototype;return $M._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)$IM.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var $I=$f._tempVector30;$cM.multiply(this.pivot,this._localScale,$I);var $M=$f._tempVector31;$cM.subtract($I,this.pivot,$M);var $E=$f._tempVector32,$Z=this.localRotation;$cM.transformQuat($I,$Z,$E),$cM.subtract($E,$I,$E);var $i=$f._tempVector33;$cM.subtract(this._localPosition,$M,$i),$cM.subtract($i,$E,$i),$IM.createAffineTransformation($i,$Z,this._localScale,this._localMatrix)}},$M._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $I=0,$M=this._childs.length;$I<$M;$I++)this._childs[$I]._onWorldPositionRotationTransform()}},$M._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $I=0,$M=this._childs.length;$I<$M;$I++)this._childs[$I]._onWorldPositionScaleTransform()}},$M._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var $I=0,$M=this._childs.length;$I<$M;$I++)this._childs[$I]._onWorldPositionTransform()}},$M._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var $I=0,$M=this._childs.length;$I<$M;$I++)this._childs[$I]._onWorldPositionRotationTransform()}},$M._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $I=0,$M=this._childs.length;$I<$M;$I++)this._childs[$I]._onWorldPositionScaleTransform()}},$M._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var $I=0,$M=this._childs.length;$I<$M;$I++)this._childs[$I]._onWorldTransform()}},$M.translate=function($I,$M){void 0===$M&&($M=!0),$M?($IM.createFromQuaternion(this.localRotation,$f._tempMatrix0),$cM.transformCoordinate($I,$f._tempMatrix0,$f._tempVector30),$cM.add(this.localPosition,$f._tempVector30,this._localPosition),this.localPosition=this._localPosition):($cM.add(this.position,$I,this._position),this.position=this._position)},$M.rotate=function($I,$M,$E){var $Z;void 0===$M&&($M=!0),void 0===$E&&($E=!0),$Z=$E?$I:($cM.scale($I,Math.PI/180,$f._tempVector30),$f._tempVector30),$EM.createFromYawPitchRoll($Z.y,$Z.x,$Z.z,$f._tempQuaternion0),$M?($EM.multiply(this._localRotation,$f._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):($EM.multiply($f._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},$M.lookAt=function($I,$M,$E){void 0===$E&&($E=!1);var $Z,$i=$I.elements;if($E){if($Z=this._localPosition.elements,Math.abs($Z[0]-$i[0])<$bI.zeroTolerance&&Math.abs($Z[1]-$i[1])<$bI.zeroTolerance&&Math.abs($Z[2]-$i[2])<$bI.zeroTolerance)return;$EM.lookAt(this._localPosition,$I,$M,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var $n=this.position;if($Z=$n.elements,Math.abs($Z[0]-$i[0])<$bI.zeroTolerance&&Math.abs($Z[1]-$i[1])<$bI.zeroTolerance&&Math.abs($Z[2]-$i[2])<$bI.zeroTolerance)return;$EM.lookAt($n,$I,$M,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},$t(0,$M,"_isFrontFaceInvert",function(){var $I=this.scale,$M=$I.x<0;return $I.y<0&&($M=!$M),$I.z<0&&($M=!$M),$M}),$t(0,$M,"owner",function(){return this._owner}),$t(0,$M,"localRotation",function(){if(this._localQuaternionUpdate){var $I=this._localRotationEuler.elements;$EM.createFromYawPitchRoll($I[1]/$f._angleToRandin,$I[0]/$f._angleToRandin,$I[2]/$f._angleToRandin,this._localRotation)}return this._localRotation},function($I){this._localRotation=$I,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$t(0,$M,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?$IM.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function($I){null===this._parent?$I.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),$IM.multiply(this._localMatrix,$I,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=$I,this._worldUpdate=!1}),$t(0,$M,"worldNeedUpdate",function(){return this._worldUpdate}),$t(0,$M,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function($I){this._localMatrix=$I,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),$t(0,$M,"dummy",function(){return this._dummy},function($I){this._dummy!==$I&&(this._dummy&&(this._dummy._entity=null),$I&&($I._entity=this),this._dummy=$I)}),$t(0,$M,"localPosition",function(){return this._localPosition},function($I){this._localPosition=$I,this._localUpdate=!0,this._onWorldPositionTransform()}),$t(0,$M,"position",function(){if(this._positionUpdate){if(null!=this._parent){var $I=this._parent.position;$cM.multiply(this._localPosition,this._parent.scale,$f._tempVector30),$cM.transformQuat($f._tempVector30,this._parent.rotation,$f._tempVector30),$cM.add($I,$f._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function($I){if(null!=this._parent){$cM.subtract($I,this._parent.position,this._localPosition);var $M=this._parent.scale.elements,$E=$M[0],$Z=$M[1],$i=$M[2];if(1!==$E||1!==$Z||1!==$i){var $n=$f._tempVector30,$c=$n.elements;$c[0]=1/$E,$c[1]=1/$Z,$c[2]=1/$i,$cM.multiply(this._localPosition,$n,this._localPosition)}this._parent.rotation.invert($f._tempQuaternion0),$cM.transformQuat(this._localPosition,$f._tempQuaternion0,this._localPosition)}else $I.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=$I,this._positionUpdate=!1}),$t(0,$M,"localScale",function(){return this._localScale},function($I){this._localScale=$I,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),$t(0,$M,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll($f._tempVector30);var $I=$f._tempVector30.elements,$M=this._localRotationEuler.elements;$M[0]=$I[1]*$f._angleToRandin,$M[1]=$I[0]*$f._angleToRandin,$M[2]=$I[2]*$f._angleToRandin}return this._localRotationEuler},function($I){this._localRotationEuler=$I,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),$t(0,$M,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?$EM.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function($I){null!=this._parent?(this._parent.rotation.invert($f._tempQuaternion0),$EM.multiply($I,$f._tempQuaternion0,this._localRotation)):$I.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=$I,this._rotationUpdate=!1}),$t(0,$M,"scale",function(){return this._scaleUpdate&&(null!==this._parent?$cM.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function($I){if(null!==this._parent){var $M=this._parent.scale.elements,$E=$f._tempVector30.elements;$E[0]=1/$M[0],$E[1]=1/$M[1],$E[2]=1/$M[2],$cM.multiply($I,$f._tempVector30,this._localScale)}else $I.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=$I,this._scaleUpdate=!1}),$t(0,$M,"rotationEuler",null,function($I){$EM.createFromYawPitchRoll($I.y,$I.x,$I.z,this._rotation),this.rotation=this._rotation}),$t(0,$M,"forward",function(){var $I=this.worldMatrix.elements;return this._forward.elements[0]=-$I[8],this._forward.elements[1]=-$I[9],this._forward.elements[2]=-$I[10],this._forward}),$t(0,$M,"up",function(){var $I=this.worldMatrix.elements;return this._up.elements[0]=$I[4],this._up.elements[1]=$I[5],this._up.elements[2]=$I[6],this._up}),$t(0,$M,"right",function(){var $I=this.worldMatrix.elements;return this._right.elements[0]=$I[0],this._right.elements[1]=$I[1],this._right.elements[2]=$I[2],this._right}),$t(0,$M,"parent",function(){return this._parent},function($I){if(this._parent!==$I){if(this._parent){var $M=this._parent._childs,$E=$M.indexOf(this);$M.splice($E,1)}$I&&($I._childs.push(this),$I&&this._onWorldTransform()),this._parent=$I}}),$A($f,["_tempVector30",function(){return this._tempVector30=new $cM},"_tempVector31",function(){return this._tempVector31=new $cM},"_tempVector32",function(){return this._tempVector32=new $cM},"_tempVector33",function(){return this._tempVector33=new $cM},"_tempQuaternion0",function(){return this._tempQuaternion0=new $EM},"_tempMatrix0",function(){return this._tempMatrix0=new $IM},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),$f}(),$aM=(function($I){function $M(){this._rotation=0,this._matNeedUpdte=!1,$M.__super.call(this),this._matrix=new $IM,this._offset=new $nM,this._tiling=new $nM(1,1)}$p($M,"laya.d3.core.TransformUV",$n);var $E=$M.prototype;$g.imps($E,{"laya.d3.core.IClone":!0}),$E._updateMatrix=function(){$M._tempOffsetV3.elements[0]=this._offset.x,$M._tempOffsetV3.elements[1]=this._offset.y,$EM.createFromYawPitchRoll(0,0,this._rotation,$M._tempRotationQua),$M._tempTitlingV3.elements[0]=this._tiling.x,$M._tempTitlingV3.elements[1]=this._tiling.y,$IM.createAffineTransformation($M._tempOffsetV3,$M._tempRotationQua,$M._tempTitlingV3,this._matrix)},$E.cloneTo=function($I){$I._matrix=this._matrix.clone(),$I._offset=this._offset.clone(),$I._rotation=this._rotation,$I._tiling=this._tiling.clone()},$E.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$E,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),$t(0,$E,"tiling",function(){return this._tiling},function($I){this._tiling=$I,this._matNeedUpdte=!0}),$t(0,$E,"offset",function(){return this._offset},function($I){this._offset=$I,this._matNeedUpdte=!0}),$t(0,$E,"rotation",function(){return this._rotation},function($I){this._rotation=$I,this._matNeedUpdte=!0}),$A($M,["_tempOffsetV3",function(){return this._tempOffsetV3=new $cM(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new $EM},"_tempTitlingV3",function(){return this._tempTitlingV3=new $cM(1,1,1)}])}(),function($E){function $I(){this.x=NaN,this.y=NaN,this.z=NaN,$I.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}$p($I,"laya.d3.core.particleShuriKen.module.shape.BoxShape",$E);var $M=$I.prototype;$M._getShapeBoundBox=function($I){var $M=$I.min.elements;$M[0]=.5*-this.x,$M[1]=.5*-this.y,$M[2]=.5*-this.z;var $E=$I.max.elements;$E[0]=.5*this.x,$E[1]=.5*this.y,$E[2]=.5*this.z},$M._getSpeedBoundBox=function($I){var $M=$I.min.elements;$M[0]=0,$M[1]=0,$M[2]=0;var $E=$I.max.elements;$E[0]=0,$E[1]=1,$E[2]=0},$M.generatePositionAndDirection=function($I,$M,$E,$Z){var $i=$I.elements,$n=$M.elements;$E?($E.seed=$Z[16],$e._randomPointInsideHalfUnitBox($I,$E),$Z[16]=$E.seed):$e._randomPointInsideHalfUnitBox($I),$i[0]=this.x*$i[0],$i[1]=this.y*$i[1],$i[2]=this.z*$i[2],this.randomDirection?$E?($E.seed=$Z[17],$e._randomPointUnitSphere($M,$E),$Z[17]=$E.seed):$e._randomPointUnitSphere($M):($n[0]=0,$n[1]=0,$n[2]=1)},$M.cloneTo=function($I){$E.prototype.cloneTo.call(this,$I);var $M=$I;$M.x=this.x,$M.y=this.y,$M.z=this.z,$M.randomDirection=this.randomDirection}}($x),function($E){function $c(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,$c.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}$p($c,"laya.d3.core.particleShuriKen.module.shape.CircleShape",$E);var $I=$c.prototype;$I._getShapeBoundBox=function($I){var $M=$I.min.elements;$M[0]=$M[2]=-this.radius,$M[1]=0;var $E=$I.max.elements;$E[0]=$E[2]=this.radius,$E[1]=0},$I._getSpeedBoundBox=function($I){var $M=$I.min.elements;$M[0]=$M[1]=-1,$M[2]=0;var $E=$I.max.elements;$E[0]=$E[1]=1,$E[2]=0},$I.generatePositionAndDirection=function($I,$M,$E,$Z){var $i=$I.elements,$n=$c._tempPositionPoint.elements;$E?($E.seed=$Z[16],this.emitFromEdge?$e._randomPointUnitArcCircle(this.arc,$c._tempPositionPoint,$E):$e._randomPointInsideUnitArcCircle(this.arc,$c._tempPositionPoint,$E),$Z[16]=$E.seed):this.emitFromEdge?$e._randomPointUnitArcCircle(this.arc,$c._tempPositionPoint):$e._randomPointInsideUnitArcCircle(this.arc,$c._tempPositionPoint),$i[0]=-$n[0],$i[1]=$n[1],$i[2]=0,$cM.scale($I,this.radius,$I),this.randomDirection?$E?($E.seed=$Z[17],$e._randomPointUnitSphere($M,$E),$Z[17]=$E.seed):$e._randomPointUnitSphere($M):$I.cloneTo($M)},$I.cloneTo=function($I){$E.prototype.cloneTo.call(this,$I);var $M=$I;$M.radius=this.radius,$M.arc=this.arc,$M.emitFromEdge=this.emitFromEdge,$M.randomDirection=this.randomDirection},$A($c,["_tempPositionPoint",function(){return this._tempPositionPoint=new $nM}])}($x),function($E){function $Q(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,$Q.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}$p($Q,"laya.d3.core.particleShuriKen.module.shape.ConeShape",$E);var $I=$Q.prototype;$I._getShapeBoundBox=function($I){var $M=this.radius+this.length*Math.sin(this.angle),$E=this.length*Math.cos(this.angle),$Z=$I.min.elements;$Z[0]=$Z[1]=-$M,$Z[2]=0;var $i=$I.max.elements;$i[0]=$i[1]=$M,$i[2]=$E},$I._getSpeedBoundBox=function($I){var $M=Math.sin(this.angle),$E=$I.min.elements;$E[0]=$E[1]=-$M,$E[2]=0;var $Z=$I.max.elements;$Z[0]=$E[1]=$M,$Z[2]=1},$I.generatePositionAndDirection=function($I,$M,$E,$Z){var $i,$n=$I.elements,$c=$M.elements,$f=$Q._tempPositionPoint.elements,$d=NaN,$H=NaN,$B=Math.cos(this.angle),$A=Math.sin(this.angle);switch(this.emitType){case 0:$E?($E.seed=$Z[16],$e._randomPointInsideUnitCircle($Q._tempPositionPoint,$E),$Z[16]=$E.seed):$e._randomPointInsideUnitCircle($Q._tempPositionPoint),$d=$f[0],$H=$f[1],$n[0]=$d*this.radius,$n[1]=$H*this.radius,$n[2]=0,this.randomDirection?($E?($E.seed=$Z[17],$e._randomPointInsideUnitCircle($Q._tempDirectionPoint,$E),$Z[17]=$E.seed):$e._randomPointInsideUnitCircle($Q._tempDirectionPoint),$i=$Q._tempDirectionPoint.elements,$c[0]=$i[0]*$A,$c[1]=$i[1]*$A):($c[0]=$d*$A,$c[1]=$H*$A),$c[2]=$B;break;case 1:$E?($E.seed=$Z[16],$e._randomPointUnitCircle($Q._tempPositionPoint,$E),$Z[16]=$E.seed):$e._randomPointUnitCircle($Q._tempPositionPoint),$d=$f[0],$H=$f[1],$n[0]=$d*this.radius,$n[1]=$H*this.radius,$n[2]=0,this.randomDirection?($E?($E.seed=$Z[17],$e._randomPointInsideUnitCircle($Q._tempDirectionPoint,$E),$Z[17]=$E.seed):$e._randomPointInsideUnitCircle($Q._tempDirectionPoint),$i=$Q._tempDirectionPoint.elements,$c[0]=$i[0]*$A,$c[1]=$i[1]*$A):($c[0]=$d*$A,$c[1]=$H*$A),$c[2]=$B;break;case 2:$E?($E.seed=$Z[16],$e._randomPointInsideUnitCircle($Q._tempPositionPoint,$E)):$e._randomPointInsideUnitCircle($Q._tempPositionPoint),$d=$f[0],$H=$f[1],$n[0]=$d*this.radius,$n[1]=$H*this.radius,$c[$n[2]=0]=$d*$A,$c[1]=$H*$A,$c[2]=$B,$cM.normalize($M,$M),$E?($cM.scale($M,this.length*$E.getFloat(),$M),$Z[16]=$E.seed):$cM.scale($M,this.length*Math.random(),$M),$cM.add($I,$M,$I),this.randomDirection&&($E?($E.seed=$Z[17],$e._randomPointUnitSphere($M,$E),$Z[17]=$E.seed):$e._randomPointUnitSphere($M));break;case 3:$E?($E.seed=$Z[16],$e._randomPointUnitCircle($Q._tempPositionPoint,$E)):$e._randomPointUnitCircle($Q._tempPositionPoint),$d=$f[0],$H=$f[1],$n[0]=$d*this.radius,$n[1]=$H*this.radius,$c[$n[2]=0]=$d*$A,$c[1]=$H*$A,$c[2]=$B,$cM.normalize($M,$M),$E?($cM.scale($M,this.length*$E.getFloat(),$M),$Z[16]=$E.seed):$cM.scale($M,this.length*Math.random(),$M),$cM.add($I,$M,$I),this.randomDirection&&($E?($E.seed=$Z[17],$e._randomPointUnitSphere($M,$E),$Z[17]=$E.seed):$e._randomPointUnitSphere($M));break;default:throw new Error("ConeShape:emitType is invalid.")}},$I.cloneTo=function($I){$E.prototype.cloneTo.call(this,$I);var $M=$I;$M.angle=this.angle,$M.radius=this.radius,$M.length=this.length,$M.emitType=this.emitType,$M.randomDirection=this.randomDirection},$A($Q,["_tempPositionPoint",function(){return this._tempPositionPoint=new $nM},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new $nM}])}($x),function($E){function $I(){this.radius=NaN,this.emitFromShell=!1,$I.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$p($I,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",$E);var $M=$I.prototype;$M._getShapeBoundBox=function($I){var $M=$I.min.elements;$M[0]=$M[1]=$M[2]=-this.radius;var $E=$I.max.elements;$E[0]=$E[1]=this.radius,$E[2]=0},$M._getSpeedBoundBox=function($I){var $M=$I.min.elements;$M[0]=$M[1]=-1,$M[2]=0;var $E=$I.max.elements;$E[0]=$E[1]=$E[2]=1},$M.generatePositionAndDirection=function($I,$M,$E,$Z){var $i=$I.elements;$E?($E.seed=$Z[16],this.emitFromShell?$e._randomPointUnitSphere($I,$E):$e._randomPointInsideUnitSphere($I,$E),$Z[16]=$E.seed):this.emitFromShell?$e._randomPointUnitSphere($I):$e._randomPointInsideUnitSphere($I),$cM.scale($I,this.radius,$I);var $n=$i[2];$n<0&&($i[2]=-1*$n),this.randomDirection?$E?($E.seed=$Z[17],$e._randomPointUnitSphere($M,$E),$Z[17]=$E.seed):$e._randomPointUnitSphere($M):$I.cloneTo($M)},$M.cloneTo=function($I){$E.prototype.cloneTo.call(this,$I);var $M=$I;$M.radius=this.radius,$M.emitFromShell=this.emitFromShell,$M.randomDirection=this.randomDirection}}($x),function($E){function $I(){this.radius=NaN,this.emitFromShell=!1,$I.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}$p($I,"laya.d3.core.particleShuriKen.module.shape.SphereShape",$E);var $M=$I.prototype;$M._getShapeBoundBox=function($I){var $M=$I.min.elements;$M[0]=$M[1]=$M[2]=-this.radius;var $E=$I.max.elements;$E[0]=$E[1]=$E[2]=this.radius},$M._getSpeedBoundBox=function($I){var $M=$I.min.elements;$M[0]=$M[1]=$M[2]=-1;var $E=$I.max.elements;$E[0]=$E[1]=$E[2]=1},$M.generatePositionAndDirection=function($I,$M,$E,$Z){$E?($E.seed=$Z[16],this.emitFromShell?$e._randomPointUnitSphere($I,$E):$e._randomPointInsideUnitSphere($I,$E),$Z[16]=$E.seed):this.emitFromShell?$e._randomPointUnitSphere($I):$e._randomPointInsideUnitSphere($I),$cM.scale($I,this.radius,$I),this.randomDirection?$E?($E.seed=$Z[17],$e._randomPointUnitSphere($M,$E),$Z[17]=$E.seed):$e._randomPointUnitSphere($M):$I.cloneTo($M)},$M.cloneTo=function($I){$E.prototype.cloneTo.call(this,$I);var $M=$I;$M.radius=this.radius,$M.emitFromShell=this.emitFromShell,$M.randomDirection=this.randomDirection}}($x),function($I){function $M(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,$M.__super.call(this)}return $p($M,"laya.d3.core.render.SubMeshRenderElement",$P),$M}()),$mM=function($I){function $u($I,$M,$E,$Z,$i,$n){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=$I,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[$pM.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[$hM.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[$hM.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[$vM.SHADERDEFINE_ALPHATEST]="ALPHATEST";$u.__super.call(this,$I,$M,$E,null,{}),this._attributeMap=$Z;var $c;for($c in $i){var $f=$i[$c];switch($f[1]){case 0:this._renderElementUniformMap[$c]=$f[0];break;case 1:this._materialUniformMap[$c]=$f[0];break;case 2:this._spriteUniformMap[$c]=$f[0];break;case 3:this._cameraUniformMap[$c]=$f[0];break;case 4:this._sceneUniformMap[$c]=$f[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}$p($u,"laya.d3.shader.ShaderCompile3D",$$);var $M=$u.prototype;return $M._definesToNameDic=function($I,$M){for(var $E={},$Z=1,$i=0;$i<32&&!($I<($Z=1<<$i));$i++)if($I&$Z){var $n=$M[$Z];$n&&($E[$n]="")}return $E},$M.withCompile=function($I,$M,$E,$Z){var $i,$n,$c;if($n=this.sharders[$I])if($c=$n[$M]){if($i=$c[$E])return $i}else $c=$n[$M]=[];else $c=($n=this.sharders[$I]=[])[$M]=[];var $f,$d=this._definesToNameDic($I,$u._globalInt2name),$H=this._definesToNameDic($M,this._spriteInt2name),$B=this._definesToNameDic($E,this._materialInt2name),$A={},$Q="";if($d)for($f in $d)$Q+="#define "+$f+"\n",$A[$f]=!0;if($H)for($f in $H)$Q+="#define "+$f+"\n",$A[$f]=!0;if($B)for($f in $B)$Q+="#define "+$f+"\n",$A[$f]=!0;var $p=$XM.nameKey.getName(this._name)+" compile ("+$I+","+$M+","+$E+")",$t=this._VS.toscript($A,[]),$V=this._PS.toscript($A,[]);$z.now();if($i=$XM.create($Q+$t.join("\n"),$Q+$V.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,$Z,$p),$c[$E]=$i,laya.d3.shader.ShaderCompile3D.debugMode)$z.now();return $i},$M.precompileShaderWithShaderDefine=function($I,$M,$E){this.withCompile($I,$M,$E,!0)},$M.addMaterialDefines=function($I){var $M=$I.defines;for(var $E in $M){var $Z=$M[$E],$i=parseInt($E);this._materialInt2name[$i]=$Z,this._materialName2Int[$Z]=$i}},$M.addSpriteDefines=function($I){var $M=$I.defines;for(var $E in $M){var $Z=$M[$E],$i=parseInt($E);this._spriteInt2name[$i]=$Z,this._spriteName2Int[$Z]=$i}},$M.getMaterialDefineByName=function($I){return this._materialName2Int[$I]},$M.registerMaterialDefine=function($I){var $M=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[$M]=$I,this._materialName2Int[$I]=$M},$M.registerSpriteDefine=function($I){var $M=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[$M]=$I,this._spriteName2Int[$I]=$M},$u._globalRegDefine=function($I,$M){$u._globalInt2name[$M]=$I},$u.add=function($I,$M,$E,$Z,$i){return laya.d3.shader.ShaderCompile3D._preCompileShader[$I]=new $u($I,$M,$E,$Z,$i,$$.includes)},$u.get=function($I){return laya.d3.shader.ShaderCompile3D._preCompileShader[$XM.nameKey.getID($I)]},$u._preCompileShader={},$u._globalInt2name=[],$u.debugMode=!1,$u.SHADERDEFINE_HIGHPRECISION=1,$u.SHADERDEFINE_FOG=4,$u.SHADERDEFINE_DIRECTIONLIGHT=8,$u.SHADERDEFINE_POINTLIGHT=16,$u.SHADERDEFINE_SPOTLIGHT=32,$u.SHADERDEFINE_UV0=64,$u.SHADERDEFINE_COLOR=128,$u.SHADERDEFINE_UV1=256,$u.SAHDERDEFINE_DEPTHFOG=131072,$u}(),$jM=function($I){function $t(){$t.__super.call(this)}$p($t,"laya.d3.graphics.MeshSprite3DStaticBatchManager",$ZI);var $M=$t.prototype;return $M._getStaticBatch=function($I,$M,$E,$Z){var $i,$n;return $n=$I?$I.id.toString()+$E.id.toString()+$M.id.toString()+$Z.toString():$E.id.toString()+$M.id.toString()+$Z.toString(),this._staticBatches[$n]?$i=this._staticBatches[$n]:this._staticBatches[$n]=$i=new $TM($n,this,$I,$M,$E),$i},$M._initStaticBatchs=function($I){var $M,$E;this._initBatchRenderElements.sort($t._sortPrepareStaticBatch);for(var $Z,$i=!1,$n=0,$c=0,$f=this._initBatchRenderElements.length;$c<$f;$c++){var $d,$H=this._initBatchRenderElements[$c],$B=$H.renderObj._getVertexBuffer(0);$H._sprite3D;if($E===$B.vertexDeclaration&&$M===$H._material)if($i)$Z._addCombineBatchRenderObjTest($H)?($d=$H._staticBatch)!==$Z&&($d&&$d._deleteCombineBatchRenderObj($H),$Z._addCombineBatchRenderObj($H)):($i=!1,$n++);else{var $A=this._initBatchRenderElements[$c-1],$Q=$A.renderObj,$p=$H.renderObj;$i=!(65535<$Q._getVertexBuffer().vertexCount+$p._getVertexBuffer().vertexCount)&&($Z=this._getStaticBatch($I,$E,$M,$n),($d=$A._staticBatch)!==$Z&&($d&&$d._deleteCombineBatchRenderObj($A),$Z._addCombineBatchRenderObj($A)),($d=$H._staticBatch)!==$Z&&($d&&$d._deleteCombineBatchRenderObj($H),$Z._addCombineBatchRenderObj($H)),!0)}else $i=!1,$n=0;$M=$H._material,$E=$B.vertexDeclaration}},$t._sortPrepareStaticBatch=function($I,$M){var $E=$I._render,$Z=$M._render,$i=$E.lightmapIndex-$Z.lightmapIndex;if(0!=$i)return $i;var $n=$E.receiveShadow-$Z.receiveShadow;if(0!=$n)return $n;var $c=$I._mainSortID-$M._mainSortID;return 0==$c?$I.renderObj.triangleCount-$M.renderObj.triangleCount:$c},$t}(),$TM=function($I){function $n($I,$M,$E,$Z,$i){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,$n.__super.call(this,$I,$M,$E),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=$Z,this._material=$i}$p($n,"laya.d3.graphics.SubMeshStaticBatch",$iI);var $M=$n.prototype;return $M._compareBatchRenderElement=function($I,$M){return $I._batchIndexStart>$M._batchIndexStart},$M._addCombineBatchRenderObjTest=function($I){var $M=$I.renderObj._vertexCount;return!(65535<(0<$M?this._currentCombineVertexCount+$M:this._currentCombineVertexCount+$I.renderObj._getVertexBuffer().vertexCount))},$M._addCombineBatchRenderObj=function($I){var $M=$I.renderObj,$E=$M._vertexCount;this._initBatchRenderElements.push($I),$I._staticBatch=this,0<$E?(this._currentCombineIndexCount+=$M._indexCount,this._currentCombineVertexCount+=$E):(this._currentCombineIndexCount=this._currentCombineIndexCount+$M._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+$M._getVertexBuffer().vertexCount),this._needFinishCombine=!0},$M._deleteCombineBatchRenderObj=function($I){var $M=$I.renderObj,$E=this._initBatchRenderElements.indexOf($I);if(-1!==$E){this._initBatchRenderElements.splice($E,1),$I._staticBatch=null;var $Z=$M._vertexCount;0<$Z?(this._currentCombineIndexCount=this._currentCombineIndexCount-$M._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$Z):(this._currentCombineIndexCount=this._currentCombineIndexCount-$M._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-$M._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},$M._finishInit=function(){if(this._needFinishCombine){var $I=0,$M=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var $E=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),$Z=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=$xM.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=$JM.create("ushort",this._currentCombineIndexCount,35044);for(var $i=0,$n=this._initBatchRenderElements.length;$i<$n;$i++){var $c=this._initBatchRenderElements[$i],$f=$c.renderObj,$d=$f._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,$c._sprite3D),$H=$f.getIndices(),$B=$c._sprite3D.transform._isFrontFaceInvert,$A=$I/(this._vertexDeclaration.vertexStride/4)-$f._vertexStart,$Q=$M,$p=$Q+$H.length;$c._batchIndexStart=$Q,$c._batchIndexEnd=$p,$Z.set($H,$M);var $t=0;if($B)for($t=$Q;$t<$p;$t+=3){$Z[$t]=$A+$Z[$t];var $V=$Z[$t+1],$u=$Z[$t+2];$Z[$t+1]=$A+$u,$Z[$t+2]=$A+$V}else for($t=$Q;$t<$p;$t+=3)$Z[$t]=$A+$Z[$t],$Z[$t+1]=$A+$Z[$t+1],$Z[$t+2]=$A+$Z[$t+2];$M+=$H.length,$E.set($d,$I),$I+=$d.length}this._vertexBuffer.setData($E),this._indexBuffer.setData($Z),this._needFinishCombine=!1}},$M._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new $aM)},$M._getRenderElement=function($I,$M,$E){for(var $Z,$i,$n=this._batchRenderElements.length,$c=!0,$f=0;$f<$n;$f++){var $d,$H,$B=($i=this._batchRenderElements[$f])._sprite3D._render;if(0!==$f&&($c=($d=($Z=this._batchRenderElements[$f-1])._sprite3D._render).lightmapIndex!==$B.lightmapIndex||$d.receiveShadow!==$B.receiveShadow||$Z._batchIndexEnd!==$i._batchIndexStart),$c){($H=this._getCombineRenderElementFromPool()).renderObj=this,$H._material=this._material,$H._batchIndexStart=$i._batchIndexStart,$H._batchIndexEnd=$i._batchIndexEnd;var $A=$B.lightmapIndex,$Q=$A+1,$p=this._batchOwnerIndices[$Q];$p||($p=this._batchOwnerIndices[$Q]=[]);var $t,$V=$p[$i._render.receiveShadow?1:0];void 0===$V?($p[$B.receiveShadow?1:0]=this._batchOwners.length,($t=new $DM(null,"StaticBatchMeshSprite3D"))._scene=$M,$t._transform=this._rootOwner?this._rootOwner._transform:null,$t._render.lightmapIndex=$A,$t._render.receiveShadow=$i._render.receiveShadow,this._batchOwners.push($t)):$t=this._batchOwners[$V],$t._render._renderUpdate($E),$H._sprite3D=$t,$I.push($H)}else $H._batchIndexEnd=$i._batchIndexEnd}},$M._beforeRender=function($I){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$M._render=function($I){var $M=$I.renderElement,$E=$M._batchIndexStart,$Z=$M._batchIndexEnd-$E;$W.mainContext.drawElements(4,$Z,5123,2*$E),$m.drawCall++,$m.trianglesFaces+=$Z/3},$M.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},$M._getVertexBuffer=function($I){return void 0===$I&&($I=0),this._vertexBuffer},$n}(),$qM=function($I){function $M(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,$M.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}$p($M,"laya.d3.core.ComponentNode",$H);var $E=$M.prototype;return $E.addComponent=function($I){var $M,$E=this._componentsMap.indexOf($I);if(-1===$E)$M=[],this._componentsMap.push($I),this._typeComponentsIndices.push($M);else if($M=this._typeComponentsIndices[$E],this._components[$M[0]].isSingleton)throw new Error("无法单实例创建"+$I+"组件，"+$I+"组件已存在！");var $Z=$i.getInstance($I);return $M.push(this._components.length),this._components.push($Z),$Z instanceof laya.d3.component.Script&&this._scripts.push($Z),$Z._initialize(this),$Z},$E._removeComponent=function($I,$M){var $E=this._typeComponentsIndices[$I],$Z=$E[$M],$i=this._components[$Z];this._components.splice($Z,1),$i instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($i),1),$E.splice($M,1),0===$E.length&&(this._typeComponentsIndices.splice($I,1),this._componentsMap.splice($I,1));for(var $n=0,$c=this._componentsMap.length;$n<$c;$n++)for(var $f=($E=this._typeComponentsIndices[$n]).length-1;0<=$f;$f--){var $d=$E[$f];if(!($Z<$d))break;$E[$f]=--$d}$i._destroy()},$E.getComponentByType=function($I,$M){void 0===$M&&($M=0);var $E=this._componentsMap.indexOf($I);return-1===$E?null:this._components[this._typeComponentsIndices[$E][$M]]},$E.getComponentsByType=function($I,$M){var $E=this._componentsMap.indexOf($I);if(-1!==$E){var $Z=this._typeComponentsIndices[$E],$i=$Z.length;$M.length=$i;for(var $n=0;$n<$i;$n++)$M[$n]=this._components[$Z[$n]]}else $M.length=0},$E.getComponentByIndex=function($I){return this._components[$I]},$E.removeComponentByType=function($I,$M){void 0===$M&&($M=0);var $E=this._componentsMap.indexOf($I);-1!==$E&&this._removeComponent($E,$M)},$E.removeComponentsByType=function($I){var $M=this._componentsMap.indexOf($I);if(-1!==$M)for(var $E=this._typeComponentsIndices[$M],$Z=0,$i=$E.length;$Z<$i;$E.length<$i?$i--:$Z++)this._removeComponent($M,$Z)},$E.removeAllComponent=function(){for(var $I=0,$M=this._componentsMap.length;$I<$M;this._componentsMap.length<$M?$M--:$I++)this.removeComponentsByType(this._componentsMap[$I])},$E._updateComponents=function($I){for(var $M=0,$E=this._components.length;$M<$E;$M++){var $Z=this._components[$M];!$Z.started&&($Z._start($I),$Z.started=!0),$Z.enable&&$Z._update($I)}},$E._lateUpdateComponents=function($I){for(var $M=0;$M<this._components.length;$M++){var $E=this._components[$M];!$E.started&&($E._start($I),$E.started=!0),$E.enable&&$E._lateUpdate($I)}},$E._preRenderUpdateComponents=function($I){for(var $M=0;$M<this._components.length;$M++){var $E=this._components[$M];!$E.started&&($E._start($I),$E.started=!0),$E.enable&&$E._preRenderUpdate($I)}},$E._postRenderUpdateComponents=function($I){for(var $M=0;$M<this._components.length;$M++){var $E=this._components[$M];!$E.started&&($E._start($I),$E.started=!0),$E.enable&&$E._postRenderUpdate($I)}},$M}(),$vM=function($Z){function $I(){$I.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new $QM,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new $fM(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}$p($I,"laya.d3.core.material.BaseMaterial",$Z);var $M=$I.prototype;return $g.imps($M,{"laya.d3.core.IClone":!0}),$M._addShaderDefine=function($I){this._shaderDefineValue|=$I},$M._removeShaderDefine=function($I){this._shaderDefineValue&=~$I},$M._addDisablePublicShaderDefine=function($I){this._disablePublicShaderDefine|=$I},$M._removeDisablePublicShaderDefine=function($I){this._disablePublicShaderDefine&=~$I},$M._setBuffer=function($I,$M){this._shaderValues.setValue($I,$M),this._values[$I]=$M},$M._getBuffer=function($I){return this._values[$I]},$M._setMatrix4x4=function($I,$M){this._shaderValues.setValue($I,$M?$M.elements:null),this._values[$I]=$M},$M._getMatrix4x4=function($I){return this._values[$I]},$M._setInt=function($I,$M){this._shaderValues.setValue($I,$M),this._values[$I]=$M},$M._getInt=function($I){return this._values[$I]},$M._setNumber=function($I,$M){this._shaderValues.setValue($I,$M),this._values[$I]=$M},$M._getNumber=function($I){return this._values[$I]},$M._setBool=function($I,$M){this._shaderValues.setValue($I,$M),this._values[$I]=$M},$M._getBool=function($I){return this._values[$I]},$M._setVector2=function($I,$M){this._shaderValues.setValue($I,$M?$M.elements:null),this._values[$I]=$M},$M._getVector2=function($I){return this._values[$I]},$M._setColor=function($I,$M){this._shaderValues.setValue($I,$M?$M.elements:null),this._values[$I]=$M},$M._getColor=function($I){return this._values[$I]},$M._setTexture=function($I,$M){var $E=this._values[$I];this._values[$I]=$M,this._shaderValues.setValue($I,$M),0<this.referenceCount&&($E&&$E._removeReference(),$M&&$M._addReference())},$M._getTexture=function($I){return this._values[$I]},$M._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},$M._getShader=function($I,$M,$E){var $Z=($I|$M)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile($Z,$E,this._shaderDefineValue),this._shader},$M._setRenderStateBlendDepth=function(){var $I=$W.mainContext;switch($R.setDepthMask($I,this.depthWrite),0===this.depthTest?$R.setDepthTest($I,!1):($R.setDepthTest($I,!0),$R.setDepthFunc($I,this.depthTest)),this.blend){case 0:$R.setBlend($I,!1);break;case 1:$R.setBlend($I,!0),$R.setBlendFunc($I,this.srcBlend,this.dstBlend);break;case 2:$R.setBlend($I,!0)}},$M._setRenderStateFrontFace=function($I,$M){var $E=$W.mainContext,$Z=0;switch(this.cull){case 0:$R.setCullFace($E,!1);break;case 1:$R.setCullFace($E,!0),$Z=$I?$M&&$M._isFrontFaceInvert?2305:2304:$M&&$M._isFrontFaceInvert?2304:2305,$R.setFrontFace($E,$Z);break;case 2:$R.setCullFace($E,!0),$Z=$I?$M&&$M._isFrontFaceInvert?2304:2305:$M&&$M._isFrontFaceInvert?2305:2304,$R.setFrontFace($E,$Z)}},$M.onAsynLoaded=function($I,$M,$E){var $Z=$M[0],$i=$M[1];switch($Z.version){case"LAYAMATERIAL:01":var $n=0,$c=0,$f=$Z.props;for(var $d in $f)switch($d){case"vectors":var $H=$f[$d];for($n=0,$c=$H.length;$n<$c;$n++){var $B=$H[$n],$A=$B.value;switch($A.length){case 2:this[$B.name]=new $nM($A[0],$A[1]);break;case 3:this[$B.name]=new $cM($A[0],$A[1],$A[2]);break;case 4:this[$B.name]=new $fM($A[0],$A[1],$A[2],$A[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var $Q=$f[$d];for($n=0,$c=$Q.length;$n<$c;$n++){var $p=$Q[$n],$t=$p.path;$t&&(this[$p.name]=$N.getRes($i[$t]))}break;case"defines":var $V=$f[$d];for($n=0,$c=$V.length;$n<$c;$n++){var $u=this._shaderCompile.getMaterialDefineByName($V[$n]);this._addShaderDefine($u)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[$d]=$f[$d];break;case"renderQueue":switch($f[$d]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[$d]=$f[$d]}break;case"LAYAMATERIAL:02":for($d in $f=$Z.props)switch($d){case"vectors":for($n=0,$c=($H=$f[$d]).length;$n<$c;$n++)switch(($A=($B=$H[$n]).value).length){case 2:this[$B.name]=new $nM($A[0],$A[1]);break;case 3:this[$B.name]=new $cM($A[0],$A[1],$A[2]);break;case 4:this[$B.name]=new $fM($A[0],$A[1],$A[2],$A[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for($n=0,$c=($Q=$f[$d]).length;$n<$c;$n++)($t=($p=$Q[$n]).path)&&(this[$p.name]=$N.getRes($i[$t]));break;case"defines":for($n=0,$c=($V=$f[$d]).length;$n<$c;$n++)$u=this._shaderCompile.getMaterialDefineByName($V[$n]),this._addShaderDefine($u);break;default:this[$d]=$f[$d]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},$M._addReference=function(){$Z.prototype._addReference.call(this);for(var $I=0,$M=this._values.length;$I<$M;$I++){var $E=this._values[$I];$E&&$E instanceof laya.d3.resource.BaseTexture&&$E._addReference()}},$M._removeReference=function(){$Z.prototype._removeReference.call(this);for(var $I=0,$M=this._values.length;$I<$M;$I++){var $E=this._values[$I];$E&&$E instanceof laya.d3.resource.BaseTexture&&$E._removeReference()}},$M.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},$M.setShaderName=function($I){var $M=$XM.nameKey.getID($I);if(-1===$M)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=$mM._preCompileShader[$M]},$M.cloneTo=function($I){var $M=$I;$M.name=this.name,$M.cull=this.cull,$M.blend=this.blend,$M.srcBlend=this.srcBlend,$M.dstBlend=this.dstBlend,$M.srcBlendRGB=this.srcBlendRGB,$M.dstBlendRGB=this.dstBlendRGB,$M.srcBlendAlpha=this.srcBlendAlpha,$M.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo($M.blendConstColor),$M.blendEquation=this.blendEquation,$M.blendEquationRGB=this.blendEquationRGB,$M.blendEquationAlpha=this.blendEquationAlpha,$M.depthTest=this.depthTest,$M.depthWrite=this.depthWrite,$M.renderQueue=this.renderQueue,$M._shader=this._shader,$M._disablePublicShaderDefine=this._disablePublicShaderDefine,$M._shaderDefineValue=this._shaderDefineValue;var $E,$Z=0,$i=$M._shaderValues;$M._shaderValues.data.length=this._shaderValues.data.length;var $n=this._values.length,$c=$M._values;for($Z=0,$E=$c.length=$n;$Z<$E;$Z++){var $f=this._values[$Z];if($f)if("number"==typeof $f)$c[$Z]=$f,$i.data[$Z]=$f;else if("number"==typeof $f&&Math.floor($f)==$f)$c[$Z]=$f,$i.data[$Z]=$f;else if("boolean"==typeof $f)$c[$Z]=$f,$i.data[$Z]=$f;else if($f instanceof laya.d3.math.Vector2){var $d=$c[$Z]||($c[$Z]=new $nM);$f.cloneTo($d),$i.data[$Z]=$d.elements}else if($f instanceof laya.d3.math.Vector3){var $H=$c[$Z]||($c[$Z]=new $cM);$f.cloneTo($H),$i.data[$Z]=$H.elements}else if($f instanceof laya.d3.math.Vector4){var $B=$c[$Z]||($c[$Z]=new $fM);$f.cloneTo($B),$i.data[$Z]=$B.elements}else if($f instanceof laya.d3.math.Matrix4x4){var $A=$c[$Z]||($c[$Z]=new $IM);$f.cloneTo($A),$i.data[$Z]=$A.elements}else $f instanceof laya.d3.resource.BaseTexture&&($c[$Z]=$f,$i.data[$Z]=$f)}},$M.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$t(0,$M,"alphaTestValue",function(){return this._getNumber(0)},function($I){this._setNumber(0,$I)}),$t(0,$M,"alphaTest",function(){return this._alphaTest},function($I){(this._alphaTest=$I)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),$I.__init__=function(){$I.SHADERDEFINE_ALPHATEST=$I.shaderDefines.registerDefine("ALPHATEST")},$I.RENDERQUEUE_OPAQUE=2e3,$I.RENDERQUEUE_ALPHATEST=2450,$I.RENDERQUEUE_TRANSPARENT=3e3,$I.CULL_NONE=0,$I.CULL_FRONT=1,$I.CULL_BACK=2,$I.BLEND_DISABLE=0,$I.BLEND_ENABLE_ALL=1,$I.BLEND_ENABLE_SEPERATE=2,$I.BLENDPARAM_ZERO=0,$I.BLENDPARAM_ONE=1,$I.BLENDPARAM_SRC_COLOR=768,$I.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,$I.BLENDPARAM_DST_COLOR=774,$I.BLENDPARAM_ONE_MINUS_DST_COLOR=775,$I.BLENDPARAM_SRC_ALPHA=770,$I.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,$I.BLENDPARAM_DST_ALPHA=772,$I.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,$I.BLENDPARAM_SRC_ALPHA_SATURATE=776,$I.BLENDEQUATION_ADD=0,$I.BLENDEQUATION_SUBTRACT=1,$I.BLENDEQUATION_REVERSE_SUBTRACT=2,$I.DEPTHTEST_OFF=0,$I.DEPTHTEST_NEVER=512,$I.DEPTHTEST_LESS=513,$I.DEPTHTEST_EQUAL=514,$I.DEPTHTEST_LEQUAL=515,$I.DEPTHTEST_GREATER=516,$I.DEPTHTEST_NOTEQUAL=517,$I.DEPTHTEST_GEQUAL=518,$I.DEPTHTEST_ALWAYS=519,$I.SHADERDEFINE_ALPHATEST=1,$I.ALPHATESTVALUE=0,$A($I,["shaderDefines",function(){return this.shaderDefines=new $BM}]),$I}($u),$WM=function($I){function $M(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,$M.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}$p($M,"laya.d3.resource.BaseTexture",$u);var $E=$M.prototype;return $t(0,$E,"width",function(){return this._width}),$t(0,$E,"repeat",function(){return this._repeat},function($I){if(this._repeat!==$I&&(this._repeat=$I,this._source)){var $M=$W.mainContext;$R.bindTexture($M,this._type,this._source),$w.isPOT(this._width,this._height)&&this._repeat?($M.texParameteri(this._type,10242,10497),$M.texParameteri(this._type,10243,10497)):($M.texParameteri(this._type,10242,33071),$M.texParameteri(this._type,10243,33071))}}),$t(0,$E,"height",function(){return this._height}),$t(0,$E,"magFifter",function(){return this._magFifter},function($I){(this._magFifter=$I)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter($I)}),$t(0,$E,"wrapModeV",function(){return this._wrapModeV}),$t(0,$E,"size",function(){return this._size}),$t(0,$E,"wrapModeU",function(){return this._wrapModeU}),$t(0,$E,"mipmap",function(){return this._mipmap},function($I){this._mipmap=$I,this._mipmap!=$I&&this._conchTexture&&this._conchTexture.setMipMap($I)}),$t(0,$E,"minFifter",function(){return this._minFifter},function($I){this._minFifter=$I,this._minFifter!=$I&&this._conchTexture&&this._conchTexture.setMinFifter($I)}),$t(0,$E,"format",function(){return this._format}),$t(0,$E,"source",function(){return this.activeResource(),this._source}),$t(0,$E,"defaulteTexture",function(){return $FM.grayTexture}),$M.WARPMODE_REPEAT=0,$M.WARPMODE_CLAMP=1,$M}(),$RM=function($I){function $M(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,$M.__super.call(this),this._boundingBoxCorners=$Z(8,null)}$p($M,"laya.d3.resource.models.BaseMesh",$u);var $E=$M.prototype;return $E._getPositions=function(){throw new Error("未Override,请重载该属性！")},$E._generateBoundingObject=function(){this._boundingSphere=new $sI(new $cM,0),$sI.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new $YI(new $cM,new $cM),$YI.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},$E.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},$E.getRenderElement=function($I){throw new Error("未Override,请重载该属性！")},$t(0,$E,"subMeshCount",function(){return this._subMeshCount}),$t(0,$E,"boundingBox",function(){return this._boundingBox}),$t(0,$E,"boundingBoxCorners",function(){return this._boundingBoxCorners}),$t(0,$E,"boundingSphere",function(){return this._boundingSphere}),$M}(),$zM=(function($I){function $M(){$M.__super.call(this)}$p($M,"laya.d3.component.Script",$$M);var $E=$M.prototype;$E.onTriggerEnter=function($I){},$E.onTriggerExit=function($I){},$E.onTriggerStay=function($I){},$t(0,$E,"isSingleton",function(){return $M._isSingleton}),$M._isSingleton=!1}(),function($I){function $M($I){this._owner=null,this._sharedMesh=null,$M.__super.call(this),this._owner=$I}$p($M,"laya.d3.core.MeshFilter",$I);var $E=$M.prototype;return $E._sharedMeshLoaded=function(){this.event("loaded")},$E._destroy=function(){$I.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},$t(0,$E,"sharedMesh",function(){return this._sharedMesh},function($I){var $M=this._sharedMesh;$M&&$M._removeReference(),(this._sharedMesh=$I)._addReference(),this.event("meshchanged",[this,$M,$I]),$I.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),$t(0,$E,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),$t(0,$E,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),$t(0,$E,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),$t(0,$E,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),$M}($wM)),$LM=function($I){function $M($I){$M.__super.call(this,$I),$I.meshFilter.on("meshchanged",this,this._onMeshChanged)}$p($M,"laya.d3.core.MeshRender",$gM);var $E=$M.prototype;return $E._onMeshChanged=function($I,$M,$E){$E.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:$E.once("loaded",this,this._onMeshLoaed)},$E._onMeshLoaed=function($I,$M){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},$E._calculateBoundingSphereByInitSphere=function($I){var $M=NaN,$E=this._owner.transform,$Z=$E.scale.elements,$i=Math.abs($Z[0]),$n=Math.abs($Z[1]),$c=Math.abs($Z[2]);$M=$n<=$i&&$c<=$i?$i:$c<=$n?$n:$c,$cM.transformCoordinate($I.center,$E.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=$I.radius*$M},$E._calculateBoundBoxByInitCorners=function($I){for(var $M=this._owner.transform.worldMatrix,$E=0;$E<8;$E++)$cM.transformCoordinate($I[$E],$M,$gM._tempBoundBoxCorners[$E]);$YI.createfromPoints($gM._tempBoundBoxCorners,this._boundingBox)},$E._calculateBoundingSphere=function(){var $I=this._owner.meshFilter.sharedMesh;null==$I||null==$I.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere($I.boundingSphere)},$E._calculateBoundingBox=function(){var $I=this._owner.meshFilter.sharedMesh;null==$I||null==$I.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners($I.boundingBoxCorners)},$E._renderUpdate=function($I){var $M=this._owner.transform;if($M){this._setShaderValueMatrix4x4(0,$M.worldMatrix);var $E=this._owner.getProjectionViewWorldMatrix($I);this._setShaderValueMatrix4x4(1,$E)}else this._setShaderValueMatrix4x4(0,$IM.DEFAULT),this._setShaderValueMatrix4x4(1,$I);return $NM.debugMode&&this._renderRenderableBoundBox(),!0},$M}(),$oM=function($M){function $Z(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,$Z.__super.call(this),this._renderState=new $G,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new $QM,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new $MI,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new $cM(.7,.7,.7),this.ambientColor=new $cM(.212,.227,.259),$W.shaderHighPrecision&&this.addShaderDefine($mM.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}$p($Z,"laya.d3.core.scene.Scene",$M);var $I=$Z.prototype;return $g.imps($I,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),$I._setUrl=function($I){this._url=$I},$I._getGroup=function(){return this._group},$I._setGroup=function($I){this._group=$I},$I._display=function(){$g.stage._scenes.push(this),$g.stage._scenes.sort($Z._sortScenes);for(var $I=0,$M=this._childs.length;$I<$M;$I++){var $E=this._childs[$I];$E.active&&$E._activeHierarchy()}},$I._unDisplay=function(){var $I=$g.stage._scenes;$I.splice($I.indexOf(this),1);for(var $M=0,$E=this._childs.length;$M<$E;$M++){var $Z=this._childs[$M];$Z.active&&$Z._inActiveHierarchy()}},$I._addChild3D=function($I){$I.transform._onWorldTransform(),$I._setBelongScene(this),this.displayedInStage&&$I.active&&$I._activeHierarchy()},$I._removeChild3D=function($I){$I.transform.parent=null,this.displayedInStage&&$I.active&&$I._inActiveHierarchy(),$I._setUnBelongScene()},$I.initOctree=function($I,$M,$E,$Z,$i){void 0===$i&&($i=6),this.treeSize=new $cM($I,$M,$E),this.treeLevel=$i,this.treeRoot=new $Y(this,0),this.treeRoot.init($Z,this.treeSize)},$I._prepareUpdateToRenderState=function($I,$M){$M.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,$M.scene=this},$I._prepareSceneToRender=function($I){var $M=this._lights.length;if(0<$M)for(var $E=0,$Z=0;$Z<$M&&!(this._lights[$Z]._prepareToScene($I)&&++$E>=this._enableLightCount);$Z++);},$I._updateChilds=function($I){for(var $M=0,$E=this._childs.length;$M<$E;++$M)this._childs[$M]._update($I)},$I._preRenderScene=function($I,$M,$E){var $Z,$i=$M._viewMatrix,$n=$M._projectionMatrix,$c=$M._projectionViewMatrix,$f=0,$d=$M.camera;for($d.useOcclusionCulling?this.treeRoot?$EI.renderObjectCullingOctree($E,this,$d,$i,$n,$c):$EI.renderObjectCulling($E,this,$d,$i,$n,$c):$EI.renderObjectCullingNoBoundFrustum(this,$d,$i,$n,$c),$f=0,$Z=this._quenes.length;$f<$Z;$f++)this._quenes[$f]&&this._quenes[$f]._preRender($M)},$I._clear=function($I,$M){var $E=$M._viewport,$Z=$M.camera,$i=$E.x,$n=$Z.renderTargetSize.height-$E.y-$E.height,$c=$E.width,$f=$E.height;$I.viewport($i,$n,$c,$f);var $d=256,$H=$Z.renderTarget;switch($Z.clearFlag){case 0:var $B=$Z.clearColor;if($B){$I.enable(3089),$I.scissor($i,$n,$c,$f);var $A=$B.elements;$I.clearColor($A[0],$A[1],$A[2],$A[3]),$d|=16384}if($H)switch($B||($d=16384),$H.depthStencilFormat){case 33189:$d|=256;break;case 36168:$d|=1024;break;case 34041:$d|=256,$d|=1024}$I.clear($d),$B&&$I.disable(3089);break;case 1:case 2:if($H)switch($d=16384,$H.depthStencilFormat){case 33189:$d|=256;break;case 36168:$d|=1024;break;case 34041:$d|=256,$d|=1024}$I.clear($d);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},$I._renderScene=function($I,$M){var $E,$Z,$i=$M.camera,$n=0;for($n=0;$n<2;$n++)($Z=this._quenes[$n])&&($i.renderTarget?$Z._render($M,!0):$Z._render($M,!1));if(1===$i.clearFlag){var $c=$i.sky;$c&&($R.setCullFace($I,!1),$R.setDepthFunc($I,515),$R.setDepthMask($I,!1),$c._render($M),$R.setDepthFunc($I,513),$R.setDepthMask($I,!0))}for($n=2,$E=this._quenes.length;$n<$E;$n++)($Z=this._quenes[$n])&&($Z._sortAlpha($M.camera.transform.position),$i.renderTarget?$Z._render($M,!0):$Z._render($M,!1))},$I._set3DRenderConfig=function($I){$I.disable(3042),$R._blend=!1,$I.blendFunc(770,771),$R._sFactor=770,$R._dFactor=771,$I.disable(2929),$R._depthTest=!1,$I.enable(2884),$R._cullFace=!0,$I.depthMask(1),$R._depthMask=!0,$I.frontFace(2304),$R._frontFace=2304},$I._set2DRenderConfig=function($I){$R.setBlend($I,!0),$R.setBlendFunc($I,1,771),$R.setDepthTest($I,!1),$R.setCullFace($I,!1),$R.setDepthMask($I,!0),$R.setFrontFace($I,2305),$I.viewport(0,0,$B.width,$B.height)},$I._parseCustomProps=function($I,$M,$E,$Z){var $i=$Z.customProps.lightmaps,$n=$i.length,$c=this._lightmaps;$c.length=$n;for(var $f=0;$f<$n;$f++)$c[$f]=$N.getRes($M[$i[$f].replace(".exr",".png")]);this.setlightmaps($c);var $d=$Z.customProps.ambientColor;$d&&(this.ambientColor=new $cM($d[0],$d[1],$d[2]));var $H=$Z.customProps.fogColor;$H&&(this.fogColor=new $cM($H[0],$H[1],$H[2]))},$I._addLight=function($I){this._lights.indexOf($I)<0&&this._lights.push($I)},$I._removeLight=function($I){var $M=this._lights.indexOf($I);0<=$M&&this._lights.splice($M,1)},$I._updateScene=function(){var $I=this._renderState;this._prepareUpdateToRenderState($W.mainContext,$I),this._updateComponents($I),this._updateChilds($I),this._lateUpdateComponents($I),this._time+=$I.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},$I._updateSceneConch=function(){var $I=this._renderState;this._prepareUpdateToRenderState($W.mainContext,$I),this._updateComponents($I),this._lateUpdateComponents($I),this._prepareSceneToRender($I);for(var $M=0,$E=this._cameraPool.length;$M<$E;$M++){var $Z=this._cameraPool[$M];($I.camera=$Z)._prepareCameraToRender()}},$I._preRenderShadow=function($I,$M,$E,$Z,$i){this.treeRoot?$EI.renderShadowObjectCullingOctree(this,$M,$E,$Z,$i):$EI.renderShadowObjectCulling(this,$M,$E,$Z,$i);for(var $n=0,$c=$E.length;$n<$c;$n++)$E[$n]&&$E[$n]._preRender($I)},$I._renderShadowMap=function($I,$M,$E){var $Z=this.parallelSplitShadowMaps[0];$Z._calcAllLightCameraInfo($E);var $i,$n,$c,$f=$Z.PSSMNum;if(this._preRenderShadow($M,$Z._lightCulling,$Z._shadowQuenes,$Z._lightVPMatrix[0],$f),this.addShaderDefine($pM.SHADERDEFINE_CAST_SHADOW),1<$f)for(var $d=0;$d<$f;$d++)$i=$Z.getRenderTarget($d+1),$Z.beginRenderTarget($d+1),$I.clearColor(1,1,1,1),$I.clear(16640),$I.viewport(0,0,$i.width,$i.height),$M.camera=$c=$Z.getLightCamera($d),$c._prepareCameraToRender(),$c._prepareCameraViewProject($c.viewMatrix,$c.projectionMatrix),$M._projectionViewMatrix=$Z._lightVPMatrix[$d+1],($n=$Z._shadowQuenes[$d])._preRender($M),$n._renderShadow($M,!1),$Z.endRenderTarget($d+1);else $i=$Z.getRenderTarget(1),$Z.beginRenderTarget(1),$I.clearColor(1,1,1,1),$I.clear(16640),$I.viewport(0,0,$i.width,$i.height),$M.camera=$c=$Z.getLightCamera(0),$c._prepareCameraToRender(),$c._prepareCameraViewProject($c.viewMatrix,$c.projectionMatrix),$M._projectionViewMatrix=$Z._lightVPMatrix[0],($n=$Z._shadowQuenes[0])._preRender($M),$n._renderShadow($M,!0),$Z.endRenderTarget(1);this.removeShaderDefine($pM.SHADERDEFINE_CAST_SHADOW)},$I.addTreeNode=function($I){this.treeRoot.addTreeNode($I)},$I.removeTreeNode=function($I){this.treeSize&&$I._treeNode&&$I._treeNode.removeObject($I)},$I.setlightmaps=function($I){this._lightmaps=$I;for(var $M=0,$E=this._renderableSprite3Ds.length;$M<$E;$M++)this._renderableSprite3Ds[$M]._render._applyLightMapParams()},$I.getlightmaps=function(){return this._lightmaps},$I.addChildAt=function($I,$M){if(!($I instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+($I&&$I.__className));if(!$I||this.destroyed||$I===this)return $I;if($I.zOrder&&this._set$P("hasZorder",!0),0<=$M&&$M<=this._childs.length){if($I._parent===this){var $E=this.getChildIndex($I);this._childs.splice($E,1),this._childs.splice($M,0,$I),this.conchModel&&(this.conchModel.removeChild($I.conchModel),this.conchModel.addChildAt($I.conchModel,$M)),this._childChanged()}else $I.parent&&$I.parent.removeChild($I),this._childs===$H.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($M,0,$I),this.conchModel&&this.conchModel.addChildAt($I.conchModel,$M),($I.parent=this)._addChild3D($I);return $I}throw new Error("appendChildAt:The index is out of bounds")},$I.addChild=function($I){if(!($I instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$I||this.destroyed||$I===this)return $I;if($I.zOrder&&this._set$P("hasZorder",!0),$I._parent===this){var $M=this.getChildIndex($I);$M!==this._childs.length-1&&(this._childs.splice($M,1),this._childs.push($I),this.conchModel&&(this.conchModel.removeChild($I.conchModel),this.conchModel.addChildAt($I.conchModel,this._childs.length-1)),this._childChanged())}else $I.parent&&$I.parent.removeChild($I),this._childs===$H.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($I),this.conchModel&&this.conchModel.addChildAt($I.conchModel,this._childs.length-1),($I.parent=this)._childChanged(),this._addChild3D($I);return $I},$I.removeChildAt=function($I){var $M=this.getChildAt($I);return $M&&(this._removeChild3D($M),this._childs.splice($I,1),this.conchModel&&this.conchModel.removeChild($M.conchModel),$M.parent=null),$M},$I.removeChildren=function($I,$M){if(void 0===$I&&($I=0),void 0===$M&&($M=2147483647),this._childs&&0<this._childs.length){var $E=this._childs;if(0===$I&&$n<=$M){var $Z=$E;this._childs=$H.ARRAY_EMPTY}else $Z=$E.splice($I,$M-$I);for(var $i=0,$n=$Z.length;$i<$n;$i++)this._removeChild3D($Z[$i]),$Z[$i].parent=null,this.conchModel&&this.conchModel.removeChild($Z[$i].conchModel)}return this},$I.addFrustumCullingObject=function($I){this.treeRoot?this.addTreeNode($I):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push($I):this._cullingRenders[this._cullingRendersLength]=$I,$I._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},$I.removeFrustumCullingObject=function($I){if(this.treeRoot)this.removeTreeNode($I);else{this._cullingRendersLength--;var $M=$I._indexInSceneFrustumCullingObjects;if($M!==this._cullingRendersLength){var $E=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[$M]=$E)._indexInSceneFrustumCullingObjects=$M,$I._indexInSceneFrustumCullingObjects=-1}}},$I.getRenderQueue=function($I){return $I<3e3?this._quenes[1]||(this._quenes[1]=new $D(this)):this._quenes[2]||(this._quenes[2]=new $D(this))},$I.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new $D(this)},$I.addShaderDefine=function($I){this._shaderDefineValue|=$I},$I.removeShaderDefine=function($I){this._shaderDefineValue&=~$I},$I.addScript=function($I){return this._addComponent($I)},$I.getScriptByType=function($I,$M){return void 0===$M&&($M=0),this._getComponentByType($I,$M)},$I.getScriptsByType=function($I,$M){this._getComponentsByType($I,$M)},$I.getScriptByIndex=function($I){return this._getComponentByIndex($I)},$I.removeScriptByType=function($I,$M){void 0===$M&&($M=0),this._removeComponentByType($I,$M)},$I.removeScriptsByType=function($I){this._removeComponentByType($I)},$I.removeAllScript=function(){this._removeAllComponent()},$I.render=function($I,$M,$E){($V._context.ctx._renderKey=0)<this._childs.length&&$I.addRenderObject(this)},$I.renderSubmit=function(){var $I=$W.mainContext,$M=this._renderState;this._set3DRenderConfig($I),this._prepareSceneToRender(this._renderState);var $E,$Z=0,$i=0;if($NM.debugMode||$Y.debugMode)for($Z=0,$i=this._cameraPool.length;$Z<$i;$Z++)$E=this._cameraPool[$Z],$NM._debugPhasorSprite.begin(1,$E),$E.activeInHierarchy&&$E._renderCamera($I,$M,this),$NM._debugPhasorSprite.end();else for($Z=0,$i=this._cameraPool.length;$Z<$i;$Z++)($E=this._cameraPool[$Z]).activeInHierarchy&&$E._renderCamera($I,$M,this);return this._set2DRenderConfig($I),1},$I.onAsynLoaded=function($I,$M,$E){var $Z=$M[0];if("Scene"!==$Z.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var $i=$M[1];$uM._createNodeByJson(this,$Z,this,$i),this.event("hierarchyloaded",[this]),this.__loaded=!0},$I.destroy=function($I){void 0===$I&&($I=!0),this.destroyed||($M.prototype.destroy.call(this,$I),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,$N.clearRes(this.url),this.loaded||$NM._cancelLoadByUrl(this.url))},$I.getRenderType=function(){return 0},$I.releaseRender=function(){},$I._addComponent=function($I){var $M,$E=this._componentsMap.indexOf($I);if(-1===$E)$M=[],this._componentsMap.push($I),this._typeComponentsIndices.push($M);else if($M=this._typeComponentsIndices[$E],this._components[$M[0]].isSingleton)throw new Error("无法单实例创建"+$I+"组件，"+$I+"组件已存在！");var $Z=$i.getInstance($I);$M.push(this._components.length),this._components.push($Z);return $Z._initialize(this),$Z},$I._removeComponent=function($I,$M){var $E=this._typeComponentsIndices[$I],$Z=$E[$M],$i=this._components[$Z];this._components.splice($Z,1),$E.splice($M,1),0===$E.length&&(this._typeComponentsIndices.splice($I,1),this._componentsMap.splice($I,1));for(var $n=0,$c=this._componentsMap.length;$n<$c;$n++)for(var $f=($E=this._typeComponentsIndices[$n]).length-1;0<=$f;$f--){var $d=$E[$f];if(!($Z<$d))break;$E[$f]=--$d}$i._destroy()},$I._getComponentByType=function($I,$M){void 0===$M&&($M=0);var $E=this._componentsMap.indexOf($I);return-1===$E?null:this._components[this._typeComponentsIndices[$E][$M]]},$I._getComponentsByType=function($I,$M){var $E=this._componentsMap.indexOf($I);if(-1!==$E){var $Z=this._typeComponentsIndices[$E],$i=$Z.length;$M.length=$i;for(var $n=0;$n<$i;$n++)$M[$n]=this._components[$Z[$n]]}else $M.length=0},$I._getComponentByIndex=function($I){return this._components[$I]},$I._removeComponentByType=function($I,$M){void 0===$M&&($M=0);var $E=this._componentsMap.indexOf($I);-1!==$E&&this._removeComponent($E,$M)},$I._removeComponentsByType=function($I){var $M=this._componentsMap.indexOf($I);if(-1!==$M)for(var $E=this._typeComponentsIndices[$M],$Z=0,$i=$E.length;$Z<$i;$E.length<$i?$i--:$Z++)this._removeComponent($M,$Z)},$I._removeAllComponent=function(){for(var $I=0,$M=this._componentsMap.length;$I<$M;this._componentsMap.length<$M?$M--:$I++)this._removeComponentsByType(this._componentsMap[$I])},$I._updateComponents=function($I){for(var $M=0,$E=this._components.length;$M<$E;$M++){var $Z=this._components[$M];!$Z.started&&($Z._start($I),$Z.started=!0),$Z.enable&&$Z._update($I)}},$I._lateUpdateComponents=function($I){for(var $M=0;$M<this._components.length;$M++){var $E=this._components[$M];!$E.started&&($E._start($I),$E.started=!0),$E.enable&&$E._lateUpdate($I)}},$I._preRenderUpdateComponents=function($I){for(var $M=0;$M<this._components.length;$M++){var $E=this._components[$M];!$E.started&&($E._start($I),$E.started=!0),$E.enable&&$E._preRenderUpdate($I)}},$I._postRenderUpdateComponents=function($I){for(var $M=0;$M<this._components.length;$M++){var $E=this._components[$M];!$E.started&&($E._start($I),$E.started=!0),$E.enable&&$E._postRenderUpdate($I)}},$t(0,$I,"_loaded",null,function($I){this.__loaded=$I}),$t(0,$I,"fogColor",function(){return this._fogColor},function($I){this._fogColor=$I,this._shaderValues.setValue(0,$I.elements)}),$t(0,$I,"enableFog",function(){return this._enableFog},function($I){this._enableFog!==$I&&((this._enableFog=$I)?(this.addShaderDefine($mM.SHADERDEFINE_FOG),this.removeShaderDefine($mM.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine($mM.SHADERDEFINE_FOG))}),$t(0,$I,"url",function(){return this._url}),$t(0,$I,"loaded",function(){return this.__loaded}),$t(0,$I,"enableDepthFog",function(){return this._enableDepthFog},function($I){this._enableDepthFog!=$I&&((this._enableDepthFog=$I)?(this.addShaderDefine($mM.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine($mM.SHADERDEFINE_FOG)):this.removeShaderDefine($mM.SAHDERDEFINE_DEPTHFOG))}),$t(0,$I,"fogStart",function(){return this._fogStart},function($I){this._fogStart=$I,this._shaderValues.setValue(1,$I)}),$t(0,$I,"fogRange",function(){return this._fogRange},function($I){this._fogRange=$I,this._shaderValues.setValue(2,$I)}),$t(0,$I,"ambientColor",function(){return this._ambientColor},function($I){this._ambientColor=$I,this._shaderValues.setValue(21,$I.elements)}),$t(0,$I,"scene",function(){return this}),$t(0,$I,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),$Z._sortScenes=function($I,$M){if($I.parent!==$g.stage||$M.parent!==$g.stage)return $I.parent!==$g.stage&&$M.parent!==$g.stage?$Z._sortScenes($I.parent,$M.parent):$I.parent===$g.stage?-1:1;var $E=$g.stage._childs;return $E.indexOf($I)-$E.indexOf($M)},$Z.load=function($I){return $g.loader.create($I,null,null,$Z)},$Z.FOGCOLOR=0,$Z.FOGSTART=1,$Z.FOGRANGE=2,$Z.LIGHTDIRECTION=3,$Z.LIGHTDIRCOLOR=4,$Z.POINTLIGHTPOS=5,$Z.POINTLIGHTRANGE=6,$Z.POINTLIGHTATTENUATION=7,$Z.POINTLIGHTCOLOR=8,$Z.SPOTLIGHTPOS=9,$Z.SPOTLIGHTDIRECTION=10,$Z.SPOTLIGHTSPOT=11,$Z.SPOTLIGHTRANGE=12,$Z.SPOTLIGHTATTENUATION=13,$Z.SPOTLIGHTCOLOR=14,$Z.SHADOWDISTANCE=15,$Z.SHADOWLIGHTVIEWPROJECT=16,$Z.SHADOWMAPPCFOFFSET=17,$Z.SHADOWMAPTEXTURE1=18,$Z.SHADOWMAPTEXTURE2=19,$Z.SHADOWMAPTEXTURE3=20,$Z.AMBIENTCOLOR=21,$Z.TIME=22,$Z}($a),$SM=function($I){function $M($I){$M.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new $IM,this._shaderValues=new $QM,this._colliders=[],this._id=++$M._uniqueIDCounter,this._transform=new $OM(this),this.name=$I||"Sprite3D-"+$M._nameNumberCounter++,this.layer=$L.currentCreationLayer,this.active=!0}$p($M,"laya.d3.core.Sprite3D",$qM);var $E=$M.prototype;return $g.imps($E,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),$E._setUrl=function($I){this._url=$I},$E._getGroup=function(){return this._group},$E._setGroup=function($I){this._group=$I},$E._addChild3D=function($I){$I.transform.parent=this.transform,this._hierarchyAnimator&&(!$I._hierarchyAnimator&&$I._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($I,!0,[$I.name])),this._scene&&($I._setBelongScene(this._scene),this._activeInHierarchy&&$I._active&&$I._activeHierarchy())},$E._removeChild3D=function($I){$I.transform.parent=null,this._scene&&(this._activeInHierarchy&&$I._active&&$I._inActiveHierarchy(),$I._setUnBelongScene()),this._hierarchyAnimator&&($I._hierarchyAnimator==this._hierarchyAnimator&&$I._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D($I,!1,[$I.name]))},$E._parseBaseCustomProps=function($I){var $M=this.transform.localPosition;$I.translate?($M.fromArray($I.translate),$M.x*=100,$M.y*=100,$M.z*=100):$M.elements.fill(0),this.transform.localPosition=$M;var $E=this.transform.localRotation;$I.rotation?$E.fromArray($I.rotation):$E.fromArray([0,0,0,-1]),this.transform.localRotation=$E;var $Z=this.transform.localScale;$I.scale?$Z.fromArray($I.scale):$Z.elements.fill(1),this.transform.localScale=$Z;var $i=$I.layer;null!=$i&&(this.layer=$L.getLayerByNumber($i))},$E._parseCustomComponent=function($I,$M,$E){for(var $Z in $E){var $i=$E[$Z];switch($Z){case"Animator":var $n=this.addComponent(Animator);if($i.avatarPath)$n.avatar=$N.getRes($M[$i.avatarPath]);else{var $c=$i.avatar;if($c){$n.avatar=$N.getRes($M[$c.path]);var $f=$c.linkSprites;$f&&$I.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[$n,$f])}}for(var $d=$i.clipPaths,$H=$d.length,$B=0;$B<$H;$B++)$n.addClip($N.getRes($M[$d[$B]]));$n.clip=$N.getRes($M[$d[0]]);var $A=$i.playOnWake;void 0!==$A&&($n.playOnWake=$A);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var $Q=this.addComponent(SphereCollider);$Q.isTrigger=$i.isTrigger;var $p=$Q.center;$p.fromArray($i.center),$Q.center=$p,$Q.radius=$i.radius;break;case"BoxCollider":var $t=this.addComponent(BoxCollider);$t.isTrigger=$i.isTrigger,$t.center.fromArray($i.center);var $V=$t.size;$V.fromArray($i.size),$t.size=$V;break;case"MeshCollider":this.addComponent(MeshCollider)}}},$E._onRootNodeHierarchyLoaded=function($I,$M){for(var $E in $M){for(var $Z=this,$i=$M[$E],$n=0,$c=$i.length;$n<$c;$n++){var $f=$i[$n];if(""===$f)break;if(!($Z=$Z.getChildByName($f)))break}$Z&&$I.linkSprite3DToAvatarNode($E,$Z)}},$E._setHierarchyAnimator=function($I,$M){this._changeHierarchyAnimator($I);for(var $E=0,$Z=this._childs.length;$E<$Z;$E++){var $i=this._childs[$E];$i._hierarchyAnimator==$M&&$i._setHierarchyAnimator($I,$M)}},$E._clearHierarchyAnimator=function($I,$M){this._changeHierarchyAnimator($M);for(var $E=0,$Z=this._childs.length;$E<$Z;$E++){var $i=this._childs[$E];$i._hierarchyAnimator==$I&&$i._clearHierarchyAnimator($I,$M)}},$E._getAnimatorToLinkSprite3D=function($I,$M,$E){var $Z=this.getComponentByType(Animator);if($Z&&($Z.avatar?$Z.avatar._version||$I._setAnimatorToLinkAvatar($Z,$M):$I._setAnimatorToLinkSprite3DNoAvatar($Z,$M,$E)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){$E.unshift(this._parent.name);var $i=this._parent;$i._hierarchyAnimator&&$i._getAnimatorToLinkSprite3D($I,$M,$E)}},$E._setAnimatorToLinkSprite3DNoAvatar=function($I,$M,$E){var $Z=0,$i=0;for($Z=0,$i=$I.getClipCount();$Z<$i;$Z++)$I._handleSpriteOwnersBySprite($Z,$M,$E,this);for($Z=0,$i=this._childs.length;$Z<$i;$Z++){var $n=this._childs[$Z],$c=$E.length;$E.push($n.name),$n._setAnimatorToLinkSprite3DNoAvatar($I,$M,$E),$E.splice($c,1)}},$E._changeHierarchyAnimator=function($I){this._hierarchyAnimator=$I},$E._isLinkSpriteToAnimationNode=function($I,$M,$E){var $Z=$I._avatarNodes.indexOf($M),$i=$I._cacheSpriteToNodesMap;if($E)this._transform.dummy=$M.transform,$I._cacheNodesToSpriteMap[$Z]=$i.length,$i.push($Z);else{this._transform.dummy=null;var $n=$I._cacheNodesToSpriteMap[$Z];$I._cacheNodesToSpriteMap[$Z]=null,$i.splice($n,1)}},$E._setBelongScene=function($I){this._scene=$I;for(var $M=0,$E=this._childs.length;$M<$E;$M++)this._childs[$M]._setBelongScene($I)},$E._setUnBelongScene=function(){this._scene=null;for(var $I=0,$M=this._childs.length;$I<$M;$I++)this._childs[$I]._setUnBelongScene()},$E._activeHierarchy=function(){var $I=0,$M=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),$I=0,$M=this._colliders.length;$I<$M;$I++)this._layer._addCollider(this._colliders[$I]);for(this.event("activeinhierarchychanged",!0),$I=0,$M=this._childs.length;$I<$M;$I++){var $E=this._childs[$I];$E._active&&$E._activeHierarchy()}},$E._inActiveHierarchy=function(){var $I=0,$M=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),$I=0,$M=this._colliders.length;$I<$M;$I++){var $E=this._colliders[$I];$E._clearCollsionMap(),this._layer._removeCollider($E)}for(this.event("activeinhierarchychanged",!1),$I=0,$M=this._childs.length;$I<$M;$I++){var $Z=this._childs[$I];$Z._active&&$Z._inActiveHierarchy()}},$E.addComponent=function($I){var $M,$E=this._componentsMap.indexOf($I);if(-1===$E)$M=[],this._componentsMap.push($I),this._typeComponentsIndices.push($M);else if($M=this._typeComponentsIndices[$E],this._components[$M[0]].isSingleton)throw new Error("无法单实例创建"+$I+"组件，"+$I+"组件已存在！");var $Z=$i.getInstance($I);return $M.push(this._components.length),this._components.push($Z),$Z instanceof laya.d3.component.Script&&this._scripts.push($Z),$Z._initialize(this),$Z},$E._removeComponent=function($I,$M){var $E,$Z=0,$i=this._typeComponentsIndices[$I],$n=$i[$M],$c=this._components[$n];for($c instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf($c),1),$i.splice($M,1),0===$i.length&&(this._typeComponentsIndices.splice($I,1),this._componentsMap.splice($I,1)),$Z=0,$E=this._componentsMap.length;$Z<$E;$Z++)for(var $f=($i=this._typeComponentsIndices[$Z]).length-1;0<=$f;$f--){var $d=$i[$f];if(!($n<$d))break;$i[$f]=--$d}$c._destroy()},$E._clearSelfRenderObjects=function(){},$E._addSelfRenderObjects=function(){},$E._parseCustomProps=function($I,$M,$E,$Z){},$E._updateChilds=function($I){var $M=this._childs.length;if(0!==$M)for(var $E=0;$E<$M;++$E)this._childs[$E]._update($I)},$E._getSortID=function($I,$M){return 1e3*$M.id+$I._getVertexBuffer().vertexDeclaration.id},$E._update=function($I){($I.owner=this)._activeInHierarchy&&(this._updateComponents($I),this._lateUpdateComponents($I),$m.spriteCount++,this._childs.length&&this._updateChilds($I))},$E.getProjectionViewWorldMatrix=function($I){return $IM.multiply($I,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},$E.loadHierarchy=function($I){this.addChild(laya.d3.core.Sprite3D.load($I))},$E.addChildAt=function($I,$M){if(!($I instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$I||this.destroyed||$I===this)return $I;if($I.zOrder&&this._set$P("hasZorder",!0),0<=$M&&$M<=this._childs.length){if($I._parent===this){var $E=this.getChildIndex($I);this._childs.splice($E,1),this._childs.splice($M,0,$I),this.conchModel&&(this.conchModel.removeChild($I.conchModel),this.conchModel.addChildAt($I.conchModel,$M)),this._childChanged()}else $I.parent&&$I.parent.removeChild($I),this._childs===$H.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice($M,0,$I),this.conchModel&&this.conchModel.addChildAt($I.conchModel,$M),($I.parent=this)._addChild3D($I);return $I}throw new Error("appendChildAt:The index is out of bounds")},$E.addChild=function($I){if(!($I instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!$I||this.destroyed||$I===this)return $I;if($I.zOrder&&this._set$P("hasZorder",!0),$I._parent===this){var $M=this.getChildIndex($I);$M!==this._childs.length-1&&(this._childs.splice($M,1),this._childs.push($I),this.conchModel&&(this.conchModel.removeChild($I.conchModel),this.conchModel.addChildAt($I.conchModel,this._childs.length-1)),this._childChanged())}else $I.parent&&$I.parent.removeChild($I),this._childs===$H.ARRAY_EMPTY&&(this._childs=[]),this._childs.push($I),this.conchModel&&this.conchModel.addChildAt($I.conchModel,this._childs.length-1),($I.parent=this)._childChanged(),this._addChild3D($I);return $I},$E.removeChildAt=function($I){var $M=this.getChildAt($I);return $M&&(this._removeChild3D($M),this._childs.splice($I,1),this.conchModel&&this.conchModel.removeChild($M.conchModel),$M.parent=null),$M},$E.removeChildren=function($I,$M){if(void 0===$I&&($I=0),void 0===$M&&($M=2147483647),this._childs&&0<this._childs.length){var $E=this._childs;if(0===$I&&$n<=$M){var $Z=$E;this._childs=$H.ARRAY_EMPTY}else $Z=$E.splice($I,$M-$I);for(var $i=0,$n=$Z.length;$i<$n;$i++)this._removeChild3D($Z[$i]),$Z[$i].parent=null,this.conchModel&&this.conchModel.removeChild($Z[$i].conchModel)}return this},$E.onAsynLoaded=function($I,$M,$E){var $Z=$M[0];if("Sprite3D"!==$Z.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var $i=$M[1];$uM._createNodeByJson(this,$Z,this,$i),this.event("hierarchyloaded",[this]),this.__loaded=!0},$E.cloneTo=function($I){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var $M=$I;$M.name=this.name,$M._destroyed=this._destroyed,$M.timer=this.timer,$M._$P=this._$P,$M.active=this._active;var $E=$M.transform.localPosition;this.transform.localPosition.cloneTo($E),$M.transform.localPosition=$E;var $Z=$M.transform.localRotation;this.transform.localRotation.cloneTo($Z),$M.transform.localRotation=$Z;var $i=$M.transform.localScale;this.transform.localScale.cloneTo($i),$M.transform.localScale=$i,$M.isStatic=this.isStatic;var $n=0,$c=0;for($n=0,$c=this._componentsMap.length;$n<$c;$n++){var $f=$M.addComponent(this._componentsMap[$n]);this._components[$n]._cloneTo($f)}for($n=0,$c=this._childs.length;$n<$c;$n++)$M.addChild(this._childs[$n].clone());var $d=$M.getComponentByType(Animator);if($d){var $H=$d._linkSpritesData;if($H)for(var $B in $H){for(var $A=$H[$B],$Q=$M,$p=0,$t=$A.length;$p<$t&&($Q=$Q.getChildByName($A[$p]));$p++);if($Q){var $V=$d._avatarNodeMap[$B];$Q._isLinkSpriteToAnimationNode($d,$V,!0)}}}},$E.clone=function(){var $I=new this.constructor;return this.cloneTo($I),$I},$E.destroy=function($I){if(void 0===$I&&($I=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,$I);var $M,$E=0;for($E=0,$M=this._components.length;$E<$M;$E++)this._components[$E]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,$N.clearRes(this.url),this.loaded||$NM._cancelLoadByUrl(this.url)}},$E._handleSpriteToAvatar=function($I,$M){$I._avatarNodes;var $E=$I._avatarNodeMap[this.name];$E&&$E.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode($I,$E,$M)},$E._setAnimatorToLinkAvatar=function($I,$M){this._handleSpriteToAvatar($I,$M);for(var $E=0,$Z=this._childs.length;$E<$Z;$E++){this._childs[$E]._setAnimatorToLinkAvatar($I,$M)}},$t(0,$E,"activeInHierarchy",function(){return this._activeInHierarchy}),$t(0,$E,"_loaded",null,function($I){this.__loaded=$I}),$t(0,$E,"active",function(){return this._active},function($I){this._active!==$I&&(this._active=$I,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&($I?this._activeHierarchy():this._inActiveHierarchy()))}),$t(0,$E,"componentsCount",function(){return this._components.length}),$t(0,$E,"loaded",function(){return this.__loaded}),$t(0,$E,"id",function(){return this._id}),$t(0,$E,"url",function(){return this._url}),$t(0,$E,"layer",function(){return this._layer},function($I){if(this._layer!==$I){if(!$I)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var $M=0,$E=this._colliders.length;if(this._layer)for($M=0;$M<$E;$M++)this._layer._removeCollider(this._colliders[$M]);for($M=0;$M<$E;$M++)$I._addCollider(this._colliders[$M])}this._layer=$I,this.event("layerchanged",$I)}}),$t(0,$E,"scene",function(){return this._scene}),$t(0,$E,"transform",function(){return this._transform}),$M.instantiate=function($I,$M,$E,$Z,$i){void 0===$E&&($E=!0);var $n=$I.clone();$M&&$M.addChild($n);var $c=$n.transform;if($E){var $f=$c.worldMatrix;$I.transform.worldMatrix.cloneTo($f),$c.worldMatrix=$f}else $Z&&($c.position=$Z),$i&&($c.rotation=$i);return $n},$M.load=function($I){return $g.loader.create($I,null,null,$M)},$M.WORLDMATRIX=0,$M.MVPMATRIX=1,$M._uniqueIDCounter=0,$M._nameNumberCounter=0,$M}(),$XM=function($I){function $B($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],$B.__super.call(this),!$I||!$M)throw"Shader Error";this._id=++$B._count,this._vs=$I,this._ps=$M,this._attributeMap=$E,this._sceneUniformMap=$Z,this._cameraUniformMap=$i,this._spriteUniformMap=$n,this._materialUniformMap=$c,this._renderElementUniformMap=$f,this._precompile=$d,this._define=$H,this._precompile&&$B.extCompileObj&&$B.extCompileFunc?$B.extCompileFunc.call($B.extCompileObj,$I,$M,$H):this.recreateResource()}$p($B,"laya.d3.shader.Shader3D",$E);var $M=$B.prototype;return $M.recreateResource=function(){$z.now();this._compile(),this.completeCreate(),this.memorySize=0},$M.disposeResource=function(){$W.mainContext.deleteShader(this._vshader),$W.mainContext.deleteShader(this._pshader),$W.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},$M._compile=function(){if(!$W.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var $I=[this._vs,this._ps],$M=$W.mainContext;if(this._program=$M.createProgram(),this._vshader=$B._createShader($M,$I[0],35633),this._pshader=$B._createShader($M,$I[1],35632),$M.attachShader(this._program,this._vshader),$M.attachShader(this._program,this._pshader),$M.linkProgram(this._program),!$V.isConchApp&&$mM.debugMode&&!$M.getProgramParameter(this._program,35714))throw $M.getProgramInfoLog(this._program);var $E,$Z=0,$i=0,$n=0;for($n=$V.isConchApp?$M.getProgramParameterEx(this._vs,this._ps,"",35721):$M.getProgramParameter(this._program,35721),$Z=0;$Z<$n;$Z++){var $c=null;$E={vartype:"attribute",ivartype:0,attrib:$c=$V.isConchApp?$M.getActiveAttribEx(this._vs,this._ps,"",$Z):$M.getActiveAttrib(this._program,$Z),location:$M.getAttribLocation(this._program,$c.name),name:$c.name,type:$c.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push($E)}var $f=0;for($f=$V.isConchApp?$M.getProgramParameterEx(this._vs,this._ps,"",35718):$M.getProgramParameter(this._program,35718),$Z=0;$Z<$f;$Z++){var $d=null;$d=$V.isConchApp?$M.getActiveUniformEx(this._vs,this._ps,"",$Z):$M.getActiveUniform(this._program,$Z),0<($E={vartype:"uniform",ivartype:1,attrib:$c,location:$M.getUniformLocation(this._program,$d.name),name:$d.name,type:$d.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&($E.name=$E.name.substr(0,$E.name.length-3),$E.isArray=!0,$E.location=$M.getUniformLocation(this._program,$E.name)),this._uniformParams.push($E)}for($Z=0,$i=this._attributeParams.length;$Z<$i;$Z++)($E=this._attributeParams[$Z]).indexOfParams=$Z,$E.index=1,$E.value=[$E.location,null],$E.codename=$E.name,$E.name=null!=this._attributeMap[$E.codename]?this._attributeMap[$E.codename]:$E.codename,this._attributeParamsMap.push($E.name),this._attributeParamsMap.push($E),$E._this=this,$E.uploadedValue=[],$E.fun=this._attribute;for($Z=0,$i=this._uniformParams.length;$Z<$i;$Z++)switch(($E=this._uniformParams[$Z]).indexOfParams=$Z,$E.index=1,$E.value=[$E.location,null],$E.codename=$E.name,null!=this._sceneUniformMap[$E.codename]?($E.name=this._sceneUniformMap[$E.codename],this._sceneUniformParamsMap.push($E.name),this._sceneUniformParamsMap.push($E)):null!=this._cameraUniformMap[$E.codename]?($E.name=this._cameraUniformMap[$E.codename],this._cameraUniformParamsMap.push($E.name),this._cameraUniformParamsMap.push($E)):null!=this._spriteUniformMap[$E.codename]?($E.name=this._spriteUniformMap[$E.codename],this._spriteUniformParamsMap.push($E.name),this._spriteUniformParamsMap.push($E)):null!=this._materialUniformMap[$E.codename]?($E.name=this._materialUniformMap[$E.codename],this._materialUniformParamsMap.push($E.name),this._materialUniformParamsMap.push($E)):null!=this._renderElementUniformMap[$E.codename]?($E.name=this._renderElementUniformMap[$E.codename],this._renderElementUniformParamsMap.push($E.name),this._renderElementUniformParamsMap.push($E)):console.log("Shader:can't find uinform name:"+$E.codename+" in shader file."),$E._this=this,$E.uploadedValue=[],$E.type){case 5124:$E.fun=$E.isArray?this._uniform1iv:this._uniform1i;break;case 5126:$E.fun=$E.isArray?this._uniform1fv:this._uniform1f;break;case 35664:$E.fun=$E.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:$E.fun=$E.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:$E.fun=$E.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:$E.fun=this._uniform_sampler2D;break;case 35680:$E.fun=this._uniform_samplerCube;break;case 35676:$E.fun=this._uniformMatrix4fv;break;case 35670:$E.fun=this._uniform1i;break;case 35674:$E.fun=this._uinformMatrix2fv;break;case 35675:$E.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},$M._attribute=function($I,$M){var $E=$W.mainContext,$Z=$f._enableAtributes,$i=$I.location;return $Z[$i]||$E.enableVertexAttribArray($i),$E.vertexAttribPointer($i,$M[0],$M[1],$M[2],$M[3],$M[4]),$Z[$i]=$f._bindVertexBuffer,1},$M._uniform1f=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M?($W.mainContext.uniform1f($I.location,$E[0]=$M),1):0},$M._uniform1fv=function($I,$M){if($M.length<4){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]||$E[2]!==$M[2]||$E[3]!==$M[3]?($W.mainContext.uniform1fv($I.location,$M),$E[0]=$M[0],$E[1]=$M[1],$E[2]=$M[2],$E[3]=$M[3],1):0}return $W.mainContext.uniform1fv($I.location,$M),1},$M._uniform_vec2=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]?($W.mainContext.uniform2f($I.location,$E[0]=$M[0],$E[1]=$M[1]),1):0},$M._uniform_vec2v=function($I,$M){if($M.length<2){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]||$E[2]!==$M[2]||$E[3]!==$M[3]?($W.mainContext.uniform2fv($I.location,$M),$E[0]=$M[0],$E[1]=$M[1],$E[2]=$M[2],$E[3]=$M[3],1):0}return $W.mainContext.uniform2fv($I.location,$M),1},$M._uniform_vec3=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]||$E[2]!==$M[2]?($W.mainContext.uniform3f($I.location,$E[0]=$M[0],$E[1]=$M[1],$E[2]=$M[2]),1):0},$M._uniform_vec3v=function($I,$M){return $W.mainContext.uniform3fv($I.location,$M),1},$M._uniform_vec4=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]||$E[2]!==$M[2]||$E[3]!==$M[3]?($W.mainContext.uniform4f($I.location,$E[0]=$M[0],$E[1]=$M[1],$E[2]=$M[2],$E[3]=$M[3]),1):0},$M._uniform_vec4v=function($I,$M){return $W.mainContext.uniform4fv($I.location,$M),1},$M._uniformMatrix2fv=function($I,$M){return $W.mainContext.uniformMatrix2fv($I.location,!1,$M),1},$M._uniformMatrix3fv=function($I,$M){return $W.mainContext.uniformMatrix3fv($I.location,!1,$M),1},$M._uniformMatrix4fv=function($I,$M){return $W.mainContext.uniformMatrix4fv($I.location,!1,$M),1},$M._uinformMatrix2fv=function($I,$M){return $W.mainContext.uniformMatrix2fv($I.location,!1,$M),1},$M._uinformMatrix3fv=function($I,$M){return $W.mainContext.uniformMatrix3fv($I.location,!1,$M),1},$M._uniform1i=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M?($W.mainContext.uniform1i($I.location,$E[0]=$M),1):0},$M._uniform1iv=function($I,$M){return $W.mainContext.uniform1iv($I.location,$M),1},$M._uniform_ivec2=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]?($W.mainContext.uniform2i($I.location,$E[0]=$M[0],$E[1]=$M[1]),1):0},$M._uniform_ivec2v=function($I,$M){return $W.mainContext.uniform2iv($I.location,$M),1},$M._uniform_vec3i=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]||$E[2]!==$M[2]?($W.mainContext.uniform3i($I.location,$E[0]=$M[0],$E[1]=$M[1],$E[2]=$M[2]),1):0},$M._uniform_vec3vi=function($I,$M){return $W.mainContext.uniform3iv($I.location,$M),1},$M._uniform_vec4i=function($I,$M){var $E=$I.uploadedValue;return $E[0]!==$M[0]||$E[1]!==$M[1]||$E[2]!==$M[2]||$E[3]!==$M[3]?($W.mainContext.uniform4i($I.location,$E[0]=$M[0],$E[1]=$M[1],$E[2]=$M[2],$E[3]=$M[3]),1):0},$M._uniform_vec4vi=function($I,$M){return $W.mainContext.uniform4iv($I.location,$M),1},$M._uniform_sampler2D=function($I,$M){var $E=$M.source||$M.defaulteTexture.source,$Z=$W.mainContext,$i=$I.uploadedValue;if(null!=$i[0])return $Z.activeTexture($B._TEXTURES[$i[0]]),$E&&$R.bindTexture($Z,3553,$E),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $i[0]=this._curActTexIndex,$Z.uniform1i($I.location,this._curActTexIndex),$Z.activeTexture($B._TEXTURES[this._curActTexIndex]),$E&&$R.bindTexture($Z,3553,$E),this._curActTexIndex++,1},$M._uniform_samplerCube=function($I,$M){var $E=$M.source||$M.defaulteTexture.source,$Z=$W.mainContext,$i=$I.uploadedValue;if(null!=$i[0])return $Z.activeTexture($B._TEXTURES[$i[0]]),$E?$R.bindTexture($Z,34067,$E):$R.bindTexture($Z,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return $i[0]=this._curActTexIndex,$Z.uniform1i($I.location,this._curActTexIndex),$Z.activeTexture($B._TEXTURES[this._curActTexIndex]),$E?$R.bindTexture($Z,34067,$E):$R.bindTexture($Z,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},$M._noSetValue=function($I){console.log("no....:"+$I.name)},$M.bind=function(){return $E.activeShader=this,($E.bindShader=this).activeResource(),$R.UseProgram(this._program)},$M.uploadAttributes=function($I,$M){for(var $E,$Z,$i=0,$n=0,$c=this._attributeParamsMap.length;$n<$c;$n+=2)$Z=this._attributeParamsMap[$n+1],null!=($E=$I[this._attributeParamsMap[$n]])&&($M&&$M[$Z.name]&&$M[$Z.name].bind(),$i+=$Z.fun.call(this,$Z,$E));$m.shaderCall+=$i},$M.uploadAttributesX=function($I,$M){for(var $E,$Z,$i=0,$n=0,$c=this._attributeParamsMap.length;$n<$c;$n+=2)$Z=this._attributeParamsMap[$n+1],null!=($E=$I[this._attributeParamsMap[$n]])&&($M._bind(),$i+=$Z.fun.call(this,$Z,$E));$m.shaderCall+=$i},$M.uploadSceneUniforms=function($I){for(var $M,$E,$Z=0,$i=0,$n=this._sceneUniformParamsMap.length;$i<$n;$i+=2)$E=this._sceneUniformParamsMap[$i+1],null!=($M=$I[this._sceneUniformParamsMap[$i]])&&($Z+=$E.fun.call(this,$E,$M));$m.shaderCall+=$Z},$M.uploadCameraUniforms=function($I){for(var $M,$E,$Z=0,$i=0,$n=this._cameraUniformParamsMap.length;$i<$n;$i+=2)$E=this._cameraUniformParamsMap[$i+1],null!=($M=$I[this._cameraUniformParamsMap[$i]])&&($Z+=$E.fun.call(this,$E,$M));$m.shaderCall+=$Z},$M.uploadSpriteUniforms=function($I){for(var $M,$E,$Z=0,$i=0,$n=this._spriteUniformParamsMap.length;$i<$n;$i+=2)$E=this._spriteUniformParamsMap[$i+1],null!=($M=$I[this._spriteUniformParamsMap[$i]])&&($Z+=$E.fun.call(this,$E,$M));$m.shaderCall+=$Z},$M.uploadMaterialUniforms=function($I){for(var $M,$E,$Z=0,$i=0,$n=this._materialUniformParamsMap.length;$i<$n;$i+=2)$E=this._materialUniformParamsMap[$i+1],null!=($M=$I[this._materialUniformParamsMap[$i]])&&($Z+=$E.fun.call(this,$E,$M));$m.shaderCall+=$Z},$M.uploadRenderElementUniforms=function($I){for(var $M,$E,$Z=0,$i=0,$n=this._renderElementUniformParamsMap.length;$i<$n;$i+=2)$E=this._renderElementUniformParamsMap[$i+1],null!=($M=$I[this._renderElementUniformParamsMap[$i]])&&($Z+=$E.fun.call(this,$E,$M));$m.shaderCall+=$Z},$B.create=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){return new $B($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H)},$B.addInclude=function($I,$M){$$.addInclude($I,$M)},$B._createShader=function($I,$M,$E){var $Z=$I.createShader($E);if($I.shaderSource($Z,$M),$I.compileShader($Z),$mM.debugMode&&!$I.getShaderParameter($Z,35713))throw $I.getShaderInfoLog($Z);return $Z},$B.PERIOD_RENDERELEMENT=0,$B.PERIOD_MATERIAL=1,$B.PERIOD_SPRITE=2,$B.PERIOD_CAMERA=3,$B.PERIOD_SCENE=4,$B._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],$B._count=0,$B._preCompile=!1,$B.extCompileFunc=null,$B.extCompileObj=null,$A($B,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new $j}]),$B}(),$CM=function($f){function $d(){this._transformUV=null,$d.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new $cM(.6,.6,.6)),this._setColor(10,new $cM(1,1,1)),this._setColor(11,new $fM(1,1,1,8)),this._setColor(12,new $cM(1,1,1)),this._setColor(7,new $fM(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new $fM(1,1,0,0)),this.renderMode=1}$p($d,"laya.d3.core.material.StandardMaterial",$f);var $I=$d.prototype;return $I.disableLight=function(){this._addDisablePublicShaderDefine($mM.SHADERDEFINE_POINTLIGHT|$mM.SHADERDEFINE_SPOTLIGHT|$mM.SHADERDEFINE_DIRECTIONLIGHT)},$I.disableFog=function(){this._addDisablePublicShaderDefine($mM.SHADERDEFINE_FOG)},$I.onAsynLoaded=function($I,$M,$E){var $Z=$M[0];if($Z.version)$f.prototype.onAsynLoaded.call(this,$I,$M,$E);else{var $i=$M[1],$n=$Z.props;for(var $c in $n)this[$c]=$n[$c];$d._parseStandardMaterial($i,this,$Z),this._endLoaded()}},$I.cloneTo=function($I){$f.prototype.cloneTo.call(this,$I);var $M=$I;this._transformUV&&($M._transformUV=this._transformUV.clone())},$t(0,$I,"ambientColor",function(){return this._getColor(9)},function($I){this._setColor(9,$I)}),$t(0,$I,"ambientTexture",function(){return this._getTexture(5)},function($I){$I?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,$I)}),$t(0,$I,"renderMode",null,function($I){switch($I){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine($d.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode($I)}),$t(0,$I,"reflectColor",function(){return this._getColor(12)},function($I){this._setColor(12,$I)}),$t(0,$I,"tilingOffset",function(){return this._getColor(15)},function($I){if($I){var $M=$I.elements;1!=$M[0]||1!=$M[1]||0!=$M[2]||0!=$M[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,$I)}),$t(0,$I,"albedo",function(){return this._getColor(7)},function($I){this._setColor(7,$I)}),$t(0,$I,"diffuseColor",function(){return this._getColor(10)},function($I){this._setColor(10,$I)}),$t(0,$I,"albedoColor",function(){return this._getColor(7)},function($I){this._setColor(7,$I)}),$t(0,$I,"specularColor",function(){return this._getColor(11)},function($I){this._setColor(11,$I)}),$t(0,$I,"diffuseTexture",function(){return this._getTexture(1)},function($I){$I?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,$I)}),$t(0,$I,"normalTexture",function(){return this._getTexture(2)},function($I){$I?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,$I)}),$t(0,$I,"specularTexture",function(){return this._getTexture(3)},function($I){$I?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,$I)}),$t(0,$I,"emissiveTexture",function(){return this._getTexture(4)},function($I){$I?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,$I)}),$t(0,$I,"reflectTexture",function(){return this._getTexture(6)},function($I){$I?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,$I)}),$t(0,$I,"transformUV",function(){return this._transformUV},function($I){this._transformUV=$I,this._setMatrix4x4(13,$I.matrix),$I?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,$I.matrix.elements,0)}),$d.__init__=function(){$d.SHADERDEFINE_DIFFUSEMAP=$d.shaderDefines.registerDefine("DIFFUSEMAP"),$d.SHADERDEFINE_NORMALMAP=$d.shaderDefines.registerDefine("NORMALMAP"),$d.SHADERDEFINE_SPECULARMAP=$d.shaderDefines.registerDefine("SPECULARMAP"),$d.SHADERDEFINE_EMISSIVEMAP=$d.shaderDefines.registerDefine("EMISSIVEMAP"),$d.SHADERDEFINE_AMBIENTMAP=$d.shaderDefines.registerDefine("AMBIENTMAP"),$d.SHADERDEFINE_REFLECTMAP=$d.shaderDefines.registerDefine("REFLECTMAP"),$d.SHADERDEFINE_UVTRANSFORM=$d.shaderDefines.registerDefine("UVTRANSFORM"),$d.SHADERDEFINE_TILINGOFFSET=$d.shaderDefines.registerDefine("TILINGOFFSET"),$d.SHADERDEFINE_ADDTIVEFOG=$d.shaderDefines.registerDefine("ADDTIVEFOG")},$d.load=function($I){return $g.loader.create($I,null,null,$d)},$d._parseStandardMaterial=function($I,$M,$E){var $Z=$E.customProps,$i=$Z.ambientColor;$M.ambientColor=new $cM($i[0],$i[1],$i[2]);var $n=$Z.diffuseColor;$M.diffuseColor=new $cM($n[0],$n[1],$n[2]);var $c=$Z.specularColor;$M.specularColor=new $fM($c[0],$c[1],$c[2],$c[3]);var $f=$Z.reflectColor;$M.reflectColor=new $cM($f[0],$f[1],$f[2]);var $d=$Z.albedoColor;$d&&($M.albedo=new $fM($d[0],$d[1],$d[2],$d[3]));var $H=$Z.diffuseTexture.texture2D;$H&&($M.diffuseTexture=$N.getRes($I[$H]));var $B=$Z.normalTexture.texture2D;$B&&($M.normalTexture=$N.getRes($I[$B]));var $A=$Z.specularTexture.texture2D;$A&&($M.specularTexture=$N.getRes($I[$A]));var $Q=$Z.emissiveTexture.texture2D;$Q&&($M.emissiveTexture=$N.getRes($I[$Q]));var $p=$Z.ambientTexture.texture2D;$p&&($M.ambientTexture=$N.getRes($I[$p]));var $t=$Z.reflectTexture.texture2D;$t&&($M.reflectTexture=$N.getRes($I[$t]))},$d.RENDERMODE_OPAQUE=1,$d.RENDERMODE_OPAQUEDOUBLEFACE=2,$d.RENDERMODE_CUTOUT=3,$d.RENDERMODE_CUTOUTDOUBLEFACE=4,$d.RENDERMODE_TRANSPARENT=13,$d.RENDERMODE_TRANSPARENTDOUBLEFACE=14,$d.RENDERMODE_ADDTIVE=15,$d.RENDERMODE_ADDTIVEDOUBLEFACE=16,$d.RENDERMODE_DEPTHREAD_TRANSPARENT=5,$d.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,$d.RENDERMODE_DEPTHREAD_ADDTIVE=7,$d.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,$d.RENDERMODE_NONDEPTH_TRANSPARENT=9,$d.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,$d.RENDERMODE_NONDEPTH_ADDTIVE=11,$d.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,$d.SHADERDEFINE_DIFFUSEMAP=0,$d.SHADERDEFINE_NORMALMAP=0,$d.SHADERDEFINE_SPECULARMAP=0,$d.SHADERDEFINE_EMISSIVEMAP=0,$d.SHADERDEFINE_AMBIENTMAP=0,$d.SHADERDEFINE_REFLECTMAP=0,$d.SHADERDEFINE_UVTRANSFORM=0,$d.SHADERDEFINE_TILINGOFFSET=0,$d.SHADERDEFINE_ADDTIVEFOG=0,$d.DIFFUSETEXTURE=1,$d.NORMALTEXTURE=2,$d.SPECULARTEXTURE=3,$d.EMISSIVETEXTURE=4,$d.AMBIENTTEXTURE=5,$d.REFLECTTEXTURE=6,$d.ALBEDO=7,$d.UVANIAGE=8,$d.MATERIALAMBIENT=9,$d.MATERIALDIFFUSE=10,$d.MATERIALSPECULAR=11,$d.MATERIALREFLECT=12,$d.UVMATRIX=13,$d.UVAGE=14,$d.TILINGOFFSET=15,$A($d,["defaultMaterial",function(){var $I=new $d;return $I.lock=!0,this.defaultMaterial=$I},"shaderDefines",function(){return this.shaderDefines=new $BM($vM.shaderDefines)}]),$d}($vM),$JM=function($I){function $c($I,$M,$E,$Z,$i){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===$E&&($E=35044),void 0===$Z&&($Z=!1),$c.__super.call(this),this._indexType=$I,this._indexCount=$M,this._bufferUsage=$E,this._bufferType=34963,this._canRead=$Z;var $n;if("ushort"==$I)this._indexTypeByteCount=2;else{if("ubyte"!=$I)throw new Error("unidentification index type.");this._indexTypeByteCount=1}$n=this._indexTypeByteCount*$M,this._byteLength=$n,this._bind(),$f._gl.bufferData(this._bufferType,$n,this._bufferUsage),this.uri=$i,$Z?("ushort"==$I?this._buffer=new Uint16Array($M):"ubyte"==$I&&(this._buffer=new Uint8Array($M)),this.memorySize=2*$n):this.memorySize=$n}$p($c,"laya.d3.graphics.IndexBuffer3D",$I);var $M=$c.prototype;return $M.setData=function($I,$M,$E,$Z){void 0===$M&&($M=0),void 0===$E&&($E=0),void 0===$Z&&($Z=4294967295);var $i=0;if("ushort"==this._indexType?($i=2,0===$E&&4294967295===$Z||($I=new Uint16Array($I.buffer,$E*$i,$Z))):"ubyte"==this._indexType&&($i=1,0===$E&&4294967295===$Z||($I=new Uint8Array($I.buffer,$E*$i,$Z))),this._bind(),$f._gl.bufferSubData(this._bufferType,$M*$i,$I),this._canRead)if(0!==$M||0!==$E||4294967295!==$Z){var $n=this._buffer.length-$M;$n<$Z&&($Z=$n);for(var $c=0;$c<$Z;$c++)this._buffer[$M+$c]=$I[$c]}else this._buffer=$I},$M.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$M.disposeResource=function(){$I.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},$t(0,$M,"indexType",function(){return this._indexType}),$t(0,$M,"indexTypeByteCount",function(){return this._indexTypeByteCount}),$t(0,$M,"indexCount",function(){return this._indexCount}),$t(0,$M,"canRead",function(){return this._canRead}),$c.INDEXTYPE_UBYTE="ubyte",$c.INDEXTYPE_USHORT="ushort",$c.create=function($I,$M,$E,$Z,$i){return void 0===$E&&($E=35044),void 0===$Z&&($Z=!1),new $c($I,$M,$E,$Z,$i)},$c}($f),$xM=function($n){function $c($I,$M,$E,$Z,$i){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===$Z&&($Z=!1),$c.__super.call(this),this._vertexDeclaration=$I,this._vertexCount=$M,this._bufferUsage=$E,this._bufferType=34962,this._canRead=$Z,this.uri=$i,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*$M,this._bind(),$f._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),$Z&&(this._buffer=new Float32Array(this._byteLength/4))}$p($c,"laya.d3.graphics.VertexBuffer3D",$n);var $I=$c.prototype;return $I.bindWithIndexBuffer=function($I){$I&&$I._bind(),this._bind()},$I.setData=function($I,$M,$E,$Z){if(void 0===$M&&($M=0),void 0===$E&&($E=0),void 0===$Z&&($Z=4294967295),0===$E&&4294967295===$Z||($I=new Float32Array($I.buffer,4*$E,$Z)),this._bind(),$f._gl.bufferSubData(this._bufferType,4*$M,$I),this._canRead)if(0!==$M||0!==$E||4294967295!==$Z){var $i=this._buffer.length-$M;$i<$Z&&($Z=$i);for(var $n=0;$n<$Z;$n++)this._buffer[$M+$n]=$I[$n]}else this._buffer=$I},$I.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},$I.disposeResource=function(){for(var $I=$W.mainContext,$M=this._vertexDeclaration.getVertexElements(),$E=$f._enableAtributes,$Z=0,$i=$M.length;$Z<$i;$Z++)$E[$Z]===this._glBuffer&&($I.disableVertexAttribArray($Z),$E[$Z]=null);$n.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},$t(0,$I,"vertexDeclaration",function(){return this._vertexDeclaration}),$t(0,$I,"vertexCount",function(){return this._vertexCount}),$t(0,$I,"canRead",function(){return this._canRead}),$c.create=function($I,$M,$E,$Z,$i){return void 0===$E&&($E=35044),void 0===$Z&&($Z=!1),new $c($I,$M,$E,$Z,$i)},$c}($f),$kM=function($I){function $$(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,$$.__super.call(this),this._type=3553}$p($$,"laya.d3.resource.DataTexture2D",$WM);var $M=$$.prototype;return $M.genDebugMipmaps=function(){var $I=[];return $I.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),$I.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),$I.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),$I.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),$I.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),$I.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),$I.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),$I.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),$I.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),$I.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),$I},$M._onTextureLoaded=function($I){},$M._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var $I=$W.mainContext,$M=this._source=$I.createTexture(),$E=this._width,$Z=this._height,$i=$R.curBindTexTarget,$n=$R.curBindTexValue,$c=!1;if($R.bindTexture($I,this._type,$M),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var $f=0;$I.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var $d=0;$d<this._mipmaps.length;$d++){if(this._mipmaps[$d].byteLength!=$H*$B*4)throw"mipmap size error  level:"+$d;$I.texSubImage2D(this._type,0,$$.simLodRect[$f++],$$.simLodRect[$f++],$$.simLodRect[$f++],$$.simLodRect[$f++],6408,5121,new Uint8Array(this._mipmaps[$d]))}this.minFifter=9729,this.magFifter=9729}else{var $H=this._width,$B=this._height;for($f=0,$I.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),$d=0;$d<this._mipmaps.length;$d++){if(this._mipmaps[$d].byteLength!=$H*$B*4)throw"mipmap size error  level:"+$d;$I.texImage2D(this._type,$d,6408,$H,$B,0,6408,5121,new Uint8Array(this._mipmaps[$d])),($H/=2)<1&&($H=1),($B/=2)<1&&($B=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&$I.pixelStorei($I.UNPACK_ALIGNMENT,1),$I.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var $A=0,$Q=!1,$p=!1;this._buffer.byteLength==4*$E*$Z?($A=6408,$Q=!0):this._buffer.byteLength==3*$E*$Z?($A=6407,$p=!0):$A=this._format,$Q||$p?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),$p&&$I.pixelStorei($I.UNPACK_ALIGNMENT,1),$I.texImage2D(this._type,0,$A,$E,$Z,0,$A,5121,this._buffer)):$I&&$A==$I.ALPHA?($I.texImage2D(3553,0,$A,$E,$Z,0,$A,$I.UNSIGNED_BYTE,this._buffer),$c=!0):0!=$A&&($I.compressedTexImage2D(3553,0,$A,$E,$Z,0,this._buffer),$c=!0)}var $t=this._minFifter,$V=this._magFifter,$u=0==this._wrapModeU?10497:33071,$N=0==this._wrapModeV?10497:33071,$y=$w.isPOT($E,$Z);$y?(this._mipmap||this._mipmaps?-1!==$t||($t=9987):-1!==$t||($t=9729),-1!==$V||($V=9729),$I.texParameteri(this._type,10241,$t),$I.texParameteri(this._type,10240,$V),$I.texParameteri(this._type,10242,$u),$I.texParameteri(this._type,10243,$N),this._mipmap&&$I.generateMipmap(this._type)):(-1!==$t||($t=9729),-1!==$V||($V=9729),$I.texParameteri(this._type,10241,$t),$I.texParameteri(this._type,10240,$V),$I.texParameteri(this._type,10242,33071),$I.texParameteri(this._type,10243,33071)),$i&&$n&&$R.bindTexture($I,$i,$n),this.memorySize=$c?this._buffer.length:$y?$E*$Z*4*(1+1/3):$E*$Z*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},$M.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},$M.onAsynLoaded=function($I,$M,$E){var $Z;$E&&($Z=$E[0].call(this,$M)),$Z&&(this._width=$Z.width,this._height=$Z.height,this._buffer=$Z.data),this._src=$I,this._size=new $VM(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},$M.getPixels=function(){return new Uint8Array(this._buffer)},$M.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&($W.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},$t(0,$M,"src",function(){return this._src}),$$.create=function($I,$M,$E,$Z,$i,$n,$c){if(void 0===$Z&&($Z=9729),void 0===$i&&($i=9729),void 0===$n&&($n=!0),!$I||$I.byteLength<$M*$E*4)throw"DataTexture2D create error";var $f=new $$;return $f.uri=$c,$f._buffer=$I,$f._width=$M,$f._height=$E,$f._mipmap=$n,$f._magFifter=$Z,$f._minFifter=$i,$f._size=new $VM($f._width,$f._height),$f._conchTexture?alert("怎么给runtime传递datatexture数据"):$f.activeResource(),$f},$$.load=function($I,$M,$E,$Z,$i){if(void 0===$M&&($M=0),void 0===$E&&($E=0),void 0===$Z&&($Z=9729),void 0===$i&&($i=9729),"mipmaps"===$T.getFileExtension($I)){var $n=$g.loader.create($I,null,null,$$,[function($I){this._mipmaps=[];var $M=new Uint32Array($I);this._width=$M[0];var $E=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,$E=1024),this._width!=$E)throw"现在只支持512x256的环境贴图。当前的是"+$M[0];this._height=$M[1];for(var $Z=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,$i=this._height,$n=8;;){var $c=$Z*$i*4;if($n+$c>$I.byteLength)throw"load mipmaps data size error ";var $f=new Uint8Array($I,$n,$c);if(this._mipmaps.push($f),$n+=$c,1==$Z&&1==$i)break;($Z/=2)<1&&($Z=1),($i/=2)<1&&($i=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){$n.simLodInfo=new Float32Array(40);for(var $c=0;$c<$n.simLodInfo.length;)$n.simLodInfo[$c]=($$.simLodRect[$c]+.5)/1024,$c++,$n.simLodInfo[$c]=($$.simLodRect[$c]+.5)/256,$c++,$n.simLodInfo[$c]=Math.max($$.simLodRect[$c]-1,.1)/1024,$c++,$n.simLodInfo[$c]=Math.max($$.simLodRect[$c]-1.5,.1)/256,$c++}return $n}if("number"==typeof $M)return $g.loader.create($I,null,null,$$,[function($I){return this._width=$M,this._height=$E,this._buffer=$I,null}]);if("function"==typeof $M)return $g.loader.create($I,null,null,$$,[$M]);throw new Error("unknown params.")},$$.lodasatlas=!1,$A($$,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),$$}(),$rM=function($I){function $M(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,$M.__super.call(this)}$p($M,"laya.d3.resource.models.PrimitiveMesh",$RM);var $E=$M.prototype;return $g.imps($E,{"laya.d3.core.render.IRenderable":!0}),$E._getVertexBuffer=function($I){return void 0===$I&&($I=0),0===$I?this._vertexBuffer:null},$E._getVertexBuffers=function(){return null},$E._getIndexBuffer=function(){return this._indexBuffer},$E._getPositions=function(){var $I,$M=[],$E=this._vertexBuffer.vertexDeclaration.getVertexElements(),$Z=0;for($Z=0;$Z<$E.length;$Z++){var $i=$E[$Z];if("vector3"===$i.elementFormat&&0===$i.elementUsage){$I=$i;break}}var $n=this._vertexBuffer.getData();for($Z=0;$Z<$n.length;$Z+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var $c=$Z+$I.offset/4,$f=new $cM($n[$c+0],$n[$c+1],$n[$c+2]);$M.push($f)}return $M},$E.getRenderElement=function($I){return this},$E.getRenderElementsCount=function(){return 1},$E.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},$E._beforeRender=function($I){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},$E._render=function($I){$W.mainContext.drawElements(4,this._numberIndices,5123,0),$m.drawCall++,$m.trianglesFaces+=this._numberIndices/3},$t(0,$E,"_vertexBufferCount",function(){return 1}),$t(0,$E,"triangleCount",function(){return this._indexBuffer.indexCount/3}),$M}(),$lM=function($I){function $M(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,$M.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}$p($M,"laya.d3.resource.models.Mesh",$RM);var $E=$M.prototype;return $E._getPositions=function(){var $I,$M,$E,$Z,$i,$n=[],$c=0,$f=0,$d=0;if(0!==this._vertexBuffers.length){var $H=this._vertexBuffers.length;for($c=0;$c<$H;$c++){for($E=($I=this._vertexBuffers[$c]).vertexDeclaration.getVertexElements(),$f=0;$f<$E.length;$f++)if("vector3"===($Z=$E[$f]).elementFormat&&0===$Z.elementUsage){$M=$Z;break}for($i=$I.getData(),$f=0;$f<$i.length;$f+=$I.vertexDeclaration.vertexStride/4)$d=$f+$M.offset/4,$n.push(new $cM($i[$d+0],$i[$d+1],$i[$d+2]))}}else{var $B=this._subMeshes.length;for($c=0;$c<$B;$c++){for($E=($I=this._subMeshes[$c]._getVertexBuffer()).vertexDeclaration.getVertexElements(),$f=0;$f<$E.length;$f++)if("vector3"===($Z=$E[$f]).elementFormat&&0===$Z.elementUsage){$M=$Z;break}for($i=$I.getData(),$f=0;$f<$i.length;$f+=$I.vertexDeclaration.vertexStride/4)$d=$f+$M.offset/4,$n.push(new $cM($i[$d+0],$i[$d+1],$i[$d+2]))}}return $n},$E._setSubMeshes=function($I){this._subMeshes=$I,this._subMeshCount=$I.length;for(var $M=0;$M<this._subMeshCount;$M++)$I[$M]._indexInMesh=$M;this._positions=this._getPositions(),this._generateBoundingObject()},$E.onAsynLoaded=function($I,$M,$E){var $Z=$M[0],$i=$M[1];$GI.read($Z,this,this._materials,this._subMeshes,$i),this.completeCreate(),this._endLoaded()},$E.getSubMesh=function($I){return this._subMeshes[$I]},$E.getSubMeshCount=function(){return this._subMeshes.length},$E.getRenderElementsCount=function(){return this._subMeshes.length},$E.getRenderElement=function($I){return this._subMeshes[$I]},$E.disposeResource=function(){for(var $I=0;$I<this._subMeshes.length;$I++)this._subMeshes[$I].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},$t(0,$E,"materials",function(){return this._materials.slice()}),$t(0,$E,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),$M.load=function($I){return $g.loader.create($I,null,null,$M)},$M}(),$FM=(function($I){function $H($I,$M,$E,$Z,$i,$n,$c,$f,$d){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===$E&&($E=6408),void 0===$Z&&($Z=5121),void 0===$i&&($i=33189),void 0===$n&&($n=!1),void 0===$c&&($c=!1),void 0===$f&&($f=-1),void 0===$d&&($d=-1),$H.__super.call(this),this._type=3553,this._width=$I,this._height=$M,this._size=new $VM($I,$M),this._surfaceFormat=$E,this._surfaceType=$Z,this._depthStencilFormat=$i,$V.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=$n,this._repeat=$c,this._minFifter=$f,this._magFifter=$d,this.activeResource(),this._alreadyResolved=!0}$p($H,"laya.d3.resource.RenderTexture",$WM);var $M=$H.prototype;$M.recreateResource=function(){var $I=$W.mainContext;this._frameBuffer=$I.createFramebuffer(),this._source=$I.createTexture();var $M=$R.curBindTexTarget,$E=$R.curBindTexValue;$R.bindTexture($I,this._type,this._source),$I.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var $Z=this._minFifter,$i=this._magFifter,$n=this._repeat?10497:33071;if($w.isPOT(this._width,this._height)?(this._mipmap?-1!==$Z||($Z=9987):-1!==$Z||($Z=9729),-1!==$i||($i=9729),$I.texParameteri(this._type,10241,$Z),$I.texParameteri(this._type,10240,$i),$I.texParameteri(this._type,10242,$n),$I.texParameteri(this._type,10243,$n),this._mipmap&&$I.generateMipmap(this._type)):(-1!==$Z||($Z=9729),-1!==$i||($i=9729),$I.texParameteri(this._type,10241,$Z),$I.texParameteri(this._type,10240,$i),$I.texParameteri(this._type,10242,33071),$I.texParameteri(this._type,10243,33071)),$M&&$E&&$R.bindTexture($I,$M,$E),$I.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=$I.createRenderbuffer(),$I.bindRenderbuffer(36161,this._depthStencilBuffer),$I.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),$I.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:$I.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:$I.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:$I.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}$I.framebufferTexture2D(36160,36064,3553,this._source,0),$I.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},$M.start=function(){$W.mainContext.bindFramebuffer(36160,this.frameBuffer),($H._currentRenderTarget=this)._alreadyResolved=!1},$M.end=function(){$W.mainContext.bindFramebuffer(36160,null),$H._currentRenderTarget=null,this._alreadyResolved=!0},$M.getData=function($I,$M,$E,$Z){var $i=$W.mainContext;if($i.bindFramebuffer(36160,this._frameBuffer),!(36053===$i.checkFramebufferStatus(36160)))return $i.bindFramebuffer(36160,null),null;var $n=new Uint8Array(this._width*this._height*4);return $i.readPixels($I,$M,$E,$Z,this._surfaceFormat,this._surfaceType,$n),$i.bindFramebuffer(36160,null),$n},$M.disposeResource=function(){if(this._frameBuffer){var $I=$W.mainContext;$I.deleteTexture(this._source),$I.deleteFramebuffer(this._frameBuffer),$I.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},$t(0,$M,"surfaceFormat",function(){return this._surfaceFormat}),$t(0,$M,"surfaceType",function(){return this._surfaceType}),$t(0,$M,"depthStencilFormat",function(){return this._depthStencilFormat}),$t(0,$M,"source",function(){return this._alreadyResolved?$g.superGet($WM,this,"source"):null}),$t(0,$M,"depthStencilBuffer",function(){return this._depthStencilBuffer}),$t(0,$M,"frameBuffer",function(){return this._frameBuffer}),$H._currentRenderTarget=null}(),function($I){function $M($I){this._color=null,this._pixels=null,$M.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new $VM(this.width,this.height),this._color=$I,this._pixels=new Uint8Array([255*$I.x,255*$I.y,255*$I.z,255*$I.w]),this.uri="SolidColorTexture2D_"+this.id}$p($M,"laya.d3.resource.SolidColorTexture2D",$WM);var $E=$M.prototype;return $E._createWebGlTexture=function(){var $I=$W.mainContext,$M=this._source=$I.createTexture(),$E=this._width,$Z=this._height,$i=$R.curBindTexTarget,$n=$R.curBindTexValue;$R.bindTexture($I,this._type,$M),$I.texImage2D(this._type,0,6408,$E,$Z,0,6408,5121,this._pixels);var $c=this._minFifter,$f=this._magFifter,$d=this._repeat?10497:33071,$H=$w.isPOT($E,$Z);$H?(this._mipmap?-1!==$c||($c=9987):-1!==$c||($c=9729),-1!==$f||($f=9729),$I.texParameteri(this._type,10241,$c),$I.texParameteri(this._type,10240,$f),$I.texParameteri(this._type,10242,$d),$I.texParameteri(this._type,10243,$d),this._mipmap&&$I.generateMipmap(this._type)):(-1!==$c||($c=9729),-1!==$f||($f=9729),$I.texParameteri(this._type,10241,$c),$I.texParameteri(this._type,10240,$f),$I.texParameteri(this._type,10242,33071),$I.texParameteri(this._type,10243,33071)),$i&&$n&&$R.bindTexture($I,$i,$n),this.memorySize=$H?$E*$Z*4*(1+1/3):$E*$Z*4},$E.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$E.disposeResource=function(){this._source&&($W.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},$A($M,["magentaTexture",function(){var $I=new $M(new $fM(1,0,1,1));return $I.lock=!0,this.magentaTexture=$I},"grayTexture",function(){var $I=new $M(new $fM(.5,.5,.5,1));return $I.lock=!0,this.grayTexture=$I}]),$M}()),$eM=function($I){function $i($I,$M,$E,$Z){this._canRead=!1,this._image=null,this._pixels=null,void 0===$I&&($I=!1),void 0===$M&&($M=!0),void 0===$E&&($E=6408),void 0===$Z&&($Z=!0),$i.__super.call(this),this._type=3553,this._repeat=$M,this._canRead=$I,this._format=$E,this._mipmap=$Z}$p($i,"laya.d3.resource.Texture2D",$WM);var $M=$i.prototype;return $M._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var $I=$W.mainContext,$M=this._source=$I.createTexture(),$E=this._width,$Z=this._height,$i=$R.curBindTexTarget,$n=$R.curBindTexValue;switch($R.bindTexture($I,this._type,$M),this._format){case 6407:case 6408:this._canRead?$I.texImage2D(this._type,0,this._format,$E,$Z,0,this._format,5121,this._pixels):this._image&&this._image instanceof laya.webgl.resource.WebGLImage?$I.texImage2D(this._type,0,this._image._format,$E,$Z,0,this._image._format,5121,this._image.atlasSource):$I.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case $W.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:$I.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var $c=this._minFifter,$f=this._magFifter,$d=this._repeat?10497:33071,$H=0==this._wrapModeU?10497:33071,$B=0==this._wrapModeV?10497:33071,$A=$w.isPOT($E,$Z);$A?(this._mipmap?-1!==$c||($c=9987):-1!==$c||($c=9729),-1!==$f||($f=9729),$I.texParameteri(this._type,10241,$c),$I.texParameteri(this._type,10240,$f),$I.texParameteri(this._type,10242,$d),$I.texParameteri(this._type,10243,$d),$I.texParameteri(this._type,10242,$H),$I.texParameteri(this._type,10243,$B),this._mipmap&&$I.generateMipmap(this._type)):(-1!==$c||($c=9729),-1!==$f||($f=9729),$I.texParameteri(this._type,10241,$c),$I.texParameteri(this._type,10240,$f),$I.texParameteri(this._type,10242,33071),$I.texParameteri(this._type,10243,33071)),$i&&$n&&$R.bindTexture($I,$i,$n),this._image.onload=null,this._image=null,this.memorySize=$A?$E*$Z*4*(1+1/3):$E*$Z*4},$M.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},$M.onAsynLoaded=function($I,$M,$E){if($E){var $Z=$E[0];void 0!==$Z&&(this._canRead=$Z);var $i=$E[1];void 0!==$i&&(this._repeat=$i);var $n=$E[2];void 0!==$n&&(this._format=$n);var $c=$E[3];void 0!==$c&&(this._mipmap=$c);var $f=$E.wrapModeU;void 0!==$f&&(this._wrapModeU=$f);var $d=$E.wrapModeV;void 0!==$d&&(this._wrapModeV=$d)}switch(this._format){case 6407:case 6408:var $H=(this._image=$M).width,$B=$M.height;this._width=$H,this._height=$B,this._size=new $VM($H,$B),this._canRead&&($V.isConchApp?$M instanceof $Q.HTMLElement&&(this._pixels=new Uint8Array($M.getImageData(0,0,$H,$B))):($z.canvas.size($H,$B),$z.canvas.clear(),$z.context.drawImage($M,0,0,$H,$B),this._pixels=new Uint8Array($z.context.getImageData(0,0,$H,$B).data.buffer)));break;case $W.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var $A=new $O($M);$A.readUTFBytes(4),$A.readUTFBytes(2),$A.getInt16();$A.endian="bigEndian",this._width=$A.getInt16(),this._height=$A.getInt16(),this._size=new $VM(this._width,this._height);$A.getInt16(),$A.getInt16();this._image=new Uint8Array($M,$A.pos)}this.recreateResource(),this._endLoaded()},$M.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},$M.disposeResource=function(){this._source&&($W.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},$t(0,$M,"_src",function(){return this.url}),$t(0,$M,"src",function(){return this.url}),$i.load=function($I){return $g.loader.create($I,null,null,$i)},$i}(),$_M=function($M){function $E($I,$M){$E.__super.call(this),void 0===$I&&($I=.3),void 0===$M&&($M=1e3),this._tempVector3=new $cM,this._position=new $cM,this._up=new $cM,this._forward=new $cM,this._right=new $cM,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=$VM.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=$I,this._farPlane=$M,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),$g.stage.on("resize",this,this._onScreenSizeChanged)}$p($E,"laya.d3.core.BaseCamera",$M);var $I=$E.prototype;return $I._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var $I=this.scene._cameraPool,$M=$I.length-1,$E=0;$E<$M;$E++)if($I[$E].renderingOrder>$I[$M].renderingOrder){var $Z=$I[$E];$I[$E]=$I[$M],$I[$M]=$Z}},$I._calculateProjectionMatrix=function(){},$I._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},$I._prepareCameraToRender=function(){$L._currentCameraCullingMask=this.cullingMask;var $I=this._shaderValues;$I.setValue(0,this.transform.position.elements),$I.setValue(5,this.forward.elements),$I.setValue(6,this.up.elements)},$I._prepareCameraViewProject=function($I,$M){var $E=this._shaderValues;$E.setValue(1,$I.elements),$E.setValue(2,$M.elements)},$I._renderCamera=function($I,$M,$E){},$I.addLayer=function($I){29!==$I.number&&30!=$I.number&&(this.cullingMask=this.cullingMask|$I.mask)},$I.removeLayer=function($I){29!==$I.number&&30!=$I.number&&(this.cullingMask=this.cullingMask&~$I.mask)},$I.addAllLayers=function(){this.cullingMask=2147483647},$I.removeAllLayers=function(){this.cullingMask=0|$L.getLayerByNumber(29).mask|$L.getLayerByNumber(30).mask},$I.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},$I.moveForward=function($I){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=$I,this.transform.translate(this._tempVector3)},$I.moveRight=function($I){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=$I,this.transform.translate(this._tempVector3)},$I.moveVertical=function($I){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=$I,this.transform.translate(this._tempVector3,!1)},$I._addSelfRenderObjects=function(){var $I=this.scene._cameraPool,$M=$I.length;if(0<$M){for(var $E=$M-1;0<=$E;$E--)if(this.renderingOrder<=$I[$E].renderingOrder){$I.splice($E+1,0,this);break}}else $I.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},$I._clearSelfRenderObjects=function(){var $I=this.scene._cameraPool;$I.splice($I.indexOf(this),1)},$I.destroy=function($I){void 0===$I&&($I=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,$g.stage.off("resize",this,this._onScreenSizeChanged),$M.prototype.destroy.call(this,$I)},$t(0,$I,"sky",function(){return this._sky},function($I){(this._sky=$I)._ownerCamera=this}),$t(0,$I,"forward",function(){var $I=this.transform.worldMatrix.elements,$M=this._forward.elements;return $M[0]=-$I[8],$M[1]=-$I[9],$M[2]=-$I[10],this._forward}),$t(0,$I,"position",function(){var $I=this.transform.worldMatrix.elements,$M=this._position.elements;return $M[0]=$I[12],$M[1]=$I[13],$M[2]=$I[14],this._position}),$t(0,$I,"renderTarget",function(){return this._renderTarget},function($I){null!=(this._renderTarget=$I)&&(this._renderTargetSize=$I.size)}),$t(0,$I,"up",function(){var $I=this.transform.worldMatrix.elements,$M=this._up.elements;return $M[0]=$I[4],$M[1]=$I[5],$M[2]=$I[6],this._up}),$t(0,$I,"right",function(){var $I=this.transform.worldMatrix.elements,$M=this._right.elements;return $M[0]=$I[0],$M[1]=$I[1],$M[2]=$I[2],this._right}),$t(0,$I,"renderTargetSize",function(){return this._renderTargetSize},function($I){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=$I,this._calculateProjectionMatrix()}),$t(0,$I,"fieldOfView",function(){return this._fieldOfView},function($I){this._fieldOfView=$I,this._calculateProjectionMatrix()}),$t(0,$I,"nearPlane",function(){return this._nearPlane},function($I){this._nearPlane=$I,this._calculateProjectionMatrix()}),$t(0,$I,"farPlane",function(){return this._farPlane},function($I){this._farPlane=$I,this._calculateProjectionMatrix()}),$t(0,$I,"orthographic",function(){return this._orthographic},function($I){this._orthographic=$I,this._calculateProjectionMatrix()}),$t(0,$I,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function($I){this._orthographicVerticalSize=$I,this._calculateProjectionMatrix()}),$t(0,$I,"renderingOrder",function(){return this._renderingOrder},function($I){this._renderingOrder=$I,this._sortCamerasByRenderingOrder()}),$E.CAMERAPOS=0,$E.VIEWMATRIX=1,$E.PROJECTMATRIX=2,$E.VPMATRIX=3,$E.VPMATRIX_NO_TRANSLATE=4,$E.CAMERADIRECTION=5,$E.CAMERAUP=6,$E.ENVIRONMENTDIFFUSE=7,$E.ENVIRONMENTSPECULAR=8,$E.SIMLODINFO=9,$E.DIFFUSEIRRADMATR=10,$E.DIFFUSEIRRADMATG=11,$E.DIFFUSEIRRADMATB=12,$E.HDREXPOSURE=13,$E.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",$E.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",$E.CLEARFLAG_SOLIDCOLOR=0,$E.CLEARFLAG_SKY=1,$E.CLEARFLAG_DEPTHONLY=2,$E.CLEARFLAG_NONE=3,$A($E,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new $IM(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new $IM},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new $IM}]),$E}($SM),$hM=function($E){function $M($I){this._render=null,this._geometryFilter=null,$M.__super.call(this,$I)}$p($M,"laya.d3.core.RenderableSprite3D",$E);var $I=$M.prototype;return $I._addToInitStaticBatchManager=function(){},$I._setBelongScene=function($I){$E.prototype._setBelongScene.call(this,$I),$I._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},$I._setUnBelongScene=function(){var $I=this._scene._renderableSprite3Ds,$M=$I.indexOf(this);$I.splice($M,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),$E.prototype._setUnBelongScene.call(this)},$I._update=function($I){($I.owner=this)._activeInHierarchy&&(this._updateComponents($I),this._render._updateOctreeNode(),this._lateUpdateComponents($I),$m.spriteCount++,this._childs.length&&this._updateChilds($I))},$I.destroy=function($I){void 0===$I&&($I=!0),$E.prototype.destroy.call(this,$I),this._render._destroy(),this._render=null},$M.__init__=function(){$M.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=$M.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),$M.SAHDERDEFINE_LIGHTMAP=$M.shaderDefines.registerDefine("LIGHTMAP")},$M.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,$M.SAHDERDEFINE_LIGHTMAP=4,$M.LIGHTMAPSCALEOFFSET=2,$M.LIGHTMAP=3,$A($M,["shaderDefines",function(){return this.shaderDefines=new $BM}]),$M}($SM),$PM=(function($I){function $Z($I,$M,$E){this._long=NaN,this._width=NaN,this._height=NaN,void 0===$I&&($I=1),void 0===$M&&($M=1),void 0===$E&&($E=1),$Z.__super.call(this),this._long=$I,this._width=$M,this._height=$E,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$p($Z,"laya.d3.resource.models.BoxMesh",$rM);var $M=$Z.prototype;$M.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var $I=$WI.vertexDeclaration,$M=($I.vertexStride,this._long/2),$E=this._height/2,$Z=this._width/2,$i=new Float32Array([-$M,$E,-$Z,0,1,0,0,0,$M,$E,-$Z,0,1,0,1,0,$M,$E,$Z,0,1,0,1,1,-$M,$E,$Z,0,1,0,0,1,-$M,-$E,-$Z,0,-1,0,0,1,$M,-$E,-$Z,0,-1,0,1,1,$M,-$E,$Z,0,-1,0,1,0,-$M,-$E,$Z,0,-1,0,0,0,-$M,$E,-$Z,-1,0,0,0,0,-$M,$E,$Z,-1,0,0,1,0,-$M,-$E,$Z,-1,0,0,1,1,-$M,-$E,-$Z,-1,0,0,0,1,$M,$E,-$Z,1,0,0,1,0,$M,$E,$Z,1,0,0,0,0,$M,-$E,$Z,1,0,0,0,1,$M,-$E,-$Z,1,0,0,1,1,-$M,$E,$Z,0,0,1,0,0,$M,$E,$Z,0,0,1,1,0,$M,-$E,$Z,0,0,1,1,1,-$M,-$E,$Z,0,0,1,0,1,-$M,$E,-$Z,0,0,-1,1,0,$M,$E,-$Z,0,0,-1,0,0,$M,-$E,-$Z,0,0,-1,0,1,-$M,-$E,-$Z,0,0,-1,1,1]),$n=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new $xM($I,this._numberVertices,35044,!0),this._indexBuffer=new $JM("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData($i),this._indexBuffer.setData($n),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$t(0,$M,"long",function(){return this._long},function($I){this._long!==$I&&(this._long=$I,this.releaseResource(),this.activeResource())}),$t(0,$M,"width",function(){return this._width},function($I){this._width!==$I&&(this._width=$I,this.releaseResource(),this.activeResource())}),$t(0,$M,"height",function(){return this._height},function($I){this._height!==$I&&(this._height=$I,this.releaseResource(),this.activeResource())})}(),function($I){function $i($I,$M,$E,$Z){this._long=NaN,this._width=NaN,this._stacks=0,void(this._slices=0)===$I&&($I=10),void 0===$M&&($M=10),void 0===$E&&($E=10),void 0===$Z&&($Z=10),$i.__super.call(this),this._long=$I,this._width=$M,this._stacks=$E,this._slices=$Z,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}$p($i,"laya.d3.resource.models.PlaneMesh",$rM);var $M=$i.prototype;$M.recreateResource=function(){this.disposeResource(),this._numberVertices=(this._stacks+1)*(this._slices+1),this._numberIndices=this._stacks*this._slices*2*3;for(var $I=new Uint16Array(this._numberIndices),$M=$WI.vertexDeclaration,$E=$M.vertexStride/4,$Z=new Float32Array(this._numberVertices*$E),$i=this._long/2,$n=this._width/2,$c=this._long/this._stacks,$f=this._width/this._slices,$d=0,$H=0;$H<=this._slices;$H++)for(var $B=0;$B<=this._stacks;$B++)$Z[$d++]=$B*$c-$i,$Z[$d++]=0,$Z[$d++]=$H*$f-$n,$Z[$d++]=0,$Z[$d++]=1,$Z[$d++]=0,$Z[$d++]=1*$B/this._stacks,$Z[$d++]=1*$H/this._slices;var $A=0;for($H=0;$H<this._slices;$H++)for($B=0;$B<this._stacks;$B++)$I[$A++]=($H+1)*(this._stacks+1)+$B,$I[$A++]=$H*(this._stacks+1)+$B,$I[$A++]=($H+1)*(this._stacks+1)+$B+1,$I[$A++]=$H*(this._stacks+1)+$B,$I[$A++]=$H*(this._stacks+1)+$B+1,$I[$A++]=($H+1)*(this._stacks+1)+$B+1;this._vertexBuffer=new $xM($M,this._numberVertices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer=new $JM("ushort",this._numberIndices,35044,!0),this._indexBuffer._addReference(),this._vertexBuffer.setData($Z),this._indexBuffer.setData($I),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},$t(0,$M,"long",function(){return this._long},function($I){this._long!==$I&&(this._long=$I,this.releaseResource(),this.activeResource())}),$t(0,$M,"width",function(){return this._width},function($I){this._width!==$I&&(this._width=$I,this.releaseResource(),this.activeResource())}),$t(0,$M,"stacks",function(){return this._stacks},function($I){this._stacks!==$I&&(this._stacks=$I,this.releaseResource(),this.activeResource())}),$t(0,$M,"slices",function(){return this._slices},function($I){this._slices!==$I&&(this._slices=$I,this.releaseResource(),this.activeResource())})}(),function($I){function $c($I,$M,$E){void 0===$I&&($I=0),void 0===$M&&($M=.3),void 0===$E&&($E=1e3),this._viewMatrix=new $IM,this._projectionMatrix=new $IM,this._projectionViewMatrix=new $IM,this._viewport=new $dM(0,0,0,0),this._normalizedViewport=new $dM(0,0,1,1),this._aspectRatio=$I,this._boundFrustumUpdate=!0,this._boundFrustum=new $KI($IM.DEFAULT),$c.__super.call(this,$M,$E),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}$p($c,"laya.d3.core.Camera",$_M);var $M=$c.prototype;return $M._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},$M._parseCustomProps=function($I,$M,$E,$Z){var $i=$E.clearColor;this.clearColor=new $fM($i[0],$i[1],$i[2],$i[3]);var $n=$E.viewport;this.normalizedViewport=new $dM($n[0],$n[1],$n[2],$n[3])},$M._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var $I=this.orthographicVerticalSize*this.aspectRatio*.5,$M=.5*this.orthographicVerticalSize;$IM.createOrthoOffCenterRH(-$I,$I,-$M,$M,this.nearPlane,this.farPlane,this._projectionMatrix)}else $IM.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},$M._update=function($I){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,$I)},$M._renderCamera=function($I,$M,$E){var $Z,$i;$E.parallelSplitShadowMaps[0]&&$E._renderShadowMap($I,$M,this),($M.camera=this)._prepareCameraToRender(),$E._preRenderUpdateComponents($M),$Z=$M._viewMatrix=this.viewMatrix;var $n=this._renderTarget;$n?($n.start(),$IM.multiply($_M._invertYScaleMatrix,this._projectionMatrix,$_M._invertYProjectionMatrix),$IM.multiply($_M._invertYScaleMatrix,this.projectionViewMatrix,$_M._invertYProjectionViewMatrix),$i=$M._projectionMatrix=$_M._invertYProjectionMatrix,$M._projectionViewMatrix=$_M._invertYProjectionViewMatrix):($i=$M._projectionMatrix=this._projectionMatrix,$M._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject($Z,$i),$M._viewport=this.viewport,$E._preRenderScene($I,$M,this.boundFrustum),$E._clear($I,$M),$E._renderScene($I,$M),$E._postRenderUpdateComponents($M),$n&&$n.end()},$M.viewportPointToRay=function($I,$M){$tM.calculateCursorRay($I,this.viewport,this._projectionMatrix,this.viewMatrix,null,$M)},$M.normalizedViewportPointToRay=function($I,$M){var $E=$c._tempVector20,$Z=this.viewport,$i=$I.elements,$n=$E.elements;$n[0]=$i[0]*$Z.width,$n[1]=$i[1]*$Z.height,$tM.calculateCursorRay($E,this.viewport,this._projectionMatrix,this.viewMatrix,null,$M)},$M.worldToViewportPoint=function($I,$M){$IM.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project($I,this._projectionViewMatrix,$M);var $E=$M.elements;$E[0]=$E[0]/$g.stage.clientScaleX,$E[1]=$E[1]/$g.stage.clientScaleY},$M.worldToNormalizedViewportPoint=function($I,$M){$IM.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project($I,this._projectionViewMatrix,$M);var $E=$M.elements;$E[0]=$E[0]/$g.stage.clientScaleX,$E[1]=$E[1]/$g.stage.clientScaleY},$M.convertScreenCoordToOrthographicCoord=function($I,$M){if(this._orthographic){var $E=$G.clientWidth,$Z=$G.clientHeight,$i=this.orthographicVerticalSize*this.aspectRatio/$E,$n=this.orthographicVerticalSize/$Z,$c=$I.elements,$f=$M.elements;return $f[0]=(-$E/2+$c[0])*$i,$f[1]=($Z/2-$c[1])*$n,$f[2]=(this.nearPlane-this.farPlane)*($c[2]+1)/2-this.nearPlane,$cM.transformCoordinate($M,this.transform.worldMatrix,$M),!0}return!1},$t(0,$M,"projectionViewMatrix",function(){return $IM.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),$t(0,$M,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var $I=this.viewport;return $I.width/$I.height},function($I){if($I<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=$I,this._calculateProjectionMatrix()}),$t(0,$M,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),$t(0,$M,"needViewport",function(){var $I=this.normalizedViewport;return 0===$I.x&&0===$I.y&&1===$I.width&&1===$I.height}),$t(0,$M,"viewport",function(){if(this._viewportExpressedInClipSpace){var $I=this._normalizedViewport,$M=this.renderTargetSize,$E=$M.width,$Z=$M.height;this._viewport.x=$I.x*$E,this._viewport.y=$I.y*$Z,this._viewport.width=$I.width*$E,this._viewport.height=$I.height*$Z}return this._viewport},function($I){if(null!=this.renderTarget&&($I.x<0||$I.y<0||0==$I.width||0==$I.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=$I,this._calculateProjectionMatrix()}),$t(0,$M,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var $I=this._viewport,$M=this.renderTargetSize,$E=$M.width,$Z=$M.height;this._normalizedViewport.x=$I.x/$E,this._normalizedViewport.y=$I.y/$Z,this._normalizedViewport.width=$I.width/$E,this._normalizedViewport.height=$I.height/$Z}return this._normalizedViewport},function($I){$I.x<0&&($I.x=0,console.warn("Camera: viewport.x must large than 0.0.")),$I.y<0&&($I.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<$I.x+$I.width&&($I.width=1-$I.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<$I.y+$I.height&&($I.height=1-$I.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=$I,this._calculateProjectionMatrix()}),$t(0,$M,"projectionMatrix",function(){return this._projectionMatrix},function($I){this._projectionMatrix=$I,this._useUserProjectionMatrix=!0}),$t(0,$M,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),$A($c,["_tempVector20",function(){return this._tempVector20=new $nM}]),$c}()),$DM=function($E){function $Z($I,$M){$Z.__super.call(this,$M),this._geometryFilter=new $zM(this),this._render=new $LM(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),$I&&(this._geometryFilter.sharedMesh=$I)instanceof laya.d3.resource.models.Mesh&&($I.loaded?this._render.sharedMaterials=$I.materials:$I.once("loaded",this,this._applyMeshMaterials))}$p($Z,"laya.d3.core.MeshSprite3D",$E);var $I=$Z.prototype;return $I._changeRenderObjectByMesh=function($I){var $M=this._render._renderElements,$E=$M[$I];$E||($E=$M[$I]=new $aM),$E._render=this._render;var $Z=this._render.sharedMaterials[$I];$Z||($Z=$CM.defaultMaterial);var $i=this._geometryFilter.sharedMesh.getRenderElement($I);return $E._mainSortID=this._getSortID($i,$Z),$E._sprite3D=this,$E.renderObj=$i,$E._material=$Z,$E},$I._changeRenderObjectByMaterial=function($I,$M){var $E=this._render._renderElements[$I];$M||($M=$CM.defaultMaterial);var $Z=this._geometryFilter.sharedMesh.getRenderElement($I);return $E._mainSortID=this._getSortID($Z,$M),$E._sprite3D=this,$E.renderObj=$Z,$E._material=$M,$E},$I._changeRenderObjectsByMesh=function(){var $I=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=$I;for(var $M=0;$M<$I;$M++)this._changeRenderObjectByMesh($M)},$I._onMeshChanged=function($I){var $M=$I.sharedMesh;$M.loaded?this._changeRenderObjectsByMesh():$M.once("loaded",this,this._onMeshLoaded)},$I._onMeshLoaded=function($I){$I===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},$I._onMaterialChanged=function($I,$M,$E){$M<this._render._renderElements.length&&this._changeRenderObjectByMaterial($M,$E)},$I._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},$I._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},$I._parseCustomProps=function($I,$M,$E,$Z){var $i=this.meshRender,$n=$E.lightmapIndex;null!=$n&&($i.lightmapIndex=$n);var $c,$f,$d=$E.lightmapScaleOffset;if($d&&($i.lightmapScaleOffset=new $fM($d[0],$d[1],$d[2],$d[3])),$Z.instanceParams)($c=$Z.instanceParams.loadPath)&&($f=$N.getRes($M[$c]),(this.meshFilter.sharedMesh=$f).loaded?$i.sharedMaterials=$f.materials:$f.once("loaded",this,this._applyMeshMaterials));else{($c=$E.meshPath)&&($f=$N.getRes($M[$c]),this.meshFilter.sharedMesh=$f);var $H=$E.materials;if($H){var $B=$i.sharedMaterials,$A=$H.length;$B.length=$A;for(var $Q=0;$Q<$A;$Q++)$B[$Q]=$N.getRes($M[$H[$Q].path]);$i.sharedMaterials=$B}}},$I._applyMeshMaterials=function($I){for(var $M=this._render.sharedMaterials,$E=$I.materials,$Z=0,$i=$E.length;$Z<$i;$Z++)$M[$Z]||($M[$Z]=$E[$Z]);this._render.sharedMaterials=$M},$I._addToInitStaticBatchManager=function(){$Z._staticBatchManager._addInitBatchSprite(this)},$I.cloneTo=function($I){var $M=$I;$M._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var $E=this._render,$Z=$M._render;$Z.enable=$E.enable,$Z.sharedMaterials=$E.sharedMaterials,$Z.castShadow=$E.castShadow;var $i=$E.lightmapScaleOffset;$i&&($Z.lightmapScaleOffset=$i.clone()),$Z.lightmapIndex=$E.lightmapIndex,$Z.receiveShadow=$E.receiveShadow,$Z.sortingFudge=$E.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,$I)},$I.destroy=function($I){if(void 0===$I&&($I=!0),!this.destroyed){var $M=this.meshFilter.sharedMesh;null!=$M&&($M.loaded||$M.off("loaded",this,this._applyMeshMaterials)),$E.prototype.destroy.call(this,$I),this._geometryFilter._destroy()}},$t(0,$I,"meshFilter",function(){return this._geometryFilter}),$t(0,$I,"meshRender",function(){return this._render}),$Z.__init__=function(){$ZI._staticBatchManagers.push($Z._staticBatchManager)},$Z.load=function($I){return $g.loader.create($I,null,null,$Z)},$A($Z,["_staticBatchManager",function(){return this._staticBatchManager=new $jM}]),$Z}($hM)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($I,$M){"use strict";for(var $E in Object.defineProperty($M,"__esModule",{value:!0}),Laya){var $Z=Laya[$E];$Z&&$Z.__isclass&&($M[$E]=$Z)}}),function($I,$M,$iI){$iI.un,$iI.uns;var $E=$iI.static,$Z=$iI.class,$n=$iI.getset,$V=$iI.__newvec,$f=laya.maths.Bezier,$A=laya.utils.Browser,$WI=laya.utils.Byte,$i=(laya.events.Event,laya.events.EventDispatcher),$c=laya.display.Graphics,$d=(laya.resource.HTMLCanvas,laya.utils.Handler),$H=laya.net.Loader,$Q=laya.maths.MathUtil,$RI=laya.maths.Matrix,$u=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),$B=(laya.renders.RenderContext,laya.resource.Resource),$p=laya.utils.RunDriver,$nI=laya.display.Sprite,$t=laya.utils.Stat,$zI=laya.resource.Texture,$N=(laya.net.URL,laya.utils.Utils),$R=function(){function $I(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return $Z($I,"laya.ani.AnimationContent"),$I}(),$z=function(){function $I(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return $Z($I,"laya.ani.AnimationNodeContent"),$I}(),$$=function(){function $I(){}return $Z($I,"laya.ani.AnimationParser01"),$I.parse=function($I,$M){var $E=$M.__getBuffer(),$Z=0,$i=0,$n=0,$c=0,$f=0,$d=0,$H=0,$B=$M.readUTFString();$I._aniClassName=$B;var $A,$Q=$M.readUTFString().split("\n"),$p=$M.getUint8(),$t=$M.getUint32(),$V=$M.getUint32();0<$t&&($A=$E.slice($t,$V));var $u=new $WI($A);for(0<$V&&($I._publicExtData=$E.slice($V,$E.byteLength)),$I._useParent=!!$M.getUint8(),$I._anis.length=$p,$Z=0;$Z<$p;$Z++){var $N=$I._anis[$Z]=new $R;$N.nodes=new Array;var $y=$N.name=$Q[$M.getUint16()];$I._aniMap[$y]=$Z,$N.bone3DMap={},$N.playTime=$M.getFloat32(),$N.playTime<=0&&console.error("播放时间不能为0  url="+$I.url+" name="+$N.name);var $$=$N.nodes.length=$M.getUint8();for($i=$N.totalKeyframeDatasLength=0;$i<$$;$i++){var $w=$N.nodes[$i]=new $z;$w.childs=[];var $g=$M.getInt16();0<=$g&&($w.name=$Q[$g],$N.bone3DMap[$w.name]=$i),$w.keyFrame=new Array,$w.parentIndex=$M.getInt16(),-1==$w.parentIndex?$w.parent=null:$w.parent=$N.nodes[$w.parentIndex],$w.lerpType=$M.getUint8();var $O=$M.getUint32();$u.pos=$O;var $a=$w.keyframeWidth=$u.getUint16();if($N.totalKeyframeDatasLength+=$a,0===$w.lerpType||1===$w.lerpType)for($w.interpolationMethod=[],$w.interpolationMethod.length=$a,$n=0;$n<$a;$n++)$w.interpolationMethod[$n]=$S.interpolation[$u.getUint8()];null!=$w.parent&&$w.parent.childs.push($w);var $m=$M.getUint16();0<$m&&($w.extenData=$E.slice($M.pos,$M.pos+$m),$M.pos+=$m);var $j,$T=$M.getUint16(),$q=0;for($n=0,$c=$w.keyFrame.length=$T;$n<$c;$n++){if(($j=$w.keyFrame[$n]=new $L).duration=$M.getFloat32(),$j.startTime=$q,2===$w.lerpType){$j.interpolationData=[];var $v,$W=$M.getUint8();switch($v=$M.getFloat32()){case 254:for($j.interpolationData.length=$a,$H=0;$H<$a;$H++)$j.interpolationData[$H]=0;break;case 255:for($j.interpolationData.length=$a,$H=0;$H<$a;$H++)$j.interpolationData[$H]=5;break;default:for($j.interpolationData.push($v),$d=1;$d<$W;$d++)$j.interpolationData.push($M.getFloat32())}}for($j.data=new Float32Array($a),$f=0;$f<$a;$f++)$j.data[$f]=$M.getFloat32(),-1e-8<$j.data[$f]&&$j.data[$f]<1e-8&&($j.data[$f]=0);$q+=$j.duration}$j.startTime=$N.playTime,$w.playTime=$N.playTime,$I._calculateKeyFrame($w,$T,$a)}}},$I}(),$w=function(){function $g(){}return $Z($g,"laya.ani.AnimationParser02"),$g.READ_DATA=function(){$g._DATA.offset=$g._reader.getUint32(),$g._DATA.size=$g._reader.getUint32()},$g.READ_BLOCK=function(){for(var $I=$g._BLOCK.count=$g._reader.getUint16(),$M=$g._BLOCK.blockStarts=[],$E=$g._BLOCK.blockLengths=[],$Z=0;$Z<$I;$Z++)$M.push($g._reader.getUint32()),$E.push($g._reader.getUint32())},$g.READ_STRINGS=function(){var $I=$g._reader.getUint32(),$M=$g._reader.getUint16(),$E=$g._reader.pos;$g._reader.pos=$I+$g._DATA.offset;for(var $Z=0;$Z<$M;$Z++)$g._strings[$Z]=$g._reader.readUTFString();$g._reader.pos=$E},$g.parse=function($I,$M){$g._templet=$I;($g._reader=$M).__getBuffer();$g.READ_DATA(),$g.READ_BLOCK(),$g.READ_STRINGS();for(var $E=0,$Z=$g._BLOCK.count;$E<$Z;$E++){var $i=$M.getUint16(),$n=$g._strings[$i],$c=$g["READ_"+$n];if(null==$c)throw new Error("model file err,no this function:"+$i+" "+$n);$c.call()}},$g.READ_ANIMATIONS=function(){var $I=$g._reader,$M=$I.__getBuffer(),$E=0,$Z=0,$i=0,$n=0,$c=$I.getUint16(),$f=[];for($f.length=$c,$E=0;$E<$c;$E++)$f[$E]=$S.interpolation[$I.getByte()];var $d=$I.getUint8();for($g._templet._anis.length=$d,$E=0;$E<$d;$E++){var $H=$g._templet._anis[$E]={};$H.nodes=new Array;var $B=$H.name=$g._strings[$I.getUint16()];$g._templet._aniMap[$B]=$E,$H.bone3DMap={},$H.playTime=$I.getFloat32();var $A=$H.nodes.length=$I.getInt16();for($Z=$H.totalKeyframeDatasLength=0;$Z<$A;$Z++){var $Q=$H.nodes[$Z]={};$Q.keyframeWidth=$c,$Q.childs=[];var $p=$I.getUint16();0<=$p&&($Q.name=$g._strings[$p],$H.bone3DMap[$Q.name]=$Z),$Q.keyFrame=new Array,$Q.parentIndex=$I.getInt16(),-1==$Q.parentIndex?$Q.parent=null:$Q.parent=$H.nodes[$Q.parentIndex],$H.totalKeyframeDatasLength+=$c,$Q.interpolationMethod=$f,null!=$Q.parent&&$Q.parent.childs.push($Q);var $t=$I.getUint16(),$V=null,$u=null;for($i=0,$n=$Q.keyFrame.length=$t;$i<$n;$i++){($V=$Q.keyFrame[$i]={}).startTime=$I.getFloat32(),$u&&($u.duration=$V.startTime-$u.startTime);var $N=$g._DATA.offset,$y=$I.getUint32(),$$=4*$c,$w=$M.slice($N+$y,$N+$y+$$);$V.data=new Float32Array($w),$u=$V}$V.duration=0,$Q.playTime=$H.playTime,$g._templet._calculateKeyFrame($Q,$t,$c)}}},$g._templet=null,$g._reader=null,$g._strings=[],$E($g,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),$g}(),$LI=(function(){function $I(){}$Z($I,"laya.ani.AnimationState"),$I.stopped=0,$I.paused=1,$I.playing=2}(),function(){function $i(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new $hI,this.resultMatrix=new $RI,this._children=[]}$Z($i,"laya.ani.bone.Bone");var $I=$i.prototype;return $I.setTempMatrix=function($I){this._tempMatrix=$I;var $M,$E=0;for($E=0,$M=this._children.length;$E<$M;$E++)this._children[$E].setTempMatrix(this._tempMatrix)},$I.update=function($I){var $M;if(this.rotation=this.transform.skX,$I)$M=this.resultTransform.getMatrix(),$RI.mul($M,$I,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)$M=this.resultTransform.getMatrix(),$RI.mul($M,this.parentBone.resultMatrix,this.resultMatrix);else{var $E=this.parentBone,$Z=NaN,$i=NaN,$n=NaN,$c=this.parentBone.resultMatrix;$M=this.resultTransform.getMatrix();var $f=$c.a*$M.tx+$c.c*$M.ty+$c.tx,$d=$c.b*$M.tx+$c.d*$M.ty+$c.ty,$H=new $RI;this.inheritRotation?($Z=Math.atan2($E.resultMatrix.b,$E.resultMatrix.a),$i=Math.cos($Z),$n=Math.sin($Z),$H.setTo($i,$n,-$n,$i,0,0),$RI.mul(this._tempMatrix,$H,$RI.TEMP),$RI.TEMP.copyTo($H),$M=this.resultTransform.getMatrix(),$RI.mul($M,$H,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,$M=this.resultTransform.getMatrix(),$RI.TEMP.identity(),$RI.TEMP.d=this.d,$RI.mul($M,$RI.TEMP,this.resultMatrix)),this.resultMatrix.tx=$f,this.resultMatrix.ty=$d}else($M=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var $B,$A=0;for($A=0,$B=this._children.length;$A<$B;$A++)this._children[$A].update()},$I.updateChild=function(){var $I,$M=0;for($M=0,$I=this._children.length;$M<$I;$M++)this._children[$M].update()},$I.setRotation=function($I){this._sprite&&(this._sprite.rotation=180*$I/Math.PI)},$I.updateDraw=function($I,$M){$i.ShowBones&&!$i.ShowBones[this.name]||(this._sprite||(this._sprite=new $nI,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),$iI.stage.addChild(this._sprite)),this._sprite.x=$I+this.resultMatrix.tx,this._sprite.y=$M+this.resultMatrix.ty);var $E,$Z=0;for($Z=0,$E=this._children.length;$Z<$E;$Z++)this._children[$Z].updateDraw($I,$M)},$I.addChild=function($I){this._children.push($I),$I.parentBone=this},$I.findBone=function($I){if(this.name==$I)return this;var $M,$E,$Z=0;for($Z=0,$M=this._children.length;$Z<$M;$Z++)if($E=this._children[$Z].findBone($I))return $E;return null},$I.localToWorld=function($I){var $M=$I[0],$E=$I[1];$I[0]=$M*this.resultMatrix.a+$E*this.resultMatrix.c+this.resultMatrix.tx,$I[1]=$M*this.resultMatrix.b+$E*this.resultMatrix.d+this.resultMatrix.ty},$i.ShowBones={},$i}()),$oI=function(){function $V(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}$Z($V,"laya.ani.bone.BoneSlot");var $I=$V.prototype;return $I.showSlotData=function($I,$M){void 0===$M&&($M=!0),this.currSlotData=$I,$M&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},$I.showDisplayByName=function($I){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName($I))},$I.replaceDisplayByName=function($I,$M){if(this.currSlotData){var $E;$E=this.currSlotData.getDisplayByName($I);var $Z;$Z=this.currSlotData.getDisplayByName($M),this.replaceDisplayByIndex($E,$Z)}},$I.replaceDisplayByIndex=function($I,$M){this.currSlotData&&(this._replaceDic[$I]=$M,this.displayIndex==$I&&this.showDisplayByIndex($I))},$I.showDisplayByIndex=function($I){if(null!=this._replaceDic[$I]&&($I=this._replaceDic[$I]),this.currSlotData&&-1<$I&&$I<this.currSlotData.displayArr.length){if(this.displayIndex=$I,this.currDisplayData=this.currSlotData.displayArr[$I],this.currDisplayData){var $M=this.currDisplayData.name;this.currTexture=this.templet.getTexture($M),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!$u.isConchApp||$u.isConchApp&&"0.9.15"<$nI.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},$I.replaceSkin=function($I){this._diyTexture=$I,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},$I.setParentMatrix=function($I){this._parentMatrix=$I},$I.draw=function($I,$M,$E,$Z){if(void 0===$E&&($E=!1),void 0===$Z&&($Z=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var $i,$n=this.currTexture;switch(this._diyTexture&&($n=this._diyTexture),this.currDisplayData.type){case 0:if($I){var $c=this.getDisplayMatrix();if(this._parentMatrix){var $f=!1;if($c){var $d;if($RI.mul($c,this._parentMatrix,$RI.TEMP),$d=$E?(null==this._resultMatrix&&(this._resultMatrix=new $RI),this._resultMatrix):new $RI,!$u.isWebGL&&this.currDisplayData.uvs||$u.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var $H=$V._tempMatrix;$H.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($H.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&($f=!0,$H.rotate(-Math.PI/2)),$RI.mul($H,$RI.TEMP,$d)}else $RI.TEMP.copyTo($d);$f?$I.drawTexture($n,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,$d):$I.drawTexture($n,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,$d)}}}break;case 1:if(null==($i=$E?(null==this._skinSprite&&(this._skinSprite=$V.createSkinMesh()),this._skinSprite):$V.createSkinMesh()))return;var $B;if(null==this.currDisplayData.bones){var $A,$Q=this.currDisplayData.weights;this.deformData&&($Q=this.deformData),$A=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$a.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$a.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=$Q;this.currDisplayData.triangles.length;$B=this.currDisplayData.triangles,$i.init2($n,null,$B,this._mVerticleArr,$A);var $p,$t=this.getDisplayMatrix();if(this._parentMatrix)if($t)$RI.mul($t,this._parentMatrix,$RI.TEMP),$p=$E?(null==this._resultMatrix&&(this._resultMatrix=new $RI),this._resultMatrix):new $RI,$RI.TEMP.copyTo($p),$i.transform=$p}else this.skinMesh($M,$i,$Z);$I.drawSkin($i);break;case 2:if(null==($i=$E?(null==this._skinSprite&&(this._skinSprite=$V.createSkinMesh()),this._skinSprite):$V.createSkinMesh()))return;this.skinMesh($M,$i,$Z),$I.drawSkin($i)}}},$I.skinMesh=function($I,$M,$E){var $Z,$i=this.currTexture,$n=this.currDisplayData.bones;$Z=this._diyTexture?($i=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=$a.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=$a.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var $c,$f,$d=this.currDisplayData.weights,$H=this.currDisplayData.triangles,$B=0,$A=0,$Q=0,$p=NaN,$t=NaN,$V=0,$u=0,$N=[],$y=0,$$=0;if(this.deformData&&0<this.deformData.length){var $w=0;for($y=0,$$=$n.length;$y<$$;){for($Q=$n[$y++]+$y,$A=$B=0;$y<$Q;$y++)$f=$I[$n[$y]],$p=$d[$V]+this.deformData[$w++],$t=$d[$V+1]+this.deformData[$w++],$u=$d[$V+2],$B+=($p*$f.a+$t*$f.c+$f.tx)*$u,$A+=($p*$f.b+$t*$f.d+$f.ty)*$u,$V+=3;$N.push($B,$A)}}else for($y=0,$$=$n.length;$y<$$;){for($Q=$n[$y++]+$y,$A=$B=0;$y<$Q;$y++)$f=$I[$n[$y]],$p=$d[$V],$t=$d[$V+1],$u=$d[$V+2],$B+=($p*$f.a+$t*$f.c+$f.tx)*$u,$A+=($p*$f.b+$t*$f.d+$f.ty)*$u,$V+=3;$N.push($B,$A)}this._mVerticleArr=$N,$c=$H,$M.init2($i,null,$c,this._mVerticleArr,$Z)},$I.drawBonePoint=function($I){$I&&this._parentMatrix&&$I.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},$I.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},$I.getMatrix=function(){return this._resultMatrix},$I.copy=function(){var $I=new $V;return $I.type="copy",$I.name=this.name,$I.attachmentName=this.attachmentName,$I.srcDisplayIndex=this.srcDisplayIndex,$I.parent=this.parent,$I.displayIndex=this.displayIndex,$I.templet=this.templet,$I.currSlotData=this.currSlotData,$I.currTexture=this.currTexture,$I.currDisplayData=this.currDisplayData,$I},$V.createSkinMesh=function(){return $u.isWebGL||$u.isConchApp?$p.skinAniSprite():($u.isWebGL,null)},$E($V,["_tempMatrix",function(){return this._tempMatrix=new $RI}]),$V}(),$SI=function(){function $I(){this.skinName=null,this.deformSlotDataList=[]}return $Z($I,"laya.ani.bone.DeformAniData"),$I}(),$XI=function(){function $I(){this.deformSlotDisplayList=[]}return $Z($I,"laya.ani.bone.DeformSlotData"),$I}(),$CI=function(){function $I(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}$Z($I,"laya.ani.bone.DeformSlotDisplayData");var $M=$I.prototype;return $M.binarySearch1=function($I,$M){var $E=0,$Z=$I.length-2;if(0==$Z)return 1;for(var $i=$Z>>>1;;){if($I[Math.floor($i+1)]<=$M?$E=$i+1:$Z=$i,$E==$Z)return $E+1;$i=$E+$Z>>>1}return 0},$M.apply=function($I,$M,$E){if(void 0===$E&&($E=1),$I+=.05,!(this.timeList.length<=0)){var $Z=0;if(!($I<this.timeList[0])){var $i=this.vectices[0].length,$n=[],$c=this.binarySearch1(this.timeList,$I);if(this.frameIndex=$c,$I>=this.timeList[this.timeList.length-1]){var $f=this.vectices[this.vectices.length-1];if($E<1)for($Z=0;$Z<$i;$Z++)$n[$Z]+=($f[$Z]-$n[$Z])*$E;else for($Z=0;$Z<$i;$Z++)$n[$Z]=$f[$Z];this.deformData=$n}else{this.tweenKeyList[this.frameIndex];var $d=this.vectices[this.frameIndex-1],$H=this.vectices[this.frameIndex],$B=this.timeList[this.frameIndex-1],$A=this.timeList[this.frameIndex];$E=this.tweenKeyList[$c-1]?($I-$B)/($A-$B):0;var $Q=NaN;for($Z=0;$Z<$i;$Z++)$Q=$d[$Z],$n[$Z]=$Q+($H[$Z]-$Q)*$E;this.deformData=$n}}}},$I}(),$JI=function(){function $I(){this.time=NaN,this.drawOrder=[]}return $Z($I,"laya.ani.bone.DrawOrderData"),$I}(),$xI=function(){function $I(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return $Z($I,"laya.ani.bone.EventData"),$I}(),$y=function(){function $ZI($I,$M){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=$I,this._targetBone=$M[$I.targetBoneIndex],this.isSpine=$I.isSpine,null==this._bones&&(this._bones=[]);for(var $E=this._bones.length=0,$Z=$I.boneIndexs.length;$E<$Z;$E++)this._bones.push($M[$I.boneIndexs[$E]]);this.name=$I.name,this.mix=$I.mix,this.bendDirection=$I.bendDirection}$Z($ZI,"laya.ani.bone.IkConstraint");var $I=$ZI.prototype;return $I.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},$I._applyIk1=function($I,$M,$E,$Z){var $i=$I.parentBone,$n=1/($i.resultMatrix.a*$i.resultMatrix.d-$i.resultMatrix.b*$i.resultMatrix.c),$c=$M-$i.resultMatrix.tx,$f=$E-$i.resultMatrix.ty,$d=($c*$i.resultMatrix.d-$f*$i.resultMatrix.c)*$n-$I.transform.x,$H=($f*$i.resultMatrix.a-$c*$i.resultMatrix.b)*$n-$I.transform.y,$B=Math.atan2($H,$d)*$ZI.radDeg-0-$I.transform.skX;$I.transform.scX<0&&($B+=180),180<$B?$B-=360:$B<-180&&($B+=360),$I.transform.skX=$I.transform.skY=$I.transform.skX+$B*$Z,$I.update()},$I.updatePos=function($I,$M){this._sp&&this._sp.pos($I,$M)},$I._applyIk2=function($I,$M,$E,$Z,$i,$n){if(0!=$n){var $c=$I.resultTransform.x,$f=$I.resultTransform.y,$d=$I.transform.scX,$H=$I.transform.scY,$B=$M.transform.scX,$A=0,$Q=0,$p=0;$p=$d<0?($d=-$d,$A=180,-1):($A=0,1),$H<0&&($H=-$H,$p=-$p),$Q=$B<0?($B=-$B,180):0;var $t=$M.resultTransform.x,$V=NaN,$u=NaN,$N=NaN,$y=$I.resultMatrix.a,$$=$I.resultMatrix.c,$w=$I.resultMatrix.b,$g=$I.resultMatrix.d,$O=Math.abs($d-$H)<=1e-4;$N=$O?($u=$y*$t+$$*($V=$M.resultTransform.y)+$I.resultMatrix.tx,$w*$t+$g*$V+$I.resultMatrix.ty):($V=0,$u=$y*$t+$I.resultMatrix.tx,$w*$t+$I.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new $nI,$iI.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($E,$Z,15,"#ffff00"),this._sp.graphics.drawCircle($u,$N,15,"#ff00ff")),$I.setRotation(Math.atan2($N-$I.resultMatrix.ty,$u-$I.resultMatrix.tx));var $a=$I.parentBone;$y=$a.resultMatrix.a,$$=$a.resultMatrix.c,$w=$a.resultMatrix.b;var $m=1/($y*($g=$a.resultMatrix.d)-$$*$w),$j=$E-$a.resultMatrix.tx,$T=$Z-$a.resultMatrix.ty,$q=($j*$g-$T*$$)*$m-$c,$v=($T*$y-$j*$w)*$m-$f,$W=(($j=$u-$a.resultMatrix.tx)*$g-($T=$N-$a.resultMatrix.ty)*$$)*$m-$c,$R=($T*$y-$j*$w)*$m-$f,$z=Math.sqrt($W*$W+$R*$R),$L=$M.length*$B,$o=NaN,$S=NaN;if($O){var $X=($q*$q+$v*$v-$z*$z-($L*=$d)*$L)/(2*$z*$L);$X<-1?$X=-1:1<$X&&($X=1),$S=Math.acos($X)*$i,$y=$z+$L*$X,$$=$L*Math.sin($S),$o=Math.atan2($v*$y-$q*$$,$q*$y+$v*$$)}else{var $C=($y=$d*$L)*$y,$J=($$=$H*$L)*$$,$x=$q*$q+$v*$v,$k=Math.atan2($v,$q),$r=-2*$J*$z,$l=$J-$C;if(0<($g=$r*$r-4*$l*($w=$J*$z*$z+$C*$x-$C*$J))){var $F=Math.sqrt($g);$r<0&&($F=-$F);var $e=($F=-($r+$F)/2)/$l,$_=$w/$F,$h=Math.abs($e)<Math.abs($_)?$e:$_;$h*$h<=$x&&($T=Math.sqrt($x-$h*$h)*$i,$o=$k-Math.atan2($T,$h),$S=Math.atan2($T/$H,($h-$z)/$d))}var $P=0,$D=Number.MAX_VALUE,$G=0,$Y=0,$K=0,$s=0,$b=0,$U=0;$s<($g=($j=$z+$y)*$j)&&($K=0,$s=$g,$b=$j),($g=($j=$z-$y)*$j)<$D&&($P=Math.PI,$D=$g,$G=$j);var $II=Math.acos(-$y*$z/($C-$J));($g=($j=$y*Math.cos($II)+$z)*$j+($T=$$*Math.sin($II))*$T)<$D&&($P=$II,$D=$g,$G=$j,$Y=$T),$s<$g&&($K=$II,$s=$g,$b=$j,$U=$T),$S=$x<=($D+$s)/2?($o=$k-Math.atan2($Y*$i,$G),$P*$i):($o=$k-Math.atan2($U*$i,$b),$K*$i)}var $MI=Math.atan2($V,$t)*$p,$EI=$I.resultTransform.skX;180<($o=($o-$MI)*$ZI.radDeg+$A-$EI)?$o-=360:$o<-180&&($o+=360),$I.resultTransform.x=$c,$I.resultTransform.y=$f,$I.resultTransform.skX=$I.resultTransform.skY=$EI+$o*$n,$EI=$M.resultTransform.skX,180<($S=(($S+$MI)*$ZI.radDeg-0)*$p+$Q-($EI%=360))?$S-=360:$S<-180&&($S+=360),$M.resultTransform.x=$t,$M.resultTransform.y=$V,$M.resultTransform.skX=$M.resultTransform.skY=$M.resultTransform.skY+$S*$n,$I.update()}},$I._applyIk3=function($I,$M,$E,$Z,$i,$n){if(0!=$n){var $c,$f,$d=$M.resultMatrix.a*$M.length,$H=$M.resultMatrix.b*$M.length,$B=$d*$d+$H*$H,$A=Math.sqrt($B),$Q=$I.resultMatrix.tx,$p=$I.resultMatrix.ty,$t=$M.resultMatrix.tx,$V=$M.resultMatrix.ty,$u=$t-$Q,$N=$V-$p,$y=$u*$u+$N*$N,$$=Math.sqrt($y),$w=($u=$E-$I.resultMatrix.tx)*$u+($N=$Z-$I.resultMatrix.ty)*$N,$g=Math.sqrt($w);if($A+$$<=$g||$g+$A<=$$||$g+$$<=$A){var $O=NaN;$t=$Q+($O=$A+$$<=$g?1:-1)*($E-$Q)*$$/$g,$V=$p+$O*($Z-$p)*$$/$g}else{var $a=($y-$B+$w)/(2*$w),$m=Math.sqrt($y-$a*$a*$w)/$g,$j=$Q+$u*$a,$T=$p+$N*$a,$q=-$N*$m,$v=$u*$m;$V=0<$i?($t=$j-$q,$T-$v):($t=$j+$q,$T+$v)}$c=$t,$f=$V,this.isDebug&&(this._sp||(this._sp=new $nI,$iI.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle($Q,$p,15,"#ff00ff"),this._sp.graphics.drawCircle($E,$Z,15,"#ffff00"),this._sp.graphics.drawCircle($c,$f,15,"#ff00ff"));var $W,$R;$W=Math.atan2($f-$I.resultMatrix.ty,$c-$I.resultMatrix.tx),$I.setRotation($W),($R=$ZI._tempMatrix).identity(),$R.rotate($W),$R.scale($I.resultMatrix.getScaleX(),$I.resultMatrix.getScaleY()),$R.translate($I.resultMatrix.tx,$I.resultMatrix.ty),$R.copyTo($I.resultMatrix),$I.updateChild();var $z,$L;$z=Math.atan2($Z-$f,$E-$c),$M.setRotation($z),($L=$ZI._tempMatrix).identity(),$L.rotate($z),$L.scale($M.resultMatrix.getScaleX(),$M.resultMatrix.getScaleY()),$L.translate($c,$f),$R.copyTo($M.resultMatrix),$M.updateChild()}},$E($ZI,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new $RI}]),$ZI}(),$kI=function(){function $I(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return $Z($I,"laya.ani.bone.IkConstraintData"),$I}(),$g=function(){function $L($I,$M){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=$I,this.position=$I.position,this.spacing=$I.spacing,this.rotateMix=$I.rotateMix,this.translateMix=$I.translateMix,this.bones=[];for(var $E=this.data.bones,$Z=0,$i=$E.length;$Z<$i;$Z++)this.bones.push($M[$E[$Z]])}$Z($L,"laya.ani.bone.PathConstraint");var $I=$L.prototype;return $I.apply=function($I,$M){if(this.target){var $E=this.translateMix,$Z=this.translateMix,$i=0<$Z,$n=this.data.spacingMode,$c="length"==$n,$f=this.data.rotateMode,$d="tangent"==$f,$H="chainScale"==$f,$B=[],$A=this.bones.length,$Q=$d?$A:$A+1,$p=[];(this._spaces=$p)[0]=this.position;var $t=this.spacing;if($H||$c)for(var $V=0,$u=$Q-1;$V<$u;){var $N=this.bones[$V],$y=$N.length,$$=$y*$N.resultMatrix.a,$w=$y*$N.resultMatrix.b;$y=Math.sqrt($$*$$+$w*$w),$H&&($B[$V]=$y),$p[++$V]=$c?Math.max(0,$y+$t):$t}else for($V=1;$V<$Q;$V++)$p[$V]=$t;var $g=this.computeWorldPositions(this.target,$I,$M,$Q,$d,"percent"==this.data.positionMode,"percent"==$n);if(this._debugKey){for($V=0;$V<$g.length;$V++)$M.drawCircle($g[$V++],$g[$V++],5,"#00ff00");var $O=[];for($V=0;$V<$g.length;$V++)$O.push($g[$V++],$g[$V++]);$M.drawLines(0,0,$O,"#ff0000")}var $a=$g[0],$m=$g[1],$j=this.data.offsetRotation,$T="chain"==$f&&0==$j,$q=NaN;for($V=0,$q=3;$V<$A;$V++,$q+=3){($N=this.bones[$V]).resultMatrix.tx+=($a-$N.resultMatrix.tx)*$E,$N.resultMatrix.ty+=($m-$N.resultMatrix.ty)*$E;var $v=($$=$g[$q])-$a,$W=($w=$g[$q+1])-$m;if($H&&0!=($y=$B[$V])){var $R=(Math.sqrt($v*$v+$W*$W)/$y-1)*$Z+1;$N.resultMatrix.a*=$R,$N.resultMatrix.c*=$R}if($a=$$,$m=$w,$i){var $z=$N.resultMatrix.a,$L=$N.resultMatrix.c,$o=$N.resultMatrix.b,$S=$N.resultMatrix.d,$X=NaN,$C=NaN,$J=NaN;$X=$d?$g[$q-1]:0==$p[$V+1]?$g[$q+2]:Math.atan2($W,$v),$X-=Math.atan2($o,$z)-$j/180*Math.PI,$T&&($C=Math.cos($X),$J=Math.sin($X),$a+=(($y=$N.length)*($C*$z-$J*$o)-$v)*$Z,$m+=($y*($J*$z+$C*$o)-$W)*$Z),$X>Math.PI?$X-=2*Math.PI:$X<-Math.PI&&($X+=2*Math.PI),$X*=$Z,$C=Math.cos($X),$J=Math.sin($X),$N.resultMatrix.a=$C*$z-$J*$o,$N.resultMatrix.c=$C*$L-$J*$S,$N.resultMatrix.b=$J*$z+$C*$o,$N.resultMatrix.d=$J*$L+$C*$S}}}},$I.computeWorldVertices2=function($I,$M,$E,$Z,$i,$n){var $c,$f,$d=$I.currDisplayData.bones,$H=$I.currDisplayData.weights,$B=$I.currDisplayData.triangles,$A=0,$Q=0,$p=0,$t=0,$V=0,$u=0,$N=0,$y=0,$$=0,$w=0,$g=0;if(null!=$d){for($A=0;$A<$E;$A+=2)$Q+=($t=$d[$Q])+1,$p+=$t;var $O=$M;for($V=$n,$u=3*$p;$V<$Z;$V+=2){for($y=$N=0,$t=$d[$Q++],$t+=$Q;$Q<$t;$Q++,$u+=3){$c=$O[$d[$Q]].resultMatrix,$$=$H[$u],$w=$H[$u+1];var $a=$H[$u+2];$N+=($$*$c.a+$w*$c.c+$c.tx)*$a,$y+=($$*$c.b+$w*$c.d+$c.ty)*$a}$i[$V]=$N,$i[$V+1]=$y}}else{var $m,$j;if($B||($B=$H),$I.deformData&&($B=$I.deformData),$m=$I.parent,$M)for($g=$M.length,$A=0;$A<$g;$A++)if($M[$A].name==$m){$f=$M[$A];break}$f&&($j=$f.resultMatrix),$j||($j=$L._tempMt);var $T=$j.tx,$q=$j.ty,$v=$j.a,$W=$j.b,$R=$j.c,$z=$j.d;for($f&&($z*=$f.d),$Q=$E,$V=$n;$V<$Z;$Q+=2,$V+=2)$$=$B[$Q],$w=$B[$Q+1],$i[$V]=$$*$v+$w*$W+$T,$i[$V+1]=-($$*$R+$w*$z+$q)}},$I.computeWorldPositions=function($I,$M,$E,$Z,$i,$n,$c){$I.currDisplayData.bones,$I.currDisplayData.weights,$I.currDisplayData.triangles;var $f=[],$d=0,$H=$I.currDisplayData.verLen,$B=this.position,$A=this._spaces,$Q=[],$p=[],$t=$H/6,$V=-1,$u=NaN,$N=0,$y=0,$$=NaN,$w=NaN,$g=NaN,$O=NaN;if($t--,$H-=4,this.computeWorldVertices2($I,$M,2,$H,$f,0),this._debugKey)for($d=0;$d<$f.length;)$E.drawCircle($f[$d++],$f[$d++],10,"#ff0000");$Q=$f,this._curves.length=$t;var $a=this._curves,$m=$Q[$u=0],$j=$Q[1],$T=0,$q=0,$v=0,$W=0,$R=0,$z=0,$L=NaN,$o=NaN,$S=NaN,$X=NaN,$C=NaN,$J=NaN,$x=NaN,$k=NaN,$r=0;for($d=0,$r=2;$d<$t;$d++,$r+=6)$T=$Q[$r],$q=$Q[$r+1],$v=$Q[$r+2],$W=$Q[$r+3],$C=2*($L=.1875*($m-2*$T+$v))+($S=.09375*(3*($T-$v)-$m+($R=$Q[$r+4]))),$J=2*($o=.1875*($j-2*$q+$W))+($X=.09375*(3*($q-$W)-$j+($z=$Q[$r+5]))),$x=.75*($T-$m)+$L+.16666667*$S,$k=.75*($q-$j)+$o+.16666667*$X,$u+=Math.sqrt($x*$x+$k*$k),$x+=$C,$k+=$J,$C+=$S,$J+=$X,$u+=Math.sqrt($x*$x+$k*$k),$x+=$C,$k+=$J,$u+=Math.sqrt($x*$x+$k*$k),$x+=$C+$S,$k+=$J+$X,$u+=Math.sqrt($x*$x+$k*$k),$a[$d]=$u,$m=$R,$j=$z;if($n&&($B*=$u),$c)for($d=0;$d<$Z;$d++)$A[$d]*=$u;var $l=this._segments,$F=0,$e=0;for($e=$y=$N=$d=0;$d<$Z;$d++,$N+=3)if(($$=$B+=$w=$A[$d])<0)this.addBeforePosition($$,$Q,0,$p,$N);else if($u<$$)this.addAfterPosition($$-$u,$Q,$H-4,$p,$N);else{for(;;$y++)if(!(($O=$a[$y])<$$)){0==$y?$$/=$O:$$=($$-($g=$a[$y-1]))/($O-$g);break}if($y!=$V){var $_=6*($V=$y);for($m=$Q[$_],$j=$Q[$_+1],$T=$Q[$_+2],$q=$Q[$_+3],$v=$Q[$_+4],$W=$Q[$_+5],$C=2*($L=.03*($m-2*$T+$v))+($S=.006*(3*($T-$v)-$m+($R=$Q[$_+6]))),$J=2*($o=.03*($j-2*$q+$W))+($X=.006*(3*($q-$W)-$j+($z=$Q[$_+7]))),$x=.3*($T-$m)+$L+.16666667*$S,$k=.3*($q-$j)+$o+.16666667*$X,$F=Math.sqrt($x*$x+$k*$k),$l[0]=$F,$_=1;$_<8;$_++)$x+=$C,$k+=$J,$C+=$S,$J+=$X,$F+=Math.sqrt($x*$x+$k*$k),$l[$_]=$F;$x+=$C,$k+=$J,$F+=Math.sqrt($x*$x+$k*$k),$l[8]=$F,$x+=$C+$S,$k+=$J+$X,$F+=Math.sqrt($x*$x+$k*$k),$l[9]=$F,$e=0}for($$*=$F;;$e++)if(!(($O=$l[$e])<$$)){0==$e?$$/=$O:$$=$e+($$-($g=$l[$e-1]))/($O-$g);break}this.addCurvePosition(.1*$$,$m,$j,$T,$q,$v,$W,$R,$z,$p,$N,$i||0<$d&&0==$w)}return $p},$I.addBeforePosition=function($I,$M,$E,$Z,$i){var $n=$M[$E],$c=$M[$E+1],$f=$M[$E+2]-$n,$d=$M[$E+3]-$c,$H=Math.atan2($d,$f);$Z[$i]=$n+$I*Math.cos($H),$Z[$i+1]=$c+$I*Math.sin($H),$Z[$i+2]=$H},$I.addAfterPosition=function($I,$M,$E,$Z,$i){var $n=$M[$E+2],$c=$M[$E+3],$f=$n-$M[$E],$d=$c-$M[$E+1],$H=Math.atan2($d,$f);$Z[$i]=$n+$I*Math.cos($H),$Z[$i+1]=$c+$I*Math.sin($H),$Z[$i+2]=$H},$I.addCurvePosition=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B,$A){0==$I&&($I=1e-4);var $Q=$I*$I,$p=$Q*$I,$t=1-$I,$V=$t*$t,$u=$V*$t,$N=$t*$I,$y=3*$N,$$=$t*$y,$w=$y*$I,$g=$M*$u+$Z*$$+$n*$w+$f*$p,$O=$E*$u+$i*$$+$c*$w+$d*$p;$H[$B]=$g,$H[$B+1]=$O,$H[$B+2]=$A?Math.atan2($O-($E*$V+$i*$N*2+$c*$Q),$g-($M*$V+$Z*$N*2+$n*$Q)):0},$L.NONE=-1,$L.BEFORE=-2,$L.AFTER=-3,$E($L,["_tempMt",function(){return this._tempMt=new $RI}]),$L}(),$rI=function(){function $I(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return $Z($I,"laya.ani.bone.PathConstraintData"),$I}(),$lI=function(){function $I(){this.name=null,this.slotArr=[]}return $Z($I,"laya.ani.bone.SkinData"),$I}(),$FI=function(){function $I(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}$Z($I,"laya.ani.bone.SkinSlotDisplayData");var $M=$I.prototype;return $M.createTexture=function($I){return this.texture||(this.texture=new $zI($I.bitmap,this.uvs),$I.bitmap.alphaTexture&&(this.texture.alphaTexture=new $zI($I.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=$I.height,this.texture.height=$I.width,this.texture.offsetX=-$I.offsetX,this.texture.offsetY=-$I.offsetY,this.texture.sourceWidth=$I.sourceHeight,this.texture.sourceHeight=$I.sourceWidth):(this.texture.width=$I.width,this.texture.height=$I.height,this.texture.offsetX=-$I.offsetX,this.texture.offsetY=-$I.offsetY,this.texture.sourceWidth=$I.sourceWidth,this.texture.sourceHeight=$I.sourceHeight),$u.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},$M.destory=function(){this.texture&&this.texture.destroy()},$I}(),$eI=function(){function $I(){this.name=null,this.displayArr=[]}return $Z($I,"laya.ani.bone.SlotData"),$I.prototype.getDisplayByName=function($I){for(var $M=0,$E=this.displayArr.length;$M<$E;$M++)if(this.displayArr[$M].attachmentName==$I)return $M;return-1},$I}(),$O=function(){function $I($I,$M){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=$V(2,0),this._data=$I,null==this._bones&&(this._bones=[]),this.target=$M[$I.targetIndex];var $E,$Z=0;for($Z=0,$E=$I.boneIndexs.length;$Z<$E;$Z++)this._bones.push($M[$I.boneIndexs[$Z]]);this.rotateMix=$I.rotateMix,this.translateMix=$I.translateMix,this.scaleMix=$I.scaleMix,this.shearMix=$I.shearMix}return $Z($I,"laya.ani.bone.TfConstraint"),$I.prototype.apply=function(){for(var $I,$M=this.target.resultMatrix.a,$E=this.target.resultMatrix.b,$Z=this.target.resultMatrix.c,$i=this.target.resultMatrix.d,$n=0,$c=this._bones.length;$n<$c;$n++){if($I=this._bones[$n],0<this.rotateMix){var $f=$I.resultMatrix.a,$d=$I.resultMatrix.b,$H=$I.resultMatrix.c,$B=$I.resultMatrix.d,$A=Math.atan2($Z,$M)-Math.atan2($H,$f)+this._data.offsetRotation*Math.PI/180;$A>Math.PI?$A-=2*Math.PI:$A<-Math.PI&&($A+=2*Math.PI),$A*=this.rotateMix;var $Q=Math.cos($A),$p=Math.sin($A);$I.resultMatrix.a=$Q*$f-$p*$H,$I.resultMatrix.b=$Q*$d-$p*$B,$I.resultMatrix.c=$p*$f+$Q*$H,$I.resultMatrix.d=$p*$d+$Q*$B}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),$I.resultMatrix.tx+=(this._temp[0]-$I.resultMatrix.tx)*this.translateMix,$I.resultMatrix.ty+=(this._temp[1]-$I.resultMatrix.ty)*this.translateMix,$I.updateChild()),0<this.scaleMix){var $t=Math.sqrt($I.resultMatrix.a*$I.resultMatrix.a+$I.resultMatrix.c*$I.resultMatrix.c),$V=Math.sqrt($M*$M+$Z*$Z),$u=1e-5<$t?($t+($V-$t+this._data.offsetScaleX)*this.scaleMix)/$t:0;$I.resultMatrix.a*=$u,$I.resultMatrix.c*=$u,$t=Math.sqrt($I.resultMatrix.b*$I.resultMatrix.b+$I.resultMatrix.d*$I.resultMatrix.d),$V=Math.sqrt($E*$E+$i*$i),$u=1e-5<$t?($t+($V-$t+this._data.offsetScaleY)*this.scaleMix)/$t:0,$I.resultMatrix.b*=$u,$I.resultMatrix.d*=$u}if(0<this.shearMix){$d=$I.resultMatrix.b,$B=$I.resultMatrix.d;var $N=Math.atan2($B,$d);($A=Math.atan2($i,$E)-Math.atan2($Z,$M)-($N-Math.atan2($I.resultMatrix.c,$I.resultMatrix.a)))>Math.PI?$A-=2*Math.PI:$A<-Math.PI&&($A+=2*Math.PI),$A=$N+($A+this._data.offsetShearY*Math.PI/180)*this.shearMix,$u=Math.sqrt($d*$d+$B*$B),$I.resultMatrix.b=Math.cos($A)*$u,$I.resultMatrix.d=Math.sin($A)*$u}}},$I}(),$_I=function(){function $I(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return $Z($I,"laya.ani.bone.TfConstraintData"),$I}(),$hI=function(){function $I(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}$Z($I,"laya.ani.bone.Transform");var $M=$I.prototype;return $M.initData=function($I){null!=$I.x&&(this.x=$I.x),null!=$I.y&&(this.y=$I.y),null!=$I.skX&&(this.skX=$I.skX),null!=$I.skY&&(this.skY=$I.skY),null!=$I.scX&&(this.scX=$I.scX),null!=$I.scY&&(this.scY=$I.scY)},$M.getMatrix=function(){var $I;return($I=this.mMatrix?this.mMatrix:this.mMatrix=new $RI).identity(),$I.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew($I,this.skewX*Math.PI/180,this.skewY*Math.PI/180),$I.rotate(this.skX*Math.PI/180),$I.translate(this.x,this.y),$I},$M.skew=function($I,$M,$E){var $Z=Math.sin($E),$i=Math.cos($E),$n=Math.sin($M),$c=Math.cos($M);return $I.setTo($I.a*$c-$I.b*$Z,$I.a*$n+$I.b*$i,$I.c*$c-$I.d*$Z,$I.c*$n+$I.d*$i,$I.tx*$c-$I.ty*$Z,$I.tx*$n+$I.ty*$i),$I},$I}(),$a=function(){function $I(){}return $Z($I,"laya.ani.bone.UVTools"),$I.getRelativeUV=function($I,$M,$E){var $Z=$I[0],$i=$I[2]-$I[0],$n=$I[1],$c=$I[5]-$I[1];$E||($E=[]),$E.length=$M.length;var $f,$d=0;$f=$E.length;var $H=1/$i,$B=1/$c;for($d=0;$d<$f;$d+=2)$E[$d]=($M[$d]-$Z)*$H,$E[$d+1]=($M[$d+1]-$n)*$B;return $E},$I.getAbsoluteUV=function($I,$M,$E){if(0==$I[0]&&0==$I[1]&&1==$I[4]&&1==$I[5])return $E?($N.copyArray($E,$M),$E):$M;var $Z=$I[0],$i=$I[2]-$I[0],$n=$I[1],$c=$I[5]-$I[1];$E||($E=[]),$E.length=$M.length;var $f,$d=0;for($f=$E.length,$d=0;$d<$f;$d+=2)$E[$d]=$M[$d]*$i+$Z,$E[$d+1]=$M[$d+1]*$c+$n;return $E},$I}(),$L=function(){function $I(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return $Z($I,"laya.ani.KeyFramesContent"),$I}(),$m=function(){function $B(){}return $Z($B,"laya.ani.math.BezierLerp"),$B.getBezierRate=function($I,$M,$E,$Z,$i){var $n=$B._getBezierParamKey($M,$E,$Z,$i),$c=100*$n+$I;if($B._bezierResultCache[$c])return $B._bezierResultCache[$c];var $f,$d=$B._getBezierPoints($M,$E,$Z,$i,$n),$H=0;for($f=$d.length,$H=0;$H<$f;$H+=2)if($I<=$d[$H])return $B._bezierResultCache[$c]=$d[$H+1],$d[$H+1];return $B._bezierResultCache[$c]=1},$B._getBezierParamKey=function($I,$M,$E,$Z){return 100*(100*(100*(100*$I+$M)+$E)+$Z)},$B._getBezierPoints=function($I,$M,$E,$Z,$i){return $B._bezierPointsCache[$i]?$B._bezierPointsCache[$i]:($n=[0,0,$I,$M,$E,$Z,1,1],$c=(new $f).getBezierPoints($n,100,3),$B._bezierPointsCache[$i]=$c);var $n,$c},$B._bezierResultCache={},$B._bezierPointsCache={},$B}(),$j=function($I){function $M(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,$M.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}$Z($M,"laya.ani.AnimationPlayer",$i);var $E=$M.prototype;return $iI.imps($E,{"laya.resource.IDestroy":!0}),$E._onTempletLoadedComputeFullKeyframeIndices=function($I,$M,$E){this._templet===$E&&this._cachePlayRate===$I&&this._cacheFrameRate===$M&&this._computeFullKeyframeIndices()},$E._computeFullKeyframeIndices=function(){for(var $I=this._fullFrames=[],$M=this._templet,$E=this._cacheFrameRateInterval*this._cachePlayRate,$Z=0,$i=$M.getAnimationCount();$Z<$i;$Z++){for(var $n=[],$c=0,$f=$M.getAnimation($Z).nodes.length;$c<$f;$c++){for(var $d=$M.getAnimation($Z).nodes[$c],$H=Math.floor($d.playTime/$E+.01),$B=new Uint16Array($H+1),$A=-1,$Q=0,$p=$d.keyFrame.length;$Q<$p;$Q++){var $t=$d.keyFrame[$Q],$V=$t.startTime,$u=$V+$t.duration+$E;do{for(var $N=Math.floor($V/$E+.5),$y=$A+1;$y<$N;$y++)$B[$y]=$Q;$B[$A=$N]=$Q,$V+=$E}while($V<=$u)}$n.push($B)}$I.push($n)}},$E._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},$E._calculatePlayDuration=function(){if(0!==this.state){var $I=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=$I),this._playEnd>$I&&(this._playEnd=$I),this._playDuration=this._playEnd-this._playStart}},$E._setPlayParams=function($I,$M){this._currentTime=$I,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$M+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$M},$E._setPlayParamsWhenStop=function($I,$M){this._currentTime=$I,this._currentKeyframeIndex=Math.max(Math.floor($I/$M+.01),0),this._currentFrameTime=this._currentKeyframeIndex*$M,this._currentAnimationClipIndex=-1},$E._update=function($I){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var $M=this._cacheFrameRateInterval*this._cachePlayRate,$E=0;this._startUpdateLoopCount!==$t.loopCount&&($E=$I*this.playbackRate,this._elapsedPlaybackTime+=$E);var $Z=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=$Z)return this._setPlayParamsWhenStop($Z,$M),void this.event("stopped");if($E+=this._currentTime,0<$Z)if($Z<=$E)do{if($E-=$Z,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($Z,$M),this._stopWhenCircleFinish=!1,void this.event("stopped");$E<$Z&&(this._setPlayParams($E,$M),this.event("complete"))}while($Z<=$E);else this._setPlayParams($E,$M);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop($Z,$M),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},$E._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},$E.play=function($I,$M,$E,$Z,$i){if(void 0===$I&&($I=0),void 0===$M&&($M=1),void 0===$E&&($E=2147483647),void 0===$Z&&($Z=0),void 0===$i&&($i=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if($E<0||$Z<0||$i<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==$i&&$i<$Z)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=$M,this._overallDuration=$E,this._playStart=$Z,this._playEnd=$i,this._paused=!1,this._currentAnimationClipIndex=$I,this._currentKeyframeIndex=0,this._startUpdateLoopCount=$t.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},$E.playByFrame=function($I,$M,$E,$Z,$i,$n){void 0===$I&&($I=0),void 0===$M&&($M=1),void 0===$E&&($E=2147483647),void 0===$Z&&($Z=0),void 0===$i&&($i=0),void 0===$n&&($n=30);var $c=1e3/$n;this.play($I,$M,$E,$Z*$c,$i*$c)},$E.stop=function($I){void 0===$I&&($I=!0),$I?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},$n(0,$E,"playEnd",function(){return this._playEnd}),$n(0,$E,"templet",function(){return this._templet},function($I){0===!this.state&&this.stop(!0),this._templet!==$I&&((this._templet=$I).loaded?this._computeFullKeyframeIndices():$I.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),$n(0,$E,"playStart",function(){return this._playStart}),$n(0,$E,"playDuration",function(){return this._playDuration}),$n(0,$E,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),$n(0,$E,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),$n(0,$E,"overallDuration",function(){return this._overallDuration}),$n(0,$E,"currentFrameTime",function(){return this._currentFrameTime}),$n(0,$E,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),$n(0,$E,"currentPlayTime",function(){return this._currentTime+this._playStart}),$n(0,$E,"cachePlayRate",function(){return this._cachePlayRate},function($I){this._cachePlayRate!==$I&&(this._cachePlayRate=$I,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[$I,this._cacheFrameRate])))}),$n(0,$E,"cacheFrameRate",function(){return this._cacheFrameRate},function($I){this._cacheFrameRate!==$I&&(this._cacheFrameRate=$I,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,$I])))}),$n(0,$E,"currentTime",null,function($I){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if($I<this._playStart||$I>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=$t.loopCount;var $M=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=$I,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/$M),0),this._currentFrameTime=this._currentKeyframeIndex*$M}}),$n(0,$E,"paused",function(){return this._paused},function($I){(this._paused=$I)&&this.event("paused")}),$n(0,$E,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),$n(0,$E,"destroyed",function(){return this._destroyed}),$M}(),$o=function($I){function $M(){$M.__super.call(this),$u.isConchNode&&(this.drawSkin=function($I){$I.transform||($I.transform=$RI.EMPTY),this._addCmd([$I]),this.setSkinMesh&&this.setSkinMesh($I._ps,$I.mVBData,$I.mEleNum,0,$I.mTexture,$I.transform)})}return $Z($M,"laya.ani.GraphicsAni",$c),$M.prototype.drawSkin=function($I){var $M=[$I];this._saveToCmd($u._context._drawSkin,$M)},$M.create=function(){return $M._caches.pop()||new $M},$M.recycle=function($I){$I.clear(),$M._caches.push($I)},$M._caches=[],$M}(),$S=function($I){function $y(){this._aniMap={},this.unfixedLastAniIndex=-1,$y.__super.call(this),this._anis=new Array}$Z($y,"laya.ani.AnimationTemplet",$B);var $M=$y.prototype;return $M.parse=function($I){var $M=new $WI($I);this._aniVersion=$M.readUTFString(),$$.parse(this,$M)},$M._calculateKeyFrame=function($I,$M,$E){var $Z=$I.keyFrame;$Z[$M]=$Z[0];for(var $i=0;$i<$M;$i++){var $n=$Z[$i];$n.nextData=0===$n.duration?$n.data:$Z[$i+1].data}$Z.length--},$M.onAsynLoaded=function($I,$M,$E){var $Z=new $WI($M);switch(this._aniVersion=$Z.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":$w.parse(this,$Z);break;default:$$.parse(this,$Z)}this._endLoaded()},$M.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},$M.getAnimationCount=function(){return this._anis.length},$M.getAnimation=function($I){return this._anis[$I]},$M.getAniDuration=function($I){return this._anis[$I].playTime},$M.getNodes=function($I){return this._anis[$I].nodes},$M.getNodeIndexWithName=function($I,$M){return this._anis[$I].bone3DMap[$M]},$M.getNodeCount=function($I){return this._anis[$I].nodes.length},$M.getTotalkeyframesLength=function($I){return this._anis[$I].totalKeyframeDatasLength},$M.getPublicExtData=function(){return this._publicExtData},$M.getAnimationDataWithCache=function($I,$M,$E,$Z){var $i=$M[$E];if($i){var $n=$i[$I];return $n?$n[$Z]:null}return null},$M.setAnimationDataWithCache=function($I,$M,$E,$Z,$i){var $n=$M[$E]||($M[$E]={});($n[$I]||($n[$I]=[]))[$Z]=$i},$M.getOriginalData=function($I,$M,$E,$Z,$i){for(var $n=this._anis[$I].nodes,$c=0,$f=0,$d=$n.length,$H=0;$f<$d;$f++){var $B,$A=$n[$f];$B=$A.keyFrame[$E[$f][$Z]],$A.dataOffset=$H;var $Q=$i-$B.startTime,$p=$A.lerpType;if($p)switch($p){case 0:case 1:for($c=0;$c<$A.keyframeWidth;)$c+=$A.interpolationMethod[$c]($A,$c,$M,$H+$c,$B.data,$Q,null,$B.duration,$B.nextData);break;case 2:var $t=$B.interpolationData,$V=$t.length,$u=0;for($c=0;$c<$V;){var $N=$t[$c];switch($N){case 6:case 7:$c+=$y.interpolation[$N]($A,$u,$M,$H+$u,$B.data,$Q,null,$B.duration,$B.nextData,$t,$c+1);break;default:$c+=$y.interpolation[$N]($A,$u,$M,$H+$u,$B.data,$Q,null,$B.duration,$B.nextData)}$u++}}else for($c=0;$c<$A.keyframeWidth;)$c+=$A.interpolationMethod[$c]($A,$c,$M,$H+$c,$B.data,$Q,null,$B.duration,$B.nextData);$H+=$A.keyframeWidth}},$M.getNodesCurrentFrameIndex=function($I,$M){var $E=this._anis[$I].nodes;$I!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($E.length),this.unfixedCurrentTimes=new Float32Array($E.length),this.unfixedLastAniIndex=$I);for(var $Z=0,$i=$E.length;$Z<$i;$Z++){var $n=$E[$Z];for($M<this.unfixedCurrentTimes[$Z]&&(this.unfixedCurrentFrameIndexes[$Z]=0),this.unfixedCurrentTimes[$Z]=$M;this.unfixedCurrentFrameIndexes[$Z]<$n.keyFrame.length&&!($n.keyFrame[this.unfixedCurrentFrameIndexes[$Z]].startTime>this.unfixedCurrentTimes[$Z]);)this.unfixedCurrentFrameIndexes[$Z]++;this.unfixedCurrentFrameIndexes[$Z]--}return this.unfixedCurrentFrameIndexes},$M.getOriginalDataUnfixedRate=function($I,$M,$E){var $Z=this._anis[$I].nodes;$I!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array($Z.length),this.unfixedCurrentTimes=new Float32Array($Z.length),this.unfixedKeyframes=$V($Z.length),this.unfixedLastAniIndex=$I);for(var $i=0,$n=0,$c=$Z.length,$f=0;$n<$c;$n++){var $d=$Z[$n];for($E<this.unfixedCurrentTimes[$n]&&(this.unfixedCurrentFrameIndexes[$n]=0),this.unfixedCurrentTimes[$n]=$E;this.unfixedCurrentFrameIndexes[$n]<$d.keyFrame.length&&!($d.keyFrame[this.unfixedCurrentFrameIndexes[$n]].startTime>this.unfixedCurrentTimes[$n]);)this.unfixedKeyframes[$n]=$d.keyFrame[this.unfixedCurrentFrameIndexes[$n]],this.unfixedCurrentFrameIndexes[$n]++;var $H=this.unfixedKeyframes[$n];$d.dataOffset=$f;var $B=$E-$H.startTime;if($d.lerpType)switch($d.lerpType){case 0:case 1:for($i=0;$i<$d.keyframeWidth;)$i+=$d.interpolationMethod[$i]($d,$i,$M,$f+$i,$H.data,$B,null,$H.duration,$H.nextData);break;case 2:var $A=$H.interpolationData,$Q=$A.length,$p=0;for($i=0;$i<$Q;){var $t=$A[$i];switch($t){case 6:case 7:$i+=$y.interpolation[$t]($d,$p,$M,$f+$p,$H.data,$B,null,$H.duration,$H.nextData,$A,$i+1);break;default:$i+=$y.interpolation[$t]($d,$p,$M,$f+$p,$H.data,$B,null,$H.duration,$H.nextData)}$p++}}else for($i=0;$i<$d.keyframeWidth;)$i+=$d.interpolationMethod[$i]($d,$i,$M,$f+$i,$H.data,$B,null,$H.duration,$H.nextData);$f+=$d.keyframeWidth}},$y._LinearInterpolation_0=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){var $B=0===$f?0:$n/$f;return $E[$Z]=(1-$B)*$i[$M]+$B*$d[$M],1},$y._QuaternionInterpolation_1=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){var $B=0===$f?0:$n/$f;return $Q.slerpQuaternionArray($i,$M,$d,$M,$B,$E,$Z),4},$y._AngleInterpolation_2=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){return 0},$y._RadiansInterpolation_3=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){return 0},$y._Matrix4x4Interpolation_4=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){for(var $B=0;$B<16;$B++,$M++)$E[$Z+$B]=$i[$M]+$n*$c[$M];return 16},$y._NoInterpolation_5=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H){return $E[$Z]=$i[$M],1},$y._BezierInterpolation_6=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B){return void 0===$B&&($B=0),$E[$Z]=$i[$M]+($d[$M]-$i[$M])*$m.getBezierRate($n/$f,$H[$B],$H[$B+1],$H[$B+2],$H[$B+3]),5},$y._BezierInterpolation_7=function($I,$M,$E,$Z,$i,$n,$c,$f,$d,$H,$B){return void 0===$B&&($B=0),$E[$Z]=$H[$B+4]+$H[$B+5]*$m.getBezierRate((.001*$n+$H[$B+6])/$H[$B+7],$H[$B],$H[$B+1],$H[$B+2],$H[$B+3]),9},$y.load=function($I){return $iI.loader.create($I,null,null,$y)},$y.interpolation=[$y._LinearInterpolation_0,$y._QuaternionInterpolation_1,$y._AngleInterpolation_2,$y._RadiansInterpolation_3,$y._Matrix4x4Interpolation_4,$y._NoInterpolation_5,$y._BezierInterpolation_6,$y._BezierInterpolation_7],$y}(),$T=function($M){function $E($I,$M){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,$E.__super.call(this),void 0===$M&&($M=0),$I&&this.init($I,$M)}$Z($E,"laya.ani.bone.Skeleton",$M);var $I=$E.prototype;return $I.init=function($I,$M){void 0===$M&&($M=0);var $E,$Z,$i,$n=0,$c=0;if(1==$M)for(this._graphicsCache=[],$n=0,$c=$I.getAnimationCount();$n<$c;$n++)this._graphicsCache.push([]);if(this._yReverseMatrix=$I.yReverseMatrix,this._aniMode=$M,this._templet=$I,this._player=new $j,this._player.cacheFrameRate=$I.rate,this._player.templet=$I,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=$I.mBoneArr,this._rootBone=$I.mRootBone,this._aniSectionDic=$I.aniSectionDic,0<$I.ikArr.length)for(this._ikArr=[],$n=0,$c=$I.ikArr.length;$n<$c;$n++)this._ikArr.push(new $y($I.ikArr[$n],this._boneList));if(0<$I.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),$n=0,$c=$I.pathArr.length;$n<$c;$n++)$E=$I.pathArr[$n],$Z=new $g($E,this._boneList),($i=this._boneSlotDic[$E.name])&&(($Z=new $g($E,this._boneList)).target=$i),this._pathDic[$E.name]=$Z;if(0<$I.tfArr.length)for(this._tfArr=[],$n=0,$c=$I.tfArr.length;$n<$c;$n++)this._tfArr.push(new $O($I.tfArr[$n],this._boneList));if(0<$I.skinDataArray.length){var $f=this._templet.skinDataArray[this._skinIndex];this._skinName=$f.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},$I.load=function($I,$M,$E){},$I._onLoaded=function(){},$I._parseComplete=function(){var $I=$q.TEMPLET_DICTIONARY[this._aniPath];$I&&(this.init($I,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},$I._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},$I._onPlay=function(){this.event("played")},$I._onStop=function(){var $I,$M=this._templet.eventAniArr[this._aniClipIndex];if($M&&this._eventIndex<$M.length)for(;this._eventIndex<$M.length;this._eventIndex++)($I=$M[this._eventIndex]).time>=this._player.playStart&&$I.time<=this._player.playEnd&&this.event("label",$I);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},$I._onPause=function(){this.event("paused")},$I._parseSrcBoneMatrix=function(){var $I=0,$M=0;for($M=this._templet.srcBoneMatrixArr.length,$I=0;$I<$M;$I++)this._boneMatrixArray.push(new $RI);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var $E,$Z,$i=this._templet.boneSlotArray;for($I=0,$M=$i.length;$I<$M;$I++)$E=$i[$I],null==($Z=this._bindBoneBoneSlotDic[$E.parent])&&(this._bindBoneBoneSlotDic[$E.parent]=$Z=[]),this._boneSlotDic[$E.name]=$E=$E.copy(),$Z.push($E),this._boneSlotArray.push($E)}},$I._emitMissedEvents=function($I,$M,$E){void 0===$E&&($E=0);var $Z=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if($Z){var $i,$n,$c=0;for($i=$Z.length,$c=$E;$c<$i;$c++)($n=$Z[$c]).time>=this._player.playStart&&$n.time<=this._player.playEnd&&this.event("label",$n)}},$I._update=function($I){if(void 0===$I&&($I=!0),!(this._pause||$I&&this._indexControl)){var $M=this.timer.currTimer,$E=this._player.currentKeyframeIndex,$Z=$M-this._lastTime;if($I?this._player._update($Z):$E=-1,this._lastTime=$M,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<$Z&&this._clipIndex==$E&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var $i;this._lastUpdateAniClipIndex=this._aniClipIndex,$E>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var $n,$c=this._templet.eventAniArr[this._aniClipIndex];if($c&&this._eventIndex<$c.length&&(($i=$c[this._eventIndex]).time>=this._player.playStart&&$i.time<=this._player.playEnd?this._player.currentPlayTime>=$i.time&&(this.event("label",$i),this._eventIndex++):this._eventIndex++),0==this._aniMode){if($n=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$n&&(this.graphics=$n));var $f=0,$d=0;for($d=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,$d-1)&&0<$d;)$d--;if($d<this._clipIndex)for($f=$d;$f<this._clipIndex;$f++)this._createGraphics($f)}else if(1==this._aniMode){if($n=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=$n&&(this.graphics=$n));for($d=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,$d-1)&&0<$d;)$d--;if($d<this._clipIndex)for($f=$d;$f<this._clipIndex;$f++)this._createGraphics($f)}this._createGraphics()}}},$I._createGraphics=function($I){void 0===$I&&($I=-1),-1==$I&&($I=this._clipIndex);var $M,$E,$Z=$I*this._player.cacheFrameRateInterval,$i=this._templet.drawOrderAniArr[this._aniClipIndex];if($i&&0<$i.length)for(this._drawOrderIndex=0,$M=$i[this._drawOrderIndex];$Z>=$M.time&&(this._drawOrder=$M.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=$i.length));)$M=$i[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=$o.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=$o.create(),$E=this.graphics;var $n=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],$I,$Z);var $c,$f,$d,$H,$B=this._aniSectionDic[this._aniClipIndex],$A=0,$Q=0,$p=0,$t=0,$V=0,$u=this._templet.srcBoneMatrixArr.length;for($V=$B[$Q=0];$Q<$u;$Q++)$H=this._boneList[$Q],$d=this._templet.srcBoneMatrixArr[$Q],$H.resultTransform.scX=$d.scX*this._curOriginalData[$A++],$H.resultTransform.skX=$d.skX+this._curOriginalData[$A++],$H.resultTransform.skY=$d.skY+this._curOriginalData[$A++],$H.resultTransform.scY=$d.scY*this._curOriginalData[$A++],$H.resultTransform.x=$d.x+this._curOriginalData[$A++],$H.resultTransform.y=$d.y+this._curOriginalData[$A++],8===this._templet.tMatrixDataLen&&($H.resultTransform.skewX=$d.skewX+this._curOriginalData[$A++],$H.resultTransform.skewY=$d.skewY+this._curOriginalData[$A++]);var $N,$y={},$$={};for($V+=$B[1];$Q<$V;$Q++)$y[($N=$n[$Q]).name]=this._curOriginalData[$A++],$$[$N.name]=this._curOriginalData[$A++],this._curOriginalData[$A++],this._curOriginalData[$A++],this._curOriginalData[$A++],this._curOriginalData[$A++];var $w,$g,$O={},$a={};for($V+=$B[2];$Q<$V;$Q++)$O[($N=$n[$Q]).name]=this._curOriginalData[$A++],$a[$N.name]=this._curOriginalData[$A++],this._curOriginalData[$A++],this._curOriginalData[$A++],this._curOriginalData[$A++],this._curOriginalData[$A++];if(this._pathDic)for($V+=$B[3];$Q<$V;$Q++){if($N=$n[$Q],$w=this._pathDic[$N.name])switch(new $WI($N.extenData).getByte()){case 1:$w.position=this._curOriginalData[$A++];break;case 2:$w.spacing=this._curOriginalData[$A++];break;case 3:$w.rotateMix=this._curOriginalData[$A++],$w.translateMix=this._curOriginalData[$A++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update($RI.TEMP.identity()),this._ikArr)for($Q=0,$V=this._ikArr.length;$Q<$V;$Q++)$g=this._ikArr[$Q],$O.hasOwnProperty($g.name)&&($g.bendDirection=$O[$g.name]),$a.hasOwnProperty($g.name)&&($g.mix=$a[$g.name]),$g.apply();if(this._pathDic)for(var $m in this._pathDic)($w=this._pathDic[$m]).apply(this._boneList,$E);if(this._tfArr)for($Q=0,$t=this._tfArr.length;$Q<$t;$Q++)this._tfArr[$Q].apply();for($Q=0,$t=this._boneList.length;$Q<$t;$Q++)if($H=this._boneList[$Q],$f=this._bindBoneBoneSlotDic[$H.name],$H.resultMatrix.copyTo(this._boneMatrixArray[$Q]),$f)for($p=0,$V=$f.length;$p<$V;$p++)($c=$f[$p])&&$c.setParentMatrix($H.resultMatrix);var $j,$T,$q,$v,$W={},$R=this._templet.deformAniArr;if($R&&0<$R.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,$Q=0,$V=this._boneSlotArray.length;$Q<$V;$Q++)($c=this._boneSlotArray[$Q]).deformData=null;var $z,$L=$R[this._aniClipIndex];for($z in $j=$L.default,this._setDeform($j,$W,this._boneSlotArray,$Z),$L)"default"!=$z&&$z!=this._skinName&&($j=$L[$z],this._setDeform($j,$W,this._boneSlotArray,$Z));$j=$L[this._skinName],this._setDeform($j,$W,this._boneSlotArray,$Z)}if(this._drawOrder)for($Q=0,$V=this._drawOrder.length;$Q<$V;$Q++)$T=$y[($c=this._boneSlotArray[this._drawOrder[$Q]]).name],$q=$$[$c.name],isNaN($q)||($E.save(),$E.alpha($q)),isNaN($T)||-2==$T||(this._templet.attachmentNames?$c.showDisplayByName(this._templet.attachmentNames[$T]):$c.showDisplayByIndex($T)),$W[this._drawOrder[$Q]]?($v=$W[this._drawOrder[$Q]],$c.currDisplayData&&$v[$c.currDisplayData.attachmentName]?$c.deformData=$v[$c.currDisplayData.attachmentName]:$c.deformData=null):$c.deformData=null,isNaN($q)?$c.draw($E,this._boneMatrixArray,2==this._aniMode):$c.draw($E,this._boneMatrixArray,2==this._aniMode,$q),isNaN($q)||$E.restore();else for($Q=0,$V=this._boneSlotArray.length;$Q<$V;$Q++)$T=$y[($c=this._boneSlotArray[$Q]).name],$q=$$[$c.name],isNaN($q)||($E.save(),$E.alpha($q)),isNaN($T)||-2==$T||(this._templet.attachmentNames?$c.showDisplayByName(this._templet.attachmentNames[$T]):$c.showDisplayByIndex($T)),$W[$Q]?($v=$W[$Q],$c.currDisplayData&&$v[$c.currDisplayData.attachmentName]?$c.deformData=$v[$c.currDisplayData.attachmentName]:$c.deformData=null):$c.deformData=null,isNaN($q)?$c.draw($E,this._boneMatrixArray,2==this._aniMode):$c.draw($E,this._boneMatrixArray,2==this._aniMode,$q),isNaN($q)||$E.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,$I,$E):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,$I,$E)},$I._setDeform=function($I,$M,$E,$Z){if($I){var $i,$n,$c,$f=0,$d=0,$H=0;if($I)for($f=0,$d=$I.deformSlotDataList.length;$f<$d;$f++)for($i=$I.deformSlotDataList[$f],$H=0;$H<$i.deformSlotDisplayList.length;$H++)$c=$E[($n=$i.deformSlotDisplayList[$H]).slotIndex],$n.apply($Z,$c),$M[$n.slotIndex]||($M[$n.slotIndex]={}),$M[$n.slotIndex][$n.attachment]=$n.deformData}},$I.getAnimNum=function(){return this._templet.getAnimationCount()},$I.getAniNameByIndex=function($I){return this._templet.getAniNameByIndex($I)},$I.getSlotByName=function($I){return this._boneSlotDic[$I]},$I.showSkinByName=function($I,$M){void 0===$M&&($M=!0),this.showSkinByIndex(this._templet.getSkinIndexByName($I),$M)},$I.showSkinByIndex=function($I,$M){void 0===$M&&($M=!0);for(var $E=0;$E<this._boneSlotArray.length;$E++)this._boneSlotArray[$E].showSlotData(null,$M);if(this._templet.showSkinByIndex(this._boneSlotDic,$I,$M)){var $Z=this._templet.skinDataArray[$I];this._skinIndex=$I,this._skinName=$Z.name}this._clearCache()},$I.showSlotSkinByIndex=function($I,$M){if(0!=this._aniMode){var $E=this.getSlotByName($I);$E&&$E.showDisplayByIndex($M),this._clearCache()}},$I.showSlotSkinByName=function($I,$M){if(0!=this._aniMode){var $E=this.getSlotByName($I);$E&&$E.showDisplayByName($M),this._clearCache()}},$I.replaceSlotSkinName=function($I,$M,$E){if(0!=this._aniMode){var $Z=this.getSlotByName($I);$Z&&$Z.replaceDisplayByName($M,$E),this._clearCache()}},$I.replaceSlotSkinByIndex=function($I,$M,$E){if(0!=this._aniMode){var $Z=this.getSlotByName($I);$Z&&$Z.replaceDisplayByIndex($M,$E),this._clearCache()}},$I.setSlotSkin=function($I,$M){if(0!=this._aniMode){var $E=this.getSlotByName($I);$E&&$E.replaceSkin($M),this._clearCache()}},$I._clearCache=function(){if(1==this._aniMode)for(var $I=0,$M=this._graphicsCache.length;$I<$M;$I++){for(var $E=0,$Z=this._graphicsCache[$I].length;$E<$Z;$E++){var $i=this._graphicsCache[$I][$E];$i!=this.graphics&&$o.recycle($i)}this._graphicsCache[$I].length=0}},$I.play=function($I,$M,$E,$Z,$i,$n){void 0===$E&&($E=!0),void 0===$Z&&($Z=0),void 0===$i&&($i=0),void 0===$n&&($n=!0),this._indexControl=!1;var $c=-1,$f=NaN;if($f=$M?2147483647:0,"string"==typeof $I)for(var $d=0,$H=this._templet.getAnimationCount();$d<$H;$d++){var $B=this._templet.getAnimation($d);if($B&&$I==$B.name){$c=$d;break}}else $c=$I;-1<$c&&$c<this.getAnimNum()&&(this._aniClipIndex=$c,($E||this._pause||this._currAniIndex!=$c)&&(this._currAniIndex=$c,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength($c)),this._drawOrder=null,this._eventIndex=0,this._player.play($c,this._player.playbackRate,$f,$Z,$i),$n&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=$A.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},$I.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},$I.playbackRate=function($I){this._player&&(this._player.playbackRate=$I)},$I.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},$I.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=$A.now(),this.timer.frameLoop(1,this,this._update,null,!0))},$I._getGrahicsDataWithCache=function($I,$M){return this._graphicsCache[$I][$M]},$I._setGrahicsDataWithCache=function($I,$M,$E){this._graphicsCache[$I][$M]=$E},$I.destroy=function($I){void 0===$I&&($I=!0),$M.prototype.destroy.call(this,$I),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},$n(0,$I,"url",function(){return this._aniPath},function($I){this.load($I)}),$n(0,$I,"index",function(){return this._index},function($I){this.player&&(this._index=$I,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),$n(0,$I,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),$n(0,$I,"templet",function(){return this._templet}),$n(0,$I,"player",function(){return this._player}),$E.useSimpleMeshInCanvas=!1,$E}($nI),$q=function($M){function $i(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,$i.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}$Z($i,"laya.ani.bone.Templet",$M);var $I=$i.prototype;return $I.getLoadList=function(){return this._loadList},$I.loadAni=function($I){this._skBufferUrl=$I,$iI.loader.load($I,$d.create(this,this.onComplete),null,"arraybuffer")},$I.onComplete=function($I){if(this._isDestroyed)this.destroy();else{var $M=$H.getRes(this._skBufferUrl);$M?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,$M)):this.event("error","load failed:"+this._skBufferUrl)}},$I.parseData=function($I,$M,$E){void 0===$E&&($E=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=$I,this._mainTexture&&$u.isWebGL&&$I.bitmap&&($I.bitmap.enableMerageInAtlas=!1),this._rate=$E,this.parse($M)},$I.buildArmature=function($I){return void 0===$I&&($I=0),new $T(this,$I)},$I.parse=function($I){$M.prototype.parse.call(this,$I),this._endLoaded(),this._aniVersion!=$i.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+$i.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},$I._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var $I=0;this._loadList=[];var $M,$E=new $WI(this.getPublicExtData()),$Z=0,$i=0,$n=0,$c=$E.getInt32(),$f=$E.readUTFString(),$d=$f.split("\n");for($I=0;$I<$c;$I++)$M=this._path+$d[2*$I],$f=$d[2*$I+1],$E.getFloat32(),$E.getFloat32(),$Z=$E.getFloat32(),$i=$E.getFloat32(),$n=$E.getFloat32(),isNaN($n)?0:$n,$n=$E.getFloat32(),isNaN($n)?0:$n,$n=$E.getFloat32(),isNaN($n)?$Z:$n,$n=$E.getFloat32(),isNaN($n)?$i:$n,-1==this._loadList.indexOf($M)&&this._loadList.push($M);this.event("inited",this)}},$I._textureComplete=function(){for(var $I,$M,$E=0,$Z=this._loadList.length;$E<$Z;$E++)$M=this._loadList[$E],$I=this._textureDic[$M]=$H.getRes($M),$u.isWebGL&&$I&&$I.bitmap&&($I.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},$I._parsePublicExtData=function(){var $I=0,$M=0,$E=0,$Z=0,$i=0;for($I=0,$i=this.getAnimationCount();$I<$i;$I++)this._graphicsCache.push([]);var $n;$n="Dragon"!=this._aniClassName;var $c,$f,$d=new $WI(this.getPublicExtData()),$H=0,$B=0,$A=0,$Q=0,$p=0,$t=0,$V=0,$u=0,$N=0,$y=$d.getInt32(),$$=$d.readUTFString(),$w=$$.split("\n");for($I=0;$I<$y;$I++){if($c=this._mainTexture,$f=this._path+$w[2*$I],$$=$w[2*$I+1],null==this._mainTexture&&($c=this._textureDic[$f]),!$c)return this.event("error",this),void(this.isParseFail=!0);$H=$d.getFloat32(),$B=$d.getFloat32(),$A=$d.getFloat32(),$Q=$d.getFloat32(),$N=$d.getFloat32(),$p=isNaN($N)?0:$N,$N=$d.getFloat32(),$t=isNaN($N)?0:$N,$N=$d.getFloat32(),$V=isNaN($N)?$A:$N,$N=$d.getFloat32(),$u=isNaN($N)?$Q:$N,this.subTextureDic[$$]=$zI.create($c,$H,$B,$A,$Q,-$p,-$t,$V,$u),$c.alphaTexture&&(this.subTextureDic[$$].alphaTexture=$zI.create($c.alphaTexture,$H,$B,$A,$Q,-$p,-$t,$V,$u))}this._mainTexture=$c;var $g,$O,$a,$m,$j,$T=$d.getUint16();for($I=0;$I<$T;$I++)($g=[]).push($d.getUint16()),$g.push($d.getUint16()),$g.push($d.getUint16()),$g.push($d.getUint16()),this.aniSectionDic[$I]=$g;var $q,$v=$d.getInt16(),$W={};for($I=0;$I<$v;$I++)$O=new $LI,0==$I?$q=$O:$O.root=$q,$O.d=$n?-1:1,$m=$d.readUTFString(),$j=$d.readUTFString(),$O.length=$d.getFloat32(),1==$d.getByte()&&($O.inheritRotation=!1),1==$d.getByte()&&($O.inheritScale=!1),$O.name=$m,$j&&(($a=$W[$j])?$a.addChild($O):this.mRootBone=$O),$W[$m]=$O,this.mBoneArr.push($O);this.tMatrixDataLen=$d.getUint16();var $R,$z,$L=$d.getUint16(),$o=Math.floor($L/this.tMatrixDataLen),$S=this.srcBoneMatrixArr;for($I=0;$I<$o;$I++)($R=new $hI).scX=$d.getFloat32(),$R.skX=$d.getFloat32(),$R.skY=$d.getFloat32(),$R.scY=$d.getFloat32(),$R.x=$d.getFloat32(),$R.y=$d.getFloat32(),8===this.tMatrixDataLen&&($R.skewX=$d.getFloat32(),$R.skewY=$d.getFloat32()),$S.push($R),($O=this.mBoneArr[$I]).transform=$R;var $X,$C=$d.getUint16(),$J=0;for($I=0;$I<$C;$I++){for($z=new $kI,$J=$d.getUint16(),$M=0;$M<$J;$M++)$z.boneNames.push($d.readUTFString()),$z.boneIndexs.push($d.getInt16());$z.name=$d.readUTFString(),$z.targetBoneName=$d.readUTFString(),$z.targetBoneIndex=$d.getInt16(),$z.bendDirection=$d.getFloat32(),$z.mix=$d.getFloat32(),$z.isSpine=$n,this.ikArr.push($z)}var $x,$k=$d.getUint16(),$r=0;for($I=0;$I<$k;$I++){for($X=new $_I,$r=$d.getUint16(),$M=0;$M<$r;$M++)$X.boneIndexs.push($d.getInt16());$X.name=$d.getUTFString(),$X.targetIndex=$d.getInt16(),$X.rotateMix=$d.getFloat32(),$X.translateMix=$d.getFloat32(),$X.scaleMix=$d.getFloat32(),$X.shearMix=$d.getFloat32(),$X.offsetRotation=$d.getFloat32(),$X.offsetX=$d.getFloat32(),$X.offsetY=$d.getFloat32(),$X.offsetScaleX=$d.getFloat32(),$X.offsetScaleY=$d.getFloat32(),$X.offsetShearY=$d.getFloat32(),this.tfArr.push($X)}var $l=$d.getUint16(),$F=0;for($I=0;$I<$l;$I++){for(($x=new $rI).name=$d.readUTFString(),$F=$d.getUint16(),$M=0;$M<$F;$M++)$x.bones.push($d.getInt16());$x.target=$d.readUTFString(),$x.positionMode=$d.readUTFString(),$x.spacingMode=$d.readUTFString(),$x.rotateMode=$d.readUTFString(),$x.offsetRotation=$d.getFloat32(),$x.position=$d.getFloat32(),$x.spacing=$d.getFloat32(),$x.rotateMix=$d.getFloat32(),$x.translateMix=$d.getFloat32(),this.pathArr.push($x)}var $e,$_,$h,$P,$D,$G=0,$Y=0,$K=0,$s=NaN,$b=0,$U=$d.getInt16();for($I=0;$I<$U;$I++){var $II=$d.getUint8(),$MI={};this.deformAniArr.push($MI);for(var $EI=0;$EI<$II;$EI++)for(($e=new $SI).skinName=$d.getUTFString(),$MI[$e.skinName]=$e,$G=$d.getInt16(),$M=0;$M<$G;$M++)for($_=new $XI,$e.deformSlotDataList.push($_),$Y=$d.getInt16(),$E=0;$E<$Y;$E++)for($h=new $CI,$_.deformSlotDisplayList.push($h),$h.slotIndex=$d.getInt16(),$h.attachment=$d.getUTFString(),$K=$d.getInt16(),$Z=0;$Z<$K;$Z++)for(1==$d.getByte()?$h.tweenKeyList.push(!0):$h.tweenKeyList.push(!1),$s=$d.getFloat32(),$h.timeList.push($s),$P=[],$h.vectices.push($P),$b=$d.getInt16(),$i=0;$i<$b;$i++)$P.push($d.getFloat32())}var $ZI,$iI,$nI=$d.getInt16(),$cI=0,$fI=0;for($I=0;$I<$nI;$I++){for($cI=$d.getInt16(),$D=[],$M=0;$M<$cI;$M++){for(($ZI=new $JI).time=$d.getFloat32(),$fI=$d.getInt16(),$E=0;$E<$fI;$E++)$ZI.drawOrder.push($d.getInt16());$D.push($ZI)}this.drawOrderAniArr.push($D)}var $dI,$HI=$d.getInt16(),$BI=0;for($I=0;$I<$HI;$I++){for($BI=$d.getInt16(),$iI=[],$M=0;$M<$BI;$M++)($dI=new $xI).name=$d.getUTFString(),$dI.intValue=$d.getInt32(),$dI.floatValue=$d.getFloat32(),$dI.stringValue=$d.getUTFString(),$dI.time=$d.getFloat32(),$iI.push($dI);this.eventAniArr.push($iI)}var $AI=$d.getInt16();if(0<$AI)for(this.attachmentNames=[],$I=0;$I<$AI;$I++)this.attachmentNames.push($d.getUTFString());var $QI,$pI,$tI=$d.getInt16();for($I=0;$I<$tI;$I++)($QI=new $oI).name=$d.readUTFString(),$QI.parent=$d.readUTFString(),$QI.attachmentName=$d.readUTFString(),$QI.srcDisplayIndex=$QI.displayIndex=$d.getInt16(),($QI.templet=this).boneSlotDic[$QI.name]=$QI,null==($pI=this.bindBoneBoneSlotDic[$QI.parent])&&(this.bindBoneBoneSlotDic[$QI.parent]=$pI=[]),$pI.push($QI),this.boneSlotArray.push($QI);var $VI,$uI,$NI,$yI=$d.readUTFString().split("\n"),$$I=0,$wI=$d.getUint8(),$gI=0,$OI=0,$aI=0,$mI=0,$jI=0,$TI=0,$qI=0;for($I=0;$I<$wI;$I++){for(($VI=new $lI).name=$yI[$$I++],$gI=$d.getUint8(),$M=0;$M<$gI;$M++){for(($uI=new $eI).name=$yI[$$I++],$QI=this.boneSlotDic[$uI.name],$OI=$d.getUint8(),$E=0;$E<$OI;$E++){if($NI=new $FI,this.skinSlotDisplayDataArr.push($NI),$NI.name=$yI[$$I++],$NI.attachmentName=$yI[$$I++],$NI.transform=new $hI,$NI.transform.scX=$d.getFloat32(),$NI.transform.skX=$d.getFloat32(),$NI.transform.skY=$d.getFloat32(),$NI.transform.scY=$d.getFloat32(),$NI.transform.x=$d.getFloat32(),$NI.transform.y=$d.getFloat32(),$uI.displayArr.push($NI),$NI.width=$d.getFloat32(),$NI.height=$d.getFloat32(),$NI.type=$d.getUint8(),$NI.verLen=$d.getUint16(),0<($v=$d.getUint16()))for($NI.bones=[],$Z=0;$Z<$v;$Z++){var $vI=$d.getUint16();$NI.bones.push($vI)}if(0<($aI=$d.getUint16()))for($NI.uvs=[],$Z=0;$Z<$aI;$Z++)$NI.uvs.push($d.getFloat32());if(0<($mI=$d.getUint16()))for($NI.weights=[],$Z=0;$Z<$mI;$Z++)$NI.weights.push($d.getFloat32());if(0<($jI=$d.getUint16()))for($NI.triangles=[],$Z=0;$Z<$jI;$Z++)$NI.triangles.push($d.getUint16());if(0<($TI=$d.getUint16()))for($NI.vertices=[],$Z=0;$Z<$TI;$Z++)$NI.vertices.push($d.getFloat32());if(0<($qI=$d.getUint16()))for($NI.lengths=[],$Z=0;$Z<$qI;$Z++)$NI.lengths.push($d.getFloat32())}$VI.slotArr.push($uI)}this.skinDic[$VI.name]=$VI,this.skinDataArray.push($VI)}1==$d.getUint8()?(this.yReverseMatrix=new $RI(1,0,0,-1,0,0),$q&&$q.setTempMatrix(this.yReverseMatrix)):$q&&$q.setTempMatrix(new $RI),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},$I.getTexture=function($I){var $M=this.subTextureDic[$I];return $M||($M=this.subTextureDic[$I.substr(0,$I.length-1)]),null==$M?this._mainTexture:$M},$I.showSkinByIndex=function($I,$M,$E){if(void 0===$E&&($E=!0),$M<0&&$M>=this.skinDataArray.length)return!1;var $Z,$i,$n=0,$c=0,$f=this.skinDataArray[$M];if($f){for($n=0,$c=$f.slotArr.length;$n<$c;$n++)($i=$f.slotArr[$n])&&($Z=$I[$i.name])&&($Z.showSlotData($i,$E),$E&&"undefined"!=$Z.attachmentName&&"null"!=$Z.attachmentName?$Z.showDisplayByName($Z.attachmentName):$Z.showDisplayByIndex($Z.displayIndex));return!0}return!1},$I.getSkinIndexByName=function($I){for(var $M=0,$E=this.skinDataArray.length;$M<$E;$M++)if(this.skinDataArray[$M].name==$I)return $M;return-1},$I.getGrahicsDataWithCache=function($I,$M){return this._graphicsCache[$I][$M]},$I.setGrahicsDataWithCache=function($I,$M,$E){this._graphicsCache[$I][$M]=$E},$I.destroy=function(){var $I;for(var $M in this._isDestroyed=!0,this.subTextureDic)($I=this.subTextureDic[$M])&&$I.destroy();for($M in this._textureDic)($I=this._textureDic[$M])&&$I.destroy();for(var $E=0,$Z=this.skinSlotDisplayDataArr.length;$E<$Z;$E++)this.skinSlotDisplayDataArr[$E].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete $i.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},$I.getAniNameByIndex=function($I){var $M=this.getAnimation($I);return $M?$M.name:null},$n(0,$I,"rate",function(){return this._rate},function($I){this._rate=$I}),$i.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",$i.TEMPLET_DICTIONARY=null,$i}($S)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function($I,$M){"use strict";for(var $E in Object.defineProperty($M,"__esModule",{value:!0}),Laya){var $Z=Laya[$E];$Z&&$Z.__isclass&&($M[$E]=$Z)}});