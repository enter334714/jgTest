var J=wx.h$;var config6kw={sdkVersion:"1.0.8",url:"https://usmini.6kw.com/",channel:0,sdkChannelID:34,subChannelID:0,appID:"1283",appKey:"aa42d2fa55939ad62b0cbbd10034f78c",urlParam:"",switch:1};var sdk6kwFunction=sdk6kw();var sdk6kw_user_game_info={};const request6kwFunction=o=>new Promise((a,t)=>{console.log("-------------------------------------"),console.log(o),console.log("-------------------------------------"),console.log(config6kw.url+o.path),wx.request({url:config6kw.url+o.path,data:JSON.stringify(o.data),method:"POST",dataType:"json",success:function(e){a(e)},fail:function(e){console.log("[SDK]"+o.path+"\u53d1\u8d77\u8bf7\u6c42\u5931\u8d25"),t(e)}})});function sdk6kw(){var s={};return{init:function(e){console.log("[SDK]\u8c03\u7528init\u521d\u59cb\u5316\u63a5\u53e3"),s.init="function"==typeof e?e:null,config6kw.urlParam=config6kw.appID+"/"+config6kw.sdkChannelID+"/"+config6kw.subChannelID,wx.showShareMenu({withShareTicket:!0});var a=this;e=wx.getStorageSync("sdk6kwLaunchOptions");var t=wx.getSystemInfoSync();e||(e=wx.getEnterOptionsSync(),wx.setStorageSync("sdk6kwLaunchOptions",e)),console.log("[SDK]\u8c03\u7528init\u521d\u59cb\u5316\u63a5\u53e3 %o",wx.getEnterOptionsSync()),console.log(wx.getStorageSync("wxg6kw_openid")),wx.getStorageSync("wxg6kw_openid")||wx.login({success:function(e){e={path:"openid/"+config6kw.urlParam,data:{code:e.code}};request6kwFunction(e).then(e=>{1==e.data.code?(console.log("[SDK]\u670d\u52a1\u7aef\u83b7\u53d6\u5fae\u4fe1openId\u6210\u529f\uff1a"+JSON.stringify(e.data)),wx.setStorageSync("wxg6kw_openid",e.data.data.openid)):(console.log("[SDK]\u670d\u52a1\u7aef\u83b7\u53d6\u5fae\u4fe1openId\u5931\u8d25\uff1a"+JSON.stringify(e.data)),s.init&&s.init(0,{errMsg:"\u521d\u59cb\u5316\u5931\u8d25\uff0c\u83b7\u53d6\u5fae\u4fe1openId\u5931\u8d25"}))}).catch(e=>{console.log("[SDK]\u670d\u52a1\u7aef\u83b7\u53d6\u5fae\u4fe1openId\u5f02\u5e38\uff1a"+JSON.stringify(e.data))})},fail:function(e){console.log("\u5fae\u4fe1\u767b\u5f55\u5931\u8d25\uff0c\u8fd4\u56de"+JSON.stringify(e)),s.init&&s.init(0,{errMsg:e.errMsg}),console.log("[SDK]\u83b7\u53d6\u5fae\u4fe1\u7528\u6237\u6388\u6743\u5931\u8d25")}}),wx.onShow(function(e){wx.setStorageSync("wxg6kw_enter_time",0);var a=Date.parse(new Date)/1e3;wx.setStorageSync("wxg6kw_enter_time",a)}),wx.onHide(function(e){wx.setStorageSync("wxg6kw_left_time",0),wx.setStorageSync("wxg6kw_left_time",Date.parse(new Date)/1e3),a.recordLog()});e={path:"init/"+config6kw.urlParam,data:{sdkVersion:config6kw.sdkVersion,os:t.platform}};request6kwFunction(e).then(e=>{console.log("[SDK]\u83b7\u53d6\u6e38\u620f\u914d\u7f6e\u6210\u529f\uff1a"+JSON.stringify(e.data)),config6kw.switch=e.data.data.switch,s.init&&s.init(1,{is_switch:e.data.data.switch})}).catch(e=>{console.log("[SDK]\u83b7\u53d6\u6e38\u620f\u914d\u7f6e\u5f02\u5e38\uff1a"+e.data),s.init&&s.init(0,{errMsg:"\u521d\u59cb\u5316\u5931\u8d25"})})},login:function(e){console.log("[SDK]\u8c03\u8d77\u767b\u5f55");var t=wx.getEnterOptionsSync();var o=this.base64_encode(JSON.stringify(t));console.log("enterOptionsData is %o",t),console.log("enterOptionsData is %o",o);var n=this;s.login="function"==typeof e?e:null,wx.login({success:function(e){var a=n.getPublicData();e={path:"login/"+config6kw.urlParam,data:{code:e.code,channel:a.sdk6kwLaunchOptions.query.channel,scene:a.sdk6kwLaunchOptions.scene,brand:a.wxSystemInfo.brand,model:a.wxSystemInfo.model,mobileVersion:a.wxSystemInfo.system,isWifi:a.wxSystemInfo.wifiEnabled,os:a.wxSystemInfo.platform,sdkVersion:config6kw.sdkVersion,extension:o,query:JSON.stringify(t.query)}};console.log(e),request6kwFunction(e).then(e=>{1==e.data.code?(console.log("[SDK]\u767b\u5f55\u6210\u529f\uff1a"+JSON.stringify(e.data)),wx.setStorageSync("wxg6kw_token",e.data.data.token),wx.setStorageSync("wxg6kw_userId",e.data.data.userId),wx.setStorageSync("wxg6kw_nickName",e.data.data.nickName),e.data.data.extension&&wx.setStorageSync("wxg6kw_userInfo_extension",e.data.data.extension),s.login&&s.login(1,e.data.data)):(console.log("[SDK]\u767b\u5f55\u5931\u8d25\uff1a"+JSON.stringify(e.data)),s.login&&s.login(0,{errMsg:e.data.msg}))})},fail:function(e){console.log("\u5fae\u4fe1\u767b\u5f55\u5931\u8d25\uff0c\u8fd4\u56de"+JSON.stringify(e)),s.login&&s.login(0,{errMsg:e.errMsg}),console.log("[SDK]\u83b7\u53d6\u5fae\u4fe1\u7528\u6237\u6388\u6743\u5931\u8d25")}})},share:function(a,e){var t=this.getPublicData();console.log("[SDK]CP\u8c03\u7528\u5206\u4eab"+JSON.stringify(a)),s.share="function"==typeof e?e:null;e={path:"share/"+config6kw.urlParam,data:{userID:wx.getStorageSync("wxg6kw_userId"),token:wx.getStorageSync("wxg6kw_token"),openId:wx.getStorageSync("wxg6kw_openid"),channel:t.sdk6kwLaunchOptions.query.channel,type:"diybtn"}};Object.assign(e.data,sdk6kw_user_game_info),request6kwFunction(e).then(e=>{1==e.data.code?(wx.shareAppMessage({title:a.title,imageUrl:a.imageUrl,query:e.data.data.query+"&"+a.query}),s.share&&s.share(1,e.data.data)):s.share&&s.share(0,e.data.msg)})},shareLog:function(e){console.log("[SDK]\u53f3\u4e0a\u89d2\u4e3b\u52a8\u5206\u4eab\u4e0a\u62a5");var a=this.getPublicData();a={path:"share/"+config6kw.urlParam,data:{type:"right",openId:wx.getStorageSync("wxg6kw_openid"),roleId:sdk6kw_user_game_info.roleID,roleName:sdk6kw_user_game_info.roleName,roleLevel:sdk6kw_user_game_info.roleLevel,serverId:sdk6kw_user_game_info.serverID,serverName:sdk6kw_user_game_info.serverName,channel:a.sdk6kwLaunchOptions.query.channel,type:"right"}};request6kwFunction(a).then(e=>{s.share&&s.share(1,e.data.data)})},pay:function(a,t){var o=this;wx.checkSession({success:function(){o.startPay(a,t)},fail:function(){console.log("[SDK]\u8c03\u8d77transaction\u65f6\u53d1\u73b0\u7528\u6237session\u8fc7\u671f\u9700\u8981\u91cd\u65b0\u767b\u5f55"),o.login(function(e){1==e&&o.startPay(a,t)})}})},startPay:function(t,e){wx.showLoading({title:"\u6b63\u5728\u652f\u4ed8"}),console.log("[SDK]\u8c03\u8d77transaction\uff0cCP\u4f20\u503c\uff1a"+JSON.stringify(t));var o=this;s.pay="function"==typeof e?e:null;e=this.getPublicData();if(console.log(e.wxSystemInfo),""==wx.getStorageSync("wxg6kw_token")||null==wx.getStorageSync("wxg6kw_token"))return wx.showToast({title:"\u767b\u5f55\u4fe1\u606f\u5931\u6548\uff0c\u8bf7\u9000\u51fa\u91cd\u8bd5"}),!1;var n={path:"pay/"+config6kw.urlParam,data:{os:e.wxSystemInfo.platform,brand:e.wxSystemInfo.brand,model:e.wxSystemInfo.model,osVersion:e.wxSystemInfo.system,token:wx.getStorageSync("wxg6kw_token"),userID:wx.getStorageSync("wxg6kw_userId"),sessionKey:wx.getStorageSync("wxg6kw_session_key"),sdkVersion:config6kw.sdkVersion,cpOrder:t.cpOrder,serverId:t.serverId,serverName:t.serverName,productId:t.productId,productName:t.productName,roleId:t.roleId,roleName:t.roleName,roleLevel:t.roleLevel,price:t.price,extension:t.extension,notifyUrl:t.notifyUrl}};request6kwFunction(n).then(a=>{if(console.log("-----------------"),console.log(a.data),wx.hideLoading({success:e=>{}}),0==a.data.code)return console.log(n),"\u4ee4\u724c\u6821\u9a8c\u5931\u8d25"==a.data.msg?(console.log("[SDK]\u4ee4\u724c\u6821\u9a8c\u5931\u8d25\uff0c\u91cd\u65b0\u767b\u5f55"),o.login(function(e){1==e&&o.startPay(t)})):(o.showTips(a.data.msg),s.pay&&s.pay(0,{errMsg:a.data.msg})),!1;a.data.data.cpOrder,a.data.data.orderId,a.data.data.total,a.data.data.extension,a.data.data.text;return 1==a.data.data.isSwitch?(a.data.data.wayInfo.sessionFrom?o.showModel().then(e=>{wx.openCustomerServiceConversation({showMessageCard:!0,sendMessageTitle:a.data.data.wayInfo.title,sendMessageImg:a.data.data.wayInfo.img,sessionFrom:JSON.stringify(a.data.data.wayInfo.sessionFrom),success:function(){console.log("[SDK]\u901a\u77e5\u7ed3\u679c"),console.log(e),s.pay&&s.pay(1,e)},fail:function(e){console.log(e),s.pay&&s.pay(0,{errMsg:"\u8c03\u8d77\u5ba2\u670d\u4f1a\u8bdd\u5931\u8d25"})}})}):(o.showTips(a.data.msg),s.pay&&s.pay(0,{errMsg:"\u53c2\u6570\u4e22\u5931"})),!1):2==a.data.data.isSwitch?(a.data.data.miniprogram_id||a.data.data.miniprogram_path?(console.log(a.data.data),wx.navigateToMiniProgram({appId:a.data.data.miniprogram_id,path:a.data.data.miniprogram_path+"?price="+a.data.data.total+"&appId="+config6kw.appID+"&orderId="+a.data.data.orderId+"&service="+config6kw.urlParam+"&appKey="+config6kw.appKey,extraData:{count:a.data.data.total,orderId:a.data.data.orderId,cpOrder:a.data.data.cpOrder},envVersion:"develop",success(e){console.log("\u6253\u5f00\u6210\u529f")},fail:e=>{}})):(o.showTips(a.data.msg),s.pay&&s.pay(0,{errMsg:"\u53c2\u6570\u4e22\u5931"})),!1):void(a.data.data.buyQuantity<=a.data.data.balance&&0!=a.data.data.buyQuantity&&0!=a.data.data.balance?(console.log("[SDK]\u4f59\u989d\u5145\u8db3\uff0c\u6e38\u620f\u5e01\u76f4\u63a5\u6263\u9664"),wx.showModal({title:"\u652f\u4ed8\u63d0\u793a",content:"\u60a8\u8fd8\u6709"+a.data.data.balance+"\u4e2a\u6e38\u620f\u5e01\u672a\u6d88\u8d39\uff0c\u672c\u6b21\u652f\u4ed8\u5c06\u6263\u9664"+a.data.data.buyQuantity+"\u6e38\u620f\u5e01",showCancel:!1,confirmText:"\u6211\u77e5\u9053\u4e86",success:function(){var e=o.gameGoPay(a.data.data);1==e.code?(o.showTips("\u652f\u4ed8\u6210\u529f"),s.pay&&s.pay(1,e.data)):(o.showTips("\u652f\u4ed8\u5931\u8d25"+e.msg),s.pay&&s.pay(0,{errMsg:"\u652f\u4ed8\u5931\u8d25:"+e.msg}))}})):o.MidasPay(a.data.data).then(e=>{return console.log("[SDK]\u8c03\u8d77\u7c73\u5927\u5e08\u652f\u4ed8\u7ed3\u679c"+JSON.stringify(e)),"requestMidasPayment:ok"==e.errMsg&&(1==(e=o.gameGoPay(a.data.data)).code?(o.showTips("\u652f\u4ed8\u6210\u529f"),s.pay&&s.pay(1,e.data)):(o.showTips("\u652f\u4ed8\u5931\u8d25"+e.msg),s.pay&&s.pay(0,{errMsg:"\u652f\u4ed8\u5931\u8d25:"+e.msg}))),!1}).catch(e=>{console.log("[SDK]\u8c03\u8d77\u7c73\u5927\u5e08\u652f\u4ed8\u7ed3\u679c\u5f02\u5e38"+JSON.stringify(e)),"{}"!=JSON.stringify(e)&&(o.showTips("\u652f\u4ed8\u5931\u8d25"+e.errMsg),s.pay&&s.pay(0,{errMsg:"\u652f\u4ed8\u5931\u8d25:"+e.errMsg}))}))})},MidasPay:function(e){return new Promise((a,t)=>{wx.requestMidasPayment({mode:"game",env:e.env,offerId:e.offerId,currencyType:e.currencyType,platform:e.platform,buyQuantity:e.buyQuantity,zoneId:e.zoneId,success:function(e){a(e)},fail:function(e){t(e)},complete:function(e){}})})},gameGoPay:function(a){var t=this;var e=this.getPublicData();e={path:"checkPay/"+config6kw.urlParam,data:{os:e.wxSystemInfo.platform,token:wx.getStorageSync("wxg6kw_token"),userID:wx.getStorageSync("wxg6kw_userId"),sdkVersion:config6kw.sdkVersion,orderID:a.orderId}};console.log(e),request6kwFunction(e).then(e=>(console.log("[SDK]\u7c73\u5927\u5e08\u652f\u4ed8\u7ed3\u679c\uff1a"+JSON.stringify(e)),"\u7528\u6237session\u5df2\u5931\u6548,\u8bf7\u91cd\u65b0\u767b\u5f55"==e.data.msg?(t.login(function(e){1==e&&t.gameGoPay(a)}),!1):e.data))},logEnterGame:function(a){var t=this;wx.checkSession({success:function(){t.postRole(a)},fail:function(){console.log("[SDK]\u8c03\u7528\u89d2\u8272\u4fe1\u606f\u63a5\u53e3session\u8fc7\u671f\u9700\u8981\u91cd\u65b0\u767b\u5f55"),t.login(function(e){1==e&&t.postRole(a)})}})},logRole:function(a){var t=this;wx.checkSession({success:function(){t.postRole(a)},fail:function(){console.log("[SDK]\u8c03\u7528\u89d2\u8272\u4fe1\u606f\u63a5\u53e3session\u8fc7\u671f\u9700\u8981\u91cd\u65b0\u767b\u5f55"),t.login(function(e){1==e&&t.postRole(a)})}})},postRole:function(a){console.log("[SDK]\u8c03\u7528\u89d2\u8272\u4e0a\u4f20"+JSON.stringify(a));var t=this;var e={token:wx.getStorageSync("wxg6kw_token"),userID:wx.getStorageSync("wxg6kw_userId"),roleID:a.roleId,roleName:a.roleName,roleLevel:a.roleLevel,serverID:a.serverId,serverName:a.serverName,payLevel:a.payLevel,roleCreateTime:a.createTime};(sdk6kw_user_game_info=e).token&&e.userID||(console.log("\u7528\u6237\u4fe1\u606f\u8fc7\u671f\u5bfc\u81f4\u7528\u6237\u8c03\u8d77\u89d2\u8272\u4fe1\u606f\u63a5\u53e3\u5931\u8d25"),t.login(function(e){1==e&&t.postRole(a)}));e={path:"role/"+config6kw.urlParam,data:e};request6kwFunction(e).then(e=>{console.log(e)})},recordLog:function(){console.log("[SDK]\u8bbf\u95ee\u65e5\u5fd7\u4e0a\u62a5");var e=this.getPublicData();e={path:"visit/"+config6kw.urlParam,data:{openId:wx.getStorageSync("wxg6kw_openid"),enterTime:wx.getStorageSync("wxg6kw_enter_time"),leftTime:wx.getStorageSync("wxg6kw_left_time"),channel:e.sdk6kwLaunchOptions.query.channel,model:e.wxSystemInfo.model,platform:e.wxSystemInfo.platform,brand:e.wxSystemInfo.brand,system:e.wxSystemInfo.system,scene:e.sdk6kwLaunchOptions.scene,id:e.sdk6kwLaunchOptions.query.id,shareTime:e.sdk6kwLaunchOptions.query.shareTime,shareId:e.sdk6kwLaunchOptions.query.shareId}};request6kwFunction(e).then(e=>{1==e.data.code?console.log("[SDK]\u8bbf\u95ee\u8bb0\u5f55\u4e0a\u62a5\u6210\u529f"+JSON.stringify(e.data)):console.log("[SDK]\u8bbf\u95ee\u8bb0\u5f55\u4e0a\u62a5\u5931\u8d25\uff1a"+JSON.stringify(e.data))}).catch(e=>{console.log("[SDK]\u8bbf\u95ee\u8bb0\u5f55\u4e0a\u62a5\u5931\u8d25"+JSON.stringify(e))})},getPublicData:function(){var e=wx.getSystemInfoSync();var a=wx.getStorageSync("sdk6kwLaunchOptions");return a||(a=wx.getEnterOptionsSync(),wx.setStorageSync("sdk6kwLaunchOptions",a)),{wxSystemInfo:e,sdk6kwLaunchOptions:a,config6kw:config6kw}},showModel:function(){return new Promise((a,t)=>{wx.showModal({title:"\u6e29\u99a8\u63d0\u793a",content:"\u8bf7\u8fdb\u5165\u3010\u5ba2\u670d\u4f1a\u8bdd\u3011\u7a97\u53e3\u70b9\u51fb\u53f3\u4e0b\u89d2\u5361\u7247\u83b7\u53d6\u652f\u4ed8\u94fe\u63a5",showCancel:!0,confirmText:"\u524d\u5f80\u5145\u503c",success:function(e){!0===e.confirm?a():!0===e.cancel&&t()},fail:function(){t()}})})},showTips:function(e){wx.showModal({title:"\u6e29\u99a8\u63d0\u793a",content:e,showCancel:!1,success:function(e){},fail:function(){}})},getPayState:function(e,a){var t=this.getPublicData();t={path:"payState/"+config6kw.urlParam,data:{sdkVersion:config6kw.sdkVersion,token:wx.getStorageSync("wxg6kw_token"),userID:wx.getStorageSync("wxg6kw_userId"),roleID:sdk6kw_user_game_info.roleId,roleName:sdk6kw_user_game_info.roleName,roleLevel:sdk6kw_user_game_info.roleLevel,os:t.wxSystemInfo.platform,cpData:e}};request6kwFunction(t).then(e=>(a(1,e.data.data),!1)).catch(e=>(a(0,e),!1))},msgSecCheck:function(e){var a=e.content;var t=e.callback;e={path:"frontCheckContent/"+config6kw.urlParam,data:{type:"msg",content:a,openid:wx.getStorageSync("wxg6kw_openid"),userID:wx.getStorageSync("wxg6kw_userId"),token:wx.getStorageSync("wxg6kw_token")}};request6kwFunction(e).then(e=>(t(1,e.data),!1)).catch(e=>(t(0,e),!1))},payDebug:function(){wx.navigateToMiniProgram({appId:"wxb4cda18c9d8daea6",path:"pages/charge/charge?price=600&productId=10010",extraData:{count:"600",productId:100230},envVersion:"develop",success(e){console.log("\u6253\u5f00\u6210\u529f")}})},base64_encode(e){var a,t,o;var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var s=0,r=e.length,i="";for(;s<r;){if(a=255&e.charCodeAt(s++),s==r){i=(i+=n.charAt(a>>2))+n.charAt((3&a)<<4)+"==";break}if(t=e.charCodeAt(s++),s==r){i=(i=(i+=n.charAt(a>>2))+n.charAt((3&a)<<4|(240&t)>>4))+n.charAt((15&t)<<2)+"=";break}o=e.charCodeAt(s++),i=(i=(i=(i+=n.charAt(a>>2))+n.charAt((3&a)<<4|(240&t)>>4))+n.charAt((15&t)<<2|(192&o)>>6))+n.charAt(63&o)}return i}}}function sdk6kwRun(e,a,t){e in sdk6kwFunction&&sdk6kwFunction[e](a,t)}exports.init=function(e){sdk6kwRun("init",e)},exports.login=function(e){sdk6kwRun("login",e)},exports.pay=function(e,a){sdk6kwRun("pay",e,a)},exports.debugPay=function(){sdk6kwRun("payDebug")},exports.logRole=function(e,a,t,o,n,s,r){sdk6kwRun("logRole",{createTime:e,serverId:a,serverName:t,roleId:o,roleName:n,roleLevel:s,payLevel:r})},exports.logEnterGame=function(e,a,t,o,n,s,r){sdk6kwRun("logEnterGame",{createTime:e,serverId:a,serverName:t,roleId:o,roleName:n,roleLevel:s,payLevel:r})},exports.share=function(e,a){sdk6kwRun("share",e,a)},exports.shareLog=function(e){sdk6kwRun("shareLog",e)},exports.getPayState=function(e,a){sdk6kwRun("getPayState",e,a)},exports.msgSecCheck=function(e){sdk6kwRun("msgSecCheck",e)};