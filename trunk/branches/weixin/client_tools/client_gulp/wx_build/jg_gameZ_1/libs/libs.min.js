var Laya=window.Laya=function(a$W,a$t){var a$w={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(a$t,a$k){return 1==arguments.length?a$w.__presubstr.call(this,a$t):a$w.__presubstr.call(this,a$t,0<a$k?a$k:this.length+a$k)},__init:function(a$t){a$t.forEach(function(a$t){a$t.__init$&&a$t.__init$()})},__isClass:function(a$t){return a$t&&(a$t.__isclass||a$t==Object||a$t==String||a$t==Array)},__newvec:function(a$t,a$k){var a$v=[];a$v.length=a$t;for(var a$j=0;a$j<a$t;a$j++)a$v[a$j]=a$k;return a$v},__extend:function(a$t,a$k){for(var a$v in a$k)if(a$k.hasOwnProperty(a$v)){var a$j=Object.getOwnPropertyDescriptor(a$k,a$v),a$Q=a$j.get,a$u=a$j.set;a$Q||a$u?a$Q&&a$u?Object.defineProperty(a$t,a$v,a$j):(a$Q&&Object.defineProperty(a$t,a$v,a$Q),a$u&&Object.defineProperty(a$t,a$v,a$u)):a$t[a$v]=a$k[a$v]}function a$S(){a$w.un(this,"constructor",a$t)}a$S.prototype=a$k.prototype,a$t.prototype=new a$S,a$w.un(a$t.prototype,"__imps",a$w.__copy({},a$k.prototype.__imps))},__copy:function(a$t,a$k){if(!a$k)return null;for(var a$v in a$t=a$t||{},a$k)a$t[a$v]=a$k[a$v];return a$t},__package:function(a$t,a$k){if(!a$w.__packages[a$t]){a$w.__packages[a$t]=!0;var a$v=a$W,a$j=a$t.split(".");if(1<a$j.length)for(var a$Q=0,a$u=a$j.length-1;a$Q<a$u;a$Q++){var a$S=a$v[a$j[a$Q]];a$v=a$S||(a$v[a$j[a$Q]]={})}a$v[a$j[a$j.length-1]]||(a$v[a$j[a$j.length-1]]=a$k||{})}},__hasOwnProperty:function(a$t,a$k){return a$k=a$k||this,Object.hasOwnProperty.call(a$k,a$t)||function a$t(a$k,a$v){if(Object.hasOwnProperty.call(a$v.prototype,a$k))return!0;var a$j=a$v.prototype.__super;return null==a$j?null:a$t(a$k,a$j)}(a$t,a$k.__class)},__typeof:function(a$t,a$k){if(!a$t||!a$k)return!1;if(a$k===String)return"string"==typeof a$t;if(a$k===Number)return"number"==typeof a$t;if(a$k.__interface__)a$k=a$k.__interface__;else if("string"!=typeof a$k)return a$t instanceof a$k;return a$t.__imps&&a$t.__imps[a$k]||a$t.__class==a$k},__as:function(a$t,a$k){return this.__typeof(a$t,a$k)?a$t:null},__int:function(a$t){return a$t?parseInt(a$t):0},interface:function(a$t,a$k){a$w.__package(a$t,{});var a$v=a$w.__internals,a$j=a$v[a$t]=a$v[a$t]||{self:a$t};if(a$k){var a$Q=a$k.split(",");a$j.extend=[];for(var a$u=0;a$u<a$Q.length;a$u++){var a$S=a$Q[a$u];a$v[a$S]=a$v[a$S]||{self:a$S},a$j.extend.push(a$v[a$S])}}var a$V=a$W,a$J=a$t.split(".");for(a$u=0;a$u<a$J.length-1;a$u++)a$V=a$V[a$J[a$u]];a$V[a$J[a$J.length-1]]={__interface__:a$t}},class:function(a$t,a$k,a$v,a$j){if(a$v&&a$w.__extend(a$t,a$v),a$k)if(a$w.__package(a$k,a$t),a$w.__classmap[a$k]=a$t,0<a$k.indexOf(".")){if(0==a$k.indexOf("laya.")){var a$Q=a$k.split(".");a$j=a$j||a$Q[a$Q.length-1],a$w[a$j]&&console.log("Warning!,this class["+a$j+"] already exist:",a$w[a$j]),a$w[a$j]=a$t}}else"Main"==a$k?a$W.Main=a$t:"MainWX"==a$k?a$W.MainWX=a$t:(a$w[a$k]&&console.log("Error!,this class["+a$k+"] already exist:",a$w[a$k]),a$w[a$k]=a$t);var a$u=a$w.un,a$S=a$t.prototype;a$u(a$S,"hasOwnProperty",a$w.__hasOwnProperty),a$u(a$S,"__class",a$t),a$u(a$S,"__super",a$v),a$u(a$S,"__className",a$k),a$u(a$t,"__super",a$v),a$u(a$t,"__className",a$k),a$u(a$t,"__isclass",!0),a$u(a$t,"super",function(a$t){this.__super.call(a$t)})},imps:function(a$t,a$k){if(!a$k)return null;var a$Q=a$t.__imps||a$w.un(a$t,"__imps",{});function a$u(a$t){var a$k,a$v;if((a$k=a$w.__internals[a$t])&&(a$Q[a$t]=!0,a$v=a$k.extend))for(var a$j=0;a$j<a$v.length;a$j++)a$u(a$v[a$j].self)}for(var a$v in a$k)a$u(a$v)},superSet:function(a$t,a$k,a$v,a$j){var a$Q=a$t.prototype["_$set_"+a$v];a$Q&&a$Q.call(a$k,a$j)},superGet:function(a$t,a$k,a$v){var a$j=a$t.prototype["_$get_"+a$v];return a$j?a$j.call(a$k):null},getset:function(a$t,a$k,a$v,a$j,a$Q){a$t?(a$j&&(a$k["_$GET_"+a$v]=a$j),a$Q&&(a$k["_$SET_"+a$v]=a$Q)):(a$j&&a$w.un(a$k,"_$get_"+a$v,a$j),a$Q&&a$w.un(a$k,"_$set_"+a$v,a$Q)),a$j&&a$Q?Object.defineProperty(a$k,a$v,{get:a$j,set:a$Q,enumerable:!1,configurable:!0}):(a$j&&Object.defineProperty(a$k,a$v,{get:a$j,enumerable:!1,configurable:!0}),a$Q&&Object.defineProperty(a$k,a$v,{set:a$Q,enumerable:!1,configurable:!0}))},static:function(a$v,a$j){for(var a$Q=0,a$t=a$j.length;a$Q<a$t;a$Q+=2)if("length"==a$j[a$Q])a$v.length=a$j[a$Q+1].call(a$v);else{function a$k(){var a$k=a$j[a$Q],a$t=a$j[a$Q+1];Object.defineProperty(a$v,a$k,{get:function(){return delete this[a$k],this[a$k]=a$t.call(this)},set:function(a$t){delete this[a$k],this[a$k]=a$t},enumerable:!0,configurable:!0})}a$k()}},un:function(a$t,a$k,a$v){return a$v||(a$v=a$t[a$k]),a$w.__propun.value=a$v,Object.defineProperty(a$t,a$k,a$w.__propun),a$v},uns:function(a$k,a$t){a$t.forEach(function(a$t){a$w.un(a$k,a$t)})}};return a$W.console=a$W.console||{log:function(){}},a$W.trace=a$W.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),a$w}(window,document);!function(a$t,a$k,a$v){a$v.un,a$v.uns,a$v.static,a$v.class,a$v.getset,a$v.__newvec}(window,document,Laya),function(a$S,a$k,a$d){a$d.un,a$d.uns;var a$J=a$d.static,a$w=a$d.class,a$A=a$d.getset;a$d.__newvec;a$d.interface("laya.runtime.IMarket"),a$d.interface("laya.filters.IFilter"),a$d.interface("laya.display.ILayout"),a$d.interface("laya.resource.IDispose"),a$d.interface("laya.runtime.IPlatform"),a$d.interface("laya.resource.IDestroy"),a$d.interface("laya.runtime.IConchNode"),a$d.interface("laya.filters.IFilterAction"),a$d.interface("laya.runtime.ICPlatformClass"),a$d.interface("laya.resource.ICreateResource"),a$d.interface("laya.runtime.IConchRenderObject"),a$d.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var a$N=function(){function a$u(){}return a$w(a$u,"laya.utils.RunDriver"),a$u.FILTER_ACTIONS=[],a$u.pixelRatio=-1,a$u._charSizeTestDiv=null,a$u.now=function(){return Date.now()},a$u.getWindow=function(){return a$S},a$u.getPixelRatio=function(){if(a$u.pixelRatio<0){var a$t=a$_.context,a$k=a$t.backingStorePixelRatio||a$t.webkitBackingStorePixelRatio||a$t.mozBackingStorePixelRatio||a$t.msBackingStorePixelRatio||a$t.oBackingStorePixelRatio||a$t.backingStorePixelRatio||1;(a$u.pixelRatio=(a$_.window.devicePixelRatio||1)/a$k)<1&&(a$u.pixelRatio=1)}return a$u.pixelRatio},a$u.getIncludeStr=function(a$t){return null},a$u.createShaderCondition=function(a$t){var a$k="(function() {return "+a$t+";})";return a$d._runScript(a$k)},a$u.fontMap=[],a$u.measureText=function(a$t,a$k){var a$v=a$u.hanzi.test(a$t);if(a$v&&a$u.fontMap[a$k])return a$u.fontMap[a$k];var a$j=a$_.context;a$j.font=a$k;var a$Q=a$j.measureText(a$t);return a$v&&(a$u.fontMap[a$k]=a$Q),a$Q},a$u.getWebGLContext=function(a$t){},a$u.beginFlush=function(){},a$u.endFinish=function(){},a$u.addToAtlas=null,a$u.flashFlushImage=function(a$t){},a$u.drawToCanvas=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=a$Yt.create("2D"),a$V=new a$T(a$v,a$j,a$S);return a$p.renders[a$k]._fun(a$t,a$V,a$Q,a$u),a$S},a$u.createParticleTemplate2D=null,a$u.createGLTextur=null,a$u.createWebGLContext2D=null,a$u.changeWebGLSize=function(a$t,a$k){},a$u.createRenderSprite=function(a$t,a$k){return new a$p(a$t,a$k)},a$u.createFilterAction=function(a$t){return new a$Y},a$u.createGraphics=function(){return new a$H},a$u.clear=function(a$t){a$c._context.ctx.clear()},a$u.cancelLoadByUrl=function(a$t){},a$u.clearAtlas=function(a$t){},a$u.isAtlas=function(a$t){return!1},a$u.addTextureToAtlas=function(a$t){},a$u.getTexturePixels=function(a$t,a$k,a$v,a$j,a$Q){return null},a$u.skinAniSprite=function(){return null},a$u.update3DLoop=function(){},a$J(a$u,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),a$u}(),a$j=(a$A(1,a$d,"alertGlobalError",null,function(a$t){var a$u=0;a$_.window.onerror=a$t?function(a$t,a$k,a$v,a$j,a$Q){a$u++<5&&a$Q&&alert(a$Q.stack||a$Q)}:null}),a$d.init=function(a$t,a$k,a$v){for(var a$j=[],a$Q=2,a$u=arguments.length;a$Q<a$u;a$Q++)a$j.push(arguments[a$Q]);if(!a$d._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=a$d._arrayBufferSlice),a$d._isinit=!0,a$_.__init__(),a$O.__init__(),a$H.__init__(),a$d.timer=new a$e,a$d.scaleTimer=new a$e,a$d.loader=new a$Jt,a$y.__init__(),a$Q=0;for(var a$S=a$j.length;a$Q<a$S;a$Q++)a$j[a$Q].enable&&a$j[a$Q].enable();return a$E.__init__(),a$V.__init__(),a$n.__init__(),a$I.beginCheck(),a$d._currentStage=a$d.stage=new a$lt,a$d.stage.conchModel&&a$d.stage.conchModel.setRootNode(),a$d._getUrlPath(),a$d.render=new a$c(0,0),a$d.stage.size(a$t,a$k),a$p.__init__(),a$M.__init__(),a$R.instance.__init__(a$d.stage,a$c.canvas),a$Xt.__init__(),a$U.autoStopMusic=!0,a$s.__init__(),a$c.canvas}},a$d._getUrlPath=function(){var a$t=a$_.window.location,a$k=a$t.pathname;a$k=a$k&&":"==a$k.charAt(2)?a$k.substring(1):a$k,a$G.rootPath=a$G.basePath=a$G.getPath("file:"==a$t.protocol?a$k:a$t.protocol+"//"+a$t.host+a$t.pathname)},a$d._arrayBufferSlice=function(a$t,a$k){var a$v=new Uint8Array(this,a$t,a$k-a$t),a$j=new Uint8Array(a$v.length);return a$j.set(a$v),a$j.buffer},a$d._runScript=function(a$t){return a$_.window[a$d._evcode](a$t)},a$d.stage=null,a$d.timer=null,a$d.scaleTimer=null,a$d.loader=null,a$d.version="1.8.6",a$d.render=null,a$d._currentStage=null,a$d._isinit=!1,a$d.isDebug=!1,a$d.MiniAdpter={init:function(){a$S.navigator&&a$S.navigator.userAgent&&-1<a$S.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},a$J(a$d,["conchMarket",function(){return this.conchMarket=a$S.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=a$S.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function a$t(){}return a$w(a$t,"Config"),a$t.WebGLTextCacheCount=500,a$t.atlasEnable=!1,a$t.showCanvasMark=!1,a$t.animationInterval=50,a$t.isAntialias=!1,a$t.isAlpha=!1,a$t.premultipliedAlpha=!0,a$t.isStencil=!0,a$t.preserveDrawingBuffer=!1,a$t}()),a$W=function(){function a$W(){this._events=null}a$w(a$W,"laya.events.EventDispatcher");var a$t=a$W.prototype;return a$t.hasListener=function(a$t){return!!(this._events&&this._events[a$t])},a$t.event=function(a$t,a$k){if(!this._events||!this._events[a$t])return!1;var a$v=this._events[a$t];if(a$v.lock)a$v.queue||(a$v.queue=[]),a$v.queue.push(a$k);else{var a$j;for(a$v.lock=!0,a$v.cursor=a$v.head;a$v.cursor;)a$j=a$v.cursor,a$v.cursor=a$j.next,a$j.once&&a$W.delNode(a$v,a$j),null!=a$k?a$j.args?a$j.method.apply(a$j.caller,a$j.args.concat(a$k)):a$k instanceof Array?a$j.method.apply(a$j.caller,a$k):a$j.method.call(a$j.caller,a$k):a$j.method.apply(a$j.caller,a$j.args),a$j.once&&a$W.recoverHandler(a$j);a$v.lock=!1,!a$v.head&&this._events&&this._events[a$t]==a$v&&delete this._events[a$t],a$v.queue&&a$v.queue.length&&this.event(a$t,a$v.queue.shift())}return!0},a$t.on=function(a$t,a$k,a$v,a$j){return this._createListener(a$t,a$k,a$v,a$j,!1)},a$t.once=function(a$t,a$k,a$v,a$j){return this._createListener(a$t,a$k,a$v,a$j,!0)},a$t._createListener=function(a$t,a$k,a$v,a$j,a$Q,a$u){void 0===a$u&&(a$u=!0),a$u&&this.off(a$t,a$k,a$v,a$Q);var a$S=a$W.createHandler(a$k||this,a$v,a$j,a$Q);this._events||(this._events={});var a$V=this._events,a$J=a$V[a$t];return a$J?a$J.tail?(a$S.prev=a$J.tail,a$J.tail.next=a$S,a$J.tail=a$S):a$J.head=a$J.tail=a$S:a$V[a$t]={head:a$S,tail:a$S,cursor:null,lock:!1},this},a$t.off=function(a$t,a$k,a$v,a$j){if(void 0===a$j&&(a$j=!1),!this._events||!this._events[a$t])return this;for(var a$Q=this._events[a$t],a$u=a$Q.head;a$u;){if((!a$k||a$u.caller===a$k)&&a$u.method===a$v&&(!a$j||a$u.once)){a$W.delNode(a$Q,a$u),a$Q.cursor==a$u&&(a$Q.cursor=a$u.next),a$W.recoverHandler(a$u);break}a$u=a$u.next}return this},a$t.offAll=function(a$t){var a$k=this._events;if(!a$k)return this;if(a$t)this._recoverHandlers(a$k[a$t]),delete a$k[a$t];else{for(var a$v in a$k)this._recoverHandlers(a$k[a$v]);this._events=null}return this},a$t._recoverHandlers=function(a$t){if(a$t){for(var a$k=a$t.head;a$k;){a$W.delNode(a$t,a$k);var a$v=a$k.next;a$W.recoverHandler(a$k),a$k=a$v}a$t.cursor=null}},a$t.isMouseEvent=function(a$t){return a$W.MOUSE_EVENTS[a$t]},a$W.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},a$W.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},a$W.delNode=function(a$t,a$k){a$k.prev?a$k.prev.next=a$k.next:a$t.head=a$k.next,a$k.next?a$k.next.prev=a$k.prev:a$t.tail=a$k.prev},a$W.createHandler=function(a$t,a$k,a$v,a$j){var a$Q=a$W._freeHandler;return a$Q?(a$W._freeCount--,a$W._freeHandler=a$Q.next,a$Q.caller=a$t,a$Q.method=a$k,a$Q.args=a$v,a$Q.once=a$j):a$Q={caller:a$t,method:a$k,args:a$v,once:a$j},a$Q.prev=a$Q.next=null,a$Q},a$W.recoverHandler=function(a$t){a$t.caller=a$t.method=a$t.args=a$t.prev=null,a$t.next=a$W._freeHandler,a$W._freeHandler=a$t,a$W._freeCount++},a$W._freeHandler=null,a$W._freeCount=0,a$W}(),a$o=function(){function a$Q(a$t,a$k,a$v,a$j){this.once=!1,void(this._id=0)===a$j&&(a$j=!1),this.setTo(a$t,a$k,a$v,a$j)}a$w(a$Q,"laya.utils.Handler");var a$t=a$Q.prototype;return a$t.setTo=function(a$t,a$k,a$v,a$j){return this._id=a$Q._gid++,this.caller=a$t,this.method=a$k,this.args=a$v,this.once=a$j,this},a$t.run=function(){if(null==this.method)return null;var a$t=this._id,a$k=this.method.apply(this.caller,this.args);return this._id===a$t&&this.once&&this.recover(),a$k},a$t.runWith=function(a$t){if(null==this.method)return null;var a$k=this._id;if(null==a$t)var a$v=this.method.apply(this.caller,this.args);else a$v=this.args||a$t.unshift?this.args?this.method.apply(this.caller,this.args.concat(a$t)):this.method.apply(this.caller,a$t):this.method.call(this.caller,a$t);return this._id===a$k&&this.once&&this.recover(),a$v},a$t.clear=function(){return this.caller=null,this.method=null,this.args=null,this},a$t.recover=function(){0<this._id&&(this._id=0,this.clear())},a$Q.create=function(a$t,a$k,a$v,a$j){return void 0===a$j&&(a$j=!0),new a$Q(a$t,a$k,a$v,a$j)},a$Q._gid=1,a$Q}(),a$K=function(){function a$t(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}a$w(a$t,"laya.display.BitmapFont");var a$k=a$t.prototype;return a$k.loadFont=function(a$t,a$k){this._path=a$t,this._complete=a$k,a$d.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],a$o.create(this,this.onLoaded))},a$k.onLoaded=function(){this.parseFont(a$Vt.getRes(this._path),a$Vt.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},a$k.parseFont=function(a$t,a$k){if(null!=a$t&&null!=a$k){this._texture=a$k;var a$v=a$t.getElementsByTagName("info");if(!a$v[0].getAttributeNode)return this.parseFont2(a$t,a$k);this.fontSize=parseInt(a$v[0].getAttributeNode("size").nodeValue);var a$j,a$Q=a$v[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(a$Q[0]),parseInt(a$Q[1]),parseInt(a$Q[2]),parseInt(a$Q[3])],a$j=a$t.getElementsByTagName("char");var a$u=0;for(a$u=0;a$u<a$j.length;a$u++){var a$S=a$j[a$u],a$V=parseInt(a$S.getAttributeNode("id").nodeValue),a$J=parseInt(a$S.getAttributeNode("xoffset").nodeValue)/1,a$W=parseInt(a$S.getAttributeNode("yoffset").nodeValue)/1,a$w=parseInt(a$S.getAttributeNode("xadvance").nodeValue)/1,a$M=new a$Z;a$M.x=parseInt(a$S.getAttributeNode("x").nodeValue),a$M.y=parseInt(a$S.getAttributeNode("y").nodeValue),a$M.width=parseInt(a$S.getAttributeNode("width").nodeValue),a$M.height=parseInt(a$S.getAttributeNode("height").nodeValue);var a$H=a$wt.create(a$k,a$M.x,a$M.y,a$M.width,a$M.height,a$J,a$W);this._maxWidth=Math.max(this._maxWidth,a$w+this.letterSpacing),this._fontCharDic[a$V]=a$H,this._fontWidthMap[a$V]=a$w}}},a$k.parseFont2=function(a$t,a$k){if(null!=a$t&&null!=a$k){this._texture=a$k;var a$v=a$t.getElementsByTagName("info");this.fontSize=parseInt(a$v[0].attributes.size.nodeValue);var a$j=a$v[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(a$j[0]),parseInt(a$j[1]),parseInt(a$j[2]),parseInt(a$j[3])];var a$Q=a$t.getElementsByTagName("char"),a$u=0;for(a$u=0;a$u<a$Q.length;a$u++){var a$S=a$Q[a$u].attributes,a$V=parseInt(a$S.id.nodeValue),a$J=parseInt(a$S.xoffset.nodeValue)/1,a$W=parseInt(a$S.yoffset.nodeValue)/1,a$w=parseInt(a$S.xadvance.nodeValue)/1,a$M=new a$Z;a$M.x=parseInt(a$S.x.nodeValue),a$M.y=parseInt(a$S.y.nodeValue),a$M.width=parseInt(a$S.width.nodeValue),a$M.height=parseInt(a$S.height.nodeValue);var a$H=a$wt.create(a$k,a$M.x,a$M.y,a$M.width,a$M.height,a$J,a$W);this._maxWidth=Math.max(this._maxWidth,a$w+this.letterSpacing),this._fontCharDic[a$V]=a$H,this._fontWidthMap[a$V]=a$w}}},a$k.getCharTexture=function(a$t){return this._fontCharDic[a$t.charCodeAt(0)]},a$k.destroy=function(){if(this._texture){for(var a$t in this._fontCharDic){var a$k=this._fontCharDic[a$t];a$k&&a$k.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},a$k.setSpaceWidth=function(a$t){this._spaceWidth=a$t},a$k.getCharWidth=function(a$t){var a$k=a$t.charCodeAt(0);return this._fontWidthMap[a$k]?this._fontWidthMap[a$k]+this.letterSpacing:" "==a$t?this._spaceWidth+this.letterSpacing:0},a$k.getTextWidth=function(a$t){for(var a$k=0,a$v=0,a$j=a$t.length;a$v<a$j;a$v++)a$k+=this.getCharWidth(a$t.charAt(a$v));return a$k},a$k.getMaxWidth=function(){return this._maxWidth},a$k.getMaxHeight=function(){return this.fontSize},a$k.drawText=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S,a$V=this.getTextWidth(a$t),a$J=0;"center"===a$Q&&(a$J=(a$u-a$V)/2),"right"===a$Q&&(a$J=a$u-a$V);for(var a$W=0,a$w=0,a$M=a$t.length;a$w<a$M;a$w++)(a$S=this.getCharTexture(a$t.charAt(a$w)))&&(a$k.graphics.drawTexture(a$S,a$v+a$W+a$J,a$j),a$W+=this.getCharWidth(a$t.charAt(a$w)))},a$t}(),a$V=function(){function a$v(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=a$v._TF_EMPTY}a$w(a$v,"laya.display.css.Style");var a$t=a$v.prototype;return a$t.getTransform=function(){return this._tf},a$t.setTransform=function(a$t){this._tf="none"!==a$t&&a$t?a$t:a$v._TF_EMPTY},a$t.setTranslateX=function(a$t){this._tf===a$v._TF_EMPTY&&(this._tf=new a$Q),this._tf.translateX=a$t},a$t.setTranslateY=function(a$t){this._tf===a$v._TF_EMPTY&&(this._tf=new a$Q),this._tf.translateY=a$t},a$t.setScaleX=function(a$t){this._tf===a$v._TF_EMPTY&&(this._tf=new a$Q),this._tf.scaleX=a$t},a$t.setScale=function(a$t,a$k){this._tf===a$v._TF_EMPTY&&(this._tf=new a$Q),this._tf.scaleX=a$t,this._tf.scaleY=a$k},a$t.setScaleY=function(a$t){this._tf===a$v._TF_EMPTY&&(this._tf=new a$Q),this._tf.scaleY=a$t},a$t.setRotate=function(a$t){this._tf===a$v._TF_EMPTY&&(this._tf=new a$Q),this._tf.rotate=a$t},a$t.setSkewX=function(a$t){this._tf===a$v._TF_EMPTY&&(this._tf=new a$Q),this._tf.skewX=a$t},a$t.setSkewY=function(a$t){this._tf===a$v._TF_EMPTY&&(this._tf=new a$Q),this._tf.skewY=a$t},a$t.destroy=function(){this.scrollRect=null},a$t.render=function(a$t,a$k,a$v,a$j){},a$t.getCSSStyle=function(){return a$kt.EMPTY},a$t._enableLayout=function(){return!1},a$A(0,a$t,"scaleX",function(){return this._tf.scaleX},function(a$t){this.setScaleX(a$t)}),a$A(0,a$t,"transform",function(){return this.getTransform()},function(a$t){this.setTransform(a$t)}),a$A(0,a$t,"translateX",function(){return this._tf.translateX},function(a$t){this.setTranslateX(a$t)}),a$A(0,a$t,"translateY",function(){return this._tf.translateY},function(a$t){this.setTranslateY(a$t)}),a$A(0,a$t,"scaleY",function(){return this._tf.scaleY},function(a$t){this.setScaleY(a$t)}),a$A(0,a$t,"block",function(){return 0!=(1&this._type)}),a$A(0,a$t,"skewY",function(){return this._tf.skewY},function(a$t){this.setSkewY(a$t)}),a$A(0,a$t,"rotate",function(){return this._tf.rotate},function(a$t){this.setRotate(a$t)}),a$A(0,a$t,"skewX",function(){return this._tf.skewX},function(a$t){this.setSkewX(a$t)}),a$A(0,a$t,"paddingLeft",function(){return 0}),a$A(0,a$t,"paddingTop",function(){return 0}),a$A(0,a$t,"absolute",function(){return!0}),a$v.__init__=function(){a$v._TF_EMPTY=new a$Q,a$v.EMPTY=new a$v},a$v.EMPTY=null,a$v._TF_EMPTY=null,a$v}(),a$E=function(){function a$k(a$t){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=a$D.create(a$k.defaultColor),this.family=a$k.defaultFamily,this.stroke=a$k._STROKE,this.size=a$k.defaultSize,a$t&&a$t!==a$k.EMPTY&&a$t.copyTo(this)}a$w(a$k,"laya.display.css.Font");var a$t=a$k.prototype;return a$t.set=function(a$t){this._text=null;for(var a$k=a$t.split(" "),a$v=0,a$j=a$k.length;a$v<a$j;a$v++){var a$Q=a$k[a$v];switch(a$Q){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<a$Q.indexOf("px")&&(this.size=parseInt(a$Q),this.family=a$k[a$v+1],a$v++)}},a$t.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},a$t.copyTo=function(a$t){a$t._type=this._type,a$t._text=this._text,a$t._weight=this._weight,a$t._color=this._color,a$t.family=this.family,a$t.stroke=this.stroke!=a$k._STROKE?this.stroke.slice():a$k._STROKE,a$t.indent=this.indent,a$t.size=this.size},a$A(0,a$t,"password",function(){return 0!=(1024&this._type)},function(a$t){a$t?this._type|=1024:this._type&=-1025}),a$A(0,a$t,"color",function(){return this._color.strColor},function(a$t){this._color=a$D.create(a$t)}),a$A(0,a$t,"italic",function(){return 0!=(512&this._type)},function(a$t){a$t?this._type|=512:this._type&=-513}),a$A(0,a$t,"bold",function(){return 0!=(2048&this._type)},function(a$t){a$t?this._type|=2048:this._type&=-2049}),a$A(0,a$t,"weight",function(){return""+this._weight},function(a$t){var a$k=0;switch(a$t){case"normal":break;case"bold":this.bold=!0,a$k=700;break;case"bolder":a$k=800;break;case"lighter":a$k=100;break;default:a$k=parseInt(a$t)}this._weight=a$k,this._text=null}),a$A(0,a$t,"decoration",function(){return this._decoration?this._decoration.value:null},function(a$t){var a$k=a$t.split(" ");switch(this._decoration||(this._decoration={}),a$k[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=a$k[0]}a$k[1]&&(this._decoration.color=a$D.create(a$k)),this._decoration.value=a$t}),a$k.__init__=function(){a$k.EMPTY=new a$k(null)},a$k.EMPTY=null,a$k.defaultColor="#000000",a$k.defaultSize=12,a$k.defaultFamily="Arial",a$k.defaultFont="12px Arial",a$k._STROKE=[0,"#000000"],a$k._ITALIC=512,a$k._PASSWORD=1024,a$k._BOLD=2048,a$k}(),a$Q=function(){function a$t(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return a$w(a$t,"laya.display.css.TransformInfo"),a$t}(),a$H=function(){function a$M(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,a$c.isConchNode){this._nativeObj=new a$S._conchGraphics,this.id=this._nativeObj.conchID}}a$w(a$M,"laya.display.Graphics");var a$t=a$M.prototype;return a$t.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},a$t.clear=function(a$t){void 0===a$t&&(a$t=!1);var a$k=0,a$v=0;if(a$t){var a$j=this._one;if(this._cmds){for(a$v=this._cmds.length,a$k=0;a$k<a$v;a$k++)!(a$j=this._cmds[a$k])||a$j.callee!==a$c._context._drawTexture&&a$j.callee!==a$c._context._drawTextureWithTransform||(a$j[0]=null,a$M._cache.push(a$j));this._cmds.length=0}else a$j&&(!a$j||a$j.callee!==a$c._context._drawTexture&&a$j.callee!==a$c._context._drawTextureWithTransform||(a$j[0]=null,a$M._cache.push(a$j)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(a$k=0,a$v=this._vectorgraphArray.length;a$k<a$v;a$k++)a$$.getInstance().deleteShape(this._vectorgraphArray[a$k]);this._vectorgraphArray.length=0}},a$t._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},a$t._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new a$v,this._graphicBounds._graphics=this)},a$t._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},a$t._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},a$t.getBounds=function(a$t){return void 0===a$t&&(a$t=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(a$t)},a$t.getBoundPoints=function(a$t){return void 0===a$t&&(a$t=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(a$t)},a$t._addCmd=function(a$t){this._cmds=this._cmds||[],a$t.callee=a$t.shift(),this._cmds.push(a$t)},a$t.setFilters=function(a$t){this._saveToCmd(a$c._context._setFilters,a$t)},a$t.drawTexture=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){if(void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=0),void 0===a$Q&&(a$Q=0),void 0===a$S&&(a$S=1),!a$t||a$S<.01)return null;a$j||(a$j=a$t.sourceWidth),a$Q||(a$Q=a$t.sourceHeight),a$S=a$S<0?0:1<a$S?1:a$S;var a$V,a$J=!a$c.isWebGL&&(a$_.onFirefox||a$_.onEdge||a$_.onIE||a$_.onSafari)?.5:0,a$W=a$j/a$t.sourceWidth,a$w=a$Q/a$t.sourceHeight;return a$j=a$t.width*a$W,a$Q=a$t.height*a$w,a$t.loaded&&(a$j<=0||a$Q<=0)?null:(a$k+=a$t.offsetX*a$W,a$v+=a$t.offsetY*a$w,this._sp&&(this._sp._renderType|=512),a$k-=a$J,a$v-=a$J,a$j+=2*a$J,a$Q+=2*a$J,a$M._cache.length?((a$V=a$M._cache.pop())[0]=a$t,a$V[1]=a$k,a$V[2]=a$v,a$V[3]=a$j,a$V[4]=a$Q,a$V[5]=a$u,a$V[6]=a$S):a$V=[a$t,a$k,a$v,a$j,a$Q,a$u,a$S],a$V.callee=a$u||1!=a$S?a$c._context._drawTextureWithTransform:a$c._context._drawTexture,null!=this._one||a$u||1!=a$S?this._saveToCmd(a$V.callee,a$V):(this._one=a$V,this._render=this._renderOneImg),a$t.loaded||a$t.once("loaded",this,this._textureLoaded,[a$t,a$V]),this._repaint(),a$V)},a$t.cleanByTexture=function(a$t,a$k,a$v,a$j,a$Q){if(void 0===a$j&&(a$j=0),void 0===a$Q&&(a$Q=0),!a$t)return this.clear();if(this._one&&this._render===this._renderOneImg){a$j||(a$j=a$t.sourceWidth),a$Q||(a$Q=a$t.sourceHeight);var a$u=a$j/a$t.sourceWidth,a$S=a$Q/a$t.sourceHeight;a$j=a$t.width*a$u,a$Q=a$t.height*a$S,a$k+=a$t.offsetX*a$u,a$v+=a$t.offsetY*a$S,this._one[0]=a$t,this._one[1]=a$k,this._one[2]=a$v,this._one[3]=a$j,this._one[4]=a$Q,this._repaint()}else this.clear(),a$t&&this.drawTexture(a$t,a$k,a$v,a$j,a$Q)},a$t.drawTextures=function(a$t,a$k){a$t&&this._saveToCmd(a$c._context._drawTextures,[a$t,a$k])},a$t.fillTexture=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){if(void 0===a$j&&(a$j=0),void 0===a$Q&&(a$Q=0),void 0===a$u&&(a$u="repeat"),a$t){var a$V=[a$t,a$k,a$v,a$j,a$Q,a$u,a$S||a$m.EMPTY,{}];a$t.loaded||a$t.once("loaded",this,this._textureLoaded,[a$t,a$V]),this._saveToCmd(a$c._context._fillTexture,a$V)}},a$t._textureLoaded=function(a$t,a$k){a$k[3]=a$k[3]||a$t.width,a$k[4]=a$k[4]||a$t.height,this._repaint()},a$t.fillCircle=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){a$v.bitmap.enableMerageInAtlas=!1;var a$V=new Float32Array(2*(a$S+1)),a$J=new Float32Array(2*(a$S+1)),a$W=new Uint16Array(3*a$S),a$w=2*Math.PI/a$S,a$M=0;a$V[0]=a$j,a$V[1]=a$Q,a$J[0]=a$j/a$v.width,a$J[1]=a$Q/a$v.height;for(var a$H=2,a$E=0;a$E<a$S;a$E++){var a$A=a$u*Math.cos(a$M)+a$j,a$R=a$u*Math.sin(a$M)+a$Q;a$V[a$H]=a$A,a$V[a$H+1]=a$R,a$J[a$H]=a$A/a$v.width,a$J[a$H+1]=a$R/a$v.height,a$M+=a$w,a$H+=2}for(a$E=a$H=0;a$E<a$S;a$E++)a$W[a$H++]=0,a$W[a$H++]=a$E+1,a$W[a$H++]=a$S+1<=a$E+2?1:a$E+2;this.drawTriangles(a$v,a$t,a$k,a$V,a$J,a$W)},a$t.drawTriangles=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){void 0===a$V&&(a$V=1),this._saveToCmd(a$c._context.drawTriangles,[a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W])},a$t._saveToCmd=function(a$t,a$k){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=a$k,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(a$k)),a$k.callee=a$t,this._repaint(),a$k},a$t.clipRect=function(a$t,a$k,a$v,a$j){this._saveToCmd(a$c._context._clipRect,[a$t,a$k,a$v,a$j])},a$t.fillText=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){void 0===a$S&&(a$S=0),this._saveToCmd(a$c._context._fillText,[a$t,a$k,a$v,a$j||a$E.defaultFont,a$Q,a$u])},a$t.fillBorderText=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){this._saveToCmd(a$c._context._fillBorderText,[a$t,a$k,a$v,a$j||a$E.defaultFont,a$Q,a$u,a$S,a$V])},a$t.strokeText=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this._saveToCmd(a$c._context._strokeText,[a$t,a$k,a$v,a$j||a$E.defaultFont,a$Q,a$u,a$S])},a$t.alpha=function(a$t){a$t=a$t<0?0:1<a$t?1:a$t,this._saveToCmd(a$c._context._alpha,[a$t])},a$t.setAlpha=function(a$t){a$t=a$t<0?0:1<a$t?1:a$t,this._saveToCmd(a$c._context._setAlpha,[a$t])},a$t.transform=function(a$t,a$k,a$v){void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),this._saveToCmd(a$c._context._transform,[a$t,a$k,a$v])},a$t.rotate=function(a$t,a$k,a$v){void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),this._saveToCmd(a$c._context._rotate,[a$t,a$k,a$v])},a$t.scale=function(a$t,a$k,a$v,a$j){void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=0),this._saveToCmd(a$c._context._scale,[a$t,a$k,a$v,a$j])},a$t.translate=function(a$t,a$k){this._saveToCmd(a$c._context._translate,[a$t,a$k])},a$t.save=function(){this._saveToCmd(a$c._context._save,[])},a$t.restore=function(){this._saveToCmd(a$c._context._restore,[])},a$t.replaceText=function(a$t){this._repaint();var a$k=this._cmds;if(a$k){for(var a$v=a$k.length-1;-1<a$v;a$v--)if(this._isTextCmd(a$k[a$v].callee))return a$k[a$v][0].toUpperCase?a$k[a$v][0]=a$t:a$k[a$v][0].setText(a$t),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=a$t:this._one[0].setText(a$t),!0;return!1},a$t._isTextCmd=function(a$t){return a$t===a$c._context._fillText||a$t===a$c._context._fillBorderText||a$t===a$c._context._strokeText},a$t.replaceTextColor=function(a$t){this._repaint();var a$k=this._cmds;if(a$k)for(var a$v=a$k.length-1;-1<a$v;a$v--)this._isTextCmd(a$k[a$v].callee)&&(a$k[a$v][4]=a$t,a$k[a$v][0].toUpperCase||(a$k[a$v][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=a$t,this._one[0].toUpperCase||(this._one[0].changed=!0))},a$t.loadImage=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=this;void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=0),void 0===a$Q&&(a$Q=0);var a$V=a$Vt.getRes(a$t);function a$J(a$t){a$t&&(a$S.drawTexture(a$t,a$k,a$v,a$j,a$Q),null!=a$u&&a$u.call(a$S._sp,a$t))}a$V?a$J(a$V):a$d.loader.load(a$t,a$o.create(null,a$J),null,"image")},a$t._renderEmpty=function(a$t,a$k,a$v,a$j){},a$t._renderAll=function(a$t,a$k,a$v,a$j){for(var a$Q,a$u=this._cmds,a$S=0,a$V=a$u.length;a$S<a$V;a$S++)(a$Q=a$u[a$S]).callee.call(a$k,a$v,a$j,a$Q)},a$t._renderOne=function(a$t,a$k,a$v,a$j){this._one.callee.call(a$k,a$v,a$j,this._one)},a$t._renderOneImg=function(a$t,a$k,a$v,a$j){this._one.callee.call(a$k,a$v,a$j,this._one),2305!==a$t._renderType&&(a$t._renderType|=1)},a$t.drawLine=function(a$t,a$k,a$v,a$j,a$Q,a$u){void 0===a$u&&(a$u=1);var a$S=0;a$c.isWebGL&&(a$S=a$$.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(a$S));var a$V=a$u%2==0?0:.5,a$J=[a$t+a$V,a$k+a$V,a$v+a$V,a$j+a$V,a$Q,a$u,a$S];this._saveToCmd(a$c._context._drawLine,a$J)},a$t.drawLines=function(a$t,a$k,a$v,a$j,a$Q){void 0===a$Q&&(a$Q=1);var a$u=0;if(a$v&&!(a$v.length<4)){a$c.isWebGL&&(a$u=a$$.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(a$u));var a$S=a$Q%2==0?0:.5,a$V=[a$t+a$S,a$k+a$S,a$v,a$j,a$Q,a$u];this._saveToCmd(a$c._context._drawLines,a$V)}},a$t.drawCurves=function(a$t,a$k,a$v,a$j,a$Q){void 0===a$Q&&(a$Q=1);var a$u=[a$t,a$k,a$v,a$j,a$Q];this._saveToCmd(a$c._context._drawCurves,a$u)},a$t.drawRect=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){void 0===a$S&&(a$S=1);var a$V=a$u?a$S/2:0,a$J=a$u?a$S:0,a$W=[a$t+a$V,a$k+a$V,a$v-a$J,a$j-a$J,a$Q,a$u,a$S];this._saveToCmd(a$c._context._drawRect,a$W)},a$t.drawCircle=function(a$t,a$k,a$v,a$j,a$Q,a$u){void 0===a$u&&(a$u=1);var a$S=a$Q?a$u/2:0,a$V=0;a$c.isWebGL&&(a$V=a$$.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(a$V));var a$J=[a$t,a$k,a$v-a$S,a$j,a$Q,a$u,a$V];this._saveToCmd(a$c._context._drawCircle,a$J)},a$t.drawPie=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){void 0===a$V&&(a$V=1);var a$J=a$S?a$V/2:0,a$W=a$S?a$V:0,a$w=0;a$c.isWebGL&&(a$w=a$$.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(a$w));var a$M=[a$t+a$J,a$k+a$J,a$v-a$W,a$j,a$Q,a$u,a$S,a$V,a$w];a$M[3]=a$g.toRadian(a$j),a$M[4]=a$g.toRadian(a$Q),this._saveToCmd(a$c._context._drawPie,a$M)},a$t.drawPoly=function(a$t,a$k,a$v,a$j,a$Q,a$u){void 0===a$u&&(a$u=1);var a$S=0,a$V=!1;a$c.isWebGL&&(a$S=a$$.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(a$S),a$V=!(6<a$v.length));var a$J=a$Q?a$u%2==0?0:.5:0,a$W=[a$t+a$J,a$k+a$J,a$v,a$j,a$Q,a$u,a$S,a$V];this._saveToCmd(a$c._context._drawPoly,a$W)},a$t.drawPath=function(a$t,a$k,a$v,a$j,a$Q){var a$u=[a$t,a$k,a$v,a$j,a$Q];this._saveToCmd(a$c._context._drawPath,a$u)},a$A(0,a$t,"cmds",function(){return this._cmds},function(a$t){this._sp&&(this._sp._renderType|=512),this._cmds=a$t,this._render=this._renderAll,this._repaint()}),a$M.__init__=function(){if(a$c.isConchNode){for(var a$t=laya.display.Graphics.prototype,a$k=a$_.window.ConchGraphics.prototype,a$v=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],a$j=0,a$Q=a$v.length;a$j<=a$Q;a$j++){var a$u=a$v[a$j];a$t[a$u]=a$k[a$u]}a$t._saveToCmd=null,a$k.drawImageS&&(a$t.drawTextures=function(a$t,a$k){if(a$t&&a$t.loaded&&a$t.bitmap&&a$t.source){var a$v=a$t.uv,a$j=a$t.bitmap.width,a$Q=a$t.bitmap.height;this.drawImageS(a$t.bitmap.source,a$v[0]*a$j,a$v[1]*a$Q,(a$v[2]-a$v[0])*a$j,(a$v[5]-a$v[3])*a$Q,a$t.offsetX,a$t.offsetY,a$t.width,a$t.height,a$k)}}),a$t.drawTexture=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){if(void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=0),void 0===a$Q&&(a$Q=0),void 0===a$S&&(a$S=1),a$t)if(a$t.loaded){if(a$t.loaded&&a$t.bitmap&&a$t.source&&(a$j||(a$j=a$t.sourceWidth),a$Q||(a$Q=a$t.sourceHeight),a$S=a$S<0?0:1<a$S?1:a$S,a$j=a$j-a$t.sourceWidth+a$t.width,a$Q=a$Q-a$t.sourceHeight+a$t.height,!(a$j<=0||a$Q<=0))){a$k+=a$t.offsetX,a$v+=a$t.offsetY;var a$V=a$t.uv,a$J=a$t.bitmap.width,a$W=a$t.bitmap.height;a$V[4]<a$V[0]&&a$V[5]<a$V[1]?this.drawImageM(a$t.bitmap.source,a$V[4]*a$J,a$V[5]*a$W,(a$V[0]-a$V[4])*a$J,(a$V[1]-a$V[5])*a$W,a$k,a$v,a$j,a$Q,a$u,a$S):this.drawImageM(a$t.bitmap.source,a$V[0]*a$J,a$V[1]*a$W,(a$V[2]-a$V[0])*a$J,(a$V[5]-a$V[3])*a$W,a$k,a$v,a$j,a$Q,a$u,a$S),this._repaint()}}else a$t.once("loaded",this,function(){this.drawTexture(a$t,a$k,a$v,a$j,a$Q,a$u)})},a$t.fillTexture=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){if(void 0===a$j&&(a$j=0),void 0===a$Q&&(a$Q=0),void 0===a$u&&(a$u="repeat"),a$t&&a$t.loaded){var a$V,a$J=a$c._context.ctx,a$W=a$t.bitmap.width,a$w=a$t.bitmap.height,a$M=a$t.uv;a$V=a$t.uv!=a$wt.DEF_UV?a$J.createPattern(a$t.bitmap.source,a$u,a$M[0]*a$W,a$M[1]*a$w,(a$M[2]-a$M[0])*a$W,(a$M[5]-a$M[3])*a$w):a$J.createPattern(a$t.bitmap.source,a$u);var a$H=0,a$E=0;a$S&&(a$k+=a$S.x%a$t.width,a$v+=a$S.y%a$t.height,a$H-=a$S.x%a$t.width,a$E-=a$S.y%a$t.height),this._fillImage(a$V,a$k,a$v,a$H,a$E,a$j,a$Q)}}}},a$M._cache=[],a$M}(),a$v=function(){function a$Y(){this._cacheBoundsType=!1}a$w(a$Y,"laya.display.GraphicsBounds");var a$t=a$Y.prototype;return a$t.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},a$t.reset=function(){this._temp&&(this._temp.length=0)},a$t.getBounds=function(a$t){return void 0===a$t&&(a$t=!1),(!this._bounds||!this._temp||this._temp.length<1||a$t!=this._cacheBoundsType)&&(this._bounds=a$Z._getWrapRec(this.getBoundPoints(a$t),this._bounds)),this._cacheBoundsType=a$t,this._bounds},a$t.getBoundPoints=function(a$t){return void 0===a$t&&(a$t=!1),(!this._temp||this._temp.length<1||a$t!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(a$t)),this._cacheBoundsType=a$t,this._rstBoundPoints=a$g.copyArray(this._rstBoundPoints,this._temp)},a$t._getCmdPoints=function(a$t){void 0===a$t&&(a$t=!1);var a$k,a$v,a$j=a$c._context,a$Q=this._graphics.cmds;if((a$k=this._temp||(this._temp=[])).length=0,a$Q||null==this._graphics._one||(a$Y._tempCmds.length=0,a$Y._tempCmds.push(this._graphics._one),a$Q=a$Y._tempCmds),!a$Q)return a$k;(a$v=a$Y._tempMatrixArrays).length=0;var a$u=a$Y._initMatrix;a$u.identity();for(var a$S,a$V,a$J=a$Y._tempMatrix,a$W=NaN,a$w=NaN,a$M=NaN,a$H=NaN,a$E=NaN,a$A=NaN,a$R=0,a$h=a$Q.length;a$R<a$h;a$R++)if((a$S=a$Q[a$R]).callee)switch(a$S.callee){case a$j._save:case 7:a$v.push(a$u),a$u=a$u.clone();break;case a$j._restore:case 8:a$u=a$v.pop();break;case a$j._scale:case 5:a$J.identity(),a$J.translate(-a$S[2],-a$S[3]),a$J.scale(a$S[0],a$S[1]),a$J.translate(a$S[2],a$S[3]),this._switchMatrix(a$u,a$J);break;case a$j._rotate:case 3:a$J.identity(),a$J.translate(-a$S[1],-a$S[2]),a$J.rotate(a$S[0]),a$J.translate(a$S[1],a$S[2]),this._switchMatrix(a$u,a$J);break;case a$j._translate:case 6:a$J.identity(),a$J.translate(a$S[0],a$S[1]),this._switchMatrix(a$u,a$J);break;case a$j._transform:case 4:a$J.identity(),a$J.translate(-a$S[1],-a$S[2]),a$J.concat(a$S[0]),a$J.translate(a$S[1],a$S[2]),this._switchMatrix(a$u,a$J);break;case 16:case 24:a$Y._addPointArrToRst(a$k,a$Z._getBoundPointS(a$S[0],a$S[1],a$S[2],a$S[3]),a$u);break;case 17:a$u.copyTo(a$J),a$J.concat(a$S[4]),a$Y._addPointArrToRst(a$k,a$Z._getBoundPointS(a$S[0],a$S[1],a$S[2],a$S[3]),a$J);break;case a$j._drawTexture:a$V=a$S[0],a$t?a$S[3]&&a$S[4]?a$Y._addPointArrToRst(a$k,a$Z._getBoundPointS(a$S[1],a$S[2],a$S[3],a$S[4]),a$u):(a$V=a$S[0],a$Y._addPointArrToRst(a$k,a$Z._getBoundPointS(a$S[1],a$S[2],a$V.width,a$V.height),a$u)):(a$W=(a$S[3]||a$V.sourceWidth)/a$V.width,a$w=(a$S[4]||a$V.sourceHeight)/a$V.height,a$M=a$W*a$V.sourceWidth,a$H=a$w*a$V.sourceHeight,a$E=0<a$V.offsetX?a$V.offsetX:0,a$A=0<a$V.offsetY?a$V.offsetY:0,a$E*=a$W,a$A*=a$w,a$Y._addPointArrToRst(a$k,a$Z._getBoundPointS(a$S[1]-a$E,a$S[2]-a$A,a$M,a$H),a$u));break;case a$j._fillTexture:a$S[3]&&a$S[4]?a$Y._addPointArrToRst(a$k,a$Z._getBoundPointS(a$S[1],a$S[2],a$S[3],a$S[4]),a$u):(a$V=a$S[0],a$Y._addPointArrToRst(a$k,a$Z._getBoundPointS(a$S[1],a$S[2],a$V.width,a$V.height),a$u));break;case a$j._drawTextureWithTransform:var a$l;a$l=a$S[5]?(a$u.copyTo(a$J),a$J.concat(a$S[5]),a$J):a$u,a$t?a$S[3]&&a$S[4]?a$Y._addPointArrToRst(a$k,a$Z._getBoundPointS(a$S[1],a$S[2],a$S[3],a$S[4]),a$l):(a$V=a$S[0],a$Y._addPointArrToRst(a$k,a$Z._getBoundPointS(a$S[1],a$S[2],a$V.width,a$V.height),a$l)):(a$V=a$S[0],a$W=(a$S[3]||a$V.sourceWidth)/a$V.width,a$w=(a$S[4]||a$V.sourceHeight)/a$V.height,a$M=a$W*a$V.sourceWidth,a$H=a$w*a$V.sourceHeight,a$E=0<a$V.offsetX?a$V.offsetX:0,a$A=0<a$V.offsetY?a$V.offsetY:0,a$E*=a$W,a$A*=a$w,a$Y._addPointArrToRst(a$k,a$Z._getBoundPointS(a$S[1]-a$E,a$S[2]-a$A,a$M,a$H),a$l));break;case a$j._drawRect:case 13:a$Y._addPointArrToRst(a$k,a$Z._getBoundPointS(a$S[0],a$S[1],a$S[2],a$S[3]),a$u);break;case a$j._drawCircle:case a$j._fillCircle:case 14:a$Y._addPointArrToRst(a$k,a$Z._getBoundPointS(a$S[0]-a$S[2],a$S[1]-a$S[2],a$S[2]+a$S[2],a$S[2]+a$S[2]),a$u);break;case a$j._drawLine:case 20:a$Y._tempPoints.length=0;var a$o;a$o=.5*a$S[5],a$S[0]==a$S[2]?a$Y._tempPoints.push(a$S[0]+a$o,a$S[1],a$S[2]+a$o,a$S[3],a$S[0]-a$o,a$S[1],a$S[2]-a$o,a$S[3]):a$S[1]==a$S[3]?a$Y._tempPoints.push(a$S[0],a$S[1]+a$o,a$S[2],a$S[3]+a$o,a$S[0],a$S[1]-a$o,a$S[2],a$S[3]-a$o):a$Y._tempPoints.push(a$S[0],a$S[1],a$S[2],a$S[3]),a$Y._addPointArrToRst(a$k,a$Y._tempPoints,a$u);break;case a$j._drawCurves:case 22:a$Y._addPointArrToRst(a$k,a$f.I.getBezierPoints(a$S[2]),a$u,a$S[0],a$S[1]);break;case a$j._drawPoly:case a$j._drawLines:case 18:a$Y._addPointArrToRst(a$k,a$S[2],a$u,a$S[0],a$S[1]);break;case a$j._drawPath:case 19:a$Y._addPointArrToRst(a$k,this._getPathPoints(a$S[2]),a$u,a$S[0],a$S[1]);break;case a$j._drawPie:case 15:a$Y._addPointArrToRst(a$k,this._getPiePoints(a$S[0],a$S[1],a$S[2],a$S[3],a$S[4]),a$u)}return 200<a$k.length?a$k=a$g.copyArray(a$k,a$Z._getWrapRec(a$k)._getBoundPoints()):8<a$k.length&&(a$k=a$X.scanPList(a$k)),a$k},a$t._switchMatrix=function(a$t,a$k){a$k.concat(a$t),a$k.copyTo(a$t)},a$t._getPiePoints=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$Y._tempPoints;a$Y._tempPoints.length=0,a$u.push(a$t,a$k);var a$S=(a$Q-a$j)%(2*Math.PI)/10,a$V=NaN,a$J=a$j;for(a$V=0;a$V<=10;a$V++)a$u.push(a$t+a$v*Math.cos(a$J),a$k+a$v*Math.sin(a$J)),a$J+=a$S;return a$u},a$t._getPathPoints=function(a$t){var a$k,a$v,a$j=0,a$Q=a$Y._tempPoints;for(a$Q.length=0,a$k=a$t.length,a$j=0;a$j<a$k;a$j++)1<(a$v=a$t[a$j]).length&&(a$Q.push(a$v[1],a$v[2]),3<a$v.length&&a$Q.push(a$v[3],a$v[4]));return a$Q},a$Y._addPointArrToRst=function(a$t,a$k,a$v,a$j,a$Q){void 0===a$j&&(a$j=0),void 0===a$Q&&(a$Q=0);var a$u,a$S=0;for(a$u=a$k.length,a$S=0;a$S<a$u;a$S+=2)a$Y._addPointToRst(a$t,a$k[a$S]+a$j,a$k[a$S+1]+a$Q,a$v)},a$Y._addPointToRst=function(a$t,a$k,a$v,a$j){var a$Q=a$m.TEMP;a$Q.setTo(a$k||0,a$v||0),a$j.transformPoint(a$Q),a$t.push(a$Q.x,a$Q.y)},a$Y._tempPoints=[],a$Y._tempMatrixArrays=[],a$Y._tempCmds=[],a$J(a$Y,["_tempMatrix",function(){return this._tempMatrix=new a$a},"_initMatrix",function(){return this._initMatrix=new a$a}]),a$Y}(),a$u=function(){function a$t(){}a$w(a$t,"laya.events.Event");var a$k=a$t.prototype;return a$k.setTo=function(a$t,a$k,a$v){return this.type=a$t,this.currentTarget=a$k,this.target=a$v,this},a$k.stopPropagation=function(){this._stoped=!0},a$A(0,a$k,"stageY",function(){return a$d.stage.mouseY}),a$A(0,a$k,"charCode",function(){return this.nativeEvent.charCode}),a$A(0,a$k,"touches",function(){var a$t=this.nativeEvent.touches;if(a$t)for(var a$k=a$d.stage,a$v=0,a$j=a$t.length;a$v<a$j;a$v++){var a$Q=a$t[a$v],a$u=a$m.TEMP;a$u.setTo(a$Q.clientX,a$Q.clientY),a$k._canvasTransform.invertTransformPoint(a$u),a$k.transform.invertTransformPoint(a$u),a$Q.stageX=a$u.x,a$Q.stageY=a$u.y}return a$t}),a$A(0,a$k,"keyLocation",function(){return this.nativeEvent.keyLocation}),a$A(0,a$k,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),a$A(0,a$k,"altKey",function(){return this.nativeEvent.altKey}),a$A(0,a$k,"shiftKey",function(){return this.nativeEvent.shiftKey}),a$A(0,a$k,"stageX",function(){return a$d.stage.mouseX}),a$t.EMPTY=new a$t,a$t.MOUSE_DOWN="mousedown",a$t.MOUSE_UP="mouseup",a$t.CLICK="click",a$t.RIGHT_MOUSE_DOWN="rightmousedown",a$t.RIGHT_MOUSE_UP="rightmouseup",a$t.RIGHT_CLICK="rightclick",a$t.MOUSE_MOVE="mousemove",a$t.MOUSE_OVER="mouseover",a$t.MOUSE_OUT="mouseout",a$t.MOUSE_WHEEL="mousewheel",a$t.ROLL_OVER="mouseover",a$t.ROLL_OUT="mouseout",a$t.DOUBLE_CLICK="doubleclick",a$t.CHANGE="change",a$t.CHANGED="changed",a$t.RESIZE="resize",a$t.ADDED="added",a$t.REMOVED="removed",a$t.DISPLAY="display",a$t.UNDISPLAY="undisplay",a$t.ERROR="error",a$t.COMPLETE="complete",a$t.LOADED="loaded",a$t.INITED="inited",a$t.PROGRESS="progress",a$t.INPUT="input",a$t.RENDER="render",a$t.OPEN="open",a$t.MESSAGE="message",a$t.CLOSE="close",a$t.KEY_DOWN="keydown",a$t.KEY_PRESS="keypress",a$t.KEY_UP="keyup",a$t.FRAME="enterframe",a$t.DRAG_START="dragstart",a$t.DRAG_MOVE="dragmove",a$t.DRAG_END="dragend",a$t.ENTER="enter",a$t.SELECT="select",a$t.BLUR="blur",a$t.FOCUS="focus",a$t.VISIBILITY_CHANGE="visibilitychange",a$t.FOCUS_CHANGE="focuschange",a$t.PLAYED="played",a$t.PAUSED="paused",a$t.STOPPED="stopped",a$t.START="start",a$t.END="end",a$t.ENABLE_CHANGED="enablechanged",a$t.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",a$t.COMPONENT_ADDED="componentadded",a$t.COMPONENT_REMOVED="componentremoved",a$t.LAYER_CHANGED="layerchanged",a$t.HIERARCHY_LOADED="hierarchyloaded",a$t.RECOVERED="recovered",a$t.RELEASED="released",a$t.LINK="link",a$t.LABEL="label",a$t.FULL_SCREEN_CHANGE="fullscreenchange",a$t.DEVICE_LOST="devicelost",a$t.MESH_CHANGED="meshchanged",a$t.MATERIAL_CHANGED="materialchanged",a$t.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",a$t.ANIMATION_CHANGED="animationchanged",a$t.TRIGGER_ENTER="triggerenter",a$t.TRIGGER_STAY="triggerstay",a$t.TRIGGER_EXIT="triggerexit",a$t.TRAIL_FILTER_CHANGE="trailfilterchange",a$t.DOMINO_FILTER_CHANGE="dominofilterchange",a$t}(),a$M=(function(){function a$t(){}a$w(a$t,"laya.events.Keyboard"),a$t.NUMBER_0=48,a$t.NUMBER_1=49,a$t.NUMBER_2=50,a$t.NUMBER_3=51,a$t.NUMBER_4=52,a$t.NUMBER_5=53,a$t.NUMBER_6=54,a$t.NUMBER_7=55,a$t.NUMBER_8=56,a$t.NUMBER_9=57,a$t.A=65,a$t.B=66,a$t.C=67,a$t.D=68,a$t.E=69,a$t.F=70,a$t.G=71,a$t.H=72,a$t.I=73,a$t.J=74,a$t.K=75,a$t.L=76,a$t.M=77,a$t.N=78,a$t.O=79,a$t.P=80,a$t.Q=81,a$t.R=82,a$t.S=83,a$t.T=84,a$t.U=85,a$t.V=86,a$t.W=87,a$t.X=88,a$t.Y=89,a$t.Z=90,a$t.F1=112,a$t.F2=113,a$t.F3=114,a$t.F4=115,a$t.F5=116,a$t.F6=117,a$t.F7=118,a$t.F8=119,a$t.F9=120,a$t.F10=121,a$t.F11=122,a$t.F12=123,a$t.F13=124,a$t.F14=125,a$t.F15=126,a$t.NUMPAD=21,a$t.NUMPAD_0=96,a$t.NUMPAD_1=97,a$t.NUMPAD_2=98,a$t.NUMPAD_3=99,a$t.NUMPAD_4=100,a$t.NUMPAD_5=101,a$t.NUMPAD_6=102,a$t.NUMPAD_7=103,a$t.NUMPAD_8=104,a$t.NUMPAD_9=105,a$t.NUMPAD_ADD=107,a$t.NUMPAD_DECIMAL=110,a$t.NUMPAD_DIVIDE=111,a$t.NUMPAD_ENTER=108,a$t.NUMPAD_MULTIPLY=106,a$t.NUMPAD_SUBTRACT=109,a$t.SEMICOLON=186,a$t.EQUAL=187,a$t.COMMA=188,a$t.MINUS=189,a$t.PERIOD=190,a$t.SLASH=191,a$t.BACKQUOTE=192,a$t.LEFTBRACKET=219,a$t.BACKSLASH=220,a$t.RIGHTBRACKET=221,a$t.QUOTE=222,a$t.ALTERNATE=18,a$t.BACKSPACE=8,a$t.CAPS_LOCK=20,a$t.COMMAND=15,a$t.CONTROL=17,a$t.DELETE=46,a$t.ENTER=13,a$t.ESCAPE=27,a$t.PAGE_UP=33,a$t.PAGE_DOWN=34,a$t.END=35,a$t.HOME=36,a$t.LEFT=37,a$t.UP=38,a$t.RIGHT=39,a$t.DOWN=40,a$t.SHIFT=16,a$t.SPACE=32,a$t.TAB=9,a$t.INSERT=45}(),function(){function a$Q(){}return a$w(a$Q,"laya.events.KeyBoardManager"),a$Q.__init__=function(){a$Q._addEvent("keydown"),a$Q._addEvent("keypress"),a$Q._addEvent("keyup")},a$Q._addEvent=function(a$k){a$_.document.addEventListener(a$k,function(a$t){laya.events.KeyBoardManager._dispatch(a$t,a$k)},!0)},a$Q._dispatch=function(a$t,a$k){if(a$Q.enabled){a$Q._event._stoped=!1,a$Q._event.nativeEvent=a$t,a$Q._event.keyCode=a$t.keyCode||a$t.which||a$t.charCode,"keydown"===a$k?a$Q._pressKeys[a$Q._event.keyCode]=!0:"keyup"===a$k&&(a$Q._pressKeys[a$Q._event.keyCode]=null);for(var a$v=a$d.stage.focus&&null!=a$d.stage.focus.event&&a$d.stage.focus.displayedInStage?a$d.stage.focus:a$d.stage,a$j=a$v;a$j;)a$j.event(a$k,a$Q._event.setTo(a$k,a$j,a$v)),a$j=a$j.parent}},a$Q.hasKeyDown=function(a$t){return a$Q._pressKeys[a$t]},a$Q._pressKeys={},a$Q.enabled=!0,a$J(a$Q,["_event",function(){return this._event=new a$u}]),a$Q}()),a$R=(function(){function a$t(){}a$w(a$t,"laya.events.KeyLocation"),a$t.STANDARD=0,a$t.LEFT=1,a$t.RIGHT=2,a$t.NUM_PAD=3}(),function(){function a$W(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=a$_.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new a$u,this._matrix=new a$a,this._point=new a$m,this._rect=new a$Z,this._prePoint=new a$m,this._curTouchID=NaN}a$w(a$W,"laya.events.MouseManager");var a$t=a$W.prototype;return a$t.__init__=function(a$t,a$k){var a$v=this;this._stage=a$t;var a$j=this,a$Q=this._eventList;a$k.oncontextmenu=function(a$t){if(a$W.enabled)return!1},a$k.addEventListener("mousedown",function(a$t){a$W.enabled&&(a$_.onIE||a$t.preventDefault(),a$Q.push(a$t),a$j.mouseDownTime=a$_.now())}),a$k.addEventListener("mouseup",function(a$t){a$W.enabled&&(a$t.preventDefault(),a$Q.push(a$t),a$j.mouseDownTime=-a$_.now())},!0),a$k.addEventListener("mousemove",function(a$t){if(a$W.enabled){a$t.preventDefault();var a$k=a$_.now();if(a$k-a$j._lastMoveTimer<10)return;a$j._lastMoveTimer=a$k,a$Q.push(a$t)}},!0),a$k.addEventListener("mouseout",function(a$t){a$W.enabled&&a$Q.push(a$t)}),a$k.addEventListener("mouseover",function(a$t){a$W.enabled&&a$Q.push(a$t)}),a$k.addEventListener("touchstart",function(a$t){a$W.enabled&&(a$Q.push(a$t),a$W._isFirstTouch||a$Xt.isInputting||a$t.preventDefault(),a$j.mouseDownTime=a$_.now())}),a$k.addEventListener("touchend",function(a$t){a$W.enabled?(a$W._isFirstTouch||a$Xt.isInputting||a$t.preventDefault(),a$W._isFirstTouch=!1,a$Q.push(a$t),a$j.mouseDownTime=-a$_.now()):a$v._curTouchID=NaN},!0),a$k.addEventListener("touchmove",function(a$t){a$W.enabled&&(a$t.preventDefault(),a$Q.push(a$t))},!0),a$k.addEventListener("touchcancel",function(a$t){a$W.enabled?(a$t.preventDefault(),a$Q.push(a$t)):a$v._curTouchID=NaN},!0),a$k.addEventListener("mousewheel",function(a$t){a$W.enabled&&a$Q.push(a$t)}),a$k.addEventListener("DOMMouseScroll",function(a$t){a$W.enabled&&a$Q.push(a$t)})},a$t.initEvent=function(a$t,a$k){var a$v;this._event._stoped=!1,this._event.nativeEvent=a$k||a$t,this._target=null,this._point.setTo(a$t.pageX||a$t.clientX,a$t.pageY||a$t.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=a$t.identifier||0,this._tTouchID=this._event.touchId,(a$v=a$h.I._event)._stoped=!1,a$v.nativeEvent=this._event.nativeEvent,a$v.touchId=this._event.touchId},a$t.checkMouseWheel=function(a$t){this._event.delta=a$t.wheelDelta?.025*a$t.wheelDelta:-a$t.detail;for(var a$k=a$h.I.getLastOvers(),a$v=0,a$j=a$k.length;a$v<a$j;a$v++){var a$Q=a$k[a$v];a$Q.event("mousewheel",this._event.setTo("mousewheel",a$Q,this._target))}},a$t.onMouseMove=function(a$t){a$h.I.onMouseMove(a$t,this._tTouchID)},a$t.onMouseDown=function(a$t){if(a$Xt.isInputting&&a$d.stage.focus&&a$d.stage.focus.focus&&!a$d.stage.focus.contains(this._target)){var a$k=a$d.stage.focus._tf||a$d.stage.focus,a$v=a$t._tf||a$t;a$v instanceof laya.display.Input&&a$v.multiline==a$k.multiline?a$k._focusOut():a$k.focus=!1}a$h.I.onMouseDown(a$t,this._tTouchID,this._isLeftMouse)},a$t.onMouseUp=function(a$t){a$h.I.onMouseUp(a$t,this._tTouchID,this._isLeftMouse)},a$t.check=function(a$t,a$k,a$v,a$j){this._point.setTo(a$k,a$v),a$t.fromParentPoint(this._point),a$k=this._point.x,a$v=this._point.y;var a$Q=a$t.scrollRect;if(a$Q&&(this._rect.setTo(a$Q.x,a$Q.y,a$Q.width,a$Q.height),!this._rect.contains(a$k,a$v)))return!1;if(!this.disableMouseEvent){if(a$t.hitTestPrior&&!a$t.mouseThrough&&!this.hitTest(a$t,a$k,a$v))return!1;for(var a$u=a$t._childs.length-1;-1<a$u;a$u--){var a$S=a$t._childs[a$u];if(!a$S.destroyed&&a$S.mouseEnabled&&a$S.visible&&this.check(a$S,a$k,a$v,a$j))return!0}}var a$V=!(!a$t.hitTestPrior||a$t.mouseThrough||this.disableMouseEvent)||this.hitTest(a$t,a$k,a$v);return a$V?(this._target=a$t,a$j.call(this,a$t)):a$j===this.onMouseUp&&a$t===this._stage&&(this._target=this._stage,a$j.call(this,this._target)),a$V},a$t.hitTest=function(a$t,a$k,a$v){var a$j=!1;if(a$t.scrollRect&&(a$k-=a$t.scrollRect.x,a$v-=a$t.scrollRect.y),a$t.hitArea instanceof laya.utils.HitArea)return a$t.hitArea.isHit(a$k,a$v);if(0<a$t.width&&0<a$t.height||a$t.mouseThrough||a$t.hitArea)if(a$t.mouseThrough)a$j=a$t.getGraphicBounds().contains(a$k,a$v);else{var a$Q=this._rect;a$t.hitArea?a$Q=a$t.hitArea:a$Q.setTo(0,0,a$t.width,a$t.height),a$j=a$Q.contains(a$k,a$v)}return a$j},a$t.runEvent=function(){var a$t=this._eventList.length;if(a$t){this.mouseEventTime=a$_.now();var a$k,a$v=0,a$j=0,a$Q=0;try{for(;a$v<a$t;){var a$u=this._eventList[a$v];switch("mousemove"!==a$u.type&&(this._prePoint.x=this._prePoint.y=-1e6),a$u.type){case"mousedown":this._touchIDs[0]=this._id++,a$W._isTouchRespond?a$W._isTouchRespond=!1:(this._isLeftMouse=0===a$u.button,this.initEvent(a$u),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===a$u.button,this.initEvent(a$u),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-a$u.clientX)+Math.abs(this._prePoint.y-a$u.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=a$u.clientX,this._prePoint.y=a$u.clientY,this.initEvent(a$u),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":a$W._isTouchRespond=!0,this._isLeftMouse=!0;var a$S=a$u.changedTouches;for(a$j=0,a$Q=a$S.length;a$j<a$Q;a$j++)a$k=a$S[a$j],(a$W.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=a$k.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[a$k.identifier]=this._id++,this.initEvent(a$k,a$u),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":a$W._isTouchRespond=!0,this._isLeftMouse=!0;var a$V=a$u.changedTouches;for(a$j=0,a$Q=a$V.length;a$j<a$Q;a$j++)if(a$k=a$V[a$j],a$W.multiTouchEnabled||a$k.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(a$k,a$u);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var a$J=a$u.changedTouches;for(a$j=0,a$Q=a$J.length;a$j<a$Q;a$j++)a$k=a$J[a$j],(a$W.multiTouchEnabled||a$k.identifier==this._curTouchID)&&(this.initEvent(a$k,a$u),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(a$u);break;case"mouseout":a$h.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}a$v++}}catch(a$t){throw this._eventList.length=0,a$t}this._eventList.length=0}},a$W.enabled=!0,a$W.multiTouchEnabled=!0,a$W._isTouchRespond=!1,a$W._isFirstTouch=!0,a$J(a$W,["instance",function(){return this.instance=new a$W}]),a$W}()),a$h=function(){function a$A(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new a$u}a$w(a$A,"laya.events.TouchManager");var a$t=a$A.prototype;return a$t._clearTempArrs=function(){a$A._oldArr.length=0,a$A._newArr.length=0,a$A._tEleArr.length=0},a$t.getTouchFromArr=function(a$t,a$k){var a$v,a$j,a$Q=0;for(a$v=a$k.length,a$Q=0;a$Q<a$v;a$Q++)if((a$j=a$k[a$Q]).id==a$t)return a$j;return null},a$t.removeTouchFromArr=function(a$t,a$k){var a$v=0;for(a$v=a$k.length-1;0<=a$v;a$v--)a$k[a$v].id==a$t&&a$k.splice(a$v,1)},a$t.createTouchO=function(a$t,a$k){var a$v;return(a$v=a$C.getItem("TouchData")||{}).id=a$k,a$v.tar=a$t,a$v},a$t.onMouseDown=function(a$t,a$k,a$v){var a$j,a$Q,a$u,a$S;(void 0===a$v&&(a$v=!1),this.enable)&&(a$j=this.getTouchFromArr(a$k,this.preOvers),a$u=this.getEles(a$t,null,a$A._tEleArr),a$j?a$j.tar=a$t:(a$Q=this.createTouchO(a$t,a$k),this.preOvers.push(a$Q)),a$_.onMobile&&this.sendEvents(a$u,"mouseover",a$k),a$S=a$v?this.preDowns:this.preRightDowns,(a$j=this.getTouchFromArr(a$k,a$S))?a$j.tar=a$t:(a$Q=this.createTouchO(a$t,a$k),a$S.push(a$Q)),this.sendEvents(a$u,a$v?"mousedown":"rightmousedown",a$k),this._clearTempArrs())},a$t.sendEvents=function(a$t,a$k,a$v){void 0===a$v&&(a$v=0);var a$j,a$Q,a$u,a$S=0;for(a$j=a$t.length,this._event._stoped=!1,a$Q=a$t[0],a$S=0;a$S<a$j;a$S++){if((a$u=a$t[a$S]).destroyed)return;if(a$u.event(a$k,this._event.setTo(a$k,a$u,a$Q)),this._event._stoped)break}},a$t.getEles=function(a$t,a$k,a$v){for(a$v?a$v.length=0:a$v=[];a$t&&a$t!=a$k;)a$v.push(a$t),a$t=a$t.parent;return a$v},a$t.checkMouseOutAndOverOfMove=function(a$t,a$k,a$v){if(void 0===a$v&&(a$v=0),a$k!=a$t){var a$j,a$Q,a$u=0,a$S=0;if(a$k.contains(a$t))a$Q=this.getEles(a$t,a$k,a$A._tEleArr),this.sendEvents(a$Q,"mouseover",a$v);else if(a$t.contains(a$k))a$Q=this.getEles(a$k,a$t,a$A._tEleArr),this.sendEvents(a$Q,"mouseout",a$v);else{var a$V,a$J;(a$Q=a$A._tEleArr).length=0,a$V=this.getEles(a$k,null,a$A._oldArr),a$J=this.getEles(a$t,null,a$A._newArr),a$S=a$V.length;var a$W=0;for(a$u=0;a$u<a$S;a$u++){if(a$j=a$V[a$u],0<=(a$W=a$J.indexOf(a$j))){a$J.splice(a$W,a$J.length-a$W);break}a$Q.push(a$j)}0<a$Q.length&&this.sendEvents(a$Q,"mouseout",a$v),0<a$J.length&&this.sendEvents(a$J,"mouseover",a$v)}}},a$t.onMouseMove=function(a$t,a$k){var a$v,a$j;this.enable&&((a$v=this.getTouchFromArr(a$k,this.preOvers))?(this.checkMouseOutAndOverOfMove(a$t,a$v.tar),a$v.tar=a$t,a$j=this.getEles(a$t,null,a$A._tEleArr)):(a$j=this.getEles(a$t,null,a$A._tEleArr),this.sendEvents(a$j,"mouseover",a$k),this.preOvers.push(this.createTouchO(a$t,a$k))),this.sendEvents(a$j,"mousemove",a$k),this._clearTempArrs())},a$t.getLastOvers=function(){return(a$A._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,a$A._tEleArr):(a$A._tEleArr.push(a$d.stage),a$A._tEleArr)},a$t.stageMouseOut=function(){var a$t;a$t=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(a$t,"mouseout",0)},a$t.onMouseUp=function(a$t,a$k,a$v){if(void 0===a$v&&(a$v=!1),this.enable){var a$j,a$Q,a$u,a$S,a$V,a$J,a$W=0,a$w=0,a$M=a$_.onMobile;if(a$Q=this.getEles(a$t,null,a$A._tEleArr),this.sendEvents(a$Q,a$v?"mouseup":"rightmouseup",a$k),a$J=a$v?this.preDowns:this.preRightDowns,a$j=this.getTouchFromArr(a$k,a$J)){var a$H,a$E=a$_.now();if(a$H=a$E-this._lastClickTime<300,this._lastClickTime=a$E,a$t==a$j.tar)a$V=a$Q;else for(a$u=this.getEles(a$j.tar,null,a$A._oldArr),(a$V=a$A._newArr).length=0,a$w=a$u.length,a$W=0;a$W<a$w;a$W++)a$S=a$u[a$W],0<=a$Q.indexOf(a$S)&&a$V.push(a$S);0<a$V.length&&this.sendEvents(a$V,a$v?"click":"rightclick",a$k),a$v&&a$H&&this.sendEvents(a$V,"doubleclick",a$k),this.removeTouchFromArr(a$k,a$J),a$j.tar=null,a$C.recover("TouchData",a$j)}else;(a$j=this.getTouchFromArr(a$k,this.preOvers))&&a$M&&((a$V=this.getEles(a$j.tar,null,a$V))&&0<a$V.length&&this.sendEvents(a$V,"mouseout",a$k),this.removeTouchFromArr(a$k,this.preOvers),a$j.tar=null,a$C.recover("TouchData",a$j)),this._clearTempArrs()}},a$A._oldArr=[],a$A._newArr=[],a$A._tEleArr=[],a$J(a$A,["I",function(){return this.I=new a$A}]),a$A}(),a$l=function(){function a$t(){this._action=null}a$w(a$t,"laya.filters.Filter");var a$k=a$t.prototype;return a$d.imps(a$k,{"laya.filters.IFilter":!0}),a$k.callNative=function(a$t){},a$A(0,a$k,"type",function(){return-1}),a$A(0,a$k,"action",function(){return this._action}),a$t.BLUR=16,a$t.COLOR=32,a$t.GLOW=8,a$t._filterStart=null,a$t._filterEnd=null,a$t._EndTarget=null,a$t._recycleScope=null,a$t._filter=null,a$t._useSrc=null,a$t._endSrc=null,a$t._useOut=null,a$t._endOut=null,a$t}(),a$Y=function(){function a$t(){this.data=null}a$w(a$t,"laya.filters.ColorFilterAction");var a$k=a$t.prototype;return a$d.imps(a$k,{"laya.filters.IFilterAction":!0}),a$k.apply=function(a$t){var a$k=a$t.ctx.ctx,a$v=a$t.ctx.ctx.canvas;if(0==a$v.width||0==a$v.height)return a$v;for(var a$j,a$Q=a$k.getImageData(0,0,a$v.width,a$v.height),a$u=a$Q.data,a$S=0,a$V=a$u.length;a$S<a$V;a$S+=4)a$j=this.getColor(a$u[a$S],a$u[a$S+1],a$u[a$S+2],a$u[a$S+3]),0!=a$u[a$S+3]&&(a$u[a$S]=a$j[0],a$u[a$S+1]=a$j[1],a$u[a$S+2]=a$j[2],a$u[a$S+3]=a$j[3]);return a$k.putImageData(a$Q,0,0),a$t},a$k.getColor=function(a$t,a$k,a$v,a$j){var a$Q=[];if(this.data._mat&&this.data._alpha){var a$u=this.data._mat,a$S=this.data._alpha;a$Q[0]=a$u[0]*a$t+a$u[1]*a$k+a$u[2]*a$v+a$u[3]*a$j+a$S[0],a$Q[1]=a$u[4]*a$t+a$u[5]*a$k+a$u[6]*a$v+a$u[7]*a$j+a$S[1],a$Q[2]=a$u[8]*a$t+a$u[9]*a$k+a$u[10]*a$v+a$u[11]*a$j+a$S[2],a$Q[3]=a$u[12]*a$t+a$u[13]*a$k+a$u[14]*a$v+a$u[15]*a$j+a$S[3]}return a$Q},a$t}(),a$f=(function(){function a$t(){}a$w(a$t,"laya.maths.Arith"),a$t.formatR=function(a$t){return a$t>Math.PI&&(a$t-=2*Math.PI),a$t<-Math.PI&&(a$t+=2*Math.PI),a$t},a$t.isPOT=function(a$t,a$k){return 0<a$t&&0==(a$t&a$t-1)&&0<a$k&&0==(a$k&a$k-1)},a$t.setMatToArray=function(a$t,a$k){a$t.a,a$t.b,a$t.c,a$t.d,a$t.tx,a$t.ty,a$k[0]=a$t.a,a$k[1]=a$t.b,a$k[4]=a$t.c,a$k[5]=a$t.d,a$k[12]=a$t.tx,a$k[13]=a$t.ty}}(),function(){function a$t(){this._controlPoints=[new a$m,new a$m,new a$m],this._calFun=this.getPoint2}a$w(a$t,"laya.maths.Bezier");var a$k=a$t.prototype;return a$k._switchPoint=function(a$t,a$k){var a$v=this._controlPoints.shift();a$v.setTo(a$t,a$k),this._controlPoints.push(a$v)},a$k.getPoint2=function(a$t,a$k){var a$v=this._controlPoints[0],a$j=this._controlPoints[1],a$Q=this._controlPoints[2],a$u=Math.pow(1-a$t,2)*a$v.x+2*a$t*(1-a$t)*a$j.x+Math.pow(a$t,2)*a$Q.x,a$S=Math.pow(1-a$t,2)*a$v.y+2*a$t*(1-a$t)*a$j.y+Math.pow(a$t,2)*a$Q.y;a$k.push(a$u,a$S)},a$k.getPoint3=function(a$t,a$k){var a$v=this._controlPoints[0],a$j=this._controlPoints[1],a$Q=this._controlPoints[2],a$u=this._controlPoints[3],a$S=Math.pow(1-a$t,3)*a$v.x+3*a$j.x*a$t*(1-a$t)*(1-a$t)+3*a$Q.x*a$t*a$t*(1-a$t)+a$u.x*Math.pow(a$t,3),a$V=Math.pow(1-a$t,3)*a$v.y+3*a$j.y*a$t*(1-a$t)*(1-a$t)+3*a$Q.y*a$t*a$t*(1-a$t)+a$u.y*Math.pow(a$t,3);a$k.push(a$S,a$V)},a$k.insertPoints=function(a$t,a$k){var a$v,a$j=NaN;for(a$v=1/(a$t=0<a$t?a$t:5),a$j=0;a$j<=1;a$j+=a$v)this._calFun(a$j,a$k)},a$k.getBezierPoints=function(a$t,a$k,a$v){void 0===a$k&&(a$k=5),void 0===a$v&&(a$v=2);var a$j,a$Q,a$u=0;if((a$j=a$t.length)<2*(a$v+1))return[];switch(a$Q=[],a$v){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=a$v;)this._controlPoints.push(new a$m);for(a$u=0;a$u<2*a$v;a$u+=2)this._switchPoint(a$t[a$u],a$t[a$u+1]);for(a$u=2*a$v;a$u<a$j;a$u+=2)this._switchPoint(a$t[a$u],a$t[a$u+1]),a$u/2%a$v==0&&this.insertPoints(a$k,a$Q);return a$Q},a$J(a$t,["I",function(){return this.I=new a$t}]),a$t}()),a$X=function(){function a$W(){}return a$w(a$W,"laya.maths.GrahamScan"),a$W.multiply=function(a$t,a$k,a$v){return(a$t.x-a$v.x)*(a$k.y-a$v.y)-(a$k.x-a$v.x)*(a$t.y-a$v.y)},a$W.dis=function(a$t,a$k){return(a$t.x-a$k.x)*(a$t.x-a$k.x)+(a$t.y-a$k.y)*(a$t.y-a$k.y)},a$W._getPoints=function(a$t,a$k,a$v){for(void 0===a$k&&(a$k=!1),a$W._mPointList||(a$W._mPointList=[]);a$W._mPointList.length<a$t;)a$W._mPointList.push(new a$m);return a$v||(a$v=[]),a$v.length=0,a$k?a$W.getFrom(a$v,a$W._mPointList,a$t):a$W.getFromR(a$v,a$W._mPointList,a$t),a$v},a$W.getFrom=function(a$t,a$k,a$v){var a$j=0;for(a$j=0;a$j<a$v;a$j++)a$t.push(a$k[a$j]);return a$t},a$W.getFromR=function(a$t,a$k,a$v){var a$j=0;for(a$j=0;a$j<a$v;a$j++)a$t.push(a$k.pop());return a$t},a$W.pListToPointList=function(a$t,a$k){void 0===a$k&&(a$k=!1);var a$v=0,a$j=a$t.length/2,a$Q=a$W._getPoints(a$j,a$k,a$W._tempPointList);for(a$v=0;a$v<a$j;a$v++)a$Q[a$v].setTo(a$t[a$v+a$v],a$t[a$v+a$v+1]);return a$Q},a$W.pointListToPlist=function(a$t){var a$k,a$v=0,a$j=a$t.length,a$Q=a$W._temPList;for(a$v=a$Q.length=0;a$v<a$j;a$v++)a$k=a$t[a$v],a$Q.push(a$k.x,a$k.y);return a$Q},a$W.scanPList=function(a$t){return a$g.copyArray(a$t,a$W.pointListToPlist(a$W.scan(a$W.pListToPointList(a$t,!0))))},a$W.scan=function(a$t){var a$k,a$v,a$j,a$Q=0,a$u=0,a$S=0,a$V=a$t.length,a$J={};for((a$v=a$W._temArr).length=0,a$Q=(a$V=a$t.length)-1;0<=a$Q;a$Q--)a$j=(a$k=a$t[a$Q]).x+"_"+a$k.y,a$J.hasOwnProperty(a$j)||(a$J[a$j]=!0,a$v.push(a$k));for(a$V=a$v.length,a$g.copyArray(a$t,a$v),a$Q=1;a$Q<a$V;a$Q++)(a$t[a$Q].y<a$t[a$S].y||a$t[a$Q].y==a$t[a$S].y&&a$t[a$Q].x<a$t[a$S].x)&&(a$S=a$Q);for(a$k=a$t[0],a$t[0]=a$t[a$S],a$t[a$S]=a$k,a$Q=1;a$Q<a$V-1;a$Q++){for(a$u=(a$S=a$Q)+1;a$u<a$V;a$u++)(0<a$W.multiply(a$t[a$u],a$t[a$S],a$t[0])||0==a$W.multiply(a$t[a$u],a$t[a$S],a$t[0])&&a$W.dis(a$t[0],a$t[a$u])<a$W.dis(a$t[0],a$t[a$S]))&&(a$S=a$u);a$k=a$t[a$Q],a$t[a$Q]=a$t[a$S],a$t[a$S]=a$k}if((a$v=a$W._temArr).length=0,a$t.length<3)return a$g.copyArray(a$v,a$t);for(a$v.push(a$t[0],a$t[1],a$t[2]),a$Q=3;a$Q<a$V;a$Q++){for(;2<=a$v.length&&0<=a$W.multiply(a$t[a$Q],a$v[a$v.length-1],a$v[a$v.length-2]);)a$v.pop();a$t[a$Q]&&a$v.push(a$t[a$Q])}return a$v},a$W._mPointList=null,a$W._tempPointList=[],a$W._temPList=[],a$W._temArr=[],a$W}(),a$F=function(){function a$Q(){}return a$w(a$Q,"laya.maths.MathUtil"),a$Q.subtractVector3=function(a$t,a$k,a$v){a$v[0]=a$t[0]-a$k[0],a$v[1]=a$t[1]-a$k[1],a$v[2]=a$t[2]-a$k[2]},a$Q.lerp=function(a$t,a$k,a$v){return a$t*(1-a$v)+a$k*a$v},a$Q.scaleVector3=function(a$t,a$k,a$v){a$v[0]=a$t[0]*a$k,a$v[1]=a$t[1]*a$k,a$v[2]=a$t[2]*a$k},a$Q.lerpVector3=function(a$t,a$k,a$v,a$j){var a$Q=a$t[0],a$u=a$t[1],a$S=a$t[2];a$j[0]=a$Q+a$v*(a$k[0]-a$Q),a$j[1]=a$u+a$v*(a$k[1]-a$u),a$j[2]=a$S+a$v*(a$k[2]-a$S)},a$Q.lerpVector4=function(a$t,a$k,a$v,a$j){var a$Q=a$t[0],a$u=a$t[1],a$S=a$t[2],a$V=a$t[3];a$j[0]=a$Q+a$v*(a$k[0]-a$Q),a$j[1]=a$u+a$v*(a$k[1]-a$u),a$j[2]=a$S+a$v*(a$k[2]-a$S),a$j[3]=a$V+a$v*(a$k[3]-a$V)},a$Q.slerpQuaternionArray=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){var a$V,a$J,a$W,a$w,a$M,a$H=a$t[a$k+0],a$E=a$t[a$k+1],a$A=a$t[a$k+2],a$R=a$t[a$k+3],a$h=a$v[a$j+0],a$l=a$v[a$j+1],a$o=a$v[a$j+2],a$Y=a$v[a$j+3];return(a$J=a$H*a$h+a$E*a$l+a$A*a$o+a$R*a$Y)<0&&(a$J=-a$J,a$h=-a$h,a$l=-a$l,a$o=-a$o,a$Y=-a$Y),a$M=1e-6<1-a$J?(a$V=Math.acos(a$J),a$W=Math.sin(a$V),a$w=Math.sin((1-a$Q)*a$V)/a$W,Math.sin(a$Q*a$V)/a$W):(a$w=1-a$Q,a$Q),a$u[a$S+0]=a$w*a$H+a$M*a$h,a$u[a$S+1]=a$w*a$E+a$M*a$l,a$u[a$S+2]=a$w*a$A+a$M*a$o,a$u[a$S+3]=a$w*a$R+a$M*a$Y,a$u},a$Q.getRotation=function(a$t,a$k,a$v,a$j){return Math.atan2(a$j-a$k,a$v-a$t)/Math.PI*180},a$Q.sortBigFirst=function(a$t,a$k){return a$t==a$k?0:a$t<a$k?1:-1},a$Q.sortSmallFirst=function(a$t,a$k){return a$t==a$k?0:a$t<a$k?-1:1},a$Q.sortNumBigFirst=function(a$t,a$k){return parseFloat(a$k)-parseFloat(a$t)},a$Q.sortNumSmallFirst=function(a$t,a$k){return parseFloat(a$t)-parseFloat(a$k)},a$Q.sortByKey=function(a$v,a$t,a$k){var a$j;return void 0===a$t&&(a$t=!1),void 0===a$k&&(a$k=!0),a$j=a$t?a$k?a$Q.sortNumBigFirst:a$Q.sortBigFirst:a$k?a$Q.sortNumSmallFirst:a$Q.sortSmallFirst,function(a$t,a$k){return a$j(a$t[a$v],a$k[a$v])}},a$Q}(),a$a=function(){function a$v(a$t,a$k,a$v,a$j,a$Q,a$u){this.inPool=!1,this.bTransform=!1,void 0===a$t&&(a$t=1),void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=1),void 0===a$Q&&(a$Q=0),void 0===a$u&&(a$u=0),this.a=a$t,this.b=a$k,this.c=a$v,this.d=a$j,this.tx=a$Q,this.ty=a$u,this._checkTransform()}a$w(a$v,"laya.maths.Matrix");var a$t=a$v.prototype;return a$t.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},a$t._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},a$t.setTranslate=function(a$t,a$k){return this.tx=a$t,this.ty=a$k,this},a$t.translate=function(a$t,a$k){return this.tx+=a$t,this.ty+=a$k,this},a$t.scale=function(a$t,a$k){this.a*=a$t,this.d*=a$k,this.c*=a$t,this.b*=a$k,this.tx*=a$t,this.ty*=a$k,this.bTransform=!0},a$t.rotate=function(a$t){var a$k=Math.cos(a$t),a$v=Math.sin(a$t),a$j=this.a,a$Q=this.c,a$u=this.tx;this.a=a$j*a$k-this.b*a$v,this.b=a$j*a$v+this.b*a$k,this.c=a$Q*a$k-this.d*a$v,this.d=a$Q*a$v+this.d*a$k,this.tx=a$u*a$k-this.ty*a$v,this.ty=a$u*a$v+this.ty*a$k,this.bTransform=!0},a$t.skew=function(a$t,a$k){var a$v=Math.tan(a$t),a$j=Math.tan(a$k),a$Q=this.a,a$u=this.b;return this.a+=a$j*this.c,this.b+=a$j*this.d,this.c+=a$v*a$Q,this.d+=a$v*a$u,this},a$t.invertTransformPoint=function(a$t){var a$k=this.a,a$v=this.b,a$j=this.c,a$Q=this.d,a$u=this.tx,a$S=a$k*a$Q-a$v*a$j,a$V=a$Q/a$S,a$J=-a$v/a$S,a$W=-a$j/a$S,a$w=a$k/a$S,a$M=(a$j*this.ty-a$Q*a$u)/a$S,a$H=-(a$k*this.ty-a$v*a$u)/a$S;return a$t.setTo(a$V*a$t.x+a$W*a$t.y+a$M,a$J*a$t.x+a$w*a$t.y+a$H)},a$t.transformPoint=function(a$t){return a$t.setTo(this.a*a$t.x+this.c*a$t.y+this.tx,this.b*a$t.x+this.d*a$t.y+this.ty)},a$t.transformPointN=function(a$t){return a$t.setTo(this.a*a$t.x+this.c*a$t.y,this.b*a$t.x+this.d*a$t.y)},a$t.transformPointArray=function(a$t,a$k){for(var a$v=a$t.length,a$j=0;a$j<a$v;a$j+=2){var a$Q=a$t[a$j],a$u=a$t[a$j+1];a$k[a$j]=this.a*a$Q+this.c*a$u+this.tx,a$k[a$j+1]=this.b*a$Q+this.d*a$u+this.ty}return a$k},a$t.transformPointArrayScale=function(a$t,a$k){for(var a$v=a$t.length,a$j=0;a$j<a$v;a$j+=2){var a$Q=a$t[a$j],a$u=a$t[a$j+1];a$k[a$j]=this.a*a$Q+this.c*a$u,a$k[a$j+1]=this.b*a$Q+this.d*a$u}return a$k},a$t.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},a$t.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},a$t.invert=function(){var a$t=this.a,a$k=this.b,a$v=this.c,a$j=this.d,a$Q=this.tx,a$u=a$t*a$j-a$k*a$v;return this.a=a$j/a$u,this.b=-a$k/a$u,this.c=-a$v/a$u,this.d=a$t/a$u,this.tx=(a$v*this.ty-a$j*a$Q)/a$u,this.ty=-(a$t*this.ty-a$k*a$Q)/a$u,this},a$t.setTo=function(a$t,a$k,a$v,a$j,a$Q,a$u){return this.a=a$t,this.b=a$k,this.c=a$v,this.d=a$j,this.tx=a$Q,this.ty=a$u,this},a$t.concat=function(a$t){var a$k=this.a,a$v=this.c,a$j=this.tx;return this.a=a$k*a$t.a+this.b*a$t.c,this.b=a$k*a$t.b+this.b*a$t.d,this.c=a$v*a$t.a+this.d*a$t.c,this.d=a$v*a$t.b+this.d*a$t.d,this.tx=a$j*a$t.a+this.ty*a$t.c+a$t.tx,this.ty=a$j*a$t.b+this.ty*a$t.d+a$t.ty,this},a$t.scaleEx=function(a$t,a$k){var a$v=this.a,a$j=this.b,a$Q=this.c,a$u=this.d;0!==a$j||0!==a$Q?(this.a=a$t*a$v,this.b=a$t*a$j,this.c=a$k*a$Q):(this.a=a$t*a$v,this.b=0*a$u,this.c=0*a$v),this.d=a$k*a$u,this.bTransform=!0},a$t.rotateEx=function(a$t){var a$k=Math.cos(a$t),a$v=Math.sin(a$t),a$j=this.a,a$Q=this.b,a$u=this.c,a$S=this.d;0!==a$Q||0!==a$u?(this.a=a$k*a$j+a$v*a$u,this.b=a$k*a$Q+a$v*a$S,this.c=-a$v*a$j+a$k*a$u,this.d=-a$v*a$Q+a$k*a$S):(this.a=a$k*a$j,this.b=a$v*a$S,this.c=-a$v*a$j,this.d=a$k*a$S),this.bTransform=!0},a$t.clone=function(){var a$t=a$v.create();return a$t.a=this.a,a$t.b=this.b,a$t.c=this.c,a$t.d=this.d,a$t.tx=this.tx,a$t.ty=this.ty,a$t.bTransform=this.bTransform,a$t},a$t.copyTo=function(a$t){return a$t.a=this.a,a$t.b=this.b,a$t.c=this.c,a$t.d=this.d,a$t.tx=this.tx,a$t.ty=this.ty,a$t.bTransform=this.bTransform,a$t},a$t.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},a$t.destroy=function(){if(!this.inPool){var a$t=a$v._cache;this.inPool=!0,a$t._length||(a$t._length=0),(a$t[a$t._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},a$v.mul=function(a$t,a$k,a$v){var a$j=a$t.a,a$Q=a$t.b,a$u=a$t.c,a$S=a$t.d,a$V=a$t.tx,a$J=a$t.ty,a$W=a$k.a,a$w=a$k.b,a$M=a$k.c,a$H=a$k.d,a$E=a$k.tx,a$A=a$k.ty;return 0!==a$w||0!==a$M?(a$v.a=a$j*a$W+a$Q*a$M,a$v.b=a$j*a$w+a$Q*a$H,a$v.c=a$u*a$W+a$S*a$M,a$v.d=a$u*a$w+a$S*a$H,a$v.tx=a$W*a$V+a$M*a$J+a$E,a$v.ty=a$w*a$V+a$H*a$J+a$A):(a$v.a=a$j*a$W,a$v.b=a$Q*a$H,a$v.c=a$u*a$W,a$v.d=a$S*a$H,a$v.tx=a$W*a$V+a$E,a$v.ty=a$H*a$J+a$A),a$v},a$v.mul16=function(a$t,a$k,a$v){var a$j=a$t.a,a$Q=a$t.b,a$u=a$t.c,a$S=a$t.d,a$V=a$t.tx,a$J=a$t.ty,a$W=a$k.a,a$w=a$k.b,a$M=a$k.c,a$H=a$k.d,a$E=a$k.tx,a$A=a$k.ty;return 0!==a$w||0!==a$M?(a$v[0]=a$j*a$W+a$Q*a$M,a$v[1]=a$j*a$w+a$Q*a$H,a$v[4]=a$u*a$W+a$S*a$M,a$v[5]=a$u*a$w+a$S*a$H,a$v[12]=a$W*a$V+a$M*a$J+a$E,a$v[13]=a$w*a$V+a$H*a$J+a$A):(a$v[0]=a$j*a$W,a$v[1]=a$Q*a$H,a$v[4]=a$u*a$W,a$v[5]=a$S*a$H,a$v[12]=a$W*a$V+a$E,a$v[13]=a$H*a$J+a$A),a$v},a$v.mulPre=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){var a$J=a$t.a,a$W=a$t.b,a$w=a$t.c,a$M=a$t.d,a$H=a$t.tx,a$E=a$t.ty;return 0!==a$v||0!==a$j?(a$V.a=a$J*a$k+a$W*a$j,a$V.b=a$J*a$v+a$W*a$Q,a$V.c=a$w*a$k+a$M*a$j,a$V.d=a$w*a$v+a$M*a$Q,a$V.tx=a$k*a$H+a$j*a$E+a$u,a$V.ty=a$v*a$H+a$Q*a$E+a$S):(a$V.a=a$J*a$k,a$V.b=a$W*a$Q,a$V.c=a$w*a$k,a$V.d=a$M*a$Q,a$V.tx=a$k*a$H+a$u,a$V.ty=a$Q*a$E+a$S),a$V},a$v.mulPos=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){var a$J=a$t.a,a$W=a$t.b,a$w=a$t.c,a$M=a$t.d,a$H=a$t.tx,a$E=a$t.ty;return 0!==a$W||0!==a$w?(a$V.a=a$k*a$J+a$v*a$w,a$V.b=a$k*a$W+a$v*a$M,a$V.c=a$j*a$J+a$Q*a$w,a$V.d=a$j*a$W+a$Q*a$M,a$V.tx=a$J*a$u+a$w*a$S+a$H,a$V.ty=a$W*a$u+a$M*a$S+a$E):(a$V.a=a$k*a$J,a$V.b=a$v*a$M,a$V.c=a$j*a$J,a$V.d=a$Q*a$M,a$V.tx=a$J*a$u+a$H,a$V.ty=a$M*a$S+a$E),a$V},a$v.preMul=function(a$t,a$k,a$v){var a$j=a$t.a,a$Q=a$t.b,a$u=a$t.c,a$S=a$t.d,a$V=a$k.a,a$J=a$k.b,a$W=a$k.c,a$w=a$k.d,a$M=a$k.tx,a$H=a$k.ty;return a$v.a=a$V*a$j,a$v.b=a$v.c=0,a$v.d=a$w*a$S,a$v.tx=a$M*a$j+a$t.tx,a$v.ty=a$H*a$S+a$t.ty,0===a$J&&0===a$W&&0===a$Q&&0===a$u||(a$v.a+=a$J*a$u,a$v.d+=a$W*a$Q,a$v.b+=a$V*a$Q+a$J*a$S,a$v.c+=a$W*a$j+a$w*a$u,a$v.tx+=a$H*a$u,a$v.ty+=a$M*a$Q),a$v},a$v.preMulXY=function(a$t,a$k,a$v,a$j){var a$Q=a$t.a,a$u=a$t.b,a$S=a$t.c,a$V=a$t.d;return a$j.a=a$Q,a$j.b=a$u,a$j.c=a$S,a$j.d=a$V,a$j.tx=a$k*a$Q+a$t.tx+a$v*a$S,a$j.ty=a$v*a$V+a$t.ty+a$k*a$u,a$j},a$v.create=function(){var a$t=a$v._cache,a$k=a$t._length?a$t[--a$t._length]:new a$v;return a$k.inPool=!1,a$k},a$v.EMPTY=new a$v,a$v.TEMP=new a$v,a$v._cache=[],a$v}(),a$m=function(){function a$t(a$t,a$k){void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),this.x=a$t,this.y=a$k}a$w(a$t,"laya.maths.Point");var a$k=a$t.prototype;return a$k.setTo=function(a$t,a$k){return this.x=a$t,this.y=a$k,this},a$k.distance=function(a$t,a$k){return Math.sqrt((this.x-a$t)*(this.x-a$t)+(this.y-a$k)*(this.y-a$k))},a$k.toString=function(){return this.x+","+this.y},a$k.normalize=function(){var a$t=Math.sqrt(this.x*this.x+this.y*this.y);if(0<a$t){var a$k=1/a$t;this.x*=a$k,this.y*=a$k}},a$t.TEMP=new a$t,a$t.EMPTY=new a$t,a$t}(),a$Z=function(){function a$W(a$t,a$k,a$v,a$j){void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=0),this.x=a$t,this.y=a$k,this.width=a$v,this.height=a$j}a$w(a$W,"laya.maths.Rectangle");var a$t=a$W.prototype;return a$t.setTo=function(a$t,a$k,a$v,a$j){return this.x=a$t,this.y=a$k,this.width=a$v,this.height=a$j,this},a$t.copyFrom=function(a$t){return this.x=a$t.x,this.y=a$t.y,this.width=a$t.width,this.height=a$t.height,this},a$t.contains=function(a$t,a$k){return!(this.width<=0||this.height<=0)&&(a$t>=this.x&&a$t<this.right&&a$k>=this.y&&a$k<this.bottom)},a$t.intersects=function(a$t){return!(a$t.x>this.x+this.width||a$t.x+a$t.width<this.x||a$t.y>this.y+this.height||a$t.y+a$t.height<this.y)},a$t.intersection=function(a$t,a$k){return this.intersects(a$t)?(a$k||(a$k=new a$W),a$k.x=Math.max(this.x,a$t.x),a$k.y=Math.max(this.y,a$t.y),a$k.width=Math.min(this.right,a$t.right)-a$k.x,a$k.height=Math.min(this.bottom,a$t.bottom)-a$k.y,a$k):null},a$t.union=function(a$t,a$k){return a$k||(a$k=new a$W),this.clone(a$k),a$t.width<=0||a$t.height<=0?a$k:(a$k.addPoint(a$t.x,a$t.y),a$k.addPoint(a$t.right,a$t.bottom),this)},a$t.clone=function(a$t){return a$t||(a$t=new a$W),a$t.x=this.x,a$t.y=this.y,a$t.width=this.width,a$t.height=this.height,a$t},a$t.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},a$t.equals=function(a$t){return!(!a$t||a$t.x!==this.x||a$t.y!==this.y||a$t.width!==this.width||a$t.height!==this.height)},a$t.addPoint=function(a$t,a$k){return this.x>a$t&&(this.width+=this.x-a$t,this.x=a$t),this.y>a$k&&(this.height+=this.y-a$k,this.y=a$k),this.width<a$t-this.x&&(this.width=a$t-this.x),this.height<a$k-this.y&&(this.height=a$k-this.y),this},a$t._getBoundPoints=function(){var a$t=a$W._temB;return(a$t.length=0)==this.width||0==this.height||a$t.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),a$t},a$t.isEmpty=function(){return this.width<=0||this.height<=0},a$A(0,a$t,"right",function(){return this.x+this.width}),a$A(0,a$t,"bottom",function(){return this.y+this.height}),a$W._getBoundPointS=function(a$t,a$k,a$v,a$j){var a$Q=a$W._temA;return(a$Q.length=0)==a$v||0==a$j||a$Q.push(a$t,a$k,a$t+a$v,a$k,a$t,a$k+a$j,a$t+a$v,a$k+a$j),a$Q},a$W._getWrapRec=function(a$t,a$k){if(!a$t||a$t.length<1)return a$k?a$k.setTo(0,0,0,0):a$W.TEMP.setTo(0,0,0,0);a$k=a$k||new a$W;var a$v,a$j,a$Q,a$u,a$S,a$V=a$t.length,a$J=a$m.TEMP;for(a$Q=a$S=-(a$j=a$u=99999),a$v=0;a$v<a$V;a$v+=2)a$J.x=a$t[a$v],a$J.y=a$t[a$v+1],a$j=a$j<a$J.x?a$j:a$J.x,a$u=a$u<a$J.y?a$u:a$J.y,a$Q=a$Q>a$J.x?a$Q:a$J.x,a$S=a$S>a$J.y?a$S:a$J.y;return a$k.setTo(a$j,a$u,a$Q-a$j,a$S-a$u)},a$W.EMPTY=new a$W,a$W.TEMP=new a$W,a$W._temB=[],a$W._temA=[],a$W}(),a$U=function(){function a$J(){}return a$w(a$J,"laya.media.SoundManager"),a$A(1,a$J,"useAudioMusic",function(){return a$J._useAudioMusic},function(a$t){a$J._useAudioMusic=a$t,a$J._musicClass=a$t?a$vt:null}),a$A(1,a$J,"autoStopMusic",function(){return a$J._autoStopMusic},function(a$t){a$d.stage.off("blur",null,a$J._stageOnBlur),a$d.stage.off("focus",null,a$J._stageOnFocus),a$d.stage.off("visibilitychange",null,a$J._visibilityChange),(a$J._autoStopMusic=a$t)&&(a$d.stage.on("blur",null,a$J._stageOnBlur),a$d.stage.on("focus",null,a$J._stageOnFocus),a$d.stage.on("visibilitychange",null,a$J._visibilityChange))}),a$A(1,a$J,"muted",function(){return a$J._muted},function(a$t){a$t!=a$J._muted&&(a$t&&a$J.stopAllSound(),a$J.musicMuted=a$t,a$J._muted=a$t)}),a$A(1,a$J,"musicMuted",function(){return a$J._musicMuted},function(a$t){a$t!=a$J._musicMuted&&(a$t?(a$J._tMusic&&a$J._musicChannel&&!a$J._musicChannel.isStopped?a$J._musicChannel.pause():a$J._musicChannel=null,a$J._musicMuted=a$t):(a$J._musicMuted=a$t,a$J._tMusic&&a$J._musicChannel&&a$J._musicChannel.resume()))}),a$A(1,a$J,"soundMuted",function(){return a$J._soundMuted},function(a$t){a$J._soundMuted=a$t}),a$J.addChannel=function(a$t){0<=a$J._channels.indexOf(a$t)||(a$J._channels.push(a$t),a$J.autoReleaseSound&&0!=a$J._notUsedCount&&a$J._notUsedUrls[a$t.url]&&(delete a$J._notUsedUrls[a$t.url],0==--a$J._notUsedCount&&a$d.timer.clear(a$J,a$J.disposeSoundIfNotUsed)))},a$J.removeChannel=function(a$t){var a$k=a$J._channels,a$v=a$k.indexOf(a$t);if(-1!=a$v&&(a$k.splice(a$v,1),a$J.autoReleaseSound)){var a$j=a$t.url,a$Q=a$J.defaultIntervals[a$j]||2e4;if(0<a$Q){var a$u=!0;for(a$v=a$k.length-1;0<=a$v;a$v--)if(a$k[a$v].url==a$j){a$u=!1;break}a$u&&(a$J._notUsedUrls[a$j]=Date.now()+a$Q,0==a$J._notUsedCount++&&a$d.timer.loop(1e4,a$J,a$J.disposeSoundIfNotUsed))}}},a$J.disposeSoundIfNotUsed=function(){var a$t=a$J._notUsedUrls;if(0!=a$J._notUsedCount){var a$k=Date.now();for(var a$v in a$t)a$k>=a$t[a$v]&&(delete a$t[a$v],--a$J._notUsedCount,a$J.destroySound(a$v));if(0!=a$J._notUsedCount)return}a$d.timer.clear(a$J,a$J.disposeSoundIfNotUsed)},a$J._visibilityChange=function(){a$d.stage.isVisibility?a$J._stageOnFocus():a$J._stageOnBlur()},a$J._stageOnBlur=function(){a$J._isActive=!1,a$J._musicChannel&&(a$J._musicChannel.isStopped||(a$J._blurPaused=!0,a$J._musicChannel.pause())),a$J.stopAllSound(),a$d.stage.once("mousedown",null,a$J._stageOnFocus)},a$J._recoverWebAudio=function(){a$ut.ctx&&"running"!=a$ut.ctx.state&&a$ut.ctx.resume&&a$ut.ctx.resume()},a$J._stageOnFocus=function(){if(a$J._isActive=!0,a$J._recoverWebAudio(),a$d.stage.off("mousedown",null,a$J._stageOnFocus),a$J._blurPaused){var a$t=a$J._musicChannel;a$t&&a$J._music&&a$t.isStopped&&(a$J._blurPaused=!1,a$J._music._disposed?a$J.playMusic(a$t.url,a$t.loops,a$t.startHandler,a$t.completeHandler,a$t.startTime):a$t.audioBuffer?a$t.resume():a$J._music.play(a$t.startTime,a$t.loops,a$t.startHandler,a$t))}},a$J.playSound=function(a$t,a$k,a$v,a$j,a$Q,a$u){if(void 0===a$k&&(a$k=1),void 0===a$u&&(a$u=0),!a$t)return null;if(a$J._muted)return null;if(a$J._recoverWebAudio(),a$t==a$J._tMusic){if(a$J._musicMuted)return null}else{if(!a$J._isActive)return null;if(a$J._soundMuted)return null}var a$S,a$V=a$J._pool[a$t];return a$Q||(a$Q=a$J._soundClass),a$V||((a$V=new a$Q).load(a$t),a$J._pool[a$t]=a$V),(a$S=a$V.play(a$u,a$k,a$v))?(a$t==a$J._tMusic&&(a$J._music=a$V,a$J._isActive||(a$J._blurPaused=!0,a$S.pause())),a$S.url=a$t,a$S.volume=a$t==a$J._tMusic?a$J.musicVolume:a$J.soundVolume,a$S.completeHandler=a$j,a$S):null},a$J.destroySound=function(a$t){var a$k=a$J._pool[a$t];a$k&&(delete a$J._pool[a$t],a$k.dispose())},a$J.playMusic=function(a$t,a$k,a$v,a$j,a$Q){return void 0===a$k&&(a$k=0),void 0===a$Q&&(a$Q=0),a$J._tMusic=a$t,a$J._musicChannel&&a$J._musicChannel.stop(),a$J._musicChannel=a$J.playSound(a$t,a$k,a$v,a$j,null,a$Q)},a$J.stopSound=function(a$t){for(var a$k,a$v=a$J._channels.length-1;0<=a$v;a$v--)(a$k=a$J._channels[a$v]).url==a$t&&a$k.stop()},a$J.stopAll=function(){a$J._tMusic=null;var a$t=0;for(a$t=a$J._channels.length-1;0<=a$t;a$t--)a$J._channels[a$t].stop()},a$J.stopAllSound=function(){var a$t,a$k=0;for(a$k=a$J._channels.length-1;0<=a$k;a$k--)(a$t=a$J._channels[a$k]).url!=a$J._tMusic&&a$t.stop()},a$J.stopMusic=function(){a$J._musicChannel&&a$J._musicChannel.stop(),a$J._tMusic=null},a$J.setSoundVolume=function(a$t,a$k){if(a$k)a$J._setVolume(a$k,a$t);else{a$J.soundVolume=a$t;var a$v,a$j=0;for(a$j=a$J._channels.length-1;0<=a$j;a$j--)(a$v=a$J._channels[a$j]).url!=a$J._tMusic&&(a$v.volume=a$t)}},a$J.setMusicVolume=function(a$t){a$J.musicVolume=a$t,a$J._setVolume(a$J._tMusic,a$t)},a$J._setVolume=function(a$t,a$k){for(var a$v,a$j=a$J._channels.length-1;0<=a$j;a$j--)(a$v=a$J._channels[a$j]).url==a$t&&(a$v.volume=a$k)},a$J.musicVolume=1,a$J.soundVolume=1,a$J.playbackRate=1,a$J._useAudioMusic=!0,a$J._muted=!1,a$J._soundMuted=!1,a$J._musicMuted=!1,a$J._tMusic=null,a$J._musicChannel=null,a$J._music=null,a$J._channels=[],a$J._autoStopMusic=!1,a$J._blurPaused=!1,a$J._isActive=!0,a$J._soundClass=null,a$J._musicClass=null,a$J.autoReleaseSound=!0,a$J._pool={},a$J.defaultIntervals={},a$J._notUsedUrls={},a$J._notUsedCount=0,a$J}(),a$s=function(){var a$t;function a$v(){}return a$w(a$v,"laya.net.LocalStorage"),a$v.__init__=function(){a$v._baseClass||(a$v._baseClass=a$t).init(),a$v.items=a$v._baseClass.items,a$v.support=a$v._baseClass.support},a$v.setItem=function(a$t,a$k){a$v._baseClass.setItem(a$t,a$k)},a$v.getItem=function(a$t){return a$v._baseClass.getItem(a$t)},a$v.setJSON=function(a$t,a$k){a$v._baseClass.setJSON(a$t,a$k)},a$v.getJSON=function(a$t){return a$v._baseClass.getJSON(a$t)},a$v.removeItem=function(a$t){a$v._baseClass.removeItem(a$t)},a$v.clear=function(){a$v._baseClass.clear()},a$v._baseClass=null,a$v.items=null,a$v.support=!1,a$v.__init$=function(){a$t=function(){function a$v(){}return a$w(a$v,""),a$v.init=function(){try{a$v.support=!0,a$v.items=a$S.localStorage,a$v.setItem("laya","1"),a$v.removeItem("laya")}catch(a$t){a$v.support=!1}a$v.support||console.log("LocalStorage is not supprot or browser is private mode.")},a$v.setItem=function(a$t,a$k){try{a$v.support&&a$v.items.setItem(a$t,a$k)}catch(a$t){console.warn("set localStorage failed",a$t)}},a$v.getItem=function(a$t){return a$v.support?a$v.items.getItem(a$t):null},a$v.setJSON=function(a$t,a$k){try{a$v.support&&a$v.items.setItem(a$t,JSON.stringify(a$k))}catch(a$t){console.warn("set localStorage failed",a$t)}},a$v.getJSON=function(a$t){return JSON.parse(a$v.support?a$v.items.getItem(a$t):null)},a$v.removeItem=function(a$t){a$v.support&&a$v.items.removeItem(a$t)},a$v.clear=function(){a$v.support&&a$v.items.clear()},a$v.items=null,a$v.support=!1,a$v}()},a$v}(),a$z=(function(){function a$j(){}a$w(a$j,"laya.net.ResourceVersion"),a$j.enable=function(a$t,a$k,a$v){void 0===a$v&&(a$v=2),laya.net.ResourceVersion.type=a$v,a$d.loader.load(a$t,a$o.create(null,a$j.onManifestLoaded,[a$k]),null,"json"),a$G.customFormat=a$j.addVersionPrefix},a$j.onManifestLoaded=function(a$t,a$k){a$j.manifest=a$k,a$t.run(),a$k||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},a$j.addVersionPrefix=function(a$t){return a$j.manifest&&a$j.manifest[a$t]?2==a$j.type?a$j.manifest[a$t]:a$j.manifest[a$t]+"/"+a$t:a$t},a$j.FOLDER_VERSION=1,a$j.FILENAME_VERSION=2,a$j.manifest=null,a$j.type=1}(),function(){function a$t(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}a$w(a$t,"laya.net.TTFLoader");var a$k=a$t.prototype;return a$k.load=function(a$t){var a$k=(this._url=a$t).split(".ttf")[0].split("/");this.fontName=a$k[a$k.length-1],a$_.window.conch?this._loadConch():a$_.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},a$k._loadConch=function(){this._http=new a$St,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},a$k._onHttpLoaded=function(a$t){a$_.window.conch.setFontFaceFromBuffer(this.fontName,a$t),this._clearHttp(),this._complete()},a$k._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},a$k._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},a$k._complete=function(){a$d.timer.clear(this,this._complete),a$d.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},a$k._checkComplete=function(){a$N.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},a$k._loadWithFontFace=function(){var a$t=new a$_.window.FontFace(this.fontName,"url('"+this._url+"')");a$_.window.document.fonts.add(a$t);var a$k=this;a$t.loaded.then(function(){a$k._complete()}),a$t.load()},a$k._createDiv=function(){this._div=a$_.createElement("div"),this._div.innerHTML="laya";var a$t=this._div.style;a$t.fontFamily=this.fontName,a$t.position="absolute",a$t.left="-100px",a$t.top="-100px",a$_.document.body.appendChild(this._div)},a$k._loadWithCSS=function(){var a$t=this,a$k=a$_.createElement("style");a$k.type="text/css",a$_.document.body.appendChild(a$k),a$k.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=a$N.measureText("LayaTTFFont",this._fontTxt).width;var a$v=this;a$k.onload=function(){a$d.timer.once(1e4,a$v,a$t._complete)},a$d.timer.loop(20,this,this._checkComplete),this._createDiv()},a$t._testString="LayaTTFFont",a$t}()),a$G=function(){function a$j(a$t){this._url=null,this._path=null,this._url=a$j.formatURL(a$t),this._path=a$j.getPath(a$t)}a$w(a$j,"laya.net.URL");var a$t=a$j.prototype;return a$A(0,a$t,"path",function(){return this._path}),a$A(0,a$t,"url",function(){return this._url}),a$j.formatURL=function(a$t,a$k){if(!a$t)return"null path";if(0<a$t.indexOf(":"))return a$t;null!=a$j.customFormat&&(a$t=a$j.customFormat(a$t,a$k));var a$v=a$t.charAt(0);if("."===a$v)return a$j.formatRelativePath((a$k||a$j.basePath)+a$t);if("~"===a$v)return a$j.rootPath+a$t.substring(1);if("d"===a$v){if(0===a$t.indexOf("data:image"))return a$t}else if("/"===a$v)return a$t;return(a$k||a$j.basePath)+a$t},a$j.formatRelativePath=function(a$t){for(var a$k=a$t.split("/"),a$v=0,a$j=a$k.length;a$v<a$j;a$v++)".."==a$k[a$v]&&(a$k.splice(a$v-1,2),a$v-=2);return a$k.join("/")},a$j.isAbsolute=function(a$t){return 0<a$t.indexOf(":")||"/"==a$t.charAt(0)},a$j.getPath=function(a$t){var a$k=a$t.lastIndexOf("/");return 0<a$k?a$t.substr(0,a$k+1):""},a$j.getFileName=function(a$t){var a$k=a$t.lastIndexOf("/");return 0<a$k?a$t.substr(a$k+1):a$t},a$j.version={},a$j.basePath="",a$j.rootPath="",a$j.customFormat=function(a$t){var a$k=a$j.version[a$t];return!a$c.isConchApp&&a$k&&(a$t+="?v="+a$k),a$t},a$j}(),a$c=function(){function a$Q(a$t,a$k){this._timeId=0;var a$v=a$Q._mainCanvas.source.style;a$v.position="absolute",a$v.top=a$v.left="0px",a$v.background="#000000",a$Q._mainCanvas.source.id="layaCanvas";var a$j=laya.renders.Render.isWebGL;a$Q._mainCanvas.source.width=a$t,a$Q._mainCanvas.source.height=a$k,a$j&&a$Q.WebGL.init(a$Q._mainCanvas,a$t,a$k),a$_.container.appendChild(a$Q._mainCanvas.source),(a$Q._context=new a$T(a$t,a$k,a$j?null:a$Q._mainCanvas)).ctx.setIsMainContext(),a$_.window.requestAnimationFrame(function a$t(a$k){a$_.window.requestAnimationFrame(a$t);a$d.stage._loop()}),a$d.stage.on("visibilitychange",this,this._onVisibilitychange)}a$w(a$Q,"laya.renders.Render");var a$t=a$Q.prototype;return a$t._onVisibilitychange=function(){a$d.stage.isVisibility?0!=this._timeId&&a$_.window.clearInterval(this._timeId):this._timeId=a$_.window.setInterval(this._enterFrame,1e3)},a$t._enterFrame=function(a$t){a$d.stage._loop()},a$A(1,a$Q,"context",function(){return a$Q._context}),a$A(1,a$Q,"canvas",function(){return a$Q._mainCanvas.source}),a$Q._context=null,a$Q._mainCanvas=null,a$Q.WebGL=null,a$Q.isConchNode=!1,a$Q.isConchApp=!1,a$Q.isConchWebGL=!1,a$Q.isWebGL=!1,a$Q.is3DMode=!1,a$Q.optimizeTextureMemory=function(a$t,a$k){return!0},a$Q.__init$=function(){a$S.ConchRenderType=a$S.ConchRenderType||1,a$S.ConchRenderType|=a$S.conch?4:0,a$Q.isConchNode=5==(5&a$S.ConchRenderType),a$Q.isConchApp=4==(4&a$S.ConchRenderType),a$Q.isConchWebGL=6==a$S.ConchRenderType},a$Q}(),a$T=function(){function a$S(a$t,a$k,a$v){this.x=0,this.y=0,this._drawTexture=function(a$t,a$k,a$v){a$v[0].loaded&&this.ctx.drawTexture(a$v[0],a$v[1],a$v[2],a$v[3],a$v[4],a$t,a$k)},this._fillTexture=function(a$t,a$k,a$v){a$v[0].loaded&&this.ctx.fillTexture(a$v[0],a$v[1]+a$t,a$v[2]+a$k,a$v[3],a$v[4],a$v[5],a$v[6],a$v[7])},this._drawTextureWithTransform=function(a$t,a$k,a$v){a$v[0].loaded&&this.ctx.drawTextureWithTransform(a$v[0],a$v[1],a$v[2],a$v[3],a$v[4],a$v[5],a$t,a$k,a$v[6])},this._fillQuadrangle=function(a$t,a$k,a$v){this.ctx.fillQuadrangle(a$v[0],a$v[1],a$v[2],a$v[3],a$v[4])},this._drawRect=function(a$t,a$k,a$v){var a$j=this.ctx;null!=a$v[4]&&(a$j.fillStyle=a$v[4],a$j.fillRect(a$t+a$v[0],a$k+a$v[1],a$v[2],a$v[3],null)),null!=a$v[5]&&(a$j.strokeStyle=a$v[5],a$j.lineWidth=a$v[6],a$j.strokeRect(a$t+a$v[0],a$k+a$v[1],a$v[2],a$v[3],a$v[6]))},this._drawPie=function(a$t,a$k,a$v){var a$j=this.ctx;a$c.isWebGL&&a$j.setPathId(a$v[8]),a$j.beginPath(),a$c.isWebGL?(a$j.movePath(a$v[0]+a$t,a$v[1]+a$k),a$j.moveTo(0,0)):a$j.moveTo(a$t+a$v[0],a$k+a$v[1]),a$j.arc(a$t+a$v[0],a$k+a$v[1],a$v[2],a$v[3],a$v[4]),a$j.closePath(),this._fillAndStroke(a$v[5],a$v[6],a$v[7],!0)},this._clipRect=function(a$t,a$k,a$v){this.ctx.clipRect(a$t+a$v[0],a$k+a$v[1],a$v[2],a$v[3])},this._fillRect=function(a$t,a$k,a$v){this.ctx.fillRect(a$t+a$v[0],a$k+a$v[1],a$v[2],a$v[3],a$v[4])},this._drawCircle=function(a$t,a$k,a$v){var a$j=this.ctx;a$c.isWebGL&&a$j.setPathId(a$v[6]),a$L.drawCall++,a$j.beginPath(),a$c.isWebGL&&a$j.movePath(a$v[0]+a$t,a$v[1]+a$k),a$j.arc(a$v[0]+a$t,a$v[1]+a$k,a$v[2],0,a$S.PI2),a$j.closePath(),this._fillAndStroke(a$v[3],a$v[4],a$v[5],!0)},this._fillCircle=function(a$t,a$k,a$v){a$L.drawCall++;var a$j=this.ctx;a$j.beginPath(),a$j.fillStyle=a$v[3],a$j.arc(a$v[0]+a$t,a$v[1]+a$k,a$v[2],0,a$S.PI2),a$j.fill()},this._setShader=function(a$t,a$k,a$v){this.ctx.setShader(a$v[0])},this._drawLine=function(a$t,a$k,a$v){var a$j=this.ctx;a$c.isWebGL&&a$j.setPathId(a$v[6]),a$j.beginPath(),a$j.strokeStyle=a$v[4],a$j.lineWidth=a$v[5],a$c.isWebGL?(a$j.movePath(a$t,a$k),a$j.moveTo(a$v[0],a$v[1]),a$j.lineTo(a$v[2],a$v[3])):(a$j.moveTo(a$t+a$v[0],a$k+a$v[1]),a$j.lineTo(a$t+a$v[2],a$k+a$v[3])),a$j.stroke()},this._drawLines=function(a$t,a$k,a$v){var a$j=this.ctx;a$c.isWebGL&&a$j.setPathId(a$v[5]),a$j.beginPath(),a$t+=a$v[0],a$k+=a$v[1],a$c.isWebGL&&a$j.movePath(a$t,a$k),a$j.strokeStyle=a$v[3],a$j.lineWidth=a$v[4];var a$Q=a$v[2],a$u=2,a$S=a$Q.length;if(a$c.isWebGL)for(a$j.moveTo(a$Q[0],a$Q[1]);a$u<a$S;)a$j.lineTo(a$Q[a$u++],a$Q[a$u++]);else for(a$j.moveTo(a$t+a$Q[0],a$k+a$Q[1]);a$u<a$S;)a$j.lineTo(a$t+a$Q[a$u++],a$k+a$Q[a$u++]);a$j.stroke()},this._drawLinesWebGL=function(a$t,a$k,a$v){this.ctx.drawLines(a$t+this.x+a$v[0],a$k+this.y+a$v[1],a$v[2],a$v[3],a$v[4])},this._drawCurves=function(a$t,a$k,a$v){this.ctx.drawCurves(a$t,a$k,a$v)},this._draw=function(a$t,a$k,a$v){a$v[0].call(null,this,a$t,a$k)},this._transformByMatrix=function(a$t,a$k,a$v){this.ctx.transformByMatrix(a$v[0])},this._setTransform=function(a$t,a$k,a$v){this.ctx.setTransform(a$v[0],a$v[1],a$v[2],a$v[3],a$v[4],a$v[5])},this._setTransformByMatrix=function(a$t,a$k,a$v){this.ctx.setTransformByMatrix(a$v[0])},this._save=function(a$t,a$k,a$v){this.ctx.save()},this._restore=function(a$t,a$k,a$v){this.ctx.restore()},this._translate=function(a$t,a$k,a$v){this.ctx.translate(a$v[0],a$v[1])},this._transform=function(a$t,a$k,a$v){this.ctx.translate(a$v[1]+a$t,a$v[2]+a$k);var a$j=a$v[0];this.ctx.transform(a$j.a,a$j.b,a$j.c,a$j.d,a$j.tx,a$j.ty),this.ctx.translate(-a$t-a$v[1],-a$k-a$v[2])},this._rotate=function(a$t,a$k,a$v){this.ctx.translate(a$v[1]+a$t,a$v[2]+a$k),this.ctx.rotate(a$v[0]),this.ctx.translate(-a$t-a$v[1],-a$k-a$v[2])},this._scale=function(a$t,a$k,a$v){this.ctx.translate(a$v[2]+a$t,a$v[3]+a$k),this.ctx.scale(a$v[0],a$v[1]),this.ctx.translate(-a$t-a$v[2],-a$k-a$v[3])},this._alpha=function(a$t,a$k,a$v){this.ctx.globalAlpha*=a$v[0]},this._setAlpha=function(a$t,a$k,a$v){this.ctx.globalAlpha=a$v[0]},this._fillText=function(a$t,a$k,a$v){this.ctx.fillText(a$v[0],a$v[1]+a$t,a$v[2]+a$k,a$v[3],a$v[4],a$v[5])},this._strokeText=function(a$t,a$k,a$v){this.ctx.strokeText(a$v[0],a$v[1]+a$t,a$v[2]+a$k,a$v[3],a$v[4],a$v[5],a$v[6])},this._fillBorderText=function(a$t,a$k,a$v){this.ctx.fillBorderText(a$v[0],a$v[1]+a$t,a$v[2]+a$k,a$v[3],a$v[4],a$v[5],a$v[6],a$v[7])},this._blendMode=function(a$t,a$k,a$v){this.ctx.globalCompositeOperation=a$v[0]},this._beginClip=function(a$t,a$k,a$v){this.ctx.beginClip&&this.ctx.beginClip(a$t+a$v[0],a$k+a$v[1],a$v[2],a$v[3])},this._setIBVB=function(a$t,a$k,a$v){this.ctx.setIBVB(a$v[0]+a$t,a$v[1]+a$k,a$v[2],a$v[3],a$v[4],a$v[5],a$v[6],a$v[7])},this._fillTrangles=function(a$t,a$k,a$v){this.ctx.fillTrangles(a$v[0],a$v[1]+a$t,a$v[2]+a$k,a$v[3],a$v[4])},this._drawPath=function(a$t,a$k,a$v){var a$j=this.ctx;a$c.isWebGL&&a$j.setPathId(-1),a$j.beginPath(),a$t+=a$v[0],a$k+=a$v[1],a$c.isWebGL&&a$j.movePath(a$t,a$k);for(var a$Q=a$v[2],a$u=0,a$S=a$Q.length;a$u<a$S;a$u++){var a$V=a$Q[a$u];switch(a$V[0]){case"moveTo":a$c.isWebGL?a$j.moveTo(a$V[1],a$V[2]):a$j.moveTo(a$t+a$V[1],a$k+a$V[2]);break;case"lineTo":a$c.isWebGL?a$j.lineTo(a$V[1],a$V[2]):a$j.lineTo(a$t+a$V[1],a$k+a$V[2]);break;case"arcTo":a$c.isWebGL?a$j.arcTo(a$V[1],a$V[2],a$V[3],a$V[4],a$V[5]):a$j.arcTo(a$t+a$V[1],a$k+a$V[2],a$t+a$V[3],a$k+a$V[4],a$V[5]);break;case"closePath":a$j.closePath()}}var a$J=a$v[3];null!=a$J&&(a$j.fillStyle=a$J.fillStyle,a$j.fill());var a$W=a$v[4];null!=a$W&&(a$j.strokeStyle=a$W.strokeStyle,a$j.lineWidth=a$W.lineWidth||1,a$j.lineJoin=a$W.lineJoin,a$j.lineCap=a$W.lineCap,a$j.miterLimit=a$W.miterLimit,a$j.stroke())},this.drawPoly=function(a$t,a$k,a$v){this.ctx.drawPoly(a$t+this.x+a$v[0],a$k+this.y+a$v[1],a$v[2],a$v[3],a$v[4],a$v[5],a$v[6])},this._drawPoly=function(a$t,a$k,a$v){var a$j=this.ctx,a$Q=a$v[2],a$u=2,a$S=a$Q.length;if(a$c.isWebGL)for(a$j.setPathId(a$v[6]),a$j.beginPath(),a$t+=a$v[0],a$k+=a$v[1],a$j.movePath(a$t,a$k),a$j.moveTo(a$Q[0],a$Q[1]);a$u<a$S;)a$j.lineTo(a$Q[a$u++],a$Q[a$u++]);else for(a$j.beginPath(),a$t+=a$v[0],a$k+=a$v[1],a$j.moveTo(a$t+a$Q[0],a$k+a$Q[1]);a$u<a$S;)a$j.lineTo(a$t+a$Q[a$u++],a$k+a$Q[a$u++]);a$j.closePath(),this._fillAndStroke(a$v[3],a$v[4],a$v[5],a$v[7])},this._drawSkin=function(a$t,a$k,a$v){var a$j=a$v[0];if(a$j){var a$Q=this.ctx;a$j.render(a$Q,a$t,a$k)}},this._drawParticle=function(a$t,a$k,a$v){this.ctx.drawParticle(a$t+this.x,a$k+this.y,a$v[0])},this._setFilters=function(a$t,a$k,a$v){this.ctx.setFilters(a$v)},a$v?this.ctx=a$v.getContext("2d"):(a$v=a$Yt.create("3D"),this.ctx=a$N.createWebGLContext2D(a$v),a$v._setContext(this.ctx)),a$v.size(a$t,a$k),this.canvas=a$v}a$w(a$S,"laya.renders.RenderContext");var a$t=a$S.prototype;return a$t.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},a$t.drawTexture=function(a$t,a$k,a$v,a$j,a$Q){a$t.loaded&&this.ctx.drawTexture(a$t,a$k,a$v,a$j,a$Q,this.x,this.y)},a$t._drawTextures=function(a$t,a$k,a$v){a$v[0].loaded&&this.ctx.drawTextures(a$v[0],a$v[1],a$t+this.x,a$k+this.y)},a$t.drawTextureWithTransform=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){a$t.loaded&&this.ctx.drawTextureWithTransform(a$t,a$k,a$v,a$j,a$Q,a$u,this.x,this.y,a$S)},a$t.fillQuadrangle=function(a$t,a$k,a$v,a$j,a$Q){this.ctx.fillQuadrangle(a$t,a$k,a$v,a$j,a$Q)},a$t.drawCanvas=function(a$t,a$k,a$v,a$j,a$Q){this.ctx.drawCanvas(a$t,a$k+this.x,a$v+this.y,a$j,a$Q)},a$t.drawRect=function(a$t,a$k,a$v,a$j,a$Q,a$u){void 0===a$u&&(a$u=1);var a$S=this.ctx;a$S.strokeStyle=a$Q,a$S.lineWidth=a$u,a$S.strokeRect(a$t+this.x,a$k+this.y,a$v,a$j,a$u)},a$t._fillAndStroke=function(a$t,a$k,a$v,a$j){void 0===a$j&&(a$j=!1);var a$Q=this.ctx;null!=a$t&&(a$Q.fillStyle=a$t,a$c.isWebGL?a$Q.fill(a$j):a$Q.fill()),null!=a$k&&0<a$v&&(a$Q.strokeStyle=a$k,a$Q.lineWidth=a$v,a$Q.stroke())},a$t.clipRect=function(a$t,a$k,a$v,a$j){this.ctx.clipRect(a$t+this.x,a$k+this.y,a$v,a$j)},a$t.fillRect=function(a$t,a$k,a$v,a$j,a$Q){this.ctx.fillRect(a$t+this.x,a$k+this.y,a$v,a$j,a$Q)},a$t.drawCircle=function(a$t,a$k,a$v,a$j,a$Q){void 0===a$Q&&(a$Q=1),a$L.drawCall++;var a$u=this.ctx;a$u.beginPath(),a$u.strokeStyle=a$j,a$u.lineWidth=a$Q,a$u.arc(a$t+this.x,a$k+this.y,a$v,0,a$S.PI2),a$u.stroke()},a$t.drawTriangles=function(a$t,a$k,a$v){if(a$c.isWebGL)this.ctx.drawTriangles(a$v[0],a$t+a$v[1],a$k+a$v[2],a$v[3],a$v[4],a$v[5],a$v[6],a$v[7],a$v[8],a$v[9]);else{var a$j=a$v[5],a$Q=0,a$u=a$j.length,a$S=this.ctx;for(a$Q=0;a$Q<a$u;a$Q+=3){var a$V=2*a$j[a$Q],a$J=2*a$j[a$Q+1],a$W=2*a$j[a$Q+2];a$S.drawTriangle(a$v[0],a$v[3],a$v[4],a$V,a$J,a$W,a$v[6],!0)}}},a$t.fillCircle=function(a$t,a$k,a$v,a$j){a$L.drawCall++;var a$Q=this.ctx;a$Q.beginPath(),a$Q.fillStyle=a$j,a$Q.arc(a$t+this.x,a$k+this.y,a$v,0,a$S.PI2),a$Q.fill()},a$t.setShader=function(a$t){this.ctx.setShader(a$t)},a$t.drawLine=function(a$t,a$k,a$v,a$j,a$Q,a$u){void 0===a$u&&(a$u=1);var a$S=this.ctx;a$S.beginPath(),a$S.strokeStyle=a$Q,a$S.lineWidth=a$u,a$S.moveTo(this.x+a$t,this.y+a$k),a$S.lineTo(this.x+a$v,this.y+a$j),a$S.stroke()},a$t.clear=function(){this.ctx.clear()},a$t.transformByMatrix=function(a$t){this.ctx.transformByMatrix(a$t)},a$t.setTransform=function(a$t,a$k,a$v,a$j,a$Q,a$u){this.ctx.setTransform(a$t,a$k,a$v,a$j,a$Q,a$u)},a$t.setTransformByMatrix=function(a$t){this.ctx.setTransformByMatrix(a$t)},a$t.save=function(){this.ctx.save()},a$t.restore=function(){this.ctx.restore()},a$t.translate=function(a$t,a$k){this.ctx.translate(a$t,a$k)},a$t.transform=function(a$t,a$k,a$v,a$j,a$Q,a$u){this.ctx.transform(a$t,a$k,a$v,a$j,a$Q,a$u)},a$t.rotate=function(a$t){this.ctx.rotate(a$t)},a$t.scale=function(a$t,a$k){this.ctx.scale(a$t,a$k)},a$t.alpha=function(a$t){this.ctx.globalAlpha*=a$t},a$t.setAlpha=function(a$t){this.ctx.globalAlpha=a$t},a$t.fillWords=function(a$t,a$k,a$v,a$j,a$Q,a$u){void 0===a$u&&(a$u=0),this.ctx.fillWords(a$t,a$k,a$v,a$j,a$Q,a$u)},a$t.fillBorderWords=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this.ctx.fillBorderWords(a$t,a$k,a$v,a$j,a$Q,a$u,a$S)},a$t.fillText=function(a$t,a$k,a$v,a$j,a$Q,a$u){this.ctx.fillText(a$t,a$k+this.x,a$v+this.y,a$j,a$Q,a$u)},a$t.strokeText=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this.ctx.strokeText(a$t,a$k+this.x,a$v+this.y,a$j,a$Q,a$u,a$S)},a$t.blendMode=function(a$t){this.ctx.globalCompositeOperation=a$t},a$t.flush=function(){this.ctx.flush&&this.ctx.flush()},a$t.addRenderObject=function(a$t){this.ctx.addRenderObject(a$t)},a$t.beginClip=function(a$t,a$k,a$v,a$j){this.ctx.beginClip&&this.ctx.beginClip(a$t,a$k,a$v,a$j)},a$t.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},a$t.fillTrangles=function(a$t,a$k,a$v){this.ctx.fillTrangles(a$v[0],a$v[1],a$v[2],a$v[3],4<a$v.length?a$v[4]:null)},a$S.PI2=2*Math.PI,a$S}(),a$p=function(){function a$S(a$t,a$k){switch(this._next=a$k||a$S.NORENDER,a$t){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=a$l._filter);case 69905:return void(this._fun=a$S._initRenderFun)}this.onCreate(a$t)}a$w(a$S,"laya.renders.RenderSprite");var a$t=a$S.prototype;return a$t.onCreate=function(a$t){},a$t._style=function(a$t,a$k,a$v,a$j){a$t._style.render(a$t,a$k,a$v,a$j);var a$Q=this._next;a$Q._fun.call(a$Q,a$t,a$k,a$v,a$j)},a$t._no=function(a$t,a$k,a$v,a$j){},a$t._custom=function(a$t,a$k,a$v,a$j){a$t.customRender(a$k,a$v,a$j);var a$Q=a$t._style._tf;this._next._fun.call(this._next,a$t,a$k,a$v-a$Q.translateX,a$j-a$Q.translateY)},a$t._clip=function(a$t,a$k,a$v,a$j){var a$Q=this._next;if(a$Q!=a$S.NORENDER){var a$u=a$t._style.scrollRect;a$k.ctx.save(),a$k.ctx.clipRect(a$v,a$j,a$u.width,a$u.height),a$Q._fun.call(a$Q,a$t,a$k,a$v-a$u.x,a$j-a$u.y),a$k.ctx.restore()}},a$t._blend=function(a$t,a$k,a$v,a$j){var a$Q=a$t._style;a$Q.blendMode&&(a$k.ctx.globalCompositeOperation=a$Q.blendMode);var a$u=this._next;a$u._fun.call(a$u,a$t,a$k,a$v,a$j),a$k.ctx.globalCompositeOperation="source-over"},a$t._mask=function(a$t,a$k,a$v,a$j){var a$Q=this._next;a$Q._fun.call(a$Q,a$t,a$k,a$v,a$j);var a$u=a$t.mask;a$u&&(a$k.ctx.globalCompositeOperation="destination-in",(0<a$u.numChildren||!a$u.graphics._isOnlyOne())&&(a$u.cacheAsBitmap=!0),a$u.render(a$k,a$v-a$t.pivotX,a$j-a$t.pivotY)),a$k.ctx.globalCompositeOperation="source-over"},a$t._graphics=function(a$t,a$k,a$v,a$j){var a$Q=a$t._style._tf;a$t._graphics&&a$t._graphics._render(a$t,a$k,a$v-a$Q.translateX,a$j-a$Q.translateY);var a$u=this._next;a$u._fun.call(a$u,a$t,a$k,a$v,a$j)},a$t._image=function(a$t,a$k,a$v,a$j){var a$Q=a$t._style;a$k.ctx.drawTexture2(a$v,a$j,a$Q._tf.translateX,a$Q._tf.translateY,a$t.transform,a$Q.alpha,a$Q.blendMode,a$t._graphics._one)},a$t._image2=function(a$t,a$k,a$v,a$j){var a$Q=a$t._style._tf;a$k.ctx.drawTexture2(a$v,a$j,a$Q.translateX,a$Q.translateY,a$t.transform,1,null,a$t._graphics._one)},a$t._alpha=function(a$t,a$k,a$v,a$j){var a$Q;if(.01<(a$Q=a$t._style.alpha)||a$t._needRepaint()){var a$u=a$k.ctx.globalAlpha;a$k.ctx.globalAlpha*=a$Q;var a$S=this._next;a$S._fun.call(a$S,a$t,a$k,a$v,a$j),a$k.ctx.globalAlpha=a$u}},a$t._transform=function(a$t,a$k,a$v,a$j){var a$Q=a$t.transform,a$u=this._next;a$Q&&a$u!=a$S.NORENDER?(a$k.save(),a$k.transform(a$Q.a,a$Q.b,a$Q.c,a$Q.d,a$Q.tx+a$v,a$Q.ty+a$j),a$u._fun.call(a$u,a$t,a$k,0,0),a$k.restore()):a$u._fun.call(a$u,a$t,a$k,a$v,a$j)},a$t._childs=function(a$t,a$k,a$v,a$j){var a$Q=a$t._style,a$u=a$Q._tf;if(a$v=a$v-a$u.translateX+a$Q.paddingLeft,a$j=a$j-a$u.translateY+a$Q.paddingTop,a$Q._calculation){var a$S=a$t._getWords();if(a$S){var a$V=a$Q;a$V&&(a$V.stroke?a$k.fillBorderWords(a$S,a$v,a$j,a$V.font,a$V.color,a$V.strokeColor,a$V.stroke):a$k.fillWords(a$S,a$v,a$j,a$V.font,a$V.color,"none"!=a$V.textDecoration&&a$V.underLine?1:0))}}var a$J,a$W=a$t._childs,a$w=a$W.length;if(a$t.viewport||a$t.optimizeScrollRect&&a$t._style.scrollRect){var a$M=a$t.viewport||a$t._style.scrollRect,a$H=a$M.x,a$E=a$M.y,a$A=a$M.right,a$R=a$M.bottom,a$h=NaN,a$l=NaN;for(a$o=0;a$o<a$w;++a$o)(a$J=a$W[a$o]).visible&&(a$h=a$J._x)<a$A&&a$h+a$J.width>a$H&&(a$l=a$J._y)<a$R&&a$l+a$J.height>a$E&&a$J.render(a$k,a$v,a$j)}else for(var a$o=0;a$o<a$w;++a$o)(a$J=a$W[a$o])._style.visible&&a$J.render(a$k,a$v,a$j)},a$t._canvas=function(a$t,a$k,a$v,a$j){var a$Q=a$t._$P.cacheCanvas;if(a$Q){"bitmap"===a$Q.type?a$L.canvasBitmap++:a$L.canvasNormal++;var a$u=a$Q.ctx;if(a$t._needRepaint()||!a$u)this._canvas_repaint(a$t,a$k,a$v,a$j);else{var a$S=a$Q._cacheRec;a$k.drawCanvas(a$u.canvas,a$v+a$S.x,a$j+a$S.y,a$S.width,a$S.height)}}else this._next._fun.call(this._next,a$t,a$k,a$v,a$j)},a$t._canvas_repaint=function(a$t,a$k,a$v,a$j){var a$Q=a$t._$P.cacheCanvas,a$u=this._next;if(a$Q){var a$S,a$V,a$J,a$W,a$w=a$Q.ctx,a$M=a$t._needRepaint()||!a$w,a$H=a$Q.type;if("bitmap"===a$H?a$L.canvasBitmap++:a$L.canvasNormal++,a$M){var a$E,a$A;a$Q._cacheRec||(a$Q._cacheRec=new a$Z),a$c.isWebGL&&"bitmap"!==a$H?a$Q._cacheRec.setTo(-a$t.pivotX,-a$t.pivotY,1,1):((a$W=a$t.getSelfBounds()).x=a$W.x-a$t.pivotX,a$W.y=a$W.y-a$t.pivotY,a$W.x=a$W.x-16,a$W.y=a$W.y-16,a$W.width=a$W.width+32,a$W.height=a$W.height+32,a$W.x=Math.floor(a$W.x+a$v)-a$v,a$W.y=Math.floor(a$W.y+a$j)-a$j,a$W.width=Math.floor(a$W.width),a$W.height=Math.floor(a$W.height),a$Q._cacheRec.copyFrom(a$W)),a$W=a$Q._cacheRec;var a$R,a$h=a$c.isWebGL?1:a$_.pixelRatio*a$d.stage.clientScaleX,a$l=a$c.isWebGL?1:a$_.pixelRatio*a$d.stage.clientScaleY;if(!a$c.isWebGL){var a$o,a$Y=1,a$f=1;for(a$o=a$t;a$o&&a$o!=a$d.stage;)a$Y*=a$o.scaleX,a$f*=a$o.scaleY,a$o=a$o.parent;a$c.isWebGL?(a$Y<1&&(a$h*=a$Y),a$f<1&&(a$l*=a$f)):(1<a$Y&&(a$h*=a$Y),1<a$f&&(a$l*=a$f))}if(a$t.scrollRect){var a$X=a$t.scrollRect;a$W.x-=a$X.x,a$W.y-=a$X.y}if(a$E=a$W.width*a$h,a$A=a$W.height*a$l,a$V=a$W.x,a$J=a$W.y,a$c.isWebGL&&"bitmap"===a$H&&(2048<a$E||2048<a$A))return console.warn("cache bitmap size larger than 2048,cache ignored"),a$Q.ctx&&(a$C.recover("RenderContext",a$Q.ctx),a$Q.ctx.canvas.size(0,0),a$Q.ctx=null),void a$u._fun.call(a$u,a$t,a$k,a$v,a$j);if(a$w||(a$w=a$Q.ctx=a$C.getItem("RenderContext")||new a$T(a$E,a$A,a$Yt.create("AUTO"))),a$w.ctx.sprite=a$t,(a$S=a$w.canvas).clear(),(a$S.width!=a$E||a$S.height!=a$A)&&a$S.size(a$E,a$A),"bitmap"===a$H?a$S.context.asBitmap=!0:"normal"===a$H&&(a$S.context.asBitmap=!1),1!=a$h||1!=a$l){var a$F=a$w.ctx;a$F.save(),a$F.scale(a$h,a$l),!a$c.isConchWebGL&&a$c.isConchApp&&(a$R=a$t._$P.cf)&&a$F.setFilterMatrix&&a$F.setFilterMatrix(a$R._mat,a$R._alpha),a$u._fun.call(a$u,a$t,a$w,-a$V,-a$J),a$F.restore(),a$c.isConchApp&&!a$c.isConchWebGL||a$t._applyFilters()}else a$F=a$w.ctx,!a$c.isConchWebGL&&a$c.isConchApp&&(a$R=a$t._$P.cf)&&a$F.setFilterMatrix&&a$F.setFilterMatrix(a$R._mat,a$R._alpha),a$u._fun.call(a$u,a$t,a$w,-a$V,-a$J),a$c.isConchApp&&!a$c.isConchWebGL||a$t._applyFilters();a$t._$P.staticCache&&(a$Q.reCache=!1),a$L.canvasReCache++}else a$V=(a$W=a$Q._cacheRec).x,a$J=a$W.y,a$S=a$w.canvas;a$k.drawCanvas(a$S,a$v+a$V,a$j+a$J,a$W.width,a$W.height)}else a$u._fun.call(a$u,a$t,a$w,a$v,a$j)},a$S.__init__=function(){var a$t,a$k,a$v=0;for(a$k=a$N.createRenderSprite(69905,null),a$t=a$S.renders.length=4096,a$v=0;a$v<a$t;a$v++)a$S.renders[a$v]=a$k;a$S.renders[0]=a$N.createRenderSprite(0,null),function(a$t,a$k){for(var a$v=0,a$j=0;a$j<a$t.length;a$j++)a$v|=a$t[a$j],a$S.renders[a$v]=a$k}([1,512,4,2],new a$S(1,null)),a$S.renders[513]=a$N.createRenderSprite(513,null),a$S.renders[517]=new a$S(517,null)},a$S._initRenderFun=function(a$t,a$k,a$v,a$j){var a$Q=a$t._renderType;(a$S.renders[a$Q]=a$S._getTypeRender(a$Q))._fun(a$t,a$k,a$v,a$j)},a$S._getTypeRender=function(a$t){for(var a$k=null,a$v=2048;1<a$v;)a$v&a$t&&(a$k=a$N.createRenderSprite(a$v,a$k)),a$v>>=1;return a$k},a$S.IMAGE=1,a$S.ALPHA=2,a$S.TRANSFORM=4,a$S.BLEND=8,a$S.CANVAS=16,a$S.FILTERS=32,a$S.MASK=64,a$S.CLIP=128,a$S.STYLE=256,a$S.GRAPHICS=512,a$S.CUSTOM=1024,a$S.CHILDS=2048,a$S.INIT=69905,a$S.renders=[],a$S.NORENDER=new a$S(0,null),a$S}(),a$O=function(){function a$V(){this._repaint=!1}a$w(a$V,"laya.resource.Context");var a$t=a$V.prototype;return a$t.replaceReset=function(){var a$t,a$k,a$v=0;for(a$t=a$V.replaceKeys.length,a$v=0;a$v<a$t;a$v++)a$k=a$V.replaceKeys[a$v],this[a$V.newKeys[a$v]]=this[a$k]},a$t.replaceResotre=function(){this.__restore(),this.__reset()},a$t.setIsMainContext=function(){},a$t.drawTextures=function(a$t,a$k,a$v,a$j){a$L.drawCall+=a$k.length/2;for(var a$Q=a$t.width,a$u=a$t.height,a$S=0,a$V=a$k.length;a$S<a$V;a$S+=2)this.drawTexture(a$t,a$k[a$S],a$k[a$S+1],a$Q,a$u,a$v,a$j)},a$t.drawCanvas=function(a$t,a$k,a$v,a$j,a$Q){a$L.drawCall++,this.drawImage(a$t.source,a$k,a$v,a$j,a$Q)},a$t.fillRect=function(a$t,a$k,a$v,a$j,a$Q){a$L.drawCall++,a$Q&&(this.fillStyle=a$Q),this.__fillRect(a$t,a$k,a$v,a$j)},a$t.fillText=function(a$t,a$k,a$v,a$j,a$Q,a$u){a$L.drawCall++,3<arguments.length&&null!=a$j&&(this.font=a$j,this.fillStyle=a$Q,this.textAlign=a$u,this.textBaseline="top"),this.__fillText(a$t,a$k,a$v)},a$t.fillBorderText=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){a$L.drawCall++,this.font=a$j,this.fillStyle=a$Q,this.textBaseline="top",this.strokeStyle=a$u,this.lineWidth=a$S,this.textAlign=a$V,this.__strokeText(a$t,a$k,a$v),this.__fillText(a$t,a$k,a$v)},a$t.strokeText=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){a$L.drawCall++,3<arguments.length&&null!=a$j&&(this.font=a$j,this.strokeStyle=a$Q,this.lineWidth=a$u,this.textAlign=a$S,this.textBaseline="top"),this.__strokeText(a$t,a$k,a$v)},a$t.transformByMatrix=function(a$t){this.transform(a$t.a,a$t.b,a$t.c,a$t.d,a$t.tx,a$t.ty)},a$t.setTransformByMatrix=function(a$t){this.setTransform(a$t.a,a$t.b,a$t.c,a$t.d,a$t.tx,a$t.ty)},a$t.clipRect=function(a$t,a$k,a$v,a$j){a$L.drawCall++,this.beginPath(),this.rect(a$t,a$k,a$v,a$j),this.clip()},a$t.drawTexture=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){a$L.drawCall++;var a$V=a$t.uv,a$J=a$t.bitmap.width,a$W=a$t.bitmap.height;this.drawImage(a$t.source,a$V[0]*a$J,a$V[1]*a$W,(a$V[2]-a$V[0])*a$J,(a$V[5]-a$V[3])*a$W,a$k+a$u,a$v+a$S,a$j,a$Q)},a$t.drawTextureWithTransform=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){a$L.drawCall++;var a$W=a$t.uv,a$w=a$t.bitmap.width,a$M=a$t.bitmap.height;this.save(),1!=a$J&&(this.globalAlpha*=a$J),a$u?(this.transform(a$u.a,a$u.b,a$u.c,a$u.d,a$u.tx+a$S,a$u.ty+a$V),this.drawImage(a$t.source,a$W[0]*a$w,a$W[1]*a$M,(a$W[2]-a$W[0])*a$w,(a$W[5]-a$W[3])*a$M,a$k,a$v,a$j,a$Q)):this.drawImage(a$t.source,a$W[0]*a$w,a$W[1]*a$M,(a$W[2]-a$W[0])*a$w,(a$W[5]-a$W[3])*a$M,a$k+a$S,a$v+a$V,a$j,a$Q),this.restore()},a$t.drawTexture2=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){var a$J=a$V[0];if(a$J.loaded&&a$J.bitmap&&a$J.source){a$L.drawCall++;var a$W=1!==a$u;if(a$W){var a$w=this.globalAlpha;this.globalAlpha*=a$u}var a$M=a$J.uv,a$H=a$J.bitmap.width,a$E=a$J.bitmap.height;a$Q?(this.save(),this.transform(a$Q.a,a$Q.b,a$Q.c,a$Q.d,a$Q.tx+a$t,a$Q.ty+a$k),this.drawImage(a$J.source,a$M[0]*a$H,a$M[1]*a$E,(a$M[2]-a$M[0])*a$H,(a$M[5]-a$M[3])*a$E,a$V[1]-a$v,a$V[2]-a$j,a$V[3],a$V[4]),this.restore()):this.drawImage(a$J.source,a$M[0]*a$H,a$M[1]*a$E,(a$M[2]-a$M[0])*a$H,(a$M[5]-a$M[3])*a$E,a$V[1]-a$v+a$t,a$V[2]-a$j+a$k,a$V[3],a$V[4]),a$W&&(this.globalAlpha=a$w)}},a$t.fillTexture=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){if(!a$V.pat){if(a$t.uv!=a$wt.DEF_UV){var a$J=new a$Yt("2D");a$J.getContext("2d"),a$J.size(a$t.width,a$t.height),a$J.context.drawTexture(a$t,0,0,a$t.width,a$t.height,0,0),a$t=new a$wt(a$J)}a$V.pat=this.createPattern(a$t.bitmap.source,a$u)}var a$W=a$k,a$w=a$v,a$M=0,a$H=0;a$S&&(a$W+=a$S.x%a$t.width,a$w+=a$S.y%a$t.height,a$M-=a$S.x%a$t.width,a$H-=a$S.y%a$t.height),this.translate(a$W,a$w),this.fillRect(a$M,a$H,a$j,a$Q,a$V.pat),this.translate(-a$W,-a$w)},a$t.drawTriangle=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){var a$J=a$t.bitmap,a$W=a$J.source,a$w=a$t.width,a$M=a$t.height,a$H=a$J.width,a$E=a$J.height,a$A=a$v[a$j]*a$H,a$R=a$v[a$Q]*a$H,a$h=a$v[a$u]*a$H,a$l=a$v[a$j+1]*a$E,a$o=a$v[a$Q+1]*a$E,a$Y=a$v[a$u+1]*a$E,a$f=a$k[a$j],a$X=a$k[a$Q],a$F=a$k[a$u],a$d=a$k[a$j+1],a$m=a$k[a$Q+1],a$Z=a$k[a$u+1];if(a$V){var a$s=(a$f+a$X+a$F)/3,a$K=(a$d+a$m+a$Z)/3,a$U=a$f-a$s,a$N=a$d-a$K,a$a=Math.sqrt(a$U*a$U+a$N*a$N);a$f=a$s+a$U/a$a*(a$a+1),a$d=a$K+a$N/a$a*(a$a+1),a$N=a$m-a$K,a$X=a$s+(a$U=a$X-a$s)/(a$a=Math.sqrt(a$U*a$U+a$N*a$N))*(a$a+1),a$m=a$K+a$N/a$a*(a$a+1),a$N=a$Z-a$K,a$F=a$s+(a$U=a$F-a$s)/(a$a=Math.sqrt(a$U*a$U+a$N*a$N))*(a$a+1),a$Z=a$K+a$N/a$a*(a$a+1)}this.save(),a$S&&this.transform(a$S.a,a$S.b,a$S.c,a$S.d,a$S.tx,a$S.ty),this.beginPath(),this.moveTo(a$f,a$d),this.lineTo(a$X,a$m),this.lineTo(a$F,a$Z),this.closePath(),this.clip();var a$z=1/(a$A*a$o+a$l*a$h+a$R*a$Y-a$o*a$h-a$l*a$R-a$A*a$Y),a$G=a$f*a$o+a$l*a$F+a$X*a$Y-a$o*a$F-a$l*a$X-a$f*a$Y,a$c=a$A*a$X+a$f*a$h+a$R*a$F-a$X*a$h-a$f*a$R-a$A*a$F,a$T=a$A*a$o*a$F+a$l*a$X*a$h+a$f*a$R*a$Y-a$f*a$o*a$h-a$l*a$R*a$F-a$A*a$X*a$Y,a$p=a$d*a$o+a$l*a$Z+a$m*a$Y-a$o*a$Z-a$l*a$m-a$d*a$Y,a$O=a$A*a$m+a$d*a$h+a$R*a$Z-a$m*a$h-a$d*a$R-a$A*a$Z,a$n=a$A*a$o*a$Z+a$l*a$m*a$h+a$d*a$R*a$Y-a$d*a$o*a$h-a$l*a$R*a$Z-a$A*a$m*a$Y;this.transform(a$G*a$z,a$p*a$z,a$c*a$z,a$O*a$z,a$T*a$z,a$n*a$z),this.drawImage(a$W,a$t.uv[0]*a$H,a$t.uv[1]*a$E,a$w,a$M,a$t.uv[0]*a$H,a$t.uv[1]*a$E,a$w,a$M),this.restore()},a$t.flush=function(){return 0},a$t.fillWords=function(a$t,a$k,a$v,a$j,a$Q,a$u){a$j&&(this.font=a$j),a$Q&&(this.fillStyle=a$Q);this.textBaseline="top",this.textAlign="left";for(var a$S=0,a$V=a$t.length;a$S<a$V;a$S++){var a$J=a$t[a$S];if(this.__fillText(a$J.char,a$J.x+a$k,a$J.y+a$v),1===a$u){var a$W=a$J.height,a$w=.5*a$J.style.letterSpacing;a$w||(a$w=0),this.beginPath(),this.strokeStyle=a$Q,this.lineWidth=1,this.moveTo(a$k+a$J.x-a$w+.5,a$v+a$J.y+a$W+.5),this.lineTo(a$k+a$J.x+a$J.width+a$w+.5,a$v+a$J.y+a$W+.5),this.stroke()}}},a$t.fillBorderWords=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){a$j&&(this.font=a$j),a$Q&&(this.fillStyle=a$Q),this.textBaseline="top",this.lineWidth=a$S,this.textAlign="left",this.strokeStyle=a$u;for(var a$V=0,a$J=a$t.length;a$V<a$J;a$V++){var a$W=a$t[a$V];this.__strokeText(a$W.char,a$W.x+a$k,a$W.y+a$v),this.__fillText(a$W.char,a$W.x+a$k,a$W.y+a$v)}},a$t.destroy=function(){this.canvas.width=this.canvas.height=0},a$t.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},a$t.drawCurves=function(a$t,a$k,a$v){this.beginPath(),this.strokeStyle=a$v[3],this.lineWidth=a$v[4];var a$j=a$v[2];a$t+=a$v[0],a$k+=a$v[1],this.moveTo(a$t+a$j[0],a$k+a$j[1]);for(var a$Q=2,a$u=a$j.length;a$Q<a$u;)this.quadraticCurveTo(a$t+a$j[a$Q++],a$k+a$j[a$Q++],a$t+a$j[a$Q++],a$k+a$j[a$Q++]);this.stroke()},a$V.__init__=function(a$k){var a$v=laya.resource.Context.prototype;if(!(a$k=a$k||CanvasRenderingContext2D.prototype).inited){a$k.inited=!0,a$k.__fillText=a$k.fillText,a$k.__fillRect=a$k.fillRect,a$k.__strokeText=a$k.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(a$t){a$k[a$t]=a$v[a$t]})}},a$V.replaceCanvasGetSet=function(a$t,a$k){var a$v=Object.getOwnPropertyDescriptor(a$t,a$k);if(!a$v||!a$v.configurable)return!1;var a$j,a$Q={};for(a$j in a$v)"set"!=a$j&&(a$Q[a$j]=a$v[a$j]);var a$u=a$v.set;return a$Q.set=function(a$t){a$u.call(this,a$t);var a$k=this.getContext("2d");a$k&&"__reset"in a$k&&a$k.__reset()},Object.defineProperty(a$t,a$k,a$Q),!0},a$V.replaceGetSet=function(a$t,a$k){var a$v=Object.getOwnPropertyDescriptor(a$t,a$k);if(!a$v||!a$v.configurable)return!1;var a$j,a$Q={};for(a$j in a$v)"set"!=a$j&&(a$Q[a$j]=a$v[a$j]);var a$u=a$v.set,a$S="___"+a$k+"__";return a$V.newKeys.push(a$S),a$Q.set=function(a$t){a$t!=this[a$S]&&(this[a$S]=a$t,a$u.call(this,a$t))},Object.defineProperty(a$t,a$k,a$Q),!0},a$V._default=new a$V,a$V.newKeys=[],a$J(a$V,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),a$V}(),a$n=function(){function a$u(a$t){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++a$u._uniqueIDCounter,this._name=a$t||"Content Manager",a$u._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,a$u._resourceManagers.push(this),this._resources=[],this._records={}}a$w(a$u,"laya.resource.ResourceManager");var a$t=a$u.prototype;return a$d.imps(a$t,{"laya.resource.IDispose":!0}),a$t.getResourceByIndex=function(a$t){return this._resources[a$t]},a$t.getResourcesLength=function(){return this._resources.length},a$t.addResource=function(a$t){return a$t.resourceManager&&a$t.resourceManager.removeResource(a$t),-1===this._resources.indexOf(a$t)&&((a$t._resourceManager=this)._resources.push(a$t),this.addRecord(a$t.uri,a$t.__className,a$t.memorySize),this.addSize(a$t.memorySize),!0)},a$t.removeResource=function(a$t){var a$k=this._resources.indexOf(a$t);return-1!==a$k&&(this._resources.splice(a$k,1),a$t._resourceManager=null,this._memorySize-=a$t.memorySize,this.addRecord(a$t.uri,a$t.__className,-a$t.memorySize),!0)},a$t.unload=function(){for(var a$t=this._resources.slice(0,this._resources.length),a$k=0;a$k<a$t.length;a$k++){a$t[a$k].destroy()}a$t.length=0},a$t.dispose=function(){if(this===a$u._systemResourceManager)throw new Error("systemResourceManager不能被释放！");a$u._resourceManagers.splice(a$u._resourceManagers.indexOf(this),1),a$u._isResourceManagersSorted=!1;for(var a$t=this._resources.slice(0,this._resources.length),a$k=0;a$k<a$t.length;a$k++){var a$v=a$t[a$k];a$v.resourceManager.removeResource(a$v),a$v.destroy()}a$t.length=0},a$t.addSize=function(a$t){a$t&&(this.autoRelease&&0<a$t&&this._memorySize+a$t>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=a$t)},a$t.addRecord=function(a$t,a$k,a$v){DEBUG&&a$v&&!a$t&&console.error(a$t,a$k,a$v),a$t&&(this._records.hasOwnProperty(a$k+"|"+a$t)||(this._records[a$k+"|"+a$t]=0),this._records[a$k+"|"+a$t]+=a$v,DEBUG&&this._records[a$k+"|"+a$t]<0&&console.error(a$t,a$k,this._records[a$k+"|"+a$t]))},a$t.garbageCollection=function(a$t){var a$k=this._resources;(a$k=a$k.slice()).sort(function(a$t,a$k){if(!a$t||!a$k)throw new Error("a或b不能为空！");return a$t.released&&a$k.released?0:a$t.released?1:a$k.released?-1:a$t._lastUseFrameCount-a$k._lastUseFrameCount});for(var a$v=a$L.loopCount,a$j=0,a$Q=a$k.length;a$j<a$Q;a$j++){var a$u=a$k[a$j];if(!(1<a$v-a$u._lastUseFrameCount))return void(this._memorySize>=a$t&&(this._isOverflow=!0));if(a$u.releaseResource(),this._memorySize<a$t)return void(this._isOverflow=!1)}},a$A(0,a$t,"id",function(){return this._id}),a$A(0,a$t,"name",function(){return this._name},function(a$t){!a$t&&""===a$t||this._name===a$t||(this._name=a$t,a$u._isResourceManagersSorted=!1)}),a$A(0,a$t,"memorySize",function(){return this._memorySize}),a$A(0,a$t,"records",function(){return this._records}),a$A(1,a$u,"systemResourceManager",function(){return a$u._systemResourceManager}),a$u.__init__=function(){a$u.currentResourceManager=a$u.systemResourceManager},a$u.getLoadedResourceManagerByIndex=function(a$t){return a$u._resourceManagers[a$t]},a$u.getLoadedResourceManagersCount=function(){return a$u._resourceManagers.length},a$u.recreateContentManagers=function(a$t){void 0===a$t&&(a$t=!1);for(var a$k=a$u.currentResourceManager,a$v=0;a$v<a$u._resourceManagers.length;a$v++){a$u.currentResourceManager=a$u._resourceManagers[a$v];for(var a$j=0;a$j<a$u.currentResourceManager._resources.length;a$j++)a$u.currentResourceManager._resources[a$j].releaseResource(a$t),a$u.currentResourceManager._resources[a$j].activeResource(a$t)}a$u.currentResourceManager=a$k},a$u.releaseContentManagers=function(a$t){void 0===a$t&&(a$t=!1);for(var a$k=a$u.currentResourceManager,a$v=0;a$v<a$u._resourceManagers.length;a$v++){a$u.currentResourceManager=a$u._resourceManagers[a$v];for(var a$j=0;a$j<a$u.currentResourceManager._resources.length;a$j++){var a$Q=a$u.currentResourceManager._resources[a$j];!a$Q.released&&a$Q.releaseResource(a$t)}}a$u.currentResourceManager=a$k},a$u._uniqueIDCounter=0,a$u._isResourceManagersSorted=!1,a$u._resourceManagers=[],a$J(a$u,["_systemResourceManager",function(){return this._systemResourceManager=new a$u("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=a$u._systemResourceManager}]),a$u}(),a$_=(function(){function a$t(){}a$w(a$t,"laya.system.System"),a$t.changeDefinition=function(a$t,a$k){a$d[a$t]=a$k;var a$v=a$t+"=classObj";a$d._runScript(a$v)},a$t.__init__=function(){a$c.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function a$v(){}return a$w(a$v,"laya.utils.Browser"),a$A(1,a$v,"pixelRatio",function(){return a$v.__init__(),-1<a$v.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:a$N.getPixelRatio()}),a$A(1,a$v,"height",function(){return a$v.__init__(),(a$d.stage&&a$d.stage.canvasRotation?a$v.clientWidth:a$v.clientHeight)*a$v.pixelRatio}),a$A(1,a$v,"clientWidth",function(){return a$v.__init__(),a$v.window.innerWidth||a$v.document.body.clientWidth}),a$A(1,a$v,"window",function(){return a$v.__init__(),a$v._window}),a$A(1,a$v,"clientHeight",function(){return a$v.__init__(),a$v.window.innerHeight||a$v.document.body.clientHeight||a$v.document.documentElement.clientHeight}),a$A(1,a$v,"width",function(){return a$v.__init__(),(a$d.stage&&a$d.stage.canvasRotation?a$v.clientHeight:a$v.clientWidth)*a$v.pixelRatio}),a$A(1,a$v,"container",function(){return a$v.__init__(),a$v._container||((a$v._container=a$v.createElement("div")).id="layaContainer",a$v.document.body.appendChild(a$v._container)),a$v._container},function(a$t){a$v._container=a$t}),a$A(1,a$v,"document",function(){return a$v.__init__(),a$v._document}),a$v.__init__=function(){if(!a$v._window){a$v._window=a$N.getWindow(),a$v._document=a$v.window.document,a$v._window.addEventListener("message",function(a$t){laya.utils.Browser._onMessage(a$t)},!1),a$v.document.__createElement=a$v.document.createElement,a$S.requestAnimationFrame=a$S.requestAnimationFrame||a$S.webkitRequestAnimationFrame||a$S.mozRequestAnimationFrame||a$S.oRequestAnimationFrame||a$S.msRequestAnimationFrame||function(a$t){return a$S.setTimeout(a$t,1e3/60)};var a$t=a$S.document.body.style;a$t["-webkit-user-select"]="none",a$t["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",a$v.userAgent=a$v.window.navigator.userAgent,a$v.onIOS=!!(a$v.u=a$v.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),a$v.onMobile=-1<a$v.u.indexOf("Mobile"),a$v.onIPhone=-1<a$v.u.indexOf("iPhone"),a$v.onMac=-1<a$v.u.indexOf("Mac OS X"),a$v.onIPad=-1<a$v.u.indexOf("iPad"),a$v.onAndroid=-1<a$v.u.indexOf("Android")||-1<a$v.u.indexOf("Adr"),a$v.onWP=-1<a$v.u.indexOf("Windows Phone"),a$v.onQQBrowser=-1<a$v.u.indexOf("QQBrowser"),a$v.onMQQBrowser=-1<a$v.u.indexOf("MQQBrowser")||-1<a$v.u.indexOf("Mobile")&&-1<a$v.u.indexOf("QQ"),a$v.onIE=!!a$v.window.ActiveXObject||"ActiveXObject"in a$v.window,a$v.onWeiXin=-1<a$v.u.indexOf("MicroMessenger"),a$v.onPC=!a$v.onMobile,a$v.onSafari=-1<a$v.u.indexOf("Safari"),a$v.onFirefox=-1<a$v.u.indexOf("Firefox"),a$v.onEdge=-1<a$v.u.indexOf("Edge"),a$v.onMiniGame=-1<a$v.u.indexOf("MiniGame"),a$v.onLimixiu=-1<a$v.u.indexOf("limixiu"),a$v.httpProtocol="http:"==a$v.window.location.protocol,a$v.onMiniGame&&null==a$v.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),a$v.webAudioEnabled=!!(a$v.window.AudioContext||a$v.window.webkitAudioContext||a$v.window.mozAudioContext),a$v.soundType=a$v.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",a$Qt=a$v.webAudioEnabled?a$ut:a$vt,a$v.webAudioEnabled&&a$ut.initWebAudio(),a$vt._initMusicAudio(),a$v.enableTouch="ontouchstart"in a$S||a$S.DocumentTouch&&a$k instanceof DocumentTouch,a$S.focus(),a$U._soundClass=a$Qt,a$U._musicClass=a$vt,a$c._mainCanvas=a$c._mainCanvas||a$Yt.create("2D"),a$v.canvas||(a$v.canvas=a$Yt.create("2D"),a$v.context=a$v.canvas.getContext("2d"))}},a$v._onMessage=function(a$t){if(a$t.data&&"size"==a$t.data.name){if(a$v.window.innerWidth=a$t.data.width,a$v.window.innerHeight=a$t.data.height,a$v.window.__innerHeight=a$t.data.clientHeight,!a$v.document.createEvent)return void console.warn("no document.createEvent");var a$k=a$v.document.createEvent("HTMLEvents");return a$k.initEvent("resize",!1,!1),void a$v.window.dispatchEvent(a$k)}},a$v.createElement=function(a$t){return a$v.__init__(),a$v.document.__createElement(a$t)},a$v.getElementById=function(a$t){return a$v.__init__(),a$v.document.getElementById(a$t)},a$v.removeElement=function(a$t){a$t&&a$t.parentNode&&a$t.parentNode.removeChild(a$t)},a$v.now=function(){return a$N.now()},a$v._window=null,a$v._document=null,a$v._container=null,a$v.userAgent=null,a$v.u=null,a$v.onIOS=!1,a$v.onMac=!1,a$v.onMobile=!1,a$v.onIPhone=!1,a$v.onIPad=!1,a$v.onAndroid=!1,a$v.onWP=!1,a$v.onQQBrowser=!1,a$v.onMQQBrowser=!1,a$v.onSafari=!1,a$v.onFirefox=!1,a$v.onEdge=!1,a$v.onIE=!1,a$v.onWeiXin=!1,a$v.onMiniGame=!1,a$v.onLimixiu=!1,a$v.onPC=!1,a$v.httpProtocol=!1,a$v.webAudioEnabled=!1,a$v.soundType=null,a$v.enableTouch=!1,a$v.canvas=null,a$v.context=null,a$v.__init$=function(){},a$v}()),a$x=function(){function a$k(a$t){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,a$t?(this._u8d_=new Uint8Array(a$t),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}a$w(a$k,"laya.utils.Byte");var a$t=a$k.prototype;return a$t.___resizeBuffer=function(a$k){try{var a$t=new Uint8Array(a$k);null!=this._u8d_&&(this._u8d_.length<=a$k?a$t.set(this._u8d_):a$t.set(this._u8d_.subarray(0,a$k))),this._u8d_=a$t,this._d_=new DataView(a$t.buffer)}catch(a$t){throw"___resizeBuffer err:"+a$k}},a$t.getString=function(){return this.rUTF(this.getUint16())},a$t.getFloat32Array=function(a$t,a$k){var a$v=a$t+a$k;a$v=a$v>this._length?this._length:a$v;var a$j=new Float32Array(this._d_.buffer.slice(a$t,a$v));return this._pos_=a$v,a$j},a$t.getUint8Array=function(a$t,a$k){var a$v=a$t+a$k;a$v=a$v>this._length?this._length:a$v;var a$j=new Uint8Array(this._d_.buffer.slice(a$t,a$v));return this._pos_=a$v,a$j},a$t.getInt16Array=function(a$t,a$k){var a$v=a$t+a$k;a$v=a$v>this._length?this._length:a$v;var a$j=new Int16Array(this._d_.buffer.slice(a$t,a$v));return this._pos_=a$v,a$j},a$t.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var a$t=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,a$t},a$t.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var a$t=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,a$t},a$t.writeFloat32=function(a$t){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,a$t,this._xd_),this._pos_+=4},a$t.writeFloat64=function(a$t){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,a$t,this._xd_),this._pos_+=8},a$t.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var a$t=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,a$t},a$t.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var a$t=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,a$t},a$t.writeInt32=function(a$t){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,a$t,this._xd_),this._pos_+=4},a$t.writeUint32=function(a$t){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,a$t,this._xd_),this._pos_+=4},a$t.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var a$t=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,a$t},a$t.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var a$t=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,a$t},a$t.writeUint16=function(a$t){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,a$t,this._xd_),this._pos_+=2},a$t.writeInt16=function(a$t){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,a$t,this._xd_),this._pos_+=2},a$t.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},a$t.writeUint8=function(a$t){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,a$t),this._pos_++},a$t._getUInt8=function(a$t){return this._d_.getUint8(a$t)},a$t._getUint16=function(a$t){return this._d_.getUint16(a$t,this._xd_)},a$t._getMatrix=function(){return new a$a(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},a$t.rUTF=function(a$t){for(var a$k=[],a$v=this._pos_+a$t,a$j=0,a$Q=0,a$u=0,a$S=String.fromCharCode,a$V=this._u8d_;this._pos_<a$v;)(a$j=a$V[this._pos_++])<128?0!=a$j&&a$k.push(a$S(a$j)):a$j<224?a$k.push(a$S((63&a$j)<<6|127&a$V[this._pos_++])):a$j<240?(a$Q=a$V[this._pos_++],a$k.push(a$S((31&a$j)<<12|(127&a$Q)<<6|127&a$V[this._pos_++]))):(a$Q=a$V[this._pos_++],a$u=a$V[this._pos_++],a$k.push(a$S((15&a$j)<<18|(127&a$Q)<<12|a$u<<6&127|127&a$V[this._pos_++]))),0;return a$k.join("")},a$t.getCustomString=function(a$t){for(var a$k=[],a$v=0,a$j=0,a$Q=0,a$u=String.fromCharCode,a$S=this._u8d_;0<a$t;)if((a$j=a$S[this._pos_])<128)a$k.push(a$u(a$j)),this._pos_++,a$t--;else for(a$v=a$j-128,this._pos_++,a$t-=a$v;0<a$v;)a$j=a$S[this._pos_++],a$Q=a$S[this._pos_++],a$k.push(a$u(a$Q<<8|a$j)),a$v--;return a$k.join("")},a$t.clear=function(){this._pos_=0,this.length=0},a$t.__getBuffer=function(){return this._d_.buffer},a$t.writeUTFBytes=function(a$t){for(var a$k=0,a$v=(a$t+="").length;a$k<a$v;a$k++){var a$j=a$t.charCodeAt(a$k);a$j<=127?this.writeByte(a$j):a$j<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|a$j>>6,128|63&a$j],this._pos_),this._pos_+=2):a$j<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|a$j>>12,128|a$j>>6&63,128|63&a$j],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|a$j>>18,128|a$j>>12&63,128|a$j>>6&63,128|63&a$j],this._pos_),this._pos_+=4)}},a$t.writeUTFString=function(a$t){var a$k=this.pos;this.writeUint16(1),this.writeUTFBytes(a$t);var a$v=this.pos-a$k-2;if(65536<=a$v)throw"writeUTFString byte len more than 65536";this._d_.setUint16(a$k,a$v,this._xd_)},a$t.readUTFString=function(){return this.readUTFBytes(this.getUint16())},a$t.getUTFString=function(){return this.readUTFString()},a$t.readUTFBytes=function(a$t){if(void 0===a$t&&(a$t=-1),0==a$t)return"";var a$k=this.bytesAvailable;if(a$k<a$t)throw"readUTFBytes error - Out of bounds";return a$t=0<a$t?a$t:a$k,this.rUTF(a$t)},a$t.getUTFBytes=function(a$t){return void 0===a$t&&(a$t=-1),this.readUTFBytes(a$t)},a$t.writeByte=function(a$t){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,a$t),this._pos_+=1},a$t.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},a$t.getByte=function(){return this.readByte()},a$t.ensureWrite=function(a$t){this._length<a$t&&(this._length=a$t),this._allocated_<a$t&&(this.length=a$t)},a$t.writeArrayBuffer=function(a$t,a$k,a$v){if(void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),a$k<0||a$v<0)throw"writeArrayBuffer error - Out of bounds";0==a$v&&(a$v=a$t.byteLength-a$k),this.ensureWrite(this._pos_+a$v);var a$j=new Uint8Array(a$t);this._u8d_.set(a$j.subarray(a$k,a$k+a$v),this._pos_),this._pos_+=a$v},a$A(0,a$t,"buffer",function(){var a$t=this._d_.buffer;return a$t.byteLength==this.length?a$t:a$t.slice(0,this.length)}),a$A(0,a$t,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(a$t){this._xd_="littleEndian"==a$t}),a$A(0,a$t,"length",function(){return this._length},function(a$t){this._allocated_<a$t?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(a$t,2*this._allocated_))):this._allocated_>a$t&&this.___resizeBuffer(this._allocated_=a$t),this._length=a$t}),a$A(0,a$t,"pos",function(){return this._pos_},function(a$t){this._pos_=a$t}),a$A(0,a$t,"bytesAvailable",function(){return this._length-this._pos_}),a$k.getSystemEndian=function(){if(!a$k._sysEndian){var a$t=new ArrayBuffer(2);new DataView(a$t).setInt16(0,256,!0),a$k._sysEndian=256===new Int16Array(a$t)[0]?"littleEndian":"bigEndian"}return a$k._sysEndian},a$k.BIG_ENDIAN="bigEndian",a$k.LITTLE_ENDIAN="littleEndian",a$k._sysEndian=null,a$k}(),a$I=function(){function a$Q(){}return a$w(a$Q,"laya.utils.CacheManager"),a$Q.regCacheByFunction=function(a$t,a$k){var a$v;a$Q.unRegCacheByFunction(a$t,a$k),a$v={tryDispose:a$t,getCacheList:a$k},a$Q._cacheList.push(a$v)},a$Q.unRegCacheByFunction=function(a$t,a$k){var a$v,a$j=0;for(a$v=a$Q._cacheList.length,a$j=0;a$j<a$v;a$j++)if(a$Q._cacheList[a$j].tryDispose==a$t&&a$Q._cacheList[a$j].getCacheList==a$k)return void a$Q._cacheList.splice(a$j,1)},a$Q.forceDispose=function(){var a$t=0,a$k=a$Q._cacheList.length;for(a$t=0;a$t<a$k;a$t++)a$Q._cacheList[a$t].tryDispose(!0)},a$Q.beginCheck=function(a$t){void 0===a$t&&(a$t=15e3),a$d.timer.loop(a$t,null,a$Q._checkLoop)},a$Q.stopCheck=function(){a$d.timer.clear(null,a$Q._checkLoop)},a$Q._checkLoop=function(){var a$t=a$Q._cacheList;if(!(a$t.length<1)){var a$k,a$v=a$_.now(),a$j=0;for(a$k=a$j=a$t.length;0<a$j&&(a$t[a$Q._index=++a$Q._index%a$k].tryDispose(!1),!(a$_.now()-a$v>a$Q.loopTimeLimit));)a$j--}},a$Q.loopTimeLimit=2,a$Q._cacheList=[],a$Q._index=0,a$Q}(),a$i=function(){function a$E(){}return a$w(a$E,"laya.utils.ClassUtils"),a$E.regClass=function(a$t,a$k){a$E._classMap[a$t]=a$k},a$E.getRegClass=function(a$t){return a$E._classMap[a$t]},a$E.getInstance=function(a$t){var a$k=a$E.getClass(a$t);return a$k?new a$k:(console.warn("[error] Undefined class:",a$t),null)},a$E.createByJson=function(a$t,a$k,a$v,a$j,a$Q){"string"==typeof a$t&&(a$t=JSON.parse(a$t));var a$u=a$t.props;if(!a$k&&!(a$k=a$Q?a$Q.runWith(a$t):a$E.getInstance(a$u.runtime||a$t.type)))return null;var a$S=a$t.child;if(a$S)for(var a$V=0,a$J=a$S.length;a$V<a$J;a$V++){var a$W=a$S[a$V];if("render"!==a$W.props.name&&"render"!==a$W.props.renderType||!a$k._$set_itemRender)if("Graphic"==a$W.type)a$E.addGraphicsToSprite(a$W,a$k);else if(a$E.isDrawType(a$W.type))a$E.addGraphicToSprite(a$W,a$k,!0);else{var a$w=a$E.createByJson(a$W,null,a$v,a$j,a$Q);"Script"==a$W.type?a$w.hasOwnProperty("owner")?a$w.owner=a$k:a$w.hasOwnProperty("target")&&(a$w.target=a$k):"mask"==a$W.props.renderType?a$k.mask=a$w:a$k.addChild(a$w)}else a$k.itemRender=a$W}if(a$u)for(var a$M in a$u){var a$H=a$u[a$M];"var"===a$M&&a$v?a$v[a$H]=a$k:a$H instanceof Array&&"function"==typeof a$k[a$M]?a$k[a$M].apply(a$k,a$H):a$k[a$M]=a$H}return a$j&&a$t.customProps&&a$j.runWith([a$k,a$t]),a$k.created&&a$k.created(),a$k},a$E.addGraphicsToSprite=function(a$t,a$k){var a$v;if((a$v=a$t.child)&&!(a$v.length<1)){var a$j;a$j=a$E._getGraphicsFromSprite(a$t,a$k);var a$Q=0,a$u=0;a$t.props&&(a$Q=a$E._getObjVar(a$t.props,"x",0),a$u=a$E._getObjVar(a$t.props,"y",0)),0!=a$Q&&0!=a$u&&a$j.translate(a$Q,a$u);var a$S,a$V=0;for(a$S=a$v.length,a$V=0;a$V<a$S;a$V++)a$E._addGraphicToGraphics(a$v[a$V],a$j);0!=a$Q&&0!=a$u&&a$j.translate(-a$Q,-a$u)}},a$E.addGraphicToSprite=function(a$t,a$k,a$v){var a$j;void 0===a$v&&(a$v=!1),a$j=a$v?a$E._getGraphicsFromSprite(a$t,a$k):a$k.graphics,a$E._addGraphicToGraphics(a$t,a$j)},a$E._getGraphicsFromSprite=function(a$t,a$k){var a$v,a$j;if(!a$t||!a$t.props)return a$k.graphics;switch(a$j=a$t.props.renderType){case"hit":case"unHit":var a$Q;a$k.hitArea||(a$k.hitArea=new a$q),(a$Q=a$k.hitArea)[a$j]||(a$Q[a$j]=new a$H),a$v=a$Q[a$j]}return a$v||(a$v=a$k.graphics),a$v},a$E._getTransformData=function(a$t){var a$k;(a$t.hasOwnProperty("pivotX")||a$t.hasOwnProperty("pivotY"))&&(a$k=a$k||new a$a).translate(-a$E._getObjVar(a$t,"pivotX",0),-a$E._getObjVar(a$t,"pivotY",0));var a$v=a$E._getObjVar(a$t,"scaleX",1),a$j=a$E._getObjVar(a$t,"scaleY",1),a$Q=a$E._getObjVar(a$t,"rotation",0);a$E._getObjVar(a$t,"skewX",0),a$E._getObjVar(a$t,"skewY",0);return 1==a$v&&1==a$j&&0==a$Q||((a$k=a$k||new a$a).scale(a$v,a$j),a$k.rotate(.0174532922222222*a$Q)),a$k},a$E._addGraphicToGraphics=function(a$t,a$k){var a$v,a$j;if((a$v=a$t.props)&&(a$j=a$E.DrawTypeDic[a$t.type])){var a$Q,a$u;a$Q=a$k;var a$S=a$E._getParams(a$v,a$j[1],a$j[2],a$j[3]);((a$u=a$E._tM)||1!=a$E._alpha)&&(a$Q.save(),a$u&&a$Q.transform(a$u),1!=a$E._alpha&&a$Q.alpha(a$E._alpha)),a$Q[a$j[0]].apply(a$Q,a$S),(a$u||1!=a$E._alpha)&&a$Q.restore()}},a$E._adptLineData=function(a$t){return a$t[2]=parseFloat(a$t[0])+parseFloat(a$t[2]),a$t[3]=parseFloat(a$t[1])+parseFloat(a$t[3]),a$t},a$E._adptTextureData=function(a$t){return a$t[0]=a$Vt.getRes(a$t[0]),a$t},a$E._adptLinesData=function(a$t){return a$t[2]=a$E._getPointListByStr(a$t[2]),a$t},a$E.isDrawType=function(a$t){return"Image"!=a$t&&a$E.DrawTypeDic.hasOwnProperty(a$t)},a$E._getParams=function(a$t,a$k,a$v,a$j){var a$Q;void 0===a$v&&(a$v=0),(a$Q=a$E._temParam).length=a$k.length;var a$u,a$S,a$V=0;for(a$u=a$k.length,a$V=0;a$V<a$u;a$V++)a$Q[a$V]=a$E._getObjVar(a$t,a$k[a$V][0],a$k[a$V][1]);return a$E._alpha=a$E._getObjVar(a$t,"alpha",1),a$S=a$E._getTransformData(a$t),a$E._tM=a$S?(a$v||(a$v=0),a$S.translate(a$Q[a$v],a$Q[a$v+1]),a$Q[a$v]=a$Q[a$v+1]=0,a$S):null,a$j&&a$E[a$j]&&(a$Q=a$E[a$j](a$Q)),a$Q},a$E._getPointListByStr=function(a$t){var a$k,a$v,a$j=0;for(a$v=(a$k=a$t.split(",")).length,a$j=0;a$j<a$v;a$j++)a$k[a$j]=parseFloat(a$k[a$j]);return a$k},a$E._getObjVar=function(a$t,a$k,a$v){return a$t.hasOwnProperty(a$k)?a$t[a$k]:a$v},a$E._temParam=[],a$E._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},a$E.getClass=function(a$t){var a$k=a$E._classMap[a$t]||a$t;return"string"==typeof a$k?a$d.__classmap[a$k]:a$k},a$E._tM=null,a$E._alpha=NaN,a$J(a$E,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),a$E}(),a$D=function(){function a$u(a$t){if(this._color=[],"string"==typeof a$t){null===(this.strColor=a$t)&&(a$t="#000000"),"#"==a$t.charAt(0)&&(a$t=a$t.substr(1));var a$k=a$t.length;if(3==a$k||4==a$k){for(var a$v="",a$j=0;a$j<a$k;a$j++)a$v+=a$t[a$j]+a$t[a$j];a$t=a$v}var a$Q=this.numColor=parseInt(a$t,16);if(8==a$t.length)return void(this._color=[parseInt(a$t.substr(0,2),16)/255,((16711680&a$Q)>>16)/255,((65280&a$Q)>>8)/255,(255&a$Q)/255])}else a$Q=this.numColor=a$t,this.strColor=a$g.toHexColor(a$Q);this._color=[((16711680&a$Q)>>16)/255,((65280&a$Q)>>8)/255,(255&a$Q)/255,1],this._color.__id=++a$u._COLODID}return a$w(a$u,"laya.utils.Color"),a$u._initDefault=function(){for(var a$t in a$u._DEFAULT={},a$u._COLOR_MAP)a$u._SAVE[a$t]=a$u._DEFAULT[a$t]=new a$u(a$u._COLOR_MAP[a$t]);return a$u._DEFAULT},a$u._initSaveMap=function(){for(var a$t in a$u._SAVE_SIZE=0,a$u._SAVE={},a$u._DEFAULT)a$u._SAVE[a$t]=a$u._DEFAULT[a$t]},a$u.create=function(a$t){var a$k=a$u._SAVE[a$t+""];return null!=a$k?a$k:(a$u._SAVE_SIZE<1e3||a$u._initSaveMap(),a$u._SAVE[a$t+""]=new a$u(a$t))},a$u._SAVE={},a$u._SAVE_SIZE=0,a$u._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},a$u._DEFAULT=a$u._initDefault(),a$u._COLODID=1,a$u}(),a$B=(function(){function a$t(){this._values=[],this._keys=[]}a$w(a$t,"laya.utils.Dictionary");var a$k=a$t.prototype;a$k.set=function(a$t,a$k){var a$v=this.indexOf(a$t);0<=a$v?this._values[a$v]=a$k:(this._keys.push(a$t),this._values.push(a$k))},a$k.indexOf=function(a$t){var a$k=this._keys.indexOf(a$t);return 0<=a$k?a$k:(a$t="string"==typeof a$t?Number(a$t):"number"==typeof a$t?a$t.toString():a$t,this._keys.indexOf(a$t))},a$k.get=function(a$t){var a$k=this.indexOf(a$t);return a$k<0?null:this._values[a$k]},a$k.remove=function(a$t){var a$k=this.indexOf(a$t);return 0<=a$k&&(this._keys.splice(a$k,1),this._values.splice(a$k,1),!0)},a$k.clear=function(){this._values.length=0,this._keys.length=0},a$A(0,a$k,"values",function(){return this._values}),a$A(0,a$k,"keys",function(){return this._keys})}(),function(){function a$t(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}a$w(a$t,"laya.utils.Dragging");var a$k=a$t.prototype;return a$k.start=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){void 0===a$V&&(a$V=.92),this.clearTimer(),this.target=a$t,this.area=a$k,this.hasInertia=a$v,this.elasticDistance=a$k?a$j:0,this.elasticBackTime=a$Q,this.data=a$u,this._disableMouseEvent=a$S,this.ratio=a$V,1!=a$t.globalScaleX||1!=a$t.globalScaleY?this._parent=a$t.parent:this._parent=a$d.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,a$d.stage.on("mouseup",this,this.onStageMouseUp),a$d.stage.on("mouseout",this,this.onStageMouseUp),a$d.timer.frameLoop(1,this,this.loop)},a$k.clearTimer=function(){a$d.timer.clear(this,this.loop),a$d.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},a$k.stop=function(){this._dragging&&(a$R.instance.disableMouseEvent=!1,a$d.stage.off("mouseup",this,this.onStageMouseUp),a$d.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},a$k.loop=function(){var a$t=this._parent.getMousePoint(),a$k=a$t.x,a$v=a$t.y,a$j=a$k-this._lastX,a$Q=a$v-this._lastY;if(this._clickOnly){if(!(1<Math.abs(a$j*a$d.stage._canvasTransform.getScaleX())||1<Math.abs(a$Q*a$d.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),a$R.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(a$j,a$Q);0==a$j&&0==a$Q||(this._lastX=a$k,this._lastY=a$v,this.target.x+=a$j*this._elasticRateX,this.target.y+=a$Q*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},a$k.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var a$t=this.area.x-this.target.x;else a$t=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-a$t/this.elasticDistance),this.target.y<this.area.y)var a$k=this.area.y-this.target.y;else a$k=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-a$k/this.elasticDistance)}},a$k.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},a$k.onStageMouseUp=function(a$t){if(a$R.instance.disableMouseEvent=!1,a$d.stage.off("mouseup",this,this.onStageMouseUp),a$d.stage.off("mouseout",this,this.onStageMouseUp),a$d.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var a$k=this._offsets.length,a$v=Math.min(a$k,6),a$j=this._offsets.length-a$v,a$Q=a$k-1;a$j<a$Q;a$Q--)this._offsetY+=this._offsets[a$Q--],this._offsetX+=this._offsets[a$Q];this._offsetX=this._offsetX/a$v*2,this._offsetY=this._offsetY/a$v*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),a$d.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},a$k.checkElastic=function(){var a$t=NaN,a$k=NaN;if(this.target.x<this.area.x?a$t=this.area.x:this.target.x>this.area.x+this.area.width&&(a$t=this.area.x+this.area.width),this.target.y<this.area.y?a$k=this.area.y:this.target.y>this.area.y+this.area.height&&(a$k=this.area.y+this.area.height),isNaN(a$t)&&isNaN(a$k))this.clear();else{var a$v={};isNaN(a$t)||(a$v.x=a$t),isNaN(a$k)||(a$v.y=a$k),this._tween=a$r.to(this.target,a$v,this.elasticBackTime,a$b.sineOut,a$o.create(this,this.clear),0,!1,!1)}},a$k.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(a$d.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},a$k.clear=function(){if(this.target){this.clearTimer();var a$t=this.target;this.target=null,this._parent=null,a$t.event("dragend",this.data)}},a$t}()),a$b=function(){function a$V(){}return a$w(a$V,"laya.utils.Ease"),a$V.linearNone=function(a$t,a$k,a$v,a$j){return a$v*a$t/a$j+a$k},a$V.linearIn=function(a$t,a$k,a$v,a$j){return a$v*a$t/a$j+a$k},a$V.linearInOut=function(a$t,a$k,a$v,a$j){return a$v*a$t/a$j+a$k},a$V.linearOut=function(a$t,a$k,a$v,a$j){return a$v*a$t/a$j+a$k},a$V.bounceIn=function(a$t,a$k,a$v,a$j){return a$v-a$V.bounceOut(a$j-a$t,0,a$v,a$j)+a$k},a$V.bounceInOut=function(a$t,a$k,a$v,a$j){return a$t<.5*a$j?.5*a$V.bounceIn(2*a$t,0,a$v,a$j)+a$k:.5*a$V.bounceOut(2*a$t-a$j,0,a$v,a$j)+.5*a$v+a$k},a$V.bounceOut=function(a$t,a$k,a$v,a$j){return(a$t/=a$j)<1/2.75?a$v*(7.5625*a$t*a$t)+a$k:a$t<2/2.75?a$v*(7.5625*(a$t-=1.5/2.75)*a$t+.75)+a$k:a$t<2.5/2.75?a$v*(7.5625*(a$t-=2.25/2.75)*a$t+.9375)+a$k:a$v*(7.5625*(a$t-=2.625/2.75)*a$t+.984375)+a$k},a$V.backIn=function(a$t,a$k,a$v,a$j,a$Q){return void 0===a$Q&&(a$Q=1.70158),a$v*(a$t/=a$j)*a$t*((a$Q+1)*a$t-a$Q)+a$k},a$V.backInOut=function(a$t,a$k,a$v,a$j,a$Q){return void 0===a$Q&&(a$Q=1.70158),(a$t/=.5*a$j)<1?.5*a$v*(a$t*a$t*((1+(a$Q*=1.525))*a$t-a$Q))+a$k:a$v/2*((a$t-=2)*a$t*((1+(a$Q*=1.525))*a$t+a$Q)+2)+a$k},a$V.backOut=function(a$t,a$k,a$v,a$j,a$Q){return void 0===a$Q&&(a$Q=1.70158),a$v*((a$t=a$t/a$j-1)*a$t*((a$Q+1)*a$t+a$Q)+1)+a$k},a$V.elasticIn=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S;return void 0===a$Q&&(a$Q=0),void 0===a$u&&(a$u=0),0==a$t?a$k:1==(a$t/=a$j)?a$k+a$v:(a$u||(a$u=.3*a$j),a$S=!a$Q||0<a$v&&a$Q<a$v||a$v<0&&a$Q<-a$v?(a$Q=a$v,a$u/4):a$u/a$V.PI2*Math.asin(a$v/a$Q),-a$Q*Math.pow(2,10*(a$t-=1))*Math.sin((a$t*a$j-a$S)*a$V.PI2/a$u)+a$k)},a$V.elasticInOut=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S;return void 0===a$Q&&(a$Q=0),void 0===a$u&&(a$u=0),0==a$t?a$k:2==(a$t/=.5*a$j)?a$k+a$v:(a$u||(a$u=a$j*(.3*1.5)),a$S=!a$Q||0<a$v&&a$Q<a$v||a$v<0&&a$Q<-a$v?(a$Q=a$v,a$u/4):a$u/a$V.PI2*Math.asin(a$v/a$Q),a$t<1?a$Q*Math.pow(2,10*(a$t-=1))*Math.sin((a$t*a$j-a$S)*a$V.PI2/a$u)*-.5+a$k:a$Q*Math.pow(2,-10*(a$t-=1))*Math.sin((a$t*a$j-a$S)*a$V.PI2/a$u)*.5+a$v+a$k)},a$V.elasticOut=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S;return void 0===a$Q&&(a$Q=0),void 0===a$u&&(a$u=0),0==a$t?a$k:1==(a$t/=a$j)?a$k+a$v:(a$u||(a$u=.3*a$j),a$S=!a$Q||0<a$v&&a$Q<a$v||a$v<0&&a$Q<-a$v?(a$Q=a$v,a$u/4):a$u/a$V.PI2*Math.asin(a$v/a$Q),a$Q*Math.pow(2,-10*a$t)*Math.sin((a$t*a$j-a$S)*a$V.PI2/a$u)+a$v+a$k)},a$V.strongIn=function(a$t,a$k,a$v,a$j){return a$v*(a$t/=a$j)*a$t*a$t*a$t*a$t+a$k},a$V.strongInOut=function(a$t,a$k,a$v,a$j){return(a$t/=.5*a$j)<1?.5*a$v*a$t*a$t*a$t*a$t*a$t+a$k:.5*a$v*((a$t-=2)*a$t*a$t*a$t*a$t+2)+a$k},a$V.strongOut=function(a$t,a$k,a$v,a$j){return a$v*((a$t=a$t/a$j-1)*a$t*a$t*a$t*a$t+1)+a$k},a$V.sineInOut=function(a$t,a$k,a$v,a$j){return.5*-a$v*(Math.cos(Math.PI*a$t/a$j)-1)+a$k},a$V.sineIn=function(a$t,a$k,a$v,a$j){return-a$v*Math.cos(a$t/a$j*a$V.HALF_PI)+a$v+a$k},a$V.sineOut=function(a$t,a$k,a$v,a$j){return a$v*Math.sin(a$t/a$j*a$V.HALF_PI)+a$k},a$V.quintIn=function(a$t,a$k,a$v,a$j){return a$v*(a$t/=a$j)*a$t*a$t*a$t*a$t+a$k},a$V.quintInOut=function(a$t,a$k,a$v,a$j){return(a$t/=.5*a$j)<1?.5*a$v*a$t*a$t*a$t*a$t*a$t+a$k:.5*a$v*((a$t-=2)*a$t*a$t*a$t*a$t+2)+a$k},a$V.quintOut=function(a$t,a$k,a$v,a$j){return a$v*((a$t=a$t/a$j-1)*a$t*a$t*a$t*a$t+1)+a$k},a$V.quartIn=function(a$t,a$k,a$v,a$j){return a$v*(a$t/=a$j)*a$t*a$t*a$t+a$k},a$V.quartInOut=function(a$t,a$k,a$v,a$j){return(a$t/=.5*a$j)<1?.5*a$v*a$t*a$t*a$t*a$t+a$k:.5*-a$v*((a$t-=2)*a$t*a$t*a$t-2)+a$k},a$V.quartOut=function(a$t,a$k,a$v,a$j){return-a$v*((a$t=a$t/a$j-1)*a$t*a$t*a$t-1)+a$k},a$V.cubicIn=function(a$t,a$k,a$v,a$j){return a$v*(a$t/=a$j)*a$t*a$t+a$k},a$V.cubicInOut=function(a$t,a$k,a$v,a$j){return(a$t/=.5*a$j)<1?.5*a$v*a$t*a$t*a$t+a$k:.5*a$v*((a$t-=2)*a$t*a$t+2)+a$k},a$V.cubicOut=function(a$t,a$k,a$v,a$j){return a$v*((a$t=a$t/a$j-1)*a$t*a$t+1)+a$k},a$V.quadIn=function(a$t,a$k,a$v,a$j){return a$v*(a$t/=a$j)*a$t+a$k},a$V.quadInOut=function(a$t,a$k,a$v,a$j){return(a$t/=.5*a$j)<1?.5*a$v*a$t*a$t+a$k:.5*-a$v*(--a$t*(a$t-2)-1)+a$k},a$V.quadOut=function(a$t,a$k,a$v,a$j){return-a$v*(a$t/=a$j)*(a$t-2)+a$k},a$V.expoIn=function(a$t,a$k,a$v,a$j){return 0==a$t?a$k:a$v*Math.pow(2,10*(a$t/a$j-1))+a$k-.001*a$v},a$V.expoInOut=function(a$t,a$k,a$v,a$j){return 0==a$t?a$k:a$t==a$j?a$k+a$v:(a$t/=.5*a$j)<1?.5*a$v*Math.pow(2,10*(a$t-1))+a$k:.5*a$v*(2-Math.pow(2,-10*--a$t))+a$k},a$V.expoOut=function(a$t,a$k,a$v,a$j){return a$t==a$j?a$k+a$v:a$v*(1-Math.pow(2,-10*a$t/a$j))+a$k},a$V.circIn=function(a$t,a$k,a$v,a$j){return-a$v*(Math.sqrt(1-(a$t/=a$j)*a$t)-1)+a$k},a$V.circInOut=function(a$t,a$k,a$v,a$j){return(a$t/=.5*a$j)<1?.5*-a$v*(Math.sqrt(1-a$t*a$t)-1)+a$k:.5*a$v*(Math.sqrt(1-(a$t-=2)*a$t)+1)+a$k},a$V.circOut=function(a$t,a$k,a$v,a$j){return a$v*Math.sqrt(1-(a$t=a$t/a$j-1)*a$t)+a$k},a$V.HALF_PI=.5*Math.PI,a$V.PI2=2*Math.PI,a$V}(),a$q=function(){function a$M(){this._hit=null,this._unHit=null}a$w(a$M,"laya.utils.HitArea");var a$t=a$M.prototype;return a$t.isHit=function(a$t,a$k){return!!a$M.isHitGraphic(a$t,a$k,this.hit)&&!a$M.isHitGraphic(a$t,a$k,this.unHit)},a$t.contains=function(a$t,a$k){return this.isHit(a$t,a$k)},a$A(0,a$t,"hit",function(){return this._hit||(this._hit=new a$H),this._hit},function(a$t){this._hit=a$t}),a$A(0,a$t,"unHit",function(){return this._unHit||(this._unHit=new a$H),this._unHit},function(a$t){this._unHit=a$t}),a$M.isHitGraphic=function(a$t,a$k,a$v){if(!a$v)return!1;var a$j;if(!(a$j=a$v.cmds)&&a$v._one&&((a$j=a$M._cmds).length=1,a$j[0]=a$v._one),!a$j)return!1;var a$Q,a$u,a$S=0;for(a$Q=a$j.length,a$S=0;a$S<a$Q;a$S++)if(a$u=a$j[a$S]){var a$V=a$c._context;switch(a$u.callee){case a$V._translate:case 6:a$t-=a$u[0],a$k-=a$u[1]}if(a$M.isHitCmd(a$t,a$k,a$u))return!0}return!1},a$M.isHitCmd=function(a$t,a$k,a$v){if(!a$v)return!1;var a$j=a$c._context,a$Q=!1;switch(a$v.callee){case a$j._drawRect:case 13:a$M._rec.setTo(a$v[0],a$v[1],a$v[2],a$v[3]),a$Q=a$M._rec.contains(a$t,a$k);break;case a$j._drawCircle:case a$j._fillCircle:case 14:a$Q=(a$t-=a$v[0])*a$t+(a$k-=a$v[1])*a$k<a$v[2]*a$v[2];break;case a$j._drawPoly:case 18:a$t-=a$v[0],a$k-=a$v[1],a$Q=a$M.ptInPolygon(a$t,a$k,a$v[2])}return a$Q},a$M.ptInPolygon=function(a$t,a$k,a$v){var a$j;(a$j=a$M._ptPoint).setTo(a$t,a$k);var a$Q,a$u=0,a$S=NaN,a$V=NaN,a$J=NaN,a$W=NaN;a$Q=a$v.length;for(var a$w=0;a$w<a$Q;a$w+=2){if(a$S=a$v[a$w],a$V=a$v[a$w+1],a$J=a$v[(a$w+2)%a$Q],a$V!=(a$W=a$v[(a$w+3)%a$Q]))if(!(a$j.y<Math.min(a$V,a$W)))if(!(a$j.y>=Math.max(a$V,a$W)))(a$j.y-a$V)*(a$J-a$S)/(a$W-a$V)+a$S>a$j.x&&a$u++}return a$u%2==1},a$M._cmds=[],a$J(a$M,["_rec",function(){return this._rec=new a$Z},"_ptPoint",function(){return this._ptPoint=new a$m}]),a$M}(),a$C=(function(){function a$Q(a$t,a$k,a$v,a$j){this.char=a$t,this.charNum=a$t.charCodeAt(0),this._x=this._y=0,this.width=a$k,this.height=a$v,this.style=a$j,this.isWord=!a$Q._isWordRegExp.test(a$t)}a$w(a$Q,"laya.utils.HTMLChar");var a$t=a$Q.prototype;a$d.imps(a$t,{"laya.display.ILayout":!0}),a$t.setSprite=function(a$t){this._sprite=a$t},a$t.getSprite=function(){return this._sprite},a$t._isChar=function(){return!0},a$t._getCSSStyle=function(){return this.style},a$A(0,a$t,"width",function(){return this._w},function(a$t){this._w=a$t}),a$A(0,a$t,"x",function(){return this._x},function(a$t){this._sprite&&(this._sprite.x=a$t),this._x=a$t}),a$A(0,a$t,"y",function(){return this._y},function(a$t){this._sprite&&(this._sprite.y=a$t),this._y=a$t}),a$A(0,a$t,"height",function(){return this._h},function(a$t){this._h=a$t}),a$Q._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function a$k(){}a$w(a$k,"laya.utils.Log"),a$k.enable=function(){a$k._logdiv||(a$k._logdiv=a$_.window.document.createElement("div"),a$_.window.document.body.appendChild(a$k._logdiv),a$k._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},a$k.toggle=function(){var a$t=a$k._logdiv.style;"1px"==a$t.width?a$t.width=a$t.height="50%":a$t.width=a$t.height="1px"},a$k.print=function(a$t){a$k._logdiv&&(a$k.maxCount<=a$k._count&&a$k.clear(),a$k._count++,a$k._logdiv.innerText+=a$t+"\n",a$k._logdiv.scrollTop=a$k._logdiv.scrollHeight)},a$k.clear=function(){a$k._logdiv.innerText="",a$k._count=0},a$k._logdiv=null,a$k._count=0,a$k.maxCount=20}(),function(){function a$k(){}a$w(a$k,"laya.utils.Mouse"),a$A(1,a$k,"cursor",function(){return a$k._style.cursor},function(a$t){a$k._style.cursor=a$t}),a$k.hide=function(){"none"!=a$k.cursor&&(a$k._preCursor=a$k.cursor,a$k.cursor="none")},a$k.show=function(){"none"==a$k.cursor&&(a$k.cursor=a$k._preCursor?a$k._preCursor:"auto")},a$k._preCursor=null,a$J(a$k,["_style",function(){return this._style=a$_.document.body.style}])}(),function(){function a$u(){}return a$w(a$u,"laya.utils.Pool"),a$u.getPoolBySign=function(a$t){return a$u._poolDic[a$t]||(a$u._poolDic[a$t]=[])},a$u.clearBySign=function(a$t){a$u._poolDic[a$t]&&(a$u._poolDic[a$t].length=0)},a$u.recover=function(a$t,a$k){a$k.__InPool||(a$k.__InPool=!0,a$u.getPoolBySign(a$t).push(a$k))},a$u.getItemByClass=function(a$t,a$k){var a$v=a$u.getPoolBySign(a$t),a$j=a$v.length?a$v.pop():new a$k;return a$j.__InPool=!1,a$j},a$u.getItemByCreateFun=function(a$t,a$k,a$v){var a$j=a$u.getPoolBySign(a$t),a$Q=a$j.length?a$j.pop():a$k.call(a$v);return a$Q.__InPool=!1,a$Q},a$u.getItem=function(a$t){var a$k=a$u.getPoolBySign(a$t),a$v=a$k.length?a$k.pop():null;return a$v&&(a$v.__InPool=!1),a$v},a$u._poolDic={},a$u.InPoolSign="__InPool",a$u}()),a$L=function(){function a$J(){}return a$w(a$J,"laya.utils.Stat"),a$A(1,a$J,"onclick",null,function(a$t){a$J._sp&&a$J._sp.on("click",a$J._sp,a$t),a$J._canvas&&(a$J._canvas.source.onclick=a$t,a$J._canvas.source.style.pointerEvents="")}),a$J.show=function(a$t,a$k,a$v){if(void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),!a$c.isConchApp||a$c.isConchWebGL){if(a$c.isConchWebGL||a$_.onMiniGame||a$_.onLimixiu||(a$J._useCanvas=!0),a$J._show=!0,a$J._fpsData.length=60,a$J._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},a$J._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},a$J._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},a$J._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},a$c.isWebGL)if(a$J._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},a$c.is3DMode){if(a$J._view[0].title="FPS(3D)",a$J._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},a$J._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},a$J._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==a$v){var a$j=8;a$J._view[a$j++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},a$J._view[a$j++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},a$J._view[a$j++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},a$J._view[a$j++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},a$J._view[a$j++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},a$J._view[a$j++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},a$J._view[a$j++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},a$J._view[a$j++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},a$J._view[a$j++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==a$v){a$j=8;a$J._view[a$j++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},a$J._view[a$j++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},a$J._view[a$j++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},a$J._view[a$j++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},a$J._view[a$j++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},a$J._view[a$j++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},a$J._view[a$j++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else a$J._view[0].title="FPS(WebGL)",a$J._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else a$J._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};a$J._useCanvas?a$J.createUIPre(a$t,a$k):a$J.createUI(a$t,a$k),a$J.enable()}else a$_.window.conch.showFPS&&a$_.window.conch.showFPS(a$t,a$k)},a$J.createUIPre=function(a$t,a$k){var a$v=a$_.pixelRatio;a$J._width=170*a$v,a$J._vx=75*a$v,a$J._height=a$v*(12*a$J._view.length+3*a$v)+4,a$J._fontSize=12*a$v;for(var a$j=0;a$j<a$J._view.length;a$j++)a$J._view[a$j].x=4,a$J._view[a$j].y=a$j*a$J._fontSize+2*a$v;a$J._canvas||((a$J._canvas=new a$Yt("2D")).size(a$J._width,a$J._height),(a$J._ctx=a$J._canvas.getContext("2d")).textBaseline="top",a$J._ctx.font=a$J._fontSize+"px Sans-serif",a$J._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+a$t+"px;top:"+a$k+"px;width:"+a$J._width/a$v+"px;height:"+a$J._height/a$v+"px;"),a$J._first=!0,a$J.loop(),a$J._first=!1,a$_.container.appendChild(a$J._canvas.source)},a$J.createUI=function(a$t,a$k){var a$v=a$J._sp,a$j=a$_.pixelRatio;a$v||(a$v=new a$Mt,(a$J._leftText=new a$ht).pos(5,5),a$J._leftText.color="#ffffff",a$v.addChild(a$J._leftText),(a$J._txt=new a$ht).pos(80*a$j,5),a$J._txt.color="#ffffff",a$v.addChild(a$J._txt),a$J._sp=a$v),a$v.pos(a$t,a$k);for(var a$Q="",a$u=0;a$u<a$J._view.length;a$u++){a$Q+=a$J._view[a$u].title+"\n"}a$J._leftText.text=a$Q;var a$S=170*a$j,a$V=a$j*(12*a$J._view.length+3*a$j)+4;a$J._txt.fontSize=a$J._fontSize*a$j,a$J._leftText.fontSize=a$J._fontSize*a$j,a$v.size(a$S,a$V),a$v.graphics.clear(),a$v.graphics.setAlpha(.5),a$v.graphics.drawRect(0,0,a$S,a$V,"#999999"),a$v.graphics.setAlpha(1),a$J.loop()},a$J.enable=function(){a$d.timer.frameLoop(1,a$J,a$J.loop)},a$J.hide=function(){a$J._show=!1,a$d.timer.clear(a$J,a$J.loop),a$J._canvas&&a$_.removeElement(a$J._canvas.source)},a$J.clear=function(){a$J.trianglesFaces=a$J.drawCall=a$J.shaderCall=a$J.spriteCount=a$J.spriteRenderUseCacheCount=a$J.treeNodeCollision=a$J.treeSpriteCollision=a$J.canvasNormal=a$J.canvasBitmap=a$J.canvasReCache=0},a$J.loop=function(){a$J._count++;var a$t=a$_.now();if(!(a$t-a$J._timer<1e3)){var a$k=a$J._count;if(a$J.FPS=Math.round(1e3*a$k/(a$t-a$J._timer)),a$J._show){a$J.trianglesFaces=Math.round(a$J.trianglesFaces/a$k),a$J.spriteCount=a$J._useCanvas?(a$J.drawCall=Math.round(a$J.drawCall/a$k)-2,a$J.shaderCall=Math.round(a$J.shaderCall/a$k),Math.round(a$J.spriteCount/a$k)-1):(a$J.drawCall=Math.round(a$J.drawCall/a$k)-2,a$J.shaderCall=Math.round(a$J.shaderCall/a$k)-4,Math.round(a$J.spriteCount/a$k)-4),a$J.spriteRenderUseCacheCount=Math.round(a$J.spriteRenderUseCacheCount/a$k),a$J.canvasNormal=Math.round(a$J.canvasNormal/a$k),a$J.canvasBitmap=Math.round(a$J.canvasBitmap/a$k),a$J.canvasReCache=Math.ceil(a$J.canvasReCache/a$k),a$J.treeNodeCollision=Math.round(a$J.treeNodeCollision/a$k),a$J.treeSpriteCollision=Math.round(a$J.treeSpriteCollision/a$k);var a$v=0<a$J.FPS?Math.floor(1e3/a$J.FPS).toString():" ";a$J._fpsStr=a$J.FPS+(a$J.renderSlow?" slow":"")+" "+a$v,a$J._spriteStr=a$J.spriteCount+(a$J.spriteRenderUseCacheCount?"/"+a$J.spriteRenderUseCacheCount:""),a$J._canvasStr=a$J.canvasReCache+"/"+a$J.canvasNormal+"/"+a$J.canvasBitmap,a$J.currentMemorySize=a$n.systemResourceManager.memorySize,a$J._useCanvas?a$J.renderInfoPre():a$J.renderInfo(),a$J.clear()}a$J._count=0,a$J._timer=a$t}},a$J.renderInfoPre=function(){if(a$J._canvas){var a$t=a$J._ctx;a$t.clearRect(a$J._first?0:a$J._vx,0,a$J._width,a$J._height);for(var a$k=a$c.WebGL.mainContext,a$v=0;a$v<a$J._view.length;a$v++){var a$j=a$J._view[a$v];a$J._first&&(a$t.fillStyle="white",a$t.fillText(a$j.title,a$j.x,a$j.y,null,null,null)),a$t.fillStyle=a$j.color;var a$Q=-1;if((a$j=a$J._view[a$v]).varying){if(a$k)switch(a$j.varying){case 1:a$Q=a$k.getParameter(a$k[a$j.value]);break;case 2:a$Q=a$k.getExtension(a$j.value)}}else a$Q=a$J[a$j.value];"M"==a$j.units&&(a$Q=Math.floor(a$Q/1048576*100)/100+" M"),"K"==a$j.units&&(a$Q=Math.floor(a$Q/1024*100)/100+" K"),"string"==a$j.units&&(a$Q=a$Q.match(/\d+\.?\d/i)),a$t.fillText(a$Q+"",a$j.x+a$J._vx,a$j.y,null,null,null)}}},a$J.renderInfo=function(){for(var a$t="",a$k=a$c.WebGL.mainContext,a$v=0;a$v<a$J._view.length;a$v++){var a$j=a$J._view[a$v],a$Q=-1;if(a$j.varying){if(a$k)switch(a$j.varying){case 1:a$Q=a$k.getParameter(a$k[a$j.value]);break;case 2:a$Q=a$k.getExtension(a$j.value)}}else a$Q=a$J[a$j.value];"M"==a$j.units&&(a$Q=Math.floor(a$Q/1048576*100)/100+" M"),"K"==a$j.units&&(a$Q=Math.floor(a$Q/1024*100)/100+" K"),"string"==a$j.units&&(a$Q=a$Q.match(/\d+\.?\d/i)),a$t+=a$Q+"\n"}a$J._txt.text=a$t},a$J.FPS=0,a$J.loopCount=0,a$J.shaderCall=0,a$J.drawCall=0,a$J.trianglesFaces=0,a$J.spriteCount=0,a$J.spriteRenderUseCacheCount=0,a$J.treeNodeCollision=0,a$J.treeSpriteCollision=0,a$J.canvasNormal=0,a$J.canvasBitmap=0,a$J.canvasReCache=0,a$J.renderSlow=!1,a$J.currentMemorySize=0,a$J._fpsStr=null,a$J._canvasStr=null,a$J._spriteStr=null,a$J._fpsData=[],a$J._timer=0,a$J._count=0,a$J._view=[],a$J._fontSize=12,a$J._txt=null,a$J._leftText=null,a$J._sp=null,a$J._show=!1,a$J._useCanvas=!1,a$J._canvas=null,a$J._ctx=null,a$J._first=!1,a$J._vx=NaN,a$J._width=0,a$J._height=100,a$J}(),a$e=(function(){function a$t(){this._strsToID={},this._idToStrs=[],this._length=0}a$w(a$t,"laya.utils.StringKey");var a$k=a$t.prototype;a$k.add=function(a$t){var a$k=this._strsToID[a$t];return null!=a$k?a$k:(this._idToStrs[this._length]=a$t,this._strsToID[a$t]=this._length++)},a$k.getID=function(a$t){var a$k=this._strsToID[a$t];return null==a$k?-1:a$k},a$k.getName=function(a$t){var a$k=this._idToStrs[a$t];return null==a$k?void 0:a$k}}(),function(){var a$W;function a$t(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}a$w(a$t,"laya.utils.Timer");var a$k=a$t.prototype;return a$k._init=function(){a$d.timer&&a$d.timer.frameLoop(1,this,this._update)},a$k._now=function(){return Date.now()},a$k._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var a$t=this.currFrame=this.currFrame+this.scale,a$k=this._now();this._delta=(a$k-this._lastTimer)*this.scale;var a$v=this.currTimer=this.currTimer+this._delta;a$d.isDebug&&6e4<Math.abs(a$k-this._lastTimer)&&console.error("系统时间错误！"+(a$k-this._lastTimer)),this._lastTimer=a$k;var a$j=this._handlers;for(a$S=this._count=0,a$V=a$j.length;a$S<a$V;a$S++)if(null!==(a$J=a$j[a$S]).method){var a$Q=a$J.userFrame?a$t:a$v;if(a$Q>=a$J.exeTime)if(a$J.repeat)if(a$J.jumpFrame)for(;a$Q>=a$J.exeTime;)a$J.exeTime+=a$J.delay,a$J.run(!1);else a$J.exeTime+=a$J.delay,a$J.run(!1),a$Q>a$J.exeTime&&(a$J.exeTime+=Math.ceil((a$Q-a$J.exeTime)/a$J.delay)*a$J.delay);else a$J.run(!0)}else this._count++;(30<this._count||a$t%200==0)&&this._clearHandlers();for(var a$u=this._laters,a$S=0,a$V=a$u.length-1;a$S<=a$V;a$S++){var a$J=a$u[a$S];this._isIgnoreRecover(a$J)||(null!==a$J.method&&(delete this._map[a$J.key],a$J.run(!1)),this._recoverHandler(a$J)),a$S===a$V&&(a$V=a$u.length-1)}a$u.length=0}},a$k._clearHandlers=function(){for(var a$t=this._handlers,a$k=0,a$v=a$t.length;a$k<a$v;a$k++){var a$j=a$t[a$k];null!==a$j.method?this._temp.push(a$j):this._isIgnoreRecover(a$j)?this._temp.push(a$j):this._recoverHandler(a$j)}this._handlers=this._temp,this._temp=a$t,this._temp.length=0},a$k._recoverHandler=function(a$t){this._map[a$t.key]==a$t&&delete this._map[a$t.key],a$t.recover()},a$k._create=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){if(!a$v)return a$Q.apply(a$j,a$u),null;if(a$S){var a$J=this._getHandler(a$j,a$Q);if(a$J)return a$J.repeat=a$k,a$J.userFrame=a$t,a$J.delay=a$v,a$J.ignoreRecover=a$V,a$J.caller=a$j,a$J.method=a$Q,a$J.args=a$u,a$J.exeTime=a$v+(a$t?this.currFrame:this.currTimer+this._now()-this._lastTimer),a$J}return(a$J=a$W.create()).repeat=a$k,a$J.userFrame=a$t,a$J.delay=a$v,a$J.ignoreRecover=a$V,a$J.caller=a$j,a$J.method=a$Q,a$J.args=a$u,a$J.exeTime=a$v+(a$t?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(a$J),this._handlers.push(a$J),a$J},a$k._indexHandler=function(a$t){var a$k=a$t.caller,a$v=a$t.method,a$j=a$k?a$k.$_GID||(a$k.$_GID=a$g.getGID()):0,a$Q=a$v.$_TID||(a$v.$_TID=this._mid++);a$t.key=a$j+"_"+a$Q,this._map[a$t.key]=a$t},a$k.once=function(a$t,a$k,a$v,a$j,a$Q){void 0===a$Q&&(a$Q=!0),this._create(!1,!1,a$t,a$k,a$v,a$j,a$Q,!1)},a$k.loop=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){void 0===a$Q&&(a$Q=!0),void 0===a$u&&(a$u=!1),void 0===a$S&&(a$S=!1);var a$V=this._create(!1,!0,a$t,a$k,a$v,a$j,a$Q,a$S);a$V&&(a$V.jumpFrame=a$u)},a$k.frameOnce=function(a$t,a$k,a$v,a$j,a$Q){void 0===a$Q&&(a$Q=!0),this._create(!0,!1,a$t,a$k,a$v,a$j,a$Q,!1)},a$k.frameLoop=function(a$t,a$k,a$v,a$j,a$Q,a$u){void 0===a$Q&&(a$Q=!0),void 0===a$u&&(a$u=!1),this._create(!0,!0,a$t,a$k,a$v,a$j,a$Q,a$u)},a$k.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+a$W._freeCount},a$k.clear=function(a$t,a$k){var a$v=this._getHandler(a$t,a$k);return!(!a$v||this._isIgnoreRecover(a$v))&&(delete this._map[a$v.key],a$v.key=null,a$v.clear(),!0)},a$k.clearAll=function(a$t){if(a$t)for(var a$k=0,a$v=this._handlers.length;a$k<a$v;a$k++){var a$j=this._handlers[a$k];a$j.caller===a$t&&(this._isIgnoreRecover(a$j)||(delete this._map[a$j.key],a$j.key=null,a$j.clear()))}},a$k._getHandler=function(a$t,a$k){var a$v=a$t?a$t.$_GID||(a$t.$_GID=a$g.getGID()):0,a$j=a$k.$_TID||(a$k.$_TID=this._mid++);return this._map[a$v+"_"+a$j]},a$k._isIgnoreRecover=function(a$t){if(a$t.ignoreRecover||a$t.caller&&"IgnoreRecover"==a$t.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var a$k="";try{arguments.propertyIsEnumerable.caller}catch(a$t){a$k=a$t.stack}a$d.recordError("报错：核心定时器销毁忽略  "+a$k)}return!0}return!1},a$k.hasHandler=function(a$t,a$k){return this._map[a$t.$_GID+"_"+a$k.$_TID]},a$k.callLater=function(a$t,a$k,a$v){if(null==this._getHandler(a$t,a$k)){var a$j=a$W.create();a$j.caller=a$t,a$j.method=a$k,a$j.args=a$v,this._indexHandler(a$j),this._laters.push(a$j)}},a$k.runCallLater=function(a$t,a$k){var a$v=this._getHandler(a$t,a$k);a$v&&null!=a$v.method&&(this._isIgnoreRecover(a$v)||(delete this._map[a$v.key],a$v.run(!0)))},a$k.runTimer=function(a$t,a$k){this.runCallLater(a$t,a$k)},a$A(0,a$k,"delta",function(){return this._delta}),a$t.__init$=function(){a$W=function(){function a$k(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}a$w(a$k,"");var a$t=a$k.prototype;return a$t.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},a$t.recover=function(){this.clear(),this.args=a$k._freeHandler,a$k._freeHandler=this,a$k._freeCount++},a$t.run=function(a$t){var a$k=this.caller;if(a$k&&a$k.destroyed)return this.clear();var a$v=this.method,a$j=this.args;a$t&&this.clear(),null!=a$v&&(a$j?a$v.apply(a$k,a$j):a$v.call(a$k))},a$k._freeHandler=null,a$k._freeCount=0,a$k.create=function(){var a$t=a$k._freeHandler;return a$t?(a$k._freeHandler=a$t.args,--a$k._freeCount,a$t.args=null,a$t):new a$k},a$k}()},a$t}()),a$r=function(){function a$M(){this.gid=0}a$w(a$M,"laya.utils.Tween");var a$t=a$M.prototype;return a$t.to=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){return void 0===a$u&&(a$u=0),void 0===a$S&&(a$S=!1),this._create(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,!0,!1,!0)},a$t.from=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){return void 0===a$u&&(a$u=0),void 0===a$S&&(a$S=!1),this._create(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,!1,!1,!0)},a$t._create=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){if(!a$t)throw new Error("Tween:target is null");this._target=a$t,this._duration=a$v,this._ease=a$j||a$k.ease||a$M.easeNone,this._complete=a$Q||a$k.complete,this._delay=a$u,this._props=[],this._usedTimer=0,this._startTimer=a$_.now(),this._usedPool=a$J,this._delayParam=null,this.update=a$k.update;var a$w=a$t.$_GID||(a$t.$_GID=a$g.getGID());return a$M.tweenMap[a$w]?(a$S&&a$M.clearTween(a$t),a$M.tweenMap[a$w].push(this)):a$M.tweenMap[a$w]=[this],a$W?a$u<=0?this.firstStart(a$t,a$k,a$V):(this._delayParam=[a$t,a$k,a$V],a$d.scaleTimer.once(a$u,this,this.firstStart,this._delayParam)):this._initProps(a$t,a$k,a$V),this},a$t.firstStart=function(a$t,a$k,a$v){this._delayParam=null,a$t.destroyed?this.clear():(this._initProps(a$t,a$k,a$v),this._beginLoop())},a$t._initProps=function(a$t,a$k,a$v){for(var a$j in a$k)if("number"==typeof a$t[a$j]){var a$Q=a$v?a$t[a$j]:a$k[a$j],a$u=a$v?a$k[a$j]:a$t[a$j];this._props.push([a$j,a$Q,a$u-a$Q]),a$v||(a$t[a$j]=a$Q)}},a$t._beginLoop=function(){a$d.scaleTimer.frameLoop(1,this,this._doEase)},a$t._doEase=function(){this._updateEase(a$_.now())},a$t._updateEase=function(a$t){var a$k=this._target;if(a$k){if(a$k.destroyed)return a$M.clearTween(a$k);var a$v=this._usedTimer=a$t-this._startTimer-this._delay;if(!(a$v<0)){if(a$v>=this._duration)return this.complete();for(var a$j=0<a$v?this._ease(a$v,0,1,this._duration):0,a$Q=this._props,a$u=0,a$S=a$Q.length;a$u<a$S;a$u++){var a$V=a$Q[a$u];a$k[a$V[0]]=a$V[1]+a$j*a$V[2]}this.update&&this.update.run()}}},a$t.complete=function(){if(this._target){a$d.scaleTimer.runTimer(this,this.firstStart);for(var a$t=this._target,a$k=this._props,a$v=this._complete,a$j=0,a$Q=a$k.length;a$j<a$Q;a$j++){var a$u=a$k[a$j];a$t[a$u[0]]=a$u[1]+a$u[2]}this.update&&this.update.run(),this.clear(),a$v&&a$v.run()}},a$t.pause=function(){a$d.scaleTimer.clear(this,this._beginLoop),a$d.scaleTimer.clear(this,this._doEase),a$d.scaleTimer.clear(this,this.firstStart);var a$t;(a$t=a$_.now()-this._startTimer-this._delay)<0&&(this._usedTimer=a$t)},a$t.setStartTime=function(a$t){this._startTimer=a$t},a$t.clear=function(){this._target&&(this._remove(),this._clear())},a$t._clear=function(){this.pause(),a$d.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,a$C.recover("tween",this))},a$t.recover=function(){this._usedPool=!0,this._clear()},a$t._remove=function(){var a$t=a$M.tweenMap[this._target.$_GID];if(a$t)for(var a$k=0,a$v=a$t.length;a$k<a$v;a$k++)if(a$t[a$k]===this){a$t.splice(a$k,1);break}},a$t.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=a$_.now(),this._delayParam)a$d.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var a$t=this._props,a$k=0,a$v=a$t.length;a$k<a$v;a$k++){var a$j=a$t[a$k];this._target[a$j[0]]=a$j[1]}a$d.scaleTimer.once(this._delay,this,this._beginLoop)}},a$t.resume=function(){this._usedTimer>=this._duration||(this._startTimer=a$_.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?a$d.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},a$A(0,a$t,"progress",null,function(a$t){var a$k=a$t*this._duration;this._startTimer=a$_.now()-this._delay-a$k}),a$M.to=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){return void 0===a$u&&(a$u=0),void 0===a$S&&(a$S=!1),void 0===a$V&&(a$V=!0),a$C.getItemByClass("tween",a$M)._create(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,!0,a$V,!0)},a$M.from=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){return void 0===a$u&&(a$u=0),void 0===a$S&&(a$S=!1),void 0===a$V&&(a$V=!0),a$C.getItemByClass("tween",a$M)._create(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,!1,a$V,!0)},a$M.clearAll=function(a$t){if(a$t&&a$t.$_GID){var a$k=a$M.tweenMap[a$t.$_GID];if(a$k){for(var a$v=0,a$j=a$k.length;a$v<a$j;a$v++)a$k[a$v]._clear();a$k.length=0}}},a$M.clear=function(a$t){a$t.clear()},a$M.clearTween=function(a$t){a$M.clearAll(a$t)},a$M.easeNone=function(a$t,a$k,a$v,a$j){return a$v*a$t/a$j+a$k},a$M.tweenMap={},a$M}(),a$g=function(){function a$V(){}return a$w(a$V,"laya.utils.Utils"),a$V.toRadian=function(a$t){return a$t*a$V._pi2},a$V.toAngle=function(a$t){return a$t*a$V._pi},a$V.toHexColor=function(a$t){if(a$t<0||isNaN(a$t))return null;for(var a$k=a$t.toString(16);a$k.length<6;)a$k="0"+a$k;return"#"+a$k},a$V.getGID=function(){return a$V._gid++},a$V.concatArray=function(a$t,a$k){if(!a$k)return a$t;if(!a$t)return a$k;var a$v=0,a$j=a$k.length;for(a$v=0;a$v<a$j;a$v++)a$t.push(a$k[a$v]);return a$t},a$V.clearArray=function(a$t){return a$t&&(a$t.length=0),a$t},a$V.copyArray=function(a$t,a$k){if(a$t||(a$t=[]),!a$k)return a$t;a$t.length=a$k.length;var a$v=0,a$j=a$k.length;for(a$v=0;a$v<a$j;a$v++)a$t[a$v]=a$k[a$v];return a$t},a$V.getGlobalRecByPoints=function(a$t,a$k,a$v,a$j,a$Q){var a$u,a$S;return a$u=new a$m(a$k,a$v),a$u=a$t.localToGlobal(a$u),a$S=new a$m(a$j,a$Q),a$S=a$t.localToGlobal(a$S),a$Z._getWrapRec([a$u.x,a$u.y,a$S.x,a$S.y])},a$V.getGlobalPosAndScale=function(a$t){return a$V.getGlobalRecByPoints(a$t,0,0,1,1)},a$V.bind=function(a$t,a$k){return a$t.bind(a$k)},a$V.measureText=function(a$t,a$k){return a$N.measureText(a$t,a$k)},a$V.updateOrder=function(a$t){if(!a$t||a$t.length<2)return!1;for(var a$k,a$v=1,a$j=0,a$Q=a$t.length,a$u=NaN;a$v<a$Q;){for(a$k=a$t[a$j=a$v],a$u=a$t[a$j]._zOrder;-1<--a$j&&a$t[a$j]._zOrder>a$u;)a$t[a$j+1]=a$t[a$j];a$t[a$j+1]=a$k,a$v++}var a$S=a$k.parent.conchModel;if(a$S)if(null!=a$S.updateZOrder)a$S.updateZOrder();else{for(a$v=0;a$v<a$Q;a$v++)a$S.removeChild(a$t[a$v].conchModel);for(a$v=0;a$v<a$Q;a$v++)a$S.addChildAt(a$t[a$v].conchModel,a$v)}return!0},a$V.transPointList=function(a$t,a$k,a$v){var a$j=0,a$Q=a$t.length;for(a$j=0;a$j<a$Q;a$j+=2)a$t[a$j]+=a$k,a$t[a$j+1]+=a$v},a$V.parseInt=function(a$t,a$k){void 0===a$k&&(a$k=0);var a$v=a$_.window.parseInt(a$t,a$k);return isNaN(a$v)?0:a$v},a$V.getFileExtension=function(a$t){a$V._extReg.lastIndex=a$t.lastIndexOf(".");var a$k=a$V._extReg.exec(a$t);return a$k&&1<a$k.length?a$k[1].toLowerCase():null},a$V.getTransformRelativeToWindow=function(a$t,a$k,a$v){var a$j=a$d.stage,a$Q=laya.utils.Utils.getGlobalPosAndScale(a$t),a$u=a$j._canvasTransform.clone(),a$S=a$u.tx,a$V=a$u.ty;a$u.rotate(-Math.PI/180*a$d.stage.canvasDegree),a$u.scale(a$d.stage.clientScaleX,a$d.stage.clientScaleY);var a$J=a$d.stage.canvasDegree%180!=0,a$W=NaN,a$w=NaN;a$J?(a$W=a$v+a$Q.y,a$w=a$k+a$Q.x,a$W*=a$u.d,a$w*=a$u.a,90==a$d.stage.canvasDegree?(a$W=a$S-a$W,a$w+=a$V):(a$W+=a$S,a$w=a$V-a$w)):(a$W=a$k+a$Q.x,a$w=a$v+a$Q.y,a$W*=a$u.a,a$w*=a$u.d,a$W+=a$S,a$w+=a$V);var a$M=NaN,a$H=NaN;return a$H=a$J?(a$M=a$u.d*a$Q.height,a$u.a*a$Q.width):(a$M=a$u.a*a$Q.width,a$u.d*a$Q.height),{x:a$W,y:a$w,scaleX:a$M,scaleY:a$H}},a$V.fitDOMElementInArea=function(a$t,a$k,a$v,a$j,a$Q,a$u){a$t._fitLayaAirInitialized||(a$t._fitLayaAirInitialized=!0,a$t.style.transformOrigin=a$t.style.webKittransformOrigin="left top",a$t.style.position="absolute");var a$S=a$V.getTransformRelativeToWindow(a$k,a$v,a$j);a$t.style.transform=a$t.style.webkitTransform="scale("+a$S.scaleX+","+a$S.scaleY+") rotate("+a$d.stage.canvasDegree+"deg)",a$t.style.width=a$Q+"px",a$t.style.height=a$u+"px",a$t.style.left=a$S.x+"px",a$t.style.top=a$S.y+"px"},a$V.isOkTextureList=function(a$t){if(!a$t)return!1;var a$k,a$v=0,a$j=a$t.length;for(a$v=0;a$v<a$j;a$v++)if(!(a$k=a$t[a$v])||!a$k.source)return!1;return!0},a$V.isOKCmdList=function(a$t){if(!a$t)return!1;var a$k,a$v,a$j=0,a$Q=a$t.length,a$u=a$c._context;for(a$j=0;a$j<a$Q;a$j++)switch((a$k=a$t[a$j]).callee){case a$u._drawTexture:case a$u._fillTexture:case a$u._drawTextureWithTransform:if(!(a$v=a$k[0])||!a$v.source)return!1}return!0},a$V._gid=1,a$V._pi=180/Math.PI,a$V._pi2=Math.PI/180,a$V._extReg=/\.(\w+)\??/g,a$V.parseXMLFromString=function(a$t){var a$k;if(a$t=a$t.replace(/>\s+</g,"><"),-1<(a$k=(new DOMParser).parseFromString(a$t,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(a$k.firstChild.firstChild.textContent);return a$k},a$V}(),a$$=function(){function a$t(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],a$c.isWebGL&&a$I.regCacheByFunction(a$g.bind(this.startDispose,this),a$g.bind(this.getCacheList,this))}a$w(a$t,"laya.utils.VectorGraphManager");var a$k=a$t.prototype;return a$k.getId=function(){return this._id++},a$k.addShape=function(a$t,a$k){this.shapeDic[a$t]=a$k,this.useDic[a$t]||(this.useDic[a$t]=!0)},a$k.addLine=function(a$t,a$k){this.shapeLineDic[a$t]=a$k,this.shapeLineDic[a$t]||(this.shapeLineDic[a$t]=!0)},a$k.getShape=function(a$t){this._checkKey&&null!=this.useDic[a$t]&&(this.useDic[a$t]=!0)},a$k.deleteShape=function(a$t){this.shapeDic[a$t]&&(this.shapeDic[a$t]=null,delete this.shapeDic[a$t]),this.shapeLineDic[a$t]&&(this.shapeLineDic[a$t]=null,delete this.shapeLineDic[a$t]),null!=this.useDic[a$t]&&delete this.useDic[a$t]},a$k.getCacheList=function(){var a$t,a$k=[];for(a$t in this.shapeDic)a$k.push(this.shapeDic[a$t]);for(a$t in this.shapeLineDic)a$k.push(this.shapeLineDic[a$t]);return a$k},a$k.startDispose=function(a$t){var a$k;for(a$k in this.useDic)this.useDic[a$k]=!1;this._checkKey=!0},a$k.endDispose=function(){if(this._checkKey){var a$t;for(a$t in this.useDic)this.useDic[a$t]||this.deleteShape(a$t);this._checkKey=!1}},a$t.getInstance=function(){return a$t.instance=a$t.instance||new a$t},a$t.instance=null,a$t}(),a$y=function(){function a$j(){this._obj=null,this._obj=a$j.supportWeakMap?new a$_.window.WeakMap:{},a$j.supportWeakMap||a$j._maps.push(this)}a$w(a$j,"laya.utils.WeakObject");var a$t=a$j.prototype;return a$t.set=function(a$t,a$k){if(null!=a$t)if(a$j.supportWeakMap){var a$v=a$t;"string"!=typeof a$t&&"number"!=typeof a$t||(a$v=a$j._keys[a$t])||(a$v=a$j._keys[a$t]={k:a$t}),this._obj.set(a$v,a$k)}else"string"==typeof a$t||"number"==typeof a$t?this._obj[a$t]=a$k:(a$t.$_GID||(a$t.$_GID=a$g.getGID()),this._obj[a$t.$_GID]=a$k)},a$t.get=function(a$t){if(null==a$t)return null;if(a$j.supportWeakMap){var a$k="string"==typeof a$t||"number"==typeof a$t?a$j._keys[a$t]:a$t;return a$k?this._obj.get(a$k):null}return"string"==typeof a$t||"number"==typeof a$t?this._obj[a$t]:this._obj[a$t.$_GID]},a$t.del=function(a$t){if(null!=a$t)if(a$j.supportWeakMap){var a$k="string"==typeof a$t||"number"==typeof a$t?a$j._keys[a$t]:a$t;if(!a$k)return;this._obj.delete(a$k)}else"string"==typeof a$t||"number"==typeof a$t?delete this._obj[a$t]:delete this._obj[this._obj.$_GID]},a$t.has=function(a$t){if(null==a$t)return!1;if(a$j.supportWeakMap){var a$k="string"==typeof a$t||"number"==typeof a$t?a$j._keys[a$t]:a$t;return this._obj.has(a$k)}return"string"==typeof a$t||"number"==typeof a$t?null!=this._obj[a$t]:null!=this._obj[this._obj.$_GID]},a$j.__init__=function(){(a$j.supportWeakMap=null!=a$_.window.WeakMap)||a$d.timer.loop(a$j.delInterval,null,a$j.clearCache)},a$j.clearCache=function(){for(var a$t=0,a$k=a$j._maps.length;a$t<a$k;a$t++){a$j._maps[a$t]._obj={}}},a$j.supportWeakMap=!1,a$j.delInterval=3e5,a$j._keys={},a$j._maps=[],a$J(a$j,["I",function(){return this.I=new a$j}]),a$j}(),a$P=function(){function a$t(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}a$w(a$t,"laya.utils.WordText");var a$k=a$t.prototype;return a$k.setText=function(a$t){this.changed=!0,this._text=a$t},a$k.toString=function(){return this._text},a$k.charCodeAt=function(a$t){return this._text?this._text.charCodeAt(a$t):NaN},a$k.charAt=function(a$t){return this._text?this._text.charAt(a$t):null},a$A(0,a$k,"length",function(){return this._text?this._text.length:0}),a$t}(),a$tt=function(a$t){function a$S(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,a$S.__super.call(this),this._childs=a$S.ARRAY_EMPTY,this._$P=a$S.PROP_EMPTY,this.timer=a$d.scaleTimer,this.conchModel=a$c.isConchNode?this.createConchModel():null}a$w(a$S,"laya.display.Node",a$W);var a$k=a$S.prototype;return a$k._setBit=function(a$t,a$k){1==a$t&&(this._getBit(a$t)!=a$k&&this._updateDisplayedInstage());a$k?this._bits|=a$t:this._bits&=~a$t},a$k._getBit=function(a$t){return 0!=(this._bits&a$t)},a$k._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},a$k._setUpNoticeType=function(a$t){var a$k=this;for(a$k._setBit(a$t,!0),a$k=a$k.parent;a$k;){if(a$k._getBit(a$t))return;a$k._setBit(a$t,!0),a$k=a$k.parent}},a$k.on=function(a$t,a$k,a$v,a$j){return"display"!==a$t&&"undisplay"!==a$t||this._getBit(1)||this._setUpNoticeType(1),this._createListener(a$t,a$k,a$v,a$j,!1)},a$k.once=function(a$t,a$k,a$v,a$j){return"display"!==a$t&&"undisplay"!==a$t||this._getBit(1)||this._setUpNoticeType(1),this._createListener(a$t,a$k,a$v,a$j,!0)},a$k.createConchModel=function(){return null},a$k.destroy=function(a$t){void 0===a$t&&(a$t=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(a$t?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},a$k.destroyChildren=function(){if(this._childs)for(var a$t=this._childs.length-1;-1<a$t;a$t--)this._childs[a$t].destroy(!0)},a$k.addChild=function(a$t){if(!a$t||this.destroyed||a$t===this)return a$t;if(a$t.zOrder&&this._set$P("hasZorder",!0),a$t._parent===this){var a$k=this.getChildIndex(a$t);a$k!==this._childs.length-1&&(this._childs.splice(a$k,1),this._childs.push(a$t),this.conchModel&&(this.conchModel.removeChild(a$t.conchModel),this.conchModel.addChildAt(a$t.conchModel,this._childs.length-1)),this._childChanged())}else a$t.parent&&a$t.parent.removeChild(a$t),this._childs===a$S.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(a$t),this.conchModel&&this.conchModel.addChildAt(a$t.conchModel,this._childs.length-1),(a$t.parent=this)._childChanged();return a$t},a$k.addChildren=function(a$t){for(var a$k=arguments,a$v=0,a$j=a$k.length;a$v<a$j;)this.addChild(a$k[a$v++])},a$k.addChildAt=function(a$t,a$k){if(!a$t||this.destroyed||a$t===this)return a$t;if(a$t.zOrder&&this._set$P("hasZorder",!0),0<=a$k&&a$k<=this._childs.length){if(a$t._parent===this){var a$v=this.getChildIndex(a$t);this._childs.splice(a$v,1),this._childs.splice(a$k,0,a$t),this.conchModel&&(this.conchModel.removeChild(a$t.conchModel),this.conchModel.addChildAt(a$t.conchModel,a$k)),this._childChanged()}else a$t.parent&&a$t.parent.removeChild(a$t),this._childs===a$S.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(a$k,0,a$t),this.conchModel&&this.conchModel.addChildAt(a$t.conchModel,a$k),a$t.parent=this;return a$t}throw new Error("appendChildAt:The index is out of bounds")},a$k.getChildIndex=function(a$t){return this._childs.indexOf(a$t)},a$k.getChildByName=function(a$t){var a$k=this._childs;if(a$k)for(var a$v=0,a$j=a$k.length;a$v<a$j;a$v++){var a$Q=a$k[a$v];if(a$Q.name===a$t)return a$Q}return null},a$k._get$P=function(a$t){return this._$P[a$t]},a$k._set$P=function(a$t,a$k){return this.destroyed||(this._$P===a$S.PROP_EMPTY&&(this._$P={}),this._$P[a$t]=a$k),a$k},a$k.getChildAt=function(a$t){return this._childs[a$t]},a$k.setChildIndex=function(a$t,a$k){var a$v=this._childs;if(a$k<0||a$k>=a$v.length)throw new Error("setChildIndex:The index is out of bounds.");var a$j=this.getChildIndex(a$t);if(a$j<0)throw new Error("setChildIndex:node is must child of this object.");return a$v.splice(a$j,1),a$v.splice(a$k,0,a$t),this.conchModel&&(this.conchModel.removeChild(a$t.conchModel),this.conchModel.addChildAt(a$t.conchModel,a$k)),this._childChanged(),a$t},a$k._childChanged=function(a$t){},a$k.removeChild=function(a$t){if(!this._childs)return a$t;var a$k=this._childs.indexOf(a$t);return this.removeChildAt(a$k)},a$k.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},a$k.removeChildByName=function(a$t){var a$k=this.getChildByName(a$t);return a$k&&this.removeChild(a$k),a$k},a$k.removeChildAt=function(a$t){var a$k=this.getChildAt(a$t);if(a$k){for(var a$v=this._childs.length-1,a$j=a$t;a$j<a$v;++a$j)this._childs[a$j]=this._childs[a$j+1];this._childs.length=a$v,this.conchModel&&this.conchModel.removeChild(a$k.conchModel),a$k.parent=null}return a$k},a$k.removeChildren=function(a$t,a$k){if(void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=2147483647),this._childs&&0<this._childs.length){var a$v=this._childs;if(0===a$t&&a$u<=a$k){var a$j=a$v;this._childs=a$S.ARRAY_EMPTY}else a$j=a$v.splice(a$t,a$k-a$t);for(var a$Q=0,a$u=a$j.length;a$Q<a$u;a$Q++)a$j[a$Q].parent=null,this.conchModel&&this.conchModel.removeChild(a$j[a$Q].conchModel)}return this},a$k.replaceChild=function(a$t,a$k){var a$v=this._childs.indexOf(a$k);return-1<a$v?(this._childs.splice(a$v,1,a$t),this.conchModel&&(this.conchModel.removeChild(a$k.conchModel),this.conchModel.addChildAt(a$t.conchModel,a$v)),a$k.parent=null,a$t.parent=this,a$t):null},a$k._updateDisplayedInstage=function(){var a$t;a$t=this;var a$k=a$d.stage;for(this._displayedInStage=!1;a$t;){if(a$t._getBit(1)){this._displayedInStage=a$t._displayedInStage;break}if(a$t==a$k||a$t._displayedInStage){this._displayedInStage=!0;break}a$t=a$t.parent}},a$k._setDisplay=function(a$t){this._displayedInStage!==a$t&&((this._displayedInStage=a$t)?this.event("display"):this.event("undisplay"))},a$k._displayChild=function(a$t,a$k){var a$v=a$t._childs;if(a$v)for(var a$j=0;a$j<a$v.length;a$j++){var a$Q=a$v[a$j];a$Q&&a$Q._getBit(1)&&(0<a$Q._childs.length?this._displayChild(a$Q,a$k):a$Q._setDisplay(a$k))}a$t._setDisplay(a$k)},a$k.contains=function(a$t){if(a$t===this)return!0;for(;a$t;){if(a$t.parent===this)return!0;a$t=a$t.parent}return!1},a$k.timerLoop=function(a$t,a$k,a$v,a$j,a$Q,a$u){void 0===a$Q&&(a$Q=!0),void 0===a$u&&(a$u=!1),this.timer.loop(a$t,a$k,a$v,a$j,a$Q,a$u)},a$k.timerOnce=function(a$t,a$k,a$v,a$j,a$Q){void 0===a$Q&&(a$Q=!0),this.timer._create(!1,!1,a$t,a$k,a$v,a$j,a$Q)},a$k.frameLoop=function(a$t,a$k,a$v,a$j,a$Q){void 0===a$Q&&(a$Q=!0),this.timer._create(!0,!0,a$t,a$k,a$v,a$j,a$Q)},a$k.frameOnce=function(a$t,a$k,a$v,a$j,a$Q){void 0===a$Q&&(a$Q=!0),this.timer._create(!0,!1,a$t,a$k,a$v,a$j,a$Q)},a$k.clearTimer=function(a$t,a$k){this.timer.clear(a$t,a$k)},a$A(0,a$k,"numChildren",function(){return this._childs.length}),a$A(0,a$k,"destroyed",function(){return this._destroyed}),a$A(0,a$k,"parent",function(){return this._parent},function(a$t){this._parent!==a$t&&(a$t?(this._parent=a$t,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),a$t.displayedInStage&&this._displayChild(this,!0)),a$t._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=a$t))}),a$A(0,a$k,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),a$S.ARRAY_EMPTY=[],a$S.PROP_EMPTY={},a$S.NOTICE_DISPLAY=1,a$S.MOUSEENABLE=2,a$S}(),a$kt=function(a$t){function a$H(a$t){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,a$H.__super.call(this),this._padding=a$H._PADDING,this._spacing=a$H._SPACING,this._aligns=a$H._ALIGNS,this._font=a$E.EMPTY,this._ower=a$t}a$w(a$H,"laya.display.css.CSSStyle",a$t);var a$k=a$H.prototype;return a$k.destroy=function(){this._ower=null,this._font=null,this._rect=null},a$k.inherit=function(a$t){this._font=a$t._font,this._spacing=a$t._spacing===a$H._SPACING?a$H._SPACING:a$t._spacing.slice(),this.lineHeight=a$t.lineHeight},a$k._widthAuto=function(){return 0!=(262144&this._type)},a$k.widthed=function(a$t){return 0!=(8&this._type)},a$k._calculation=function(a$t,a$k){if(a$k.indexOf("%")<0)return!1;var a$j=this._ower,a$Q=a$j.parent,a$u=this._rect;function a$S(a$t,a$k,a$v){return a$t*a$v[0]+a$k*a$v[1]+a$v[2]}function a$v(a$t){var a$k=a$Q.width,a$v=a$j.width;a$u.width&&(a$j.width=a$S(a$k,a$v,a$u.width)),a$u.height&&(a$j.height=a$S(a$k,a$v,a$u.height)),a$u.left&&(a$j.x=a$S(a$k,a$v,a$u.left)),a$u.top&&(a$j.y=a$S(a$k,a$v,a$u.top))}null===a$u&&(a$Q._getCSSStyle()._type|=524288,a$Q.on("resize",this,a$v),this._rect=a$u={input:{}});var a$V=a$k.split(" ");return a$V[0]=parseFloat(a$V[0])/100,1==a$V.length?a$V[1]=a$V[2]=0:(a$V[1]=parseFloat(a$V[1])/100,a$V[2]=parseFloat(a$V[2])),a$u[a$t]=a$V,a$u.input[a$t]=a$k,a$v(),!0},a$k.heighted=function(a$t){return 0!=(8192&this._type)},a$k.size=function(a$t,a$k){var a$v=this._ower,a$j=!1;-1!==a$t&&a$t!=this._ower.width&&(this._type|=8,this._ower.width=a$t,a$j=!0),-1!==a$k&&a$k!=this._ower.height&&(this._type|=8192,this._ower.height=a$k,a$j=!0),a$j&&(a$v._layoutLater(),524288&this._type&&a$v.event("resize",this))},a$k._getAlign=function(){return this._aligns[0]},a$k._getValign=function(){return this._aligns[1]},a$k._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},a$k._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new a$E(this._font))},a$k.render=function(a$t,a$k,a$v,a$j){var a$Q=a$t.width,a$u=a$t.height;a$v-=a$t.pivotX,a$j-=a$t.pivotY,this._bgground&&null!=this._bgground.color&&a$k.ctx.fillRect(a$v,a$j,a$Q,a$u,this._bgground.color),this._border&&this._border.color&&a$k.drawRect(a$v,a$j,a$Q,a$u,this._border.color.strColor,this._border.size)},a$k.getCSSStyle=function(){return this},a$k.cssText=function(a$t){this.attrs(a$H.parseOneCSS(a$t,";"))},a$k.attrs=function(a$t){if(a$t)for(var a$k=0,a$v=a$t.length;a$k<a$v;a$k++){var a$j=a$t[a$k];this[a$j[0]]=a$j[1]}},a$k.setTransform=function(a$t){"none"===a$t?this._tf=a$V._TF_EMPTY:this.attrs(a$H.parseOneCSS(a$t,","))},a$k.translate=function(a$t,a$k){this._tf===a$V._TF_EMPTY&&(this._tf=new a$Q),this._tf.translateX=a$t,this._tf.translateY=a$k},a$k.scale=function(a$t,a$k){this._tf===a$V._TF_EMPTY&&(this._tf=new a$Q),this._tf.scaleX=a$t,this._tf.scaleY=a$k},a$k._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},a$A(0,a$k,"block",a$t.prototype._$get_block,function(a$t){a$t?this._type|=1:this._type&=-2}),a$A(0,a$k,"valign",function(){return a$H._valigndef[this._aligns[1]]},function(a$t){this._aligns===a$H._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=a$H._valigndef[a$t]}),a$A(0,a$k,"height",null,function(a$t){if(this._type|=8192,"string"==typeof a$t){if(this._calculation("height",a$t))return;a$t=parseInt(a$t)}this.size(-1,a$t)}),a$A(0,a$k,"width",null,function(a$t){if(this._type|=8,"string"==typeof a$t){var a$k=a$t.indexOf("auto");if(0<=a$k&&(this._type|=262144,a$t=a$t.substr(0,a$k)),this._calculation("width",a$t))return;a$t=parseInt(a$t)}this.size(a$t,-1)}),a$A(0,a$k,"fontWeight",function(){return this._font.weight},function(a$t){this._createFont().weight=a$t}),a$A(0,a$k,"left",null,function(a$t){var a$k=this._ower;if("string"==typeof a$t){if("center"===a$t?a$t="50% -50% 0":"right"===a$t&&(a$t="100% -100% 0"),this._calculation("left",a$t))return;a$t=parseInt(a$t)}a$k.x=a$t}),a$A(0,a$k,"_translate",null,function(a$t){this.translate(a$t[0],a$t[1])}),a$A(0,a$k,"absolute",function(){return 0!=(4&this._type)}),a$A(0,a$k,"top",null,function(a$t){var a$k=this._ower;if("string"==typeof a$t){if("middle"===a$t?a$t="50% -50% 0":"bottom"===a$t&&(a$t="100% -100% 0"),this._calculation("top",a$t))return;a$t=parseInt(a$t)}a$k.y=a$t}),a$A(0,a$k,"align",function(){return a$H._aligndef[this._aligns[0]]},function(a$t){this._aligns===a$H._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=a$H._aligndef[a$t]}),a$A(0,a$k,"bold",function(){return this._font.bold},function(a$t){this._createFont().bold=a$t}),a$A(0,a$k,"padding",function(){return this._padding},function(a$t){this._padding=a$t}),a$A(0,a$k,"leading",function(){return this._spacing[1]},function(a$t){"string"==typeof a$t&&(a$t=parseInt(a$t+"")),this._spacing===a$H._SPACING&&(this._spacing=[0,0]),this._spacing[1]=a$t}),a$A(0,a$k,"lineElement",function(){return 0!=(65536&this._type)},function(a$t){a$t?this._type|=65536:this._type&=-65537}),a$A(0,a$k,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(a$t){this.lineElement=!1,"right"===a$t?this._type|=32768:this._type&=-32769}),a$A(0,a$k,"textDecoration",function(){return this._font.decoration},function(a$t){this._createFont().decoration=a$t}),a$A(0,a$k,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(a$t){"nowrap"===a$t&&(this._type|=131072),"none"===a$t&&(this._type&=-131073)}),a$A(0,a$k,"background",null,function(a$t){a$t?(this._bgground||(this._bgground={}),this._bgground.color=a$t,this._ower.conchModel&&this._ower.conchModel.bgColor(a$t),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),a$A(0,a$k,"wordWrap",function(){return 0==(131072&this._type)},function(a$t){a$t?this._type&=-131073:this._type|=131072}),a$A(0,a$k,"color",function(){return this._font.color},function(a$t){this._createFont().color=a$t}),a$A(0,a$k,"password",function(){return this._font.password},function(a$t){this._createFont().password=a$t}),a$A(0,a$k,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(a$t){"none"===a$t?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=a$t),this._ower.conchModel&&this._ower.conchModel.bgColor(a$t),this._ower._renderType|=256}),a$A(0,a$k,"font",function(){return this._font.toString()},function(a$t){this._createFont().set(a$t)}),a$A(0,a$k,"weight",null,function(a$t){this._createFont().weight=a$t}),a$A(0,a$k,"letterSpacing",function(){return this._spacing[0]},function(a$t){"string"==typeof a$t&&(a$t=parseInt(a$t+"")),this._spacing===a$H._SPACING&&(this._spacing=[0,0]),this._spacing[0]=a$t}),a$A(0,a$k,"fontSize",function(){return this._font.size},function(a$t){this._createFont().size=a$t}),a$A(0,a$k,"italic",function(){return this._font.italic},function(a$t){this._createFont().italic=a$t}),a$A(0,a$k,"fontFamily",function(){return this._font.family},function(a$t){this._createFont().family=a$t}),a$A(0,a$k,"stroke",function(){return this._font.stroke[0]},function(a$t){this._createFont().stroke===a$E._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=a$t}),a$A(0,a$k,"strokeColor",function(){return this._font.stroke[1]},function(a$t){this._createFont().stroke===a$E._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=a$t}),a$A(0,a$k,"border",function(){return this._border?this._border.value:""},function(a$t){if("none"!=a$t){this._border||(this._border={});var a$k=(this._border.value=a$t).split(" ");if(this._border.color=a$D.create(a$k[a$k.length-1]),1==a$k.length)return this._border.size=1,void(this._border.type="solid");var a$v=0;0<a$k[0].indexOf("px")?(this._border.size=parseInt(a$k[0]),a$v++):this._border.size=1,this._border.type=a$k[a$v],this._ower._renderType|=256}else this._border=null}),a$A(0,a$k,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(a$t){a$t?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==a$t?null:a$D.create(a$t),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),a$A(0,a$k,"position",function(){return 4&this._type?"absolute":""},function(a$t){"absolute"==a$t?this._type|=4:this._type&=-5}),a$A(0,a$k,"display",null,function(a$t){switch(a$t){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),a$A(0,a$k,"paddingLeft",function(){return this.padding[3]}),a$A(0,a$k,"paddingTop",function(){return this.padding[0]}),a$A(0,a$k,"_scale",null,function(a$t){this._ower.scale(a$t[0],a$t[1])}),a$A(0,a$k,"_rotate",null,function(a$t){this._ower.rotation=a$t}),a$H.parseOneCSS=function(a$t,a$k){for(var a$v,a$j=[],a$Q=a$t.split(a$k),a$u=0,a$S=a$Q.length;a$u<a$S;a$u++){var a$V=a$Q[a$u],a$J=a$V.indexOf(":"),a$W=a$V.substr(0,a$J).replace(/^\s+|\s+$/g,"");if(0!=a$W.length){var a$w=a$V.substr(a$J+1).replace(/^\s+|\s+$/g,""),a$M=[a$W,a$w];switch(a$W){case"italic":case"bold":a$M[1]="true"==a$w;break;case"line-height":a$M[0]="lineHeight",a$M[1]=parseInt(a$w);break;case"font-size":a$M[0]="fontSize",a$M[1]=parseInt(a$w);break;case"padding":1<(a$v=a$w.split(" ")).length||(a$v[1]=a$v[2]=a$v[3]=a$v[0]),a$M[1]=[parseInt(a$v[0]),parseInt(a$v[1]),parseInt(a$v[2]),parseInt(a$v[3])];break;case"rotate":a$M[0]="_rotate",a$M[1]=parseFloat(a$w);break;case"scale":a$v=a$w.split(" "),a$M[0]="_scale",a$M[1]=[parseFloat(a$v[0]),parseFloat(a$v[1])];break;case"translate":a$v=a$w.split(" "),a$M[0]="_translate",a$M[1]=[parseInt(a$v[0]),parseInt(a$v[1])];break;default:(a$M[0]=a$H._CSSTOVALUE[a$W])||(a$M[0]=a$W)}a$j.push(a$M)}}return a$j},a$H.parseCSS=function(a$t,a$k){for(var a$v;null!=(a$v=a$H._parseCSSRegExp.exec(a$t));)a$H.styleSheets[a$v[1]]=a$H.parseOneCSS(a$v[2],";")},a$H.EMPTY=new a$H(null),a$H._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},a$H._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),a$H._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},a$H._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},a$H.styleSheets={},a$H.ALIGN_CENTER=1,a$H.ALIGN_RIGHT=2,a$H.VALIGN_MIDDLE=1,a$H.VALIGN_BOTTOM=2,a$H._CSS_BLOCK=1,a$H._DISPLAY_NONE=2,a$H._ABSOLUTE=4,a$H._WIDTH_SET=8,a$H._PADDING=[0,0,0,0],a$H._RECT=[-1,-1,-1,-1],a$H._SPACING=[0,0],a$H._ALIGNS=[0,0,0],a$H.ADDLAYOUTED=512,a$H._NEWFONT=4096,a$H._HEIGHT_SET=8192,a$H._BACKGROUND_SET=16384,a$H._FLOAT_RIGHT=32768,a$H._LINE_ELEMENT=65536,a$H._NOWARP=131072,a$H._WIDTHAUTO=262144,a$H._LISTERRESZIE=524288,a$H}(a$V),a$vt=function(a$t){function a$S(){this.url=null,this.audio=null,this.loaded=!1,a$S.__super.call(this)}a$w(a$S,"laya.media.h5audio.AudioSound",a$W);var a$k=a$S.prototype;return a$k.dispose=function(){var a$t=a$S._audioCache[this.url];a$t&&(a$t.src="",delete a$S._audioCache[this.url])},a$k.load=function(a$t){var a$k;if(a$t=a$G.formatURL(a$t),(this.url=a$t)==a$U._tMusic?(a$S._initMusicAudio(),(a$k=a$S._musicAudio).src!=a$t&&(a$S._audioCache[a$k.src]=null,a$k=null)):a$k=a$S._audioCache[a$t],a$k&&2<=a$k.readyState)this.event("complete");else{a$k||(a$k=a$t==a$U._tMusic?(a$S._initMusicAudio(),a$S._musicAudio):a$_.createElement("audio"),(a$S._audioCache[a$t]=a$k).src=a$t),a$k.addEventListener("canplaythrough",a$j),a$k.addEventListener("error",a$Q);var a$v=this;(this.audio=a$k).load?a$k.load():a$Q()}function a$j(){a$u(),a$v.loaded=!0,a$v.event("complete")}function a$Q(){a$k.load=null,a$u(),a$v.event("error")}function a$u(){a$k.removeEventListener("canplaythrough",a$j),a$k.removeEventListener("error",a$Q)}},a$k.play=function(a$t,a$k,a$v){if(void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),!this.url)return null;var a$j,a$Q;if(!(a$j=this.url==a$U._tMusic?a$S._musicAudio:a$S._audioCache[this.url]))return null;a$Q=a$C.getItem("audio:"+this.url),a$c.isConchApp?a$Q||((a$Q=a$_.createElement("audio")).src=this.url):this.url==a$U._tMusic?(a$S._initMusicAudio(),(a$Q=a$S._musicAudio).src=this.url):a$Q=a$Q||a$j.cloneNode(!0);var a$u=new a$Ht(a$Q);return a$u.url=this.url,a$u.loops=a$k,a$u.startTime=a$t,a$u.startHandler=a$v,a$u.play(!1),a$U.addChannel(a$u),a$u},a$A(0,a$k,"duration",function(){var a$t;return(a$t=a$S._audioCache[this.url])?a$t.duration:0}),a$S._initMusicAudio=function(){a$S._musicAudio||(a$S._musicAudio||(a$S._musicAudio=a$_.createElement("audio")),a$c.isConchApp||a$_.document.addEventListener("mousedown",a$S._makeMusicOK))},a$S._makeMusicOK=function(){a$_.document.removeEventListener("mousedown",a$S._makeMusicOK),a$S._musicAudio.src?a$S._musicAudio.play():(a$S._musicAudio.src="",a$S._musicAudio.load())},a$S._audioCache={},a$S._musicAudio=null,a$S}(),a$jt=function(a$t){function a$k(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,a$k.__super.call(this)}a$w(a$k,"laya.media.SoundChannel",a$W);var a$v=a$k.prototype;return a$v.play=function(){},a$v.stop=function(){},a$v.pause=function(){},a$v.resume=function(){},a$v.__runComplete=function(a$t){a$t&&a$t.run()},a$A(0,a$v,"volume",function(){return 1},function(a$t){}),a$A(0,a$v,"position",function(){return 0}),a$A(0,a$v,"duration",function(){return 0}),a$k}(),a$Qt=function(a$t){function a$k(){a$k.__super.call(this)}a$w(a$k,"laya.media.Sound",a$W);var a$v=a$k.prototype;return a$v.load=function(a$t){},a$v.play=function(a$t,a$k,a$v){return void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),null},a$v.dispose=function(){},a$A(0,a$v,"duration",function(){return 0}),a$k}(),a$ut=function(a$t){function a$Q(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,a$Q.__super.call(this)}a$w(a$Q,"laya.media.webaudio.WebAudioSound",a$W);var a$k=a$Q.prototype;return a$k.load=function(a$t){this.url=a$t,this.audioBuffer=a$Q._dataCache[a$t],this.audioBuffer?this._loaded(this.audioBuffer):(a$Q.e.on("loaded:"+a$t,this,this._loaded),a$Q.e.on("err:"+a$t,this,this._err),a$Q.__loadingSound[a$t]||(a$Q.__loadingSound[a$t]=!0,a$d.loader.load(a$t,a$o.create(this,this.onloaded),null,a$Vt.BUFFER,4,!1,null,!0)))},a$k.onloaded=function(a$t){a$t||this._err(),this._disposed?this._removeLoadEvents():(this.data=a$t,a$Q.buffs.push({buffer:this.data,url:this.url}),a$Q.decode())},a$k._err=function(){if(this._removeLoadEvents(),a$Q.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var a$t,a$k,a$v,a$j=0;for(a$t=(a$k=this.__toPlays).length,a$j=0;a$j<a$t;a$j++)(a$v=a$k[a$j])[3]&&!a$v[3].isStopped&&a$v[3].event("error");this.__toPlays.length=0}},a$k._loaded=function(a$t){this._removeLoadEvents(),this._disposed||(this.audioBuffer=a$t,this.loaded=!0,this.event("complete"))},a$k._removeLoadEvents=function(){a$Q.e.off("loaded:"+this.url,this,this._loaded),a$Q.e.off("err:"+this.url,this,this._err)},a$k.__playAfterLoaded=function(){if(this.__toPlays){var a$t,a$k,a$v,a$j=0;for(a$t=(a$k=this.__toPlays).length,a$j=0;a$j<a$t;a$j++)(a$v=a$k[a$j])[3]&&!a$v[3].isStopped&&this.play(a$v[0],a$v[1],a$v[2],a$v[3]);this.__toPlays.length=0}},a$k.play=function(a$t,a$k,a$v,a$j){return void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),a$j=a$j||new a$Et,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([a$t,a$k,a$v,a$j]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),a$j.url=this.url,a$j.loops=a$k,a$j.audioBuffer=this.audioBuffer,a$j.startTime=a$t,a$j.startHandler=a$v,a$j.play(!1),a$U.addChannel(a$j),a$j},a$k.dispose=function(){this._disposed=!0,delete a$Q._dataCache[this.url],delete a$Q.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},a$A(0,a$k,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),a$Q.decode=function(){if(!(a$Q.buffs.length<=0||a$Q.isDecoding))if(a$Q.isDecoding=!0,(a$Q.tInfo=a$Q.buffs.shift())&&a$Q.tInfo.buffer&&a$Q.tInfo.buffer.byteLength)try{a$Q.ctx.decodeAudioData(a$Q.tInfo.buffer,a$Q._done,a$Q._fail)}catch(a$t){console.error("decodeAudioData error  byteLength:"+a$Q.tInfo.buffer.byteLength+"  url:"+a$Q.tInfo.url)}else a$Q._fail()},a$Q._done=function(a$t){a$Q.e.event("loaded:"+a$Q.tInfo.url,a$t),a$Q._dataCache[a$Q.tInfo.url]=a$t,a$Q.isDecoding=!1,a$Q.decode()},a$Q._fail=function(){a$Q.e.event("err:"+a$Q.tInfo.url,null),a$Q.isDecoding=!1,a$Q.decode()},a$Q._playEmptySound=function(){if(null!=a$Q.ctx){if(a$Q._emptySource&&(a$Q._emptySource.stop(),a$Q._emptySource.disconnect(0),!a$Et._tryCleanFailed))try{a$Q._emptySource.buffer=null}catch(a$t){a$Et._tryCleanFailed=!0}var a$t=a$Q.ctx.createBufferSource();a$t.buffer=a$Q._miniBuffer,a$t.connect(a$Q.ctx.destination),a$t.start(0,0,0),a$Q._emptySource=a$t}},a$Q._unlock=function(){a$Q._unlocked||(a$Q._playEmptySound(),"running"==a$Q.ctx.state?(a$_.document.removeEventListener("mousedown",a$Q._unlock,!0),a$_.document.removeEventListener("touchend",a$Q._unlock,!0),a$_.document.removeEventListener("touchstart",a$Q._unlock,!0),a$Q._unlocked=!0):"suspended"==a$Q.ctx.state&&a$U._recoverWebAudio())},a$Q.initWebAudio=function(){"running"!=a$Q.ctx.state&&(a$Q._unlock(),a$_.document.addEventListener("mousedown",a$Q._unlock,!0),a$_.document.addEventListener("touchend",a$Q._unlock,!0),a$_.document.addEventListener("touchstart",a$Q._unlock,!0))},a$Q._emptySource=null,a$Q._dataCache={},a$Q.buffs=[],a$Q.isDecoding=!1,a$Q._unlocked=!1,a$Q.tInfo=null,a$Q.__loadingSound={},a$J(a$Q,["window",function(){return this.window=a$_.window},"webAudioEnabled",function(){return this.webAudioEnabled=a$Q.window.AudioContext||a$Q.window.webkitAudioContext||a$Q.window.mozAudioContext},"ctx",function(){return this.ctx=a$Q.webAudioEnabled?new(a$Q.window.AudioContext||a$Q.window.webkitAudioContext||a$Q.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=a$Q.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new a$W}]),a$Q}(),a$St=function(a$t){function a$k(){this._responseType=null,this._data=null,a$k.__super.call(this),this._http=new a$_.window.XMLHttpRequest}a$w(a$k,"laya.net.HttpRequest",a$W);var a$v=a$k.prototype;return a$v.send=function(a$t,a$k,a$v,a$j,a$Q){void 0===a$v&&(a$v="get"),void 0===a$j&&(a$j="text"),this._responseType=a$j,this._data=null;var a$u=this,a$S=this._http;if(a$S.open(a$v,a$t,!0),a$Q)for(var a$V=0;a$V<a$Q.length;a$V++)a$S.setRequestHeader(a$Q[a$V++],a$Q[a$V]);else a$c.isConchApp||(a$k&&"string"!=typeof a$k?a$S.setRequestHeader("Content-Type","application/json"):a$S.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));a$S.responseType="arraybuffer"!==a$j?"text":"arraybuffer",a$S.onerror=function(a$t){a$u._onError(a$t)},a$S.onabort=function(a$t){a$u._onAbort(a$t)},a$S.onprogress=function(a$t){a$u._onProgress(a$t)},a$S.onload=function(a$t){a$u._onLoad(a$t)},a$S.send(a$k)},a$v._onProgress=function(a$t){a$t&&a$t.lengthComputable&&this.event("progress",a$t.loaded/a$t.total)},a$v._onAbort=function(a$t){this.error("Request was aborted by user")},a$v._onError=function(a$t){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},a$v._onLoad=function(a$t){var a$k=this._http,a$v=void 0!==a$k.status?a$k.status:200;200===a$v||204===a$v||0===a$v?this.complete():this.error("["+a$k.status+"]"+a$k.statusText+":"+a$k.responseURL)},a$v.error=function(a$t){this.clear(),this.event("error",a$t)},a$v.complete=function(){this.clear();var a$k=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=a$g.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(a$t){a$k=!1,this.error(a$t.message)}a$k&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},a$v.clear=function(){var a$t=this._http;a$t.onerror=a$t.onabort=a$t.onprogress=a$t.onload=null},a$A(0,a$v,"url",function(){return this._http.responseURL}),a$A(0,a$v,"http",function(){return this._http}),a$A(0,a$v,"data",function(){return this._data}),a$k}(),a$Vt=function(a$t){function a$s(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,a$s.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}a$w(a$s,"laya.net.Loader",a$W);var a$k=a$s.prototype;return a$k.load=function(a$t,a$k,a$v,a$j,a$Q){if(a$t&&""!=a$t||console.error("Loader 加载的url不合法 "+a$t),void 0===a$v&&(a$v=!0),void 0===a$Q&&(a$Q=!1),0===(this._url=a$t).indexOf("data:image")?this._type=a$k="image":this._type=a$k||(a$k=this.getTypeFromUrl(a$t)),this._cache=a$v,this._data=null,!a$Q&&a$s.loadedMap[a$t])return this._data=a$s.loadedMap[a$t],this.event("progress",1),void this.event("complete",this._data);if(a$j&&a$s.setGroup(a$t,a$j),null!=a$s.parserMap[a$k])return this._customParse=!0,void(a$s.parserMap[a$k]instanceof laya.utils.Handler?a$s.parserMap[a$k].runWith(this):a$s.parserMap[a$k].call(null,this));if("image"===a$k||"htmlimage"===a$k||"nativeimage"===a$k)return this._loadImage(a$t);if("ttf"===a$k)return this._loadTTF(a$t);switch(a$k){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:a$k}a$s.preLoadedMap[a$t]?this.onLoaded(a$s.preLoadedMap[a$t]):a$S.resMgrLoad(a$t,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},a$k.getTypeFromUrl=function(a$t){var a$k=a$g.getFileExtension(a$t);return a$k?a$s.typeMap[a$k]:(console.warn("Not recognize the resources suffix",a$t),"text")},a$k._loadTTF=function(a$t){a$t=a$G.formatURL(a$t);var a$k=new a$z;a$k.complete=a$o.create(this,this.onLoaded),a$k.load(a$t)},a$k._loadImage=function(a$t){a$S.imgMgrLoad(a$t,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},a$k._loadImageComplete=function(a$t,a$k,a$v){if(null!=a$v)if(a$v instanceof ArrayBuffer){var a$j=new DataView(a$v),a$Q=new laya.webgl.resource.WebGLImage(new Uint8Array(a$v,8),a$t,0,!1,a$j.getUint32(0),a$j.getUint32(4));this.onLoaded(a$Q)}else if(a$v instanceof a$wt)a$s.imgMgrSet[a$t]=a$k,a$S.imgMgrLock(a$t,a$s.imgMgrSet[a$t]),this._url=a$t,this.complete(a$v);else{var a$u=-1!=a$t.indexOf(".png",a$t.length-4)?6408:6407;a$Q=new laya.webgl.resource.WebGLImage(a$v,a$t,a$u,!1,a$v.width,a$v.height);this.onLoaded(a$Q)}else this.event("error","Load image failed")},a$k._loadSound=function(a$t){var a$k=new a$U._soundClass,a$v=this;function a$j(){a$k.offAll()}a$k.on("complete",this,function(){a$j(),a$v.onLoaded(a$k)}),a$k.on("error",this,function(){a$j(),a$k.dispose(),a$v.event("error","Load sound failed")}),a$k.load(a$t)},a$k.onProgress=function(a$t){"atlas"===this._type?this.event("progress",.3*a$t):this.event("progress",a$t)},a$k.onError=function(a$t){this.event("error",a$t)},a$k._loadedComplete=function(a$t,a$k,a$v){if(null!=a$v)switch(this._type){case"atlas":case"plf":case"json":var a$j=new a$x(a$v);this.onLoaded(JSON.parse(a$j.readUTFBytes()));break;case"font":a$j=new a$x(a$v);this.onLoaded(a$g.parseXMLFromString(a$j.readUTFBytes()));break;default:this.onLoaded(a$v)}else this.event("error",a$t)},a$k.onLoaded=function(a$t){var a$k=this._type;if("plf"==a$k)this.parsePLFData(a$t),this.complete(a$t);else if("image"===a$k){var a$v=new a$wt(a$t);a$v.url=this._url,this.complete(a$v)}else if("sound"===a$k||"htmlimage"===a$k||"nativeimage"===a$k)this.complete(a$t);else if("atlas"===a$k){if(!a$t.src&&!a$t._setContext){if(!this._data){if((this._data=a$t).meta&&a$t.meta.image)for(var a$j=a$t.meta.image.split(","),a$Q=0<=this._url.indexOf("/")?"/":"\\",a$u=this._url.lastIndexOf(a$Q),a$S=0<=a$u?this._url.substr(0,a$u+1):"",a$V=0,a$J=a$j.length;a$V<a$J;a$V++)a$j[a$V]=a$S+a$j[a$V];else a$j=[this._url.replace(".json",".png")];a$j.reverse(),a$t.toLoads=a$j,a$t.pics=[]}return this.event("progress",.3+1/a$j.length*.6),this._loadImage(a$j.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(a$t),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var a$W=this._data.frames,a$w=this._url.split("?")[0],a$M=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:a$w.substring(0,a$w.lastIndexOf("."))+"/",a$H=this._data.pics,a$E=a$G.formatURL(this._url),a$A=a$s.atlasMap[a$E]||(a$s.atlasMap[a$E]=[]);a$A.dir=a$M;var a$R=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var a$h in a$R=parseFloat(this._data.meta.scale),a$W){var a$l,a$o=a$W[a$h],a$Y=a$H[a$o.frame.idx?a$o.frame.idx:0],a$f=a$G.formatURL(a$M+a$h);a$Y.scaleRate=a$R,a$l=a$wt.create(a$Y,a$o.frame.x,a$o.frame.y,a$o.frame.w,a$o.frame.h,a$o.spriteSourceSize.x,a$o.spriteSourceSize.y,a$o.sourceSize.w,a$o.sourceSize.h),a$s.cacheRes(a$f,a$l),a$s.keepCache(this._url,a$M+a$h),a$l.url=a$f,a$A.push(a$f)}else for(a$h in a$W)a$Y=a$H[(a$o=a$W[a$h]).frame.idx?a$o.frame.idx:0],a$f=a$G.formatURL(a$M+a$h),a$s.cacheRes(a$f,a$wt.create(a$Y,a$o.frame.x,a$o.frame.y,a$o.frame.w,a$o.frame.h,a$o.spriteSourceSize.x,a$o.spriteSourceSize.y,a$o.sourceSize.w,a$o.sourceSize.h)),a$s.loadedMap[a$f].url=a$f,a$s.keepCache(this._url,a$M+a$h),a$A.push(a$f);delete this._data.pics,this.complete(this._data)}else if("font"==a$k){if(!a$t.src)return this._data=a$t,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var a$X=new a$K;a$X.parseFont(this._data,a$t);var a$F=this._url.split(".fnt")[0].split("/"),a$d=a$F[a$F.length-1];a$ht.registerBitmapFont(a$d,a$X),this._data=a$X,this.complete(this._data)}else if("pkm"==a$k){var a$m=a$Ft.create(a$t,this._url),a$Z=new a$wt(a$m);a$Z.url=this._url,this.complete(a$Z)}else this.complete(a$t)},a$k.parsePLFData=function(a$t){var a$k,a$v,a$j;for(a$k in a$t)switch(a$j=a$t[a$k],a$k){case"json":case"text":for(a$v in a$j)a$s.preLoadedMap[a$G.formatURL(a$v)]=a$j[a$v];break;default:for(a$v in a$j)a$s.preLoadedMap[a$G.formatURL(a$v)]=a$j[a$v]}},a$k.complete=function(a$t){this._data=a$t,this._customParse?this.event("loaded",a$t instanceof Array?[a$t]:a$t):(a$s._loaders.push(this),a$s._isWorking||a$s.checkNext())},a$k.endLoad=function(a$t){a$t&&(this._data=a$t),this._cache&&a$s.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},a$A(0,a$k,"url",function(){return this._url}),a$A(0,a$k,"data",function(){return this._data}),a$A(0,a$k,"cache",function(){return this._cache}),a$A(0,a$k,"type",function(){return this._type}),a$s.checkNext=function(){a$s._isWorking=!0;for(var a$t=a$_.now();a$s._startIndex<a$s._loaders.length;)if(a$_.now(),a$s._loaders[a$s._startIndex].endLoad(),a$s._startIndex++,a$_.now()-a$t>a$s.maxTimeOut)return console.warn("loader callback cost a long time:"+(a$_.now()-a$t)+" url="+a$s._loaders[a$s._startIndex-1].url),void a$d.timer.frameOnce(1,null,a$s.checkNext);a$s._loaders.length=0,a$s._startIndex=0,a$s._isWorking=!1},a$s.clearRes=function(a$t,a$k){if(null!=a$t){void 0===a$k&&(a$k=!1),a$t=a$G.formatURL(a$t);var a$v=a$s.getAtlas(a$t);if(a$v){for(var a$j=0,a$Q=a$v.length;a$j<a$Q;a$j++){var a$u=a$v[a$j],a$S=a$s.getRes(a$u);delete a$s.loadedMap[a$u],a$s.clearCache(a$t.substring(a$G.basePath.length),a$u.substring(a$G.basePath.length)),a$S&&a$S.destroy(a$k)}a$v.length=0,delete a$s.atlasMap[a$t],delete a$s.loadedMap[a$t]}else{var a$V=a$s.loadedMap[a$t];a$V&&(delete a$s.loadedMap[a$t],a$V instanceof laya.resource.Texture&&a$V.bitmap&&a$V.destroy(a$k))}}},a$s.clearTextureRes=function(a$t){a$t=a$G.formatURL(a$t);var a$k=laya.net.Loader.getAtlas(a$t),a$v=a$k&&0<a$k.length?laya.net.Loader.getRes(a$k[0]):laya.net.Loader.getRes(a$t);a$v&&a$v.bitmap&&(a$c.isConchApp&&!a$c.isConchWebGL?a$v.bitmap.source.releaseTexture&&a$v.bitmap.source.releaseTexture():null==a$v.bitmap._atlaser&&a$v.bitmap.releaseResource(!0))},a$s.getRes=function(a$t){return a$s.loadedMap[a$G.formatURL(a$t)]},a$s.getAtlas=function(a$t){return a$s.atlasMap[a$G.formatURL(a$t)]},a$s.cacheRes=function(a$t,a$k){a$t=a$G.formatURL(a$t),null!=a$s.loadedMap[a$t]?console.warn("Resources already exist,is repeated loading:",a$t):a$s.loadedMap[a$t]=a$k},a$s.setGroup=function(a$t,a$k){a$s.groupMap[a$k]||(a$s.groupMap[a$k]=[]),a$s.groupMap[a$k].push(a$t)},a$s.clearResByGroup=function(a$t){if(a$s.groupMap[a$t]){var a$k=a$s.groupMap[a$t],a$v=0,a$j=a$k.length;for(a$v=0;a$v<a$j;a$v++)a$s.clearRes(a$k[a$v]);a$k.length=0}},a$s.keepCache=function(a$t,a$k){if(a$t&&a$k){var a$v=a$s.cacheSet[a$k];a$v?-1==a$v.indexOf(a$t)&&a$v.push(a$t):a$s.cacheSet[a$k]=[a$t]}},a$s.clearCache=function(a$t,a$k){if(a$t&&a$k){var a$v=a$s.cacheSet[a$k];if(a$v){var a$j=a$v.indexOf(a$t);if(-1!==a$j){var a$Q=a$v.length-1;0==a$Q?(delete a$s.cacheSet[a$k],0<a$s.imgMgrSet[a$k]?a$S.imgMgrFree(a$k,a$s.imgMgrSet[a$k]):a$s.clearRes(a$k,!0)):(a$v[a$j]=a$v[a$Q],a$v.length=a$Q)}}}},a$s.saveObject=function(a$t,a$k,a$v){if(a$k&&a$t){var a$j=a$s.objectSet[a$t];a$j?(console.warn("Loader.saveObject: "+a$t),a$j[0]=a$k,a$j[1]=a$v):a$s.objectSet[a$t]=[a$k,a$v,[]]}},a$s.findObject=function(a$t){if(a$t){var a$k=a$s.objectSet[a$t];if(a$k)return a$k[0]}return null},a$s.keepObject=function(a$t,a$k){if(a$t&&a$k){var a$v=a$s.objectSet[a$k];a$v&&-1===a$v[2].indexOf(a$t)&&a$v[2].push(a$t)}},a$s.clearObject=function(a$t,a$k){if(a$t&&a$k){var a$v=a$s.objectSet[a$k];if(a$v){var a$j=a$v[2],a$Q=a$j.indexOf(a$t);if(-1!==a$Q){var a$u=a$j.length-1;0==a$u?(delete a$s.objectSet[a$k],a$v[1]&&a$v[1].call(null,a$v[0])):(a$j[a$Q]=a$j[a$u],a$j.length=a$u)}}}},a$s.TEXT="text",a$s.JSON="json",a$s.XML="xml",a$s.BUFFER="arraybuffer",a$s.IMAGE="image",a$s.SOUND="sound",a$s.ATLAS="atlas",a$s.FONT="font",a$s.TTF="ttf",a$s.PLF="plf",a$s.PKM="pkm",a$s.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},a$s.parserMap={},a$s.groupMap={},a$s.maxTimeOut=100,a$s.loadedMap={},a$s.preLoadedMap={},a$s.atlasMap={},a$s._loaders=[],a$s._isWorking=!1,a$s._startIndex=0,a$s.imgCache={},a$s.cacheSet={},a$s.objectSet={},a$s.imgMgrSet={},a$s}(),a$Jt=function(a$t){var a$H;function a$E(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},a$E.__super.call(this);for(var a$t=0;a$t<this._maxPriority;a$t++)this._resInfos[a$t]=[]}a$w(a$E,"laya.net.LoaderManager",a$W);var a$k=a$E.prototype;return a$k.create=function(a$t,a$v,a$k,a$j,a$Q,a$u,a$S,a$V){if(null==a$u&&(a$u=2),null==a$S&&(a$S=!0),a$t instanceof Array){var a$J=a$t,a$W=a$J.length,a$w=0;if(a$k)var a$M=a$o.create(a$k.caller,a$k.method,a$k.args,!1);for(var a$H=0;a$H<a$W;a$H++){var a$E=a$J[a$H];"string"==typeof a$E&&(a$E=a$J[a$H]={url:a$E}),a$E.progress=0}for(a$H=0;a$H<a$W;a$H++){a$E=a$J[a$H];var a$A=a$k?a$o.create(null,a$l,[a$E],!1):null,a$R=a$k||a$v?a$o.create(null,a$h,[a$E]):null;this._create(a$E.url,a$R,a$A,a$E.clas||a$j,a$E.params||a$Q,null!=a$E.priority&&0<=a$E.priority?a$E.priority:a$u,a$S,a$E.group||a$V)}function a$h(a$t,a$k){a$w++,a$t.progress=1,a$w===a$W&&a$v&&a$v.run()}function a$l(a$t,a$k){a$t.progress=a$k;for(var a$v=0,a$j=0;a$j<a$W;a$j++){a$v+=a$J[a$j].progress}var a$Q=a$v/a$W;a$M.runWith(a$Q)}return!0}return this._create(a$t,a$v,a$k,a$j,a$Q,a$u,a$S,a$V)},a$k._create=function(a$k,a$v,a$t,a$j,a$Q,a$u,a$S,a$V){a$k&&""!=a$k||console.error("加载的url不合法 "+a$k),null==a$u&&(a$u=2),null==a$S&&(a$S=!0);var a$J=a$G.formatURL(a$k),a$W=this.getRes(a$J);if(a$W)!a$W.hasOwnProperty("loaded")||a$W.loaded?(a$t&&a$t.runWith(1),a$v&&a$v.run()):a$v&&a$d.loader._createListener(a$k,a$v.caller,a$v.method,a$v.args,!0,!1);else{var a$w=a$g.getFileExtension(a$k),a$M=a$E.createMap[a$w];if(!a$M)throw new Error("LoaderManager:unknown file("+a$k+") extension with: "+a$w+".");a$j||(a$j=a$M[0]);var a$H=a$M[1];if("atlas"==a$w)this.load(a$k,a$v,a$t,a$H,a$u,a$S);else{a$j===a$wt&&(a$H="htmlimage"),(a$W=a$j?new a$j:null).hasOwnProperty("_loaded")&&(a$W._loaded=!1),a$W._setUrl(a$k),a$V&&a$W._setGroup(a$V),this._createLoad(a$W,a$k,a$o.create(null,function(a$t){a$W&&!a$W.destroyed&&a$t&&a$W.onAsynLoaded.call(a$W,a$k,a$t,a$Q),a$v&&a$v.run();a$d.loader.event(a$k)}),a$t,a$H,a$u,!1,a$V,!0),a$S&&this.cacheRes(a$J,a$W)}}return a$W},a$k.load=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){a$t&&""!=a$t||console.error("加载的url不合法 "+a$t);var a$J=this;if(null==a$Q&&(a$Q=2),null==a$u&&(a$u=!0),void 0===a$V&&(a$V=!1),a$t instanceof Array)return this._loadAssets(a$t,a$k,a$v,a$j,a$Q,a$u,a$S);var a$W=a$Vt.getRes(a$t);if(null!=a$W)a$d.timer.frameOnce(1,null,function(){a$v&&a$v.runWith(1),a$k&&a$k.runWith(a$W),a$J._loaderCount||a$J.event("complete")});else{var a$w=a$E._resMap[a$t];a$w?(a$k&&a$w._createListener("complete",a$k.caller,a$k.method,a$k.args,!1,!1),a$v&&a$w._createListener("progress",a$v.caller,a$v.method,a$v.args,!1,!1)):((a$w=this._infoPool.length?this._infoPool.pop():new a$H).url=a$t,a$w.type=a$j,a$w.cache=a$u,a$w.group=a$S,a$w.ignoreCache=a$V,a$w.priority=a$Q,a$k&&a$w.on("complete",a$k.caller,a$k.method,a$k.args),a$v&&a$w.on("progress",a$v.caller,a$v.method,a$v.args),a$E._resMap[a$t]=a$w,a$Q=a$Q<this._maxPriority?0<=a$Q?a$Q:0:this._maxPriority-1,this._resInfos[a$Q].push(a$w),this._next())}return this},a$k._createLoad=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){var a$W=this;if(null==a$u&&(a$u=2),null==a$S&&(a$S=!0),void 0===a$J&&(a$J=!1),a$k instanceof Array)return this._loadAssets(a$k,a$v,a$j,a$Q,a$u,a$S,a$V);var a$w=a$Vt.getRes(a$k);if(null!=a$w)a$d.timer.frameOnce(1,null,function(){a$j&&a$j.runWith(1),a$v&&a$v.runWith(a$w),a$W._loaderCount||a$W.event("complete")});else{var a$M=a$E._resMap[a$k];a$M?(a$v&&a$M._createListener("complete",a$v.caller,a$v.method,a$v.args,!1,!1),a$j&&a$M._createListener("progress",a$j.caller,a$j.method,a$j.args,!1,!1)):((a$M=this._infoPool.length?this._infoPool.pop():new a$H).url=a$k,a$M.clas=a$t,a$M.type=a$Q,a$M.cache=a$S,a$M.group=a$V,a$M.ignoreCache=a$J,a$M.priority=a$u,a$v&&a$M.on("complete",a$v.caller,a$v.method,a$v.args),a$j&&a$M.on("progress",a$j.caller,a$j.method,a$j.args),a$E._resMap[a$k]=a$M,a$u=a$u<this._maxPriority?0<=a$u?a$u:0:this._maxPriority-1,this._resInfos[a$u].push(a$M),this._next())}return this},a$k._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var a$t=0;a$t<this._maxPriority;a$t++)for(var a$k=this._resInfos[a$t];0<a$k.length;){var a$v=a$k.shift();if(a$v)return this._doLoad(a$v)}this._loaderCount||this.event("complete")}},a$k._doLoad=function(a$k){this._loaderCount++;var a$v=this._loaders.length?this._loaders.pop():new a$Vt;a$v.on("complete",null,a$Q),a$v.on("progress",null,function(a$t){a$k.event("progress",a$t)}),a$v.on("error",null,function(a$t){a$Q(null)});var a$j=this;function a$Q(a$t){a$v.offAll(),a$v._data=null,a$v._customParse=!1,a$j._loaders.push(a$v),a$j._endLoad(a$k,a$t instanceof Array?[a$t]:a$t),a$j._loaderCount--,a$j._next()}a$v._class=a$k.clas,1<=a$k.priority?(a$v.priority=a$k.priority,a$v.realTime=!1):(a$v.priority=0,a$v.realTime=!0),a$v.load(a$k.url,a$k.type,a$k.cache,a$k.group,a$k.ignoreCache)},a$k._endLoad=function(a$t,a$k){var a$v=a$t.url;if(null==a$k){var a$j=this._failRes[a$v]||0;if(a$j<this.retryNum)return console.warn("[warn]Retry to load:",a$v),this._failRes[a$v]=a$j+1,void a$d.timer.once(this.retryDelay,this,this._addReTry,[a$t],!1);console.warn("[error]Failed to load:",a$v),this.event("error",a$v)}this._failRes[a$v]&&(this._failRes[a$v]=0),delete a$E._resMap[a$v],a$t.event("complete",a$k),a$t.offAll(),this._infoPool.push(a$t)},a$k._addReTry=function(a$t){this._resInfos[this._maxPriority-1].push(a$t),this._next()},a$k.clearRes=function(a$t,a$k){void 0===a$k&&(a$k=!1),a$Vt.clearRes(a$t,a$k)},a$k.getRes=function(a$t){return a$Vt.getRes(a$t)},a$k.cacheRes=function(a$t,a$k){a$Vt.cacheRes(a$t,a$k)},a$k.clearTextureRes=function(a$t){a$Vt.clearTextureRes(a$t)},a$k.setGroup=function(a$t,a$k){a$Vt.setGroup(a$t,a$k)},a$k.clearResByGroup=function(a$t){a$Vt.clearResByGroup(a$t)},a$k.clearUnLoaded=function(){for(var a$t=0;a$t<this._maxPriority;a$t++){for(var a$k=this._resInfos[a$t],a$v=a$k.length-1;-1<a$v;a$v--){var a$j=a$k[a$v];a$j&&(a$j.offAll(),this._infoPool.push(a$j))}a$k.length=0}this._loaderCount=0,a$E._resMap={}},a$k.cancelLoadByUrls=function(a$t){if(a$t)for(var a$k=0,a$v=a$t.length;a$k<a$v;a$k++)this.cancelLoadByUrl(a$t[a$k])},a$k.cancelLoadByUrl=function(a$t){for(var a$k=0;a$k<this._maxPriority;a$k++)for(var a$v=this._resInfos[a$k],a$j=a$v.length-1;-1<a$j;a$j--){var a$Q=a$v[a$j];a$Q&&a$Q.url===a$t&&(a$v[a$j]=null,a$Q.offAll(),this._infoPool.push(a$Q))}a$E._resMap[a$t]&&delete a$E._resMap[a$t]},a$k._loadAssets=function(a$t,a$v,a$S,a$k,a$j,a$Q,a$u){null==a$j&&(a$j=2),null==a$Q&&(a$Q=!0);for(var a$V=a$t.length,a$J=0,a$W=0,a$w=[],a$M=!0,a$H=0;a$H<a$V;a$H++){var a$E=a$t[a$H];if(!a$E)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+a$t);"string"==typeof a$E&&(a$E={url:a$E,type:a$k,size:1,priority:a$j}),a$E.size||(a$E.size=1),a$E.progress=0,a$W+=a$E.size,a$w.push(a$E);var a$A=a$S?a$o.create(null,a$l,[a$E],!1):null,a$R=a$v||a$S?a$o.create(null,a$h,[a$E]):null;this.load(a$E.url,a$R,a$A,a$E.type,null!=a$E.priority&&0<=a$E.priority?a$E.priority:2,a$Q,a$E.group||a$u)}function a$h(a$t,a$k){a$J++,a$t.progress=1,a$k||(a$M=!1),a$J===a$V&&a$v&&a$v.runWith(a$M)}function a$l(a$t,a$k){if(null!=a$S){a$t.progress=a$k;for(var a$v=0,a$j=0;a$j<a$w.length;a$j++){var a$Q=a$w[a$j];a$v+=a$Q.size*a$Q.progress}var a$u=a$v/a$W;a$S.runWith(a$u)}}return this},a$E.cacheRes=function(a$t,a$k){a$Vt.cacheRes(a$t,a$k)},a$E._resMap={},a$J(a$E,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),a$E.__init$=function(){a$H=function(a$t){function a$k(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,a$k.__super.call(this)}return a$w(a$k,"",a$W),a$k}()},a$E}(),a$Wt=(function(a$t){function a$Q(a$t){a$Q.__super.call(this),a$t||(a$t=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var a$k=0,a$v=0,a$j=0;a$j<20;a$j++)a$j%5!=4?this._mat[a$k++]=a$t[a$j]:this._alpha[a$v++]=a$t[a$j];this._action=a$N.createFilterAction(32),this._action.data=this}a$w(a$Q,"laya.filters.ColorFilter",a$l);var a$k=a$Q.prototype;a$d.imps(a$k,{"laya.filters.IFilter":!0}),a$k.callNative=function(a$t){a$t._$P.cf=this;a$t.conchModel&&a$t.conchModel.setFilterMatrix&&a$t.conchModel.setFilterMatrix(this._mat,this._alpha)},a$A(0,a$k,"type",function(){return 32}),a$A(0,a$k,"action",function(){return this._action})}(),function(a$t){function a$j(a$t,a$k,a$v){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===a$k&&(a$k=0),a$j.__super.call(this),this._byteClass=a$v||a$x,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,a$t&&0<a$k&&a$k<65535&&this.connect(a$t,a$k)}a$w(a$j,"laya.net.Socket",a$W);var a$k=a$j.prototype;a$k.connect=function(a$t,a$k){var a$v="ws://"+a$t+":"+a$k;a$v="https:"==a$_.window.location.protocol?"wss://"+a$t+":"+a$k:"ws://"+a$t+":"+a$k,this.connectByUrl(a$v)},a$k.connectByUrl=function(a$t){var a$k=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new a$_.window.WebSocket(a$t,this.protocols):this._socket=new a$_.window.WebSocket(a$t),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(a$t){a$k._onOpen(a$t)},this._socket.onmessage=function(a$t){a$k._onMessage(a$t)},this._socket.onclose=function(a$t){a$k._onClose(a$t)},this._socket.onerror=function(a$t){a$k._onError(a$t)}},a$k.cleanSocket=function(){try{this._socket.close()}catch(a$t){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},a$k.close=function(){if(null!=this._socket)try{this._socket.close()}catch(a$t){}},a$k._onOpen=function(a$t){this._connected=!0,this.event("open",a$t)},a$k._onMessage=function(a$t){if(a$t&&a$t.data){var a$k=a$t.data;if(this.disableInput&&a$k)this.event("message",a$k);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var a$v=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,a$k&&("string"==typeof a$k?this._input.writeUTFBytes(a$k):this._input.writeArrayBuffer(a$k),this._addInputPosition=this._input.pos,this._input.pos=a$v),this.event("message",a$k)}}},a$k._onClose=function(a$t){this._connected=!1,this.event("close",a$t)},a$k._onError=function(a$t){this.event("error",a$t)},a$k.send=function(a$t){this._socket.send(a$t)},a$k.flush=function(){if(this._output&&0<this._output.length){var a$k;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(a$t){a$k=a$t}this._output.endian=this.endian,this._output.clear(),a$k&&this.event("error",a$k)}},a$A(0,a$k,"input",function(){return this._input}),a$A(0,a$k,"output",function(){return this._output}),a$A(0,a$k,"connected",function(){return this._connected}),a$A(0,a$k,"endian",function(){return this._endian},function(a$t){this._endian=a$t,null!=this._input&&(this._input.endian=a$t),null!=this._output&&(this._output.endian=a$t)}),a$j.LITTLE_ENDIAN="littleEndian",a$j.BIG_ENDIAN="bigEndian"}(),function(a$t){function a$V(){a$V.__super.call(this),this._$1__id=++a$V._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(a$V._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,a$n.currentResourceManager&&a$n.currentResourceManager.addResource(this)}a$w(a$V,"laya.resource.Resource",a$W);var a$k=a$V.prototype;return a$d.imps(a$k,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),a$k._setUrl=function(a$t){var a$k;this._url!==a$t&&(this._url&&((a$k=a$V._urlResourcesMap[this._url]).splice(a$k.indexOf(this),1),0===a$k.length&&delete a$V._urlResourcesMap[this._url]),a$t&&((a$k=a$V._urlResourcesMap[a$t])||(a$V._urlResourcesMap[a$t]=a$k=[]),a$k.push(this)),this._url=a$t)},a$k._getGroup=function(){return this._group},a$k._setGroup=function(a$t){var a$k;this._group!==a$t&&(this._group&&((a$k=a$V._groupResourcesMap[this._group]).splice(a$k.indexOf(this),1),0===a$k.length&&delete a$V._groupResourcesMap[this._group]),a$t&&((a$k=a$V._groupResourcesMap[a$t])||(a$V._groupResourcesMap[a$t]=a$k=[]),a$k.push(this)),this._group=a$t)},a$k._addReference=function(){this._referenceCount++},a$k._removeReference=function(){this._referenceCount--},a$k._clearReference=function(){this._referenceCount=0},a$k._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},a$k.recreateResource=function(){this.completeCreate()},a$k.disposeResource=function(){},a$k.activeResource=function(a$t){void 0===a$t&&(a$t=!1),this._lastUseFrameCount=a$L.loopCount,!this._destroyed&&this.__loaded&&(this._released||a$t)&&this.recreateResource()},a$k.releaseResource=function(a$t){return void 0===a$t&&(a$t=!0),!(!a$t&&this.lock)&&(!(this._released&&!a$t)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},a$k.onAsynLoaded=function(a$t,a$k,a$v){throw new Error("Resource: must override this function!")},a$k.destroy=function(){var a$t;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete a$V._idResourcesMap[this.id],this._url&&((a$t=a$V._urlResourcesMap[this._url])&&(a$t.splice(a$t.indexOf(this),1),0===a$t.length&&delete a$V._urlResourcesMap[this.url]),a$Vt.clearRes(this._url),this.__loaded||a$N.cancelLoadByUrl(this._url)),this._group&&((a$t=a$V._groupResourcesMap[this._group]).splice(a$t.indexOf(this),1),0===a$t.length&&delete a$V._groupResourcesMap[this.url]))},a$k.completeCreate=function(){this._released=!1,this.event("recovered",this)},a$k.dispose=function(){this.destroy()},a$A(0,a$k,"memorySize",function(){return this._memorySize},function(a$t){var a$k=a$t-this._memorySize;this._memorySize=a$t,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,a$k),this.resourceManager&&this.resourceManager.addSize(a$k)}),a$A(0,a$k,"_loaded",null,function(a$t){this.__loaded=a$t}),a$A(0,a$k,"loaded",function(){return this.__loaded}),a$A(0,a$k,"id",function(){return this._$1__id}),a$A(0,a$k,"destroyed",function(){return this._destroyed}),a$A(0,a$k,"group",function(){return this._getGroup()},function(a$t){this._setGroup(a$t)}),a$A(0,a$k,"resourceManager",function(){return this._resourceManager}),a$A(0,a$k,"url",function(){return this._url}),a$A(0,a$k,"released",function(){return this._released}),a$A(0,a$k,"referenceCount",function(){return this._referenceCount}),a$V.getResourceByID=function(a$t){return a$V._idResourcesMap[a$t]},a$V.getResourceByURL=function(a$t,a$k){return void 0===a$k&&(a$k=0),null==a$V._urlResourcesMap[a$t]?null:a$V._urlResourcesMap[a$t][a$k]},a$V.getResourceCountByURL=function(a$t){return a$V._urlResourcesMap[a$t].length},a$V.destroyUnusedResources=function(a$t){var a$k;if(a$t){var a$v=a$V._groupResourcesMap[a$t];if(a$v)for(var a$j=a$v.slice(),a$Q=0,a$u=a$j.length;a$Q<a$u;a$Q++)(a$k=a$j[a$Q]).lock||0!==a$k._referenceCount||a$k.destroy()}else for(var a$S in a$V._idResourcesMap)(a$k=a$V._idResourcesMap[a$S]).lock||0!==a$k._referenceCount||a$k.destroy()},a$V._uniqueIDCounter=0,a$V._idResourcesMap={},a$V._urlResourcesMap={},a$V._groupResourcesMap={},a$V}()),a$wt=function(a$t){function a$s(a$t,a$k){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,a$s.__super.call(this),a$t&&null!=a$t._addReference&&a$t._addReference(),this.setTo(a$t,a$k)}a$w(a$s,"laya.resource.Texture",a$W);var a$k=a$s.prototype;return a$k._setUrl=function(a$t){this.url=a$t},a$k.setTo=function(a$t,a$k){if(a$t instanceof a$S.HTMLElement){var a$v=a$Yt.create("2D",a$t);this.bitmap=a$v}else this.bitmap=a$t;if(this.uv=a$k||a$s.DEF_UV,a$t){this._w=a$t.width,this._h=a$t.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var a$j=this;if(this._loaded)a$N.addToAtlas&&a$N.addToAtlas(a$j);else{var a$Q=a$t;a$Q instanceof laya.resource.HTMLImage&&a$Q.image&&a$Q.image.addEventListener("load",function(a$t){a$N.addToAtlas&&a$N.addToAtlas(a$j)},!1)}}},a$k.active=function(){this.bitmap&&this.bitmap.activeResource()},a$k.destroy=function(a$t){if(void 0===a$t&&(a$t=!1),this.alphaTexture&&(this.alphaTexture.destroy(a$t),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var a$k=this.bitmap;a$t?(a$c.isConchApp&&a$k.source&&a$k.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,a$k.dispose(),a$k._clearReference()):(a$k._removeReference(),0==a$k.referenceCount&&(a$c.isConchApp&&a$k.source&&a$k.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,a$k.dispose())),this.url&&this===a$d.loader.getRes(this.url)&&a$d.loader.clearRes(this.url,a$t),this._loaded=!1}},a$k.load=function(a$t){var a$k=this;this._loaded=!1,a$t=a$G.customFormat(a$t);var a$v=this.bitmap||(this.bitmap=a$Ft.create(a$t));a$v.uri=a$t,a$v&&a$v._addReference();var a$j=this;a$v.onload=function(){a$v.onload=null,a$j._loaded=!0,a$k.sourceWidth=a$k._w=a$v.width,a$k.sourceHeight=a$k._h=a$v.height,a$j.event("loaded",this),a$N.addToAtlas&&a$N.addToAtlas(a$j)}},a$k.addTextureToAtlas=function(a$t){a$N.addTextureToAtlas(this)},a$k.getPixels=function(a$t,a$k,a$v,a$j){if(a$c.isConchApp){var a$Q=this.bitmap;if(a$Q.source&&a$Q.source.getImageData){var a$u=a$Q.source.getImageData(a$t,a$k,a$v,a$j),a$S=new Uint8Array(a$u);return Array.from(a$S)}return null}return a$c.isWebGL?a$N.getTexturePixels(this,a$t,a$k,a$v,a$j):(a$_.canvas.size(a$v,a$j),a$_.canvas.clear(),a$_.context.drawTexture(this,-a$t,-a$k,this.width,this.height,0,0),a$_.context.getImageData(0,0,a$v,a$j).data)},a$k.onAsynLoaded=function(a$t,a$k){if(a$k){if("function"!=typeof a$k._addReference)throw new Error("bitmap._addReference is not a function. "+a$k.className+" "+typeof a$k._addReference+" "+a$k.constructor);a$k._addReference()}this.setTo(a$k,this.uv),this._loaded&&this.event("loaded",this)},a$A(0,a$k,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),a$A(0,a$k,"loaded",function(){return this._loaded}),a$A(0,a$k,"released",function(){return!this.bitmap||this.bitmap.released}),a$A(0,a$k,"width",function(){return this._w?this._w:this.uv&&this.uv!==a$s.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(a$t){this._w=a$t,this.sourceWidth||(this.sourceWidth=a$t)}),a$A(0,a$k,"repeat",function(){return!a$c.isWebGL||!this.bitmap||this.bitmap.repeat},function(a$t){a$t&&a$c.isWebGL&&this.bitmap&&(this.bitmap.repeat=a$t)&&(this.bitmap.enableMerageInAtlas=!1)}),a$A(0,a$k,"height",function(){return this._h?this._h:this.uv&&this.uv!==a$s.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(a$t){this._h=a$t,this.sourceHeight||(this.sourceHeight=a$t)}),a$A(0,a$k,"isLinearSampling",function(){return!a$c.isWebGL||9728!=this.bitmap.minFifter},function(a$t){!a$t&&a$c.isWebGL&&(a$t||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),a$s.moveUV=function(a$t,a$k,a$v){for(var a$j=0;a$j<8;a$j+=2)a$v[a$j]+=a$t,a$v[a$j+1]+=a$k;return a$v},a$s.create=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){void 0===a$u&&(a$u=0),void 0===a$S&&(a$S=0),void 0===a$V&&(a$V=0),void 0===a$J&&(a$J=0);var a$W=a$t instanceof laya.resource.Texture,a$w=a$W?a$t.uv:a$s.DEF_UV,a$M=a$W?a$t.bitmap:a$t,a$H=a$N.isAtlas(a$M);if(a$H){var a$E=a$M._atlaser,a$A=a$t._atlasID;if(-1==a$A)throw new Error("create texture error");a$M=a$E._inAtlasTextureBitmapValue[a$A],a$w=a$E._inAtlasTextureOriUVValue[a$A]}var a$R=new a$s(a$M,null);a$M.width&&a$k+a$j>a$M.width&&(a$j=a$M.width-a$k),a$M.height&&a$v+a$Q>a$M.height&&(a$Q=a$M.height-a$v),a$R.width=a$j,a$R.height=a$Q,a$R.offsetX=a$u,a$R.offsetY=a$S,a$R.sourceWidth=a$V||a$j,a$R.sourceHeight=a$J||a$Q;var a$h=1/a$M.width,a$l=1/a$M.height;a$k*=a$h,a$v*=a$l,a$j*=a$h,a$Q*=a$l;var a$o=a$R.uv[0],a$Y=a$R.uv[1],a$f=a$R.uv[4],a$X=a$R.uv[5],a$F=a$f-a$o,a$d=a$X-a$Y,a$m=a$s.moveUV(a$w[0],a$w[1],[a$k,a$v,a$k+a$j,a$v,a$k+a$j,a$v+a$Q,a$k,a$v+a$Q]);a$R.uv=[a$o+a$m[0]*a$F,a$Y+a$m[1]*a$d,a$f-(1-a$m[2])*a$F,a$Y+a$m[3]*a$d,a$f-(1-a$m[4])*a$F,a$X-(1-a$m[5])*a$d,a$o+a$m[6]*a$F,a$X-(1-a$m[7])*a$d],a$H&&a$R.addTextureToAtlas();var a$Z=a$M.scaleRate;return a$Z&&1!=a$Z?(a$R.sourceWidth/=a$Z,a$R.sourceHeight/=a$Z,a$R.width/=a$Z,a$R.height/=a$Z,a$R.scaleRate=a$Z,a$R.offsetX/=a$Z,a$R.offsetY/=a$Z):a$R.scaleRate=1,a$R},a$s.createFromTexture=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$t.scaleRate;1!=a$u&&(a$k*=a$u,a$v*=a$u,a$j*=a$u,a$Q*=a$u);var a$S=a$Z.TEMP.setTo(a$k-a$t.offsetX,a$v-a$t.offsetY,a$j,a$Q),a$V=a$S.intersection(a$s._rect1.setTo(0,0,a$t.width,a$t.height),a$s._rect2);if(!a$V)return null;var a$J=a$s.create(a$t,a$V.x,a$V.y,a$V.width,a$V.height,a$V.x-a$S.x,a$V.y-a$S.y,a$j,a$Q);if(a$J.bitmap&&a$J.bitmap._removeReference)return a$J.bitmap._removeReference(),a$J;var a$W="bitmap:"+(a$J.bitmap?a$J.bitmap.constructor?a$J.bitmap.constructor.name:a$J.bitmap.__className:"")+", url:"+(a$t.url+" | "+(a$J.bitmap?a$J.bitmap.url:a$t.url))+", x="+a$k+",y="+a$v+",width="+a$j+",height="+a$Q+", result="+(a$V?a$V.x+","+a$V.y+","+a$V.width+","+a$V.height:"null")+", rect="+a$S.x+","+a$S.y+","+a$S.width+","+a$S.height;throw new Error("报错：bitmap._removeReference is not a function  "+a$W)},a$s.DEF_UV=[0,0,1,0,1,1,0,1],a$s.INV_UV=[0,1,1,1,1,0,0,0],a$s._rect1=new a$Z,a$s._rect2=new a$Z,a$s}(),a$t=function(a$t){var a$V;function a$u(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,a$u.__super.call(this)}a$w(a$u,"laya.utils.TimeLine",a$W);var a$k=a$u.prototype;return a$k.to=function(a$t,a$k,a$v,a$j,a$Q){return void 0===a$Q&&(a$Q=0),this._create(a$t,a$k,a$v,a$j,a$Q,!0)},a$k.from=function(a$t,a$k,a$v,a$j,a$Q){return void 0===a$Q&&(a$Q=0),this._create(a$t,a$k,a$v,a$j,a$Q,!1)},a$k._create=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=a$C.getItemByClass("tweenData",a$V);return a$S.isTo=a$u,a$S.type=0,a$S.target=a$t,a$S.duration=a$v,a$S.data=a$k,a$S.startTime=this._startTime+a$Q,a$S.endTime=a$S.startTime+a$S.duration,a$S.ease=a$j,this._startTime=Math.max(a$S.endTime,this._startTime),this._tweenDataList.push(a$S),this._startTimeSort=!0,this._endTimeSort=!0,this},a$k.addLabel=function(a$t,a$k){var a$v=a$C.getItemByClass("tweenData",a$V);return a$v.type=1,a$v.data=a$t,a$v.endTime=a$v.startTime=this._startTime+a$k,this._labelDic||(this._labelDic={}),this._labelDic[a$t]=a$v,this._tweenDataList.push(a$v),this},a$k.removeLabel=function(a$t){if(this._labelDic&&this._labelDic[a$t]){var a$k=this._labelDic[a$t];if(a$k){var a$v=this._tweenDataList.indexOf(a$k);-1<a$v&&this._tweenDataList.splice(a$v,1)}delete this._labelDic[a$t]}},a$k.gotoTime=function(a$t){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var a$k,a$v,a$j,a$Q;for(var a$u in this._firstTweenDic)if(a$v=this._firstTweenDic[a$u])for(var a$S in a$v)a$v.diyTarget.hasOwnProperty(a$S)&&(a$v.diyTarget[a$S]=a$v[a$S]);for(a$u in this._tweenDic)(a$k=this._tweenDic[a$u]).clear(),delete this._tweenDic[a$u];if(this._index=0,this._gidIndex=0,this._currTime=a$t,this._lastTime=a$_.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=a$j=this._tweenDataList.concat(),a$j.sort(function(a$t,a$k){return a$t.endTime>a$k.endTime?1:a$t.endTime<a$k.endTime?-1:0})}else a$j=this._endTweenDataList;for(var a$V=0,a$J=a$j.length;a$V<a$J;a$V++)if(0==(a$Q=a$j[a$V]).type){if(!(a$t>=a$Q.endTime))break;this._index=Math.max(this._index,a$V+1);var a$W=a$Q.data;if(a$Q.isTo)for(var a$w in a$W)a$Q.target[a$w]=a$W[a$w]}for(a$V=0,a$J=this._tweenDataList.length;a$V<a$J;a$V++)0==(a$Q=this._tweenDataList[a$V]).type&&a$t>=a$Q.startTime&&a$t<a$Q.endTime&&(this._index=Math.max(this._index,a$V+1),this._gidIndex++,(a$k=a$C.getItemByClass("tween",a$r))._create(a$Q.target,a$Q.data,a$Q.duration,a$Q.ease,a$o.create(this,this._animComplete,[this._gidIndex]),0,!1,a$Q.isTo,!0,!1),a$k.setStartTime(this._currTime-(a$t-a$Q.startTime)),a$k._updateEase(this._currTime),a$k.gid=this._gidIndex,this._tweenDic[this._gidIndex]=a$k)}},a$k.gotoLabel=function(a$t){if(null!=this._labelDic){var a$k=this._labelDic[a$t];a$k&&this.gotoTime(a$k.startTime)}},a$k.pause=function(){a$d.timer.clear(this,this._update)},a$k.resume=function(){this.play(this._currTime,this._loopKey)},a$k.play=function(a$t,a$k){if(void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(a$t,a$k){return a$t.startTime>a$k.startTime?1:a$t.startTime<a$k.startTime?-1:0});for(var a$v=0,a$j=this._tweenDataList.length;a$v<a$j;a$v++){var a$Q=this._tweenDataList[a$v];if(null!=a$Q&&0==a$Q.type){var a$u=a$Q.target,a$S=a$u.$_GID||(a$u.$_GID=a$g.getGID()),a$V=null;for(var a$J in null==this._firstTweenDic[a$S]?((a$V={}).diyTarget=a$u,this._firstTweenDic[a$S]=a$V):a$V=this._firstTweenDic[a$S],a$Q.data)null==a$V[a$J]&&(a$V[a$J]=a$u[a$J])}}}"string"==typeof a$t?this.gotoLabel(a$t):this.gotoTime(a$t),this._loopKey=a$k,this._lastTime=a$_.now(),a$d.timer.frameLoop(1,this,this._update)}},a$k._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var a$t in this._tweenDic)(a$k=this._tweenDic[a$t]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var a$k,a$v=a$_.now(),a$j=a$v-this._lastTime,a$Q=this._currTime+=a$j*this.scale;for(a$t in this._lastTime=a$v,this._tweenDic)(a$k=this._tweenDic[a$t])._updateEase(a$Q);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var a$u=this._tweenDataList[this._index];a$Q>=a$u.startTime&&(this._index++,0==a$u.type?(this._gidIndex++,(a$k=a$C.getItemByClass("tween",a$r))._create(a$u.target,a$u.data,a$u.duration,a$u.ease,a$o.create(this,this._animComplete,[this._gidIndex]),0,!1,a$u.isTo,!0,!1),a$k.setStartTime(a$Q),a$k.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=a$k)._updateEase(a$Q)):this.event("label",a$u.data))}},a$k._animComplete=function(a$t){this._tweenDic[a$t]&&delete this._tweenDic[a$t]},a$k._complete=function(){this.event("complete")},a$k.reset=function(){var a$t;if(this._labelDic)for(a$t in this._labelDic)delete this._labelDic[a$t];for(a$t in this._tweenDic)this._tweenDic[a$t].clear(),delete this._tweenDic[a$t];for(a$t in this._firstTweenDic)delete this._firstTweenDic[a$t];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var a$k,a$v=0;for(a$k=this._tweenDataList.length,a$v=0;a$v<a$k;a$v++)this._tweenDataList[a$v]&&this._tweenDataList[a$v].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,a$d.timer.clear(this,this._update)},a$k.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},a$A(0,a$k,"index",function(){return this._frameIndex},function(a$t){this._frameIndex=a$t,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),a$A(0,a$k,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),a$u.to=function(a$t,a$k,a$v,a$j,a$Q){return void 0===a$Q&&(a$Q=0),(new a$u).to(a$t,a$k,a$v,a$j,a$Q)},a$u.from=function(a$t,a$k,a$v,a$j,a$Q){return void 0===a$Q&&(a$Q=0),(new a$u).from(a$t,a$k,a$v,a$j,a$Q)},a$u.__init$=function(){a$V=function(){function a$t(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return a$w(a$t,""),a$t.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,a$C.recover("tweenData",this)},a$t}()},a$u}(),a$Mt=function(a$Q){function a$v(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,a$v.__super.call(this),this._style=a$V.EMPTY}a$w(a$v,"laya.display.Sprite",a$Q);var a$t=a$v.prototype;return a$d.imps(a$t,{"laya.display.ILayout":!0}),a$t.createConchModel=function(){return new ConchNode},a$t.destroy=function(a$t){if(void 0===a$t&&(a$t=!0),this._releaseMem(),!this._destroyed){this.filters=null;var a$k=this.mask;a$k&&(this.mask=null,a$k.destroy(a$t))}a$Q.prototype.destroy.call(this,a$t),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},a$t.updateZOrder=function(){a$g.updateOrder(this._childs)&&this.repaint()},a$t.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},a$t.setBounds=function(a$t){this._set$P("uBounds",a$t)},a$t.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new a$Z),a$Z._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},a$t.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new a$Z),a$Z._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},a$t._boundPointsToParent=function(a$t){void 0===a$t&&(a$t=!1);var a$k=0,a$v=0;this._style&&(a$k=this._style._tf.translateX,a$v=this._style._tf.translateY,a$t=a$t||0!==this._style._tf.rotate,this._style.scrollRect&&(a$k+=this._style.scrollRect.x,a$v+=this._style.scrollRect.y));var a$j=this._getBoundPointsM(a$t);if(!a$j||a$j.length<1)return a$j;if(8!=a$j.length&&(a$j=a$t?a$X.scanPList(a$j):a$Z._getWrapRec(a$j,a$Z.TEMP)._getBoundPoints()),!this.transform)return a$g.transPointList(a$j,this._x-a$k,this._y-a$v),a$j;var a$Q=a$m.TEMP,a$u=0,a$S=a$j.length;for(a$u=0;a$u<a$S;a$u+=2)a$Q.x=a$j[a$u],a$Q.y=a$j[a$u+1],this.toParentPoint(a$Q),a$j[a$u]=a$Q.x,a$j[a$u+1]=a$Q.y;return a$j},a$t.getGraphicBounds=function(a$t){return void 0===a$t&&(a$t=!1),this._graphics?this._graphics.getBounds(a$t):a$Z.TEMP.setTo(0,0,0,0)},a$t._getBoundPointsM=function(a$t){if(void 0===a$t&&(a$t=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var a$k=a$g.clearArray(this._$P.temBM),a$v=a$Z.TEMP;return a$v.copyFrom(this.scrollRect),a$g.concatArray(a$k,a$v._getBoundPoints()),a$k}for(var a$j,a$Q,a$u,a$S=this._graphics?this._graphics.getBoundPoints():a$g.clearArray(this._$P.temBM),a$V=0,a$J=(a$u=this._childs).length;a$V<a$J;a$V++)(a$j=a$u[a$V])instanceof laya.display.Sprite&&1==a$j.visible&&(a$Q=a$j._boundPointsToParent(a$t))&&(a$S=a$S?a$g.concatArray(a$S,a$Q):a$Q);return a$S},a$t.getStyle=function(){return this._style===a$V.EMPTY&&(this._style=new a$V),this._style},a$t.setStyle=function(a$t){this._style=a$t},a$t._adjustTransform=function(){this._tfChanged=!1;var a$t,a$k=this._style._tf,a$v=a$k.scaleX,a$j=a$k.scaleY;if(a$k.rotate||1!==a$v||1!==a$j||a$k.skewX||a$k.skewY){(a$t=this._transform||(this._transform=a$a.create())).bTransform=!0;var a$Q=.0174532922222222*(a$k.rotate-a$k.skewX),a$u=.0174532922222222*(a$k.rotate+a$k.skewY),a$S=Math.cos(a$u),a$V=Math.sin(a$u),a$J=Math.sin(a$Q),a$W=Math.cos(a$Q);return a$t.a=a$v*a$S,a$t.b=a$v*a$V,a$t.c=-a$j*a$J,a$t.d=a$j*a$W,a$t.tx=a$t.ty=0,a$t}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,a$t},a$t.pos=function(a$t,a$k,a$v){if(void 0===a$v&&(a$v=!1),this._x!==a$t||this._y!==a$k){if(this.destroyed)return this;if(a$v){this._x=a$t,this._y=a$k,this.conchModel&&this.conchModel.pos(this._x,this._y);var a$j=this._parent;a$j&&0===a$j._repaint&&(a$j._repaint=1,a$j.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=a$t,this.y=a$k}return this},a$t.pivot=function(a$t,a$k){return this.pivotX=a$t,this.pivotY=a$k,this},a$t.size=function(a$t,a$k){return this.width=a$t,this.height=a$k,this},a$t.scale=function(a$t,a$k,a$v){void 0===a$v&&(a$v=!1);var a$j=this.getStyle(),a$Q=a$j._tf;if(a$Q.scaleX!=a$t||a$Q.scaleY!=a$k){if(this.destroyed)return this;if(a$v){a$j.setScale(a$t,a$k),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(a$t,a$k),this._renderType|=4;var a$u=this._parent;a$u&&0===a$u._repaint&&(a$u._repaint=1,a$u.parentRepaint())}else this.scaleX=a$t,this.scaleY=a$k}return this},a$t.skew=function(a$t,a$k){return this.skewX=a$t,this.skewY=a$k,this},a$t.render=function(a$t,a$k,a$v){a$L.spriteCount++,a$p.renders[this._renderType]._fun(this,a$t,a$k+this._x,a$v+this._y),this._repaint=0},a$t.drawToCanvas=function(a$t,a$k,a$v,a$j){if(a$c.isConchNode){var a$Q=a$Yt.create("2D");return new a$T(a$t,a$k,a$Q).ctx.setCanvasType(1),this.conchModel.drawToCanvas(a$Q.source,a$v,a$j),a$Q}return a$N.drawToCanvas(this,this._renderType,a$t,a$k,a$v,a$j)},a$t.customRender=function(a$t,a$k,a$v){this._renderType|=1024},a$t._applyFilters=function(){var a$t;if(!a$c.isWebGL&&((a$t=this._$P.filters)&&!(a$t.length<1)))for(var a$k=0,a$v=a$t.length;a$k<a$v;a$k++)a$t[a$k].action.apply(this._$P.cacheCanvas)},a$t._isHaveGlowFilter=function(){var a$t,a$k=0;if(this.filters)for(a$k=0;a$k<this.filters.length;a$k++)if(8==this.filters[a$k].type)return!0;for(a$k=0,a$t=this._childs.length;a$k<a$t;a$k++)if(this._childs[a$k]._isHaveGlowFilter())return!0;return!1},a$t.localToGlobal=function(a$t,a$k){void 0===a$k&&(a$k=!1),!0===a$k&&(a$t=new a$m(a$t.x,a$t.y));for(var a$v=this;a$v&&a$v!=a$d.stage;)a$t=a$v.toParentPoint(a$t),a$v=a$v.parent;return a$t},a$t.globalToLocal=function(a$t,a$k){void 0===a$k&&(a$k=!1),a$k&&(a$t=new a$m(a$t.x,a$t.y));for(var a$v=this,a$j=[];a$v&&a$v!=a$d.stage;)a$j.push(a$v),a$v=a$v.parent;for(var a$Q=a$j.length-1;0<=a$Q;)a$t=(a$v=a$j[a$Q]).fromParentPoint(a$t),a$Q--;return a$t},a$t.toParentPoint=function(a$t){if(!a$t)return a$t;a$t.x-=this.pivotX,a$t.y-=this.pivotY,this.transform&&this._transform.transformPoint(a$t),a$t.x+=this._x,a$t.y+=this._y;var a$k=this._style.scrollRect;return a$k&&(a$t.x-=a$k.x,a$t.y-=a$k.y),a$t},a$t.fromParentPoint=function(a$t){if(!a$t)return a$t;a$t.x-=this._x,a$t.y-=this._y;var a$k=this._style.scrollRect;return a$k&&(a$t.x+=a$k.x,a$t.y+=a$k.y),this.transform&&this._transform.invertTransformPoint(a$t),a$t.x+=this.pivotX,a$t.y+=this.pivotY,a$t},a$t.on=function(a$t,a$k,a$v,a$j){return 1!==this._mouseEnableState&&this.isMouseEvent(a$t)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(a$t,a$k,a$v,a$j,!1)):a$Q.prototype.on.call(this,a$t,a$k,a$v,a$j)},a$t.once=function(a$t,a$k,a$v,a$j){return 1!==this._mouseEnableState&&this.isMouseEvent(a$t)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(a$t,a$k,a$v,a$j,!0)):a$Q.prototype.once.call(this,a$t,a$k,a$v,a$j)},a$t._$2__onDisplay=function(){if(1!==this._mouseEnableState){var a$t=this;for(a$t=a$t.parent;a$t&&1!==a$t._mouseEnableState&&!a$t._getBit(2);)a$t.mouseEnabled=!0,a$t._setBit(2,!0),a$t=a$t.parent}},a$t.loadImage=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=this;return void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=0),void 0===a$Q&&(a$Q=0),this.graphics.loadImage(a$t,a$k,a$v,a$j,a$Q,function(a$t){a$S.destroyed||(a$S.size(a$k+(a$j||a$t.width),a$v+(a$Q||a$t.height)),a$S.repaint(),a$u&&a$u.runWith(a$t))}),this},a$t.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},a$t._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},a$t._childChanged=function(a$t){this._childs.length?this._renderType|=2048:this._renderType&=-2049,a$t&&this._get$P("hasZorder")&&a$d.timer.callLater(this,this.updateZOrder),this.repaint()},a$t.parentRepaint=function(){var a$t=this._parent;a$t&&0===a$t._repaint&&(a$t._repaint=1,a$t.parentRepaint())},a$t.startDrag=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){void 0===a$k&&(a$k=!1),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=300),void 0===a$u&&(a$u=!1),void 0===a$S&&(a$S=.92),this._$P.dragging||this._set$P("dragging",new a$B),this._$P.dragging.start(this,a$t,a$k,a$v,a$j,a$Q,a$u,a$S)},a$t.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},a$t._releaseMem=function(){if(this._$P){var a$t=this._$P.cacheCanvas;a$t&&a$t.ctx&&(a$C.recover("RenderContext",a$t.ctx),a$t.ctx.canvas.size(0,0),a$t.ctx=null);var a$k=this._$P._filterCache;a$k&&(a$k.destroy(),a$k.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},a$t._setDisplay=function(a$t){a$t||this._releaseMem(),a$Q.prototype._setDisplay.call(this,a$t)},a$t.hitTestPoint=function(a$t,a$k){var a$v=this.globalToLocal(a$m.TEMP.setTo(a$t,a$k));return a$t=a$v.x,a$k=a$v.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?a$Z.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(a$t,a$k)},a$t.getMousePoint=function(){return this.globalToLocal(a$m.TEMP.setTo(a$d.stage.mouseX,a$d.stage.mouseY))},a$t._getWords=function(){return null},a$t._addChildsToLayout=function(a$t){var a$k=this._getWords();if(null==a$k&&0==this._childs.length)return!1;if(a$k)for(var a$v=0,a$j=a$k.length;a$v<a$j;a$v++)a$t.push(a$k[a$v]);a$v=0;for(var a$Q=this._childs.length;a$v<a$Q;++a$v){var a$u=this._childs[a$v];a$u._style._enableLayout()&&a$u._addToLayout(a$t)}return!0},a$t._addToLayout=function(a$t){this._style.absolute||(this._style.block?a$t.push(this):this._addChildsToLayout(a$t)&&(this.x=this.y=0))},a$t._isChar=function(){return!1},a$t._getCSSStyle=function(){return this._style.getCSSStyle()},a$t._setAttributes=function(a$t,a$k){switch(a$t){case"x":this.x=parseFloat(a$k);break;case"y":this.y=parseFloat(a$k);break;case"width":this.width=parseFloat(a$k);break;case"height":this.height=parseFloat(a$k);break;default:this[a$t]=a$k}},a$t._layoutLater=function(){this.parent&&this.parent._layoutLater()},a$A(0,a$t,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(a$t){this._optimizeScrollRect!=a$t&&(this._optimizeScrollRect=a$t,this.conchModel&&this.conchModel.optimizeScrollRect(a$t))}),a$A(0,a$t,"customRenderEnable",null,function(a$t){if(a$t&&(this._renderType|=1024,a$c.isConchNode)){a$v.CustomList.push(this);var a$k=new a$Yt("2d");a$k._setContext(new CanvasRenderingContext2D),this.customContext=new a$T(0,0,a$k),a$k.context.setCanvasType&&a$k.context.setCanvasType(2),this.conchModel.custom(a$k.context)}}),a$A(0,a$t,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(a$t){this.cacheAs=a$t?this._$P.hasFilter?"none":"normal":"none"}),a$A(0,a$t,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(a$t){var a$k=this._$P.cacheCanvas;if(a$t!==(a$k?a$k.type:"none")){if("none"!==a$t)this._getBit(1)||this._setUpNoticeType(1),a$k||(a$k=this._set$P("cacheCanvas",a$C.getItemByClass("cacheCanvas",Object))),a$k.type=a$t,a$k.reCache=!0,this._renderType|=16,"bitmap"==a$t&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(a$k){var a$v=a$k;a$v&&a$v.ctx&&(a$C.recover("RenderContext",a$v.ctx),a$v.ctx.canvas.size(0,0),a$v.ctx=null),a$C.recover("cacheCanvas",a$k)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),a$A(0,a$t,"zOrder",function(){return this._zOrder},function(a$t){this._zOrder!=a$t&&(this._zOrder=a$t,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(a$t),this._parent&&(a$t&&this._parent._set$P("hasZorder",!0),a$d.timer.callLater(this._parent,this.updateZOrder)))}),a$A(0,a$t,"rotation",function(){return this._style._tf.rotate},function(a$t){var a$k=this.getStyle();if(a$k._tf.rotate!==a$t){a$k.setRotate(a$t),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(a$t),this._renderType|=4;var a$v=this._parent;a$v&&0===a$v._repaint&&(a$v._repaint=1,a$v.parentRepaint())}}),a$A(0,a$t,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(a$t){this._width!==a$t&&(this._width=a$t,this.conchModel&&this.conchModel.size(a$t,this._height),this.repaint())}),a$A(0,a$t,"x",function(){return this._x},function(a$t){if(this._x!==a$t){if(this.destroyed)return;this._x=a$t,this.conchModel&&this.conchModel.pos(a$t,this._y);var a$k=this._parent;a$k&&0===a$k._repaint&&(a$k._repaint=1,a$k.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),a$A(0,a$t,"globalScaleY",function(){for(var a$t=1,a$k=this;a$k&&a$k!==a$d.stage;)a$t*=a$k.scaleY,a$k=a$k.parent;return a$t}),a$A(0,a$t,"hitArea",function(){return this._$P.hitArea},function(a$t){this._set$P("hitArea",a$t)}),a$A(0,a$t,"staticCache",function(){return this._$P.staticCache},function(a$t){this._set$P("staticCache",a$t),a$t||this.reCache()}),a$A(0,a$t,"texture",function(){return this._texture},function(a$t){this._texture!=a$t&&(this._texture=a$t,this.graphics.cleanByTexture(a$t,0,0))}),a$A(0,a$t,"y",function(){return this._y},function(a$t){if(this._y!==a$t){if(this.destroyed)return;this._y=a$t,this.conchModel&&this.conchModel.pos(this._x,a$t);var a$k=this._parent;a$k&&0===a$k._repaint&&(a$k._repaint=1,a$k.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),a$A(0,a$t,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(a$t){this._height!==a$t&&(this._height=a$t,this.conchModel&&this.conchModel.size(this._width,a$t),this.repaint())}),a$A(0,a$t,"blendMode",function(){return this._style.blendMode},function(a$t){this.getStyle().blendMode=a$t,this.conchModel&&this.conchModel.blendMode(a$t),a$t&&"source-over"!=a$t?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),a$A(0,a$t,"scaleX",function(){return this._style._tf.scaleX},function(a$t){var a$k=this.getStyle();if(a$k._tf.scaleX!==a$t){a$k.setScaleX(a$t),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(a$t,a$k._tf.scaleY),this._renderType|=4;var a$v=this._parent;a$v&&0===a$v._repaint&&(a$v._repaint=1,a$v.parentRepaint())}}),a$A(0,a$t,"scaleY",function(){return this._style._tf.scaleY},function(a$t){var a$k=this.getStyle();if(a$k._tf.scaleY!==a$t){a$k.setScaleY(a$t),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(a$k._tf.scaleX,a$t),this._renderType|=4;var a$v=this._parent;a$v&&0===a$v._repaint&&(a$v._repaint=1,a$v.parentRepaint())}}),a$A(0,a$t,"stage",function(){return a$d.stage}),a$A(0,a$t,"skewX",function(){return this._style._tf.skewX},function(a$t){var a$k=this.getStyle();if(a$k._tf.skewX!==a$t){a$k.setSkewX(a$t),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(a$t,a$k._tf.skewY),this._renderType|=4;var a$v=this._parent;a$v&&0===a$v._repaint&&(a$v._repaint=1,a$v.parentRepaint())}}),a$A(0,a$t,"scrollRect",function(){return this._style.scrollRect},function(a$t){this.getStyle().scrollRect=a$t,this.repaint(),a$t?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(a$t.x,a$t.y,a$t.width,a$t.height)):(this._renderType&=-129,this.conchModel&&(a$v.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),a$A(0,a$t,"skewY",function(){return this._style._tf.skewY},function(a$t){var a$k=this.getStyle();if(a$k._tf.skewY!==a$t){a$k.setSkewY(a$t),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(a$k._tf.skewX,a$t),this._renderType|=4;var a$v=this._parent;a$v&&0===a$v._repaint&&(a$v._repaint=1,a$v.parentRepaint())}}),a$A(0,a$t,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(a$t){this._tfChanged=!1,(this._transform=a$t)&&(this._x=a$t.tx,this._y=a$t.ty,a$t.tx=a$t.ty=0,this.conchModel&&this.conchModel.transform(a$t.a,a$t.b,a$t.c,a$t.d,this._x,this._y)),a$t?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),a$A(0,a$t,"pivotX",function(){return this._style._tf.translateX},function(a$t){this.getStyle().setTranslateX(a$t),this.conchModel&&this.conchModel.pivot(a$t,this._style._tf.translateY),this.repaint()}),a$A(0,a$t,"pivotY",function(){return this._style._tf.translateY},function(a$t){this.getStyle().setTranslateY(a$t),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,a$t),this.repaint()}),a$A(0,a$t,"alpha",function(){return this._style.alpha},function(a$t){this._style&&this._style.alpha!==a$t&&(a$t=a$t<0?0:1<a$t?1:a$t,this.getStyle().alpha=a$t,this.conchModel&&this.conchModel.alpha(a$t),1!==a$t?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),a$A(0,a$t,"visible",function(){return this._style.visible},function(a$t){this._style&&this._style.visible!==a$t&&(this.getStyle().visible=a$t,this.conchModel&&this.conchModel.visible(a$t),this.parentRepaint())}),a$A(0,a$t,"graphics",function(){return this._graphics||(this.graphics=a$N.createGraphics())},function(a$t){this._graphics&&(this._graphics._sp=null),(this._graphics=a$t)?(this._renderType&=-2,this._renderType|=512,(a$t._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(a$v.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),a$A(0,a$t,"filters",function(){return this._$P.filters},function(a$t){a$t&&0===a$t.length&&(a$t=null),this._$P.filters!=a$t&&(this._set$P("filters",a$t?a$t.slice():null),a$c.isConchApp&&(this.conchModel&&(a$v.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),a$c.isWebGL&&(a$t&&a$t.length?this._renderType|=32:this._renderType&=-33),a$t&&0<a$t.length?(this._getBit(1)||this._setUpNoticeType(1),a$c.isWebGL&&1==a$t.length&&a$t[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(a$c.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),a$A(0,a$t,"parent",a$Q.prototype._$get_parent,function(a$t){a$d.superSet(a$tt,this,"parent",a$t),a$t&&this._getBit(2)&&this._$2__onDisplay()}),a$A(0,a$t,"mask",function(){return this._$P._mask},function(a$t){a$t&&this.mask&&this.mask._$P.maskParent||(a$t?(this.cacheAs="bitmap",this._set$P("_mask",a$t),a$t._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",a$t),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(a$t?a$t.conchModel:null),this._renderType|=64,this.parentRepaint())}),a$A(0,a$t,"mouseEnabled",function(){return 1<this._mouseEnableState},function(a$t){this._mouseEnableState=a$t?2:1}),a$A(0,a$t,"globalScaleX",function(){for(var a$t=1,a$k=this;a$k&&a$k!==a$d.stage;)a$t*=a$k.scaleX,a$k=a$k.parent;return a$t}),a$A(0,a$t,"mouseX",function(){return this.getMousePoint().x}),a$A(0,a$t,"mouseY",function(){return this.getMousePoint().y}),a$v.fromImage=function(a$t){return(new a$v).loadImage(a$t)},a$v._cachePool=[],a$v.CustomList=[],a$J(a$v,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=a$S.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),a$v}(a$tt),a$Ht=function(a$t){function a$k(a$t){this._audio=null,this._onEnd=null,this._resumePlay=null,a$k.__super.call(this),this._onEnd=a$g.bind(this.__onEnd,this),this._resumePlay=a$g.bind(this.__resumePlay,this),a$t.addEventListener("ended",this._onEnd),this._audio=a$t}a$w(a$k,"laya.media.h5audio.AudioSoundChannel",a$jt);var a$v=a$k.prototype;return a$v.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(a$d.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},a$v.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,a$_.container.appendChild(this._audio),this._audio.play()}catch(a$t){this.event("error")}},a$v.play=function(a$t){this.isStopped=!1;try{this._audio.playbackRate=a$U.playbackRate,this._audio.currentTime=this.startTime}catch(a$t){return void this._audio.addEventListener("canplay",this._resumePlay)}a$U.addChannel(this),a$_.container.appendChild(this._audio),!a$t&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},a$v.stop=function(){this.isStopped=!0,a$U.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&a$c.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),a$_.onIE||this._audio!=a$vt._musicAudio&&a$C.recover("audio:"+this.url,this._audio),a$_.removeElement(this._audio),this._audio=null)},a$v.pause=function(){this.isStopped=!0,a$U.removeChannel(this),"pause"in this._audio&&this._audio.pause()},a$v.resume=function(){this._audio&&(this.isStopped=!1,a$U.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},a$A(0,a$v,"position",function(){return this._audio?this._audio.currentTime:0}),a$A(0,a$v,"duration",function(){return this._audio?this._audio.duration:0}),a$A(0,a$v,"volume",function(){return this._audio?this._audio.volume:1},function(a$t){this._audio&&(this._audio.volume=a$t)}),a$k}(),a$Et=function(a$t){function a$k(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=a$ut.ctx,a$k.__super.call(this),this._onPlayEnd=a$g.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}a$w(a$k,"laya.media.webaudio.WebAudioSoundChannel",a$jt);var a$v=a$k.prototype;return a$v.play=function(a$t){if(a$U.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var a$k=this.context,a$v=this.gain,a$j=a$k.createBufferSource();(this.bufferSource=a$j).buffer=this.audioBuffer,a$j.connect(a$v),a$v&&a$v.disconnect(),a$v.connect(a$k.destination),a$j.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=a$_.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(a$j.loop=!0),a$j.playbackRate.setTargetAtTime?a$j.playbackRate.setTargetAtTime(a$U.playbackRate,this.context.currentTime,.1):a$j.playbackRate.value=a$U.playbackRate,a$j.start(0,this.startTime),!a$t&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},a$v.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(a$d.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},a$v._clearBufferSource=function(){if(this.bufferSource){var a$t=this.bufferSource;a$t.stop?a$t.stop(0):a$t.noteOff(0),a$t.disconnect(0),a$t.onended=null,a$k._tryCleanFailed||this._tryClearBuffer(a$t),this.bufferSource=null}},a$v._tryClearBuffer=function(a$t){try{a$t.buffer=null}catch(a$t){a$k._tryCleanFailed=!0}},a$v.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,a$U.removeChannel(this),this.startHandler=null,this.completeHandler=null},a$v.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,a$U.removeChannel(this)},a$v.resume=function(){this.startTime=this._pauseTime,this.play(!1)},a$A(0,a$v,"position",function(){return this.bufferSource?(a$_.now()-this._startTime)/1e3+this.startTime:0}),a$A(0,a$v,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),a$A(0,a$v,"volume",function(){return this._volume},function(a$t){this.isStopped||(this._volume=a$t,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(a$t,this.context.currentTime,.1):this.gain.gain.value=a$t)}),a$k._tryCleanFailed=!1,a$k}(),a$At=function(a$t){function a$k(){a$k.__super.call(this),this._w=0,this._h=0}a$w(a$k,"laya.resource.Bitmap",a$Wt);var a$v=a$k.prototype;return a$A(0,a$v,"width",function(){return this._w}),a$A(0,a$v,"height",function(){return this._h}),a$A(0,a$v,"source",function(){return this._source}),a$k}(),a$Rt=function(a$k){function a$t(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,a$t.__super.call(this),this._interval=a$j.animationInterval,this._setUpNoticeType(1)}a$w(a$t,"laya.display.AnimationPlayerBase",a$k);var a$v=a$t.prototype;return a$v.play=function(a$t,a$k,a$v,a$j){void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=!0),void 0===a$v&&(a$v=""),void 0===a$j&&(a$j=!0),this._isPlaying=!0,this.index="string"==typeof a$t?this._getFrameByLabel(a$t):a$t,this.loop=a$k,this._actionName=a$v,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},a$v._getFrameByLabel=function(a$t){var a$k=0;for(a$k=0;a$k<this._count;a$k++)if(this._labels[a$k]&&0<=this._labels[a$k].indexOf(a$t))return a$k;return 0},a$v._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},a$v._setControlNode=function(a$t){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=a$t)&&a$t!=this&&(a$t.on("display",this,this._checkResumePlaying),a$t.on("undisplay",this,this._checkResumePlaying))},a$v._setDisplay=function(a$t){a$k.prototype._setDisplay.call(this,a$t),this._checkResumePlaying()},a$v._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},a$v.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},a$v.addLabel=function(a$t,a$k){this._labels||(this._labels={}),this._labels[a$k]||(this._labels[a$k]=[]),this._labels[a$k].push(a$t)},a$v.removeLabel=function(a$t){if(a$t){if(this._labels)for(var a$k in this._labels)this._removeLabelFromLabelList(this._labels[a$k],a$t)}else this._labels=null},a$v._removeLabelFromLabelList=function(a$t,a$k){if(a$t)for(var a$v=a$t.length-1;0<=a$v;a$v--)a$t[a$v]==a$k&&a$t.splice(a$v,1)},a$v.gotoAndStop=function(a$t){this.index="string"==typeof a$t?this._getFrameByLabel(a$t):a$t,this.stop()},a$v._displayToIndex=function(a$t){},a$v.clear=function(){this.stop(),this._labels=null},a$A(0,a$v,"interval",function(){return this._interval},function(a$t){this._interval!=a$t&&(this._frameRateChanged=!0,this._interval=a$t,this._isPlaying&&0<a$t&&this.timerLoop(a$t,this,this._frameLoop,null,!0,!0))}),a$A(0,a$v,"isPlaying",function(){return this._isPlaying}),a$A(0,a$v,"index",function(){return this._index},function(a$t){if(this._index=a$t,this._displayToIndex(a$t),this._labels&&this._labels[a$t])for(var a$k=this._labels[a$t],a$v=0,a$j=a$k.length;a$v<a$j;a$v++)this.event("label",a$k[a$v])}),a$A(0,a$v,"count",function(){return this._count}),a$t.WRAP_POSITIVE=0,a$t.WRAP_REVERSE=1,a$t.WRAP_PINGPONG=2,a$t}(a$Mt),a$ht=function(a$k){function a$E(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,a$E.__super.call(this),this.overflow=a$E.VISIBLE,this._style=new a$kt(this),this._style.wordWrap=!1}a$w(a$E,"laya.display.Text",a$k);var a$t=a$E.prototype;return a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,a$t),this._lines=null,this._words&&(this._words.length=0,this._words=null)},a$t._getBoundPointsM=function(a$t){void 0===a$t&&(a$t=!1);var a$k=a$Z.TEMP;return a$k.setTo(0,0,this.width,this.height),a$k._getBoundPoints()},a$t.getGraphicBounds=function(a$t){void 0===a$t&&(a$t=!1);var a$k=a$Z.TEMP;return a$k.setTo(0,0,this.width,this.height),a$k},a$t._getCSSStyle=function(){return this._style},a$t.lang=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w){if(a$t=a$E.langPacks&&a$E.langPacks[a$t]?a$E.langPacks[a$t]:a$t,arguments.length<2)this._text=a$t;else{for(var a$M=0,a$H=arguments.length;a$M<a$H;a$M++)a$t=a$t.replace("{"+a$M+"}",arguments[a$M+1]);this._text=a$t}},a$t._isPassWordMode=function(){var a$t=this._style.password;return"prompt"in this&&this.prompt==this._text&&(a$t=!1),a$t},a$t._getPassWordTxt=function(a$t){var a$k;a$k="";for(var a$v=a$t.length;0<a$v;a$v--)a$k+="●";return a$k},a$t.renderText=function(a$t,a$k){var a$v=this.graphics;a$v.clear(!0);var a$j=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(a$_.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);a$_.context.font=a$j;var a$Q=this.padding,a$u=a$Q[3],a$S="left",a$V=this._lines,a$J=this.leading+this._charSize.height,a$W=this._currBitmapFont;a$W&&(a$J=this.leading+a$W.getMaxHeight());var a$w=a$Q[0];if(!a$W&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(a$S="right",a$u=this._width-a$Q[1]):"center"==this.align&&(a$S="center",a$u=.5*this._width+a$Q[3]-a$Q[1])),0<this._height){var a$M=this._textHeight>this._height?"top":this.valign;"middle"===a$M?a$w=.5*(this._height-a$k*a$J)+a$Q[0]-a$Q[2]:"bottom"===a$M&&(a$w=this._height-a$k*a$J-a$Q[2])}var a$H=this._style;if(a$W&&a$W.autoScaleSize)var a$E=a$W.fontSize/this.fontSize;if(this._clipPoint)if(a$v.save(),a$W&&a$W.autoScaleSize){var a$A=0,a$R=0;a$A=this._width?this._width-a$Q[3]-a$Q[1]:this._textWidth,a$R=this._height?this._height-a$Q[0]-a$Q[2]:this._textHeight,a$A*=a$E,a$R*=a$E,a$v.clipRect(a$Q[3],a$Q[0],a$A,a$R)}else a$v.clipRect(a$Q[3],a$Q[0],this._width?this._width-a$Q[3]-a$Q[1]:this._textWidth,this._height?this._height-a$Q[0]-a$Q[2]:this._textHeight);var a$h=a$H.password;"prompt"in this&&this.prompt==this._text&&(a$h=!1);for(var a$l=0,a$o=0,a$Y=Math.min(this._lines.length,a$k+a$t)||1,a$f=a$t;a$f<a$Y;a$f++){var a$X,a$F=a$V[a$f];if(a$h){var a$d=a$F.length;a$F="";for(var a$m=a$d;0<a$m;a$m--)a$F+="●"}if(a$l=a$u-(this._clipPoint?this._clipPoint.x:0),a$o=a$w+a$J*a$f-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(a$S,a$l,a$o,a$f),a$W){var a$Z=this.width;a$W.autoScaleSize&&(a$Z=this.width*a$E),a$W.drawText(a$F,this,a$l,a$o,this.align,a$Z)}else a$c.isWebGL?(this._words||(this._words=[]),(a$X=this._words.length>a$f-a$t?this._words[a$f-a$t]:new a$P).setText(a$F)):a$X=a$F,a$H.stroke?a$v.fillBorderText(a$X,a$l,a$o,a$j,this.color,a$H.strokeColor,a$H.stroke,a$S):a$v.fillText(a$X,a$l,a$o,a$j,this.color,a$S)}if(a$W&&a$W.autoScaleSize){var a$s=1/a$E;this.scale(a$s,a$s)}this._clipPoint&&a$v.restore(),this._startX=a$u,this._startY=a$w},a$t.drawUnderline=function(a$t,a$k,a$v,a$j){var a$Q=this._lineWidths[a$j];switch(a$t){case"center":a$k-=a$Q/2;break;case"right":a$k-=a$Q}a$v+=this._charSize.height,this._graphics.drawLine(a$k,a$v,a$k+a$Q,a$v,this.underlineColor||this.color,1)},a$t.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);a$_.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new a$m(0,0)):this._clipPoint=null;var a$t=this._lines.length;if(this.overflow!=a$E.VISIBLE){var a$k=this.overflow==a$E.HIDDEN?Math.floor:Math.ceil;a$t=Math.min(a$t,a$k((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var a$v=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(a$v,a$t),this.repaint()},a$t.evalTextSize=function(){var a$t,a$k=NaN;a$t=Math.max.apply(this,this._lineWidths),a$k=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],a$t==this._textWidth&&a$k==this._textHeight||(this._textWidth=a$t,this._textHeight=a$k,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},a$t.checkEnabledViewportOrNot=function(){return this.overflow==a$E.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},a$t.changeText=function(a$t){this._text!==a$t&&(this.lang(a$t+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},a$t.parseLines=function(a$t){var a$k=this.wordWrap||this.overflow==a$E.HIDDEN;if(a$k)var a$v=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var a$j=a$_.context.measureText(a$E._testWord);a$c.isConchApp&&0===a$j.width&&0===a$j.height&&(a$j=a$_.context.measureText("W")),this._charSize.width=a$j.width,this._charSize.height=a$j.height||this.fontSize}for(var a$Q=a$t.replace(/\r\n/g,"\n").split("\n"),a$u=0,a$S=a$Q.length;a$u<a$S;a$u++){var a$V=a$Q[a$u];a$k?this.parseLine(a$V,a$v):(this._lineWidths.push(this.getTextWidth(a$V)),this._lines.push(a$V))}},a$t.parseLine=function(a$t,a$k){a$_.context;var a$v,a$j=this._lines,a$Q=0,a$u=NaN,a$S=NaN,a$V=0;if((a$u=this.getTextWidth(a$t))<=a$k)return a$j.push(a$t),void this._lineWidths.push(a$u);a$u=this._charSize.width,0==(a$Q=Math.floor(a$k/a$u))&&(a$Q=1),a$S=a$u=this.getTextWidth(a$t.substring(0,a$Q));for(var a$J=a$Q,a$W=a$t.length;a$J<a$W;a$J++)if(a$k<(a$S+=a$u=this.getTextWidth(a$t.charAt(a$J))))if(this.wordWrap){var a$w=a$t.substring(a$V,a$J);if(a$w.charCodeAt(a$w.length-1)<255?(a$v=/(?:\w|-)+$/.exec(a$w))&&(a$J=a$v.index+a$V,0==a$v.index?a$J+=a$w.length:a$w=a$t.substring(a$V,a$J)):a$E.RightToLeft&&(a$v=/([\u0600-\u06FF])+$/.exec(a$w))&&(a$J=a$v.index+a$V,0==a$v.index?a$J+=a$w.length:a$w=a$t.substring(a$V,a$J)),a$j.push(a$w),this._lineWidths.push(a$S-a$u),!((a$V=a$J)+a$Q<a$W)){a$j.push(a$t.substring(a$V,a$W)),this._lineWidths.push(this.getTextWidth(a$j[a$j.length-1])),a$V=-1;break}a$J+=a$Q,a$S=a$u=this.getTextWidth(a$t.substring(a$V,a$J)),a$J--}else if(this.overflow==a$E.HIDDEN)return a$j.push(a$t.substring(0,a$J)),void this._lineWidths.push(this.getTextWidth(a$j[a$j.length-1]));this.wordWrap&&-1!=a$V&&(a$j.push(a$t.substring(a$V,a$W)),this._lineWidths.push(this.getTextWidth(a$j[a$j.length-1])))},a$t.getTextWidth=function(a$t){return this._currBitmapFont?this._currBitmapFont.getTextWidth(a$t):a$_.context.measureText(a$t).width},a$t.getWordWrapWidth=function(){var a$t=this.padding,a$k=NaN;return(a$k=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(a$k=this.wordWrap?100:a$_.width),a$k<=0&&(a$k=100),a$k-a$t[3]-a$t[1]},a$t.getCharPoint=function(a$t,a$k){this._isChanged&&a$d.timer.runCallLater(this,this.typeset);for(var a$v=0,a$j=this._lines,a$Q=0,a$u=0,a$S=a$j.length;a$u<a$S;a$u++){if(a$t<(a$v+=a$j[a$u].length)){var a$V=a$u;break}a$Q=a$v}var a$J=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;a$_.context.font=a$J;var a$W=this.getTextWidth(this._text.substring(a$Q,a$t));return(a$k||new a$m).setTo(this._startX+a$W-(this._clipPoint?this._clipPoint.x:0),this._startY+a$V*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},a$A(0,a$t,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(a$t){a$t!=this._width&&(a$d.superSet(a$Mt,this,"width",a$t),this.isChanged=!0)}),a$A(0,a$t,"textWidth",function(){return this._isChanged&&a$d.timer.runCallLater(this,this.typeset),this._textWidth}),a$A(0,a$t,"height",function(){return this._height?this._height:this.textHeight},function(a$t){a$t!=this._height&&(a$d.superSet(a$Mt,this,"height",a$t),this.isChanged=!0)}),a$A(0,a$t,"textHeight",function(){return this._isChanged&&a$d.timer.runCallLater(this,this.typeset),this._textHeight}),a$A(0,a$t,"padding",function(){return this._getCSSStyle().padding},function(a$t){this._getCSSStyle().padding=a$t,this.isChanged=!0}),a$A(0,a$t,"bold",function(){return this._getCSSStyle().bold},function(a$t){this._getCSSStyle().bold=a$t,this.isChanged=!0}),a$A(0,a$t,"text",function(){return this._text||""},function(a$t){this._text!==a$t&&(this.lang(a$t+""),this.isChanged=!0,this.event("change"))}),a$A(0,a$t,"color",function(){return this._getCSSStyle().color},function(a$t){this._getCSSStyle().color!=a$t&&(this._getCSSStyle().color=a$t,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),a$A(0,a$t,"font",function(){return this._getCSSStyle().fontFamily},function(a$t){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),a$E._bitmapFonts&&a$E._bitmapFonts[a$t]&&(this._currBitmapFont=a$E._bitmapFonts[a$t]),this._getCSSStyle().fontFamily=a$t,this.isChanged=!0}),a$A(0,a$t,"fontSize",function(){return this._getCSSStyle().fontSize},function(a$t){this._getCSSStyle().fontSize=a$t,this.isChanged=!0}),a$A(0,a$t,"italic",function(){return this._getCSSStyle().italic},function(a$t){this._getCSSStyle().italic=a$t,this.isChanged=!0}),a$A(0,a$t,"align",function(){return this._getCSSStyle().align},function(a$t){this._getCSSStyle().align=a$t,this.isChanged=!0}),a$A(0,a$t,"valign",function(){return this._getCSSStyle().valign},function(a$t){this._getCSSStyle().valign=a$t,this.isChanged=!0}),a$A(0,a$t,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(a$t){this._getCSSStyle().wordWrap=a$t,this.isChanged=!0}),a$A(0,a$t,"leading",function(){return this._getCSSStyle().leading},function(a$t){this._getCSSStyle().leading=a$t,this.isChanged=!0}),a$A(0,a$t,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(a$t){this._getCSSStyle().backgroundColor=a$t,this.isChanged=!0}),a$A(0,a$t,"borderColor",function(){return this._getCSSStyle().borderColor},function(a$t){this._getCSSStyle().borderColor=a$t,this.isChanged=!0}),a$A(0,a$t,"stroke",function(){return this._getCSSStyle().stroke},function(a$t){this._getCSSStyle().stroke=a$t,this.isChanged=!0}),a$A(0,a$t,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(a$t){this._getCSSStyle().strokeColor=a$t,this.isChanged=!0}),a$A(0,a$t,"isChanged",null,function(a$t){this._isChanged!==a$t&&(this._isChanged=a$t)&&a$d.timer.callLater(this,this.typeset)}),a$A(0,a$t,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(a$t){if(!(this.overflow!=a$E.SCROLL||this.textWidth<this._width)&&this._clipPoint){a$t=a$t<this.padding[3]?this.padding[3]:a$t;var a$k=this._textWidth-this._width;a$t=a$k<a$t?a$k:a$t;var a$v=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=a$t,this.renderText(this._lastVisibleLineIndex,a$v)}}),a$A(0,a$t,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(a$t){if(!(this.overflow!=a$E.SCROLL||this.textHeight<this._height)&&this._clipPoint){a$t=a$t<this.padding[0]?this.padding[0]:a$t;var a$k=this._textHeight-this._height,a$v=(a$t=a$k<a$t?a$k:a$t)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=a$v;var a$j=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=a$t,this.renderText(a$v,a$j)}}),a$A(0,a$t,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),a$A(0,a$t,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),a$A(0,a$t,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),a$A(0,a$t,"underlineColor",function(){return this._underlineColor},function(a$t){this._underlineColor=a$t,this._isChanged=!0,this.typeset()}),a$E.registerBitmapFont=function(a$t,a$k){a$E._bitmapFonts||(a$E._bitmapFonts={}),a$E._bitmapFonts[a$t]=a$k},a$E.unregisterBitmapFont=function(a$t,a$k){if(void 0===a$k&&(a$k=!0),a$E._bitmapFonts&&a$E._bitmapFonts[a$t]){var a$v=a$E._bitmapFonts[a$t];a$k&&a$v.destroy(),delete a$E._bitmapFonts[a$t]}},a$E.setTextRightToLeft=function(){var a$t;(a$t=a$_.canvas.source.style).display="none",a$t.position="absolute",a$t.direction="rtl",a$c._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,a$_.document.body.appendChild(a$_.canvas.source)},a$E.supportFont=function(a$t){a$_.context.font="10px sans-serif";var a$k=a$_.context.measureText("abcji").width;a$_.context.font="10px "+a$t;var a$v=a$_.context.measureText("abcji").width;return console.log(a$k,a$v),a$k!==a$v},a$E._testWord="游",a$E.langPacks=null,a$E.VISIBLE="visible",a$E.SCROLL="scroll",a$E.HIDDEN="hidden",a$E.CharacterCache=!0,a$E.RightToLeft=!1,a$E._bitmapFonts=null,a$J(a$E,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),a$E}(a$Mt),a$lt=function(a$M){function a$S(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",a$S.__super.call(this),this.offset=new a$m,this._canvasTransform=new a$a,this._previousOrientation=a$_.window.orientation;var a$k=this;this.transform=a$a.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var a$t=a$_.window,a$v=this;a$t.addEventListener("focus",function(){a$k._isFocused=!0,a$v.event("focus"),a$v.event("focuschange")}),a$t.addEventListener("blur",function(){a$k._isFocused=!1,a$v.event("blur"),a$v.event("focuschange"),a$v._isInputting()&&(a$Xt.inputElement.target.focus=!1)});var a$j="visibilityState",a$Q="visibilitychange",a$u=a$t.document;void 0!==a$u.hidden?(a$Q="visibilitychange",a$j="visibilityState"):void 0!==a$u.mozHidden?(a$Q="mozvisibilitychange",a$j="mozVisibilityState"):void 0!==a$u.msHidden?(a$Q="msvisibilitychange",a$j="msVisibilityState"):void 0!==a$u.webkitHidden&&(a$Q="webkitvisibilitychange",a$j="webkitVisibilityState"),a$t.document.addEventListener(a$Q,function(){"hidden"==a$_.document[a$j]?a$v._setStageVisible(!1):a$v._setStageVisible(!0)}),a$t.document.addEventListener("qbrowserVisibilityChange",function(a$t){a$v._setStageVisible(!a$t.hidden)}),a$t.addEventListener("resize",function(){var a$t=a$_.window.orientation;null!=a$t&&a$t!=a$k._previousOrientation&&a$v._isInputting()&&(a$Xt.inputElement.target.focus=!1),a$k._previousOrientation=a$t,a$v._isInputting()||a$v._resetCanvas()}),a$t.addEventListener("orientationchange",function(a$t){a$v._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),a$_.onMobile&&this.on("mousedown",this,this._onmouseMove)}a$w(a$S,"laya.display.Stage",a$M);var a$t=a$S.prototype;return a$t._setStageVisible=function(a$t){this._isVisibility!=a$t&&(this._isVisibility=a$t,this._isVisibility||this._isInputting()&&(a$Xt.inputElement.target.focus=!1),this.event("visibilitychange"))},a$t._isInputting=function(){return a$_.onMobile&&a$Xt.isInputting},a$t._changeCanvasSize=function(){this.setScreenSize(a$_.clientWidth*a$_.pixelRatio,a$_.clientHeight*a$_.pixelRatio)},a$t._resetCanvas=function(){if(this.screenAdaptationEnabled){var a$t=a$c._mainCanvas;a$t.source.style;a$t.size(1,1),a$d.timer.once(100,this,this._changeCanvasSize)}},a$t.setScreenSize=function(a$t,a$k){var a$v=!1;if("none"!==this._screenMode&&(a$v=(a$t/a$k<1?"vertical":"horizontal")!==this._screenMode)){var a$j=a$k;a$k=a$t,a$t=a$j}this.canvasRotation=a$v;var a$Q=a$c._mainCanvas,a$u=a$Q.source.style,a$S=this._canvasTransform.identity(),a$V=this._scaleMode,a$J=a$t/this.designWidth,a$W=a$k/this.designHeight,a$w=this.designWidth,a$M=this.designHeight,a$H=a$t,a$E=a$k,a$A=a$_.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,a$V){case"noscale":a$J=a$W=1,a$H=this.designWidth,a$E=this.designHeight;break;case"showall":a$J=a$W=Math.min(a$J,a$W),a$w=a$H=Math.round(this.designWidth*a$J),a$M=a$E=Math.round(this.designHeight*a$W);break;case"noborder":a$J=a$W=Math.max(a$J,a$W),a$H=Math.round(this.designWidth*a$J),a$E=Math.round(this.designHeight*a$W);break;case"full":a$J=a$W=1,this._width=a$w=a$t,this._height=a$M=a$k;break;case"fixedwidth":a$W=a$J,this._height=a$M=Math.round(a$k/a$J);break;case"fixedheight":a$J=a$W,this._width=a$w=Math.round(a$t/a$W);break;case"fixedauto":a$t/a$k<this.designWidth/this.designHeight?(a$W=a$J,this._height=a$M=Math.round(a$k/a$J)):(a$J=a$W,this._width=a$w=Math.round(a$t/a$W))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,a$w=a$w+1&2147483646,a$M=a$M+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),a$J*=this.scaleX,a$W*=this.scaleY,1===a$J&&1===a$W?this.transform.identity():(this.transform.a=this._formatData(a$J/(a$H/a$w)),this.transform.d=this._formatData(a$W/(a$E/a$M)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),a$Q.size(a$w,a$M),a$N.changeWebGLSize(a$w,a$M),a$S.scale(a$H/a$w/a$A,a$E/a$M/a$A),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(a$t-a$H)/a$A:this.offset.x=.5*(a$t-a$H)/a$A,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(a$k-a$E)/a$A:this.offset.y=.5*(a$k-a$E)/a$A,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),a$S.translate(this.offset.x,this.offset.y),this.canvasDegree=0,a$v&&("horizontal"===this._screenMode?(a$S.rotate(Math.PI/2),a$S.translate(a$k/a$A,0),this.canvasDegree=90):(a$S.rotate(-Math.PI/2),a$S.translate(0,a$t/a$A),this.canvasDegree=-90)),a$S.a=this._formatData(a$S.a),a$S.d=this._formatData(a$S.d),a$S.tx=this._formatData(a$S.tx),a$S.ty=this._formatData(a$S.ty),a$u.transformOrigin=a$u.webkitTransformOrigin=a$u.msTransformOrigin=a$u.mozTransformOrigin=a$u.oTransformOrigin="0px 0px 0px",a$u.transform=a$u.webkitTransform=a$u.msTransform=a$u.mozTransform=a$u.oTransform="matrix("+a$S.toString()+")",a$S.translate(parseInt(a$u.left)||0,parseInt(a$u.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},a$t._formatData=function(a$t){return Math.abs(a$t)<1e-6?0:Math.abs(1-a$t)<.001?0<a$t?1:-1:a$t},a$t.getMousePoint=function(){return a$m.TEMP.setTo(this.mouseX,this.mouseY)},a$t.repaint=function(){this._repaint=1},a$t.parentRepaint=function(){},a$t._loop=function(){return this.render(a$c.context,0,0),!0},a$t._onmouseMove=function(a$t){this._mouseMoveTime=a$_.now()},a$t.getTimeFromFrameStart=function(){return a$_.now()-this._frameStartTime},a$t.render=function(a$t,a$k,a$v){if("sleep"===this._frameRate&&!a$c.isConchApp){var a$j=a$_.now();if(!(1e3<=a$j-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(a$L.loopCount++,a$R.instance.runEvent(),a$d.timer._update()));this._frameStartTime=a$j}if(this._renderCount++,a$c.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=a$_.now();var a$Q="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),a$u=this._renderCount%2==0;if(a$L.renderSlow=!a$Q,a$Q||a$u||a$c.isConchApp){var a$S;a$L.loopCount++,a$R.instance.runEvent(),a$d.timer._update(),a$N.update3DLoop();var a$V=0,a$J=0;if(a$c.isConchNode)for(a$V=0,a$J=this._scenes.length;a$V<a$J;a$V++)(a$S=this._scenes[a$V])&&a$S._updateSceneConch();else for(a$V=0,a$J=this._scenes.length;a$V<a$J;a$V++)(a$S=this._scenes[a$V])&&a$S._updateScene();if(a$c.isConchNode){var a$W=a$Mt.CustomList;for(a$V=0,a$J=a$W.length;a$V<a$J;a$V++){var a$w=a$W[a$V];a$w.customRender(a$w.customContext,0,0)}return}}a$c.isConchNode||this.renderingEnabled&&(a$Q||!a$u||a$c.isConchWebGL)&&(a$c.isWebGL?a$c.WebGL.mainContext&&!a$c.WebGL.mainContext.isContextLost()&&(a$t.clear(),a$M.prototype.render.call(this,a$t,a$k,a$v),a$L._show&&a$L._sp&&a$L._sp.render(a$t,a$k,a$v),a$N.clear(this._bgColor),a$N.beginFlush(),a$t.flush(),a$N.endFinish(),a$$.instance&&a$$.getInstance().endDispose()):(a$N.clear(this._bgColor),a$M.prototype.render.call(this,a$t,a$k,a$v),a$L._show&&a$L._sp&&a$L._sp.render(a$t,a$k,a$v)))}else this._renderCount%5==0&&(a$L.loopCount++,a$R.instance.runEvent(),a$d.timer._update())},a$t._requestFullscreen=function(){var a$t=a$_.document.documentElement;a$t.requestFullscreen?a$t.requestFullscreen():a$t.mozRequestFullScreen?a$t.mozRequestFullScreen():a$t.webkitRequestFullscreen?a$t.webkitRequestFullscreen():a$t.msRequestFullscreen&&a$t.msRequestFullscreen()},a$t._fullScreenChanged=function(){a$d.stage.event("fullscreenchange")},a$t.exitFullscreen=function(){var a$t=a$_.document;a$t.exitFullscreen?a$t.exitFullscreen():a$t.mozCancelFullScreen?a$t.mozCancelFullScreen():a$t.webkitExitFullscreen&&a$t.webkitExitFullscreen()},a$A(0,a$t,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),a$A(0,a$t,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),a$A(0,a$t,"frameRate",function(){return this._frameRate},function(a$t){if(this._frameRate=a$t,a$c.isConchApp)switch(this._frameRate){case"slow":a$_.window.conch&&a$_.window.conchConfig.setSlowFrame&&a$_.window.conchConfig.setSlowFrame(!0);break;case"fast":a$_.window.conch&&a$_.window.conchConfig.setSlowFrame&&a$_.window.conchConfig.setSlowFrame(!1);break;case"mouse":a$_.window.conch&&a$_.window.conchConfig.setMouseFrame&&a$_.window.conchConfig.setMouseFrame(2e3);break;case"sleep":a$_.window.conch&&a$_.window.conchConfig.setLimitFPS&&a$_.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),a$A(0,a$t,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),a$A(0,a$t,"width",a$M.prototype._$get_width,function(a$t){this.designWidth=a$t,a$d.superSet(a$Mt,this,"width",a$t),a$d.timer.callLater(this,this._changeCanvasSize)}),a$A(0,a$t,"alignH",function(){return this._alignH},function(a$t){this._alignH=a$t,a$d.timer.callLater(this,this._changeCanvasSize)}),a$A(0,a$t,"isFocused",function(){return this._isFocused}),a$A(0,a$t,"height",a$M.prototype._$get_height,function(a$t){this.designHeight=a$t,a$d.superSet(a$Mt,this,"height",a$t),a$d.timer.callLater(this,this._changeCanvasSize)}),a$A(0,a$t,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||a$a.create()},a$M.prototype._$set_transform),a$A(0,a$t,"isVisibility",function(){return this._isVisibility}),a$A(0,a$t,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),a$A(0,a$t,"scaleMode",function(){return this._scaleMode},function(a$t){this._scaleMode=a$t,a$d.timer.callLater(this,this._changeCanvasSize)}),a$A(0,a$t,"alignV",function(){return this._alignV},function(a$t){this._alignV=a$t,a$d.timer.callLater(this,this._changeCanvasSize)}),a$A(0,a$t,"bgColor",function(){return this._bgColor},function(a$t){this._bgColor=a$t,this.conchModel&&this.conchModel.bgColor(a$t),a$c.isWebGL&&(a$t?a$S._wgColor=a$D.create(a$t)._color:a$_.onMiniGame||(a$S._wgColor=null)),a$_.onLimixiu?a$S._wgColor=a$D.create(a$t)._color:a$c.canvas.style.background=a$t||"none"}),a$A(0,a$t,"mouseX",function(){return Math.round(a$R.instance.mouseX/this.clientScaleX)}),a$A(0,a$t,"mouseY",function(){return Math.round(a$R.instance.mouseY/this.clientScaleY)}),a$A(0,a$t,"screenMode",function(){return this._screenMode},function(a$t){this._screenMode=a$t}),a$A(0,a$t,"visible",a$M.prototype._$get_visible,function(a$t){this.visible!==a$t&&(a$d.superSet(a$Mt,this,"visible",a$t),a$c._mainCanvas.source.style.visibility=a$t?"visible":"hidden")}),a$A(0,a$t,"fullScreenEnabled",null,function(a$t){var a$k=a$_.document,a$v=a$c.canvas;a$t?(a$v.addEventListener("mousedown",this._requestFullscreen),a$v.addEventListener("touchstart",this._requestFullscreen),a$k.addEventListener("fullscreenchange",this._fullScreenChanged),a$k.addEventListener("mozfullscreenchange",this._fullScreenChanged),a$k.addEventListener("webkitfullscreenchange",this._fullScreenChanged),a$k.addEventListener("msfullscreenchange",this._fullScreenChanged)):(a$v.removeEventListener("mousedown",this._requestFullscreen),a$v.removeEventListener("touchstart",this._requestFullscreen),a$k.removeEventListener("fullscreenchange",this._fullScreenChanged),a$k.removeEventListener("mozfullscreenchange",this._fullScreenChanged),a$k.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),a$k.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),a$S.SCALE_NOSCALE="noscale",a$S.SCALE_EXACTFIT="exactfit",a$S.SCALE_SHOWALL="showall",a$S.SCALE_NOBORDER="noborder",a$S.SCALE_FULL="full",a$S.SCALE_FIXED_WIDTH="fixedwidth",a$S.SCALE_FIXED_HEIGHT="fixedheight",a$S.SCALE_FIXED_AUTO="fixedauto",a$S.ALIGN_LEFT="left",a$S.ALIGN_RIGHT="right",a$S.ALIGN_CENTER="center",a$S.ALIGN_TOP="top",a$S.ALIGN_MIDDLE="middle",a$S.ALIGN_BOTTOM="bottom",a$S.SCREEN_NONE="none",a$S.SCREEN_HORIZONTAL="horizontal",a$S.SCREEN_VERTICAL="vertical",a$S.FRAME_FAST="fast",a$S.FRAME_SLOW="slow",a$S.FRAME_MOUSE="mouse",a$S.FRAME_SLEEP="sleep",a$S.FRAME_MOUSE_THREDHOLD=2e3,a$J(a$S,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),a$S}(a$Mt),a$ot=(function(a$t){function a$k(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,a$k.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}a$w(a$k,"laya.media.SoundNode",a$Mt);var a$v=a$k.prototype;a$v._onParentChange=function(){this.target=this.parent},a$v.play=function(a$t,a$k){void 0===a$t&&(a$t=1),isNaN(a$t)&&(a$t=1),this.url&&(this.stop(),this._channel=a$U.playSound(this.url,a$t,null,a$k))},a$v.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},a$v._setPlayAction=function(a$t,a$k,a$v,a$j){void 0===a$j&&(a$j=!0),this[a$v]&&a$t&&(a$j?a$t.on(a$k,this,this[a$v]):a$t.off(a$k,this,this[a$v]))},a$v._setPlayActions=function(a$t,a$k,a$v,a$j){if(void 0===a$j&&(a$j=!0),a$t&&a$k){var a$Q,a$u=a$k.split(","),a$S=0;for(a$Q=a$u.length,a$S=0;a$S<a$Q;a$S++)this._setPlayAction(a$t,a$u[a$S],a$v,a$j)}},a$A(0,a$v,"playEvent",null,function(a$t){(this._playEvents=a$t)&&this._tar&&this._setPlayActions(this._tar,a$t,"play")}),a$A(0,a$v,"target",null,function(a$t){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=a$t,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),a$A(0,a$v,"stopEvent",null,function(a$t){(this._stopEvents=a$t)&&this._tar&&this._setPlayActions(this._tar,a$t,"stop")})}(),function(a$t){function a$k(){this._src=null,this._onload=null,this._onerror=null,a$k.__super.call(this)}a$w(a$k,"laya.resource.FileBitmap",a$At);var a$v=a$k.prototype;return a$A(0,a$v,"src",function(){return this._src},function(a$t){this._src=a$t}),a$A(0,a$v,"onload",null,function(a$t){}),a$A(0,a$v,"onerror",null,function(a$t){}),a$k}()),a$Yt=function(a$t){function a$v(a$t,a$k){this._is2D=!1,a$v.__super.call(this);var a$j=this;if(this._source=this,"2D"===a$t||"AUTO"===a$t&&!a$c.isWebGL){this._is2D=!0,this._source=a$k||a$_.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var a$Q=this;a$Q.getContext=function(a$t,a$k){if(a$j._ctx)return a$j._ctx;var a$v=a$j._ctx=a$j._source.getContext(a$t,a$k);return a$v&&(a$v._canvas=a$Q,a$c.isFlash||a$_.onLimixiu||(a$v.size=function(a$t,a$k){})),a$v}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}a$w(a$v,"laya.resource.HTMLCanvas",a$At);var a$k=a$v.prototype;return a$k.clear=function(){this._ctx&&this._ctx.clear()},a$k.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},a$k.release=function(){},a$k._setContext=function(a$t){this._ctx=a$t},a$k.getContext=function(a$t,a$k){return this._ctx?this._ctx:this._ctx=a$v._createContext(this)},a$k.getMemSize=function(){return 0},a$k.size=function(a$t,a$k){(this._w!=a$t||this._h!=a$k||this._source&&(this._source.width!=a$t||this._source.height!=a$k))&&(this._w=a$t,this._h=a$k,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(a$t,a$k),this._source&&(this._source.height=a$k,this._source.width=a$t))},a$k.getCanvas=function(){return this._source},a$k.toBase64=function(a$t,a$k,a$v){if(this._source)if(a$c.isConchApp&&this._source.toBase64)this._source.toBase64(a$t,a$k,a$v);else{var a$j=this._source.toDataURL(a$t,a$k);a$v.call(this,a$j)}},a$A(0,a$k,"context",function(){return this._ctx}),a$A(0,a$k,"asBitmap",null,function(a$t){}),a$v.create=function(a$t,a$k){return new a$v(a$t,a$k)},a$v.TYPE2D="2D",a$v.TYPE3D="3D",a$v.TYPEAUTO="AUTO",a$v._createContext=null,a$v}(),a$ft=(function(a$t){function a$J(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){throw a$J.__super.call(this),new Error("不允许new！")}a$w(a$J,"laya.resource.HTMLSubImage",a$At),a$J.create=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){return void 0===a$V&&(a$V=!1),new a$J(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V)}}(),function(a$t){function a$M(){this._frames=null,this._url=null,a$M.__super.call(this),this._setControlNode(this)}a$w(a$M,"laya.display.Animation",a$t);var a$k=a$M.prototype;a$k.destroy=function(a$t){void 0===a$t&&(a$t=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,a$t),this._frames=null,this._labels=null},a$k.play=function(a$t,a$k,a$v,a$j){void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=!0),void 0===a$v&&(a$v=""),void 0===a$j&&(a$j=!0),a$v&&this._setFramesFromCache(a$v,a$j),this._isPlaying=!0,this.index="string"==typeof a$t?this._getFrameByLabel(a$t):a$t,this.loop=a$k,this._actionName=a$v,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},a$k._setFramesFromCache=function(a$t,a$k){var a$v;return void 0===a$k&&(a$k=!1),this._url&&(a$t=this._url+"#"+a$t),a$t&&a$M.framesMap[a$t]?((a$v=a$M.framesMap[a$t])instanceof Array?(this._frames=a$M.framesMap[a$t],this._count=this._frames.length):(a$v.nodeRoot&&(a$M.framesMap[a$t]=this._parseGraphicAnimationByData(a$v),a$v=a$M.framesMap[a$t]),this._frames=a$v.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=a$v.interval),this._labels=this._copyLabels(a$v.labels)),!0):(a$k&&console.log("ani not found:",a$t),!1)},a$k._copyLabels=function(a$t){if(!a$t)return null;var a$k,a$v;for(a$v in a$k={},a$t)a$k[a$v]=a$g.copyArray([],a$t[a$v]);return a$k},a$k._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&a$t.prototype._frameLoop.call(this)},a$k._displayToIndex=function(a$t){this._frames&&(this.graphics=this._frames[a$t])},a$k.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},a$k.loadImages=function(a$t,a$k){return void 0===a$k&&(a$k=""),this._url="",this._setFramesFromCache(a$k)||(this.frames=a$M.framesMap[a$k]?a$M.framesMap[a$k]:a$M.createFrames(a$t,a$k)),this},a$k.loadAtlas=function(a$k,a$v,a$j){void 0===a$j&&(a$j=""),this._url="";var a$Q=this;function a$t(a$t){a$k===a$t&&(a$Q.frames=a$M.framesMap[a$j]?a$M.framesMap[a$j]:a$M.createFrames(a$k,a$j),a$v&&a$v.run())}return a$Q._setFramesFromCache(a$j)||(a$Vt.getAtlas(a$k)?a$t(a$k):a$d.loader.load(a$k,a$o.create(null,a$t,[a$k]),null,"atlas")),this},a$k.loadAnimation=function(a$t,a$k,a$v){this._url=a$t;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,a$k&&a$k.run()):!a$v||a$Vt.getAtlas(a$v)?this._loadAnimationData(a$t,a$k,a$v):a$d.loader.load(a$v,a$o.create(this,this._loadAnimationData,[a$t,a$k,a$v]),null,"atlas"),this},a$k._loadAnimationData=function(a$V,a$J,a$t){var a$W=this;if(!a$t||a$Vt.getAtlas(a$t)){var a$w=this;a$Vt.getRes(a$V)?a$k(a$V):a$d.loader.load(a$V,a$o.create(null,a$k,[a$V]),null,"json"),a$Vt.clearRes(a$V)}else console.warn("atlas load fail:"+a$t);function a$k(a$t){if(a$Vt.getRes(a$t)&&a$V===a$t){var a$k;if(a$M.framesMap[a$V+"#"])a$w._setFramesFromCache(a$W._actionName,!0),a$W.index=0,a$W._checkResumePlaying();else{var a$v=a$w._parseGraphicAnimation(a$Vt.getRes(a$V));if(!a$v)return;var a$j,a$Q=a$v.animationList,a$u=0,a$S=a$Q.length;for(a$u=0;a$u<a$S;a$u++)a$k=a$Q[a$u],a$M.framesMap[a$V+"#"+a$k.name]=a$k,a$j||(a$j=a$k);a$j&&(a$M.framesMap[a$V+"#"]=a$j,a$w._setFramesFromCache(a$W._actionName,!0),a$W.index=0),a$W._checkResumePlaying()}a$J&&a$J.run()}}},a$k._parseGraphicAnimation=function(a$t){return a$dt.parseAnimationData(a$t)},a$k._parseGraphicAnimationByData=function(a$t){return a$dt.parseAnimationByData(a$t)},a$A(0,a$k,"frames",function(){return this._frames},function(a$t){(this._frames=a$t)&&(this._count=a$t.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),a$A(0,a$k,"autoPlay",null,function(a$t){a$t?this.play():this.stop()}),a$A(0,a$k,"source",null,function(a$t){-1<a$t.indexOf(".ani")?this.loadAnimation(a$t):-1<a$t.indexOf(".json")||-1<a$t.indexOf("als")||-1<a$t.indexOf("atlas")?this.loadAtlas(a$t):this.loadImages(a$t.split(","))}),a$A(0,a$k,"autoAnimation",null,function(a$t){this.play(0,!0,a$t,!1)}),a$M.createFrames=function(a$t,a$k){var a$v,a$j,a$Q=0,a$u=0;if("string"==typeof a$t){var a$S=a$Vt.getAtlas(a$t);if(a$S&&a$S.length)for(a$v=[],a$Q=0,a$u=a$S.length;a$Q<a$u;a$Q++)(a$j=new a$N.createGraphics).drawTexture(a$Vt.getRes(a$S[a$Q]),0,0),a$v.push(a$j)}else if(a$t instanceof Array)for(a$v=[],a$Q=0,a$u=a$t.length;a$Q<a$u;a$Q++)(a$j=new a$N.createGraphics).loadImage(a$t[a$Q],0,0),a$v.push(a$j);return a$k&&(a$M.framesMap[a$k]=a$v),a$v},a$M.clearCache=function(a$t){var a$k,a$v=a$M.framesMap,a$j=a$t+"#";for(a$k in a$v)a$k!==a$t&&0!=a$k.indexOf(a$j)||delete a$M.framesMap[a$k]},a$M.framesMap={}}(a$Rt),function(a$t){function a$u(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,a$u.__super.call(this),null==a$u._sortIndexFun&&(a$u._sortIndexFun=a$F.sortByKey("index",!1,!0))}a$w(a$u,"laya.display.FrameAnimation",a$t);var a$k=a$u.prototype;return a$k._setUp=function(a$t,a$k){this._labels=null,this._animationNewFrames=null,this._targetDic=a$t,this._animationData=a$k,this.interval=1e3/a$k.frameRate,a$k.parsed?(this._count=a$k.count,this._labels=a$k.labels,this._animationNewFrames=a$k.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),a$k.parsed=!0,a$k.labels=this._labels,a$k.count=this._count,a$k.animationNewFrames=this._animationNewFrames},a$k.clear=function(){a$t.prototype.clear.call(this),this._targetDic=null,this._animationData=null},a$k._displayToIndex=function(a$t){if(this._animationData){a$t<0&&(a$t=0),a$t>this._count&&(a$t=this._count);var a$k=this._animationData.nodes,a$v=0,a$j=a$k.length;for(a$v=0;a$v<a$j;a$v++)this._displayNodeToFrame(a$k[a$v],a$t)}},a$k._displayNodeToFrame=function(a$t,a$k,a$v){a$v||(a$v=this._targetDic);var a$j=a$v[a$t.target];if(a$j){var a$Q,a$u,a$S,a$V=a$t.frames,a$J=a$t.keys,a$W=0,a$w=a$J.length;for(a$W=0;a$W<a$w;a$W++)a$S=(a$u=a$V[a$Q=a$J[a$W]]).length>a$k?a$u[a$k]:a$u[a$u.length-1],a$j[a$Q]=a$S}},a$k._calculateDatas=function(){if(this._animationData){var a$t,a$k=this._animationData.nodes,a$v=0,a$j=a$k.length;for(a$v=this._count=0;a$v<a$j;a$v++)a$t=a$k[a$v],this._calculateNodeKeyFrames(a$t);this._count+=1}},a$k._calculateNodeKeyFrames=function(a$t){var a$k,a$v,a$j=a$t.keyframes,a$Q=a$t.target;for(a$k in a$t.frames||(a$t.frames={}),a$t.keys?a$t.keys.length=0:a$t.keys=[],a$t.initValues||(a$t.initValues={}),a$j)a$v=a$j[a$k],a$t.frames[a$k]||(a$t.frames[a$k]=[]),this._targetDic&&this._targetDic[a$Q]&&(a$t.initValues[a$k]=this._targetDic[a$Q][a$k]),a$v.sort(a$u._sortIndexFun),a$t.keys.push(a$k),this._calculateNodePropFrames(a$v,a$t.frames[a$k],a$k,a$Q)},a$k.resetToInitState=function(){if(this._targetDic&&this._animationData){var a$t,a$k,a$v=this._animationData.nodes,a$j=0,a$Q=a$v.length;for(a$j=0;a$j<a$Q;a$j++)if(a$k=(a$t=a$v[a$j]).initValues){var a$u,a$S=this._targetDic[a$t.target];if(a$S)for(a$u in a$k)a$S[a$u]=a$k[a$u]}}},a$k._calculateNodePropFrames=function(a$t,a$k,a$v,a$j){var a$Q=0,a$u=a$t.length-1;if(0<a$u){for(a$k.length=a$t[a$u].index+1,a$Q=0;a$Q<a$u;a$Q++)this._dealKeyFrame(a$t[a$Q]),this._calculateFrameValues(a$t[a$Q],a$t[a$Q+1],a$k);this._dealKeyFrame(a$t[a$Q])}0==a$u&&(a$k[a$t[0].index]=a$t[0].value,this._animationNewFrames&&(this._animationNewFrames[a$t[0].index]=!0))},a$k._dealKeyFrame=function(a$t){a$t.label&&""!=a$t.label&&this.addLabel(a$t.label,a$t.index)},a$k._calculateFrameValues=function(a$t,a$k,a$v){var a$j,a$Q=0,a$u=a$t.index,a$S=a$k.index,a$V=a$t.value,a$J=a$k.value-a$t.value,a$W=a$S-a$u;if(a$S>this._count&&(this._count=a$S),a$t.tween)for(null==(a$j=a$b[a$t.tweenMethod])&&(a$j=a$b.linearNone),a$Q=a$u;a$Q<a$S;a$Q++)a$v[a$Q]=a$j(a$Q-a$u,a$V,a$J,a$W),this._animationNewFrames&&(this._animationNewFrames[a$Q]=!0);else for(a$Q=a$u;a$Q<a$S;a$Q++)a$v[a$Q]=a$V;this._animationNewFrames&&(this._animationNewFrames[a$t.index]=!0,this._animationNewFrames[a$k.index]=!0),a$v[a$k.index]=a$k.value},a$u._sortIndexFun=null,a$u}(a$Rt)),a$Xt=function(a$k){function a$Q(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",a$Q.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=a$ht.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}a$w(a$Q,"laya.display.Input",a$k);var a$t=a$Q.prototype;return a$t.setSelection=function(a$t,a$k){this.focus=!0,laya.display.Input.inputElement.selectionStart=a$t,laya.display.Input.inputElement.selectionEnd=a$k},a$t._onUnDisplay=function(a$t){this.focus=!1},a$t._onMouseDown=function(a$t){this.focus=!0},a$t._syncInputTransform=function(){var a$t=this.nativeInput,a$k=a$g.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),a$v=this._width-this.padding[1]-this.padding[3],a$j=this._height-this.padding[0]-this.padding[2];a$c.isConchApp?(a$t.setScale(a$k.scaleX,a$k.scaleY),a$t.setSize(a$v,a$j),a$t.setPos(a$k.x,a$k.y)):(a$Q.inputContainer.style.transform=a$Q.inputContainer.style.webkitTransform="scale("+a$k.scaleX+","+a$k.scaleY+") rotate("+a$d.stage.canvasDegree+"deg)",a$t.style.width=a$v+"px",a$t.style.height=a$j+"px",a$Q.inputContainer.style.left=a$k.x+"px",a$Q.inputContainer.style.top=a$k.y+"px")},a$t.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},a$t._setInputMethod=function(){a$Q.input.parentElement&&a$Q.inputContainer.removeChild(a$Q.input),a$Q.area.parentElement&&a$Q.inputContainer.removeChild(a$Q.area),a$Q.inputElement=this._multiline?a$Q.area:a$Q.input,a$Q.inputContainer.appendChild(a$Q.inputElement),a$ht.RightToLeft&&(a$Q.inputElement.style.direction="rtl")},a$t._focusIn=function(){laya.display.Input.isInputting=!0;var a$t=this.nativeInput;this._focus=!0;var a$k=a$t.style;a$k.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),a$t.readOnly=!this._editable,a$c.isConchApp&&(a$t.setType(this._type),a$t.setForbidEdit(!this._editable)),a$t.maxLength=this._maxChars;this.padding;if(a$t.type=this._type,a$t.value=this._content,a$t.placeholder=this._prompt,a$d.stage.off("keydown",this,this._onKeyDown),a$d.stage.on("keydown",this,this._onKeyDown),(a$d.stage.focus=this).event("focus"),a$_.onPC&&a$t.focus(),!a$_.onMiniGame){this._text;this._text=null}this.typeset(),a$t.setColor(this._originColor),a$t.setFontSize(this.fontSize),a$t.setFontFace(a$_.onIPhone&&a$ht._fontFamilyMap[this.font]||this.font),a$c.isConchApp&&a$t.setMultiAble&&a$t.setMultiAble(this._multiline),a$k.lineHeight=this.leading+this.fontSize+"px",a$k.fontStyle=this.italic?"italic":"normal",a$k.fontWeight=this.bold?"bold":"normal",a$k.textAlign=this.align,a$k.padding="0 0",this._syncInputTransform(),!a$c.isConchApp&&a$_.onPC&&a$d.timer.frameLoop(1,this,this._syncInputTransform)},a$t._setPromptColor=function(){(a$Q.promptStyleDOM=a$_.getElementById("promptStyle"))||((a$Q.promptStyleDOM=a$_.createElement("style")).setAttribute("id","promptStyle"),a$_.document.head.appendChild(a$Q.promptStyleDOM)),a$Q.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},a$t._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(a$d.superSet(a$ht,this,"text",this._content),a$d.superSet(a$ht,this,"color",this._originColor)):(a$d.superSet(a$ht,this,"text",this._prompt),a$d.superSet(a$ht,this,"color",this._promptColor)),a$d.stage.off("keydown",this,this._onKeyDown),a$d.stage.focus=null,this.event("blur"),a$c.isConchApp&&this.nativeInput.blur(),a$_.onPC&&a$d.timer.clear(this,this._syncInputTransform)},a$t._onKeyDown=function(a$t){13===a$t.keyCode&&(a$_.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},a$t.changeText=function(a$t){this._content=a$t,this._focus?(this.nativeInput.value=a$t||"",this.event("change")):a$k.prototype.changeText.call(this,a$t)},a$A(0,a$t,"color",a$k.prototype._$get_color,function(a$t){this._focus&&this.nativeInput.setColor(a$t),a$d.superSet(a$ht,this,"color",this._content?a$t:this._promptColor),this._originColor=a$t}),a$A(0,a$t,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(a$t){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),a$A(0,a$t,"multiline",function(){return this._multiline},function(a$t){this._multiline=a$t,this.valign=a$t?"top":"middle"}),a$A(0,a$t,"maxChars",function(){return this._maxChars},function(a$t){a$t<=0&&(a$t=1e5),this._maxChars=a$t}),a$A(0,a$t,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(a$t){a$d.superSet(a$ht,this,"color",this._originColor),a$t+="",this._focus?(this.nativeInput.value=a$t||"",this.event("change")):(this._multiline||(a$t=a$t.replace(/\r?\n/g,"")),(this._content=a$t)?a$d.superSet(a$ht,this,"text",a$t):(a$d.superSet(a$ht,this,"text",this._prompt),a$d.superSet(a$ht,this,"color",this.promptColor)))}),a$A(0,a$t,"nativeInput",function(){return this._multiline?a$Q.area:a$Q.input}),a$A(0,a$t,"prompt",function(){return this._prompt},function(a$t){!this._text&&a$t&&a$d.superSet(a$ht,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?a$d.superSet(a$ht,this,"text",this._text==this._prompt?a$t:this._text):a$d.superSet(a$ht,this,"text",a$t),this._prompt=a$ht.langPacks&&a$ht.langPacks[a$t]?a$ht.langPacks[a$t]:a$t}),a$A(0,a$t,"focus",function(){return this._focus},function(a$t){var a$k=this.nativeInput;this._focus!==a$t&&(a$t?(a$k.target?a$k.target._focusOut():this._setInputMethod(),(a$k.target=this)._focusIn()):(a$k.target=null,this._focusOut(),a$_.document.body.scrollTop=0,a$k.blur(),a$c.isConchApp?a$k.setPos(-1e4,-1e4):a$Q.inputContainer.contains(a$k)&&a$Q.inputContainer.removeChild(a$k)))}),a$A(0,a$t,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(a$t){a$t?(-1<(a$t="[^"+a$t+"]").indexOf("^^")&&(a$t=a$t.replace("^^","")),this._restrictPattern=new RegExp(a$t,"g")):this._restrictPattern=null}),a$A(0,a$t,"editable",function(){return this._editable},function(a$t){this._editable=a$t,a$c.isConchApp&&a$Q.input.setForbidEdit(!a$t)}),a$A(0,a$t,"promptColor",function(){return this._promptColor},function(a$t){this._promptColor=a$t,this._content||a$d.superSet(a$ht,this,"color",a$t)}),a$A(0,a$t,"type",function(){return this._type},function(a$t){this._getCSSStyle().password="password"==a$t,this._type=a$t,a$c.isConchApp&&this.nativeInput.setType(a$t)}),a$A(0,a$t,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(a$t){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),a$A(0,a$t,"asPassword",function(){return this._getCSSStyle().password},function(a$t){this._getCSSStyle().password=a$t,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),a$Q.__init__=function(){a$Q._createInputElement(),a$_.onMobile&&a$c.canvas.addEventListener(a$Q.IOS_IFRAME?a$_.onMiniGame?"touchend":"click":"touchend",a$Q._popupInputMethod)},a$Q._popupInputMethod=function(a$t){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},a$Q._createInputElement=function(){a$Q._initInput(a$Q.area=a$_.createElement("textarea")),a$Q._initInput(a$Q.input=a$_.createElement("input")),(a$Q.inputContainer=a$_.createElement("div")).style.position="absolute",a$Q.inputContainer.style.zIndex=1e5,a$_.container.appendChild(a$Q.inputContainer),a$Q.inputContainer.setPos=function(a$t,a$k){a$Q.inputContainer.style.left=a$t+"px",a$Q.inputContainer.style.top=a$k+"px"}},a$Q._initInput=function(a$k){var a$t=a$k.style;a$t.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",a$t.resize="none",a$t.backgroundColor="transparent",a$t.border="none",a$t.outline="none",a$t.zIndex=1,a$k.addEventListener("input",a$Q._processInputting),a$k.addEventListener("mousemove",a$Q._stopEvent),a$k.addEventListener("mousedown",a$Q._stopEvent),a$k.addEventListener("touchmove",a$Q._stopEvent),a$k.setFontFace=function(a$t){a$k.style.fontFamily=a$t},a$c.isConchApp||(a$k.setColor=function(a$t){a$k.style.color=a$t},a$k.setFontSize=function(a$t){a$k.style.fontSize=a$t+"px"})},a$Q._processInputting=function(a$t){var a$k=laya.display.Input.inputElement.target;if(a$k){var a$v=laya.display.Input.inputElement.value;a$k._restrictPattern&&(a$v=a$v.replace(/\u2006|\x27/g,""),a$k._restrictPattern.test(a$v)&&(a$v=a$v.replace(a$k._restrictPattern,""),laya.display.Input.inputElement.value=a$v)),a$k._text=a$v,a$k.event("input")}},a$Q._stopEvent=function(a$t){"touchmove"==a$t.type&&a$t.preventDefault(),a$t.stopPropagation&&a$t.stopPropagation()},a$Q.TYPE_TEXT="text",a$Q.TYPE_PASSWORD="password",a$Q.TYPE_EMAIL="email",a$Q.TYPE_URL="url",a$Q.TYPE_NUMBER="number",a$Q.TYPE_RANGE="range",a$Q.TYPE_DATE="date",a$Q.TYPE_MONTH="month",a$Q.TYPE_WEEK="week",a$Q.TYPE_TIME="time",a$Q.TYPE_DATE_TIME="datetime",a$Q.TYPE_DATE_TIME_LOCAL="datetime-local",a$Q.TYPE_SEARCH="search",a$Q.input=null,a$Q.area=null,a$Q.inputElement=null,a$Q.inputContainer=null,a$Q.confirmButton=null,a$Q.promptStyleDOM=null,a$Q.inputHeight=45,a$Q.isInputting=!1,a$Q.stageMatrix=null,a$J(a$Q,["IOS_IFRAME",function(){return this.IOS_IFRAME=a$_.onIOS&&a$_.window.top!=a$_.window.self}]),a$Q}(a$ht),a$Ft=function(a$t){function a$v(a$t,a$k){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,a$v.__super.call(this),a$t&&this._init_(a$t,a$k)}a$w(a$v,"laya.resource.HTMLImage",a$ot);var a$k=a$v.prototype;return a$k._init_=function(a$t,a$k){this._src=a$t,this._source=new a$_.window.Image,a$k&&(a$k.onload&&(this.onload=a$k.onload),a$k.onerror&&(this.onerror=a$k.onerror),a$k.onCreate&&a$k.onCreate(this)),0!=a$t.indexOf("data:image")&&(this._source.crossOrigin=""),a$t&&(this._source.src=a$t)},a$k.recreateResource=function(){var a$t=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var a$k=this;this._source=new a$_.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(a$k._needReleaseAgain)return a$k._needReleaseAgain=!1,a$k._source.onload=null,void(a$k._source=null);a$k._source.onload=null,a$k.memorySize=a$t._w*a$t._h*4,a$k._recreateLock=!1,a$k.completeCreate()},this._source.src=this._src}},a$k.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},a$k.onresize=function(){this._w=this._source.width,this._h=this._source.height},a$A(0,a$k,"onload",null,function(a$t){var a$k=this;this._onload=a$t,this._source&&(this._source.onload=null!=this._onload?function(){a$k.onresize(),a$k._onload()}:null)}),a$A(0,a$k,"onerror",null,function(a$t){var a$k=this;this._onerror=a$t,this._source&&(this._source.onerror=null!=this._onerror?function(){a$k._onerror()}:null)}),a$A(0,a$k,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(a$t){this._enableMerageInAtlas=a$t,a$c.isConchApp&&this._source&&(this._source.enableMerageInAtlas=a$t)}),a$v.create=function(a$t,a$k){return new a$v(a$t,a$k)},a$v}(),a$dt=(function(a$u){function a$t(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,a$t.__super.call(this)}a$w(a$t,"laya.display.EffectAnimation",a$u);var a$k=a$t.prototype;a$k._onOtherBegin=function(a$t){a$t!=this&&this.stop()},a$k.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},a$k._onPlayAction=function(){this.play(0,!1)},a$k.play=function(a$t,a$k,a$v,a$j){void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=!0),void 0===a$v&&(a$v=""),void 0===a$j&&(a$j=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,a$t,a$k,a$v,a$j))},a$k._recordInitData=function(){if(this._aniKeys){var a$t,a$k,a$v=0;for(a$t=this._aniKeys.length,a$v=0;a$v<a$t;a$v++)a$k=this._aniKeys[a$v],this._initData[a$k]=this._target[a$k]}},a$k._displayToIndex=function(a$t){if(this._animationData){a$t<0&&(a$t=0),a$t>this._count&&(a$t=this._count);var a$k=this._animationData.nodes,a$v=0,a$j=a$k.length;for(a$j=1<a$j?1:a$j,a$v=0;a$v<a$j;a$v++)this._displayNodeToFrame(a$k[a$v],a$t)}},a$k._displayNodeToFrame=function(a$t,a$k,a$v){if(this._target){var a$j;a$j=this._target;var a$Q,a$u,a$S,a$V,a$J=a$t.frames,a$W=a$t.keys,a$w=0,a$M=a$W.length;a$V=a$t.secondFrames;var a$H,a$E,a$A,a$R,a$h=0;for(a$w=0;a$w<a$M;a$w++)a$u=a$J[a$Q=a$W[a$w]],a$S=-1==(a$h=a$V[a$Q])?this._initData[a$Q]:a$k<a$h?(a$A=(a$E=a$t.keyframes[a$Q])[0]).tween?(null==(a$H=a$b[a$A.tweenMethod])&&(a$H=a$b.linearNone),a$R=a$E[1],a$H(a$k,this._initData[a$Q],a$R.value-this._initData[a$Q],a$R.index)):this._initData[a$Q]:a$u.length>a$k?a$u[a$k]:a$u[a$u.length-1],a$j[a$Q]=a$S}},a$k._calculateNodeKeyFrames=function(a$t){a$u.prototype._calculateNodeKeyFrames.call(this,a$t);var a$k,a$v,a$j,a$Q=a$t.keyframes;a$t.target;for(a$k in a$j={},a$t.secondFrames=a$j,a$Q)(a$v=a$Q[a$k]).length<=1?a$j[a$k]=-1:a$j[a$k]=a$v[1].index},a$A(0,a$k,"target",function(){return this._target},function(a$t){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=a$t,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),a$A(0,a$k,"playEvent",null,function(a$t){(this._playEvents=a$t)&&this.addEvent()}),a$A(0,a$k,"effectData",null,function(a$t){var a$k;a$t&&((a$k=a$t.animations)&&a$k[0]&&(this._setUp({},a$k[0]),a$k[0].nodes&&a$k[0].nodes[0]&&(this._aniKeys=a$k[0].nodes[0].keys)))}),a$A(0,a$k,"effectClass",null,function(a$t){var a$k,a$v;(this._effectClass=a$i.getClass(a$t),this._effectClass)&&((a$k=this._effectClass.uiView)&&(a$v=a$k.animations)&&a$v[0]&&(this._setUp({},a$v[0]),a$v[0].nodes&&a$v[0].nodes[0]&&(this._aniKeys=a$v[0].nodes[0].keys)))}),a$t.EffectAnimationBegin="effectanimationbegin"}(a$ft),function(a$k){var a$K;function a$U(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,a$U.__super.call(this)}a$w(a$U,"laya.utils.GraphicAnimation",a$k);var a$t=a$U.prototype;return a$t._parseNodeList=function(a$t){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[a$t.compId]=a$t.props,a$t.compId&&this._nodeList.push(a$t.compId);var a$k=a$t.child;if(a$k){var a$v=0,a$j=a$k.length;for(a$v=0;a$v<a$j;a$v++)this._parseNodeList(a$k[a$v])}},a$t._calGraphicData=function(a$t){var a$k;if(this._setUp(null,a$t),this._createGraphicData(),this._nodeIDAniDic)for(a$k in this._nodeIDAniDic)this._nodeIDAniDic[a$k]=null},a$t._createGraphicData=function(){var a$t,a$k=[],a$v=0,a$j=this.count,a$Q=this._animationNewFrames;for(a$Q||(a$Q=[]),a$v=0;a$v<a$j;a$v++)!a$Q[a$v]&&a$t||(a$t=this._createFrameGraphic(a$v)),a$k.push(a$t);this._gList=a$k},a$t._createFrameGraphic=function(a$t){var a$k=a$N.createGraphics();return a$U._rootMatrix||(a$U._rootMatrix=new a$a),this._updateNodeGraphic(this._rootNode,a$t,a$U._rootMatrix,a$k),a$k},a$t._updateNodeGraphic=function(a$t,a$k,a$v,a$j,a$Q){var a$u;void 0===a$Q&&(a$Q=1);var a$S,a$V,a$J,a$W=(a$u=this._nodeGDic[a$t.compId]=this._getNodeGraphicData(a$t.compId,a$k,this._nodeGDic[a$t.compId])).alpha*a$Q;if(!(a$W<.01)&&(a$u.resultTransform||(a$u.resultTransform=a$a.create()),a$S=a$u.resultTransform,a$a.mul(a$u.transform,a$v,a$S),a$u.skin&&(a$V=this._getTextureByUrl(a$u.skin))&&(a$S._checkTransform()?(a$j.drawTexture(a$V,0,0,a$u.width,a$u.height,a$S,a$W),a$u.resultTransform=null):a$j.drawTexture(a$V,a$S.tx,a$S.ty,a$u.width,a$u.height,null,a$W)),a$J=a$t.child)){var a$w,a$M=0;for(a$w=a$J.length,a$M=0;a$M<a$w;a$M++)this._updateNodeGraphic(a$J[a$M],a$k,a$S,a$j,a$W)}},a$t._updateNoChilds=function(a$t,a$k){if(a$t.skin){var a$v=this._getTextureByUrl(a$t.skin);if(a$v){var a$j=a$t.transform;a$j._checkTransform();!a$j.bTransform?a$k.drawTexture(a$v,a$j.tx,a$j.ty,a$t.width,a$t.height,null,a$t.alpha):a$k.drawTexture(a$v,0,0,a$t.width,a$t.height,a$j.clone(),a$t.alpha)}}},a$t._updateNodeGraphic2=function(a$t,a$k,a$v){var a$j;if(a$j=this._nodeGDic[a$t.compId]=this._getNodeGraphicData(a$t.compId,a$k,this._nodeGDic[a$t.compId]),a$t.child){var a$Q=a$j.transform;a$Q._checkTransform();var a$u,a$S;a$S=(a$u=!a$Q.bTransform)&&(0!=a$Q.tx||0!=a$Q.ty);var a$V,a$J,a$W;if((a$V=a$Q.bTransform||1!=a$j.alpha)&&a$v.save(),1!=a$j.alpha&&a$v.alpha(a$j.alpha),a$u?a$S&&a$v.translate(a$Q.tx,a$Q.ty):a$v.transform(a$Q.clone()),a$J=a$t.child,a$j.skin&&(a$W=this._getTextureByUrl(a$j.skin))&&a$v.drawTexture(a$W,0,0,a$j.width,a$j.height),a$J){var a$w,a$M=0;for(a$w=a$J.length,a$M=0;a$M<a$w;a$M++)this._updateNodeGraphic2(a$J[a$M],a$k,a$v)}a$V?a$v.restore():a$u?a$S&&a$v.translate(-a$Q.tx,-a$Q.ty):a$v.transform(a$Q.clone().invert())}else this._updateNoChilds(a$j,a$v)},a$t._calculateNodeKeyFrames=function(a$t){a$k.prototype._calculateNodeKeyFrames.call(this,a$t),this._nodeIDAniDic[a$t.target]=a$t},a$t.getNodeDataByID=function(a$t){return this._nodeIDAniDic[a$t]},a$t._getParams=function(a$t,a$k,a$v,a$j){var a$Q=a$U._temParam;a$Q.length=a$k.length;var a$u=0,a$S=a$k.length;for(a$u=0;a$u<a$S;a$u++)a$Q[a$u]=this._getObjVar(a$t,a$k[a$u][0],a$v,a$k[a$u][1],a$j);return a$Q},a$t._getObjVar=function(a$t,a$k,a$v,a$j,a$Q){if(a$t.hasOwnProperty(a$k)){var a$u=a$t[a$k];if(a$v>=a$u.length&&(a$v=a$u.length-1),null!=a$t[a$k][a$v])return a$t[a$k][a$v]}return a$Q.hasOwnProperty(a$k)?a$Q[a$k]:a$j},a$t._getNodeGraphicData=function(a$t,a$k,a$v){a$v||(a$v=a$K.create()),a$v.transform?a$v.transform.identity():a$v.transform=a$a.create();var a$j=this.getNodeDataByID(a$t);if(!a$j)return a$v;var a$Q,a$u,a$S=a$j.frames,a$V=this._getParams(a$S,a$U._drawTextureCmd,a$k,this._nodeDefaultProps[a$t]),a$J=a$V[0],a$W=NaN,a$w=NaN,a$M=a$V[5],a$H=a$V[6],a$E=a$V[13],a$A=a$V[14],a$R=a$V[7],a$h=a$V[8],a$l=a$V[9],a$o=a$V[11],a$Y=a$V[12];a$W=a$V[3],a$w=a$V[4],0!=a$W&&0!=a$w||(a$J=null),-1==a$W&&(a$W=0),-1==a$w&&(a$w=0),a$v.skin=a$J,a$v.width=a$W,a$v.height=a$w,a$J&&((a$Q=this._getTextureByUrl(a$J))?(a$W||(a$W=a$Q.sourceWidth),a$w||(a$w=a$Q.sourceHeight)):console.warn("lost skin:",a$J,",you may load pics first")),a$v.alpha=a$V[10],a$u=a$v.transform,0!=a$E&&(a$M=a$E*a$W),0!=a$A&&(a$H=a$A*a$w),0==a$M&&0==a$H||a$u.translate(-a$M,-a$H);var a$f=null;if(a$l||1!==a$R||1!==a$h||a$o||a$Y){(a$f=a$U._tempMt).identity(),a$f.bTransform=!0;var a$X=.0174532922222222*(a$l-a$o),a$F=.0174532922222222*(a$l+a$Y),a$d=Math.cos(a$F),a$m=Math.sin(a$F),a$Z=Math.sin(a$X),a$s=Math.cos(a$X);a$f.a=a$R*a$d,a$f.b=a$R*a$m,a$f.c=-a$h*a$Z,a$f.d=a$h*a$s,a$f.tx=a$f.ty=0}return a$f&&(a$u=a$a.mul(a$u,a$f,a$u)),a$u.translate(a$V[1],a$V[2]),a$v},a$t._getTextureByUrl=function(a$t){return a$Vt.getRes(a$t)},a$t.setAniData=function(a$t,a$k){if(a$t.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=a$t,this._parseNodeList(a$t);var a$v,a$j={},a$Q=[],a$u=a$t.animations,a$S=0,a$V=a$u.length;for(a$S=0;a$S<a$V;a$S++)if(a$v=a$u[a$S],this._labels=null,(!a$k||a$k==a$v.name)&&a$v){try{this._calGraphicData(a$v)}catch(a$t){console.warn("parse animation fail:"+a$v.name+",empty animation created"),this._gList=[]}var a$J={};a$J.interval=1e3/a$v.frameRate,a$J.frames=this._gList,a$J.labels=this._labels,a$J.name=a$v.name,a$Q.push(a$J),a$j[a$v.name]=a$J}this.animationList=a$Q,this.animationDic=a$j}a$U._temParam.length=0},a$t.parseByData=function(a$t){var a$k,a$v;a$k=a$t.nodeRoot,a$v=a$t.aniO,delete a$t.nodeRoot,delete a$t.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=a$k,this._parseNodeList(a$k),this._labels=null;try{this._calGraphicData(a$v)}catch(a$t){console.warn("parse animation fail:"+a$v.name+",empty animation created"),this._gList=[]}var a$j=a$t;return a$j.interval=1e3/a$v.frameRate,a$j.frames=this._gList,a$j.labels=this._labels,a$j.name=a$v.name,a$j},a$t.setUpAniData=function(a$t){if(a$t.animations){var a$k,a$v={},a$j=[],a$Q=a$t.animations,a$u=0,a$S=a$Q.length;for(a$u=0;a$u<a$S;a$u++)if(a$k=a$Q[a$u]){var a$V={};a$V.name=a$k.name,a$V.aniO=a$k,a$V.nodeRoot=a$t,a$j.push(a$V),a$v[a$k.name]=a$V}this.animationList=a$j,this.animationDic=a$v}},a$t._clear=function(){var a$t,a$k;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(a$t in this._nodeGDic)(a$k=this._nodeGDic[a$t])&&a$k.recover();this._nodeGDic=null},a$U.parseAnimationByData=function(a$t){var a$k;return a$U._I||(a$U._I=new a$U),a$k=a$U._I.parseByData(a$t),a$U._I._clear(),a$k},a$U.parseAnimationData=function(a$t){var a$k;return a$U._I||(a$U._I=new a$U),a$U._I.setUpAniData(a$t),(a$k={}).animationList=a$U._I.animationList,a$k.animationDic=a$U._I.animationDic,a$U._I._clear(),a$k},a$U._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],a$U._temParam=[],a$U._I=null,a$U._rootMatrix=null,a$J(a$U,["_tempMt",function(){return this._tempMt=new a$a}]),a$U.__init$=function(){a$K=function(){function a$t(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return a$w(a$t,""),a$t.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),a$C.recover("GraphicNode",this)},a$t.create=function(){return a$C.getItemByClass("GraphicNode",a$t)},a$t}()},a$U}(a$ft));a$d.__init([a$W,a$Jt,a$c,a$_,a$e,a$s,a$t,a$dt])}(window,document,Laya),function(a$t,a$k,a$v){a$v.un,a$v.uns,a$v.static;var a$j=a$v.class;a$v.getset,a$v.__newvec;new(function(){function a$t(){}return a$j(a$t,"LayaMain"),a$t}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(a$t,a$k){"use strict";for(var a$v in Object.defineProperty(a$k,"__esModule",{value:!0}),Laya){var a$j=Laya[a$v];a$j&&a$j.__isclass&&(a$k[a$v]=a$j)}}),function(a$t,a$k,a$F){a$F.un,a$F.uns;var a$S=a$F.static,a$H=a$F.class,a$j=a$F.getset,a$u=a$F.__newvec,a$w=laya.maths.Arith,a$M=laya.maths.Bezier,a$v=laya.resource.Bitmap,a$E=laya.utils.Browser,a$J=laya.utils.Byte,a$A=laya.utils.Color,a$d=(laya.filters.ColorFilter,a$F.Config),a$Q=laya.resource.Context,a$m=(laya.events.Event,laya.filters.Filter),a$V=laya.display.Graphics,a$W=laya.resource.HTMLCanvas,a$R=(laya.utils.HTMLChar,laya.resource.HTMLImage),a$h=laya.resource.HTMLSubImage,a$Z=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),a$s=laya.maths.Point,a$K=laya.maths.Rectangle,a$l=laya.renders.Render,a$o=(laya.renders.RenderContext,laya.renders.RenderSprite),a$Y=laya.resource.Resource,a$f=laya.resource.ResourceManager,a$X=laya.utils.RunDriver,a$U=laya.display.Sprite,a$N=laya.display.Stage,a$a=laya.utils.Stat,a$z=laya.utils.StringKey,a$G=(laya.display.css.Style,laya.system.System),a$c=laya.display.Text,a$T=laya.resource.Texture,a$p=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),a$O=laya.utils.VectorGraphManager;laya.utils.WordText;a$F.interface("laya.webgl.shapes.IShape"),a$F.interface("laya.webgl.submit.ISubmit"),a$F.interface("laya.webgl.text.ICharSegment"),a$F.interface("laya.webgl.canvas.save.ISaveData"),a$F.interface("laya.webgl.resource.IMergeAtlasBitmap"),a$F.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var a$n=function(){function a$t(){}a$H(a$t,"laya.filters.webgl.FilterActionGL");var a$k=a$t.prototype;return a$F.imps(a$k,{"laya.filters.IFilterActionGL":!0}),a$k.setValue=function(a$t){},a$k.setValueMix=function(a$t){},a$k.apply3d=function(a$t,a$k,a$v,a$j,a$Q){return null},a$k.apply=function(a$t){return null},a$j(0,a$k,"typeMix",function(){return 0}),a$t}(),a$_=function(){function a$t(){}return a$H(a$t,"laya.webgl.shader.ShaderValue"),a$t}(),a$x=function(){var a$j,a$Q;function a$t(a$t,a$k,a$v){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new a$Q,void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),this._cells=null,this._rowInfo=null,this._init(a$t,a$k),this._atlasID=a$v}a$H(a$t,"laya.webgl.atlas.AtlasGrid");var a$k=a$t.prototype;return a$k.getAltasID=function(){return this._atlasID},a$k.setAltasID=function(a$t){0<=a$t&&(this._atlasID=a$t)},a$k.addTex=function(a$t,a$k,a$v){var a$j=this._get(a$k,a$v);return 0==a$j.ret||(this._fill(a$j.x,a$j.y,a$k,a$v,a$t),this._texCount++),a$j},a$k._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},a$k._init=function(a$t,a$k){if(this._width=a$t,this._height=a$k,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=a$u(this._height);for(var a$v=0;a$v<this._height;a$v++)this._rowInfo[a$v]=new a$j;return this._clear(),!0},a$k._get=function(a$t,a$k){var a$v=new a$i;if(a$t>=this._failSize.width&&a$k>=this._failSize.height)return a$v;for(var a$j=-1,a$Q=-1,a$u=this._width,a$S=this._height,a$V=this._cells,a$J=0;a$J<a$S;a$J++)if(!(this._rowInfo[a$J].spaceCount<a$t))for(var a$W=0;a$W<a$u;){var a$w=3*(a$J*a$u+a$W);if(0!=a$V[a$w]||a$V[1+a$w]<a$t||a$V[2+a$w]<a$k)a$W+=a$V[1+a$w];else{a$j=a$W,a$Q=a$J;for(var a$M=0;a$M<a$t;a$M++)if(a$V[3*a$M+a$w+2]<a$k){a$j=-1;break}if(!(a$j<0))return a$v.ret=!0,a$v.x=a$j,a$v.y=a$Q,a$v;a$W+=a$V[1+a$w]}}return a$v},a$k._fill=function(a$t,a$k,a$v,a$j,a$Q){var a$u=this._width,a$S=this._height;this._check(a$t+a$v<=a$u&&a$k+a$j<=a$S);for(var a$V=a$k;a$V<a$j+a$k;++a$V){this._check(this._rowInfo[a$V].spaceCount>=a$v),this._rowInfo[a$V].spaceCount-=a$v;for(var a$J=0;a$J<a$v;a$J++){var a$W=3*(a$t+a$V*a$u+a$J);this._check(0==this._cells[a$W]),this._cells[a$W]=a$Q,this._cells[1+a$W]=a$v,this._cells[2+a$W]=a$j}}if(0<a$t)for(a$V=0;a$V<a$j;++a$V){var a$w=0;for(a$J=a$t-1;0<=a$J&&0==this._cells[3*((a$k+a$V)*a$u+a$J)];--a$J,++a$w);for(a$J=a$w;0<a$J;--a$J)this._cells[3*((a$k+a$V)*a$u+a$t-a$J)+1]=a$J,this._check(0<a$J)}if(0<a$k)for(a$J=a$t;a$J<a$t+a$v;++a$J){for(a$w=0,a$V=a$k-1;0<=a$V&&0==this._cells[3*(a$J+a$V*a$u)];--a$V,a$w++);for(a$V=a$w;0<a$V;--a$V)this._cells[3*(a$J+(a$k-a$V)*a$u)+2]=a$V,this._check(0<a$V)}},a$k._check=function(a$t){0==a$t&&console.log("xtexMerger 错误啦")},a$k._clear=function(){for(var a$t=this._texCount=0;a$t<this._height;a$t++)this._rowInfo[a$t].spaceCount=this._width;for(var a$k=0;a$k<this._height;a$k++)for(var a$v=0;a$v<this._width;a$v++){var a$j=3*(a$k*this._width+a$v);this._cells[a$j]=0,this._cells[1+a$j]=this._width-a$v,this._cells[2+a$j]=this._width-a$k}this._failSize.width=this._width+1,this._failSize.height=this._height+1},a$t.__init$=function(){a$j=function(){function a$t(){this.spaceCount=0}return a$H(a$t,""),a$t}(),a$Q=function(){function a$t(){this.width=0,this.height=0}return a$H(a$t,""),a$t}()},a$t}(),a$I=function(){function a$l(a$t,a$k,a$v,a$j){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=a$t,this._height=a$k,this._gridSize=a$v,this._maxAtlaserCount=a$j,this._gridNumX=a$t/a$v,this._gridNumY=a$k/a$v,this._curAtlasIndex=0,this._atlaserArray=[]}a$H(a$l,"laya.webgl.atlas.AtlasResourceManager");var a$t=a$l.prototype;return a$t.setAtlasParam=function(a$t,a$k,a$v,a$j){if(1==this._setAtlasParam)return a$l._sid_=0,this._width=a$t,this._height=a$k,this._gridSize=a$v,this._maxAtlaserCount=a$j,this._gridNumX=a$t/a$v,this._gridNumY=a$k/a$v,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},a$t.pushData=function(a$t){var a$k,a$v=a$t.bitmap,a$j=-1,a$Q=null,a$u=0,a$S=0;for(a$u=0,a$k=this._atlaserArray.length;a$u<a$k&&(a$S=(this._curAtlasIndex+a$u)%a$k,-1==(a$j=(a$Q=this._atlaserArray[a$S]).findBitmapIsExist(a$v)));a$u++);if(-1!=a$j){var a$V=a$Q.InAtlasWebGLImagesOffsetValue[a$j];return a$A=a$V[0],a$R=a$V[1],a$Q.addToAtlas(a$t,a$A,a$R),!0}this._setAtlasParam=!1;for(var a$J=Math.ceil((a$t.bitmap.width+2)/this._gridSize),a$W=Math.ceil((a$t.bitmap.height+2)/this._gridSize),a$w=!1,a$M=0;a$M<2;a$M++){var a$H=this._maxAtlaserCount;for(a$u=0;a$u<a$H;a$u++){a$S=(this._curAtlasIndex+a$u)%a$H,this._atlaserArray.length-1>=a$S||this._atlaserArray.push(new a$Kt(this._gridNumX,this._gridNumY,this._width,this._height,a$l._sid_++));var a$E=this._atlaserArray[a$S],a$A=0,a$R=0,a$h=a$E.addTex(1,a$J,a$W);if(a$h.ret){a$A=a$h.x*this._gridSize+1,a$R=a$h.y*this._gridSize+1,a$v.lock=!0,a$E.addToAtlasTexture(a$v,a$A,a$R),a$E.addToAtlas(a$t,a$A,a$R),a$w=!0,this._curAtlasIndex=a$S;break}}if(a$w)break;this._atlaserArray.push(new a$Kt(this._gridNumX,this._gridNumY,this._width,this._height,a$l._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return a$w||console.log(">>>AtlasManager pushData error"),a$w},a$t.addToAtlas=function(a$t){laya.webgl.atlas.AtlasResourceManager.instance.pushData(a$t)},a$t.garbageCollection=function(){if(!0===this._needGC){for(var a$t=this._atlaserArray.length-this._maxAtlaserCount,a$k=0;a$k<a$t;a$k++)this._atlaserArray[a$k].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+a$t),this._atlaserArray.splice(0,a$t),this._needGC=!1}return!0},a$t.freeAll=function(){for(var a$t=0,a$k=this._atlaserArray.length;a$t<a$k;a$t++)this._atlaserArray[a$t].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},a$t.getAtlaserCount=function(){return this._atlaserArray.length},a$t.getAtlaserByIndex=function(a$t){return this._atlaserArray[a$t]},a$j(1,a$l,"instance",function(){return a$l._Instance||(a$l._Instance=new a$l(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),a$l._Instance}),a$j(1,a$l,"enabled",function(){return a$d.atlasEnable}),a$j(1,a$l,"atlasLimitWidth",function(){return a$l._atlasLimitWidth},function(a$t){a$l._atlasLimitWidth=a$t}),a$j(1,a$l,"atlasLimitHeight",function(){return a$l._atlasLimitHeight},function(a$t){a$l._atlasLimitHeight=a$t}),a$l._enable=function(){a$d.atlasEnable=!0},a$l._disable=function(){a$d.atlasEnable=!1},a$l.__init__=function(){a$l.atlasTextureWidth=2048,a$l.atlasTextureHeight=2048,a$l.maxTextureCount=6,a$l.atlasLimitWidth=512,a$l.atlasLimitHeight=512},a$l._atlasLimitWidth=0,a$l._atlasLimitHeight=0,a$l.gridSize=16,a$l.atlasTextureWidth=0,a$l.atlasTextureHeight=0,a$l.maxTextureCount=0,a$l._atlasRestore=0,a$l.BOARDER_TYPE_NO=0,a$l.BOARDER_TYPE_RIGHT=1,a$l.BOARDER_TYPE_LEFT=2,a$l.BOARDER_TYPE_BOTTOM=4,a$l.BOARDER_TYPE_TOP=8,a$l.BOARDER_TYPE_ALL=15,a$l._sid_=0,a$l._Instance=null,a$l}(),a$i=function(){function a$t(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return a$H(a$t,"laya.webgl.atlas.MergeFillInfo"),a$t}(),a$D=function(){function a$k(){}return a$H(a$k,"laya.webgl.canvas.BlendMode"),a$k._init_=function(a$t){a$k.fns=[a$k.BlendNormal,a$k.BlendAdd,a$k.BlendMultiply,a$k.BlendScreen,a$k.BlendOverlay,a$k.BlendLight,a$k.BlendMask,a$k.BlendDestinationOut],a$k.targetFns=[a$k.BlendNormalTarget,a$k.BlendAddTarget,a$k.BlendMultiplyTarget,a$k.BlendScreenTarget,a$k.BlendOverlayTarget,a$k.BlendLightTarget,a$k.BlendMask,a$k.BlendDestinationOut]},a$k.BlendNormal=function(a$t){a$t.blendFunc(1,771)},a$k.BlendAdd=function(a$t){a$t.blendFunc(1,772)},a$k.BlendMultiply=function(a$t){a$t.blendFunc(774,771)},a$k.BlendScreen=function(a$t){a$t.blendFunc(1,1)},a$k.BlendOverlay=function(a$t){a$t.blendFunc(1,769)},a$k.BlendLight=function(a$t){a$t.blendFunc(1,1)},a$k.BlendNormalTarget=function(a$t){a$t.blendFunc(1,771)},a$k.BlendAddTarget=function(a$t){a$t.blendFunc(1,772)},a$k.BlendMultiplyTarget=function(a$t){a$t.blendFunc(774,771)},a$k.BlendScreenTarget=function(a$t){a$t.blendFunc(1,1)},a$k.BlendOverlayTarget=function(a$t){a$t.blendFunc(1,769)},a$k.BlendLightTarget=function(a$t){a$t.blendFunc(1,1)},a$k.BlendMask=function(a$t){a$t.blendFunc(0,770)},a$k.BlendDestinationOut=function(a$t){a$t.blendFunc(0,0)},a$k.activeBlendFunction=null,a$k.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],a$k.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},a$k.NORMAL="normal",a$k.ADD="add",a$k.MULTIPLY="multiply",a$k.SCREEN="screen",a$k.LIGHT="light",a$k.OVERLAY="overlay",a$k.DESTINATIONOUT="destination-out",a$k.fns=[],a$k.targetFns=[],a$k}(),a$B=function(){function a$v(a$t){this._color=a$A.create("black"),this.setValue(a$t)}a$H(a$v,"laya.webgl.canvas.DrawStyle");var a$t=a$v.prototype;return a$t.setValue=function(a$t){if(a$t){if("string"==typeof a$t)return void(this._color=a$A.create(a$t));if(a$t instanceof laya.utils.Color)return void(this._color=a$t)}},a$t.reset=function(){this._color=a$A.create("black")},a$t.equal=function(a$t){return"string"==typeof a$t?this._color.strColor===a$t:a$t instanceof laya.utils.Color&&this._color.numColor===a$t.numColor},a$t.toColorStr=function(){return this._color.strColor},a$v.create=function(a$t){var a$k;if(a$t&&("string"==typeof a$t?a$k=a$A.create(a$t):a$t instanceof laya.utils.Color&&(a$k=a$t),a$k))return a$k._drawStyle||(a$k._drawStyle=new a$v(a$t));return laya.webgl.canvas.DrawStyle.DEFAULT},a$S(a$v,["DEFAULT",function(){return this.DEFAULT=new a$v("#000000")}]),a$v}(),a$b=function(){function a$t(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];a$ft.mainContext;this.ib=a$yt.create(35048),this.vb=a$Pt.create(5)}a$H(a$t,"laya.webgl.canvas.Path");var a$k=a$t.prototype;return a$k.addPoint=function(a$t,a$k){this.tempArray.push(a$t,a$k)},a$k.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},a$k.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},a$k.polygon=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S;return this.geomatrys.push(this._curGeomatry=a$S=new a$zt(a$t,a$k,a$v,a$j,a$Q,a$u)),a$j||(a$S.fill=!1),null==a$u&&(a$S.borderWidth=0),a$S},a$k.setGeomtry=function(a$t){this.geomatrys.push(this._curGeomatry=a$t)},a$k.drawLine=function(a$t,a$k,a$v,a$j,a$Q){var a$u;return this.closePath?this.geomatrys.push(this._curGeomatry=a$u=new a$at(a$t,a$k,a$v,a$j,a$Q)):this.geomatrys.push(this._curGeomatry=a$u=new a$Nt(a$t,a$k,a$v,a$j,a$Q)),a$u.fill=!1,a$u},a$k.update=function(){var a$t=this.ib._byteLength,a$k=this.geomatrys.length;this.offset=a$t;for(var a$v=this.geoStart;a$v<a$k;a$v++)this.geomatrys[a$v].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=a$k,this.count=(this.ib._byteLength-a$t)/a$Rt.BYTES_PIDX},a$k.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},a$k.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},a$t}(),a$q=function(){function a$V(){}a$H(a$V,"laya.webgl.canvas.save.SaveBase");var a$t=a$V.prototype;return a$F.imps(a$t,{"laya.webgl.canvas.save.ISaveData":!0}),a$t.isSaveMark=function(){return!1},a$t.restore=function(a$t){this._dataObj[this._valueName]=this._value,(a$V._cache[a$V._cache._length++]=this)._newSubmit&&(a$t._curSubmit=a$ut.RENDERBASE,a$t._renderKey=0)},a$V._createArray=function(){var a$t=[];return a$t._length=0,a$t},a$V._init=function(){var a$t=a$V._namemap={};return a$t[1]="ALPHA",a$t[2]="fillStyle",a$t[8]="font",a$t[256]="lineWidth",a$t[512]="strokeStyle",a$t[8192]="_mergeID",a$t[1024]=a$t[2048]=a$t[4096]=[],a$t[16384]="textBaseline",a$t[32768]="textAlign",a$t[65536]="_nBlendType",a$t[1048576]="shader",a$t[2097152]="filters",a$t},a$V.save=function(a$t,a$k,a$v,a$j){if((a$t._saveMark._saveuse&a$k)!==a$k){a$t._saveMark._saveuse|=a$k;var a$Q=a$V._cache,a$u=0<a$Q._length?a$Q[--a$Q._length]:new a$V;a$u._value=a$v[a$u._valueName=a$V._namemap[a$k]],a$u._dataObj=a$v,a$u._newSubmit=a$j;var a$S=a$t._save;a$S[a$S._length++]=a$u}},a$V._cache=laya.webgl.canvas.save.SaveBase._createArray(),a$V._namemap=a$V._init(),a$V}(),a$C=function(){function a$u(){this._clipRect=new a$K}a$H(a$u,"laya.webgl.canvas.save.SaveClipRect");var a$t=a$u.prototype;return a$F.imps(a$t,{"laya.webgl.canvas.save.ISaveData":!0}),a$t.isSaveMark=function(){return!1},a$t.restore=function(a$t){a$t._clipRect=this._clipSaveRect,(a$u._cache[a$u._cache._length++]=this)._submitScissor.submitLength=a$t._submits._length-this._submitScissor.submitIndex,a$t._curSubmit=a$ut.RENDERBASE,a$t._renderKey=0},a$u.save=function(a$t,a$k){if(131072!=(131072&a$t._saveMark._saveuse)){a$t._saveMark._saveuse|=131072;var a$v=a$u._cache,a$j=0<a$v._length?a$v[--a$v._length]:new a$u;a$j._clipSaveRect=a$t._clipRect,a$t._clipRect=a$j._clipRect.copyFrom(a$t._clipRect),a$j._submitScissor=a$k;var a$Q=a$t._save;a$Q[a$Q._length++]=a$j}},a$S(a$u,["_cache",function(){return this._cache=a$q._createArray()}]),a$u}(),a$L=function(){function a$E(){this._contextX=0,this._contextY=0,this._clipRect=new a$K,this._rect=new a$K,this._matrix=new a$Z}a$H(a$E,"laya.webgl.canvas.save.SaveClipRectStencil");var a$t=a$E.prototype;return a$F.imps(a$t,{"laya.webgl.canvas.save.ISaveData":!0}),a$t.isSaveMark=function(){return!1},a$t.restore=function(a$t){a$wt.restore(a$t,this._rect,this._saveMatrix,this._contextX,this._contextY),a$t._clipRect=this._clipSaveRect,a$t._curMat=this._saveMatrix,a$t._x=this._contextX,a$t._y=this._contextY,a$E._cache[a$E._cache._length++]=this,a$t._curSubmit=a$ut.RENDERBASE},a$E.save=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){if(262144!=(262144&a$t._saveMark._saveuse)){a$t._saveMark._saveuse|=262144;var a$w=a$E._cache,a$M=0<a$w._length?a$w[--a$w._length]:new a$E;a$M._clipSaveRect=a$t._clipRect,a$M._clipRect.setTo(a$S,a$V,a$J,a$W),a$t._clipRect=a$M._clipRect,a$M._rect.x=a$v,a$M._rect.y=a$j,a$M._rect.width=a$Q,a$M._rect.height=a$u,a$M._contextX=a$t._x,a$M._contextY=a$t._y,a$M._saveMatrix=a$t._curMat,a$t._curMat.copyTo(a$M._matrix),a$t._curMat=a$M._matrix,a$M._submitStencil=a$k;var a$H=a$t._save;a$H[a$H._length++]=a$M}},a$S(a$E,["_cache",function(){return this._cache=a$q._createArray()}]),a$E}(),a$e=function(){function a$j(){this._saveuse=0}a$H(a$j,"laya.webgl.canvas.save.SaveMark");var a$t=a$j.prototype;return a$F.imps(a$t,{"laya.webgl.canvas.save.ISaveData":!0}),a$t.isSaveMark=function(){return!0},a$t.restore=function(a$t){a$t._saveMark=this._preSaveMark,a$j._no[a$j._no._length++]=this},a$j.Create=function(a$t){var a$k=a$j._no,a$v=0<a$k._length?a$k[--a$k._length]:new a$j;return a$v._saveuse=0,a$v._preSaveMark=a$t._saveMark,a$t._saveMark=a$v},a$S(a$j,["_no",function(){return this._no=a$q._createArray()}]),a$j}(),a$r=function(){function a$u(){this._matrix=new a$Z}a$H(a$u,"laya.webgl.canvas.save.SaveTransform");var a$t=a$u.prototype;return a$F.imps(a$t,{"laya.webgl.canvas.save.ISaveData":!0}),a$t.isSaveMark=function(){return!1},a$t.restore=function(a$t){a$t._curMat=this._savematrix,a$u._no[a$u._no._length++]=this},a$u.save=function(a$t){var a$k=a$t._saveMark;if(2048!=(2048&a$k._saveuse)){a$k._saveuse|=2048;var a$v=a$u._no,a$j=0<a$v._length?a$v[--a$v._length]:new a$u;a$j._savematrix=a$t._curMat,a$t._curMat=a$t._curMat.copyTo(a$j._matrix);var a$Q=a$t._save;a$Q[a$Q._length++]=a$j}},a$S(a$u,["_no",function(){return this._no=a$q._createArray()}]),a$u}(),a$g=function(){function a$Q(){}a$H(a$Q,"laya.webgl.canvas.save.SaveTranslate");var a$t=a$Q.prototype;return a$F.imps(a$t,{"laya.webgl.canvas.save.ISaveData":!0}),a$t.isSaveMark=function(){return!1},a$t.restore=function(a$t){a$t._curMat;a$t._x=this._x,a$t._y=this._y,a$Q._no[a$Q._no._length++]=this},a$Q.save=function(a$t){var a$k=a$Q._no,a$v=0<a$k._length?a$k[--a$k._length]:new a$Q;a$v._x=a$t._x,a$v._y=a$t._y;var a$j=a$t._save;a$j[a$j._length++]=a$v},a$S(a$Q,["_no",function(){return this._no=a$q._createArray()}]),a$Q}(),a$$=function(){function a$t(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new a$K}a$H(a$t,"laya.webgl.resource.RenderTargetMAX");var a$k=a$t.prototype;return a$k.setSP=function(a$t){this._sp=a$t},a$k.size=function(a$t,a$k){var a$v=this;this._width!==a$t||this._height!==a$k?(this.repaint=!0,this._width=a$t,this._height=a$k,this.target?this.target.size(a$t,a$k):this.target=a$Ot.create(a$t,a$k),this.target.hasListener("recovered")||this.target.on("recovered",this,function(a$t){a$F.timer.callLater(a$v._sp,a$v._sp.repaint)})):this.target.size(a$t,a$k)},a$k._flushToTarget=function(a$t,a$k){if(!a$k._destroy){var a$v=a$ot.worldScissorTest,a$j=a$ot.worldClipRect;a$ot.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,a$ot.worldScissorTest=!1,a$ft.mainContext.disable(3089);var a$Q=a$ot.worldAlpha,a$u=a$ot.worldMatrix4,a$S=a$ot.worldMatrix,a$V=a$ot.worldFilters,a$J=a$ot.worldShaderDefines;if(a$ot.worldMatrix=a$Z.EMPTY,a$ot.restoreTempArray(),a$ot.worldMatrix4=a$ot.TEMPMAT4_ARRAY,a$ot.worldAlpha=1,a$ot.worldFilters=null,a$ot.worldShaderDefines=null,a$pt.activeShader=null,a$k.start(),a$d.showCanvasMark?a$k.clear(0,1,0,.3):a$k.clear(0,0,0,0),a$t.flush(),a$k.end(),a$pt.activeShader=null,a$ot.worldAlpha=a$Q,a$ot.worldMatrix4=a$u,a$ot.worldMatrix=a$S,a$ot.worldFilters=a$V,a$ot.worldShaderDefines=a$J,a$ot.worldScissorTest=a$v){var a$W=a$ot.height-a$j.y-a$j.height;a$ft.mainContext.scissor(a$j.x,a$W,a$j.width,a$j.height),a$ft.mainContext.enable(3089)}a$ot.worldClipRect=a$j}},a$k.flush=function(a$t){this.repaint&&(this._flushToTarget(a$t,this.target),this.repaint=!1)},a$k.drawTo=function(a$t,a$k,a$v,a$j,a$Q){a$t.drawTexture(this.target.getTexture(),a$k,a$v,a$j,a$Q,0,0)},a$k.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},a$t}(),a$y=function(){function a$t(){this.ALPHA=1,this.shaderType=0,this.defines=new a$Ut}return a$H(a$t,"laya.webgl.shader.d2.Shader2D"),a$t.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},a$t.__init__=function(){var a$t,a$k;a$et.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),a$et.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),a$et.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),a$et.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),a$et.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),a$et.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),a$et.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),a$et.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),a$t="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",a$k='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',a$et.preCompile2D(0,1,a$t,a$k,null),a$t="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",a$k='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',a$et.preCompile2D(0,2,a$t,a$k,null),a$t="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",a$k="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",a$et.preCompile2D(0,4,a$t,a$k,null),a$t="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",a$k='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',a$et.preCompile2D(0,256,a$t,a$k,null),a$t="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",a$k="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",a$et.preCompile2D(0,512,a$t,a$k,null)},a$t}(),a$P=function(){function a$k(a$t,a$k,a$v){this._value=0,this._name2int=a$t,this._int2name=a$k,this._int2nameMap=a$v}a$H(a$k,"laya.webgl.shader.ShaderDefines");var a$t=a$k.prototype;return a$t.add=function(a$t){return"string"==typeof a$t&&(a$t=this._name2int[a$t]),this._value|=a$t,this._value},a$t.addInt=function(a$t){return this._value|=a$t,this._value},a$t.remove=function(a$t){return"string"==typeof a$t&&(a$t=this._name2int[a$t]),this._value&=~a$t,this._value},a$t.isDefine=function(a$t){return(this._value&a$t)===a$t},a$t.getValue=function(){return this._value},a$t.setValue=function(a$t){this._value=a$t},a$t.toNameDic=function(){var a$t=this._int2nameMap[this._value];return a$t||a$k._toText(this._value,this._int2name,this._int2nameMap)},a$k._reg=function(a$t,a$k,a$v,a$j){a$j[a$v[a$t]=a$k]=a$t},a$k._toText=function(a$t,a$k,a$v){var a$j=a$v[a$t];if(a$j)return a$j;for(var a$Q={},a$u=1,a$S=0;a$S<32&&!(a$t<(a$u=1<<a$S));a$S++)if(a$t&a$u){var a$V=a$k[a$u];a$V&&(a$Q[a$V]="")}return a$v[a$t]=a$Q},a$k._toInt=function(a$t,a$k){for(var a$v=a$t.split("."),a$j=0,a$Q=0,a$u=a$v.length;a$Q<a$u;a$Q++){var a$S=a$k[a$v[a$Q]];if(!a$S)throw new Error("Defines to int err:"+a$t+"/"+a$v[a$Q]);a$j|=a$S}return a$j},a$k}(),a$tt=function(){function a$S(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new a$Z}a$H(a$S,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var a$t=a$S.prototype;return a$t.init=function(a$t,a$k,a$v){if(a$k)this._vs=a$k;else{this._vs=[];var a$j=a$t.width,a$Q=a$t.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(a$j,0,1,0,1,1,1,1),this._vs.push(a$j,a$Q,1,1,1,1,1,1),this._vs.push(0,a$Q,0,1,1,1,1,1)}a$v?this._ps=a$v:(a$S._defaultPS||(a$S._defaultPS=[]).push(0,1,3,3,1,2),this._ps=a$S._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=a$t},a$t.init2=function(a$t,a$k,a$v,a$j,a$Q){this.transform&&(this.transform=null),a$v?this._ps=a$v:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=a$j,this._uvs=a$Q,this.mEleNum=this._ps.length,this.mTexture=a$t,(a$l.isConchNode||a$l.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},a$t._initMyData=function(){var a$t=0,a$k=0,a$v=4*this._verticles.length;this._vs=a$S._tempVS;var a$j=!1;if(a$l.isConchNode||a$l.isConchApp?(this._vs.length=a$v,a$j=!0):this._vs.length<a$v&&(this._vs.length=a$v,a$j=!0),a$S._tVSLen=a$v,a$j)for(;a$t<a$v;)this._vs[a$t]=this._verticles[a$k],this._vs[a$t+1]=this._verticles[a$k+1],this._vs[a$t+2]=this._uvs[a$k],this._vs[a$t+3]=this._uvs[a$k+1],this._vs[a$t+4]=1,this._vs[a$t+5]=1,this._vs[a$t+6]=1,this._vs[a$t+7]=1,a$t+=8,a$k+=2;else for(;a$t<a$v;)this._vs[a$t]=this._verticles[a$k],this._vs[a$t+1]=this._verticles[a$k+1],this._vs[a$t+2]=this._uvs[a$k],this._vs[a$t+3]=this._uvs[a$k+1],a$t+=8,a$k+=2},a$t.getData2=function(a$t,a$k,a$v){var a$j;this.mVBBuffer=a$t,this.mIBBuffer=a$k,this._initMyData(),a$t.appendEx2(this._vs,Float32Array,a$S._tVSLen,4),this._indexStart=a$k._byteLength,(a$j=a$S._tempIB).length<this._ps.length&&(a$j.length=this._ps.length);for(var a$Q=0,a$u=this._ps.length;a$Q<a$u;a$Q++)a$j[a$Q]=this._ps[a$Q]+a$v;a$k.appendEx2(a$j,Uint16Array,this._ps.length,2)},a$t.getData=function(a$t,a$k,a$v){if(this.mVBBuffer=a$t,this.mIBBuffer=a$k,a$t.append(this.mVBData),this._indexStart=a$k._byteLength,this.mIBData.start!=a$v){for(var a$j=0,a$Q=this._ps.length;a$j<a$Q;a$j++)this.mIBData[a$j]=this._ps[a$j]+a$v;this.mIBData.start=a$v}a$k.append(this.mIBData)},a$t.render=function(a$t,a$k,a$v){if(a$l.isWebGL&&this.mTexture){a$t._renderKey=0,a$t._shader2D.glTexture=null,a$kt.getInstance().addSkinMesh(this);var a$j=a$ut.createShape(a$t,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,a$mt.create(512,0));this.transform||(this.transform=a$Z.EMPTY),this.transform.translate(a$k,a$v),a$Z.mul(this.transform,a$t._curMat,this._tempMatrix),this.transform.translate(-a$k,-a$v);var a$Q=a$j.shaderValue,a$u=a$Q.u_mmat2||a$ot.getMatrArray();a$ot.mat2MatArray(this._tempMatrix,a$u),a$Q.textureHost=this.mTexture,a$Q.offsetX=0,a$Q.offsetY=0,a$Q.u_mmat2=a$u,a$Q.ALPHA=a$t._shader2D.ALPHA,a$t._submits[a$t._submits._length++]=a$j}else a$l.isConchApp&&this.mTexture&&(this.transform||(this.transform=a$Z.EMPTY),a$t.setSkinMesh&&a$t.setSkinMesh(a$k,a$v,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},a$S._tempVS=[],a$S._tempIB=[],a$S._defaultPS=null,a$S._tVSLen=0,a$S}(),a$kt=function(){function a$t(){this.ib=null,this.vb=null;a$ft.mainContext;this.ib=a$yt.create(35048),this.vb=a$Pt.create(8)}a$H(a$t,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var a$k=a$t.prototype;return a$k.addSkinMesh=function(a$t){a$t.getData2(this.vb,this.ib,this.vb._byteLength/32)},a$k.reset=function(){this.vb.clear(),this.ib.clear()},a$t.getInstance=function(){return a$t.instance=a$t.instance||new a$t},a$t.instance=null,a$t}(),a$vt=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===a$J&&(a$J=0),this.x=a$t,this.y=a$k,this.width=a$v,this.height=a$j,this.edges=a$Q,this.color=a$u,this.borderWidth=a$S,this.borderColor=a$V}a$H(a$t,"laya.webgl.shapes.BasePoly");var a$k=a$t.prototype;return a$F.imps(a$k,{"laya.webgl.shapes.IShape":!0}),a$k.getData=function(a$t,a$k,a$v){},a$k.rebuild=function(a$t){},a$k.setMatrix=function(a$t){},a$k.needUpdate=function(a$t){return!0},a$k.sector=function(a$t,a$k,a$v){var a$j=this.x,a$Q=this.y,a$u=this.edges,a$S=(this.r1-this.r0)/a$u,a$V=this.width,a$J=this.height,a$W=this.color,a$w=(a$W>>16&255)/255,a$M=(a$W>>8&255)/255,a$H=(255&a$W)/255;a$t.push(a$j,a$Q,a$w,a$M,a$H);for(var a$E=0;a$E<a$u+1;a$E++)a$t.push(a$j+Math.sin(a$S*a$E+this.r0)*a$V,a$Q+Math.cos(a$S*a$E+this.r0)*a$J),a$t.push(a$w,a$M,a$H);for(a$E=0;a$E<a$u;a$E++)a$k.push(a$v,a$v+a$E+1,a$v+a$E+2)},a$k.createLine2=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S,a$V,a$J,a$W,a$w,a$M,a$H,a$E,a$A,a$R,a$h,a$l,a$o,a$Y,a$f,a$X,a$F,a$d,a$m,a$Z,a$s=a$t.concat(),a$K=a$Q,a$U=this.borderColor,a$N=(a$U>>16&255)/255,a$a=(a$U>>8&255)/255,a$z=(255&a$U)/255,a$G=a$s.length/2,a$c=a$j,a$T=a$v/2;a$J=a$s[0],a$W=a$s[1],a$R=a$J-(a$w=a$s[2]),a$A=(a$A=-(a$W-(a$M=a$s[3])))/(a$Z=Math.sqrt(a$A*a$A+a$R*a$R))*a$T,a$R=a$R/a$Z*a$T,a$K.push(a$J-a$A+this.x,a$W-a$R+this.y,a$N,a$a,a$z,a$J+a$A+this.x,a$W+a$R+this.y,a$N,a$a,a$z);for(var a$p=1;a$p<a$G-1;a$p++)a$J=a$s[2*(a$p-1)],a$W=a$s[2*(a$p-1)+1],a$w=a$s[2*a$p],a$M=a$s[2*a$p+1],a$H=a$s[2*(a$p+1)],a$E=a$s[2*(a$p+1)+1],a$R=a$J-a$w,a$l=a$w-a$H,a$f=(-(a$A=(a$A=-(a$W-a$M))/(a$Z=Math.sqrt(a$A*a$A+a$R*a$R))*a$T)+a$J)*(-(a$R=a$R/a$Z*a$T)+a$M)-(-a$A+a$w)*(-a$R+a$W),a$d=(-(a$h=(a$h=-(a$M-a$E))/(a$Z=Math.sqrt(a$h*a$h+a$l*a$l))*a$T)+a$H)*(-(a$l=a$l/a$Z*a$T)+a$M)-(-a$h+a$w)*(-a$l+a$E),a$m=(a$o=-a$R+a$W-(-a$R+a$M))*(a$F=-a$h+a$w-(-a$h+a$H))-(a$X=-a$l+a$E-(-a$l+a$M))*(a$Y=-a$A+a$w-(-a$A+a$J)),Math.abs(a$m)<.1?(a$m+=10.1,a$K.push(a$w-a$A+this.x,a$M-a$R+this.y,a$N,a$a,a$z,a$w+a$A+this.x,a$M+a$R+this.y,a$N,a$a,a$z)):(((a$S=(a$Y*a$d-a$F*a$f)/a$m)-a$w)*(a$S-a$w)+((a$V=(a$X*a$f-a$o*a$d)/a$m)-a$M)+(a$V-a$M),a$K.push(a$S+this.x,a$V+this.y,a$N,a$a,a$z,a$w-(a$S-a$w)+this.x,a$M-(a$V-a$M)+this.y,a$N,a$a,a$z));a$J=a$s[a$s.length-4],a$W=a$s[a$s.length-3],a$R=a$J-(a$w=a$s[a$s.length-2]),a$A=(a$A=-(a$W-(a$M=a$s[a$s.length-1])))/(a$Z=Math.sqrt(a$A*a$A+a$R*a$R))*a$T,a$R=a$R/a$Z*a$T,a$K.push(a$w-a$A+this.x,a$M-a$R+this.y,a$N,a$a,a$z,a$w+a$A+this.x,a$M+a$R+this.y,a$N,a$a,a$z);var a$O=a$u;for(a$p=1;a$p<a$O;a$p++)a$k.push(a$c+2*(a$p-1),a$c+2*(a$p-1)+1,a$c+2*a$p+1,a$c+2*a$p+1,a$c+2*a$p,a$c+2*(a$p-1));return a$K},a$k.createLine=function(a$t,a$k,a$v,a$j){var a$Q=a$t.concat(),a$u=a$t,a$S=this.borderColor,a$V=(a$S>>16&255)/255,a$J=(a$S>>8&255)/255,a$W=(255&a$S)/255;a$Q.splice(0,5);var a$w,a$M,a$H,a$E,a$A,a$R,a$h,a$l,a$o,a$Y,a$f,a$X,a$F,a$d,a$m,a$Z,a$s,a$K,a$U,a$N,a$a=a$Q.length/5,a$z=a$j,a$G=a$v/2;a$H=a$Q[0],a$E=a$Q[1],a$Y=a$H-(a$A=a$Q[5]),a$o=(a$o=-(a$E-(a$R=a$Q[6])))/(a$N=Math.sqrt(a$o*a$o+a$Y*a$Y))*a$G,a$Y=a$Y/a$N*a$G,a$u.push(a$H-a$o,a$E-a$Y,a$V,a$J,a$W,a$H+a$o,a$E+a$Y,a$V,a$J,a$W);for(var a$c=1;a$c<a$a-1;a$c++)a$H=a$Q[5*(a$c-1)],a$E=a$Q[5*(a$c-1)+1],a$A=a$Q[5*a$c],a$R=a$Q[5*a$c+1],a$h=a$Q[5*(a$c+1)],a$l=a$Q[5*(a$c+1)+1],a$Y=a$H-a$A,a$X=a$A-a$h,a$m=(-(a$o=(a$o=-(a$E-a$R))/(a$N=Math.sqrt(a$o*a$o+a$Y*a$Y))*a$G)+a$H)*(-(a$Y=a$Y/a$N*a$G)+a$R)-(-a$o+a$A)*(-a$Y+a$E),a$K=(-(a$f=(a$f=-(a$R-a$l))/(a$N=Math.sqrt(a$f*a$f+a$X*a$X))*a$G)+a$h)*(-(a$X=a$X/a$N*a$G)+a$R)-(-a$f+a$A)*(-a$X+a$l),a$U=(a$F=-a$Y+a$E-(-a$Y+a$R))*(a$s=-a$f+a$A-(-a$f+a$h))-(a$Z=-a$X+a$l-(-a$X+a$R))*(a$d=-a$o+a$A-(-a$o+a$H)),Math.abs(a$U)<.1?(a$U+=10.1,a$u.push(a$A-a$o,a$R-a$Y,a$V,a$J,a$W,a$A+a$o,a$R+a$Y,a$V,a$J,a$W)):(((a$w=(a$d*a$K-a$s*a$m)/a$U)-a$A)*(a$w-a$A)+((a$M=(a$Z*a$m-a$F*a$K)/a$U)-a$R)+(a$M-a$R),a$u.push(a$w,a$M,a$V,a$J,a$W,a$A-(a$w-a$A),a$R-(a$M-a$R),a$V,a$J,a$W));a$H=a$Q[a$Q.length-10],a$E=a$Q[a$Q.length-9],a$Y=a$H-(a$A=a$Q[a$Q.length-5]),a$o=(a$o=-(a$E-(a$R=a$Q[a$Q.length-4])))/(a$N=Math.sqrt(a$o*a$o+a$Y*a$Y))*a$G,a$Y=a$Y/a$N*a$G,a$u.push(a$A-a$o,a$R-a$Y,a$V,a$J,a$W,a$A+a$o,a$R+a$Y,a$V,a$J,a$W);var a$T=this.edges+1;for(a$c=1;a$c<a$T;a$c++)a$k.push(a$z+2*(a$c-1),a$z+2*(a$c-1)+1,a$z+2*a$c+1,a$z+2*a$c+1,a$z+2*a$c,a$z+2*(a$c-1));return a$u},a$k.createLoopLine=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=a$t.concat(),a$V=a$Q||a$t,a$J=this.borderColor,a$W=(a$J>>16&255)/255,a$w=(a$J>>8&255)/255,a$M=(255&a$J)/255;a$S.splice(0,5);var a$H=[a$S[0],a$S[1]],a$E=[a$S[a$S.length-5],a$S[a$S.length-4]],a$A=a$E[0]+.5*(a$H[0]-a$E[0]),a$R=a$E[1]+.5*(a$H[1]-a$E[1]);a$S.unshift(a$A,a$R,0,0,0),a$S.push(a$A,a$R,0,0,0);var a$h,a$l,a$o,a$Y,a$f,a$X,a$F,a$d,a$m,a$Z,a$s,a$K,a$U,a$N,a$a,a$z,a$G,a$c,a$T,a$p,a$O=a$S.length/5,a$n=a$j,a$_=a$v/2;a$o=a$S[0],a$Y=a$S[1],a$Z=a$o-(a$f=a$S[5]),a$m=(a$m=-(a$Y-(a$X=a$S[6])))/(a$p=Math.sqrt(a$m*a$m+a$Z*a$Z))*a$_,a$Z=a$Z/a$p*a$_,a$V.push(a$o-a$m,a$Y-a$Z,a$W,a$w,a$M,a$o+a$m,a$Y+a$Z,a$W,a$w,a$M);for(var a$x=1;a$x<a$O-1;a$x++)a$o=a$S[5*(a$x-1)],a$Y=a$S[5*(a$x-1)+1],a$f=a$S[5*a$x],a$X=a$S[5*a$x+1],a$F=a$S[5*(a$x+1)],a$d=a$S[5*(a$x+1)+1],a$Z=a$o-a$f,a$K=a$f-a$F,a$a=(-(a$m=(a$m=-(a$Y-a$X))/(a$p=Math.sqrt(a$m*a$m+a$Z*a$Z))*a$_)+a$o)*(-(a$Z=a$Z/a$p*a$_)+a$X)-(-a$m+a$f)*(-a$Z+a$Y),a$c=(-(a$s=(a$s=-(a$X-a$d))/(a$p=Math.sqrt(a$s*a$s+a$K*a$K))*a$_)+a$F)*(-(a$K=a$K/a$p*a$_)+a$X)-(-a$s+a$f)*(-a$K+a$d),a$T=(a$U=-a$Z+a$Y-(-a$Z+a$X))*(a$G=-a$s+a$f-(-a$s+a$F))-(a$z=-a$K+a$d-(-a$K+a$X))*(a$N=-a$m+a$f-(-a$m+a$o)),Math.abs(a$T)<.1?(a$T+=10.1,a$V.push(a$f-a$m,a$X-a$Z,a$W,a$w,a$M,a$f+a$m,a$X+a$Z,a$W,a$w,a$M)):(((a$h=(a$N*a$c-a$G*a$a)/a$T)-a$f)*(a$h-a$f)+((a$l=(a$z*a$a-a$U*a$c)/a$T)-a$X)+(a$l-a$X),a$V.push(a$h,a$l,a$W,a$w,a$M,a$f-(a$h-a$f),a$X-(a$l-a$X),a$W,a$w,a$M));a$u&&(a$k=a$u);var a$I=this.edges+1;for(a$x=1;a$x<a$I;a$x++)a$k.push(a$n+2*(a$x-1),a$n+2*(a$x-1)+1,a$n+2*a$x+1,a$n+2*a$x+1,a$n+2*a$x,a$n+2*(a$x-1));return a$k.push(a$n+2*(a$x-1),a$n+2*(a$x-1)+1,a$n+1,a$n+1,a$n,a$n+2*(a$x-1)),a$V},a$t}(),a$jt=function(){function a$R(){}return a$H(a$R,"laya.webgl.shapes.Earcut"),a$R.earcut=function(a$t,a$k,a$v){a$v=a$v||2;var a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w=a$k&&a$k.length,a$M=a$w?a$k[0]*a$v:a$t.length,a$H=a$R.linkedList(a$t,0,a$M,a$v,!0),a$E=[];if(!a$H)return a$E;if(a$w&&(a$H=a$R.eliminateHoles(a$t,a$k,a$H,a$v)),a$t.length>80*a$v){a$j=a$u=a$t[0],a$Q=a$S=a$t[1];for(var a$A=a$v;a$A<a$M;a$A+=a$v)(a$V=a$t[a$A])<a$j&&(a$j=a$V),(a$J=a$t[a$A+1])<a$Q&&(a$Q=a$J),a$u<a$V&&(a$u=a$V),a$S<a$J&&(a$S=a$J);a$W=0!==(a$W=Math.max(a$u-a$j,a$S-a$Q))?1/a$W:0}return a$R.earcutLinked(a$H,a$E,a$v,a$j,a$Q,a$W),a$E},a$R.linkedList=function(a$t,a$k,a$v,a$j,a$Q){var a$u,a$S;if(a$Q===0<a$R.signedArea(a$t,a$k,a$v,a$j))for(a$u=a$k;a$u<a$v;a$u+=a$j)a$S=a$R.insertNode(a$u,a$t[a$u],a$t[a$u+1],a$S);else for(a$u=a$v-a$j;a$k<=a$u;a$u-=a$j)a$S=a$R.insertNode(a$u,a$t[a$u],a$t[a$u+1],a$S);return a$S&&a$R.equals(a$S,a$S.next)&&(a$R.removeNode(a$S),a$S=a$S.next),a$S},a$R.filterPoints=function(a$t,a$k){if(!a$t)return a$t;a$k||(a$k=a$t);var a$v,a$j=a$t;do{if(a$v=!1,a$j.steiner||!a$R.equals(a$j,a$j.next)&&0!==a$R.area(a$j.prev,a$j,a$j.next))a$j=a$j.next;else{if(a$R.removeNode(a$j),(a$j=a$k=a$j.prev)===a$j.next)break;a$v=!0}}while(a$v||a$j!==a$k);return a$k},a$R.earcutLinked=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){if(a$t){!a$S&&a$u&&a$R.indexCurve(a$t,a$j,a$Q,a$u);for(var a$V,a$J,a$W=a$t;a$t.prev!==a$t.next;)if(a$V=a$t.prev,a$J=a$t.next,a$u?a$R.isEarHashed(a$t,a$j,a$Q,a$u):a$R.isEar(a$t))a$k.push(a$V.i/a$v),a$k.push(a$t.i/a$v),a$k.push(a$J.i/a$v),a$R.removeNode(a$t),a$t=a$J.next,a$W=a$J.next;else if((a$t=a$J)===a$W){a$S?1===a$S?(a$t=a$R.cureLocalIntersections(a$t,a$k,a$v),a$R.earcutLinked(a$t,a$k,a$v,a$j,a$Q,a$u,2)):2===a$S&&a$R.splitEarcut(a$t,a$k,a$v,a$j,a$Q,a$u):a$R.earcutLinked(a$R.filterPoints(a$t,null),a$k,a$v,a$j,a$Q,a$u,1);break}}},a$R.isEar=function(a$t){var a$k=a$t.prev,a$v=a$t,a$j=a$t.next;if(0<=a$R.area(a$k,a$v,a$j))return!1;for(var a$Q=a$t.next.next;a$Q!==a$t.prev;){if(a$R.pointInTriangle(a$k.x,a$k.y,a$v.x,a$v.y,a$j.x,a$j.y,a$Q.x,a$Q.y)&&0<=a$R.area(a$Q.prev,a$Q,a$Q.next))return!1;a$Q=a$Q.next}return!0},a$R.isEarHashed=function(a$t,a$k,a$v,a$j){var a$Q=a$t.prev,a$u=a$t,a$S=a$t.next;if(0<=a$R.area(a$Q,a$u,a$S))return!1;for(var a$V=a$Q.x<a$u.x?a$Q.x<a$S.x?a$Q.x:a$S.x:a$u.x<a$S.x?a$u.x:a$S.x,a$J=a$Q.y<a$u.y?a$Q.y<a$S.y?a$Q.y:a$S.y:a$u.y<a$S.y?a$u.y:a$S.y,a$W=a$Q.x>a$u.x?a$Q.x>a$S.x?a$Q.x:a$S.x:a$u.x>a$S.x?a$u.x:a$S.x,a$w=a$Q.y>a$u.y?a$Q.y>a$S.y?a$Q.y:a$S.y:a$u.y>a$S.y?a$u.y:a$S.y,a$M=a$R.zOrder(a$V,a$J,a$k,a$v,a$j),a$H=a$R.zOrder(a$W,a$w,a$k,a$v,a$j),a$E=a$t.nextZ;a$E&&a$E.z<=a$H;){if(a$E!==a$t.prev&&a$E!==a$t.next&&a$R.pointInTriangle(a$Q.x,a$Q.y,a$u.x,a$u.y,a$S.x,a$S.y,a$E.x,a$E.y)&&0<=a$R.area(a$E.prev,a$E,a$E.next))return!1;a$E=a$E.nextZ}for(a$E=a$t.prevZ;a$E&&a$E.z>=a$M;){if(a$E!==a$t.prev&&a$E!==a$t.next&&a$R.pointInTriangle(a$Q.x,a$Q.y,a$u.x,a$u.y,a$S.x,a$S.y,a$E.x,a$E.y)&&0<=a$R.area(a$E.prev,a$E,a$E.next))return!1;a$E=a$E.prevZ}return!0},a$R.cureLocalIntersections=function(a$t,a$k,a$v){var a$j=a$t;do{var a$Q=a$j.prev,a$u=a$j.next.next;!a$R.equals(a$Q,a$u)&&a$R.intersects(a$Q,a$j,a$j.next,a$u)&&a$R.locallyInside(a$Q,a$u)&&a$R.locallyInside(a$u,a$Q)&&(a$k.push(a$Q.i/a$v),a$k.push(a$j.i/a$v),a$k.push(a$u.i/a$v),a$R.removeNode(a$j),a$R.removeNode(a$j.next),a$j=a$t=a$u),a$j=a$j.next}while(a$j!==a$t);return a$j},a$R.splitEarcut=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=a$t;do{for(var a$V=a$S.next.next;a$V!==a$S.prev;){if(a$S.i!==a$V.i&&a$R.isValidDiagonal(a$S,a$V)){var a$J=a$R.splitPolygon(a$S,a$V);return a$S=a$R.filterPoints(a$S,a$S.next),a$J=a$R.filterPoints(a$J,a$J.next),a$R.earcutLinked(a$S,a$k,a$v,a$j,a$Q,a$u),void a$R.earcutLinked(a$J,a$k,a$v,a$j,a$Q,a$u)}a$V=a$V.next}a$S=a$S.next}while(a$S!==a$t)},a$R.eliminateHoles=function(a$t,a$k,a$v,a$j){var a$Q,a$u,a$S,a$V,a$J,a$W=[];for(a$Q=0,a$u=a$k.length;a$Q<a$u;a$Q++)a$S=a$k[a$Q]*a$j,a$V=a$Q<a$u-1?a$k[a$Q+1]*a$j:a$t.length,(a$J=a$R.linkedList(a$t,a$S,a$V,a$j,!1))===a$J.next&&(a$J.steiner=!0),a$W.push(a$R.getLeftmost(a$J));for(a$W.sort(a$R.compareX),a$Q=0;a$Q<a$W.length;a$Q++)a$R.eliminateHole(a$W[a$Q],a$v),a$v=a$R.filterPoints(a$v,a$v.next);return a$v},a$R.compareX=function(a$t,a$k){return a$t.x-a$k.x},a$R.eliminateHole=function(a$t,a$k){if(a$k=a$R.findHoleBridge(a$t,a$k)){var a$v=a$R.splitPolygon(a$k,a$t);a$R.filterPoints(a$v,a$v.next)}},a$R.findHoleBridge=function(a$t,a$k){var a$v,a$j=a$k,a$Q=a$t.x,a$u=a$t.y,a$S=-1/0;do{if(a$u<=a$j.y&&a$u>=a$j.next.y&&a$j.next.y!==a$j.y){var a$V=a$j.x+(a$u-a$j.y)*(a$j.next.x-a$j.x)/(a$j.next.y-a$j.y);if(a$V<=a$Q&&a$S<a$V){if((a$S=a$V)===a$Q){if(a$u===a$j.y)return a$j;if(a$u===a$j.next.y)return a$j.next}a$v=a$j.x<a$j.next.x?a$j:a$j.next}}a$j=a$j.next}while(a$j!==a$k);if(!a$v)return null;if(a$Q===a$S)return a$v.prev;var a$J,a$W=a$v,a$w=a$v.x,a$M=a$v.y,a$H=1/0;for(a$j=a$v.next;a$j!==a$W;)a$Q>=a$j.x&&a$j.x>=a$w&&a$Q!==a$j.x&&a$R.pointInTriangle(a$u<a$M?a$Q:a$S,a$u,a$w,a$M,a$u<a$M?a$S:a$Q,a$u,a$j.x,a$j.y)&&((a$J=Math.abs(a$u-a$j.y)/(a$Q-a$j.x))<a$H||a$J===a$H&&a$j.x>a$v.x)&&a$R.locallyInside(a$j,a$t)&&(a$v=a$j,a$H=a$J),a$j=a$j.next;return a$v},a$R.indexCurve=function(a$t,a$k,a$v,a$j){for(var a$Q=a$t;null===a$Q.z&&(a$Q.z=a$R.zOrder(a$Q.x,a$Q.y,a$k,a$v,a$j)),a$Q.prevZ=a$Q.prev,a$Q.nextZ=a$Q.next,(a$Q=a$Q.next)!==a$t;);a$Q.prevZ.nextZ=null,a$Q.prevZ=null,a$R.sortLinked(a$Q)},a$R.sortLinked=function(a$t){var a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W=1;do{for(a$v=a$t,a$u=a$t=null,a$S=0;a$v;){for(a$S++,a$j=a$v,a$k=a$V=0;a$k<a$W&&(a$V++,a$j=a$j.nextZ);a$k++);for(a$J=a$W;0<a$V||0<a$J&&a$j;)0!==a$V&&(0===a$J||!a$j||a$v.z<=a$j.z)?(a$v=(a$Q=a$v).nextZ,a$V--):(a$j=(a$Q=a$j).nextZ,a$J--),a$u?a$u.nextZ=a$Q:a$t=a$Q,a$Q.prevZ=a$u,a$u=a$Q;a$v=a$j}a$u.nextZ=null,a$W*=2}while(1<a$S);return a$t},a$R.zOrder=function(a$t,a$k,a$v,a$j,a$Q){return(a$t=1431655765&((a$t=858993459&((a$t=252645135&((a$t=16711935&((a$t=32767*(a$t-a$v)*a$Q)|a$t<<8))|a$t<<4))|a$t<<2))|a$t<<1))|(a$k=1431655765&((a$k=858993459&((a$k=252645135&((a$k=16711935&((a$k=32767*(a$k-a$j)*a$Q)|a$k<<8))|a$k<<4))|a$k<<2))|a$k<<1))<<1},a$R.getLeftmost=function(a$t){for(var a$k=a$t,a$v=a$t;a$k.x<a$v.x&&(a$v=a$k),(a$k=a$k.next)!==a$t;);return a$v},a$R.pointInTriangle=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){return 0<=(a$Q-a$S)*(a$k-a$V)-(a$t-a$S)*(a$u-a$V)&&0<=(a$t-a$S)*(a$j-a$V)-(a$v-a$S)*(a$k-a$V)&&0<=(a$v-a$S)*(a$u-a$V)-(a$Q-a$S)*(a$j-a$V)},a$R.isValidDiagonal=function(a$t,a$k){return a$t.next.i!==a$k.i&&a$t.prev.i!==a$k.i&&!a$R.intersectsPolygon(a$t,a$k)&&a$R.locallyInside(a$t,a$k)&&a$R.locallyInside(a$k,a$t)&&a$R.middleInside(a$t,a$k)},a$R.area=function(a$t,a$k,a$v){return(a$k.y-a$t.y)*(a$v.x-a$k.x)-(a$k.x-a$t.x)*(a$v.y-a$k.y)},a$R.equals=function(a$t,a$k){return a$t.x===a$k.x&&a$t.y===a$k.y},a$R.intersects=function(a$t,a$k,a$v,a$j){return!!(a$R.equals(a$t,a$k)&&a$R.equals(a$v,a$j)||a$R.equals(a$t,a$j)&&a$R.equals(a$v,a$k))||0<a$R.area(a$t,a$k,a$v)!=0<a$R.area(a$t,a$k,a$j)&&0<a$R.area(a$v,a$j,a$t)!=0<a$R.area(a$v,a$j,a$k)},a$R.intersectsPolygon=function(a$t,a$k){var a$v=a$t;do{if(a$v.i!==a$t.i&&a$v.next.i!==a$t.i&&a$v.i!==a$k.i&&a$v.next.i!==a$k.i&&a$R.intersects(a$v,a$v.next,a$t,a$k))return!0;a$v=a$v.next}while(a$v!==a$t);return!1},a$R.locallyInside=function(a$t,a$k){return a$R.area(a$t.prev,a$t,a$t.next)<0?0<=a$R.area(a$t,a$k,a$t.next)&&0<=a$R.area(a$t,a$t.prev,a$k):a$R.area(a$t,a$k,a$t.prev)<0||a$R.area(a$t,a$t.next,a$k)<0},a$R.middleInside=function(a$t,a$k){for(var a$v=a$t,a$j=!1,a$Q=(a$t.x+a$k.x)/2,a$u=(a$t.y+a$k.y)/2;a$v.y>a$u!=a$v.next.y>a$u&&a$v.next.y!==a$v.y&&a$Q<(a$v.next.x-a$v.x)*(a$u-a$v.y)/(a$v.next.y-a$v.y)+a$v.x&&(a$j=!a$j),(a$v=a$v.next)!==a$t;);return a$j},a$R.splitPolygon=function(a$t,a$k){var a$v=new a$Qt(a$t.i,a$t.x,a$t.y),a$j=new a$Qt(a$k.i,a$k.x,a$k.y),a$Q=a$t.next,a$u=a$k.prev;return(a$t.next=a$k).prev=a$t,(a$v.next=a$Q).prev=a$v,(a$j.next=a$v).prev=a$j,(a$u.next=a$j).prev=a$u,a$j},a$R.insertNode=function(a$t,a$k,a$v,a$j){var a$Q=new a$Qt(a$t,a$k,a$v);return a$j?(a$Q.next=a$j.next,(a$Q.prev=a$j).next.prev=a$Q,a$j.next=a$Q):(a$Q.prev=a$Q).next=a$Q,a$Q},a$R.removeNode=function(a$t){a$t.next.prev=a$t.prev,a$t.prev.next=a$t.next,a$t.prevZ&&(a$t.prevZ.nextZ=a$t.nextZ),a$t.nextZ&&(a$t.nextZ.prevZ=a$t.prevZ)},a$R.signedArea=function(a$t,a$k,a$v,a$j){for(var a$Q=0,a$u=a$k,a$S=a$v-a$j;a$u<a$v;a$u+=a$j)a$Q+=(a$t[a$S]-a$t[a$u])*(a$t[a$u+1]+a$t[a$S+1]),a$S=a$u;return a$Q},a$R}(),a$Qt=function(){function a$t(a$t,a$k,a$v){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=a$t,this.x=a$k,this.y=a$v,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return a$H(a$t,"laya.webgl.shapes.EarcutNode"),a$t}(),a$ut=(function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this.lineWidth=a$t,this.lineColor=a$k,this.lineAlpha=a$v,this.fillColor=a$j,this.fillAlpha=a$Q,this.shape=a$S,this.fill=a$u}a$H(a$t,"laya.webgl.shapes.GeometryData");var a$k=a$t.prototype;a$k.clone=function(){return new a$t(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},a$k.getIndexData=function(){return null},a$k.getVertexData=function(){return null},a$k.destroy=function(){this.shape=null}}(),function(){function a$t(a$t){if(a$t instanceof Float32Array)this.points=a$t;else if(a$t instanceof Array){a$t.length;this.points=new Float32Array(a$t)}}a$H(a$t,"laya.webgl.shapes.Vertex");var a$k=a$t.prototype;a$F.imps(a$k,{"laya.webgl.shapes.IShape":!0}),a$k.getData=function(a$t,a$k,a$v){},a$k.needUpdate=function(a$t){return!1},a$k.rebuild=function(a$t){},a$k.setMatrix=function(a$t){}}(),function(){function a$J(a$t){void 0===a$t&&(a$t=1e4),this._renderType=a$t}a$H(a$J,"laya.webgl.submit.Submit");var a$t=a$J.prototype;return a$F.imps(a$t,{"laya.webgl.submit.ISubmit":!0}),a$t.releaseRender=function(){var a$t=a$J._cache;(a$t[a$t._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},a$t.getRenderType=function(){return this._renderType},a$t.renderSubmit=function(){if(0===this._numEle)return 1;var a$t=this.shaderValue.textureHost;if(a$t){var a$k=a$t.source;if(!a$t.bitmap||!a$k)return 1;this.shaderValue.texture=a$k,a$t.alphaTexture&&a$t.alphaTexture.source&&(this.shaderValue.texture1=a$t.alphaTexture.source)}this._vb.bind_upload(this._ib);var a$v=a$ft.mainContext;return this.shaderValue.upload(),a$D.activeBlendFunction!==this._blendFn&&(a$v.enable(3042),this._blendFn(a$v),a$D.activeBlendFunction=this._blendFn),a$a.drawCall++,a$a.trianglesFaces+=this._numEle/3,a$v.drawElements(4,this._numEle,5123,this._startIdx),1},a$J.__init__=function(){var a$t=a$J.RENDERBASE=new a$J(-1);a$t.shaderValue=new a$mt(0,0),a$t.shaderValue.ALPHA=-1234},a$J.createSubmit=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$J._cache._length?a$J._cache[--a$J._cache._length]:new a$J;null==a$v&&((a$v=a$u._selfVb||(a$u._selfVb=a$Pt.create(-1))).clear(),a$j=0),a$u._ib=a$k,a$u._vb=a$v,a$u._startIdx=a$j*a$Rt.BYTES_PIDX,a$u._numEle=0;var a$S=a$t._nBlendType;a$u._blendFn=a$t._targets?a$D.targetFns[a$S]:a$D.fns[a$S],a$u.shaderValue=a$Q,a$u.shaderValue.setValue(a$t._shader2D);var a$V=a$t._shader2D.filters;return a$V&&a$u.shaderValue.setFilters(a$V),a$u},a$J.createShape=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=a$J._cache._length?a$J._cache[--a$J._cache._length]:new a$J;a$S._ib=a$k,a$S._vb=a$v,a$S._numEle=a$j,a$S._startIdx=a$Q,a$S.shaderValue=a$u,a$S.shaderValue.setValue(a$t._shader2D);var a$V=a$t._nBlendType;return a$S._blendFn=a$t._targets?a$D.targetFns[a$V]:a$D.fns[a$V],a$S},a$J.TYPE_2D=1e4,a$J.TYPE_CANVAS=10003,a$J.TYPE_CMDSETRT=10004,a$J.TYPE_CUSTOM=10005,a$J.TYPE_BLURRT=10006,a$J.TYPE_CMDDESTORYPRERT=10007,a$J.TYPE_DISABLESTENCIL=10008,a$J.TYPE_OTHERIBVB=10009,a$J.TYPE_PRIMITIVE=10010,a$J.TYPE_RT=10011,a$J.TYPE_BLUR_RT=10012,a$J.TYPE_TARGET=10013,a$J.TYPE_CHANGE_VALUE=10014,a$J.TYPE_SHAPE=10015,a$J.TYPE_TEXTURE=10016,a$J.TYPE_FILLTEXTURE=10017,a$J.RENDERBASE=null,a$J._cache=((a$J._cache=[])._length=0,a$J._cache),a$J}()),a$St=function(){function a$j(){this.fun=null,this.args=null}a$H(a$j,"laya.webgl.submit.SubmitCMD");var a$t=a$j.prototype;return a$F.imps(a$t,{"laya.webgl.submit.ISubmit":!0}),a$t.renderSubmit=function(){return this.fun.apply(null,this.args),1},a$t.getRenderType=function(){return 0},a$t.releaseRender=function(){var a$t=a$j._cache;a$t[a$t._length++]=this},a$j.create=function(a$t,a$k){var a$v=a$j._cache._length?a$j._cache[--a$j._cache._length]:new a$j;return a$v.fun=a$k,a$v.args=a$t,a$v},a$j._cache=((a$j._cache=[])._length=0,a$j._cache),a$j}(),a$Vt=function(){function a$k(){this.variables={}}a$H(a$k,"laya.webgl.submit.SubmitCMDScope");var a$t=a$k.prototype;return a$t.getValue=function(a$t){return this.variables[a$t]},a$t.addValue=function(a$t,a$k){return this.variables[a$t]=a$k},a$t.setValue=function(a$t,a$k){return this.variables.hasOwnProperty(a$t)?this.variables[a$t]=a$k:null},a$t.clear=function(){for(var a$t in this.variables)delete this.variables[a$t]},a$t.recycle=function(){this.clear(),a$k.POOL.push(this)},a$k.create=function(){var a$t=a$k.POOL.pop();return a$t||(a$t=new a$k),a$t},a$k.POOL=[],a$k}(),a$Jt=function(){function a$M(){this.offset=0,this.startIndex=0,this._mat=a$Z.create()}a$H(a$M,"laya.webgl.submit.SubmitOtherIBVB");var a$t=a$M.prototype;return a$F.imps(a$t,{"laya.webgl.submit.ISubmit":!0}),a$t.releaseRender=function(){var a$t=a$M._cache;(a$t[a$t._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},a$t.getRenderType=function(){return 10009},a$t.renderSubmit=function(){var a$t=this._shaderValue.textureHost;if(a$t){var a$k=a$t.source;if(!a$t.bitmap||!a$k)return 1;this._shaderValue.texture=a$k}this._vb.bind_upload(this._ib);var a$v=a$ot.worldMatrix4,a$j=a$Z.TEMP;a$Z.mulPre(this._mat,a$v[0],a$v[1],a$v[4],a$v[5],a$v[12],a$v[13],a$j);var a$Q=a$ot.worldMatrix4=a$M.tempMatrix4;a$Q[0]=a$j.a,a$Q[1]=a$j.b,a$Q[4]=a$j.c,a$Q[5]=a$j.d,a$Q[12]=a$j.tx,a$Q[13]=a$j.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var a$u=a$ft.mainContext;return a$D.activeBlendFunction!==this._blendFn&&(a$u.enable(3042),this._blendFn(a$u),a$D.activeBlendFunction=this._blendFn),a$a.drawCall++,a$a.trianglesFaces+=this._numEle/3,a$u.drawElements(4,this._numEle,5123,this.startIndex),a$ot.worldMatrix4=a$v,a$pt.activeShader=null,1},a$M.create=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){void 0===a$J&&(a$J=0);var a$W=a$M._cache._length?a$M._cache[--a$M._cache._length]:new a$M;a$W._ib=a$v,a$W._vb=a$k,a$W._numEle=a$j,a$W._shader=a$Q,a$W._shaderValue=a$u;var a$w=a$t._nBlendType;switch(a$W._blendFn=a$t._targets?a$D.targetFns[a$w]:a$D.fns[a$w],a$J){case 0:a$W.offset=0,a$W.startIndex=a$V/(a$Rt.BYTES_PE*a$k.vertexStride)*1.5,a$W.startIndex*=a$Rt.BYTES_PIDX;break;case 1:a$W.startIndex=a$S,a$W.offset=a$V}return a$W},a$M._cache=((a$M._cache=[])._length=0,a$M._cache),a$M.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a$M}(),a$Wt=function(){function a$v(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new a$K,this.screenRect=new a$K}a$H(a$v,"laya.webgl.submit.SubmitScissor");var a$t=a$v.prototype;return a$F.imps(a$t,{"laya.webgl.submit.ISubmit":!0}),a$t._scissor=function(a$t,a$k,a$v,a$j){var a$Q=a$ot.worldMatrix4,a$u=a$Q[0],a$S=a$Q[5],a$V=a$Q[12],a$J=a$Q[13];if(a$j*=a$S,(a$v*=a$u)<1||a$j<1)return!1;var a$W=(a$t=a$t*a$u+a$V)+a$v,a$w=(a$k=a$k*a$S+a$J)+a$j;a$t<0&&(a$v=a$W-(a$t=0)),a$k<0&&(a$j=a$w-(a$k=0));var a$M=a$ot.worldClipRect;if(a$t=Math.max(a$t,a$M.x),a$k=Math.max(a$k,a$M.y),a$v=Math.min(a$W,a$M.right)-a$t,a$j=Math.min(a$w,a$M.bottom)-a$k,a$v<1||a$j<1)return!1;var a$H=a$ot.worldScissorTest;return this.screenRect.copyFrom(a$M),a$M.x=a$t,a$M.y=a$k,a$M.width=a$v,a$M.height=a$j,a$ot.worldScissorTest=!0,a$k=a$ot.height-a$k-a$j,a$ft.mainContext.scissor(a$t,a$k,a$v,a$j),a$ft.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),a$H?(a$k=a$ot.height-this.screenRect.y-this.screenRect.height,a$ft.mainContext.scissor(this.screenRect.x,a$k,this.screenRect.width,this.screenRect.height),a$ft.mainContext.enable(3089)):(a$ft.mainContext.disable(3089),a$ot.worldScissorTest=!1),a$M.copyFrom(this.screenRect),!0},a$t._scissorWithTagart=function(a$t,a$k,a$v,a$j){if(a$v<1||a$j<1)return!1;var a$Q=a$t+a$v,a$u=a$k+a$j;a$t<0&&(a$v=a$Q-(a$t=0)),a$k<0&&(a$j=a$u-(a$k=0));var a$S=a$ot.worldClipRect;if(a$t=Math.max(a$t,a$S.x),a$k=Math.max(a$k,a$S.y),a$v=Math.min(a$Q,a$S.right)-a$t,a$j=Math.min(a$u,a$S.bottom)-a$k,a$v<1||a$j<1)return!1;var a$V=a$ot.worldScissorTest;return this.screenRect.copyFrom(a$S),a$ot.worldScissorTest=!0,a$S.x=a$t,a$S.y=a$k,a$S.width=a$v,a$S.height=a$j,a$k=a$ot.height-a$k-a$j,a$ft.mainContext.scissor(a$t,a$k,a$v,a$j),a$ft.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),a$V?(a$k=a$ot.height-this.screenRect.y-this.screenRect.height,a$ft.mainContext.scissor(this.screenRect.x,a$k,this.screenRect.width,this.screenRect.height),a$ft.mainContext.enable(3089)):(a$ft.mainContext.disable(3089),a$ot.worldScissorTest=!1),a$S.copyFrom(this.screenRect),!0},a$t.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},a$t.getRenderType=function(){return 0},a$t.releaseRender=function(){var a$t=a$v._cache;(a$t[a$t._length++]=this).context=null},a$v.create=function(a$t){var a$k=a$v._cache._length?a$v._cache[--a$v._cache._length]:new a$v;return a$k.context=a$t,a$k},a$v._cache=((a$v._cache=[])._length=0,a$v._cache),a$v}(),a$wt=function(){function a$J(){this.step=0,this.blendMode=null,this.level=0}a$H(a$J,"laya.webgl.submit.SubmitStencil");var a$t=a$J.prototype;return a$F.imps(a$t,{"laya.webgl.submit.ISubmit":!0}),a$t.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},a$t.getRenderType=function(){return 0},a$t.releaseRender=function(){var a$t=a$J._cache;a$t[a$t._length++]=this},a$t.do1=function(){var a$t=a$ft.mainContext;a$t.enable(2960),a$t.clear(1024),a$t.colorMask(!1,!1,!1,!1),a$t.stencilFunc(514,this.level,255),a$t.stencilOp(7680,7680,7682)},a$t.do2=function(){var a$t=a$ft.mainContext;a$t.stencilFunc(514,this.level+1,255),a$t.colorMask(!0,!0,!0,!0),a$t.stencilOp(7680,7680,7680)},a$t.do3=function(){var a$t=a$ft.mainContext;a$t.colorMask(!0,!0,!0,!0),a$t.stencilOp(7680,7680,7680),a$t.clear(1024),a$t.disable(2960)},a$t.do4=function(){var a$t=a$ft.mainContext;0==this.level&&(a$t.enable(2960),a$t.clear(1024)),a$t.colorMask(!1,!1,!1,!1),a$t.stencilFunc(519,0,255),a$t.stencilOp(7680,7680,7682)},a$t.do5=function(){var a$t=a$ft.mainContext;a$t.stencilFunc(514,this.level,255),a$t.colorMask(!0,!0,!0,!0),a$t.stencilOp(7680,7680,7680)},a$t.do6=function(){var a$t=a$ft.mainContext;a$D.targetFns[a$D.TOINT[this.blendMode]](a$t)},a$t.do7=function(){var a$t=a$ft.mainContext;a$t.colorMask(!1,!1,!1,!1),a$t.stencilOp(7680,7680,7683)},a$t.do8=function(){var a$t=a$ft.mainContext;a$t.colorMask(!0,!0,!0,!0),a$t.stencilFunc(514,this.level,255),a$t.stencilOp(7680,7680,7680)},a$J.restore=function(a$t,a$k,a$v,a$j,a$Q){var a$u;if((a$t._renderKey=0)<a$J._mask&&a$J._mask--,0==a$J._mask)a$u=laya.webgl.submit.SubmitStencil.create(3),a$t.addRenderObject(a$u),a$t._curSubmit=a$ut.RENDERBASE;else{a$u=laya.webgl.submit.SubmitStencil.create(7),a$t.addRenderObject(a$u);var a$S=a$t._vb;a$S._byteLength;if(a$ht.fillRectImgVb(a$S,null,a$k.x,a$k.y,a$k.width,a$k.height,a$T.DEF_UV,a$v,a$j,a$Q,0,0)){a$t._shader2D.glTexture=null;var a$V=a$t._curSubmit=a$ut.createSubmit(a$t,a$t._ib,a$S,(a$S._byteLength-64)/32*3,a$mt.create(2,0));a$V.shaderValue.ALPHA=1,a$t._submits[a$t._submits._length++]=a$V,a$t._curSubmit._numEle+=6,a$t._curSubmit=a$ut.RENDERBASE}else alert("clipRect calc stencil rect error");a$u=laya.webgl.submit.SubmitStencil.create(8),a$t.addRenderObject(a$u)}},a$J.restore2=function(a$t,a$k){var a$v;(a$t._renderKey=0)<a$J._mask&&a$J._mask--,0==a$J._mask?(a$v=laya.webgl.submit.SubmitStencil.create(3),a$t.addRenderObject(a$v),a$t._curSubmit=a$ut.RENDERBASE):(a$v=laya.webgl.submit.SubmitStencil.create(7),a$t.addRenderObject(a$v),a$t._submits[a$t._submits._length++]=a$k,a$v=laya.webgl.submit.SubmitStencil.create(8),a$t.addRenderObject(a$v))},a$J.create=function(a$t){var a$k=a$J._cache._length?a$J._cache[--a$J._cache._length]:new a$J;return 5==(a$k.step=a$t)&&++a$J._mask,a$k.level=a$J._mask,a$k},a$J._cache=((a$J._cache=[])._length=0,a$J._cache),a$J._mask=0,a$J}(),a$Mt=function(){function a$V(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}a$H(a$V,"laya.webgl.submit.SubmitTarget");var a$t=a$V.prototype;return a$F.imps(a$t,{"laya.webgl.submit.ISubmit":!0}),a$t.renderSubmit=function(){this._vb.bind_upload(this._ib);var a$t=this.scope.getValue(this.proName);return a$t&&(this.shaderValue.texture=a$t.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[a$t.width,a$t.height]),this.shaderValue.upload(),this.blend(),a$a.drawCall++,a$a.trianglesFaces+=this._numEle/3,a$ft.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},a$t.blend=function(){if(a$D.activeBlendFunction!==a$D.fns[this.blendType]){var a$t=a$ft.mainContext;a$t.enable(3042),a$D.fns[this.blendType](a$t),a$D.activeBlendFunction=a$D.fns[this.blendType]}},a$t.getRenderType=function(){return 0},a$t.releaseRender=function(){var a$t=a$V._cache;(a$t[a$t._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},a$V.create=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=a$V._cache._length?a$V._cache[--a$V._cache._length]:new a$V;return a$S._ib=a$k,a$S._vb=a$v,a$S.proName=a$u,a$S._startIdx=a$j*a$Rt.BYTES_PIDX,a$S._numEle=0,a$S.blendType=a$t._nBlendType,a$S.shaderValue=a$Q,a$S.shaderValue.setValue(a$t._shader2D),a$S},a$V._cache=((a$V._cache=[])._length=0,a$V._cache),a$V}(),a$Ht=function(){function a$t(){this._sourceStr=null}a$H(a$t,"laya.webgl.text.CharSegment");var a$k=a$t.prototype;return a$F.imps(a$k,{"laya.webgl.text.ICharSegment":!0}),a$k.textToSpit=function(a$t){this._sourceStr=a$t},a$k.getChar=function(a$t){return this._sourceStr.charAt(a$t)},a$k.getCharCode=function(a$t){return this._sourceStr.charCodeAt(a$t)},a$k.length=function(){return this._sourceStr.length},a$t}(),a$Et=function(){var a$t;function a$a(){}return a$H(a$a,"laya.webgl.text.DrawText"),a$a.__init__=function(){a$a._charsTemp=new Array,a$a._drawValue=new a$t,a$a._charSeg=new a$Ht},a$a.customCharSeg=function(a$t){a$a._charSeg=a$t},a$a.getChar=function(a$t,a$k,a$v){var a$j=a$qt.createOneChar(a$t,a$v);return-1!=a$k&&(a$a._charsCache[a$k]=a$j),a$j},a$a._drawSlow=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w,a$M,a$H,a$E,a$A){var a$R,a$h,a$l=a$a._drawValue.value(a$u,a$V,a$J,a$W,a$H,a$E,a$A),a$o=0,a$Y=0,a$f=a$a._charsTemp,a$X=0,a$F=NaN;if(a$j)for(a$f.length=a$j.length,a$o=0,a$Y=a$j.length;a$o<a$Y;a$o++)(a$h=a$j[a$o])&&(a$F=a$h.charNum+a$l.txtID,a$f[a$o]=a$R=a$a._charsCache[a$F]||a$a.getChar(a$h.char,a$F,a$l),a$R.active());else{var a$d=a$v instanceof laya.utils.WordText?a$v.toString():a$v;if(a$c.CharacterCache){a$a._charSeg.textToSpit(a$d);var a$m=a$a._charSeg.length();for(a$o=0,a$Y=a$f.length=a$m;a$o<a$Y;a$o++)a$F=a$a._charSeg.getCharCode(a$o)+a$l.txtID,a$f[a$o]=a$R=a$a._charsCache[a$F]||a$a.getChar(a$a._charSeg.getChar(a$o),a$F,a$l),a$R.active(),a$X+=a$R.cw}else a$f.length=0,(a$R=a$a.getChar(a$d,-1,a$l)).active(),a$X+=a$R.cw,a$f[0]=a$R}var a$Z=0;null!==a$S&&"left"!==a$S&&(a$Z=-("center"==a$S?a$X/2:a$X));var a$s,a$K,a$U=NaN,a$N=0;if(a$j)for(a$o=0,a$Y=a$f.length;a$o<a$Y;a$o++)a$R=a$f[a$o],a$h=a$j[a$o],a$R&&a$h&&!a$R.isSpace&&(a$U=a$R.borderSize,a$s=a$R.texture,a$k._drawText(a$s,a$w+a$Z+a$h.x*a$H-a$U,a$M+a$h.y*a$E-a$U,a$s.width,a$s.height,a$Q,0,0,0,0));else{for(a$o=0,a$Y=a$f.length;a$o<a$Y;a$o++)(a$R=a$f[a$o])&&!a$R.isSpace&&(a$U=a$R.borderSize,a$s=a$R.texture,a$k._drawText(a$s,a$w+a$Z-a$U,a$M-a$U,a$s.width,a$s.height,a$Q,0,0,0,0),a$t&&((a$K=a$t[a$N++])||(a$K=a$t[a$N-1]=[]),a$K[0]=a$s,a$K[1]=a$Z-a$U,a$K[2]=-a$U)),a$Z+=a$R.cw;a$t&&(a$t.length=a$N)}},a$a._drawFast=function(a$t,a$k,a$v,a$j,a$Q){for(var a$u,a$S,a$V=0,a$J=a$t.length;a$V<a$J;a$V++)(a$u=(a$S=a$t[a$V])[0]).active(),a$k._drawText(a$u,a$j+a$S[1],a$Q+a$S[2],a$u.width,a$u.height,a$v,0,0,0,0)},a$a.drawText=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w,a$M){if(void 0===a$M&&(a$M=0),!(a$k&&0===a$k.length||a$v&&0===a$v.length)){var a$H=a$j.a,a$E=a$j.d;(0!==a$j.b||0!==a$j.c)&&(a$H=a$E=1);var a$A=1!==a$H||1!==a$E;if(a$A&&a$F.stage.transform){var a$R=a$F.stage.transform;a$A=a$R.a===a$H&&a$R.d===a$E}else a$A=!1;if(a$A){var a$h=(a$j=a$j.copyTo(a$dt._tmpMatrix)).tx,a$l=a$j.ty;a$j.scale(1/a$H,1/a$E),a$j._checkTransform(),a$W*=a$H,a$w*=a$E,a$W+=a$h-a$j.tx,a$w+=a$l-a$j.ty}else a$H=a$E=1;if(a$v)a$a._drawSlow(null,a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w,a$H,a$E,a$M);else{if(null===a$k.toUpperCase){var a$o=a$H+1e5*a$E,a$Y=a$k;return void(a$Y.changed||a$Y.id!==a$o?(a$Y.id=a$o,a$Y.changed=!1,a$a._drawSlow(a$Y.save,a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w,a$H,a$E,a$M)):a$a._drawFast(a$Y.save,a$t,a$j,a$W,a$w))}var a$f=a$k+a$Q.toString()+a$S+a$V+a$J+a$H+a$E+a$u,a$X=a$a._textsCache[a$f];a$c.CharacterCache?a$X?a$a._drawFast(a$X,a$t,a$j,a$W,a$w):(a$a._textsCache.__length||(a$a._textsCache.__length=0),a$a._textsCache.__length>a$d.WebGLTextCacheCount&&((a$a._textsCache={}).__length=0,a$a._curPoolIndex=0),a$a._textCachesPool[a$a._curPoolIndex]?(a$X=a$a._textsCache[a$f]=a$a._textCachesPool[a$a._curPoolIndex]).length=0:a$a._textCachesPool[a$a._curPoolIndex]=a$X=a$a._textsCache[a$f]=[],a$a._textsCache.__length++,a$a._curPoolIndex++,a$a._drawSlow(a$X,a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w,a$H,a$E,a$M)):a$a._drawSlow(a$X,a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w,a$H,a$E,a$M)}}},a$a._charsTemp=null,a$a._textCachesPool=[],a$a._curPoolIndex=0,a$a._charsCache={},a$a._textsCache={},a$a._drawValue=null,a$a.d=[],a$a._charSeg=null,a$a.__init$=function(){a$t=function(){function a$J(){}return a$H(a$J,""),a$J.prototype.value=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this.font=a$t,this.fillColor=a$k,this.borderColor=a$v,this.lineWidth=a$j,this.scaleX=a$Q,this.scaleY=a$u,this.underLine=a$S;var a$V=a$t.toString()+a$Q+a$u+a$j+(a$k?a$k.toLowerCase():" ")+(a$v?a$v.toLowerCase():" ")+a$S;return this.txtID=a$J._keymap[a$V],this.txtID||(this.txtID=1e-7*++a$J._keymapCount,a$J._keymap[a$V]=this.txtID),this},a$J.clear=function(){a$J._keymap={},a$J._keymapCount=1},a$J._keymap={},a$J._keymapCount=1,a$J}()},a$a}(),a$At=function(){function a$Q(a$t){this._index=0,this._size=14,this._italic=-2,a$Q._cache2=a$Q._cache2||[],this.setFont(a$t||"14px Arial")}a$H(a$Q,"laya.webgl.text.FontInContext");var a$t=a$Q.prototype;return a$t.setFont=function(a$t){var a$k=a$Q._cache2[a$t];if(a$k)this._words=a$k[0],this._size=a$k[1];else{this._words=a$t.split(" ");for(var a$v=0,a$j=this._words.length;a$v<a$j;a$v++)if(0<this._words[a$v].indexOf("px")){this._index=a$v;break}this._size=parseInt(this._words[this._index]),a$Q._cache2[a$t]=[this._words,this._size]}this._text=null,this._italic=-2},a$t.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},a$t.hasType=function(a$t){for(var a$k=0,a$v=this._words.length;a$k<a$v;a$k++)if(this._words[a$k]===a$t)return a$k;return-1},a$t.removeType=function(a$t){for(var a$k=0,a$v=this._words.length;a$k<a$v;a$k++)if(this._words[a$k]===a$t){this._words.splice(a$k,1),this._index>a$k&&this._index--;break}this._text=null,this._italic=-2},a$t.copyTo=function(a$t){return a$t._text=this._text,a$t._size=this._size,a$t._index=this._index,a$t._words=this._words.slice(),a$t._italic=-2,a$t},a$t.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},a$j(0,a$t,"size",function(){return this._size},function(a$t){this._size=a$t,this._words[this._index]=a$t+"px",this._text=null}),a$Q.create=function(a$t){var a$k=a$Q._cache[a$t];return a$k||(a$k=a$Q._cache[a$t]=new a$Q(a$t))},a$Q.EMPTY=new a$Q,a$Q._cache={},a$Q._cache2=null,a$Q}(),a$Rt=function(){function a$t(){}return a$H(a$t,"laya.webgl.utils.CONST3D2D"),a$t.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a$t.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],a$t.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],a$t._TMPARRAY=[],a$t._OFFSETX=0,a$t._OFFSETY=0,a$S(a$t,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),a$t}(),a$ht=function(){function a$A(){}return a$H(a$A,"laya.webgl.utils.GlUtils"),a$A.make2DProjection=function(a$t,a$k,a$v){return[2/a$t,0,0,0,0,-2/a$k,0,0,0,0,2/a$v,0,-1,1,0,1]},a$A.fillIBQuadrangle=function(a$t,a$k){if(65535/4<a$k)throw Error("IBQuadrangle count:"+a$k+" must<:"+Math.floor(65535/4));a$k=Math.floor(a$k),a$t._resizeBuffer(6*(a$k+1)*2,!1),a$t.byteLength=a$t.bufferLength;for(var a$v=a$t.getUint16Array(),a$j=0,a$Q=0;a$Q<a$k;a$Q++)a$v[a$j++]=4*a$Q,a$v[a$j++]=4*a$Q+2,a$v[a$j++]=4*a$Q+1,a$v[a$j++]=4*a$Q,a$v[a$j++]=4*a$Q+3,a$v[a$j++]=4*a$Q+2;return a$t.setNeedUpload(),!0},a$A.expandIBQuadrangle=function(a$t,a$k){a$t.bufferLength>=6*a$k*2||a$A.fillIBQuadrangle(a$t,a$k)},a$A.mathCeilPowerOfTwo=function(a$t){return a$t--,a$t|=a$t>>1,a$t|=a$t>>2,a$t|=a$t>>4,a$t|=a$t>>8,a$t|=a$t>>16,++a$t},a$A.fillQuadrangleImgVb=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){var a$J=16+(a$t._byteLength>>2);a$t.byteLength=a$J<<2;var a$W=a$t.getFloat32Array();a$W[(a$J-=16)+2]=a$Q[0],a$W[a$J+3]=a$Q[1],a$W[a$J+6]=a$Q[2],a$W[a$J+7]=a$Q[3],a$W[a$J+10]=a$Q[4],a$W[a$J+11]=a$Q[5],a$W[a$J+14]=a$Q[6],a$W[a$J+15]=a$Q[7];var a$w=a$u.a,a$M=a$u.b,a$H=a$u.c,a$E=a$u.d;if(1!==a$w||0!==a$M||0!==a$H||1!==a$E){a$u.bTransform=!0;var a$A=a$u.tx+a$S,a$R=a$u.ty+a$V;a$W[a$J]=(a$j[0]+a$k)*a$w+(a$j[1]+a$v)*a$H+a$A,a$W[a$J+1]=(a$j[0]+a$k)*a$M+(a$j[1]+a$v)*a$E+a$R,a$W[a$J+4]=(a$j[2]+a$k)*a$w+(a$j[3]+a$v)*a$H+a$A,a$W[a$J+5]=(a$j[2]+a$k)*a$M+(a$j[3]+a$v)*a$E+a$R,a$W[a$J+8]=(a$j[4]+a$k)*a$w+(a$j[5]+a$v)*a$H+a$A,a$W[a$J+9]=(a$j[4]+a$k)*a$M+(a$j[5]+a$v)*a$E+a$R,a$W[a$J+12]=(a$j[6]+a$k)*a$w+(a$j[7]+a$v)*a$H+a$A,a$W[a$J+13]=(a$j[6]+a$k)*a$M+(a$j[7]+a$v)*a$E+a$R}else a$u.bTransform=!1,a$k+=a$u.tx+a$S,a$v+=a$u.ty+a$V,a$W[a$J]=a$k+a$j[0],a$W[a$J+1]=a$v+a$j[1],a$W[a$J+4]=a$k+a$j[2],a$W[a$J+5]=a$v+a$j[3],a$W[a$J+8]=a$k+a$j[4],a$W[a$J+9]=a$v+a$j[5],a$W[a$J+12]=a$k+a$j[6],a$W[a$J+13]=a$v+a$j[7];return a$t._upload=!0},a$A.fillTranglesVB=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){var a$V=(a$t._byteLength>>2)+a$j.length;a$t.byteLength=a$V<<2;var a$J=a$t.getFloat32Array();a$V-=a$j.length;for(var a$W=a$j.length,a$w=a$Q.a,a$M=a$Q.b,a$H=a$Q.c,a$E=a$Q.d,a$A=0;a$A<a$W;a$A+=4)if(a$J[a$V+a$A+2]=a$j[a$A+2],a$J[a$V+a$A+3]=a$j[a$A+3],1!==a$w||0!==a$M||0!==a$H||1!==a$E){a$Q.bTransform=!0;var a$R=a$Q.tx+a$u,a$h=a$Q.ty+a$S;a$J[a$V+a$A]=(a$j[a$A]+a$k)*a$w+(a$j[a$A+1]+a$v)*a$H+a$R,a$J[a$V+a$A+1]=(a$j[a$A]+a$k)*a$M+(a$j[a$A+1]+a$v)*a$E+a$h}else a$Q.bTransform=!1,a$k+=a$Q.tx+a$u,a$v+=a$Q.ty+a$S,a$J[a$V+a$A]=a$k+a$j[a$A],a$J[a$V+a$A+1]=a$v+a$j[a$A+1];return a$t._upload=!0},a$A.copyPreImgVb=function(a$t,a$k,a$v){var a$j=a$t._byteLength>>2;a$t.byteLength=a$j+16<<2;for(var a$Q=a$t.getFloat32Array(),a$u=0,a$S=a$j-16;a$u<4;a$u++)a$Q[a$j]=a$Q[a$S]+a$k,++a$S,a$Q[++a$j]=a$Q[a$S]+a$v,++a$S,a$Q[++a$j]=a$Q[a$S],++a$S,a$Q[++a$j]=a$Q[a$S],++a$j,++a$S;a$t._upload=!0},a$A.fillRectImgVb=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w,a$M,a$H){void 0===a$H&&(a$H=!1);var a$E,a$A,a$R,a$h,a$l,a$o,a$Y,a$f,a$X,a$F,a$d,a$m,a$Z,a$s,a$K,a$U,a$N=1,a$a=a$V.a,a$z=a$V.b,a$G=a$V.c,a$c=a$V.d,a$T=a$k&&a$k.width<99999999;if(1!==a$a||0!==a$z||0!==a$G||1!==a$c?(a$V.bTransform=!0,0===a$z&&0===a$G&&(a$N=23,a$X=a$Q+a$v,a$F=a$u+a$j,a$E=a$a*a$v+(a$d=a$V.tx+a$J),a$R=a$a*a$X+a$d,a$A=a$c*a$j+(a$m=a$V.ty+a$W),a$h=a$c*a$F+a$m)):(a$N=23,a$V.bTransform=!1,a$R=(a$E=a$v+a$V.tx+a$J)+a$Q,a$h=(a$A=a$j+a$V.ty+a$W)+a$u),a$T&&(a$l=a$k.x,a$o=a$k.y,a$Y=a$k.width+a$l,a$f=a$k.height+a$o),1!==a$N){if(Math.min(a$E,a$R)>=a$Y)return!1;if(Math.min(a$A,a$h)>=a$f)return!1;if(Math.max(a$R,a$E)<=a$l)return!1;if(Math.max(a$h,a$A)<=a$o)return!1}var a$p=a$t._byteLength>>2;a$t.byteLength=16+a$p<<2;var a$O=a$t.getFloat32Array();switch(a$O[2+a$p]=a$S[0],a$O[3+a$p]=a$S[1],a$O[6+a$p]=a$S[2],a$O[7+a$p]=a$S[3],a$O[10+a$p]=a$S[4],a$O[11+a$p]=a$S[5],a$O[14+a$p]=a$S[6],a$O[15+a$p]=a$S[7],a$N){case 1:a$d=a$V.tx+a$J,a$m=a$V.ty+a$W;var a$n=a$a*a$v,a$_=a$G*a$j,a$x=a$c*a$j,a$I=a$z*a$v,a$i=a$a*(a$X=a$Q+a$v),a$D=a$G*(a$F=a$u+a$j),a$B=a$c*a$F,a$b=a$z*a$X;a$H?(a$Z=a$n+a$_+a$d,a$K=Math.round(a$Z)-a$Z,a$s=a$x+a$I+a$m,a$U=Math.round(a$s)-a$s,a$O[a$p]=a$Z+a$K,a$O[1+a$p]=a$s+a$U,a$O[4+a$p]=a$i+a$_+a$d+a$K,a$O[5+a$p]=a$x+a$b+a$m+a$U,a$O[8+a$p]=a$i+a$D+a$d+a$K,a$O[9+a$p]=a$B+a$b+a$m+a$U,a$O[12+a$p]=a$n+a$D+a$d+a$K,a$O[13+a$p]=a$B+a$I+a$m+a$U):(a$O[a$p]=a$n+a$_+a$d,a$O[1+a$p]=a$x+a$I+a$m,a$O[4+a$p]=a$i+a$_+a$d,a$O[5+a$p]=a$x+a$b+a$m,a$O[8+a$p]=a$i+a$D+a$d,a$O[9+a$p]=a$B+a$b+a$m,a$O[12+a$p]=a$n+a$D+a$d,a$O[13+a$p]=a$B+a$I+a$m);break;case 23:a$H?(a$Z=a$E+a$w,a$K=Math.round(a$Z)-a$Z,a$s=a$A,a$U=Math.round(a$s)-a$s,a$O[a$p]=a$Z+a$K,a$O[1+a$p]=a$s+a$U,a$O[4+a$p]=a$R+a$w+a$K,a$O[5+a$p]=a$A+a$U,a$O[8+a$p]=a$R+a$K,a$O[9+a$p]=a$h+a$U,a$O[12+a$p]=a$E+a$K,a$O[13+a$p]=a$h+a$U):(a$O[a$p]=a$E+a$w,a$O[1+a$p]=a$A,a$O[4+a$p]=a$R+a$w,a$O[5+a$p]=a$A,a$O[8+a$p]=a$R,a$O[9+a$p]=a$h,a$O[12+a$p]=a$E,a$O[13+a$p]=a$h)}return a$t._upload=!0},a$A.fillLineVb=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){var a$J=.5*a$S,a$W=a$A._fillLineArray,a$w=-(a$j-a$u),a$M=a$v-a$Q,a$H=Math.sqrt(a$w*a$w+a$M*a$M);a$w/=a$H,a$M/=a$H,a$w*=a$J,a$M*=a$J,a$W[0]=a$v-a$w,a$W[1]=a$j-a$M,a$W[4]=a$v+a$w,a$W[5]=a$j+a$M,a$W[8]=a$Q+a$w,a$W[9]=a$u+a$M,a$W[12]=a$Q-a$w,a$W[13]=a$u-a$M,a$V&&a$V.transformPointArray(a$W,a$W);var a$E=16+(a$t._byteLength>>2);return a$t.byteLength=a$E<<2,a$t.insertData(a$W,a$E-16),!0},a$A._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],a$A}(),a$lt=(function(){function a$J(){}a$H(a$J,"laya.webgl.utils.MatirxArray"),a$J.ArrayMul=function(a$t,a$k,a$v){if(a$t)if(a$k)for(var a$j=NaN,a$Q=NaN,a$u=NaN,a$S=NaN,a$V=0;a$V<4;a$V++)a$j=a$t[a$V],a$Q=a$t[a$V+4],a$u=a$t[a$V+8],a$S=a$t[a$V+12],a$v[a$V]=a$j*a$k[0]+a$Q*a$k[1]+a$u*a$k[2]+a$S*a$k[3],a$v[a$V+4]=a$j*a$k[4]+a$Q*a$k[5]+a$u*a$k[6]+a$S*a$k[7],a$v[a$V+8]=a$j*a$k[8]+a$Q*a$k[9]+a$u*a$k[10]+a$S*a$k[11],a$v[a$V+12]=a$j*a$k[12]+a$Q*a$k[13]+a$u*a$k[14]+a$S*a$k[15];else a$J.copyArray(a$t,a$v);else a$J.copyArray(a$k,a$v)},a$J.copyArray=function(a$t,a$k){if(a$t&&a$k)for(var a$v=0;a$v<a$t.length;a$v++)a$k[a$v]=a$t[a$v]}}(),function(){function a$k(a$t,a$k,a$v){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=a$t,this._vb=new a$Pt(a$t,35048),a$k&&this._vb._resizeBuffer(a$k,!1),this._ib=new a$yt,a$v&&this._ib._resizeBuffer(a$v,!1)}a$H(a$k,"laya.webgl.utils.Mesh2D");var a$t=a$k.prototype;return a$t.cloneWithNewVB=function(){var a$t=new a$k(this._stride,0,0);return a$t._ib=this._ib,a$t._quadNum=this._quadNum,a$t._attribInfo=this._attribInfo,a$t},a$t.cloneWithNewVBIB=function(){var a$t=new a$k(this._stride,0,0);return a$t._attribInfo=this._attribInfo,a$t},a$t.getVBW=function(){return this._vb.setNeedUpload(),this._vb},a$t.getVBR=function(){return this._vb},a$t.getIBR=function(){return this._ib},a$t.getIBW=function(){return this._ib.setNeedUpload(),this._ib},a$t.createQuadIB=function(a$t){this._quadNum=a$t,this._ib._resizeBuffer(6*a$t*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var a$k=this._ib.getUint16Array(),a$v=0,a$j=0,a$Q=0;a$Q<a$t;a$Q++)a$k[a$v++]=a$j,a$k[a$v++]=a$j+2,a$k[a$v++]=a$j+1,a$k[a$v++]=a$j,a$k[a$v++]=a$j+3,a$k[a$v++]=a$j+2,a$j+=4;this._ib.setNeedUpload()},a$t.setAttributes=function(a$t){if(this._attribInfo=a$t,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},a$t.getEleNum=function(){return this._ib.getBuffer().byteLength/2},a$t.releaseMesh=function(){},a$t.destroy=function(){},a$t.clearVB=function(){this._vb.clear()},a$k._gvaoid=0,a$k}()),a$ot=function(){function a$Q(){}return a$H(a$Q,"laya.webgl.utils.RenderState2D"),a$Q.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},a$Q.mat2MatArray=function(a$t,a$k){var a$v=a$t,a$j=a$k;return a$j[0]=a$v.a,a$j[1]=a$v.b,a$j[2]=a$Q.EMPTYMAT4_ARRAY[2],a$j[3]=a$Q.EMPTYMAT4_ARRAY[3],a$j[4]=a$v.c,a$j[5]=a$v.d,a$j[6]=a$Q.EMPTYMAT4_ARRAY[6],a$j[7]=a$Q.EMPTYMAT4_ARRAY[7],a$j[8]=a$Q.EMPTYMAT4_ARRAY[8],a$j[9]=a$Q.EMPTYMAT4_ARRAY[9],a$j[10]=a$Q.EMPTYMAT4_ARRAY[10],a$j[11]=a$Q.EMPTYMAT4_ARRAY[11],a$j[12]=a$v.tx,a$j[13]=a$v.ty,a$j[14]=a$Q.EMPTYMAT4_ARRAY[14],a$j[15]=a$Q.EMPTYMAT4_ARRAY[15],a$k},a$Q.restoreTempArray=function(){a$Q.TEMPMAT4_ARRAY[0]=1,a$Q.TEMPMAT4_ARRAY[1]=0,a$Q.TEMPMAT4_ARRAY[4]=0,a$Q.TEMPMAT4_ARRAY[5]=1,a$Q.TEMPMAT4_ARRAY[12]=0,a$Q.TEMPMAT4_ARRAY[13]=0},a$Q.clear=function(){a$Q.worldScissorTest=!1,a$Q.worldShaderDefines=null,a$Q.worldFilters=null,a$Q.worldAlpha=1,a$Q.worldClipRect.x=a$Q.worldClipRect.y=0,a$Q.worldClipRect.width=a$Q.width,a$Q.worldClipRect.height=a$Q.height,a$Q.curRenderTarget=null},a$Q._MAXSIZE=99999999,a$Q.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a$Q.worldMatrix4=a$Q.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a$Q.worldAlpha=1,a$Q.worldScissorTest=!1,a$Q.worldFilters=null,a$Q.worldShaderDefines=null,a$Q.curRenderTarget=null,a$Q.width=0,a$Q.height=0,a$S(a$Q,["worldMatrix",function(){return this.worldMatrix=new a$Z},"worldClipRect",function(){return this.worldClipRect=new a$K(0,0,99999999,99999999)}]),a$Q}(),a$Yt=function(){var a$o,a$v;function a$Y(a$t,a$k,a$v,a$j,a$Q){var a$u=this;function a$S(a$t){var a$k=[],a$v=new a$o(a$k);return a$u._compileToTree(a$v,a$t.split("\n"),0,a$k,a$Q),a$v}var a$V=a$E.now();this._VS=a$S(a$k),this._PS=a$S(a$v),this._nameMap=a$j,2<a$E.now()-a$V&&console.log("ShaderCompile use time:"+(a$E.now()-a$V)+"  size:"+a$k.length+"/"+a$v.length)}a$H(a$Y,"laya.webgl.utils.ShaderCompile");var a$t=a$Y.prototype;return a$t._compileToTree=function(a$t,a$k,a$v,a$j,a$Q){var a$u,a$S,a$V,a$J,a$W,a$w,a$M,a$H=0,a$E=0,a$A=0,a$R=0;for(a$E=a$v;a$E<a$k.length;a$E++)if(!((a$V=a$k[a$E]).length<1)&&0!==(a$H=a$V.indexOf("//"))){if(0<=a$H&&(a$V=a$V.substr(0,a$H)),a$u=a$M||new a$o(a$j),a$M=null,a$u.text=a$V,a$u.noCompile=!0,0<=(a$H=a$V.indexOf("#"))){for(a$J="#",a$R=a$H+1,a$A=a$V.length;a$R<a$A;a$R++){var a$h=a$V.charAt(a$R);if(" "===a$h||"\t"===a$h||"\r"===a$h||"\n"===a$h||"?"===a$h)break;a$J+=a$h}switch(a$u.name=a$J){case"#ifdef":case"#ifndef":if(a$u.src=a$V,a$u.noCompile=null!=a$V.match(/[!&|()=<>]/),a$u.noCompile?console.log("function():Boolean{return "+a$V.substr(a$H+a$u.name.length)+"}"):(a$w=a$V.replace(/^\s*/,"").split(/\s+/),a$u.setCondition(a$w[1],"#ifdef"===a$J?1:2),a$u.text="//"+a$u.text),a$u.setParent(a$t),a$t=a$u,a$Q)for(a$w=a$V.substr(a$R).split(a$Y._splitToWordExps3),a$R=0;a$R<a$w.length;a$R++)(a$V=a$w[a$R]).length&&(a$Q[a$V]=!0);continue;case"#if":if(a$u.src=a$V,a$u.noCompile=!0,a$u.setParent(a$t),a$t=a$u,a$Q)for(a$w=a$V.substr(a$R).split(a$Y._splitToWordExps3),a$R=0;a$R<a$w.length;a$R++)(a$V=a$w[a$R]).length&&"defined"!=a$V&&(a$Q[a$V]=!0);continue;case"#else":a$u.src=a$V,a$S=(a$t=a$t.parent).childs[a$t.childs.length-1],a$u.noCompile=a$S.noCompile,a$u.noCompile||(a$u.condition=a$S.condition,a$u.conditionType=1==a$S.conditionType?2:1,a$u.text="//"+a$u.text+" "+a$S.text+" "+a$u.conditionType),a$u.setParent(a$t),a$t=a$u;continue;case"#endif":a$S=(a$t=a$t.parent).childs[a$t.childs.length-1],a$u.noCompile=a$S.noCompile,a$u.noCompile||(a$u.text="//"+a$u.text),a$u.setParent(a$t);continue;case"#include":a$w=a$Y.splitToWords(a$V,null);var a$l=a$Y.includes[a$w[1]];if(!a$l)throw"ShaderCompile error no this include file:"+a$w[1];if((a$H=a$w[0].indexOf("?"))<0){a$u.setParent(a$t),a$V=a$l.getWith("with"==a$w[2]?a$w[3]:null),this._compileToTree(a$u,a$V.split("\n"),0,a$j,a$Q),a$u.text="";continue}a$u.setCondition(a$w[0].substr(a$H+1),1),a$u.text=a$l.getWith("with"==a$w[2]?a$w[3]:null);break;case"#import":a$W=(a$w=a$Y.splitToWords(a$V,null))[1],a$j.push({node:a$u,file:a$Y.includes[a$W],ofs:a$u.text.length});continue}}else{if((a$S=a$t.childs[a$t.childs.length-1])&&!a$S.name){0<a$j.length&&a$Y.splitToWords(a$V,a$S),a$M=a$u,a$S.text+="\n"+a$V;continue}0<a$j.length&&a$Y.splitToWords(a$V,a$u)}a$u.setParent(a$t)}},a$t.createShader=function(a$t,a$k,a$v){var a$j={},a$Q="";if(a$t)for(var a$u in a$t)a$Q+="#define "+a$u+"\n",a$j[a$u]=!0;var a$S=this._VS.toscript(a$j,[]),a$V=this._PS.toscript(a$j,[]);return(a$v||a$et.create)(a$Q+a$S.join("\n"),a$Q+a$V.join("\n"),a$k,this._nameMap)},a$Y._parseOne=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S={type:a$Y.shaderParamsMap[a$v[a$j+1]],name:a$v[a$j+2],size:isNaN(parseInt(a$v[a$j+3]))?1:parseInt(a$v[a$j+3])};return a$u&&("attribute"==a$Q?a$t.push(a$S):a$k.push(a$S)),":"==a$v[a$j+3]&&(a$S.type=a$v[a$j+4],a$j+=2),a$j+=2},a$Y.addInclude=function(a$t,a$k){if(!a$k||0===a$k.length)throw new Error("add shader include file err:"+a$t);if(a$Y.includes[a$t])throw new Error("add shader include file err, has add:"+a$t);a$Y.includes[a$t]=new a$v(a$k)},a$Y.preGetParams=function(a$t,a$k){var a$v=[a$t,a$k],a$j={},a$Q=[],a$u=[],a$S={},a$V=[];a$j.attributes=a$Q,a$j.uniforms=a$u,a$j.defines=a$S;for(var a$J=0,a$W=0,a$w=0;a$w<2;a$w++){a$v[a$w]=a$v[a$w].replace(a$Y._removeAnnotation,"");var a$M,a$H=a$v[a$w].match(a$Y._reg);for(a$J=0,a$W=a$H.length;a$J<a$W;a$J++){var a$E=a$H[a$J];if("attribute"==a$E||"uniform"==a$E)a$J=a$Y._parseOne(a$Q,a$u,a$H,a$J,a$E,!0);else{if("#define"==a$E){a$V[a$E=a$H[++a$J]]=1;continue}if("#ifdef"==a$E){a$S[a$M=a$H[++a$J]]=a$S[a$M]||[];for(a$J++;a$J<a$W;a$J++)if("attribute"==(a$E=a$H[a$J])||"uniform"==a$E)a$J=a$Y._parseOne(a$Q,a$u,a$H,a$J,a$E,a$V[a$M]);else if("#else"==a$E)for(a$J++;a$J<a$W;a$J++)if("attribute"==(a$E=a$H[a$J])||"uniform"==a$E)a$J=a$Y._parseOne(a$Q,a$u,a$H,a$J,a$E,!a$V[a$M]);else if("#endif"==a$E)break}}}}return a$j},a$Y.splitToWords=function(a$t,a$k){for(var a$v,a$j,a$Q=[],a$u=-1,a$S=0,a$V=a$t.length;a$S<a$V;a$S++)if(a$v=a$t.charAt(a$S),0<=" \t=+-*/&%!<>()'\",;".indexOf(a$v)){if(0<=a$u&&1<a$S-a$u&&(a$j=a$t.substr(a$u,a$S-a$u),a$Q.push(a$j)),'"'==a$v||"'"==a$v){var a$J=a$t.indexOf(a$v,a$S+1);if(a$J<0)throw"Sharder err:"+a$t;a$Q.push(a$t.substr(a$S+1,a$J-a$S-1)),a$S=a$J,a$u=-1;continue}"("==a$v&&a$k&&0<a$Q.length&&(a$j=a$Q[a$Q.length-1]+";","vec4;main;".indexOf(a$j)<0&&(a$k.useFuns+=a$j)),a$u=-1}else a$u<0&&(a$u=a$S);return a$u<a$V&&1<a$V-a$u&&(a$j=a$t.substr(a$u,a$V-a$u),a$Q.push(a$j)),a$Q},a$Y.IFDEF_NO=0,a$Y.IFDEF_YES=1,a$Y.IFDEF_ELSE=2,a$Y.IFDEF_PARENT=3,a$Y._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),a$Y._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),a$Y._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),a$Y.includes={},a$S(a$Y,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),a$Y.__init$=function(){a$o=function(){function a$v(a$t){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=a$t}a$H(a$v,"");var a$t=a$v.prototype;return a$t.setParent=function(a$t){a$t.childs.push(this),this.z=a$t.z+1,this.parent=a$t},a$t.setCondition=function(a$t,a$k){a$t&&(this.conditionType=a$k,a$t=a$t.replace(/(\s*$)/g,""),this.condition=function(){return this[a$t]},this.condition.__condition=a$t)},a$t.toscript=function(a$t,a$k){return this._toscript(a$t,a$k,++a$v.__id)},a$t._toscript=function(a$j,a$Q,a$u){if(this.childs.length<1&&!this.text)return a$Q;a$Q.length;if(this.condition){var a$t=!!this.condition.call(a$j);if(2===this.conditionType&&(a$t=!a$t),!a$t)return a$Q}if(this.text&&a$Q.push(this.text),0<this.childs.length&&this.childs.forEach(function(a$t,a$k,a$v){a$t._toscript(a$j,a$Q,a$u)}),0<this.includefiles.length&&0<this.useFuns.length)for(var a$k,a$v=0,a$S=this.includefiles.length;a$v<a$S;a$v++)this.includefiles[a$v].curUseID!=a$u&&0<(a$k=this.includefiles[a$v].file.getFunsScript(this.useFuns)).length&&(this.includefiles[a$v].curUseID=a$u,a$Q[0]=a$k+a$Q[0]);return a$Q},a$v.__id=1,a$v}(),a$v=function(){function a$t(a$t){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=a$t;for(var a$k=0,a$v=0,a$j=0;!((a$k=a$t.indexOf("#begin",a$k))<0);){for(a$j=a$k+5;!((a$j=a$t.indexOf("#end",a$j))<0)&&"i"===a$t.charAt(a$j+4);)a$j+=5;if(a$j<0)throw"add include err,no #end:"+a$t;a$v=a$t.indexOf("\n",a$k);var a$Q=a$Y.splitToWords(a$t.substr(a$k,a$v-a$k),null);"code"==a$Q[1]?this.codes[a$Q[2]]=a$t.substr(a$v+1,a$j-a$v-1):"function"==a$Q[1]&&(a$v=a$t.indexOf("function",a$k),a$v+="function".length,this.funs[a$Q[3]]=a$t.substr(a$v+1,a$j-a$v-1),this.funnames+=a$Q[3]+";"),a$k=a$j+1}}a$H(a$t,"");var a$k=a$t.prototype;return a$k.getWith=function(a$t){var a$k=a$t?this.codes[a$t]:this.script;if(!a$k)throw"get with error:"+a$t;return a$k},a$k.getFunsScript=function(a$t){var a$k="";for(var a$v in this.funs)0<=a$t.indexOf(a$v+";")&&(a$k+=this.funs[a$v]);return a$k},a$t}()},a$Y}(),a$ft=function(){function a$S(){}return a$H(a$S,"laya.webgl.WebGL"),a$S._uint8ArraySlice=function(){for(var a$t=this.length,a$k=new Uint8Array(this.length),a$v=0;a$v<a$t;a$v++)a$k[a$v]=this[a$v];return a$k},a$S._float32ArraySlice=function(){for(var a$t=this.length,a$k=new Float32Array(this.length),a$v=0;a$v<a$t;a$v++)a$k[a$v]=this[a$v];return a$k},a$S._uint16ArraySlice=function(a$t){var a$k,a$v=arguments,a$j=0,a$Q=0;if(0===a$v.length)for(a$j=this.length,a$k=new Uint16Array(a$j),a$Q=0;a$Q<a$j;a$Q++)a$k[a$Q]=this[a$Q];else if(2===a$v.length){var a$u=a$v[0],a$S=a$v[1];if(a$u<a$S)for(a$j=a$S-a$u,a$k=new Uint16Array(a$j),a$Q=a$u;a$Q<a$S;a$Q++)a$k[a$Q-a$u]=this[a$Q];else a$k=new Uint16Array(0)}return a$k},a$S.expandContext=function(){var a$t=a$Q.prototype,a$k=CanvasRenderingContext2D.prototype;a$k.fillTrangles=a$t.fillTrangles,a$rt.__int__(null),a$k.setIBVB=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){void 0===a$J&&(a$J=0),void 0===a$W&&(a$W=0),null===a$v&&(this._ib=this._ib||a$yt.QuadrangleIB,a$v=this._ib,a$ht.expandIBQuadrangle(a$v,a$j._byteLength/64+8)),this._setIBVB(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W)},a$k.fillTrangles=function(a$t,a$k,a$v,a$j,a$Q){this._curMat=this._curMat||a$Z.create(),this._vb=this._vb||a$Pt.create(),this._ib||(this._ib=a$yt.create(),a$ht.fillIBQuadrangle(this._ib,a$S/4));var a$u=this._vb,a$S=a$j.length>>4;a$ht.fillTranglesVB(a$u,a$k,a$v,a$j,a$Q||this._curMat,0,0),a$ht.expandIBQuadrangle(this._ib,a$u._byteLength/64+8);var a$V=new a$mt(1,0);a$V.textureHost=a$t;var a$J=new a$$t("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");a$u._vertType=3,this._setIBVB(a$k,a$v,this._ib,a$u,6*a$S,a$Q,a$J,a$V,0,0)}},a$S.enable=function(){if(a$E.__init__(),a$l.isConchApp&&!a$l.isConchWebGL)return a$X.skinAniSprite=function(){return new a$tt},a$S.expandContext(),!1;if(a$X.getWebGLContext=function(a$t){for(var a$k,a$v=["webgl","experimental-webgl","webkit-3d","moz-webgl"],a$j=0;a$j<a$v.length;a$j++){try{a$k=a$t.getContext(a$v[a$j],{stencil:a$d.isStencil,alpha:a$d.isAlpha,antialias:a$d.isAntialias,premultipliedAlpha:a$d.premultipliedAlpha,preserveDrawingBuffer:a$d.preserveDrawingBuffer})}catch(a$t){}if(a$k)return a$k}return null},null==(a$S.mainContext=a$X.getWebGLContext(a$l._mainCanvas)))return!1;if(a$l.isWebGL)return!0;a$R.create=function(a$t,a$k){return new a$tk(a$t,a$k)},a$h.create=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){return new a$Lt(a$t,a$k,a$v,a$j,a$Q,a$u,a$S)},a$l.WebGL=a$S,a$l.isWebGL=!0,a$Et.__init__(),a$X.createRenderSprite=function(a$t,a$k){return new a$Zt(a$t,a$k)},a$X.createWebGLContext2D=function(a$t){return new a$dt(a$t)},a$X.changeWebGLSize=function(a$t,a$k){laya.webgl.WebGL.onStageResize(a$t,a$k)},a$X.createGraphics=function(){return new a$Ft};var a$t=a$X.createFilterAction;return a$X.createFilterAction=a$t||function(a$t){return new a$st},a$X.clear=function(a$t){a$ot.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var a$k=a$l.context.ctx,a$v=0==a$k._submits._length||a$d.preserveDrawingBuffer?a$A.create(a$t)._color:a$N._wgColor;a$v&&a$k.clearBG(a$v[0],a$v[1],a$v[2],a$v[3]),a$ot.clear()},a$X.addToAtlas=function(a$t,a$k){void 0===a$k&&(a$k=!1);var a$v=a$t.bitmap;a$l.optimizeTextureMemory(a$t.url,a$t)?a$F.__typeof(a$v,"laya.webgl.resource.IMergeAtlasBitmap")&&a$v.allowMerageInAtlas&&a$v.on("recovered",a$t,a$t.addTextureToAtlas):a$v.enableMerageInAtlas=!1},a$X.isAtlas=function(a$t){return a$t instanceof laya.webgl.atlas.AtlasWebGLCanvas},a$I._enable(),a$X.beginFlush=function(){for(var a$t=a$I.instance,a$k=a$t.getAtlaserCount(),a$v=0;a$v<a$k;a$v++){var a$j=a$t.getAtlaserByIndex(a$v).texture;a$j._flashCacheImageNeedFlush&&a$X.flashFlushImage(a$j)}},a$X.drawToCanvas=function(a$t,a$k,a$v,a$j,a$Q,a$u){(a$v<=0||a$j<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),a$v|=0,a$j|=0,a$Q|=0,a$u|=0;var a$S=a$Ot.create(a$v,a$j,6408,5121,0,!1);a$S.start(),a$S.clear(0,0,0,0),a$l.context.clear(),a$o.renders[a$k]._fun(a$t,a$l.context,a$Q,a$ot.height-a$j+a$u),a$l.context.flush(),a$S.end();var a$V=a$S.getData(0,0,a$v,a$j);if(a$S.recycle(),a$V.byteLength==a$v*a$j*4){var a$J=new a$bt;a$J._canvas=a$E.createElement("canvas"),a$J.size(a$v,a$j);var a$W=a$J._canvas.getContext("2d");a$E.canvas.size(a$v,a$j);var a$w=a$E.context,a$M=a$w.createImageData(a$v,a$j);return a$M.data.set(new Uint8ClampedArray(a$V.buffer)),a$J._imgData=a$M,a$w.putImageData(a$M,0,0),a$W.save(),a$W.translate(0,a$j),a$W.scale(1,-1),a$W.drawImage(a$E.canvas.source,0,0),a$W.restore(),a$J}console.log("drawToCanvas error: w:"+a$v+",h:"+a$j+",datalen:"+a$V.byteLength)},a$X.createFilterAction=function(a$t){var a$k;switch(a$t){case 32:a$k=new a$st}return a$k},a$X.addTextureToAtlas=function(a$t){a$t._uvID++,a$I._atlasRestore++,a$t.bitmap.enableMerageInAtlas&&a$I.instance.addToAtlas(a$t)},a$X.getTexturePixels=function(a$t,a$k,a$v,a$j,a$Q){a$l.context.ctx.clear();var a$u=new a$U;a$u.graphics.drawTexture(a$t,-a$k,-a$v);var a$S=a$Ot.create(a$j,a$Q);a$S.start(),a$S.clear(0,0,0,0),a$u.render(a$l.context,0,0),a$l.context.ctx.flush(),a$S.end();for(var a$V=a$S.getData(0,0,a$j,a$Q),a$J=[],a$W=0,a$w=a$Q-1;0<=a$w;a$w--)for(var a$M=0;a$M<a$j;a$M++)a$W=4*(a$w*a$j+a$M),a$J.push(a$V[a$W]),a$J.push(a$V[a$W+1]),a$J.push(a$V[a$W+2]),a$J.push(a$V[a$W+3]);return a$J},a$X.skinAniSprite=function(){return new a$tt},a$W.create=function(a$t,a$k){var a$v=new a$bt;return a$v._imgData=a$k,a$v.flipY=!1,a$v},a$m._filterStart=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$t.getValue("bounds"),a$S=a$Ot.create(a$u.width,a$u.height);if(a$S.start(),a$S.clear(0,0,0,0),a$t.addValue("src",a$S),a$t.addValue("ScissorTest",a$ot.worldScissorTest),a$ot.worldScissorTest){var a$V=new a$K;a$V.copyFrom(a$v.ctx._clipRect),a$t.addValue("clipRect",a$V),a$ot.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},a$m._filterEnd=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$t.getValue("bounds");a$t.getValue("src").end();var a$S=a$Ot.create(a$u.width,a$u.height);a$S.start(),a$S.clear(0,0,0,0),a$t.addValue("out",a$S),a$k._set$P("_filterCache",a$S),a$k._set$P("_isHaveGlowFilter",a$t.getValue("_isHaveGlowFilter"))},a$m._EndTarget=function(a$t,a$k){if(a$t.getValue("src").recycle(),a$t.getValue("out").end(),a$t.getValue("ScissorTest")){a$ot.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),a$k.ctx.save();var a$v=a$t.getValue("clipRect");a$k.ctx.clipRect(a$v.x,a$v.y,a$v.width,a$v.height)}},a$m._useSrc=function(a$t){var a$k=a$t.getValue("out");a$k.end(),(a$k=a$t.getValue("src")).start(),a$k.clear(0,0,0,0)},a$m._endSrc=function(a$t){a$t.getValue("src").end()},a$m._useOut=function(a$t){var a$k=a$t.getValue("src");a$k.end(),(a$k=a$t.getValue("out")).start(),a$k.clear(0,0,0,0)},a$m._endOut=function(a$t){a$t.getValue("out").end()},a$m._recycleScope=function(a$t){a$t.recycle()},a$m._filter=function(a$t,a$k,a$v,a$j){var a$Q=this._next;if(a$Q){var a$u,a$S,a$V=a$t.filters,a$J=a$V.length;if(1==a$J&&32==a$V[0].type)return a$k.ctx.save(),a$k.ctx.setFilters([a$V[0]]),a$Q._fun.call(a$Q,a$t,a$k,a$v,a$j),void a$k.ctx.restore();var a$W=a$Vt.create(),a$w=a$s.TEMP,a$M=a$k.ctx._getTransformMatrix(),a$H=a$Z.create();a$M.copyTo(a$H);var a$E=0,a$A=0,a$R=!1,a$h=a$t._$P._filterCache?a$t._$P._filterCache:null;if(!a$h||a$t._repaint){a$R=a$t._isHaveGlowFilter(),a$W.addValue("_isHaveGlowFilter",a$R),a$R&&(a$E=50,a$A=25),(a$S=new a$K).copyFrom(a$t.getSelfBounds()),a$S.x+=a$t.x,a$S.y+=a$t.y,a$S.x-=a$t.pivotX+4,a$S.y-=a$t.pivotY+4;var a$l=a$S.x,a$o=a$S.y;if(a$S.width+=a$E+8,a$S.height+=a$E+8,a$w.x=a$S.x*a$H.a+a$S.y*a$H.c,a$w.y=a$S.y*a$H.d+a$S.x*a$H.b,a$S.x=a$w.x,a$S.y=a$w.y,a$w.x=a$S.width*a$H.a+a$S.height*a$H.c,a$w.y=a$S.height*a$H.d+a$S.width*a$H.b,a$S.width=a$w.x,a$S.height=a$w.y,a$S.width<=0||a$S.height<=0)return;a$h&&a$h.recycle(),a$W.addValue("bounds",a$S);var a$Y=a$St.create([a$W,a$t,a$k,0,0],a$m._filterStart);a$k.addRenderObject(a$Y),a$k.ctx._renderKey=0,a$k.ctx._shader2D.glTexture=null;var a$f=a$t.x-a$l+a$A,a$X=a$t.y-a$o+a$A;a$Q._fun.call(a$Q,a$t,a$k,a$f,a$X),a$Y=a$St.create([a$W,a$t,a$k,0,0],a$m._filterEnd),a$k.addRenderObject(a$Y);for(var a$F=0;a$F<a$J;a$F++){0!=a$F&&(a$Y=a$St.create([a$W],a$m._useSrc),a$k.addRenderObject(a$Y),a$u=a$mt.create(1,0),a$Z.TEMP.identity(),a$k.ctx.drawTarget(a$W,0,0,a$S.width,a$S.height,a$Z.TEMP,"out",a$u,null,a$D.TOINT.overlay),a$Y=a$St.create([a$W],a$m._useOut),a$k.addRenderObject(a$Y)),a$V[a$F].action.apply3d(a$W,a$t,a$k,0,0)}a$Y=a$St.create([a$W,a$k],a$m._EndTarget),a$k.addRenderObject(a$Y)}else{if((a$R=!!a$t._$P._isHaveGlowFilter&&a$t._$P._isHaveGlowFilter)&&(a$E=50,a$A=25),(a$S=a$t.getBounds()).width<=0||a$S.height<=0)return;a$S.width+=a$E,a$S.height+=a$E,a$w.x=a$S.x*a$H.a+a$S.y*a$H.c,a$w.y=a$S.y*a$H.d+a$S.x*a$H.b,a$S.x=a$w.x,a$S.y=a$w.y,a$w.x=a$S.width*a$H.a+a$S.height*a$H.c,a$w.y=a$S.height*a$H.d+a$S.width*a$H.b,a$S.width=a$w.x,a$S.height=a$w.y,a$W.addValue("out",a$h)}a$v=a$v-a$A-a$t.x,a$j=a$j-a$A-a$t.y,a$w.setTo(a$v,a$j),a$H.transformPoint(a$w),a$v=a$w.x+a$S.x,a$j=a$w.y+a$S.y,a$u=a$mt.create(1,0),a$Z.TEMP.identity(),a$k.ctx.drawTarget(a$W,a$v,a$j,a$S.width,a$S.height,a$Z.TEMP,"out",a$u,null,a$D.TOINT.overlay),a$Y=a$St.create([a$W],a$m._recycleScope),a$k.addRenderObject(a$Y),a$H.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=a$S._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=a$S._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=a$S._uint8ArraySlice),!0},a$S.onStageResize=function(a$t,a$k){null!=a$S.mainContext&&(a$S.mainContext.viewport(0,0,a$t,a$k),a$ot.width=a$t,a$ot.height=a$k)},a$S.onInvalidGLRes=function(){a$I.instance.freeAll(),a$f.releaseContentManagers(!0),a$S.doNodeRepaint(a$F.stage),a$S.mainContext.viewport(0,0,a$ot.width,a$ot.height),a$F.stage.event("devicelost")},a$S.doNodeRepaint=function(a$t){0==a$t.numChildren&&a$t.repaint();for(var a$k=0;a$k<a$t.numChildren;a$k++)a$S.doNodeRepaint(a$t.getChildAt(a$k))},a$S.init=function(a$t,a$k,a$v){a$S.mainCanvas=a$t,a$W._createContext=function(a$t){return new a$dt(a$t)},a$bt._createContext=function(a$t){return new a$dt(a$t)};var a$j=laya.webgl.WebGL.mainContext;if(null!=a$j.getShaderPrecisionFormat){var a$Q=a$j.getShaderPrecisionFormat(35633,36338),a$u=a$j.getShaderPrecisionFormat(35632,36338);a$S.shaderHighPrecision=!(!a$Q.precision||!a$u.precision)}else a$S.shaderHighPrecision=!1;if(a$j.deleteTexture1=a$j.deleteTexture,a$j.deleteTexture=function(a$t){a$t==a$Xt.curBindTexValue&&(a$Xt.curBindTexValue=null),a$j.deleteTexture1(a$t)},a$S.onStageResize(a$k,a$v),null==a$S.mainContext)throw new Error("webGL getContext err!");a$G.__init__(),a$I.__init__(),a$Ut.__init__(),a$ut.__init__(),a$dt.__init__(),a$mt.__init__(),a$y.__init__(),a$rt.__int__(a$j),a$D._init_(a$j),a$l.isConchApp&&conch.setOnInvalidGLRes(a$S.onInvalidGLRes)},a$S.mainCanvas=null,a$S.mainContext=null,a$S.antialias=!0,a$S.shaderHighPrecision=!1,a$S._bg_null=[0,0,0,0],a$S}(),a$Xt=function(){function a$j(){}return a$H(a$j,"laya.webgl.WebGLContext"),a$j.UseProgram=function(a$t){return a$j._useProgram!==a$t&&(a$ft.mainContext.useProgram(a$t),a$j._useProgram=a$t,!0)},a$j.setDepthTest=function(a$t,a$k){a$k!==a$j._depthTest&&((a$j._depthTest=a$k)?a$t.enable(2929):a$t.disable(2929))},a$j.setDepthMask=function(a$t,a$k){a$k!==a$j._depthMask&&(a$j._depthMask=a$k,a$t.depthMask(a$k))},a$j.setDepthFunc=function(a$t,a$k){a$k!==a$j._depthFunc&&(a$j._depthFunc=a$k,a$t.depthFunc(a$k))},a$j.setBlend=function(a$t,a$k){a$k!==a$j._blend&&((a$j._blend=a$k)?a$t.enable(3042):a$t.disable(3042))},a$j.setBlendFunc=function(a$t,a$k,a$v){(a$k!==a$j._sFactor||a$v!==a$j._dFactor)&&(a$j._sFactor=a$k,a$j._dFactor=a$v,a$t.blendFunc(a$k,a$v))},a$j.setCullFace=function(a$t,a$k){a$k!==a$j._cullFace&&((a$j._cullFace=a$k)?a$t.enable(2884):a$t.disable(2884))},a$j.setFrontFace=function(a$t,a$k){a$k!==a$j._frontFace&&(a$j._frontFace=a$k,a$t.frontFace(a$k))},a$j.bindTexture=function(a$t,a$k,a$v){a$t.bindTexture(a$k,a$v),a$j.curBindTexTarget=a$k,a$j.curBindTexValue=a$v},a$j.DEPTH_BUFFER_BIT=256,a$j.STENCIL_BUFFER_BIT=1024,a$j.COLOR_BUFFER_BIT=16384,a$j.POINTS=0,a$j.LINES=1,a$j.LINE_LOOP=2,a$j.LINE_STRIP=3,a$j.TRIANGLES=4,a$j.TRIANGLE_STRIP=5,a$j.TRIANGLE_FAN=6,a$j.ZERO=0,a$j.ONE=1,a$j.SRC_COLOR=768,a$j.ONE_MINUS_SRC_COLOR=769,a$j.SRC_ALPHA=770,a$j.ONE_MINUS_SRC_ALPHA=771,a$j.DST_ALPHA=772,a$j.ONE_MINUS_DST_ALPHA=773,a$j.DST_COLOR=774,a$j.ONE_MINUS_DST_COLOR=775,a$j.SRC_ALPHA_SATURATE=776,a$j.FUNC_ADD=32774,a$j.BLEND_EQUATION=32777,a$j.BLEND_EQUATION_RGB=32777,a$j.BLEND_EQUATION_ALPHA=34877,a$j.FUNC_SUBTRACT=32778,a$j.FUNC_REVERSE_SUBTRACT=32779,a$j.BLEND_DST_RGB=32968,a$j.BLEND_SRC_RGB=32969,a$j.BLEND_DST_ALPHA=32970,a$j.BLEND_SRC_ALPHA=32971,a$j.CONSTANT_COLOR=32769,a$j.ONE_MINUS_CONSTANT_COLOR=32770,a$j.CONSTANT_ALPHA=32771,a$j.ONE_MINUS_CONSTANT_ALPHA=32772,a$j.BLEND_COLOR=32773,a$j.ARRAY_BUFFER=34962,a$j.ELEMENT_ARRAY_BUFFER=34963,a$j.ARRAY_BUFFER_BINDING=34964,a$j.ELEMENT_ARRAY_BUFFER_BINDING=34965,a$j.STREAM_DRAW=35040,a$j.STATIC_DRAW=35044,a$j.DYNAMIC_DRAW=35048,a$j.BUFFER_SIZE=34660,a$j.BUFFER_USAGE=34661,a$j.CURRENT_VERTEX_ATTRIB=34342,a$j.FRONT=1028,a$j.BACK=1029,a$j.CULL_FACE=2884,a$j.FRONT_AND_BACK=1032,a$j.BLEND=3042,a$j.DITHER=3024,a$j.STENCIL_TEST=2960,a$j.DEPTH_TEST=2929,a$j.SCISSOR_TEST=3089,a$j.POLYGON_OFFSET_FILL=32823,a$j.SAMPLE_ALPHA_TO_COVERAGE=32926,a$j.SAMPLE_COVERAGE=32928,a$j.NO_ERROR=0,a$j.INVALID_ENUM=1280,a$j.INVALID_VALUE=1281,a$j.INVALID_OPERATION=1282,a$j.OUT_OF_MEMORY=1285,a$j.CW=2304,a$j.CCW=2305,a$j.LINE_WIDTH=2849,a$j.ALIASED_POINT_SIZE_RANGE=33901,a$j.ALIASED_LINE_WIDTH_RANGE=33902,a$j.CULL_FACE_MODE=2885,a$j.FRONT_FACE=2886,a$j.DEPTH_RANGE=2928,a$j.DEPTH_WRITEMASK=2930,a$j.DEPTH_CLEAR_VALUE=2931,a$j.DEPTH_FUNC=2932,a$j.STENCIL_CLEAR_VALUE=2961,a$j.STENCIL_FUNC=2962,a$j.STENCIL_FAIL=2964,a$j.STENCIL_PASS_DEPTH_FAIL=2965,a$j.STENCIL_PASS_DEPTH_PASS=2966,a$j.STENCIL_REF=2967,a$j.STENCIL_VALUE_MASK=2963,a$j.STENCIL_WRITEMASK=2968,a$j.STENCIL_BACK_FUNC=34816,a$j.STENCIL_BACK_FAIL=34817,a$j.STENCIL_BACK_PASS_DEPTH_FAIL=34818,a$j.STENCIL_BACK_PASS_DEPTH_PASS=34819,a$j.STENCIL_BACK_REF=36003,a$j.STENCIL_BACK_VALUE_MASK=36004,a$j.STENCIL_BACK_WRITEMASK=36005,a$j.VIEWPORT=2978,a$j.SCISSOR_BOX=3088,a$j.COLOR_CLEAR_VALUE=3106,a$j.COLOR_WRITEMASK=3107,a$j.UNPACK_ALIGNMENT=3317,a$j.PACK_ALIGNMENT=3333,a$j.MAX_TEXTURE_SIZE=3379,a$j.MAX_VIEWPORT_DIMS=3386,a$j.SUBPIXEL_BITS=3408,a$j.RED_BITS=3410,a$j.GREEN_BITS=3411,a$j.BLUE_BITS=3412,a$j.ALPHA_BITS=3413,a$j.DEPTH_BITS=3414,a$j.STENCIL_BITS=3415,a$j.POLYGON_OFFSET_UNITS=10752,a$j.POLYGON_OFFSET_FACTOR=32824,a$j.TEXTURE_BINDING_2D=32873,a$j.SAMPLE_BUFFERS=32936,a$j.SAMPLES=32937,a$j.SAMPLE_COVERAGE_VALUE=32938,a$j.SAMPLE_COVERAGE_INVERT=32939,a$j.NUM_COMPRESSED_TEXTURE_FORMATS=34466,a$j.COMPRESSED_TEXTURE_FORMATS=34467,a$j.DONT_CARE=4352,a$j.FASTEST=4353,a$j.NICEST=4354,a$j.GENERATE_MIPMAP_HINT=33170,a$j.BYTE=5120,a$j.UNSIGNED_BYTE=5121,a$j.SHORT=5122,a$j.UNSIGNED_SHORT=5123,a$j.INT=5124,a$j.UNSIGNED_INT=5125,a$j.FLOAT=5126,a$j.DEPTH_COMPONENT=6402,a$j.ALPHA=6406,a$j.RGB=6407,a$j.RGBA=6408,a$j.LUMINANCE=6409,a$j.LUMINANCE_ALPHA=6410,a$j.UNSIGNED_SHORT_4_4_4_4=32819,a$j.UNSIGNED_SHORT_5_5_5_1=32820,a$j.UNSIGNED_SHORT_5_6_5=33635,a$j.FRAGMENT_SHADER=35632,a$j.VERTEX_SHADER=35633,a$j.MAX_VERTEX_ATTRIBS=34921,a$j.MAX_VERTEX_UNIFORM_VECTORS=36347,a$j.MAX_VARYING_VECTORS=36348,a$j.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,a$j.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,a$j.MAX_TEXTURE_IMAGE_UNITS=34930,a$j.MAX_FRAGMENT_UNIFORM_VECTORS=36349,a$j.SHADER_TYPE=35663,a$j.DELETE_STATUS=35712,a$j.LINK_STATUS=35714,a$j.VALIDATE_STATUS=35715,a$j.ATTACHED_SHADERS=35717,a$j.ACTIVE_UNIFORMS=35718,a$j.ACTIVE_ATTRIBUTES=35721,a$j.SHADING_LANGUAGE_VERSION=35724,a$j.CURRENT_PROGRAM=35725,a$j.NEVER=512,a$j.LESS=513,a$j.EQUAL=514,a$j.LEQUAL=515,a$j.GREATER=516,a$j.NOTEQUAL=517,a$j.GEQUAL=518,a$j.ALWAYS=519,a$j.KEEP=7680,a$j.REPLACE=7681,a$j.INCR=7682,a$j.DECR=7683,a$j.INVERT=5386,a$j.INCR_WRAP=34055,a$j.DECR_WRAP=34056,a$j.VENDOR=7936,a$j.RENDERER=7937,a$j.VERSION=7938,a$j.NEAREST=9728,a$j.LINEAR=9729,a$j.NEAREST_MIPMAP_NEAREST=9984,a$j.LINEAR_MIPMAP_NEAREST=9985,a$j.NEAREST_MIPMAP_LINEAR=9986,a$j.LINEAR_MIPMAP_LINEAR=9987,a$j.TEXTURE_MAG_FILTER=10240,a$j.TEXTURE_MIN_FILTER=10241,a$j.TEXTURE_WRAP_S=10242,a$j.TEXTURE_WRAP_T=10243,a$j.TEXTURE_2D=3553,a$j.TEXTURE=5890,a$j.TEXTURE_CUBE_MAP=34067,a$j.TEXTURE_BINDING_CUBE_MAP=34068,a$j.TEXTURE_CUBE_MAP_POSITIVE_X=34069,a$j.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,a$j.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,a$j.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,a$j.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,a$j.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,a$j.MAX_CUBE_MAP_TEXTURE_SIZE=34076,a$j.TEXTURE0=33984,a$j.TEXTURE1=33985,a$j.TEXTURE2=33986,a$j.TEXTURE3=33987,a$j.TEXTURE4=33988,a$j.TEXTURE5=33989,a$j.TEXTURE6=33990,a$j.TEXTURE7=33991,a$j.TEXTURE8=33992,a$j.TEXTURE9=33993,a$j.TEXTURE10=33994,a$j.TEXTURE11=33995,a$j.TEXTURE12=33996,a$j.TEXTURE13=33997,a$j.TEXTURE14=33998,a$j.TEXTURE15=33999,a$j.TEXTURE16=34e3,a$j.TEXTURE17=34001,a$j.TEXTURE18=34002,a$j.TEXTURE19=34003,a$j.TEXTURE20=34004,a$j.TEXTURE21=34005,a$j.TEXTURE22=34006,a$j.TEXTURE23=34007,a$j.TEXTURE24=34008,a$j.TEXTURE25=34009,a$j.TEXTURE26=34010,a$j.TEXTURE27=34011,a$j.TEXTURE28=34012,a$j.TEXTURE29=34013,a$j.TEXTURE30=34014,a$j.TEXTURE31=34015,a$j.ACTIVE_TEXTURE=34016,a$j.REPEAT=10497,a$j.CLAMP_TO_EDGE=33071,a$j.MIRRORED_REPEAT=33648,a$j.FLOAT_VEC2=35664,a$j.FLOAT_VEC3=35665,a$j.FLOAT_VEC4=35666,a$j.INT_VEC2=35667,a$j.INT_VEC3=35668,a$j.INT_VEC4=35669,a$j.BOOL=35670,a$j.BOOL_VEC2=35671,a$j.BOOL_VEC3=35672,a$j.BOOL_VEC4=35673,a$j.FLOAT_MAT2=35674,a$j.FLOAT_MAT3=35675,a$j.FLOAT_MAT4=35676,a$j.SAMPLER_2D=35678,a$j.SAMPLER_CUBE=35680,a$j.VERTEX_ATTRIB_ARRAY_ENABLED=34338,a$j.VERTEX_ATTRIB_ARRAY_SIZE=34339,a$j.VERTEX_ATTRIB_ARRAY_STRIDE=34340,a$j.VERTEX_ATTRIB_ARRAY_TYPE=34341,a$j.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,a$j.VERTEX_ATTRIB_ARRAY_POINTER=34373,a$j.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,a$j.COMPILE_STATUS=35713,a$j.LOW_FLOAT=36336,a$j.MEDIUM_FLOAT=36337,a$j.HIGH_FLOAT=36338,a$j.LOW_INT=36339,a$j.MEDIUM_INT=36340,a$j.HIGH_INT=36341,a$j.FRAMEBUFFER=36160,a$j.RENDERBUFFER=36161,a$j.RGBA4=32854,a$j.RGB5_A1=32855,a$j.RGB565=36194,a$j.DEPTH_COMPONENT16=33189,a$j.STENCIL_INDEX=6401,a$j.STENCIL_INDEX8=36168,a$j.DEPTH_STENCIL=34041,a$j.RENDERBUFFER_WIDTH=36162,a$j.RENDERBUFFER_HEIGHT=36163,a$j.RENDERBUFFER_INTERNAL_FORMAT=36164,a$j.RENDERBUFFER_RED_SIZE=36176,a$j.RENDERBUFFER_GREEN_SIZE=36177,a$j.RENDERBUFFER_BLUE_SIZE=36178,a$j.RENDERBUFFER_ALPHA_SIZE=36179,a$j.RENDERBUFFER_DEPTH_SIZE=36180,a$j.RENDERBUFFER_STENCIL_SIZE=36181,a$j.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,a$j.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,a$j.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,a$j.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,a$j.COLOR_ATTACHMENT0=36064,a$j.DEPTH_ATTACHMENT=36096,a$j.STENCIL_ATTACHMENT=36128,a$j.DEPTH_STENCIL_ATTACHMENT=33306,a$j.NONE=0,a$j.FRAMEBUFFER_COMPLETE=36053,a$j.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,a$j.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,a$j.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,a$j.FRAMEBUFFER_UNSUPPORTED=36061,a$j.FRAMEBUFFER_BINDING=36006,a$j.RENDERBUFFER_BINDING=36007,a$j.MAX_RENDERBUFFER_SIZE=34024,a$j.INVALID_FRAMEBUFFER_OPERATION=1286,a$j.UNPACK_FLIP_Y_WEBGL=37440,a$j.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,a$j.CONTEXT_LOST_WEBGL=37442,a$j.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,a$j.BROWSER_DEFAULT_WEBGL=37444,a$j._useProgram=null,a$j._depthTest=!0,a$j._depthMask=!0,a$j._blend=!1,a$j._cullFace=!1,a$j.curBindTexTarget=null,a$j.curBindTexValue=null,a$S(a$j,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),a$j}(),a$Ft=function(a$t){function a$k(){a$k.__super.call(this)}a$H(a$k,"laya.webgl.display.GraphicsGL",a$V);var a$v=a$k.prototype;return a$v.setShader=function(a$t){this._saveToCmd(a$l.context._setShader,[a$t])},a$v.setIBVB=function(a$t,a$k,a$v,a$j,a$Q,a$u){this._saveToCmd(a$l.context._setIBVB,[a$t,a$k,a$v,a$j,a$Q,a$u])},a$v.drawParticle=function(a$t,a$k,a$v){var a$j=a$X.createParticleTemplate2D(a$v);a$j.x=a$t,a$j.y=a$k,this._saveToCmd(a$l.context._drawParticle,[a$j])},a$k}(),a$dt=function(a$t){var a$v;function a$x(a$t){this._x=0,this._y=0,this._id=++a$x._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,a$x.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=a$x.MAXCLIPRECT,this.mOutPoint,this._canvas=a$t,this._canvas._addReference(),a$x._contextcount++,a$l.isFlash?(this._ib=a$yt.create(35044),a$ht.fillIBQuadrangle(this._ib,16)):this._ib=a$yt.QuadrangleIB,this.clear()}a$H(a$x,"laya.webgl.canvas.WebGLContext2D",a$Q);var a$k=a$x.prototype;return a$k.setIsMainContext=function(){this._isMain=!0},a$k.clearBG=function(a$t,a$k,a$v,a$j){var a$Q=a$ft.mainContext;a$Q.clearColor(a$t,a$k,a$v,a$j),a$Q.clear(16384)},a$k._getSubmits=function(){return this._submits},a$k._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var a$t=0,a$k=this._submits._length;a$t<a$k;a$t++)this._submits[a$t].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},a$k.destroy=function(){--a$x._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=a$yt.QuadrangleIB&&this._ib.releaseResource()},a$k.clear=function(){this._submits||(this._other=a$v.DEFAULT,this._curMat=a$Z.create(),this._vb=a$Pt.create(-1),this._submits=[],this._save=[a$e.Create(this)],this._save.length=10,this._shader2D=new a$y,this._triangleMesh=a$Tt.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=a$v.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=a$x.MAXCLIPRECT,this._curSubmit=a$ut.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=a$B.DEFAULT;for(var a$t=0,a$k=this._submits._length;a$t<a$k;a$t++)this._submits[a$t].releaseRender(),this._submits[a$t]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},a$k.size=function(a$t,a$k){if(this._width!=a$t||this._height!=a$k)if(0==a$t||0==a$k){0!=this._vb._byteLength&&(this._width=a$t,this._height=a$k,this._vb.clear(),this._vb.upload());for(var a$v=0,a$j=this._submits._length;a$v<a$j;a$v++)this._submits[a$v].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=a$t,this._height=a$k,this._targets&&this._targets.size(a$t,a$k),this._canvas.memorySize-=this._canvas.memorySize;0===a$t&&0===a$k&&this._releaseMem()},a$k._getTransformMatrix=function(){return this._curMat},a$k.translate=function(a$t,a$k){0===a$t&&0===a$k||(a$g.save(this),this._curMat.bTransform&&(a$r.save(this),this._curMat.transformPointN(a$s.TEMP.setTo(a$t,a$k)),a$t=a$s.TEMP.x,a$k=a$s.TEMP.y),this._x+=a$t,this._y+=a$k)},a$k.save=function(){this._save[this._save._length++]=a$e.Create(this)},a$k.restore=function(){var a$t=this._save._length;if(!(a$t<1))for(var a$k=a$t-1;0<=a$k;a$k--){var a$v=this._save[a$k];if(a$v.restore(this),a$v.isSaveMark())return void(this._save._length=a$k)}},a$k._fillText=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){void 0===a$W&&(a$W=0);var a$w=this._shader2D,a$M=this._curSubmit.shaderValue,a$H=a$Q?a$At.create(a$Q):this._other.font;if(a$I.enabled)a$w.ALPHA!==a$M.ALPHA&&(a$w.glTexture=null),a$Et.drawText(this,a$t,a$k,this._curMat,a$H,a$J||this._other.textAlign,a$u,a$S,a$V,a$v,a$j,a$W);else{this._shader2D.defines.getValue();var a$E=a$u?a$A.create(a$u)._color:a$w.colorAdd;a$w.ALPHA===a$M.ALPHA&&a$E===a$w.colorAdd&&a$M.colorAdd===a$w.colorAdd||(a$w.glTexture=null,a$w.colorAdd=a$E),a$Et.drawText(this,a$t,a$k,this._curMat,a$H,a$J||this._other.textAlign,a$u,a$S,a$V,a$v,a$j,a$W)}},a$k.fillWords=function(a$t,a$k,a$v,a$j,a$Q,a$u){this._fillText(null,a$t,a$k,a$v,a$j,a$Q,null,-1,null,a$u)},a$k.fillBorderWords=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this._fillBorderText(null,a$t,a$k,a$v,a$j,a$Q,a$u,a$S,null)},a$k.fillText=function(a$t,a$k,a$v,a$j,a$Q,a$u){this._fillText(a$t,null,a$k,a$v,a$j,a$Q,null,-1,a$u)},a$k.strokeText=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this._fillText(a$t,null,a$k,a$v,a$j,null,a$Q,a$u||1,a$S)},a$k.fillBorderText=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){this._fillBorderText(a$t,null,a$k,a$v,a$j,a$Q,a$u,a$S,a$V)},a$k._fillBorderText=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){if(!a$I.enabled)return this._fillText(a$t,a$k,a$v,a$j,a$Q,null,a$S,a$V||1,a$J),void this._fillText(a$t,a$k,a$v,a$j,a$Q,a$u,null,-1,a$J);var a$W=this._shader2D,a$w=this._curSubmit.shaderValue;a$W.ALPHA!==a$w.ALPHA&&(a$W.glTexture=null);var a$M=a$Q?(a$x._fontTemp.setFont(a$Q),a$x._fontTemp):this._other.font;a$Et.drawText(this,a$t,a$k,this._curMat,a$M,a$J||this._other.textAlign,a$u,a$S,a$V||1,a$v,a$j,0)},a$k.fillRect=function(a$t,a$k,a$v,a$j,a$Q){var a$u=this._vb;if(a$ht.fillRectImgVb(a$u,this._clipRect,a$t,a$k,a$v,a$j,a$T.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var a$S=this._shader2D.fillStyle;a$Q&&(this._shader2D.fillStyle=a$B.create(a$Q));var a$V=this._shader2D,a$J=this._curSubmit.shaderValue;if(a$V.fillStyle!==a$J.fillStyle||a$V.ALPHA!==a$J.ALPHA){a$V.glTexture=null;var a$W=this._curSubmit=a$ut.createSubmit(this,this._ib,a$u,(a$u._byteLength-64)/32*3,a$mt.create(2,0));a$W.shaderValue.color=a$V.fillStyle._color._color,a$W.shaderValue.ALPHA=a$V.ALPHA,this._submits[this._submits._length++]=a$W}this._curSubmit._numEle+=6,this._shader2D.fillStyle=a$S}},a$k.fillTexture=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){if(a$t.loaded&&a$t.bitmap&&a$t.source){var a$J=this._vb,a$W=a$t.bitmap.width,a$w=a$t.bitmap.height,a$M=a$t.uv,a$H=a$S.x%a$t.width,a$E=a$S.y%a$t.height;if(a$W!=a$V.w||a$w!=a$V.h){if(!a$V.w&&!a$V.h)switch(a$V.oy=a$V.ox=0,a$u){case"repeat":a$V.width=a$j,a$V.height=a$Q;break;case"repeat-x":a$V.width=a$j,a$E<0?a$t.height+a$E>a$Q?a$V.height=a$Q:a$V.height=a$t.height+a$E:(a$V.oy=a$E,a$t.height+a$E>a$Q?a$V.height=a$Q-a$E:a$V.height=a$t.height);break;case"repeat-y":a$H<0?a$t.width+a$H>a$j?a$V.width=a$j:a$V.width=a$t.width+a$H:(a$V.ox=a$H,a$t.width+a$H>a$j?a$V.width=a$j-a$H:a$V.width=a$t.width),a$V.height=a$Q;break;case"no-repeat":a$H<0?a$t.width+a$H>a$j?a$V.width=a$j:a$V.width=a$t.width+a$H:(a$V.ox=a$H,a$t.width+a$H>a$j?a$V.width=a$j-a$H:a$V.width=a$t.width),a$E<0?a$t.height+a$E>a$Q?a$V.height=a$Q:a$V.height=a$t.height+a$E:(a$V.oy=a$E,a$t.height+a$E>a$Q?a$V.height=a$Q-a$E:a$V.height=a$t.height);break;default:a$V.width=a$j,a$V.height=a$Q}a$V.w=a$W,a$V.h=a$w,a$V.uv=[0,0,a$V.width/a$W,0,a$V.width/a$W,a$V.height/a$w,0,a$V.height/a$w]}if(a$k+=a$V.ox,a$v+=a$V.oy,a$H-=a$V.ox,a$E-=a$V.oy,a$ht.fillRectImgVb(a$J,this._clipRect,a$k,a$v,a$V.width,a$V.height,a$V.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var a$A=a$ct.create(this,this._ib,a$J,(a$J._byteLength-64)/32*3,a$mt.create(256,0)),a$R=(this._submits[this._submits._length++]=a$A).shaderValue;a$R.textureHost=a$t;var a$h=a$M[0]*a$W,a$l=a$M[1]*a$w,a$o=(a$M[2]-a$M[0])*a$W,a$Y=(a$M[5]-a$M[3])*a$w,a$f=-a$H/a$W,a$X=-a$E/a$w;a$R.u_TexRange[0]=a$h/a$W,a$R.u_TexRange[1]=a$o/a$W,a$R.u_TexRange[2]=a$l/a$w,a$R.u_TexRange[3]=a$Y/a$w,a$R.u_offset[0]=a$f,a$R.u_offset[1]=a$X,a$I.enabled&&!this._isMain&&a$A.addTexture(a$t,(a$J._byteLength>>2)-16),(this._curSubmit=a$A)._renderType=10017,a$A._numEle+=6}}else this.sprite&&a$F.timer.callLater(this,this._repaintSprite)},a$k.setShader=function(a$t){a$q.save(this,1048576,this._shader2D,!0),this._shader2D.shader=a$t},a$k.setFilters=function(a$t){a$q.save(this,2097152,this._shader2D,!0),this._shader2D.filters=a$t,this._curSubmit=a$ut.RENDERBASE,this._renderKey=0,this._drawCount++},a$k.drawTexture=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this._drawTextureM(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,null,1)},a$k.addTextureVb=function(a$t,a$k,a$v){var a$j=this._curSubmit._vb||this._vb,a$Q=a$j._byteLength>>2;a$j.byteLength=a$Q+16<<2;for(var a$u=a$j.getFloat32Array(),a$S=0;a$S<16;a$S+=4)a$u[a$Q++]=a$t[a$S]+a$k,a$u[a$Q++]=a$t[a$S+1]+a$v,a$u[a$Q++]=a$t[a$S+2],a$u[a$Q++]=a$t[a$S+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),a$j._upload=!0},a$k.willDrawTexture=function(a$t,a$k){if(!(a$t.loaded&&a$t.bitmap&&a$t.source))return this.sprite&&a$F.timer.callLater(this,this._repaintSprite),0;var a$v=a$t.bitmap,a$j=a$v.id+this._shader2D.ALPHA*a$k+10016;if(a$j==this._renderKey)return a$j;var a$Q=this._shader2D,a$u=a$Q.ALPHA,a$S=this._curSubmit.shaderValue;a$Q.ALPHA*=a$k,this._renderKey=a$j,this._drawCount++,a$Q.glTexture=a$v;var a$V=this._vb,a$J=null,a$W=a$V._byteLength/32*3,a$w=a$S.textureHost&&a$S.textureHost==a$t&&a$S.textureHost.alphaTexture==a$t.alphaTexture;return a$J=a$ct.create(this,this._ib,a$V,a$W,a$mt.create(1,0)),(this._submits[this._submits._length++]=a$J).shaderValue.textureHost=a$t,a$J._renderType=10016,a$J._preIsSameTextureShader=10016===this._curSubmit._renderType&&a$Q.ALPHA===a$S.ALPHA&&a$w,this._curSubmit=a$J,a$Q.ALPHA=a$u,a$j},a$k.drawTextures=function(a$t,a$k,a$v,a$j){if(a$t.loaded&&a$t.bitmap&&a$t.source){var a$Q=this._clipRect;if(this._clipRect=a$x.MAXCLIPRECT,this._drawTextureM(a$t,a$k[0],a$k[1],a$t.width,a$t.height,a$v,a$j,null,1)){if(this._clipRect=a$Q,a$a.drawCall++,!(a$k.length<4)){for(var a$u=this._curSubmit._vb||this._vb,a$S=this._curMat.a,a$V=this._curMat.d,a$J=2,a$W=a$k.length;a$J<a$W;a$J+=2)a$ht.copyPreImgVb(a$u,(a$k[a$J]-a$k[a$J-2])*a$S,(a$k[a$J+1]-a$k[a$J-1])*a$V),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&a$F.timer.callLater(this,this._repaintSprite)},a$k._drawTextureM=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){if(!a$t.loaded||!a$t.source)return this.sprite&&a$F.timer.callLater(this,this._repaintSprite),!1;var a$W=this._curSubmit._vb||this._vb,a$w=a$t.bitmap;a$k+=a$u,a$v+=a$S,this._drawCount++;var a$M=a$w.id+this._shader2D.ALPHA*a$J+10016;if(a$M!=this._renderKey){this._renderKey=a$M;var a$H=this._curSubmit.shaderValue,a$E=this._shader2D,a$A=a$E.ALPHA;a$E.ALPHA*=a$J,a$E.glTexture=a$w;var a$R=this._vb,a$h=null,a$l=a$R._byteLength/32*3,a$o=a$H.textureHost&&a$H.textureHost==a$t&&a$H.textureHost.alphaTexture==a$t.alphaTexture;a$h=a$ct.create(this,this._ib,a$R,a$l,a$mt.create(1,0)),(this._submits[this._submits._length++]=a$h).shaderValue.textureHost=a$t,a$h._renderType=10016,a$h._preIsSameTextureShader=10016===this._curSubmit._renderType&&a$E.ALPHA===a$H.ALPHA&&a$o,this._curSubmit=a$h,a$W=this._curSubmit._vb||this._vb,a$E.ALPHA=a$A}return!!a$ht.fillRectImgVb(a$W,this._clipRect,a$k,a$v,a$j||a$t.width,a$Q||a$t.height,a$t.uv,a$V||this._curMat,this._x,this._y,0,0)&&(a$I.enabled&&!this._isMain&&this._curSubmit.addTexture(a$t,(a$W._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},a$k._repaintSprite=function(){this.sprite&&this.sprite.repaint()},a$k._drawText=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){var a$w=a$t.bitmap;this._drawCount++;var a$M=a$w.id+this._shader2D.ALPHA+10016;if(a$M!=this._renderKey){this._renderKey=a$M;var a$H=this._curSubmit.shaderValue,a$E=this._shader2D;a$E.glTexture=a$w;var a$A=this._vb,a$R=null,a$h=a$A._byteLength/32*3,a$l=a$H.textureHost&&a$H.textureHost==a$t&&a$H.textureHost.alphaTexture==a$t.alphaTexture;(a$R=a$I.enabled?a$ct.create(this,this._ib,a$A,a$h,a$mt.create(1,0)):a$ct.create(this,this._ib,a$A,a$h,a$gt.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&a$E.ALPHA===a$H.ALPHA&&a$l,(this._submits[this._submits._length++]=a$R).shaderValue.textureHost=a$t,a$R._renderType=10016,this._curSubmit=a$R}a$t.active();var a$o=this._curSubmit._vb||this._vb;a$ht.fillRectImgVb(a$o,this._clipRect,a$k+a$S,a$v+a$V,a$j||a$t.width,a$Q||a$t.height,a$t.uv,a$u||this._curMat,this._x,this._y,a$J,a$W,!0)&&(a$I.enabled&&!this._isMain&&this._curSubmit.addTexture(a$t,(a$o._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},a$k.drawTextureWithTransform=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){if(a$u){var a$W=this._curMat,a$w=this._x,a$M=this._y;(0!==a$S||0!==a$V)&&(this._x=a$S*a$W.a+a$V*a$W.c,this._y=a$V*a$W.d+a$S*a$W.b),a$u&&a$W.bTransform?(a$Z.mul(a$u,a$W,a$x._tmpMatrix),(a$u=a$x._tmpMatrix)._checkTransform()):(this._x+=a$W.tx,this._y+=a$W.ty),this._drawTextureM(a$t,a$k,a$v,a$j,a$Q,0,0,a$u,a$J),this._x=a$w,this._y=a$M}else this._drawTextureM(a$t,a$k,a$v,a$j,a$Q,a$S,a$V,null,a$J)},a$k.fillQuadrangle=function(a$t,a$k,a$v,a$j,a$Q){var a$u=this._curSubmit,a$S=this._vb,a$V=this._shader2D,a$J=a$u.shaderValue;if(this._renderKey=0,a$t.bitmap){var a$W=a$t.bitmap;a$V.glTexture==a$W&&a$V.ALPHA===a$J.ALPHA||(a$V.glTexture=a$W,(a$u=this._curSubmit=a$ut.createSubmit(this,this._ib,a$S,a$S._byteLength/32*3,a$mt.create(1,0))).shaderValue.glTexture=a$W,this._submits[this._submits._length++]=a$u),a$ht.fillQuadrangleImgVb(a$S,a$k,a$v,a$j,a$t.uv,a$Q||this._curMat,this._x,this._y)}else a$u.shaderValue.fillStyle&&a$u.shaderValue.fillStyle.equal(a$t)&&a$V.ALPHA===a$J.ALPHA||(a$V.glTexture=null,(a$u=this._curSubmit=a$ut.createSubmit(this,this._ib,a$S,a$S._byteLength/32*3,a$mt.create(2,0))).shaderValue.defines.add(2),a$u.shaderValue.fillStyle=a$B.create(a$t),this._submits[this._submits._length++]=a$u),a$ht.fillQuadrangleImgVb(a$S,a$k,a$v,a$j,a$T.DEF_UV,a$Q||this._curMat,this._x,this._y);a$u._numEle+=6},a$k.drawTexture2=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){if(0!=a$u){var a$J=this._curMat;if(this._x=a$t*a$J.a+a$k*a$J.c,this._y=a$k*a$J.d+a$t*a$J.b,a$Q&&(a$Q=a$J.bTransform||a$Q.bTransform?(a$Z.mul(a$Q,a$J,a$x._tmpMatrix),a$x._tmpMatrix):(this._x+=a$Q.tx+a$J.tx,this._y+=a$Q.ty+a$J.ty,a$Z.EMPTY)),1!==a$u||a$S){var a$W=this._shader2D.ALPHA,a$w=this._nBlendType;this._shader2D.ALPHA=a$u,a$S&&(this._nBlendType=a$D.TOINT(a$S)),this._drawTextureM(a$V[0],a$V[1]-a$v,a$V[2]-a$j,a$V[3],a$V[4],0,0,a$Q,1),this._shader2D.ALPHA=a$W,this._nBlendType=a$w}else this._drawTextureM(a$V[0],a$V[1]-a$v,a$V[2]-a$j,a$V[3],a$V[4],0,0,a$Q,1);this._x=this._y=0}},a$k.drawCanvas=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$t.context;if(this._renderKey=0,a$u._targets)this._submits[this._submits._length++]=a$Gt.create(a$u,0,null),this._curSubmit=a$ut.RENDERBASE,a$u._targets.drawTo(this,a$k,a$v,a$j,a$Q);else{var a$S=this._submits[this._submits._length++]=a$Gt.create(a$u,this._shader2D.ALPHA,this._shader2D.filters),a$V=a$j/a$t.width,a$J=a$Q/a$t.height,a$W=a$S._matrix;this._curMat.copyTo(a$W),1!=a$V&&1!=a$J&&a$W.scale(a$V,a$J);var a$w=a$W.tx,a$M=a$W.ty;a$W.tx=a$W.ty=0,a$W.transformPoint(a$s.TEMP.setTo(a$k,a$v)),a$W.translate(a$s.TEMP.x+a$w,a$s.TEMP.y+a$M),this._curSubmit=a$ut.RENDERBASE}a$d.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=a$u._targets?"yellow":"green",this.strokeRect(a$k-1,a$v-1,a$j+2,a$Q+2,1),this.strokeRect(a$k,a$v,a$j,a$Q,1),this.restore())},a$k.drawTarget=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){void 0===a$W&&(a$W=-1);var a$w=this._vb;if(a$ht.fillRectImgVb(a$w,this._clipRect,a$k,a$v,a$j,a$Q,a$J||a$T.DEF_UV,a$u||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var a$M=this._curSubmit=a$Mt.create(this,this._ib,a$w,(a$w._byteLength-64)/32*3,a$V,a$S);a$M.blendType=-1==a$W?this._nBlendType:a$W,a$M.scope=a$t,this._submits[this._submits._length++]=a$M,this._curSubmit._numEle+=6}},a$k.mixRGBandAlpha=function(a$t){return this._mixRGBandAlpha(a$t,this._shader2D.ALPHA)},a$k._mixRGBandAlpha=function(a$t,a$k){var a$v=(4278190080&a$t)>>>24;return 0!=a$v?a$v*=a$k:a$v=255*a$k,16777215&a$t|a$v<<24},a$k.drawTriangles=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){if(!a$t.loaded||!a$t.source)return this.sprite&&a$F.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;a$t.bitmap;var a$w=this._mixRGBandAlpha(4294967295,a$V),a$M=(a$j.length,a$u.length);this._renderKey=-1;var a$H=this._curSubmit=a$ct.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,a$mt.create(1,0));return a$H.shaderValue.textureHost=a$t,a$H._renderType=10016,this._submits[this._submits._length++]=a$H,a$S?(a$x._tmpMatrix.a=a$S.a,a$x._tmpMatrix.b=a$S.b,a$x._tmpMatrix.c=a$S.c,a$x._tmpMatrix.d=a$S.d,a$x._tmpMatrix.tx=a$S.tx+a$k,a$x._tmpMatrix.ty=a$S.ty+a$v,a$Z.mul(a$x._tmpMatrix,this._curMat,a$x._tmpMatrix)):(a$x._tmpMatrix.a=this._curMat.a,a$x._tmpMatrix.b=this._curMat.b,a$x._tmpMatrix.c=this._curMat.c,a$x._tmpMatrix.d=this._curMat.d,a$x._tmpMatrix.tx=this._curMat.tx+a$k,a$x._tmpMatrix.ty=this._curMat.ty+a$v),this._triangleMesh.addData(a$j,a$Q,a$u,a$x._tmpMatrix,a$w,this),this._curSubmit._numEle+=a$M,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},a$k.transform=function(a$t,a$k,a$v,a$j,a$Q,a$u){a$r.save(this),a$Z.mul(a$Z.TEMP.setTo(a$t,a$k,a$v,a$j,a$Q,a$u),this._curMat,this._curMat),this._curMat._checkTransform()},a$k.setTransformByMatrix=function(a$t){a$t.copyTo(this._curMat)},a$k.transformByMatrix=function(a$t){a$r.save(this),a$Z.mul(a$t,this._curMat,this._curMat),this._curMat._checkTransform()},a$k.rotate=function(a$t){a$r.save(this),this._curMat.rotateEx(a$t)},a$k.scale=function(a$t,a$k){a$r.save(this),this._curMat.scaleEx(a$t,a$k)},a$k.clipRect=function(a$t,a$k,a$v,a$j){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var a$Q=a$wt.create(4);this.addRenderObject(a$Q);var a$u=this._vb,a$S=a$u._byteLength>>2;if(a$ht.fillRectImgVb(a$u,null,a$t,a$k,a$v,a$j,a$T.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var a$V=this._curSubmit=a$ut.createSubmit(this,this._ib,a$u,(a$u._byteLength-64)/32*3,a$mt.create(2,0));a$V.shaderValue.ALPHA=1,this._submits[this._submits._length++]=a$V,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var a$J=a$wt.create(5);this.addRenderObject(a$J);var a$W=a$u.getFloat32Array(),a$w=Math.min(Math.min(Math.min(a$W[0+a$S],a$W[4+a$S]),a$W[8+a$S]),a$W[12+a$S]),a$M=Math.max(Math.max(Math.max(a$W[0+a$S],a$W[4+a$S]),a$W[8+a$S]),a$W[12+a$S]),a$H=Math.min(Math.min(Math.min(a$W[1+a$S],a$W[5+a$S]),a$W[9+a$S]),a$W[13+a$S]),a$E=Math.max(Math.max(Math.max(a$W[1+a$S],a$W[5+a$S]),a$W[9+a$S]),a$W[13+a$S]);a$L.save(this,a$J,a$t,a$k,a$v,a$j,a$w,a$H,a$M-a$w,a$E-a$H),this._curSubmit=a$ut.RENDERBASE}else{a$v*=this._curMat.a,a$j*=this._curMat.d;var a$A=a$s.TEMP;this._curMat.transformPoint(a$A.setTo(a$t,a$k)),a$v<0&&(a$A.x=a$A.x+a$v,a$v=-a$v),a$j<0&&(a$A.y=a$A.y+a$j,a$j=-a$j),this._renderKey=0;var a$R=this._curSubmit=a$Wt.create(this);(this._submits[this._submits._length++]=a$R).submitIndex=this._submits._length,a$R.submitLength=9999999,a$C.save(this,a$R);var a$h=this._clipRect,a$l=a$h.x,a$o=a$h.y,a$Y=a$A.x+a$v,a$f=a$A.y+a$j;a$l<a$A.x&&(a$h.x=a$A.x),a$o<a$A.y&&(a$h.y=a$A.y),a$h.width=Math.min(a$Y,a$l+a$h.width)-a$h.x,a$h.height=Math.min(a$f,a$o+a$h.height)-a$h.y,this._shader2D.glTexture=null,a$R.clipRect.copyFrom(a$h),this._curSubmit=a$ut.RENDERBASE}},a$k.setIBVB=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w){if(void 0===a$J&&(a$J=0),void 0===a$W&&(a$W=0),void 0===a$w&&(a$w=0),null===a$v){if(a$l.isFlash){var a$M=a$j;a$M._selfIB||(a$M._selfIB=a$yt.create(35044)),a$M._selfIB.clear(),a$v=a$M._selfIB}else a$v=this._ib;a$ht.expandIBQuadrangle(a$v,a$j._byteLength/(4*a$j.vertexStride*4))}if(!a$V||!a$S)throw Error("setIBVB must input:shader shaderValues");var a$H=a$Jt.create(this,a$j,a$v,a$Q,a$S,a$V,a$J,a$W,a$w);a$u||(a$u=a$Z.EMPTY),a$u.translate(a$t,a$k),a$Z.mul(a$u,this._curMat,a$H._mat),a$u.translate(-a$t,-a$k),this._submits[this._submits._length++]=a$H,this._curSubmit=a$ut.RENDERBASE,this._renderKey=0},a$k.addRenderObject=function(a$t){this._submits[this._submits._length++]=a$t},a$k.fillTrangles=function(a$t,a$k,a$v,a$j,a$Q){var a$u=this._curSubmit,a$S=this._vb,a$V=this._shader2D,a$J=a$u.shaderValue,a$W=a$j.length>>4,a$w=a$t.bitmap;this._renderKey=0,a$V.glTexture==a$w&&a$V.ALPHA===a$J.ALPHA||((a$u=this._curSubmit=a$ut.createSubmit(this,this._ib,a$S,a$S._byteLength/32*3,a$mt.create(1,0))).shaderValue.textureHost=a$t,this._submits[this._submits._length++]=a$u),a$ht.fillTranglesVB(a$S,a$k,a$v,a$j,a$Q||this._curMat,this._x,this._y),a$u._numEle+=6*a$W},a$k.submitElement=function(a$t,a$k){var a$v=this._submits;for(a$k<0&&(a$k=a$v._length);a$t<a$k;)a$t+=a$v[a$t].renderSubmit()},a$k.finish=function(){a$ft.mainContext.finish()},a$k.flush=function(){var a$t=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(a$t>this._ib.bufferLength/12&&a$ht.expandIBQuadrangle(this._ib,a$t),!this._isMain&&a$I.enabled&&a$I._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=a$I._atlasRestore;for(var a$k=this._submits,a$v=0,a$j=a$k._length;a$v<a$j;a$v++){var a$Q=a$k[a$v];10016===a$Q.getRenderType()&&a$Q.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),a$kt.instance&&a$kt.getInstance().reset();var a$u;for(a$v=0,a$u=this.meshlist.length;a$v<a$u;a$v++){var a$S=this.meshlist[a$v];a$S.canReuse?a$S.releaseMesh():a$S.destroy()}return this.meshlist.length=0,this._curSubmit=a$ut.RENDERBASE,this._renderKey=0,this._triangleMesh=a$Tt.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},a$k.setPathId=function(a$t){if(this.mId=a$t,-1!=this.mId){this.mHaveKey=!1;var a$k=a$O.getInstance();a$k.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,a$k.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},a$k.movePath=function(a$t,a$k){var a$v=a$t,a$j=a$k;a$t=this._curMat.a*a$v+this._curMat.c*a$j+this._curMat.tx,a$k=this._curMat.b*a$v+this._curMat.d*a$j+this._curMat.ty,this.mX+=a$t,this.mY+=a$k},a$k.beginPath=function(){var a$t=this._getPath();a$t.tempArray.length=0,a$t.closePath=!1,this.mX=0,this.mY=0},a$k.closePath=function(){this._path.closePath=!0},a$k.fill=function(a$t){void 0===a$t&&(a$t=!1);var a$k=this._getPath();this.drawPoly(0,0,a$k.tempArray,this.fillStyle._color.numColor,0,0,a$t)},a$k.stroke=function(){var a$t=this._getPath();if(0<this.lineWidth){if(-1==this.mId)a$t.drawLine(0,0,a$t.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var a$k=a$O.getInstance().shapeLineDic[this.mId];a$k.rebuild(a$t.tempArray),a$t.setGeomtry(a$k)}else a$O.getInstance().addLine(this.mId,a$t.drawLine(0,0,a$t.tempArray,this.lineWidth,this.strokeStyle._color.numColor));a$t.update();var a$v=[this.mX,this.mY],a$j=a$ut.createShape(this,a$t.ib,a$t.vb,a$t.count,a$t.offset,a$mt.create(4,0));a$j.shaderValue.ALPHA=this._shader2D.ALPHA,a$j.shaderValue.u_pos=a$v,a$j.shaderValue.u_mmat2=a$ot.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=a$j,this._renderKey=-1}},a$k.line=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=this._curSubmit,a$V=this._vb;if(a$ht.fillLineVb(a$V,this._clipRect,a$t,a$k,a$v,a$j,a$Q,a$u)){this._renderKey=0;var a$J=this._shader2D,a$W=a$S.shaderValue;a$J.strokeStyle===a$W.strokeStyle&&a$J.ALPHA===a$W.ALPHA||(a$J.glTexture=null,(a$S=this._curSubmit=a$ut.createSubmit(this,this._ib,a$V,(a$V._byteLength-64)/32*3,a$mt.create(2,0))).shaderValue.strokeStyle=a$J.strokeStyle,a$S.shaderValue.mainID=2,a$S.shaderValue.ALPHA=a$J.ALPHA,this._submits[this._submits._length++]=a$S),a$S._numEle+=6}},a$k.moveTo=function(a$t,a$k,a$v){void 0===a$v&&(a$v=!0);var a$j=this._getPath();if(a$v){var a$Q=a$t,a$u=a$k;a$t=this._curMat.a*a$Q+this._curMat.c*a$u,a$k=this._curMat.b*a$Q+this._curMat.d*a$u}a$j.addPoint(a$t,a$k)},a$k.lineTo=function(a$t,a$k,a$v){void 0===a$v&&(a$v=!0);var a$j=this._getPath();if(a$v){var a$Q=a$t,a$u=a$k;a$t=this._curMat.a*a$Q+this._curMat.c*a$u,a$k=this._curMat.b*a$Q+this._curMat.d*a$u}a$j.addPoint(a$t,a$k)},a$k.drawCurves=function(a$t,a$k,a$v){this.setPathId(-1),this.beginPath(),this.strokeStyle=a$v[3],this.lineWidth=a$v[4];var a$j=a$v[2];a$t+=a$v[0],a$k+=a$v[1],this.movePath(a$t,a$k),this.moveTo(a$j[0],a$j[1]);for(var a$Q=2,a$u=a$j.length;a$Q<a$u;)this.quadraticCurveTo(a$j[a$Q++],a$j[a$Q++],a$j[a$Q++],a$j[a$Q++]);this.stroke()},a$k.arcTo=function(a$t,a$k,a$v,a$j,a$Q){if(-1==this.mId||!this.mHaveKey){var a$u=0,a$S=0,a$V=0,a$J=this._getPath();this._curMat.copyTo(a$x._tmpMatrix),a$x._tmpMatrix.tx=a$x._tmpMatrix.ty=0,a$x._tempPoint.setTo(a$J.getEndPointX(),a$J.getEndPointY()),a$x._tmpMatrix.invertTransformPoint(a$x._tempPoint);var a$W=a$x._tempPoint.x-a$t,a$w=a$x._tempPoint.y-a$k,a$M=Math.sqrt(a$W*a$W+a$w*a$w);if(!(a$M<=1e-6)){var a$H=a$W/a$M,a$E=a$w/a$M,a$A=a$v-a$t,a$R=a$j-a$k,a$h=a$A*a$A+a$R*a$R,a$l=Math.sqrt(a$h);if(!(a$l<=1e-6)){var a$o=a$A/a$l,a$Y=a$R/a$l,a$f=a$H+a$o,a$X=a$E+a$Y,a$F=Math.sqrt(a$f*a$f+a$X*a$X);if(!(a$F<=1e-6)){var a$d=a$f/a$F,a$m=a$X/a$F,a$Z=Math.acos(a$d*a$H+a$m*a$E),a$s=Math.PI/2-a$Z,a$K=(a$M=a$Q/Math.tan(a$s))*a$H+a$t,a$U=a$M*a$E+a$k,a$N=Math.sqrt(a$M*a$M+a$Q*a$Q),a$a=a$t+a$d*a$N,a$z=a$k+a$m*a$N,a$G=0,a$c=0;if(0<=a$H*a$Y-a$E*a$o){var a$T=2*a$s/a$x.SEGNUM;a$G=Math.sin(a$T),a$c=Math.cos(a$T)}else a$T=2*-a$s/a$x.SEGNUM,a$G=Math.sin(a$T),a$c=Math.cos(a$T);a$S=this._curMat.a*a$K+this._curMat.c*a$U,a$V=this._curMat.b*a$K+this._curMat.d*a$U,a$S==this._path.getEndPointX()&&a$V==this._path.getEndPointY()||a$J.addPoint(a$S,a$V);var a$p=a$K-a$a,a$O=a$U-a$z;for(a$u=0;a$u<a$x.SEGNUM;a$u++){var a$n=a$p*a$c+a$O*a$G,a$_=-a$p*a$G+a$O*a$c;a$S=a$n+a$a,a$V=a$_+a$z,a$t=this._curMat.a*a$S+this._curMat.c*a$V,a$V=a$k=this._curMat.b*a$S+this._curMat.d*a$V,(a$S=a$t)==this._path.getEndPointX()&&a$V==this._path.getEndPointY()||a$J.addPoint(a$S,a$V),a$p=a$n,a$O=a$_}}}}}},a$k.arc=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){if(void 0===a$u&&(a$u=!1),void 0===a$S&&(a$S=!0),-1!=this.mId){var a$V=a$O.getInstance().shapeDic[this.mId];if(a$V&&this.mHaveKey&&!a$V.needUpdate(this._curMat))return;a$k=a$t=0}var a$J,a$W=0,a$w=0,a$M=0,a$H=0,a$E=0,a$A=0,a$R=0;if(a$w=a$Q-a$j,a$u)if(Math.abs(a$w)>=2*Math.PI)a$w=2*-Math.PI;else for(;0<a$w;)a$w-=2*Math.PI;else if(Math.abs(a$w)>=2*Math.PI)a$w=2*Math.PI;else for(;a$w<0;)a$w+=2*Math.PI;a$J=a$w/(a$R=a$v<101?Math.max(10,a$w*a$v/5):a$v<201?Math.max(10,a$w*a$v/20):Math.max(10,a$w*a$v/40))/2,a$M=Math.abs(4/3*(1-Math.cos(a$J))/Math.sin(a$J)),a$u&&(a$M=-a$M);var a$h=this._getPath(),a$l=NaN,a$o=NaN;for(a$A=0;a$A<=a$R;a$A++)a$W=a$j+a$w*(a$A/a$R),a$H=a$t+Math.cos(a$W)*a$v,a$E=a$k+Math.sin(a$W)*a$v,a$S&&(a$l=a$H,a$o=a$E,a$H=this._curMat.a*a$l+this._curMat.c*a$o,a$E=this._curMat.b*a$l+this._curMat.d*a$o),a$H==this._path.getEndPointX()&&a$E==this._path.getEndPointY()||a$h.addPoint(a$H,a$E);a$H=a$t+Math.cos(a$Q)*a$v,a$E=a$k+Math.sin(a$Q)*a$v,a$S&&(a$l=a$H,a$o=a$E,a$H=this._curMat.a*a$l+this._curMat.c*a$o,a$E=this._curMat.b*a$l+this._curMat.d*a$o),a$H==this._path.getEndPointX()&&a$E==this._path.getEndPointY()||a$h.addPoint(a$H,a$E)},a$k.quadraticCurveTo=function(a$t,a$k,a$v,a$j){var a$Q=a$M.I,a$u=a$v,a$S=a$j;a$v=this._curMat.a*a$u+this._curMat.c*a$S,a$j=this._curMat.b*a$u+this._curMat.d*a$S,a$u=a$t,a$S=a$k,a$t=this._curMat.a*a$u+this._curMat.c*a$S,a$k=this._curMat.b*a$u+this._curMat.d*a$S;for(var a$V=a$Q.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),a$t,a$k,a$v,a$j],30,2),a$J=0,a$W=a$V.length/2;a$J<a$W;a$J++)this.lineTo(a$V[2*a$J],a$V[2*a$J+1],!1);this.lineTo(a$v,a$j,!1)},a$k.rect=function(a$t,a$k,a$v,a$j){this._other=this._other.make(),this._other.path||(this._other.path=new a$b),this._other.path.rect(a$t,a$k,a$v,a$j)},a$k.strokeRect=function(a$t,a$k,a$v,a$j,a$Q){var a$u=.5*a$Q;this.line(a$t-a$u,a$k,a$t+a$v+a$u,a$k,a$Q,this._curMat),this.line(a$t+a$v,a$k,a$t+a$v,a$k+a$j,a$Q,this._curMat),this.line(a$t,a$k,a$t,a$k+a$j,a$Q,this._curMat),this.line(a$t-a$u,a$k+a$j,a$t+a$v+a$u,a$k+a$j,a$Q,this._curMat)},a$k.clip=function(){},a$k.drawPoly=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){void 0===a$S&&(a$S=!1),this._renderKey=0,this._shader2D.glTexture=null;var a$V=this._getPath();if(-1==this.mId)a$V.polygon(a$t,a$k,a$v,a$j,a$Q||1,a$u);else if(this.mHaveKey){var a$J=a$O.getInstance().shapeDic[this.mId];a$J.setMatrix(this._curMat),a$J.rebuild(a$V.tempArray),a$V.setGeomtry(a$J)}else{var a$W=a$V.polygon(a$t,a$k,a$v,a$j,a$Q||1,a$u);a$O.getInstance().addShape(this.mId,a$W),a$W.setMatrix(this._curMat)}a$V.update();var a$w,a$M=[this.mX,this.mY];if((a$w=a$ut.createShape(this,a$V.ib,a$V.vb,a$V.count,a$V.offset,a$mt.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,a$w.shaderValue.u_pos=a$M,a$w.shaderValue.u_mmat2=a$ot.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=a$w,0<a$Q){if(this.mHaveLineKey){var a$H=a$O.getInstance().shapeLineDic[this.mId];a$H.rebuild(a$V.tempArray),a$V.setGeomtry(a$H)}else a$O.getInstance().addShape(this.mId,a$V.drawLine(a$t,a$k,a$v,a$Q,a$u));a$V.update(),(a$w=a$ut.createShape(this,a$V.ib,a$V.vb,a$V.count,a$V.offset,a$mt.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,a$w.shaderValue.u_mmat2=a$ot.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=a$w}},a$k.drawParticle=function(a$t,a$k,a$v){a$v.x=a$t,a$v.y=a$k,this._submits[this._submits._length++]=a$v},a$k._getPath=function(){return this._path||(this._path=new a$b)},a$j(0,a$k,"globalCompositeOperation",function(){return a$D.NAMES[this._nBlendType]},function(a$t){var a$k=a$D.TOINT[a$t];null==a$k||this._nBlendType===a$k||(a$q.save(this,65536,this,!0),this._curSubmit=a$ut.RENDERBASE,this._renderKey=0,this._nBlendType=a$k)}),a$j(0,a$k,"strokeStyle",function(){return this._shader2D.strokeStyle},function(a$t){this._shader2D.strokeStyle.equal(a$t)||(a$q.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=a$B.create(a$t))}),a$j(0,a$k,"globalAlpha",function(){return this._shader2D.ALPHA},function(a$t){(a$t=Math.floor(1e3*a$t)/1e3)!=this._shader2D.ALPHA&&(a$q.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=a$t)}),a$j(0,a$k,"asBitmap",null,function(a$t){if(a$t){if(this._targets||(this._targets=new a$$),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),a$j(0,a$k,"fillStyle",function(){return this._shader2D.fillStyle},function(a$t){this._shader2D.fillStyle.equal(a$t)||(a$q.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=a$B.create(a$t))}),a$j(0,a$k,"textAlign",function(){return this._other.textAlign},function(a$t){this._other.textAlign===a$t||(this._other=this._other.make(),a$q.save(this,32768,this._other,!1),this._other.textAlign=a$t)}),a$j(0,a$k,"lineWidth",function(){return this._other.lineWidth},function(a$t){this._other.lineWidth===a$t||(this._other=this._other.make(),a$q.save(this,256,this._other,!1),this._other.lineWidth=a$t)}),a$j(0,a$k,"textBaseline",function(){return this._other.textBaseline},function(a$t){this._other.textBaseline===a$t||(this._other=this._other.make(),a$q.save(this,16384,this._other,!1),this._other.textBaseline=a$t)}),a$j(0,a$k,"font",null,function(a$t){a$t!=this._other.font.toString()&&(this._other=this._other.make(),a$q.save(this,8,this._other,!1),this._other.font===a$At.EMPTY?this._other.font=new a$At(a$t):this._other.font.setFont(a$t))}),a$x.__init__=function(){a$v.DEFAULT=new a$v},a$x._tempPoint=new a$s,a$x._SUBMITVBSIZE=32e3,a$x._MAXSIZE=99999999,a$x._RECTVBSIZE=16,a$x.MAXCLIPRECT=new a$K(0,0,99999999,99999999),a$x._COUNT=0,a$x._tmpMatrix=new a$Z,a$x.SEGNUM=32,a$x._contextcount=0,a$S(a$x,["_fontTemp",function(){return this._fontTemp=new a$At},"_drawStyleTemp",function(){return this._drawStyleTemp=new a$B(null)}]),a$x.__init$=function(){a$v=function(){function a$t(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=a$At.EMPTY}a$H(a$t,"");var a$k=a$t.prototype;return a$k.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=a$At.EMPTY},a$k.make=function(){return this===a$t.DEFAULT?new a$t:this},a$t.DEFAULT=null,a$t}()},a$x}(),a$mt=function(a$t){function a$j(a$t,a$k){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,a$j.__super.call(this),this.defines=new a$Ut,this.position=a$j._POSITION,this.mainID=a$t,this.subID=a$k,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=a$t|a$k,this._inClassCache=a$j._cache[this._cacheID],0<a$t&&!this._inClassCache&&(this._inClassCache=a$j._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}a$H(a$j,"laya.webgl.shader.d2.value.Value2D",a$_);var a$k=a$j.prototype;return a$k.setValue=function(a$t){},a$k.refresh=function(){var a$t=this.size;return a$t[0]=a$ot.width,a$t[1]=a$ot.height,this.alpha=this.ALPHA*a$ot.worldAlpha,this.mmat=a$ot.worldMatrix4,this},a$k._ShaderWithCompile=function(){return a$et.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,a$$t.create)},a$k._withWorldShaderDefines=function(){var a$t=a$ot.worldShaderDefines,a$k=a$et.sharders[this.mainID|this.defines._value|a$t.getValue()];if(!a$k){var a$v,a$j={};for(a$v in this.defines.toNameDic())a$j[a$v]="";for(a$v in a$t.toNameDic())a$j[a$v]="";a$k=a$et.withCompile2D(0,this.mainID,a$j,this.mainID|this.defines._value|a$t.getValue(),a$$t.create)}var a$Q=a$ot.worldFilters;if(!a$Q)return a$k;for(var a$u,a$S=a$Q.length,a$V=0;a$V<a$S;a$V++)(a$u=a$Q[a$V])&&a$u.action.setValue(this);return a$k},a$k.upload=function(){var a$t=a$ot;this.alpha=this.ALPHA*a$t.worldAlpha,a$ot.worldMatrix4!==a$ot.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),a$ft.shaderHighPrecision&&this.defines.add(1024);var a$k,a$v=a$t.worldShaderDefines?this._withWorldShaderDefines():a$et.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=a$t.width,this.size[1]=a$t.height,this.mmat=a$t.worldMatrix4,a$pt.activeShader!==a$v?a$v._shaderValueWidth!==a$t.width||a$v._shaderValueHeight!==a$t.height?(a$v._shaderValueWidth=a$t.width,a$v._shaderValueHeight=a$t.height):a$k=a$v._params2dQuick2||a$v._make2dQuick2():a$v._shaderValueWidth!==a$t.width||a$v._shaderValueHeight!==a$t.height?(a$v._shaderValueWidth=a$t.width,a$v._shaderValueHeight=a$t.height):a$k=a$v._params2dQuick1||a$v._make2dQuick1(),a$v.upload(this,a$k)},a$k.setFilters=function(a$t){if(this.filters=a$t)for(var a$k,a$v=a$t.length,a$j=0;a$j<a$v;a$j++)(a$k=a$t[a$j])&&(this.defines.add(a$k.type),a$k.action.setValue(this))},a$k.clear=function(){this.defines.setValue(this.subID)},a$k.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},a$j._initone=function(a$t,a$k){a$j._typeClass[a$t]=a$k,a$j._cache[a$t]=[],a$j._cache[a$t]._length=0},a$j.__init__=function(){a$j._POSITION=[2,5126,!1,4*a$Rt.BYTES_PE,0],a$j._TEXCOORD=[2,5126,!1,4*a$Rt.BYTES_PE,2*a$Rt.BYTES_PE],a$j._initone(2,a$xt),a$j._initone(4,a$Dt),a$j._initone(256,a$It),a$j._initone(512,a$_t),a$j._initone(1,a$it),a$j._initone(65,a$gt),a$j._initone(9,a$it)},a$j.create=function(a$t,a$k){var a$v=a$j._cache[a$t|a$k];return a$v._length?a$v[--a$v._length]:new a$j._typeClass[a$t|a$k](a$k)},a$j._POSITION=null,a$j._TEXCOORD=null,a$j._cache=[],a$j._typeClass=[],a$j.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a$j}(),a$Zt=function(a$t){function a$h(a$t,a$k){a$h.__super.call(this,a$t,a$k)}a$H(a$h,"laya.webgl.utils.RenderSprite3D",a$o);var a$k=a$h.prototype;return a$k.onCreate=function(a$t){switch(a$t){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},a$k._mask=function(a$t,a$k,a$v,a$j){var a$Q,a$u,a$S=this._next,a$V=a$t.mask;if(a$V){a$k.ctx.save();var a$J=a$k.ctx.globalCompositeOperation,a$W=new a$K;if(a$W.copyFrom(a$V.getBounds()),a$W.width=Math.round(a$W.width),a$W.height=Math.round(a$W.height),a$W.x=Math.round(a$W.x),a$W.y=Math.round(a$W.y),0<a$W.width&&0<a$W.height){var a$w=a$t._style._tf,a$M=a$Vt.create();a$M.addValue("bounds",a$W),a$Q=a$St.create([a$M,a$k],laya.webgl.utils.RenderSprite3D.tmpTarget),a$k.addRenderObject(a$Q),a$V.render(a$k,-a$W.x,-a$W.y),a$Q=a$St.create([a$M],laya.webgl.utils.RenderSprite3D.endTmpTarget),a$k.addRenderObject(a$Q),a$k.ctx.save(),a$k.clipRect(a$v-a$w.translateX+a$W.x,a$j-a$w.translateY+a$W.y,a$W.width,a$W.height),a$S._fun.call(a$S,a$t,a$k,a$v,a$j),a$k.ctx.restore(),a$u=a$wt.create(6),a$J=a$k.ctx.globalCompositeOperation,a$u.blendMode="mask",a$k.addRenderObject(a$u),a$Z.TEMP.identity();var a$H=a$mt.create(1,0),a$E=a$T.INV_UV,a$A=a$W.width,a$R=a$W.height;(a$W.width<32||a$W.height<32)&&((a$E=a$h.tempUV)[0]=0,a$E[1]=0,a$E[2]=32<=a$W.width?1:a$W.width/32,a$E[3]=0,a$E[4]=32<=a$W.width?1:a$W.width/32,a$E[5]=32<=a$W.height?1:a$W.height/32,a$E[6]=0,a$E[7]=32<=a$W.height?1:a$W.height/32,a$W.width=32<=a$W.width?a$W.width:32,a$W.height=32<=a$W.height?a$W.height:32,a$E[1]*=-1,a$E[3]*=-1,a$E[5]*=-1,a$E[7]*=-1,a$E[1]+=1,a$E[3]+=1,a$E[5]+=1,a$E[7]+=1),a$k.ctx.drawTarget(a$M,a$v+a$W.x-a$w.translateX,a$j+a$W.y-a$w.translateY,a$A,a$R,a$Z.TEMP,"tmpTarget",a$H,a$E,6),a$Q=a$St.create([a$M],laya.webgl.utils.RenderSprite3D.recycleTarget),a$k.addRenderObject(a$Q),(a$u=a$wt.create(6)).blendMode=a$J,a$k.addRenderObject(a$u)}a$k.ctx.restore()}else a$S._fun.call(a$S,a$t,a$k,a$v,a$j)},a$k._blend=function(a$t,a$k,a$v,a$j){var a$Q=a$t._style,a$u=this._next;a$Q.blendMode?(a$k.ctx.save(),a$k.ctx.globalCompositeOperation=a$Q.blendMode,a$u._fun.call(a$u,a$t,a$k,a$v,a$j),a$k.ctx.restore()):a$u._fun.call(a$u,a$t,a$k,a$v,a$j)},a$k._transform=function(a$t,a$k,a$v,a$j){var a$Q=a$t.transform,a$u=this._next;if(a$Q&&a$u!=a$o.NORENDER){var a$S=a$k.ctx;a$t._style;a$Q.tx=a$v,a$Q.ty=a$j;var a$V=a$S._getTransformMatrix(),a$J=a$V.clone();a$Z.mul(a$Q,a$V,a$V),a$V._checkTransform(),a$Q.tx=a$Q.ty=0,a$u._fun.call(a$u,a$t,a$k,0,0),a$J.copyTo(a$V),a$J.destroy()}else a$u._fun.call(a$u,a$t,a$k,a$v,a$j)},a$h.tmpTarget=function(a$t,a$k){var a$v=a$t.getValue("bounds"),a$j=a$Ot.create(a$v.width,a$v.height);a$j.start(),a$j.clear(0,0,0,0),a$t.addValue("tmpTarget",a$j)},a$h.endTmpTarget=function(a$t){a$t.getValue("tmpTarget").end()},a$h.recycleTarget=function(a$t){a$t.getValue("tmpTarget").recycle(),a$t.recycle()},a$S(a$h,["tempUV",function(){return this.tempUV=new Array(8)}]),a$h}(),a$st=function(a$t){function a$k(){this.data=null,a$k.__super.call(this)}a$H(a$k,"laya.filters.webgl.ColorFilterActionGL",a$n);var a$v=a$k.prototype;return a$F.imps(a$v,{"laya.filters.IFilterActionGL":!0}),a$v.setValue=function(a$t){a$t.colorMat=this.data._mat,a$t.colorAlpha=this.data._alpha},a$v.apply3d=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$t.getValue("bounds"),a$S=a$mt.create(1,0);a$S.setFilters([this.data]);var a$V=a$Z.TEMP;a$V.identity(),a$v.ctx.drawTarget(a$t,0,0,a$u.width,a$u.height,a$V,"src",a$S)},a$k}(),a$Kt=function(a$t){function a$u(a$t,a$k,a$v,a$j,a$Q){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,a$u.__super.call(this,a$t,a$k,a$Q),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new a$Bt,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=a$v,this._atlasCanvas.height=a$j,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}a$H(a$u,"laya.webgl.atlas.Atlaser",a$x);var a$k=a$u.prototype;return a$k.computeUVinAtlasTexture=function(a$t,a$k,a$v,a$j){var a$Q=a$I.atlasTextureWidth,a$u=a$I.atlasTextureHeight,a$S=a$v/a$Q,a$V=a$j/a$u,a$J=(a$v+a$t.bitmap.width)/a$Q,a$W=(a$j+a$t.bitmap.height)/a$u,a$w=a$t.bitmap.width/a$Q,a$M=a$t.bitmap.height/a$u;a$t.uv=[a$S+a$k[0]*a$w,a$V+a$k[1]*a$M,a$J-(1-a$k[2])*a$w,a$V+a$k[3]*a$M,a$J-(1-a$k[4])*a$w,a$W-(1-a$k[5])*a$M,a$S+a$k[6]*a$w,a$W-(1-a$k[7])*a$M]},a$k.findBitmapIsExist=function(a$t){if(a$t instanceof laya.webgl.resource.WebGLImage){var a$k=a$t,a$v=a$k.url,a$j=this._InAtlasWebGLImagesKey[a$v||a$k.id];if(a$j)return a$j.offsetInfoID}return-1},a$k.addToAtlasTexture=function(a$t,a$k,a$v){if(a$t instanceof laya.webgl.resource.WebGLImage){var a$j=a$t,a$Q=a$j.url;this._InAtlasWebGLImagesKey[a$Q||a$j.id]={bitmap:a$t,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([a$k,a$v])}this._atlasCanvas.texSubImage2D(a$k,a$v,a$t.atlasSource),a$t.clearAtlasSource()},a$k.addToAtlas=function(a$t,a$k,a$v){a$t._atlasID=this._inAtlasTextureKey.length;var a$j=a$t.uv.slice(),a$Q=a$t.bitmap;this._inAtlasTextureKey.push(a$t),this._inAtlasTextureOriUVValue.push(a$j),this._inAtlasTextureBitmapValue.push(a$Q),this.computeUVinAtlasTexture(a$t,a$j,a$k,a$v),a$t.bitmap=this._atlasCanvas},a$k.clear=function(){for(var a$t=0,a$k=this._inAtlasTextureKey.length;a$t<a$k;a$t++)this._inAtlasTextureKey[a$t].bitmap=this._inAtlasTextureBitmapValue[a$t],this._inAtlasTextureKey[a$t].uv=this._inAtlasTextureOriUVValue[a$t],this._inAtlasTextureKey[a$t]._atlasID=-1,this._inAtlasTextureKey[a$t].bitmap.lock=!1,this._inAtlasTextureKey[a$t].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},a$k.dispose=function(){this.clear(),this._atlasCanvas.destroy()},a$j(0,a$k,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),a$j(0,a$k,"texture",function(){return this._atlasCanvas}),a$j(0,a$k,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),a$u}(),a$Ut=function(a$t){function a$v(){a$v.__super.call(this,a$v.__name2int,a$v.__int2name,a$v.__int2nameMap)}return a$H(a$v,"laya.webgl.shader.d2.ShaderDefines2D",a$P),a$v.__init__=function(){a$v.reg("TEXTURE2D",1),a$v.reg("COLOR2D",2),a$v.reg("PRIMITIVE",4),a$v.reg("GLOW_FILTER",8),a$v.reg("BLUR_FILTER",16),a$v.reg("COLOR_FILTER",32),a$v.reg("COLOR_ADD",64),a$v.reg("WORLDMAT",128),a$v.reg("FILLTEXTURE",256),a$v.reg("FSHIGHPRECISION",1024),a$v.reg("TXTALPHA",2048),a$v.reg("TXTCOMPRESS",4096)},a$v.reg=function(a$t,a$k){a$P._reg(a$t,a$k,a$v.__name2int,a$v.__int2name)},a$v.toText=function(a$t,a$k,a$v){return a$P._toText(a$t,a$k,a$v)},a$v.toInt=function(a$t){return a$P._toInt(a$t,a$v.__name2int)},a$v.TEXTURE2D=1,a$v.COLOR2D=2,a$v.PRIMITIVE=4,a$v.FILTERGLOW=8,a$v.FILTERBLUR=16,a$v.FILTERCOLOR=32,a$v.COLORADD=64,a$v.WORLDMAT=128,a$v.FILLTEXTURE=256,a$v.SKINMESH=512,a$v.SHADERDEFINE_FSHIGHPRECISION=1024,a$v.TXTALPHA=2048,a$v.TXTCOMPRESS=4096,a$v.__name2int={},a$v.__int2name=[],a$v.__int2nameMap=[],a$v}(),a$Nt=(function(a$t){function a$V(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){a$V.__super.call(this,a$t,a$k,a$v,a$j,40,a$Q,a$u,a$S)}a$H(a$V,"laya.webgl.shapes.Ellipse",a$vt)}(),function(a$t){function a$u(a$t,a$k,a$v,a$j,a$Q){this._points=[],this.rebuild(a$v),a$u.__super.call(this,a$t,a$k,0,0,0,a$Q,a$j,a$Q,0)}a$H(a$u,"laya.webgl.shapes.Line",a$vt);var a$k=a$u.prototype;return a$k.rebuild=function(a$t){var a$k=a$t.length;a$k!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(a$k/2-1)),this.mFloat32Array=new Float32Array(5*a$k)),this._points.length=0;for(var a$v=NaN,a$j=NaN,a$Q=-1,a$u=-1,a$S=a$t.length/2,a$V=0;a$V<a$S;a$V++)a$v=a$t[2*a$V],a$j=a$t[2*a$V+1],(.01<Math.abs(a$Q-a$v)||.01<Math.abs(a$u-a$j))&&this._points.push(a$v,a$j),a$Q=a$v,a$u=a$j},a$k.getData=function(a$t,a$k,a$v){var a$j=[],a$Q=[];0<this.borderWidth&&this.createLine2(this._points,a$j,this.borderWidth,a$v,a$Q,this._points.length/2),this.mUint16Array.set(a$j,0),this.mFloat32Array.set(a$Q,0),a$t.append(this.mUint16Array),a$k.append(this.mFloat32Array)},a$u}()),a$at=function(a$t){function a$M(a$t,a$k,a$v,a$j,a$Q){this._points=[];for(var a$u=NaN,a$S=NaN,a$V=-1,a$J=-1,a$W=a$v.length/2-1,a$w=0;a$w<a$W;a$w++)a$u=a$v[2*a$w],a$S=a$v[2*a$w+1],(.01<Math.abs(a$V-a$u)||.01<Math.abs(a$J-a$S))&&this._points.push(a$u,a$S),a$V=a$u,a$J=a$S;a$u=a$v[2*a$W],a$S=a$v[2*a$W+1],a$V=this._points[0],a$J=this._points[1],(.01<Math.abs(a$V-a$u)||.01<Math.abs(a$J-a$S))&&this._points.push(a$u,a$S),a$M.__super.call(this,a$t,a$k,0,0,this._points.length/2,0,a$j,a$Q)}a$H(a$M,"laya.webgl.shapes.LoopLine",a$vt);var a$k=a$M.prototype;return a$k.getData=function(a$t,a$k,a$v){if(0<this.borderWidth){for(var a$j=this.color,a$Q=(a$j>>16&255)/255,a$u=(a$j>>8&255)/255,a$S=(255&a$j)/255,a$V=[],a$J=0,a$W=0,a$w=[],a$M=Math.floor(this._points.length/2),a$H=0;a$H<a$M;a$H++)a$J=this._points[2*a$H],a$W=this._points[2*a$H+1],a$V.push(this.x+a$J,this.y+a$W,a$Q,a$u,a$S);this.createLoopLine(a$V,a$w,this.borderWidth,a$v+a$V.length/5),a$t.append(new Uint16Array(a$w)),a$k.append(new Float32Array(a$V))}},a$k.createLoopLine=function(a$t,a$k,a$v,a$j,a$Q,a$u){a$t.length;var a$S=a$t.concat(),a$V=a$Q||a$t,a$J=this.borderColor,a$W=(a$J>>16&255)/255,a$w=(a$J>>8&255)/255,a$M=(255&a$J)/255,a$H=[a$S[0],a$S[1]],a$E=[a$S[a$S.length-5],a$S[a$S.length-4]],a$A=a$E[0]+.5*(a$H[0]-a$E[0]),a$R=a$E[1]+.5*(a$H[1]-a$E[1]);a$S.unshift(a$A,a$R,0,0,0),a$S.push(a$A,a$R,0,0,0);var a$h,a$l,a$o,a$Y,a$f,a$X,a$F,a$d,a$m,a$Z,a$s,a$K,a$U,a$N,a$a,a$z,a$G,a$c,a$T,a$p,a$O=a$S.length/5,a$n=a$j,a$_=a$v/2;a$o=a$S[0],a$Y=a$S[1],a$Z=a$o-(a$f=a$S[5]),a$m=(a$m=-(a$Y-(a$X=a$S[6])))/(a$p=Math.sqrt(a$m*a$m+a$Z*a$Z))*a$_,a$Z=a$Z/a$p*a$_,a$V.push(a$o-a$m,a$Y-a$Z,a$W,a$w,a$M,a$o+a$m,a$Y+a$Z,a$W,a$w,a$M);for(var a$x=1;a$x<a$O-1;a$x++)a$o=a$S[5*(a$x-1)],a$Y=a$S[5*(a$x-1)+1],a$f=a$S[5*a$x],a$X=a$S[5*a$x+1],a$F=a$S[5*(a$x+1)],a$d=a$S[5*(a$x+1)+1],a$Z=a$o-a$f,a$K=a$f-a$F,a$a=(-(a$m=(a$m=-(a$Y-a$X))/(a$p=Math.sqrt(a$m*a$m+a$Z*a$Z))*a$_)+a$o)*(-(a$Z=a$Z/a$p*a$_)+a$X)-(-a$m+a$f)*(-a$Z+a$Y),a$c=(-(a$s=(a$s=-(a$X-a$d))/(a$p=Math.sqrt(a$s*a$s+a$K*a$K))*a$_)+a$F)*(-(a$K=a$K/a$p*a$_)+a$X)-(-a$s+a$f)*(-a$K+a$d),a$T=(a$U=-a$Z+a$Y-(-a$Z+a$X))*(a$G=-a$s+a$f-(-a$s+a$F))-(a$z=-a$K+a$d-(-a$K+a$X))*(a$N=-a$m+a$f-(-a$m+a$o)),Math.abs(a$T)<.1?(a$T+=10.1,a$V.push(a$f-a$m,a$X-a$Z,a$W,a$w,a$M,a$f+a$m,a$X+a$Z,a$W,a$w,a$M)):(((a$h=(a$N*a$c-a$G*a$a)/a$T)-a$f)*(a$h-a$f)+((a$l=(a$z*a$a-a$U*a$c)/a$T)-a$X)+(a$l-a$X),a$V.push(a$h,a$l,a$W,a$w,a$M,a$f-(a$h-a$f),a$X-(a$l-a$X),a$W,a$w,a$M));a$u&&(a$k=a$u);var a$I=this.edges+1;for(a$x=1;a$x<a$I;a$x++)a$k.push(a$n+2*(a$x-1),a$n+2*(a$x-1)+1,a$n+2*a$x+1,a$n+2*a$x+1,a$n+2*a$x,a$n+2*(a$x-1));return a$k.push(a$n+2*(a$x-1),a$n+2*(a$x-1)+1,a$n+1,a$n+1,a$n,a$n+2*(a$x-1)),a$V},a$M}(),a$zt=function(a$t){function a$S(a$t,a$k,a$v,a$j,a$Q,a$u){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=a$Z.create(),this._points=a$v.slice(0,a$v.length),a$S.__super.call(this,a$t,a$k,0,0,this._points.length/2,a$j,a$Q,a$u)}a$H(a$S,"laya.webgl.shapes.Polygon",a$vt);var a$k=a$S.prototype;return a$k.rebuild=function(a$t){this._repaint||(this._points.length=0,this._points=this._points.concat(a$t))},a$k.setMatrix=function(a$t){a$t.copyTo(this._mat)},a$k.needUpdate=function(a$t){return this._repaint=this._mat.a==a$t.a&&this._mat.b==a$t.b&&this._mat.c==a$t.c&&this._mat.d==a$t.d&&this._mat.tx==a$t.tx&&this._mat.ty==a$t.ty,!this._repaint},a$k.getData=function(a$t,a$k,a$v){var a$j,a$Q=0,a$u=this._points,a$S=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=a$v){for(this._start=a$v,a$j=[],a$S=this.earcutTriangles.length,a$Q=0;a$Q<a$S;a$Q++)a$j.push(this.earcutTriangles[a$Q]+a$v);this.mUint16Array=new Uint16Array(a$j)}}else{this._start=a$v,a$j=[];var a$V=[],a$J=[],a$W=this.color,a$w=(a$W>>16&255)/255,a$M=(a$W>>8&255)/255,a$H=(255&a$W)/255;for(a$S=Math.floor(a$u.length/2),a$Q=0;a$Q<a$S;a$Q++)a$V.push(this.x+a$u[2*a$Q],this.y+a$u[2*a$Q+1],a$w,a$M,a$H),a$J.push(this.x+a$u[2*a$Q],this.y+a$u[2*a$Q+1]);for(this.earcutTriangles=a$jt.earcut(a$J,null,2),a$S=this.earcutTriangles.length,a$Q=0;a$Q<a$S;a$Q++)a$j.push(this.earcutTriangles[a$Q]+a$v);this.mUint16Array=new Uint16Array(a$j),this.mFloat32Array=new Float32Array(a$V)}a$t.append(this.mUint16Array),a$k.append(this.mFloat32Array)},a$S}(),a$Gt=function(a$t){function a$u(){this._matrix=new a$Z,this._matrix4=a$Rt.defaultMatrix4.concat(),a$u.__super.call(this,1e4),this.shaderValue=new a$mt(0,0)}a$H(a$u,"laya.webgl.submit.SubmitCanvas",a$ut);var a$k=a$u.prototype;return a$k.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var a$t=a$ot.worldAlpha,a$k=a$ot.worldMatrix4,a$v=a$ot.worldMatrix,a$j=a$ot.worldFilters,a$Q=a$ot.worldShaderDefines,a$u=this.shaderValue,a$S=this._matrix,a$V=this._matrix4,a$J=a$Z.TEMP;return a$Z.mul(a$S,a$v,a$J),a$V[0]=a$J.a,a$V[1]=a$J.b,a$V[4]=a$J.c,a$V[5]=a$J.d,a$V[12]=a$J.tx,a$V[13]=a$J.ty,a$ot.worldMatrix=a$J.clone(),a$ot.worldMatrix4=a$V,a$ot.worldAlpha=a$ot.worldAlpha*a$u.alpha,a$u.filters&&a$u.filters.length&&(a$ot.worldFilters=a$u.filters,a$ot.worldShaderDefines=a$u.defines),this._ctx_src.flush(),a$ot.worldAlpha=a$t,a$ot.worldMatrix4=a$k,a$ot.worldMatrix.destroy(),a$ot.worldMatrix=a$v,a$ot.worldFilters=a$j,a$ot.worldShaderDefines=a$Q,1},a$k.releaseRender=function(){var a$t=a$u._cache;this._ctx_src=null,a$t[a$t._length++]=this},a$k.getRenderType=function(){return 10003},a$u.create=function(a$t,a$k,a$v){var a$j=a$u._cache._length?a$u._cache[--a$u._cache._length]:new a$u;a$j._ctx_src=a$t;var a$Q=a$j.shaderValue;return a$Q.alpha=a$k,a$Q.defines.setValue(0),a$v&&a$v.length&&a$Q.setFilters(a$v),a$j},a$u._cache=((a$u._cache=[])._length=0,a$u._cache),a$u}(),a$ct=function(a$t){function a$W(a$t){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===a$t&&(a$t=1e4),a$W.__super.call(this,a$t)}a$H(a$W,"laya.webgl.submit.SubmitTexture",a$ut);var a$k=a$W.prototype;return a$k.releaseRender=function(){var a$t=a$W._cache;(a$t[a$t._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},a$k.addTexture=function(a$t,a$k){this._texsID[this._texs.length]=a$t._uvID,this._texs.push(a$t),this._vbPos.push(a$k)},a$k.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var a$t=this.shaderValue.textureHost.bitmap;if(null!==a$t)for(var a$k=this._vb.getFloat32Array(),a$v=0,a$j=this._texs.length;a$v<a$j;a$v++){var a$Q=this._texs[a$v];a$Q.active();var a$u=a$Q.uv;if(this._texsID[a$v]!==a$Q._uvID){this._texsID[a$v]=a$Q._uvID;var a$S=this._vbPos[a$v];a$k[a$S+2]=a$u[0],a$k[a$S+3]=a$u[1],a$k[a$S+6]=a$u[2],a$k[a$S+7]=a$u[3],a$k[a$S+10]=a$u[4],a$k[a$S+11]=a$u[5],a$k[a$S+14]=a$u[6],a$k[a$S+15]=a$u[7],this._vb.setNeedUpload()}a$Q.bitmap!==a$t&&(this._isSameTexture=!1)}}},a$k.renderSubmit=function(){if(0===this._numEle)return a$W._shaderSet=!1,1;var a$t=this.shaderValue.textureHost;if(a$t){var a$k=a$t.source;if(!a$t.bitmap||!a$k)return a$W._shaderSet=!1,1;this.shaderValue.texture=a$k,a$t.alphaTexture&&a$t.alphaTexture.source&&(this.shaderValue.texture1=a$t.alphaTexture.source)}this._vb.bind_upload(this._ib);var a$v=a$ft.mainContext;if(a$D.activeBlendFunction!==this._blendFn&&(a$v.enable(3042),this._blendFn(a$v),a$D.activeBlendFunction=this._blendFn),a$a.drawCall++,a$a.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&a$pt.activeShader&&a$W._shaderSet?(a$pt.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&a$pt.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),a$W._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var a$j=a$t.bitmap,a$Q=0,a$u=a$pt.activeShader,a$S=0,a$V=this._texs.length;a$S<a$V;a$S++){var a$J=this._texs[a$S];a$J.bitmap===a$j&&a$S+1!==a$V||(a$u.uploadTexture2D(a$J.source),a$v.drawElements(4,6*(a$S-a$Q+1),5123,this._startIdx+6*a$Q*a$Rt.BYTES_PIDX),a$j=a$J.bitmap,a$Q=a$S)}else a$v.drawElements(4,this._numEle,5123,this._startIdx);return 1},a$W.create=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$W._cache._length?a$W._cache[--a$W._cache._length]:new a$W;null==a$v&&((a$v=a$u._selfVb||(a$u._selfVb=a$Pt.create(-1))).clear(),a$j=0),a$u._ib=a$k,a$u._vb=a$v,a$u._startIdx=a$j*a$Rt.BYTES_PIDX,a$u._numEle=0;var a$S=a$t._nBlendType;a$u._blendFn=a$t._targets?a$D.targetFns[a$S]:a$D.fns[a$S],a$u.shaderValue=a$Q,a$u.shaderValue.setValue(a$t._shader2D);var a$V=a$t._shader2D.filters;return a$V&&a$u.shaderValue.setFilters(a$V),a$u},a$W._cache=((a$W._cache=[])._length=0,a$W._cache),a$W._shaderSet=!0,a$W}(),a$Tt=function(a$t){function a$l(){a$l.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}a$H(a$l,"laya.webgl.utils.MeshTexture",a$lt);var a$k=a$l.prototype;return a$k.addData=function(a$t,a$k,a$v,a$j,a$Q,a$u){for(var a$S=a$t.length/2,a$V=this._vb.needSize(a$S*a$l.const_stride)>>2,a$J=this._vb.getFloat32Array(),a$W=0,a$w=0;a$w<a$S;a$w++){var a$M=a$t[a$W],a$H=a$t[a$W+1],a$E=a$M*a$j.a+a$H*a$j.c+a$j.tx,a$A=a$M*a$j.b+a$H*a$j.d+a$j.ty;a$J[a$V++]=a$E,a$J[a$V++]=a$A,a$J[a$V++]=a$k[a$W],a$J[a$V++]=a$k[a$W+1],a$W+=2}this._vb.setNeedUpload();var a$R=this.vertNum;if(0<a$R){(a$S=a$v.length)>a$l.tmpIdx.length&&(a$l.tmpIdx=new Uint16Array(a$S));for(var a$h=0;a$h<a$S;a$h++)a$l.tmpIdx[a$h]=a$v[a$h]+a$R;this._ib.appendU16Array(a$l.tmpIdx,a$v.length)}else this._ib.append(a$v);this._ib.setNeedUpload(),this.vertNum+=a$S,this.indexNum+=a$v.length},a$k.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},a$k.destroy=function(){this._ib.destroy(),this._vb.destroy()},a$l.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new a$l},a$l.const_stride=16,a$l._POOL=[],a$S(a$l,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),a$l}(),a$pt=function(a$t){function a$k(){a$k.__super.call(this),this.lock=!0}return a$H(a$k,"laya.webgl.shader.BaseShader",a$Y),a$k.activeShader=null,a$k.bindShader=null,a$k}(),a$Ot=function(a$k){function a$w(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===a$v&&(a$v=6408),void 0===a$j&&(a$j=5121),void 0===a$Q&&(a$Q=34041),void 0===a$u&&(a$u=!1),void 0===a$S&&(a$S=!1),void 0===a$V&&(a$V=-1),void 0===a$J&&(a$J=-1),this._type=1,this._w=a$t,this._h=a$k,this._surfaceFormat=a$v,this._surfaceType=a$j,this._depthStencilFormat=a$Q,a$l.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=a$u,this._repeat=a$S,this._minFifter=a$V,this._magFifter=a$J,this._createWebGLRenderTarget(),this.bitmap.lock=!0,a$w.__super.call(this,this.bitmap,a$T.INV_UV)}a$H(a$w,"laya.webgl.resource.RenderTarget2D",a$k);var a$t=a$w.prototype;return a$F.imps(a$t,{"laya.resource.IDispose":!0}),a$t.getType=function(){return this._type},a$t.getTexture=function(){return this},a$t.size=function(a$t,a$k){this._w==a$t&&this._h==a$k||(this._w=a$t,this._h=a$k,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},a$t.release=function(){this.destroy()},a$t.recycle=function(){a$w.POOL.push(this)},a$t.start=function(){var a$t=a$ft.mainContext;return this._preRenderTarget=a$ot.curRenderTarget,a$ot.curRenderTarget=this,a$t.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(a$t.viewport(0,0,this._w,this._h),this._svWidth=a$ot.width,this._svHeight=a$ot.height,a$ot.width=this._w,a$ot.height=this._h,a$pt.activeShader=null),this},a$t.clear=function(a$t,a$k,a$v,a$j){void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=1);var a$Q=a$ft.mainContext;a$Q.clearColor(a$t,a$k,a$v,a$j);var a$u=16384;switch(this._depthStencilFormat){case 33189:a$u|=256;break;case 36168:a$u|=1024;break;case 34041:a$u|=256,a$u|=1024}a$Q.clear(a$u)},a$t.end=function(){var a$t=a$ft.mainContext;a$t.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,a$ot.curRenderTarget=this._preRenderTarget,1==this._type?(a$t.viewport(0,0,this._svWidth,this._svHeight),a$ot.width=this._svWidth,a$ot.height=this._svHeight,a$pt.activeShader=null):a$t.viewport(0,0,a$F.stage.width,a$F.stage.height)},a$t.getData=function(a$t,a$k,a$v,a$j){var a$Q=a$ft.mainContext;if(a$Q.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===a$Q.checkFramebufferStatus(36160)))return a$Q.bindFramebuffer(36160,null),null;var a$u=new Uint8Array(this._w*this._h*4);return a$Q.readPixels(a$t,a$k,a$v,a$j,this._surfaceFormat,this._surfaceType,a$u),a$Q.bindFramebuffer(36160,null),a$u},a$t.destroy=function(a$t){void 0===a$t&&(a$t=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,a$k.prototype.destroy.call(this))},a$t.dispose=function(){},a$t._createWebGLRenderTarget=function(){this.bitmap=new a$Ct(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(a$t){this.event("recovered")})},a$j(0,a$t,"surfaceFormat",function(){return this._surfaceFormat}),a$j(0,a$t,"magFifter",function(){return this._magFifter}),a$j(0,a$t,"surfaceType",function(){return this._surfaceType}),a$j(0,a$t,"mipMap",function(){return this._mipMap}),a$j(0,a$t,"depthStencilFormat",function(){return this._depthStencilFormat}),a$j(0,a$t,"minFifter",function(){return this._minFifter}),a$j(0,a$t,"source",function(){return this._alreadyResolved?a$F.superGet(a$T,this,"source"):null}),a$w.create=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){void 0===a$v&&(a$v=6408),void 0===a$j&&(a$j=5121),void 0===a$Q&&(a$Q=34041),void 0===a$u&&(a$u=!1),void 0===a$S&&(a$S=!1),void 0===a$V&&(a$V=-1),void 0===a$J&&(a$J=-1);var a$W=a$w.POOL.pop();return a$W||(a$W=new a$w(a$t,a$k)),a$W.bitmap&&a$W._w==a$t&&a$W._h==a$k&&a$W._surfaceFormat==a$v&&a$W._surfaceType==a$j&&a$W._depthStencilFormat==a$Q&&a$W._mipMap==a$u&&a$W._repeat==a$S&&a$W._minFifter==a$V&&a$W._magFifter==a$J||(a$W._w=a$t,a$W._h=a$k,a$W._surfaceFormat=a$v,a$W._surfaceType=a$j,a$W._depthStencilFormat=a$Q,a$l.isConchWebGL&&34041===a$W._depthStencilFormat&&(a$W._depthStencilFormat=33189),a$W._mipMap=a$u,a$W._repeat=a$S,a$W._minFifter=a$V,a$W._magFifter=a$J,a$W.release(),a$W._createWebGLRenderTarget()),a$W},a$w.TYPE2D=1,a$w.TYPE3D=2,a$w.POOL=[],a$w}(a$T),a$nt=function(a$t){function a$k(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,a$k.__super.call(this),a$k._gl=a$ft.mainContext}a$H(a$k,"laya.webgl.utils.Buffer",a$Y);var a$v=a$k.prototype;return a$v._bind=function(){this.activeResource(),a$k._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(a$k._bindVertexBuffer=this._glBuffer),a$k._gl.bindBuffer(this._bufferType,a$k._bindActive[this._bufferType]=this._glBuffer),a$pt.activeShader=null)},a$v.recreateResource=function(){this._glBuffer||(this._glBuffer=a$k._gl.createBuffer()),this.completeCreate()},a$v.disposeResource=function(){this._glBuffer&&(a$ft.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},a$j(0,a$v,"bufferUsage",function(){return this._bufferUsage}),a$k._gl=null,a$k._bindActive={},a$k._bindVertexBuffer=null,a$k._enableAtributes=[],a$k}(),a$_t=function(a$t){function a$v(a$t){this.texcoord=null,this.offsetX=300,this.offsetY=0,a$v.__super.call(this,512,0);var a$k=8*a$Rt.BYTES_PE;this.position=[2,5126,!1,a$k,0],this.texcoord=[2,5126,!1,a$k,2*a$Rt.BYTES_PE],this.color=[4,5126,!1,a$k,4*a$Rt.BYTES_PE]}return a$H(a$v,"laya.webgl.shader.d2.skinAnishader.SkinSV",a$mt),a$v}(),a$xt=function(a$t){function a$k(a$t){a$k.__super.call(this,2,0),this.color=[]}return a$H(a$k,"laya.webgl.shader.d2.value.Color2dSV",a$mt),a$k.prototype.setValue=function(a$t){a$t.fillStyle&&(this.color=a$t.fillStyle._color._color),a$t.strokeStyle&&(this.color=a$t.strokeStyle._color._color)},a$k}(),a$It=function(a$t){function a$k(a$t){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=a$mt._TEXCOORD,a$k.__super.call(this,256,0)}a$H(a$k,"laya.webgl.shader.d2.value.FillTextureSV",a$mt);var a$v=a$k.prototype;return a$v.setValue=function(a$t){this.ALPHA=a$t.ALPHA,a$t.filters&&this.setFilters(a$t.filters)},a$v.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},a$k}(),a$it=function(a$t){function a$k(a$t){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=a$mt._TEXCOORD,void 0===a$t&&(a$t=0),a$k.__super.call(this,1,a$t)}a$H(a$k,"laya.webgl.shader.d2.value.TextureSV",a$mt);var a$v=a$k.prototype;return a$v.setValue=function(a$t){this.ALPHA=a$t.ALPHA,a$t.filters&&this.setFilters(a$t.filters)},a$v.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},a$k}(),a$Dt=function(a$t){function a$k(a$t){this.a_color=null,this.u_pos=[0,0],a$k.__super.call(this,4,0),this.position=[2,5126,!1,5*a$Rt.BYTES_PE,0],this.a_color=[3,5126,!1,5*a$Rt.BYTES_PE,2*a$Rt.BYTES_PE]}return a$H(a$k,"laya.webgl.shader.d2.value.PrimitiveSV",a$mt),a$k}(),a$Bt=function(a$t){function a$k(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,a$k.__super.call(this)}a$H(a$k,"laya.webgl.atlas.AtlasWebGLCanvas",a$t);var a$v=a$k.prototype;return a$v.recreateResource=function(){var a$t=a$ft.mainContext,a$k=this._source=a$t.createTexture(),a$v=a$Xt.curBindTexTarget,a$j=a$Xt.curBindTexValue;a$Xt.bindTexture(a$t,3553,a$k),a$t.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),a$t.texParameteri(3553,10241,9729),a$t.texParameteri(3553,10240,9729),a$t.texParameteri(3553,10242,33071),a$t.texParameteri(3553,10243,33071),a$v&&a$j&&a$Xt.bindTexture(a$t,a$v,a$j),this.memorySize=this._w*this._h*4,this.completeCreate()},a$v.disposeResource=function(){this._source&&(a$ft.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},a$v.texSubImage2D=function(a$t,a$k,a$v){if(a$l.isFlash){this._flashCacheImage||(this._flashCacheImage=a$R.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var a$j=a$v.bitmapdata;this._flashCacheImage._image.copyPixels(a$j,0,0,a$j.width,a$j.height,a$t,a$k),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var a$Q=a$ft.mainContext,a$u=a$Xt.curBindTexTarget,a$S=a$Xt.curBindTexValue;a$Xt.bindTexture(a$Q,3553,this._source),a$Q.pixelStorei(37441,!0),0<=a$t-1&&a$Q.texSubImage2D(3553,0,a$t-1,a$k,6408,5121,a$v),a$t+1<=this._w&&a$Q.texSubImage2D(3553,0,a$t+1,a$k,6408,5121,a$v),0<=a$k-1&&a$Q.texSubImage2D(3553,0,a$t,a$k-1,6408,5121,a$v),a$k+1<=this._h&&a$Q.texSubImage2D(3553,0,a$t,a$k+1,6408,5121,a$v),a$Q.texSubImage2D(3553,0,a$t,a$k,6408,5121,a$v),a$Q.pixelStorei(37441,!1),a$u&&a$S&&a$Xt.bindTexture(a$Q,a$u,a$S)}},a$v.texSubImage2DPixel=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$ft.mainContext,a$S=a$Xt.curBindTexTarget,a$V=a$Xt.curBindTexValue;a$Xt.bindTexture(a$u,3553,this._source);var a$J=new Uint8Array(a$Q.data);a$u.pixelStorei(37441,!0),a$u.texSubImage2D(3553,0,a$t,a$k,a$v,a$j,6408,5121,a$J),a$u.pixelStorei(37441,!1),a$S&&a$V&&a$Xt.bindTexture(a$u,a$S,a$V)},a$j(0,a$v,"width",a$t.prototype._$get_width,function(a$t){this._w=a$t}),a$j(0,a$v,"height",a$t.prototype._$get_height,function(a$t){this._h=a$t}),a$k}(a$v),a$bt=function(a$t){function a$Q(){this.flipY=!0,this.alwaysChange=!1,a$Q.__super.call(this)}a$H(a$Q,"laya.webgl.resource.WebGLCanvas",a$v);var a$k=a$Q.prototype;return a$k.getCanvas=function(){return this._canvas},a$k.clear=function(){this._ctx&&this._ctx.clear()},a$k.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},a$k._setContext=function(a$t){this._ctx=a$t},a$k.getContext=function(a$t,a$k){return this._ctx?this._ctx:this._ctx=a$Q._createContext(this)},a$k.size=function(a$t,a$k){this._w==a$t&&this._h==a$k||(this._w=a$t,this._h=a$k,this._ctx&&this._ctx.size(a$t,a$k),this._canvas&&(this._canvas.height=a$k,this._canvas.width=a$t))},a$k.activeResource=function(a$t){void 0===a$t&&(a$t=!1),this._source||this.recreateResource()},a$k.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},a$k.disposeResource=function(){this._source&&!this.iscpuSource&&(a$ft.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},a$k.createWebGlTexture=function(){var a$t=a$ft.mainContext;this._canvas;var a$k=this._source=a$t.createTexture();this.iscpuSource=!1;var a$v=a$Xt.curBindTexTarget,a$j=a$Xt.curBindTexValue;a$Xt.bindTexture(a$t,3553,a$k),a$t.pixelStorei(37440,this.flipY?1:0),a$Q.premulAlpha&&a$t.pixelStorei(37441,!0),a$t.texImage2D(3553,0,6408,6408,5121,this._imgData),a$Q.premulAlpha&&a$t.pixelStorei(37441,!1),a$t.texParameteri(3553,10240,9729),a$t.texParameteri(3553,10241,9729),a$t.texParameteri(3553,10242,33071),a$t.texParameteri(3553,10243,33071),a$t.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,a$v&&a$j&&a$Xt.bindTexture(a$t,a$v,a$j)},a$k.reloadCanvasData=function(){var a$t=a$ft.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var a$k=a$Xt.curBindTexTarget,a$v=a$Xt.curBindTexValue;a$Xt.bindTexture(a$t,3553,this._source),a$Q.premulAlpha&&a$t.pixelStorei(37441,!0),a$t.texImage2D(3553,0,6408,6408,5121,this._imgData),a$Q.premulAlpha&&a$t.pixelStorei(37441,!1),a$t.pixelStorei(37440,0),a$k&&a$v&&a$Xt.bindTexture(a$t,a$k,a$v)},a$k.texSubImage2D=function(a$t,a$k,a$v){var a$j=a$ft.mainContext,a$Q=a$Xt.curBindTexTarget,a$u=a$Xt.curBindTexValue;a$Xt.bindTexture(a$j,3553,this._source),a$j.pixelStorei(37441,!0),a$j.texSubImage2D(3553,0,a$k,a$v,6408,5121,a$t._source),a$j.pixelStorei(37441,!1),a$Q&&a$u&&a$Xt.bindTexture(a$j,a$Q,a$u)},a$k.toBase64=function(a$t,a$k,a$v){var a$j=null;this._canvas&&(a$j=this._canvas.toDataURL(a$t,a$k)),a$v.call(this,a$j)},a$j(0,a$k,"context",function(){return this._ctx}),a$j(0,a$k,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),a$j(0,a$k,"asBitmap",null,function(a$t){this._ctx&&(this._ctx.asBitmap=a$t)}),a$Q._createContext=null,a$Q.premulAlpha=!1,a$Q}(),a$qt=function(a$t){function a$u(a$t,a$k){this.CborderSize=12,a$u.__super.call(this),this.char=a$t,this.isSpace=" "===a$t,this.xs=a$k.scaleX,this.ys=a$k.scaleY,this.font=a$k.font.toString(),this.fontSize=a$k.font.size,this.fillColor=a$k.fillColor,this.borderColor=a$k.borderColor,this.lineWidth=a$k.lineWidth,this.underLine=a$k.underLine;var a$v,a$j=a$l.isConchApp;a$j?((a$v=ConchTextCanvas)._source=ConchTextCanvas,a$v._source.canvas=ConchTextCanvas):a$v=a$E.canvas.source,this.canvas=a$v,this._enableMerageInAtlas=!0,this._ctx=a$j?a$v:this.canvas.getContext("2d",void 0);var a$Q=a$p.measureText(this.char,this.font);this.cw=a$Q.width*this.xs,this.ch=(a$Q.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new a$T(this)}a$H(a$u,"laya.webgl.resource.WebGLCharImage",a$v);var a$k=a$u.prototype;return a$F.imps(a$k,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),a$k.active=function(){this.texture.active()},a$k.recreateResource=function(){var a$t=a$l.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),a$t){var a$k=this.fontSize;1==this.xs&&1==this.ys||(a$k=parseInt(a$k*(this.xs>this.ys?this.xs:this.ys)+""));var a$v="normal 100 "+this.font;a$v=a$v.replace(a$u._fontSizeReg,a$k),this.borderColor&&(a$v+=" 1 "+this.borderColor),this._ctx.font=a$v,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,a$c.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var a$j=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(a$j,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},a$k.onresize=function(a$t,a$k){this._w=a$t,this._h=a$k,this._allowMerageInAtlas=!0},a$k.clearAtlasSource=function(){},a$j(0,a$k,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),a$j(0,a$k,"atlasSource",function(){return this.canvas}),a$j(0,a$k,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(a$t){this._enableMerageInAtlas=a$t}),a$u.createOneChar=function(a$t,a$k){return new a$u(a$t,a$k)},a$u._fontSizeReg=new RegExp("\\d+(?=px)","g"),a$u}(),a$Ct=function(a$t){function a$W(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){void 0===a$v&&(a$v=6408),void 0===a$j&&(a$j=5121),void 0===a$Q&&(a$Q=34041),void 0===a$u&&(a$u=!1),void 0===a$S&&(a$S=!1),void 0===a$V&&(a$V=-1),void 0===a$J&&(a$J=1),a$W.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=a$t,this._h=a$k,this._surfaceFormat=a$v,this._surfaceType=a$j,this._depthStencilFormat=a$Q,this._mipMap=a$u,this._repeat=a$S,this._minFifter=a$V,this._magFifter=a$J}a$H(a$W,"laya.webgl.resource.WebGLRenderTarget",a$v);var a$k=a$W.prototype;return a$k.recreateResource=function(){var a$t=a$ft.mainContext;this._frameBuffer||(this._frameBuffer=a$t.createFramebuffer()),this._source||(this._source=a$t.createTexture());var a$k=a$Xt.curBindTexTarget,a$v=a$Xt.curBindTexValue;a$Xt.bindTexture(a$t,3553,this._source),a$t.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var a$j=this._minFifter,a$Q=this._magFifter,a$u=this._repeat?10497:33071,a$S=a$w.isPOT(this._w,this._h);if(a$S?(this._mipMap?-1!==a$j||(a$j=9987):-1!==a$j||(a$j=9729),-1!==a$Q||(a$Q=9729),a$t.texParameteri(3553,10241,a$j),a$t.texParameteri(3553,10240,a$Q),a$t.texParameteri(3553,10242,a$u),a$t.texParameteri(3553,10243,a$u),this._mipMap&&a$t.generateMipmap(3553)):(-1!==a$j||(a$j=9729),-1!==a$Q||(a$Q=9729),a$t.texParameteri(3553,10241,a$j),a$t.texParameteri(3553,10240,a$Q),a$t.texParameteri(3553,10242,33071),a$t.texParameteri(3553,10243,33071)),a$t.bindFramebuffer(36160,this._frameBuffer),a$t.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=a$t.createRenderbuffer()),a$t.bindRenderbuffer(36161,this._depthStencilBuffer),a$t.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:a$t.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:a$t.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:a$t.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}a$t.bindFramebuffer(36160,null),a$k&&a$v&&a$Xt.bindTexture(a$t,a$k,a$v),a$t.bindRenderbuffer(36161,null),a$S&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},a$k.disposeResource=function(){this._frameBuffer&&(a$ft.mainContext.deleteTexture(this._source),a$ft.mainContext.deleteFramebuffer(this._frameBuffer),a$ft.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},a$j(0,a$k,"depthStencilBuffer",function(){return this._depthStencilBuffer}),a$j(0,a$k,"frameBuffer",function(){return this._frameBuffer}),a$W}(),a$Lt=function(a$t){function a$V(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this.offsetX=0,this.offsetY=0,a$V.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=a$u,this.canvas=a$t,this._ctx=a$t.getContext("2d",void 0),this._w=a$j,this._h=a$Q,this.offsetX=a$k,this.offsetY=a$v,this.src=a$S,this._enableMerageInAtlas=!0,a$I.enabled&&this._w<a$I.atlasLimitWidth&&this._h<a$I.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}a$H(a$V,"laya.webgl.resource.WebGLSubImage",a$v);var a$k=a$V.prototype;return a$F.imps(a$k,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),a$k.size=function(a$t,a$k){this._w=a$t,this._h=a$k,this._ctx&&this._ctx.size(a$t,a$k),this.canvas&&(this.canvas.height=a$k,this.canvas.width=a$t)},a$k.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},a$k.createWebGlTexture=function(){var a$t=a$ft.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var a$k=this._source=a$t.createTexture(),a$v=a$Xt.curBindTexTarget,a$j=a$Xt.curBindTexValue;a$Xt.bindTexture(a$t,3553,a$k),a$t.pixelStorei(37441,!0),a$t.texImage2D(3553,0,6408,6408,5121,this.canvas),a$t.pixelStorei(37441,!1);var a$Q=this.minFifter,a$u=this.magFifter,a$S=this.repeat?10497:33071,a$V=a$w.isPOT(this.width,this.height);a$V?(this.mipmap?-1!==a$Q||(a$Q=9987):-1!==a$Q||(a$Q=9729),-1!==a$u||(a$u=9729),a$t.texParameteri(3553,10240,a$u),a$t.texParameteri(3553,10241,a$Q),a$t.texParameteri(3553,10242,a$S),a$t.texParameteri(3553,10243,a$S),this.mipmap&&a$t.generateMipmap(3553)):(-1!==a$Q||(a$Q=9729),-1!==a$u||(a$u=9729),a$t.texParameteri(3553,10241,a$Q),a$t.texParameteri(3553,10240,a$u),a$t.texParameteri(3553,10242,33071),a$t.texParameteri(3553,10243,33071)),a$v&&a$j&&a$Xt.bindTexture(a$t,a$v,a$j),this.canvas=null,a$V&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},a$k.disposeResource=function(){a$I.enabled&&this._allowMerageInAtlas||!this._source||(a$ft.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},a$k.clearAtlasSource=function(){},a$j(0,a$k,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),a$j(0,a$k,"atlasSource",function(){return this.canvas}),a$j(0,a$k,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(a$t){this._allowMerageInAtlas=a$t}),a$V}(),a$et=function(a$t){function a$W(a$t,a$k,a$v,a$j){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,a$W.__super.call(this),!a$t||!a$k)throw"Shader Error";this._id=++a$W._count,this._vs=a$t,this._ps=a$k,this._nameMap=a$j||{},null!=a$v&&(a$W.sharders[a$v]=this)}a$H(a$W,"laya.webgl.shader.Shader",a$pt);var a$k=a$W.prototype;return a$k.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},a$k.disposeResource=function(){a$ft.mainContext.deleteShader(this._vshader),a$ft.mainContext.deleteShader(this._pshader),a$ft.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},a$k._compile=function(){if(!a$ft.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var a$t=[this._vs,this._ps],a$k=a$ft.mainContext;if(this._program=a$k.createProgram(),this._vshader=a$W._createShader(a$k,a$t[0],35633),this._pshader=a$W._createShader(a$k,a$t[1],35632),a$k.attachShader(this._program,this._vshader),a$k.attachShader(this._program,this._pshader),a$k.linkProgram(this._program),!a$l.isConchApp&&!a$k.getProgramParameter(this._program,35714))throw a$k.getProgramInfoLog(this._program);var a$v,a$j,a$Q=0,a$u=0;for(a$u=a$l.isConchApp?a$k.getProgramParameterEx(this._vs,this._ps,"",35721):a$k.getProgramParameter(this._program,35721),a$Q=0;a$Q<a$u;a$Q++){var a$S=null;a$v={vartype:"attribute",glfun:null,ivartype:0,attrib:a$S=a$l.isConchApp?a$k.getActiveAttribEx(this._vs,this._ps,"",a$Q):a$k.getActiveAttrib(this._program,a$Q),location:a$k.getAttribLocation(this._program,a$S.name),name:a$S.name,type:a$S.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(a$v)}var a$V=0;for(a$V=a$l.isConchApp?a$k.getProgramParameterEx(this._vs,this._ps,"",35718):a$k.getProgramParameter(this._program,35718),a$Q=0;a$Q<a$V;a$Q++){var a$J=null;a$J=a$l.isConchApp?a$k.getActiveUniformEx(this._vs,this._ps,"",a$Q):a$k.getActiveUniform(this._program,a$Q),0<(a$v={vartype:"uniform",glfun:null,ivartype:1,attrib:a$S,location:a$k.getUniformLocation(this._program,a$J.name),name:a$J.name,type:a$J.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(a$v.name=a$v.name.substr(0,a$v.name.length-3),a$v.isArray=!0,a$v.location=a$k.getUniformLocation(this._program,a$v.name)),this._params.push(a$v)}for(a$Q=0,a$j=this._params.length;a$Q<a$j;a$Q++)if((a$v=this._params[a$Q]).indexOfParams=a$Q,a$v.index=1,a$v.value=[a$v.location,null],a$v.codename=a$v.name,a$v.name=this._nameMap[a$v.codename]?this._nameMap[a$v.codename]:a$v.codename,(this._paramsMap[a$v.name]=a$v)._this=this,a$v.uploadedValue=[],"attribute"!==a$v.vartype)switch(a$v.type){case 5124:a$v.fun=a$v.isArray?this._uniform1iv:this._uniform1i;break;case 5126:a$v.fun=a$v.isArray?this._uniform1fv:this._uniform1f;break;case 35664:a$v.fun=a$v.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:a$v.fun=a$v.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:a$v.fun=a$v.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:a$v.fun=this._uniform_sampler2D;break;case 35680:a$v.fun=this._uniform_samplerCube;break;case 35676:a$v.glfun=a$k.uniformMatrix4fv,a$v.fun=this._uniformMatrix4fv;break;case 35670:a$v.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else a$v.fun=this._attribute}},a$k.getUniform=function(a$t){return this._paramsMap[a$t]},a$k._attribute=function(a$t,a$k){var a$v=a$ft.mainContext,a$j=a$nt._enableAtributes,a$Q=a$t.location;return a$j[a$Q]||a$v.enableVertexAttribArray(a$Q),a$v.vertexAttribPointer(a$Q,a$k[0],a$k[1],a$k[2],a$k[3],a$k[4]+this._offset),a$j[a$Q]=a$nt._bindVertexBuffer,1},a$k._uniform1f=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k?(a$ft.mainContext.uniform1f(a$t.location,a$v[0]=a$k),1):0},a$k._uniform1fv=function(a$t,a$k){if(a$k.length<4){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]||a$v[2]!==a$k[2]||a$v[3]!==a$k[3]?(a$ft.mainContext.uniform1fv(a$t.location,a$k),a$v[0]=a$k[0],a$v[1]=a$k[1],a$v[2]=a$k[2],a$v[3]=a$k[3],1):0}return a$ft.mainContext.uniform1fv(a$t.location,a$k),1},a$k._uniform_vec2=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]?(a$ft.mainContext.uniform2f(a$t.location,a$v[0]=a$k[0],a$v[1]=a$k[1]),1):0},a$k._uniform_vec2v=function(a$t,a$k){if(a$k.length<2){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]||a$v[2]!==a$k[2]||a$v[3]!==a$k[3]?(a$ft.mainContext.uniform2fv(a$t.location,a$k),a$v[0]=a$k[0],a$v[1]=a$k[1],a$v[2]=a$k[2],a$v[3]=a$k[3],1):0}return a$ft.mainContext.uniform2fv(a$t.location,a$k),1},a$k._uniform_vec3=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]||a$v[2]!==a$k[2]?(a$ft.mainContext.uniform3f(a$t.location,a$v[0]=a$k[0],a$v[1]=a$k[1],a$v[2]=a$k[2]),1):0},a$k._uniform_vec3v=function(a$t,a$k){return a$ft.mainContext.uniform3fv(a$t.location,a$k),1},a$k._uniform_vec4=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]||a$v[2]!==a$k[2]||a$v[3]!==a$k[3]?(a$ft.mainContext.uniform4f(a$t.location,a$v[0]=a$k[0],a$v[1]=a$k[1],a$v[2]=a$k[2],a$v[3]=a$k[3]),1):0},a$k._uniform_vec4v=function(a$t,a$k){return a$ft.mainContext.uniform4fv(a$t.location,a$k),1},a$k._uniformMatrix2fv=function(a$t,a$k){return a$ft.mainContext.uniformMatrix2fv(a$t.location,!1,a$k),1},a$k._uniformMatrix3fv=function(a$t,a$k){return a$ft.mainContext.uniformMatrix3fv(a$t.location,!1,a$k),1},a$k._uniformMatrix4fv=function(a$t,a$k){return a$ft.mainContext.uniformMatrix4fv(a$t.location,!1,a$k),1},a$k._uniform1i=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k?(a$ft.mainContext.uniform1i(a$t.location,a$v[0]=a$k),1):0},a$k._uniform1iv=function(a$t,a$k){return a$ft.mainContext.uniform1iv(a$t.location,a$k),1},a$k._uniform_ivec2=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]?(a$ft.mainContext.uniform2i(a$t.location,a$v[0]=a$k[0],a$v[1]=a$k[1]),1):0},a$k._uniform_ivec2v=function(a$t,a$k){return a$ft.mainContext.uniform2iv(a$t.location,a$k),1},a$k._uniform_vec3i=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]||a$v[2]!==a$k[2]?(a$ft.mainContext.uniform3i(a$t.location,a$v[0]=a$k[0],a$v[1]=a$k[1],a$v[2]=a$k[2]),1):0},a$k._uniform_vec3vi=function(a$t,a$k){return a$ft.mainContext.uniform3iv(a$t.location,a$k),1},a$k._uniform_vec4i=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]||a$v[2]!==a$k[2]||a$v[3]!==a$k[3]?(a$ft.mainContext.uniform4i(a$t.location,a$v[0]=a$k[0],a$v[1]=a$k[1],a$v[2]=a$k[2],a$v[3]=a$k[3]),1):0},a$k._uniform_vec4vi=function(a$t,a$k){return a$ft.mainContext.uniform4iv(a$t.location,a$k),1},a$k._uniform_sampler2D=function(a$t,a$k){var a$v=a$ft.mainContext,a$j=a$t.uploadedValue;return null==a$j[0]?(a$j[0]=this._curActTexIndex,a$v.uniform1i(a$t.location,this._curActTexIndex),a$v.activeTexture(a$W._TEXTURES[this._curActTexIndex]),a$Xt.bindTexture(a$v,3553,a$k),this._curActTexIndex++,1):(a$v.activeTexture(a$W._TEXTURES[a$j[0]]),a$Xt.bindTexture(a$v,3553,a$k),0)},a$k._uniform_samplerCube=function(a$t,a$k){var a$v=a$ft.mainContext,a$j=a$t.uploadedValue;return null==a$j[0]?(a$j[0]=this._curActTexIndex,a$v.uniform1i(a$t.location,this._curActTexIndex),a$v.activeTexture(a$W._TEXTURES[this._curActTexIndex]),a$Xt.bindTexture(a$v,34067,a$k),this._curActTexIndex++,1):(a$v.activeTexture(a$W._TEXTURES[a$j[0]]),a$Xt.bindTexture(a$v,34067,a$k),0)},a$k._noSetValue=function(a$t){console.log("no....:"+a$t.name)},a$k.uploadOne=function(a$t,a$k){this.activeResource(),a$Xt.UseProgram(this._program);var a$v=this._paramsMap[a$t];a$v.fun.call(this,a$v,a$k)},a$k.uploadTexture2D=function(a$t){a$a.shaderCall++;var a$k=a$ft.mainContext;a$k.activeTexture(33984),a$Xt.bindTexture(a$k,3553,a$t)},a$k.uploadTexture2D1=function(a$t){a$a.shaderCall++;var a$k=a$ft.mainContext;a$k.activeTexture(33985),a$Xt.bindTexture(a$k,3553,a$t)},a$k.upload=function(a$t,a$k){a$pt.activeShader=a$pt.bindShader=this,this._lastUseFrameCount===a$a.loopCount||this.activeResource(),a$Xt.UseProgram(this._program),this._reCompile?(a$k=this._params,this._reCompile=!1):a$k=a$k||this._params;a$ft.mainContext;for(var a$v,a$j,a$Q=a$k.length,a$u=0,a$S=0;a$S<a$Q;a$S++)null!==(a$j=a$t[(a$v=a$k[a$S]).name])&&(a$u+=a$v.fun.call(this,a$v,a$j));a$a.shaderCall+=a$u},a$k.uploadArray=function(a$t,a$k,a$v){a$pt.activeShader=this,(a$pt.bindShader=this).activeResource(),a$Xt.UseProgram(this._program);this._params;for(var a$j,a$Q,a$u=0,a$S=a$k-2;0<=a$S;a$S-=2)(a$Q=this._paramsMap[a$t[a$S]])&&null!=(a$j=a$t[a$S+1])&&(a$v&&a$v[a$Q.name]&&a$v[a$Q.name].bind(),a$u+=a$Q.fun.call(this,a$Q,a$j));a$a.shaderCall+=a$u},a$k.getParams=function(){return this._params},a$W.getShader=function(a$t){return a$W.sharders[a$t]},a$W.create=function(a$t,a$k,a$v,a$j){return new a$W(a$t,a$k,a$v,a$j)},a$W.withCompile=function(a$t,a$k,a$v,a$j){if(a$v&&a$W.sharders[a$v])return a$W.sharders[a$v];var a$Q=a$W._preCompileShader[2e-4*a$t];if(!a$Q)throw new Error("withCompile shader err!"+a$t);return a$Q.createShader(a$k,a$v,a$j)},a$W.withCompile2D=function(a$t,a$k,a$v,a$j,a$Q){if(a$j&&a$W.sharders[a$j])return a$W.sharders[a$j];var a$u=a$W._preCompileShader[2e-4*a$t+a$k];if(!a$u)throw new Error("withCompile shader err!"+a$t+" "+a$k);return a$u.createShader(a$v,a$j,a$Q)},a$W.addInclude=function(a$t,a$k){a$Yt.addInclude(a$t,a$k)},a$W.preCompile=function(a$t,a$k,a$v,a$j){var a$Q=2e-4*a$t;a$W._preCompileShader[a$Q]=new a$Yt(a$Q,a$k,a$v,a$j)},a$W.preCompile2D=function(a$t,a$k,a$v,a$j,a$Q){var a$u=2e-4*a$t+a$k;a$W._preCompileShader[a$u]=new a$Yt(a$u,a$v,a$j,a$Q)},a$W._createShader=function(a$t,a$k,a$v){var a$j=a$t.createShader(a$v);return a$t.shaderSource(a$j,a$k),a$t.compileShader(a$j),a$j},a$W._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],a$W._count=0,a$W._preCompileShader={},a$W.SHADERNAME2ID=2e-4,a$W.sharders=((a$W.sharders=[]).length=32,a$W.sharders),a$S(a$W,["nameKey",function(){return this.nameKey=new a$z}]),a$W}(),a$rt=function(a$t){function a$k(){this._maxsize=0,this._upload=!0,this._uploadSize=0,a$k.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}a$H(a$k,"laya.webgl.utils.Buffer2D",a$t);var a$v=a$k.prototype;return a$v.needSize=function(a$t){var a$k=this._byteLength;if(a$t){var a$v=this._byteLength+a$t;a$v<=this._buffer.byteLength||this._resizeBuffer(a$v<<1,!0),this._byteLength=a$v}return a$k},a$v._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),a$a.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,a$nt._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),a$nt._gl.bufferSubData(this._bufferType,0,this._buffer)},a$v._bufferSubData=function(a$t,a$k,a$v){if(void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),this._maxsize=Math.max(this._maxsize,this._byteLength),a$a.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,a$nt._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),a$k||a$v){var a$j=this._buffer.slice(a$k,a$v);a$nt._gl.bufferSubData(this._bufferType,a$t,a$j)}else a$nt._gl.bufferSubData(this._bufferType,a$t,this._buffer)},a$v._checkArrayUse=function(){},a$v._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},a$v._bind_subUpload=function(a$t,a$k,a$v){return void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(a$t,a$k,a$v),!0)},a$v._resizeBuffer=function(a$t,a$k){if(a$t<this._buffer.byteLength)return this;if(this.memorySize=a$t,a$k&&this._buffer&&0<this._buffer.byteLength){var a$v=new ArrayBuffer(a$t);new Uint8Array(a$v).set(new Uint8Array(this._buffer),0),this._buffer=a$v}else this._buffer=new ArrayBuffer(a$t);return this._checkArrayUse(),this._upload=!0,this},a$v.append=function(a$t){this._upload=!0;var a$k,a$v;a$k=a$t.byteLength,a$t instanceof Uint8Array?(this._resizeBuffer(this._byteLength+a$k,!0),a$v=new Uint8Array(this._buffer,this._byteLength)):a$t instanceof Uint16Array?(this._resizeBuffer(this._byteLength+a$k,!0),a$v=new Uint16Array(this._buffer,this._byteLength)):a$t instanceof Float32Array&&(this._resizeBuffer(this._byteLength+a$k,!0),a$v=new Float32Array(this._buffer,this._byteLength)),a$v.set(a$t,0),this._byteLength+=a$k,this._checkArrayUse()},a$v.appendU16Array=function(a$t,a$k){this._resizeBuffer(this._byteLength+2*a$k,!0);for(var a$v=new Uint16Array(this._buffer,this._byteLength,a$k),a$j=0;a$j<a$k;a$j++)a$v[a$j]=a$t[a$j];this._byteLength+=2*a$k,this._checkArrayUse()},a$v.appendEx=function(a$t,a$k){this._upload=!0;var a$v;a$v=a$t.byteLength,this._resizeBuffer(this._byteLength+a$v,!0),new a$k(this._buffer,this._byteLength).set(a$t,0),this._byteLength+=a$v,this._checkArrayUse()},a$v.appendEx2=function(a$t,a$k,a$v,a$j){void 0===a$j&&(a$j=1),this._upload=!0;var a$Q,a$u;a$Q=a$v*a$j,this._resizeBuffer(this._byteLength+a$Q,!0),a$u=new a$k(this._buffer,this._byteLength);var a$S=0;for(a$S=0;a$S<a$v;a$S++)a$u[a$S]=a$t[a$S];this._byteLength+=a$Q,this._checkArrayUse()},a$v.getBuffer=function(){return this._buffer},a$v.setNeedUpload=function(){this._upload=!0},a$v.getNeedUpload=function(){return this._upload},a$v.upload=function(){var a$t=this._bind_upload();return a$nt._gl.bindBuffer(this._bufferType,null),a$nt._bindActive[this._bufferType]=null,a$pt.activeShader=null,a$t},a$v.subUpload=function(a$t,a$k,a$v){void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0);var a$j=this._bind_subUpload();return a$nt._gl.bindBuffer(this._bufferType,null),a$nt._bindActive[this._bufferType]=null,a$pt.activeShader=null,a$j},a$v.disposeResource=function(){a$t.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},a$v.clear=function(){this._byteLength=0,this._upload=!0},a$j(0,a$v,"bufferLength",function(){return this._buffer.byteLength}),a$j(0,a$v,"byteLength",null,function(a$t){this._byteLength!==a$t&&(a$t<=this._buffer.byteLength||this._resizeBuffer(2*a$t+256,!0),this._byteLength=a$t)}),a$k.__int__=function(a$t){a$yt.QuadrangleIB=a$yt.create(35044),a$ht.fillIBQuadrangle(a$yt.QuadrangleIB,16)},a$k.FLOAT32=4,a$k.SHORT=2,a$k}(a$nt),a$gt=(function(a$k){function a$v(a$t){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,a$v.__super.call(this,9)}a$H(a$v,"laya.webgl.shader.d2.value.GlowSV",a$k);var a$t=a$v.prototype;a$t.setValue=function(a$t){a$k.prototype.setValue.call(this,a$t)},a$t.clear=function(){a$k.prototype.clear.call(this)}}(a$it),function(a$t){function a$k(a$t){a$k.__super.call(this,64),this.defines.add(64)}a$H(a$k,"laya.webgl.shader.d2.value.TextSV",a$t);var a$v=a$k.prototype;return a$v.release=function(){(a$k.pool[a$k._length++]=this).clear()},a$v.clear=function(){a$t.prototype.clear.call(this)},a$k.create=function(){return a$k._length?a$k.pool[--a$k._length]:new a$k(null)},a$k.pool=[],a$k._length=0,a$k}(a$it)),a$$t=function(a$t){function a$Q(a$t,a$k,a$v,a$j){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,a$Q.__super.call(this,a$t,a$k,a$v,a$j)}a$H(a$Q,"laya.webgl.shader.d2.Shader2X",a$t);var a$k=a$Q.prototype;return a$k.upload2dQuick1=function(a$t){this.upload(a$t,this._params2dQuick1||this._make2dQuick1())},a$k._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var a$t,a$k=this._params,a$v=0,a$j=a$k.length;a$v<a$j;a$v++)a$t=a$k[a$v],(a$l.isFlash||"size"!==a$t.name&&"position"!==a$t.name&&"texcoord"!==a$t.name)&&this._params2dQuick1.push(a$t)}return this._params2dQuick1},a$k.disposeResource=function(){a$t.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},a$k.upload2dQuick2=function(a$t){this.upload(a$t,this._params2dQuick2||this._make2dQuick2())},a$k._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var a$t,a$k=this._params,a$v=0,a$j=a$k.length;a$v<a$j;a$v++)a$t=a$k[a$v],(a$l.isFlash||"size"!==a$t.name)&&this._params2dQuick2.push(a$t)}return this._params2dQuick2},a$Q.create=function(a$t,a$k,a$v,a$j){return new a$Q(a$t,a$k,a$v,a$j)},a$Q}(a$et),a$yt=function(a$t){function a$k(a$t){this._uint8Array=null,this._uint16Array=null,void 0===a$t&&(a$t=35044),a$k.__super.call(this),this._bufferUsage=a$t,this._bufferType=34963,a$l.isFlash||(this._buffer=new ArrayBuffer(8))}a$H(a$k,"laya.webgl.utils.IndexBuffer2D",a$rt);var a$v=a$k.prototype;return a$v._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},a$v.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},a$v.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},a$v.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},a$k.QuadrangleIB=null,a$k.create=function(a$t){return void 0===a$t&&(a$t=35044),new a$k(a$t)},a$k}(),a$Pt=function(a$t){function a$v(a$t,a$k){this._floatArray32=null,this._vertexStride=0,a$v.__super.call(this),this._vertexStride=a$t,this._bufferUsage=a$k,this._bufferType=34962,a$l.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}a$H(a$v,"laya.webgl.utils.VertexBuffer2D",a$t);var a$k=a$v.prototype;return a$k.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},a$k.bind=function(a$t){a$t&&a$t._bind(),this._bind()},a$k.insertData=function(a$t,a$k){this.getFloat32Array().set(a$t,a$k),this._upload=!0},a$k.bind_upload=function(a$t){a$t._bind_upload()||a$t._bind(),this._bind_upload()||this._bind()},a$k._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},a$k.disposeResource=function(){a$t.prototype.disposeResource.call(this)},a$k.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},a$j(0,a$k,"vertexStride",function(){return this._vertexStride}),a$v.create=function(a$t,a$k){return void 0===a$k&&(a$k=35048),new a$v(a$t,a$k)},a$v}(a$rt),a$tk=function(a$t){function a$V(a$t,a$k,a$v,a$j,a$Q,a$u){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===a$v&&(a$v=6408),void 0===a$j&&(a$j=!0),a$V.__super.call(this,a$t,a$k),a$t){if(this._format=a$v,this._mipmap=a$j,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof a$t)this._url=a$t,this._src=a$t,this._image=new a$E.window.Image,a$k&&(a$k.onload&&(this.onload=a$k.onload),a$k.onerror&&(this.onerror=a$k.onerror),a$k.onCreate&&a$k.onCreate(this)),this._image.crossOrigin=a$t&&0==a$t.indexOf("data:")?null:"",a$t&&(this._image.src=a$t);else if(a$t instanceof ArrayBuffer){this._src=a$k,this._url=this._src;var a$S=new a$J(a$t);a$S.readUTFBytes(4),a$S.readUTFBytes(2),a$S.getInt16();a$S.endian="bigEndian",this._w=a$S.getInt16(),this._h=a$S.getInt16();a$S.getInt16(),a$S.getInt16();this._image=new Uint8Array(a$t,a$S.pos),this._format=a$ft.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,a$I.enabled&&this._w<a$I.atlasLimitWidth&&this._h<a$I.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(a$t instanceof Uint8Array))return this._src=a$k,this._url=this._src,this._image=a$t.source||a$t,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=a$k,this._url=this._src,this._w=a$Q,this._h=a$u,this._image=a$t,this._format=0===a$v?a$t.byteLength/(a$Q*a$u)==4?6408:6407:a$v}this._$5__enableMerageInAtlas=!0}}a$H(a$V,"laya.webgl.resource.WebGLImage",a$R);var a$k=a$V.prototype;return a$F.imps(a$k,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),a$k._init_=function(a$t,a$k){},a$k._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var a$t=a$ft.mainContext,a$k=this._source=a$t.createTexture(),a$v=a$Xt.curBindTexTarget,a$j=a$Xt.curBindTexValue;a$Xt.bindTexture(a$t,3553,a$k);var a$Q=this.minFifter,a$u=this.magFifter,a$S=this.repeat?10497:33071,a$V=a$w.isPOT(this._w,this._h),a$J=!1;switch(a$V?(this.mipmap?-1!==a$Q||(a$Q=9987):-1!==a$Q||(a$Q=9729),-1!==a$u||(a$u=9729),a$t.texParameteri(3553,10241,a$Q),a$t.texParameteri(3553,10240,a$u),a$t.texParameteri(3553,10242,a$S),a$t.texParameteri(3553,10243,a$S),this.mipmap&&a$t.generateMipmap(3553)):(-1!==a$Q||(a$Q=9729),-1!==a$u||(a$u=9729),a$t.texParameteri(3553,10241,a$Q),a$t.texParameteri(3553,10240,a$u),a$t.texParameteri(3553,10242,33071),a$t.texParameteri(3553,10243,33071)),a$t.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&a$t.pixelStorei(a$t.UNPACK_ALIGNMENT,1),a$t.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&a$t.pixelStorei(a$t.UNPACK_ALIGNMENT,1),a$t.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:a$J=!0,a$t.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case a$ft.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:a$J=!0,a$t.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}a$t.pixelStorei(37441,!1),a$v&&a$j&&a$Xt.bindTexture(a$t,a$v,a$j),this.uri||(this.uri=this._url),a$J?this.memorySize=this._image.length:a$V&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},a$k.recreateResource=function(){var a$t=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var a$k=this;this._image=new a$E.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(a$k._needReleaseAgain)return a$k._needReleaseAgain=!1,a$k._image.onload=null,void(a$k._image=null);a$k._allowMerageInAtlas&&a$k._enableMerageInAtlas?(a$t.memorySize=0,a$t._recreateLock=!1):a$k._createWebGlTexture(),a$k.completeCreate()},this._image.src=this._src}},a$k.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&a$ft.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},a$k.onresize=function(){this._w=this._image.width,this._h=this._image.height,a$I.enabled&&this._w<a$I.atlasLimitWidth&&this._h<a$I.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},a$k.clearAtlasSource=function(){this._image=null},a$j(0,a$k,"format",function(){return this._format}),a$j(0,a$k,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(a$t){this._$5__enableMerageInAtlas=a$t}),a$j(0,a$k,"mipmap",function(){return this._mipmap}),a$j(0,a$k,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),a$j(0,a$k,"atlasSource",function(){return this._image}),a$j(0,a$k,"onload",null,function(a$t){var a$k=this;this._onload=a$t,this._image&&(this._image.onload=null!=this._onload?function(){a$k.onresize(),a$k._onload()}:null)}),a$j(0,a$k,"onerror",null,function(a$t){var a$k=this;this._onerror=a$t,this._image&&(this._image.onerror=null!=this._onerror?function(){a$k._onerror()}:null)}),a$V}();a$F.__init([a$Et,a$x,a$dt,a$Yt])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(a$t,a$k){"use strict";for(var a$v in Object.defineProperty(a$k,"__esModule",{value:!0}),Laya){var a$j=Laya[a$v];a$j&&a$j.__isclass&&(a$k[a$v]=a$j)}}),function(a$u,a$t,a$j){a$j.un,a$j.uns;var a$Q=a$j.static,a$S=a$j.class,a$V=a$j.getset,a$J=(a$j.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),a$A=laya.utils.ClassUtils,a$M=(laya.events.Event,laya.utils.HTMLChar),a$W=laya.net.Loader,a$w=(laya.display.Node,laya.maths.Rectangle),a$H=laya.renders.Render,a$E=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),a$R=laya.utils.Stat,a$p=laya.display.Text,a$h=laya.resource.Texture,a$l=laya.net.URL,a$o=laya.utils.Utils,a$Y=function(){function a$E(){}return a$S(a$E,"laya.html.utils.HTMLParse"),a$E.parse=function(a$t,a$k,a$v){a$k=(a$k="<root>"+(a$k=a$k.replace(/<br>/g,"<br/>"))+"</root>").replace(a$E.spacePattern,a$E.char255);var a$j=a$o.parseXMLFromString(a$k);a$E._parseXML(a$t,a$j.childNodes[0].childNodes,a$v)},a$E._parseXML=function(a$t,a$k,a$v,a$j){var a$Q=0,a$u=0;if(a$k.join||a$k.item)for(a$Q=0,a$u=a$k.length;a$Q<a$u;++a$Q)a$E._parseXML(a$t,a$k[a$Q],a$v,a$j);else{var a$S,a$V,a$J;if(3==a$k.nodeType)return void(a$t instanceof laya.html.dom.HTMLDivElement?(null==a$k.nodeName&&(a$k.nodeName="#text"),a$V=a$k.nodeName.toLowerCase(),0<(a$J=a$k.textContent.replace(/^\s+|\s+$/g,"")).length&&(a$S=a$A.getInstance(a$V))&&(a$t.addChild(a$S),a$S.innerTEXT=a$J.replace(a$E.char255AndOneSpacePattern," "))):0<(a$J=a$k.textContent.replace(/^\s+|\s+$/g,"")).length&&(a$t.innerTEXT=a$J.replace(a$E.char255AndOneSpacePattern," ")));if("#comment"==(a$V=a$k.nodeName.toLowerCase()))return;if(a$S=a$A.getInstance(a$V)){(a$S=a$t.addChild(a$S)).URI=a$v,a$S.href=a$j;var a$W=a$k.attributes;if(a$W&&0<a$W.length)for(a$Q=0,a$u=a$W.length;a$Q<a$u;++a$Q){var a$w=a$W[a$Q],a$M=a$w.nodeName,a$H=a$w.value;a$S._setAttributes(a$M,a$H)}a$E._parseXML(a$S,a$k.childNodes,a$v,a$S.href)}else a$E._parseXML(a$t,a$k.childNodes,a$v,a$j)}},a$E.char255=String.fromCharCode(255),a$E.spacePattern=/&nbsp;|&#160;/g,a$E.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),a$E}(),a$f=function(){function a$T(){}return a$S(a$T,"laya.html.utils.Layout"),a$T.later=function(a$t){null==a$T._will&&(a$T._will=[],a$j.stage.frameLoop(1,null,function(){if(!(a$T._will.length<1)){for(var a$t=0;a$t<a$T._will.length;a$t++)laya.html.utils.Layout.layout(a$T._will[a$t]);a$T._will.length=0}})),a$T._will.push(a$t)},a$T.layout=function(a$t){if(!a$t||!a$t._style)return null;if(0==(512&a$t._style._type))return null;a$t.getStyle()._type&=-513;var a$k=a$T._multiLineLayout(a$t);return a$H.isConchApp&&a$t.layaoutCallNative&&a$t.layaoutCallNative(),a$k},a$T._multiLineLayout=function(a$t){if(a$p.RightToLeft)return a$T._multiLineLayout2(a$t);var a$k=new Array;a$t._addChildsToLayout(a$k);var a$v,a$j,a$Q,a$u,a$S,a$V=0,a$J=a$k.length,a$W=a$t._getCSSStyle(),a$w=a$W.letterSpacing,a$M=a$W.leading,a$H=a$W.lineHeight,a$E=a$W._widthAuto()||!a$W.wordWrap,a$A=a$E?999999:a$t.width,a$R=(a$t.height,0),a$h=a$W.italic?a$W.fontSize/3:0,a$l=a$W._getAlign(),a$o=a$W._getValign(),a$Y=0!==a$o||0!==a$l||0!=a$H,a$f=0,a$X=0,a$F=0,a$d=0,a$m=new Array,a$Z=a$m[0]=new a$O,a$s=!1,a$K=!1;a$Z.h=0,a$W.italic&&(a$A-=a$W.fontSize/3);var a$U=0,a$N=!0;function a$a(){a$Z.y=a$X,a$X+=a$Z.h+a$M,0==a$Z.h&&(a$X+=a$H),a$Z.mWidth=a$U,a$U=0,a$Z=new a$O,a$m.push(a$Z),a$Z.h=0,a$s=!(a$N=!(a$f=0))}for(a$V=0;a$V<a$J;a$V++)if(null!=(a$v=a$k[a$V]))if(a$N=!1,a$v instanceof laya.html.dom.HTMLBrElement)a$a(),a$Z.y=a$X;else{if(a$v._isChar()){if((a$u=a$v).isWord)a$s=a$K||"\n"===a$u.char,a$Z.wordStartIndex=a$Z.elements.length;else{if(a$F=a$u.width+a$u.style.letterSpacin,0<a$m.length&&a$A<a$f+a$F&&0<a$Z.wordStartIndex){var a$z;a$z=a$Z.elements.length-a$Z.wordStartIndex+1,a$Z.elements.length=a$Z.wordStartIndex,a$V-=a$z,a$a();continue}a$s=!1,a$U+=a$u.width}a$F=a$u.width+a$w,a$d=a$u.height,a$K=!1,(a$s=a$s||a$A<a$f+a$F)&&a$a(),a$Z.minTextHeight=Math.min(a$Z.minTextHeight,a$v.height)}else a$j=a$v._getCSSStyle(),a$S=a$v,a$Q=a$j.padding,0===a$j._getCssFloat()||(a$Y=!0),a$s=a$K||a$j.lineElement,a$F=a$S.width*a$S._style._tf.scaleX+a$Q[1]+a$Q[3]+a$w,a$d=a$S.height*a$S._style._tf.scaleY+a$Q[0]+a$Q[2],a$K=a$j.lineElement,(a$s=a$s||a$A<a$f+a$F&&a$j.wordWrap)&&a$a();a$Z.elements.push(a$v),a$Z.h=Math.max(a$Z.h,a$d),a$v.x=a$f,a$v.y=a$X,a$f+=a$F,a$Z.w=a$f-a$w,a$Z.y=a$X,a$R=Math.max(a$f+a$h,a$R)}else a$N||(a$f+=a$T.DIV_ELEMENT_PADDING),a$Z.wordStartIndex=a$Z.elements.length;if(a$X=a$Z.y+a$Z.h,a$Y){var a$G=0,a$c=a$A;for(a$E&&0<a$t.width&&(a$c=a$t.width),a$V=0,a$J=a$m.length;a$V<a$J;a$V++)a$m[a$V].updatePos(0,a$c,a$V,a$G,a$l,a$o,a$H),a$G+=Math.max(a$H,a$m[a$V].h+a$M);a$X=a$G}return a$E&&(a$t.width=a$R),a$X>a$t.height&&(a$t.height=a$X),[a$R,a$X]},a$T._multiLineLayout2=function(a$t){var a$k=new Array;a$t._addChildsToLayout(a$k);var a$v,a$j,a$Q,a$u,a$S,a$V=0,a$J=a$k.length,a$W=a$t._getCSSStyle(),a$w=a$W.letterSpacing,a$M=a$W.leading,a$H=a$W.lineHeight,a$E=a$W._widthAuto()||!a$W.wordWrap,a$A=a$E?999999:a$t.width,a$R=(a$t.height,0),a$h=a$W.italic?a$W.fontSize/3:0,a$l=2-a$W._getAlign(),a$o=a$W._getValign(),a$Y=0!==a$o||0!=a$l||0!=a$H,a$f=0,a$X=0,a$F=0,a$d=0,a$m=new Array,a$Z=a$m[0]=new a$O,a$s=!1,a$K=!1;a$Z.h=0,a$W.italic&&(a$A-=a$W.fontSize/3);var a$U=0,a$N=!0;function a$a(){a$Z.y=a$X,a$X+=a$Z.h+a$M,0==a$Z.h&&(a$X+=a$H),a$Z.mWidth=a$U,a$U=0,a$Z=new a$O,a$m.push(a$Z),a$Z.h=0,a$s=!(a$N=!(a$f=0))}for(a$V=0;a$V<a$J;a$V++)if(null!=(a$v=a$k[a$V]))if(a$N=!1,a$v instanceof laya.html.dom.HTMLBrElement)a$a(),a$Z.y=a$X;else{if(a$v._isChar()){if((a$u=a$v).isWord)a$s=a$K||"\n"===a$u.char,a$Z.wordStartIndex=a$Z.elements.length;else{if(0<a$m.length&&a$A<a$f+a$F&&0<a$Z.wordStartIndex){var a$z;a$z=a$Z.elements.length-a$Z.wordStartIndex+1,a$Z.elements.length=a$Z.wordStartIndex,a$V-=a$z,a$a();continue}a$s=!1,a$U+=a$u.width}a$F=a$u.width+a$w,a$d=a$u.height,a$K=!1,(a$s=a$s||a$A<a$f+a$F)&&a$a(),a$Z.minTextHeight=Math.min(a$Z.minTextHeight,a$v.height)}else a$j=a$v._getCSSStyle(),a$S=a$v,a$Q=a$j.padding,0===a$j._getCssFloat()||(a$Y=!0),a$s=a$K||a$j.lineElement,a$F=a$S.width*a$S._style._tf.scaleX+a$Q[1]+a$Q[3]+a$w,a$d=a$S.height*a$S._style._tf.scaleY+a$Q[0]+a$Q[2],a$K=a$j.lineElement,(a$s=a$s||a$A<a$f+a$F&&a$j.wordWrap)&&a$a();a$Z.elements.push(a$v),a$Z.h=Math.max(a$Z.h,a$d),a$v.x=a$f,a$v.y=a$X,a$f+=a$F,a$Z.w=a$f-a$w,a$Z.y=a$X,a$R=Math.max(a$f+a$h,a$R)}else a$N||(a$f+=a$T.DIV_ELEMENT_PADDING),a$Z.wordStartIndex=a$Z.elements.length;if(a$X=a$Z.y+a$Z.h,a$Y){var a$G=0,a$c=a$A;for(a$V=0,a$J=a$m.length;a$V<a$J;a$V++)a$m[a$V].updatePos(0,a$c,a$V,a$G,a$l,a$o,a$H),a$G+=Math.max(a$H,a$m[a$V].h+a$M);a$X=a$G}for(a$E&&(a$t.width=a$R),a$X>a$t.height&&(a$t.height=a$X),a$V=0,a$J=a$m.length;a$V<a$J;a$V++)a$m[a$V].revertOrder(a$A);return[a$R,a$X]},a$T._will=null,a$T.DIV_ELEMENT_PADDING=0,a$T}(),a$O=function(){function a$t(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}a$S(a$t,"laya.html.utils.LayoutLine");var a$k=a$t.prototype;return a$k.updatePos=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){var a$V,a$J=0;0<this.elements.length&&(a$J=(a$V=this.elements[this.elements.length-1]).x+a$V.width-this.elements[0].x);var a$W=0,a$w=NaN;1===a$Q&&(a$W=(a$k-a$J)/2),2===a$Q&&(a$W=a$k-a$J),0===a$S||0!=a$u||(a$u=1);for(var a$M=0,a$H=this.elements.length;a$M<a$H;a$M++){var a$E=(a$V=this.elements[a$M])._getCSSStyle();switch(0!==a$W&&(a$V.x+=a$W),a$E._getValign()){case 0:a$V.y=a$j;break;case 1:var a$A=0;99999!=this.minTextHeight&&(a$A=this.minTextHeight);var a$R=(a$A+a$S)/2;a$R=Math.max(a$R,this.h),a$w=(laya.html.dom.HTMLImageElement,a$j+a$R-a$V.height),a$V.y=a$w;break;case 2:a$V.y=a$j+(a$S-a$V.height)}}},a$k.revertOrder=function(a$t){var a$k;if(0<this.elements.length){var a$v,a$j=0;for(a$v=this.elements.length,a$j=0;a$j<a$v;a$j++)(a$k=this.elements[a$j]).x=a$t-a$k.x-a$k.width}},a$t}(),a$X=function(a$v){function a$k(){this.URI=null,this._href=null,a$k.__super.call(this),this._text=a$k._EMPTYTEXT,this.setStyle(new a$J(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}a$S(a$k,"laya.html.dom.HTMLElement",a$v);var a$t=a$k.prototype;return a$t.layaoutCallNative=function(){var a$t=0;if(this._childs&&0<(a$t=this._childs.length))for(var a$k=0;a$k<a$t;a$k++)this._childs[a$k].layaoutCallNative&&this._childs[a$k].layaoutCallNative();var a$v=this._getWords();a$v?laya.html.dom.HTMLElement.fillWords(this,a$v,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},a$t.appendChild=function(a$t){return this.addChild(a$t)},a$t._getWords2=function(){var a$t=this._text.text;if(!a$t||0===a$t.length)return null;var a$k,a$v,a$j=0,a$Q=0;if(this._text.drawWords)a$v=this._text.drawWords;else{for(a$Q=(a$k=a$t.split(" ")).length-1,a$v=[],a$j=0;a$j<a$Q;a$j++)a$v.push(a$k[a$j]," ");0<=a$Q&&a$v.push(a$k[a$Q]),this._text.drawWords=a$v}var a$u,a$S=this._text.words;if(a$S&&a$S.length===a$v.length)return a$S;null===a$S&&(this._text.words=a$S=[]),a$S.length=a$v.length;var a$V=this.style,a$J=a$V.font;for(a$j=0,a$Q=a$v.length;a$j<a$Q;a$j++){a$u=a$o.measureText(a$v[a$j],a$J);var a$W=a$S[a$j]=new a$M(a$v[a$j],a$u.width,a$u.height||a$V.fontSize,a$V);if(1<a$W.char.length&&(a$W.charNum=a$W.char),this.href){var a$w=new a$E;this.addChild(a$w),a$W.setSprite(a$w)}}return a$S},a$t._getWords=function(){if(!a$p.CharacterCache)return this._getWords2();var a$t=this._text.text;if(!a$t||0===a$t.length)return null;var a$k,a$v=this._text.words;if(a$v&&a$v.length===a$t.length)return a$v;null===a$v&&(this._text.words=a$v=[]),a$v.length=a$t.length;for(var a$j=this.style,a$Q=a$j.font,a$u=0,a$S=a$t.length;a$u<a$S;a$u++)if(a$k=a$o.measureText(a$t.charAt(a$u),a$Q)){var a$V=a$v[a$u]=new a$M(a$t.charAt(a$u),a$k.width,a$k.height||a$j.fontSize,a$j);if(this.href){var a$J=new a$E;this.addChild(a$J),a$V.setSprite(a$J)}}else console.warn("_getWords size is null"+a$t.charAt(a$u),a$Q);return a$v},a$t.showLinkSprite=function(){var a$t=this._text.words;if(a$t)for(var a$k,a$v,a$j=[],a$Q=0;a$Q<a$t.length;a$Q++)a$v=a$t[a$Q],(a$k=new a$E).graphics.drawRect(0,0,a$v.width,a$v.height,"#ff0000"),a$k.width=a$v.width,a$k.height=a$v.height,this.addChild(a$k),a$j.push(a$k)},a$t._layoutLater=function(){var a$t=this.style;512&a$t._type||(a$t.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&a$t.block?(a$f.later(this),a$t._type|=512):this.parent&&this.parent._layoutLater())},a$t._setAttributes=function(a$t,a$k){switch(a$t){case"style":return void this.style.cssText(a$k);case"class":return void(this.className=a$k)}a$v.prototype._setAttributes.call(this,a$t,a$k)},a$t.updateHref=function(){if(null!=this._href){var a$t=this._getWords();if(a$t)for(var a$k,a$v,a$j=0;a$j<a$t.length;a$j++)(a$v=(a$k=a$t[a$j]).getSprite())&&(a$v.size(a$k.width,a$k.height),a$v.on("click",this,this.onLinkHandler))}},a$t.onLinkHandler=function(a$t){switch(a$t.type){case"click":for(var a$k=this;a$k;)a$k.event("link",[this.href]),a$k=a$k.parent}},a$t.formatURL=function(a$t){return this.URI?a$l.formatURL(a$t,this.URI?this.URI.path:null):a$t},a$V(0,a$t,"href",function(){return this._href},function(a$t){null!=(this._href=a$t)&&(this._getCSSStyle().underLine=1,this.updateHref())}),a$V(0,a$t,"color",null,function(a$t){this.style.color=a$t}),a$V(0,a$t,"onClick",null,function(a$t){a$j._runScript("fn=function(event){"+a$t+";}"),this.on("click",this,void 0)}),a$V(0,a$t,"id",null,function(a$t){a$F.document.setElementById(a$t,this)}),a$V(0,a$t,"innerTEXT",function(){return this._text.text},function(a$t){this.text=a$t}),a$V(0,a$t,"style",function(){return this._style}),a$V(0,a$t,"text",function(){return this._text.text},function(a$t){this._text==a$k._EMPTYTEXT?this._text={text:a$t,words:null}:(this._text.text=a$t,this._text.words&&(this._text.words.length=0)),a$H.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),a$V(0,a$t,"parent",a$v.prototype._$get_parent,function(a$t){if(a$t instanceof laya.html.dom.HTMLElement){var a$k=a$t;this.URI||(this.URI=a$k.URI),this.style.inherit(a$k.style)}a$j.superSet(a$E,this,"parent",a$t)}),a$V(0,a$t,"className",null,function(a$t){this.style.attrs(a$F.document.styleSheets["."+a$t])}),a$k.fillWords=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){a$t.graphics.clear();for(var a$V=0,a$J=a$k.length;a$V<a$J;a$V++){var a$W=a$k[a$V];a$t.graphics.fillText(a$W.char,a$W.x+a$v,a$W.y+a$j,a$Q,a$u,"left",a$S)}},a$k._EMPTYTEXT={text:null,words:null},a$k}(a$E),a$k=(function(a$t){function a$k(){a$k.__super.call(this),this.style.lineElement=!0,this.style.block=!0}a$S(a$k,"laya.html.dom.HTMLBrElement",a$X)}(),function(a$t){function a$k(){this.contextHeight=NaN,this.contextWidth=NaN,a$k.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}a$S(a$k,"laya.html.dom.HTMLDivElement",a$t);var a$v=a$k.prototype;return a$v.appendHTML=function(a$t){a$Y.parse(this,a$t,this.URI),this.layout()},a$v._addChildsToLayout=function(a$k){var a$t=this._getWords();if(null==a$t&&0==this._childs.length)return!1;a$t&&a$t.forEach(function(a$t){a$k.push(a$t)});for(var a$v=!0,a$j=0,a$Q=this._childs.length;a$j<a$Q;a$j++){var a$u=this._childs[a$j];a$v?a$v=!1:a$k.push(null),a$u._addToLayout(a$k)}return!0},a$v._addToLayout=function(a$t){this.layout()},a$v.layout=function(){if(this.style){this.style._type|=512;var a$t=a$f.layout(this);if(a$t){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new a$w);var a$k=this._$P.mHtmlBounds;a$k.x=a$k.y=0,a$k.width=this.contextWidth=a$t[0],a$k.height=this.contextHeight=a$t[1],this.setBounds(a$k)}}},a$V(0,a$v,"height",function(){return this._height?this._height:this.contextHeight},a$t.prototype._$set_height),a$V(0,a$v,"innerHTML",null,function(a$t){this.destroyChildren(),this.appendHTML(a$t)}),a$V(0,a$v,"width",function(){return this._width?this._width:this.contextWidth},function(a$t){var a$k=!1;a$k=0===a$t?a$t!=this._width:a$t!=this.width,a$j.superSet(a$X,this,"width",a$t),a$k&&this.layout()}),a$k}(a$X)),a$F=function(a$t){function a$k(){this.all=new Array,this.styleSheets=a$J.styleSheets,a$k.__super.call(this)}a$S(a$k,"laya.html.dom.HTMLDocument",a$X);var a$v=a$k.prototype;return a$v.getElementById=function(a$t){return this.all[a$t]},a$v.setElementById=function(a$t,a$k){this.all[a$t]=a$k},a$Q(a$k,["document",function(){return this.document=new a$k}]),a$k}();(function(a$t){function a$k(){this._tex=null,this._url=null,this._renderArgs=[],a$k.__super.call(this),this.style.block=!0}a$S(a$k,"laya.html.dom.HTMLImageElement",a$X);var a$v=a$k.prototype;a$v._addToLayout=function(a$t){!this._style.absolute&&a$t.push(this)},a$v.render=function(a$t,a$k,a$v){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(a$R.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,a$t.ctx.drawTexture2(a$k,a$v,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},a$v.layaoutCallNative=function(){var a$t=0;if(this._childs&&0<(a$t=this._childs.length))for(var a$k=0;a$k<a$t;a$k++)this._childs[a$k].layaoutCallNative&&this._childs[a$k].layaoutCallNative()},a$V(0,a$v,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(a$t){this._width!==a$t&&(this._width=a$t,this._style.width=a$t,this.repaint())}),a$V(0,a$v,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(a$t){this._height!==a$t&&(this._height=a$t,this._style.height=a$t,this.repaint())}),a$v.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),a$W.clearCache(this,this._url),this._tex=null),a$X.prototype.destroy.call(this)},a$v.onloaded=function(){var a$t=this._style;a$t&&!a$t.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),a$t&&!a$t.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),a$H.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},a$v._loadImageComplete=function(a$t,a$k,a$v){if(!this._destroyed)if(null!=a$v)if(a$v instanceof ArrayBuffer){var a$j=new DataView(a$v);new laya.webgl.resource.WebGLImage(new Uint8Array(a$v,8),a$t,0,!1,a$j.getUint32(0),a$j.getUint32(4));this.onloaded()}else if(a$v instanceof a$h)a$W.imgMgrSet[a$t]=a$k,a$u.imgMgrLock(a$t,a$W.imgMgrSet[a$t]),this._url=a$t,this._tex=a$v,a$W.keepCache(this,a$t),a$W.cacheRes(a$t,this._tex),this.onloaded();else{var a$Q=-1!=a$t.indexOf(".png",a$t.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(a$v,a$t,a$Q,!1,a$v.width,a$v.height);this.onloaded()}else this.event("error","Load image failed")},a$V(0,a$v,"src",null,function(a$t){(a$t=this.formatURL(a$t),this._url!=a$t)&&(null!=this._tex&&(a$W.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=a$t,(this._tex=a$W.getRes(a$t))?(a$W.keepCache(this,a$t),this.onloaded()):a$u.imgMgrLoad(a$t,this._loadImageComplete.bind(this),2,!1))})})(),function(a$t){function a$k(){this.type=null,a$k.__super.call(this),this.visible=!1}a$S(a$k,"laya.html.dom.HTMLLinkElement",a$t);var a$v=a$k.prototype;a$v._onload=function(a$t){switch(this.type){case"text/css":a$J.parseCSS(a$t,this.URI)}},a$V(0,a$v,"href",a$t.prototype._$get_href,function(a$t){var a$k=this;a$t=this.formatURL(a$t),this.URI=new a$l(a$t);var a$v=new a$W;a$v.once("complete",null,function(a$t){a$k._onload(a$t)}),a$v.load(a$t,"text")}),a$k._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(a$X),function(a$t){function a$k(){a$k.__super.call(this),this.visible=!1}a$S(a$k,"laya.html.dom.HTMLStyleElement",a$t),a$V(0,a$k.prototype,"text",a$t.prototype._$get_text,function(a$t){a$J.parseCSS(a$t,null)})}(a$X),function(a$t){function a$k(){a$k.__super.call(this),this._getCSSStyle().valign="middle"}a$S(a$k,"laya.html.dom.HTMLIframeElement",a$t),a$V(0,a$k.prototype,"href",a$t.prototype._$get_href,function(a$v){var a$j=this;a$v=this.formatURL(a$v);var a$t=new a$W;a$t.once("complete",null,function(a$t){var a$k=a$j.URI;a$j.URI=new a$l(a$v),a$j.innerHTML=a$t,!a$k||(a$j.URI=a$k)}),a$t.load(a$v,"text")})}(a$k)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(a$t,a$k){"use strict";for(var a$v in Object.defineProperty(a$k,"__esModule",{value:!0}),Laya){var a$j=Laya[a$v];a$j&&a$j.__isclass&&(a$k[a$v]=a$j)}}),function(a$t,a$k,a$R){a$R.un,a$R.uns;var a$j=a$R.static,a$u=a$R.class,a$Q=a$R.getset,a$v=(a$R.__newvec,laya.display.Animation),a$h=(laya.utils.Browser,laya.utils.ClassUtils),a$S=laya.filters.ColorFilter,a$V=laya.utils.Ease,a$J=laya.events.Event,a$W=(laya.events.EventDispatcher,laya.display.css.Font),a$w=laya.display.FrameAnimation,a$M=laya.display.Graphics,a$H=laya.utils.Handler,a$E=laya.display.Input,a$o=laya.net.Loader,a$A=(laya.display.Node,laya.maths.Point),a$l=laya.maths.Rectangle,a$Y=laya.renders.Render,a$f=laya.display.Sprite,a$X=laya.display.Text,a$F=laya.resource.Texture,a$d=laya.utils.Tween,a$m=laya.utils.Utils,a$Z=laya.utils.WeakObject;a$R.interface("laya.ui.IItem"),a$R.interface("laya.ui.ISelect"),a$R.interface("laya.ui.IRender"),a$R.interface("laya.ui.IComponent"),a$R.interface("laya.ui.IBox","IComponent");var a$s=function(){function a$t(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return a$u(a$t,"laya.ui.LayoutStyle"),a$j(a$t,["EMPTY",function(){return this.EMPTY=new a$t}]),a$t}(),a$K=function(){function a$t(){}return a$u(a$t,"laya.ui.Styles"),a$t.labelColor="#000000",a$t.buttonStateNum=3,a$t.scrollBarMinNum=15,a$t.scrollBarDelayTime=500,a$j(a$t,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),a$t}(),a$U=function(){function a$Q(){}return a$u(a$Q,"laya.ui.UIUtils"),a$Q.fillArray=function(a$t,a$k,a$v){var a$j=a$t.concat();if(a$k)for(var a$Q=a$k.split(","),a$u=0,a$S=Math.min(a$j.length,a$Q.length);a$u<a$S;a$u++){var a$V=a$Q[a$u];a$j[a$u]="true"==a$V||"false"!=a$V&&a$V,null!=a$v&&(a$j[a$u]=a$v(a$V))}return a$j},a$Q.toColor=function(a$t){return a$m.toHexColor(a$t)},a$Q.gray=function(a$t,a$k){void 0===a$k&&(a$k=!0),a$k?a$Q.addFilter(a$t,a$Q.grayFilter):a$Q.clearFilter(a$t,a$S)},a$Q.addFilter=function(a$t,a$k){var a$v=a$t.filters||[];a$v.push(a$k),a$t.filters=a$v},a$Q.clearFilter=function(a$t,a$k){var a$v=a$t.filters;if(null!=a$v&&0<a$v.length){for(var a$j=a$v.length-1;-1<a$j;a$j--){var a$Q=a$v[a$j];a$R.__typeof(a$Q,a$k)&&a$v.splice(a$j,1)}a$t.filters=a$v}},a$Q._getReplaceStr=function(a$t){return a$Q.escapeSequence[a$t]},a$Q.adptString=function(a$t){return a$t.replace(/\\(\w)/g,a$Q._getReplaceStr)},a$Q.getBindFun=function(a$t){var a$k=a$Q._funMap.get(a$t);if(null==a$k){var a$v='"'+a$t+'"',a$j="(function(data){if(data==null)return;with(data){try{\nreturn "+(a$v=a$v.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";a$k=a$R._runScript(a$j),a$Q._funMap.set(a$t,a$k)}return a$k},a$j(a$Q,["grayFilter",function(){return this.grayFilter=new a$S([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new a$Z}]),a$Q}(),a$N=function(){function a$t(){}return a$u(a$t,"UIConfig"),a$t.touchScrollEnable=!0,a$t.mouseWheelEnable=!0,a$t.showButtons=!0,a$t.popupBgColor="#000000",a$t.popupBgAlpha=.5,a$t.closeDialogOnSide=!0,a$t}(),a$a=function(a$v){function a$l(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,a$l.__super.call(this),this._weakKeys=[]}a$u(a$l,"laya.ui.AutoBitmap",a$v);var a$t=a$l.prototype;return a$t.destroy=function(){if(a$o.clearObject(this,this._weakKey),this._weakKeys){for(var a$t=0,a$k=this._weakKeys.length;a$t<a$k;++a$t)a$o.clearObject(this,this._weakKeys[a$t]);this._weakKeys=null}a$v.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},a$t._setChanged=function(){this._isChanged||(this._isChanged=!0,a$R.timer.callLater(this,this.changeSource))},a$t.changeSource=function(){this._isChanged=!1;var a$t=this._source;if(a$t&&a$t.bitmap){var a$k=this.width,a$v=this.height,a$j=this._sizeGrid,a$Q=a$t.sourceWidth,a$u=a$t.sourceHeight;if(!a$j||a$Q===a$k&&a$u===a$v)this.cleanByTexture(a$t,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,a$k,a$v);else{a$o.clearObject(this,this._weakKey),a$t.$_GID||(a$t.$_GID=a$m.getGID());var a$S=a$t.$_GID+"."+a$k+"."+a$v+"."+a$j.join("."),a$V=a$o.findObject(a$S);if(a$m.isOKCmdList(a$V))return this._weakKey=a$S,a$o.keepObject(this,this._weakKey),void(this.cmds=a$V);this.clear();var a$J,a$W,a$w=a$j[0],a$M=a$j[1],a$H=a$j[2],a$E=a$j[3],a$A=a$j[4],a$R=!1;if(a$k==a$Q&&(a$E=a$M=0),a$v==a$u&&(a$w=a$H=0),a$k<a$E+a$M){var a$h=a$k;a$R=!0,a$k=a$E+a$M,this.save(),this.clipRect(0,0,a$h,a$v)}a$E&&a$w&&(a$J=a$l.getTexture(a$t,0,0,a$E,a$w),a$W=this._weakKeys[0],a$J?(a$W!=a$J.weakKey&&(a$o.clearObject(this,a$W),a$o.keepObject(this,a$J.weakKey),this._weakKeys[0]=a$J.weakKey),this.drawTexture(a$J,0,0,a$E,a$w)):(a$o.clearObject(this,a$W),this._weakKeys[0]="")),a$M&&a$w&&(a$J=a$l.getTexture(a$t,a$Q-a$M,0,a$M,a$w),a$W=this._weakKeys[1],a$J?(a$W!=a$J.weakKey&&(a$o.clearObject(this,a$W),a$o.keepObject(this,a$J.weakKey),this._weakKeys[1]=a$J.weakKey),this.drawTexture(a$J,a$k-a$M,0,a$M,a$w)):(a$o.clearObject(this,a$W),this._weakKeys[1]="")),a$E&&a$H&&(a$J=a$l.getTexture(a$t,0,a$u-a$H,a$E,a$H),a$W=this._weakKeys[2],a$J?(a$W!=a$J.weakKey&&(a$o.clearObject(this,a$W),a$o.keepObject(this,a$J.weakKey),this._weakKeys[2]=a$J.weakKey),this.drawTexture(a$J,0,a$v-a$H,a$E,a$H)):(a$o.clearObject(this,a$W),this._weakKeys[2]="")),a$M&&a$H&&(a$J=a$l.getTexture(a$t,a$Q-a$M,a$u-a$H,a$M,a$H),a$W=this._weakKeys[3],a$J?(a$W!=a$J.weakKey&&(a$o.clearObject(this,a$W),a$o.keepObject(this,a$J.weakKey),this._weakKeys[3]=a$J.weakKey),this.drawTexture(a$J,a$k-a$M,a$v-a$H,a$M,a$H)):(a$o.clearObject(this,a$W),this._weakKeys[3]="")),a$w&&(a$J=a$l.getTexture(a$t,a$E,0,a$Q-a$E-a$M,a$w),a$W=this._weakKeys[4],a$J?(a$W!=a$J.weakKey&&(a$o.clearObject(this,a$W),a$o.keepObject(this,a$J.weakKey),this._weakKeys[4]=a$J.weakKey),this.drawBitmap(a$A,a$J,a$E,0,a$k-a$E-a$M,a$w)):(a$o.clearObject(this,a$W),this._weakKeys[4]="")),a$H&&(a$J=a$l.getTexture(a$t,a$E,a$u-a$H,a$Q-a$E-a$M,a$H),a$W=this._weakKeys[5],a$J?(a$W!=a$J.weakKey&&(a$o.clearObject(this,a$W),a$o.keepObject(this,a$J.weakKey),this._weakKeys[5]=a$J.weakKey),this.drawBitmap(a$A,a$J,a$E,a$v-a$H,a$k-a$E-a$M,a$H)):(a$o.clearObject(this,a$W),this._weakKeys[5]="")),a$E&&(a$J=a$l.getTexture(a$t,0,a$w,a$E,a$u-a$w-a$H),a$W=this._weakKeys[6],a$J?(a$W!=a$J.weakKey&&(a$o.clearObject(this,a$W),a$o.keepObject(this,a$J.weakKey),this._weakKeys[6]=a$J.weakKey),this.drawBitmap(a$A,a$J,0,a$w,a$E,a$v-a$w-a$H)):(a$o.clearObject(this,a$W),this._weakKeys[6]="")),a$M&&(a$J=a$l.getTexture(a$t,a$Q-a$M,a$w,a$M,a$u-a$w-a$H),a$W=this._weakKeys[7],a$J?(a$W!=a$J.weakKey&&(a$o.clearObject(this,a$W),a$o.keepObject(this,a$J.weakKey),this._weakKeys[7]=a$J.weakKey),this.drawBitmap(a$A,a$J,a$k-a$M,a$w,a$M,a$v-a$w-a$H)):(a$o.clearObject(this,a$W),this._weakKeys[7]="")),a$J=a$l.getTexture(a$t,a$E,a$w,a$Q-a$E-a$M,a$u-a$w-a$H),a$W=this._weakKeys[8],a$J?(a$W!=a$J.weakKey&&(a$o.clearObject(this,a$W),a$o.keepObject(this,a$J.weakKey),this._weakKeys[8]=a$J.weakKey),this.drawBitmap(a$A,a$J,a$E,a$w,a$k-a$E-a$M,a$v-a$w-a$H)):(a$o.clearObject(this,a$W),this._weakKeys[8]=""),a$R&&this.restore(),this.autoCacheCmd&&!a$Y.isConchApp&&(a$o.saveObject(a$S,this.cmds,null),this._weakKey=a$S,a$o.keepObject(this,this._weakKey))}this._repaint()}},a$t.drawBitmap=function(a$t,a$k,a$v,a$j,a$Q,a$u){void 0===a$Q&&(a$Q=0),void 0===a$u&&(a$u=0),a$Q<.1||a$u<.1||(!a$t||a$k.width==a$Q&&a$k.height==a$u?this.drawTexture(a$k,a$v,a$j,a$Q,a$u):this.fillTexture(a$k,a$v,a$j,a$Q,a$u))},a$t.clear=function(a$t){void 0===a$t&&(a$t=!0),a$v.prototype.clear.call(this,!1)},a$Q(0,a$t,"sizeGrid",function(){return this._sizeGrid},function(a$t){this._sizeGrid=a$t,this._setChanged()}),a$Q(0,a$t,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(a$t){this._width!=a$t&&(this._width=a$t,this._setChanged())}),a$Q(0,a$t,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(a$t){this._height!=a$t&&(this._height=a$t,this._setChanged())}),a$Q(0,a$t,"source",function(){return this._source},function(a$t){a$t?(this._source=a$t,this._setChanged()):(this._source=null,this.clear())}),a$l.getTexture=function(a$t,a$k,a$v,a$j,a$Q){a$j<=0&&(a$j=1),a$Q<=0&&(a$Q=1),a$t.$_GID||(a$t.$_GID=a$m.getGID());var a$u=a$t.$_GID+"."+a$k+"."+a$v+"."+a$j+"."+a$Q,a$S=a$o.findObject(a$u);if((!a$S||!a$S.source)&&(a$S=a$F.createFromTexture(a$t,a$k,a$v,a$j,a$Q))){if(a$t.alphaTexture){var a$V=a$t.width/a$t.alphaTexture.width;a$S.alphaTexture=a$F.createFromTexture(a$t.alphaTexture,a$k/a$V,a$v/a$V,a$j/a$V,a$Q/a$V)}a$o.saveObject(a$u,a$S),a$S.weakKey=a$u}return a$S},a$l}(a$M),a$z=(function(a$t){function a$k(){a$k.__super.call(this)}a$u(a$k,"laya.ui.UIEvent",a$J),a$k.SHOW_TIP="showtip",a$k.HIDE_TIP="hidetip"}(),function(a$k){function a$t(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,a$t.__super.call(this),this._layout=a$s.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}a$u(a$t,"laya.ui.Component",a$k);var a$v=a$t.prototype;return a$R.imps(a$v,{"laya.ui.IComponent":!0}),a$v.destroy=function(a$t){void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,a$t),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},a$v.preinitialize=function(){},a$v.createChildren=function(){},a$v.initialize=function(){},a$v.callLater=function(a$t,a$k){a$R.timer.callLater(this,a$t,a$k)},a$v.runCallLater=function(a$t){a$R.timer.runCallLater(this,a$t)},a$v.commitMeasure=function(){},a$v.changeSize=function(){this.event("resize")},a$v.getLayout=function(){return this._layout===a$s.EMPTY&&(this._layout=new a$s),this._layout},a$v._setLayoutEnabled=function(a$t){this._layout&&this._layout.enable!=a$t&&(this._layout.enable=a$t,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},a$v.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},a$v.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},a$v.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},a$v.resetLayoutX=function(){var a$t=this._layout;if(isNaN(a$t.anchorX)||(this.pivotX=a$t.anchorX*this.width),this.layoutEnabled){var a$k=this.parent;a$k&&(isNaN(a$t.centerX)?isNaN(a$t.left)?isNaN(a$t.right)||(this.x=Math.round(a$k.width-this.displayWidth-a$t.right+this.pivotX*this.scaleX)):(this.x=Math.round(a$t.left+this.pivotX*this.scaleX),isNaN(a$t.right)||(this.width=(a$k._width-a$t.left-a$t.right)/(this.scaleX||.01))):this.x=Math.round(.5*(a$k.width-this.displayWidth)+a$t.centerX+this.pivotX*this.scaleX))}},a$v.resetLayoutY=function(){var a$t=this._layout;if(isNaN(a$t.anchorY)||(this.pivotY=a$t.anchorY*this.height),this.layoutEnabled){var a$k=this.parent;a$k&&(isNaN(a$t.centerY)?isNaN(a$t.top)?isNaN(a$t.bottom)||(this.y=Math.round(a$k.height-this.displayHeight-a$t.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(a$t.top+this.pivotY*this.scaleY),isNaN(a$t.bottom)||(this.height=(a$k._height-a$t.top-a$t.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(a$k.height-this.displayHeight)+a$t.centerY+this.pivotY*this.scaleY))}},a$v.onMouseOver=function(a$t){a$R.stage.event("showtip",this._toolTip)},a$v.onMouseOut=function(a$t){a$R.stage.event("hidetip",this._toolTip)},a$Q(0,a$v,"displayWidth",function(){return this.width*this.scaleX}),a$Q(0,a$v,"width",function(){return this._width?this._width:this.measureWidth},function(a$t){this._width!=a$t&&(this._width=a$t,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),a$Q(0,a$v,"measureWidth",function(){var a$t=0;this.commitMeasure();for(var a$k=this.numChildren-1;-1<a$k;a$k--){var a$v=this.getChildAt(a$k);a$v.visible&&(a$t=Math.max(a$v.x+a$v.width*a$v.scaleX,a$t))}return a$t}),a$Q(0,a$v,"displayHeight",function(){return this.height*this.scaleY}),a$Q(0,a$v,"height",function(){return this._height?this._height:this.measureHeight},function(a$t){this._height!=a$t&&(this._height=a$t,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),a$Q(0,a$v,"dataSource",function(){return this._dataSource},function(a$t){for(var a$k in this._dataSource=a$t,this._dataSource)this.hasOwnProperty(a$k)&&"function"!=typeof this[a$k]&&(this[a$k]=this._dataSource[a$k])}),a$Q(0,a$v,"scaleY",a$k.prototype._$get_scaleY,function(a$t){a$R.superGet(a$f,this,"scaleY")!=a$t&&(a$R.superSet(a$f,this,"scaleY",a$t),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),a$Q(0,a$v,"measureHeight",function(){var a$t=0;this.commitMeasure();for(var a$k=this.numChildren-1;-1<a$k;a$k--){var a$v=this.getChildAt(a$k);a$v.visible&&(a$t=Math.max(a$v.y+a$v.height*a$v.scaleY,a$t))}return a$t}),a$Q(0,a$v,"scaleX",a$k.prototype._$get_scaleX,function(a$t){a$R.superGet(a$f,this,"scaleX")!=a$t&&(a$R.superSet(a$f,this,"scaleX",a$t),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),a$Q(0,a$v,"top",function(){return this._layout.top},function(a$t){a$t!=this._layout.top&&(this.getLayout().top=a$t,this._setLayoutEnabled(!0)),this.resetLayoutY()}),a$Q(0,a$v,"bottom",function(){return this._layout.bottom},function(a$t){a$t!=this._layout.bottom&&(this.getLayout().bottom=a$t,this._setLayoutEnabled(!0)),this.resetLayoutY()}),a$Q(0,a$v,"left",function(){return this._layout.left},function(a$t){a$t!=this._layout.left&&(this.getLayout().left=a$t,this._setLayoutEnabled(!0)),this.resetLayoutX()}),a$Q(0,a$v,"right",function(){return this._layout.right},function(a$t){a$t!=this._layout.right&&(this.getLayout().right=a$t,this._setLayoutEnabled(!0)),this.resetLayoutX()}),a$Q(0,a$v,"centerX",function(){return this._layout.centerX},function(a$t){a$t!=this._layout.centerX&&(this.getLayout().centerX=a$t,this._setLayoutEnabled(!0)),this.resetLayoutX()}),a$Q(0,a$v,"centerY",function(){return this._layout.centerY},function(a$t){a$t!=this._layout.centerY&&(this.getLayout().centerY=a$t,this._setLayoutEnabled(!0)),this.resetLayoutY()}),a$Q(0,a$v,"anchorX",function(){return this._layout.anchorX},function(a$t){a$t!=this._layout.anchorX&&(this.getLayout().anchorX=a$t,this._setLayoutEnabled(!0)),this.resetLayoutX()}),a$Q(0,a$v,"anchorY",function(){return this._layout.anchorY},function(a$t){a$t!=this._layout.anchorY&&(this.getLayout().anchorY=a$t,this._setLayoutEnabled(!0)),this.resetLayoutY()}),a$Q(0,a$v,"tag",function(){return this._tag},function(a$t){this._tag=a$t}),a$Q(0,a$v,"toolTip",function(){return this._toolTip},function(a$t){this._toolTip!=a$t&&(null!=(this._toolTip=a$t)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),a$Q(0,a$v,"comXml",function(){return this._comXml},function(a$t){this._comXml=a$t}),a$Q(0,a$v,"gray",function(){return this._gray},function(a$t){a$t!==this._gray&&(this._gray=a$t,a$U.gray(this,a$t))}),a$Q(0,a$v,"disabled",function(){return this._disabled},function(a$t){a$t!==this._disabled&&(this.gray=this._disabled=a$t,this.mouseEnabled=!a$t)}),a$t}(a$f)),a$G=function(a$t){function a$k(){this.lockLayer=null,this.popupEffect=function(a$t){a$t.scale(1,1),a$d.from(a$t,{x:a$R.stage.width/2,y:a$R.stage.height/2,scaleX:0,scaleY:0},300,a$V.backOut,a$H.create(this,this.doOpen,[a$t]))},this.closeEffect=function(a$t,a$k){a$d.to(a$t,{x:a$R.stage.width/2,y:a$R.stage.height/2,scaleX:0,scaleY:0},300,a$V.strongOut,a$H.create(this,this.doClose,[a$t,a$k]))},a$k.__super.call(this),this.maskLayer=new a$f,this.popupEffectHandler=a$H.create(this,this.popupEffect,null,!1),this.closeEffectHandler=a$H.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,a$R.stage.addChild(this),a$R.stage.on("resize",this,this._onResize),a$N.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}a$u(a$k,"laya.ui.DialogManager",a$f);var a$v=a$k.prototype;return a$v._closeOnSide=function(){var a$t=this.getChildAt(this.numChildren-1);a$t instanceof laya.ui.Dialog&&a$t.close("side")},a$v.setLockView=function(a$t){this.lockLayer||(this.lockLayer=new a$c,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(a$R.stage.width,a$R.stage.height)),this.lockLayer.removeChildren(),a$t&&(a$t.centerX=a$t.centerY=0,this.lockLayer.addChild(a$t))},a$v._onResize=function(a$t){var a$k=this.maskLayer.width=a$R.stage.width,a$v=this.maskLayer.height=a$R.stage.height;this.lockLayer&&this.lockLayer.size(a$k,a$v),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,a$k,a$v,a$N.popupBgColor),this.maskLayer.alpha=a$N.popupBgAlpha;for(var a$j=this.numChildren-1;-1<a$j;a$j--){var a$Q=this.getChildAt(a$j);a$Q.popupCenter&&this._centerDialog(a$Q)}},a$v._centerDialog=function(a$t){a$t.x=Math.round((a$R.stage.width-a$t.width>>1)+a$t.pivotX),a$t.y=Math.round((a$R.stage.height-a$t.height>>1)+a$t.pivotY)},a$v.open=function(a$t,a$k,a$v){void 0===a$k&&(a$k=!1),void 0===a$v&&(a$v=!1),a$k&&this._closeAll(),a$t.popupCenter&&this._centerDialog(a$t),this.addChild(a$t),(a$t.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),a$v&&null!=a$t.popupEffect?a$t.popupEffect.runWith(a$t):this.doOpen(a$t),this.event("open")},a$v.doOpen=function(a$t){a$t.onOpened()},a$v.lock=function(a$t){this.lockLayer&&(a$t?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},a$v.close=function(a$t,a$k,a$v){void 0===a$v&&(a$v=!1),a$v&&null!=a$t.closeEffect?a$t.closeEffect.runWith([a$t,a$k]):this.doClose(a$t,a$k),this.event("close")},a$v.doClose=function(a$t,a$k){a$t.removeSelf(),a$t.isModal&&this._checkMask(),a$t.closeHandler&&a$t.closeHandler.runWith(a$k),a$t.onClosed(a$k)},a$v.closeAll=function(){this._closeAll(),this.event("close")},a$v._closeAll=function(){for(var a$t=this.numChildren-1;-1<a$t;a$t--){var a$k=this.getChildAt(a$t);a$k&&null!=a$k.close&&this.doClose(a$k)}},a$v.getDialogsByGroup=function(a$t){for(var a$k=[],a$v=this.numChildren-1;-1<a$v;a$v--){var a$j=this.getChildAt(a$v);a$j&&a$j.group===a$t&&a$k.push(a$j)}return a$k},a$v.closeByGroup=function(a$t){for(var a$k=[],a$v=this.numChildren-1;-1<a$v;a$v--){var a$j=this.getChildAt(a$v);a$j&&a$j.group===a$t&&(a$j.close(),a$k.push(a$j))}return a$k},a$v._checkMask=function(){this.maskLayer.removeSelf();for(var a$t=this.numChildren-1;-1<a$t;a$t--){var a$k=this.getChildAt(a$t);if(a$k&&a$k.isModal)return void this.addChildAt(this.maskLayer,a$t)}},a$k}(),a$c=function(a$t){function a$k(){a$k.__super.call(this)}a$u(a$k,"laya.ui.Box",a$t);var a$v=a$k.prototype;return a$R.imps(a$v,{"laya.ui.IBox":!0}),a$Q(0,a$v,"dataSource",a$t.prototype._$get_dataSource,function(a$t){for(var a$k in this._dataSource=a$t){var a$v=this.getChildByName(a$k);a$v?a$v.dataSource=a$t[a$k]:this.hasOwnProperty(a$k)&&"function"!=typeof this[a$k]&&(this[a$k]=a$t[a$k])}}),a$k}(a$z),a$T=function(a$k){function a$v(a$t,a$k){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,a$v.__super.call(this),this._labelColors=a$K.buttonLabelColors,this._stateNum=a$K.buttonStateNum,void 0===a$k&&(a$k=""),this.skin=a$t,this.label=a$k}a$u(a$v,"laya.ui.Button",a$k);var a$t=a$v.prototype;return a$R.imps(a$t,{"laya.ui.ISelect":!0}),a$t.destroy=function(a$t){a$o.clearCache(this,this._skin),a$o.clearObject(this,this._weakKey),void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,a$t),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(a$t),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},a$t.createChildren=function(){this.graphics=this._bitmap=new a$a},a$t.createText=function(){this._text||(this._text=new a$X,this._text.overflow=a$X.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},a$t.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},a$t.onMouse=function(a$t){if(!1!==this.toggle||!this._selected)return"click"===a$t.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=a$v.stateMap[a$t.type]))},a$t.changeClips=function(){var a$t=a$o.getRes(this._skin);if(a$t&&this._skin&&""!=this._skin){a$o.clearObject(this,this._weakKey);var a$k=a$t.sourceWidth,a$v=a$t.sourceHeight/this._stateNum;a$t.$_GID||(a$t.$_GID=a$m.getGID());var a$j=a$t.$_GID+"-"+this._stateNum,a$Q=a$o.findObject(a$j);if(a$m.isOkTextureList(a$Q)||(a$Q=null),a$Q)this._weakKey=a$j,a$o.keepObject(this,this._weakKey),this._sources=a$Q;else{if(this._sources=[],1===this._stateNum)this._sources.push(a$t);else for(var a$u=0;a$u<this._stateNum;a$u++){var a$S=a$F.createFromTexture(a$t,0,a$v*a$u,a$k,a$v);if(a$t.alphaTexture){var a$V=a$t.width/a$t.alphaTexture.width;a$S.alphaTexture=a$F.createFromTexture(a$t.alphaTexture,0/a$V,a$v*a$u/a$V,a$k/a$V,a$v/a$V)}this._sources.push(a$S)}a$o.saveObject(a$j,this._sources),this._weakKey=a$j,a$o.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||a$k,this._bitmap.height=this._height||a$v,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=a$k)}else console.warn("lose skin ",this._skin,this.name,this.__className)},a$t.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var a$t=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[a$t]),this.label&&(this._text.color=this._labelColors[a$t],this._strokeColors&&(this._text.strokeColor=this._strokeColors[a$t]))},a$t._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},a$Q(0,a$t,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(a$t){this.createText(),this._text.strokeColor=a$t}),a$Q(0,a$t,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),a$Q(0,a$t,"skin",function(){return this._skin},function(a$t){this._skin!=a$t&&(a$o.clearCache(this,this._skin),this._skin=a$t,a$o.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),a$Q(0,a$t,"state",function(){return this._state},function(a$t){this._state!=a$t&&(this._state=a$t,this._setStateChanged())}),a$Q(0,a$t,"text",function(){return this.createText(),this._text}),a$Q(0,a$t,"stateNum",function(){return this._stateNum},function(a$t){"string"==typeof a$t&&(a$t=parseInt(a$t)),this._stateNum!=a$t&&(this._stateNum=a$t<1?1:3<a$t?3:a$t,this.callLater(this.changeClips))}),a$Q(0,a$t,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(a$t){this._strokeColors=a$U.fillArray(a$K.buttonLabelColors,a$t,String),this._setStateChanged()}),a$Q(0,a$t,"labelColors",function(){return this._labelColors.join(",")},function(a$t){this._labelColors=a$U.fillArray(a$K.buttonLabelColors,a$t,String),this._setStateChanged()}),a$Q(0,a$t,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),a$Q(0,a$t,"label",function(){return this._text?this._text.text:null},function(a$t){(this._text||a$t)&&(this.createText(),this._text.text!=a$t&&(a$t&&!this._text.parent&&this.addChild(this._text),this._text.text=(a$t+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),a$Q(0,a$t,"selected",function(){return this._selected},function(a$t){this._selected!=a$t&&(this._selected=a$t,this.state=this._selected?2:0,this.event("change"))}),a$Q(0,a$t,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(a$t){this.createText(),this._text.padding=a$U.fillArray(a$K.labelPadding,a$t,Number)}),a$Q(0,a$t,"labelSize",function(){return this.createText(),this._text.fontSize},function(a$t){this.createText(),this._text.fontSize=a$t}),a$Q(0,a$t,"labelStroke",function(){return this.createText(),this._text.stroke},function(a$t){this.createText(),this._text.stroke=a$t}),a$Q(0,a$t,"labelBold",function(){return this.createText(),this._text.bold},function(a$t){this.createText(),this._text.bold=a$t}),a$Q(0,a$t,"labelFont",function(){return this.createText(),this._text.font},function(a$t){this.createText(),this._text.font=a$t}),a$Q(0,a$t,"labelAlign",function(){return this.createText(),this._text.align},function(a$t){this.createText(),this._text.align=a$t}),a$Q(0,a$t,"clickHandler",function(){return this._clickHandler},function(a$t){this._clickHandler=a$t}),a$Q(0,a$t,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(a$t){this._bitmap.sizeGrid=a$U.fillArray(a$K.defaultSizeGrid,a$t,Number)}),a$Q(0,a$t,"width",a$k.prototype._$get_width,function(a$t){a$R.superSet(a$z,this,"width",a$t),this._autoSize&&(this._bitmap.width=a$t,this._text&&(this._text.width=a$t))}),a$Q(0,a$t,"height",a$k.prototype._$get_height,function(a$t){a$R.superSet(a$z,this,"height",a$t),this._autoSize&&(this._bitmap.height=a$t,this._text&&(this._text.height=a$t))}),a$Q(0,a$t,"dataSource",a$k.prototype._$get_dataSource,function(a$t){"number"==typeof(this._dataSource=a$t)||"string"==typeof a$t?this.label=a$t+"":a$R.superSet(a$z,this,"dataSource",a$t)}),a$Q(0,a$t,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(a$t){this._bitmap._offset=a$t?a$U.fillArray([1,1],a$t,Number):[]}),a$j(a$v,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),a$v}(a$z),a$p=function(a$k){function a$j(a$t,a$k,a$v){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,a$j.__super.call(this),void 0===a$k&&(a$k=1),void 0===a$v&&(a$v=1),this._clipX=a$k,this._clipY=a$v,this.skin=a$t}a$u(a$j,"laya.ui.Clip",a$k);var a$t=a$j.prototype;return a$t.destroy=function(a$t){a$o.clearCache(this,this._skin),a$o.clearObject(this,this._weakKey),void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},a$t.dispose=function(){this.destroy(!0),a$R.loader.clearRes(this._skin)},a$t.createChildren=function(){this.graphics=this._bitmap=new a$a},a$t._onDisplay=function(a$t){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},a$t.changeClip=function(){if(this._clipChanged=!1,this._skin){var a$t=a$o.getRes(this._skin);a$t?this.loadComplete(this._skin,a$t):a$R.loader.load(this._skin,a$H.create(this,this.loadComplete,[this._skin]))}},a$t.loadComplete=function(a$t,a$k){if(a$t===this._skin&&a$k){a$o.clearObject(this,this._weakKey);var a$v=this._clipWidth||Math.ceil(a$k.sourceWidth/this._clipX),a$j=this._clipHeight||Math.ceil(a$k.sourceHeight/this._clipY),a$Q=this._skin+a$v+a$j,a$u=a$o.findObject(a$Q);if(a$m.isOkTextureList(a$u)||(a$u=null),a$u)this._weakKey=a$Q,a$o.keepObject(this,this._weakKey),this._sources=a$u;else{this._sources=[];for(var a$S=0;a$S<this._clipY;a$S++)for(var a$V=0;a$V<this._clipX;a$V++){var a$J=a$F.createFromTexture(a$k,a$v*a$V,a$j*a$S,a$v,a$j);if(a$k.alphaTexture){var a$W=a$k.width/a$k.alphaTexture.width;a$J.alphaTexture=a$F.createFromTexture(a$k.alphaTexture,a$v*a$V/a$W,a$j*a$S/a$W,a$v/a$W,a$j/a$W)}this._sources.push(a$J)}a$o.saveObject(a$Q,this._sources),this._weakKey=a$Q,a$o.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},a$t.play=function(a$t,a$k){void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=-1),this._isPlaying=!0,this.index=a$t,this._toIndex=a$k,this._index++,a$R.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},a$t._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},a$t.stop=function(){this._isPlaying=!1,a$R.timer.clear(this,this._loop),this.event("complete")},a$t._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},a$Q(0,a$t,"interval",function(){return this._interval},function(a$t){this._interval!=a$t&&(this._interval=a$t,this._isPlaying&&this.play())}),a$Q(0,a$t,"skin",function(){return this._skin},function(a$t){this._skin!=a$t&&(a$o.clearCache(this,this._skin),(this._skin=a$t)?(a$o.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),a$Q(0,a$t,"sources",function(){return this._sources},function(a$t){this._sources=a$t,this.index=this._index,this.event("loaded")}),a$Q(0,a$t,"clipX",function(){return this._clipX},function(a$t){this._clipX=a$t||1,this._setClipChanged()}),a$Q(0,a$t,"clipY",function(){return this._clipY},function(a$t){this._clipY=a$t||1,this._setClipChanged()}),a$Q(0,a$t,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),a$Q(0,a$t,"clipWidth",function(){return this._clipWidth},function(a$t){this._clipWidth=a$t,this._setClipChanged()}),a$Q(0,a$t,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(a$t){this._bitmap.sizeGrid=a$U.fillArray(a$K.defaultSizeGrid,a$t,Number)}),a$Q(0,a$t,"group",function(){return this._group},function(a$t){a$t&&this._skin&&a$o.setGroup(this._skin,a$t),this._group=a$t}),a$Q(0,a$t,"clipHeight",function(){return this._clipHeight},function(a$t){this._clipHeight=a$t,this._setClipChanged()}),a$Q(0,a$t,"width",a$k.prototype._$get_width,function(a$t){a$R.superSet(a$z,this,"width",a$t),this._bitmap.width=a$t}),a$Q(0,a$t,"height",a$k.prototype._$get_height,function(a$t){a$R.superSet(a$z,this,"height",a$t),this._bitmap.height=a$t}),a$Q(0,a$t,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),a$Q(0,a$t,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),a$Q(0,a$t,"index",function(){return this._index},function(a$t){this._index=a$t,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[a$t]),this.event("change")}),a$Q(0,a$t,"autoPlay",function(){return this._autoPlay},function(a$t){this._autoPlay!=a$t&&((this._autoPlay=a$t)?this.play():this.stop())}),a$Q(0,a$t,"isPlaying",function(){return this._isPlaying},function(a$t){this._isPlaying=a$t}),a$Q(0,a$t,"dataSource",a$k.prototype._$get_dataSource,function(a$t){"number"==typeof(this._dataSource=a$t)&&Math.floor(a$t)==a$t||"string"==typeof a$t?this.index=parseInt(a$t):a$R.superSet(a$z,this,"dataSource",a$t)}),a$Q(0,a$t,"bitmap",function(){return this._bitmap}),a$j}(a$z),a$O=function(a$k){function a$t(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,a$t.__super.call(this)}a$u(a$t,"laya.ui.ColorPicker",a$k);var a$v=a$t.prototype;return a$v.destroy=function(a$t){void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,a$t),this._colorPanel&&this._colorPanel.destroy(a$t),this._colorButton&&this._colorButton.destroy(a$t),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},a$v.createChildren=function(){this.addChild(this._colorButton=new a$T),this._colorPanel=new a$c,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new a$f),this._colorPanel.addChild(this._colorBlock=new a$f),this._colorPanel.addChild(this._colorInput=new a$E)},a$v.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},a$v.onPanelMouseDown=function(a$t){a$t.stopPropagation()},a$v.changePanel=function(){this._panelChanged=!1;var a$t=this._colorPanel.graphics;a$t.clear(),a$t.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(a$t=this._colorTiles.graphics).clear();for(var a$k=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],a$v=0;a$v<12;a$v++)for(var a$j=0;a$j<20;a$j++){var a$Q=0;a$Q=0===a$j?a$k[a$v]:1===a$j?0:51*(((3*a$v+a$j/6)%3<<0)+3*(a$v/6<<0))<<16|a$j%6*51<<8|(a$v<<0)%6*51;var a$u=a$U.toColor(a$Q);this._colors.push(a$u);var a$S=a$j*this._gridSize,a$V=a$v*this._gridSize;a$t.drawRect(a$S,a$V,this._gridSize,this._gridSize,a$u,"#000000")}},a$v.onColorButtonClick=function(a$t){this._colorPanel.parent?this.close():this.open()},a$v.open=function(){var a$t=this.localToGlobal(new a$A),a$k=a$t.x+this._colorPanel.width<=a$R.stage.width?a$t.x:a$R.stage.width-this._colorPanel.width,a$v=a$t.y+this._colorButton.height;a$v=a$v+this._colorPanel.height<=a$R.stage.height?a$v:a$t.y-this._colorPanel.height,this._colorPanel.pos(a$k,a$v),this._colorPanel.zOrder=1001,a$R._currentStage.addChild(this._colorPanel),a$R.stage.on("mousedown",this,this.removeColorBox)},a$v.close=function(){a$R.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},a$v.removeColorBox=function(a$t){this.close()},a$v.onColorFieldKeyDown=function(a$t){13==a$t.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),a$t.stopPropagation())},a$v.onColorInputChange=function(a$t){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},a$v.onColorTilesClick=function(a$t){this.selectedColor=this.getColorByMouse(),this.close()},a$v.onColorTilesMouseMove=function(a$t){this._colorInput.focus=!1;var a$k=this.getColorByMouse();this._colorInput.text=a$k,this.drawBlock(a$k)},a$v.getColorByMouse=function(){var a$t=this._colorTiles.getMousePoint(),a$k=Math.floor(a$t.x/this._gridSize),a$v=Math.floor(a$t.y/this._gridSize);return this._colors[20*a$v+a$k]},a$v.drawBlock=function(a$t){var a$k=this._colorBlock.graphics;a$k.clear();var a$v=a$t||"#ffffff";a$k.drawRect(0,0,50,20,a$v,this._borderColor),a$t||a$k.drawLine(0,0,50,20,"#ff0000")},a$v.changeColor=function(){var a$t=this.graphics;a$t.clear();var a$k=this._selectedColor||"#000000";a$t.drawRect(0,0,this._colorButton.width,this._colorButton.height,a$k)},a$v._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},a$Q(0,a$v,"inputBgColor",function(){return this._inputBgColor},function(a$t){this._inputBgColor=a$t,this._setPanelChanged()}),a$Q(0,a$v,"selectedColor",function(){return this._selectedColor},function(a$t){this._selectedColor!=a$t&&(this._selectedColor=this._colorInput.text=a$t,this.drawBlock(a$t),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",a$J.EMPTY.setTo("change",this,this)))}),a$Q(0,a$v,"skin",function(){return this._colorButton.skin},function(a$t){this._colorButton.skin=a$t,this.changeColor()}),a$Q(0,a$v,"bgColor",function(){return this._bgColor},function(a$t){this._bgColor=a$t,this._setPanelChanged()}),a$Q(0,a$v,"borderColor",function(){return this._borderColor},function(a$t){this._borderColor=a$t,this._setPanelChanged()}),a$Q(0,a$v,"inputColor",function(){return this._inputColor},function(a$t){this._inputColor=a$t,this._setPanelChanged()}),a$t}(a$z),a$n=function(a$k){function a$v(a$t,a$k){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,a$v.__super.call(this),this._itemColors=a$K.comboBoxItemColors,this.skin=a$t,this.labels=a$k}a$u(a$v,"laya.ui.ComboBox",a$k);var a$t=a$v.prototype;return a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,a$t),this._button&&this._button.destroy(a$t),this._list&&this._list.destroy(a$t),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},a$t.createChildren=function(){this.addChild(this._button=new a$T),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},a$t._createList=function(){this._list=new a$L,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},a$t._setListEvent=function(a$t){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=a$H.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},a$t.onListDown=function(a$t){a$t.stopPropagation()},a$t.onScrollBarDown=function(a$t){a$t.stopPropagation()},a$t.onButtonMouseDown=function(a$t){this.callLater(this.switchTo,[!this._isOpen])},a$t.changeList=function(){this._listChanged=!1;var a$t=this.width-2,a$k=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:a$t,height:this._itemHeight,fontSize:this._itemSize,color:a$k}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},a$t.onlistItemMouse=function(a$t,a$k){var a$v=a$t.type;if("mouseover"===a$v||"mouseout"===a$v){if(this._isCustomList)return;var a$j=this._list.getCell(a$k);if(!a$j)return;var a$Q=a$j.getChildByName("label");a$Q&&("mouseover"===a$v?(a$Q.bgColor=this._itemColors[0],a$Q.color=this._itemColors[1]):(a$Q.bgColor=null,a$Q.color=this._itemColors[2]))}else"click"===a$v&&(this.selectedIndex=a$k,this.isOpen=!1)},a$t.switchTo=function(a$t){this.isOpen=a$t},a$t.changeOpen=function(){this.isOpen=!this._isOpen},a$t.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var a$t=this._list.graphics;a$t.clear(),a$t.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var a$k=this._list.array||[],a$v=a$k.length=0,a$j=this._labels.length;a$v<a$j;a$v++)a$k.push({label:this._labels[a$v]});this._list.height=this._listHeight,this._list.array=a$k},a$t.changeSelected=function(){this._button.label=this.selectedLabel},a$t._onStageMouseWheel=function(a$t){this._list&&!this._list.contains(a$t.target)&&this.removeList(null)},a$t.removeList=function(a$t){a$R.stage.off("mousedown",this,this.removeList),a$R.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},a$Q(0,a$t,"selectedIndex",function(){return this._selectedIndex},function(a$t){this._selectedIndex!=a$t&&(this._selectedIndex=a$t,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[a$J.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),a$Q(0,a$t,"measureHeight",function(){return this._button.height}),a$Q(0,a$t,"skin",function(){return this._button.skin},function(a$t){this._button.skin!=a$t&&(this._button.skin=a$t,this._listChanged=!0)}),a$Q(0,a$t,"measureWidth",function(){return this._button.width}),a$Q(0,a$t,"width",a$k.prototype._$get_width,function(a$t){a$R.superSet(a$z,this,"width",a$t),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),a$Q(0,a$t,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(a$t){this.selectedIndex=this._labels.indexOf(a$t)}),a$Q(0,a$t,"labels",function(){return this._labels.join(",")},function(a$t){0<this._labels.length&&(this.selectedIndex=-1),a$t?this._labels=a$t.split(","):this._labels.length=0,this._itemChanged=!0}),a$Q(0,a$t,"height",a$k.prototype._$get_height,function(a$t){a$R.superSet(a$z,this,"height",a$t),this._button.height=this._height}),a$Q(0,a$t,"selectHandler",function(){return this._selectHandler},function(a$t){this._selectHandler=a$t}),a$Q(0,a$t,"visibleNum",function(){return this._visibleNum},function(a$t){this._visibleNum=a$t,this._listChanged=!0}),a$Q(0,a$t,"labelBold",function(){return this._button.text.bold},function(a$t){this._button.text.bold=a$t}),a$Q(0,a$t,"itemColors",function(){return String(this._itemColors)},function(a$t){this._itemColors=a$U.fillArray(this._itemColors,a$t,String),this._listChanged=!0}),a$Q(0,a$t,"itemSize",function(){return this._itemSize},function(a$t){this._itemSize=a$t,this._listChanged=!0}),a$Q(0,a$t,"scrollBar",function(){return this.list.scrollBar}),a$Q(0,a$t,"isOpen",function(){return this._isOpen},function(a$t){if(this._isOpen!=a$t)if(this._isOpen=a$t,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var a$k=this.localToGlobal(a$A.TEMP.setTo(0,0)),a$v=a$k.y+this._button.height;a$v=a$v+this._listHeight<=a$R.stage.height?a$v:a$k.y-this._listHeight,this._list.pos(a$k.x,a$v),this._list.zOrder=1001,a$R._currentStage.addChild(this._list),a$R.stage.once("mousedown",this,this.removeList),a$R.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),a$Q(0,a$t,"scrollBarSkin",function(){return this._scrollBarSkin},function(a$t){this._scrollBarSkin=a$t}),a$Q(0,a$t,"sizeGrid",function(){return this._button.sizeGrid},function(a$t){this._button.sizeGrid=a$t}),a$Q(0,a$t,"button",function(){return this._button}),a$Q(0,a$t,"list",function(){return this._list||this._createList(),this._list},function(a$t){a$t&&(a$t.removeSelf(),this._isCustomList=!0,this._list=a$t,this._setListEvent(a$t),this._itemHeight=a$t.getCell(0).height+a$t.spaceY)}),a$Q(0,a$t,"dataSource",a$k.prototype._$get_dataSource,function(a$t){"number"==typeof(this._dataSource=a$t)&&Math.floor(a$t)==a$t||"string"==typeof a$t?this.selectedIndex=parseInt(a$t):a$t instanceof Array?this.labels=a$t.join(","):a$R.superSet(a$z,this,"dataSource",a$t)}),a$Q(0,a$t,"labelColors",function(){return this._button.labelColors},function(a$t){this._button.labelColors!=a$t&&(this._button.labelColors=a$t)}),a$Q(0,a$t,"labelPadding",function(){return this._button.text.padding.join(",")},function(a$t){this._button.text.padding=a$U.fillArray(a$K.labelPadding,a$t,Number)}),a$Q(0,a$t,"labelSize",function(){return this._button.text.fontSize},function(a$t){this._button.text.fontSize=a$t}),a$Q(0,a$t,"labelFont",function(){return this._button.text.font},function(a$t){this._button.text.font=a$t}),a$Q(0,a$t,"stateNum",function(){return this._button.stateNum},function(a$t){this._button.stateNum=a$t}),a$v}(a$z),a$_=function(a$k){function a$v(a$t){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,a$v.__super.call(this),this._showButtons=a$N.showButtons,this._touchScrollEnable=a$N.touchScrollEnable,this._mouseWheelEnable=a$N.mouseWheelEnable,this.skin=a$t,this.max=1}a$u(a$v,"laya.ui.ScrollBar",a$k);var a$t=a$v.prototype;return a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),this.stopScroll(),this.target=null,a$k.prototype.destroy.call(this,a$t),this.upButton&&this.upButton.destroy(a$t),this.downButton&&this.downButton.destroy(a$t),this.slider&&this.slider.destroy(a$t),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},a$t.createChildren=function(){this.addChild(this.slider=new a$x),this.addChild(this.upButton=new a$T),this.addChild(this.downButton=new a$T)},a$t.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},a$t.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},a$t.onButtonMouseDown=function(a$t){var a$k=a$t.currentTarget===this.upButton;this.slide(a$k),a$R.timer.once(a$K.scrollBarDelayTime,this,this.startLoop,[a$k]),a$R.stage.once("mouseup",this,this.onStageMouseUp)},a$t.startLoop=function(a$t){a$R.timer.frameLoop(1,this,this.slide,[a$t])},a$t.slide=function(a$t){a$t?this.value-=this._scrollSize:this.value+=this._scrollSize},a$t.onStageMouseUp=function(a$t){a$R.timer.clear(this,this.startLoop),a$R.timer.clear(this,this.slide)},a$t.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},a$t.changeSize=function(){a$k.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},a$t.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},a$t.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},a$t.setScroll=function(a$t,a$k,a$v){this.runCallLater(this.changeSize),this.slider.setSlider(a$t,a$k,a$v),this.slider.bar.visible=0<a$k,!this._hide&&this.autoHide&&(this.visible=!1)},a$t.onTargetMouseWheel=function(a$t){this.value-=a$t.delta*this._scrollSize,this.target=this._target},a$t.onTargetMouseDown=function(a$t){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new a$A),this._lastPoint.setTo(a$R.stage.mouseX,a$R.stage.mouseY),a$R.timer.clear(this,this.tweenMove),a$d.clearTween(this),a$R.stage.once("mouseup",this,this.onStageMouseUp2),a$R.stage.once("mouseout",this,this.onStageMouseUp2),a$R.timer.frameLoop(1,this,this.loop)},a$t.loop=function(){var a$t=a$R.stage.mouseY,a$k=a$R.stage.mouseX;if(this._lastOffset=this.isVertical?a$t-this._lastPoint.y:a$k-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?a$R.stage._canvasTransform.getScaleY():a$R.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=a$k,this._lastPoint.y=a$t,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},a$t.onStageMouseUp2=function(a$t){if(a$R.stage.off("mouseup",this,this.onStageMouseUp2),a$R.stage.off("mouseout",this,this.onStageMouseUp2),a$R.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?a$d.to(this,{value:this.min},this.elasticBackTime,a$V.sineOut,a$H.create(this,this.elasticOver)):this._value>this.max&&a$d.to(this,{value:this.max},this.elasticBackTime,a$V.sineOut,a$H.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?a$R.stage.mouseY-this._lastPoint.y:a$R.stage.mouseX-this._lastPoint.x);for(var a$k=0,a$v=Math.min(this._offsets.length,3),a$j=0;a$j<a$v;a$j++)a$k+=this._offsets[this._offsets.length-1-a$j];if(this._lastOffset=a$k/a$v,(a$k=Math.abs(this._lastOffset))<2)return void this.event("end");60<a$k&&(this._lastOffset=0<this._lastOffset?60:-60);var a$Q=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));a$R.timer.frameLoop(1,this,this.tweenMove,[a$Q])}},a$t.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&a$d.to(this,{alpha:0},500),this.event("end")},a$t.tweenMove=function(a$t){this._lastOffset*=this.rollRatio;var a$k=NaN;if(0<a$t&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,a$k=.5*-(this.min-a$t-this.value),this._lastOffset>a$k&&(this._lastOffset=a$k)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,a$k=.5*-(this.max+a$t-this.value),this._lastOffset<a$k&&(this._lastOffset=a$k))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(a$R.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?a$d.to(this,{value:this.min},this.elasticBackTime,a$V.sineOut,a$H.create(this,this.elasticOver)):this._value>this.max?a$d.to(this,{value:this.max},this.elasticBackTime,a$V.sineOut,a$H.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&a$d.to(this,{alpha:0},500)}},a$t.stopScroll=function(){this.onStageMouseUp2(null),a$R.timer.clear(this,this.tweenMove),a$d.clearTween(this)},a$Q(0,a$t,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),a$Q(0,a$t,"skin",function(){return this._skin},function(a$t){this._skin!=a$t&&(this._skin=a$t,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),a$Q(0,a$t,"max",function(){return this.slider.max},function(a$t){this.slider.max=a$t}),a$Q(0,a$t,"showButtons",function(){return this._showButtons},function(a$t){this._showButtons=a$t,this.callLater(this.changeScrollBar)}),a$Q(0,a$t,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),a$Q(0,a$t,"min",function(){return this.slider.min},function(a$t){this.slider.min=a$t}),a$Q(0,a$t,"value",function(){return this._value},function(a$t){a$t!==this._value&&(this._value=a$t,this._isElastic||(this.slider._value!=a$t&&(this.slider._value=a$t,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),a$Q(0,a$t,"isVertical",function(){return this.slider.isVertical},function(a$t){this.slider.isVertical=a$t}),a$Q(0,a$t,"sizeGrid",function(){return this.slider.sizeGrid},function(a$t){this.slider.sizeGrid=a$t}),a$Q(0,a$t,"scrollSize",function(){return this._scrollSize},function(a$t){this._scrollSize=a$t}),a$Q(0,a$t,"dataSource",a$k.prototype._$get_dataSource,function(a$t){"number"==typeof(this._dataSource=a$t)||"string"==typeof a$t?this.value=Number(a$t):a$R.superSet(a$z,this,"dataSource",a$t)}),a$Q(0,a$t,"thumbPercent",function(){return this._thumbPercent},function(a$t){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),a$t=1<=a$t?.99:a$t,this._thumbPercent=a$t,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*a$t,a$K.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*a$t,a$K.scrollBarMinNum))}),a$Q(0,a$t,"target",function(){return this._target},function(a$t){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=a$t)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),a$Q(0,a$t,"hide",function(){return this._hide},function(a$t){this._hide=a$t,this.visible=!a$t}),a$Q(0,a$t,"touchScrollEnable",function(){return this._touchScrollEnable},function(a$t){this._touchScrollEnable=a$t,this.target=this._target}),a$Q(0,a$t,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(a$t){this._mouseWheelEnable=a$t,this.target=this._target}),a$Q(0,a$t,"tick",function(){return this.slider.tick},function(a$t){this.slider.tick=a$t}),a$v}(a$z),a$x=function(a$k){function a$v(a$t){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,a$v.__super.call(this),this.skin=a$t}a$u(a$v,"laya.ui.Slider",a$k);var a$t=a$v.prototype;return a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,a$t),this._bg&&this._bg.destroy(a$t),this._bar&&this._bar.destroy(a$t),this._progress&&this._progress.destroy(a$t),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},a$t.createChildren=function(){this.addChild(this._bg=new a$I),this.addChild(this._bar=new a$T)},a$t.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},a$t.onBarMouseDown=function(a$t){this._globalSacle||(this._globalSacle=new a$A),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=a$R.stage.mouseX,this._ty=a$R.stage.mouseY,a$R.stage.on("mousemove",this,this.mouseMove),a$R.stage.once("mouseup",this,this.mouseUp),a$R.stage.once("mouseout",this,this.mouseUp),this.showValueText()},a$t.showValueText=function(){if(this.showLabel){var a$t=laya.ui.Slider.label;this.addChild(a$t),a$t.textField.changeText(this._value+""),this.isVertical?(a$t.x=this._bar.x+20,a$t.y=.5*(this._bar.height-a$t.height)+this._bar.y):(a$t.y=this._bar.y-20,a$t.x=.5*(this._bar.width-a$t.width)+this._bar.x)}},a$t.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},a$t.mouseUp=function(a$t){a$R.stage.off("mousemove",this,this.mouseMove),a$R.stage.off("mouseup",this,this.mouseUp),a$R.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},a$t.mouseMove=function(a$t){var a$k=this._value;this.isVertical?(this._bar.y+=(a$R.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(a$R.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=a$R.stage.mouseX,this._ty=a$R.stage.mouseY;var a$v=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*a$v)/a$v,this._value!=a$k&&this.sendChangeEvent(),this.showValueText()},a$t.sendChangeEvent=function(a$t){void 0===a$t&&(a$t="change"),this.event(a$t),this.changeHandler&&this.changeHandler.runWith(this._value)},a$t.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},a$t.changeSize=function(){a$k.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},a$t.setSlider=function(a$t,a$k,a$v){this._value=-1,this._min=a$t,this._max=a$t<a$k?a$k:a$t,this.value=a$v<a$t?a$t:a$k<a$v?a$k:a$v},a$t.changeValue=function(){var a$t=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*a$t)/a$t,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var a$k=this._max-this._min;0===a$k&&(a$k=1),this.isVertical?(this._bar.y=(this._value-this._min)/a$k*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/a$k*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},a$t.onBgMouseDown=function(a$t){var a$k=this._bg.getMousePoint();this.isVertical?this.value=a$k.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=a$k.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},a$Q(0,a$t,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),a$Q(0,a$t,"skin",function(){return this._skin},function(a$t){if(this._skin!=a$t){this._skin=a$t,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var a$k=this._skin.replace(".png","$progress.png");a$o.getRes(a$k)&&(this._progress||(this.addChild(this._progress=new a$I),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=a$k),this.setBarPoint(),this.callLater(this.changeValue)}}),a$Q(0,a$t,"allowClickBack",function(){return this._allowClickBack},function(a$t){this._allowClickBack!=a$t&&((this._allowClickBack=a$t)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),a$Q(0,a$t,"max",function(){return this._max},function(a$t){this._max!=a$t&&(this._max=a$t,this.callLater(this.changeValue))}),a$Q(0,a$t,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),a$Q(0,a$t,"tick",function(){return this._tick},function(a$t){this._tick!=a$t&&(this._tick=a$t,this.callLater(this.changeValue))}),a$Q(0,a$t,"sizeGrid",function(){return this._bg.sizeGrid},function(a$t){this._bg.sizeGrid=a$t,this._bar.sizeGrid=a$t,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),a$Q(0,a$t,"min",function(){return this._min},function(a$t){this._min!=a$t&&(this._min=a$t,this.callLater(this.changeValue))}),a$Q(0,a$t,"value",function(){return this._value},function(a$t){if(this._value!=a$t){var a$k=this._value;this._value=a$t,this.changeValue(),this._value!=a$k&&this.sendChangeEvent()}}),a$Q(0,a$t,"dataSource",a$k.prototype._$get_dataSource,function(a$t){"number"==typeof(this._dataSource=a$t)||"string"==typeof a$t?this.value=Number(a$t):a$R.superSet(a$z,this,"dataSource",a$t)}),a$Q(0,a$t,"bar",function(){return this._bar}),a$j(a$v,["label",function(){return this.label=new a$i}]),a$v}(a$z),a$I=function(a$k){function a$v(a$t){this._bitmap=null,this._skin=null,this._group=null,a$v.__super.call(this),this.skin=a$t}a$u(a$v,"laya.ui.Image",a$k);var a$t=a$v.prototype;return a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,a$o.clearCache(this,this._skin)},a$t.dispose=function(){this.destroy(!0),a$o.clearCache(this,this._skin)},a$t.createChildren=function(){this.graphics=this._bitmap=new a$a},a$t.setSource=function(a$t,a$k){a$t===this._skin&&a$k&&(this.source=a$k,this.onCompResize())},a$Q(0,a$t,"source",function(){return this._bitmap.source},function(a$t){this._bitmap&&(this._bitmap.source=a$t,this.event("loaded"),this.repaint())}),a$Q(0,a$t,"dataSource",a$k.prototype._$get_dataSource,function(a$t){"string"==typeof(this._dataSource=a$t)?this.skin=a$t:a$R.superSet(a$z,this,"dataSource",a$t)}),a$Q(0,a$t,"measureHeight",function(){return this._bitmap.height}),a$Q(0,a$t,"skin",function(){return this._skin},function(a$t){if(this._skin!=a$t)if(a$o.clearCache(this,this._skin),this._skin=a$t){a$o.keepCache(this,this._skin);var a$k=a$o.getRes(a$t);a$k?(this.source=a$k,this.onCompResize()):a$R.loader.load(this._skin,a$H.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),a$Q(0,a$t,"group",function(){return this._group},function(a$t){a$t&&this._skin&&a$o.setGroup(this._skin,a$t),this._group=a$t}),a$Q(0,a$t,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(a$t){this._bitmap.sizeGrid=a$U.fillArray(a$K.defaultSizeGrid,a$t,Number)}),a$Q(0,a$t,"measureWidth",function(){return this._bitmap.width}),a$Q(0,a$t,"width",a$k.prototype._$get_width,function(a$t){a$R.superSet(a$z,this,"width",a$t),this._bitmap.width=0==a$t?1e-7:a$t}),a$Q(0,a$t,"height",a$k.prototype._$get_height,function(a$t){a$R.superSet(a$z,this,"height",a$t),this._bitmap.height=0==a$t?1e-7:a$t}),a$v}(a$z),a$i=function(a$k){function a$v(a$t){this._tf=null,a$v.__super.call(this),void 0===a$t&&(a$t=""),a$W.defaultColor=a$K.labelColor,this.text=a$t}a$u(a$v,"laya.ui.Label",a$k);var a$t=a$v.prototype;return a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,a$t),this._tf=null},a$t.createChildren=function(){this.addChild(this._tf=new a$X)},a$t.changeText=function(a$t){this._tf.changeText(a$t)},a$Q(0,a$t,"padding",function(){return this._tf.padding.join(",")},function(a$t){this._tf.padding=a$U.fillArray(a$K.labelPadding,a$t,Number)}),a$Q(0,a$t,"bold",function(){return this._tf.bold},function(a$t){this._tf.bold=a$t}),a$Q(0,a$t,"align",function(){return this._tf.align},function(a$t){this._tf.align=a$t}),a$Q(0,a$t,"text",function(){return this._tf.text},function(a$t){this._tf.text!=a$t&&(a$t&&(a$t=a$U.adptString(a$t+"")),this._tf.text=a$t,this.event("change"),this._width&&this._height||this.onCompResize())}),a$Q(0,a$t,"italic",function(){return this._tf.italic},function(a$t){this._tf.italic=a$t}),a$Q(0,a$t,"wordWrap",function(){return this._tf.wordWrap},function(a$t){this._tf.wordWrap=a$t}),a$Q(0,a$t,"font",function(){return this._tf.font},function(a$t){this._tf.font=a$t}),a$Q(0,a$t,"dataSource",a$k.prototype._$get_dataSource,function(a$t){"number"==typeof(this._dataSource=a$t)||"string"==typeof a$t?this.text=a$t+"":a$R.superSet(a$z,this,"dataSource",a$t)}),a$Q(0,a$t,"color",function(){return this._tf.color},function(a$t){this._tf.color=a$t}),a$Q(0,a$t,"valign",function(){return this._tf.valign},function(a$t){this._tf.valign=a$t}),a$Q(0,a$t,"leading",function(){return this._tf.leading},function(a$t){this._tf.leading=a$t}),a$Q(0,a$t,"fontSize",function(){return this._tf.fontSize},function(a$t){this._tf.fontSize=a$t}),a$Q(0,a$t,"bgColor",function(){return this._tf.bgColor},function(a$t){this._tf.bgColor=a$t}),a$Q(0,a$t,"borderColor",function(){return this._tf.borderColor},function(a$t){this._tf.borderColor=a$t}),a$Q(0,a$t,"stroke",function(){return this._tf.stroke},function(a$t){this._tf.stroke=a$t}),a$Q(0,a$t,"strokeColor",function(){return this._tf.strokeColor},function(a$t){this._tf.strokeColor=a$t}),a$Q(0,a$t,"textField",function(){return this._tf}),a$Q(0,a$t,"measureWidth",function(){return this._tf.width}),a$Q(0,a$t,"measureHeight",function(){return this._tf.height}),a$Q(0,a$t,"width",function(){return this._width||this._tf.text?a$R.superGet(a$z,this,"width"):0},function(a$t){a$R.superSet(a$z,this,"width",a$t),this._tf.width=a$t}),a$Q(0,a$t,"height",function(){return this._height||this._tf.text?a$R.superGet(a$z,this,"height"):0},function(a$t){a$R.superSet(a$z,this,"height",a$t),this._tf.height=a$t}),a$Q(0,a$t,"overflow",function(){return this._tf.overflow},function(a$t){this._tf.overflow=a$t}),a$Q(0,a$t,"underline",function(){return this._tf.underline},function(a$t){this._tf.underline=a$t}),a$Q(0,a$t,"underlineColor",function(){return this._tf.underlineColor},function(a$t){this._tf.underlineColor=a$t}),a$v}(a$z),a$D=function(a$k){function a$v(a$t){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,a$v.__super.call(this),this.skin=a$t}a$u(a$v,"laya.ui.ProgressBar",a$k);var a$t=a$v.prototype;return a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,a$t),this._bg&&this._bg.destroy(a$t),this._bar&&this._bar.destroy(a$t),this._bg=this._bar=null,this.changeHandler=null},a$t.createChildren=function(){this.addChild(this._bg=new a$I),this.addChild(this._bar=new a$I)},a$t.changeValue=function(){if(this.sizeGrid){var a$t=this.sizeGrid.split(","),a$k=Number(a$t[3]),a$v=Number(a$t[1]),a$j=(this.width-a$k-a$v)*this._value;this._bar.width=a$k+a$v+a$j,this._bar.visible=this._bar.width>a$k+a$v}else this._bar.width=this.width*this._value},a$Q(0,a$t,"measureHeight",function(){return this._bg.height}),a$Q(0,a$t,"skin",function(){return this._skin},function(a$t){this._skin!=a$t&&(this._skin=a$t,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),a$Q(0,a$t,"measureWidth",function(){return this._bg.width}),a$Q(0,a$t,"height",a$k.prototype._$get_height,function(a$t){a$R.superSet(a$z,this,"height",a$t),this._bg.height=this._height,this._bar.height=this._height}),a$Q(0,a$t,"bar",function(){return this._bar}),a$Q(0,a$t,"value",function(){return this._value},function(a$t){this._value!=a$t&&(a$t=1<a$t?1:a$t<0?0:a$t,this._value=a$t,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(a$t))}),a$Q(0,a$t,"bg",function(){return this._bg}),a$Q(0,a$t,"sizeGrid",function(){return this._bg.sizeGrid},function(a$t){this._bg.sizeGrid=this._bar.sizeGrid=a$t}),a$Q(0,a$t,"width",a$k.prototype._$get_width,function(a$t){a$R.superSet(a$z,this,"width",a$t),this._bg.width=this._width,this.callLater(this.changeValue)}),a$Q(0,a$t,"dataSource",a$k.prototype._$get_dataSource,function(a$t){"number"==typeof(this._dataSource=a$t)||"string"==typeof a$t?this.value=Number(a$t):a$R.superSet(a$z,this,"dataSource",a$t)}),a$v}(a$z),a$B=(function(a$t){function a$v(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,a$v.__super.call(this),this._tipBox=new a$z,this._tipBox.addChild(this._tipText=new a$X),this._tipText.x=this._tipText.y=5,this._tipText.color=a$v.tipTextColor,this._defaultTipHandler=this._showDefaultTip,a$R.stage.on("showtip",this,this._onStageShowTip),a$R.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}a$u(a$v,"laya.ui.TipManager",a$z);var a$k=a$v.prototype;a$k._onStageHideTip=function(a$t){a$R.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},a$k._onStageShowTip=function(a$t){a$R.timer.once(a$v.tipDelay,this,this._showTip,[a$t],!0)},a$k._showTip=function(a$t){if("string"==typeof a$t){var a$k=String(a$t);Boolean(a$k)&&this._defaultTipHandler(a$k)}else a$t instanceof laya.utils.Handler?a$t.run():"function"==typeof a$t&&a$t.apply();a$R.stage.on("mousemove",this,this._onStageMouseMove),a$R.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},a$k._onStageMouseDown=function(a$t){this.closeAll()},a$k._onStageMouseMove=function(a$t){this._showToStage(this,a$v.offsetX,a$v.offsetY)},a$k._showToStage=function(a$t,a$k,a$v){void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0);var a$j=a$t.getBounds();a$t.x=a$R.stage.mouseX+a$k,a$t.y=a$R.stage.mouseY+a$v,a$t.x+a$j.width>a$R.stage.width&&(a$t.x-=a$j.width+a$k),a$t.y+a$j.height>a$R.stage.height&&(a$t.y-=a$j.height+a$v)},a$k.closeAll=function(){a$R.timer.clear(this,this._showTip),a$R.stage.off("mousemove",this,this._onStageMouseMove),a$R.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},a$k.showDislayTip=function(a$t){this.addChild(a$t),this._showToStage(this),a$R._currentStage.addChild(this)},a$k._showDefaultTip=function(a$t){this._tipText.text=a$t;var a$k=this._tipBox.graphics;a$k.clear(),a$k.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,a$v.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),a$R._currentStage.addChild(this)},a$Q(0,a$k,"defaultTipHandler",function(){return this._defaultTipHandler},function(a$t){this._defaultTipHandler=a$t}),a$v.offsetX=10,a$v.offsetY=15,a$v.tipTextColor="#ffffff",a$v.tipBackColor="#111111",a$v.tipDelay=200}(),function(a$t){var a$E;function a$A(){this._idMap=null,this._aniList=null,this._watchMap={},a$A.__super.call(this)}a$u(a$A,"laya.ui.View",a$c);var a$k=a$A.prototype;return a$k.createView=function(a$t){if(a$t.animations&&!this._idMap&&(this._idMap={}),a$A.createComp(a$t,this,this),a$t.animations){var a$k,a$v,a$j=[],a$Q=a$t.animations,a$u=0,a$S=a$Q.length;for(a$u=0;a$u<a$S;a$u++){switch(a$k=new a$w,a$v=a$Q[a$u],a$k._setUp(this._idMap,a$v),(this[a$v.name]=a$k)._setControlNode(this),a$v.action){case 1:a$k.play(0,!1);break;case 2:a$k.play(0,!0)}a$j.push(a$k)}this._aniList=a$j}0<this._width&&null==a$t.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},a$k.onEvent=function(a$t,a$k){},a$k.loadUI=function(a$t){var a$k=a$A.uiMap[a$t];a$k&&this.createView(a$k)},a$k.destroy=function(a$t){void 0===a$t&&(a$t=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,a$t)},a$k.changeData=function(a$t){var a$k=this._watchMap[a$t];if(a$k){console.log("change",a$t);for(var a$v=0,a$j=a$k.length;a$v<a$j;a$v++){a$k[a$v].exe(this)}}},a$A._regs=function(){for(var a$t in a$A.uiClassMap)a$h.regClass(a$t,a$A.uiClassMap[a$t])},a$A.createComp=function(a$t,a$k,a$v,a$j){if(!(a$k=a$k||a$A.getCompInstance(a$t)))return console.warn("can not create:"+a$t.type),null;var a$Q=a$t.child;if(a$Q)for(var a$u=a$k instanceof laya.ui.List,a$S=0,a$V=a$Q.length;a$S<a$V;a$S++){var a$J=a$Q[a$S];if(!a$k.hasOwnProperty("itemRender")||"render"!=a$J.props.name&&"render"!==a$J.props.renderType)if("Graphic"==a$J.type)a$h.addGraphicsToSprite(a$J,a$k);else if(a$h.isDrawType(a$J.type))a$h.addGraphicToSprite(a$J,a$k,!0);else{if(a$u){var a$W=[],a$w=a$A.createComp(a$J,null,a$v,a$W);a$W.length&&(a$w._$bindData=a$W)}else a$w=a$A.createComp(a$J,null,a$v,a$j);"Script"==a$J.type?"owner"in a$w?a$w.owner=a$k:"target"in a$w&&(a$w.target=a$k):"mask"==a$J.props.renderType||"mask"==a$J.props.name?a$k.mask=a$w:a$w instanceof laya.display.Sprite&&a$k.addChild(a$w)}else a$k.itemRender=a$J}var a$M=a$t.props;for(var a$H in a$M){var a$E=a$M[a$H];a$A.eventDic[a$H]?a$E&&a$v&&a$k.on(a$H,a$v,a$v.onEvent,[a$E]):a$A.setCompValue(a$k,a$H,a$E,a$v,a$j)}return a$R.__typeof(a$k,"laya.ui.IItem")&&a$k.initItems(),a$t.compId&&a$v&&a$v._idMap&&(a$v._idMap[a$t.compId]=a$k),a$k},a$A.setCompValue=function(a$t,a$k,a$v,a$j,a$Q){if("string"==typeof a$v&&-1<a$v.indexOf("${")){if(a$A._sheet||(a$A._sheet=a$h.getClass("laya.data.Table")),!a$A._sheet)return void console.warn("Can not find class Sheet");if(a$Q)a$Q.push(a$t,a$k,a$v);else if(a$j){-1==a$v.indexOf("].")&&(a$v=a$v.replace(".","[0]."));var a$u,a$S,a$V=new a$E(a$t,a$k,a$v);a$V.exe(a$j);for(var a$J=a$v.replace(/\[.*?\]\./g,".");null!=(a$u=a$A._parseWatchData.exec(a$J));){for(var a$W=a$u[1];null!=(a$S=a$A._parseKeyWord.exec(a$W));){var a$w=a$S[0],a$M=a$j._watchMap[a$w]||(a$j._watchMap[a$w]=[]);a$M.push(a$V),a$A._sheet.I.notifer.on(a$w,a$j,a$j.changeData,[a$w])}(a$M=a$j._watchMap[a$W]||(a$j._watchMap[a$W]=[])).push(a$V),a$A._sheet.I.notifer.on(a$W,a$j,a$j.changeData,[a$W])}}}else if("var"===a$k&&a$j)a$j[a$v]=a$t;else if("onClick"==a$k){var a$H=a$R._runScript("(function(){"+a$v+"})");a$t.on("click",a$j,a$H)}else a$t[a$k]="true"===a$v||"false"!==a$v&&a$v},a$A.getCompInstance=function(a$t){var a$k,a$v=a$t.props?a$t.props.runtime:null;return a$k=a$v?a$A.viewClassMap[a$v]||a$A.uiClassMap[a$v]||a$R.__classmap[a$v]:a$A.uiClassMap[a$t.type],a$t.props&&a$t.props.hasOwnProperty("renderType")&&"instance"==a$t.props.renderType?a$k.instance:a$k?new a$k:null},a$A.regComponent=function(a$t,a$k){a$A.uiClassMap[a$t]=a$k,a$h.regClass(a$t,a$k)},a$A.regViewRuntime=function(a$t,a$k){a$A.viewClassMap[a$t]=a$k},a$A.uiMap={},a$A.viewClassMap={},a$A._sheet=null,a$j(a$A,["uiClassMap",function(){return this.uiClassMap={ViewStack:a$tt,LinkButton:a$T,TextArea:a$Wt,ColorPicker:a$O,Box:a$c,Button:a$T,CheckBox:a$b,Clip:a$p,ComboBox:a$n,Component:a$z,HScrollBar:a$e,HSlider:a$g,Image:a$I,Label:a$i,List:a$L,Panel:a$r,ProgressBar:a$D,Radio:a$y,RadioGroup:a$Vt,ScrollBar:a$_,Slider:a$x,Tab:a$Jt,TextInput:a$vt,View:a$A,VScrollBar:a$kt,VSlider:a$jt,Tree:a$P,HBox:a$ut,VBox:a$St,Sprite:a$f,Animation:a$v,Text:a$X,FontClip:a$C}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),a$A.__init$=function(){a$A._regs(),a$E=function(){function a$t(a$t,a$k,a$v){this.comp=null,this.prop=null,this.value=null,this.comp=a$t,this.prop=a$k,this.value=a$v}return a$u(a$t,""),a$t.prototype.exe=function(a$t){var a$k=a$U.getBindFun(this.value);this.comp[this.prop]=a$k.call(this,a$t)},a$t}()},a$A}()),a$b=function(a$t){function a$v(a$t,a$k){void 0===a$k&&(a$k=""),a$v.__super.call(this,a$t,a$k)}a$u(a$v,"laya.ui.CheckBox",a$t);var a$k=a$v.prototype;return a$k.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},a$k.initialize=function(){a$t.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},a$Q(0,a$k,"dataSource",a$t.prototype._$get_dataSource,function(a$t){"boolean"==typeof(this._dataSource=a$t)?this.selected=a$t:"string"==typeof a$t?this.selected="true"===a$t:a$R.superSet(a$T,this,"dataSource",a$t)}),a$v}(a$T),a$q=function(a$t){function a$k(){this._space=0,this._align="none",this._itemChanged=!1,a$k.__super.call(this)}a$u(a$k,"laya.ui.LayoutBox",a$c);var a$v=a$k.prototype;return a$v.addChild=function(a$t){return a$t.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,a$t)},a$v.onResize=function(a$t){this._setItemChanged()},a$v.addChildAt=function(a$t,a$k){return a$t.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,a$t,a$k)},a$v.removeChild=function(a$t){return a$t.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,a$t)},a$v.removeChildAt=function(a$t){return this.getChildAt(a$t).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,a$t)},a$v.refresh=function(){this._setItemChanged()},a$v.changeItems=function(){this._itemChanged=!1},a$v.sortItem=function(a$t){a$t&&a$t.sort(function(a$t,a$k){return a$t.y-a$k.y})},a$v._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},a$Q(0,a$v,"space",function(){return this._space},function(a$t){this._space=a$t,this._setItemChanged()}),a$Q(0,a$v,"align",function(){return this._align},function(a$t){this._align=a$t,this._setItemChanged()}),a$k}(),a$C=function(a$k){function a$v(a$t,a$k){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,a$v.__super.call(this),a$t&&(this.skin=a$t),a$k&&(this.sheet=a$k)}a$u(a$v,"laya.ui.FontClip",a$k);var a$t=a$v.prototype;return a$t.createChildren=function(){this._bitmap=new a$a,this.on("loaded",this,this._onClipLoaded)},a$t._onClipLoaded=function(){this.callLater(this.changeValue)},a$t.changeValue=function(){var a$t;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),a$t=this._sources[0]))){var a$k="horizontal"===this._direction;a$k?(this._wordsW=this._valueArr.length*(a$t.sourceWidth+this.spaceX),this._wordsH=a$t.sourceHeight):(this._wordsW=a$t.sourceWidth,this._wordsH=(a$t.sourceHeight+this.spaceY)*this._valueArr.length);var a$v=0;if(this._width)switch(this._align){case"center":a$v=.5*(this._width-this._wordsW);break;case"right":a$v=this._width-this._wordsW;break;default:a$v=0}for(var a$j=0,a$Q=this._valueArr.length;a$j<a$Q;a$j++){var a$u=this._indexMap[this._valueArr.charAt(a$j)];this.sources[a$u]&&(a$t=this.sources[a$u],a$k?this.graphics.drawTexture(a$t,a$v+a$j*(a$t.sourceWidth+this.spaceX),0,a$t.sourceWidth,a$t.sourceHeight):this.graphics.drawTexture(a$t,0+a$v,a$j*(a$t.sourceHeight+this.spaceY),a$t.sourceWidth,a$t.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),a$k.prototype.destroy.call(this,a$t)},a$Q(0,a$t,"sheet",function(){return this._sheet},function(a$t){a$t+="";var a$k=(this._sheet=a$t).split(" ");this._clipX=String(a$k[0]).length,this.clipY=a$k.length,this._indexMap={};for(var a$v=0;a$v<this._clipY;a$v++)for(var a$j=a$k[a$v].split(""),a$Q=0,a$u=a$j.length;a$Q<a$u;a$Q++)this._indexMap[a$j[a$Q]]=a$v*this._clipX+a$Q}),a$Q(0,a$t,"height",a$k.prototype._$get_height,function(a$t){a$R.superSet(a$p,this,"height",a$t),this.callLater(this.changeValue)}),a$Q(0,a$t,"direction",function(){return this._direction},function(a$t){this._direction=a$t,this.callLater(this.changeValue)}),a$Q(0,a$t,"value",function(){return this._valueArr?this._valueArr:""},function(a$t){a$t+="",this._valueArr=a$t,this.callLater(this.changeValue)}),a$Q(0,a$t,"width",a$k.prototype._$get_width,function(a$t){a$R.superSet(a$p,this,"width",a$t),this.callLater(this.changeValue)}),a$Q(0,a$t,"spaceX",function(){return this._spaceX},function(a$t){this._spaceX=a$t,"horizontal"===this._direction&&this.callLater(this.changeValue)}),a$Q(0,a$t,"spaceY",function(){return this._spaceY},function(a$t){this._spaceY=a$t,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),a$Q(0,a$t,"align",function(){return this._align},function(a$t){this._align=a$t,this.callLater(this.changeValue)}),a$Q(0,a$t,"measureWidth",function(){return this._wordsW}),a$Q(0,a$t,"measureHeight",function(){return this._wordsH}),a$v}(a$p),a$L=function(a$t){function a$k(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new a$A,a$k.__super.call(this)}a$u(a$k,"laya.ui.List",a$t);var a$v=a$k.prototype;return a$R.imps(a$v,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),a$v.destroy=function(a$t){void 0===a$t&&(a$t=!0),this._content&&this._content.destroy(a$t),this._scrollBar&&this._scrollBar.destroy(a$t),laya.ui.Component.prototype.destroy.call(this,a$t),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},a$v.createChildren=function(){this.addChild(this._content=new a$c)},a$v.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=a$R.superGet(a$c,this,"cacheAs")),a$R.superSet(a$c,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},a$v.onScrollEnd=function(){a$R.superSet(a$c,this,"cacheAs",this._$P.cacheAs)},a$v._removePreScrollBar=function(){var a$t=this.removeChildByName("scrollBar");a$t&&a$t.destroy(!0)},a$v.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var a$t=this._getOneCell(),a$k=a$t.width+this._spaceX||1,a$v=a$t.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/a$k):Math.ceil(this._width/a$k)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/a$v):Math.round(this._height/a$v));var a$j=this._width?this._width:a$k*this.repeatX-this._spaceX,a$Q=this._height?this._height:a$v*this.repeatY-this._spaceY;this._cellSize=this._isVertical?a$v:a$k,this._cellOffset=this._isVertical?a$v*Math.max(this._repeatY2,this._repeatY)-a$Q-this._spaceY:a$k*Math.max(this._repeatX2,this._repeatX)-a$j-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=a$Q:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=a$j),this.setContentSize(a$j,a$Q);var a$u=this._isVertical?this.repeatX:this.repeatY,a$S=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,a$u,a$S),this._createdLine=a$S,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},a$v._getOneCell=function(){if(0===this._cells.length){var a$t=this.createItem();if(this._offset.setTo(a$t.x,a$t.y),this.cacheContent)return a$t;this._cells.push(a$t)}return this._cells[0]},a$v._createItems=function(a$t,a$k,a$v){var a$j=this._content,a$Q=this._getOneCell(),a$u=a$Q.width+this._spaceX,a$S=a$Q.height+this._spaceY;if(this.cacheContent){var a$V=new a$c;a$V.cacheAsBitmap=!0,a$V.pos((this._isVertical?0:a$t)*a$u,(this._isVertical?a$t:0)*a$S),this._content.addChild(a$V),this._content.optimizeScrollRect=!0,a$j=a$V}else{for(var a$J=[],a$W=this._cells.length-1;-1<a$W;a$W--){var a$w=this._cells[a$W];a$w.removeSelf(),a$J.push(a$w)}this._cells.length=0}for(var a$M=a$t;a$M<a$v;a$M++)for(var a$H=0;a$H<a$k;a$H++)(a$Q=a$J&&a$J.length?a$J.pop():this.createItem()).x=(this._isVertical?a$H:a$M)*a$u-a$j.x,a$Q.y=(this._isVertical?a$M:a$H)*a$S-a$j.y,a$Q.name="item"+(a$M*a$k+a$H),a$j.addChild(a$Q),this.addCell(a$Q)},a$v.createItem=function(){var a$t=[];if("function"==typeof this._itemRender)var a$k=new this._itemRender;else a$k=a$B.createComp(this._itemRender,null,null,a$t);if(0==a$t.length&&a$k._watchMap){var a$v=a$k._watchMap;for(var a$j in a$v)for(var a$Q=a$v[a$j],a$u=0;a$u<a$Q.length;a$u++){var a$S=a$Q[a$u];a$t.push(a$S.comp,a$S.prop,a$S.value)}}return a$t.length&&(a$k._$bindData=a$t),a$k},a$v.addCell=function(a$t){a$t.on("click",this,this.onCellMouse),a$t.on("rightclick",this,this.onCellMouse),a$t.on("mouseover",this,this.onCellMouse),a$t.on("mouseout",this,this.onCellMouse),a$t.on("mousedown",this,this.onCellMouse),a$t.on("mouseup",this,this.onCellMouse),this._cells.push(a$t)},a$v.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var a$t=0,a$k=a$t=0;a$k<1e4;a$k++){var a$v=this.getChildByName("item"+a$k);if(!a$v)break;this.addCell(a$v),a$t++}this.repeatY=a$t}},a$v.setContentSize=function(a$t,a$k){this._content.width=a$t,this._content.height=a$k,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new a$l),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,a$t,a$k),this._content.scrollRect=this._content.scrollRect),this.event("resize")},a$v.onCellMouse=function(a$t){"mousedown"===a$t.type&&(this._isMoved=!1);var a$k=a$t.currentTarget,a$v=this._startIndex+this._cells.indexOf(a$k);a$v<0||("click"===a$t.type||"rightclick"===a$t.type?this.selectEnable&&!this._isMoved?this.selectedIndex=a$v:this.changeCellState(a$k,!0,0):"mouseover"!==a$t.type&&"mouseout"!==a$t.type||this._selectedIndex===a$v||this.changeCellState(a$k,"mouseover"===a$t.type,0),this.mouseHandler&&this.mouseHandler.runWith([a$t,a$v]))},a$v.changeCellState=function(a$t,a$k,a$v){var a$j=a$t.getChildByName("selectBox");a$j&&(this.selectEnable=!0,a$j.visible=a$k,a$j.index=a$v)},a$v.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},a$v.onScrollBarChange=function(a$t){this.runCallLater(this.changeCells);var a$k=this._scrollBar.value,a$v=this._isVertical?this.repeatX:this.repeatY,a$j=this._isVertical?this.repeatY:this.repeatX,a$Q=Math.floor(a$k/this._cellSize);if(this.cacheContent)a$S=a$j+1,this._createdLine-a$Q<a$S&&(this._createItems(this._createdLine,a$v,this._createdLine+a$S),this.renderItems(this._createdLine*a$v,0),this._createdLine+=a$S);else{var a$u=a$Q*a$v,a$S=0;if(a$u>this._startIndex){a$S=a$u-this._startIndex;var a$V=!0,a$J=this._startIndex+a$v*(a$j+1);this._isMoved=!0}else a$u<this._startIndex&&(a$S=this._startIndex-a$u,a$V=!1,a$J=this._startIndex-1,this._isMoved=!0);for(var a$W=0;a$W<a$S;a$W++){if(a$V){var a$w=this._cells.shift();this._cells[this._cells.length]=a$w;var a$M=a$J+a$W}else a$w=this._cells.pop(),this._cells.unshift(a$w),a$M=a$J-a$W;var a$H=Math.floor(a$M/a$v)*this._cellSize;this._isVertical?a$w.y=a$H:a$w.x=a$H,this.renderItem(a$w,a$M)}this._startIndex=a$u,this.changeSelectStatus()}var a$E=this._content.scrollRect;this._isVertical?(a$E.y=a$k-this._offset.y,a$E.x=-this._offset.x):(a$E.y=-this._offset.y,a$E.x=a$k-this._offset.x),this._content.scrollRect=a$E},a$v.posCell=function(a$t,a$k){if(this._scrollBar){var a$v=this._isVertical?this.repeatX:this.repeatY,a$j=(this._isVertical?this.repeatY:this.repeatX,Math.floor(a$k/a$v)*this._cellSize);this._isVertical?a$t.y=a$j:a$t.x=a$j}},a$v.changeSelectStatus=function(){for(var a$t=0,a$k=this._cells.length;a$t<a$k;a$t++)this.changeCellState(this._cells[a$t],this._selectedIndex===this._startIndex+a$t,1)},a$v.renderItems=function(a$t,a$k){void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0);for(var a$v=a$t,a$j=a$k||this._cells.length;a$v<a$j;a$v++)this.renderItem(this._cells[a$v],this._startIndex+a$v);this.changeSelectStatus()},a$v.renderItem=function(a$t,a$k){this._array&&0<=a$k&&a$k<this._array.length?(a$t.visible=!0,a$t._$bindData?(a$t._dataSource=this._array[a$k],this._bindData(a$t,this._array[a$k])):a$t.dataSource=this._array[a$k],this.cacheContent||this.posCell(a$t,a$k),this.hasListener("render")&&this.event("render",[a$t,a$k]),this.renderHandler&&this.renderHandler.runWith([a$t,a$k])):(a$t.visible=!1,a$t.dataSource=null)},a$v._bindData=function(a$t,a$k){for(var a$v=a$t._$bindData,a$j=0,a$Q=a$v.length;a$j<a$Q;a$j++){var a$u=a$v[a$j++],a$S=a$v[a$j++],a$V=a$v[a$j],a$J=a$U.getBindFun(a$V);a$u[a$S]=a$J.call(this,a$k)}},a$v.refresh=function(){this.array=this._array},a$v.getItem=function(a$t){return-1<a$t&&a$t<this._array.length?this._array[a$t]:null},a$v.changeItem=function(a$t,a$k){-1<a$t&&a$t<this._array.length&&(this._array[a$t]=a$k,a$t>=this._startIndex&&a$t<this._startIndex+this._cells.length&&this.renderItem(this.getCell(a$t),a$t))},a$v.setItem=function(a$t,a$k){this.changeItem(a$t,a$k)},a$v.addItem=function(a$t){this._array.push(a$t),this.array=this._array},a$v.addItemAt=function(a$t,a$k){this._array.splice(a$k,0,a$t),this.array=this._array},a$v.deleteItem=function(a$t){this._array.splice(a$t,1),this.array=this._array},a$v.getCell=function(a$t){return this.runCallLater(this.changeCells),-1<a$t&&this._cells?this._cells[(a$t-this._startIndex)%this._cells.length]:null},a$v.scrollTo=function(a$t){if(this._scrollBar){var a$k=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(a$t/a$k)*this._cellSize}else this.startIndex=a$t},a$v.tweenTo=function(a$t,a$k,a$v){if(void 0===a$k&&(a$k=200),this._scrollBar){var a$j=this._isVertical?this.repeatX:this.repeatY;a$d.to(this._scrollBar,{value:Math.floor(a$t/a$j)*this._cellSize},a$k,null,a$v,0,!0)}else this.startIndex=a$t,a$v&&a$v.run()},a$v._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},a$v.commitMeasure=function(){this.runCallLater(this.changeCells)},a$Q(0,a$v,"cacheAs",a$t.prototype._$get_cacheAs,function(a$t){a$R.superSet(a$c,this,"cacheAs",a$t),this._scrollBar&&(this._$P.cacheAs=null,"none"!==a$t?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),a$Q(0,a$v,"content",function(){return this._content}),a$Q(0,a$v,"height",a$t.prototype._$get_height,function(a$t){a$t!=this._height&&(a$R.superSet(a$c,this,"height",a$t),this._setCellChanged())}),a$Q(0,a$v,"itemRender",function(){return this._itemRender},function(a$t){if(this._itemRender!=a$t){this._itemRender=a$t;for(var a$k=this._cells.length-1;-1<a$k;a$k--)this._cells[a$k].destroy();this._cells.length=0,this._setCellChanged()}}),a$Q(0,a$v,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(a$t){this._removePreScrollBar();var a$k=new a$kt;a$k.name="scrollBar",a$k.right=0,a$t&&" "!=a$t&&(a$k.skin=a$t),this.scrollBar=a$k,this.addChild(a$k),this._setCellChanged()}),a$Q(0,a$v,"page",function(){return this._page},function(a$t){this._page=a$t,this._array&&(this._page=0<a$t?a$t:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),a$Q(0,a$v,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(a$t){this._removePreScrollBar();var a$k=new a$e;a$k.name="scrollBar",a$k.bottom=0,a$t&&" "!=a$t&&(a$k.skin=a$t),this.scrollBar=a$k,this.addChild(a$k),this._setCellChanged()}),a$Q(0,a$v,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(a$t){this._repeatX=a$t,this._setCellChanged()}),a$Q(0,a$v,"scrollBar",function(){return this._scrollBar},function(a$t){this._scrollBar!=a$t&&(this._scrollBar=a$t)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),a$Q(0,a$v,"width",a$t.prototype._$get_width,function(a$t){a$t!=this._width&&(a$R.superSet(a$c,this,"width",a$t),this._setCellChanged())}),a$Q(0,a$v,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(a$t){this._repeatY=a$t,this._setCellChanged()}),a$Q(0,a$v,"spaceX",function(){return this._spaceX},function(a$t){this._spaceX=a$t,this._setCellChanged()}),a$Q(0,a$v,"spaceY",function(){return this._spaceY},function(a$t){this._spaceY=a$t,this._setCellChanged()}),a$Q(0,a$v,"selectedIndex",function(){return this._selectedIndex},function(a$t){this._selectedIndex!=a$t&&(this._selectedIndex=a$t,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(a$t),this.startIndex=this._startIndex)}),a$Q(0,a$v,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(a$t){this.selectedIndex=this._array.indexOf(a$t)}),a$Q(0,a$v,"length",function(){return this._array?this._array.length:0}),a$Q(0,a$v,"selection",function(){return this.getCell(this._selectedIndex)},function(a$t){this.selectedIndex=this._startIndex+this._cells.indexOf(a$t)}),a$Q(0,a$v,"startIndex",function(){return this._startIndex},function(a$t){this._startIndex=0<a$t?a$t:0,this.callLater(this.renderItems)}),a$Q(0,a$v,"array",function(){return this._array},function(a$t){this.runCallLater(this.changeCells),this._array=a$t||[];var a$k=this._array.length;if(this.totalPage=Math.ceil(a$k/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<a$k?this._selectedIndex:a$k-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var a$v=this._isVertical?this.repeatX:this.repeatY,a$j=this._isVertical?this.repeatY:this.repeatX,a$Q=Math.ceil(a$k/a$v);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=a$j/a$Q,this._scrollBar.setScroll(0,(a$Q-a$j)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),a$Q(0,a$v,"dataSource",a$t.prototype._$get_dataSource,function(a$t){"number"==typeof(this._dataSource=a$t)&&Math.floor(a$t)==a$t||"string"==typeof a$t?this.selectedIndex=parseInt(a$t):a$t instanceof Array?this.array=a$t:a$R.superSet(a$c,this,"dataSource",a$t)}),a$Q(0,a$v,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),a$k}(a$c),a$e=function(a$t){function a$k(){a$k.__super.call(this)}return a$u(a$k,"laya.ui.HScrollBar",a$t),a$k.prototype.initialize=function(){a$t.prototype.initialize.call(this),this.slider.isVertical=!1},a$k}(a$_),a$r=function(a$t){function a$k(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,a$k.__super.call(this),this.width=this.height=100}a$u(a$k,"laya.ui.Panel",a$t);var a$v=a$k.prototype;return a$v.destroy=function(a$t){void 0===a$t&&(a$t=!0),laya.ui.Component.prototype.destroy.call(this,a$t),this._content&&this._content.destroy(a$t),this._vScrollBar&&this._vScrollBar.destroy(a$t),this._hScrollBar&&this._hScrollBar.destroy(a$t),this._vScrollBar=null,this._hScrollBar=null,this._content=null},a$v.destroyChildren=function(){this._content.destroyChildren()},a$v.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new a$c)},a$v.addChild=function(a$t){return a$t.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(a$t)},a$v.onResize=function(){this._setScrollChanged()},a$v.addChildAt=function(a$t,a$k){return a$t.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(a$t,a$k)},a$v.removeChild=function(a$t){return a$t.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(a$t)},a$v.removeChildAt=function(a$t){return this.getChildAt(a$t).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(a$t)},a$v.removeChildren=function(a$t,a$k){return void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=2147483647),this._content.removeChildren(a$t,a$k),this._setScrollChanged(),this},a$v.getChildAt=function(a$t){return this._content.getChildAt(a$t)},a$v.getChildByName=function(a$t){return this._content.getChildByName(a$t)},a$v.getChildIndex=function(a$t){return this._content.getChildIndex(a$t)},a$v.changeScroll=function(){this._scrollChanged=!1;var a$t=this.contentWidth||1,a$k=this.contentHeight||1,a$v=this._vScrollBar,a$j=this._hScrollBar,a$Q=a$v&&a$k>this._height,a$u=a$j&&a$t>this._width,a$S=a$Q?this._width-a$v.width:this._width,a$V=a$u?this._height-a$j.height:this._height;a$v&&(a$v.x=this._width-a$v.width,a$v.y=0,a$v.height=this._height-(a$u?a$j.height:0),a$v.scrollSize=Math.max(.033*this._height,1),a$v.thumbPercent=a$V/a$k,a$v.setScroll(0,a$k-a$V,a$v.value)),a$j&&(a$j.x=0,a$j.y=this._height-a$j.height,a$j.width=this._width-(a$Q?a$v.width:0),a$j.scrollSize=Math.max(.033*this._width,1),a$j.thumbPercent=a$S/a$t,a$j.setScroll(0,a$t-a$S,a$j.value))},a$v.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},a$v.setContentSize=function(a$t,a$k){var a$v=this._content;a$v.width=a$t,a$v.height=a$k,a$v.scrollRect||(a$v.scrollRect=new a$l),a$v.scrollRect.setTo(0,0,a$t,a$k),a$v.scrollRect=a$v.scrollRect},a$v.onScrollBarChange=function(a$t){var a$k=this._content.scrollRect;if(a$k){var a$v=Math.round(a$t.value);a$t.isVertical?a$k.y=a$v:a$k.x=a$v,this._content.scrollRect=a$k}},a$v.scrollTo=function(a$t,a$k){void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),this.vScrollBar&&(this.vScrollBar.value=a$k),this.hScrollBar&&(this.hScrollBar.value=a$t)},a$v.refresh=function(){this.changeScroll()},a$v.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=a$R.superGet(a$c,this,"cacheAs")),a$R.superSet(a$c,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},a$v.onScrollEnd=function(){a$R.superSet(a$c,this,"cacheAs",this._$P.cacheAs)},a$v._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},a$Q(0,a$v,"numChildren",function(){return this._content.numChildren}),a$Q(0,a$v,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(a$t){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new a$e),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=a$t}),a$Q(0,a$v,"contentWidth",function(){for(var a$t=0,a$k=this._content.numChildren-1;-1<a$k;a$k--){var a$v=this._content.getChildAt(a$k);a$t=Math.max(a$v.x+a$v.width*a$v.scaleX,a$t)}return a$t}),a$Q(0,a$v,"contentHeight",function(){for(var a$t=0,a$k=this._content.numChildren-1;-1<a$k;a$k--){var a$v=this._content.getChildAt(a$k);a$t=Math.max(a$v.y+a$v.height*a$v.scaleY,a$t)}return a$t}),a$Q(0,a$v,"width",a$t.prototype._$get_width,function(a$t){a$R.superSet(a$c,this,"width",a$t),this._setScrollChanged()}),a$Q(0,a$v,"hScrollBar",function(){return this._hScrollBar}),a$Q(0,a$v,"content",function(){return this._content}),a$Q(0,a$v,"height",a$t.prototype._$get_height,function(a$t){a$R.superSet(a$c,this,"height",a$t),this._setScrollChanged()}),a$Q(0,a$v,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(a$t){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new a$kt),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=a$t}),a$Q(0,a$v,"vScrollBar",function(){return this._vScrollBar}),a$Q(0,a$v,"cacheAs",a$t.prototype._$get_cacheAs,function(a$t){a$R.superSet(a$c,this,"cacheAs",a$t),this._$P.cacheAs=null,"none"!==a$t?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),a$k}(a$c),a$g=function(a$t){function a$k(a$t){a$k.__super.call(this,a$t),this.isVertical=!1}return a$u(a$k,"laya.ui.HSlider",a$x),a$k}(),a$$=function(a$t){function a$v(a$t,a$k){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,a$v.__super.call(this),this.skin=a$k,this.labels=a$t}a$u(a$v,"laya.ui.UIGroup",a$t);var a$k=a$v.prototype;return a$R.imps(a$k,{"laya.ui.IItem":!0}),a$k.preinitialize=function(){this.mouseEnabled=!0},a$k.destroy=function(a$t){void 0===a$t&&(a$t=!0),laya.ui.Component.prototype.destroy.call(this,a$t),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},a$k.addItem=function(a$t,a$k){void 0===a$k&&(a$k=!0);var a$v=a$t,a$j=this._items.length;if(a$v.name="item"+a$j,this.addChild(a$v),this.initItems(),a$k&&0<a$j){var a$Q=this._items[a$j-1];"horizontal"==this._direction?a$v.x=a$Q.x+a$Q.width+this._space:a$v.y=a$Q.y+a$Q.height+this._space}else a$k&&(a$v.x=0,a$v.y=0);return a$j},a$k.delItem=function(a$t,a$k){void 0===a$k&&(a$k=!0);var a$v=this._items.indexOf(a$t);if(-1!=a$v){var a$j=a$t;this.removeChild(a$j);for(var a$Q=a$v+1,a$u=this._items.length;a$Q<a$u;a$Q++){var a$S=this._items[a$Q];a$S.name="item"+(a$Q-1),a$k&&("horizontal"==this._direction?a$S.x-=a$j.width+this._space:a$S.y-=a$j.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var a$V;a$V=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=a$V}}},a$k.initItems=function(){this._items||(this._items=[]);for(var a$t=this._items.length=0;a$t<1e4;a$t++){var a$k=this.getChildByName("item"+a$t);if(null==a$k)break;this._items.push(a$k),a$k.selected=a$t===this._selectedIndex,a$k.clickHandler=a$H.create(this,this.itemClick,[a$t],!1)}},a$k.itemClick=function(a$t){this.selectedIndex=a$t},a$k.setSelect=function(a$t,a$k){this._items&&-1<a$t&&a$t<this._items.length&&(this._items[a$t].selected=a$k)},a$k.createItem=function(a$t,a$k){return null},a$k.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var a$t=0,a$k=0,a$v=this._items.length;a$k<a$v;a$k++){var a$j=this._items[a$k];this._skin&&(a$j.skin=this._skin),this._labelColors&&(a$j.labelColors=this._labelColors),this._labelSize&&(a$j.labelSize=this._labelSize),this._labelStroke&&(a$j.labelStroke=this._labelStroke),this._labelStrokeColor&&(a$j.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(a$j.strokeColors=this._strokeColors),this._labelBold&&(a$j.labelBold=this._labelBold),this._labelPadding&&(a$j.labelPadding=this._labelPadding),this._labelAlign&&(a$j.labelAlign=this._labelAlign),this._stateNum&&(a$j.stateNum=this._stateNum),this._labelFont&&(a$j.labelFont=this._labelFont),"horizontal"===this._direction?(a$j.y=0,a$j.x=a$t,a$t+=a$j.width+this._space):(a$j.x=0,a$j.y=a$t,a$t+=a$j.height+this._space)}this.changeSize()},a$k.commitMeasure=function(){this.runCallLater(this.changeLabels)},a$k._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},a$Q(0,a$k,"labelStrokeColor",function(){return this._labelStrokeColor},function(a$t){this._labelStrokeColor!=a$t&&(this._labelStrokeColor=a$t,this._setLabelChanged())}),a$Q(0,a$k,"skin",function(){return this._skin},function(a$t){this._skin!=a$t&&(this._skin=a$t,this._setLabelChanged())}),a$Q(0,a$k,"selectedIndex",function(){return this._selectedIndex},function(a$t){this._selectedIndex!=a$t&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=a$t,this.setSelect(a$t,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),a$Q(0,a$k,"labels",function(){return this._labels},function(a$t){if(this._labels!=a$t){if(this._labels=a$t,this.removeChildren(),this._setLabelChanged(),this._labels)for(var a$k=this._labels.split(","),a$v=0,a$j=a$k.length;a$v<a$j;a$v++){var a$Q=this.createItem(this._skin,a$k[a$v]);a$Q.name="item"+a$v,this.addChild(a$Q)}this.initItems()}}),a$Q(0,a$k,"strokeColors",function(){return this._strokeColors},function(a$t){this._strokeColors!=a$t&&(this._strokeColors=a$t,this._setLabelChanged())}),a$Q(0,a$k,"labelColors",function(){return this._labelColors},function(a$t){this._labelColors!=a$t&&(this._labelColors=a$t,this._setLabelChanged())}),a$Q(0,a$k,"labelStroke",function(){return this._labelStroke},function(a$t){this._labelStroke!=a$t&&(this._labelStroke=a$t,this._setLabelChanged())}),a$Q(0,a$k,"labelSize",function(){return this._labelSize},function(a$t){this._labelSize!=a$t&&(this._labelSize=a$t,this._setLabelChanged())}),a$Q(0,a$k,"stateNum",function(){return this._stateNum},function(a$t){this._stateNum!=a$t&&(this._stateNum=a$t,this._setLabelChanged())}),a$Q(0,a$k,"labelBold",function(){return this._labelBold},function(a$t){this._labelBold!=a$t&&(this._labelBold=a$t,this._setLabelChanged())}),a$Q(0,a$k,"labelFont",function(){return this._labelFont},function(a$t){this._labelFont!=a$t&&(this._labelFont=a$t,this._setLabelChanged())}),a$Q(0,a$k,"labelPadding",function(){return this._labelPadding},function(a$t){this._labelPadding!=a$t&&(this._labelPadding=a$t,this._setLabelChanged())}),a$Q(0,a$k,"direction",function(){return this._direction},function(a$t){this._direction=a$t,this._setLabelChanged()}),a$Q(0,a$k,"space",function(){return this._space},function(a$t){this._space=a$t,this._setLabelChanged()}),a$Q(0,a$k,"items",function(){return this._items}),a$Q(0,a$k,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(a$t){this.selectedIndex=this._items.indexOf(a$t)}),a$Q(0,a$k,"dataSource",a$t.prototype._$get_dataSource,function(a$t){"number"==typeof(this._dataSource=a$t)&&Math.floor(a$t)==a$t||"string"==typeof a$t?this.selectedIndex=parseInt(a$t):a$t instanceof Array?this.labels=a$t.join(","):a$R.superSet(a$c,this,"dataSource",a$t)}),a$v}(a$c),a$y=function(a$k){function a$v(a$t,a$k){this._value=null,void 0===a$k&&(a$k=""),a$v.__super.call(this,a$t,a$k)}a$u(a$v,"laya.ui.Radio",a$k);var a$t=a$v.prototype;return a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,a$t),this._value=null},a$t.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},a$t.initialize=function(){a$k.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},a$t.onClick=function(a$t){this.selected=!0},a$Q(0,a$t,"value",function(){return null!=this._value?this._value:this.label},function(a$t){this._value=a$t}),a$v}(a$T),a$P=function(a$t){function a$k(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,a$k.__super.call(this),this.width=this.height=200}a$u(a$k,"laya.ui.Tree",a$t);var a$v=a$k.prototype;return a$R.imps(a$v,{"laya.ui.IRender":!0}),a$v.destroy=function(a$t){void 0===a$t&&(a$t=!0),laya.ui.Component.prototype.destroy.call(this,a$t),this._list&&this._list.destroy(a$t),this._list=null,this._source=null,this._renderHandler=null},a$v.createChildren=function(){this.addChild(this._list=new a$L),this._list.renderHandler=a$H.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},a$v.onListChange=function(a$t){this.event("change")},a$v.getArray=function(){var a$t,a$k=[];for(var a$v in this._source)a$t=this._source[a$v],this.getParentOpenStatus(a$t)&&(a$t.x=this._spaceLeft*this.getDepth(a$t),a$k.push(a$t));return a$k},a$v.getDepth=function(a$t,a$k){return void 0===a$k&&(a$k=0),null==a$t.nodeParent?a$k:this.getDepth(a$t.nodeParent,a$k+1)},a$v.getParentOpenStatus=function(a$t){var a$k=a$t.nodeParent;return null==a$k||!!a$k.isOpen&&(null==a$k.nodeParent||this.getParentOpenStatus(a$k))},a$v.renderItem=function(a$t,a$k){var a$v=a$t.dataSource;if(a$v){a$t.left=a$v.x;var a$j=a$t.getChildByName("arrow");a$j&&(a$v.hasChild?(a$j.visible=!0,a$j.index=a$v.isOpen?1:0,a$j.tag=a$k,a$j.off("click",this,this.onArrowClick),a$j.on("click",this,this.onArrowClick)):a$j.visible=!1);var a$Q=a$t.getChildByName("folder");a$Q&&(2==a$Q.clipY?a$Q.index=a$v.isDirectory?0:1:a$Q.index=a$v.isDirectory?a$v.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([a$t,a$k])}},a$v.onArrowClick=function(a$t){var a$k=a$t.currentTarget.tag;this._list.array[a$k].isOpen=!this._list.array[a$k].isOpen,this.event("open"),this._list.array=this.getArray()},a$v.setItemState=function(a$t,a$k){this._list.array[a$t]&&(this._list.array[a$t].isOpen=a$k,this._list.array=this.getArray())},a$v.fresh=function(){this._list.array=this.getArray(),this.repaint()},a$v.parseXml=function(a$t,a$k,a$v,a$j){var a$Q,a$u=a$t.childNodes,a$S=a$u.length;if(!a$j){a$Q={};var a$V,a$J=a$t.attributes;for(var a$W in a$J){var a$w=(a$V=a$J[a$W]).nodeName,a$M=a$V.nodeValue;a$Q[a$w]="true"==a$M||"false"!=a$M&&a$M}a$Q.nodeParent=a$v,0<a$S&&(a$Q.isDirectory=!0),a$Q.hasChild=0<a$S,a$k.push(a$Q)}for(var a$H=0;a$H<a$S;a$H++){var a$E=a$u[a$H];this.parseXml(a$E,a$k,a$Q,!1)}},a$v.parseOpenStatus=function(a$t,a$k){for(var a$v=0,a$j=a$k.length;a$v<a$j;a$v++){var a$Q=a$k[a$v];if(a$Q.isDirectory)for(var a$u=0,a$S=a$t.length;a$u<a$S;a$u++){var a$V=a$t[a$u];if(a$V.isDirectory&&this.isSameParent(a$V,a$Q)&&a$Q.label==a$V.label){a$Q.isOpen=a$V.isOpen;break}}}},a$v.isSameParent=function(a$t,a$k){return null==a$t.nodeParent&&null==a$k.nodeParent||null!=a$t.nodeParent&&null!=a$k.nodeParent&&(a$t.nodeParent.label==a$k.nodeParent.label&&this.isSameParent(a$t.nodeParent,a$k.nodeParent))},a$v.filter=function(a$t){if(Boolean(a$t)){var a$k=[];this.getFilterSource(this._source,a$k,a$t),this._list.array=a$k}else this._list.array=this.getArray()},a$v.getFilterSource=function(a$t,a$k,a$v){var a$j;for(var a$Q in a$v=a$v.toLocaleLowerCase(),a$t)!(a$j=a$t[a$Q]).isDirectory&&-1<String(a$j.label).toLowerCase().indexOf(a$v)&&(a$j.x=0,a$k.push(a$j)),a$j.child&&0<a$j.child.length&&this.getFilterSource(a$j.child,a$k,a$v)},a$Q(0,a$v,"spaceBottom",function(){return this._list.spaceY},function(a$t){this._list.spaceY=a$t}),a$Q(0,a$v,"keepStatus",function(){return this._keepStatus},function(a$t){this._keepStatus=a$t}),a$Q(0,a$v,"itemRender",function(){return this._list.itemRender},function(a$t){this._list.itemRender=a$t}),a$Q(0,a$v,"array",function(){return this._list.array},function(a$t){this._keepStatus&&this._list.array&&a$t&&this.parseOpenStatus(this._list.array,a$t),this._source=a$t,this._list.array=this.getArray()}),a$Q(0,a$v,"mouseHandler",function(){return this._list.mouseHandler},function(a$t){this._list.mouseHandler=a$t}),a$Q(0,a$v,"dataSource",a$t.prototype._$get_dataSource,function(a$t){this._dataSource=a$t,a$R.superSet(a$c,this,"dataSource",a$t)}),a$Q(0,a$v,"source",function(){return this._source}),a$Q(0,a$v,"scrollBar",function(){return this._list.scrollBar}),a$Q(0,a$v,"list",function(){return this._list}),a$Q(0,a$v,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(a$t){this._list.vScrollBarSkin=a$t}),a$Q(0,a$v,"renderHandler",function(){return this._renderHandler},function(a$t){this._renderHandler=a$t}),a$Q(0,a$v,"selectedIndex",function(){return this._list.selectedIndex},function(a$t){this._list.selectedIndex=a$t}),a$Q(0,a$v,"spaceLeft",function(){return this._spaceLeft},function(a$t){this._spaceLeft=a$t}),a$Q(0,a$v,"selectedItem",function(){return this._list.selectedItem},function(a$t){this._list.selectedItem=a$t}),a$Q(0,a$v,"width",a$t.prototype._$get_width,function(a$t){a$R.superSet(a$c,this,"width",a$t),this._list.width=a$t}),a$Q(0,a$v,"height",a$t.prototype._$get_height,function(a$t){a$R.superSet(a$c,this,"height",a$t),this._list.height=a$t}),a$Q(0,a$v,"xml",null,function(a$t){var a$k=[];this.parseXml(a$t.childNodes[0],a$k,null,!0),this.array=a$k}),a$Q(0,a$v,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),a$k}(a$c),a$tt=function(a$t){function a$k(){this._items=null,this._selectedIndex=0,a$k.__super.call(this),this._setIndexHandler=a$H.create(this,this.setIndex,null,!1)}a$u(a$k,"laya.ui.ViewStack",a$t);var a$v=a$k.prototype;return a$R.imps(a$v,{"laya.ui.IItem":!0}),a$v.setItems=function(a$t){this.removeChildren();for(var a$k=0,a$v=0,a$j=a$t.length;a$v<a$j;a$v++){var a$Q=a$t[a$v];a$Q&&(a$Q.name="item"+a$k,this.addChild(a$Q),a$k++)}this.initItems()},a$v.addItem=function(a$t){a$t.name="item"+this._items.length,this.addChild(a$t),this.initItems()},a$v.initItems=function(){this._items=[];for(var a$t=0;a$t<1e4;a$t++){var a$k=this.getChildByName("item"+a$t);if(null==a$k)break;this._items.push(a$k),a$k.visible=a$t==this._selectedIndex}},a$v.setSelect=function(a$t,a$k){this._items&&-1<a$t&&a$t<this._items.length&&(this._items[a$t].visible=a$k)},a$v.setIndex=function(a$t){this.selectedIndex=a$t},a$Q(0,a$v,"dataSource",a$t.prototype._$get_dataSource,function(a$t){if("number"==typeof(this._dataSource=a$t)&&Math.floor(a$t)==a$t||"string"==typeof a$t)this.selectedIndex=parseInt(a$t);else for(var a$k in this._dataSource)this.hasOwnProperty(a$k)&&(this[a$k]=this._dataSource[a$k])}),a$Q(0,a$v,"selectedIndex",function(){return this._selectedIndex},function(a$t){this._selectedIndex!=a$t&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=a$t,this.setSelect(this._selectedIndex,!0))}),a$Q(0,a$v,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(a$t){this.selectedIndex=this._items.indexOf(a$t)}),a$Q(0,a$v,"items",function(){return this._items}),a$Q(0,a$v,"setIndexHandler",function(){return this._setIndexHandler},function(a$t){this._setIndexHandler=a$t}),a$k}(a$c),a$kt=function(a$t){function a$k(){a$k.__super.call(this)}return a$u(a$k,"laya.ui.VScrollBar",a$_),a$k}(),a$vt=function(a$k){function a$v(a$t){this._bg=null,this._skin=null,a$v.__super.call(this),void 0===a$t&&(a$t=""),this.text=a$t,this.skin=this.skin}a$u(a$v,"laya.ui.TextInput",a$k);var a$t=a$v.prototype;return a$t.preinitialize=function(){this.mouseEnabled=!0},a$t.destroy=function(a$t){a$o.clearCache(this,this._skin),void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,a$t),this._bg&&this._bg.destroy(),this._bg=null},a$t.createChildren=function(){this.addChild(this._tf=new a$E),this._tf.padding=a$K.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},a$t._onFocus=function(){this.event("focus",this)},a$t._onBlur=function(){this.event("blur",this)},a$t._onInput=function(){this.event("input",this)},a$t._onEnter=function(){this.event("enter",this)},a$t.initialize=function(){this.width=128,this.height=22},a$t.select=function(){this._tf.select()},a$t.setSelection=function(a$t,a$k){this._tf.setSelection(a$t,a$k)},a$Q(0,a$t,"text",a$k.prototype._$get_text,function(a$t){this._tf.text!=a$t&&(a$t+="",this._tf.text=a$t,this.event("change"))}),a$Q(0,a$t,"bg",function(){return this._bg},function(a$t){this.graphics=this._bg=a$t}),a$Q(0,a$t,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(a$t){this._tf.inputElementYAdjuster=a$t}),a$Q(0,a$t,"multiline",function(){return this._tf.multiline},function(a$t){this._tf.multiline=a$t}),a$Q(0,a$t,"skin",function(){return this._skin},function(a$t){this._skin!=a$t&&(a$o.clearCache(this,this._skin),this._skin=a$t,this._bg||(this.graphics=this._bg=new a$a),a$o.keepCache(this,this._skin),this._bg.source=a$o.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),a$Q(0,a$t,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(a$t){this._bg||(this.graphics=this._bg=new a$a),this._bg.sizeGrid=a$U.fillArray(a$K.defaultSizeGrid,a$t,Number)}),a$Q(0,a$t,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(a$t){this._tf.inputElementXAdjuster=a$t}),a$Q(0,a$t,"width",a$k.prototype._$get_width,function(a$t){a$R.superSet(a$i,this,"width",a$t),this._bg&&(this._bg.width=a$t)}),a$Q(0,a$t,"height",a$k.prototype._$get_height,function(a$t){a$R.superSet(a$i,this,"height",a$t),this._bg&&(this._bg.height=a$t)}),a$Q(0,a$t,"editable",function(){return this._tf.editable},function(a$t){this._tf.editable=a$t}),a$Q(0,a$t,"restrict",function(){return this._tf.restrict},function(a$t){this._tf.restrict=a$t}),a$Q(0,a$t,"prompt",function(){return this._tf.prompt},function(a$t){this._tf.prompt=a$t}),a$Q(0,a$t,"promptColor",function(){return this._tf.promptColor},function(a$t){this._tf.promptColor=a$t}),a$Q(0,a$t,"maxChars",function(){return this._tf.maxChars},function(a$t){this._tf.maxChars=a$t}),a$Q(0,a$t,"focus",function(){return this._tf.focus},function(a$t){this._tf.focus=a$t}),a$Q(0,a$t,"type",function(){return this._tf.type},function(a$t){this._tf.type=a$t}),a$Q(0,a$t,"asPassword",function(){return this._tf.asPassword},function(a$t){this._tf.asPassword=a$t}),a$v}(a$i),a$jt=function(a$t){function a$k(){a$k.__super.call(this)}return a$u(a$k,"laya.ui.VSlider",a$x),a$k}(),a$Qt=function(a$t){function a$j(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,a$j.__super.call(this)}a$u(a$j,"laya.ui.Dialog",a$t);var a$k=a$j.prototype;return a$k.initialize=function(){this.popupEffect=a$j.manager.popupEffectHandler,this.closeEffect=a$j.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},a$k._dealDragArea=function(){var a$t=this.getChildByName("drag");a$t&&(this.dragArea=a$t.x+","+a$t.y+","+a$t.width+","+a$t.height,a$t.removeSelf())},a$k._onClick=function(a$t){var a$k=a$t.target;if(a$k)switch(a$k.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(a$k.name)}},a$k.show=function(a$t,a$k){void 0===a$t&&(a$t=!1),void 0===a$k&&(a$k=!0),this._open(!1,a$t,a$k)},a$k.popup=function(a$t,a$k){void 0===a$t&&(a$t=!1),void 0===a$k&&(a$k=!0),this._open(!0,a$t,a$k)},a$k._open=function(a$t,a$k,a$v){a$j.manager.lock(!1),this.isModal=a$t,a$j.manager.open(this,a$k,a$v)},a$k.onOpened=function(){},a$k.close=function(a$t,a$k){void 0===a$k&&(a$k=!0),a$j.manager.close(this,a$t,a$k)},a$k.onClosed=function(a$t){},a$k._onMouseDown=function(a$t){var a$k=this.getMousePoint();this._dragArea.contains(a$k.x,a$k.y)?this.startDrag():this.stopDrag()},a$Q(0,a$k,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(a$t){if(a$t){var a$k=a$U.fillArray([0,0,0,0],a$t,Number);this._dragArea=new a$l(a$k[0],a$k[1],a$k[2],a$k[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),a$Q(0,a$k,"isPopup",function(){return null!=this.parent}),a$Q(0,a$k,"zOrder",a$t.prototype._$get_zOrder,function(a$t){a$R.superSet(a$B,this,"zOrder",a$t),a$j.manager._checkMask()}),a$Q(1,a$j,"manager",function(){return a$j._manager=a$j._manager||new a$G},function(a$t){a$j._manager=a$t}),a$j.setLockView=function(a$t){a$j.manager.setLockView(a$t)},a$j.lock=function(a$t){a$j.manager.lock(a$t)},a$j.closeAll=function(){a$j.manager.closeAll()},a$j.getDialogsByGroup=function(a$t){return a$j.manager.getDialogsByGroup(a$t)},a$j.closeByGroup=function(a$t){return a$j.manager.closeByGroup(a$t)},a$j.CLOSE="close",a$j.CANCEL="cancel",a$j.SURE="sure",a$j.NO="no",a$j.OK="ok",a$j.YES="yes",a$j._manager=null,a$j}(a$B),a$ut=function(a$t){function a$k(){a$k.__super.call(this)}a$u(a$k,"laya.ui.HBox",a$t);var a$v=a$k.prototype;return a$v.sortItem=function(a$t){a$t&&a$t.sort(function(a$t,a$k){return a$t.x-a$k.x})},a$v.changeItems=function(){this._itemChanged=!1;for(var a$t=[],a$k=0,a$v=0,a$j=this.numChildren;a$v<a$j;a$v++){var a$Q=this.getChildAt(a$v);a$Q&&a$Q.layoutEnabled&&(a$t.push(a$Q),a$k=this._height?this._height:Math.max(a$k,a$Q.height*a$Q.scaleY))}this.sortItem(a$t);var a$u=0;for(a$v=0,a$j=a$t.length;a$v<a$j;a$v++)(a$Q=a$t[a$v]).x=a$u,a$u+=a$Q.width*a$Q.scaleX+this._space,"top"==this._align?a$Q.y=0:"middle"==this._align?a$Q.y=.5*(a$k-a$Q.height*a$Q.scaleY):"bottom"==this._align&&(a$Q.y=a$k-a$Q.height*a$Q.scaleY);this.changeSize()},a$Q(0,a$v,"height",a$t.prototype._$get_height,function(a$t){this._height!=a$t&&(a$R.superSet(a$q,this,"height",a$t),this.callLater(this.changeItems))}),a$k.NONE="none",a$k.TOP="top",a$k.MIDDLE="middle",a$k.BOTTOM="bottom",a$k}(a$q),a$St=function(a$t){function a$k(){a$k.__super.call(this)}a$u(a$k,"laya.ui.VBox",a$t);var a$v=a$k.prototype;return a$v.changeItems=function(){this._itemChanged=!1;for(var a$t=[],a$k=0,a$v=0,a$j=this.numChildren;a$v<a$j;a$v++){var a$Q=this.getChildAt(a$v);a$Q&&a$Q.layoutEnabled&&(a$t.push(a$Q),a$k=this._width?this._width:Math.max(a$k,a$Q.width*a$Q.scaleX))}this.sortItem(a$t);var a$u=0;for(a$v=0,a$j=a$t.length;a$v<a$j;a$v++)(a$Q=a$t[a$v]).y=a$u,a$u+=a$Q.height*a$Q.scaleY+this._space,"left"==this._align?a$Q.x=0:"center"==this._align?a$Q.x=.5*(a$k-a$Q.width*a$Q.scaleX):"right"==this._align&&(a$Q.x=a$k-a$Q.width*a$Q.scaleX);this.changeSize()},a$Q(0,a$v,"width",a$t.prototype._$get_width,function(a$t){this._width!=a$t&&(a$R.superSet(a$q,this,"width",a$t),this.callLater(this.changeItems))}),a$k.NONE="none",a$k.LEFT="left",a$k.CENTER="center",a$k.RIGHT="right",a$k}(a$q),a$Vt=function(a$t){function a$k(){a$k.__super.call(this)}return a$u(a$k,"laya.ui.RadioGroup",a$$),a$k.prototype.createItem=function(a$t,a$k){return new a$y(a$t,a$k)},a$k}(),a$Jt=function(a$t){function a$k(){a$k.__super.call(this)}return a$u(a$k,"laya.ui.Tab",a$$),a$k.prototype.createItem=function(a$t,a$k){return new a$T(a$t,a$k)},a$k}(),a$Wt=function(a$k){function a$v(a$t){this._vScrollBar=null,this._hScrollBar=null,void 0===a$t&&(a$t=""),a$v.__super.call(this,a$t)}a$u(a$v,"laya.ui.TextArea",a$k);var a$t=a$v.prototype;return a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,a$t),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},a$t.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},a$t.onVBarChanged=function(a$t){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},a$t.onHBarChanged=function(a$t){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},a$t.changeScroll=function(){var a$t=this._vScrollBar&&0<this._tf.maxScrollY,a$k=this._hScrollBar&&0<this._tf.maxScrollX,a$v=a$t?this._width-this._vScrollBar.width:this._width,a$j=a$k?this._height-this._hScrollBar.height:this._height,a$Q=this._tf.padding||a$K.labelPadding;this._tf.width=a$v,this._tf.height=a$j,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-a$Q[2],this._vScrollBar.y=a$Q[1],this._vScrollBar.height=this._height-(a$k?this._hScrollBar.height:0)-a$Q[1]-a$Q[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=a$j/Math.max(this._tf.textHeight,a$j),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=a$t),this._hScrollBar&&(this._hScrollBar.x=a$Q[0],this._hScrollBar.y=this._height-this._hScrollBar.height-a$Q[3],this._hScrollBar.width=this._width-(a$t?this._vScrollBar.width:0)-a$Q[0]-a$Q[2],this._hScrollBar.scrollSize=Math.max(.033*a$v,1),this._hScrollBar.thumbPercent=a$v/Math.max(this._tf.textWidth,a$v),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=a$k)},a$t.scrollTo=function(a$t){this.commitMeasure(),this._tf.scrollY=a$t},a$Q(0,a$t,"scrollY",function(){return this._tf.scrollY}),a$Q(0,a$t,"width",a$k.prototype._$get_width,function(a$t){a$R.superSet(a$vt,this,"width",a$t),this.callLater(this.changeScroll)}),a$Q(0,a$t,"hScrollBar",function(){return this._hScrollBar}),a$Q(0,a$t,"height",a$k.prototype._$get_height,function(a$t){a$R.superSet(a$vt,this,"height",a$t),this.callLater(this.changeScroll)}),a$Q(0,a$t,"maxScrollX",function(){return this._tf.maxScrollX}),a$Q(0,a$t,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(a$t){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new a$kt),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=a$t}),a$Q(0,a$t,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(a$t){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new a$e),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=a$t}),a$Q(0,a$t,"vScrollBar",function(){return this._vScrollBar}),a$Q(0,a$t,"maxScrollY",function(){return this._tf.maxScrollY}),a$Q(0,a$t,"scrollX",function(){return this._tf.scrollX}),a$v}(a$vt);!function(a$t){function a$k(){this._uiView=null,this.isCloseOther=!1,a$k.__super.call(this)}a$u(a$k,"laya.ui.AsynDialog",a$Qt);var a$v=a$k.prototype;a$v.createView=function(a$t){this._uiView=a$t},a$v._open=function(a$t,a$k,a$v){this.isModal=a$t,this.isCloseOther=a$k,a$Qt.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},a$v.onCreated=function(){this.createUI(),this.onOpen()},a$v.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},a$v.onOpen=function(){a$Qt.manager.open(this,this.isCloseOther),a$Qt.manager.lock(!1)},a$v.close=function(a$t,a$k){void 0===a$k&&(a$k=!0),a$Qt.manager.close(this),this.onClose()},a$v.onClose=function(){},a$v.destroy=function(a$t){void 0===a$t&&(a$t=!0),laya.ui.View.prototype.destroy.call(this,a$t),this._uiView=null,this.onDestroy()},a$v.onDestroy=function(){}}();a$R.__init([a$B])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(a$t,a$k){"use strict";for(var a$v in Object.defineProperty(a$k,"__esModule",{value:!0}),Laya){var a$j=Laya[a$v];a$j&&a$j.__isclass&&(a$k[a$v]=a$j)}}),function(a$H,a$t,a$X){a$X.un,a$X.uns;var a$M=a$X.static,a$E=a$X.class,a$A=a$X.getset,a$j=a$X.__newvec,a$f=laya.maths.Arith,a$S=laya.webgl.atlas.AtlasResourceManager,a$v=laya.webgl.shader.BaseShader,a$z=laya.utils.Browser,a$V=laya.webgl.utils.Buffer,a$F=laya.utils.Byte,a$Q=laya.utils.ClassUtils,a$J=a$X.Config,a$u=(laya.events.Event,laya.events.EventDispatcher),a$K=laya.utils.Handler,a$l=laya.net.Loader,a$k=laya.net.LoaderManager,a$W=(laya.maths.MathUtil,laya.display.Node),a$R=laya.renders.Render,a$w=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),a$h=laya.resource.Resource,a$o=laya.utils.RunDriver,a$Y=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),a$d=laya.display.Sprite,a$m=laya.utils.Stat,a$Z=laya.utils.StringKey,a$U=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),a$s=laya.utils.Utils,a$N=laya.webgl.WebGL,a$a=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;a$X.interface("laya.d3.core.IClone"),a$X.interface("laya.d3.graphics.IVertex"),a$X.interface("laya.d3.core.render.IUpdate"),a$X.interface("laya.d3.core.scene.ITreeNode"),a$X.interface("laya.d3.core.render.IRenderable");(function(){function a$T(){}a$E(a$T,"laya.d3.animation.AnimationClipParser01"),a$T.READ_DATA=function(){a$T._DATA.offset=a$T._reader.getUint32(),a$T._DATA.size=a$T._reader.getUint32()},a$T.READ_BLOCK=function(){for(var a$t=a$T._BLOCK.count=a$T._reader.getUint16(),a$k=a$T._BLOCK.blockStarts=[],a$v=a$T._BLOCK.blockLengths=[],a$j=0;a$j<a$t;a$j++)a$k.push(a$T._reader.getUint32()),a$v.push(a$T._reader.getUint32())},a$T.READ_STRINGS=function(){var a$t=a$T._reader.getUint32(),a$k=a$T._reader.getUint16(),a$v=a$T._reader.pos;a$T._reader.pos=a$t+a$T._DATA.offset;for(var a$j=0;a$j<a$k;a$j++)a$T._strings[a$j]=a$T._reader.readUTFString();a$T._reader.pos=a$v},a$T.parse=function(a$t,a$k){a$T._animationClip=a$t;(a$T._reader=a$k).__getBuffer();a$T.READ_DATA(),a$T.READ_BLOCK(),a$T.READ_STRINGS();for(var a$v=0,a$j=a$T._BLOCK.count;a$v<a$j;a$v++){var a$Q=a$k.getUint16(),a$u=a$T._strings[a$Q],a$S=a$T["READ_"+a$u];if(null==a$S)throw new Error("model file err,no this function:"+a$Q+" "+a$u);a$S.call()}},a$T.READ_ANIMATIONS=function(){var a$t,a$k=0,a$v=0,a$j=a$T._reader,a$Q=a$j.__getBuffer(),a$u=[],a$S=a$j.getUint8();for(a$u.length=a$S,a$k=0;a$k<a$S;a$k++)a$u[a$k]=a$j.getUint16();var a$V=[],a$J=a$j.getUint16();for(a$V.length=a$J,a$k=0;a$k<a$J;a$k++)a$V[a$k]=a$j.getFloat32();var a$W=a$T._animationClip;a$W.name=a$T._strings[a$j.getUint16()];var a$w=a$W._duration=a$j.getFloat32();a$W.islooping=!!a$j.getByte(),a$W._frameRate=a$j.getInt16();var a$M=a$j.getInt16(),a$H=a$W._nodes=new Array;a$H.length=a$M,(a$W._publicClipDatas=[]).length=a$M;var a$E=a$W._nodesMap={},a$A=0,a$R=0;for(a$k=0;a$k<a$M;a$k++){a$t=a$H[a$k]=new a$D;var a$h=a$j.getUint16(),a$l=a$t.path=[];for(a$l.length=a$h,a$v=0;a$v<a$h;a$v++)a$l[a$v]=a$T._strings[a$j.getUint16()];var a$o=a$l.join("/"),a$Y=a$E[a$o];a$Y||(a$E[a$o]=a$Y=[]),a$Y.push(a$t);var a$f=a$j.getInt16();-1!==a$f&&(a$t.componentType=a$T._strings[a$f]);var a$X=a$I._propertyIndexDic[a$T._strings[a$j.getUint16()]];if(null==a$X)throw new Error("AnimationClipParser01:unknown property name.");var a$F=a$X<4,a$d=!a$F||a$F&&""===a$l[0];(a$t._cacheProperty=a$d)?a$A++:a$R++,a$t.propertyNameID=a$X;var a$m=a$u[a$j.getUint8()];a$t.keyFrameWidth=a$m/4;var a$Z=a$t.keyFrames=[],a$s=a$Z.length=a$j.getUint16(),a$K=null,a$U=NaN;for(a$v=0;a$v<a$s;a$v++){var a$N=a$Z[a$v]=new a$i;a$U=a$N.startTime=a$V[a$j.getUint16()];var a$a=a$j.pos;a$N.inTangent=new Float32Array(a$Q.slice(a$a,a$a+a$m)),a$j.pos+=a$m,a$a=a$j.pos,a$N.outTangent=new Float32Array(a$Q.slice(a$a,a$a+a$m)),a$j.pos+=a$m,a$a=a$j.pos,a$N.data=new Float32Array(a$Q.slice(a$a,a$a+a$m)),a$j.pos+=a$m,a$K&&(a$K.next=a$N,a$K.duration=a$U-a$K.startTime),a$K=a$N}a$N.next=null,a$N.duration=a$w-a$U}var a$z=a$W._nodeToCachePropertyMap=new Int32Array(a$M),a$G=a$W._cachePropertyMap=new Int32Array(a$A),a$c=a$W._unCachePropertyMap=new Int32Array(a$R);for(a$A=a$R=0,a$k=0;a$k<a$M;a$k++)(a$t=a$H[a$k])._cacheProperty?(a$z[a$k]=a$A,a$G[a$A++]=a$k):a$c[a$R++]=a$k},a$T._animationClip=null,a$T._reader=null,a$T._strings=[],a$M(a$T,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function a$_(){}a$E(a$_,"laya.d3.animation.AnimationClipParser02"),a$_.READ_DATA=function(){a$_._DATA.offset=a$_._reader.getUint32(),a$_._DATA.size=a$_._reader.getUint32()},a$_.READ_BLOCK=function(){for(var a$t=a$_._BLOCK.count=a$_._reader.getUint16(),a$k=a$_._BLOCK.blockStarts=[],a$v=a$_._BLOCK.blockLengths=[],a$j=0;a$j<a$t;a$j++)a$k.push(a$_._reader.getUint32()),a$v.push(a$_._reader.getUint32())},a$_.READ_STRINGS=function(){var a$t=a$_._reader.getUint32(),a$k=a$_._reader.getUint16(),a$v=a$_._reader.pos;a$_._reader.pos=a$t+a$_._DATA.offset;for(var a$j=0;a$j<a$k;a$j++)a$_._strings[a$j]=a$_._reader.readUTFString();a$_._reader.pos=a$v},a$_.parse=function(a$t,a$k){a$_._animationClip=a$t;(a$_._reader=a$k).__getBuffer();a$_.READ_DATA(),a$_.READ_BLOCK(),a$_.READ_STRINGS();for(var a$v=0,a$j=a$_._BLOCK.count;a$v<a$j;a$v++){var a$Q=a$k.getUint16(),a$u=a$_._strings[a$Q],a$S=a$_["READ_"+a$u];if(null==a$S)throw new Error("model file err,no this function:"+a$Q+" "+a$u);a$S.call()}},a$_.READ_ANIMATIONS=function(){var a$t,a$k=0,a$v=0,a$j=a$_._reader,a$Q=a$j.__getBuffer(),a$u=[],a$S=a$j.getUint8();for(a$u.length=a$S,a$k=0;a$k<a$S;a$k++)a$u[a$k]=a$j.getUint16();var a$V=[],a$J=a$j.getUint16();for(a$V.length=a$J,a$k=0;a$k<a$J;a$k++)a$V[a$k]=a$j.getFloat32();var a$W=a$_._animationClip;a$W.name=a$_._strings[a$j.getUint16()];var a$w=a$W._duration=a$j.getFloat32();a$W.islooping=!!a$j.getByte(),a$W._frameRate=a$j.getInt16();var a$M=a$j.getInt16(),a$H=a$W._nodes=new Array;a$H.length=a$M,(a$W._publicClipDatas=[]).length=a$M;var a$E=a$W._nodesMap={},a$A=0,a$R=0;for(a$k=0;a$k<a$M;a$k++){a$t=a$H[a$k]=new a$D;var a$h=a$j.getUint16(),a$l=a$t.path=[];for(a$l.length=a$h,a$v=0;a$v<a$h;a$v++)a$l[a$v]=a$_._strings[a$j.getUint16()];var a$o=a$l.join("/"),a$Y=a$E[a$o];a$Y||(a$E[a$o]=a$Y=[]),a$Y.push(a$t);var a$f=a$j.getInt16();-1!==a$f&&(a$t.componentType=a$_._strings[a$f]);var a$X=a$I._propertyIndexDic[a$_._strings[a$j.getUint16()]];if(null==a$X)throw new Error("AnimationClipParser02:unknown property name.");var a$F=a$X<4,a$d=!a$F||a$F&&""===a$l[0];(a$t._cacheProperty=a$d)?a$A++:a$R++,a$t.propertyNameID=a$X;var a$m=a$u[a$j.getUint8()];a$t.keyFrameWidth=a$m/4;var a$Z=a$t.keyFrames=[],a$s=a$Z.length=a$j.getUint16(),a$K=null,a$U=NaN;for(a$v=0;a$v<a$s;a$v++){var a$N=a$Z[a$v]=new a$i;a$U=a$N.startTime=a$V[a$j.getUint16()];var a$a=a$j.pos;a$N.inTangent=new Float32Array(a$Q.slice(a$a,a$a+a$m)),a$j.pos+=a$m,a$a=a$j.pos,a$N.outTangent=new Float32Array(a$Q.slice(a$a,a$a+a$m)),a$j.pos+=a$m,a$a=a$j.pos,a$N.data=new Float32Array(a$Q.slice(a$a,a$a+a$m)),a$j.pos+=a$m,a$K&&(a$K.next=a$N,a$K.duration=a$U-a$K.startTime),a$K=a$N}a$N.next=null,a$N.duration=a$w-a$U}var a$z=a$j.getUint16();for(a$k=0;a$k<a$z;a$k++){var a$G,a$c=new a$x;a$c.time=a$j.getFloat32(),a$c.eventName=a$_._strings[a$j.getUint16()];var a$T=a$j.getUint16();for(0<a$T&&(a$c.params=a$G=[]),a$v=0;a$v<a$T;a$v++){switch(a$j.getByte()){case 0:a$G.push(!!a$j.getByte());break;case 1:a$G.push(a$j.getInt32());break;case 2:a$G.push(a$j.getFloat32());break;case 3:a$G.push(a$_._strings[a$j.getUint16()]);break;default:throw new Error("unknown type.")}}a$W.addEvent(a$c)}var a$p=a$W._nodeToCachePropertyMap=new Int32Array(a$M),a$O=a$W._cachePropertyMap=new Int32Array(a$A),a$n=a$W._unCachePropertyMap=new Int32Array(a$R);for(a$A=a$R=0,a$k=0;a$k<a$M;a$k++)(a$t=a$H[a$k])._cacheProperty?(a$p[a$k]=a$A,a$O[a$A++]=a$k):a$n[a$R++]=a$k},a$_._animationClip=null,a$_._reader=null,a$_._strings=[],a$M(a$_,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var a$x=function(){function a$t(){this.time=NaN,this.eventName=null,this.params=null}return a$E(a$t,"laya.d3.animation.AnimationEvent"),a$t}(),a$I=function(){function a$j(){this._childs=[],this.transform=new a$ok(this)}a$E(a$j,"laya.d3.animation.AnimationNode");var a$t=a$j.prototype;return a$X.imps(a$t,{"laya.d3.core.IClone":!0}),a$t.addChild=function(a$t){a$t._parent=this,a$t.transform.setParent(this.transform),this._childs.push(a$t)},a$t.removeChild=function(a$t){var a$k=this._childs.indexOf(a$t);-1!==a$k&&this._childs.splice(a$k,1)},a$t.getChildByName=function(a$t){for(var a$k=0,a$v=this._childs.length;a$k<a$v;a$k++){var a$j=this._childs[a$k];if(a$j.name===a$t)return a$j}return null},a$t.getChildByIndex=function(a$t){return this._childs[a$t]},a$t.getChildCount=function(){return this._childs.length},a$t.cloneTo=function(a$t){var a$k=a$t;a$k.name=this.name;for(var a$v=0,a$j=this._childs.length;a$v<a$j;a$v++){var a$Q=this._childs[a$v],a$u=a$Q.clone();a$k.addChild(a$u);var a$S=a$Q.transform,a$V=a$u.transform;a$V.setLocalPosition(a$S.getLocalPosition()),a$V.setLocalRotation(a$S.getLocalRotation()),a$V.setLocalScale(a$S.getLocalScale()),a$V._localRotationEuler=a$S._localRotationEuler,a$V._setWorldMatrixIgnoreUpdate(a$S.getWorldMatrix())}},a$t.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$j.__init__=function(){a$j.registerAnimationNodeProperty("localPosition",a$j._getLocalPosition,a$j._setLocalPosition),a$j.registerAnimationNodeProperty("localRotation",a$j._getLocalRotation,a$j._setLocalRotation),a$j.registerAnimationNodeProperty("localScale",a$j._getLocalScale,a$j._setLocalScale),a$j.registerAnimationNodeProperty("localRotationEuler",a$j._getLocalRotationEuler,a$j._setLocalRotationEuler),a$j.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",a$j._getParticleRenderSharedMaterialTintColor,a$j._setParticleRenderSharedMaterialTintColor),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",a$j._getMeshRenderSharedMaterialTilingOffset,a$j._setMeshRenderSharedMaterialTilingOffset),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",a$j._getMeshRenderSharedMaterialAlbedo,a$j._setMeshRenderSharedMaterialAlbedo),a$j.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",a$j._getSkinnedMeshRenderSharedMaterialTilingOffset,a$j._setSkinnedMeshRenderSharedMaterialTilingOffset),a$j.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",a$j._getSkinnedMeshRenderSharedMaterialAlbedo,a$j._setSkinnedMeshRenderSharedMaterialAlbedo),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",a$j._getMeshRenderSharedMaterialAlbedo,a$j._setMeshRenderSharedMaterialAlbedo),a$j.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",a$j._getSkinnedMeshRenderSharedMaterialAlbedo,a$j._setSkinnedMeshRenderSharedMaterialAlbedo),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",a$j._getMeshRenderSharedMaterialIntensity,a$j._setMeshRenderSharedMaterialIntensity),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",a$j._getMeshRenderSharedMaterialAlpha,a$j._setMeshRenderSharedMaterialAlpha),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",a$j._getMeshRenderSharedMaterialAlphaColor,a$j._setMeshRenderSharedMaterialAlphaColor),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",a$j._getMeshRenderSharedMaterialBaseColor,a$j._setMeshRenderSharedMaterialBaseColor),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",a$j._getMeshRenderSharedMaterialDissolve,a$j._setMeshRenderSharedMaterialDissolve),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",a$j._getMeshRenderSharedMaterialDissolveSpeed,a$j._setMeshRenderSharedMaterialDissolveSpeed),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",a$j._getMeshRenderSharedMaterialMMultiplier,a$j._setMeshRenderSharedMaterialMMultiplier),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",a$j._getMeshRenderSharedMaterialBaseScrollSpeedX,a$j._setMeshRenderSharedMaterialBaseScrollSpeedX),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",a$j._getMeshRenderSharedMaterialBaseScrollSpeedY,a$j._setMeshRenderSharedMaterialBaseScrollSpeedY),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",a$j._getMeshRenderSharedMaterialSecondScrollSpeedX,a$j._setMeshRenderSharedMaterialSecondScrollSpeedX),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",a$j._getMeshRenderSharedMaterialSecondScrollSpeedY,a$j._setMeshRenderSharedMaterialSecondScrollSpeedY),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",a$j._getMeshRenderSharedMaterialDetailTilingOffset,a$j._setMeshRenderSharedMaterialDetailTilingOffset),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",a$j._getMeshRenderSharedMaterialDissolveTilingOffset,a$j._setMeshRenderSharedMaterialDissolveTilingOffset),a$j.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",a$j._getMeshRenderSharedMaterialMaskTilingOffset,a$j._setMeshRenderSharedMaterialMaskTilingOffset)},a$j.registerAnimationNodeProperty=function(a$t,a$k,a$v){if(a$j._propertyIndexDic[a$t])throw new Error("AnimationNode: this propertyName has registered.");a$j._propertyIndexDic[a$t]=a$j._propertyIDCounter,a$j._propertyGetFuncs[a$j._propertyIDCounter]=a$k,a$j._propertySetFuncs[a$j._propertyIDCounter]=a$v,a$j._propertyIDCounter++},a$j._getLocalPosition=function(a$t,a$k){return a$t?a$t.transform.getLocalPosition():a$k._transform.localPosition.elements},a$j._setLocalPosition=function(a$t,a$k,a$v){if(a$t)a$t.transform.setLocalPosition(a$v);else{var a$j=a$k._transform,a$Q=a$j.localPosition;a$Q.elements=a$v,a$j.localPosition=a$Q}},a$j._getLocalRotation=function(a$t,a$k){return a$t?a$t.transform.getLocalRotation():a$k._transform.localRotation.elements},a$j._setLocalRotation=function(a$t,a$k,a$v){if(a$t)a$t.transform.setLocalRotation(a$v);else{var a$j=a$k._transform,a$Q=a$j.localRotation;a$Q.elements=a$v,a$j.localRotation=a$Q}},a$j._getLocalScale=function(a$t,a$k){return a$t?a$t.transform.getLocalScale():a$k._transform.localScale.elements},a$j._setLocalScale=function(a$t,a$k,a$v){if(a$t)a$t.transform.setLocalScale(a$v);else{var a$j=a$k._transform,a$Q=a$j.localScale;a$Q.elements=a$v,a$j.localScale=a$Q}},a$j._getLocalRotationEuler=function(a$t,a$k){return a$t?a$t.transform.getLocalRotationEuler():a$k._transform.localRotationEuler.elements},a$j._setLocalRotationEuler=function(a$t,a$k,a$v){if(a$t)a$t.transform.setLocalRotationEuler(a$v);else{var a$j=a$k._transform,a$Q=a$j.localRotationEuler;a$Q.elements=a$v,a$j.localRotationEuler=a$Q}},a$j._getMeshRenderSharedMaterialTilingOffset=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return a$k.meshRender.sharedMaterial.tilingOffset.elements},a$j._setMeshRenderSharedMaterialTilingOffset=function(a$t,a$k,a$v){var a$j,a$Q;if(a$t){var a$u=a$t.transform._entity;a$u&&((a$Q=(a$j=a$u.owner.meshRender.material).tilingOffset).elements=a$v,a$j.tilingOffset=a$Q)}else(a$Q=(a$j=a$k.meshRender.material).tilingOffset).elements=a$v,a$j.tilingOffset=a$Q},a$j._getMeshRenderSharedMaterialAlbedo=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.albedoColor.elements:null}return a$k.meshRender.sharedMaterial.albedoColor.elements},a$j._setMeshRenderSharedMaterialAlbedo=function(a$t,a$k,a$v){var a$j,a$Q;if(a$t){var a$u=a$t.transform._entity;a$u&&((a$Q=(a$j=a$u.owner.meshRender.material).albedoColor).elements=a$v,a$j.albedoColor=a$Q)}else(a$Q=(a$j=a$k.meshRender.material).albedoColor).elements=a$v,a$j.albedoColor=a$Q},a$j._getSkinnedMeshRenderSharedMaterialTilingOffset=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return a$k.skinnedMeshRender.sharedMaterial.tilingOffset.elements},a$j._setSkinnedMeshRenderSharedMaterialTilingOffset=function(a$t,a$k,a$v){var a$j,a$Q;if(a$t){var a$u=a$t.transform._entity;a$u&&((a$Q=(a$j=a$u.owner.skinnedMeshRender.material).tilingOffset).elements=a$v,a$j.tilingOffset=a$Q)}else(a$Q=(a$j=a$k.skinnedMeshRender.material).tilingOffset).elements=a$v,a$j.tilingOffset=a$Q},a$j._getSkinnedMeshRenderSharedMaterialAlbedo=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return a$k.skinnedMeshRender.sharedMaterial.albedoColor.elements},a$j._setSkinnedMeshRenderSharedMaterialAlbedo=function(a$t,a$k,a$v){var a$j,a$Q;if(a$t){var a$u=a$t.transform._entity;a$u&&((a$Q=(a$j=a$u.owner.skinnedMeshRender.material).albedoColor).elements=a$v,a$j.albedoColor=a$Q)}else(a$Q=(a$j=a$k.skinnedMeshRender.material).albedoColor).elements=a$v,a$j.albedoColor=a$Q},a$j._getParticleRenderSharedMaterialTintColor=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.particleRender.sharedMaterial.tintColor.elements:null}return a$k.particleRender.sharedMaterial.tintColor.elements},a$j._setParticleRenderSharedMaterialTintColor=function(a$t,a$k,a$v){var a$j,a$Q;if(a$t){var a$u=a$t.transform._entity;a$u&&((a$Q=(a$j=a$u.owner.particleRender.material).tintColor).elements=a$v,a$j.tintColor=a$Q)}else(a$Q=(a$j=a$k.particleRender.material).tintColor).elements=a$v,a$j.tintColor=a$Q},a$j._getMeshRenderSharedMaterialAlphaColor=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.alphaColor.elements:null}return a$k.meshRender.sharedMaterial.alphaColor.elements},a$j._setMeshRenderSharedMaterialAlphaColor=function(a$t,a$k,a$v){var a$j,a$Q;if(a$t){var a$u=a$t.transform._entity;a$u&&((a$Q=(a$j=a$u.owner.meshRender.material).alphaColor).elements=a$v,a$j.alphaColor=a$Q)}else(a$Q=(a$j=a$k.meshRender.material).alphaColor).elements=a$v,a$j.alphaColor=a$Q},a$j._getMeshRenderSharedMaterialBaseColor=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.baseColor.elements:null}return a$k.meshRender.sharedMaterial.baseColor.elements},a$j._setMeshRenderSharedMaterialBaseColor=function(a$t,a$k,a$v){var a$j,a$Q;if(a$t){var a$u=a$t.transform._entity;a$u&&((a$Q=(a$j=a$u.owner.meshRender.material).baseColor).elements=a$v,a$j.baseColor=a$Q)}else(a$Q=(a$j=a$k.meshRender.material).baseColor).elements=a$v,a$j.baseColor=a$Q},a$j._getMeshRenderSharedMaterialDissolve=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.dissolve:0}return a$k.meshRender.sharedMaterial.dissolve},a$j._setMeshRenderSharedMaterialDissolve=function(a$t,a$k,a$v){if(a$t){var a$j=a$t.transform._entity;a$j&&(a$j.owner.meshRender.material.dissolve=a$v[0])}else a$k.meshRender.material.dissolve=a$v[0]},a$j._getMeshRenderSharedMaterialDissolveSpeed=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.dissolveSpeed:0}return a$k.meshRender.sharedMaterial.dissolveSpeed},a$j._setMeshRenderSharedMaterialDissolveSpeed=function(a$t,a$k,a$v){if(a$t){var a$j=a$t.transform._entity;a$j&&(a$j.owner.meshRender.material.dissolveSpeed=a$v[0])}else a$k.meshRender.material.dissolveSpeed=a$v[0]},a$j._getMeshRenderSharedMaterialMMultiplier=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.mMultiplier:0}return a$k.meshRender.sharedMaterial.mMultiplier},a$j._setMeshRenderSharedMaterialMMultiplier=function(a$t,a$k,a$v){if(a$t){var a$j=a$t.transform._entity;a$j&&(a$j.owner.meshRender.material.mMultiplier=a$v[0])}else a$k.meshRender.material.mMultiplier=a$v[0]},a$j._getMeshRenderSharedMaterialBaseScrollSpeedX=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return a$k.meshRender.sharedMaterial.baseScrollSpeedX},a$j._setMeshRenderSharedMaterialBaseScrollSpeedX=function(a$t,a$k,a$v){if(a$t){var a$j=a$t.transform._entity;a$j&&(a$j.owner.meshRender.material.baseScrollSpeedX=a$v[0])}else a$k.meshRender.material.baseScrollSpeedX=a$v[0]},a$j._getMeshRenderSharedMaterialBaseScrollSpeedY=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return a$k.meshRender.sharedMaterial.baseScrollSpeedY},a$j._setMeshRenderSharedMaterialBaseScrollSpeedY=function(a$t,a$k,a$v){if(a$t){var a$j=a$t.transform._entity;a$j&&(a$j.owner.meshRender.material.baseScrollSpeedY=a$v[0])}else a$k.meshRender.material.baseScrollSpeedY=a$v[0]},a$j._getMeshRenderSharedMaterialSecondScrollSpeedX=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return a$k.meshRender.sharedMaterial.secondScrollSpeedX},a$j._setMeshRenderSharedMaterialSecondScrollSpeedX=function(a$t,a$k,a$v){if(a$t){var a$j=a$t.transform._entity;a$j&&(a$j.owner.meshRender.material.secondScrollSpeedX=a$v[0])}else a$k.meshRender.material.secondScrollSpeedX=a$v[0]},a$j._getMeshRenderSharedMaterialSecondScrollSpeedY=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return a$k.meshRender.sharedMaterial.secondScrollSpeedY},a$j._setMeshRenderSharedMaterialSecondScrollSpeedY=function(a$t,a$k,a$v){if(a$t){var a$j=a$t.transform._entity;a$j&&(a$j.owner.meshRender.material.secondScrollSpeedY=a$v[0])}else a$k.meshRender.material.secondScrollSpeedY=a$v[0]},a$j._getMeshRenderSharedMaterialAlpha=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.alpha:0}return a$k.meshRender.sharedMaterial.alpha},a$j._setMeshRenderSharedMaterialAlpha=function(a$t,a$k,a$v){if(a$t){var a$j=a$t.transform._entity;a$j&&(a$j.owner.meshRender.material.alpha=a$v[0])}else a$k.meshRender.material.alpha=a$v[0]},a$j._getMeshRenderSharedMaterialIntensity=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.intensity:0}return a$k.meshRender.sharedMaterial.intensity},a$j._setMeshRenderSharedMaterialIntensity=function(a$t,a$k,a$v){if(a$t){var a$j=a$t.transform._entity;a$j&&(a$j.owner.meshRender.material.intensity=a$v[0])}else a$k.meshRender.material.intensity=a$v[0]},a$j._getMeshRenderSharedMaterialDetailTilingOffset=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return a$k.meshRender.sharedMaterial.detailTilingOffset.elements},a$j._setMeshRenderSharedMaterialDetailTilingOffset=function(a$t,a$k,a$v){var a$j,a$Q;if(a$t){var a$u=a$t.transform._entity;a$u&&((a$Q=(a$j=a$u.owner.meshRender.material).detailTilingOffset).elements=a$v,a$j.detailTilingOffset=a$Q)}else(a$Q=(a$j=a$k.meshRender.material).detailTilingOffset).elements=a$v,a$j.detailTilingOffset=a$Q},a$j._getMeshRenderSharedMaterialDissolveTilingOffset=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return a$k.meshRender.sharedMaterial.dissolveTilingOffset.elements},a$j._setMeshRenderSharedMaterialDissolveTilingOffset=function(a$t,a$k,a$v){var a$j,a$Q;if(a$t){var a$u=a$t.transform._entity;a$u&&((a$Q=(a$j=a$u.owner.meshRender.material).dissolveTilingOffset).elements=a$v,a$j.dissolveTilingOffset=a$Q)}else(a$Q=(a$j=a$k.meshRender.material).dissolveTilingOffset).elements=a$v,a$j.dissolveTilingOffset=a$Q},a$j._getMeshRenderSharedMaterialMaskTilingOffset=function(a$t,a$k){if(a$t){var a$v=a$t.transform._entity;return a$v?a$v.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return a$k.meshRender.sharedMaterial.maskTilingOffset.elements},a$j._setMeshRenderSharedMaterialMaskTilingOffset=function(a$t,a$k,a$v){var a$j,a$Q;if(a$t){var a$u=a$t.transform._entity;a$u&&((a$Q=(a$j=a$u.owner.meshRender.material).maskTilingOffset).elements=a$v,a$j.maskTilingOffset=a$Q)}else(a$Q=(a$j=a$k.meshRender.material).maskTilingOffset).elements=a$v,a$j.maskTilingOffset=a$Q},a$j._propertyIDCounter=0,a$j._propertyIndexDic={},a$j._propertySetFuncs=[],a$j._propertyGetFuncs=[],a$j}(),a$i=function(){function a$t(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return a$E(a$t,"laya.d3.animation.Keyframe"),a$t}(),a$D=function(){function a$t(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return a$E(a$t,"laya.d3.animation.KeyframeNode"),a$t}(),a$G=(function(){function a$t(){this._tempVector30=new a$Sk,this._tempVector31=new a$Sk,this._tempVector32=new a$Sk,this._a=new a$Sk,this._b=new a$Sk,this._c=new a$Sk,this._d=new a$Sk}a$E(a$t,"laya.d3.core.glitter.SplineCurvePositionVelocity");var a$k=a$t.prototype;a$k.Init=function(a$t,a$k,a$v,a$j){a$t.cloneTo(this._d),a$k.cloneTo(this._c),a$Sk.scale(a$t,2,this._a),a$Sk.scale(a$v,2,this._tempVector30),a$Sk.subtract(this._a,this._tempVector30,this._a),a$Sk.add(this._a,a$k,this._a),a$Sk.add(this._a,a$j,this._a),a$Sk.scale(a$v,3,this._b),a$Sk.scale(a$t,3,this._tempVector30),a$Sk.subtract(this._b,this._tempVector30,this._b),a$Sk.subtract(this._b,a$j,this._b),a$Sk.scale(a$k,2,this._tempVector30),a$Sk.subtract(this._b,this._tempVector30,this._b)},a$k.Slerp=function(a$t,a$k){a$Sk.scale(this._a,a$t*a$t*a$t,this._tempVector30),a$Sk.scale(this._b,a$t*a$t,this._tempVector31),a$Sk.scale(this._c,a$t,this._tempVector32),a$Sk.add(this._tempVector30,this._tempVector31,a$k),a$Sk.add(a$k,this._tempVector32,a$k),a$Sk.add(a$k,this._d,a$k)}}(),function(){function a$O(a$t,a$k,a$v,a$j){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=a$t,this._h=a$k,this._minHeight=a$v,this._maxHeight=a$j}a$E(a$O,"laya.d3.core.HeightMap");var a$t=a$O.prototype;a$t._inBounds=function(a$t,a$k){return 0<=a$t&&a$t<this._h&&0<=a$k&&a$k<this._w},a$t.getHeight=function(a$t,a$k){return this._inBounds(a$t,a$k)?this._datas[a$t][a$k]:NaN},a$A(0,a$t,"width",function(){return this._w}),a$A(0,a$t,"height",function(){return this._h}),a$A(0,a$t,"maxHeight",function(){return this._maxHeight}),a$A(0,a$t,"minHeight",function(){return this._minHeight}),a$O.creatFromMesh=function(a$t,a$k,a$v,a$j){for(var a$Q=[],a$u=[],a$S=a$t.getSubMeshCount(),a$V=0;a$V<a$S;a$V++){for(var a$J=a$t.getSubMesh(a$V),a$W=a$J._getVertexBuffer(),a$w=a$W.getData(),a$M=[],a$H=0;a$H<a$w.length;a$H+=a$W.vertexDeclaration.vertexStride/4){var a$E=new a$Sk(a$w[a$H+0],a$w[a$H+1],a$w[a$H+2]);a$M.push(a$E)}a$Q.push(a$M);var a$A=a$J._getIndexBuffer();a$u.push(a$A.getData())}var a$R=a$t.boundingBox,a$h=a$R.min.x,a$l=a$R.min.z,a$o=a$R.max.x,a$Y=a$R.max.z,a$f=a$R.min.y,a$X=a$R.max.y,a$F=a$o-a$h,a$d=a$Y-a$l,a$m=a$j.elements[0]=a$F/(a$k-1),a$Z=a$j.elements[1]=a$d/(a$v-1),a$s=new a$O(a$k,a$v,a$f,a$X),a$K=a$O._tempRay,a$U=a$K.direction.elements;a$U[0]=0,a$U[1]=-1,a$U[2]=0;var a$N=a$X+.1;a$K.origin.elements[1]=a$N;for(var a$a=0;a$a<a$v;a$a++){var a$z=a$l+a$a*a$Z;a$s._datas[a$a]=[];for(var a$G=0;a$G<a$k;a$G++){var a$c=a$h+a$G*a$m,a$T=a$K.origin.elements;a$T[0]=a$c,a$T[2]=a$z;var a$p=a$O._getPosition(a$K,a$Q,a$u);a$s._datas[a$a][a$G]=a$p===Number.MAX_VALUE?NaN:a$N-a$p}}return a$s},a$O.createFromImage=function(a$t,a$k,a$v){for(var a$j=a$t.width,a$Q=a$t.height,a$u=new a$O(a$j,a$Q,a$k,a$v),a$S=(a$v-a$k)/254,a$V=a$t.getPixels(),a$J=0,a$W=0;a$W<a$Q;a$W++)for(var a$w=a$u._datas[a$W]=[],a$M=0;a$M<a$j;a$M++){var a$H=a$V[a$J++],a$E=a$V[a$J++],a$A=a$V[a$J++],a$R=a$V[a$J++];a$w[a$M]=255==a$H&&255==a$E&&255==a$A&&255==a$R?NaN:(a$H+a$E+a$A)/3*a$S+a$k}return a$u},a$O._getPosition=function(a$t,a$k,a$v){for(var a$j=Number.MAX_VALUE,a$Q=0;a$Q<a$k.length;a$Q++)for(var a$u=a$k[a$Q],a$S=a$v[a$Q],a$V=0;a$V<a$S.length;a$V+=3){var a$J=a$u[a$S[a$V+0]],a$W=a$u[a$S[a$V+1]],a$w=a$u[a$S[a$V+2]],a$M=a$Ak.rayIntersectsTriangle(a$t,a$J,a$W,a$w);!isNaN(a$M)&&a$M<a$j&&(a$j=a$M)}return a$j},a$M(a$O,["_tempRay",function(){return this._tempRay=new a$Qk(new a$Sk,new a$Sk)}])}(),function(){function a$Q(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}a$E(a$Q,"laya.d3.core.Layer");var a$t=a$Q.prototype;return a$t._binarySearchIndex=function(){for(var a$t=0,a$k=a$Q._collsionTestList.length-1,a$v=0;a$t<=a$k;){a$v=Math.floor((a$t+a$k)/2);var a$j=a$Q._collsionTestList[a$v];if(a$j==this._number)return a$v;a$j>this._number?a$k=a$v-1:a$t=a$v+1}return a$t},a$t._addCollider=function(a$t){0===this._colliders.length&&a$Q._collsionTestList.splice(this._binarySearchIndex(),0,this._number),a$t._isRigidbody?(this._colliders.unshift(a$t),this._nonRigidbodyOffset++):this._colliders.push(a$t)},a$t._removeCollider=function(a$t){var a$k=this._colliders.indexOf(a$t);a$k<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(a$k,1),0===this._colliders.length&&a$Q._collsionTestList.splice(a$Q._collsionTestList.indexOf(this._number),1)},a$A(0,a$t,"number",function(){return this._number}),a$A(0,a$t,"visible",function(){return this._visible},function(a$t){this._visible=a$t,a$Q._visibleLayers=a$t?a$Q._visibleLayers|this.mask:a$Q._visibleLayers&~this.mask}),a$A(0,a$t,"mask",function(){return this._mask}),a$A(1,a$Q,"visibleLayers",function(){return a$Q._visibleLayers},function(a$t){a$Q._visibleLayers=a$t;for(var a$k=0,a$v=a$Q._layerList.length;a$k<a$v;a$k++){var a$j=a$Q._layerList[a$k];a$j._visible=0!=(a$j._mask&a$Q._visibleLayers)}}),a$Q.__init__=function(){a$Q._layerList.length=31;for(var a$t=0;a$t<31;a$t++){var a$k=new a$Q;a$Q._layerList[a$t]=a$k,0===a$t?(a$k.name="Default Layer",a$k.visible=!0):(a$k.name="Layer-"+a$t,a$k.visible=!1),a$k._number=a$t,a$k._mask=Math.pow(2,a$t)}a$Q.currentCreationLayer=a$Q._layerList[0]},a$Q.getLayerByNumber=function(a$t){if(a$t<0||30<a$t)throw new Error("无法返回指定Layer，该number超出范围！");return a$Q._layerList[a$t]},a$Q.getLayerByName=function(a$t){for(var a$k=0;a$k<31;a$k++)if(a$Q._layerList[a$k].name===a$t)return a$Q._layerList[a$k];throw new Error("无法返回指定Layer,该name不存在")},a$Q.isVisible=function(a$t){return 0!=(a$t&a$Q._currentCameraCullingMask&a$Q._visibleLayers)},a$Q._layerList=[],a$Q._visibleLayers=2147483647,a$Q._collsionTestList=[],a$Q._currentCameraCullingMask=2147483647,a$Q.maxCount=31,a$Q.currentCreationLayer=null,a$Q}()),a$c=(function(){function a$t(a$t,a$k,a$v){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=a$t,this._minCount=a$k,this._maxCount=a$v}a$E(a$t,"laya.d3.core.particleShuriKen.module.Burst");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k.cloneTo=function(a$t){var a$k=a$t;a$k._time=this._time,a$k._minCount=this._minCount,a$k._maxCount=this._maxCount},a$k.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$k,"time",function(){return this._time}),a$A(0,a$k,"minCount",function(){return this._minCount}),a$A(0,a$k,"maxCount",function(){return this._maxCount})}(),function(){function a$t(a$t){this._color=null,this.enbale=!1,this._color=a$t}a$E(a$t,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var a$k=a$t.prototype;a$k.cloneTo=function(a$t){var a$k=a$t;this._color.cloneTo(a$k._color),a$k.enbale=this.enbale},a$k.clone=function(){var a$t;switch(this._color.type){case 0:a$t=a$p.createByConstant(this._color.constant.clone());break;case 1:a$t=a$p.createByGradient(this._color.gradient.clone());break;case 2:a$t=a$p.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:a$t=a$p.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var a$k=new this.constructor(a$t);return a$k.enbale=this.enbale,a$k},a$A(0,a$k,"color",function(){return this._color})}(),function(){function a$t(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}a$E(a$t,"laya.d3.core.particleShuriKen.module.Emission");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),a$k._destroy=function(){this._bursts=null,this._destroyed=!0},a$k.getBurstsCount=function(){return this._bursts.length},a$k.getBurstByIndex=function(a$t){return this._bursts[a$t]},a$k.addBurst=function(a$t){var a$k=this._bursts.length;if(0<a$k)for(var a$v=0;a$v<a$k;a$v++)this._bursts[a$v].time>a$t.time&&this._bursts.splice(a$v,0,a$t);this._bursts.push(a$t)},a$k.removeBurst=function(a$t){var a$k=this._bursts.indexOf(a$t);-1!==a$k&&this._bursts.splice(a$k,1)},a$k.removeBurstByIndex=function(a$t){this._bursts.splice(a$t,1)},a$k.clearBurst=function(){this._bursts.length=0},a$k.cloneTo=function(a$t){var a$k=a$t,a$v=a$k._bursts;a$v.length=this._bursts.length;for(var a$j=0,a$Q=this._bursts.length;a$j<a$Q;a$j++){var a$u=a$v[a$j];a$u?this._bursts[a$j].cloneTo(a$u):a$v[a$j]=this._bursts[a$j].clone()}a$k._emissionRate=this._emissionRate,a$k.enbale=this.enbale},a$k.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$k,"destroyed",function(){return this._destroyed}),a$A(0,a$k,"emissionRate",function(){return this._emissionRate},function(a$t){if(a$t<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=a$t})}(),function(){function a$j(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}a$E(a$j,"laya.d3.core.particleShuriKen.module.FrameOverTime");var a$t=a$j.prototype;return a$X.imps(a$t,{"laya.d3.core.IClone":!0}),a$t.cloneTo=function(a$t){var a$k=a$t;a$k._type=this._type,a$k._constant=this._constant,this._overTime.cloneTo(a$k._overTime),a$k._constantMin=this._constantMin,a$k._constantMax=this._constantMax,this._overTimeMin.cloneTo(a$k._overTimeMin),this._overTimeMax.cloneTo(a$k._overTimeMax)},a$t.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$t,"frameOverTimeData",function(){return this._overTime}),a$A(0,a$t,"constant",function(){return this._constant}),a$A(0,a$t,"type",function(){return this._type}),a$A(0,a$t,"frameOverTimeDataMin",function(){return this._overTimeMin}),a$A(0,a$t,"constantMin",function(){return this._constantMin}),a$A(0,a$t,"frameOverTimeDataMax",function(){return this._overTimeMax}),a$A(0,a$t,"constantMax",function(){return this._constantMax}),a$j.createByConstant=function(a$t){var a$k=new a$j;return a$k._type=0,a$k._constant=a$t,a$k},a$j.createByOverTime=function(a$t){var a$k=new a$j;return a$k._type=1,a$k._overTime=a$t,a$k},a$j.createByRandomTwoConstant=function(a$t,a$k){var a$v=new a$j;return a$v._type=2,a$v._constantMin=a$t,a$v._constantMax=a$k,a$v},a$j.createByRandomTwoOverTime=function(a$t,a$k){var a$v=new a$j;return a$v._type=3,a$v._overTimeMin=a$t,a$v._overTimeMax=a$k,a$v},a$j}()),a$T=function(){function a$W(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}a$E(a$W,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var a$t=a$W.prototype;return a$X.imps(a$t,{"laya.d3.core.IClone":!0}),a$t.cloneTo=function(a$t){var a$k=a$t;a$k._type=this._type,a$k._separateAxes=this._separateAxes,a$k._constant=this._constant,this._constantSeparate.cloneTo(a$k._constantSeparate),this._gradient.cloneTo(a$k._gradient),this._gradientX.cloneTo(a$k._gradientX),this._gradientY.cloneTo(a$k._gradientY),this._gradientZ.cloneTo(a$k._gradientZ),a$k._constantMin=this._constantMin,a$k._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(a$k._constantMinSeparate),this._constantMaxSeparate.cloneTo(a$k._constantMaxSeparate),this._gradientMin.cloneTo(a$k._gradientMin),this._gradientMax.cloneTo(a$k._gradientMax),this._gradientXMin.cloneTo(a$k._gradientXMin),this._gradientXMax.cloneTo(a$k._gradientXMax),this._gradientYMin.cloneTo(a$k._gradientYMin),this._gradientYMax.cloneTo(a$k._gradientYMax),this._gradientZMin.cloneTo(a$k._gradientZMin),this._gradientZMax.cloneTo(a$k._gradientZMax)},a$t.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$t,"gradientZ",function(){return this._gradientZ}),a$A(0,a$t,"constant",function(){return this._constant}),a$A(0,a$t,"gradient",function(){return this._gradient}),a$A(0,a$t,"separateAxes",function(){return this._separateAxes}),a$A(0,a$t,"type",function(){return this._type}),a$A(0,a$t,"constantSeparate",function(){return this._constantSeparate}),a$A(0,a$t,"gradientX",function(){return this._gradientX}),a$A(0,a$t,"gradientY",function(){return this._gradientY}),a$A(0,a$t,"gradientW",function(){return this._gradientW}),a$A(0,a$t,"gradientMin",function(){return this._gradientMin}),a$A(0,a$t,"constantMin",function(){return this._constantMin}),a$A(0,a$t,"gradientMax",function(){return this._gradientMax}),a$A(0,a$t,"constantMax",function(){return this._constantMax}),a$A(0,a$t,"gradientWMin",function(){return this._gradientWMin}),a$A(0,a$t,"constantMinSeparate",function(){return this._constantMinSeparate}),a$A(0,a$t,"constantMaxSeparate",function(){return this._constantMaxSeparate}),a$A(0,a$t,"gradientXMin",function(){return this._gradientXMin}),a$A(0,a$t,"gradientXMax",function(){return this._gradientXMax}),a$A(0,a$t,"gradientWMax",function(){return this._gradientWMax}),a$A(0,a$t,"gradientYMin",function(){return this._gradientYMin}),a$A(0,a$t,"gradientYMax",function(){return this._gradientYMax}),a$A(0,a$t,"gradientZMin",function(){return this._gradientZMin}),a$A(0,a$t,"gradientZMax",function(){return this._gradientZMax}),a$W.createByConstant=function(a$t){var a$k=new a$W;return a$k._type=0,a$k._separateAxes=!1,a$k._constant=a$t,a$k},a$W.createByConstantSeparate=function(a$t){var a$k=new a$W;return a$k._type=0,a$k._separateAxes=!0,a$k._constantSeparate=a$t,a$k},a$W.createByGradient=function(a$t){var a$k=new a$W;return a$k._type=1,a$k._separateAxes=!1,a$k._gradient=a$t,a$k},a$W.createByGradientSeparate=function(a$t,a$k,a$v,a$j){var a$Q=new a$W;return a$Q._type=1,a$Q._separateAxes=!0,a$Q._gradientX=a$t,a$Q._gradientY=a$k,a$Q._gradientZ=a$v,a$Q._gradientW=a$j,a$Q},a$W.createByRandomTwoConstant=function(a$t,a$k){var a$v=new a$W;return a$v._type=2,a$v._separateAxes=!1,a$v._constantMin=a$t,a$v._constantMax=a$k,a$v},a$W.createByRandomTwoConstantSeparate=function(a$t,a$k){var a$v=new a$W;return a$v._type=2,a$v._separateAxes=!0,a$v._constantMinSeparate=a$t,a$v._constantMaxSeparate=a$k,a$v},a$W.createByRandomTwoGradient=function(a$t,a$k){var a$v=new a$W;return a$v._type=3,a$v._separateAxes=!1,a$v._gradientMin=a$t,a$v._gradientMax=a$k,a$v},a$W.createByRandomTwoGradientSeparate=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){var a$J=new a$W;return a$J._type=3,a$J._separateAxes=!0,a$J._gradientXMin=a$t,a$J._gradientXMax=a$k,a$J._gradientYMin=a$v,a$J._gradientYMax=a$j,a$J._gradientZMin=a$Q,a$J._gradientZMax=a$u,a$J._gradientWMin=a$S,a$J._gradientWMax=a$V,a$J},a$W}(),a$p=function(){function a$j(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}a$E(a$j,"laya.d3.core.particleShuriKen.module.GradientColor");var a$t=a$j.prototype;return a$X.imps(a$t,{"laya.d3.core.IClone":!0}),a$t.cloneTo=function(a$t){var a$k=a$t;a$k._type=this._type,this._constant.cloneTo(a$k._constant),this._constantMin.cloneTo(a$k._constantMin),this._constantMax.cloneTo(a$k._constantMax),this._gradient.cloneTo(a$k._gradient),this._gradientMin.cloneTo(a$k._gradientMin),this._gradientMax.cloneTo(a$k._gradientMax)},a$t.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$t,"gradient",function(){return this._gradient}),a$A(0,a$t,"constant",function(){return this._constant}),a$A(0,a$t,"type",function(){return this._type}),a$A(0,a$t,"gradientMin",function(){return this._gradientMin}),a$A(0,a$t,"constantMin",function(){return this._constantMin}),a$A(0,a$t,"gradientMax",function(){return this._gradientMax}),a$A(0,a$t,"constantMax",function(){return this._constantMax}),a$j.createByConstant=function(a$t){var a$k=new a$j;return a$k._type=0,a$k._constant=a$t,a$k},a$j.createByGradient=function(a$t){var a$k=new a$j;return a$k._type=1,a$k._gradient=a$t,a$k},a$j.createByRandomTwoConstant=function(a$t,a$k){var a$v=new a$j;return a$v._type=2,a$v._constantMin=a$t,a$v._constantMax=a$k,a$v},a$j.createByRandomTwoGradient=function(a$t,a$k){var a$v=new a$j;return a$v._type=3,a$v._gradientMin=a$t,a$v._gradientMax=a$k,a$v},a$j}(),a$O=(function(){function a$t(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}a$E(a$t,"laya.d3.core.particleShuriKen.module.GradientDataColor");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k.addAlpha=function(a$t,a$k){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==a$t&&(a$t=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=a$t,this._alphaElements[this._alphaCurrentLength++]=a$k):DEBUG},a$k.addRGB=function(a$t,a$k){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==a$t&&(a$t=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=a$t,this._rgbElements[this._rgbCurrentLength++]=a$k.x,this._rgbElements[this._rgbCurrentLength++]=a$k.y,this._rgbElements[this._rgbCurrentLength++]=a$k.z):DEBUG},a$k.cloneTo=function(a$t){var a$k=a$t,a$v=0,a$j=0;a$k._alphaCurrentLength=this._alphaCurrentLength;var a$Q=a$k._alphaElements;for(a$Q.length=this._alphaElements.length,a$v=0,a$j=this._alphaElements.length;a$v<a$j;a$v++)a$Q[a$v]=this._alphaElements[a$v];a$k._rgbCurrentLength=this._rgbCurrentLength;var a$u=a$k._rgbElements;for(a$u.length=this._rgbElements.length,a$v=0,a$j=this._rgbElements.length;a$v<a$j;a$v++)a$u[a$v]=this._rgbElements[a$v]},a$k.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$k,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),a$A(0,a$k,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function a$t(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}a$E(a$t,"laya.d3.core.particleShuriKen.module.GradientDataInt");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k.add=function(a$t,a$k){this._currentLength<8?(6===this._currentLength&&1!==a$t&&(a$t=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=a$t,this._elements[this._currentLength++]=a$k):console.log("Warning:data count must lessEqual than 4")},a$k.cloneTo=function(a$t){var a$k=a$t;a$k._currentLength=this._currentLength;var a$v=a$k._elements;a$v.length=this._elements.length;for(var a$j=0,a$Q=this._elements.length;a$j<a$Q;a$j++)a$v[a$j]=this._elements[a$j]},a$k.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$k,"gradientCount",function(){return this._currentLength/2})}(),function(){function a$t(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}a$E(a$t,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k.add=function(a$t,a$k){this._currentLength<8?(6===this._currentLength&&1!==a$t&&(a$t=1,DEBUG),this._elements[this._currentLength++]=a$t,this._elements[this._currentLength++]=a$k):DEBUG},a$k.getKeyByIndex=function(a$t){return this._elements[2*a$t]},a$k.getValueByIndex=function(a$t){return this._elements[2*a$t+1]},a$k.getAverageValue=function(){for(var a$t=0,a$k=this._currentLength-2;a$t<a$k;a$t+=2){this._elements[a$t+1];this._elements[a$t+3],this._elements[a$t+2]-this._elements[a$t]}return 0},a$k.cloneTo=function(a$t){var a$k=a$t;a$k._currentLength=this._currentLength;var a$v=a$k._elements;a$v.length=this._elements.length;for(var a$j=0,a$Q=this._elements.length;a$j<a$Q;a$j++)a$v[a$j]=this._elements[a$j]},a$k.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$k,"gradientCount",function(){return this._currentLength/2})}(),function(){function a$t(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}a$E(a$t,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k.add=function(a$t,a$k){this._currentLength<8?(6===this._currentLength&&1!==a$t&&(a$t=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=a$t,this._elements[this._currentLength++]=a$k.x,this._elements[this._currentLength++]=a$k.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},a$k.cloneTo=function(a$t){var a$k=a$t;a$k._currentLength=this._currentLength;var a$v=a$k._elements;a$v.length=this._elements.length;for(var a$j=0,a$Q=this._elements.length;a$j<a$Q;a$j++)a$v[a$j]=this._elements[a$j]},a$k.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$k,"gradientCount",function(){return this._currentLength/3})}(),function(){function a$V(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}a$E(a$V,"laya.d3.core.particleShuriKen.module.GradientSize");var a$t=a$V.prototype;return a$X.imps(a$t,{"laya.d3.core.IClone":!0}),a$t.getMaxSizeInGradient=function(){var a$t=0,a$k=0,a$v=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(a$t=0,a$k=this._gradientX.gradientCount;a$t<a$k;a$t++)a$v=Math.max(a$v,this._gradientX.getValueByIndex(a$t));for(a$t=0,a$k=this._gradientY.gradientCount;a$t<a$k;a$t++)a$v=Math.max(a$v,this._gradientY.getValueByIndex(a$t))}else for(a$t=0,a$k=this._gradient.gradientCount;a$t<a$k;a$t++)a$v=Math.max(a$v,this._gradient.getValueByIndex(a$t));break;case 1:a$v=this._separateAxes?(a$v=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),a$v=Math.max(a$v,this._constantMinSeparate.y),Math.max(a$v,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(a$t=0,a$k=this._gradientXMin.gradientCount;a$t<a$k;a$t++)a$v=Math.max(a$v,this._gradientXMin.getValueByIndex(a$t));for(a$t=0,a$k=this._gradientXMax.gradientCount;a$t<a$k;a$t++)a$v=Math.max(a$v,this._gradientXMax.getValueByIndex(a$t));for(a$t=0,a$k=this._gradientYMin.gradientCount;a$t<a$k;a$t++)a$v=Math.max(a$v,this._gradientYMin.getValueByIndex(a$t));for(a$t=0,a$k=this._gradientZMax.gradientCount;a$t<a$k;a$t++)a$v=Math.max(a$v,this._gradientZMax.getValueByIndex(a$t))}else{for(a$t=0,a$k=this._gradientMin.gradientCount;a$t<a$k;a$t++)a$v=Math.max(a$v,this._gradientMin.getValueByIndex(a$t));for(a$t=0,a$k=this._gradientMax.gradientCount;a$t<a$k;a$t++)a$v=Math.max(a$v,this._gradientMax.getValueByIndex(a$t))}}return a$v},a$t.cloneTo=function(a$t){var a$k=a$t;a$k._type=this._type,a$k._separateAxes=this._separateAxes,this._gradient.cloneTo(a$k._gradient),this._gradientX.cloneTo(a$k._gradientX),this._gradientY.cloneTo(a$k._gradientY),this._gradientZ.cloneTo(a$k._gradientZ),a$k._constantMin=this._constantMin,a$k._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(a$k._constantMinSeparate),this._constantMaxSeparate.cloneTo(a$k._constantMaxSeparate),this._gradientMin.cloneTo(a$k._gradientMin),this._gradientMax.cloneTo(a$k._gradientMax),this._gradientXMin.cloneTo(a$k._gradientXMin),this._gradientXMax.cloneTo(a$k._gradientXMax),this._gradientYMin.cloneTo(a$k._gradientYMin),this._gradientYMax.cloneTo(a$k._gradientYMax),this._gradientZMin.cloneTo(a$k._gradientZMin),this._gradientZMax.cloneTo(a$k._gradientZMax)},a$t.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$t,"gradientZ",function(){return this._gradientZ}),a$A(0,a$t,"gradient",function(){return this._gradient}),a$A(0,a$t,"separateAxes",function(){return this._separateAxes}),a$A(0,a$t,"type",function(){return this._type}),a$A(0,a$t,"gradientMin",function(){return this._gradientMin}),a$A(0,a$t,"constantMin",function(){return this._constantMin}),a$A(0,a$t,"gradientX",function(){return this._gradientX}),a$A(0,a$t,"gradientY",function(){return this._gradientY}),a$A(0,a$t,"gradientMax",function(){return this._gradientMax}),a$A(0,a$t,"constantMax",function(){return this._constantMax}),a$A(0,a$t,"constantMinSeparate",function(){return this._constantMinSeparate}),a$A(0,a$t,"constantMaxSeparate",function(){return this._constantMaxSeparate}),a$A(0,a$t,"gradientXMin",function(){return this._gradientXMin}),a$A(0,a$t,"gradientXMax",function(){return this._gradientXMax}),a$A(0,a$t,"gradientYMin",function(){return this._gradientYMin}),a$A(0,a$t,"gradientYMax",function(){return this._gradientYMax}),a$A(0,a$t,"gradientZMin",function(){return this._gradientZMin}),a$A(0,a$t,"gradientZMax",function(){return this._gradientZMax}),a$V.createByGradient=function(a$t){var a$k=new a$V;return a$k._type=0,a$k._separateAxes=!1,a$k._gradient=a$t,a$k},a$V.createByGradientSeparate=function(a$t,a$k,a$v){var a$j=new a$V;return a$j._type=0,a$j._separateAxes=!0,a$j._gradientX=a$t,a$j._gradientY=a$k,a$j._gradientZ=a$v,a$j},a$V.createByRandomTwoConstant=function(a$t,a$k){var a$v=new a$V;return a$v._type=1,a$v._separateAxes=!1,a$v._constantMin=a$t,a$v._constantMax=a$k,a$v},a$V.createByRandomTwoConstantSeparate=function(a$t,a$k){var a$v=new a$V;return a$v._type=1,a$v._separateAxes=!0,a$v._constantMinSeparate=a$t,a$v._constantMaxSeparate=a$k,a$v},a$V.createByRandomTwoGradient=function(a$t,a$k){var a$v=new a$V;return a$v._type=2,a$v._separateAxes=!1,a$v._gradientMin=a$t,a$v._gradientMax=a$k,a$v},a$V.createByRandomTwoGradientSeparate=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=new a$V;return a$S._type=2,a$S._separateAxes=!0,a$S._gradientXMin=a$t,a$S._gradientXMax=a$k,a$S._gradientYMin=a$v,a$S._gradientYMax=a$j,a$S._gradientZMin=a$Q,a$S._gradientZMax=a$u,a$S},a$V}()),a$n=function(){function a$V(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}a$E(a$V,"laya.d3.core.particleShuriKen.module.GradientVelocity");var a$t=a$V.prototype;return a$X.imps(a$t,{"laya.d3.core.IClone":!0}),a$t.cloneTo=function(a$t){var a$k=a$t;a$k._type=this._type,this._constant.cloneTo(a$k._constant),this._gradientX.cloneTo(a$k._gradientX),this._gradientY.cloneTo(a$k._gradientY),this._gradientZ.cloneTo(a$k._gradientZ),this._constantMin.cloneTo(a$k._constantMin),this._constantMax.cloneTo(a$k._constantMax),this._gradientXMin.cloneTo(a$k._gradientXMin),this._gradientXMax.cloneTo(a$k._gradientXMax),this._gradientYMin.cloneTo(a$k._gradientYMin),this._gradientYMax.cloneTo(a$k._gradientYMax),this._gradientZMin.cloneTo(a$k._gradientZMin),this._gradientZMax.cloneTo(a$k._gradientZMax)},a$t.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$t,"gradientZ",function(){return this._gradientZ}),a$A(0,a$t,"constant",function(){return this._constant}),a$A(0,a$t,"type",function(){return this._type}),a$A(0,a$t,"gradientXMax",function(){return this._gradientXMax}),a$A(0,a$t,"constantMin",function(){return this._constantMin}),a$A(0,a$t,"gradientX",function(){return this._gradientX}),a$A(0,a$t,"gradientY",function(){return this._gradientY}),a$A(0,a$t,"gradientXMin",function(){return this._gradientXMin}),a$A(0,a$t,"constantMax",function(){return this._constantMax}),a$A(0,a$t,"gradientYMin",function(){return this._gradientYMin}),a$A(0,a$t,"gradientYMax",function(){return this._gradientYMax}),a$A(0,a$t,"gradientZMin",function(){return this._gradientZMin}),a$A(0,a$t,"gradientZMax",function(){return this._gradientZMax}),a$V.createByConstant=function(a$t){var a$k=new a$V;return a$k._type=0,a$k._constant=a$t,a$k},a$V.createByGradient=function(a$t,a$k,a$v){var a$j=new a$V;return a$j._type=1,a$j._gradientX=a$t,a$j._gradientY=a$k,a$j._gradientZ=a$v,a$j},a$V.createByRandomTwoConstant=function(a$t,a$k){var a$v=new a$V;return a$v._type=2,a$v._constantMin=a$t,a$v._constantMax=a$k,a$v},a$V.createByRandomTwoGradient=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=new a$V;return a$S._type=3,a$S._gradientXMin=a$t,a$S._gradientXMax=a$k,a$S._gradientYMin=a$v,a$S._gradientYMax=a$j,a$S._gradientZMin=a$Q,a$S._gradientZMax=a$u,a$S},a$V}(),a$_=(function(){function a$t(a$t){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=a$t}a$E(a$t,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k.cloneTo=function(a$t){var a$k=a$t;this._angularVelocity.cloneTo(a$k._angularVelocity),a$k.enbale=this.enbale},a$k.clone=function(){var a$t;switch(this._angularVelocity.type){case 0:a$t=this._angularVelocity.separateAxes?a$T.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):a$T.createByConstant(this._angularVelocity.constant);break;case 1:a$t=this._angularVelocity.separateAxes?a$T.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):a$T.createByGradient(this._angularVelocity.gradient.clone());break;case 2:a$t=this._angularVelocity.separateAxes?a$T.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):a$T.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:a$t=this._angularVelocity.separateAxes?a$T.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):a$T.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var a$k=new this.constructor(a$t);return a$k.enbale=this.enbale,a$k},a$A(0,a$k,"angularVelocity",function(){return this._angularVelocity})}(),function(){function a$t(){this.enable=!1,this.randomDirection=!1}a$E(a$t,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k._getShapeBoundBox=function(a$t){throw new Error("BaseShape: must override it.")},a$k._getSpeedBoundBox=function(a$t){throw new Error("BaseShape: must override it.")},a$k.generatePositionAndDirection=function(a$t,a$k,a$v,a$j){throw new Error("BaseShape: must override it.")},a$k._calculateProceduralBounds=function(a$t,a$k,a$v){this._getShapeBoundBox(a$t);var a$j=a$t.min,a$Q=a$t.max;a$Sk.multiply(a$j,a$k,a$j),a$Sk.multiply(a$Q,a$k,a$Q);var a$u=new a$rt(new a$Sk,new a$Sk);this.randomDirection?(a$u.min=new a$Sk(-1,-1,-1),a$u.max=new a$Sk(1,1,1)):this._getSpeedBoundBox(a$u);var a$S=new a$rt(new a$Sk,new a$Sk),a$V=a$S.min,a$J=a$S.max;a$Sk.scale(a$u.min,a$v.y,a$V),a$Sk.scale(a$u.max,a$v.y,a$J),a$Sk.add(a$t.min,a$V,a$V),a$Sk.add(a$t.max,a$J,a$J),a$Sk.min(a$t.min,a$V,a$t.min),a$Sk.max(a$t.max,a$V,a$t.max);var a$W=new a$rt(new a$Sk,new a$Sk),a$w=a$W.min,a$M=a$W.max;a$Sk.scale(a$u.min,a$v.x,a$w),a$Sk.scale(a$u.max,a$v.x,a$M),a$Sk.min(a$W.min,a$M,a$V),a$Sk.max(a$W.min,a$M,a$J),a$Sk.min(a$t.min,a$V,a$t.min),a$Sk.max(a$t.max,a$V,a$t.max)},a$k.cloneTo=function(a$t){a$t.enable=this.enable},a$k.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$t}()),a$B=function(){function a$u(){}return a$E(a$u,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),a$u._randomPointUnitArcCircle=function(a$t,a$k,a$v){var a$j=a$k.elements,a$Q=NaN;a$Q=a$v?a$v.getFloat()*a$t:Math.random()*a$t,a$j[0]=Math.cos(a$Q),a$j[1]=Math.sin(a$Q)},a$u._randomPointInsideUnitArcCircle=function(a$t,a$k,a$v){var a$j=a$k.elements;a$u._randomPointUnitArcCircle(a$t,a$k,a$v);var a$Q=NaN;a$Q=a$v?Math.pow(a$v.getFloat(),.5):Math.pow(Math.random(),.5),a$j[0]=a$j[0]*a$Q,a$j[1]=a$j[1]*a$Q},a$u._randomPointUnitCircle=function(a$t,a$k){var a$v=a$t.elements,a$j=NaN;a$j=a$k?a$k.getFloat()*Math.PI*2:Math.random()*Math.PI*2,a$v[0]=Math.cos(a$j),a$v[1]=Math.sin(a$j)},a$u._randomPointInsideUnitCircle=function(a$t,a$k){var a$v=a$t.elements;a$u._randomPointUnitCircle(a$t);var a$j=NaN;a$j=a$k?Math.pow(a$k.getFloat(),.5):Math.pow(Math.random(),.5),a$v[0]=a$v[0]*a$j,a$v[1]=a$v[1]*a$j},a$u._randomPointUnitSphere=function(a$t,a$k){var a$v=a$t.elements,a$j=NaN,a$Q=NaN;a$Q=a$k?(a$j=a$v[2]=2*a$k.getFloat()-1,a$k.getFloat()*Math.PI*2):(a$j=a$v[2]=2*Math.random()-1,Math.random()*Math.PI*2);var a$u=Math.sqrt(1-a$j*a$j);a$v[0]=a$u*Math.cos(a$Q),a$v[1]=a$u*Math.sin(a$Q)},a$u._randomPointInsideUnitSphere=function(a$t,a$k){var a$v=a$t.elements;a$u._randomPointUnitSphere(a$t);var a$j=NaN;a$j=a$k?Math.pow(a$k.getFloat(),1/3):Math.pow(Math.random(),1/3),a$v[0]=a$v[0]*a$j,a$v[1]=a$v[1]*a$j,a$v[2]=a$v[2]*a$j},a$u._randomPointInsideHalfUnitBox=function(a$t,a$k){var a$v=a$t.elements;a$k?(a$v[0]=a$k.getFloat()-.5,a$v[1]=a$k.getFloat()-.5,a$v[2]=a$k.getFloat()-.5):(a$v[0]=Math.random()-.5,a$v[1]=Math.random()-.5,a$v[2]=Math.random()-.5)},a$u}(),a$b=(function(){function a$t(a$t){this._size=null,this.enbale=!1,this._size=a$t}a$E(a$t,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k.cloneTo=function(a$t){var a$k=a$t;this._size.cloneTo(a$k._size),a$k.enbale=this.enbale},a$k.clone=function(){var a$t;switch(this._size.type){case 0:a$t=this._size.separateAxes?a$O.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):a$O.createByGradient(this._size.gradient.clone());break;case 1:a$t=this._size.separateAxes?a$O.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):a$O.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:a$t=this._size.separateAxes?a$O.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):a$O.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var a$k=new this.constructor(a$t);return a$k.enbale=this.enbale,a$k},a$A(0,a$k,"size",function(){return this._size})}(),function(){function a$j(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}a$E(a$j,"laya.d3.core.particleShuriKen.module.StartFrame");var a$t=a$j.prototype;return a$X.imps(a$t,{"laya.d3.core.IClone":!0}),a$t.cloneTo=function(a$t){var a$k=a$t;a$k._type=this._type,a$k._constant=this._constant,a$k._constantMin=this._constantMin,a$k._constantMax=this._constantMax},a$t.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$t,"constant",function(){return this._constant}),a$A(0,a$t,"type",function(){return this._type}),a$A(0,a$t,"constantMin",function(){return this._constantMin}),a$A(0,a$t,"constantMax",function(){return this._constantMax}),a$j.createByConstant=function(a$t){var a$k=new a$j;return a$k._type=0,a$k._constant=a$t,a$k},a$j.createByRandomTwoConstant=function(a$t,a$k){var a$v=new a$j;return a$v._type=1,a$v._constantMin=a$t,a$v._constantMax=a$k,a$v},a$j}()),a$q=(function(){function a$t(a$t,a$k){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new a$uk(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=a$t,this._startFrame=a$k}a$E(a$t,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k.cloneTo=function(a$t){var a$k=a$t;this.tiles.cloneTo(a$k.tiles),a$k.type=this.type,a$k.randomRow=this.randomRow,this._frame.cloneTo(a$k._frame),this._startFrame.cloneTo(a$k._startFrame),a$k.cycles=this.cycles,a$k.enableUVChannels=this.enableUVChannels,a$k.enable=this.enable},a$k.clone=function(){var a$t,a$k;switch(this._frame.type){case 0:a$t=a$c.createByConstant(this._frame.constant);break;case 1:a$t=a$c.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:a$t=a$c.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:a$t=a$c.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:a$k=a$b.createByConstant(this._startFrame.constant);break;case 1:a$k=a$b.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var a$v=new this.constructor(a$t,a$k);return this.tiles.cloneTo(a$v.tiles),a$v.type=this.type,a$v.randomRow=this.randomRow,a$v.cycles=this.cycles,a$v.enableUVChannels=this.enableUVChannels,a$v.enable=this.enable,a$v},a$A(0,a$k,"frame",function(){return this._frame}),a$A(0,a$k,"startFrame",function(){return this._startFrame})}(),function(){function a$t(a$t){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=a$t}a$E(a$t,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k.cloneTo=function(a$t){var a$k=a$t;this._velocity.cloneTo(a$k._velocity),a$k.enbale=this.enbale,a$k.space=this.space},a$k.clone=function(){var a$t;switch(this._velocity.type){case 0:a$t=a$n.createByConstant(this._velocity.constant.clone());break;case 1:a$t=a$n.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:a$t=a$n.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:a$t=a$n.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var a$k=new this.constructor(a$t);return a$k.enbale=this.enbale,a$k.space=this.space,a$k},a$A(0,a$k,"velocity",function(){return this._velocity})}(),function(){function a$t(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new a$Hk,this._vb=a$_k.create(a$t._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=a$nk.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=a$pk.nameKey.getID("LINE"),this._shaderCompile=a$mk._preCompileShader[this._sharderNameID]}a$E(a$t,"laya.d3.core.PhasorSpriter3D");var a$k=a$t.prototype;return a$k.line=function(a$t,a$k,a$v,a$j){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(a$t.x,a$t.y,a$t.z,a$k.x,a$k.y,a$k.z,a$k.w),this.addVertex(a$v.x,a$v.y,a$v.z,a$j.x,a$j.y,a$j.z,a$j.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},a$k.circle=function(a$t,a$k,a$v,a$j,a$Q,a$u){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*a$k,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/a$k,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*a$t,Math.cos(this._tempNumver0)*a$t,0,a$v,a$j,a$Q,a$u),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},a$k.plane=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=a$j/2,this._tempNumver1=a$Q/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(a$t-this._tempNumver0,a$k+this._tempNumver1,a$v,a$u,a$S,a$V,a$J),this.addVertex(a$t+this._tempNumver0,a$k+this._tempNumver1,a$v,a$u,a$S,a$V,a$J),this.addVertex(a$t-this._tempNumver0,a$k-this._tempNumver1,a$v,a$u,a$S,a$V,a$J),this.addVertex(a$t+this._tempNumver0,a$k-this._tempNumver1,a$v,a$u,a$S,a$V,a$J),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},a$k.box=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=a$j/2,this._tempNumver1=a$Q/2,this._tempNumver2=a$u/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(a$t-this._tempNumver0,a$k+this._tempNumver1,a$v+this._tempNumver2,a$S,a$V,a$J,a$W),this.addVertex(a$t+this._tempNumver0,a$k+this._tempNumver1,a$v+this._tempNumver2,a$S,a$V,a$J,a$W),this.addVertex(a$t-this._tempNumver0,a$k-this._tempNumver1,a$v+this._tempNumver2,a$S,a$V,a$J,a$W),this.addVertex(a$t+this._tempNumver0,a$k-this._tempNumver1,a$v+this._tempNumver2,a$S,a$V,a$J,a$W),this.addVertex(a$t+this._tempNumver0,a$k+this._tempNumver1,a$v-this._tempNumver2,a$S,a$V,a$J,a$W),this.addVertex(a$t-this._tempNumver0,a$k+this._tempNumver1,a$v-this._tempNumver2,a$S,a$V,a$J,a$W),this.addVertex(a$t+this._tempNumver0,a$k-this._tempNumver1,a$v-this._tempNumver2,a$S,a$V,a$J,a$W),this.addVertex(a$t-this._tempNumver0,a$k-this._tempNumver1,a$v-this._tempNumver2,a$S,a$V,a$J,a$W),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},a$k.cone=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*a$v+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*a$v>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/a$v,this.addVertexIndex(0,a$k,0,a$j,a$Q,a$u,a$S,this._tempUint0),this.addVertexIndex(0,0,0,a$j,a$Q,a$u,a$S,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<a$v;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(a$t*this._tempNumver2,0,a$t*this._tempNumver3,a$j,a$Q,a$u,a$S,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==a$v-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(a$t*this._tempNumver2,0,a$t*this._tempNumver3,a$j,a$Q,a$u,a$S,this._tempUint0+(this._tempInt0+a$v)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==a$v-1?this.addIndexes(this._tempUint1+a$v+2):this.addIndexes(this._tempUint1+this._tempInt0+a$v+1),this.addIndexes(this._tempUint1+this._tempInt0+a$v),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},a$k.boundingBoxLine=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(a$t,a$Q,a$u,a$S,a$V,a$J,a$W),this.addVertex(a$j,a$Q,a$u,a$S,a$V,a$J,a$W),this.addVertex(a$t,a$k,a$u,a$S,a$V,a$J,a$W),this.addVertex(a$j,a$k,a$u,a$S,a$V,a$J,a$W),this.addVertex(a$j,a$Q,a$v,a$S,a$V,a$J,a$W),this.addVertex(a$t,a$Q,a$v,a$S,a$V,a$J,a$W),this.addVertex(a$j,a$k,a$v,a$S,a$V,a$J,a$W),this.addVertex(a$t,a$k,a$v,a$S,a$V,a$J,a$W),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},a$k.addVertex=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=a$t,this._vbData[this._posInVBData+1]=a$k,this._vbData[this._posInVBData+2]=a$v,this._vbData[this._posInVBData+3]=a$j,this._vbData[this._posInVBData+4]=a$Q,this._vbData[this._posInVBData+5]=a$u,this._vbData[this._posInVBData+6]=a$S,this._posInVBData+=this._floatSizePerVer,this},a$k.addVertexIndex=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){return this._hasBegun||this.addVertexIndexException(),this._vbData[a$V]=a$t,this._vbData[a$V+1]=a$k,this._vbData[a$V+2]=a$v,this._vbData[a$V+3]=a$j,this._vbData[a$V+4]=a$Q,this._vbData[a$V+5]=a$u,this._vbData[a$V+6]=a$S,(a$V+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=a$V),this},a$k.addIndexes=function(a$t){var a$k=arguments;this._hasBegun||this.addVertexIndexException();for(var a$v=0;a$v<a$k.length;a$v++)this._ibData[this._posInIBData]=a$k[a$v],this._posInIBData++;return this},a$k.begin=function(a$t,a$k){return this._hasBegun&&this.beginException0(),1!==a$t&&4!==a$t&&this.beginException1(),this._primitiveType=a$t,this._camera=a$k,this._hasBegun=!0,this},a$k.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},a$k.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(a$t._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),a$m.drawCall++,a$N.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},a$k.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},a$k.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},a$k.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},a$k.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},a$k.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},a$k.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(28,[new a$St(0,"vector3",0),new a$St(12,"vector4",1)])}]),a$t}()),a$C=function(){function a$t(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++a$t._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new a$Hk}a$E(a$t,"laya.d3.core.render.RenderElement");var a$k=a$t.prototype;return a$k.getDynamicBatchBakedVertexs=function(a$t){for(var a$k=this._renderObj._getVertexBuffer(a$t),a$v=a$k.getData().slice(),a$j=a$k.vertexDeclaration,a$Q=a$j.getVertexElementByUsage(0).offset/4,a$u=a$j.getVertexElementByUsage(3).offset/4,a$S=this._sprite3D.transform,a$V=a$S.worldMatrix,a$J=a$S.rotation,a$W=a$j.vertexStride/4,a$w=0,a$M=a$v.length;a$w<a$M;a$w+=a$W){var a$H=a$w+a$Q,a$E=a$w+a$u;a$hk.transformVector3ArrayToVector3ArrayCoordinate(a$v,a$H,a$V,a$v,a$H),a$hk.transformVector3ArrayByQuat(a$v,a$E,a$J,a$v,a$E)}return a$v},a$k.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},a$k._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},a$A(0,a$k,"id",function(){return this._id}),a$A(0,a$k,"renderObj",function(){return this._renderObj},function(a$t){this._renderObj!==a$t&&(this._renderObj=a$t)}),a$t._uniqueIDCounter=0,a$t}(),a$L=function(){function a$k(a$t){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++a$k._uniqueIDCounter,this._needSort=!1,this._scene=a$t,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}a$E(a$k,"laya.d3.core.render.RenderQueue");var a$t=a$k.prototype;return a$t._sortOpaqueFunc=function(a$t,a$k){if(a$t._render&&a$k._render){var a$v=a$t._material.renderQueue-a$k._material.renderQueue;return 0==a$v?a$t._render._distanceForSort-a$k._render._distanceForSort:a$v}return 0},a$t._sortAlphaFunc=function(a$t,a$k){if(a$t._render&&a$k._render){var a$v=a$t._material.renderQueue-a$k._material.renderQueue;return 0==a$v?a$k._render._distanceForSort-a$t._render._distanceForSort:a$v}return 0},a$t._begainRenderElement=function(a$t,a$k,a$v){return!!a$k._beforeRender(a$t)},a$t._sortAlpha=function(a$t){a$k._cameraPosition=a$t,this._finalElements.sort(this._sortAlphaFunc)},a$t._sortOpaque=function(a$t){a$k._cameraPosition=a$t,this._finalElements.sort(this._sortOpaqueFunc)},a$t._preRender=function(a$t){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},a$t._render=function(a$t,a$k){for(var a$v,a$j,a$Q,a$u,a$S,a$V,a$J=a$m.loopCount,a$W=this._scene,a$w=a$t.camera,a$M=(a$w.id,!1),a$H=0,a$E=this._finalElements.length;a$H<a$E;a$H++){var a$A,a$R,a$h,a$l=this._finalElements[a$H];if(null!=a$l._onPreRenderFunction&&a$l._onPreRenderFunction.call(a$l._sprite3D,a$t),0===a$l._type){if(a$t.owner=a$h=a$l._sprite3D,a$t.renderElement=a$l,a$h._preRenderUpdateComponents(a$t),a$A=a$l.renderObj,a$R=a$l._material,this._begainRenderElement(a$t,a$A,a$R)){if(a$v=a$A._getVertexBuffers(),!(a$Q=(a$j=a$A._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[a$j.id]){this._errorRecord[a$j.id]=1;var a$o="vertexBuffer:"+("("+a$j._destroyed+","+a$j._released+","+a$j._referenceCount+","+a$j._buffer+")")+", material:"+(a$R?a$R.__className+"("+a$R._destroyed+","+a$R._released+")":"null")+", owner:"+(a$h?a$h.__className+"("+a$h._destroyed+","+a$h._activeInHierarchy+","+a$h._displayedInStage+")":"null")+", renderObj:"+(a$A?a$A.__className+"("+a$A._destroyed+","+a$A._released+","+a$A._referenceCount+")":"")+", parent:, url:"+(a$h?a$h.url:"")+", disposeStack:"+a$j.disposeStack;a$X.recordError("报错：unknown vertexDeclaration  "+a$o)}continue}if(a$M=(a$u=a$t._shader=a$R._getShader(a$W._shaderDefineValue,a$Q.shaderDefineValue,a$h._shaderDefineValue)).bind()||a$J!==a$u._uploadLoopCount,a$v){if(a$u._uploadVertexBuffer!==a$v||a$M){for(var a$Y=0;a$Y<a$v.length;a$Y++){var a$f=a$v[a$Y];a$u.uploadAttributesX(a$f.vertexDeclaration.shaderValues.data,a$f)}a$u._uploadVertexBuffer=a$v}}else(a$u._uploadVertexBuffer!==a$j||a$M)&&(a$u.uploadAttributes(a$Q.shaderValues.data,null),a$u._uploadVertexBuffer=a$j);(a$u._uploadScene!==a$W||a$M)&&(a$u.uploadSceneUniforms(a$W._shaderValues.data),a$u._uploadScene=a$W),(a$w!==a$u._uploadCamera||a$u._uploadSprite3D!==a$h||a$M)&&(a$u.uploadSpriteUniforms(a$h._shaderValues.data),a$u._uploadSprite3D=a$h),(a$w!==a$u._uploadCamera||a$M)&&(a$u.uploadCameraUniforms(a$w._shaderValues.data),a$u._uploadCamera=a$w),(a$u._uploadMaterial!==a$R||a$M)&&(a$R._upload(),a$u._uploadMaterial=a$R),a$S!==a$R?(a$R._setRenderStateBlendDepth(),a$R._setRenderStateFrontFace(a$k,a$h.transform),a$S=a$R,a$V=a$h):a$V!==a$h&&(a$R._setRenderStateFrontFace(a$k,a$h.transform),a$V=a$h),a$A._render(a$t),a$u._uploadLoopCount=a$J}a$h._postRenderUpdateComponents(a$t)}else if(2===a$l._type){a$l.renderObj;a$t.owner=a$h=a$l._sprite3D,a$t.renderElement=a$l,a$t._batchIndexStart=a$l._tempBatchIndexStart,a$t._batchIndexEnd=a$l._tempBatchIndexEnd,a$A=a$l.renderObj,a$R=a$l._material,this._begainRenderElement(a$t,a$A,a$R)&&(a$Q=(a$j=a$A._getVertexBuffer(0)).vertexDeclaration,a$M=(a$u=a$t._shader=a$R._getShader(a$W._shaderDefineValue,a$Q.shaderDefineValue,a$h._shaderDefineValue)).bind()||a$J!==a$u._uploadLoopCount,(a$u._uploadVertexBuffer!==a$j||a$M)&&(a$u.uploadAttributes(a$Q.shaderValues.data,null),a$u._uploadVertexBuffer=a$j),(a$u._uploadScene!==a$W||a$M)&&(a$u.uploadSceneUniforms(a$W._shaderValues.data),a$u._uploadScene=a$W),(a$w!==a$u._uploadCamera||a$u._uploadSprite3D!==a$h||a$M)&&(a$u.uploadSpriteUniforms(a$h._shaderValues.data),a$u._uploadSprite3D=a$h),(a$w!==a$u._uploadCamera||a$M)&&(a$u.uploadCameraUniforms(a$w._shaderValues.data),a$u._uploadCamera=a$w),(a$u._uploadMaterial!==a$R||a$M)&&(a$R._upload(),a$u._uploadMaterial=a$R),a$S!==a$R?(a$R._setRenderStateBlendDepth(),a$R._setRenderStateFrontFace(a$k,a$h.transform),a$S=a$R,a$V=a$h):a$V!==a$h&&(a$R._setRenderStateFrontFace(a$k,a$h.transform),a$V=a$h),a$A._render(a$t),a$u._uploadLoopCount=a$J)}}},a$t._renderShadow=function(a$t,a$k){for(var a$v,a$j,a$Q,a$u,a$S,a$V=a$m.loopCount,a$J=this._scene,a$W=a$t.camera,a$w=!1,a$M=0,a$H=this._finalElements.length;a$M<a$H;a$M++){var a$E,a$A,a$R,a$h=this._finalElements[a$M];0===a$h._type&&(a$t.owner=a$R=a$h._sprite3D,a$k||a$R._projectionViewWorldUpdateCamera===a$W&&a$R._projectionViewWorldUpdateLoopCount===a$m.loopCount||(a$R._render._renderUpdate(a$t._projectionViewMatrix),a$R._projectionViewWorldUpdateLoopCount=a$m.loopCount,a$R._projectionViewWorldUpdateCamera=a$W),a$t.renderElement=a$h,a$R._preRenderUpdateComponents(a$t),a$E=a$h.renderObj,a$A=a$h._material,this._begainRenderElement(a$t,a$E,null)&&(a$j=(a$v=a$E._getVertexBuffer(0)).vertexDeclaration,a$w=(a$Q=a$t._shader=a$A._getShader(a$J._shaderDefineValue,a$j.shaderDefineValue,a$R._shaderDefineValue)).bind()||a$V!==a$Q._uploadLoopCount,(a$Q._uploadVertexBuffer!==a$v||a$w)&&(a$Q.uploadAttributes(a$j.shaderValues.data,null),a$Q._uploadVertexBuffer=a$v),(a$W!==a$Q._uploadCamera||a$Q._uploadSprite3D!==a$R||a$w)&&(a$Q.uploadSpriteUniforms(a$R._shaderValues.data),a$Q._uploadSprite3D=a$R),(a$W!==a$Q._uploadCamera||a$w)&&(a$Q.uploadCameraUniforms(a$W._shaderValues.data),a$Q._uploadCamera=a$W),(a$Q._uploadMaterial!==a$A||a$w)&&(a$A._upload(),a$Q._uploadMaterial=a$A),a$Q._uploadRenderElement,a$u!==a$A?(a$A._setRenderStateFrontFace(!1,a$R.transform),a$u=a$A,a$S=a$R):a$S!==a$R&&(a$A._setRenderStateFrontFace(!1,a$R.transform),a$S=a$R),a$E._render(a$t),a$Q._uploadLoopCount=a$V),a$R._postRenderUpdateComponents(a$t))}},a$t._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},a$t._addRenderElement=function(a$t){this._renderElements.push(a$t),this._needSort=!0},a$t._addDynamicBatchElement=function(a$t){this._dynamicBatchCombineRenderElements.push(a$t)},a$A(0,a$t,"id",function(){return this._id}),a$k._uniqueIDCounter=0,a$k._cameraPosition=null,a$k}(),a$e=function(){function a$t(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return a$E(a$t,"laya.d3.core.render.RenderState"),a$t.clientWidth=0,a$t.clientHeight=0,a$t}(),a$r=function(){function a$S(a$t,a$k){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new a$$t(new a$Sk,0),this._corners=[new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk],this._boundingBoxCenter=new a$Sk,this._children=a$j(8),this._objects=[],this._tempBoundBoxCorners=[new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk],this._scene=a$t,this._currentDepth=a$k}a$E(a$S,"laya.d3.core.scene.OctreeNode");var a$t=a$S.prototype;return a$X.imps(a$t,{"laya.d3.core.scene.ITreeNode":!0}),a$t.init=function(a$t,a$k){var a$v=new a$Sk,a$j=new a$Sk;a$Sk.scale(a$k,-.5,a$v),a$Sk.scale(a$k,.5,a$j),a$Sk.add(a$v,a$t,a$v),a$Sk.add(a$j,a$t,a$j),this.exactBox=new a$rt(a$v,a$j),this.relaxBox=new a$rt(a$v,a$j)},a$t.addTreeNode=function(a$t){1===Collision.boxContainsBox(this._relaxBox,a$t.boundingBox)?this.addNodeDown(a$t,0):this.addObject(a$t)},a$t.addChild=function(a$t){var a$k=this._children[a$t];if(null==a$k){a$k=new a$S(this._scene,this._currentDepth+1),(this._children[a$t]=a$k)._parent=this,a$Sk.subtract(this._exactBox.max,this._exactBox.min,a$S.tempSize),a$Sk.multiply(a$S.tempSize,a$S._octreeSplit[a$t],a$S.tempCenter),a$Sk.add(this._exactBox.min,a$S.tempCenter,a$S.tempCenter),a$Sk.scale(a$S.tempSize,.25,a$S.tempSize);var a$v=new a$Sk,a$j=new a$Sk;a$Sk.subtract(a$S.tempCenter,a$S.tempSize,a$v),a$Sk.add(a$S.tempCenter,a$S.tempSize,a$j),a$k.exactBox=new a$rt(a$v,a$j),a$Sk.scale(a$S.tempSize,a$S.relax,a$S.tempSize);var a$Q=new a$Sk,a$u=new a$Sk;a$Sk.subtract(a$S.tempCenter,a$S.tempSize,a$Q),a$Sk.add(a$S.tempCenter,a$S.tempSize,a$u),a$k.relaxBox=new a$rt(a$Q,a$u)}return a$k},a$t.addObject=function(a$t){(a$t._treeNode=this)._objects.push(a$t)},a$t.removeObject=function(a$t){if(a$t._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var a$k=this._objects.indexOf(a$t);return-1!==a$k&&(this._objects.splice(a$k,1),!0)},a$t.clearObject=function(){this._objects.length=0},a$t.addNodeUp=function(a$t,a$k){this._parent&&1!==Collision.boxContainsBox(this._exactBox,a$t.boundingBox)?this._parent.addNodeUp(a$t,a$k-1):this.addNodeDown(a$t,a$k)},a$t.addNodeDown=function(a$t,a$k){if(a$k<this._scene.treeLevel){var a$v=this.inChildIndex(a$t.boundingBoxCenter),a$j=this.addChild(a$v);1===Collision.boxContainsBox(a$j._relaxBox,a$t.boundingBox)?a$j.addNodeDown(a$t,++a$k):this.addObject(a$t)}else this.addObject(a$t)},a$t.inChildIndex=function(a$t){return 4*(a$t.z<this._boundingBoxCenter.z?0:1)+2*(a$t.y<this._boundingBoxCenter.y?0:1)+(a$t.x<this._boundingBoxCenter.x?0:1)},a$t.updateObject=function(a$t){1===Collision.boxContainsBox(this._relaxBox,a$t.boundingBox)?(this.removeObject(a$t),a$t._treeNode=null,this.addNodeDown(a$t,this._currentDepth)):this._parent&&(this.removeObject(a$t),a$t._treeNode=null,this._parent.addNodeUp(a$t,this._currentDepth-1))},a$t.cullingObjects=function(a$t,a$k,a$v,a$j,a$Q){var a$u,a$S=0,a$V=0,a$J=0,a$W=this._scene._dynamicBatchManager;for(a$S=0,a$u=this._objects.length;a$S<a$u;a$S++){var a$w=this._objects[a$S];if(a$G.isVisible(a$w._owner.layer.mask)&&a$w.enable){if(a$k&&(a$m.treeSpriteCollision+=1,0===a$t.containsBoundSphere(a$w.boundingSphere)))continue;a$w._renderUpdate(a$Q),a$w._distanceForSort=a$Sk.distance(a$w.boundingSphere.center,a$j)+a$w.sortingFudge;var a$M=a$w._renderElements;for(a$V=0,a$J=a$M.length;a$V<a$J;a$V++){var a$H=a$M[a$V],a$E=a$H._staticBatch;if(a$E&&a$E._material===a$H._material)a$E._addBatchRenderElement(a$H);else{var a$A=a$H.renderObj;a$A.triangleCount<10&&1===a$A._vertexBufferCount&&a$A._getIndexBuffer()&&a$H._material.renderQueue<2&&a$H._canDynamicBatch&&!a$w._owner.isStatic?a$W._addPrepareRenderElement(a$H):this._scene.getRenderQueue(a$H._material.renderQueue)._addRenderElement(a$H)}}}}for(a$S=0;a$S<8;a$S++){var a$R=this._children[a$S];if(null!=a$R){var a$h=a$k;if(a$k){var a$l=a$t.containsBoundBox(a$R._relaxBox);if(a$m.treeNodeCollision+=1,0===a$l)continue;a$h=2===a$l}a$R.cullingObjects(a$t,a$h,a$v,a$j,a$Q)}}},a$t.cullingShadowObjects=function(a$t,a$k,a$v,a$j,a$Q){var a$u,a$S=0,a$V=0,a$J=0;this._scene._dynamicBatchManager;for(a$S=0,a$u=this._objects.length;a$S<a$u;a$S++){var a$W=this._objects[a$S];if(a$W.castShadow&&a$G.isVisible(a$W._owner.layer.mask)&&a$W.enable){if(a$v&&0===a$t[0].containsBoundSphere(a$W.boundingSphere))continue;for(var a$w=1,a$M=a$t.length;a$w<a$M;a$w++){var a$H=a$k[a$w-1];if(0!==a$t[a$w].containsBoundSphere(a$W.boundingSphere)){var a$E=a$W._renderElements;for(a$V=0,a$J=a$E.length;a$V<a$J;a$V++)a$H._addRenderElement(a$E[a$V])}}}}for(a$S=0;a$S<8;a$S++){var a$A=this._children[a$S];if(null!=a$A){var a$R=a$v;if(a$v){var a$h=a$t[0].containsBoundBox(a$A._relaxBox);if(0===a$h)continue;a$R=2===a$h}a$A.cullingShadowObjects(a$t,a$k,a$R,a$j,a$Q)}}},a$t.cullingShadowObjectsOnePSSM=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S,a$V=a$k[0],a$J=0,a$W=0,a$w=0;for(a$J=0,a$S=this._objects.length;a$J<a$S;a$J++){var a$M=this._objects[a$J];if(a$M.castShadow&&a$G.isVisible(a$M._owner.layer.mask)&&a$M.enable){if(a$j&&0===a$t.containsBoundSphere(a$M.boundingSphere))continue;a$M._renderUpdate(a$v);var a$H=a$M._renderElements;for(a$W=0,a$w=a$H.length;a$W<a$w;a$W++)a$V._addRenderElement(a$H[a$W])}}for(a$J=0;a$J<8;a$J++){var a$E=this._children[a$J];if(null!=a$E){var a$A=a$j;if(a$j){var a$R=a$t.containsBoundBox(a$E._relaxBox);if(0===a$R)continue;a$A=2===a$R}a$E.cullingShadowObjectsOnePSSM(a$t,a$k,a$v,a$A,a$Q,a$u)}}},a$t.renderBoudingBox=function(a$t){this._renderBoudingBox(a$t);for(var a$k=0;a$k<8;++a$k){var a$v=this._children[a$k];a$v&&a$v.renderBoudingBox(a$t)}},a$t.buildAllChild=function(a$t){if(a$t<this._scene.treeLevel)for(var a$k=0;a$k<8;a$k++){this.addChild(a$k).buildAllChild(a$t+1)}},a$t._renderBoudingBox=function(a$t){},a$A(0,a$t,"exactBox",function(){return this._exactBox},function(a$t){this._exactBox=a$t,a$Sk.add(a$t.min,a$t.max,this._boundingBoxCenter),a$Sk.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),a$A(0,a$t,"relaxBox",function(){return this._relaxBox},function(a$t){(this._relaxBox=a$t).getCorners(this._corners),a$$t.createfromPoints(this._corners,this._boundingSphere)}),a$S.debugMode=!1,a$S.relax=1.15,a$S.CHILDNUM=8,a$M(a$S,["tempVector0",function(){return this.tempVector0=new a$Sk},"tempSize",function(){return this.tempSize=new a$Sk},"tempCenter",function(){return this.tempCenter=new a$Sk},"_octreeSplit",function(){return this._octreeSplit=[new a$Sk(.25,.25,.25),new a$Sk(.75,.25,.25),new a$Sk(.25,.75,.25),new a$Sk(.75,.75,.25),new a$Sk(.25,.25,.75),new a$Sk(.75,.25,.75),new a$Sk(.25,.75,.75),new a$Sk(.75,.75,.75)]}]),a$S}(),a$g=(function(){function a$t(){}a$E(a$t,"laya.d3.core.scene.SceneManager")}(),function(){function a$t(a$t,a$k,a$v,a$j){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===a$t&&(a$t=1),void 0===a$k&&(a$k=1),void 0===a$v&&(a$v=1),void 0===a$j&&(a$j=1),this._r=a$t,this._g=a$k,this._b=a$v,this._a=a$j}return a$E(a$t,"laya.d3.core.trail.module.Color",null,"Color$1"),a$t.prototype.cloneTo=function(a$t){a$t._r=this._r,a$t._g=this._g,a$t._b=this._b,a$t._a=this._a},a$M(a$t,["RED",function(){return this.RED=new a$t(1,0,0,1)},"GREEN",function(){return this.GREEN=new a$t(0,1,0,1)},"BLUE",function(){return this.BLUE=new a$t(0,0,1,1)},"CYAN",function(){return this.CYAN=new a$t(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new a$t(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new a$t(1,0,1,1)},"GRAY",function(){return this.GRAY=new a$t(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new a$t(1,1,1,1)},"BLACK",function(){return this.BLACK=new a$t(0,0,0,1)}]),a$t}()),a$$=(function(){function a$t(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}a$E(a$t,"laya.d3.core.trail.module.Gradient");var a$k=a$t.prototype;a$k.setKeys=function(a$t,a$k){var a$v,a$j;this._colorKeys=a$t;for(var a$Q=this.index=0;a$Q<a$t.length;a$Q++){var a$u=(a$v=a$t[a$Q]).color;this._colorKeyData[this.index++]=a$u._r,this._colorKeyData[this.index++]=a$u._g,this._colorKeyData[this.index++]=a$u._b,this._colorKeyData[this.index++]=a$v.time}this._alphaKeys=a$k;for(var a$S=this.index=0;a$S<a$k.length;a$S++)a$j=a$k[a$S],this._alphaKeyData[this.index++]=a$j.alpha,this._alphaKeyData[this.index++]=a$j.time},a$k.cloneTo=function(a$t){var a$k=0,a$v=0,a$j=this.colorKeys,a$Q=[];for(a$k=0,a$v=a$j.length;a$k<a$v;a$k++){var a$u=new a$y;a$j[a$k].cloneTo(a$u),a$Q.push(a$u)}var a$S=this.alphaKeys,a$V=[];for(a$k=0,a$v=a$S.length;a$k<a$v;a$k++){var a$J=new a$$;a$S[a$k].cloneTo(a$J),a$V.push(a$J)}a$t.setKeys(a$Q,a$V)},a$A(0,a$k,"mode",function(){return this._mode},function(a$t){this._mode=a$t}),a$A(0,a$k,"colorKeys",function(){return this._colorKeys},function(a$t){this._colorKeys=a$t;for(var a$k=this.index=0;a$k<a$t.length;a$k++){var a$v=a$t[a$k],a$j=a$v.color;this._colorKeyData[this.index++]=a$j._r,this._colorKeyData[this.index++]=a$j._g,this._colorKeyData[this.index++]=a$j._b,this._colorKeyData[this.index++]=a$v.time}}),a$A(0,a$k,"alphaKeys",function(){return this._alphaKeys},function(a$t){this._alphaKeys=a$t;for(var a$k=this.index=0;a$k<a$t.length;a$k++){var a$v=a$t[a$k];this._alphaKeyData[this.index++]=a$v.alpha,this._alphaKeyData[this.index++]=a$v.time}})}(),function(){function a$t(a$t,a$k){this._alpha=NaN,this._time=NaN,void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),this._alpha=a$t,this._time=a$k}a$E(a$t,"laya.d3.core.trail.module.GradientAlphaKey");var a$k=a$t.prototype;return a$k.cloneTo=function(a$t){a$t.alpha=this.alpha,a$t.time=this.time},a$A(0,a$k,"alpha",function(){return this._alpha},function(a$t){this._alpha=a$t}),a$A(0,a$k,"time",function(){return this._time},function(a$t){this._time=a$t}),a$t}()),a$y=function(){function a$t(a$t,a$k){this._color=null,this._time=NaN,void 0===a$k&&(a$k=0),this._color=a$t||new a$g,this._time=a$k}a$E(a$t,"laya.d3.core.trail.module.GradientColorKey");var a$k=a$t.prototype;return a$k.cloneTo=function(a$t){this.color.cloneTo(a$t.color),a$t.time=this.time},a$A(0,a$k,"color",function(){return this._color},function(a$t){this._color=a$t}),a$A(0,a$k,"time",function(){return this._time},function(a$t){this._time=a$t}),a$t}(),a$P=(function(){function a$t(){}a$E(a$t,"laya.d3.core.trail.module.GradientMode"),a$t.Blend=0,a$t.Fixed=1}(),function(){function a$t(){}a$E(a$t,"laya.d3.core.trail.module.TextureMode"),a$t.Stretch=0,a$t.Tile=1}(),function(){function a$t(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}a$E(a$t,"laya.d3.core.trail.module.TrailKeyFrame"),a$t.prototype.cloneTo=function(a$t){a$t.time=this.time,a$t.inTangent=this.inTangent,a$t.outTangent=this.outTangent,a$t.value=this.value}}(),function(){function a$k(a$t){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new a$Sk,this._curPosition=new a$Sk,this._delVector3=new a$Sk,this._lastFixedVertexPosition=new a$Sk,this._pointAtoBVector3=new a$Sk,this._pointA=new a$Sk,this._pointB=new a$Sk,this._owner=a$t,this._id=a$k.renderElementCount++,0==this._id?a$t._owner.transform.position.cloneTo(this._lastPosition):a$t._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new a$_k(a$P.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new a$_k(a$P.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}a$E(a$k,"laya.d3.core.trail.TrailRenderElement");var a$t=a$k.prototype;a$X.imps(a$t,{"laya.d3.core.render.IRenderable":!0}),a$t._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},a$t._addTrailByFirstPosition=function(a$t,a$k){a$Sk.subtract(a$k,a$t,this._delVector3),a$Sk.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),a$Sk.normalize(this._pointAtoBVector3,this._pointAtoBVector3),a$Sk.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(a$t),a$t.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},a$t._addTrailByNextPosition=function(a$t){a$Sk.subtract(a$t,this._lastFixedVertexPosition,this._delVector3),a$Sk.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),a$Sk.normalize(this._pointAtoBVector3,this._pointAtoBVector3),a$Sk.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=a$Sk.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=a$yt.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(a$t),a$t.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(a$t),this._virtualVerticesCount=2)},a$t._updateVerticesByPosition=function(a$t){this._pointe=a$t.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},a$t._updateVertexBuffer2=function(){var a$t,a$k=0,a$v=0,a$j=0;for(a$j=0,a$t=(this._verticesCount+this._virtualVerticesCount)/2;a$j<a$t;a$j++)a$v=0==this._owner.textureMode?(this._VerticesToTailLength[a$j]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[a$j],this._vertices2[a$k++]=1-a$v,this._vertices2[a$k++]=1-a$v;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},a$t._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},a$t._updateDisappear=function(){var a$t,a$k=0;for(a$k=this._curDisappearIndex,a$t=(this._verticesCount+this._virtualVerticesCount)/2;a$k<a$t;a$k++)this._owner._curtime-this._everyGroupVertexBirthTime[a$k]>=this._owner.time+a$yt.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},a$t._beforeRender=function(a$t){return this._camera=a$t.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),a$Sk.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},a$t._render=function(a$t){this._isDead||(a$N.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),a$m.drawCall++,a$m.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},a$t._getVertexBuffer=function(a$t){return void 0===a$t&&(a$t=0),0===a$t?this._vertexBuffer1:1===a$t?this._vertexBuffer2:null},a$t._getVertexBuffers=function(){return this._vertexBuffers},a$t._getIndexBuffer=function(){return null},a$t.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},a$t._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},a$A(0,a$t,"_vertexBufferCount",function(){return this._vertexBuffers.length}),a$A(0,a$t,"triangleCount",function(){return 0}),a$k.renderElementCount=0}(),function(){function a$t(){}a$E(a$t,"laya.d3.core.trail.VertexTrail");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration1}),a$A(1,a$t,"vertexDeclaration1",function(){return a$t._vertexDeclaration1}),a$A(1,a$t,"vertexDeclaration2",function(){return a$t._vertexDeclaration2}),a$M(a$t,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new a$ut(32,[new a$St(0,"vector3",0),new a$St(12,"vector3",41),new a$St(24,"single",33),new a$St(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new a$ut(4,[new a$St(0,"single",38)])}]),a$t}()),a$tt=function(){function a$f(a$t){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=a$t}a$E(a$f,"laya.d3.graphics.DynamicBatch");var a$t=a$f.prototype;return a$X.imps(a$t,{"laya.d3.core.render.IRenderable":!0}),a$t._getVertexBuffer=function(a$t){return void 0===a$t&&(a$t=0),0===a$t?this._vertexBuffer:null},a$t._getIndexBuffer=function(){return this._indexBuffer},a$t._getCombineRenderElementFromPool=function(a$t,a$k,a$v){var a$j=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return a$j||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=a$j=new a$C,a$j._sprite3D=new a$Lk),a$j._sprite3D._render._renderUpdate(a$v),a$j},a$t._getRenderElement=function(a$t,a$k,a$v){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*a$f.maxVertexCount),this._indexDatas=new Uint16Array(a$f.maxIndexCount),this._vertexBuffer=a$_k.create(this._vertexDeclaration,a$f.maxVertexCount,35048),this._indexBuffer=a$nk.create("ushort",a$f.maxIndexCount,35048));for(var a$j=this._merageElements.length=0,a$Q=0,a$u=0,a$S=this._combineRenderElements.length;a$u<a$S;a$u++){var a$V=this._combineRenderElements[a$u],a$J=a$V.getDynamicBatchBakedVertexs(0),a$W=a$V.getBakedIndices(),a$w=a$V._sprite3D.transform._isFrontFaceInvert,a$M=a$j/(this._vertexDeclaration.vertexStride/4),a$H=a$Q,a$E=a$H+a$W.length;a$V._tempBatchIndexStart=a$H,a$V._tempBatchIndexEnd=a$E,this._indexDatas.set(a$W,a$Q);var a$A=0;if(a$w)for(a$A=a$H;a$A<a$E;a$A+=3){this._indexDatas[a$A]=a$M+this._indexDatas[a$A];var a$R=this._indexDatas[a$A+1],a$h=this._indexDatas[a$A+2];this._indexDatas[a$A+1]=a$M+a$h,this._indexDatas[a$A+2]=a$M+a$R}else for(a$A=a$H;a$A<a$E;a$A+=3)this._indexDatas[a$A]=a$M+this._indexDatas[a$A],this._indexDatas[a$A+1]=a$M+this._indexDatas[a$A+1],this._indexDatas[a$A+2]=a$M+this._indexDatas[a$A+2];a$Q+=a$W.length,this._vertexDatas.set(a$J,a$j),a$j+=a$J.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),a$u=this._combineRenderElementPoolIndex=0,a$S=this._materials.length;a$u<a$S;a$u++){var a$l=this._getCombineRenderElementFromPool(a$t,a$k,a$v);a$l._type=2,a$l._staticBatch=null;var a$o=(a$l.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[a$u]]._tempBatchIndexStart,a$Y=a$u+1===this._materialToRenderElementsOffsets.length?a$Q:this._combineRenderElements[this._materialToRenderElementsOffsets[a$u+1]]._tempBatchIndexStart;a$l._tempBatchIndexStart=a$o,a$l._tempBatchIndexEnd=a$Y,a$l._material=this._materials[a$u],this._merageElements.push(a$l)}},a$t._addCombineRenderObjTest=function(a$t){var a$k=a$t.renderObj,a$v=this._currentCombineIndexCount+a$k._getIndexBuffer().indexCount,a$j=this._currentCombineVertexCount+a$k._getVertexBuffer().vertexCount;return!(a$f.maxVertexCount<a$j||a$f.maxIndexCount<a$v)},a$t._addCombineRenderObj=function(a$t){var a$k=a$t.renderObj;this._combineRenderElements.push(a$t),this._currentCombineIndexCount=this._currentCombineIndexCount+a$k._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+a$k._getVertexBuffer().vertexCount},a$t._addCombineMaterial=function(a$t){this._materials.push(a$t)},a$t._addMaterialToRenderElementOffset=function(a$t){this._materialToRenderElementsOffsets.push(a$t)},a$t._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},a$t._addToRenderQueue=function(a$t,a$k,a$v,a$j){this._getRenderElement(a$k,a$v,a$j);for(var a$Q=0,a$u=this._materials.length;a$Q<a$u;a$Q++)a$t.getRenderQueue(this._materials[a$Q].renderQueue)._addDynamicBatchElement(this._merageElements[a$Q])},a$t._beforeRender=function(a$t){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},a$t._render=function(a$t){var a$k=a$t._batchIndexEnd-a$t._batchIndexStart;a$N.mainContext.drawElements(4,a$k,5123,2*a$t._batchIndexStart),a$m.drawCall++,a$m.trianglesFaces+=a$k/3},a$t._getVertexBuffers=function(){return null},a$A(0,a$t,"_vertexBufferCount",function(){return 1}),a$A(0,a$t,"triangleCount",function(){return this._indexBuffer.indexCount/3}),a$A(0,a$t,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),a$f.maxVertexCount=2e4,a$f.maxIndexCount=4e4,a$f.maxCombineTriangleCount=10,a$f}(),a$kt=function(){function a$f(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}a$E(a$f,"laya.d3.graphics.DynamicBatchManager");var a$t=a$f.prototype;return a$t.getDynamicBatch=function(a$t,a$k){var a$v,a$j=a$t.id.toString()+a$k;return this._dynamicBatches[a$j]?a$v=this._dynamicBatches[a$j]:this._dynamicBatches[a$j]=a$v=new a$tt(a$t),a$v},a$t._garbageCollection=function(){for(var a$t in this._dynamicBatches)0===this._dynamicBatches[a$t].combineRenderElementsCount&&delete this._dynamicBatches[a$t]},a$t._addPrepareRenderElement=function(a$t){this._prepareDynamicBatchCombineElements.push(a$t)},a$t._finishCombineDynamicBatch=function(a$t){var a$k,a$v,a$j;this._prepareDynamicBatchCombineElements.sort(a$f._sortPrepareDynamicBatch);for(var a$Q,a$u,a$S,a$V,a$J,a$W=-1,a$w=!0,a$M=0,a$H=-1,a$E=0,a$A=this._prepareDynamicBatchCombineElements.length;a$E<a$A;a$E++){var a$R=(a$u=this._prepareDynamicBatchCombineElements[a$E]).renderObj._getVertexBuffer(0).vertexDeclaration,a$h=a$v!==a$R;a$h&&(a$M=0,a$v=a$R);var a$l=a$M!==a$W;if(a$l&&(a$W=a$M),(a$h||a$l)&&(a$S=this.getDynamicBatch(a$R,a$M),a$k=null),a$w)if(a$S._addCombineRenderObjTest(a$u)){if(a$k!==(a$Q=a$u._material))a$V&&(a$t.getRenderQueue(a$J._material.renderQueue)._addRenderElement(a$J),a$J=a$V=null,a$H=-1),a$V=a$Q,a$H=a$S.combineRenderElementsCount,a$J=a$u,a$k=a$Q;else if(a$V){var a$o=a$J.renderObj,a$Y=a$u.renderObj;a$o._getVertexBuffer().vertexCount+a$Y._getVertexBuffer().vertexCount>a$tt.maxVertexCount||a$o._getIndexBuffer().indexCount+a$Y._getIndexBuffer().indexCount>a$tt.maxIndexCount?(a$t.getRenderQueue(a$J._material.renderQueue)._addRenderElement(a$J),a$V=a$Q,a$H=a$S.combineRenderElementsCount,a$J=a$u):(a$S._addCombineMaterial(a$V),a$S._addMaterialToRenderElementOffset(a$H),a$S._addCombineRenderObj(a$J),a$J=a$V=null,a$H=-1,a$S._addCombineRenderObj(a$u))}else a$S._addCombineRenderObj(a$u);a$w=!0}else a$V&&(a$t.getRenderQueue(a$J._material.renderQueue)._addRenderElement(a$J),a$J=a$V=null,a$H=-1),a$M++,a$w=!1;else a$j=this._prepareDynamicBatchCombineElements[a$E-1],a$S._addMaterialToRenderElementOffset(a$S.combineRenderElementsCount),a$k=a$j._material,a$S._addCombineMaterial(a$k),a$S._addCombineRenderObj(a$j),a$w=!0,a$k!==(a$Q=a$u._material)?(a$V=a$Q,a$H=a$S.combineRenderElementsCount,a$J=a$u):a$S._addCombineRenderObj(a$u),a$k=a$Q}a$V&&(a$t.getRenderQueue(a$J._material.renderQueue)._addRenderElement(a$J),a$J=a$V=null,a$H=-1),this._prepareDynamicBatchCombineElements.length=0},a$t._clearRenderElements=function(){for(var a$t in this._dynamicBatches)this._dynamicBatches[a$t]._clearRenderElements()},a$t._addToRenderQueue=function(a$t,a$k,a$v,a$j){for(var a$Q in this._dynamicBatches){var a$u=this._dynamicBatches[a$Q];0<a$u.combineRenderElementsCount&&a$u._addToRenderQueue(a$t,a$k,a$v,a$j)}},a$t.dispose=function(){this._dynamicBatches=null},a$f._sortPrepareDynamicBatch=function(a$t,a$k){return a$t._mainSortID-a$k._mainSortID},a$f}(),a$vt=function(){function a$t(){}return a$E(a$t,"laya.d3.graphics.FrustumCulling"),a$t.renderShadowObjectCulling=function(a$t,a$k,a$v,a$j,a$Q){var a$u=0,a$S=0,a$V=0,a$J=0;for(a$u=0,a$V=a$v.length;a$u<a$V;a$u++){var a$W=a$v[a$u];a$W&&a$W._clearRenderElements()}var a$w,a$M,a$H,a$E=a$t._cullingRenders;if(1<a$Q){for(a$u=0,a$V=a$t._cullingRendersLength;a$u<a$V;a$u++)if((a$w=a$E[a$u]).castShadow&&a$G.isVisible(a$w._owner.layer.mask)&&a$w.enable)for(var a$A=1,a$R=a$k.length;a$A<a$R;a$A++)if(a$M=a$v[a$A-1],0!==a$k[a$A].containsBoundSphere(a$w.boundingSphere))for(a$S=0,a$J=(a$H=a$w._renderElements).length;a$S<a$J;a$S++)a$M._addRenderElement(a$H[a$S])}else for(a$u=0,a$V=a$t._cullingRendersLength;a$u<a$V;a$u++)if((a$w=a$E[a$u]).castShadow&&a$G.isVisible(a$w._owner.layer.mask)&&a$w.enable&&0!==a$k[0].containsBoundSphere(a$w.boundingSphere))for(a$w._renderUpdate(a$j),a$M=a$v[0],a$S=0,a$J=(a$H=a$w._renderElements).length;a$S<a$J;a$S++)a$M._addRenderElement(a$H[a$S])},a$t.renderShadowObjectCullingOctree=function(a$t,a$k,a$v,a$j,a$Q){for(var a$u=0,a$S=a$v.length;a$u<a$S;a$u++){var a$V=a$v[a$u];a$V&&a$V._clearRenderElements()}1<a$Q?a$t.treeRoot.cullingShadowObjects(a$k,a$v,!0,0,a$t):a$t.treeRoot.cullingShadowObjectsOnePSSM(a$k[0],a$v,a$j,!0,0,a$t)},a$t.renderObjectCulling=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=0,a$V=0,a$J=0,a$W=0,a$w=a$k._quenes,a$M=a$k._dynamicBatchManager,a$H=a$k._cullingRenders;for(a$S=0,a$V=a$w.length;a$S<a$V;a$S++){var a$E=a$w[a$S];a$E&&a$E._clearRenderElements()}var a$A=a$jt._staticBatchManagers;for(a$S=0,a$V=a$A.length;a$S<a$V;a$S++)a$A[a$S]._clearRenderElements();a$M._clearRenderElements();var a$R=a$v.transform.position;for(a$S=0,a$V=a$k._cullingRendersLength;a$S<a$V;a$S++){var a$h=a$H[a$S];if(a$G.isVisible(a$h._owner.layer.mask)&&a$h.enable&&0!==a$t.containsBoundSphere(a$h.boundingSphere)&&a$h._renderUpdate(a$u)){a$h._distanceForSort=a$Sk.distance(a$h.boundingSphere.center,a$R)+a$h.sortingFudge;var a$l=a$h._renderElements;for(a$J=0,a$W=a$l.length;a$J<a$W;a$J++){var a$o=a$l[a$J],a$Y=a$o._staticBatch;if(a$Y&&a$Y._material===a$o._material)a$Y._addBatchRenderElement(a$o);else{var a$f=a$o.renderObj;a$f.triangleCount<10&&1===a$f._vertexBufferCount&&a$f._getIndexBuffer()&&a$o._material.renderQueue<2&&a$o._canDynamicBatch&&!a$h._owner.isStatic?a$M._addPrepareRenderElement(a$o):a$k.getRenderQueue(a$o._material.renderQueue)._addRenderElement(a$o)}}}}for(a$S=0,a$V=a$A.length;a$S<a$V;a$S++)a$A[a$S]._addToRenderQueue(a$k,a$j,a$Q,a$u);a$M._finishCombineDynamicBatch(a$k),a$M._addToRenderQueue(a$k,a$j,a$Q,a$u)},a$t.renderObjectCullingOctree=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=0,a$V=0,a$J=a$k._quenes,a$W=a$k._dynamicBatchManager;for(a$S=0,a$V=a$J.length;a$S<a$V;a$S++){var a$w=a$J[a$S];a$w&&a$w._clearRenderElements()}var a$M=a$jt._staticBatchManagers;for(a$S=0,a$V=a$M.length;a$S<a$V;a$S++)a$M[a$S]._clearRenderElements();for(a$W._clearRenderElements(),a$k._cullingRenders.length=0,a$k.treeRoot.cullingObjects(a$t,!0,0,a$v.transform.position,a$u),a$S=0,a$V=a$M.length;a$S<a$V;a$S++)a$M[a$S]._addToRenderQueue(a$k,a$j,a$Q,a$u);a$W._finishCombineDynamicBatch(a$k),a$W._addToRenderQueue(a$k,a$j,a$Q,a$u)},a$t.renderObjectCullingNoBoundFrustum=function(a$t,a$k,a$v,a$j,a$Q){var a$u=0,a$S=0,a$V=0,a$J=0,a$W=a$t._quenes,a$w=a$t._dynamicBatchManager,a$M=a$t._cullingRenders;for(a$u=0,a$S=a$W.length;a$u<a$S;a$u++){var a$H=a$W[a$u];a$H&&a$H._clearRenderElements()}var a$E=a$jt._staticBatchManagers;for(a$u=0,a$S=a$E.length;a$u<a$S;a$u++)a$E[a$u]._clearRenderElements();a$w._clearRenderElements();var a$A=a$k.transform.position;for(a$u=0,a$S=a$t._cullingRendersLength;a$u<a$S;a$u++){var a$R=a$M[a$u];if(a$G.isVisible(a$R._owner.layer.mask)&&a$R.enable){a$R._renderUpdate(a$Q),a$R._distanceForSort=a$Sk.distance(a$R.boundingSphere.center,a$A)+a$R.sortingFudge;var a$h=a$R._renderElements;for(a$V=0,a$J=a$h.length;a$V<a$J;a$V++){var a$l=a$h[a$V],a$o=a$l._staticBatch;if(a$o&&a$o._material===a$l._material)a$o._addBatchRenderElement(a$l);else{var a$Y=a$l.renderObj;a$Y.triangleCount<10&&1===a$Y._vertexBufferCount&&a$Y._getIndexBuffer()&&a$l._material.renderQueue<2&&a$l._canDynamicBatch&&!a$R._owner.isStatic?a$w._addPrepareRenderElement(a$l):a$t.getRenderQueue(a$l._material.renderQueue)._addRenderElement(a$l)}}}}for(a$u=0,a$S=a$E.length;a$u<a$S;a$u++)a$E[a$u]._addToRenderQueue(a$t,a$v,a$j,a$Q);a$w._finishCombineDynamicBatch(a$t),a$w._addToRenderQueue(a$t,a$v,a$j,a$Q)},a$t}(),a$jt=function(){function a$u(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}a$E(a$u,"laya.d3.graphics.StaticBatchManager");var a$t=a$u.prototype;return a$t._finishInit=function(){for(var a$t in this._staticBatches)this._staticBatches[a$t]._finishInit();this._initBatchRenderElements.length=0},a$t._initStaticBatchs=function(a$t){throw new Error("StaticBatchManager:must override this function.")},a$t._addInitBatchSprite=function(a$t){for(var a$k=a$t._render._renderElements,a$v=0,a$j=a$k.length;a$v<a$j;a$v++)this._initBatchRenderElements.push(a$k[a$v])},a$t._clearRenderElements=function(){for(var a$t in this._staticBatches)this._staticBatches[a$t]._clearRenderElements()},a$t._garbageCollection=function(a$t){var a$k=a$t._staticBatch,a$v=a$k._initBatchRenderElements,a$j=a$v.indexOf(a$t);a$v.splice(a$j,1),0===a$v.length&&(a$k.dispose(),delete this._staticBatches[a$k._key])},a$t._addToRenderQueue=function(a$t,a$k,a$v,a$j){for(var a$Q in this._staticBatches){var a$u=this._staticBatches[a$Q];0<a$u._batchRenderElements.length&&a$u._updateToRenderQueue(a$t,a$j)}},a$t.dispose=function(){this._staticBatches=null},a$u._addToStaticBatchQueue=function(a$t){a$t instanceof laya.d3.core.RenderableSprite3D&&a$t._addToInitStaticBatchManager();for(var a$k=0,a$v=a$t.numChildren;a$k<a$v;a$k++)a$u._addToStaticBatchQueue(a$t._childs[a$k])},a$u.combine=function(a$t,a$k){var a$v,a$j=0,a$Q=0;if(a$k)for(a$j=0,a$Q=a$k.length;a$j<a$Q;a$j++){a$k[a$j]._addToInitStaticBatchManager()}else a$t&&a$u._addToStaticBatchQueue(a$t);for(a$j=0,a$Q=a$u._staticBatchManagers.length;a$j<a$Q;a$j++)(a$v=a$u._staticBatchManagers[a$j])._initStaticBatchs(a$t),a$v._finishInit()},a$u._staticBatchManagers=[],a$u}(),a$Qt=function(){function a$t(a$t,a$k,a$v){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=a$t,this._manager=a$k,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=a$v}a$E(a$t,"laya.d3.graphics.StaticBatch");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),a$k._binarySearch=function(a$t){for(var a$k=0,a$v=this._batchRenderElements.length-1,a$j=0;a$k<=a$v;)a$j=Math.floor((a$k+a$v)/2),this._compareBatchRenderElement(this._batchRenderElements[a$j],a$t)?a$v=a$j-1:a$k=a$j+1;return a$k},a$k._compareBatchRenderElement=function(a$t,a$k){throw new Error("StaticBatch:must override this function.")},a$k._getVertexDecLightMap=function(a$t){return a$t===a$nt.vertexDeclaration?a$Gt.vertexDeclaration:a$t===a$Ot.vertexDeclaration?a$zt.vertexDeclaration:a$t===a$Zt.vertexDeclaration?a$ft.vertexDeclaration:a$t===a$it.vertexDeclaration?null:a$t===a$Rt.vertexDeclaration?a$ht.vertexDeclaration:a$t===a$xt.vertexDeclaration?a$Tt.vertexDeclaration:a$t===a$Nt.vertexDeclaration?a$at.vertexDeclaration:a$t===a$_t.vertexDeclaration?a$ct.vertexDeclaration:a$t===a$Ot.vertexDeclaration?a$zt.vertexDeclaration:a$t===a$st.vertexDeclaration?a$Xt.vertexDeclaration:a$t===a$it.vertexDeclaration?null:a$t===a$Rt.vertexDeclaration?a$ht.vertexDeclaration:a$t===a$It.vertexDeclaration?a$pt.vertexDeclaration:a$t===a$Nt.vertexDeclaration?a$at.vertexDeclaration:a$t},a$k._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},a$k._addBatchRenderElement=function(a$t){this._batchRenderElements.splice(this._binarySearch(a$t),0,a$t)},a$k._updateToRenderQueue=function(a$t,a$k){this._combineRenderElementPoolIndex=0,this._getRenderElement(a$t.getRenderQueue(this._material.renderQueue)._renderElements,a$t,a$k)},a$k._getRenderElement=function(a$t,a$k,a$v){throw new Error("StaticBatch:must override this function.")},a$k._finishInit=function(){throw new Error("StaticBatch:must override this function.")},a$k._clearRenderElements=function(){this._batchRenderElements.length=0},a$k.dispose=function(){},a$k._getVertexBuffer=function(a$t){return void 0===a$t&&(a$t=0),null},a$k._getIndexBuffer=function(){return null},a$k._beforeRender=function(a$t){return!0},a$k._render=function(a$t){},a$k._getVertexBuffers=function(){return null},a$A(0,a$k,"_vertexBufferCount",function(){return 1}),a$A(0,a$k,"triangleCount",function(){return 0}),a$t.combine=function(a$t){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),a$jt.combine(a$t)},a$t.maxBatchVertexCount=65535,a$t}(),a$ut=function(){function a$S(a$t,a$k){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++a$S._uniqueIDCounter,this._id>a$S.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",a$S.maxVertexDeclaration);this._shaderValues=new a$Hk,this._vertexElementsDic={},this._vertexStride=a$t,this._vertexElements=a$k;for(var a$v=0;a$v<a$k.length;a$v++){var a$j=a$k[a$v],a$Q=a$j.elementUsage;this._vertexElementsDic[a$Q]=a$j;var a$u=[a$S._getTypeSize(a$j.elementFormat)/4,5126,!1,this._vertexStride,a$j.offset];switch(this._shaderValues.setValue(a$Q,a$u),a$Q){case 1:this._addShaderDefine(a$mk.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(a$mk.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(a$mk.SHADERDEFINE_UV1)}}}a$E(a$S,"laya.d3.graphics.VertexDeclaration");var a$t=a$S.prototype;return a$t._addShaderDefine=function(a$t){this._shaderDefineValue|=a$t},a$t._removeShaderDefine=function(a$t){this._shaderDefineValue&=~a$t},a$t.getVertexElements=function(){return this._vertexElements.slice()},a$t.getVertexElementByUsage=function(a$t){return this._vertexElementsDic[a$t]},a$t.unBinding=function(){},a$A(0,a$t,"shaderDefineValue",function(){return this._shaderDefineValue}),a$A(0,a$t,"id",function(){return this._id}),a$A(0,a$t,"vertexStride",function(){return this._vertexStride}),a$A(0,a$t,"shaderValues",function(){return this._shaderValues}),a$S._getTypeSize=function(a$t){switch(a$t){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},a$S.getVertexStride=function(a$t){for(var a$k=0,a$v=0;a$v<a$t.Length;a$v++){var a$j=a$t[a$v],a$Q=a$j.offset+a$S._getTypeSize(a$j.elementFormat);a$k<a$Q&&(a$k=a$Q)}return a$k},a$S._maxVertexDeclarationBit=1e3,a$S._uniqueIDCounter=1,a$M(a$S,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),a$S}(),a$St=function(){function a$t(a$t,a$k,a$v){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=a$t,this.elementFormat=a$k,this.elementUsage=a$v}return a$E(a$t,"laya.d3.graphics.VertexElement"),a$t}(),a$Vt=(function(){function a$t(){}a$E(a$t,"laya.d3.graphics.VertexElementFormat"),a$t.Single="single",a$t.Vector2="vector2",a$t.Vector3="vector3",a$t.Vector4="vector4",a$t.Color="color",a$t.Byte4="byte4",a$t.Short2="short2",a$t.Short4="short4",a$t.NormalizedShort2="normalizedshort2",a$t.NormalizedShort4="normalizedshort4",a$t.HalfVector2="halfvector2",a$t.HalfVector4="halfvector4"}(),function(){function a$t(){}a$E(a$t,"laya.d3.graphics.VertexElementUsage"),a$t.POSITION0=0,a$t.COLOR0=1,a$t.TEXTURECOORDINATE0=2,a$t.NORMAL0=3,a$t.BINORMAL0=4,a$t.TANGENT0=5,a$t.BLENDINDICES0=6,a$t.BLENDWEIGHT0=7,a$t.DEPTH0=8,a$t.FOG0=9,a$t.POINTSIZE0=10,a$t.SAMPLE0=11,a$t.TESSELLATEFACTOR0=12,a$t.COLOR1=13,a$t.NEXTTEXTURECOORDINATE0=14,a$t.TEXTURECOORDINATE1=15,a$t.NEXTTEXTURECOORDINATE1=16,a$t.CORNERTEXTURECOORDINATE0=17,a$t.VELOCITY0=18,a$t.STARTCOLOR0=19,a$t.STARTSIZE=20,a$t.AGEADDSCALE0=21,a$t.STARTROTATION=22,a$t.ENDCOLOR0=23,a$t.STARTLIFETIME=24,a$t.TIME0=33,a$t.SHAPEPOSITIONSTARTLIFETIME=30,a$t.DIRECTIONTIME=32,a$t.SIZEROTATION0=27,a$t.RADIUS0=28,a$t.RADIAN0=29,a$t.STARTSPEED=31,a$t.RANDOM0=34,a$t.RANDOM1=35,a$t.SIMULATIONWORLDPOSTION=36,a$t.SIMULATIONWORLDROTATION=37,a$t.TEXTURECOORDINATE0X=38,a$t.TEXTURECOORDINATE0X1=39,a$t.TEXTURECOORDINATE0Y=40,a$t.OFFSETVECTOR=41}(),function(){function a$t(a$t,a$k,a$v){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=a$t,this._textureCoordinate0=a$k,this._time=a$v}a$E(a$t,"laya.d3.graphics.VertexGlitter");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate0}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"time",function(){return this._time}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(24,[new a$St(0,"vector3",0),new a$St(12,"vector2",2),new a$St(20,"single",33)])}])}(),function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=a$t,this._position=a$k,this._velocity=a$v,this._startColor=a$j,this._endColor=a$Q,this._sizeRotation=a$u,this._radius=a$S,this._radian=a$V,this._ageAddScale=a$J,this._time=a$W}a$E(a$t,"laya.d3.graphics.VertexParticle");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"endColor",function(){return this._endColor}),a$A(0,a$k,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),a$A(0,a$k,"sizeRotation",function(){return this._sizeRotation}),a$A(0,a$k,"velocity",function(){return this._velocity}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"startColor",function(){return this._startColor}),a$A(0,a$k,"radius",function(){return this._radius}),a$A(0,a$k,"radian",function(){return this._radian}),a$A(0,a$k,"ageAddScale",function(){return this._ageAddScale}),a$A(0,a$k,"time",function(){return this._time}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(116,[new a$St(0,"vector4",17),new a$St(16,"vector3",0),new a$St(28,"vector3",18),new a$St(40,"vector4",19),new a$St(56,"vector4",23),new a$St(72,"vector3",27),new a$St(84,"vector2",28),new a$St(92,"vector4",29),new a$St(108,"single",24),new a$St(112,"single",33)])}])}(),function(){function a$t(a$t){this._position=null,this._position=a$t}a$E(a$t,"laya.d3.graphics.VertexPosition");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(12,[new a$St(0,"vector3",0)])}]),a$t}()),a$Jt=function(){function a$t(a$t,a$k){this._position=null,this._normal=null,this._position=a$t,this._normal=a$k}a$E(a$t,"laya.d3.graphics.VertexPositionNormal");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(24,[new a$St(0,"vector3",0),new a$St(12,"vector3",3)])}]),a$t}(),a$Wt=function(){function a$t(a$t,a$k,a$v){this._position=null,this._normal=null,this._color=null,this._position=a$t,this._normal=a$k,this._color=a$v}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColor");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(40,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1)])}]),a$t}(),a$wt=function(){function a$t(a$t,a$k,a$v,a$j,a$Q){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._blendIndex=a$j,this._blendWeight=a$Q}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorSkin");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(72,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector4",7),new a$St(56,"vector4",6)])}]),a$t}(),a$Mt=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._tangent=a$j,this._blendIndex=a$Q,this._blendWeight=a$u}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(88,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector4",7),new a$St(56,"vector4",6),new a$St(72,"vector4",5)])}]),a$t}(),a$Ht=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._tangent=a$j,this._blendIndex=a$Q,this._blendWeight=a$u}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(84,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector4",7),new a$St(56,"vector4",6),new a$St(72,"vector3",5)])}]),a$t}(),a$Et=function(){function a$t(a$t,a$k,a$v,a$j){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._tangent=a$j}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorSTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(56,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector4",5)])}]),a$t}(),a$At=function(){function a$t(a$t,a$k,a$v,a$j){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._tangent=a$j}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(52,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector3",5)])}]),a$t}(),a$Rt=function(){function a$t(a$t,a$k,a$v,a$j){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._textureCoordinate=a$j}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorTexture");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(48,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector2",2)])}]),a$t}(),a$ht=function(){function a$t(a$t,a$k,a$v,a$j,a$Q){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._textureCoordinate0=a$j,this._textureCoordinate1=a$Q}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(0,a$k,"textureCoordinate1",function(){return this._textureCoordinate1}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(56,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector2",2),new a$St(48,"vector2",15)])}]),a$t}(),a$lt=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._textureCoordinate0=a$j,this._textureCoordinate1=a$Q,this._blendIndex=a$u,this._blendWeight=a$S}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(0,a$k,"textureCoordinate1",function(){return this._textureCoordinate1}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(88,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector2",2),new a$St(48,"vector2",15),new a$St(56,"vector4",7),new a$St(72,"vector4",6)])}]),a$t}(),a$ot=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._textureCoordinate0=a$j,this._textureCoordinate1=a$Q,this._tangent=a$u,this._blendIndex=a$S,this._blendWeight=a$V}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(0,a$k,"textureCoordinate1",function(){return this._textureCoordinate1}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(104,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector2",2),new a$St(48,"vector2",15),new a$St(56,"vector4",7),new a$St(72,"vector4",6),new a$St(88,"vector4",5)])}]),a$t}(),a$Yt=function(){function a$t(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$k.VertexPositionNormalColorTexture0SkinTangent=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){this._position=a$t,this._normal=a$k,this._color=a$v,this._textureCoordinate0=a$j,this._textureCoordinate1=a$Q,this._tangent=a$u,this._blendIndex=a$S,this._blendWeight=a$V},a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(0,a$k,"textureCoordinate1",function(){return this._textureCoordinate1}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(100,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector2",2),new a$St(48,"vector2",15),new a$St(56,"vector4",7),new a$St(72,"vector4",6),new a$St(88,"vector3",5)])}]),a$t}(),a$ft=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._textureCoordinate0=a$j,this._textureCoordinate1=a$Q,this._tangent=a$u}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(0,a$k,"textureCoordinate1",function(){return this._textureCoordinate1}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(72,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector2",2),new a$St(48,"vector2",15),new a$St(56,"vector4",5)])}]),a$t}(),a$Xt=function(){function a$t(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$k.VertexPositionNormalColorTexture0Tangent=function(a$t,a$k,a$v,a$j,a$Q,a$u){this._position=a$t,this._normal=a$k,this._color=a$v,this._textureCoordinate0=a$j,this._textureCoordinate1=a$Q,this._tangent=a$u},a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(0,a$k,"textureCoordinate1",function(){return this._textureCoordinate1}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(68,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector2",2),new a$St(48,"vector2",15),new a$St(56,"vector3",5)])}]),a$t}(),a$Ft=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._textureCoordinate=a$j,this._blendIndex=a$Q,this._blendWeight=a$u}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(80,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector2",2),new a$St(48,"vector4",7),new a$St(64,"vector4",6)])}]),a$t}(),a$dt=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._textureCoordinate=a$j,this._tangent=a$Q,this._blendIndex=a$u,this._blendWeight=a$S}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(96,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector2",2),new a$St(48,"vector4",7),new a$St(64,"vector4",6),new a$St(80,"vector4",5)])}]),a$t}(),a$mt=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._textureCoordinate=a$j,this._tangent=a$Q,this._blendIndex=a$u,this._blendWeight=a$S}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(92,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector2",2),new a$St(48,"vector4",7),new a$St(64,"vector4",6),new a$St(80,"vector3",5)])}]),a$t}(),a$Zt=function(){function a$t(a$t,a$k,a$v,a$j,a$Q){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._textureCoordinate=a$j,this._tangent=a$Q}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(64,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector2",2),new a$St(48,"vector4",5)])}]),a$t}(),a$st=function(){function a$t(a$t,a$k,a$v,a$j,a$Q){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._color=a$v,this._textureCoordinate=a$j,this._tangent=a$Q}a$E(a$t,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"color",function(){return this._color}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(60,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",1),new a$St(40,"vector2",2),new a$St(48,"vector3",5)])}]),a$t}(),a$Kt=function(){function a$t(a$t,a$k,a$v){this._position=null,this._normal=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._tangent=a$v}a$E(a$t,"laya.d3.graphics.VertexPositionNormalSTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(40,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector4",5)])}]),a$t}(),a$Ut=function(){function a$t(a$t,a$k,a$v){this._position=null,this._normal=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._tangent=a$v}a$E(a$t,"laya.d3.graphics.VertexPositionNormalTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(36,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector3",5)])}]),a$t}(),a$Nt=function(){function a$t(a$t,a$k,a$v){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=a$t,this._normal=a$k,this._textureCoordinate=a$v}a$E(a$t,"laya.d3.graphics.VertexPositionNormalTexture");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(32,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector2",2)])}]),a$t}(),a$at=function(){function a$t(a$t,a$k,a$v,a$j){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=a$t,this._normal=a$k,this._textureCoordinate0=a$v,this._textureCoordinate1=a$j}a$E(a$t,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(0,a$k,"textureCoordinate1",function(){return this._textureCoordinate1}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(40,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector2",2),new a$St(32,"vector2",15)])}]),a$t}(),a$zt=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=a$t,this._normal=a$k,this._textureCoordinate0=a$v,this._textureCoordinate1=a$j,this._blendIndex=a$Q,this._blendWeight=a$u}a$E(a$t,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(0,a$k,"textureCoordinate1",function(){return this._textureCoordinate1}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(72,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector2",2),new a$St(32,"vector2",15),new a$St(40,"vector4",7),new a$St(56,"vector4",6)])}]),a$t}(),a$Gt=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._textureCoordinate0=a$v,this._textureCoordinate1=a$j,this._tangent=a$Q,this._blendIndex=a$u,this._blendWeight=a$S}a$E(a$t,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(0,a$k,"textureCoordinate1",function(){return this._textureCoordinate1}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(88,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector2",2),new a$St(32,"vector2",15),new a$St(40,"vector4",7),new a$St(56,"vector4",6),new a$St(72,"vector4",5)])}]),a$t}(),a$ct=function(){function a$t(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}a$E(a$t,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$k.VertexPositionNormalTexture0SkinTangent=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){this._position=a$t,this._normal=a$k,this._textureCoordinate0=a$v,this._textureCoordinate1=a$j,this._tangent=a$Q,this._blendIndex=a$u,this._blendWeight=a$S},a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(0,a$k,"textureCoordinate1",function(){return this._textureCoordinate1}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(84,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector2",2),new a$St(32,"vector2",15),new a$St(40,"vector4",7),new a$St(56,"vector4",6),new a$St(72,"vector3",5)])}]),a$t}(),a$Tt=function(){function a$t(a$t,a$k,a$v,a$j,a$Q){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._textureCoordinate0=a$v,this._textureCoordinate1=a$j,this._tangent=a$Q}a$E(a$t,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(0,a$k,"textureCoordinate1",function(){return this._textureCoordinate1}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(56,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector2",2),new a$St(32,"vector2",15),new a$St(40,"vector4",5)])}]),a$t}(),a$pt=function(){function a$t(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}a$E(a$t,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$k.VertexPositionNormalTexture0Tangent=function(a$t,a$k,a$v,a$j,a$Q){this._position=a$t,this._normal=a$k,this._textureCoordinate0=a$v,this._textureCoordinate1=a$j,this._tangent=a$Q},a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(0,a$k,"textureCoordinate1",function(){return this._textureCoordinate1}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(52,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector2",2),new a$St(32,"vector2",15),new a$St(40,"vector3",5)])}]),a$t}(),a$Ot=function(){function a$t(a$t,a$k,a$v,a$j,a$Q){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=a$t,this._normal=a$k,this._textureCoordinate=a$v,this._blendIndex=a$j,this._blendWeight=a$Q}a$E(a$t,"laya.d3.graphics.VertexPositionNormalTextureSkin");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(64,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector2",2),new a$St(32,"vector4",7),new a$St(48,"vector4",6)])}]),a$t}(),a$nt=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._textureCoordinate=a$v,this._tangent=a$j,this._blendIndex=a$Q,this._blendWeight=a$u}a$E(a$t,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(80,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector2",2),new a$St(32,"vector4",7),new a$St(48,"vector4",6),new a$St(64,"vector4",5)])}]),a$t}(),a$_t=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._textureCoordinate=a$v,this._tangent=a$j,this._blendIndex=a$Q,this._blendWeight=a$u}a$E(a$t,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(76,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector2",2),new a$St(32,"vector4",7),new a$St(48,"vector4",6),new a$St(64,"vector3",5)])}]),a$t}(),a$xt=function(){function a$t(a$t,a$k,a$v,a$j){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._textureCoordinate=a$v,this._tangent=a$j}a$E(a$t,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(48,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector2",2),new a$St(32,"vector4",5)])}]),a$t}(),a$It=function(){function a$t(a$t,a$k,a$v,a$j){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=a$t,this._normal=a$k,this._textureCoordinate=a$v,this._tangent=a$j}a$E(a$t,"laya.d3.graphics.VertexPositionNormalTextureTangent");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(44,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector2",2),new a$St(32,"vector3",5)])}]),a$t}(),a$it=function(){function a$t(a$t,a$k,a$v){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=a$t,this._normal=a$k,this._textureCoordinate=a$v}a$E(a$t,"laya.d3.graphics.VertexPositionNTBTexture");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(56,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector3",5),new a$St(36,"vector3",4),new a$St(48,"vector2",2)])}]),a$t}(),a$Dt=function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=a$t,this._normal=a$k,this._textureCoordinate0=a$j,this._textureCoordinate1=a$Q,this._tangent=a$u,a$v=a$v,this._blendIndex=a$S,this._blendWeight=a$V}a$E(a$t,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"tangent",function(){return this._tangent}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(0,a$k,"textureCoordinate1",function(){return this._textureCoordinate1}),a$A(0,a$k,"blendIndex",function(){return this._blendIndex}),a$A(0,a$k,"blendWeight",function(){return this._blendWeight}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(96,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector3",5),new a$St(36,"vector3",4),new a$St(48,"vector2",2),new a$St(56,"vector2",15),new a$St(64,"vector4",7),new a$St(80,"vector4",6)])}]),a$t}(),a$Bt=function(){function a$t(a$t,a$k,a$v){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=a$t,this._normal=a$k,this._textureCoordinate=a$v}a$E(a$t,"laya.d3.graphics.VertexPositionNTBTextureSkin");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"textureCoordinate",function(){return this._textureCoordinate}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(88,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector3",5),new a$St(36,"vector3",4),new a$St(48,"vector2",2),new a$St(56,"vector4",7),new a$St(72,"vector4",6)])}]),a$t}(),a$bt=(function(){function a$t(a$t,a$k,a$v,a$j){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=a$t,this._normal=a$k,this._textureCoord0=a$v,this._textureCoord1=a$j}a$E(a$t,"laya.d3.graphics.VertexPositionTerrain");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"normal",function(){return this._normal}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"textureCoord0",function(){return this._textureCoord0}),a$A(0,a$k,"textureCoord1",function(){return this._textureCoord1}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(40,[new a$St(0,"vector3",0),new a$St(12,"vector3",3),new a$St(24,"vector2",2),new a$St(32,"vector2",15)])}])}(),function(){function a$t(a$t,a$k){this._position=null,this._textureCoordinate0=null,this._position=a$t,this._textureCoordinate0=a$k}a$E(a$t,"laya.d3.graphics.VertexPositionTexture0");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"position",function(){return this._position}),a$A(0,a$k,"textureCoordinate0",function(){return this._textureCoordinate0}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(20,[new a$St(0,"vector3",0),new a$St(12,"vector2",2)])}]),a$t}()),a$qt=(function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w,a$M,a$H,a$E){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=a$t,this._positionStartLifeTime=a$k,this._velocity=a$v,this._startColor=a$j,this._startSize=a$Q,this._startRotation0=a$u,this._startRotation1=a$S,this._startRotation2=a$V,this._startLifeTime=a$J,this._time=a$W,this._startSpeed=a$w,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=a$E}a$E(a$t,"laya.d3.graphics.VertexShurikenParticleBillboard");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),a$A(0,a$k,"random1",function(){return this._randoms1}),a$A(0,a$k,"startRotation2",function(){return this._startRotation2}),a$A(0,a$k,"positionStartLifeTime",function(){return this._positionStartLifeTime}),a$A(0,a$k,"velocity",function(){return this._velocity}),a$A(0,a$k,"random0",function(){return this._randoms0}),a$A(0,a$k,"startSize",function(){return this._startSize}),a$A(0,a$k,"startColor",function(){return this._startColor}),a$A(0,a$k,"startRotation0",function(){return this._startRotation0}),a$A(0,a$k,"startRotation1",function(){return this._startRotation1}),a$A(0,a$k,"startLifeTime",function(){return this._startLifeTime}),a$A(0,a$k,"time",function(){return this._time}),a$A(0,a$k,"startSpeed",function(){return this._startSpeed}),a$A(0,a$k,"simulationWorldPostion",function(){return this._simulationWorldPostion}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(152,[new a$St(0,"vector4",17),new a$St(16,"vector4",30),new a$St(32,"vector4",32),new a$St(48,"vector4",19),new a$St(64,"vector3",20),new a$St(76,"vector3",22),new a$St(88,"single",31),new a$St(92,"vector4",34),new a$St(108,"vector4",35),new a$St(124,"vector3",36),new a$St(136,"vector4",37)])}])}(),function(){function a$t(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w,a$M,a$H,a$E){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=a$t,this._positionStartLifeTime=a$k,this._velocity=a$v,this._startColor=a$j,this._startSize=a$Q,this._startRotation0=a$u,this._startRotation1=a$S,this._startRotation2=a$V,this._startLifeTime=a$J,this._time=a$W,this._startSpeed=a$w,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=a$E}a$E(a$t,"laya.d3.graphics.VertexShurikenParticleMesh");var a$k=a$t.prototype;a$X.imps(a$k,{"laya.d3.graphics.IVertex":!0}),a$A(0,a$k,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),a$A(0,a$k,"velocity",function(){return this._velocity}),a$A(0,a$k,"position",function(){return this._positionStartLifeTime}),a$A(0,a$k,"random0",function(){return this._randoms0}),a$A(0,a$k,"startSize",function(){return this._startSize}),a$A(0,a$k,"startColor",function(){return this._startColor}),a$A(0,a$k,"startRotation0",function(){return this._startRotation0}),a$A(0,a$k,"startRotation1",function(){return this._startRotation1}),a$A(0,a$k,"random1",function(){return this._randoms1}),a$A(0,a$k,"startRotation2",function(){return this._startRotation2}),a$A(0,a$k,"startLifeTime",function(){return this._startLifeTime}),a$A(0,a$k,"time",function(){return this._time}),a$A(0,a$k,"startSpeed",function(){return this._startSpeed}),a$A(0,a$k,"simulationWorldPostion",function(){return this._simulationWorldPostion}),a$A(0,a$k,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$A(1,a$t,"vertexDeclaration",function(){return a$t._vertexDeclaration}),a$M(a$t,["_vertexDeclaration",function(){return this._vertexDeclaration=new a$ut(172,[new a$St(0,"vector3",0),new a$St(12,"vector4",1),new a$St(28,"vector2",2),new a$St(36,"vector4",30),new a$St(52,"vector4",32),new a$St(68,"vector4",19),new a$St(84,"vector3",20),new a$St(96,"vector3",22),new a$St(108,"single",31),new a$St(112,"vector4",34),new a$St(128,"vector4",35),new a$St(144,"vector3",36),new a$St(156,"vector4",37)])}])}(),function(){function a$Y(a$t,a$k,a$v,a$j,a$Q,a$u){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=a$v,this._materials=a$j,this._subMeshes=a$Q,this._materialMap=a$u,this._version=a$k,this._onLoaded(a$t)}a$E(a$Y,"laya.d3.loaders.LoadModelV01");var a$t=a$Y.prototype;return a$t._onLoaded=function(a$t){this._readData=a$t,this.READ_BLOCK();for(var a$k=0;a$k<this._BLOCK.count;a$k++){var a$v=this._readData.getUint16(),a$j=this._strings[a$v],a$Q=this["READ_"+a$j];if(null==a$Q)throw new Error("model file err,no this function:"+a$v+" "+a$j);if(!a$Q.call(this))break}return this._mesh},a$t.onError=function(){},a$t._readString=function(){return this._strings[this._readData.getUint16()]},a$t.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},a$t.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},a$t.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var a$t=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var a$k=0;a$k<this._STRINGS.size;a$k++)this._strings[a$k]=this._readData.readUTFString();return this._readData.pos=a$t,!0},a$t.READ_MATERIAL=function(){var a$t=this._readData.getUint16(),a$k=(this._readString(),this._readString());return this._materials[a$t]="null"!==a$k?a$l.getRes(this._materialMap[a$k]):new a$Uk,!0},a$t.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var a$t,a$k=this._readData.__getBuffer(),a$v=0,a$j=this._readData.getUint32(),a$Q=this._readData.getUint32(),a$u=(new Float32Array(a$k.slice(a$j+this._DATA.offset,a$j+this._DATA.offset+a$Q)),this._readData.getUint32()),a$S=this._readData.getUint32(),a$V=new Float32Array(a$k.slice(a$u+this._DATA.offset,a$u+this._DATA.offset+a$S));for(this.mesh._inverseBindPoses=[],a$v=0,a$t=a$V.length;a$v<a$t;a$v+=16){var a$J=new a$tk(a$V[a$v+0],a$V[a$v+1],a$V[a$v+2],a$V[a$v+3],a$V[a$v+4],a$V[a$v+5],a$V[a$v+6],a$V[a$v+7],a$V[a$v+8],a$V[a$v+9],a$V[a$v+10],a$V[a$v+11],a$V[a$v+12],a$V[a$v+13],a$V[a$v+14],a$V[a$v+15]);this.mesh._inverseBindPoses.push(a$J)}break;default:throw new Error("LoadModel:unknown version.")}return!0},a$t.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var a$t=this._readString();this._shaderAttributes=a$t.match(a$Y._attrReg);var a$k=this._readData.getUint32(),a$v=this._readData.getUint32(),a$j=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),a$Q=this._readData.getUint32(),a$u=this._readData.getUint32(),a$S=this._readData.getUint32(),a$V=this._readData.__getBuffer(),a$J=new a$Wk(this._mesh),a$W=this._getVertexDeclaration(),a$w=a$_k.create(a$W,a$Q/a$W.vertexStride,35044,!0),a$M=a$j+this._DATA.offset,a$H=a$V.slice(a$M,a$M+a$Q);a$w.setData(new Float32Array(a$H));for(var a$E=(a$J._vertexBuffer=a$w).vertexDeclaration.getVertexElements(),a$A=0;a$A<a$E.length;a$A++)a$J._bufferUsage[a$E[a$A].elementUsage]=a$w;var a$R=a$nk.create("ushort",a$v/2,35044,!0),a$h=a$k+this._DATA.offset,a$l=a$V.slice(a$h,a$h+a$v);a$R.setData(new Uint16Array(a$l)),a$J._indexBuffer=a$R;var a$o=a$V.slice(a$u+this._DATA.offset,a$u+this._DATA.offset+a$S);return a$J._boneIndicesList[0]=new Uint8Array(a$o),this._subMeshes.push(a$J),!0},a$t.READ_DATAAREA=function(){return!1},a$t._getVertexDeclaration=function(){for(var a$t,a$k=!1,a$v=!1,a$j=!1,a$Q=!1,a$u=!1,a$S=!1,a$V=!1,a$J=!1,a$W=!1,a$w=0;a$w<this._shaderAttributes.length;a$w+=8)switch(this._shaderAttributes[a$w]){case"POSITION":a$k=!0;break;case"NORMAL":a$v=!0;break;case"COLOR":a$j=!0;break;case"UV":a$Q=!0;break;case"UV1":a$u=!0;break;case"BLENDWEIGHT":a$V=!0;break;case"BLENDINDICES":a$J=!0;break;case"TANGENT":a$S=!0;break;case"BINORMAL":a$W=!0}return a$k&&a$v&&a$j&&a$Q&&a$u&&a$V&&a$J&&a$S?a$t=a$Yt.vertexDeclaration:a$k&&a$v&&a$j&&a$Q&&a$u&&a$V&&a$J?a$t=a$lt.vertexDeclaration:a$k&&a$v&&a$Q&&a$u&&a$V&&a$J&&a$S?a$t=a$ct.vertexDeclaration:a$k&&a$v&&a$Q&&a$u&&a$V&&a$J?a$t=a$zt.vertexDeclaration:a$k&&a$v&&a$j&&a$Q&&a$V&&a$J&&a$S?a$t=a$mt.vertexDeclaration:a$k&&a$v&&a$j&&a$Q&&a$V&&a$J?a$t=a$Ft.vertexDeclaration:a$k&&a$v&&a$S&&a$W&&a$Q&&a$V&&a$J?a$t=a$Bt.vertexDeclaration:a$k&&a$v&&a$Q&&a$V&&a$J&&a$S?a$t=a$_t.vertexDeclaration:a$k&&a$v&&a$Q&&a$V&&a$J?a$t=a$Ot.vertexDeclaration:a$k&&a$v&&a$j&&a$V&&a$J&&a$S?a$t=a$Ht.vertexDeclaration:a$k&&a$v&&a$j&&a$V&&a$J?a$t=a$wt.vertexDeclaration:a$k&&a$v&&a$j&&a$Q&&a$u&&a$S?a$t=a$Xt.vertexDeclaration:a$k&&a$v&&a$j&&a$Q&&a$u?a$t=a$ht.vertexDeclaration:a$k&&a$v&&a$Q&&a$u&&a$S?a$t=a$pt.vertexDeclaration:a$k&&a$v&&a$Q&&a$u?a$t=a$at.vertexDeclaration:a$k&&a$v&&a$j&&a$Q&&a$S?a$t=a$st.vertexDeclaration:a$k&&a$v&&a$Q&&a$S&&a$W?a$t=a$it.vertexDeclaration:a$k&&a$v&&a$j&&a$Q?a$t=a$Rt.vertexDeclaration:a$k&&a$v&&a$Q&&a$S?a$t=a$It.vertexDeclaration:a$k&&a$v&&a$Q?a$t=a$Nt.vertexDeclaration:a$k&&a$v&&a$j&&a$S?a$t=a$At.vertexDeclaration:a$k&&a$v&&a$j&&(a$t=a$Wt.vertexDeclaration),a$t},a$A(0,a$t,"mesh",function(){return this._mesh}),a$Y._attrReg=new RegExp("(\\w+)|([:,;])","g"),a$Y}()),a$Ct=function(){function a$d(){}return a$E(a$d,"laya.d3.loaders.LoadModelV02"),a$d.parse=function(a$t,a$k,a$v,a$j,a$Q,a$u){a$d._mesh=a$v,a$d._materials=a$j,a$d._subMeshes=a$Q,a$d._materialMap=a$u,a$d._version=a$k,a$d._readData=a$t,a$d.READ_DATA(),a$d.READ_BLOCK(),a$d.READ_STRINGS();for(var a$S=0,a$V=a$d._BLOCK.count;a$S<a$V;a$S++){a$d._readData.pos=a$d._BLOCK.blockStarts[a$S];var a$J=a$d._readData.getUint16(),a$W=a$d._strings[a$J],a$w=a$d["READ_"+a$W];if(null==a$w)throw new Error("model file err,no this function:"+a$J+" "+a$W);a$w.call()}a$d._strings.length=0,a$d._readData=null,a$d._version=null,a$d._mesh=null,a$d._materials=null,a$d._subMeshes=null,a$d._materialMap=null},a$d._readString=function(){return a$d._strings[a$d._readData.getUint16()]},a$d.READ_DATA=function(){a$d._DATA.offset=a$d._readData.getUint32(),a$d._DATA.size=a$d._readData.getUint32()},a$d.READ_BLOCK=function(){for(var a$t=a$d._BLOCK.count=a$d._readData.getUint16(),a$k=a$d._BLOCK.blockStarts=[],a$v=a$d._BLOCK.blockLengths=[],a$j=0;a$j<a$t;a$j++)a$k.push(a$d._readData.getUint32()),a$v.push(a$d._readData.getUint32())},a$d.READ_STRINGS=function(){var a$t=a$d._readData.getUint32(),a$k=a$d._readData.getUint16(),a$v=a$d._readData.pos;a$d._readData.pos=a$t+a$d._DATA.offset;for(var a$j=0;a$j<a$k;a$j++)a$d._strings[a$j]=a$d._readData.readUTFString();a$d._readData.pos=a$v},a$d.READ_MATERIAL=function(){a$d._readString(),a$d._readString();var a$t=a$d._readString();return""!==a$t&&a$d._materials.push(a$l.getRes(a$d._materialMap[a$t])),!0},a$d.READ_MESH=function(){a$d._readString();var a$t,a$k=a$d._readData.__getBuffer(),a$v=0,a$j=a$d._readData.getInt16(),a$Q=a$d._DATA.offset;for(a$v=0;a$v<a$j;a$v++){var a$u=a$Q+a$d._readData.getUint32(),a$S=a$d._readData.getUint32(),a$V=new Float32Array(a$k.slice(a$u,a$u+a$S)),a$J=a$d._readString().match(a$d._attrReg),a$W=a$d._getVertexDeclaration(a$J),a$w=a$_k.create(a$W,4*a$V.length/a$W.vertexStride,35044,!0);a$w.setData(a$V),a$d._mesh._vertexBuffers.push(a$w)}var a$M=a$Q+a$d._readData.getUint32(),a$H=a$d._readData.getUint32(),a$E=new Uint16Array(a$k.slice(a$M,a$M+a$H)),a$A=a$nk.create("ushort",a$H/2,35044,!0);a$A.setData(a$E),a$d._mesh._indexBuffer=a$A;var a$R=a$d._mesh._boneNames=[],a$h=a$d._readData.getUint16();for(a$R.length=a$h,a$v=0;a$v<a$h;a$v++)a$R[a$v]=a$d._strings[a$d._readData.getUint16()];var a$l=a$d._readData.getUint32(),a$o=a$d._readData.getUint32(),a$Y=(new Float32Array(a$k.slice(a$Q+a$l,a$Q+a$l+a$o)),a$d._readData.getUint32()),a$f=a$d._readData.getUint32(),a$X=new Float32Array(a$k.slice(a$Q+a$Y,a$Q+a$Y+a$f));for(a$d._mesh._inverseBindPoses=[],a$v=0,a$t=a$X.length;a$v<a$t;a$v+=16){var a$F=new a$tk(a$X[a$v+0],a$X[a$v+1],a$X[a$v+2],a$X[a$v+3],a$X[a$v+4],a$X[a$v+5],a$X[a$v+6],a$X[a$v+7],a$X[a$v+8],a$X[a$v+9],a$X[a$v+10],a$X[a$v+11],a$X[a$v+12],a$X[a$v+13],a$X[a$v+14],a$X[a$v+15]);a$d._mesh._inverseBindPoses.push(a$F)}return a$d._mesh._skinnedDatas=new Float32Array(16*a$X.length),!0},a$d.READ_SUBMESH=function(){var a$t=a$d._readData.__getBuffer(),a$k=new a$Wk(a$d._mesh),a$v=a$d._readData.getInt16(),a$j=a$d._readData.getUint32(),a$Q=a$d._readData.getUint32();a$k._vertexBuffer=a$d._mesh._vertexBuffers[a$v],a$k._vertexStart=a$j,a$k._vertexCount=a$Q;var a$u=a$d._readData.getUint32(),a$S=a$d._readData.getUint32(),a$V=a$d._mesh._indexBuffer;a$k._indexBuffer=a$V,a$k._indexStart=a$u,a$k._indexCount=a$S,a$k._indices=new Uint16Array(a$V.getData().buffer,2*a$u,a$S);var a$J=a$d._DATA.offset,a$W=a$k._subIndexBufferStart,a$w=a$k._subIndexBufferCount,a$M=a$k._boneIndicesList,a$H=a$d._readData.getUint16();a$W.length=a$H,a$w.length=a$H,a$M.length=a$H;for(var a$E=0;a$E<a$H;a$E++){a$W[a$E]=a$d._readData.getUint32(),a$w[a$E]=a$d._readData.getUint32();var a$A=a$d._readData.getUint32(),a$R=a$d._readData.getUint32();a$k._boneIndicesList[a$E]=new Uint8Array(a$t.slice(a$J+a$A,a$J+a$A+a$R))}return a$d._subMeshes.push(a$k),!0},a$d._getVertexDeclaration=function(a$t){for(var a$k,a$v=!1,a$j=!1,a$Q=!1,a$u=!1,a$S=!1,a$V=!1,a$J=!1,a$W=!1,a$w=!1,a$M=0;a$M<a$t.length;a$M++)switch(a$t[a$M]){case"POSITION":a$v=!0;break;case"NORMAL":a$j=!0;break;case"COLOR":a$Q=!0;break;case"UV":a$u=!0;break;case"UV1":a$S=!0;break;case"BLENDWEIGHT":a$J=!0;break;case"BLENDINDICES":a$W=!0;break;case"TANGENT":a$V=!0;break;case"BINORMAL":a$w=!0}return a$v&&a$j&&a$Q&&a$u&&a$S&&a$J&&a$W&&a$V?a$k=a$Yt.vertexDeclaration:a$v&&a$j&&a$Q&&a$u&&a$S&&a$J&&a$W?a$k=a$lt.vertexDeclaration:a$v&&a$j&&a$u&&a$S&&a$J&&a$W&&a$V?a$k=a$ct.vertexDeclaration:a$v&&a$j&&a$u&&a$S&&a$J&&a$W?a$k=a$zt.vertexDeclaration:a$v&&a$j&&a$Q&&a$u&&a$J&&a$W&&a$V?a$k=a$mt.vertexDeclaration:a$v&&a$j&&a$Q&&a$u&&a$J&&a$W?a$k=a$Ft.vertexDeclaration:a$v&&a$j&&a$u&&a$J&&a$W&&a$V?a$k=a$_t.vertexDeclaration:a$v&&a$j&&a$u&&a$J&&a$W?a$k=a$Ot.vertexDeclaration:a$v&&a$j&&a$Q&&a$J&&a$W&&a$V?a$k=a$Ht.vertexDeclaration:a$v&&a$j&&a$Q&&a$J&&a$W?a$k=a$wt.vertexDeclaration:a$v&&a$j&&a$Q&&a$u&&a$S&&a$V?a$k=a$Xt.vertexDeclaration:a$v&&a$j&&a$Q&&a$u&&a$S?a$k=a$ht.vertexDeclaration:a$v&&a$j&&a$u&&a$S&&a$V?a$k=a$pt.vertexDeclaration:a$v&&a$j&&a$u&&a$S?a$k=a$at.vertexDeclaration:a$v&&a$j&&a$Q&&a$u&&a$V?a$k=a$st.vertexDeclaration:a$v&&a$j&&a$u&&a$V&&a$w?a$k=a$it.vertexDeclaration:a$v&&a$j&&a$Q&&a$u?a$k=a$Rt.vertexDeclaration:a$v&&a$j&&a$u&&a$V?a$k=a$It.vertexDeclaration:a$v&&a$j&&a$u?a$k=a$Nt.vertexDeclaration:a$v&&a$j&&a$Q&&a$V?a$k=a$At.vertexDeclaration:a$v&&a$j&&a$Q&&(a$k=a$Wt.vertexDeclaration),a$k},a$d._attrReg=new RegExp("(\\w+)|([:,;])","g"),a$d._strings=[],a$d._readData=null,a$d._version=null,a$d._mesh=null,a$d._materials=null,a$d._subMeshes=null,a$d._materialMap=null,a$M(a$d,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),a$d}(),a$Lt=function(){function a$F(){}return a$E(a$F,"laya.d3.loaders.LoadModelV03"),a$F.parse=function(a$t,a$k,a$v,a$j,a$Q){a$F._mesh=a$v,a$F._subMeshes=a$j,a$F._materialMap=a$Q,a$F._version=a$k,a$F._readData=a$t,a$F.READ_DATA(),a$F.READ_BLOCK(),a$F.READ_STRINGS();for(var a$u=0,a$S=a$F._BLOCK.count;a$u<a$S;a$u++){a$F._readData.pos=a$F._BLOCK.blockStarts[a$u];var a$V=a$F._readData.getUint16(),a$J=a$F._strings[a$V],a$W=a$F["READ_"+a$J];if(null==a$W)throw new Error("model file err,no this function:"+a$V+" "+a$J);a$W.call()}a$F._strings.length=0,a$F._readData=null,a$F._version=null,a$F._mesh=null,a$F._subMeshes=null,a$F._materialMap=null},a$F._readString=function(){return a$F._strings[a$F._readData.getUint16()]},a$F.READ_DATA=function(){a$F._DATA.offset=a$F._readData.getUint32(),a$F._DATA.size=a$F._readData.getUint32()},a$F.READ_BLOCK=function(){for(var a$t=a$F._BLOCK.count=a$F._readData.getUint16(),a$k=a$F._BLOCK.blockStarts=[],a$v=a$F._BLOCK.blockLengths=[],a$j=0;a$j<a$t;a$j++)a$k.push(a$F._readData.getUint32()),a$v.push(a$F._readData.getUint32())},a$F.READ_STRINGS=function(){var a$t=a$F._readData.getUint32(),a$k=a$F._readData.getUint16(),a$v=a$F._readData.pos;a$F._readData.pos=a$t+a$F._DATA.offset;for(var a$j=0;a$j<a$k;a$j++)a$F._strings[a$j]=a$F._readData.readUTFString();a$F._readData.pos=a$v},a$F.READ_MESH=function(){var a$t,a$k=a$F._readString(),a$v=a$F._readData.__getBuffer(),a$j=0,a$Q=a$F._readData.getInt16(),a$u=a$F._DATA.offset;for(a$j=0;a$j<a$Q;a$j++){var a$S,a$V=a$u+a$F._readData.getUint32(),a$J=a$F._readData.getUint32(),a$W=new Float32Array(a$v.slice(a$V,a$V+a$J)),a$w=a$F._readString();switch(a$F._version){case"LAYAMODEL:03":a$S=a$F._vertexDeclarationMap_Discard[a$w];break;case"LAYAMODEL:0301":a$S=a$F._vertexDeclarationMap[a$w];break;default:throw new Error("LoadModelV03: unknown version.")}if(!a$S)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+a$F._version+"  bufferAttribute="+a$w+"  name="+a$k+"  url="+(a$F._mesh?a$F._mesh.url:"null"));var a$M=a$_k.create(a$S,4*a$W.length/a$S.vertexStride,35044,!0,a$F._mesh._url+"_"+a$j);a$M.setData(a$W),a$F._mesh._vertexBuffers.push(a$M)}var a$H=a$u+a$F._readData.getUint32(),a$E=a$F._readData.getUint32(),a$A=new Uint16Array(a$v.slice(a$H,a$H+a$E)),a$R=a$nk.create("ushort",a$E/2,35044,!0,a$F._mesh._url);a$R.setData(a$A),a$F._mesh._indexBuffer=a$R;var a$h=a$F._mesh._boneNames=[],a$l=a$F._readData.getUint16();for(a$h.length=a$l,a$j=0;a$j<a$l;a$j++)a$h[a$j]=a$F._strings[a$F._readData.getUint16()];a$F._readData.pos+=8;var a$o=a$F._readData.getUint32(),a$Y=a$F._readData.getUint32(),a$f=new Float32Array(a$v.slice(a$u+a$o,a$u+a$o+a$Y));for(a$F._mesh._inverseBindPoses=[],a$j=0,a$t=a$f.length;a$j<a$t;a$j+=16){var a$X=new a$tk(a$f[a$j+0],a$f[a$j+1],a$f[a$j+2],a$f[a$j+3],a$f[a$j+4],a$f[a$j+5],a$f[a$j+6],a$f[a$j+7],a$f[a$j+8],a$f[a$j+9],a$f[a$j+10],a$f[a$j+11],a$f[a$j+12],a$f[a$j+13],a$f[a$j+14],a$f[a$j+15]);a$F._mesh._inverseBindPoses.push(a$X)}return a$F._mesh._skinnedDatas=new Float32Array(16*a$f.length),!0},a$F.READ_SUBMESH=function(){var a$t=a$F._readData.__getBuffer(),a$k=new a$Wk(a$F._mesh),a$v=a$F._readData.getInt16(),a$j=a$F._readData.getUint32(),a$Q=a$F._readData.getUint32();a$k._vertexBuffer=a$F._mesh._vertexBuffers[a$v],a$k._vertexStart=a$j,a$k._vertexCount=a$Q;var a$u=a$F._readData.getUint32(),a$S=a$F._readData.getUint32(),a$V=a$F._mesh._indexBuffer;a$k._indexBuffer=a$V,a$k._indexStart=a$u,a$k._indexCount=a$S,a$k._indices=new Uint16Array(a$V.getData().buffer,2*a$u,a$S);var a$J=a$F._DATA.offset,a$W=a$k._subIndexBufferStart,a$w=a$k._subIndexBufferCount,a$M=a$k._boneIndicesList,a$H=a$F._readData.getUint16();a$W.length=a$H,a$w.length=a$H,a$M.length=a$H;for(var a$E=0;a$E<a$H;a$E++){a$W[a$E]=a$F._readData.getUint32(),a$w[a$E]=a$F._readData.getUint32();var a$A=a$F._readData.getUint32(),a$R=a$F._readData.getUint32();a$M[a$E]=new Uint8Array(a$t.slice(a$J+a$A,a$J+a$A+a$R))}return a$F._subMeshes.push(a$k),!0},a$F._strings=[],a$F._readData=null,a$F._version=null,a$F._mesh=null,a$F._subMeshes=null,a$F._materialMap=null,a$M(a$F,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":a$Yt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":a$lt.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":a$Dt.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":a$ct.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":a$zt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":a$mt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":a$Ft.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":a$_t.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":a$Ot.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":a$Ht.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":a$wt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":a$Xt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":a$ht.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":a$pt.vertexDeclaration,"POSITION,NORMAL,UV,UV1":a$at.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":a$st.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":a$it.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":a$Rt.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":a$It.vertexDeclaration,"POSITION,NORMAL,UV":a$Nt.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":a$At.vertexDeclaration,"POSITION,NORMAL,COLOR":a$Wt.vertexDeclaration,"POSITION,NORMAL,TANGENT":a$Ut.vertexDeclaration,"POSITION,NORMAL":a$Jt.vertexDeclaration,"POSITION,UV":a$bt.vertexDeclaration,POSITION:a$Vt.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":a$ot.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":a$lt.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":a$Dt.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":a$Gt.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":a$zt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":a$dt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":a$Ft.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":a$nt.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":a$Ot.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":a$Mt.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":a$wt.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":a$ft.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":a$ht.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":a$Tt.vertexDeclaration,"POSITION,NORMAL,UV,UV1":a$at.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":a$Zt.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":a$it.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":a$Rt.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":a$xt.vertexDeclaration,"POSITION,NORMAL,UV":a$Nt.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":a$Et.vertexDeclaration,"POSITION,NORMAL,COLOR":a$Wt.vertexDeclaration,"POSITION,NORMAL,TANGENT":a$Kt.vertexDeclaration,"POSITION,NORMAL":a$Jt.vertexDeclaration,"POSITION,UV":a$bt.vertexDeclaration,POSITION:a$Vt.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),a$F}(),a$et=function(){function a$V(){}return a$E(a$V,"laya.d3.loaders.MeshReader"),a$V.read=function(a$t,a$k,a$v,a$j,a$Q){var a$u=new a$F(a$t);a$u.pos=0;var a$S=a$u.readUTFString();switch(a$S){case"LAYAMODEL:01":case"LAYASKINANI:01":a$V._readVersion01(a$u,a$S,a$k,a$v,a$j,a$Q);break;case"LAYAMODEL:02":a$Ct.parse(a$u,a$S,a$k,a$v,a$j,a$Q);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":a$Lt.parse(a$u,a$S,a$k,a$j,a$Q);break;default:throw new Error("MeshReader: unknown mesh version.")}a$k._setSubMeshes(a$j)},a$V._readVersion01=function(a$t,a$k,a$v,a$j,a$Q,a$u){new a$qt(a$t,a$k,a$v,a$j,a$Q,a$u)},a$V}(),a$rt=function(){function a$t(a$t,a$k){this.min=null,this.max=null,this.min=a$t,this.max=a$k}a$E(a$t,"laya.d3.math.BoundBox");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k.getCorners=function(a$t){a$t.length=8;var a$k=this.min.elements,a$v=this.max.elements,a$j=a$k[0],a$Q=a$k[1],a$u=a$k[2],a$S=a$v[0],a$V=a$v[1],a$J=a$v[2];a$t[0]=new a$Sk(a$j,a$V,a$J),a$t[1]=new a$Sk(a$S,a$V,a$J),a$t[2]=new a$Sk(a$S,a$Q,a$J),a$t[3]=new a$Sk(a$j,a$Q,a$J),a$t[4]=new a$Sk(a$j,a$V,a$u),a$t[5]=new a$Sk(a$S,a$V,a$u),a$t[6]=new a$Sk(a$S,a$Q,a$u),a$t[7]=new a$Sk(a$j,a$Q,a$u)},a$k.toDefault=function(){this.min.toDefault(),this.max.toDefault()},a$k.cloneTo=function(a$t){var a$k=a$t;this.min.cloneTo(a$k.min),this.max.cloneTo(a$k.max)},a$k.clone=function(){var a$t=new this.constructor(new a$Sk,new a$Sk);return this.cloneTo(a$t),a$t},a$t.createfromPoints=function(a$t,a$k){if(null==a$t)throw new Error("points");var a$v=a$k.min,a$j=a$k.max,a$Q=a$v.elements;a$Q[0]=Number.MAX_VALUE,a$Q[1]=Number.MAX_VALUE,a$Q[2]=Number.MAX_VALUE;var a$u=a$j.elements;a$u[0]=-Number.MAX_VALUE,a$u[1]=-Number.MAX_VALUE,a$u[2]=-Number.MAX_VALUE;for(var a$S=0,a$V=a$t.length;a$S<a$V;++a$S)a$Sk.min(a$v,a$t[a$S],a$v),a$Sk.max(a$j,a$t[a$S],a$j)},a$t.merge=function(a$t,a$k,a$v){a$Sk.min(a$t.min,a$k.min,a$v.min),a$Sk.max(a$t.max,a$k.max,a$v.max)},a$t}(),a$gt=function(){function a$W(a$t){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=a$t,this._near=new a$kk(new a$Sk),this._far=new a$kk(new a$Sk),this._left=new a$kk(new a$Sk),this._right=new a$kk(new a$Sk),this._top=new a$kk(new a$Sk),this._bottom=new a$kk(new a$Sk),a$W._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}a$E(a$W,"laya.d3.math.BoundFrustum");var a$t=a$W.prototype;return a$t.equalsBoundFrustum=function(a$t){return this._matrix.equalsOtherMatrix(a$t.matrix)},a$t.equalsObj=function(a$t){if(a$t instanceof laya.d3.math.BoundFrustum){var a$k=a$t;return this.equalsBoundFrustum(a$k)}return!1},a$t.getPlane=function(a$t){switch(a$t){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},a$t.getCorners=function(a$t){a$W._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(a$t[0]),a$W._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(a$t[1]),a$W._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(a$t[2]),a$W._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(a$t[3]),a$W._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(a$t[4]),a$W._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(a$t[5]),a$W._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(a$t[6]),a$W._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(a$t[7])},a$t.containsPoint=function(a$t){for(var a$k=a$kk.PlaneIntersectionType_Front,a$v=a$kk.PlaneIntersectionType_Front,a$j=0;a$j<6;a$j++){switch(a$j){case 0:a$v=Collision.intersectsPlaneAndPoint(this._near,a$t);break;case 1:a$v=Collision.intersectsPlaneAndPoint(this._far,a$t);break;case 2:a$v=Collision.intersectsPlaneAndPoint(this._left,a$t);break;case 3:a$v=Collision.intersectsPlaneAndPoint(this._right,a$t);break;case 4:a$v=Collision.intersectsPlaneAndPoint(this._top,a$t);break;case 5:a$v=Collision.intersectsPlaneAndPoint(this._bottom,a$t)}switch(a$v){case a$kk.PlaneIntersectionType_Back:return 0;case a$kk.PlaneIntersectionType_Intersecting:a$k=a$kk.PlaneIntersectionType_Intersecting}}switch(a$k){case a$kk.PlaneIntersectionType_Intersecting:return 2;default:return 1}},a$t.containsBoundBox=function(a$t){for(var a$k,a$v=a$W._tempV30,a$j=a$W._tempV31,a$Q=1,a$u=0;a$u<6;a$u++){if(a$k=this.getPlane(a$u),this._getBoxToPlanePVertexNVertex(a$t,a$k.normal,a$v,a$j),Collision.intersectsPlaneAndPoint(a$k,a$v)===a$kk.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(a$k,a$j)===a$kk.PlaneIntersectionType_Back&&(a$Q=2)}return a$Q},a$t.containsBoundSphere=function(a$t){for(var a$k=a$kk.PlaneIntersectionType_Front,a$v=a$kk.PlaneIntersectionType_Front,a$j=0;a$j<6;a$j++){switch(a$j){case 0:a$v=Collision.intersectsPlaneAndSphere(this._near,a$t);break;case 1:a$v=Collision.intersectsPlaneAndSphere(this._far,a$t);break;case 2:a$v=Collision.intersectsPlaneAndSphere(this._left,a$t);break;case 3:a$v=Collision.intersectsPlaneAndSphere(this._right,a$t);break;case 4:a$v=Collision.intersectsPlaneAndSphere(this._top,a$t);break;case 5:a$v=Collision.intersectsPlaneAndSphere(this._bottom,a$t)}switch(a$v){case a$kk.PlaneIntersectionType_Back:return 0;case a$kk.PlaneIntersectionType_Intersecting:a$k=a$kk.PlaneIntersectionType_Intersecting}}switch(a$k){case a$kk.PlaneIntersectionType_Intersecting:return 2;default:return 1}},a$t._getBoxToPlanePVertexNVertex=function(a$t,a$k,a$v,a$j){var a$Q=a$t.min,a$u=a$Q.elements,a$S=a$t.max,a$V=a$S.elements,a$J=a$k.elements,a$W=a$J[0],a$w=a$J[1],a$M=a$J[2];a$Q.cloneTo(a$v);var a$H=a$v.elements;0<=a$W&&(a$H[0]=a$V[0]),0<=a$w&&(a$H[1]=a$V[1]),0<=a$M&&(a$H[2]=a$V[2]),a$S.cloneTo(a$j);var a$E=a$j.elements;0<=a$W&&(a$E[0]=a$u[0]),0<=a$w&&(a$E[1]=a$u[1]),0<=a$M&&(a$E[2]=a$u[2])},a$A(0,a$t,"top",function(){return this._top}),a$A(0,a$t,"matrix",function(){return this._matrix},function(a$t){this._matrix=a$t,a$W._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),a$A(0,a$t,"near",function(){return this._near}),a$A(0,a$t,"far",function(){return this._far}),a$A(0,a$t,"left",function(){return this._left}),a$A(0,a$t,"right",function(){return this._right}),a$A(0,a$t,"bottom",function(){return this._bottom}),a$W._getPlanesFromMatrix=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){var a$V=a$t.elements,a$J=a$V[0],a$W=a$V[1],a$w=a$V[2],a$M=a$V[3],a$H=a$V[4],a$E=a$V[5],a$A=a$V[6],a$R=a$V[7],a$h=a$V[8],a$l=a$V[9],a$o=a$V[10],a$Y=a$V[11],a$f=a$V[12],a$X=a$V[13],a$F=a$V[14],a$d=a$V[15],a$m=a$k.normal.elements;a$m[0]=a$M+a$w,a$m[1]=a$R+a$A,a$m[2]=a$Y+a$o,a$k.distance=a$d+a$F,a$k.normalize();var a$Z=a$v.normal.elements;a$Z[0]=a$M-a$w,a$Z[1]=a$R-a$A,a$Z[2]=a$Y-a$o,a$v.distance=a$d-a$F,a$v.normalize();var a$s=a$j.normal.elements;a$s[0]=a$M+a$J,a$s[1]=a$R+a$H,a$s[2]=a$Y+a$h,a$j.distance=a$d+a$f,a$j.normalize();var a$K=a$Q.normal.elements;a$K[0]=a$M-a$J,a$K[1]=a$R-a$H,a$K[2]=a$Y-a$h,a$Q.distance=a$d-a$f,a$Q.normalize();var a$U=a$u.normal.elements;a$U[0]=a$M-a$W,a$U[1]=a$R-a$E,a$U[2]=a$Y-a$l,a$u.distance=a$d-a$X,a$u.normalize();var a$N=a$S.normal.elements;a$N[0]=a$M+a$W,a$N[1]=a$R+a$E,a$N[2]=a$Y+a$l,a$S.distance=a$d+a$X,a$S.normalize()},a$W._get3PlaneInterPoint=function(a$t,a$k,a$v){var a$j=a$t.normal,a$Q=a$k.normal,a$u=a$v.normal;a$Sk.cross(a$Q,a$u,a$W._tempV30),a$Sk.cross(a$u,a$j,a$W._tempV31),a$Sk.cross(a$j,a$Q,a$W._tempV32);var a$S=a$Sk.dot(a$j,a$W._tempV30),a$V=a$Sk.dot(a$Q,a$W._tempV31),a$J=a$Sk.dot(a$u,a$W._tempV32);return a$Sk.scale(a$W._tempV30,-a$t.distance/a$S,a$W._tempV33),a$Sk.scale(a$W._tempV31,-a$k.distance/a$V,a$W._tempV34),a$Sk.scale(a$W._tempV32,-a$v.distance/a$J,a$W._tempV35),a$Sk.add(a$W._tempV33,a$W._tempV34,a$W._tempV36),a$Sk.add(a$W._tempV35,a$W._tempV36,a$W._tempV37),a$W._tempV37},a$M(a$W,["_tempV30",function(){return this._tempV30=new a$Sk},"_tempV31",function(){return this._tempV31=new a$Sk},"_tempV32",function(){return this._tempV32=new a$Sk},"_tempV33",function(){return this._tempV33=new a$Sk},"_tempV34",function(){return this._tempV34=new a$Sk},"_tempV35",function(){return this._tempV35=new a$Sk},"_tempV36",function(){return this._tempV36=new a$Sk},"_tempV37",function(){return this._tempV37=new a$Sk}]),a$W}(),a$$t=function(){function a$w(a$t,a$k){this.center=null,this.radius=NaN,this.center=a$t,this.radius=a$k}a$E(a$w,"laya.d3.math.BoundSphere");var a$t=a$w.prototype;return a$X.imps(a$t,{"laya.d3.core.IClone":!0}),a$t.toDefault=function(){this.center.toDefault(),this.radius=0},a$t.intersectsRayDistance=function(a$t){return Collision.intersectsRayAndSphereRD(a$t,this)},a$t.intersectsRayPoint=function(a$t,a$k){return Collision.intersectsRayAndSphereRP(a$t,this,a$k)},a$t.cloneTo=function(a$t){var a$k=a$t;this.center.cloneTo(a$k.center),a$k.radius=this.radius},a$t.clone=function(){var a$t=new this.constructor(new a$Sk,new a$Sk);return this.cloneTo(a$t),a$t},a$w.createFromSubPoints=function(a$t,a$k,a$v,a$j){if(null==a$t)throw new Error("points");if(a$k<0||a$k>=a$t.length)throw new Error("start"+a$k+"Must be in the range [0, "+(a$t.length-1)+"]");if(a$v<0||a$k+a$v>a$t.length)throw new Error("count"+a$v+"Must be in the range <= "+a$t.length+"}");var a$Q=a$k+a$v,a$u=a$w._tempVector3;a$u.elements[0]=0,a$u.elements[1]=0,a$u.elements[2]=0;for(var a$S=a$k;a$S<a$Q;++a$S)a$Sk.add(a$t[a$S],a$u,a$u);var a$V=a$j.center;a$Sk.scale(a$u,1/a$v,a$V);var a$J=0;for(a$S=a$k;a$S<a$Q;++a$S){var a$W=a$Sk.distanceSquared(a$V,a$t[a$S]);a$J<a$W&&(a$J=a$W)}a$j.radius=Math.sqrt(a$J)},a$w.createfromPoints=function(a$t,a$k){if(null==a$t)throw new Error("points");a$w.createFromSubPoints(a$t,0,a$t.length,a$k)},a$M(a$w,["_tempVector3",function(){return this._tempVector3=new a$Sk}]),a$w}(),a$yt=(function(){function a$t(){}a$E(a$t,"laya.d3.math.ContainmentType"),a$t.Disjoint=0,a$t.Contains=1,a$t.Intersects=2}(),function(){function a$v(){}return a$E(a$v,"laya.d3.math.MathUtils3D"),a$v.isZero=function(a$t){return Math.abs(a$t)<a$v.zeroTolerance},a$v.nearEqual=function(a$t,a$k){return!!a$v.isZero(a$t-a$k)},a$v.fastInvSqrt=function(a$t){return a$v.isZero(a$t)?a$t:1/Math.sqrt(a$t)},a$M(a$v,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),a$v}()),a$Pt=function(){function a$J(){var a$t=this.elements=new Float32Array(9);a$t[0]=1,a$t[1]=0,a$t[2]=0,a$t[3]=0,a$t[4]=1,a$t[5]=0,a$t[6]=0,a$t[7]=0,a$t[8]=1}a$E(a$J,"laya.d3.math.Matrix3x3");var a$t=a$J.prototype;return a$X.imps(a$t,{"laya.d3.core.IClone":!0}),a$t.determinant=function(){var a$t=this.elements,a$k=a$t[0],a$v=a$t[1],a$j=a$t[2],a$Q=a$t[3],a$u=a$t[4],a$S=a$t[5],a$V=a$t[6],a$J=a$t[7],a$W=a$t[8];return a$k*(a$W*a$u-a$S*a$J)+a$v*(-a$W*a$Q+a$S*a$V)+a$j*(a$J*a$Q-a$u*a$V)},a$t.translate=function(a$t,a$k){var a$v=a$k.elements,a$j=this.elements,a$Q=a$t.elements,a$u=a$j[0],a$S=a$j[1],a$V=a$j[2],a$J=a$j[3],a$W=a$j[4],a$w=a$j[5],a$M=a$j[6],a$H=a$j[7],a$E=a$j[8],a$A=a$Q[0],a$R=a$Q[1];a$v[0]=a$u,a$v[1]=a$S,a$v[2]=a$V,a$v[3]=a$J,a$v[4]=a$W,a$v[5]=a$w,a$v[6]=a$A*a$u+a$R*a$J+a$M,a$v[7]=a$A*a$S+a$R*a$W+a$H,a$v[8]=a$A*a$V+a$R*a$w+a$E},a$t.rotate=function(a$t,a$k){var a$v=a$k.elements,a$j=this.elements,a$Q=a$j[0],a$u=a$j[1],a$S=a$j[2],a$V=a$j[3],a$J=a$j[4],a$W=a$j[5],a$w=a$j[6],a$M=a$j[7],a$H=a$j[8],a$E=Math.sin(a$t),a$A=Math.cos(a$t);a$v[0]=a$A*a$Q+a$E*a$V,a$v[1]=a$A*a$u+a$E*a$J,a$v[2]=a$A*a$S+a$E*a$W,a$v[3]=a$A*a$V-a$E*a$Q,a$v[4]=a$A*a$J-a$E*a$u,a$v[5]=a$A*a$W-a$E*a$S,a$v[6]=a$w,a$v[7]=a$M,a$v[8]=a$H},a$t.scale=function(a$t,a$k){var a$v=a$k.elements,a$j=this.elements,a$Q=a$t.elements,a$u=a$Q[0],a$S=a$Q[1];a$v[0]=a$u*a$j[0],a$v[1]=a$u*a$j[1],a$v[2]=a$u*a$j[2],a$v[3]=a$S*a$j[3],a$v[4]=a$S*a$j[4],a$v[5]=a$S*a$j[5],a$v[6]=a$j[6],a$v[7]=a$j[7],a$v[8]=a$j[8]},a$t.invert=function(a$t){var a$k=a$t.elements,a$v=this.elements,a$j=a$v[0],a$Q=a$v[1],a$u=a$v[2],a$S=a$v[3],a$V=a$v[4],a$J=a$v[5],a$W=a$v[6],a$w=a$v[7],a$M=a$v[8],a$H=a$M*a$V-a$J*a$w,a$E=-a$M*a$S+a$J*a$W,a$A=a$w*a$S-a$V*a$W,a$R=a$j*a$H+a$Q*a$E+a$u*a$A;a$R||(a$t=null),a$R=1/a$R,a$k[0]=a$H*a$R,a$k[1]=(-a$M*a$Q+a$u*a$w)*a$R,a$k[2]=(a$J*a$Q-a$u*a$V)*a$R,a$k[3]=a$E*a$R,a$k[4]=(a$M*a$j-a$u*a$W)*a$R,a$k[5]=(-a$J*a$j+a$u*a$S)*a$R,a$k[6]=a$A*a$R,a$k[7]=(-a$w*a$j+a$Q*a$W)*a$R,a$k[8]=(a$V*a$j-a$Q*a$S)*a$R},a$t.transpose=function(a$t){var a$k=a$t.elements,a$v=this.elements;if(a$t===this){var a$j=a$v[1],a$Q=a$v[2],a$u=a$v[5];a$k[1]=a$v[3],a$k[2]=a$v[6],a$k[3]=a$j,a$k[5]=a$v[7],a$k[6]=a$Q,a$k[7]=a$u}else a$k[0]=a$v[0],a$k[1]=a$v[3],a$k[2]=a$v[6],a$k[3]=a$v[1],a$k[4]=a$v[4],a$k[5]=a$v[7],a$k[6]=a$v[2],a$k[7]=a$v[5],a$k[8]=a$v[8]},a$t.identity=function(){var a$t=this.elements;a$t[0]=1,a$t[1]=0,a$t[2]=0,a$t[3]=0,a$t[4]=1,a$t[5]=0,a$t[6]=0,a$t[7]=0,a$t[8]=1},a$t.cloneTo=function(a$t){var a$k,a$v,a$j;if((a$v=this.elements)!==(a$j=a$t.elements))for(a$k=0;a$k<9;++a$k)a$j[a$k]=a$v[a$k]},a$t.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$J.createFromTranslation=function(a$t,a$k){a$k.elements;var a$v=a$t.elements;a$k[0]=1,a$k[1]=0,a$k[2]=0,a$k[3]=0,a$k[4]=1,a$k[5]=0,a$k[6]=a$v[0],a$k[7]=a$v[1],a$k[8]=1},a$J.createFromRotation=function(a$t,a$k){var a$v=a$k.elements,a$j=Math.sin(a$t),a$Q=Math.cos(a$t);a$v[0]=a$Q,a$v[1]=a$j,a$v[2]=0,a$v[3]=-a$j,a$v[4]=a$Q,a$v[5]=0,a$v[6]=0,a$v[7]=0,a$v[8]=1},a$J.createFromScaling=function(a$t,a$k){var a$v=a$k.elements,a$j=a$t.elements;a$v[0]=a$j[0],a$v[1]=0,a$v[2]=0,a$v[3]=0,a$v[4]=a$j[1],a$v[5]=0,a$v[6]=0,a$v[7]=0,a$v[8]=1},a$J.createFromMatrix4x4=function(a$t,a$k){a$k[0]=a$t[0],a$k[1]=a$t[1],a$k[2]=a$t[2],a$k[3]=a$t[4],a$k[4]=a$t[5],a$k[5]=a$t[6],a$k[6]=a$t[8],a$k[7]=a$t[9],a$k[8]=a$t[10]},a$J.multiply=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k.elements,a$S=a$Q[0],a$V=a$Q[1],a$J=a$Q[2],a$W=a$Q[3],a$w=a$Q[4],a$M=a$Q[5],a$H=a$Q[6],a$E=a$Q[7],a$A=a$Q[8],a$R=a$u[0],a$h=a$u[1],a$l=a$u[2],a$o=a$u[3],a$Y=a$u[4],a$f=a$u[5],a$X=a$u[6],a$F=a$u[7],a$d=a$u[8];a$j[0]=a$R*a$S+a$h*a$W+a$l*a$H,a$j[1]=a$R*a$V+a$h*a$w+a$l*a$E,a$j[2]=a$R*a$J+a$h*a$M+a$l*a$A,a$j[3]=a$o*a$S+a$Y*a$W+a$f*a$H,a$j[4]=a$o*a$V+a$Y*a$w+a$f*a$E,a$j[5]=a$o*a$J+a$Y*a$M+a$f*a$A,a$j[6]=a$X*a$S+a$F*a$W+a$d*a$H,a$j[7]=a$X*a$V+a$F*a$w+a$d*a$E,a$j[8]=a$X*a$J+a$F*a$M+a$d*a$A},a$J.lookAt=function(a$t,a$k,a$v,a$j){a$Sk.subtract(a$t,a$k,a$J._tempV30),a$Sk.normalize(a$J._tempV30,a$J._tempV30),a$Sk.cross(a$v,a$J._tempV30,a$J._tempV31),a$Sk.normalize(a$J._tempV31,a$J._tempV31),a$Sk.cross(a$J._tempV30,a$J._tempV31,a$J._tempV32);var a$Q=a$J._tempV30.elements,a$u=a$J._tempV31.elements,a$S=a$J._tempV32.elements,a$V=a$j.elements;a$V[0]=a$u[0],a$V[3]=a$u[1],a$V[6]=a$u[2],a$V[1]=a$S[0],a$V[4]=a$S[1],a$V[7]=a$S[2],a$V[2]=a$Q[0],a$V[5]=a$Q[1],a$V[8]=a$Q[2]},a$J.DEFAULT=new a$J,a$M(a$J,["_tempV30",function(){return this._tempV30=new a$Sk},"_tempV31",function(){return this._tempV31=new a$Sk},"_tempV32",function(){return this._tempV32=new a$Sk}]),a$J}(),a$tk=function(){function a$Z(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w,a$M,a$H,a$E,a$A,a$R){void 0===a$t&&(a$t=1),void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=0),void 0===a$Q&&(a$Q=0),void 0===a$u&&(a$u=1),void 0===a$S&&(a$S=0),void 0===a$V&&(a$V=0),void 0===a$J&&(a$J=0),void 0===a$W&&(a$W=0),void 0===a$w&&(a$w=1),void 0===a$M&&(a$M=0),void 0===a$H&&(a$H=0),void 0===a$E&&(a$E=0),void 0===a$A&&(a$A=0),void 0===a$R&&(a$R=1);var a$h=this.elements=new Float32Array(16);a$h[0]=a$t,a$h[1]=a$k,a$h[2]=a$v,a$h[3]=a$j,a$h[4]=a$Q,a$h[5]=a$u,a$h[6]=a$S,a$h[7]=a$V,a$h[8]=a$J,a$h[9]=a$W,a$h[10]=a$w,a$h[11]=a$M,a$h[12]=a$H,a$h[13]=a$E,a$h[14]=a$A,a$h[15]=a$R}a$E(a$Z,"laya.d3.math.Matrix4x4");var a$t=a$Z.prototype;return a$X.imps(a$t,{"laya.d3.core.IClone":!0}),a$t.getElementByRowColumn=function(a$t,a$k){if(a$t<0||3<a$t)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(a$k<0||3<a$k)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*a$t+a$k]},a$t.setElementByRowColumn=function(a$t,a$k,a$v){if(a$t<0||3<a$t)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(a$k<0||3<a$k)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*a$t+a$k]=a$v},a$t.equalsOtherMatrix=function(a$t){var a$k=this.elements,a$v=a$t.elements;return a$yt.nearEqual(a$k[0],a$v[0])&&a$yt.nearEqual(a$k[1],a$v[1])&&a$yt.nearEqual(a$k[2],a$v[2])&&a$yt.nearEqual(a$k[3],a$v[3])&&a$yt.nearEqual(a$k[4],a$v[4])&&a$yt.nearEqual(a$k[5],a$v[5])&&a$yt.nearEqual(a$k[6],a$v[6])&&a$yt.nearEqual(a$k[7],a$v[7])&&a$yt.nearEqual(a$k[8],a$v[8])&&a$yt.nearEqual(a$k[9],a$v[9])&&a$yt.nearEqual(a$k[10],a$v[10])&&a$yt.nearEqual(a$k[11],a$v[11])&&a$yt.nearEqual(a$k[12],a$v[12])&&a$yt.nearEqual(a$k[13],a$v[13])&&a$yt.nearEqual(a$k[14],a$v[14])&&a$yt.nearEqual(a$k[15],a$v[15])},a$t.decomposeTransRotScale=function(a$t,a$k,a$v){var a$j=a$Z._tempMatrix4x4;return this.decomposeTransRotMatScale(a$t,a$j,a$v)?(a$vk.createFromMatrix4x4(a$j,a$k),!0):(a$k.identity(),!1)},a$t.decomposeTransRotMatScale=function(a$t,a$k,a$v){var a$j=this.elements,a$Q=a$t.elements,a$u=a$k.elements,a$S=a$v.elements;a$Q[0]=a$j[12],a$Q[1]=a$j[13],a$Q[2]=a$j[14];var a$V=a$j[0],a$J=a$j[1],a$W=a$j[2],a$w=a$j[4],a$M=a$j[5],a$H=a$j[6],a$E=a$j[8],a$A=a$j[9],a$R=a$j[10],a$h=a$S[0]=Math.sqrt(a$V*a$V+a$J*a$J+a$W*a$W),a$l=a$S[1]=Math.sqrt(a$w*a$w+a$M*a$M+a$H*a$H),a$o=a$S[2]=Math.sqrt(a$E*a$E+a$A*a$A+a$R*a$R);if(a$yt.isZero(a$h)||a$yt.isZero(a$l)||a$yt.isZero(a$o))return a$u[1]=a$u[2]=a$u[3]=a$u[4]=a$u[6]=a$u[7]=a$u[8]=a$u[9]=a$u[11]=a$u[12]=a$u[13]=a$u[14]=0,a$u[0]=a$u[5]=a$u[10]=a$u[15]=1,!1;var a$Y=a$Z._tempVector0,a$f=a$Y.elements;a$f[0]=a$E/a$o,a$f[1]=a$A/a$o,a$f[2]=a$R/a$o;var a$X=a$Z._tempVector1,a$F=a$X.elements;a$F[0]=a$V/a$h,a$F[1]=a$J/a$h,a$F[2]=a$W/a$h;var a$d=a$Z._tempVector2;a$Sk.cross(a$Y,a$X,a$d);var a$m=a$Z._tempVector1;return a$Sk.cross(a$d,a$Y,a$m),a$u[3]=a$u[7]=a$u[11]=a$u[12]=a$u[13]=a$u[14]=0,a$u[15]=1,a$u[0]=a$m.x,a$u[1]=a$m.y,a$u[2]=a$m.z,a$u[4]=a$d.x,a$u[5]=a$d.y,a$u[6]=a$d.z,a$u[8]=a$Y.x,a$u[9]=a$Y.y,a$u[10]=a$Y.z,a$u[0]*a$V+a$u[1]*a$J+a$u[2]*a$W<0&&(a$S[0]=-a$h),a$u[4]*a$w+a$u[5]*a$M+a$u[6]*a$H<0&&(a$S[1]=-a$l),a$u[8]*a$E+a$u[9]*a$A+a$u[10]*a$R<0&&(a$S[2]=-a$o),!0},a$t.decomposeYawPitchRoll=function(a$t){var a$k=a$t.elements,a$v=Math.asin(-this.elements[9]);a$k[1]=a$v,Math.cos(a$v)>a$yt.zeroTolerance?(a$k[2]=Math.atan2(this.elements[1],this.elements[5]),a$k[0]=Math.atan2(this.elements[8],this.elements[10])):(a$k[2]=Math.atan2(-this.elements[4],this.elements[0]),a$k[0]=0)},a$t.normalize=function(){var a$t=this.elements,a$k=a$t[0],a$v=a$t[1],a$j=a$t[2],a$Q=Math.sqrt(a$k*a$k+a$v*a$v+a$j*a$j);if(!a$Q)return a$t[0]=0,a$t[1]=0,void(a$t[2]=0);1!=a$Q&&(a$Q=1/a$Q,a$t[0]=a$k*a$Q,a$t[1]=a$v*a$Q,a$t[2]=a$j*a$Q)},a$t.transpose=function(){var a$t,a$k;return a$k=(a$t=this.elements)[1],a$t[1]=a$t[4],a$t[4]=a$k,a$k=a$t[2],a$t[2]=a$t[8],a$t[8]=a$k,a$k=a$t[3],a$t[3]=a$t[12],a$t[12]=a$k,a$k=a$t[6],a$t[6]=a$t[9],a$t[9]=a$k,a$k=a$t[7],a$t[7]=a$t[13],a$t[13]=a$k,a$k=a$t[11],a$t[11]=a$t[14],a$t[14]=a$k,this},a$t.invert=function(a$t){var a$k=this.elements,a$v=a$t.elements,a$j=a$k[0],a$Q=a$k[1],a$u=a$k[2],a$S=a$k[3],a$V=a$k[4],a$J=a$k[5],a$W=a$k[6],a$w=a$k[7],a$M=a$k[8],a$H=a$k[9],a$E=a$k[10],a$A=a$k[11],a$R=a$k[12],a$h=a$k[13],a$l=a$k[14],a$o=a$k[15],a$Y=a$j*a$J-a$Q*a$V,a$f=a$j*a$W-a$u*a$V,a$X=a$j*a$w-a$S*a$V,a$F=a$Q*a$W-a$u*a$J,a$d=a$Q*a$w-a$S*a$J,a$m=a$u*a$w-a$S*a$W,a$Z=a$M*a$h-a$H*a$R,a$s=a$M*a$l-a$E*a$R,a$K=a$M*a$o-a$A*a$R,a$U=a$H*a$l-a$E*a$h,a$N=a$H*a$o-a$A*a$h,a$a=a$E*a$o-a$A*a$l,a$z=a$Y*a$a-a$f*a$N+a$X*a$U+a$F*a$K-a$d*a$s+a$m*a$Z;0!==Math.abs(a$z)&&(a$z=1/a$z,a$v[0]=(a$J*a$a-a$W*a$N+a$w*a$U)*a$z,a$v[1]=(a$u*a$N-a$Q*a$a-a$S*a$U)*a$z,a$v[2]=(a$h*a$m-a$l*a$d+a$o*a$F)*a$z,a$v[3]=(a$E*a$d-a$H*a$m-a$A*a$F)*a$z,a$v[4]=(a$W*a$K-a$V*a$a-a$w*a$s)*a$z,a$v[5]=(a$j*a$a-a$u*a$K+a$S*a$s)*a$z,a$v[6]=(a$l*a$X-a$R*a$m-a$o*a$f)*a$z,a$v[7]=(a$M*a$m-a$E*a$X+a$A*a$f)*a$z,a$v[8]=(a$V*a$N-a$J*a$K+a$w*a$Z)*a$z,a$v[9]=(a$Q*a$K-a$j*a$N-a$S*a$Z)*a$z,a$v[10]=(a$R*a$d-a$h*a$X+a$o*a$Y)*a$z,a$v[11]=(a$H*a$X-a$M*a$d-a$A*a$Y)*a$z,a$v[12]=(a$J*a$s-a$V*a$U-a$W*a$Z)*a$z,a$v[13]=(a$j*a$U-a$Q*a$s+a$u*a$Z)*a$z,a$v[14]=(a$h*a$f-a$R*a$F-a$l*a$Y)*a$z,a$v[15]=(a$M*a$F-a$H*a$f+a$E*a$Y)*a$z)},a$t.identity=function(){var a$t=this.elements;a$t[1]=a$t[2]=a$t[3]=a$t[4]=a$t[6]=a$t[7]=a$t[8]=a$t[9]=a$t[11]=a$t[12]=a$t[13]=a$t[14]=0,a$t[0]=a$t[5]=a$t[10]=a$t[15]=1},a$t.cloneTo=function(a$t){var a$k,a$v,a$j;if((a$v=this.elements)!==(a$j=a$t.elements))for(a$k=0;a$k<16;++a$k)a$j[a$k]=a$v[a$k]},a$t.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$t.getTranslationVector=function(a$t){var a$k=this.elements,a$v=a$t.elements;a$v[0]=a$k[12],a$v[1]=a$k[13],a$v[2]=a$k[14]},a$t.setTranslationVector=function(a$t){var a$k=this.elements,a$v=a$t.elements;a$k[12]=a$v[0],a$k[13]=a$v[1],a$k[14]=a$v[2]},a$t.getForward=function(a$t){var a$k=this.elements,a$v=a$t.elements;a$v[0]=-a$k[8],a$v[1]=-a$k[9],a$v[2]=-a$k[10]},a$t.setForward=function(a$t){var a$k=this.elements,a$v=a$t.elements;a$k[8]=-a$v[0],a$k[9]=-a$v[1],a$k[10]=-a$v[2]},a$Z.createRotationX=function(a$t,a$k){var a$v=a$k.elements,a$j=Math.sin(a$t),a$Q=Math.cos(a$t);a$v[1]=a$v[2]=a$v[3]=a$v[4]=a$v[7]=a$v[8]=a$v[11]=a$v[12]=a$v[13]=a$v[14]=0,a$v[0]=a$v[15]=1,a$v[5]=a$v[10]=a$Q,a$v[6]=a$j,a$v[9]=-a$j},a$Z.createRotationY=function(a$t,a$k){var a$v=a$k.elements,a$j=Math.sin(a$t),a$Q=Math.cos(a$t);a$v[1]=a$v[3]=a$v[4]=a$v[6]=a$v[7]=a$v[9]=a$v[11]=a$v[12]=a$v[13]=a$v[14]=0,a$v[5]=a$v[15]=1,a$v[0]=a$v[10]=a$Q,a$v[2]=-a$j,a$v[8]=a$j},a$Z.createRotationZ=function(a$t,a$k){var a$v=a$k.elements,a$j=Math.sin(a$t),a$Q=Math.cos(a$t);a$v[2]=a$v[3]=a$v[6]=a$v[7]=a$v[8]=a$v[9]=a$v[11]=a$v[12]=a$v[13]=a$v[14]=0,a$v[10]=a$v[15]=1,a$v[0]=a$v[5]=a$Q,a$v[1]=a$j,a$v[4]=-a$j},a$Z.createRotationYawPitchRoll=function(a$t,a$k,a$v,a$j){a$vk.createFromYawPitchRoll(a$t,a$k,a$v,a$Z._tempQuaternion),a$Z.createRotationQuaternion(a$Z._tempQuaternion,a$j)},a$Z.createRotationAxis=function(a$t,a$k,a$v){var a$j=a$t.elements,a$Q=a$j[0],a$u=a$j[1],a$S=a$j[2],a$V=Math.cos(a$k),a$J=Math.sin(a$k),a$W=a$Q*a$Q,a$w=a$u*a$u,a$M=a$S*a$S,a$H=a$Q*a$u,a$E=a$Q*a$S,a$A=a$u*a$S,a$R=a$v.elements;a$R[3]=a$R[7]=a$R[11]=a$R[12]=a$R[13]=a$R[14]=0,a$R[15]=1,a$R[0]=a$W+a$V*(1-a$W),a$R[1]=a$H-a$V*a$H+a$J*a$S,a$R[2]=a$E-a$V*a$E-a$J*a$u,a$R[4]=a$H-a$V*a$H-a$J*a$S,a$R[5]=a$w+a$V*(1-a$w),a$R[6]=a$A-a$V*a$A+a$J*a$Q,a$R[8]=a$E-a$V*a$E+a$J*a$u,a$R[9]=a$A-a$V*a$A-a$J*a$Q,a$R[10]=a$M+a$V*(1-a$M)},a$Z.createRotationQuaternion=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements,a$Q=a$v[0],a$u=a$v[1],a$S=a$v[2],a$V=a$v[3],a$J=a$Q*a$Q,a$W=a$u*a$u,a$w=a$S*a$S,a$M=a$Q*a$u,a$H=a$S*a$V,a$E=a$S*a$Q,a$A=a$u*a$V,a$R=a$u*a$S,a$h=a$Q*a$V;a$j[3]=a$j[7]=a$j[11]=a$j[12]=a$j[13]=a$j[14]=0,a$j[15]=1,a$j[0]=1-2*(a$W+a$w),a$j[1]=2*(a$M+a$H),a$j[2]=2*(a$E-a$A),a$j[4]=2*(a$M-a$H),a$j[5]=1-2*(a$w+a$J),a$j[6]=2*(a$R+a$h),a$j[8]=2*(a$E+a$A),a$j[9]=2*(a$R-a$h),a$j[10]=1-2*(a$W+a$J)},a$Z.createTranslate=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements;a$j[4]=a$j[8]=a$j[1]=a$j[9]=a$j[2]=a$j[6]=a$j[3]=a$j[7]=a$j[11]=0,a$j[0]=a$j[5]=a$j[10]=a$j[15]=1,a$j[12]=a$v[0],a$j[13]=a$v[1],a$j[14]=a$v[2]},a$Z.createScaling=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements;a$j[0]=a$v[0],a$j[5]=a$v[1],a$j[10]=a$v[2],a$j[1]=a$j[4]=a$j[8]=a$j[12]=a$j[9]=a$j[13]=a$j[2]=a$j[6]=a$j[14]=a$j[3]=a$j[7]=a$j[11]=0,a$j[15]=1},a$Z.multiply=function(a$t,a$k,a$v){var a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w;for(a$Q=a$v.elements,a$u=a$t.elements,a$Q===(a$S=a$k.elements)&&(a$S=a$S.slice()),a$j=0;a$j<4;a$j++)a$V=a$u[a$j],a$J=a$u[a$j+4],a$W=a$u[a$j+8],a$w=a$u[a$j+12],a$Q[a$j]=a$V*a$S[0]+a$J*a$S[1]+a$W*a$S[2]+a$w*a$S[3],a$Q[a$j+4]=a$V*a$S[4]+a$J*a$S[5]+a$W*a$S[6]+a$w*a$S[7],a$Q[a$j+8]=a$V*a$S[8]+a$J*a$S[9]+a$W*a$S[10]+a$w*a$S[11],a$Q[a$j+12]=a$V*a$S[12]+a$J*a$S[13]+a$W*a$S[14]+a$w*a$S[15]},a$Z.createFromQuaternion=function(a$t,a$k){var a$v=a$k.elements,a$j=a$t.elements,a$Q=a$j[0],a$u=a$j[1],a$S=a$j[2],a$V=a$j[3],a$J=a$Q+a$Q,a$W=a$u+a$u,a$w=a$S+a$S,a$M=a$Q*a$J,a$H=a$u*a$J,a$E=a$u*a$W,a$A=a$S*a$J,a$R=a$S*a$W,a$h=a$S*a$w,a$l=a$V*a$J,a$o=a$V*a$W,a$Y=a$V*a$w;a$v[0]=1-a$E-a$h,a$v[1]=a$H+a$Y,a$v[2]=a$A-a$o,a$v[3]=0,a$v[4]=a$H-a$Y,a$v[5]=1-a$M-a$h,a$v[6]=a$R+a$l,a$v[7]=0,a$v[8]=a$A+a$o,a$v[9]=a$R-a$l,a$v[10]=1-a$M-a$E,a$v[11]=0,a$v[12]=0,a$v[13]=0,a$v[14]=0,a$v[15]=1},a$Z.createAffineTransformation=function(a$t,a$k,a$v,a$j){var a$Q=a$t.elements,a$u=a$k.elements,a$S=a$v.elements,a$V=a$j.elements,a$J=a$u[0],a$W=a$u[1],a$w=a$u[2],a$M=a$u[3],a$H=a$J+a$J,a$E=a$W+a$W,a$A=a$w+a$w,a$R=a$J*a$H,a$h=a$J*a$E,a$l=a$J*a$A,a$o=a$W*a$E,a$Y=a$W*a$A,a$f=a$w*a$A,a$X=a$M*a$H,a$F=a$M*a$E,a$d=a$M*a$A,a$m=a$S[0],a$Z=a$S[1],a$s=a$S[2];a$V[0]=(1-(a$o+a$f))*a$m,a$V[1]=(a$h+a$d)*a$m,a$V[2]=(a$l-a$F)*a$m,a$V[3]=0,a$V[4]=(a$h-a$d)*a$Z,a$V[5]=(1-(a$R+a$f))*a$Z,a$V[6]=(a$Y+a$X)*a$Z,a$V[7]=0,a$V[8]=(a$l+a$F)*a$s,a$V[9]=(a$Y-a$X)*a$s,a$V[10]=(1-(a$R+a$o))*a$s,a$V[11]=0,a$V[12]=a$Q[0],a$V[13]=a$Q[1],a$V[14]=a$Q[2],a$V[15]=1},a$Z.createLookAt=function(a$t,a$k,a$v,a$j){var a$Q=a$j.elements,a$u=a$Z._tempVector0,a$S=a$Z._tempVector1,a$V=a$Z._tempVector2;a$Sk.subtract(a$t,a$k,a$V),a$Sk.normalize(a$V,a$V),a$Sk.cross(a$v,a$V,a$u),a$Sk.normalize(a$u,a$u),a$Sk.cross(a$V,a$u,a$S),a$j.identity(),a$Q[0]=a$u.x,a$Q[4]=a$u.y,a$Q[8]=a$u.z,a$Q[1]=a$S.x,a$Q[5]=a$S.y,a$Q[9]=a$S.z,a$Q[2]=a$V.x,a$Q[6]=a$V.y,a$Q[10]=a$V.z,a$Q[12]=-a$Sk.dot(a$u,a$t),a$Q[13]=-a$Sk.dot(a$S,a$t),a$Q[14]=-a$Sk.dot(a$V,a$t)},a$Z.createPerspective=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$Q.elements,a$S=1/Math.tan(a$t/2),a$V=1/(a$v-a$j);a$u[0]=a$S/a$k,a$u[5]=a$S,a$u[10]=(a$j+a$v)*a$V,a$u[11]=-1,a$u[14]=2*a$j*a$v*a$V,a$u[1]=a$u[2]=a$u[3]=a$u[4]=a$u[6]=a$u[7]=a$u[8]=a$u[9]=a$u[12]=a$u[13]=a$u[15]=0},a$Z.createOrthoOffCenterRH=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){var a$V=a$S.elements,a$J=1/(a$t-a$k),a$W=1/(a$v-a$j),a$w=1/(a$Q-a$u);a$V[1]=a$V[2]=a$V[3]=a$V[4]=a$V[6]=a$V[7]=a$V[8]=a$V[9]=a$V[11]=0,a$V[15]=1,a$V[0]=-2*a$J,a$V[5]=-2*a$W,a$V[10]=2*a$w,a$V[12]=(a$t+a$k)*a$J,a$V[13]=(a$j+a$v)*a$W,a$V[14]=(a$u+a$Q)*a$w},a$Z.translation=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements;a$j[0]=a$j[5]=a$j[10]=a$j[15]=1,a$j[12]=a$v[0],a$j[13]=a$v[1],a$j[14]=a$v[2]},a$M(a$Z,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new a$Z},"_tempVector0",function(){return this._tempVector0=new a$Sk},"_tempVector1",function(){return this._tempVector1=new a$Sk},"_tempVector2",function(){return this._tempVector2=new a$Sk},"_tempQuaternion",function(){return this._tempQuaternion=new a$vk},"DEFAULT",function(){return this.DEFAULT=new a$Z},"ZERO",function(){return this.ZERO=new a$Z(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),a$Z}(),a$kk=(function(){function a$Y(a$t,a$k){this.extents=null,this.transformation=null,this.extents=a$t,this.transformation=a$k}a$E(a$Y,"laya.d3.math.OrientedBoundBox");var a$t=a$Y.prototype;a$t.getCorners=function(a$t){var a$k=a$Y._tempV30.elements,a$v=a$Y._tempV31.elements,a$j=a$Y._tempV32.elements,a$Q=this.extents.elements;a$k[0]=a$Q[0],a$k[1]=a$k[2]=0,a$v[1]=a$Q[1],a$v[0]=a$v[2]=0,a$j[2]=a$Q[2],a$j[0]=a$j[1]=0,a$Sk.TransformNormal(a$Y._tempV30,this.transformation,a$Y._tempV30),a$Sk.TransformNormal(a$Y._tempV31,this.transformation,a$Y._tempV31),a$Sk.TransformNormal(a$Y._tempV32,this.transformation,a$Y._tempV32);var a$u=a$Y._tempV33;this.transformation.getTranslationVector(a$u),a$t.length=8,a$Sk.add(a$u,a$Y._tempV30,a$Y._tempV34),a$Sk.add(a$Y._tempV34,a$Y._tempV31,a$Y._tempV34),a$Sk.add(a$Y._tempV34,a$Y._tempV32,a$t[0]),a$Sk.add(a$u,a$Y._tempV30,a$Y._tempV34),a$Sk.add(a$Y._tempV34,a$Y._tempV31,a$Y._tempV34),a$Sk.subtract(a$Y._tempV34,a$Y._tempV32,a$t[1]),a$Sk.subtract(a$u,a$Y._tempV30,a$Y._tempV34),a$Sk.add(a$Y._tempV34,a$Y._tempV31,a$Y._tempV34),a$Sk.subtract(a$Y._tempV34,a$Y._tempV32,a$t[2]),a$Sk.subtract(a$u,a$Y._tempV30,a$Y._tempV34),a$Sk.add(a$Y._tempV34,a$Y._tempV31,a$Y._tempV34),a$Sk.add(a$Y._tempV34,a$Y._tempV32,a$t[3]),a$Sk.add(a$u,a$Y._tempV30,a$Y._tempV34),a$Sk.subtract(a$Y._tempV34,a$Y._tempV31,a$Y._tempV34),a$Sk.add(a$Y._tempV34,a$Y._tempV32,a$t[4]),a$Sk.add(a$u,a$Y._tempV30,a$Y._tempV34),a$Sk.subtract(a$Y._tempV34,a$Y._tempV31,a$Y._tempV34),a$Sk.subtract(a$Y._tempV34,a$Y._tempV32,a$t[5]),a$Sk.subtract(a$u,a$Y._tempV30,a$Y._tempV34),a$Sk.subtract(a$Y._tempV34,a$Y._tempV31,a$Y._tempV34),a$Sk.subtract(a$Y._tempV34,a$Y._tempV32,a$t[6]),a$Sk.subtract(a$u,a$Y._tempV30,a$Y._tempV34),a$Sk.subtract(a$Y._tempV34,a$Y._tempV31,a$Y._tempV34),a$Sk.add(a$Y._tempV34,a$Y._tempV32,a$t[7])},a$t.transform=function(a$t){a$tk.multiply(this.transformation,a$t,this.transformation)},a$t.scale=function(a$t){a$Sk.multiply(this.extents,a$t,this.extents)},a$t.translate=function(a$t){this.transformation.getTranslationVector(a$Y._tempV30),a$Sk.add(a$Y._tempV30,a$t,a$Y._tempV31),this.transformation.setTranslationVector(a$Y._tempV31)},a$t.Size=function(a$t){a$Sk.scale(this.extents,2,a$t)},a$t.getSize=function(a$t){var a$k=this.extents.elements;a$Y._tempV30.x=a$k[0],a$Y._tempV31.y=a$k[1],a$Y._tempV32.z=a$k[2],a$Sk.TransformNormal(a$Y._tempV30,this.transformation,a$Y._tempV30),a$Sk.TransformNormal(a$Y._tempV31,this.transformation,a$Y._tempV31),a$Sk.TransformNormal(a$Y._tempV31,this.transformation,a$Y._tempV32);var a$v=a$t.elements;a$v[0]=a$Sk.scalarLength(a$Y._tempV30),a$v[1]=a$Sk.scalarLength(a$Y._tempV31),a$v[2]=a$Sk.scalarLength(a$Y._tempV32)},a$t.getSizeSquared=function(a$t){var a$k=this.extents.elements;a$Y._tempV30.x=a$k[0],a$Y._tempV31.y=a$k[1],a$Y._tempV32.z=a$k[2],a$Sk.TransformNormal(a$Y._tempV30,this.transformation,a$Y._tempV30),a$Sk.TransformNormal(a$Y._tempV31,this.transformation,a$Y._tempV31),a$Sk.TransformNormal(a$Y._tempV31,this.transformation,a$Y._tempV32);var a$v=a$t.elements;a$v[0]=a$Sk.scalarLengthSquared(a$Y._tempV30),a$v[1]=a$Sk.scalarLengthSquared(a$Y._tempV31),a$v[2]=a$Sk.scalarLengthSquared(a$Y._tempV32)},a$t.getCenter=function(a$t){this.transformation.getTranslationVector(a$t)},a$t.containsPoint=function(a$t){var a$k=this.extents.elements,a$v=a$k[0],a$j=a$k[1],a$Q=a$k[2];this.transformation.invert(a$Y._tempM0),a$Sk.transformCoordinate(a$t,a$Y._tempM0,a$Y._tempV30);var a$u=a$Y._tempV30.elements,a$S=Math.abs(a$u[0]),a$V=Math.abs(a$u[1]),a$J=Math.abs(a$u[2]);return a$yt.nearEqual(a$S,a$v)&&a$yt.nearEqual(a$V,a$j)&&a$yt.nearEqual(a$J,a$Q)?2:a$S<a$v&&a$V<a$j&&a$J<a$Q?1:0},a$t.containsPoints=function(a$t){var a$k=this.extents.elements,a$v=a$k[0],a$j=a$k[1],a$Q=a$k[2];this.transformation.invert(a$Y._tempM0);for(var a$u=!0,a$S=!1,a$V=0;a$V<a$t.length;a$V++){a$Sk.transformCoordinate(a$t[a$V],a$Y._tempM0,a$Y._tempV30);var a$J=a$Y._tempV30.elements,a$W=Math.abs(a$J[0]),a$w=Math.abs(a$J[1]),a$M=Math.abs(a$J[2]);a$yt.nearEqual(a$W,a$v)&&a$yt.nearEqual(a$w,a$j)&&a$yt.nearEqual(a$M,a$Q)&&(a$S=!0),a$W<a$v&&a$w<a$j&&a$M<a$Q?a$S=!0:a$u=!1}return a$u?1:a$S?2:0},a$t.containsSphere=function(a$t,a$k){void 0===a$k&&(a$k=!1);var a$v=this.extents.elements,a$j=a$v[0],a$Q=a$v[1],a$u=a$v[2],a$S=a$t.radius;this.transformation.invert(a$Y._tempM0),a$Sk.transformCoordinate(a$t.center,a$Y._tempM0,a$Y._tempV30);var a$V=NaN;if(a$V=a$k?a$S:(a$Sk.scale(a$Sk.UnitX,a$S,a$Y._tempV31),a$Sk.TransformNormal(a$Y._tempV31,a$Y._tempM0,a$Y._tempV31),a$Sk.scalarLength(a$Y._tempV31)),a$Sk.scale(this.extents,-1,a$Y._tempV32),a$Sk.Clamp(a$Y._tempV30,a$Y._tempV32,this.extents,a$Y._tempV33),a$V*a$V<a$Sk.distanceSquared(a$Y._tempV30,a$Y._tempV33))return 0;var a$J=a$Y._tempV30.elements,a$W=a$J[0],a$w=a$J[1],a$M=a$J[2],a$H=a$Y._tempV32.elements,a$E=a$H[0],a$A=a$H[1],a$R=a$H[2];return a$E+a$V<=a$W&&a$W<=a$j-a$V&&a$V<a$j-a$E&&a$A+a$V<=a$w&&a$w<=a$Q-a$V&&a$V<a$Q-a$A&&a$R+a$V<=a$M&&a$M<=a$u-a$V&&a$V<a$u-a$R?1:2},a$t.containsOrientedBoundBox=function(a$t){var a$k=0,a$v=0;a$t.getCorners(a$Y._corners);var a$j=this.containsPoints(a$Y._corners);if(0!=a$j)return a$j;var a$Q=this.extents.elements;a$t.extents.cloneTo(a$Y._tempV35);var a$u=a$Y._tempV35.elements;a$Y._getRows(this.transformation,a$Y._rows1),a$Y._getRows(a$t.transformation,a$Y._rows2);var a$S=NaN;for(a$k=0;a$k<4;a$k++)for(a$v=0;a$v<4;a$v++)3==a$k||3==a$v?(a$Y._tempM0.setElementByRowColumn(a$k,a$v,0),a$Y._tempM1.setElementByRowColumn(a$k,a$v,0)):(a$S=a$Sk.dot(a$Y._rows1[a$k],a$Y._rows2[a$v]),a$Y._tempM0.setElementByRowColumn(a$k,a$v,a$S),a$Y._tempM1.setElementByRowColumn(a$k,a$v,Math.abs(a$S)));a$t.getCenter(a$Y._tempV34),this.getCenter(a$Y._tempV36),a$Sk.subtract(a$Y._tempV34,a$Y._tempV36,a$Y._tempV30);var a$V=a$Y._tempV31.elements;a$V[0]=a$Sk.dot(a$Y._tempV30,a$Y._rows1[0]),a$V[1]=a$Sk.dot(a$Y._tempV30,a$Y._rows1[1]),a$V[2]=a$Sk.dot(a$Y._tempV30,a$Y._rows1[2]);var a$J=a$Y._tempV32.elements,a$W=a$Y._tempV33.elements;for(a$k=0;a$k<3;a$k++)if(a$J[0]=a$Y._tempM1.getElementByRowColumn(a$k,0),a$J[1]=a$Y._tempM1.getElementByRowColumn(a$k,1),a$J[2]=a$Y._tempM1.getElementByRowColumn(a$k,2),a$Q[a$k]+a$Sk.dot(a$Y._tempV35,a$Y._tempV32)<Math.abs(a$V[a$k]))return 0;for(a$v=0;a$v<3;a$v++)if(a$J[0]=a$Y._tempM1.getElementByRowColumn(0,a$v),a$J[1]=a$Y._tempM1.getElementByRowColumn(1,a$v),a$J[2]=a$Y._tempM1.getElementByRowColumn(2,a$v),a$W[0]=a$Y._tempM0.getElementByRowColumn(0,a$v),a$W[1]=a$Y._tempM0.getElementByRowColumn(1,a$v),a$W[2]=a$Y._tempM0.getElementByRowColumn(2,a$v),a$Sk.dot(this.extents,a$Y._tempV32)+a$u[a$v]<Math.abs(a$Sk.dot(a$Y._tempV31,a$Y._tempV33)))return 0;for(a$k=0;a$k<3;a$k++)for(a$v=0;a$v<3;a$v++){var a$w=(a$k+1)%3,a$M=(a$k+2)%3,a$H=(a$v+1)%3,a$E=(a$v+2)%3;if(a$Q[a$w]*a$Y._tempM1.getElementByRowColumn(a$M,a$v)+a$Q[a$M]*a$Y._tempM1.getElementByRowColumn(a$w,a$v)+(a$u[a$H]*a$Y._tempM1.getElementByRowColumn(a$k,a$E)+a$u[a$E]*a$Y._tempM1.getElementByRowColumn(a$k,a$H))<Math.abs(a$V[a$M]*a$Y._tempM0.getElementByRowColumn(a$w,a$v)-a$V[a$w]*a$Y._tempM0.getElementByRowColumn(a$M,a$v)))return 0}return 2},a$t.containsLine=function(a$t,a$k){a$Y._corners[0]=a$t,a$Y._corners[1]=a$k;var a$v=this.containsPoints(a$Y._corners);if(0!=a$v)return a$v;var a$j=this.extents.elements,a$Q=a$j[0],a$u=a$j[1],a$S=a$j[2];this.transformation.invert(a$Y._tempM0),a$Sk.transformCoordinate(a$t,a$Y._tempM0,a$Y._tempV30),a$Sk.transformCoordinate(a$k,a$Y._tempM0,a$Y._tempV31),a$Sk.add(a$Y._tempV30,a$Y._tempV31,a$Y._tempV32),a$Sk.scale(a$Y._tempV32,.5,a$Y._tempV32),a$Sk.subtract(a$Y._tempV30,a$Y._tempV32,a$Y._tempV33);var a$V=a$Y._tempV33.elements,a$J=a$V[0],a$W=a$V[1],a$w=a$V[2],a$M=a$Y._tempV34.elements,a$H=a$M[0]=Math.abs(a$V[0]),a$E=a$M[1]=Math.abs(a$V[1]),a$A=a$M[2]=Math.abs(a$V[2]),a$R=a$Y._tempV32.elements,a$h=a$R[0],a$l=a$R[1],a$o=a$R[2];return Math.abs(a$h)>a$Q+a$H?0:Math.abs(a$l)>a$u+a$E?0:Math.abs(a$o)>a$S+a$A?0:Math.abs(a$l*a$w-a$o*a$W)>a$u*a$A+a$S*a$E?0:Math.abs(a$h*a$w-a$o*a$J)>a$Q*a$A+a$S*a$H?0:Math.abs(a$h*a$W-a$l*a$J)>a$Q*a$E+a$u*a$H?0:2},a$t.containsBoundBox=function(a$t){var a$k=0,a$v=0,a$j=a$t.min,a$Q=a$t.max;a$t.getCorners(a$Y._corners);var a$u=this.containsPoints(a$Y._corners);if(0!=a$u)return a$u;a$Sk.subtract(a$Q,a$j,a$Y._tempV30),a$Sk.scale(a$Y._tempV30,.5,a$Y._tempV30),a$Sk.add(a$j,a$Y._tempV30,a$Y._tempV30),a$Sk.subtract(a$Q,a$Y._tempV30,a$Y._tempV31);var a$S=this.extents.elements,a$V=a$Y._tempV31.elements;a$Y._getRows(this.transformation,a$Y._rows1),this.transformation.invert(a$Y._tempM0);for(a$k=0;a$k<3;a$k++)for(a$v=0;a$v<3;a$v++)a$Y._tempM1.setElementByRowColumn(a$k,a$v,Math.abs(a$Y._tempM0.getElementByRowColumn(a$k,a$v)));this.getCenter(a$Y._tempV35),a$Sk.subtract(a$Y._tempV30,a$Y._tempV35,a$Y._tempV32);var a$J=a$Y._tempV31.elements;a$J[0]=a$Sk.dot(a$Y._tempV32,a$Y._rows1[0]),a$J[1]=a$Sk.dot(a$Y._tempV32,a$Y._rows1[1]),a$J[2]=a$Sk.dot(a$Y._tempV32,a$Y._rows1[2]);var a$W=a$Y._tempV33.elements,a$w=a$Y._tempV34.elements;for(a$k=0;a$k<3;a$k++)if(a$W[0]=a$Y._tempM1.getElementByRowColumn(a$k,0),a$W[1]=a$Y._tempM1.getElementByRowColumn(a$k,1),a$W[2]=a$Y._tempM1.getElementByRowColumn(a$k,2),a$S[a$k]+a$Sk.dot(a$Y._tempV31,a$Y._tempV33)<Math.abs(a$J[a$k]))return 0;for(a$v=0;a$v<3;a$v++)if(a$W[0]=a$Y._tempM1.getElementByRowColumn(0,a$v),a$W[1]=a$Y._tempM1.getElementByRowColumn(1,a$v),a$W[2]=a$Y._tempM1.getElementByRowColumn(2,a$v),a$w[0]=a$Y._tempM0.getElementByRowColumn(0,a$v),a$w[1]=a$Y._tempM0.getElementByRowColumn(1,a$v),a$w[2]=a$Y._tempM0.getElementByRowColumn(2,a$v),a$Sk.dot(this.extents,a$Y._tempV33)+a$V[a$v]<Math.abs(a$Sk.dot(a$Y._tempV31,a$Y._tempV34)))return 0;for(a$k=0;a$k<3;a$k++)for(a$v=0;a$v<3;a$v++){var a$M=(a$k+1)%3,a$H=(a$k+2)%3,a$E=(a$v+1)%3,a$A=(a$v+2)%3;if(a$S[a$M]*a$Y._tempM1.getElementByRowColumn(a$H,a$v)+a$S[a$H]*a$Y._tempM1.getElementByRowColumn(a$M,a$v)+(a$V[a$E]*a$Y._tempM1.getElementByRowColumn(a$k,a$A)+a$V[a$A]*a$Y._tempM1.getElementByRowColumn(a$k,a$E))<Math.abs(a$J[a$H]*a$Y._tempM0.getElementByRowColumn(a$M,a$v)-a$J[a$M]*a$Y._tempM0.getElementByRowColumn(a$H,a$v)))return 0}return 2},a$t.intersectsRay=function(a$t,a$k){a$Sk.scale(this.extents,-1,a$Y._tempV30),this.transformation.invert(a$Y._tempM0),a$Sk.TransformNormal(a$t.direction,a$Y._tempM0,a$Y._ray.direction),a$Sk.transformCoordinate(a$t.origin,a$Y._tempM0,a$Y._ray.origin),a$Y._boxBound1.min=a$Y._tempV30,a$Y._boxBound1.max=this.extents;var a$v=Collision.intersectsRayAndBoxRP(a$Y._ray,a$Y._boxBound1,a$k);return-1!==a$v&&a$Sk.transformCoordinate(a$k,this.transformation,a$k),a$v},a$t._getLocalCorners=function(a$t){a$t.length=8;var a$k=this.extents.elements;a$Y._tempV30.x=a$k[0],a$Y._tempV31.y=a$k[1],a$Y._tempV32.z=a$k[2],a$Sk.add(a$Y._tempV30,a$Y._tempV31,a$Y._tempV33),a$Sk.add(a$Y._tempV33,a$Y._tempV32,a$t[0]),a$Sk.add(a$Y._tempV30,a$Y._tempV31,a$Y._tempV33),a$Sk.subtract(a$Y._tempV33,a$Y._tempV32,a$t[1]),a$Sk.subtract(a$Y._tempV31,a$Y._tempV30,a$Y._tempV33),a$Sk.subtract(a$Y._tempV33,a$Y._tempV30,a$t[2]),a$Sk.subtract(a$Y._tempV31,a$Y._tempV30,a$Y._tempV33),a$Sk.add(a$Y._tempV33,a$Y._tempV32,a$t[3]),a$Sk.subtract(a$Y._tempV30,a$Y._tempV31,a$Y._tempV33),a$Sk.add(a$Y._tempV33,a$Y._tempV32,a$t[4]),a$Sk.subtract(a$Y._tempV30,a$Y._tempV31,a$Y._tempV33),a$Sk.subtract(a$Y._tempV33,a$Y._tempV32,a$t[5]),a$Sk.scale(a$t[0],-1,a$t[6]),a$Sk.subtract(a$Y._tempV32,a$Y._tempV30,a$Y._tempV33),a$Sk.subtract(a$Y._tempV33,a$Y._tempV31,a$t[7])},a$t.equals=function(a$t){return this.extents==a$t.extents&&this.transformation==a$t.transformation},a$t.cloneTo=function(a$t){var a$k=a$t;this.extents.cloneTo(a$k.extents),this.transformation.cloneTo(a$k.transformation)},a$Y.createByBoundBox=function(a$t,a$k){var a$v=a$t.min,a$j=a$t.max;a$Sk.subtract(a$j,a$v,a$Y._tempV30),a$Sk.scale(a$Y._tempV30,.5,a$Y._tempV30),a$Sk.add(a$v,a$Y._tempV30,a$Y._tempV31),a$Sk.subtract(a$j,a$Y._tempV31,a$Y._tempV32),a$tk.translation(a$Y._tempV31,a$Y._tempM0);var a$Q=a$Y._tempV32.clone(),a$u=a$Y._tempM0.clone();a$k.extents=a$Q,a$k.transformation=a$u},a$Y.createByMinAndMaxVertex=function(a$t,a$k){return a$Sk.subtract(a$k,a$t,a$Y._tempV30),a$Sk.scale(a$Y._tempV30,.5,a$Y._tempV30),a$Sk.add(a$t,a$Y._tempV30,a$Y._tempV31),a$Sk.subtract(a$k,a$Y._tempV31,a$Y._tempV32),a$tk.translation(a$Y._tempV31,a$Y._tempM0),new a$Y(a$Y._tempV32,a$Y._tempM0)},a$Y._getRows=function(a$t,a$k){a$k.length=3;var a$v=a$t.elements,a$j=a$k[0].elements;a$j[0]=a$v[0],a$j[1]=a$v[1],a$j[2]=a$v[2];var a$Q=a$k[1].elements;a$Q[0]=a$v[4],a$Q[1]=a$v[5],a$Q[2]=a$v[6];var a$u=a$k[2].elements;a$u[0]=a$v[8],a$u[1]=a$v[9],a$u[2]=a$v[10]},a$Y.getObbtoObbMatrix4x4=function(a$t,a$k,a$v,a$j){var a$Q=a$t.transformation,a$u=a$k.transformation;if(a$v){a$Y._getRows(a$Q,a$Y._rows1),a$Y._getRows(a$u,a$Y._rows2);for(var a$S=0;a$S<3;a$S++)for(var a$V=0;a$V<3;a$V++)a$j.setElementByRowColumn(a$S,a$V,a$Sk.dot(a$Y._rows2[a$S],a$Y._rows1[a$V]));a$k.getCenter(a$Y._tempV30),a$t.getCenter(a$Y._tempV31),a$Sk.subtract(a$Y._tempV30,a$Y._tempV31,a$Y._tempV32);var a$J=a$j.elements;a$J[12]=a$Sk.dot(a$Y._tempV32,a$Y._rows1[0]),a$J[13]=a$Sk.dot(a$Y._tempV32,a$Y._rows1[1]),a$J[14]=a$Sk.dot(a$Y._tempV32,a$Y._rows1[2]),a$J[15]=1}else a$Q.invert(a$Y._tempM0),a$tk.multiply(a$u,a$Y._tempM0,a$j)},a$Y.merge=function(a$t,a$k,a$v){var a$j=a$t.extents,a$Q=a$t.transformation;a$Y.getObbtoObbMatrix4x4(a$t,a$k,a$v,a$Y._tempM0),a$k._getLocalCorners(a$Y._corners),a$Sk.transformCoordinate(a$Y._corners[0],a$Y._tempM0,a$Y._corners[0]),a$Sk.transformCoordinate(a$Y._corners[1],a$Y._tempM0,a$Y._corners[1]),a$Sk.transformCoordinate(a$Y._corners[2],a$Y._tempM0,a$Y._corners[2]),a$Sk.transformCoordinate(a$Y._corners[3],a$Y._tempM0,a$Y._corners[3]),a$Sk.transformCoordinate(a$Y._corners[4],a$Y._tempM0,a$Y._corners[4]),a$Sk.transformCoordinate(a$Y._corners[5],a$Y._tempM0,a$Y._corners[5]),a$Sk.transformCoordinate(a$Y._corners[6],a$Y._tempM0,a$Y._corners[6]),a$Sk.transformCoordinate(a$Y._corners[7],a$Y._tempM0,a$Y._corners[7]),a$Sk.scale(a$j,-1,a$Y._boxBound1.min),a$j.cloneTo(a$Y._boxBound1.max),a$rt.createfromPoints(a$Y._corners,a$Y._boxBound2),a$rt.merge(a$Y._boxBound2,a$Y._boxBound1,a$Y._boxBound3);var a$u=a$Y._boxBound3.min,a$S=a$Y._boxBound3.max;a$Sk.subtract(a$S,a$u,a$Y._tempV30),a$Sk.scale(a$Y._tempV30,.5,a$Y._tempV30),a$Sk.add(a$u,a$Y._tempV30,a$Y._tempV32),a$Sk.subtract(a$S,a$Y._tempV32,a$j),a$Sk.transformCoordinate(a$Y._tempV32,a$Q,a$Y._tempV33)},a$M(a$Y,["_tempV30",function(){return this._tempV30=new a$Sk},"_tempV31",function(){return this._tempV31=new a$Sk},"_tempV32",function(){return this._tempV32=new a$Sk},"_tempV33",function(){return this._tempV33=new a$Sk},"_tempV34",function(){return this._tempV34=new a$Sk},"_tempV35",function(){return this._tempV35=new a$Sk},"_tempV36",function(){return this._tempV36=new a$Sk},"_tempM0",function(){return this._tempM0=new a$tk},"_tempM1",function(){return this._tempM1=new a$tk},"_corners",function(){return this._corners=[new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk]},"_rows1",function(){return this._rows1=[new a$Sk,new a$Sk,new a$Sk]},"_rows2",function(){return this._rows2=[new a$Sk,new a$Sk,new a$Sk]},"_ray",function(){return this._ray=new a$Qk(new a$Sk,new a$Sk)},"_boxBound1",function(){return this._boxBound1=new a$rt(new a$Sk,new a$Sk)},"_boxBound2",function(){return this._boxBound2=new a$rt(new a$Sk,new a$Sk)},"_boxBound3",function(){return this._boxBound3=new a$rt(new a$Sk,new a$Sk)}])}(),function(){function a$X(a$t,a$k){this.normal=null,this.distance=NaN,void 0===a$k&&(a$k=0),this.normal=a$t,this.distance=a$k}return a$E(a$X,"laya.d3.math.Plane"),a$X.prototype.normalize=function(){var a$t=this.normal.elements,a$k=a$t[0],a$v=a$t[1],a$j=a$t[2],a$Q=1/Math.sqrt(a$k*a$k+a$v*a$v+a$j*a$j);a$t[0]=a$k*a$Q,a$t[1]=a$v*a$Q,a$t[2]=a$j*a$Q,this.distance*=a$Q},a$X.createPlaneBy3P=function(a$t,a$k,a$v){var a$j=a$t.elements,a$Q=a$k.elements,a$u=a$v.elements,a$S=a$Q[0]-a$j[0],a$V=a$Q[1]-a$j[1],a$J=a$Q[2]-a$j[2],a$W=a$u[0]-a$j[0],a$w=a$u[1]-a$j[1],a$M=a$u[2]-a$j[2],a$H=a$V*a$M-a$J*a$w,a$E=a$J*a$W-a$S*a$M,a$A=a$S*a$w-a$V*a$W,a$R=1/Math.sqrt(a$H*a$H+a$E*a$E+a$A*a$A),a$h=a$H*a$R,a$l=a$E*a$R,a$o=a$A*a$R,a$Y=a$X._TEMPVec3.elements;a$Y[0]=a$h,a$Y[1]=a$l,a$Y[2]=a$o;var a$f=-(a$h*a$j[0]+a$l*a$j[1]+a$o*a$j[2]);return new a$X(a$X._TEMPVec3,a$f)},a$X.PlaneIntersectionType_Back=0,a$X.PlaneIntersectionType_Front=1,a$X.PlaneIntersectionType_Intersecting=2,a$M(a$X,["_TEMPVec3",function(){return this._TEMPVec3=new a$Sk}]),a$X}()),a$vk=function(){function a$Q(a$t,a$k,a$v,a$j){this.elements=new Float32Array(4),void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=1),this.elements[0]=a$t,this.elements[1]=a$k,this.elements[2]=a$v,this.elements[3]=a$j}a$E(a$Q,"laya.d3.math.Quaternion");var a$t=a$Q.prototype;return a$X.imps(a$t,{"laya.d3.core.IClone":!0}),a$t.scaling=function(a$t,a$k){var a$v=a$k.elements,a$j=this.elements;a$v[0]=a$j[0]*a$t,a$v[1]=a$j[1]*a$t,a$v[2]=a$j[2]*a$t,a$v[3]=a$j[3]*a$t},a$t.normalize=function(a$t){var a$k=a$t.elements,a$v=this.elements,a$j=a$v[0],a$Q=a$v[1],a$u=a$v[2],a$S=a$v[3],a$V=a$j*a$j+a$Q*a$Q+a$u*a$u+a$S*a$S;0<a$V&&(a$V=1/Math.sqrt(a$V),a$k[0]=a$j*a$V,a$k[1]=a$Q*a$V,a$k[2]=a$u*a$V,a$k[3]=a$S*a$V)},a$t.length=function(){var a$t=this.elements,a$k=a$t[0],a$v=a$t[1],a$j=a$t[2],a$Q=a$t[3];return Math.sqrt(a$k*a$k+a$v*a$v+a$j*a$j+a$Q*a$Q)},a$t.rotateX=function(a$t,a$k){var a$v=a$k.elements,a$j=this.elements;a$t*=.5;var a$Q=a$j[0],a$u=a$j[1],a$S=a$j[2],a$V=a$j[3],a$J=Math.sin(a$t),a$W=Math.cos(a$t);a$v[0]=a$Q*a$W+a$V*a$J,a$v[1]=a$u*a$W+a$S*a$J,a$v[2]=a$S*a$W-a$u*a$J,a$v[3]=a$V*a$W-a$Q*a$J},a$t.rotateY=function(a$t,a$k){var a$v=a$k.elements,a$j=this.elements;a$t*=.5;var a$Q=a$j[0],a$u=a$j[1],a$S=a$j[2],a$V=a$j[3],a$J=Math.sin(a$t),a$W=Math.cos(a$t);a$v[0]=a$Q*a$W-a$S*a$J,a$v[1]=a$u*a$W+a$V*a$J,a$v[2]=a$S*a$W+a$Q*a$J,a$v[3]=a$V*a$W-a$u*a$J},a$t.rotateZ=function(a$t,a$k){var a$v=a$k.elements,a$j=this.elements;a$t*=.5;var a$Q=a$j[0],a$u=a$j[1],a$S=a$j[2],a$V=a$j[3],a$J=Math.sin(a$t),a$W=Math.cos(a$t);a$v[0]=a$Q*a$W+a$u*a$J,a$v[1]=a$u*a$W-a$Q*a$J,a$v[2]=a$S*a$W+a$V*a$J,a$v[3]=a$V*a$W-a$S*a$J},a$t.getYawPitchRoll=function(a$t){a$Sk.transformQuat(a$Sk.ForwardRH,this,a$Q.TEMPVector31),a$Sk.transformQuat(a$Sk.Up,this,a$Q.TEMPVector32);var a$k=a$Q.TEMPVector32.elements;a$Q.angleTo(a$Sk.ZERO,a$Q.TEMPVector31,a$Q.TEMPVector33);var a$v=a$Q.TEMPVector33.elements;a$v[0]==Math.PI/2?(a$v[1]=a$Q.arcTanAngle(a$k[2],a$k[0]),a$v[2]=0):a$v[0]==-Math.PI/2?(a$v[1]=a$Q.arcTanAngle(-a$k[2],-a$k[0]),a$v[2]=0):(a$tk.createRotationY(-a$v[1],a$Q.TEMPMatrix0),a$tk.createRotationX(-a$v[0],a$Q.TEMPMatrix1),a$Sk.transformCoordinate(a$Q.TEMPVector32,a$Q.TEMPMatrix0,a$Q.TEMPVector32),a$Sk.transformCoordinate(a$Q.TEMPVector32,a$Q.TEMPMatrix1,a$Q.TEMPVector32),a$v[2]=a$Q.arcTanAngle(a$k[1],-a$k[0])),a$v[1]<=-Math.PI&&(a$v[1]=Math.PI),a$v[2]<=-Math.PI&&(a$v[2]=Math.PI),a$v[1]>=Math.PI&&a$v[2]>=Math.PI&&(a$v[1]=0,a$v[2]=0,a$v[0]=Math.PI-a$v[0]);var a$j=a$t.elements;a$j[0]=a$v[1],a$j[1]=a$v[0],a$j[2]=a$v[2]},a$t.invert=function(a$t){var a$k=a$t.elements,a$v=this.elements,a$j=a$v[0],a$Q=a$v[1],a$u=a$v[2],a$S=a$v[3],a$V=a$j*a$j+a$Q*a$Q+a$u*a$u+a$S*a$S,a$J=a$V?1/a$V:0;a$k[0]=-a$j*a$J,a$k[1]=-a$Q*a$J,a$k[2]=-a$u*a$J,a$k[3]=a$S*a$J},a$t.identity=function(){var a$t=this.elements;a$t[0]=0,a$t[1]=0,a$t[2]=0,a$t[3]=1},a$t.fromArray=function(a$t,a$k){void 0===a$k&&(a$k=0),this.elements[0]=a$t[a$k+0],this.elements[1]=a$t[a$k+1],this.elements[2]=a$t[a$k+2],this.elements[3]=a$t[a$k+3]},a$t.cloneTo=function(a$t){var a$k,a$v,a$j;if((a$v=this.elements)!==(a$j=a$t.elements))for(a$k=0;a$k<4;++a$k)a$j[a$k]=a$v[a$k]},a$t.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$t.equals=function(a$t){var a$k=this.elements,a$v=a$t.elements;return a$yt.nearEqual(a$k[0],a$v[0])&&a$yt.nearEqual(a$k[1],a$v[1])&&a$yt.nearEqual(a$k[2],a$v[2])&&a$yt.nearEqual(a$k[3],a$v[3])},a$t.lengthSquared=function(){var a$t=this.elements[0],a$k=this.elements[1],a$v=this.elements[2],a$j=this.elements[3];return a$t*a$t+a$k*a$k+a$v*a$v+a$j*a$j},a$A(0,a$t,"x",function(){return this.elements[0]}),a$A(0,a$t,"y",function(){return this.elements[1]}),a$A(0,a$t,"z",function(){return this.elements[2]}),a$A(0,a$t,"w",function(){return this.elements[3]}),a$Q.createFromYawPitchRoll=function(a$t,a$k,a$v,a$j){var a$Q=.5*a$v,a$u=.5*a$k,a$S=.5*a$t,a$V=Math.sin(a$Q),a$J=Math.cos(a$Q),a$W=Math.sin(a$u),a$w=Math.cos(a$u),a$M=Math.sin(a$S),a$H=Math.cos(a$S),a$E=a$j.elements;a$E[0]=a$H*a$W*a$J+a$M*a$w*a$V,a$E[1]=a$M*a$w*a$J-a$H*a$W*a$V,a$E[2]=a$H*a$w*a$V-a$M*a$W*a$J,a$E[3]=a$H*a$w*a$J+a$M*a$W*a$V},a$Q.multiply=function(a$t,a$k,a$v){var a$j=a$t.elements,a$Q=a$k.elements,a$u=a$v.elements,a$S=a$j[0],a$V=a$j[1],a$J=a$j[2],a$W=a$j[3],a$w=a$Q[0],a$M=a$Q[1],a$H=a$Q[2],a$E=a$Q[3],a$A=a$V*a$H-a$J*a$M,a$R=a$J*a$w-a$S*a$H,a$h=a$S*a$M-a$V*a$w,a$l=a$S*a$w+a$V*a$M+a$J*a$H;a$u[0]=a$S*a$E+a$w*a$W+a$A,a$u[1]=a$V*a$E+a$M*a$W+a$R,a$u[2]=a$J*a$E+a$H*a$W+a$h,a$u[3]=a$W*a$E-a$l},a$Q.arcTanAngle=function(a$t,a$k){return 0==a$t?1==a$k?Math.PI/2:-Math.PI/2:0<a$t?Math.atan(a$k/a$t):a$t<0?0<a$k?Math.atan(a$k/a$t)+Math.PI:Math.atan(a$k/a$t)-Math.PI:0},a$Q.angleTo=function(a$t,a$k,a$v){a$Sk.subtract(a$k,a$t,a$Q.TEMPVector30),a$Sk.normalize(a$Q.TEMPVector30,a$Q.TEMPVector30),a$v.elements[0]=Math.asin(a$Q.TEMPVector30.y),a$v.elements[1]=a$Q.arcTanAngle(-a$Q.TEMPVector30.z,-a$Q.TEMPVector30.x)},a$Q.createFromAxisAngle=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements;a$k*=.5;var a$u=Math.sin(a$k);a$j[0]=a$u*a$Q[0],a$j[1]=a$u*a$Q[1],a$j[2]=a$u*a$Q[2],a$j[3]=Math.cos(a$k)},a$Q.createFromMatrix3x3=function(a$t,a$k){var a$v,a$j=a$k.elements,a$Q=a$t.elements,a$u=a$Q[0]+a$Q[4]+a$Q[8];if(0<a$u)a$v=Math.sqrt(a$u+1),a$j[3]=.5*a$v,a$v=.5/a$v,a$j[0]=(a$Q[5]-a$Q[7])*a$v,a$j[1]=(a$Q[6]-a$Q[2])*a$v,a$j[2]=(a$Q[1]-a$Q[3])*a$v;else{var a$S=0;a$Q[4]>a$Q[0]&&(a$S=1),a$Q[8]>a$Q[3*a$S+a$S]&&(a$S=2);var a$V=(a$S+1)%3,a$J=(a$S+2)%3;a$v=Math.sqrt(a$Q[3*a$S+a$S]-a$Q[3*a$V+a$V]-a$Q[3*a$J+a$J]+1),a$j[a$S]=.5*a$v,a$v=.5/a$v,a$j[3]=(a$Q[3*a$V+a$J]-a$Q[3*a$J+a$V])*a$v,a$j[a$V]=(a$Q[3*a$V+a$S]+a$Q[3*a$S+a$V])*a$v,a$j[a$J]=(a$Q[3*a$J+a$S]+a$Q[3*a$S+a$J])*a$v}},a$Q.createFromMatrix4x4=function(a$t,a$k){var a$v,a$j,a$Q=a$t.elements,a$u=a$k.elements,a$S=a$Q[0]+a$Q[5]+a$Q[10];0<a$S?(a$v=Math.sqrt(a$S+1),a$u[3]=.5*a$v,a$v=.5/a$v,a$u[0]=(a$Q[6]-a$Q[9])*a$v,a$u[1]=(a$Q[8]-a$Q[2])*a$v,a$u[2]=(a$Q[1]-a$Q[4])*a$v):a$Q[0]>=a$Q[5]&&a$Q[0]>=a$Q[10]?(a$j=.5/(a$v=Math.sqrt(1+a$Q[0]-a$Q[5]-a$Q[10])),a$u[0]=.5*a$v,a$u[1]=(a$Q[1]+a$Q[4])*a$j,a$u[2]=(a$Q[2]+a$Q[8])*a$j,a$u[3]=(a$Q[6]-a$Q[9])*a$j):a$Q[5]>a$Q[10]?(a$j=.5/(a$v=Math.sqrt(1+a$Q[5]-a$Q[0]-a$Q[10])),a$u[0]=(a$Q[4]+a$Q[1])*a$j,a$u[1]=.5*a$v,a$u[2]=(a$Q[9]+a$Q[6])*a$j,a$u[3]=(a$Q[8]-a$Q[2])*a$j):(a$j=.5/(a$v=Math.sqrt(1+a$Q[10]-a$Q[0]-a$Q[5])),a$u[0]=(a$Q[8]+a$Q[2])*a$j,a$u[1]=(a$Q[9]+a$Q[6])*a$j,a$u[2]=.5*a$v,a$u[3]=(a$Q[1]-a$Q[4])*a$j)},a$Q.slerp=function(a$t,a$k,a$v,a$j){var a$Q,a$u,a$S,a$V,a$J,a$W=a$t.elements,a$w=a$k.elements,a$M=a$j.elements,a$H=a$W[0],a$E=a$W[1],a$A=a$W[2],a$R=a$W[3],a$h=a$w[0],a$l=a$w[1],a$o=a$w[2],a$Y=a$w[3];return(a$u=a$H*a$h+a$E*a$l+a$A*a$o+a$R*a$Y)<0&&(a$u=-a$u,a$h=-a$h,a$l=-a$l,a$o=-a$o,a$Y=-a$Y),a$J=1e-6<1-a$u?(a$Q=Math.acos(a$u),a$S=Math.sin(a$Q),a$V=Math.sin((1-a$v)*a$Q)/a$S,Math.sin(a$v*a$Q)/a$S):(a$V=1-a$v,a$v),a$M[0]=a$V*a$H+a$J*a$h,a$M[1]=a$V*a$E+a$J*a$l,a$M[2]=a$V*a$A+a$J*a$o,a$M[3]=a$V*a$R+a$J*a$Y,a$M},a$Q.lerp=function(a$t,a$k,a$v,a$j){var a$Q=a$j.elements,a$u=a$t.elements,a$S=a$k.elements,a$V=a$u[0],a$J=a$u[1],a$W=a$u[2],a$w=a$u[3];a$Q[0]=a$V+a$v*(a$S[0]-a$V),a$Q[1]=a$J+a$v*(a$S[1]-a$J),a$Q[2]=a$W+a$v*(a$S[2]-a$W),a$Q[3]=a$w+a$v*(a$S[3]-a$w)},a$Q.add=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k.elements;a$j[0]=a$Q[0]+a$u[0],a$j[1]=a$Q[1]+a$u[1],a$j[2]=a$Q[2]+a$u[2],a$j[3]=a$Q[3]+a$u[3]},a$Q.dot=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements;return a$v[0]*a$j[0]+a$v[1]*a$j[1]+a$v[2]*a$j[2]+a$v[3]*a$j[3]},a$Q.rotationLookAt=function(a$t,a$k,a$v){a$Q.lookAt(a$Sk.ZERO,a$t,a$k,a$v)},a$Q.lookAt=function(a$t,a$k,a$v,a$j){a$Pt.lookAt(a$t,a$k,a$v,a$Q._tempMatrix3x3),a$Q.rotationMatrix(a$Q._tempMatrix3x3,a$j)},a$Q.invert=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements,a$Q=a$t.lengthSquared();a$yt.isZero(a$Q)||(a$Q=1/a$Q,a$j[0]=-a$v[0]*a$Q,a$j[1]=-a$v[1]*a$Q,a$j[2]=-a$v[2]*a$Q,a$j[3]=a$v[3]*a$Q)},a$Q.rotationMatrix=function(a$t,a$k){var a$v=a$t.elements,a$j=a$v[0],a$Q=a$v[1],a$u=a$v[2],a$S=a$v[3],a$V=a$v[4],a$J=a$v[5],a$W=a$v[6],a$w=a$v[7],a$M=a$v[8],a$H=a$k.elements,a$E=NaN,a$A=NaN,a$R=a$j+a$V+a$M;0<a$R?(a$E=Math.sqrt(a$R+1),a$H[3]=.5*a$E,a$E=.5/a$E,a$H[0]=(a$J-a$w)*a$E,a$H[1]=(a$W-a$u)*a$E,a$H[2]=(a$Q-a$S)*a$E):a$V<=a$j&&a$M<=a$j?(a$A=.5/(a$E=Math.sqrt(1+a$j-a$V-a$M)),a$H[0]=.5*a$E,a$H[1]=(a$Q+a$S)*a$A,a$H[2]=(a$u+a$W)*a$A,a$H[3]=(a$J-a$w)*a$A):a$M<a$V?(a$A=.5/(a$E=Math.sqrt(1+a$V-a$j-a$M)),a$H[0]=(a$S+a$Q)*a$A,a$H[1]=.5*a$E,a$H[2]=(a$w+a$J)*a$A,a$H[3]=(a$W-a$u)*a$A):(a$A=.5/(a$E=Math.sqrt(1+a$M-a$j-a$V)),a$H[0]=(a$W+a$u)*a$A,a$H[1]=(a$w+a$J)*a$A,a$H[2]=.5*a$E,a$H[3]=(a$Q-a$S)*a$A)},a$Q.DEFAULT=new a$Q,a$M(a$Q,["TEMPVector30",function(){return this.TEMPVector30=new a$Sk},"TEMPVector31",function(){return this.TEMPVector31=new a$Sk},"TEMPVector32",function(){return this.TEMPVector32=new a$Sk},"TEMPVector33",function(){return this.TEMPVector33=new a$Sk},"TEMPMatrix0",function(){return this.TEMPMatrix0=new a$tk},"TEMPMatrix1",function(){return this.TEMPMatrix1=new a$tk},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new a$Pt},"NAN",function(){return this.NAN=new a$Q(NaN,NaN,NaN,NaN)}]),a$Q}(),a$jk=function(){function a$t(a$t){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=a$t,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}a$E(a$t,"laya.d3.math.Rand");var a$k=a$t.prototype;return a$k.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},a$k.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},a$k.getSignedFloat=function(){return 2*this.getFloat()-1},a$A(0,a$k,"seed",function(){return this.seeds[0]},function(a$t){this.seeds[0]=a$t,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),a$t.getFloatFromInt=function(a$t){return 1/8388607*(8388607&a$t)},a$t.getByteFromInt=function(a$t){return(8388607&a$t)>>>15},a$t}(),a$Qk=(function(){function a$Q(a$t){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(a$t instanceof Array)||4!==a$t.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|a$t[0],this._state0L=0|a$t[1],this._state1U=0|a$t[2],this._state1L=0|a$t[3]}a$E(a$Q,"laya.d3.math.RandX");var a$t=a$Q.prototype;a$t.randomint=function(){var a$t=this._state0U,a$k=this._state0L,a$v=this._state1U,a$j=this._state1L,a$Q=(a$j>>>0)+(a$k>>>0),a$u=a$v+a$t+(a$Q/2>>>31)>>>0,a$S=a$Q>>>0,a$V=0,a$J=0;a$V=(a$t^=a$V=a$t<<23|(-512&a$k)>>>9)^(this._state0U=a$v),a$J=(a$k^=a$J=a$k<<23)^(this._state0L=a$j);a$V^=a$t>>>18,a$J^=a$k>>>18|(262143&a$t)<<14;return a$V^=a$v>>>5,a$J^=a$j>>>5|(31&a$v)<<27,this._state1U=a$V,this._state1L=a$J,[a$u,a$S]},a$t.random=function(){var a$t=this.randomint(),a$k=a$t[0],a$v=1023<<20|a$k>>>12,a$j=0|(a$t[1]>>>12|(4095&a$k)<<20);return a$Q._CONVERTION_BUFFER.setUint32(0,a$v,!1),a$Q._CONVERTION_BUFFER.setUint32(4,a$j,!1),a$jk._CONVERTION_BUFFER.getFloat64(0,!1)-1},a$M(a$Q,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new a$jk([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function a$t(a$t,a$k){this.origin=null,this.direction=null,this.origin=a$t,this.direction=a$k}return a$E(a$t,"laya.d3.math.Ray"),a$t}()),a$uk=function(){function a$t(a$t,a$k){this.elements=new Float32Array(2),void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0);var a$v=this.elements;a$v[0]=a$t,a$v[1]=a$k}a$E(a$t,"laya.d3.math.Vector2");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k.fromArray=function(a$t,a$k){void 0===a$k&&(a$k=0),this.elements[0]=a$t[a$k+0],this.elements[1]=a$t[a$k+1]},a$k.cloneTo=function(a$t){var a$k=a$t.elements,a$v=this.elements;a$k[0]=a$v[0],a$k[1]=a$v[1]},a$k.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$k,"x",function(){return this.elements[0]},function(a$t){this.elements[0]=a$t}),a$A(0,a$k,"y",function(){return this.elements[1]},function(a$t){this.elements[1]=a$t}),a$t.scale=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements;a$j[0]=a$Q[0]*a$k,a$j[1]=a$Q[1]*a$k},a$M(a$t,["ZERO",function(){return this.ZERO=new a$t(0,0)},"ONE",function(){return this.ONE=new a$t(1,1)}]),a$t}(),a$Sk=function(){function a$w(a$t,a$k,a$v){this.elements=new Float32Array(3),void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0);var a$j=this.elements;a$j[0]=a$t,a$j[1]=a$k,a$j[2]=a$v}a$E(a$w,"laya.d3.math.Vector3");var a$t=a$w.prototype;return a$X.imps(a$t,{"laya.d3.core.IClone":!0}),a$t.fromArray=function(a$t,a$k){void 0===a$k&&(a$k=0),this.elements[0]=a$t[a$k+0],this.elements[1]=a$t[a$k+1],this.elements[2]=a$t[a$k+2]},a$t.cloneTo=function(a$t){var a$k=a$t.elements,a$v=this.elements;a$k[0]=a$v[0],a$k[1]=a$v[1],a$k[2]=a$v[2]},a$t.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$t.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},a$t.reset=function(a$t,a$k,a$v){this.elements[0]=a$t,this.elements[1]=a$k,this.elements[2]=a$v},a$A(0,a$t,"x",function(){return this.elements[0]},function(a$t){this.elements[0]=a$t}),a$A(0,a$t,"y",function(){return this.elements[1]},function(a$t){this.elements[1]=a$t}),a$A(0,a$t,"z",function(){return this.elements[2]},function(a$t){this.elements[2]=a$t}),a$w.distanceSquared=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements,a$Q=a$v[0]-a$j[0],a$u=a$v[1]-a$j[1],a$S=a$v[2]-a$j[2];return a$Q*a$Q+a$u*a$u+a$S*a$S},a$w.distance=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements,a$Q=a$v[0]-a$j[0],a$u=a$v[1]-a$j[1],a$S=a$v[2]-a$j[2];return Math.sqrt(a$Q*a$Q+a$u*a$u+a$S*a$S)},a$w.min=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k.elements;a$j[0]=Math.min(a$Q[0],a$u[0]),a$j[1]=Math.min(a$Q[1],a$u[1]),a$j[2]=Math.min(a$Q[2],a$u[2])},a$w.max=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k.elements;a$j[0]=Math.max(a$Q[0],a$u[0]),a$j[1]=Math.max(a$Q[1],a$u[1]),a$j[2]=Math.max(a$Q[2],a$u[2])},a$w.transformQuat=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k.elements,a$S=a$Q[0],a$V=a$Q[1],a$J=a$Q[2],a$W=a$u[0],a$w=a$u[1],a$M=a$u[2],a$H=a$u[3],a$E=a$H*a$S+a$w*a$J-a$M*a$V,a$A=a$H*a$V+a$M*a$S-a$W*a$J,a$R=a$H*a$J+a$W*a$V-a$w*a$S,a$h=-a$W*a$S-a$w*a$V-a$M*a$J;a$j[0]=a$E*a$H+a$h*-a$W+a$A*-a$M-a$R*-a$w,a$j[1]=a$A*a$H+a$h*-a$w+a$R*-a$W-a$E*-a$M,a$j[2]=a$R*a$H+a$h*-a$M+a$E*-a$w-a$A*-a$W},a$w.scalarLength=function(a$t){var a$k=a$t.elements,a$v=a$k[0],a$j=a$k[1],a$Q=a$k[2];return Math.sqrt(a$v*a$v+a$j*a$j+a$Q*a$Q)},a$w.scalarLengthSquared=function(a$t){var a$k=a$t.elements,a$v=a$k[0],a$j=a$k[1],a$Q=a$k[2];return a$v*a$v+a$j*a$j+a$Q*a$Q},a$w.normalize=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements,a$Q=a$v[0],a$u=a$v[1],a$S=a$v[2],a$V=a$Q*a$Q+a$u*a$u+a$S*a$S;0<a$V&&(a$V=1/Math.sqrt(a$V),a$j[0]=a$v[0]*a$V,a$j[1]=a$v[1]*a$V,a$j[2]=a$v[2]*a$V)},a$w.multiply=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k.elements;a$j[0]=a$Q[0]*a$u[0],a$j[1]=a$Q[1]*a$u[1],a$j[2]=a$Q[2]*a$u[2]},a$w.scale=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements;a$j[0]=a$Q[0]*a$k,a$j[1]=a$Q[1]*a$k,a$j[2]=a$Q[2]*a$k},a$w.lerp=function(a$t,a$k,a$v,a$j){var a$Q=a$j.elements,a$u=a$t.elements,a$S=a$k.elements,a$V=a$u[0],a$J=a$u[1],a$W=a$u[2];a$Q[0]=a$V+a$v*(a$S[0]-a$V),a$Q[1]=a$J+a$v*(a$S[1]-a$J),a$Q[2]=a$W+a$v*(a$S[2]-a$W)},a$w.transformV3ToV3=function(a$t,a$k,a$v){var a$j=a$w._tempVector4;a$w.transformV3ToV4(a$t,a$k,a$j);var a$Q=a$j.elements,a$u=a$v.elements;a$u[0]=a$Q[0],a$u[1]=a$Q[1],a$u[2]=a$Q[2]},a$w.transformV3ToV4=function(a$t,a$k,a$v){var a$j=a$t.elements,a$Q=a$j[0],a$u=a$j[1],a$S=a$j[2],a$V=a$k.elements,a$J=a$v.elements;a$J[0]=a$Q*a$V[0]+a$u*a$V[4]+a$S*a$V[8]+a$V[12],a$J[1]=a$Q*a$V[1]+a$u*a$V[5]+a$S*a$V[9]+a$V[13],a$J[2]=a$Q*a$V[2]+a$u*a$V[6]+a$S*a$V[10]+a$V[14],a$J[3]=a$Q*a$V[3]+a$u*a$V[7]+a$S*a$V[11]+a$V[15]},a$w.TransformNormal=function(a$t,a$k,a$v){var a$j=a$t.elements,a$Q=a$j[0],a$u=a$j[1],a$S=a$j[2],a$V=a$k.elements,a$J=a$v.elements;a$J[0]=a$Q*a$V[0]+a$u*a$V[4]+a$S*a$V[8],a$J[1]=a$Q*a$V[1]+a$u*a$V[5]+a$S*a$V[9],a$J[2]=a$Q*a$V[2]+a$u*a$V[6]+a$S*a$V[10]},a$w.transformCoordinate=function(a$t,a$k,a$v){var a$j=a$w._tempVector4.elements,a$Q=a$t.elements,a$u=a$Q[0],a$S=a$Q[1],a$V=a$Q[2],a$J=a$k.elements;a$j[0]=a$u*a$J[0]+a$S*a$J[4]+a$V*a$J[8]+a$J[12],a$j[1]=a$u*a$J[1]+a$S*a$J[5]+a$V*a$J[9]+a$J[13],a$j[2]=a$u*a$J[2]+a$S*a$J[6]+a$V*a$J[10]+a$J[14],a$j[3]=1/(a$u*a$J[3]+a$S*a$J[7]+a$V*a$J[11]+a$J[15]);var a$W=a$v.elements;a$W[0]=a$j[0]*a$j[3],a$W[1]=a$j[1]*a$j[3],a$W[2]=a$j[2]*a$j[3]},a$w.Clamp=function(a$t,a$k,a$v,a$j){var a$Q=a$t.elements,a$u=a$Q[0],a$S=a$Q[1],a$V=a$Q[2],a$J=a$k.elements,a$W=a$J[0],a$w=a$J[1],a$M=a$J[2],a$H=a$v.elements,a$E=a$H[0],a$A=a$H[1],a$R=a$H[2],a$h=a$j.elements;a$u=(a$u=a$E<a$u?a$E:a$u)<a$W?a$W:a$u,a$S=(a$S=a$A<a$S?a$A:a$S)<a$w?a$w:a$S,a$V=(a$V=a$R<a$V?a$R:a$V)<a$M?a$M:a$V,a$h[0]=a$u,a$h[1]=a$S,a$h[2]=a$V},a$w.add=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k.elements;a$j[0]=a$Q[0]+a$u[0],a$j[1]=a$Q[1]+a$u[1],a$j[2]=a$Q[2]+a$u[2]},a$w.subtract=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k.elements;a$j[0]=a$Q[0]-a$u[0],a$j[1]=a$Q[1]-a$u[1],a$j[2]=a$Q[2]-a$u[2]},a$w.cross=function(a$t,a$k,a$v){var a$j=a$t.elements,a$Q=a$k.elements,a$u=a$v.elements,a$S=a$j[0],a$V=a$j[1],a$J=a$j[2],a$W=a$Q[0],a$w=a$Q[1],a$M=a$Q[2];a$u[0]=a$V*a$M-a$J*a$w,a$u[1]=a$J*a$W-a$S*a$M,a$u[2]=a$S*a$w-a$V*a$W},a$w.dot=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements;return a$v[0]*a$j[0]+a$v[1]*a$j[1]+a$v[2]*a$j[2]},a$w.equals=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements;return a$yt.nearEqual(Math.abs(a$v[0]),Math.abs(a$j[0]))&&a$yt.nearEqual(Math.abs(a$v[1]),Math.abs(a$j[1]))&&a$yt.nearEqual(Math.abs(a$v[2]),Math.abs(a$j[2]))},a$w.ZERO=new a$w(0,0,0),a$w.ONE=new a$w(1,1,1),a$w.NegativeUnitX=new a$w(-1,0,0),a$w.UnitX=new a$w(1,0,0),a$w.UnitY=new a$w(0,1,0),a$w.UnitZ=new a$w(0,0,1),a$w.ForwardRH=new a$w(0,0,-1),a$w.ForwardLH=new a$w(0,0,1),a$w.Up=new a$w(0,1,0),a$w.NAN=new a$w(NaN,NaN,NaN),a$M(a$w,["_tempVector4",function(){return this._tempVector4=new a$Vk}]),a$w}(),a$Vk=function(){function a$t(a$t,a$k,a$v,a$j){this.elements=new Float32Array(4),void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=0);var a$Q=this.elements;a$Q[0]=a$t,a$Q[1]=a$k,a$Q[2]=a$v,a$Q[3]=a$j}a$E(a$t,"laya.d3.math.Vector4");var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k.fromArray=function(a$t,a$k){void 0===a$k&&(a$k=0),this.elements[0]=a$t[a$k+0],this.elements[1]=a$t[a$k+1],this.elements[2]=a$t[a$k+2],this.elements[3]=a$t[a$k+3]},a$k.cloneTo=function(a$t){var a$k=a$t.elements,a$v=this.elements;a$k[0]=a$v[0],a$k[1]=a$v[1],a$k[2]=a$v[2],a$k[3]=a$v[3]},a$k.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$k.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},a$k.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},a$A(0,a$k,"x",function(){return this.elements[0]},function(a$t){this.elements[0]=a$t}),a$A(0,a$k,"y",function(){return this.elements[1]},function(a$t){this.elements[1]=a$t}),a$A(0,a$k,"z",function(){return this.elements[2]},function(a$t){this.elements[2]=a$t}),a$A(0,a$k,"w",function(){return this.elements[3]},function(a$t){this.elements[3]=a$t}),a$t.lerp=function(a$t,a$k,a$v,a$j){var a$Q=a$j.elements,a$u=a$t.elements,a$S=a$k.elements,a$V=a$u[0],a$J=a$u[1],a$W=a$u[2],a$w=a$u[3];a$Q[0]=a$V+a$v*(a$S[0]-a$V),a$Q[1]=a$J+a$v*(a$S[1]-a$J),a$Q[2]=a$W+a$v*(a$S[2]-a$W),a$Q[3]=a$w+a$v*(a$S[3]-a$w)},a$t.transformByM4x4=function(a$t,a$k,a$v){var a$j=a$t.elements,a$Q=a$j[0],a$u=a$j[1],a$S=a$j[2],a$V=a$j[3],a$J=a$k.elements,a$W=a$v.elements;a$W[0]=a$Q*a$J[0]+a$u*a$J[4]+a$S*a$J[8]+a$V*a$J[12],a$W[1]=a$Q*a$J[1]+a$u*a$J[5]+a$S*a$J[9]+a$V*a$J[13],a$W[2]=a$Q*a$J[2]+a$u*a$J[6]+a$S*a$J[10]+a$V*a$J[14],a$W[3]=a$Q*a$J[3]+a$u*a$J[7]+a$S*a$J[11]+a$V*a$J[15]},a$t.equals=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements;return a$yt.nearEqual(Math.abs(a$v[0]),Math.abs(a$j[0]))&&a$yt.nearEqual(Math.abs(a$v[1]),Math.abs(a$j[1]))&&a$yt.nearEqual(Math.abs(a$v[2]),Math.abs(a$j[2]))&&a$yt.nearEqual(Math.abs(a$v[3]),Math.abs(a$j[3]))},a$t.normalize=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements,a$Q=a$t.length();0<a$Q&&(a$j[0]=a$v[0]*a$Q,a$j[1]=a$v[1]*a$Q,a$j[2]=a$v[2]*a$Q,a$j[3]=a$v[3]*a$Q)},a$t.add=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k.elements;a$j[0]=a$Q[0]+a$u[0],a$j[1]=a$Q[1]+a$u[1],a$j[2]=a$Q[2]+a$u[2],a$j[3]=a$Q[3]+a$u[3]},a$t.subtract=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k.elements;a$j[0]=a$Q[0]-a$u[0],a$j[1]=a$Q[1]-a$u[1],a$j[2]=a$Q[2]-a$u[2],a$j[3]=a$Q[3]-a$u[3]},a$t.multiply=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k.elements;a$j[0]=a$Q[0]*a$u[0],a$j[1]=a$Q[1]*a$u[1],a$j[2]=a$Q[2]*a$u[2],a$j[3]=a$Q[3]*a$u[3]},a$t.scale=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements;a$j[0]=a$Q[0]*a$k,a$j[1]=a$Q[1]*a$k,a$j[2]=a$Q[2]*a$k,a$j[3]=a$Q[3]*a$k},a$t.Clamp=function(a$t,a$k,a$v,a$j){var a$Q=a$t.elements,a$u=a$Q[0],a$S=a$Q[1],a$V=a$Q[2],a$J=a$Q[3],a$W=a$k.elements,a$w=a$W[0],a$M=a$W[1],a$H=a$W[2],a$E=a$W[3],a$A=a$v.elements,a$R=a$A[0],a$h=a$A[1],a$l=a$A[2],a$o=a$A[3],a$Y=a$j.elements;a$u=(a$u=a$R<a$u?a$R:a$u)<a$w?a$w:a$u,a$S=(a$S=a$h<a$S?a$h:a$S)<a$M?a$M:a$S,a$V=(a$V=a$l<a$V?a$l:a$V)<a$H?a$H:a$V,a$J=(a$J=a$o<a$J?a$o:a$J)<a$E?a$E:a$J,a$Y[0]=a$u,a$Y[1]=a$S,a$Y[2]=a$V,a$Y[3]=a$J},a$t.distanceSquared=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements,a$Q=a$v[0]-a$j[0],a$u=a$v[1]-a$j[1],a$S=a$v[2]-a$j[2],a$V=a$v[3]-a$j[3];return a$Q*a$Q+a$u*a$u+a$S*a$S+a$V*a$V},a$t.distance=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements,a$Q=a$v[0]-a$j[0],a$u=a$v[1]-a$j[1],a$S=a$v[2]-a$j[2],a$V=a$v[3]-a$j[3];return Math.sqrt(a$Q*a$Q+a$u*a$u+a$S*a$S+a$V*a$V)},a$t.dot=function(a$t,a$k){var a$v=a$t.elements,a$j=a$k.elements;return a$v[0]*a$j[0]+a$v[1]*a$j[1]+a$v[2]*a$j[2]+a$v[3]*a$j[3]},a$t.min=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k.elements;a$j[0]=Math.min(a$Q[0],a$u[0]),a$j[1]=Math.min(a$Q[1],a$u[1]),a$j[2]=Math.min(a$Q[2],a$u[2]),a$j[3]=Math.min(a$Q[3],a$u[3])},a$t.max=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k.elements;a$j[0]=Math.max(a$Q[0],a$u[0]),a$j[1]=Math.max(a$Q[1],a$u[1]),a$j[2]=Math.max(a$Q[2],a$u[2]),a$j[3]=Math.max(a$Q[3],a$u[3])},a$M(a$t,["ZERO",function(){return this.ZERO=new a$t},"ONE",function(){return this.ONE=new a$t(1,1,1,1)},"UnitX",function(){return this.UnitX=new a$t(1,0,0,0)},"UnitY",function(){return this.UnitY=new a$t(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new a$t(0,0,1,0)},"UnitW",function(){return this.UnitW=new a$t(0,0,0,1)}]),a$t}(),a$Jk=function(){function a$u(a$t,a$k,a$v,a$j){this.minDepth=0,this.maxDepth=1,this.x=a$t,this.y=a$k,this.width=a$v,this.height=a$j}a$E(a$u,"laya.d3.math.Viewport");var a$t=a$u.prototype;return a$t.project=function(a$t,a$k,a$v){a$Sk.transformV3ToV3(a$t,a$k,a$v);var a$j=a$t.elements,a$Q=a$k.elements,a$u=a$v.elements,a$S=a$j[0]*a$Q[3]+a$j[1]*a$Q[7]+a$j[2]*a$Q[11]+a$Q[15];1!==a$S&&(a$u[0]=a$u[0]/a$S,a$u[1]=a$u[1]/a$S,a$u[2]=a$u[2]/a$S),a$u[0]=.5*(a$u[0]+1)*this.width+this.x,a$u[1]=.5*(1-a$u[1])*this.height+this.y,a$u[2]=a$u[2]*(this.maxDepth-this.minDepth)+this.minDepth},a$t.unprojectFromMat=function(a$t,a$k,a$v){var a$j=a$t.elements,a$Q=a$k.elements,a$u=a$v.elements;a$u[0]=(a$j[0]-this.x)/this.width*2-1,a$u[1]=-((a$j[1]-this.y)/this.height*2-1);var a$S=(this.maxDepth-this.minDepth)/2;a$u[2]=(a$j[2]-this.minDepth-a$S)/a$S;var a$V=a$u[0]*a$Q[3]+a$u[1]*a$Q[7]+a$u[2]*a$Q[11]+a$Q[15];a$Sk.transformV3ToV3(a$v,a$k,a$v),1!==a$V&&(a$u[0]=a$u[0]/a$V,a$u[1]=a$u[1]/a$V,a$u[2]=a$u[2]/a$V)},a$t.unprojectFromWVP=function(a$t,a$k,a$v,a$j,a$Q){a$tk.multiply(a$k,a$v,a$u._tempMatrix4x4),a$j&&a$tk.multiply(a$u._tempMatrix4x4,a$j,a$u._tempMatrix4x4),a$u._tempMatrix4x4.invert(a$u._tempMatrix4x4),this.unprojectFromMat(a$t,a$u._tempMatrix4x4,a$Q)},a$M(a$u,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new a$tk}]),a$u}(),a$Wk=function(){function a$U(a$t){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=a$t,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}a$E(a$U,"laya.d3.resource.models.SubMesh");var a$t=a$U.prototype;return a$X.imps(a$t,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),a$t._getVertexBuffer=function(a$t){return void 0===a$t&&(a$t=0),0===a$t?this._vertexBuffer:null},a$t._getIndexBuffer=function(){return this._indexBuffer},a$t._getStaticBatchBakedVertexs=function(a$t,a$k){var a$v,a$j,a$Q=this._vertexBuffer,a$u=a$Q.vertexDeclaration,a$S=a$u.getVertexElementByUsage(0).offset/4,a$V=a$u.getVertexElementByUsage(3).offset/4,a$J=a$k.meshRender.lightmapScaleOffset,a$W=0,a$w=0,a$M=0,a$H=0,a$E=0,a$A=0;if(a$J)if(a$j=a$u.getVertexElementByUsage(15))a$M=a$u.vertexStride/4,a$v=0<this._vertexCount?a$Q.getData().slice(this._vertexStart*a$M,(this._vertexStart+this._vertexCount)*a$M):a$Q.getData().slice(),a$H=a$j.offset/4;else{a$M=(a$A=a$u.vertexStride/4)+2,a$v=this._vertexCount?new Float32Array(this._vertexCount*(a$Q.vertexDeclaration.vertexStride/4+2)):new Float32Array(a$Q.vertexCount*(a$Q.vertexDeclaration.vertexStride/4+2)),a$H=(a$E=a$u.getVertexElementByUsage(2).offset/4)+2;var a$R=a$Q.getData();for(a$W=0,a$w=a$R.length/a$A;a$W<a$w;a$W++){var a$h=0;a$h=0<this._vertexCount?(this._vertexStart+a$W)*a$A:a$W*a$A;var a$l=a$W*a$M,a$o=0;for(a$o=0;a$o<a$H;a$o++)a$v[a$l+a$o]=a$R[a$h+a$o];for(a$o=a$H;a$o<a$A;a$o++)a$v[a$l+a$o+2]=a$R[a$h+a$o]}}else a$M=a$u.vertexStride/4,a$v=this._vertexCount?a$Q.getData().slice(this._vertexStart*a$M,(this._vertexStart+this._vertexCount)*a$M):a$Q.getData().slice();if(a$t){var a$Y=a$t.worldMatrix,a$f=a$U._tempMatrix4x40;a$Y.invert(a$f);var a$X=a$U._tempMatrix4x41,a$F=a$k.transform.worldMatrix;a$tk.multiply(a$f,a$F,a$X)}else a$X=a$k.transform.worldMatrix;var a$d=a$U._tempQuaternion0;for(a$X.decomposeTransRotScale(a$U._tempVector30,a$d,a$U._tempVector31),a$W=0,a$w=a$v.length/a$M;a$W<a$w;a$W++){var a$m=a$W*a$M+a$S,a$Z=a$W*a$M+a$V;if(a$hk.transformVector3ArrayToVector3ArrayCoordinate(a$v,a$m,a$X,a$v,a$m),a$hk.transformVector3ArrayByQuat(a$v,a$Z,a$d,a$v,a$Z),a$J){var a$s=a$W*a$M+a$H;if(a$j)a$hk.transformLightingMapTexcoordByUV1Array(a$v,a$s,a$J,a$v,a$s);else{var a$K=a$W*a$A+a$E;a$hk.transformLightingMapTexcoordByUV0Array(a$R,a$K,a$J,a$v,a$s)}}}return a$v},a$t._getVertexBuffers=function(){return null},a$t._beforeRender=function(a$t){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},a$t._render=function(a$t){var a$k,a$v=0,a$j=a$t.renderElement;if(1<this._indexCount){var a$Q=this._boneIndicesList.length;if(1<a$Q){for(var a$u=0;a$u<a$Q;a$u++)(a$k=a$j._skinAnimationDatas||this._skinAnimationDatas)&&(a$j._shaderValue.setValue(0,a$k[a$u]),a$t._shader.uploadRenderElementUniforms(a$j._shaderValue.data)),a$N.mainContext.drawElements(4,this._subIndexBufferCount[a$u],5123,2*this._subIndexBufferStart[a$u]);a$m.drawCall+=a$Q}else(a$k=a$j._skinAnimationDatas||this._skinAnimationDatas)&&(a$j._shaderValue.setValue(0,a$k[0]),a$t._shader.uploadRenderElementUniforms(a$j._shaderValue.data)),a$N.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),a$m.drawCall++;a$v=this._indexCount}else a$v=this._indexBuffer.indexCount,(a$k=a$j._skinAnimationDatas||this._skinAnimationDatas)&&(a$j._shaderValue.setValue(0,a$k[0]),a$t._shader.uploadRenderElementUniforms(a$j._shaderValue.data)),a$N.mainContext.drawElements(4,a$v,5123,0),a$m.drawCall++;a$m.trianglesFaces+=a$v/3},a$t.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},a$t.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},a$A(0,a$t,"_vertexBufferCount",function(){return 1}),a$A(0,a$t,"triangleCount",function(){return this._indexBuffer.indexCount/3}),a$M(a$U,["_tempVector30",function(){return this._tempVector30=new a$Sk},"_tempVector31",function(){return this._tempVector31=new a$Sk},"_tempQuaternion0",function(){return this._tempQuaternion0=new a$vk},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new a$tk},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new a$tk}]),a$U}(),a$wk=function(){function a$t(a$t){this.defineCounter=0,this.defines=null,a$t?(this.defineCounter=a$t.defineCounter,this.defines=a$t.defines.slice()):(this.defineCounter=0,this.defines=[])}return a$E(a$t,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),a$t.prototype.registerDefine=function(a$t){var a$k=Math.pow(2,this.defineCounter++);return this.defines[a$k]=a$t,a$k},a$t}(),a$Mk=function(){function a$t(){}return a$E(a$t,"laya.d3.shader.ShaderInit3D"),a$t.__init__=function(){var a$t,a$k;a$mk._globalRegDefine("HIGHPRECISION",a$mk.SHADERDEFINE_HIGHPRECISION),a$mk._globalRegDefine("FOG",a$mk.SHADERDEFINE_FOG),a$mk._globalRegDefine("DIRECTIONLIGHT",a$mk.SHADERDEFINE_DIRECTIONLIGHT),a$mk._globalRegDefine("POINTLIGHT",a$mk.SHADERDEFINE_POINTLIGHT),a$mk._globalRegDefine("SPOTLIGHT",a$mk.SHADERDEFINE_SPOTLIGHT),a$mk._globalRegDefine("UV",a$mk.SHADERDEFINE_UV0),a$mk._globalRegDefine("COLOR",a$mk.SHADERDEFINE_COLOR),a$mk._globalRegDefine("UV1",a$mk.SHADERDEFINE_UV1),a$mk._globalRegDefine("CASTSHADOW",a$Ek.SHADERDEFINE_CAST_SHADOW),a$mk._globalRegDefine("SHADOWMAP_PSSM1",a$Ek.SHADERDEFINE_SHADOW_PSSM1),a$mk._globalRegDefine("SHADOWMAP_PSSM2",a$Ek.SHADERDEFINE_SHADOW_PSSM2),a$mk._globalRegDefine("SHADOWMAP_PSSM3",a$Ek.SHADERDEFINE_SHADOW_PSSM3),a$mk._globalRegDefine("SHADOWMAP_PCF_NO",a$Ek.SHADERDEFINE_SHADOW_PCF_NO),a$mk._globalRegDefine("SHADOWMAP_PCF1",a$Ek.SHADERDEFINE_SHADOW_PCF1),a$mk._globalRegDefine("SHADOWMAP_PCF2",a$Ek.SHADERDEFINE_SHADOW_PCF2),a$mk._globalRegDefine("SHADOWMAP_PCF3",a$Ek.SHADERDEFINE_SHADOW_PCF3),a$mk._globalRegDefine("DEPTHFOG",a$mk.SAHDERDEFINE_DEPTHFOG),a$pk.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),a$pk.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),a$t={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},a$k={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var a$v=a$pk.nameKey.add("SIMPLE");shaderCompile=a$mk.add(a$v,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',a$t,a$k),a$Ok.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),a$Ok.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),a$Ok.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),a$Ok.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),a$Ok.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),a$Ok.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),a$Ok.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),a$Ok.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),a$Ok.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},a$t}(),a$Hk=function(){function a$t(){this._data=null,this._data=[]}a$E(a$t,"laya.d3.shader.ValusArray");var a$k=a$t.prototype;return a$k.setValue=function(a$t,a$k){this._data[a$t]=a$k},a$A(0,a$k,"data",function(){return this._data}),a$t}(),a$Ek=function(){function a$t(){}return a$t.SHADERDEFINE_RECEIVE_SHADOW=1,a$t.SHADERDEFINE_CAST_SHADOW=512,a$t.SHADERDEFINE_SHADOW_PSSM1=1024,a$t.SHADERDEFINE_SHADOW_PSSM2=2048,a$t.SHADERDEFINE_SHADOW_PSSM3=4096,a$t.SHADERDEFINE_SHADOW_PCF_NO=8192,a$t.SHADERDEFINE_SHADOW_PCF1=16384,a$t.SHADERDEFINE_SHADOW_PCF2=32768,a$t.SHADERDEFINE_SHADOW_PCF3=65536,a$t.MAX_PSSM_COUNT=3,a$t}(),a$Ak=function(){function a$L(){}return a$E(a$L,"laya.d3.utils.Picker"),a$L.calculateCursorRay=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=a$t.elements[0],a$V=a$t.elements[1],a$J=a$L._tempVector30,a$W=a$J.elements;a$W[0]=a$S,a$W[1]=a$V,a$W[2]=a$k.minDepth;var a$w=a$L._tempVector31,a$M=a$w.elements;a$M[0]=a$S,a$M[1]=a$V,a$M[2]=a$k.maxDepth;var a$H=a$u.origin,a$E=a$L._tempVector32;a$k.unprojectFromWVP(a$J,a$v,a$j,a$Q,a$H),a$k.unprojectFromWVP(a$w,a$v,a$j,a$Q,a$E);var a$A=a$u.direction.elements;a$A[0]=a$E.x-a$H.x,a$A[1]=a$E.y-a$H.y,a$A[2]=a$E.z-a$H.z,a$Sk.normalize(a$u.direction,a$u.direction)},a$L.rayIntersectsPositionsAndIndices=function(a$t,a$k,a$v,a$j,a$Q){for(var a$u=a$v.vertexStride/4,a$S=a$v.getVertexElementByUsage(0).offset/4,a$V=Number.MAX_VALUE,a$J=-1,a$W=-1,a$w=-1,a$M=0;a$M<a$j.length;a$M+=3){var a$H=a$L._tempVector35,a$E=a$H.elements,a$A=a$j[a$M]*a$u,a$R=a$A+a$S;a$E[0]=a$k[a$R],a$E[1]=a$k[1+a$R],a$E[2]=a$k[2+a$R];var a$h=a$L._tempVector36,a$l=a$h.elements,a$o=a$j[a$M+1]*a$u,a$Y=a$o+a$S;a$l[0]=a$k[a$Y],a$l[1]=a$k[1+a$Y],a$l[2]=a$k[2+a$Y];var a$f=a$L._tempVector37,a$X=a$f.elements,a$F=a$j[a$M+2]*a$u,a$d=a$F+a$S;a$X[0]=a$k[a$d],a$X[1]=a$k[1+a$d],a$X[2]=a$k[2+a$d];var a$m=laya.d3.utils.Picker.rayIntersectsTriangle(a$t,a$H,a$h,a$f);!isNaN(a$m)&&a$m<a$V&&(a$V=a$m,a$J=a$A,a$W=a$o,a$w=a$F)}if(a$V===Number.MAX_VALUE)return a$Q.position.toDefault(),a$Q.distance=Number.MAX_VALUE,a$Q.trianglePositions[0].toDefault(),a$Q.trianglePositions[1].toDefault(),a$Q.trianglePositions[2].toDefault(),a$Q.triangleNormals[0].toDefault(),a$Q.triangleNormals[1].toDefault(),a$Q.triangleNormals[2].toDefault(),!1;a$Q.distance=a$V,a$Sk.scale(a$t.direction,a$V,a$Q.position),a$Sk.add(a$t.origin,a$Q.position,a$Q.position);var a$Z=a$Q.trianglePositions,a$s=a$Z[0],a$K=a$Z[1],a$U=a$Z[2],a$N=a$s.elements,a$a=a$K.elements,a$z=a$U.elements,a$G=a$J+a$S;a$N[0]=a$k[a$G],a$N[1]=a$k[a$G+1],a$N[2]=a$k[a$G+2];var a$c=a$W+a$S;a$a[0]=a$k[a$c],a$a[1]=a$k[a$c+1],a$a[2]=a$k[a$c+2];var a$T=a$w+a$S;a$z[0]=a$k[a$T],a$z[1]=a$k[a$T+1],a$z[2]=a$k[a$T+2];var a$p=a$v.getVertexElementByUsage(3);if(a$p){var a$O=a$p.offset/4,a$n=a$Q.triangleNormals,a$_=a$n[0],a$x=a$n[1],a$I=a$n[2],a$i=a$_.elements,a$D=a$x.elements,a$B=a$I.elements,a$b=a$J+a$O;a$i[0]=a$k[a$b],a$i[1]=a$k[a$b+1],a$i[2]=a$k[a$b+2];var a$q=a$W+a$O;a$D[0]=a$k[a$q],a$D[1]=a$k[a$q+1],a$D[2]=a$k[a$q+2];var a$C=a$w+a$O;a$B[0]=a$k[a$C],a$B[1]=a$k[a$C+1],a$B[2]=a$k[a$C+2]}return!0},a$L.rayIntersectsTriangle=function(a$t,a$k,a$v,a$j){var a$Q=a$L._tempVector30,a$u=a$L._tempVector31;a$Sk.subtract(a$v,a$k,a$Q),a$Sk.subtract(a$j,a$k,a$u);var a$S,a$V=a$L._tempVector32;if(a$Sk.cross(a$t.direction,a$u,a$V),(a$S=a$Sk.dot(a$Q,a$V))>-Number.MIN_VALUE&&a$S<Number.MIN_VALUE)return Number.NaN;var a$J,a$W=1/a$S,a$w=a$L._tempVector33;if(a$Sk.subtract(a$t.origin,a$k,a$w),a$J=a$Sk.dot(a$w,a$V),(a$J*=a$W)<0||1<a$J)return Number.NaN;var a$M,a$H,a$E=a$L._tempVector34;return a$Sk.cross(a$w,a$Q,a$E),a$M=a$Sk.dot(a$t.direction,a$E),(a$M*=a$W)<0||1<a$J+a$M?Number.NaN:(a$H=a$Sk.dot(a$u,a$E),(a$H*=a$W)<0?Number.NaN:a$H)},a$M(a$L,["_tempVector30",function(){return this._tempVector30=new a$Sk},"_tempVector31",function(){return this._tempVector31=new a$Sk},"_tempVector32",function(){return this._tempVector32=new a$Sk},"_tempVector33",function(){return this._tempVector33=new a$Sk},"_tempVector34",function(){return this._tempVector34=new a$Sk},"_tempVector35",function(){return this._tempVector35=new a$Sk},"_tempVector36",function(){return this._tempVector36=new a$Sk},"_tempVector37",function(){return this._tempVector37=new a$Sk}]),a$L}(),a$Rk=(function(){function a$t(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new a$Sk,new a$Sk,new a$Sk],this.trianglePositions.length=3,this.triangleNormals=[new a$Sk,new a$Sk,new a$Sk],this.triangleNormals.length=3,this.position=new a$Sk}a$E(a$t,"laya.d3.utils.RaycastHit"),a$t.prototype.cloneTo=function(a$t){a$t.distance=this.distance,this.trianglePositions[0].cloneTo(a$t.trianglePositions[0]),this.trianglePositions[1].cloneTo(a$t.trianglePositions[1]),this.trianglePositions[2].cloneTo(a$t.trianglePositions[2]),this.triangleNormals[0].cloneTo(a$t.triangleNormals[0]),this.triangleNormals[1].cloneTo(a$t.triangleNormals[1]),this.triangleNormals[2].cloneTo(a$t.triangleNormals[2]),this.position.cloneTo(a$t.position),a$t.sprite3D=this.sprite3D}}(),function(){function a$t(a$t,a$k){this._width=0,this._height=0,this._width=a$t,this._height=a$k}a$E(a$t,"laya.d3.utils.Size");var a$k=a$t.prototype;return a$A(0,a$k,"width",function(){return-1===this._width?a$e.clientWidth:this._width}),a$A(0,a$k,"height",function(){return-1===this._height?a$e.clientHeight:this._height}),a$A(1,a$t,"fullScreen",function(){return new a$t(-1,-1)}),a$t}()),a$hk=function(){function a$G(){}return a$E(a$G,"laya.d3.utils.Utils3D"),a$G._rotationTransformScaleSkinAnimation=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w,a$M){var a$H,a$E,a$A,a$R,a$h,a$l=a$G._tempArray16_0,a$o=a$G._tempArray16_1,a$Y=a$G._tempArray16_2,a$f=a$j+a$j,a$X=a$Q+a$Q,a$F=a$u+a$u,a$d=a$j*a$f,a$m=a$Q*a$f,a$Z=a$Q*a$X,a$s=a$u*a$f,a$K=a$u*a$X,a$U=a$u*a$F,a$N=a$S*a$f,a$a=a$S*a$X,a$z=a$S*a$F;for(a$l[15]=1,a$l[0]=1-a$Z-a$U,a$l[1]=a$m+a$z,a$l[2]=a$s-a$a,a$l[4]=a$m-a$z,a$l[5]=1-a$d-a$U,a$l[6]=a$K+a$N,a$l[8]=a$s+a$a,a$l[9]=a$K-a$N,a$l[10]=1-a$d-a$Z,a$o[15]=1,a$o[0]=a$V,a$o[5]=a$J,a$o[10]=a$W,a$H=0;a$H<4;a$H++)a$E=a$l[a$H],a$A=a$l[a$H+4],a$R=a$l[a$H+8],a$h=a$l[a$H+12],a$Y[a$H]=a$E,a$Y[a$H+4]=a$A,a$Y[a$H+8]=a$R,a$Y[a$H+12]=a$E*a$t+a$A*a$k+a$R*a$v+a$h;for(a$H=0;a$H<4;a$H++)a$E=a$Y[a$H],a$A=a$Y[a$H+4],a$R=a$Y[a$H+8],a$h=a$Y[a$H+12],a$w[a$H+a$M]=a$E*a$o[0]+a$A*a$o[1]+a$R*a$o[2]+a$h*a$o[3],a$w[a$H+a$M+4]=a$E*a$o[4]+a$A*a$o[5]+a$R*a$o[6]+a$h*a$o[7],a$w[a$H+a$M+8]=a$E*a$o[8]+a$A*a$o[9]+a$R*a$o[10]+a$h*a$o[11],a$w[a$H+a$M+12]=a$E*a$o[12]+a$A*a$o[13]+a$R*a$o[14]+a$h*a$o[15]},a$G._createNodeByJson=function(a$t,a$k,a$v,a$j){if(!a$v)switch(a$k.type){case"Sprite3D":a$v=new a$Tk;break;case"MeshSprite3D":a$v=new a$Lk;break;case"SkinnedMeshSprite3D":a$v=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":a$v=new ShuriKenParticle3D;break;case"TrailSprite3D":a$v=new TrailSprite3D;break;case"Terrain":a$v=new Terrain;break;case"Camera":a$v=new a$Ck;break;case"DirectionLight":a$v=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var a$Q=a$k.props;if(a$Q)for(var a$u in a$Q)a$v[a$u]=a$Q[a$u];var a$S=a$k.customProps;a$S&&(a$v instanceof laya.d3.core.Sprite3D?(a$v._parseBaseCustomProps(a$S),a$v._parseCustomProps(a$t,a$j,a$S,a$k),a$v._parseCustomComponent(a$t,a$j,a$k.components)):a$v._parseCustomProps(a$t,a$j,a$S,a$k));var a$V=a$k.child;if(a$V)for(var a$J=0,a$W=a$V.length;a$J<a$W;a$J++){var a$w=a$G._createNodeByJson(a$t,a$V[a$J],null,a$j);a$v.addChild(a$w)}return a$v},a$G._computeBoneAndAnimationDatasByBindPoseMatrxix=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S,a$V,a$J=0,a$W=0,a$w=a$t.length;for(a$S=0;a$S<a$w;a$J+=a$t[a$S].keyframeWidth,a$W+=16,a$S++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(a$k[a$J+0],a$k[a$J+1],a$k[a$J+2],a$k[a$J+3],a$k[a$J+4],a$k[a$J+5],a$k[a$J+6],a$k[a$J+7],a$k[a$J+8],a$k[a$J+9],a$j,a$W),0!=a$S&&(a$V=16*a$t[a$S].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(a$j,a$V,a$j,a$W,a$j,a$W));var a$M=a$v.length;for(a$S=0;a$S<a$M;a$S++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(a$j,16*a$u[a$S],a$v[a$S],a$Q,16*a$S)},a$G._computeAnimationDatasByArrayAndMatrixFast=function(a$t,a$k,a$v,a$j){for(var a$Q=0,a$u=a$t.length;a$Q<a$u;a$Q++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(a$k,16*a$j[a$Q],a$t[a$Q],a$v,16*a$Q)},a$G._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(a$t,a$k,a$v,a$j,a$Q){var a$u,a$S,a$V=0,a$J=0,a$W=a$t.length;for(a$u=0;a$u<a$W;a$V+=a$t[a$u].keyframeWidth,a$J+=16,a$u++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(a$k[a$V+7],a$k[a$V+8],a$k[a$V+9],a$k[a$V+3],a$k[a$V+4],a$k[a$V+5],a$k[a$V+6],a$k[a$V+0],a$k[a$V+1],a$k[a$V+2],a$j,a$J),0!=a$u&&(a$S=16*a$t[a$u].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(a$j,a$S,a$j,a$J,a$j,a$J));var a$w=a$v.length;for(a$u=0;a$u<a$w;a$u++){var a$M=16*a$u;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(a$j,a$M,a$v[a$u],a$Q,a$M)}},a$G._computeAnimationDatasByArrayAndMatrixFastOld=function(a$t,a$k,a$v){for(var a$j=a$t.length,a$Q=0;a$Q<a$j;a$Q++){var a$u=16*a$Q;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(a$k,a$u,a$t[a$Q],a$v,a$u)}},a$G._computeRootAnimationData=function(a$t,a$k,a$v){for(var a$j=0,a$Q=0,a$u=0,a$S=a$t.length;a$j<a$S;a$Q+=a$t[a$j].keyframeWidth,a$u+=16,a$j++)laya.d3.utils.Utils3D.createAffineTransformationArray(a$k[a$Q+0],a$k[a$Q+1],a$k[a$Q+2],a$k[a$Q+3],a$k[a$Q+4],a$k[a$Q+5],a$k[a$Q+6],a$k[a$Q+7],a$k[a$Q+8],a$k[a$Q+9],a$v,a$u)},a$G.transformVector3ArrayByQuat=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$v.elements,a$S=a$t[a$k],a$V=a$t[a$k+1],a$J=a$t[a$k+2],a$W=a$u[0],a$w=a$u[1],a$M=a$u[2],a$H=a$u[3],a$E=a$H*a$S+a$w*a$J-a$M*a$V,a$A=a$H*a$V+a$M*a$S-a$W*a$J,a$R=a$H*a$J+a$W*a$V-a$w*a$S,a$h=-a$W*a$S-a$w*a$V-a$M*a$J;a$j[a$Q]=a$E*a$H+a$h*-a$W+a$A*-a$M-a$R*-a$w,a$j[a$Q+1]=a$A*a$H+a$h*-a$w+a$R*-a$W-a$E*-a$M,a$j[a$Q+2]=a$R*a$H+a$h*-a$M+a$E*-a$w-a$A*-a$W},a$G.mulMatrixByArray=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S,a$V,a$J,a$W,a$w;if(a$Q===a$v){for(a$v=a$G._tempArray16_3,a$S=0;a$S<16;++a$S)a$v[a$S]=a$Q[a$u+a$S];a$j=0}for(a$S=0;a$S<4;a$S++)a$V=a$t[a$k+a$S],a$J=a$t[a$k+a$S+4],a$W=a$t[a$k+a$S+8],a$w=a$t[a$k+a$S+12],a$Q[a$u+a$S]=a$V*a$v[a$j+0]+a$J*a$v[a$j+1]+a$W*a$v[a$j+2]+a$w*a$v[a$j+3],a$Q[a$u+a$S+4]=a$V*a$v[a$j+4]+a$J*a$v[a$j+5]+a$W*a$v[a$j+6]+a$w*a$v[a$j+7],a$Q[a$u+a$S+8]=a$V*a$v[a$j+8]+a$J*a$v[a$j+9]+a$W*a$v[a$j+10]+a$w*a$v[a$j+11],a$Q[a$u+a$S+12]=a$V*a$v[a$j+12]+a$J*a$v[a$j+13]+a$W*a$v[a$j+14]+a$w*a$v[a$j+15]},a$G.mulMatrixByArrayFast=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S,a$V,a$J,a$W,a$w;for(a$S=0;a$S<4;a$S++)a$V=a$t[a$k+a$S],a$J=a$t[a$k+a$S+4],a$W=a$t[a$k+a$S+8],a$w=a$t[a$k+a$S+12],a$Q[a$u+a$S]=a$V*a$v[a$j+0]+a$J*a$v[a$j+1]+a$W*a$v[a$j+2]+a$w*a$v[a$j+3],a$Q[a$u+a$S+4]=a$V*a$v[a$j+4]+a$J*a$v[a$j+5]+a$W*a$v[a$j+6]+a$w*a$v[a$j+7],a$Q[a$u+a$S+8]=a$V*a$v[a$j+8]+a$J*a$v[a$j+9]+a$W*a$v[a$j+10]+a$w*a$v[a$j+11],a$Q[a$u+a$S+12]=a$V*a$v[a$j+12]+a$J*a$v[a$j+13]+a$W*a$v[a$j+14]+a$w*a$v[a$j+15]},a$G.mulMatrixByArrayAndMatrixFast=function(a$t,a$k,a$v,a$j,a$Q){var a$u,a$S,a$V,a$J,a$W,a$w=a$v.elements,a$M=a$w[0],a$H=a$w[1],a$E=a$w[2],a$A=a$w[3],a$R=a$w[4],a$h=a$w[5],a$l=a$w[6],a$o=a$w[7],a$Y=a$w[8],a$f=a$w[9],a$X=a$w[10],a$F=a$w[11],a$d=a$w[12],a$m=a$w[13],a$Z=a$w[14],a$s=a$w[15],a$K=a$k,a$U=a$k+4,a$N=a$k+8,a$a=a$k+12,a$z=a$Q,a$G=a$Q+4,a$c=a$Q+8,a$T=a$Q+12;for(a$u=0;a$u<4;a$u++)a$S=a$t[a$K+a$u],a$V=a$t[a$U+a$u],a$J=a$t[a$N+a$u],a$W=a$t[a$a+a$u],a$j[a$z+a$u]=a$S*a$M+a$V*a$H+a$J*a$E+a$W*a$A,a$j[a$G+a$u]=a$S*a$R+a$V*a$h+a$J*a$l+a$W*a$o,a$j[a$c+a$u]=a$S*a$Y+a$V*a$f+a$J*a$X+a$W*a$F,a$j[a$T+a$u]=a$S*a$d+a$V*a$m+a$J*a$Z+a$W*a$s},a$G.createAffineTransformationArray=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w,a$M){var a$H=a$j+a$j,a$E=a$Q+a$Q,a$A=a$u+a$u,a$R=a$j*a$H,a$h=a$j*a$E,a$l=a$j*a$A,a$o=a$Q*a$E,a$Y=a$Q*a$A,a$f=a$u*a$A,a$X=a$S*a$H,a$F=a$S*a$E,a$d=a$S*a$A;a$w[a$M+0]=(1-(a$o+a$f))*a$V,a$w[a$M+1]=(a$h+a$d)*a$V,a$w[a$M+2]=(a$l-a$F)*a$V,a$w[a$M+3]=0,a$w[a$M+4]=(a$h-a$d)*a$J,a$w[a$M+5]=(1-(a$R+a$f))*a$J,a$w[a$M+6]=(a$Y+a$X)*a$J,a$w[a$M+7]=0,a$w[a$M+8]=(a$l+a$F)*a$W,a$w[a$M+9]=(a$Y-a$X)*a$W,a$w[a$M+10]=(1-(a$R+a$o))*a$W,a$w[a$M+11]=0,a$w[a$M+12]=a$t,a$w[a$M+13]=a$k,a$w[a$M+14]=a$v,a$w[a$M+15]=1},a$G.transformVector3ArrayToVector3ArrayCoordinate=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$G._tempArray4_0,a$S=a$t[a$k+0],a$V=a$t[a$k+1],a$J=a$t[a$k+2],a$W=a$v.elements;a$u[0]=a$S*a$W[0]+a$V*a$W[4]+a$J*a$W[8]+a$W[12],a$u[1]=a$S*a$W[1]+a$V*a$W[5]+a$J*a$W[9]+a$W[13],a$u[2]=a$S*a$W[2]+a$V*a$W[6]+a$J*a$W[10]+a$W[14],a$u[3]=1/(a$S*a$W[3]+a$V*a$W[7]+a$J*a$W[11]+a$W[15]),a$j[a$Q+0]=a$u[0]*a$u[3],a$j[a$Q+1]=a$u[1]*a$u[3],a$j[a$Q+2]=a$u[2]*a$u[3]},a$G.transformLightingMapTexcoordByUV0Array=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$v.elements;a$j[a$Q+0]=a$t[a$k+0]*a$u[0]+a$u[2],a$j[a$Q+1]=(a$t[a$k+1]-1)*a$u[1]+a$u[3]},a$G.transformLightingMapTexcoordByUV1Array=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$v.elements;a$j[a$Q+0]=a$t[a$k+0]*a$u[0]+a$u[2],a$j[a$Q+1]=1+a$t[a$k+1]*a$u[1]+a$u[3]},a$G.getURLVerion=function(a$t){var a$k=a$t.indexOf("?");return 0<=a$k?a$t.substr(a$k):null},a$G._quaternionCreateFromYawPitchRollArray=function(a$t,a$k,a$v,a$j){var a$Q=.5*a$v,a$u=.5*a$k,a$S=.5*a$t,a$V=Math.sin(a$Q),a$J=Math.cos(a$Q),a$W=Math.sin(a$u),a$w=Math.cos(a$u),a$M=Math.sin(a$S),a$H=Math.cos(a$S);a$j[0]=a$H*a$W*a$J+a$M*a$w*a$V,a$j[1]=a$M*a$w*a$J-a$H*a$W*a$V,a$j[2]=a$H*a$w*a$V-a$M*a$W*a$J,a$j[3]=a$H*a$w*a$J+a$M*a$W*a$V},a$G._createAffineTransformationArray=function(a$t,a$k,a$v,a$j){var a$Q=a$k[0],a$u=a$k[1],a$S=a$k[2],a$V=a$k[3],a$J=a$Q+a$Q,a$W=a$u+a$u,a$w=a$S+a$S,a$M=a$Q*a$J,a$H=a$Q*a$W,a$E=a$Q*a$w,a$A=a$u*a$W,a$R=a$u*a$w,a$h=a$S*a$w,a$l=a$V*a$J,a$o=a$V*a$W,a$Y=a$V*a$w,a$f=a$v[0],a$X=a$v[1],a$F=a$v[2];a$j[0]=(1-(a$A+a$h))*a$f,a$j[1]=(a$H+a$Y)*a$f,a$j[2]=(a$E-a$o)*a$f,a$j[3]=0,a$j[4]=(a$H-a$Y)*a$X,a$j[5]=(1-(a$M+a$h))*a$X,a$j[6]=(a$R+a$l)*a$X,a$j[7]=0,a$j[8]=(a$E+a$o)*a$F,a$j[9]=(a$R-a$l)*a$F,a$j[10]=(1-(a$M+a$A))*a$F,a$j[11]=0,a$j[12]=a$t[0],a$j[13]=a$t[1],a$j[14]=a$t[2],a$j[15]=1},a$G._mulMatrixArray=function(a$t,a$k,a$v,a$j){var a$Q,a$u,a$S,a$V,a$J,a$W=a$k.elements,a$w=a$W[0],a$M=a$W[1],a$H=a$W[2],a$E=a$W[3],a$A=a$W[4],a$R=a$W[5],a$h=a$W[6],a$l=a$W[7],a$o=a$W[8],a$Y=a$W[9],a$f=a$W[10],a$X=a$W[11],a$F=a$W[12],a$d=a$W[13],a$m=a$W[14],a$Z=a$W[15],a$s=a$j,a$K=a$j+4,a$U=a$j+8,a$N=a$j+12;for(a$Q=0;a$Q<4;a$Q++)a$u=a$t[a$Q],a$S=a$t[a$Q+4],a$V=a$t[a$Q+8],a$J=a$t[a$Q+12],a$v[a$s+a$Q]=a$u*a$w+a$S*a$M+a$V*a$H+a$J*a$E,a$v[a$K+a$Q]=a$u*a$A+a$S*a$R+a$V*a$h+a$J*a$l,a$v[a$U+a$Q]=a$u*a$o+a$S*a$Y+a$V*a$f+a$J*a$X,a$v[a$N+a$Q]=a$u*a$F+a$S*a$d+a$V*a$m+a$J*a$Z},a$G.getYawPitchRoll=function(a$t,a$k){a$G.transformQuat(a$Sk.ForwardRH,a$t,a$vk.TEMPVector31),a$G.transformQuat(a$Sk.Up,a$t,a$vk.TEMPVector32);var a$v=a$vk.TEMPVector32.elements;a$G.angleTo(a$Sk.ZERO,a$vk.TEMPVector31,a$vk.TEMPVector33);var a$j=a$vk.TEMPVector33.elements;a$j[0]==Math.PI/2?(a$j[1]=a$G.arcTanAngle(a$v[2],a$v[0]),a$j[2]=0):a$j[0]==-Math.PI/2?(a$j[1]=a$G.arcTanAngle(-a$v[2],-a$v[0]),a$j[2]=0):(a$tk.createRotationY(-a$j[1],a$vk.TEMPMatrix0),a$tk.createRotationX(-a$j[0],a$vk.TEMPMatrix1),a$Sk.transformCoordinate(a$vk.TEMPVector32,a$vk.TEMPMatrix0,a$vk.TEMPVector32),a$Sk.transformCoordinate(a$vk.TEMPVector32,a$vk.TEMPMatrix1,a$vk.TEMPVector32),a$j[2]=a$G.arcTanAngle(a$v[1],-a$v[0])),a$j[1]<=-Math.PI&&(a$j[1]=Math.PI),a$j[2]<=-Math.PI&&(a$j[2]=Math.PI),a$j[1]>=Math.PI&&a$j[2]>=Math.PI&&(a$j[1]=0,a$j[2]=0,a$j[0]=Math.PI-a$j[0]),a$k[0]=a$j[1],a$k[1]=a$j[0],a$k[2]=a$j[2]},a$G.arcTanAngle=function(a$t,a$k){return 0==a$t?1==a$k?Math.PI/2:-Math.PI/2:0<a$t?Math.atan(a$k/a$t):a$t<0?0<a$k?Math.atan(a$k/a$t)+Math.PI:Math.atan(a$k/a$t)-Math.PI:0},a$G.angleTo=function(a$t,a$k,a$v){a$Sk.subtract(a$k,a$t,a$vk.TEMPVector30),a$Sk.normalize(a$vk.TEMPVector30,a$vk.TEMPVector30),a$v.elements[0]=Math.asin(a$vk.TEMPVector30.y),a$v.elements[1]=a$G.arcTanAngle(-a$vk.TEMPVector30.z,-a$vk.TEMPVector30.x)},a$G.transformQuat=function(a$t,a$k,a$v){var a$j=a$v.elements,a$Q=a$t.elements,a$u=a$k,a$S=a$Q[0],a$V=a$Q[1],a$J=a$Q[2],a$W=a$u[0],a$w=a$u[1],a$M=a$u[2],a$H=a$u[3],a$E=a$H*a$S+a$w*a$J-a$M*a$V,a$A=a$H*a$V+a$M*a$S-a$W*a$J,a$R=a$H*a$J+a$W*a$V-a$w*a$S,a$h=-a$W*a$S-a$w*a$V-a$M*a$J;a$j[0]=a$E*a$H+a$h*-a$W+a$A*-a$M-a$R*-a$w,a$j[1]=a$A*a$H+a$h*-a$w+a$R*-a$W-a$E*-a$M,a$j[2]=a$R*a$H+a$h*-a$M+a$E*-a$w-a$A*-a$W},a$G.quaterionNormalize=function(a$t,a$k){var a$v=a$t[0],a$j=a$t[1],a$Q=a$t[2],a$u=a$t[3],a$S=a$v*a$v+a$j*a$j+a$Q*a$Q+a$u*a$u;0<a$S&&(a$S=1/Math.sqrt(a$S),a$k[0]=a$v*a$S,a$k[1]=a$j*a$S,a$k[2]=a$Q*a$S,a$k[3]=a$u*a$S)},a$G.matrix4x4MultiplyFFF=function(a$t,a$k,a$v){var a$j,a$Q,a$u,a$S,a$V;if(a$v===a$k)for(a$k=new Float32Array(16),a$j=0;a$j<16;++a$j)a$k[a$j]=a$v[a$j];for(a$j=0;a$j<4;a$j++)a$Q=a$t[a$j],a$u=a$t[a$j+4],a$S=a$t[a$j+8],a$V=a$t[a$j+12],a$v[a$j]=a$Q*a$k[0]+a$u*a$k[1]+a$S*a$k[2]+a$V*a$k[3],a$v[a$j+4]=a$Q*a$k[4]+a$u*a$k[5]+a$S*a$k[6]+a$V*a$k[7],a$v[a$j+8]=a$Q*a$k[8]+a$u*a$k[9]+a$S*a$k[10]+a$V*a$k[11],a$v[a$j+12]=a$Q*a$k[12]+a$u*a$k[13]+a$S*a$k[14]+a$V*a$k[15]},a$G.matrix4x4MultiplyMFM=function(a$t,a$k,a$v){a$G.matrix4x4MultiplyFFF(a$t.elements,a$k,a$v.elements)},a$M(a$G,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new a$Sk},"_tempVector3_1",function(){return this._tempVector3_1=new a$Sk},"_tempVector3_2",function(){return this._tempVector3_2=new a$Sk},"_tempVector3_3",function(){return this._tempVector3_3=new a$Sk},"_tempVector3_4",function(){return this._tempVector3_4=new a$Sk},"_tempVector3_5",function(){return this._tempVector3_5=new a$Sk},"_tempVector3_6",function(){return this._tempVector3_6=new a$Sk},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),a$G}(),a$lk=function(){function a$a(){}return a$E(a$a,"Laya3D"),a$a._cancelLoadByUrl=function(a$t){a$X.loader.cancelLoadByUrl(a$t),a$a._innerFirstLevelLoaderManager.cancelLoadByUrl(a$t),a$a._innerSecondLevelLoaderManager.cancelLoadByUrl(a$t),a$a._innerThirdLevelLoaderManager.cancelLoadByUrl(a$t),a$a._innerFourthLevelLoaderManager.cancelLoadByUrl(a$t)},a$a._changeWebGLSize=function(a$t,a$k){a$N.onStageResize(a$t,a$k),a$e.clientWidth=a$t,a$e.clientHeight=a$k},a$a.__init__=function(){var a$t=a$k.createMap;a$t.lh=[a$Tk,"SPRITE3DHIERARCHY"],a$t.ls=[a$ck,"SPRITE3DHIERARCHY"],a$t.lm=[a$ik,"MESH"],a$t.lmat=[a$Ok,"MATERIAL"],a$t.jpg=[a$Bk,"nativeimage"],a$t.jpeg=[a$Bk,"nativeimage"],a$t.png=[a$Bk,"nativeimage"],a$t.pkm=[a$Bk,"arraybuffer"],a$t.raw=[a$xk,"arraybuffer"],a$t.mipmaps=[a$xk,"arraybuffer"],a$l.parserMap.SPRITE3DHIERARCHY=a$a._loadHierarchy,a$l.parserMap.MESH=a$a._loadMesh,a$l.parserMap.MATERIAL=a$a._loadMaterial,a$l.parserMap.TEXTURECUBE=a$a._loadTextureCube,a$l.parserMap.TERRAIN=a$a._loadTerrain,a$a._innerFirstLevelLoaderManager.on("error",null,a$a._eventLoadManagerError),a$a._innerSecondLevelLoaderManager.on("error",null,a$a._eventLoadManagerError),a$a._innerThirdLevelLoaderManager.on("error",null,a$a._eventLoadManagerError),a$a._innerFourthLevelLoaderManager.on("error",null,a$a._eventLoadManagerError)},a$a.READ_BLOCK=function(){return a$a._readData.pos+=4,!0},a$a.READ_DATA=function(){return a$a._DATA.offset=a$a._readData.getUint32(),a$a._DATA.size=a$a._readData.getUint32(),!0},a$a.READ_STRINGS=function(){var a$t=[],a$k={offset:0,size:0};a$k.offset=a$a._readData.getUint16(),a$k.size=a$a._readData.getUint16();a$a._readData.pos;a$a._readData.pos=a$k.offset+a$a._DATA.offset;for(var a$v=0;a$v<a$k.size;a$v++){var a$j=a$a._readData.readUTFString();-1===a$j.lastIndexOf(".lmat")&&-1===a$j.lastIndexOf(".lpbr")||a$t.push(a$j)}return a$t},a$a.formatRelativePath=function(a$t,a$k){var a$v;if("."===a$k.charAt(0)){for(var a$j=(a$t+a$k).split("/"),a$Q=0,a$u=a$j.length;a$Q<a$u;a$Q++)if(".."==a$j[a$Q]){var a$S=a$Q-1;0<a$S&&".."!==a$j[a$S]&&(a$j.splice(a$S,2),a$Q-=2)}a$v=a$j.join("/")}else a$v=a$t+a$k;return null!=a$U.customFormat&&(a$v=a$U.customFormat(a$v,null)),a$v},a$a._eventLoadManagerError=function(a$t){a$X.loader.event("error",a$t)},a$a._addHierarchyInnerUrls=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S=a$a.formatRelativePath(a$j,a$Q);a$v&&(a$S+=a$v),a$t.push({url:a$S,clas:a$u}),a$k[a$Q]=a$S},a$a._getSprite3DHierarchyInnerUrls=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){var a$V,a$J=0,a$W=0;switch(a$t.type){case"Scene":var a$w=a$t.customProps.lightmaps;for(a$J=0,a$W=a$w.length;a$J<a$W;a$J++){var a$M=a$w[a$J].replace(".exr",".png");a$a._addHierarchyInnerUrls(a$j,a$Q,a$u,a$S,a$M,a$Bk)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var a$H;if(a$t.instanceParams)(a$H=a$t.instanceParams.loadPath)&&a$a._addHierarchyInnerUrls(a$k,a$Q,a$u,a$S,a$H,a$ik);else{(a$H=(a$V=a$t.customProps).meshPath)&&a$a._addHierarchyInnerUrls(a$k,a$Q,a$u,a$S,a$H,a$ik);var a$E=a$V.materials;if(a$E)for(a$J=0,a$W=a$E.length;a$J<a$W;a$J++){for(var a$A=a$E[a$J],a$R=a$A.type.split("."),a$h=a$z.window,a$l=0,a$o=a$R.length;a$l<a$o;++a$l){a$h=a$h[this.clasPaths[a$l]]}if("function"!=typeof a$h)throw"_getSprite3DHierarchyInnerUrls 错误: "+a$A.type+" 不是类";a$a._addHierarchyInnerUrls(a$v,a$Q,a$u,a$S,a$A.path,a$h)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var a$Y=(a$V=a$t.customProps).meshPath;a$Y&&a$a._addHierarchyInnerUrls(a$k,a$Q,a$u,a$S,a$Y,a$ik);var a$f=a$V.material;if(a$f){a$R=a$f.type.split("."),a$h=a$z.window;for(a$l=0,a$o=a$R.length;a$l<a$o;++a$l){a$h=a$h[this.clasPaths[a$l]]}a$a._addHierarchyInnerUrls(a$v,a$Q,a$u,a$S,a$f.path,a$h)}else{var a$X=a$V.materialPath;if(a$X)a$a._addHierarchyInnerUrls(a$v,a$Q,a$u,a$S,a$X,ShurikenParticleMaterial);else{var a$F=a$V.texturePath;a$F&&a$a._addHierarchyInnerUrls(a$j,a$Q,a$u,a$S,a$F,a$Bk)}}break;case"Terrain":a$a._addHierarchyInnerUrls(a$j,a$Q,a$u,a$S,a$t.customProps.dataPath,TerrainRes)}var a$d=a$t.components;for(var a$m in a$d){var a$Z=a$d[a$m];switch(a$m){case"Animator":var a$s=a$Z.avatarPath;if(a$s)a$a._addHierarchyInnerUrls(a$j,a$Q,a$u,a$S,a$s,Avatar);else{var a$K=a$Z.avatar;a$K&&a$a._addHierarchyInnerUrls(a$j,a$Q,a$u,a$S,a$K.path,Avatar)}var a$U=a$Z.clipPaths;for(a$J=0,a$W=a$U.length;a$J<a$W;a$J++)a$a._addHierarchyInnerUrls(a$j,a$Q,a$u,a$S,a$U[a$J],AnimationClip)}}var a$N=a$t.child;for(a$J=0,a$W=a$N.length;a$J<a$W;a$J++)a$a._getSprite3DHierarchyInnerUrls(a$N[a$J],a$k,a$v,a$j,a$Q,a$u,a$S)},a$a._loadHierarchy=function(a$t){a$t.on("loaded",null,a$a._onHierarchylhLoaded,[a$t,a$t._class._getGroup()]),a$t.load(a$t.url,"json",!1,null,!0)},a$a._onHierarchylhLoaded=function(a$t,a$k,a$v){if(a$t._class.destroyed)a$t.endLoad();else{var a$j=a$t.url,a$Q=a$hk.getURLVerion(a$j),a$u=a$U.getPath(a$j),a$S=[],a$V=[],a$J=[],a$W={};a$a._getSprite3DHierarchyInnerUrls(a$v,a$S,a$V,a$J,a$W,a$Q,a$u);var a$w=a$S.length+a$V.length+a$J.length,a$M=a$w+1,a$H=1/a$M;if(a$a._onProcessChange(a$t,0,a$H,1),0<a$J.length){var a$E=a$w/a$M,a$A=a$K.create(null,a$a._onProcessChange,[a$t,a$H,a$E],!1);a$a._innerFourthLevelLoaderManager.create(a$J,a$K.create(null,a$a._onHierarchyInnerForthLevResouLoaded,[a$t,a$k,a$A,a$v,a$W,a$S,a$V,a$H+a$E*a$J.length,a$E]),a$A,null,null,1,!0,a$k)}else a$a._onHierarchyInnerForthLevResouLoaded(a$t,a$k,null,a$v,a$W,a$S,a$V,a$H,a$E)}},a$a._onHierarchyInnerForthLevResouLoaded=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){if(a$t._class.destroyed)a$t.endLoad();else if(a$v&&a$v.recover(),0<a$S.length){var a$W=a$K.create(null,a$a._onProcessChange,[a$t,a$V,a$J],!1);a$a._innerSecondLevelLoaderManager.create(a$S,a$K.create(null,a$a._onHierarchyInnerSecondLevResouLoaded,[a$t,a$k,a$W,a$j,a$Q,a$u,a$V+a$J*a$S.length,a$J]),a$v,null,null,1,!0,a$k)}else a$a._onHierarchyInnerSecondLevResouLoaded(a$t,a$k,null,a$j,a$Q,a$u,a$V,a$J)},a$a._onHierarchyInnerSecondLevResouLoaded=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V){if(a$t._class.destroyed)a$t.endLoad();else if(a$v&&a$v.recover(),0<a$u.length){var a$J=a$K.create(null,a$a._onProcessChange,[a$t,a$S,a$V],!1);a$a._innerFirstLevelLoaderManager.create(a$u,a$K.create(null,a$a._onHierarchyInnerFirstLevResouLoaded,[a$t,a$J,a$j,a$Q]),a$v,null,null,1,!0,a$k)}else a$a._onHierarchyInnerFirstLevResouLoaded(a$t,null,a$j,a$Q)},a$a._onHierarchyInnerFirstLevResouLoaded=function(a$t,a$k,a$v,a$j){a$k&&a$k.recover(),a$t.endLoad([a$v,a$j])},a$a._loadTerrain=function(a$t){a$t.on("loaded",null,a$a._onTerrainLtLoaded,[a$t,a$t._class._getGroup()]),a$t.load(a$t.url,"json",!1,null,!0)},a$a._onTerrainLtLoaded=function(a$t,a$k,a$v){if(a$t._class.destroyed)a$t.endLoad();else{var a$j,a$Q,a$u=a$t.url,a$S=a$hk.getURLVerion(a$u),a$V=a$U.getPath(a$u),a$J=[],a$W={},a$w=0,a$M=0,a$H=a$v.heightData;a$j=a$H.url,a$Q=a$a.formatRelativePath(a$V,a$j),a$S&&(a$Q+=a$S),a$j=a$W[a$j]=a$Q;var a$E=a$v.detailTexture;for(a$w=0,a$M=a$E.length;a$w<a$M;a$w++)a$J.push({url:a$E[a$w].diffuse});var a$A=a$v.normalMap;for(a$w=0,a$M=a$A.length;a$w<a$M;a$w++)a$J.push({url:a$A[a$w]});var a$R=a$v.alphaMap;for(a$w=0,a$M=a$R.length;a$w<a$M;a$w++)a$J.push({url:a$R[a$w],params:[!1,!1,6408,!0]});for(a$w=0,a$M=a$J.length;a$w<a$M;a$w++){var a$h=a$J[a$w].url;a$Q=a$a.formatRelativePath(a$V,a$h),a$S&&(a$Q+=a$S),a$J[a$w].url=a$Q,a$W[a$h]=a$Q}var a$l=a$J.length,a$o=a$l+2,a$Y=1/a$o;a$a._onProcessChange(a$t,0,a$Y,1);var a$f={heightMapLoaded:!1,texturesLoaded:!1},a$X=a$K.create(null,a$a._onProcessChange,[a$t,a$Y,a$Y],!1);a$a._innerFourthLevelLoaderManager.create(a$j,a$K.create(null,a$a._onTerrainHeightMapLoaded,[a$t,a$X,a$v,a$W,a$f]),a$X,null,[a$H.numX,a$H.numZ,a$H.bitType,a$H.value],1,!0,a$k);var a$F=a$K.create(null,a$a._onProcessChange,[a$t,2*a$Y,a$l/a$o],!1);a$a._innerFourthLevelLoaderManager.create(a$J,a$K.create(null,a$a._onTerrainTexturesLoaded,[a$t,a$F,a$v,a$W,a$f]),a$F,null,null,1,!0,a$k)}},a$a._onTerrainHeightMapLoaded=function(a$t,a$k,a$v,a$j,a$Q){a$Q.heightMapLoaded=!0,a$Q.texturesLoaded&&(a$t.endLoad([a$v,a$j]),a$k.recover())},a$a._onTerrainTexturesLoaded=function(a$t,a$k,a$v,a$j,a$Q){a$Q.texturesLoaded=!0,a$Q.heightMapLoaded&&(a$t.endLoad([a$v,a$j]),a$k.recover())},a$a._loadMesh=function(a$t){a$t.on("loaded",null,a$a._onMeshLmLoaded,[a$t,a$t._class._getGroup()]),a$t.load(a$t.url,"arraybuffer",!1,null,!0)},a$a._onMeshLmLoaded=function(a$t,a$k,a$v){if(a$t._class.destroyed)a$t.endLoad();else{var a$j,a$Q,a$u,a$S=a$t.url,a$V=a$hk.getURLVerion(a$S),a$J=a$U.getPath(a$S),a$W={},a$w=0,a$M=0;switch((a$a._readData=new a$F(a$v)).pos=0,a$a._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var a$H=a$a._readData.getUint32();a$a._readData.pos=a$a._readData.pos+4,a$M=a$a._readData.getUint16(),a$a._readData.pos=a$a._readData.pos+8*a$M;var a$E=a$a._readData.getUint32();for(a$M=a$a._readData.getUint16(),a$a._readData.pos=a$H+a$E,a$j=[],a$w=0;a$w<a$M;a$w++){var a$A=a$a._readData.readUTFString();-1!==a$A.lastIndexOf(".lmat")&&a$j.push(a$A)}break;default:for(a$a.READ_BLOCK(),a$w=0;a$w<2;a$w++){var a$R=a$a._readData.getUint16(),a$h=a$a._strings[a$R],a$l=a$a["READ_"+a$h];if(null==a$l)throw new Error("model file err,no this function:"+a$R+" "+a$h);1===a$w?a$j=a$l.call():a$l.call()}}for(a$w=0,a$u=a$j.length;a$w<a$u;a$w++){var a$o=a$j[a$w];a$Q=a$a.formatRelativePath(a$J,a$o),a$V&&(a$Q+=a$V),a$j[a$w]=a$Q,a$W[a$o]=a$Q}if(0<a$j.length){a$a._onProcessChange(a$t,0,.5,1);var a$Y=a$K.create(null,a$a._onProcessChange,[a$t,.5,.5],!1);a$a._innerSecondLevelLoaderManager.create(a$j,a$K.create(null,a$a._onMeshMateialLoaded,[a$t,a$Y,a$v,a$W]),a$Y,null,null,1,!0,a$k)}else a$t.endLoad([a$v,a$W])}},a$a._onMeshMateialLoaded=function(a$t,a$k,a$v,a$j){a$t.endLoad([a$v,a$j]),a$k.recover()},a$a._getMaterialTexturePath=function(a$t,a$k,a$v){var a$j=a$t.length-4;return a$t.indexOf(".dds")!=a$j&&a$t.indexOf(".tga")!=a$j&&a$t.indexOf(".exr")!=a$j&&a$t.indexOf(".DDS")!=a$j&&a$t.indexOf(".TGA")!=a$j&&a$t.indexOf(".EXR")!=a$j||(a$t=a$t.substr(0,a$j)+".png"),a$t=a$a.formatRelativePath(a$v,a$t),a$k&&(a$t+=a$k),a$t},a$a._loadMaterial=function(a$t){a$t.on("loaded",null,a$a._onMaterilLmatLoaded,[a$t,a$t._class._getGroup()]),a$t.load(a$t.url,"json",!1,null,!0)},a$a._onMaterilLmatLoaded=function(a$t,a$k,a$v){if(a$t._class.destroyed)a$t.endLoad();else{var a$j,a$Q=a$t.url,a$u=a$hk.getURLVerion(a$Q),a$S=a$U.getPath(a$Q),a$V=[],a$J={},a$W=a$v.customProps,a$w=a$v.version;if(a$w)switch(a$w){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var a$M=a$v.props.textures,a$H=0,a$E=a$M.length;a$H<a$E;a$H++){var a$A=a$M[a$H],a$R=a$A.path;if(a$R){var a$h=a$R.length-4;a$R.indexOf(".exr")!=a$h&&a$R.indexOf(".EXR")!=a$h||(a$R=a$R.substr(0,a$h)+".png"),a$j=a$a.formatRelativePath(a$S,a$R),a$u&&(a$j+=a$u),a$V.push({url:a$j,params:a$A.params}),a$J[a$R]=a$j}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var a$l=a$W.diffuseTexture.texture2D;if(a$l&&(a$j=a$a._getMaterialTexturePath(a$l,a$u,a$S),a$V.push(a$j),a$J[a$l]=a$j),a$W.normalTexture){var a$o=a$W.normalTexture.texture2D;a$o&&(a$j=a$a._getMaterialTexturePath(a$o,a$u,a$S),a$V.push(a$j),a$J[a$o]=a$j)}if(a$W.specularTexture){var a$Y=a$W.specularTexture.texture2D;a$Y&&(a$j=a$a._getMaterialTexturePath(a$Y,a$u,a$S),a$V.push(a$j),a$J[a$Y]=a$j)}if(a$W.emissiveTexture){var a$f=a$W.emissiveTexture.texture2D;a$f&&(a$j=a$a._getMaterialTexturePath(a$f,a$u,a$S),a$V.push(a$j),a$J[a$f]=a$j)}if(a$W.ambientTexture){var a$X=a$W.ambientTexture.texture2D;a$X&&(a$j=a$a._getMaterialTexturePath(a$X,a$u,a$S),a$V.push(a$j),a$J[a$X]=a$j)}if(a$W.reflectTexture){var a$F=a$W.reflectTexture.texture2D;a$F&&(a$j=a$a._getMaterialTexturePath(a$F,a$u,a$S),a$V.push(a$j),a$J[a$F]=a$j)}}var a$d=a$V.length,a$m=a$d+1,a$Z=1/a$m;if(a$a._onProcessChange(a$t,0,a$Z,1),0<a$d){var a$s=a$K.create(null,a$a._onProcessChange,[a$t,a$Z,a$d/a$m],!1);a$a._innerFourthLevelLoaderManager.create(a$V,a$K.create(null,a$a._onMateialTexturesLoaded,[a$t,a$s,a$v,a$J]),a$s,a$Bk,null,1,!0,a$k)}else a$a._onMateialTexturesLoaded(a$t,null,a$v,null)}},a$a._onMateialTexturesLoaded=function(a$t,a$k,a$v,a$j){a$t.endLoad([a$v,a$j]),a$k&&a$k.recover()},a$a._loadTextureCube=function(a$t){a$t.on("loaded",null,a$a._onTextureCubeLtcLoaded,[a$t]),a$t.load(a$t.url,"json",!1,null,!0)},a$a._onTextureCubeLtcLoaded=function(a$t,a$k){if(a$t._class.destroyed)a$t.endLoad();else{var a$v=a$U.getPath(a$t.url),a$j=[a$a.formatRelativePath(a$v,a$k.px),a$a.formatRelativePath(a$v,a$k.nx),a$a.formatRelativePath(a$v,a$k.py),a$a.formatRelativePath(a$v,a$k.ny),a$a.formatRelativePath(a$v,a$k.pz),a$a.formatRelativePath(a$v,a$k.nz)];a$a._onProcessChange(a$t,0,1/7,1);var a$Q=a$K.create(null,a$a._onProcessChange,[a$t,1/7,6/7],!1);a$a._innerFourthLevelLoaderManager.load(a$j,a$K.create(null,a$a._onTextureCubeImagesLoaded,[a$t,a$j,a$Q]),a$Q,"nativeimage")}},a$a._onTextureCubeImagesLoaded=function(a$t,a$k,a$v){var a$j=[];a$j.length=6;for(var a$Q=0;a$Q<6;a$Q++){var a$u=a$k[a$Q];a$j[a$Q]=a$l.getRes(a$u),a$l.clearRes(a$u)}a$t.endLoad(a$j),a$v.recover()},a$a._onProcessChange=function(a$t,a$k,a$v,a$j){(a$j=a$k+a$j*a$v)<1&&a$t.event("progress",a$j)},a$a.init=function(a$t,a$k,a$v,a$j,a$Q,a$u){if(void 0===a$v&&(a$v=!1),void 0===a$j&&(a$j=!1),void 0===a$Q&&(a$Q=!0),void 0===a$u&&(a$u=!0),a$o.update3DLoop=function(){},a$o.cancelLoadByUrl=function(a$t){a$a._cancelLoadByUrl(a$t)},a$J.isAntialias=a$v,a$J.isAlpha=a$j,a$J.premultipliedAlpha=a$Q,a$J.isStencil=a$u,!a$N.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");a$o.changeWebGLSize=a$a._changeWebGLSize,a$R.is3DMode=!0,a$X.init(a$t,a$k),a$G.__init__(),a$Mk.__init__(),a$Lk.__init__(),a$I.__init__(),a$a.__init__(),a$S.maxTextureCount=2,(a$a.debugMode||a$r.debugMode)&&(a$a._debugPhasorSprite=new a$q)},a$a.HIERARCHY="SPRITE3DHIERARCHY",a$a.MESH="MESH",a$a.MATERIAL="MATERIAL",a$a.PBRMATERIAL="PBRMTL",a$a.TEXTURECUBE="TEXTURECUBE",a$a.TERRAIN="TERRAIN",a$a._readData=null,a$a._debugPhasorSprite=null,a$a.debugMode=!1,a$M(a$a,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new a$k},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new a$k},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new a$k},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new a$k}]),a$a}(),a$ok=function(a$t){function a$Q(a$t){a$Q.__super.call(this),this._owner=a$t,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}a$E(a$Q,"laya.d3.animation.AnimationTransform3D",a$u);var a$k=a$Q.prototype;return a$k._getlocalMatrix=function(){return this._localUpdate&&(a$hk._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},a$k._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var a$t=0,a$k=this._childs.length;a$t<a$k;a$t++)this._childs[a$t]._onWorldTransform()}},a$k._setWorldMatrixAndUpdate=function(a$t){if(this._worldMatrix=a$t,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var a$k=this._getlocalMatrix(),a$v=0;a$v<16;++a$v)this._worldMatrix[a$v]=a$k[a$v];else a$hk.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},a$k._setWorldMatrixNoUpdate=function(a$t){this._worldMatrix=a$t},a$k._setWorldMatrixIgnoreUpdate=function(a$t){this._worldMatrix=a$t,this._worldUpdate=!1},a$k.getLocalPosition=function(){return this._localPosition},a$k.setLocalPosition=function(a$t){if(this._parent)this._localPosition=a$t,this._localUpdate=!0,this._onWorldTransform();else{var a$k=this._entity.owner._transform,a$v=this._entity.localPosition,a$j=a$v.elements;a$j[0]=a$t[0],a$j[1]=a$t[1],a$j[2]=a$t[2],a$k.localPosition=a$v}},a$k.getLocalRotation=function(){if(this._localQuaternionUpdate){var a$t=this._localRotationEuler;a$hk._quaternionCreateFromYawPitchRollArray(a$t[1]/a$Q._angleToRandin,a$t[0]/a$Q._angleToRandin,a$t[2]/a$Q._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},a$k.setLocalRotation=function(a$t){if(this._parent)this._localRotation=a$t,a$hk.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var a$k=this._entity.owner._transform,a$v=this._entity.localRotation,a$j=a$v.elements;a$j[0]=a$t[0],a$j[1]=a$t[1],a$j[2]=a$t[2],a$j[3]=a$t[3],a$k.localRotation=a$v}},a$k.getLocalScale=function(){return this._localScale},a$k.setLocalScale=function(a$t){if(this._parent)this._localScale=a$t,this._localUpdate=!0,this._onWorldTransform();else{var a$k=this._entity.owner._transform,a$v=this._entity.localScale,a$j=a$v.elements;a$j[0]=a$t[0],a$j[1]=a$t[1],a$j[2]=a$t[2],a$k.localScale=a$v}},a$k.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){a$hk.getYawPitchRoll(this._localRotation,a$Q._tempVector3);var a$t=a$Q._tempVector3,a$k=this._localRotationEuler;a$k[0]=a$t[1]*a$Q._angleToRandin,a$k[1]=a$t[0]*a$Q._angleToRandin,a$k[2]=a$t[2]*a$Q._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},a$k.setLocalRotationEuler=function(a$t){if(this._parent)a$hk._quaternionCreateFromYawPitchRollArray(a$t[1]/a$Q._angleToRandin,a$t[0]/a$Q._angleToRandin,a$t[2]/a$Q._angleToRandin,this._localRotation),this._localRotationEuler=a$t,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var a$k=this._entity.owner._transform,a$v=this._entity.localRotationEuler,a$j=a$v.elements;a$j[0]=a$t[0],a$j[1]=a$t[1],a$j[2]=a$t[2],a$k.localRotationEuler=a$v}},a$k.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)a$hk.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var a$t=this._getlocalMatrix(),a$k=0;a$k<16;++a$k)this._worldMatrix[a$k]=a$t[a$k];this._worldUpdate=!1}return this._worldMatrix},a$k.setParent=function(a$t){if(this._parent!==a$t){if(this._parent){var a$k=this._parent._childs,a$v=a$k.indexOf(this);a$k.splice(a$v,1)}a$t&&(a$t._childs.push(this),a$t&&this._onWorldTransform()),this._parent=a$t}},a$M(a$Q,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),a$Q}(),a$Yk=function(a$t){function a$k(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,a$k.__super.call(this),this._destroyed=!1,this._id=a$k._uniqueIDCounter,a$k._uniqueIDCounter++}a$E(a$k,"laya.d3.component.Component3D",a$u);var a$v=a$k.prototype;return a$X.imps(a$v,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),a$v._initialize=function(a$t){this._owner=a$t,this._enable=!0,this.started=!1,this._load(a$t)},a$v._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},a$v._load=function(a$t){},a$v._start=function(a$t){},a$v._update=function(a$t){},a$v._lateUpdate=function(a$t){},a$v._preRenderUpdate=function(a$t){},a$v._postRenderUpdate=function(a$t){},a$v._unload=function(a$t){this.offAll()},a$v._cloneTo=function(a$t){},a$A(0,a$v,"id",function(){return this._id}),a$A(0,a$v,"destroyed",function(){return this._destroyed}),a$A(0,a$v,"owner",function(){return this._owner}),a$A(0,a$v,"enable",function(){return this._enable},function(a$t){this._enable!==a$t&&(this._enable=a$t,this.event("enablechanged",this._enable))}),a$A(0,a$v,"isSingleton",function(){return a$k._isSingleton}),a$k._isSingleton=!0,a$k._uniqueIDCounter=1,a$k}(),a$fk=function(a$t){function a$k(){this._destroyed=!1,a$k.__super.call(this),this._destroyed=!1}a$E(a$k,"laya.d3.core.GeometryFilter",a$u);var a$v=a$k.prototype;return a$X.imps(a$v,{"laya.resource.IDestroy":!0}),a$v._destroy=function(){this.offAll(),this._destroyed=!0},a$A(0,a$v,"_isAsyncLoaded",function(){return!0}),a$A(0,a$v,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),a$A(0,a$v,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),a$A(0,a$v,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),a$A(0,a$v,"destroyed",function(){return this._destroyed}),a$k}(),a$Xk=function(a$t){function a$j(a$t){a$j.__super.call(this),this._id=++a$j._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new a$rt(new a$Sk,new a$Sk),this._boundingBoxCenter=new a$Sk,this._boundingSphere=new a$$t(new a$Sk,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=a$t,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}a$E(a$j,"laya.d3.core.render.BaseRender",a$u);var a$k=a$j.prototype;return a$X.imps(a$k,{"laya.resource.IDestroy":!0}),a$k._changeMaterialReference=function(a$t,a$k){a$t&&a$t._removeReference(),a$k._addReference()},a$k._getInstanceMaterial=function(a$t,a$k){var a$v=new a$t.constructor;return a$t.cloneTo(a$v),a$v.name=a$v.name+"(Instance)",this._materialsInstance[a$k]=!0,this._changeMaterialReference(this._materials[a$k],a$v),this._materials[a$k]=a$v},a$k._setShaderValuelightMap=function(a$t){this._setShaderValueTexture(3,a$t)},a$k._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},a$k._renderRenderableBoundBox=function(){var a$t=a$lk._debugPhasorSprite,a$k=this.boundingBox,a$v=a$j._tempBoundBoxCorners;a$k.getCorners(a$v),a$t.line(a$v[0],a$j._greenColor,a$v[1],a$j._greenColor),a$t.line(a$v[2],a$j._greenColor,a$v[3],a$j._greenColor),a$t.line(a$v[4],a$j._greenColor,a$v[5],a$j._greenColor),a$t.line(a$v[6],a$j._greenColor,a$v[7],a$j._greenColor),a$t.line(a$v[0],a$j._greenColor,a$v[3],a$j._greenColor),a$t.line(a$v[1],a$j._greenColor,a$v[2],a$j._greenColor),a$t.line(a$v[2],a$j._greenColor,a$v[6],a$j._greenColor),a$t.line(a$v[3],a$j._greenColor,a$v[7],a$j._greenColor),a$t.line(a$v[0],a$j._greenColor,a$v[4],a$j._greenColor),a$t.line(a$v[1],a$j._greenColor,a$v[5],a$j._greenColor),a$t.line(a$v[4],a$j._greenColor,a$v[7],a$j._greenColor),a$t.line(a$v[5],a$j._greenColor,a$v[6],a$j._greenColor)},a$k._calculateBoundingSphere=function(){throw"BaseRender: must override it."},a$k._calculateBoundingBox=function(){throw"BaseRender: must override it."},a$k._setShaderValueTexture=function(a$t,a$k){this._owner._shaderValues.setValue(a$t,a$k)},a$k._setShaderValueMatrix4x4=function(a$t,a$k){this._owner._shaderValues.setValue(a$t,a$k?a$k.elements:null)},a$k._setShaderValueColor=function(a$t,a$k){this._owner._shaderValues.setValue(a$t,a$k?a$k.elements:null)},a$k._setShaderValueBuffer=function(a$t,a$k){this._owner._shaderValues.setValue(a$t,a$k)},a$k._setShaderValueInt=function(a$t,a$k){this._owner._shaderValues.setValue(a$t,a$k)},a$k._setShaderValueBool=function(a$t,a$k){this._owner._shaderValues.setValue(a$t,a$k)},a$k._setShaderValueNumber=function(a$t,a$k){this._owner._shaderValues.setValue(a$t,a$k)},a$k._setShaderValueVector2=function(a$t,a$k){this._owner._shaderValues.setValue(a$t,a$k?a$k.elements:null)},a$k._addShaderDefine=function(a$t){this._owner._shaderDefineValue|=a$t},a$k._removeShaderDefine=function(a$t){this._owner._shaderDefineValue&=~a$t},a$k._renderUpdate=function(a$t){return!0},a$k._applyLightMapParams=function(){if(0<=this._lightmapIndex){var a$t=this._owner.scene;if(a$t){var a$k=a$t.getlightmaps()[this._lightmapIndex];a$k?(this._addShaderDefine(a$qk.SAHDERDEFINE_LIGHTMAP),a$k.loaded?this._setShaderValuelightMap(a$k):a$k.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(a$qk.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(a$qk.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(a$qk.SAHDERDEFINE_LIGHTMAP)},a$k._updateOctreeNode=function(){var a$t=this._treeNode;a$t&&this._octreeNodeNeedChange&&(a$t.updateObject(this),this._octreeNodeNeedChange=!1)},a$k._destroy=function(){this.offAll();var a$t=0,a$k=0;for(a$t=0,a$k=this._renderElements.length;a$t<a$k;a$t++)this._renderElements[a$t]._destroy();for(a$t=0,a$k=this._materials.length;a$t<a$k;a$t++)this._materials[a$t]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},a$A(0,a$k,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),a$A(0,a$k,"id",function(){return this._id}),a$A(0,a$k,"material",function(){var a$t=this._materials[0];if(a$t&&!this._materialsInstance[0]){var a$k=this._getInstanceMaterial(a$t,0);this.event("materialchanged",[this,0,a$k])}return this._materials[0]},function(a$t){this.sharedMaterial=a$t}),a$A(0,a$k,"sharedMaterial",function(){return this._materials[0]},function(a$t){var a$k=this._materials[0];a$k!==a$t&&(this._materials[0]=a$t,this._materialsInstance[0]=!1,this._changeMaterialReference(a$k,a$t),this.event("materialchanged",[this,0,a$t]))}),a$A(0,a$k,"lightmapIndex",function(){return this._lightmapIndex},function(a$t){this._lightmapIndex=a$t,this._applyLightMapParams()}),a$A(0,a$k,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(a$t){this._lightmapScaleOffset=a$t,this._setShaderValueColor(2,a$t),this._addShaderDefine(a$qk.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),a$A(0,a$k,"enable",function(){return this._enable},function(a$t){this._enable=a$t,this.event("enablechanged",[this,a$t])}),a$A(0,a$k,"materials",function(){for(var a$t=0,a$k=this._materials.length;a$t<a$k;a$t++)if(!this._materialsInstance[a$t]){var a$v=this._getInstanceMaterial(this._materials[a$t],a$t);this.event("materialchanged",[this,a$t,a$v])}return this._materials.slice()},function(a$t){this.sharedMaterials=a$t}),a$A(0,a$k,"sharedMaterials",function(){return this._materials.slice()},function(a$t){if(!a$t)throw new Error("MeshRender: shadredMaterials value can't be null.");var a$k=a$t.length;this._materialsInstance.length=a$k;for(var a$v=0;a$v<a$k;a$v++){var a$j=this._materials[a$v];a$j!==a$t[a$v]&&(this._materialsInstance[a$v]=!1,this._changeMaterialReference(a$j,a$t[a$v]),this.event("materialchanged",[this,a$v,a$t[a$v]]))}this._materials=a$t}),a$A(0,a$k,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),a$A(0,a$k,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var a$t=this.boundingBox;a$Sk.add(a$t.min,a$t.max,this._boundingBoxCenter),a$Sk.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),a$A(0,a$k,"receiveShadow",function(){return this._receiveShadow},function(a$t){this._receiveShadow!==a$t&&((this._receiveShadow=a$t)?this._addShaderDefine(a$Ek.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(a$Ek.SHADERDEFINE_RECEIVE_SHADOW))}),a$A(0,a$k,"destroyed",function(){return this._destroyed}),a$j._uniqueIDCounter=0,a$M(a$j,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk,new a$Sk]},"_greenColor",function(){return this._greenColor=new a$Vk(0,1,0,1)}]),a$j}(),a$Fk=function(a$t){function a$V(a$t){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,a$V.__super.call(this),this._localPosition=new a$Sk,this._localRotation=new a$vk(0,0,0,1),this._localScale=new a$Sk(1,1,1),this._localRotationEuler=new a$Sk,this._localMatrix=new a$tk,this._position=new a$Sk,this._rotation=new a$vk(0,0,0,1),this._scale=new a$Sk(1,1,1),this._worldMatrix=new a$tk,this._forward=new a$Sk,this._up=new a$Sk,this._right=new a$Sk,this._owner=a$t,this._childs=[]}a$E(a$V,"laya.d3.core.Transform3D",a$u);var a$k=a$V.prototype;return a$k._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)a$tk.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var a$t=a$V._tempVector30;a$Sk.multiply(this.pivot,this._localScale,a$t);var a$k=a$V._tempVector31;a$Sk.subtract(a$t,this.pivot,a$k);var a$v=a$V._tempVector32,a$j=this.localRotation;a$Sk.transformQuat(a$t,a$j,a$v),a$Sk.subtract(a$v,a$t,a$v);var a$Q=a$V._tempVector33;a$Sk.subtract(this._localPosition,a$k,a$Q),a$Sk.subtract(a$Q,a$v,a$Q),a$tk.createAffineTransformation(a$Q,a$j,this._localScale,this._localMatrix)}},a$k._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var a$t=0,a$k=this._childs.length;a$t<a$k;a$t++)this._childs[a$t]._onWorldPositionRotationTransform()}},a$k._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var a$t=0,a$k=this._childs.length;a$t<a$k;a$t++)this._childs[a$t]._onWorldPositionScaleTransform()}},a$k._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var a$t=0,a$k=this._childs.length;a$t<a$k;a$t++)this._childs[a$t]._onWorldPositionTransform()}},a$k._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var a$t=0,a$k=this._childs.length;a$t<a$k;a$t++)this._childs[a$t]._onWorldPositionRotationTransform()}},a$k._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var a$t=0,a$k=this._childs.length;a$t<a$k;a$t++)this._childs[a$t]._onWorldPositionScaleTransform()}},a$k._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var a$t=0,a$k=this._childs.length;a$t<a$k;a$t++)this._childs[a$t]._onWorldTransform()}},a$k.translate=function(a$t,a$k){void 0===a$k&&(a$k=!0),a$k?(a$tk.createFromQuaternion(this.localRotation,a$V._tempMatrix0),a$Sk.transformCoordinate(a$t,a$V._tempMatrix0,a$V._tempVector30),a$Sk.add(this.localPosition,a$V._tempVector30,this._localPosition),this.localPosition=this._localPosition):(a$Sk.add(this.position,a$t,this._position),this.position=this._position)},a$k.rotate=function(a$t,a$k,a$v){var a$j;void 0===a$k&&(a$k=!0),void 0===a$v&&(a$v=!0),a$j=a$v?a$t:(a$Sk.scale(a$t,Math.PI/180,a$V._tempVector30),a$V._tempVector30),a$vk.createFromYawPitchRoll(a$j.y,a$j.x,a$j.z,a$V._tempQuaternion0),a$k?(a$vk.multiply(this._localRotation,a$V._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(a$vk.multiply(a$V._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},a$k.lookAt=function(a$t,a$k,a$v){void 0===a$v&&(a$v=!1);var a$j,a$Q=a$t.elements;if(a$v){if(a$j=this._localPosition.elements,Math.abs(a$j[0]-a$Q[0])<a$yt.zeroTolerance&&Math.abs(a$j[1]-a$Q[1])<a$yt.zeroTolerance&&Math.abs(a$j[2]-a$Q[2])<a$yt.zeroTolerance)return;a$vk.lookAt(this._localPosition,a$t,a$k,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var a$u=this.position;if(a$j=a$u.elements,Math.abs(a$j[0]-a$Q[0])<a$yt.zeroTolerance&&Math.abs(a$j[1]-a$Q[1])<a$yt.zeroTolerance&&Math.abs(a$j[2]-a$Q[2])<a$yt.zeroTolerance)return;a$vk.lookAt(a$u,a$t,a$k,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},a$A(0,a$k,"_isFrontFaceInvert",function(){var a$t=this.scale,a$k=a$t.x<0;return a$t.y<0&&(a$k=!a$k),a$t.z<0&&(a$k=!a$k),a$k}),a$A(0,a$k,"owner",function(){return this._owner}),a$A(0,a$k,"localRotation",function(){if(this._localQuaternionUpdate){var a$t=this._localRotationEuler.elements;a$vk.createFromYawPitchRoll(a$t[1]/a$V._angleToRandin,a$t[0]/a$V._angleToRandin,a$t[2]/a$V._angleToRandin,this._localRotation)}return this._localRotation},function(a$t){this._localRotation=a$t,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),a$A(0,a$k,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?a$tk.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(a$t){null===this._parent?a$t.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),a$tk.multiply(this._localMatrix,a$t,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=a$t,this._worldUpdate=!1}),a$A(0,a$k,"worldNeedUpdate",function(){return this._worldUpdate}),a$A(0,a$k,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(a$t){this._localMatrix=a$t,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),a$A(0,a$k,"dummy",function(){return this._dummy},function(a$t){this._dummy!==a$t&&(this._dummy&&(this._dummy._entity=null),a$t&&(a$t._entity=this),this._dummy=a$t)}),a$A(0,a$k,"localPosition",function(){return this._localPosition},function(a$t){this._localPosition=a$t,this._localUpdate=!0,this._onWorldPositionTransform()}),a$A(0,a$k,"position",function(){if(this._positionUpdate){if(null!=this._parent){var a$t=this._parent.position;a$Sk.multiply(this._localPosition,this._parent.scale,a$V._tempVector30),a$Sk.transformQuat(a$V._tempVector30,this._parent.rotation,a$V._tempVector30),a$Sk.add(a$t,a$V._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(a$t){if(null!=this._parent){a$Sk.subtract(a$t,this._parent.position,this._localPosition);var a$k=this._parent.scale.elements,a$v=a$k[0],a$j=a$k[1],a$Q=a$k[2];if(1!==a$v||1!==a$j||1!==a$Q){var a$u=a$V._tempVector30,a$S=a$u.elements;a$S[0]=1/a$v,a$S[1]=1/a$j,a$S[2]=1/a$Q,a$Sk.multiply(this._localPosition,a$u,this._localPosition)}this._parent.rotation.invert(a$V._tempQuaternion0),a$Sk.transformQuat(this._localPosition,a$V._tempQuaternion0,this._localPosition)}else a$t.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=a$t,this._positionUpdate=!1}),a$A(0,a$k,"localScale",function(){return this._localScale},function(a$t){this._localScale=a$t,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),a$A(0,a$k,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(a$V._tempVector30);var a$t=a$V._tempVector30.elements,a$k=this._localRotationEuler.elements;a$k[0]=a$t[1]*a$V._angleToRandin,a$k[1]=a$t[0]*a$V._angleToRandin,a$k[2]=a$t[2]*a$V._angleToRandin}return this._localRotationEuler},function(a$t){this._localRotationEuler=a$t,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),a$A(0,a$k,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?a$vk.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(a$t){null!=this._parent?(this._parent.rotation.invert(a$V._tempQuaternion0),a$vk.multiply(a$t,a$V._tempQuaternion0,this._localRotation)):a$t.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=a$t,this._rotationUpdate=!1}),a$A(0,a$k,"scale",function(){return this._scaleUpdate&&(null!==this._parent?a$Sk.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(a$t){if(null!==this._parent){var a$k=this._parent.scale.elements,a$v=a$V._tempVector30.elements;a$v[0]=1/a$k[0],a$v[1]=1/a$k[1],a$v[2]=1/a$k[2],a$Sk.multiply(a$t,a$V._tempVector30,this._localScale)}else a$t.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=a$t,this._scaleUpdate=!1}),a$A(0,a$k,"rotationEuler",null,function(a$t){a$vk.createFromYawPitchRoll(a$t.y,a$t.x,a$t.z,this._rotation),this.rotation=this._rotation}),a$A(0,a$k,"forward",function(){var a$t=this.worldMatrix.elements;return this._forward.elements[0]=-a$t[8],this._forward.elements[1]=-a$t[9],this._forward.elements[2]=-a$t[10],this._forward}),a$A(0,a$k,"up",function(){var a$t=this.worldMatrix.elements;return this._up.elements[0]=a$t[4],this._up.elements[1]=a$t[5],this._up.elements[2]=a$t[6],this._up}),a$A(0,a$k,"right",function(){var a$t=this.worldMatrix.elements;return this._right.elements[0]=a$t[0],this._right.elements[1]=a$t[1],this._right.elements[2]=a$t[2],this._right}),a$A(0,a$k,"parent",function(){return this._parent},function(a$t){if(this._parent!==a$t){if(this._parent){var a$k=this._parent._childs,a$v=a$k.indexOf(this);a$k.splice(a$v,1)}a$t&&(a$t._childs.push(this),a$t&&this._onWorldTransform()),this._parent=a$t}}),a$M(a$V,["_tempVector30",function(){return this._tempVector30=new a$Sk},"_tempVector31",function(){return this._tempVector31=new a$Sk},"_tempVector32",function(){return this._tempVector32=new a$Sk},"_tempVector33",function(){return this._tempVector33=new a$Sk},"_tempQuaternion0",function(){return this._tempQuaternion0=new a$vk},"_tempMatrix0",function(){return this._tempMatrix0=new a$tk},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),a$V}(),a$dk=(function(a$t){function a$k(){this._rotation=0,this._matNeedUpdte=!1,a$k.__super.call(this),this._matrix=new a$tk,this._offset=new a$uk,this._tiling=new a$uk(1,1)}a$E(a$k,"laya.d3.core.TransformUV",a$u);var a$v=a$k.prototype;a$X.imps(a$v,{"laya.d3.core.IClone":!0}),a$v._updateMatrix=function(){a$k._tempOffsetV3.elements[0]=this._offset.x,a$k._tempOffsetV3.elements[1]=this._offset.y,a$vk.createFromYawPitchRoll(0,0,this._rotation,a$k._tempRotationQua),a$k._tempTitlingV3.elements[0]=this._tiling.x,a$k._tempTitlingV3.elements[1]=this._tiling.y,a$tk.createAffineTransformation(a$k._tempOffsetV3,a$k._tempRotationQua,a$k._tempTitlingV3,this._matrix)},a$v.cloneTo=function(a$t){a$t._matrix=this._matrix.clone(),a$t._offset=this._offset.clone(),a$t._rotation=this._rotation,a$t._tiling=this._tiling.clone()},a$v.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$v,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),a$A(0,a$v,"tiling",function(){return this._tiling},function(a$t){this._tiling=a$t,this._matNeedUpdte=!0}),a$A(0,a$v,"offset",function(){return this._offset},function(a$t){this._offset=a$t,this._matNeedUpdte=!0}),a$A(0,a$v,"rotation",function(){return this._rotation},function(a$t){this._rotation=a$t,this._matNeedUpdte=!0}),a$M(a$k,["_tempOffsetV3",function(){return this._tempOffsetV3=new a$Sk(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new a$vk},"_tempTitlingV3",function(){return this._tempTitlingV3=new a$Sk(1,1,1)}])}(),function(a$v){function a$t(){this.x=NaN,this.y=NaN,this.z=NaN,a$t.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}a$E(a$t,"laya.d3.core.particleShuriKen.module.shape.BoxShape",a$v);var a$k=a$t.prototype;a$k._getShapeBoundBox=function(a$t){var a$k=a$t.min.elements;a$k[0]=.5*-this.x,a$k[1]=.5*-this.y,a$k[2]=.5*-this.z;var a$v=a$t.max.elements;a$v[0]=.5*this.x,a$v[1]=.5*this.y,a$v[2]=.5*this.z},a$k._getSpeedBoundBox=function(a$t){var a$k=a$t.min.elements;a$k[0]=0,a$k[1]=0,a$k[2]=0;var a$v=a$t.max.elements;a$v[0]=0,a$v[1]=1,a$v[2]=0},a$k.generatePositionAndDirection=function(a$t,a$k,a$v,a$j){var a$Q=a$t.elements,a$u=a$k.elements;a$v?(a$v.seed=a$j[16],a$B._randomPointInsideHalfUnitBox(a$t,a$v),a$j[16]=a$v.seed):a$B._randomPointInsideHalfUnitBox(a$t),a$Q[0]=this.x*a$Q[0],a$Q[1]=this.y*a$Q[1],a$Q[2]=this.z*a$Q[2],this.randomDirection?a$v?(a$v.seed=a$j[17],a$B._randomPointUnitSphere(a$k,a$v),a$j[17]=a$v.seed):a$B._randomPointUnitSphere(a$k):(a$u[0]=0,a$u[1]=0,a$u[2]=1)},a$k.cloneTo=function(a$t){a$v.prototype.cloneTo.call(this,a$t);var a$k=a$t;a$k.x=this.x,a$k.y=this.y,a$k.z=this.z,a$k.randomDirection=this.randomDirection}}(a$_),function(a$v){function a$S(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,a$S.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}a$E(a$S,"laya.d3.core.particleShuriKen.module.shape.CircleShape",a$v);var a$t=a$S.prototype;a$t._getShapeBoundBox=function(a$t){var a$k=a$t.min.elements;a$k[0]=a$k[2]=-this.radius,a$k[1]=0;var a$v=a$t.max.elements;a$v[0]=a$v[2]=this.radius,a$v[1]=0},a$t._getSpeedBoundBox=function(a$t){var a$k=a$t.min.elements;a$k[0]=a$k[1]=-1,a$k[2]=0;var a$v=a$t.max.elements;a$v[0]=a$v[1]=1,a$v[2]=0},a$t.generatePositionAndDirection=function(a$t,a$k,a$v,a$j){var a$Q=a$t.elements,a$u=a$S._tempPositionPoint.elements;a$v?(a$v.seed=a$j[16],this.emitFromEdge?a$B._randomPointUnitArcCircle(this.arc,a$S._tempPositionPoint,a$v):a$B._randomPointInsideUnitArcCircle(this.arc,a$S._tempPositionPoint,a$v),a$j[16]=a$v.seed):this.emitFromEdge?a$B._randomPointUnitArcCircle(this.arc,a$S._tempPositionPoint):a$B._randomPointInsideUnitArcCircle(this.arc,a$S._tempPositionPoint),a$Q[0]=-a$u[0],a$Q[1]=a$u[1],a$Q[2]=0,a$Sk.scale(a$t,this.radius,a$t),this.randomDirection?a$v?(a$v.seed=a$j[17],a$B._randomPointUnitSphere(a$k,a$v),a$j[17]=a$v.seed):a$B._randomPointUnitSphere(a$k):a$t.cloneTo(a$k)},a$t.cloneTo=function(a$t){a$v.prototype.cloneTo.call(this,a$t);var a$k=a$t;a$k.radius=this.radius,a$k.arc=this.arc,a$k.emitFromEdge=this.emitFromEdge,a$k.randomDirection=this.randomDirection},a$M(a$S,["_tempPositionPoint",function(){return this._tempPositionPoint=new a$uk}])}(a$_),function(a$v){function a$H(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,a$H.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}a$E(a$H,"laya.d3.core.particleShuriKen.module.shape.ConeShape",a$v);var a$t=a$H.prototype;a$t._getShapeBoundBox=function(a$t){var a$k=this.radius+this.length*Math.sin(this.angle),a$v=this.length*Math.cos(this.angle),a$j=a$t.min.elements;a$j[0]=a$j[1]=-a$k,a$j[2]=0;var a$Q=a$t.max.elements;a$Q[0]=a$Q[1]=a$k,a$Q[2]=a$v},a$t._getSpeedBoundBox=function(a$t){var a$k=Math.sin(this.angle),a$v=a$t.min.elements;a$v[0]=a$v[1]=-a$k,a$v[2]=0;var a$j=a$t.max.elements;a$j[0]=a$v[1]=a$k,a$j[2]=1},a$t.generatePositionAndDirection=function(a$t,a$k,a$v,a$j){var a$Q,a$u=a$t.elements,a$S=a$k.elements,a$V=a$H._tempPositionPoint.elements,a$J=NaN,a$W=NaN,a$w=Math.cos(this.angle),a$M=Math.sin(this.angle);switch(this.emitType){case 0:a$v?(a$v.seed=a$j[16],a$B._randomPointInsideUnitCircle(a$H._tempPositionPoint,a$v),a$j[16]=a$v.seed):a$B._randomPointInsideUnitCircle(a$H._tempPositionPoint),a$J=a$V[0],a$W=a$V[1],a$u[0]=a$J*this.radius,a$u[1]=a$W*this.radius,a$u[2]=0,this.randomDirection?(a$v?(a$v.seed=a$j[17],a$B._randomPointInsideUnitCircle(a$H._tempDirectionPoint,a$v),a$j[17]=a$v.seed):a$B._randomPointInsideUnitCircle(a$H._tempDirectionPoint),a$Q=a$H._tempDirectionPoint.elements,a$S[0]=a$Q[0]*a$M,a$S[1]=a$Q[1]*a$M):(a$S[0]=a$J*a$M,a$S[1]=a$W*a$M),a$S[2]=a$w;break;case 1:a$v?(a$v.seed=a$j[16],a$B._randomPointUnitCircle(a$H._tempPositionPoint,a$v),a$j[16]=a$v.seed):a$B._randomPointUnitCircle(a$H._tempPositionPoint),a$J=a$V[0],a$W=a$V[1],a$u[0]=a$J*this.radius,a$u[1]=a$W*this.radius,a$u[2]=0,this.randomDirection?(a$v?(a$v.seed=a$j[17],a$B._randomPointInsideUnitCircle(a$H._tempDirectionPoint,a$v),a$j[17]=a$v.seed):a$B._randomPointInsideUnitCircle(a$H._tempDirectionPoint),a$Q=a$H._tempDirectionPoint.elements,a$S[0]=a$Q[0]*a$M,a$S[1]=a$Q[1]*a$M):(a$S[0]=a$J*a$M,a$S[1]=a$W*a$M),a$S[2]=a$w;break;case 2:a$v?(a$v.seed=a$j[16],a$B._randomPointInsideUnitCircle(a$H._tempPositionPoint,a$v)):a$B._randomPointInsideUnitCircle(a$H._tempPositionPoint),a$J=a$V[0],a$W=a$V[1],a$u[0]=a$J*this.radius,a$u[1]=a$W*this.radius,a$S[a$u[2]=0]=a$J*a$M,a$S[1]=a$W*a$M,a$S[2]=a$w,a$Sk.normalize(a$k,a$k),a$v?(a$Sk.scale(a$k,this.length*a$v.getFloat(),a$k),a$j[16]=a$v.seed):a$Sk.scale(a$k,this.length*Math.random(),a$k),a$Sk.add(a$t,a$k,a$t),this.randomDirection&&(a$v?(a$v.seed=a$j[17],a$B._randomPointUnitSphere(a$k,a$v),a$j[17]=a$v.seed):a$B._randomPointUnitSphere(a$k));break;case 3:a$v?(a$v.seed=a$j[16],a$B._randomPointUnitCircle(a$H._tempPositionPoint,a$v)):a$B._randomPointUnitCircle(a$H._tempPositionPoint),a$J=a$V[0],a$W=a$V[1],a$u[0]=a$J*this.radius,a$u[1]=a$W*this.radius,a$S[a$u[2]=0]=a$J*a$M,a$S[1]=a$W*a$M,a$S[2]=a$w,a$Sk.normalize(a$k,a$k),a$v?(a$Sk.scale(a$k,this.length*a$v.getFloat(),a$k),a$j[16]=a$v.seed):a$Sk.scale(a$k,this.length*Math.random(),a$k),a$Sk.add(a$t,a$k,a$t),this.randomDirection&&(a$v?(a$v.seed=a$j[17],a$B._randomPointUnitSphere(a$k,a$v),a$j[17]=a$v.seed):a$B._randomPointUnitSphere(a$k));break;default:throw new Error("ConeShape:emitType is invalid.")}},a$t.cloneTo=function(a$t){a$v.prototype.cloneTo.call(this,a$t);var a$k=a$t;a$k.angle=this.angle,a$k.radius=this.radius,a$k.length=this.length,a$k.emitType=this.emitType,a$k.randomDirection=this.randomDirection},a$M(a$H,["_tempPositionPoint",function(){return this._tempPositionPoint=new a$uk},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new a$uk}])}(a$_),function(a$v){function a$t(){this.radius=NaN,this.emitFromShell=!1,a$t.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}a$E(a$t,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",a$v);var a$k=a$t.prototype;a$k._getShapeBoundBox=function(a$t){var a$k=a$t.min.elements;a$k[0]=a$k[1]=a$k[2]=-this.radius;var a$v=a$t.max.elements;a$v[0]=a$v[1]=this.radius,a$v[2]=0},a$k._getSpeedBoundBox=function(a$t){var a$k=a$t.min.elements;a$k[0]=a$k[1]=-1,a$k[2]=0;var a$v=a$t.max.elements;a$v[0]=a$v[1]=a$v[2]=1},a$k.generatePositionAndDirection=function(a$t,a$k,a$v,a$j){var a$Q=a$t.elements;a$v?(a$v.seed=a$j[16],this.emitFromShell?a$B._randomPointUnitSphere(a$t,a$v):a$B._randomPointInsideUnitSphere(a$t,a$v),a$j[16]=a$v.seed):this.emitFromShell?a$B._randomPointUnitSphere(a$t):a$B._randomPointInsideUnitSphere(a$t),a$Sk.scale(a$t,this.radius,a$t);var a$u=a$Q[2];a$u<0&&(a$Q[2]=-1*a$u),this.randomDirection?a$v?(a$v.seed=a$j[17],a$B._randomPointUnitSphere(a$k,a$v),a$j[17]=a$v.seed):a$B._randomPointUnitSphere(a$k):a$t.cloneTo(a$k)},a$k.cloneTo=function(a$t){a$v.prototype.cloneTo.call(this,a$t);var a$k=a$t;a$k.radius=this.radius,a$k.emitFromShell=this.emitFromShell,a$k.randomDirection=this.randomDirection}}(a$_),function(a$v){function a$t(){this.radius=NaN,this.emitFromShell=!1,a$t.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}a$E(a$t,"laya.d3.core.particleShuriKen.module.shape.SphereShape",a$v);var a$k=a$t.prototype;a$k._getShapeBoundBox=function(a$t){var a$k=a$t.min.elements;a$k[0]=a$k[1]=a$k[2]=-this.radius;var a$v=a$t.max.elements;a$v[0]=a$v[1]=a$v[2]=this.radius},a$k._getSpeedBoundBox=function(a$t){var a$k=a$t.min.elements;a$k[0]=a$k[1]=a$k[2]=-1;var a$v=a$t.max.elements;a$v[0]=a$v[1]=a$v[2]=1},a$k.generatePositionAndDirection=function(a$t,a$k,a$v,a$j){a$v?(a$v.seed=a$j[16],this.emitFromShell?a$B._randomPointUnitSphere(a$t,a$v):a$B._randomPointInsideUnitSphere(a$t,a$v),a$j[16]=a$v.seed):this.emitFromShell?a$B._randomPointUnitSphere(a$t):a$B._randomPointInsideUnitSphere(a$t),a$Sk.scale(a$t,this.radius,a$t),this.randomDirection?a$v?(a$v.seed=a$j[17],a$B._randomPointUnitSphere(a$k,a$v),a$j[17]=a$v.seed):a$B._randomPointUnitSphere(a$k):a$t.cloneTo(a$k)},a$k.cloneTo=function(a$t){a$v.prototype.cloneTo.call(this,a$t);var a$k=a$t;a$k.radius=this.radius,a$k.emitFromShell=this.emitFromShell,a$k.randomDirection=this.randomDirection}}(a$_),function(a$t){function a$k(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,a$k.__super.call(this)}return a$E(a$k,"laya.d3.core.render.SubMeshRenderElement",a$C),a$k}()),a$mk=function(a$t){function a$h(a$t,a$k,a$v,a$j,a$Q,a$u){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=a$t,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[a$Ek.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[a$qk.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[a$qk.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[a$Uk.SHADERDEFINE_ALPHATEST]="ALPHATEST";a$h.__super.call(this,a$t,a$k,a$v,null,{}),this._attributeMap=a$j;var a$S;for(a$S in a$Q){var a$V=a$Q[a$S];switch(a$V[1]){case 0:this._renderElementUniformMap[a$S]=a$V[0];break;case 1:this._materialUniformMap[a$S]=a$V[0];break;case 2:this._spriteUniformMap[a$S]=a$V[0];break;case 3:this._cameraUniformMap[a$S]=a$V[0];break;case 4:this._sceneUniformMap[a$S]=a$V[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}a$E(a$h,"laya.d3.shader.ShaderCompile3D",a$Y);var a$k=a$h.prototype;return a$k._definesToNameDic=function(a$t,a$k){for(var a$v={},a$j=1,a$Q=0;a$Q<32&&!(a$t<(a$j=1<<a$Q));a$Q++)if(a$t&a$j){var a$u=a$k[a$j];a$u&&(a$v[a$u]="")}return a$v},a$k.withCompile=function(a$t,a$k,a$v,a$j){var a$Q,a$u,a$S;if(a$u=this.sharders[a$t])if(a$S=a$u[a$k]){if(a$Q=a$S[a$v])return a$Q}else a$S=a$u[a$k]=[];else a$S=(a$u=this.sharders[a$t]=[])[a$k]=[];var a$V,a$J=this._definesToNameDic(a$t,a$h._globalInt2name),a$W=this._definesToNameDic(a$k,this._spriteInt2name),a$w=this._definesToNameDic(a$v,this._materialInt2name),a$M={},a$H="";if(a$J)for(a$V in a$J)a$H+="#define "+a$V+"\n",a$M[a$V]=!0;if(a$W)for(a$V in a$W)a$H+="#define "+a$V+"\n",a$M[a$V]=!0;if(a$w)for(a$V in a$w)a$H+="#define "+a$V+"\n",a$M[a$V]=!0;var a$E=a$pk.nameKey.getName(this._name)+" compile ("+a$t+","+a$k+","+a$v+")",a$A=this._VS.toscript(a$M,[]),a$R=this._PS.toscript(a$M,[]);a$z.now();if(a$Q=a$pk.create(a$H+a$A.join("\n"),a$H+a$R.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,a$j,a$E),a$S[a$v]=a$Q,laya.d3.shader.ShaderCompile3D.debugMode)a$z.now();return a$Q},a$k.precompileShaderWithShaderDefine=function(a$t,a$k,a$v){this.withCompile(a$t,a$k,a$v,!0)},a$k.addMaterialDefines=function(a$t){var a$k=a$t.defines;for(var a$v in a$k){var a$j=a$k[a$v],a$Q=parseInt(a$v);this._materialInt2name[a$Q]=a$j,this._materialName2Int[a$j]=a$Q}},a$k.addSpriteDefines=function(a$t){var a$k=a$t.defines;for(var a$v in a$k){var a$j=a$k[a$v],a$Q=parseInt(a$v);this._spriteInt2name[a$Q]=a$j,this._spriteName2Int[a$j]=a$Q}},a$k.getMaterialDefineByName=function(a$t){return this._materialName2Int[a$t]},a$k.registerMaterialDefine=function(a$t){var a$k=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[a$k]=a$t,this._materialName2Int[a$t]=a$k},a$k.registerSpriteDefine=function(a$t){var a$k=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[a$k]=a$t,this._spriteName2Int[a$t]=a$k},a$h._globalRegDefine=function(a$t,a$k){a$h._globalInt2name[a$k]=a$t},a$h.add=function(a$t,a$k,a$v,a$j,a$Q){return laya.d3.shader.ShaderCompile3D._preCompileShader[a$t]=new a$h(a$t,a$k,a$v,a$j,a$Q,a$Y.includes)},a$h.get=function(a$t){return laya.d3.shader.ShaderCompile3D._preCompileShader[a$pk.nameKey.getID(a$t)]},a$h._preCompileShader={},a$h._globalInt2name=[],a$h.debugMode=!1,a$h.SHADERDEFINE_HIGHPRECISION=1,a$h.SHADERDEFINE_FOG=4,a$h.SHADERDEFINE_DIRECTIONLIGHT=8,a$h.SHADERDEFINE_POINTLIGHT=16,a$h.SHADERDEFINE_SPOTLIGHT=32,a$h.SHADERDEFINE_UV0=64,a$h.SHADERDEFINE_COLOR=128,a$h.SHADERDEFINE_UV1=256,a$h.SAHDERDEFINE_DEPTHFOG=131072,a$h}(),a$Zk=function(a$t){function a$A(){a$A.__super.call(this)}a$E(a$A,"laya.d3.graphics.MeshSprite3DStaticBatchManager",a$jt);var a$k=a$A.prototype;return a$k._getStaticBatch=function(a$t,a$k,a$v,a$j){var a$Q,a$u;return a$u=a$t?a$t.id.toString()+a$v.id.toString()+a$k.id.toString()+a$j.toString():a$v.id.toString()+a$k.id.toString()+a$j.toString(),this._staticBatches[a$u]?a$Q=this._staticBatches[a$u]:this._staticBatches[a$u]=a$Q=new a$sk(a$u,this,a$t,a$k,a$v),a$Q},a$k._initStaticBatchs=function(a$t){var a$k,a$v;this._initBatchRenderElements.sort(a$A._sortPrepareStaticBatch);for(var a$j,a$Q=!1,a$u=0,a$S=0,a$V=this._initBatchRenderElements.length;a$S<a$V;a$S++){var a$J,a$W=this._initBatchRenderElements[a$S],a$w=a$W.renderObj._getVertexBuffer(0);a$W._sprite3D;if(a$v===a$w.vertexDeclaration&&a$k===a$W._material)if(a$Q)a$j._addCombineBatchRenderObjTest(a$W)?(a$J=a$W._staticBatch)!==a$j&&(a$J&&a$J._deleteCombineBatchRenderObj(a$W),a$j._addCombineBatchRenderObj(a$W)):(a$Q=!1,a$u++);else{var a$M=this._initBatchRenderElements[a$S-1],a$H=a$M.renderObj,a$E=a$W.renderObj;a$Q=!(65535<a$H._getVertexBuffer().vertexCount+a$E._getVertexBuffer().vertexCount)&&(a$j=this._getStaticBatch(a$t,a$v,a$k,a$u),(a$J=a$M._staticBatch)!==a$j&&(a$J&&a$J._deleteCombineBatchRenderObj(a$M),a$j._addCombineBatchRenderObj(a$M)),(a$J=a$W._staticBatch)!==a$j&&(a$J&&a$J._deleteCombineBatchRenderObj(a$W),a$j._addCombineBatchRenderObj(a$W)),!0)}else a$Q=!1,a$u=0;a$k=a$W._material,a$v=a$w.vertexDeclaration}},a$A._sortPrepareStaticBatch=function(a$t,a$k){var a$v=a$t._render,a$j=a$k._render,a$Q=a$v.lightmapIndex-a$j.lightmapIndex;if(0!=a$Q)return a$Q;var a$u=a$v.receiveShadow-a$j.receiveShadow;if(0!=a$u)return a$u;var a$S=a$t._mainSortID-a$k._mainSortID;return 0==a$S?a$t.renderObj.triangleCount-a$k.renderObj.triangleCount:a$S},a$A}(),a$sk=function(a$t){function a$u(a$t,a$k,a$v,a$j,a$Q){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,a$u.__super.call(this,a$t,a$k,a$v),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=a$j,this._material=a$Q}a$E(a$u,"laya.d3.graphics.SubMeshStaticBatch",a$Qt);var a$k=a$u.prototype;return a$k._compareBatchRenderElement=function(a$t,a$k){return a$t._batchIndexStart>a$k._batchIndexStart},a$k._addCombineBatchRenderObjTest=function(a$t){var a$k=a$t.renderObj._vertexCount;return!(65535<(0<a$k?this._currentCombineVertexCount+a$k:this._currentCombineVertexCount+a$t.renderObj._getVertexBuffer().vertexCount))},a$k._addCombineBatchRenderObj=function(a$t){var a$k=a$t.renderObj,a$v=a$k._vertexCount;this._initBatchRenderElements.push(a$t),a$t._staticBatch=this,0<a$v?(this._currentCombineIndexCount+=a$k._indexCount,this._currentCombineVertexCount+=a$v):(this._currentCombineIndexCount=this._currentCombineIndexCount+a$k._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+a$k._getVertexBuffer().vertexCount),this._needFinishCombine=!0},a$k._deleteCombineBatchRenderObj=function(a$t){var a$k=a$t.renderObj,a$v=this._initBatchRenderElements.indexOf(a$t);if(-1!==a$v){this._initBatchRenderElements.splice(a$v,1),a$t._staticBatch=null;var a$j=a$k._vertexCount;0<a$j?(this._currentCombineIndexCount=this._currentCombineIndexCount-a$k._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-a$j):(this._currentCombineIndexCount=this._currentCombineIndexCount-a$k._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-a$k._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},a$k._finishInit=function(){if(this._needFinishCombine){var a$t=0,a$k=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var a$v=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),a$j=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=a$_k.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=a$nk.create("ushort",this._currentCombineIndexCount,35044);for(var a$Q=0,a$u=this._initBatchRenderElements.length;a$Q<a$u;a$Q++){var a$S=this._initBatchRenderElements[a$Q],a$V=a$S.renderObj,a$J=a$V._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,a$S._sprite3D),a$W=a$V.getIndices(),a$w=a$S._sprite3D.transform._isFrontFaceInvert,a$M=a$t/(this._vertexDeclaration.vertexStride/4)-a$V._vertexStart,a$H=a$k,a$E=a$H+a$W.length;a$S._batchIndexStart=a$H,a$S._batchIndexEnd=a$E,a$j.set(a$W,a$k);var a$A=0;if(a$w)for(a$A=a$H;a$A<a$E;a$A+=3){a$j[a$A]=a$M+a$j[a$A];var a$R=a$j[a$A+1],a$h=a$j[a$A+2];a$j[a$A+1]=a$M+a$h,a$j[a$A+2]=a$M+a$R}else for(a$A=a$H;a$A<a$E;a$A+=3)a$j[a$A]=a$M+a$j[a$A],a$j[a$A+1]=a$M+a$j[a$A+1],a$j[a$A+2]=a$M+a$j[a$A+2];a$k+=a$W.length,a$v.set(a$J,a$t),a$t+=a$J.length}this._vertexBuffer.setData(a$v),this._indexBuffer.setData(a$j),this._needFinishCombine=!1}},a$k._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new a$dk)},a$k._getRenderElement=function(a$t,a$k,a$v){for(var a$j,a$Q,a$u=this._batchRenderElements.length,a$S=!0,a$V=0;a$V<a$u;a$V++){var a$J,a$W,a$w=(a$Q=this._batchRenderElements[a$V])._sprite3D._render;if(0!==a$V&&(a$S=(a$J=(a$j=this._batchRenderElements[a$V-1])._sprite3D._render).lightmapIndex!==a$w.lightmapIndex||a$J.receiveShadow!==a$w.receiveShadow||a$j._batchIndexEnd!==a$Q._batchIndexStart),a$S){(a$W=this._getCombineRenderElementFromPool()).renderObj=this,a$W._material=this._material,a$W._batchIndexStart=a$Q._batchIndexStart,a$W._batchIndexEnd=a$Q._batchIndexEnd;var a$M=a$w.lightmapIndex,a$H=a$M+1,a$E=this._batchOwnerIndices[a$H];a$E||(a$E=this._batchOwnerIndices[a$H]=[]);var a$A,a$R=a$E[a$Q._render.receiveShadow?1:0];void 0===a$R?(a$E[a$w.receiveShadow?1:0]=this._batchOwners.length,(a$A=new a$Lk(null,"StaticBatchMeshSprite3D"))._scene=a$k,a$A._transform=this._rootOwner?this._rootOwner._transform:null,a$A._render.lightmapIndex=a$M,a$A._render.receiveShadow=a$Q._render.receiveShadow,this._batchOwners.push(a$A)):a$A=this._batchOwners[a$R],a$A._render._renderUpdate(a$v),a$W._sprite3D=a$A,a$t.push(a$W)}else a$W._batchIndexEnd=a$Q._batchIndexEnd}},a$k._beforeRender=function(a$t){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},a$k._render=function(a$t){var a$k=a$t.renderElement,a$v=a$k._batchIndexStart,a$j=a$k._batchIndexEnd-a$v;a$N.mainContext.drawElements(4,a$j,5123,2*a$v),a$m.drawCall++,a$m.trianglesFaces+=a$j/3},a$k.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},a$k._getVertexBuffer=function(a$t){return void 0===a$t&&(a$t=0),this._vertexBuffer},a$u}(),a$Kk=function(a$t){function a$k(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,a$k.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}a$E(a$k,"laya.d3.core.ComponentNode",a$W);var a$v=a$k.prototype;return a$v.addComponent=function(a$t){var a$k,a$v=this._componentsMap.indexOf(a$t);if(-1===a$v)a$k=[],this._componentsMap.push(a$t),this._typeComponentsIndices.push(a$k);else if(a$k=this._typeComponentsIndices[a$v],this._components[a$k[0]].isSingleton)throw new Error("无法单实例创建"+a$t+"组件，"+a$t+"组件已存在！");var a$j=a$Q.getInstance(a$t);return a$k.push(this._components.length),this._components.push(a$j),a$j instanceof laya.d3.component.Script&&this._scripts.push(a$j),a$j._initialize(this),a$j},a$v._removeComponent=function(a$t,a$k){var a$v=this._typeComponentsIndices[a$t],a$j=a$v[a$k],a$Q=this._components[a$j];this._components.splice(a$j,1),a$Q instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(a$Q),1),a$v.splice(a$k,1),0===a$v.length&&(this._typeComponentsIndices.splice(a$t,1),this._componentsMap.splice(a$t,1));for(var a$u=0,a$S=this._componentsMap.length;a$u<a$S;a$u++)for(var a$V=(a$v=this._typeComponentsIndices[a$u]).length-1;0<=a$V;a$V--){var a$J=a$v[a$V];if(!(a$j<a$J))break;a$v[a$V]=--a$J}a$Q._destroy()},a$v.getComponentByType=function(a$t,a$k){void 0===a$k&&(a$k=0);var a$v=this._componentsMap.indexOf(a$t);return-1===a$v?null:this._components[this._typeComponentsIndices[a$v][a$k]]},a$v.getComponentsByType=function(a$t,a$k){var a$v=this._componentsMap.indexOf(a$t);if(-1!==a$v){var a$j=this._typeComponentsIndices[a$v],a$Q=a$j.length;a$k.length=a$Q;for(var a$u=0;a$u<a$Q;a$u++)a$k[a$u]=this._components[a$j[a$u]]}else a$k.length=0},a$v.getComponentByIndex=function(a$t){return this._components[a$t]},a$v.removeComponentByType=function(a$t,a$k){void 0===a$k&&(a$k=0);var a$v=this._componentsMap.indexOf(a$t);-1!==a$v&&this._removeComponent(a$v,a$k)},a$v.removeComponentsByType=function(a$t){var a$k=this._componentsMap.indexOf(a$t);if(-1!==a$k)for(var a$v=this._typeComponentsIndices[a$k],a$j=0,a$Q=a$v.length;a$j<a$Q;a$v.length<a$Q?a$Q--:a$j++)this._removeComponent(a$k,a$j)},a$v.removeAllComponent=function(){for(var a$t=0,a$k=this._componentsMap.length;a$t<a$k;this._componentsMap.length<a$k?a$k--:a$t++)this.removeComponentsByType(this._componentsMap[a$t])},a$v._updateComponents=function(a$t){for(var a$k=0,a$v=this._components.length;a$k<a$v;a$k++){var a$j=this._components[a$k];!a$j.started&&(a$j._start(a$t),a$j.started=!0),a$j.enable&&a$j._update(a$t)}},a$v._lateUpdateComponents=function(a$t){for(var a$k=0;a$k<this._components.length;a$k++){var a$v=this._components[a$k];!a$v.started&&(a$v._start(a$t),a$v.started=!0),a$v.enable&&a$v._lateUpdate(a$t)}},a$v._preRenderUpdateComponents=function(a$t){for(var a$k=0;a$k<this._components.length;a$k++){var a$v=this._components[a$k];!a$v.started&&(a$v._start(a$t),a$v.started=!0),a$v.enable&&a$v._preRenderUpdate(a$t)}},a$v._postRenderUpdateComponents=function(a$t){for(var a$k=0;a$k<this._components.length;a$k++){var a$v=this._components[a$k];!a$v.started&&(a$v._start(a$t),a$v.started=!0),a$v.enable&&a$v._postRenderUpdate(a$t)}},a$k}(),a$Uk=function(a$j){function a$t(){a$t.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new a$Hk,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new a$Vk(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}a$E(a$t,"laya.d3.core.material.BaseMaterial",a$j);var a$k=a$t.prototype;return a$X.imps(a$k,{"laya.d3.core.IClone":!0}),a$k._addShaderDefine=function(a$t){this._shaderDefineValue|=a$t},a$k._removeShaderDefine=function(a$t){this._shaderDefineValue&=~a$t},a$k._addDisablePublicShaderDefine=function(a$t){this._disablePublicShaderDefine|=a$t},a$k._removeDisablePublicShaderDefine=function(a$t){this._disablePublicShaderDefine&=~a$t},a$k._setBuffer=function(a$t,a$k){this._shaderValues.setValue(a$t,a$k),this._values[a$t]=a$k},a$k._getBuffer=function(a$t){return this._values[a$t]},a$k._setMatrix4x4=function(a$t,a$k){this._shaderValues.setValue(a$t,a$k?a$k.elements:null),this._values[a$t]=a$k},a$k._getMatrix4x4=function(a$t){return this._values[a$t]},a$k._setInt=function(a$t,a$k){this._shaderValues.setValue(a$t,a$k),this._values[a$t]=a$k},a$k._getInt=function(a$t){return this._values[a$t]},a$k._setNumber=function(a$t,a$k){this._shaderValues.setValue(a$t,a$k),this._values[a$t]=a$k},a$k._getNumber=function(a$t){return this._values[a$t]},a$k._setBool=function(a$t,a$k){this._shaderValues.setValue(a$t,a$k),this._values[a$t]=a$k},a$k._getBool=function(a$t){return this._values[a$t]},a$k._setVector2=function(a$t,a$k){this._shaderValues.setValue(a$t,a$k?a$k.elements:null),this._values[a$t]=a$k},a$k._getVector2=function(a$t){return this._values[a$t]},a$k._setColor=function(a$t,a$k){this._shaderValues.setValue(a$t,a$k?a$k.elements:null),this._values[a$t]=a$k},a$k._getColor=function(a$t){return this._values[a$t]},a$k._setTexture=function(a$t,a$k){var a$v=this._values[a$t];this._values[a$t]=a$k,this._shaderValues.setValue(a$t,a$k),0<this.referenceCount&&(a$v&&a$v._removeReference(),a$k&&a$k._addReference())},a$k._getTexture=function(a$t){return this._values[a$t]},a$k._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},a$k._getShader=function(a$t,a$k,a$v){var a$j=(a$t|a$k)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(a$j,a$v,this._shaderDefineValue),this._shader},a$k._setRenderStateBlendDepth=function(){var a$t=a$N.mainContext;switch(a$a.setDepthMask(a$t,this.depthWrite),0===this.depthTest?a$a.setDepthTest(a$t,!1):(a$a.setDepthTest(a$t,!0),a$a.setDepthFunc(a$t,this.depthTest)),this.blend){case 0:a$a.setBlend(a$t,!1);break;case 1:a$a.setBlend(a$t,!0),a$a.setBlendFunc(a$t,this.srcBlend,this.dstBlend);break;case 2:a$a.setBlend(a$t,!0)}},a$k._setRenderStateFrontFace=function(a$t,a$k){var a$v=a$N.mainContext,a$j=0;switch(this.cull){case 0:a$a.setCullFace(a$v,!1);break;case 1:a$a.setCullFace(a$v,!0),a$j=a$t?a$k&&a$k._isFrontFaceInvert?2305:2304:a$k&&a$k._isFrontFaceInvert?2304:2305,a$a.setFrontFace(a$v,a$j);break;case 2:a$a.setCullFace(a$v,!0),a$j=a$t?a$k&&a$k._isFrontFaceInvert?2304:2305:a$k&&a$k._isFrontFaceInvert?2305:2304,a$a.setFrontFace(a$v,a$j)}},a$k.onAsynLoaded=function(a$t,a$k,a$v){var a$j=a$k[0],a$Q=a$k[1];switch(a$j.version){case"LAYAMATERIAL:01":var a$u=0,a$S=0,a$V=a$j.props;for(var a$J in a$V)switch(a$J){case"vectors":var a$W=a$V[a$J];for(a$u=0,a$S=a$W.length;a$u<a$S;a$u++){var a$w=a$W[a$u],a$M=a$w.value;switch(a$M.length){case 2:this[a$w.name]=new a$uk(a$M[0],a$M[1]);break;case 3:this[a$w.name]=new a$Sk(a$M[0],a$M[1],a$M[2]);break;case 4:this[a$w.name]=new a$Vk(a$M[0],a$M[1],a$M[2],a$M[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var a$H=a$V[a$J];for(a$u=0,a$S=a$H.length;a$u<a$S;a$u++){var a$E=a$H[a$u],a$A=a$E.path;a$A&&(this[a$E.name]=a$l.getRes(a$Q[a$A]))}break;case"defines":var a$R=a$V[a$J];for(a$u=0,a$S=a$R.length;a$u<a$S;a$u++){var a$h=this._shaderCompile.getMaterialDefineByName(a$R[a$u]);this._addShaderDefine(a$h)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[a$J]=a$V[a$J];break;case"renderQueue":switch(a$V[a$J]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[a$J]=a$V[a$J]}break;case"LAYAMATERIAL:02":for(a$J in a$V=a$j.props)switch(a$J){case"vectors":for(a$u=0,a$S=(a$W=a$V[a$J]).length;a$u<a$S;a$u++)switch((a$M=(a$w=a$W[a$u]).value).length){case 2:this[a$w.name]=new a$uk(a$M[0],a$M[1]);break;case 3:this[a$w.name]=new a$Sk(a$M[0],a$M[1],a$M[2]);break;case 4:this[a$w.name]=new a$Vk(a$M[0],a$M[1],a$M[2],a$M[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(a$u=0,a$S=(a$H=a$V[a$J]).length;a$u<a$S;a$u++)(a$A=(a$E=a$H[a$u]).path)&&(this[a$E.name]=a$l.getRes(a$Q[a$A]));break;case"defines":for(a$u=0,a$S=(a$R=a$V[a$J]).length;a$u<a$S;a$u++)a$h=this._shaderCompile.getMaterialDefineByName(a$R[a$u]),this._addShaderDefine(a$h);break;default:this[a$J]=a$V[a$J]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},a$k._addReference=function(){a$j.prototype._addReference.call(this);for(var a$t=0,a$k=this._values.length;a$t<a$k;a$t++){var a$v=this._values[a$t];a$v&&a$v instanceof laya.d3.resource.BaseTexture&&a$v._addReference()}},a$k._removeReference=function(){a$j.prototype._removeReference.call(this);for(var a$t=0,a$k=this._values.length;a$t<a$k;a$t++){var a$v=this._values[a$t];a$v&&a$v instanceof laya.d3.resource.BaseTexture&&a$v._removeReference()}},a$k.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},a$k.setShaderName=function(a$t){var a$k=a$pk.nameKey.getID(a$t);if(-1===a$k)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=a$mk._preCompileShader[a$k]},a$k.cloneTo=function(a$t){var a$k=a$t;a$k.name=this.name,a$k.cull=this.cull,a$k.blend=this.blend,a$k.srcBlend=this.srcBlend,a$k.dstBlend=this.dstBlend,a$k.srcBlendRGB=this.srcBlendRGB,a$k.dstBlendRGB=this.dstBlendRGB,a$k.srcBlendAlpha=this.srcBlendAlpha,a$k.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(a$k.blendConstColor),a$k.blendEquation=this.blendEquation,a$k.blendEquationRGB=this.blendEquationRGB,a$k.blendEquationAlpha=this.blendEquationAlpha,a$k.depthTest=this.depthTest,a$k.depthWrite=this.depthWrite,a$k.renderQueue=this.renderQueue,a$k._shader=this._shader,a$k._disablePublicShaderDefine=this._disablePublicShaderDefine,a$k._shaderDefineValue=this._shaderDefineValue;var a$v,a$j=0,a$Q=a$k._shaderValues;a$k._shaderValues.data.length=this._shaderValues.data.length;var a$u=this._values.length,a$S=a$k._values;for(a$j=0,a$v=a$S.length=a$u;a$j<a$v;a$j++){var a$V=this._values[a$j];if(a$V)if("number"==typeof a$V)a$S[a$j]=a$V,a$Q.data[a$j]=a$V;else if("number"==typeof a$V&&Math.floor(a$V)==a$V)a$S[a$j]=a$V,a$Q.data[a$j]=a$V;else if("boolean"==typeof a$V)a$S[a$j]=a$V,a$Q.data[a$j]=a$V;else if(a$V instanceof laya.d3.math.Vector2){var a$J=a$S[a$j]||(a$S[a$j]=new a$uk);a$V.cloneTo(a$J),a$Q.data[a$j]=a$J.elements}else if(a$V instanceof laya.d3.math.Vector3){var a$W=a$S[a$j]||(a$S[a$j]=new a$Sk);a$V.cloneTo(a$W),a$Q.data[a$j]=a$W.elements}else if(a$V instanceof laya.d3.math.Vector4){var a$w=a$S[a$j]||(a$S[a$j]=new a$Vk);a$V.cloneTo(a$w),a$Q.data[a$j]=a$w.elements}else if(a$V instanceof laya.d3.math.Matrix4x4){var a$M=a$S[a$j]||(a$S[a$j]=new a$tk);a$V.cloneTo(a$M),a$Q.data[a$j]=a$M.elements}else a$V instanceof laya.d3.resource.BaseTexture&&(a$S[a$j]=a$V,a$Q.data[a$j]=a$V)}},a$k.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$A(0,a$k,"alphaTestValue",function(){return this._getNumber(0)},function(a$t){this._setNumber(0,a$t)}),a$A(0,a$k,"alphaTest",function(){return this._alphaTest},function(a$t){(this._alphaTest=a$t)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),a$t.__init__=function(){a$t.SHADERDEFINE_ALPHATEST=a$t.shaderDefines.registerDefine("ALPHATEST")},a$t.RENDERQUEUE_OPAQUE=2e3,a$t.RENDERQUEUE_ALPHATEST=2450,a$t.RENDERQUEUE_TRANSPARENT=3e3,a$t.CULL_NONE=0,a$t.CULL_FRONT=1,a$t.CULL_BACK=2,a$t.BLEND_DISABLE=0,a$t.BLEND_ENABLE_ALL=1,a$t.BLEND_ENABLE_SEPERATE=2,a$t.BLENDPARAM_ZERO=0,a$t.BLENDPARAM_ONE=1,a$t.BLENDPARAM_SRC_COLOR=768,a$t.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,a$t.BLENDPARAM_DST_COLOR=774,a$t.BLENDPARAM_ONE_MINUS_DST_COLOR=775,a$t.BLENDPARAM_SRC_ALPHA=770,a$t.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,a$t.BLENDPARAM_DST_ALPHA=772,a$t.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,a$t.BLENDPARAM_SRC_ALPHA_SATURATE=776,a$t.BLENDEQUATION_ADD=0,a$t.BLENDEQUATION_SUBTRACT=1,a$t.BLENDEQUATION_REVERSE_SUBTRACT=2,a$t.DEPTHTEST_OFF=0,a$t.DEPTHTEST_NEVER=512,a$t.DEPTHTEST_LESS=513,a$t.DEPTHTEST_EQUAL=514,a$t.DEPTHTEST_LEQUAL=515,a$t.DEPTHTEST_GREATER=516,a$t.DEPTHTEST_NOTEQUAL=517,a$t.DEPTHTEST_GEQUAL=518,a$t.DEPTHTEST_ALWAYS=519,a$t.SHADERDEFINE_ALPHATEST=1,a$t.ALPHATESTVALUE=0,a$M(a$t,["shaderDefines",function(){return this.shaderDefines=new a$wk}]),a$t}(a$h),a$Nk=function(a$t){function a$k(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,a$k.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}a$E(a$k,"laya.d3.resource.BaseTexture",a$h);var a$v=a$k.prototype;return a$A(0,a$v,"width",function(){return this._width}),a$A(0,a$v,"repeat",function(){return this._repeat},function(a$t){if(this._repeat!==a$t&&(this._repeat=a$t,this._source)){var a$k=a$N.mainContext;a$a.bindTexture(a$k,this._type,this._source),a$f.isPOT(this._width,this._height)&&this._repeat?(a$k.texParameteri(this._type,10242,10497),a$k.texParameteri(this._type,10243,10497)):(a$k.texParameteri(this._type,10242,33071),a$k.texParameteri(this._type,10243,33071))}}),a$A(0,a$v,"height",function(){return this._height}),a$A(0,a$v,"magFifter",function(){return this._magFifter},function(a$t){(this._magFifter=a$t)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(a$t)}),a$A(0,a$v,"wrapModeV",function(){return this._wrapModeV}),a$A(0,a$v,"size",function(){return this._size}),a$A(0,a$v,"wrapModeU",function(){return this._wrapModeU}),a$A(0,a$v,"mipmap",function(){return this._mipmap},function(a$t){this._mipmap=a$t,this._mipmap!=a$t&&this._conchTexture&&this._conchTexture.setMipMap(a$t)}),a$A(0,a$v,"minFifter",function(){return this._minFifter},function(a$t){this._minFifter=a$t,this._minFifter!=a$t&&this._conchTexture&&this._conchTexture.setMinFifter(a$t)}),a$A(0,a$v,"format",function(){return this._format}),a$A(0,a$v,"source",function(){return this.activeResource(),this._source}),a$A(0,a$v,"defaulteTexture",function(){return a$Dk.grayTexture}),a$k.WARPMODE_REPEAT=0,a$k.WARPMODE_CLAMP=1,a$k}(),a$ak=function(a$t){function a$k(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,a$k.__super.call(this),this._boundingBoxCorners=a$j(8,null)}a$E(a$k,"laya.d3.resource.models.BaseMesh",a$h);var a$v=a$k.prototype;return a$v._getPositions=function(){throw new Error("未Override,请重载该属性！")},a$v._generateBoundingObject=function(){this._boundingSphere=new a$$t(new a$Sk,0),a$$t.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new a$rt(new a$Sk,new a$Sk),a$rt.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},a$v.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},a$v.getRenderElement=function(a$t){throw new Error("未Override,请重载该属性！")},a$A(0,a$v,"subMeshCount",function(){return this._subMeshCount}),a$A(0,a$v,"boundingBox",function(){return this._boundingBox}),a$A(0,a$v,"boundingBoxCorners",function(){return this._boundingBoxCorners}),a$A(0,a$v,"boundingSphere",function(){return this._boundingSphere}),a$k}(),a$zk=(function(a$t){function a$k(){a$k.__super.call(this)}a$E(a$k,"laya.d3.component.Script",a$Yk);var a$v=a$k.prototype;a$v.onTriggerEnter=function(a$t){},a$v.onTriggerExit=function(a$t){},a$v.onTriggerStay=function(a$t){},a$A(0,a$v,"isSingleton",function(){return a$k._isSingleton}),a$k._isSingleton=!1}(),function(a$t){function a$k(a$t){this._owner=null,this._sharedMesh=null,a$k.__super.call(this),this._owner=a$t}a$E(a$k,"laya.d3.core.MeshFilter",a$t);var a$v=a$k.prototype;return a$v._sharedMeshLoaded=function(){this.event("loaded")},a$v._destroy=function(){a$t.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},a$A(0,a$v,"sharedMesh",function(){return this._sharedMesh},function(a$t){var a$k=this._sharedMesh;a$k&&a$k._removeReference(),(this._sharedMesh=a$t)._addReference(),this.event("meshchanged",[this,a$k,a$t]),a$t.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),a$A(0,a$v,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),a$A(0,a$v,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),a$A(0,a$v,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),a$A(0,a$v,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),a$k}(a$fk)),a$Gk=function(a$t){function a$k(a$t){a$k.__super.call(this,a$t),a$t.meshFilter.on("meshchanged",this,this._onMeshChanged)}a$E(a$k,"laya.d3.core.MeshRender",a$Xk);var a$v=a$k.prototype;return a$v._onMeshChanged=function(a$t,a$k,a$v){a$v.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:a$v.once("loaded",this,this._onMeshLoaed)},a$v._onMeshLoaed=function(a$t,a$k){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},a$v._calculateBoundingSphereByInitSphere=function(a$t){var a$k=NaN,a$v=this._owner.transform,a$j=a$v.scale.elements,a$Q=Math.abs(a$j[0]),a$u=Math.abs(a$j[1]),a$S=Math.abs(a$j[2]);a$k=a$u<=a$Q&&a$S<=a$Q?a$Q:a$S<=a$u?a$u:a$S,a$Sk.transformCoordinate(a$t.center,a$v.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=a$t.radius*a$k},a$v._calculateBoundBoxByInitCorners=function(a$t){for(var a$k=this._owner.transform.worldMatrix,a$v=0;a$v<8;a$v++)a$Sk.transformCoordinate(a$t[a$v],a$k,a$Xk._tempBoundBoxCorners[a$v]);a$rt.createfromPoints(a$Xk._tempBoundBoxCorners,this._boundingBox)},a$v._calculateBoundingSphere=function(){var a$t=this._owner.meshFilter.sharedMesh;null==a$t||null==a$t.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(a$t.boundingSphere)},a$v._calculateBoundingBox=function(){var a$t=this._owner.meshFilter.sharedMesh;null==a$t||null==a$t.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(a$t.boundingBoxCorners)},a$v._renderUpdate=function(a$t){var a$k=this._owner.transform;if(a$k){this._setShaderValueMatrix4x4(0,a$k.worldMatrix);var a$v=this._owner.getProjectionViewWorldMatrix(a$t);this._setShaderValueMatrix4x4(1,a$v)}else this._setShaderValueMatrix4x4(0,a$tk.DEFAULT),this._setShaderValueMatrix4x4(1,a$t);return a$lk.debugMode&&this._renderRenderableBoundBox(),!0},a$k}(),a$ck=function(a$k){function a$j(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,a$j.__super.call(this),this._renderState=new a$e,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new a$Hk,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new a$kt,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new a$Sk(.7,.7,.7),this.ambientColor=new a$Sk(.212,.227,.259),a$N.shaderHighPrecision&&this.addShaderDefine(a$mk.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}a$E(a$j,"laya.d3.core.scene.Scene",a$k);var a$t=a$j.prototype;return a$X.imps(a$t,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),a$t._setUrl=function(a$t){this._url=a$t},a$t._getGroup=function(){return this._group},a$t._setGroup=function(a$t){this._group=a$t},a$t._display=function(){a$X.stage._scenes.push(this),a$X.stage._scenes.sort(a$j._sortScenes);for(var a$t=0,a$k=this._childs.length;a$t<a$k;a$t++){var a$v=this._childs[a$t];a$v.active&&a$v._activeHierarchy()}},a$t._unDisplay=function(){var a$t=a$X.stage._scenes;a$t.splice(a$t.indexOf(this),1);for(var a$k=0,a$v=this._childs.length;a$k<a$v;a$k++){var a$j=this._childs[a$k];a$j.active&&a$j._inActiveHierarchy()}},a$t._addChild3D=function(a$t){a$t.transform._onWorldTransform(),a$t._setBelongScene(this),this.displayedInStage&&a$t.active&&a$t._activeHierarchy()},a$t._removeChild3D=function(a$t){a$t.transform.parent=null,this.displayedInStage&&a$t.active&&a$t._inActiveHierarchy(),a$t._setUnBelongScene()},a$t.initOctree=function(a$t,a$k,a$v,a$j,a$Q){void 0===a$Q&&(a$Q=6),this.treeSize=new a$Sk(a$t,a$k,a$v),this.treeLevel=a$Q,this.treeRoot=new a$r(this,0),this.treeRoot.init(a$j,this.treeSize)},a$t._prepareUpdateToRenderState=function(a$t,a$k){a$k.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,a$k.scene=this},a$t._prepareSceneToRender=function(a$t){var a$k=this._lights.length;if(0<a$k)for(var a$v=0,a$j=0;a$j<a$k&&!(this._lights[a$j]._prepareToScene(a$t)&&++a$v>=this._enableLightCount);a$j++);},a$t._updateChilds=function(a$t){for(var a$k=0,a$v=this._childs.length;a$k<a$v;++a$k)this._childs[a$k]._update(a$t)},a$t._preRenderScene=function(a$t,a$k,a$v){var a$j,a$Q=a$k._viewMatrix,a$u=a$k._projectionMatrix,a$S=a$k._projectionViewMatrix,a$V=0,a$J=a$k.camera;for(a$J.useOcclusionCulling?this.treeRoot?a$vt.renderObjectCullingOctree(a$v,this,a$J,a$Q,a$u,a$S):a$vt.renderObjectCulling(a$v,this,a$J,a$Q,a$u,a$S):a$vt.renderObjectCullingNoBoundFrustum(this,a$J,a$Q,a$u,a$S),a$V=0,a$j=this._quenes.length;a$V<a$j;a$V++)this._quenes[a$V]&&this._quenes[a$V]._preRender(a$k)},a$t._clear=function(a$t,a$k){var a$v=a$k._viewport,a$j=a$k.camera,a$Q=a$v.x,a$u=a$j.renderTargetSize.height-a$v.y-a$v.height,a$S=a$v.width,a$V=a$v.height;a$t.viewport(a$Q,a$u,a$S,a$V);var a$J=256,a$W=a$j.renderTarget;switch(a$j.clearFlag){case 0:var a$w=a$j.clearColor;if(a$w){a$t.enable(3089),a$t.scissor(a$Q,a$u,a$S,a$V);var a$M=a$w.elements;a$t.clearColor(a$M[0],a$M[1],a$M[2],a$M[3]),a$J|=16384}if(a$W)switch(a$w||(a$J=16384),a$W.depthStencilFormat){case 33189:a$J|=256;break;case 36168:a$J|=1024;break;case 34041:a$J|=256,a$J|=1024}a$t.clear(a$J),a$w&&a$t.disable(3089);break;case 1:case 2:if(a$W)switch(a$J=16384,a$W.depthStencilFormat){case 33189:a$J|=256;break;case 36168:a$J|=1024;break;case 34041:a$J|=256,a$J|=1024}a$t.clear(a$J);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},a$t._renderScene=function(a$t,a$k){var a$v,a$j,a$Q=a$k.camera,a$u=0;for(a$u=0;a$u<2;a$u++)(a$j=this._quenes[a$u])&&(a$Q.renderTarget?a$j._render(a$k,!0):a$j._render(a$k,!1));if(1===a$Q.clearFlag){var a$S=a$Q.sky;a$S&&(a$a.setCullFace(a$t,!1),a$a.setDepthFunc(a$t,515),a$a.setDepthMask(a$t,!1),a$S._render(a$k),a$a.setDepthFunc(a$t,513),a$a.setDepthMask(a$t,!0))}for(a$u=2,a$v=this._quenes.length;a$u<a$v;a$u++)(a$j=this._quenes[a$u])&&(a$j._sortAlpha(a$k.camera.transform.position),a$Q.renderTarget?a$j._render(a$k,!0):a$j._render(a$k,!1))},a$t._set3DRenderConfig=function(a$t){a$t.disable(3042),a$a._blend=!1,a$t.blendFunc(770,771),a$a._sFactor=770,a$a._dFactor=771,a$t.disable(2929),a$a._depthTest=!1,a$t.enable(2884),a$a._cullFace=!0,a$t.depthMask(1),a$a._depthMask=!0,a$t.frontFace(2304),a$a._frontFace=2304},a$t._set2DRenderConfig=function(a$t){a$a.setBlend(a$t,!0),a$a.setBlendFunc(a$t,1,771),a$a.setDepthTest(a$t,!1),a$a.setCullFace(a$t,!1),a$a.setDepthMask(a$t,!0),a$a.setFrontFace(a$t,2305),a$t.viewport(0,0,a$w.width,a$w.height)},a$t._parseCustomProps=function(a$t,a$k,a$v,a$j){var a$Q=a$j.customProps.lightmaps,a$u=a$Q.length,a$S=this._lightmaps;a$S.length=a$u;for(var a$V=0;a$V<a$u;a$V++)a$S[a$V]=a$l.getRes(a$k[a$Q[a$V].replace(".exr",".png")]);this.setlightmaps(a$S);var a$J=a$j.customProps.ambientColor;a$J&&(this.ambientColor=new a$Sk(a$J[0],a$J[1],a$J[2]));var a$W=a$j.customProps.fogColor;a$W&&(this.fogColor=new a$Sk(a$W[0],a$W[1],a$W[2]))},a$t._addLight=function(a$t){this._lights.indexOf(a$t)<0&&this._lights.push(a$t)},a$t._removeLight=function(a$t){var a$k=this._lights.indexOf(a$t);0<=a$k&&this._lights.splice(a$k,1)},a$t._updateScene=function(){var a$t=this._renderState;this._prepareUpdateToRenderState(a$N.mainContext,a$t),this._updateComponents(a$t),this._updateChilds(a$t),this._lateUpdateComponents(a$t),this._time+=a$t.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},a$t._updateSceneConch=function(){var a$t=this._renderState;this._prepareUpdateToRenderState(a$N.mainContext,a$t),this._updateComponents(a$t),this._lateUpdateComponents(a$t),this._prepareSceneToRender(a$t);for(var a$k=0,a$v=this._cameraPool.length;a$k<a$v;a$k++){var a$j=this._cameraPool[a$k];(a$t.camera=a$j)._prepareCameraToRender()}},a$t._preRenderShadow=function(a$t,a$k,a$v,a$j,a$Q){this.treeRoot?a$vt.renderShadowObjectCullingOctree(this,a$k,a$v,a$j,a$Q):a$vt.renderShadowObjectCulling(this,a$k,a$v,a$j,a$Q);for(var a$u=0,a$S=a$v.length;a$u<a$S;a$u++)a$v[a$u]&&a$v[a$u]._preRender(a$t)},a$t._renderShadowMap=function(a$t,a$k,a$v){var a$j=this.parallelSplitShadowMaps[0];a$j._calcAllLightCameraInfo(a$v);var a$Q,a$u,a$S,a$V=a$j.PSSMNum;if(this._preRenderShadow(a$k,a$j._lightCulling,a$j._shadowQuenes,a$j._lightVPMatrix[0],a$V),this.addShaderDefine(a$Ek.SHADERDEFINE_CAST_SHADOW),1<a$V)for(var a$J=0;a$J<a$V;a$J++)a$Q=a$j.getRenderTarget(a$J+1),a$j.beginRenderTarget(a$J+1),a$t.clearColor(1,1,1,1),a$t.clear(16640),a$t.viewport(0,0,a$Q.width,a$Q.height),a$k.camera=a$S=a$j.getLightCamera(a$J),a$S._prepareCameraToRender(),a$S._prepareCameraViewProject(a$S.viewMatrix,a$S.projectionMatrix),a$k._projectionViewMatrix=a$j._lightVPMatrix[a$J+1],(a$u=a$j._shadowQuenes[a$J])._preRender(a$k),a$u._renderShadow(a$k,!1),a$j.endRenderTarget(a$J+1);else a$Q=a$j.getRenderTarget(1),a$j.beginRenderTarget(1),a$t.clearColor(1,1,1,1),a$t.clear(16640),a$t.viewport(0,0,a$Q.width,a$Q.height),a$k.camera=a$S=a$j.getLightCamera(0),a$S._prepareCameraToRender(),a$S._prepareCameraViewProject(a$S.viewMatrix,a$S.projectionMatrix),a$k._projectionViewMatrix=a$j._lightVPMatrix[0],(a$u=a$j._shadowQuenes[0])._preRender(a$k),a$u._renderShadow(a$k,!0),a$j.endRenderTarget(1);this.removeShaderDefine(a$Ek.SHADERDEFINE_CAST_SHADOW)},a$t.addTreeNode=function(a$t){this.treeRoot.addTreeNode(a$t)},a$t.removeTreeNode=function(a$t){this.treeSize&&a$t._treeNode&&a$t._treeNode.removeObject(a$t)},a$t.setlightmaps=function(a$t){this._lightmaps=a$t;for(var a$k=0,a$v=this._renderableSprite3Ds.length;a$k<a$v;a$k++)this._renderableSprite3Ds[a$k]._render._applyLightMapParams()},a$t.getlightmaps=function(){return this._lightmaps},a$t.addChildAt=function(a$t,a$k){if(!(a$t instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(a$t&&a$t.__className));if(!a$t||this.destroyed||a$t===this)return a$t;if(a$t.zOrder&&this._set$P("hasZorder",!0),0<=a$k&&a$k<=this._childs.length){if(a$t._parent===this){var a$v=this.getChildIndex(a$t);this._childs.splice(a$v,1),this._childs.splice(a$k,0,a$t),this.conchModel&&(this.conchModel.removeChild(a$t.conchModel),this.conchModel.addChildAt(a$t.conchModel,a$k)),this._childChanged()}else a$t.parent&&a$t.parent.removeChild(a$t),this._childs===a$W.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(a$k,0,a$t),this.conchModel&&this.conchModel.addChildAt(a$t.conchModel,a$k),(a$t.parent=this)._addChild3D(a$t);return a$t}throw new Error("appendChildAt:The index is out of bounds")},a$t.addChild=function(a$t){if(!(a$t instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!a$t||this.destroyed||a$t===this)return a$t;if(a$t.zOrder&&this._set$P("hasZorder",!0),a$t._parent===this){var a$k=this.getChildIndex(a$t);a$k!==this._childs.length-1&&(this._childs.splice(a$k,1),this._childs.push(a$t),this.conchModel&&(this.conchModel.removeChild(a$t.conchModel),this.conchModel.addChildAt(a$t.conchModel,this._childs.length-1)),this._childChanged())}else a$t.parent&&a$t.parent.removeChild(a$t),this._childs===a$W.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(a$t),this.conchModel&&this.conchModel.addChildAt(a$t.conchModel,this._childs.length-1),(a$t.parent=this)._childChanged(),this._addChild3D(a$t);return a$t},a$t.removeChildAt=function(a$t){var a$k=this.getChildAt(a$t);return a$k&&(this._removeChild3D(a$k),this._childs.splice(a$t,1),this.conchModel&&this.conchModel.removeChild(a$k.conchModel),a$k.parent=null),a$k},a$t.removeChildren=function(a$t,a$k){if(void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=2147483647),this._childs&&0<this._childs.length){var a$v=this._childs;if(0===a$t&&a$u<=a$k){var a$j=a$v;this._childs=a$W.ARRAY_EMPTY}else a$j=a$v.splice(a$t,a$k-a$t);for(var a$Q=0,a$u=a$j.length;a$Q<a$u;a$Q++)this._removeChild3D(a$j[a$Q]),a$j[a$Q].parent=null,this.conchModel&&this.conchModel.removeChild(a$j[a$Q].conchModel)}return this},a$t.addFrustumCullingObject=function(a$t){this.treeRoot?this.addTreeNode(a$t):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(a$t):this._cullingRenders[this._cullingRendersLength]=a$t,a$t._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},a$t.removeFrustumCullingObject=function(a$t){if(this.treeRoot)this.removeTreeNode(a$t);else{this._cullingRendersLength--;var a$k=a$t._indexInSceneFrustumCullingObjects;if(a$k!==this._cullingRendersLength){var a$v=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[a$k]=a$v)._indexInSceneFrustumCullingObjects=a$k,a$t._indexInSceneFrustumCullingObjects=-1}}},a$t.getRenderQueue=function(a$t){return a$t<3e3?this._quenes[1]||(this._quenes[1]=new a$L(this)):this._quenes[2]||(this._quenes[2]=new a$L(this))},a$t.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new a$L(this)},a$t.addShaderDefine=function(a$t){this._shaderDefineValue|=a$t},a$t.removeShaderDefine=function(a$t){this._shaderDefineValue&=~a$t},a$t.addScript=function(a$t){return this._addComponent(a$t)},a$t.getScriptByType=function(a$t,a$k){return void 0===a$k&&(a$k=0),this._getComponentByType(a$t,a$k)},a$t.getScriptsByType=function(a$t,a$k){this._getComponentsByType(a$t,a$k)},a$t.getScriptByIndex=function(a$t){return this._getComponentByIndex(a$t)},a$t.removeScriptByType=function(a$t,a$k){void 0===a$k&&(a$k=0),this._removeComponentByType(a$t,a$k)},a$t.removeScriptsByType=function(a$t){this._removeComponentByType(a$t)},a$t.removeAllScript=function(){this._removeAllComponent()},a$t.render=function(a$t,a$k,a$v){(a$R._context.ctx._renderKey=0)<this._childs.length&&a$t.addRenderObject(this)},a$t.renderSubmit=function(){var a$t=a$N.mainContext,a$k=this._renderState;this._set3DRenderConfig(a$t),this._prepareSceneToRender(this._renderState);var a$v,a$j=0,a$Q=0;if(a$lk.debugMode||a$r.debugMode)for(a$j=0,a$Q=this._cameraPool.length;a$j<a$Q;a$j++)a$v=this._cameraPool[a$j],a$lk._debugPhasorSprite.begin(1,a$v),a$v.activeInHierarchy&&a$v._renderCamera(a$t,a$k,this),a$lk._debugPhasorSprite.end();else for(a$j=0,a$Q=this._cameraPool.length;a$j<a$Q;a$j++)(a$v=this._cameraPool[a$j]).activeInHierarchy&&a$v._renderCamera(a$t,a$k,this);return this._set2DRenderConfig(a$t),1},a$t.onAsynLoaded=function(a$t,a$k,a$v){var a$j=a$k[0];if("Scene"!==a$j.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var a$Q=a$k[1];a$hk._createNodeByJson(this,a$j,this,a$Q),this.event("hierarchyloaded",[this]),this.__loaded=!0},a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),this.destroyed||(a$k.prototype.destroy.call(this,a$t),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,a$l.clearRes(this.url),this.loaded||a$lk._cancelLoadByUrl(this.url))},a$t.getRenderType=function(){return 0},a$t.releaseRender=function(){},a$t._addComponent=function(a$t){var a$k,a$v=this._componentsMap.indexOf(a$t);if(-1===a$v)a$k=[],this._componentsMap.push(a$t),this._typeComponentsIndices.push(a$k);else if(a$k=this._typeComponentsIndices[a$v],this._components[a$k[0]].isSingleton)throw new Error("无法单实例创建"+a$t+"组件，"+a$t+"组件已存在！");var a$j=a$Q.getInstance(a$t);a$k.push(this._components.length),this._components.push(a$j);return a$j._initialize(this),a$j},a$t._removeComponent=function(a$t,a$k){var a$v=this._typeComponentsIndices[a$t],a$j=a$v[a$k],a$Q=this._components[a$j];this._components.splice(a$j,1),a$v.splice(a$k,1),0===a$v.length&&(this._typeComponentsIndices.splice(a$t,1),this._componentsMap.splice(a$t,1));for(var a$u=0,a$S=this._componentsMap.length;a$u<a$S;a$u++)for(var a$V=(a$v=this._typeComponentsIndices[a$u]).length-1;0<=a$V;a$V--){var a$J=a$v[a$V];if(!(a$j<a$J))break;a$v[a$V]=--a$J}a$Q._destroy()},a$t._getComponentByType=function(a$t,a$k){void 0===a$k&&(a$k=0);var a$v=this._componentsMap.indexOf(a$t);return-1===a$v?null:this._components[this._typeComponentsIndices[a$v][a$k]]},a$t._getComponentsByType=function(a$t,a$k){var a$v=this._componentsMap.indexOf(a$t);if(-1!==a$v){var a$j=this._typeComponentsIndices[a$v],a$Q=a$j.length;a$k.length=a$Q;for(var a$u=0;a$u<a$Q;a$u++)a$k[a$u]=this._components[a$j[a$u]]}else a$k.length=0},a$t._getComponentByIndex=function(a$t){return this._components[a$t]},a$t._removeComponentByType=function(a$t,a$k){void 0===a$k&&(a$k=0);var a$v=this._componentsMap.indexOf(a$t);-1!==a$v&&this._removeComponent(a$v,a$k)},a$t._removeComponentsByType=function(a$t){var a$k=this._componentsMap.indexOf(a$t);if(-1!==a$k)for(var a$v=this._typeComponentsIndices[a$k],a$j=0,a$Q=a$v.length;a$j<a$Q;a$v.length<a$Q?a$Q--:a$j++)this._removeComponent(a$k,a$j)},a$t._removeAllComponent=function(){for(var a$t=0,a$k=this._componentsMap.length;a$t<a$k;this._componentsMap.length<a$k?a$k--:a$t++)this._removeComponentsByType(this._componentsMap[a$t])},a$t._updateComponents=function(a$t){for(var a$k=0,a$v=this._components.length;a$k<a$v;a$k++){var a$j=this._components[a$k];!a$j.started&&(a$j._start(a$t),a$j.started=!0),a$j.enable&&a$j._update(a$t)}},a$t._lateUpdateComponents=function(a$t){for(var a$k=0;a$k<this._components.length;a$k++){var a$v=this._components[a$k];!a$v.started&&(a$v._start(a$t),a$v.started=!0),a$v.enable&&a$v._lateUpdate(a$t)}},a$t._preRenderUpdateComponents=function(a$t){for(var a$k=0;a$k<this._components.length;a$k++){var a$v=this._components[a$k];!a$v.started&&(a$v._start(a$t),a$v.started=!0),a$v.enable&&a$v._preRenderUpdate(a$t)}},a$t._postRenderUpdateComponents=function(a$t){for(var a$k=0;a$k<this._components.length;a$k++){var a$v=this._components[a$k];!a$v.started&&(a$v._start(a$t),a$v.started=!0),a$v.enable&&a$v._postRenderUpdate(a$t)}},a$A(0,a$t,"_loaded",null,function(a$t){this.__loaded=a$t}),a$A(0,a$t,"fogColor",function(){return this._fogColor},function(a$t){this._fogColor=a$t,this._shaderValues.setValue(0,a$t.elements)}),a$A(0,a$t,"enableFog",function(){return this._enableFog},function(a$t){this._enableFog!==a$t&&((this._enableFog=a$t)?(this.addShaderDefine(a$mk.SHADERDEFINE_FOG),this.removeShaderDefine(a$mk.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(a$mk.SHADERDEFINE_FOG))}),a$A(0,a$t,"url",function(){return this._url}),a$A(0,a$t,"loaded",function(){return this.__loaded}),a$A(0,a$t,"enableDepthFog",function(){return this._enableDepthFog},function(a$t){this._enableDepthFog!=a$t&&((this._enableDepthFog=a$t)?(this.addShaderDefine(a$mk.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(a$mk.SHADERDEFINE_FOG)):this.removeShaderDefine(a$mk.SAHDERDEFINE_DEPTHFOG))}),a$A(0,a$t,"fogStart",function(){return this._fogStart},function(a$t){this._fogStart=a$t,this._shaderValues.setValue(1,a$t)}),a$A(0,a$t,"fogRange",function(){return this._fogRange},function(a$t){this._fogRange=a$t,this._shaderValues.setValue(2,a$t)}),a$A(0,a$t,"ambientColor",function(){return this._ambientColor},function(a$t){this._ambientColor=a$t,this._shaderValues.setValue(21,a$t.elements)}),a$A(0,a$t,"scene",function(){return this}),a$A(0,a$t,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),a$j._sortScenes=function(a$t,a$k){if(a$t.parent!==a$X.stage||a$k.parent!==a$X.stage)return a$t.parent!==a$X.stage&&a$k.parent!==a$X.stage?a$j._sortScenes(a$t.parent,a$k.parent):a$t.parent===a$X.stage?-1:1;var a$v=a$X.stage._childs;return a$v.indexOf(a$t)-a$v.indexOf(a$k)},a$j.load=function(a$t){return a$X.loader.create(a$t,null,null,a$j)},a$j.FOGCOLOR=0,a$j.FOGSTART=1,a$j.FOGRANGE=2,a$j.LIGHTDIRECTION=3,a$j.LIGHTDIRCOLOR=4,a$j.POINTLIGHTPOS=5,a$j.POINTLIGHTRANGE=6,a$j.POINTLIGHTATTENUATION=7,a$j.POINTLIGHTCOLOR=8,a$j.SPOTLIGHTPOS=9,a$j.SPOTLIGHTDIRECTION=10,a$j.SPOTLIGHTSPOT=11,a$j.SPOTLIGHTRANGE=12,a$j.SPOTLIGHTATTENUATION=13,a$j.SPOTLIGHTCOLOR=14,a$j.SHADOWDISTANCE=15,a$j.SHADOWLIGHTVIEWPROJECT=16,a$j.SHADOWMAPPCFOFFSET=17,a$j.SHADOWMAPTEXTURE1=18,a$j.SHADOWMAPTEXTURE2=19,a$j.SHADOWMAPTEXTURE3=20,a$j.AMBIENTCOLOR=21,a$j.TIME=22,a$j}(a$d),a$Tk=function(a$t){function a$k(a$t){a$k.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new a$tk,this._shaderValues=new a$Hk,this._colliders=[],this._id=++a$k._uniqueIDCounter,this._transform=new a$Fk(this),this.name=a$t||"Sprite3D-"+a$k._nameNumberCounter++,this.layer=a$G.currentCreationLayer,this.active=!0}a$E(a$k,"laya.d3.core.Sprite3D",a$Kk);var a$v=a$k.prototype;return a$X.imps(a$v,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),a$v._setUrl=function(a$t){this._url=a$t},a$v._getGroup=function(){return this._group},a$v._setGroup=function(a$t){this._group=a$t},a$v._addChild3D=function(a$t){a$t.transform.parent=this.transform,this._hierarchyAnimator&&(!a$t._hierarchyAnimator&&a$t._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(a$t,!0,[a$t.name])),this._scene&&(a$t._setBelongScene(this._scene),this._activeInHierarchy&&a$t._active&&a$t._activeHierarchy())},a$v._removeChild3D=function(a$t){a$t.transform.parent=null,this._scene&&(this._activeInHierarchy&&a$t._active&&a$t._inActiveHierarchy(),a$t._setUnBelongScene()),this._hierarchyAnimator&&(a$t._hierarchyAnimator==this._hierarchyAnimator&&a$t._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(a$t,!1,[a$t.name]))},a$v._parseBaseCustomProps=function(a$t){var a$k=this.transform.localPosition;a$t.translate?(a$k.fromArray(a$t.translate),a$k.x*=100,a$k.y*=100,a$k.z*=100):a$k.elements.fill(0),this.transform.localPosition=a$k;var a$v=this.transform.localRotation;a$t.rotation?a$v.fromArray(a$t.rotation):a$v.fromArray([0,0,0,-1]),this.transform.localRotation=a$v;var a$j=this.transform.localScale;a$t.scale?a$j.fromArray(a$t.scale):a$j.elements.fill(1),this.transform.localScale=a$j;var a$Q=a$t.layer;null!=a$Q&&(this.layer=a$G.getLayerByNumber(a$Q))},a$v._parseCustomComponent=function(a$t,a$k,a$v){for(var a$j in a$v){var a$Q=a$v[a$j];switch(a$j){case"Animator":var a$u=this.addComponent(Animator);if(a$Q.avatarPath)a$u.avatar=a$l.getRes(a$k[a$Q.avatarPath]);else{var a$S=a$Q.avatar;if(a$S){a$u.avatar=a$l.getRes(a$k[a$S.path]);var a$V=a$S.linkSprites;a$V&&a$t.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[a$u,a$V])}}for(var a$J=a$Q.clipPaths,a$W=a$J.length,a$w=0;a$w<a$W;a$w++)a$u.addClip(a$l.getRes(a$k[a$J[a$w]]));a$u.clip=a$l.getRes(a$k[a$J[0]]);var a$M=a$Q.playOnWake;void 0!==a$M&&(a$u.playOnWake=a$M);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var a$H=this.addComponent(SphereCollider);a$H.isTrigger=a$Q.isTrigger;var a$E=a$H.center;a$E.fromArray(a$Q.center),a$H.center=a$E,a$H.radius=a$Q.radius;break;case"BoxCollider":var a$A=this.addComponent(BoxCollider);a$A.isTrigger=a$Q.isTrigger,a$A.center.fromArray(a$Q.center);var a$R=a$A.size;a$R.fromArray(a$Q.size),a$A.size=a$R;break;case"MeshCollider":this.addComponent(MeshCollider)}}},a$v._onRootNodeHierarchyLoaded=function(a$t,a$k){for(var a$v in a$k){for(var a$j=this,a$Q=a$k[a$v],a$u=0,a$S=a$Q.length;a$u<a$S;a$u++){var a$V=a$Q[a$u];if(""===a$V)break;if(!(a$j=a$j.getChildByName(a$V)))break}a$j&&a$t.linkSprite3DToAvatarNode(a$v,a$j)}},a$v._setHierarchyAnimator=function(a$t,a$k){this._changeHierarchyAnimator(a$t);for(var a$v=0,a$j=this._childs.length;a$v<a$j;a$v++){var a$Q=this._childs[a$v];a$Q._hierarchyAnimator==a$k&&a$Q._setHierarchyAnimator(a$t,a$k)}},a$v._clearHierarchyAnimator=function(a$t,a$k){this._changeHierarchyAnimator(a$k);for(var a$v=0,a$j=this._childs.length;a$v<a$j;a$v++){var a$Q=this._childs[a$v];a$Q._hierarchyAnimator==a$t&&a$Q._clearHierarchyAnimator(a$t,a$k)}},a$v._getAnimatorToLinkSprite3D=function(a$t,a$k,a$v){var a$j=this.getComponentByType(Animator);if(a$j&&(a$j.avatar?a$j.avatar._version||a$t._setAnimatorToLinkAvatar(a$j,a$k):a$t._setAnimatorToLinkSprite3DNoAvatar(a$j,a$k,a$v)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){a$v.unshift(this._parent.name);var a$Q=this._parent;a$Q._hierarchyAnimator&&a$Q._getAnimatorToLinkSprite3D(a$t,a$k,a$v)}},a$v._setAnimatorToLinkSprite3DNoAvatar=function(a$t,a$k,a$v){var a$j=0,a$Q=0;for(a$j=0,a$Q=a$t.getClipCount();a$j<a$Q;a$j++)a$t._handleSpriteOwnersBySprite(a$j,a$k,a$v,this);for(a$j=0,a$Q=this._childs.length;a$j<a$Q;a$j++){var a$u=this._childs[a$j],a$S=a$v.length;a$v.push(a$u.name),a$u._setAnimatorToLinkSprite3DNoAvatar(a$t,a$k,a$v),a$v.splice(a$S,1)}},a$v._changeHierarchyAnimator=function(a$t){this._hierarchyAnimator=a$t},a$v._isLinkSpriteToAnimationNode=function(a$t,a$k,a$v){var a$j=a$t._avatarNodes.indexOf(a$k),a$Q=a$t._cacheSpriteToNodesMap;if(a$v)this._transform.dummy=a$k.transform,a$t._cacheNodesToSpriteMap[a$j]=a$Q.length,a$Q.push(a$j);else{this._transform.dummy=null;var a$u=a$t._cacheNodesToSpriteMap[a$j];a$t._cacheNodesToSpriteMap[a$j]=null,a$Q.splice(a$u,1)}},a$v._setBelongScene=function(a$t){this._scene=a$t;for(var a$k=0,a$v=this._childs.length;a$k<a$v;a$k++)this._childs[a$k]._setBelongScene(a$t)},a$v._setUnBelongScene=function(){this._scene=null;for(var a$t=0,a$k=this._childs.length;a$t<a$k;a$t++)this._childs[a$t]._setUnBelongScene()},a$v._activeHierarchy=function(){var a$t=0,a$k=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),a$t=0,a$k=this._colliders.length;a$t<a$k;a$t++)this._layer._addCollider(this._colliders[a$t]);for(this.event("activeinhierarchychanged",!0),a$t=0,a$k=this._childs.length;a$t<a$k;a$t++){var a$v=this._childs[a$t];a$v._active&&a$v._activeHierarchy()}},a$v._inActiveHierarchy=function(){var a$t=0,a$k=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),a$t=0,a$k=this._colliders.length;a$t<a$k;a$t++){var a$v=this._colliders[a$t];a$v._clearCollsionMap(),this._layer._removeCollider(a$v)}for(this.event("activeinhierarchychanged",!1),a$t=0,a$k=this._childs.length;a$t<a$k;a$t++){var a$j=this._childs[a$t];a$j._active&&a$j._inActiveHierarchy()}},a$v.addComponent=function(a$t){var a$k,a$v=this._componentsMap.indexOf(a$t);if(-1===a$v)a$k=[],this._componentsMap.push(a$t),this._typeComponentsIndices.push(a$k);else if(a$k=this._typeComponentsIndices[a$v],this._components[a$k[0]].isSingleton)throw new Error("无法单实例创建"+a$t+"组件，"+a$t+"组件已存在！");var a$j=a$Q.getInstance(a$t);return a$k.push(this._components.length),this._components.push(a$j),a$j instanceof laya.d3.component.Script&&this._scripts.push(a$j),a$j._initialize(this),a$j},a$v._removeComponent=function(a$t,a$k){var a$v,a$j=0,a$Q=this._typeComponentsIndices[a$t],a$u=a$Q[a$k],a$S=this._components[a$u];for(a$S instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(a$S),1),a$Q.splice(a$k,1),0===a$Q.length&&(this._typeComponentsIndices.splice(a$t,1),this._componentsMap.splice(a$t,1)),a$j=0,a$v=this._componentsMap.length;a$j<a$v;a$j++)for(var a$V=(a$Q=this._typeComponentsIndices[a$j]).length-1;0<=a$V;a$V--){var a$J=a$Q[a$V];if(!(a$u<a$J))break;a$Q[a$V]=--a$J}a$S._destroy()},a$v._clearSelfRenderObjects=function(){},a$v._addSelfRenderObjects=function(){},a$v._parseCustomProps=function(a$t,a$k,a$v,a$j){},a$v._updateChilds=function(a$t){var a$k=this._childs.length;if(0!==a$k)for(var a$v=0;a$v<a$k;++a$v)this._childs[a$v]._update(a$t)},a$v._getSortID=function(a$t,a$k){return 1e3*a$k.id+a$t._getVertexBuffer().vertexDeclaration.id},a$v._update=function(a$t){(a$t.owner=this)._activeInHierarchy&&(this._updateComponents(a$t),this._lateUpdateComponents(a$t),a$m.spriteCount++,this._childs.length&&this._updateChilds(a$t))},a$v.getProjectionViewWorldMatrix=function(a$t){return a$tk.multiply(a$t,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},a$v.loadHierarchy=function(a$t){this.addChild(laya.d3.core.Sprite3D.load(a$t))},a$v.addChildAt=function(a$t,a$k){if(!(a$t instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!a$t||this.destroyed||a$t===this)return a$t;if(a$t.zOrder&&this._set$P("hasZorder",!0),0<=a$k&&a$k<=this._childs.length){if(a$t._parent===this){var a$v=this.getChildIndex(a$t);this._childs.splice(a$v,1),this._childs.splice(a$k,0,a$t),this.conchModel&&(this.conchModel.removeChild(a$t.conchModel),this.conchModel.addChildAt(a$t.conchModel,a$k)),this._childChanged()}else a$t.parent&&a$t.parent.removeChild(a$t),this._childs===a$W.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(a$k,0,a$t),this.conchModel&&this.conchModel.addChildAt(a$t.conchModel,a$k),(a$t.parent=this)._addChild3D(a$t);return a$t}throw new Error("appendChildAt:The index is out of bounds")},a$v.addChild=function(a$t){if(!(a$t instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!a$t||this.destroyed||a$t===this)return a$t;if(a$t.zOrder&&this._set$P("hasZorder",!0),a$t._parent===this){var a$k=this.getChildIndex(a$t);a$k!==this._childs.length-1&&(this._childs.splice(a$k,1),this._childs.push(a$t),this.conchModel&&(this.conchModel.removeChild(a$t.conchModel),this.conchModel.addChildAt(a$t.conchModel,this._childs.length-1)),this._childChanged())}else a$t.parent&&a$t.parent.removeChild(a$t),this._childs===a$W.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(a$t),this.conchModel&&this.conchModel.addChildAt(a$t.conchModel,this._childs.length-1),(a$t.parent=this)._childChanged(),this._addChild3D(a$t);return a$t},a$v.removeChildAt=function(a$t){var a$k=this.getChildAt(a$t);return a$k&&(this._removeChild3D(a$k),this._childs.splice(a$t,1),this.conchModel&&this.conchModel.removeChild(a$k.conchModel),a$k.parent=null),a$k},a$v.removeChildren=function(a$t,a$k){if(void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=2147483647),this._childs&&0<this._childs.length){var a$v=this._childs;if(0===a$t&&a$u<=a$k){var a$j=a$v;this._childs=a$W.ARRAY_EMPTY}else a$j=a$v.splice(a$t,a$k-a$t);for(var a$Q=0,a$u=a$j.length;a$Q<a$u;a$Q++)this._removeChild3D(a$j[a$Q]),a$j[a$Q].parent=null,this.conchModel&&this.conchModel.removeChild(a$j[a$Q].conchModel)}return this},a$v.onAsynLoaded=function(a$t,a$k,a$v){var a$j=a$k[0];if("Sprite3D"!==a$j.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var a$Q=a$k[1];a$hk._createNodeByJson(this,a$j,this,a$Q),this.event("hierarchyloaded",[this]),this.__loaded=!0},a$v.cloneTo=function(a$t){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var a$k=a$t;a$k.name=this.name,a$k._destroyed=this._destroyed,a$k.timer=this.timer,a$k._$P=this._$P,a$k.active=this._active;var a$v=a$k.transform.localPosition;this.transform.localPosition.cloneTo(a$v),a$k.transform.localPosition=a$v;var a$j=a$k.transform.localRotation;this.transform.localRotation.cloneTo(a$j),a$k.transform.localRotation=a$j;var a$Q=a$k.transform.localScale;this.transform.localScale.cloneTo(a$Q),a$k.transform.localScale=a$Q,a$k.isStatic=this.isStatic;var a$u=0,a$S=0;for(a$u=0,a$S=this._componentsMap.length;a$u<a$S;a$u++){var a$V=a$k.addComponent(this._componentsMap[a$u]);this._components[a$u]._cloneTo(a$V)}for(a$u=0,a$S=this._childs.length;a$u<a$S;a$u++)a$k.addChild(this._childs[a$u].clone());var a$J=a$k.getComponentByType(Animator);if(a$J){var a$W=a$J._linkSpritesData;if(a$W)for(var a$w in a$W){for(var a$M=a$W[a$w],a$H=a$k,a$E=0,a$A=a$M.length;a$E<a$A&&(a$H=a$H.getChildByName(a$M[a$E]));a$E++);if(a$H){var a$R=a$J._avatarNodeMap[a$w];a$H._isLinkSpriteToAnimationNode(a$J,a$R,!0)}}}},a$v.clone=function(){var a$t=new this.constructor;return this.cloneTo(a$t),a$t},a$v.destroy=function(a$t){if(void 0===a$t&&(a$t=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,a$t);var a$k,a$v=0;for(a$v=0,a$k=this._components.length;a$v<a$k;a$v++)this._components[a$v]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,a$l.clearRes(this.url),this.loaded||a$lk._cancelLoadByUrl(this.url)}},a$v._handleSpriteToAvatar=function(a$t,a$k){a$t._avatarNodes;var a$v=a$t._avatarNodeMap[this.name];a$v&&a$v.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(a$t,a$v,a$k)},a$v._setAnimatorToLinkAvatar=function(a$t,a$k){this._handleSpriteToAvatar(a$t,a$k);for(var a$v=0,a$j=this._childs.length;a$v<a$j;a$v++){this._childs[a$v]._setAnimatorToLinkAvatar(a$t,a$k)}},a$A(0,a$v,"activeInHierarchy",function(){return this._activeInHierarchy}),a$A(0,a$v,"_loaded",null,function(a$t){this.__loaded=a$t}),a$A(0,a$v,"active",function(){return this._active},function(a$t){this._active!==a$t&&(this._active=a$t,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(a$t?this._activeHierarchy():this._inActiveHierarchy()))}),a$A(0,a$v,"componentsCount",function(){return this._components.length}),a$A(0,a$v,"loaded",function(){return this.__loaded}),a$A(0,a$v,"id",function(){return this._id}),a$A(0,a$v,"url",function(){return this._url}),a$A(0,a$v,"layer",function(){return this._layer},function(a$t){if(this._layer!==a$t){if(!a$t)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var a$k=0,a$v=this._colliders.length;if(this._layer)for(a$k=0;a$k<a$v;a$k++)this._layer._removeCollider(this._colliders[a$k]);for(a$k=0;a$k<a$v;a$k++)a$t._addCollider(this._colliders[a$k])}this._layer=a$t,this.event("layerchanged",a$t)}}),a$A(0,a$v,"scene",function(){return this._scene}),a$A(0,a$v,"transform",function(){return this._transform}),a$k.instantiate=function(a$t,a$k,a$v,a$j,a$Q){void 0===a$v&&(a$v=!0);var a$u=a$t.clone();a$k&&a$k.addChild(a$u);var a$S=a$u.transform;if(a$v){var a$V=a$S.worldMatrix;a$t.transform.worldMatrix.cloneTo(a$V),a$S.worldMatrix=a$V}else a$j&&(a$S.position=a$j),a$Q&&(a$S.rotation=a$Q);return a$u},a$k.load=function(a$t){return a$X.loader.create(a$t,null,null,a$k)},a$k.WORLDMATRIX=0,a$k.MVPMATRIX=1,a$k._uniqueIDCounter=0,a$k._nameNumberCounter=0,a$k}(),a$pk=function(a$t){function a$w(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],a$w.__super.call(this),!a$t||!a$k)throw"Shader Error";this._id=++a$w._count,this._vs=a$t,this._ps=a$k,this._attributeMap=a$v,this._sceneUniformMap=a$j,this._cameraUniformMap=a$Q,this._spriteUniformMap=a$u,this._materialUniformMap=a$S,this._renderElementUniformMap=a$V,this._precompile=a$J,this._define=a$W,this._precompile&&a$w.extCompileObj&&a$w.extCompileFunc?a$w.extCompileFunc.call(a$w.extCompileObj,a$t,a$k,a$W):this.recreateResource()}a$E(a$w,"laya.d3.shader.Shader3D",a$v);var a$k=a$w.prototype;return a$k.recreateResource=function(){a$z.now();this._compile(),this.completeCreate(),this.memorySize=0},a$k.disposeResource=function(){a$N.mainContext.deleteShader(this._vshader),a$N.mainContext.deleteShader(this._pshader),a$N.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},a$k._compile=function(){if(!a$N.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var a$t=[this._vs,this._ps],a$k=a$N.mainContext;if(this._program=a$k.createProgram(),this._vshader=a$w._createShader(a$k,a$t[0],35633),this._pshader=a$w._createShader(a$k,a$t[1],35632),a$k.attachShader(this._program,this._vshader),a$k.attachShader(this._program,this._pshader),a$k.linkProgram(this._program),!a$R.isConchApp&&a$mk.debugMode&&!a$k.getProgramParameter(this._program,35714))throw a$k.getProgramInfoLog(this._program);var a$v,a$j=0,a$Q=0,a$u=0;for(a$u=a$R.isConchApp?a$k.getProgramParameterEx(this._vs,this._ps,"",35721):a$k.getProgramParameter(this._program,35721),a$j=0;a$j<a$u;a$j++){var a$S=null;a$v={vartype:"attribute",ivartype:0,attrib:a$S=a$R.isConchApp?a$k.getActiveAttribEx(this._vs,this._ps,"",a$j):a$k.getActiveAttrib(this._program,a$j),location:a$k.getAttribLocation(this._program,a$S.name),name:a$S.name,type:a$S.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(a$v)}var a$V=0;for(a$V=a$R.isConchApp?a$k.getProgramParameterEx(this._vs,this._ps,"",35718):a$k.getProgramParameter(this._program,35718),a$j=0;a$j<a$V;a$j++){var a$J=null;a$J=a$R.isConchApp?a$k.getActiveUniformEx(this._vs,this._ps,"",a$j):a$k.getActiveUniform(this._program,a$j),0<(a$v={vartype:"uniform",ivartype:1,attrib:a$S,location:a$k.getUniformLocation(this._program,a$J.name),name:a$J.name,type:a$J.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(a$v.name=a$v.name.substr(0,a$v.name.length-3),a$v.isArray=!0,a$v.location=a$k.getUniformLocation(this._program,a$v.name)),this._uniformParams.push(a$v)}for(a$j=0,a$Q=this._attributeParams.length;a$j<a$Q;a$j++)(a$v=this._attributeParams[a$j]).indexOfParams=a$j,a$v.index=1,a$v.value=[a$v.location,null],a$v.codename=a$v.name,a$v.name=null!=this._attributeMap[a$v.codename]?this._attributeMap[a$v.codename]:a$v.codename,this._attributeParamsMap.push(a$v.name),this._attributeParamsMap.push(a$v),a$v._this=this,a$v.uploadedValue=[],a$v.fun=this._attribute;for(a$j=0,a$Q=this._uniformParams.length;a$j<a$Q;a$j++)switch((a$v=this._uniformParams[a$j]).indexOfParams=a$j,a$v.index=1,a$v.value=[a$v.location,null],a$v.codename=a$v.name,null!=this._sceneUniformMap[a$v.codename]?(a$v.name=this._sceneUniformMap[a$v.codename],this._sceneUniformParamsMap.push(a$v.name),this._sceneUniformParamsMap.push(a$v)):null!=this._cameraUniformMap[a$v.codename]?(a$v.name=this._cameraUniformMap[a$v.codename],this._cameraUniformParamsMap.push(a$v.name),this._cameraUniformParamsMap.push(a$v)):null!=this._spriteUniformMap[a$v.codename]?(a$v.name=this._spriteUniformMap[a$v.codename],this._spriteUniformParamsMap.push(a$v.name),this._spriteUniformParamsMap.push(a$v)):null!=this._materialUniformMap[a$v.codename]?(a$v.name=this._materialUniformMap[a$v.codename],this._materialUniformParamsMap.push(a$v.name),this._materialUniformParamsMap.push(a$v)):null!=this._renderElementUniformMap[a$v.codename]?(a$v.name=this._renderElementUniformMap[a$v.codename],this._renderElementUniformParamsMap.push(a$v.name),this._renderElementUniformParamsMap.push(a$v)):console.log("Shader:can't find uinform name:"+a$v.codename+" in shader file."),a$v._this=this,a$v.uploadedValue=[],a$v.type){case 5124:a$v.fun=a$v.isArray?this._uniform1iv:this._uniform1i;break;case 5126:a$v.fun=a$v.isArray?this._uniform1fv:this._uniform1f;break;case 35664:a$v.fun=a$v.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:a$v.fun=a$v.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:a$v.fun=a$v.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:a$v.fun=this._uniform_sampler2D;break;case 35680:a$v.fun=this._uniform_samplerCube;break;case 35676:a$v.fun=this._uniformMatrix4fv;break;case 35670:a$v.fun=this._uniform1i;break;case 35674:a$v.fun=this._uinformMatrix2fv;break;case 35675:a$v.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},a$k._attribute=function(a$t,a$k){var a$v=a$N.mainContext,a$j=a$V._enableAtributes,a$Q=a$t.location;return a$j[a$Q]||a$v.enableVertexAttribArray(a$Q),a$v.vertexAttribPointer(a$Q,a$k[0],a$k[1],a$k[2],a$k[3],a$k[4]),a$j[a$Q]=a$V._bindVertexBuffer,1},a$k._uniform1f=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k?(a$N.mainContext.uniform1f(a$t.location,a$v[0]=a$k),1):0},a$k._uniform1fv=function(a$t,a$k){if(a$k.length<4){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]||a$v[2]!==a$k[2]||a$v[3]!==a$k[3]?(a$N.mainContext.uniform1fv(a$t.location,a$k),a$v[0]=a$k[0],a$v[1]=a$k[1],a$v[2]=a$k[2],a$v[3]=a$k[3],1):0}return a$N.mainContext.uniform1fv(a$t.location,a$k),1},a$k._uniform_vec2=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]?(a$N.mainContext.uniform2f(a$t.location,a$v[0]=a$k[0],a$v[1]=a$k[1]),1):0},a$k._uniform_vec2v=function(a$t,a$k){if(a$k.length<2){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]||a$v[2]!==a$k[2]||a$v[3]!==a$k[3]?(a$N.mainContext.uniform2fv(a$t.location,a$k),a$v[0]=a$k[0],a$v[1]=a$k[1],a$v[2]=a$k[2],a$v[3]=a$k[3],1):0}return a$N.mainContext.uniform2fv(a$t.location,a$k),1},a$k._uniform_vec3=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]||a$v[2]!==a$k[2]?(a$N.mainContext.uniform3f(a$t.location,a$v[0]=a$k[0],a$v[1]=a$k[1],a$v[2]=a$k[2]),1):0},a$k._uniform_vec3v=function(a$t,a$k){return a$N.mainContext.uniform3fv(a$t.location,a$k),1},a$k._uniform_vec4=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]||a$v[2]!==a$k[2]||a$v[3]!==a$k[3]?(a$N.mainContext.uniform4f(a$t.location,a$v[0]=a$k[0],a$v[1]=a$k[1],a$v[2]=a$k[2],a$v[3]=a$k[3]),1):0},a$k._uniform_vec4v=function(a$t,a$k){return a$N.mainContext.uniform4fv(a$t.location,a$k),1},a$k._uniformMatrix2fv=function(a$t,a$k){return a$N.mainContext.uniformMatrix2fv(a$t.location,!1,a$k),1},a$k._uniformMatrix3fv=function(a$t,a$k){return a$N.mainContext.uniformMatrix3fv(a$t.location,!1,a$k),1},a$k._uniformMatrix4fv=function(a$t,a$k){return a$N.mainContext.uniformMatrix4fv(a$t.location,!1,a$k),1},a$k._uinformMatrix2fv=function(a$t,a$k){return a$N.mainContext.uniformMatrix2fv(a$t.location,!1,a$k),1},a$k._uinformMatrix3fv=function(a$t,a$k){return a$N.mainContext.uniformMatrix3fv(a$t.location,!1,a$k),1},a$k._uniform1i=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k?(a$N.mainContext.uniform1i(a$t.location,a$v[0]=a$k),1):0},a$k._uniform1iv=function(a$t,a$k){return a$N.mainContext.uniform1iv(a$t.location,a$k),1},a$k._uniform_ivec2=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]?(a$N.mainContext.uniform2i(a$t.location,a$v[0]=a$k[0],a$v[1]=a$k[1]),1):0},a$k._uniform_ivec2v=function(a$t,a$k){return a$N.mainContext.uniform2iv(a$t.location,a$k),1},a$k._uniform_vec3i=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]||a$v[2]!==a$k[2]?(a$N.mainContext.uniform3i(a$t.location,a$v[0]=a$k[0],a$v[1]=a$k[1],a$v[2]=a$k[2]),1):0},a$k._uniform_vec3vi=function(a$t,a$k){return a$N.mainContext.uniform3iv(a$t.location,a$k),1},a$k._uniform_vec4i=function(a$t,a$k){var a$v=a$t.uploadedValue;return a$v[0]!==a$k[0]||a$v[1]!==a$k[1]||a$v[2]!==a$k[2]||a$v[3]!==a$k[3]?(a$N.mainContext.uniform4i(a$t.location,a$v[0]=a$k[0],a$v[1]=a$k[1],a$v[2]=a$k[2],a$v[3]=a$k[3]),1):0},a$k._uniform_vec4vi=function(a$t,a$k){return a$N.mainContext.uniform4iv(a$t.location,a$k),1},a$k._uniform_sampler2D=function(a$t,a$k){var a$v=a$k.source||a$k.defaulteTexture.source,a$j=a$N.mainContext,a$Q=a$t.uploadedValue;if(null!=a$Q[0])return a$j.activeTexture(a$w._TEXTURES[a$Q[0]]),a$v&&a$a.bindTexture(a$j,3553,a$v),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return a$Q[0]=this._curActTexIndex,a$j.uniform1i(a$t.location,this._curActTexIndex),a$j.activeTexture(a$w._TEXTURES[this._curActTexIndex]),a$v&&a$a.bindTexture(a$j,3553,a$v),this._curActTexIndex++,1},a$k._uniform_samplerCube=function(a$t,a$k){var a$v=a$k.source||a$k.defaulteTexture.source,a$j=a$N.mainContext,a$Q=a$t.uploadedValue;if(null!=a$Q[0])return a$j.activeTexture(a$w._TEXTURES[a$Q[0]]),a$v?a$a.bindTexture(a$j,34067,a$v):a$a.bindTexture(a$j,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return a$Q[0]=this._curActTexIndex,a$j.uniform1i(a$t.location,this._curActTexIndex),a$j.activeTexture(a$w._TEXTURES[this._curActTexIndex]),a$v?a$a.bindTexture(a$j,34067,a$v):a$a.bindTexture(a$j,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},a$k._noSetValue=function(a$t){console.log("no....:"+a$t.name)},a$k.bind=function(){return a$v.activeShader=this,(a$v.bindShader=this).activeResource(),a$a.UseProgram(this._program)},a$k.uploadAttributes=function(a$t,a$k){for(var a$v,a$j,a$Q=0,a$u=0,a$S=this._attributeParamsMap.length;a$u<a$S;a$u+=2)a$j=this._attributeParamsMap[a$u+1],null!=(a$v=a$t[this._attributeParamsMap[a$u]])&&(a$k&&a$k[a$j.name]&&a$k[a$j.name].bind(),a$Q+=a$j.fun.call(this,a$j,a$v));a$m.shaderCall+=a$Q},a$k.uploadAttributesX=function(a$t,a$k){for(var a$v,a$j,a$Q=0,a$u=0,a$S=this._attributeParamsMap.length;a$u<a$S;a$u+=2)a$j=this._attributeParamsMap[a$u+1],null!=(a$v=a$t[this._attributeParamsMap[a$u]])&&(a$k._bind(),a$Q+=a$j.fun.call(this,a$j,a$v));a$m.shaderCall+=a$Q},a$k.uploadSceneUniforms=function(a$t){for(var a$k,a$v,a$j=0,a$Q=0,a$u=this._sceneUniformParamsMap.length;a$Q<a$u;a$Q+=2)a$v=this._sceneUniformParamsMap[a$Q+1],null!=(a$k=a$t[this._sceneUniformParamsMap[a$Q]])&&(a$j+=a$v.fun.call(this,a$v,a$k));a$m.shaderCall+=a$j},a$k.uploadCameraUniforms=function(a$t){for(var a$k,a$v,a$j=0,a$Q=0,a$u=this._cameraUniformParamsMap.length;a$Q<a$u;a$Q+=2)a$v=this._cameraUniformParamsMap[a$Q+1],null!=(a$k=a$t[this._cameraUniformParamsMap[a$Q]])&&(a$j+=a$v.fun.call(this,a$v,a$k));a$m.shaderCall+=a$j},a$k.uploadSpriteUniforms=function(a$t){for(var a$k,a$v,a$j=0,a$Q=0,a$u=this._spriteUniformParamsMap.length;a$Q<a$u;a$Q+=2)a$v=this._spriteUniformParamsMap[a$Q+1],null!=(a$k=a$t[this._spriteUniformParamsMap[a$Q]])&&(a$j+=a$v.fun.call(this,a$v,a$k));a$m.shaderCall+=a$j},a$k.uploadMaterialUniforms=function(a$t){for(var a$k,a$v,a$j=0,a$Q=0,a$u=this._materialUniformParamsMap.length;a$Q<a$u;a$Q+=2)a$v=this._materialUniformParamsMap[a$Q+1],null!=(a$k=a$t[this._materialUniformParamsMap[a$Q]])&&(a$j+=a$v.fun.call(this,a$v,a$k));a$m.shaderCall+=a$j},a$k.uploadRenderElementUniforms=function(a$t){for(var a$k,a$v,a$j=0,a$Q=0,a$u=this._renderElementUniformParamsMap.length;a$Q<a$u;a$Q+=2)a$v=this._renderElementUniformParamsMap[a$Q+1],null!=(a$k=a$t[this._renderElementUniformParamsMap[a$Q]])&&(a$j+=a$v.fun.call(this,a$v,a$k));a$m.shaderCall+=a$j},a$w.create=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){return new a$w(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W)},a$w.addInclude=function(a$t,a$k){a$Y.addInclude(a$t,a$k)},a$w._createShader=function(a$t,a$k,a$v){var a$j=a$t.createShader(a$v);if(a$t.shaderSource(a$j,a$k),a$t.compileShader(a$j),a$mk.debugMode&&!a$t.getShaderParameter(a$j,35713))throw a$t.getShaderInfoLog(a$j);return a$j},a$w.PERIOD_RENDERELEMENT=0,a$w.PERIOD_MATERIAL=1,a$w.PERIOD_SPRITE=2,a$w.PERIOD_CAMERA=3,a$w.PERIOD_SCENE=4,a$w._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],a$w._count=0,a$w._preCompile=!1,a$w.extCompileFunc=null,a$w.extCompileObj=null,a$M(a$w,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new a$Z}]),a$w}(),a$Ok=function(a$V){function a$J(){this._transformUV=null,a$J.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new a$Sk(.6,.6,.6)),this._setColor(10,new a$Sk(1,1,1)),this._setColor(11,new a$Vk(1,1,1,8)),this._setColor(12,new a$Sk(1,1,1)),this._setColor(7,new a$Vk(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new a$Vk(1,1,0,0)),this.renderMode=1}a$E(a$J,"laya.d3.core.material.StandardMaterial",a$V);var a$t=a$J.prototype;return a$t.disableLight=function(){this._addDisablePublicShaderDefine(a$mk.SHADERDEFINE_POINTLIGHT|a$mk.SHADERDEFINE_SPOTLIGHT|a$mk.SHADERDEFINE_DIRECTIONLIGHT)},a$t.disableFog=function(){this._addDisablePublicShaderDefine(a$mk.SHADERDEFINE_FOG)},a$t.onAsynLoaded=function(a$t,a$k,a$v){var a$j=a$k[0];if(a$j.version)a$V.prototype.onAsynLoaded.call(this,a$t,a$k,a$v);else{var a$Q=a$k[1],a$u=a$j.props;for(var a$S in a$u)this[a$S]=a$u[a$S];a$J._parseStandardMaterial(a$Q,this,a$j),this._endLoaded()}},a$t.cloneTo=function(a$t){a$V.prototype.cloneTo.call(this,a$t);var a$k=a$t;this._transformUV&&(a$k._transformUV=this._transformUV.clone())},a$A(0,a$t,"ambientColor",function(){return this._getColor(9)},function(a$t){this._setColor(9,a$t)}),a$A(0,a$t,"ambientTexture",function(){return this._getTexture(5)},function(a$t){a$t?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,a$t)}),a$A(0,a$t,"renderMode",null,function(a$t){switch(a$t){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(a$J.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(a$t)}),a$A(0,a$t,"reflectColor",function(){return this._getColor(12)},function(a$t){this._setColor(12,a$t)}),a$A(0,a$t,"tilingOffset",function(){return this._getColor(15)},function(a$t){if(a$t){var a$k=a$t.elements;1!=a$k[0]||1!=a$k[1]||0!=a$k[2]||0!=a$k[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,a$t)}),a$A(0,a$t,"albedo",function(){return this._getColor(7)},function(a$t){this._setColor(7,a$t)}),a$A(0,a$t,"diffuseColor",function(){return this._getColor(10)},function(a$t){this._setColor(10,a$t)}),a$A(0,a$t,"albedoColor",function(){return this._getColor(7)},function(a$t){this._setColor(7,a$t)}),a$A(0,a$t,"specularColor",function(){return this._getColor(11)},function(a$t){this._setColor(11,a$t)}),a$A(0,a$t,"diffuseTexture",function(){return this._getTexture(1)},function(a$t){a$t?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,a$t)}),a$A(0,a$t,"normalTexture",function(){return this._getTexture(2)},function(a$t){a$t?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,a$t)}),a$A(0,a$t,"specularTexture",function(){return this._getTexture(3)},function(a$t){a$t?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,a$t)}),a$A(0,a$t,"emissiveTexture",function(){return this._getTexture(4)},function(a$t){a$t?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,a$t)}),a$A(0,a$t,"reflectTexture",function(){return this._getTexture(6)},function(a$t){a$t?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,a$t)}),a$A(0,a$t,"transformUV",function(){return this._transformUV},function(a$t){this._transformUV=a$t,this._setMatrix4x4(13,a$t.matrix),a$t?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,a$t.matrix.elements,0)}),a$J.__init__=function(){a$J.SHADERDEFINE_DIFFUSEMAP=a$J.shaderDefines.registerDefine("DIFFUSEMAP"),a$J.SHADERDEFINE_NORMALMAP=a$J.shaderDefines.registerDefine("NORMALMAP"),a$J.SHADERDEFINE_SPECULARMAP=a$J.shaderDefines.registerDefine("SPECULARMAP"),a$J.SHADERDEFINE_EMISSIVEMAP=a$J.shaderDefines.registerDefine("EMISSIVEMAP"),a$J.SHADERDEFINE_AMBIENTMAP=a$J.shaderDefines.registerDefine("AMBIENTMAP"),a$J.SHADERDEFINE_REFLECTMAP=a$J.shaderDefines.registerDefine("REFLECTMAP"),a$J.SHADERDEFINE_UVTRANSFORM=a$J.shaderDefines.registerDefine("UVTRANSFORM"),a$J.SHADERDEFINE_TILINGOFFSET=a$J.shaderDefines.registerDefine("TILINGOFFSET"),a$J.SHADERDEFINE_ADDTIVEFOG=a$J.shaderDefines.registerDefine("ADDTIVEFOG")},a$J.load=function(a$t){return a$X.loader.create(a$t,null,null,a$J)},a$J._parseStandardMaterial=function(a$t,a$k,a$v){var a$j=a$v.customProps,a$Q=a$j.ambientColor;a$k.ambientColor=new a$Sk(a$Q[0],a$Q[1],a$Q[2]);var a$u=a$j.diffuseColor;a$k.diffuseColor=new a$Sk(a$u[0],a$u[1],a$u[2]);var a$S=a$j.specularColor;a$k.specularColor=new a$Vk(a$S[0],a$S[1],a$S[2],a$S[3]);var a$V=a$j.reflectColor;a$k.reflectColor=new a$Sk(a$V[0],a$V[1],a$V[2]);var a$J=a$j.albedoColor;a$J&&(a$k.albedo=new a$Vk(a$J[0],a$J[1],a$J[2],a$J[3]));var a$W=a$j.diffuseTexture.texture2D;a$W&&(a$k.diffuseTexture=a$l.getRes(a$t[a$W]));var a$w=a$j.normalTexture.texture2D;a$w&&(a$k.normalTexture=a$l.getRes(a$t[a$w]));var a$M=a$j.specularTexture.texture2D;a$M&&(a$k.specularTexture=a$l.getRes(a$t[a$M]));var a$H=a$j.emissiveTexture.texture2D;a$H&&(a$k.emissiveTexture=a$l.getRes(a$t[a$H]));var a$E=a$j.ambientTexture.texture2D;a$E&&(a$k.ambientTexture=a$l.getRes(a$t[a$E]));var a$A=a$j.reflectTexture.texture2D;a$A&&(a$k.reflectTexture=a$l.getRes(a$t[a$A]))},a$J.RENDERMODE_OPAQUE=1,a$J.RENDERMODE_OPAQUEDOUBLEFACE=2,a$J.RENDERMODE_CUTOUT=3,a$J.RENDERMODE_CUTOUTDOUBLEFACE=4,a$J.RENDERMODE_TRANSPARENT=13,a$J.RENDERMODE_TRANSPARENTDOUBLEFACE=14,a$J.RENDERMODE_ADDTIVE=15,a$J.RENDERMODE_ADDTIVEDOUBLEFACE=16,a$J.RENDERMODE_DEPTHREAD_TRANSPARENT=5,a$J.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,a$J.RENDERMODE_DEPTHREAD_ADDTIVE=7,a$J.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,a$J.RENDERMODE_NONDEPTH_TRANSPARENT=9,a$J.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,a$J.RENDERMODE_NONDEPTH_ADDTIVE=11,a$J.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,a$J.SHADERDEFINE_DIFFUSEMAP=0,a$J.SHADERDEFINE_NORMALMAP=0,a$J.SHADERDEFINE_SPECULARMAP=0,a$J.SHADERDEFINE_EMISSIVEMAP=0,a$J.SHADERDEFINE_AMBIENTMAP=0,a$J.SHADERDEFINE_REFLECTMAP=0,a$J.SHADERDEFINE_UVTRANSFORM=0,a$J.SHADERDEFINE_TILINGOFFSET=0,a$J.SHADERDEFINE_ADDTIVEFOG=0,a$J.DIFFUSETEXTURE=1,a$J.NORMALTEXTURE=2,a$J.SPECULARTEXTURE=3,a$J.EMISSIVETEXTURE=4,a$J.AMBIENTTEXTURE=5,a$J.REFLECTTEXTURE=6,a$J.ALBEDO=7,a$J.UVANIAGE=8,a$J.MATERIALAMBIENT=9,a$J.MATERIALDIFFUSE=10,a$J.MATERIALSPECULAR=11,a$J.MATERIALREFLECT=12,a$J.UVMATRIX=13,a$J.UVAGE=14,a$J.TILINGOFFSET=15,a$M(a$J,["defaultMaterial",function(){var a$t=new a$J;return a$t.lock=!0,this.defaultMaterial=a$t},"shaderDefines",function(){return this.shaderDefines=new a$wk(a$Uk.shaderDefines)}]),a$J}(a$Uk),a$nk=function(a$t){function a$S(a$t,a$k,a$v,a$j,a$Q){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===a$v&&(a$v=35044),void 0===a$j&&(a$j=!1),a$S.__super.call(this),this._indexType=a$t,this._indexCount=a$k,this._bufferUsage=a$v,this._bufferType=34963,this._canRead=a$j;var a$u;if("ushort"==a$t)this._indexTypeByteCount=2;else{if("ubyte"!=a$t)throw new Error("unidentification index type.");this._indexTypeByteCount=1}a$u=this._indexTypeByteCount*a$k,this._byteLength=a$u,this._bind(),a$V._gl.bufferData(this._bufferType,a$u,this._bufferUsage),this.uri=a$Q,a$j?("ushort"==a$t?this._buffer=new Uint16Array(a$k):"ubyte"==a$t&&(this._buffer=new Uint8Array(a$k)),this.memorySize=2*a$u):this.memorySize=a$u}a$E(a$S,"laya.d3.graphics.IndexBuffer3D",a$t);var a$k=a$S.prototype;return a$k.setData=function(a$t,a$k,a$v,a$j){void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=4294967295);var a$Q=0;if("ushort"==this._indexType?(a$Q=2,0===a$v&&4294967295===a$j||(a$t=new Uint16Array(a$t.buffer,a$v*a$Q,a$j))):"ubyte"==this._indexType&&(a$Q=1,0===a$v&&4294967295===a$j||(a$t=new Uint8Array(a$t.buffer,a$v*a$Q,a$j))),this._bind(),a$V._gl.bufferSubData(this._bufferType,a$k*a$Q,a$t),this._canRead)if(0!==a$k||0!==a$v||4294967295!==a$j){var a$u=this._buffer.length-a$k;a$u<a$j&&(a$j=a$u);for(var a$S=0;a$S<a$j;a$S++)this._buffer[a$k+a$S]=a$t[a$S]}else this._buffer=a$t},a$k.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},a$k.disposeResource=function(){a$t.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},a$A(0,a$k,"indexType",function(){return this._indexType}),a$A(0,a$k,"indexTypeByteCount",function(){return this._indexTypeByteCount}),a$A(0,a$k,"indexCount",function(){return this._indexCount}),a$A(0,a$k,"canRead",function(){return this._canRead}),a$S.INDEXTYPE_UBYTE="ubyte",a$S.INDEXTYPE_USHORT="ushort",a$S.create=function(a$t,a$k,a$v,a$j,a$Q){return void 0===a$v&&(a$v=35044),void 0===a$j&&(a$j=!1),new a$S(a$t,a$k,a$v,a$j,a$Q)},a$S}(a$V),a$_k=function(a$u){function a$S(a$t,a$k,a$v,a$j,a$Q){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===a$j&&(a$j=!1),a$S.__super.call(this),this._vertexDeclaration=a$t,this._vertexCount=a$k,this._bufferUsage=a$v,this._bufferType=34962,this._canRead=a$j,this.uri=a$Q,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*a$k,this._bind(),a$V._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),a$j&&(this._buffer=new Float32Array(this._byteLength/4))}a$E(a$S,"laya.d3.graphics.VertexBuffer3D",a$u);var a$t=a$S.prototype;return a$t.bindWithIndexBuffer=function(a$t){a$t&&a$t._bind(),this._bind()},a$t.setData=function(a$t,a$k,a$v,a$j){if(void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=4294967295),0===a$v&&4294967295===a$j||(a$t=new Float32Array(a$t.buffer,4*a$v,a$j)),this._bind(),a$V._gl.bufferSubData(this._bufferType,4*a$k,a$t),this._canRead)if(0!==a$k||0!==a$v||4294967295!==a$j){var a$Q=this._buffer.length-a$k;a$Q<a$j&&(a$j=a$Q);for(var a$u=0;a$u<a$j;a$u++)this._buffer[a$k+a$u]=a$t[a$u]}else this._buffer=a$t},a$t.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},a$t.disposeResource=function(){for(var a$t=a$N.mainContext,a$k=this._vertexDeclaration.getVertexElements(),a$v=a$V._enableAtributes,a$j=0,a$Q=a$k.length;a$j<a$Q;a$j++)a$v[a$j]===this._glBuffer&&(a$t.disableVertexAttribArray(a$j),a$v[a$j]=null);a$u.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},a$A(0,a$t,"vertexDeclaration",function(){return this._vertexDeclaration}),a$A(0,a$t,"vertexCount",function(){return this._vertexCount}),a$A(0,a$t,"canRead",function(){return this._canRead}),a$S.create=function(a$t,a$k,a$v,a$j,a$Q){return void 0===a$v&&(a$v=35044),void 0===a$j&&(a$j=!1),new a$S(a$t,a$k,a$v,a$j,a$Q)},a$S}(a$V),a$xk=function(a$t){function a$Y(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,a$Y.__super.call(this),this._type=3553}a$E(a$Y,"laya.d3.resource.DataTexture2D",a$Nk);var a$k=a$Y.prototype;return a$k.genDebugMipmaps=function(){var a$t=[];return a$t.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),a$t.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),a$t.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),a$t.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),a$t.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),a$t.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),a$t.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),a$t.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),a$t.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),a$t.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),a$t},a$k._onTextureLoaded=function(a$t){},a$k._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var a$t=a$N.mainContext,a$k=this._source=a$t.createTexture(),a$v=this._width,a$j=this._height,a$Q=a$a.curBindTexTarget,a$u=a$a.curBindTexValue,a$S=!1;if(a$a.bindTexture(a$t,this._type,a$k),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var a$V=0;a$t.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var a$J=0;a$J<this._mipmaps.length;a$J++){if(this._mipmaps[a$J].byteLength!=a$W*a$w*4)throw"mipmap size error  level:"+a$J;a$t.texSubImage2D(this._type,0,a$Y.simLodRect[a$V++],a$Y.simLodRect[a$V++],a$Y.simLodRect[a$V++],a$Y.simLodRect[a$V++],6408,5121,new Uint8Array(this._mipmaps[a$J]))}this.minFifter=9729,this.magFifter=9729}else{var a$W=this._width,a$w=this._height;for(a$V=0,a$t.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),a$J=0;a$J<this._mipmaps.length;a$J++){if(this._mipmaps[a$J].byteLength!=a$W*a$w*4)throw"mipmap size error  level:"+a$J;a$t.texImage2D(this._type,a$J,6408,a$W,a$w,0,6408,5121,new Uint8Array(this._mipmaps[a$J])),(a$W/=2)<1&&(a$W=1),(a$w/=2)<1&&(a$w=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&a$t.pixelStorei(a$t.UNPACK_ALIGNMENT,1),a$t.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var a$M=0,a$H=!1,a$E=!1;this._buffer.byteLength==4*a$v*a$j?(a$M=6408,a$H=!0):this._buffer.byteLength==3*a$v*a$j?(a$M=6407,a$E=!0):a$M=this._format,a$H||a$E?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),a$E&&a$t.pixelStorei(a$t.UNPACK_ALIGNMENT,1),a$t.texImage2D(this._type,0,a$M,a$v,a$j,0,a$M,5121,this._buffer)):a$t&&a$M==a$t.ALPHA?(a$t.texImage2D(3553,0,a$M,a$v,a$j,0,a$M,a$t.UNSIGNED_BYTE,this._buffer),a$S=!0):0!=a$M&&(a$t.compressedTexImage2D(3553,0,a$M,a$v,a$j,0,this._buffer),a$S=!0)}var a$A=this._minFifter,a$R=this._magFifter,a$h=0==this._wrapModeU?10497:33071,a$l=0==this._wrapModeV?10497:33071,a$o=a$f.isPOT(a$v,a$j);a$o?(this._mipmap||this._mipmaps?-1!==a$A||(a$A=9987):-1!==a$A||(a$A=9729),-1!==a$R||(a$R=9729),a$t.texParameteri(this._type,10241,a$A),a$t.texParameteri(this._type,10240,a$R),a$t.texParameteri(this._type,10242,a$h),a$t.texParameteri(this._type,10243,a$l),this._mipmap&&a$t.generateMipmap(this._type)):(-1!==a$A||(a$A=9729),-1!==a$R||(a$R=9729),a$t.texParameteri(this._type,10241,a$A),a$t.texParameteri(this._type,10240,a$R),a$t.texParameteri(this._type,10242,33071),a$t.texParameteri(this._type,10243,33071)),a$Q&&a$u&&a$a.bindTexture(a$t,a$Q,a$u),this.memorySize=a$S?this._buffer.length:a$o?a$v*a$j*4*(1+1/3):a$v*a$j*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},a$k.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},a$k.onAsynLoaded=function(a$t,a$k,a$v){var a$j;a$v&&(a$j=a$v[0].call(this,a$k)),a$j&&(this._width=a$j.width,this._height=a$j.height,this._buffer=a$j.data),this._src=a$t,this._size=new a$Rk(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},a$k.getPixels=function(){return new Uint8Array(this._buffer)},a$k.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(a$N.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},a$A(0,a$k,"src",function(){return this._src}),a$Y.create=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){if(void 0===a$j&&(a$j=9729),void 0===a$Q&&(a$Q=9729),void 0===a$u&&(a$u=!0),!a$t||a$t.byteLength<a$k*a$v*4)throw"DataTexture2D create error";var a$V=new a$Y;return a$V.uri=a$S,a$V._buffer=a$t,a$V._width=a$k,a$V._height=a$v,a$V._mipmap=a$u,a$V._magFifter=a$j,a$V._minFifter=a$Q,a$V._size=new a$Rk(a$V._width,a$V._height),a$V._conchTexture?alert("怎么给runtime传递datatexture数据"):a$V.activeResource(),a$V},a$Y.load=function(a$t,a$k,a$v,a$j,a$Q){if(void 0===a$k&&(a$k=0),void 0===a$v&&(a$v=0),void 0===a$j&&(a$j=9729),void 0===a$Q&&(a$Q=9729),"mipmaps"===a$s.getFileExtension(a$t)){var a$u=a$X.loader.create(a$t,null,null,a$Y,[function(a$t){this._mipmaps=[];var a$k=new Uint32Array(a$t);this._width=a$k[0];var a$v=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,a$v=1024),this._width!=a$v)throw"现在只支持512x256的环境贴图。当前的是"+a$k[0];this._height=a$k[1];for(var a$j=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,a$Q=this._height,a$u=8;;){var a$S=a$j*a$Q*4;if(a$u+a$S>a$t.byteLength)throw"load mipmaps data size error ";var a$V=new Uint8Array(a$t,a$u,a$S);if(this._mipmaps.push(a$V),a$u+=a$S,1==a$j&&1==a$Q)break;(a$j/=2)<1&&(a$j=1),(a$Q/=2)<1&&(a$Q=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){a$u.simLodInfo=new Float32Array(40);for(var a$S=0;a$S<a$u.simLodInfo.length;)a$u.simLodInfo[a$S]=(a$Y.simLodRect[a$S]+.5)/1024,a$S++,a$u.simLodInfo[a$S]=(a$Y.simLodRect[a$S]+.5)/256,a$S++,a$u.simLodInfo[a$S]=Math.max(a$Y.simLodRect[a$S]-1,.1)/1024,a$S++,a$u.simLodInfo[a$S]=Math.max(a$Y.simLodRect[a$S]-1.5,.1)/256,a$S++}return a$u}if("number"==typeof a$k)return a$X.loader.create(a$t,null,null,a$Y,[function(a$t){return this._width=a$k,this._height=a$v,this._buffer=a$t,null}]);if("function"==typeof a$k)return a$X.loader.create(a$t,null,null,a$Y,[a$k]);throw new Error("unknown params.")},a$Y.lodasatlas=!1,a$M(a$Y,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),a$Y}(),a$Ik=function(a$t){function a$k(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,a$k.__super.call(this)}a$E(a$k,"laya.d3.resource.models.PrimitiveMesh",a$ak);var a$v=a$k.prototype;return a$X.imps(a$v,{"laya.d3.core.render.IRenderable":!0}),a$v._getVertexBuffer=function(a$t){return void 0===a$t&&(a$t=0),0===a$t?this._vertexBuffer:null},a$v._getVertexBuffers=function(){return null},a$v._getIndexBuffer=function(){return this._indexBuffer},a$v._getPositions=function(){var a$t,a$k=[],a$v=this._vertexBuffer.vertexDeclaration.getVertexElements(),a$j=0;for(a$j=0;a$j<a$v.length;a$j++){var a$Q=a$v[a$j];if("vector3"===a$Q.elementFormat&&0===a$Q.elementUsage){a$t=a$Q;break}}var a$u=this._vertexBuffer.getData();for(a$j=0;a$j<a$u.length;a$j+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var a$S=a$j+a$t.offset/4,a$V=new a$Sk(a$u[a$S+0],a$u[a$S+1],a$u[a$S+2]);a$k.push(a$V)}return a$k},a$v.getRenderElement=function(a$t){return this},a$v.getRenderElementsCount=function(){return 1},a$v.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},a$v._beforeRender=function(a$t){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},a$v._render=function(a$t){a$N.mainContext.drawElements(4,this._numberIndices,5123,0),a$m.drawCall++,a$m.trianglesFaces+=this._numberIndices/3},a$A(0,a$v,"_vertexBufferCount",function(){return 1}),a$A(0,a$v,"triangleCount",function(){return this._indexBuffer.indexCount/3}),a$k}(),a$ik=function(a$t){function a$k(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,a$k.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}a$E(a$k,"laya.d3.resource.models.Mesh",a$ak);var a$v=a$k.prototype;return a$v._getPositions=function(){var a$t,a$k,a$v,a$j,a$Q,a$u=[],a$S=0,a$V=0,a$J=0;if(0!==this._vertexBuffers.length){var a$W=this._vertexBuffers.length;for(a$S=0;a$S<a$W;a$S++){for(a$v=(a$t=this._vertexBuffers[a$S]).vertexDeclaration.getVertexElements(),a$V=0;a$V<a$v.length;a$V++)if("vector3"===(a$j=a$v[a$V]).elementFormat&&0===a$j.elementUsage){a$k=a$j;break}for(a$Q=a$t.getData(),a$V=0;a$V<a$Q.length;a$V+=a$t.vertexDeclaration.vertexStride/4)a$J=a$V+a$k.offset/4,a$u.push(new a$Sk(a$Q[a$J+0],a$Q[a$J+1],a$Q[a$J+2]))}}else{var a$w=this._subMeshes.length;for(a$S=0;a$S<a$w;a$S++){for(a$v=(a$t=this._subMeshes[a$S]._getVertexBuffer()).vertexDeclaration.getVertexElements(),a$V=0;a$V<a$v.length;a$V++)if("vector3"===(a$j=a$v[a$V]).elementFormat&&0===a$j.elementUsage){a$k=a$j;break}for(a$Q=a$t.getData(),a$V=0;a$V<a$Q.length;a$V+=a$t.vertexDeclaration.vertexStride/4)a$J=a$V+a$k.offset/4,a$u.push(new a$Sk(a$Q[a$J+0],a$Q[a$J+1],a$Q[a$J+2]))}}return a$u},a$v._setSubMeshes=function(a$t){this._subMeshes=a$t,this._subMeshCount=a$t.length;for(var a$k=0;a$k<this._subMeshCount;a$k++)a$t[a$k]._indexInMesh=a$k;this._positions=this._getPositions(),this._generateBoundingObject()},a$v.onAsynLoaded=function(a$t,a$k,a$v){var a$j=a$k[0],a$Q=a$k[1];a$et.read(a$j,this,this._materials,this._subMeshes,a$Q),this.completeCreate(),this._endLoaded()},a$v.getSubMesh=function(a$t){return this._subMeshes[a$t]},a$v.getSubMeshCount=function(){return this._subMeshes.length},a$v.getRenderElementsCount=function(){return this._subMeshes.length},a$v.getRenderElement=function(a$t){return this._subMeshes[a$t]},a$v.disposeResource=function(){for(var a$t=0;a$t<this._subMeshes.length;a$t++)this._subMeshes[a$t].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},a$A(0,a$v,"materials",function(){return this._materials.slice()}),a$A(0,a$v,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),a$k.load=function(a$t){return a$X.loader.create(a$t,null,null,a$k)},a$k}(),a$Dk=(function(a$t){function a$W(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===a$v&&(a$v=6408),void 0===a$j&&(a$j=5121),void 0===a$Q&&(a$Q=33189),void 0===a$u&&(a$u=!1),void 0===a$S&&(a$S=!1),void 0===a$V&&(a$V=-1),void 0===a$J&&(a$J=-1),a$W.__super.call(this),this._type=3553,this._width=a$t,this._height=a$k,this._size=new a$Rk(a$t,a$k),this._surfaceFormat=a$v,this._surfaceType=a$j,this._depthStencilFormat=a$Q,a$R.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=a$u,this._repeat=a$S,this._minFifter=a$V,this._magFifter=a$J,this.activeResource(),this._alreadyResolved=!0}a$E(a$W,"laya.d3.resource.RenderTexture",a$Nk);var a$k=a$W.prototype;a$k.recreateResource=function(){var a$t=a$N.mainContext;this._frameBuffer=a$t.createFramebuffer(),this._source=a$t.createTexture();var a$k=a$a.curBindTexTarget,a$v=a$a.curBindTexValue;a$a.bindTexture(a$t,this._type,this._source),a$t.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var a$j=this._minFifter,a$Q=this._magFifter,a$u=this._repeat?10497:33071;if(a$f.isPOT(this._width,this._height)?(this._mipmap?-1!==a$j||(a$j=9987):-1!==a$j||(a$j=9729),-1!==a$Q||(a$Q=9729),a$t.texParameteri(this._type,10241,a$j),a$t.texParameteri(this._type,10240,a$Q),a$t.texParameteri(this._type,10242,a$u),a$t.texParameteri(this._type,10243,a$u),this._mipmap&&a$t.generateMipmap(this._type)):(-1!==a$j||(a$j=9729),-1!==a$Q||(a$Q=9729),a$t.texParameteri(this._type,10241,a$j),a$t.texParameteri(this._type,10240,a$Q),a$t.texParameteri(this._type,10242,33071),a$t.texParameteri(this._type,10243,33071)),a$k&&a$v&&a$a.bindTexture(a$t,a$k,a$v),a$t.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=a$t.createRenderbuffer(),a$t.bindRenderbuffer(36161,this._depthStencilBuffer),a$t.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),a$t.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:a$t.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:a$t.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:a$t.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}a$t.framebufferTexture2D(36160,36064,3553,this._source,0),a$t.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},a$k.start=function(){a$N.mainContext.bindFramebuffer(36160,this.frameBuffer),(a$W._currentRenderTarget=this)._alreadyResolved=!1},a$k.end=function(){a$N.mainContext.bindFramebuffer(36160,null),a$W._currentRenderTarget=null,this._alreadyResolved=!0},a$k.getData=function(a$t,a$k,a$v,a$j){var a$Q=a$N.mainContext;if(a$Q.bindFramebuffer(36160,this._frameBuffer),!(36053===a$Q.checkFramebufferStatus(36160)))return a$Q.bindFramebuffer(36160,null),null;var a$u=new Uint8Array(this._width*this._height*4);return a$Q.readPixels(a$t,a$k,a$v,a$j,this._surfaceFormat,this._surfaceType,a$u),a$Q.bindFramebuffer(36160,null),a$u},a$k.disposeResource=function(){if(this._frameBuffer){var a$t=a$N.mainContext;a$t.deleteTexture(this._source),a$t.deleteFramebuffer(this._frameBuffer),a$t.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},a$A(0,a$k,"surfaceFormat",function(){return this._surfaceFormat}),a$A(0,a$k,"surfaceType",function(){return this._surfaceType}),a$A(0,a$k,"depthStencilFormat",function(){return this._depthStencilFormat}),a$A(0,a$k,"source",function(){return this._alreadyResolved?a$X.superGet(a$Nk,this,"source"):null}),a$A(0,a$k,"depthStencilBuffer",function(){return this._depthStencilBuffer}),a$A(0,a$k,"frameBuffer",function(){return this._frameBuffer}),a$W._currentRenderTarget=null}(),function(a$t){function a$k(a$t){this._color=null,this._pixels=null,a$k.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new a$Rk(this.width,this.height),this._color=a$t,this._pixels=new Uint8Array([255*a$t.x,255*a$t.y,255*a$t.z,255*a$t.w]),this.uri="SolidColorTexture2D_"+this.id}a$E(a$k,"laya.d3.resource.SolidColorTexture2D",a$Nk);var a$v=a$k.prototype;return a$v._createWebGlTexture=function(){var a$t=a$N.mainContext,a$k=this._source=a$t.createTexture(),a$v=this._width,a$j=this._height,a$Q=a$a.curBindTexTarget,a$u=a$a.curBindTexValue;a$a.bindTexture(a$t,this._type,a$k),a$t.texImage2D(this._type,0,6408,a$v,a$j,0,6408,5121,this._pixels);var a$S=this._minFifter,a$V=this._magFifter,a$J=this._repeat?10497:33071,a$W=a$f.isPOT(a$v,a$j);a$W?(this._mipmap?-1!==a$S||(a$S=9987):-1!==a$S||(a$S=9729),-1!==a$V||(a$V=9729),a$t.texParameteri(this._type,10241,a$S),a$t.texParameteri(this._type,10240,a$V),a$t.texParameteri(this._type,10242,a$J),a$t.texParameteri(this._type,10243,a$J),this._mipmap&&a$t.generateMipmap(this._type)):(-1!==a$S||(a$S=9729),-1!==a$V||(a$V=9729),a$t.texParameteri(this._type,10241,a$S),a$t.texParameteri(this._type,10240,a$V),a$t.texParameteri(this._type,10242,33071),a$t.texParameteri(this._type,10243,33071)),a$Q&&a$u&&a$a.bindTexture(a$t,a$Q,a$u),this.memorySize=a$W?a$v*a$j*4*(1+1/3):a$v*a$j*4},a$v.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},a$v.disposeResource=function(){this._source&&(a$N.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},a$M(a$k,["magentaTexture",function(){var a$t=new a$k(new a$Vk(1,0,1,1));return a$t.lock=!0,this.magentaTexture=a$t},"grayTexture",function(){var a$t=new a$k(new a$Vk(.5,.5,.5,1));return a$t.lock=!0,this.grayTexture=a$t}]),a$k}()),a$Bk=function(a$t){function a$Q(a$t,a$k,a$v,a$j){this._canRead=!1,this._image=null,this._pixels=null,void 0===a$t&&(a$t=!1),void 0===a$k&&(a$k=!0),void 0===a$v&&(a$v=6408),void 0===a$j&&(a$j=!0),a$Q.__super.call(this),this._type=3553,this._repeat=a$k,this._canRead=a$t,this._format=a$v,this._mipmap=a$j}a$E(a$Q,"laya.d3.resource.Texture2D",a$Nk);var a$k=a$Q.prototype;return a$k._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var a$t=a$N.mainContext,a$k=this._source=a$t.createTexture(),a$v=this._width,a$j=this._height,a$Q=a$a.curBindTexTarget,a$u=a$a.curBindTexValue;switch(a$a.bindTexture(a$t,this._type,a$k),this._format){case 6407:case 6408:this._canRead?a$t.texImage2D(this._type,0,this._format,a$v,a$j,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?a$t.texImage2D(this._type,0,this._image._format,a$v,a$j,0,this._image._format,5121,this._image.atlasSource):a$t.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case a$N.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:a$t.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var a$S=this._minFifter,a$V=this._magFifter,a$J=this._repeat?10497:33071,a$W=0==this._wrapModeU?10497:33071,a$w=0==this._wrapModeV?10497:33071,a$M=a$f.isPOT(a$v,a$j);a$M?(this._mipmap?-1!==a$S||(a$S=9987):-1!==a$S||(a$S=9729),-1!==a$V||(a$V=9729),a$t.texParameteri(this._type,10241,a$S),a$t.texParameteri(this._type,10240,a$V),a$t.texParameteri(this._type,10242,a$J),a$t.texParameteri(this._type,10243,a$J),a$t.texParameteri(this._type,10242,a$W),a$t.texParameteri(this._type,10243,a$w),this._mipmap&&a$t.generateMipmap(this._type)):(-1!==a$S||(a$S=9729),-1!==a$V||(a$V=9729),a$t.texParameteri(this._type,10241,a$S),a$t.texParameteri(this._type,10240,a$V),a$t.texParameteri(this._type,10242,33071),a$t.texParameteri(this._type,10243,33071)),a$Q&&a$u&&a$a.bindTexture(a$t,a$Q,a$u),this._image.onload=null,this._image=null,this.memorySize=a$M?a$v*a$j*4*(1+1/3):a$v*a$j*4},a$k.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},a$k.onAsynLoaded=function(a$t,a$k,a$v){if(a$v){var a$j=a$v[0];void 0!==a$j&&(this._canRead=a$j);var a$Q=a$v[1];void 0!==a$Q&&(this._repeat=a$Q);var a$u=a$v[2];void 0!==a$u&&(this._format=a$u);var a$S=a$v[3];void 0!==a$S&&(this._mipmap=a$S);var a$V=a$v.wrapModeU;void 0!==a$V&&(this._wrapModeU=a$V);var a$J=a$v.wrapModeV;void 0!==a$J&&(this._wrapModeV=a$J)}switch(this._format){case 6407:case 6408:var a$W=(this._image=a$k).width,a$w=a$k.height;this._width=a$W,this._height=a$w,this._size=new a$Rk(a$W,a$w),this._canRead&&(a$R.isConchApp?a$k instanceof a$H.HTMLElement&&(this._pixels=new Uint8Array(a$k.getImageData(0,0,a$W,a$w))):(a$z.canvas.size(a$W,a$w),a$z.canvas.clear(),a$z.context.drawImage(a$k,0,0,a$W,a$w),this._pixels=new Uint8Array(a$z.context.getImageData(0,0,a$W,a$w).data.buffer)));break;case a$N.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var a$M=new a$F(a$k);a$M.readUTFBytes(4),a$M.readUTFBytes(2),a$M.getInt16();a$M.endian="bigEndian",this._width=a$M.getInt16(),this._height=a$M.getInt16(),this._size=new a$Rk(this._width,this._height);a$M.getInt16(),a$M.getInt16();this._image=new Uint8Array(a$k,a$M.pos)}this.recreateResource(),this._endLoaded()},a$k.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},a$k.disposeResource=function(){this._source&&(a$N.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},a$A(0,a$k,"_src",function(){return this.url}),a$A(0,a$k,"src",function(){return this.url}),a$Q.load=function(a$t){return a$X.loader.create(a$t,null,null,a$Q)},a$Q}(),a$bk=function(a$k){function a$v(a$t,a$k){a$v.__super.call(this),void 0===a$t&&(a$t=.3),void 0===a$k&&(a$k=1e3),this._tempVector3=new a$Sk,this._position=new a$Sk,this._up=new a$Sk,this._forward=new a$Sk,this._right=new a$Sk,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=a$Rk.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=a$t,this._farPlane=a$k,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),a$X.stage.on("resize",this,this._onScreenSizeChanged)}a$E(a$v,"laya.d3.core.BaseCamera",a$k);var a$t=a$v.prototype;return a$t._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var a$t=this.scene._cameraPool,a$k=a$t.length-1,a$v=0;a$v<a$k;a$v++)if(a$t[a$v].renderingOrder>a$t[a$k].renderingOrder){var a$j=a$t[a$v];a$t[a$v]=a$t[a$k],a$t[a$k]=a$j}},a$t._calculateProjectionMatrix=function(){},a$t._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},a$t._prepareCameraToRender=function(){a$G._currentCameraCullingMask=this.cullingMask;var a$t=this._shaderValues;a$t.setValue(0,this.transform.position.elements),a$t.setValue(5,this.forward.elements),a$t.setValue(6,this.up.elements)},a$t._prepareCameraViewProject=function(a$t,a$k){var a$v=this._shaderValues;a$v.setValue(1,a$t.elements),a$v.setValue(2,a$k.elements)},a$t._renderCamera=function(a$t,a$k,a$v){},a$t.addLayer=function(a$t){29!==a$t.number&&30!=a$t.number&&(this.cullingMask=this.cullingMask|a$t.mask)},a$t.removeLayer=function(a$t){29!==a$t.number&&30!=a$t.number&&(this.cullingMask=this.cullingMask&~a$t.mask)},a$t.addAllLayers=function(){this.cullingMask=2147483647},a$t.removeAllLayers=function(){this.cullingMask=0|a$G.getLayerByNumber(29).mask|a$G.getLayerByNumber(30).mask},a$t.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},a$t.moveForward=function(a$t){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=a$t,this.transform.translate(this._tempVector3)},a$t.moveRight=function(a$t){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=a$t,this.transform.translate(this._tempVector3)},a$t.moveVertical=function(a$t){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=a$t,this.transform.translate(this._tempVector3,!1)},a$t._addSelfRenderObjects=function(){var a$t=this.scene._cameraPool,a$k=a$t.length;if(0<a$k){for(var a$v=a$k-1;0<=a$v;a$v--)if(this.renderingOrder<=a$t[a$v].renderingOrder){a$t.splice(a$v+1,0,this);break}}else a$t.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},a$t._clearSelfRenderObjects=function(){var a$t=this.scene._cameraPool;a$t.splice(a$t.indexOf(this),1)},a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,a$X.stage.off("resize",this,this._onScreenSizeChanged),a$k.prototype.destroy.call(this,a$t)},a$A(0,a$t,"sky",function(){return this._sky},function(a$t){(this._sky=a$t)._ownerCamera=this}),a$A(0,a$t,"forward",function(){var a$t=this.transform.worldMatrix.elements,a$k=this._forward.elements;return a$k[0]=-a$t[8],a$k[1]=-a$t[9],a$k[2]=-a$t[10],this._forward}),a$A(0,a$t,"position",function(){var a$t=this.transform.worldMatrix.elements,a$k=this._position.elements;return a$k[0]=a$t[12],a$k[1]=a$t[13],a$k[2]=a$t[14],this._position}),a$A(0,a$t,"renderTarget",function(){return this._renderTarget},function(a$t){null!=(this._renderTarget=a$t)&&(this._renderTargetSize=a$t.size)}),a$A(0,a$t,"up",function(){var a$t=this.transform.worldMatrix.elements,a$k=this._up.elements;return a$k[0]=a$t[4],a$k[1]=a$t[5],a$k[2]=a$t[6],this._up}),a$A(0,a$t,"right",function(){var a$t=this.transform.worldMatrix.elements,a$k=this._right.elements;return a$k[0]=a$t[0],a$k[1]=a$t[1],a$k[2]=a$t[2],this._right}),a$A(0,a$t,"renderTargetSize",function(){return this._renderTargetSize},function(a$t){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=a$t,this._calculateProjectionMatrix()}),a$A(0,a$t,"fieldOfView",function(){return this._fieldOfView},function(a$t){this._fieldOfView=a$t,this._calculateProjectionMatrix()}),a$A(0,a$t,"nearPlane",function(){return this._nearPlane},function(a$t){this._nearPlane=a$t,this._calculateProjectionMatrix()}),a$A(0,a$t,"farPlane",function(){return this._farPlane},function(a$t){this._farPlane=a$t,this._calculateProjectionMatrix()}),a$A(0,a$t,"orthographic",function(){return this._orthographic},function(a$t){this._orthographic=a$t,this._calculateProjectionMatrix()}),a$A(0,a$t,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(a$t){this._orthographicVerticalSize=a$t,this._calculateProjectionMatrix()}),a$A(0,a$t,"renderingOrder",function(){return this._renderingOrder},function(a$t){this._renderingOrder=a$t,this._sortCamerasByRenderingOrder()}),a$v.CAMERAPOS=0,a$v.VIEWMATRIX=1,a$v.PROJECTMATRIX=2,a$v.VPMATRIX=3,a$v.VPMATRIX_NO_TRANSLATE=4,a$v.CAMERADIRECTION=5,a$v.CAMERAUP=6,a$v.ENVIRONMENTDIFFUSE=7,a$v.ENVIRONMENTSPECULAR=8,a$v.SIMLODINFO=9,a$v.DIFFUSEIRRADMATR=10,a$v.DIFFUSEIRRADMATG=11,a$v.DIFFUSEIRRADMATB=12,a$v.HDREXPOSURE=13,a$v.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",a$v.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",a$v.CLEARFLAG_SOLIDCOLOR=0,a$v.CLEARFLAG_SKY=1,a$v.CLEARFLAG_DEPTHONLY=2,a$v.CLEARFLAG_NONE=3,a$M(a$v,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new a$tk(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new a$tk},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new a$tk}]),a$v}(a$Tk),a$qk=function(a$v){function a$k(a$t){this._render=null,this._geometryFilter=null,a$k.__super.call(this,a$t)}a$E(a$k,"laya.d3.core.RenderableSprite3D",a$v);var a$t=a$k.prototype;return a$t._addToInitStaticBatchManager=function(){},a$t._setBelongScene=function(a$t){a$v.prototype._setBelongScene.call(this,a$t),a$t._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},a$t._setUnBelongScene=function(){var a$t=this._scene._renderableSprite3Ds,a$k=a$t.indexOf(this);a$t.splice(a$k,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),a$v.prototype._setUnBelongScene.call(this)},a$t._update=function(a$t){(a$t.owner=this)._activeInHierarchy&&(this._updateComponents(a$t),this._render._updateOctreeNode(),this._lateUpdateComponents(a$t),a$m.spriteCount++,this._childs.length&&this._updateChilds(a$t))},a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),a$v.prototype.destroy.call(this,a$t),this._render._destroy(),this._render=null},a$k.__init__=function(){a$k.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=a$k.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),a$k.SAHDERDEFINE_LIGHTMAP=a$k.shaderDefines.registerDefine("LIGHTMAP")},a$k.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,a$k.SAHDERDEFINE_LIGHTMAP=4,a$k.LIGHTMAPSCALEOFFSET=2,a$k.LIGHTMAP=3,a$M(a$k,["shaderDefines",function(){return this.shaderDefines=new a$wk}]),a$k}(a$Tk),a$Ck=(function(a$t){function a$j(a$t,a$k,a$v){this._long=NaN,this._width=NaN,this._height=NaN,void 0===a$t&&(a$t=1),void 0===a$k&&(a$k=1),void 0===a$v&&(a$v=1),a$j.__super.call(this),this._long=a$t,this._width=a$k,this._height=a$v,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}a$E(a$j,"laya.d3.resource.models.BoxMesh",a$Ik);var a$k=a$j.prototype;a$k.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var a$t=a$Nt.vertexDeclaration,a$k=(a$t.vertexStride,this._long/2),a$v=this._height/2,a$j=this._width/2,a$Q=new Float32Array([-a$k,a$v,-a$j,0,1,0,0,0,a$k,a$v,-a$j,0,1,0,1,0,a$k,a$v,a$j,0,1,0,1,1,-a$k,a$v,a$j,0,1,0,0,1,-a$k,-a$v,-a$j,0,-1,0,0,1,a$k,-a$v,-a$j,0,-1,0,1,1,a$k,-a$v,a$j,0,-1,0,1,0,-a$k,-a$v,a$j,0,-1,0,0,0,-a$k,a$v,-a$j,-1,0,0,0,0,-a$k,a$v,a$j,-1,0,0,1,0,-a$k,-a$v,a$j,-1,0,0,1,1,-a$k,-a$v,-a$j,-1,0,0,0,1,a$k,a$v,-a$j,1,0,0,1,0,a$k,a$v,a$j,1,0,0,0,0,a$k,-a$v,a$j,1,0,0,0,1,a$k,-a$v,-a$j,1,0,0,1,1,-a$k,a$v,a$j,0,0,1,0,0,a$k,a$v,a$j,0,0,1,1,0,a$k,-a$v,a$j,0,0,1,1,1,-a$k,-a$v,a$j,0,0,1,0,1,-a$k,a$v,-a$j,0,0,-1,1,0,a$k,a$v,-a$j,0,0,-1,0,0,a$k,-a$v,-a$j,0,0,-1,0,1,-a$k,-a$v,-a$j,0,0,-1,1,1]),a$u=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new a$_k(a$t,this._numberVertices,35044,!0),this._indexBuffer=new a$nk("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(a$Q),this._indexBuffer.setData(a$u),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},a$A(0,a$k,"long",function(){return this._long},function(a$t){this._long!==a$t&&(this._long=a$t,this.releaseResource(),this.activeResource())}),a$A(0,a$k,"width",function(){return this._width},function(a$t){this._width!==a$t&&(this._width=a$t,this.releaseResource(),this.activeResource())}),a$A(0,a$k,"height",function(){return this._height},function(a$t){this._height!==a$t&&(this._height=a$t,this.releaseResource(),this.activeResource())})}(),function(a$t){function a$S(a$t,a$k,a$v){void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=.3),void 0===a$v&&(a$v=1e3),this._viewMatrix=new a$tk,this._projectionMatrix=new a$tk,this._projectionViewMatrix=new a$tk,this._viewport=new a$Jk(0,0,0,0),this._normalizedViewport=new a$Jk(0,0,1,1),this._aspectRatio=a$t,this._boundFrustumUpdate=!0,this._boundFrustum=new a$gt(a$tk.DEFAULT),a$S.__super.call(this,a$k,a$v),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}a$E(a$S,"laya.d3.core.Camera",a$bk);var a$k=a$S.prototype;return a$k._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},a$k._parseCustomProps=function(a$t,a$k,a$v,a$j){var a$Q=a$v.clearColor;this.clearColor=new a$Vk(a$Q[0],a$Q[1],a$Q[2],a$Q[3]);var a$u=a$v.viewport;this.normalizedViewport=new a$Jk(a$u[0],a$u[1],a$u[2],a$u[3])},a$k._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var a$t=this.orthographicVerticalSize*this.aspectRatio*.5,a$k=.5*this.orthographicVerticalSize;a$tk.createOrthoOffCenterRH(-a$t,a$t,-a$k,a$k,this.nearPlane,this.farPlane,this._projectionMatrix)}else a$tk.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},a$k._update=function(a$t){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,a$t)},a$k._renderCamera=function(a$t,a$k,a$v){var a$j,a$Q;a$v.parallelSplitShadowMaps[0]&&a$v._renderShadowMap(a$t,a$k,this),(a$k.camera=this)._prepareCameraToRender(),a$v._preRenderUpdateComponents(a$k),a$j=a$k._viewMatrix=this.viewMatrix;var a$u=this._renderTarget;a$u?(a$u.start(),a$tk.multiply(a$bk._invertYScaleMatrix,this._projectionMatrix,a$bk._invertYProjectionMatrix),a$tk.multiply(a$bk._invertYScaleMatrix,this.projectionViewMatrix,a$bk._invertYProjectionViewMatrix),a$Q=a$k._projectionMatrix=a$bk._invertYProjectionMatrix,a$k._projectionViewMatrix=a$bk._invertYProjectionViewMatrix):(a$Q=a$k._projectionMatrix=this._projectionMatrix,a$k._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(a$j,a$Q),a$k._viewport=this.viewport,a$v._preRenderScene(a$t,a$k,this.boundFrustum),a$v._clear(a$t,a$k),a$v._renderScene(a$t,a$k),a$v._postRenderUpdateComponents(a$k),a$u&&a$u.end()},a$k.viewportPointToRay=function(a$t,a$k){a$Ak.calculateCursorRay(a$t,this.viewport,this._projectionMatrix,this.viewMatrix,null,a$k)},a$k.normalizedViewportPointToRay=function(a$t,a$k){var a$v=a$S._tempVector20,a$j=this.viewport,a$Q=a$t.elements,a$u=a$v.elements;a$u[0]=a$Q[0]*a$j.width,a$u[1]=a$Q[1]*a$j.height,a$Ak.calculateCursorRay(a$v,this.viewport,this._projectionMatrix,this.viewMatrix,null,a$k)},a$k.worldToViewportPoint=function(a$t,a$k){a$tk.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(a$t,this._projectionViewMatrix,a$k);var a$v=a$k.elements;a$v[0]=a$v[0]/a$X.stage.clientScaleX,a$v[1]=a$v[1]/a$X.stage.clientScaleY},a$k.worldToNormalizedViewportPoint=function(a$t,a$k){a$tk.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(a$t,this._projectionViewMatrix,a$k);var a$v=a$k.elements;a$v[0]=a$v[0]/a$X.stage.clientScaleX,a$v[1]=a$v[1]/a$X.stage.clientScaleY},a$k.convertScreenCoordToOrthographicCoord=function(a$t,a$k){if(this._orthographic){var a$v=a$e.clientWidth,a$j=a$e.clientHeight,a$Q=this.orthographicVerticalSize*this.aspectRatio/a$v,a$u=this.orthographicVerticalSize/a$j,a$S=a$t.elements,a$V=a$k.elements;return a$V[0]=(-a$v/2+a$S[0])*a$Q,a$V[1]=(a$j/2-a$S[1])*a$u,a$V[2]=(this.nearPlane-this.farPlane)*(a$S[2]+1)/2-this.nearPlane,a$Sk.transformCoordinate(a$k,this.transform.worldMatrix,a$k),!0}return!1},a$A(0,a$k,"projectionViewMatrix",function(){return a$tk.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),a$A(0,a$k,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var a$t=this.viewport;return a$t.width/a$t.height},function(a$t){if(a$t<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=a$t,this._calculateProjectionMatrix()}),a$A(0,a$k,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),a$A(0,a$k,"needViewport",function(){var a$t=this.normalizedViewport;return 0===a$t.x&&0===a$t.y&&1===a$t.width&&1===a$t.height}),a$A(0,a$k,"viewport",function(){if(this._viewportExpressedInClipSpace){var a$t=this._normalizedViewport,a$k=this.renderTargetSize,a$v=a$k.width,a$j=a$k.height;this._viewport.x=a$t.x*a$v,this._viewport.y=a$t.y*a$j,this._viewport.width=a$t.width*a$v,this._viewport.height=a$t.height*a$j}return this._viewport},function(a$t){if(null!=this.renderTarget&&(a$t.x<0||a$t.y<0||0==a$t.width||0==a$t.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=a$t,this._calculateProjectionMatrix()}),a$A(0,a$k,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var a$t=this._viewport,a$k=this.renderTargetSize,a$v=a$k.width,a$j=a$k.height;this._normalizedViewport.x=a$t.x/a$v,this._normalizedViewport.y=a$t.y/a$j,this._normalizedViewport.width=a$t.width/a$v,this._normalizedViewport.height=a$t.height/a$j}return this._normalizedViewport},function(a$t){a$t.x<0&&(a$t.x=0,console.warn("Camera: viewport.x must large than 0.0.")),a$t.y<0&&(a$t.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<a$t.x+a$t.width&&(a$t.width=1-a$t.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<a$t.y+a$t.height&&(a$t.height=1-a$t.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=a$t,this._calculateProjectionMatrix()}),a$A(0,a$k,"projectionMatrix",function(){return this._projectionMatrix},function(a$t){this._projectionMatrix=a$t,this._useUserProjectionMatrix=!0}),a$A(0,a$k,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),a$M(a$S,["_tempVector20",function(){return this._tempVector20=new a$uk}]),a$S}()),a$Lk=function(a$v){function a$j(a$t,a$k){a$j.__super.call(this,a$k),this._geometryFilter=new a$zk(this),this._render=new a$Gk(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),a$t&&(this._geometryFilter.sharedMesh=a$t)instanceof laya.d3.resource.models.Mesh&&(a$t.loaded?this._render.sharedMaterials=a$t.materials:a$t.once("loaded",this,this._applyMeshMaterials))}a$E(a$j,"laya.d3.core.MeshSprite3D",a$v);var a$t=a$j.prototype;return a$t._changeRenderObjectByMesh=function(a$t){var a$k=this._render._renderElements,a$v=a$k[a$t];a$v||(a$v=a$k[a$t]=new a$dk),a$v._render=this._render;var a$j=this._render.sharedMaterials[a$t];a$j||(a$j=a$Ok.defaultMaterial);var a$Q=this._geometryFilter.sharedMesh.getRenderElement(a$t);return a$v._mainSortID=this._getSortID(a$Q,a$j),a$v._sprite3D=this,a$v.renderObj=a$Q,a$v._material=a$j,a$v},a$t._changeRenderObjectByMaterial=function(a$t,a$k){var a$v=this._render._renderElements[a$t];a$k||(a$k=a$Ok.defaultMaterial);var a$j=this._geometryFilter.sharedMesh.getRenderElement(a$t);return a$v._mainSortID=this._getSortID(a$j,a$k),a$v._sprite3D=this,a$v.renderObj=a$j,a$v._material=a$k,a$v},a$t._changeRenderObjectsByMesh=function(){var a$t=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=a$t;for(var a$k=0;a$k<a$t;a$k++)this._changeRenderObjectByMesh(a$k)},a$t._onMeshChanged=function(a$t){var a$k=a$t.sharedMesh;a$k.loaded?this._changeRenderObjectsByMesh():a$k.once("loaded",this,this._onMeshLoaded)},a$t._onMeshLoaded=function(a$t){a$t===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},a$t._onMaterialChanged=function(a$t,a$k,a$v){a$k<this._render._renderElements.length&&this._changeRenderObjectByMaterial(a$k,a$v)},a$t._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},a$t._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},a$t._parseCustomProps=function(a$t,a$k,a$v,a$j){var a$Q=this.meshRender,a$u=a$v.lightmapIndex;null!=a$u&&(a$Q.lightmapIndex=a$u);var a$S,a$V,a$J=a$v.lightmapScaleOffset;if(a$J&&(a$Q.lightmapScaleOffset=new a$Vk(a$J[0],a$J[1],a$J[2],a$J[3])),a$j.instanceParams)(a$S=a$j.instanceParams.loadPath)&&(a$V=a$l.getRes(a$k[a$S]),(this.meshFilter.sharedMesh=a$V).loaded?a$Q.sharedMaterials=a$V.materials:a$V.once("loaded",this,this._applyMeshMaterials));else{(a$S=a$v.meshPath)&&(a$V=a$l.getRes(a$k[a$S]),this.meshFilter.sharedMesh=a$V);var a$W=a$v.materials;if(a$W){var a$w=a$Q.sharedMaterials,a$M=a$W.length;a$w.length=a$M;for(var a$H=0;a$H<a$M;a$H++)a$w[a$H]=a$l.getRes(a$k[a$W[a$H].path]);a$Q.sharedMaterials=a$w}}},a$t._applyMeshMaterials=function(a$t){for(var a$k=this._render.sharedMaterials,a$v=a$t.materials,a$j=0,a$Q=a$v.length;a$j<a$Q;a$j++)a$k[a$j]||(a$k[a$j]=a$v[a$j]);this._render.sharedMaterials=a$k},a$t._addToInitStaticBatchManager=function(){a$j._staticBatchManager._addInitBatchSprite(this)},a$t.cloneTo=function(a$t){var a$k=a$t;a$k._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var a$v=this._render,a$j=a$k._render;a$j.enable=a$v.enable,a$j.sharedMaterials=a$v.sharedMaterials,a$j.castShadow=a$v.castShadow;var a$Q=a$v.lightmapScaleOffset;a$Q&&(a$j.lightmapScaleOffset=a$Q.clone()),a$j.lightmapIndex=a$v.lightmapIndex,a$j.receiveShadow=a$v.receiveShadow,a$j.sortingFudge=a$v.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,a$t)},a$t.destroy=function(a$t){if(void 0===a$t&&(a$t=!0),!this.destroyed){var a$k=this.meshFilter.sharedMesh;null!=a$k&&(a$k.loaded||a$k.off("loaded",this,this._applyMeshMaterials)),a$v.prototype.destroy.call(this,a$t),this._geometryFilter._destroy()}},a$A(0,a$t,"meshFilter",function(){return this._geometryFilter}),a$A(0,a$t,"meshRender",function(){return this._render}),a$j.__init__=function(){a$jt._staticBatchManagers.push(a$j._staticBatchManager)},a$j.load=function(a$t){return a$X.loader.create(a$t,null,null,a$j)},a$M(a$j,["_staticBatchManager",function(){return this._staticBatchManager=new a$Zk}]),a$j}(a$qk)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(a$t,a$k){"use strict";for(var a$v in Object.defineProperty(a$k,"__esModule",{value:!0}),Laya){var a$j=Laya[a$v];a$j&&a$j.__isclass&&(a$k[a$v]=a$j)}}),function(a$t,a$k,a$Qt){a$Qt.un,a$Qt.uns;var a$v=a$Qt.static,a$j=a$Qt.class,a$u=a$Qt.getset,a$R=a$Qt.__newvec,a$V=laya.maths.Bezier,a$M=laya.utils.Browser,a$Nt=laya.utils.Byte,a$Q=(laya.events.Event,laya.events.EventDispatcher),a$S=laya.display.Graphics,a$J=(laya.resource.HTMLCanvas,laya.utils.Handler),a$W=laya.net.Loader,a$H=laya.maths.MathUtil,a$at=laya.maths.Matrix,a$h=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),a$w=(laya.renders.RenderContext,laya.resource.Resource),a$E=laya.utils.RunDriver,a$ut=laya.display.Sprite,a$A=laya.utils.Stat,a$zt=laya.resource.Texture,a$l=(laya.net.URL,laya.utils.Utils),a$a=function(){function a$t(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return a$j(a$t,"laya.ani.AnimationContent"),a$t}(),a$z=function(){function a$t(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return a$j(a$t,"laya.ani.AnimationNodeContent"),a$t}(),a$Y=function(){function a$t(){}return a$j(a$t,"laya.ani.AnimationParser01"),a$t.parse=function(a$t,a$k){var a$v=a$k.__getBuffer(),a$j=0,a$Q=0,a$u=0,a$S=0,a$V=0,a$J=0,a$W=0,a$w=a$k.readUTFString();a$t._aniClassName=a$w;var a$M,a$H=a$k.readUTFString().split("\n"),a$E=a$k.getUint8(),a$A=a$k.getUint32(),a$R=a$k.getUint32();0<a$A&&(a$M=a$v.slice(a$A,a$R));var a$h=new a$Nt(a$M);for(0<a$R&&(a$t._publicExtData=a$v.slice(a$R,a$v.byteLength)),a$t._useParent=!!a$k.getUint8(),a$t._anis.length=a$E,a$j=0;a$j<a$E;a$j++){var a$l=a$t._anis[a$j]=new a$a;a$l.nodes=new Array;var a$o=a$l.name=a$H[a$k.getUint16()];a$t._aniMap[a$o]=a$j,a$l.bone3DMap={},a$l.playTime=a$k.getFloat32(),a$l.playTime<=0&&console.error("播放时间不能为0  url="+a$t.url+" name="+a$l.name);var a$Y=a$l.nodes.length=a$k.getUint8();for(a$Q=a$l.totalKeyframeDatasLength=0;a$Q<a$Y;a$Q++){var a$f=a$l.nodes[a$Q]=new a$z;a$f.childs=[];var a$X=a$k.getInt16();0<=a$X&&(a$f.name=a$H[a$X],a$l.bone3DMap[a$f.name]=a$Q),a$f.keyFrame=new Array,a$f.parentIndex=a$k.getInt16(),-1==a$f.parentIndex?a$f.parent=null:a$f.parent=a$l.nodes[a$f.parentIndex],a$f.lerpType=a$k.getUint8();var a$F=a$k.getUint32();a$h.pos=a$F;var a$d=a$f.keyframeWidth=a$h.getUint16();if(a$l.totalKeyframeDatasLength+=a$d,0===a$f.lerpType||1===a$f.lerpType)for(a$f.interpolationMethod=[],a$f.interpolationMethod.length=a$d,a$u=0;a$u<a$d;a$u++)a$f.interpolationMethod[a$u]=a$T.interpolation[a$h.getUint8()];null!=a$f.parent&&a$f.parent.childs.push(a$f);var a$m=a$k.getUint16();0<a$m&&(a$f.extenData=a$v.slice(a$k.pos,a$k.pos+a$m),a$k.pos+=a$m);var a$Z,a$s=a$k.getUint16(),a$K=0;for(a$u=0,a$S=a$f.keyFrame.length=a$s;a$u<a$S;a$u++){if((a$Z=a$f.keyFrame[a$u]=new a$G).duration=a$k.getFloat32(),a$Z.startTime=a$K,2===a$f.lerpType){a$Z.interpolationData=[];var a$U,a$N=a$k.getUint8();switch(a$U=a$k.getFloat32()){case 254:for(a$Z.interpolationData.length=a$d,a$W=0;a$W<a$d;a$W++)a$Z.interpolationData[a$W]=0;break;case 255:for(a$Z.interpolationData.length=a$d,a$W=0;a$W<a$d;a$W++)a$Z.interpolationData[a$W]=5;break;default:for(a$Z.interpolationData.push(a$U),a$J=1;a$J<a$N;a$J++)a$Z.interpolationData.push(a$k.getFloat32())}}for(a$Z.data=new Float32Array(a$d),a$V=0;a$V<a$d;a$V++)a$Z.data[a$V]=a$k.getFloat32(),-1e-8<a$Z.data[a$V]&&a$Z.data[a$V]<1e-8&&(a$Z.data[a$V]=0);a$K+=a$Z.duration}a$Z.startTime=a$l.playTime,a$f.playTime=a$l.playTime,a$t._calculateKeyFrame(a$f,a$s,a$d)}}},a$t}(),a$f=function(){function a$X(){}return a$j(a$X,"laya.ani.AnimationParser02"),a$X.READ_DATA=function(){a$X._DATA.offset=a$X._reader.getUint32(),a$X._DATA.size=a$X._reader.getUint32()},a$X.READ_BLOCK=function(){for(var a$t=a$X._BLOCK.count=a$X._reader.getUint16(),a$k=a$X._BLOCK.blockStarts=[],a$v=a$X._BLOCK.blockLengths=[],a$j=0;a$j<a$t;a$j++)a$k.push(a$X._reader.getUint32()),a$v.push(a$X._reader.getUint32())},a$X.READ_STRINGS=function(){var a$t=a$X._reader.getUint32(),a$k=a$X._reader.getUint16(),a$v=a$X._reader.pos;a$X._reader.pos=a$t+a$X._DATA.offset;for(var a$j=0;a$j<a$k;a$j++)a$X._strings[a$j]=a$X._reader.readUTFString();a$X._reader.pos=a$v},a$X.parse=function(a$t,a$k){a$X._templet=a$t;(a$X._reader=a$k).__getBuffer();a$X.READ_DATA(),a$X.READ_BLOCK(),a$X.READ_STRINGS();for(var a$v=0,a$j=a$X._BLOCK.count;a$v<a$j;a$v++){var a$Q=a$k.getUint16(),a$u=a$X._strings[a$Q],a$S=a$X["READ_"+a$u];if(null==a$S)throw new Error("model file err,no this function:"+a$Q+" "+a$u);a$S.call()}},a$X.READ_ANIMATIONS=function(){var a$t=a$X._reader,a$k=a$t.__getBuffer(),a$v=0,a$j=0,a$Q=0,a$u=0,a$S=a$t.getUint16(),a$V=[];for(a$V.length=a$S,a$v=0;a$v<a$S;a$v++)a$V[a$v]=a$T.interpolation[a$t.getByte()];var a$J=a$t.getUint8();for(a$X._templet._anis.length=a$J,a$v=0;a$v<a$J;a$v++){var a$W=a$X._templet._anis[a$v]={};a$W.nodes=new Array;var a$w=a$W.name=a$X._strings[a$t.getUint16()];a$X._templet._aniMap[a$w]=a$v,a$W.bone3DMap={},a$W.playTime=a$t.getFloat32();var a$M=a$W.nodes.length=a$t.getInt16();for(a$j=a$W.totalKeyframeDatasLength=0;a$j<a$M;a$j++){var a$H=a$W.nodes[a$j]={};a$H.keyframeWidth=a$S,a$H.childs=[];var a$E=a$t.getUint16();0<=a$E&&(a$H.name=a$X._strings[a$E],a$W.bone3DMap[a$H.name]=a$j),a$H.keyFrame=new Array,a$H.parentIndex=a$t.getInt16(),-1==a$H.parentIndex?a$H.parent=null:a$H.parent=a$W.nodes[a$H.parentIndex],a$W.totalKeyframeDatasLength+=a$S,a$H.interpolationMethod=a$V,null!=a$H.parent&&a$H.parent.childs.push(a$H);var a$A=a$t.getUint16(),a$R=null,a$h=null;for(a$Q=0,a$u=a$H.keyFrame.length=a$A;a$Q<a$u;a$Q++){(a$R=a$H.keyFrame[a$Q]={}).startTime=a$t.getFloat32(),a$h&&(a$h.duration=a$R.startTime-a$h.startTime);var a$l=a$X._DATA.offset,a$o=a$t.getUint32(),a$Y=4*a$S,a$f=a$k.slice(a$l+a$o,a$l+a$o+a$Y);a$R.data=new Float32Array(a$f),a$h=a$R}a$R.duration=0,a$H.playTime=a$W.playTime,a$X._templet._calculateKeyFrame(a$H,a$A,a$S)}}},a$X._templet=null,a$X._reader=null,a$X._strings=[],a$v(a$X,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),a$X}(),a$Gt=(function(){function a$t(){}a$j(a$t,"laya.ani.AnimationState"),a$t.stopped=0,a$t.paused=1,a$t.playing=2}(),function(){function a$Q(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new a$qt,this.resultMatrix=new a$at,this._children=[]}a$j(a$Q,"laya.ani.bone.Bone");var a$t=a$Q.prototype;return a$t.setTempMatrix=function(a$t){this._tempMatrix=a$t;var a$k,a$v=0;for(a$v=0,a$k=this._children.length;a$v<a$k;a$v++)this._children[a$v].setTempMatrix(this._tempMatrix)},a$t.update=function(a$t){var a$k;if(this.rotation=this.transform.skX,a$t)a$k=this.resultTransform.getMatrix(),a$at.mul(a$k,a$t,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)a$k=this.resultTransform.getMatrix(),a$at.mul(a$k,this.parentBone.resultMatrix,this.resultMatrix);else{var a$v=this.parentBone,a$j=NaN,a$Q=NaN,a$u=NaN,a$S=this.parentBone.resultMatrix;a$k=this.resultTransform.getMatrix();var a$V=a$S.a*a$k.tx+a$S.c*a$k.ty+a$S.tx,a$J=a$S.b*a$k.tx+a$S.d*a$k.ty+a$S.ty,a$W=new a$at;this.inheritRotation?(a$j=Math.atan2(a$v.resultMatrix.b,a$v.resultMatrix.a),a$Q=Math.cos(a$j),a$u=Math.sin(a$j),a$W.setTo(a$Q,a$u,-a$u,a$Q,0,0),a$at.mul(this._tempMatrix,a$W,a$at.TEMP),a$at.TEMP.copyTo(a$W),a$k=this.resultTransform.getMatrix(),a$at.mul(a$k,a$W,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,a$k=this.resultTransform.getMatrix(),a$at.TEMP.identity(),a$at.TEMP.d=this.d,a$at.mul(a$k,a$at.TEMP,this.resultMatrix)),this.resultMatrix.tx=a$V,this.resultMatrix.ty=a$J}else(a$k=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var a$w,a$M=0;for(a$M=0,a$w=this._children.length;a$M<a$w;a$M++)this._children[a$M].update()},a$t.updateChild=function(){var a$t,a$k=0;for(a$k=0,a$t=this._children.length;a$k<a$t;a$k++)this._children[a$k].update()},a$t.setRotation=function(a$t){this._sprite&&(this._sprite.rotation=180*a$t/Math.PI)},a$t.updateDraw=function(a$t,a$k){a$Q.ShowBones&&!a$Q.ShowBones[this.name]||(this._sprite||(this._sprite=new a$ut,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),a$Qt.stage.addChild(this._sprite)),this._sprite.x=a$t+this.resultMatrix.tx,this._sprite.y=a$k+this.resultMatrix.ty);var a$v,a$j=0;for(a$j=0,a$v=this._children.length;a$j<a$v;a$j++)this._children[a$j].updateDraw(a$t,a$k)},a$t.addChild=function(a$t){this._children.push(a$t),a$t.parentBone=this},a$t.findBone=function(a$t){if(this.name==a$t)return this;var a$k,a$v,a$j=0;for(a$j=0,a$k=this._children.length;a$j<a$k;a$j++)if(a$v=this._children[a$j].findBone(a$t))return a$v;return null},a$t.localToWorld=function(a$t){var a$k=a$t[0],a$v=a$t[1];a$t[0]=a$k*this.resultMatrix.a+a$v*this.resultMatrix.c+this.resultMatrix.tx,a$t[1]=a$k*this.resultMatrix.b+a$v*this.resultMatrix.d+this.resultMatrix.ty},a$Q.ShowBones={},a$Q}()),a$ct=function(){function a$R(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}a$j(a$R,"laya.ani.bone.BoneSlot");var a$t=a$R.prototype;return a$t.showSlotData=function(a$t,a$k){void 0===a$k&&(a$k=!0),this.currSlotData=a$t,a$k&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},a$t.showDisplayByName=function(a$t){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(a$t))},a$t.replaceDisplayByName=function(a$t,a$k){if(this.currSlotData){var a$v;a$v=this.currSlotData.getDisplayByName(a$t);var a$j;a$j=this.currSlotData.getDisplayByName(a$k),this.replaceDisplayByIndex(a$v,a$j)}},a$t.replaceDisplayByIndex=function(a$t,a$k){this.currSlotData&&(this._replaceDic[a$t]=a$k,this.displayIndex==a$t&&this.showDisplayByIndex(a$t))},a$t.showDisplayByIndex=function(a$t){if(null!=this._replaceDic[a$t]&&(a$t=this._replaceDic[a$t]),this.currSlotData&&-1<a$t&&a$t<this.currSlotData.displayArr.length){if(this.displayIndex=a$t,this.currDisplayData=this.currSlotData.displayArr[a$t],this.currDisplayData){var a$k=this.currDisplayData.name;this.currTexture=this.templet.getTexture(a$k),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!a$h.isConchApp||a$h.isConchApp&&"0.9.15"<a$ut.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},a$t.replaceSkin=function(a$t){this._diyTexture=a$t,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},a$t.setParentMatrix=function(a$t){this._parentMatrix=a$t},a$t.draw=function(a$t,a$k,a$v,a$j){if(void 0===a$v&&(a$v=!1),void 0===a$j&&(a$j=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var a$Q,a$u=this.currTexture;switch(this._diyTexture&&(a$u=this._diyTexture),this.currDisplayData.type){case 0:if(a$t){var a$S=this.getDisplayMatrix();if(this._parentMatrix){var a$V=!1;if(a$S){var a$J;if(a$at.mul(a$S,this._parentMatrix,a$at.TEMP),a$J=a$v?(null==this._resultMatrix&&(this._resultMatrix=new a$at),this._resultMatrix):new a$at,!a$h.isWebGL&&this.currDisplayData.uvs||a$h.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var a$W=a$R._tempMatrix;a$W.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(a$W.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(a$V=!0,a$W.rotate(-Math.PI/2)),a$at.mul(a$W,a$at.TEMP,a$J)}else a$at.TEMP.copyTo(a$J);a$V?a$t.drawTexture(a$u,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,a$J):a$t.drawTexture(a$u,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,a$J)}}}break;case 1:if(null==(a$Q=a$v?(null==this._skinSprite&&(this._skinSprite=a$R.createSkinMesh()),this._skinSprite):a$R.createSkinMesh()))return;var a$w;if(null==this.currDisplayData.bones){var a$M,a$H=this.currDisplayData.weights;this.deformData&&(a$H=this.deformData),a$M=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=a$d.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=a$d.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=a$H;this.currDisplayData.triangles.length;a$w=this.currDisplayData.triangles,a$Q.init2(a$u,null,a$w,this._mVerticleArr,a$M);var a$E,a$A=this.getDisplayMatrix();if(this._parentMatrix)if(a$A)a$at.mul(a$A,this._parentMatrix,a$at.TEMP),a$E=a$v?(null==this._resultMatrix&&(this._resultMatrix=new a$at),this._resultMatrix):new a$at,a$at.TEMP.copyTo(a$E),a$Q.transform=a$E}else this.skinMesh(a$k,a$Q,a$j);a$t.drawSkin(a$Q);break;case 2:if(null==(a$Q=a$v?(null==this._skinSprite&&(this._skinSprite=a$R.createSkinMesh()),this._skinSprite):a$R.createSkinMesh()))return;this.skinMesh(a$k,a$Q,a$j),a$t.drawSkin(a$Q)}}},a$t.skinMesh=function(a$t,a$k,a$v){var a$j,a$Q=this.currTexture,a$u=this.currDisplayData.bones;a$j=this._diyTexture?(a$Q=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=a$d.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=a$d.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var a$S,a$V,a$J=this.currDisplayData.weights,a$W=this.currDisplayData.triangles,a$w=0,a$M=0,a$H=0,a$E=NaN,a$A=NaN,a$R=0,a$h=0,a$l=[],a$o=0,a$Y=0;if(this.deformData&&0<this.deformData.length){var a$f=0;for(a$o=0,a$Y=a$u.length;a$o<a$Y;){for(a$H=a$u[a$o++]+a$o,a$M=a$w=0;a$o<a$H;a$o++)a$V=a$t[a$u[a$o]],a$E=a$J[a$R]+this.deformData[a$f++],a$A=a$J[a$R+1]+this.deformData[a$f++],a$h=a$J[a$R+2],a$w+=(a$E*a$V.a+a$A*a$V.c+a$V.tx)*a$h,a$M+=(a$E*a$V.b+a$A*a$V.d+a$V.ty)*a$h,a$R+=3;a$l.push(a$w,a$M)}}else for(a$o=0,a$Y=a$u.length;a$o<a$Y;){for(a$H=a$u[a$o++]+a$o,a$M=a$w=0;a$o<a$H;a$o++)a$V=a$t[a$u[a$o]],a$E=a$J[a$R],a$A=a$J[a$R+1],a$h=a$J[a$R+2],a$w+=(a$E*a$V.a+a$A*a$V.c+a$V.tx)*a$h,a$M+=(a$E*a$V.b+a$A*a$V.d+a$V.ty)*a$h,a$R+=3;a$l.push(a$w,a$M)}this._mVerticleArr=a$l,a$S=a$W,a$k.init2(a$Q,null,a$S,this._mVerticleArr,a$j)},a$t.drawBonePoint=function(a$t){a$t&&this._parentMatrix&&a$t.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},a$t.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},a$t.getMatrix=function(){return this._resultMatrix},a$t.copy=function(){var a$t=new a$R;return a$t.type="copy",a$t.name=this.name,a$t.attachmentName=this.attachmentName,a$t.srcDisplayIndex=this.srcDisplayIndex,a$t.parent=this.parent,a$t.displayIndex=this.displayIndex,a$t.templet=this.templet,a$t.currSlotData=this.currSlotData,a$t.currTexture=this.currTexture,a$t.currDisplayData=this.currDisplayData,a$t},a$R.createSkinMesh=function(){return a$h.isWebGL||a$h.isConchApp?a$E.skinAniSprite():(a$h.isWebGL,null)},a$v(a$R,["_tempMatrix",function(){return this._tempMatrix=new a$at}]),a$R}(),a$Tt=function(){function a$t(){this.skinName=null,this.deformSlotDataList=[]}return a$j(a$t,"laya.ani.bone.DeformAniData"),a$t}(),a$pt=function(){function a$t(){this.deformSlotDisplayList=[]}return a$j(a$t,"laya.ani.bone.DeformSlotData"),a$t}(),a$Ot=function(){function a$t(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}a$j(a$t,"laya.ani.bone.DeformSlotDisplayData");var a$k=a$t.prototype;return a$k.binarySearch1=function(a$t,a$k){var a$v=0,a$j=a$t.length-2;if(0==a$j)return 1;for(var a$Q=a$j>>>1;;){if(a$t[Math.floor(a$Q+1)]<=a$k?a$v=a$Q+1:a$j=a$Q,a$v==a$j)return a$v+1;a$Q=a$v+a$j>>>1}return 0},a$k.apply=function(a$t,a$k,a$v){if(void 0===a$v&&(a$v=1),a$t+=.05,!(this.timeList.length<=0)){var a$j=0;if(!(a$t<this.timeList[0])){var a$Q=this.vectices[0].length,a$u=[],a$S=this.binarySearch1(this.timeList,a$t);if(this.frameIndex=a$S,a$t>=this.timeList[this.timeList.length-1]){var a$V=this.vectices[this.vectices.length-1];if(a$v<1)for(a$j=0;a$j<a$Q;a$j++)a$u[a$j]+=(a$V[a$j]-a$u[a$j])*a$v;else for(a$j=0;a$j<a$Q;a$j++)a$u[a$j]=a$V[a$j];this.deformData=a$u}else{this.tweenKeyList[this.frameIndex];var a$J=this.vectices[this.frameIndex-1],a$W=this.vectices[this.frameIndex],a$w=this.timeList[this.frameIndex-1],a$M=this.timeList[this.frameIndex];a$v=this.tweenKeyList[a$S-1]?(a$t-a$w)/(a$M-a$w):0;var a$H=NaN;for(a$j=0;a$j<a$Q;a$j++)a$H=a$J[a$j],a$u[a$j]=a$H+(a$W[a$j]-a$H)*a$v;this.deformData=a$u}}}},a$t}(),a$nt=function(){function a$t(){this.time=NaN,this.drawOrder=[]}return a$j(a$t,"laya.ani.bone.DrawOrderData"),a$t}(),a$_t=function(){function a$t(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return a$j(a$t,"laya.ani.bone.EventData"),a$t}(),a$o=function(){function a$jt(a$t,a$k){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=a$t,this._targetBone=a$k[a$t.targetBoneIndex],this.isSpine=a$t.isSpine,null==this._bones&&(this._bones=[]);for(var a$v=this._bones.length=0,a$j=a$t.boneIndexs.length;a$v<a$j;a$v++)this._bones.push(a$k[a$t.boneIndexs[a$v]]);this.name=a$t.name,this.mix=a$t.mix,this.bendDirection=a$t.bendDirection}a$j(a$jt,"laya.ani.bone.IkConstraint");var a$t=a$jt.prototype;return a$t.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},a$t._applyIk1=function(a$t,a$k,a$v,a$j){var a$Q=a$t.parentBone,a$u=1/(a$Q.resultMatrix.a*a$Q.resultMatrix.d-a$Q.resultMatrix.b*a$Q.resultMatrix.c),a$S=a$k-a$Q.resultMatrix.tx,a$V=a$v-a$Q.resultMatrix.ty,a$J=(a$S*a$Q.resultMatrix.d-a$V*a$Q.resultMatrix.c)*a$u-a$t.transform.x,a$W=(a$V*a$Q.resultMatrix.a-a$S*a$Q.resultMatrix.b)*a$u-a$t.transform.y,a$w=Math.atan2(a$W,a$J)*a$jt.radDeg-0-a$t.transform.skX;a$t.transform.scX<0&&(a$w+=180),180<a$w?a$w-=360:a$w<-180&&(a$w+=360),a$t.transform.skX=a$t.transform.skY=a$t.transform.skX+a$w*a$j,a$t.update()},a$t.updatePos=function(a$t,a$k){this._sp&&this._sp.pos(a$t,a$k)},a$t._applyIk2=function(a$t,a$k,a$v,a$j,a$Q,a$u){if(0!=a$u){var a$S=a$t.resultTransform.x,a$V=a$t.resultTransform.y,a$J=a$t.transform.scX,a$W=a$t.transform.scY,a$w=a$k.transform.scX,a$M=0,a$H=0,a$E=0;a$E=a$J<0?(a$J=-a$J,a$M=180,-1):(a$M=0,1),a$W<0&&(a$W=-a$W,a$E=-a$E),a$H=a$w<0?(a$w=-a$w,180):0;var a$A=a$k.resultTransform.x,a$R=NaN,a$h=NaN,a$l=NaN,a$o=a$t.resultMatrix.a,a$Y=a$t.resultMatrix.c,a$f=a$t.resultMatrix.b,a$X=a$t.resultMatrix.d,a$F=Math.abs(a$J-a$W)<=1e-4;a$l=a$F?(a$h=a$o*a$A+a$Y*(a$R=a$k.resultTransform.y)+a$t.resultMatrix.tx,a$f*a$A+a$X*a$R+a$t.resultMatrix.ty):(a$R=0,a$h=a$o*a$A+a$t.resultMatrix.tx,a$f*a$A+a$t.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new a$ut,a$Qt.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(a$v,a$j,15,"#ffff00"),this._sp.graphics.drawCircle(a$h,a$l,15,"#ff00ff")),a$t.setRotation(Math.atan2(a$l-a$t.resultMatrix.ty,a$h-a$t.resultMatrix.tx));var a$d=a$t.parentBone;a$o=a$d.resultMatrix.a,a$Y=a$d.resultMatrix.c,a$f=a$d.resultMatrix.b;var a$m=1/(a$o*(a$X=a$d.resultMatrix.d)-a$Y*a$f),a$Z=a$v-a$d.resultMatrix.tx,a$s=a$j-a$d.resultMatrix.ty,a$K=(a$Z*a$X-a$s*a$Y)*a$m-a$S,a$U=(a$s*a$o-a$Z*a$f)*a$m-a$V,a$N=((a$Z=a$h-a$d.resultMatrix.tx)*a$X-(a$s=a$l-a$d.resultMatrix.ty)*a$Y)*a$m-a$S,a$a=(a$s*a$o-a$Z*a$f)*a$m-a$V,a$z=Math.sqrt(a$N*a$N+a$a*a$a),a$G=a$k.length*a$w,a$c=NaN,a$T=NaN;if(a$F){var a$p=(a$K*a$K+a$U*a$U-a$z*a$z-(a$G*=a$J)*a$G)/(2*a$z*a$G);a$p<-1?a$p=-1:1<a$p&&(a$p=1),a$T=Math.acos(a$p)*a$Q,a$o=a$z+a$G*a$p,a$Y=a$G*Math.sin(a$T),a$c=Math.atan2(a$U*a$o-a$K*a$Y,a$K*a$o+a$U*a$Y)}else{var a$O=(a$o=a$J*a$G)*a$o,a$n=(a$Y=a$W*a$G)*a$Y,a$_=a$K*a$K+a$U*a$U,a$x=Math.atan2(a$U,a$K),a$I=-2*a$n*a$z,a$i=a$n-a$O;if(0<(a$X=a$I*a$I-4*a$i*(a$f=a$n*a$z*a$z+a$O*a$_-a$O*a$n))){var a$D=Math.sqrt(a$X);a$I<0&&(a$D=-a$D);var a$B=(a$D=-(a$I+a$D)/2)/a$i,a$b=a$f/a$D,a$q=Math.abs(a$B)<Math.abs(a$b)?a$B:a$b;a$q*a$q<=a$_&&(a$s=Math.sqrt(a$_-a$q*a$q)*a$Q,a$c=a$x-Math.atan2(a$s,a$q),a$T=Math.atan2(a$s/a$W,(a$q-a$z)/a$J))}var a$C=0,a$L=Number.MAX_VALUE,a$e=0,a$r=0,a$g=0,a$$=0,a$y=0,a$P=0;a$$<(a$X=(a$Z=a$z+a$o)*a$Z)&&(a$g=0,a$$=a$X,a$y=a$Z),(a$X=(a$Z=a$z-a$o)*a$Z)<a$L&&(a$C=Math.PI,a$L=a$X,a$e=a$Z);var a$tt=Math.acos(-a$o*a$z/(a$O-a$n));(a$X=(a$Z=a$o*Math.cos(a$tt)+a$z)*a$Z+(a$s=a$Y*Math.sin(a$tt))*a$s)<a$L&&(a$C=a$tt,a$L=a$X,a$e=a$Z,a$r=a$s),a$$<a$X&&(a$g=a$tt,a$$=a$X,a$y=a$Z,a$P=a$s),a$T=a$_<=(a$L+a$$)/2?(a$c=a$x-Math.atan2(a$r*a$Q,a$e),a$C*a$Q):(a$c=a$x-Math.atan2(a$P*a$Q,a$y),a$g*a$Q)}var a$kt=Math.atan2(a$R,a$A)*a$E,a$vt=a$t.resultTransform.skX;180<(a$c=(a$c-a$kt)*a$jt.radDeg+a$M-a$vt)?a$c-=360:a$c<-180&&(a$c+=360),a$t.resultTransform.x=a$S,a$t.resultTransform.y=a$V,a$t.resultTransform.skX=a$t.resultTransform.skY=a$vt+a$c*a$u,a$vt=a$k.resultTransform.skX,180<(a$T=((a$T+a$kt)*a$jt.radDeg-0)*a$E+a$H-(a$vt%=360))?a$T-=360:a$T<-180&&(a$T+=360),a$k.resultTransform.x=a$A,a$k.resultTransform.y=a$R,a$k.resultTransform.skX=a$k.resultTransform.skY=a$k.resultTransform.skY+a$T*a$u,a$t.update()}},a$t._applyIk3=function(a$t,a$k,a$v,a$j,a$Q,a$u){if(0!=a$u){var a$S,a$V,a$J=a$k.resultMatrix.a*a$k.length,a$W=a$k.resultMatrix.b*a$k.length,a$w=a$J*a$J+a$W*a$W,a$M=Math.sqrt(a$w),a$H=a$t.resultMatrix.tx,a$E=a$t.resultMatrix.ty,a$A=a$k.resultMatrix.tx,a$R=a$k.resultMatrix.ty,a$h=a$A-a$H,a$l=a$R-a$E,a$o=a$h*a$h+a$l*a$l,a$Y=Math.sqrt(a$o),a$f=(a$h=a$v-a$t.resultMatrix.tx)*a$h+(a$l=a$j-a$t.resultMatrix.ty)*a$l,a$X=Math.sqrt(a$f);if(a$M+a$Y<=a$X||a$X+a$M<=a$Y||a$X+a$Y<=a$M){var a$F=NaN;a$A=a$H+(a$F=a$M+a$Y<=a$X?1:-1)*(a$v-a$H)*a$Y/a$X,a$R=a$E+a$F*(a$j-a$E)*a$Y/a$X}else{var a$d=(a$o-a$w+a$f)/(2*a$f),a$m=Math.sqrt(a$o-a$d*a$d*a$f)/a$X,a$Z=a$H+a$h*a$d,a$s=a$E+a$l*a$d,a$K=-a$l*a$m,a$U=a$h*a$m;a$R=0<a$Q?(a$A=a$Z-a$K,a$s-a$U):(a$A=a$Z+a$K,a$s+a$U)}a$S=a$A,a$V=a$R,this.isDebug&&(this._sp||(this._sp=new a$ut,a$Qt.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(a$H,a$E,15,"#ff00ff"),this._sp.graphics.drawCircle(a$v,a$j,15,"#ffff00"),this._sp.graphics.drawCircle(a$S,a$V,15,"#ff00ff"));var a$N,a$a;a$N=Math.atan2(a$V-a$t.resultMatrix.ty,a$S-a$t.resultMatrix.tx),a$t.setRotation(a$N),(a$a=a$jt._tempMatrix).identity(),a$a.rotate(a$N),a$a.scale(a$t.resultMatrix.getScaleX(),a$t.resultMatrix.getScaleY()),a$a.translate(a$t.resultMatrix.tx,a$t.resultMatrix.ty),a$a.copyTo(a$t.resultMatrix),a$t.updateChild();var a$z,a$G;a$z=Math.atan2(a$j-a$V,a$v-a$S),a$k.setRotation(a$z),(a$G=a$jt._tempMatrix).identity(),a$G.rotate(a$z),a$G.scale(a$k.resultMatrix.getScaleX(),a$k.resultMatrix.getScaleY()),a$G.translate(a$S,a$V),a$a.copyTo(a$k.resultMatrix),a$k.updateChild()}},a$v(a$jt,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new a$at}]),a$jt}(),a$xt=function(){function a$t(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return a$j(a$t,"laya.ani.bone.IkConstraintData"),a$t}(),a$X=function(){function a$G(a$t,a$k){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=a$t,this.position=a$t.position,this.spacing=a$t.spacing,this.rotateMix=a$t.rotateMix,this.translateMix=a$t.translateMix,this.bones=[];for(var a$v=this.data.bones,a$j=0,a$Q=a$v.length;a$j<a$Q;a$j++)this.bones.push(a$k[a$v[a$j]])}a$j(a$G,"laya.ani.bone.PathConstraint");var a$t=a$G.prototype;return a$t.apply=function(a$t,a$k){if(this.target){var a$v=this.translateMix,a$j=this.translateMix,a$Q=0<a$j,a$u=this.data.spacingMode,a$S="length"==a$u,a$V=this.data.rotateMode,a$J="tangent"==a$V,a$W="chainScale"==a$V,a$w=[],a$M=this.bones.length,a$H=a$J?a$M:a$M+1,a$E=[];(this._spaces=a$E)[0]=this.position;var a$A=this.spacing;if(a$W||a$S)for(var a$R=0,a$h=a$H-1;a$R<a$h;){var a$l=this.bones[a$R],a$o=a$l.length,a$Y=a$o*a$l.resultMatrix.a,a$f=a$o*a$l.resultMatrix.b;a$o=Math.sqrt(a$Y*a$Y+a$f*a$f),a$W&&(a$w[a$R]=a$o),a$E[++a$R]=a$S?Math.max(0,a$o+a$A):a$A}else for(a$R=1;a$R<a$H;a$R++)a$E[a$R]=a$A;var a$X=this.computeWorldPositions(this.target,a$t,a$k,a$H,a$J,"percent"==this.data.positionMode,"percent"==a$u);if(this._debugKey){for(a$R=0;a$R<a$X.length;a$R++)a$k.drawCircle(a$X[a$R++],a$X[a$R++],5,"#00ff00");var a$F=[];for(a$R=0;a$R<a$X.length;a$R++)a$F.push(a$X[a$R++],a$X[a$R++]);a$k.drawLines(0,0,a$F,"#ff0000")}var a$d=a$X[0],a$m=a$X[1],a$Z=this.data.offsetRotation,a$s="chain"==a$V&&0==a$Z,a$K=NaN;for(a$R=0,a$K=3;a$R<a$M;a$R++,a$K+=3){(a$l=this.bones[a$R]).resultMatrix.tx+=(a$d-a$l.resultMatrix.tx)*a$v,a$l.resultMatrix.ty+=(a$m-a$l.resultMatrix.ty)*a$v;var a$U=(a$Y=a$X[a$K])-a$d,a$N=(a$f=a$X[a$K+1])-a$m;if(a$W&&0!=(a$o=a$w[a$R])){var a$a=(Math.sqrt(a$U*a$U+a$N*a$N)/a$o-1)*a$j+1;a$l.resultMatrix.a*=a$a,a$l.resultMatrix.c*=a$a}if(a$d=a$Y,a$m=a$f,a$Q){var a$z=a$l.resultMatrix.a,a$G=a$l.resultMatrix.c,a$c=a$l.resultMatrix.b,a$T=a$l.resultMatrix.d,a$p=NaN,a$O=NaN,a$n=NaN;a$p=a$J?a$X[a$K-1]:0==a$E[a$R+1]?a$X[a$K+2]:Math.atan2(a$N,a$U),a$p-=Math.atan2(a$c,a$z)-a$Z/180*Math.PI,a$s&&(a$O=Math.cos(a$p),a$n=Math.sin(a$p),a$d+=((a$o=a$l.length)*(a$O*a$z-a$n*a$c)-a$U)*a$j,a$m+=(a$o*(a$n*a$z+a$O*a$c)-a$N)*a$j),a$p>Math.PI?a$p-=2*Math.PI:a$p<-Math.PI&&(a$p+=2*Math.PI),a$p*=a$j,a$O=Math.cos(a$p),a$n=Math.sin(a$p),a$l.resultMatrix.a=a$O*a$z-a$n*a$c,a$l.resultMatrix.c=a$O*a$G-a$n*a$T,a$l.resultMatrix.b=a$n*a$z+a$O*a$c,a$l.resultMatrix.d=a$n*a$G+a$O*a$T}}}},a$t.computeWorldVertices2=function(a$t,a$k,a$v,a$j,a$Q,a$u){var a$S,a$V,a$J=a$t.currDisplayData.bones,a$W=a$t.currDisplayData.weights,a$w=a$t.currDisplayData.triangles,a$M=0,a$H=0,a$E=0,a$A=0,a$R=0,a$h=0,a$l=0,a$o=0,a$Y=0,a$f=0,a$X=0;if(null!=a$J){for(a$M=0;a$M<a$v;a$M+=2)a$H+=(a$A=a$J[a$H])+1,a$E+=a$A;var a$F=a$k;for(a$R=a$u,a$h=3*a$E;a$R<a$j;a$R+=2){for(a$o=a$l=0,a$A=a$J[a$H++],a$A+=a$H;a$H<a$A;a$H++,a$h+=3){a$S=a$F[a$J[a$H]].resultMatrix,a$Y=a$W[a$h],a$f=a$W[a$h+1];var a$d=a$W[a$h+2];a$l+=(a$Y*a$S.a+a$f*a$S.c+a$S.tx)*a$d,a$o+=(a$Y*a$S.b+a$f*a$S.d+a$S.ty)*a$d}a$Q[a$R]=a$l,a$Q[a$R+1]=a$o}}else{var a$m,a$Z;if(a$w||(a$w=a$W),a$t.deformData&&(a$w=a$t.deformData),a$m=a$t.parent,a$k)for(a$X=a$k.length,a$M=0;a$M<a$X;a$M++)if(a$k[a$M].name==a$m){a$V=a$k[a$M];break}a$V&&(a$Z=a$V.resultMatrix),a$Z||(a$Z=a$G._tempMt);var a$s=a$Z.tx,a$K=a$Z.ty,a$U=a$Z.a,a$N=a$Z.b,a$a=a$Z.c,a$z=a$Z.d;for(a$V&&(a$z*=a$V.d),a$H=a$v,a$R=a$u;a$R<a$j;a$H+=2,a$R+=2)a$Y=a$w[a$H],a$f=a$w[a$H+1],a$Q[a$R]=a$Y*a$U+a$f*a$N+a$s,a$Q[a$R+1]=-(a$Y*a$a+a$f*a$z+a$K)}},a$t.computeWorldPositions=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S){a$t.currDisplayData.bones,a$t.currDisplayData.weights,a$t.currDisplayData.triangles;var a$V=[],a$J=0,a$W=a$t.currDisplayData.verLen,a$w=this.position,a$M=this._spaces,a$H=[],a$E=[],a$A=a$W/6,a$R=-1,a$h=NaN,a$l=0,a$o=0,a$Y=NaN,a$f=NaN,a$X=NaN,a$F=NaN;if(a$A--,a$W-=4,this.computeWorldVertices2(a$t,a$k,2,a$W,a$V,0),this._debugKey)for(a$J=0;a$J<a$V.length;)a$v.drawCircle(a$V[a$J++],a$V[a$J++],10,"#ff0000");a$H=a$V,this._curves.length=a$A;var a$d=this._curves,a$m=a$H[a$h=0],a$Z=a$H[1],a$s=0,a$K=0,a$U=0,a$N=0,a$a=0,a$z=0,a$G=NaN,a$c=NaN,a$T=NaN,a$p=NaN,a$O=NaN,a$n=NaN,a$_=NaN,a$x=NaN,a$I=0;for(a$J=0,a$I=2;a$J<a$A;a$J++,a$I+=6)a$s=a$H[a$I],a$K=a$H[a$I+1],a$U=a$H[a$I+2],a$N=a$H[a$I+3],a$O=2*(a$G=.1875*(a$m-2*a$s+a$U))+(a$T=.09375*(3*(a$s-a$U)-a$m+(a$a=a$H[a$I+4]))),a$n=2*(a$c=.1875*(a$Z-2*a$K+a$N))+(a$p=.09375*(3*(a$K-a$N)-a$Z+(a$z=a$H[a$I+5]))),a$_=.75*(a$s-a$m)+a$G+.16666667*a$T,a$x=.75*(a$K-a$Z)+a$c+.16666667*a$p,a$h+=Math.sqrt(a$_*a$_+a$x*a$x),a$_+=a$O,a$x+=a$n,a$O+=a$T,a$n+=a$p,a$h+=Math.sqrt(a$_*a$_+a$x*a$x),a$_+=a$O,a$x+=a$n,a$h+=Math.sqrt(a$_*a$_+a$x*a$x),a$_+=a$O+a$T,a$x+=a$n+a$p,a$h+=Math.sqrt(a$_*a$_+a$x*a$x),a$d[a$J]=a$h,a$m=a$a,a$Z=a$z;if(a$u&&(a$w*=a$h),a$S)for(a$J=0;a$J<a$j;a$J++)a$M[a$J]*=a$h;var a$i=this._segments,a$D=0,a$B=0;for(a$B=a$o=a$l=a$J=0;a$J<a$j;a$J++,a$l+=3)if((a$Y=a$w+=a$f=a$M[a$J])<0)this.addBeforePosition(a$Y,a$H,0,a$E,a$l);else if(a$h<a$Y)this.addAfterPosition(a$Y-a$h,a$H,a$W-4,a$E,a$l);else{for(;;a$o++)if(!((a$F=a$d[a$o])<a$Y)){0==a$o?a$Y/=a$F:a$Y=(a$Y-(a$X=a$d[a$o-1]))/(a$F-a$X);break}if(a$o!=a$R){var a$b=6*(a$R=a$o);for(a$m=a$H[a$b],a$Z=a$H[a$b+1],a$s=a$H[a$b+2],a$K=a$H[a$b+3],a$U=a$H[a$b+4],a$N=a$H[a$b+5],a$O=2*(a$G=.03*(a$m-2*a$s+a$U))+(a$T=.006*(3*(a$s-a$U)-a$m+(a$a=a$H[a$b+6]))),a$n=2*(a$c=.03*(a$Z-2*a$K+a$N))+(a$p=.006*(3*(a$K-a$N)-a$Z+(a$z=a$H[a$b+7]))),a$_=.3*(a$s-a$m)+a$G+.16666667*a$T,a$x=.3*(a$K-a$Z)+a$c+.16666667*a$p,a$D=Math.sqrt(a$_*a$_+a$x*a$x),a$i[0]=a$D,a$b=1;a$b<8;a$b++)a$_+=a$O,a$x+=a$n,a$O+=a$T,a$n+=a$p,a$D+=Math.sqrt(a$_*a$_+a$x*a$x),a$i[a$b]=a$D;a$_+=a$O,a$x+=a$n,a$D+=Math.sqrt(a$_*a$_+a$x*a$x),a$i[8]=a$D,a$_+=a$O+a$T,a$x+=a$n+a$p,a$D+=Math.sqrt(a$_*a$_+a$x*a$x),a$i[9]=a$D,a$B=0}for(a$Y*=a$D;;a$B++)if(!((a$F=a$i[a$B])<a$Y)){0==a$B?a$Y/=a$F:a$Y=a$B+(a$Y-(a$X=a$i[a$B-1]))/(a$F-a$X);break}this.addCurvePosition(.1*a$Y,a$m,a$Z,a$s,a$K,a$U,a$N,a$a,a$z,a$E,a$l,a$Q||0<a$J&&0==a$f)}return a$E},a$t.addBeforePosition=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$k[a$v],a$S=a$k[a$v+1],a$V=a$k[a$v+2]-a$u,a$J=a$k[a$v+3]-a$S,a$W=Math.atan2(a$J,a$V);a$j[a$Q]=a$u+a$t*Math.cos(a$W),a$j[a$Q+1]=a$S+a$t*Math.sin(a$W),a$j[a$Q+2]=a$W},a$t.addAfterPosition=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$k[a$v+2],a$S=a$k[a$v+3],a$V=a$u-a$k[a$v],a$J=a$S-a$k[a$v+1],a$W=Math.atan2(a$J,a$V);a$j[a$Q]=a$u+a$t*Math.cos(a$W),a$j[a$Q+1]=a$S+a$t*Math.sin(a$W),a$j[a$Q+2]=a$W},a$t.addCurvePosition=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w,a$M){0==a$t&&(a$t=1e-4);var a$H=a$t*a$t,a$E=a$H*a$t,a$A=1-a$t,a$R=a$A*a$A,a$h=a$R*a$A,a$l=a$A*a$t,a$o=3*a$l,a$Y=a$A*a$o,a$f=a$o*a$t,a$X=a$k*a$h+a$j*a$Y+a$u*a$f+a$V*a$E,a$F=a$v*a$h+a$Q*a$Y+a$S*a$f+a$J*a$E;a$W[a$w]=a$X,a$W[a$w+1]=a$F,a$W[a$w+2]=a$M?Math.atan2(a$F-(a$v*a$R+a$Q*a$l*2+a$S*a$H),a$X-(a$k*a$R+a$j*a$l*2+a$u*a$H)):0},a$G.NONE=-1,a$G.BEFORE=-2,a$G.AFTER=-3,a$v(a$G,["_tempMt",function(){return this._tempMt=new a$at}]),a$G}(),a$It=function(){function a$t(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return a$j(a$t,"laya.ani.bone.PathConstraintData"),a$t}(),a$it=function(){function a$t(){this.name=null,this.slotArr=[]}return a$j(a$t,"laya.ani.bone.SkinData"),a$t}(),a$Dt=function(){function a$t(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}a$j(a$t,"laya.ani.bone.SkinSlotDisplayData");var a$k=a$t.prototype;return a$k.createTexture=function(a$t){return this.texture||(this.texture=new a$zt(a$t.bitmap,this.uvs),a$t.bitmap.alphaTexture&&(this.texture.alphaTexture=new a$zt(a$t.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=a$t.height,this.texture.height=a$t.width,this.texture.offsetX=-a$t.offsetX,this.texture.offsetY=-a$t.offsetY,this.texture.sourceWidth=a$t.sourceHeight,this.texture.sourceHeight=a$t.sourceWidth):(this.texture.width=a$t.width,this.texture.height=a$t.height,this.texture.offsetX=-a$t.offsetX,this.texture.offsetY=-a$t.offsetY,this.texture.sourceWidth=a$t.sourceWidth,this.texture.sourceHeight=a$t.sourceHeight),a$h.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},a$k.destory=function(){this.texture&&this.texture.destroy()},a$t}(),a$Bt=function(){function a$t(){this.name=null,this.displayArr=[]}return a$j(a$t,"laya.ani.bone.SlotData"),a$t.prototype.getDisplayByName=function(a$t){for(var a$k=0,a$v=this.displayArr.length;a$k<a$v;a$k++)if(this.displayArr[a$k].attachmentName==a$t)return a$k;return-1},a$t}(),a$F=function(){function a$t(a$t,a$k){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=a$R(2,0),this._data=a$t,null==this._bones&&(this._bones=[]),this.target=a$k[a$t.targetIndex];var a$v,a$j=0;for(a$j=0,a$v=a$t.boneIndexs.length;a$j<a$v;a$j++)this._bones.push(a$k[a$t.boneIndexs[a$j]]);this.rotateMix=a$t.rotateMix,this.translateMix=a$t.translateMix,this.scaleMix=a$t.scaleMix,this.shearMix=a$t.shearMix}return a$j(a$t,"laya.ani.bone.TfConstraint"),a$t.prototype.apply=function(){for(var a$t,a$k=this.target.resultMatrix.a,a$v=this.target.resultMatrix.b,a$j=this.target.resultMatrix.c,a$Q=this.target.resultMatrix.d,a$u=0,a$S=this._bones.length;a$u<a$S;a$u++){if(a$t=this._bones[a$u],0<this.rotateMix){var a$V=a$t.resultMatrix.a,a$J=a$t.resultMatrix.b,a$W=a$t.resultMatrix.c,a$w=a$t.resultMatrix.d,a$M=Math.atan2(a$j,a$k)-Math.atan2(a$W,a$V)+this._data.offsetRotation*Math.PI/180;a$M>Math.PI?a$M-=2*Math.PI:a$M<-Math.PI&&(a$M+=2*Math.PI),a$M*=this.rotateMix;var a$H=Math.cos(a$M),a$E=Math.sin(a$M);a$t.resultMatrix.a=a$H*a$V-a$E*a$W,a$t.resultMatrix.b=a$H*a$J-a$E*a$w,a$t.resultMatrix.c=a$E*a$V+a$H*a$W,a$t.resultMatrix.d=a$E*a$J+a$H*a$w}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),a$t.resultMatrix.tx+=(this._temp[0]-a$t.resultMatrix.tx)*this.translateMix,a$t.resultMatrix.ty+=(this._temp[1]-a$t.resultMatrix.ty)*this.translateMix,a$t.updateChild()),0<this.scaleMix){var a$A=Math.sqrt(a$t.resultMatrix.a*a$t.resultMatrix.a+a$t.resultMatrix.c*a$t.resultMatrix.c),a$R=Math.sqrt(a$k*a$k+a$j*a$j),a$h=1e-5<a$A?(a$A+(a$R-a$A+this._data.offsetScaleX)*this.scaleMix)/a$A:0;a$t.resultMatrix.a*=a$h,a$t.resultMatrix.c*=a$h,a$A=Math.sqrt(a$t.resultMatrix.b*a$t.resultMatrix.b+a$t.resultMatrix.d*a$t.resultMatrix.d),a$R=Math.sqrt(a$v*a$v+a$Q*a$Q),a$h=1e-5<a$A?(a$A+(a$R-a$A+this._data.offsetScaleY)*this.scaleMix)/a$A:0,a$t.resultMatrix.b*=a$h,a$t.resultMatrix.d*=a$h}if(0<this.shearMix){a$J=a$t.resultMatrix.b,a$w=a$t.resultMatrix.d;var a$l=Math.atan2(a$w,a$J);(a$M=Math.atan2(a$Q,a$v)-Math.atan2(a$j,a$k)-(a$l-Math.atan2(a$t.resultMatrix.c,a$t.resultMatrix.a)))>Math.PI?a$M-=2*Math.PI:a$M<-Math.PI&&(a$M+=2*Math.PI),a$M=a$l+(a$M+this._data.offsetShearY*Math.PI/180)*this.shearMix,a$h=Math.sqrt(a$J*a$J+a$w*a$w),a$t.resultMatrix.b=Math.cos(a$M)*a$h,a$t.resultMatrix.d=Math.sin(a$M)*a$h}}},a$t}(),a$bt=function(){function a$t(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return a$j(a$t,"laya.ani.bone.TfConstraintData"),a$t}(),a$qt=function(){function a$t(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}a$j(a$t,"laya.ani.bone.Transform");var a$k=a$t.prototype;return a$k.initData=function(a$t){null!=a$t.x&&(this.x=a$t.x),null!=a$t.y&&(this.y=a$t.y),null!=a$t.skX&&(this.skX=a$t.skX),null!=a$t.skY&&(this.skY=a$t.skY),null!=a$t.scX&&(this.scX=a$t.scX),null!=a$t.scY&&(this.scY=a$t.scY)},a$k.getMatrix=function(){var a$t;return(a$t=this.mMatrix?this.mMatrix:this.mMatrix=new a$at).identity(),a$t.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(a$t,this.skewX*Math.PI/180,this.skewY*Math.PI/180),a$t.rotate(this.skX*Math.PI/180),a$t.translate(this.x,this.y),a$t},a$k.skew=function(a$t,a$k,a$v){var a$j=Math.sin(a$v),a$Q=Math.cos(a$v),a$u=Math.sin(a$k),a$S=Math.cos(a$k);return a$t.setTo(a$t.a*a$S-a$t.b*a$j,a$t.a*a$u+a$t.b*a$Q,a$t.c*a$S-a$t.d*a$j,a$t.c*a$u+a$t.d*a$Q,a$t.tx*a$S-a$t.ty*a$j,a$t.tx*a$u+a$t.ty*a$Q),a$t},a$t}(),a$d=function(){function a$t(){}return a$j(a$t,"laya.ani.bone.UVTools"),a$t.getRelativeUV=function(a$t,a$k,a$v){var a$j=a$t[0],a$Q=a$t[2]-a$t[0],a$u=a$t[1],a$S=a$t[5]-a$t[1];a$v||(a$v=[]),a$v.length=a$k.length;var a$V,a$J=0;a$V=a$v.length;var a$W=1/a$Q,a$w=1/a$S;for(a$J=0;a$J<a$V;a$J+=2)a$v[a$J]=(a$k[a$J]-a$j)*a$W,a$v[a$J+1]=(a$k[a$J+1]-a$u)*a$w;return a$v},a$t.getAbsoluteUV=function(a$t,a$k,a$v){if(0==a$t[0]&&0==a$t[1]&&1==a$t[4]&&1==a$t[5])return a$v?(a$l.copyArray(a$v,a$k),a$v):a$k;var a$j=a$t[0],a$Q=a$t[2]-a$t[0],a$u=a$t[1],a$S=a$t[5]-a$t[1];a$v||(a$v=[]),a$v.length=a$k.length;var a$V,a$J=0;for(a$V=a$v.length,a$J=0;a$J<a$V;a$J+=2)a$v[a$J]=a$k[a$J]*a$Q+a$j,a$v[a$J+1]=a$k[a$J+1]*a$S+a$u;return a$v},a$t}(),a$G=function(){function a$t(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return a$j(a$t,"laya.ani.KeyFramesContent"),a$t}(),a$m=function(){function a$w(){}return a$j(a$w,"laya.ani.math.BezierLerp"),a$w.getBezierRate=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$w._getBezierParamKey(a$k,a$v,a$j,a$Q),a$S=100*a$u+a$t;if(a$w._bezierResultCache[a$S])return a$w._bezierResultCache[a$S];var a$V,a$J=a$w._getBezierPoints(a$k,a$v,a$j,a$Q,a$u),a$W=0;for(a$V=a$J.length,a$W=0;a$W<a$V;a$W+=2)if(a$t<=a$J[a$W])return a$w._bezierResultCache[a$S]=a$J[a$W+1],a$J[a$W+1];return a$w._bezierResultCache[a$S]=1},a$w._getBezierParamKey=function(a$t,a$k,a$v,a$j){return 100*(100*(100*(100*a$t+a$k)+a$v)+a$j)},a$w._getBezierPoints=function(a$t,a$k,a$v,a$j,a$Q){return a$w._bezierPointsCache[a$Q]?a$w._bezierPointsCache[a$Q]:(a$u=[0,0,a$t,a$k,a$v,a$j,1,1],a$S=(new a$V).getBezierPoints(a$u,100,3),a$w._bezierPointsCache[a$Q]=a$S);var a$u,a$S},a$w._bezierResultCache={},a$w._bezierPointsCache={},a$w}(),a$Z=function(a$t){function a$k(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,a$k.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}a$j(a$k,"laya.ani.AnimationPlayer",a$Q);var a$v=a$k.prototype;return a$Qt.imps(a$v,{"laya.resource.IDestroy":!0}),a$v._onTempletLoadedComputeFullKeyframeIndices=function(a$t,a$k,a$v){this._templet===a$v&&this._cachePlayRate===a$t&&this._cacheFrameRate===a$k&&this._computeFullKeyframeIndices()},a$v._computeFullKeyframeIndices=function(){for(var a$t=this._fullFrames=[],a$k=this._templet,a$v=this._cacheFrameRateInterval*this._cachePlayRate,a$j=0,a$Q=a$k.getAnimationCount();a$j<a$Q;a$j++){for(var a$u=[],a$S=0,a$V=a$k.getAnimation(a$j).nodes.length;a$S<a$V;a$S++){for(var a$J=a$k.getAnimation(a$j).nodes[a$S],a$W=Math.floor(a$J.playTime/a$v+.01),a$w=new Uint16Array(a$W+1),a$M=-1,a$H=0,a$E=a$J.keyFrame.length;a$H<a$E;a$H++){var a$A=a$J.keyFrame[a$H],a$R=a$A.startTime,a$h=a$R+a$A.duration+a$v;do{for(var a$l=Math.floor(a$R/a$v+.5),a$o=a$M+1;a$o<a$l;a$o++)a$w[a$o]=a$H;a$w[a$M=a$l]=a$H,a$R+=a$v}while(a$R<=a$h)}a$u.push(a$w)}a$t.push(a$u)}},a$v._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},a$v._calculatePlayDuration=function(){if(0!==this.state){var a$t=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=a$t),this._playEnd>a$t&&(this._playEnd=a$t),this._playDuration=this._playEnd-this._playStart}},a$v._setPlayParams=function(a$t,a$k){this._currentTime=a$t,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/a$k+.01),0),this._currentFrameTime=this._currentKeyframeIndex*a$k},a$v._setPlayParamsWhenStop=function(a$t,a$k){this._currentTime=a$t,this._currentKeyframeIndex=Math.max(Math.floor(a$t/a$k+.01),0),this._currentFrameTime=this._currentKeyframeIndex*a$k,this._currentAnimationClipIndex=-1},a$v._update=function(a$t){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var a$k=this._cacheFrameRateInterval*this._cachePlayRate,a$v=0;this._startUpdateLoopCount!==a$A.loopCount&&(a$v=a$t*this.playbackRate,this._elapsedPlaybackTime+=a$v);var a$j=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=a$j)return this._setPlayParamsWhenStop(a$j,a$k),void this.event("stopped");if(a$v+=this._currentTime,0<a$j)if(a$j<=a$v)do{if(a$v-=a$j,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(a$j,a$k),this._stopWhenCircleFinish=!1,void this.event("stopped");a$v<a$j&&(this._setPlayParams(a$v,a$k),this.event("complete"))}while(a$j<=a$v);else this._setPlayParams(a$v,a$k);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(a$j,a$k),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},a$v._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},a$v.play=function(a$t,a$k,a$v,a$j,a$Q){if(void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=1),void 0===a$v&&(a$v=2147483647),void 0===a$j&&(a$j=0),void 0===a$Q&&(a$Q=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(a$v<0||a$j<0||a$Q<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==a$Q&&a$Q<a$j)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=a$k,this._overallDuration=a$v,this._playStart=a$j,this._playEnd=a$Q,this._paused=!1,this._currentAnimationClipIndex=a$t,this._currentKeyframeIndex=0,this._startUpdateLoopCount=a$A.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},a$v.playByFrame=function(a$t,a$k,a$v,a$j,a$Q,a$u){void 0===a$t&&(a$t=0),void 0===a$k&&(a$k=1),void 0===a$v&&(a$v=2147483647),void 0===a$j&&(a$j=0),void 0===a$Q&&(a$Q=0),void 0===a$u&&(a$u=30);var a$S=1e3/a$u;this.play(a$t,a$k,a$v,a$j*a$S,a$Q*a$S)},a$v.stop=function(a$t){void 0===a$t&&(a$t=!0),a$t?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},a$u(0,a$v,"playEnd",function(){return this._playEnd}),a$u(0,a$v,"templet",function(){return this._templet},function(a$t){0===!this.state&&this.stop(!0),this._templet!==a$t&&((this._templet=a$t).loaded?this._computeFullKeyframeIndices():a$t.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),a$u(0,a$v,"playStart",function(){return this._playStart}),a$u(0,a$v,"playDuration",function(){return this._playDuration}),a$u(0,a$v,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),a$u(0,a$v,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),a$u(0,a$v,"overallDuration",function(){return this._overallDuration}),a$u(0,a$v,"currentFrameTime",function(){return this._currentFrameTime}),a$u(0,a$v,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),a$u(0,a$v,"currentPlayTime",function(){return this._currentTime+this._playStart}),a$u(0,a$v,"cachePlayRate",function(){return this._cachePlayRate},function(a$t){this._cachePlayRate!==a$t&&(this._cachePlayRate=a$t,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[a$t,this._cacheFrameRate])))}),a$u(0,a$v,"cacheFrameRate",function(){return this._cacheFrameRate},function(a$t){this._cacheFrameRate!==a$t&&(this._cacheFrameRate=a$t,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,a$t])))}),a$u(0,a$v,"currentTime",null,function(a$t){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(a$t<this._playStart||a$t>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=a$A.loopCount;var a$k=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=a$t,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/a$k),0),this._currentFrameTime=this._currentKeyframeIndex*a$k}}),a$u(0,a$v,"paused",function(){return this._paused},function(a$t){(this._paused=a$t)&&this.event("paused")}),a$u(0,a$v,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),a$u(0,a$v,"destroyed",function(){return this._destroyed}),a$k}(),a$c=function(a$t){function a$k(){a$k.__super.call(this),a$h.isConchNode&&(this.drawSkin=function(a$t){a$t.transform||(a$t.transform=a$at.EMPTY),this._addCmd([a$t]),this.setSkinMesh&&this.setSkinMesh(a$t._ps,a$t.mVBData,a$t.mEleNum,0,a$t.mTexture,a$t.transform)})}return a$j(a$k,"laya.ani.GraphicsAni",a$S),a$k.prototype.drawSkin=function(a$t){var a$k=[a$t];this._saveToCmd(a$h._context._drawSkin,a$k)},a$k.create=function(){return a$k._caches.pop()||new a$k},a$k.recycle=function(a$t){a$t.clear(),a$k._caches.push(a$t)},a$k._caches=[],a$k}(),a$T=function(a$t){function a$o(){this._aniMap={},this.unfixedLastAniIndex=-1,a$o.__super.call(this),this._anis=new Array}a$j(a$o,"laya.ani.AnimationTemplet",a$w);var a$k=a$o.prototype;return a$k.parse=function(a$t){var a$k=new a$Nt(a$t);this._aniVersion=a$k.readUTFString(),a$Y.parse(this,a$k)},a$k._calculateKeyFrame=function(a$t,a$k,a$v){var a$j=a$t.keyFrame;a$j[a$k]=a$j[0];for(var a$Q=0;a$Q<a$k;a$Q++){var a$u=a$j[a$Q];a$u.nextData=0===a$u.duration?a$u.data:a$j[a$Q+1].data}a$j.length--},a$k.onAsynLoaded=function(a$t,a$k,a$v){var a$j=new a$Nt(a$k);switch(this._aniVersion=a$j.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":a$f.parse(this,a$j);break;default:a$Y.parse(this,a$j)}this._endLoaded()},a$k.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},a$k.getAnimationCount=function(){return this._anis.length},a$k.getAnimation=function(a$t){return this._anis[a$t]},a$k.getAniDuration=function(a$t){return this._anis[a$t].playTime},a$k.getNodes=function(a$t){return this._anis[a$t].nodes},a$k.getNodeIndexWithName=function(a$t,a$k){return this._anis[a$t].bone3DMap[a$k]},a$k.getNodeCount=function(a$t){return this._anis[a$t].nodes.length},a$k.getTotalkeyframesLength=function(a$t){return this._anis[a$t].totalKeyframeDatasLength},a$k.getPublicExtData=function(){return this._publicExtData},a$k.getAnimationDataWithCache=function(a$t,a$k,a$v,a$j){var a$Q=a$k[a$v];if(a$Q){var a$u=a$Q[a$t];return a$u?a$u[a$j]:null}return null},a$k.setAnimationDataWithCache=function(a$t,a$k,a$v,a$j,a$Q){var a$u=a$k[a$v]||(a$k[a$v]={});(a$u[a$t]||(a$u[a$t]=[]))[a$j]=a$Q},a$k.getOriginalData=function(a$t,a$k,a$v,a$j,a$Q){for(var a$u=this._anis[a$t].nodes,a$S=0,a$V=0,a$J=a$u.length,a$W=0;a$V<a$J;a$V++){var a$w,a$M=a$u[a$V];a$w=a$M.keyFrame[a$v[a$V][a$j]],a$M.dataOffset=a$W;var a$H=a$Q-a$w.startTime,a$E=a$M.lerpType;if(a$E)switch(a$E){case 0:case 1:for(a$S=0;a$S<a$M.keyframeWidth;)a$S+=a$M.interpolationMethod[a$S](a$M,a$S,a$k,a$W+a$S,a$w.data,a$H,null,a$w.duration,a$w.nextData);break;case 2:var a$A=a$w.interpolationData,a$R=a$A.length,a$h=0;for(a$S=0;a$S<a$R;){var a$l=a$A[a$S];switch(a$l){case 6:case 7:a$S+=a$o.interpolation[a$l](a$M,a$h,a$k,a$W+a$h,a$w.data,a$H,null,a$w.duration,a$w.nextData,a$A,a$S+1);break;default:a$S+=a$o.interpolation[a$l](a$M,a$h,a$k,a$W+a$h,a$w.data,a$H,null,a$w.duration,a$w.nextData)}a$h++}}else for(a$S=0;a$S<a$M.keyframeWidth;)a$S+=a$M.interpolationMethod[a$S](a$M,a$S,a$k,a$W+a$S,a$w.data,a$H,null,a$w.duration,a$w.nextData);a$W+=a$M.keyframeWidth}},a$k.getNodesCurrentFrameIndex=function(a$t,a$k){var a$v=this._anis[a$t].nodes;a$t!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(a$v.length),this.unfixedCurrentTimes=new Float32Array(a$v.length),this.unfixedLastAniIndex=a$t);for(var a$j=0,a$Q=a$v.length;a$j<a$Q;a$j++){var a$u=a$v[a$j];for(a$k<this.unfixedCurrentTimes[a$j]&&(this.unfixedCurrentFrameIndexes[a$j]=0),this.unfixedCurrentTimes[a$j]=a$k;this.unfixedCurrentFrameIndexes[a$j]<a$u.keyFrame.length&&!(a$u.keyFrame[this.unfixedCurrentFrameIndexes[a$j]].startTime>this.unfixedCurrentTimes[a$j]);)this.unfixedCurrentFrameIndexes[a$j]++;this.unfixedCurrentFrameIndexes[a$j]--}return this.unfixedCurrentFrameIndexes},a$k.getOriginalDataUnfixedRate=function(a$t,a$k,a$v){var a$j=this._anis[a$t].nodes;a$t!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(a$j.length),this.unfixedCurrentTimes=new Float32Array(a$j.length),this.unfixedKeyframes=a$R(a$j.length),this.unfixedLastAniIndex=a$t);for(var a$Q=0,a$u=0,a$S=a$j.length,a$V=0;a$u<a$S;a$u++){var a$J=a$j[a$u];for(a$v<this.unfixedCurrentTimes[a$u]&&(this.unfixedCurrentFrameIndexes[a$u]=0),this.unfixedCurrentTimes[a$u]=a$v;this.unfixedCurrentFrameIndexes[a$u]<a$J.keyFrame.length&&!(a$J.keyFrame[this.unfixedCurrentFrameIndexes[a$u]].startTime>this.unfixedCurrentTimes[a$u]);)this.unfixedKeyframes[a$u]=a$J.keyFrame[this.unfixedCurrentFrameIndexes[a$u]],this.unfixedCurrentFrameIndexes[a$u]++;var a$W=this.unfixedKeyframes[a$u];a$J.dataOffset=a$V;var a$w=a$v-a$W.startTime;if(a$J.lerpType)switch(a$J.lerpType){case 0:case 1:for(a$Q=0;a$Q<a$J.keyframeWidth;)a$Q+=a$J.interpolationMethod[a$Q](a$J,a$Q,a$k,a$V+a$Q,a$W.data,a$w,null,a$W.duration,a$W.nextData);break;case 2:var a$M=a$W.interpolationData,a$H=a$M.length,a$E=0;for(a$Q=0;a$Q<a$H;){var a$A=a$M[a$Q];switch(a$A){case 6:case 7:a$Q+=a$o.interpolation[a$A](a$J,a$E,a$k,a$V+a$E,a$W.data,a$w,null,a$W.duration,a$W.nextData,a$M,a$Q+1);break;default:a$Q+=a$o.interpolation[a$A](a$J,a$E,a$k,a$V+a$E,a$W.data,a$w,null,a$W.duration,a$W.nextData)}a$E++}}else for(a$Q=0;a$Q<a$J.keyframeWidth;)a$Q+=a$J.interpolationMethod[a$Q](a$J,a$Q,a$k,a$V+a$Q,a$W.data,a$w,null,a$W.duration,a$W.nextData);a$V+=a$J.keyframeWidth}},a$o._LinearInterpolation_0=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){var a$w=0===a$V?0:a$u/a$V;return a$v[a$j]=(1-a$w)*a$Q[a$k]+a$w*a$J[a$k],1},a$o._QuaternionInterpolation_1=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){var a$w=0===a$V?0:a$u/a$V;return a$H.slerpQuaternionArray(a$Q,a$k,a$J,a$k,a$w,a$v,a$j),4},a$o._AngleInterpolation_2=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){return 0},a$o._RadiansInterpolation_3=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){return 0},a$o._Matrix4x4Interpolation_4=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){for(var a$w=0;a$w<16;a$w++,a$k++)a$v[a$j+a$w]=a$Q[a$k]+a$u*a$S[a$k];return 16},a$o._NoInterpolation_5=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W){return a$v[a$j]=a$Q[a$k],1},a$o._BezierInterpolation_6=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w){return void 0===a$w&&(a$w=0),a$v[a$j]=a$Q[a$k]+(a$J[a$k]-a$Q[a$k])*a$m.getBezierRate(a$u/a$V,a$W[a$w],a$W[a$w+1],a$W[a$w+2],a$W[a$w+3]),5},a$o._BezierInterpolation_7=function(a$t,a$k,a$v,a$j,a$Q,a$u,a$S,a$V,a$J,a$W,a$w){return void 0===a$w&&(a$w=0),a$v[a$j]=a$W[a$w+4]+a$W[a$w+5]*a$m.getBezierRate((.001*a$u+a$W[a$w+6])/a$W[a$w+7],a$W[a$w],a$W[a$w+1],a$W[a$w+2],a$W[a$w+3]),9},a$o.load=function(a$t){return a$Qt.loader.create(a$t,null,null,a$o)},a$o.interpolation=[a$o._LinearInterpolation_0,a$o._QuaternionInterpolation_1,a$o._AngleInterpolation_2,a$o._RadiansInterpolation_3,a$o._Matrix4x4Interpolation_4,a$o._NoInterpolation_5,a$o._BezierInterpolation_6,a$o._BezierInterpolation_7],a$o}(),a$s=function(a$k){function a$v(a$t,a$k){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,a$v.__super.call(this),void 0===a$k&&(a$k=0),a$t&&this.init(a$t,a$k)}a$j(a$v,"laya.ani.bone.Skeleton",a$k);var a$t=a$v.prototype;return a$t.init=function(a$t,a$k){void 0===a$k&&(a$k=0);var a$v,a$j,a$Q,a$u=0,a$S=0;if(1==a$k)for(this._graphicsCache=[],a$u=0,a$S=a$t.getAnimationCount();a$u<a$S;a$u++)this._graphicsCache.push([]);if(this._yReverseMatrix=a$t.yReverseMatrix,this._aniMode=a$k,this._templet=a$t,this._player=new a$Z,this._player.cacheFrameRate=a$t.rate,this._player.templet=a$t,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=a$t.mBoneArr,this._rootBone=a$t.mRootBone,this._aniSectionDic=a$t.aniSectionDic,0<a$t.ikArr.length)for(this._ikArr=[],a$u=0,a$S=a$t.ikArr.length;a$u<a$S;a$u++)this._ikArr.push(new a$o(a$t.ikArr[a$u],this._boneList));if(0<a$t.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),a$u=0,a$S=a$t.pathArr.length;a$u<a$S;a$u++)a$v=a$t.pathArr[a$u],a$j=new a$X(a$v,this._boneList),(a$Q=this._boneSlotDic[a$v.name])&&((a$j=new a$X(a$v,this._boneList)).target=a$Q),this._pathDic[a$v.name]=a$j;if(0<a$t.tfArr.length)for(this._tfArr=[],a$u=0,a$S=a$t.tfArr.length;a$u<a$S;a$u++)this._tfArr.push(new a$F(a$t.tfArr[a$u],this._boneList));if(0<a$t.skinDataArray.length){var a$V=this._templet.skinDataArray[this._skinIndex];this._skinName=a$V.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},a$t.load=function(a$t,a$k,a$v){},a$t._onLoaded=function(){},a$t._parseComplete=function(){var a$t=a$K.TEMPLET_DICTIONARY[this._aniPath];a$t&&(this.init(a$t,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},a$t._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},a$t._onPlay=function(){this.event("played")},a$t._onStop=function(){var a$t,a$k=this._templet.eventAniArr[this._aniClipIndex];if(a$k&&this._eventIndex<a$k.length)for(;this._eventIndex<a$k.length;this._eventIndex++)(a$t=a$k[this._eventIndex]).time>=this._player.playStart&&a$t.time<=this._player.playEnd&&this.event("label",a$t);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},a$t._onPause=function(){this.event("paused")},a$t._parseSrcBoneMatrix=function(){var a$t=0,a$k=0;for(a$k=this._templet.srcBoneMatrixArr.length,a$t=0;a$t<a$k;a$t++)this._boneMatrixArray.push(new a$at);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var a$v,a$j,a$Q=this._templet.boneSlotArray;for(a$t=0,a$k=a$Q.length;a$t<a$k;a$t++)a$v=a$Q[a$t],null==(a$j=this._bindBoneBoneSlotDic[a$v.parent])&&(this._bindBoneBoneSlotDic[a$v.parent]=a$j=[]),this._boneSlotDic[a$v.name]=a$v=a$v.copy(),a$j.push(a$v),this._boneSlotArray.push(a$v)}},a$t._emitMissedEvents=function(a$t,a$k,a$v){void 0===a$v&&(a$v=0);var a$j=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(a$j){var a$Q,a$u,a$S=0;for(a$Q=a$j.length,a$S=a$v;a$S<a$Q;a$S++)(a$u=a$j[a$S]).time>=this._player.playStart&&a$u.time<=this._player.playEnd&&this.event("label",a$u)}},a$t._update=function(a$t){if(void 0===a$t&&(a$t=!0),!(this._pause||a$t&&this._indexControl)){var a$k=this.timer.currTimer,a$v=this._player.currentKeyframeIndex,a$j=a$k-this._lastTime;if(a$t?this._player._update(a$j):a$v=-1,this._lastTime=a$k,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<a$j&&this._clipIndex==a$v&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var a$Q;this._lastUpdateAniClipIndex=this._aniClipIndex,a$v>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var a$u,a$S=this._templet.eventAniArr[this._aniClipIndex];if(a$S&&this._eventIndex<a$S.length&&((a$Q=a$S[this._eventIndex]).time>=this._player.playStart&&a$Q.time<=this._player.playEnd?this._player.currentPlayTime>=a$Q.time&&(this.event("label",a$Q),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(a$u=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=a$u&&(this.graphics=a$u));var a$V=0,a$J=0;for(a$J=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,a$J-1)&&0<a$J;)a$J--;if(a$J<this._clipIndex)for(a$V=a$J;a$V<this._clipIndex;a$V++)this._createGraphics(a$V)}else if(1==this._aniMode){if(a$u=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=a$u&&(this.graphics=a$u));for(a$J=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,a$J-1)&&0<a$J;)a$J--;if(a$J<this._clipIndex)for(a$V=a$J;a$V<this._clipIndex;a$V++)this._createGraphics(a$V)}this._createGraphics()}}},a$t._createGraphics=function(a$t){void 0===a$t&&(a$t=-1),-1==a$t&&(a$t=this._clipIndex);var a$k,a$v,a$j=a$t*this._player.cacheFrameRateInterval,a$Q=this._templet.drawOrderAniArr[this._aniClipIndex];if(a$Q&&0<a$Q.length)for(this._drawOrderIndex=0,a$k=a$Q[this._drawOrderIndex];a$j>=a$k.time&&(this._drawOrder=a$k.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=a$Q.length));)a$k=a$Q[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=a$c.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=a$c.create(),a$v=this.graphics;var a$u=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],a$t,a$j);var a$S,a$V,a$J,a$W,a$w=this._aniSectionDic[this._aniClipIndex],a$M=0,a$H=0,a$E=0,a$A=0,a$R=0,a$h=this._templet.srcBoneMatrixArr.length;for(a$R=a$w[a$H=0];a$H<a$h;a$H++)a$W=this._boneList[a$H],a$J=this._templet.srcBoneMatrixArr[a$H],a$W.resultTransform.scX=a$J.scX*this._curOriginalData[a$M++],a$W.resultTransform.skX=a$J.skX+this._curOriginalData[a$M++],a$W.resultTransform.skY=a$J.skY+this._curOriginalData[a$M++],a$W.resultTransform.scY=a$J.scY*this._curOriginalData[a$M++],a$W.resultTransform.x=a$J.x+this._curOriginalData[a$M++],a$W.resultTransform.y=a$J.y+this._curOriginalData[a$M++],8===this._templet.tMatrixDataLen&&(a$W.resultTransform.skewX=a$J.skewX+this._curOriginalData[a$M++],a$W.resultTransform.skewY=a$J.skewY+this._curOriginalData[a$M++]);var a$l,a$o={},a$Y={};for(a$R+=a$w[1];a$H<a$R;a$H++)a$o[(a$l=a$u[a$H]).name]=this._curOriginalData[a$M++],a$Y[a$l.name]=this._curOriginalData[a$M++],this._curOriginalData[a$M++],this._curOriginalData[a$M++],this._curOriginalData[a$M++],this._curOriginalData[a$M++];var a$f,a$X,a$F={},a$d={};for(a$R+=a$w[2];a$H<a$R;a$H++)a$F[(a$l=a$u[a$H]).name]=this._curOriginalData[a$M++],a$d[a$l.name]=this._curOriginalData[a$M++],this._curOriginalData[a$M++],this._curOriginalData[a$M++],this._curOriginalData[a$M++],this._curOriginalData[a$M++];if(this._pathDic)for(a$R+=a$w[3];a$H<a$R;a$H++){if(a$l=a$u[a$H],a$f=this._pathDic[a$l.name])switch(new a$Nt(a$l.extenData).getByte()){case 1:a$f.position=this._curOriginalData[a$M++];break;case 2:a$f.spacing=this._curOriginalData[a$M++];break;case 3:a$f.rotateMix=this._curOriginalData[a$M++],a$f.translateMix=this._curOriginalData[a$M++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(a$at.TEMP.identity()),this._ikArr)for(a$H=0,a$R=this._ikArr.length;a$H<a$R;a$H++)a$X=this._ikArr[a$H],a$F.hasOwnProperty(a$X.name)&&(a$X.bendDirection=a$F[a$X.name]),a$d.hasOwnProperty(a$X.name)&&(a$X.mix=a$d[a$X.name]),a$X.apply();if(this._pathDic)for(var a$m in this._pathDic)(a$f=this._pathDic[a$m]).apply(this._boneList,a$v);if(this._tfArr)for(a$H=0,a$A=this._tfArr.length;a$H<a$A;a$H++)this._tfArr[a$H].apply();for(a$H=0,a$A=this._boneList.length;a$H<a$A;a$H++)if(a$W=this._boneList[a$H],a$V=this._bindBoneBoneSlotDic[a$W.name],a$W.resultMatrix.copyTo(this._boneMatrixArray[a$H]),a$V)for(a$E=0,a$R=a$V.length;a$E<a$R;a$E++)(a$S=a$V[a$E])&&a$S.setParentMatrix(a$W.resultMatrix);var a$Z,a$s,a$K,a$U,a$N={},a$a=this._templet.deformAniArr;if(a$a&&0<a$a.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,a$H=0,a$R=this._boneSlotArray.length;a$H<a$R;a$H++)(a$S=this._boneSlotArray[a$H]).deformData=null;var a$z,a$G=a$a[this._aniClipIndex];for(a$z in a$Z=a$G.default,this._setDeform(a$Z,a$N,this._boneSlotArray,a$j),a$G)"default"!=a$z&&a$z!=this._skinName&&(a$Z=a$G[a$z],this._setDeform(a$Z,a$N,this._boneSlotArray,a$j));a$Z=a$G[this._skinName],this._setDeform(a$Z,a$N,this._boneSlotArray,a$j)}if(this._drawOrder)for(a$H=0,a$R=this._drawOrder.length;a$H<a$R;a$H++)a$s=a$o[(a$S=this._boneSlotArray[this._drawOrder[a$H]]).name],a$K=a$Y[a$S.name],isNaN(a$K)||(a$v.save(),a$v.alpha(a$K)),isNaN(a$s)||-2==a$s||(this._templet.attachmentNames?a$S.showDisplayByName(this._templet.attachmentNames[a$s]):a$S.showDisplayByIndex(a$s)),a$N[this._drawOrder[a$H]]?(a$U=a$N[this._drawOrder[a$H]],a$S.currDisplayData&&a$U[a$S.currDisplayData.attachmentName]?a$S.deformData=a$U[a$S.currDisplayData.attachmentName]:a$S.deformData=null):a$S.deformData=null,isNaN(a$K)?a$S.draw(a$v,this._boneMatrixArray,2==this._aniMode):a$S.draw(a$v,this._boneMatrixArray,2==this._aniMode,a$K),isNaN(a$K)||a$v.restore();else for(a$H=0,a$R=this._boneSlotArray.length;a$H<a$R;a$H++)a$s=a$o[(a$S=this._boneSlotArray[a$H]).name],a$K=a$Y[a$S.name],isNaN(a$K)||(a$v.save(),a$v.alpha(a$K)),isNaN(a$s)||-2==a$s||(this._templet.attachmentNames?a$S.showDisplayByName(this._templet.attachmentNames[a$s]):a$S.showDisplayByIndex(a$s)),a$N[a$H]?(a$U=a$N[a$H],a$S.currDisplayData&&a$U[a$S.currDisplayData.attachmentName]?a$S.deformData=a$U[a$S.currDisplayData.attachmentName]:a$S.deformData=null):a$S.deformData=null,isNaN(a$K)?a$S.draw(a$v,this._boneMatrixArray,2==this._aniMode):a$S.draw(a$v,this._boneMatrixArray,2==this._aniMode,a$K),isNaN(a$K)||a$v.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,a$t,a$v):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,a$t,a$v)},a$t._setDeform=function(a$t,a$k,a$v,a$j){if(a$t){var a$Q,a$u,a$S,a$V=0,a$J=0,a$W=0;if(a$t)for(a$V=0,a$J=a$t.deformSlotDataList.length;a$V<a$J;a$V++)for(a$Q=a$t.deformSlotDataList[a$V],a$W=0;a$W<a$Q.deformSlotDisplayList.length;a$W++)a$S=a$v[(a$u=a$Q.deformSlotDisplayList[a$W]).slotIndex],a$u.apply(a$j,a$S),a$k[a$u.slotIndex]||(a$k[a$u.slotIndex]={}),a$k[a$u.slotIndex][a$u.attachment]=a$u.deformData}},a$t.getAnimNum=function(){return this._templet.getAnimationCount()},a$t.getAniNameByIndex=function(a$t){return this._templet.getAniNameByIndex(a$t)},a$t.getSlotByName=function(a$t){return this._boneSlotDic[a$t]},a$t.showSkinByName=function(a$t,a$k){void 0===a$k&&(a$k=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(a$t),a$k)},a$t.showSkinByIndex=function(a$t,a$k){void 0===a$k&&(a$k=!0);for(var a$v=0;a$v<this._boneSlotArray.length;a$v++)this._boneSlotArray[a$v].showSlotData(null,a$k);if(this._templet.showSkinByIndex(this._boneSlotDic,a$t,a$k)){var a$j=this._templet.skinDataArray[a$t];this._skinIndex=a$t,this._skinName=a$j.name}this._clearCache()},a$t.showSlotSkinByIndex=function(a$t,a$k){if(0!=this._aniMode){var a$v=this.getSlotByName(a$t);a$v&&a$v.showDisplayByIndex(a$k),this._clearCache()}},a$t.showSlotSkinByName=function(a$t,a$k){if(0!=this._aniMode){var a$v=this.getSlotByName(a$t);a$v&&a$v.showDisplayByName(a$k),this._clearCache()}},a$t.replaceSlotSkinName=function(a$t,a$k,a$v){if(0!=this._aniMode){var a$j=this.getSlotByName(a$t);a$j&&a$j.replaceDisplayByName(a$k,a$v),this._clearCache()}},a$t.replaceSlotSkinByIndex=function(a$t,a$k,a$v){if(0!=this._aniMode){var a$j=this.getSlotByName(a$t);a$j&&a$j.replaceDisplayByIndex(a$k,a$v),this._clearCache()}},a$t.setSlotSkin=function(a$t,a$k){if(0!=this._aniMode){var a$v=this.getSlotByName(a$t);a$v&&a$v.replaceSkin(a$k),this._clearCache()}},a$t._clearCache=function(){if(1==this._aniMode)for(var a$t=0,a$k=this._graphicsCache.length;a$t<a$k;a$t++){for(var a$v=0,a$j=this._graphicsCache[a$t].length;a$v<a$j;a$v++){var a$Q=this._graphicsCache[a$t][a$v];a$Q!=this.graphics&&a$c.recycle(a$Q)}this._graphicsCache[a$t].length=0}},a$t.play=function(a$t,a$k,a$v,a$j,a$Q,a$u){void 0===a$v&&(a$v=!0),void 0===a$j&&(a$j=0),void 0===a$Q&&(a$Q=0),void 0===a$u&&(a$u=!0),this._indexControl=!1;var a$S=-1,a$V=NaN;if(a$V=a$k?2147483647:0,"string"==typeof a$t)for(var a$J=0,a$W=this._templet.getAnimationCount();a$J<a$W;a$J++){var a$w=this._templet.getAnimation(a$J);if(a$w&&a$t==a$w.name){a$S=a$J;break}}else a$S=a$t;-1<a$S&&a$S<this.getAnimNum()&&(this._aniClipIndex=a$S,(a$v||this._pause||this._currAniIndex!=a$S)&&(this._currAniIndex=a$S,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(a$S)),this._drawOrder=null,this._eventIndex=0,this._player.play(a$S,this._player.playbackRate,a$V,a$j,a$Q),a$u&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=a$M.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},a$t.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},a$t.playbackRate=function(a$t){this._player&&(this._player.playbackRate=a$t)},a$t.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},a$t.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=a$M.now(),this.timer.frameLoop(1,this,this._update,null,!0))},a$t._getGrahicsDataWithCache=function(a$t,a$k){return this._graphicsCache[a$t][a$k]},a$t._setGrahicsDataWithCache=function(a$t,a$k,a$v){this._graphicsCache[a$t][a$k]=a$v},a$t.destroy=function(a$t){void 0===a$t&&(a$t=!0),a$k.prototype.destroy.call(this,a$t),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},a$u(0,a$t,"url",function(){return this._aniPath},function(a$t){this.load(a$t)}),a$u(0,a$t,"index",function(){return this._index},function(a$t){this.player&&(this._index=a$t,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),a$u(0,a$t,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),a$u(0,a$t,"templet",function(){return this._templet}),a$u(0,a$t,"player",function(){return this._player}),a$v.useSimpleMeshInCanvas=!1,a$v}(a$ut),a$K=function(a$k){function a$Q(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,a$Q.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}a$j(a$Q,"laya.ani.bone.Templet",a$k);var a$t=a$Q.prototype;return a$t.getLoadList=function(){return this._loadList},a$t.loadAni=function(a$t){this._skBufferUrl=a$t,a$Qt.loader.load(a$t,a$J.create(this,this.onComplete),null,"arraybuffer")},a$t.onComplete=function(a$t){if(this._isDestroyed)this.destroy();else{var a$k=a$W.getRes(this._skBufferUrl);a$k?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,a$k)):this.event("error","load failed:"+this._skBufferUrl)}},a$t.parseData=function(a$t,a$k,a$v){void 0===a$v&&(a$v=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=a$t,this._mainTexture&&a$h.isWebGL&&a$t.bitmap&&(a$t.bitmap.enableMerageInAtlas=!1),this._rate=a$v,this.parse(a$k)},a$t.buildArmature=function(a$t){return void 0===a$t&&(a$t=0),new a$s(this,a$t)},a$t.parse=function(a$t){a$k.prototype.parse.call(this,a$t),this._endLoaded(),this._aniVersion!=a$Q.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+a$Q.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},a$t._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var a$t=0;this._loadList=[];var a$k,a$v=new a$Nt(this.getPublicExtData()),a$j=0,a$Q=0,a$u=0,a$S=a$v.getInt32(),a$V=a$v.readUTFString(),a$J=a$V.split("\n");for(a$t=0;a$t<a$S;a$t++)a$k=this._path+a$J[2*a$t],a$V=a$J[2*a$t+1],a$v.getFloat32(),a$v.getFloat32(),a$j=a$v.getFloat32(),a$Q=a$v.getFloat32(),a$u=a$v.getFloat32(),isNaN(a$u)?0:a$u,a$u=a$v.getFloat32(),isNaN(a$u)?0:a$u,a$u=a$v.getFloat32(),isNaN(a$u)?a$j:a$u,a$u=a$v.getFloat32(),isNaN(a$u)?a$Q:a$u,-1==this._loadList.indexOf(a$k)&&this._loadList.push(a$k);this.event("inited",this)}},a$t._textureComplete=function(){for(var a$t,a$k,a$v=0,a$j=this._loadList.length;a$v<a$j;a$v++)a$k=this._loadList[a$v],a$t=this._textureDic[a$k]=a$W.getRes(a$k),a$h.isWebGL&&a$t&&a$t.bitmap&&(a$t.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},a$t._parsePublicExtData=function(){var a$t=0,a$k=0,a$v=0,a$j=0,a$Q=0;for(a$t=0,a$Q=this.getAnimationCount();a$t<a$Q;a$t++)this._graphicsCache.push([]);var a$u;a$u="Dragon"!=this._aniClassName;var a$S,a$V,a$J=new a$Nt(this.getPublicExtData()),a$W=0,a$w=0,a$M=0,a$H=0,a$E=0,a$A=0,a$R=0,a$h=0,a$l=0,a$o=a$J.getInt32(),a$Y=a$J.readUTFString(),a$f=a$Y.split("\n");for(a$t=0;a$t<a$o;a$t++){if(a$S=this._mainTexture,a$V=this._path+a$f[2*a$t],a$Y=a$f[2*a$t+1],null==this._mainTexture&&(a$S=this._textureDic[a$V]),!a$S)return this.event("error",this),void(this.isParseFail=!0);a$W=a$J.getFloat32(),a$w=a$J.getFloat32(),a$M=a$J.getFloat32(),a$H=a$J.getFloat32(),a$l=a$J.getFloat32(),a$E=isNaN(a$l)?0:a$l,a$l=a$J.getFloat32(),a$A=isNaN(a$l)?0:a$l,a$l=a$J.getFloat32(),a$R=isNaN(a$l)?a$M:a$l,a$l=a$J.getFloat32(),a$h=isNaN(a$l)?a$H:a$l,this.subTextureDic[a$Y]=a$zt.create(a$S,a$W,a$w,a$M,a$H,-a$E,-a$A,a$R,a$h),a$S.alphaTexture&&(this.subTextureDic[a$Y].alphaTexture=a$zt.create(a$S.alphaTexture,a$W,a$w,a$M,a$H,-a$E,-a$A,a$R,a$h))}this._mainTexture=a$S;var a$X,a$F,a$d,a$m,a$Z,a$s=a$J.getUint16();for(a$t=0;a$t<a$s;a$t++)(a$X=[]).push(a$J.getUint16()),a$X.push(a$J.getUint16()),a$X.push(a$J.getUint16()),a$X.push(a$J.getUint16()),this.aniSectionDic[a$t]=a$X;var a$K,a$U=a$J.getInt16(),a$N={};for(a$t=0;a$t<a$U;a$t++)a$F=new a$Gt,0==a$t?a$K=a$F:a$F.root=a$K,a$F.d=a$u?-1:1,a$m=a$J.readUTFString(),a$Z=a$J.readUTFString(),a$F.length=a$J.getFloat32(),1==a$J.getByte()&&(a$F.inheritRotation=!1),1==a$J.getByte()&&(a$F.inheritScale=!1),a$F.name=a$m,a$Z&&((a$d=a$N[a$Z])?a$d.addChild(a$F):this.mRootBone=a$F),a$N[a$m]=a$F,this.mBoneArr.push(a$F);this.tMatrixDataLen=a$J.getUint16();var a$a,a$z,a$G=a$J.getUint16(),a$c=Math.floor(a$G/this.tMatrixDataLen),a$T=this.srcBoneMatrixArr;for(a$t=0;a$t<a$c;a$t++)(a$a=new a$qt).scX=a$J.getFloat32(),a$a.skX=a$J.getFloat32(),a$a.skY=a$J.getFloat32(),a$a.scY=a$J.getFloat32(),a$a.x=a$J.getFloat32(),a$a.y=a$J.getFloat32(),8===this.tMatrixDataLen&&(a$a.skewX=a$J.getFloat32(),a$a.skewY=a$J.getFloat32()),a$T.push(a$a),(a$F=this.mBoneArr[a$t]).transform=a$a;var a$p,a$O=a$J.getUint16(),a$n=0;for(a$t=0;a$t<a$O;a$t++){for(a$z=new a$xt,a$n=a$J.getUint16(),a$k=0;a$k<a$n;a$k++)a$z.boneNames.push(a$J.readUTFString()),a$z.boneIndexs.push(a$J.getInt16());a$z.name=a$J.readUTFString(),a$z.targetBoneName=a$J.readUTFString(),a$z.targetBoneIndex=a$J.getInt16(),a$z.bendDirection=a$J.getFloat32(),a$z.mix=a$J.getFloat32(),a$z.isSpine=a$u,this.ikArr.push(a$z)}var a$_,a$x=a$J.getUint16(),a$I=0;for(a$t=0;a$t<a$x;a$t++){for(a$p=new a$bt,a$I=a$J.getUint16(),a$k=0;a$k<a$I;a$k++)a$p.boneIndexs.push(a$J.getInt16());a$p.name=a$J.getUTFString(),a$p.targetIndex=a$J.getInt16(),a$p.rotateMix=a$J.getFloat32(),a$p.translateMix=a$J.getFloat32(),a$p.scaleMix=a$J.getFloat32(),a$p.shearMix=a$J.getFloat32(),a$p.offsetRotation=a$J.getFloat32(),a$p.offsetX=a$J.getFloat32(),a$p.offsetY=a$J.getFloat32(),a$p.offsetScaleX=a$J.getFloat32(),a$p.offsetScaleY=a$J.getFloat32(),a$p.offsetShearY=a$J.getFloat32(),this.tfArr.push(a$p)}var a$i=a$J.getUint16(),a$D=0;for(a$t=0;a$t<a$i;a$t++){for((a$_=new a$It).name=a$J.readUTFString(),a$D=a$J.getUint16(),a$k=0;a$k<a$D;a$k++)a$_.bones.push(a$J.getInt16());a$_.target=a$J.readUTFString(),a$_.positionMode=a$J.readUTFString(),a$_.spacingMode=a$J.readUTFString(),a$_.rotateMode=a$J.readUTFString(),a$_.offsetRotation=a$J.getFloat32(),a$_.position=a$J.getFloat32(),a$_.spacing=a$J.getFloat32(),a$_.rotateMix=a$J.getFloat32(),a$_.translateMix=a$J.getFloat32(),this.pathArr.push(a$_)}var a$B,a$b,a$q,a$C,a$L,a$e=0,a$r=0,a$g=0,a$$=NaN,a$y=0,a$P=a$J.getInt16();for(a$t=0;a$t<a$P;a$t++){var a$tt=a$J.getUint8(),a$kt={};this.deformAniArr.push(a$kt);for(var a$vt=0;a$vt<a$tt;a$vt++)for((a$B=new a$Tt).skinName=a$J.getUTFString(),a$kt[a$B.skinName]=a$B,a$e=a$J.getInt16(),a$k=0;a$k<a$e;a$k++)for(a$b=new a$pt,a$B.deformSlotDataList.push(a$b),a$r=a$J.getInt16(),a$v=0;a$v<a$r;a$v++)for(a$q=new a$Ot,a$b.deformSlotDisplayList.push(a$q),a$q.slotIndex=a$J.getInt16(),a$q.attachment=a$J.getUTFString(),a$g=a$J.getInt16(),a$j=0;a$j<a$g;a$j++)for(1==a$J.getByte()?a$q.tweenKeyList.push(!0):a$q.tweenKeyList.push(!1),a$$=a$J.getFloat32(),a$q.timeList.push(a$$),a$C=[],a$q.vectices.push(a$C),a$y=a$J.getInt16(),a$Q=0;a$Q<a$y;a$Q++)a$C.push(a$J.getFloat32())}var a$jt,a$Qt,a$ut=a$J.getInt16(),a$St=0,a$Vt=0;for(a$t=0;a$t<a$ut;a$t++){for(a$St=a$J.getInt16(),a$L=[],a$k=0;a$k<a$St;a$k++){for((a$jt=new a$nt).time=a$J.getFloat32(),a$Vt=a$J.getInt16(),a$v=0;a$v<a$Vt;a$v++)a$jt.drawOrder.push(a$J.getInt16());a$L.push(a$jt)}this.drawOrderAniArr.push(a$L)}var a$Jt,a$Wt=a$J.getInt16(),a$wt=0;for(a$t=0;a$t<a$Wt;a$t++){for(a$wt=a$J.getInt16(),a$Qt=[],a$k=0;a$k<a$wt;a$k++)(a$Jt=new a$_t).name=a$J.getUTFString(),a$Jt.intValue=a$J.getInt32(),a$Jt.floatValue=a$J.getFloat32(),a$Jt.stringValue=a$J.getUTFString(),a$Jt.time=a$J.getFloat32(),a$Qt.push(a$Jt);this.eventAniArr.push(a$Qt)}var a$Mt=a$J.getInt16();if(0<a$Mt)for(this.attachmentNames=[],a$t=0;a$t<a$Mt;a$t++)this.attachmentNames.push(a$J.getUTFString());var a$Ht,a$Et,a$At=a$J.getInt16();for(a$t=0;a$t<a$At;a$t++)(a$Ht=new a$ct).name=a$J.readUTFString(),a$Ht.parent=a$J.readUTFString(),a$Ht.attachmentName=a$J.readUTFString(),a$Ht.srcDisplayIndex=a$Ht.displayIndex=a$J.getInt16(),(a$Ht.templet=this).boneSlotDic[a$Ht.name]=a$Ht,null==(a$Et=this.bindBoneBoneSlotDic[a$Ht.parent])&&(this.bindBoneBoneSlotDic[a$Ht.parent]=a$Et=[]),a$Et.push(a$Ht),this.boneSlotArray.push(a$Ht);var a$Rt,a$ht,a$lt,a$ot=a$J.readUTFString().split("\n"),a$Yt=0,a$ft=a$J.getUint8(),a$Xt=0,a$Ft=0,a$dt=0,a$mt=0,a$Zt=0,a$st=0,a$Kt=0;for(a$t=0;a$t<a$ft;a$t++){for((a$Rt=new a$it).name=a$ot[a$Yt++],a$Xt=a$J.getUint8(),a$k=0;a$k<a$Xt;a$k++){for((a$ht=new a$Bt).name=a$ot[a$Yt++],a$Ht=this.boneSlotDic[a$ht.name],a$Ft=a$J.getUint8(),a$v=0;a$v<a$Ft;a$v++){if(a$lt=new a$Dt,this.skinSlotDisplayDataArr.push(a$lt),a$lt.name=a$ot[a$Yt++],a$lt.attachmentName=a$ot[a$Yt++],a$lt.transform=new a$qt,a$lt.transform.scX=a$J.getFloat32(),a$lt.transform.skX=a$J.getFloat32(),a$lt.transform.skY=a$J.getFloat32(),a$lt.transform.scY=a$J.getFloat32(),a$lt.transform.x=a$J.getFloat32(),a$lt.transform.y=a$J.getFloat32(),a$ht.displayArr.push(a$lt),a$lt.width=a$J.getFloat32(),a$lt.height=a$J.getFloat32(),a$lt.type=a$J.getUint8(),a$lt.verLen=a$J.getUint16(),0<(a$U=a$J.getUint16()))for(a$lt.bones=[],a$j=0;a$j<a$U;a$j++){var a$Ut=a$J.getUint16();a$lt.bones.push(a$Ut)}if(0<(a$dt=a$J.getUint16()))for(a$lt.uvs=[],a$j=0;a$j<a$dt;a$j++)a$lt.uvs.push(a$J.getFloat32());if(0<(a$mt=a$J.getUint16()))for(a$lt.weights=[],a$j=0;a$j<a$mt;a$j++)a$lt.weights.push(a$J.getFloat32());if(0<(a$Zt=a$J.getUint16()))for(a$lt.triangles=[],a$j=0;a$j<a$Zt;a$j++)a$lt.triangles.push(a$J.getUint16());if(0<(a$st=a$J.getUint16()))for(a$lt.vertices=[],a$j=0;a$j<a$st;a$j++)a$lt.vertices.push(a$J.getFloat32());if(0<(a$Kt=a$J.getUint16()))for(a$lt.lengths=[],a$j=0;a$j<a$Kt;a$j++)a$lt.lengths.push(a$J.getFloat32())}a$Rt.slotArr.push(a$ht)}this.skinDic[a$Rt.name]=a$Rt,this.skinDataArray.push(a$Rt)}1==a$J.getUint8()?(this.yReverseMatrix=new a$at(1,0,0,-1,0,0),a$K&&a$K.setTempMatrix(this.yReverseMatrix)):a$K&&a$K.setTempMatrix(new a$at),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},a$t.getTexture=function(a$t){var a$k=this.subTextureDic[a$t];return a$k||(a$k=this.subTextureDic[a$t.substr(0,a$t.length-1)]),null==a$k?this._mainTexture:a$k},a$t.showSkinByIndex=function(a$t,a$k,a$v){if(void 0===a$v&&(a$v=!0),a$k<0&&a$k>=this.skinDataArray.length)return!1;var a$j,a$Q,a$u=0,a$S=0,a$V=this.skinDataArray[a$k];if(a$V){for(a$u=0,a$S=a$V.slotArr.length;a$u<a$S;a$u++)(a$Q=a$V.slotArr[a$u])&&(a$j=a$t[a$Q.name])&&(a$j.showSlotData(a$Q,a$v),a$v&&"undefined"!=a$j.attachmentName&&"null"!=a$j.attachmentName?a$j.showDisplayByName(a$j.attachmentName):a$j.showDisplayByIndex(a$j.displayIndex));return!0}return!1},a$t.getSkinIndexByName=function(a$t){for(var a$k=0,a$v=this.skinDataArray.length;a$k<a$v;a$k++)if(this.skinDataArray[a$k].name==a$t)return a$k;return-1},a$t.getGrahicsDataWithCache=function(a$t,a$k){return this._graphicsCache[a$t][a$k]},a$t.setGrahicsDataWithCache=function(a$t,a$k,a$v){this._graphicsCache[a$t][a$k]=a$v},a$t.destroy=function(){var a$t;for(var a$k in this._isDestroyed=!0,this.subTextureDic)(a$t=this.subTextureDic[a$k])&&a$t.destroy();for(a$k in this._textureDic)(a$t=this._textureDic[a$k])&&a$t.destroy();for(var a$v=0,a$j=this.skinSlotDisplayDataArr.length;a$v<a$j;a$v++)this.skinSlotDisplayDataArr[a$v].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete a$Q.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},a$t.getAniNameByIndex=function(a$t){var a$k=this.getAnimation(a$t);return a$k?a$k.name:null},a$u(0,a$t,"rate",function(){return this._rate},function(a$t){this._rate=a$t}),a$Q.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",a$Q.TEMPLET_DICTIONARY=null,a$Q}(a$T)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(a$t,a$k){"use strict";for(var a$v in Object.defineProperty(a$k,"__esModule",{value:!0}),Laya){var a$j=Laya[a$v];a$j&&a$j.__isclass&&(a$k[a$v]=a$j)}});