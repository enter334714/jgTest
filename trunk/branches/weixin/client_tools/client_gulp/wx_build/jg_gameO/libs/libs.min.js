var Laya=window.Laya=function(o$U,o$o){var o$h={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(o$o,o$r){return 1==arguments.length?o$h.__presubstr.call(this,o$o):o$h.__presubstr.call(this,o$o,0<o$r?o$r:this.length+o$r)},__init:function(o$o){o$o.forEach(function(o$o){o$o.__init$&&o$o.__init$()})},__isClass:function(o$o){return o$o&&(o$o.__isclass||o$o==Object||o$o==String||o$o==Array)},__newvec:function(o$o,o$r){var o$T=[];o$T.length=o$o;for(var o$k=0;o$k<o$o;o$k++)o$T[o$k]=o$r;return o$T},__extend:function(o$o,o$r){for(var o$T in o$r)if(o$r.hasOwnProperty(o$T)){var o$k=Object.getOwnPropertyDescriptor(o$r,o$T),o$W=o$k.get,o$D=o$k.set;o$W||o$D?o$W&&o$D?Object.defineProperty(o$o,o$T,o$k):(o$W&&Object.defineProperty(o$o,o$T,o$W),o$D&&Object.defineProperty(o$o,o$T,o$D)):o$o[o$T]=o$r[o$T]}function o$n(){o$h.un(this,"constructor",o$o)}o$n.prototype=o$r.prototype,o$o.prototype=new o$n,o$h.un(o$o.prototype,"__imps",o$h.__copy({},o$r.prototype.__imps))},__copy:function(o$o,o$r){if(!o$r)return null;for(var o$T in o$o=o$o||{},o$r)o$o[o$T]=o$r[o$T];return o$o},__package:function(o$o,o$r){if(!o$h.__packages[o$o]){o$h.__packages[o$o]=!0;var o$T=o$U,o$k=o$o.split(".");if(1<o$k.length)for(var o$W=0,o$D=o$k.length-1;o$W<o$D;o$W++){var o$n=o$T[o$k[o$W]];o$T=o$n||(o$T[o$k[o$W]]={})}o$T[o$k[o$k.length-1]]||(o$T[o$k[o$k.length-1]]=o$r||{})}},__hasOwnProperty:function(o$o,o$r){return o$r=o$r||this,Object.hasOwnProperty.call(o$r,o$o)||function o$o(o$r,o$T){if(Object.hasOwnProperty.call(o$T.prototype,o$r))return!0;var o$k=o$T.prototype.__super;return null==o$k?null:o$o(o$r,o$k)}(o$o,o$r.__class)},__typeof:function(o$o,o$r){if(!o$o||!o$r)return!1;if(o$r===String)return"string"==typeof o$o;if(o$r===Number)return"number"==typeof o$o;if(o$r.__interface__)o$r=o$r.__interface__;else if("string"!=typeof o$r)return o$o instanceof o$r;return o$o.__imps&&o$o.__imps[o$r]||o$o.__class==o$r},__as:function(o$o,o$r){return this.__typeof(o$o,o$r)?o$o:null},__int:function(o$o){return o$o?parseInt(o$o):0},interface:function(o$o,o$r){o$h.__package(o$o,{});var o$T=o$h.__internals,o$k=o$T[o$o]=o$T[o$o]||{self:o$o};if(o$r){var o$W=o$r.split(",");o$k.extend=[];for(var o$D=0;o$D<o$W.length;o$D++){var o$n=o$W[o$D];o$T[o$n]=o$T[o$n]||{self:o$n},o$k.extend.push(o$T[o$n])}}var o$V=o$U,o$L=o$o.split(".");for(o$D=0;o$D<o$L.length-1;o$D++)o$V=o$V[o$L[o$D]];o$V[o$L[o$L.length-1]]={__interface__:o$o}},class:function(o$o,o$r,o$T,o$k){if(o$T&&o$h.__extend(o$o,o$T),o$r)if(o$h.__package(o$r,o$o),o$h.__classmap[o$r]=o$o,0<o$r.indexOf(".")){if(0==o$r.indexOf("laya.")){var o$W=o$r.split(".");o$k=o$k||o$W[o$W.length-1],o$h[o$k]&&console.log("Warning!,this class["+o$k+"] already exist:",o$h[o$k]),o$h[o$k]=o$o}}else"Main"==o$r?o$U.Main=o$o:"MainWX"==o$r?o$U.MainWX=o$o:(o$h[o$r]&&console.log("Error!,this class["+o$r+"] already exist:",o$h[o$r]),o$h[o$r]=o$o);var o$D=o$h.un,o$n=o$o.prototype;o$D(o$n,"hasOwnProperty",o$h.__hasOwnProperty),o$D(o$n,"__class",o$o),o$D(o$n,"__super",o$T),o$D(o$n,"__className",o$r),o$D(o$o,"__super",o$T),o$D(o$o,"__className",o$r),o$D(o$o,"__isclass",!0),o$D(o$o,"super",function(o$o){this.__super.call(o$o)})},imps:function(o$o,o$r){if(!o$r)return null;var o$W=o$o.__imps||o$h.un(o$o,"__imps",{});function o$D(o$o){var o$r,o$T;if((o$r=o$h.__internals[o$o])&&(o$W[o$o]=!0,o$T=o$r.extend))for(var o$k=0;o$k<o$T.length;o$k++)o$D(o$T[o$k].self)}for(var o$T in o$r)o$D(o$T)},superSet:function(o$o,o$r,o$T,o$k){var o$W=o$o.prototype["_$set_"+o$T];o$W&&o$W.call(o$r,o$k)},superGet:function(o$o,o$r,o$T){var o$k=o$o.prototype["_$get_"+o$T];return o$k?o$k.call(o$r):null},getset:function(o$o,o$r,o$T,o$k,o$W){o$o?(o$k&&(o$r["_$GET_"+o$T]=o$k),o$W&&(o$r["_$SET_"+o$T]=o$W)):(o$k&&o$h.un(o$r,"_$get_"+o$T,o$k),o$W&&o$h.un(o$r,"_$set_"+o$T,o$W)),o$k&&o$W?Object.defineProperty(o$r,o$T,{get:o$k,set:o$W,enumerable:!1,configurable:!0}):(o$k&&Object.defineProperty(o$r,o$T,{get:o$k,enumerable:!1,configurable:!0}),o$W&&Object.defineProperty(o$r,o$T,{set:o$W,enumerable:!1,configurable:!0}))},static:function(o$T,o$k){for(var o$W=0,o$o=o$k.length;o$W<o$o;o$W+=2)if("length"==o$k[o$W])o$T.length=o$k[o$W+1].call(o$T);else{function o$r(){var o$r=o$k[o$W],o$o=o$k[o$W+1];Object.defineProperty(o$T,o$r,{get:function(){return delete this[o$r],this[o$r]=o$o.call(this)},set:function(o$o){delete this[o$r],this[o$r]=o$o},enumerable:!0,configurable:!0})}o$r()}},un:function(o$o,o$r,o$T){return o$T||(o$T=o$o[o$r]),o$h.__propun.value=o$T,Object.defineProperty(o$o,o$r,o$h.__propun),o$T},uns:function(o$r,o$o){o$o.forEach(function(o$o){o$h.un(o$r,o$o)})}};return o$U.console=o$U.console||{log:function(){}},o$U.trace=o$U.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),o$h}(window,document);!function(o$o,o$r,o$T){o$T.un,o$T.uns,o$T.static,o$T.class,o$T.getset,o$T.__newvec}(window,document,Laya),function(o$n,o$r,o$b){o$b.un,o$b.uns;var o$L=o$b.static,o$h=o$b.class,o$x=o$b.getset;o$b.__newvec;o$b.interface("laya.runtime.IMarket"),o$b.interface("laya.filters.IFilter"),o$b.interface("laya.display.ILayout"),o$b.interface("laya.resource.IDispose"),o$b.interface("laya.runtime.IPlatform"),o$b.interface("laya.resource.IDestroy"),o$b.interface("laya.runtime.IConchNode"),o$b.interface("laya.filters.IFilterAction"),o$b.interface("laya.runtime.ICPlatformClass"),o$b.interface("laya.resource.ICreateResource"),o$b.interface("laya.runtime.IConchRenderObject"),o$b.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var o$u=function(){function o$D(){}return o$h(o$D,"laya.utils.RunDriver"),o$D.FILTER_ACTIONS=[],o$D.pixelRatio=-1,o$D._charSizeTestDiv=null,o$D.now=function(){return Date.now()},o$D.getWindow=function(){return o$n},o$D.getPixelRatio=function(){if(o$D.pixelRatio<0){var o$o=o$e.context,o$r=o$o.backingStorePixelRatio||o$o.webkitBackingStorePixelRatio||o$o.mozBackingStorePixelRatio||o$o.msBackingStorePixelRatio||o$o.oBackingStorePixelRatio||o$o.backingStorePixelRatio||1;(o$D.pixelRatio=(o$e.window.devicePixelRatio||1)/o$r)<1&&(o$D.pixelRatio=1)}return o$D.pixelRatio},o$D.getIncludeStr=function(o$o){return null},o$D.createShaderCondition=function(o$o){var o$r="(function() {return "+o$o+";})";return o$b._runScript(o$r)},o$D.fontMap=[],o$D.measureText=function(o$o,o$r){var o$T=o$D.hanzi.test(o$o);if(o$T&&o$D.fontMap[o$r])return o$D.fontMap[o$r];var o$k=o$e.context;o$k.font=o$r;var o$W=o$k.measureText(o$o);return o$T&&(o$D.fontMap[o$r]=o$W),o$W},o$D.getWebGLContext=function(o$o){},o$D.beginFlush=function(){},o$D.endFinish=function(){},o$D.addToAtlas=null,o$D.flashFlushImage=function(o$o){},o$D.drawToCanvas=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=o$yo.create("2D"),o$V=new o$X(o$T,o$k,o$n);return o$O.renders[o$r]._fun(o$o,o$V,o$W,o$D),o$n},o$D.createParticleTemplate2D=null,o$D.createGLTextur=null,o$D.createWebGLContext2D=null,o$D.changeWebGLSize=function(o$o,o$r){},o$D.createRenderSprite=function(o$o,o$r){return new o$O(o$o,o$r)},o$D.createFilterAction=function(o$o){return new o$y},o$D.createGraphics=function(){return new o$i},o$D.clear=function(o$o){o$C._context.ctx.clear()},o$D.cancelLoadByUrl=function(o$o){},o$D.clearAtlas=function(o$o){},o$D.isAtlas=function(o$o){return!1},o$D.addTextureToAtlas=function(o$o){},o$D.getTexturePixels=function(o$o,o$r,o$T,o$k,o$W){return null},o$D.skinAniSprite=function(){return null},o$D.update3DLoop=function(){},o$L(o$D,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),o$D}(),o$k=(o$x(1,o$b,"alertGlobalError",null,function(o$o){var o$D=0;o$e.window.onerror=o$o?function(o$o,o$r,o$T,o$k,o$W){o$D++<5&&o$W&&alert(o$W.stack||o$W)}:null}),o$b.init=function(o$o,o$r,o$T){for(var o$k=[],o$W=2,o$D=arguments.length;o$W<o$D;o$W++)o$k.push(arguments[o$W]);if(!o$b._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=o$b._arrayBufferSlice),o$b._isinit=!0,o$e.__init__(),o$M.__init__(),o$i.__init__(),o$b.timer=new o$Z,o$b.scaleTimer=new o$Z,o$b.loader=new o$Lo,o$E.__init__(),o$W=0;for(var o$n=o$k.length;o$W<o$n;o$W++)o$k[o$W].enable&&o$k[o$W].enable();return o$v.__init__(),o$V.__init__(),o$c.__init__(),o$Y.beginCheck(),o$b._currentStage=o$b.stage=new o$Ko,o$b.stage.conchModel&&o$b.stage.conchModel.setRootNode(),o$b._getUrlPath(),o$b.render=new o$C(0,0),o$b.stage.size(o$o,o$r),o$O.__init__(),o$p.__init__(),o$j.instance.__init__(o$b.stage,o$C.canvas),o$So.__init__(),o$R.autoStopMusic=!0,o$t.__init__(),o$C.canvas}},o$b._getUrlPath=function(){var o$o=o$e.window.location,o$r=o$o.pathname;o$r=o$r&&":"==o$r.charAt(2)?o$r.substring(1):o$r,o$m.rootPath=o$m.basePath=o$m.getPath("file:"==o$o.protocol?o$r:o$o.protocol+"//"+o$o.host+o$o.pathname)},o$b._arrayBufferSlice=function(o$o,o$r){var o$T=new Uint8Array(this,o$o,o$r-o$o),o$k=new Uint8Array(o$T.length);return o$k.set(o$T),o$k.buffer},o$b._runScript=function(o$o){return o$e.window[o$b._evcode](o$o)},o$b.stage=null,o$b.timer=null,o$b.scaleTimer=null,o$b.loader=null,o$b.version="1.8.6",o$b.render=null,o$b._currentStage=null,o$b._isinit=!1,o$b.isDebug=!1,o$b.MiniAdpter={init:function(){o$n.navigator&&o$n.navigator.userAgent&&-1<o$n.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},o$L(o$b,["conchMarket",function(){return this.conchMarket=o$n.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=o$n.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function o$o(){}return o$h(o$o,"Config"),o$o.WebGLTextCacheCount=500,o$o.atlasEnable=!1,o$o.showCanvasMark=!1,o$o.animationInterval=50,o$o.isAntialias=!1,o$o.isAlpha=!1,o$o.premultipliedAlpha=!0,o$o.isStencil=!0,o$o.preserveDrawingBuffer=!1,o$o}()),o$U=function(){function o$U(){this._events=null}o$h(o$U,"laya.events.EventDispatcher");var o$o=o$U.prototype;return o$o.hasListener=function(o$o){return!!(this._events&&this._events[o$o])},o$o.event=function(o$o,o$r){if(!this._events||!this._events[o$o])return!1;var o$T=this._events[o$o];if(o$T.lock)o$T.queue||(o$T.queue=[]),o$T.queue.push(o$r);else{var o$k;for(o$T.lock=!0,o$T.cursor=o$T.head;o$T.cursor;)o$k=o$T.cursor,o$T.cursor=o$k.next,o$k.once&&o$U.delNode(o$T,o$k),null!=o$r?o$k.args?o$k.method.apply(o$k.caller,o$k.args.concat(o$r)):o$r instanceof Array?o$k.method.apply(o$k.caller,o$r):o$k.method.call(o$k.caller,o$r):o$k.method.apply(o$k.caller,o$k.args),o$k.once&&o$U.recoverHandler(o$k);o$T.lock=!1,!o$T.head&&this._events&&this._events[o$o]==o$T&&delete this._events[o$o],o$T.queue&&o$T.queue.length&&this.event(o$o,o$T.queue.shift())}return!0},o$o.on=function(o$o,o$r,o$T,o$k){return this._createListener(o$o,o$r,o$T,o$k,!1)},o$o.once=function(o$o,o$r,o$T,o$k){return this._createListener(o$o,o$r,o$T,o$k,!0)},o$o._createListener=function(o$o,o$r,o$T,o$k,o$W,o$D){void 0===o$D&&(o$D=!0),o$D&&this.off(o$o,o$r,o$T,o$W);var o$n=o$U.createHandler(o$r||this,o$T,o$k,o$W);this._events||(this._events={});var o$V=this._events,o$L=o$V[o$o];return o$L?o$L.tail?(o$n.prev=o$L.tail,o$L.tail.next=o$n,o$L.tail=o$n):o$L.head=o$L.tail=o$n:o$V[o$o]={head:o$n,tail:o$n,cursor:null,lock:!1},this},o$o.off=function(o$o,o$r,o$T,o$k){if(void 0===o$k&&(o$k=!1),!this._events||!this._events[o$o])return this;for(var o$W=this._events[o$o],o$D=o$W.head;o$D;){if((!o$r||o$D.caller===o$r)&&o$D.method===o$T&&(!o$k||o$D.once)){o$U.delNode(o$W,o$D),o$W.cursor==o$D&&(o$W.cursor=o$D.next),o$U.recoverHandler(o$D);break}o$D=o$D.next}return this},o$o.offAll=function(o$o){var o$r=this._events;if(!o$r)return this;if(o$o)this._recoverHandlers(o$r[o$o]),delete o$r[o$o];else{for(var o$T in o$r)this._recoverHandlers(o$r[o$T]);this._events=null}return this},o$o._recoverHandlers=function(o$o){if(o$o){for(var o$r=o$o.head;o$r;){o$U.delNode(o$o,o$r);var o$T=o$r.next;o$U.recoverHandler(o$r),o$r=o$T}o$o.cursor=null}},o$o.isMouseEvent=function(o$o){return o$U.MOUSE_EVENTS[o$o]},o$U.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},o$U.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},o$U.delNode=function(o$o,o$r){o$r.prev?o$r.prev.next=o$r.next:o$o.head=o$r.next,o$r.next?o$r.next.prev=o$r.prev:o$o.tail=o$r.prev},o$U.createHandler=function(o$o,o$r,o$T,o$k){var o$W=o$U._freeHandler;return o$W?(o$U._freeCount--,o$U._freeHandler=o$W.next,o$W.caller=o$o,o$W.method=o$r,o$W.args=o$T,o$W.once=o$k):o$W={caller:o$o,method:o$r,args:o$T,once:o$k},o$W.prev=o$W.next=null,o$W},o$U.recoverHandler=function(o$o){o$o.caller=o$o.method=o$o.args=o$o.prev=null,o$o.next=o$U._freeHandler,o$U._freeHandler=o$o,o$U._freeCount++},o$U._freeHandler=null,o$U._freeCount=0,o$U}(),o$$=function(){function o$W(o$o,o$r,o$T,o$k){this.once=!1,void(this._id=0)===o$k&&(o$k=!1),this.setTo(o$o,o$r,o$T,o$k)}o$h(o$W,"laya.utils.Handler");var o$o=o$W.prototype;return o$o.setTo=function(o$o,o$r,o$T,o$k){return this._id=o$W._gid++,this.caller=o$o,this.method=o$r,this.args=o$T,this.once=o$k,this},o$o.run=function(){if(null==this.method)return null;var o$o=this._id,o$r=this.method.apply(this.caller,this.args);return this._id===o$o&&this.once&&this.recover(),o$r},o$o.runWith=function(o$o){if(null==this.method)return null;var o$r=this._id;if(null==o$o)var o$T=this.method.apply(this.caller,this.args);else o$T=this.args||o$o.unshift?this.args?this.method.apply(this.caller,this.args.concat(o$o)):this.method.apply(this.caller,o$o):this.method.call(this.caller,o$o);return this._id===o$r&&this.once&&this.recover(),o$T},o$o.clear=function(){return this.caller=null,this.method=null,this.args=null,this},o$o.recover=function(){0<this._id&&(this._id=0,this.clear())},o$W.create=function(o$o,o$r,o$T,o$k){return void 0===o$k&&(o$k=!0),new o$W(o$o,o$r,o$T,o$k)},o$W._gid=1,o$W}(),o$H=function(){function o$o(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}o$h(o$o,"laya.display.BitmapFont");var o$r=o$o.prototype;return o$r.loadFont=function(o$o,o$r){this._path=o$o,this._complete=o$r,o$b.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],o$$.create(this,this.onLoaded))},o$r.onLoaded=function(){this.parseFont(o$Vo.getRes(this._path),o$Vo.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},o$r.parseFont=function(o$o,o$r){if(null!=o$o&&null!=o$r){this._texture=o$r;var o$T=o$o.getElementsByTagName("info");if(!o$T[0].getAttributeNode)return this.parseFont2(o$o,o$r);this.fontSize=parseInt(o$T[0].getAttributeNode("size").nodeValue);var o$k,o$W=o$T[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(o$W[0]),parseInt(o$W[1]),parseInt(o$W[2]),parseInt(o$W[3])],o$k=o$o.getElementsByTagName("char");var o$D=0;for(o$D=0;o$D<o$k.length;o$D++){var o$n=o$k[o$D],o$V=parseInt(o$n.getAttributeNode("id").nodeValue),o$L=parseInt(o$n.getAttributeNode("xoffset").nodeValue)/1,o$U=parseInt(o$n.getAttributeNode("yoffset").nodeValue)/1,o$h=parseInt(o$n.getAttributeNode("xadvance").nodeValue)/1,o$p=new o$P;o$p.x=parseInt(o$n.getAttributeNode("x").nodeValue),o$p.y=parseInt(o$n.getAttributeNode("y").nodeValue),o$p.width=parseInt(o$n.getAttributeNode("width").nodeValue),o$p.height=parseInt(o$n.getAttributeNode("height").nodeValue);var o$i=o$ho.create(o$r,o$p.x,o$p.y,o$p.width,o$p.height,o$L,o$U);this._maxWidth=Math.max(this._maxWidth,o$h+this.letterSpacing),this._fontCharDic[o$V]=o$i,this._fontWidthMap[o$V]=o$h}}},o$r.parseFont2=function(o$o,o$r){if(null!=o$o&&null!=o$r){this._texture=o$r;var o$T=o$o.getElementsByTagName("info");this.fontSize=parseInt(o$T[0].attributes.size.nodeValue);var o$k=o$T[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(o$k[0]),parseInt(o$k[1]),parseInt(o$k[2]),parseInt(o$k[3])];var o$W=o$o.getElementsByTagName("char"),o$D=0;for(o$D=0;o$D<o$W.length;o$D++){var o$n=o$W[o$D].attributes,o$V=parseInt(o$n.id.nodeValue),o$L=parseInt(o$n.xoffset.nodeValue)/1,o$U=parseInt(o$n.yoffset.nodeValue)/1,o$h=parseInt(o$n.xadvance.nodeValue)/1,o$p=new o$P;o$p.x=parseInt(o$n.x.nodeValue),o$p.y=parseInt(o$n.y.nodeValue),o$p.width=parseInt(o$n.width.nodeValue),o$p.height=parseInt(o$n.height.nodeValue);var o$i=o$ho.create(o$r,o$p.x,o$p.y,o$p.width,o$p.height,o$L,o$U);this._maxWidth=Math.max(this._maxWidth,o$h+this.letterSpacing),this._fontCharDic[o$V]=o$i,this._fontWidthMap[o$V]=o$h}}},o$r.getCharTexture=function(o$o){return this._fontCharDic[o$o.charCodeAt(0)]},o$r.destroy=function(){if(this._texture){for(var o$o in this._fontCharDic){var o$r=this._fontCharDic[o$o];o$r&&o$r.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},o$r.setSpaceWidth=function(o$o){this._spaceWidth=o$o},o$r.getCharWidth=function(o$o){var o$r=o$o.charCodeAt(0);return this._fontWidthMap[o$r]?this._fontWidthMap[o$r]+this.letterSpacing:" "==o$o?this._spaceWidth+this.letterSpacing:0},o$r.getTextWidth=function(o$o){for(var o$r=0,o$T=0,o$k=o$o.length;o$T<o$k;o$T++)o$r+=this.getCharWidth(o$o.charAt(o$T));return o$r},o$r.getMaxWidth=function(){return this._maxWidth},o$r.getMaxHeight=function(){return this.fontSize},o$r.drawText=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n,o$V=this.getTextWidth(o$o),o$L=0;"center"===o$W&&(o$L=(o$D-o$V)/2),"right"===o$W&&(o$L=o$D-o$V);for(var o$U=0,o$h=0,o$p=o$o.length;o$h<o$p;o$h++)(o$n=this.getCharTexture(o$o.charAt(o$h)))&&(o$r.graphics.drawTexture(o$n,o$T+o$U+o$L,o$k),o$U+=this.getCharWidth(o$o.charAt(o$h)))},o$o}(),o$V=function(){function o$T(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=o$T._TF_EMPTY}o$h(o$T,"laya.display.css.Style");var o$o=o$T.prototype;return o$o.getTransform=function(){return this._tf},o$o.setTransform=function(o$o){this._tf="none"!==o$o&&o$o?o$o:o$T._TF_EMPTY},o$o.setTranslateX=function(o$o){this._tf===o$T._TF_EMPTY&&(this._tf=new o$W),this._tf.translateX=o$o},o$o.setTranslateY=function(o$o){this._tf===o$T._TF_EMPTY&&(this._tf=new o$W),this._tf.translateY=o$o},o$o.setScaleX=function(o$o){this._tf===o$T._TF_EMPTY&&(this._tf=new o$W),this._tf.scaleX=o$o},o$o.setScale=function(o$o,o$r){this._tf===o$T._TF_EMPTY&&(this._tf=new o$W),this._tf.scaleX=o$o,this._tf.scaleY=o$r},o$o.setScaleY=function(o$o){this._tf===o$T._TF_EMPTY&&(this._tf=new o$W),this._tf.scaleY=o$o},o$o.setRotate=function(o$o){this._tf===o$T._TF_EMPTY&&(this._tf=new o$W),this._tf.rotate=o$o},o$o.setSkewX=function(o$o){this._tf===o$T._TF_EMPTY&&(this._tf=new o$W),this._tf.skewX=o$o},o$o.setSkewY=function(o$o){this._tf===o$T._TF_EMPTY&&(this._tf=new o$W),this._tf.skewY=o$o},o$o.destroy=function(){this.scrollRect=null},o$o.render=function(o$o,o$r,o$T,o$k){},o$o.getCSSStyle=function(){return o$ro.EMPTY},o$o._enableLayout=function(){return!1},o$x(0,o$o,"scaleX",function(){return this._tf.scaleX},function(o$o){this.setScaleX(o$o)}),o$x(0,o$o,"transform",function(){return this.getTransform()},function(o$o){this.setTransform(o$o)}),o$x(0,o$o,"translateX",function(){return this._tf.translateX},function(o$o){this.setTranslateX(o$o)}),o$x(0,o$o,"translateY",function(){return this._tf.translateY},function(o$o){this.setTranslateY(o$o)}),o$x(0,o$o,"scaleY",function(){return this._tf.scaleY},function(o$o){this.setScaleY(o$o)}),o$x(0,o$o,"block",function(){return 0!=(1&this._type)}),o$x(0,o$o,"skewY",function(){return this._tf.skewY},function(o$o){this.setSkewY(o$o)}),o$x(0,o$o,"rotate",function(){return this._tf.rotate},function(o$o){this.setRotate(o$o)}),o$x(0,o$o,"skewX",function(){return this._tf.skewX},function(o$o){this.setSkewX(o$o)}),o$x(0,o$o,"paddingLeft",function(){return 0}),o$x(0,o$o,"paddingTop",function(){return 0}),o$x(0,o$o,"absolute",function(){return!0}),o$T.__init__=function(){o$T._TF_EMPTY=new o$W,o$T.EMPTY=new o$T},o$T.EMPTY=null,o$T._TF_EMPTY=null,o$T}(),o$v=function(){function o$r(o$o){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=o$I.create(o$r.defaultColor),this.family=o$r.defaultFamily,this.stroke=o$r._STROKE,this.size=o$r.defaultSize,o$o&&o$o!==o$r.EMPTY&&o$o.copyTo(this)}o$h(o$r,"laya.display.css.Font");var o$o=o$r.prototype;return o$o.set=function(o$o){this._text=null;for(var o$r=o$o.split(" "),o$T=0,o$k=o$r.length;o$T<o$k;o$T++){var o$W=o$r[o$T];switch(o$W){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<o$W.indexOf("px")&&(this.size=parseInt(o$W),this.family=o$r[o$T+1],o$T++)}},o$o.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},o$o.copyTo=function(o$o){o$o._type=this._type,o$o._text=this._text,o$o._weight=this._weight,o$o._color=this._color,o$o.family=this.family,o$o.stroke=this.stroke!=o$r._STROKE?this.stroke.slice():o$r._STROKE,o$o.indent=this.indent,o$o.size=this.size},o$x(0,o$o,"password",function(){return 0!=(1024&this._type)},function(o$o){o$o?this._type|=1024:this._type&=-1025}),o$x(0,o$o,"color",function(){return this._color.strColor},function(o$o){this._color=o$I.create(o$o)}),o$x(0,o$o,"italic",function(){return 0!=(512&this._type)},function(o$o){o$o?this._type|=512:this._type&=-513}),o$x(0,o$o,"bold",function(){return 0!=(2048&this._type)},function(o$o){o$o?this._type|=2048:this._type&=-2049}),o$x(0,o$o,"weight",function(){return""+this._weight},function(o$o){var o$r=0;switch(o$o){case"normal":break;case"bold":this.bold=!0,o$r=700;break;case"bolder":o$r=800;break;case"lighter":o$r=100;break;default:o$r=parseInt(o$o)}this._weight=o$r,this._text=null}),o$x(0,o$o,"decoration",function(){return this._decoration?this._decoration.value:null},function(o$o){var o$r=o$o.split(" ");switch(this._decoration||(this._decoration={}),o$r[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=o$r[0]}o$r[1]&&(this._decoration.color=o$I.create(o$r)),this._decoration.value=o$o}),o$r.__init__=function(){o$r.EMPTY=new o$r(null)},o$r.EMPTY=null,o$r.defaultColor="#000000",o$r.defaultSize=12,o$r.defaultFamily="Arial",o$r.defaultFont="12px Arial",o$r._STROKE=[0,"#000000"],o$r._ITALIC=512,o$r._PASSWORD=1024,o$r._BOLD=2048,o$r}(),o$W=function(){function o$o(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return o$h(o$o,"laya.display.css.TransformInfo"),o$o}(),o$i=function(){function o$p(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,o$C.isConchNode){this._nativeObj=new o$n._conchGraphics,this.id=this._nativeObj.conchID}}o$h(o$p,"laya.display.Graphics");var o$o=o$p.prototype;return o$o.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},o$o.clear=function(o$o){void 0===o$o&&(o$o=!1);var o$r=0,o$T=0;if(o$o){var o$k=this._one;if(this._cmds){for(o$T=this._cmds.length,o$r=0;o$r<o$T;o$r++)!(o$k=this._cmds[o$r])||o$k.callee!==o$C._context._drawTexture&&o$k.callee!==o$C._context._drawTextureWithTransform||(o$k[0]=null,o$p._cache.push(o$k));this._cmds.length=0}else o$k&&(!o$k||o$k.callee!==o$C._context._drawTexture&&o$k.callee!==o$C._context._drawTextureWithTransform||(o$k[0]=null,o$p._cache.push(o$k)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(o$r=0,o$T=this._vectorgraphArray.length;o$r<o$T;o$r++)o$B.getInstance().deleteShape(this._vectorgraphArray[o$r]);this._vectorgraphArray.length=0}},o$o._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},o$o._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new o$T,this._graphicBounds._graphics=this)},o$o._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},o$o._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},o$o.getBounds=function(o$o){return void 0===o$o&&(o$o=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(o$o)},o$o.getBoundPoints=function(o$o){return void 0===o$o&&(o$o=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(o$o)},o$o._addCmd=function(o$o){this._cmds=this._cmds||[],o$o.callee=o$o.shift(),this._cmds.push(o$o)},o$o.setFilters=function(o$o){this._saveToCmd(o$C._context._setFilters,o$o)},o$o.drawTexture=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){if(void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=0),void 0===o$W&&(o$W=0),void 0===o$n&&(o$n=1),!o$o||o$n<.01)return null;o$k||(o$k=o$o.sourceWidth),o$W||(o$W=o$o.sourceHeight),o$n=o$n<0?0:1<o$n?1:o$n;var o$V,o$L=!o$C.isWebGL&&(o$e.onFirefox||o$e.onEdge||o$e.onIE||o$e.onSafari)?.5:0,o$U=o$k/o$o.sourceWidth,o$h=o$W/o$o.sourceHeight;return o$k=o$o.width*o$U,o$W=o$o.height*o$h,o$o.loaded&&(o$k<=0||o$W<=0)?null:(o$r+=o$o.offsetX*o$U,o$T+=o$o.offsetY*o$h,this._sp&&(this._sp._renderType|=512),o$r-=o$L,o$T-=o$L,o$k+=2*o$L,o$W+=2*o$L,o$p._cache.length?((o$V=o$p._cache.pop())[0]=o$o,o$V[1]=o$r,o$V[2]=o$T,o$V[3]=o$k,o$V[4]=o$W,o$V[5]=o$D,o$V[6]=o$n):o$V=[o$o,o$r,o$T,o$k,o$W,o$D,o$n],o$V.callee=o$D||1!=o$n?o$C._context._drawTextureWithTransform:o$C._context._drawTexture,null!=this._one||o$D||1!=o$n?this._saveToCmd(o$V.callee,o$V):(this._one=o$V,this._render=this._renderOneImg),o$o.loaded||o$o.once("loaded",this,this._textureLoaded,[o$o,o$V]),this._repaint(),o$V)},o$o.cleanByTexture=function(o$o,o$r,o$T,o$k,o$W){if(void 0===o$k&&(o$k=0),void 0===o$W&&(o$W=0),!o$o)return this.clear();if(this._one&&this._render===this._renderOneImg){o$k||(o$k=o$o.sourceWidth),o$W||(o$W=o$o.sourceHeight);var o$D=o$k/o$o.sourceWidth,o$n=o$W/o$o.sourceHeight;o$k=o$o.width*o$D,o$W=o$o.height*o$n,o$r+=o$o.offsetX*o$D,o$T+=o$o.offsetY*o$n,this._one[0]=o$o,this._one[1]=o$r,this._one[2]=o$T,this._one[3]=o$k,this._one[4]=o$W,this._repaint()}else this.clear(),o$o&&this.drawTexture(o$o,o$r,o$T,o$k,o$W)},o$o.drawTextures=function(o$o,o$r){o$o&&this._saveToCmd(o$C._context._drawTextures,[o$o,o$r])},o$o.fillTexture=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){if(void 0===o$k&&(o$k=0),void 0===o$W&&(o$W=0),void 0===o$D&&(o$D="repeat"),o$o){var o$V=[o$o,o$r,o$T,o$k,o$W,o$D,o$n||o$F.EMPTY,{}];o$o.loaded||o$o.once("loaded",this,this._textureLoaded,[o$o,o$V]),this._saveToCmd(o$C._context._fillTexture,o$V)}},o$o._textureLoaded=function(o$o,o$r){o$r[3]=o$r[3]||o$o.width,o$r[4]=o$r[4]||o$o.height,this._repaint()},o$o.fillCircle=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){o$T.bitmap.enableMerageInAtlas=!1;var o$V=new Float32Array(2*(o$n+1)),o$L=new Float32Array(2*(o$n+1)),o$U=new Uint16Array(3*o$n),o$h=2*Math.PI/o$n,o$p=0;o$V[0]=o$k,o$V[1]=o$W,o$L[0]=o$k/o$T.width,o$L[1]=o$W/o$T.height;for(var o$i=2,o$v=0;o$v<o$n;o$v++){var o$x=o$D*Math.cos(o$p)+o$k,o$j=o$D*Math.sin(o$p)+o$W;o$V[o$i]=o$x,o$V[o$i+1]=o$j,o$L[o$i]=o$x/o$T.width,o$L[o$i+1]=o$j/o$T.height,o$p+=o$h,o$i+=2}for(o$v=o$i=0;o$v<o$n;o$v++)o$U[o$i++]=0,o$U[o$i++]=o$v+1,o$U[o$i++]=o$n+1<=o$v+2?1:o$v+2;this.drawTriangles(o$T,o$o,o$r,o$V,o$L,o$U)},o$o.drawTriangles=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){void 0===o$V&&(o$V=1),this._saveToCmd(o$C._context.drawTriangles,[o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U])},o$o._saveToCmd=function(o$o,o$r){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=o$r,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(o$r)),o$r.callee=o$o,this._repaint(),o$r},o$o.clipRect=function(o$o,o$r,o$T,o$k){this._saveToCmd(o$C._context._clipRect,[o$o,o$r,o$T,o$k])},o$o.fillText=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){void 0===o$n&&(o$n=0),this._saveToCmd(o$C._context._fillText,[o$o,o$r,o$T,o$k||o$v.defaultFont,o$W,o$D])},o$o.fillBorderText=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){this._saveToCmd(o$C._context._fillBorderText,[o$o,o$r,o$T,o$k||o$v.defaultFont,o$W,o$D,o$n,o$V])},o$o.strokeText=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this._saveToCmd(o$C._context._strokeText,[o$o,o$r,o$T,o$k||o$v.defaultFont,o$W,o$D,o$n])},o$o.alpha=function(o$o){o$o=o$o<0?0:1<o$o?1:o$o,this._saveToCmd(o$C._context._alpha,[o$o])},o$o.setAlpha=function(o$o){o$o=o$o<0?0:1<o$o?1:o$o,this._saveToCmd(o$C._context._setAlpha,[o$o])},o$o.transform=function(o$o,o$r,o$T){void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),this._saveToCmd(o$C._context._transform,[o$o,o$r,o$T])},o$o.rotate=function(o$o,o$r,o$T){void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),this._saveToCmd(o$C._context._rotate,[o$o,o$r,o$T])},o$o.scale=function(o$o,o$r,o$T,o$k){void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=0),this._saveToCmd(o$C._context._scale,[o$o,o$r,o$T,o$k])},o$o.translate=function(o$o,o$r){this._saveToCmd(o$C._context._translate,[o$o,o$r])},o$o.save=function(){this._saveToCmd(o$C._context._save,[])},o$o.restore=function(){this._saveToCmd(o$C._context._restore,[])},o$o.replaceText=function(o$o){this._repaint();var o$r=this._cmds;if(o$r){for(var o$T=o$r.length-1;-1<o$T;o$T--)if(this._isTextCmd(o$r[o$T].callee))return o$r[o$T][0].toUpperCase?o$r[o$T][0]=o$o:o$r[o$T][0].setText(o$o),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=o$o:this._one[0].setText(o$o),!0;return!1},o$o._isTextCmd=function(o$o){return o$o===o$C._context._fillText||o$o===o$C._context._fillBorderText||o$o===o$C._context._strokeText},o$o.replaceTextColor=function(o$o){this._repaint();var o$r=this._cmds;if(o$r)for(var o$T=o$r.length-1;-1<o$T;o$T--)this._isTextCmd(o$r[o$T].callee)&&(o$r[o$T][4]=o$o,o$r[o$T][0].toUpperCase||(o$r[o$T][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=o$o,this._one[0].toUpperCase||(this._one[0].changed=!0))},o$o.loadImage=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=this;void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=0),void 0===o$W&&(o$W=0);var o$V=o$Vo.getRes(o$o);function o$L(o$o){o$o&&(o$n.drawTexture(o$o,o$r,o$T,o$k,o$W),null!=o$D&&o$D.call(o$n._sp,o$o))}o$V?o$L(o$V):o$b.loader.load(o$o,o$$.create(null,o$L),null,"image")},o$o._renderEmpty=function(o$o,o$r,o$T,o$k){},o$o._renderAll=function(o$o,o$r,o$T,o$k){for(var o$W,o$D=this._cmds,o$n=0,o$V=o$D.length;o$n<o$V;o$n++)(o$W=o$D[o$n]).callee.call(o$r,o$T,o$k,o$W)},o$o._renderOne=function(o$o,o$r,o$T,o$k){this._one.callee.call(o$r,o$T,o$k,this._one)},o$o._renderOneImg=function(o$o,o$r,o$T,o$k){this._one.callee.call(o$r,o$T,o$k,this._one),2305!==o$o._renderType&&(o$o._renderType|=1)},o$o.drawLine=function(o$o,o$r,o$T,o$k,o$W,o$D){void 0===o$D&&(o$D=1);var o$n=0;o$C.isWebGL&&(o$n=o$B.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(o$n));var o$V=o$D%2==0?0:.5,o$L=[o$o+o$V,o$r+o$V,o$T+o$V,o$k+o$V,o$W,o$D,o$n];this._saveToCmd(o$C._context._drawLine,o$L)},o$o.drawLines=function(o$o,o$r,o$T,o$k,o$W){void 0===o$W&&(o$W=1);var o$D=0;if(o$T&&!(o$T.length<4)){o$C.isWebGL&&(o$D=o$B.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(o$D));var o$n=o$W%2==0?0:.5,o$V=[o$o+o$n,o$r+o$n,o$T,o$k,o$W,o$D];this._saveToCmd(o$C._context._drawLines,o$V)}},o$o.drawCurves=function(o$o,o$r,o$T,o$k,o$W){void 0===o$W&&(o$W=1);var o$D=[o$o,o$r,o$T,o$k,o$W];this._saveToCmd(o$C._context._drawCurves,o$D)},o$o.drawRect=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){void 0===o$n&&(o$n=1);var o$V=o$D?o$n/2:0,o$L=o$D?o$n:0,o$U=[o$o+o$V,o$r+o$V,o$T-o$L,o$k-o$L,o$W,o$D,o$n];this._saveToCmd(o$C._context._drawRect,o$U)},o$o.drawCircle=function(o$o,o$r,o$T,o$k,o$W,o$D){void 0===o$D&&(o$D=1);var o$n=o$W?o$D/2:0,o$V=0;o$C.isWebGL&&(o$V=o$B.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(o$V));var o$L=[o$o,o$r,o$T-o$n,o$k,o$W,o$D,o$V];this._saveToCmd(o$C._context._drawCircle,o$L)},o$o.drawPie=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){void 0===o$V&&(o$V=1);var o$L=o$n?o$V/2:0,o$U=o$n?o$V:0,o$h=0;o$C.isWebGL&&(o$h=o$B.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(o$h));var o$p=[o$o+o$L,o$r+o$L,o$T-o$U,o$k,o$W,o$D,o$n,o$V,o$h];o$p[3]=o$g.toRadian(o$k),o$p[4]=o$g.toRadian(o$W),this._saveToCmd(o$C._context._drawPie,o$p)},o$o.drawPoly=function(o$o,o$r,o$T,o$k,o$W,o$D){void 0===o$D&&(o$D=1);var o$n=0,o$V=!1;o$C.isWebGL&&(o$n=o$B.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(o$n),o$V=!(6<o$T.length));var o$L=o$W?o$D%2==0?0:.5:0,o$U=[o$o+o$L,o$r+o$L,o$T,o$k,o$W,o$D,o$n,o$V];this._saveToCmd(o$C._context._drawPoly,o$U)},o$o.drawPath=function(o$o,o$r,o$T,o$k,o$W){var o$D=[o$o,o$r,o$T,o$k,o$W];this._saveToCmd(o$C._context._drawPath,o$D)},o$x(0,o$o,"cmds",function(){return this._cmds},function(o$o){this._sp&&(this._sp._renderType|=512),this._cmds=o$o,this._render=this._renderAll,this._repaint()}),o$p.__init__=function(){if(o$C.isConchNode){for(var o$o=laya.display.Graphics.prototype,o$r=o$e.window.ConchGraphics.prototype,o$T=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],o$k=0,o$W=o$T.length;o$k<=o$W;o$k++){var o$D=o$T[o$k];o$o[o$D]=o$r[o$D]}o$o._saveToCmd=null,o$r.drawImageS&&(o$o.drawTextures=function(o$o,o$r){if(o$o&&o$o.loaded&&o$o.bitmap&&o$o.source){var o$T=o$o.uv,o$k=o$o.bitmap.width,o$W=o$o.bitmap.height;this.drawImageS(o$o.bitmap.source,o$T[0]*o$k,o$T[1]*o$W,(o$T[2]-o$T[0])*o$k,(o$T[5]-o$T[3])*o$W,o$o.offsetX,o$o.offsetY,o$o.width,o$o.height,o$r)}}),o$o.drawTexture=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){if(void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=0),void 0===o$W&&(o$W=0),void 0===o$n&&(o$n=1),o$o)if(o$o.loaded){if(o$o.loaded&&o$o.bitmap&&o$o.source&&(o$k||(o$k=o$o.sourceWidth),o$W||(o$W=o$o.sourceHeight),o$n=o$n<0?0:1<o$n?1:o$n,o$k=o$k-o$o.sourceWidth+o$o.width,o$W=o$W-o$o.sourceHeight+o$o.height,!(o$k<=0||o$W<=0))){o$r+=o$o.offsetX,o$T+=o$o.offsetY;var o$V=o$o.uv,o$L=o$o.bitmap.width,o$U=o$o.bitmap.height;o$V[4]<o$V[0]&&o$V[5]<o$V[1]?this.drawImageM(o$o.bitmap.source,o$V[4]*o$L,o$V[5]*o$U,(o$V[0]-o$V[4])*o$L,(o$V[1]-o$V[5])*o$U,o$r,o$T,o$k,o$W,o$D,o$n):this.drawImageM(o$o.bitmap.source,o$V[0]*o$L,o$V[1]*o$U,(o$V[2]-o$V[0])*o$L,(o$V[5]-o$V[3])*o$U,o$r,o$T,o$k,o$W,o$D,o$n),this._repaint()}}else o$o.once("loaded",this,function(){this.drawTexture(o$o,o$r,o$T,o$k,o$W,o$D)})},o$o.fillTexture=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){if(void 0===o$k&&(o$k=0),void 0===o$W&&(o$W=0),void 0===o$D&&(o$D="repeat"),o$o&&o$o.loaded){var o$V,o$L=o$C._context.ctx,o$U=o$o.bitmap.width,o$h=o$o.bitmap.height,o$p=o$o.uv;o$V=o$o.uv!=o$ho.DEF_UV?o$L.createPattern(o$o.bitmap.source,o$D,o$p[0]*o$U,o$p[1]*o$h,(o$p[2]-o$p[0])*o$U,(o$p[5]-o$p[3])*o$h):o$L.createPattern(o$o.bitmap.source,o$D);var o$i=0,o$v=0;o$n&&(o$r+=o$n.x%o$o.width,o$T+=o$n.y%o$o.height,o$i-=o$n.x%o$o.width,o$v-=o$n.y%o$o.height),this._fillImage(o$V,o$r,o$T,o$i,o$v,o$k,o$W)}}}},o$p._cache=[],o$p}(),o$T=function(){function o$y(){this._cacheBoundsType=!1}o$h(o$y,"laya.display.GraphicsBounds");var o$o=o$y.prototype;return o$o.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},o$o.reset=function(){this._temp&&(this._temp.length=0)},o$o.getBounds=function(o$o){return void 0===o$o&&(o$o=!1),(!this._bounds||!this._temp||this._temp.length<1||o$o!=this._cacheBoundsType)&&(this._bounds=o$P._getWrapRec(this.getBoundPoints(o$o),this._bounds)),this._cacheBoundsType=o$o,this._bounds},o$o.getBoundPoints=function(o$o){return void 0===o$o&&(o$o=!1),(!this._temp||this._temp.length<1||o$o!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(o$o)),this._cacheBoundsType=o$o,this._rstBoundPoints=o$g.copyArray(this._rstBoundPoints,this._temp)},o$o._getCmdPoints=function(o$o){void 0===o$o&&(o$o=!1);var o$r,o$T,o$k=o$C._context,o$W=this._graphics.cmds;if((o$r=this._temp||(this._temp=[])).length=0,o$W||null==this._graphics._one||(o$y._tempCmds.length=0,o$y._tempCmds.push(this._graphics._one),o$W=o$y._tempCmds),!o$W)return o$r;(o$T=o$y._tempMatrixArrays).length=0;var o$D=o$y._initMatrix;o$D.identity();for(var o$n,o$V,o$L=o$y._tempMatrix,o$U=NaN,o$h=NaN,o$p=NaN,o$i=NaN,o$v=NaN,o$x=NaN,o$j=0,o$_=o$W.length;o$j<o$_;o$j++)if((o$n=o$W[o$j]).callee)switch(o$n.callee){case o$k._save:case 7:o$T.push(o$D),o$D=o$D.clone();break;case o$k._restore:case 8:o$D=o$T.pop();break;case o$k._scale:case 5:o$L.identity(),o$L.translate(-o$n[2],-o$n[3]),o$L.scale(o$n[0],o$n[1]),o$L.translate(o$n[2],o$n[3]),this._switchMatrix(o$D,o$L);break;case o$k._rotate:case 3:o$L.identity(),o$L.translate(-o$n[1],-o$n[2]),o$L.rotate(o$n[0]),o$L.translate(o$n[1],o$n[2]),this._switchMatrix(o$D,o$L);break;case o$k._translate:case 6:o$L.identity(),o$L.translate(o$n[0],o$n[1]),this._switchMatrix(o$D,o$L);break;case o$k._transform:case 4:o$L.identity(),o$L.translate(-o$n[1],-o$n[2]),o$L.concat(o$n[0]),o$L.translate(o$n[1],o$n[2]),this._switchMatrix(o$D,o$L);break;case 16:case 24:o$y._addPointArrToRst(o$r,o$P._getBoundPointS(o$n[0],o$n[1],o$n[2],o$n[3]),o$D);break;case 17:o$D.copyTo(o$L),o$L.concat(o$n[4]),o$y._addPointArrToRst(o$r,o$P._getBoundPointS(o$n[0],o$n[1],o$n[2],o$n[3]),o$L);break;case o$k._drawTexture:o$V=o$n[0],o$o?o$n[3]&&o$n[4]?o$y._addPointArrToRst(o$r,o$P._getBoundPointS(o$n[1],o$n[2],o$n[3],o$n[4]),o$D):(o$V=o$n[0],o$y._addPointArrToRst(o$r,o$P._getBoundPointS(o$n[1],o$n[2],o$V.width,o$V.height),o$D)):(o$U=(o$n[3]||o$V.sourceWidth)/o$V.width,o$h=(o$n[4]||o$V.sourceHeight)/o$V.height,o$p=o$U*o$V.sourceWidth,o$i=o$h*o$V.sourceHeight,o$v=0<o$V.offsetX?o$V.offsetX:0,o$x=0<o$V.offsetY?o$V.offsetY:0,o$v*=o$U,o$x*=o$h,o$y._addPointArrToRst(o$r,o$P._getBoundPointS(o$n[1]-o$v,o$n[2]-o$x,o$p,o$i),o$D));break;case o$k._fillTexture:o$n[3]&&o$n[4]?o$y._addPointArrToRst(o$r,o$P._getBoundPointS(o$n[1],o$n[2],o$n[3],o$n[4]),o$D):(o$V=o$n[0],o$y._addPointArrToRst(o$r,o$P._getBoundPointS(o$n[1],o$n[2],o$V.width,o$V.height),o$D));break;case o$k._drawTextureWithTransform:var o$K;o$K=o$n[5]?(o$D.copyTo(o$L),o$L.concat(o$n[5]),o$L):o$D,o$o?o$n[3]&&o$n[4]?o$y._addPointArrToRst(o$r,o$P._getBoundPointS(o$n[1],o$n[2],o$n[3],o$n[4]),o$K):(o$V=o$n[0],o$y._addPointArrToRst(o$r,o$P._getBoundPointS(o$n[1],o$n[2],o$V.width,o$V.height),o$K)):(o$V=o$n[0],o$U=(o$n[3]||o$V.sourceWidth)/o$V.width,o$h=(o$n[4]||o$V.sourceHeight)/o$V.height,o$p=o$U*o$V.sourceWidth,o$i=o$h*o$V.sourceHeight,o$v=0<o$V.offsetX?o$V.offsetX:0,o$x=0<o$V.offsetY?o$V.offsetY:0,o$v*=o$U,o$x*=o$h,o$y._addPointArrToRst(o$r,o$P._getBoundPointS(o$n[1]-o$v,o$n[2]-o$x,o$p,o$i),o$K));break;case o$k._drawRect:case 13:o$y._addPointArrToRst(o$r,o$P._getBoundPointS(o$n[0],o$n[1],o$n[2],o$n[3]),o$D);break;case o$k._drawCircle:case o$k._fillCircle:case 14:o$y._addPointArrToRst(o$r,o$P._getBoundPointS(o$n[0]-o$n[2],o$n[1]-o$n[2],o$n[2]+o$n[2],o$n[2]+o$n[2]),o$D);break;case o$k._drawLine:case 20:o$y._tempPoints.length=0;var o$$;o$$=.5*o$n[5],o$n[0]==o$n[2]?o$y._tempPoints.push(o$n[0]+o$$,o$n[1],o$n[2]+o$$,o$n[3],o$n[0]-o$$,o$n[1],o$n[2]-o$$,o$n[3]):o$n[1]==o$n[3]?o$y._tempPoints.push(o$n[0],o$n[1]+o$$,o$n[2],o$n[3]+o$$,o$n[0],o$n[1]-o$$,o$n[2],o$n[3]-o$$):o$y._tempPoints.push(o$n[0],o$n[1],o$n[2],o$n[3]),o$y._addPointArrToRst(o$r,o$y._tempPoints,o$D);break;case o$k._drawCurves:case 22:o$y._addPointArrToRst(o$r,o$l.I.getBezierPoints(o$n[2]),o$D,o$n[0],o$n[1]);break;case o$k._drawPoly:case o$k._drawLines:case 18:o$y._addPointArrToRst(o$r,o$n[2],o$D,o$n[0],o$n[1]);break;case o$k._drawPath:case 19:o$y._addPointArrToRst(o$r,this._getPathPoints(o$n[2]),o$D,o$n[0],o$n[1]);break;case o$k._drawPie:case 15:o$y._addPointArrToRst(o$r,this._getPiePoints(o$n[0],o$n[1],o$n[2],o$n[3],o$n[4]),o$D)}return 200<o$r.length?o$r=o$g.copyArray(o$r,o$P._getWrapRec(o$r)._getBoundPoints()):8<o$r.length&&(o$r=o$S.scanPList(o$r)),o$r},o$o._switchMatrix=function(o$o,o$r){o$r.concat(o$o),o$r.copyTo(o$o)},o$o._getPiePoints=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$y._tempPoints;o$y._tempPoints.length=0,o$D.push(o$o,o$r);var o$n=(o$W-o$k)%(2*Math.PI)/10,o$V=NaN,o$L=o$k;for(o$V=0;o$V<=10;o$V++)o$D.push(o$o+o$T*Math.cos(o$L),o$r+o$T*Math.sin(o$L)),o$L+=o$n;return o$D},o$o._getPathPoints=function(o$o){var o$r,o$T,o$k=0,o$W=o$y._tempPoints;for(o$W.length=0,o$r=o$o.length,o$k=0;o$k<o$r;o$k++)1<(o$T=o$o[o$k]).length&&(o$W.push(o$T[1],o$T[2]),3<o$T.length&&o$W.push(o$T[3],o$T[4]));return o$W},o$y._addPointArrToRst=function(o$o,o$r,o$T,o$k,o$W){void 0===o$k&&(o$k=0),void 0===o$W&&(o$W=0);var o$D,o$n=0;for(o$D=o$r.length,o$n=0;o$n<o$D;o$n+=2)o$y._addPointToRst(o$o,o$r[o$n]+o$k,o$r[o$n+1]+o$W,o$T)},o$y._addPointToRst=function(o$o,o$r,o$T,o$k){var o$W=o$F.TEMP;o$W.setTo(o$r||0,o$T||0),o$k.transformPoint(o$W),o$o.push(o$W.x,o$W.y)},o$y._tempPoints=[],o$y._tempMatrixArrays=[],o$y._tempCmds=[],o$L(o$y,["_tempMatrix",function(){return this._tempMatrix=new o$s},"_initMatrix",function(){return this._initMatrix=new o$s}]),o$y}(),o$D=function(){function o$o(){}o$h(o$o,"laya.events.Event");var o$r=o$o.prototype;return o$r.setTo=function(o$o,o$r,o$T){return this.type=o$o,this.currentTarget=o$r,this.target=o$T,this},o$r.stopPropagation=function(){this._stoped=!0},o$x(0,o$r,"stageY",function(){return o$b.stage.mouseY}),o$x(0,o$r,"charCode",function(){return this.nativeEvent.charCode}),o$x(0,o$r,"touches",function(){var o$o=this.nativeEvent.touches;if(o$o)for(var o$r=o$b.stage,o$T=0,o$k=o$o.length;o$T<o$k;o$T++){var o$W=o$o[o$T],o$D=o$F.TEMP;o$D.setTo(o$W.clientX,o$W.clientY),o$r._canvasTransform.invertTransformPoint(o$D),o$r.transform.invertTransformPoint(o$D),o$W.stageX=o$D.x,o$W.stageY=o$D.y}return o$o}),o$x(0,o$r,"keyLocation",function(){return this.nativeEvent.keyLocation}),o$x(0,o$r,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),o$x(0,o$r,"altKey",function(){return this.nativeEvent.altKey}),o$x(0,o$r,"shiftKey",function(){return this.nativeEvent.shiftKey}),o$x(0,o$r,"stageX",function(){return o$b.stage.mouseX}),o$o.EMPTY=new o$o,o$o.MOUSE_DOWN="mousedown",o$o.MOUSE_UP="mouseup",o$o.CLICK="click",o$o.RIGHT_MOUSE_DOWN="rightmousedown",o$o.RIGHT_MOUSE_UP="rightmouseup",o$o.RIGHT_CLICK="rightclick",o$o.MOUSE_MOVE="mousemove",o$o.MOUSE_OVER="mouseover",o$o.MOUSE_OUT="mouseout",o$o.MOUSE_WHEEL="mousewheel",o$o.ROLL_OVER="mouseover",o$o.ROLL_OUT="mouseout",o$o.DOUBLE_CLICK="doubleclick",o$o.CHANGE="change",o$o.CHANGED="changed",o$o.RESIZE="resize",o$o.ADDED="added",o$o.REMOVED="removed",o$o.DISPLAY="display",o$o.UNDISPLAY="undisplay",o$o.ERROR="error",o$o.COMPLETE="complete",o$o.LOADED="loaded",o$o.INITED="inited",o$o.PROGRESS="progress",o$o.INPUT="input",o$o.RENDER="render",o$o.OPEN="open",o$o.MESSAGE="message",o$o.CLOSE="close",o$o.KEY_DOWN="keydown",o$o.KEY_PRESS="keypress",o$o.KEY_UP="keyup",o$o.FRAME="enterframe",o$o.DRAG_START="dragstart",o$o.DRAG_MOVE="dragmove",o$o.DRAG_END="dragend",o$o.ENTER="enter",o$o.SELECT="select",o$o.BLUR="blur",o$o.FOCUS="focus",o$o.VISIBILITY_CHANGE="visibilitychange",o$o.FOCUS_CHANGE="focuschange",o$o.PLAYED="played",o$o.PAUSED="paused",o$o.STOPPED="stopped",o$o.START="start",o$o.END="end",o$o.ENABLE_CHANGED="enablechanged",o$o.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",o$o.COMPONENT_ADDED="componentadded",o$o.COMPONENT_REMOVED="componentremoved",o$o.LAYER_CHANGED="layerchanged",o$o.HIERARCHY_LOADED="hierarchyloaded",o$o.RECOVERED="recovered",o$o.RELEASED="released",o$o.LINK="link",o$o.LABEL="label",o$o.FULL_SCREEN_CHANGE="fullscreenchange",o$o.DEVICE_LOST="devicelost",o$o.MESH_CHANGED="meshchanged",o$o.MATERIAL_CHANGED="materialchanged",o$o.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",o$o.ANIMATION_CHANGED="animationchanged",o$o.TRIGGER_ENTER="triggerenter",o$o.TRIGGER_STAY="triggerstay",o$o.TRIGGER_EXIT="triggerexit",o$o.TRAIL_FILTER_CHANGE="trailfilterchange",o$o.DOMINO_FILTER_CHANGE="dominofilterchange",o$o}(),o$p=(function(){function o$o(){}o$h(o$o,"laya.events.Keyboard"),o$o.NUMBER_0=48,o$o.NUMBER_1=49,o$o.NUMBER_2=50,o$o.NUMBER_3=51,o$o.NUMBER_4=52,o$o.NUMBER_5=53,o$o.NUMBER_6=54,o$o.NUMBER_7=55,o$o.NUMBER_8=56,o$o.NUMBER_9=57,o$o.A=65,o$o.B=66,o$o.C=67,o$o.D=68,o$o.E=69,o$o.F=70,o$o.G=71,o$o.H=72,o$o.I=73,o$o.J=74,o$o.K=75,o$o.L=76,o$o.M=77,o$o.N=78,o$o.O=79,o$o.P=80,o$o.Q=81,o$o.R=82,o$o.S=83,o$o.T=84,o$o.U=85,o$o.V=86,o$o.W=87,o$o.X=88,o$o.Y=89,o$o.Z=90,o$o.F1=112,o$o.F2=113,o$o.F3=114,o$o.F4=115,o$o.F5=116,o$o.F6=117,o$o.F7=118,o$o.F8=119,o$o.F9=120,o$o.F10=121,o$o.F11=122,o$o.F12=123,o$o.F13=124,o$o.F14=125,o$o.F15=126,o$o.NUMPAD=21,o$o.NUMPAD_0=96,o$o.NUMPAD_1=97,o$o.NUMPAD_2=98,o$o.NUMPAD_3=99,o$o.NUMPAD_4=100,o$o.NUMPAD_5=101,o$o.NUMPAD_6=102,o$o.NUMPAD_7=103,o$o.NUMPAD_8=104,o$o.NUMPAD_9=105,o$o.NUMPAD_ADD=107,o$o.NUMPAD_DECIMAL=110,o$o.NUMPAD_DIVIDE=111,o$o.NUMPAD_ENTER=108,o$o.NUMPAD_MULTIPLY=106,o$o.NUMPAD_SUBTRACT=109,o$o.SEMICOLON=186,o$o.EQUAL=187,o$o.COMMA=188,o$o.MINUS=189,o$o.PERIOD=190,o$o.SLASH=191,o$o.BACKQUOTE=192,o$o.LEFTBRACKET=219,o$o.BACKSLASH=220,o$o.RIGHTBRACKET=221,o$o.QUOTE=222,o$o.ALTERNATE=18,o$o.BACKSPACE=8,o$o.CAPS_LOCK=20,o$o.COMMAND=15,o$o.CONTROL=17,o$o.DELETE=46,o$o.ENTER=13,o$o.ESCAPE=27,o$o.PAGE_UP=33,o$o.PAGE_DOWN=34,o$o.END=35,o$o.HOME=36,o$o.LEFT=37,o$o.UP=38,o$o.RIGHT=39,o$o.DOWN=40,o$o.SHIFT=16,o$o.SPACE=32,o$o.TAB=9,o$o.INSERT=45}(),function(){function o$W(){}return o$h(o$W,"laya.events.KeyBoardManager"),o$W.__init__=function(){o$W._addEvent("keydown"),o$W._addEvent("keypress"),o$W._addEvent("keyup")},o$W._addEvent=function(o$r){o$e.document.addEventListener(o$r,function(o$o){laya.events.KeyBoardManager._dispatch(o$o,o$r)},!0)},o$W._dispatch=function(o$o,o$r){if(o$W.enabled){o$W._event._stoped=!1,o$W._event.nativeEvent=o$o,o$W._event.keyCode=o$o.keyCode||o$o.which||o$o.charCode,"keydown"===o$r?o$W._pressKeys[o$W._event.keyCode]=!0:"keyup"===o$r&&(o$W._pressKeys[o$W._event.keyCode]=null);for(var o$T=o$b.stage.focus&&null!=o$b.stage.focus.event&&o$b.stage.focus.displayedInStage?o$b.stage.focus:o$b.stage,o$k=o$T;o$k;)o$k.event(o$r,o$W._event.setTo(o$r,o$k,o$T)),o$k=o$k.parent}},o$W.hasKeyDown=function(o$o){return o$W._pressKeys[o$o]},o$W._pressKeys={},o$W.enabled=!0,o$L(o$W,["_event",function(){return this._event=new o$D}]),o$W}()),o$j=(function(){function o$o(){}o$h(o$o,"laya.events.KeyLocation"),o$o.STANDARD=0,o$o.LEFT=1,o$o.RIGHT=2,o$o.NUM_PAD=3}(),function(){function o$U(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=o$e.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new o$D,this._matrix=new o$s,this._point=new o$F,this._rect=new o$P,this._prePoint=new o$F,this._curTouchID=NaN}o$h(o$U,"laya.events.MouseManager");var o$o=o$U.prototype;return o$o.__init__=function(o$o,o$r){var o$T=this;this._stage=o$o;var o$k=this,o$W=this._eventList;o$r.oncontextmenu=function(o$o){if(o$U.enabled)return!1},o$r.addEventListener("mousedown",function(o$o){o$U.enabled&&(o$e.onIE||o$o.preventDefault(),o$W.push(o$o),o$k.mouseDownTime=o$e.now())}),o$r.addEventListener("mouseup",function(o$o){o$U.enabled&&(o$o.preventDefault(),o$W.push(o$o),o$k.mouseDownTime=-o$e.now())},!0),o$r.addEventListener("mousemove",function(o$o){if(o$U.enabled){o$o.preventDefault();var o$r=o$e.now();if(o$r-o$k._lastMoveTimer<10)return;o$k._lastMoveTimer=o$r,o$W.push(o$o)}},!0),o$r.addEventListener("mouseout",function(o$o){o$U.enabled&&o$W.push(o$o)}),o$r.addEventListener("mouseover",function(o$o){o$U.enabled&&o$W.push(o$o)}),o$r.addEventListener("touchstart",function(o$o){o$U.enabled&&(o$W.push(o$o),o$U._isFirstTouch||o$So.isInputting||o$o.preventDefault(),o$k.mouseDownTime=o$e.now())}),o$r.addEventListener("touchend",function(o$o){o$U.enabled?(o$U._isFirstTouch||o$So.isInputting||o$o.preventDefault(),o$U._isFirstTouch=!1,o$W.push(o$o),o$k.mouseDownTime=-o$e.now()):o$T._curTouchID=NaN},!0),o$r.addEventListener("touchmove",function(o$o){o$U.enabled&&(o$o.preventDefault(),o$W.push(o$o))},!0),o$r.addEventListener("touchcancel",function(o$o){o$U.enabled?(o$o.preventDefault(),o$W.push(o$o)):o$T._curTouchID=NaN},!0),o$r.addEventListener("mousewheel",function(o$o){o$U.enabled&&o$W.push(o$o)}),o$r.addEventListener("DOMMouseScroll",function(o$o){o$U.enabled&&o$W.push(o$o)})},o$o.initEvent=function(o$o,o$r){var o$T;this._event._stoped=!1,this._event.nativeEvent=o$r||o$o,this._target=null,this._point.setTo(o$o.pageX||o$o.clientX,o$o.pageY||o$o.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=o$o.identifier||0,this._tTouchID=this._event.touchId,(o$T=o$_.I._event)._stoped=!1,o$T.nativeEvent=this._event.nativeEvent,o$T.touchId=this._event.touchId},o$o.checkMouseWheel=function(o$o){this._event.delta=o$o.wheelDelta?.025*o$o.wheelDelta:-o$o.detail;for(var o$r=o$_.I.getLastOvers(),o$T=0,o$k=o$r.length;o$T<o$k;o$T++){var o$W=o$r[o$T];o$W.event("mousewheel",this._event.setTo("mousewheel",o$W,this._target))}},o$o.onMouseMove=function(o$o){o$_.I.onMouseMove(o$o,this._tTouchID)},o$o.onMouseDown=function(o$o){if(o$So.isInputting&&o$b.stage.focus&&o$b.stage.focus.focus&&!o$b.stage.focus.contains(this._target)){var o$r=o$b.stage.focus._tf||o$b.stage.focus,o$T=o$o._tf||o$o;o$T instanceof laya.display.Input&&o$T.multiline==o$r.multiline?o$r._focusOut():o$r.focus=!1}o$_.I.onMouseDown(o$o,this._tTouchID,this._isLeftMouse)},o$o.onMouseUp=function(o$o){o$_.I.onMouseUp(o$o,this._tTouchID,this._isLeftMouse)},o$o.check=function(o$o,o$r,o$T,o$k){this._point.setTo(o$r,o$T),o$o.fromParentPoint(this._point),o$r=this._point.x,o$T=this._point.y;var o$W=o$o.scrollRect;if(o$W&&(this._rect.setTo(o$W.x,o$W.y,o$W.width,o$W.height),!this._rect.contains(o$r,o$T)))return!1;if(!this.disableMouseEvent){if(o$o.hitTestPrior&&!o$o.mouseThrough&&!this.hitTest(o$o,o$r,o$T))return!1;for(var o$D=o$o._childs.length-1;-1<o$D;o$D--){var o$n=o$o._childs[o$D];if(!o$n.destroyed&&o$n.mouseEnabled&&o$n.visible&&this.check(o$n,o$r,o$T,o$k))return!0}}var o$V=!(!o$o.hitTestPrior||o$o.mouseThrough||this.disableMouseEvent)||this.hitTest(o$o,o$r,o$T);return o$V?(this._target=o$o,o$k.call(this,o$o)):o$k===this.onMouseUp&&o$o===this._stage&&(this._target=this._stage,o$k.call(this,this._target)),o$V},o$o.hitTest=function(o$o,o$r,o$T){var o$k=!1;if(o$o.scrollRect&&(o$r-=o$o.scrollRect.x,o$T-=o$o.scrollRect.y),o$o.hitArea instanceof laya.utils.HitArea)return o$o.hitArea.isHit(o$r,o$T);if(0<o$o.width&&0<o$o.height||o$o.mouseThrough||o$o.hitArea)if(o$o.mouseThrough)o$k=o$o.getGraphicBounds().contains(o$r,o$T);else{var o$W=this._rect;o$o.hitArea?o$W=o$o.hitArea:o$W.setTo(0,0,o$o.width,o$o.height),o$k=o$W.contains(o$r,o$T)}return o$k},o$o.runEvent=function(){var o$o=this._eventList.length;if(o$o){this.mouseEventTime=o$e.now();var o$r,o$T=0,o$k=0,o$W=0;try{for(;o$T<o$o;){var o$D=this._eventList[o$T];switch("mousemove"!==o$D.type&&(this._prePoint.x=this._prePoint.y=-1e6),o$D.type){case"mousedown":this._touchIDs[0]=this._id++,o$U._isTouchRespond?o$U._isTouchRespond=!1:(this._isLeftMouse=0===o$D.button,this.initEvent(o$D),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===o$D.button,this.initEvent(o$D),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-o$D.clientX)+Math.abs(this._prePoint.y-o$D.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=o$D.clientX,this._prePoint.y=o$D.clientY,this.initEvent(o$D),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":o$U._isTouchRespond=!0,this._isLeftMouse=!0;var o$n=o$D.changedTouches;for(o$k=0,o$W=o$n.length;o$k<o$W;o$k++)o$r=o$n[o$k],(o$U.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=o$r.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[o$r.identifier]=this._id++,this.initEvent(o$r,o$D),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":o$U._isTouchRespond=!0,this._isLeftMouse=!0;var o$V=o$D.changedTouches;for(o$k=0,o$W=o$V.length;o$k<o$W;o$k++)if(o$r=o$V[o$k],o$U.multiTouchEnabled||o$r.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(o$r,o$D);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var o$L=o$D.changedTouches;for(o$k=0,o$W=o$L.length;o$k<o$W;o$k++)o$r=o$L[o$k],(o$U.multiTouchEnabled||o$r.identifier==this._curTouchID)&&(this.initEvent(o$r,o$D),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(o$D);break;case"mouseout":o$_.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}o$T++}}catch(o$o){throw this._eventList.length=0,o$o}this._eventList.length=0}},o$U.enabled=!0,o$U.multiTouchEnabled=!0,o$U._isTouchRespond=!1,o$U._isFirstTouch=!0,o$L(o$U,["instance",function(){return this.instance=new o$U}]),o$U}()),o$_=function(){function o$x(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new o$D}o$h(o$x,"laya.events.TouchManager");var o$o=o$x.prototype;return o$o._clearTempArrs=function(){o$x._oldArr.length=0,o$x._newArr.length=0,o$x._tEleArr.length=0},o$o.getTouchFromArr=function(o$o,o$r){var o$T,o$k,o$W=0;for(o$T=o$r.length,o$W=0;o$W<o$T;o$W++)if((o$k=o$r[o$W]).id==o$o)return o$k;return null},o$o.removeTouchFromArr=function(o$o,o$r){var o$T=0;for(o$T=o$r.length-1;0<=o$T;o$T--)o$r[o$T].id==o$o&&o$r.splice(o$T,1)},o$o.createTouchO=function(o$o,o$r){var o$T;return(o$T=o$G.getItem("TouchData")||{}).id=o$r,o$T.tar=o$o,o$T},o$o.onMouseDown=function(o$o,o$r,o$T){var o$k,o$W,o$D,o$n;(void 0===o$T&&(o$T=!1),this.enable)&&(o$k=this.getTouchFromArr(o$r,this.preOvers),o$D=this.getEles(o$o,null,o$x._tEleArr),o$k?o$k.tar=o$o:(o$W=this.createTouchO(o$o,o$r),this.preOvers.push(o$W)),o$e.onMobile&&this.sendEvents(o$D,"mouseover",o$r),o$n=o$T?this.preDowns:this.preRightDowns,(o$k=this.getTouchFromArr(o$r,o$n))?o$k.tar=o$o:(o$W=this.createTouchO(o$o,o$r),o$n.push(o$W)),this.sendEvents(o$D,o$T?"mousedown":"rightmousedown",o$r),this._clearTempArrs())},o$o.sendEvents=function(o$o,o$r,o$T){void 0===o$T&&(o$T=0);var o$k,o$W,o$D,o$n=0;for(o$k=o$o.length,this._event._stoped=!1,o$W=o$o[0],o$n=0;o$n<o$k;o$n++){if((o$D=o$o[o$n]).destroyed)return;if(o$D.event(o$r,this._event.setTo(o$r,o$D,o$W)),this._event._stoped)break}},o$o.getEles=function(o$o,o$r,o$T){for(o$T?o$T.length=0:o$T=[];o$o&&o$o!=o$r;)o$T.push(o$o),o$o=o$o.parent;return o$T},o$o.checkMouseOutAndOverOfMove=function(o$o,o$r,o$T){if(void 0===o$T&&(o$T=0),o$r!=o$o){var o$k,o$W,o$D=0,o$n=0;if(o$r.contains(o$o))o$W=this.getEles(o$o,o$r,o$x._tEleArr),this.sendEvents(o$W,"mouseover",o$T);else if(o$o.contains(o$r))o$W=this.getEles(o$r,o$o,o$x._tEleArr),this.sendEvents(o$W,"mouseout",o$T);else{var o$V,o$L;(o$W=o$x._tEleArr).length=0,o$V=this.getEles(o$r,null,o$x._oldArr),o$L=this.getEles(o$o,null,o$x._newArr),o$n=o$V.length;var o$U=0;for(o$D=0;o$D<o$n;o$D++){if(o$k=o$V[o$D],0<=(o$U=o$L.indexOf(o$k))){o$L.splice(o$U,o$L.length-o$U);break}o$W.push(o$k)}0<o$W.length&&this.sendEvents(o$W,"mouseout",o$T),0<o$L.length&&this.sendEvents(o$L,"mouseover",o$T)}}},o$o.onMouseMove=function(o$o,o$r){var o$T,o$k;this.enable&&((o$T=this.getTouchFromArr(o$r,this.preOvers))?(this.checkMouseOutAndOverOfMove(o$o,o$T.tar),o$T.tar=o$o,o$k=this.getEles(o$o,null,o$x._tEleArr)):(o$k=this.getEles(o$o,null,o$x._tEleArr),this.sendEvents(o$k,"mouseover",o$r),this.preOvers.push(this.createTouchO(o$o,o$r))),this.sendEvents(o$k,"mousemove",o$r),this._clearTempArrs())},o$o.getLastOvers=function(){return(o$x._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,o$x._tEleArr):(o$x._tEleArr.push(o$b.stage),o$x._tEleArr)},o$o.stageMouseOut=function(){var o$o;o$o=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(o$o,"mouseout",0)},o$o.onMouseUp=function(o$o,o$r,o$T){if(void 0===o$T&&(o$T=!1),this.enable){var o$k,o$W,o$D,o$n,o$V,o$L,o$U=0,o$h=0,o$p=o$e.onMobile;if(o$W=this.getEles(o$o,null,o$x._tEleArr),this.sendEvents(o$W,o$T?"mouseup":"rightmouseup",o$r),o$L=o$T?this.preDowns:this.preRightDowns,o$k=this.getTouchFromArr(o$r,o$L)){var o$i,o$v=o$e.now();if(o$i=o$v-this._lastClickTime<300,this._lastClickTime=o$v,o$o==o$k.tar)o$V=o$W;else for(o$D=this.getEles(o$k.tar,null,o$x._oldArr),(o$V=o$x._newArr).length=0,o$h=o$D.length,o$U=0;o$U<o$h;o$U++)o$n=o$D[o$U],0<=o$W.indexOf(o$n)&&o$V.push(o$n);0<o$V.length&&this.sendEvents(o$V,o$T?"click":"rightclick",o$r),o$T&&o$i&&this.sendEvents(o$V,"doubleclick",o$r),this.removeTouchFromArr(o$r,o$L),o$k.tar=null,o$G.recover("TouchData",o$k)}else;(o$k=this.getTouchFromArr(o$r,this.preOvers))&&o$p&&((o$V=this.getEles(o$k.tar,null,o$V))&&0<o$V.length&&this.sendEvents(o$V,"mouseout",o$r),this.removeTouchFromArr(o$r,this.preOvers),o$k.tar=null,o$G.recover("TouchData",o$k)),this._clearTempArrs()}},o$x._oldArr=[],o$x._newArr=[],o$x._tEleArr=[],o$L(o$x,["I",function(){return this.I=new o$x}]),o$x}(),o$K=function(){function o$o(){this._action=null}o$h(o$o,"laya.filters.Filter");var o$r=o$o.prototype;return o$b.imps(o$r,{"laya.filters.IFilter":!0}),o$r.callNative=function(o$o){},o$x(0,o$r,"type",function(){return-1}),o$x(0,o$r,"action",function(){return this._action}),o$o.BLUR=16,o$o.COLOR=32,o$o.GLOW=8,o$o._filterStart=null,o$o._filterEnd=null,o$o._EndTarget=null,o$o._recycleScope=null,o$o._filter=null,o$o._useSrc=null,o$o._endSrc=null,o$o._useOut=null,o$o._endOut=null,o$o}(),o$y=function(){function o$o(){this.data=null}o$h(o$o,"laya.filters.ColorFilterAction");var o$r=o$o.prototype;return o$b.imps(o$r,{"laya.filters.IFilterAction":!0}),o$r.apply=function(o$o){var o$r=o$o.ctx.ctx,o$T=o$o.ctx.ctx.canvas;if(0==o$T.width||0==o$T.height)return o$T;for(var o$k,o$W=o$r.getImageData(0,0,o$T.width,o$T.height),o$D=o$W.data,o$n=0,o$V=o$D.length;o$n<o$V;o$n+=4)o$k=this.getColor(o$D[o$n],o$D[o$n+1],o$D[o$n+2],o$D[o$n+3]),0!=o$D[o$n+3]&&(o$D[o$n]=o$k[0],o$D[o$n+1]=o$k[1],o$D[o$n+2]=o$k[2],o$D[o$n+3]=o$k[3]);return o$r.putImageData(o$W,0,0),o$o},o$r.getColor=function(o$o,o$r,o$T,o$k){var o$W=[];if(this.data._mat&&this.data._alpha){var o$D=this.data._mat,o$n=this.data._alpha;o$W[0]=o$D[0]*o$o+o$D[1]*o$r+o$D[2]*o$T+o$D[3]*o$k+o$n[0],o$W[1]=o$D[4]*o$o+o$D[5]*o$r+o$D[6]*o$T+o$D[7]*o$k+o$n[1],o$W[2]=o$D[8]*o$o+o$D[9]*o$r+o$D[10]*o$T+o$D[11]*o$k+o$n[2],o$W[3]=o$D[12]*o$o+o$D[13]*o$r+o$D[14]*o$T+o$D[15]*o$k+o$n[3]}return o$W},o$o}(),o$l=(function(){function o$o(){}o$h(o$o,"laya.maths.Arith"),o$o.formatR=function(o$o){return o$o>Math.PI&&(o$o-=2*Math.PI),o$o<-Math.PI&&(o$o+=2*Math.PI),o$o},o$o.isPOT=function(o$o,o$r){return 0<o$o&&0==(o$o&o$o-1)&&0<o$r&&0==(o$r&o$r-1)},o$o.setMatToArray=function(o$o,o$r){o$o.a,o$o.b,o$o.c,o$o.d,o$o.tx,o$o.ty,o$r[0]=o$o.a,o$r[1]=o$o.b,o$r[4]=o$o.c,o$r[5]=o$o.d,o$r[12]=o$o.tx,o$r[13]=o$o.ty}}(),function(){function o$o(){this._controlPoints=[new o$F,new o$F,new o$F],this._calFun=this.getPoint2}o$h(o$o,"laya.maths.Bezier");var o$r=o$o.prototype;return o$r._switchPoint=function(o$o,o$r){var o$T=this._controlPoints.shift();o$T.setTo(o$o,o$r),this._controlPoints.push(o$T)},o$r.getPoint2=function(o$o,o$r){var o$T=this._controlPoints[0],o$k=this._controlPoints[1],o$W=this._controlPoints[2],o$D=Math.pow(1-o$o,2)*o$T.x+2*o$o*(1-o$o)*o$k.x+Math.pow(o$o,2)*o$W.x,o$n=Math.pow(1-o$o,2)*o$T.y+2*o$o*(1-o$o)*o$k.y+Math.pow(o$o,2)*o$W.y;o$r.push(o$D,o$n)},o$r.getPoint3=function(o$o,o$r){var o$T=this._controlPoints[0],o$k=this._controlPoints[1],o$W=this._controlPoints[2],o$D=this._controlPoints[3],o$n=Math.pow(1-o$o,3)*o$T.x+3*o$k.x*o$o*(1-o$o)*(1-o$o)+3*o$W.x*o$o*o$o*(1-o$o)+o$D.x*Math.pow(o$o,3),o$V=Math.pow(1-o$o,3)*o$T.y+3*o$k.y*o$o*(1-o$o)*(1-o$o)+3*o$W.y*o$o*o$o*(1-o$o)+o$D.y*Math.pow(o$o,3);o$r.push(o$n,o$V)},o$r.insertPoints=function(o$o,o$r){var o$T,o$k=NaN;for(o$T=1/(o$o=0<o$o?o$o:5),o$k=0;o$k<=1;o$k+=o$T)this._calFun(o$k,o$r)},o$r.getBezierPoints=function(o$o,o$r,o$T){void 0===o$r&&(o$r=5),void 0===o$T&&(o$T=2);var o$k,o$W,o$D=0;if((o$k=o$o.length)<2*(o$T+1))return[];switch(o$W=[],o$T){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=o$T;)this._controlPoints.push(new o$F);for(o$D=0;o$D<2*o$T;o$D+=2)this._switchPoint(o$o[o$D],o$o[o$D+1]);for(o$D=2*o$T;o$D<o$k;o$D+=2)this._switchPoint(o$o[o$D],o$o[o$D+1]),o$D/2%o$T==0&&this.insertPoints(o$r,o$W);return o$W},o$L(o$o,["I",function(){return this.I=new o$o}]),o$o}()),o$S=function(){function o$U(){}return o$h(o$U,"laya.maths.GrahamScan"),o$U.multiply=function(o$o,o$r,o$T){return(o$o.x-o$T.x)*(o$r.y-o$T.y)-(o$r.x-o$T.x)*(o$o.y-o$T.y)},o$U.dis=function(o$o,o$r){return(o$o.x-o$r.x)*(o$o.x-o$r.x)+(o$o.y-o$r.y)*(o$o.y-o$r.y)},o$U._getPoints=function(o$o,o$r,o$T){for(void 0===o$r&&(o$r=!1),o$U._mPointList||(o$U._mPointList=[]);o$U._mPointList.length<o$o;)o$U._mPointList.push(new o$F);return o$T||(o$T=[]),o$T.length=0,o$r?o$U.getFrom(o$T,o$U._mPointList,o$o):o$U.getFromR(o$T,o$U._mPointList,o$o),o$T},o$U.getFrom=function(o$o,o$r,o$T){var o$k=0;for(o$k=0;o$k<o$T;o$k++)o$o.push(o$r[o$k]);return o$o},o$U.getFromR=function(o$o,o$r,o$T){var o$k=0;for(o$k=0;o$k<o$T;o$k++)o$o.push(o$r.pop());return o$o},o$U.pListToPointList=function(o$o,o$r){void 0===o$r&&(o$r=!1);var o$T=0,o$k=o$o.length/2,o$W=o$U._getPoints(o$k,o$r,o$U._tempPointList);for(o$T=0;o$T<o$k;o$T++)o$W[o$T].setTo(o$o[o$T+o$T],o$o[o$T+o$T+1]);return o$W},o$U.pointListToPlist=function(o$o){var o$r,o$T=0,o$k=o$o.length,o$W=o$U._temPList;for(o$T=o$W.length=0;o$T<o$k;o$T++)o$r=o$o[o$T],o$W.push(o$r.x,o$r.y);return o$W},o$U.scanPList=function(o$o){return o$g.copyArray(o$o,o$U.pointListToPlist(o$U.scan(o$U.pListToPointList(o$o,!0))))},o$U.scan=function(o$o){var o$r,o$T,o$k,o$W=0,o$D=0,o$n=0,o$V=o$o.length,o$L={};for((o$T=o$U._temArr).length=0,o$W=(o$V=o$o.length)-1;0<=o$W;o$W--)o$k=(o$r=o$o[o$W]).x+"_"+o$r.y,o$L.hasOwnProperty(o$k)||(o$L[o$k]=!0,o$T.push(o$r));for(o$V=o$T.length,o$g.copyArray(o$o,o$T),o$W=1;o$W<o$V;o$W++)(o$o[o$W].y<o$o[o$n].y||o$o[o$W].y==o$o[o$n].y&&o$o[o$W].x<o$o[o$n].x)&&(o$n=o$W);for(o$r=o$o[0],o$o[0]=o$o[o$n],o$o[o$n]=o$r,o$W=1;o$W<o$V-1;o$W++){for(o$D=(o$n=o$W)+1;o$D<o$V;o$D++)(0<o$U.multiply(o$o[o$D],o$o[o$n],o$o[0])||0==o$U.multiply(o$o[o$D],o$o[o$n],o$o[0])&&o$U.dis(o$o[0],o$o[o$D])<o$U.dis(o$o[0],o$o[o$n]))&&(o$n=o$D);o$r=o$o[o$W],o$o[o$W]=o$o[o$n],o$o[o$n]=o$r}if((o$T=o$U._temArr).length=0,o$o.length<3)return o$g.copyArray(o$T,o$o);for(o$T.push(o$o[0],o$o[1],o$o[2]),o$W=3;o$W<o$V;o$W++){for(;2<=o$T.length&&0<=o$U.multiply(o$o[o$W],o$T[o$T.length-1],o$T[o$T.length-2]);)o$T.pop();o$o[o$W]&&o$T.push(o$o[o$W])}return o$T},o$U._mPointList=null,o$U._tempPointList=[],o$U._temPList=[],o$U._temArr=[],o$U}(),o$q=function(){function o$W(){}return o$h(o$W,"laya.maths.MathUtil"),o$W.subtractVector3=function(o$o,o$r,o$T){o$T[0]=o$o[0]-o$r[0],o$T[1]=o$o[1]-o$r[1],o$T[2]=o$o[2]-o$r[2]},o$W.lerp=function(o$o,o$r,o$T){return o$o*(1-o$T)+o$r*o$T},o$W.scaleVector3=function(o$o,o$r,o$T){o$T[0]=o$o[0]*o$r,o$T[1]=o$o[1]*o$r,o$T[2]=o$o[2]*o$r},o$W.lerpVector3=function(o$o,o$r,o$T,o$k){var o$W=o$o[0],o$D=o$o[1],o$n=o$o[2];o$k[0]=o$W+o$T*(o$r[0]-o$W),o$k[1]=o$D+o$T*(o$r[1]-o$D),o$k[2]=o$n+o$T*(o$r[2]-o$n)},o$W.lerpVector4=function(o$o,o$r,o$T,o$k){var o$W=o$o[0],o$D=o$o[1],o$n=o$o[2],o$V=o$o[3];o$k[0]=o$W+o$T*(o$r[0]-o$W),o$k[1]=o$D+o$T*(o$r[1]-o$D),o$k[2]=o$n+o$T*(o$r[2]-o$n),o$k[3]=o$V+o$T*(o$r[3]-o$V)},o$W.slerpQuaternionArray=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){var o$V,o$L,o$U,o$h,o$p,o$i=o$o[o$r+0],o$v=o$o[o$r+1],o$x=o$o[o$r+2],o$j=o$o[o$r+3],o$_=o$T[o$k+0],o$K=o$T[o$k+1],o$$=o$T[o$k+2],o$y=o$T[o$k+3];return(o$L=o$i*o$_+o$v*o$K+o$x*o$$+o$j*o$y)<0&&(o$L=-o$L,o$_=-o$_,o$K=-o$K,o$$=-o$$,o$y=-o$y),o$p=1e-6<1-o$L?(o$V=Math.acos(o$L),o$U=Math.sin(o$V),o$h=Math.sin((1-o$W)*o$V)/o$U,Math.sin(o$W*o$V)/o$U):(o$h=1-o$W,o$W),o$D[o$n+0]=o$h*o$i+o$p*o$_,o$D[o$n+1]=o$h*o$v+o$p*o$K,o$D[o$n+2]=o$h*o$x+o$p*o$$,o$D[o$n+3]=o$h*o$j+o$p*o$y,o$D},o$W.getRotation=function(o$o,o$r,o$T,o$k){return Math.atan2(o$k-o$r,o$T-o$o)/Math.PI*180},o$W.sortBigFirst=function(o$o,o$r){return o$o==o$r?0:o$o<o$r?1:-1},o$W.sortSmallFirst=function(o$o,o$r){return o$o==o$r?0:o$o<o$r?-1:1},o$W.sortNumBigFirst=function(o$o,o$r){return parseFloat(o$r)-parseFloat(o$o)},o$W.sortNumSmallFirst=function(o$o,o$r){return parseFloat(o$o)-parseFloat(o$r)},o$W.sortByKey=function(o$T,o$o,o$r){var o$k;return void 0===o$o&&(o$o=!1),void 0===o$r&&(o$r=!0),o$k=o$o?o$r?o$W.sortNumBigFirst:o$W.sortBigFirst:o$r?o$W.sortNumSmallFirst:o$W.sortSmallFirst,function(o$o,o$r){return o$k(o$o[o$T],o$r[o$T])}},o$W}(),o$s=function(){function o$T(o$o,o$r,o$T,o$k,o$W,o$D){this.inPool=!1,this.bTransform=!1,void 0===o$o&&(o$o=1),void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=1),void 0===o$W&&(o$W=0),void 0===o$D&&(o$D=0),this.a=o$o,this.b=o$r,this.c=o$T,this.d=o$k,this.tx=o$W,this.ty=o$D,this._checkTransform()}o$h(o$T,"laya.maths.Matrix");var o$o=o$T.prototype;return o$o.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},o$o._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},o$o.setTranslate=function(o$o,o$r){return this.tx=o$o,this.ty=o$r,this},o$o.translate=function(o$o,o$r){return this.tx+=o$o,this.ty+=o$r,this},o$o.scale=function(o$o,o$r){this.a*=o$o,this.d*=o$r,this.c*=o$o,this.b*=o$r,this.tx*=o$o,this.ty*=o$r,this.bTransform=!0},o$o.rotate=function(o$o){var o$r=Math.cos(o$o),o$T=Math.sin(o$o),o$k=this.a,o$W=this.c,o$D=this.tx;this.a=o$k*o$r-this.b*o$T,this.b=o$k*o$T+this.b*o$r,this.c=o$W*o$r-this.d*o$T,this.d=o$W*o$T+this.d*o$r,this.tx=o$D*o$r-this.ty*o$T,this.ty=o$D*o$T+this.ty*o$r,this.bTransform=!0},o$o.skew=function(o$o,o$r){var o$T=Math.tan(o$o),o$k=Math.tan(o$r),o$W=this.a,o$D=this.b;return this.a+=o$k*this.c,this.b+=o$k*this.d,this.c+=o$T*o$W,this.d+=o$T*o$D,this},o$o.invertTransformPoint=function(o$o){var o$r=this.a,o$T=this.b,o$k=this.c,o$W=this.d,o$D=this.tx,o$n=o$r*o$W-o$T*o$k,o$V=o$W/o$n,o$L=-o$T/o$n,o$U=-o$k/o$n,o$h=o$r/o$n,o$p=(o$k*this.ty-o$W*o$D)/o$n,o$i=-(o$r*this.ty-o$T*o$D)/o$n;return o$o.setTo(o$V*o$o.x+o$U*o$o.y+o$p,o$L*o$o.x+o$h*o$o.y+o$i)},o$o.transformPoint=function(o$o){return o$o.setTo(this.a*o$o.x+this.c*o$o.y+this.tx,this.b*o$o.x+this.d*o$o.y+this.ty)},o$o.transformPointN=function(o$o){return o$o.setTo(this.a*o$o.x+this.c*o$o.y,this.b*o$o.x+this.d*o$o.y)},o$o.transformPointArray=function(o$o,o$r){for(var o$T=o$o.length,o$k=0;o$k<o$T;o$k+=2){var o$W=o$o[o$k],o$D=o$o[o$k+1];o$r[o$k]=this.a*o$W+this.c*o$D+this.tx,o$r[o$k+1]=this.b*o$W+this.d*o$D+this.ty}return o$r},o$o.transformPointArrayScale=function(o$o,o$r){for(var o$T=o$o.length,o$k=0;o$k<o$T;o$k+=2){var o$W=o$o[o$k],o$D=o$o[o$k+1];o$r[o$k]=this.a*o$W+this.c*o$D,o$r[o$k+1]=this.b*o$W+this.d*o$D}return o$r},o$o.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},o$o.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},o$o.invert=function(){var o$o=this.a,o$r=this.b,o$T=this.c,o$k=this.d,o$W=this.tx,o$D=o$o*o$k-o$r*o$T;return this.a=o$k/o$D,this.b=-o$r/o$D,this.c=-o$T/o$D,this.d=o$o/o$D,this.tx=(o$T*this.ty-o$k*o$W)/o$D,this.ty=-(o$o*this.ty-o$r*o$W)/o$D,this},o$o.setTo=function(o$o,o$r,o$T,o$k,o$W,o$D){return this.a=o$o,this.b=o$r,this.c=o$T,this.d=o$k,this.tx=o$W,this.ty=o$D,this},o$o.concat=function(o$o){var o$r=this.a,o$T=this.c,o$k=this.tx;return this.a=o$r*o$o.a+this.b*o$o.c,this.b=o$r*o$o.b+this.b*o$o.d,this.c=o$T*o$o.a+this.d*o$o.c,this.d=o$T*o$o.b+this.d*o$o.d,this.tx=o$k*o$o.a+this.ty*o$o.c+o$o.tx,this.ty=o$k*o$o.b+this.ty*o$o.d+o$o.ty,this},o$o.scaleEx=function(o$o,o$r){var o$T=this.a,o$k=this.b,o$W=this.c,o$D=this.d;0!==o$k||0!==o$W?(this.a=o$o*o$T,this.b=o$o*o$k,this.c=o$r*o$W):(this.a=o$o*o$T,this.b=0*o$D,this.c=0*o$T),this.d=o$r*o$D,this.bTransform=!0},o$o.rotateEx=function(o$o){var o$r=Math.cos(o$o),o$T=Math.sin(o$o),o$k=this.a,o$W=this.b,o$D=this.c,o$n=this.d;0!==o$W||0!==o$D?(this.a=o$r*o$k+o$T*o$D,this.b=o$r*o$W+o$T*o$n,this.c=-o$T*o$k+o$r*o$D,this.d=-o$T*o$W+o$r*o$n):(this.a=o$r*o$k,this.b=o$T*o$n,this.c=-o$T*o$k,this.d=o$r*o$n),this.bTransform=!0},o$o.clone=function(){var o$o=o$T.create();return o$o.a=this.a,o$o.b=this.b,o$o.c=this.c,o$o.d=this.d,o$o.tx=this.tx,o$o.ty=this.ty,o$o.bTransform=this.bTransform,o$o},o$o.copyTo=function(o$o){return o$o.a=this.a,o$o.b=this.b,o$o.c=this.c,o$o.d=this.d,o$o.tx=this.tx,o$o.ty=this.ty,o$o.bTransform=this.bTransform,o$o},o$o.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},o$o.destroy=function(){if(!this.inPool){var o$o=o$T._cache;this.inPool=!0,o$o._length||(o$o._length=0),(o$o[o$o._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},o$T.mul=function(o$o,o$r,o$T){var o$k=o$o.a,o$W=o$o.b,o$D=o$o.c,o$n=o$o.d,o$V=o$o.tx,o$L=o$o.ty,o$U=o$r.a,o$h=o$r.b,o$p=o$r.c,o$i=o$r.d,o$v=o$r.tx,o$x=o$r.ty;return 0!==o$h||0!==o$p?(o$T.a=o$k*o$U+o$W*o$p,o$T.b=o$k*o$h+o$W*o$i,o$T.c=o$D*o$U+o$n*o$p,o$T.d=o$D*o$h+o$n*o$i,o$T.tx=o$U*o$V+o$p*o$L+o$v,o$T.ty=o$h*o$V+o$i*o$L+o$x):(o$T.a=o$k*o$U,o$T.b=o$W*o$i,o$T.c=o$D*o$U,o$T.d=o$n*o$i,o$T.tx=o$U*o$V+o$v,o$T.ty=o$i*o$L+o$x),o$T},o$T.mul16=function(o$o,o$r,o$T){var o$k=o$o.a,o$W=o$o.b,o$D=o$o.c,o$n=o$o.d,o$V=o$o.tx,o$L=o$o.ty,o$U=o$r.a,o$h=o$r.b,o$p=o$r.c,o$i=o$r.d,o$v=o$r.tx,o$x=o$r.ty;return 0!==o$h||0!==o$p?(o$T[0]=o$k*o$U+o$W*o$p,o$T[1]=o$k*o$h+o$W*o$i,o$T[4]=o$D*o$U+o$n*o$p,o$T[5]=o$D*o$h+o$n*o$i,o$T[12]=o$U*o$V+o$p*o$L+o$v,o$T[13]=o$h*o$V+o$i*o$L+o$x):(o$T[0]=o$k*o$U,o$T[1]=o$W*o$i,o$T[4]=o$D*o$U,o$T[5]=o$n*o$i,o$T[12]=o$U*o$V+o$v,o$T[13]=o$i*o$L+o$x),o$T},o$T.mulPre=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){var o$L=o$o.a,o$U=o$o.b,o$h=o$o.c,o$p=o$o.d,o$i=o$o.tx,o$v=o$o.ty;return 0!==o$T||0!==o$k?(o$V.a=o$L*o$r+o$U*o$k,o$V.b=o$L*o$T+o$U*o$W,o$V.c=o$h*o$r+o$p*o$k,o$V.d=o$h*o$T+o$p*o$W,o$V.tx=o$r*o$i+o$k*o$v+o$D,o$V.ty=o$T*o$i+o$W*o$v+o$n):(o$V.a=o$L*o$r,o$V.b=o$U*o$W,o$V.c=o$h*o$r,o$V.d=o$p*o$W,o$V.tx=o$r*o$i+o$D,o$V.ty=o$W*o$v+o$n),o$V},o$T.mulPos=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){var o$L=o$o.a,o$U=o$o.b,o$h=o$o.c,o$p=o$o.d,o$i=o$o.tx,o$v=o$o.ty;return 0!==o$U||0!==o$h?(o$V.a=o$r*o$L+o$T*o$h,o$V.b=o$r*o$U+o$T*o$p,o$V.c=o$k*o$L+o$W*o$h,o$V.d=o$k*o$U+o$W*o$p,o$V.tx=o$L*o$D+o$h*o$n+o$i,o$V.ty=o$U*o$D+o$p*o$n+o$v):(o$V.a=o$r*o$L,o$V.b=o$T*o$p,o$V.c=o$k*o$L,o$V.d=o$W*o$p,o$V.tx=o$L*o$D+o$i,o$V.ty=o$p*o$n+o$v),o$V},o$T.preMul=function(o$o,o$r,o$T){var o$k=o$o.a,o$W=o$o.b,o$D=o$o.c,o$n=o$o.d,o$V=o$r.a,o$L=o$r.b,o$U=o$r.c,o$h=o$r.d,o$p=o$r.tx,o$i=o$r.ty;return o$T.a=o$V*o$k,o$T.b=o$T.c=0,o$T.d=o$h*o$n,o$T.tx=o$p*o$k+o$o.tx,o$T.ty=o$i*o$n+o$o.ty,0===o$L&&0===o$U&&0===o$W&&0===o$D||(o$T.a+=o$L*o$D,o$T.d+=o$U*o$W,o$T.b+=o$V*o$W+o$L*o$n,o$T.c+=o$U*o$k+o$h*o$D,o$T.tx+=o$i*o$D,o$T.ty+=o$p*o$W),o$T},o$T.preMulXY=function(o$o,o$r,o$T,o$k){var o$W=o$o.a,o$D=o$o.b,o$n=o$o.c,o$V=o$o.d;return o$k.a=o$W,o$k.b=o$D,o$k.c=o$n,o$k.d=o$V,o$k.tx=o$r*o$W+o$o.tx+o$T*o$n,o$k.ty=o$T*o$V+o$o.ty+o$r*o$D,o$k},o$T.create=function(){var o$o=o$T._cache,o$r=o$o._length?o$o[--o$o._length]:new o$T;return o$r.inPool=!1,o$r},o$T.EMPTY=new o$T,o$T.TEMP=new o$T,o$T._cache=[],o$T}(),o$F=function(){function o$o(o$o,o$r){void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),this.x=o$o,this.y=o$r}o$h(o$o,"laya.maths.Point");var o$r=o$o.prototype;return o$r.setTo=function(o$o,o$r){return this.x=o$o,this.y=o$r,this},o$r.distance=function(o$o,o$r){return Math.sqrt((this.x-o$o)*(this.x-o$o)+(this.y-o$r)*(this.y-o$r))},o$r.toString=function(){return this.x+","+this.y},o$r.normalize=function(){var o$o=Math.sqrt(this.x*this.x+this.y*this.y);if(0<o$o){var o$r=1/o$o;this.x*=o$r,this.y*=o$r}},o$o.TEMP=new o$o,o$o.EMPTY=new o$o,o$o}(),o$P=function(){function o$U(o$o,o$r,o$T,o$k){void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=0),this.x=o$o,this.y=o$r,this.width=o$T,this.height=o$k}o$h(o$U,"laya.maths.Rectangle");var o$o=o$U.prototype;return o$o.setTo=function(o$o,o$r,o$T,o$k){return this.x=o$o,this.y=o$r,this.width=o$T,this.height=o$k,this},o$o.copyFrom=function(o$o){return this.x=o$o.x,this.y=o$o.y,this.width=o$o.width,this.height=o$o.height,this},o$o.contains=function(o$o,o$r){return!(this.width<=0||this.height<=0)&&(o$o>=this.x&&o$o<this.right&&o$r>=this.y&&o$r<this.bottom)},o$o.intersects=function(o$o){return!(o$o.x>this.x+this.width||o$o.x+o$o.width<this.x||o$o.y>this.y+this.height||o$o.y+o$o.height<this.y)},o$o.intersection=function(o$o,o$r){return this.intersects(o$o)?(o$r||(o$r=new o$U),o$r.x=Math.max(this.x,o$o.x),o$r.y=Math.max(this.y,o$o.y),o$r.width=Math.min(this.right,o$o.right)-o$r.x,o$r.height=Math.min(this.bottom,o$o.bottom)-o$r.y,o$r):null},o$o.union=function(o$o,o$r){return o$r||(o$r=new o$U),this.clone(o$r),o$o.width<=0||o$o.height<=0?o$r:(o$r.addPoint(o$o.x,o$o.y),o$r.addPoint(o$o.right,o$o.bottom),this)},o$o.clone=function(o$o){return o$o||(o$o=new o$U),o$o.x=this.x,o$o.y=this.y,o$o.width=this.width,o$o.height=this.height,o$o},o$o.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},o$o.equals=function(o$o){return!(!o$o||o$o.x!==this.x||o$o.y!==this.y||o$o.width!==this.width||o$o.height!==this.height)},o$o.addPoint=function(o$o,o$r){return this.x>o$o&&(this.width+=this.x-o$o,this.x=o$o),this.y>o$r&&(this.height+=this.y-o$r,this.y=o$r),this.width<o$o-this.x&&(this.width=o$o-this.x),this.height<o$r-this.y&&(this.height=o$r-this.y),this},o$o._getBoundPoints=function(){var o$o=o$U._temB;return(o$o.length=0)==this.width||0==this.height||o$o.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),o$o},o$o.isEmpty=function(){return this.width<=0||this.height<=0},o$x(0,o$o,"right",function(){return this.x+this.width}),o$x(0,o$o,"bottom",function(){return this.y+this.height}),o$U._getBoundPointS=function(o$o,o$r,o$T,o$k){var o$W=o$U._temA;return(o$W.length=0)==o$T||0==o$k||o$W.push(o$o,o$r,o$o+o$T,o$r,o$o,o$r+o$k,o$o+o$T,o$r+o$k),o$W},o$U._getWrapRec=function(o$o,o$r){if(!o$o||o$o.length<1)return o$r?o$r.setTo(0,0,0,0):o$U.TEMP.setTo(0,0,0,0);o$r=o$r||new o$U;var o$T,o$k,o$W,o$D,o$n,o$V=o$o.length,o$L=o$F.TEMP;for(o$W=o$n=-(o$k=o$D=99999),o$T=0;o$T<o$V;o$T+=2)o$L.x=o$o[o$T],o$L.y=o$o[o$T+1],o$k=o$k<o$L.x?o$k:o$L.x,o$D=o$D<o$L.y?o$D:o$L.y,o$W=o$W>o$L.x?o$W:o$L.x,o$n=o$n>o$L.y?o$n:o$L.y;return o$r.setTo(o$k,o$D,o$W-o$k,o$n-o$D)},o$U.EMPTY=new o$U,o$U.TEMP=new o$U,o$U._temB=[],o$U._temA=[],o$U}(),o$R=function(){function o$L(){}return o$h(o$L,"laya.media.SoundManager"),o$x(1,o$L,"useAudioMusic",function(){return o$L._useAudioMusic},function(o$o){o$L._useAudioMusic=o$o,o$L._musicClass=o$o?o$To:null}),o$x(1,o$L,"autoStopMusic",function(){return o$L._autoStopMusic},function(o$o){o$b.stage.off("blur",null,o$L._stageOnBlur),o$b.stage.off("focus",null,o$L._stageOnFocus),o$b.stage.off("visibilitychange",null,o$L._visibilityChange),(o$L._autoStopMusic=o$o)&&(o$b.stage.on("blur",null,o$L._stageOnBlur),o$b.stage.on("focus",null,o$L._stageOnFocus),o$b.stage.on("visibilitychange",null,o$L._visibilityChange))}),o$x(1,o$L,"muted",function(){return o$L._muted},function(o$o){o$o!=o$L._muted&&(o$o&&o$L.stopAllSound(),o$L.musicMuted=o$o,o$L._muted=o$o)}),o$x(1,o$L,"musicMuted",function(){return o$L._musicMuted},function(o$o){o$o!=o$L._musicMuted&&(o$o?(o$L._tMusic&&o$L._musicChannel&&!o$L._musicChannel.isStopped?o$L._musicChannel.pause():o$L._musicChannel=null,o$L._musicMuted=o$o):(o$L._musicMuted=o$o,o$L._tMusic&&o$L._musicChannel&&o$L._musicChannel.resume()))}),o$x(1,o$L,"soundMuted",function(){return o$L._soundMuted},function(o$o){o$L._soundMuted=o$o}),o$L.addChannel=function(o$o){0<=o$L._channels.indexOf(o$o)||(o$L._channels.push(o$o),o$L.autoReleaseSound&&0!=o$L._notUsedCount&&o$L._notUsedUrls[o$o.url]&&(delete o$L._notUsedUrls[o$o.url],0==--o$L._notUsedCount&&o$b.timer.clear(o$L,o$L.disposeSoundIfNotUsed)))},o$L.removeChannel=function(o$o){var o$r=o$L._channels,o$T=o$r.indexOf(o$o);if(-1!=o$T&&(o$r.splice(o$T,1),o$L.autoReleaseSound)){var o$k=o$o.url,o$W=o$L.defaultIntervals[o$k]||2e4;if(0<o$W){var o$D=!0;for(o$T=o$r.length-1;0<=o$T;o$T--)if(o$r[o$T].url==o$k){o$D=!1;break}o$D&&(o$L._notUsedUrls[o$k]=Date.now()+o$W,0==o$L._notUsedCount++&&o$b.timer.loop(1e4,o$L,o$L.disposeSoundIfNotUsed))}}},o$L.disposeSoundIfNotUsed=function(){var o$o=o$L._notUsedUrls;if(0!=o$L._notUsedCount){var o$r=Date.now();for(var o$T in o$o)o$r>=o$o[o$T]&&(delete o$o[o$T],--o$L._notUsedCount,o$L.destroySound(o$T));if(0!=o$L._notUsedCount)return}o$b.timer.clear(o$L,o$L.disposeSoundIfNotUsed)},o$L._visibilityChange=function(){o$b.stage.isVisibility?o$L._stageOnFocus():o$L._stageOnBlur()},o$L._stageOnBlur=function(){o$L._isActive=!1,o$L._musicChannel&&(o$L._musicChannel.isStopped||(o$L._blurPaused=!0,o$L._musicChannel.pause())),o$L.stopAllSound(),o$b.stage.once("mousedown",null,o$L._stageOnFocus)},o$L._recoverWebAudio=function(){o$Do.ctx&&"running"!=o$Do.ctx.state&&o$Do.ctx.resume&&o$Do.ctx.resume()},o$L._stageOnFocus=function(){if(o$L._isActive=!0,o$L._recoverWebAudio(),o$b.stage.off("mousedown",null,o$L._stageOnFocus),o$L._blurPaused){var o$o=o$L._musicChannel;o$o&&o$L._music&&o$o.isStopped&&(o$L._blurPaused=!1,o$L._music._disposed?o$L.playMusic(o$o.url,o$o.loops,o$o.startHandler,o$o.completeHandler,o$o.startTime):o$o.audioBuffer?o$o.resume():o$L._music.play(o$o.startTime,o$o.loops,o$o.startHandler,o$o))}},o$L.playSound=function(o$o,o$r,o$T,o$k,o$W,o$D){if(void 0===o$r&&(o$r=1),void 0===o$D&&(o$D=0),!o$o)return null;if(o$L._muted)return null;if(o$L._recoverWebAudio(),o$o==o$L._tMusic){if(o$L._musicMuted)return null}else{if(!o$L._isActive)return null;if(o$L._soundMuted)return null}var o$n,o$V=o$L._pool[o$o];return o$W||(o$W=o$L._soundClass),o$V||((o$V=new o$W).load(o$o),o$L._pool[o$o]=o$V),(o$n=o$V.play(o$D,o$r,o$T))?(o$o==o$L._tMusic&&(o$L._music=o$V,o$L._isActive||(o$L._blurPaused=!0,o$n.pause())),o$n.url=o$o,o$n.volume=o$o==o$L._tMusic?o$L.musicVolume:o$L.soundVolume,o$n.completeHandler=o$k,o$n):null},o$L.destroySound=function(o$o){var o$r=o$L._pool[o$o];o$r&&(delete o$L._pool[o$o],o$r.dispose())},o$L.playMusic=function(o$o,o$r,o$T,o$k,o$W){return void 0===o$r&&(o$r=0),void 0===o$W&&(o$W=0),o$L._tMusic=o$o,o$L._musicChannel&&o$L._musicChannel.stop(),o$L._musicChannel=o$L.playSound(o$o,o$r,o$T,o$k,null,o$W)},o$L.stopSound=function(o$o){for(var o$r,o$T=o$L._channels.length-1;0<=o$T;o$T--)(o$r=o$L._channels[o$T]).url==o$o&&o$r.stop()},o$L.stopAll=function(){o$L._tMusic=null;var o$o=0;for(o$o=o$L._channels.length-1;0<=o$o;o$o--)o$L._channels[o$o].stop()},o$L.stopAllSound=function(){var o$o,o$r=0;for(o$r=o$L._channels.length-1;0<=o$r;o$r--)(o$o=o$L._channels[o$r]).url!=o$L._tMusic&&o$o.stop()},o$L.stopMusic=function(){o$L._musicChannel&&o$L._musicChannel.stop(),o$L._tMusic=null},o$L.setSoundVolume=function(o$o,o$r){if(o$r)o$L._setVolume(o$r,o$o);else{o$L.soundVolume=o$o;var o$T,o$k=0;for(o$k=o$L._channels.length-1;0<=o$k;o$k--)(o$T=o$L._channels[o$k]).url!=o$L._tMusic&&(o$T.volume=o$o)}},o$L.setMusicVolume=function(o$o){o$L.musicVolume=o$o,o$L._setVolume(o$L._tMusic,o$o)},o$L._setVolume=function(o$o,o$r){for(var o$T,o$k=o$L._channels.length-1;0<=o$k;o$k--)(o$T=o$L._channels[o$k]).url==o$o&&(o$T.volume=o$r)},o$L.musicVolume=1,o$L.soundVolume=1,o$L.playbackRate=1,o$L._useAudioMusic=!0,o$L._muted=!1,o$L._soundMuted=!1,o$L._musicMuted=!1,o$L._tMusic=null,o$L._musicChannel=null,o$L._music=null,o$L._channels=[],o$L._autoStopMusic=!1,o$L._blurPaused=!1,o$L._isActive=!0,o$L._soundClass=null,o$L._musicClass=null,o$L.autoReleaseSound=!0,o$L._pool={},o$L.defaultIntervals={},o$L._notUsedUrls={},o$L._notUsedCount=0,o$L}(),o$t=function(){var o$o;function o$T(){}return o$h(o$T,"laya.net.LocalStorage"),o$T.__init__=function(){o$T._baseClass||(o$T._baseClass=o$o).init(),o$T.items=o$T._baseClass.items,o$T.support=o$T._baseClass.support},o$T.setItem=function(o$o,o$r){o$T._baseClass.setItem(o$o,o$r)},o$T.getItem=function(o$o){return o$T._baseClass.getItem(o$o)},o$T.setJSON=function(o$o,o$r){o$T._baseClass.setJSON(o$o,o$r)},o$T.getJSON=function(o$o){return o$T._baseClass.getJSON(o$o)},o$T.removeItem=function(o$o){o$T._baseClass.removeItem(o$o)},o$T.clear=function(){o$T._baseClass.clear()},o$T._baseClass=null,o$T.items=null,o$T.support=!1,o$T.__init$=function(){o$o=function(){function o$T(){}return o$h(o$T,""),o$T.init=function(){try{o$T.support=!0,o$T.items=o$n.localStorage,o$T.setItem("laya","1"),o$T.removeItem("laya")}catch(o$o){o$T.support=!1}o$T.support||console.log("LocalStorage is not supprot or browser is private mode.")},o$T.setItem=function(o$o,o$r){try{o$T.support&&o$T.items.setItem(o$o,o$r)}catch(o$o){console.warn("set localStorage failed",o$o)}},o$T.getItem=function(o$o){return o$T.support?o$T.items.getItem(o$o):null},o$T.setJSON=function(o$o,o$r){try{o$T.support&&o$T.items.setItem(o$o,JSON.stringify(o$r))}catch(o$o){console.warn("set localStorage failed",o$o)}},o$T.getJSON=function(o$o){return JSON.parse(o$T.support?o$T.items.getItem(o$o):null)},o$T.removeItem=function(o$o){o$T.support&&o$T.items.removeItem(o$o)},o$T.clear=function(){o$T.support&&o$T.items.clear()},o$T.items=null,o$T.support=!1,o$T}()},o$T}(),o$z=(function(){function o$k(){}o$h(o$k,"laya.net.ResourceVersion"),o$k.enable=function(o$o,o$r,o$T){void 0===o$T&&(o$T=2),laya.net.ResourceVersion.type=o$T,o$b.loader.load(o$o,o$$.create(null,o$k.onManifestLoaded,[o$r]),null,"json"),o$m.customFormat=o$k.addVersionPrefix},o$k.onManifestLoaded=function(o$o,o$r){o$k.manifest=o$r,o$o.run(),o$r||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},o$k.addVersionPrefix=function(o$o){return o$k.manifest&&o$k.manifest[o$o]?2==o$k.type?o$k.manifest[o$o]:o$k.manifest[o$o]+"/"+o$o:o$o},o$k.FOLDER_VERSION=1,o$k.FILENAME_VERSION=2,o$k.manifest=null,o$k.type=1}(),function(){function o$o(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}o$h(o$o,"laya.net.TTFLoader");var o$r=o$o.prototype;return o$r.load=function(o$o){var o$r=(this._url=o$o).split(".ttf")[0].split("/");this.fontName=o$r[o$r.length-1],o$e.window.conch?this._loadConch():o$e.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},o$r._loadConch=function(){this._http=new o$no,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},o$r._onHttpLoaded=function(o$o){o$e.window.conch.setFontFaceFromBuffer(this.fontName,o$o),this._clearHttp(),this._complete()},o$r._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},o$r._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},o$r._complete=function(){o$b.timer.clear(this,this._complete),o$b.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},o$r._checkComplete=function(){o$u.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},o$r._loadWithFontFace=function(){var o$o=new o$e.window.FontFace(this.fontName,"url('"+this._url+"')");o$e.window.document.fonts.add(o$o);var o$r=this;o$o.loaded.then(function(){o$r._complete()}),o$o.load()},o$r._createDiv=function(){this._div=o$e.createElement("div"),this._div.innerHTML="laya";var o$o=this._div.style;o$o.fontFamily=this.fontName,o$o.position="absolute",o$o.left="-100px",o$o.top="-100px",o$e.document.body.appendChild(this._div)},o$r._loadWithCSS=function(){var o$o=this,o$r=o$e.createElement("style");o$r.type="text/css",o$e.document.body.appendChild(o$r),o$r.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=o$u.measureText("LayaTTFFont",this._fontTxt).width;var o$T=this;o$r.onload=function(){o$b.timer.once(1e4,o$T,o$o._complete)},o$b.timer.loop(20,this,this._checkComplete),this._createDiv()},o$o._testString="LayaTTFFont",o$o}()),o$m=function(){function o$k(o$o){this._url=null,this._path=null,this._url=o$k.formatURL(o$o),this._path=o$k.getPath(o$o)}o$h(o$k,"laya.net.URL");var o$o=o$k.prototype;return o$x(0,o$o,"path",function(){return this._path}),o$x(0,o$o,"url",function(){return this._url}),o$k.formatURL=function(o$o,o$r){if(!o$o)return"null path";if(0<o$o.indexOf(":"))return o$o;null!=o$k.customFormat&&(o$o=o$k.customFormat(o$o,o$r));var o$T=o$o.charAt(0);if("."===o$T)return o$k.formatRelativePath((o$r||o$k.basePath)+o$o);if("~"===o$T)return o$k.rootPath+o$o.substring(1);if("d"===o$T){if(0===o$o.indexOf("data:image"))return o$o}else if("/"===o$T)return o$o;return(o$r||o$k.basePath)+o$o},o$k.formatRelativePath=function(o$o){for(var o$r=o$o.split("/"),o$T=0,o$k=o$r.length;o$T<o$k;o$T++)".."==o$r[o$T]&&(o$r.splice(o$T-1,2),o$T-=2);return o$r.join("/")},o$k.isAbsolute=function(o$o){return 0<o$o.indexOf(":")||"/"==o$o.charAt(0)},o$k.getPath=function(o$o){var o$r=o$o.lastIndexOf("/");return 0<o$r?o$o.substr(0,o$r+1):""},o$k.getFileName=function(o$o){var o$r=o$o.lastIndexOf("/");return 0<o$r?o$o.substr(o$r+1):o$o},o$k.version={},o$k.basePath="",o$k.rootPath="",o$k.customFormat=function(o$o){var o$r=o$k.version[o$o];return!o$C.isConchApp&&o$r&&(o$o+="?v="+o$r),o$o},o$k}(),o$C=function(){function o$W(o$o,o$r){this._timeId=0;var o$T=o$W._mainCanvas.source.style;o$T.position="absolute",o$T.top=o$T.left="0px",o$T.background="#000000",o$W._mainCanvas.source.id="layaCanvas";var o$k=laya.renders.Render.isWebGL;o$W._mainCanvas.source.width=o$o,o$W._mainCanvas.source.height=o$r,o$k&&o$W.WebGL.init(o$W._mainCanvas,o$o,o$r),o$e.container.appendChild(o$W._mainCanvas.source),(o$W._context=new o$X(o$o,o$r,o$k?null:o$W._mainCanvas)).ctx.setIsMainContext(),o$e.window.requestAnimationFrame(function o$o(o$r){o$e.window.requestAnimationFrame(o$o);o$b.stage._loop()}),o$b.stage.on("visibilitychange",this,this._onVisibilitychange)}o$h(o$W,"laya.renders.Render");var o$o=o$W.prototype;return o$o._onVisibilitychange=function(){o$b.stage.isVisibility?0!=this._timeId&&o$e.window.clearInterval(this._timeId):this._timeId=o$e.window.setInterval(this._enterFrame,1e3)},o$o._enterFrame=function(o$o){o$b.stage._loop()},o$x(1,o$W,"context",function(){return o$W._context}),o$x(1,o$W,"canvas",function(){return o$W._mainCanvas.source}),o$W._context=null,o$W._mainCanvas=null,o$W.WebGL=null,o$W.isConchNode=!1,o$W.isConchApp=!1,o$W.isConchWebGL=!1,o$W.isWebGL=!1,o$W.is3DMode=!1,o$W.optimizeTextureMemory=function(o$o,o$r){return!0},o$W.__init$=function(){o$n.ConchRenderType=o$n.ConchRenderType||1,o$n.ConchRenderType|=o$n.conch?4:0,o$W.isConchNode=5==(5&o$n.ConchRenderType),o$W.isConchApp=4==(4&o$n.ConchRenderType),o$W.isConchWebGL=6==o$n.ConchRenderType},o$W}(),o$X=function(){function o$n(o$o,o$r,o$T){this.x=0,this.y=0,this._drawTexture=function(o$o,o$r,o$T){o$T[0].loaded&&this.ctx.drawTexture(o$T[0],o$T[1],o$T[2],o$T[3],o$T[4],o$o,o$r)},this._fillTexture=function(o$o,o$r,o$T){o$T[0].loaded&&this.ctx.fillTexture(o$T[0],o$T[1]+o$o,o$T[2]+o$r,o$T[3],o$T[4],o$T[5],o$T[6],o$T[7])},this._drawTextureWithTransform=function(o$o,o$r,o$T){o$T[0].loaded&&this.ctx.drawTextureWithTransform(o$T[0],o$T[1],o$T[2],o$T[3],o$T[4],o$T[5],o$o,o$r,o$T[6])},this._fillQuadrangle=function(o$o,o$r,o$T){this.ctx.fillQuadrangle(o$T[0],o$T[1],o$T[2],o$T[3],o$T[4])},this._drawRect=function(o$o,o$r,o$T){var o$k=this.ctx;null!=o$T[4]&&(o$k.fillStyle=o$T[4],o$k.fillRect(o$o+o$T[0],o$r+o$T[1],o$T[2],o$T[3],null)),null!=o$T[5]&&(o$k.strokeStyle=o$T[5],o$k.lineWidth=o$T[6],o$k.strokeRect(o$o+o$T[0],o$r+o$T[1],o$T[2],o$T[3],o$T[6]))},this._drawPie=function(o$o,o$r,o$T){var o$k=this.ctx;o$C.isWebGL&&o$k.setPathId(o$T[8]),o$k.beginPath(),o$C.isWebGL?(o$k.movePath(o$T[0]+o$o,o$T[1]+o$r),o$k.moveTo(0,0)):o$k.moveTo(o$o+o$T[0],o$r+o$T[1]),o$k.arc(o$o+o$T[0],o$r+o$T[1],o$T[2],o$T[3],o$T[4]),o$k.closePath(),this._fillAndStroke(o$T[5],o$T[6],o$T[7],!0)},this._clipRect=function(o$o,o$r,o$T){this.ctx.clipRect(o$o+o$T[0],o$r+o$T[1],o$T[2],o$T[3])},this._fillRect=function(o$o,o$r,o$T){this.ctx.fillRect(o$o+o$T[0],o$r+o$T[1],o$T[2],o$T[3],o$T[4])},this._drawCircle=function(o$o,o$r,o$T){var o$k=this.ctx;o$C.isWebGL&&o$k.setPathId(o$T[6]),o$w.drawCall++,o$k.beginPath(),o$C.isWebGL&&o$k.movePath(o$T[0]+o$o,o$T[1]+o$r),o$k.arc(o$T[0]+o$o,o$T[1]+o$r,o$T[2],0,o$n.PI2),o$k.closePath(),this._fillAndStroke(o$T[3],o$T[4],o$T[5],!0)},this._fillCircle=function(o$o,o$r,o$T){o$w.drawCall++;var o$k=this.ctx;o$k.beginPath(),o$k.fillStyle=o$T[3],o$k.arc(o$T[0]+o$o,o$T[1]+o$r,o$T[2],0,o$n.PI2),o$k.fill()},this._setShader=function(o$o,o$r,o$T){this.ctx.setShader(o$T[0])},this._drawLine=function(o$o,o$r,o$T){var o$k=this.ctx;o$C.isWebGL&&o$k.setPathId(o$T[6]),o$k.beginPath(),o$k.strokeStyle=o$T[4],o$k.lineWidth=o$T[5],o$C.isWebGL?(o$k.movePath(o$o,o$r),o$k.moveTo(o$T[0],o$T[1]),o$k.lineTo(o$T[2],o$T[3])):(o$k.moveTo(o$o+o$T[0],o$r+o$T[1]),o$k.lineTo(o$o+o$T[2],o$r+o$T[3])),o$k.stroke()},this._drawLines=function(o$o,o$r,o$T){var o$k=this.ctx;o$C.isWebGL&&o$k.setPathId(o$T[5]),o$k.beginPath(),o$o+=o$T[0],o$r+=o$T[1],o$C.isWebGL&&o$k.movePath(o$o,o$r),o$k.strokeStyle=o$T[3],o$k.lineWidth=o$T[4];var o$W=o$T[2],o$D=2,o$n=o$W.length;if(o$C.isWebGL)for(o$k.moveTo(o$W[0],o$W[1]);o$D<o$n;)o$k.lineTo(o$W[o$D++],o$W[o$D++]);else for(o$k.moveTo(o$o+o$W[0],o$r+o$W[1]);o$D<o$n;)o$k.lineTo(o$o+o$W[o$D++],o$r+o$W[o$D++]);o$k.stroke()},this._drawLinesWebGL=function(o$o,o$r,o$T){this.ctx.drawLines(o$o+this.x+o$T[0],o$r+this.y+o$T[1],o$T[2],o$T[3],o$T[4])},this._drawCurves=function(o$o,o$r,o$T){this.ctx.drawCurves(o$o,o$r,o$T)},this._draw=function(o$o,o$r,o$T){o$T[0].call(null,this,o$o,o$r)},this._transformByMatrix=function(o$o,o$r,o$T){this.ctx.transformByMatrix(o$T[0])},this._setTransform=function(o$o,o$r,o$T){this.ctx.setTransform(o$T[0],o$T[1],o$T[2],o$T[3],o$T[4],o$T[5])},this._setTransformByMatrix=function(o$o,o$r,o$T){this.ctx.setTransformByMatrix(o$T[0])},this._save=function(o$o,o$r,o$T){this.ctx.save()},this._restore=function(o$o,o$r,o$T){this.ctx.restore()},this._translate=function(o$o,o$r,o$T){this.ctx.translate(o$T[0],o$T[1])},this._transform=function(o$o,o$r,o$T){this.ctx.translate(o$T[1]+o$o,o$T[2]+o$r);var o$k=o$T[0];this.ctx.transform(o$k.a,o$k.b,o$k.c,o$k.d,o$k.tx,o$k.ty),this.ctx.translate(-o$o-o$T[1],-o$r-o$T[2])},this._rotate=function(o$o,o$r,o$T){this.ctx.translate(o$T[1]+o$o,o$T[2]+o$r),this.ctx.rotate(o$T[0]),this.ctx.translate(-o$o-o$T[1],-o$r-o$T[2])},this._scale=function(o$o,o$r,o$T){this.ctx.translate(o$T[2]+o$o,o$T[3]+o$r),this.ctx.scale(o$T[0],o$T[1]),this.ctx.translate(-o$o-o$T[2],-o$r-o$T[3])},this._alpha=function(o$o,o$r,o$T){this.ctx.globalAlpha*=o$T[0]},this._setAlpha=function(o$o,o$r,o$T){this.ctx.globalAlpha=o$T[0]},this._fillText=function(o$o,o$r,o$T){this.ctx.fillText(o$T[0],o$T[1]+o$o,o$T[2]+o$r,o$T[3],o$T[4],o$T[5])},this._strokeText=function(o$o,o$r,o$T){this.ctx.strokeText(o$T[0],o$T[1]+o$o,o$T[2]+o$r,o$T[3],o$T[4],o$T[5],o$T[6])},this._fillBorderText=function(o$o,o$r,o$T){this.ctx.fillBorderText(o$T[0],o$T[1]+o$o,o$T[2]+o$r,o$T[3],o$T[4],o$T[5],o$T[6],o$T[7])},this._blendMode=function(o$o,o$r,o$T){this.ctx.globalCompositeOperation=o$T[0]},this._beginClip=function(o$o,o$r,o$T){this.ctx.beginClip&&this.ctx.beginClip(o$o+o$T[0],o$r+o$T[1],o$T[2],o$T[3])},this._setIBVB=function(o$o,o$r,o$T){this.ctx.setIBVB(o$T[0]+o$o,o$T[1]+o$r,o$T[2],o$T[3],o$T[4],o$T[5],o$T[6],o$T[7])},this._fillTrangles=function(o$o,o$r,o$T){this.ctx.fillTrangles(o$T[0],o$T[1]+o$o,o$T[2]+o$r,o$T[3],o$T[4])},this._drawPath=function(o$o,o$r,o$T){var o$k=this.ctx;o$C.isWebGL&&o$k.setPathId(-1),o$k.beginPath(),o$o+=o$T[0],o$r+=o$T[1],o$C.isWebGL&&o$k.movePath(o$o,o$r);for(var o$W=o$T[2],o$D=0,o$n=o$W.length;o$D<o$n;o$D++){var o$V=o$W[o$D];switch(o$V[0]){case"moveTo":o$C.isWebGL?o$k.moveTo(o$V[1],o$V[2]):o$k.moveTo(o$o+o$V[1],o$r+o$V[2]);break;case"lineTo":o$C.isWebGL?o$k.lineTo(o$V[1],o$V[2]):o$k.lineTo(o$o+o$V[1],o$r+o$V[2]);break;case"arcTo":o$C.isWebGL?o$k.arcTo(o$V[1],o$V[2],o$V[3],o$V[4],o$V[5]):o$k.arcTo(o$o+o$V[1],o$r+o$V[2],o$o+o$V[3],o$r+o$V[4],o$V[5]);break;case"closePath":o$k.closePath()}}var o$L=o$T[3];null!=o$L&&(o$k.fillStyle=o$L.fillStyle,o$k.fill());var o$U=o$T[4];null!=o$U&&(o$k.strokeStyle=o$U.strokeStyle,o$k.lineWidth=o$U.lineWidth||1,o$k.lineJoin=o$U.lineJoin,o$k.lineCap=o$U.lineCap,o$k.miterLimit=o$U.miterLimit,o$k.stroke())},this.drawPoly=function(o$o,o$r,o$T){this.ctx.drawPoly(o$o+this.x+o$T[0],o$r+this.y+o$T[1],o$T[2],o$T[3],o$T[4],o$T[5],o$T[6])},this._drawPoly=function(o$o,o$r,o$T){var o$k=this.ctx,o$W=o$T[2],o$D=2,o$n=o$W.length;if(o$C.isWebGL)for(o$k.setPathId(o$T[6]),o$k.beginPath(),o$o+=o$T[0],o$r+=o$T[1],o$k.movePath(o$o,o$r),o$k.moveTo(o$W[0],o$W[1]);o$D<o$n;)o$k.lineTo(o$W[o$D++],o$W[o$D++]);else for(o$k.beginPath(),o$o+=o$T[0],o$r+=o$T[1],o$k.moveTo(o$o+o$W[0],o$r+o$W[1]);o$D<o$n;)o$k.lineTo(o$o+o$W[o$D++],o$r+o$W[o$D++]);o$k.closePath(),this._fillAndStroke(o$T[3],o$T[4],o$T[5],o$T[7])},this._drawSkin=function(o$o,o$r,o$T){var o$k=o$T[0];if(o$k){var o$W=this.ctx;o$k.render(o$W,o$o,o$r)}},this._drawParticle=function(o$o,o$r,o$T){this.ctx.drawParticle(o$o+this.x,o$r+this.y,o$T[0])},this._setFilters=function(o$o,o$r,o$T){this.ctx.setFilters(o$T)},o$T?this.ctx=o$T.getContext("2d"):(o$T=o$yo.create("3D"),this.ctx=o$u.createWebGLContext2D(o$T),o$T._setContext(this.ctx)),o$T.size(o$o,o$r),this.canvas=o$T}o$h(o$n,"laya.renders.RenderContext");var o$o=o$n.prototype;return o$o.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},o$o.drawTexture=function(o$o,o$r,o$T,o$k,o$W){o$o.loaded&&this.ctx.drawTexture(o$o,o$r,o$T,o$k,o$W,this.x,this.y)},o$o._drawTextures=function(o$o,o$r,o$T){o$T[0].loaded&&this.ctx.drawTextures(o$T[0],o$T[1],o$o+this.x,o$r+this.y)},o$o.drawTextureWithTransform=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){o$o.loaded&&this.ctx.drawTextureWithTransform(o$o,o$r,o$T,o$k,o$W,o$D,this.x,this.y,o$n)},o$o.fillQuadrangle=function(o$o,o$r,o$T,o$k,o$W){this.ctx.fillQuadrangle(o$o,o$r,o$T,o$k,o$W)},o$o.drawCanvas=function(o$o,o$r,o$T,o$k,o$W){this.ctx.drawCanvas(o$o,o$r+this.x,o$T+this.y,o$k,o$W)},o$o.drawRect=function(o$o,o$r,o$T,o$k,o$W,o$D){void 0===o$D&&(o$D=1);var o$n=this.ctx;o$n.strokeStyle=o$W,o$n.lineWidth=o$D,o$n.strokeRect(o$o+this.x,o$r+this.y,o$T,o$k,o$D)},o$o._fillAndStroke=function(o$o,o$r,o$T,o$k){void 0===o$k&&(o$k=!1);var o$W=this.ctx;null!=o$o&&(o$W.fillStyle=o$o,o$C.isWebGL?o$W.fill(o$k):o$W.fill()),null!=o$r&&0<o$T&&(o$W.strokeStyle=o$r,o$W.lineWidth=o$T,o$W.stroke())},o$o.clipRect=function(o$o,o$r,o$T,o$k){this.ctx.clipRect(o$o+this.x,o$r+this.y,o$T,o$k)},o$o.fillRect=function(o$o,o$r,o$T,o$k,o$W){this.ctx.fillRect(o$o+this.x,o$r+this.y,o$T,o$k,o$W)},o$o.drawCircle=function(o$o,o$r,o$T,o$k,o$W){void 0===o$W&&(o$W=1),o$w.drawCall++;var o$D=this.ctx;o$D.beginPath(),o$D.strokeStyle=o$k,o$D.lineWidth=o$W,o$D.arc(o$o+this.x,o$r+this.y,o$T,0,o$n.PI2),o$D.stroke()},o$o.drawTriangles=function(o$o,o$r,o$T){if(o$C.isWebGL)this.ctx.drawTriangles(o$T[0],o$o+o$T[1],o$r+o$T[2],o$T[3],o$T[4],o$T[5],o$T[6],o$T[7],o$T[8],o$T[9]);else{var o$k=o$T[5],o$W=0,o$D=o$k.length,o$n=this.ctx;for(o$W=0;o$W<o$D;o$W+=3){var o$V=2*o$k[o$W],o$L=2*o$k[o$W+1],o$U=2*o$k[o$W+2];o$n.drawTriangle(o$T[0],o$T[3],o$T[4],o$V,o$L,o$U,o$T[6],!0)}}},o$o.fillCircle=function(o$o,o$r,o$T,o$k){o$w.drawCall++;var o$W=this.ctx;o$W.beginPath(),o$W.fillStyle=o$k,o$W.arc(o$o+this.x,o$r+this.y,o$T,0,o$n.PI2),o$W.fill()},o$o.setShader=function(o$o){this.ctx.setShader(o$o)},o$o.drawLine=function(o$o,o$r,o$T,o$k,o$W,o$D){void 0===o$D&&(o$D=1);var o$n=this.ctx;o$n.beginPath(),o$n.strokeStyle=o$W,o$n.lineWidth=o$D,o$n.moveTo(this.x+o$o,this.y+o$r),o$n.lineTo(this.x+o$T,this.y+o$k),o$n.stroke()},o$o.clear=function(){this.ctx.clear()},o$o.transformByMatrix=function(o$o){this.ctx.transformByMatrix(o$o)},o$o.setTransform=function(o$o,o$r,o$T,o$k,o$W,o$D){this.ctx.setTransform(o$o,o$r,o$T,o$k,o$W,o$D)},o$o.setTransformByMatrix=function(o$o){this.ctx.setTransformByMatrix(o$o)},o$o.save=function(){this.ctx.save()},o$o.restore=function(){this.ctx.restore()},o$o.translate=function(o$o,o$r){this.ctx.translate(o$o,o$r)},o$o.transform=function(o$o,o$r,o$T,o$k,o$W,o$D){this.ctx.transform(o$o,o$r,o$T,o$k,o$W,o$D)},o$o.rotate=function(o$o){this.ctx.rotate(o$o)},o$o.scale=function(o$o,o$r){this.ctx.scale(o$o,o$r)},o$o.alpha=function(o$o){this.ctx.globalAlpha*=o$o},o$o.setAlpha=function(o$o){this.ctx.globalAlpha=o$o},o$o.fillWords=function(o$o,o$r,o$T,o$k,o$W,o$D){void 0===o$D&&(o$D=0),this.ctx.fillWords(o$o,o$r,o$T,o$k,o$W,o$D)},o$o.fillBorderWords=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this.ctx.fillBorderWords(o$o,o$r,o$T,o$k,o$W,o$D,o$n)},o$o.fillText=function(o$o,o$r,o$T,o$k,o$W,o$D){this.ctx.fillText(o$o,o$r+this.x,o$T+this.y,o$k,o$W,o$D)},o$o.strokeText=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this.ctx.strokeText(o$o,o$r+this.x,o$T+this.y,o$k,o$W,o$D,o$n)},o$o.blendMode=function(o$o){this.ctx.globalCompositeOperation=o$o},o$o.flush=function(){this.ctx.flush&&this.ctx.flush()},o$o.addRenderObject=function(o$o){this.ctx.addRenderObject(o$o)},o$o.beginClip=function(o$o,o$r,o$T,o$k){this.ctx.beginClip&&this.ctx.beginClip(o$o,o$r,o$T,o$k)},o$o.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},o$o.fillTrangles=function(o$o,o$r,o$T){this.ctx.fillTrangles(o$T[0],o$T[1],o$T[2],o$T[3],4<o$T.length?o$T[4]:null)},o$n.PI2=2*Math.PI,o$n}(),o$O=function(){function o$n(o$o,o$r){switch(this._next=o$r||o$n.NORENDER,o$o){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=o$K._filter);case 69905:return void(this._fun=o$n._initRenderFun)}this.onCreate(o$o)}o$h(o$n,"laya.renders.RenderSprite");var o$o=o$n.prototype;return o$o.onCreate=function(o$o){},o$o._style=function(o$o,o$r,o$T,o$k){o$o._style.render(o$o,o$r,o$T,o$k);var o$W=this._next;o$W._fun.call(o$W,o$o,o$r,o$T,o$k)},o$o._no=function(o$o,o$r,o$T,o$k){},o$o._custom=function(o$o,o$r,o$T,o$k){o$o.customRender(o$r,o$T,o$k);var o$W=o$o._style._tf;this._next._fun.call(this._next,o$o,o$r,o$T-o$W.translateX,o$k-o$W.translateY)},o$o._clip=function(o$o,o$r,o$T,o$k){var o$W=this._next;if(o$W!=o$n.NORENDER){var o$D=o$o._style.scrollRect;o$r.ctx.save(),o$r.ctx.clipRect(o$T,o$k,o$D.width,o$D.height),o$W._fun.call(o$W,o$o,o$r,o$T-o$D.x,o$k-o$D.y),o$r.ctx.restore()}},o$o._blend=function(o$o,o$r,o$T,o$k){var o$W=o$o._style;o$W.blendMode&&(o$r.ctx.globalCompositeOperation=o$W.blendMode);var o$D=this._next;o$D._fun.call(o$D,o$o,o$r,o$T,o$k),o$r.ctx.globalCompositeOperation="source-over"},o$o._mask=function(o$o,o$r,o$T,o$k){var o$W=this._next;o$W._fun.call(o$W,o$o,o$r,o$T,o$k);var o$D=o$o.mask;o$D&&(o$r.ctx.globalCompositeOperation="destination-in",(0<o$D.numChildren||!o$D.graphics._isOnlyOne())&&(o$D.cacheAsBitmap=!0),o$D.render(o$r,o$T-o$o.pivotX,o$k-o$o.pivotY)),o$r.ctx.globalCompositeOperation="source-over"},o$o._graphics=function(o$o,o$r,o$T,o$k){var o$W=o$o._style._tf;o$o._graphics&&o$o._graphics._render(o$o,o$r,o$T-o$W.translateX,o$k-o$W.translateY);var o$D=this._next;o$D._fun.call(o$D,o$o,o$r,o$T,o$k)},o$o._image=function(o$o,o$r,o$T,o$k){var o$W=o$o._style;o$r.ctx.drawTexture2(o$T,o$k,o$W._tf.translateX,o$W._tf.translateY,o$o.transform,o$W.alpha,o$W.blendMode,o$o._graphics._one)},o$o._image2=function(o$o,o$r,o$T,o$k){var o$W=o$o._style._tf;o$r.ctx.drawTexture2(o$T,o$k,o$W.translateX,o$W.translateY,o$o.transform,1,null,o$o._graphics._one)},o$o._alpha=function(o$o,o$r,o$T,o$k){var o$W;if(.01<(o$W=o$o._style.alpha)||o$o._needRepaint()){var o$D=o$r.ctx.globalAlpha;o$r.ctx.globalAlpha*=o$W;var o$n=this._next;o$n._fun.call(o$n,o$o,o$r,o$T,o$k),o$r.ctx.globalAlpha=o$D}},o$o._transform=function(o$o,o$r,o$T,o$k){var o$W=o$o.transform,o$D=this._next;o$W&&o$D!=o$n.NORENDER?(o$r.save(),o$r.transform(o$W.a,o$W.b,o$W.c,o$W.d,o$W.tx+o$T,o$W.ty+o$k),o$D._fun.call(o$D,o$o,o$r,0,0),o$r.restore()):o$D._fun.call(o$D,o$o,o$r,o$T,o$k)},o$o._childs=function(o$o,o$r,o$T,o$k){var o$W=o$o._style,o$D=o$W._tf;if(o$T=o$T-o$D.translateX+o$W.paddingLeft,o$k=o$k-o$D.translateY+o$W.paddingTop,o$W._calculation){var o$n=o$o._getWords();if(o$n){var o$V=o$W;o$V&&(o$V.stroke?o$r.fillBorderWords(o$n,o$T,o$k,o$V.font,o$V.color,o$V.strokeColor,o$V.stroke):o$r.fillWords(o$n,o$T,o$k,o$V.font,o$V.color,"none"!=o$V.textDecoration&&o$V.underLine?1:0))}}var o$L,o$U=o$o._childs,o$h=o$U.length;if(o$o.viewport||o$o.optimizeScrollRect&&o$o._style.scrollRect){var o$p=o$o.viewport||o$o._style.scrollRect,o$i=o$p.x,o$v=o$p.y,o$x=o$p.right,o$j=o$p.bottom,o$_=NaN,o$K=NaN;for(o$$=0;o$$<o$h;++o$$)(o$L=o$U[o$$]).visible&&(o$_=o$L._x)<o$x&&o$_+o$L.width>o$i&&(o$K=o$L._y)<o$j&&o$K+o$L.height>o$v&&o$L.render(o$r,o$T,o$k)}else for(var o$$=0;o$$<o$h;++o$$)(o$L=o$U[o$$])._style.visible&&o$L.render(o$r,o$T,o$k)},o$o._canvas=function(o$o,o$r,o$T,o$k){var o$W=o$o._$P.cacheCanvas;if(o$W){"bitmap"===o$W.type?o$w.canvasBitmap++:o$w.canvasNormal++;var o$D=o$W.ctx;if(o$o._needRepaint()||!o$D)this._canvas_repaint(o$o,o$r,o$T,o$k);else{var o$n=o$W._cacheRec;o$r.drawCanvas(o$D.canvas,o$T+o$n.x,o$k+o$n.y,o$n.width,o$n.height)}}else this._next._fun.call(this._next,o$o,o$r,o$T,o$k)},o$o._canvas_repaint=function(o$o,o$r,o$T,o$k){var o$W=o$o._$P.cacheCanvas,o$D=this._next;if(o$W){var o$n,o$V,o$L,o$U,o$h=o$W.ctx,o$p=o$o._needRepaint()||!o$h,o$i=o$W.type;if("bitmap"===o$i?o$w.canvasBitmap++:o$w.canvasNormal++,o$p){var o$v,o$x;o$W._cacheRec||(o$W._cacheRec=new o$P),o$C.isWebGL&&"bitmap"!==o$i?o$W._cacheRec.setTo(-o$o.pivotX,-o$o.pivotY,1,1):((o$U=o$o.getSelfBounds()).x=o$U.x-o$o.pivotX,o$U.y=o$U.y-o$o.pivotY,o$U.x=o$U.x-16,o$U.y=o$U.y-16,o$U.width=o$U.width+32,o$U.height=o$U.height+32,o$U.x=Math.floor(o$U.x+o$T)-o$T,o$U.y=Math.floor(o$U.y+o$k)-o$k,o$U.width=Math.floor(o$U.width),o$U.height=Math.floor(o$U.height),o$W._cacheRec.copyFrom(o$U)),o$U=o$W._cacheRec;var o$j,o$_=o$C.isWebGL?1:o$e.pixelRatio*o$b.stage.clientScaleX,o$K=o$C.isWebGL?1:o$e.pixelRatio*o$b.stage.clientScaleY;if(!o$C.isWebGL){var o$$,o$y=1,o$l=1;for(o$$=o$o;o$$&&o$$!=o$b.stage;)o$y*=o$$.scaleX,o$l*=o$$.scaleY,o$$=o$$.parent;o$C.isWebGL?(o$y<1&&(o$_*=o$y),o$l<1&&(o$K*=o$l)):(1<o$y&&(o$_*=o$y),1<o$l&&(o$K*=o$l))}if(o$o.scrollRect){var o$S=o$o.scrollRect;o$U.x-=o$S.x,o$U.y-=o$S.y}if(o$v=o$U.width*o$_,o$x=o$U.height*o$K,o$V=o$U.x,o$L=o$U.y,o$C.isWebGL&&"bitmap"===o$i&&(2048<o$v||2048<o$x))return console.warn("cache bitmap size larger than 2048,cache ignored"),o$W.ctx&&(o$G.recover("RenderContext",o$W.ctx),o$W.ctx.canvas.size(0,0),o$W.ctx=null),void o$D._fun.call(o$D,o$o,o$r,o$T,o$k);if(o$h||(o$h=o$W.ctx=o$G.getItem("RenderContext")||new o$X(o$v,o$x,o$yo.create("AUTO"))),o$h.ctx.sprite=o$o,(o$n=o$h.canvas).clear(),(o$n.width!=o$v||o$n.height!=o$x)&&o$n.size(o$v,o$x),"bitmap"===o$i?o$n.context.asBitmap=!0:"normal"===o$i&&(o$n.context.asBitmap=!1),1!=o$_||1!=o$K){var o$q=o$h.ctx;o$q.save(),o$q.scale(o$_,o$K),!o$C.isConchWebGL&&o$C.isConchApp&&(o$j=o$o._$P.cf)&&o$q.setFilterMatrix&&o$q.setFilterMatrix(o$j._mat,o$j._alpha),o$D._fun.call(o$D,o$o,o$h,-o$V,-o$L),o$q.restore(),o$C.isConchApp&&!o$C.isConchWebGL||o$o._applyFilters()}else o$q=o$h.ctx,!o$C.isConchWebGL&&o$C.isConchApp&&(o$j=o$o._$P.cf)&&o$q.setFilterMatrix&&o$q.setFilterMatrix(o$j._mat,o$j._alpha),o$D._fun.call(o$D,o$o,o$h,-o$V,-o$L),o$C.isConchApp&&!o$C.isConchWebGL||o$o._applyFilters();o$o._$P.staticCache&&(o$W.reCache=!1),o$w.canvasReCache++}else o$V=(o$U=o$W._cacheRec).x,o$L=o$U.y,o$n=o$h.canvas;o$r.drawCanvas(o$n,o$T+o$V,o$k+o$L,o$U.width,o$U.height)}else o$D._fun.call(o$D,o$o,o$h,o$T,o$k)},o$n.__init__=function(){var o$o,o$r,o$T=0;for(o$r=o$u.createRenderSprite(69905,null),o$o=o$n.renders.length=4096,o$T=0;o$T<o$o;o$T++)o$n.renders[o$T]=o$r;o$n.renders[0]=o$u.createRenderSprite(0,null),function(o$o,o$r){for(var o$T=0,o$k=0;o$k<o$o.length;o$k++)o$T|=o$o[o$k],o$n.renders[o$T]=o$r}([1,512,4,2],new o$n(1,null)),o$n.renders[513]=o$u.createRenderSprite(513,null),o$n.renders[517]=new o$n(517,null)},o$n._initRenderFun=function(o$o,o$r,o$T,o$k){var o$W=o$o._renderType;(o$n.renders[o$W]=o$n._getTypeRender(o$W))._fun(o$o,o$r,o$T,o$k)},o$n._getTypeRender=function(o$o){for(var o$r=null,o$T=2048;1<o$T;)o$T&o$o&&(o$r=o$u.createRenderSprite(o$T,o$r)),o$T>>=1;return o$r},o$n.IMAGE=1,o$n.ALPHA=2,o$n.TRANSFORM=4,o$n.BLEND=8,o$n.CANVAS=16,o$n.FILTERS=32,o$n.MASK=64,o$n.CLIP=128,o$n.STYLE=256,o$n.GRAPHICS=512,o$n.CUSTOM=1024,o$n.CHILDS=2048,o$n.INIT=69905,o$n.renders=[],o$n.NORENDER=new o$n(0,null),o$n}(),o$M=function(){function o$V(){this._repaint=!1}o$h(o$V,"laya.resource.Context");var o$o=o$V.prototype;return o$o.replaceReset=function(){var o$o,o$r,o$T=0;for(o$o=o$V.replaceKeys.length,o$T=0;o$T<o$o;o$T++)o$r=o$V.replaceKeys[o$T],this[o$V.newKeys[o$T]]=this[o$r]},o$o.replaceResotre=function(){this.__restore(),this.__reset()},o$o.setIsMainContext=function(){},o$o.drawTextures=function(o$o,o$r,o$T,o$k){o$w.drawCall+=o$r.length/2;for(var o$W=o$o.width,o$D=o$o.height,o$n=0,o$V=o$r.length;o$n<o$V;o$n+=2)this.drawTexture(o$o,o$r[o$n],o$r[o$n+1],o$W,o$D,o$T,o$k)},o$o.drawCanvas=function(o$o,o$r,o$T,o$k,o$W){o$w.drawCall++,this.drawImage(o$o.source,o$r,o$T,o$k,o$W)},o$o.fillRect=function(o$o,o$r,o$T,o$k,o$W){o$w.drawCall++,o$W&&(this.fillStyle=o$W),this.__fillRect(o$o,o$r,o$T,o$k)},o$o.fillText=function(o$o,o$r,o$T,o$k,o$W,o$D){o$w.drawCall++,3<arguments.length&&null!=o$k&&(this.font=o$k,this.fillStyle=o$W,this.textAlign=o$D,this.textBaseline="top"),this.__fillText(o$o,o$r,o$T)},o$o.fillBorderText=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){o$w.drawCall++,this.font=o$k,this.fillStyle=o$W,this.textBaseline="top",this.strokeStyle=o$D,this.lineWidth=o$n,this.textAlign=o$V,this.__strokeText(o$o,o$r,o$T),this.__fillText(o$o,o$r,o$T)},o$o.strokeText=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){o$w.drawCall++,3<arguments.length&&null!=o$k&&(this.font=o$k,this.strokeStyle=o$W,this.lineWidth=o$D,this.textAlign=o$n,this.textBaseline="top"),this.__strokeText(o$o,o$r,o$T)},o$o.transformByMatrix=function(o$o){this.transform(o$o.a,o$o.b,o$o.c,o$o.d,o$o.tx,o$o.ty)},o$o.setTransformByMatrix=function(o$o){this.setTransform(o$o.a,o$o.b,o$o.c,o$o.d,o$o.tx,o$o.ty)},o$o.clipRect=function(o$o,o$r,o$T,o$k){o$w.drawCall++,this.beginPath(),this.rect(o$o,o$r,o$T,o$k),this.clip()},o$o.drawTexture=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){o$w.drawCall++;var o$V=o$o.uv,o$L=o$o.bitmap.width,o$U=o$o.bitmap.height;this.drawImage(o$o.source,o$V[0]*o$L,o$V[1]*o$U,(o$V[2]-o$V[0])*o$L,(o$V[5]-o$V[3])*o$U,o$r+o$D,o$T+o$n,o$k,o$W)},o$o.drawTextureWithTransform=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){o$w.drawCall++;var o$U=o$o.uv,o$h=o$o.bitmap.width,o$p=o$o.bitmap.height;this.save(),1!=o$L&&(this.globalAlpha*=o$L),o$D?(this.transform(o$D.a,o$D.b,o$D.c,o$D.d,o$D.tx+o$n,o$D.ty+o$V),this.drawImage(o$o.source,o$U[0]*o$h,o$U[1]*o$p,(o$U[2]-o$U[0])*o$h,(o$U[5]-o$U[3])*o$p,o$r,o$T,o$k,o$W)):this.drawImage(o$o.source,o$U[0]*o$h,o$U[1]*o$p,(o$U[2]-o$U[0])*o$h,(o$U[5]-o$U[3])*o$p,o$r+o$n,o$T+o$V,o$k,o$W),this.restore()},o$o.drawTexture2=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){var o$L=o$V[0];if(o$L.loaded&&o$L.bitmap&&o$L.source){o$w.drawCall++;var o$U=1!==o$D;if(o$U){var o$h=this.globalAlpha;this.globalAlpha*=o$D}var o$p=o$L.uv,o$i=o$L.bitmap.width,o$v=o$L.bitmap.height;o$W?(this.save(),this.transform(o$W.a,o$W.b,o$W.c,o$W.d,o$W.tx+o$o,o$W.ty+o$r),this.drawImage(o$L.source,o$p[0]*o$i,o$p[1]*o$v,(o$p[2]-o$p[0])*o$i,(o$p[5]-o$p[3])*o$v,o$V[1]-o$T,o$V[2]-o$k,o$V[3],o$V[4]),this.restore()):this.drawImage(o$L.source,o$p[0]*o$i,o$p[1]*o$v,(o$p[2]-o$p[0])*o$i,(o$p[5]-o$p[3])*o$v,o$V[1]-o$T+o$o,o$V[2]-o$k+o$r,o$V[3],o$V[4]),o$U&&(this.globalAlpha=o$h)}},o$o.fillTexture=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){if(!o$V.pat){if(o$o.uv!=o$ho.DEF_UV){var o$L=new o$yo("2D");o$L.getContext("2d"),o$L.size(o$o.width,o$o.height),o$L.context.drawTexture(o$o,0,0,o$o.width,o$o.height,0,0),o$o=new o$ho(o$L)}o$V.pat=this.createPattern(o$o.bitmap.source,o$D)}var o$U=o$r,o$h=o$T,o$p=0,o$i=0;o$n&&(o$U+=o$n.x%o$o.width,o$h+=o$n.y%o$o.height,o$p-=o$n.x%o$o.width,o$i-=o$n.y%o$o.height),this.translate(o$U,o$h),this.fillRect(o$p,o$i,o$k,o$W,o$V.pat),this.translate(-o$U,-o$h)},o$o.drawTriangle=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){var o$L=o$o.bitmap,o$U=o$L.source,o$h=o$o.width,o$p=o$o.height,o$i=o$L.width,o$v=o$L.height,o$x=o$T[o$k]*o$i,o$j=o$T[o$W]*o$i,o$_=o$T[o$D]*o$i,o$K=o$T[o$k+1]*o$v,o$$=o$T[o$W+1]*o$v,o$y=o$T[o$D+1]*o$v,o$l=o$r[o$k],o$S=o$r[o$W],o$q=o$r[o$D],o$b=o$r[o$k+1],o$F=o$r[o$W+1],o$P=o$r[o$D+1];if(o$V){var o$t=(o$l+o$S+o$q)/3,o$H=(o$b+o$F+o$P)/3,o$R=o$l-o$t,o$u=o$b-o$H,o$s=Math.sqrt(o$R*o$R+o$u*o$u);o$l=o$t+o$R/o$s*(o$s+1),o$b=o$H+o$u/o$s*(o$s+1),o$u=o$F-o$H,o$S=o$t+(o$R=o$S-o$t)/(o$s=Math.sqrt(o$R*o$R+o$u*o$u))*(o$s+1),o$F=o$H+o$u/o$s*(o$s+1),o$u=o$P-o$H,o$q=o$t+(o$R=o$q-o$t)/(o$s=Math.sqrt(o$R*o$R+o$u*o$u))*(o$s+1),o$P=o$H+o$u/o$s*(o$s+1)}this.save(),o$n&&this.transform(o$n.a,o$n.b,o$n.c,o$n.d,o$n.tx,o$n.ty),this.beginPath(),this.moveTo(o$l,o$b),this.lineTo(o$S,o$F),this.lineTo(o$q,o$P),this.closePath(),this.clip();var o$z=1/(o$x*o$$+o$K*o$_+o$j*o$y-o$$*o$_-o$K*o$j-o$x*o$y),o$m=o$l*o$$+o$K*o$q+o$S*o$y-o$$*o$q-o$K*o$S-o$l*o$y,o$C=o$x*o$S+o$l*o$_+o$j*o$q-o$S*o$_-o$l*o$j-o$x*o$q,o$X=o$x*o$$*o$q+o$K*o$S*o$_+o$l*o$j*o$y-o$l*o$$*o$_-o$K*o$j*o$q-o$x*o$S*o$y,o$O=o$b*o$$+o$K*o$P+o$F*o$y-o$$*o$P-o$K*o$F-o$b*o$y,o$M=o$x*o$F+o$b*o$_+o$j*o$P-o$F*o$_-o$b*o$j-o$x*o$P,o$c=o$x*o$$*o$P+o$K*o$F*o$_+o$b*o$j*o$y-o$b*o$$*o$_-o$K*o$j*o$P-o$x*o$F*o$y;this.transform(o$m*o$z,o$O*o$z,o$C*o$z,o$M*o$z,o$X*o$z,o$c*o$z),this.drawImage(o$U,o$o.uv[0]*o$i,o$o.uv[1]*o$v,o$h,o$p,o$o.uv[0]*o$i,o$o.uv[1]*o$v,o$h,o$p),this.restore()},o$o.flush=function(){return 0},o$o.fillWords=function(o$o,o$r,o$T,o$k,o$W,o$D){o$k&&(this.font=o$k),o$W&&(this.fillStyle=o$W);this.textBaseline="top",this.textAlign="left";for(var o$n=0,o$V=o$o.length;o$n<o$V;o$n++){var o$L=o$o[o$n];if(this.__fillText(o$L.char,o$L.x+o$r,o$L.y+o$T),1===o$D){var o$U=o$L.height,o$h=.5*o$L.style.letterSpacing;o$h||(o$h=0),this.beginPath(),this.strokeStyle=o$W,this.lineWidth=1,this.moveTo(o$r+o$L.x-o$h+.5,o$T+o$L.y+o$U+.5),this.lineTo(o$r+o$L.x+o$L.width+o$h+.5,o$T+o$L.y+o$U+.5),this.stroke()}}},o$o.fillBorderWords=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){o$k&&(this.font=o$k),o$W&&(this.fillStyle=o$W),this.textBaseline="top",this.lineWidth=o$n,this.textAlign="left",this.strokeStyle=o$D;for(var o$V=0,o$L=o$o.length;o$V<o$L;o$V++){var o$U=o$o[o$V];this.__strokeText(o$U.char,o$U.x+o$r,o$U.y+o$T),this.__fillText(o$U.char,o$U.x+o$r,o$U.y+o$T)}},o$o.destroy=function(){this.canvas.width=this.canvas.height=0},o$o.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},o$o.drawCurves=function(o$o,o$r,o$T){this.beginPath(),this.strokeStyle=o$T[3],this.lineWidth=o$T[4];var o$k=o$T[2];o$o+=o$T[0],o$r+=o$T[1],this.moveTo(o$o+o$k[0],o$r+o$k[1]);for(var o$W=2,o$D=o$k.length;o$W<o$D;)this.quadraticCurveTo(o$o+o$k[o$W++],o$r+o$k[o$W++],o$o+o$k[o$W++],o$r+o$k[o$W++]);this.stroke()},o$V.__init__=function(o$r){var o$T=laya.resource.Context.prototype;if(!(o$r=o$r||CanvasRenderingContext2D.prototype).inited){o$r.inited=!0,o$r.__fillText=o$r.fillText,o$r.__fillRect=o$r.fillRect,o$r.__strokeText=o$r.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(o$o){o$r[o$o]=o$T[o$o]})}},o$V.replaceCanvasGetSet=function(o$o,o$r){var o$T=Object.getOwnPropertyDescriptor(o$o,o$r);if(!o$T||!o$T.configurable)return!1;var o$k,o$W={};for(o$k in o$T)"set"!=o$k&&(o$W[o$k]=o$T[o$k]);var o$D=o$T.set;return o$W.set=function(o$o){o$D.call(this,o$o);var o$r=this.getContext("2d");o$r&&"__reset"in o$r&&o$r.__reset()},Object.defineProperty(o$o,o$r,o$W),!0},o$V.replaceGetSet=function(o$o,o$r){var o$T=Object.getOwnPropertyDescriptor(o$o,o$r);if(!o$T||!o$T.configurable)return!1;var o$k,o$W={};for(o$k in o$T)"set"!=o$k&&(o$W[o$k]=o$T[o$k]);var o$D=o$T.set,o$n="___"+o$r+"__";return o$V.newKeys.push(o$n),o$W.set=function(o$o){o$o!=this[o$n]&&(this[o$n]=o$o,o$D.call(this,o$o))},Object.defineProperty(o$o,o$r,o$W),!0},o$V._default=new o$V,o$V.newKeys=[],o$L(o$V,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),o$V}(),o$c=function(){function o$D(o$o){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++o$D._uniqueIDCounter,this._name=o$o||"Content Manager",o$D._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,o$D._resourceManagers.push(this),this._resources=[],this._records={}}o$h(o$D,"laya.resource.ResourceManager");var o$o=o$D.prototype;return o$b.imps(o$o,{"laya.resource.IDispose":!0}),o$o.getResourceByIndex=function(o$o){return this._resources[o$o]},o$o.getResourcesLength=function(){return this._resources.length},o$o.addResource=function(o$o){return o$o.resourceManager&&o$o.resourceManager.removeResource(o$o),-1===this._resources.indexOf(o$o)&&((o$o._resourceManager=this)._resources.push(o$o),this.addRecord(o$o.uri,o$o.__className,o$o.memorySize),this.addSize(o$o.memorySize),!0)},o$o.removeResource=function(o$o){var o$r=this._resources.indexOf(o$o);return-1!==o$r&&(this._resources.splice(o$r,1),o$o._resourceManager=null,this._memorySize-=o$o.memorySize,this.addRecord(o$o.uri,o$o.__className,-o$o.memorySize),!0)},o$o.unload=function(){for(var o$o=this._resources.slice(0,this._resources.length),o$r=0;o$r<o$o.length;o$r++){o$o[o$r].destroy()}o$o.length=0},o$o.dispose=function(){if(this===o$D._systemResourceManager)throw new Error("systemResourceManager不能被释放！");o$D._resourceManagers.splice(o$D._resourceManagers.indexOf(this),1),o$D._isResourceManagersSorted=!1;for(var o$o=this._resources.slice(0,this._resources.length),o$r=0;o$r<o$o.length;o$r++){var o$T=o$o[o$r];o$T.resourceManager.removeResource(o$T),o$T.destroy()}o$o.length=0},o$o.addSize=function(o$o){o$o&&(this.autoRelease&&0<o$o&&this._memorySize+o$o>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=o$o)},o$o.addRecord=function(o$o,o$r,o$T){DEBUG&&o$T&&!o$o&&console.error(o$o,o$r,o$T),o$o&&(this._records.hasOwnProperty(o$r+"|"+o$o)||(this._records[o$r+"|"+o$o]=0),this._records[o$r+"|"+o$o]+=o$T,DEBUG&&this._records[o$r+"|"+o$o]<0&&console.error(o$o,o$r,this._records[o$r+"|"+o$o]))},o$o.garbageCollection=function(o$o){var o$r=this._resources;(o$r=o$r.slice()).sort(function(o$o,o$r){if(!o$o||!o$r)throw new Error("a或b不能为空！");return o$o.released&&o$r.released?0:o$o.released?1:o$r.released?-1:o$o._lastUseFrameCount-o$r._lastUseFrameCount});for(var o$T=o$w.loopCount,o$k=0,o$W=o$r.length;o$k<o$W;o$k++){var o$D=o$r[o$k];if(!(1<o$T-o$D._lastUseFrameCount))return void(this._memorySize>=o$o&&(this._isOverflow=!0));if(o$D.releaseResource(),this._memorySize<o$o)return void(this._isOverflow=!1)}},o$x(0,o$o,"id",function(){return this._id}),o$x(0,o$o,"name",function(){return this._name},function(o$o){!o$o&&""===o$o||this._name===o$o||(this._name=o$o,o$D._isResourceManagersSorted=!1)}),o$x(0,o$o,"memorySize",function(){return this._memorySize}),o$x(0,o$o,"records",function(){return this._records}),o$x(1,o$D,"systemResourceManager",function(){return o$D._systemResourceManager}),o$D.__init__=function(){o$D.currentResourceManager=o$D.systemResourceManager},o$D.getLoadedResourceManagerByIndex=function(o$o){return o$D._resourceManagers[o$o]},o$D.getLoadedResourceManagersCount=function(){return o$D._resourceManagers.length},o$D.recreateContentManagers=function(o$o){void 0===o$o&&(o$o=!1);for(var o$r=o$D.currentResourceManager,o$T=0;o$T<o$D._resourceManagers.length;o$T++){o$D.currentResourceManager=o$D._resourceManagers[o$T];for(var o$k=0;o$k<o$D.currentResourceManager._resources.length;o$k++)o$D.currentResourceManager._resources[o$k].releaseResource(o$o),o$D.currentResourceManager._resources[o$k].activeResource(o$o)}o$D.currentResourceManager=o$r},o$D.releaseContentManagers=function(o$o){void 0===o$o&&(o$o=!1);for(var o$r=o$D.currentResourceManager,o$T=0;o$T<o$D._resourceManagers.length;o$T++){o$D.currentResourceManager=o$D._resourceManagers[o$T];for(var o$k=0;o$k<o$D.currentResourceManager._resources.length;o$k++){var o$W=o$D.currentResourceManager._resources[o$k];!o$W.released&&o$W.releaseResource(o$o)}}o$D.currentResourceManager=o$r},o$D._uniqueIDCounter=0,o$D._isResourceManagersSorted=!1,o$D._resourceManagers=[],o$L(o$D,["_systemResourceManager",function(){return this._systemResourceManager=new o$D("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=o$D._systemResourceManager}]),o$D}(),o$e=(function(){function o$o(){}o$h(o$o,"laya.system.System"),o$o.changeDefinition=function(o$o,o$r){o$b[o$o]=o$r;var o$T=o$o+"=classObj";o$b._runScript(o$T)},o$o.__init__=function(){o$C.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function o$T(){}return o$h(o$T,"laya.utils.Browser"),o$x(1,o$T,"pixelRatio",function(){return o$T.__init__(),-1<o$T.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:o$u.getPixelRatio()}),o$x(1,o$T,"height",function(){return o$T.__init__(),(o$b.stage&&o$b.stage.canvasRotation?o$T.clientWidth:o$T.clientHeight)*o$T.pixelRatio}),o$x(1,o$T,"clientWidth",function(){return o$T.__init__(),o$T.window.innerWidth||o$T.document.body.clientWidth}),o$x(1,o$T,"window",function(){return o$T.__init__(),o$T._window}),o$x(1,o$T,"clientHeight",function(){return o$T.__init__(),o$T.window.innerHeight||o$T.document.body.clientHeight||o$T.document.documentElement.clientHeight}),o$x(1,o$T,"width",function(){return o$T.__init__(),(o$b.stage&&o$b.stage.canvasRotation?o$T.clientHeight:o$T.clientWidth)*o$T.pixelRatio}),o$x(1,o$T,"container",function(){return o$T.__init__(),o$T._container||((o$T._container=o$T.createElement("div")).id="layaContainer",o$T.document.body.appendChild(o$T._container)),o$T._container},function(o$o){o$T._container=o$o}),o$x(1,o$T,"document",function(){return o$T.__init__(),o$T._document}),o$T.__init__=function(){if(!o$T._window){o$T._window=o$u.getWindow(),o$T._document=o$T.window.document,o$T._window.addEventListener("message",function(o$o){laya.utils.Browser._onMessage(o$o)},!1),o$T.document.__createElement=o$T.document.createElement,o$n.requestAnimationFrame=o$n.requestAnimationFrame||o$n.webkitRequestAnimationFrame||o$n.mozRequestAnimationFrame||o$n.oRequestAnimationFrame||o$n.msRequestAnimationFrame||function(o$o){return o$n.setTimeout(o$o,1e3/60)};var o$o=o$n.document.body.style;o$o["-webkit-user-select"]="none",o$o["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",o$T.userAgent=o$T.window.navigator.userAgent,o$T.onIOS=!!(o$T.u=o$T.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),o$T.onMobile=-1<o$T.u.indexOf("Mobile"),o$T.onIPhone=-1<o$T.u.indexOf("iPhone"),o$T.onMac=-1<o$T.u.indexOf("Mac OS X"),o$T.onIPad=-1<o$T.u.indexOf("iPad"),o$T.onAndroid=-1<o$T.u.indexOf("Android")||-1<o$T.u.indexOf("Adr"),o$T.onWP=-1<o$T.u.indexOf("Windows Phone"),o$T.onQQBrowser=-1<o$T.u.indexOf("QQBrowser"),o$T.onMQQBrowser=-1<o$T.u.indexOf("MQQBrowser")||-1<o$T.u.indexOf("Mobile")&&-1<o$T.u.indexOf("QQ"),o$T.onIE=!!o$T.window.ActiveXObject||"ActiveXObject"in o$T.window,o$T.onWeiXin=-1<o$T.u.indexOf("MicroMessenger"),o$T.onPC=!o$T.onMobile,o$T.onSafari=-1<o$T.u.indexOf("Safari"),o$T.onFirefox=-1<o$T.u.indexOf("Firefox"),o$T.onEdge=-1<o$T.u.indexOf("Edge"),o$T.onMiniGame=-1<o$T.u.indexOf("MiniGame"),o$T.onLimixiu=-1<o$T.u.indexOf("limixiu"),o$T.httpProtocol="http:"==o$T.window.location.protocol,o$T.onMiniGame&&null==o$T.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),o$T.webAudioEnabled=!!(o$T.window.AudioContext||o$T.window.webkitAudioContext||o$T.window.mozAudioContext),o$T.soundType=o$T.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",o$Wo=o$T.webAudioEnabled?o$Do:o$To,o$T.webAudioEnabled&&o$Do.initWebAudio(),o$To._initMusicAudio(),o$T.enableTouch="ontouchstart"in o$n||o$n.DocumentTouch&&o$r instanceof DocumentTouch,o$n.focus(),o$R._soundClass=o$Wo,o$R._musicClass=o$To,o$C._mainCanvas=o$C._mainCanvas||o$yo.create("2D"),o$T.canvas||(o$T.canvas=o$yo.create("2D"),o$T.context=o$T.canvas.getContext("2d"))}},o$T._onMessage=function(o$o){if(o$o.data&&"size"==o$o.data.name){if(o$T.window.innerWidth=o$o.data.width,o$T.window.innerHeight=o$o.data.height,o$T.window.__innerHeight=o$o.data.clientHeight,!o$T.document.createEvent)return void console.warn("no document.createEvent");var o$r=o$T.document.createEvent("HTMLEvents");return o$r.initEvent("resize",!1,!1),void o$T.window.dispatchEvent(o$r)}},o$T.createElement=function(o$o){return o$T.__init__(),o$T.document.__createElement(o$o)},o$T.getElementById=function(o$o){return o$T.__init__(),o$T.document.getElementById(o$o)},o$T.removeElement=function(o$o){o$o&&o$o.parentNode&&o$o.parentNode.removeChild(o$o)},o$T.now=function(){return o$u.now()},o$T._window=null,o$T._document=null,o$T._container=null,o$T.userAgent=null,o$T.u=null,o$T.onIOS=!1,o$T.onMac=!1,o$T.onMobile=!1,o$T.onIPhone=!1,o$T.onIPad=!1,o$T.onAndroid=!1,o$T.onWP=!1,o$T.onQQBrowser=!1,o$T.onMQQBrowser=!1,o$T.onSafari=!1,o$T.onFirefox=!1,o$T.onEdge=!1,o$T.onIE=!1,o$T.onWeiXin=!1,o$T.onMiniGame=!1,o$T.onLimixiu=!1,o$T.onPC=!1,o$T.httpProtocol=!1,o$T.webAudioEnabled=!1,o$T.soundType=null,o$T.enableTouch=!1,o$T.canvas=null,o$T.context=null,o$T.__init$=function(){},o$T}()),o$J=function(){function o$r(o$o){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,o$o?(this._u8d_=new Uint8Array(o$o),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}o$h(o$r,"laya.utils.Byte");var o$o=o$r.prototype;return o$o.___resizeBuffer=function(o$r){try{var o$o=new Uint8Array(o$r);null!=this._u8d_&&(this._u8d_.length<=o$r?o$o.set(this._u8d_):o$o.set(this._u8d_.subarray(0,o$r))),this._u8d_=o$o,this._d_=new DataView(o$o.buffer)}catch(o$o){throw"___resizeBuffer err:"+o$r}},o$o.getString=function(){return this.rUTF(this.getUint16())},o$o.getFloat32Array=function(o$o,o$r){var o$T=o$o+o$r;o$T=o$T>this._length?this._length:o$T;var o$k=new Float32Array(this._d_.buffer.slice(o$o,o$T));return this._pos_=o$T,o$k},o$o.getUint8Array=function(o$o,o$r){var o$T=o$o+o$r;o$T=o$T>this._length?this._length:o$T;var o$k=new Uint8Array(this._d_.buffer.slice(o$o,o$T));return this._pos_=o$T,o$k},o$o.getInt16Array=function(o$o,o$r){var o$T=o$o+o$r;o$T=o$T>this._length?this._length:o$T;var o$k=new Int16Array(this._d_.buffer.slice(o$o,o$T));return this._pos_=o$T,o$k},o$o.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var o$o=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,o$o},o$o.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var o$o=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,o$o},o$o.writeFloat32=function(o$o){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,o$o,this._xd_),this._pos_+=4},o$o.writeFloat64=function(o$o){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,o$o,this._xd_),this._pos_+=8},o$o.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var o$o=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,o$o},o$o.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var o$o=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,o$o},o$o.writeInt32=function(o$o){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,o$o,this._xd_),this._pos_+=4},o$o.writeUint32=function(o$o){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,o$o,this._xd_),this._pos_+=4},o$o.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var o$o=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,o$o},o$o.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var o$o=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,o$o},o$o.writeUint16=function(o$o){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,o$o,this._xd_),this._pos_+=2},o$o.writeInt16=function(o$o){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,o$o,this._xd_),this._pos_+=2},o$o.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},o$o.writeUint8=function(o$o){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,o$o),this._pos_++},o$o._getUInt8=function(o$o){return this._d_.getUint8(o$o)},o$o._getUint16=function(o$o){return this._d_.getUint16(o$o,this._xd_)},o$o._getMatrix=function(){return new o$s(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},o$o.rUTF=function(o$o){for(var o$r=[],o$T=this._pos_+o$o,o$k=0,o$W=0,o$D=0,o$n=String.fromCharCode,o$V=this._u8d_;this._pos_<o$T;)(o$k=o$V[this._pos_++])<128?0!=o$k&&o$r.push(o$n(o$k)):o$k<224?o$r.push(o$n((63&o$k)<<6|127&o$V[this._pos_++])):o$k<240?(o$W=o$V[this._pos_++],o$r.push(o$n((31&o$k)<<12|(127&o$W)<<6|127&o$V[this._pos_++]))):(o$W=o$V[this._pos_++],o$D=o$V[this._pos_++],o$r.push(o$n((15&o$k)<<18|(127&o$W)<<12|o$D<<6&127|127&o$V[this._pos_++]))),0;return o$r.join("")},o$o.getCustomString=function(o$o){for(var o$r=[],o$T=0,o$k=0,o$W=0,o$D=String.fromCharCode,o$n=this._u8d_;0<o$o;)if((o$k=o$n[this._pos_])<128)o$r.push(o$D(o$k)),this._pos_++,o$o--;else for(o$T=o$k-128,this._pos_++,o$o-=o$T;0<o$T;)o$k=o$n[this._pos_++],o$W=o$n[this._pos_++],o$r.push(o$D(o$W<<8|o$k)),o$T--;return o$r.join("")},o$o.clear=function(){this._pos_=0,this.length=0},o$o.__getBuffer=function(){return this._d_.buffer},o$o.writeUTFBytes=function(o$o){for(var o$r=0,o$T=(o$o+="").length;o$r<o$T;o$r++){var o$k=o$o.charCodeAt(o$r);o$k<=127?this.writeByte(o$k):o$k<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|o$k>>6,128|63&o$k],this._pos_),this._pos_+=2):o$k<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|o$k>>12,128|o$k>>6&63,128|63&o$k],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|o$k>>18,128|o$k>>12&63,128|o$k>>6&63,128|63&o$k],this._pos_),this._pos_+=4)}},o$o.writeUTFString=function(o$o){var o$r=this.pos;this.writeUint16(1),this.writeUTFBytes(o$o);var o$T=this.pos-o$r-2;if(65536<=o$T)throw"writeUTFString byte len more than 65536";this._d_.setUint16(o$r,o$T,this._xd_)},o$o.readUTFString=function(){return this.readUTFBytes(this.getUint16())},o$o.getUTFString=function(){return this.readUTFString()},o$o.readUTFBytes=function(o$o){if(void 0===o$o&&(o$o=-1),0==o$o)return"";var o$r=this.bytesAvailable;if(o$r<o$o)throw"readUTFBytes error - Out of bounds";return o$o=0<o$o?o$o:o$r,this.rUTF(o$o)},o$o.getUTFBytes=function(o$o){return void 0===o$o&&(o$o=-1),this.readUTFBytes(o$o)},o$o.writeByte=function(o$o){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,o$o),this._pos_+=1},o$o.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},o$o.getByte=function(){return this.readByte()},o$o.ensureWrite=function(o$o){this._length<o$o&&(this._length=o$o),this._allocated_<o$o&&(this.length=o$o)},o$o.writeArrayBuffer=function(o$o,o$r,o$T){if(void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),o$r<0||o$T<0)throw"writeArrayBuffer error - Out of bounds";0==o$T&&(o$T=o$o.byteLength-o$r),this.ensureWrite(this._pos_+o$T);var o$k=new Uint8Array(o$o);this._u8d_.set(o$k.subarray(o$r,o$r+o$T),this._pos_),this._pos_+=o$T},o$x(0,o$o,"buffer",function(){var o$o=this._d_.buffer;return o$o.byteLength==this.length?o$o:o$o.slice(0,this.length)}),o$x(0,o$o,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(o$o){this._xd_="littleEndian"==o$o}),o$x(0,o$o,"length",function(){return this._length},function(o$o){this._allocated_<o$o?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(o$o,2*this._allocated_))):this._allocated_>o$o&&this.___resizeBuffer(this._allocated_=o$o),this._length=o$o}),o$x(0,o$o,"pos",function(){return this._pos_},function(o$o){this._pos_=o$o}),o$x(0,o$o,"bytesAvailable",function(){return this._length-this._pos_}),o$r.getSystemEndian=function(){if(!o$r._sysEndian){var o$o=new ArrayBuffer(2);new DataView(o$o).setInt16(0,256,!0),o$r._sysEndian=256===new Int16Array(o$o)[0]?"littleEndian":"bigEndian"}return o$r._sysEndian},o$r.BIG_ENDIAN="bigEndian",o$r.LITTLE_ENDIAN="littleEndian",o$r._sysEndian=null,o$r}(),o$Y=function(){function o$W(){}return o$h(o$W,"laya.utils.CacheManager"),o$W.regCacheByFunction=function(o$o,o$r){var o$T;o$W.unRegCacheByFunction(o$o,o$r),o$T={tryDispose:o$o,getCacheList:o$r},o$W._cacheList.push(o$T)},o$W.unRegCacheByFunction=function(o$o,o$r){var o$T,o$k=0;for(o$T=o$W._cacheList.length,o$k=0;o$k<o$T;o$k++)if(o$W._cacheList[o$k].tryDispose==o$o&&o$W._cacheList[o$k].getCacheList==o$r)return void o$W._cacheList.splice(o$k,1)},o$W.forceDispose=function(){var o$o=0,o$r=o$W._cacheList.length;for(o$o=0;o$o<o$r;o$o++)o$W._cacheList[o$o].tryDispose(!0)},o$W.beginCheck=function(o$o){void 0===o$o&&(o$o=15e3),o$b.timer.loop(o$o,null,o$W._checkLoop)},o$W.stopCheck=function(){o$b.timer.clear(null,o$W._checkLoop)},o$W._checkLoop=function(){var o$o=o$W._cacheList;if(!(o$o.length<1)){var o$r,o$T=o$e.now(),o$k=0;for(o$r=o$k=o$o.length;0<o$k&&(o$o[o$W._index=++o$W._index%o$r].tryDispose(!1),!(o$e.now()-o$T>o$W.loopTimeLimit));)o$k--}},o$W.loopTimeLimit=2,o$W._cacheList=[],o$W._index=0,o$W}(),o$A=function(){function o$v(){}return o$h(o$v,"laya.utils.ClassUtils"),o$v.regClass=function(o$o,o$r){o$v._classMap[o$o]=o$r},o$v.getRegClass=function(o$o){return o$v._classMap[o$o]},o$v.getInstance=function(o$o){var o$r=o$v.getClass(o$o);return o$r?new o$r:(console.warn("[error] Undefined class:",o$o),null)},o$v.createByJson=function(o$o,o$r,o$T,o$k,o$W){"string"==typeof o$o&&(o$o=JSON.parse(o$o));var o$D=o$o.props;if(!o$r&&!(o$r=o$W?o$W.runWith(o$o):o$v.getInstance(o$D.runtime||o$o.type)))return null;var o$n=o$o.child;if(o$n)for(var o$V=0,o$L=o$n.length;o$V<o$L;o$V++){var o$U=o$n[o$V];if("render"!==o$U.props.name&&"render"!==o$U.props.renderType||!o$r._$set_itemRender)if("Graphic"==o$U.type)o$v.addGraphicsToSprite(o$U,o$r);else if(o$v.isDrawType(o$U.type))o$v.addGraphicToSprite(o$U,o$r,!0);else{var o$h=o$v.createByJson(o$U,null,o$T,o$k,o$W);"Script"==o$U.type?o$h.hasOwnProperty("owner")?o$h.owner=o$r:o$h.hasOwnProperty("target")&&(o$h.target=o$r):"mask"==o$U.props.renderType?o$r.mask=o$h:o$r.addChild(o$h)}else o$r.itemRender=o$U}if(o$D)for(var o$p in o$D){var o$i=o$D[o$p];"var"===o$p&&o$T?o$T[o$i]=o$r:o$i instanceof Array&&"function"==typeof o$r[o$p]?o$r[o$p].apply(o$r,o$i):o$r[o$p]=o$i}return o$k&&o$o.customProps&&o$k.runWith([o$r,o$o]),o$r.created&&o$r.created(),o$r},o$v.addGraphicsToSprite=function(o$o,o$r){var o$T;if((o$T=o$o.child)&&!(o$T.length<1)){var o$k;o$k=o$v._getGraphicsFromSprite(o$o,o$r);var o$W=0,o$D=0;o$o.props&&(o$W=o$v._getObjVar(o$o.props,"x",0),o$D=o$v._getObjVar(o$o.props,"y",0)),0!=o$W&&0!=o$D&&o$k.translate(o$W,o$D);var o$n,o$V=0;for(o$n=o$T.length,o$V=0;o$V<o$n;o$V++)o$v._addGraphicToGraphics(o$T[o$V],o$k);0!=o$W&&0!=o$D&&o$k.translate(-o$W,-o$D)}},o$v.addGraphicToSprite=function(o$o,o$r,o$T){var o$k;void 0===o$T&&(o$T=!1),o$k=o$T?o$v._getGraphicsFromSprite(o$o,o$r):o$r.graphics,o$v._addGraphicToGraphics(o$o,o$k)},o$v._getGraphicsFromSprite=function(o$o,o$r){var o$T,o$k;if(!o$o||!o$o.props)return o$r.graphics;switch(o$k=o$o.props.renderType){case"hit":case"unHit":var o$W;o$r.hitArea||(o$r.hitArea=new o$a),(o$W=o$r.hitArea)[o$k]||(o$W[o$k]=new o$i),o$T=o$W[o$k]}return o$T||(o$T=o$r.graphics),o$T},o$v._getTransformData=function(o$o){var o$r;(o$o.hasOwnProperty("pivotX")||o$o.hasOwnProperty("pivotY"))&&(o$r=o$r||new o$s).translate(-o$v._getObjVar(o$o,"pivotX",0),-o$v._getObjVar(o$o,"pivotY",0));var o$T=o$v._getObjVar(o$o,"scaleX",1),o$k=o$v._getObjVar(o$o,"scaleY",1),o$W=o$v._getObjVar(o$o,"rotation",0);o$v._getObjVar(o$o,"skewX",0),o$v._getObjVar(o$o,"skewY",0);return 1==o$T&&1==o$k&&0==o$W||((o$r=o$r||new o$s).scale(o$T,o$k),o$r.rotate(.0174532922222222*o$W)),o$r},o$v._addGraphicToGraphics=function(o$o,o$r){var o$T,o$k;if((o$T=o$o.props)&&(o$k=o$v.DrawTypeDic[o$o.type])){var o$W,o$D;o$W=o$r;var o$n=o$v._getParams(o$T,o$k[1],o$k[2],o$k[3]);((o$D=o$v._tM)||1!=o$v._alpha)&&(o$W.save(),o$D&&o$W.transform(o$D),1!=o$v._alpha&&o$W.alpha(o$v._alpha)),o$W[o$k[0]].apply(o$W,o$n),(o$D||1!=o$v._alpha)&&o$W.restore()}},o$v._adptLineData=function(o$o){return o$o[2]=parseFloat(o$o[0])+parseFloat(o$o[2]),o$o[3]=parseFloat(o$o[1])+parseFloat(o$o[3]),o$o},o$v._adptTextureData=function(o$o){return o$o[0]=o$Vo.getRes(o$o[0]),o$o},o$v._adptLinesData=function(o$o){return o$o[2]=o$v._getPointListByStr(o$o[2]),o$o},o$v.isDrawType=function(o$o){return"Image"!=o$o&&o$v.DrawTypeDic.hasOwnProperty(o$o)},o$v._getParams=function(o$o,o$r,o$T,o$k){var o$W;void 0===o$T&&(o$T=0),(o$W=o$v._temParam).length=o$r.length;var o$D,o$n,o$V=0;for(o$D=o$r.length,o$V=0;o$V<o$D;o$V++)o$W[o$V]=o$v._getObjVar(o$o,o$r[o$V][0],o$r[o$V][1]);return o$v._alpha=o$v._getObjVar(o$o,"alpha",1),o$n=o$v._getTransformData(o$o),o$v._tM=o$n?(o$T||(o$T=0),o$n.translate(o$W[o$T],o$W[o$T+1]),o$W[o$T]=o$W[o$T+1]=0,o$n):null,o$k&&o$v[o$k]&&(o$W=o$v[o$k](o$W)),o$W},o$v._getPointListByStr=function(o$o){var o$r,o$T,o$k=0;for(o$T=(o$r=o$o.split(",")).length,o$k=0;o$k<o$T;o$k++)o$r[o$k]=parseFloat(o$r[o$k]);return o$r},o$v._getObjVar=function(o$o,o$r,o$T){return o$o.hasOwnProperty(o$r)?o$o[o$r]:o$T},o$v._temParam=[],o$v._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},o$v.getClass=function(o$o){var o$r=o$v._classMap[o$o]||o$o;return"string"==typeof o$r?o$b.__classmap[o$r]:o$r},o$v._tM=null,o$v._alpha=NaN,o$L(o$v,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),o$v}(),o$I=function(){function o$D(o$o){if(this._color=[],"string"==typeof o$o){null===(this.strColor=o$o)&&(o$o="#000000"),"#"==o$o.charAt(0)&&(o$o=o$o.substr(1));var o$r=o$o.length;if(3==o$r||4==o$r){for(var o$T="",o$k=0;o$k<o$r;o$k++)o$T+=o$o[o$k]+o$o[o$k];o$o=o$T}var o$W=this.numColor=parseInt(o$o,16);if(8==o$o.length)return void(this._color=[parseInt(o$o.substr(0,2),16)/255,((16711680&o$W)>>16)/255,((65280&o$W)>>8)/255,(255&o$W)/255])}else o$W=this.numColor=o$o,this.strColor=o$g.toHexColor(o$W);this._color=[((16711680&o$W)>>16)/255,((65280&o$W)>>8)/255,(255&o$W)/255,1],this._color.__id=++o$D._COLODID}return o$h(o$D,"laya.utils.Color"),o$D._initDefault=function(){for(var o$o in o$D._DEFAULT={},o$D._COLOR_MAP)o$D._SAVE[o$o]=o$D._DEFAULT[o$o]=new o$D(o$D._COLOR_MAP[o$o]);return o$D._DEFAULT},o$D._initSaveMap=function(){for(var o$o in o$D._SAVE_SIZE=0,o$D._SAVE={},o$D._DEFAULT)o$D._SAVE[o$o]=o$D._DEFAULT[o$o]},o$D.create=function(o$o){var o$r=o$D._SAVE[o$o+""];return null!=o$r?o$r:(o$D._SAVE_SIZE<1e3||o$D._initSaveMap(),o$D._SAVE[o$o+""]=new o$D(o$o))},o$D._SAVE={},o$D._SAVE_SIZE=0,o$D._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},o$D._DEFAULT=o$D._initDefault(),o$D._COLODID=1,o$D}(),o$N=(function(){function o$o(){this._values=[],this._keys=[]}o$h(o$o,"laya.utils.Dictionary");var o$r=o$o.prototype;o$r.set=function(o$o,o$r){var o$T=this.indexOf(o$o);0<=o$T?this._values[o$T]=o$r:(this._keys.push(o$o),this._values.push(o$r))},o$r.indexOf=function(o$o){var o$r=this._keys.indexOf(o$o);return 0<=o$r?o$r:(o$o="string"==typeof o$o?Number(o$o):"number"==typeof o$o?o$o.toString():o$o,this._keys.indexOf(o$o))},o$r.get=function(o$o){var o$r=this.indexOf(o$o);return o$r<0?null:this._values[o$r]},o$r.remove=function(o$o){var o$r=this.indexOf(o$o);return 0<=o$r&&(this._keys.splice(o$r,1),this._values.splice(o$r,1),!0)},o$r.clear=function(){this._values.length=0,this._keys.length=0},o$x(0,o$r,"values",function(){return this._values}),o$x(0,o$r,"keys",function(){return this._keys})}(),function(){function o$o(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}o$h(o$o,"laya.utils.Dragging");var o$r=o$o.prototype;return o$r.start=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){void 0===o$V&&(o$V=.92),this.clearTimer(),this.target=o$o,this.area=o$r,this.hasInertia=o$T,this.elasticDistance=o$r?o$k:0,this.elasticBackTime=o$W,this.data=o$D,this._disableMouseEvent=o$n,this.ratio=o$V,1!=o$o.globalScaleX||1!=o$o.globalScaleY?this._parent=o$o.parent:this._parent=o$b.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,o$b.stage.on("mouseup",this,this.onStageMouseUp),o$b.stage.on("mouseout",this,this.onStageMouseUp),o$b.timer.frameLoop(1,this,this.loop)},o$r.clearTimer=function(){o$b.timer.clear(this,this.loop),o$b.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},o$r.stop=function(){this._dragging&&(o$j.instance.disableMouseEvent=!1,o$b.stage.off("mouseup",this,this.onStageMouseUp),o$b.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},o$r.loop=function(){var o$o=this._parent.getMousePoint(),o$r=o$o.x,o$T=o$o.y,o$k=o$r-this._lastX,o$W=o$T-this._lastY;if(this._clickOnly){if(!(1<Math.abs(o$k*o$b.stage._canvasTransform.getScaleX())||1<Math.abs(o$W*o$b.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),o$j.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(o$k,o$W);0==o$k&&0==o$W||(this._lastX=o$r,this._lastY=o$T,this.target.x+=o$k*this._elasticRateX,this.target.y+=o$W*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},o$r.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var o$o=this.area.x-this.target.x;else o$o=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-o$o/this.elasticDistance),this.target.y<this.area.y)var o$r=this.area.y-this.target.y;else o$r=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-o$r/this.elasticDistance)}},o$r.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},o$r.onStageMouseUp=function(o$o){if(o$j.instance.disableMouseEvent=!1,o$b.stage.off("mouseup",this,this.onStageMouseUp),o$b.stage.off("mouseout",this,this.onStageMouseUp),o$b.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var o$r=this._offsets.length,o$T=Math.min(o$r,6),o$k=this._offsets.length-o$T,o$W=o$r-1;o$k<o$W;o$W--)this._offsetY+=this._offsets[o$W--],this._offsetX+=this._offsets[o$W];this._offsetX=this._offsetX/o$T*2,this._offsetY=this._offsetY/o$T*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),o$b.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},o$r.checkElastic=function(){var o$o=NaN,o$r=NaN;if(this.target.x<this.area.x?o$o=this.area.x:this.target.x>this.area.x+this.area.width&&(o$o=this.area.x+this.area.width),this.target.y<this.area.y?o$r=this.area.y:this.target.y>this.area.y+this.area.height&&(o$r=this.area.y+this.area.height),isNaN(o$o)&&isNaN(o$r))this.clear();else{var o$T={};isNaN(o$o)||(o$T.x=o$o),isNaN(o$r)||(o$T.y=o$r),this._tween=o$Q.to(this.target,o$T,this.elasticBackTime,o$f.sineOut,o$$.create(this,this.clear),0,!1,!1)}},o$r.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(o$b.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},o$r.clear=function(){if(this.target){this.clearTimer();var o$o=this.target;this.target=null,this._parent=null,o$o.event("dragend",this.data)}},o$o}()),o$f=function(){function o$V(){}return o$h(o$V,"laya.utils.Ease"),o$V.linearNone=function(o$o,o$r,o$T,o$k){return o$T*o$o/o$k+o$r},o$V.linearIn=function(o$o,o$r,o$T,o$k){return o$T*o$o/o$k+o$r},o$V.linearInOut=function(o$o,o$r,o$T,o$k){return o$T*o$o/o$k+o$r},o$V.linearOut=function(o$o,o$r,o$T,o$k){return o$T*o$o/o$k+o$r},o$V.bounceIn=function(o$o,o$r,o$T,o$k){return o$T-o$V.bounceOut(o$k-o$o,0,o$T,o$k)+o$r},o$V.bounceInOut=function(o$o,o$r,o$T,o$k){return o$o<.5*o$k?.5*o$V.bounceIn(2*o$o,0,o$T,o$k)+o$r:.5*o$V.bounceOut(2*o$o-o$k,0,o$T,o$k)+.5*o$T+o$r},o$V.bounceOut=function(o$o,o$r,o$T,o$k){return(o$o/=o$k)<1/2.75?o$T*(7.5625*o$o*o$o)+o$r:o$o<2/2.75?o$T*(7.5625*(o$o-=1.5/2.75)*o$o+.75)+o$r:o$o<2.5/2.75?o$T*(7.5625*(o$o-=2.25/2.75)*o$o+.9375)+o$r:o$T*(7.5625*(o$o-=2.625/2.75)*o$o+.984375)+o$r},o$V.backIn=function(o$o,o$r,o$T,o$k,o$W){return void 0===o$W&&(o$W=1.70158),o$T*(o$o/=o$k)*o$o*((o$W+1)*o$o-o$W)+o$r},o$V.backInOut=function(o$o,o$r,o$T,o$k,o$W){return void 0===o$W&&(o$W=1.70158),(o$o/=.5*o$k)<1?.5*o$T*(o$o*o$o*((1+(o$W*=1.525))*o$o-o$W))+o$r:o$T/2*((o$o-=2)*o$o*((1+(o$W*=1.525))*o$o+o$W)+2)+o$r},o$V.backOut=function(o$o,o$r,o$T,o$k,o$W){return void 0===o$W&&(o$W=1.70158),o$T*((o$o=o$o/o$k-1)*o$o*((o$W+1)*o$o+o$W)+1)+o$r},o$V.elasticIn=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n;return void 0===o$W&&(o$W=0),void 0===o$D&&(o$D=0),0==o$o?o$r:1==(o$o/=o$k)?o$r+o$T:(o$D||(o$D=.3*o$k),o$n=!o$W||0<o$T&&o$W<o$T||o$T<0&&o$W<-o$T?(o$W=o$T,o$D/4):o$D/o$V.PI2*Math.asin(o$T/o$W),-o$W*Math.pow(2,10*(o$o-=1))*Math.sin((o$o*o$k-o$n)*o$V.PI2/o$D)+o$r)},o$V.elasticInOut=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n;return void 0===o$W&&(o$W=0),void 0===o$D&&(o$D=0),0==o$o?o$r:2==(o$o/=.5*o$k)?o$r+o$T:(o$D||(o$D=o$k*(.3*1.5)),o$n=!o$W||0<o$T&&o$W<o$T||o$T<0&&o$W<-o$T?(o$W=o$T,o$D/4):o$D/o$V.PI2*Math.asin(o$T/o$W),o$o<1?o$W*Math.pow(2,10*(o$o-=1))*Math.sin((o$o*o$k-o$n)*o$V.PI2/o$D)*-.5+o$r:o$W*Math.pow(2,-10*(o$o-=1))*Math.sin((o$o*o$k-o$n)*o$V.PI2/o$D)*.5+o$T+o$r)},o$V.elasticOut=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n;return void 0===o$W&&(o$W=0),void 0===o$D&&(o$D=0),0==o$o?o$r:1==(o$o/=o$k)?o$r+o$T:(o$D||(o$D=.3*o$k),o$n=!o$W||0<o$T&&o$W<o$T||o$T<0&&o$W<-o$T?(o$W=o$T,o$D/4):o$D/o$V.PI2*Math.asin(o$T/o$W),o$W*Math.pow(2,-10*o$o)*Math.sin((o$o*o$k-o$n)*o$V.PI2/o$D)+o$T+o$r)},o$V.strongIn=function(o$o,o$r,o$T,o$k){return o$T*(o$o/=o$k)*o$o*o$o*o$o*o$o+o$r},o$V.strongInOut=function(o$o,o$r,o$T,o$k){return(o$o/=.5*o$k)<1?.5*o$T*o$o*o$o*o$o*o$o*o$o+o$r:.5*o$T*((o$o-=2)*o$o*o$o*o$o*o$o+2)+o$r},o$V.strongOut=function(o$o,o$r,o$T,o$k){return o$T*((o$o=o$o/o$k-1)*o$o*o$o*o$o*o$o+1)+o$r},o$V.sineInOut=function(o$o,o$r,o$T,o$k){return.5*-o$T*(Math.cos(Math.PI*o$o/o$k)-1)+o$r},o$V.sineIn=function(o$o,o$r,o$T,o$k){return-o$T*Math.cos(o$o/o$k*o$V.HALF_PI)+o$T+o$r},o$V.sineOut=function(o$o,o$r,o$T,o$k){return o$T*Math.sin(o$o/o$k*o$V.HALF_PI)+o$r},o$V.quintIn=function(o$o,o$r,o$T,o$k){return o$T*(o$o/=o$k)*o$o*o$o*o$o*o$o+o$r},o$V.quintInOut=function(o$o,o$r,o$T,o$k){return(o$o/=.5*o$k)<1?.5*o$T*o$o*o$o*o$o*o$o*o$o+o$r:.5*o$T*((o$o-=2)*o$o*o$o*o$o*o$o+2)+o$r},o$V.quintOut=function(o$o,o$r,o$T,o$k){return o$T*((o$o=o$o/o$k-1)*o$o*o$o*o$o*o$o+1)+o$r},o$V.quartIn=function(o$o,o$r,o$T,o$k){return o$T*(o$o/=o$k)*o$o*o$o*o$o+o$r},o$V.quartInOut=function(o$o,o$r,o$T,o$k){return(o$o/=.5*o$k)<1?.5*o$T*o$o*o$o*o$o*o$o+o$r:.5*-o$T*((o$o-=2)*o$o*o$o*o$o-2)+o$r},o$V.quartOut=function(o$o,o$r,o$T,o$k){return-o$T*((o$o=o$o/o$k-1)*o$o*o$o*o$o-1)+o$r},o$V.cubicIn=function(o$o,o$r,o$T,o$k){return o$T*(o$o/=o$k)*o$o*o$o+o$r},o$V.cubicInOut=function(o$o,o$r,o$T,o$k){return(o$o/=.5*o$k)<1?.5*o$T*o$o*o$o*o$o+o$r:.5*o$T*((o$o-=2)*o$o*o$o+2)+o$r},o$V.cubicOut=function(o$o,o$r,o$T,o$k){return o$T*((o$o=o$o/o$k-1)*o$o*o$o+1)+o$r},o$V.quadIn=function(o$o,o$r,o$T,o$k){return o$T*(o$o/=o$k)*o$o+o$r},o$V.quadInOut=function(o$o,o$r,o$T,o$k){return(o$o/=.5*o$k)<1?.5*o$T*o$o*o$o+o$r:.5*-o$T*(--o$o*(o$o-2)-1)+o$r},o$V.quadOut=function(o$o,o$r,o$T,o$k){return-o$T*(o$o/=o$k)*(o$o-2)+o$r},o$V.expoIn=function(o$o,o$r,o$T,o$k){return 0==o$o?o$r:o$T*Math.pow(2,10*(o$o/o$k-1))+o$r-.001*o$T},o$V.expoInOut=function(o$o,o$r,o$T,o$k){return 0==o$o?o$r:o$o==o$k?o$r+o$T:(o$o/=.5*o$k)<1?.5*o$T*Math.pow(2,10*(o$o-1))+o$r:.5*o$T*(2-Math.pow(2,-10*--o$o))+o$r},o$V.expoOut=function(o$o,o$r,o$T,o$k){return o$o==o$k?o$r+o$T:o$T*(1-Math.pow(2,-10*o$o/o$k))+o$r},o$V.circIn=function(o$o,o$r,o$T,o$k){return-o$T*(Math.sqrt(1-(o$o/=o$k)*o$o)-1)+o$r},o$V.circInOut=function(o$o,o$r,o$T,o$k){return(o$o/=.5*o$k)<1?.5*-o$T*(Math.sqrt(1-o$o*o$o)-1)+o$r:.5*o$T*(Math.sqrt(1-(o$o-=2)*o$o)+1)+o$r},o$V.circOut=function(o$o,o$r,o$T,o$k){return o$T*Math.sqrt(1-(o$o=o$o/o$k-1)*o$o)+o$r},o$V.HALF_PI=.5*Math.PI,o$V.PI2=2*Math.PI,o$V}(),o$a=function(){function o$p(){this._hit=null,this._unHit=null}o$h(o$p,"laya.utils.HitArea");var o$o=o$p.prototype;return o$o.isHit=function(o$o,o$r){return!!o$p.isHitGraphic(o$o,o$r,this.hit)&&!o$p.isHitGraphic(o$o,o$r,this.unHit)},o$o.contains=function(o$o,o$r){return this.isHit(o$o,o$r)},o$x(0,o$o,"hit",function(){return this._hit||(this._hit=new o$i),this._hit},function(o$o){this._hit=o$o}),o$x(0,o$o,"unHit",function(){return this._unHit||(this._unHit=new o$i),this._unHit},function(o$o){this._unHit=o$o}),o$p.isHitGraphic=function(o$o,o$r,o$T){if(!o$T)return!1;var o$k;if(!(o$k=o$T.cmds)&&o$T._one&&((o$k=o$p._cmds).length=1,o$k[0]=o$T._one),!o$k)return!1;var o$W,o$D,o$n=0;for(o$W=o$k.length,o$n=0;o$n<o$W;o$n++)if(o$D=o$k[o$n]){var o$V=o$C._context;switch(o$D.callee){case o$V._translate:case 6:o$o-=o$D[0],o$r-=o$D[1]}if(o$p.isHitCmd(o$o,o$r,o$D))return!0}return!1},o$p.isHitCmd=function(o$o,o$r,o$T){if(!o$T)return!1;var o$k=o$C._context,o$W=!1;switch(o$T.callee){case o$k._drawRect:case 13:o$p._rec.setTo(o$T[0],o$T[1],o$T[2],o$T[3]),o$W=o$p._rec.contains(o$o,o$r);break;case o$k._drawCircle:case o$k._fillCircle:case 14:o$W=(o$o-=o$T[0])*o$o+(o$r-=o$T[1])*o$r<o$T[2]*o$T[2];break;case o$k._drawPoly:case 18:o$o-=o$T[0],o$r-=o$T[1],o$W=o$p.ptInPolygon(o$o,o$r,o$T[2])}return o$W},o$p.ptInPolygon=function(o$o,o$r,o$T){var o$k;(o$k=o$p._ptPoint).setTo(o$o,o$r);var o$W,o$D=0,o$n=NaN,o$V=NaN,o$L=NaN,o$U=NaN;o$W=o$T.length;for(var o$h=0;o$h<o$W;o$h+=2){if(o$n=o$T[o$h],o$V=o$T[o$h+1],o$L=o$T[(o$h+2)%o$W],o$V!=(o$U=o$T[(o$h+3)%o$W]))if(!(o$k.y<Math.min(o$V,o$U)))if(!(o$k.y>=Math.max(o$V,o$U)))(o$k.y-o$V)*(o$L-o$n)/(o$U-o$V)+o$n>o$k.x&&o$D++}return o$D%2==1},o$p._cmds=[],o$L(o$p,["_rec",function(){return this._rec=new o$P},"_ptPoint",function(){return this._ptPoint=new o$F}]),o$p}(),o$G=(function(){function o$W(o$o,o$r,o$T,o$k){this.char=o$o,this.charNum=o$o.charCodeAt(0),this._x=this._y=0,this.width=o$r,this.height=o$T,this.style=o$k,this.isWord=!o$W._isWordRegExp.test(o$o)}o$h(o$W,"laya.utils.HTMLChar");var o$o=o$W.prototype;o$b.imps(o$o,{"laya.display.ILayout":!0}),o$o.setSprite=function(o$o){this._sprite=o$o},o$o.getSprite=function(){return this._sprite},o$o._isChar=function(){return!0},o$o._getCSSStyle=function(){return this.style},o$x(0,o$o,"width",function(){return this._w},function(o$o){this._w=o$o}),o$x(0,o$o,"x",function(){return this._x},function(o$o){this._sprite&&(this._sprite.x=o$o),this._x=o$o}),o$x(0,o$o,"y",function(){return this._y},function(o$o){this._sprite&&(this._sprite.y=o$o),this._y=o$o}),o$x(0,o$o,"height",function(){return this._h},function(o$o){this._h=o$o}),o$W._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function o$r(){}o$h(o$r,"laya.utils.Log"),o$r.enable=function(){o$r._logdiv||(o$r._logdiv=o$e.window.document.createElement("div"),o$e.window.document.body.appendChild(o$r._logdiv),o$r._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},o$r.toggle=function(){var o$o=o$r._logdiv.style;"1px"==o$o.width?o$o.width=o$o.height="50%":o$o.width=o$o.height="1px"},o$r.print=function(o$o){o$r._logdiv&&(o$r.maxCount<=o$r._count&&o$r.clear(),o$r._count++,o$r._logdiv.innerText+=o$o+"\n",o$r._logdiv.scrollTop=o$r._logdiv.scrollHeight)},o$r.clear=function(){o$r._logdiv.innerText="",o$r._count=0},o$r._logdiv=null,o$r._count=0,o$r.maxCount=20}(),function(){function o$r(){}o$h(o$r,"laya.utils.Mouse"),o$x(1,o$r,"cursor",function(){return o$r._style.cursor},function(o$o){o$r._style.cursor=o$o}),o$r.hide=function(){"none"!=o$r.cursor&&(o$r._preCursor=o$r.cursor,o$r.cursor="none")},o$r.show=function(){"none"==o$r.cursor&&(o$r.cursor=o$r._preCursor?o$r._preCursor:"auto")},o$r._preCursor=null,o$L(o$r,["_style",function(){return this._style=o$e.document.body.style}])}(),function(){function o$D(){}return o$h(o$D,"laya.utils.Pool"),o$D.getPoolBySign=function(o$o){return o$D._poolDic[o$o]||(o$D._poolDic[o$o]=[])},o$D.clearBySign=function(o$o){o$D._poolDic[o$o]&&(o$D._poolDic[o$o].length=0)},o$D.recover=function(o$o,o$r){o$r.__InPool||(o$r.__InPool=!0,o$D.getPoolBySign(o$o).push(o$r))},o$D.getItemByClass=function(o$o,o$r){var o$T=o$D.getPoolBySign(o$o),o$k=o$T.length?o$T.pop():new o$r;return o$k.__InPool=!1,o$k},o$D.getItemByCreateFun=function(o$o,o$r,o$T){var o$k=o$D.getPoolBySign(o$o),o$W=o$k.length?o$k.pop():o$r.call(o$T);return o$W.__InPool=!1,o$W},o$D.getItem=function(o$o){var o$r=o$D.getPoolBySign(o$o),o$T=o$r.length?o$r.pop():null;return o$T&&(o$T.__InPool=!1),o$T},o$D._poolDic={},o$D.InPoolSign="__InPool",o$D}()),o$w=function(){function o$L(){}return o$h(o$L,"laya.utils.Stat"),o$x(1,o$L,"onclick",null,function(o$o){o$L._sp&&o$L._sp.on("click",o$L._sp,o$o),o$L._canvas&&(o$L._canvas.source.onclick=o$o,o$L._canvas.source.style.pointerEvents="")}),o$L.show=function(o$o,o$r,o$T){if(void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),!o$C.isConchApp||o$C.isConchWebGL){if(o$C.isConchWebGL||o$e.onMiniGame||o$e.onLimixiu||(o$L._useCanvas=!0),o$L._show=!0,o$L._fpsData.length=60,o$L._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},o$L._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},o$L._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},o$L._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},o$C.isWebGL)if(o$L._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},o$C.is3DMode){if(o$L._view[0].title="FPS(3D)",o$L._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},o$L._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},o$L._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==o$T){var o$k=8;o$L._view[o$k++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},o$L._view[o$k++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},o$L._view[o$k++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},o$L._view[o$k++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},o$L._view[o$k++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},o$L._view[o$k++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},o$L._view[o$k++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},o$L._view[o$k++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},o$L._view[o$k++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==o$T){o$k=8;o$L._view[o$k++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},o$L._view[o$k++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},o$L._view[o$k++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},o$L._view[o$k++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},o$L._view[o$k++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},o$L._view[o$k++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},o$L._view[o$k++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else o$L._view[0].title="FPS(WebGL)",o$L._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else o$L._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};o$L._useCanvas?o$L.createUIPre(o$o,o$r):o$L.createUI(o$o,o$r),o$L.enable()}else o$e.window.conch.showFPS&&o$e.window.conch.showFPS(o$o,o$r)},o$L.createUIPre=function(o$o,o$r){var o$T=o$e.pixelRatio;o$L._width=170*o$T,o$L._vx=75*o$T,o$L._height=o$T*(12*o$L._view.length+3*o$T)+4,o$L._fontSize=12*o$T;for(var o$k=0;o$k<o$L._view.length;o$k++)o$L._view[o$k].x=4,o$L._view[o$k].y=o$k*o$L._fontSize+2*o$T;o$L._canvas||((o$L._canvas=new o$yo("2D")).size(o$L._width,o$L._height),(o$L._ctx=o$L._canvas.getContext("2d")).textBaseline="top",o$L._ctx.font=o$L._fontSize+"px Sans-serif",o$L._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+o$o+"px;top:"+o$r+"px;width:"+o$L._width/o$T+"px;height:"+o$L._height/o$T+"px;"),o$L._first=!0,o$L.loop(),o$L._first=!1,o$e.container.appendChild(o$L._canvas.source)},o$L.createUI=function(o$o,o$r){var o$T=o$L._sp,o$k=o$e.pixelRatio;o$T||(o$T=new o$po,(o$L._leftText=new o$_o).pos(5,5),o$L._leftText.color="#ffffff",o$T.addChild(o$L._leftText),(o$L._txt=new o$_o).pos(80*o$k,5),o$L._txt.color="#ffffff",o$T.addChild(o$L._txt),o$L._sp=o$T),o$T.pos(o$o,o$r);for(var o$W="",o$D=0;o$D<o$L._view.length;o$D++){o$W+=o$L._view[o$D].title+"\n"}o$L._leftText.text=o$W;var o$n=170*o$k,o$V=o$k*(12*o$L._view.length+3*o$k)+4;o$L._txt.fontSize=o$L._fontSize*o$k,o$L._leftText.fontSize=o$L._fontSize*o$k,o$T.size(o$n,o$V),o$T.graphics.clear(),o$T.graphics.setAlpha(.5),o$T.graphics.drawRect(0,0,o$n,o$V,"#999999"),o$T.graphics.setAlpha(1),o$L.loop()},o$L.enable=function(){o$b.timer.frameLoop(1,o$L,o$L.loop)},o$L.hide=function(){o$L._show=!1,o$b.timer.clear(o$L,o$L.loop),o$L._canvas&&o$e.removeElement(o$L._canvas.source)},o$L.clear=function(){o$L.trianglesFaces=o$L.drawCall=o$L.shaderCall=o$L.spriteCount=o$L.spriteRenderUseCacheCount=o$L.treeNodeCollision=o$L.treeSpriteCollision=o$L.canvasNormal=o$L.canvasBitmap=o$L.canvasReCache=0},o$L.loop=function(){o$L._count++;var o$o=o$e.now();if(!(o$o-o$L._timer<1e3)){var o$r=o$L._count;if(o$L.FPS=Math.round(1e3*o$r/(o$o-o$L._timer)),o$L._show){o$L.trianglesFaces=Math.round(o$L.trianglesFaces/o$r),o$L.spriteCount=o$L._useCanvas?(o$L.drawCall=Math.round(o$L.drawCall/o$r)-2,o$L.shaderCall=Math.round(o$L.shaderCall/o$r),Math.round(o$L.spriteCount/o$r)-1):(o$L.drawCall=Math.round(o$L.drawCall/o$r)-2,o$L.shaderCall=Math.round(o$L.shaderCall/o$r)-4,Math.round(o$L.spriteCount/o$r)-4),o$L.spriteRenderUseCacheCount=Math.round(o$L.spriteRenderUseCacheCount/o$r),o$L.canvasNormal=Math.round(o$L.canvasNormal/o$r),o$L.canvasBitmap=Math.round(o$L.canvasBitmap/o$r),o$L.canvasReCache=Math.ceil(o$L.canvasReCache/o$r),o$L.treeNodeCollision=Math.round(o$L.treeNodeCollision/o$r),o$L.treeSpriteCollision=Math.round(o$L.treeSpriteCollision/o$r);var o$T=0<o$L.FPS?Math.floor(1e3/o$L.FPS).toString():" ";o$L._fpsStr=o$L.FPS+(o$L.renderSlow?" slow":"")+" "+o$T,o$L._spriteStr=o$L.spriteCount+(o$L.spriteRenderUseCacheCount?"/"+o$L.spriteRenderUseCacheCount:""),o$L._canvasStr=o$L.canvasReCache+"/"+o$L.canvasNormal+"/"+o$L.canvasBitmap,o$L.currentMemorySize=o$c.systemResourceManager.memorySize,o$L._useCanvas?o$L.renderInfoPre():o$L.renderInfo(),o$L.clear()}o$L._count=0,o$L._timer=o$o}},o$L.renderInfoPre=function(){if(o$L._canvas){var o$o=o$L._ctx;o$o.clearRect(o$L._first?0:o$L._vx,0,o$L._width,o$L._height);for(var o$r=o$C.WebGL.mainContext,o$T=0;o$T<o$L._view.length;o$T++){var o$k=o$L._view[o$T];o$L._first&&(o$o.fillStyle="white",o$o.fillText(o$k.title,o$k.x,o$k.y,null,null,null)),o$o.fillStyle=o$k.color;var o$W=-1;if((o$k=o$L._view[o$T]).varying){if(o$r)switch(o$k.varying){case 1:o$W=o$r.getParameter(o$r[o$k.value]);break;case 2:o$W=o$r.getExtension(o$k.value)}}else o$W=o$L[o$k.value];"M"==o$k.units&&(o$W=Math.floor(o$W/1048576*100)/100+" M"),"K"==o$k.units&&(o$W=Math.floor(o$W/1024*100)/100+" K"),"string"==o$k.units&&(o$W=o$W.match(/\d+\.?\d/i)),o$o.fillText(o$W+"",o$k.x+o$L._vx,o$k.y,null,null,null)}}},o$L.renderInfo=function(){for(var o$o="",o$r=o$C.WebGL.mainContext,o$T=0;o$T<o$L._view.length;o$T++){var o$k=o$L._view[o$T],o$W=-1;if(o$k.varying){if(o$r)switch(o$k.varying){case 1:o$W=o$r.getParameter(o$r[o$k.value]);break;case 2:o$W=o$r.getExtension(o$k.value)}}else o$W=o$L[o$k.value];"M"==o$k.units&&(o$W=Math.floor(o$W/1048576*100)/100+" M"),"K"==o$k.units&&(o$W=Math.floor(o$W/1024*100)/100+" K"),"string"==o$k.units&&(o$W=o$W.match(/\d+\.?\d/i)),o$o+=o$W+"\n"}o$L._txt.text=o$o},o$L.FPS=0,o$L.loopCount=0,o$L.shaderCall=0,o$L.drawCall=0,o$L.trianglesFaces=0,o$L.spriteCount=0,o$L.spriteRenderUseCacheCount=0,o$L.treeNodeCollision=0,o$L.treeSpriteCollision=0,o$L.canvasNormal=0,o$L.canvasBitmap=0,o$L.canvasReCache=0,o$L.renderSlow=!1,o$L.currentMemorySize=0,o$L._fpsStr=null,o$L._canvasStr=null,o$L._spriteStr=null,o$L._fpsData=[],o$L._timer=0,o$L._count=0,o$L._view=[],o$L._fontSize=12,o$L._txt=null,o$L._leftText=null,o$L._sp=null,o$L._show=!1,o$L._useCanvas=!1,o$L._canvas=null,o$L._ctx=null,o$L._first=!1,o$L._vx=NaN,o$L._width=0,o$L._height=100,o$L}(),o$Z=(function(){function o$o(){this._strsToID={},this._idToStrs=[],this._length=0}o$h(o$o,"laya.utils.StringKey");var o$r=o$o.prototype;o$r.add=function(o$o){var o$r=this._strsToID[o$o];return null!=o$r?o$r:(this._idToStrs[this._length]=o$o,this._strsToID[o$o]=this._length++)},o$r.getID=function(o$o){var o$r=this._strsToID[o$o];return null==o$r?-1:o$r},o$r.getName=function(o$o){var o$r=this._idToStrs[o$o];return null==o$r?void 0:o$r}}(),function(){var o$U;function o$o(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}o$h(o$o,"laya.utils.Timer");var o$r=o$o.prototype;return o$r._init=function(){o$b.timer&&o$b.timer.frameLoop(1,this,this._update)},o$r._now=function(){return Date.now()},o$r._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var o$o=this.currFrame=this.currFrame+this.scale,o$r=this._now();this._delta=(o$r-this._lastTimer)*this.scale;var o$T=this.currTimer=this.currTimer+this._delta;o$b.isDebug&&6e4<Math.abs(o$r-this._lastTimer)&&console.error("系统时间错误！"+(o$r-this._lastTimer)),this._lastTimer=o$r;var o$k=this._handlers;for(o$n=this._count=0,o$V=o$k.length;o$n<o$V;o$n++)if(null!==(o$L=o$k[o$n]).method){var o$W=o$L.userFrame?o$o:o$T;if(o$W>=o$L.exeTime)if(o$L.repeat)if(o$L.jumpFrame)for(;o$W>=o$L.exeTime;)o$L.exeTime+=o$L.delay,o$L.run(!1);else o$L.exeTime+=o$L.delay,o$L.run(!1),o$W>o$L.exeTime&&(o$L.exeTime+=Math.ceil((o$W-o$L.exeTime)/o$L.delay)*o$L.delay);else o$L.run(!0)}else this._count++;(30<this._count||o$o%200==0)&&this._clearHandlers();for(var o$D=this._laters,o$n=0,o$V=o$D.length-1;o$n<=o$V;o$n++){var o$L=o$D[o$n];this._isIgnoreRecover(o$L)||(null!==o$L.method&&(delete this._map[o$L.key],o$L.run(!1)),this._recoverHandler(o$L)),o$n===o$V&&(o$V=o$D.length-1)}o$D.length=0}},o$r._clearHandlers=function(){for(var o$o=this._handlers,o$r=0,o$T=o$o.length;o$r<o$T;o$r++){var o$k=o$o[o$r];null!==o$k.method?this._temp.push(o$k):this._isIgnoreRecover(o$k)?this._temp.push(o$k):this._recoverHandler(o$k)}this._handlers=this._temp,this._temp=o$o,this._temp.length=0},o$r._recoverHandler=function(o$o){this._map[o$o.key]==o$o&&delete this._map[o$o.key],o$o.recover()},o$r._create=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){if(!o$T)return o$W.apply(o$k,o$D),null;if(o$n){var o$L=this._getHandler(o$k,o$W);if(o$L)return o$L.repeat=o$r,o$L.userFrame=o$o,o$L.delay=o$T,o$L.ignoreRecover=o$V,o$L.caller=o$k,o$L.method=o$W,o$L.args=o$D,o$L.exeTime=o$T+(o$o?this.currFrame:this.currTimer+this._now()-this._lastTimer),o$L}return(o$L=o$U.create()).repeat=o$r,o$L.userFrame=o$o,o$L.delay=o$T,o$L.ignoreRecover=o$V,o$L.caller=o$k,o$L.method=o$W,o$L.args=o$D,o$L.exeTime=o$T+(o$o?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(o$L),this._handlers.push(o$L),o$L},o$r._indexHandler=function(o$o){var o$r=o$o.caller,o$T=o$o.method,o$k=o$r?o$r.$_GID||(o$r.$_GID=o$g.getGID()):0,o$W=o$T.$_TID||(o$T.$_TID=this._mid++);o$o.key=o$k+"_"+o$W,this._map[o$o.key]=o$o},o$r.once=function(o$o,o$r,o$T,o$k,o$W){void 0===o$W&&(o$W=!0),this._create(!1,!1,o$o,o$r,o$T,o$k,o$W,!1)},o$r.loop=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){void 0===o$W&&(o$W=!0),void 0===o$D&&(o$D=!1),void 0===o$n&&(o$n=!1);var o$V=this._create(!1,!0,o$o,o$r,o$T,o$k,o$W,o$n);o$V&&(o$V.jumpFrame=o$D)},o$r.frameOnce=function(o$o,o$r,o$T,o$k,o$W){void 0===o$W&&(o$W=!0),this._create(!0,!1,o$o,o$r,o$T,o$k,o$W,!1)},o$r.frameLoop=function(o$o,o$r,o$T,o$k,o$W,o$D){void 0===o$W&&(o$W=!0),void 0===o$D&&(o$D=!1),this._create(!0,!0,o$o,o$r,o$T,o$k,o$W,o$D)},o$r.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+o$U._freeCount},o$r.clear=function(o$o,o$r){var o$T=this._getHandler(o$o,o$r);return!(!o$T||this._isIgnoreRecover(o$T))&&(delete this._map[o$T.key],o$T.key=null,o$T.clear(),!0)},o$r.clearAll=function(o$o){if(o$o)for(var o$r=0,o$T=this._handlers.length;o$r<o$T;o$r++){var o$k=this._handlers[o$r];o$k.caller===o$o&&(this._isIgnoreRecover(o$k)||(delete this._map[o$k.key],o$k.key=null,o$k.clear()))}},o$r._getHandler=function(o$o,o$r){var o$T=o$o?o$o.$_GID||(o$o.$_GID=o$g.getGID()):0,o$k=o$r.$_TID||(o$r.$_TID=this._mid++);return this._map[o$T+"_"+o$k]},o$r._isIgnoreRecover=function(o$o){if(o$o.ignoreRecover||o$o.caller&&"IgnoreRecover"==o$o.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var o$r="";try{arguments.propertyIsEnumerable.caller}catch(o$o){o$r=o$o.stack}o$b.recordError("报错：核心定时器销毁忽略  "+o$r)}return!0}return!1},o$r.hasHandler=function(o$o,o$r){return this._map[o$o.$_GID+"_"+o$r.$_TID]},o$r.callLater=function(o$o,o$r,o$T){if(null==this._getHandler(o$o,o$r)){var o$k=o$U.create();o$k.caller=o$o,o$k.method=o$r,o$k.args=o$T,this._indexHandler(o$k),this._laters.push(o$k)}},o$r.runCallLater=function(o$o,o$r){var o$T=this._getHandler(o$o,o$r);o$T&&null!=o$T.method&&(this._isIgnoreRecover(o$T)||(delete this._map[o$T.key],o$T.run(!0)))},o$r.runTimer=function(o$o,o$r){this.runCallLater(o$o,o$r)},o$x(0,o$r,"delta",function(){return this._delta}),o$o.__init$=function(){o$U=function(){function o$r(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}o$h(o$r,"");var o$o=o$r.prototype;return o$o.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},o$o.recover=function(){this.clear(),this.args=o$r._freeHandler,o$r._freeHandler=this,o$r._freeCount++},o$o.run=function(o$o){var o$r=this.caller;if(o$r&&o$r.destroyed)return this.clear();var o$T=this.method,o$k=this.args;o$o&&this.clear(),null!=o$T&&(o$k?o$T.apply(o$r,o$k):o$T.call(o$r))},o$r._freeHandler=null,o$r._freeCount=0,o$r.create=function(){var o$o=o$r._freeHandler;return o$o?(o$r._freeHandler=o$o.args,--o$r._freeCount,o$o.args=null,o$o):new o$r},o$r}()},o$o}()),o$Q=function(){function o$p(){this.gid=0}o$h(o$p,"laya.utils.Tween");var o$o=o$p.prototype;return o$o.to=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){return void 0===o$D&&(o$D=0),void 0===o$n&&(o$n=!1),this._create(o$o,o$r,o$T,o$k,o$W,o$D,o$n,!0,!1,!0)},o$o.from=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){return void 0===o$D&&(o$D=0),void 0===o$n&&(o$n=!1),this._create(o$o,o$r,o$T,o$k,o$W,o$D,o$n,!1,!1,!0)},o$o._create=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){if(!o$o)throw new Error("Tween:target is null");this._target=o$o,this._duration=o$T,this._ease=o$k||o$r.ease||o$p.easeNone,this._complete=o$W||o$r.complete,this._delay=o$D,this._props=[],this._usedTimer=0,this._startTimer=o$e.now(),this._usedPool=o$L,this._delayParam=null,this.update=o$r.update;var o$h=o$o.$_GID||(o$o.$_GID=o$g.getGID());return o$p.tweenMap[o$h]?(o$n&&o$p.clearTween(o$o),o$p.tweenMap[o$h].push(this)):o$p.tweenMap[o$h]=[this],o$U?o$D<=0?this.firstStart(o$o,o$r,o$V):(this._delayParam=[o$o,o$r,o$V],o$b.scaleTimer.once(o$D,this,this.firstStart,this._delayParam)):this._initProps(o$o,o$r,o$V),this},o$o.firstStart=function(o$o,o$r,o$T){this._delayParam=null,o$o.destroyed?this.clear():(this._initProps(o$o,o$r,o$T),this._beginLoop())},o$o._initProps=function(o$o,o$r,o$T){for(var o$k in o$r)if("number"==typeof o$o[o$k]){var o$W=o$T?o$o[o$k]:o$r[o$k],o$D=o$T?o$r[o$k]:o$o[o$k];this._props.push([o$k,o$W,o$D-o$W]),o$T||(o$o[o$k]=o$W)}},o$o._beginLoop=function(){o$b.scaleTimer.frameLoop(1,this,this._doEase)},o$o._doEase=function(){this._updateEase(o$e.now())},o$o._updateEase=function(o$o){var o$r=this._target;if(o$r){if(o$r.destroyed)return o$p.clearTween(o$r);var o$T=this._usedTimer=o$o-this._startTimer-this._delay;if(!(o$T<0)){if(o$T>=this._duration)return this.complete();for(var o$k=0<o$T?this._ease(o$T,0,1,this._duration):0,o$W=this._props,o$D=0,o$n=o$W.length;o$D<o$n;o$D++){var o$V=o$W[o$D];o$r[o$V[0]]=o$V[1]+o$k*o$V[2]}this.update&&this.update.run()}}},o$o.complete=function(){if(this._target){o$b.scaleTimer.runTimer(this,this.firstStart);for(var o$o=this._target,o$r=this._props,o$T=this._complete,o$k=0,o$W=o$r.length;o$k<o$W;o$k++){var o$D=o$r[o$k];o$o[o$D[0]]=o$D[1]+o$D[2]}this.update&&this.update.run(),this.clear(),o$T&&o$T.run()}},o$o.pause=function(){o$b.scaleTimer.clear(this,this._beginLoop),o$b.scaleTimer.clear(this,this._doEase),o$b.scaleTimer.clear(this,this.firstStart);var o$o;(o$o=o$e.now()-this._startTimer-this._delay)<0&&(this._usedTimer=o$o)},o$o.setStartTime=function(o$o){this._startTimer=o$o},o$o.clear=function(){this._target&&(this._remove(),this._clear())},o$o._clear=function(){this.pause(),o$b.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,o$G.recover("tween",this))},o$o.recover=function(){this._usedPool=!0,this._clear()},o$o._remove=function(){var o$o=o$p.tweenMap[this._target.$_GID];if(o$o)for(var o$r=0,o$T=o$o.length;o$r<o$T;o$r++)if(o$o[o$r]===this){o$o.splice(o$r,1);break}},o$o.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=o$e.now(),this._delayParam)o$b.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var o$o=this._props,o$r=0,o$T=o$o.length;o$r<o$T;o$r++){var o$k=o$o[o$r];this._target[o$k[0]]=o$k[1]}o$b.scaleTimer.once(this._delay,this,this._beginLoop)}},o$o.resume=function(){this._usedTimer>=this._duration||(this._startTimer=o$e.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?o$b.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},o$x(0,o$o,"progress",null,function(o$o){var o$r=o$o*this._duration;this._startTimer=o$e.now()-this._delay-o$r}),o$p.to=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){return void 0===o$D&&(o$D=0),void 0===o$n&&(o$n=!1),void 0===o$V&&(o$V=!0),o$G.getItemByClass("tween",o$p)._create(o$o,o$r,o$T,o$k,o$W,o$D,o$n,!0,o$V,!0)},o$p.from=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){return void 0===o$D&&(o$D=0),void 0===o$n&&(o$n=!1),void 0===o$V&&(o$V=!0),o$G.getItemByClass("tween",o$p)._create(o$o,o$r,o$T,o$k,o$W,o$D,o$n,!1,o$V,!0)},o$p.clearAll=function(o$o){if(o$o&&o$o.$_GID){var o$r=o$p.tweenMap[o$o.$_GID];if(o$r){for(var o$T=0,o$k=o$r.length;o$T<o$k;o$T++)o$r[o$T]._clear();o$r.length=0}}},o$p.clear=function(o$o){o$o.clear()},o$p.clearTween=function(o$o){o$p.clearAll(o$o)},o$p.easeNone=function(o$o,o$r,o$T,o$k){return o$T*o$o/o$k+o$r},o$p.tweenMap={},o$p}(),o$g=function(){function o$V(){}return o$h(o$V,"laya.utils.Utils"),o$V.toRadian=function(o$o){return o$o*o$V._pi2},o$V.toAngle=function(o$o){return o$o*o$V._pi},o$V.toHexColor=function(o$o){if(o$o<0||isNaN(o$o))return null;for(var o$r=o$o.toString(16);o$r.length<6;)o$r="0"+o$r;return"#"+o$r},o$V.getGID=function(){return o$V._gid++},o$V.concatArray=function(o$o,o$r){if(!o$r)return o$o;if(!o$o)return o$r;var o$T=0,o$k=o$r.length;for(o$T=0;o$T<o$k;o$T++)o$o.push(o$r[o$T]);return o$o},o$V.clearArray=function(o$o){return o$o&&(o$o.length=0),o$o},o$V.copyArray=function(o$o,o$r){if(o$o||(o$o=[]),!o$r)return o$o;o$o.length=o$r.length;var o$T=0,o$k=o$r.length;for(o$T=0;o$T<o$k;o$T++)o$o[o$T]=o$r[o$T];return o$o},o$V.getGlobalRecByPoints=function(o$o,o$r,o$T,o$k,o$W){var o$D,o$n;return o$D=new o$F(o$r,o$T),o$D=o$o.localToGlobal(o$D),o$n=new o$F(o$k,o$W),o$n=o$o.localToGlobal(o$n),o$P._getWrapRec([o$D.x,o$D.y,o$n.x,o$n.y])},o$V.getGlobalPosAndScale=function(o$o){return o$V.getGlobalRecByPoints(o$o,0,0,1,1)},o$V.bind=function(o$o,o$r){return o$o.bind(o$r)},o$V.measureText=function(o$o,o$r){return o$u.measureText(o$o,o$r)},o$V.updateOrder=function(o$o){if(!o$o||o$o.length<2)return!1;for(var o$r,o$T=1,o$k=0,o$W=o$o.length,o$D=NaN;o$T<o$W;){for(o$r=o$o[o$k=o$T],o$D=o$o[o$k]._zOrder;-1<--o$k&&o$o[o$k]._zOrder>o$D;)o$o[o$k+1]=o$o[o$k];o$o[o$k+1]=o$r,o$T++}var o$n=o$r.parent.conchModel;if(o$n)if(null!=o$n.updateZOrder)o$n.updateZOrder();else{for(o$T=0;o$T<o$W;o$T++)o$n.removeChild(o$o[o$T].conchModel);for(o$T=0;o$T<o$W;o$T++)o$n.addChildAt(o$o[o$T].conchModel,o$T)}return!0},o$V.transPointList=function(o$o,o$r,o$T){var o$k=0,o$W=o$o.length;for(o$k=0;o$k<o$W;o$k+=2)o$o[o$k]+=o$r,o$o[o$k+1]+=o$T},o$V.parseInt=function(o$o,o$r){void 0===o$r&&(o$r=0);var o$T=o$e.window.parseInt(o$o,o$r);return isNaN(o$T)?0:o$T},o$V.getFileExtension=function(o$o){o$V._extReg.lastIndex=o$o.lastIndexOf(".");var o$r=o$V._extReg.exec(o$o);return o$r&&1<o$r.length?o$r[1].toLowerCase():null},o$V.getTransformRelativeToWindow=function(o$o,o$r,o$T){var o$k=o$b.stage,o$W=laya.utils.Utils.getGlobalPosAndScale(o$o),o$D=o$k._canvasTransform.clone(),o$n=o$D.tx,o$V=o$D.ty;o$D.rotate(-Math.PI/180*o$b.stage.canvasDegree),o$D.scale(o$b.stage.clientScaleX,o$b.stage.clientScaleY);var o$L=o$b.stage.canvasDegree%180!=0,o$U=NaN,o$h=NaN;o$L?(o$U=o$T+o$W.y,o$h=o$r+o$W.x,o$U*=o$D.d,o$h*=o$D.a,90==o$b.stage.canvasDegree?(o$U=o$n-o$U,o$h+=o$V):(o$U+=o$n,o$h=o$V-o$h)):(o$U=o$r+o$W.x,o$h=o$T+o$W.y,o$U*=o$D.a,o$h*=o$D.d,o$U+=o$n,o$h+=o$V);var o$p=NaN,o$i=NaN;return o$i=o$L?(o$p=o$D.d*o$W.height,o$D.a*o$W.width):(o$p=o$D.a*o$W.width,o$D.d*o$W.height),{x:o$U,y:o$h,scaleX:o$p,scaleY:o$i}},o$V.fitDOMElementInArea=function(o$o,o$r,o$T,o$k,o$W,o$D){o$o._fitLayaAirInitialized||(o$o._fitLayaAirInitialized=!0,o$o.style.transformOrigin=o$o.style.webKittransformOrigin="left top",o$o.style.position="absolute");var o$n=o$V.getTransformRelativeToWindow(o$r,o$T,o$k);o$o.style.transform=o$o.style.webkitTransform="scale("+o$n.scaleX+","+o$n.scaleY+") rotate("+o$b.stage.canvasDegree+"deg)",o$o.style.width=o$W+"px",o$o.style.height=o$D+"px",o$o.style.left=o$n.x+"px",o$o.style.top=o$n.y+"px"},o$V.isOkTextureList=function(o$o){if(!o$o)return!1;var o$r,o$T=0,o$k=o$o.length;for(o$T=0;o$T<o$k;o$T++)if(!(o$r=o$o[o$T])||!o$r.source)return!1;return!0},o$V.isOKCmdList=function(o$o){if(!o$o)return!1;var o$r,o$T,o$k=0,o$W=o$o.length,o$D=o$C._context;for(o$k=0;o$k<o$W;o$k++)switch((o$r=o$o[o$k]).callee){case o$D._drawTexture:case o$D._fillTexture:case o$D._drawTextureWithTransform:if(!(o$T=o$r[0])||!o$T.source)return!1}return!0},o$V._gid=1,o$V._pi=180/Math.PI,o$V._pi2=Math.PI/180,o$V._extReg=/\.(\w+)\??/g,o$V.parseXMLFromString=function(o$o){var o$r;if(o$o=o$o.replace(/>\s+</g,"><"),-1<(o$r=(new DOMParser).parseFromString(o$o,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(o$r.firstChild.firstChild.textContent);return o$r},o$V}(),o$B=function(){function o$o(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],o$C.isWebGL&&o$Y.regCacheByFunction(o$g.bind(this.startDispose,this),o$g.bind(this.getCacheList,this))}o$h(o$o,"laya.utils.VectorGraphManager");var o$r=o$o.prototype;return o$r.getId=function(){return this._id++},o$r.addShape=function(o$o,o$r){this.shapeDic[o$o]=o$r,this.useDic[o$o]||(this.useDic[o$o]=!0)},o$r.addLine=function(o$o,o$r){this.shapeLineDic[o$o]=o$r,this.shapeLineDic[o$o]||(this.shapeLineDic[o$o]=!0)},o$r.getShape=function(o$o){this._checkKey&&null!=this.useDic[o$o]&&(this.useDic[o$o]=!0)},o$r.deleteShape=function(o$o){this.shapeDic[o$o]&&(this.shapeDic[o$o]=null,delete this.shapeDic[o$o]),this.shapeLineDic[o$o]&&(this.shapeLineDic[o$o]=null,delete this.shapeLineDic[o$o]),null!=this.useDic[o$o]&&delete this.useDic[o$o]},o$r.getCacheList=function(){var o$o,o$r=[];for(o$o in this.shapeDic)o$r.push(this.shapeDic[o$o]);for(o$o in this.shapeLineDic)o$r.push(this.shapeLineDic[o$o]);return o$r},o$r.startDispose=function(o$o){var o$r;for(o$r in this.useDic)this.useDic[o$r]=!1;this._checkKey=!0},o$r.endDispose=function(){if(this._checkKey){var o$o;for(o$o in this.useDic)this.useDic[o$o]||this.deleteShape(o$o);this._checkKey=!1}},o$o.getInstance=function(){return o$o.instance=o$o.instance||new o$o},o$o.instance=null,o$o}(),o$E=function(){function o$k(){this._obj=null,this._obj=o$k.supportWeakMap?new o$e.window.WeakMap:{},o$k.supportWeakMap||o$k._maps.push(this)}o$h(o$k,"laya.utils.WeakObject");var o$o=o$k.prototype;return o$o.set=function(o$o,o$r){if(null!=o$o)if(o$k.supportWeakMap){var o$T=o$o;"string"!=typeof o$o&&"number"!=typeof o$o||(o$T=o$k._keys[o$o])||(o$T=o$k._keys[o$o]={k:o$o}),this._obj.set(o$T,o$r)}else"string"==typeof o$o||"number"==typeof o$o?this._obj[o$o]=o$r:(o$o.$_GID||(o$o.$_GID=o$g.getGID()),this._obj[o$o.$_GID]=o$r)},o$o.get=function(o$o){if(null==o$o)return null;if(o$k.supportWeakMap){var o$r="string"==typeof o$o||"number"==typeof o$o?o$k._keys[o$o]:o$o;return o$r?this._obj.get(o$r):null}return"string"==typeof o$o||"number"==typeof o$o?this._obj[o$o]:this._obj[o$o.$_GID]},o$o.del=function(o$o){if(null!=o$o)if(o$k.supportWeakMap){var o$r="string"==typeof o$o||"number"==typeof o$o?o$k._keys[o$o]:o$o;if(!o$r)return;this._obj.delete(o$r)}else"string"==typeof o$o||"number"==typeof o$o?delete this._obj[o$o]:delete this._obj[this._obj.$_GID]},o$o.has=function(o$o){if(null==o$o)return!1;if(o$k.supportWeakMap){var o$r="string"==typeof o$o||"number"==typeof o$o?o$k._keys[o$o]:o$o;return this._obj.has(o$r)}return"string"==typeof o$o||"number"==typeof o$o?null!=this._obj[o$o]:null!=this._obj[this._obj.$_GID]},o$k.__init__=function(){(o$k.supportWeakMap=null!=o$e.window.WeakMap)||o$b.timer.loop(o$k.delInterval,null,o$k.clearCache)},o$k.clearCache=function(){for(var o$o=0,o$r=o$k._maps.length;o$o<o$r;o$o++){o$k._maps[o$o]._obj={}}},o$k.supportWeakMap=!1,o$k.delInterval=3e5,o$k._keys={},o$k._maps=[],o$L(o$k,["I",function(){return this.I=new o$k}]),o$k}(),o$d=function(){function o$o(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}o$h(o$o,"laya.utils.WordText");var o$r=o$o.prototype;return o$r.setText=function(o$o){this.changed=!0,this._text=o$o},o$r.toString=function(){return this._text},o$r.charCodeAt=function(o$o){return this._text?this._text.charCodeAt(o$o):NaN},o$r.charAt=function(o$o){return this._text?this._text.charAt(o$o):null},o$x(0,o$r,"length",function(){return this._text?this._text.length:0}),o$o}(),o$oo=function(o$o){function o$n(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,o$n.__super.call(this),this._childs=o$n.ARRAY_EMPTY,this._$P=o$n.PROP_EMPTY,this.timer=o$b.scaleTimer,this.conchModel=o$C.isConchNode?this.createConchModel():null}o$h(o$n,"laya.display.Node",o$U);var o$r=o$n.prototype;return o$r._setBit=function(o$o,o$r){1==o$o&&(this._getBit(o$o)!=o$r&&this._updateDisplayedInstage());o$r?this._bits|=o$o:this._bits&=~o$o},o$r._getBit=function(o$o){return 0!=(this._bits&o$o)},o$r._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},o$r._setUpNoticeType=function(o$o){var o$r=this;for(o$r._setBit(o$o,!0),o$r=o$r.parent;o$r;){if(o$r._getBit(o$o))return;o$r._setBit(o$o,!0),o$r=o$r.parent}},o$r.on=function(o$o,o$r,o$T,o$k){return"display"!==o$o&&"undisplay"!==o$o||this._getBit(1)||this._setUpNoticeType(1),this._createListener(o$o,o$r,o$T,o$k,!1)},o$r.once=function(o$o,o$r,o$T,o$k){return"display"!==o$o&&"undisplay"!==o$o||this._getBit(1)||this._setUpNoticeType(1),this._createListener(o$o,o$r,o$T,o$k,!0)},o$r.createConchModel=function(){return null},o$r.destroy=function(o$o){void 0===o$o&&(o$o=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(o$o?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},o$r.destroyChildren=function(){if(this._childs)for(var o$o=this._childs.length-1;-1<o$o;o$o--)this._childs[o$o].destroy(!0)},o$r.addChild=function(o$o){if(!o$o||this.destroyed||o$o===this)return o$o;if(o$o.zOrder&&this._set$P("hasZorder",!0),o$o._parent===this){var o$r=this.getChildIndex(o$o);o$r!==this._childs.length-1&&(this._childs.splice(o$r,1),this._childs.push(o$o),this.conchModel&&(this.conchModel.removeChild(o$o.conchModel),this.conchModel.addChildAt(o$o.conchModel,this._childs.length-1)),this._childChanged())}else o$o.parent&&o$o.parent.removeChild(o$o),this._childs===o$n.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(o$o),this.conchModel&&this.conchModel.addChildAt(o$o.conchModel,this._childs.length-1),(o$o.parent=this)._childChanged();return o$o},o$r.addChildren=function(o$o){for(var o$r=arguments,o$T=0,o$k=o$r.length;o$T<o$k;)this.addChild(o$r[o$T++])},o$r.addChildAt=function(o$o,o$r){if(!o$o||this.destroyed||o$o===this)return o$o;if(o$o.zOrder&&this._set$P("hasZorder",!0),0<=o$r&&o$r<=this._childs.length){if(o$o._parent===this){var o$T=this.getChildIndex(o$o);this._childs.splice(o$T,1),this._childs.splice(o$r,0,o$o),this.conchModel&&(this.conchModel.removeChild(o$o.conchModel),this.conchModel.addChildAt(o$o.conchModel,o$r)),this._childChanged()}else o$o.parent&&o$o.parent.removeChild(o$o),this._childs===o$n.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(o$r,0,o$o),this.conchModel&&this.conchModel.addChildAt(o$o.conchModel,o$r),o$o.parent=this;return o$o}throw new Error("appendChildAt:The index is out of bounds")},o$r.getChildIndex=function(o$o){return this._childs.indexOf(o$o)},o$r.getChildByName=function(o$o){var o$r=this._childs;if(o$r)for(var o$T=0,o$k=o$r.length;o$T<o$k;o$T++){var o$W=o$r[o$T];if(o$W.name===o$o)return o$W}return null},o$r._get$P=function(o$o){return this._$P[o$o]},o$r._set$P=function(o$o,o$r){return this.destroyed||(this._$P===o$n.PROP_EMPTY&&(this._$P={}),this._$P[o$o]=o$r),o$r},o$r.getChildAt=function(o$o){return this._childs[o$o]},o$r.setChildIndex=function(o$o,o$r){var o$T=this._childs;if(o$r<0||o$r>=o$T.length)throw new Error("setChildIndex:The index is out of bounds.");var o$k=this.getChildIndex(o$o);if(o$k<0)throw new Error("setChildIndex:node is must child of this object.");return o$T.splice(o$k,1),o$T.splice(o$r,0,o$o),this.conchModel&&(this.conchModel.removeChild(o$o.conchModel),this.conchModel.addChildAt(o$o.conchModel,o$r)),this._childChanged(),o$o},o$r._childChanged=function(o$o){},o$r.removeChild=function(o$o){if(!this._childs)return o$o;var o$r=this._childs.indexOf(o$o);return this.removeChildAt(o$r)},o$r.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},o$r.removeChildByName=function(o$o){var o$r=this.getChildByName(o$o);return o$r&&this.removeChild(o$r),o$r},o$r.removeChildAt=function(o$o){var o$r=this.getChildAt(o$o);if(o$r){for(var o$T=this._childs.length-1,o$k=o$o;o$k<o$T;++o$k)this._childs[o$k]=this._childs[o$k+1];this._childs.length=o$T,this.conchModel&&this.conchModel.removeChild(o$r.conchModel),o$r.parent=null}return o$r},o$r.removeChildren=function(o$o,o$r){if(void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=2147483647),this._childs&&0<this._childs.length){var o$T=this._childs;if(0===o$o&&o$D<=o$r){var o$k=o$T;this._childs=o$n.ARRAY_EMPTY}else o$k=o$T.splice(o$o,o$r-o$o);for(var o$W=0,o$D=o$k.length;o$W<o$D;o$W++)o$k[o$W].parent=null,this.conchModel&&this.conchModel.removeChild(o$k[o$W].conchModel)}return this},o$r.replaceChild=function(o$o,o$r){var o$T=this._childs.indexOf(o$r);return-1<o$T?(this._childs.splice(o$T,1,o$o),this.conchModel&&(this.conchModel.removeChild(o$r.conchModel),this.conchModel.addChildAt(o$o.conchModel,o$T)),o$r.parent=null,o$o.parent=this,o$o):null},o$r._updateDisplayedInstage=function(){var o$o;o$o=this;var o$r=o$b.stage;for(this._displayedInStage=!1;o$o;){if(o$o._getBit(1)){this._displayedInStage=o$o._displayedInStage;break}if(o$o==o$r||o$o._displayedInStage){this._displayedInStage=!0;break}o$o=o$o.parent}},o$r._setDisplay=function(o$o){this._displayedInStage!==o$o&&((this._displayedInStage=o$o)?this.event("display"):this.event("undisplay"))},o$r._displayChild=function(o$o,o$r){var o$T=o$o._childs;if(o$T)for(var o$k=0;o$k<o$T.length;o$k++){var o$W=o$T[o$k];o$W&&o$W._getBit(1)&&(0<o$W._childs.length?this._displayChild(o$W,o$r):o$W._setDisplay(o$r))}o$o._setDisplay(o$r)},o$r.contains=function(o$o){if(o$o===this)return!0;for(;o$o;){if(o$o.parent===this)return!0;o$o=o$o.parent}return!1},o$r.timerLoop=function(o$o,o$r,o$T,o$k,o$W,o$D){void 0===o$W&&(o$W=!0),void 0===o$D&&(o$D=!1),this.timer.loop(o$o,o$r,o$T,o$k,o$W,o$D)},o$r.timerOnce=function(o$o,o$r,o$T,o$k,o$W){void 0===o$W&&(o$W=!0),this.timer._create(!1,!1,o$o,o$r,o$T,o$k,o$W)},o$r.frameLoop=function(o$o,o$r,o$T,o$k,o$W){void 0===o$W&&(o$W=!0),this.timer._create(!0,!0,o$o,o$r,o$T,o$k,o$W)},o$r.frameOnce=function(o$o,o$r,o$T,o$k,o$W){void 0===o$W&&(o$W=!0),this.timer._create(!0,!1,o$o,o$r,o$T,o$k,o$W)},o$r.clearTimer=function(o$o,o$r){this.timer.clear(o$o,o$r)},o$x(0,o$r,"numChildren",function(){return this._childs.length}),o$x(0,o$r,"destroyed",function(){return this._destroyed}),o$x(0,o$r,"parent",function(){return this._parent},function(o$o){this._parent!==o$o&&(o$o?(this._parent=o$o,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),o$o.displayedInStage&&this._displayChild(this,!0)),o$o._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=o$o))}),o$x(0,o$r,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),o$n.ARRAY_EMPTY=[],o$n.PROP_EMPTY={},o$n.NOTICE_DISPLAY=1,o$n.MOUSEENABLE=2,o$n}(),o$ro=function(o$o){function o$i(o$o){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,o$i.__super.call(this),this._padding=o$i._PADDING,this._spacing=o$i._SPACING,this._aligns=o$i._ALIGNS,this._font=o$v.EMPTY,this._ower=o$o}o$h(o$i,"laya.display.css.CSSStyle",o$o);var o$r=o$i.prototype;return o$r.destroy=function(){this._ower=null,this._font=null,this._rect=null},o$r.inherit=function(o$o){this._font=o$o._font,this._spacing=o$o._spacing===o$i._SPACING?o$i._SPACING:o$o._spacing.slice(),this.lineHeight=o$o.lineHeight},o$r._widthAuto=function(){return 0!=(262144&this._type)},o$r.widthed=function(o$o){return 0!=(8&this._type)},o$r._calculation=function(o$o,o$r){if(o$r.indexOf("%")<0)return!1;var o$k=this._ower,o$W=o$k.parent,o$D=this._rect;function o$n(o$o,o$r,o$T){return o$o*o$T[0]+o$r*o$T[1]+o$T[2]}function o$T(o$o){var o$r=o$W.width,o$T=o$k.width;o$D.width&&(o$k.width=o$n(o$r,o$T,o$D.width)),o$D.height&&(o$k.height=o$n(o$r,o$T,o$D.height)),o$D.left&&(o$k.x=o$n(o$r,o$T,o$D.left)),o$D.top&&(o$k.y=o$n(o$r,o$T,o$D.top))}null===o$D&&(o$W._getCSSStyle()._type|=524288,o$W.on("resize",this,o$T),this._rect=o$D={input:{}});var o$V=o$r.split(" ");return o$V[0]=parseFloat(o$V[0])/100,1==o$V.length?o$V[1]=o$V[2]=0:(o$V[1]=parseFloat(o$V[1])/100,o$V[2]=parseFloat(o$V[2])),o$D[o$o]=o$V,o$D.input[o$o]=o$r,o$T(),!0},o$r.heighted=function(o$o){return 0!=(8192&this._type)},o$r.size=function(o$o,o$r){var o$T=this._ower,o$k=!1;-1!==o$o&&o$o!=this._ower.width&&(this._type|=8,this._ower.width=o$o,o$k=!0),-1!==o$r&&o$r!=this._ower.height&&(this._type|=8192,this._ower.height=o$r,o$k=!0),o$k&&(o$T._layoutLater(),524288&this._type&&o$T.event("resize",this))},o$r._getAlign=function(){return this._aligns[0]},o$r._getValign=function(){return this._aligns[1]},o$r._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},o$r._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new o$v(this._font))},o$r.render=function(o$o,o$r,o$T,o$k){var o$W=o$o.width,o$D=o$o.height;o$T-=o$o.pivotX,o$k-=o$o.pivotY,this._bgground&&null!=this._bgground.color&&o$r.ctx.fillRect(o$T,o$k,o$W,o$D,this._bgground.color),this._border&&this._border.color&&o$r.drawRect(o$T,o$k,o$W,o$D,this._border.color.strColor,this._border.size)},o$r.getCSSStyle=function(){return this},o$r.cssText=function(o$o){this.attrs(o$i.parseOneCSS(o$o,";"))},o$r.attrs=function(o$o){if(o$o)for(var o$r=0,o$T=o$o.length;o$r<o$T;o$r++){var o$k=o$o[o$r];this[o$k[0]]=o$k[1]}},o$r.setTransform=function(o$o){"none"===o$o?this._tf=o$V._TF_EMPTY:this.attrs(o$i.parseOneCSS(o$o,","))},o$r.translate=function(o$o,o$r){this._tf===o$V._TF_EMPTY&&(this._tf=new o$W),this._tf.translateX=o$o,this._tf.translateY=o$r},o$r.scale=function(o$o,o$r){this._tf===o$V._TF_EMPTY&&(this._tf=new o$W),this._tf.scaleX=o$o,this._tf.scaleY=o$r},o$r._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},o$x(0,o$r,"block",o$o.prototype._$get_block,function(o$o){o$o?this._type|=1:this._type&=-2}),o$x(0,o$r,"valign",function(){return o$i._valigndef[this._aligns[1]]},function(o$o){this._aligns===o$i._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=o$i._valigndef[o$o]}),o$x(0,o$r,"height",null,function(o$o){if(this._type|=8192,"string"==typeof o$o){if(this._calculation("height",o$o))return;o$o=parseInt(o$o)}this.size(-1,o$o)}),o$x(0,o$r,"width",null,function(o$o){if(this._type|=8,"string"==typeof o$o){var o$r=o$o.indexOf("auto");if(0<=o$r&&(this._type|=262144,o$o=o$o.substr(0,o$r)),this._calculation("width",o$o))return;o$o=parseInt(o$o)}this.size(o$o,-1)}),o$x(0,o$r,"fontWeight",function(){return this._font.weight},function(o$o){this._createFont().weight=o$o}),o$x(0,o$r,"left",null,function(o$o){var o$r=this._ower;if("string"==typeof o$o){if("center"===o$o?o$o="50% -50% 0":"right"===o$o&&(o$o="100% -100% 0"),this._calculation("left",o$o))return;o$o=parseInt(o$o)}o$r.x=o$o}),o$x(0,o$r,"_translate",null,function(o$o){this.translate(o$o[0],o$o[1])}),o$x(0,o$r,"absolute",function(){return 0!=(4&this._type)}),o$x(0,o$r,"top",null,function(o$o){var o$r=this._ower;if("string"==typeof o$o){if("middle"===o$o?o$o="50% -50% 0":"bottom"===o$o&&(o$o="100% -100% 0"),this._calculation("top",o$o))return;o$o=parseInt(o$o)}o$r.y=o$o}),o$x(0,o$r,"align",function(){return o$i._aligndef[this._aligns[0]]},function(o$o){this._aligns===o$i._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=o$i._aligndef[o$o]}),o$x(0,o$r,"bold",function(){return this._font.bold},function(o$o){this._createFont().bold=o$o}),o$x(0,o$r,"padding",function(){return this._padding},function(o$o){this._padding=o$o}),o$x(0,o$r,"leading",function(){return this._spacing[1]},function(o$o){"string"==typeof o$o&&(o$o=parseInt(o$o+"")),this._spacing===o$i._SPACING&&(this._spacing=[0,0]),this._spacing[1]=o$o}),o$x(0,o$r,"lineElement",function(){return 0!=(65536&this._type)},function(o$o){o$o?this._type|=65536:this._type&=-65537}),o$x(0,o$r,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(o$o){this.lineElement=!1,"right"===o$o?this._type|=32768:this._type&=-32769}),o$x(0,o$r,"textDecoration",function(){return this._font.decoration},function(o$o){this._createFont().decoration=o$o}),o$x(0,o$r,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(o$o){"nowrap"===o$o&&(this._type|=131072),"none"===o$o&&(this._type&=-131073)}),o$x(0,o$r,"background",null,function(o$o){o$o?(this._bgground||(this._bgground={}),this._bgground.color=o$o,this._ower.conchModel&&this._ower.conchModel.bgColor(o$o),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),o$x(0,o$r,"wordWrap",function(){return 0==(131072&this._type)},function(o$o){o$o?this._type&=-131073:this._type|=131072}),o$x(0,o$r,"color",function(){return this._font.color},function(o$o){this._createFont().color=o$o}),o$x(0,o$r,"password",function(){return this._font.password},function(o$o){this._createFont().password=o$o}),o$x(0,o$r,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(o$o){"none"===o$o?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=o$o),this._ower.conchModel&&this._ower.conchModel.bgColor(o$o),this._ower._renderType|=256}),o$x(0,o$r,"font",function(){return this._font.toString()},function(o$o){this._createFont().set(o$o)}),o$x(0,o$r,"weight",null,function(o$o){this._createFont().weight=o$o}),o$x(0,o$r,"letterSpacing",function(){return this._spacing[0]},function(o$o){"string"==typeof o$o&&(o$o=parseInt(o$o+"")),this._spacing===o$i._SPACING&&(this._spacing=[0,0]),this._spacing[0]=o$o}),o$x(0,o$r,"fontSize",function(){return this._font.size},function(o$o){this._createFont().size=o$o}),o$x(0,o$r,"italic",function(){return this._font.italic},function(o$o){this._createFont().italic=o$o}),o$x(0,o$r,"fontFamily",function(){return this._font.family},function(o$o){this._createFont().family=o$o}),o$x(0,o$r,"stroke",function(){return this._font.stroke[0]},function(o$o){this._createFont().stroke===o$v._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=o$o}),o$x(0,o$r,"strokeColor",function(){return this._font.stroke[1]},function(o$o){this._createFont().stroke===o$v._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=o$o}),o$x(0,o$r,"border",function(){return this._border?this._border.value:""},function(o$o){if("none"!=o$o){this._border||(this._border={});var o$r=(this._border.value=o$o).split(" ");if(this._border.color=o$I.create(o$r[o$r.length-1]),1==o$r.length)return this._border.size=1,void(this._border.type="solid");var o$T=0;0<o$r[0].indexOf("px")?(this._border.size=parseInt(o$r[0]),o$T++):this._border.size=1,this._border.type=o$r[o$T],this._ower._renderType|=256}else this._border=null}),o$x(0,o$r,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(o$o){o$o?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==o$o?null:o$I.create(o$o),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),o$x(0,o$r,"position",function(){return 4&this._type?"absolute":""},function(o$o){"absolute"==o$o?this._type|=4:this._type&=-5}),o$x(0,o$r,"display",null,function(o$o){switch(o$o){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),o$x(0,o$r,"paddingLeft",function(){return this.padding[3]}),o$x(0,o$r,"paddingTop",function(){return this.padding[0]}),o$x(0,o$r,"_scale",null,function(o$o){this._ower.scale(o$o[0],o$o[1])}),o$x(0,o$r,"_rotate",null,function(o$o){this._ower.rotation=o$o}),o$i.parseOneCSS=function(o$o,o$r){for(var o$T,o$k=[],o$W=o$o.split(o$r),o$D=0,o$n=o$W.length;o$D<o$n;o$D++){var o$V=o$W[o$D],o$L=o$V.indexOf(":"),o$U=o$V.substr(0,o$L).replace(/^\s+|\s+$/g,"");if(0!=o$U.length){var o$h=o$V.substr(o$L+1).replace(/^\s+|\s+$/g,""),o$p=[o$U,o$h];switch(o$U){case"italic":case"bold":o$p[1]="true"==o$h;break;case"line-height":o$p[0]="lineHeight",o$p[1]=parseInt(o$h);break;case"font-size":o$p[0]="fontSize",o$p[1]=parseInt(o$h);break;case"padding":1<(o$T=o$h.split(" ")).length||(o$T[1]=o$T[2]=o$T[3]=o$T[0]),o$p[1]=[parseInt(o$T[0]),parseInt(o$T[1]),parseInt(o$T[2]),parseInt(o$T[3])];break;case"rotate":o$p[0]="_rotate",o$p[1]=parseFloat(o$h);break;case"scale":o$T=o$h.split(" "),o$p[0]="_scale",o$p[1]=[parseFloat(o$T[0]),parseFloat(o$T[1])];break;case"translate":o$T=o$h.split(" "),o$p[0]="_translate",o$p[1]=[parseInt(o$T[0]),parseInt(o$T[1])];break;default:(o$p[0]=o$i._CSSTOVALUE[o$U])||(o$p[0]=o$U)}o$k.push(o$p)}}return o$k},o$i.parseCSS=function(o$o,o$r){for(var o$T;null!=(o$T=o$i._parseCSSRegExp.exec(o$o));)o$i.styleSheets[o$T[1]]=o$i.parseOneCSS(o$T[2],";")},o$i.EMPTY=new o$i(null),o$i._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},o$i._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),o$i._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},o$i._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},o$i.styleSheets={},o$i.ALIGN_CENTER=1,o$i.ALIGN_RIGHT=2,o$i.VALIGN_MIDDLE=1,o$i.VALIGN_BOTTOM=2,o$i._CSS_BLOCK=1,o$i._DISPLAY_NONE=2,o$i._ABSOLUTE=4,o$i._WIDTH_SET=8,o$i._PADDING=[0,0,0,0],o$i._RECT=[-1,-1,-1,-1],o$i._SPACING=[0,0],o$i._ALIGNS=[0,0,0],o$i.ADDLAYOUTED=512,o$i._NEWFONT=4096,o$i._HEIGHT_SET=8192,o$i._BACKGROUND_SET=16384,o$i._FLOAT_RIGHT=32768,o$i._LINE_ELEMENT=65536,o$i._NOWARP=131072,o$i._WIDTHAUTO=262144,o$i._LISTERRESZIE=524288,o$i}(o$V),o$To=function(o$o){function o$n(){this.url=null,this.audio=null,this.loaded=!1,o$n.__super.call(this)}o$h(o$n,"laya.media.h5audio.AudioSound",o$U);var o$r=o$n.prototype;return o$r.dispose=function(){var o$o=o$n._audioCache[this.url];o$o&&(o$o.src="",delete o$n._audioCache[this.url])},o$r.load=function(o$o){var o$r;if(o$o=o$m.formatURL(o$o),(this.url=o$o)==o$R._tMusic?(o$n._initMusicAudio(),(o$r=o$n._musicAudio).src!=o$o&&(o$n._audioCache[o$r.src]=null,o$r=null)):o$r=o$n._audioCache[o$o],o$r&&2<=o$r.readyState)this.event("complete");else{o$r||(o$r=o$o==o$R._tMusic?(o$n._initMusicAudio(),o$n._musicAudio):o$e.createElement("audio"),(o$n._audioCache[o$o]=o$r).src=o$o),o$r.addEventListener("canplaythrough",o$k),o$r.addEventListener("error",o$W);var o$T=this;(this.audio=o$r).load?o$r.load():o$W()}function o$k(){o$D(),o$T.loaded=!0,o$T.event("complete")}function o$W(){o$r.load=null,o$D(),o$T.event("error")}function o$D(){o$r.removeEventListener("canplaythrough",o$k),o$r.removeEventListener("error",o$W)}},o$r.play=function(o$o,o$r,o$T){if(void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),!this.url)return null;var o$k,o$W;if(!(o$k=this.url==o$R._tMusic?o$n._musicAudio:o$n._audioCache[this.url]))return null;o$W=o$G.getItem("audio:"+this.url),o$C.isConchApp?o$W||((o$W=o$e.createElement("audio")).src=this.url):this.url==o$R._tMusic?(o$n._initMusicAudio(),(o$W=o$n._musicAudio).src=this.url):o$W=o$W||o$k.cloneNode(!0);var o$D=new o$io(o$W);return o$D.url=this.url,o$D.loops=o$r,o$D.startTime=o$o,o$D.startHandler=o$T,o$D.play(!1),o$R.addChannel(o$D),o$D},o$x(0,o$r,"duration",function(){var o$o;return(o$o=o$n._audioCache[this.url])?o$o.duration:0}),o$n._initMusicAudio=function(){o$n._musicAudio||(o$n._musicAudio||(o$n._musicAudio=o$e.createElement("audio")),o$C.isConchApp||o$e.document.addEventListener("mousedown",o$n._makeMusicOK))},o$n._makeMusicOK=function(){o$e.document.removeEventListener("mousedown",o$n._makeMusicOK),o$n._musicAudio.src?o$n._musicAudio.play():(o$n._musicAudio.src="",o$n._musicAudio.load())},o$n._audioCache={},o$n._musicAudio=null,o$n}(),o$ko=function(o$o){function o$r(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,o$r.__super.call(this)}o$h(o$r,"laya.media.SoundChannel",o$U);var o$T=o$r.prototype;return o$T.play=function(){},o$T.stop=function(){},o$T.pause=function(){},o$T.resume=function(){},o$T.__runComplete=function(o$o){o$o&&o$o.run()},o$x(0,o$T,"volume",function(){return 1},function(o$o){}),o$x(0,o$T,"position",function(){return 0}),o$x(0,o$T,"duration",function(){return 0}),o$r}(),o$Wo=function(o$o){function o$r(){o$r.__super.call(this)}o$h(o$r,"laya.media.Sound",o$U);var o$T=o$r.prototype;return o$T.load=function(o$o){},o$T.play=function(o$o,o$r,o$T){return void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),null},o$T.dispose=function(){},o$x(0,o$T,"duration",function(){return 0}),o$r}(),o$Do=function(o$o){function o$W(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,o$W.__super.call(this)}o$h(o$W,"laya.media.webaudio.WebAudioSound",o$U);var o$r=o$W.prototype;return o$r.load=function(o$o){this.url=o$o,this.audioBuffer=o$W._dataCache[o$o],this.audioBuffer?this._loaded(this.audioBuffer):(o$W.e.on("loaded:"+o$o,this,this._loaded),o$W.e.on("err:"+o$o,this,this._err),o$W.__loadingSound[o$o]||(o$W.__loadingSound[o$o]=!0,o$b.loader.load(o$o,o$$.create(this,this.onloaded),null,o$Vo.BUFFER,4,!1,null,!0)))},o$r.onloaded=function(o$o){o$o||this._err(),this._disposed?this._removeLoadEvents():(this.data=o$o,o$W.buffs.push({buffer:this.data,url:this.url}),o$W.decode())},o$r._err=function(){if(this._removeLoadEvents(),o$W.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var o$o,o$r,o$T,o$k=0;for(o$o=(o$r=this.__toPlays).length,o$k=0;o$k<o$o;o$k++)(o$T=o$r[o$k])[3]&&!o$T[3].isStopped&&o$T[3].event("error");this.__toPlays.length=0}},o$r._loaded=function(o$o){this._removeLoadEvents(),this._disposed||(this.audioBuffer=o$o,this.loaded=!0,this.event("complete"))},o$r._removeLoadEvents=function(){o$W.e.off("loaded:"+this.url,this,this._loaded),o$W.e.off("err:"+this.url,this,this._err)},o$r.__playAfterLoaded=function(){if(this.__toPlays){var o$o,o$r,o$T,o$k=0;for(o$o=(o$r=this.__toPlays).length,o$k=0;o$k<o$o;o$k++)(o$T=o$r[o$k])[3]&&!o$T[3].isStopped&&this.play(o$T[0],o$T[1],o$T[2],o$T[3]);this.__toPlays.length=0}},o$r.play=function(o$o,o$r,o$T,o$k){return void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),o$k=o$k||new o$vo,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([o$o,o$r,o$T,o$k]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),o$k.url=this.url,o$k.loops=o$r,o$k.audioBuffer=this.audioBuffer,o$k.startTime=o$o,o$k.startHandler=o$T,o$k.play(!1),o$R.addChannel(o$k),o$k},o$r.dispose=function(){this._disposed=!0,delete o$W._dataCache[this.url],delete o$W.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},o$x(0,o$r,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),o$W.decode=function(){if(!(o$W.buffs.length<=0||o$W.isDecoding))if(o$W.isDecoding=!0,(o$W.tInfo=o$W.buffs.shift())&&o$W.tInfo.buffer&&o$W.tInfo.buffer.byteLength)try{o$W.ctx.decodeAudioData(o$W.tInfo.buffer,o$W._done,o$W._fail)}catch(o$o){console.error("decodeAudioData error  byteLength:"+o$W.tInfo.buffer.byteLength+"  url:"+o$W.tInfo.url)}else o$W._fail()},o$W._done=function(o$o){o$W.e.event("loaded:"+o$W.tInfo.url,o$o),o$W._dataCache[o$W.tInfo.url]=o$o,o$W.isDecoding=!1,o$W.decode()},o$W._fail=function(){o$W.e.event("err:"+o$W.tInfo.url,null),o$W.isDecoding=!1,o$W.decode()},o$W._playEmptySound=function(){if(null!=o$W.ctx){if(o$W._emptySource&&(o$W._emptySource.stop(),o$W._emptySource.disconnect(0),!o$vo._tryCleanFailed))try{o$W._emptySource.buffer=null}catch(o$o){o$vo._tryCleanFailed=!0}var o$o=o$W.ctx.createBufferSource();o$o.buffer=o$W._miniBuffer,o$o.connect(o$W.ctx.destination),o$o.start(0,0,0),o$W._emptySource=o$o}},o$W._unlock=function(){o$W._unlocked||(o$W._playEmptySound(),"running"==o$W.ctx.state?(o$e.document.removeEventListener("mousedown",o$W._unlock,!0),o$e.document.removeEventListener("touchend",o$W._unlock,!0),o$e.document.removeEventListener("touchstart",o$W._unlock,!0),o$W._unlocked=!0):"suspended"==o$W.ctx.state&&o$R._recoverWebAudio())},o$W.initWebAudio=function(){"running"!=o$W.ctx.state&&(o$W._unlock(),o$e.document.addEventListener("mousedown",o$W._unlock,!0),o$e.document.addEventListener("touchend",o$W._unlock,!0),o$e.document.addEventListener("touchstart",o$W._unlock,!0))},o$W._emptySource=null,o$W._dataCache={},o$W.buffs=[],o$W.isDecoding=!1,o$W._unlocked=!1,o$W.tInfo=null,o$W.__loadingSound={},o$L(o$W,["window",function(){return this.window=o$e.window},"webAudioEnabled",function(){return this.webAudioEnabled=o$W.window.AudioContext||o$W.window.webkitAudioContext||o$W.window.mozAudioContext},"ctx",function(){return this.ctx=o$W.webAudioEnabled?new(o$W.window.AudioContext||o$W.window.webkitAudioContext||o$W.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=o$W.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new o$U}]),o$W}(),o$no=function(o$o){function o$r(){this._responseType=null,this._data=null,o$r.__super.call(this),this._http=new o$e.window.XMLHttpRequest}o$h(o$r,"laya.net.HttpRequest",o$U);var o$T=o$r.prototype;return o$T.send=function(o$o,o$r,o$T,o$k,o$W){void 0===o$T&&(o$T="get"),void 0===o$k&&(o$k="text"),this._responseType=o$k,this._data=null;var o$D=this,o$n=this._http;if(o$n.open(o$T,o$o,!0),o$W)for(var o$V=0;o$V<o$W.length;o$V++)o$n.setRequestHeader(o$W[o$V++],o$W[o$V]);else o$C.isConchApp||(o$r&&"string"!=typeof o$r?o$n.setRequestHeader("Content-Type","application/json"):o$n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));o$n.responseType="arraybuffer"!==o$k?"text":"arraybuffer",o$n.onerror=function(o$o){o$D._onError(o$o)},o$n.onabort=function(o$o){o$D._onAbort(o$o)},o$n.onprogress=function(o$o){o$D._onProgress(o$o)},o$n.onload=function(o$o){o$D._onLoad(o$o)},o$n.send(o$r)},o$T._onProgress=function(o$o){o$o&&o$o.lengthComputable&&this.event("progress",o$o.loaded/o$o.total)},o$T._onAbort=function(o$o){this.error("Request was aborted by user")},o$T._onError=function(o$o){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},o$T._onLoad=function(o$o){var o$r=this._http,o$T=void 0!==o$r.status?o$r.status:200;200===o$T||204===o$T||0===o$T?this.complete():this.error("["+o$r.status+"]"+o$r.statusText+":"+o$r.responseURL)},o$T.error=function(o$o){this.clear(),this.event("error",o$o)},o$T.complete=function(){this.clear();var o$r=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=o$g.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(o$o){o$r=!1,this.error(o$o.message)}o$r&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},o$T.clear=function(){var o$o=this._http;o$o.onerror=o$o.onabort=o$o.onprogress=o$o.onload=null},o$x(0,o$T,"url",function(){return this._http.responseURL}),o$x(0,o$T,"http",function(){return this._http}),o$x(0,o$T,"data",function(){return this._data}),o$r}(),o$Vo=function(o$o){function o$t(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,o$t.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}o$h(o$t,"laya.net.Loader",o$U);var o$r=o$t.prototype;return o$r.load=function(o$o,o$r,o$T,o$k,o$W){if(o$o&&""!=o$o||console.error("Loader 加载的url不合法 "+o$o),void 0===o$T&&(o$T=!0),void 0===o$W&&(o$W=!1),0===(this._url=o$o).indexOf("data:image")?this._type=o$r="image":this._type=o$r||(o$r=this.getTypeFromUrl(o$o)),this._cache=o$T,this._data=null,!o$W&&o$t.loadedMap[o$o])return this._data=o$t.loadedMap[o$o],this.event("progress",1),void this.event("complete",this._data);if(o$k&&o$t.setGroup(o$o,o$k),null!=o$t.parserMap[o$r])return this._customParse=!0,void(o$t.parserMap[o$r]instanceof laya.utils.Handler?o$t.parserMap[o$r].runWith(this):o$t.parserMap[o$r].call(null,this));if("image"===o$r||"htmlimage"===o$r||"nativeimage"===o$r)return this._loadImage(o$o);if("ttf"===o$r)return this._loadTTF(o$o);switch(o$r){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:o$r}o$t.preLoadedMap[o$o]?this.onLoaded(o$t.preLoadedMap[o$o]):o$n.resMgrLoad(o$o,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},o$r.getTypeFromUrl=function(o$o){var o$r=o$g.getFileExtension(o$o);return o$r?o$t.typeMap[o$r]:(console.warn("Not recognize the resources suffix",o$o),"text")},o$r._loadTTF=function(o$o){o$o=o$m.formatURL(o$o);var o$r=new o$z;o$r.complete=o$$.create(this,this.onLoaded),o$r.load(o$o)},o$r._loadImage=function(o$o){o$n.imgMgrLoad(o$o,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},o$r._loadImageComplete=function(o$o,o$r,o$T){if(null!=o$T)if(o$T instanceof ArrayBuffer){var o$k=new DataView(o$T),o$W=new laya.webgl.resource.WebGLImage(new Uint8Array(o$T,8),o$o,0,!1,o$k.getUint32(0),o$k.getUint32(4));this.onLoaded(o$W)}else if(o$T instanceof o$ho)o$t.imgMgrSet[o$o]=o$r,o$n.imgMgrLock(o$o,o$t.imgMgrSet[o$o]),this._url=o$o,this.complete(o$T);else{var o$D=-1!=o$o.indexOf(".png",o$o.length-4)?6408:6407;o$W=new laya.webgl.resource.WebGLImage(o$T,o$o,o$D,!1,o$T.width,o$T.height);this.onLoaded(o$W)}else this.event("error","Load image failed")},o$r._loadSound=function(o$o){var o$r=new o$R._soundClass,o$T=this;function o$k(){o$r.offAll()}o$r.on("complete",this,function(){o$k(),o$T.onLoaded(o$r)}),o$r.on("error",this,function(){o$k(),o$r.dispose(),o$T.event("error","Load sound failed")}),o$r.load(o$o)},o$r.onProgress=function(o$o){"atlas"===this._type?this.event("progress",.3*o$o):this.event("progress",o$o)},o$r.onError=function(o$o){this.event("error",o$o)},o$r._loadedComplete=function(o$o,o$r,o$T){if(null!=o$T)switch(this._type){case"atlas":case"plf":case"json":var o$k=new o$J(o$T);this.onLoaded(JSON.parse(o$k.readUTFBytes()));break;case"font":o$k=new o$J(o$T);this.onLoaded(o$g.parseXMLFromString(o$k.readUTFBytes()));break;default:this.onLoaded(o$T)}else this.event("error",o$o)},o$r.onLoaded=function(o$o){var o$r=this._type;if("plf"==o$r)this.parsePLFData(o$o),this.complete(o$o);else if("image"===o$r){var o$T=new o$ho(o$o);o$T.url=this._url,this.complete(o$T)}else if("sound"===o$r||"htmlimage"===o$r||"nativeimage"===o$r)this.complete(o$o);else if("atlas"===o$r){if(!o$o.src&&!o$o._setContext){if(!this._data){if((this._data=o$o).meta&&o$o.meta.image)for(var o$k=o$o.meta.image.split(","),o$W=0<=this._url.indexOf("/")?"/":"\\",o$D=this._url.lastIndexOf(o$W),o$n=0<=o$D?this._url.substr(0,o$D+1):"",o$V=0,o$L=o$k.length;o$V<o$L;o$V++)o$k[o$V]=o$n+o$k[o$V];else o$k=[this._url.replace(".json",".png")];o$k.reverse(),o$o.toLoads=o$k,o$o.pics=[]}return this.event("progress",.3+1/o$k.length*.6),this._loadImage(o$k.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(o$o),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var o$U=this._data.frames,o$h=this._url.split("?")[0],o$p=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:o$h.substring(0,o$h.lastIndexOf("."))+"/",o$i=this._data.pics,o$v=o$m.formatURL(this._url),o$x=o$t.atlasMap[o$v]||(o$t.atlasMap[o$v]=[]);o$x.dir=o$p;var o$j=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var o$_ in o$j=parseFloat(this._data.meta.scale),o$U){var o$K,o$$=o$U[o$_],o$y=o$i[o$$.frame.idx?o$$.frame.idx:0],o$l=o$m.formatURL(o$p+o$_);o$y.scaleRate=o$j,o$K=o$ho.create(o$y,o$$.frame.x,o$$.frame.y,o$$.frame.w,o$$.frame.h,o$$.spriteSourceSize.x,o$$.spriteSourceSize.y,o$$.sourceSize.w,o$$.sourceSize.h),o$t.cacheRes(o$l,o$K),o$t.keepCache(this._url,o$p+o$_),o$K.url=o$l,o$x.push(o$l)}else for(o$_ in o$U)o$y=o$i[(o$$=o$U[o$_]).frame.idx?o$$.frame.idx:0],o$l=o$m.formatURL(o$p+o$_),o$t.cacheRes(o$l,o$ho.create(o$y,o$$.frame.x,o$$.frame.y,o$$.frame.w,o$$.frame.h,o$$.spriteSourceSize.x,o$$.spriteSourceSize.y,o$$.sourceSize.w,o$$.sourceSize.h)),o$t.loadedMap[o$l].url=o$l,o$t.keepCache(this._url,o$p+o$_),o$x.push(o$l);delete this._data.pics,this.complete(this._data)}else if("font"==o$r){if(!o$o.src)return this._data=o$o,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var o$S=new o$H;o$S.parseFont(this._data,o$o);var o$q=this._url.split(".fnt")[0].split("/"),o$b=o$q[o$q.length-1];o$_o.registerBitmapFont(o$b,o$S),this._data=o$S,this.complete(this._data)}else if("pkm"==o$r){var o$F=o$qo.create(o$o,this._url),o$P=new o$ho(o$F);o$P.url=this._url,this.complete(o$P)}else this.complete(o$o)},o$r.parsePLFData=function(o$o){var o$r,o$T,o$k;for(o$r in o$o)switch(o$k=o$o[o$r],o$r){case"json":case"text":for(o$T in o$k)o$t.preLoadedMap[o$m.formatURL(o$T)]=o$k[o$T];break;default:for(o$T in o$k)o$t.preLoadedMap[o$m.formatURL(o$T)]=o$k[o$T]}},o$r.complete=function(o$o){this._data=o$o,this._customParse?this.event("loaded",o$o instanceof Array?[o$o]:o$o):(o$t._loaders.push(this),o$t._isWorking||o$t.checkNext())},o$r.endLoad=function(o$o){o$o&&(this._data=o$o),this._cache&&o$t.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},o$x(0,o$r,"url",function(){return this._url}),o$x(0,o$r,"data",function(){return this._data}),o$x(0,o$r,"cache",function(){return this._cache}),o$x(0,o$r,"type",function(){return this._type}),o$t.checkNext=function(){o$t._isWorking=!0;for(var o$o=o$e.now();o$t._startIndex<o$t._loaders.length;)if(o$e.now(),o$t._loaders[o$t._startIndex].endLoad(),o$t._startIndex++,o$e.now()-o$o>o$t.maxTimeOut)return console.warn("loader callback cost a long time:"+(o$e.now()-o$o)+" url="+o$t._loaders[o$t._startIndex-1].url),void o$b.timer.frameOnce(1,null,o$t.checkNext);o$t._loaders.length=0,o$t._startIndex=0,o$t._isWorking=!1},o$t.clearRes=function(o$o,o$r){if(null!=o$o){void 0===o$r&&(o$r=!1),o$o=o$m.formatURL(o$o);var o$T=o$t.getAtlas(o$o);if(o$T){for(var o$k=0,o$W=o$T.length;o$k<o$W;o$k++){var o$D=o$T[o$k],o$n=o$t.getRes(o$D);delete o$t.loadedMap[o$D],o$t.clearCache(o$o.substring(o$m.basePath.length),o$D.substring(o$m.basePath.length)),o$n&&o$n.destroy(o$r)}o$T.length=0,delete o$t.atlasMap[o$o],delete o$t.loadedMap[o$o]}else{var o$V=o$t.loadedMap[o$o];o$V&&(delete o$t.loadedMap[o$o],o$V instanceof laya.resource.Texture&&o$V.bitmap&&o$V.destroy(o$r))}}},o$t.clearTextureRes=function(o$o){o$o=o$m.formatURL(o$o);var o$r=laya.net.Loader.getAtlas(o$o),o$T=o$r&&0<o$r.length?laya.net.Loader.getRes(o$r[0]):laya.net.Loader.getRes(o$o);o$T&&o$T.bitmap&&(o$C.isConchApp&&!o$C.isConchWebGL?o$T.bitmap.source.releaseTexture&&o$T.bitmap.source.releaseTexture():null==o$T.bitmap._atlaser&&o$T.bitmap.releaseResource(!0))},o$t.getRes=function(o$o){return o$t.loadedMap[o$m.formatURL(o$o)]},o$t.getAtlas=function(o$o){return o$t.atlasMap[o$m.formatURL(o$o)]},o$t.cacheRes=function(o$o,o$r){o$o=o$m.formatURL(o$o),null!=o$t.loadedMap[o$o]?console.warn("Resources already exist,is repeated loading:",o$o):o$t.loadedMap[o$o]=o$r},o$t.setGroup=function(o$o,o$r){o$t.groupMap[o$r]||(o$t.groupMap[o$r]=[]),o$t.groupMap[o$r].push(o$o)},o$t.clearResByGroup=function(o$o){if(o$t.groupMap[o$o]){var o$r=o$t.groupMap[o$o],o$T=0,o$k=o$r.length;for(o$T=0;o$T<o$k;o$T++)o$t.clearRes(o$r[o$T]);o$r.length=0}},o$t.keepCache=function(o$o,o$r){if(o$o&&o$r){var o$T=o$t.cacheSet[o$r];o$T?-1==o$T.indexOf(o$o)&&o$T.push(o$o):o$t.cacheSet[o$r]=[o$o]}},o$t.clearCache=function(o$o,o$r){if(o$o&&o$r){var o$T=o$t.cacheSet[o$r];if(o$T){var o$k=o$T.indexOf(o$o);if(-1!==o$k){var o$W=o$T.length-1;0==o$W?(delete o$t.cacheSet[o$r],0<o$t.imgMgrSet[o$r]?o$n.imgMgrFree(o$r,o$t.imgMgrSet[o$r]):o$t.clearRes(o$r,!0)):(o$T[o$k]=o$T[o$W],o$T.length=o$W)}}}},o$t.saveObject=function(o$o,o$r,o$T){if(o$r&&o$o){var o$k=o$t.objectSet[o$o];o$k?(console.warn("Loader.saveObject: "+o$o),o$k[0]=o$r,o$k[1]=o$T):o$t.objectSet[o$o]=[o$r,o$T,[]]}},o$t.findObject=function(o$o){if(o$o){var o$r=o$t.objectSet[o$o];if(o$r)return o$r[0]}return null},o$t.keepObject=function(o$o,o$r){if(o$o&&o$r){var o$T=o$t.objectSet[o$r];o$T&&-1===o$T[2].indexOf(o$o)&&o$T[2].push(o$o)}},o$t.clearObject=function(o$o,o$r){if(o$o&&o$r){var o$T=o$t.objectSet[o$r];if(o$T){var o$k=o$T[2],o$W=o$k.indexOf(o$o);if(-1!==o$W){var o$D=o$k.length-1;0==o$D?(delete o$t.objectSet[o$r],o$T[1]&&o$T[1].call(null,o$T[0])):(o$k[o$W]=o$k[o$D],o$k.length=o$D)}}}},o$t.TEXT="text",o$t.JSON="json",o$t.XML="xml",o$t.BUFFER="arraybuffer",o$t.IMAGE="image",o$t.SOUND="sound",o$t.ATLAS="atlas",o$t.FONT="font",o$t.TTF="ttf",o$t.PLF="plf",o$t.PKM="pkm",o$t.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},o$t.parserMap={},o$t.groupMap={},o$t.maxTimeOut=100,o$t.loadedMap={},o$t.preLoadedMap={},o$t.atlasMap={},o$t._loaders=[],o$t._isWorking=!1,o$t._startIndex=0,o$t.imgCache={},o$t.cacheSet={},o$t.objectSet={},o$t.imgMgrSet={},o$t}(),o$Lo=function(o$o){var o$i;function o$v(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},o$v.__super.call(this);for(var o$o=0;o$o<this._maxPriority;o$o++)this._resInfos[o$o]=[]}o$h(o$v,"laya.net.LoaderManager",o$U);var o$r=o$v.prototype;return o$r.create=function(o$o,o$T,o$r,o$k,o$W,o$D,o$n,o$V){if(null==o$D&&(o$D=2),null==o$n&&(o$n=!0),o$o instanceof Array){var o$L=o$o,o$U=o$L.length,o$h=0;if(o$r)var o$p=o$$.create(o$r.caller,o$r.method,o$r.args,!1);for(var o$i=0;o$i<o$U;o$i++){var o$v=o$L[o$i];"string"==typeof o$v&&(o$v=o$L[o$i]={url:o$v}),o$v.progress=0}for(o$i=0;o$i<o$U;o$i++){o$v=o$L[o$i];var o$x=o$r?o$$.create(null,o$K,[o$v],!1):null,o$j=o$r||o$T?o$$.create(null,o$_,[o$v]):null;this._create(o$v.url,o$j,o$x,o$v.clas||o$k,o$v.params||o$W,null!=o$v.priority&&0<=o$v.priority?o$v.priority:o$D,o$n,o$v.group||o$V)}function o$_(o$o,o$r){o$h++,o$o.progress=1,o$h===o$U&&o$T&&o$T.run()}function o$K(o$o,o$r){o$o.progress=o$r;for(var o$T=0,o$k=0;o$k<o$U;o$k++){o$T+=o$L[o$k].progress}var o$W=o$T/o$U;o$p.runWith(o$W)}return!0}return this._create(o$o,o$T,o$r,o$k,o$W,o$D,o$n,o$V)},o$r._create=function(o$r,o$T,o$o,o$k,o$W,o$D,o$n,o$V){o$r&&""!=o$r||console.error("加载的url不合法 "+o$r),null==o$D&&(o$D=2),null==o$n&&(o$n=!0);var o$L=o$m.formatURL(o$r),o$U=this.getRes(o$L);if(o$U)!o$U.hasOwnProperty("loaded")||o$U.loaded?(o$o&&o$o.runWith(1),o$T&&o$T.run()):o$T&&o$b.loader._createListener(o$r,o$T.caller,o$T.method,o$T.args,!0,!1);else{var o$h=o$g.getFileExtension(o$r),o$p=o$v.createMap[o$h];if(!o$p)throw new Error("LoaderManager:unknown file("+o$r+") extension with: "+o$h+".");o$k||(o$k=o$p[0]);var o$i=o$p[1];if("atlas"==o$h)this.load(o$r,o$T,o$o,o$i,o$D,o$n);else{o$k===o$ho&&(o$i="htmlimage"),(o$U=o$k?new o$k:null).hasOwnProperty("_loaded")&&(o$U._loaded=!1),o$U._setUrl(o$r),o$V&&o$U._setGroup(o$V),this._createLoad(o$U,o$r,o$$.create(null,function(o$o){o$U&&!o$U.destroyed&&o$o&&o$U.onAsynLoaded.call(o$U,o$r,o$o,o$W),o$T&&o$T.run();o$b.loader.event(o$r)}),o$o,o$i,o$D,!1,o$V,!0),o$n&&this.cacheRes(o$L,o$U)}}return o$U},o$r.load=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){o$o&&""!=o$o||console.error("加载的url不合法 "+o$o);var o$L=this;if(null==o$W&&(o$W=2),null==o$D&&(o$D=!0),void 0===o$V&&(o$V=!1),o$o instanceof Array)return this._loadAssets(o$o,o$r,o$T,o$k,o$W,o$D,o$n);var o$U=o$Vo.getRes(o$o);if(null!=o$U)o$b.timer.frameOnce(1,null,function(){o$T&&o$T.runWith(1),o$r&&o$r.runWith(o$U),o$L._loaderCount||o$L.event("complete")});else{var o$h=o$v._resMap[o$o];o$h?(o$r&&o$h._createListener("complete",o$r.caller,o$r.method,o$r.args,!1,!1),o$T&&o$h._createListener("progress",o$T.caller,o$T.method,o$T.args,!1,!1)):((o$h=this._infoPool.length?this._infoPool.pop():new o$i).url=o$o,o$h.type=o$k,o$h.cache=o$D,o$h.group=o$n,o$h.ignoreCache=o$V,o$h.priority=o$W,o$r&&o$h.on("complete",o$r.caller,o$r.method,o$r.args),o$T&&o$h.on("progress",o$T.caller,o$T.method,o$T.args),o$v._resMap[o$o]=o$h,o$W=o$W<this._maxPriority?0<=o$W?o$W:0:this._maxPriority-1,this._resInfos[o$W].push(o$h),this._next())}return this},o$r._createLoad=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){var o$U=this;if(null==o$D&&(o$D=2),null==o$n&&(o$n=!0),void 0===o$L&&(o$L=!1),o$r instanceof Array)return this._loadAssets(o$r,o$T,o$k,o$W,o$D,o$n,o$V);var o$h=o$Vo.getRes(o$r);if(null!=o$h)o$b.timer.frameOnce(1,null,function(){o$k&&o$k.runWith(1),o$T&&o$T.runWith(o$h),o$U._loaderCount||o$U.event("complete")});else{var o$p=o$v._resMap[o$r];o$p?(o$T&&o$p._createListener("complete",o$T.caller,o$T.method,o$T.args,!1,!1),o$k&&o$p._createListener("progress",o$k.caller,o$k.method,o$k.args,!1,!1)):((o$p=this._infoPool.length?this._infoPool.pop():new o$i).url=o$r,o$p.clas=o$o,o$p.type=o$W,o$p.cache=o$n,o$p.group=o$V,o$p.ignoreCache=o$L,o$p.priority=o$D,o$T&&o$p.on("complete",o$T.caller,o$T.method,o$T.args),o$k&&o$p.on("progress",o$k.caller,o$k.method,o$k.args),o$v._resMap[o$r]=o$p,o$D=o$D<this._maxPriority?0<=o$D?o$D:0:this._maxPriority-1,this._resInfos[o$D].push(o$p),this._next())}return this},o$r._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var o$o=0;o$o<this._maxPriority;o$o++)for(var o$r=this._resInfos[o$o];0<o$r.length;){var o$T=o$r.shift();if(o$T)return this._doLoad(o$T)}this._loaderCount||this.event("complete")}},o$r._doLoad=function(o$r){this._loaderCount++;var o$T=this._loaders.length?this._loaders.pop():new o$Vo;o$T.on("complete",null,o$W),o$T.on("progress",null,function(o$o){o$r.event("progress",o$o)}),o$T.on("error",null,function(o$o){o$W(null)});var o$k=this;function o$W(o$o){o$T.offAll(),o$T._data=null,o$T._customParse=!1,o$k._loaders.push(o$T),o$k._endLoad(o$r,o$o instanceof Array?[o$o]:o$o),o$k._loaderCount--,o$k._next()}o$T._class=o$r.clas,1<=o$r.priority?(o$T.priority=o$r.priority,o$T.realTime=!1):(o$T.priority=0,o$T.realTime=!0),o$T.load(o$r.url,o$r.type,o$r.cache,o$r.group,o$r.ignoreCache)},o$r._endLoad=function(o$o,o$r){var o$T=o$o.url;if(null==o$r){var o$k=this._failRes[o$T]||0;if(o$k<this.retryNum)return console.warn("[warn]Retry to load:",o$T),this._failRes[o$T]=o$k+1,void o$b.timer.once(this.retryDelay,this,this._addReTry,[o$o],!1);console.warn("[error]Failed to load:",o$T),this.event("error",o$T)}this._failRes[o$T]&&(this._failRes[o$T]=0),delete o$v._resMap[o$T],o$o.event("complete",o$r),o$o.offAll(),this._infoPool.push(o$o)},o$r._addReTry=function(o$o){this._resInfos[this._maxPriority-1].push(o$o),this._next()},o$r.clearRes=function(o$o,o$r){void 0===o$r&&(o$r=!1),o$Vo.clearRes(o$o,o$r)},o$r.getRes=function(o$o){return o$Vo.getRes(o$o)},o$r.cacheRes=function(o$o,o$r){o$Vo.cacheRes(o$o,o$r)},o$r.clearTextureRes=function(o$o){o$Vo.clearTextureRes(o$o)},o$r.setGroup=function(o$o,o$r){o$Vo.setGroup(o$o,o$r)},o$r.clearResByGroup=function(o$o){o$Vo.clearResByGroup(o$o)},o$r.clearUnLoaded=function(){for(var o$o=0;o$o<this._maxPriority;o$o++){for(var o$r=this._resInfos[o$o],o$T=o$r.length-1;-1<o$T;o$T--){var o$k=o$r[o$T];o$k&&(o$k.offAll(),this._infoPool.push(o$k))}o$r.length=0}this._loaderCount=0,o$v._resMap={}},o$r.cancelLoadByUrls=function(o$o){if(o$o)for(var o$r=0,o$T=o$o.length;o$r<o$T;o$r++)this.cancelLoadByUrl(o$o[o$r])},o$r.cancelLoadByUrl=function(o$o){for(var o$r=0;o$r<this._maxPriority;o$r++)for(var o$T=this._resInfos[o$r],o$k=o$T.length-1;-1<o$k;o$k--){var o$W=o$T[o$k];o$W&&o$W.url===o$o&&(o$T[o$k]=null,o$W.offAll(),this._infoPool.push(o$W))}o$v._resMap[o$o]&&delete o$v._resMap[o$o]},o$r._loadAssets=function(o$o,o$T,o$n,o$r,o$k,o$W,o$D){null==o$k&&(o$k=2),null==o$W&&(o$W=!0);for(var o$V=o$o.length,o$L=0,o$U=0,o$h=[],o$p=!0,o$i=0;o$i<o$V;o$i++){var o$v=o$o[o$i];if(!o$v)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+o$o);"string"==typeof o$v&&(o$v={url:o$v,type:o$r,size:1,priority:o$k}),o$v.size||(o$v.size=1),o$v.progress=0,o$U+=o$v.size,o$h.push(o$v);var o$x=o$n?o$$.create(null,o$K,[o$v],!1):null,o$j=o$T||o$n?o$$.create(null,o$_,[o$v]):null;this.load(o$v.url,o$j,o$x,o$v.type,null!=o$v.priority&&0<=o$v.priority?o$v.priority:2,o$W,o$v.group||o$D)}function o$_(o$o,o$r){o$L++,o$o.progress=1,o$r||(o$p=!1),o$L===o$V&&o$T&&o$T.runWith(o$p)}function o$K(o$o,o$r){if(null!=o$n){o$o.progress=o$r;for(var o$T=0,o$k=0;o$k<o$h.length;o$k++){var o$W=o$h[o$k];o$T+=o$W.size*o$W.progress}var o$D=o$T/o$U;o$n.runWith(o$D)}}return this},o$v.cacheRes=function(o$o,o$r){o$Vo.cacheRes(o$o,o$r)},o$v._resMap={},o$L(o$v,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),o$v.__init$=function(){o$i=function(o$o){function o$r(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,o$r.__super.call(this)}return o$h(o$r,"",o$U),o$r}()},o$v}(),o$Uo=(function(o$o){function o$W(o$o){o$W.__super.call(this),o$o||(o$o=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var o$r=0,o$T=0,o$k=0;o$k<20;o$k++)o$k%5!=4?this._mat[o$r++]=o$o[o$k]:this._alpha[o$T++]=o$o[o$k];this._action=o$u.createFilterAction(32),this._action.data=this}o$h(o$W,"laya.filters.ColorFilter",o$K);var o$r=o$W.prototype;o$b.imps(o$r,{"laya.filters.IFilter":!0}),o$r.callNative=function(o$o){o$o._$P.cf=this;o$o.conchModel&&o$o.conchModel.setFilterMatrix&&o$o.conchModel.setFilterMatrix(this._mat,this._alpha)},o$x(0,o$r,"type",function(){return 32}),o$x(0,o$r,"action",function(){return this._action})}(),function(o$o){function o$k(o$o,o$r,o$T){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===o$r&&(o$r=0),o$k.__super.call(this),this._byteClass=o$T||o$J,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,o$o&&0<o$r&&o$r<65535&&this.connect(o$o,o$r)}o$h(o$k,"laya.net.Socket",o$U);var o$r=o$k.prototype;o$r.connect=function(o$o,o$r){var o$T="ws://"+o$o+":"+o$r;o$T="https:"==o$e.window.location.protocol?"wss://"+o$o+":"+o$r:"ws://"+o$o+":"+o$r,this.connectByUrl(o$T)},o$r.connectByUrl=function(o$o){var o$r=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new o$e.window.WebSocket(o$o,this.protocols):this._socket=new o$e.window.WebSocket(o$o),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(o$o){o$r._onOpen(o$o)},this._socket.onmessage=function(o$o){o$r._onMessage(o$o)},this._socket.onclose=function(o$o){o$r._onClose(o$o)},this._socket.onerror=function(o$o){o$r._onError(o$o)}},o$r.cleanSocket=function(){try{this._socket.close()}catch(o$o){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},o$r.close=function(){if(null!=this._socket)try{this._socket.close()}catch(o$o){}},o$r._onOpen=function(o$o){this._connected=!0,this.event("open",o$o)},o$r._onMessage=function(o$o){if(o$o&&o$o.data){var o$r=o$o.data;if(this.disableInput&&o$r)this.event("message",o$r);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var o$T=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,o$r&&("string"==typeof o$r?this._input.writeUTFBytes(o$r):this._input.writeArrayBuffer(o$r),this._addInputPosition=this._input.pos,this._input.pos=o$T),this.event("message",o$r)}}},o$r._onClose=function(o$o){this._connected=!1,this.event("close",o$o)},o$r._onError=function(o$o){this.event("error",o$o)},o$r.send=function(o$o){this._socket.send(o$o)},o$r.flush=function(){if(this._output&&0<this._output.length){var o$r;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(o$o){o$r=o$o}this._output.endian=this.endian,this._output.clear(),o$r&&this.event("error",o$r)}},o$x(0,o$r,"input",function(){return this._input}),o$x(0,o$r,"output",function(){return this._output}),o$x(0,o$r,"connected",function(){return this._connected}),o$x(0,o$r,"endian",function(){return this._endian},function(o$o){this._endian=o$o,null!=this._input&&(this._input.endian=o$o),null!=this._output&&(this._output.endian=o$o)}),o$k.LITTLE_ENDIAN="littleEndian",o$k.BIG_ENDIAN="bigEndian"}(),function(o$o){function o$V(){o$V.__super.call(this),this._$1__id=++o$V._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(o$V._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,o$c.currentResourceManager&&o$c.currentResourceManager.addResource(this)}o$h(o$V,"laya.resource.Resource",o$U);var o$r=o$V.prototype;return o$b.imps(o$r,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),o$r._setUrl=function(o$o){var o$r;this._url!==o$o&&(this._url&&((o$r=o$V._urlResourcesMap[this._url]).splice(o$r.indexOf(this),1),0===o$r.length&&delete o$V._urlResourcesMap[this._url]),o$o&&((o$r=o$V._urlResourcesMap[o$o])||(o$V._urlResourcesMap[o$o]=o$r=[]),o$r.push(this)),this._url=o$o)},o$r._getGroup=function(){return this._group},o$r._setGroup=function(o$o){var o$r;this._group!==o$o&&(this._group&&((o$r=o$V._groupResourcesMap[this._group]).splice(o$r.indexOf(this),1),0===o$r.length&&delete o$V._groupResourcesMap[this._group]),o$o&&((o$r=o$V._groupResourcesMap[o$o])||(o$V._groupResourcesMap[o$o]=o$r=[]),o$r.push(this)),this._group=o$o)},o$r._addReference=function(){this._referenceCount++},o$r._removeReference=function(){this._referenceCount--},o$r._clearReference=function(){this._referenceCount=0},o$r._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},o$r.recreateResource=function(){this.completeCreate()},o$r.disposeResource=function(){},o$r.activeResource=function(o$o){void 0===o$o&&(o$o=!1),this._lastUseFrameCount=o$w.loopCount,!this._destroyed&&this.__loaded&&(this._released||o$o)&&this.recreateResource()},o$r.releaseResource=function(o$o){return void 0===o$o&&(o$o=!0),!(!o$o&&this.lock)&&(!(this._released&&!o$o)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},o$r.onAsynLoaded=function(o$o,o$r,o$T){throw new Error("Resource: must override this function!")},o$r.destroy=function(){var o$o;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete o$V._idResourcesMap[this.id],this._url&&((o$o=o$V._urlResourcesMap[this._url])&&(o$o.splice(o$o.indexOf(this),1),0===o$o.length&&delete o$V._urlResourcesMap[this.url]),o$Vo.clearRes(this._url),this.__loaded||o$u.cancelLoadByUrl(this._url)),this._group&&((o$o=o$V._groupResourcesMap[this._group]).splice(o$o.indexOf(this),1),0===o$o.length&&delete o$V._groupResourcesMap[this.url]))},o$r.completeCreate=function(){this._released=!1,this.event("recovered",this)},o$r.dispose=function(){this.destroy()},o$x(0,o$r,"memorySize",function(){return this._memorySize},function(o$o){var o$r=o$o-this._memorySize;this._memorySize=o$o,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,o$r),this.resourceManager&&this.resourceManager.addSize(o$r)}),o$x(0,o$r,"_loaded",null,function(o$o){this.__loaded=o$o}),o$x(0,o$r,"loaded",function(){return this.__loaded}),o$x(0,o$r,"id",function(){return this._$1__id}),o$x(0,o$r,"destroyed",function(){return this._destroyed}),o$x(0,o$r,"group",function(){return this._getGroup()},function(o$o){this._setGroup(o$o)}),o$x(0,o$r,"resourceManager",function(){return this._resourceManager}),o$x(0,o$r,"url",function(){return this._url}),o$x(0,o$r,"released",function(){return this._released}),o$x(0,o$r,"referenceCount",function(){return this._referenceCount}),o$V.getResourceByID=function(o$o){return o$V._idResourcesMap[o$o]},o$V.getResourceByURL=function(o$o,o$r){return void 0===o$r&&(o$r=0),null==o$V._urlResourcesMap[o$o]?null:o$V._urlResourcesMap[o$o][o$r]},o$V.getResourceCountByURL=function(o$o){return o$V._urlResourcesMap[o$o].length},o$V.destroyUnusedResources=function(o$o){var o$r;if(o$o){var o$T=o$V._groupResourcesMap[o$o];if(o$T)for(var o$k=o$T.slice(),o$W=0,o$D=o$k.length;o$W<o$D;o$W++)(o$r=o$k[o$W]).lock||0!==o$r._referenceCount||o$r.destroy()}else for(var o$n in o$V._idResourcesMap)(o$r=o$V._idResourcesMap[o$n]).lock||0!==o$r._referenceCount||o$r.destroy()},o$V._uniqueIDCounter=0,o$V._idResourcesMap={},o$V._urlResourcesMap={},o$V._groupResourcesMap={},o$V}()),o$ho=function(o$o){function o$t(o$o,o$r){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,o$t.__super.call(this),o$o&&null!=o$o._addReference&&o$o._addReference(),this.setTo(o$o,o$r)}o$h(o$t,"laya.resource.Texture",o$U);var o$r=o$t.prototype;return o$r._setUrl=function(o$o){this.url=o$o},o$r.setTo=function(o$o,o$r){if(o$o instanceof o$n.HTMLElement){var o$T=o$yo.create("2D",o$o);this.bitmap=o$T}else this.bitmap=o$o;if(this.uv=o$r||o$t.DEF_UV,o$o){this._w=o$o.width,this._h=o$o.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var o$k=this;if(this._loaded)o$u.addToAtlas&&o$u.addToAtlas(o$k);else{var o$W=o$o;o$W instanceof laya.resource.HTMLImage&&o$W.image&&o$W.image.addEventListener("load",function(o$o){o$u.addToAtlas&&o$u.addToAtlas(o$k)},!1)}}},o$r.active=function(){this.bitmap&&this.bitmap.activeResource()},o$r.destroy=function(o$o){if(void 0===o$o&&(o$o=!1),this.alphaTexture&&(this.alphaTexture.destroy(o$o),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var o$r=this.bitmap;o$o?(o$C.isConchApp&&o$r.source&&o$r.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,o$r.dispose(),o$r._clearReference()):(o$r._removeReference(),0==o$r.referenceCount&&(o$C.isConchApp&&o$r.source&&o$r.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,o$r.dispose())),this.url&&this===o$b.loader.getRes(this.url)&&o$b.loader.clearRes(this.url,o$o),this._loaded=!1}},o$r.load=function(o$o){var o$r=this;this._loaded=!1,o$o=o$m.customFormat(o$o);var o$T=this.bitmap||(this.bitmap=o$qo.create(o$o));o$T.uri=o$o,o$T&&o$T._addReference();var o$k=this;o$T.onload=function(){o$T.onload=null,o$k._loaded=!0,o$r.sourceWidth=o$r._w=o$T.width,o$r.sourceHeight=o$r._h=o$T.height,o$k.event("loaded",this),o$u.addToAtlas&&o$u.addToAtlas(o$k)}},o$r.addTextureToAtlas=function(o$o){o$u.addTextureToAtlas(this)},o$r.getPixels=function(o$o,o$r,o$T,o$k){if(o$C.isConchApp){var o$W=this.bitmap;if(o$W.source&&o$W.source.getImageData){var o$D=o$W.source.getImageData(o$o,o$r,o$T,o$k),o$n=new Uint8Array(o$D);return Array.from(o$n)}return null}return o$C.isWebGL?o$u.getTexturePixels(this,o$o,o$r,o$T,o$k):(o$e.canvas.size(o$T,o$k),o$e.canvas.clear(),o$e.context.drawTexture(this,-o$o,-o$r,this.width,this.height,0,0),o$e.context.getImageData(0,0,o$T,o$k).data)},o$r.onAsynLoaded=function(o$o,o$r){if(o$r){if("function"!=typeof o$r._addReference)throw new Error("bitmap._addReference is not a function. "+o$r.className+" "+typeof o$r._addReference+" "+o$r.constructor);o$r._addReference()}this.setTo(o$r,this.uv),this._loaded&&this.event("loaded",this)},o$x(0,o$r,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),o$x(0,o$r,"loaded",function(){return this._loaded}),o$x(0,o$r,"released",function(){return!this.bitmap||this.bitmap.released}),o$x(0,o$r,"width",function(){return this._w?this._w:this.uv&&this.uv!==o$t.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(o$o){this._w=o$o,this.sourceWidth||(this.sourceWidth=o$o)}),o$x(0,o$r,"repeat",function(){return!o$C.isWebGL||!this.bitmap||this.bitmap.repeat},function(o$o){o$o&&o$C.isWebGL&&this.bitmap&&(this.bitmap.repeat=o$o)&&(this.bitmap.enableMerageInAtlas=!1)}),o$x(0,o$r,"height",function(){return this._h?this._h:this.uv&&this.uv!==o$t.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(o$o){this._h=o$o,this.sourceHeight||(this.sourceHeight=o$o)}),o$x(0,o$r,"isLinearSampling",function(){return!o$C.isWebGL||9728!=this.bitmap.minFifter},function(o$o){!o$o&&o$C.isWebGL&&(o$o||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),o$t.moveUV=function(o$o,o$r,o$T){for(var o$k=0;o$k<8;o$k+=2)o$T[o$k]+=o$o,o$T[o$k+1]+=o$r;return o$T},o$t.create=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){void 0===o$D&&(o$D=0),void 0===o$n&&(o$n=0),void 0===o$V&&(o$V=0),void 0===o$L&&(o$L=0);var o$U=o$o instanceof laya.resource.Texture,o$h=o$U?o$o.uv:o$t.DEF_UV,o$p=o$U?o$o.bitmap:o$o,o$i=o$u.isAtlas(o$p);if(o$i){var o$v=o$p._atlaser,o$x=o$o._atlasID;if(-1==o$x)throw new Error("create texture error");o$p=o$v._inAtlasTextureBitmapValue[o$x],o$h=o$v._inAtlasTextureOriUVValue[o$x]}var o$j=new o$t(o$p,null);o$p.width&&o$r+o$k>o$p.width&&(o$k=o$p.width-o$r),o$p.height&&o$T+o$W>o$p.height&&(o$W=o$p.height-o$T),o$j.width=o$k,o$j.height=o$W,o$j.offsetX=o$D,o$j.offsetY=o$n,o$j.sourceWidth=o$V||o$k,o$j.sourceHeight=o$L||o$W;var o$_=1/o$p.width,o$K=1/o$p.height;o$r*=o$_,o$T*=o$K,o$k*=o$_,o$W*=o$K;var o$$=o$j.uv[0],o$y=o$j.uv[1],o$l=o$j.uv[4],o$S=o$j.uv[5],o$q=o$l-o$$,o$b=o$S-o$y,o$F=o$t.moveUV(o$h[0],o$h[1],[o$r,o$T,o$r+o$k,o$T,o$r+o$k,o$T+o$W,o$r,o$T+o$W]);o$j.uv=[o$$+o$F[0]*o$q,o$y+o$F[1]*o$b,o$l-(1-o$F[2])*o$q,o$y+o$F[3]*o$b,o$l-(1-o$F[4])*o$q,o$S-(1-o$F[5])*o$b,o$$+o$F[6]*o$q,o$S-(1-o$F[7])*o$b],o$i&&o$j.addTextureToAtlas();var o$P=o$p.scaleRate;return o$P&&1!=o$P?(o$j.sourceWidth/=o$P,o$j.sourceHeight/=o$P,o$j.width/=o$P,o$j.height/=o$P,o$j.scaleRate=o$P,o$j.offsetX/=o$P,o$j.offsetY/=o$P):o$j.scaleRate=1,o$j},o$t.createFromTexture=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$o.scaleRate;1!=o$D&&(o$r*=o$D,o$T*=o$D,o$k*=o$D,o$W*=o$D);var o$n=o$P.TEMP.setTo(o$r-o$o.offsetX,o$T-o$o.offsetY,o$k,o$W),o$V=o$n.intersection(o$t._rect1.setTo(0,0,o$o.width,o$o.height),o$t._rect2);if(!o$V)return null;var o$L=o$t.create(o$o,o$V.x,o$V.y,o$V.width,o$V.height,o$V.x-o$n.x,o$V.y-o$n.y,o$k,o$W);if(o$L.bitmap&&o$L.bitmap._removeReference)return o$L.bitmap._removeReference(),o$L;var o$U="bitmap:"+(o$L.bitmap?o$L.bitmap.constructor?o$L.bitmap.constructor.name:o$L.bitmap.__className:"")+", url:"+(o$o.url+" | "+(o$L.bitmap?o$L.bitmap.url:o$o.url))+", x="+o$r+",y="+o$T+",width="+o$k+",height="+o$W+", result="+(o$V?o$V.x+","+o$V.y+","+o$V.width+","+o$V.height:"null")+", rect="+o$n.x+","+o$n.y+","+o$n.width+","+o$n.height;throw new Error("报错：bitmap._removeReference is not a function  "+o$U)},o$t.DEF_UV=[0,0,1,0,1,1,0,1],o$t.INV_UV=[0,1,1,1,1,0,0,0],o$t._rect1=new o$P,o$t._rect2=new o$P,o$t}(),o$o=function(o$o){var o$V;function o$D(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,o$D.__super.call(this)}o$h(o$D,"laya.utils.TimeLine",o$U);var o$r=o$D.prototype;return o$r.to=function(o$o,o$r,o$T,o$k,o$W){return void 0===o$W&&(o$W=0),this._create(o$o,o$r,o$T,o$k,o$W,!0)},o$r.from=function(o$o,o$r,o$T,o$k,o$W){return void 0===o$W&&(o$W=0),this._create(o$o,o$r,o$T,o$k,o$W,!1)},o$r._create=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=o$G.getItemByClass("tweenData",o$V);return o$n.isTo=o$D,o$n.type=0,o$n.target=o$o,o$n.duration=o$T,o$n.data=o$r,o$n.startTime=this._startTime+o$W,o$n.endTime=o$n.startTime+o$n.duration,o$n.ease=o$k,this._startTime=Math.max(o$n.endTime,this._startTime),this._tweenDataList.push(o$n),this._startTimeSort=!0,this._endTimeSort=!0,this},o$r.addLabel=function(o$o,o$r){var o$T=o$G.getItemByClass("tweenData",o$V);return o$T.type=1,o$T.data=o$o,o$T.endTime=o$T.startTime=this._startTime+o$r,this._labelDic||(this._labelDic={}),this._labelDic[o$o]=o$T,this._tweenDataList.push(o$T),this},o$r.removeLabel=function(o$o){if(this._labelDic&&this._labelDic[o$o]){var o$r=this._labelDic[o$o];if(o$r){var o$T=this._tweenDataList.indexOf(o$r);-1<o$T&&this._tweenDataList.splice(o$T,1)}delete this._labelDic[o$o]}},o$r.gotoTime=function(o$o){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var o$r,o$T,o$k,o$W;for(var o$D in this._firstTweenDic)if(o$T=this._firstTweenDic[o$D])for(var o$n in o$T)o$T.diyTarget.hasOwnProperty(o$n)&&(o$T.diyTarget[o$n]=o$T[o$n]);for(o$D in this._tweenDic)(o$r=this._tweenDic[o$D]).clear(),delete this._tweenDic[o$D];if(this._index=0,this._gidIndex=0,this._currTime=o$o,this._lastTime=o$e.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=o$k=this._tweenDataList.concat(),o$k.sort(function(o$o,o$r){return o$o.endTime>o$r.endTime?1:o$o.endTime<o$r.endTime?-1:0})}else o$k=this._endTweenDataList;for(var o$V=0,o$L=o$k.length;o$V<o$L;o$V++)if(0==(o$W=o$k[o$V]).type){if(!(o$o>=o$W.endTime))break;this._index=Math.max(this._index,o$V+1);var o$U=o$W.data;if(o$W.isTo)for(var o$h in o$U)o$W.target[o$h]=o$U[o$h]}for(o$V=0,o$L=this._tweenDataList.length;o$V<o$L;o$V++)0==(o$W=this._tweenDataList[o$V]).type&&o$o>=o$W.startTime&&o$o<o$W.endTime&&(this._index=Math.max(this._index,o$V+1),this._gidIndex++,(o$r=o$G.getItemByClass("tween",o$Q))._create(o$W.target,o$W.data,o$W.duration,o$W.ease,o$$.create(this,this._animComplete,[this._gidIndex]),0,!1,o$W.isTo,!0,!1),o$r.setStartTime(this._currTime-(o$o-o$W.startTime)),o$r._updateEase(this._currTime),o$r.gid=this._gidIndex,this._tweenDic[this._gidIndex]=o$r)}},o$r.gotoLabel=function(o$o){if(null!=this._labelDic){var o$r=this._labelDic[o$o];o$r&&this.gotoTime(o$r.startTime)}},o$r.pause=function(){o$b.timer.clear(this,this._update)},o$r.resume=function(){this.play(this._currTime,this._loopKey)},o$r.play=function(o$o,o$r){if(void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(o$o,o$r){return o$o.startTime>o$r.startTime?1:o$o.startTime<o$r.startTime?-1:0});for(var o$T=0,o$k=this._tweenDataList.length;o$T<o$k;o$T++){var o$W=this._tweenDataList[o$T];if(null!=o$W&&0==o$W.type){var o$D=o$W.target,o$n=o$D.$_GID||(o$D.$_GID=o$g.getGID()),o$V=null;for(var o$L in null==this._firstTweenDic[o$n]?((o$V={}).diyTarget=o$D,this._firstTweenDic[o$n]=o$V):o$V=this._firstTweenDic[o$n],o$W.data)null==o$V[o$L]&&(o$V[o$L]=o$D[o$L])}}}"string"==typeof o$o?this.gotoLabel(o$o):this.gotoTime(o$o),this._loopKey=o$r,this._lastTime=o$e.now(),o$b.timer.frameLoop(1,this,this._update)}},o$r._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var o$o in this._tweenDic)(o$r=this._tweenDic[o$o]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var o$r,o$T=o$e.now(),o$k=o$T-this._lastTime,o$W=this._currTime+=o$k*this.scale;for(o$o in this._lastTime=o$T,this._tweenDic)(o$r=this._tweenDic[o$o])._updateEase(o$W);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var o$D=this._tweenDataList[this._index];o$W>=o$D.startTime&&(this._index++,0==o$D.type?(this._gidIndex++,(o$r=o$G.getItemByClass("tween",o$Q))._create(o$D.target,o$D.data,o$D.duration,o$D.ease,o$$.create(this,this._animComplete,[this._gidIndex]),0,!1,o$D.isTo,!0,!1),o$r.setStartTime(o$W),o$r.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=o$r)._updateEase(o$W)):this.event("label",o$D.data))}},o$r._animComplete=function(o$o){this._tweenDic[o$o]&&delete this._tweenDic[o$o]},o$r._complete=function(){this.event("complete")},o$r.reset=function(){var o$o;if(this._labelDic)for(o$o in this._labelDic)delete this._labelDic[o$o];for(o$o in this._tweenDic)this._tweenDic[o$o].clear(),delete this._tweenDic[o$o];for(o$o in this._firstTweenDic)delete this._firstTweenDic[o$o];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var o$r,o$T=0;for(o$r=this._tweenDataList.length,o$T=0;o$T<o$r;o$T++)this._tweenDataList[o$T]&&this._tweenDataList[o$T].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,o$b.timer.clear(this,this._update)},o$r.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},o$x(0,o$r,"index",function(){return this._frameIndex},function(o$o){this._frameIndex=o$o,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),o$x(0,o$r,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),o$D.to=function(o$o,o$r,o$T,o$k,o$W){return void 0===o$W&&(o$W=0),(new o$D).to(o$o,o$r,o$T,o$k,o$W)},o$D.from=function(o$o,o$r,o$T,o$k,o$W){return void 0===o$W&&(o$W=0),(new o$D).from(o$o,o$r,o$T,o$k,o$W)},o$D.__init$=function(){o$V=function(){function o$o(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return o$h(o$o,""),o$o.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,o$G.recover("tweenData",this)},o$o}()},o$D}(),o$po=function(o$W){function o$T(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,o$T.__super.call(this),this._style=o$V.EMPTY}o$h(o$T,"laya.display.Sprite",o$W);var o$o=o$T.prototype;return o$b.imps(o$o,{"laya.display.ILayout":!0}),o$o.createConchModel=function(){return new ConchNode},o$o.destroy=function(o$o){if(void 0===o$o&&(o$o=!0),this._releaseMem(),!this._destroyed){this.filters=null;var o$r=this.mask;o$r&&(this.mask=null,o$r.destroy(o$o))}o$W.prototype.destroy.call(this,o$o),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},o$o.updateZOrder=function(){o$g.updateOrder(this._childs)&&this.repaint()},o$o.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},o$o.setBounds=function(o$o){this._set$P("uBounds",o$o)},o$o.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new o$P),o$P._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},o$o.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new o$P),o$P._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},o$o._boundPointsToParent=function(o$o){void 0===o$o&&(o$o=!1);var o$r=0,o$T=0;this._style&&(o$r=this._style._tf.translateX,o$T=this._style._tf.translateY,o$o=o$o||0!==this._style._tf.rotate,this._style.scrollRect&&(o$r+=this._style.scrollRect.x,o$T+=this._style.scrollRect.y));var o$k=this._getBoundPointsM(o$o);if(!o$k||o$k.length<1)return o$k;if(8!=o$k.length&&(o$k=o$o?o$S.scanPList(o$k):o$P._getWrapRec(o$k,o$P.TEMP)._getBoundPoints()),!this.transform)return o$g.transPointList(o$k,this._x-o$r,this._y-o$T),o$k;var o$W=o$F.TEMP,o$D=0,o$n=o$k.length;for(o$D=0;o$D<o$n;o$D+=2)o$W.x=o$k[o$D],o$W.y=o$k[o$D+1],this.toParentPoint(o$W),o$k[o$D]=o$W.x,o$k[o$D+1]=o$W.y;return o$k},o$o.getGraphicBounds=function(o$o){return void 0===o$o&&(o$o=!1),this._graphics?this._graphics.getBounds(o$o):o$P.TEMP.setTo(0,0,0,0)},o$o._getBoundPointsM=function(o$o){if(void 0===o$o&&(o$o=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var o$r=o$g.clearArray(this._$P.temBM),o$T=o$P.TEMP;return o$T.copyFrom(this.scrollRect),o$g.concatArray(o$r,o$T._getBoundPoints()),o$r}for(var o$k,o$W,o$D,o$n=this._graphics?this._graphics.getBoundPoints():o$g.clearArray(this._$P.temBM),o$V=0,o$L=(o$D=this._childs).length;o$V<o$L;o$V++)(o$k=o$D[o$V])instanceof laya.display.Sprite&&1==o$k.visible&&(o$W=o$k._boundPointsToParent(o$o))&&(o$n=o$n?o$g.concatArray(o$n,o$W):o$W);return o$n},o$o.getStyle=function(){return this._style===o$V.EMPTY&&(this._style=new o$V),this._style},o$o.setStyle=function(o$o){this._style=o$o},o$o._adjustTransform=function(){this._tfChanged=!1;var o$o,o$r=this._style._tf,o$T=o$r.scaleX,o$k=o$r.scaleY;if(o$r.rotate||1!==o$T||1!==o$k||o$r.skewX||o$r.skewY){(o$o=this._transform||(this._transform=o$s.create())).bTransform=!0;var o$W=.0174532922222222*(o$r.rotate-o$r.skewX),o$D=.0174532922222222*(o$r.rotate+o$r.skewY),o$n=Math.cos(o$D),o$V=Math.sin(o$D),o$L=Math.sin(o$W),o$U=Math.cos(o$W);return o$o.a=o$T*o$n,o$o.b=o$T*o$V,o$o.c=-o$k*o$L,o$o.d=o$k*o$U,o$o.tx=o$o.ty=0,o$o}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,o$o},o$o.pos=function(o$o,o$r,o$T){if(void 0===o$T&&(o$T=!1),this._x!==o$o||this._y!==o$r){if(this.destroyed)return this;if(o$T){this._x=o$o,this._y=o$r,this.conchModel&&this.conchModel.pos(this._x,this._y);var o$k=this._parent;o$k&&0===o$k._repaint&&(o$k._repaint=1,o$k.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=o$o,this.y=o$r}return this},o$o.pivot=function(o$o,o$r){return this.pivotX=o$o,this.pivotY=o$r,this},o$o.size=function(o$o,o$r){return this.width=o$o,this.height=o$r,this},o$o.scale=function(o$o,o$r,o$T){void 0===o$T&&(o$T=!1);var o$k=this.getStyle(),o$W=o$k._tf;if(o$W.scaleX!=o$o||o$W.scaleY!=o$r){if(this.destroyed)return this;if(o$T){o$k.setScale(o$o,o$r),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(o$o,o$r),this._renderType|=4;var o$D=this._parent;o$D&&0===o$D._repaint&&(o$D._repaint=1,o$D.parentRepaint())}else this.scaleX=o$o,this.scaleY=o$r}return this},o$o.skew=function(o$o,o$r){return this.skewX=o$o,this.skewY=o$r,this},o$o.render=function(o$o,o$r,o$T){o$w.spriteCount++,o$O.renders[this._renderType]._fun(this,o$o,o$r+this._x,o$T+this._y),this._repaint=0},o$o.drawToCanvas=function(o$o,o$r,o$T,o$k){if(o$C.isConchNode){var o$W=o$yo.create("2D");return new o$X(o$o,o$r,o$W).ctx.setCanvasType(1),this.conchModel.drawToCanvas(o$W.source,o$T,o$k),o$W}return o$u.drawToCanvas(this,this._renderType,o$o,o$r,o$T,o$k)},o$o.customRender=function(o$o,o$r,o$T){this._renderType|=1024},o$o._applyFilters=function(){var o$o;if(!o$C.isWebGL&&((o$o=this._$P.filters)&&!(o$o.length<1)))for(var o$r=0,o$T=o$o.length;o$r<o$T;o$r++)o$o[o$r].action.apply(this._$P.cacheCanvas)},o$o._isHaveGlowFilter=function(){var o$o,o$r=0;if(this.filters)for(o$r=0;o$r<this.filters.length;o$r++)if(8==this.filters[o$r].type)return!0;for(o$r=0,o$o=this._childs.length;o$r<o$o;o$r++)if(this._childs[o$r]._isHaveGlowFilter())return!0;return!1},o$o.localToGlobal=function(o$o,o$r){void 0===o$r&&(o$r=!1),!0===o$r&&(o$o=new o$F(o$o.x,o$o.y));for(var o$T=this;o$T&&o$T!=o$b.stage;)o$o=o$T.toParentPoint(o$o),o$T=o$T.parent;return o$o},o$o.globalToLocal=function(o$o,o$r){void 0===o$r&&(o$r=!1),o$r&&(o$o=new o$F(o$o.x,o$o.y));for(var o$T=this,o$k=[];o$T&&o$T!=o$b.stage;)o$k.push(o$T),o$T=o$T.parent;for(var o$W=o$k.length-1;0<=o$W;)o$o=(o$T=o$k[o$W]).fromParentPoint(o$o),o$W--;return o$o},o$o.toParentPoint=function(o$o){if(!o$o)return o$o;o$o.x-=this.pivotX,o$o.y-=this.pivotY,this.transform&&this._transform.transformPoint(o$o),o$o.x+=this._x,o$o.y+=this._y;var o$r=this._style.scrollRect;return o$r&&(o$o.x-=o$r.x,o$o.y-=o$r.y),o$o},o$o.fromParentPoint=function(o$o){if(!o$o)return o$o;o$o.x-=this._x,o$o.y-=this._y;var o$r=this._style.scrollRect;return o$r&&(o$o.x+=o$r.x,o$o.y+=o$r.y),this.transform&&this._transform.invertTransformPoint(o$o),o$o.x+=this.pivotX,o$o.y+=this.pivotY,o$o},o$o.on=function(o$o,o$r,o$T,o$k){return 1!==this._mouseEnableState&&this.isMouseEvent(o$o)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(o$o,o$r,o$T,o$k,!1)):o$W.prototype.on.call(this,o$o,o$r,o$T,o$k)},o$o.once=function(o$o,o$r,o$T,o$k){return 1!==this._mouseEnableState&&this.isMouseEvent(o$o)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(o$o,o$r,o$T,o$k,!0)):o$W.prototype.once.call(this,o$o,o$r,o$T,o$k)},o$o._$2__onDisplay=function(){if(1!==this._mouseEnableState){var o$o=this;for(o$o=o$o.parent;o$o&&1!==o$o._mouseEnableState&&!o$o._getBit(2);)o$o.mouseEnabled=!0,o$o._setBit(2,!0),o$o=o$o.parent}},o$o.loadImage=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=this;return void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=0),void 0===o$W&&(o$W=0),this.graphics.loadImage(o$o,o$r,o$T,o$k,o$W,function(o$o){o$n.destroyed||(o$n.size(o$r+(o$k||o$o.width),o$T+(o$W||o$o.height)),o$n.repaint(),o$D&&o$D.runWith(o$o))}),this},o$o.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},o$o._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},o$o._childChanged=function(o$o){this._childs.length?this._renderType|=2048:this._renderType&=-2049,o$o&&this._get$P("hasZorder")&&o$b.timer.callLater(this,this.updateZOrder),this.repaint()},o$o.parentRepaint=function(){var o$o=this._parent;o$o&&0===o$o._repaint&&(o$o._repaint=1,o$o.parentRepaint())},o$o.startDrag=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){void 0===o$r&&(o$r=!1),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=300),void 0===o$D&&(o$D=!1),void 0===o$n&&(o$n=.92),this._$P.dragging||this._set$P("dragging",new o$N),this._$P.dragging.start(this,o$o,o$r,o$T,o$k,o$W,o$D,o$n)},o$o.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},o$o._releaseMem=function(){if(this._$P){var o$o=this._$P.cacheCanvas;o$o&&o$o.ctx&&(o$G.recover("RenderContext",o$o.ctx),o$o.ctx.canvas.size(0,0),o$o.ctx=null);var o$r=this._$P._filterCache;o$r&&(o$r.destroy(),o$r.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},o$o._setDisplay=function(o$o){o$o||this._releaseMem(),o$W.prototype._setDisplay.call(this,o$o)},o$o.hitTestPoint=function(o$o,o$r){var o$T=this.globalToLocal(o$F.TEMP.setTo(o$o,o$r));return o$o=o$T.x,o$r=o$T.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?o$P.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(o$o,o$r)},o$o.getMousePoint=function(){return this.globalToLocal(o$F.TEMP.setTo(o$b.stage.mouseX,o$b.stage.mouseY))},o$o._getWords=function(){return null},o$o._addChildsToLayout=function(o$o){var o$r=this._getWords();if(null==o$r&&0==this._childs.length)return!1;if(o$r)for(var o$T=0,o$k=o$r.length;o$T<o$k;o$T++)o$o.push(o$r[o$T]);o$T=0;for(var o$W=this._childs.length;o$T<o$W;++o$T){var o$D=this._childs[o$T];o$D._style._enableLayout()&&o$D._addToLayout(o$o)}return!0},o$o._addToLayout=function(o$o){this._style.absolute||(this._style.block?o$o.push(this):this._addChildsToLayout(o$o)&&(this.x=this.y=0))},o$o._isChar=function(){return!1},o$o._getCSSStyle=function(){return this._style.getCSSStyle()},o$o._setAttributes=function(o$o,o$r){switch(o$o){case"x":this.x=parseFloat(o$r);break;case"y":this.y=parseFloat(o$r);break;case"width":this.width=parseFloat(o$r);break;case"height":this.height=parseFloat(o$r);break;default:this[o$o]=o$r}},o$o._layoutLater=function(){this.parent&&this.parent._layoutLater()},o$x(0,o$o,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(o$o){this._optimizeScrollRect!=o$o&&(this._optimizeScrollRect=o$o,this.conchModel&&this.conchModel.optimizeScrollRect(o$o))}),o$x(0,o$o,"customRenderEnable",null,function(o$o){if(o$o&&(this._renderType|=1024,o$C.isConchNode)){o$T.CustomList.push(this);var o$r=new o$yo("2d");o$r._setContext(new CanvasRenderingContext2D),this.customContext=new o$X(0,0,o$r),o$r.context.setCanvasType&&o$r.context.setCanvasType(2),this.conchModel.custom(o$r.context)}}),o$x(0,o$o,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(o$o){this.cacheAs=o$o?this._$P.hasFilter?"none":"normal":"none"}),o$x(0,o$o,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(o$o){var o$r=this._$P.cacheCanvas;if(o$o!==(o$r?o$r.type:"none")){if("none"!==o$o)this._getBit(1)||this._setUpNoticeType(1),o$r||(o$r=this._set$P("cacheCanvas",o$G.getItemByClass("cacheCanvas",Object))),o$r.type=o$o,o$r.reCache=!0,this._renderType|=16,"bitmap"==o$o&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(o$r){var o$T=o$r;o$T&&o$T.ctx&&(o$G.recover("RenderContext",o$T.ctx),o$T.ctx.canvas.size(0,0),o$T.ctx=null),o$G.recover("cacheCanvas",o$r)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),o$x(0,o$o,"zOrder",function(){return this._zOrder},function(o$o){this._zOrder!=o$o&&(this._zOrder=o$o,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(o$o),this._parent&&(o$o&&this._parent._set$P("hasZorder",!0),o$b.timer.callLater(this._parent,this.updateZOrder)))}),o$x(0,o$o,"rotation",function(){return this._style._tf.rotate},function(o$o){var o$r=this.getStyle();if(o$r._tf.rotate!==o$o){o$r.setRotate(o$o),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(o$o),this._renderType|=4;var o$T=this._parent;o$T&&0===o$T._repaint&&(o$T._repaint=1,o$T.parentRepaint())}}),o$x(0,o$o,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(o$o){this._width!==o$o&&(this._width=o$o,this.conchModel&&this.conchModel.size(o$o,this._height),this.repaint())}),o$x(0,o$o,"x",function(){return this._x},function(o$o){if(this._x!==o$o){if(this.destroyed)return;this._x=o$o,this.conchModel&&this.conchModel.pos(o$o,this._y);var o$r=this._parent;o$r&&0===o$r._repaint&&(o$r._repaint=1,o$r.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),o$x(0,o$o,"globalScaleY",function(){for(var o$o=1,o$r=this;o$r&&o$r!==o$b.stage;)o$o*=o$r.scaleY,o$r=o$r.parent;return o$o}),o$x(0,o$o,"hitArea",function(){return this._$P.hitArea},function(o$o){this._set$P("hitArea",o$o)}),o$x(0,o$o,"staticCache",function(){return this._$P.staticCache},function(o$o){this._set$P("staticCache",o$o),o$o||this.reCache()}),o$x(0,o$o,"texture",function(){return this._texture},function(o$o){this._texture!=o$o&&(this._texture=o$o,this.graphics.cleanByTexture(o$o,0,0))}),o$x(0,o$o,"y",function(){return this._y},function(o$o){if(this._y!==o$o){if(this.destroyed)return;this._y=o$o,this.conchModel&&this.conchModel.pos(this._x,o$o);var o$r=this._parent;o$r&&0===o$r._repaint&&(o$r._repaint=1,o$r.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),o$x(0,o$o,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(o$o){this._height!==o$o&&(this._height=o$o,this.conchModel&&this.conchModel.size(this._width,o$o),this.repaint())}),o$x(0,o$o,"blendMode",function(){return this._style.blendMode},function(o$o){this.getStyle().blendMode=o$o,this.conchModel&&this.conchModel.blendMode(o$o),o$o&&"source-over"!=o$o?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),o$x(0,o$o,"scaleX",function(){return this._style._tf.scaleX},function(o$o){var o$r=this.getStyle();if(o$r._tf.scaleX!==o$o){o$r.setScaleX(o$o),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(o$o,o$r._tf.scaleY),this._renderType|=4;var o$T=this._parent;o$T&&0===o$T._repaint&&(o$T._repaint=1,o$T.parentRepaint())}}),o$x(0,o$o,"scaleY",function(){return this._style._tf.scaleY},function(o$o){var o$r=this.getStyle();if(o$r._tf.scaleY!==o$o){o$r.setScaleY(o$o),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(o$r._tf.scaleX,o$o),this._renderType|=4;var o$T=this._parent;o$T&&0===o$T._repaint&&(o$T._repaint=1,o$T.parentRepaint())}}),o$x(0,o$o,"stage",function(){return o$b.stage}),o$x(0,o$o,"skewX",function(){return this._style._tf.skewX},function(o$o){var o$r=this.getStyle();if(o$r._tf.skewX!==o$o){o$r.setSkewX(o$o),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(o$o,o$r._tf.skewY),this._renderType|=4;var o$T=this._parent;o$T&&0===o$T._repaint&&(o$T._repaint=1,o$T.parentRepaint())}}),o$x(0,o$o,"scrollRect",function(){return this._style.scrollRect},function(o$o){this.getStyle().scrollRect=o$o,this.repaint(),o$o?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(o$o.x,o$o.y,o$o.width,o$o.height)):(this._renderType&=-129,this.conchModel&&(o$T.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),o$x(0,o$o,"skewY",function(){return this._style._tf.skewY},function(o$o){var o$r=this.getStyle();if(o$r._tf.skewY!==o$o){o$r.setSkewY(o$o),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(o$r._tf.skewX,o$o),this._renderType|=4;var o$T=this._parent;o$T&&0===o$T._repaint&&(o$T._repaint=1,o$T.parentRepaint())}}),o$x(0,o$o,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(o$o){this._tfChanged=!1,(this._transform=o$o)&&(this._x=o$o.tx,this._y=o$o.ty,o$o.tx=o$o.ty=0,this.conchModel&&this.conchModel.transform(o$o.a,o$o.b,o$o.c,o$o.d,this._x,this._y)),o$o?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),o$x(0,o$o,"pivotX",function(){return this._style._tf.translateX},function(o$o){this.getStyle().setTranslateX(o$o),this.conchModel&&this.conchModel.pivot(o$o,this._style._tf.translateY),this.repaint()}),o$x(0,o$o,"pivotY",function(){return this._style._tf.translateY},function(o$o){this.getStyle().setTranslateY(o$o),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,o$o),this.repaint()}),o$x(0,o$o,"alpha",function(){return this._style.alpha},function(o$o){this._style&&this._style.alpha!==o$o&&(o$o=o$o<0?0:1<o$o?1:o$o,this.getStyle().alpha=o$o,this.conchModel&&this.conchModel.alpha(o$o),1!==o$o?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),o$x(0,o$o,"visible",function(){return this._style.visible},function(o$o){this._style&&this._style.visible!==o$o&&(this.getStyle().visible=o$o,this.conchModel&&this.conchModel.visible(o$o),this.parentRepaint())}),o$x(0,o$o,"graphics",function(){return this._graphics||(this.graphics=o$u.createGraphics())},function(o$o){this._graphics&&(this._graphics._sp=null),(this._graphics=o$o)?(this._renderType&=-2,this._renderType|=512,(o$o._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(o$T.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),o$x(0,o$o,"filters",function(){return this._$P.filters},function(o$o){o$o&&0===o$o.length&&(o$o=null),this._$P.filters!=o$o&&(this._set$P("filters",o$o?o$o.slice():null),o$C.isConchApp&&(this.conchModel&&(o$T.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),o$C.isWebGL&&(o$o&&o$o.length?this._renderType|=32:this._renderType&=-33),o$o&&0<o$o.length?(this._getBit(1)||this._setUpNoticeType(1),o$C.isWebGL&&1==o$o.length&&o$o[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(o$C.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),o$x(0,o$o,"parent",o$W.prototype._$get_parent,function(o$o){o$b.superSet(o$oo,this,"parent",o$o),o$o&&this._getBit(2)&&this._$2__onDisplay()}),o$x(0,o$o,"mask",function(){return this._$P._mask},function(o$o){o$o&&this.mask&&this.mask._$P.maskParent||(o$o?(this.cacheAs="bitmap",this._set$P("_mask",o$o),o$o._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",o$o),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(o$o?o$o.conchModel:null),this._renderType|=64,this.parentRepaint())}),o$x(0,o$o,"mouseEnabled",function(){return 1<this._mouseEnableState},function(o$o){this._mouseEnableState=o$o?2:1}),o$x(0,o$o,"globalScaleX",function(){for(var o$o=1,o$r=this;o$r&&o$r!==o$b.stage;)o$o*=o$r.scaleX,o$r=o$r.parent;return o$o}),o$x(0,o$o,"mouseX",function(){return this.getMousePoint().x}),o$x(0,o$o,"mouseY",function(){return this.getMousePoint().y}),o$T.fromImage=function(o$o){return(new o$T).loadImage(o$o)},o$T._cachePool=[],o$T.CustomList=[],o$L(o$T,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=o$n.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),o$T}(o$oo),o$io=function(o$o){function o$r(o$o){this._audio=null,this._onEnd=null,this._resumePlay=null,o$r.__super.call(this),this._onEnd=o$g.bind(this.__onEnd,this),this._resumePlay=o$g.bind(this.__resumePlay,this),o$o.addEventListener("ended",this._onEnd),this._audio=o$o}o$h(o$r,"laya.media.h5audio.AudioSoundChannel",o$ko);var o$T=o$r.prototype;return o$T.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(o$b.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},o$T.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,o$e.container.appendChild(this._audio),this._audio.play()}catch(o$o){this.event("error")}},o$T.play=function(o$o){this.isStopped=!1;try{this._audio.playbackRate=o$R.playbackRate,this._audio.currentTime=this.startTime}catch(o$o){return void this._audio.addEventListener("canplay",this._resumePlay)}o$R.addChannel(this),o$e.container.appendChild(this._audio),!o$o&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},o$T.stop=function(){this.isStopped=!0,o$R.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&o$C.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),o$e.onIE||this._audio!=o$To._musicAudio&&o$G.recover("audio:"+this.url,this._audio),o$e.removeElement(this._audio),this._audio=null)},o$T.pause=function(){this.isStopped=!0,o$R.removeChannel(this),"pause"in this._audio&&this._audio.pause()},o$T.resume=function(){this._audio&&(this.isStopped=!1,o$R.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},o$x(0,o$T,"position",function(){return this._audio?this._audio.currentTime:0}),o$x(0,o$T,"duration",function(){return this._audio?this._audio.duration:0}),o$x(0,o$T,"volume",function(){return this._audio?this._audio.volume:1},function(o$o){this._audio&&(this._audio.volume=o$o)}),o$r}(),o$vo=function(o$o){function o$r(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=o$Do.ctx,o$r.__super.call(this),this._onPlayEnd=o$g.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}o$h(o$r,"laya.media.webaudio.WebAudioSoundChannel",o$ko);var o$T=o$r.prototype;return o$T.play=function(o$o){if(o$R.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var o$r=this.context,o$T=this.gain,o$k=o$r.createBufferSource();(this.bufferSource=o$k).buffer=this.audioBuffer,o$k.connect(o$T),o$T&&o$T.disconnect(),o$T.connect(o$r.destination),o$k.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=o$e.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(o$k.loop=!0),o$k.playbackRate.setTargetAtTime?o$k.playbackRate.setTargetAtTime(o$R.playbackRate,this.context.currentTime,.1):o$k.playbackRate.value=o$R.playbackRate,o$k.start(0,this.startTime),!o$o&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},o$T.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(o$b.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},o$T._clearBufferSource=function(){if(this.bufferSource){var o$o=this.bufferSource;o$o.stop?o$o.stop(0):o$o.noteOff(0),o$o.disconnect(0),o$o.onended=null,o$r._tryCleanFailed||this._tryClearBuffer(o$o),this.bufferSource=null}},o$T._tryClearBuffer=function(o$o){try{o$o.buffer=null}catch(o$o){o$r._tryCleanFailed=!0}},o$T.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,o$R.removeChannel(this),this.startHandler=null,this.completeHandler=null},o$T.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,o$R.removeChannel(this)},o$T.resume=function(){this.startTime=this._pauseTime,this.play(!1)},o$x(0,o$T,"position",function(){return this.bufferSource?(o$e.now()-this._startTime)/1e3+this.startTime:0}),o$x(0,o$T,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),o$x(0,o$T,"volume",function(){return this._volume},function(o$o){this.isStopped||(this._volume=o$o,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(o$o,this.context.currentTime,.1):this.gain.gain.value=o$o)}),o$r._tryCleanFailed=!1,o$r}(),o$xo=function(o$o){function o$r(){o$r.__super.call(this),this._w=0,this._h=0}o$h(o$r,"laya.resource.Bitmap",o$Uo);var o$T=o$r.prototype;return o$x(0,o$T,"width",function(){return this._w}),o$x(0,o$T,"height",function(){return this._h}),o$x(0,o$T,"source",function(){return this._source}),o$r}(),o$jo=function(o$r){function o$o(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,o$o.__super.call(this),this._interval=o$k.animationInterval,this._setUpNoticeType(1)}o$h(o$o,"laya.display.AnimationPlayerBase",o$r);var o$T=o$o.prototype;return o$T.play=function(o$o,o$r,o$T,o$k){void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=!0),void 0===o$T&&(o$T=""),void 0===o$k&&(o$k=!0),this._isPlaying=!0,this.index="string"==typeof o$o?this._getFrameByLabel(o$o):o$o,this.loop=o$r,this._actionName=o$T,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},o$T._getFrameByLabel=function(o$o){var o$r=0;for(o$r=0;o$r<this._count;o$r++)if(this._labels[o$r]&&0<=this._labels[o$r].indexOf(o$o))return o$r;return 0},o$T._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},o$T._setControlNode=function(o$o){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=o$o)&&o$o!=this&&(o$o.on("display",this,this._checkResumePlaying),o$o.on("undisplay",this,this._checkResumePlaying))},o$T._setDisplay=function(o$o){o$r.prototype._setDisplay.call(this,o$o),this._checkResumePlaying()},o$T._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},o$T.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},o$T.addLabel=function(o$o,o$r){this._labels||(this._labels={}),this._labels[o$r]||(this._labels[o$r]=[]),this._labels[o$r].push(o$o)},o$T.removeLabel=function(o$o){if(o$o){if(this._labels)for(var o$r in this._labels)this._removeLabelFromLabelList(this._labels[o$r],o$o)}else this._labels=null},o$T._removeLabelFromLabelList=function(o$o,o$r){if(o$o)for(var o$T=o$o.length-1;0<=o$T;o$T--)o$o[o$T]==o$r&&o$o.splice(o$T,1)},o$T.gotoAndStop=function(o$o){this.index="string"==typeof o$o?this._getFrameByLabel(o$o):o$o,this.stop()},o$T._displayToIndex=function(o$o){},o$T.clear=function(){this.stop(),this._labels=null},o$x(0,o$T,"interval",function(){return this._interval},function(o$o){this._interval!=o$o&&(this._frameRateChanged=!0,this._interval=o$o,this._isPlaying&&0<o$o&&this.timerLoop(o$o,this,this._frameLoop,null,!0,!0))}),o$x(0,o$T,"isPlaying",function(){return this._isPlaying}),o$x(0,o$T,"index",function(){return this._index},function(o$o){if(this._index=o$o,this._displayToIndex(o$o),this._labels&&this._labels[o$o])for(var o$r=this._labels[o$o],o$T=0,o$k=o$r.length;o$T<o$k;o$T++)this.event("label",o$r[o$T])}),o$x(0,o$T,"count",function(){return this._count}),o$o.WRAP_POSITIVE=0,o$o.WRAP_REVERSE=1,o$o.WRAP_PINGPONG=2,o$o}(o$po),o$_o=function(o$r){function o$v(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,o$v.__super.call(this),this.overflow=o$v.VISIBLE,this._style=new o$ro(this),this._style.wordWrap=!1}o$h(o$v,"laya.display.Text",o$r);var o$o=o$v.prototype;return o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,o$o),this._lines=null,this._words&&(this._words.length=0,this._words=null)},o$o._getBoundPointsM=function(o$o){void 0===o$o&&(o$o=!1);var o$r=o$P.TEMP;return o$r.setTo(0,0,this.width,this.height),o$r._getBoundPoints()},o$o.getGraphicBounds=function(o$o){void 0===o$o&&(o$o=!1);var o$r=o$P.TEMP;return o$r.setTo(0,0,this.width,this.height),o$r},o$o._getCSSStyle=function(){return this._style},o$o.lang=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h){if(o$o=o$v.langPacks&&o$v.langPacks[o$o]?o$v.langPacks[o$o]:o$o,arguments.length<2)this._text=o$o;else{for(var o$p=0,o$i=arguments.length;o$p<o$i;o$p++)o$o=o$o.replace("{"+o$p+"}",arguments[o$p+1]);this._text=o$o}},o$o._isPassWordMode=function(){var o$o=this._style.password;return"prompt"in this&&this.prompt==this._text&&(o$o=!1),o$o},o$o._getPassWordTxt=function(o$o){var o$r;o$r="";for(var o$T=o$o.length;0<o$T;o$T--)o$r+="●";return o$r},o$o.renderText=function(o$o,o$r){var o$T=this.graphics;o$T.clear(!0);var o$k=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(o$e.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);o$e.context.font=o$k;var o$W=this.padding,o$D=o$W[3],o$n="left",o$V=this._lines,o$L=this.leading+this._charSize.height,o$U=this._currBitmapFont;o$U&&(o$L=this.leading+o$U.getMaxHeight());var o$h=o$W[0];if(!o$U&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(o$n="right",o$D=this._width-o$W[1]):"center"==this.align&&(o$n="center",o$D=.5*this._width+o$W[3]-o$W[1])),0<this._height){var o$p=this._textHeight>this._height?"top":this.valign;"middle"===o$p?o$h=.5*(this._height-o$r*o$L)+o$W[0]-o$W[2]:"bottom"===o$p&&(o$h=this._height-o$r*o$L-o$W[2])}var o$i=this._style;if(o$U&&o$U.autoScaleSize)var o$v=o$U.fontSize/this.fontSize;if(this._clipPoint)if(o$T.save(),o$U&&o$U.autoScaleSize){var o$x=0,o$j=0;o$x=this._width?this._width-o$W[3]-o$W[1]:this._textWidth,o$j=this._height?this._height-o$W[0]-o$W[2]:this._textHeight,o$x*=o$v,o$j*=o$v,o$T.clipRect(o$W[3],o$W[0],o$x,o$j)}else o$T.clipRect(o$W[3],o$W[0],this._width?this._width-o$W[3]-o$W[1]:this._textWidth,this._height?this._height-o$W[0]-o$W[2]:this._textHeight);var o$_=o$i.password;"prompt"in this&&this.prompt==this._text&&(o$_=!1);for(var o$K=0,o$$=0,o$y=Math.min(this._lines.length,o$r+o$o)||1,o$l=o$o;o$l<o$y;o$l++){var o$S,o$q=o$V[o$l];if(o$_){var o$b=o$q.length;o$q="";for(var o$F=o$b;0<o$F;o$F--)o$q+="●"}if(o$K=o$D-(this._clipPoint?this._clipPoint.x:0),o$$=o$h+o$L*o$l-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(o$n,o$K,o$$,o$l),o$U){var o$P=this.width;o$U.autoScaleSize&&(o$P=this.width*o$v),o$U.drawText(o$q,this,o$K,o$$,this.align,o$P)}else o$C.isWebGL?(this._words||(this._words=[]),(o$S=this._words.length>o$l-o$o?this._words[o$l-o$o]:new o$d).setText(o$q)):o$S=o$q,o$i.stroke?o$T.fillBorderText(o$S,o$K,o$$,o$k,this.color,o$i.strokeColor,o$i.stroke,o$n):o$T.fillText(o$S,o$K,o$$,o$k,this.color,o$n)}if(o$U&&o$U.autoScaleSize){var o$t=1/o$v;this.scale(o$t,o$t)}this._clipPoint&&o$T.restore(),this._startX=o$D,this._startY=o$h},o$o.drawUnderline=function(o$o,o$r,o$T,o$k){var o$W=this._lineWidths[o$k];switch(o$o){case"center":o$r-=o$W/2;break;case"right":o$r-=o$W}o$T+=this._charSize.height,this._graphics.drawLine(o$r,o$T,o$r+o$W,o$T,this.underlineColor||this.color,1)},o$o.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);o$e.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new o$F(0,0)):this._clipPoint=null;var o$o=this._lines.length;if(this.overflow!=o$v.VISIBLE){var o$r=this.overflow==o$v.HIDDEN?Math.floor:Math.ceil;o$o=Math.min(o$o,o$r((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var o$T=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(o$T,o$o),this.repaint()},o$o.evalTextSize=function(){var o$o,o$r=NaN;o$o=Math.max.apply(this,this._lineWidths),o$r=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],o$o==this._textWidth&&o$r==this._textHeight||(this._textWidth=o$o,this._textHeight=o$r,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},o$o.checkEnabledViewportOrNot=function(){return this.overflow==o$v.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},o$o.changeText=function(o$o){this._text!==o$o&&(this.lang(o$o+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},o$o.parseLines=function(o$o){var o$r=this.wordWrap||this.overflow==o$v.HIDDEN;if(o$r)var o$T=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var o$k=o$e.context.measureText(o$v._testWord);o$C.isConchApp&&0===o$k.width&&0===o$k.height&&(o$k=o$e.context.measureText("W")),this._charSize.width=o$k.width,this._charSize.height=o$k.height||this.fontSize}for(var o$W=o$o.replace(/\r\n/g,"\n").split("\n"),o$D=0,o$n=o$W.length;o$D<o$n;o$D++){var o$V=o$W[o$D];o$r?this.parseLine(o$V,o$T):(this._lineWidths.push(this.getTextWidth(o$V)),this._lines.push(o$V))}},o$o.parseLine=function(o$o,o$r){o$e.context;var o$T,o$k=this._lines,o$W=0,o$D=NaN,o$n=NaN,o$V=0;if((o$D=this.getTextWidth(o$o))<=o$r)return o$k.push(o$o),void this._lineWidths.push(o$D);o$D=this._charSize.width,0==(o$W=Math.floor(o$r/o$D))&&(o$W=1),o$n=o$D=this.getTextWidth(o$o.substring(0,o$W));for(var o$L=o$W,o$U=o$o.length;o$L<o$U;o$L++)if(o$r<(o$n+=o$D=this.getTextWidth(o$o.charAt(o$L))))if(this.wordWrap){var o$h=o$o.substring(o$V,o$L);if(o$h.charCodeAt(o$h.length-1)<255?(o$T=/(?:\w|-)+$/.exec(o$h))&&(o$L=o$T.index+o$V,0==o$T.index?o$L+=o$h.length:o$h=o$o.substring(o$V,o$L)):o$v.RightToLeft&&(o$T=/([\u0600-\u06FF])+$/.exec(o$h))&&(o$L=o$T.index+o$V,0==o$T.index?o$L+=o$h.length:o$h=o$o.substring(o$V,o$L)),o$k.push(o$h),this._lineWidths.push(o$n-o$D),!((o$V=o$L)+o$W<o$U)){o$k.push(o$o.substring(o$V,o$U)),this._lineWidths.push(this.getTextWidth(o$k[o$k.length-1])),o$V=-1;break}o$L+=o$W,o$n=o$D=this.getTextWidth(o$o.substring(o$V,o$L)),o$L--}else if(this.overflow==o$v.HIDDEN)return o$k.push(o$o.substring(0,o$L)),void this._lineWidths.push(this.getTextWidth(o$k[o$k.length-1]));this.wordWrap&&-1!=o$V&&(o$k.push(o$o.substring(o$V,o$U)),this._lineWidths.push(this.getTextWidth(o$k[o$k.length-1])))},o$o.getTextWidth=function(o$o){return this._currBitmapFont?this._currBitmapFont.getTextWidth(o$o):o$e.context.measureText(o$o).width},o$o.getWordWrapWidth=function(){var o$o=this.padding,o$r=NaN;return(o$r=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(o$r=this.wordWrap?100:o$e.width),o$r<=0&&(o$r=100),o$r-o$o[3]-o$o[1]},o$o.getCharPoint=function(o$o,o$r){this._isChanged&&o$b.timer.runCallLater(this,this.typeset);for(var o$T=0,o$k=this._lines,o$W=0,o$D=0,o$n=o$k.length;o$D<o$n;o$D++){if(o$o<(o$T+=o$k[o$D].length)){var o$V=o$D;break}o$W=o$T}var o$L=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;o$e.context.font=o$L;var o$U=this.getTextWidth(this._text.substring(o$W,o$o));return(o$r||new o$F).setTo(this._startX+o$U-(this._clipPoint?this._clipPoint.x:0),this._startY+o$V*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},o$x(0,o$o,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(o$o){o$o!=this._width&&(o$b.superSet(o$po,this,"width",o$o),this.isChanged=!0)}),o$x(0,o$o,"textWidth",function(){return this._isChanged&&o$b.timer.runCallLater(this,this.typeset),this._textWidth}),o$x(0,o$o,"height",function(){return this._height?this._height:this.textHeight},function(o$o){o$o!=this._height&&(o$b.superSet(o$po,this,"height",o$o),this.isChanged=!0)}),o$x(0,o$o,"textHeight",function(){return this._isChanged&&o$b.timer.runCallLater(this,this.typeset),this._textHeight}),o$x(0,o$o,"padding",function(){return this._getCSSStyle().padding},function(o$o){this._getCSSStyle().padding=o$o,this.isChanged=!0}),o$x(0,o$o,"bold",function(){return this._getCSSStyle().bold},function(o$o){this._getCSSStyle().bold=o$o,this.isChanged=!0}),o$x(0,o$o,"text",function(){return this._text||""},function(o$o){this._text!==o$o&&(this.lang(o$o+""),this.isChanged=!0,this.event("change"))}),o$x(0,o$o,"color",function(){return this._getCSSStyle().color},function(o$o){this._getCSSStyle().color!=o$o&&(this._getCSSStyle().color=o$o,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),o$x(0,o$o,"font",function(){return this._getCSSStyle().fontFamily},function(o$o){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),o$v._bitmapFonts&&o$v._bitmapFonts[o$o]&&(this._currBitmapFont=o$v._bitmapFonts[o$o]),this._getCSSStyle().fontFamily=o$o,this.isChanged=!0}),o$x(0,o$o,"fontSize",function(){return this._getCSSStyle().fontSize},function(o$o){this._getCSSStyle().fontSize=o$o,this.isChanged=!0}),o$x(0,o$o,"italic",function(){return this._getCSSStyle().italic},function(o$o){this._getCSSStyle().italic=o$o,this.isChanged=!0}),o$x(0,o$o,"align",function(){return this._getCSSStyle().align},function(o$o){this._getCSSStyle().align=o$o,this.isChanged=!0}),o$x(0,o$o,"valign",function(){return this._getCSSStyle().valign},function(o$o){this._getCSSStyle().valign=o$o,this.isChanged=!0}),o$x(0,o$o,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(o$o){this._getCSSStyle().wordWrap=o$o,this.isChanged=!0}),o$x(0,o$o,"leading",function(){return this._getCSSStyle().leading},function(o$o){this._getCSSStyle().leading=o$o,this.isChanged=!0}),o$x(0,o$o,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(o$o){this._getCSSStyle().backgroundColor=o$o,this.isChanged=!0}),o$x(0,o$o,"borderColor",function(){return this._getCSSStyle().borderColor},function(o$o){this._getCSSStyle().borderColor=o$o,this.isChanged=!0}),o$x(0,o$o,"stroke",function(){return this._getCSSStyle().stroke},function(o$o){this._getCSSStyle().stroke=o$o,this.isChanged=!0}),o$x(0,o$o,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(o$o){this._getCSSStyle().strokeColor=o$o,this.isChanged=!0}),o$x(0,o$o,"isChanged",null,function(o$o){this._isChanged!==o$o&&(this._isChanged=o$o)&&o$b.timer.callLater(this,this.typeset)}),o$x(0,o$o,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(o$o){if(!(this.overflow!=o$v.SCROLL||this.textWidth<this._width)&&this._clipPoint){o$o=o$o<this.padding[3]?this.padding[3]:o$o;var o$r=this._textWidth-this._width;o$o=o$r<o$o?o$r:o$o;var o$T=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=o$o,this.renderText(this._lastVisibleLineIndex,o$T)}}),o$x(0,o$o,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(o$o){if(!(this.overflow!=o$v.SCROLL||this.textHeight<this._height)&&this._clipPoint){o$o=o$o<this.padding[0]?this.padding[0]:o$o;var o$r=this._textHeight-this._height,o$T=(o$o=o$r<o$o?o$r:o$o)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=o$T;var o$k=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=o$o,this.renderText(o$T,o$k)}}),o$x(0,o$o,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),o$x(0,o$o,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),o$x(0,o$o,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),o$x(0,o$o,"underlineColor",function(){return this._underlineColor},function(o$o){this._underlineColor=o$o,this._isChanged=!0,this.typeset()}),o$v.registerBitmapFont=function(o$o,o$r){o$v._bitmapFonts||(o$v._bitmapFonts={}),o$v._bitmapFonts[o$o]=o$r},o$v.unregisterBitmapFont=function(o$o,o$r){if(void 0===o$r&&(o$r=!0),o$v._bitmapFonts&&o$v._bitmapFonts[o$o]){var o$T=o$v._bitmapFonts[o$o];o$r&&o$T.destroy(),delete o$v._bitmapFonts[o$o]}},o$v.setTextRightToLeft=function(){var o$o;(o$o=o$e.canvas.source.style).display="none",o$o.position="absolute",o$o.direction="rtl",o$C._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,o$e.document.body.appendChild(o$e.canvas.source)},o$v.supportFont=function(o$o){o$e.context.font="10px sans-serif";var o$r=o$e.context.measureText("abcji").width;o$e.context.font="10px "+o$o;var o$T=o$e.context.measureText("abcji").width;return console.log(o$r,o$T),o$r!==o$T},o$v._testWord="游",o$v.langPacks=null,o$v.VISIBLE="visible",o$v.SCROLL="scroll",o$v.HIDDEN="hidden",o$v.CharacterCache=!0,o$v.RightToLeft=!1,o$v._bitmapFonts=null,o$L(o$v,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),o$v}(o$po),o$Ko=function(o$p){function o$n(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",o$n.__super.call(this),this.offset=new o$F,this._canvasTransform=new o$s,this._previousOrientation=o$e.window.orientation;var o$r=this;this.transform=o$s.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var o$o=o$e.window,o$T=this;o$o.addEventListener("focus",function(){o$r._isFocused=!0,o$T.event("focus"),o$T.event("focuschange")}),o$o.addEventListener("blur",function(){o$r._isFocused=!1,o$T.event("blur"),o$T.event("focuschange"),o$T._isInputting()&&(o$So.inputElement.target.focus=!1)});var o$k="visibilityState",o$W="visibilitychange",o$D=o$o.document;void 0!==o$D.hidden?(o$W="visibilitychange",o$k="visibilityState"):void 0!==o$D.mozHidden?(o$W="mozvisibilitychange",o$k="mozVisibilityState"):void 0!==o$D.msHidden?(o$W="msvisibilitychange",o$k="msVisibilityState"):void 0!==o$D.webkitHidden&&(o$W="webkitvisibilitychange",o$k="webkitVisibilityState"),o$o.document.addEventListener(o$W,function(){"hidden"==o$e.document[o$k]?o$T._setStageVisible(!1):o$T._setStageVisible(!0)}),o$o.document.addEventListener("qbrowserVisibilityChange",function(o$o){o$T._setStageVisible(!o$o.hidden)}),o$o.addEventListener("resize",function(){var o$o=o$e.window.orientation;null!=o$o&&o$o!=o$r._previousOrientation&&o$T._isInputting()&&(o$So.inputElement.target.focus=!1),o$r._previousOrientation=o$o,o$T._isInputting()||o$T._resetCanvas()}),o$o.addEventListener("orientationchange",function(o$o){o$T._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),o$e.onMobile&&this.on("mousedown",this,this._onmouseMove)}o$h(o$n,"laya.display.Stage",o$p);var o$o=o$n.prototype;return o$o._setStageVisible=function(o$o){this._isVisibility!=o$o&&(this._isVisibility=o$o,this._isVisibility||this._isInputting()&&(o$So.inputElement.target.focus=!1),this.event("visibilitychange"))},o$o._isInputting=function(){return o$e.onMobile&&o$So.isInputting},o$o._changeCanvasSize=function(){this.setScreenSize(o$e.clientWidth*o$e.pixelRatio,o$e.clientHeight*o$e.pixelRatio)},o$o._resetCanvas=function(){if(this.screenAdaptationEnabled){var o$o=o$C._mainCanvas;o$o.source.style;o$o.size(1,1),o$b.timer.once(100,this,this._changeCanvasSize)}},o$o.setScreenSize=function(o$o,o$r){var o$T=!1;if("none"!==this._screenMode&&(o$T=(o$o/o$r<1?"vertical":"horizontal")!==this._screenMode)){var o$k=o$r;o$r=o$o,o$o=o$k}this.canvasRotation=o$T;var o$W=o$C._mainCanvas,o$D=o$W.source.style,o$n=this._canvasTransform.identity(),o$V=this._scaleMode,o$L=o$o/this.designWidth,o$U=o$r/this.designHeight,o$h=this.designWidth,o$p=this.designHeight,o$i=o$o,o$v=o$r,o$x=o$e.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,o$V){case"noscale":o$L=o$U=1,o$i=this.designWidth,o$v=this.designHeight;break;case"showall":o$L=o$U=Math.min(o$L,o$U),o$h=o$i=Math.round(this.designWidth*o$L),o$p=o$v=Math.round(this.designHeight*o$U);break;case"noborder":o$L=o$U=Math.max(o$L,o$U),o$i=Math.round(this.designWidth*o$L),o$v=Math.round(this.designHeight*o$U);break;case"full":o$L=o$U=1,this._width=o$h=o$o,this._height=o$p=o$r;break;case"fixedwidth":o$U=o$L,this._height=o$p=Math.round(o$r/o$L);break;case"fixedheight":o$L=o$U,this._width=o$h=Math.round(o$o/o$U);break;case"fixedauto":o$o/o$r<this.designWidth/this.designHeight?(o$U=o$L,this._height=o$p=Math.round(o$r/o$L)):(o$L=o$U,this._width=o$h=Math.round(o$o/o$U))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,o$h=o$h+1&2147483646,o$p=o$p+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),o$L*=this.scaleX,o$U*=this.scaleY,1===o$L&&1===o$U?this.transform.identity():(this.transform.a=this._formatData(o$L/(o$i/o$h)),this.transform.d=this._formatData(o$U/(o$v/o$p)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),o$W.size(o$h,o$p),o$u.changeWebGLSize(o$h,o$p),o$n.scale(o$i/o$h/o$x,o$v/o$p/o$x),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(o$o-o$i)/o$x:this.offset.x=.5*(o$o-o$i)/o$x,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(o$r-o$v)/o$x:this.offset.y=.5*(o$r-o$v)/o$x,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),o$n.translate(this.offset.x,this.offset.y),this.canvasDegree=0,o$T&&("horizontal"===this._screenMode?(o$n.rotate(Math.PI/2),o$n.translate(o$r/o$x,0),this.canvasDegree=90):(o$n.rotate(-Math.PI/2),o$n.translate(0,o$o/o$x),this.canvasDegree=-90)),o$n.a=this._formatData(o$n.a),o$n.d=this._formatData(o$n.d),o$n.tx=this._formatData(o$n.tx),o$n.ty=this._formatData(o$n.ty),o$D.transformOrigin=o$D.webkitTransformOrigin=o$D.msTransformOrigin=o$D.mozTransformOrigin=o$D.oTransformOrigin="0px 0px 0px",o$D.transform=o$D.webkitTransform=o$D.msTransform=o$D.mozTransform=o$D.oTransform="matrix("+o$n.toString()+")",o$n.translate(parseInt(o$D.left)||0,parseInt(o$D.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},o$o._formatData=function(o$o){return Math.abs(o$o)<1e-6?0:Math.abs(1-o$o)<.001?0<o$o?1:-1:o$o},o$o.getMousePoint=function(){return o$F.TEMP.setTo(this.mouseX,this.mouseY)},o$o.repaint=function(){this._repaint=1},o$o.parentRepaint=function(){},o$o._loop=function(){return this.render(o$C.context,0,0),!0},o$o._onmouseMove=function(o$o){this._mouseMoveTime=o$e.now()},o$o.getTimeFromFrameStart=function(){return o$e.now()-this._frameStartTime},o$o.render=function(o$o,o$r,o$T){if("sleep"===this._frameRate&&!o$C.isConchApp){var o$k=o$e.now();if(!(1e3<=o$k-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(o$w.loopCount++,o$j.instance.runEvent(),o$b.timer._update()));this._frameStartTime=o$k}if(this._renderCount++,o$C.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=o$e.now();var o$W="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),o$D=this._renderCount%2==0;if(o$w.renderSlow=!o$W,o$W||o$D||o$C.isConchApp){var o$n;o$w.loopCount++,o$j.instance.runEvent(),o$b.timer._update(),o$u.update3DLoop();var o$V=0,o$L=0;if(o$C.isConchNode)for(o$V=0,o$L=this._scenes.length;o$V<o$L;o$V++)(o$n=this._scenes[o$V])&&o$n._updateSceneConch();else for(o$V=0,o$L=this._scenes.length;o$V<o$L;o$V++)(o$n=this._scenes[o$V])&&o$n._updateScene();if(o$C.isConchNode){var o$U=o$po.CustomList;for(o$V=0,o$L=o$U.length;o$V<o$L;o$V++){var o$h=o$U[o$V];o$h.customRender(o$h.customContext,0,0)}return}}o$C.isConchNode||this.renderingEnabled&&(o$W||!o$D||o$C.isConchWebGL)&&(o$C.isWebGL?o$C.WebGL.mainContext&&!o$C.WebGL.mainContext.isContextLost()&&(o$o.clear(),o$p.prototype.render.call(this,o$o,o$r,o$T),o$w._show&&o$w._sp&&o$w._sp.render(o$o,o$r,o$T),o$u.clear(this._bgColor),o$u.beginFlush(),o$o.flush(),o$u.endFinish(),o$B.instance&&o$B.getInstance().endDispose()):(o$u.clear(this._bgColor),o$p.prototype.render.call(this,o$o,o$r,o$T),o$w._show&&o$w._sp&&o$w._sp.render(o$o,o$r,o$T)))}else this._renderCount%5==0&&(o$w.loopCount++,o$j.instance.runEvent(),o$b.timer._update())},o$o._requestFullscreen=function(){var o$o=o$e.document.documentElement;o$o.requestFullscreen?o$o.requestFullscreen():o$o.mozRequestFullScreen?o$o.mozRequestFullScreen():o$o.webkitRequestFullscreen?o$o.webkitRequestFullscreen():o$o.msRequestFullscreen&&o$o.msRequestFullscreen()},o$o._fullScreenChanged=function(){o$b.stage.event("fullscreenchange")},o$o.exitFullscreen=function(){var o$o=o$e.document;o$o.exitFullscreen?o$o.exitFullscreen():o$o.mozCancelFullScreen?o$o.mozCancelFullScreen():o$o.webkitExitFullscreen&&o$o.webkitExitFullscreen()},o$x(0,o$o,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),o$x(0,o$o,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),o$x(0,o$o,"frameRate",function(){return this._frameRate},function(o$o){if(this._frameRate=o$o,o$C.isConchApp)switch(this._frameRate){case"slow":o$e.window.conch&&o$e.window.conchConfig.setSlowFrame&&o$e.window.conchConfig.setSlowFrame(!0);break;case"fast":o$e.window.conch&&o$e.window.conchConfig.setSlowFrame&&o$e.window.conchConfig.setSlowFrame(!1);break;case"mouse":o$e.window.conch&&o$e.window.conchConfig.setMouseFrame&&o$e.window.conchConfig.setMouseFrame(2e3);break;case"sleep":o$e.window.conch&&o$e.window.conchConfig.setLimitFPS&&o$e.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),o$x(0,o$o,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),o$x(0,o$o,"width",o$p.prototype._$get_width,function(o$o){this.designWidth=o$o,o$b.superSet(o$po,this,"width",o$o),o$b.timer.callLater(this,this._changeCanvasSize)}),o$x(0,o$o,"alignH",function(){return this._alignH},function(o$o){this._alignH=o$o,o$b.timer.callLater(this,this._changeCanvasSize)}),o$x(0,o$o,"isFocused",function(){return this._isFocused}),o$x(0,o$o,"height",o$p.prototype._$get_height,function(o$o){this.designHeight=o$o,o$b.superSet(o$po,this,"height",o$o),o$b.timer.callLater(this,this._changeCanvasSize)}),o$x(0,o$o,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||o$s.create()},o$p.prototype._$set_transform),o$x(0,o$o,"isVisibility",function(){return this._isVisibility}),o$x(0,o$o,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),o$x(0,o$o,"scaleMode",function(){return this._scaleMode},function(o$o){this._scaleMode=o$o,o$b.timer.callLater(this,this._changeCanvasSize)}),o$x(0,o$o,"alignV",function(){return this._alignV},function(o$o){this._alignV=o$o,o$b.timer.callLater(this,this._changeCanvasSize)}),o$x(0,o$o,"bgColor",function(){return this._bgColor},function(o$o){this._bgColor=o$o,this.conchModel&&this.conchModel.bgColor(o$o),o$C.isWebGL&&(o$o?o$n._wgColor=o$I.create(o$o)._color:o$e.onMiniGame||(o$n._wgColor=null)),o$e.onLimixiu?o$n._wgColor=o$I.create(o$o)._color:o$C.canvas.style.background=o$o||"none"}),o$x(0,o$o,"mouseX",function(){return Math.round(o$j.instance.mouseX/this.clientScaleX)}),o$x(0,o$o,"mouseY",function(){return Math.round(o$j.instance.mouseY/this.clientScaleY)}),o$x(0,o$o,"screenMode",function(){return this._screenMode},function(o$o){this._screenMode=o$o}),o$x(0,o$o,"visible",o$p.prototype._$get_visible,function(o$o){this.visible!==o$o&&(o$b.superSet(o$po,this,"visible",o$o),o$C._mainCanvas.source.style.visibility=o$o?"visible":"hidden")}),o$x(0,o$o,"fullScreenEnabled",null,function(o$o){var o$r=o$e.document,o$T=o$C.canvas;o$o?(o$T.addEventListener("mousedown",this._requestFullscreen),o$T.addEventListener("touchstart",this._requestFullscreen),o$r.addEventListener("fullscreenchange",this._fullScreenChanged),o$r.addEventListener("mozfullscreenchange",this._fullScreenChanged),o$r.addEventListener("webkitfullscreenchange",this._fullScreenChanged),o$r.addEventListener("msfullscreenchange",this._fullScreenChanged)):(o$T.removeEventListener("mousedown",this._requestFullscreen),o$T.removeEventListener("touchstart",this._requestFullscreen),o$r.removeEventListener("fullscreenchange",this._fullScreenChanged),o$r.removeEventListener("mozfullscreenchange",this._fullScreenChanged),o$r.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),o$r.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),o$n.SCALE_NOSCALE="noscale",o$n.SCALE_EXACTFIT="exactfit",o$n.SCALE_SHOWALL="showall",o$n.SCALE_NOBORDER="noborder",o$n.SCALE_FULL="full",o$n.SCALE_FIXED_WIDTH="fixedwidth",o$n.SCALE_FIXED_HEIGHT="fixedheight",o$n.SCALE_FIXED_AUTO="fixedauto",o$n.ALIGN_LEFT="left",o$n.ALIGN_RIGHT="right",o$n.ALIGN_CENTER="center",o$n.ALIGN_TOP="top",o$n.ALIGN_MIDDLE="middle",o$n.ALIGN_BOTTOM="bottom",o$n.SCREEN_NONE="none",o$n.SCREEN_HORIZONTAL="horizontal",o$n.SCREEN_VERTICAL="vertical",o$n.FRAME_FAST="fast",o$n.FRAME_SLOW="slow",o$n.FRAME_MOUSE="mouse",o$n.FRAME_SLEEP="sleep",o$n.FRAME_MOUSE_THREDHOLD=2e3,o$L(o$n,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),o$n}(o$po),o$$o=(function(o$o){function o$r(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,o$r.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}o$h(o$r,"laya.media.SoundNode",o$po);var o$T=o$r.prototype;o$T._onParentChange=function(){this.target=this.parent},o$T.play=function(o$o,o$r){void 0===o$o&&(o$o=1),isNaN(o$o)&&(o$o=1),this.url&&(this.stop(),this._channel=o$R.playSound(this.url,o$o,null,o$r))},o$T.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},o$T._setPlayAction=function(o$o,o$r,o$T,o$k){void 0===o$k&&(o$k=!0),this[o$T]&&o$o&&(o$k?o$o.on(o$r,this,this[o$T]):o$o.off(o$r,this,this[o$T]))},o$T._setPlayActions=function(o$o,o$r,o$T,o$k){if(void 0===o$k&&(o$k=!0),o$o&&o$r){var o$W,o$D=o$r.split(","),o$n=0;for(o$W=o$D.length,o$n=0;o$n<o$W;o$n++)this._setPlayAction(o$o,o$D[o$n],o$T,o$k)}},o$x(0,o$T,"playEvent",null,function(o$o){(this._playEvents=o$o)&&this._tar&&this._setPlayActions(this._tar,o$o,"play")}),o$x(0,o$T,"target",null,function(o$o){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=o$o,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),o$x(0,o$T,"stopEvent",null,function(o$o){(this._stopEvents=o$o)&&this._tar&&this._setPlayActions(this._tar,o$o,"stop")})}(),function(o$o){function o$r(){this._src=null,this._onload=null,this._onerror=null,o$r.__super.call(this)}o$h(o$r,"laya.resource.FileBitmap",o$xo);var o$T=o$r.prototype;return o$x(0,o$T,"src",function(){return this._src},function(o$o){this._src=o$o}),o$x(0,o$T,"onload",null,function(o$o){}),o$x(0,o$T,"onerror",null,function(o$o){}),o$r}()),o$yo=function(o$o){function o$T(o$o,o$r){this._is2D=!1,o$T.__super.call(this);var o$k=this;if(this._source=this,"2D"===o$o||"AUTO"===o$o&&!o$C.isWebGL){this._is2D=!0,this._source=o$r||o$e.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var o$W=this;o$W.getContext=function(o$o,o$r){if(o$k._ctx)return o$k._ctx;var o$T=o$k._ctx=o$k._source.getContext(o$o,o$r);return o$T&&(o$T._canvas=o$W,o$C.isFlash||o$e.onLimixiu||(o$T.size=function(o$o,o$r){})),o$T}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}o$h(o$T,"laya.resource.HTMLCanvas",o$xo);var o$r=o$T.prototype;return o$r.clear=function(){this._ctx&&this._ctx.clear()},o$r.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},o$r.release=function(){},o$r._setContext=function(o$o){this._ctx=o$o},o$r.getContext=function(o$o,o$r){return this._ctx?this._ctx:this._ctx=o$T._createContext(this)},o$r.getMemSize=function(){return 0},o$r.size=function(o$o,o$r){(this._w!=o$o||this._h!=o$r||this._source&&(this._source.width!=o$o||this._source.height!=o$r))&&(this._w=o$o,this._h=o$r,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(o$o,o$r),this._source&&(this._source.height=o$r,this._source.width=o$o))},o$r.getCanvas=function(){return this._source},o$r.toBase64=function(o$o,o$r,o$T){if(this._source)if(o$C.isConchApp&&this._source.toBase64)this._source.toBase64(o$o,o$r,o$T);else{var o$k=this._source.toDataURL(o$o,o$r);o$T.call(this,o$k)}},o$x(0,o$r,"context",function(){return this._ctx}),o$x(0,o$r,"asBitmap",null,function(o$o){}),o$T.create=function(o$o,o$r){return new o$T(o$o,o$r)},o$T.TYPE2D="2D",o$T.TYPE3D="3D",o$T.TYPEAUTO="AUTO",o$T._createContext=null,o$T}(),o$lo=(function(o$o){function o$L(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){throw o$L.__super.call(this),new Error("不允许new！")}o$h(o$L,"laya.resource.HTMLSubImage",o$xo),o$L.create=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){return void 0===o$V&&(o$V=!1),new o$L(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V)}}(),function(o$o){function o$p(){this._frames=null,this._url=null,o$p.__super.call(this),this._setControlNode(this)}o$h(o$p,"laya.display.Animation",o$o);var o$r=o$p.prototype;o$r.destroy=function(o$o){void 0===o$o&&(o$o=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,o$o),this._frames=null,this._labels=null},o$r.play=function(o$o,o$r,o$T,o$k){void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=!0),void 0===o$T&&(o$T=""),void 0===o$k&&(o$k=!0),o$T&&this._setFramesFromCache(o$T,o$k),this._isPlaying=!0,this.index="string"==typeof o$o?this._getFrameByLabel(o$o):o$o,this.loop=o$r,this._actionName=o$T,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},o$r._setFramesFromCache=function(o$o,o$r){var o$T;return void 0===o$r&&(o$r=!1),this._url&&(o$o=this._url+"#"+o$o),o$o&&o$p.framesMap[o$o]?((o$T=o$p.framesMap[o$o])instanceof Array?(this._frames=o$p.framesMap[o$o],this._count=this._frames.length):(o$T.nodeRoot&&(o$p.framesMap[o$o]=this._parseGraphicAnimationByData(o$T),o$T=o$p.framesMap[o$o]),this._frames=o$T.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=o$T.interval),this._labels=this._copyLabels(o$T.labels)),!0):(o$r&&console.log("ani not found:",o$o),!1)},o$r._copyLabels=function(o$o){if(!o$o)return null;var o$r,o$T;for(o$T in o$r={},o$o)o$r[o$T]=o$g.copyArray([],o$o[o$T]);return o$r},o$r._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&o$o.prototype._frameLoop.call(this)},o$r._displayToIndex=function(o$o){this._frames&&(this.graphics=this._frames[o$o])},o$r.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},o$r.loadImages=function(o$o,o$r){return void 0===o$r&&(o$r=""),this._url="",this._setFramesFromCache(o$r)||(this.frames=o$p.framesMap[o$r]?o$p.framesMap[o$r]:o$p.createFrames(o$o,o$r)),this},o$r.loadAtlas=function(o$r,o$T,o$k){void 0===o$k&&(o$k=""),this._url="";var o$W=this;function o$o(o$o){o$r===o$o&&(o$W.frames=o$p.framesMap[o$k]?o$p.framesMap[o$k]:o$p.createFrames(o$r,o$k),o$T&&o$T.run())}return o$W._setFramesFromCache(o$k)||(o$Vo.getAtlas(o$r)?o$o(o$r):o$b.loader.load(o$r,o$$.create(null,o$o,[o$r]),null,"atlas")),this},o$r.loadAnimation=function(o$o,o$r,o$T){this._url=o$o;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,o$r&&o$r.run()):!o$T||o$Vo.getAtlas(o$T)?this._loadAnimationData(o$o,o$r,o$T):o$b.loader.load(o$T,o$$.create(this,this._loadAnimationData,[o$o,o$r,o$T]),null,"atlas"),this},o$r._loadAnimationData=function(o$V,o$L,o$o){var o$U=this;if(!o$o||o$Vo.getAtlas(o$o)){var o$h=this;o$Vo.getRes(o$V)?o$r(o$V):o$b.loader.load(o$V,o$$.create(null,o$r,[o$V]),null,"json"),o$Vo.clearRes(o$V)}else console.warn("atlas load fail:"+o$o);function o$r(o$o){if(o$Vo.getRes(o$o)&&o$V===o$o){var o$r;if(o$p.framesMap[o$V+"#"])o$h._setFramesFromCache(o$U._actionName,!0),o$U.index=0,o$U._checkResumePlaying();else{var o$T=o$h._parseGraphicAnimation(o$Vo.getRes(o$V));if(!o$T)return;var o$k,o$W=o$T.animationList,o$D=0,o$n=o$W.length;for(o$D=0;o$D<o$n;o$D++)o$r=o$W[o$D],o$p.framesMap[o$V+"#"+o$r.name]=o$r,o$k||(o$k=o$r);o$k&&(o$p.framesMap[o$V+"#"]=o$k,o$h._setFramesFromCache(o$U._actionName,!0),o$U.index=0),o$U._checkResumePlaying()}o$L&&o$L.run()}}},o$r._parseGraphicAnimation=function(o$o){return o$bo.parseAnimationData(o$o)},o$r._parseGraphicAnimationByData=function(o$o){return o$bo.parseAnimationByData(o$o)},o$x(0,o$r,"frames",function(){return this._frames},function(o$o){(this._frames=o$o)&&(this._count=o$o.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),o$x(0,o$r,"autoPlay",null,function(o$o){o$o?this.play():this.stop()}),o$x(0,o$r,"source",null,function(o$o){-1<o$o.indexOf(".ani")?this.loadAnimation(o$o):-1<o$o.indexOf(".json")||-1<o$o.indexOf("als")||-1<o$o.indexOf("atlas")?this.loadAtlas(o$o):this.loadImages(o$o.split(","))}),o$x(0,o$r,"autoAnimation",null,function(o$o){this.play(0,!0,o$o,!1)}),o$p.createFrames=function(o$o,o$r){var o$T,o$k,o$W=0,o$D=0;if("string"==typeof o$o){var o$n=o$Vo.getAtlas(o$o);if(o$n&&o$n.length)for(o$T=[],o$W=0,o$D=o$n.length;o$W<o$D;o$W++)(o$k=new o$u.createGraphics).drawTexture(o$Vo.getRes(o$n[o$W]),0,0),o$T.push(o$k)}else if(o$o instanceof Array)for(o$T=[],o$W=0,o$D=o$o.length;o$W<o$D;o$W++)(o$k=new o$u.createGraphics).loadImage(o$o[o$W],0,0),o$T.push(o$k);return o$r&&(o$p.framesMap[o$r]=o$T),o$T},o$p.clearCache=function(o$o){var o$r,o$T=o$p.framesMap,o$k=o$o+"#";for(o$r in o$T)o$r!==o$o&&0!=o$r.indexOf(o$k)||delete o$p.framesMap[o$r]},o$p.framesMap={}}(o$jo),function(o$o){function o$D(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,o$D.__super.call(this),null==o$D._sortIndexFun&&(o$D._sortIndexFun=o$q.sortByKey("index",!1,!0))}o$h(o$D,"laya.display.FrameAnimation",o$o);var o$r=o$D.prototype;return o$r._setUp=function(o$o,o$r){this._labels=null,this._animationNewFrames=null,this._targetDic=o$o,this._animationData=o$r,this.interval=1e3/o$r.frameRate,o$r.parsed?(this._count=o$r.count,this._labels=o$r.labels,this._animationNewFrames=o$r.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),o$r.parsed=!0,o$r.labels=this._labels,o$r.count=this._count,o$r.animationNewFrames=this._animationNewFrames},o$r.clear=function(){o$o.prototype.clear.call(this),this._targetDic=null,this._animationData=null},o$r._displayToIndex=function(o$o){if(this._animationData){o$o<0&&(o$o=0),o$o>this._count&&(o$o=this._count);var o$r=this._animationData.nodes,o$T=0,o$k=o$r.length;for(o$T=0;o$T<o$k;o$T++)this._displayNodeToFrame(o$r[o$T],o$o)}},o$r._displayNodeToFrame=function(o$o,o$r,o$T){o$T||(o$T=this._targetDic);var o$k=o$T[o$o.target];if(o$k){var o$W,o$D,o$n,o$V=o$o.frames,o$L=o$o.keys,o$U=0,o$h=o$L.length;for(o$U=0;o$U<o$h;o$U++)o$n=(o$D=o$V[o$W=o$L[o$U]]).length>o$r?o$D[o$r]:o$D[o$D.length-1],o$k[o$W]=o$n}},o$r._calculateDatas=function(){if(this._animationData){var o$o,o$r=this._animationData.nodes,o$T=0,o$k=o$r.length;for(o$T=this._count=0;o$T<o$k;o$T++)o$o=o$r[o$T],this._calculateNodeKeyFrames(o$o);this._count+=1}},o$r._calculateNodeKeyFrames=function(o$o){var o$r,o$T,o$k=o$o.keyframes,o$W=o$o.target;for(o$r in o$o.frames||(o$o.frames={}),o$o.keys?o$o.keys.length=0:o$o.keys=[],o$o.initValues||(o$o.initValues={}),o$k)o$T=o$k[o$r],o$o.frames[o$r]||(o$o.frames[o$r]=[]),this._targetDic&&this._targetDic[o$W]&&(o$o.initValues[o$r]=this._targetDic[o$W][o$r]),o$T.sort(o$D._sortIndexFun),o$o.keys.push(o$r),this._calculateNodePropFrames(o$T,o$o.frames[o$r],o$r,o$W)},o$r.resetToInitState=function(){if(this._targetDic&&this._animationData){var o$o,o$r,o$T=this._animationData.nodes,o$k=0,o$W=o$T.length;for(o$k=0;o$k<o$W;o$k++)if(o$r=(o$o=o$T[o$k]).initValues){var o$D,o$n=this._targetDic[o$o.target];if(o$n)for(o$D in o$r)o$n[o$D]=o$r[o$D]}}},o$r._calculateNodePropFrames=function(o$o,o$r,o$T,o$k){var o$W=0,o$D=o$o.length-1;if(0<o$D){for(o$r.length=o$o[o$D].index+1,o$W=0;o$W<o$D;o$W++)this._dealKeyFrame(o$o[o$W]),this._calculateFrameValues(o$o[o$W],o$o[o$W+1],o$r);this._dealKeyFrame(o$o[o$W])}0==o$D&&(o$r[o$o[0].index]=o$o[0].value,this._animationNewFrames&&(this._animationNewFrames[o$o[0].index]=!0))},o$r._dealKeyFrame=function(o$o){o$o.label&&""!=o$o.label&&this.addLabel(o$o.label,o$o.index)},o$r._calculateFrameValues=function(o$o,o$r,o$T){var o$k,o$W=0,o$D=o$o.index,o$n=o$r.index,o$V=o$o.value,o$L=o$r.value-o$o.value,o$U=o$n-o$D;if(o$n>this._count&&(this._count=o$n),o$o.tween)for(null==(o$k=o$f[o$o.tweenMethod])&&(o$k=o$f.linearNone),o$W=o$D;o$W<o$n;o$W++)o$T[o$W]=o$k(o$W-o$D,o$V,o$L,o$U),this._animationNewFrames&&(this._animationNewFrames[o$W]=!0);else for(o$W=o$D;o$W<o$n;o$W++)o$T[o$W]=o$V;this._animationNewFrames&&(this._animationNewFrames[o$o.index]=!0,this._animationNewFrames[o$r.index]=!0),o$T[o$r.index]=o$r.value},o$D._sortIndexFun=null,o$D}(o$jo)),o$So=function(o$r){function o$W(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",o$W.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=o$_o.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}o$h(o$W,"laya.display.Input",o$r);var o$o=o$W.prototype;return o$o.setSelection=function(o$o,o$r){this.focus=!0,laya.display.Input.inputElement.selectionStart=o$o,laya.display.Input.inputElement.selectionEnd=o$r},o$o._onUnDisplay=function(o$o){this.focus=!1},o$o._onMouseDown=function(o$o){this.focus=!0},o$o._syncInputTransform=function(){var o$o=this.nativeInput,o$r=o$g.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),o$T=this._width-this.padding[1]-this.padding[3],o$k=this._height-this.padding[0]-this.padding[2];o$C.isConchApp?(o$o.setScale(o$r.scaleX,o$r.scaleY),o$o.setSize(o$T,o$k),o$o.setPos(o$r.x,o$r.y)):(o$W.inputContainer.style.transform=o$W.inputContainer.style.webkitTransform="scale("+o$r.scaleX+","+o$r.scaleY+") rotate("+o$b.stage.canvasDegree+"deg)",o$o.style.width=o$T+"px",o$o.style.height=o$k+"px",o$W.inputContainer.style.left=o$r.x+"px",o$W.inputContainer.style.top=o$r.y+"px")},o$o.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},o$o._setInputMethod=function(){o$W.input.parentElement&&o$W.inputContainer.removeChild(o$W.input),o$W.area.parentElement&&o$W.inputContainer.removeChild(o$W.area),o$W.inputElement=this._multiline?o$W.area:o$W.input,o$W.inputContainer.appendChild(o$W.inputElement),o$_o.RightToLeft&&(o$W.inputElement.style.direction="rtl")},o$o._focusIn=function(){laya.display.Input.isInputting=!0;var o$o=this.nativeInput;this._focus=!0;var o$r=o$o.style;o$r.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),o$o.readOnly=!this._editable,o$C.isConchApp&&(o$o.setType(this._type),o$o.setForbidEdit(!this._editable)),o$o.maxLength=this._maxChars;this.padding;if(o$o.type=this._type,o$o.value=this._content,o$o.placeholder=this._prompt,o$b.stage.off("keydown",this,this._onKeyDown),o$b.stage.on("keydown",this,this._onKeyDown),(o$b.stage.focus=this).event("focus"),o$e.onPC&&o$o.focus(),!o$e.onMiniGame){this._text;this._text=null}this.typeset(),o$o.setColor(this._originColor),o$o.setFontSize(this.fontSize),o$o.setFontFace(o$e.onIPhone&&o$_o._fontFamilyMap[this.font]||this.font),o$C.isConchApp&&o$o.setMultiAble&&o$o.setMultiAble(this._multiline),o$r.lineHeight=this.leading+this.fontSize+"px",o$r.fontStyle=this.italic?"italic":"normal",o$r.fontWeight=this.bold?"bold":"normal",o$r.textAlign=this.align,o$r.padding="0 0",this._syncInputTransform(),!o$C.isConchApp&&o$e.onPC&&o$b.timer.frameLoop(1,this,this._syncInputTransform)},o$o._setPromptColor=function(){(o$W.promptStyleDOM=o$e.getElementById("promptStyle"))||((o$W.promptStyleDOM=o$e.createElement("style")).setAttribute("id","promptStyle"),o$e.document.head.appendChild(o$W.promptStyleDOM)),o$W.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},o$o._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(o$b.superSet(o$_o,this,"text",this._content),o$b.superSet(o$_o,this,"color",this._originColor)):(o$b.superSet(o$_o,this,"text",this._prompt),o$b.superSet(o$_o,this,"color",this._promptColor)),o$b.stage.off("keydown",this,this._onKeyDown),o$b.stage.focus=null,this.event("blur"),o$C.isConchApp&&this.nativeInput.blur(),o$e.onPC&&o$b.timer.clear(this,this._syncInputTransform)},o$o._onKeyDown=function(o$o){13===o$o.keyCode&&(o$e.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},o$o.changeText=function(o$o){this._content=o$o,this._focus?(this.nativeInput.value=o$o||"",this.event("change")):o$r.prototype.changeText.call(this,o$o)},o$x(0,o$o,"color",o$r.prototype._$get_color,function(o$o){this._focus&&this.nativeInput.setColor(o$o),o$b.superSet(o$_o,this,"color",this._content?o$o:this._promptColor),this._originColor=o$o}),o$x(0,o$o,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(o$o){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),o$x(0,o$o,"multiline",function(){return this._multiline},function(o$o){this._multiline=o$o,this.valign=o$o?"top":"middle"}),o$x(0,o$o,"maxChars",function(){return this._maxChars},function(o$o){o$o<=0&&(o$o=1e5),this._maxChars=o$o}),o$x(0,o$o,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(o$o){o$b.superSet(o$_o,this,"color",this._originColor),o$o+="",this._focus?(this.nativeInput.value=o$o||"",this.event("change")):(this._multiline||(o$o=o$o.replace(/\r?\n/g,"")),(this._content=o$o)?o$b.superSet(o$_o,this,"text",o$o):(o$b.superSet(o$_o,this,"text",this._prompt),o$b.superSet(o$_o,this,"color",this.promptColor)))}),o$x(0,o$o,"nativeInput",function(){return this._multiline?o$W.area:o$W.input}),o$x(0,o$o,"prompt",function(){return this._prompt},function(o$o){!this._text&&o$o&&o$b.superSet(o$_o,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?o$b.superSet(o$_o,this,"text",this._text==this._prompt?o$o:this._text):o$b.superSet(o$_o,this,"text",o$o),this._prompt=o$_o.langPacks&&o$_o.langPacks[o$o]?o$_o.langPacks[o$o]:o$o}),o$x(0,o$o,"focus",function(){return this._focus},function(o$o){var o$r=this.nativeInput;this._focus!==o$o&&(o$o?(o$r.target?o$r.target._focusOut():this._setInputMethod(),(o$r.target=this)._focusIn()):(o$r.target=null,this._focusOut(),o$e.document.body.scrollTop=0,o$r.blur(),o$C.isConchApp?o$r.setPos(-1e4,-1e4):o$W.inputContainer.contains(o$r)&&o$W.inputContainer.removeChild(o$r)))}),o$x(0,o$o,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(o$o){o$o?(-1<(o$o="[^"+o$o+"]").indexOf("^^")&&(o$o=o$o.replace("^^","")),this._restrictPattern=new RegExp(o$o,"g")):this._restrictPattern=null}),o$x(0,o$o,"editable",function(){return this._editable},function(o$o){this._editable=o$o,o$C.isConchApp&&o$W.input.setForbidEdit(!o$o)}),o$x(0,o$o,"promptColor",function(){return this._promptColor},function(o$o){this._promptColor=o$o,this._content||o$b.superSet(o$_o,this,"color",o$o)}),o$x(0,o$o,"type",function(){return this._type},function(o$o){this._getCSSStyle().password="password"==o$o,this._type=o$o,o$C.isConchApp&&this.nativeInput.setType(o$o)}),o$x(0,o$o,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(o$o){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),o$x(0,o$o,"asPassword",function(){return this._getCSSStyle().password},function(o$o){this._getCSSStyle().password=o$o,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),o$W.__init__=function(){o$W._createInputElement(),o$e.onMobile&&o$C.canvas.addEventListener(o$W.IOS_IFRAME?o$e.onMiniGame?"touchend":"click":"touchend",o$W._popupInputMethod)},o$W._popupInputMethod=function(o$o){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},o$W._createInputElement=function(){o$W._initInput(o$W.area=o$e.createElement("textarea")),o$W._initInput(o$W.input=o$e.createElement("input")),(o$W.inputContainer=o$e.createElement("div")).style.position="absolute",o$W.inputContainer.style.zIndex=1e5,o$e.container.appendChild(o$W.inputContainer),o$W.inputContainer.setPos=function(o$o,o$r){o$W.inputContainer.style.left=o$o+"px",o$W.inputContainer.style.top=o$r+"px"}},o$W._initInput=function(o$r){var o$o=o$r.style;o$o.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",o$o.resize="none",o$o.backgroundColor="transparent",o$o.border="none",o$o.outline="none",o$o.zIndex=1,o$r.addEventListener("input",o$W._processInputting),o$r.addEventListener("mousemove",o$W._stopEvent),o$r.addEventListener("mousedown",o$W._stopEvent),o$r.addEventListener("touchmove",o$W._stopEvent),o$r.setFontFace=function(o$o){o$r.style.fontFamily=o$o},o$C.isConchApp||(o$r.setColor=function(o$o){o$r.style.color=o$o},o$r.setFontSize=function(o$o){o$r.style.fontSize=o$o+"px"})},o$W._processInputting=function(o$o){var o$r=laya.display.Input.inputElement.target;if(o$r){var o$T=laya.display.Input.inputElement.value;o$r._restrictPattern&&(o$T=o$T.replace(/\u2006|\x27/g,""),o$r._restrictPattern.test(o$T)&&(o$T=o$T.replace(o$r._restrictPattern,""),laya.display.Input.inputElement.value=o$T)),o$r._text=o$T,o$r.event("input")}},o$W._stopEvent=function(o$o){"touchmove"==o$o.type&&o$o.preventDefault(),o$o.stopPropagation&&o$o.stopPropagation()},o$W.TYPE_TEXT="text",o$W.TYPE_PASSWORD="password",o$W.TYPE_EMAIL="email",o$W.TYPE_URL="url",o$W.TYPE_NUMBER="number",o$W.TYPE_RANGE="range",o$W.TYPE_DATE="date",o$W.TYPE_MONTH="month",o$W.TYPE_WEEK="week",o$W.TYPE_TIME="time",o$W.TYPE_DATE_TIME="datetime",o$W.TYPE_DATE_TIME_LOCAL="datetime-local",o$W.TYPE_SEARCH="search",o$W.input=null,o$W.area=null,o$W.inputElement=null,o$W.inputContainer=null,o$W.confirmButton=null,o$W.promptStyleDOM=null,o$W.inputHeight=45,o$W.isInputting=!1,o$W.stageMatrix=null,o$L(o$W,["IOS_IFRAME",function(){return this.IOS_IFRAME=o$e.onIOS&&o$e.window.top!=o$e.window.self}]),o$W}(o$_o),o$qo=function(o$o){function o$T(o$o,o$r){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,o$T.__super.call(this),o$o&&this._init_(o$o,o$r)}o$h(o$T,"laya.resource.HTMLImage",o$$o);var o$r=o$T.prototype;return o$r._init_=function(o$o,o$r){this._src=o$o,this._source=new o$e.window.Image,o$r&&(o$r.onload&&(this.onload=o$r.onload),o$r.onerror&&(this.onerror=o$r.onerror),o$r.onCreate&&o$r.onCreate(this)),0!=o$o.indexOf("data:image")&&(this._source.crossOrigin=""),o$o&&(this._source.src=o$o)},o$r.recreateResource=function(){var o$o=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var o$r=this;this._source=new o$e.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(o$r._needReleaseAgain)return o$r._needReleaseAgain=!1,o$r._source.onload=null,void(o$r._source=null);o$r._source.onload=null,o$r.memorySize=o$o._w*o$o._h*4,o$r._recreateLock=!1,o$r.completeCreate()},this._source.src=this._src}},o$r.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},o$r.onresize=function(){this._w=this._source.width,this._h=this._source.height},o$x(0,o$r,"onload",null,function(o$o){var o$r=this;this._onload=o$o,this._source&&(this._source.onload=null!=this._onload?function(){o$r.onresize(),o$r._onload()}:null)}),o$x(0,o$r,"onerror",null,function(o$o){var o$r=this;this._onerror=o$o,this._source&&(this._source.onerror=null!=this._onerror?function(){o$r._onerror()}:null)}),o$x(0,o$r,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(o$o){this._enableMerageInAtlas=o$o,o$C.isConchApp&&this._source&&(this._source.enableMerageInAtlas=o$o)}),o$T.create=function(o$o,o$r){return new o$T(o$o,o$r)},o$T}(),o$bo=(function(o$D){function o$o(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,o$o.__super.call(this)}o$h(o$o,"laya.display.EffectAnimation",o$D);var o$r=o$o.prototype;o$r._onOtherBegin=function(o$o){o$o!=this&&this.stop()},o$r.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},o$r._onPlayAction=function(){this.play(0,!1)},o$r.play=function(o$o,o$r,o$T,o$k){void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=!0),void 0===o$T&&(o$T=""),void 0===o$k&&(o$k=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,o$o,o$r,o$T,o$k))},o$r._recordInitData=function(){if(this._aniKeys){var o$o,o$r,o$T=0;for(o$o=this._aniKeys.length,o$T=0;o$T<o$o;o$T++)o$r=this._aniKeys[o$T],this._initData[o$r]=this._target[o$r]}},o$r._displayToIndex=function(o$o){if(this._animationData){o$o<0&&(o$o=0),o$o>this._count&&(o$o=this._count);var o$r=this._animationData.nodes,o$T=0,o$k=o$r.length;for(o$k=1<o$k?1:o$k,o$T=0;o$T<o$k;o$T++)this._displayNodeToFrame(o$r[o$T],o$o)}},o$r._displayNodeToFrame=function(o$o,o$r,o$T){if(this._target){var o$k;o$k=this._target;var o$W,o$D,o$n,o$V,o$L=o$o.frames,o$U=o$o.keys,o$h=0,o$p=o$U.length;o$V=o$o.secondFrames;var o$i,o$v,o$x,o$j,o$_=0;for(o$h=0;o$h<o$p;o$h++)o$D=o$L[o$W=o$U[o$h]],o$n=-1==(o$_=o$V[o$W])?this._initData[o$W]:o$r<o$_?(o$x=(o$v=o$o.keyframes[o$W])[0]).tween?(null==(o$i=o$f[o$x.tweenMethod])&&(o$i=o$f.linearNone),o$j=o$v[1],o$i(o$r,this._initData[o$W],o$j.value-this._initData[o$W],o$j.index)):this._initData[o$W]:o$D.length>o$r?o$D[o$r]:o$D[o$D.length-1],o$k[o$W]=o$n}},o$r._calculateNodeKeyFrames=function(o$o){o$D.prototype._calculateNodeKeyFrames.call(this,o$o);var o$r,o$T,o$k,o$W=o$o.keyframes;o$o.target;for(o$r in o$k={},o$o.secondFrames=o$k,o$W)(o$T=o$W[o$r]).length<=1?o$k[o$r]=-1:o$k[o$r]=o$T[1].index},o$x(0,o$r,"target",function(){return this._target},function(o$o){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=o$o,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),o$x(0,o$r,"playEvent",null,function(o$o){(this._playEvents=o$o)&&this.addEvent()}),o$x(0,o$r,"effectData",null,function(o$o){var o$r;o$o&&((o$r=o$o.animations)&&o$r[0]&&(this._setUp({},o$r[0]),o$r[0].nodes&&o$r[0].nodes[0]&&(this._aniKeys=o$r[0].nodes[0].keys)))}),o$x(0,o$r,"effectClass",null,function(o$o){var o$r,o$T;(this._effectClass=o$A.getClass(o$o),this._effectClass)&&((o$r=this._effectClass.uiView)&&(o$T=o$r.animations)&&o$T[0]&&(this._setUp({},o$T[0]),o$T[0].nodes&&o$T[0].nodes[0]&&(this._aniKeys=o$T[0].nodes[0].keys)))}),o$o.EffectAnimationBegin="effectanimationbegin"}(o$lo),function(o$r){var o$H;function o$R(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,o$R.__super.call(this)}o$h(o$R,"laya.utils.GraphicAnimation",o$r);var o$o=o$R.prototype;return o$o._parseNodeList=function(o$o){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[o$o.compId]=o$o.props,o$o.compId&&this._nodeList.push(o$o.compId);var o$r=o$o.child;if(o$r){var o$T=0,o$k=o$r.length;for(o$T=0;o$T<o$k;o$T++)this._parseNodeList(o$r[o$T])}},o$o._calGraphicData=function(o$o){var o$r;if(this._setUp(null,o$o),this._createGraphicData(),this._nodeIDAniDic)for(o$r in this._nodeIDAniDic)this._nodeIDAniDic[o$r]=null},o$o._createGraphicData=function(){var o$o,o$r=[],o$T=0,o$k=this.count,o$W=this._animationNewFrames;for(o$W||(o$W=[]),o$T=0;o$T<o$k;o$T++)!o$W[o$T]&&o$o||(o$o=this._createFrameGraphic(o$T)),o$r.push(o$o);this._gList=o$r},o$o._createFrameGraphic=function(o$o){var o$r=o$u.createGraphics();return o$R._rootMatrix||(o$R._rootMatrix=new o$s),this._updateNodeGraphic(this._rootNode,o$o,o$R._rootMatrix,o$r),o$r},o$o._updateNodeGraphic=function(o$o,o$r,o$T,o$k,o$W){var o$D;void 0===o$W&&(o$W=1);var o$n,o$V,o$L,o$U=(o$D=this._nodeGDic[o$o.compId]=this._getNodeGraphicData(o$o.compId,o$r,this._nodeGDic[o$o.compId])).alpha*o$W;if(!(o$U<.01)&&(o$D.resultTransform||(o$D.resultTransform=o$s.create()),o$n=o$D.resultTransform,o$s.mul(o$D.transform,o$T,o$n),o$D.skin&&(o$V=this._getTextureByUrl(o$D.skin))&&(o$n._checkTransform()?(o$k.drawTexture(o$V,0,0,o$D.width,o$D.height,o$n,o$U),o$D.resultTransform=null):o$k.drawTexture(o$V,o$n.tx,o$n.ty,o$D.width,o$D.height,null,o$U)),o$L=o$o.child)){var o$h,o$p=0;for(o$h=o$L.length,o$p=0;o$p<o$h;o$p++)this._updateNodeGraphic(o$L[o$p],o$r,o$n,o$k,o$U)}},o$o._updateNoChilds=function(o$o,o$r){if(o$o.skin){var o$T=this._getTextureByUrl(o$o.skin);if(o$T){var o$k=o$o.transform;o$k._checkTransform();!o$k.bTransform?o$r.drawTexture(o$T,o$k.tx,o$k.ty,o$o.width,o$o.height,null,o$o.alpha):o$r.drawTexture(o$T,0,0,o$o.width,o$o.height,o$k.clone(),o$o.alpha)}}},o$o._updateNodeGraphic2=function(o$o,o$r,o$T){var o$k;if(o$k=this._nodeGDic[o$o.compId]=this._getNodeGraphicData(o$o.compId,o$r,this._nodeGDic[o$o.compId]),o$o.child){var o$W=o$k.transform;o$W._checkTransform();var o$D,o$n;o$n=(o$D=!o$W.bTransform)&&(0!=o$W.tx||0!=o$W.ty);var o$V,o$L,o$U;if((o$V=o$W.bTransform||1!=o$k.alpha)&&o$T.save(),1!=o$k.alpha&&o$T.alpha(o$k.alpha),o$D?o$n&&o$T.translate(o$W.tx,o$W.ty):o$T.transform(o$W.clone()),o$L=o$o.child,o$k.skin&&(o$U=this._getTextureByUrl(o$k.skin))&&o$T.drawTexture(o$U,0,0,o$k.width,o$k.height),o$L){var o$h,o$p=0;for(o$h=o$L.length,o$p=0;o$p<o$h;o$p++)this._updateNodeGraphic2(o$L[o$p],o$r,o$T)}o$V?o$T.restore():o$D?o$n&&o$T.translate(-o$W.tx,-o$W.ty):o$T.transform(o$W.clone().invert())}else this._updateNoChilds(o$k,o$T)},o$o._calculateNodeKeyFrames=function(o$o){o$r.prototype._calculateNodeKeyFrames.call(this,o$o),this._nodeIDAniDic[o$o.target]=o$o},o$o.getNodeDataByID=function(o$o){return this._nodeIDAniDic[o$o]},o$o._getParams=function(o$o,o$r,o$T,o$k){var o$W=o$R._temParam;o$W.length=o$r.length;var o$D=0,o$n=o$r.length;for(o$D=0;o$D<o$n;o$D++)o$W[o$D]=this._getObjVar(o$o,o$r[o$D][0],o$T,o$r[o$D][1],o$k);return o$W},o$o._getObjVar=function(o$o,o$r,o$T,o$k,o$W){if(o$o.hasOwnProperty(o$r)){var o$D=o$o[o$r];if(o$T>=o$D.length&&(o$T=o$D.length-1),null!=o$o[o$r][o$T])return o$o[o$r][o$T]}return o$W.hasOwnProperty(o$r)?o$W[o$r]:o$k},o$o._getNodeGraphicData=function(o$o,o$r,o$T){o$T||(o$T=o$H.create()),o$T.transform?o$T.transform.identity():o$T.transform=o$s.create();var o$k=this.getNodeDataByID(o$o);if(!o$k)return o$T;var o$W,o$D,o$n=o$k.frames,o$V=this._getParams(o$n,o$R._drawTextureCmd,o$r,this._nodeDefaultProps[o$o]),o$L=o$V[0],o$U=NaN,o$h=NaN,o$p=o$V[5],o$i=o$V[6],o$v=o$V[13],o$x=o$V[14],o$j=o$V[7],o$_=o$V[8],o$K=o$V[9],o$$=o$V[11],o$y=o$V[12];o$U=o$V[3],o$h=o$V[4],0!=o$U&&0!=o$h||(o$L=null),-1==o$U&&(o$U=0),-1==o$h&&(o$h=0),o$T.skin=o$L,o$T.width=o$U,o$T.height=o$h,o$L&&((o$W=this._getTextureByUrl(o$L))?(o$U||(o$U=o$W.sourceWidth),o$h||(o$h=o$W.sourceHeight)):console.warn("lost skin:",o$L,",you may load pics first")),o$T.alpha=o$V[10],o$D=o$T.transform,0!=o$v&&(o$p=o$v*o$U),0!=o$x&&(o$i=o$x*o$h),0==o$p&&0==o$i||o$D.translate(-o$p,-o$i);var o$l=null;if(o$K||1!==o$j||1!==o$_||o$$||o$y){(o$l=o$R._tempMt).identity(),o$l.bTransform=!0;var o$S=.0174532922222222*(o$K-o$$),o$q=.0174532922222222*(o$K+o$y),o$b=Math.cos(o$q),o$F=Math.sin(o$q),o$P=Math.sin(o$S),o$t=Math.cos(o$S);o$l.a=o$j*o$b,o$l.b=o$j*o$F,o$l.c=-o$_*o$P,o$l.d=o$_*o$t,o$l.tx=o$l.ty=0}return o$l&&(o$D=o$s.mul(o$D,o$l,o$D)),o$D.translate(o$V[1],o$V[2]),o$T},o$o._getTextureByUrl=function(o$o){return o$Vo.getRes(o$o)},o$o.setAniData=function(o$o,o$r){if(o$o.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=o$o,this._parseNodeList(o$o);var o$T,o$k={},o$W=[],o$D=o$o.animations,o$n=0,o$V=o$D.length;for(o$n=0;o$n<o$V;o$n++)if(o$T=o$D[o$n],this._labels=null,(!o$r||o$r==o$T.name)&&o$T){try{this._calGraphicData(o$T)}catch(o$o){console.warn("parse animation fail:"+o$T.name+",empty animation created"),this._gList=[]}var o$L={};o$L.interval=1e3/o$T.frameRate,o$L.frames=this._gList,o$L.labels=this._labels,o$L.name=o$T.name,o$W.push(o$L),o$k[o$T.name]=o$L}this.animationList=o$W,this.animationDic=o$k}o$R._temParam.length=0},o$o.parseByData=function(o$o){var o$r,o$T;o$r=o$o.nodeRoot,o$T=o$o.aniO,delete o$o.nodeRoot,delete o$o.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=o$r,this._parseNodeList(o$r),this._labels=null;try{this._calGraphicData(o$T)}catch(o$o){console.warn("parse animation fail:"+o$T.name+",empty animation created"),this._gList=[]}var o$k=o$o;return o$k.interval=1e3/o$T.frameRate,o$k.frames=this._gList,o$k.labels=this._labels,o$k.name=o$T.name,o$k},o$o.setUpAniData=function(o$o){if(o$o.animations){var o$r,o$T={},o$k=[],o$W=o$o.animations,o$D=0,o$n=o$W.length;for(o$D=0;o$D<o$n;o$D++)if(o$r=o$W[o$D]){var o$V={};o$V.name=o$r.name,o$V.aniO=o$r,o$V.nodeRoot=o$o,o$k.push(o$V),o$T[o$r.name]=o$V}this.animationList=o$k,this.animationDic=o$T}},o$o._clear=function(){var o$o,o$r;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(o$o in this._nodeGDic)(o$r=this._nodeGDic[o$o])&&o$r.recover();this._nodeGDic=null},o$R.parseAnimationByData=function(o$o){var o$r;return o$R._I||(o$R._I=new o$R),o$r=o$R._I.parseByData(o$o),o$R._I._clear(),o$r},o$R.parseAnimationData=function(o$o){var o$r;return o$R._I||(o$R._I=new o$R),o$R._I.setUpAniData(o$o),(o$r={}).animationList=o$R._I.animationList,o$r.animationDic=o$R._I.animationDic,o$R._I._clear(),o$r},o$R._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],o$R._temParam=[],o$R._I=null,o$R._rootMatrix=null,o$L(o$R,["_tempMt",function(){return this._tempMt=new o$s}]),o$R.__init$=function(){o$H=function(){function o$o(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return o$h(o$o,""),o$o.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),o$G.recover("GraphicNode",this)},o$o.create=function(){return o$G.getItemByClass("GraphicNode",o$o)},o$o}()},o$R}(o$lo));o$b.__init([o$U,o$Lo,o$C,o$e,o$Z,o$t,o$o,o$bo])}(window,document,Laya),function(o$o,o$r,o$T){o$T.un,o$T.uns,o$T.static;var o$k=o$T.class;o$T.getset,o$T.__newvec;new(function(){function o$o(){}return o$k(o$o,"LayaMain"),o$o}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(o$o,o$r){"use strict";for(var o$T in Object.defineProperty(o$r,"__esModule",{value:!0}),Laya){var o$k=Laya[o$T];o$k&&o$k.__isclass&&(o$r[o$T]=o$k)}}),function(o$o,o$r,o$q){o$q.un,o$q.uns;var o$n=o$q.static,o$i=o$q.class,o$k=o$q.getset,o$D=o$q.__newvec,o$h=laya.maths.Arith,o$p=laya.maths.Bezier,o$T=laya.resource.Bitmap,o$v=laya.utils.Browser,o$L=laya.utils.Byte,o$x=laya.utils.Color,o$b=(laya.filters.ColorFilter,o$q.Config),o$W=laya.resource.Context,o$F=(laya.events.Event,laya.filters.Filter),o$V=laya.display.Graphics,o$U=laya.resource.HTMLCanvas,o$j=(laya.utils.HTMLChar,laya.resource.HTMLImage),o$_=laya.resource.HTMLSubImage,o$P=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),o$t=laya.maths.Point,o$H=laya.maths.Rectangle,o$K=laya.renders.Render,o$$=(laya.renders.RenderContext,laya.renders.RenderSprite),o$y=laya.resource.Resource,o$l=laya.resource.ResourceManager,o$S=laya.utils.RunDriver,o$R=laya.display.Sprite,o$u=laya.display.Stage,o$s=laya.utils.Stat,o$z=laya.utils.StringKey,o$m=(laya.display.css.Style,laya.system.System),o$C=laya.display.Text,o$X=laya.resource.Texture,o$O=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),o$M=laya.utils.VectorGraphManager;laya.utils.WordText;o$q.interface("laya.webgl.shapes.IShape"),o$q.interface("laya.webgl.submit.ISubmit"),o$q.interface("laya.webgl.text.ICharSegment"),o$q.interface("laya.webgl.canvas.save.ISaveData"),o$q.interface("laya.webgl.resource.IMergeAtlasBitmap"),o$q.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var o$c=function(){function o$o(){}o$i(o$o,"laya.filters.webgl.FilterActionGL");var o$r=o$o.prototype;return o$q.imps(o$r,{"laya.filters.IFilterActionGL":!0}),o$r.setValue=function(o$o){},o$r.setValueMix=function(o$o){},o$r.apply3d=function(o$o,o$r,o$T,o$k,o$W){return null},o$r.apply=function(o$o){return null},o$k(0,o$r,"typeMix",function(){return 0}),o$o}(),o$e=function(){function o$o(){}return o$i(o$o,"laya.webgl.shader.ShaderValue"),o$o}(),o$J=function(){var o$k,o$W;function o$o(o$o,o$r,o$T){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new o$W,void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),this._cells=null,this._rowInfo=null,this._init(o$o,o$r),this._atlasID=o$T}o$i(o$o,"laya.webgl.atlas.AtlasGrid");var o$r=o$o.prototype;return o$r.getAltasID=function(){return this._atlasID},o$r.setAltasID=function(o$o){0<=o$o&&(this._atlasID=o$o)},o$r.addTex=function(o$o,o$r,o$T){var o$k=this._get(o$r,o$T);return 0==o$k.ret||(this._fill(o$k.x,o$k.y,o$r,o$T,o$o),this._texCount++),o$k},o$r._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},o$r._init=function(o$o,o$r){if(this._width=o$o,this._height=o$r,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=o$D(this._height);for(var o$T=0;o$T<this._height;o$T++)this._rowInfo[o$T]=new o$k;return this._clear(),!0},o$r._get=function(o$o,o$r){var o$T=new o$A;if(o$o>=this._failSize.width&&o$r>=this._failSize.height)return o$T;for(var o$k=-1,o$W=-1,o$D=this._width,o$n=this._height,o$V=this._cells,o$L=0;o$L<o$n;o$L++)if(!(this._rowInfo[o$L].spaceCount<o$o))for(var o$U=0;o$U<o$D;){var o$h=3*(o$L*o$D+o$U);if(0!=o$V[o$h]||o$V[1+o$h]<o$o||o$V[2+o$h]<o$r)o$U+=o$V[1+o$h];else{o$k=o$U,o$W=o$L;for(var o$p=0;o$p<o$o;o$p++)if(o$V[3*o$p+o$h+2]<o$r){o$k=-1;break}if(!(o$k<0))return o$T.ret=!0,o$T.x=o$k,o$T.y=o$W,o$T;o$U+=o$V[1+o$h]}}return o$T},o$r._fill=function(o$o,o$r,o$T,o$k,o$W){var o$D=this._width,o$n=this._height;this._check(o$o+o$T<=o$D&&o$r+o$k<=o$n);for(var o$V=o$r;o$V<o$k+o$r;++o$V){this._check(this._rowInfo[o$V].spaceCount>=o$T),this._rowInfo[o$V].spaceCount-=o$T;for(var o$L=0;o$L<o$T;o$L++){var o$U=3*(o$o+o$V*o$D+o$L);this._check(0==this._cells[o$U]),this._cells[o$U]=o$W,this._cells[1+o$U]=o$T,this._cells[2+o$U]=o$k}}if(0<o$o)for(o$V=0;o$V<o$k;++o$V){var o$h=0;for(o$L=o$o-1;0<=o$L&&0==this._cells[3*((o$r+o$V)*o$D+o$L)];--o$L,++o$h);for(o$L=o$h;0<o$L;--o$L)this._cells[3*((o$r+o$V)*o$D+o$o-o$L)+1]=o$L,this._check(0<o$L)}if(0<o$r)for(o$L=o$o;o$L<o$o+o$T;++o$L){for(o$h=0,o$V=o$r-1;0<=o$V&&0==this._cells[3*(o$L+o$V*o$D)];--o$V,o$h++);for(o$V=o$h;0<o$V;--o$V)this._cells[3*(o$L+(o$r-o$V)*o$D)+2]=o$V,this._check(0<o$V)}},o$r._check=function(o$o){0==o$o&&console.log("xtexMerger 错误啦")},o$r._clear=function(){for(var o$o=this._texCount=0;o$o<this._height;o$o++)this._rowInfo[o$o].spaceCount=this._width;for(var o$r=0;o$r<this._height;o$r++)for(var o$T=0;o$T<this._width;o$T++){var o$k=3*(o$r*this._width+o$T);this._cells[o$k]=0,this._cells[1+o$k]=this._width-o$T,this._cells[2+o$k]=this._width-o$r}this._failSize.width=this._width+1,this._failSize.height=this._height+1},o$o.__init$=function(){o$k=function(){function o$o(){this.spaceCount=0}return o$i(o$o,""),o$o}(),o$W=function(){function o$o(){this.width=0,this.height=0}return o$i(o$o,""),o$o}()},o$o}(),o$Y=function(){function o$K(o$o,o$r,o$T,o$k){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=o$o,this._height=o$r,this._gridSize=o$T,this._maxAtlaserCount=o$k,this._gridNumX=o$o/o$T,this._gridNumY=o$r/o$T,this._curAtlasIndex=0,this._atlaserArray=[]}o$i(o$K,"laya.webgl.atlas.AtlasResourceManager");var o$o=o$K.prototype;return o$o.setAtlasParam=function(o$o,o$r,o$T,o$k){if(1==this._setAtlasParam)return o$K._sid_=0,this._width=o$o,this._height=o$r,this._gridSize=o$T,this._maxAtlaserCount=o$k,this._gridNumX=o$o/o$T,this._gridNumY=o$r/o$T,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},o$o.pushData=function(o$o){var o$r,o$T=o$o.bitmap,o$k=-1,o$W=null,o$D=0,o$n=0;for(o$D=0,o$r=this._atlaserArray.length;o$D<o$r&&(o$n=(this._curAtlasIndex+o$D)%o$r,-1==(o$k=(o$W=this._atlaserArray[o$n]).findBitmapIsExist(o$T)));o$D++);if(-1!=o$k){var o$V=o$W.InAtlasWebGLImagesOffsetValue[o$k];return o$x=o$V[0],o$j=o$V[1],o$W.addToAtlas(o$o,o$x,o$j),!0}this._setAtlasParam=!1;for(var o$L=Math.ceil((o$o.bitmap.width+2)/this._gridSize),o$U=Math.ceil((o$o.bitmap.height+2)/this._gridSize),o$h=!1,o$p=0;o$p<2;o$p++){var o$i=this._maxAtlaserCount;for(o$D=0;o$D<o$i;o$D++){o$n=(this._curAtlasIndex+o$D)%o$i,this._atlaserArray.length-1>=o$n||this._atlaserArray.push(new o$Ho(this._gridNumX,this._gridNumY,this._width,this._height,o$K._sid_++));var o$v=this._atlaserArray[o$n],o$x=0,o$j=0,o$_=o$v.addTex(1,o$L,o$U);if(o$_.ret){o$x=o$_.x*this._gridSize+1,o$j=o$_.y*this._gridSize+1,o$T.lock=!0,o$v.addToAtlasTexture(o$T,o$x,o$j),o$v.addToAtlas(o$o,o$x,o$j),o$h=!0,this._curAtlasIndex=o$n;break}}if(o$h)break;this._atlaserArray.push(new o$Ho(this._gridNumX,this._gridNumY,this._width,this._height,o$K._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return o$h||console.log(">>>AtlasManager pushData error"),o$h},o$o.addToAtlas=function(o$o){laya.webgl.atlas.AtlasResourceManager.instance.pushData(o$o)},o$o.garbageCollection=function(){if(!0===this._needGC){for(var o$o=this._atlaserArray.length-this._maxAtlaserCount,o$r=0;o$r<o$o;o$r++)this._atlaserArray[o$r].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+o$o),this._atlaserArray.splice(0,o$o),this._needGC=!1}return!0},o$o.freeAll=function(){for(var o$o=0,o$r=this._atlaserArray.length;o$o<o$r;o$o++)this._atlaserArray[o$o].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},o$o.getAtlaserCount=function(){return this._atlaserArray.length},o$o.getAtlaserByIndex=function(o$o){return this._atlaserArray[o$o]},o$k(1,o$K,"instance",function(){return o$K._Instance||(o$K._Instance=new o$K(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),o$K._Instance}),o$k(1,o$K,"enabled",function(){return o$b.atlasEnable}),o$k(1,o$K,"atlasLimitWidth",function(){return o$K._atlasLimitWidth},function(o$o){o$K._atlasLimitWidth=o$o}),o$k(1,o$K,"atlasLimitHeight",function(){return o$K._atlasLimitHeight},function(o$o){o$K._atlasLimitHeight=o$o}),o$K._enable=function(){o$b.atlasEnable=!0},o$K._disable=function(){o$b.atlasEnable=!1},o$K.__init__=function(){o$K.atlasTextureWidth=2048,o$K.atlasTextureHeight=2048,o$K.maxTextureCount=6,o$K.atlasLimitWidth=512,o$K.atlasLimitHeight=512},o$K._atlasLimitWidth=0,o$K._atlasLimitHeight=0,o$K.gridSize=16,o$K.atlasTextureWidth=0,o$K.atlasTextureHeight=0,o$K.maxTextureCount=0,o$K._atlasRestore=0,o$K.BOARDER_TYPE_NO=0,o$K.BOARDER_TYPE_RIGHT=1,o$K.BOARDER_TYPE_LEFT=2,o$K.BOARDER_TYPE_BOTTOM=4,o$K.BOARDER_TYPE_TOP=8,o$K.BOARDER_TYPE_ALL=15,o$K._sid_=0,o$K._Instance=null,o$K}(),o$A=function(){function o$o(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return o$i(o$o,"laya.webgl.atlas.MergeFillInfo"),o$o}(),o$I=function(){function o$r(){}return o$i(o$r,"laya.webgl.canvas.BlendMode"),o$r._init_=function(o$o){o$r.fns=[o$r.BlendNormal,o$r.BlendAdd,o$r.BlendMultiply,o$r.BlendScreen,o$r.BlendOverlay,o$r.BlendLight,o$r.BlendMask,o$r.BlendDestinationOut],o$r.targetFns=[o$r.BlendNormalTarget,o$r.BlendAddTarget,o$r.BlendMultiplyTarget,o$r.BlendScreenTarget,o$r.BlendOverlayTarget,o$r.BlendLightTarget,o$r.BlendMask,o$r.BlendDestinationOut]},o$r.BlendNormal=function(o$o){o$o.blendFunc(1,771)},o$r.BlendAdd=function(o$o){o$o.blendFunc(1,772)},o$r.BlendMultiply=function(o$o){o$o.blendFunc(774,771)},o$r.BlendScreen=function(o$o){o$o.blendFunc(1,1)},o$r.BlendOverlay=function(o$o){o$o.blendFunc(1,769)},o$r.BlendLight=function(o$o){o$o.blendFunc(1,1)},o$r.BlendNormalTarget=function(o$o){o$o.blendFunc(1,771)},o$r.BlendAddTarget=function(o$o){o$o.blendFunc(1,772)},o$r.BlendMultiplyTarget=function(o$o){o$o.blendFunc(774,771)},o$r.BlendScreenTarget=function(o$o){o$o.blendFunc(1,1)},o$r.BlendOverlayTarget=function(o$o){o$o.blendFunc(1,769)},o$r.BlendLightTarget=function(o$o){o$o.blendFunc(1,1)},o$r.BlendMask=function(o$o){o$o.blendFunc(0,770)},o$r.BlendDestinationOut=function(o$o){o$o.blendFunc(0,0)},o$r.activeBlendFunction=null,o$r.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],o$r.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},o$r.NORMAL="normal",o$r.ADD="add",o$r.MULTIPLY="multiply",o$r.SCREEN="screen",o$r.LIGHT="light",o$r.OVERLAY="overlay",o$r.DESTINATIONOUT="destination-out",o$r.fns=[],o$r.targetFns=[],o$r}(),o$N=function(){function o$T(o$o){this._color=o$x.create("black"),this.setValue(o$o)}o$i(o$T,"laya.webgl.canvas.DrawStyle");var o$o=o$T.prototype;return o$o.setValue=function(o$o){if(o$o){if("string"==typeof o$o)return void(this._color=o$x.create(o$o));if(o$o instanceof laya.utils.Color)return void(this._color=o$o)}},o$o.reset=function(){this._color=o$x.create("black")},o$o.equal=function(o$o){return"string"==typeof o$o?this._color.strColor===o$o:o$o instanceof laya.utils.Color&&this._color.numColor===o$o.numColor},o$o.toColorStr=function(){return this._color.strColor},o$T.create=function(o$o){var o$r;if(o$o&&("string"==typeof o$o?o$r=o$x.create(o$o):o$o instanceof laya.utils.Color&&(o$r=o$o),o$r))return o$r._drawStyle||(o$r._drawStyle=new o$T(o$o));return laya.webgl.canvas.DrawStyle.DEFAULT},o$n(o$T,["DEFAULT",function(){return this.DEFAULT=new o$T("#000000")}]),o$T}(),o$f=function(){function o$o(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];o$lo.mainContext;this.ib=o$Eo.create(35048),this.vb=o$do.create(5)}o$i(o$o,"laya.webgl.canvas.Path");var o$r=o$o.prototype;return o$r.addPoint=function(o$o,o$r){this.tempArray.push(o$o,o$r)},o$r.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},o$r.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},o$r.polygon=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n;return this.geomatrys.push(this._curGeomatry=o$n=new o$zo(o$o,o$r,o$T,o$k,o$W,o$D)),o$k||(o$n.fill=!1),null==o$D&&(o$n.borderWidth=0),o$n},o$r.setGeomtry=function(o$o){this.geomatrys.push(this._curGeomatry=o$o)},o$r.drawLine=function(o$o,o$r,o$T,o$k,o$W){var o$D;return this.closePath?this.geomatrys.push(this._curGeomatry=o$D=new o$so(o$o,o$r,o$T,o$k,o$W)):this.geomatrys.push(this._curGeomatry=o$D=new o$uo(o$o,o$r,o$T,o$k,o$W)),o$D.fill=!1,o$D},o$r.update=function(){var o$o=this.ib._byteLength,o$r=this.geomatrys.length;this.offset=o$o;for(var o$T=this.geoStart;o$T<o$r;o$T++)this.geomatrys[o$T].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=o$r,this.count=(this.ib._byteLength-o$o)/o$jo.BYTES_PIDX},o$r.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},o$r.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},o$o}(),o$a=function(){function o$V(){}o$i(o$V,"laya.webgl.canvas.save.SaveBase");var o$o=o$V.prototype;return o$q.imps(o$o,{"laya.webgl.canvas.save.ISaveData":!0}),o$o.isSaveMark=function(){return!1},o$o.restore=function(o$o){this._dataObj[this._valueName]=this._value,(o$V._cache[o$V._cache._length++]=this)._newSubmit&&(o$o._curSubmit=o$Do.RENDERBASE,o$o._renderKey=0)},o$V._createArray=function(){var o$o=[];return o$o._length=0,o$o},o$V._init=function(){var o$o=o$V._namemap={};return o$o[1]="ALPHA",o$o[2]="fillStyle",o$o[8]="font",o$o[256]="lineWidth",o$o[512]="strokeStyle",o$o[8192]="_mergeID",o$o[1024]=o$o[2048]=o$o[4096]=[],o$o[16384]="textBaseline",o$o[32768]="textAlign",o$o[65536]="_nBlendType",o$o[1048576]="shader",o$o[2097152]="filters",o$o},o$V.save=function(o$o,o$r,o$T,o$k){if((o$o._saveMark._saveuse&o$r)!==o$r){o$o._saveMark._saveuse|=o$r;var o$W=o$V._cache,o$D=0<o$W._length?o$W[--o$W._length]:new o$V;o$D._value=o$T[o$D._valueName=o$V._namemap[o$r]],o$D._dataObj=o$T,o$D._newSubmit=o$k;var o$n=o$o._save;o$n[o$n._length++]=o$D}},o$V._cache=laya.webgl.canvas.save.SaveBase._createArray(),o$V._namemap=o$V._init(),o$V}(),o$G=function(){function o$D(){this._clipRect=new o$H}o$i(o$D,"laya.webgl.canvas.save.SaveClipRect");var o$o=o$D.prototype;return o$q.imps(o$o,{"laya.webgl.canvas.save.ISaveData":!0}),o$o.isSaveMark=function(){return!1},o$o.restore=function(o$o){o$o._clipRect=this._clipSaveRect,(o$D._cache[o$D._cache._length++]=this)._submitScissor.submitLength=o$o._submits._length-this._submitScissor.submitIndex,o$o._curSubmit=o$Do.RENDERBASE,o$o._renderKey=0},o$D.save=function(o$o,o$r){if(131072!=(131072&o$o._saveMark._saveuse)){o$o._saveMark._saveuse|=131072;var o$T=o$D._cache,o$k=0<o$T._length?o$T[--o$T._length]:new o$D;o$k._clipSaveRect=o$o._clipRect,o$o._clipRect=o$k._clipRect.copyFrom(o$o._clipRect),o$k._submitScissor=o$r;var o$W=o$o._save;o$W[o$W._length++]=o$k}},o$n(o$D,["_cache",function(){return this._cache=o$a._createArray()}]),o$D}(),o$w=function(){function o$v(){this._contextX=0,this._contextY=0,this._clipRect=new o$H,this._rect=new o$H,this._matrix=new o$P}o$i(o$v,"laya.webgl.canvas.save.SaveClipRectStencil");var o$o=o$v.prototype;return o$q.imps(o$o,{"laya.webgl.canvas.save.ISaveData":!0}),o$o.isSaveMark=function(){return!1},o$o.restore=function(o$o){o$ho.restore(o$o,this._rect,this._saveMatrix,this._contextX,this._contextY),o$o._clipRect=this._clipSaveRect,o$o._curMat=this._saveMatrix,o$o._x=this._contextX,o$o._y=this._contextY,o$v._cache[o$v._cache._length++]=this,o$o._curSubmit=o$Do.RENDERBASE},o$v.save=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){if(262144!=(262144&o$o._saveMark._saveuse)){o$o._saveMark._saveuse|=262144;var o$h=o$v._cache,o$p=0<o$h._length?o$h[--o$h._length]:new o$v;o$p._clipSaveRect=o$o._clipRect,o$p._clipRect.setTo(o$n,o$V,o$L,o$U),o$o._clipRect=o$p._clipRect,o$p._rect.x=o$T,o$p._rect.y=o$k,o$p._rect.width=o$W,o$p._rect.height=o$D,o$p._contextX=o$o._x,o$p._contextY=o$o._y,o$p._saveMatrix=o$o._curMat,o$o._curMat.copyTo(o$p._matrix),o$o._curMat=o$p._matrix,o$p._submitStencil=o$r;var o$i=o$o._save;o$i[o$i._length++]=o$p}},o$n(o$v,["_cache",function(){return this._cache=o$a._createArray()}]),o$v}(),o$Z=function(){function o$k(){this._saveuse=0}o$i(o$k,"laya.webgl.canvas.save.SaveMark");var o$o=o$k.prototype;return o$q.imps(o$o,{"laya.webgl.canvas.save.ISaveData":!0}),o$o.isSaveMark=function(){return!0},o$o.restore=function(o$o){o$o._saveMark=this._preSaveMark,o$k._no[o$k._no._length++]=this},o$k.Create=function(o$o){var o$r=o$k._no,o$T=0<o$r._length?o$r[--o$r._length]:new o$k;return o$T._saveuse=0,o$T._preSaveMark=o$o._saveMark,o$o._saveMark=o$T},o$n(o$k,["_no",function(){return this._no=o$a._createArray()}]),o$k}(),o$Q=function(){function o$D(){this._matrix=new o$P}o$i(o$D,"laya.webgl.canvas.save.SaveTransform");var o$o=o$D.prototype;return o$q.imps(o$o,{"laya.webgl.canvas.save.ISaveData":!0}),o$o.isSaveMark=function(){return!1},o$o.restore=function(o$o){o$o._curMat=this._savematrix,o$D._no[o$D._no._length++]=this},o$D.save=function(o$o){var o$r=o$o._saveMark;if(2048!=(2048&o$r._saveuse)){o$r._saveuse|=2048;var o$T=o$D._no,o$k=0<o$T._length?o$T[--o$T._length]:new o$D;o$k._savematrix=o$o._curMat,o$o._curMat=o$o._curMat.copyTo(o$k._matrix);var o$W=o$o._save;o$W[o$W._length++]=o$k}},o$n(o$D,["_no",function(){return this._no=o$a._createArray()}]),o$D}(),o$g=function(){function o$W(){}o$i(o$W,"laya.webgl.canvas.save.SaveTranslate");var o$o=o$W.prototype;return o$q.imps(o$o,{"laya.webgl.canvas.save.ISaveData":!0}),o$o.isSaveMark=function(){return!1},o$o.restore=function(o$o){o$o._curMat;o$o._x=this._x,o$o._y=this._y,o$W._no[o$W._no._length++]=this},o$W.save=function(o$o){var o$r=o$W._no,o$T=0<o$r._length?o$r[--o$r._length]:new o$W;o$T._x=o$o._x,o$T._y=o$o._y;var o$k=o$o._save;o$k[o$k._length++]=o$T},o$n(o$W,["_no",function(){return this._no=o$a._createArray()}]),o$W}(),o$B=function(){function o$o(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new o$H}o$i(o$o,"laya.webgl.resource.RenderTargetMAX");var o$r=o$o.prototype;return o$r.setSP=function(o$o){this._sp=o$o},o$r.size=function(o$o,o$r){var o$T=this;this._width!==o$o||this._height!==o$r?(this.repaint=!0,this._width=o$o,this._height=o$r,this.target?this.target.size(o$o,o$r):this.target=o$Mo.create(o$o,o$r),this.target.hasListener("recovered")||this.target.on("recovered",this,function(o$o){o$q.timer.callLater(o$T._sp,o$T._sp.repaint)})):this.target.size(o$o,o$r)},o$r._flushToTarget=function(o$o,o$r){if(!o$r._destroy){var o$T=o$$o.worldScissorTest,o$k=o$$o.worldClipRect;o$$o.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,o$$o.worldScissorTest=!1,o$lo.mainContext.disable(3089);var o$W=o$$o.worldAlpha,o$D=o$$o.worldMatrix4,o$n=o$$o.worldMatrix,o$V=o$$o.worldFilters,o$L=o$$o.worldShaderDefines;if(o$$o.worldMatrix=o$P.EMPTY,o$$o.restoreTempArray(),o$$o.worldMatrix4=o$$o.TEMPMAT4_ARRAY,o$$o.worldAlpha=1,o$$o.worldFilters=null,o$$o.worldShaderDefines=null,o$Oo.activeShader=null,o$r.start(),o$b.showCanvasMark?o$r.clear(0,1,0,.3):o$r.clear(0,0,0,0),o$o.flush(),o$r.end(),o$Oo.activeShader=null,o$$o.worldAlpha=o$W,o$$o.worldMatrix4=o$D,o$$o.worldMatrix=o$n,o$$o.worldFilters=o$V,o$$o.worldShaderDefines=o$L,o$$o.worldScissorTest=o$T){var o$U=o$$o.height-o$k.y-o$k.height;o$lo.mainContext.scissor(o$k.x,o$U,o$k.width,o$k.height),o$lo.mainContext.enable(3089)}o$$o.worldClipRect=o$k}},o$r.flush=function(o$o){this.repaint&&(this._flushToTarget(o$o,this.target),this.repaint=!1)},o$r.drawTo=function(o$o,o$r,o$T,o$k,o$W){o$o.drawTexture(this.target.getTexture(),o$r,o$T,o$k,o$W,0,0)},o$r.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},o$o}(),o$E=function(){function o$o(){this.ALPHA=1,this.shaderType=0,this.defines=new o$Ro}return o$i(o$o,"laya.webgl.shader.d2.Shader2D"),o$o.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},o$o.__init__=function(){var o$o,o$r;o$Zo.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),o$Zo.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),o$Zo.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),o$Zo.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),o$Zo.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),o$Zo.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),o$Zo.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),o$Zo.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),o$o="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",o$r='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',o$Zo.preCompile2D(0,1,o$o,o$r,null),o$o="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",o$r='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',o$Zo.preCompile2D(0,2,o$o,o$r,null),o$o="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",o$r="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",o$Zo.preCompile2D(0,4,o$o,o$r,null),o$o="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",o$r='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',o$Zo.preCompile2D(0,256,o$o,o$r,null),o$o="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",o$r="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",o$Zo.preCompile2D(0,512,o$o,o$r,null)},o$o}(),o$d=function(){function o$r(o$o,o$r,o$T){this._value=0,this._name2int=o$o,this._int2name=o$r,this._int2nameMap=o$T}o$i(o$r,"laya.webgl.shader.ShaderDefines");var o$o=o$r.prototype;return o$o.add=function(o$o){return"string"==typeof o$o&&(o$o=this._name2int[o$o]),this._value|=o$o,this._value},o$o.addInt=function(o$o){return this._value|=o$o,this._value},o$o.remove=function(o$o){return"string"==typeof o$o&&(o$o=this._name2int[o$o]),this._value&=~o$o,this._value},o$o.isDefine=function(o$o){return(this._value&o$o)===o$o},o$o.getValue=function(){return this._value},o$o.setValue=function(o$o){this._value=o$o},o$o.toNameDic=function(){var o$o=this._int2nameMap[this._value];return o$o||o$r._toText(this._value,this._int2name,this._int2nameMap)},o$r._reg=function(o$o,o$r,o$T,o$k){o$k[o$T[o$o]=o$r]=o$o},o$r._toText=function(o$o,o$r,o$T){var o$k=o$T[o$o];if(o$k)return o$k;for(var o$W={},o$D=1,o$n=0;o$n<32&&!(o$o<(o$D=1<<o$n));o$n++)if(o$o&o$D){var o$V=o$r[o$D];o$V&&(o$W[o$V]="")}return o$T[o$o]=o$W},o$r._toInt=function(o$o,o$r){for(var o$T=o$o.split("."),o$k=0,o$W=0,o$D=o$T.length;o$W<o$D;o$W++){var o$n=o$r[o$T[o$W]];if(!o$n)throw new Error("Defines to int err:"+o$o+"/"+o$T[o$W]);o$k|=o$n}return o$k},o$r}(),o$oo=function(){function o$n(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new o$P}o$i(o$n,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var o$o=o$n.prototype;return o$o.init=function(o$o,o$r,o$T){if(o$r)this._vs=o$r;else{this._vs=[];var o$k=o$o.width,o$W=o$o.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(o$k,0,1,0,1,1,1,1),this._vs.push(o$k,o$W,1,1,1,1,1,1),this._vs.push(0,o$W,0,1,1,1,1,1)}o$T?this._ps=o$T:(o$n._defaultPS||(o$n._defaultPS=[]).push(0,1,3,3,1,2),this._ps=o$n._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=o$o},o$o.init2=function(o$o,o$r,o$T,o$k,o$W){this.transform&&(this.transform=null),o$T?this._ps=o$T:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=o$k,this._uvs=o$W,this.mEleNum=this._ps.length,this.mTexture=o$o,(o$K.isConchNode||o$K.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},o$o._initMyData=function(){var o$o=0,o$r=0,o$T=4*this._verticles.length;this._vs=o$n._tempVS;var o$k=!1;if(o$K.isConchNode||o$K.isConchApp?(this._vs.length=o$T,o$k=!0):this._vs.length<o$T&&(this._vs.length=o$T,o$k=!0),o$n._tVSLen=o$T,o$k)for(;o$o<o$T;)this._vs[o$o]=this._verticles[o$r],this._vs[o$o+1]=this._verticles[o$r+1],this._vs[o$o+2]=this._uvs[o$r],this._vs[o$o+3]=this._uvs[o$r+1],this._vs[o$o+4]=1,this._vs[o$o+5]=1,this._vs[o$o+6]=1,this._vs[o$o+7]=1,o$o+=8,o$r+=2;else for(;o$o<o$T;)this._vs[o$o]=this._verticles[o$r],this._vs[o$o+1]=this._verticles[o$r+1],this._vs[o$o+2]=this._uvs[o$r],this._vs[o$o+3]=this._uvs[o$r+1],o$o+=8,o$r+=2},o$o.getData2=function(o$o,o$r,o$T){var o$k;this.mVBBuffer=o$o,this.mIBBuffer=o$r,this._initMyData(),o$o.appendEx2(this._vs,Float32Array,o$n._tVSLen,4),this._indexStart=o$r._byteLength,(o$k=o$n._tempIB).length<this._ps.length&&(o$k.length=this._ps.length);for(var o$W=0,o$D=this._ps.length;o$W<o$D;o$W++)o$k[o$W]=this._ps[o$W]+o$T;o$r.appendEx2(o$k,Uint16Array,this._ps.length,2)},o$o.getData=function(o$o,o$r,o$T){if(this.mVBBuffer=o$o,this.mIBBuffer=o$r,o$o.append(this.mVBData),this._indexStart=o$r._byteLength,this.mIBData.start!=o$T){for(var o$k=0,o$W=this._ps.length;o$k<o$W;o$k++)this.mIBData[o$k]=this._ps[o$k]+o$T;this.mIBData.start=o$T}o$r.append(this.mIBData)},o$o.render=function(o$o,o$r,o$T){if(o$K.isWebGL&&this.mTexture){o$o._renderKey=0,o$o._shader2D.glTexture=null,o$ro.getInstance().addSkinMesh(this);var o$k=o$Do.createShape(o$o,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,o$Fo.create(512,0));this.transform||(this.transform=o$P.EMPTY),this.transform.translate(o$r,o$T),o$P.mul(this.transform,o$o._curMat,this._tempMatrix),this.transform.translate(-o$r,-o$T);var o$W=o$k.shaderValue,o$D=o$W.u_mmat2||o$$o.getMatrArray();o$$o.mat2MatArray(this._tempMatrix,o$D),o$W.textureHost=this.mTexture,o$W.offsetX=0,o$W.offsetY=0,o$W.u_mmat2=o$D,o$W.ALPHA=o$o._shader2D.ALPHA,o$o._submits[o$o._submits._length++]=o$k}else o$K.isConchApp&&this.mTexture&&(this.transform||(this.transform=o$P.EMPTY),o$o.setSkinMesh&&o$o.setSkinMesh(o$r,o$T,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},o$n._tempVS=[],o$n._tempIB=[],o$n._defaultPS=null,o$n._tVSLen=0,o$n}(),o$ro=function(){function o$o(){this.ib=null,this.vb=null;o$lo.mainContext;this.ib=o$Eo.create(35048),this.vb=o$do.create(8)}o$i(o$o,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var o$r=o$o.prototype;return o$r.addSkinMesh=function(o$o){o$o.getData2(this.vb,this.ib,this.vb._byteLength/32)},o$r.reset=function(){this.vb.clear(),this.ib.clear()},o$o.getInstance=function(){return o$o.instance=o$o.instance||new o$o},o$o.instance=null,o$o}(),o$To=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===o$L&&(o$L=0),this.x=o$o,this.y=o$r,this.width=o$T,this.height=o$k,this.edges=o$W,this.color=o$D,this.borderWidth=o$n,this.borderColor=o$V}o$i(o$o,"laya.webgl.shapes.BasePoly");var o$r=o$o.prototype;return o$q.imps(o$r,{"laya.webgl.shapes.IShape":!0}),o$r.getData=function(o$o,o$r,o$T){},o$r.rebuild=function(o$o){},o$r.setMatrix=function(o$o){},o$r.needUpdate=function(o$o){return!0},o$r.sector=function(o$o,o$r,o$T){var o$k=this.x,o$W=this.y,o$D=this.edges,o$n=(this.r1-this.r0)/o$D,o$V=this.width,o$L=this.height,o$U=this.color,o$h=(o$U>>16&255)/255,o$p=(o$U>>8&255)/255,o$i=(255&o$U)/255;o$o.push(o$k,o$W,o$h,o$p,o$i);for(var o$v=0;o$v<o$D+1;o$v++)o$o.push(o$k+Math.sin(o$n*o$v+this.r0)*o$V,o$W+Math.cos(o$n*o$v+this.r0)*o$L),o$o.push(o$h,o$p,o$i);for(o$v=0;o$v<o$D;o$v++)o$r.push(o$T,o$T+o$v+1,o$T+o$v+2)},o$r.createLine2=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n,o$V,o$L,o$U,o$h,o$p,o$i,o$v,o$x,o$j,o$_,o$K,o$$,o$y,o$l,o$S,o$q,o$b,o$F,o$P,o$t=o$o.concat(),o$H=o$W,o$R=this.borderColor,o$u=(o$R>>16&255)/255,o$s=(o$R>>8&255)/255,o$z=(255&o$R)/255,o$m=o$t.length/2,o$C=o$k,o$X=o$T/2;o$L=o$t[0],o$U=o$t[1],o$j=o$L-(o$h=o$t[2]),o$x=(o$x=-(o$U-(o$p=o$t[3])))/(o$P=Math.sqrt(o$x*o$x+o$j*o$j))*o$X,o$j=o$j/o$P*o$X,o$H.push(o$L-o$x+this.x,o$U-o$j+this.y,o$u,o$s,o$z,o$L+o$x+this.x,o$U+o$j+this.y,o$u,o$s,o$z);for(var o$O=1;o$O<o$m-1;o$O++)o$L=o$t[2*(o$O-1)],o$U=o$t[2*(o$O-1)+1],o$h=o$t[2*o$O],o$p=o$t[2*o$O+1],o$i=o$t[2*(o$O+1)],o$v=o$t[2*(o$O+1)+1],o$j=o$L-o$h,o$K=o$h-o$i,o$l=(-(o$x=(o$x=-(o$U-o$p))/(o$P=Math.sqrt(o$x*o$x+o$j*o$j))*o$X)+o$L)*(-(o$j=o$j/o$P*o$X)+o$p)-(-o$x+o$h)*(-o$j+o$U),o$b=(-(o$_=(o$_=-(o$p-o$v))/(o$P=Math.sqrt(o$_*o$_+o$K*o$K))*o$X)+o$i)*(-(o$K=o$K/o$P*o$X)+o$p)-(-o$_+o$h)*(-o$K+o$v),o$F=(o$$=-o$j+o$U-(-o$j+o$p))*(o$q=-o$_+o$h-(-o$_+o$i))-(o$S=-o$K+o$v-(-o$K+o$p))*(o$y=-o$x+o$h-(-o$x+o$L)),Math.abs(o$F)<.1?(o$F+=10.1,o$H.push(o$h-o$x+this.x,o$p-o$j+this.y,o$u,o$s,o$z,o$h+o$x+this.x,o$p+o$j+this.y,o$u,o$s,o$z)):(((o$n=(o$y*o$b-o$q*o$l)/o$F)-o$h)*(o$n-o$h)+((o$V=(o$S*o$l-o$$*o$b)/o$F)-o$p)+(o$V-o$p),o$H.push(o$n+this.x,o$V+this.y,o$u,o$s,o$z,o$h-(o$n-o$h)+this.x,o$p-(o$V-o$p)+this.y,o$u,o$s,o$z));o$L=o$t[o$t.length-4],o$U=o$t[o$t.length-3],o$j=o$L-(o$h=o$t[o$t.length-2]),o$x=(o$x=-(o$U-(o$p=o$t[o$t.length-1])))/(o$P=Math.sqrt(o$x*o$x+o$j*o$j))*o$X,o$j=o$j/o$P*o$X,o$H.push(o$h-o$x+this.x,o$p-o$j+this.y,o$u,o$s,o$z,o$h+o$x+this.x,o$p+o$j+this.y,o$u,o$s,o$z);var o$M=o$D;for(o$O=1;o$O<o$M;o$O++)o$r.push(o$C+2*(o$O-1),o$C+2*(o$O-1)+1,o$C+2*o$O+1,o$C+2*o$O+1,o$C+2*o$O,o$C+2*(o$O-1));return o$H},o$r.createLine=function(o$o,o$r,o$T,o$k){var o$W=o$o.concat(),o$D=o$o,o$n=this.borderColor,o$V=(o$n>>16&255)/255,o$L=(o$n>>8&255)/255,o$U=(255&o$n)/255;o$W.splice(0,5);var o$h,o$p,o$i,o$v,o$x,o$j,o$_,o$K,o$$,o$y,o$l,o$S,o$q,o$b,o$F,o$P,o$t,o$H,o$R,o$u,o$s=o$W.length/5,o$z=o$k,o$m=o$T/2;o$i=o$W[0],o$v=o$W[1],o$y=o$i-(o$x=o$W[5]),o$$=(o$$=-(o$v-(o$j=o$W[6])))/(o$u=Math.sqrt(o$$*o$$+o$y*o$y))*o$m,o$y=o$y/o$u*o$m,o$D.push(o$i-o$$,o$v-o$y,o$V,o$L,o$U,o$i+o$$,o$v+o$y,o$V,o$L,o$U);for(var o$C=1;o$C<o$s-1;o$C++)o$i=o$W[5*(o$C-1)],o$v=o$W[5*(o$C-1)+1],o$x=o$W[5*o$C],o$j=o$W[5*o$C+1],o$_=o$W[5*(o$C+1)],o$K=o$W[5*(o$C+1)+1],o$y=o$i-o$x,o$S=o$x-o$_,o$F=(-(o$$=(o$$=-(o$v-o$j))/(o$u=Math.sqrt(o$$*o$$+o$y*o$y))*o$m)+o$i)*(-(o$y=o$y/o$u*o$m)+o$j)-(-o$$+o$x)*(-o$y+o$v),o$H=(-(o$l=(o$l=-(o$j-o$K))/(o$u=Math.sqrt(o$l*o$l+o$S*o$S))*o$m)+o$_)*(-(o$S=o$S/o$u*o$m)+o$j)-(-o$l+o$x)*(-o$S+o$K),o$R=(o$q=-o$y+o$v-(-o$y+o$j))*(o$t=-o$l+o$x-(-o$l+o$_))-(o$P=-o$S+o$K-(-o$S+o$j))*(o$b=-o$$+o$x-(-o$$+o$i)),Math.abs(o$R)<.1?(o$R+=10.1,o$D.push(o$x-o$$,o$j-o$y,o$V,o$L,o$U,o$x+o$$,o$j+o$y,o$V,o$L,o$U)):(((o$h=(o$b*o$H-o$t*o$F)/o$R)-o$x)*(o$h-o$x)+((o$p=(o$P*o$F-o$q*o$H)/o$R)-o$j)+(o$p-o$j),o$D.push(o$h,o$p,o$V,o$L,o$U,o$x-(o$h-o$x),o$j-(o$p-o$j),o$V,o$L,o$U));o$i=o$W[o$W.length-10],o$v=o$W[o$W.length-9],o$y=o$i-(o$x=o$W[o$W.length-5]),o$$=(o$$=-(o$v-(o$j=o$W[o$W.length-4])))/(o$u=Math.sqrt(o$$*o$$+o$y*o$y))*o$m,o$y=o$y/o$u*o$m,o$D.push(o$x-o$$,o$j-o$y,o$V,o$L,o$U,o$x+o$$,o$j+o$y,o$V,o$L,o$U);var o$X=this.edges+1;for(o$C=1;o$C<o$X;o$C++)o$r.push(o$z+2*(o$C-1),o$z+2*(o$C-1)+1,o$z+2*o$C+1,o$z+2*o$C+1,o$z+2*o$C,o$z+2*(o$C-1));return o$D},o$r.createLoopLine=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=o$o.concat(),o$V=o$W||o$o,o$L=this.borderColor,o$U=(o$L>>16&255)/255,o$h=(o$L>>8&255)/255,o$p=(255&o$L)/255;o$n.splice(0,5);var o$i=[o$n[0],o$n[1]],o$v=[o$n[o$n.length-5],o$n[o$n.length-4]],o$x=o$v[0]+.5*(o$i[0]-o$v[0]),o$j=o$v[1]+.5*(o$i[1]-o$v[1]);o$n.unshift(o$x,o$j,0,0,0),o$n.push(o$x,o$j,0,0,0);var o$_,o$K,o$$,o$y,o$l,o$S,o$q,o$b,o$F,o$P,o$t,o$H,o$R,o$u,o$s,o$z,o$m,o$C,o$X,o$O,o$M=o$n.length/5,o$c=o$k,o$e=o$T/2;o$$=o$n[0],o$y=o$n[1],o$P=o$$-(o$l=o$n[5]),o$F=(o$F=-(o$y-(o$S=o$n[6])))/(o$O=Math.sqrt(o$F*o$F+o$P*o$P))*o$e,o$P=o$P/o$O*o$e,o$V.push(o$$-o$F,o$y-o$P,o$U,o$h,o$p,o$$+o$F,o$y+o$P,o$U,o$h,o$p);for(var o$J=1;o$J<o$M-1;o$J++)o$$=o$n[5*(o$J-1)],o$y=o$n[5*(o$J-1)+1],o$l=o$n[5*o$J],o$S=o$n[5*o$J+1],o$q=o$n[5*(o$J+1)],o$b=o$n[5*(o$J+1)+1],o$P=o$$-o$l,o$H=o$l-o$q,o$s=(-(o$F=(o$F=-(o$y-o$S))/(o$O=Math.sqrt(o$F*o$F+o$P*o$P))*o$e)+o$$)*(-(o$P=o$P/o$O*o$e)+o$S)-(-o$F+o$l)*(-o$P+o$y),o$C=(-(o$t=(o$t=-(o$S-o$b))/(o$O=Math.sqrt(o$t*o$t+o$H*o$H))*o$e)+o$q)*(-(o$H=o$H/o$O*o$e)+o$S)-(-o$t+o$l)*(-o$H+o$b),o$X=(o$R=-o$P+o$y-(-o$P+o$S))*(o$m=-o$t+o$l-(-o$t+o$q))-(o$z=-o$H+o$b-(-o$H+o$S))*(o$u=-o$F+o$l-(-o$F+o$$)),Math.abs(o$X)<.1?(o$X+=10.1,o$V.push(o$l-o$F,o$S-o$P,o$U,o$h,o$p,o$l+o$F,o$S+o$P,o$U,o$h,o$p)):(((o$_=(o$u*o$C-o$m*o$s)/o$X)-o$l)*(o$_-o$l)+((o$K=(o$z*o$s-o$R*o$C)/o$X)-o$S)+(o$K-o$S),o$V.push(o$_,o$K,o$U,o$h,o$p,o$l-(o$_-o$l),o$S-(o$K-o$S),o$U,o$h,o$p));o$D&&(o$r=o$D);var o$Y=this.edges+1;for(o$J=1;o$J<o$Y;o$J++)o$r.push(o$c+2*(o$J-1),o$c+2*(o$J-1)+1,o$c+2*o$J+1,o$c+2*o$J+1,o$c+2*o$J,o$c+2*(o$J-1));return o$r.push(o$c+2*(o$J-1),o$c+2*(o$J-1)+1,o$c+1,o$c+1,o$c,o$c+2*(o$J-1)),o$V},o$o}(),o$ko=function(){function o$j(){}return o$i(o$j,"laya.webgl.shapes.Earcut"),o$j.earcut=function(o$o,o$r,o$T){o$T=o$T||2;var o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h=o$r&&o$r.length,o$p=o$h?o$r[0]*o$T:o$o.length,o$i=o$j.linkedList(o$o,0,o$p,o$T,!0),o$v=[];if(!o$i)return o$v;if(o$h&&(o$i=o$j.eliminateHoles(o$o,o$r,o$i,o$T)),o$o.length>80*o$T){o$k=o$D=o$o[0],o$W=o$n=o$o[1];for(var o$x=o$T;o$x<o$p;o$x+=o$T)(o$V=o$o[o$x])<o$k&&(o$k=o$V),(o$L=o$o[o$x+1])<o$W&&(o$W=o$L),o$D<o$V&&(o$D=o$V),o$n<o$L&&(o$n=o$L);o$U=0!==(o$U=Math.max(o$D-o$k,o$n-o$W))?1/o$U:0}return o$j.earcutLinked(o$i,o$v,o$T,o$k,o$W,o$U),o$v},o$j.linkedList=function(o$o,o$r,o$T,o$k,o$W){var o$D,o$n;if(o$W===0<o$j.signedArea(o$o,o$r,o$T,o$k))for(o$D=o$r;o$D<o$T;o$D+=o$k)o$n=o$j.insertNode(o$D,o$o[o$D],o$o[o$D+1],o$n);else for(o$D=o$T-o$k;o$r<=o$D;o$D-=o$k)o$n=o$j.insertNode(o$D,o$o[o$D],o$o[o$D+1],o$n);return o$n&&o$j.equals(o$n,o$n.next)&&(o$j.removeNode(o$n),o$n=o$n.next),o$n},o$j.filterPoints=function(o$o,o$r){if(!o$o)return o$o;o$r||(o$r=o$o);var o$T,o$k=o$o;do{if(o$T=!1,o$k.steiner||!o$j.equals(o$k,o$k.next)&&0!==o$j.area(o$k.prev,o$k,o$k.next))o$k=o$k.next;else{if(o$j.removeNode(o$k),(o$k=o$r=o$k.prev)===o$k.next)break;o$T=!0}}while(o$T||o$k!==o$r);return o$r},o$j.earcutLinked=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){if(o$o){!o$n&&o$D&&o$j.indexCurve(o$o,o$k,o$W,o$D);for(var o$V,o$L,o$U=o$o;o$o.prev!==o$o.next;)if(o$V=o$o.prev,o$L=o$o.next,o$D?o$j.isEarHashed(o$o,o$k,o$W,o$D):o$j.isEar(o$o))o$r.push(o$V.i/o$T),o$r.push(o$o.i/o$T),o$r.push(o$L.i/o$T),o$j.removeNode(o$o),o$o=o$L.next,o$U=o$L.next;else if((o$o=o$L)===o$U){o$n?1===o$n?(o$o=o$j.cureLocalIntersections(o$o,o$r,o$T),o$j.earcutLinked(o$o,o$r,o$T,o$k,o$W,o$D,2)):2===o$n&&o$j.splitEarcut(o$o,o$r,o$T,o$k,o$W,o$D):o$j.earcutLinked(o$j.filterPoints(o$o,null),o$r,o$T,o$k,o$W,o$D,1);break}}},o$j.isEar=function(o$o){var o$r=o$o.prev,o$T=o$o,o$k=o$o.next;if(0<=o$j.area(o$r,o$T,o$k))return!1;for(var o$W=o$o.next.next;o$W!==o$o.prev;){if(o$j.pointInTriangle(o$r.x,o$r.y,o$T.x,o$T.y,o$k.x,o$k.y,o$W.x,o$W.y)&&0<=o$j.area(o$W.prev,o$W,o$W.next))return!1;o$W=o$W.next}return!0},o$j.isEarHashed=function(o$o,o$r,o$T,o$k){var o$W=o$o.prev,o$D=o$o,o$n=o$o.next;if(0<=o$j.area(o$W,o$D,o$n))return!1;for(var o$V=o$W.x<o$D.x?o$W.x<o$n.x?o$W.x:o$n.x:o$D.x<o$n.x?o$D.x:o$n.x,o$L=o$W.y<o$D.y?o$W.y<o$n.y?o$W.y:o$n.y:o$D.y<o$n.y?o$D.y:o$n.y,o$U=o$W.x>o$D.x?o$W.x>o$n.x?o$W.x:o$n.x:o$D.x>o$n.x?o$D.x:o$n.x,o$h=o$W.y>o$D.y?o$W.y>o$n.y?o$W.y:o$n.y:o$D.y>o$n.y?o$D.y:o$n.y,o$p=o$j.zOrder(o$V,o$L,o$r,o$T,o$k),o$i=o$j.zOrder(o$U,o$h,o$r,o$T,o$k),o$v=o$o.nextZ;o$v&&o$v.z<=o$i;){if(o$v!==o$o.prev&&o$v!==o$o.next&&o$j.pointInTriangle(o$W.x,o$W.y,o$D.x,o$D.y,o$n.x,o$n.y,o$v.x,o$v.y)&&0<=o$j.area(o$v.prev,o$v,o$v.next))return!1;o$v=o$v.nextZ}for(o$v=o$o.prevZ;o$v&&o$v.z>=o$p;){if(o$v!==o$o.prev&&o$v!==o$o.next&&o$j.pointInTriangle(o$W.x,o$W.y,o$D.x,o$D.y,o$n.x,o$n.y,o$v.x,o$v.y)&&0<=o$j.area(o$v.prev,o$v,o$v.next))return!1;o$v=o$v.prevZ}return!0},o$j.cureLocalIntersections=function(o$o,o$r,o$T){var o$k=o$o;do{var o$W=o$k.prev,o$D=o$k.next.next;!o$j.equals(o$W,o$D)&&o$j.intersects(o$W,o$k,o$k.next,o$D)&&o$j.locallyInside(o$W,o$D)&&o$j.locallyInside(o$D,o$W)&&(o$r.push(o$W.i/o$T),o$r.push(o$k.i/o$T),o$r.push(o$D.i/o$T),o$j.removeNode(o$k),o$j.removeNode(o$k.next),o$k=o$o=o$D),o$k=o$k.next}while(o$k!==o$o);return o$k},o$j.splitEarcut=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=o$o;do{for(var o$V=o$n.next.next;o$V!==o$n.prev;){if(o$n.i!==o$V.i&&o$j.isValidDiagonal(o$n,o$V)){var o$L=o$j.splitPolygon(o$n,o$V);return o$n=o$j.filterPoints(o$n,o$n.next),o$L=o$j.filterPoints(o$L,o$L.next),o$j.earcutLinked(o$n,o$r,o$T,o$k,o$W,o$D),void o$j.earcutLinked(o$L,o$r,o$T,o$k,o$W,o$D)}o$V=o$V.next}o$n=o$n.next}while(o$n!==o$o)},o$j.eliminateHoles=function(o$o,o$r,o$T,o$k){var o$W,o$D,o$n,o$V,o$L,o$U=[];for(o$W=0,o$D=o$r.length;o$W<o$D;o$W++)o$n=o$r[o$W]*o$k,o$V=o$W<o$D-1?o$r[o$W+1]*o$k:o$o.length,(o$L=o$j.linkedList(o$o,o$n,o$V,o$k,!1))===o$L.next&&(o$L.steiner=!0),o$U.push(o$j.getLeftmost(o$L));for(o$U.sort(o$j.compareX),o$W=0;o$W<o$U.length;o$W++)o$j.eliminateHole(o$U[o$W],o$T),o$T=o$j.filterPoints(o$T,o$T.next);return o$T},o$j.compareX=function(o$o,o$r){return o$o.x-o$r.x},o$j.eliminateHole=function(o$o,o$r){if(o$r=o$j.findHoleBridge(o$o,o$r)){var o$T=o$j.splitPolygon(o$r,o$o);o$j.filterPoints(o$T,o$T.next)}},o$j.findHoleBridge=function(o$o,o$r){var o$T,o$k=o$r,o$W=o$o.x,o$D=o$o.y,o$n=-1/0;do{if(o$D<=o$k.y&&o$D>=o$k.next.y&&o$k.next.y!==o$k.y){var o$V=o$k.x+(o$D-o$k.y)*(o$k.next.x-o$k.x)/(o$k.next.y-o$k.y);if(o$V<=o$W&&o$n<o$V){if((o$n=o$V)===o$W){if(o$D===o$k.y)return o$k;if(o$D===o$k.next.y)return o$k.next}o$T=o$k.x<o$k.next.x?o$k:o$k.next}}o$k=o$k.next}while(o$k!==o$r);if(!o$T)return null;if(o$W===o$n)return o$T.prev;var o$L,o$U=o$T,o$h=o$T.x,o$p=o$T.y,o$i=1/0;for(o$k=o$T.next;o$k!==o$U;)o$W>=o$k.x&&o$k.x>=o$h&&o$W!==o$k.x&&o$j.pointInTriangle(o$D<o$p?o$W:o$n,o$D,o$h,o$p,o$D<o$p?o$n:o$W,o$D,o$k.x,o$k.y)&&((o$L=Math.abs(o$D-o$k.y)/(o$W-o$k.x))<o$i||o$L===o$i&&o$k.x>o$T.x)&&o$j.locallyInside(o$k,o$o)&&(o$T=o$k,o$i=o$L),o$k=o$k.next;return o$T},o$j.indexCurve=function(o$o,o$r,o$T,o$k){for(var o$W=o$o;null===o$W.z&&(o$W.z=o$j.zOrder(o$W.x,o$W.y,o$r,o$T,o$k)),o$W.prevZ=o$W.prev,o$W.nextZ=o$W.next,(o$W=o$W.next)!==o$o;);o$W.prevZ.nextZ=null,o$W.prevZ=null,o$j.sortLinked(o$W)},o$j.sortLinked=function(o$o){var o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U=1;do{for(o$T=o$o,o$D=o$o=null,o$n=0;o$T;){for(o$n++,o$k=o$T,o$r=o$V=0;o$r<o$U&&(o$V++,o$k=o$k.nextZ);o$r++);for(o$L=o$U;0<o$V||0<o$L&&o$k;)0!==o$V&&(0===o$L||!o$k||o$T.z<=o$k.z)?(o$T=(o$W=o$T).nextZ,o$V--):(o$k=(o$W=o$k).nextZ,o$L--),o$D?o$D.nextZ=o$W:o$o=o$W,o$W.prevZ=o$D,o$D=o$W;o$T=o$k}o$D.nextZ=null,o$U*=2}while(1<o$n);return o$o},o$j.zOrder=function(o$o,o$r,o$T,o$k,o$W){return(o$o=1431655765&((o$o=858993459&((o$o=252645135&((o$o=16711935&((o$o=32767*(o$o-o$T)*o$W)|o$o<<8))|o$o<<4))|o$o<<2))|o$o<<1))|(o$r=1431655765&((o$r=858993459&((o$r=252645135&((o$r=16711935&((o$r=32767*(o$r-o$k)*o$W)|o$r<<8))|o$r<<4))|o$r<<2))|o$r<<1))<<1},o$j.getLeftmost=function(o$o){for(var o$r=o$o,o$T=o$o;o$r.x<o$T.x&&(o$T=o$r),(o$r=o$r.next)!==o$o;);return o$T},o$j.pointInTriangle=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){return 0<=(o$W-o$n)*(o$r-o$V)-(o$o-o$n)*(o$D-o$V)&&0<=(o$o-o$n)*(o$k-o$V)-(o$T-o$n)*(o$r-o$V)&&0<=(o$T-o$n)*(o$D-o$V)-(o$W-o$n)*(o$k-o$V)},o$j.isValidDiagonal=function(o$o,o$r){return o$o.next.i!==o$r.i&&o$o.prev.i!==o$r.i&&!o$j.intersectsPolygon(o$o,o$r)&&o$j.locallyInside(o$o,o$r)&&o$j.locallyInside(o$r,o$o)&&o$j.middleInside(o$o,o$r)},o$j.area=function(o$o,o$r,o$T){return(o$r.y-o$o.y)*(o$T.x-o$r.x)-(o$r.x-o$o.x)*(o$T.y-o$r.y)},o$j.equals=function(o$o,o$r){return o$o.x===o$r.x&&o$o.y===o$r.y},o$j.intersects=function(o$o,o$r,o$T,o$k){return!!(o$j.equals(o$o,o$r)&&o$j.equals(o$T,o$k)||o$j.equals(o$o,o$k)&&o$j.equals(o$T,o$r))||0<o$j.area(o$o,o$r,o$T)!=0<o$j.area(o$o,o$r,o$k)&&0<o$j.area(o$T,o$k,o$o)!=0<o$j.area(o$T,o$k,o$r)},o$j.intersectsPolygon=function(o$o,o$r){var o$T=o$o;do{if(o$T.i!==o$o.i&&o$T.next.i!==o$o.i&&o$T.i!==o$r.i&&o$T.next.i!==o$r.i&&o$j.intersects(o$T,o$T.next,o$o,o$r))return!0;o$T=o$T.next}while(o$T!==o$o);return!1},o$j.locallyInside=function(o$o,o$r){return o$j.area(o$o.prev,o$o,o$o.next)<0?0<=o$j.area(o$o,o$r,o$o.next)&&0<=o$j.area(o$o,o$o.prev,o$r):o$j.area(o$o,o$r,o$o.prev)<0||o$j.area(o$o,o$o.next,o$r)<0},o$j.middleInside=function(o$o,o$r){for(var o$T=o$o,o$k=!1,o$W=(o$o.x+o$r.x)/2,o$D=(o$o.y+o$r.y)/2;o$T.y>o$D!=o$T.next.y>o$D&&o$T.next.y!==o$T.y&&o$W<(o$T.next.x-o$T.x)*(o$D-o$T.y)/(o$T.next.y-o$T.y)+o$T.x&&(o$k=!o$k),(o$T=o$T.next)!==o$o;);return o$k},o$j.splitPolygon=function(o$o,o$r){var o$T=new o$Wo(o$o.i,o$o.x,o$o.y),o$k=new o$Wo(o$r.i,o$r.x,o$r.y),o$W=o$o.next,o$D=o$r.prev;return(o$o.next=o$r).prev=o$o,(o$T.next=o$W).prev=o$T,(o$k.next=o$T).prev=o$k,(o$D.next=o$k).prev=o$D,o$k},o$j.insertNode=function(o$o,o$r,o$T,o$k){var o$W=new o$Wo(o$o,o$r,o$T);return o$k?(o$W.next=o$k.next,(o$W.prev=o$k).next.prev=o$W,o$k.next=o$W):(o$W.prev=o$W).next=o$W,o$W},o$j.removeNode=function(o$o){o$o.next.prev=o$o.prev,o$o.prev.next=o$o.next,o$o.prevZ&&(o$o.prevZ.nextZ=o$o.nextZ),o$o.nextZ&&(o$o.nextZ.prevZ=o$o.prevZ)},o$j.signedArea=function(o$o,o$r,o$T,o$k){for(var o$W=0,o$D=o$r,o$n=o$T-o$k;o$D<o$T;o$D+=o$k)o$W+=(o$o[o$n]-o$o[o$D])*(o$o[o$D+1]+o$o[o$n+1]),o$n=o$D;return o$W},o$j}(),o$Wo=function(){function o$o(o$o,o$r,o$T){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=o$o,this.x=o$r,this.y=o$T,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return o$i(o$o,"laya.webgl.shapes.EarcutNode"),o$o}(),o$Do=(function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this.lineWidth=o$o,this.lineColor=o$r,this.lineAlpha=o$T,this.fillColor=o$k,this.fillAlpha=o$W,this.shape=o$n,this.fill=o$D}o$i(o$o,"laya.webgl.shapes.GeometryData");var o$r=o$o.prototype;o$r.clone=function(){return new o$o(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},o$r.getIndexData=function(){return null},o$r.getVertexData=function(){return null},o$r.destroy=function(){this.shape=null}}(),function(){function o$o(o$o){if(o$o instanceof Float32Array)this.points=o$o;else if(o$o instanceof Array){o$o.length;this.points=new Float32Array(o$o)}}o$i(o$o,"laya.webgl.shapes.Vertex");var o$r=o$o.prototype;o$q.imps(o$r,{"laya.webgl.shapes.IShape":!0}),o$r.getData=function(o$o,o$r,o$T){},o$r.needUpdate=function(o$o){return!1},o$r.rebuild=function(o$o){},o$r.setMatrix=function(o$o){}}(),function(){function o$L(o$o){void 0===o$o&&(o$o=1e4),this._renderType=o$o}o$i(o$L,"laya.webgl.submit.Submit");var o$o=o$L.prototype;return o$q.imps(o$o,{"laya.webgl.submit.ISubmit":!0}),o$o.releaseRender=function(){var o$o=o$L._cache;(o$o[o$o._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},o$o.getRenderType=function(){return this._renderType},o$o.renderSubmit=function(){if(0===this._numEle)return 1;var o$o=this.shaderValue.textureHost;if(o$o){var o$r=o$o.source;if(!o$o.bitmap||!o$r)return 1;this.shaderValue.texture=o$r,o$o.alphaTexture&&o$o.alphaTexture.source&&(this.shaderValue.texture1=o$o.alphaTexture.source)}this._vb.bind_upload(this._ib);var o$T=o$lo.mainContext;return this.shaderValue.upload(),o$I.activeBlendFunction!==this._blendFn&&(o$T.enable(3042),this._blendFn(o$T),o$I.activeBlendFunction=this._blendFn),o$s.drawCall++,o$s.trianglesFaces+=this._numEle/3,o$T.drawElements(4,this._numEle,5123,this._startIdx),1},o$L.__init__=function(){var o$o=o$L.RENDERBASE=new o$L(-1);o$o.shaderValue=new o$Fo(0,0),o$o.shaderValue.ALPHA=-1234},o$L.createSubmit=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$L._cache._length?o$L._cache[--o$L._cache._length]:new o$L;null==o$T&&((o$T=o$D._selfVb||(o$D._selfVb=o$do.create(-1))).clear(),o$k=0),o$D._ib=o$r,o$D._vb=o$T,o$D._startIdx=o$k*o$jo.BYTES_PIDX,o$D._numEle=0;var o$n=o$o._nBlendType;o$D._blendFn=o$o._targets?o$I.targetFns[o$n]:o$I.fns[o$n],o$D.shaderValue=o$W,o$D.shaderValue.setValue(o$o._shader2D);var o$V=o$o._shader2D.filters;return o$V&&o$D.shaderValue.setFilters(o$V),o$D},o$L.createShape=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=o$L._cache._length?o$L._cache[--o$L._cache._length]:new o$L;o$n._ib=o$r,o$n._vb=o$T,o$n._numEle=o$k,o$n._startIdx=o$W,o$n.shaderValue=o$D,o$n.shaderValue.setValue(o$o._shader2D);var o$V=o$o._nBlendType;return o$n._blendFn=o$o._targets?o$I.targetFns[o$V]:o$I.fns[o$V],o$n},o$L.TYPE_2D=1e4,o$L.TYPE_CANVAS=10003,o$L.TYPE_CMDSETRT=10004,o$L.TYPE_CUSTOM=10005,o$L.TYPE_BLURRT=10006,o$L.TYPE_CMDDESTORYPRERT=10007,o$L.TYPE_DISABLESTENCIL=10008,o$L.TYPE_OTHERIBVB=10009,o$L.TYPE_PRIMITIVE=10010,o$L.TYPE_RT=10011,o$L.TYPE_BLUR_RT=10012,o$L.TYPE_TARGET=10013,o$L.TYPE_CHANGE_VALUE=10014,o$L.TYPE_SHAPE=10015,o$L.TYPE_TEXTURE=10016,o$L.TYPE_FILLTEXTURE=10017,o$L.RENDERBASE=null,o$L._cache=((o$L._cache=[])._length=0,o$L._cache),o$L}()),o$no=function(){function o$k(){this.fun=null,this.args=null}o$i(o$k,"laya.webgl.submit.SubmitCMD");var o$o=o$k.prototype;return o$q.imps(o$o,{"laya.webgl.submit.ISubmit":!0}),o$o.renderSubmit=function(){return this.fun.apply(null,this.args),1},o$o.getRenderType=function(){return 0},o$o.releaseRender=function(){var o$o=o$k._cache;o$o[o$o._length++]=this},o$k.create=function(o$o,o$r){var o$T=o$k._cache._length?o$k._cache[--o$k._cache._length]:new o$k;return o$T.fun=o$r,o$T.args=o$o,o$T},o$k._cache=((o$k._cache=[])._length=0,o$k._cache),o$k}(),o$Vo=function(){function o$r(){this.variables={}}o$i(o$r,"laya.webgl.submit.SubmitCMDScope");var o$o=o$r.prototype;return o$o.getValue=function(o$o){return this.variables[o$o]},o$o.addValue=function(o$o,o$r){return this.variables[o$o]=o$r},o$o.setValue=function(o$o,o$r){return this.variables.hasOwnProperty(o$o)?this.variables[o$o]=o$r:null},o$o.clear=function(){for(var o$o in this.variables)delete this.variables[o$o]},o$o.recycle=function(){this.clear(),o$r.POOL.push(this)},o$r.create=function(){var o$o=o$r.POOL.pop();return o$o||(o$o=new o$r),o$o},o$r.POOL=[],o$r}(),o$Lo=function(){function o$p(){this.offset=0,this.startIndex=0,this._mat=o$P.create()}o$i(o$p,"laya.webgl.submit.SubmitOtherIBVB");var o$o=o$p.prototype;return o$q.imps(o$o,{"laya.webgl.submit.ISubmit":!0}),o$o.releaseRender=function(){var o$o=o$p._cache;(o$o[o$o._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},o$o.getRenderType=function(){return 10009},o$o.renderSubmit=function(){var o$o=this._shaderValue.textureHost;if(o$o){var o$r=o$o.source;if(!o$o.bitmap||!o$r)return 1;this._shaderValue.texture=o$r}this._vb.bind_upload(this._ib);var o$T=o$$o.worldMatrix4,o$k=o$P.TEMP;o$P.mulPre(this._mat,o$T[0],o$T[1],o$T[4],o$T[5],o$T[12],o$T[13],o$k);var o$W=o$$o.worldMatrix4=o$p.tempMatrix4;o$W[0]=o$k.a,o$W[1]=o$k.b,o$W[4]=o$k.c,o$W[5]=o$k.d,o$W[12]=o$k.tx,o$W[13]=o$k.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var o$D=o$lo.mainContext;return o$I.activeBlendFunction!==this._blendFn&&(o$D.enable(3042),this._blendFn(o$D),o$I.activeBlendFunction=this._blendFn),o$s.drawCall++,o$s.trianglesFaces+=this._numEle/3,o$D.drawElements(4,this._numEle,5123,this.startIndex),o$$o.worldMatrix4=o$T,o$Oo.activeShader=null,1},o$p.create=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){void 0===o$L&&(o$L=0);var o$U=o$p._cache._length?o$p._cache[--o$p._cache._length]:new o$p;o$U._ib=o$T,o$U._vb=o$r,o$U._numEle=o$k,o$U._shader=o$W,o$U._shaderValue=o$D;var o$h=o$o._nBlendType;switch(o$U._blendFn=o$o._targets?o$I.targetFns[o$h]:o$I.fns[o$h],o$L){case 0:o$U.offset=0,o$U.startIndex=o$V/(o$jo.BYTES_PE*o$r.vertexStride)*1.5,o$U.startIndex*=o$jo.BYTES_PIDX;break;case 1:o$U.startIndex=o$n,o$U.offset=o$V}return o$U},o$p._cache=((o$p._cache=[])._length=0,o$p._cache),o$p.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o$p}(),o$Uo=function(){function o$T(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new o$H,this.screenRect=new o$H}o$i(o$T,"laya.webgl.submit.SubmitScissor");var o$o=o$T.prototype;return o$q.imps(o$o,{"laya.webgl.submit.ISubmit":!0}),o$o._scissor=function(o$o,o$r,o$T,o$k){var o$W=o$$o.worldMatrix4,o$D=o$W[0],o$n=o$W[5],o$V=o$W[12],o$L=o$W[13];if(o$k*=o$n,(o$T*=o$D)<1||o$k<1)return!1;var o$U=(o$o=o$o*o$D+o$V)+o$T,o$h=(o$r=o$r*o$n+o$L)+o$k;o$o<0&&(o$T=o$U-(o$o=0)),o$r<0&&(o$k=o$h-(o$r=0));var o$p=o$$o.worldClipRect;if(o$o=Math.max(o$o,o$p.x),o$r=Math.max(o$r,o$p.y),o$T=Math.min(o$U,o$p.right)-o$o,o$k=Math.min(o$h,o$p.bottom)-o$r,o$T<1||o$k<1)return!1;var o$i=o$$o.worldScissorTest;return this.screenRect.copyFrom(o$p),o$p.x=o$o,o$p.y=o$r,o$p.width=o$T,o$p.height=o$k,o$$o.worldScissorTest=!0,o$r=o$$o.height-o$r-o$k,o$lo.mainContext.scissor(o$o,o$r,o$T,o$k),o$lo.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),o$i?(o$r=o$$o.height-this.screenRect.y-this.screenRect.height,o$lo.mainContext.scissor(this.screenRect.x,o$r,this.screenRect.width,this.screenRect.height),o$lo.mainContext.enable(3089)):(o$lo.mainContext.disable(3089),o$$o.worldScissorTest=!1),o$p.copyFrom(this.screenRect),!0},o$o._scissorWithTagart=function(o$o,o$r,o$T,o$k){if(o$T<1||o$k<1)return!1;var o$W=o$o+o$T,o$D=o$r+o$k;o$o<0&&(o$T=o$W-(o$o=0)),o$r<0&&(o$k=o$D-(o$r=0));var o$n=o$$o.worldClipRect;if(o$o=Math.max(o$o,o$n.x),o$r=Math.max(o$r,o$n.y),o$T=Math.min(o$W,o$n.right)-o$o,o$k=Math.min(o$D,o$n.bottom)-o$r,o$T<1||o$k<1)return!1;var o$V=o$$o.worldScissorTest;return this.screenRect.copyFrom(o$n),o$$o.worldScissorTest=!0,o$n.x=o$o,o$n.y=o$r,o$n.width=o$T,o$n.height=o$k,o$r=o$$o.height-o$r-o$k,o$lo.mainContext.scissor(o$o,o$r,o$T,o$k),o$lo.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),o$V?(o$r=o$$o.height-this.screenRect.y-this.screenRect.height,o$lo.mainContext.scissor(this.screenRect.x,o$r,this.screenRect.width,this.screenRect.height),o$lo.mainContext.enable(3089)):(o$lo.mainContext.disable(3089),o$$o.worldScissorTest=!1),o$n.copyFrom(this.screenRect),!0},o$o.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},o$o.getRenderType=function(){return 0},o$o.releaseRender=function(){var o$o=o$T._cache;(o$o[o$o._length++]=this).context=null},o$T.create=function(o$o){var o$r=o$T._cache._length?o$T._cache[--o$T._cache._length]:new o$T;return o$r.context=o$o,o$r},o$T._cache=((o$T._cache=[])._length=0,o$T._cache),o$T}(),o$ho=function(){function o$L(){this.step=0,this.blendMode=null,this.level=0}o$i(o$L,"laya.webgl.submit.SubmitStencil");var o$o=o$L.prototype;return o$q.imps(o$o,{"laya.webgl.submit.ISubmit":!0}),o$o.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},o$o.getRenderType=function(){return 0},o$o.releaseRender=function(){var o$o=o$L._cache;o$o[o$o._length++]=this},o$o.do1=function(){var o$o=o$lo.mainContext;o$o.enable(2960),o$o.clear(1024),o$o.colorMask(!1,!1,!1,!1),o$o.stencilFunc(514,this.level,255),o$o.stencilOp(7680,7680,7682)},o$o.do2=function(){var o$o=o$lo.mainContext;o$o.stencilFunc(514,this.level+1,255),o$o.colorMask(!0,!0,!0,!0),o$o.stencilOp(7680,7680,7680)},o$o.do3=function(){var o$o=o$lo.mainContext;o$o.colorMask(!0,!0,!0,!0),o$o.stencilOp(7680,7680,7680),o$o.clear(1024),o$o.disable(2960)},o$o.do4=function(){var o$o=o$lo.mainContext;0==this.level&&(o$o.enable(2960),o$o.clear(1024)),o$o.colorMask(!1,!1,!1,!1),o$o.stencilFunc(519,0,255),o$o.stencilOp(7680,7680,7682)},o$o.do5=function(){var o$o=o$lo.mainContext;o$o.stencilFunc(514,this.level,255),o$o.colorMask(!0,!0,!0,!0),o$o.stencilOp(7680,7680,7680)},o$o.do6=function(){var o$o=o$lo.mainContext;o$I.targetFns[o$I.TOINT[this.blendMode]](o$o)},o$o.do7=function(){var o$o=o$lo.mainContext;o$o.colorMask(!1,!1,!1,!1),o$o.stencilOp(7680,7680,7683)},o$o.do8=function(){var o$o=o$lo.mainContext;o$o.colorMask(!0,!0,!0,!0),o$o.stencilFunc(514,this.level,255),o$o.stencilOp(7680,7680,7680)},o$L.restore=function(o$o,o$r,o$T,o$k,o$W){var o$D;if((o$o._renderKey=0)<o$L._mask&&o$L._mask--,0==o$L._mask)o$D=laya.webgl.submit.SubmitStencil.create(3),o$o.addRenderObject(o$D),o$o._curSubmit=o$Do.RENDERBASE;else{o$D=laya.webgl.submit.SubmitStencil.create(7),o$o.addRenderObject(o$D);var o$n=o$o._vb;o$n._byteLength;if(o$_o.fillRectImgVb(o$n,null,o$r.x,o$r.y,o$r.width,o$r.height,o$X.DEF_UV,o$T,o$k,o$W,0,0)){o$o._shader2D.glTexture=null;var o$V=o$o._curSubmit=o$Do.createSubmit(o$o,o$o._ib,o$n,(o$n._byteLength-64)/32*3,o$Fo.create(2,0));o$V.shaderValue.ALPHA=1,o$o._submits[o$o._submits._length++]=o$V,o$o._curSubmit._numEle+=6,o$o._curSubmit=o$Do.RENDERBASE}else alert("clipRect calc stencil rect error");o$D=laya.webgl.submit.SubmitStencil.create(8),o$o.addRenderObject(o$D)}},o$L.restore2=function(o$o,o$r){var o$T;(o$o._renderKey=0)<o$L._mask&&o$L._mask--,0==o$L._mask?(o$T=laya.webgl.submit.SubmitStencil.create(3),o$o.addRenderObject(o$T),o$o._curSubmit=o$Do.RENDERBASE):(o$T=laya.webgl.submit.SubmitStencil.create(7),o$o.addRenderObject(o$T),o$o._submits[o$o._submits._length++]=o$r,o$T=laya.webgl.submit.SubmitStencil.create(8),o$o.addRenderObject(o$T))},o$L.create=function(o$o){var o$r=o$L._cache._length?o$L._cache[--o$L._cache._length]:new o$L;return 5==(o$r.step=o$o)&&++o$L._mask,o$r.level=o$L._mask,o$r},o$L._cache=((o$L._cache=[])._length=0,o$L._cache),o$L._mask=0,o$L}(),o$po=function(){function o$V(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}o$i(o$V,"laya.webgl.submit.SubmitTarget");var o$o=o$V.prototype;return o$q.imps(o$o,{"laya.webgl.submit.ISubmit":!0}),o$o.renderSubmit=function(){this._vb.bind_upload(this._ib);var o$o=this.scope.getValue(this.proName);return o$o&&(this.shaderValue.texture=o$o.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[o$o.width,o$o.height]),this.shaderValue.upload(),this.blend(),o$s.drawCall++,o$s.trianglesFaces+=this._numEle/3,o$lo.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},o$o.blend=function(){if(o$I.activeBlendFunction!==o$I.fns[this.blendType]){var o$o=o$lo.mainContext;o$o.enable(3042),o$I.fns[this.blendType](o$o),o$I.activeBlendFunction=o$I.fns[this.blendType]}},o$o.getRenderType=function(){return 0},o$o.releaseRender=function(){var o$o=o$V._cache;(o$o[o$o._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},o$V.create=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=o$V._cache._length?o$V._cache[--o$V._cache._length]:new o$V;return o$n._ib=o$r,o$n._vb=o$T,o$n.proName=o$D,o$n._startIdx=o$k*o$jo.BYTES_PIDX,o$n._numEle=0,o$n.blendType=o$o._nBlendType,o$n.shaderValue=o$W,o$n.shaderValue.setValue(o$o._shader2D),o$n},o$V._cache=((o$V._cache=[])._length=0,o$V._cache),o$V}(),o$io=function(){function o$o(){this._sourceStr=null}o$i(o$o,"laya.webgl.text.CharSegment");var o$r=o$o.prototype;return o$q.imps(o$r,{"laya.webgl.text.ICharSegment":!0}),o$r.textToSpit=function(o$o){this._sourceStr=o$o},o$r.getChar=function(o$o){return this._sourceStr.charAt(o$o)},o$r.getCharCode=function(o$o){return this._sourceStr.charCodeAt(o$o)},o$r.length=function(){return this._sourceStr.length},o$o}(),o$vo=function(){var o$o;function o$s(){}return o$i(o$s,"laya.webgl.text.DrawText"),o$s.__init__=function(){o$s._charsTemp=new Array,o$s._drawValue=new o$o,o$s._charSeg=new o$io},o$s.customCharSeg=function(o$o){o$s._charSeg=o$o},o$s.getChar=function(o$o,o$r,o$T){var o$k=o$ao.createOneChar(o$o,o$T);return-1!=o$r&&(o$s._charsCache[o$r]=o$k),o$k},o$s._drawSlow=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h,o$p,o$i,o$v,o$x){var o$j,o$_,o$K=o$s._drawValue.value(o$D,o$V,o$L,o$U,o$i,o$v,o$x),o$$=0,o$y=0,o$l=o$s._charsTemp,o$S=0,o$q=NaN;if(o$k)for(o$l.length=o$k.length,o$$=0,o$y=o$k.length;o$$<o$y;o$$++)(o$_=o$k[o$$])&&(o$q=o$_.charNum+o$K.txtID,o$l[o$$]=o$j=o$s._charsCache[o$q]||o$s.getChar(o$_.char,o$q,o$K),o$j.active());else{var o$b=o$T instanceof laya.utils.WordText?o$T.toString():o$T;if(o$C.CharacterCache){o$s._charSeg.textToSpit(o$b);var o$F=o$s._charSeg.length();for(o$$=0,o$y=o$l.length=o$F;o$$<o$y;o$$++)o$q=o$s._charSeg.getCharCode(o$$)+o$K.txtID,o$l[o$$]=o$j=o$s._charsCache[o$q]||o$s.getChar(o$s._charSeg.getChar(o$$),o$q,o$K),o$j.active(),o$S+=o$j.cw}else o$l.length=0,(o$j=o$s.getChar(o$b,-1,o$K)).active(),o$S+=o$j.cw,o$l[0]=o$j}var o$P=0;null!==o$n&&"left"!==o$n&&(o$P=-("center"==o$n?o$S/2:o$S));var o$t,o$H,o$R=NaN,o$u=0;if(o$k)for(o$$=0,o$y=o$l.length;o$$<o$y;o$$++)o$j=o$l[o$$],o$_=o$k[o$$],o$j&&o$_&&!o$j.isSpace&&(o$R=o$j.borderSize,o$t=o$j.texture,o$r._drawText(o$t,o$h+o$P+o$_.x*o$i-o$R,o$p+o$_.y*o$v-o$R,o$t.width,o$t.height,o$W,0,0,0,0));else{for(o$$=0,o$y=o$l.length;o$$<o$y;o$$++)(o$j=o$l[o$$])&&!o$j.isSpace&&(o$R=o$j.borderSize,o$t=o$j.texture,o$r._drawText(o$t,o$h+o$P-o$R,o$p-o$R,o$t.width,o$t.height,o$W,0,0,0,0),o$o&&((o$H=o$o[o$u++])||(o$H=o$o[o$u-1]=[]),o$H[0]=o$t,o$H[1]=o$P-o$R,o$H[2]=-o$R)),o$P+=o$j.cw;o$o&&(o$o.length=o$u)}},o$s._drawFast=function(o$o,o$r,o$T,o$k,o$W){for(var o$D,o$n,o$V=0,o$L=o$o.length;o$V<o$L;o$V++)(o$D=(o$n=o$o[o$V])[0]).active(),o$r._drawText(o$D,o$k+o$n[1],o$W+o$n[2],o$D.width,o$D.height,o$T,0,0,0,0)},o$s.drawText=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h,o$p){if(void 0===o$p&&(o$p=0),!(o$r&&0===o$r.length||o$T&&0===o$T.length)){var o$i=o$k.a,o$v=o$k.d;(0!==o$k.b||0!==o$k.c)&&(o$i=o$v=1);var o$x=1!==o$i||1!==o$v;if(o$x&&o$q.stage.transform){var o$j=o$q.stage.transform;o$x=o$j.a===o$i&&o$j.d===o$v}else o$x=!1;if(o$x){var o$_=(o$k=o$k.copyTo(o$bo._tmpMatrix)).tx,o$K=o$k.ty;o$k.scale(1/o$i,1/o$v),o$k._checkTransform(),o$U*=o$i,o$h*=o$v,o$U+=o$_-o$k.tx,o$h+=o$K-o$k.ty}else o$i=o$v=1;if(o$T)o$s._drawSlow(null,o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h,o$i,o$v,o$p);else{if(null===o$r.toUpperCase){var o$$=o$i+1e5*o$v,o$y=o$r;return void(o$y.changed||o$y.id!==o$$?(o$y.id=o$$,o$y.changed=!1,o$s._drawSlow(o$y.save,o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h,o$i,o$v,o$p)):o$s._drawFast(o$y.save,o$o,o$k,o$U,o$h))}var o$l=o$r+o$W.toString()+o$n+o$V+o$L+o$i+o$v+o$D,o$S=o$s._textsCache[o$l];o$C.CharacterCache?o$S?o$s._drawFast(o$S,o$o,o$k,o$U,o$h):(o$s._textsCache.__length||(o$s._textsCache.__length=0),o$s._textsCache.__length>o$b.WebGLTextCacheCount&&((o$s._textsCache={}).__length=0,o$s._curPoolIndex=0),o$s._textCachesPool[o$s._curPoolIndex]?(o$S=o$s._textsCache[o$l]=o$s._textCachesPool[o$s._curPoolIndex]).length=0:o$s._textCachesPool[o$s._curPoolIndex]=o$S=o$s._textsCache[o$l]=[],o$s._textsCache.__length++,o$s._curPoolIndex++,o$s._drawSlow(o$S,o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h,o$i,o$v,o$p)):o$s._drawSlow(o$S,o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h,o$i,o$v,o$p)}}},o$s._charsTemp=null,o$s._textCachesPool=[],o$s._curPoolIndex=0,o$s._charsCache={},o$s._textsCache={},o$s._drawValue=null,o$s.d=[],o$s._charSeg=null,o$s.__init$=function(){o$o=function(){function o$L(){}return o$i(o$L,""),o$L.prototype.value=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this.font=o$o,this.fillColor=o$r,this.borderColor=o$T,this.lineWidth=o$k,this.scaleX=o$W,this.scaleY=o$D,this.underLine=o$n;var o$V=o$o.toString()+o$W+o$D+o$k+(o$r?o$r.toLowerCase():" ")+(o$T?o$T.toLowerCase():" ")+o$n;return this.txtID=o$L._keymap[o$V],this.txtID||(this.txtID=1e-7*++o$L._keymapCount,o$L._keymap[o$V]=this.txtID),this},o$L.clear=function(){o$L._keymap={},o$L._keymapCount=1},o$L._keymap={},o$L._keymapCount=1,o$L}()},o$s}(),o$xo=function(){function o$W(o$o){this._index=0,this._size=14,this._italic=-2,o$W._cache2=o$W._cache2||[],this.setFont(o$o||"14px Arial")}o$i(o$W,"laya.webgl.text.FontInContext");var o$o=o$W.prototype;return o$o.setFont=function(o$o){var o$r=o$W._cache2[o$o];if(o$r)this._words=o$r[0],this._size=o$r[1];else{this._words=o$o.split(" ");for(var o$T=0,o$k=this._words.length;o$T<o$k;o$T++)if(0<this._words[o$T].indexOf("px")){this._index=o$T;break}this._size=parseInt(this._words[this._index]),o$W._cache2[o$o]=[this._words,this._size]}this._text=null,this._italic=-2},o$o.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},o$o.hasType=function(o$o){for(var o$r=0,o$T=this._words.length;o$r<o$T;o$r++)if(this._words[o$r]===o$o)return o$r;return-1},o$o.removeType=function(o$o){for(var o$r=0,o$T=this._words.length;o$r<o$T;o$r++)if(this._words[o$r]===o$o){this._words.splice(o$r,1),this._index>o$r&&this._index--;break}this._text=null,this._italic=-2},o$o.copyTo=function(o$o){return o$o._text=this._text,o$o._size=this._size,o$o._index=this._index,o$o._words=this._words.slice(),o$o._italic=-2,o$o},o$o.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},o$k(0,o$o,"size",function(){return this._size},function(o$o){this._size=o$o,this._words[this._index]=o$o+"px",this._text=null}),o$W.create=function(o$o){var o$r=o$W._cache[o$o];return o$r||(o$r=o$W._cache[o$o]=new o$W(o$o))},o$W.EMPTY=new o$W,o$W._cache={},o$W._cache2=null,o$W}(),o$jo=function(){function o$o(){}return o$i(o$o,"laya.webgl.utils.CONST3D2D"),o$o.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o$o.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],o$o.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],o$o._TMPARRAY=[],o$o._OFFSETX=0,o$o._OFFSETY=0,o$n(o$o,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),o$o}(),o$_o=function(){function o$x(){}return o$i(o$x,"laya.webgl.utils.GlUtils"),o$x.make2DProjection=function(o$o,o$r,o$T){return[2/o$o,0,0,0,0,-2/o$r,0,0,0,0,2/o$T,0,-1,1,0,1]},o$x.fillIBQuadrangle=function(o$o,o$r){if(65535/4<o$r)throw Error("IBQuadrangle count:"+o$r+" must<:"+Math.floor(65535/4));o$r=Math.floor(o$r),o$o._resizeBuffer(6*(o$r+1)*2,!1),o$o.byteLength=o$o.bufferLength;for(var o$T=o$o.getUint16Array(),o$k=0,o$W=0;o$W<o$r;o$W++)o$T[o$k++]=4*o$W,o$T[o$k++]=4*o$W+2,o$T[o$k++]=4*o$W+1,o$T[o$k++]=4*o$W,o$T[o$k++]=4*o$W+3,o$T[o$k++]=4*o$W+2;return o$o.setNeedUpload(),!0},o$x.expandIBQuadrangle=function(o$o,o$r){o$o.bufferLength>=6*o$r*2||o$x.fillIBQuadrangle(o$o,o$r)},o$x.mathCeilPowerOfTwo=function(o$o){return o$o--,o$o|=o$o>>1,o$o|=o$o>>2,o$o|=o$o>>4,o$o|=o$o>>8,o$o|=o$o>>16,++o$o},o$x.fillQuadrangleImgVb=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){var o$L=16+(o$o._byteLength>>2);o$o.byteLength=o$L<<2;var o$U=o$o.getFloat32Array();o$U[(o$L-=16)+2]=o$W[0],o$U[o$L+3]=o$W[1],o$U[o$L+6]=o$W[2],o$U[o$L+7]=o$W[3],o$U[o$L+10]=o$W[4],o$U[o$L+11]=o$W[5],o$U[o$L+14]=o$W[6],o$U[o$L+15]=o$W[7];var o$h=o$D.a,o$p=o$D.b,o$i=o$D.c,o$v=o$D.d;if(1!==o$h||0!==o$p||0!==o$i||1!==o$v){o$D.bTransform=!0;var o$x=o$D.tx+o$n,o$j=o$D.ty+o$V;o$U[o$L]=(o$k[0]+o$r)*o$h+(o$k[1]+o$T)*o$i+o$x,o$U[o$L+1]=(o$k[0]+o$r)*o$p+(o$k[1]+o$T)*o$v+o$j,o$U[o$L+4]=(o$k[2]+o$r)*o$h+(o$k[3]+o$T)*o$i+o$x,o$U[o$L+5]=(o$k[2]+o$r)*o$p+(o$k[3]+o$T)*o$v+o$j,o$U[o$L+8]=(o$k[4]+o$r)*o$h+(o$k[5]+o$T)*o$i+o$x,o$U[o$L+9]=(o$k[4]+o$r)*o$p+(o$k[5]+o$T)*o$v+o$j,o$U[o$L+12]=(o$k[6]+o$r)*o$h+(o$k[7]+o$T)*o$i+o$x,o$U[o$L+13]=(o$k[6]+o$r)*o$p+(o$k[7]+o$T)*o$v+o$j}else o$D.bTransform=!1,o$r+=o$D.tx+o$n,o$T+=o$D.ty+o$V,o$U[o$L]=o$r+o$k[0],o$U[o$L+1]=o$T+o$k[1],o$U[o$L+4]=o$r+o$k[2],o$U[o$L+5]=o$T+o$k[3],o$U[o$L+8]=o$r+o$k[4],o$U[o$L+9]=o$T+o$k[5],o$U[o$L+12]=o$r+o$k[6],o$U[o$L+13]=o$T+o$k[7];return o$o._upload=!0},o$x.fillTranglesVB=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){var o$V=(o$o._byteLength>>2)+o$k.length;o$o.byteLength=o$V<<2;var o$L=o$o.getFloat32Array();o$V-=o$k.length;for(var o$U=o$k.length,o$h=o$W.a,o$p=o$W.b,o$i=o$W.c,o$v=o$W.d,o$x=0;o$x<o$U;o$x+=4)if(o$L[o$V+o$x+2]=o$k[o$x+2],o$L[o$V+o$x+3]=o$k[o$x+3],1!==o$h||0!==o$p||0!==o$i||1!==o$v){o$W.bTransform=!0;var o$j=o$W.tx+o$D,o$_=o$W.ty+o$n;o$L[o$V+o$x]=(o$k[o$x]+o$r)*o$h+(o$k[o$x+1]+o$T)*o$i+o$j,o$L[o$V+o$x+1]=(o$k[o$x]+o$r)*o$p+(o$k[o$x+1]+o$T)*o$v+o$_}else o$W.bTransform=!1,o$r+=o$W.tx+o$D,o$T+=o$W.ty+o$n,o$L[o$V+o$x]=o$r+o$k[o$x],o$L[o$V+o$x+1]=o$T+o$k[o$x+1];return o$o._upload=!0},o$x.copyPreImgVb=function(o$o,o$r,o$T){var o$k=o$o._byteLength>>2;o$o.byteLength=o$k+16<<2;for(var o$W=o$o.getFloat32Array(),o$D=0,o$n=o$k-16;o$D<4;o$D++)o$W[o$k]=o$W[o$n]+o$r,++o$n,o$W[++o$k]=o$W[o$n]+o$T,++o$n,o$W[++o$k]=o$W[o$n],++o$n,o$W[++o$k]=o$W[o$n],++o$k,++o$n;o$o._upload=!0},o$x.fillRectImgVb=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h,o$p,o$i){void 0===o$i&&(o$i=!1);var o$v,o$x,o$j,o$_,o$K,o$$,o$y,o$l,o$S,o$q,o$b,o$F,o$P,o$t,o$H,o$R,o$u=1,o$s=o$V.a,o$z=o$V.b,o$m=o$V.c,o$C=o$V.d,o$X=o$r&&o$r.width<99999999;if(1!==o$s||0!==o$z||0!==o$m||1!==o$C?(o$V.bTransform=!0,0===o$z&&0===o$m&&(o$u=23,o$S=o$W+o$T,o$q=o$D+o$k,o$v=o$s*o$T+(o$b=o$V.tx+o$L),o$j=o$s*o$S+o$b,o$x=o$C*o$k+(o$F=o$V.ty+o$U),o$_=o$C*o$q+o$F)):(o$u=23,o$V.bTransform=!1,o$j=(o$v=o$T+o$V.tx+o$L)+o$W,o$_=(o$x=o$k+o$V.ty+o$U)+o$D),o$X&&(o$K=o$r.x,o$$=o$r.y,o$y=o$r.width+o$K,o$l=o$r.height+o$$),1!==o$u){if(Math.min(o$v,o$j)>=o$y)return!1;if(Math.min(o$x,o$_)>=o$l)return!1;if(Math.max(o$j,o$v)<=o$K)return!1;if(Math.max(o$_,o$x)<=o$$)return!1}var o$O=o$o._byteLength>>2;o$o.byteLength=16+o$O<<2;var o$M=o$o.getFloat32Array();switch(o$M[2+o$O]=o$n[0],o$M[3+o$O]=o$n[1],o$M[6+o$O]=o$n[2],o$M[7+o$O]=o$n[3],o$M[10+o$O]=o$n[4],o$M[11+o$O]=o$n[5],o$M[14+o$O]=o$n[6],o$M[15+o$O]=o$n[7],o$u){case 1:o$b=o$V.tx+o$L,o$F=o$V.ty+o$U;var o$c=o$s*o$T,o$e=o$m*o$k,o$J=o$C*o$k,o$Y=o$z*o$T,o$A=o$s*(o$S=o$W+o$T),o$I=o$m*(o$q=o$D+o$k),o$N=o$C*o$q,o$f=o$z*o$S;o$i?(o$P=o$c+o$e+o$b,o$H=Math.round(o$P)-o$P,o$t=o$J+o$Y+o$F,o$R=Math.round(o$t)-o$t,o$M[o$O]=o$P+o$H,o$M[1+o$O]=o$t+o$R,o$M[4+o$O]=o$A+o$e+o$b+o$H,o$M[5+o$O]=o$J+o$f+o$F+o$R,o$M[8+o$O]=o$A+o$I+o$b+o$H,o$M[9+o$O]=o$N+o$f+o$F+o$R,o$M[12+o$O]=o$c+o$I+o$b+o$H,o$M[13+o$O]=o$N+o$Y+o$F+o$R):(o$M[o$O]=o$c+o$e+o$b,o$M[1+o$O]=o$J+o$Y+o$F,o$M[4+o$O]=o$A+o$e+o$b,o$M[5+o$O]=o$J+o$f+o$F,o$M[8+o$O]=o$A+o$I+o$b,o$M[9+o$O]=o$N+o$f+o$F,o$M[12+o$O]=o$c+o$I+o$b,o$M[13+o$O]=o$N+o$Y+o$F);break;case 23:o$i?(o$P=o$v+o$h,o$H=Math.round(o$P)-o$P,o$t=o$x,o$R=Math.round(o$t)-o$t,o$M[o$O]=o$P+o$H,o$M[1+o$O]=o$t+o$R,o$M[4+o$O]=o$j+o$h+o$H,o$M[5+o$O]=o$x+o$R,o$M[8+o$O]=o$j+o$H,o$M[9+o$O]=o$_+o$R,o$M[12+o$O]=o$v+o$H,o$M[13+o$O]=o$_+o$R):(o$M[o$O]=o$v+o$h,o$M[1+o$O]=o$x,o$M[4+o$O]=o$j+o$h,o$M[5+o$O]=o$x,o$M[8+o$O]=o$j,o$M[9+o$O]=o$_,o$M[12+o$O]=o$v,o$M[13+o$O]=o$_)}return o$o._upload=!0},o$x.fillLineVb=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){var o$L=.5*o$n,o$U=o$x._fillLineArray,o$h=-(o$k-o$D),o$p=o$T-o$W,o$i=Math.sqrt(o$h*o$h+o$p*o$p);o$h/=o$i,o$p/=o$i,o$h*=o$L,o$p*=o$L,o$U[0]=o$T-o$h,o$U[1]=o$k-o$p,o$U[4]=o$T+o$h,o$U[5]=o$k+o$p,o$U[8]=o$W+o$h,o$U[9]=o$D+o$p,o$U[12]=o$W-o$h,o$U[13]=o$D-o$p,o$V&&o$V.transformPointArray(o$U,o$U);var o$v=16+(o$o._byteLength>>2);return o$o.byteLength=o$v<<2,o$o.insertData(o$U,o$v-16),!0},o$x._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],o$x}(),o$Ko=(function(){function o$L(){}o$i(o$L,"laya.webgl.utils.MatirxArray"),o$L.ArrayMul=function(o$o,o$r,o$T){if(o$o)if(o$r)for(var o$k=NaN,o$W=NaN,o$D=NaN,o$n=NaN,o$V=0;o$V<4;o$V++)o$k=o$o[o$V],o$W=o$o[o$V+4],o$D=o$o[o$V+8],o$n=o$o[o$V+12],o$T[o$V]=o$k*o$r[0]+o$W*o$r[1]+o$D*o$r[2]+o$n*o$r[3],o$T[o$V+4]=o$k*o$r[4]+o$W*o$r[5]+o$D*o$r[6]+o$n*o$r[7],o$T[o$V+8]=o$k*o$r[8]+o$W*o$r[9]+o$D*o$r[10]+o$n*o$r[11],o$T[o$V+12]=o$k*o$r[12]+o$W*o$r[13]+o$D*o$r[14]+o$n*o$r[15];else o$L.copyArray(o$o,o$T);else o$L.copyArray(o$r,o$T)},o$L.copyArray=function(o$o,o$r){if(o$o&&o$r)for(var o$T=0;o$T<o$o.length;o$T++)o$r[o$T]=o$o[o$T]}}(),function(){function o$r(o$o,o$r,o$T){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=o$o,this._vb=new o$do(o$o,35048),o$r&&this._vb._resizeBuffer(o$r,!1),this._ib=new o$Eo,o$T&&this._ib._resizeBuffer(o$T,!1)}o$i(o$r,"laya.webgl.utils.Mesh2D");var o$o=o$r.prototype;return o$o.cloneWithNewVB=function(){var o$o=new o$r(this._stride,0,0);return o$o._ib=this._ib,o$o._quadNum=this._quadNum,o$o._attribInfo=this._attribInfo,o$o},o$o.cloneWithNewVBIB=function(){var o$o=new o$r(this._stride,0,0);return o$o._attribInfo=this._attribInfo,o$o},o$o.getVBW=function(){return this._vb.setNeedUpload(),this._vb},o$o.getVBR=function(){return this._vb},o$o.getIBR=function(){return this._ib},o$o.getIBW=function(){return this._ib.setNeedUpload(),this._ib},o$o.createQuadIB=function(o$o){this._quadNum=o$o,this._ib._resizeBuffer(6*o$o*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var o$r=this._ib.getUint16Array(),o$T=0,o$k=0,o$W=0;o$W<o$o;o$W++)o$r[o$T++]=o$k,o$r[o$T++]=o$k+2,o$r[o$T++]=o$k+1,o$r[o$T++]=o$k,o$r[o$T++]=o$k+3,o$r[o$T++]=o$k+2,o$k+=4;this._ib.setNeedUpload()},o$o.setAttributes=function(o$o){if(this._attribInfo=o$o,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},o$o.getEleNum=function(){return this._ib.getBuffer().byteLength/2},o$o.releaseMesh=function(){},o$o.destroy=function(){},o$o.clearVB=function(){this._vb.clear()},o$r._gvaoid=0,o$r}()),o$$o=function(){function o$W(){}return o$i(o$W,"laya.webgl.utils.RenderState2D"),o$W.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},o$W.mat2MatArray=function(o$o,o$r){var o$T=o$o,o$k=o$r;return o$k[0]=o$T.a,o$k[1]=o$T.b,o$k[2]=o$W.EMPTYMAT4_ARRAY[2],o$k[3]=o$W.EMPTYMAT4_ARRAY[3],o$k[4]=o$T.c,o$k[5]=o$T.d,o$k[6]=o$W.EMPTYMAT4_ARRAY[6],o$k[7]=o$W.EMPTYMAT4_ARRAY[7],o$k[8]=o$W.EMPTYMAT4_ARRAY[8],o$k[9]=o$W.EMPTYMAT4_ARRAY[9],o$k[10]=o$W.EMPTYMAT4_ARRAY[10],o$k[11]=o$W.EMPTYMAT4_ARRAY[11],o$k[12]=o$T.tx,o$k[13]=o$T.ty,o$k[14]=o$W.EMPTYMAT4_ARRAY[14],o$k[15]=o$W.EMPTYMAT4_ARRAY[15],o$r},o$W.restoreTempArray=function(){o$W.TEMPMAT4_ARRAY[0]=1,o$W.TEMPMAT4_ARRAY[1]=0,o$W.TEMPMAT4_ARRAY[4]=0,o$W.TEMPMAT4_ARRAY[5]=1,o$W.TEMPMAT4_ARRAY[12]=0,o$W.TEMPMAT4_ARRAY[13]=0},o$W.clear=function(){o$W.worldScissorTest=!1,o$W.worldShaderDefines=null,o$W.worldFilters=null,o$W.worldAlpha=1,o$W.worldClipRect.x=o$W.worldClipRect.y=0,o$W.worldClipRect.width=o$W.width,o$W.worldClipRect.height=o$W.height,o$W.curRenderTarget=null},o$W._MAXSIZE=99999999,o$W.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o$W.worldMatrix4=o$W.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o$W.worldAlpha=1,o$W.worldScissorTest=!1,o$W.worldFilters=null,o$W.worldShaderDefines=null,o$W.curRenderTarget=null,o$W.width=0,o$W.height=0,o$n(o$W,["worldMatrix",function(){return this.worldMatrix=new o$P},"worldClipRect",function(){return this.worldClipRect=new o$H(0,0,99999999,99999999)}]),o$W}(),o$yo=function(){var o$$,o$T;function o$y(o$o,o$r,o$T,o$k,o$W){var o$D=this;function o$n(o$o){var o$r=[],o$T=new o$$(o$r);return o$D._compileToTree(o$T,o$o.split("\n"),0,o$r,o$W),o$T}var o$V=o$v.now();this._VS=o$n(o$r),this._PS=o$n(o$T),this._nameMap=o$k,2<o$v.now()-o$V&&console.log("ShaderCompile use time:"+(o$v.now()-o$V)+"  size:"+o$r.length+"/"+o$T.length)}o$i(o$y,"laya.webgl.utils.ShaderCompile");var o$o=o$y.prototype;return o$o._compileToTree=function(o$o,o$r,o$T,o$k,o$W){var o$D,o$n,o$V,o$L,o$U,o$h,o$p,o$i=0,o$v=0,o$x=0,o$j=0;for(o$v=o$T;o$v<o$r.length;o$v++)if(!((o$V=o$r[o$v]).length<1)&&0!==(o$i=o$V.indexOf("//"))){if(0<=o$i&&(o$V=o$V.substr(0,o$i)),o$D=o$p||new o$$(o$k),o$p=null,o$D.text=o$V,o$D.noCompile=!0,0<=(o$i=o$V.indexOf("#"))){for(o$L="#",o$j=o$i+1,o$x=o$V.length;o$j<o$x;o$j++){var o$_=o$V.charAt(o$j);if(" "===o$_||"\t"===o$_||"\r"===o$_||"\n"===o$_||"?"===o$_)break;o$L+=o$_}switch(o$D.name=o$L){case"#ifdef":case"#ifndef":if(o$D.src=o$V,o$D.noCompile=null!=o$V.match(/[!&|()=<>]/),o$D.noCompile?console.log("function():Boolean{return "+o$V.substr(o$i+o$D.name.length)+"}"):(o$h=o$V.replace(/^\s*/,"").split(/\s+/),o$D.setCondition(o$h[1],"#ifdef"===o$L?1:2),o$D.text="//"+o$D.text),o$D.setParent(o$o),o$o=o$D,o$W)for(o$h=o$V.substr(o$j).split(o$y._splitToWordExps3),o$j=0;o$j<o$h.length;o$j++)(o$V=o$h[o$j]).length&&(o$W[o$V]=!0);continue;case"#if":if(o$D.src=o$V,o$D.noCompile=!0,o$D.setParent(o$o),o$o=o$D,o$W)for(o$h=o$V.substr(o$j).split(o$y._splitToWordExps3),o$j=0;o$j<o$h.length;o$j++)(o$V=o$h[o$j]).length&&"defined"!=o$V&&(o$W[o$V]=!0);continue;case"#else":o$D.src=o$V,o$n=(o$o=o$o.parent).childs[o$o.childs.length-1],o$D.noCompile=o$n.noCompile,o$D.noCompile||(o$D.condition=o$n.condition,o$D.conditionType=1==o$n.conditionType?2:1,o$D.text="//"+o$D.text+" "+o$n.text+" "+o$D.conditionType),o$D.setParent(o$o),o$o=o$D;continue;case"#endif":o$n=(o$o=o$o.parent).childs[o$o.childs.length-1],o$D.noCompile=o$n.noCompile,o$D.noCompile||(o$D.text="//"+o$D.text),o$D.setParent(o$o);continue;case"#include":o$h=o$y.splitToWords(o$V,null);var o$K=o$y.includes[o$h[1]];if(!o$K)throw"ShaderCompile error no this include file:"+o$h[1];if((o$i=o$h[0].indexOf("?"))<0){o$D.setParent(o$o),o$V=o$K.getWith("with"==o$h[2]?o$h[3]:null),this._compileToTree(o$D,o$V.split("\n"),0,o$k,o$W),o$D.text="";continue}o$D.setCondition(o$h[0].substr(o$i+1),1),o$D.text=o$K.getWith("with"==o$h[2]?o$h[3]:null);break;case"#import":o$U=(o$h=o$y.splitToWords(o$V,null))[1],o$k.push({node:o$D,file:o$y.includes[o$U],ofs:o$D.text.length});continue}}else{if((o$n=o$o.childs[o$o.childs.length-1])&&!o$n.name){0<o$k.length&&o$y.splitToWords(o$V,o$n),o$p=o$D,o$n.text+="\n"+o$V;continue}0<o$k.length&&o$y.splitToWords(o$V,o$D)}o$D.setParent(o$o)}},o$o.createShader=function(o$o,o$r,o$T){var o$k={},o$W="";if(o$o)for(var o$D in o$o)o$W+="#define "+o$D+"\n",o$k[o$D]=!0;var o$n=this._VS.toscript(o$k,[]),o$V=this._PS.toscript(o$k,[]);return(o$T||o$Zo.create)(o$W+o$n.join("\n"),o$W+o$V.join("\n"),o$r,this._nameMap)},o$y._parseOne=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n={type:o$y.shaderParamsMap[o$T[o$k+1]],name:o$T[o$k+2],size:isNaN(parseInt(o$T[o$k+3]))?1:parseInt(o$T[o$k+3])};return o$D&&("attribute"==o$W?o$o.push(o$n):o$r.push(o$n)),":"==o$T[o$k+3]&&(o$n.type=o$T[o$k+4],o$k+=2),o$k+=2},o$y.addInclude=function(o$o,o$r){if(!o$r||0===o$r.length)throw new Error("add shader include file err:"+o$o);if(o$y.includes[o$o])throw new Error("add shader include file err, has add:"+o$o);o$y.includes[o$o]=new o$T(o$r)},o$y.preGetParams=function(o$o,o$r){var o$T=[o$o,o$r],o$k={},o$W=[],o$D=[],o$n={},o$V=[];o$k.attributes=o$W,o$k.uniforms=o$D,o$k.defines=o$n;for(var o$L=0,o$U=0,o$h=0;o$h<2;o$h++){o$T[o$h]=o$T[o$h].replace(o$y._removeAnnotation,"");var o$p,o$i=o$T[o$h].match(o$y._reg);for(o$L=0,o$U=o$i.length;o$L<o$U;o$L++){var o$v=o$i[o$L];if("attribute"==o$v||"uniform"==o$v)o$L=o$y._parseOne(o$W,o$D,o$i,o$L,o$v,!0);else{if("#define"==o$v){o$V[o$v=o$i[++o$L]]=1;continue}if("#ifdef"==o$v){o$n[o$p=o$i[++o$L]]=o$n[o$p]||[];for(o$L++;o$L<o$U;o$L++)if("attribute"==(o$v=o$i[o$L])||"uniform"==o$v)o$L=o$y._parseOne(o$W,o$D,o$i,o$L,o$v,o$V[o$p]);else if("#else"==o$v)for(o$L++;o$L<o$U;o$L++)if("attribute"==(o$v=o$i[o$L])||"uniform"==o$v)o$L=o$y._parseOne(o$W,o$D,o$i,o$L,o$v,!o$V[o$p]);else if("#endif"==o$v)break}}}}return o$k},o$y.splitToWords=function(o$o,o$r){for(var o$T,o$k,o$W=[],o$D=-1,o$n=0,o$V=o$o.length;o$n<o$V;o$n++)if(o$T=o$o.charAt(o$n),0<=" \t=+-*/&%!<>()'\",;".indexOf(o$T)){if(0<=o$D&&1<o$n-o$D&&(o$k=o$o.substr(o$D,o$n-o$D),o$W.push(o$k)),'"'==o$T||"'"==o$T){var o$L=o$o.indexOf(o$T,o$n+1);if(o$L<0)throw"Sharder err:"+o$o;o$W.push(o$o.substr(o$n+1,o$L-o$n-1)),o$n=o$L,o$D=-1;continue}"("==o$T&&o$r&&0<o$W.length&&(o$k=o$W[o$W.length-1]+";","vec4;main;".indexOf(o$k)<0&&(o$r.useFuns+=o$k)),o$D=-1}else o$D<0&&(o$D=o$n);return o$D<o$V&&1<o$V-o$D&&(o$k=o$o.substr(o$D,o$V-o$D),o$W.push(o$k)),o$W},o$y.IFDEF_NO=0,o$y.IFDEF_YES=1,o$y.IFDEF_ELSE=2,o$y.IFDEF_PARENT=3,o$y._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),o$y._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),o$y._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),o$y.includes={},o$n(o$y,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),o$y.__init$=function(){o$$=function(){function o$T(o$o){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=o$o}o$i(o$T,"");var o$o=o$T.prototype;return o$o.setParent=function(o$o){o$o.childs.push(this),this.z=o$o.z+1,this.parent=o$o},o$o.setCondition=function(o$o,o$r){o$o&&(this.conditionType=o$r,o$o=o$o.replace(/(\s*$)/g,""),this.condition=function(){return this[o$o]},this.condition.__condition=o$o)},o$o.toscript=function(o$o,o$r){return this._toscript(o$o,o$r,++o$T.__id)},o$o._toscript=function(o$k,o$W,o$D){if(this.childs.length<1&&!this.text)return o$W;o$W.length;if(this.condition){var o$o=!!this.condition.call(o$k);if(2===this.conditionType&&(o$o=!o$o),!o$o)return o$W}if(this.text&&o$W.push(this.text),0<this.childs.length&&this.childs.forEach(function(o$o,o$r,o$T){o$o._toscript(o$k,o$W,o$D)}),0<this.includefiles.length&&0<this.useFuns.length)for(var o$r,o$T=0,o$n=this.includefiles.length;o$T<o$n;o$T++)this.includefiles[o$T].curUseID!=o$D&&0<(o$r=this.includefiles[o$T].file.getFunsScript(this.useFuns)).length&&(this.includefiles[o$T].curUseID=o$D,o$W[0]=o$r+o$W[0]);return o$W},o$T.__id=1,o$T}(),o$T=function(){function o$o(o$o){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=o$o;for(var o$r=0,o$T=0,o$k=0;!((o$r=o$o.indexOf("#begin",o$r))<0);){for(o$k=o$r+5;!((o$k=o$o.indexOf("#end",o$k))<0)&&"i"===o$o.charAt(o$k+4);)o$k+=5;if(o$k<0)throw"add include err,no #end:"+o$o;o$T=o$o.indexOf("\n",o$r);var o$W=o$y.splitToWords(o$o.substr(o$r,o$T-o$r),null);"code"==o$W[1]?this.codes[o$W[2]]=o$o.substr(o$T+1,o$k-o$T-1):"function"==o$W[1]&&(o$T=o$o.indexOf("function",o$r),o$T+="function".length,this.funs[o$W[3]]=o$o.substr(o$T+1,o$k-o$T-1),this.funnames+=o$W[3]+";"),o$r=o$k+1}}o$i(o$o,"");var o$r=o$o.prototype;return o$r.getWith=function(o$o){var o$r=o$o?this.codes[o$o]:this.script;if(!o$r)throw"get with error:"+o$o;return o$r},o$r.getFunsScript=function(o$o){var o$r="";for(var o$T in this.funs)0<=o$o.indexOf(o$T+";")&&(o$r+=this.funs[o$T]);return o$r},o$o}()},o$y}(),o$lo=function(){function o$n(){}return o$i(o$n,"laya.webgl.WebGL"),o$n._uint8ArraySlice=function(){for(var o$o=this.length,o$r=new Uint8Array(this.length),o$T=0;o$T<o$o;o$T++)o$r[o$T]=this[o$T];return o$r},o$n._float32ArraySlice=function(){for(var o$o=this.length,o$r=new Float32Array(this.length),o$T=0;o$T<o$o;o$T++)o$r[o$T]=this[o$T];return o$r},o$n._uint16ArraySlice=function(o$o){var o$r,o$T=arguments,o$k=0,o$W=0;if(0===o$T.length)for(o$k=this.length,o$r=new Uint16Array(o$k),o$W=0;o$W<o$k;o$W++)o$r[o$W]=this[o$W];else if(2===o$T.length){var o$D=o$T[0],o$n=o$T[1];if(o$D<o$n)for(o$k=o$n-o$D,o$r=new Uint16Array(o$k),o$W=o$D;o$W<o$n;o$W++)o$r[o$W-o$D]=this[o$W];else o$r=new Uint16Array(0)}return o$r},o$n.expandContext=function(){var o$o=o$W.prototype,o$r=CanvasRenderingContext2D.prototype;o$r.fillTrangles=o$o.fillTrangles,o$Qo.__int__(null),o$r.setIBVB=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){void 0===o$L&&(o$L=0),void 0===o$U&&(o$U=0),null===o$T&&(this._ib=this._ib||o$Eo.QuadrangleIB,o$T=this._ib,o$_o.expandIBQuadrangle(o$T,o$k._byteLength/64+8)),this._setIBVB(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U)},o$r.fillTrangles=function(o$o,o$r,o$T,o$k,o$W){this._curMat=this._curMat||o$P.create(),this._vb=this._vb||o$do.create(),this._ib||(this._ib=o$Eo.create(),o$_o.fillIBQuadrangle(this._ib,o$n/4));var o$D=this._vb,o$n=o$k.length>>4;o$_o.fillTranglesVB(o$D,o$r,o$T,o$k,o$W||this._curMat,0,0),o$_o.expandIBQuadrangle(this._ib,o$D._byteLength/64+8);var o$V=new o$Fo(1,0);o$V.textureHost=o$o;var o$L=new o$Bo("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");o$D._vertType=3,this._setIBVB(o$r,o$T,this._ib,o$D,6*o$n,o$W,o$L,o$V,0,0)}},o$n.enable=function(){if(o$v.__init__(),o$K.isConchApp&&!o$K.isConchWebGL)return o$S.skinAniSprite=function(){return new o$oo},o$n.expandContext(),!1;if(o$S.getWebGLContext=function(o$o){for(var o$r,o$T=["webgl","experimental-webgl","webkit-3d","moz-webgl"],o$k=0;o$k<o$T.length;o$k++){try{o$r=o$o.getContext(o$T[o$k],{stencil:o$b.isStencil,alpha:o$b.isAlpha,antialias:o$b.isAntialias,premultipliedAlpha:o$b.premultipliedAlpha,preserveDrawingBuffer:o$b.preserveDrawingBuffer})}catch(o$o){}if(o$r)return o$r}return null},null==(o$n.mainContext=o$S.getWebGLContext(o$K._mainCanvas)))return!1;if(o$K.isWebGL)return!0;o$j.create=function(o$o,o$r){return new o$or(o$o,o$r)},o$_.create=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){return new o$wo(o$o,o$r,o$T,o$k,o$W,o$D,o$n)},o$K.WebGL=o$n,o$K.isWebGL=!0,o$vo.__init__(),o$S.createRenderSprite=function(o$o,o$r){return new o$Po(o$o,o$r)},o$S.createWebGLContext2D=function(o$o){return new o$bo(o$o)},o$S.changeWebGLSize=function(o$o,o$r){laya.webgl.WebGL.onStageResize(o$o,o$r)},o$S.createGraphics=function(){return new o$qo};var o$o=o$S.createFilterAction;return o$S.createFilterAction=o$o||function(o$o){return new o$to},o$S.clear=function(o$o){o$$o.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var o$r=o$K.context.ctx,o$T=0==o$r._submits._length||o$b.preserveDrawingBuffer?o$x.create(o$o)._color:o$u._wgColor;o$T&&o$r.clearBG(o$T[0],o$T[1],o$T[2],o$T[3]),o$$o.clear()},o$S.addToAtlas=function(o$o,o$r){void 0===o$r&&(o$r=!1);var o$T=o$o.bitmap;o$K.optimizeTextureMemory(o$o.url,o$o)?o$q.__typeof(o$T,"laya.webgl.resource.IMergeAtlasBitmap")&&o$T.allowMerageInAtlas&&o$T.on("recovered",o$o,o$o.addTextureToAtlas):o$T.enableMerageInAtlas=!1},o$S.isAtlas=function(o$o){return o$o instanceof laya.webgl.atlas.AtlasWebGLCanvas},o$Y._enable(),o$S.beginFlush=function(){for(var o$o=o$Y.instance,o$r=o$o.getAtlaserCount(),o$T=0;o$T<o$r;o$T++){var o$k=o$o.getAtlaserByIndex(o$T).texture;o$k._flashCacheImageNeedFlush&&o$S.flashFlushImage(o$k)}},o$S.drawToCanvas=function(o$o,o$r,o$T,o$k,o$W,o$D){(o$T<=0||o$k<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),o$T|=0,o$k|=0,o$W|=0,o$D|=0;var o$n=o$Mo.create(o$T,o$k,6408,5121,0,!1);o$n.start(),o$n.clear(0,0,0,0),o$K.context.clear(),o$$.renders[o$r]._fun(o$o,o$K.context,o$W,o$$o.height-o$k+o$D),o$K.context.flush(),o$n.end();var o$V=o$n.getData(0,0,o$T,o$k);if(o$n.recycle(),o$V.byteLength==o$T*o$k*4){var o$L=new o$fo;o$L._canvas=o$v.createElement("canvas"),o$L.size(o$T,o$k);var o$U=o$L._canvas.getContext("2d");o$v.canvas.size(o$T,o$k);var o$h=o$v.context,o$p=o$h.createImageData(o$T,o$k);return o$p.data.set(new Uint8ClampedArray(o$V.buffer)),o$L._imgData=o$p,o$h.putImageData(o$p,0,0),o$U.save(),o$U.translate(0,o$k),o$U.scale(1,-1),o$U.drawImage(o$v.canvas.source,0,0),o$U.restore(),o$L}console.log("drawToCanvas error: w:"+o$T+",h:"+o$k+",datalen:"+o$V.byteLength)},o$S.createFilterAction=function(o$o){var o$r;switch(o$o){case 32:o$r=new o$to}return o$r},o$S.addTextureToAtlas=function(o$o){o$o._uvID++,o$Y._atlasRestore++,o$o.bitmap.enableMerageInAtlas&&o$Y.instance.addToAtlas(o$o)},o$S.getTexturePixels=function(o$o,o$r,o$T,o$k,o$W){o$K.context.ctx.clear();var o$D=new o$R;o$D.graphics.drawTexture(o$o,-o$r,-o$T);var o$n=o$Mo.create(o$k,o$W);o$n.start(),o$n.clear(0,0,0,0),o$D.render(o$K.context,0,0),o$K.context.ctx.flush(),o$n.end();for(var o$V=o$n.getData(0,0,o$k,o$W),o$L=[],o$U=0,o$h=o$W-1;0<=o$h;o$h--)for(var o$p=0;o$p<o$k;o$p++)o$U=4*(o$h*o$k+o$p),o$L.push(o$V[o$U]),o$L.push(o$V[o$U+1]),o$L.push(o$V[o$U+2]),o$L.push(o$V[o$U+3]);return o$L},o$S.skinAniSprite=function(){return new o$oo},o$U.create=function(o$o,o$r){var o$T=new o$fo;return o$T._imgData=o$r,o$T.flipY=!1,o$T},o$F._filterStart=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$o.getValue("bounds"),o$n=o$Mo.create(o$D.width,o$D.height);if(o$n.start(),o$n.clear(0,0,0,0),o$o.addValue("src",o$n),o$o.addValue("ScissorTest",o$$o.worldScissorTest),o$$o.worldScissorTest){var o$V=new o$H;o$V.copyFrom(o$T.ctx._clipRect),o$o.addValue("clipRect",o$V),o$$o.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},o$F._filterEnd=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$o.getValue("bounds");o$o.getValue("src").end();var o$n=o$Mo.create(o$D.width,o$D.height);o$n.start(),o$n.clear(0,0,0,0),o$o.addValue("out",o$n),o$r._set$P("_filterCache",o$n),o$r._set$P("_isHaveGlowFilter",o$o.getValue("_isHaveGlowFilter"))},o$F._EndTarget=function(o$o,o$r){if(o$o.getValue("src").recycle(),o$o.getValue("out").end(),o$o.getValue("ScissorTest")){o$$o.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),o$r.ctx.save();var o$T=o$o.getValue("clipRect");o$r.ctx.clipRect(o$T.x,o$T.y,o$T.width,o$T.height)}},o$F._useSrc=function(o$o){var o$r=o$o.getValue("out");o$r.end(),(o$r=o$o.getValue("src")).start(),o$r.clear(0,0,0,0)},o$F._endSrc=function(o$o){o$o.getValue("src").end()},o$F._useOut=function(o$o){var o$r=o$o.getValue("src");o$r.end(),(o$r=o$o.getValue("out")).start(),o$r.clear(0,0,0,0)},o$F._endOut=function(o$o){o$o.getValue("out").end()},o$F._recycleScope=function(o$o){o$o.recycle()},o$F._filter=function(o$o,o$r,o$T,o$k){var o$W=this._next;if(o$W){var o$D,o$n,o$V=o$o.filters,o$L=o$V.length;if(1==o$L&&32==o$V[0].type)return o$r.ctx.save(),o$r.ctx.setFilters([o$V[0]]),o$W._fun.call(o$W,o$o,o$r,o$T,o$k),void o$r.ctx.restore();var o$U=o$Vo.create(),o$h=o$t.TEMP,o$p=o$r.ctx._getTransformMatrix(),o$i=o$P.create();o$p.copyTo(o$i);var o$v=0,o$x=0,o$j=!1,o$_=o$o._$P._filterCache?o$o._$P._filterCache:null;if(!o$_||o$o._repaint){o$j=o$o._isHaveGlowFilter(),o$U.addValue("_isHaveGlowFilter",o$j),o$j&&(o$v=50,o$x=25),(o$n=new o$H).copyFrom(o$o.getSelfBounds()),o$n.x+=o$o.x,o$n.y+=o$o.y,o$n.x-=o$o.pivotX+4,o$n.y-=o$o.pivotY+4;var o$K=o$n.x,o$$=o$n.y;if(o$n.width+=o$v+8,o$n.height+=o$v+8,o$h.x=o$n.x*o$i.a+o$n.y*o$i.c,o$h.y=o$n.y*o$i.d+o$n.x*o$i.b,o$n.x=o$h.x,o$n.y=o$h.y,o$h.x=o$n.width*o$i.a+o$n.height*o$i.c,o$h.y=o$n.height*o$i.d+o$n.width*o$i.b,o$n.width=o$h.x,o$n.height=o$h.y,o$n.width<=0||o$n.height<=0)return;o$_&&o$_.recycle(),o$U.addValue("bounds",o$n);var o$y=o$no.create([o$U,o$o,o$r,0,0],o$F._filterStart);o$r.addRenderObject(o$y),o$r.ctx._renderKey=0,o$r.ctx._shader2D.glTexture=null;var o$l=o$o.x-o$K+o$x,o$S=o$o.y-o$$+o$x;o$W._fun.call(o$W,o$o,o$r,o$l,o$S),o$y=o$no.create([o$U,o$o,o$r,0,0],o$F._filterEnd),o$r.addRenderObject(o$y);for(var o$q=0;o$q<o$L;o$q++){0!=o$q&&(o$y=o$no.create([o$U],o$F._useSrc),o$r.addRenderObject(o$y),o$D=o$Fo.create(1,0),o$P.TEMP.identity(),o$r.ctx.drawTarget(o$U,0,0,o$n.width,o$n.height,o$P.TEMP,"out",o$D,null,o$I.TOINT.overlay),o$y=o$no.create([o$U],o$F._useOut),o$r.addRenderObject(o$y)),o$V[o$q].action.apply3d(o$U,o$o,o$r,0,0)}o$y=o$no.create([o$U,o$r],o$F._EndTarget),o$r.addRenderObject(o$y)}else{if((o$j=!!o$o._$P._isHaveGlowFilter&&o$o._$P._isHaveGlowFilter)&&(o$v=50,o$x=25),(o$n=o$o.getBounds()).width<=0||o$n.height<=0)return;o$n.width+=o$v,o$n.height+=o$v,o$h.x=o$n.x*o$i.a+o$n.y*o$i.c,o$h.y=o$n.y*o$i.d+o$n.x*o$i.b,o$n.x=o$h.x,o$n.y=o$h.y,o$h.x=o$n.width*o$i.a+o$n.height*o$i.c,o$h.y=o$n.height*o$i.d+o$n.width*o$i.b,o$n.width=o$h.x,o$n.height=o$h.y,o$U.addValue("out",o$_)}o$T=o$T-o$x-o$o.x,o$k=o$k-o$x-o$o.y,o$h.setTo(o$T,o$k),o$i.transformPoint(o$h),o$T=o$h.x+o$n.x,o$k=o$h.y+o$n.y,o$D=o$Fo.create(1,0),o$P.TEMP.identity(),o$r.ctx.drawTarget(o$U,o$T,o$k,o$n.width,o$n.height,o$P.TEMP,"out",o$D,null,o$I.TOINT.overlay),o$y=o$no.create([o$U],o$F._recycleScope),o$r.addRenderObject(o$y),o$i.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=o$n._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=o$n._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=o$n._uint8ArraySlice),!0},o$n.onStageResize=function(o$o,o$r){null!=o$n.mainContext&&(o$n.mainContext.viewport(0,0,o$o,o$r),o$$o.width=o$o,o$$o.height=o$r)},o$n.onInvalidGLRes=function(){o$Y.instance.freeAll(),o$l.releaseContentManagers(!0),o$n.doNodeRepaint(o$q.stage),o$n.mainContext.viewport(0,0,o$$o.width,o$$o.height),o$q.stage.event("devicelost")},o$n.doNodeRepaint=function(o$o){0==o$o.numChildren&&o$o.repaint();for(var o$r=0;o$r<o$o.numChildren;o$r++)o$n.doNodeRepaint(o$o.getChildAt(o$r))},o$n.init=function(o$o,o$r,o$T){o$n.mainCanvas=o$o,o$U._createContext=function(o$o){return new o$bo(o$o)},o$fo._createContext=function(o$o){return new o$bo(o$o)};var o$k=laya.webgl.WebGL.mainContext;if(null!=o$k.getShaderPrecisionFormat){var o$W=o$k.getShaderPrecisionFormat(35633,36338),o$D=o$k.getShaderPrecisionFormat(35632,36338);o$n.shaderHighPrecision=!(!o$W.precision||!o$D.precision)}else o$n.shaderHighPrecision=!1;if(o$k.deleteTexture1=o$k.deleteTexture,o$k.deleteTexture=function(o$o){o$o==o$So.curBindTexValue&&(o$So.curBindTexValue=null),o$k.deleteTexture1(o$o)},o$n.onStageResize(o$r,o$T),null==o$n.mainContext)throw new Error("webGL getContext err!");o$m.__init__(),o$Y.__init__(),o$Ro.__init__(),o$Do.__init__(),o$bo.__init__(),o$Fo.__init__(),o$E.__init__(),o$Qo.__int__(o$k),o$I._init_(o$k),o$K.isConchApp&&conch.setOnInvalidGLRes(o$n.onInvalidGLRes)},o$n.mainCanvas=null,o$n.mainContext=null,o$n.antialias=!0,o$n.shaderHighPrecision=!1,o$n._bg_null=[0,0,0,0],o$n}(),o$So=function(){function o$k(){}return o$i(o$k,"laya.webgl.WebGLContext"),o$k.UseProgram=function(o$o){return o$k._useProgram!==o$o&&(o$lo.mainContext.useProgram(o$o),o$k._useProgram=o$o,!0)},o$k.setDepthTest=function(o$o,o$r){o$r!==o$k._depthTest&&((o$k._depthTest=o$r)?o$o.enable(2929):o$o.disable(2929))},o$k.setDepthMask=function(o$o,o$r){o$r!==o$k._depthMask&&(o$k._depthMask=o$r,o$o.depthMask(o$r))},o$k.setDepthFunc=function(o$o,o$r){o$r!==o$k._depthFunc&&(o$k._depthFunc=o$r,o$o.depthFunc(o$r))},o$k.setBlend=function(o$o,o$r){o$r!==o$k._blend&&((o$k._blend=o$r)?o$o.enable(3042):o$o.disable(3042))},o$k.setBlendFunc=function(o$o,o$r,o$T){(o$r!==o$k._sFactor||o$T!==o$k._dFactor)&&(o$k._sFactor=o$r,o$k._dFactor=o$T,o$o.blendFunc(o$r,o$T))},o$k.setCullFace=function(o$o,o$r){o$r!==o$k._cullFace&&((o$k._cullFace=o$r)?o$o.enable(2884):o$o.disable(2884))},o$k.setFrontFace=function(o$o,o$r){o$r!==o$k._frontFace&&(o$k._frontFace=o$r,o$o.frontFace(o$r))},o$k.bindTexture=function(o$o,o$r,o$T){o$o.bindTexture(o$r,o$T),o$k.curBindTexTarget=o$r,o$k.curBindTexValue=o$T},o$k.DEPTH_BUFFER_BIT=256,o$k.STENCIL_BUFFER_BIT=1024,o$k.COLOR_BUFFER_BIT=16384,o$k.POINTS=0,o$k.LINES=1,o$k.LINE_LOOP=2,o$k.LINE_STRIP=3,o$k.TRIANGLES=4,o$k.TRIANGLE_STRIP=5,o$k.TRIANGLE_FAN=6,o$k.ZERO=0,o$k.ONE=1,o$k.SRC_COLOR=768,o$k.ONE_MINUS_SRC_COLOR=769,o$k.SRC_ALPHA=770,o$k.ONE_MINUS_SRC_ALPHA=771,o$k.DST_ALPHA=772,o$k.ONE_MINUS_DST_ALPHA=773,o$k.DST_COLOR=774,o$k.ONE_MINUS_DST_COLOR=775,o$k.SRC_ALPHA_SATURATE=776,o$k.FUNC_ADD=32774,o$k.BLEND_EQUATION=32777,o$k.BLEND_EQUATION_RGB=32777,o$k.BLEND_EQUATION_ALPHA=34877,o$k.FUNC_SUBTRACT=32778,o$k.FUNC_REVERSE_SUBTRACT=32779,o$k.BLEND_DST_RGB=32968,o$k.BLEND_SRC_RGB=32969,o$k.BLEND_DST_ALPHA=32970,o$k.BLEND_SRC_ALPHA=32971,o$k.CONSTANT_COLOR=32769,o$k.ONE_MINUS_CONSTANT_COLOR=32770,o$k.CONSTANT_ALPHA=32771,o$k.ONE_MINUS_CONSTANT_ALPHA=32772,o$k.BLEND_COLOR=32773,o$k.ARRAY_BUFFER=34962,o$k.ELEMENT_ARRAY_BUFFER=34963,o$k.ARRAY_BUFFER_BINDING=34964,o$k.ELEMENT_ARRAY_BUFFER_BINDING=34965,o$k.STREAM_DRAW=35040,o$k.STATIC_DRAW=35044,o$k.DYNAMIC_DRAW=35048,o$k.BUFFER_SIZE=34660,o$k.BUFFER_USAGE=34661,o$k.CURRENT_VERTEX_ATTRIB=34342,o$k.FRONT=1028,o$k.BACK=1029,o$k.CULL_FACE=2884,o$k.FRONT_AND_BACK=1032,o$k.BLEND=3042,o$k.DITHER=3024,o$k.STENCIL_TEST=2960,o$k.DEPTH_TEST=2929,o$k.SCISSOR_TEST=3089,o$k.POLYGON_OFFSET_FILL=32823,o$k.SAMPLE_ALPHA_TO_COVERAGE=32926,o$k.SAMPLE_COVERAGE=32928,o$k.NO_ERROR=0,o$k.INVALID_ENUM=1280,o$k.INVALID_VALUE=1281,o$k.INVALID_OPERATION=1282,o$k.OUT_OF_MEMORY=1285,o$k.CW=2304,o$k.CCW=2305,o$k.LINE_WIDTH=2849,o$k.ALIASED_POINT_SIZE_RANGE=33901,o$k.ALIASED_LINE_WIDTH_RANGE=33902,o$k.CULL_FACE_MODE=2885,o$k.FRONT_FACE=2886,o$k.DEPTH_RANGE=2928,o$k.DEPTH_WRITEMASK=2930,o$k.DEPTH_CLEAR_VALUE=2931,o$k.DEPTH_FUNC=2932,o$k.STENCIL_CLEAR_VALUE=2961,o$k.STENCIL_FUNC=2962,o$k.STENCIL_FAIL=2964,o$k.STENCIL_PASS_DEPTH_FAIL=2965,o$k.STENCIL_PASS_DEPTH_PASS=2966,o$k.STENCIL_REF=2967,o$k.STENCIL_VALUE_MASK=2963,o$k.STENCIL_WRITEMASK=2968,o$k.STENCIL_BACK_FUNC=34816,o$k.STENCIL_BACK_FAIL=34817,o$k.STENCIL_BACK_PASS_DEPTH_FAIL=34818,o$k.STENCIL_BACK_PASS_DEPTH_PASS=34819,o$k.STENCIL_BACK_REF=36003,o$k.STENCIL_BACK_VALUE_MASK=36004,o$k.STENCIL_BACK_WRITEMASK=36005,o$k.VIEWPORT=2978,o$k.SCISSOR_BOX=3088,o$k.COLOR_CLEAR_VALUE=3106,o$k.COLOR_WRITEMASK=3107,o$k.UNPACK_ALIGNMENT=3317,o$k.PACK_ALIGNMENT=3333,o$k.MAX_TEXTURE_SIZE=3379,o$k.MAX_VIEWPORT_DIMS=3386,o$k.SUBPIXEL_BITS=3408,o$k.RED_BITS=3410,o$k.GREEN_BITS=3411,o$k.BLUE_BITS=3412,o$k.ALPHA_BITS=3413,o$k.DEPTH_BITS=3414,o$k.STENCIL_BITS=3415,o$k.POLYGON_OFFSET_UNITS=10752,o$k.POLYGON_OFFSET_FACTOR=32824,o$k.TEXTURE_BINDING_2D=32873,o$k.SAMPLE_BUFFERS=32936,o$k.SAMPLES=32937,o$k.SAMPLE_COVERAGE_VALUE=32938,o$k.SAMPLE_COVERAGE_INVERT=32939,o$k.NUM_COMPRESSED_TEXTURE_FORMATS=34466,o$k.COMPRESSED_TEXTURE_FORMATS=34467,o$k.DONT_CARE=4352,o$k.FASTEST=4353,o$k.NICEST=4354,o$k.GENERATE_MIPMAP_HINT=33170,o$k.BYTE=5120,o$k.UNSIGNED_BYTE=5121,o$k.SHORT=5122,o$k.UNSIGNED_SHORT=5123,o$k.INT=5124,o$k.UNSIGNED_INT=5125,o$k.FLOAT=5126,o$k.DEPTH_COMPONENT=6402,o$k.ALPHA=6406,o$k.RGB=6407,o$k.RGBA=6408,o$k.LUMINANCE=6409,o$k.LUMINANCE_ALPHA=6410,o$k.UNSIGNED_SHORT_4_4_4_4=32819,o$k.UNSIGNED_SHORT_5_5_5_1=32820,o$k.UNSIGNED_SHORT_5_6_5=33635,o$k.FRAGMENT_SHADER=35632,o$k.VERTEX_SHADER=35633,o$k.MAX_VERTEX_ATTRIBS=34921,o$k.MAX_VERTEX_UNIFORM_VECTORS=36347,o$k.MAX_VARYING_VECTORS=36348,o$k.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,o$k.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,o$k.MAX_TEXTURE_IMAGE_UNITS=34930,o$k.MAX_FRAGMENT_UNIFORM_VECTORS=36349,o$k.SHADER_TYPE=35663,o$k.DELETE_STATUS=35712,o$k.LINK_STATUS=35714,o$k.VALIDATE_STATUS=35715,o$k.ATTACHED_SHADERS=35717,o$k.ACTIVE_UNIFORMS=35718,o$k.ACTIVE_ATTRIBUTES=35721,o$k.SHADING_LANGUAGE_VERSION=35724,o$k.CURRENT_PROGRAM=35725,o$k.NEVER=512,o$k.LESS=513,o$k.EQUAL=514,o$k.LEQUAL=515,o$k.GREATER=516,o$k.NOTEQUAL=517,o$k.GEQUAL=518,o$k.ALWAYS=519,o$k.KEEP=7680,o$k.REPLACE=7681,o$k.INCR=7682,o$k.DECR=7683,o$k.INVERT=5386,o$k.INCR_WRAP=34055,o$k.DECR_WRAP=34056,o$k.VENDOR=7936,o$k.RENDERER=7937,o$k.VERSION=7938,o$k.NEAREST=9728,o$k.LINEAR=9729,o$k.NEAREST_MIPMAP_NEAREST=9984,o$k.LINEAR_MIPMAP_NEAREST=9985,o$k.NEAREST_MIPMAP_LINEAR=9986,o$k.LINEAR_MIPMAP_LINEAR=9987,o$k.TEXTURE_MAG_FILTER=10240,o$k.TEXTURE_MIN_FILTER=10241,o$k.TEXTURE_WRAP_S=10242,o$k.TEXTURE_WRAP_T=10243,o$k.TEXTURE_2D=3553,o$k.TEXTURE=5890,o$k.TEXTURE_CUBE_MAP=34067,o$k.TEXTURE_BINDING_CUBE_MAP=34068,o$k.TEXTURE_CUBE_MAP_POSITIVE_X=34069,o$k.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,o$k.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,o$k.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,o$k.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,o$k.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,o$k.MAX_CUBE_MAP_TEXTURE_SIZE=34076,o$k.TEXTURE0=33984,o$k.TEXTURE1=33985,o$k.TEXTURE2=33986,o$k.TEXTURE3=33987,o$k.TEXTURE4=33988,o$k.TEXTURE5=33989,o$k.TEXTURE6=33990,o$k.TEXTURE7=33991,o$k.TEXTURE8=33992,o$k.TEXTURE9=33993,o$k.TEXTURE10=33994,o$k.TEXTURE11=33995,o$k.TEXTURE12=33996,o$k.TEXTURE13=33997,o$k.TEXTURE14=33998,o$k.TEXTURE15=33999,o$k.TEXTURE16=34e3,o$k.TEXTURE17=34001,o$k.TEXTURE18=34002,o$k.TEXTURE19=34003,o$k.TEXTURE20=34004,o$k.TEXTURE21=34005,o$k.TEXTURE22=34006,o$k.TEXTURE23=34007,o$k.TEXTURE24=34008,o$k.TEXTURE25=34009,o$k.TEXTURE26=34010,o$k.TEXTURE27=34011,o$k.TEXTURE28=34012,o$k.TEXTURE29=34013,o$k.TEXTURE30=34014,o$k.TEXTURE31=34015,o$k.ACTIVE_TEXTURE=34016,o$k.REPEAT=10497,o$k.CLAMP_TO_EDGE=33071,o$k.MIRRORED_REPEAT=33648,o$k.FLOAT_VEC2=35664,o$k.FLOAT_VEC3=35665,o$k.FLOAT_VEC4=35666,o$k.INT_VEC2=35667,o$k.INT_VEC3=35668,o$k.INT_VEC4=35669,o$k.BOOL=35670,o$k.BOOL_VEC2=35671,o$k.BOOL_VEC3=35672,o$k.BOOL_VEC4=35673,o$k.FLOAT_MAT2=35674,o$k.FLOAT_MAT3=35675,o$k.FLOAT_MAT4=35676,o$k.SAMPLER_2D=35678,o$k.SAMPLER_CUBE=35680,o$k.VERTEX_ATTRIB_ARRAY_ENABLED=34338,o$k.VERTEX_ATTRIB_ARRAY_SIZE=34339,o$k.VERTEX_ATTRIB_ARRAY_STRIDE=34340,o$k.VERTEX_ATTRIB_ARRAY_TYPE=34341,o$k.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,o$k.VERTEX_ATTRIB_ARRAY_POINTER=34373,o$k.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,o$k.COMPILE_STATUS=35713,o$k.LOW_FLOAT=36336,o$k.MEDIUM_FLOAT=36337,o$k.HIGH_FLOAT=36338,o$k.LOW_INT=36339,o$k.MEDIUM_INT=36340,o$k.HIGH_INT=36341,o$k.FRAMEBUFFER=36160,o$k.RENDERBUFFER=36161,o$k.RGBA4=32854,o$k.RGB5_A1=32855,o$k.RGB565=36194,o$k.DEPTH_COMPONENT16=33189,o$k.STENCIL_INDEX=6401,o$k.STENCIL_INDEX8=36168,o$k.DEPTH_STENCIL=34041,o$k.RENDERBUFFER_WIDTH=36162,o$k.RENDERBUFFER_HEIGHT=36163,o$k.RENDERBUFFER_INTERNAL_FORMAT=36164,o$k.RENDERBUFFER_RED_SIZE=36176,o$k.RENDERBUFFER_GREEN_SIZE=36177,o$k.RENDERBUFFER_BLUE_SIZE=36178,o$k.RENDERBUFFER_ALPHA_SIZE=36179,o$k.RENDERBUFFER_DEPTH_SIZE=36180,o$k.RENDERBUFFER_STENCIL_SIZE=36181,o$k.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,o$k.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,o$k.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,o$k.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,o$k.COLOR_ATTACHMENT0=36064,o$k.DEPTH_ATTACHMENT=36096,o$k.STENCIL_ATTACHMENT=36128,o$k.DEPTH_STENCIL_ATTACHMENT=33306,o$k.NONE=0,o$k.FRAMEBUFFER_COMPLETE=36053,o$k.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,o$k.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,o$k.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,o$k.FRAMEBUFFER_UNSUPPORTED=36061,o$k.FRAMEBUFFER_BINDING=36006,o$k.RENDERBUFFER_BINDING=36007,o$k.MAX_RENDERBUFFER_SIZE=34024,o$k.INVALID_FRAMEBUFFER_OPERATION=1286,o$k.UNPACK_FLIP_Y_WEBGL=37440,o$k.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,o$k.CONTEXT_LOST_WEBGL=37442,o$k.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,o$k.BROWSER_DEFAULT_WEBGL=37444,o$k._useProgram=null,o$k._depthTest=!0,o$k._depthMask=!0,o$k._blend=!1,o$k._cullFace=!1,o$k.curBindTexTarget=null,o$k.curBindTexValue=null,o$n(o$k,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),o$k}(),o$qo=function(o$o){function o$r(){o$r.__super.call(this)}o$i(o$r,"laya.webgl.display.GraphicsGL",o$V);var o$T=o$r.prototype;return o$T.setShader=function(o$o){this._saveToCmd(o$K.context._setShader,[o$o])},o$T.setIBVB=function(o$o,o$r,o$T,o$k,o$W,o$D){this._saveToCmd(o$K.context._setIBVB,[o$o,o$r,o$T,o$k,o$W,o$D])},o$T.drawParticle=function(o$o,o$r,o$T){var o$k=o$S.createParticleTemplate2D(o$T);o$k.x=o$o,o$k.y=o$r,this._saveToCmd(o$K.context._drawParticle,[o$k])},o$r}(),o$bo=function(o$o){var o$T;function o$J(o$o){this._x=0,this._y=0,this._id=++o$J._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,o$J.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=o$J.MAXCLIPRECT,this.mOutPoint,this._canvas=o$o,this._canvas._addReference(),o$J._contextcount++,o$K.isFlash?(this._ib=o$Eo.create(35044),o$_o.fillIBQuadrangle(this._ib,16)):this._ib=o$Eo.QuadrangleIB,this.clear()}o$i(o$J,"laya.webgl.canvas.WebGLContext2D",o$W);var o$r=o$J.prototype;return o$r.setIsMainContext=function(){this._isMain=!0},o$r.clearBG=function(o$o,o$r,o$T,o$k){var o$W=o$lo.mainContext;o$W.clearColor(o$o,o$r,o$T,o$k),o$W.clear(16384)},o$r._getSubmits=function(){return this._submits},o$r._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var o$o=0,o$r=this._submits._length;o$o<o$r;o$o++)this._submits[o$o].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},o$r.destroy=function(){--o$J._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=o$Eo.QuadrangleIB&&this._ib.releaseResource()},o$r.clear=function(){this._submits||(this._other=o$T.DEFAULT,this._curMat=o$P.create(),this._vb=o$do.create(-1),this._submits=[],this._save=[o$Z.Create(this)],this._save.length=10,this._shader2D=new o$E,this._triangleMesh=o$Xo.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=o$T.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=o$J.MAXCLIPRECT,this._curSubmit=o$Do.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=o$N.DEFAULT;for(var o$o=0,o$r=this._submits._length;o$o<o$r;o$o++)this._submits[o$o].releaseRender(),this._submits[o$o]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},o$r.size=function(o$o,o$r){if(this._width!=o$o||this._height!=o$r)if(0==o$o||0==o$r){0!=this._vb._byteLength&&(this._width=o$o,this._height=o$r,this._vb.clear(),this._vb.upload());for(var o$T=0,o$k=this._submits._length;o$T<o$k;o$T++)this._submits[o$T].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=o$o,this._height=o$r,this._targets&&this._targets.size(o$o,o$r),this._canvas.memorySize-=this._canvas.memorySize;0===o$o&&0===o$r&&this._releaseMem()},o$r._getTransformMatrix=function(){return this._curMat},o$r.translate=function(o$o,o$r){0===o$o&&0===o$r||(o$g.save(this),this._curMat.bTransform&&(o$Q.save(this),this._curMat.transformPointN(o$t.TEMP.setTo(o$o,o$r)),o$o=o$t.TEMP.x,o$r=o$t.TEMP.y),this._x+=o$o,this._y+=o$r)},o$r.save=function(){this._save[this._save._length++]=o$Z.Create(this)},o$r.restore=function(){var o$o=this._save._length;if(!(o$o<1))for(var o$r=o$o-1;0<=o$r;o$r--){var o$T=this._save[o$r];if(o$T.restore(this),o$T.isSaveMark())return void(this._save._length=o$r)}},o$r._fillText=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){void 0===o$U&&(o$U=0);var o$h=this._shader2D,o$p=this._curSubmit.shaderValue,o$i=o$W?o$xo.create(o$W):this._other.font;if(o$Y.enabled)o$h.ALPHA!==o$p.ALPHA&&(o$h.glTexture=null),o$vo.drawText(this,o$o,o$r,this._curMat,o$i,o$L||this._other.textAlign,o$D,o$n,o$V,o$T,o$k,o$U);else{this._shader2D.defines.getValue();var o$v=o$D?o$x.create(o$D)._color:o$h.colorAdd;o$h.ALPHA===o$p.ALPHA&&o$v===o$h.colorAdd&&o$p.colorAdd===o$h.colorAdd||(o$h.glTexture=null,o$h.colorAdd=o$v),o$vo.drawText(this,o$o,o$r,this._curMat,o$i,o$L||this._other.textAlign,o$D,o$n,o$V,o$T,o$k,o$U)}},o$r.fillWords=function(o$o,o$r,o$T,o$k,o$W,o$D){this._fillText(null,o$o,o$r,o$T,o$k,o$W,null,-1,null,o$D)},o$r.fillBorderWords=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this._fillBorderText(null,o$o,o$r,o$T,o$k,o$W,o$D,o$n,null)},o$r.fillText=function(o$o,o$r,o$T,o$k,o$W,o$D){this._fillText(o$o,null,o$r,o$T,o$k,o$W,null,-1,o$D)},o$r.strokeText=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this._fillText(o$o,null,o$r,o$T,o$k,null,o$W,o$D||1,o$n)},o$r.fillBorderText=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){this._fillBorderText(o$o,null,o$r,o$T,o$k,o$W,o$D,o$n,o$V)},o$r._fillBorderText=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){if(!o$Y.enabled)return this._fillText(o$o,o$r,o$T,o$k,o$W,null,o$n,o$V||1,o$L),void this._fillText(o$o,o$r,o$T,o$k,o$W,o$D,null,-1,o$L);var o$U=this._shader2D,o$h=this._curSubmit.shaderValue;o$U.ALPHA!==o$h.ALPHA&&(o$U.glTexture=null);var o$p=o$W?(o$J._fontTemp.setFont(o$W),o$J._fontTemp):this._other.font;o$vo.drawText(this,o$o,o$r,this._curMat,o$p,o$L||this._other.textAlign,o$D,o$n,o$V||1,o$T,o$k,0)},o$r.fillRect=function(o$o,o$r,o$T,o$k,o$W){var o$D=this._vb;if(o$_o.fillRectImgVb(o$D,this._clipRect,o$o,o$r,o$T,o$k,o$X.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var o$n=this._shader2D.fillStyle;o$W&&(this._shader2D.fillStyle=o$N.create(o$W));var o$V=this._shader2D,o$L=this._curSubmit.shaderValue;if(o$V.fillStyle!==o$L.fillStyle||o$V.ALPHA!==o$L.ALPHA){o$V.glTexture=null;var o$U=this._curSubmit=o$Do.createSubmit(this,this._ib,o$D,(o$D._byteLength-64)/32*3,o$Fo.create(2,0));o$U.shaderValue.color=o$V.fillStyle._color._color,o$U.shaderValue.ALPHA=o$V.ALPHA,this._submits[this._submits._length++]=o$U}this._curSubmit._numEle+=6,this._shader2D.fillStyle=o$n}},o$r.fillTexture=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){if(o$o.loaded&&o$o.bitmap&&o$o.source){var o$L=this._vb,o$U=o$o.bitmap.width,o$h=o$o.bitmap.height,o$p=o$o.uv,o$i=o$n.x%o$o.width,o$v=o$n.y%o$o.height;if(o$U!=o$V.w||o$h!=o$V.h){if(!o$V.w&&!o$V.h)switch(o$V.oy=o$V.ox=0,o$D){case"repeat":o$V.width=o$k,o$V.height=o$W;break;case"repeat-x":o$V.width=o$k,o$v<0?o$o.height+o$v>o$W?o$V.height=o$W:o$V.height=o$o.height+o$v:(o$V.oy=o$v,o$o.height+o$v>o$W?o$V.height=o$W-o$v:o$V.height=o$o.height);break;case"repeat-y":o$i<0?o$o.width+o$i>o$k?o$V.width=o$k:o$V.width=o$o.width+o$i:(o$V.ox=o$i,o$o.width+o$i>o$k?o$V.width=o$k-o$i:o$V.width=o$o.width),o$V.height=o$W;break;case"no-repeat":o$i<0?o$o.width+o$i>o$k?o$V.width=o$k:o$V.width=o$o.width+o$i:(o$V.ox=o$i,o$o.width+o$i>o$k?o$V.width=o$k-o$i:o$V.width=o$o.width),o$v<0?o$o.height+o$v>o$W?o$V.height=o$W:o$V.height=o$o.height+o$v:(o$V.oy=o$v,o$o.height+o$v>o$W?o$V.height=o$W-o$v:o$V.height=o$o.height);break;default:o$V.width=o$k,o$V.height=o$W}o$V.w=o$U,o$V.h=o$h,o$V.uv=[0,0,o$V.width/o$U,0,o$V.width/o$U,o$V.height/o$h,0,o$V.height/o$h]}if(o$r+=o$V.ox,o$T+=o$V.oy,o$i-=o$V.ox,o$v-=o$V.oy,o$_o.fillRectImgVb(o$L,this._clipRect,o$r,o$T,o$V.width,o$V.height,o$V.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var o$x=o$Co.create(this,this._ib,o$L,(o$L._byteLength-64)/32*3,o$Fo.create(256,0)),o$j=(this._submits[this._submits._length++]=o$x).shaderValue;o$j.textureHost=o$o;var o$_=o$p[0]*o$U,o$K=o$p[1]*o$h,o$$=(o$p[2]-o$p[0])*o$U,o$y=(o$p[5]-o$p[3])*o$h,o$l=-o$i/o$U,o$S=-o$v/o$h;o$j.u_TexRange[0]=o$_/o$U,o$j.u_TexRange[1]=o$$/o$U,o$j.u_TexRange[2]=o$K/o$h,o$j.u_TexRange[3]=o$y/o$h,o$j.u_offset[0]=o$l,o$j.u_offset[1]=o$S,o$Y.enabled&&!this._isMain&&o$x.addTexture(o$o,(o$L._byteLength>>2)-16),(this._curSubmit=o$x)._renderType=10017,o$x._numEle+=6}}else this.sprite&&o$q.timer.callLater(this,this._repaintSprite)},o$r.setShader=function(o$o){o$a.save(this,1048576,this._shader2D,!0),this._shader2D.shader=o$o},o$r.setFilters=function(o$o){o$a.save(this,2097152,this._shader2D,!0),this._shader2D.filters=o$o,this._curSubmit=o$Do.RENDERBASE,this._renderKey=0,this._drawCount++},o$r.drawTexture=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this._drawTextureM(o$o,o$r,o$T,o$k,o$W,o$D,o$n,null,1)},o$r.addTextureVb=function(o$o,o$r,o$T){var o$k=this._curSubmit._vb||this._vb,o$W=o$k._byteLength>>2;o$k.byteLength=o$W+16<<2;for(var o$D=o$k.getFloat32Array(),o$n=0;o$n<16;o$n+=4)o$D[o$W++]=o$o[o$n]+o$r,o$D[o$W++]=o$o[o$n+1]+o$T,o$D[o$W++]=o$o[o$n+2],o$D[o$W++]=o$o[o$n+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),o$k._upload=!0},o$r.willDrawTexture=function(o$o,o$r){if(!(o$o.loaded&&o$o.bitmap&&o$o.source))return this.sprite&&o$q.timer.callLater(this,this._repaintSprite),0;var o$T=o$o.bitmap,o$k=o$T.id+this._shader2D.ALPHA*o$r+10016;if(o$k==this._renderKey)return o$k;var o$W=this._shader2D,o$D=o$W.ALPHA,o$n=this._curSubmit.shaderValue;o$W.ALPHA*=o$r,this._renderKey=o$k,this._drawCount++,o$W.glTexture=o$T;var o$V=this._vb,o$L=null,o$U=o$V._byteLength/32*3,o$h=o$n.textureHost&&o$n.textureHost==o$o&&o$n.textureHost.alphaTexture==o$o.alphaTexture;return o$L=o$Co.create(this,this._ib,o$V,o$U,o$Fo.create(1,0)),(this._submits[this._submits._length++]=o$L).shaderValue.textureHost=o$o,o$L._renderType=10016,o$L._preIsSameTextureShader=10016===this._curSubmit._renderType&&o$W.ALPHA===o$n.ALPHA&&o$h,this._curSubmit=o$L,o$W.ALPHA=o$D,o$k},o$r.drawTextures=function(o$o,o$r,o$T,o$k){if(o$o.loaded&&o$o.bitmap&&o$o.source){var o$W=this._clipRect;if(this._clipRect=o$J.MAXCLIPRECT,this._drawTextureM(o$o,o$r[0],o$r[1],o$o.width,o$o.height,o$T,o$k,null,1)){if(this._clipRect=o$W,o$s.drawCall++,!(o$r.length<4)){for(var o$D=this._curSubmit._vb||this._vb,o$n=this._curMat.a,o$V=this._curMat.d,o$L=2,o$U=o$r.length;o$L<o$U;o$L+=2)o$_o.copyPreImgVb(o$D,(o$r[o$L]-o$r[o$L-2])*o$n,(o$r[o$L+1]-o$r[o$L-1])*o$V),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&o$q.timer.callLater(this,this._repaintSprite)},o$r._drawTextureM=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){if(!o$o.loaded||!o$o.source)return this.sprite&&o$q.timer.callLater(this,this._repaintSprite),!1;var o$U=this._curSubmit._vb||this._vb,o$h=o$o.bitmap;o$r+=o$D,o$T+=o$n,this._drawCount++;var o$p=o$h.id+this._shader2D.ALPHA*o$L+10016;if(o$p!=this._renderKey){this._renderKey=o$p;var o$i=this._curSubmit.shaderValue,o$v=this._shader2D,o$x=o$v.ALPHA;o$v.ALPHA*=o$L,o$v.glTexture=o$h;var o$j=this._vb,o$_=null,o$K=o$j._byteLength/32*3,o$$=o$i.textureHost&&o$i.textureHost==o$o&&o$i.textureHost.alphaTexture==o$o.alphaTexture;o$_=o$Co.create(this,this._ib,o$j,o$K,o$Fo.create(1,0)),(this._submits[this._submits._length++]=o$_).shaderValue.textureHost=o$o,o$_._renderType=10016,o$_._preIsSameTextureShader=10016===this._curSubmit._renderType&&o$v.ALPHA===o$i.ALPHA&&o$$,this._curSubmit=o$_,o$U=this._curSubmit._vb||this._vb,o$v.ALPHA=o$x}return!!o$_o.fillRectImgVb(o$U,this._clipRect,o$r,o$T,o$k||o$o.width,o$W||o$o.height,o$o.uv,o$V||this._curMat,this._x,this._y,0,0)&&(o$Y.enabled&&!this._isMain&&this._curSubmit.addTexture(o$o,(o$U._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},o$r._repaintSprite=function(){this.sprite&&this.sprite.repaint()},o$r._drawText=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){var o$h=o$o.bitmap;this._drawCount++;var o$p=o$h.id+this._shader2D.ALPHA+10016;if(o$p!=this._renderKey){this._renderKey=o$p;var o$i=this._curSubmit.shaderValue,o$v=this._shader2D;o$v.glTexture=o$h;var o$x=this._vb,o$j=null,o$_=o$x._byteLength/32*3,o$K=o$i.textureHost&&o$i.textureHost==o$o&&o$i.textureHost.alphaTexture==o$o.alphaTexture;(o$j=o$Y.enabled?o$Co.create(this,this._ib,o$x,o$_,o$Fo.create(1,0)):o$Co.create(this,this._ib,o$x,o$_,o$go.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&o$v.ALPHA===o$i.ALPHA&&o$K,(this._submits[this._submits._length++]=o$j).shaderValue.textureHost=o$o,o$j._renderType=10016,this._curSubmit=o$j}o$o.active();var o$$=this._curSubmit._vb||this._vb;o$_o.fillRectImgVb(o$$,this._clipRect,o$r+o$n,o$T+o$V,o$k||o$o.width,o$W||o$o.height,o$o.uv,o$D||this._curMat,this._x,this._y,o$L,o$U,!0)&&(o$Y.enabled&&!this._isMain&&this._curSubmit.addTexture(o$o,(o$$._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},o$r.drawTextureWithTransform=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){if(o$D){var o$U=this._curMat,o$h=this._x,o$p=this._y;(0!==o$n||0!==o$V)&&(this._x=o$n*o$U.a+o$V*o$U.c,this._y=o$V*o$U.d+o$n*o$U.b),o$D&&o$U.bTransform?(o$P.mul(o$D,o$U,o$J._tmpMatrix),(o$D=o$J._tmpMatrix)._checkTransform()):(this._x+=o$U.tx,this._y+=o$U.ty),this._drawTextureM(o$o,o$r,o$T,o$k,o$W,0,0,o$D,o$L),this._x=o$h,this._y=o$p}else this._drawTextureM(o$o,o$r,o$T,o$k,o$W,o$n,o$V,null,o$L)},o$r.fillQuadrangle=function(o$o,o$r,o$T,o$k,o$W){var o$D=this._curSubmit,o$n=this._vb,o$V=this._shader2D,o$L=o$D.shaderValue;if(this._renderKey=0,o$o.bitmap){var o$U=o$o.bitmap;o$V.glTexture==o$U&&o$V.ALPHA===o$L.ALPHA||(o$V.glTexture=o$U,(o$D=this._curSubmit=o$Do.createSubmit(this,this._ib,o$n,o$n._byteLength/32*3,o$Fo.create(1,0))).shaderValue.glTexture=o$U,this._submits[this._submits._length++]=o$D),o$_o.fillQuadrangleImgVb(o$n,o$r,o$T,o$k,o$o.uv,o$W||this._curMat,this._x,this._y)}else o$D.shaderValue.fillStyle&&o$D.shaderValue.fillStyle.equal(o$o)&&o$V.ALPHA===o$L.ALPHA||(o$V.glTexture=null,(o$D=this._curSubmit=o$Do.createSubmit(this,this._ib,o$n,o$n._byteLength/32*3,o$Fo.create(2,0))).shaderValue.defines.add(2),o$D.shaderValue.fillStyle=o$N.create(o$o),this._submits[this._submits._length++]=o$D),o$_o.fillQuadrangleImgVb(o$n,o$r,o$T,o$k,o$X.DEF_UV,o$W||this._curMat,this._x,this._y);o$D._numEle+=6},o$r.drawTexture2=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){if(0!=o$D){var o$L=this._curMat;if(this._x=o$o*o$L.a+o$r*o$L.c,this._y=o$r*o$L.d+o$o*o$L.b,o$W&&(o$W=o$L.bTransform||o$W.bTransform?(o$P.mul(o$W,o$L,o$J._tmpMatrix),o$J._tmpMatrix):(this._x+=o$W.tx+o$L.tx,this._y+=o$W.ty+o$L.ty,o$P.EMPTY)),1!==o$D||o$n){var o$U=this._shader2D.ALPHA,o$h=this._nBlendType;this._shader2D.ALPHA=o$D,o$n&&(this._nBlendType=o$I.TOINT(o$n)),this._drawTextureM(o$V[0],o$V[1]-o$T,o$V[2]-o$k,o$V[3],o$V[4],0,0,o$W,1),this._shader2D.ALPHA=o$U,this._nBlendType=o$h}else this._drawTextureM(o$V[0],o$V[1]-o$T,o$V[2]-o$k,o$V[3],o$V[4],0,0,o$W,1);this._x=this._y=0}},o$r.drawCanvas=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$o.context;if(this._renderKey=0,o$D._targets)this._submits[this._submits._length++]=o$mo.create(o$D,0,null),this._curSubmit=o$Do.RENDERBASE,o$D._targets.drawTo(this,o$r,o$T,o$k,o$W);else{var o$n=this._submits[this._submits._length++]=o$mo.create(o$D,this._shader2D.ALPHA,this._shader2D.filters),o$V=o$k/o$o.width,o$L=o$W/o$o.height,o$U=o$n._matrix;this._curMat.copyTo(o$U),1!=o$V&&1!=o$L&&o$U.scale(o$V,o$L);var o$h=o$U.tx,o$p=o$U.ty;o$U.tx=o$U.ty=0,o$U.transformPoint(o$t.TEMP.setTo(o$r,o$T)),o$U.translate(o$t.TEMP.x+o$h,o$t.TEMP.y+o$p),this._curSubmit=o$Do.RENDERBASE}o$b.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=o$D._targets?"yellow":"green",this.strokeRect(o$r-1,o$T-1,o$k+2,o$W+2,1),this.strokeRect(o$r,o$T,o$k,o$W,1),this.restore())},o$r.drawTarget=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){void 0===o$U&&(o$U=-1);var o$h=this._vb;if(o$_o.fillRectImgVb(o$h,this._clipRect,o$r,o$T,o$k,o$W,o$L||o$X.DEF_UV,o$D||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var o$p=this._curSubmit=o$po.create(this,this._ib,o$h,(o$h._byteLength-64)/32*3,o$V,o$n);o$p.blendType=-1==o$U?this._nBlendType:o$U,o$p.scope=o$o,this._submits[this._submits._length++]=o$p,this._curSubmit._numEle+=6}},o$r.mixRGBandAlpha=function(o$o){return this._mixRGBandAlpha(o$o,this._shader2D.ALPHA)},o$r._mixRGBandAlpha=function(o$o,o$r){var o$T=(4278190080&o$o)>>>24;return 0!=o$T?o$T*=o$r:o$T=255*o$r,16777215&o$o|o$T<<24},o$r.drawTriangles=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){if(!o$o.loaded||!o$o.source)return this.sprite&&o$q.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;o$o.bitmap;var o$h=this._mixRGBandAlpha(4294967295,o$V),o$p=(o$k.length,o$D.length);this._renderKey=-1;var o$i=this._curSubmit=o$Co.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,o$Fo.create(1,0));return o$i.shaderValue.textureHost=o$o,o$i._renderType=10016,this._submits[this._submits._length++]=o$i,o$n?(o$J._tmpMatrix.a=o$n.a,o$J._tmpMatrix.b=o$n.b,o$J._tmpMatrix.c=o$n.c,o$J._tmpMatrix.d=o$n.d,o$J._tmpMatrix.tx=o$n.tx+o$r,o$J._tmpMatrix.ty=o$n.ty+o$T,o$P.mul(o$J._tmpMatrix,this._curMat,o$J._tmpMatrix)):(o$J._tmpMatrix.a=this._curMat.a,o$J._tmpMatrix.b=this._curMat.b,o$J._tmpMatrix.c=this._curMat.c,o$J._tmpMatrix.d=this._curMat.d,o$J._tmpMatrix.tx=this._curMat.tx+o$r,o$J._tmpMatrix.ty=this._curMat.ty+o$T),this._triangleMesh.addData(o$k,o$W,o$D,o$J._tmpMatrix,o$h,this),this._curSubmit._numEle+=o$p,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},o$r.transform=function(o$o,o$r,o$T,o$k,o$W,o$D){o$Q.save(this),o$P.mul(o$P.TEMP.setTo(o$o,o$r,o$T,o$k,o$W,o$D),this._curMat,this._curMat),this._curMat._checkTransform()},o$r.setTransformByMatrix=function(o$o){o$o.copyTo(this._curMat)},o$r.transformByMatrix=function(o$o){o$Q.save(this),o$P.mul(o$o,this._curMat,this._curMat),this._curMat._checkTransform()},o$r.rotate=function(o$o){o$Q.save(this),this._curMat.rotateEx(o$o)},o$r.scale=function(o$o,o$r){o$Q.save(this),this._curMat.scaleEx(o$o,o$r)},o$r.clipRect=function(o$o,o$r,o$T,o$k){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var o$W=o$ho.create(4);this.addRenderObject(o$W);var o$D=this._vb,o$n=o$D._byteLength>>2;if(o$_o.fillRectImgVb(o$D,null,o$o,o$r,o$T,o$k,o$X.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var o$V=this._curSubmit=o$Do.createSubmit(this,this._ib,o$D,(o$D._byteLength-64)/32*3,o$Fo.create(2,0));o$V.shaderValue.ALPHA=1,this._submits[this._submits._length++]=o$V,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var o$L=o$ho.create(5);this.addRenderObject(o$L);var o$U=o$D.getFloat32Array(),o$h=Math.min(Math.min(Math.min(o$U[0+o$n],o$U[4+o$n]),o$U[8+o$n]),o$U[12+o$n]),o$p=Math.max(Math.max(Math.max(o$U[0+o$n],o$U[4+o$n]),o$U[8+o$n]),o$U[12+o$n]),o$i=Math.min(Math.min(Math.min(o$U[1+o$n],o$U[5+o$n]),o$U[9+o$n]),o$U[13+o$n]),o$v=Math.max(Math.max(Math.max(o$U[1+o$n],o$U[5+o$n]),o$U[9+o$n]),o$U[13+o$n]);o$w.save(this,o$L,o$o,o$r,o$T,o$k,o$h,o$i,o$p-o$h,o$v-o$i),this._curSubmit=o$Do.RENDERBASE}else{o$T*=this._curMat.a,o$k*=this._curMat.d;var o$x=o$t.TEMP;this._curMat.transformPoint(o$x.setTo(o$o,o$r)),o$T<0&&(o$x.x=o$x.x+o$T,o$T=-o$T),o$k<0&&(o$x.y=o$x.y+o$k,o$k=-o$k),this._renderKey=0;var o$j=this._curSubmit=o$Uo.create(this);(this._submits[this._submits._length++]=o$j).submitIndex=this._submits._length,o$j.submitLength=9999999,o$G.save(this,o$j);var o$_=this._clipRect,o$K=o$_.x,o$$=o$_.y,o$y=o$x.x+o$T,o$l=o$x.y+o$k;o$K<o$x.x&&(o$_.x=o$x.x),o$$<o$x.y&&(o$_.y=o$x.y),o$_.width=Math.min(o$y,o$K+o$_.width)-o$_.x,o$_.height=Math.min(o$l,o$$+o$_.height)-o$_.y,this._shader2D.glTexture=null,o$j.clipRect.copyFrom(o$_),this._curSubmit=o$Do.RENDERBASE}},o$r.setIBVB=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h){if(void 0===o$L&&(o$L=0),void 0===o$U&&(o$U=0),void 0===o$h&&(o$h=0),null===o$T){if(o$K.isFlash){var o$p=o$k;o$p._selfIB||(o$p._selfIB=o$Eo.create(35044)),o$p._selfIB.clear(),o$T=o$p._selfIB}else o$T=this._ib;o$_o.expandIBQuadrangle(o$T,o$k._byteLength/(4*o$k.vertexStride*4))}if(!o$V||!o$n)throw Error("setIBVB must input:shader shaderValues");var o$i=o$Lo.create(this,o$k,o$T,o$W,o$n,o$V,o$L,o$U,o$h);o$D||(o$D=o$P.EMPTY),o$D.translate(o$o,o$r),o$P.mul(o$D,this._curMat,o$i._mat),o$D.translate(-o$o,-o$r),this._submits[this._submits._length++]=o$i,this._curSubmit=o$Do.RENDERBASE,this._renderKey=0},o$r.addRenderObject=function(o$o){this._submits[this._submits._length++]=o$o},o$r.fillTrangles=function(o$o,o$r,o$T,o$k,o$W){var o$D=this._curSubmit,o$n=this._vb,o$V=this._shader2D,o$L=o$D.shaderValue,o$U=o$k.length>>4,o$h=o$o.bitmap;this._renderKey=0,o$V.glTexture==o$h&&o$V.ALPHA===o$L.ALPHA||((o$D=this._curSubmit=o$Do.createSubmit(this,this._ib,o$n,o$n._byteLength/32*3,o$Fo.create(1,0))).shaderValue.textureHost=o$o,this._submits[this._submits._length++]=o$D),o$_o.fillTranglesVB(o$n,o$r,o$T,o$k,o$W||this._curMat,this._x,this._y),o$D._numEle+=6*o$U},o$r.submitElement=function(o$o,o$r){var o$T=this._submits;for(o$r<0&&(o$r=o$T._length);o$o<o$r;)o$o+=o$T[o$o].renderSubmit()},o$r.finish=function(){o$lo.mainContext.finish()},o$r.flush=function(){var o$o=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(o$o>this._ib.bufferLength/12&&o$_o.expandIBQuadrangle(this._ib,o$o),!this._isMain&&o$Y.enabled&&o$Y._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=o$Y._atlasRestore;for(var o$r=this._submits,o$T=0,o$k=o$r._length;o$T<o$k;o$T++){var o$W=o$r[o$T];10016===o$W.getRenderType()&&o$W.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),o$ro.instance&&o$ro.getInstance().reset();var o$D;for(o$T=0,o$D=this.meshlist.length;o$T<o$D;o$T++){var o$n=this.meshlist[o$T];o$n.canReuse?o$n.releaseMesh():o$n.destroy()}return this.meshlist.length=0,this._curSubmit=o$Do.RENDERBASE,this._renderKey=0,this._triangleMesh=o$Xo.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},o$r.setPathId=function(o$o){if(this.mId=o$o,-1!=this.mId){this.mHaveKey=!1;var o$r=o$M.getInstance();o$r.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,o$r.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},o$r.movePath=function(o$o,o$r){var o$T=o$o,o$k=o$r;o$o=this._curMat.a*o$T+this._curMat.c*o$k+this._curMat.tx,o$r=this._curMat.b*o$T+this._curMat.d*o$k+this._curMat.ty,this.mX+=o$o,this.mY+=o$r},o$r.beginPath=function(){var o$o=this._getPath();o$o.tempArray.length=0,o$o.closePath=!1,this.mX=0,this.mY=0},o$r.closePath=function(){this._path.closePath=!0},o$r.fill=function(o$o){void 0===o$o&&(o$o=!1);var o$r=this._getPath();this.drawPoly(0,0,o$r.tempArray,this.fillStyle._color.numColor,0,0,o$o)},o$r.stroke=function(){var o$o=this._getPath();if(0<this.lineWidth){if(-1==this.mId)o$o.drawLine(0,0,o$o.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var o$r=o$M.getInstance().shapeLineDic[this.mId];o$r.rebuild(o$o.tempArray),o$o.setGeomtry(o$r)}else o$M.getInstance().addLine(this.mId,o$o.drawLine(0,0,o$o.tempArray,this.lineWidth,this.strokeStyle._color.numColor));o$o.update();var o$T=[this.mX,this.mY],o$k=o$Do.createShape(this,o$o.ib,o$o.vb,o$o.count,o$o.offset,o$Fo.create(4,0));o$k.shaderValue.ALPHA=this._shader2D.ALPHA,o$k.shaderValue.u_pos=o$T,o$k.shaderValue.u_mmat2=o$$o.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=o$k,this._renderKey=-1}},o$r.line=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=this._curSubmit,o$V=this._vb;if(o$_o.fillLineVb(o$V,this._clipRect,o$o,o$r,o$T,o$k,o$W,o$D)){this._renderKey=0;var o$L=this._shader2D,o$U=o$n.shaderValue;o$L.strokeStyle===o$U.strokeStyle&&o$L.ALPHA===o$U.ALPHA||(o$L.glTexture=null,(o$n=this._curSubmit=o$Do.createSubmit(this,this._ib,o$V,(o$V._byteLength-64)/32*3,o$Fo.create(2,0))).shaderValue.strokeStyle=o$L.strokeStyle,o$n.shaderValue.mainID=2,o$n.shaderValue.ALPHA=o$L.ALPHA,this._submits[this._submits._length++]=o$n),o$n._numEle+=6}},o$r.moveTo=function(o$o,o$r,o$T){void 0===o$T&&(o$T=!0);var o$k=this._getPath();if(o$T){var o$W=o$o,o$D=o$r;o$o=this._curMat.a*o$W+this._curMat.c*o$D,o$r=this._curMat.b*o$W+this._curMat.d*o$D}o$k.addPoint(o$o,o$r)},o$r.lineTo=function(o$o,o$r,o$T){void 0===o$T&&(o$T=!0);var o$k=this._getPath();if(o$T){var o$W=o$o,o$D=o$r;o$o=this._curMat.a*o$W+this._curMat.c*o$D,o$r=this._curMat.b*o$W+this._curMat.d*o$D}o$k.addPoint(o$o,o$r)},o$r.drawCurves=function(o$o,o$r,o$T){this.setPathId(-1),this.beginPath(),this.strokeStyle=o$T[3],this.lineWidth=o$T[4];var o$k=o$T[2];o$o+=o$T[0],o$r+=o$T[1],this.movePath(o$o,o$r),this.moveTo(o$k[0],o$k[1]);for(var o$W=2,o$D=o$k.length;o$W<o$D;)this.quadraticCurveTo(o$k[o$W++],o$k[o$W++],o$k[o$W++],o$k[o$W++]);this.stroke()},o$r.arcTo=function(o$o,o$r,o$T,o$k,o$W){if(-1==this.mId||!this.mHaveKey){var o$D=0,o$n=0,o$V=0,o$L=this._getPath();this._curMat.copyTo(o$J._tmpMatrix),o$J._tmpMatrix.tx=o$J._tmpMatrix.ty=0,o$J._tempPoint.setTo(o$L.getEndPointX(),o$L.getEndPointY()),o$J._tmpMatrix.invertTransformPoint(o$J._tempPoint);var o$U=o$J._tempPoint.x-o$o,o$h=o$J._tempPoint.y-o$r,o$p=Math.sqrt(o$U*o$U+o$h*o$h);if(!(o$p<=1e-6)){var o$i=o$U/o$p,o$v=o$h/o$p,o$x=o$T-o$o,o$j=o$k-o$r,o$_=o$x*o$x+o$j*o$j,o$K=Math.sqrt(o$_);if(!(o$K<=1e-6)){var o$$=o$x/o$K,o$y=o$j/o$K,o$l=o$i+o$$,o$S=o$v+o$y,o$q=Math.sqrt(o$l*o$l+o$S*o$S);if(!(o$q<=1e-6)){var o$b=o$l/o$q,o$F=o$S/o$q,o$P=Math.acos(o$b*o$i+o$F*o$v),o$t=Math.PI/2-o$P,o$H=(o$p=o$W/Math.tan(o$t))*o$i+o$o,o$R=o$p*o$v+o$r,o$u=Math.sqrt(o$p*o$p+o$W*o$W),o$s=o$o+o$b*o$u,o$z=o$r+o$F*o$u,o$m=0,o$C=0;if(0<=o$i*o$y-o$v*o$$){var o$X=2*o$t/o$J.SEGNUM;o$m=Math.sin(o$X),o$C=Math.cos(o$X)}else o$X=2*-o$t/o$J.SEGNUM,o$m=Math.sin(o$X),o$C=Math.cos(o$X);o$n=this._curMat.a*o$H+this._curMat.c*o$R,o$V=this._curMat.b*o$H+this._curMat.d*o$R,o$n==this._path.getEndPointX()&&o$V==this._path.getEndPointY()||o$L.addPoint(o$n,o$V);var o$O=o$H-o$s,o$M=o$R-o$z;for(o$D=0;o$D<o$J.SEGNUM;o$D++){var o$c=o$O*o$C+o$M*o$m,o$e=-o$O*o$m+o$M*o$C;o$n=o$c+o$s,o$V=o$e+o$z,o$o=this._curMat.a*o$n+this._curMat.c*o$V,o$V=o$r=this._curMat.b*o$n+this._curMat.d*o$V,(o$n=o$o)==this._path.getEndPointX()&&o$V==this._path.getEndPointY()||o$L.addPoint(o$n,o$V),o$O=o$c,o$M=o$e}}}}}},o$r.arc=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){if(void 0===o$D&&(o$D=!1),void 0===o$n&&(o$n=!0),-1!=this.mId){var o$V=o$M.getInstance().shapeDic[this.mId];if(o$V&&this.mHaveKey&&!o$V.needUpdate(this._curMat))return;o$r=o$o=0}var o$L,o$U=0,o$h=0,o$p=0,o$i=0,o$v=0,o$x=0,o$j=0;if(o$h=o$W-o$k,o$D)if(Math.abs(o$h)>=2*Math.PI)o$h=2*-Math.PI;else for(;0<o$h;)o$h-=2*Math.PI;else if(Math.abs(o$h)>=2*Math.PI)o$h=2*Math.PI;else for(;o$h<0;)o$h+=2*Math.PI;o$L=o$h/(o$j=o$T<101?Math.max(10,o$h*o$T/5):o$T<201?Math.max(10,o$h*o$T/20):Math.max(10,o$h*o$T/40))/2,o$p=Math.abs(4/3*(1-Math.cos(o$L))/Math.sin(o$L)),o$D&&(o$p=-o$p);var o$_=this._getPath(),o$K=NaN,o$$=NaN;for(o$x=0;o$x<=o$j;o$x++)o$U=o$k+o$h*(o$x/o$j),o$i=o$o+Math.cos(o$U)*o$T,o$v=o$r+Math.sin(o$U)*o$T,o$n&&(o$K=o$i,o$$=o$v,o$i=this._curMat.a*o$K+this._curMat.c*o$$,o$v=this._curMat.b*o$K+this._curMat.d*o$$),o$i==this._path.getEndPointX()&&o$v==this._path.getEndPointY()||o$_.addPoint(o$i,o$v);o$i=o$o+Math.cos(o$W)*o$T,o$v=o$r+Math.sin(o$W)*o$T,o$n&&(o$K=o$i,o$$=o$v,o$i=this._curMat.a*o$K+this._curMat.c*o$$,o$v=this._curMat.b*o$K+this._curMat.d*o$$),o$i==this._path.getEndPointX()&&o$v==this._path.getEndPointY()||o$_.addPoint(o$i,o$v)},o$r.quadraticCurveTo=function(o$o,o$r,o$T,o$k){var o$W=o$p.I,o$D=o$T,o$n=o$k;o$T=this._curMat.a*o$D+this._curMat.c*o$n,o$k=this._curMat.b*o$D+this._curMat.d*o$n,o$D=o$o,o$n=o$r,o$o=this._curMat.a*o$D+this._curMat.c*o$n,o$r=this._curMat.b*o$D+this._curMat.d*o$n;for(var o$V=o$W.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),o$o,o$r,o$T,o$k],30,2),o$L=0,o$U=o$V.length/2;o$L<o$U;o$L++)this.lineTo(o$V[2*o$L],o$V[2*o$L+1],!1);this.lineTo(o$T,o$k,!1)},o$r.rect=function(o$o,o$r,o$T,o$k){this._other=this._other.make(),this._other.path||(this._other.path=new o$f),this._other.path.rect(o$o,o$r,o$T,o$k)},o$r.strokeRect=function(o$o,o$r,o$T,o$k,o$W){var o$D=.5*o$W;this.line(o$o-o$D,o$r,o$o+o$T+o$D,o$r,o$W,this._curMat),this.line(o$o+o$T,o$r,o$o+o$T,o$r+o$k,o$W,this._curMat),this.line(o$o,o$r,o$o,o$r+o$k,o$W,this._curMat),this.line(o$o-o$D,o$r+o$k,o$o+o$T+o$D,o$r+o$k,o$W,this._curMat)},o$r.clip=function(){},o$r.drawPoly=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){void 0===o$n&&(o$n=!1),this._renderKey=0,this._shader2D.glTexture=null;var o$V=this._getPath();if(-1==this.mId)o$V.polygon(o$o,o$r,o$T,o$k,o$W||1,o$D);else if(this.mHaveKey){var o$L=o$M.getInstance().shapeDic[this.mId];o$L.setMatrix(this._curMat),o$L.rebuild(o$V.tempArray),o$V.setGeomtry(o$L)}else{var o$U=o$V.polygon(o$o,o$r,o$T,o$k,o$W||1,o$D);o$M.getInstance().addShape(this.mId,o$U),o$U.setMatrix(this._curMat)}o$V.update();var o$h,o$p=[this.mX,this.mY];if((o$h=o$Do.createShape(this,o$V.ib,o$V.vb,o$V.count,o$V.offset,o$Fo.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,o$h.shaderValue.u_pos=o$p,o$h.shaderValue.u_mmat2=o$$o.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=o$h,0<o$W){if(this.mHaveLineKey){var o$i=o$M.getInstance().shapeLineDic[this.mId];o$i.rebuild(o$V.tempArray),o$V.setGeomtry(o$i)}else o$M.getInstance().addShape(this.mId,o$V.drawLine(o$o,o$r,o$T,o$W,o$D));o$V.update(),(o$h=o$Do.createShape(this,o$V.ib,o$V.vb,o$V.count,o$V.offset,o$Fo.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,o$h.shaderValue.u_mmat2=o$$o.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=o$h}},o$r.drawParticle=function(o$o,o$r,o$T){o$T.x=o$o,o$T.y=o$r,this._submits[this._submits._length++]=o$T},o$r._getPath=function(){return this._path||(this._path=new o$f)},o$k(0,o$r,"globalCompositeOperation",function(){return o$I.NAMES[this._nBlendType]},function(o$o){var o$r=o$I.TOINT[o$o];null==o$r||this._nBlendType===o$r||(o$a.save(this,65536,this,!0),this._curSubmit=o$Do.RENDERBASE,this._renderKey=0,this._nBlendType=o$r)}),o$k(0,o$r,"strokeStyle",function(){return this._shader2D.strokeStyle},function(o$o){this._shader2D.strokeStyle.equal(o$o)||(o$a.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=o$N.create(o$o))}),o$k(0,o$r,"globalAlpha",function(){return this._shader2D.ALPHA},function(o$o){(o$o=Math.floor(1e3*o$o)/1e3)!=this._shader2D.ALPHA&&(o$a.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=o$o)}),o$k(0,o$r,"asBitmap",null,function(o$o){if(o$o){if(this._targets||(this._targets=new o$B),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),o$k(0,o$r,"fillStyle",function(){return this._shader2D.fillStyle},function(o$o){this._shader2D.fillStyle.equal(o$o)||(o$a.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=o$N.create(o$o))}),o$k(0,o$r,"textAlign",function(){return this._other.textAlign},function(o$o){this._other.textAlign===o$o||(this._other=this._other.make(),o$a.save(this,32768,this._other,!1),this._other.textAlign=o$o)}),o$k(0,o$r,"lineWidth",function(){return this._other.lineWidth},function(o$o){this._other.lineWidth===o$o||(this._other=this._other.make(),o$a.save(this,256,this._other,!1),this._other.lineWidth=o$o)}),o$k(0,o$r,"textBaseline",function(){return this._other.textBaseline},function(o$o){this._other.textBaseline===o$o||(this._other=this._other.make(),o$a.save(this,16384,this._other,!1),this._other.textBaseline=o$o)}),o$k(0,o$r,"font",null,function(o$o){o$o!=this._other.font.toString()&&(this._other=this._other.make(),o$a.save(this,8,this._other,!1),this._other.font===o$xo.EMPTY?this._other.font=new o$xo(o$o):this._other.font.setFont(o$o))}),o$J.__init__=function(){o$T.DEFAULT=new o$T},o$J._tempPoint=new o$t,o$J._SUBMITVBSIZE=32e3,o$J._MAXSIZE=99999999,o$J._RECTVBSIZE=16,o$J.MAXCLIPRECT=new o$H(0,0,99999999,99999999),o$J._COUNT=0,o$J._tmpMatrix=new o$P,o$J.SEGNUM=32,o$J._contextcount=0,o$n(o$J,["_fontTemp",function(){return this._fontTemp=new o$xo},"_drawStyleTemp",function(){return this._drawStyleTemp=new o$N(null)}]),o$J.__init$=function(){o$T=function(){function o$o(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=o$xo.EMPTY}o$i(o$o,"");var o$r=o$o.prototype;return o$r.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=o$xo.EMPTY},o$r.make=function(){return this===o$o.DEFAULT?new o$o:this},o$o.DEFAULT=null,o$o}()},o$J}(),o$Fo=function(o$o){function o$k(o$o,o$r){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,o$k.__super.call(this),this.defines=new o$Ro,this.position=o$k._POSITION,this.mainID=o$o,this.subID=o$r,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=o$o|o$r,this._inClassCache=o$k._cache[this._cacheID],0<o$o&&!this._inClassCache&&(this._inClassCache=o$k._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}o$i(o$k,"laya.webgl.shader.d2.value.Value2D",o$e);var o$r=o$k.prototype;return o$r.setValue=function(o$o){},o$r.refresh=function(){var o$o=this.size;return o$o[0]=o$$o.width,o$o[1]=o$$o.height,this.alpha=this.ALPHA*o$$o.worldAlpha,this.mmat=o$$o.worldMatrix4,this},o$r._ShaderWithCompile=function(){return o$Zo.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,o$Bo.create)},o$r._withWorldShaderDefines=function(){var o$o=o$$o.worldShaderDefines,o$r=o$Zo.sharders[this.mainID|this.defines._value|o$o.getValue()];if(!o$r){var o$T,o$k={};for(o$T in this.defines.toNameDic())o$k[o$T]="";for(o$T in o$o.toNameDic())o$k[o$T]="";o$r=o$Zo.withCompile2D(0,this.mainID,o$k,this.mainID|this.defines._value|o$o.getValue(),o$Bo.create)}var o$W=o$$o.worldFilters;if(!o$W)return o$r;for(var o$D,o$n=o$W.length,o$V=0;o$V<o$n;o$V++)(o$D=o$W[o$V])&&o$D.action.setValue(this);return o$r},o$r.upload=function(){var o$o=o$$o;this.alpha=this.ALPHA*o$o.worldAlpha,o$$o.worldMatrix4!==o$$o.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),o$lo.shaderHighPrecision&&this.defines.add(1024);var o$r,o$T=o$o.worldShaderDefines?this._withWorldShaderDefines():o$Zo.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=o$o.width,this.size[1]=o$o.height,this.mmat=o$o.worldMatrix4,o$Oo.activeShader!==o$T?o$T._shaderValueWidth!==o$o.width||o$T._shaderValueHeight!==o$o.height?(o$T._shaderValueWidth=o$o.width,o$T._shaderValueHeight=o$o.height):o$r=o$T._params2dQuick2||o$T._make2dQuick2():o$T._shaderValueWidth!==o$o.width||o$T._shaderValueHeight!==o$o.height?(o$T._shaderValueWidth=o$o.width,o$T._shaderValueHeight=o$o.height):o$r=o$T._params2dQuick1||o$T._make2dQuick1(),o$T.upload(this,o$r)},o$r.setFilters=function(o$o){if(this.filters=o$o)for(var o$r,o$T=o$o.length,o$k=0;o$k<o$T;o$k++)(o$r=o$o[o$k])&&(this.defines.add(o$r.type),o$r.action.setValue(this))},o$r.clear=function(){this.defines.setValue(this.subID)},o$r.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},o$k._initone=function(o$o,o$r){o$k._typeClass[o$o]=o$r,o$k._cache[o$o]=[],o$k._cache[o$o]._length=0},o$k.__init__=function(){o$k._POSITION=[2,5126,!1,4*o$jo.BYTES_PE,0],o$k._TEXCOORD=[2,5126,!1,4*o$jo.BYTES_PE,2*o$jo.BYTES_PE],o$k._initone(2,o$Jo),o$k._initone(4,o$Io),o$k._initone(256,o$Yo),o$k._initone(512,o$eo),o$k._initone(1,o$Ao),o$k._initone(65,o$go),o$k._initone(9,o$Ao)},o$k.create=function(o$o,o$r){var o$T=o$k._cache[o$o|o$r];return o$T._length?o$T[--o$T._length]:new o$k._typeClass[o$o|o$r](o$r)},o$k._POSITION=null,o$k._TEXCOORD=null,o$k._cache=[],o$k._typeClass=[],o$k.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o$k}(),o$Po=function(o$o){function o$_(o$o,o$r){o$_.__super.call(this,o$o,o$r)}o$i(o$_,"laya.webgl.utils.RenderSprite3D",o$$);var o$r=o$_.prototype;return o$r.onCreate=function(o$o){switch(o$o){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},o$r._mask=function(o$o,o$r,o$T,o$k){var o$W,o$D,o$n=this._next,o$V=o$o.mask;if(o$V){o$r.ctx.save();var o$L=o$r.ctx.globalCompositeOperation,o$U=new o$H;if(o$U.copyFrom(o$V.getBounds()),o$U.width=Math.round(o$U.width),o$U.height=Math.round(o$U.height),o$U.x=Math.round(o$U.x),o$U.y=Math.round(o$U.y),0<o$U.width&&0<o$U.height){var o$h=o$o._style._tf,o$p=o$Vo.create();o$p.addValue("bounds",o$U),o$W=o$no.create([o$p,o$r],laya.webgl.utils.RenderSprite3D.tmpTarget),o$r.addRenderObject(o$W),o$V.render(o$r,-o$U.x,-o$U.y),o$W=o$no.create([o$p],laya.webgl.utils.RenderSprite3D.endTmpTarget),o$r.addRenderObject(o$W),o$r.ctx.save(),o$r.clipRect(o$T-o$h.translateX+o$U.x,o$k-o$h.translateY+o$U.y,o$U.width,o$U.height),o$n._fun.call(o$n,o$o,o$r,o$T,o$k),o$r.ctx.restore(),o$D=o$ho.create(6),o$L=o$r.ctx.globalCompositeOperation,o$D.blendMode="mask",o$r.addRenderObject(o$D),o$P.TEMP.identity();var o$i=o$Fo.create(1,0),o$v=o$X.INV_UV,o$x=o$U.width,o$j=o$U.height;(o$U.width<32||o$U.height<32)&&((o$v=o$_.tempUV)[0]=0,o$v[1]=0,o$v[2]=32<=o$U.width?1:o$U.width/32,o$v[3]=0,o$v[4]=32<=o$U.width?1:o$U.width/32,o$v[5]=32<=o$U.height?1:o$U.height/32,o$v[6]=0,o$v[7]=32<=o$U.height?1:o$U.height/32,o$U.width=32<=o$U.width?o$U.width:32,o$U.height=32<=o$U.height?o$U.height:32,o$v[1]*=-1,o$v[3]*=-1,o$v[5]*=-1,o$v[7]*=-1,o$v[1]+=1,o$v[3]+=1,o$v[5]+=1,o$v[7]+=1),o$r.ctx.drawTarget(o$p,o$T+o$U.x-o$h.translateX,o$k+o$U.y-o$h.translateY,o$x,o$j,o$P.TEMP,"tmpTarget",o$i,o$v,6),o$W=o$no.create([o$p],laya.webgl.utils.RenderSprite3D.recycleTarget),o$r.addRenderObject(o$W),(o$D=o$ho.create(6)).blendMode=o$L,o$r.addRenderObject(o$D)}o$r.ctx.restore()}else o$n._fun.call(o$n,o$o,o$r,o$T,o$k)},o$r._blend=function(o$o,o$r,o$T,o$k){var o$W=o$o._style,o$D=this._next;o$W.blendMode?(o$r.ctx.save(),o$r.ctx.globalCompositeOperation=o$W.blendMode,o$D._fun.call(o$D,o$o,o$r,o$T,o$k),o$r.ctx.restore()):o$D._fun.call(o$D,o$o,o$r,o$T,o$k)},o$r._transform=function(o$o,o$r,o$T,o$k){var o$W=o$o.transform,o$D=this._next;if(o$W&&o$D!=o$$.NORENDER){var o$n=o$r.ctx;o$o._style;o$W.tx=o$T,o$W.ty=o$k;var o$V=o$n._getTransformMatrix(),o$L=o$V.clone();o$P.mul(o$W,o$V,o$V),o$V._checkTransform(),o$W.tx=o$W.ty=0,o$D._fun.call(o$D,o$o,o$r,0,0),o$L.copyTo(o$V),o$L.destroy()}else o$D._fun.call(o$D,o$o,o$r,o$T,o$k)},o$_.tmpTarget=function(o$o,o$r){var o$T=o$o.getValue("bounds"),o$k=o$Mo.create(o$T.width,o$T.height);o$k.start(),o$k.clear(0,0,0,0),o$o.addValue("tmpTarget",o$k)},o$_.endTmpTarget=function(o$o){o$o.getValue("tmpTarget").end()},o$_.recycleTarget=function(o$o){o$o.getValue("tmpTarget").recycle(),o$o.recycle()},o$n(o$_,["tempUV",function(){return this.tempUV=new Array(8)}]),o$_}(),o$to=function(o$o){function o$r(){this.data=null,o$r.__super.call(this)}o$i(o$r,"laya.filters.webgl.ColorFilterActionGL",o$c);var o$T=o$r.prototype;return o$q.imps(o$T,{"laya.filters.IFilterActionGL":!0}),o$T.setValue=function(o$o){o$o.colorMat=this.data._mat,o$o.colorAlpha=this.data._alpha},o$T.apply3d=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$o.getValue("bounds"),o$n=o$Fo.create(1,0);o$n.setFilters([this.data]);var o$V=o$P.TEMP;o$V.identity(),o$T.ctx.drawTarget(o$o,0,0,o$D.width,o$D.height,o$V,"src",o$n)},o$r}(),o$Ho=function(o$o){function o$D(o$o,o$r,o$T,o$k,o$W){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,o$D.__super.call(this,o$o,o$r,o$W),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new o$No,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=o$T,this._atlasCanvas.height=o$k,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}o$i(o$D,"laya.webgl.atlas.Atlaser",o$J);var o$r=o$D.prototype;return o$r.computeUVinAtlasTexture=function(o$o,o$r,o$T,o$k){var o$W=o$Y.atlasTextureWidth,o$D=o$Y.atlasTextureHeight,o$n=o$T/o$W,o$V=o$k/o$D,o$L=(o$T+o$o.bitmap.width)/o$W,o$U=(o$k+o$o.bitmap.height)/o$D,o$h=o$o.bitmap.width/o$W,o$p=o$o.bitmap.height/o$D;o$o.uv=[o$n+o$r[0]*o$h,o$V+o$r[1]*o$p,o$L-(1-o$r[2])*o$h,o$V+o$r[3]*o$p,o$L-(1-o$r[4])*o$h,o$U-(1-o$r[5])*o$p,o$n+o$r[6]*o$h,o$U-(1-o$r[7])*o$p]},o$r.findBitmapIsExist=function(o$o){if(o$o instanceof laya.webgl.resource.WebGLImage){var o$r=o$o,o$T=o$r.url,o$k=this._InAtlasWebGLImagesKey[o$T||o$r.id];if(o$k)return o$k.offsetInfoID}return-1},o$r.addToAtlasTexture=function(o$o,o$r,o$T){if(o$o instanceof laya.webgl.resource.WebGLImage){var o$k=o$o,o$W=o$k.url;this._InAtlasWebGLImagesKey[o$W||o$k.id]={bitmap:o$o,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([o$r,o$T])}this._atlasCanvas.texSubImage2D(o$r,o$T,o$o.atlasSource),o$o.clearAtlasSource()},o$r.addToAtlas=function(o$o,o$r,o$T){o$o._atlasID=this._inAtlasTextureKey.length;var o$k=o$o.uv.slice(),o$W=o$o.bitmap;this._inAtlasTextureKey.push(o$o),this._inAtlasTextureOriUVValue.push(o$k),this._inAtlasTextureBitmapValue.push(o$W),this.computeUVinAtlasTexture(o$o,o$k,o$r,o$T),o$o.bitmap=this._atlasCanvas},o$r.clear=function(){for(var o$o=0,o$r=this._inAtlasTextureKey.length;o$o<o$r;o$o++)this._inAtlasTextureKey[o$o].bitmap=this._inAtlasTextureBitmapValue[o$o],this._inAtlasTextureKey[o$o].uv=this._inAtlasTextureOriUVValue[o$o],this._inAtlasTextureKey[o$o]._atlasID=-1,this._inAtlasTextureKey[o$o].bitmap.lock=!1,this._inAtlasTextureKey[o$o].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},o$r.dispose=function(){this.clear(),this._atlasCanvas.destroy()},o$k(0,o$r,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),o$k(0,o$r,"texture",function(){return this._atlasCanvas}),o$k(0,o$r,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),o$D}(),o$Ro=function(o$o){function o$T(){o$T.__super.call(this,o$T.__name2int,o$T.__int2name,o$T.__int2nameMap)}return o$i(o$T,"laya.webgl.shader.d2.ShaderDefines2D",o$d),o$T.__init__=function(){o$T.reg("TEXTURE2D",1),o$T.reg("COLOR2D",2),o$T.reg("PRIMITIVE",4),o$T.reg("GLOW_FILTER",8),o$T.reg("BLUR_FILTER",16),o$T.reg("COLOR_FILTER",32),o$T.reg("COLOR_ADD",64),o$T.reg("WORLDMAT",128),o$T.reg("FILLTEXTURE",256),o$T.reg("FSHIGHPRECISION",1024),o$T.reg("TXTALPHA",2048),o$T.reg("TXTCOMPRESS",4096)},o$T.reg=function(o$o,o$r){o$d._reg(o$o,o$r,o$T.__name2int,o$T.__int2name)},o$T.toText=function(o$o,o$r,o$T){return o$d._toText(o$o,o$r,o$T)},o$T.toInt=function(o$o){return o$d._toInt(o$o,o$T.__name2int)},o$T.TEXTURE2D=1,o$T.COLOR2D=2,o$T.PRIMITIVE=4,o$T.FILTERGLOW=8,o$T.FILTERBLUR=16,o$T.FILTERCOLOR=32,o$T.COLORADD=64,o$T.WORLDMAT=128,o$T.FILLTEXTURE=256,o$T.SKINMESH=512,o$T.SHADERDEFINE_FSHIGHPRECISION=1024,o$T.TXTALPHA=2048,o$T.TXTCOMPRESS=4096,o$T.__name2int={},o$T.__int2name=[],o$T.__int2nameMap=[],o$T}(),o$uo=(function(o$o){function o$V(o$o,o$r,o$T,o$k,o$W,o$D,o$n){o$V.__super.call(this,o$o,o$r,o$T,o$k,40,o$W,o$D,o$n)}o$i(o$V,"laya.webgl.shapes.Ellipse",o$To)}(),function(o$o){function o$D(o$o,o$r,o$T,o$k,o$W){this._points=[],this.rebuild(o$T),o$D.__super.call(this,o$o,o$r,0,0,0,o$W,o$k,o$W,0)}o$i(o$D,"laya.webgl.shapes.Line",o$To);var o$r=o$D.prototype;return o$r.rebuild=function(o$o){var o$r=o$o.length;o$r!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(o$r/2-1)),this.mFloat32Array=new Float32Array(5*o$r)),this._points.length=0;for(var o$T=NaN,o$k=NaN,o$W=-1,o$D=-1,o$n=o$o.length/2,o$V=0;o$V<o$n;o$V++)o$T=o$o[2*o$V],o$k=o$o[2*o$V+1],(.01<Math.abs(o$W-o$T)||.01<Math.abs(o$D-o$k))&&this._points.push(o$T,o$k),o$W=o$T,o$D=o$k},o$r.getData=function(o$o,o$r,o$T){var o$k=[],o$W=[];0<this.borderWidth&&this.createLine2(this._points,o$k,this.borderWidth,o$T,o$W,this._points.length/2),this.mUint16Array.set(o$k,0),this.mFloat32Array.set(o$W,0),o$o.append(this.mUint16Array),o$r.append(this.mFloat32Array)},o$D}()),o$so=function(o$o){function o$p(o$o,o$r,o$T,o$k,o$W){this._points=[];for(var o$D=NaN,o$n=NaN,o$V=-1,o$L=-1,o$U=o$T.length/2-1,o$h=0;o$h<o$U;o$h++)o$D=o$T[2*o$h],o$n=o$T[2*o$h+1],(.01<Math.abs(o$V-o$D)||.01<Math.abs(o$L-o$n))&&this._points.push(o$D,o$n),o$V=o$D,o$L=o$n;o$D=o$T[2*o$U],o$n=o$T[2*o$U+1],o$V=this._points[0],o$L=this._points[1],(.01<Math.abs(o$V-o$D)||.01<Math.abs(o$L-o$n))&&this._points.push(o$D,o$n),o$p.__super.call(this,o$o,o$r,0,0,this._points.length/2,0,o$k,o$W)}o$i(o$p,"laya.webgl.shapes.LoopLine",o$To);var o$r=o$p.prototype;return o$r.getData=function(o$o,o$r,o$T){if(0<this.borderWidth){for(var o$k=this.color,o$W=(o$k>>16&255)/255,o$D=(o$k>>8&255)/255,o$n=(255&o$k)/255,o$V=[],o$L=0,o$U=0,o$h=[],o$p=Math.floor(this._points.length/2),o$i=0;o$i<o$p;o$i++)o$L=this._points[2*o$i],o$U=this._points[2*o$i+1],o$V.push(this.x+o$L,this.y+o$U,o$W,o$D,o$n);this.createLoopLine(o$V,o$h,this.borderWidth,o$T+o$V.length/5),o$o.append(new Uint16Array(o$h)),o$r.append(new Float32Array(o$V))}},o$r.createLoopLine=function(o$o,o$r,o$T,o$k,o$W,o$D){o$o.length;var o$n=o$o.concat(),o$V=o$W||o$o,o$L=this.borderColor,o$U=(o$L>>16&255)/255,o$h=(o$L>>8&255)/255,o$p=(255&o$L)/255,o$i=[o$n[0],o$n[1]],o$v=[o$n[o$n.length-5],o$n[o$n.length-4]],o$x=o$v[0]+.5*(o$i[0]-o$v[0]),o$j=o$v[1]+.5*(o$i[1]-o$v[1]);o$n.unshift(o$x,o$j,0,0,0),o$n.push(o$x,o$j,0,0,0);var o$_,o$K,o$$,o$y,o$l,o$S,o$q,o$b,o$F,o$P,o$t,o$H,o$R,o$u,o$s,o$z,o$m,o$C,o$X,o$O,o$M=o$n.length/5,o$c=o$k,o$e=o$T/2;o$$=o$n[0],o$y=o$n[1],o$P=o$$-(o$l=o$n[5]),o$F=(o$F=-(o$y-(o$S=o$n[6])))/(o$O=Math.sqrt(o$F*o$F+o$P*o$P))*o$e,o$P=o$P/o$O*o$e,o$V.push(o$$-o$F,o$y-o$P,o$U,o$h,o$p,o$$+o$F,o$y+o$P,o$U,o$h,o$p);for(var o$J=1;o$J<o$M-1;o$J++)o$$=o$n[5*(o$J-1)],o$y=o$n[5*(o$J-1)+1],o$l=o$n[5*o$J],o$S=o$n[5*o$J+1],o$q=o$n[5*(o$J+1)],o$b=o$n[5*(o$J+1)+1],o$P=o$$-o$l,o$H=o$l-o$q,o$s=(-(o$F=(o$F=-(o$y-o$S))/(o$O=Math.sqrt(o$F*o$F+o$P*o$P))*o$e)+o$$)*(-(o$P=o$P/o$O*o$e)+o$S)-(-o$F+o$l)*(-o$P+o$y),o$C=(-(o$t=(o$t=-(o$S-o$b))/(o$O=Math.sqrt(o$t*o$t+o$H*o$H))*o$e)+o$q)*(-(o$H=o$H/o$O*o$e)+o$S)-(-o$t+o$l)*(-o$H+o$b),o$X=(o$R=-o$P+o$y-(-o$P+o$S))*(o$m=-o$t+o$l-(-o$t+o$q))-(o$z=-o$H+o$b-(-o$H+o$S))*(o$u=-o$F+o$l-(-o$F+o$$)),Math.abs(o$X)<.1?(o$X+=10.1,o$V.push(o$l-o$F,o$S-o$P,o$U,o$h,o$p,o$l+o$F,o$S+o$P,o$U,o$h,o$p)):(((o$_=(o$u*o$C-o$m*o$s)/o$X)-o$l)*(o$_-o$l)+((o$K=(o$z*o$s-o$R*o$C)/o$X)-o$S)+(o$K-o$S),o$V.push(o$_,o$K,o$U,o$h,o$p,o$l-(o$_-o$l),o$S-(o$K-o$S),o$U,o$h,o$p));o$D&&(o$r=o$D);var o$Y=this.edges+1;for(o$J=1;o$J<o$Y;o$J++)o$r.push(o$c+2*(o$J-1),o$c+2*(o$J-1)+1,o$c+2*o$J+1,o$c+2*o$J+1,o$c+2*o$J,o$c+2*(o$J-1));return o$r.push(o$c+2*(o$J-1),o$c+2*(o$J-1)+1,o$c+1,o$c+1,o$c,o$c+2*(o$J-1)),o$V},o$p}(),o$zo=function(o$o){function o$n(o$o,o$r,o$T,o$k,o$W,o$D){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=o$P.create(),this._points=o$T.slice(0,o$T.length),o$n.__super.call(this,o$o,o$r,0,0,this._points.length/2,o$k,o$W,o$D)}o$i(o$n,"laya.webgl.shapes.Polygon",o$To);var o$r=o$n.prototype;return o$r.rebuild=function(o$o){this._repaint||(this._points.length=0,this._points=this._points.concat(o$o))},o$r.setMatrix=function(o$o){o$o.copyTo(this._mat)},o$r.needUpdate=function(o$o){return this._repaint=this._mat.a==o$o.a&&this._mat.b==o$o.b&&this._mat.c==o$o.c&&this._mat.d==o$o.d&&this._mat.tx==o$o.tx&&this._mat.ty==o$o.ty,!this._repaint},o$r.getData=function(o$o,o$r,o$T){var o$k,o$W=0,o$D=this._points,o$n=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=o$T){for(this._start=o$T,o$k=[],o$n=this.earcutTriangles.length,o$W=0;o$W<o$n;o$W++)o$k.push(this.earcutTriangles[o$W]+o$T);this.mUint16Array=new Uint16Array(o$k)}}else{this._start=o$T,o$k=[];var o$V=[],o$L=[],o$U=this.color,o$h=(o$U>>16&255)/255,o$p=(o$U>>8&255)/255,o$i=(255&o$U)/255;for(o$n=Math.floor(o$D.length/2),o$W=0;o$W<o$n;o$W++)o$V.push(this.x+o$D[2*o$W],this.y+o$D[2*o$W+1],o$h,o$p,o$i),o$L.push(this.x+o$D[2*o$W],this.y+o$D[2*o$W+1]);for(this.earcutTriangles=o$ko.earcut(o$L,null,2),o$n=this.earcutTriangles.length,o$W=0;o$W<o$n;o$W++)o$k.push(this.earcutTriangles[o$W]+o$T);this.mUint16Array=new Uint16Array(o$k),this.mFloat32Array=new Float32Array(o$V)}o$o.append(this.mUint16Array),o$r.append(this.mFloat32Array)},o$n}(),o$mo=function(o$o){function o$D(){this._matrix=new o$P,this._matrix4=o$jo.defaultMatrix4.concat(),o$D.__super.call(this,1e4),this.shaderValue=new o$Fo(0,0)}o$i(o$D,"laya.webgl.submit.SubmitCanvas",o$Do);var o$r=o$D.prototype;return o$r.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var o$o=o$$o.worldAlpha,o$r=o$$o.worldMatrix4,o$T=o$$o.worldMatrix,o$k=o$$o.worldFilters,o$W=o$$o.worldShaderDefines,o$D=this.shaderValue,o$n=this._matrix,o$V=this._matrix4,o$L=o$P.TEMP;return o$P.mul(o$n,o$T,o$L),o$V[0]=o$L.a,o$V[1]=o$L.b,o$V[4]=o$L.c,o$V[5]=o$L.d,o$V[12]=o$L.tx,o$V[13]=o$L.ty,o$$o.worldMatrix=o$L.clone(),o$$o.worldMatrix4=o$V,o$$o.worldAlpha=o$$o.worldAlpha*o$D.alpha,o$D.filters&&o$D.filters.length&&(o$$o.worldFilters=o$D.filters,o$$o.worldShaderDefines=o$D.defines),this._ctx_src.flush(),o$$o.worldAlpha=o$o,o$$o.worldMatrix4=o$r,o$$o.worldMatrix.destroy(),o$$o.worldMatrix=o$T,o$$o.worldFilters=o$k,o$$o.worldShaderDefines=o$W,1},o$r.releaseRender=function(){var o$o=o$D._cache;this._ctx_src=null,o$o[o$o._length++]=this},o$r.getRenderType=function(){return 10003},o$D.create=function(o$o,o$r,o$T){var o$k=o$D._cache._length?o$D._cache[--o$D._cache._length]:new o$D;o$k._ctx_src=o$o;var o$W=o$k.shaderValue;return o$W.alpha=o$r,o$W.defines.setValue(0),o$T&&o$T.length&&o$W.setFilters(o$T),o$k},o$D._cache=((o$D._cache=[])._length=0,o$D._cache),o$D}(),o$Co=function(o$o){function o$U(o$o){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===o$o&&(o$o=1e4),o$U.__super.call(this,o$o)}o$i(o$U,"laya.webgl.submit.SubmitTexture",o$Do);var o$r=o$U.prototype;return o$r.releaseRender=function(){var o$o=o$U._cache;(o$o[o$o._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},o$r.addTexture=function(o$o,o$r){this._texsID[this._texs.length]=o$o._uvID,this._texs.push(o$o),this._vbPos.push(o$r)},o$r.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var o$o=this.shaderValue.textureHost.bitmap;if(null!==o$o)for(var o$r=this._vb.getFloat32Array(),o$T=0,o$k=this._texs.length;o$T<o$k;o$T++){var o$W=this._texs[o$T];o$W.active();var o$D=o$W.uv;if(this._texsID[o$T]!==o$W._uvID){this._texsID[o$T]=o$W._uvID;var o$n=this._vbPos[o$T];o$r[o$n+2]=o$D[0],o$r[o$n+3]=o$D[1],o$r[o$n+6]=o$D[2],o$r[o$n+7]=o$D[3],o$r[o$n+10]=o$D[4],o$r[o$n+11]=o$D[5],o$r[o$n+14]=o$D[6],o$r[o$n+15]=o$D[7],this._vb.setNeedUpload()}o$W.bitmap!==o$o&&(this._isSameTexture=!1)}}},o$r.renderSubmit=function(){if(0===this._numEle)return o$U._shaderSet=!1,1;var o$o=this.shaderValue.textureHost;if(o$o){var o$r=o$o.source;if(!o$o.bitmap||!o$r)return o$U._shaderSet=!1,1;this.shaderValue.texture=o$r,o$o.alphaTexture&&o$o.alphaTexture.source&&(this.shaderValue.texture1=o$o.alphaTexture.source)}this._vb.bind_upload(this._ib);var o$T=o$lo.mainContext;if(o$I.activeBlendFunction!==this._blendFn&&(o$T.enable(3042),this._blendFn(o$T),o$I.activeBlendFunction=this._blendFn),o$s.drawCall++,o$s.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&o$Oo.activeShader&&o$U._shaderSet?(o$Oo.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&o$Oo.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),o$U._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var o$k=o$o.bitmap,o$W=0,o$D=o$Oo.activeShader,o$n=0,o$V=this._texs.length;o$n<o$V;o$n++){var o$L=this._texs[o$n];o$L.bitmap===o$k&&o$n+1!==o$V||(o$D.uploadTexture2D(o$L.source),o$T.drawElements(4,6*(o$n-o$W+1),5123,this._startIdx+6*o$W*o$jo.BYTES_PIDX),o$k=o$L.bitmap,o$W=o$n)}else o$T.drawElements(4,this._numEle,5123,this._startIdx);return 1},o$U.create=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$U._cache._length?o$U._cache[--o$U._cache._length]:new o$U;null==o$T&&((o$T=o$D._selfVb||(o$D._selfVb=o$do.create(-1))).clear(),o$k=0),o$D._ib=o$r,o$D._vb=o$T,o$D._startIdx=o$k*o$jo.BYTES_PIDX,o$D._numEle=0;var o$n=o$o._nBlendType;o$D._blendFn=o$o._targets?o$I.targetFns[o$n]:o$I.fns[o$n],o$D.shaderValue=o$W,o$D.shaderValue.setValue(o$o._shader2D);var o$V=o$o._shader2D.filters;return o$V&&o$D.shaderValue.setFilters(o$V),o$D},o$U._cache=((o$U._cache=[])._length=0,o$U._cache),o$U._shaderSet=!0,o$U}(),o$Xo=function(o$o){function o$K(){o$K.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}o$i(o$K,"laya.webgl.utils.MeshTexture",o$Ko);var o$r=o$K.prototype;return o$r.addData=function(o$o,o$r,o$T,o$k,o$W,o$D){for(var o$n=o$o.length/2,o$V=this._vb.needSize(o$n*o$K.const_stride)>>2,o$L=this._vb.getFloat32Array(),o$U=0,o$h=0;o$h<o$n;o$h++){var o$p=o$o[o$U],o$i=o$o[o$U+1],o$v=o$p*o$k.a+o$i*o$k.c+o$k.tx,o$x=o$p*o$k.b+o$i*o$k.d+o$k.ty;o$L[o$V++]=o$v,o$L[o$V++]=o$x,o$L[o$V++]=o$r[o$U],o$L[o$V++]=o$r[o$U+1],o$U+=2}this._vb.setNeedUpload();var o$j=this.vertNum;if(0<o$j){(o$n=o$T.length)>o$K.tmpIdx.length&&(o$K.tmpIdx=new Uint16Array(o$n));for(var o$_=0;o$_<o$n;o$_++)o$K.tmpIdx[o$_]=o$T[o$_]+o$j;this._ib.appendU16Array(o$K.tmpIdx,o$T.length)}else this._ib.append(o$T);this._ib.setNeedUpload(),this.vertNum+=o$n,this.indexNum+=o$T.length},o$r.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},o$r.destroy=function(){this._ib.destroy(),this._vb.destroy()},o$K.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new o$K},o$K.const_stride=16,o$K._POOL=[],o$n(o$K,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),o$K}(),o$Oo=function(o$o){function o$r(){o$r.__super.call(this),this.lock=!0}return o$i(o$r,"laya.webgl.shader.BaseShader",o$y),o$r.activeShader=null,o$r.bindShader=null,o$r}(),o$Mo=function(o$r){function o$h(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===o$T&&(o$T=6408),void 0===o$k&&(o$k=5121),void 0===o$W&&(o$W=34041),void 0===o$D&&(o$D=!1),void 0===o$n&&(o$n=!1),void 0===o$V&&(o$V=-1),void 0===o$L&&(o$L=-1),this._type=1,this._w=o$o,this._h=o$r,this._surfaceFormat=o$T,this._surfaceType=o$k,this._depthStencilFormat=o$W,o$K.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=o$D,this._repeat=o$n,this._minFifter=o$V,this._magFifter=o$L,this._createWebGLRenderTarget(),this.bitmap.lock=!0,o$h.__super.call(this,this.bitmap,o$X.INV_UV)}o$i(o$h,"laya.webgl.resource.RenderTarget2D",o$r);var o$o=o$h.prototype;return o$q.imps(o$o,{"laya.resource.IDispose":!0}),o$o.getType=function(){return this._type},o$o.getTexture=function(){return this},o$o.size=function(o$o,o$r){this._w==o$o&&this._h==o$r||(this._w=o$o,this._h=o$r,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},o$o.release=function(){this.destroy()},o$o.recycle=function(){o$h.POOL.push(this)},o$o.start=function(){var o$o=o$lo.mainContext;return this._preRenderTarget=o$$o.curRenderTarget,o$$o.curRenderTarget=this,o$o.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(o$o.viewport(0,0,this._w,this._h),this._svWidth=o$$o.width,this._svHeight=o$$o.height,o$$o.width=this._w,o$$o.height=this._h,o$Oo.activeShader=null),this},o$o.clear=function(o$o,o$r,o$T,o$k){void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=1);var o$W=o$lo.mainContext;o$W.clearColor(o$o,o$r,o$T,o$k);var o$D=16384;switch(this._depthStencilFormat){case 33189:o$D|=256;break;case 36168:o$D|=1024;break;case 34041:o$D|=256,o$D|=1024}o$W.clear(o$D)},o$o.end=function(){var o$o=o$lo.mainContext;o$o.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,o$$o.curRenderTarget=this._preRenderTarget,1==this._type?(o$o.viewport(0,0,this._svWidth,this._svHeight),o$$o.width=this._svWidth,o$$o.height=this._svHeight,o$Oo.activeShader=null):o$o.viewport(0,0,o$q.stage.width,o$q.stage.height)},o$o.getData=function(o$o,o$r,o$T,o$k){var o$W=o$lo.mainContext;if(o$W.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===o$W.checkFramebufferStatus(36160)))return o$W.bindFramebuffer(36160,null),null;var o$D=new Uint8Array(this._w*this._h*4);return o$W.readPixels(o$o,o$r,o$T,o$k,this._surfaceFormat,this._surfaceType,o$D),o$W.bindFramebuffer(36160,null),o$D},o$o.destroy=function(o$o){void 0===o$o&&(o$o=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,o$r.prototype.destroy.call(this))},o$o.dispose=function(){},o$o._createWebGLRenderTarget=function(){this.bitmap=new o$Go(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(o$o){this.event("recovered")})},o$k(0,o$o,"surfaceFormat",function(){return this._surfaceFormat}),o$k(0,o$o,"magFifter",function(){return this._magFifter}),o$k(0,o$o,"surfaceType",function(){return this._surfaceType}),o$k(0,o$o,"mipMap",function(){return this._mipMap}),o$k(0,o$o,"depthStencilFormat",function(){return this._depthStencilFormat}),o$k(0,o$o,"minFifter",function(){return this._minFifter}),o$k(0,o$o,"source",function(){return this._alreadyResolved?o$q.superGet(o$X,this,"source"):null}),o$h.create=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){void 0===o$T&&(o$T=6408),void 0===o$k&&(o$k=5121),void 0===o$W&&(o$W=34041),void 0===o$D&&(o$D=!1),void 0===o$n&&(o$n=!1),void 0===o$V&&(o$V=-1),void 0===o$L&&(o$L=-1);var o$U=o$h.POOL.pop();return o$U||(o$U=new o$h(o$o,o$r)),o$U.bitmap&&o$U._w==o$o&&o$U._h==o$r&&o$U._surfaceFormat==o$T&&o$U._surfaceType==o$k&&o$U._depthStencilFormat==o$W&&o$U._mipMap==o$D&&o$U._repeat==o$n&&o$U._minFifter==o$V&&o$U._magFifter==o$L||(o$U._w=o$o,o$U._h=o$r,o$U._surfaceFormat=o$T,o$U._surfaceType=o$k,o$U._depthStencilFormat=o$W,o$K.isConchWebGL&&34041===o$U._depthStencilFormat&&(o$U._depthStencilFormat=33189),o$U._mipMap=o$D,o$U._repeat=o$n,o$U._minFifter=o$V,o$U._magFifter=o$L,o$U.release(),o$U._createWebGLRenderTarget()),o$U},o$h.TYPE2D=1,o$h.TYPE3D=2,o$h.POOL=[],o$h}(o$X),o$co=function(o$o){function o$r(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,o$r.__super.call(this),o$r._gl=o$lo.mainContext}o$i(o$r,"laya.webgl.utils.Buffer",o$y);var o$T=o$r.prototype;return o$T._bind=function(){this.activeResource(),o$r._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(o$r._bindVertexBuffer=this._glBuffer),o$r._gl.bindBuffer(this._bufferType,o$r._bindActive[this._bufferType]=this._glBuffer),o$Oo.activeShader=null)},o$T.recreateResource=function(){this._glBuffer||(this._glBuffer=o$r._gl.createBuffer()),this.completeCreate()},o$T.disposeResource=function(){this._glBuffer&&(o$lo.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},o$k(0,o$T,"bufferUsage",function(){return this._bufferUsage}),o$r._gl=null,o$r._bindActive={},o$r._bindVertexBuffer=null,o$r._enableAtributes=[],o$r}(),o$eo=function(o$o){function o$T(o$o){this.texcoord=null,this.offsetX=300,this.offsetY=0,o$T.__super.call(this,512,0);var o$r=8*o$jo.BYTES_PE;this.position=[2,5126,!1,o$r,0],this.texcoord=[2,5126,!1,o$r,2*o$jo.BYTES_PE],this.color=[4,5126,!1,o$r,4*o$jo.BYTES_PE]}return o$i(o$T,"laya.webgl.shader.d2.skinAnishader.SkinSV",o$Fo),o$T}(),o$Jo=function(o$o){function o$r(o$o){o$r.__super.call(this,2,0),this.color=[]}return o$i(o$r,"laya.webgl.shader.d2.value.Color2dSV",o$Fo),o$r.prototype.setValue=function(o$o){o$o.fillStyle&&(this.color=o$o.fillStyle._color._color),o$o.strokeStyle&&(this.color=o$o.strokeStyle._color._color)},o$r}(),o$Yo=function(o$o){function o$r(o$o){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=o$Fo._TEXCOORD,o$r.__super.call(this,256,0)}o$i(o$r,"laya.webgl.shader.d2.value.FillTextureSV",o$Fo);var o$T=o$r.prototype;return o$T.setValue=function(o$o){this.ALPHA=o$o.ALPHA,o$o.filters&&this.setFilters(o$o.filters)},o$T.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},o$r}(),o$Ao=function(o$o){function o$r(o$o){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=o$Fo._TEXCOORD,void 0===o$o&&(o$o=0),o$r.__super.call(this,1,o$o)}o$i(o$r,"laya.webgl.shader.d2.value.TextureSV",o$Fo);var o$T=o$r.prototype;return o$T.setValue=function(o$o){this.ALPHA=o$o.ALPHA,o$o.filters&&this.setFilters(o$o.filters)},o$T.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},o$r}(),o$Io=function(o$o){function o$r(o$o){this.a_color=null,this.u_pos=[0,0],o$r.__super.call(this,4,0),this.position=[2,5126,!1,5*o$jo.BYTES_PE,0],this.a_color=[3,5126,!1,5*o$jo.BYTES_PE,2*o$jo.BYTES_PE]}return o$i(o$r,"laya.webgl.shader.d2.value.PrimitiveSV",o$Fo),o$r}(),o$No=function(o$o){function o$r(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,o$r.__super.call(this)}o$i(o$r,"laya.webgl.atlas.AtlasWebGLCanvas",o$o);var o$T=o$r.prototype;return o$T.recreateResource=function(){var o$o=o$lo.mainContext,o$r=this._source=o$o.createTexture(),o$T=o$So.curBindTexTarget,o$k=o$So.curBindTexValue;o$So.bindTexture(o$o,3553,o$r),o$o.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),o$o.texParameteri(3553,10241,9729),o$o.texParameteri(3553,10240,9729),o$o.texParameteri(3553,10242,33071),o$o.texParameteri(3553,10243,33071),o$T&&o$k&&o$So.bindTexture(o$o,o$T,o$k),this.memorySize=this._w*this._h*4,this.completeCreate()},o$T.disposeResource=function(){this._source&&(o$lo.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},o$T.texSubImage2D=function(o$o,o$r,o$T){if(o$K.isFlash){this._flashCacheImage||(this._flashCacheImage=o$j.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var o$k=o$T.bitmapdata;this._flashCacheImage._image.copyPixels(o$k,0,0,o$k.width,o$k.height,o$o,o$r),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var o$W=o$lo.mainContext,o$D=o$So.curBindTexTarget,o$n=o$So.curBindTexValue;o$So.bindTexture(o$W,3553,this._source),o$W.pixelStorei(37441,!0),0<=o$o-1&&o$W.texSubImage2D(3553,0,o$o-1,o$r,6408,5121,o$T),o$o+1<=this._w&&o$W.texSubImage2D(3553,0,o$o+1,o$r,6408,5121,o$T),0<=o$r-1&&o$W.texSubImage2D(3553,0,o$o,o$r-1,6408,5121,o$T),o$r+1<=this._h&&o$W.texSubImage2D(3553,0,o$o,o$r+1,6408,5121,o$T),o$W.texSubImage2D(3553,0,o$o,o$r,6408,5121,o$T),o$W.pixelStorei(37441,!1),o$D&&o$n&&o$So.bindTexture(o$W,o$D,o$n)}},o$T.texSubImage2DPixel=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$lo.mainContext,o$n=o$So.curBindTexTarget,o$V=o$So.curBindTexValue;o$So.bindTexture(o$D,3553,this._source);var o$L=new Uint8Array(o$W.data);o$D.pixelStorei(37441,!0),o$D.texSubImage2D(3553,0,o$o,o$r,o$T,o$k,6408,5121,o$L),o$D.pixelStorei(37441,!1),o$n&&o$V&&o$So.bindTexture(o$D,o$n,o$V)},o$k(0,o$T,"width",o$o.prototype._$get_width,function(o$o){this._w=o$o}),o$k(0,o$T,"height",o$o.prototype._$get_height,function(o$o){this._h=o$o}),o$r}(o$T),o$fo=function(o$o){function o$W(){this.flipY=!0,this.alwaysChange=!1,o$W.__super.call(this)}o$i(o$W,"laya.webgl.resource.WebGLCanvas",o$T);var o$r=o$W.prototype;return o$r.getCanvas=function(){return this._canvas},o$r.clear=function(){this._ctx&&this._ctx.clear()},o$r.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},o$r._setContext=function(o$o){this._ctx=o$o},o$r.getContext=function(o$o,o$r){return this._ctx?this._ctx:this._ctx=o$W._createContext(this)},o$r.size=function(o$o,o$r){this._w==o$o&&this._h==o$r||(this._w=o$o,this._h=o$r,this._ctx&&this._ctx.size(o$o,o$r),this._canvas&&(this._canvas.height=o$r,this._canvas.width=o$o))},o$r.activeResource=function(o$o){void 0===o$o&&(o$o=!1),this._source||this.recreateResource()},o$r.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},o$r.disposeResource=function(){this._source&&!this.iscpuSource&&(o$lo.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},o$r.createWebGlTexture=function(){var o$o=o$lo.mainContext;this._canvas;var o$r=this._source=o$o.createTexture();this.iscpuSource=!1;var o$T=o$So.curBindTexTarget,o$k=o$So.curBindTexValue;o$So.bindTexture(o$o,3553,o$r),o$o.pixelStorei(37440,this.flipY?1:0),o$W.premulAlpha&&o$o.pixelStorei(37441,!0),o$o.texImage2D(3553,0,6408,6408,5121,this._imgData),o$W.premulAlpha&&o$o.pixelStorei(37441,!1),o$o.texParameteri(3553,10240,9729),o$o.texParameteri(3553,10241,9729),o$o.texParameteri(3553,10242,33071),o$o.texParameteri(3553,10243,33071),o$o.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,o$T&&o$k&&o$So.bindTexture(o$o,o$T,o$k)},o$r.reloadCanvasData=function(){var o$o=o$lo.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var o$r=o$So.curBindTexTarget,o$T=o$So.curBindTexValue;o$So.bindTexture(o$o,3553,this._source),o$W.premulAlpha&&o$o.pixelStorei(37441,!0),o$o.texImage2D(3553,0,6408,6408,5121,this._imgData),o$W.premulAlpha&&o$o.pixelStorei(37441,!1),o$o.pixelStorei(37440,0),o$r&&o$T&&o$So.bindTexture(o$o,o$r,o$T)},o$r.texSubImage2D=function(o$o,o$r,o$T){var o$k=o$lo.mainContext,o$W=o$So.curBindTexTarget,o$D=o$So.curBindTexValue;o$So.bindTexture(o$k,3553,this._source),o$k.pixelStorei(37441,!0),o$k.texSubImage2D(3553,0,o$r,o$T,6408,5121,o$o._source),o$k.pixelStorei(37441,!1),o$W&&o$D&&o$So.bindTexture(o$k,o$W,o$D)},o$r.toBase64=function(o$o,o$r,o$T){var o$k=null;this._canvas&&(o$k=this._canvas.toDataURL(o$o,o$r)),o$T.call(this,o$k)},o$k(0,o$r,"context",function(){return this._ctx}),o$k(0,o$r,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),o$k(0,o$r,"asBitmap",null,function(o$o){this._ctx&&(this._ctx.asBitmap=o$o)}),o$W._createContext=null,o$W.premulAlpha=!1,o$W}(),o$ao=function(o$o){function o$D(o$o,o$r){this.CborderSize=12,o$D.__super.call(this),this.char=o$o,this.isSpace=" "===o$o,this.xs=o$r.scaleX,this.ys=o$r.scaleY,this.font=o$r.font.toString(),this.fontSize=o$r.font.size,this.fillColor=o$r.fillColor,this.borderColor=o$r.borderColor,this.lineWidth=o$r.lineWidth,this.underLine=o$r.underLine;var o$T,o$k=o$K.isConchApp;o$k?((o$T=ConchTextCanvas)._source=ConchTextCanvas,o$T._source.canvas=ConchTextCanvas):o$T=o$v.canvas.source,this.canvas=o$T,this._enableMerageInAtlas=!0,this._ctx=o$k?o$T:this.canvas.getContext("2d",void 0);var o$W=o$O.measureText(this.char,this.font);this.cw=o$W.width*this.xs,this.ch=(o$W.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new o$X(this)}o$i(o$D,"laya.webgl.resource.WebGLCharImage",o$T);var o$r=o$D.prototype;return o$q.imps(o$r,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),o$r.active=function(){this.texture.active()},o$r.recreateResource=function(){var o$o=o$K.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),o$o){var o$r=this.fontSize;1==this.xs&&1==this.ys||(o$r=parseInt(o$r*(this.xs>this.ys?this.xs:this.ys)+""));var o$T="normal 100 "+this.font;o$T=o$T.replace(o$D._fontSizeReg,o$r),this.borderColor&&(o$T+=" 1 "+this.borderColor),this._ctx.font=o$T,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,o$C.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var o$k=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(o$k,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},o$r.onresize=function(o$o,o$r){this._w=o$o,this._h=o$r,this._allowMerageInAtlas=!0},o$r.clearAtlasSource=function(){},o$k(0,o$r,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),o$k(0,o$r,"atlasSource",function(){return this.canvas}),o$k(0,o$r,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(o$o){this._enableMerageInAtlas=o$o}),o$D.createOneChar=function(o$o,o$r){return new o$D(o$o,o$r)},o$D._fontSizeReg=new RegExp("\\d+(?=px)","g"),o$D}(),o$Go=function(o$o){function o$U(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){void 0===o$T&&(o$T=6408),void 0===o$k&&(o$k=5121),void 0===o$W&&(o$W=34041),void 0===o$D&&(o$D=!1),void 0===o$n&&(o$n=!1),void 0===o$V&&(o$V=-1),void 0===o$L&&(o$L=1),o$U.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=o$o,this._h=o$r,this._surfaceFormat=o$T,this._surfaceType=o$k,this._depthStencilFormat=o$W,this._mipMap=o$D,this._repeat=o$n,this._minFifter=o$V,this._magFifter=o$L}o$i(o$U,"laya.webgl.resource.WebGLRenderTarget",o$T);var o$r=o$U.prototype;return o$r.recreateResource=function(){var o$o=o$lo.mainContext;this._frameBuffer||(this._frameBuffer=o$o.createFramebuffer()),this._source||(this._source=o$o.createTexture());var o$r=o$So.curBindTexTarget,o$T=o$So.curBindTexValue;o$So.bindTexture(o$o,3553,this._source),o$o.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var o$k=this._minFifter,o$W=this._magFifter,o$D=this._repeat?10497:33071,o$n=o$h.isPOT(this._w,this._h);if(o$n?(this._mipMap?-1!==o$k||(o$k=9987):-1!==o$k||(o$k=9729),-1!==o$W||(o$W=9729),o$o.texParameteri(3553,10241,o$k),o$o.texParameteri(3553,10240,o$W),o$o.texParameteri(3553,10242,o$D),o$o.texParameteri(3553,10243,o$D),this._mipMap&&o$o.generateMipmap(3553)):(-1!==o$k||(o$k=9729),-1!==o$W||(o$W=9729),o$o.texParameteri(3553,10241,o$k),o$o.texParameteri(3553,10240,o$W),o$o.texParameteri(3553,10242,33071),o$o.texParameteri(3553,10243,33071)),o$o.bindFramebuffer(36160,this._frameBuffer),o$o.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=o$o.createRenderbuffer()),o$o.bindRenderbuffer(36161,this._depthStencilBuffer),o$o.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:o$o.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:o$o.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:o$o.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}o$o.bindFramebuffer(36160,null),o$r&&o$T&&o$So.bindTexture(o$o,o$r,o$T),o$o.bindRenderbuffer(36161,null),o$n&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},o$r.disposeResource=function(){this._frameBuffer&&(o$lo.mainContext.deleteTexture(this._source),o$lo.mainContext.deleteFramebuffer(this._frameBuffer),o$lo.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},o$k(0,o$r,"depthStencilBuffer",function(){return this._depthStencilBuffer}),o$k(0,o$r,"frameBuffer",function(){return this._frameBuffer}),o$U}(),o$wo=function(o$o){function o$V(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this.offsetX=0,this.offsetY=0,o$V.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=o$D,this.canvas=o$o,this._ctx=o$o.getContext("2d",void 0),this._w=o$k,this._h=o$W,this.offsetX=o$r,this.offsetY=o$T,this.src=o$n,this._enableMerageInAtlas=!0,o$Y.enabled&&this._w<o$Y.atlasLimitWidth&&this._h<o$Y.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}o$i(o$V,"laya.webgl.resource.WebGLSubImage",o$T);var o$r=o$V.prototype;return o$q.imps(o$r,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),o$r.size=function(o$o,o$r){this._w=o$o,this._h=o$r,this._ctx&&this._ctx.size(o$o,o$r),this.canvas&&(this.canvas.height=o$r,this.canvas.width=o$o)},o$r.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},o$r.createWebGlTexture=function(){var o$o=o$lo.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var o$r=this._source=o$o.createTexture(),o$T=o$So.curBindTexTarget,o$k=o$So.curBindTexValue;o$So.bindTexture(o$o,3553,o$r),o$o.pixelStorei(37441,!0),o$o.texImage2D(3553,0,6408,6408,5121,this.canvas),o$o.pixelStorei(37441,!1);var o$W=this.minFifter,o$D=this.magFifter,o$n=this.repeat?10497:33071,o$V=o$h.isPOT(this.width,this.height);o$V?(this.mipmap?-1!==o$W||(o$W=9987):-1!==o$W||(o$W=9729),-1!==o$D||(o$D=9729),o$o.texParameteri(3553,10240,o$D),o$o.texParameteri(3553,10241,o$W),o$o.texParameteri(3553,10242,o$n),o$o.texParameteri(3553,10243,o$n),this.mipmap&&o$o.generateMipmap(3553)):(-1!==o$W||(o$W=9729),-1!==o$D||(o$D=9729),o$o.texParameteri(3553,10241,o$W),o$o.texParameteri(3553,10240,o$D),o$o.texParameteri(3553,10242,33071),o$o.texParameteri(3553,10243,33071)),o$T&&o$k&&o$So.bindTexture(o$o,o$T,o$k),this.canvas=null,o$V&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},o$r.disposeResource=function(){o$Y.enabled&&this._allowMerageInAtlas||!this._source||(o$lo.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},o$r.clearAtlasSource=function(){},o$k(0,o$r,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),o$k(0,o$r,"atlasSource",function(){return this.canvas}),o$k(0,o$r,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(o$o){this._allowMerageInAtlas=o$o}),o$V}(),o$Zo=function(o$o){function o$U(o$o,o$r,o$T,o$k){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,o$U.__super.call(this),!o$o||!o$r)throw"Shader Error";this._id=++o$U._count,this._vs=o$o,this._ps=o$r,this._nameMap=o$k||{},null!=o$T&&(o$U.sharders[o$T]=this)}o$i(o$U,"laya.webgl.shader.Shader",o$Oo);var o$r=o$U.prototype;return o$r.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},o$r.disposeResource=function(){o$lo.mainContext.deleteShader(this._vshader),o$lo.mainContext.deleteShader(this._pshader),o$lo.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},o$r._compile=function(){if(!o$lo.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var o$o=[this._vs,this._ps],o$r=o$lo.mainContext;if(this._program=o$r.createProgram(),this._vshader=o$U._createShader(o$r,o$o[0],35633),this._pshader=o$U._createShader(o$r,o$o[1],35632),o$r.attachShader(this._program,this._vshader),o$r.attachShader(this._program,this._pshader),o$r.linkProgram(this._program),!o$K.isConchApp&&!o$r.getProgramParameter(this._program,35714))throw o$r.getProgramInfoLog(this._program);var o$T,o$k,o$W=0,o$D=0;for(o$D=o$K.isConchApp?o$r.getProgramParameterEx(this._vs,this._ps,"",35721):o$r.getProgramParameter(this._program,35721),o$W=0;o$W<o$D;o$W++){var o$n=null;o$T={vartype:"attribute",glfun:null,ivartype:0,attrib:o$n=o$K.isConchApp?o$r.getActiveAttribEx(this._vs,this._ps,"",o$W):o$r.getActiveAttrib(this._program,o$W),location:o$r.getAttribLocation(this._program,o$n.name),name:o$n.name,type:o$n.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(o$T)}var o$V=0;for(o$V=o$K.isConchApp?o$r.getProgramParameterEx(this._vs,this._ps,"",35718):o$r.getProgramParameter(this._program,35718),o$W=0;o$W<o$V;o$W++){var o$L=null;o$L=o$K.isConchApp?o$r.getActiveUniformEx(this._vs,this._ps,"",o$W):o$r.getActiveUniform(this._program,o$W),0<(o$T={vartype:"uniform",glfun:null,ivartype:1,attrib:o$n,location:o$r.getUniformLocation(this._program,o$L.name),name:o$L.name,type:o$L.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(o$T.name=o$T.name.substr(0,o$T.name.length-3),o$T.isArray=!0,o$T.location=o$r.getUniformLocation(this._program,o$T.name)),this._params.push(o$T)}for(o$W=0,o$k=this._params.length;o$W<o$k;o$W++)if((o$T=this._params[o$W]).indexOfParams=o$W,o$T.index=1,o$T.value=[o$T.location,null],o$T.codename=o$T.name,o$T.name=this._nameMap[o$T.codename]?this._nameMap[o$T.codename]:o$T.codename,(this._paramsMap[o$T.name]=o$T)._this=this,o$T.uploadedValue=[],"attribute"!==o$T.vartype)switch(o$T.type){case 5124:o$T.fun=o$T.isArray?this._uniform1iv:this._uniform1i;break;case 5126:o$T.fun=o$T.isArray?this._uniform1fv:this._uniform1f;break;case 35664:o$T.fun=o$T.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:o$T.fun=o$T.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:o$T.fun=o$T.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:o$T.fun=this._uniform_sampler2D;break;case 35680:o$T.fun=this._uniform_samplerCube;break;case 35676:o$T.glfun=o$r.uniformMatrix4fv,o$T.fun=this._uniformMatrix4fv;break;case 35670:o$T.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else o$T.fun=this._attribute}},o$r.getUniform=function(o$o){return this._paramsMap[o$o]},o$r._attribute=function(o$o,o$r){var o$T=o$lo.mainContext,o$k=o$co._enableAtributes,o$W=o$o.location;return o$k[o$W]||o$T.enableVertexAttribArray(o$W),o$T.vertexAttribPointer(o$W,o$r[0],o$r[1],o$r[2],o$r[3],o$r[4]+this._offset),o$k[o$W]=o$co._bindVertexBuffer,1},o$r._uniform1f=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r?(o$lo.mainContext.uniform1f(o$o.location,o$T[0]=o$r),1):0},o$r._uniform1fv=function(o$o,o$r){if(o$r.length<4){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]||o$T[2]!==o$r[2]||o$T[3]!==o$r[3]?(o$lo.mainContext.uniform1fv(o$o.location,o$r),o$T[0]=o$r[0],o$T[1]=o$r[1],o$T[2]=o$r[2],o$T[3]=o$r[3],1):0}return o$lo.mainContext.uniform1fv(o$o.location,o$r),1},o$r._uniform_vec2=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]?(o$lo.mainContext.uniform2f(o$o.location,o$T[0]=o$r[0],o$T[1]=o$r[1]),1):0},o$r._uniform_vec2v=function(o$o,o$r){if(o$r.length<2){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]||o$T[2]!==o$r[2]||o$T[3]!==o$r[3]?(o$lo.mainContext.uniform2fv(o$o.location,o$r),o$T[0]=o$r[0],o$T[1]=o$r[1],o$T[2]=o$r[2],o$T[3]=o$r[3],1):0}return o$lo.mainContext.uniform2fv(o$o.location,o$r),1},o$r._uniform_vec3=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]||o$T[2]!==o$r[2]?(o$lo.mainContext.uniform3f(o$o.location,o$T[0]=o$r[0],o$T[1]=o$r[1],o$T[2]=o$r[2]),1):0},o$r._uniform_vec3v=function(o$o,o$r){return o$lo.mainContext.uniform3fv(o$o.location,o$r),1},o$r._uniform_vec4=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]||o$T[2]!==o$r[2]||o$T[3]!==o$r[3]?(o$lo.mainContext.uniform4f(o$o.location,o$T[0]=o$r[0],o$T[1]=o$r[1],o$T[2]=o$r[2],o$T[3]=o$r[3]),1):0},o$r._uniform_vec4v=function(o$o,o$r){return o$lo.mainContext.uniform4fv(o$o.location,o$r),1},o$r._uniformMatrix2fv=function(o$o,o$r){return o$lo.mainContext.uniformMatrix2fv(o$o.location,!1,o$r),1},o$r._uniformMatrix3fv=function(o$o,o$r){return o$lo.mainContext.uniformMatrix3fv(o$o.location,!1,o$r),1},o$r._uniformMatrix4fv=function(o$o,o$r){return o$lo.mainContext.uniformMatrix4fv(o$o.location,!1,o$r),1},o$r._uniform1i=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r?(o$lo.mainContext.uniform1i(o$o.location,o$T[0]=o$r),1):0},o$r._uniform1iv=function(o$o,o$r){return o$lo.mainContext.uniform1iv(o$o.location,o$r),1},o$r._uniform_ivec2=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]?(o$lo.mainContext.uniform2i(o$o.location,o$T[0]=o$r[0],o$T[1]=o$r[1]),1):0},o$r._uniform_ivec2v=function(o$o,o$r){return o$lo.mainContext.uniform2iv(o$o.location,o$r),1},o$r._uniform_vec3i=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]||o$T[2]!==o$r[2]?(o$lo.mainContext.uniform3i(o$o.location,o$T[0]=o$r[0],o$T[1]=o$r[1],o$T[2]=o$r[2]),1):0},o$r._uniform_vec3vi=function(o$o,o$r){return o$lo.mainContext.uniform3iv(o$o.location,o$r),1},o$r._uniform_vec4i=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]||o$T[2]!==o$r[2]||o$T[3]!==o$r[3]?(o$lo.mainContext.uniform4i(o$o.location,o$T[0]=o$r[0],o$T[1]=o$r[1],o$T[2]=o$r[2],o$T[3]=o$r[3]),1):0},o$r._uniform_vec4vi=function(o$o,o$r){return o$lo.mainContext.uniform4iv(o$o.location,o$r),1},o$r._uniform_sampler2D=function(o$o,o$r){var o$T=o$lo.mainContext,o$k=o$o.uploadedValue;return null==o$k[0]?(o$k[0]=this._curActTexIndex,o$T.uniform1i(o$o.location,this._curActTexIndex),o$T.activeTexture(o$U._TEXTURES[this._curActTexIndex]),o$So.bindTexture(o$T,3553,o$r),this._curActTexIndex++,1):(o$T.activeTexture(o$U._TEXTURES[o$k[0]]),o$So.bindTexture(o$T,3553,o$r),0)},o$r._uniform_samplerCube=function(o$o,o$r){var o$T=o$lo.mainContext,o$k=o$o.uploadedValue;return null==o$k[0]?(o$k[0]=this._curActTexIndex,o$T.uniform1i(o$o.location,this._curActTexIndex),o$T.activeTexture(o$U._TEXTURES[this._curActTexIndex]),o$So.bindTexture(o$T,34067,o$r),this._curActTexIndex++,1):(o$T.activeTexture(o$U._TEXTURES[o$k[0]]),o$So.bindTexture(o$T,34067,o$r),0)},o$r._noSetValue=function(o$o){console.log("no....:"+o$o.name)},o$r.uploadOne=function(o$o,o$r){this.activeResource(),o$So.UseProgram(this._program);var o$T=this._paramsMap[o$o];o$T.fun.call(this,o$T,o$r)},o$r.uploadTexture2D=function(o$o){o$s.shaderCall++;var o$r=o$lo.mainContext;o$r.activeTexture(33984),o$So.bindTexture(o$r,3553,o$o)},o$r.uploadTexture2D1=function(o$o){o$s.shaderCall++;var o$r=o$lo.mainContext;o$r.activeTexture(33985),o$So.bindTexture(o$r,3553,o$o)},o$r.upload=function(o$o,o$r){o$Oo.activeShader=o$Oo.bindShader=this,this._lastUseFrameCount===o$s.loopCount||this.activeResource(),o$So.UseProgram(this._program),this._reCompile?(o$r=this._params,this._reCompile=!1):o$r=o$r||this._params;o$lo.mainContext;for(var o$T,o$k,o$W=o$r.length,o$D=0,o$n=0;o$n<o$W;o$n++)null!==(o$k=o$o[(o$T=o$r[o$n]).name])&&(o$D+=o$T.fun.call(this,o$T,o$k));o$s.shaderCall+=o$D},o$r.uploadArray=function(o$o,o$r,o$T){o$Oo.activeShader=this,(o$Oo.bindShader=this).activeResource(),o$So.UseProgram(this._program);this._params;for(var o$k,o$W,o$D=0,o$n=o$r-2;0<=o$n;o$n-=2)(o$W=this._paramsMap[o$o[o$n]])&&null!=(o$k=o$o[o$n+1])&&(o$T&&o$T[o$W.name]&&o$T[o$W.name].bind(),o$D+=o$W.fun.call(this,o$W,o$k));o$s.shaderCall+=o$D},o$r.getParams=function(){return this._params},o$U.getShader=function(o$o){return o$U.sharders[o$o]},o$U.create=function(o$o,o$r,o$T,o$k){return new o$U(o$o,o$r,o$T,o$k)},o$U.withCompile=function(o$o,o$r,o$T,o$k){if(o$T&&o$U.sharders[o$T])return o$U.sharders[o$T];var o$W=o$U._preCompileShader[2e-4*o$o];if(!o$W)throw new Error("withCompile shader err!"+o$o);return o$W.createShader(o$r,o$T,o$k)},o$U.withCompile2D=function(o$o,o$r,o$T,o$k,o$W){if(o$k&&o$U.sharders[o$k])return o$U.sharders[o$k];var o$D=o$U._preCompileShader[2e-4*o$o+o$r];if(!o$D)throw new Error("withCompile shader err!"+o$o+" "+o$r);return o$D.createShader(o$T,o$k,o$W)},o$U.addInclude=function(o$o,o$r){o$yo.addInclude(o$o,o$r)},o$U.preCompile=function(o$o,o$r,o$T,o$k){var o$W=2e-4*o$o;o$U._preCompileShader[o$W]=new o$yo(o$W,o$r,o$T,o$k)},o$U.preCompile2D=function(o$o,o$r,o$T,o$k,o$W){var o$D=2e-4*o$o+o$r;o$U._preCompileShader[o$D]=new o$yo(o$D,o$T,o$k,o$W)},o$U._createShader=function(o$o,o$r,o$T){var o$k=o$o.createShader(o$T);return o$o.shaderSource(o$k,o$r),o$o.compileShader(o$k),o$k},o$U._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],o$U._count=0,o$U._preCompileShader={},o$U.SHADERNAME2ID=2e-4,o$U.sharders=((o$U.sharders=[]).length=32,o$U.sharders),o$n(o$U,["nameKey",function(){return this.nameKey=new o$z}]),o$U}(),o$Qo=function(o$o){function o$r(){this._maxsize=0,this._upload=!0,this._uploadSize=0,o$r.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}o$i(o$r,"laya.webgl.utils.Buffer2D",o$o);var o$T=o$r.prototype;return o$T.needSize=function(o$o){var o$r=this._byteLength;if(o$o){var o$T=this._byteLength+o$o;o$T<=this._buffer.byteLength||this._resizeBuffer(o$T<<1,!0),this._byteLength=o$T}return o$r},o$T._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),o$s.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,o$co._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),o$co._gl.bufferSubData(this._bufferType,0,this._buffer)},o$T._bufferSubData=function(o$o,o$r,o$T){if(void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),this._maxsize=Math.max(this._maxsize,this._byteLength),o$s.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,o$co._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),o$r||o$T){var o$k=this._buffer.slice(o$r,o$T);o$co._gl.bufferSubData(this._bufferType,o$o,o$k)}else o$co._gl.bufferSubData(this._bufferType,o$o,this._buffer)},o$T._checkArrayUse=function(){},o$T._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},o$T._bind_subUpload=function(o$o,o$r,o$T){return void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(o$o,o$r,o$T),!0)},o$T._resizeBuffer=function(o$o,o$r){if(o$o<this._buffer.byteLength)return this;if(this.memorySize=o$o,o$r&&this._buffer&&0<this._buffer.byteLength){var o$T=new ArrayBuffer(o$o);new Uint8Array(o$T).set(new Uint8Array(this._buffer),0),this._buffer=o$T}else this._buffer=new ArrayBuffer(o$o);return this._checkArrayUse(),this._upload=!0,this},o$T.append=function(o$o){this._upload=!0;var o$r,o$T;o$r=o$o.byteLength,o$o instanceof Uint8Array?(this._resizeBuffer(this._byteLength+o$r,!0),o$T=new Uint8Array(this._buffer,this._byteLength)):o$o instanceof Uint16Array?(this._resizeBuffer(this._byteLength+o$r,!0),o$T=new Uint16Array(this._buffer,this._byteLength)):o$o instanceof Float32Array&&(this._resizeBuffer(this._byteLength+o$r,!0),o$T=new Float32Array(this._buffer,this._byteLength)),o$T.set(o$o,0),this._byteLength+=o$r,this._checkArrayUse()},o$T.appendU16Array=function(o$o,o$r){this._resizeBuffer(this._byteLength+2*o$r,!0);for(var o$T=new Uint16Array(this._buffer,this._byteLength,o$r),o$k=0;o$k<o$r;o$k++)o$T[o$k]=o$o[o$k];this._byteLength+=2*o$r,this._checkArrayUse()},o$T.appendEx=function(o$o,o$r){this._upload=!0;var o$T;o$T=o$o.byteLength,this._resizeBuffer(this._byteLength+o$T,!0),new o$r(this._buffer,this._byteLength).set(o$o,0),this._byteLength+=o$T,this._checkArrayUse()},o$T.appendEx2=function(o$o,o$r,o$T,o$k){void 0===o$k&&(o$k=1),this._upload=!0;var o$W,o$D;o$W=o$T*o$k,this._resizeBuffer(this._byteLength+o$W,!0),o$D=new o$r(this._buffer,this._byteLength);var o$n=0;for(o$n=0;o$n<o$T;o$n++)o$D[o$n]=o$o[o$n];this._byteLength+=o$W,this._checkArrayUse()},o$T.getBuffer=function(){return this._buffer},o$T.setNeedUpload=function(){this._upload=!0},o$T.getNeedUpload=function(){return this._upload},o$T.upload=function(){var o$o=this._bind_upload();return o$co._gl.bindBuffer(this._bufferType,null),o$co._bindActive[this._bufferType]=null,o$Oo.activeShader=null,o$o},o$T.subUpload=function(o$o,o$r,o$T){void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0);var o$k=this._bind_subUpload();return o$co._gl.bindBuffer(this._bufferType,null),o$co._bindActive[this._bufferType]=null,o$Oo.activeShader=null,o$k},o$T.disposeResource=function(){o$o.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},o$T.clear=function(){this._byteLength=0,this._upload=!0},o$k(0,o$T,"bufferLength",function(){return this._buffer.byteLength}),o$k(0,o$T,"byteLength",null,function(o$o){this._byteLength!==o$o&&(o$o<=this._buffer.byteLength||this._resizeBuffer(2*o$o+256,!0),this._byteLength=o$o)}),o$r.__int__=function(o$o){o$Eo.QuadrangleIB=o$Eo.create(35044),o$_o.fillIBQuadrangle(o$Eo.QuadrangleIB,16)},o$r.FLOAT32=4,o$r.SHORT=2,o$r}(o$co),o$go=(function(o$r){function o$T(o$o){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,o$T.__super.call(this,9)}o$i(o$T,"laya.webgl.shader.d2.value.GlowSV",o$r);var o$o=o$T.prototype;o$o.setValue=function(o$o){o$r.prototype.setValue.call(this,o$o)},o$o.clear=function(){o$r.prototype.clear.call(this)}}(o$Ao),function(o$o){function o$r(o$o){o$r.__super.call(this,64),this.defines.add(64)}o$i(o$r,"laya.webgl.shader.d2.value.TextSV",o$o);var o$T=o$r.prototype;return o$T.release=function(){(o$r.pool[o$r._length++]=this).clear()},o$T.clear=function(){o$o.prototype.clear.call(this)},o$r.create=function(){return o$r._length?o$r.pool[--o$r._length]:new o$r(null)},o$r.pool=[],o$r._length=0,o$r}(o$Ao)),o$Bo=function(o$o){function o$W(o$o,o$r,o$T,o$k){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,o$W.__super.call(this,o$o,o$r,o$T,o$k)}o$i(o$W,"laya.webgl.shader.d2.Shader2X",o$o);var o$r=o$W.prototype;return o$r.upload2dQuick1=function(o$o){this.upload(o$o,this._params2dQuick1||this._make2dQuick1())},o$r._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var o$o,o$r=this._params,o$T=0,o$k=o$r.length;o$T<o$k;o$T++)o$o=o$r[o$T],(o$K.isFlash||"size"!==o$o.name&&"position"!==o$o.name&&"texcoord"!==o$o.name)&&this._params2dQuick1.push(o$o)}return this._params2dQuick1},o$r.disposeResource=function(){o$o.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},o$r.upload2dQuick2=function(o$o){this.upload(o$o,this._params2dQuick2||this._make2dQuick2())},o$r._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var o$o,o$r=this._params,o$T=0,o$k=o$r.length;o$T<o$k;o$T++)o$o=o$r[o$T],(o$K.isFlash||"size"!==o$o.name)&&this._params2dQuick2.push(o$o)}return this._params2dQuick2},o$W.create=function(o$o,o$r,o$T,o$k){return new o$W(o$o,o$r,o$T,o$k)},o$W}(o$Zo),o$Eo=function(o$o){function o$r(o$o){this._uint8Array=null,this._uint16Array=null,void 0===o$o&&(o$o=35044),o$r.__super.call(this),this._bufferUsage=o$o,this._bufferType=34963,o$K.isFlash||(this._buffer=new ArrayBuffer(8))}o$i(o$r,"laya.webgl.utils.IndexBuffer2D",o$Qo);var o$T=o$r.prototype;return o$T._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},o$T.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},o$T.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},o$T.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},o$r.QuadrangleIB=null,o$r.create=function(o$o){return void 0===o$o&&(o$o=35044),new o$r(o$o)},o$r}(),o$do=function(o$o){function o$T(o$o,o$r){this._floatArray32=null,this._vertexStride=0,o$T.__super.call(this),this._vertexStride=o$o,this._bufferUsage=o$r,this._bufferType=34962,o$K.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}o$i(o$T,"laya.webgl.utils.VertexBuffer2D",o$o);var o$r=o$T.prototype;return o$r.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},o$r.bind=function(o$o){o$o&&o$o._bind(),this._bind()},o$r.insertData=function(o$o,o$r){this.getFloat32Array().set(o$o,o$r),this._upload=!0},o$r.bind_upload=function(o$o){o$o._bind_upload()||o$o._bind(),this._bind_upload()||this._bind()},o$r._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},o$r.disposeResource=function(){o$o.prototype.disposeResource.call(this)},o$r.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},o$k(0,o$r,"vertexStride",function(){return this._vertexStride}),o$T.create=function(o$o,o$r){return void 0===o$r&&(o$r=35048),new o$T(o$o,o$r)},o$T}(o$Qo),o$or=function(o$o){function o$V(o$o,o$r,o$T,o$k,o$W,o$D){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===o$T&&(o$T=6408),void 0===o$k&&(o$k=!0),o$V.__super.call(this,o$o,o$r),o$o){if(this._format=o$T,this._mipmap=o$k,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof o$o)this._url=o$o,this._src=o$o,this._image=new o$v.window.Image,o$r&&(o$r.onload&&(this.onload=o$r.onload),o$r.onerror&&(this.onerror=o$r.onerror),o$r.onCreate&&o$r.onCreate(this)),this._image.crossOrigin=o$o&&0==o$o.indexOf("data:")?null:"",o$o&&(this._image.src=o$o);else if(o$o instanceof ArrayBuffer){this._src=o$r,this._url=this._src;var o$n=new o$L(o$o);o$n.readUTFBytes(4),o$n.readUTFBytes(2),o$n.getInt16();o$n.endian="bigEndian",this._w=o$n.getInt16(),this._h=o$n.getInt16();o$n.getInt16(),o$n.getInt16();this._image=new Uint8Array(o$o,o$n.pos),this._format=o$lo.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,o$Y.enabled&&this._w<o$Y.atlasLimitWidth&&this._h<o$Y.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(o$o instanceof Uint8Array))return this._src=o$r,this._url=this._src,this._image=o$o.source||o$o,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=o$r,this._url=this._src,this._w=o$W,this._h=o$D,this._image=o$o,this._format=0===o$T?o$o.byteLength/(o$W*o$D)==4?6408:6407:o$T}this._$5__enableMerageInAtlas=!0}}o$i(o$V,"laya.webgl.resource.WebGLImage",o$j);var o$r=o$V.prototype;return o$q.imps(o$r,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),o$r._init_=function(o$o,o$r){},o$r._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var o$o=o$lo.mainContext,o$r=this._source=o$o.createTexture(),o$T=o$So.curBindTexTarget,o$k=o$So.curBindTexValue;o$So.bindTexture(o$o,3553,o$r);var o$W=this.minFifter,o$D=this.magFifter,o$n=this.repeat?10497:33071,o$V=o$h.isPOT(this._w,this._h),o$L=!1;switch(o$V?(this.mipmap?-1!==o$W||(o$W=9987):-1!==o$W||(o$W=9729),-1!==o$D||(o$D=9729),o$o.texParameteri(3553,10241,o$W),o$o.texParameteri(3553,10240,o$D),o$o.texParameteri(3553,10242,o$n),o$o.texParameteri(3553,10243,o$n),this.mipmap&&o$o.generateMipmap(3553)):(-1!==o$W||(o$W=9729),-1!==o$D||(o$D=9729),o$o.texParameteri(3553,10241,o$W),o$o.texParameteri(3553,10240,o$D),o$o.texParameteri(3553,10242,33071),o$o.texParameteri(3553,10243,33071)),o$o.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&o$o.pixelStorei(o$o.UNPACK_ALIGNMENT,1),o$o.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&o$o.pixelStorei(o$o.UNPACK_ALIGNMENT,1),o$o.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:o$L=!0,o$o.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case o$lo.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:o$L=!0,o$o.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}o$o.pixelStorei(37441,!1),o$T&&o$k&&o$So.bindTexture(o$o,o$T,o$k),this.uri||(this.uri=this._url),o$L?this.memorySize=this._image.length:o$V&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},o$r.recreateResource=function(){var o$o=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var o$r=this;this._image=new o$v.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(o$r._needReleaseAgain)return o$r._needReleaseAgain=!1,o$r._image.onload=null,void(o$r._image=null);o$r._allowMerageInAtlas&&o$r._enableMerageInAtlas?(o$o.memorySize=0,o$o._recreateLock=!1):o$r._createWebGlTexture(),o$r.completeCreate()},this._image.src=this._src}},o$r.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&o$lo.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},o$r.onresize=function(){this._w=this._image.width,this._h=this._image.height,o$Y.enabled&&this._w<o$Y.atlasLimitWidth&&this._h<o$Y.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},o$r.clearAtlasSource=function(){this._image=null},o$k(0,o$r,"format",function(){return this._format}),o$k(0,o$r,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(o$o){this._$5__enableMerageInAtlas=o$o}),o$k(0,o$r,"mipmap",function(){return this._mipmap}),o$k(0,o$r,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),o$k(0,o$r,"atlasSource",function(){return this._image}),o$k(0,o$r,"onload",null,function(o$o){var o$r=this;this._onload=o$o,this._image&&(this._image.onload=null!=this._onload?function(){o$r.onresize(),o$r._onload()}:null)}),o$k(0,o$r,"onerror",null,function(o$o){var o$r=this;this._onerror=o$o,this._image&&(this._image.onerror=null!=this._onerror?function(){o$r._onerror()}:null)}),o$V}();o$q.__init([o$vo,o$J,o$bo,o$yo])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(o$o,o$r){"use strict";for(var o$T in Object.defineProperty(o$r,"__esModule",{value:!0}),Laya){var o$k=Laya[o$T];o$k&&o$k.__isclass&&(o$r[o$T]=o$k)}}),function(o$D,o$o,o$k){o$k.un,o$k.uns;var o$W=o$k.static,o$n=o$k.class,o$V=o$k.getset,o$L=(o$k.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),o$x=laya.utils.ClassUtils,o$p=(laya.events.Event,laya.utils.HTMLChar),o$U=laya.net.Loader,o$h=(laya.display.Node,laya.maths.Rectangle),o$i=laya.renders.Render,o$v=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),o$j=laya.utils.Stat,o$O=laya.display.Text,o$_=laya.resource.Texture,o$K=laya.net.URL,o$$=laya.utils.Utils,o$y=function(){function o$v(){}return o$n(o$v,"laya.html.utils.HTMLParse"),o$v.parse=function(o$o,o$r,o$T){o$r=(o$r="<root>"+(o$r=o$r.replace(/<br>/g,"<br/>"))+"</root>").replace(o$v.spacePattern,o$v.char255);var o$k=o$$.parseXMLFromString(o$r);o$v._parseXML(o$o,o$k.childNodes[0].childNodes,o$T)},o$v._parseXML=function(o$o,o$r,o$T,o$k){var o$W=0,o$D=0;if(o$r.join||o$r.item)for(o$W=0,o$D=o$r.length;o$W<o$D;++o$W)o$v._parseXML(o$o,o$r[o$W],o$T,o$k);else{var o$n,o$V,o$L;if(3==o$r.nodeType)return void(o$o instanceof laya.html.dom.HTMLDivElement?(null==o$r.nodeName&&(o$r.nodeName="#text"),o$V=o$r.nodeName.toLowerCase(),0<(o$L=o$r.textContent.replace(/^\s+|\s+$/g,"")).length&&(o$n=o$x.getInstance(o$V))&&(o$o.addChild(o$n),o$n.innerTEXT=o$L.replace(o$v.char255AndOneSpacePattern," "))):0<(o$L=o$r.textContent.replace(/^\s+|\s+$/g,"")).length&&(o$o.innerTEXT=o$L.replace(o$v.char255AndOneSpacePattern," ")));if("#comment"==(o$V=o$r.nodeName.toLowerCase()))return;if(o$n=o$x.getInstance(o$V)){(o$n=o$o.addChild(o$n)).URI=o$T,o$n.href=o$k;var o$U=o$r.attributes;if(o$U&&0<o$U.length)for(o$W=0,o$D=o$U.length;o$W<o$D;++o$W){var o$h=o$U[o$W],o$p=o$h.nodeName,o$i=o$h.value;o$n._setAttributes(o$p,o$i)}o$v._parseXML(o$n,o$r.childNodes,o$T,o$n.href)}else o$v._parseXML(o$o,o$r.childNodes,o$T,o$k)}},o$v.char255=String.fromCharCode(255),o$v.spacePattern=/&nbsp;|&#160;/g,o$v.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),o$v}(),o$l=function(){function o$X(){}return o$n(o$X,"laya.html.utils.Layout"),o$X.later=function(o$o){null==o$X._will&&(o$X._will=[],o$k.stage.frameLoop(1,null,function(){if(!(o$X._will.length<1)){for(var o$o=0;o$o<o$X._will.length;o$o++)laya.html.utils.Layout.layout(o$X._will[o$o]);o$X._will.length=0}})),o$X._will.push(o$o)},o$X.layout=function(o$o){if(!o$o||!o$o._style)return null;if(0==(512&o$o._style._type))return null;o$o.getStyle()._type&=-513;var o$r=o$X._multiLineLayout(o$o);return o$i.isConchApp&&o$o.layaoutCallNative&&o$o.layaoutCallNative(),o$r},o$X._multiLineLayout=function(o$o){if(o$O.RightToLeft)return o$X._multiLineLayout2(o$o);var o$r=new Array;o$o._addChildsToLayout(o$r);var o$T,o$k,o$W,o$D,o$n,o$V=0,o$L=o$r.length,o$U=o$o._getCSSStyle(),o$h=o$U.letterSpacing,o$p=o$U.leading,o$i=o$U.lineHeight,o$v=o$U._widthAuto()||!o$U.wordWrap,o$x=o$v?999999:o$o.width,o$j=(o$o.height,0),o$_=o$U.italic?o$U.fontSize/3:0,o$K=o$U._getAlign(),o$$=o$U._getValign(),o$y=0!==o$$||0!==o$K||0!=o$i,o$l=0,o$S=0,o$q=0,o$b=0,o$F=new Array,o$P=o$F[0]=new o$M,o$t=!1,o$H=!1;o$P.h=0,o$U.italic&&(o$x-=o$U.fontSize/3);var o$R=0,o$u=!0;function o$s(){o$P.y=o$S,o$S+=o$P.h+o$p,0==o$P.h&&(o$S+=o$i),o$P.mWidth=o$R,o$R=0,o$P=new o$M,o$F.push(o$P),o$P.h=0,o$t=!(o$u=!(o$l=0))}for(o$V=0;o$V<o$L;o$V++)if(null!=(o$T=o$r[o$V]))if(o$u=!1,o$T instanceof laya.html.dom.HTMLBrElement)o$s(),o$P.y=o$S;else{if(o$T._isChar()){if((o$D=o$T).isWord)o$t=o$H||"\n"===o$D.char,o$P.wordStartIndex=o$P.elements.length;else{if(o$q=o$D.width+o$D.style.letterSpacin,0<o$F.length&&o$x<o$l+o$q&&0<o$P.wordStartIndex){var o$z;o$z=o$P.elements.length-o$P.wordStartIndex+1,o$P.elements.length=o$P.wordStartIndex,o$V-=o$z,o$s();continue}o$t=!1,o$R+=o$D.width}o$q=o$D.width+o$h,o$b=o$D.height,o$H=!1,(o$t=o$t||o$x<o$l+o$q)&&o$s(),o$P.minTextHeight=Math.min(o$P.minTextHeight,o$T.height)}else o$k=o$T._getCSSStyle(),o$n=o$T,o$W=o$k.padding,0===o$k._getCssFloat()||(o$y=!0),o$t=o$H||o$k.lineElement,o$q=o$n.width*o$n._style._tf.scaleX+o$W[1]+o$W[3]+o$h,o$b=o$n.height*o$n._style._tf.scaleY+o$W[0]+o$W[2],o$H=o$k.lineElement,(o$t=o$t||o$x<o$l+o$q&&o$k.wordWrap)&&o$s();o$P.elements.push(o$T),o$P.h=Math.max(o$P.h,o$b),o$T.x=o$l,o$T.y=o$S,o$l+=o$q,o$P.w=o$l-o$h,o$P.y=o$S,o$j=Math.max(o$l+o$_,o$j)}else o$u||(o$l+=o$X.DIV_ELEMENT_PADDING),o$P.wordStartIndex=o$P.elements.length;if(o$S=o$P.y+o$P.h,o$y){var o$m=0,o$C=o$x;for(o$v&&0<o$o.width&&(o$C=o$o.width),o$V=0,o$L=o$F.length;o$V<o$L;o$V++)o$F[o$V].updatePos(0,o$C,o$V,o$m,o$K,o$$,o$i),o$m+=Math.max(o$i,o$F[o$V].h+o$p);o$S=o$m}return o$v&&(o$o.width=o$j),o$S>o$o.height&&(o$o.height=o$S),[o$j,o$S]},o$X._multiLineLayout2=function(o$o){var o$r=new Array;o$o._addChildsToLayout(o$r);var o$T,o$k,o$W,o$D,o$n,o$V=0,o$L=o$r.length,o$U=o$o._getCSSStyle(),o$h=o$U.letterSpacing,o$p=o$U.leading,o$i=o$U.lineHeight,o$v=o$U._widthAuto()||!o$U.wordWrap,o$x=o$v?999999:o$o.width,o$j=(o$o.height,0),o$_=o$U.italic?o$U.fontSize/3:0,o$K=2-o$U._getAlign(),o$$=o$U._getValign(),o$y=0!==o$$||0!=o$K||0!=o$i,o$l=0,o$S=0,o$q=0,o$b=0,o$F=new Array,o$P=o$F[0]=new o$M,o$t=!1,o$H=!1;o$P.h=0,o$U.italic&&(o$x-=o$U.fontSize/3);var o$R=0,o$u=!0;function o$s(){o$P.y=o$S,o$S+=o$P.h+o$p,0==o$P.h&&(o$S+=o$i),o$P.mWidth=o$R,o$R=0,o$P=new o$M,o$F.push(o$P),o$P.h=0,o$t=!(o$u=!(o$l=0))}for(o$V=0;o$V<o$L;o$V++)if(null!=(o$T=o$r[o$V]))if(o$u=!1,o$T instanceof laya.html.dom.HTMLBrElement)o$s(),o$P.y=o$S;else{if(o$T._isChar()){if((o$D=o$T).isWord)o$t=o$H||"\n"===o$D.char,o$P.wordStartIndex=o$P.elements.length;else{if(0<o$F.length&&o$x<o$l+o$q&&0<o$P.wordStartIndex){var o$z;o$z=o$P.elements.length-o$P.wordStartIndex+1,o$P.elements.length=o$P.wordStartIndex,o$V-=o$z,o$s();continue}o$t=!1,o$R+=o$D.width}o$q=o$D.width+o$h,o$b=o$D.height,o$H=!1,(o$t=o$t||o$x<o$l+o$q)&&o$s(),o$P.minTextHeight=Math.min(o$P.minTextHeight,o$T.height)}else o$k=o$T._getCSSStyle(),o$n=o$T,o$W=o$k.padding,0===o$k._getCssFloat()||(o$y=!0),o$t=o$H||o$k.lineElement,o$q=o$n.width*o$n._style._tf.scaleX+o$W[1]+o$W[3]+o$h,o$b=o$n.height*o$n._style._tf.scaleY+o$W[0]+o$W[2],o$H=o$k.lineElement,(o$t=o$t||o$x<o$l+o$q&&o$k.wordWrap)&&o$s();o$P.elements.push(o$T),o$P.h=Math.max(o$P.h,o$b),o$T.x=o$l,o$T.y=o$S,o$l+=o$q,o$P.w=o$l-o$h,o$P.y=o$S,o$j=Math.max(o$l+o$_,o$j)}else o$u||(o$l+=o$X.DIV_ELEMENT_PADDING),o$P.wordStartIndex=o$P.elements.length;if(o$S=o$P.y+o$P.h,o$y){var o$m=0,o$C=o$x;for(o$V=0,o$L=o$F.length;o$V<o$L;o$V++)o$F[o$V].updatePos(0,o$C,o$V,o$m,o$K,o$$,o$i),o$m+=Math.max(o$i,o$F[o$V].h+o$p);o$S=o$m}for(o$v&&(o$o.width=o$j),o$S>o$o.height&&(o$o.height=o$S),o$V=0,o$L=o$F.length;o$V<o$L;o$V++)o$F[o$V].revertOrder(o$x);return[o$j,o$S]},o$X._will=null,o$X.DIV_ELEMENT_PADDING=0,o$X}(),o$M=function(){function o$o(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}o$n(o$o,"laya.html.utils.LayoutLine");var o$r=o$o.prototype;return o$r.updatePos=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){var o$V,o$L=0;0<this.elements.length&&(o$L=(o$V=this.elements[this.elements.length-1]).x+o$V.width-this.elements[0].x);var o$U=0,o$h=NaN;1===o$W&&(o$U=(o$r-o$L)/2),2===o$W&&(o$U=o$r-o$L),0===o$n||0!=o$D||(o$D=1);for(var o$p=0,o$i=this.elements.length;o$p<o$i;o$p++){var o$v=(o$V=this.elements[o$p])._getCSSStyle();switch(0!==o$U&&(o$V.x+=o$U),o$v._getValign()){case 0:o$V.y=o$k;break;case 1:var o$x=0;99999!=this.minTextHeight&&(o$x=this.minTextHeight);var o$j=(o$x+o$n)/2;o$j=Math.max(o$j,this.h),o$h=(laya.html.dom.HTMLImageElement,o$k+o$j-o$V.height),o$V.y=o$h;break;case 2:o$V.y=o$k+(o$n-o$V.height)}}},o$r.revertOrder=function(o$o){var o$r;if(0<this.elements.length){var o$T,o$k=0;for(o$T=this.elements.length,o$k=0;o$k<o$T;o$k++)(o$r=this.elements[o$k]).x=o$o-o$r.x-o$r.width}},o$o}(),o$S=function(o$T){function o$r(){this.URI=null,this._href=null,o$r.__super.call(this),this._text=o$r._EMPTYTEXT,this.setStyle(new o$L(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}o$n(o$r,"laya.html.dom.HTMLElement",o$T);var o$o=o$r.prototype;return o$o.layaoutCallNative=function(){var o$o=0;if(this._childs&&0<(o$o=this._childs.length))for(var o$r=0;o$r<o$o;o$r++)this._childs[o$r].layaoutCallNative&&this._childs[o$r].layaoutCallNative();var o$T=this._getWords();o$T?laya.html.dom.HTMLElement.fillWords(this,o$T,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},o$o.appendChild=function(o$o){return this.addChild(o$o)},o$o._getWords2=function(){var o$o=this._text.text;if(!o$o||0===o$o.length)return null;var o$r,o$T,o$k=0,o$W=0;if(this._text.drawWords)o$T=this._text.drawWords;else{for(o$W=(o$r=o$o.split(" ")).length-1,o$T=[],o$k=0;o$k<o$W;o$k++)o$T.push(o$r[o$k]," ");0<=o$W&&o$T.push(o$r[o$W]),this._text.drawWords=o$T}var o$D,o$n=this._text.words;if(o$n&&o$n.length===o$T.length)return o$n;null===o$n&&(this._text.words=o$n=[]),o$n.length=o$T.length;var o$V=this.style,o$L=o$V.font;for(o$k=0,o$W=o$T.length;o$k<o$W;o$k++){o$D=o$$.measureText(o$T[o$k],o$L);var o$U=o$n[o$k]=new o$p(o$T[o$k],o$D.width,o$D.height||o$V.fontSize,o$V);if(1<o$U.char.length&&(o$U.charNum=o$U.char),this.href){var o$h=new o$v;this.addChild(o$h),o$U.setSprite(o$h)}}return o$n},o$o._getWords=function(){if(!o$O.CharacterCache)return this._getWords2();var o$o=this._text.text;if(!o$o||0===o$o.length)return null;var o$r,o$T=this._text.words;if(o$T&&o$T.length===o$o.length)return o$T;null===o$T&&(this._text.words=o$T=[]),o$T.length=o$o.length;for(var o$k=this.style,o$W=o$k.font,o$D=0,o$n=o$o.length;o$D<o$n;o$D++)if(o$r=o$$.measureText(o$o.charAt(o$D),o$W)){var o$V=o$T[o$D]=new o$p(o$o.charAt(o$D),o$r.width,o$r.height||o$k.fontSize,o$k);if(this.href){var o$L=new o$v;this.addChild(o$L),o$V.setSprite(o$L)}}else console.warn("_getWords size is null"+o$o.charAt(o$D),o$W);return o$T},o$o.showLinkSprite=function(){var o$o=this._text.words;if(o$o)for(var o$r,o$T,o$k=[],o$W=0;o$W<o$o.length;o$W++)o$T=o$o[o$W],(o$r=new o$v).graphics.drawRect(0,0,o$T.width,o$T.height,"#ff0000"),o$r.width=o$T.width,o$r.height=o$T.height,this.addChild(o$r),o$k.push(o$r)},o$o._layoutLater=function(){var o$o=this.style;512&o$o._type||(o$o.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&o$o.block?(o$l.later(this),o$o._type|=512):this.parent&&this.parent._layoutLater())},o$o._setAttributes=function(o$o,o$r){switch(o$o){case"style":return void this.style.cssText(o$r);case"class":return void(this.className=o$r)}o$T.prototype._setAttributes.call(this,o$o,o$r)},o$o.updateHref=function(){if(null!=this._href){var o$o=this._getWords();if(o$o)for(var o$r,o$T,o$k=0;o$k<o$o.length;o$k++)(o$T=(o$r=o$o[o$k]).getSprite())&&(o$T.size(o$r.width,o$r.height),o$T.on("click",this,this.onLinkHandler))}},o$o.onLinkHandler=function(o$o){switch(o$o.type){case"click":for(var o$r=this;o$r;)o$r.event("link",[this.href]),o$r=o$r.parent}},o$o.formatURL=function(o$o){return this.URI?o$K.formatURL(o$o,this.URI?this.URI.path:null):o$o},o$V(0,o$o,"href",function(){return this._href},function(o$o){null!=(this._href=o$o)&&(this._getCSSStyle().underLine=1,this.updateHref())}),o$V(0,o$o,"color",null,function(o$o){this.style.color=o$o}),o$V(0,o$o,"onClick",null,function(o$o){o$k._runScript("fn=function(event){"+o$o+";}"),this.on("click",this,void 0)}),o$V(0,o$o,"id",null,function(o$o){o$q.document.setElementById(o$o,this)}),o$V(0,o$o,"innerTEXT",function(){return this._text.text},function(o$o){this.text=o$o}),o$V(0,o$o,"style",function(){return this._style}),o$V(0,o$o,"text",function(){return this._text.text},function(o$o){this._text==o$r._EMPTYTEXT?this._text={text:o$o,words:null}:(this._text.text=o$o,this._text.words&&(this._text.words.length=0)),o$i.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),o$V(0,o$o,"parent",o$T.prototype._$get_parent,function(o$o){if(o$o instanceof laya.html.dom.HTMLElement){var o$r=o$o;this.URI||(this.URI=o$r.URI),this.style.inherit(o$r.style)}o$k.superSet(o$v,this,"parent",o$o)}),o$V(0,o$o,"className",null,function(o$o){this.style.attrs(o$q.document.styleSheets["."+o$o])}),o$r.fillWords=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){o$o.graphics.clear();for(var o$V=0,o$L=o$r.length;o$V<o$L;o$V++){var o$U=o$r[o$V];o$o.graphics.fillText(o$U.char,o$U.x+o$T,o$U.y+o$k,o$W,o$D,"left",o$n)}},o$r._EMPTYTEXT={text:null,words:null},o$r}(o$v),o$r=(function(o$o){function o$r(){o$r.__super.call(this),this.style.lineElement=!0,this.style.block=!0}o$n(o$r,"laya.html.dom.HTMLBrElement",o$S)}(),function(o$o){function o$r(){this.contextHeight=NaN,this.contextWidth=NaN,o$r.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}o$n(o$r,"laya.html.dom.HTMLDivElement",o$o);var o$T=o$r.prototype;return o$T.appendHTML=function(o$o){o$y.parse(this,o$o,this.URI),this.layout()},o$T._addChildsToLayout=function(o$r){var o$o=this._getWords();if(null==o$o&&0==this._childs.length)return!1;o$o&&o$o.forEach(function(o$o){o$r.push(o$o)});for(var o$T=!0,o$k=0,o$W=this._childs.length;o$k<o$W;o$k++){var o$D=this._childs[o$k];o$T?o$T=!1:o$r.push(null),o$D._addToLayout(o$r)}return!0},o$T._addToLayout=function(o$o){this.layout()},o$T.layout=function(){if(this.style){this.style._type|=512;var o$o=o$l.layout(this);if(o$o){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new o$h);var o$r=this._$P.mHtmlBounds;o$r.x=o$r.y=0,o$r.width=this.contextWidth=o$o[0],o$r.height=this.contextHeight=o$o[1],this.setBounds(o$r)}}},o$V(0,o$T,"height",function(){return this._height?this._height:this.contextHeight},o$o.prototype._$set_height),o$V(0,o$T,"innerHTML",null,function(o$o){this.destroyChildren(),this.appendHTML(o$o)}),o$V(0,o$T,"width",function(){return this._width?this._width:this.contextWidth},function(o$o){var o$r=!1;o$r=0===o$o?o$o!=this._width:o$o!=this.width,o$k.superSet(o$S,this,"width",o$o),o$r&&this.layout()}),o$r}(o$S)),o$q=function(o$o){function o$r(){this.all=new Array,this.styleSheets=o$L.styleSheets,o$r.__super.call(this)}o$n(o$r,"laya.html.dom.HTMLDocument",o$S);var o$T=o$r.prototype;return o$T.getElementById=function(o$o){return this.all[o$o]},o$T.setElementById=function(o$o,o$r){this.all[o$o]=o$r},o$W(o$r,["document",function(){return this.document=new o$r}]),o$r}();(function(o$o){function o$r(){this._tex=null,this._url=null,this._renderArgs=[],o$r.__super.call(this),this.style.block=!0}o$n(o$r,"laya.html.dom.HTMLImageElement",o$S);var o$T=o$r.prototype;o$T._addToLayout=function(o$o){!this._style.absolute&&o$o.push(this)},o$T.render=function(o$o,o$r,o$T){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(o$j.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,o$o.ctx.drawTexture2(o$r,o$T,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},o$T.layaoutCallNative=function(){var o$o=0;if(this._childs&&0<(o$o=this._childs.length))for(var o$r=0;o$r<o$o;o$r++)this._childs[o$r].layaoutCallNative&&this._childs[o$r].layaoutCallNative()},o$V(0,o$T,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(o$o){this._width!==o$o&&(this._width=o$o,this._style.width=o$o,this.repaint())}),o$V(0,o$T,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(o$o){this._height!==o$o&&(this._height=o$o,this._style.height=o$o,this.repaint())}),o$T.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),o$U.clearCache(this,this._url),this._tex=null),o$S.prototype.destroy.call(this)},o$T.onloaded=function(){var o$o=this._style;o$o&&!o$o.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),o$o&&!o$o.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),o$i.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},o$T._loadImageComplete=function(o$o,o$r,o$T){if(!this._destroyed)if(null!=o$T)if(o$T instanceof ArrayBuffer){var o$k=new DataView(o$T);new laya.webgl.resource.WebGLImage(new Uint8Array(o$T,8),o$o,0,!1,o$k.getUint32(0),o$k.getUint32(4));this.onloaded()}else if(o$T instanceof o$_)o$U.imgMgrSet[o$o]=o$r,o$D.imgMgrLock(o$o,o$U.imgMgrSet[o$o]),this._url=o$o,this._tex=o$T,o$U.keepCache(this,o$o),o$U.cacheRes(o$o,this._tex),this.onloaded();else{var o$W=-1!=o$o.indexOf(".png",o$o.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(o$T,o$o,o$W,!1,o$T.width,o$T.height);this.onloaded()}else this.event("error","Load image failed")},o$V(0,o$T,"src",null,function(o$o){(o$o=this.formatURL(o$o),this._url!=o$o)&&(null!=this._tex&&(o$U.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=o$o,(this._tex=o$U.getRes(o$o))?(o$U.keepCache(this,o$o),this.onloaded()):o$D.imgMgrLoad(o$o,this._loadImageComplete.bind(this),2,!1))})})(),function(o$o){function o$r(){this.type=null,o$r.__super.call(this),this.visible=!1}o$n(o$r,"laya.html.dom.HTMLLinkElement",o$o);var o$T=o$r.prototype;o$T._onload=function(o$o){switch(this.type){case"text/css":o$L.parseCSS(o$o,this.URI)}},o$V(0,o$T,"href",o$o.prototype._$get_href,function(o$o){var o$r=this;o$o=this.formatURL(o$o),this.URI=new o$K(o$o);var o$T=new o$U;o$T.once("complete",null,function(o$o){o$r._onload(o$o)}),o$T.load(o$o,"text")}),o$r._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(o$S),function(o$o){function o$r(){o$r.__super.call(this),this.visible=!1}o$n(o$r,"laya.html.dom.HTMLStyleElement",o$o),o$V(0,o$r.prototype,"text",o$o.prototype._$get_text,function(o$o){o$L.parseCSS(o$o,null)})}(o$S),function(o$o){function o$r(){o$r.__super.call(this),this._getCSSStyle().valign="middle"}o$n(o$r,"laya.html.dom.HTMLIframeElement",o$o),o$V(0,o$r.prototype,"href",o$o.prototype._$get_href,function(o$T){var o$k=this;o$T=this.formatURL(o$T);var o$o=new o$U;o$o.once("complete",null,function(o$o){var o$r=o$k.URI;o$k.URI=new o$K(o$T),o$k.innerHTML=o$o,!o$r||(o$k.URI=o$r)}),o$o.load(o$T,"text")})}(o$r)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(o$o,o$r){"use strict";for(var o$T in Object.defineProperty(o$r,"__esModule",{value:!0}),Laya){var o$k=Laya[o$T];o$k&&o$k.__isclass&&(o$r[o$T]=o$k)}}),function(o$o,o$r,o$j){o$j.un,o$j.uns;var o$k=o$j.static,o$D=o$j.class,o$W=o$j.getset,o$T=(o$j.__newvec,laya.display.Animation),o$_=(laya.utils.Browser,laya.utils.ClassUtils),o$n=laya.filters.ColorFilter,o$V=laya.utils.Ease,o$L=laya.events.Event,o$U=(laya.events.EventDispatcher,laya.display.css.Font),o$h=laya.display.FrameAnimation,o$p=laya.display.Graphics,o$i=laya.utils.Handler,o$v=laya.display.Input,o$$=laya.net.Loader,o$x=(laya.display.Node,laya.maths.Point),o$K=laya.maths.Rectangle,o$y=laya.renders.Render,o$l=laya.display.Sprite,o$S=laya.display.Text,o$q=laya.resource.Texture,o$b=laya.utils.Tween,o$F=laya.utils.Utils,o$P=laya.utils.WeakObject;o$j.interface("laya.ui.IItem"),o$j.interface("laya.ui.ISelect"),o$j.interface("laya.ui.IRender"),o$j.interface("laya.ui.IComponent"),o$j.interface("laya.ui.IBox","IComponent");var o$t=function(){function o$o(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return o$D(o$o,"laya.ui.LayoutStyle"),o$k(o$o,["EMPTY",function(){return this.EMPTY=new o$o}]),o$o}(),o$H=function(){function o$o(){}return o$D(o$o,"laya.ui.Styles"),o$o.labelColor="#000000",o$o.buttonStateNum=3,o$o.scrollBarMinNum=15,o$o.scrollBarDelayTime=500,o$k(o$o,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),o$o}(),o$R=function(){function o$W(){}return o$D(o$W,"laya.ui.UIUtils"),o$W.fillArray=function(o$o,o$r,o$T){var o$k=o$o.concat();if(o$r)for(var o$W=o$r.split(","),o$D=0,o$n=Math.min(o$k.length,o$W.length);o$D<o$n;o$D++){var o$V=o$W[o$D];o$k[o$D]="true"==o$V||"false"!=o$V&&o$V,null!=o$T&&(o$k[o$D]=o$T(o$V))}return o$k},o$W.toColor=function(o$o){return o$F.toHexColor(o$o)},o$W.gray=function(o$o,o$r){void 0===o$r&&(o$r=!0),o$r?o$W.addFilter(o$o,o$W.grayFilter):o$W.clearFilter(o$o,o$n)},o$W.addFilter=function(o$o,o$r){var o$T=o$o.filters||[];o$T.push(o$r),o$o.filters=o$T},o$W.clearFilter=function(o$o,o$r){var o$T=o$o.filters;if(null!=o$T&&0<o$T.length){for(var o$k=o$T.length-1;-1<o$k;o$k--){var o$W=o$T[o$k];o$j.__typeof(o$W,o$r)&&o$T.splice(o$k,1)}o$o.filters=o$T}},o$W._getReplaceStr=function(o$o){return o$W.escapeSequence[o$o]},o$W.adptString=function(o$o){return o$o.replace(/\\(\w)/g,o$W._getReplaceStr)},o$W.getBindFun=function(o$o){var o$r=o$W._funMap.get(o$o);if(null==o$r){var o$T='"'+o$o+'"',o$k="(function(data){if(data==null)return;with(data){try{\nreturn "+(o$T=o$T.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";o$r=o$j._runScript(o$k),o$W._funMap.set(o$o,o$r)}return o$r},o$k(o$W,["grayFilter",function(){return this.grayFilter=new o$n([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new o$P}]),o$W}(),o$u=function(){function o$o(){}return o$D(o$o,"UIConfig"),o$o.touchScrollEnable=!0,o$o.mouseWheelEnable=!0,o$o.showButtons=!0,o$o.popupBgColor="#000000",o$o.popupBgAlpha=.5,o$o.closeDialogOnSide=!0,o$o}(),o$s=function(o$T){function o$K(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,o$K.__super.call(this),this._weakKeys=[]}o$D(o$K,"laya.ui.AutoBitmap",o$T);var o$o=o$K.prototype;return o$o.destroy=function(){if(o$$.clearObject(this,this._weakKey),this._weakKeys){for(var o$o=0,o$r=this._weakKeys.length;o$o<o$r;++o$o)o$$.clearObject(this,this._weakKeys[o$o]);this._weakKeys=null}o$T.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},o$o._setChanged=function(){this._isChanged||(this._isChanged=!0,o$j.timer.callLater(this,this.changeSource))},o$o.changeSource=function(){this._isChanged=!1;var o$o=this._source;if(o$o&&o$o.bitmap){var o$r=this.width,o$T=this.height,o$k=this._sizeGrid,o$W=o$o.sourceWidth,o$D=o$o.sourceHeight;if(!o$k||o$W===o$r&&o$D===o$T)this.cleanByTexture(o$o,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,o$r,o$T);else{o$$.clearObject(this,this._weakKey),o$o.$_GID||(o$o.$_GID=o$F.getGID());var o$n=o$o.$_GID+"."+o$r+"."+o$T+"."+o$k.join("."),o$V=o$$.findObject(o$n);if(o$F.isOKCmdList(o$V))return this._weakKey=o$n,o$$.keepObject(this,this._weakKey),void(this.cmds=o$V);this.clear();var o$L,o$U,o$h=o$k[0],o$p=o$k[1],o$i=o$k[2],o$v=o$k[3],o$x=o$k[4],o$j=!1;if(o$r==o$W&&(o$v=o$p=0),o$T==o$D&&(o$h=o$i=0),o$r<o$v+o$p){var o$_=o$r;o$j=!0,o$r=o$v+o$p,this.save(),this.clipRect(0,0,o$_,o$T)}o$v&&o$h&&(o$L=o$K.getTexture(o$o,0,0,o$v,o$h),o$U=this._weakKeys[0],o$L?(o$U!=o$L.weakKey&&(o$$.clearObject(this,o$U),o$$.keepObject(this,o$L.weakKey),this._weakKeys[0]=o$L.weakKey),this.drawTexture(o$L,0,0,o$v,o$h)):(o$$.clearObject(this,o$U),this._weakKeys[0]="")),o$p&&o$h&&(o$L=o$K.getTexture(o$o,o$W-o$p,0,o$p,o$h),o$U=this._weakKeys[1],o$L?(o$U!=o$L.weakKey&&(o$$.clearObject(this,o$U),o$$.keepObject(this,o$L.weakKey),this._weakKeys[1]=o$L.weakKey),this.drawTexture(o$L,o$r-o$p,0,o$p,o$h)):(o$$.clearObject(this,o$U),this._weakKeys[1]="")),o$v&&o$i&&(o$L=o$K.getTexture(o$o,0,o$D-o$i,o$v,o$i),o$U=this._weakKeys[2],o$L?(o$U!=o$L.weakKey&&(o$$.clearObject(this,o$U),o$$.keepObject(this,o$L.weakKey),this._weakKeys[2]=o$L.weakKey),this.drawTexture(o$L,0,o$T-o$i,o$v,o$i)):(o$$.clearObject(this,o$U),this._weakKeys[2]="")),o$p&&o$i&&(o$L=o$K.getTexture(o$o,o$W-o$p,o$D-o$i,o$p,o$i),o$U=this._weakKeys[3],o$L?(o$U!=o$L.weakKey&&(o$$.clearObject(this,o$U),o$$.keepObject(this,o$L.weakKey),this._weakKeys[3]=o$L.weakKey),this.drawTexture(o$L,o$r-o$p,o$T-o$i,o$p,o$i)):(o$$.clearObject(this,o$U),this._weakKeys[3]="")),o$h&&(o$L=o$K.getTexture(o$o,o$v,0,o$W-o$v-o$p,o$h),o$U=this._weakKeys[4],o$L?(o$U!=o$L.weakKey&&(o$$.clearObject(this,o$U),o$$.keepObject(this,o$L.weakKey),this._weakKeys[4]=o$L.weakKey),this.drawBitmap(o$x,o$L,o$v,0,o$r-o$v-o$p,o$h)):(o$$.clearObject(this,o$U),this._weakKeys[4]="")),o$i&&(o$L=o$K.getTexture(o$o,o$v,o$D-o$i,o$W-o$v-o$p,o$i),o$U=this._weakKeys[5],o$L?(o$U!=o$L.weakKey&&(o$$.clearObject(this,o$U),o$$.keepObject(this,o$L.weakKey),this._weakKeys[5]=o$L.weakKey),this.drawBitmap(o$x,o$L,o$v,o$T-o$i,o$r-o$v-o$p,o$i)):(o$$.clearObject(this,o$U),this._weakKeys[5]="")),o$v&&(o$L=o$K.getTexture(o$o,0,o$h,o$v,o$D-o$h-o$i),o$U=this._weakKeys[6],o$L?(o$U!=o$L.weakKey&&(o$$.clearObject(this,o$U),o$$.keepObject(this,o$L.weakKey),this._weakKeys[6]=o$L.weakKey),this.drawBitmap(o$x,o$L,0,o$h,o$v,o$T-o$h-o$i)):(o$$.clearObject(this,o$U),this._weakKeys[6]="")),o$p&&(o$L=o$K.getTexture(o$o,o$W-o$p,o$h,o$p,o$D-o$h-o$i),o$U=this._weakKeys[7],o$L?(o$U!=o$L.weakKey&&(o$$.clearObject(this,o$U),o$$.keepObject(this,o$L.weakKey),this._weakKeys[7]=o$L.weakKey),this.drawBitmap(o$x,o$L,o$r-o$p,o$h,o$p,o$T-o$h-o$i)):(o$$.clearObject(this,o$U),this._weakKeys[7]="")),o$L=o$K.getTexture(o$o,o$v,o$h,o$W-o$v-o$p,o$D-o$h-o$i),o$U=this._weakKeys[8],o$L?(o$U!=o$L.weakKey&&(o$$.clearObject(this,o$U),o$$.keepObject(this,o$L.weakKey),this._weakKeys[8]=o$L.weakKey),this.drawBitmap(o$x,o$L,o$v,o$h,o$r-o$v-o$p,o$T-o$h-o$i)):(o$$.clearObject(this,o$U),this._weakKeys[8]=""),o$j&&this.restore(),this.autoCacheCmd&&!o$y.isConchApp&&(o$$.saveObject(o$n,this.cmds,null),this._weakKey=o$n,o$$.keepObject(this,this._weakKey))}this._repaint()}},o$o.drawBitmap=function(o$o,o$r,o$T,o$k,o$W,o$D){void 0===o$W&&(o$W=0),void 0===o$D&&(o$D=0),o$W<.1||o$D<.1||(!o$o||o$r.width==o$W&&o$r.height==o$D?this.drawTexture(o$r,o$T,o$k,o$W,o$D):this.fillTexture(o$r,o$T,o$k,o$W,o$D))},o$o.clear=function(o$o){void 0===o$o&&(o$o=!0),o$T.prototype.clear.call(this,!1)},o$W(0,o$o,"sizeGrid",function(){return this._sizeGrid},function(o$o){this._sizeGrid=o$o,this._setChanged()}),o$W(0,o$o,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(o$o){this._width!=o$o&&(this._width=o$o,this._setChanged())}),o$W(0,o$o,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(o$o){this._height!=o$o&&(this._height=o$o,this._setChanged())}),o$W(0,o$o,"source",function(){return this._source},function(o$o){o$o?(this._source=o$o,this._setChanged()):(this._source=null,this.clear())}),o$K.getTexture=function(o$o,o$r,o$T,o$k,o$W){o$k<=0&&(o$k=1),o$W<=0&&(o$W=1),o$o.$_GID||(o$o.$_GID=o$F.getGID());var o$D=o$o.$_GID+"."+o$r+"."+o$T+"."+o$k+"."+o$W,o$n=o$$.findObject(o$D);if((!o$n||!o$n.source)&&(o$n=o$q.createFromTexture(o$o,o$r,o$T,o$k,o$W))){if(o$o.alphaTexture){var o$V=o$o.width/o$o.alphaTexture.width;o$n.alphaTexture=o$q.createFromTexture(o$o.alphaTexture,o$r/o$V,o$T/o$V,o$k/o$V,o$W/o$V)}o$$.saveObject(o$D,o$n),o$n.weakKey=o$D}return o$n},o$K}(o$p),o$z=(function(o$o){function o$r(){o$r.__super.call(this)}o$D(o$r,"laya.ui.UIEvent",o$L),o$r.SHOW_TIP="showtip",o$r.HIDE_TIP="hidetip"}(),function(o$r){function o$o(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,o$o.__super.call(this),this._layout=o$t.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}o$D(o$o,"laya.ui.Component",o$r);var o$T=o$o.prototype;return o$j.imps(o$T,{"laya.ui.IComponent":!0}),o$T.destroy=function(o$o){void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,o$o),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},o$T.preinitialize=function(){},o$T.createChildren=function(){},o$T.initialize=function(){},o$T.callLater=function(o$o,o$r){o$j.timer.callLater(this,o$o,o$r)},o$T.runCallLater=function(o$o){o$j.timer.runCallLater(this,o$o)},o$T.commitMeasure=function(){},o$T.changeSize=function(){this.event("resize")},o$T.getLayout=function(){return this._layout===o$t.EMPTY&&(this._layout=new o$t),this._layout},o$T._setLayoutEnabled=function(o$o){this._layout&&this._layout.enable!=o$o&&(this._layout.enable=o$o,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},o$T.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},o$T.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},o$T.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},o$T.resetLayoutX=function(){var o$o=this._layout;if(isNaN(o$o.anchorX)||(this.pivotX=o$o.anchorX*this.width),this.layoutEnabled){var o$r=this.parent;o$r&&(isNaN(o$o.centerX)?isNaN(o$o.left)?isNaN(o$o.right)||(this.x=Math.round(o$r.width-this.displayWidth-o$o.right+this.pivotX*this.scaleX)):(this.x=Math.round(o$o.left+this.pivotX*this.scaleX),isNaN(o$o.right)||(this.width=(o$r._width-o$o.left-o$o.right)/(this.scaleX||.01))):this.x=Math.round(.5*(o$r.width-this.displayWidth)+o$o.centerX+this.pivotX*this.scaleX))}},o$T.resetLayoutY=function(){var o$o=this._layout;if(isNaN(o$o.anchorY)||(this.pivotY=o$o.anchorY*this.height),this.layoutEnabled){var o$r=this.parent;o$r&&(isNaN(o$o.centerY)?isNaN(o$o.top)?isNaN(o$o.bottom)||(this.y=Math.round(o$r.height-this.displayHeight-o$o.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(o$o.top+this.pivotY*this.scaleY),isNaN(o$o.bottom)||(this.height=(o$r._height-o$o.top-o$o.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(o$r.height-this.displayHeight)+o$o.centerY+this.pivotY*this.scaleY))}},o$T.onMouseOver=function(o$o){o$j.stage.event("showtip",this._toolTip)},o$T.onMouseOut=function(o$o){o$j.stage.event("hidetip",this._toolTip)},o$W(0,o$T,"displayWidth",function(){return this.width*this.scaleX}),o$W(0,o$T,"width",function(){return this._width?this._width:this.measureWidth},function(o$o){this._width!=o$o&&(this._width=o$o,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),o$W(0,o$T,"measureWidth",function(){var o$o=0;this.commitMeasure();for(var o$r=this.numChildren-1;-1<o$r;o$r--){var o$T=this.getChildAt(o$r);o$T.visible&&(o$o=Math.max(o$T.x+o$T.width*o$T.scaleX,o$o))}return o$o}),o$W(0,o$T,"displayHeight",function(){return this.height*this.scaleY}),o$W(0,o$T,"height",function(){return this._height?this._height:this.measureHeight},function(o$o){this._height!=o$o&&(this._height=o$o,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),o$W(0,o$T,"dataSource",function(){return this._dataSource},function(o$o){for(var o$r in this._dataSource=o$o,this._dataSource)this.hasOwnProperty(o$r)&&"function"!=typeof this[o$r]&&(this[o$r]=this._dataSource[o$r])}),o$W(0,o$T,"scaleY",o$r.prototype._$get_scaleY,function(o$o){o$j.superGet(o$l,this,"scaleY")!=o$o&&(o$j.superSet(o$l,this,"scaleY",o$o),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),o$W(0,o$T,"measureHeight",function(){var o$o=0;this.commitMeasure();for(var o$r=this.numChildren-1;-1<o$r;o$r--){var o$T=this.getChildAt(o$r);o$T.visible&&(o$o=Math.max(o$T.y+o$T.height*o$T.scaleY,o$o))}return o$o}),o$W(0,o$T,"scaleX",o$r.prototype._$get_scaleX,function(o$o){o$j.superGet(o$l,this,"scaleX")!=o$o&&(o$j.superSet(o$l,this,"scaleX",o$o),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),o$W(0,o$T,"top",function(){return this._layout.top},function(o$o){o$o!=this._layout.top&&(this.getLayout().top=o$o,this._setLayoutEnabled(!0)),this.resetLayoutY()}),o$W(0,o$T,"bottom",function(){return this._layout.bottom},function(o$o){o$o!=this._layout.bottom&&(this.getLayout().bottom=o$o,this._setLayoutEnabled(!0)),this.resetLayoutY()}),o$W(0,o$T,"left",function(){return this._layout.left},function(o$o){o$o!=this._layout.left&&(this.getLayout().left=o$o,this._setLayoutEnabled(!0)),this.resetLayoutX()}),o$W(0,o$T,"right",function(){return this._layout.right},function(o$o){o$o!=this._layout.right&&(this.getLayout().right=o$o,this._setLayoutEnabled(!0)),this.resetLayoutX()}),o$W(0,o$T,"centerX",function(){return this._layout.centerX},function(o$o){o$o!=this._layout.centerX&&(this.getLayout().centerX=o$o,this._setLayoutEnabled(!0)),this.resetLayoutX()}),o$W(0,o$T,"centerY",function(){return this._layout.centerY},function(o$o){o$o!=this._layout.centerY&&(this.getLayout().centerY=o$o,this._setLayoutEnabled(!0)),this.resetLayoutY()}),o$W(0,o$T,"anchorX",function(){return this._layout.anchorX},function(o$o){o$o!=this._layout.anchorX&&(this.getLayout().anchorX=o$o,this._setLayoutEnabled(!0)),this.resetLayoutX()}),o$W(0,o$T,"anchorY",function(){return this._layout.anchorY},function(o$o){o$o!=this._layout.anchorY&&(this.getLayout().anchorY=o$o,this._setLayoutEnabled(!0)),this.resetLayoutY()}),o$W(0,o$T,"tag",function(){return this._tag},function(o$o){this._tag=o$o}),o$W(0,o$T,"toolTip",function(){return this._toolTip},function(o$o){this._toolTip!=o$o&&(null!=(this._toolTip=o$o)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),o$W(0,o$T,"comXml",function(){return this._comXml},function(o$o){this._comXml=o$o}),o$W(0,o$T,"gray",function(){return this._gray},function(o$o){o$o!==this._gray&&(this._gray=o$o,o$R.gray(this,o$o))}),o$W(0,o$T,"disabled",function(){return this._disabled},function(o$o){o$o!==this._disabled&&(this.gray=this._disabled=o$o,this.mouseEnabled=!o$o)}),o$o}(o$l)),o$m=function(o$o){function o$r(){this.lockLayer=null,this.popupEffect=function(o$o){o$o.scale(1,1),o$b.from(o$o,{x:o$j.stage.width/2,y:o$j.stage.height/2,scaleX:0,scaleY:0},300,o$V.backOut,o$i.create(this,this.doOpen,[o$o]))},this.closeEffect=function(o$o,o$r){o$b.to(o$o,{x:o$j.stage.width/2,y:o$j.stage.height/2,scaleX:0,scaleY:0},300,o$V.strongOut,o$i.create(this,this.doClose,[o$o,o$r]))},o$r.__super.call(this),this.maskLayer=new o$l,this.popupEffectHandler=o$i.create(this,this.popupEffect,null,!1),this.closeEffectHandler=o$i.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,o$j.stage.addChild(this),o$j.stage.on("resize",this,this._onResize),o$u.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}o$D(o$r,"laya.ui.DialogManager",o$l);var o$T=o$r.prototype;return o$T._closeOnSide=function(){var o$o=this.getChildAt(this.numChildren-1);o$o instanceof laya.ui.Dialog&&o$o.close("side")},o$T.setLockView=function(o$o){this.lockLayer||(this.lockLayer=new o$C,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(o$j.stage.width,o$j.stage.height)),this.lockLayer.removeChildren(),o$o&&(o$o.centerX=o$o.centerY=0,this.lockLayer.addChild(o$o))},o$T._onResize=function(o$o){var o$r=this.maskLayer.width=o$j.stage.width,o$T=this.maskLayer.height=o$j.stage.height;this.lockLayer&&this.lockLayer.size(o$r,o$T),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,o$r,o$T,o$u.popupBgColor),this.maskLayer.alpha=o$u.popupBgAlpha;for(var o$k=this.numChildren-1;-1<o$k;o$k--){var o$W=this.getChildAt(o$k);o$W.popupCenter&&this._centerDialog(o$W)}},o$T._centerDialog=function(o$o){o$o.x=Math.round((o$j.stage.width-o$o.width>>1)+o$o.pivotX),o$o.y=Math.round((o$j.stage.height-o$o.height>>1)+o$o.pivotY)},o$T.open=function(o$o,o$r,o$T){void 0===o$r&&(o$r=!1),void 0===o$T&&(o$T=!1),o$r&&this._closeAll(),o$o.popupCenter&&this._centerDialog(o$o),this.addChild(o$o),(o$o.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),o$T&&null!=o$o.popupEffect?o$o.popupEffect.runWith(o$o):this.doOpen(o$o),this.event("open")},o$T.doOpen=function(o$o){o$o.onOpened()},o$T.lock=function(o$o){this.lockLayer&&(o$o?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},o$T.close=function(o$o,o$r,o$T){void 0===o$T&&(o$T=!1),o$T&&null!=o$o.closeEffect?o$o.closeEffect.runWith([o$o,o$r]):this.doClose(o$o,o$r),this.event("close")},o$T.doClose=function(o$o,o$r){o$o.removeSelf(),o$o.isModal&&this._checkMask(),o$o.closeHandler&&o$o.closeHandler.runWith(o$r),o$o.onClosed(o$r)},o$T.closeAll=function(){this._closeAll(),this.event("close")},o$T._closeAll=function(){for(var o$o=this.numChildren-1;-1<o$o;o$o--){var o$r=this.getChildAt(o$o);o$r&&null!=o$r.close&&this.doClose(o$r)}},o$T.getDialogsByGroup=function(o$o){for(var o$r=[],o$T=this.numChildren-1;-1<o$T;o$T--){var o$k=this.getChildAt(o$T);o$k&&o$k.group===o$o&&o$r.push(o$k)}return o$r},o$T.closeByGroup=function(o$o){for(var o$r=[],o$T=this.numChildren-1;-1<o$T;o$T--){var o$k=this.getChildAt(o$T);o$k&&o$k.group===o$o&&(o$k.close(),o$r.push(o$k))}return o$r},o$T._checkMask=function(){this.maskLayer.removeSelf();for(var o$o=this.numChildren-1;-1<o$o;o$o--){var o$r=this.getChildAt(o$o);if(o$r&&o$r.isModal)return void this.addChildAt(this.maskLayer,o$o)}},o$r}(),o$C=function(o$o){function o$r(){o$r.__super.call(this)}o$D(o$r,"laya.ui.Box",o$o);var o$T=o$r.prototype;return o$j.imps(o$T,{"laya.ui.IBox":!0}),o$W(0,o$T,"dataSource",o$o.prototype._$get_dataSource,function(o$o){for(var o$r in this._dataSource=o$o){var o$T=this.getChildByName(o$r);o$T?o$T.dataSource=o$o[o$r]:this.hasOwnProperty(o$r)&&"function"!=typeof this[o$r]&&(this[o$r]=o$o[o$r])}}),o$r}(o$z),o$X=function(o$r){function o$T(o$o,o$r){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,o$T.__super.call(this),this._labelColors=o$H.buttonLabelColors,this._stateNum=o$H.buttonStateNum,void 0===o$r&&(o$r=""),this.skin=o$o,this.label=o$r}o$D(o$T,"laya.ui.Button",o$r);var o$o=o$T.prototype;return o$j.imps(o$o,{"laya.ui.ISelect":!0}),o$o.destroy=function(o$o){o$$.clearCache(this,this._skin),o$$.clearObject(this,this._weakKey),void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,o$o),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(o$o),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},o$o.createChildren=function(){this.graphics=this._bitmap=new o$s},o$o.createText=function(){this._text||(this._text=new o$S,this._text.overflow=o$S.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},o$o.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},o$o.onMouse=function(o$o){if(!1!==this.toggle||!this._selected)return"click"===o$o.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=o$T.stateMap[o$o.type]))},o$o.changeClips=function(){var o$o=o$$.getRes(this._skin);if(o$o&&this._skin&&""!=this._skin){o$$.clearObject(this,this._weakKey);var o$r=o$o.sourceWidth,o$T=o$o.sourceHeight/this._stateNum;o$o.$_GID||(o$o.$_GID=o$F.getGID());var o$k=o$o.$_GID+"-"+this._stateNum,o$W=o$$.findObject(o$k);if(o$F.isOkTextureList(o$W)||(o$W=null),o$W)this._weakKey=o$k,o$$.keepObject(this,this._weakKey),this._sources=o$W;else{if(this._sources=[],1===this._stateNum)this._sources.push(o$o);else for(var o$D=0;o$D<this._stateNum;o$D++){var o$n=o$q.createFromTexture(o$o,0,o$T*o$D,o$r,o$T);if(o$o.alphaTexture){var o$V=o$o.width/o$o.alphaTexture.width;o$n.alphaTexture=o$q.createFromTexture(o$o.alphaTexture,0/o$V,o$T*o$D/o$V,o$r/o$V,o$T/o$V)}this._sources.push(o$n)}o$$.saveObject(o$k,this._sources),this._weakKey=o$k,o$$.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||o$r,this._bitmap.height=this._height||o$T,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=o$r)}else console.warn("lose skin ",this._skin,this.name,this.__className)},o$o.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var o$o=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[o$o]),this.label&&(this._text.color=this._labelColors[o$o],this._strokeColors&&(this._text.strokeColor=this._strokeColors[o$o]))},o$o._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},o$W(0,o$o,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(o$o){this.createText(),this._text.strokeColor=o$o}),o$W(0,o$o,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),o$W(0,o$o,"skin",function(){return this._skin},function(o$o){this._skin!=o$o&&(o$$.clearCache(this,this._skin),this._skin=o$o,o$$.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),o$W(0,o$o,"state",function(){return this._state},function(o$o){this._state!=o$o&&(this._state=o$o,this._setStateChanged())}),o$W(0,o$o,"text",function(){return this.createText(),this._text}),o$W(0,o$o,"stateNum",function(){return this._stateNum},function(o$o){"string"==typeof o$o&&(o$o=parseInt(o$o)),this._stateNum!=o$o&&(this._stateNum=o$o<1?1:3<o$o?3:o$o,this.callLater(this.changeClips))}),o$W(0,o$o,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(o$o){this._strokeColors=o$R.fillArray(o$H.buttonLabelColors,o$o,String),this._setStateChanged()}),o$W(0,o$o,"labelColors",function(){return this._labelColors.join(",")},function(o$o){this._labelColors=o$R.fillArray(o$H.buttonLabelColors,o$o,String),this._setStateChanged()}),o$W(0,o$o,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),o$W(0,o$o,"label",function(){return this._text?this._text.text:null},function(o$o){(this._text||o$o)&&(this.createText(),this._text.text!=o$o&&(o$o&&!this._text.parent&&this.addChild(this._text),this._text.text=(o$o+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),o$W(0,o$o,"selected",function(){return this._selected},function(o$o){this._selected!=o$o&&(this._selected=o$o,this.state=this._selected?2:0,this.event("change"))}),o$W(0,o$o,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(o$o){this.createText(),this._text.padding=o$R.fillArray(o$H.labelPadding,o$o,Number)}),o$W(0,o$o,"labelSize",function(){return this.createText(),this._text.fontSize},function(o$o){this.createText(),this._text.fontSize=o$o}),o$W(0,o$o,"labelStroke",function(){return this.createText(),this._text.stroke},function(o$o){this.createText(),this._text.stroke=o$o}),o$W(0,o$o,"labelBold",function(){return this.createText(),this._text.bold},function(o$o){this.createText(),this._text.bold=o$o}),o$W(0,o$o,"labelFont",function(){return this.createText(),this._text.font},function(o$o){this.createText(),this._text.font=o$o}),o$W(0,o$o,"labelAlign",function(){return this.createText(),this._text.align},function(o$o){this.createText(),this._text.align=o$o}),o$W(0,o$o,"clickHandler",function(){return this._clickHandler},function(o$o){this._clickHandler=o$o}),o$W(0,o$o,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(o$o){this._bitmap.sizeGrid=o$R.fillArray(o$H.defaultSizeGrid,o$o,Number)}),o$W(0,o$o,"width",o$r.prototype._$get_width,function(o$o){o$j.superSet(o$z,this,"width",o$o),this._autoSize&&(this._bitmap.width=o$o,this._text&&(this._text.width=o$o))}),o$W(0,o$o,"height",o$r.prototype._$get_height,function(o$o){o$j.superSet(o$z,this,"height",o$o),this._autoSize&&(this._bitmap.height=o$o,this._text&&(this._text.height=o$o))}),o$W(0,o$o,"dataSource",o$r.prototype._$get_dataSource,function(o$o){"number"==typeof(this._dataSource=o$o)||"string"==typeof o$o?this.label=o$o+"":o$j.superSet(o$z,this,"dataSource",o$o)}),o$W(0,o$o,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(o$o){this._bitmap._offset=o$o?o$R.fillArray([1,1],o$o,Number):[]}),o$k(o$T,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),o$T}(o$z),o$O=function(o$r){function o$k(o$o,o$r,o$T){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,o$k.__super.call(this),void 0===o$r&&(o$r=1),void 0===o$T&&(o$T=1),this._clipX=o$r,this._clipY=o$T,this.skin=o$o}o$D(o$k,"laya.ui.Clip",o$r);var o$o=o$k.prototype;return o$o.destroy=function(o$o){o$$.clearCache(this,this._skin),o$$.clearObject(this,this._weakKey),void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},o$o.dispose=function(){this.destroy(!0),o$j.loader.clearRes(this._skin)},o$o.createChildren=function(){this.graphics=this._bitmap=new o$s},o$o._onDisplay=function(o$o){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},o$o.changeClip=function(){if(this._clipChanged=!1,this._skin){var o$o=o$$.getRes(this._skin);o$o?this.loadComplete(this._skin,o$o):o$j.loader.load(this._skin,o$i.create(this,this.loadComplete,[this._skin]))}},o$o.loadComplete=function(o$o,o$r){if(o$o===this._skin&&o$r){o$$.clearObject(this,this._weakKey);var o$T=this._clipWidth||Math.ceil(o$r.sourceWidth/this._clipX),o$k=this._clipHeight||Math.ceil(o$r.sourceHeight/this._clipY),o$W=this._skin+o$T+o$k,o$D=o$$.findObject(o$W);if(o$F.isOkTextureList(o$D)||(o$D=null),o$D)this._weakKey=o$W,o$$.keepObject(this,this._weakKey),this._sources=o$D;else{this._sources=[];for(var o$n=0;o$n<this._clipY;o$n++)for(var o$V=0;o$V<this._clipX;o$V++){var o$L=o$q.createFromTexture(o$r,o$T*o$V,o$k*o$n,o$T,o$k);if(o$r.alphaTexture){var o$U=o$r.width/o$r.alphaTexture.width;o$L.alphaTexture=o$q.createFromTexture(o$r.alphaTexture,o$T*o$V/o$U,o$k*o$n/o$U,o$T/o$U,o$k/o$U)}this._sources.push(o$L)}o$$.saveObject(o$W,this._sources),this._weakKey=o$W,o$$.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},o$o.play=function(o$o,o$r){void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=-1),this._isPlaying=!0,this.index=o$o,this._toIndex=o$r,this._index++,o$j.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},o$o._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},o$o.stop=function(){this._isPlaying=!1,o$j.timer.clear(this,this._loop),this.event("complete")},o$o._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},o$W(0,o$o,"interval",function(){return this._interval},function(o$o){this._interval!=o$o&&(this._interval=o$o,this._isPlaying&&this.play())}),o$W(0,o$o,"skin",function(){return this._skin},function(o$o){this._skin!=o$o&&(o$$.clearCache(this,this._skin),(this._skin=o$o)?(o$$.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),o$W(0,o$o,"sources",function(){return this._sources},function(o$o){this._sources=o$o,this.index=this._index,this.event("loaded")}),o$W(0,o$o,"clipX",function(){return this._clipX},function(o$o){this._clipX=o$o||1,this._setClipChanged()}),o$W(0,o$o,"clipY",function(){return this._clipY},function(o$o){this._clipY=o$o||1,this._setClipChanged()}),o$W(0,o$o,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),o$W(0,o$o,"clipWidth",function(){return this._clipWidth},function(o$o){this._clipWidth=o$o,this._setClipChanged()}),o$W(0,o$o,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(o$o){this._bitmap.sizeGrid=o$R.fillArray(o$H.defaultSizeGrid,o$o,Number)}),o$W(0,o$o,"group",function(){return this._group},function(o$o){o$o&&this._skin&&o$$.setGroup(this._skin,o$o),this._group=o$o}),o$W(0,o$o,"clipHeight",function(){return this._clipHeight},function(o$o){this._clipHeight=o$o,this._setClipChanged()}),o$W(0,o$o,"width",o$r.prototype._$get_width,function(o$o){o$j.superSet(o$z,this,"width",o$o),this._bitmap.width=o$o}),o$W(0,o$o,"height",o$r.prototype._$get_height,function(o$o){o$j.superSet(o$z,this,"height",o$o),this._bitmap.height=o$o}),o$W(0,o$o,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),o$W(0,o$o,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),o$W(0,o$o,"index",function(){return this._index},function(o$o){this._index=o$o,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[o$o]),this.event("change")}),o$W(0,o$o,"autoPlay",function(){return this._autoPlay},function(o$o){this._autoPlay!=o$o&&((this._autoPlay=o$o)?this.play():this.stop())}),o$W(0,o$o,"isPlaying",function(){return this._isPlaying},function(o$o){this._isPlaying=o$o}),o$W(0,o$o,"dataSource",o$r.prototype._$get_dataSource,function(o$o){"number"==typeof(this._dataSource=o$o)&&Math.floor(o$o)==o$o||"string"==typeof o$o?this.index=parseInt(o$o):o$j.superSet(o$z,this,"dataSource",o$o)}),o$W(0,o$o,"bitmap",function(){return this._bitmap}),o$k}(o$z),o$M=function(o$r){function o$o(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,o$o.__super.call(this)}o$D(o$o,"laya.ui.ColorPicker",o$r);var o$T=o$o.prototype;return o$T.destroy=function(o$o){void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,o$o),this._colorPanel&&this._colorPanel.destroy(o$o),this._colorButton&&this._colorButton.destroy(o$o),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},o$T.createChildren=function(){this.addChild(this._colorButton=new o$X),this._colorPanel=new o$C,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new o$l),this._colorPanel.addChild(this._colorBlock=new o$l),this._colorPanel.addChild(this._colorInput=new o$v)},o$T.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},o$T.onPanelMouseDown=function(o$o){o$o.stopPropagation()},o$T.changePanel=function(){this._panelChanged=!1;var o$o=this._colorPanel.graphics;o$o.clear(),o$o.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(o$o=this._colorTiles.graphics).clear();for(var o$r=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],o$T=0;o$T<12;o$T++)for(var o$k=0;o$k<20;o$k++){var o$W=0;o$W=0===o$k?o$r[o$T]:1===o$k?0:51*(((3*o$T+o$k/6)%3<<0)+3*(o$T/6<<0))<<16|o$k%6*51<<8|(o$T<<0)%6*51;var o$D=o$R.toColor(o$W);this._colors.push(o$D);var o$n=o$k*this._gridSize,o$V=o$T*this._gridSize;o$o.drawRect(o$n,o$V,this._gridSize,this._gridSize,o$D,"#000000")}},o$T.onColorButtonClick=function(o$o){this._colorPanel.parent?this.close():this.open()},o$T.open=function(){var o$o=this.localToGlobal(new o$x),o$r=o$o.x+this._colorPanel.width<=o$j.stage.width?o$o.x:o$j.stage.width-this._colorPanel.width,o$T=o$o.y+this._colorButton.height;o$T=o$T+this._colorPanel.height<=o$j.stage.height?o$T:o$o.y-this._colorPanel.height,this._colorPanel.pos(o$r,o$T),this._colorPanel.zOrder=1001,o$j._currentStage.addChild(this._colorPanel),o$j.stage.on("mousedown",this,this.removeColorBox)},o$T.close=function(){o$j.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},o$T.removeColorBox=function(o$o){this.close()},o$T.onColorFieldKeyDown=function(o$o){13==o$o.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),o$o.stopPropagation())},o$T.onColorInputChange=function(o$o){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},o$T.onColorTilesClick=function(o$o){this.selectedColor=this.getColorByMouse(),this.close()},o$T.onColorTilesMouseMove=function(o$o){this._colorInput.focus=!1;var o$r=this.getColorByMouse();this._colorInput.text=o$r,this.drawBlock(o$r)},o$T.getColorByMouse=function(){var o$o=this._colorTiles.getMousePoint(),o$r=Math.floor(o$o.x/this._gridSize),o$T=Math.floor(o$o.y/this._gridSize);return this._colors[20*o$T+o$r]},o$T.drawBlock=function(o$o){var o$r=this._colorBlock.graphics;o$r.clear();var o$T=o$o||"#ffffff";o$r.drawRect(0,0,50,20,o$T,this._borderColor),o$o||o$r.drawLine(0,0,50,20,"#ff0000")},o$T.changeColor=function(){var o$o=this.graphics;o$o.clear();var o$r=this._selectedColor||"#000000";o$o.drawRect(0,0,this._colorButton.width,this._colorButton.height,o$r)},o$T._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},o$W(0,o$T,"inputBgColor",function(){return this._inputBgColor},function(o$o){this._inputBgColor=o$o,this._setPanelChanged()}),o$W(0,o$T,"selectedColor",function(){return this._selectedColor},function(o$o){this._selectedColor!=o$o&&(this._selectedColor=this._colorInput.text=o$o,this.drawBlock(o$o),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",o$L.EMPTY.setTo("change",this,this)))}),o$W(0,o$T,"skin",function(){return this._colorButton.skin},function(o$o){this._colorButton.skin=o$o,this.changeColor()}),o$W(0,o$T,"bgColor",function(){return this._bgColor},function(o$o){this._bgColor=o$o,this._setPanelChanged()}),o$W(0,o$T,"borderColor",function(){return this._borderColor},function(o$o){this._borderColor=o$o,this._setPanelChanged()}),o$W(0,o$T,"inputColor",function(){return this._inputColor},function(o$o){this._inputColor=o$o,this._setPanelChanged()}),o$o}(o$z),o$c=function(o$r){function o$T(o$o,o$r){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,o$T.__super.call(this),this._itemColors=o$H.comboBoxItemColors,this.skin=o$o,this.labels=o$r}o$D(o$T,"laya.ui.ComboBox",o$r);var o$o=o$T.prototype;return o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,o$o),this._button&&this._button.destroy(o$o),this._list&&this._list.destroy(o$o),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},o$o.createChildren=function(){this.addChild(this._button=new o$X),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},o$o._createList=function(){this._list=new o$w,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},o$o._setListEvent=function(o$o){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=o$i.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},o$o.onListDown=function(o$o){o$o.stopPropagation()},o$o.onScrollBarDown=function(o$o){o$o.stopPropagation()},o$o.onButtonMouseDown=function(o$o){this.callLater(this.switchTo,[!this._isOpen])},o$o.changeList=function(){this._listChanged=!1;var o$o=this.width-2,o$r=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:o$o,height:this._itemHeight,fontSize:this._itemSize,color:o$r}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},o$o.onlistItemMouse=function(o$o,o$r){var o$T=o$o.type;if("mouseover"===o$T||"mouseout"===o$T){if(this._isCustomList)return;var o$k=this._list.getCell(o$r);if(!o$k)return;var o$W=o$k.getChildByName("label");o$W&&("mouseover"===o$T?(o$W.bgColor=this._itemColors[0],o$W.color=this._itemColors[1]):(o$W.bgColor=null,o$W.color=this._itemColors[2]))}else"click"===o$T&&(this.selectedIndex=o$r,this.isOpen=!1)},o$o.switchTo=function(o$o){this.isOpen=o$o},o$o.changeOpen=function(){this.isOpen=!this._isOpen},o$o.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var o$o=this._list.graphics;o$o.clear(),o$o.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var o$r=this._list.array||[],o$T=o$r.length=0,o$k=this._labels.length;o$T<o$k;o$T++)o$r.push({label:this._labels[o$T]});this._list.height=this._listHeight,this._list.array=o$r},o$o.changeSelected=function(){this._button.label=this.selectedLabel},o$o._onStageMouseWheel=function(o$o){this._list&&!this._list.contains(o$o.target)&&this.removeList(null)},o$o.removeList=function(o$o){o$j.stage.off("mousedown",this,this.removeList),o$j.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},o$W(0,o$o,"selectedIndex",function(){return this._selectedIndex},function(o$o){this._selectedIndex!=o$o&&(this._selectedIndex=o$o,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[o$L.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),o$W(0,o$o,"measureHeight",function(){return this._button.height}),o$W(0,o$o,"skin",function(){return this._button.skin},function(o$o){this._button.skin!=o$o&&(this._button.skin=o$o,this._listChanged=!0)}),o$W(0,o$o,"measureWidth",function(){return this._button.width}),o$W(0,o$o,"width",o$r.prototype._$get_width,function(o$o){o$j.superSet(o$z,this,"width",o$o),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),o$W(0,o$o,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(o$o){this.selectedIndex=this._labels.indexOf(o$o)}),o$W(0,o$o,"labels",function(){return this._labels.join(",")},function(o$o){0<this._labels.length&&(this.selectedIndex=-1),o$o?this._labels=o$o.split(","):this._labels.length=0,this._itemChanged=!0}),o$W(0,o$o,"height",o$r.prototype._$get_height,function(o$o){o$j.superSet(o$z,this,"height",o$o),this._button.height=this._height}),o$W(0,o$o,"selectHandler",function(){return this._selectHandler},function(o$o){this._selectHandler=o$o}),o$W(0,o$o,"visibleNum",function(){return this._visibleNum},function(o$o){this._visibleNum=o$o,this._listChanged=!0}),o$W(0,o$o,"labelBold",function(){return this._button.text.bold},function(o$o){this._button.text.bold=o$o}),o$W(0,o$o,"itemColors",function(){return String(this._itemColors)},function(o$o){this._itemColors=o$R.fillArray(this._itemColors,o$o,String),this._listChanged=!0}),o$W(0,o$o,"itemSize",function(){return this._itemSize},function(o$o){this._itemSize=o$o,this._listChanged=!0}),o$W(0,o$o,"scrollBar",function(){return this.list.scrollBar}),o$W(0,o$o,"isOpen",function(){return this._isOpen},function(o$o){if(this._isOpen!=o$o)if(this._isOpen=o$o,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var o$r=this.localToGlobal(o$x.TEMP.setTo(0,0)),o$T=o$r.y+this._button.height;o$T=o$T+this._listHeight<=o$j.stage.height?o$T:o$r.y-this._listHeight,this._list.pos(o$r.x,o$T),this._list.zOrder=1001,o$j._currentStage.addChild(this._list),o$j.stage.once("mousedown",this,this.removeList),o$j.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),o$W(0,o$o,"scrollBarSkin",function(){return this._scrollBarSkin},function(o$o){this._scrollBarSkin=o$o}),o$W(0,o$o,"sizeGrid",function(){return this._button.sizeGrid},function(o$o){this._button.sizeGrid=o$o}),o$W(0,o$o,"button",function(){return this._button}),o$W(0,o$o,"list",function(){return this._list||this._createList(),this._list},function(o$o){o$o&&(o$o.removeSelf(),this._isCustomList=!0,this._list=o$o,this._setListEvent(o$o),this._itemHeight=o$o.getCell(0).height+o$o.spaceY)}),o$W(0,o$o,"dataSource",o$r.prototype._$get_dataSource,function(o$o){"number"==typeof(this._dataSource=o$o)&&Math.floor(o$o)==o$o||"string"==typeof o$o?this.selectedIndex=parseInt(o$o):o$o instanceof Array?this.labels=o$o.join(","):o$j.superSet(o$z,this,"dataSource",o$o)}),o$W(0,o$o,"labelColors",function(){return this._button.labelColors},function(o$o){this._button.labelColors!=o$o&&(this._button.labelColors=o$o)}),o$W(0,o$o,"labelPadding",function(){return this._button.text.padding.join(",")},function(o$o){this._button.text.padding=o$R.fillArray(o$H.labelPadding,o$o,Number)}),o$W(0,o$o,"labelSize",function(){return this._button.text.fontSize},function(o$o){this._button.text.fontSize=o$o}),o$W(0,o$o,"labelFont",function(){return this._button.text.font},function(o$o){this._button.text.font=o$o}),o$W(0,o$o,"stateNum",function(){return this._button.stateNum},function(o$o){this._button.stateNum=o$o}),o$T}(o$z),o$e=function(o$r){function o$T(o$o){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,o$T.__super.call(this),this._showButtons=o$u.showButtons,this._touchScrollEnable=o$u.touchScrollEnable,this._mouseWheelEnable=o$u.mouseWheelEnable,this.skin=o$o,this.max=1}o$D(o$T,"laya.ui.ScrollBar",o$r);var o$o=o$T.prototype;return o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),this.stopScroll(),this.target=null,o$r.prototype.destroy.call(this,o$o),this.upButton&&this.upButton.destroy(o$o),this.downButton&&this.downButton.destroy(o$o),this.slider&&this.slider.destroy(o$o),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},o$o.createChildren=function(){this.addChild(this.slider=new o$J),this.addChild(this.upButton=new o$X),this.addChild(this.downButton=new o$X)},o$o.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},o$o.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},o$o.onButtonMouseDown=function(o$o){var o$r=o$o.currentTarget===this.upButton;this.slide(o$r),o$j.timer.once(o$H.scrollBarDelayTime,this,this.startLoop,[o$r]),o$j.stage.once("mouseup",this,this.onStageMouseUp)},o$o.startLoop=function(o$o){o$j.timer.frameLoop(1,this,this.slide,[o$o])},o$o.slide=function(o$o){o$o?this.value-=this._scrollSize:this.value+=this._scrollSize},o$o.onStageMouseUp=function(o$o){o$j.timer.clear(this,this.startLoop),o$j.timer.clear(this,this.slide)},o$o.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},o$o.changeSize=function(){o$r.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},o$o.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},o$o.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},o$o.setScroll=function(o$o,o$r,o$T){this.runCallLater(this.changeSize),this.slider.setSlider(o$o,o$r,o$T),this.slider.bar.visible=0<o$r,!this._hide&&this.autoHide&&(this.visible=!1)},o$o.onTargetMouseWheel=function(o$o){this.value-=o$o.delta*this._scrollSize,this.target=this._target},o$o.onTargetMouseDown=function(o$o){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new o$x),this._lastPoint.setTo(o$j.stage.mouseX,o$j.stage.mouseY),o$j.timer.clear(this,this.tweenMove),o$b.clearTween(this),o$j.stage.once("mouseup",this,this.onStageMouseUp2),o$j.stage.once("mouseout",this,this.onStageMouseUp2),o$j.timer.frameLoop(1,this,this.loop)},o$o.loop=function(){var o$o=o$j.stage.mouseY,o$r=o$j.stage.mouseX;if(this._lastOffset=this.isVertical?o$o-this._lastPoint.y:o$r-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?o$j.stage._canvasTransform.getScaleY():o$j.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=o$r,this._lastPoint.y=o$o,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},o$o.onStageMouseUp2=function(o$o){if(o$j.stage.off("mouseup",this,this.onStageMouseUp2),o$j.stage.off("mouseout",this,this.onStageMouseUp2),o$j.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?o$b.to(this,{value:this.min},this.elasticBackTime,o$V.sineOut,o$i.create(this,this.elasticOver)):this._value>this.max&&o$b.to(this,{value:this.max},this.elasticBackTime,o$V.sineOut,o$i.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?o$j.stage.mouseY-this._lastPoint.y:o$j.stage.mouseX-this._lastPoint.x);for(var o$r=0,o$T=Math.min(this._offsets.length,3),o$k=0;o$k<o$T;o$k++)o$r+=this._offsets[this._offsets.length-1-o$k];if(this._lastOffset=o$r/o$T,(o$r=Math.abs(this._lastOffset))<2)return void this.event("end");60<o$r&&(this._lastOffset=0<this._lastOffset?60:-60);var o$W=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));o$j.timer.frameLoop(1,this,this.tweenMove,[o$W])}},o$o.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&o$b.to(this,{alpha:0},500),this.event("end")},o$o.tweenMove=function(o$o){this._lastOffset*=this.rollRatio;var o$r=NaN;if(0<o$o&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,o$r=.5*-(this.min-o$o-this.value),this._lastOffset>o$r&&(this._lastOffset=o$r)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,o$r=.5*-(this.max+o$o-this.value),this._lastOffset<o$r&&(this._lastOffset=o$r))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(o$j.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?o$b.to(this,{value:this.min},this.elasticBackTime,o$V.sineOut,o$i.create(this,this.elasticOver)):this._value>this.max?o$b.to(this,{value:this.max},this.elasticBackTime,o$V.sineOut,o$i.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&o$b.to(this,{alpha:0},500)}},o$o.stopScroll=function(){this.onStageMouseUp2(null),o$j.timer.clear(this,this.tweenMove),o$b.clearTween(this)},o$W(0,o$o,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),o$W(0,o$o,"skin",function(){return this._skin},function(o$o){this._skin!=o$o&&(this._skin=o$o,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),o$W(0,o$o,"max",function(){return this.slider.max},function(o$o){this.slider.max=o$o}),o$W(0,o$o,"showButtons",function(){return this._showButtons},function(o$o){this._showButtons=o$o,this.callLater(this.changeScrollBar)}),o$W(0,o$o,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),o$W(0,o$o,"min",function(){return this.slider.min},function(o$o){this.slider.min=o$o}),o$W(0,o$o,"value",function(){return this._value},function(o$o){o$o!==this._value&&(this._value=o$o,this._isElastic||(this.slider._value!=o$o&&(this.slider._value=o$o,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),o$W(0,o$o,"isVertical",function(){return this.slider.isVertical},function(o$o){this.slider.isVertical=o$o}),o$W(0,o$o,"sizeGrid",function(){return this.slider.sizeGrid},function(o$o){this.slider.sizeGrid=o$o}),o$W(0,o$o,"scrollSize",function(){return this._scrollSize},function(o$o){this._scrollSize=o$o}),o$W(0,o$o,"dataSource",o$r.prototype._$get_dataSource,function(o$o){"number"==typeof(this._dataSource=o$o)||"string"==typeof o$o?this.value=Number(o$o):o$j.superSet(o$z,this,"dataSource",o$o)}),o$W(0,o$o,"thumbPercent",function(){return this._thumbPercent},function(o$o){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),o$o=1<=o$o?.99:o$o,this._thumbPercent=o$o,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*o$o,o$H.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*o$o,o$H.scrollBarMinNum))}),o$W(0,o$o,"target",function(){return this._target},function(o$o){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=o$o)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),o$W(0,o$o,"hide",function(){return this._hide},function(o$o){this._hide=o$o,this.visible=!o$o}),o$W(0,o$o,"touchScrollEnable",function(){return this._touchScrollEnable},function(o$o){this._touchScrollEnable=o$o,this.target=this._target}),o$W(0,o$o,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(o$o){this._mouseWheelEnable=o$o,this.target=this._target}),o$W(0,o$o,"tick",function(){return this.slider.tick},function(o$o){this.slider.tick=o$o}),o$T}(o$z),o$J=function(o$r){function o$T(o$o){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,o$T.__super.call(this),this.skin=o$o}o$D(o$T,"laya.ui.Slider",o$r);var o$o=o$T.prototype;return o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,o$o),this._bg&&this._bg.destroy(o$o),this._bar&&this._bar.destroy(o$o),this._progress&&this._progress.destroy(o$o),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},o$o.createChildren=function(){this.addChild(this._bg=new o$Y),this.addChild(this._bar=new o$X)},o$o.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},o$o.onBarMouseDown=function(o$o){this._globalSacle||(this._globalSacle=new o$x),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=o$j.stage.mouseX,this._ty=o$j.stage.mouseY,o$j.stage.on("mousemove",this,this.mouseMove),o$j.stage.once("mouseup",this,this.mouseUp),o$j.stage.once("mouseout",this,this.mouseUp),this.showValueText()},o$o.showValueText=function(){if(this.showLabel){var o$o=laya.ui.Slider.label;this.addChild(o$o),o$o.textField.changeText(this._value+""),this.isVertical?(o$o.x=this._bar.x+20,o$o.y=.5*(this._bar.height-o$o.height)+this._bar.y):(o$o.y=this._bar.y-20,o$o.x=.5*(this._bar.width-o$o.width)+this._bar.x)}},o$o.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},o$o.mouseUp=function(o$o){o$j.stage.off("mousemove",this,this.mouseMove),o$j.stage.off("mouseup",this,this.mouseUp),o$j.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},o$o.mouseMove=function(o$o){var o$r=this._value;this.isVertical?(this._bar.y+=(o$j.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(o$j.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=o$j.stage.mouseX,this._ty=o$j.stage.mouseY;var o$T=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*o$T)/o$T,this._value!=o$r&&this.sendChangeEvent(),this.showValueText()},o$o.sendChangeEvent=function(o$o){void 0===o$o&&(o$o="change"),this.event(o$o),this.changeHandler&&this.changeHandler.runWith(this._value)},o$o.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},o$o.changeSize=function(){o$r.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},o$o.setSlider=function(o$o,o$r,o$T){this._value=-1,this._min=o$o,this._max=o$o<o$r?o$r:o$o,this.value=o$T<o$o?o$o:o$r<o$T?o$r:o$T},o$o.changeValue=function(){var o$o=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*o$o)/o$o,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var o$r=this._max-this._min;0===o$r&&(o$r=1),this.isVertical?(this._bar.y=(this._value-this._min)/o$r*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/o$r*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},o$o.onBgMouseDown=function(o$o){var o$r=this._bg.getMousePoint();this.isVertical?this.value=o$r.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=o$r.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},o$W(0,o$o,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),o$W(0,o$o,"skin",function(){return this._skin},function(o$o){if(this._skin!=o$o){this._skin=o$o,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var o$r=this._skin.replace(".png","$progress.png");o$$.getRes(o$r)&&(this._progress||(this.addChild(this._progress=new o$Y),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=o$r),this.setBarPoint(),this.callLater(this.changeValue)}}),o$W(0,o$o,"allowClickBack",function(){return this._allowClickBack},function(o$o){this._allowClickBack!=o$o&&((this._allowClickBack=o$o)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),o$W(0,o$o,"max",function(){return this._max},function(o$o){this._max!=o$o&&(this._max=o$o,this.callLater(this.changeValue))}),o$W(0,o$o,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),o$W(0,o$o,"tick",function(){return this._tick},function(o$o){this._tick!=o$o&&(this._tick=o$o,this.callLater(this.changeValue))}),o$W(0,o$o,"sizeGrid",function(){return this._bg.sizeGrid},function(o$o){this._bg.sizeGrid=o$o,this._bar.sizeGrid=o$o,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),o$W(0,o$o,"min",function(){return this._min},function(o$o){this._min!=o$o&&(this._min=o$o,this.callLater(this.changeValue))}),o$W(0,o$o,"value",function(){return this._value},function(o$o){if(this._value!=o$o){var o$r=this._value;this._value=o$o,this.changeValue(),this._value!=o$r&&this.sendChangeEvent()}}),o$W(0,o$o,"dataSource",o$r.prototype._$get_dataSource,function(o$o){"number"==typeof(this._dataSource=o$o)||"string"==typeof o$o?this.value=Number(o$o):o$j.superSet(o$z,this,"dataSource",o$o)}),o$W(0,o$o,"bar",function(){return this._bar}),o$k(o$T,["label",function(){return this.label=new o$A}]),o$T}(o$z),o$Y=function(o$r){function o$T(o$o){this._bitmap=null,this._skin=null,this._group=null,o$T.__super.call(this),this.skin=o$o}o$D(o$T,"laya.ui.Image",o$r);var o$o=o$T.prototype;return o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,o$$.clearCache(this,this._skin)},o$o.dispose=function(){this.destroy(!0),o$$.clearCache(this,this._skin)},o$o.createChildren=function(){this.graphics=this._bitmap=new o$s},o$o.setSource=function(o$o,o$r){o$o===this._skin&&o$r&&(this.source=o$r,this.onCompResize())},o$W(0,o$o,"source",function(){return this._bitmap.source},function(o$o){this._bitmap&&(this._bitmap.source=o$o,this.event("loaded"),this.repaint())}),o$W(0,o$o,"dataSource",o$r.prototype._$get_dataSource,function(o$o){"string"==typeof(this._dataSource=o$o)?this.skin=o$o:o$j.superSet(o$z,this,"dataSource",o$o)}),o$W(0,o$o,"measureHeight",function(){return this._bitmap.height}),o$W(0,o$o,"skin",function(){return this._skin},function(o$o){if(this._skin!=o$o)if(o$$.clearCache(this,this._skin),this._skin=o$o){o$$.keepCache(this,this._skin);var o$r=o$$.getRes(o$o);o$r?(this.source=o$r,this.onCompResize()):o$j.loader.load(this._skin,o$i.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),o$W(0,o$o,"group",function(){return this._group},function(o$o){o$o&&this._skin&&o$$.setGroup(this._skin,o$o),this._group=o$o}),o$W(0,o$o,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(o$o){this._bitmap.sizeGrid=o$R.fillArray(o$H.defaultSizeGrid,o$o,Number)}),o$W(0,o$o,"measureWidth",function(){return this._bitmap.width}),o$W(0,o$o,"width",o$r.prototype._$get_width,function(o$o){o$j.superSet(o$z,this,"width",o$o),this._bitmap.width=0==o$o?1e-7:o$o}),o$W(0,o$o,"height",o$r.prototype._$get_height,function(o$o){o$j.superSet(o$z,this,"height",o$o),this._bitmap.height=0==o$o?1e-7:o$o}),o$T}(o$z),o$A=function(o$r){function o$T(o$o){this._tf=null,o$T.__super.call(this),void 0===o$o&&(o$o=""),o$U.defaultColor=o$H.labelColor,this.text=o$o}o$D(o$T,"laya.ui.Label",o$r);var o$o=o$T.prototype;return o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,o$o),this._tf=null},o$o.createChildren=function(){this.addChild(this._tf=new o$S)},o$o.changeText=function(o$o){this._tf.changeText(o$o)},o$W(0,o$o,"padding",function(){return this._tf.padding.join(",")},function(o$o){this._tf.padding=o$R.fillArray(o$H.labelPadding,o$o,Number)}),o$W(0,o$o,"bold",function(){return this._tf.bold},function(o$o){this._tf.bold=o$o}),o$W(0,o$o,"align",function(){return this._tf.align},function(o$o){this._tf.align=o$o}),o$W(0,o$o,"text",function(){return this._tf.text},function(o$o){this._tf.text!=o$o&&(o$o&&(o$o=o$R.adptString(o$o+"")),this._tf.text=o$o,this.event("change"),this._width&&this._height||this.onCompResize())}),o$W(0,o$o,"italic",function(){return this._tf.italic},function(o$o){this._tf.italic=o$o}),o$W(0,o$o,"wordWrap",function(){return this._tf.wordWrap},function(o$o){this._tf.wordWrap=o$o}),o$W(0,o$o,"font",function(){return this._tf.font},function(o$o){this._tf.font=o$o}),o$W(0,o$o,"dataSource",o$r.prototype._$get_dataSource,function(o$o){"number"==typeof(this._dataSource=o$o)||"string"==typeof o$o?this.text=o$o+"":o$j.superSet(o$z,this,"dataSource",o$o)}),o$W(0,o$o,"color",function(){return this._tf.color},function(o$o){this._tf.color=o$o}),o$W(0,o$o,"valign",function(){return this._tf.valign},function(o$o){this._tf.valign=o$o}),o$W(0,o$o,"leading",function(){return this._tf.leading},function(o$o){this._tf.leading=o$o}),o$W(0,o$o,"fontSize",function(){return this._tf.fontSize},function(o$o){this._tf.fontSize=o$o}),o$W(0,o$o,"bgColor",function(){return this._tf.bgColor},function(o$o){this._tf.bgColor=o$o}),o$W(0,o$o,"borderColor",function(){return this._tf.borderColor},function(o$o){this._tf.borderColor=o$o}),o$W(0,o$o,"stroke",function(){return this._tf.stroke},function(o$o){this._tf.stroke=o$o}),o$W(0,o$o,"strokeColor",function(){return this._tf.strokeColor},function(o$o){this._tf.strokeColor=o$o}),o$W(0,o$o,"textField",function(){return this._tf}),o$W(0,o$o,"measureWidth",function(){return this._tf.width}),o$W(0,o$o,"measureHeight",function(){return this._tf.height}),o$W(0,o$o,"width",function(){return this._width||this._tf.text?o$j.superGet(o$z,this,"width"):0},function(o$o){o$j.superSet(o$z,this,"width",o$o),this._tf.width=o$o}),o$W(0,o$o,"height",function(){return this._height||this._tf.text?o$j.superGet(o$z,this,"height"):0},function(o$o){o$j.superSet(o$z,this,"height",o$o),this._tf.height=o$o}),o$W(0,o$o,"overflow",function(){return this._tf.overflow},function(o$o){this._tf.overflow=o$o}),o$W(0,o$o,"underline",function(){return this._tf.underline},function(o$o){this._tf.underline=o$o}),o$W(0,o$o,"underlineColor",function(){return this._tf.underlineColor},function(o$o){this._tf.underlineColor=o$o}),o$T}(o$z),o$I=function(o$r){function o$T(o$o){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,o$T.__super.call(this),this.skin=o$o}o$D(o$T,"laya.ui.ProgressBar",o$r);var o$o=o$T.prototype;return o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,o$o),this._bg&&this._bg.destroy(o$o),this._bar&&this._bar.destroy(o$o),this._bg=this._bar=null,this.changeHandler=null},o$o.createChildren=function(){this.addChild(this._bg=new o$Y),this.addChild(this._bar=new o$Y)},o$o.changeValue=function(){if(this.sizeGrid){var o$o=this.sizeGrid.split(","),o$r=Number(o$o[3]),o$T=Number(o$o[1]),o$k=(this.width-o$r-o$T)*this._value;this._bar.width=o$r+o$T+o$k,this._bar.visible=this._bar.width>o$r+o$T}else this._bar.width=this.width*this._value},o$W(0,o$o,"measureHeight",function(){return this._bg.height}),o$W(0,o$o,"skin",function(){return this._skin},function(o$o){this._skin!=o$o&&(this._skin=o$o,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),o$W(0,o$o,"measureWidth",function(){return this._bg.width}),o$W(0,o$o,"height",o$r.prototype._$get_height,function(o$o){o$j.superSet(o$z,this,"height",o$o),this._bg.height=this._height,this._bar.height=this._height}),o$W(0,o$o,"bar",function(){return this._bar}),o$W(0,o$o,"value",function(){return this._value},function(o$o){this._value!=o$o&&(o$o=1<o$o?1:o$o<0?0:o$o,this._value=o$o,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(o$o))}),o$W(0,o$o,"bg",function(){return this._bg}),o$W(0,o$o,"sizeGrid",function(){return this._bg.sizeGrid},function(o$o){this._bg.sizeGrid=this._bar.sizeGrid=o$o}),o$W(0,o$o,"width",o$r.prototype._$get_width,function(o$o){o$j.superSet(o$z,this,"width",o$o),this._bg.width=this._width,this.callLater(this.changeValue)}),o$W(0,o$o,"dataSource",o$r.prototype._$get_dataSource,function(o$o){"number"==typeof(this._dataSource=o$o)||"string"==typeof o$o?this.value=Number(o$o):o$j.superSet(o$z,this,"dataSource",o$o)}),o$T}(o$z),o$N=(function(o$o){function o$T(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,o$T.__super.call(this),this._tipBox=new o$z,this._tipBox.addChild(this._tipText=new o$S),this._tipText.x=this._tipText.y=5,this._tipText.color=o$T.tipTextColor,this._defaultTipHandler=this._showDefaultTip,o$j.stage.on("showtip",this,this._onStageShowTip),o$j.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}o$D(o$T,"laya.ui.TipManager",o$z);var o$r=o$T.prototype;o$r._onStageHideTip=function(o$o){o$j.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},o$r._onStageShowTip=function(o$o){o$j.timer.once(o$T.tipDelay,this,this._showTip,[o$o],!0)},o$r._showTip=function(o$o){if("string"==typeof o$o){var o$r=String(o$o);Boolean(o$r)&&this._defaultTipHandler(o$r)}else o$o instanceof laya.utils.Handler?o$o.run():"function"==typeof o$o&&o$o.apply();o$j.stage.on("mousemove",this,this._onStageMouseMove),o$j.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},o$r._onStageMouseDown=function(o$o){this.closeAll()},o$r._onStageMouseMove=function(o$o){this._showToStage(this,o$T.offsetX,o$T.offsetY)},o$r._showToStage=function(o$o,o$r,o$T){void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0);var o$k=o$o.getBounds();o$o.x=o$j.stage.mouseX+o$r,o$o.y=o$j.stage.mouseY+o$T,o$o.x+o$k.width>o$j.stage.width&&(o$o.x-=o$k.width+o$r),o$o.y+o$k.height>o$j.stage.height&&(o$o.y-=o$k.height+o$T)},o$r.closeAll=function(){o$j.timer.clear(this,this._showTip),o$j.stage.off("mousemove",this,this._onStageMouseMove),o$j.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},o$r.showDislayTip=function(o$o){this.addChild(o$o),this._showToStage(this),o$j._currentStage.addChild(this)},o$r._showDefaultTip=function(o$o){this._tipText.text=o$o;var o$r=this._tipBox.graphics;o$r.clear(),o$r.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,o$T.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),o$j._currentStage.addChild(this)},o$W(0,o$r,"defaultTipHandler",function(){return this._defaultTipHandler},function(o$o){this._defaultTipHandler=o$o}),o$T.offsetX=10,o$T.offsetY=15,o$T.tipTextColor="#ffffff",o$T.tipBackColor="#111111",o$T.tipDelay=200}(),function(o$o){var o$v;function o$x(){this._idMap=null,this._aniList=null,this._watchMap={},o$x.__super.call(this)}o$D(o$x,"laya.ui.View",o$C);var o$r=o$x.prototype;return o$r.createView=function(o$o){if(o$o.animations&&!this._idMap&&(this._idMap={}),o$x.createComp(o$o,this,this),o$o.animations){var o$r,o$T,o$k=[],o$W=o$o.animations,o$D=0,o$n=o$W.length;for(o$D=0;o$D<o$n;o$D++){switch(o$r=new o$h,o$T=o$W[o$D],o$r._setUp(this._idMap,o$T),(this[o$T.name]=o$r)._setControlNode(this),o$T.action){case 1:o$r.play(0,!1);break;case 2:o$r.play(0,!0)}o$k.push(o$r)}this._aniList=o$k}0<this._width&&null==o$o.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},o$r.onEvent=function(o$o,o$r){},o$r.loadUI=function(o$o){var o$r=o$x.uiMap[o$o];o$r&&this.createView(o$r)},o$r.destroy=function(o$o){void 0===o$o&&(o$o=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,o$o)},o$r.changeData=function(o$o){var o$r=this._watchMap[o$o];if(o$r){console.log("change",o$o);for(var o$T=0,o$k=o$r.length;o$T<o$k;o$T++){o$r[o$T].exe(this)}}},o$x._regs=function(){for(var o$o in o$x.uiClassMap)o$_.regClass(o$o,o$x.uiClassMap[o$o])},o$x.createComp=function(o$o,o$r,o$T,o$k){if(!(o$r=o$r||o$x.getCompInstance(o$o)))return console.warn("can not create:"+o$o.type),null;var o$W=o$o.child;if(o$W)for(var o$D=o$r instanceof laya.ui.List,o$n=0,o$V=o$W.length;o$n<o$V;o$n++){var o$L=o$W[o$n];if(!o$r.hasOwnProperty("itemRender")||"render"!=o$L.props.name&&"render"!==o$L.props.renderType)if("Graphic"==o$L.type)o$_.addGraphicsToSprite(o$L,o$r);else if(o$_.isDrawType(o$L.type))o$_.addGraphicToSprite(o$L,o$r,!0);else{if(o$D){var o$U=[],o$h=o$x.createComp(o$L,null,o$T,o$U);o$U.length&&(o$h._$bindData=o$U)}else o$h=o$x.createComp(o$L,null,o$T,o$k);"Script"==o$L.type?"owner"in o$h?o$h.owner=o$r:"target"in o$h&&(o$h.target=o$r):"mask"==o$L.props.renderType||"mask"==o$L.props.name?o$r.mask=o$h:o$h instanceof laya.display.Sprite&&o$r.addChild(o$h)}else o$r.itemRender=o$L}var o$p=o$o.props;for(var o$i in o$p){var o$v=o$p[o$i];o$x.eventDic[o$i]?o$v&&o$T&&o$r.on(o$i,o$T,o$T.onEvent,[o$v]):o$x.setCompValue(o$r,o$i,o$v,o$T,o$k)}return o$j.__typeof(o$r,"laya.ui.IItem")&&o$r.initItems(),o$o.compId&&o$T&&o$T._idMap&&(o$T._idMap[o$o.compId]=o$r),o$r},o$x.setCompValue=function(o$o,o$r,o$T,o$k,o$W){if("string"==typeof o$T&&-1<o$T.indexOf("${")){if(o$x._sheet||(o$x._sheet=o$_.getClass("laya.data.Table")),!o$x._sheet)return void console.warn("Can not find class Sheet");if(o$W)o$W.push(o$o,o$r,o$T);else if(o$k){-1==o$T.indexOf("].")&&(o$T=o$T.replace(".","[0]."));var o$D,o$n,o$V=new o$v(o$o,o$r,o$T);o$V.exe(o$k);for(var o$L=o$T.replace(/\[.*?\]\./g,".");null!=(o$D=o$x._parseWatchData.exec(o$L));){for(var o$U=o$D[1];null!=(o$n=o$x._parseKeyWord.exec(o$U));){var o$h=o$n[0],o$p=o$k._watchMap[o$h]||(o$k._watchMap[o$h]=[]);o$p.push(o$V),o$x._sheet.I.notifer.on(o$h,o$k,o$k.changeData,[o$h])}(o$p=o$k._watchMap[o$U]||(o$k._watchMap[o$U]=[])).push(o$V),o$x._sheet.I.notifer.on(o$U,o$k,o$k.changeData,[o$U])}}}else if("var"===o$r&&o$k)o$k[o$T]=o$o;else if("onClick"==o$r){var o$i=o$j._runScript("(function(){"+o$T+"})");o$o.on("click",o$k,o$i)}else o$o[o$r]="true"===o$T||"false"!==o$T&&o$T},o$x.getCompInstance=function(o$o){var o$r,o$T=o$o.props?o$o.props.runtime:null;return o$r=o$T?o$x.viewClassMap[o$T]||o$x.uiClassMap[o$T]||o$j.__classmap[o$T]:o$x.uiClassMap[o$o.type],o$o.props&&o$o.props.hasOwnProperty("renderType")&&"instance"==o$o.props.renderType?o$r.instance:o$r?new o$r:null},o$x.regComponent=function(o$o,o$r){o$x.uiClassMap[o$o]=o$r,o$_.regClass(o$o,o$r)},o$x.regViewRuntime=function(o$o,o$r){o$x.viewClassMap[o$o]=o$r},o$x.uiMap={},o$x.viewClassMap={},o$x._sheet=null,o$k(o$x,["uiClassMap",function(){return this.uiClassMap={ViewStack:o$oo,LinkButton:o$X,TextArea:o$Uo,ColorPicker:o$M,Box:o$C,Button:o$X,CheckBox:o$f,Clip:o$O,ComboBox:o$c,Component:o$z,HScrollBar:o$Z,HSlider:o$g,Image:o$Y,Label:o$A,List:o$w,Panel:o$Q,ProgressBar:o$I,Radio:o$E,RadioGroup:o$Vo,ScrollBar:o$e,Slider:o$J,Tab:o$Lo,TextInput:o$To,View:o$x,VScrollBar:o$ro,VSlider:o$ko,Tree:o$d,HBox:o$Do,VBox:o$no,Sprite:o$l,Animation:o$T,Text:o$S,FontClip:o$G}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),o$x.__init$=function(){o$x._regs(),o$v=function(){function o$o(o$o,o$r,o$T){this.comp=null,this.prop=null,this.value=null,this.comp=o$o,this.prop=o$r,this.value=o$T}return o$D(o$o,""),o$o.prototype.exe=function(o$o){var o$r=o$R.getBindFun(this.value);this.comp[this.prop]=o$r.call(this,o$o)},o$o}()},o$x}()),o$f=function(o$o){function o$T(o$o,o$r){void 0===o$r&&(o$r=""),o$T.__super.call(this,o$o,o$r)}o$D(o$T,"laya.ui.CheckBox",o$o);var o$r=o$T.prototype;return o$r.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},o$r.initialize=function(){o$o.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},o$W(0,o$r,"dataSource",o$o.prototype._$get_dataSource,function(o$o){"boolean"==typeof(this._dataSource=o$o)?this.selected=o$o:"string"==typeof o$o?this.selected="true"===o$o:o$j.superSet(o$X,this,"dataSource",o$o)}),o$T}(o$X),o$a=function(o$o){function o$r(){this._space=0,this._align="none",this._itemChanged=!1,o$r.__super.call(this)}o$D(o$r,"laya.ui.LayoutBox",o$C);var o$T=o$r.prototype;return o$T.addChild=function(o$o){return o$o.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,o$o)},o$T.onResize=function(o$o){this._setItemChanged()},o$T.addChildAt=function(o$o,o$r){return o$o.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,o$o,o$r)},o$T.removeChild=function(o$o){return o$o.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,o$o)},o$T.removeChildAt=function(o$o){return this.getChildAt(o$o).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,o$o)},o$T.refresh=function(){this._setItemChanged()},o$T.changeItems=function(){this._itemChanged=!1},o$T.sortItem=function(o$o){o$o&&o$o.sort(function(o$o,o$r){return o$o.y-o$r.y})},o$T._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},o$W(0,o$T,"space",function(){return this._space},function(o$o){this._space=o$o,this._setItemChanged()}),o$W(0,o$T,"align",function(){return this._align},function(o$o){this._align=o$o,this._setItemChanged()}),o$r}(),o$G=function(o$r){function o$T(o$o,o$r){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,o$T.__super.call(this),o$o&&(this.skin=o$o),o$r&&(this.sheet=o$r)}o$D(o$T,"laya.ui.FontClip",o$r);var o$o=o$T.prototype;return o$o.createChildren=function(){this._bitmap=new o$s,this.on("loaded",this,this._onClipLoaded)},o$o._onClipLoaded=function(){this.callLater(this.changeValue)},o$o.changeValue=function(){var o$o;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),o$o=this._sources[0]))){var o$r="horizontal"===this._direction;o$r?(this._wordsW=this._valueArr.length*(o$o.sourceWidth+this.spaceX),this._wordsH=o$o.sourceHeight):(this._wordsW=o$o.sourceWidth,this._wordsH=(o$o.sourceHeight+this.spaceY)*this._valueArr.length);var o$T=0;if(this._width)switch(this._align){case"center":o$T=.5*(this._width-this._wordsW);break;case"right":o$T=this._width-this._wordsW;break;default:o$T=0}for(var o$k=0,o$W=this._valueArr.length;o$k<o$W;o$k++){var o$D=this._indexMap[this._valueArr.charAt(o$k)];this.sources[o$D]&&(o$o=this.sources[o$D],o$r?this.graphics.drawTexture(o$o,o$T+o$k*(o$o.sourceWidth+this.spaceX),0,o$o.sourceWidth,o$o.sourceHeight):this.graphics.drawTexture(o$o,0+o$T,o$k*(o$o.sourceHeight+this.spaceY),o$o.sourceWidth,o$o.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),o$r.prototype.destroy.call(this,o$o)},o$W(0,o$o,"sheet",function(){return this._sheet},function(o$o){o$o+="";var o$r=(this._sheet=o$o).split(" ");this._clipX=String(o$r[0]).length,this.clipY=o$r.length,this._indexMap={};for(var o$T=0;o$T<this._clipY;o$T++)for(var o$k=o$r[o$T].split(""),o$W=0,o$D=o$k.length;o$W<o$D;o$W++)this._indexMap[o$k[o$W]]=o$T*this._clipX+o$W}),o$W(0,o$o,"height",o$r.prototype._$get_height,function(o$o){o$j.superSet(o$O,this,"height",o$o),this.callLater(this.changeValue)}),o$W(0,o$o,"direction",function(){return this._direction},function(o$o){this._direction=o$o,this.callLater(this.changeValue)}),o$W(0,o$o,"value",function(){return this._valueArr?this._valueArr:""},function(o$o){o$o+="",this._valueArr=o$o,this.callLater(this.changeValue)}),o$W(0,o$o,"width",o$r.prototype._$get_width,function(o$o){o$j.superSet(o$O,this,"width",o$o),this.callLater(this.changeValue)}),o$W(0,o$o,"spaceX",function(){return this._spaceX},function(o$o){this._spaceX=o$o,"horizontal"===this._direction&&this.callLater(this.changeValue)}),o$W(0,o$o,"spaceY",function(){return this._spaceY},function(o$o){this._spaceY=o$o,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),o$W(0,o$o,"align",function(){return this._align},function(o$o){this._align=o$o,this.callLater(this.changeValue)}),o$W(0,o$o,"measureWidth",function(){return this._wordsW}),o$W(0,o$o,"measureHeight",function(){return this._wordsH}),o$T}(o$O),o$w=function(o$o){function o$r(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new o$x,o$r.__super.call(this)}o$D(o$r,"laya.ui.List",o$o);var o$T=o$r.prototype;return o$j.imps(o$T,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),o$T.destroy=function(o$o){void 0===o$o&&(o$o=!0),this._content&&this._content.destroy(o$o),this._scrollBar&&this._scrollBar.destroy(o$o),laya.ui.Component.prototype.destroy.call(this,o$o),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},o$T.createChildren=function(){this.addChild(this._content=new o$C)},o$T.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=o$j.superGet(o$C,this,"cacheAs")),o$j.superSet(o$C,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},o$T.onScrollEnd=function(){o$j.superSet(o$C,this,"cacheAs",this._$P.cacheAs)},o$T._removePreScrollBar=function(){var o$o=this.removeChildByName("scrollBar");o$o&&o$o.destroy(!0)},o$T.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var o$o=this._getOneCell(),o$r=o$o.width+this._spaceX||1,o$T=o$o.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/o$r):Math.ceil(this._width/o$r)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/o$T):Math.round(this._height/o$T));var o$k=this._width?this._width:o$r*this.repeatX-this._spaceX,o$W=this._height?this._height:o$T*this.repeatY-this._spaceY;this._cellSize=this._isVertical?o$T:o$r,this._cellOffset=this._isVertical?o$T*Math.max(this._repeatY2,this._repeatY)-o$W-this._spaceY:o$r*Math.max(this._repeatX2,this._repeatX)-o$k-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=o$W:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=o$k),this.setContentSize(o$k,o$W);var o$D=this._isVertical?this.repeatX:this.repeatY,o$n=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,o$D,o$n),this._createdLine=o$n,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},o$T._getOneCell=function(){if(0===this._cells.length){var o$o=this.createItem();if(this._offset.setTo(o$o.x,o$o.y),this.cacheContent)return o$o;this._cells.push(o$o)}return this._cells[0]},o$T._createItems=function(o$o,o$r,o$T){var o$k=this._content,o$W=this._getOneCell(),o$D=o$W.width+this._spaceX,o$n=o$W.height+this._spaceY;if(this.cacheContent){var o$V=new o$C;o$V.cacheAsBitmap=!0,o$V.pos((this._isVertical?0:o$o)*o$D,(this._isVertical?o$o:0)*o$n),this._content.addChild(o$V),this._content.optimizeScrollRect=!0,o$k=o$V}else{for(var o$L=[],o$U=this._cells.length-1;-1<o$U;o$U--){var o$h=this._cells[o$U];o$h.removeSelf(),o$L.push(o$h)}this._cells.length=0}for(var o$p=o$o;o$p<o$T;o$p++)for(var o$i=0;o$i<o$r;o$i++)(o$W=o$L&&o$L.length?o$L.pop():this.createItem()).x=(this._isVertical?o$i:o$p)*o$D-o$k.x,o$W.y=(this._isVertical?o$p:o$i)*o$n-o$k.y,o$W.name="item"+(o$p*o$r+o$i),o$k.addChild(o$W),this.addCell(o$W)},o$T.createItem=function(){var o$o=[];if("function"==typeof this._itemRender)var o$r=new this._itemRender;else o$r=o$N.createComp(this._itemRender,null,null,o$o);if(0==o$o.length&&o$r._watchMap){var o$T=o$r._watchMap;for(var o$k in o$T)for(var o$W=o$T[o$k],o$D=0;o$D<o$W.length;o$D++){var o$n=o$W[o$D];o$o.push(o$n.comp,o$n.prop,o$n.value)}}return o$o.length&&(o$r._$bindData=o$o),o$r},o$T.addCell=function(o$o){o$o.on("click",this,this.onCellMouse),o$o.on("rightclick",this,this.onCellMouse),o$o.on("mouseover",this,this.onCellMouse),o$o.on("mouseout",this,this.onCellMouse),o$o.on("mousedown",this,this.onCellMouse),o$o.on("mouseup",this,this.onCellMouse),this._cells.push(o$o)},o$T.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var o$o=0,o$r=o$o=0;o$r<1e4;o$r++){var o$T=this.getChildByName("item"+o$r);if(!o$T)break;this.addCell(o$T),o$o++}this.repeatY=o$o}},o$T.setContentSize=function(o$o,o$r){this._content.width=o$o,this._content.height=o$r,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new o$K),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,o$o,o$r),this._content.scrollRect=this._content.scrollRect),this.event("resize")},o$T.onCellMouse=function(o$o){"mousedown"===o$o.type&&(this._isMoved=!1);var o$r=o$o.currentTarget,o$T=this._startIndex+this._cells.indexOf(o$r);o$T<0||("click"===o$o.type||"rightclick"===o$o.type?this.selectEnable&&!this._isMoved?this.selectedIndex=o$T:this.changeCellState(o$r,!0,0):"mouseover"!==o$o.type&&"mouseout"!==o$o.type||this._selectedIndex===o$T||this.changeCellState(o$r,"mouseover"===o$o.type,0),this.mouseHandler&&this.mouseHandler.runWith([o$o,o$T]))},o$T.changeCellState=function(o$o,o$r,o$T){var o$k=o$o.getChildByName("selectBox");o$k&&(this.selectEnable=!0,o$k.visible=o$r,o$k.index=o$T)},o$T.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},o$T.onScrollBarChange=function(o$o){this.runCallLater(this.changeCells);var o$r=this._scrollBar.value,o$T=this._isVertical?this.repeatX:this.repeatY,o$k=this._isVertical?this.repeatY:this.repeatX,o$W=Math.floor(o$r/this._cellSize);if(this.cacheContent)o$n=o$k+1,this._createdLine-o$W<o$n&&(this._createItems(this._createdLine,o$T,this._createdLine+o$n),this.renderItems(this._createdLine*o$T,0),this._createdLine+=o$n);else{var o$D=o$W*o$T,o$n=0;if(o$D>this._startIndex){o$n=o$D-this._startIndex;var o$V=!0,o$L=this._startIndex+o$T*(o$k+1);this._isMoved=!0}else o$D<this._startIndex&&(o$n=this._startIndex-o$D,o$V=!1,o$L=this._startIndex-1,this._isMoved=!0);for(var o$U=0;o$U<o$n;o$U++){if(o$V){var o$h=this._cells.shift();this._cells[this._cells.length]=o$h;var o$p=o$L+o$U}else o$h=this._cells.pop(),this._cells.unshift(o$h),o$p=o$L-o$U;var o$i=Math.floor(o$p/o$T)*this._cellSize;this._isVertical?o$h.y=o$i:o$h.x=o$i,this.renderItem(o$h,o$p)}this._startIndex=o$D,this.changeSelectStatus()}var o$v=this._content.scrollRect;this._isVertical?(o$v.y=o$r-this._offset.y,o$v.x=-this._offset.x):(o$v.y=-this._offset.y,o$v.x=o$r-this._offset.x),this._content.scrollRect=o$v},o$T.posCell=function(o$o,o$r){if(this._scrollBar){var o$T=this._isVertical?this.repeatX:this.repeatY,o$k=(this._isVertical?this.repeatY:this.repeatX,Math.floor(o$r/o$T)*this._cellSize);this._isVertical?o$o.y=o$k:o$o.x=o$k}},o$T.changeSelectStatus=function(){for(var o$o=0,o$r=this._cells.length;o$o<o$r;o$o++)this.changeCellState(this._cells[o$o],this._selectedIndex===this._startIndex+o$o,1)},o$T.renderItems=function(o$o,o$r){void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0);for(var o$T=o$o,o$k=o$r||this._cells.length;o$T<o$k;o$T++)this.renderItem(this._cells[o$T],this._startIndex+o$T);this.changeSelectStatus()},o$T.renderItem=function(o$o,o$r){this._array&&0<=o$r&&o$r<this._array.length?(o$o.visible=!0,o$o._$bindData?(o$o._dataSource=this._array[o$r],this._bindData(o$o,this._array[o$r])):o$o.dataSource=this._array[o$r],this.cacheContent||this.posCell(o$o,o$r),this.hasListener("render")&&this.event("render",[o$o,o$r]),this.renderHandler&&this.renderHandler.runWith([o$o,o$r])):(o$o.visible=!1,o$o.dataSource=null)},o$T._bindData=function(o$o,o$r){for(var o$T=o$o._$bindData,o$k=0,o$W=o$T.length;o$k<o$W;o$k++){var o$D=o$T[o$k++],o$n=o$T[o$k++],o$V=o$T[o$k],o$L=o$R.getBindFun(o$V);o$D[o$n]=o$L.call(this,o$r)}},o$T.refresh=function(){this.array=this._array},o$T.getItem=function(o$o){return-1<o$o&&o$o<this._array.length?this._array[o$o]:null},o$T.changeItem=function(o$o,o$r){-1<o$o&&o$o<this._array.length&&(this._array[o$o]=o$r,o$o>=this._startIndex&&o$o<this._startIndex+this._cells.length&&this.renderItem(this.getCell(o$o),o$o))},o$T.setItem=function(o$o,o$r){this.changeItem(o$o,o$r)},o$T.addItem=function(o$o){this._array.push(o$o),this.array=this._array},o$T.addItemAt=function(o$o,o$r){this._array.splice(o$r,0,o$o),this.array=this._array},o$T.deleteItem=function(o$o){this._array.splice(o$o,1),this.array=this._array},o$T.getCell=function(o$o){return this.runCallLater(this.changeCells),-1<o$o&&this._cells?this._cells[(o$o-this._startIndex)%this._cells.length]:null},o$T.scrollTo=function(o$o){if(this._scrollBar){var o$r=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(o$o/o$r)*this._cellSize}else this.startIndex=o$o},o$T.tweenTo=function(o$o,o$r,o$T){if(void 0===o$r&&(o$r=200),this._scrollBar){var o$k=this._isVertical?this.repeatX:this.repeatY;o$b.to(this._scrollBar,{value:Math.floor(o$o/o$k)*this._cellSize},o$r,null,o$T,0,!0)}else this.startIndex=o$o,o$T&&o$T.run()},o$T._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},o$T.commitMeasure=function(){this.runCallLater(this.changeCells)},o$W(0,o$T,"cacheAs",o$o.prototype._$get_cacheAs,function(o$o){o$j.superSet(o$C,this,"cacheAs",o$o),this._scrollBar&&(this._$P.cacheAs=null,"none"!==o$o?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),o$W(0,o$T,"content",function(){return this._content}),o$W(0,o$T,"height",o$o.prototype._$get_height,function(o$o){o$o!=this._height&&(o$j.superSet(o$C,this,"height",o$o),this._setCellChanged())}),o$W(0,o$T,"itemRender",function(){return this._itemRender},function(o$o){if(this._itemRender!=o$o){this._itemRender=o$o;for(var o$r=this._cells.length-1;-1<o$r;o$r--)this._cells[o$r].destroy();this._cells.length=0,this._setCellChanged()}}),o$W(0,o$T,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(o$o){this._removePreScrollBar();var o$r=new o$ro;o$r.name="scrollBar",o$r.right=0,o$o&&" "!=o$o&&(o$r.skin=o$o),this.scrollBar=o$r,this.addChild(o$r),this._setCellChanged()}),o$W(0,o$T,"page",function(){return this._page},function(o$o){this._page=o$o,this._array&&(this._page=0<o$o?o$o:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),o$W(0,o$T,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(o$o){this._removePreScrollBar();var o$r=new o$Z;o$r.name="scrollBar",o$r.bottom=0,o$o&&" "!=o$o&&(o$r.skin=o$o),this.scrollBar=o$r,this.addChild(o$r),this._setCellChanged()}),o$W(0,o$T,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(o$o){this._repeatX=o$o,this._setCellChanged()}),o$W(0,o$T,"scrollBar",function(){return this._scrollBar},function(o$o){this._scrollBar!=o$o&&(this._scrollBar=o$o)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),o$W(0,o$T,"width",o$o.prototype._$get_width,function(o$o){o$o!=this._width&&(o$j.superSet(o$C,this,"width",o$o),this._setCellChanged())}),o$W(0,o$T,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(o$o){this._repeatY=o$o,this._setCellChanged()}),o$W(0,o$T,"spaceX",function(){return this._spaceX},function(o$o){this._spaceX=o$o,this._setCellChanged()}),o$W(0,o$T,"spaceY",function(){return this._spaceY},function(o$o){this._spaceY=o$o,this._setCellChanged()}),o$W(0,o$T,"selectedIndex",function(){return this._selectedIndex},function(o$o){this._selectedIndex!=o$o&&(this._selectedIndex=o$o,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(o$o),this.startIndex=this._startIndex)}),o$W(0,o$T,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(o$o){this.selectedIndex=this._array.indexOf(o$o)}),o$W(0,o$T,"length",function(){return this._array?this._array.length:0}),o$W(0,o$T,"selection",function(){return this.getCell(this._selectedIndex)},function(o$o){this.selectedIndex=this._startIndex+this._cells.indexOf(o$o)}),o$W(0,o$T,"startIndex",function(){return this._startIndex},function(o$o){this._startIndex=0<o$o?o$o:0,this.callLater(this.renderItems)}),o$W(0,o$T,"array",function(){return this._array},function(o$o){this.runCallLater(this.changeCells),this._array=o$o||[];var o$r=this._array.length;if(this.totalPage=Math.ceil(o$r/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<o$r?this._selectedIndex:o$r-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var o$T=this._isVertical?this.repeatX:this.repeatY,o$k=this._isVertical?this.repeatY:this.repeatX,o$W=Math.ceil(o$r/o$T);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=o$k/o$W,this._scrollBar.setScroll(0,(o$W-o$k)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),o$W(0,o$T,"dataSource",o$o.prototype._$get_dataSource,function(o$o){"number"==typeof(this._dataSource=o$o)&&Math.floor(o$o)==o$o||"string"==typeof o$o?this.selectedIndex=parseInt(o$o):o$o instanceof Array?this.array=o$o:o$j.superSet(o$C,this,"dataSource",o$o)}),o$W(0,o$T,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),o$r}(o$C),o$Z=function(o$o){function o$r(){o$r.__super.call(this)}return o$D(o$r,"laya.ui.HScrollBar",o$o),o$r.prototype.initialize=function(){o$o.prototype.initialize.call(this),this.slider.isVertical=!1},o$r}(o$e),o$Q=function(o$o){function o$r(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,o$r.__super.call(this),this.width=this.height=100}o$D(o$r,"laya.ui.Panel",o$o);var o$T=o$r.prototype;return o$T.destroy=function(o$o){void 0===o$o&&(o$o=!0),laya.ui.Component.prototype.destroy.call(this,o$o),this._content&&this._content.destroy(o$o),this._vScrollBar&&this._vScrollBar.destroy(o$o),this._hScrollBar&&this._hScrollBar.destroy(o$o),this._vScrollBar=null,this._hScrollBar=null,this._content=null},o$T.destroyChildren=function(){this._content.destroyChildren()},o$T.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new o$C)},o$T.addChild=function(o$o){return o$o.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(o$o)},o$T.onResize=function(){this._setScrollChanged()},o$T.addChildAt=function(o$o,o$r){return o$o.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(o$o,o$r)},o$T.removeChild=function(o$o){return o$o.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(o$o)},o$T.removeChildAt=function(o$o){return this.getChildAt(o$o).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(o$o)},o$T.removeChildren=function(o$o,o$r){return void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=2147483647),this._content.removeChildren(o$o,o$r),this._setScrollChanged(),this},o$T.getChildAt=function(o$o){return this._content.getChildAt(o$o)},o$T.getChildByName=function(o$o){return this._content.getChildByName(o$o)},o$T.getChildIndex=function(o$o){return this._content.getChildIndex(o$o)},o$T.changeScroll=function(){this._scrollChanged=!1;var o$o=this.contentWidth||1,o$r=this.contentHeight||1,o$T=this._vScrollBar,o$k=this._hScrollBar,o$W=o$T&&o$r>this._height,o$D=o$k&&o$o>this._width,o$n=o$W?this._width-o$T.width:this._width,o$V=o$D?this._height-o$k.height:this._height;o$T&&(o$T.x=this._width-o$T.width,o$T.y=0,o$T.height=this._height-(o$D?o$k.height:0),o$T.scrollSize=Math.max(.033*this._height,1),o$T.thumbPercent=o$V/o$r,o$T.setScroll(0,o$r-o$V,o$T.value)),o$k&&(o$k.x=0,o$k.y=this._height-o$k.height,o$k.width=this._width-(o$W?o$T.width:0),o$k.scrollSize=Math.max(.033*this._width,1),o$k.thumbPercent=o$n/o$o,o$k.setScroll(0,o$o-o$n,o$k.value))},o$T.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},o$T.setContentSize=function(o$o,o$r){var o$T=this._content;o$T.width=o$o,o$T.height=o$r,o$T.scrollRect||(o$T.scrollRect=new o$K),o$T.scrollRect.setTo(0,0,o$o,o$r),o$T.scrollRect=o$T.scrollRect},o$T.onScrollBarChange=function(o$o){var o$r=this._content.scrollRect;if(o$r){var o$T=Math.round(o$o.value);o$o.isVertical?o$r.y=o$T:o$r.x=o$T,this._content.scrollRect=o$r}},o$T.scrollTo=function(o$o,o$r){void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),this.vScrollBar&&(this.vScrollBar.value=o$r),this.hScrollBar&&(this.hScrollBar.value=o$o)},o$T.refresh=function(){this.changeScroll()},o$T.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=o$j.superGet(o$C,this,"cacheAs")),o$j.superSet(o$C,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},o$T.onScrollEnd=function(){o$j.superSet(o$C,this,"cacheAs",this._$P.cacheAs)},o$T._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},o$W(0,o$T,"numChildren",function(){return this._content.numChildren}),o$W(0,o$T,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(o$o){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new o$Z),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=o$o}),o$W(0,o$T,"contentWidth",function(){for(var o$o=0,o$r=this._content.numChildren-1;-1<o$r;o$r--){var o$T=this._content.getChildAt(o$r);o$o=Math.max(o$T.x+o$T.width*o$T.scaleX,o$o)}return o$o}),o$W(0,o$T,"contentHeight",function(){for(var o$o=0,o$r=this._content.numChildren-1;-1<o$r;o$r--){var o$T=this._content.getChildAt(o$r);o$o=Math.max(o$T.y+o$T.height*o$T.scaleY,o$o)}return o$o}),o$W(0,o$T,"width",o$o.prototype._$get_width,function(o$o){o$j.superSet(o$C,this,"width",o$o),this._setScrollChanged()}),o$W(0,o$T,"hScrollBar",function(){return this._hScrollBar}),o$W(0,o$T,"content",function(){return this._content}),o$W(0,o$T,"height",o$o.prototype._$get_height,function(o$o){o$j.superSet(o$C,this,"height",o$o),this._setScrollChanged()}),o$W(0,o$T,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(o$o){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new o$ro),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=o$o}),o$W(0,o$T,"vScrollBar",function(){return this._vScrollBar}),o$W(0,o$T,"cacheAs",o$o.prototype._$get_cacheAs,function(o$o){o$j.superSet(o$C,this,"cacheAs",o$o),this._$P.cacheAs=null,"none"!==o$o?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),o$r}(o$C),o$g=function(o$o){function o$r(o$o){o$r.__super.call(this,o$o),this.isVertical=!1}return o$D(o$r,"laya.ui.HSlider",o$J),o$r}(),o$B=function(o$o){function o$T(o$o,o$r){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,o$T.__super.call(this),this.skin=o$r,this.labels=o$o}o$D(o$T,"laya.ui.UIGroup",o$o);var o$r=o$T.prototype;return o$j.imps(o$r,{"laya.ui.IItem":!0}),o$r.preinitialize=function(){this.mouseEnabled=!0},o$r.destroy=function(o$o){void 0===o$o&&(o$o=!0),laya.ui.Component.prototype.destroy.call(this,o$o),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},o$r.addItem=function(o$o,o$r){void 0===o$r&&(o$r=!0);var o$T=o$o,o$k=this._items.length;if(o$T.name="item"+o$k,this.addChild(o$T),this.initItems(),o$r&&0<o$k){var o$W=this._items[o$k-1];"horizontal"==this._direction?o$T.x=o$W.x+o$W.width+this._space:o$T.y=o$W.y+o$W.height+this._space}else o$r&&(o$T.x=0,o$T.y=0);return o$k},o$r.delItem=function(o$o,o$r){void 0===o$r&&(o$r=!0);var o$T=this._items.indexOf(o$o);if(-1!=o$T){var o$k=o$o;this.removeChild(o$k);for(var o$W=o$T+1,o$D=this._items.length;o$W<o$D;o$W++){var o$n=this._items[o$W];o$n.name="item"+(o$W-1),o$r&&("horizontal"==this._direction?o$n.x-=o$k.width+this._space:o$n.y-=o$k.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var o$V;o$V=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=o$V}}},o$r.initItems=function(){this._items||(this._items=[]);for(var o$o=this._items.length=0;o$o<1e4;o$o++){var o$r=this.getChildByName("item"+o$o);if(null==o$r)break;this._items.push(o$r),o$r.selected=o$o===this._selectedIndex,o$r.clickHandler=o$i.create(this,this.itemClick,[o$o],!1)}},o$r.itemClick=function(o$o){this.selectedIndex=o$o},o$r.setSelect=function(o$o,o$r){this._items&&-1<o$o&&o$o<this._items.length&&(this._items[o$o].selected=o$r)},o$r.createItem=function(o$o,o$r){return null},o$r.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var o$o=0,o$r=0,o$T=this._items.length;o$r<o$T;o$r++){var o$k=this._items[o$r];this._skin&&(o$k.skin=this._skin),this._labelColors&&(o$k.labelColors=this._labelColors),this._labelSize&&(o$k.labelSize=this._labelSize),this._labelStroke&&(o$k.labelStroke=this._labelStroke),this._labelStrokeColor&&(o$k.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(o$k.strokeColors=this._strokeColors),this._labelBold&&(o$k.labelBold=this._labelBold),this._labelPadding&&(o$k.labelPadding=this._labelPadding),this._labelAlign&&(o$k.labelAlign=this._labelAlign),this._stateNum&&(o$k.stateNum=this._stateNum),this._labelFont&&(o$k.labelFont=this._labelFont),"horizontal"===this._direction?(o$k.y=0,o$k.x=o$o,o$o+=o$k.width+this._space):(o$k.x=0,o$k.y=o$o,o$o+=o$k.height+this._space)}this.changeSize()},o$r.commitMeasure=function(){this.runCallLater(this.changeLabels)},o$r._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},o$W(0,o$r,"labelStrokeColor",function(){return this._labelStrokeColor},function(o$o){this._labelStrokeColor!=o$o&&(this._labelStrokeColor=o$o,this._setLabelChanged())}),o$W(0,o$r,"skin",function(){return this._skin},function(o$o){this._skin!=o$o&&(this._skin=o$o,this._setLabelChanged())}),o$W(0,o$r,"selectedIndex",function(){return this._selectedIndex},function(o$o){this._selectedIndex!=o$o&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=o$o,this.setSelect(o$o,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),o$W(0,o$r,"labels",function(){return this._labels},function(o$o){if(this._labels!=o$o){if(this._labels=o$o,this.removeChildren(),this._setLabelChanged(),this._labels)for(var o$r=this._labels.split(","),o$T=0,o$k=o$r.length;o$T<o$k;o$T++){var o$W=this.createItem(this._skin,o$r[o$T]);o$W.name="item"+o$T,this.addChild(o$W)}this.initItems()}}),o$W(0,o$r,"strokeColors",function(){return this._strokeColors},function(o$o){this._strokeColors!=o$o&&(this._strokeColors=o$o,this._setLabelChanged())}),o$W(0,o$r,"labelColors",function(){return this._labelColors},function(o$o){this._labelColors!=o$o&&(this._labelColors=o$o,this._setLabelChanged())}),o$W(0,o$r,"labelStroke",function(){return this._labelStroke},function(o$o){this._labelStroke!=o$o&&(this._labelStroke=o$o,this._setLabelChanged())}),o$W(0,o$r,"labelSize",function(){return this._labelSize},function(o$o){this._labelSize!=o$o&&(this._labelSize=o$o,this._setLabelChanged())}),o$W(0,o$r,"stateNum",function(){return this._stateNum},function(o$o){this._stateNum!=o$o&&(this._stateNum=o$o,this._setLabelChanged())}),o$W(0,o$r,"labelBold",function(){return this._labelBold},function(o$o){this._labelBold!=o$o&&(this._labelBold=o$o,this._setLabelChanged())}),o$W(0,o$r,"labelFont",function(){return this._labelFont},function(o$o){this._labelFont!=o$o&&(this._labelFont=o$o,this._setLabelChanged())}),o$W(0,o$r,"labelPadding",function(){return this._labelPadding},function(o$o){this._labelPadding!=o$o&&(this._labelPadding=o$o,this._setLabelChanged())}),o$W(0,o$r,"direction",function(){return this._direction},function(o$o){this._direction=o$o,this._setLabelChanged()}),o$W(0,o$r,"space",function(){return this._space},function(o$o){this._space=o$o,this._setLabelChanged()}),o$W(0,o$r,"items",function(){return this._items}),o$W(0,o$r,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(o$o){this.selectedIndex=this._items.indexOf(o$o)}),o$W(0,o$r,"dataSource",o$o.prototype._$get_dataSource,function(o$o){"number"==typeof(this._dataSource=o$o)&&Math.floor(o$o)==o$o||"string"==typeof o$o?this.selectedIndex=parseInt(o$o):o$o instanceof Array?this.labels=o$o.join(","):o$j.superSet(o$C,this,"dataSource",o$o)}),o$T}(o$C),o$E=function(o$r){function o$T(o$o,o$r){this._value=null,void 0===o$r&&(o$r=""),o$T.__super.call(this,o$o,o$r)}o$D(o$T,"laya.ui.Radio",o$r);var o$o=o$T.prototype;return o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,o$o),this._value=null},o$o.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},o$o.initialize=function(){o$r.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},o$o.onClick=function(o$o){this.selected=!0},o$W(0,o$o,"value",function(){return null!=this._value?this._value:this.label},function(o$o){this._value=o$o}),o$T}(o$X),o$d=function(o$o){function o$r(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,o$r.__super.call(this),this.width=this.height=200}o$D(o$r,"laya.ui.Tree",o$o);var o$T=o$r.prototype;return o$j.imps(o$T,{"laya.ui.IRender":!0}),o$T.destroy=function(o$o){void 0===o$o&&(o$o=!0),laya.ui.Component.prototype.destroy.call(this,o$o),this._list&&this._list.destroy(o$o),this._list=null,this._source=null,this._renderHandler=null},o$T.createChildren=function(){this.addChild(this._list=new o$w),this._list.renderHandler=o$i.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},o$T.onListChange=function(o$o){this.event("change")},o$T.getArray=function(){var o$o,o$r=[];for(var o$T in this._source)o$o=this._source[o$T],this.getParentOpenStatus(o$o)&&(o$o.x=this._spaceLeft*this.getDepth(o$o),o$r.push(o$o));return o$r},o$T.getDepth=function(o$o,o$r){return void 0===o$r&&(o$r=0),null==o$o.nodeParent?o$r:this.getDepth(o$o.nodeParent,o$r+1)},o$T.getParentOpenStatus=function(o$o){var o$r=o$o.nodeParent;return null==o$r||!!o$r.isOpen&&(null==o$r.nodeParent||this.getParentOpenStatus(o$r))},o$T.renderItem=function(o$o,o$r){var o$T=o$o.dataSource;if(o$T){o$o.left=o$T.x;var o$k=o$o.getChildByName("arrow");o$k&&(o$T.hasChild?(o$k.visible=!0,o$k.index=o$T.isOpen?1:0,o$k.tag=o$r,o$k.off("click",this,this.onArrowClick),o$k.on("click",this,this.onArrowClick)):o$k.visible=!1);var o$W=o$o.getChildByName("folder");o$W&&(2==o$W.clipY?o$W.index=o$T.isDirectory?0:1:o$W.index=o$T.isDirectory?o$T.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([o$o,o$r])}},o$T.onArrowClick=function(o$o){var o$r=o$o.currentTarget.tag;this._list.array[o$r].isOpen=!this._list.array[o$r].isOpen,this.event("open"),this._list.array=this.getArray()},o$T.setItemState=function(o$o,o$r){this._list.array[o$o]&&(this._list.array[o$o].isOpen=o$r,this._list.array=this.getArray())},o$T.fresh=function(){this._list.array=this.getArray(),this.repaint()},o$T.parseXml=function(o$o,o$r,o$T,o$k){var o$W,o$D=o$o.childNodes,o$n=o$D.length;if(!o$k){o$W={};var o$V,o$L=o$o.attributes;for(var o$U in o$L){var o$h=(o$V=o$L[o$U]).nodeName,o$p=o$V.nodeValue;o$W[o$h]="true"==o$p||"false"!=o$p&&o$p}o$W.nodeParent=o$T,0<o$n&&(o$W.isDirectory=!0),o$W.hasChild=0<o$n,o$r.push(o$W)}for(var o$i=0;o$i<o$n;o$i++){var o$v=o$D[o$i];this.parseXml(o$v,o$r,o$W,!1)}},o$T.parseOpenStatus=function(o$o,o$r){for(var o$T=0,o$k=o$r.length;o$T<o$k;o$T++){var o$W=o$r[o$T];if(o$W.isDirectory)for(var o$D=0,o$n=o$o.length;o$D<o$n;o$D++){var o$V=o$o[o$D];if(o$V.isDirectory&&this.isSameParent(o$V,o$W)&&o$W.label==o$V.label){o$W.isOpen=o$V.isOpen;break}}}},o$T.isSameParent=function(o$o,o$r){return null==o$o.nodeParent&&null==o$r.nodeParent||null!=o$o.nodeParent&&null!=o$r.nodeParent&&(o$o.nodeParent.label==o$r.nodeParent.label&&this.isSameParent(o$o.nodeParent,o$r.nodeParent))},o$T.filter=function(o$o){if(Boolean(o$o)){var o$r=[];this.getFilterSource(this._source,o$r,o$o),this._list.array=o$r}else this._list.array=this.getArray()},o$T.getFilterSource=function(o$o,o$r,o$T){var o$k;for(var o$W in o$T=o$T.toLocaleLowerCase(),o$o)!(o$k=o$o[o$W]).isDirectory&&-1<String(o$k.label).toLowerCase().indexOf(o$T)&&(o$k.x=0,o$r.push(o$k)),o$k.child&&0<o$k.child.length&&this.getFilterSource(o$k.child,o$r,o$T)},o$W(0,o$T,"spaceBottom",function(){return this._list.spaceY},function(o$o){this._list.spaceY=o$o}),o$W(0,o$T,"keepStatus",function(){return this._keepStatus},function(o$o){this._keepStatus=o$o}),o$W(0,o$T,"itemRender",function(){return this._list.itemRender},function(o$o){this._list.itemRender=o$o}),o$W(0,o$T,"array",function(){return this._list.array},function(o$o){this._keepStatus&&this._list.array&&o$o&&this.parseOpenStatus(this._list.array,o$o),this._source=o$o,this._list.array=this.getArray()}),o$W(0,o$T,"mouseHandler",function(){return this._list.mouseHandler},function(o$o){this._list.mouseHandler=o$o}),o$W(0,o$T,"dataSource",o$o.prototype._$get_dataSource,function(o$o){this._dataSource=o$o,o$j.superSet(o$C,this,"dataSource",o$o)}),o$W(0,o$T,"source",function(){return this._source}),o$W(0,o$T,"scrollBar",function(){return this._list.scrollBar}),o$W(0,o$T,"list",function(){return this._list}),o$W(0,o$T,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(o$o){this._list.vScrollBarSkin=o$o}),o$W(0,o$T,"renderHandler",function(){return this._renderHandler},function(o$o){this._renderHandler=o$o}),o$W(0,o$T,"selectedIndex",function(){return this._list.selectedIndex},function(o$o){this._list.selectedIndex=o$o}),o$W(0,o$T,"spaceLeft",function(){return this._spaceLeft},function(o$o){this._spaceLeft=o$o}),o$W(0,o$T,"selectedItem",function(){return this._list.selectedItem},function(o$o){this._list.selectedItem=o$o}),o$W(0,o$T,"width",o$o.prototype._$get_width,function(o$o){o$j.superSet(o$C,this,"width",o$o),this._list.width=o$o}),o$W(0,o$T,"height",o$o.prototype._$get_height,function(o$o){o$j.superSet(o$C,this,"height",o$o),this._list.height=o$o}),o$W(0,o$T,"xml",null,function(o$o){var o$r=[];this.parseXml(o$o.childNodes[0],o$r,null,!0),this.array=o$r}),o$W(0,o$T,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),o$r}(o$C),o$oo=function(o$o){function o$r(){this._items=null,this._selectedIndex=0,o$r.__super.call(this),this._setIndexHandler=o$i.create(this,this.setIndex,null,!1)}o$D(o$r,"laya.ui.ViewStack",o$o);var o$T=o$r.prototype;return o$j.imps(o$T,{"laya.ui.IItem":!0}),o$T.setItems=function(o$o){this.removeChildren();for(var o$r=0,o$T=0,o$k=o$o.length;o$T<o$k;o$T++){var o$W=o$o[o$T];o$W&&(o$W.name="item"+o$r,this.addChild(o$W),o$r++)}this.initItems()},o$T.addItem=function(o$o){o$o.name="item"+this._items.length,this.addChild(o$o),this.initItems()},o$T.initItems=function(){this._items=[];for(var o$o=0;o$o<1e4;o$o++){var o$r=this.getChildByName("item"+o$o);if(null==o$r)break;this._items.push(o$r),o$r.visible=o$o==this._selectedIndex}},o$T.setSelect=function(o$o,o$r){this._items&&-1<o$o&&o$o<this._items.length&&(this._items[o$o].visible=o$r)},o$T.setIndex=function(o$o){this.selectedIndex=o$o},o$W(0,o$T,"dataSource",o$o.prototype._$get_dataSource,function(o$o){if("number"==typeof(this._dataSource=o$o)&&Math.floor(o$o)==o$o||"string"==typeof o$o)this.selectedIndex=parseInt(o$o);else for(var o$r in this._dataSource)this.hasOwnProperty(o$r)&&(this[o$r]=this._dataSource[o$r])}),o$W(0,o$T,"selectedIndex",function(){return this._selectedIndex},function(o$o){this._selectedIndex!=o$o&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=o$o,this.setSelect(this._selectedIndex,!0))}),o$W(0,o$T,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(o$o){this.selectedIndex=this._items.indexOf(o$o)}),o$W(0,o$T,"items",function(){return this._items}),o$W(0,o$T,"setIndexHandler",function(){return this._setIndexHandler},function(o$o){this._setIndexHandler=o$o}),o$r}(o$C),o$ro=function(o$o){function o$r(){o$r.__super.call(this)}return o$D(o$r,"laya.ui.VScrollBar",o$e),o$r}(),o$To=function(o$r){function o$T(o$o){this._bg=null,this._skin=null,o$T.__super.call(this),void 0===o$o&&(o$o=""),this.text=o$o,this.skin=this.skin}o$D(o$T,"laya.ui.TextInput",o$r);var o$o=o$T.prototype;return o$o.preinitialize=function(){this.mouseEnabled=!0},o$o.destroy=function(o$o){o$$.clearCache(this,this._skin),void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,o$o),this._bg&&this._bg.destroy(),this._bg=null},o$o.createChildren=function(){this.addChild(this._tf=new o$v),this._tf.padding=o$H.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},o$o._onFocus=function(){this.event("focus",this)},o$o._onBlur=function(){this.event("blur",this)},o$o._onInput=function(){this.event("input",this)},o$o._onEnter=function(){this.event("enter",this)},o$o.initialize=function(){this.width=128,this.height=22},o$o.select=function(){this._tf.select()},o$o.setSelection=function(o$o,o$r){this._tf.setSelection(o$o,o$r)},o$W(0,o$o,"text",o$r.prototype._$get_text,function(o$o){this._tf.text!=o$o&&(o$o+="",this._tf.text=o$o,this.event("change"))}),o$W(0,o$o,"bg",function(){return this._bg},function(o$o){this.graphics=this._bg=o$o}),o$W(0,o$o,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(o$o){this._tf.inputElementYAdjuster=o$o}),o$W(0,o$o,"multiline",function(){return this._tf.multiline},function(o$o){this._tf.multiline=o$o}),o$W(0,o$o,"skin",function(){return this._skin},function(o$o){this._skin!=o$o&&(o$$.clearCache(this,this._skin),this._skin=o$o,this._bg||(this.graphics=this._bg=new o$s),o$$.keepCache(this,this._skin),this._bg.source=o$$.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),o$W(0,o$o,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(o$o){this._bg||(this.graphics=this._bg=new o$s),this._bg.sizeGrid=o$R.fillArray(o$H.defaultSizeGrid,o$o,Number)}),o$W(0,o$o,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(o$o){this._tf.inputElementXAdjuster=o$o}),o$W(0,o$o,"width",o$r.prototype._$get_width,function(o$o){o$j.superSet(o$A,this,"width",o$o),this._bg&&(this._bg.width=o$o)}),o$W(0,o$o,"height",o$r.prototype._$get_height,function(o$o){o$j.superSet(o$A,this,"height",o$o),this._bg&&(this._bg.height=o$o)}),o$W(0,o$o,"editable",function(){return this._tf.editable},function(o$o){this._tf.editable=o$o}),o$W(0,o$o,"restrict",function(){return this._tf.restrict},function(o$o){this._tf.restrict=o$o}),o$W(0,o$o,"prompt",function(){return this._tf.prompt},function(o$o){this._tf.prompt=o$o}),o$W(0,o$o,"promptColor",function(){return this._tf.promptColor},function(o$o){this._tf.promptColor=o$o}),o$W(0,o$o,"maxChars",function(){return this._tf.maxChars},function(o$o){this._tf.maxChars=o$o}),o$W(0,o$o,"focus",function(){return this._tf.focus},function(o$o){this._tf.focus=o$o}),o$W(0,o$o,"type",function(){return this._tf.type},function(o$o){this._tf.type=o$o}),o$W(0,o$o,"asPassword",function(){return this._tf.asPassword},function(o$o){this._tf.asPassword=o$o}),o$T}(o$A),o$ko=function(o$o){function o$r(){o$r.__super.call(this)}return o$D(o$r,"laya.ui.VSlider",o$J),o$r}(),o$Wo=function(o$o){function o$k(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,o$k.__super.call(this)}o$D(o$k,"laya.ui.Dialog",o$o);var o$r=o$k.prototype;return o$r.initialize=function(){this.popupEffect=o$k.manager.popupEffectHandler,this.closeEffect=o$k.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},o$r._dealDragArea=function(){var o$o=this.getChildByName("drag");o$o&&(this.dragArea=o$o.x+","+o$o.y+","+o$o.width+","+o$o.height,o$o.removeSelf())},o$r._onClick=function(o$o){var o$r=o$o.target;if(o$r)switch(o$r.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(o$r.name)}},o$r.show=function(o$o,o$r){void 0===o$o&&(o$o=!1),void 0===o$r&&(o$r=!0),this._open(!1,o$o,o$r)},o$r.popup=function(o$o,o$r){void 0===o$o&&(o$o=!1),void 0===o$r&&(o$r=!0),this._open(!0,o$o,o$r)},o$r._open=function(o$o,o$r,o$T){o$k.manager.lock(!1),this.isModal=o$o,o$k.manager.open(this,o$r,o$T)},o$r.onOpened=function(){},o$r.close=function(o$o,o$r){void 0===o$r&&(o$r=!0),o$k.manager.close(this,o$o,o$r)},o$r.onClosed=function(o$o){},o$r._onMouseDown=function(o$o){var o$r=this.getMousePoint();this._dragArea.contains(o$r.x,o$r.y)?this.startDrag():this.stopDrag()},o$W(0,o$r,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(o$o){if(o$o){var o$r=o$R.fillArray([0,0,0,0],o$o,Number);this._dragArea=new o$K(o$r[0],o$r[1],o$r[2],o$r[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),o$W(0,o$r,"isPopup",function(){return null!=this.parent}),o$W(0,o$r,"zOrder",o$o.prototype._$get_zOrder,function(o$o){o$j.superSet(o$N,this,"zOrder",o$o),o$k.manager._checkMask()}),o$W(1,o$k,"manager",function(){return o$k._manager=o$k._manager||new o$m},function(o$o){o$k._manager=o$o}),o$k.setLockView=function(o$o){o$k.manager.setLockView(o$o)},o$k.lock=function(o$o){o$k.manager.lock(o$o)},o$k.closeAll=function(){o$k.manager.closeAll()},o$k.getDialogsByGroup=function(o$o){return o$k.manager.getDialogsByGroup(o$o)},o$k.closeByGroup=function(o$o){return o$k.manager.closeByGroup(o$o)},o$k.CLOSE="close",o$k.CANCEL="cancel",o$k.SURE="sure",o$k.NO="no",o$k.OK="ok",o$k.YES="yes",o$k._manager=null,o$k}(o$N),o$Do=function(o$o){function o$r(){o$r.__super.call(this)}o$D(o$r,"laya.ui.HBox",o$o);var o$T=o$r.prototype;return o$T.sortItem=function(o$o){o$o&&o$o.sort(function(o$o,o$r){return o$o.x-o$r.x})},o$T.changeItems=function(){this._itemChanged=!1;for(var o$o=[],o$r=0,o$T=0,o$k=this.numChildren;o$T<o$k;o$T++){var o$W=this.getChildAt(o$T);o$W&&o$W.layoutEnabled&&(o$o.push(o$W),o$r=this._height?this._height:Math.max(o$r,o$W.height*o$W.scaleY))}this.sortItem(o$o);var o$D=0;for(o$T=0,o$k=o$o.length;o$T<o$k;o$T++)(o$W=o$o[o$T]).x=o$D,o$D+=o$W.width*o$W.scaleX+this._space,"top"==this._align?o$W.y=0:"middle"==this._align?o$W.y=.5*(o$r-o$W.height*o$W.scaleY):"bottom"==this._align&&(o$W.y=o$r-o$W.height*o$W.scaleY);this.changeSize()},o$W(0,o$T,"height",o$o.prototype._$get_height,function(o$o){this._height!=o$o&&(o$j.superSet(o$a,this,"height",o$o),this.callLater(this.changeItems))}),o$r.NONE="none",o$r.TOP="top",o$r.MIDDLE="middle",o$r.BOTTOM="bottom",o$r}(o$a),o$no=function(o$o){function o$r(){o$r.__super.call(this)}o$D(o$r,"laya.ui.VBox",o$o);var o$T=o$r.prototype;return o$T.changeItems=function(){this._itemChanged=!1;for(var o$o=[],o$r=0,o$T=0,o$k=this.numChildren;o$T<o$k;o$T++){var o$W=this.getChildAt(o$T);o$W&&o$W.layoutEnabled&&(o$o.push(o$W),o$r=this._width?this._width:Math.max(o$r,o$W.width*o$W.scaleX))}this.sortItem(o$o);var o$D=0;for(o$T=0,o$k=o$o.length;o$T<o$k;o$T++)(o$W=o$o[o$T]).y=o$D,o$D+=o$W.height*o$W.scaleY+this._space,"left"==this._align?o$W.x=0:"center"==this._align?o$W.x=.5*(o$r-o$W.width*o$W.scaleX):"right"==this._align&&(o$W.x=o$r-o$W.width*o$W.scaleX);this.changeSize()},o$W(0,o$T,"width",o$o.prototype._$get_width,function(o$o){this._width!=o$o&&(o$j.superSet(o$a,this,"width",o$o),this.callLater(this.changeItems))}),o$r.NONE="none",o$r.LEFT="left",o$r.CENTER="center",o$r.RIGHT="right",o$r}(o$a),o$Vo=function(o$o){function o$r(){o$r.__super.call(this)}return o$D(o$r,"laya.ui.RadioGroup",o$B),o$r.prototype.createItem=function(o$o,o$r){return new o$E(o$o,o$r)},o$r}(),o$Lo=function(o$o){function o$r(){o$r.__super.call(this)}return o$D(o$r,"laya.ui.Tab",o$B),o$r.prototype.createItem=function(o$o,o$r){return new o$X(o$o,o$r)},o$r}(),o$Uo=function(o$r){function o$T(o$o){this._vScrollBar=null,this._hScrollBar=null,void 0===o$o&&(o$o=""),o$T.__super.call(this,o$o)}o$D(o$T,"laya.ui.TextArea",o$r);var o$o=o$T.prototype;return o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,o$o),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},o$o.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},o$o.onVBarChanged=function(o$o){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},o$o.onHBarChanged=function(o$o){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},o$o.changeScroll=function(){var o$o=this._vScrollBar&&0<this._tf.maxScrollY,o$r=this._hScrollBar&&0<this._tf.maxScrollX,o$T=o$o?this._width-this._vScrollBar.width:this._width,o$k=o$r?this._height-this._hScrollBar.height:this._height,o$W=this._tf.padding||o$H.labelPadding;this._tf.width=o$T,this._tf.height=o$k,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-o$W[2],this._vScrollBar.y=o$W[1],this._vScrollBar.height=this._height-(o$r?this._hScrollBar.height:0)-o$W[1]-o$W[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=o$k/Math.max(this._tf.textHeight,o$k),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=o$o),this._hScrollBar&&(this._hScrollBar.x=o$W[0],this._hScrollBar.y=this._height-this._hScrollBar.height-o$W[3],this._hScrollBar.width=this._width-(o$o?this._vScrollBar.width:0)-o$W[0]-o$W[2],this._hScrollBar.scrollSize=Math.max(.033*o$T,1),this._hScrollBar.thumbPercent=o$T/Math.max(this._tf.textWidth,o$T),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=o$r)},o$o.scrollTo=function(o$o){this.commitMeasure(),this._tf.scrollY=o$o},o$W(0,o$o,"scrollY",function(){return this._tf.scrollY}),o$W(0,o$o,"width",o$r.prototype._$get_width,function(o$o){o$j.superSet(o$To,this,"width",o$o),this.callLater(this.changeScroll)}),o$W(0,o$o,"hScrollBar",function(){return this._hScrollBar}),o$W(0,o$o,"height",o$r.prototype._$get_height,function(o$o){o$j.superSet(o$To,this,"height",o$o),this.callLater(this.changeScroll)}),o$W(0,o$o,"maxScrollX",function(){return this._tf.maxScrollX}),o$W(0,o$o,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(o$o){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new o$ro),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=o$o}),o$W(0,o$o,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(o$o){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new o$Z),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=o$o}),o$W(0,o$o,"vScrollBar",function(){return this._vScrollBar}),o$W(0,o$o,"maxScrollY",function(){return this._tf.maxScrollY}),o$W(0,o$o,"scrollX",function(){return this._tf.scrollX}),o$T}(o$To);!function(o$o){function o$r(){this._uiView=null,this.isCloseOther=!1,o$r.__super.call(this)}o$D(o$r,"laya.ui.AsynDialog",o$Wo);var o$T=o$r.prototype;o$T.createView=function(o$o){this._uiView=o$o},o$T._open=function(o$o,o$r,o$T){this.isModal=o$o,this.isCloseOther=o$r,o$Wo.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},o$T.onCreated=function(){this.createUI(),this.onOpen()},o$T.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},o$T.onOpen=function(){o$Wo.manager.open(this,this.isCloseOther),o$Wo.manager.lock(!1)},o$T.close=function(o$o,o$r){void 0===o$r&&(o$r=!0),o$Wo.manager.close(this),this.onClose()},o$T.onClose=function(){},o$T.destroy=function(o$o){void 0===o$o&&(o$o=!0),laya.ui.View.prototype.destroy.call(this,o$o),this._uiView=null,this.onDestroy()},o$T.onDestroy=function(){}}();o$j.__init([o$N])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(o$o,o$r){"use strict";for(var o$T in Object.defineProperty(o$r,"__esModule",{value:!0}),Laya){var o$k=Laya[o$T];o$k&&o$k.__isclass&&(o$r[o$T]=o$k)}}),function(o$i,o$o,o$S){o$S.un,o$S.uns;var o$p=o$S.static,o$v=o$S.class,o$x=o$S.getset,o$k=o$S.__newvec,o$l=laya.maths.Arith,o$n=laya.webgl.atlas.AtlasResourceManager,o$T=laya.webgl.shader.BaseShader,o$z=laya.utils.Browser,o$V=laya.webgl.utils.Buffer,o$q=laya.utils.Byte,o$W=laya.utils.ClassUtils,o$L=o$S.Config,o$D=(laya.events.Event,laya.events.EventDispatcher),o$H=laya.utils.Handler,o$K=laya.net.Loader,o$r=laya.net.LoaderManager,o$U=(laya.maths.MathUtil,laya.display.Node),o$j=laya.renders.Render,o$h=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),o$_=laya.resource.Resource,o$$=laya.utils.RunDriver,o$y=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),o$b=laya.display.Sprite,o$F=laya.utils.Stat,o$P=laya.utils.StringKey,o$R=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),o$t=laya.utils.Utils,o$u=laya.webgl.WebGL,o$s=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;o$S.interface("laya.d3.core.IClone"),o$S.interface("laya.d3.graphics.IVertex"),o$S.interface("laya.d3.core.render.IUpdate"),o$S.interface("laya.d3.core.scene.ITreeNode"),o$S.interface("laya.d3.core.render.IRenderable");(function(){function o$X(){}o$v(o$X,"laya.d3.animation.AnimationClipParser01"),o$X.READ_DATA=function(){o$X._DATA.offset=o$X._reader.getUint32(),o$X._DATA.size=o$X._reader.getUint32()},o$X.READ_BLOCK=function(){for(var o$o=o$X._BLOCK.count=o$X._reader.getUint16(),o$r=o$X._BLOCK.blockStarts=[],o$T=o$X._BLOCK.blockLengths=[],o$k=0;o$k<o$o;o$k++)o$r.push(o$X._reader.getUint32()),o$T.push(o$X._reader.getUint32())},o$X.READ_STRINGS=function(){var o$o=o$X._reader.getUint32(),o$r=o$X._reader.getUint16(),o$T=o$X._reader.pos;o$X._reader.pos=o$o+o$X._DATA.offset;for(var o$k=0;o$k<o$r;o$k++)o$X._strings[o$k]=o$X._reader.readUTFString();o$X._reader.pos=o$T},o$X.parse=function(o$o,o$r){o$X._animationClip=o$o;(o$X._reader=o$r).__getBuffer();o$X.READ_DATA(),o$X.READ_BLOCK(),o$X.READ_STRINGS();for(var o$T=0,o$k=o$X._BLOCK.count;o$T<o$k;o$T++){var o$W=o$r.getUint16(),o$D=o$X._strings[o$W],o$n=o$X["READ_"+o$D];if(null==o$n)throw new Error("model file err,no this function:"+o$W+" "+o$D);o$n.call()}},o$X.READ_ANIMATIONS=function(){var o$o,o$r=0,o$T=0,o$k=o$X._reader,o$W=o$k.__getBuffer(),o$D=[],o$n=o$k.getUint8();for(o$D.length=o$n,o$r=0;o$r<o$n;o$r++)o$D[o$r]=o$k.getUint16();var o$V=[],o$L=o$k.getUint16();for(o$V.length=o$L,o$r=0;o$r<o$L;o$r++)o$V[o$r]=o$k.getFloat32();var o$U=o$X._animationClip;o$U.name=o$X._strings[o$k.getUint16()];var o$h=o$U._duration=o$k.getFloat32();o$U.islooping=!!o$k.getByte(),o$U._frameRate=o$k.getInt16();var o$p=o$k.getInt16(),o$i=o$U._nodes=new Array;o$i.length=o$p,(o$U._publicClipDatas=[]).length=o$p;var o$v=o$U._nodesMap={},o$x=0,o$j=0;for(o$r=0;o$r<o$p;o$r++){o$o=o$i[o$r]=new o$I;var o$_=o$k.getUint16(),o$K=o$o.path=[];for(o$K.length=o$_,o$T=0;o$T<o$_;o$T++)o$K[o$T]=o$X._strings[o$k.getUint16()];var o$$=o$K.join("/"),o$y=o$v[o$$];o$y||(o$v[o$$]=o$y=[]),o$y.push(o$o);var o$l=o$k.getInt16();-1!==o$l&&(o$o.componentType=o$X._strings[o$l]);var o$S=o$Y._propertyIndexDic[o$X._strings[o$k.getUint16()]];if(null==o$S)throw new Error("AnimationClipParser01:unknown property name.");var o$q=o$S<4,o$b=!o$q||o$q&&""===o$K[0];(o$o._cacheProperty=o$b)?o$x++:o$j++,o$o.propertyNameID=o$S;var o$F=o$D[o$k.getUint8()];o$o.keyFrameWidth=o$F/4;var o$P=o$o.keyFrames=[],o$t=o$P.length=o$k.getUint16(),o$H=null,o$R=NaN;for(o$T=0;o$T<o$t;o$T++){var o$u=o$P[o$T]=new o$A;o$R=o$u.startTime=o$V[o$k.getUint16()];var o$s=o$k.pos;o$u.inTangent=new Float32Array(o$W.slice(o$s,o$s+o$F)),o$k.pos+=o$F,o$s=o$k.pos,o$u.outTangent=new Float32Array(o$W.slice(o$s,o$s+o$F)),o$k.pos+=o$F,o$s=o$k.pos,o$u.data=new Float32Array(o$W.slice(o$s,o$s+o$F)),o$k.pos+=o$F,o$H&&(o$H.next=o$u,o$H.duration=o$R-o$H.startTime),o$H=o$u}o$u.next=null,o$u.duration=o$h-o$R}var o$z=o$U._nodeToCachePropertyMap=new Int32Array(o$p),o$m=o$U._cachePropertyMap=new Int32Array(o$x),o$C=o$U._unCachePropertyMap=new Int32Array(o$j);for(o$x=o$j=0,o$r=0;o$r<o$p;o$r++)(o$o=o$i[o$r])._cacheProperty?(o$z[o$r]=o$x,o$m[o$x++]=o$r):o$C[o$j++]=o$r},o$X._animationClip=null,o$X._reader=null,o$X._strings=[],o$p(o$X,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function o$e(){}o$v(o$e,"laya.d3.animation.AnimationClipParser02"),o$e.READ_DATA=function(){o$e._DATA.offset=o$e._reader.getUint32(),o$e._DATA.size=o$e._reader.getUint32()},o$e.READ_BLOCK=function(){for(var o$o=o$e._BLOCK.count=o$e._reader.getUint16(),o$r=o$e._BLOCK.blockStarts=[],o$T=o$e._BLOCK.blockLengths=[],o$k=0;o$k<o$o;o$k++)o$r.push(o$e._reader.getUint32()),o$T.push(o$e._reader.getUint32())},o$e.READ_STRINGS=function(){var o$o=o$e._reader.getUint32(),o$r=o$e._reader.getUint16(),o$T=o$e._reader.pos;o$e._reader.pos=o$o+o$e._DATA.offset;for(var o$k=0;o$k<o$r;o$k++)o$e._strings[o$k]=o$e._reader.readUTFString();o$e._reader.pos=o$T},o$e.parse=function(o$o,o$r){o$e._animationClip=o$o;(o$e._reader=o$r).__getBuffer();o$e.READ_DATA(),o$e.READ_BLOCK(),o$e.READ_STRINGS();for(var o$T=0,o$k=o$e._BLOCK.count;o$T<o$k;o$T++){var o$W=o$r.getUint16(),o$D=o$e._strings[o$W],o$n=o$e["READ_"+o$D];if(null==o$n)throw new Error("model file err,no this function:"+o$W+" "+o$D);o$n.call()}},o$e.READ_ANIMATIONS=function(){var o$o,o$r=0,o$T=0,o$k=o$e._reader,o$W=o$k.__getBuffer(),o$D=[],o$n=o$k.getUint8();for(o$D.length=o$n,o$r=0;o$r<o$n;o$r++)o$D[o$r]=o$k.getUint16();var o$V=[],o$L=o$k.getUint16();for(o$V.length=o$L,o$r=0;o$r<o$L;o$r++)o$V[o$r]=o$k.getFloat32();var o$U=o$e._animationClip;o$U.name=o$e._strings[o$k.getUint16()];var o$h=o$U._duration=o$k.getFloat32();o$U.islooping=!!o$k.getByte(),o$U._frameRate=o$k.getInt16();var o$p=o$k.getInt16(),o$i=o$U._nodes=new Array;o$i.length=o$p,(o$U._publicClipDatas=[]).length=o$p;var o$v=o$U._nodesMap={},o$x=0,o$j=0;for(o$r=0;o$r<o$p;o$r++){o$o=o$i[o$r]=new o$I;var o$_=o$k.getUint16(),o$K=o$o.path=[];for(o$K.length=o$_,o$T=0;o$T<o$_;o$T++)o$K[o$T]=o$e._strings[o$k.getUint16()];var o$$=o$K.join("/"),o$y=o$v[o$$];o$y||(o$v[o$$]=o$y=[]),o$y.push(o$o);var o$l=o$k.getInt16();-1!==o$l&&(o$o.componentType=o$e._strings[o$l]);var o$S=o$Y._propertyIndexDic[o$e._strings[o$k.getUint16()]];if(null==o$S)throw new Error("AnimationClipParser02:unknown property name.");var o$q=o$S<4,o$b=!o$q||o$q&&""===o$K[0];(o$o._cacheProperty=o$b)?o$x++:o$j++,o$o.propertyNameID=o$S;var o$F=o$D[o$k.getUint8()];o$o.keyFrameWidth=o$F/4;var o$P=o$o.keyFrames=[],o$t=o$P.length=o$k.getUint16(),o$H=null,o$R=NaN;for(o$T=0;o$T<o$t;o$T++){var o$u=o$P[o$T]=new o$A;o$R=o$u.startTime=o$V[o$k.getUint16()];var o$s=o$k.pos;o$u.inTangent=new Float32Array(o$W.slice(o$s,o$s+o$F)),o$k.pos+=o$F,o$s=o$k.pos,o$u.outTangent=new Float32Array(o$W.slice(o$s,o$s+o$F)),o$k.pos+=o$F,o$s=o$k.pos,o$u.data=new Float32Array(o$W.slice(o$s,o$s+o$F)),o$k.pos+=o$F,o$H&&(o$H.next=o$u,o$H.duration=o$R-o$H.startTime),o$H=o$u}o$u.next=null,o$u.duration=o$h-o$R}var o$z=o$k.getUint16();for(o$r=0;o$r<o$z;o$r++){var o$m,o$C=new o$J;o$C.time=o$k.getFloat32(),o$C.eventName=o$e._strings[o$k.getUint16()];var o$X=o$k.getUint16();for(0<o$X&&(o$C.params=o$m=[]),o$T=0;o$T<o$X;o$T++){switch(o$k.getByte()){case 0:o$m.push(!!o$k.getByte());break;case 1:o$m.push(o$k.getInt32());break;case 2:o$m.push(o$k.getFloat32());break;case 3:o$m.push(o$e._strings[o$k.getUint16()]);break;default:throw new Error("unknown type.")}}o$U.addEvent(o$C)}var o$O=o$U._nodeToCachePropertyMap=new Int32Array(o$p),o$M=o$U._cachePropertyMap=new Int32Array(o$x),o$c=o$U._unCachePropertyMap=new Int32Array(o$j);for(o$x=o$j=0,o$r=0;o$r<o$p;o$r++)(o$o=o$i[o$r])._cacheProperty?(o$O[o$r]=o$x,o$M[o$x++]=o$r):o$c[o$j++]=o$r},o$e._animationClip=null,o$e._reader=null,o$e._strings=[],o$p(o$e,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var o$J=function(){function o$o(){this.time=NaN,this.eventName=null,this.params=null}return o$v(o$o,"laya.d3.animation.AnimationEvent"),o$o}(),o$Y=function(){function o$k(){this._childs=[],this.transform=new o$$r(this)}o$v(o$k,"laya.d3.animation.AnimationNode");var o$o=o$k.prototype;return o$S.imps(o$o,{"laya.d3.core.IClone":!0}),o$o.addChild=function(o$o){o$o._parent=this,o$o.transform.setParent(this.transform),this._childs.push(o$o)},o$o.removeChild=function(o$o){var o$r=this._childs.indexOf(o$o);-1!==o$r&&this._childs.splice(o$r,1)},o$o.getChildByName=function(o$o){for(var o$r=0,o$T=this._childs.length;o$r<o$T;o$r++){var o$k=this._childs[o$r];if(o$k.name===o$o)return o$k}return null},o$o.getChildByIndex=function(o$o){return this._childs[o$o]},o$o.getChildCount=function(){return this._childs.length},o$o.cloneTo=function(o$o){var o$r=o$o;o$r.name=this.name;for(var o$T=0,o$k=this._childs.length;o$T<o$k;o$T++){var o$W=this._childs[o$T],o$D=o$W.clone();o$r.addChild(o$D);var o$n=o$W.transform,o$V=o$D.transform;o$V.setLocalPosition(o$n.getLocalPosition()),o$V.setLocalRotation(o$n.getLocalRotation()),o$V.setLocalScale(o$n.getLocalScale()),o$V._localRotationEuler=o$n._localRotationEuler,o$V._setWorldMatrixIgnoreUpdate(o$n.getWorldMatrix())}},o$o.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$k.__init__=function(){o$k.registerAnimationNodeProperty("localPosition",o$k._getLocalPosition,o$k._setLocalPosition),o$k.registerAnimationNodeProperty("localRotation",o$k._getLocalRotation,o$k._setLocalRotation),o$k.registerAnimationNodeProperty("localScale",o$k._getLocalScale,o$k._setLocalScale),o$k.registerAnimationNodeProperty("localRotationEuler",o$k._getLocalRotationEuler,o$k._setLocalRotationEuler),o$k.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",o$k._getParticleRenderSharedMaterialTintColor,o$k._setParticleRenderSharedMaterialTintColor),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",o$k._getMeshRenderSharedMaterialTilingOffset,o$k._setMeshRenderSharedMaterialTilingOffset),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",o$k._getMeshRenderSharedMaterialAlbedo,o$k._setMeshRenderSharedMaterialAlbedo),o$k.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",o$k._getSkinnedMeshRenderSharedMaterialTilingOffset,o$k._setSkinnedMeshRenderSharedMaterialTilingOffset),o$k.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",o$k._getSkinnedMeshRenderSharedMaterialAlbedo,o$k._setSkinnedMeshRenderSharedMaterialAlbedo),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",o$k._getMeshRenderSharedMaterialAlbedo,o$k._setMeshRenderSharedMaterialAlbedo),o$k.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",o$k._getSkinnedMeshRenderSharedMaterialAlbedo,o$k._setSkinnedMeshRenderSharedMaterialAlbedo),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",o$k._getMeshRenderSharedMaterialIntensity,o$k._setMeshRenderSharedMaterialIntensity),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",o$k._getMeshRenderSharedMaterialAlpha,o$k._setMeshRenderSharedMaterialAlpha),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",o$k._getMeshRenderSharedMaterialAlphaColor,o$k._setMeshRenderSharedMaterialAlphaColor),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",o$k._getMeshRenderSharedMaterialBaseColor,o$k._setMeshRenderSharedMaterialBaseColor),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",o$k._getMeshRenderSharedMaterialDissolve,o$k._setMeshRenderSharedMaterialDissolve),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",o$k._getMeshRenderSharedMaterialDissolveSpeed,o$k._setMeshRenderSharedMaterialDissolveSpeed),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",o$k._getMeshRenderSharedMaterialMMultiplier,o$k._setMeshRenderSharedMaterialMMultiplier),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",o$k._getMeshRenderSharedMaterialBaseScrollSpeedX,o$k._setMeshRenderSharedMaterialBaseScrollSpeedX),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",o$k._getMeshRenderSharedMaterialBaseScrollSpeedY,o$k._setMeshRenderSharedMaterialBaseScrollSpeedY),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",o$k._getMeshRenderSharedMaterialSecondScrollSpeedX,o$k._setMeshRenderSharedMaterialSecondScrollSpeedX),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",o$k._getMeshRenderSharedMaterialSecondScrollSpeedY,o$k._setMeshRenderSharedMaterialSecondScrollSpeedY),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",o$k._getMeshRenderSharedMaterialDetailTilingOffset,o$k._setMeshRenderSharedMaterialDetailTilingOffset),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",o$k._getMeshRenderSharedMaterialDissolveTilingOffset,o$k._setMeshRenderSharedMaterialDissolveTilingOffset),o$k.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",o$k._getMeshRenderSharedMaterialMaskTilingOffset,o$k._setMeshRenderSharedMaterialMaskTilingOffset)},o$k.registerAnimationNodeProperty=function(o$o,o$r,o$T){if(o$k._propertyIndexDic[o$o])throw new Error("AnimationNode: this propertyName has registered.");o$k._propertyIndexDic[o$o]=o$k._propertyIDCounter,o$k._propertyGetFuncs[o$k._propertyIDCounter]=o$r,o$k._propertySetFuncs[o$k._propertyIDCounter]=o$T,o$k._propertyIDCounter++},o$k._getLocalPosition=function(o$o,o$r){return o$o?o$o.transform.getLocalPosition():o$r._transform.localPosition.elements},o$k._setLocalPosition=function(o$o,o$r,o$T){if(o$o)o$o.transform.setLocalPosition(o$T);else{var o$k=o$r._transform,o$W=o$k.localPosition;o$W.elements=o$T,o$k.localPosition=o$W}},o$k._getLocalRotation=function(o$o,o$r){return o$o?o$o.transform.getLocalRotation():o$r._transform.localRotation.elements},o$k._setLocalRotation=function(o$o,o$r,o$T){if(o$o)o$o.transform.setLocalRotation(o$T);else{var o$k=o$r._transform,o$W=o$k.localRotation;o$W.elements=o$T,o$k.localRotation=o$W}},o$k._getLocalScale=function(o$o,o$r){return o$o?o$o.transform.getLocalScale():o$r._transform.localScale.elements},o$k._setLocalScale=function(o$o,o$r,o$T){if(o$o)o$o.transform.setLocalScale(o$T);else{var o$k=o$r._transform,o$W=o$k.localScale;o$W.elements=o$T,o$k.localScale=o$W}},o$k._getLocalRotationEuler=function(o$o,o$r){return o$o?o$o.transform.getLocalRotationEuler():o$r._transform.localRotationEuler.elements},o$k._setLocalRotationEuler=function(o$o,o$r,o$T){if(o$o)o$o.transform.setLocalRotationEuler(o$T);else{var o$k=o$r._transform,o$W=o$k.localRotationEuler;o$W.elements=o$T,o$k.localRotationEuler=o$W}},o$k._getMeshRenderSharedMaterialTilingOffset=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return o$r.meshRender.sharedMaterial.tilingOffset.elements},o$k._setMeshRenderSharedMaterialTilingOffset=function(o$o,o$r,o$T){var o$k,o$W;if(o$o){var o$D=o$o.transform._entity;o$D&&((o$W=(o$k=o$D.owner.meshRender.material).tilingOffset).elements=o$T,o$k.tilingOffset=o$W)}else(o$W=(o$k=o$r.meshRender.material).tilingOffset).elements=o$T,o$k.tilingOffset=o$W},o$k._getMeshRenderSharedMaterialAlbedo=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.albedoColor.elements:null}return o$r.meshRender.sharedMaterial.albedoColor.elements},o$k._setMeshRenderSharedMaterialAlbedo=function(o$o,o$r,o$T){var o$k,o$W;if(o$o){var o$D=o$o.transform._entity;o$D&&((o$W=(o$k=o$D.owner.meshRender.material).albedoColor).elements=o$T,o$k.albedoColor=o$W)}else(o$W=(o$k=o$r.meshRender.material).albedoColor).elements=o$T,o$k.albedoColor=o$W},o$k._getSkinnedMeshRenderSharedMaterialTilingOffset=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return o$r.skinnedMeshRender.sharedMaterial.tilingOffset.elements},o$k._setSkinnedMeshRenderSharedMaterialTilingOffset=function(o$o,o$r,o$T){var o$k,o$W;if(o$o){var o$D=o$o.transform._entity;o$D&&((o$W=(o$k=o$D.owner.skinnedMeshRender.material).tilingOffset).elements=o$T,o$k.tilingOffset=o$W)}else(o$W=(o$k=o$r.skinnedMeshRender.material).tilingOffset).elements=o$T,o$k.tilingOffset=o$W},o$k._getSkinnedMeshRenderSharedMaterialAlbedo=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return o$r.skinnedMeshRender.sharedMaterial.albedoColor.elements},o$k._setSkinnedMeshRenderSharedMaterialAlbedo=function(o$o,o$r,o$T){var o$k,o$W;if(o$o){var o$D=o$o.transform._entity;o$D&&((o$W=(o$k=o$D.owner.skinnedMeshRender.material).albedoColor).elements=o$T,o$k.albedoColor=o$W)}else(o$W=(o$k=o$r.skinnedMeshRender.material).albedoColor).elements=o$T,o$k.albedoColor=o$W},o$k._getParticleRenderSharedMaterialTintColor=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.particleRender.sharedMaterial.tintColor.elements:null}return o$r.particleRender.sharedMaterial.tintColor.elements},o$k._setParticleRenderSharedMaterialTintColor=function(o$o,o$r,o$T){var o$k,o$W;if(o$o){var o$D=o$o.transform._entity;o$D&&((o$W=(o$k=o$D.owner.particleRender.material).tintColor).elements=o$T,o$k.tintColor=o$W)}else(o$W=(o$k=o$r.particleRender.material).tintColor).elements=o$T,o$k.tintColor=o$W},o$k._getMeshRenderSharedMaterialAlphaColor=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.alphaColor.elements:null}return o$r.meshRender.sharedMaterial.alphaColor.elements},o$k._setMeshRenderSharedMaterialAlphaColor=function(o$o,o$r,o$T){var o$k,o$W;if(o$o){var o$D=o$o.transform._entity;o$D&&((o$W=(o$k=o$D.owner.meshRender.material).alphaColor).elements=o$T,o$k.alphaColor=o$W)}else(o$W=(o$k=o$r.meshRender.material).alphaColor).elements=o$T,o$k.alphaColor=o$W},o$k._getMeshRenderSharedMaterialBaseColor=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.baseColor.elements:null}return o$r.meshRender.sharedMaterial.baseColor.elements},o$k._setMeshRenderSharedMaterialBaseColor=function(o$o,o$r,o$T){var o$k,o$W;if(o$o){var o$D=o$o.transform._entity;o$D&&((o$W=(o$k=o$D.owner.meshRender.material).baseColor).elements=o$T,o$k.baseColor=o$W)}else(o$W=(o$k=o$r.meshRender.material).baseColor).elements=o$T,o$k.baseColor=o$W},o$k._getMeshRenderSharedMaterialDissolve=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.dissolve:0}return o$r.meshRender.sharedMaterial.dissolve},o$k._setMeshRenderSharedMaterialDissolve=function(o$o,o$r,o$T){if(o$o){var o$k=o$o.transform._entity;o$k&&(o$k.owner.meshRender.material.dissolve=o$T[0])}else o$r.meshRender.material.dissolve=o$T[0]},o$k._getMeshRenderSharedMaterialDissolveSpeed=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.dissolveSpeed:0}return o$r.meshRender.sharedMaterial.dissolveSpeed},o$k._setMeshRenderSharedMaterialDissolveSpeed=function(o$o,o$r,o$T){if(o$o){var o$k=o$o.transform._entity;o$k&&(o$k.owner.meshRender.material.dissolveSpeed=o$T[0])}else o$r.meshRender.material.dissolveSpeed=o$T[0]},o$k._getMeshRenderSharedMaterialMMultiplier=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.mMultiplier:0}return o$r.meshRender.sharedMaterial.mMultiplier},o$k._setMeshRenderSharedMaterialMMultiplier=function(o$o,o$r,o$T){if(o$o){var o$k=o$o.transform._entity;o$k&&(o$k.owner.meshRender.material.mMultiplier=o$T[0])}else o$r.meshRender.material.mMultiplier=o$T[0]},o$k._getMeshRenderSharedMaterialBaseScrollSpeedX=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return o$r.meshRender.sharedMaterial.baseScrollSpeedX},o$k._setMeshRenderSharedMaterialBaseScrollSpeedX=function(o$o,o$r,o$T){if(o$o){var o$k=o$o.transform._entity;o$k&&(o$k.owner.meshRender.material.baseScrollSpeedX=o$T[0])}else o$r.meshRender.material.baseScrollSpeedX=o$T[0]},o$k._getMeshRenderSharedMaterialBaseScrollSpeedY=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return o$r.meshRender.sharedMaterial.baseScrollSpeedY},o$k._setMeshRenderSharedMaterialBaseScrollSpeedY=function(o$o,o$r,o$T){if(o$o){var o$k=o$o.transform._entity;o$k&&(o$k.owner.meshRender.material.baseScrollSpeedY=o$T[0])}else o$r.meshRender.material.baseScrollSpeedY=o$T[0]},o$k._getMeshRenderSharedMaterialSecondScrollSpeedX=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return o$r.meshRender.sharedMaterial.secondScrollSpeedX},o$k._setMeshRenderSharedMaterialSecondScrollSpeedX=function(o$o,o$r,o$T){if(o$o){var o$k=o$o.transform._entity;o$k&&(o$k.owner.meshRender.material.secondScrollSpeedX=o$T[0])}else o$r.meshRender.material.secondScrollSpeedX=o$T[0]},o$k._getMeshRenderSharedMaterialSecondScrollSpeedY=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return o$r.meshRender.sharedMaterial.secondScrollSpeedY},o$k._setMeshRenderSharedMaterialSecondScrollSpeedY=function(o$o,o$r,o$T){if(o$o){var o$k=o$o.transform._entity;o$k&&(o$k.owner.meshRender.material.secondScrollSpeedY=o$T[0])}else o$r.meshRender.material.secondScrollSpeedY=o$T[0]},o$k._getMeshRenderSharedMaterialAlpha=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.alpha:0}return o$r.meshRender.sharedMaterial.alpha},o$k._setMeshRenderSharedMaterialAlpha=function(o$o,o$r,o$T){if(o$o){var o$k=o$o.transform._entity;o$k&&(o$k.owner.meshRender.material.alpha=o$T[0])}else o$r.meshRender.material.alpha=o$T[0]},o$k._getMeshRenderSharedMaterialIntensity=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.intensity:0}return o$r.meshRender.sharedMaterial.intensity},o$k._setMeshRenderSharedMaterialIntensity=function(o$o,o$r,o$T){if(o$o){var o$k=o$o.transform._entity;o$k&&(o$k.owner.meshRender.material.intensity=o$T[0])}else o$r.meshRender.material.intensity=o$T[0]},o$k._getMeshRenderSharedMaterialDetailTilingOffset=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return o$r.meshRender.sharedMaterial.detailTilingOffset.elements},o$k._setMeshRenderSharedMaterialDetailTilingOffset=function(o$o,o$r,o$T){var o$k,o$W;if(o$o){var o$D=o$o.transform._entity;o$D&&((o$W=(o$k=o$D.owner.meshRender.material).detailTilingOffset).elements=o$T,o$k.detailTilingOffset=o$W)}else(o$W=(o$k=o$r.meshRender.material).detailTilingOffset).elements=o$T,o$k.detailTilingOffset=o$W},o$k._getMeshRenderSharedMaterialDissolveTilingOffset=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return o$r.meshRender.sharedMaterial.dissolveTilingOffset.elements},o$k._setMeshRenderSharedMaterialDissolveTilingOffset=function(o$o,o$r,o$T){var o$k,o$W;if(o$o){var o$D=o$o.transform._entity;o$D&&((o$W=(o$k=o$D.owner.meshRender.material).dissolveTilingOffset).elements=o$T,o$k.dissolveTilingOffset=o$W)}else(o$W=(o$k=o$r.meshRender.material).dissolveTilingOffset).elements=o$T,o$k.dissolveTilingOffset=o$W},o$k._getMeshRenderSharedMaterialMaskTilingOffset=function(o$o,o$r){if(o$o){var o$T=o$o.transform._entity;return o$T?o$T.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return o$r.meshRender.sharedMaterial.maskTilingOffset.elements},o$k._setMeshRenderSharedMaterialMaskTilingOffset=function(o$o,o$r,o$T){var o$k,o$W;if(o$o){var o$D=o$o.transform._entity;o$D&&((o$W=(o$k=o$D.owner.meshRender.material).maskTilingOffset).elements=o$T,o$k.maskTilingOffset=o$W)}else(o$W=(o$k=o$r.meshRender.material).maskTilingOffset).elements=o$T,o$k.maskTilingOffset=o$W},o$k._propertyIDCounter=0,o$k._propertyIndexDic={},o$k._propertySetFuncs=[],o$k._propertyGetFuncs=[],o$k}(),o$A=function(){function o$o(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return o$v(o$o,"laya.d3.animation.Keyframe"),o$o}(),o$I=function(){function o$o(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return o$v(o$o,"laya.d3.animation.KeyframeNode"),o$o}(),o$m=(function(){function o$o(){this._tempVector30=new o$nr,this._tempVector31=new o$nr,this._tempVector32=new o$nr,this._a=new o$nr,this._b=new o$nr,this._c=new o$nr,this._d=new o$nr}o$v(o$o,"laya.d3.core.glitter.SplineCurvePositionVelocity");var o$r=o$o.prototype;o$r.Init=function(o$o,o$r,o$T,o$k){o$o.cloneTo(this._d),o$r.cloneTo(this._c),o$nr.scale(o$o,2,this._a),o$nr.scale(o$T,2,this._tempVector30),o$nr.subtract(this._a,this._tempVector30,this._a),o$nr.add(this._a,o$r,this._a),o$nr.add(this._a,o$k,this._a),o$nr.scale(o$T,3,this._b),o$nr.scale(o$o,3,this._tempVector30),o$nr.subtract(this._b,this._tempVector30,this._b),o$nr.subtract(this._b,o$k,this._b),o$nr.scale(o$r,2,this._tempVector30),o$nr.subtract(this._b,this._tempVector30,this._b)},o$r.Slerp=function(o$o,o$r){o$nr.scale(this._a,o$o*o$o*o$o,this._tempVector30),o$nr.scale(this._b,o$o*o$o,this._tempVector31),o$nr.scale(this._c,o$o,this._tempVector32),o$nr.add(this._tempVector30,this._tempVector31,o$r),o$nr.add(o$r,this._tempVector32,o$r),o$nr.add(o$r,this._d,o$r)}}(),function(){function o$M(o$o,o$r,o$T,o$k){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=o$o,this._h=o$r,this._minHeight=o$T,this._maxHeight=o$k}o$v(o$M,"laya.d3.core.HeightMap");var o$o=o$M.prototype;o$o._inBounds=function(o$o,o$r){return 0<=o$o&&o$o<this._h&&0<=o$r&&o$r<this._w},o$o.getHeight=function(o$o,o$r){return this._inBounds(o$o,o$r)?this._datas[o$o][o$r]:NaN},o$x(0,o$o,"width",function(){return this._w}),o$x(0,o$o,"height",function(){return this._h}),o$x(0,o$o,"maxHeight",function(){return this._maxHeight}),o$x(0,o$o,"minHeight",function(){return this._minHeight}),o$M.creatFromMesh=function(o$o,o$r,o$T,o$k){for(var o$W=[],o$D=[],o$n=o$o.getSubMeshCount(),o$V=0;o$V<o$n;o$V++){for(var o$L=o$o.getSubMesh(o$V),o$U=o$L._getVertexBuffer(),o$h=o$U.getData(),o$p=[],o$i=0;o$i<o$h.length;o$i+=o$U.vertexDeclaration.vertexStride/4){var o$v=new o$nr(o$h[o$i+0],o$h[o$i+1],o$h[o$i+2]);o$p.push(o$v)}o$W.push(o$p);var o$x=o$L._getIndexBuffer();o$D.push(o$x.getData())}var o$j=o$o.boundingBox,o$_=o$j.min.x,o$K=o$j.min.z,o$$=o$j.max.x,o$y=o$j.max.z,o$l=o$j.min.y,o$S=o$j.max.y,o$q=o$$-o$_,o$b=o$y-o$K,o$F=o$k.elements[0]=o$q/(o$r-1),o$P=o$k.elements[1]=o$b/(o$T-1),o$t=new o$M(o$r,o$T,o$l,o$S),o$H=o$M._tempRay,o$R=o$H.direction.elements;o$R[0]=0,o$R[1]=-1,o$R[2]=0;var o$u=o$S+.1;o$H.origin.elements[1]=o$u;for(var o$s=0;o$s<o$T;o$s++){var o$z=o$K+o$s*o$P;o$t._datas[o$s]=[];for(var o$m=0;o$m<o$r;o$m++){var o$C=o$_+o$m*o$F,o$X=o$H.origin.elements;o$X[0]=o$C,o$X[2]=o$z;var o$O=o$M._getPosition(o$H,o$W,o$D);o$t._datas[o$s][o$m]=o$O===Number.MAX_VALUE?NaN:o$u-o$O}}return o$t},o$M.createFromImage=function(o$o,o$r,o$T){for(var o$k=o$o.width,o$W=o$o.height,o$D=new o$M(o$k,o$W,o$r,o$T),o$n=(o$T-o$r)/254,o$V=o$o.getPixels(),o$L=0,o$U=0;o$U<o$W;o$U++)for(var o$h=o$D._datas[o$U]=[],o$p=0;o$p<o$k;o$p++){var o$i=o$V[o$L++],o$v=o$V[o$L++],o$x=o$V[o$L++],o$j=o$V[o$L++];o$h[o$p]=255==o$i&&255==o$v&&255==o$x&&255==o$j?NaN:(o$i+o$v+o$x)/3*o$n+o$r}return o$D},o$M._getPosition=function(o$o,o$r,o$T){for(var o$k=Number.MAX_VALUE,o$W=0;o$W<o$r.length;o$W++)for(var o$D=o$r[o$W],o$n=o$T[o$W],o$V=0;o$V<o$n.length;o$V+=3){var o$L=o$D[o$n[o$V+0]],o$U=o$D[o$n[o$V+1]],o$h=o$D[o$n[o$V+2]],o$p=o$xr.rayIntersectsTriangle(o$o,o$L,o$U,o$h);!isNaN(o$p)&&o$p<o$k&&(o$k=o$p)}return o$k},o$p(o$M,["_tempRay",function(){return this._tempRay=new o$Wr(new o$nr,new o$nr)}])}(),function(){function o$W(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}o$v(o$W,"laya.d3.core.Layer");var o$o=o$W.prototype;return o$o._binarySearchIndex=function(){for(var o$o=0,o$r=o$W._collsionTestList.length-1,o$T=0;o$o<=o$r;){o$T=Math.floor((o$o+o$r)/2);var o$k=o$W._collsionTestList[o$T];if(o$k==this._number)return o$T;o$k>this._number?o$r=o$T-1:o$o=o$T+1}return o$o},o$o._addCollider=function(o$o){0===this._colliders.length&&o$W._collsionTestList.splice(this._binarySearchIndex(),0,this._number),o$o._isRigidbody?(this._colliders.unshift(o$o),this._nonRigidbodyOffset++):this._colliders.push(o$o)},o$o._removeCollider=function(o$o){var o$r=this._colliders.indexOf(o$o);o$r<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(o$r,1),0===this._colliders.length&&o$W._collsionTestList.splice(o$W._collsionTestList.indexOf(this._number),1)},o$x(0,o$o,"number",function(){return this._number}),o$x(0,o$o,"visible",function(){return this._visible},function(o$o){this._visible=o$o,o$W._visibleLayers=o$o?o$W._visibleLayers|this.mask:o$W._visibleLayers&~this.mask}),o$x(0,o$o,"mask",function(){return this._mask}),o$x(1,o$W,"visibleLayers",function(){return o$W._visibleLayers},function(o$o){o$W._visibleLayers=o$o;for(var o$r=0,o$T=o$W._layerList.length;o$r<o$T;o$r++){var o$k=o$W._layerList[o$r];o$k._visible=0!=(o$k._mask&o$W._visibleLayers)}}),o$W.__init__=function(){o$W._layerList.length=31;for(var o$o=0;o$o<31;o$o++){var o$r=new o$W;o$W._layerList[o$o]=o$r,0===o$o?(o$r.name="Default Layer",o$r.visible=!0):(o$r.name="Layer-"+o$o,o$r.visible=!1),o$r._number=o$o,o$r._mask=Math.pow(2,o$o)}o$W.currentCreationLayer=o$W._layerList[0]},o$W.getLayerByNumber=function(o$o){if(o$o<0||30<o$o)throw new Error("无法返回指定Layer，该number超出范围！");return o$W._layerList[o$o]},o$W.getLayerByName=function(o$o){for(var o$r=0;o$r<31;o$r++)if(o$W._layerList[o$r].name===o$o)return o$W._layerList[o$r];throw new Error("无法返回指定Layer,该name不存在")},o$W.isVisible=function(o$o){return 0!=(o$o&o$W._currentCameraCullingMask&o$W._visibleLayers)},o$W._layerList=[],o$W._visibleLayers=2147483647,o$W._collsionTestList=[],o$W._currentCameraCullingMask=2147483647,o$W.maxCount=31,o$W.currentCreationLayer=null,o$W}()),o$C=(function(){function o$o(o$o,o$r,o$T){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=o$o,this._minCount=o$r,this._maxCount=o$T}o$v(o$o,"laya.d3.core.particleShuriKen.module.Burst");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r.cloneTo=function(o$o){var o$r=o$o;o$r._time=this._time,o$r._minCount=this._minCount,o$r._maxCount=this._maxCount},o$r.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$r,"time",function(){return this._time}),o$x(0,o$r,"minCount",function(){return this._minCount}),o$x(0,o$r,"maxCount",function(){return this._maxCount})}(),function(){function o$o(o$o){this._color=null,this.enbale=!1,this._color=o$o}o$v(o$o,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var o$r=o$o.prototype;o$r.cloneTo=function(o$o){var o$r=o$o;this._color.cloneTo(o$r._color),o$r.enbale=this.enbale},o$r.clone=function(){var o$o;switch(this._color.type){case 0:o$o=o$O.createByConstant(this._color.constant.clone());break;case 1:o$o=o$O.createByGradient(this._color.gradient.clone());break;case 2:o$o=o$O.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:o$o=o$O.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var o$r=new this.constructor(o$o);return o$r.enbale=this.enbale,o$r},o$x(0,o$r,"color",function(){return this._color})}(),function(){function o$o(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}o$v(o$o,"laya.d3.core.particleShuriKen.module.Emission");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),o$r._destroy=function(){this._bursts=null,this._destroyed=!0},o$r.getBurstsCount=function(){return this._bursts.length},o$r.getBurstByIndex=function(o$o){return this._bursts[o$o]},o$r.addBurst=function(o$o){var o$r=this._bursts.length;if(0<o$r)for(var o$T=0;o$T<o$r;o$T++)this._bursts[o$T].time>o$o.time&&this._bursts.splice(o$T,0,o$o);this._bursts.push(o$o)},o$r.removeBurst=function(o$o){var o$r=this._bursts.indexOf(o$o);-1!==o$r&&this._bursts.splice(o$r,1)},o$r.removeBurstByIndex=function(o$o){this._bursts.splice(o$o,1)},o$r.clearBurst=function(){this._bursts.length=0},o$r.cloneTo=function(o$o){var o$r=o$o,o$T=o$r._bursts;o$T.length=this._bursts.length;for(var o$k=0,o$W=this._bursts.length;o$k<o$W;o$k++){var o$D=o$T[o$k];o$D?this._bursts[o$k].cloneTo(o$D):o$T[o$k]=this._bursts[o$k].clone()}o$r._emissionRate=this._emissionRate,o$r.enbale=this.enbale},o$r.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$r,"destroyed",function(){return this._destroyed}),o$x(0,o$r,"emissionRate",function(){return this._emissionRate},function(o$o){if(o$o<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=o$o})}(),function(){function o$k(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}o$v(o$k,"laya.d3.core.particleShuriKen.module.FrameOverTime");var o$o=o$k.prototype;return o$S.imps(o$o,{"laya.d3.core.IClone":!0}),o$o.cloneTo=function(o$o){var o$r=o$o;o$r._type=this._type,o$r._constant=this._constant,this._overTime.cloneTo(o$r._overTime),o$r._constantMin=this._constantMin,o$r._constantMax=this._constantMax,this._overTimeMin.cloneTo(o$r._overTimeMin),this._overTimeMax.cloneTo(o$r._overTimeMax)},o$o.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$o,"frameOverTimeData",function(){return this._overTime}),o$x(0,o$o,"constant",function(){return this._constant}),o$x(0,o$o,"type",function(){return this._type}),o$x(0,o$o,"frameOverTimeDataMin",function(){return this._overTimeMin}),o$x(0,o$o,"constantMin",function(){return this._constantMin}),o$x(0,o$o,"frameOverTimeDataMax",function(){return this._overTimeMax}),o$x(0,o$o,"constantMax",function(){return this._constantMax}),o$k.createByConstant=function(o$o){var o$r=new o$k;return o$r._type=0,o$r._constant=o$o,o$r},o$k.createByOverTime=function(o$o){var o$r=new o$k;return o$r._type=1,o$r._overTime=o$o,o$r},o$k.createByRandomTwoConstant=function(o$o,o$r){var o$T=new o$k;return o$T._type=2,o$T._constantMin=o$o,o$T._constantMax=o$r,o$T},o$k.createByRandomTwoOverTime=function(o$o,o$r){var o$T=new o$k;return o$T._type=3,o$T._overTimeMin=o$o,o$T._overTimeMax=o$r,o$T},o$k}()),o$X=function(){function o$U(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}o$v(o$U,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var o$o=o$U.prototype;return o$S.imps(o$o,{"laya.d3.core.IClone":!0}),o$o.cloneTo=function(o$o){var o$r=o$o;o$r._type=this._type,o$r._separateAxes=this._separateAxes,o$r._constant=this._constant,this._constantSeparate.cloneTo(o$r._constantSeparate),this._gradient.cloneTo(o$r._gradient),this._gradientX.cloneTo(o$r._gradientX),this._gradientY.cloneTo(o$r._gradientY),this._gradientZ.cloneTo(o$r._gradientZ),o$r._constantMin=this._constantMin,o$r._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(o$r._constantMinSeparate),this._constantMaxSeparate.cloneTo(o$r._constantMaxSeparate),this._gradientMin.cloneTo(o$r._gradientMin),this._gradientMax.cloneTo(o$r._gradientMax),this._gradientXMin.cloneTo(o$r._gradientXMin),this._gradientXMax.cloneTo(o$r._gradientXMax),this._gradientYMin.cloneTo(o$r._gradientYMin),this._gradientYMax.cloneTo(o$r._gradientYMax),this._gradientZMin.cloneTo(o$r._gradientZMin),this._gradientZMax.cloneTo(o$r._gradientZMax)},o$o.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$o,"gradientZ",function(){return this._gradientZ}),o$x(0,o$o,"constant",function(){return this._constant}),o$x(0,o$o,"gradient",function(){return this._gradient}),o$x(0,o$o,"separateAxes",function(){return this._separateAxes}),o$x(0,o$o,"type",function(){return this._type}),o$x(0,o$o,"constantSeparate",function(){return this._constantSeparate}),o$x(0,o$o,"gradientX",function(){return this._gradientX}),o$x(0,o$o,"gradientY",function(){return this._gradientY}),o$x(0,o$o,"gradientW",function(){return this._gradientW}),o$x(0,o$o,"gradientMin",function(){return this._gradientMin}),o$x(0,o$o,"constantMin",function(){return this._constantMin}),o$x(0,o$o,"gradientMax",function(){return this._gradientMax}),o$x(0,o$o,"constantMax",function(){return this._constantMax}),o$x(0,o$o,"gradientWMin",function(){return this._gradientWMin}),o$x(0,o$o,"constantMinSeparate",function(){return this._constantMinSeparate}),o$x(0,o$o,"constantMaxSeparate",function(){return this._constantMaxSeparate}),o$x(0,o$o,"gradientXMin",function(){return this._gradientXMin}),o$x(0,o$o,"gradientXMax",function(){return this._gradientXMax}),o$x(0,o$o,"gradientWMax",function(){return this._gradientWMax}),o$x(0,o$o,"gradientYMin",function(){return this._gradientYMin}),o$x(0,o$o,"gradientYMax",function(){return this._gradientYMax}),o$x(0,o$o,"gradientZMin",function(){return this._gradientZMin}),o$x(0,o$o,"gradientZMax",function(){return this._gradientZMax}),o$U.createByConstant=function(o$o){var o$r=new o$U;return o$r._type=0,o$r._separateAxes=!1,o$r._constant=o$o,o$r},o$U.createByConstantSeparate=function(o$o){var o$r=new o$U;return o$r._type=0,o$r._separateAxes=!0,o$r._constantSeparate=o$o,o$r},o$U.createByGradient=function(o$o){var o$r=new o$U;return o$r._type=1,o$r._separateAxes=!1,o$r._gradient=o$o,o$r},o$U.createByGradientSeparate=function(o$o,o$r,o$T,o$k){var o$W=new o$U;return o$W._type=1,o$W._separateAxes=!0,o$W._gradientX=o$o,o$W._gradientY=o$r,o$W._gradientZ=o$T,o$W._gradientW=o$k,o$W},o$U.createByRandomTwoConstant=function(o$o,o$r){var o$T=new o$U;return o$T._type=2,o$T._separateAxes=!1,o$T._constantMin=o$o,o$T._constantMax=o$r,o$T},o$U.createByRandomTwoConstantSeparate=function(o$o,o$r){var o$T=new o$U;return o$T._type=2,o$T._separateAxes=!0,o$T._constantMinSeparate=o$o,o$T._constantMaxSeparate=o$r,o$T},o$U.createByRandomTwoGradient=function(o$o,o$r){var o$T=new o$U;return o$T._type=3,o$T._separateAxes=!1,o$T._gradientMin=o$o,o$T._gradientMax=o$r,o$T},o$U.createByRandomTwoGradientSeparate=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){var o$L=new o$U;return o$L._type=3,o$L._separateAxes=!0,o$L._gradientXMin=o$o,o$L._gradientXMax=o$r,o$L._gradientYMin=o$T,o$L._gradientYMax=o$k,o$L._gradientZMin=o$W,o$L._gradientZMax=o$D,o$L._gradientWMin=o$n,o$L._gradientWMax=o$V,o$L},o$U}(),o$O=function(){function o$k(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}o$v(o$k,"laya.d3.core.particleShuriKen.module.GradientColor");var o$o=o$k.prototype;return o$S.imps(o$o,{"laya.d3.core.IClone":!0}),o$o.cloneTo=function(o$o){var o$r=o$o;o$r._type=this._type,this._constant.cloneTo(o$r._constant),this._constantMin.cloneTo(o$r._constantMin),this._constantMax.cloneTo(o$r._constantMax),this._gradient.cloneTo(o$r._gradient),this._gradientMin.cloneTo(o$r._gradientMin),this._gradientMax.cloneTo(o$r._gradientMax)},o$o.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$o,"gradient",function(){return this._gradient}),o$x(0,o$o,"constant",function(){return this._constant}),o$x(0,o$o,"type",function(){return this._type}),o$x(0,o$o,"gradientMin",function(){return this._gradientMin}),o$x(0,o$o,"constantMin",function(){return this._constantMin}),o$x(0,o$o,"gradientMax",function(){return this._gradientMax}),o$x(0,o$o,"constantMax",function(){return this._constantMax}),o$k.createByConstant=function(o$o){var o$r=new o$k;return o$r._type=0,o$r._constant=o$o,o$r},o$k.createByGradient=function(o$o){var o$r=new o$k;return o$r._type=1,o$r._gradient=o$o,o$r},o$k.createByRandomTwoConstant=function(o$o,o$r){var o$T=new o$k;return o$T._type=2,o$T._constantMin=o$o,o$T._constantMax=o$r,o$T},o$k.createByRandomTwoGradient=function(o$o,o$r){var o$T=new o$k;return o$T._type=3,o$T._gradientMin=o$o,o$T._gradientMax=o$r,o$T},o$k}(),o$M=(function(){function o$o(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}o$v(o$o,"laya.d3.core.particleShuriKen.module.GradientDataColor");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r.addAlpha=function(o$o,o$r){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==o$o&&(o$o=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=o$o,this._alphaElements[this._alphaCurrentLength++]=o$r):DEBUG},o$r.addRGB=function(o$o,o$r){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==o$o&&(o$o=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=o$o,this._rgbElements[this._rgbCurrentLength++]=o$r.x,this._rgbElements[this._rgbCurrentLength++]=o$r.y,this._rgbElements[this._rgbCurrentLength++]=o$r.z):DEBUG},o$r.cloneTo=function(o$o){var o$r=o$o,o$T=0,o$k=0;o$r._alphaCurrentLength=this._alphaCurrentLength;var o$W=o$r._alphaElements;for(o$W.length=this._alphaElements.length,o$T=0,o$k=this._alphaElements.length;o$T<o$k;o$T++)o$W[o$T]=this._alphaElements[o$T];o$r._rgbCurrentLength=this._rgbCurrentLength;var o$D=o$r._rgbElements;for(o$D.length=this._rgbElements.length,o$T=0,o$k=this._rgbElements.length;o$T<o$k;o$T++)o$D[o$T]=this._rgbElements[o$T]},o$r.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$r,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),o$x(0,o$r,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function o$o(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}o$v(o$o,"laya.d3.core.particleShuriKen.module.GradientDataInt");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r.add=function(o$o,o$r){this._currentLength<8?(6===this._currentLength&&1!==o$o&&(o$o=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=o$o,this._elements[this._currentLength++]=o$r):console.log("Warning:data count must lessEqual than 4")},o$r.cloneTo=function(o$o){var o$r=o$o;o$r._currentLength=this._currentLength;var o$T=o$r._elements;o$T.length=this._elements.length;for(var o$k=0,o$W=this._elements.length;o$k<o$W;o$k++)o$T[o$k]=this._elements[o$k]},o$r.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$r,"gradientCount",function(){return this._currentLength/2})}(),function(){function o$o(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}o$v(o$o,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r.add=function(o$o,o$r){this._currentLength<8?(6===this._currentLength&&1!==o$o&&(o$o=1,DEBUG),this._elements[this._currentLength++]=o$o,this._elements[this._currentLength++]=o$r):DEBUG},o$r.getKeyByIndex=function(o$o){return this._elements[2*o$o]},o$r.getValueByIndex=function(o$o){return this._elements[2*o$o+1]},o$r.getAverageValue=function(){for(var o$o=0,o$r=this._currentLength-2;o$o<o$r;o$o+=2){this._elements[o$o+1];this._elements[o$o+3],this._elements[o$o+2]-this._elements[o$o]}return 0},o$r.cloneTo=function(o$o){var o$r=o$o;o$r._currentLength=this._currentLength;var o$T=o$r._elements;o$T.length=this._elements.length;for(var o$k=0,o$W=this._elements.length;o$k<o$W;o$k++)o$T[o$k]=this._elements[o$k]},o$r.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$r,"gradientCount",function(){return this._currentLength/2})}(),function(){function o$o(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}o$v(o$o,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r.add=function(o$o,o$r){this._currentLength<8?(6===this._currentLength&&1!==o$o&&(o$o=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=o$o,this._elements[this._currentLength++]=o$r.x,this._elements[this._currentLength++]=o$r.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},o$r.cloneTo=function(o$o){var o$r=o$o;o$r._currentLength=this._currentLength;var o$T=o$r._elements;o$T.length=this._elements.length;for(var o$k=0,o$W=this._elements.length;o$k<o$W;o$k++)o$T[o$k]=this._elements[o$k]},o$r.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$r,"gradientCount",function(){return this._currentLength/3})}(),function(){function o$V(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}o$v(o$V,"laya.d3.core.particleShuriKen.module.GradientSize");var o$o=o$V.prototype;return o$S.imps(o$o,{"laya.d3.core.IClone":!0}),o$o.getMaxSizeInGradient=function(){var o$o=0,o$r=0,o$T=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(o$o=0,o$r=this._gradientX.gradientCount;o$o<o$r;o$o++)o$T=Math.max(o$T,this._gradientX.getValueByIndex(o$o));for(o$o=0,o$r=this._gradientY.gradientCount;o$o<o$r;o$o++)o$T=Math.max(o$T,this._gradientY.getValueByIndex(o$o))}else for(o$o=0,o$r=this._gradient.gradientCount;o$o<o$r;o$o++)o$T=Math.max(o$T,this._gradient.getValueByIndex(o$o));break;case 1:o$T=this._separateAxes?(o$T=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),o$T=Math.max(o$T,this._constantMinSeparate.y),Math.max(o$T,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(o$o=0,o$r=this._gradientXMin.gradientCount;o$o<o$r;o$o++)o$T=Math.max(o$T,this._gradientXMin.getValueByIndex(o$o));for(o$o=0,o$r=this._gradientXMax.gradientCount;o$o<o$r;o$o++)o$T=Math.max(o$T,this._gradientXMax.getValueByIndex(o$o));for(o$o=0,o$r=this._gradientYMin.gradientCount;o$o<o$r;o$o++)o$T=Math.max(o$T,this._gradientYMin.getValueByIndex(o$o));for(o$o=0,o$r=this._gradientZMax.gradientCount;o$o<o$r;o$o++)o$T=Math.max(o$T,this._gradientZMax.getValueByIndex(o$o))}else{for(o$o=0,o$r=this._gradientMin.gradientCount;o$o<o$r;o$o++)o$T=Math.max(o$T,this._gradientMin.getValueByIndex(o$o));for(o$o=0,o$r=this._gradientMax.gradientCount;o$o<o$r;o$o++)o$T=Math.max(o$T,this._gradientMax.getValueByIndex(o$o))}}return o$T},o$o.cloneTo=function(o$o){var o$r=o$o;o$r._type=this._type,o$r._separateAxes=this._separateAxes,this._gradient.cloneTo(o$r._gradient),this._gradientX.cloneTo(o$r._gradientX),this._gradientY.cloneTo(o$r._gradientY),this._gradientZ.cloneTo(o$r._gradientZ),o$r._constantMin=this._constantMin,o$r._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(o$r._constantMinSeparate),this._constantMaxSeparate.cloneTo(o$r._constantMaxSeparate),this._gradientMin.cloneTo(o$r._gradientMin),this._gradientMax.cloneTo(o$r._gradientMax),this._gradientXMin.cloneTo(o$r._gradientXMin),this._gradientXMax.cloneTo(o$r._gradientXMax),this._gradientYMin.cloneTo(o$r._gradientYMin),this._gradientYMax.cloneTo(o$r._gradientYMax),this._gradientZMin.cloneTo(o$r._gradientZMin),this._gradientZMax.cloneTo(o$r._gradientZMax)},o$o.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$o,"gradientZ",function(){return this._gradientZ}),o$x(0,o$o,"gradient",function(){return this._gradient}),o$x(0,o$o,"separateAxes",function(){return this._separateAxes}),o$x(0,o$o,"type",function(){return this._type}),o$x(0,o$o,"gradientMin",function(){return this._gradientMin}),o$x(0,o$o,"constantMin",function(){return this._constantMin}),o$x(0,o$o,"gradientX",function(){return this._gradientX}),o$x(0,o$o,"gradientY",function(){return this._gradientY}),o$x(0,o$o,"gradientMax",function(){return this._gradientMax}),o$x(0,o$o,"constantMax",function(){return this._constantMax}),o$x(0,o$o,"constantMinSeparate",function(){return this._constantMinSeparate}),o$x(0,o$o,"constantMaxSeparate",function(){return this._constantMaxSeparate}),o$x(0,o$o,"gradientXMin",function(){return this._gradientXMin}),o$x(0,o$o,"gradientXMax",function(){return this._gradientXMax}),o$x(0,o$o,"gradientYMin",function(){return this._gradientYMin}),o$x(0,o$o,"gradientYMax",function(){return this._gradientYMax}),o$x(0,o$o,"gradientZMin",function(){return this._gradientZMin}),o$x(0,o$o,"gradientZMax",function(){return this._gradientZMax}),o$V.createByGradient=function(o$o){var o$r=new o$V;return o$r._type=0,o$r._separateAxes=!1,o$r._gradient=o$o,o$r},o$V.createByGradientSeparate=function(o$o,o$r,o$T){var o$k=new o$V;return o$k._type=0,o$k._separateAxes=!0,o$k._gradientX=o$o,o$k._gradientY=o$r,o$k._gradientZ=o$T,o$k},o$V.createByRandomTwoConstant=function(o$o,o$r){var o$T=new o$V;return o$T._type=1,o$T._separateAxes=!1,o$T._constantMin=o$o,o$T._constantMax=o$r,o$T},o$V.createByRandomTwoConstantSeparate=function(o$o,o$r){var o$T=new o$V;return o$T._type=1,o$T._separateAxes=!0,o$T._constantMinSeparate=o$o,o$T._constantMaxSeparate=o$r,o$T},o$V.createByRandomTwoGradient=function(o$o,o$r){var o$T=new o$V;return o$T._type=2,o$T._separateAxes=!1,o$T._gradientMin=o$o,o$T._gradientMax=o$r,o$T},o$V.createByRandomTwoGradientSeparate=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=new o$V;return o$n._type=2,o$n._separateAxes=!0,o$n._gradientXMin=o$o,o$n._gradientXMax=o$r,o$n._gradientYMin=o$T,o$n._gradientYMax=o$k,o$n._gradientZMin=o$W,o$n._gradientZMax=o$D,o$n},o$V}()),o$c=function(){function o$V(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}o$v(o$V,"laya.d3.core.particleShuriKen.module.GradientVelocity");var o$o=o$V.prototype;return o$S.imps(o$o,{"laya.d3.core.IClone":!0}),o$o.cloneTo=function(o$o){var o$r=o$o;o$r._type=this._type,this._constant.cloneTo(o$r._constant),this._gradientX.cloneTo(o$r._gradientX),this._gradientY.cloneTo(o$r._gradientY),this._gradientZ.cloneTo(o$r._gradientZ),this._constantMin.cloneTo(o$r._constantMin),this._constantMax.cloneTo(o$r._constantMax),this._gradientXMin.cloneTo(o$r._gradientXMin),this._gradientXMax.cloneTo(o$r._gradientXMax),this._gradientYMin.cloneTo(o$r._gradientYMin),this._gradientYMax.cloneTo(o$r._gradientYMax),this._gradientZMin.cloneTo(o$r._gradientZMin),this._gradientZMax.cloneTo(o$r._gradientZMax)},o$o.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$o,"gradientZ",function(){return this._gradientZ}),o$x(0,o$o,"constant",function(){return this._constant}),o$x(0,o$o,"type",function(){return this._type}),o$x(0,o$o,"gradientXMax",function(){return this._gradientXMax}),o$x(0,o$o,"constantMin",function(){return this._constantMin}),o$x(0,o$o,"gradientX",function(){return this._gradientX}),o$x(0,o$o,"gradientY",function(){return this._gradientY}),o$x(0,o$o,"gradientXMin",function(){return this._gradientXMin}),o$x(0,o$o,"constantMax",function(){return this._constantMax}),o$x(0,o$o,"gradientYMin",function(){return this._gradientYMin}),o$x(0,o$o,"gradientYMax",function(){return this._gradientYMax}),o$x(0,o$o,"gradientZMin",function(){return this._gradientZMin}),o$x(0,o$o,"gradientZMax",function(){return this._gradientZMax}),o$V.createByConstant=function(o$o){var o$r=new o$V;return o$r._type=0,o$r._constant=o$o,o$r},o$V.createByGradient=function(o$o,o$r,o$T){var o$k=new o$V;return o$k._type=1,o$k._gradientX=o$o,o$k._gradientY=o$r,o$k._gradientZ=o$T,o$k},o$V.createByRandomTwoConstant=function(o$o,o$r){var o$T=new o$V;return o$T._type=2,o$T._constantMin=o$o,o$T._constantMax=o$r,o$T},o$V.createByRandomTwoGradient=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=new o$V;return o$n._type=3,o$n._gradientXMin=o$o,o$n._gradientXMax=o$r,o$n._gradientYMin=o$T,o$n._gradientYMax=o$k,o$n._gradientZMin=o$W,o$n._gradientZMax=o$D,o$n},o$V}(),o$e=(function(){function o$o(o$o){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=o$o}o$v(o$o,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r.cloneTo=function(o$o){var o$r=o$o;this._angularVelocity.cloneTo(o$r._angularVelocity),o$r.enbale=this.enbale},o$r.clone=function(){var o$o;switch(this._angularVelocity.type){case 0:o$o=this._angularVelocity.separateAxes?o$X.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):o$X.createByConstant(this._angularVelocity.constant);break;case 1:o$o=this._angularVelocity.separateAxes?o$X.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):o$X.createByGradient(this._angularVelocity.gradient.clone());break;case 2:o$o=this._angularVelocity.separateAxes?o$X.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):o$X.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:o$o=this._angularVelocity.separateAxes?o$X.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):o$X.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var o$r=new this.constructor(o$o);return o$r.enbale=this.enbale,o$r},o$x(0,o$r,"angularVelocity",function(){return this._angularVelocity})}(),function(){function o$o(){this.enable=!1,this.randomDirection=!1}o$v(o$o,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r._getShapeBoundBox=function(o$o){throw new Error("BaseShape: must override it.")},o$r._getSpeedBoundBox=function(o$o){throw new Error("BaseShape: must override it.")},o$r.generatePositionAndDirection=function(o$o,o$r,o$T,o$k){throw new Error("BaseShape: must override it.")},o$r._calculateProceduralBounds=function(o$o,o$r,o$T){this._getShapeBoundBox(o$o);var o$k=o$o.min,o$W=o$o.max;o$nr.multiply(o$k,o$r,o$k),o$nr.multiply(o$W,o$r,o$W);var o$D=new o$Qo(new o$nr,new o$nr);this.randomDirection?(o$D.min=new o$nr(-1,-1,-1),o$D.max=new o$nr(1,1,1)):this._getSpeedBoundBox(o$D);var o$n=new o$Qo(new o$nr,new o$nr),o$V=o$n.min,o$L=o$n.max;o$nr.scale(o$D.min,o$T.y,o$V),o$nr.scale(o$D.max,o$T.y,o$L),o$nr.add(o$o.min,o$V,o$V),o$nr.add(o$o.max,o$L,o$L),o$nr.min(o$o.min,o$V,o$o.min),o$nr.max(o$o.max,o$V,o$o.max);var o$U=new o$Qo(new o$nr,new o$nr),o$h=o$U.min,o$p=o$U.max;o$nr.scale(o$D.min,o$T.x,o$h),o$nr.scale(o$D.max,o$T.x,o$p),o$nr.min(o$U.min,o$p,o$V),o$nr.max(o$U.min,o$p,o$L),o$nr.min(o$o.min,o$V,o$o.min),o$nr.max(o$o.max,o$V,o$o.max)},o$r.cloneTo=function(o$o){o$o.enable=this.enable},o$r.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$o}()),o$N=function(){function o$D(){}return o$v(o$D,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),o$D._randomPointUnitArcCircle=function(o$o,o$r,o$T){var o$k=o$r.elements,o$W=NaN;o$W=o$T?o$T.getFloat()*o$o:Math.random()*o$o,o$k[0]=Math.cos(o$W),o$k[1]=Math.sin(o$W)},o$D._randomPointInsideUnitArcCircle=function(o$o,o$r,o$T){var o$k=o$r.elements;o$D._randomPointUnitArcCircle(o$o,o$r,o$T);var o$W=NaN;o$W=o$T?Math.pow(o$T.getFloat(),.5):Math.pow(Math.random(),.5),o$k[0]=o$k[0]*o$W,o$k[1]=o$k[1]*o$W},o$D._randomPointUnitCircle=function(o$o,o$r){var o$T=o$o.elements,o$k=NaN;o$k=o$r?o$r.getFloat()*Math.PI*2:Math.random()*Math.PI*2,o$T[0]=Math.cos(o$k),o$T[1]=Math.sin(o$k)},o$D._randomPointInsideUnitCircle=function(o$o,o$r){var o$T=o$o.elements;o$D._randomPointUnitCircle(o$o);var o$k=NaN;o$k=o$r?Math.pow(o$r.getFloat(),.5):Math.pow(Math.random(),.5),o$T[0]=o$T[0]*o$k,o$T[1]=o$T[1]*o$k},o$D._randomPointUnitSphere=function(o$o,o$r){var o$T=o$o.elements,o$k=NaN,o$W=NaN;o$W=o$r?(o$k=o$T[2]=2*o$r.getFloat()-1,o$r.getFloat()*Math.PI*2):(o$k=o$T[2]=2*Math.random()-1,Math.random()*Math.PI*2);var o$D=Math.sqrt(1-o$k*o$k);o$T[0]=o$D*Math.cos(o$W),o$T[1]=o$D*Math.sin(o$W)},o$D._randomPointInsideUnitSphere=function(o$o,o$r){var o$T=o$o.elements;o$D._randomPointUnitSphere(o$o);var o$k=NaN;o$k=o$r?Math.pow(o$r.getFloat(),1/3):Math.pow(Math.random(),1/3),o$T[0]=o$T[0]*o$k,o$T[1]=o$T[1]*o$k,o$T[2]=o$T[2]*o$k},o$D._randomPointInsideHalfUnitBox=function(o$o,o$r){var o$T=o$o.elements;o$r?(o$T[0]=o$r.getFloat()-.5,o$T[1]=o$r.getFloat()-.5,o$T[2]=o$r.getFloat()-.5):(o$T[0]=Math.random()-.5,o$T[1]=Math.random()-.5,o$T[2]=Math.random()-.5)},o$D}(),o$f=(function(){function o$o(o$o){this._size=null,this.enbale=!1,this._size=o$o}o$v(o$o,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r.cloneTo=function(o$o){var o$r=o$o;this._size.cloneTo(o$r._size),o$r.enbale=this.enbale},o$r.clone=function(){var o$o;switch(this._size.type){case 0:o$o=this._size.separateAxes?o$M.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):o$M.createByGradient(this._size.gradient.clone());break;case 1:o$o=this._size.separateAxes?o$M.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):o$M.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:o$o=this._size.separateAxes?o$M.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):o$M.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var o$r=new this.constructor(o$o);return o$r.enbale=this.enbale,o$r},o$x(0,o$r,"size",function(){return this._size})}(),function(){function o$k(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}o$v(o$k,"laya.d3.core.particleShuriKen.module.StartFrame");var o$o=o$k.prototype;return o$S.imps(o$o,{"laya.d3.core.IClone":!0}),o$o.cloneTo=function(o$o){var o$r=o$o;o$r._type=this._type,o$r._constant=this._constant,o$r._constantMin=this._constantMin,o$r._constantMax=this._constantMax},o$o.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$o,"constant",function(){return this._constant}),o$x(0,o$o,"type",function(){return this._type}),o$x(0,o$o,"constantMin",function(){return this._constantMin}),o$x(0,o$o,"constantMax",function(){return this._constantMax}),o$k.createByConstant=function(o$o){var o$r=new o$k;return o$r._type=0,o$r._constant=o$o,o$r},o$k.createByRandomTwoConstant=function(o$o,o$r){var o$T=new o$k;return o$T._type=1,o$T._constantMin=o$o,o$T._constantMax=o$r,o$T},o$k}()),o$a=(function(){function o$o(o$o,o$r){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new o$Dr(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=o$o,this._startFrame=o$r}o$v(o$o,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r.cloneTo=function(o$o){var o$r=o$o;this.tiles.cloneTo(o$r.tiles),o$r.type=this.type,o$r.randomRow=this.randomRow,this._frame.cloneTo(o$r._frame),this._startFrame.cloneTo(o$r._startFrame),o$r.cycles=this.cycles,o$r.enableUVChannels=this.enableUVChannels,o$r.enable=this.enable},o$r.clone=function(){var o$o,o$r;switch(this._frame.type){case 0:o$o=o$C.createByConstant(this._frame.constant);break;case 1:o$o=o$C.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:o$o=o$C.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:o$o=o$C.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:o$r=o$f.createByConstant(this._startFrame.constant);break;case 1:o$r=o$f.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var o$T=new this.constructor(o$o,o$r);return this.tiles.cloneTo(o$T.tiles),o$T.type=this.type,o$T.randomRow=this.randomRow,o$T.cycles=this.cycles,o$T.enableUVChannels=this.enableUVChannels,o$T.enable=this.enable,o$T},o$x(0,o$r,"frame",function(){return this._frame}),o$x(0,o$r,"startFrame",function(){return this._startFrame})}(),function(){function o$o(o$o){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=o$o}o$v(o$o,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r.cloneTo=function(o$o){var o$r=o$o;this._velocity.cloneTo(o$r._velocity),o$r.enbale=this.enbale,o$r.space=this.space},o$r.clone=function(){var o$o;switch(this._velocity.type){case 0:o$o=o$c.createByConstant(this._velocity.constant.clone());break;case 1:o$o=o$c.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:o$o=o$c.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:o$o=o$c.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var o$r=new this.constructor(o$o);return o$r.enbale=this.enbale,o$r.space=this.space,o$r},o$x(0,o$r,"velocity",function(){return this._velocity})}(),function(){function o$o(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new o$ir,this._vb=o$er.create(o$o._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=o$cr.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=o$Or.nameKey.getID("LINE"),this._shaderCompile=o$Fr._preCompileShader[this._sharderNameID]}o$v(o$o,"laya.d3.core.PhasorSpriter3D");var o$r=o$o.prototype;return o$r.line=function(o$o,o$r,o$T,o$k){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(o$o.x,o$o.y,o$o.z,o$r.x,o$r.y,o$r.z,o$r.w),this.addVertex(o$T.x,o$T.y,o$T.z,o$k.x,o$k.y,o$k.z,o$k.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},o$r.circle=function(o$o,o$r,o$T,o$k,o$W,o$D){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*o$r,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/o$r,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*o$o,Math.cos(this._tempNumver0)*o$o,0,o$T,o$k,o$W,o$D),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},o$r.plane=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=o$k/2,this._tempNumver1=o$W/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(o$o-this._tempNumver0,o$r+this._tempNumver1,o$T,o$D,o$n,o$V,o$L),this.addVertex(o$o+this._tempNumver0,o$r+this._tempNumver1,o$T,o$D,o$n,o$V,o$L),this.addVertex(o$o-this._tempNumver0,o$r-this._tempNumver1,o$T,o$D,o$n,o$V,o$L),this.addVertex(o$o+this._tempNumver0,o$r-this._tempNumver1,o$T,o$D,o$n,o$V,o$L),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},o$r.box=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=o$k/2,this._tempNumver1=o$W/2,this._tempNumver2=o$D/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(o$o-this._tempNumver0,o$r+this._tempNumver1,o$T+this._tempNumver2,o$n,o$V,o$L,o$U),this.addVertex(o$o+this._tempNumver0,o$r+this._tempNumver1,o$T+this._tempNumver2,o$n,o$V,o$L,o$U),this.addVertex(o$o-this._tempNumver0,o$r-this._tempNumver1,o$T+this._tempNumver2,o$n,o$V,o$L,o$U),this.addVertex(o$o+this._tempNumver0,o$r-this._tempNumver1,o$T+this._tempNumver2,o$n,o$V,o$L,o$U),this.addVertex(o$o+this._tempNumver0,o$r+this._tempNumver1,o$T-this._tempNumver2,o$n,o$V,o$L,o$U),this.addVertex(o$o-this._tempNumver0,o$r+this._tempNumver1,o$T-this._tempNumver2,o$n,o$V,o$L,o$U),this.addVertex(o$o+this._tempNumver0,o$r-this._tempNumver1,o$T-this._tempNumver2,o$n,o$V,o$L,o$U),this.addVertex(o$o-this._tempNumver0,o$r-this._tempNumver1,o$T-this._tempNumver2,o$n,o$V,o$L,o$U),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},o$r.cone=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*o$T+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*o$T>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/o$T,this.addVertexIndex(0,o$r,0,o$k,o$W,o$D,o$n,this._tempUint0),this.addVertexIndex(0,0,0,o$k,o$W,o$D,o$n,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<o$T;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(o$o*this._tempNumver2,0,o$o*this._tempNumver3,o$k,o$W,o$D,o$n,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==o$T-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(o$o*this._tempNumver2,0,o$o*this._tempNumver3,o$k,o$W,o$D,o$n,this._tempUint0+(this._tempInt0+o$T)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==o$T-1?this.addIndexes(this._tempUint1+o$T+2):this.addIndexes(this._tempUint1+this._tempInt0+o$T+1),this.addIndexes(this._tempUint1+this._tempInt0+o$T),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},o$r.boundingBoxLine=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(o$o,o$W,o$D,o$n,o$V,o$L,o$U),this.addVertex(o$k,o$W,o$D,o$n,o$V,o$L,o$U),this.addVertex(o$o,o$r,o$D,o$n,o$V,o$L,o$U),this.addVertex(o$k,o$r,o$D,o$n,o$V,o$L,o$U),this.addVertex(o$k,o$W,o$T,o$n,o$V,o$L,o$U),this.addVertex(o$o,o$W,o$T,o$n,o$V,o$L,o$U),this.addVertex(o$k,o$r,o$T,o$n,o$V,o$L,o$U),this.addVertex(o$o,o$r,o$T,o$n,o$V,o$L,o$U),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},o$r.addVertex=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=o$o,this._vbData[this._posInVBData+1]=o$r,this._vbData[this._posInVBData+2]=o$T,this._vbData[this._posInVBData+3]=o$k,this._vbData[this._posInVBData+4]=o$W,this._vbData[this._posInVBData+5]=o$D,this._vbData[this._posInVBData+6]=o$n,this._posInVBData+=this._floatSizePerVer,this},o$r.addVertexIndex=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){return this._hasBegun||this.addVertexIndexException(),this._vbData[o$V]=o$o,this._vbData[o$V+1]=o$r,this._vbData[o$V+2]=o$T,this._vbData[o$V+3]=o$k,this._vbData[o$V+4]=o$W,this._vbData[o$V+5]=o$D,this._vbData[o$V+6]=o$n,(o$V+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=o$V),this},o$r.addIndexes=function(o$o){var o$r=arguments;this._hasBegun||this.addVertexIndexException();for(var o$T=0;o$T<o$r.length;o$T++)this._ibData[this._posInIBData]=o$r[o$T],this._posInIBData++;return this},o$r.begin=function(o$o,o$r){return this._hasBegun&&this.beginException0(),1!==o$o&&4!==o$o&&this.beginException1(),this._primitiveType=o$o,this._camera=o$r,this._hasBegun=!0,this},o$r.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},o$r.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(o$o._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),o$F.drawCall++,o$u.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},o$r.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},o$r.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},o$r.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},o$r.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},o$r.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},o$r.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(28,[new o$no(0,"vector3",0),new o$no(12,"vector4",1)])}]),o$o}()),o$G=function(){function o$o(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++o$o._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new o$ir}o$v(o$o,"laya.d3.core.render.RenderElement");var o$r=o$o.prototype;return o$r.getDynamicBatchBakedVertexs=function(o$o){for(var o$r=this._renderObj._getVertexBuffer(o$o),o$T=o$r.getData().slice(),o$k=o$r.vertexDeclaration,o$W=o$k.getVertexElementByUsage(0).offset/4,o$D=o$k.getVertexElementByUsage(3).offset/4,o$n=this._sprite3D.transform,o$V=o$n.worldMatrix,o$L=o$n.rotation,o$U=o$k.vertexStride/4,o$h=0,o$p=o$T.length;o$h<o$p;o$h+=o$U){var o$i=o$h+o$W,o$v=o$h+o$D;o$_r.transformVector3ArrayToVector3ArrayCoordinate(o$T,o$i,o$V,o$T,o$i),o$_r.transformVector3ArrayByQuat(o$T,o$v,o$L,o$T,o$v)}return o$T},o$r.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},o$r._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},o$x(0,o$r,"id",function(){return this._id}),o$x(0,o$r,"renderObj",function(){return this._renderObj},function(o$o){this._renderObj!==o$o&&(this._renderObj=o$o)}),o$o._uniqueIDCounter=0,o$o}(),o$w=function(){function o$r(o$o){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++o$r._uniqueIDCounter,this._needSort=!1,this._scene=o$o,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}o$v(o$r,"laya.d3.core.render.RenderQueue");var o$o=o$r.prototype;return o$o._sortOpaqueFunc=function(o$o,o$r){if(o$o._render&&o$r._render){var o$T=o$o._material.renderQueue-o$r._material.renderQueue;return 0==o$T?o$o._render._distanceForSort-o$r._render._distanceForSort:o$T}return 0},o$o._sortAlphaFunc=function(o$o,o$r){if(o$o._render&&o$r._render){var o$T=o$o._material.renderQueue-o$r._material.renderQueue;return 0==o$T?o$r._render._distanceForSort-o$o._render._distanceForSort:o$T}return 0},o$o._begainRenderElement=function(o$o,o$r,o$T){return!!o$r._beforeRender(o$o)},o$o._sortAlpha=function(o$o){o$r._cameraPosition=o$o,this._finalElements.sort(this._sortAlphaFunc)},o$o._sortOpaque=function(o$o){o$r._cameraPosition=o$o,this._finalElements.sort(this._sortOpaqueFunc)},o$o._preRender=function(o$o){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},o$o._render=function(o$o,o$r){for(var o$T,o$k,o$W,o$D,o$n,o$V,o$L=o$F.loopCount,o$U=this._scene,o$h=o$o.camera,o$p=(o$h.id,!1),o$i=0,o$v=this._finalElements.length;o$i<o$v;o$i++){var o$x,o$j,o$_,o$K=this._finalElements[o$i];if(null!=o$K._onPreRenderFunction&&o$K._onPreRenderFunction.call(o$K._sprite3D,o$o),0===o$K._type){if(o$o.owner=o$_=o$K._sprite3D,o$o.renderElement=o$K,o$_._preRenderUpdateComponents(o$o),o$x=o$K.renderObj,o$j=o$K._material,this._begainRenderElement(o$o,o$x,o$j)){if(o$T=o$x._getVertexBuffers(),!(o$W=(o$k=o$x._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[o$k.id]){this._errorRecord[o$k.id]=1;var o$$="vertexBuffer:"+("("+o$k._destroyed+","+o$k._released+","+o$k._referenceCount+","+o$k._buffer+")")+", material:"+(o$j?o$j.__className+"("+o$j._destroyed+","+o$j._released+")":"null")+", owner:"+(o$_?o$_.__className+"("+o$_._destroyed+","+o$_._activeInHierarchy+","+o$_._displayedInStage+")":"null")+", renderObj:"+(o$x?o$x.__className+"("+o$x._destroyed+","+o$x._released+","+o$x._referenceCount+")":"")+", parent:, url:"+(o$_?o$_.url:"")+", disposeStack:"+o$k.disposeStack;o$S.recordError("报错：unknown vertexDeclaration  "+o$$)}continue}if(o$p=(o$D=o$o._shader=o$j._getShader(o$U._shaderDefineValue,o$W.shaderDefineValue,o$_._shaderDefineValue)).bind()||o$L!==o$D._uploadLoopCount,o$T){if(o$D._uploadVertexBuffer!==o$T||o$p){for(var o$y=0;o$y<o$T.length;o$y++){var o$l=o$T[o$y];o$D.uploadAttributesX(o$l.vertexDeclaration.shaderValues.data,o$l)}o$D._uploadVertexBuffer=o$T}}else(o$D._uploadVertexBuffer!==o$k||o$p)&&(o$D.uploadAttributes(o$W.shaderValues.data,null),o$D._uploadVertexBuffer=o$k);(o$D._uploadScene!==o$U||o$p)&&(o$D.uploadSceneUniforms(o$U._shaderValues.data),o$D._uploadScene=o$U),(o$h!==o$D._uploadCamera||o$D._uploadSprite3D!==o$_||o$p)&&(o$D.uploadSpriteUniforms(o$_._shaderValues.data),o$D._uploadSprite3D=o$_),(o$h!==o$D._uploadCamera||o$p)&&(o$D.uploadCameraUniforms(o$h._shaderValues.data),o$D._uploadCamera=o$h),(o$D._uploadMaterial!==o$j||o$p)&&(o$j._upload(),o$D._uploadMaterial=o$j),o$n!==o$j?(o$j._setRenderStateBlendDepth(),o$j._setRenderStateFrontFace(o$r,o$_.transform),o$n=o$j,o$V=o$_):o$V!==o$_&&(o$j._setRenderStateFrontFace(o$r,o$_.transform),o$V=o$_),o$x._render(o$o),o$D._uploadLoopCount=o$L}o$_._postRenderUpdateComponents(o$o)}else if(2===o$K._type){o$K.renderObj;o$o.owner=o$_=o$K._sprite3D,o$o.renderElement=o$K,o$o._batchIndexStart=o$K._tempBatchIndexStart,o$o._batchIndexEnd=o$K._tempBatchIndexEnd,o$x=o$K.renderObj,o$j=o$K._material,this._begainRenderElement(o$o,o$x,o$j)&&(o$W=(o$k=o$x._getVertexBuffer(0)).vertexDeclaration,o$p=(o$D=o$o._shader=o$j._getShader(o$U._shaderDefineValue,o$W.shaderDefineValue,o$_._shaderDefineValue)).bind()||o$L!==o$D._uploadLoopCount,(o$D._uploadVertexBuffer!==o$k||o$p)&&(o$D.uploadAttributes(o$W.shaderValues.data,null),o$D._uploadVertexBuffer=o$k),(o$D._uploadScene!==o$U||o$p)&&(o$D.uploadSceneUniforms(o$U._shaderValues.data),o$D._uploadScene=o$U),(o$h!==o$D._uploadCamera||o$D._uploadSprite3D!==o$_||o$p)&&(o$D.uploadSpriteUniforms(o$_._shaderValues.data),o$D._uploadSprite3D=o$_),(o$h!==o$D._uploadCamera||o$p)&&(o$D.uploadCameraUniforms(o$h._shaderValues.data),o$D._uploadCamera=o$h),(o$D._uploadMaterial!==o$j||o$p)&&(o$j._upload(),o$D._uploadMaterial=o$j),o$n!==o$j?(o$j._setRenderStateBlendDepth(),o$j._setRenderStateFrontFace(o$r,o$_.transform),o$n=o$j,o$V=o$_):o$V!==o$_&&(o$j._setRenderStateFrontFace(o$r,o$_.transform),o$V=o$_),o$x._render(o$o),o$D._uploadLoopCount=o$L)}}},o$o._renderShadow=function(o$o,o$r){for(var o$T,o$k,o$W,o$D,o$n,o$V=o$F.loopCount,o$L=this._scene,o$U=o$o.camera,o$h=!1,o$p=0,o$i=this._finalElements.length;o$p<o$i;o$p++){var o$v,o$x,o$j,o$_=this._finalElements[o$p];0===o$_._type&&(o$o.owner=o$j=o$_._sprite3D,o$r||o$j._projectionViewWorldUpdateCamera===o$U&&o$j._projectionViewWorldUpdateLoopCount===o$F.loopCount||(o$j._render._renderUpdate(o$o._projectionViewMatrix),o$j._projectionViewWorldUpdateLoopCount=o$F.loopCount,o$j._projectionViewWorldUpdateCamera=o$U),o$o.renderElement=o$_,o$j._preRenderUpdateComponents(o$o),o$v=o$_.renderObj,o$x=o$_._material,this._begainRenderElement(o$o,o$v,null)&&(o$k=(o$T=o$v._getVertexBuffer(0)).vertexDeclaration,o$h=(o$W=o$o._shader=o$x._getShader(o$L._shaderDefineValue,o$k.shaderDefineValue,o$j._shaderDefineValue)).bind()||o$V!==o$W._uploadLoopCount,(o$W._uploadVertexBuffer!==o$T||o$h)&&(o$W.uploadAttributes(o$k.shaderValues.data,null),o$W._uploadVertexBuffer=o$T),(o$U!==o$W._uploadCamera||o$W._uploadSprite3D!==o$j||o$h)&&(o$W.uploadSpriteUniforms(o$j._shaderValues.data),o$W._uploadSprite3D=o$j),(o$U!==o$W._uploadCamera||o$h)&&(o$W.uploadCameraUniforms(o$U._shaderValues.data),o$W._uploadCamera=o$U),(o$W._uploadMaterial!==o$x||o$h)&&(o$x._upload(),o$W._uploadMaterial=o$x),o$W._uploadRenderElement,o$D!==o$x?(o$x._setRenderStateFrontFace(!1,o$j.transform),o$D=o$x,o$n=o$j):o$n!==o$j&&(o$x._setRenderStateFrontFace(!1,o$j.transform),o$n=o$j),o$v._render(o$o),o$W._uploadLoopCount=o$V),o$j._postRenderUpdateComponents(o$o))}},o$o._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},o$o._addRenderElement=function(o$o){this._renderElements.push(o$o),this._needSort=!0},o$o._addDynamicBatchElement=function(o$o){this._dynamicBatchCombineRenderElements.push(o$o)},o$x(0,o$o,"id",function(){return this._id}),o$r._uniqueIDCounter=0,o$r._cameraPosition=null,o$r}(),o$Z=function(){function o$o(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return o$v(o$o,"laya.d3.core.render.RenderState"),o$o.clientWidth=0,o$o.clientHeight=0,o$o}(),o$Q=function(){function o$n(o$o,o$r){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new o$Bo(new o$nr,0),this._corners=[new o$nr,new o$nr,new o$nr,new o$nr,new o$nr,new o$nr,new o$nr,new o$nr],this._boundingBoxCenter=new o$nr,this._children=o$k(8),this._objects=[],this._tempBoundBoxCorners=[new o$nr,new o$nr,new o$nr,new o$nr,new o$nr,new o$nr,new o$nr,new o$nr],this._scene=o$o,this._currentDepth=o$r}o$v(o$n,"laya.d3.core.scene.OctreeNode");var o$o=o$n.prototype;return o$S.imps(o$o,{"laya.d3.core.scene.ITreeNode":!0}),o$o.init=function(o$o,o$r){var o$T=new o$nr,o$k=new o$nr;o$nr.scale(o$r,-.5,o$T),o$nr.scale(o$r,.5,o$k),o$nr.add(o$T,o$o,o$T),o$nr.add(o$k,o$o,o$k),this.exactBox=new o$Qo(o$T,o$k),this.relaxBox=new o$Qo(o$T,o$k)},o$o.addTreeNode=function(o$o){1===Collision.boxContainsBox(this._relaxBox,o$o.boundingBox)?this.addNodeDown(o$o,0):this.addObject(o$o)},o$o.addChild=function(o$o){var o$r=this._children[o$o];if(null==o$r){o$r=new o$n(this._scene,this._currentDepth+1),(this._children[o$o]=o$r)._parent=this,o$nr.subtract(this._exactBox.max,this._exactBox.min,o$n.tempSize),o$nr.multiply(o$n.tempSize,o$n._octreeSplit[o$o],o$n.tempCenter),o$nr.add(this._exactBox.min,o$n.tempCenter,o$n.tempCenter),o$nr.scale(o$n.tempSize,.25,o$n.tempSize);var o$T=new o$nr,o$k=new o$nr;o$nr.subtract(o$n.tempCenter,o$n.tempSize,o$T),o$nr.add(o$n.tempCenter,o$n.tempSize,o$k),o$r.exactBox=new o$Qo(o$T,o$k),o$nr.scale(o$n.tempSize,o$n.relax,o$n.tempSize);var o$W=new o$nr,o$D=new o$nr;o$nr.subtract(o$n.tempCenter,o$n.tempSize,o$W),o$nr.add(o$n.tempCenter,o$n.tempSize,o$D),o$r.relaxBox=new o$Qo(o$W,o$D)}return o$r},o$o.addObject=function(o$o){(o$o._treeNode=this)._objects.push(o$o)},o$o.removeObject=function(o$o){if(o$o._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var o$r=this._objects.indexOf(o$o);return-1!==o$r&&(this._objects.splice(o$r,1),!0)},o$o.clearObject=function(){this._objects.length=0},o$o.addNodeUp=function(o$o,o$r){this._parent&&1!==Collision.boxContainsBox(this._exactBox,o$o.boundingBox)?this._parent.addNodeUp(o$o,o$r-1):this.addNodeDown(o$o,o$r)},o$o.addNodeDown=function(o$o,o$r){if(o$r<this._scene.treeLevel){var o$T=this.inChildIndex(o$o.boundingBoxCenter),o$k=this.addChild(o$T);1===Collision.boxContainsBox(o$k._relaxBox,o$o.boundingBox)?o$k.addNodeDown(o$o,++o$r):this.addObject(o$o)}else this.addObject(o$o)},o$o.inChildIndex=function(o$o){return 4*(o$o.z<this._boundingBoxCenter.z?0:1)+2*(o$o.y<this._boundingBoxCenter.y?0:1)+(o$o.x<this._boundingBoxCenter.x?0:1)},o$o.updateObject=function(o$o){1===Collision.boxContainsBox(this._relaxBox,o$o.boundingBox)?(this.removeObject(o$o),o$o._treeNode=null,this.addNodeDown(o$o,this._currentDepth)):this._parent&&(this.removeObject(o$o),o$o._treeNode=null,this._parent.addNodeUp(o$o,this._currentDepth-1))},o$o.cullingObjects=function(o$o,o$r,o$T,o$k,o$W){var o$D,o$n=0,o$V=0,o$L=0,o$U=this._scene._dynamicBatchManager;for(o$n=0,o$D=this._objects.length;o$n<o$D;o$n++){var o$h=this._objects[o$n];if(o$m.isVisible(o$h._owner.layer.mask)&&o$h.enable){if(o$r&&(o$F.treeSpriteCollision+=1,0===o$o.containsBoundSphere(o$h.boundingSphere)))continue;o$h._renderUpdate(o$W),o$h._distanceForSort=o$nr.distance(o$h.boundingSphere.center,o$k)+o$h.sortingFudge;var o$p=o$h._renderElements;for(o$V=0,o$L=o$p.length;o$V<o$L;o$V++){var o$i=o$p[o$V],o$v=o$i._staticBatch;if(o$v&&o$v._material===o$i._material)o$v._addBatchRenderElement(o$i);else{var o$x=o$i.renderObj;o$x.triangleCount<10&&1===o$x._vertexBufferCount&&o$x._getIndexBuffer()&&o$i._material.renderQueue<2&&o$i._canDynamicBatch&&!o$h._owner.isStatic?o$U._addPrepareRenderElement(o$i):this._scene.getRenderQueue(o$i._material.renderQueue)._addRenderElement(o$i)}}}}for(o$n=0;o$n<8;o$n++){var o$j=this._children[o$n];if(null!=o$j){var o$_=o$r;if(o$r){var o$K=o$o.containsBoundBox(o$j._relaxBox);if(o$F.treeNodeCollision+=1,0===o$K)continue;o$_=2===o$K}o$j.cullingObjects(o$o,o$_,o$T,o$k,o$W)}}},o$o.cullingShadowObjects=function(o$o,o$r,o$T,o$k,o$W){var o$D,o$n=0,o$V=0,o$L=0;this._scene._dynamicBatchManager;for(o$n=0,o$D=this._objects.length;o$n<o$D;o$n++){var o$U=this._objects[o$n];if(o$U.castShadow&&o$m.isVisible(o$U._owner.layer.mask)&&o$U.enable){if(o$T&&0===o$o[0].containsBoundSphere(o$U.boundingSphere))continue;for(var o$h=1,o$p=o$o.length;o$h<o$p;o$h++){var o$i=o$r[o$h-1];if(0!==o$o[o$h].containsBoundSphere(o$U.boundingSphere)){var o$v=o$U._renderElements;for(o$V=0,o$L=o$v.length;o$V<o$L;o$V++)o$i._addRenderElement(o$v[o$V])}}}}for(o$n=0;o$n<8;o$n++){var o$x=this._children[o$n];if(null!=o$x){var o$j=o$T;if(o$T){var o$_=o$o[0].containsBoundBox(o$x._relaxBox);if(0===o$_)continue;o$j=2===o$_}o$x.cullingShadowObjects(o$o,o$r,o$j,o$k,o$W)}}},o$o.cullingShadowObjectsOnePSSM=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n,o$V=o$r[0],o$L=0,o$U=0,o$h=0;for(o$L=0,o$n=this._objects.length;o$L<o$n;o$L++){var o$p=this._objects[o$L];if(o$p.castShadow&&o$m.isVisible(o$p._owner.layer.mask)&&o$p.enable){if(o$k&&0===o$o.containsBoundSphere(o$p.boundingSphere))continue;o$p._renderUpdate(o$T);var o$i=o$p._renderElements;for(o$U=0,o$h=o$i.length;o$U<o$h;o$U++)o$V._addRenderElement(o$i[o$U])}}for(o$L=0;o$L<8;o$L++){var o$v=this._children[o$L];if(null!=o$v){var o$x=o$k;if(o$k){var o$j=o$o.containsBoundBox(o$v._relaxBox);if(0===o$j)continue;o$x=2===o$j}o$v.cullingShadowObjectsOnePSSM(o$o,o$r,o$T,o$x,o$W,o$D)}}},o$o.renderBoudingBox=function(o$o){this._renderBoudingBox(o$o);for(var o$r=0;o$r<8;++o$r){var o$T=this._children[o$r];o$T&&o$T.renderBoudingBox(o$o)}},o$o.buildAllChild=function(o$o){if(o$o<this._scene.treeLevel)for(var o$r=0;o$r<8;o$r++){this.addChild(o$r).buildAllChild(o$o+1)}},o$o._renderBoudingBox=function(o$o){},o$x(0,o$o,"exactBox",function(){return this._exactBox},function(o$o){this._exactBox=o$o,o$nr.add(o$o.min,o$o.max,this._boundingBoxCenter),o$nr.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),o$x(0,o$o,"relaxBox",function(){return this._relaxBox},function(o$o){(this._relaxBox=o$o).getCorners(this._corners),o$Bo.createfromPoints(this._corners,this._boundingSphere)}),o$n.debugMode=!1,o$n.relax=1.15,o$n.CHILDNUM=8,o$p(o$n,["tempVector0",function(){return this.tempVector0=new o$nr},"tempSize",function(){return this.tempSize=new o$nr},"tempCenter",function(){return this.tempCenter=new o$nr},"_octreeSplit",function(){return this._octreeSplit=[new o$nr(.25,.25,.25),new o$nr(.75,.25,.25),new o$nr(.25,.75,.25),new o$nr(.75,.75,.25),new o$nr(.25,.25,.75),new o$nr(.75,.25,.75),new o$nr(.25,.75,.75),new o$nr(.75,.75,.75)]}]),o$n}(),o$g=(function(){function o$o(){}o$v(o$o,"laya.d3.core.scene.SceneManager")}(),function(){function o$o(o$o,o$r,o$T,o$k){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===o$o&&(o$o=1),void 0===o$r&&(o$r=1),void 0===o$T&&(o$T=1),void 0===o$k&&(o$k=1),this._r=o$o,this._g=o$r,this._b=o$T,this._a=o$k}return o$v(o$o,"laya.d3.core.trail.module.Color",null,"Color$1"),o$o.prototype.cloneTo=function(o$o){o$o._r=this._r,o$o._g=this._g,o$o._b=this._b,o$o._a=this._a},o$p(o$o,["RED",function(){return this.RED=new o$o(1,0,0,1)},"GREEN",function(){return this.GREEN=new o$o(0,1,0,1)},"BLUE",function(){return this.BLUE=new o$o(0,0,1,1)},"CYAN",function(){return this.CYAN=new o$o(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new o$o(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new o$o(1,0,1,1)},"GRAY",function(){return this.GRAY=new o$o(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new o$o(1,1,1,1)},"BLACK",function(){return this.BLACK=new o$o(0,0,0,1)}]),o$o}()),o$B=(function(){function o$o(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}o$v(o$o,"laya.d3.core.trail.module.Gradient");var o$r=o$o.prototype;o$r.setKeys=function(o$o,o$r){var o$T,o$k;this._colorKeys=o$o;for(var o$W=this.index=0;o$W<o$o.length;o$W++){var o$D=(o$T=o$o[o$W]).color;this._colorKeyData[this.index++]=o$D._r,this._colorKeyData[this.index++]=o$D._g,this._colorKeyData[this.index++]=o$D._b,this._colorKeyData[this.index++]=o$T.time}this._alphaKeys=o$r;for(var o$n=this.index=0;o$n<o$r.length;o$n++)o$k=o$r[o$n],this._alphaKeyData[this.index++]=o$k.alpha,this._alphaKeyData[this.index++]=o$k.time},o$r.cloneTo=function(o$o){var o$r=0,o$T=0,o$k=this.colorKeys,o$W=[];for(o$r=0,o$T=o$k.length;o$r<o$T;o$r++){var o$D=new o$E;o$k[o$r].cloneTo(o$D),o$W.push(o$D)}var o$n=this.alphaKeys,o$V=[];for(o$r=0,o$T=o$n.length;o$r<o$T;o$r++){var o$L=new o$B;o$n[o$r].cloneTo(o$L),o$V.push(o$L)}o$o.setKeys(o$W,o$V)},o$x(0,o$r,"mode",function(){return this._mode},function(o$o){this._mode=o$o}),o$x(0,o$r,"colorKeys",function(){return this._colorKeys},function(o$o){this._colorKeys=o$o;for(var o$r=this.index=0;o$r<o$o.length;o$r++){var o$T=o$o[o$r],o$k=o$T.color;this._colorKeyData[this.index++]=o$k._r,this._colorKeyData[this.index++]=o$k._g,this._colorKeyData[this.index++]=o$k._b,this._colorKeyData[this.index++]=o$T.time}}),o$x(0,o$r,"alphaKeys",function(){return this._alphaKeys},function(o$o){this._alphaKeys=o$o;for(var o$r=this.index=0;o$r<o$o.length;o$r++){var o$T=o$o[o$r];this._alphaKeyData[this.index++]=o$T.alpha,this._alphaKeyData[this.index++]=o$T.time}})}(),function(){function o$o(o$o,o$r){this._alpha=NaN,this._time=NaN,void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),this._alpha=o$o,this._time=o$r}o$v(o$o,"laya.d3.core.trail.module.GradientAlphaKey");var o$r=o$o.prototype;return o$r.cloneTo=function(o$o){o$o.alpha=this.alpha,o$o.time=this.time},o$x(0,o$r,"alpha",function(){return this._alpha},function(o$o){this._alpha=o$o}),o$x(0,o$r,"time",function(){return this._time},function(o$o){this._time=o$o}),o$o}()),o$E=function(){function o$o(o$o,o$r){this._color=null,this._time=NaN,void 0===o$r&&(o$r=0),this._color=o$o||new o$g,this._time=o$r}o$v(o$o,"laya.d3.core.trail.module.GradientColorKey");var o$r=o$o.prototype;return o$r.cloneTo=function(o$o){this.color.cloneTo(o$o.color),o$o.time=this.time},o$x(0,o$r,"color",function(){return this._color},function(o$o){this._color=o$o}),o$x(0,o$r,"time",function(){return this._time},function(o$o){this._time=o$o}),o$o}(),o$d=(function(){function o$o(){}o$v(o$o,"laya.d3.core.trail.module.GradientMode"),o$o.Blend=0,o$o.Fixed=1}(),function(){function o$o(){}o$v(o$o,"laya.d3.core.trail.module.TextureMode"),o$o.Stretch=0,o$o.Tile=1}(),function(){function o$o(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}o$v(o$o,"laya.d3.core.trail.module.TrailKeyFrame"),o$o.prototype.cloneTo=function(o$o){o$o.time=this.time,o$o.inTangent=this.inTangent,o$o.outTangent=this.outTangent,o$o.value=this.value}}(),function(){function o$r(o$o){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new o$nr,this._curPosition=new o$nr,this._delVector3=new o$nr,this._lastFixedVertexPosition=new o$nr,this._pointAtoBVector3=new o$nr,this._pointA=new o$nr,this._pointB=new o$nr,this._owner=o$o,this._id=o$r.renderElementCount++,0==this._id?o$o._owner.transform.position.cloneTo(this._lastPosition):o$o._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new o$er(o$d.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new o$er(o$d.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}o$v(o$r,"laya.d3.core.trail.TrailRenderElement");var o$o=o$r.prototype;o$S.imps(o$o,{"laya.d3.core.render.IRenderable":!0}),o$o._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},o$o._addTrailByFirstPosition=function(o$o,o$r){o$nr.subtract(o$r,o$o,this._delVector3),o$nr.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),o$nr.normalize(this._pointAtoBVector3,this._pointAtoBVector3),o$nr.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(o$o),o$o.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},o$o._addTrailByNextPosition=function(o$o){o$nr.subtract(o$o,this._lastFixedVertexPosition,this._delVector3),o$nr.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),o$nr.normalize(this._pointAtoBVector3,this._pointAtoBVector3),o$nr.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=o$nr.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=o$Eo.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(o$o),o$o.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(o$o),this._virtualVerticesCount=2)},o$o._updateVerticesByPosition=function(o$o){this._pointe=o$o.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},o$o._updateVertexBuffer2=function(){var o$o,o$r=0,o$T=0,o$k=0;for(o$k=0,o$o=(this._verticesCount+this._virtualVerticesCount)/2;o$k<o$o;o$k++)o$T=0==this._owner.textureMode?(this._VerticesToTailLength[o$k]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[o$k],this._vertices2[o$r++]=1-o$T,this._vertices2[o$r++]=1-o$T;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},o$o._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},o$o._updateDisappear=function(){var o$o,o$r=0;for(o$r=this._curDisappearIndex,o$o=(this._verticesCount+this._virtualVerticesCount)/2;o$r<o$o;o$r++)this._owner._curtime-this._everyGroupVertexBirthTime[o$r]>=this._owner.time+o$Eo.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},o$o._beforeRender=function(o$o){return this._camera=o$o.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),o$nr.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},o$o._render=function(o$o){this._isDead||(o$u.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),o$F.drawCall++,o$F.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},o$o._getVertexBuffer=function(o$o){return void 0===o$o&&(o$o=0),0===o$o?this._vertexBuffer1:1===o$o?this._vertexBuffer2:null},o$o._getVertexBuffers=function(){return this._vertexBuffers},o$o._getIndexBuffer=function(){return null},o$o.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},o$o._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},o$x(0,o$o,"_vertexBufferCount",function(){return this._vertexBuffers.length}),o$x(0,o$o,"triangleCount",function(){return 0}),o$r.renderElementCount=0}(),function(){function o$o(){}o$v(o$o,"laya.d3.core.trail.VertexTrail");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration1}),o$x(1,o$o,"vertexDeclaration1",function(){return o$o._vertexDeclaration1}),o$x(1,o$o,"vertexDeclaration2",function(){return o$o._vertexDeclaration2}),o$p(o$o,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new o$Do(32,[new o$no(0,"vector3",0),new o$no(12,"vector3",41),new o$no(24,"single",33),new o$no(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new o$Do(4,[new o$no(0,"single",38)])}]),o$o}()),o$oo=function(){function o$l(o$o){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=o$o}o$v(o$l,"laya.d3.graphics.DynamicBatch");var o$o=o$l.prototype;return o$S.imps(o$o,{"laya.d3.core.render.IRenderable":!0}),o$o._getVertexBuffer=function(o$o){return void 0===o$o&&(o$o=0),0===o$o?this._vertexBuffer:null},o$o._getIndexBuffer=function(){return this._indexBuffer},o$o._getCombineRenderElementFromPool=function(o$o,o$r,o$T){var o$k=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return o$k||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=o$k=new o$G,o$k._sprite3D=new o$wr),o$k._sprite3D._render._renderUpdate(o$T),o$k},o$o._getRenderElement=function(o$o,o$r,o$T){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*o$l.maxVertexCount),this._indexDatas=new Uint16Array(o$l.maxIndexCount),this._vertexBuffer=o$er.create(this._vertexDeclaration,o$l.maxVertexCount,35048),this._indexBuffer=o$cr.create("ushort",o$l.maxIndexCount,35048));for(var o$k=this._merageElements.length=0,o$W=0,o$D=0,o$n=this._combineRenderElements.length;o$D<o$n;o$D++){var o$V=this._combineRenderElements[o$D],o$L=o$V.getDynamicBatchBakedVertexs(0),o$U=o$V.getBakedIndices(),o$h=o$V._sprite3D.transform._isFrontFaceInvert,o$p=o$k/(this._vertexDeclaration.vertexStride/4),o$i=o$W,o$v=o$i+o$U.length;o$V._tempBatchIndexStart=o$i,o$V._tempBatchIndexEnd=o$v,this._indexDatas.set(o$U,o$W);var o$x=0;if(o$h)for(o$x=o$i;o$x<o$v;o$x+=3){this._indexDatas[o$x]=o$p+this._indexDatas[o$x];var o$j=this._indexDatas[o$x+1],o$_=this._indexDatas[o$x+2];this._indexDatas[o$x+1]=o$p+o$_,this._indexDatas[o$x+2]=o$p+o$j}else for(o$x=o$i;o$x<o$v;o$x+=3)this._indexDatas[o$x]=o$p+this._indexDatas[o$x],this._indexDatas[o$x+1]=o$p+this._indexDatas[o$x+1],this._indexDatas[o$x+2]=o$p+this._indexDatas[o$x+2];o$W+=o$U.length,this._vertexDatas.set(o$L,o$k),o$k+=o$L.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),o$D=this._combineRenderElementPoolIndex=0,o$n=this._materials.length;o$D<o$n;o$D++){var o$K=this._getCombineRenderElementFromPool(o$o,o$r,o$T);o$K._type=2,o$K._staticBatch=null;var o$$=(o$K.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[o$D]]._tempBatchIndexStart,o$y=o$D+1===this._materialToRenderElementsOffsets.length?o$W:this._combineRenderElements[this._materialToRenderElementsOffsets[o$D+1]]._tempBatchIndexStart;o$K._tempBatchIndexStart=o$$,o$K._tempBatchIndexEnd=o$y,o$K._material=this._materials[o$D],this._merageElements.push(o$K)}},o$o._addCombineRenderObjTest=function(o$o){var o$r=o$o.renderObj,o$T=this._currentCombineIndexCount+o$r._getIndexBuffer().indexCount,o$k=this._currentCombineVertexCount+o$r._getVertexBuffer().vertexCount;return!(o$l.maxVertexCount<o$k||o$l.maxIndexCount<o$T)},o$o._addCombineRenderObj=function(o$o){var o$r=o$o.renderObj;this._combineRenderElements.push(o$o),this._currentCombineIndexCount=this._currentCombineIndexCount+o$r._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+o$r._getVertexBuffer().vertexCount},o$o._addCombineMaterial=function(o$o){this._materials.push(o$o)},o$o._addMaterialToRenderElementOffset=function(o$o){this._materialToRenderElementsOffsets.push(o$o)},o$o._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},o$o._addToRenderQueue=function(o$o,o$r,o$T,o$k){this._getRenderElement(o$r,o$T,o$k);for(var o$W=0,o$D=this._materials.length;o$W<o$D;o$W++)o$o.getRenderQueue(this._materials[o$W].renderQueue)._addDynamicBatchElement(this._merageElements[o$W])},o$o._beforeRender=function(o$o){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},o$o._render=function(o$o){var o$r=o$o._batchIndexEnd-o$o._batchIndexStart;o$u.mainContext.drawElements(4,o$r,5123,2*o$o._batchIndexStart),o$F.drawCall++,o$F.trianglesFaces+=o$r/3},o$o._getVertexBuffers=function(){return null},o$x(0,o$o,"_vertexBufferCount",function(){return 1}),o$x(0,o$o,"triangleCount",function(){return this._indexBuffer.indexCount/3}),o$x(0,o$o,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),o$l.maxVertexCount=2e4,o$l.maxIndexCount=4e4,o$l.maxCombineTriangleCount=10,o$l}(),o$ro=function(){function o$l(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}o$v(o$l,"laya.d3.graphics.DynamicBatchManager");var o$o=o$l.prototype;return o$o.getDynamicBatch=function(o$o,o$r){var o$T,o$k=o$o.id.toString()+o$r;return this._dynamicBatches[o$k]?o$T=this._dynamicBatches[o$k]:this._dynamicBatches[o$k]=o$T=new o$oo(o$o),o$T},o$o._garbageCollection=function(){for(var o$o in this._dynamicBatches)0===this._dynamicBatches[o$o].combineRenderElementsCount&&delete this._dynamicBatches[o$o]},o$o._addPrepareRenderElement=function(o$o){this._prepareDynamicBatchCombineElements.push(o$o)},o$o._finishCombineDynamicBatch=function(o$o){var o$r,o$T,o$k;this._prepareDynamicBatchCombineElements.sort(o$l._sortPrepareDynamicBatch);for(var o$W,o$D,o$n,o$V,o$L,o$U=-1,o$h=!0,o$p=0,o$i=-1,o$v=0,o$x=this._prepareDynamicBatchCombineElements.length;o$v<o$x;o$v++){var o$j=(o$D=this._prepareDynamicBatchCombineElements[o$v]).renderObj._getVertexBuffer(0).vertexDeclaration,o$_=o$T!==o$j;o$_&&(o$p=0,o$T=o$j);var o$K=o$p!==o$U;if(o$K&&(o$U=o$p),(o$_||o$K)&&(o$n=this.getDynamicBatch(o$j,o$p),o$r=null),o$h)if(o$n._addCombineRenderObjTest(o$D)){if(o$r!==(o$W=o$D._material))o$V&&(o$o.getRenderQueue(o$L._material.renderQueue)._addRenderElement(o$L),o$L=o$V=null,o$i=-1),o$V=o$W,o$i=o$n.combineRenderElementsCount,o$L=o$D,o$r=o$W;else if(o$V){var o$$=o$L.renderObj,o$y=o$D.renderObj;o$$._getVertexBuffer().vertexCount+o$y._getVertexBuffer().vertexCount>o$oo.maxVertexCount||o$$._getIndexBuffer().indexCount+o$y._getIndexBuffer().indexCount>o$oo.maxIndexCount?(o$o.getRenderQueue(o$L._material.renderQueue)._addRenderElement(o$L),o$V=o$W,o$i=o$n.combineRenderElementsCount,o$L=o$D):(o$n._addCombineMaterial(o$V),o$n._addMaterialToRenderElementOffset(o$i),o$n._addCombineRenderObj(o$L),o$L=o$V=null,o$i=-1,o$n._addCombineRenderObj(o$D))}else o$n._addCombineRenderObj(o$D);o$h=!0}else o$V&&(o$o.getRenderQueue(o$L._material.renderQueue)._addRenderElement(o$L),o$L=o$V=null,o$i=-1),o$p++,o$h=!1;else o$k=this._prepareDynamicBatchCombineElements[o$v-1],o$n._addMaterialToRenderElementOffset(o$n.combineRenderElementsCount),o$r=o$k._material,o$n._addCombineMaterial(o$r),o$n._addCombineRenderObj(o$k),o$h=!0,o$r!==(o$W=o$D._material)?(o$V=o$W,o$i=o$n.combineRenderElementsCount,o$L=o$D):o$n._addCombineRenderObj(o$D),o$r=o$W}o$V&&(o$o.getRenderQueue(o$L._material.renderQueue)._addRenderElement(o$L),o$L=o$V=null,o$i=-1),this._prepareDynamicBatchCombineElements.length=0},o$o._clearRenderElements=function(){for(var o$o in this._dynamicBatches)this._dynamicBatches[o$o]._clearRenderElements()},o$o._addToRenderQueue=function(o$o,o$r,o$T,o$k){for(var o$W in this._dynamicBatches){var o$D=this._dynamicBatches[o$W];0<o$D.combineRenderElementsCount&&o$D._addToRenderQueue(o$o,o$r,o$T,o$k)}},o$o.dispose=function(){this._dynamicBatches=null},o$l._sortPrepareDynamicBatch=function(o$o,o$r){return o$o._mainSortID-o$r._mainSortID},o$l}(),o$To=function(){function o$o(){}return o$v(o$o,"laya.d3.graphics.FrustumCulling"),o$o.renderShadowObjectCulling=function(o$o,o$r,o$T,o$k,o$W){var o$D=0,o$n=0,o$V=0,o$L=0;for(o$D=0,o$V=o$T.length;o$D<o$V;o$D++){var o$U=o$T[o$D];o$U&&o$U._clearRenderElements()}var o$h,o$p,o$i,o$v=o$o._cullingRenders;if(1<o$W){for(o$D=0,o$V=o$o._cullingRendersLength;o$D<o$V;o$D++)if((o$h=o$v[o$D]).castShadow&&o$m.isVisible(o$h._owner.layer.mask)&&o$h.enable)for(var o$x=1,o$j=o$r.length;o$x<o$j;o$x++)if(o$p=o$T[o$x-1],0!==o$r[o$x].containsBoundSphere(o$h.boundingSphere))for(o$n=0,o$L=(o$i=o$h._renderElements).length;o$n<o$L;o$n++)o$p._addRenderElement(o$i[o$n])}else for(o$D=0,o$V=o$o._cullingRendersLength;o$D<o$V;o$D++)if((o$h=o$v[o$D]).castShadow&&o$m.isVisible(o$h._owner.layer.mask)&&o$h.enable&&0!==o$r[0].containsBoundSphere(o$h.boundingSphere))for(o$h._renderUpdate(o$k),o$p=o$T[0],o$n=0,o$L=(o$i=o$h._renderElements).length;o$n<o$L;o$n++)o$p._addRenderElement(o$i[o$n])},o$o.renderShadowObjectCullingOctree=function(o$o,o$r,o$T,o$k,o$W){for(var o$D=0,o$n=o$T.length;o$D<o$n;o$D++){var o$V=o$T[o$D];o$V&&o$V._clearRenderElements()}1<o$W?o$o.treeRoot.cullingShadowObjects(o$r,o$T,!0,0,o$o):o$o.treeRoot.cullingShadowObjectsOnePSSM(o$r[0],o$T,o$k,!0,0,o$o)},o$o.renderObjectCulling=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=0,o$V=0,o$L=0,o$U=0,o$h=o$r._quenes,o$p=o$r._dynamicBatchManager,o$i=o$r._cullingRenders;for(o$n=0,o$V=o$h.length;o$n<o$V;o$n++){var o$v=o$h[o$n];o$v&&o$v._clearRenderElements()}var o$x=o$ko._staticBatchManagers;for(o$n=0,o$V=o$x.length;o$n<o$V;o$n++)o$x[o$n]._clearRenderElements();o$p._clearRenderElements();var o$j=o$T.transform.position;for(o$n=0,o$V=o$r._cullingRendersLength;o$n<o$V;o$n++){var o$_=o$i[o$n];if(o$m.isVisible(o$_._owner.layer.mask)&&o$_.enable&&0!==o$o.containsBoundSphere(o$_.boundingSphere)&&o$_._renderUpdate(o$D)){o$_._distanceForSort=o$nr.distance(o$_.boundingSphere.center,o$j)+o$_.sortingFudge;var o$K=o$_._renderElements;for(o$L=0,o$U=o$K.length;o$L<o$U;o$L++){var o$$=o$K[o$L],o$y=o$$._staticBatch;if(o$y&&o$y._material===o$$._material)o$y._addBatchRenderElement(o$$);else{var o$l=o$$.renderObj;o$l.triangleCount<10&&1===o$l._vertexBufferCount&&o$l._getIndexBuffer()&&o$$._material.renderQueue<2&&o$$._canDynamicBatch&&!o$_._owner.isStatic?o$p._addPrepareRenderElement(o$$):o$r.getRenderQueue(o$$._material.renderQueue)._addRenderElement(o$$)}}}}for(o$n=0,o$V=o$x.length;o$n<o$V;o$n++)o$x[o$n]._addToRenderQueue(o$r,o$k,o$W,o$D);o$p._finishCombineDynamicBatch(o$r),o$p._addToRenderQueue(o$r,o$k,o$W,o$D)},o$o.renderObjectCullingOctree=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=0,o$V=0,o$L=o$r._quenes,o$U=o$r._dynamicBatchManager;for(o$n=0,o$V=o$L.length;o$n<o$V;o$n++){var o$h=o$L[o$n];o$h&&o$h._clearRenderElements()}var o$p=o$ko._staticBatchManagers;for(o$n=0,o$V=o$p.length;o$n<o$V;o$n++)o$p[o$n]._clearRenderElements();for(o$U._clearRenderElements(),o$r._cullingRenders.length=0,o$r.treeRoot.cullingObjects(o$o,!0,0,o$T.transform.position,o$D),o$n=0,o$V=o$p.length;o$n<o$V;o$n++)o$p[o$n]._addToRenderQueue(o$r,o$k,o$W,o$D);o$U._finishCombineDynamicBatch(o$r),o$U._addToRenderQueue(o$r,o$k,o$W,o$D)},o$o.renderObjectCullingNoBoundFrustum=function(o$o,o$r,o$T,o$k,o$W){var o$D=0,o$n=0,o$V=0,o$L=0,o$U=o$o._quenes,o$h=o$o._dynamicBatchManager,o$p=o$o._cullingRenders;for(o$D=0,o$n=o$U.length;o$D<o$n;o$D++){var o$i=o$U[o$D];o$i&&o$i._clearRenderElements()}var o$v=o$ko._staticBatchManagers;for(o$D=0,o$n=o$v.length;o$D<o$n;o$D++)o$v[o$D]._clearRenderElements();o$h._clearRenderElements();var o$x=o$r.transform.position;for(o$D=0,o$n=o$o._cullingRendersLength;o$D<o$n;o$D++){var o$j=o$p[o$D];if(o$m.isVisible(o$j._owner.layer.mask)&&o$j.enable){o$j._renderUpdate(o$W),o$j._distanceForSort=o$nr.distance(o$j.boundingSphere.center,o$x)+o$j.sortingFudge;var o$_=o$j._renderElements;for(o$V=0,o$L=o$_.length;o$V<o$L;o$V++){var o$K=o$_[o$V],o$$=o$K._staticBatch;if(o$$&&o$$._material===o$K._material)o$$._addBatchRenderElement(o$K);else{var o$y=o$K.renderObj;o$y.triangleCount<10&&1===o$y._vertexBufferCount&&o$y._getIndexBuffer()&&o$K._material.renderQueue<2&&o$K._canDynamicBatch&&!o$j._owner.isStatic?o$h._addPrepareRenderElement(o$K):o$o.getRenderQueue(o$K._material.renderQueue)._addRenderElement(o$K)}}}}for(o$D=0,o$n=o$v.length;o$D<o$n;o$D++)o$v[o$D]._addToRenderQueue(o$o,o$T,o$k,o$W);o$h._finishCombineDynamicBatch(o$o),o$h._addToRenderQueue(o$o,o$T,o$k,o$W)},o$o}(),o$ko=function(){function o$D(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}o$v(o$D,"laya.d3.graphics.StaticBatchManager");var o$o=o$D.prototype;return o$o._finishInit=function(){for(var o$o in this._staticBatches)this._staticBatches[o$o]._finishInit();this._initBatchRenderElements.length=0},o$o._initStaticBatchs=function(o$o){throw new Error("StaticBatchManager:must override this function.")},o$o._addInitBatchSprite=function(o$o){for(var o$r=o$o._render._renderElements,o$T=0,o$k=o$r.length;o$T<o$k;o$T++)this._initBatchRenderElements.push(o$r[o$T])},o$o._clearRenderElements=function(){for(var o$o in this._staticBatches)this._staticBatches[o$o]._clearRenderElements()},o$o._garbageCollection=function(o$o){var o$r=o$o._staticBatch,o$T=o$r._initBatchRenderElements,o$k=o$T.indexOf(o$o);o$T.splice(o$k,1),0===o$T.length&&(o$r.dispose(),delete this._staticBatches[o$r._key])},o$o._addToRenderQueue=function(o$o,o$r,o$T,o$k){for(var o$W in this._staticBatches){var o$D=this._staticBatches[o$W];0<o$D._batchRenderElements.length&&o$D._updateToRenderQueue(o$o,o$k)}},o$o.dispose=function(){this._staticBatches=null},o$D._addToStaticBatchQueue=function(o$o){o$o instanceof laya.d3.core.RenderableSprite3D&&o$o._addToInitStaticBatchManager();for(var o$r=0,o$T=o$o.numChildren;o$r<o$T;o$r++)o$D._addToStaticBatchQueue(o$o._childs[o$r])},o$D.combine=function(o$o,o$r){var o$T,o$k=0,o$W=0;if(o$r)for(o$k=0,o$W=o$r.length;o$k<o$W;o$k++){o$r[o$k]._addToInitStaticBatchManager()}else o$o&&o$D._addToStaticBatchQueue(o$o);for(o$k=0,o$W=o$D._staticBatchManagers.length;o$k<o$W;o$k++)(o$T=o$D._staticBatchManagers[o$k])._initStaticBatchs(o$o),o$T._finishInit()},o$D._staticBatchManagers=[],o$D}(),o$Wo=function(){function o$o(o$o,o$r,o$T){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=o$o,this._manager=o$r,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=o$T}o$v(o$o,"laya.d3.graphics.StaticBatch");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),o$r._binarySearch=function(o$o){for(var o$r=0,o$T=this._batchRenderElements.length-1,o$k=0;o$r<=o$T;)o$k=Math.floor((o$r+o$T)/2),this._compareBatchRenderElement(this._batchRenderElements[o$k],o$o)?o$T=o$k-1:o$r=o$k+1;return o$r},o$r._compareBatchRenderElement=function(o$o,o$r){throw new Error("StaticBatch:must override this function.")},o$r._getVertexDecLightMap=function(o$o){return o$o===o$co.vertexDeclaration?o$mo.vertexDeclaration:o$o===o$Mo.vertexDeclaration?o$zo.vertexDeclaration:o$o===o$Po.vertexDeclaration?o$lo.vertexDeclaration:o$o===o$Ao.vertexDeclaration?null:o$o===o$jo.vertexDeclaration?o$_o.vertexDeclaration:o$o===o$Jo.vertexDeclaration?o$Xo.vertexDeclaration:o$o===o$uo.vertexDeclaration?o$so.vertexDeclaration:o$o===o$eo.vertexDeclaration?o$Co.vertexDeclaration:o$o===o$Mo.vertexDeclaration?o$zo.vertexDeclaration:o$o===o$to.vertexDeclaration?o$So.vertexDeclaration:o$o===o$Ao.vertexDeclaration?null:o$o===o$jo.vertexDeclaration?o$_o.vertexDeclaration:o$o===o$Yo.vertexDeclaration?o$Oo.vertexDeclaration:o$o===o$uo.vertexDeclaration?o$so.vertexDeclaration:o$o},o$r._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},o$r._addBatchRenderElement=function(o$o){this._batchRenderElements.splice(this._binarySearch(o$o),0,o$o)},o$r._updateToRenderQueue=function(o$o,o$r){this._combineRenderElementPoolIndex=0,this._getRenderElement(o$o.getRenderQueue(this._material.renderQueue)._renderElements,o$o,o$r)},o$r._getRenderElement=function(o$o,o$r,o$T){throw new Error("StaticBatch:must override this function.")},o$r._finishInit=function(){throw new Error("StaticBatch:must override this function.")},o$r._clearRenderElements=function(){this._batchRenderElements.length=0},o$r.dispose=function(){},o$r._getVertexBuffer=function(o$o){return void 0===o$o&&(o$o=0),null},o$r._getIndexBuffer=function(){return null},o$r._beforeRender=function(o$o){return!0},o$r._render=function(o$o){},o$r._getVertexBuffers=function(){return null},o$x(0,o$r,"_vertexBufferCount",function(){return 1}),o$x(0,o$r,"triangleCount",function(){return 0}),o$o.combine=function(o$o){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),o$ko.combine(o$o)},o$o.maxBatchVertexCount=65535,o$o}(),o$Do=function(){function o$n(o$o,o$r){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++o$n._uniqueIDCounter,this._id>o$n.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",o$n.maxVertexDeclaration);this._shaderValues=new o$ir,this._vertexElementsDic={},this._vertexStride=o$o,this._vertexElements=o$r;for(var o$T=0;o$T<o$r.length;o$T++){var o$k=o$r[o$T],o$W=o$k.elementUsage;this._vertexElementsDic[o$W]=o$k;var o$D=[o$n._getTypeSize(o$k.elementFormat)/4,5126,!1,this._vertexStride,o$k.offset];switch(this._shaderValues.setValue(o$W,o$D),o$W){case 1:this._addShaderDefine(o$Fr.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(o$Fr.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(o$Fr.SHADERDEFINE_UV1)}}}o$v(o$n,"laya.d3.graphics.VertexDeclaration");var o$o=o$n.prototype;return o$o._addShaderDefine=function(o$o){this._shaderDefineValue|=o$o},o$o._removeShaderDefine=function(o$o){this._shaderDefineValue&=~o$o},o$o.getVertexElements=function(){return this._vertexElements.slice()},o$o.getVertexElementByUsage=function(o$o){return this._vertexElementsDic[o$o]},o$o.unBinding=function(){},o$x(0,o$o,"shaderDefineValue",function(){return this._shaderDefineValue}),o$x(0,o$o,"id",function(){return this._id}),o$x(0,o$o,"vertexStride",function(){return this._vertexStride}),o$x(0,o$o,"shaderValues",function(){return this._shaderValues}),o$n._getTypeSize=function(o$o){switch(o$o){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},o$n.getVertexStride=function(o$o){for(var o$r=0,o$T=0;o$T<o$o.Length;o$T++){var o$k=o$o[o$T],o$W=o$k.offset+o$n._getTypeSize(o$k.elementFormat);o$r<o$W&&(o$r=o$W)}return o$r},o$n._maxVertexDeclarationBit=1e3,o$n._uniqueIDCounter=1,o$p(o$n,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),o$n}(),o$no=function(){function o$o(o$o,o$r,o$T){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=o$o,this.elementFormat=o$r,this.elementUsage=o$T}return o$v(o$o,"laya.d3.graphics.VertexElement"),o$o}(),o$Vo=(function(){function o$o(){}o$v(o$o,"laya.d3.graphics.VertexElementFormat"),o$o.Single="single",o$o.Vector2="vector2",o$o.Vector3="vector3",o$o.Vector4="vector4",o$o.Color="color",o$o.Byte4="byte4",o$o.Short2="short2",o$o.Short4="short4",o$o.NormalizedShort2="normalizedshort2",o$o.NormalizedShort4="normalizedshort4",o$o.HalfVector2="halfvector2",o$o.HalfVector4="halfvector4"}(),function(){function o$o(){}o$v(o$o,"laya.d3.graphics.VertexElementUsage"),o$o.POSITION0=0,o$o.COLOR0=1,o$o.TEXTURECOORDINATE0=2,o$o.NORMAL0=3,o$o.BINORMAL0=4,o$o.TANGENT0=5,o$o.BLENDINDICES0=6,o$o.BLENDWEIGHT0=7,o$o.DEPTH0=8,o$o.FOG0=9,o$o.POINTSIZE0=10,o$o.SAMPLE0=11,o$o.TESSELLATEFACTOR0=12,o$o.COLOR1=13,o$o.NEXTTEXTURECOORDINATE0=14,o$o.TEXTURECOORDINATE1=15,o$o.NEXTTEXTURECOORDINATE1=16,o$o.CORNERTEXTURECOORDINATE0=17,o$o.VELOCITY0=18,o$o.STARTCOLOR0=19,o$o.STARTSIZE=20,o$o.AGEADDSCALE0=21,o$o.STARTROTATION=22,o$o.ENDCOLOR0=23,o$o.STARTLIFETIME=24,o$o.TIME0=33,o$o.SHAPEPOSITIONSTARTLIFETIME=30,o$o.DIRECTIONTIME=32,o$o.SIZEROTATION0=27,o$o.RADIUS0=28,o$o.RADIAN0=29,o$o.STARTSPEED=31,o$o.RANDOM0=34,o$o.RANDOM1=35,o$o.SIMULATIONWORLDPOSTION=36,o$o.SIMULATIONWORLDROTATION=37,o$o.TEXTURECOORDINATE0X=38,o$o.TEXTURECOORDINATE0X1=39,o$o.TEXTURECOORDINATE0Y=40,o$o.OFFSETVECTOR=41}(),function(){function o$o(o$o,o$r,o$T){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=o$o,this._textureCoordinate0=o$r,this._time=o$T}o$v(o$o,"laya.d3.graphics.VertexGlitter");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate0}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"time",function(){return this._time}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(24,[new o$no(0,"vector3",0),new o$no(12,"vector2",2),new o$no(20,"single",33)])}])}(),function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=o$o,this._position=o$r,this._velocity=o$T,this._startColor=o$k,this._endColor=o$W,this._sizeRotation=o$D,this._radius=o$n,this._radian=o$V,this._ageAddScale=o$L,this._time=o$U}o$v(o$o,"laya.d3.graphics.VertexParticle");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"endColor",function(){return this._endColor}),o$x(0,o$r,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),o$x(0,o$r,"sizeRotation",function(){return this._sizeRotation}),o$x(0,o$r,"velocity",function(){return this._velocity}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"startColor",function(){return this._startColor}),o$x(0,o$r,"radius",function(){return this._radius}),o$x(0,o$r,"radian",function(){return this._radian}),o$x(0,o$r,"ageAddScale",function(){return this._ageAddScale}),o$x(0,o$r,"time",function(){return this._time}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(116,[new o$no(0,"vector4",17),new o$no(16,"vector3",0),new o$no(28,"vector3",18),new o$no(40,"vector4",19),new o$no(56,"vector4",23),new o$no(72,"vector3",27),new o$no(84,"vector2",28),new o$no(92,"vector4",29),new o$no(108,"single",24),new o$no(112,"single",33)])}])}(),function(){function o$o(o$o){this._position=null,this._position=o$o}o$v(o$o,"laya.d3.graphics.VertexPosition");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(12,[new o$no(0,"vector3",0)])}]),o$o}()),o$Lo=function(){function o$o(o$o,o$r){this._position=null,this._normal=null,this._position=o$o,this._normal=o$r}o$v(o$o,"laya.d3.graphics.VertexPositionNormal");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(24,[new o$no(0,"vector3",0),new o$no(12,"vector3",3)])}]),o$o}(),o$Uo=function(){function o$o(o$o,o$r,o$T){this._position=null,this._normal=null,this._color=null,this._position=o$o,this._normal=o$r,this._color=o$T}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColor");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(40,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1)])}]),o$o}(),o$ho=function(){function o$o(o$o,o$r,o$T,o$k,o$W){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._blendIndex=o$k,this._blendWeight=o$W}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorSkin");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(72,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector4",7),new o$no(56,"vector4",6)])}]),o$o}(),o$po=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._tangent=o$k,this._blendIndex=o$W,this._blendWeight=o$D}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(88,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector4",7),new o$no(56,"vector4",6),new o$no(72,"vector4",5)])}]),o$o}(),o$io=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._tangent=o$k,this._blendIndex=o$W,this._blendWeight=o$D}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(84,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector4",7),new o$no(56,"vector4",6),new o$no(72,"vector3",5)])}]),o$o}(),o$vo=function(){function o$o(o$o,o$r,o$T,o$k){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._tangent=o$k}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorSTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(56,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector4",5)])}]),o$o}(),o$xo=function(){function o$o(o$o,o$r,o$T,o$k){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._tangent=o$k}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(52,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector3",5)])}]),o$o}(),o$jo=function(){function o$o(o$o,o$r,o$T,o$k){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._textureCoordinate=o$k}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorTexture");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(48,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector2",2)])}]),o$o}(),o$_o=function(){function o$o(o$o,o$r,o$T,o$k,o$W){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._textureCoordinate0=o$k,this._textureCoordinate1=o$W}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(0,o$r,"textureCoordinate1",function(){return this._textureCoordinate1}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(56,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector2",2),new o$no(48,"vector2",15)])}]),o$o}(),o$Ko=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._textureCoordinate0=o$k,this._textureCoordinate1=o$W,this._blendIndex=o$D,this._blendWeight=o$n}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(0,o$r,"textureCoordinate1",function(){return this._textureCoordinate1}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(88,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector2",2),new o$no(48,"vector2",15),new o$no(56,"vector4",7),new o$no(72,"vector4",6)])}]),o$o}(),o$$o=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._textureCoordinate0=o$k,this._textureCoordinate1=o$W,this._tangent=o$D,this._blendIndex=o$n,this._blendWeight=o$V}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(0,o$r,"textureCoordinate1",function(){return this._textureCoordinate1}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(104,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector2",2),new o$no(48,"vector2",15),new o$no(56,"vector4",7),new o$no(72,"vector4",6),new o$no(88,"vector4",5)])}]),o$o}(),o$yo=function(){function o$o(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$r.VertexPositionNormalColorTexture0SkinTangent=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){this._position=o$o,this._normal=o$r,this._color=o$T,this._textureCoordinate0=o$k,this._textureCoordinate1=o$W,this._tangent=o$D,this._blendIndex=o$n,this._blendWeight=o$V},o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(0,o$r,"textureCoordinate1",function(){return this._textureCoordinate1}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(100,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector2",2),new o$no(48,"vector2",15),new o$no(56,"vector4",7),new o$no(72,"vector4",6),new o$no(88,"vector3",5)])}]),o$o}(),o$lo=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._textureCoordinate0=o$k,this._textureCoordinate1=o$W,this._tangent=o$D}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(0,o$r,"textureCoordinate1",function(){return this._textureCoordinate1}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(72,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector2",2),new o$no(48,"vector2",15),new o$no(56,"vector4",5)])}]),o$o}(),o$So=function(){function o$o(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$r.VertexPositionNormalColorTexture0Tangent=function(o$o,o$r,o$T,o$k,o$W,o$D){this._position=o$o,this._normal=o$r,this._color=o$T,this._textureCoordinate0=o$k,this._textureCoordinate1=o$W,this._tangent=o$D},o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(0,o$r,"textureCoordinate1",function(){return this._textureCoordinate1}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(68,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector2",2),new o$no(48,"vector2",15),new o$no(56,"vector3",5)])}]),o$o}(),o$qo=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._textureCoordinate=o$k,this._blendIndex=o$W,this._blendWeight=o$D}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(80,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector2",2),new o$no(48,"vector4",7),new o$no(64,"vector4",6)])}]),o$o}(),o$bo=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._textureCoordinate=o$k,this._tangent=o$W,this._blendIndex=o$D,this._blendWeight=o$n}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(96,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector2",2),new o$no(48,"vector4",7),new o$no(64,"vector4",6),new o$no(80,"vector4",5)])}]),o$o}(),o$Fo=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._textureCoordinate=o$k,this._tangent=o$W,this._blendIndex=o$D,this._blendWeight=o$n}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(92,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector2",2),new o$no(48,"vector4",7),new o$no(64,"vector4",6),new o$no(80,"vector3",5)])}]),o$o}(),o$Po=function(){function o$o(o$o,o$r,o$T,o$k,o$W){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._textureCoordinate=o$k,this._tangent=o$W}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(64,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector2",2),new o$no(48,"vector4",5)])}]),o$o}(),o$to=function(){function o$o(o$o,o$r,o$T,o$k,o$W){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._color=o$T,this._textureCoordinate=o$k,this._tangent=o$W}o$v(o$o,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"color",function(){return this._color}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(60,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",1),new o$no(40,"vector2",2),new o$no(48,"vector3",5)])}]),o$o}(),o$Ho=function(){function o$o(o$o,o$r,o$T){this._position=null,this._normal=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._tangent=o$T}o$v(o$o,"laya.d3.graphics.VertexPositionNormalSTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(40,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector4",5)])}]),o$o}(),o$Ro=function(){function o$o(o$o,o$r,o$T){this._position=null,this._normal=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._tangent=o$T}o$v(o$o,"laya.d3.graphics.VertexPositionNormalTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(36,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector3",5)])}]),o$o}(),o$uo=function(){function o$o(o$o,o$r,o$T){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=o$o,this._normal=o$r,this._textureCoordinate=o$T}o$v(o$o,"laya.d3.graphics.VertexPositionNormalTexture");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(32,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector2",2)])}]),o$o}(),o$so=function(){function o$o(o$o,o$r,o$T,o$k){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=o$o,this._normal=o$r,this._textureCoordinate0=o$T,this._textureCoordinate1=o$k}o$v(o$o,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(0,o$r,"textureCoordinate1",function(){return this._textureCoordinate1}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(40,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector2",2),new o$no(32,"vector2",15)])}]),o$o}(),o$zo=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=o$o,this._normal=o$r,this._textureCoordinate0=o$T,this._textureCoordinate1=o$k,this._blendIndex=o$W,this._blendWeight=o$D}o$v(o$o,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(0,o$r,"textureCoordinate1",function(){return this._textureCoordinate1}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(72,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector2",2),new o$no(32,"vector2",15),new o$no(40,"vector4",7),new o$no(56,"vector4",6)])}]),o$o}(),o$mo=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._textureCoordinate0=o$T,this._textureCoordinate1=o$k,this._tangent=o$W,this._blendIndex=o$D,this._blendWeight=o$n}o$v(o$o,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(0,o$r,"textureCoordinate1",function(){return this._textureCoordinate1}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(88,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector2",2),new o$no(32,"vector2",15),new o$no(40,"vector4",7),new o$no(56,"vector4",6),new o$no(72,"vector4",5)])}]),o$o}(),o$Co=function(){function o$o(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}o$v(o$o,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$r.VertexPositionNormalTexture0SkinTangent=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){this._position=o$o,this._normal=o$r,this._textureCoordinate0=o$T,this._textureCoordinate1=o$k,this._tangent=o$W,this._blendIndex=o$D,this._blendWeight=o$n},o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(0,o$r,"textureCoordinate1",function(){return this._textureCoordinate1}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(84,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector2",2),new o$no(32,"vector2",15),new o$no(40,"vector4",7),new o$no(56,"vector4",6),new o$no(72,"vector3",5)])}]),o$o}(),o$Xo=function(){function o$o(o$o,o$r,o$T,o$k,o$W){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._textureCoordinate0=o$T,this._textureCoordinate1=o$k,this._tangent=o$W}o$v(o$o,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(0,o$r,"textureCoordinate1",function(){return this._textureCoordinate1}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(56,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector2",2),new o$no(32,"vector2",15),new o$no(40,"vector4",5)])}]),o$o}(),o$Oo=function(){function o$o(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}o$v(o$o,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$r.VertexPositionNormalTexture0Tangent=function(o$o,o$r,o$T,o$k,o$W){this._position=o$o,this._normal=o$r,this._textureCoordinate0=o$T,this._textureCoordinate1=o$k,this._tangent=o$W},o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(0,o$r,"textureCoordinate1",function(){return this._textureCoordinate1}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(52,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector2",2),new o$no(32,"vector2",15),new o$no(40,"vector3",5)])}]),o$o}(),o$Mo=function(){function o$o(o$o,o$r,o$T,o$k,o$W){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=o$o,this._normal=o$r,this._textureCoordinate=o$T,this._blendIndex=o$k,this._blendWeight=o$W}o$v(o$o,"laya.d3.graphics.VertexPositionNormalTextureSkin");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(64,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector2",2),new o$no(32,"vector4",7),new o$no(48,"vector4",6)])}]),o$o}(),o$co=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._textureCoordinate=o$T,this._tangent=o$k,this._blendIndex=o$W,this._blendWeight=o$D}o$v(o$o,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(80,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector2",2),new o$no(32,"vector4",7),new o$no(48,"vector4",6),new o$no(64,"vector4",5)])}]),o$o}(),o$eo=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._textureCoordinate=o$T,this._tangent=o$k,this._blendIndex=o$W,this._blendWeight=o$D}o$v(o$o,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(76,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector2",2),new o$no(32,"vector4",7),new o$no(48,"vector4",6),new o$no(64,"vector3",5)])}]),o$o}(),o$Jo=function(){function o$o(o$o,o$r,o$T,o$k){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._textureCoordinate=o$T,this._tangent=o$k}o$v(o$o,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(48,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector2",2),new o$no(32,"vector4",5)])}]),o$o}(),o$Yo=function(){function o$o(o$o,o$r,o$T,o$k){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=o$o,this._normal=o$r,this._textureCoordinate=o$T,this._tangent=o$k}o$v(o$o,"laya.d3.graphics.VertexPositionNormalTextureTangent");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(44,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector2",2),new o$no(32,"vector3",5)])}]),o$o}(),o$Ao=function(){function o$o(o$o,o$r,o$T){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=o$o,this._normal=o$r,this._textureCoordinate=o$T}o$v(o$o,"laya.d3.graphics.VertexPositionNTBTexture");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(56,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector3",5),new o$no(36,"vector3",4),new o$no(48,"vector2",2)])}]),o$o}(),o$Io=function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=o$o,this._normal=o$r,this._textureCoordinate0=o$k,this._textureCoordinate1=o$W,this._tangent=o$D,o$T=o$T,this._blendIndex=o$n,this._blendWeight=o$V}o$v(o$o,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"tangent",function(){return this._tangent}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(0,o$r,"textureCoordinate1",function(){return this._textureCoordinate1}),o$x(0,o$r,"blendIndex",function(){return this._blendIndex}),o$x(0,o$r,"blendWeight",function(){return this._blendWeight}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(96,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector3",5),new o$no(36,"vector3",4),new o$no(48,"vector2",2),new o$no(56,"vector2",15),new o$no(64,"vector4",7),new o$no(80,"vector4",6)])}]),o$o}(),o$No=function(){function o$o(o$o,o$r,o$T){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=o$o,this._normal=o$r,this._textureCoordinate=o$T}o$v(o$o,"laya.d3.graphics.VertexPositionNTBTextureSkin");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"textureCoordinate",function(){return this._textureCoordinate}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(88,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector3",5),new o$no(36,"vector3",4),new o$no(48,"vector2",2),new o$no(56,"vector4",7),new o$no(72,"vector4",6)])}]),o$o}(),o$fo=(function(){function o$o(o$o,o$r,o$T,o$k){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=o$o,this._normal=o$r,this._textureCoord0=o$T,this._textureCoord1=o$k}o$v(o$o,"laya.d3.graphics.VertexPositionTerrain");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"normal",function(){return this._normal}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"textureCoord0",function(){return this._textureCoord0}),o$x(0,o$r,"textureCoord1",function(){return this._textureCoord1}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(40,[new o$no(0,"vector3",0),new o$no(12,"vector3",3),new o$no(24,"vector2",2),new o$no(32,"vector2",15)])}])}(),function(){function o$o(o$o,o$r){this._position=null,this._textureCoordinate0=null,this._position=o$o,this._textureCoordinate0=o$r}o$v(o$o,"laya.d3.graphics.VertexPositionTexture0");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"position",function(){return this._position}),o$x(0,o$r,"textureCoordinate0",function(){return this._textureCoordinate0}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(20,[new o$no(0,"vector3",0),new o$no(12,"vector2",2)])}]),o$o}()),o$ao=(function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h,o$p,o$i,o$v){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=o$o,this._positionStartLifeTime=o$r,this._velocity=o$T,this._startColor=o$k,this._startSize=o$W,this._startRotation0=o$D,this._startRotation1=o$n,this._startRotation2=o$V,this._startLifeTime=o$L,this._time=o$U,this._startSpeed=o$h,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=o$v}o$v(o$o,"laya.d3.graphics.VertexShurikenParticleBillboard");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),o$x(0,o$r,"random1",function(){return this._randoms1}),o$x(0,o$r,"startRotation2",function(){return this._startRotation2}),o$x(0,o$r,"positionStartLifeTime",function(){return this._positionStartLifeTime}),o$x(0,o$r,"velocity",function(){return this._velocity}),o$x(0,o$r,"random0",function(){return this._randoms0}),o$x(0,o$r,"startSize",function(){return this._startSize}),o$x(0,o$r,"startColor",function(){return this._startColor}),o$x(0,o$r,"startRotation0",function(){return this._startRotation0}),o$x(0,o$r,"startRotation1",function(){return this._startRotation1}),o$x(0,o$r,"startLifeTime",function(){return this._startLifeTime}),o$x(0,o$r,"time",function(){return this._time}),o$x(0,o$r,"startSpeed",function(){return this._startSpeed}),o$x(0,o$r,"simulationWorldPostion",function(){return this._simulationWorldPostion}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(152,[new o$no(0,"vector4",17),new o$no(16,"vector4",30),new o$no(32,"vector4",32),new o$no(48,"vector4",19),new o$no(64,"vector3",20),new o$no(76,"vector3",22),new o$no(88,"single",31),new o$no(92,"vector4",34),new o$no(108,"vector4",35),new o$no(124,"vector3",36),new o$no(136,"vector4",37)])}])}(),function(){function o$o(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h,o$p,o$i,o$v){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=o$o,this._positionStartLifeTime=o$r,this._velocity=o$T,this._startColor=o$k,this._startSize=o$W,this._startRotation0=o$D,this._startRotation1=o$n,this._startRotation2=o$V,this._startLifeTime=o$L,this._time=o$U,this._startSpeed=o$h,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=o$v}o$v(o$o,"laya.d3.graphics.VertexShurikenParticleMesh");var o$r=o$o.prototype;o$S.imps(o$r,{"laya.d3.graphics.IVertex":!0}),o$x(0,o$r,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),o$x(0,o$r,"velocity",function(){return this._velocity}),o$x(0,o$r,"position",function(){return this._positionStartLifeTime}),o$x(0,o$r,"random0",function(){return this._randoms0}),o$x(0,o$r,"startSize",function(){return this._startSize}),o$x(0,o$r,"startColor",function(){return this._startColor}),o$x(0,o$r,"startRotation0",function(){return this._startRotation0}),o$x(0,o$r,"startRotation1",function(){return this._startRotation1}),o$x(0,o$r,"random1",function(){return this._randoms1}),o$x(0,o$r,"startRotation2",function(){return this._startRotation2}),o$x(0,o$r,"startLifeTime",function(){return this._startLifeTime}),o$x(0,o$r,"time",function(){return this._time}),o$x(0,o$r,"startSpeed",function(){return this._startSpeed}),o$x(0,o$r,"simulationWorldPostion",function(){return this._simulationWorldPostion}),o$x(0,o$r,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$x(1,o$o,"vertexDeclaration",function(){return o$o._vertexDeclaration}),o$p(o$o,["_vertexDeclaration",function(){return this._vertexDeclaration=new o$Do(172,[new o$no(0,"vector3",0),new o$no(12,"vector4",1),new o$no(28,"vector2",2),new o$no(36,"vector4",30),new o$no(52,"vector4",32),new o$no(68,"vector4",19),new o$no(84,"vector3",20),new o$no(96,"vector3",22),new o$no(108,"single",31),new o$no(112,"vector4",34),new o$no(128,"vector4",35),new o$no(144,"vector3",36),new o$no(156,"vector4",37)])}])}(),function(){function o$y(o$o,o$r,o$T,o$k,o$W,o$D){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=o$T,this._materials=o$k,this._subMeshes=o$W,this._materialMap=o$D,this._version=o$r,this._onLoaded(o$o)}o$v(o$y,"laya.d3.loaders.LoadModelV01");var o$o=o$y.prototype;return o$o._onLoaded=function(o$o){this._readData=o$o,this.READ_BLOCK();for(var o$r=0;o$r<this._BLOCK.count;o$r++){var o$T=this._readData.getUint16(),o$k=this._strings[o$T],o$W=this["READ_"+o$k];if(null==o$W)throw new Error("model file err,no this function:"+o$T+" "+o$k);if(!o$W.call(this))break}return this._mesh},o$o.onError=function(){},o$o._readString=function(){return this._strings[this._readData.getUint16()]},o$o.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},o$o.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},o$o.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var o$o=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var o$r=0;o$r<this._STRINGS.size;o$r++)this._strings[o$r]=this._readData.readUTFString();return this._readData.pos=o$o,!0},o$o.READ_MATERIAL=function(){var o$o=this._readData.getUint16(),o$r=(this._readString(),this._readString());return this._materials[o$o]="null"!==o$r?o$K.getRes(this._materialMap[o$r]):new o$Rr,!0},o$o.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var o$o,o$r=this._readData.__getBuffer(),o$T=0,o$k=this._readData.getUint32(),o$W=this._readData.getUint32(),o$D=(new Float32Array(o$r.slice(o$k+this._DATA.offset,o$k+this._DATA.offset+o$W)),this._readData.getUint32()),o$n=this._readData.getUint32(),o$V=new Float32Array(o$r.slice(o$D+this._DATA.offset,o$D+this._DATA.offset+o$n));for(this.mesh._inverseBindPoses=[],o$T=0,o$o=o$V.length;o$T<o$o;o$T+=16){var o$L=new o$or(o$V[o$T+0],o$V[o$T+1],o$V[o$T+2],o$V[o$T+3],o$V[o$T+4],o$V[o$T+5],o$V[o$T+6],o$V[o$T+7],o$V[o$T+8],o$V[o$T+9],o$V[o$T+10],o$V[o$T+11],o$V[o$T+12],o$V[o$T+13],o$V[o$T+14],o$V[o$T+15]);this.mesh._inverseBindPoses.push(o$L)}break;default:throw new Error("LoadModel:unknown version.")}return!0},o$o.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var o$o=this._readString();this._shaderAttributes=o$o.match(o$y._attrReg);var o$r=this._readData.getUint32(),o$T=this._readData.getUint32(),o$k=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),o$W=this._readData.getUint32(),o$D=this._readData.getUint32(),o$n=this._readData.getUint32(),o$V=this._readData.__getBuffer(),o$L=new o$Ur(this._mesh),o$U=this._getVertexDeclaration(),o$h=o$er.create(o$U,o$W/o$U.vertexStride,35044,!0),o$p=o$k+this._DATA.offset,o$i=o$V.slice(o$p,o$p+o$W);o$h.setData(new Float32Array(o$i));for(var o$v=(o$L._vertexBuffer=o$h).vertexDeclaration.getVertexElements(),o$x=0;o$x<o$v.length;o$x++)o$L._bufferUsage[o$v[o$x].elementUsage]=o$h;var o$j=o$cr.create("ushort",o$T/2,35044,!0),o$_=o$r+this._DATA.offset,o$K=o$V.slice(o$_,o$_+o$T);o$j.setData(new Uint16Array(o$K)),o$L._indexBuffer=o$j;var o$$=o$V.slice(o$D+this._DATA.offset,o$D+this._DATA.offset+o$n);return o$L._boneIndicesList[0]=new Uint8Array(o$$),this._subMeshes.push(o$L),!0},o$o.READ_DATAAREA=function(){return!1},o$o._getVertexDeclaration=function(){for(var o$o,o$r=!1,o$T=!1,o$k=!1,o$W=!1,o$D=!1,o$n=!1,o$V=!1,o$L=!1,o$U=!1,o$h=0;o$h<this._shaderAttributes.length;o$h+=8)switch(this._shaderAttributes[o$h]){case"POSITION":o$r=!0;break;case"NORMAL":o$T=!0;break;case"COLOR":o$k=!0;break;case"UV":o$W=!0;break;case"UV1":o$D=!0;break;case"BLENDWEIGHT":o$V=!0;break;case"BLENDINDICES":o$L=!0;break;case"TANGENT":o$n=!0;break;case"BINORMAL":o$U=!0}return o$r&&o$T&&o$k&&o$W&&o$D&&o$V&&o$L&&o$n?o$o=o$yo.vertexDeclaration:o$r&&o$T&&o$k&&o$W&&o$D&&o$V&&o$L?o$o=o$Ko.vertexDeclaration:o$r&&o$T&&o$W&&o$D&&o$V&&o$L&&o$n?o$o=o$Co.vertexDeclaration:o$r&&o$T&&o$W&&o$D&&o$V&&o$L?o$o=o$zo.vertexDeclaration:o$r&&o$T&&o$k&&o$W&&o$V&&o$L&&o$n?o$o=o$Fo.vertexDeclaration:o$r&&o$T&&o$k&&o$W&&o$V&&o$L?o$o=o$qo.vertexDeclaration:o$r&&o$T&&o$n&&o$U&&o$W&&o$V&&o$L?o$o=o$No.vertexDeclaration:o$r&&o$T&&o$W&&o$V&&o$L&&o$n?o$o=o$eo.vertexDeclaration:o$r&&o$T&&o$W&&o$V&&o$L?o$o=o$Mo.vertexDeclaration:o$r&&o$T&&o$k&&o$V&&o$L&&o$n?o$o=o$io.vertexDeclaration:o$r&&o$T&&o$k&&o$V&&o$L?o$o=o$ho.vertexDeclaration:o$r&&o$T&&o$k&&o$W&&o$D&&o$n?o$o=o$So.vertexDeclaration:o$r&&o$T&&o$k&&o$W&&o$D?o$o=o$_o.vertexDeclaration:o$r&&o$T&&o$W&&o$D&&o$n?o$o=o$Oo.vertexDeclaration:o$r&&o$T&&o$W&&o$D?o$o=o$so.vertexDeclaration:o$r&&o$T&&o$k&&o$W&&o$n?o$o=o$to.vertexDeclaration:o$r&&o$T&&o$W&&o$n&&o$U?o$o=o$Ao.vertexDeclaration:o$r&&o$T&&o$k&&o$W?o$o=o$jo.vertexDeclaration:o$r&&o$T&&o$W&&o$n?o$o=o$Yo.vertexDeclaration:o$r&&o$T&&o$W?o$o=o$uo.vertexDeclaration:o$r&&o$T&&o$k&&o$n?o$o=o$xo.vertexDeclaration:o$r&&o$T&&o$k&&(o$o=o$Uo.vertexDeclaration),o$o},o$x(0,o$o,"mesh",function(){return this._mesh}),o$y._attrReg=new RegExp("(\\w+)|([:,;])","g"),o$y}()),o$Go=function(){function o$b(){}return o$v(o$b,"laya.d3.loaders.LoadModelV02"),o$b.parse=function(o$o,o$r,o$T,o$k,o$W,o$D){o$b._mesh=o$T,o$b._materials=o$k,o$b._subMeshes=o$W,o$b._materialMap=o$D,o$b._version=o$r,o$b._readData=o$o,o$b.READ_DATA(),o$b.READ_BLOCK(),o$b.READ_STRINGS();for(var o$n=0,o$V=o$b._BLOCK.count;o$n<o$V;o$n++){o$b._readData.pos=o$b._BLOCK.blockStarts[o$n];var o$L=o$b._readData.getUint16(),o$U=o$b._strings[o$L],o$h=o$b["READ_"+o$U];if(null==o$h)throw new Error("model file err,no this function:"+o$L+" "+o$U);o$h.call()}o$b._strings.length=0,o$b._readData=null,o$b._version=null,o$b._mesh=null,o$b._materials=null,o$b._subMeshes=null,o$b._materialMap=null},o$b._readString=function(){return o$b._strings[o$b._readData.getUint16()]},o$b.READ_DATA=function(){o$b._DATA.offset=o$b._readData.getUint32(),o$b._DATA.size=o$b._readData.getUint32()},o$b.READ_BLOCK=function(){for(var o$o=o$b._BLOCK.count=o$b._readData.getUint16(),o$r=o$b._BLOCK.blockStarts=[],o$T=o$b._BLOCK.blockLengths=[],o$k=0;o$k<o$o;o$k++)o$r.push(o$b._readData.getUint32()),o$T.push(o$b._readData.getUint32())},o$b.READ_STRINGS=function(){var o$o=o$b._readData.getUint32(),o$r=o$b._readData.getUint16(),o$T=o$b._readData.pos;o$b._readData.pos=o$o+o$b._DATA.offset;for(var o$k=0;o$k<o$r;o$k++)o$b._strings[o$k]=o$b._readData.readUTFString();o$b._readData.pos=o$T},o$b.READ_MATERIAL=function(){o$b._readString(),o$b._readString();var o$o=o$b._readString();return""!==o$o&&o$b._materials.push(o$K.getRes(o$b._materialMap[o$o])),!0},o$b.READ_MESH=function(){o$b._readString();var o$o,o$r=o$b._readData.__getBuffer(),o$T=0,o$k=o$b._readData.getInt16(),o$W=o$b._DATA.offset;for(o$T=0;o$T<o$k;o$T++){var o$D=o$W+o$b._readData.getUint32(),o$n=o$b._readData.getUint32(),o$V=new Float32Array(o$r.slice(o$D,o$D+o$n)),o$L=o$b._readString().match(o$b._attrReg),o$U=o$b._getVertexDeclaration(o$L),o$h=o$er.create(o$U,4*o$V.length/o$U.vertexStride,35044,!0);o$h.setData(o$V),o$b._mesh._vertexBuffers.push(o$h)}var o$p=o$W+o$b._readData.getUint32(),o$i=o$b._readData.getUint32(),o$v=new Uint16Array(o$r.slice(o$p,o$p+o$i)),o$x=o$cr.create("ushort",o$i/2,35044,!0);o$x.setData(o$v),o$b._mesh._indexBuffer=o$x;var o$j=o$b._mesh._boneNames=[],o$_=o$b._readData.getUint16();for(o$j.length=o$_,o$T=0;o$T<o$_;o$T++)o$j[o$T]=o$b._strings[o$b._readData.getUint16()];var o$K=o$b._readData.getUint32(),o$$=o$b._readData.getUint32(),o$y=(new Float32Array(o$r.slice(o$W+o$K,o$W+o$K+o$$)),o$b._readData.getUint32()),o$l=o$b._readData.getUint32(),o$S=new Float32Array(o$r.slice(o$W+o$y,o$W+o$y+o$l));for(o$b._mesh._inverseBindPoses=[],o$T=0,o$o=o$S.length;o$T<o$o;o$T+=16){var o$q=new o$or(o$S[o$T+0],o$S[o$T+1],o$S[o$T+2],o$S[o$T+3],o$S[o$T+4],o$S[o$T+5],o$S[o$T+6],o$S[o$T+7],o$S[o$T+8],o$S[o$T+9],o$S[o$T+10],o$S[o$T+11],o$S[o$T+12],o$S[o$T+13],o$S[o$T+14],o$S[o$T+15]);o$b._mesh._inverseBindPoses.push(o$q)}return o$b._mesh._skinnedDatas=new Float32Array(16*o$S.length),!0},o$b.READ_SUBMESH=function(){var o$o=o$b._readData.__getBuffer(),o$r=new o$Ur(o$b._mesh),o$T=o$b._readData.getInt16(),o$k=o$b._readData.getUint32(),o$W=o$b._readData.getUint32();o$r._vertexBuffer=o$b._mesh._vertexBuffers[o$T],o$r._vertexStart=o$k,o$r._vertexCount=o$W;var o$D=o$b._readData.getUint32(),o$n=o$b._readData.getUint32(),o$V=o$b._mesh._indexBuffer;o$r._indexBuffer=o$V,o$r._indexStart=o$D,o$r._indexCount=o$n,o$r._indices=new Uint16Array(o$V.getData().buffer,2*o$D,o$n);var o$L=o$b._DATA.offset,o$U=o$r._subIndexBufferStart,o$h=o$r._subIndexBufferCount,o$p=o$r._boneIndicesList,o$i=o$b._readData.getUint16();o$U.length=o$i,o$h.length=o$i,o$p.length=o$i;for(var o$v=0;o$v<o$i;o$v++){o$U[o$v]=o$b._readData.getUint32(),o$h[o$v]=o$b._readData.getUint32();var o$x=o$b._readData.getUint32(),o$j=o$b._readData.getUint32();o$r._boneIndicesList[o$v]=new Uint8Array(o$o.slice(o$L+o$x,o$L+o$x+o$j))}return o$b._subMeshes.push(o$r),!0},o$b._getVertexDeclaration=function(o$o){for(var o$r,o$T=!1,o$k=!1,o$W=!1,o$D=!1,o$n=!1,o$V=!1,o$L=!1,o$U=!1,o$h=!1,o$p=0;o$p<o$o.length;o$p++)switch(o$o[o$p]){case"POSITION":o$T=!0;break;case"NORMAL":o$k=!0;break;case"COLOR":o$W=!0;break;case"UV":o$D=!0;break;case"UV1":o$n=!0;break;case"BLENDWEIGHT":o$L=!0;break;case"BLENDINDICES":o$U=!0;break;case"TANGENT":o$V=!0;break;case"BINORMAL":o$h=!0}return o$T&&o$k&&o$W&&o$D&&o$n&&o$L&&o$U&&o$V?o$r=o$yo.vertexDeclaration:o$T&&o$k&&o$W&&o$D&&o$n&&o$L&&o$U?o$r=o$Ko.vertexDeclaration:o$T&&o$k&&o$D&&o$n&&o$L&&o$U&&o$V?o$r=o$Co.vertexDeclaration:o$T&&o$k&&o$D&&o$n&&o$L&&o$U?o$r=o$zo.vertexDeclaration:o$T&&o$k&&o$W&&o$D&&o$L&&o$U&&o$V?o$r=o$Fo.vertexDeclaration:o$T&&o$k&&o$W&&o$D&&o$L&&o$U?o$r=o$qo.vertexDeclaration:o$T&&o$k&&o$D&&o$L&&o$U&&o$V?o$r=o$eo.vertexDeclaration:o$T&&o$k&&o$D&&o$L&&o$U?o$r=o$Mo.vertexDeclaration:o$T&&o$k&&o$W&&o$L&&o$U&&o$V?o$r=o$io.vertexDeclaration:o$T&&o$k&&o$W&&o$L&&o$U?o$r=o$ho.vertexDeclaration:o$T&&o$k&&o$W&&o$D&&o$n&&o$V?o$r=o$So.vertexDeclaration:o$T&&o$k&&o$W&&o$D&&o$n?o$r=o$_o.vertexDeclaration:o$T&&o$k&&o$D&&o$n&&o$V?o$r=o$Oo.vertexDeclaration:o$T&&o$k&&o$D&&o$n?o$r=o$so.vertexDeclaration:o$T&&o$k&&o$W&&o$D&&o$V?o$r=o$to.vertexDeclaration:o$T&&o$k&&o$D&&o$V&&o$h?o$r=o$Ao.vertexDeclaration:o$T&&o$k&&o$W&&o$D?o$r=o$jo.vertexDeclaration:o$T&&o$k&&o$D&&o$V?o$r=o$Yo.vertexDeclaration:o$T&&o$k&&o$D?o$r=o$uo.vertexDeclaration:o$T&&o$k&&o$W&&o$V?o$r=o$xo.vertexDeclaration:o$T&&o$k&&o$W&&(o$r=o$Uo.vertexDeclaration),o$r},o$b._attrReg=new RegExp("(\\w+)|([:,;])","g"),o$b._strings=[],o$b._readData=null,o$b._version=null,o$b._mesh=null,o$b._materials=null,o$b._subMeshes=null,o$b._materialMap=null,o$p(o$b,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),o$b}(),o$wo=function(){function o$q(){}return o$v(o$q,"laya.d3.loaders.LoadModelV03"),o$q.parse=function(o$o,o$r,o$T,o$k,o$W){o$q._mesh=o$T,o$q._subMeshes=o$k,o$q._materialMap=o$W,o$q._version=o$r,o$q._readData=o$o,o$q.READ_DATA(),o$q.READ_BLOCK(),o$q.READ_STRINGS();for(var o$D=0,o$n=o$q._BLOCK.count;o$D<o$n;o$D++){o$q._readData.pos=o$q._BLOCK.blockStarts[o$D];var o$V=o$q._readData.getUint16(),o$L=o$q._strings[o$V],o$U=o$q["READ_"+o$L];if(null==o$U)throw new Error("model file err,no this function:"+o$V+" "+o$L);o$U.call()}o$q._strings.length=0,o$q._readData=null,o$q._version=null,o$q._mesh=null,o$q._subMeshes=null,o$q._materialMap=null},o$q._readString=function(){return o$q._strings[o$q._readData.getUint16()]},o$q.READ_DATA=function(){o$q._DATA.offset=o$q._readData.getUint32(),o$q._DATA.size=o$q._readData.getUint32()},o$q.READ_BLOCK=function(){for(var o$o=o$q._BLOCK.count=o$q._readData.getUint16(),o$r=o$q._BLOCK.blockStarts=[],o$T=o$q._BLOCK.blockLengths=[],o$k=0;o$k<o$o;o$k++)o$r.push(o$q._readData.getUint32()),o$T.push(o$q._readData.getUint32())},o$q.READ_STRINGS=function(){var o$o=o$q._readData.getUint32(),o$r=o$q._readData.getUint16(),o$T=o$q._readData.pos;o$q._readData.pos=o$o+o$q._DATA.offset;for(var o$k=0;o$k<o$r;o$k++)o$q._strings[o$k]=o$q._readData.readUTFString();o$q._readData.pos=o$T},o$q.READ_MESH=function(){var o$o,o$r=o$q._readString(),o$T=o$q._readData.__getBuffer(),o$k=0,o$W=o$q._readData.getInt16(),o$D=o$q._DATA.offset;for(o$k=0;o$k<o$W;o$k++){var o$n,o$V=o$D+o$q._readData.getUint32(),o$L=o$q._readData.getUint32(),o$U=new Float32Array(o$T.slice(o$V,o$V+o$L)),o$h=o$q._readString();switch(o$q._version){case"LAYAMODEL:03":o$n=o$q._vertexDeclarationMap_Discard[o$h];break;case"LAYAMODEL:0301":o$n=o$q._vertexDeclarationMap[o$h];break;default:throw new Error("LoadModelV03: unknown version.")}if(!o$n)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+o$q._version+"  bufferAttribute="+o$h+"  name="+o$r+"  url="+(o$q._mesh?o$q._mesh.url:"null"));var o$p=o$er.create(o$n,4*o$U.length/o$n.vertexStride,35044,!0,o$q._mesh._url+"_"+o$k);o$p.setData(o$U),o$q._mesh._vertexBuffers.push(o$p)}var o$i=o$D+o$q._readData.getUint32(),o$v=o$q._readData.getUint32(),o$x=new Uint16Array(o$T.slice(o$i,o$i+o$v)),o$j=o$cr.create("ushort",o$v/2,35044,!0,o$q._mesh._url);o$j.setData(o$x),o$q._mesh._indexBuffer=o$j;var o$_=o$q._mesh._boneNames=[],o$K=o$q._readData.getUint16();for(o$_.length=o$K,o$k=0;o$k<o$K;o$k++)o$_[o$k]=o$q._strings[o$q._readData.getUint16()];o$q._readData.pos+=8;var o$$=o$q._readData.getUint32(),o$y=o$q._readData.getUint32(),o$l=new Float32Array(o$T.slice(o$D+o$$,o$D+o$$+o$y));for(o$q._mesh._inverseBindPoses=[],o$k=0,o$o=o$l.length;o$k<o$o;o$k+=16){var o$S=new o$or(o$l[o$k+0],o$l[o$k+1],o$l[o$k+2],o$l[o$k+3],o$l[o$k+4],o$l[o$k+5],o$l[o$k+6],o$l[o$k+7],o$l[o$k+8],o$l[o$k+9],o$l[o$k+10],o$l[o$k+11],o$l[o$k+12],o$l[o$k+13],o$l[o$k+14],o$l[o$k+15]);o$q._mesh._inverseBindPoses.push(o$S)}return o$q._mesh._skinnedDatas=new Float32Array(16*o$l.length),!0},o$q.READ_SUBMESH=function(){var o$o=o$q._readData.__getBuffer(),o$r=new o$Ur(o$q._mesh),o$T=o$q._readData.getInt16(),o$k=o$q._readData.getUint32(),o$W=o$q._readData.getUint32();o$r._vertexBuffer=o$q._mesh._vertexBuffers[o$T],o$r._vertexStart=o$k,o$r._vertexCount=o$W;var o$D=o$q._readData.getUint32(),o$n=o$q._readData.getUint32(),o$V=o$q._mesh._indexBuffer;o$r._indexBuffer=o$V,o$r._indexStart=o$D,o$r._indexCount=o$n,o$r._indices=new Uint16Array(o$V.getData().buffer,2*o$D,o$n);var o$L=o$q._DATA.offset,o$U=o$r._subIndexBufferStart,o$h=o$r._subIndexBufferCount,o$p=o$r._boneIndicesList,o$i=o$q._readData.getUint16();o$U.length=o$i,o$h.length=o$i,o$p.length=o$i;for(var o$v=0;o$v<o$i;o$v++){o$U[o$v]=o$q._readData.getUint32(),o$h[o$v]=o$q._readData.getUint32();var o$x=o$q._readData.getUint32(),o$j=o$q._readData.getUint32();o$p[o$v]=new Uint8Array(o$o.slice(o$L+o$x,o$L+o$x+o$j))}return o$q._subMeshes.push(o$r),!0},o$q._strings=[],o$q._readData=null,o$q._version=null,o$q._mesh=null,o$q._subMeshes=null,o$q._materialMap=null,o$p(o$q,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":o$yo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":o$Ko.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":o$Io.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":o$Co.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":o$zo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":o$Fo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":o$qo.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":o$eo.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":o$Mo.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":o$io.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":o$ho.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":o$So.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":o$_o.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":o$Oo.vertexDeclaration,"POSITION,NORMAL,UV,UV1":o$so.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":o$to.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":o$Ao.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":o$jo.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":o$Yo.vertexDeclaration,"POSITION,NORMAL,UV":o$uo.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":o$xo.vertexDeclaration,"POSITION,NORMAL,COLOR":o$Uo.vertexDeclaration,"POSITION,NORMAL,TANGENT":o$Ro.vertexDeclaration,"POSITION,NORMAL":o$Lo.vertexDeclaration,"POSITION,UV":o$fo.vertexDeclaration,POSITION:o$Vo.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":o$$o.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":o$Ko.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":o$Io.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":o$mo.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":o$zo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":o$bo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":o$qo.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":o$co.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":o$Mo.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":o$po.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":o$ho.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":o$lo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":o$_o.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":o$Xo.vertexDeclaration,"POSITION,NORMAL,UV,UV1":o$so.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":o$Po.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":o$Ao.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":o$jo.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":o$Jo.vertexDeclaration,"POSITION,NORMAL,UV":o$uo.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":o$vo.vertexDeclaration,"POSITION,NORMAL,COLOR":o$Uo.vertexDeclaration,"POSITION,NORMAL,TANGENT":o$Ho.vertexDeclaration,"POSITION,NORMAL":o$Lo.vertexDeclaration,"POSITION,UV":o$fo.vertexDeclaration,POSITION:o$Vo.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),o$q}(),o$Zo=function(){function o$V(){}return o$v(o$V,"laya.d3.loaders.MeshReader"),o$V.read=function(o$o,o$r,o$T,o$k,o$W){var o$D=new o$q(o$o);o$D.pos=0;var o$n=o$D.readUTFString();switch(o$n){case"LAYAMODEL:01":case"LAYASKINANI:01":o$V._readVersion01(o$D,o$n,o$r,o$T,o$k,o$W);break;case"LAYAMODEL:02":o$Go.parse(o$D,o$n,o$r,o$T,o$k,o$W);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":o$wo.parse(o$D,o$n,o$r,o$k,o$W);break;default:throw new Error("MeshReader: unknown mesh version.")}o$r._setSubMeshes(o$k)},o$V._readVersion01=function(o$o,o$r,o$T,o$k,o$W,o$D){new o$ao(o$o,o$r,o$T,o$k,o$W,o$D)},o$V}(),o$Qo=function(){function o$o(o$o,o$r){this.min=null,this.max=null,this.min=o$o,this.max=o$r}o$v(o$o,"laya.d3.math.BoundBox");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r.getCorners=function(o$o){o$o.length=8;var o$r=this.min.elements,o$T=this.max.elements,o$k=o$r[0],o$W=o$r[1],o$D=o$r[2],o$n=o$T[0],o$V=o$T[1],o$L=o$T[2];o$o[0]=new o$nr(o$k,o$V,o$L),o$o[1]=new o$nr(o$n,o$V,o$L),o$o[2]=new o$nr(o$n,o$W,o$L),o$o[3]=new o$nr(o$k,o$W,o$L),o$o[4]=new o$nr(o$k,o$V,o$D),o$o[5]=new o$nr(o$n,o$V,o$D),o$o[6]=new o$nr(o$n,o$W,o$D),o$o[7]=new o$nr(o$k,o$W,o$D)},o$r.toDefault=function(){this.min.toDefault(),this.max.toDefault()},o$r.cloneTo=function(o$o){var o$r=o$o;this.min.cloneTo(o$r.min),this.max.cloneTo(o$r.max)},o$r.clone=function(){var o$o=new this.constructor(new o$nr,new o$nr);return this.cloneTo(o$o),o$o},o$o.createfromPoints=function(o$o,o$r){if(null==o$o)throw new Error("points");var o$T=o$r.min,o$k=o$r.max,o$W=o$T.elements;o$W[0]=Number.MAX_VALUE,o$W[1]=Number.MAX_VALUE,o$W[2]=Number.MAX_VALUE;var o$D=o$k.elements;o$D[0]=-Number.MAX_VALUE,o$D[1]=-Number.MAX_VALUE,o$D[2]=-Number.MAX_VALUE;for(var o$n=0,o$V=o$o.length;o$n<o$V;++o$n)o$nr.min(o$T,o$o[o$n],o$T),o$nr.max(o$k,o$o[o$n],o$k)},o$o.merge=function(o$o,o$r,o$T){o$nr.min(o$o.min,o$r.min,o$T.min),o$nr.max(o$o.max,o$r.max,o$T.max)},o$o}(),o$go=function(){function o$U(o$o){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=o$o,this._near=new o$rr(new o$nr),this._far=new o$rr(new o$nr),this._left=new o$rr(new o$nr),this._right=new o$rr(new o$nr),this._top=new o$rr(new o$nr),this._bottom=new o$rr(new o$nr),o$U._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}o$v(o$U,"laya.d3.math.BoundFrustum");var o$o=o$U.prototype;return o$o.equalsBoundFrustum=function(o$o){return this._matrix.equalsOtherMatrix(o$o.matrix)},o$o.equalsObj=function(o$o){if(o$o instanceof laya.d3.math.BoundFrustum){var o$r=o$o;return this.equalsBoundFrustum(o$r)}return!1},o$o.getPlane=function(o$o){switch(o$o){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},o$o.getCorners=function(o$o){o$U._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(o$o[0]),o$U._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(o$o[1]),o$U._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(o$o[2]),o$U._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(o$o[3]),o$U._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(o$o[4]),o$U._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(o$o[5]),o$U._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(o$o[6]),o$U._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(o$o[7])},o$o.containsPoint=function(o$o){for(var o$r=o$rr.PlaneIntersectionType_Front,o$T=o$rr.PlaneIntersectionType_Front,o$k=0;o$k<6;o$k++){switch(o$k){case 0:o$T=Collision.intersectsPlaneAndPoint(this._near,o$o);break;case 1:o$T=Collision.intersectsPlaneAndPoint(this._far,o$o);break;case 2:o$T=Collision.intersectsPlaneAndPoint(this._left,o$o);break;case 3:o$T=Collision.intersectsPlaneAndPoint(this._right,o$o);break;case 4:o$T=Collision.intersectsPlaneAndPoint(this._top,o$o);break;case 5:o$T=Collision.intersectsPlaneAndPoint(this._bottom,o$o)}switch(o$T){case o$rr.PlaneIntersectionType_Back:return 0;case o$rr.PlaneIntersectionType_Intersecting:o$r=o$rr.PlaneIntersectionType_Intersecting}}switch(o$r){case o$rr.PlaneIntersectionType_Intersecting:return 2;default:return 1}},o$o.containsBoundBox=function(o$o){for(var o$r,o$T=o$U._tempV30,o$k=o$U._tempV31,o$W=1,o$D=0;o$D<6;o$D++){if(o$r=this.getPlane(o$D),this._getBoxToPlanePVertexNVertex(o$o,o$r.normal,o$T,o$k),Collision.intersectsPlaneAndPoint(o$r,o$T)===o$rr.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(o$r,o$k)===o$rr.PlaneIntersectionType_Back&&(o$W=2)}return o$W},o$o.containsBoundSphere=function(o$o){for(var o$r=o$rr.PlaneIntersectionType_Front,o$T=o$rr.PlaneIntersectionType_Front,o$k=0;o$k<6;o$k++){switch(o$k){case 0:o$T=Collision.intersectsPlaneAndSphere(this._near,o$o);break;case 1:o$T=Collision.intersectsPlaneAndSphere(this._far,o$o);break;case 2:o$T=Collision.intersectsPlaneAndSphere(this._left,o$o);break;case 3:o$T=Collision.intersectsPlaneAndSphere(this._right,o$o);break;case 4:o$T=Collision.intersectsPlaneAndSphere(this._top,o$o);break;case 5:o$T=Collision.intersectsPlaneAndSphere(this._bottom,o$o)}switch(o$T){case o$rr.PlaneIntersectionType_Back:return 0;case o$rr.PlaneIntersectionType_Intersecting:o$r=o$rr.PlaneIntersectionType_Intersecting}}switch(o$r){case o$rr.PlaneIntersectionType_Intersecting:return 2;default:return 1}},o$o._getBoxToPlanePVertexNVertex=function(o$o,o$r,o$T,o$k){var o$W=o$o.min,o$D=o$W.elements,o$n=o$o.max,o$V=o$n.elements,o$L=o$r.elements,o$U=o$L[0],o$h=o$L[1],o$p=o$L[2];o$W.cloneTo(o$T);var o$i=o$T.elements;0<=o$U&&(o$i[0]=o$V[0]),0<=o$h&&(o$i[1]=o$V[1]),0<=o$p&&(o$i[2]=o$V[2]),o$n.cloneTo(o$k);var o$v=o$k.elements;0<=o$U&&(o$v[0]=o$D[0]),0<=o$h&&(o$v[1]=o$D[1]),0<=o$p&&(o$v[2]=o$D[2])},o$x(0,o$o,"top",function(){return this._top}),o$x(0,o$o,"matrix",function(){return this._matrix},function(o$o){this._matrix=o$o,o$U._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),o$x(0,o$o,"near",function(){return this._near}),o$x(0,o$o,"far",function(){return this._far}),o$x(0,o$o,"left",function(){return this._left}),o$x(0,o$o,"right",function(){return this._right}),o$x(0,o$o,"bottom",function(){return this._bottom}),o$U._getPlanesFromMatrix=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){var o$V=o$o.elements,o$L=o$V[0],o$U=o$V[1],o$h=o$V[2],o$p=o$V[3],o$i=o$V[4],o$v=o$V[5],o$x=o$V[6],o$j=o$V[7],o$_=o$V[8],o$K=o$V[9],o$$=o$V[10],o$y=o$V[11],o$l=o$V[12],o$S=o$V[13],o$q=o$V[14],o$b=o$V[15],o$F=o$r.normal.elements;o$F[0]=o$p+o$h,o$F[1]=o$j+o$x,o$F[2]=o$y+o$$,o$r.distance=o$b+o$q,o$r.normalize();var o$P=o$T.normal.elements;o$P[0]=o$p-o$h,o$P[1]=o$j-o$x,o$P[2]=o$y-o$$,o$T.distance=o$b-o$q,o$T.normalize();var o$t=o$k.normal.elements;o$t[0]=o$p+o$L,o$t[1]=o$j+o$i,o$t[2]=o$y+o$_,o$k.distance=o$b+o$l,o$k.normalize();var o$H=o$W.normal.elements;o$H[0]=o$p-o$L,o$H[1]=o$j-o$i,o$H[2]=o$y-o$_,o$W.distance=o$b-o$l,o$W.normalize();var o$R=o$D.normal.elements;o$R[0]=o$p-o$U,o$R[1]=o$j-o$v,o$R[2]=o$y-o$K,o$D.distance=o$b-o$S,o$D.normalize();var o$u=o$n.normal.elements;o$u[0]=o$p+o$U,o$u[1]=o$j+o$v,o$u[2]=o$y+o$K,o$n.distance=o$b+o$S,o$n.normalize()},o$U._get3PlaneInterPoint=function(o$o,o$r,o$T){var o$k=o$o.normal,o$W=o$r.normal,o$D=o$T.normal;o$nr.cross(o$W,o$D,o$U._tempV30),o$nr.cross(o$D,o$k,o$U._tempV31),o$nr.cross(o$k,o$W,o$U._tempV32);var o$n=o$nr.dot(o$k,o$U._tempV30),o$V=o$nr.dot(o$W,o$U._tempV31),o$L=o$nr.dot(o$D,o$U._tempV32);return o$nr.scale(o$U._tempV30,-o$o.distance/o$n,o$U._tempV33),o$nr.scale(o$U._tempV31,-o$r.distance/o$V,o$U._tempV34),o$nr.scale(o$U._tempV32,-o$T.distance/o$L,o$U._tempV35),o$nr.add(o$U._tempV33,o$U._tempV34,o$U._tempV36),o$nr.add(o$U._tempV35,o$U._tempV36,o$U._tempV37),o$U._tempV37},o$p(o$U,["_tempV30",function(){return this._tempV30=new o$nr},"_tempV31",function(){return this._tempV31=new o$nr},"_tempV32",function(){return this._tempV32=new o$nr},"_tempV33",function(){return this._tempV33=new o$nr},"_tempV34",function(){return this._tempV34=new o$nr},"_tempV35",function(){return this._tempV35=new o$nr},"_tempV36",function(){return this._tempV36=new o$nr},"_tempV37",function(){return this._tempV37=new o$nr}]),o$U}(),o$Bo=function(){function o$h(o$o,o$r){this.center=null,this.radius=NaN,this.center=o$o,this.radius=o$r}o$v(o$h,"laya.d3.math.BoundSphere");var o$o=o$h.prototype;return o$S.imps(o$o,{"laya.d3.core.IClone":!0}),o$o.toDefault=function(){this.center.toDefault(),this.radius=0},o$o.intersectsRayDistance=function(o$o){return Collision.intersectsRayAndSphereRD(o$o,this)},o$o.intersectsRayPoint=function(o$o,o$r){return Collision.intersectsRayAndSphereRP(o$o,this,o$r)},o$o.cloneTo=function(o$o){var o$r=o$o;this.center.cloneTo(o$r.center),o$r.radius=this.radius},o$o.clone=function(){var o$o=new this.constructor(new o$nr,new o$nr);return this.cloneTo(o$o),o$o},o$h.createFromSubPoints=function(o$o,o$r,o$T,o$k){if(null==o$o)throw new Error("points");if(o$r<0||o$r>=o$o.length)throw new Error("start"+o$r+"Must be in the range [0, "+(o$o.length-1)+"]");if(o$T<0||o$r+o$T>o$o.length)throw new Error("count"+o$T+"Must be in the range <= "+o$o.length+"}");var o$W=o$r+o$T,o$D=o$h._tempVector3;o$D.elements[0]=0,o$D.elements[1]=0,o$D.elements[2]=0;for(var o$n=o$r;o$n<o$W;++o$n)o$nr.add(o$o[o$n],o$D,o$D);var o$V=o$k.center;o$nr.scale(o$D,1/o$T,o$V);var o$L=0;for(o$n=o$r;o$n<o$W;++o$n){var o$U=o$nr.distanceSquared(o$V,o$o[o$n]);o$L<o$U&&(o$L=o$U)}o$k.radius=Math.sqrt(o$L)},o$h.createfromPoints=function(o$o,o$r){if(null==o$o)throw new Error("points");o$h.createFromSubPoints(o$o,0,o$o.length,o$r)},o$p(o$h,["_tempVector3",function(){return this._tempVector3=new o$nr}]),o$h}(),o$Eo=(function(){function o$o(){}o$v(o$o,"laya.d3.math.ContainmentType"),o$o.Disjoint=0,o$o.Contains=1,o$o.Intersects=2}(),function(){function o$T(){}return o$v(o$T,"laya.d3.math.MathUtils3D"),o$T.isZero=function(o$o){return Math.abs(o$o)<o$T.zeroTolerance},o$T.nearEqual=function(o$o,o$r){return!!o$T.isZero(o$o-o$r)},o$T.fastInvSqrt=function(o$o){return o$T.isZero(o$o)?o$o:1/Math.sqrt(o$o)},o$p(o$T,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),o$T}()),o$do=function(){function o$L(){var o$o=this.elements=new Float32Array(9);o$o[0]=1,o$o[1]=0,o$o[2]=0,o$o[3]=0,o$o[4]=1,o$o[5]=0,o$o[6]=0,o$o[7]=0,o$o[8]=1}o$v(o$L,"laya.d3.math.Matrix3x3");var o$o=o$L.prototype;return o$S.imps(o$o,{"laya.d3.core.IClone":!0}),o$o.determinant=function(){var o$o=this.elements,o$r=o$o[0],o$T=o$o[1],o$k=o$o[2],o$W=o$o[3],o$D=o$o[4],o$n=o$o[5],o$V=o$o[6],o$L=o$o[7],o$U=o$o[8];return o$r*(o$U*o$D-o$n*o$L)+o$T*(-o$U*o$W+o$n*o$V)+o$k*(o$L*o$W-o$D*o$V)},o$o.translate=function(o$o,o$r){var o$T=o$r.elements,o$k=this.elements,o$W=o$o.elements,o$D=o$k[0],o$n=o$k[1],o$V=o$k[2],o$L=o$k[3],o$U=o$k[4],o$h=o$k[5],o$p=o$k[6],o$i=o$k[7],o$v=o$k[8],o$x=o$W[0],o$j=o$W[1];o$T[0]=o$D,o$T[1]=o$n,o$T[2]=o$V,o$T[3]=o$L,o$T[4]=o$U,o$T[5]=o$h,o$T[6]=o$x*o$D+o$j*o$L+o$p,o$T[7]=o$x*o$n+o$j*o$U+o$i,o$T[8]=o$x*o$V+o$j*o$h+o$v},o$o.rotate=function(o$o,o$r){var o$T=o$r.elements,o$k=this.elements,o$W=o$k[0],o$D=o$k[1],o$n=o$k[2],o$V=o$k[3],o$L=o$k[4],o$U=o$k[5],o$h=o$k[6],o$p=o$k[7],o$i=o$k[8],o$v=Math.sin(o$o),o$x=Math.cos(o$o);o$T[0]=o$x*o$W+o$v*o$V,o$T[1]=o$x*o$D+o$v*o$L,o$T[2]=o$x*o$n+o$v*o$U,o$T[3]=o$x*o$V-o$v*o$W,o$T[4]=o$x*o$L-o$v*o$D,o$T[5]=o$x*o$U-o$v*o$n,o$T[6]=o$h,o$T[7]=o$p,o$T[8]=o$i},o$o.scale=function(o$o,o$r){var o$T=o$r.elements,o$k=this.elements,o$W=o$o.elements,o$D=o$W[0],o$n=o$W[1];o$T[0]=o$D*o$k[0],o$T[1]=o$D*o$k[1],o$T[2]=o$D*o$k[2],o$T[3]=o$n*o$k[3],o$T[4]=o$n*o$k[4],o$T[5]=o$n*o$k[5],o$T[6]=o$k[6],o$T[7]=o$k[7],o$T[8]=o$k[8]},o$o.invert=function(o$o){var o$r=o$o.elements,o$T=this.elements,o$k=o$T[0],o$W=o$T[1],o$D=o$T[2],o$n=o$T[3],o$V=o$T[4],o$L=o$T[5],o$U=o$T[6],o$h=o$T[7],o$p=o$T[8],o$i=o$p*o$V-o$L*o$h,o$v=-o$p*o$n+o$L*o$U,o$x=o$h*o$n-o$V*o$U,o$j=o$k*o$i+o$W*o$v+o$D*o$x;o$j||(o$o=null),o$j=1/o$j,o$r[0]=o$i*o$j,o$r[1]=(-o$p*o$W+o$D*o$h)*o$j,o$r[2]=(o$L*o$W-o$D*o$V)*o$j,o$r[3]=o$v*o$j,o$r[4]=(o$p*o$k-o$D*o$U)*o$j,o$r[5]=(-o$L*o$k+o$D*o$n)*o$j,o$r[6]=o$x*o$j,o$r[7]=(-o$h*o$k+o$W*o$U)*o$j,o$r[8]=(o$V*o$k-o$W*o$n)*o$j},o$o.transpose=function(o$o){var o$r=o$o.elements,o$T=this.elements;if(o$o===this){var o$k=o$T[1],o$W=o$T[2],o$D=o$T[5];o$r[1]=o$T[3],o$r[2]=o$T[6],o$r[3]=o$k,o$r[5]=o$T[7],o$r[6]=o$W,o$r[7]=o$D}else o$r[0]=o$T[0],o$r[1]=o$T[3],o$r[2]=o$T[6],o$r[3]=o$T[1],o$r[4]=o$T[4],o$r[5]=o$T[7],o$r[6]=o$T[2],o$r[7]=o$T[5],o$r[8]=o$T[8]},o$o.identity=function(){var o$o=this.elements;o$o[0]=1,o$o[1]=0,o$o[2]=0,o$o[3]=0,o$o[4]=1,o$o[5]=0,o$o[6]=0,o$o[7]=0,o$o[8]=1},o$o.cloneTo=function(o$o){var o$r,o$T,o$k;if((o$T=this.elements)!==(o$k=o$o.elements))for(o$r=0;o$r<9;++o$r)o$k[o$r]=o$T[o$r]},o$o.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$L.createFromTranslation=function(o$o,o$r){o$r.elements;var o$T=o$o.elements;o$r[0]=1,o$r[1]=0,o$r[2]=0,o$r[3]=0,o$r[4]=1,o$r[5]=0,o$r[6]=o$T[0],o$r[7]=o$T[1],o$r[8]=1},o$L.createFromRotation=function(o$o,o$r){var o$T=o$r.elements,o$k=Math.sin(o$o),o$W=Math.cos(o$o);o$T[0]=o$W,o$T[1]=o$k,o$T[2]=0,o$T[3]=-o$k,o$T[4]=o$W,o$T[5]=0,o$T[6]=0,o$T[7]=0,o$T[8]=1},o$L.createFromScaling=function(o$o,o$r){var o$T=o$r.elements,o$k=o$o.elements;o$T[0]=o$k[0],o$T[1]=0,o$T[2]=0,o$T[3]=0,o$T[4]=o$k[1],o$T[5]=0,o$T[6]=0,o$T[7]=0,o$T[8]=1},o$L.createFromMatrix4x4=function(o$o,o$r){o$r[0]=o$o[0],o$r[1]=o$o[1],o$r[2]=o$o[2],o$r[3]=o$o[4],o$r[4]=o$o[5],o$r[5]=o$o[6],o$r[6]=o$o[8],o$r[7]=o$o[9],o$r[8]=o$o[10]},o$L.multiply=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r.elements,o$n=o$W[0],o$V=o$W[1],o$L=o$W[2],o$U=o$W[3],o$h=o$W[4],o$p=o$W[5],o$i=o$W[6],o$v=o$W[7],o$x=o$W[8],o$j=o$D[0],o$_=o$D[1],o$K=o$D[2],o$$=o$D[3],o$y=o$D[4],o$l=o$D[5],o$S=o$D[6],o$q=o$D[7],o$b=o$D[8];o$k[0]=o$j*o$n+o$_*o$U+o$K*o$i,o$k[1]=o$j*o$V+o$_*o$h+o$K*o$v,o$k[2]=o$j*o$L+o$_*o$p+o$K*o$x,o$k[3]=o$$*o$n+o$y*o$U+o$l*o$i,o$k[4]=o$$*o$V+o$y*o$h+o$l*o$v,o$k[5]=o$$*o$L+o$y*o$p+o$l*o$x,o$k[6]=o$S*o$n+o$q*o$U+o$b*o$i,o$k[7]=o$S*o$V+o$q*o$h+o$b*o$v,o$k[8]=o$S*o$L+o$q*o$p+o$b*o$x},o$L.lookAt=function(o$o,o$r,o$T,o$k){o$nr.subtract(o$o,o$r,o$L._tempV30),o$nr.normalize(o$L._tempV30,o$L._tempV30),o$nr.cross(o$T,o$L._tempV30,o$L._tempV31),o$nr.normalize(o$L._tempV31,o$L._tempV31),o$nr.cross(o$L._tempV30,o$L._tempV31,o$L._tempV32);var o$W=o$L._tempV30.elements,o$D=o$L._tempV31.elements,o$n=o$L._tempV32.elements,o$V=o$k.elements;o$V[0]=o$D[0],o$V[3]=o$D[1],o$V[6]=o$D[2],o$V[1]=o$n[0],o$V[4]=o$n[1],o$V[7]=o$n[2],o$V[2]=o$W[0],o$V[5]=o$W[1],o$V[8]=o$W[2]},o$L.DEFAULT=new o$L,o$p(o$L,["_tempV30",function(){return this._tempV30=new o$nr},"_tempV31",function(){return this._tempV31=new o$nr},"_tempV32",function(){return this._tempV32=new o$nr}]),o$L}(),o$or=function(){function o$P(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h,o$p,o$i,o$v,o$x,o$j){void 0===o$o&&(o$o=1),void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=0),void 0===o$W&&(o$W=0),void 0===o$D&&(o$D=1),void 0===o$n&&(o$n=0),void 0===o$V&&(o$V=0),void 0===o$L&&(o$L=0),void 0===o$U&&(o$U=0),void 0===o$h&&(o$h=1),void 0===o$p&&(o$p=0),void 0===o$i&&(o$i=0),void 0===o$v&&(o$v=0),void 0===o$x&&(o$x=0),void 0===o$j&&(o$j=1);var o$_=this.elements=new Float32Array(16);o$_[0]=o$o,o$_[1]=o$r,o$_[2]=o$T,o$_[3]=o$k,o$_[4]=o$W,o$_[5]=o$D,o$_[6]=o$n,o$_[7]=o$V,o$_[8]=o$L,o$_[9]=o$U,o$_[10]=o$h,o$_[11]=o$p,o$_[12]=o$i,o$_[13]=o$v,o$_[14]=o$x,o$_[15]=o$j}o$v(o$P,"laya.d3.math.Matrix4x4");var o$o=o$P.prototype;return o$S.imps(o$o,{"laya.d3.core.IClone":!0}),o$o.getElementByRowColumn=function(o$o,o$r){if(o$o<0||3<o$o)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(o$r<0||3<o$r)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*o$o+o$r]},o$o.setElementByRowColumn=function(o$o,o$r,o$T){if(o$o<0||3<o$o)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(o$r<0||3<o$r)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*o$o+o$r]=o$T},o$o.equalsOtherMatrix=function(o$o){var o$r=this.elements,o$T=o$o.elements;return o$Eo.nearEqual(o$r[0],o$T[0])&&o$Eo.nearEqual(o$r[1],o$T[1])&&o$Eo.nearEqual(o$r[2],o$T[2])&&o$Eo.nearEqual(o$r[3],o$T[3])&&o$Eo.nearEqual(o$r[4],o$T[4])&&o$Eo.nearEqual(o$r[5],o$T[5])&&o$Eo.nearEqual(o$r[6],o$T[6])&&o$Eo.nearEqual(o$r[7],o$T[7])&&o$Eo.nearEqual(o$r[8],o$T[8])&&o$Eo.nearEqual(o$r[9],o$T[9])&&o$Eo.nearEqual(o$r[10],o$T[10])&&o$Eo.nearEqual(o$r[11],o$T[11])&&o$Eo.nearEqual(o$r[12],o$T[12])&&o$Eo.nearEqual(o$r[13],o$T[13])&&o$Eo.nearEqual(o$r[14],o$T[14])&&o$Eo.nearEqual(o$r[15],o$T[15])},o$o.decomposeTransRotScale=function(o$o,o$r,o$T){var o$k=o$P._tempMatrix4x4;return this.decomposeTransRotMatScale(o$o,o$k,o$T)?(o$Tr.createFromMatrix4x4(o$k,o$r),!0):(o$r.identity(),!1)},o$o.decomposeTransRotMatScale=function(o$o,o$r,o$T){var o$k=this.elements,o$W=o$o.elements,o$D=o$r.elements,o$n=o$T.elements;o$W[0]=o$k[12],o$W[1]=o$k[13],o$W[2]=o$k[14];var o$V=o$k[0],o$L=o$k[1],o$U=o$k[2],o$h=o$k[4],o$p=o$k[5],o$i=o$k[6],o$v=o$k[8],o$x=o$k[9],o$j=o$k[10],o$_=o$n[0]=Math.sqrt(o$V*o$V+o$L*o$L+o$U*o$U),o$K=o$n[1]=Math.sqrt(o$h*o$h+o$p*o$p+o$i*o$i),o$$=o$n[2]=Math.sqrt(o$v*o$v+o$x*o$x+o$j*o$j);if(o$Eo.isZero(o$_)||o$Eo.isZero(o$K)||o$Eo.isZero(o$$))return o$D[1]=o$D[2]=o$D[3]=o$D[4]=o$D[6]=o$D[7]=o$D[8]=o$D[9]=o$D[11]=o$D[12]=o$D[13]=o$D[14]=0,o$D[0]=o$D[5]=o$D[10]=o$D[15]=1,!1;var o$y=o$P._tempVector0,o$l=o$y.elements;o$l[0]=o$v/o$$,o$l[1]=o$x/o$$,o$l[2]=o$j/o$$;var o$S=o$P._tempVector1,o$q=o$S.elements;o$q[0]=o$V/o$_,o$q[1]=o$L/o$_,o$q[2]=o$U/o$_;var o$b=o$P._tempVector2;o$nr.cross(o$y,o$S,o$b);var o$F=o$P._tempVector1;return o$nr.cross(o$b,o$y,o$F),o$D[3]=o$D[7]=o$D[11]=o$D[12]=o$D[13]=o$D[14]=0,o$D[15]=1,o$D[0]=o$F.x,o$D[1]=o$F.y,o$D[2]=o$F.z,o$D[4]=o$b.x,o$D[5]=o$b.y,o$D[6]=o$b.z,o$D[8]=o$y.x,o$D[9]=o$y.y,o$D[10]=o$y.z,o$D[0]*o$V+o$D[1]*o$L+o$D[2]*o$U<0&&(o$n[0]=-o$_),o$D[4]*o$h+o$D[5]*o$p+o$D[6]*o$i<0&&(o$n[1]=-o$K),o$D[8]*o$v+o$D[9]*o$x+o$D[10]*o$j<0&&(o$n[2]=-o$$),!0},o$o.decomposeYawPitchRoll=function(o$o){var o$r=o$o.elements,o$T=Math.asin(-this.elements[9]);o$r[1]=o$T,Math.cos(o$T)>o$Eo.zeroTolerance?(o$r[2]=Math.atan2(this.elements[1],this.elements[5]),o$r[0]=Math.atan2(this.elements[8],this.elements[10])):(o$r[2]=Math.atan2(-this.elements[4],this.elements[0]),o$r[0]=0)},o$o.normalize=function(){var o$o=this.elements,o$r=o$o[0],o$T=o$o[1],o$k=o$o[2],o$W=Math.sqrt(o$r*o$r+o$T*o$T+o$k*o$k);if(!o$W)return o$o[0]=0,o$o[1]=0,void(o$o[2]=0);1!=o$W&&(o$W=1/o$W,o$o[0]=o$r*o$W,o$o[1]=o$T*o$W,o$o[2]=o$k*o$W)},o$o.transpose=function(){var o$o,o$r;return o$r=(o$o=this.elements)[1],o$o[1]=o$o[4],o$o[4]=o$r,o$r=o$o[2],o$o[2]=o$o[8],o$o[8]=o$r,o$r=o$o[3],o$o[3]=o$o[12],o$o[12]=o$r,o$r=o$o[6],o$o[6]=o$o[9],o$o[9]=o$r,o$r=o$o[7],o$o[7]=o$o[13],o$o[13]=o$r,o$r=o$o[11],o$o[11]=o$o[14],o$o[14]=o$r,this},o$o.invert=function(o$o){var o$r=this.elements,o$T=o$o.elements,o$k=o$r[0],o$W=o$r[1],o$D=o$r[2],o$n=o$r[3],o$V=o$r[4],o$L=o$r[5],o$U=o$r[6],o$h=o$r[7],o$p=o$r[8],o$i=o$r[9],o$v=o$r[10],o$x=o$r[11],o$j=o$r[12],o$_=o$r[13],o$K=o$r[14],o$$=o$r[15],o$y=o$k*o$L-o$W*o$V,o$l=o$k*o$U-o$D*o$V,o$S=o$k*o$h-o$n*o$V,o$q=o$W*o$U-o$D*o$L,o$b=o$W*o$h-o$n*o$L,o$F=o$D*o$h-o$n*o$U,o$P=o$p*o$_-o$i*o$j,o$t=o$p*o$K-o$v*o$j,o$H=o$p*o$$-o$x*o$j,o$R=o$i*o$K-o$v*o$_,o$u=o$i*o$$-o$x*o$_,o$s=o$v*o$$-o$x*o$K,o$z=o$y*o$s-o$l*o$u+o$S*o$R+o$q*o$H-o$b*o$t+o$F*o$P;0!==Math.abs(o$z)&&(o$z=1/o$z,o$T[0]=(o$L*o$s-o$U*o$u+o$h*o$R)*o$z,o$T[1]=(o$D*o$u-o$W*o$s-o$n*o$R)*o$z,o$T[2]=(o$_*o$F-o$K*o$b+o$$*o$q)*o$z,o$T[3]=(o$v*o$b-o$i*o$F-o$x*o$q)*o$z,o$T[4]=(o$U*o$H-o$V*o$s-o$h*o$t)*o$z,o$T[5]=(o$k*o$s-o$D*o$H+o$n*o$t)*o$z,o$T[6]=(o$K*o$S-o$j*o$F-o$$*o$l)*o$z,o$T[7]=(o$p*o$F-o$v*o$S+o$x*o$l)*o$z,o$T[8]=(o$V*o$u-o$L*o$H+o$h*o$P)*o$z,o$T[9]=(o$W*o$H-o$k*o$u-o$n*o$P)*o$z,o$T[10]=(o$j*o$b-o$_*o$S+o$$*o$y)*o$z,o$T[11]=(o$i*o$S-o$p*o$b-o$x*o$y)*o$z,o$T[12]=(o$L*o$t-o$V*o$R-o$U*o$P)*o$z,o$T[13]=(o$k*o$R-o$W*o$t+o$D*o$P)*o$z,o$T[14]=(o$_*o$l-o$j*o$q-o$K*o$y)*o$z,o$T[15]=(o$p*o$q-o$i*o$l+o$v*o$y)*o$z)},o$o.identity=function(){var o$o=this.elements;o$o[1]=o$o[2]=o$o[3]=o$o[4]=o$o[6]=o$o[7]=o$o[8]=o$o[9]=o$o[11]=o$o[12]=o$o[13]=o$o[14]=0,o$o[0]=o$o[5]=o$o[10]=o$o[15]=1},o$o.cloneTo=function(o$o){var o$r,o$T,o$k;if((o$T=this.elements)!==(o$k=o$o.elements))for(o$r=0;o$r<16;++o$r)o$k[o$r]=o$T[o$r]},o$o.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$o.getTranslationVector=function(o$o){var o$r=this.elements,o$T=o$o.elements;o$T[0]=o$r[12],o$T[1]=o$r[13],o$T[2]=o$r[14]},o$o.setTranslationVector=function(o$o){var o$r=this.elements,o$T=o$o.elements;o$r[12]=o$T[0],o$r[13]=o$T[1],o$r[14]=o$T[2]},o$o.getForward=function(o$o){var o$r=this.elements,o$T=o$o.elements;o$T[0]=-o$r[8],o$T[1]=-o$r[9],o$T[2]=-o$r[10]},o$o.setForward=function(o$o){var o$r=this.elements,o$T=o$o.elements;o$r[8]=-o$T[0],o$r[9]=-o$T[1],o$r[10]=-o$T[2]},o$P.createRotationX=function(o$o,o$r){var o$T=o$r.elements,o$k=Math.sin(o$o),o$W=Math.cos(o$o);o$T[1]=o$T[2]=o$T[3]=o$T[4]=o$T[7]=o$T[8]=o$T[11]=o$T[12]=o$T[13]=o$T[14]=0,o$T[0]=o$T[15]=1,o$T[5]=o$T[10]=o$W,o$T[6]=o$k,o$T[9]=-o$k},o$P.createRotationY=function(o$o,o$r){var o$T=o$r.elements,o$k=Math.sin(o$o),o$W=Math.cos(o$o);o$T[1]=o$T[3]=o$T[4]=o$T[6]=o$T[7]=o$T[9]=o$T[11]=o$T[12]=o$T[13]=o$T[14]=0,o$T[5]=o$T[15]=1,o$T[0]=o$T[10]=o$W,o$T[2]=-o$k,o$T[8]=o$k},o$P.createRotationZ=function(o$o,o$r){var o$T=o$r.elements,o$k=Math.sin(o$o),o$W=Math.cos(o$o);o$T[2]=o$T[3]=o$T[6]=o$T[7]=o$T[8]=o$T[9]=o$T[11]=o$T[12]=o$T[13]=o$T[14]=0,o$T[10]=o$T[15]=1,o$T[0]=o$T[5]=o$W,o$T[1]=o$k,o$T[4]=-o$k},o$P.createRotationYawPitchRoll=function(o$o,o$r,o$T,o$k){o$Tr.createFromYawPitchRoll(o$o,o$r,o$T,o$P._tempQuaternion),o$P.createRotationQuaternion(o$P._tempQuaternion,o$k)},o$P.createRotationAxis=function(o$o,o$r,o$T){var o$k=o$o.elements,o$W=o$k[0],o$D=o$k[1],o$n=o$k[2],o$V=Math.cos(o$r),o$L=Math.sin(o$r),o$U=o$W*o$W,o$h=o$D*o$D,o$p=o$n*o$n,o$i=o$W*o$D,o$v=o$W*o$n,o$x=o$D*o$n,o$j=o$T.elements;o$j[3]=o$j[7]=o$j[11]=o$j[12]=o$j[13]=o$j[14]=0,o$j[15]=1,o$j[0]=o$U+o$V*(1-o$U),o$j[1]=o$i-o$V*o$i+o$L*o$n,o$j[2]=o$v-o$V*o$v-o$L*o$D,o$j[4]=o$i-o$V*o$i-o$L*o$n,o$j[5]=o$h+o$V*(1-o$h),o$j[6]=o$x-o$V*o$x+o$L*o$W,o$j[8]=o$v-o$V*o$v+o$L*o$D,o$j[9]=o$x-o$V*o$x-o$L*o$W,o$j[10]=o$p+o$V*(1-o$p)},o$P.createRotationQuaternion=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements,o$W=o$T[0],o$D=o$T[1],o$n=o$T[2],o$V=o$T[3],o$L=o$W*o$W,o$U=o$D*o$D,o$h=o$n*o$n,o$p=o$W*o$D,o$i=o$n*o$V,o$v=o$n*o$W,o$x=o$D*o$V,o$j=o$D*o$n,o$_=o$W*o$V;o$k[3]=o$k[7]=o$k[11]=o$k[12]=o$k[13]=o$k[14]=0,o$k[15]=1,o$k[0]=1-2*(o$U+o$h),o$k[1]=2*(o$p+o$i),o$k[2]=2*(o$v-o$x),o$k[4]=2*(o$p-o$i),o$k[5]=1-2*(o$h+o$L),o$k[6]=2*(o$j+o$_),o$k[8]=2*(o$v+o$x),o$k[9]=2*(o$j-o$_),o$k[10]=1-2*(o$U+o$L)},o$P.createTranslate=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements;o$k[4]=o$k[8]=o$k[1]=o$k[9]=o$k[2]=o$k[6]=o$k[3]=o$k[7]=o$k[11]=0,o$k[0]=o$k[5]=o$k[10]=o$k[15]=1,o$k[12]=o$T[0],o$k[13]=o$T[1],o$k[14]=o$T[2]},o$P.createScaling=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements;o$k[0]=o$T[0],o$k[5]=o$T[1],o$k[10]=o$T[2],o$k[1]=o$k[4]=o$k[8]=o$k[12]=o$k[9]=o$k[13]=o$k[2]=o$k[6]=o$k[14]=o$k[3]=o$k[7]=o$k[11]=0,o$k[15]=1},o$P.multiply=function(o$o,o$r,o$T){var o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h;for(o$W=o$T.elements,o$D=o$o.elements,o$W===(o$n=o$r.elements)&&(o$n=o$n.slice()),o$k=0;o$k<4;o$k++)o$V=o$D[o$k],o$L=o$D[o$k+4],o$U=o$D[o$k+8],o$h=o$D[o$k+12],o$W[o$k]=o$V*o$n[0]+o$L*o$n[1]+o$U*o$n[2]+o$h*o$n[3],o$W[o$k+4]=o$V*o$n[4]+o$L*o$n[5]+o$U*o$n[6]+o$h*o$n[7],o$W[o$k+8]=o$V*o$n[8]+o$L*o$n[9]+o$U*o$n[10]+o$h*o$n[11],o$W[o$k+12]=o$V*o$n[12]+o$L*o$n[13]+o$U*o$n[14]+o$h*o$n[15]},o$P.createFromQuaternion=function(o$o,o$r){var o$T=o$r.elements,o$k=o$o.elements,o$W=o$k[0],o$D=o$k[1],o$n=o$k[2],o$V=o$k[3],o$L=o$W+o$W,o$U=o$D+o$D,o$h=o$n+o$n,o$p=o$W*o$L,o$i=o$D*o$L,o$v=o$D*o$U,o$x=o$n*o$L,o$j=o$n*o$U,o$_=o$n*o$h,o$K=o$V*o$L,o$$=o$V*o$U,o$y=o$V*o$h;o$T[0]=1-o$v-o$_,o$T[1]=o$i+o$y,o$T[2]=o$x-o$$,o$T[3]=0,o$T[4]=o$i-o$y,o$T[5]=1-o$p-o$_,o$T[6]=o$j+o$K,o$T[7]=0,o$T[8]=o$x+o$$,o$T[9]=o$j-o$K,o$T[10]=1-o$p-o$v,o$T[11]=0,o$T[12]=0,o$T[13]=0,o$T[14]=0,o$T[15]=1},o$P.createAffineTransformation=function(o$o,o$r,o$T,o$k){var o$W=o$o.elements,o$D=o$r.elements,o$n=o$T.elements,o$V=o$k.elements,o$L=o$D[0],o$U=o$D[1],o$h=o$D[2],o$p=o$D[3],o$i=o$L+o$L,o$v=o$U+o$U,o$x=o$h+o$h,o$j=o$L*o$i,o$_=o$L*o$v,o$K=o$L*o$x,o$$=o$U*o$v,o$y=o$U*o$x,o$l=o$h*o$x,o$S=o$p*o$i,o$q=o$p*o$v,o$b=o$p*o$x,o$F=o$n[0],o$P=o$n[1],o$t=o$n[2];o$V[0]=(1-(o$$+o$l))*o$F,o$V[1]=(o$_+o$b)*o$F,o$V[2]=(o$K-o$q)*o$F,o$V[3]=0,o$V[4]=(o$_-o$b)*o$P,o$V[5]=(1-(o$j+o$l))*o$P,o$V[6]=(o$y+o$S)*o$P,o$V[7]=0,o$V[8]=(o$K+o$q)*o$t,o$V[9]=(o$y-o$S)*o$t,o$V[10]=(1-(o$j+o$$))*o$t,o$V[11]=0,o$V[12]=o$W[0],o$V[13]=o$W[1],o$V[14]=o$W[2],o$V[15]=1},o$P.createLookAt=function(o$o,o$r,o$T,o$k){var o$W=o$k.elements,o$D=o$P._tempVector0,o$n=o$P._tempVector1,o$V=o$P._tempVector2;o$nr.subtract(o$o,o$r,o$V),o$nr.normalize(o$V,o$V),o$nr.cross(o$T,o$V,o$D),o$nr.normalize(o$D,o$D),o$nr.cross(o$V,o$D,o$n),o$k.identity(),o$W[0]=o$D.x,o$W[4]=o$D.y,o$W[8]=o$D.z,o$W[1]=o$n.x,o$W[5]=o$n.y,o$W[9]=o$n.z,o$W[2]=o$V.x,o$W[6]=o$V.y,o$W[10]=o$V.z,o$W[12]=-o$nr.dot(o$D,o$o),o$W[13]=-o$nr.dot(o$n,o$o),o$W[14]=-o$nr.dot(o$V,o$o)},o$P.createPerspective=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$W.elements,o$n=1/Math.tan(o$o/2),o$V=1/(o$T-o$k);o$D[0]=o$n/o$r,o$D[5]=o$n,o$D[10]=(o$k+o$T)*o$V,o$D[11]=-1,o$D[14]=2*o$k*o$T*o$V,o$D[1]=o$D[2]=o$D[3]=o$D[4]=o$D[6]=o$D[7]=o$D[8]=o$D[9]=o$D[12]=o$D[13]=o$D[15]=0},o$P.createOrthoOffCenterRH=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){var o$V=o$n.elements,o$L=1/(o$o-o$r),o$U=1/(o$T-o$k),o$h=1/(o$W-o$D);o$V[1]=o$V[2]=o$V[3]=o$V[4]=o$V[6]=o$V[7]=o$V[8]=o$V[9]=o$V[11]=0,o$V[15]=1,o$V[0]=-2*o$L,o$V[5]=-2*o$U,o$V[10]=2*o$h,o$V[12]=(o$o+o$r)*o$L,o$V[13]=(o$k+o$T)*o$U,o$V[14]=(o$D+o$W)*o$h},o$P.translation=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements;o$k[0]=o$k[5]=o$k[10]=o$k[15]=1,o$k[12]=o$T[0],o$k[13]=o$T[1],o$k[14]=o$T[2]},o$p(o$P,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new o$P},"_tempVector0",function(){return this._tempVector0=new o$nr},"_tempVector1",function(){return this._tempVector1=new o$nr},"_tempVector2",function(){return this._tempVector2=new o$nr},"_tempQuaternion",function(){return this._tempQuaternion=new o$Tr},"DEFAULT",function(){return this.DEFAULT=new o$P},"ZERO",function(){return this.ZERO=new o$P(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),o$P}(),o$rr=(function(){function o$y(o$o,o$r){this.extents=null,this.transformation=null,this.extents=o$o,this.transformation=o$r}o$v(o$y,"laya.d3.math.OrientedBoundBox");var o$o=o$y.prototype;o$o.getCorners=function(o$o){var o$r=o$y._tempV30.elements,o$T=o$y._tempV31.elements,o$k=o$y._tempV32.elements,o$W=this.extents.elements;o$r[0]=o$W[0],o$r[1]=o$r[2]=0,o$T[1]=o$W[1],o$T[0]=o$T[2]=0,o$k[2]=o$W[2],o$k[0]=o$k[1]=0,o$nr.TransformNormal(o$y._tempV30,this.transformation,o$y._tempV30),o$nr.TransformNormal(o$y._tempV31,this.transformation,o$y._tempV31),o$nr.TransformNormal(o$y._tempV32,this.transformation,o$y._tempV32);var o$D=o$y._tempV33;this.transformation.getTranslationVector(o$D),o$o.length=8,o$nr.add(o$D,o$y._tempV30,o$y._tempV34),o$nr.add(o$y._tempV34,o$y._tempV31,o$y._tempV34),o$nr.add(o$y._tempV34,o$y._tempV32,o$o[0]),o$nr.add(o$D,o$y._tempV30,o$y._tempV34),o$nr.add(o$y._tempV34,o$y._tempV31,o$y._tempV34),o$nr.subtract(o$y._tempV34,o$y._tempV32,o$o[1]),o$nr.subtract(o$D,o$y._tempV30,o$y._tempV34),o$nr.add(o$y._tempV34,o$y._tempV31,o$y._tempV34),o$nr.subtract(o$y._tempV34,o$y._tempV32,o$o[2]),o$nr.subtract(o$D,o$y._tempV30,o$y._tempV34),o$nr.add(o$y._tempV34,o$y._tempV31,o$y._tempV34),o$nr.add(o$y._tempV34,o$y._tempV32,o$o[3]),o$nr.add(o$D,o$y._tempV30,o$y._tempV34),o$nr.subtract(o$y._tempV34,o$y._tempV31,o$y._tempV34),o$nr.add(o$y._tempV34,o$y._tempV32,o$o[4]),o$nr.add(o$D,o$y._tempV30,o$y._tempV34),o$nr.subtract(o$y._tempV34,o$y._tempV31,o$y._tempV34),o$nr.subtract(o$y._tempV34,o$y._tempV32,o$o[5]),o$nr.subtract(o$D,o$y._tempV30,o$y._tempV34),o$nr.subtract(o$y._tempV34,o$y._tempV31,o$y._tempV34),o$nr.subtract(o$y._tempV34,o$y._tempV32,o$o[6]),o$nr.subtract(o$D,o$y._tempV30,o$y._tempV34),o$nr.subtract(o$y._tempV34,o$y._tempV31,o$y._tempV34),o$nr.add(o$y._tempV34,o$y._tempV32,o$o[7])},o$o.transform=function(o$o){o$or.multiply(this.transformation,o$o,this.transformation)},o$o.scale=function(o$o){o$nr.multiply(this.extents,o$o,this.extents)},o$o.translate=function(o$o){this.transformation.getTranslationVector(o$y._tempV30),o$nr.add(o$y._tempV30,o$o,o$y._tempV31),this.transformation.setTranslationVector(o$y._tempV31)},o$o.Size=function(o$o){o$nr.scale(this.extents,2,o$o)},o$o.getSize=function(o$o){var o$r=this.extents.elements;o$y._tempV30.x=o$r[0],o$y._tempV31.y=o$r[1],o$y._tempV32.z=o$r[2],o$nr.TransformNormal(o$y._tempV30,this.transformation,o$y._tempV30),o$nr.TransformNormal(o$y._tempV31,this.transformation,o$y._tempV31),o$nr.TransformNormal(o$y._tempV31,this.transformation,o$y._tempV32);var o$T=o$o.elements;o$T[0]=o$nr.scalarLength(o$y._tempV30),o$T[1]=o$nr.scalarLength(o$y._tempV31),o$T[2]=o$nr.scalarLength(o$y._tempV32)},o$o.getSizeSquared=function(o$o){var o$r=this.extents.elements;o$y._tempV30.x=o$r[0],o$y._tempV31.y=o$r[1],o$y._tempV32.z=o$r[2],o$nr.TransformNormal(o$y._tempV30,this.transformation,o$y._tempV30),o$nr.TransformNormal(o$y._tempV31,this.transformation,o$y._tempV31),o$nr.TransformNormal(o$y._tempV31,this.transformation,o$y._tempV32);var o$T=o$o.elements;o$T[0]=o$nr.scalarLengthSquared(o$y._tempV30),o$T[1]=o$nr.scalarLengthSquared(o$y._tempV31),o$T[2]=o$nr.scalarLengthSquared(o$y._tempV32)},o$o.getCenter=function(o$o){this.transformation.getTranslationVector(o$o)},o$o.containsPoint=function(o$o){var o$r=this.extents.elements,o$T=o$r[0],o$k=o$r[1],o$W=o$r[2];this.transformation.invert(o$y._tempM0),o$nr.transformCoordinate(o$o,o$y._tempM0,o$y._tempV30);var o$D=o$y._tempV30.elements,o$n=Math.abs(o$D[0]),o$V=Math.abs(o$D[1]),o$L=Math.abs(o$D[2]);return o$Eo.nearEqual(o$n,o$T)&&o$Eo.nearEqual(o$V,o$k)&&o$Eo.nearEqual(o$L,o$W)?2:o$n<o$T&&o$V<o$k&&o$L<o$W?1:0},o$o.containsPoints=function(o$o){var o$r=this.extents.elements,o$T=o$r[0],o$k=o$r[1],o$W=o$r[2];this.transformation.invert(o$y._tempM0);for(var o$D=!0,o$n=!1,o$V=0;o$V<o$o.length;o$V++){o$nr.transformCoordinate(o$o[o$V],o$y._tempM0,o$y._tempV30);var o$L=o$y._tempV30.elements,o$U=Math.abs(o$L[0]),o$h=Math.abs(o$L[1]),o$p=Math.abs(o$L[2]);o$Eo.nearEqual(o$U,o$T)&&o$Eo.nearEqual(o$h,o$k)&&o$Eo.nearEqual(o$p,o$W)&&(o$n=!0),o$U<o$T&&o$h<o$k&&o$p<o$W?o$n=!0:o$D=!1}return o$D?1:o$n?2:0},o$o.containsSphere=function(o$o,o$r){void 0===o$r&&(o$r=!1);var o$T=this.extents.elements,o$k=o$T[0],o$W=o$T[1],o$D=o$T[2],o$n=o$o.radius;this.transformation.invert(o$y._tempM0),o$nr.transformCoordinate(o$o.center,o$y._tempM0,o$y._tempV30);var o$V=NaN;if(o$V=o$r?o$n:(o$nr.scale(o$nr.UnitX,o$n,o$y._tempV31),o$nr.TransformNormal(o$y._tempV31,o$y._tempM0,o$y._tempV31),o$nr.scalarLength(o$y._tempV31)),o$nr.scale(this.extents,-1,o$y._tempV32),o$nr.Clamp(o$y._tempV30,o$y._tempV32,this.extents,o$y._tempV33),o$V*o$V<o$nr.distanceSquared(o$y._tempV30,o$y._tempV33))return 0;var o$L=o$y._tempV30.elements,o$U=o$L[0],o$h=o$L[1],o$p=o$L[2],o$i=o$y._tempV32.elements,o$v=o$i[0],o$x=o$i[1],o$j=o$i[2];return o$v+o$V<=o$U&&o$U<=o$k-o$V&&o$V<o$k-o$v&&o$x+o$V<=o$h&&o$h<=o$W-o$V&&o$V<o$W-o$x&&o$j+o$V<=o$p&&o$p<=o$D-o$V&&o$V<o$D-o$j?1:2},o$o.containsOrientedBoundBox=function(o$o){var o$r=0,o$T=0;o$o.getCorners(o$y._corners);var o$k=this.containsPoints(o$y._corners);if(0!=o$k)return o$k;var o$W=this.extents.elements;o$o.extents.cloneTo(o$y._tempV35);var o$D=o$y._tempV35.elements;o$y._getRows(this.transformation,o$y._rows1),o$y._getRows(o$o.transformation,o$y._rows2);var o$n=NaN;for(o$r=0;o$r<4;o$r++)for(o$T=0;o$T<4;o$T++)3==o$r||3==o$T?(o$y._tempM0.setElementByRowColumn(o$r,o$T,0),o$y._tempM1.setElementByRowColumn(o$r,o$T,0)):(o$n=o$nr.dot(o$y._rows1[o$r],o$y._rows2[o$T]),o$y._tempM0.setElementByRowColumn(o$r,o$T,o$n),o$y._tempM1.setElementByRowColumn(o$r,o$T,Math.abs(o$n)));o$o.getCenter(o$y._tempV34),this.getCenter(o$y._tempV36),o$nr.subtract(o$y._tempV34,o$y._tempV36,o$y._tempV30);var o$V=o$y._tempV31.elements;o$V[0]=o$nr.dot(o$y._tempV30,o$y._rows1[0]),o$V[1]=o$nr.dot(o$y._tempV30,o$y._rows1[1]),o$V[2]=o$nr.dot(o$y._tempV30,o$y._rows1[2]);var o$L=o$y._tempV32.elements,o$U=o$y._tempV33.elements;for(o$r=0;o$r<3;o$r++)if(o$L[0]=o$y._tempM1.getElementByRowColumn(o$r,0),o$L[1]=o$y._tempM1.getElementByRowColumn(o$r,1),o$L[2]=o$y._tempM1.getElementByRowColumn(o$r,2),o$W[o$r]+o$nr.dot(o$y._tempV35,o$y._tempV32)<Math.abs(o$V[o$r]))return 0;for(o$T=0;o$T<3;o$T++)if(o$L[0]=o$y._tempM1.getElementByRowColumn(0,o$T),o$L[1]=o$y._tempM1.getElementByRowColumn(1,o$T),o$L[2]=o$y._tempM1.getElementByRowColumn(2,o$T),o$U[0]=o$y._tempM0.getElementByRowColumn(0,o$T),o$U[1]=o$y._tempM0.getElementByRowColumn(1,o$T),o$U[2]=o$y._tempM0.getElementByRowColumn(2,o$T),o$nr.dot(this.extents,o$y._tempV32)+o$D[o$T]<Math.abs(o$nr.dot(o$y._tempV31,o$y._tempV33)))return 0;for(o$r=0;o$r<3;o$r++)for(o$T=0;o$T<3;o$T++){var o$h=(o$r+1)%3,o$p=(o$r+2)%3,o$i=(o$T+1)%3,o$v=(o$T+2)%3;if(o$W[o$h]*o$y._tempM1.getElementByRowColumn(o$p,o$T)+o$W[o$p]*o$y._tempM1.getElementByRowColumn(o$h,o$T)+(o$D[o$i]*o$y._tempM1.getElementByRowColumn(o$r,o$v)+o$D[o$v]*o$y._tempM1.getElementByRowColumn(o$r,o$i))<Math.abs(o$V[o$p]*o$y._tempM0.getElementByRowColumn(o$h,o$T)-o$V[o$h]*o$y._tempM0.getElementByRowColumn(o$p,o$T)))return 0}return 2},o$o.containsLine=function(o$o,o$r){o$y._corners[0]=o$o,o$y._corners[1]=o$r;var o$T=this.containsPoints(o$y._corners);if(0!=o$T)return o$T;var o$k=this.extents.elements,o$W=o$k[0],o$D=o$k[1],o$n=o$k[2];this.transformation.invert(o$y._tempM0),o$nr.transformCoordinate(o$o,o$y._tempM0,o$y._tempV30),o$nr.transformCoordinate(o$r,o$y._tempM0,o$y._tempV31),o$nr.add(o$y._tempV30,o$y._tempV31,o$y._tempV32),o$nr.scale(o$y._tempV32,.5,o$y._tempV32),o$nr.subtract(o$y._tempV30,o$y._tempV32,o$y._tempV33);var o$V=o$y._tempV33.elements,o$L=o$V[0],o$U=o$V[1],o$h=o$V[2],o$p=o$y._tempV34.elements,o$i=o$p[0]=Math.abs(o$V[0]),o$v=o$p[1]=Math.abs(o$V[1]),o$x=o$p[2]=Math.abs(o$V[2]),o$j=o$y._tempV32.elements,o$_=o$j[0],o$K=o$j[1],o$$=o$j[2];return Math.abs(o$_)>o$W+o$i?0:Math.abs(o$K)>o$D+o$v?0:Math.abs(o$$)>o$n+o$x?0:Math.abs(o$K*o$h-o$$*o$U)>o$D*o$x+o$n*o$v?0:Math.abs(o$_*o$h-o$$*o$L)>o$W*o$x+o$n*o$i?0:Math.abs(o$_*o$U-o$K*o$L)>o$W*o$v+o$D*o$i?0:2},o$o.containsBoundBox=function(o$o){var o$r=0,o$T=0,o$k=o$o.min,o$W=o$o.max;o$o.getCorners(o$y._corners);var o$D=this.containsPoints(o$y._corners);if(0!=o$D)return o$D;o$nr.subtract(o$W,o$k,o$y._tempV30),o$nr.scale(o$y._tempV30,.5,o$y._tempV30),o$nr.add(o$k,o$y._tempV30,o$y._tempV30),o$nr.subtract(o$W,o$y._tempV30,o$y._tempV31);var o$n=this.extents.elements,o$V=o$y._tempV31.elements;o$y._getRows(this.transformation,o$y._rows1),this.transformation.invert(o$y._tempM0);for(o$r=0;o$r<3;o$r++)for(o$T=0;o$T<3;o$T++)o$y._tempM1.setElementByRowColumn(o$r,o$T,Math.abs(o$y._tempM0.getElementByRowColumn(o$r,o$T)));this.getCenter(o$y._tempV35),o$nr.subtract(o$y._tempV30,o$y._tempV35,o$y._tempV32);var o$L=o$y._tempV31.elements;o$L[0]=o$nr.dot(o$y._tempV32,o$y._rows1[0]),o$L[1]=o$nr.dot(o$y._tempV32,o$y._rows1[1]),o$L[2]=o$nr.dot(o$y._tempV32,o$y._rows1[2]);var o$U=o$y._tempV33.elements,o$h=o$y._tempV34.elements;for(o$r=0;o$r<3;o$r++)if(o$U[0]=o$y._tempM1.getElementByRowColumn(o$r,0),o$U[1]=o$y._tempM1.getElementByRowColumn(o$r,1),o$U[2]=o$y._tempM1.getElementByRowColumn(o$r,2),o$n[o$r]+o$nr.dot(o$y._tempV31,o$y._tempV33)<Math.abs(o$L[o$r]))return 0;for(o$T=0;o$T<3;o$T++)if(o$U[0]=o$y._tempM1.getElementByRowColumn(0,o$T),o$U[1]=o$y._tempM1.getElementByRowColumn(1,o$T),o$U[2]=o$y._tempM1.getElementByRowColumn(2,o$T),o$h[0]=o$y._tempM0.getElementByRowColumn(0,o$T),o$h[1]=o$y._tempM0.getElementByRowColumn(1,o$T),o$h[2]=o$y._tempM0.getElementByRowColumn(2,o$T),o$nr.dot(this.extents,o$y._tempV33)+o$V[o$T]<Math.abs(o$nr.dot(o$y._tempV31,o$y._tempV34)))return 0;for(o$r=0;o$r<3;o$r++)for(o$T=0;o$T<3;o$T++){var o$p=(o$r+1)%3,o$i=(o$r+2)%3,o$v=(o$T+1)%3,o$x=(o$T+2)%3;if(o$n[o$p]*o$y._tempM1.getElementByRowColumn(o$i,o$T)+o$n[o$i]*o$y._tempM1.getElementByRowColumn(o$p,o$T)+(o$V[o$v]*o$y._tempM1.getElementByRowColumn(o$r,o$x)+o$V[o$x]*o$y._tempM1.getElementByRowColumn(o$r,o$v))<Math.abs(o$L[o$i]*o$y._tempM0.getElementByRowColumn(o$p,o$T)-o$L[o$p]*o$y._tempM0.getElementByRowColumn(o$i,o$T)))return 0}return 2},o$o.intersectsRay=function(o$o,o$r){o$nr.scale(this.extents,-1,o$y._tempV30),this.transformation.invert(o$y._tempM0),o$nr.TransformNormal(o$o.direction,o$y._tempM0,o$y._ray.direction),o$nr.transformCoordinate(o$o.origin,o$y._tempM0,o$y._ray.origin),o$y._boxBound1.min=o$y._tempV30,o$y._boxBound1.max=this.extents;var o$T=Collision.intersectsRayAndBoxRP(o$y._ray,o$y._boxBound1,o$r);return-1!==o$T&&o$nr.transformCoordinate(o$r,this.transformation,o$r),o$T},o$o._getLocalCorners=function(o$o){o$o.length=8;var o$r=this.extents.elements;o$y._tempV30.x=o$r[0],o$y._tempV31.y=o$r[1],o$y._tempV32.z=o$r[2],o$nr.add(o$y._tempV30,o$y._tempV31,o$y._tempV33),o$nr.add(o$y._tempV33,o$y._tempV32,o$o[0]),o$nr.add(o$y._tempV30,o$y._tempV31,o$y._tempV33),o$nr.subtract(o$y._tempV33,o$y._tempV32,o$o[1]),o$nr.subtract(o$y._tempV31,o$y._tempV30,o$y._tempV33),o$nr.subtract(o$y._tempV33,o$y._tempV30,o$o[2]),o$nr.subtract(o$y._tempV31,o$y._tempV30,o$y._tempV33),o$nr.add(o$y._tempV33,o$y._tempV32,o$o[3]),o$nr.subtract(o$y._tempV30,o$y._tempV31,o$y._tempV33),o$nr.add(o$y._tempV33,o$y._tempV32,o$o[4]),o$nr.subtract(o$y._tempV30,o$y._tempV31,o$y._tempV33),o$nr.subtract(o$y._tempV33,o$y._tempV32,o$o[5]),o$nr.scale(o$o[0],-1,o$o[6]),o$nr.subtract(o$y._tempV32,o$y._tempV30,o$y._tempV33),o$nr.subtract(o$y._tempV33,o$y._tempV31,o$o[7])},o$o.equals=function(o$o){return this.extents==o$o.extents&&this.transformation==o$o.transformation},o$o.cloneTo=function(o$o){var o$r=o$o;this.extents.cloneTo(o$r.extents),this.transformation.cloneTo(o$r.transformation)},o$y.createByBoundBox=function(o$o,o$r){var o$T=o$o.min,o$k=o$o.max;o$nr.subtract(o$k,o$T,o$y._tempV30),o$nr.scale(o$y._tempV30,.5,o$y._tempV30),o$nr.add(o$T,o$y._tempV30,o$y._tempV31),o$nr.subtract(o$k,o$y._tempV31,o$y._tempV32),o$or.translation(o$y._tempV31,o$y._tempM0);var o$W=o$y._tempV32.clone(),o$D=o$y._tempM0.clone();o$r.extents=o$W,o$r.transformation=o$D},o$y.createByMinAndMaxVertex=function(o$o,o$r){return o$nr.subtract(o$r,o$o,o$y._tempV30),o$nr.scale(o$y._tempV30,.5,o$y._tempV30),o$nr.add(o$o,o$y._tempV30,o$y._tempV31),o$nr.subtract(o$r,o$y._tempV31,o$y._tempV32),o$or.translation(o$y._tempV31,o$y._tempM0),new o$y(o$y._tempV32,o$y._tempM0)},o$y._getRows=function(o$o,o$r){o$r.length=3;var o$T=o$o.elements,o$k=o$r[0].elements;o$k[0]=o$T[0],o$k[1]=o$T[1],o$k[2]=o$T[2];var o$W=o$r[1].elements;o$W[0]=o$T[4],o$W[1]=o$T[5],o$W[2]=o$T[6];var o$D=o$r[2].elements;o$D[0]=o$T[8],o$D[1]=o$T[9],o$D[2]=o$T[10]},o$y.getObbtoObbMatrix4x4=function(o$o,o$r,o$T,o$k){var o$W=o$o.transformation,o$D=o$r.transformation;if(o$T){o$y._getRows(o$W,o$y._rows1),o$y._getRows(o$D,o$y._rows2);for(var o$n=0;o$n<3;o$n++)for(var o$V=0;o$V<3;o$V++)o$k.setElementByRowColumn(o$n,o$V,o$nr.dot(o$y._rows2[o$n],o$y._rows1[o$V]));o$r.getCenter(o$y._tempV30),o$o.getCenter(o$y._tempV31),o$nr.subtract(o$y._tempV30,o$y._tempV31,o$y._tempV32);var o$L=o$k.elements;o$L[12]=o$nr.dot(o$y._tempV32,o$y._rows1[0]),o$L[13]=o$nr.dot(o$y._tempV32,o$y._rows1[1]),o$L[14]=o$nr.dot(o$y._tempV32,o$y._rows1[2]),o$L[15]=1}else o$W.invert(o$y._tempM0),o$or.multiply(o$D,o$y._tempM0,o$k)},o$y.merge=function(o$o,o$r,o$T){var o$k=o$o.extents,o$W=o$o.transformation;o$y.getObbtoObbMatrix4x4(o$o,o$r,o$T,o$y._tempM0),o$r._getLocalCorners(o$y._corners),o$nr.transformCoordinate(o$y._corners[0],o$y._tempM0,o$y._corners[0]),o$nr.transformCoordinate(o$y._corners[1],o$y._tempM0,o$y._corners[1]),o$nr.transformCoordinate(o$y._corners[2],o$y._tempM0,o$y._corners[2]),o$nr.transformCoordinate(o$y._corners[3],o$y._tempM0,o$y._corners[3]),o$nr.transformCoordinate(o$y._corners[4],o$y._tempM0,o$y._corners[4]),o$nr.transformCoordinate(o$y._corners[5],o$y._tempM0,o$y._corners[5]),o$nr.transformCoordinate(o$y._corners[6],o$y._tempM0,o$y._corners[6]),o$nr.transformCoordinate(o$y._corners[7],o$y._tempM0,o$y._corners[7]),o$nr.scale(o$k,-1,o$y._boxBound1.min),o$k.cloneTo(o$y._boxBound1.max),o$Qo.createfromPoints(o$y._corners,o$y._boxBound2),o$Qo.merge(o$y._boxBound2,o$y._boxBound1,o$y._boxBound3);var o$D=o$y._boxBound3.min,o$n=o$y._boxBound3.max;o$nr.subtract(o$n,o$D,o$y._tempV30),o$nr.scale(o$y._tempV30,.5,o$y._tempV30),o$nr.add(o$D,o$y._tempV30,o$y._tempV32),o$nr.subtract(o$n,o$y._tempV32,o$k),o$nr.transformCoordinate(o$y._tempV32,o$W,o$y._tempV33)},o$p(o$y,["_tempV30",function(){return this._tempV30=new o$nr},"_tempV31",function(){return this._tempV31=new o$nr},"_tempV32",function(){return this._tempV32=new o$nr},"_tempV33",function(){return this._tempV33=new o$nr},"_tempV34",function(){return this._tempV34=new o$nr},"_tempV35",function(){return this._tempV35=new o$nr},"_tempV36",function(){return this._tempV36=new o$nr},"_tempM0",function(){return this._tempM0=new o$or},"_tempM1",function(){return this._tempM1=new o$or},"_corners",function(){return this._corners=[new o$nr,new o$nr,new o$nr,new o$nr,new o$nr,new o$nr,new o$nr,new o$nr]},"_rows1",function(){return this._rows1=[new o$nr,new o$nr,new o$nr]},"_rows2",function(){return this._rows2=[new o$nr,new o$nr,new o$nr]},"_ray",function(){return this._ray=new o$Wr(new o$nr,new o$nr)},"_boxBound1",function(){return this._boxBound1=new o$Qo(new o$nr,new o$nr)},"_boxBound2",function(){return this._boxBound2=new o$Qo(new o$nr,new o$nr)},"_boxBound3",function(){return this._boxBound3=new o$Qo(new o$nr,new o$nr)}])}(),function(){function o$S(o$o,o$r){this.normal=null,this.distance=NaN,void 0===o$r&&(o$r=0),this.normal=o$o,this.distance=o$r}return o$v(o$S,"laya.d3.math.Plane"),o$S.prototype.normalize=function(){var o$o=this.normal.elements,o$r=o$o[0],o$T=o$o[1],o$k=o$o[2],o$W=1/Math.sqrt(o$r*o$r+o$T*o$T+o$k*o$k);o$o[0]=o$r*o$W,o$o[1]=o$T*o$W,o$o[2]=o$k*o$W,this.distance*=o$W},o$S.createPlaneBy3P=function(o$o,o$r,o$T){var o$k=o$o.elements,o$W=o$r.elements,o$D=o$T.elements,o$n=o$W[0]-o$k[0],o$V=o$W[1]-o$k[1],o$L=o$W[2]-o$k[2],o$U=o$D[0]-o$k[0],o$h=o$D[1]-o$k[1],o$p=o$D[2]-o$k[2],o$i=o$V*o$p-o$L*o$h,o$v=o$L*o$U-o$n*o$p,o$x=o$n*o$h-o$V*o$U,o$j=1/Math.sqrt(o$i*o$i+o$v*o$v+o$x*o$x),o$_=o$i*o$j,o$K=o$v*o$j,o$$=o$x*o$j,o$y=o$S._TEMPVec3.elements;o$y[0]=o$_,o$y[1]=o$K,o$y[2]=o$$;var o$l=-(o$_*o$k[0]+o$K*o$k[1]+o$$*o$k[2]);return new o$S(o$S._TEMPVec3,o$l)},o$S.PlaneIntersectionType_Back=0,o$S.PlaneIntersectionType_Front=1,o$S.PlaneIntersectionType_Intersecting=2,o$p(o$S,["_TEMPVec3",function(){return this._TEMPVec3=new o$nr}]),o$S}()),o$Tr=function(){function o$W(o$o,o$r,o$T,o$k){this.elements=new Float32Array(4),void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=1),this.elements[0]=o$o,this.elements[1]=o$r,this.elements[2]=o$T,this.elements[3]=o$k}o$v(o$W,"laya.d3.math.Quaternion");var o$o=o$W.prototype;return o$S.imps(o$o,{"laya.d3.core.IClone":!0}),o$o.scaling=function(o$o,o$r){var o$T=o$r.elements,o$k=this.elements;o$T[0]=o$k[0]*o$o,o$T[1]=o$k[1]*o$o,o$T[2]=o$k[2]*o$o,o$T[3]=o$k[3]*o$o},o$o.normalize=function(o$o){var o$r=o$o.elements,o$T=this.elements,o$k=o$T[0],o$W=o$T[1],o$D=o$T[2],o$n=o$T[3],o$V=o$k*o$k+o$W*o$W+o$D*o$D+o$n*o$n;0<o$V&&(o$V=1/Math.sqrt(o$V),o$r[0]=o$k*o$V,o$r[1]=o$W*o$V,o$r[2]=o$D*o$V,o$r[3]=o$n*o$V)},o$o.length=function(){var o$o=this.elements,o$r=o$o[0],o$T=o$o[1],o$k=o$o[2],o$W=o$o[3];return Math.sqrt(o$r*o$r+o$T*o$T+o$k*o$k+o$W*o$W)},o$o.rotateX=function(o$o,o$r){var o$T=o$r.elements,o$k=this.elements;o$o*=.5;var o$W=o$k[0],o$D=o$k[1],o$n=o$k[2],o$V=o$k[3],o$L=Math.sin(o$o),o$U=Math.cos(o$o);o$T[0]=o$W*o$U+o$V*o$L,o$T[1]=o$D*o$U+o$n*o$L,o$T[2]=o$n*o$U-o$D*o$L,o$T[3]=o$V*o$U-o$W*o$L},o$o.rotateY=function(o$o,o$r){var o$T=o$r.elements,o$k=this.elements;o$o*=.5;var o$W=o$k[0],o$D=o$k[1],o$n=o$k[2],o$V=o$k[3],o$L=Math.sin(o$o),o$U=Math.cos(o$o);o$T[0]=o$W*o$U-o$n*o$L,o$T[1]=o$D*o$U+o$V*o$L,o$T[2]=o$n*o$U+o$W*o$L,o$T[3]=o$V*o$U-o$D*o$L},o$o.rotateZ=function(o$o,o$r){var o$T=o$r.elements,o$k=this.elements;o$o*=.5;var o$W=o$k[0],o$D=o$k[1],o$n=o$k[2],o$V=o$k[3],o$L=Math.sin(o$o),o$U=Math.cos(o$o);o$T[0]=o$W*o$U+o$D*o$L,o$T[1]=o$D*o$U-o$W*o$L,o$T[2]=o$n*o$U+o$V*o$L,o$T[3]=o$V*o$U-o$n*o$L},o$o.getYawPitchRoll=function(o$o){o$nr.transformQuat(o$nr.ForwardRH,this,o$W.TEMPVector31),o$nr.transformQuat(o$nr.Up,this,o$W.TEMPVector32);var o$r=o$W.TEMPVector32.elements;o$W.angleTo(o$nr.ZERO,o$W.TEMPVector31,o$W.TEMPVector33);var o$T=o$W.TEMPVector33.elements;o$T[0]==Math.PI/2?(o$T[1]=o$W.arcTanAngle(o$r[2],o$r[0]),o$T[2]=0):o$T[0]==-Math.PI/2?(o$T[1]=o$W.arcTanAngle(-o$r[2],-o$r[0]),o$T[2]=0):(o$or.createRotationY(-o$T[1],o$W.TEMPMatrix0),o$or.createRotationX(-o$T[0],o$W.TEMPMatrix1),o$nr.transformCoordinate(o$W.TEMPVector32,o$W.TEMPMatrix0,o$W.TEMPVector32),o$nr.transformCoordinate(o$W.TEMPVector32,o$W.TEMPMatrix1,o$W.TEMPVector32),o$T[2]=o$W.arcTanAngle(o$r[1],-o$r[0])),o$T[1]<=-Math.PI&&(o$T[1]=Math.PI),o$T[2]<=-Math.PI&&(o$T[2]=Math.PI),o$T[1]>=Math.PI&&o$T[2]>=Math.PI&&(o$T[1]=0,o$T[2]=0,o$T[0]=Math.PI-o$T[0]);var o$k=o$o.elements;o$k[0]=o$T[1],o$k[1]=o$T[0],o$k[2]=o$T[2]},o$o.invert=function(o$o){var o$r=o$o.elements,o$T=this.elements,o$k=o$T[0],o$W=o$T[1],o$D=o$T[2],o$n=o$T[3],o$V=o$k*o$k+o$W*o$W+o$D*o$D+o$n*o$n,o$L=o$V?1/o$V:0;o$r[0]=-o$k*o$L,o$r[1]=-o$W*o$L,o$r[2]=-o$D*o$L,o$r[3]=o$n*o$L},o$o.identity=function(){var o$o=this.elements;o$o[0]=0,o$o[1]=0,o$o[2]=0,o$o[3]=1},o$o.fromArray=function(o$o,o$r){void 0===o$r&&(o$r=0),this.elements[0]=o$o[o$r+0],this.elements[1]=o$o[o$r+1],this.elements[2]=o$o[o$r+2],this.elements[3]=o$o[o$r+3]},o$o.cloneTo=function(o$o){var o$r,o$T,o$k;if((o$T=this.elements)!==(o$k=o$o.elements))for(o$r=0;o$r<4;++o$r)o$k[o$r]=o$T[o$r]},o$o.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$o.equals=function(o$o){var o$r=this.elements,o$T=o$o.elements;return o$Eo.nearEqual(o$r[0],o$T[0])&&o$Eo.nearEqual(o$r[1],o$T[1])&&o$Eo.nearEqual(o$r[2],o$T[2])&&o$Eo.nearEqual(o$r[3],o$T[3])},o$o.lengthSquared=function(){var o$o=this.elements[0],o$r=this.elements[1],o$T=this.elements[2],o$k=this.elements[3];return o$o*o$o+o$r*o$r+o$T*o$T+o$k*o$k},o$x(0,o$o,"x",function(){return this.elements[0]}),o$x(0,o$o,"y",function(){return this.elements[1]}),o$x(0,o$o,"z",function(){return this.elements[2]}),o$x(0,o$o,"w",function(){return this.elements[3]}),o$W.createFromYawPitchRoll=function(o$o,o$r,o$T,o$k){var o$W=.5*o$T,o$D=.5*o$r,o$n=.5*o$o,o$V=Math.sin(o$W),o$L=Math.cos(o$W),o$U=Math.sin(o$D),o$h=Math.cos(o$D),o$p=Math.sin(o$n),o$i=Math.cos(o$n),o$v=o$k.elements;o$v[0]=o$i*o$U*o$L+o$p*o$h*o$V,o$v[1]=o$p*o$h*o$L-o$i*o$U*o$V,o$v[2]=o$i*o$h*o$V-o$p*o$U*o$L,o$v[3]=o$i*o$h*o$L+o$p*o$U*o$V},o$W.multiply=function(o$o,o$r,o$T){var o$k=o$o.elements,o$W=o$r.elements,o$D=o$T.elements,o$n=o$k[0],o$V=o$k[1],o$L=o$k[2],o$U=o$k[3],o$h=o$W[0],o$p=o$W[1],o$i=o$W[2],o$v=o$W[3],o$x=o$V*o$i-o$L*o$p,o$j=o$L*o$h-o$n*o$i,o$_=o$n*o$p-o$V*o$h,o$K=o$n*o$h+o$V*o$p+o$L*o$i;o$D[0]=o$n*o$v+o$h*o$U+o$x,o$D[1]=o$V*o$v+o$p*o$U+o$j,o$D[2]=o$L*o$v+o$i*o$U+o$_,o$D[3]=o$U*o$v-o$K},o$W.arcTanAngle=function(o$o,o$r){return 0==o$o?1==o$r?Math.PI/2:-Math.PI/2:0<o$o?Math.atan(o$r/o$o):o$o<0?0<o$r?Math.atan(o$r/o$o)+Math.PI:Math.atan(o$r/o$o)-Math.PI:0},o$W.angleTo=function(o$o,o$r,o$T){o$nr.subtract(o$r,o$o,o$W.TEMPVector30),o$nr.normalize(o$W.TEMPVector30,o$W.TEMPVector30),o$T.elements[0]=Math.asin(o$W.TEMPVector30.y),o$T.elements[1]=o$W.arcTanAngle(-o$W.TEMPVector30.z,-o$W.TEMPVector30.x)},o$W.createFromAxisAngle=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements;o$r*=.5;var o$D=Math.sin(o$r);o$k[0]=o$D*o$W[0],o$k[1]=o$D*o$W[1],o$k[2]=o$D*o$W[2],o$k[3]=Math.cos(o$r)},o$W.createFromMatrix3x3=function(o$o,o$r){var o$T,o$k=o$r.elements,o$W=o$o.elements,o$D=o$W[0]+o$W[4]+o$W[8];if(0<o$D)o$T=Math.sqrt(o$D+1),o$k[3]=.5*o$T,o$T=.5/o$T,o$k[0]=(o$W[5]-o$W[7])*o$T,o$k[1]=(o$W[6]-o$W[2])*o$T,o$k[2]=(o$W[1]-o$W[3])*o$T;else{var o$n=0;o$W[4]>o$W[0]&&(o$n=1),o$W[8]>o$W[3*o$n+o$n]&&(o$n=2);var o$V=(o$n+1)%3,o$L=(o$n+2)%3;o$T=Math.sqrt(o$W[3*o$n+o$n]-o$W[3*o$V+o$V]-o$W[3*o$L+o$L]+1),o$k[o$n]=.5*o$T,o$T=.5/o$T,o$k[3]=(o$W[3*o$V+o$L]-o$W[3*o$L+o$V])*o$T,o$k[o$V]=(o$W[3*o$V+o$n]+o$W[3*o$n+o$V])*o$T,o$k[o$L]=(o$W[3*o$L+o$n]+o$W[3*o$n+o$L])*o$T}},o$W.createFromMatrix4x4=function(o$o,o$r){var o$T,o$k,o$W=o$o.elements,o$D=o$r.elements,o$n=o$W[0]+o$W[5]+o$W[10];0<o$n?(o$T=Math.sqrt(o$n+1),o$D[3]=.5*o$T,o$T=.5/o$T,o$D[0]=(o$W[6]-o$W[9])*o$T,o$D[1]=(o$W[8]-o$W[2])*o$T,o$D[2]=(o$W[1]-o$W[4])*o$T):o$W[0]>=o$W[5]&&o$W[0]>=o$W[10]?(o$k=.5/(o$T=Math.sqrt(1+o$W[0]-o$W[5]-o$W[10])),o$D[0]=.5*o$T,o$D[1]=(o$W[1]+o$W[4])*o$k,o$D[2]=(o$W[2]+o$W[8])*o$k,o$D[3]=(o$W[6]-o$W[9])*o$k):o$W[5]>o$W[10]?(o$k=.5/(o$T=Math.sqrt(1+o$W[5]-o$W[0]-o$W[10])),o$D[0]=(o$W[4]+o$W[1])*o$k,o$D[1]=.5*o$T,o$D[2]=(o$W[9]+o$W[6])*o$k,o$D[3]=(o$W[8]-o$W[2])*o$k):(o$k=.5/(o$T=Math.sqrt(1+o$W[10]-o$W[0]-o$W[5])),o$D[0]=(o$W[8]+o$W[2])*o$k,o$D[1]=(o$W[9]+o$W[6])*o$k,o$D[2]=.5*o$T,o$D[3]=(o$W[1]-o$W[4])*o$k)},o$W.slerp=function(o$o,o$r,o$T,o$k){var o$W,o$D,o$n,o$V,o$L,o$U=o$o.elements,o$h=o$r.elements,o$p=o$k.elements,o$i=o$U[0],o$v=o$U[1],o$x=o$U[2],o$j=o$U[3],o$_=o$h[0],o$K=o$h[1],o$$=o$h[2],o$y=o$h[3];return(o$D=o$i*o$_+o$v*o$K+o$x*o$$+o$j*o$y)<0&&(o$D=-o$D,o$_=-o$_,o$K=-o$K,o$$=-o$$,o$y=-o$y),o$L=1e-6<1-o$D?(o$W=Math.acos(o$D),o$n=Math.sin(o$W),o$V=Math.sin((1-o$T)*o$W)/o$n,Math.sin(o$T*o$W)/o$n):(o$V=1-o$T,o$T),o$p[0]=o$V*o$i+o$L*o$_,o$p[1]=o$V*o$v+o$L*o$K,o$p[2]=o$V*o$x+o$L*o$$,o$p[3]=o$V*o$j+o$L*o$y,o$p},o$W.lerp=function(o$o,o$r,o$T,o$k){var o$W=o$k.elements,o$D=o$o.elements,o$n=o$r.elements,o$V=o$D[0],o$L=o$D[1],o$U=o$D[2],o$h=o$D[3];o$W[0]=o$V+o$T*(o$n[0]-o$V),o$W[1]=o$L+o$T*(o$n[1]-o$L),o$W[2]=o$U+o$T*(o$n[2]-o$U),o$W[3]=o$h+o$T*(o$n[3]-o$h)},o$W.add=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r.elements;o$k[0]=o$W[0]+o$D[0],o$k[1]=o$W[1]+o$D[1],o$k[2]=o$W[2]+o$D[2],o$k[3]=o$W[3]+o$D[3]},o$W.dot=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements;return o$T[0]*o$k[0]+o$T[1]*o$k[1]+o$T[2]*o$k[2]+o$T[3]*o$k[3]},o$W.rotationLookAt=function(o$o,o$r,o$T){o$W.lookAt(o$nr.ZERO,o$o,o$r,o$T)},o$W.lookAt=function(o$o,o$r,o$T,o$k){o$do.lookAt(o$o,o$r,o$T,o$W._tempMatrix3x3),o$W.rotationMatrix(o$W._tempMatrix3x3,o$k)},o$W.invert=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements,o$W=o$o.lengthSquared();o$Eo.isZero(o$W)||(o$W=1/o$W,o$k[0]=-o$T[0]*o$W,o$k[1]=-o$T[1]*o$W,o$k[2]=-o$T[2]*o$W,o$k[3]=o$T[3]*o$W)},o$W.rotationMatrix=function(o$o,o$r){var o$T=o$o.elements,o$k=o$T[0],o$W=o$T[1],o$D=o$T[2],o$n=o$T[3],o$V=o$T[4],o$L=o$T[5],o$U=o$T[6],o$h=o$T[7],o$p=o$T[8],o$i=o$r.elements,o$v=NaN,o$x=NaN,o$j=o$k+o$V+o$p;0<o$j?(o$v=Math.sqrt(o$j+1),o$i[3]=.5*o$v,o$v=.5/o$v,o$i[0]=(o$L-o$h)*o$v,o$i[1]=(o$U-o$D)*o$v,o$i[2]=(o$W-o$n)*o$v):o$V<=o$k&&o$p<=o$k?(o$x=.5/(o$v=Math.sqrt(1+o$k-o$V-o$p)),o$i[0]=.5*o$v,o$i[1]=(o$W+o$n)*o$x,o$i[2]=(o$D+o$U)*o$x,o$i[3]=(o$L-o$h)*o$x):o$p<o$V?(o$x=.5/(o$v=Math.sqrt(1+o$V-o$k-o$p)),o$i[0]=(o$n+o$W)*o$x,o$i[1]=.5*o$v,o$i[2]=(o$h+o$L)*o$x,o$i[3]=(o$U-o$D)*o$x):(o$x=.5/(o$v=Math.sqrt(1+o$p-o$k-o$V)),o$i[0]=(o$U+o$D)*o$x,o$i[1]=(o$h+o$L)*o$x,o$i[2]=.5*o$v,o$i[3]=(o$W-o$n)*o$x)},o$W.DEFAULT=new o$W,o$p(o$W,["TEMPVector30",function(){return this.TEMPVector30=new o$nr},"TEMPVector31",function(){return this.TEMPVector31=new o$nr},"TEMPVector32",function(){return this.TEMPVector32=new o$nr},"TEMPVector33",function(){return this.TEMPVector33=new o$nr},"TEMPMatrix0",function(){return this.TEMPMatrix0=new o$or},"TEMPMatrix1",function(){return this.TEMPMatrix1=new o$or},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new o$do},"NAN",function(){return this.NAN=new o$W(NaN,NaN,NaN,NaN)}]),o$W}(),o$kr=function(){function o$o(o$o){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=o$o,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}o$v(o$o,"laya.d3.math.Rand");var o$r=o$o.prototype;return o$r.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},o$r.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},o$r.getSignedFloat=function(){return 2*this.getFloat()-1},o$x(0,o$r,"seed",function(){return this.seeds[0]},function(o$o){this.seeds[0]=o$o,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),o$o.getFloatFromInt=function(o$o){return 1/8388607*(8388607&o$o)},o$o.getByteFromInt=function(o$o){return(8388607&o$o)>>>15},o$o}(),o$Wr=(function(){function o$W(o$o){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(o$o instanceof Array)||4!==o$o.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|o$o[0],this._state0L=0|o$o[1],this._state1U=0|o$o[2],this._state1L=0|o$o[3]}o$v(o$W,"laya.d3.math.RandX");var o$o=o$W.prototype;o$o.randomint=function(){var o$o=this._state0U,o$r=this._state0L,o$T=this._state1U,o$k=this._state1L,o$W=(o$k>>>0)+(o$r>>>0),o$D=o$T+o$o+(o$W/2>>>31)>>>0,o$n=o$W>>>0,o$V=0,o$L=0;o$V=(o$o^=o$V=o$o<<23|(-512&o$r)>>>9)^(this._state0U=o$T),o$L=(o$r^=o$L=o$r<<23)^(this._state0L=o$k);o$V^=o$o>>>18,o$L^=o$r>>>18|(262143&o$o)<<14;return o$V^=o$T>>>5,o$L^=o$k>>>5|(31&o$T)<<27,this._state1U=o$V,this._state1L=o$L,[o$D,o$n]},o$o.random=function(){var o$o=this.randomint(),o$r=o$o[0],o$T=1023<<20|o$r>>>12,o$k=0|(o$o[1]>>>12|(4095&o$r)<<20);return o$W._CONVERTION_BUFFER.setUint32(0,o$T,!1),o$W._CONVERTION_BUFFER.setUint32(4,o$k,!1),o$kr._CONVERTION_BUFFER.getFloat64(0,!1)-1},o$p(o$W,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new o$kr([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function o$o(o$o,o$r){this.origin=null,this.direction=null,this.origin=o$o,this.direction=o$r}return o$v(o$o,"laya.d3.math.Ray"),o$o}()),o$Dr=function(){function o$o(o$o,o$r){this.elements=new Float32Array(2),void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0);var o$T=this.elements;o$T[0]=o$o,o$T[1]=o$r}o$v(o$o,"laya.d3.math.Vector2");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r.fromArray=function(o$o,o$r){void 0===o$r&&(o$r=0),this.elements[0]=o$o[o$r+0],this.elements[1]=o$o[o$r+1]},o$r.cloneTo=function(o$o){var o$r=o$o.elements,o$T=this.elements;o$r[0]=o$T[0],o$r[1]=o$T[1]},o$r.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$r,"x",function(){return this.elements[0]},function(o$o){this.elements[0]=o$o}),o$x(0,o$r,"y",function(){return this.elements[1]},function(o$o){this.elements[1]=o$o}),o$o.scale=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements;o$k[0]=o$W[0]*o$r,o$k[1]=o$W[1]*o$r},o$p(o$o,["ZERO",function(){return this.ZERO=new o$o(0,0)},"ONE",function(){return this.ONE=new o$o(1,1)}]),o$o}(),o$nr=function(){function o$h(o$o,o$r,o$T){this.elements=new Float32Array(3),void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0);var o$k=this.elements;o$k[0]=o$o,o$k[1]=o$r,o$k[2]=o$T}o$v(o$h,"laya.d3.math.Vector3");var o$o=o$h.prototype;return o$S.imps(o$o,{"laya.d3.core.IClone":!0}),o$o.fromArray=function(o$o,o$r){void 0===o$r&&(o$r=0),this.elements[0]=o$o[o$r+0],this.elements[1]=o$o[o$r+1],this.elements[2]=o$o[o$r+2]},o$o.cloneTo=function(o$o){var o$r=o$o.elements,o$T=this.elements;o$r[0]=o$T[0],o$r[1]=o$T[1],o$r[2]=o$T[2]},o$o.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$o.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},o$o.reset=function(o$o,o$r,o$T){this.elements[0]=o$o,this.elements[1]=o$r,this.elements[2]=o$T},o$x(0,o$o,"x",function(){return this.elements[0]},function(o$o){this.elements[0]=o$o}),o$x(0,o$o,"y",function(){return this.elements[1]},function(o$o){this.elements[1]=o$o}),o$x(0,o$o,"z",function(){return this.elements[2]},function(o$o){this.elements[2]=o$o}),o$h.distanceSquared=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements,o$W=o$T[0]-o$k[0],o$D=o$T[1]-o$k[1],o$n=o$T[2]-o$k[2];return o$W*o$W+o$D*o$D+o$n*o$n},o$h.distance=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements,o$W=o$T[0]-o$k[0],o$D=o$T[1]-o$k[1],o$n=o$T[2]-o$k[2];return Math.sqrt(o$W*o$W+o$D*o$D+o$n*o$n)},o$h.min=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r.elements;o$k[0]=Math.min(o$W[0],o$D[0]),o$k[1]=Math.min(o$W[1],o$D[1]),o$k[2]=Math.min(o$W[2],o$D[2])},o$h.max=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r.elements;o$k[0]=Math.max(o$W[0],o$D[0]),o$k[1]=Math.max(o$W[1],o$D[1]),o$k[2]=Math.max(o$W[2],o$D[2])},o$h.transformQuat=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r.elements,o$n=o$W[0],o$V=o$W[1],o$L=o$W[2],o$U=o$D[0],o$h=o$D[1],o$p=o$D[2],o$i=o$D[3],o$v=o$i*o$n+o$h*o$L-o$p*o$V,o$x=o$i*o$V+o$p*o$n-o$U*o$L,o$j=o$i*o$L+o$U*o$V-o$h*o$n,o$_=-o$U*o$n-o$h*o$V-o$p*o$L;o$k[0]=o$v*o$i+o$_*-o$U+o$x*-o$p-o$j*-o$h,o$k[1]=o$x*o$i+o$_*-o$h+o$j*-o$U-o$v*-o$p,o$k[2]=o$j*o$i+o$_*-o$p+o$v*-o$h-o$x*-o$U},o$h.scalarLength=function(o$o){var o$r=o$o.elements,o$T=o$r[0],o$k=o$r[1],o$W=o$r[2];return Math.sqrt(o$T*o$T+o$k*o$k+o$W*o$W)},o$h.scalarLengthSquared=function(o$o){var o$r=o$o.elements,o$T=o$r[0],o$k=o$r[1],o$W=o$r[2];return o$T*o$T+o$k*o$k+o$W*o$W},o$h.normalize=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements,o$W=o$T[0],o$D=o$T[1],o$n=o$T[2],o$V=o$W*o$W+o$D*o$D+o$n*o$n;0<o$V&&(o$V=1/Math.sqrt(o$V),o$k[0]=o$T[0]*o$V,o$k[1]=o$T[1]*o$V,o$k[2]=o$T[2]*o$V)},o$h.multiply=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r.elements;o$k[0]=o$W[0]*o$D[0],o$k[1]=o$W[1]*o$D[1],o$k[2]=o$W[2]*o$D[2]},o$h.scale=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements;o$k[0]=o$W[0]*o$r,o$k[1]=o$W[1]*o$r,o$k[2]=o$W[2]*o$r},o$h.lerp=function(o$o,o$r,o$T,o$k){var o$W=o$k.elements,o$D=o$o.elements,o$n=o$r.elements,o$V=o$D[0],o$L=o$D[1],o$U=o$D[2];o$W[0]=o$V+o$T*(o$n[0]-o$V),o$W[1]=o$L+o$T*(o$n[1]-o$L),o$W[2]=o$U+o$T*(o$n[2]-o$U)},o$h.transformV3ToV3=function(o$o,o$r,o$T){var o$k=o$h._tempVector4;o$h.transformV3ToV4(o$o,o$r,o$k);var o$W=o$k.elements,o$D=o$T.elements;o$D[0]=o$W[0],o$D[1]=o$W[1],o$D[2]=o$W[2]},o$h.transformV3ToV4=function(o$o,o$r,o$T){var o$k=o$o.elements,o$W=o$k[0],o$D=o$k[1],o$n=o$k[2],o$V=o$r.elements,o$L=o$T.elements;o$L[0]=o$W*o$V[0]+o$D*o$V[4]+o$n*o$V[8]+o$V[12],o$L[1]=o$W*o$V[1]+o$D*o$V[5]+o$n*o$V[9]+o$V[13],o$L[2]=o$W*o$V[2]+o$D*o$V[6]+o$n*o$V[10]+o$V[14],o$L[3]=o$W*o$V[3]+o$D*o$V[7]+o$n*o$V[11]+o$V[15]},o$h.TransformNormal=function(o$o,o$r,o$T){var o$k=o$o.elements,o$W=o$k[0],o$D=o$k[1],o$n=o$k[2],o$V=o$r.elements,o$L=o$T.elements;o$L[0]=o$W*o$V[0]+o$D*o$V[4]+o$n*o$V[8],o$L[1]=o$W*o$V[1]+o$D*o$V[5]+o$n*o$V[9],o$L[2]=o$W*o$V[2]+o$D*o$V[6]+o$n*o$V[10]},o$h.transformCoordinate=function(o$o,o$r,o$T){var o$k=o$h._tempVector4.elements,o$W=o$o.elements,o$D=o$W[0],o$n=o$W[1],o$V=o$W[2],o$L=o$r.elements;o$k[0]=o$D*o$L[0]+o$n*o$L[4]+o$V*o$L[8]+o$L[12],o$k[1]=o$D*o$L[1]+o$n*o$L[5]+o$V*o$L[9]+o$L[13],o$k[2]=o$D*o$L[2]+o$n*o$L[6]+o$V*o$L[10]+o$L[14],o$k[3]=1/(o$D*o$L[3]+o$n*o$L[7]+o$V*o$L[11]+o$L[15]);var o$U=o$T.elements;o$U[0]=o$k[0]*o$k[3],o$U[1]=o$k[1]*o$k[3],o$U[2]=o$k[2]*o$k[3]},o$h.Clamp=function(o$o,o$r,o$T,o$k){var o$W=o$o.elements,o$D=o$W[0],o$n=o$W[1],o$V=o$W[2],o$L=o$r.elements,o$U=o$L[0],o$h=o$L[1],o$p=o$L[2],o$i=o$T.elements,o$v=o$i[0],o$x=o$i[1],o$j=o$i[2],o$_=o$k.elements;o$D=(o$D=o$v<o$D?o$v:o$D)<o$U?o$U:o$D,o$n=(o$n=o$x<o$n?o$x:o$n)<o$h?o$h:o$n,o$V=(o$V=o$j<o$V?o$j:o$V)<o$p?o$p:o$V,o$_[0]=o$D,o$_[1]=o$n,o$_[2]=o$V},o$h.add=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r.elements;o$k[0]=o$W[0]+o$D[0],o$k[1]=o$W[1]+o$D[1],o$k[2]=o$W[2]+o$D[2]},o$h.subtract=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r.elements;o$k[0]=o$W[0]-o$D[0],o$k[1]=o$W[1]-o$D[1],o$k[2]=o$W[2]-o$D[2]},o$h.cross=function(o$o,o$r,o$T){var o$k=o$o.elements,o$W=o$r.elements,o$D=o$T.elements,o$n=o$k[0],o$V=o$k[1],o$L=o$k[2],o$U=o$W[0],o$h=o$W[1],o$p=o$W[2];o$D[0]=o$V*o$p-o$L*o$h,o$D[1]=o$L*o$U-o$n*o$p,o$D[2]=o$n*o$h-o$V*o$U},o$h.dot=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements;return o$T[0]*o$k[0]+o$T[1]*o$k[1]+o$T[2]*o$k[2]},o$h.equals=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements;return o$Eo.nearEqual(Math.abs(o$T[0]),Math.abs(o$k[0]))&&o$Eo.nearEqual(Math.abs(o$T[1]),Math.abs(o$k[1]))&&o$Eo.nearEqual(Math.abs(o$T[2]),Math.abs(o$k[2]))},o$h.ZERO=new o$h(0,0,0),o$h.ONE=new o$h(1,1,1),o$h.NegativeUnitX=new o$h(-1,0,0),o$h.UnitX=new o$h(1,0,0),o$h.UnitY=new o$h(0,1,0),o$h.UnitZ=new o$h(0,0,1),o$h.ForwardRH=new o$h(0,0,-1),o$h.ForwardLH=new o$h(0,0,1),o$h.Up=new o$h(0,1,0),o$h.NAN=new o$h(NaN,NaN,NaN),o$p(o$h,["_tempVector4",function(){return this._tempVector4=new o$Vr}]),o$h}(),o$Vr=function(){function o$o(o$o,o$r,o$T,o$k){this.elements=new Float32Array(4),void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=0);var o$W=this.elements;o$W[0]=o$o,o$W[1]=o$r,o$W[2]=o$T,o$W[3]=o$k}o$v(o$o,"laya.d3.math.Vector4");var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r.fromArray=function(o$o,o$r){void 0===o$r&&(o$r=0),this.elements[0]=o$o[o$r+0],this.elements[1]=o$o[o$r+1],this.elements[2]=o$o[o$r+2],this.elements[3]=o$o[o$r+3]},o$r.cloneTo=function(o$o){var o$r=o$o.elements,o$T=this.elements;o$r[0]=o$T[0],o$r[1]=o$T[1],o$r[2]=o$T[2],o$r[3]=o$T[3]},o$r.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$r.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},o$r.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},o$x(0,o$r,"x",function(){return this.elements[0]},function(o$o){this.elements[0]=o$o}),o$x(0,o$r,"y",function(){return this.elements[1]},function(o$o){this.elements[1]=o$o}),o$x(0,o$r,"z",function(){return this.elements[2]},function(o$o){this.elements[2]=o$o}),o$x(0,o$r,"w",function(){return this.elements[3]},function(o$o){this.elements[3]=o$o}),o$o.lerp=function(o$o,o$r,o$T,o$k){var o$W=o$k.elements,o$D=o$o.elements,o$n=o$r.elements,o$V=o$D[0],o$L=o$D[1],o$U=o$D[2],o$h=o$D[3];o$W[0]=o$V+o$T*(o$n[0]-o$V),o$W[1]=o$L+o$T*(o$n[1]-o$L),o$W[2]=o$U+o$T*(o$n[2]-o$U),o$W[3]=o$h+o$T*(o$n[3]-o$h)},o$o.transformByM4x4=function(o$o,o$r,o$T){var o$k=o$o.elements,o$W=o$k[0],o$D=o$k[1],o$n=o$k[2],o$V=o$k[3],o$L=o$r.elements,o$U=o$T.elements;o$U[0]=o$W*o$L[0]+o$D*o$L[4]+o$n*o$L[8]+o$V*o$L[12],o$U[1]=o$W*o$L[1]+o$D*o$L[5]+o$n*o$L[9]+o$V*o$L[13],o$U[2]=o$W*o$L[2]+o$D*o$L[6]+o$n*o$L[10]+o$V*o$L[14],o$U[3]=o$W*o$L[3]+o$D*o$L[7]+o$n*o$L[11]+o$V*o$L[15]},o$o.equals=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements;return o$Eo.nearEqual(Math.abs(o$T[0]),Math.abs(o$k[0]))&&o$Eo.nearEqual(Math.abs(o$T[1]),Math.abs(o$k[1]))&&o$Eo.nearEqual(Math.abs(o$T[2]),Math.abs(o$k[2]))&&o$Eo.nearEqual(Math.abs(o$T[3]),Math.abs(o$k[3]))},o$o.normalize=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements,o$W=o$o.length();0<o$W&&(o$k[0]=o$T[0]*o$W,o$k[1]=o$T[1]*o$W,o$k[2]=o$T[2]*o$W,o$k[3]=o$T[3]*o$W)},o$o.add=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r.elements;o$k[0]=o$W[0]+o$D[0],o$k[1]=o$W[1]+o$D[1],o$k[2]=o$W[2]+o$D[2],o$k[3]=o$W[3]+o$D[3]},o$o.subtract=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r.elements;o$k[0]=o$W[0]-o$D[0],o$k[1]=o$W[1]-o$D[1],o$k[2]=o$W[2]-o$D[2],o$k[3]=o$W[3]-o$D[3]},o$o.multiply=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r.elements;o$k[0]=o$W[0]*o$D[0],o$k[1]=o$W[1]*o$D[1],o$k[2]=o$W[2]*o$D[2],o$k[3]=o$W[3]*o$D[3]},o$o.scale=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements;o$k[0]=o$W[0]*o$r,o$k[1]=o$W[1]*o$r,o$k[2]=o$W[2]*o$r,o$k[3]=o$W[3]*o$r},o$o.Clamp=function(o$o,o$r,o$T,o$k){var o$W=o$o.elements,o$D=o$W[0],o$n=o$W[1],o$V=o$W[2],o$L=o$W[3],o$U=o$r.elements,o$h=o$U[0],o$p=o$U[1],o$i=o$U[2],o$v=o$U[3],o$x=o$T.elements,o$j=o$x[0],o$_=o$x[1],o$K=o$x[2],o$$=o$x[3],o$y=o$k.elements;o$D=(o$D=o$j<o$D?o$j:o$D)<o$h?o$h:o$D,o$n=(o$n=o$_<o$n?o$_:o$n)<o$p?o$p:o$n,o$V=(o$V=o$K<o$V?o$K:o$V)<o$i?o$i:o$V,o$L=(o$L=o$$<o$L?o$$:o$L)<o$v?o$v:o$L,o$y[0]=o$D,o$y[1]=o$n,o$y[2]=o$V,o$y[3]=o$L},o$o.distanceSquared=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements,o$W=o$T[0]-o$k[0],o$D=o$T[1]-o$k[1],o$n=o$T[2]-o$k[2],o$V=o$T[3]-o$k[3];return o$W*o$W+o$D*o$D+o$n*o$n+o$V*o$V},o$o.distance=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements,o$W=o$T[0]-o$k[0],o$D=o$T[1]-o$k[1],o$n=o$T[2]-o$k[2],o$V=o$T[3]-o$k[3];return Math.sqrt(o$W*o$W+o$D*o$D+o$n*o$n+o$V*o$V)},o$o.dot=function(o$o,o$r){var o$T=o$o.elements,o$k=o$r.elements;return o$T[0]*o$k[0]+o$T[1]*o$k[1]+o$T[2]*o$k[2]+o$T[3]*o$k[3]},o$o.min=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r.elements;o$k[0]=Math.min(o$W[0],o$D[0]),o$k[1]=Math.min(o$W[1],o$D[1]),o$k[2]=Math.min(o$W[2],o$D[2]),o$k[3]=Math.min(o$W[3],o$D[3])},o$o.max=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r.elements;o$k[0]=Math.max(o$W[0],o$D[0]),o$k[1]=Math.max(o$W[1],o$D[1]),o$k[2]=Math.max(o$W[2],o$D[2]),o$k[3]=Math.max(o$W[3],o$D[3])},o$p(o$o,["ZERO",function(){return this.ZERO=new o$o},"ONE",function(){return this.ONE=new o$o(1,1,1,1)},"UnitX",function(){return this.UnitX=new o$o(1,0,0,0)},"UnitY",function(){return this.UnitY=new o$o(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new o$o(0,0,1,0)},"UnitW",function(){return this.UnitW=new o$o(0,0,0,1)}]),o$o}(),o$Lr=function(){function o$D(o$o,o$r,o$T,o$k){this.minDepth=0,this.maxDepth=1,this.x=o$o,this.y=o$r,this.width=o$T,this.height=o$k}o$v(o$D,"laya.d3.math.Viewport");var o$o=o$D.prototype;return o$o.project=function(o$o,o$r,o$T){o$nr.transformV3ToV3(o$o,o$r,o$T);var o$k=o$o.elements,o$W=o$r.elements,o$D=o$T.elements,o$n=o$k[0]*o$W[3]+o$k[1]*o$W[7]+o$k[2]*o$W[11]+o$W[15];1!==o$n&&(o$D[0]=o$D[0]/o$n,o$D[1]=o$D[1]/o$n,o$D[2]=o$D[2]/o$n),o$D[0]=.5*(o$D[0]+1)*this.width+this.x,o$D[1]=.5*(1-o$D[1])*this.height+this.y,o$D[2]=o$D[2]*(this.maxDepth-this.minDepth)+this.minDepth},o$o.unprojectFromMat=function(o$o,o$r,o$T){var o$k=o$o.elements,o$W=o$r.elements,o$D=o$T.elements;o$D[0]=(o$k[0]-this.x)/this.width*2-1,o$D[1]=-((o$k[1]-this.y)/this.height*2-1);var o$n=(this.maxDepth-this.minDepth)/2;o$D[2]=(o$k[2]-this.minDepth-o$n)/o$n;var o$V=o$D[0]*o$W[3]+o$D[1]*o$W[7]+o$D[2]*o$W[11]+o$W[15];o$nr.transformV3ToV3(o$T,o$r,o$T),1!==o$V&&(o$D[0]=o$D[0]/o$V,o$D[1]=o$D[1]/o$V,o$D[2]=o$D[2]/o$V)},o$o.unprojectFromWVP=function(o$o,o$r,o$T,o$k,o$W){o$or.multiply(o$r,o$T,o$D._tempMatrix4x4),o$k&&o$or.multiply(o$D._tempMatrix4x4,o$k,o$D._tempMatrix4x4),o$D._tempMatrix4x4.invert(o$D._tempMatrix4x4),this.unprojectFromMat(o$o,o$D._tempMatrix4x4,o$W)},o$p(o$D,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new o$or}]),o$D}(),o$Ur=function(){function o$R(o$o){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=o$o,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}o$v(o$R,"laya.d3.resource.models.SubMesh");var o$o=o$R.prototype;return o$S.imps(o$o,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),o$o._getVertexBuffer=function(o$o){return void 0===o$o&&(o$o=0),0===o$o?this._vertexBuffer:null},o$o._getIndexBuffer=function(){return this._indexBuffer},o$o._getStaticBatchBakedVertexs=function(o$o,o$r){var o$T,o$k,o$W=this._vertexBuffer,o$D=o$W.vertexDeclaration,o$n=o$D.getVertexElementByUsage(0).offset/4,o$V=o$D.getVertexElementByUsage(3).offset/4,o$L=o$r.meshRender.lightmapScaleOffset,o$U=0,o$h=0,o$p=0,o$i=0,o$v=0,o$x=0;if(o$L)if(o$k=o$D.getVertexElementByUsage(15))o$p=o$D.vertexStride/4,o$T=0<this._vertexCount?o$W.getData().slice(this._vertexStart*o$p,(this._vertexStart+this._vertexCount)*o$p):o$W.getData().slice(),o$i=o$k.offset/4;else{o$p=(o$x=o$D.vertexStride/4)+2,o$T=this._vertexCount?new Float32Array(this._vertexCount*(o$W.vertexDeclaration.vertexStride/4+2)):new Float32Array(o$W.vertexCount*(o$W.vertexDeclaration.vertexStride/4+2)),o$i=(o$v=o$D.getVertexElementByUsage(2).offset/4)+2;var o$j=o$W.getData();for(o$U=0,o$h=o$j.length/o$x;o$U<o$h;o$U++){var o$_=0;o$_=0<this._vertexCount?(this._vertexStart+o$U)*o$x:o$U*o$x;var o$K=o$U*o$p,o$$=0;for(o$$=0;o$$<o$i;o$$++)o$T[o$K+o$$]=o$j[o$_+o$$];for(o$$=o$i;o$$<o$x;o$$++)o$T[o$K+o$$+2]=o$j[o$_+o$$]}}else o$p=o$D.vertexStride/4,o$T=this._vertexCount?o$W.getData().slice(this._vertexStart*o$p,(this._vertexStart+this._vertexCount)*o$p):o$W.getData().slice();if(o$o){var o$y=o$o.worldMatrix,o$l=o$R._tempMatrix4x40;o$y.invert(o$l);var o$S=o$R._tempMatrix4x41,o$q=o$r.transform.worldMatrix;o$or.multiply(o$l,o$q,o$S)}else o$S=o$r.transform.worldMatrix;var o$b=o$R._tempQuaternion0;for(o$S.decomposeTransRotScale(o$R._tempVector30,o$b,o$R._tempVector31),o$U=0,o$h=o$T.length/o$p;o$U<o$h;o$U++){var o$F=o$U*o$p+o$n,o$P=o$U*o$p+o$V;if(o$_r.transformVector3ArrayToVector3ArrayCoordinate(o$T,o$F,o$S,o$T,o$F),o$_r.transformVector3ArrayByQuat(o$T,o$P,o$b,o$T,o$P),o$L){var o$t=o$U*o$p+o$i;if(o$k)o$_r.transformLightingMapTexcoordByUV1Array(o$T,o$t,o$L,o$T,o$t);else{var o$H=o$U*o$x+o$v;o$_r.transformLightingMapTexcoordByUV0Array(o$j,o$H,o$L,o$T,o$t)}}}return o$T},o$o._getVertexBuffers=function(){return null},o$o._beforeRender=function(o$o){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},o$o._render=function(o$o){var o$r,o$T=0,o$k=o$o.renderElement;if(1<this._indexCount){var o$W=this._boneIndicesList.length;if(1<o$W){for(var o$D=0;o$D<o$W;o$D++)(o$r=o$k._skinAnimationDatas||this._skinAnimationDatas)&&(o$k._shaderValue.setValue(0,o$r[o$D]),o$o._shader.uploadRenderElementUniforms(o$k._shaderValue.data)),o$u.mainContext.drawElements(4,this._subIndexBufferCount[o$D],5123,2*this._subIndexBufferStart[o$D]);o$F.drawCall+=o$W}else(o$r=o$k._skinAnimationDatas||this._skinAnimationDatas)&&(o$k._shaderValue.setValue(0,o$r[0]),o$o._shader.uploadRenderElementUniforms(o$k._shaderValue.data)),o$u.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),o$F.drawCall++;o$T=this._indexCount}else o$T=this._indexBuffer.indexCount,(o$r=o$k._skinAnimationDatas||this._skinAnimationDatas)&&(o$k._shaderValue.setValue(0,o$r[0]),o$o._shader.uploadRenderElementUniforms(o$k._shaderValue.data)),o$u.mainContext.drawElements(4,o$T,5123,0),o$F.drawCall++;o$F.trianglesFaces+=o$T/3},o$o.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},o$o.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},o$x(0,o$o,"_vertexBufferCount",function(){return 1}),o$x(0,o$o,"triangleCount",function(){return this._indexBuffer.indexCount/3}),o$p(o$R,["_tempVector30",function(){return this._tempVector30=new o$nr},"_tempVector31",function(){return this._tempVector31=new o$nr},"_tempQuaternion0",function(){return this._tempQuaternion0=new o$Tr},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new o$or},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new o$or}]),o$R}(),o$hr=function(){function o$o(o$o){this.defineCounter=0,this.defines=null,o$o?(this.defineCounter=o$o.defineCounter,this.defines=o$o.defines.slice()):(this.defineCounter=0,this.defines=[])}return o$v(o$o,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),o$o.prototype.registerDefine=function(o$o){var o$r=Math.pow(2,this.defineCounter++);return this.defines[o$r]=o$o,o$r},o$o}(),o$pr=function(){function o$o(){}return o$v(o$o,"laya.d3.shader.ShaderInit3D"),o$o.__init__=function(){var o$o,o$r;o$Fr._globalRegDefine("HIGHPRECISION",o$Fr.SHADERDEFINE_HIGHPRECISION),o$Fr._globalRegDefine("FOG",o$Fr.SHADERDEFINE_FOG),o$Fr._globalRegDefine("DIRECTIONLIGHT",o$Fr.SHADERDEFINE_DIRECTIONLIGHT),o$Fr._globalRegDefine("POINTLIGHT",o$Fr.SHADERDEFINE_POINTLIGHT),o$Fr._globalRegDefine("SPOTLIGHT",o$Fr.SHADERDEFINE_SPOTLIGHT),o$Fr._globalRegDefine("UV",o$Fr.SHADERDEFINE_UV0),o$Fr._globalRegDefine("COLOR",o$Fr.SHADERDEFINE_COLOR),o$Fr._globalRegDefine("UV1",o$Fr.SHADERDEFINE_UV1),o$Fr._globalRegDefine("CASTSHADOW",o$vr.SHADERDEFINE_CAST_SHADOW),o$Fr._globalRegDefine("SHADOWMAP_PSSM1",o$vr.SHADERDEFINE_SHADOW_PSSM1),o$Fr._globalRegDefine("SHADOWMAP_PSSM2",o$vr.SHADERDEFINE_SHADOW_PSSM2),o$Fr._globalRegDefine("SHADOWMAP_PSSM3",o$vr.SHADERDEFINE_SHADOW_PSSM3),o$Fr._globalRegDefine("SHADOWMAP_PCF_NO",o$vr.SHADERDEFINE_SHADOW_PCF_NO),o$Fr._globalRegDefine("SHADOWMAP_PCF1",o$vr.SHADERDEFINE_SHADOW_PCF1),o$Fr._globalRegDefine("SHADOWMAP_PCF2",o$vr.SHADERDEFINE_SHADOW_PCF2),o$Fr._globalRegDefine("SHADOWMAP_PCF3",o$vr.SHADERDEFINE_SHADOW_PCF3),o$Fr._globalRegDefine("DEPTHFOG",o$Fr.SAHDERDEFINE_DEPTHFOG),o$Or.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),o$Or.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),o$o={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},o$r={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var o$T=o$Or.nameKey.add("SIMPLE");shaderCompile=o$Fr.add(o$T,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',o$o,o$r),o$Mr.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),o$Mr.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),o$Mr.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),o$Mr.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),o$Mr.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),o$Mr.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),o$Mr.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),o$Mr.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),o$Mr.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},o$o}(),o$ir=function(){function o$o(){this._data=null,this._data=[]}o$v(o$o,"laya.d3.shader.ValusArray");var o$r=o$o.prototype;return o$r.setValue=function(o$o,o$r){this._data[o$o]=o$r},o$x(0,o$r,"data",function(){return this._data}),o$o}(),o$vr=function(){function o$o(){}return o$o.SHADERDEFINE_RECEIVE_SHADOW=1,o$o.SHADERDEFINE_CAST_SHADOW=512,o$o.SHADERDEFINE_SHADOW_PSSM1=1024,o$o.SHADERDEFINE_SHADOW_PSSM2=2048,o$o.SHADERDEFINE_SHADOW_PSSM3=4096,o$o.SHADERDEFINE_SHADOW_PCF_NO=8192,o$o.SHADERDEFINE_SHADOW_PCF1=16384,o$o.SHADERDEFINE_SHADOW_PCF2=32768,o$o.SHADERDEFINE_SHADOW_PCF3=65536,o$o.MAX_PSSM_COUNT=3,o$o}(),o$xr=function(){function o$w(){}return o$v(o$w,"laya.d3.utils.Picker"),o$w.calculateCursorRay=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=o$o.elements[0],o$V=o$o.elements[1],o$L=o$w._tempVector30,o$U=o$L.elements;o$U[0]=o$n,o$U[1]=o$V,o$U[2]=o$r.minDepth;var o$h=o$w._tempVector31,o$p=o$h.elements;o$p[0]=o$n,o$p[1]=o$V,o$p[2]=o$r.maxDepth;var o$i=o$D.origin,o$v=o$w._tempVector32;o$r.unprojectFromWVP(o$L,o$T,o$k,o$W,o$i),o$r.unprojectFromWVP(o$h,o$T,o$k,o$W,o$v);var o$x=o$D.direction.elements;o$x[0]=o$v.x-o$i.x,o$x[1]=o$v.y-o$i.y,o$x[2]=o$v.z-o$i.z,o$nr.normalize(o$D.direction,o$D.direction)},o$w.rayIntersectsPositionsAndIndices=function(o$o,o$r,o$T,o$k,o$W){for(var o$D=o$T.vertexStride/4,o$n=o$T.getVertexElementByUsage(0).offset/4,o$V=Number.MAX_VALUE,o$L=-1,o$U=-1,o$h=-1,o$p=0;o$p<o$k.length;o$p+=3){var o$i=o$w._tempVector35,o$v=o$i.elements,o$x=o$k[o$p]*o$D,o$j=o$x+o$n;o$v[0]=o$r[o$j],o$v[1]=o$r[1+o$j],o$v[2]=o$r[2+o$j];var o$_=o$w._tempVector36,o$K=o$_.elements,o$$=o$k[o$p+1]*o$D,o$y=o$$+o$n;o$K[0]=o$r[o$y],o$K[1]=o$r[1+o$y],o$K[2]=o$r[2+o$y];var o$l=o$w._tempVector37,o$S=o$l.elements,o$q=o$k[o$p+2]*o$D,o$b=o$q+o$n;o$S[0]=o$r[o$b],o$S[1]=o$r[1+o$b],o$S[2]=o$r[2+o$b];var o$F=laya.d3.utils.Picker.rayIntersectsTriangle(o$o,o$i,o$_,o$l);!isNaN(o$F)&&o$F<o$V&&(o$V=o$F,o$L=o$x,o$U=o$$,o$h=o$q)}if(o$V===Number.MAX_VALUE)return o$W.position.toDefault(),o$W.distance=Number.MAX_VALUE,o$W.trianglePositions[0].toDefault(),o$W.trianglePositions[1].toDefault(),o$W.trianglePositions[2].toDefault(),o$W.triangleNormals[0].toDefault(),o$W.triangleNormals[1].toDefault(),o$W.triangleNormals[2].toDefault(),!1;o$W.distance=o$V,o$nr.scale(o$o.direction,o$V,o$W.position),o$nr.add(o$o.origin,o$W.position,o$W.position);var o$P=o$W.trianglePositions,o$t=o$P[0],o$H=o$P[1],o$R=o$P[2],o$u=o$t.elements,o$s=o$H.elements,o$z=o$R.elements,o$m=o$L+o$n;o$u[0]=o$r[o$m],o$u[1]=o$r[o$m+1],o$u[2]=o$r[o$m+2];var o$C=o$U+o$n;o$s[0]=o$r[o$C],o$s[1]=o$r[o$C+1],o$s[2]=o$r[o$C+2];var o$X=o$h+o$n;o$z[0]=o$r[o$X],o$z[1]=o$r[o$X+1],o$z[2]=o$r[o$X+2];var o$O=o$T.getVertexElementByUsage(3);if(o$O){var o$M=o$O.offset/4,o$c=o$W.triangleNormals,o$e=o$c[0],o$J=o$c[1],o$Y=o$c[2],o$A=o$e.elements,o$I=o$J.elements,o$N=o$Y.elements,o$f=o$L+o$M;o$A[0]=o$r[o$f],o$A[1]=o$r[o$f+1],o$A[2]=o$r[o$f+2];var o$a=o$U+o$M;o$I[0]=o$r[o$a],o$I[1]=o$r[o$a+1],o$I[2]=o$r[o$a+2];var o$G=o$h+o$M;o$N[0]=o$r[o$G],o$N[1]=o$r[o$G+1],o$N[2]=o$r[o$G+2]}return!0},o$w.rayIntersectsTriangle=function(o$o,o$r,o$T,o$k){var o$W=o$w._tempVector30,o$D=o$w._tempVector31;o$nr.subtract(o$T,o$r,o$W),o$nr.subtract(o$k,o$r,o$D);var o$n,o$V=o$w._tempVector32;if(o$nr.cross(o$o.direction,o$D,o$V),(o$n=o$nr.dot(o$W,o$V))>-Number.MIN_VALUE&&o$n<Number.MIN_VALUE)return Number.NaN;var o$L,o$U=1/o$n,o$h=o$w._tempVector33;if(o$nr.subtract(o$o.origin,o$r,o$h),o$L=o$nr.dot(o$h,o$V),(o$L*=o$U)<0||1<o$L)return Number.NaN;var o$p,o$i,o$v=o$w._tempVector34;return o$nr.cross(o$h,o$W,o$v),o$p=o$nr.dot(o$o.direction,o$v),(o$p*=o$U)<0||1<o$L+o$p?Number.NaN:(o$i=o$nr.dot(o$D,o$v),(o$i*=o$U)<0?Number.NaN:o$i)},o$p(o$w,["_tempVector30",function(){return this._tempVector30=new o$nr},"_tempVector31",function(){return this._tempVector31=new o$nr},"_tempVector32",function(){return this._tempVector32=new o$nr},"_tempVector33",function(){return this._tempVector33=new o$nr},"_tempVector34",function(){return this._tempVector34=new o$nr},"_tempVector35",function(){return this._tempVector35=new o$nr},"_tempVector36",function(){return this._tempVector36=new o$nr},"_tempVector37",function(){return this._tempVector37=new o$nr}]),o$w}(),o$jr=(function(){function o$o(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new o$nr,new o$nr,new o$nr],this.trianglePositions.length=3,this.triangleNormals=[new o$nr,new o$nr,new o$nr],this.triangleNormals.length=3,this.position=new o$nr}o$v(o$o,"laya.d3.utils.RaycastHit"),o$o.prototype.cloneTo=function(o$o){o$o.distance=this.distance,this.trianglePositions[0].cloneTo(o$o.trianglePositions[0]),this.trianglePositions[1].cloneTo(o$o.trianglePositions[1]),this.trianglePositions[2].cloneTo(o$o.trianglePositions[2]),this.triangleNormals[0].cloneTo(o$o.triangleNormals[0]),this.triangleNormals[1].cloneTo(o$o.triangleNormals[1]),this.triangleNormals[2].cloneTo(o$o.triangleNormals[2]),this.position.cloneTo(o$o.position),o$o.sprite3D=this.sprite3D}}(),function(){function o$o(o$o,o$r){this._width=0,this._height=0,this._width=o$o,this._height=o$r}o$v(o$o,"laya.d3.utils.Size");var o$r=o$o.prototype;return o$x(0,o$r,"width",function(){return-1===this._width?o$Z.clientWidth:this._width}),o$x(0,o$r,"height",function(){return-1===this._height?o$Z.clientHeight:this._height}),o$x(1,o$o,"fullScreen",function(){return new o$o(-1,-1)}),o$o}()),o$_r=function(){function o$m(){}return o$v(o$m,"laya.d3.utils.Utils3D"),o$m._rotationTransformScaleSkinAnimation=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h,o$p){var o$i,o$v,o$x,o$j,o$_,o$K=o$m._tempArray16_0,o$$=o$m._tempArray16_1,o$y=o$m._tempArray16_2,o$l=o$k+o$k,o$S=o$W+o$W,o$q=o$D+o$D,o$b=o$k*o$l,o$F=o$W*o$l,o$P=o$W*o$S,o$t=o$D*o$l,o$H=o$D*o$S,o$R=o$D*o$q,o$u=o$n*o$l,o$s=o$n*o$S,o$z=o$n*o$q;for(o$K[15]=1,o$K[0]=1-o$P-o$R,o$K[1]=o$F+o$z,o$K[2]=o$t-o$s,o$K[4]=o$F-o$z,o$K[5]=1-o$b-o$R,o$K[6]=o$H+o$u,o$K[8]=o$t+o$s,o$K[9]=o$H-o$u,o$K[10]=1-o$b-o$P,o$$[15]=1,o$$[0]=o$V,o$$[5]=o$L,o$$[10]=o$U,o$i=0;o$i<4;o$i++)o$v=o$K[o$i],o$x=o$K[o$i+4],o$j=o$K[o$i+8],o$_=o$K[o$i+12],o$y[o$i]=o$v,o$y[o$i+4]=o$x,o$y[o$i+8]=o$j,o$y[o$i+12]=o$v*o$o+o$x*o$r+o$j*o$T+o$_;for(o$i=0;o$i<4;o$i++)o$v=o$y[o$i],o$x=o$y[o$i+4],o$j=o$y[o$i+8],o$_=o$y[o$i+12],o$h[o$i+o$p]=o$v*o$$[0]+o$x*o$$[1]+o$j*o$$[2]+o$_*o$$[3],o$h[o$i+o$p+4]=o$v*o$$[4]+o$x*o$$[5]+o$j*o$$[6]+o$_*o$$[7],o$h[o$i+o$p+8]=o$v*o$$[8]+o$x*o$$[9]+o$j*o$$[10]+o$_*o$$[11],o$h[o$i+o$p+12]=o$v*o$$[12]+o$x*o$$[13]+o$j*o$$[14]+o$_*o$$[15]},o$m._createNodeByJson=function(o$o,o$r,o$T,o$k){if(!o$T)switch(o$r.type){case"Sprite3D":o$T=new o$Xr;break;case"MeshSprite3D":o$T=new o$wr;break;case"SkinnedMeshSprite3D":o$T=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":o$T=new ShuriKenParticle3D;break;case"TrailSprite3D":o$T=new TrailSprite3D;break;case"Terrain":o$T=new Terrain;break;case"Camera":o$T=new o$Gr;break;case"DirectionLight":o$T=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var o$W=o$r.props;if(o$W)for(var o$D in o$W)o$T[o$D]=o$W[o$D];var o$n=o$r.customProps;o$n&&(o$T instanceof laya.d3.core.Sprite3D?(o$T._parseBaseCustomProps(o$n),o$T._parseCustomProps(o$o,o$k,o$n,o$r),o$T._parseCustomComponent(o$o,o$k,o$r.components)):o$T._parseCustomProps(o$o,o$k,o$n,o$r));var o$V=o$r.child;if(o$V)for(var o$L=0,o$U=o$V.length;o$L<o$U;o$L++){var o$h=o$m._createNodeByJson(o$o,o$V[o$L],null,o$k);o$T.addChild(o$h)}return o$T},o$m._computeBoneAndAnimationDatasByBindPoseMatrxix=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n,o$V,o$L=0,o$U=0,o$h=o$o.length;for(o$n=0;o$n<o$h;o$L+=o$o[o$n].keyframeWidth,o$U+=16,o$n++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(o$r[o$L+0],o$r[o$L+1],o$r[o$L+2],o$r[o$L+3],o$r[o$L+4],o$r[o$L+5],o$r[o$L+6],o$r[o$L+7],o$r[o$L+8],o$r[o$L+9],o$k,o$U),0!=o$n&&(o$V=16*o$o[o$n].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(o$k,o$V,o$k,o$U,o$k,o$U));var o$p=o$T.length;for(o$n=0;o$n<o$p;o$n++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(o$k,16*o$D[o$n],o$T[o$n],o$W,16*o$n)},o$m._computeAnimationDatasByArrayAndMatrixFast=function(o$o,o$r,o$T,o$k){for(var o$W=0,o$D=o$o.length;o$W<o$D;o$W++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(o$r,16*o$k[o$W],o$o[o$W],o$T,16*o$W)},o$m._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(o$o,o$r,o$T,o$k,o$W){var o$D,o$n,o$V=0,o$L=0,o$U=o$o.length;for(o$D=0;o$D<o$U;o$V+=o$o[o$D].keyframeWidth,o$L+=16,o$D++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(o$r[o$V+7],o$r[o$V+8],o$r[o$V+9],o$r[o$V+3],o$r[o$V+4],o$r[o$V+5],o$r[o$V+6],o$r[o$V+0],o$r[o$V+1],o$r[o$V+2],o$k,o$L),0!=o$D&&(o$n=16*o$o[o$D].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(o$k,o$n,o$k,o$L,o$k,o$L));var o$h=o$T.length;for(o$D=0;o$D<o$h;o$D++){var o$p=16*o$D;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(o$k,o$p,o$T[o$D],o$W,o$p)}},o$m._computeAnimationDatasByArrayAndMatrixFastOld=function(o$o,o$r,o$T){for(var o$k=o$o.length,o$W=0;o$W<o$k;o$W++){var o$D=16*o$W;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(o$r,o$D,o$o[o$W],o$T,o$D)}},o$m._computeRootAnimationData=function(o$o,o$r,o$T){for(var o$k=0,o$W=0,o$D=0,o$n=o$o.length;o$k<o$n;o$W+=o$o[o$k].keyframeWidth,o$D+=16,o$k++)laya.d3.utils.Utils3D.createAffineTransformationArray(o$r[o$W+0],o$r[o$W+1],o$r[o$W+2],o$r[o$W+3],o$r[o$W+4],o$r[o$W+5],o$r[o$W+6],o$r[o$W+7],o$r[o$W+8],o$r[o$W+9],o$T,o$D)},o$m.transformVector3ArrayByQuat=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$T.elements,o$n=o$o[o$r],o$V=o$o[o$r+1],o$L=o$o[o$r+2],o$U=o$D[0],o$h=o$D[1],o$p=o$D[2],o$i=o$D[3],o$v=o$i*o$n+o$h*o$L-o$p*o$V,o$x=o$i*o$V+o$p*o$n-o$U*o$L,o$j=o$i*o$L+o$U*o$V-o$h*o$n,o$_=-o$U*o$n-o$h*o$V-o$p*o$L;o$k[o$W]=o$v*o$i+o$_*-o$U+o$x*-o$p-o$j*-o$h,o$k[o$W+1]=o$x*o$i+o$_*-o$h+o$j*-o$U-o$v*-o$p,o$k[o$W+2]=o$j*o$i+o$_*-o$p+o$v*-o$h-o$x*-o$U},o$m.mulMatrixByArray=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n,o$V,o$L,o$U,o$h;if(o$W===o$T){for(o$T=o$m._tempArray16_3,o$n=0;o$n<16;++o$n)o$T[o$n]=o$W[o$D+o$n];o$k=0}for(o$n=0;o$n<4;o$n++)o$V=o$o[o$r+o$n],o$L=o$o[o$r+o$n+4],o$U=o$o[o$r+o$n+8],o$h=o$o[o$r+o$n+12],o$W[o$D+o$n]=o$V*o$T[o$k+0]+o$L*o$T[o$k+1]+o$U*o$T[o$k+2]+o$h*o$T[o$k+3],o$W[o$D+o$n+4]=o$V*o$T[o$k+4]+o$L*o$T[o$k+5]+o$U*o$T[o$k+6]+o$h*o$T[o$k+7],o$W[o$D+o$n+8]=o$V*o$T[o$k+8]+o$L*o$T[o$k+9]+o$U*o$T[o$k+10]+o$h*o$T[o$k+11],o$W[o$D+o$n+12]=o$V*o$T[o$k+12]+o$L*o$T[o$k+13]+o$U*o$T[o$k+14]+o$h*o$T[o$k+15]},o$m.mulMatrixByArrayFast=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n,o$V,o$L,o$U,o$h;for(o$n=0;o$n<4;o$n++)o$V=o$o[o$r+o$n],o$L=o$o[o$r+o$n+4],o$U=o$o[o$r+o$n+8],o$h=o$o[o$r+o$n+12],o$W[o$D+o$n]=o$V*o$T[o$k+0]+o$L*o$T[o$k+1]+o$U*o$T[o$k+2]+o$h*o$T[o$k+3],o$W[o$D+o$n+4]=o$V*o$T[o$k+4]+o$L*o$T[o$k+5]+o$U*o$T[o$k+6]+o$h*o$T[o$k+7],o$W[o$D+o$n+8]=o$V*o$T[o$k+8]+o$L*o$T[o$k+9]+o$U*o$T[o$k+10]+o$h*o$T[o$k+11],o$W[o$D+o$n+12]=o$V*o$T[o$k+12]+o$L*o$T[o$k+13]+o$U*o$T[o$k+14]+o$h*o$T[o$k+15]},o$m.mulMatrixByArrayAndMatrixFast=function(o$o,o$r,o$T,o$k,o$W){var o$D,o$n,o$V,o$L,o$U,o$h=o$T.elements,o$p=o$h[0],o$i=o$h[1],o$v=o$h[2],o$x=o$h[3],o$j=o$h[4],o$_=o$h[5],o$K=o$h[6],o$$=o$h[7],o$y=o$h[8],o$l=o$h[9],o$S=o$h[10],o$q=o$h[11],o$b=o$h[12],o$F=o$h[13],o$P=o$h[14],o$t=o$h[15],o$H=o$r,o$R=o$r+4,o$u=o$r+8,o$s=o$r+12,o$z=o$W,o$m=o$W+4,o$C=o$W+8,o$X=o$W+12;for(o$D=0;o$D<4;o$D++)o$n=o$o[o$H+o$D],o$V=o$o[o$R+o$D],o$L=o$o[o$u+o$D],o$U=o$o[o$s+o$D],o$k[o$z+o$D]=o$n*o$p+o$V*o$i+o$L*o$v+o$U*o$x,o$k[o$m+o$D]=o$n*o$j+o$V*o$_+o$L*o$K+o$U*o$$,o$k[o$C+o$D]=o$n*o$y+o$V*o$l+o$L*o$S+o$U*o$q,o$k[o$X+o$D]=o$n*o$b+o$V*o$F+o$L*o$P+o$U*o$t},o$m.createAffineTransformationArray=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h,o$p){var o$i=o$k+o$k,o$v=o$W+o$W,o$x=o$D+o$D,o$j=o$k*o$i,o$_=o$k*o$v,o$K=o$k*o$x,o$$=o$W*o$v,o$y=o$W*o$x,o$l=o$D*o$x,o$S=o$n*o$i,o$q=o$n*o$v,o$b=o$n*o$x;o$h[o$p+0]=(1-(o$$+o$l))*o$V,o$h[o$p+1]=(o$_+o$b)*o$V,o$h[o$p+2]=(o$K-o$q)*o$V,o$h[o$p+3]=0,o$h[o$p+4]=(o$_-o$b)*o$L,o$h[o$p+5]=(1-(o$j+o$l))*o$L,o$h[o$p+6]=(o$y+o$S)*o$L,o$h[o$p+7]=0,o$h[o$p+8]=(o$K+o$q)*o$U,o$h[o$p+9]=(o$y-o$S)*o$U,o$h[o$p+10]=(1-(o$j+o$$))*o$U,o$h[o$p+11]=0,o$h[o$p+12]=o$o,o$h[o$p+13]=o$r,o$h[o$p+14]=o$T,o$h[o$p+15]=1},o$m.transformVector3ArrayToVector3ArrayCoordinate=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$m._tempArray4_0,o$n=o$o[o$r+0],o$V=o$o[o$r+1],o$L=o$o[o$r+2],o$U=o$T.elements;o$D[0]=o$n*o$U[0]+o$V*o$U[4]+o$L*o$U[8]+o$U[12],o$D[1]=o$n*o$U[1]+o$V*o$U[5]+o$L*o$U[9]+o$U[13],o$D[2]=o$n*o$U[2]+o$V*o$U[6]+o$L*o$U[10]+o$U[14],o$D[3]=1/(o$n*o$U[3]+o$V*o$U[7]+o$L*o$U[11]+o$U[15]),o$k[o$W+0]=o$D[0]*o$D[3],o$k[o$W+1]=o$D[1]*o$D[3],o$k[o$W+2]=o$D[2]*o$D[3]},o$m.transformLightingMapTexcoordByUV0Array=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$T.elements;o$k[o$W+0]=o$o[o$r+0]*o$D[0]+o$D[2],o$k[o$W+1]=(o$o[o$r+1]-1)*o$D[1]+o$D[3]},o$m.transformLightingMapTexcoordByUV1Array=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$T.elements;o$k[o$W+0]=o$o[o$r+0]*o$D[0]+o$D[2],o$k[o$W+1]=1+o$o[o$r+1]*o$D[1]+o$D[3]},o$m.getURLVerion=function(o$o){var o$r=o$o.indexOf("?");return 0<=o$r?o$o.substr(o$r):null},o$m._quaternionCreateFromYawPitchRollArray=function(o$o,o$r,o$T,o$k){var o$W=.5*o$T,o$D=.5*o$r,o$n=.5*o$o,o$V=Math.sin(o$W),o$L=Math.cos(o$W),o$U=Math.sin(o$D),o$h=Math.cos(o$D),o$p=Math.sin(o$n),o$i=Math.cos(o$n);o$k[0]=o$i*o$U*o$L+o$p*o$h*o$V,o$k[1]=o$p*o$h*o$L-o$i*o$U*o$V,o$k[2]=o$i*o$h*o$V-o$p*o$U*o$L,o$k[3]=o$i*o$h*o$L+o$p*o$U*o$V},o$m._createAffineTransformationArray=function(o$o,o$r,o$T,o$k){var o$W=o$r[0],o$D=o$r[1],o$n=o$r[2],o$V=o$r[3],o$L=o$W+o$W,o$U=o$D+o$D,o$h=o$n+o$n,o$p=o$W*o$L,o$i=o$W*o$U,o$v=o$W*o$h,o$x=o$D*o$U,o$j=o$D*o$h,o$_=o$n*o$h,o$K=o$V*o$L,o$$=o$V*o$U,o$y=o$V*o$h,o$l=o$T[0],o$S=o$T[1],o$q=o$T[2];o$k[0]=(1-(o$x+o$_))*o$l,o$k[1]=(o$i+o$y)*o$l,o$k[2]=(o$v-o$$)*o$l,o$k[3]=0,o$k[4]=(o$i-o$y)*o$S,o$k[5]=(1-(o$p+o$_))*o$S,o$k[6]=(o$j+o$K)*o$S,o$k[7]=0,o$k[8]=(o$v+o$$)*o$q,o$k[9]=(o$j-o$K)*o$q,o$k[10]=(1-(o$p+o$x))*o$q,o$k[11]=0,o$k[12]=o$o[0],o$k[13]=o$o[1],o$k[14]=o$o[2],o$k[15]=1},o$m._mulMatrixArray=function(o$o,o$r,o$T,o$k){var o$W,o$D,o$n,o$V,o$L,o$U=o$r.elements,o$h=o$U[0],o$p=o$U[1],o$i=o$U[2],o$v=o$U[3],o$x=o$U[4],o$j=o$U[5],o$_=o$U[6],o$K=o$U[7],o$$=o$U[8],o$y=o$U[9],o$l=o$U[10],o$S=o$U[11],o$q=o$U[12],o$b=o$U[13],o$F=o$U[14],o$P=o$U[15],o$t=o$k,o$H=o$k+4,o$R=o$k+8,o$u=o$k+12;for(o$W=0;o$W<4;o$W++)o$D=o$o[o$W],o$n=o$o[o$W+4],o$V=o$o[o$W+8],o$L=o$o[o$W+12],o$T[o$t+o$W]=o$D*o$h+o$n*o$p+o$V*o$i+o$L*o$v,o$T[o$H+o$W]=o$D*o$x+o$n*o$j+o$V*o$_+o$L*o$K,o$T[o$R+o$W]=o$D*o$$+o$n*o$y+o$V*o$l+o$L*o$S,o$T[o$u+o$W]=o$D*o$q+o$n*o$b+o$V*o$F+o$L*o$P},o$m.getYawPitchRoll=function(o$o,o$r){o$m.transformQuat(o$nr.ForwardRH,o$o,o$Tr.TEMPVector31),o$m.transformQuat(o$nr.Up,o$o,o$Tr.TEMPVector32);var o$T=o$Tr.TEMPVector32.elements;o$m.angleTo(o$nr.ZERO,o$Tr.TEMPVector31,o$Tr.TEMPVector33);var o$k=o$Tr.TEMPVector33.elements;o$k[0]==Math.PI/2?(o$k[1]=o$m.arcTanAngle(o$T[2],o$T[0]),o$k[2]=0):o$k[0]==-Math.PI/2?(o$k[1]=o$m.arcTanAngle(-o$T[2],-o$T[0]),o$k[2]=0):(o$or.createRotationY(-o$k[1],o$Tr.TEMPMatrix0),o$or.createRotationX(-o$k[0],o$Tr.TEMPMatrix1),o$nr.transformCoordinate(o$Tr.TEMPVector32,o$Tr.TEMPMatrix0,o$Tr.TEMPVector32),o$nr.transformCoordinate(o$Tr.TEMPVector32,o$Tr.TEMPMatrix1,o$Tr.TEMPVector32),o$k[2]=o$m.arcTanAngle(o$T[1],-o$T[0])),o$k[1]<=-Math.PI&&(o$k[1]=Math.PI),o$k[2]<=-Math.PI&&(o$k[2]=Math.PI),o$k[1]>=Math.PI&&o$k[2]>=Math.PI&&(o$k[1]=0,o$k[2]=0,o$k[0]=Math.PI-o$k[0]),o$r[0]=o$k[1],o$r[1]=o$k[0],o$r[2]=o$k[2]},o$m.arcTanAngle=function(o$o,o$r){return 0==o$o?1==o$r?Math.PI/2:-Math.PI/2:0<o$o?Math.atan(o$r/o$o):o$o<0?0<o$r?Math.atan(o$r/o$o)+Math.PI:Math.atan(o$r/o$o)-Math.PI:0},o$m.angleTo=function(o$o,o$r,o$T){o$nr.subtract(o$r,o$o,o$Tr.TEMPVector30),o$nr.normalize(o$Tr.TEMPVector30,o$Tr.TEMPVector30),o$T.elements[0]=Math.asin(o$Tr.TEMPVector30.y),o$T.elements[1]=o$m.arcTanAngle(-o$Tr.TEMPVector30.z,-o$Tr.TEMPVector30.x)},o$m.transformQuat=function(o$o,o$r,o$T){var o$k=o$T.elements,o$W=o$o.elements,o$D=o$r,o$n=o$W[0],o$V=o$W[1],o$L=o$W[2],o$U=o$D[0],o$h=o$D[1],o$p=o$D[2],o$i=o$D[3],o$v=o$i*o$n+o$h*o$L-o$p*o$V,o$x=o$i*o$V+o$p*o$n-o$U*o$L,o$j=o$i*o$L+o$U*o$V-o$h*o$n,o$_=-o$U*o$n-o$h*o$V-o$p*o$L;o$k[0]=o$v*o$i+o$_*-o$U+o$x*-o$p-o$j*-o$h,o$k[1]=o$x*o$i+o$_*-o$h+o$j*-o$U-o$v*-o$p,o$k[2]=o$j*o$i+o$_*-o$p+o$v*-o$h-o$x*-o$U},o$m.quaterionNormalize=function(o$o,o$r){var o$T=o$o[0],o$k=o$o[1],o$W=o$o[2],o$D=o$o[3],o$n=o$T*o$T+o$k*o$k+o$W*o$W+o$D*o$D;0<o$n&&(o$n=1/Math.sqrt(o$n),o$r[0]=o$T*o$n,o$r[1]=o$k*o$n,o$r[2]=o$W*o$n,o$r[3]=o$D*o$n)},o$m.matrix4x4MultiplyFFF=function(o$o,o$r,o$T){var o$k,o$W,o$D,o$n,o$V;if(o$T===o$r)for(o$r=new Float32Array(16),o$k=0;o$k<16;++o$k)o$r[o$k]=o$T[o$k];for(o$k=0;o$k<4;o$k++)o$W=o$o[o$k],o$D=o$o[o$k+4],o$n=o$o[o$k+8],o$V=o$o[o$k+12],o$T[o$k]=o$W*o$r[0]+o$D*o$r[1]+o$n*o$r[2]+o$V*o$r[3],o$T[o$k+4]=o$W*o$r[4]+o$D*o$r[5]+o$n*o$r[6]+o$V*o$r[7],o$T[o$k+8]=o$W*o$r[8]+o$D*o$r[9]+o$n*o$r[10]+o$V*o$r[11],o$T[o$k+12]=o$W*o$r[12]+o$D*o$r[13]+o$n*o$r[14]+o$V*o$r[15]},o$m.matrix4x4MultiplyMFM=function(o$o,o$r,o$T){o$m.matrix4x4MultiplyFFF(o$o.elements,o$r,o$T.elements)},o$p(o$m,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new o$nr},"_tempVector3_1",function(){return this._tempVector3_1=new o$nr},"_tempVector3_2",function(){return this._tempVector3_2=new o$nr},"_tempVector3_3",function(){return this._tempVector3_3=new o$nr},"_tempVector3_4",function(){return this._tempVector3_4=new o$nr},"_tempVector3_5",function(){return this._tempVector3_5=new o$nr},"_tempVector3_6",function(){return this._tempVector3_6=new o$nr},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),o$m}(),o$Kr=function(){function o$s(){}return o$v(o$s,"Laya3D"),o$s._cancelLoadByUrl=function(o$o){o$S.loader.cancelLoadByUrl(o$o),o$s._innerFirstLevelLoaderManager.cancelLoadByUrl(o$o),o$s._innerSecondLevelLoaderManager.cancelLoadByUrl(o$o),o$s._innerThirdLevelLoaderManager.cancelLoadByUrl(o$o),o$s._innerFourthLevelLoaderManager.cancelLoadByUrl(o$o)},o$s._changeWebGLSize=function(o$o,o$r){o$u.onStageResize(o$o,o$r),o$Z.clientWidth=o$o,o$Z.clientHeight=o$r},o$s.__init__=function(){var o$o=o$r.createMap;o$o.lh=[o$Xr,"SPRITE3DHIERARCHY"],o$o.ls=[o$Cr,"SPRITE3DHIERARCHY"],o$o.lm=[o$Ar,"MESH"],o$o.lmat=[o$Mr,"MATERIAL"],o$o.jpg=[o$Nr,"nativeimage"],o$o.jpeg=[o$Nr,"nativeimage"],o$o.png=[o$Nr,"nativeimage"],o$o.pkm=[o$Nr,"arraybuffer"],o$o.raw=[o$Jr,"arraybuffer"],o$o.mipmaps=[o$Jr,"arraybuffer"],o$K.parserMap.SPRITE3DHIERARCHY=o$s._loadHierarchy,o$K.parserMap.MESH=o$s._loadMesh,o$K.parserMap.MATERIAL=o$s._loadMaterial,o$K.parserMap.TEXTURECUBE=o$s._loadTextureCube,o$K.parserMap.TERRAIN=o$s._loadTerrain,o$s._innerFirstLevelLoaderManager.on("error",null,o$s._eventLoadManagerError),o$s._innerSecondLevelLoaderManager.on("error",null,o$s._eventLoadManagerError),o$s._innerThirdLevelLoaderManager.on("error",null,o$s._eventLoadManagerError),o$s._innerFourthLevelLoaderManager.on("error",null,o$s._eventLoadManagerError)},o$s.READ_BLOCK=function(){return o$s._readData.pos+=4,!0},o$s.READ_DATA=function(){return o$s._DATA.offset=o$s._readData.getUint32(),o$s._DATA.size=o$s._readData.getUint32(),!0},o$s.READ_STRINGS=function(){var o$o=[],o$r={offset:0,size:0};o$r.offset=o$s._readData.getUint16(),o$r.size=o$s._readData.getUint16();o$s._readData.pos;o$s._readData.pos=o$r.offset+o$s._DATA.offset;for(var o$T=0;o$T<o$r.size;o$T++){var o$k=o$s._readData.readUTFString();-1===o$k.lastIndexOf(".lmat")&&-1===o$k.lastIndexOf(".lpbr")||o$o.push(o$k)}return o$o},o$s.formatRelativePath=function(o$o,o$r){var o$T;if("."===o$r.charAt(0)){for(var o$k=(o$o+o$r).split("/"),o$W=0,o$D=o$k.length;o$W<o$D;o$W++)if(".."==o$k[o$W]){var o$n=o$W-1;0<o$n&&".."!==o$k[o$n]&&(o$k.splice(o$n,2),o$W-=2)}o$T=o$k.join("/")}else o$T=o$o+o$r;return null!=o$R.customFormat&&(o$T=o$R.customFormat(o$T,null)),o$T},o$s._eventLoadManagerError=function(o$o){o$S.loader.event("error",o$o)},o$s._addHierarchyInnerUrls=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n=o$s.formatRelativePath(o$k,o$W);o$T&&(o$n+=o$T),o$o.push({url:o$n,clas:o$D}),o$r[o$W]=o$n},o$s._getSprite3DHierarchyInnerUrls=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){var o$V,o$L=0,o$U=0;switch(o$o.type){case"Scene":var o$h=o$o.customProps.lightmaps;for(o$L=0,o$U=o$h.length;o$L<o$U;o$L++){var o$p=o$h[o$L].replace(".exr",".png");o$s._addHierarchyInnerUrls(o$k,o$W,o$D,o$n,o$p,o$Nr)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var o$i;if(o$o.instanceParams)(o$i=o$o.instanceParams.loadPath)&&o$s._addHierarchyInnerUrls(o$r,o$W,o$D,o$n,o$i,o$Ar);else{(o$i=(o$V=o$o.customProps).meshPath)&&o$s._addHierarchyInnerUrls(o$r,o$W,o$D,o$n,o$i,o$Ar);var o$v=o$V.materials;if(o$v)for(o$L=0,o$U=o$v.length;o$L<o$U;o$L++){for(var o$x=o$v[o$L],o$j=o$x.type.split("."),o$_=o$z.window,o$K=0,o$$=o$j.length;o$K<o$$;++o$K){o$_=o$_[this.clasPaths[o$K]]}if("function"!=typeof o$_)throw"_getSprite3DHierarchyInnerUrls 错误: "+o$x.type+" 不是类";o$s._addHierarchyInnerUrls(o$T,o$W,o$D,o$n,o$x.path,o$_)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var o$y=(o$V=o$o.customProps).meshPath;o$y&&o$s._addHierarchyInnerUrls(o$r,o$W,o$D,o$n,o$y,o$Ar);var o$l=o$V.material;if(o$l){o$j=o$l.type.split("."),o$_=o$z.window;for(o$K=0,o$$=o$j.length;o$K<o$$;++o$K){o$_=o$_[this.clasPaths[o$K]]}o$s._addHierarchyInnerUrls(o$T,o$W,o$D,o$n,o$l.path,o$_)}else{var o$S=o$V.materialPath;if(o$S)o$s._addHierarchyInnerUrls(o$T,o$W,o$D,o$n,o$S,ShurikenParticleMaterial);else{var o$q=o$V.texturePath;o$q&&o$s._addHierarchyInnerUrls(o$k,o$W,o$D,o$n,o$q,o$Nr)}}break;case"Terrain":o$s._addHierarchyInnerUrls(o$k,o$W,o$D,o$n,o$o.customProps.dataPath,TerrainRes)}var o$b=o$o.components;for(var o$F in o$b){var o$P=o$b[o$F];switch(o$F){case"Animator":var o$t=o$P.avatarPath;if(o$t)o$s._addHierarchyInnerUrls(o$k,o$W,o$D,o$n,o$t,Avatar);else{var o$H=o$P.avatar;o$H&&o$s._addHierarchyInnerUrls(o$k,o$W,o$D,o$n,o$H.path,Avatar)}var o$R=o$P.clipPaths;for(o$L=0,o$U=o$R.length;o$L<o$U;o$L++)o$s._addHierarchyInnerUrls(o$k,o$W,o$D,o$n,o$R[o$L],AnimationClip)}}var o$u=o$o.child;for(o$L=0,o$U=o$u.length;o$L<o$U;o$L++)o$s._getSprite3DHierarchyInnerUrls(o$u[o$L],o$r,o$T,o$k,o$W,o$D,o$n)},o$s._loadHierarchy=function(o$o){o$o.on("loaded",null,o$s._onHierarchylhLoaded,[o$o,o$o._class._getGroup()]),o$o.load(o$o.url,"json",!1,null,!0)},o$s._onHierarchylhLoaded=function(o$o,o$r,o$T){if(o$o._class.destroyed)o$o.endLoad();else{var o$k=o$o.url,o$W=o$_r.getURLVerion(o$k),o$D=o$R.getPath(o$k),o$n=[],o$V=[],o$L=[],o$U={};o$s._getSprite3DHierarchyInnerUrls(o$T,o$n,o$V,o$L,o$U,o$W,o$D);var o$h=o$n.length+o$V.length+o$L.length,o$p=o$h+1,o$i=1/o$p;if(o$s._onProcessChange(o$o,0,o$i,1),0<o$L.length){var o$v=o$h/o$p,o$x=o$H.create(null,o$s._onProcessChange,[o$o,o$i,o$v],!1);o$s._innerFourthLevelLoaderManager.create(o$L,o$H.create(null,o$s._onHierarchyInnerForthLevResouLoaded,[o$o,o$r,o$x,o$T,o$U,o$n,o$V,o$i+o$v*o$L.length,o$v]),o$x,null,null,1,!0,o$r)}else o$s._onHierarchyInnerForthLevResouLoaded(o$o,o$r,null,o$T,o$U,o$n,o$V,o$i,o$v)}},o$s._onHierarchyInnerForthLevResouLoaded=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){if(o$o._class.destroyed)o$o.endLoad();else if(o$T&&o$T.recover(),0<o$n.length){var o$U=o$H.create(null,o$s._onProcessChange,[o$o,o$V,o$L],!1);o$s._innerSecondLevelLoaderManager.create(o$n,o$H.create(null,o$s._onHierarchyInnerSecondLevResouLoaded,[o$o,o$r,o$U,o$k,o$W,o$D,o$V+o$L*o$n.length,o$L]),o$T,null,null,1,!0,o$r)}else o$s._onHierarchyInnerSecondLevResouLoaded(o$o,o$r,null,o$k,o$W,o$D,o$V,o$L)},o$s._onHierarchyInnerSecondLevResouLoaded=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V){if(o$o._class.destroyed)o$o.endLoad();else if(o$T&&o$T.recover(),0<o$D.length){var o$L=o$H.create(null,o$s._onProcessChange,[o$o,o$n,o$V],!1);o$s._innerFirstLevelLoaderManager.create(o$D,o$H.create(null,o$s._onHierarchyInnerFirstLevResouLoaded,[o$o,o$L,o$k,o$W]),o$T,null,null,1,!0,o$r)}else o$s._onHierarchyInnerFirstLevResouLoaded(o$o,null,o$k,o$W)},o$s._onHierarchyInnerFirstLevResouLoaded=function(o$o,o$r,o$T,o$k){o$r&&o$r.recover(),o$o.endLoad([o$T,o$k])},o$s._loadTerrain=function(o$o){o$o.on("loaded",null,o$s._onTerrainLtLoaded,[o$o,o$o._class._getGroup()]),o$o.load(o$o.url,"json",!1,null,!0)},o$s._onTerrainLtLoaded=function(o$o,o$r,o$T){if(o$o._class.destroyed)o$o.endLoad();else{var o$k,o$W,o$D=o$o.url,o$n=o$_r.getURLVerion(o$D),o$V=o$R.getPath(o$D),o$L=[],o$U={},o$h=0,o$p=0,o$i=o$T.heightData;o$k=o$i.url,o$W=o$s.formatRelativePath(o$V,o$k),o$n&&(o$W+=o$n),o$k=o$U[o$k]=o$W;var o$v=o$T.detailTexture;for(o$h=0,o$p=o$v.length;o$h<o$p;o$h++)o$L.push({url:o$v[o$h].diffuse});var o$x=o$T.normalMap;for(o$h=0,o$p=o$x.length;o$h<o$p;o$h++)o$L.push({url:o$x[o$h]});var o$j=o$T.alphaMap;for(o$h=0,o$p=o$j.length;o$h<o$p;o$h++)o$L.push({url:o$j[o$h],params:[!1,!1,6408,!0]});for(o$h=0,o$p=o$L.length;o$h<o$p;o$h++){var o$_=o$L[o$h].url;o$W=o$s.formatRelativePath(o$V,o$_),o$n&&(o$W+=o$n),o$L[o$h].url=o$W,o$U[o$_]=o$W}var o$K=o$L.length,o$$=o$K+2,o$y=1/o$$;o$s._onProcessChange(o$o,0,o$y,1);var o$l={heightMapLoaded:!1,texturesLoaded:!1},o$S=o$H.create(null,o$s._onProcessChange,[o$o,o$y,o$y],!1);o$s._innerFourthLevelLoaderManager.create(o$k,o$H.create(null,o$s._onTerrainHeightMapLoaded,[o$o,o$S,o$T,o$U,o$l]),o$S,null,[o$i.numX,o$i.numZ,o$i.bitType,o$i.value],1,!0,o$r);var o$q=o$H.create(null,o$s._onProcessChange,[o$o,2*o$y,o$K/o$$],!1);o$s._innerFourthLevelLoaderManager.create(o$L,o$H.create(null,o$s._onTerrainTexturesLoaded,[o$o,o$q,o$T,o$U,o$l]),o$q,null,null,1,!0,o$r)}},o$s._onTerrainHeightMapLoaded=function(o$o,o$r,o$T,o$k,o$W){o$W.heightMapLoaded=!0,o$W.texturesLoaded&&(o$o.endLoad([o$T,o$k]),o$r.recover())},o$s._onTerrainTexturesLoaded=function(o$o,o$r,o$T,o$k,o$W){o$W.texturesLoaded=!0,o$W.heightMapLoaded&&(o$o.endLoad([o$T,o$k]),o$r.recover())},o$s._loadMesh=function(o$o){o$o.on("loaded",null,o$s._onMeshLmLoaded,[o$o,o$o._class._getGroup()]),o$o.load(o$o.url,"arraybuffer",!1,null,!0)},o$s._onMeshLmLoaded=function(o$o,o$r,o$T){if(o$o._class.destroyed)o$o.endLoad();else{var o$k,o$W,o$D,o$n=o$o.url,o$V=o$_r.getURLVerion(o$n),o$L=o$R.getPath(o$n),o$U={},o$h=0,o$p=0;switch((o$s._readData=new o$q(o$T)).pos=0,o$s._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var o$i=o$s._readData.getUint32();o$s._readData.pos=o$s._readData.pos+4,o$p=o$s._readData.getUint16(),o$s._readData.pos=o$s._readData.pos+8*o$p;var o$v=o$s._readData.getUint32();for(o$p=o$s._readData.getUint16(),o$s._readData.pos=o$i+o$v,o$k=[],o$h=0;o$h<o$p;o$h++){var o$x=o$s._readData.readUTFString();-1!==o$x.lastIndexOf(".lmat")&&o$k.push(o$x)}break;default:for(o$s.READ_BLOCK(),o$h=0;o$h<2;o$h++){var o$j=o$s._readData.getUint16(),o$_=o$s._strings[o$j],o$K=o$s["READ_"+o$_];if(null==o$K)throw new Error("model file err,no this function:"+o$j+" "+o$_);1===o$h?o$k=o$K.call():o$K.call()}}for(o$h=0,o$D=o$k.length;o$h<o$D;o$h++){var o$$=o$k[o$h];o$W=o$s.formatRelativePath(o$L,o$$),o$V&&(o$W+=o$V),o$k[o$h]=o$W,o$U[o$$]=o$W}if(0<o$k.length){o$s._onProcessChange(o$o,0,.5,1);var o$y=o$H.create(null,o$s._onProcessChange,[o$o,.5,.5],!1);o$s._innerSecondLevelLoaderManager.create(o$k,o$H.create(null,o$s._onMeshMateialLoaded,[o$o,o$y,o$T,o$U]),o$y,null,null,1,!0,o$r)}else o$o.endLoad([o$T,o$U])}},o$s._onMeshMateialLoaded=function(o$o,o$r,o$T,o$k){o$o.endLoad([o$T,o$k]),o$r.recover()},o$s._getMaterialTexturePath=function(o$o,o$r,o$T){var o$k=o$o.length-4;return o$o.indexOf(".dds")!=o$k&&o$o.indexOf(".tga")!=o$k&&o$o.indexOf(".exr")!=o$k&&o$o.indexOf(".DDS")!=o$k&&o$o.indexOf(".TGA")!=o$k&&o$o.indexOf(".EXR")!=o$k||(o$o=o$o.substr(0,o$k)+".png"),o$o=o$s.formatRelativePath(o$T,o$o),o$r&&(o$o+=o$r),o$o},o$s._loadMaterial=function(o$o){o$o.on("loaded",null,o$s._onMaterilLmatLoaded,[o$o,o$o._class._getGroup()]),o$o.load(o$o.url,"json",!1,null,!0)},o$s._onMaterilLmatLoaded=function(o$o,o$r,o$T){if(o$o._class.destroyed)o$o.endLoad();else{var o$k,o$W=o$o.url,o$D=o$_r.getURLVerion(o$W),o$n=o$R.getPath(o$W),o$V=[],o$L={},o$U=o$T.customProps,o$h=o$T.version;if(o$h)switch(o$h){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var o$p=o$T.props.textures,o$i=0,o$v=o$p.length;o$i<o$v;o$i++){var o$x=o$p[o$i],o$j=o$x.path;if(o$j){var o$_=o$j.length-4;o$j.indexOf(".exr")!=o$_&&o$j.indexOf(".EXR")!=o$_||(o$j=o$j.substr(0,o$_)+".png"),o$k=o$s.formatRelativePath(o$n,o$j),o$D&&(o$k+=o$D),o$V.push({url:o$k,params:o$x.params}),o$L[o$j]=o$k}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var o$K=o$U.diffuseTexture.texture2D;if(o$K&&(o$k=o$s._getMaterialTexturePath(o$K,o$D,o$n),o$V.push(o$k),o$L[o$K]=o$k),o$U.normalTexture){var o$$=o$U.normalTexture.texture2D;o$$&&(o$k=o$s._getMaterialTexturePath(o$$,o$D,o$n),o$V.push(o$k),o$L[o$$]=o$k)}if(o$U.specularTexture){var o$y=o$U.specularTexture.texture2D;o$y&&(o$k=o$s._getMaterialTexturePath(o$y,o$D,o$n),o$V.push(o$k),o$L[o$y]=o$k)}if(o$U.emissiveTexture){var o$l=o$U.emissiveTexture.texture2D;o$l&&(o$k=o$s._getMaterialTexturePath(o$l,o$D,o$n),o$V.push(o$k),o$L[o$l]=o$k)}if(o$U.ambientTexture){var o$S=o$U.ambientTexture.texture2D;o$S&&(o$k=o$s._getMaterialTexturePath(o$S,o$D,o$n),o$V.push(o$k),o$L[o$S]=o$k)}if(o$U.reflectTexture){var o$q=o$U.reflectTexture.texture2D;o$q&&(o$k=o$s._getMaterialTexturePath(o$q,o$D,o$n),o$V.push(o$k),o$L[o$q]=o$k)}}var o$b=o$V.length,o$F=o$b+1,o$P=1/o$F;if(o$s._onProcessChange(o$o,0,o$P,1),0<o$b){var o$t=o$H.create(null,o$s._onProcessChange,[o$o,o$P,o$b/o$F],!1);o$s._innerFourthLevelLoaderManager.create(o$V,o$H.create(null,o$s._onMateialTexturesLoaded,[o$o,o$t,o$T,o$L]),o$t,o$Nr,null,1,!0,o$r)}else o$s._onMateialTexturesLoaded(o$o,null,o$T,null)}},o$s._onMateialTexturesLoaded=function(o$o,o$r,o$T,o$k){o$o.endLoad([o$T,o$k]),o$r&&o$r.recover()},o$s._loadTextureCube=function(o$o){o$o.on("loaded",null,o$s._onTextureCubeLtcLoaded,[o$o]),o$o.load(o$o.url,"json",!1,null,!0)},o$s._onTextureCubeLtcLoaded=function(o$o,o$r){if(o$o._class.destroyed)o$o.endLoad();else{var o$T=o$R.getPath(o$o.url),o$k=[o$s.formatRelativePath(o$T,o$r.px),o$s.formatRelativePath(o$T,o$r.nx),o$s.formatRelativePath(o$T,o$r.py),o$s.formatRelativePath(o$T,o$r.ny),o$s.formatRelativePath(o$T,o$r.pz),o$s.formatRelativePath(o$T,o$r.nz)];o$s._onProcessChange(o$o,0,1/7,1);var o$W=o$H.create(null,o$s._onProcessChange,[o$o,1/7,6/7],!1);o$s._innerFourthLevelLoaderManager.load(o$k,o$H.create(null,o$s._onTextureCubeImagesLoaded,[o$o,o$k,o$W]),o$W,"nativeimage")}},o$s._onTextureCubeImagesLoaded=function(o$o,o$r,o$T){var o$k=[];o$k.length=6;for(var o$W=0;o$W<6;o$W++){var o$D=o$r[o$W];o$k[o$W]=o$K.getRes(o$D),o$K.clearRes(o$D)}o$o.endLoad(o$k),o$T.recover()},o$s._onProcessChange=function(o$o,o$r,o$T,o$k){(o$k=o$r+o$k*o$T)<1&&o$o.event("progress",o$k)},o$s.init=function(o$o,o$r,o$T,o$k,o$W,o$D){if(void 0===o$T&&(o$T=!1),void 0===o$k&&(o$k=!1),void 0===o$W&&(o$W=!0),void 0===o$D&&(o$D=!0),o$$.update3DLoop=function(){},o$$.cancelLoadByUrl=function(o$o){o$s._cancelLoadByUrl(o$o)},o$L.isAntialias=o$T,o$L.isAlpha=o$k,o$L.premultipliedAlpha=o$W,o$L.isStencil=o$D,!o$u.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");o$$.changeWebGLSize=o$s._changeWebGLSize,o$j.is3DMode=!0,o$S.init(o$o,o$r),o$m.__init__(),o$pr.__init__(),o$wr.__init__(),o$Y.__init__(),o$s.__init__(),o$n.maxTextureCount=2,(o$s.debugMode||o$Q.debugMode)&&(o$s._debugPhasorSprite=new o$a)},o$s.HIERARCHY="SPRITE3DHIERARCHY",o$s.MESH="MESH",o$s.MATERIAL="MATERIAL",o$s.PBRMATERIAL="PBRMTL",o$s.TEXTURECUBE="TEXTURECUBE",o$s.TERRAIN="TERRAIN",o$s._readData=null,o$s._debugPhasorSprite=null,o$s.debugMode=!1,o$p(o$s,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new o$r},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new o$r},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new o$r},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new o$r}]),o$s}(),o$$r=function(o$o){function o$W(o$o){o$W.__super.call(this),this._owner=o$o,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}o$v(o$W,"laya.d3.animation.AnimationTransform3D",o$D);var o$r=o$W.prototype;return o$r._getlocalMatrix=function(){return this._localUpdate&&(o$_r._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},o$r._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var o$o=0,o$r=this._childs.length;o$o<o$r;o$o++)this._childs[o$o]._onWorldTransform()}},o$r._setWorldMatrixAndUpdate=function(o$o){if(this._worldMatrix=o$o,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var o$r=this._getlocalMatrix(),o$T=0;o$T<16;++o$T)this._worldMatrix[o$T]=o$r[o$T];else o$_r.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},o$r._setWorldMatrixNoUpdate=function(o$o){this._worldMatrix=o$o},o$r._setWorldMatrixIgnoreUpdate=function(o$o){this._worldMatrix=o$o,this._worldUpdate=!1},o$r.getLocalPosition=function(){return this._localPosition},o$r.setLocalPosition=function(o$o){if(this._parent)this._localPosition=o$o,this._localUpdate=!0,this._onWorldTransform();else{var o$r=this._entity.owner._transform,o$T=this._entity.localPosition,o$k=o$T.elements;o$k[0]=o$o[0],o$k[1]=o$o[1],o$k[2]=o$o[2],o$r.localPosition=o$T}},o$r.getLocalRotation=function(){if(this._localQuaternionUpdate){var o$o=this._localRotationEuler;o$_r._quaternionCreateFromYawPitchRollArray(o$o[1]/o$W._angleToRandin,o$o[0]/o$W._angleToRandin,o$o[2]/o$W._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},o$r.setLocalRotation=function(o$o){if(this._parent)this._localRotation=o$o,o$_r.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var o$r=this._entity.owner._transform,o$T=this._entity.localRotation,o$k=o$T.elements;o$k[0]=o$o[0],o$k[1]=o$o[1],o$k[2]=o$o[2],o$k[3]=o$o[3],o$r.localRotation=o$T}},o$r.getLocalScale=function(){return this._localScale},o$r.setLocalScale=function(o$o){if(this._parent)this._localScale=o$o,this._localUpdate=!0,this._onWorldTransform();else{var o$r=this._entity.owner._transform,o$T=this._entity.localScale,o$k=o$T.elements;o$k[0]=o$o[0],o$k[1]=o$o[1],o$k[2]=o$o[2],o$r.localScale=o$T}},o$r.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){o$_r.getYawPitchRoll(this._localRotation,o$W._tempVector3);var o$o=o$W._tempVector3,o$r=this._localRotationEuler;o$r[0]=o$o[1]*o$W._angleToRandin,o$r[1]=o$o[0]*o$W._angleToRandin,o$r[2]=o$o[2]*o$W._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},o$r.setLocalRotationEuler=function(o$o){if(this._parent)o$_r._quaternionCreateFromYawPitchRollArray(o$o[1]/o$W._angleToRandin,o$o[0]/o$W._angleToRandin,o$o[2]/o$W._angleToRandin,this._localRotation),this._localRotationEuler=o$o,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var o$r=this._entity.owner._transform,o$T=this._entity.localRotationEuler,o$k=o$T.elements;o$k[0]=o$o[0],o$k[1]=o$o[1],o$k[2]=o$o[2],o$r.localRotationEuler=o$T}},o$r.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)o$_r.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var o$o=this._getlocalMatrix(),o$r=0;o$r<16;++o$r)this._worldMatrix[o$r]=o$o[o$r];this._worldUpdate=!1}return this._worldMatrix},o$r.setParent=function(o$o){if(this._parent!==o$o){if(this._parent){var o$r=this._parent._childs,o$T=o$r.indexOf(this);o$r.splice(o$T,1)}o$o&&(o$o._childs.push(this),o$o&&this._onWorldTransform()),this._parent=o$o}},o$p(o$W,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),o$W}(),o$yr=function(o$o){function o$r(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,o$r.__super.call(this),this._destroyed=!1,this._id=o$r._uniqueIDCounter,o$r._uniqueIDCounter++}o$v(o$r,"laya.d3.component.Component3D",o$D);var o$T=o$r.prototype;return o$S.imps(o$T,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),o$T._initialize=function(o$o){this._owner=o$o,this._enable=!0,this.started=!1,this._load(o$o)},o$T._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},o$T._load=function(o$o){},o$T._start=function(o$o){},o$T._update=function(o$o){},o$T._lateUpdate=function(o$o){},o$T._preRenderUpdate=function(o$o){},o$T._postRenderUpdate=function(o$o){},o$T._unload=function(o$o){this.offAll()},o$T._cloneTo=function(o$o){},o$x(0,o$T,"id",function(){return this._id}),o$x(0,o$T,"destroyed",function(){return this._destroyed}),o$x(0,o$T,"owner",function(){return this._owner}),o$x(0,o$T,"enable",function(){return this._enable},function(o$o){this._enable!==o$o&&(this._enable=o$o,this.event("enablechanged",this._enable))}),o$x(0,o$T,"isSingleton",function(){return o$r._isSingleton}),o$r._isSingleton=!0,o$r._uniqueIDCounter=1,o$r}(),o$lr=function(o$o){function o$r(){this._destroyed=!1,o$r.__super.call(this),this._destroyed=!1}o$v(o$r,"laya.d3.core.GeometryFilter",o$D);var o$T=o$r.prototype;return o$S.imps(o$T,{"laya.resource.IDestroy":!0}),o$T._destroy=function(){this.offAll(),this._destroyed=!0},o$x(0,o$T,"_isAsyncLoaded",function(){return!0}),o$x(0,o$T,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),o$x(0,o$T,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),o$x(0,o$T,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),o$x(0,o$T,"destroyed",function(){return this._destroyed}),o$r}(),o$Sr=function(o$o){function o$k(o$o){o$k.__super.call(this),this._id=++o$k._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new o$Qo(new o$nr,new o$nr),this._boundingBoxCenter=new o$nr,this._boundingSphere=new o$Bo(new o$nr,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=o$o,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}o$v(o$k,"laya.d3.core.render.BaseRender",o$D);var o$r=o$k.prototype;return o$S.imps(o$r,{"laya.resource.IDestroy":!0}),o$r._changeMaterialReference=function(o$o,o$r){o$o&&o$o._removeReference(),o$r._addReference()},o$r._getInstanceMaterial=function(o$o,o$r){var o$T=new o$o.constructor;return o$o.cloneTo(o$T),o$T.name=o$T.name+"(Instance)",this._materialsInstance[o$r]=!0,this._changeMaterialReference(this._materials[o$r],o$T),this._materials[o$r]=o$T},o$r._setShaderValuelightMap=function(o$o){this._setShaderValueTexture(3,o$o)},o$r._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},o$r._renderRenderableBoundBox=function(){var o$o=o$Kr._debugPhasorSprite,o$r=this.boundingBox,o$T=o$k._tempBoundBoxCorners;o$r.getCorners(o$T),o$o.line(o$T[0],o$k._greenColor,o$T[1],o$k._greenColor),o$o.line(o$T[2],o$k._greenColor,o$T[3],o$k._greenColor),o$o.line(o$T[4],o$k._greenColor,o$T[5],o$k._greenColor),o$o.line(o$T[6],o$k._greenColor,o$T[7],o$k._greenColor),o$o.line(o$T[0],o$k._greenColor,o$T[3],o$k._greenColor),o$o.line(o$T[1],o$k._greenColor,o$T[2],o$k._greenColor),o$o.line(o$T[2],o$k._greenColor,o$T[6],o$k._greenColor),o$o.line(o$T[3],o$k._greenColor,o$T[7],o$k._greenColor),o$o.line(o$T[0],o$k._greenColor,o$T[4],o$k._greenColor),o$o.line(o$T[1],o$k._greenColor,o$T[5],o$k._greenColor),o$o.line(o$T[4],o$k._greenColor,o$T[7],o$k._greenColor),o$o.line(o$T[5],o$k._greenColor,o$T[6],o$k._greenColor)},o$r._calculateBoundingSphere=function(){throw"BaseRender: must override it."},o$r._calculateBoundingBox=function(){throw"BaseRender: must override it."},o$r._setShaderValueTexture=function(o$o,o$r){this._owner._shaderValues.setValue(o$o,o$r)},o$r._setShaderValueMatrix4x4=function(o$o,o$r){this._owner._shaderValues.setValue(o$o,o$r?o$r.elements:null)},o$r._setShaderValueColor=function(o$o,o$r){this._owner._shaderValues.setValue(o$o,o$r?o$r.elements:null)},o$r._setShaderValueBuffer=function(o$o,o$r){this._owner._shaderValues.setValue(o$o,o$r)},o$r._setShaderValueInt=function(o$o,o$r){this._owner._shaderValues.setValue(o$o,o$r)},o$r._setShaderValueBool=function(o$o,o$r){this._owner._shaderValues.setValue(o$o,o$r)},o$r._setShaderValueNumber=function(o$o,o$r){this._owner._shaderValues.setValue(o$o,o$r)},o$r._setShaderValueVector2=function(o$o,o$r){this._owner._shaderValues.setValue(o$o,o$r?o$r.elements:null)},o$r._addShaderDefine=function(o$o){this._owner._shaderDefineValue|=o$o},o$r._removeShaderDefine=function(o$o){this._owner._shaderDefineValue&=~o$o},o$r._renderUpdate=function(o$o){return!0},o$r._applyLightMapParams=function(){if(0<=this._lightmapIndex){var o$o=this._owner.scene;if(o$o){var o$r=o$o.getlightmaps()[this._lightmapIndex];o$r?(this._addShaderDefine(o$ar.SAHDERDEFINE_LIGHTMAP),o$r.loaded?this._setShaderValuelightMap(o$r):o$r.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(o$ar.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(o$ar.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(o$ar.SAHDERDEFINE_LIGHTMAP)},o$r._updateOctreeNode=function(){var o$o=this._treeNode;o$o&&this._octreeNodeNeedChange&&(o$o.updateObject(this),this._octreeNodeNeedChange=!1)},o$r._destroy=function(){this.offAll();var o$o=0,o$r=0;for(o$o=0,o$r=this._renderElements.length;o$o<o$r;o$o++)this._renderElements[o$o]._destroy();for(o$o=0,o$r=this._materials.length;o$o<o$r;o$o++)this._materials[o$o]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},o$x(0,o$r,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),o$x(0,o$r,"id",function(){return this._id}),o$x(0,o$r,"material",function(){var o$o=this._materials[0];if(o$o&&!this._materialsInstance[0]){var o$r=this._getInstanceMaterial(o$o,0);this.event("materialchanged",[this,0,o$r])}return this._materials[0]},function(o$o){this.sharedMaterial=o$o}),o$x(0,o$r,"sharedMaterial",function(){return this._materials[0]},function(o$o){var o$r=this._materials[0];o$r!==o$o&&(this._materials[0]=o$o,this._materialsInstance[0]=!1,this._changeMaterialReference(o$r,o$o),this.event("materialchanged",[this,0,o$o]))}),o$x(0,o$r,"lightmapIndex",function(){return this._lightmapIndex},function(o$o){this._lightmapIndex=o$o,this._applyLightMapParams()}),o$x(0,o$r,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(o$o){this._lightmapScaleOffset=o$o,this._setShaderValueColor(2,o$o),this._addShaderDefine(o$ar.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),o$x(0,o$r,"enable",function(){return this._enable},function(o$o){this._enable=o$o,this.event("enablechanged",[this,o$o])}),o$x(0,o$r,"materials",function(){for(var o$o=0,o$r=this._materials.length;o$o<o$r;o$o++)if(!this._materialsInstance[o$o]){var o$T=this._getInstanceMaterial(this._materials[o$o],o$o);this.event("materialchanged",[this,o$o,o$T])}return this._materials.slice()},function(o$o){this.sharedMaterials=o$o}),o$x(0,o$r,"sharedMaterials",function(){return this._materials.slice()},function(o$o){if(!o$o)throw new Error("MeshRender: shadredMaterials value can't be null.");var o$r=o$o.length;this._materialsInstance.length=o$r;for(var o$T=0;o$T<o$r;o$T++){var o$k=this._materials[o$T];o$k!==o$o[o$T]&&(this._materialsInstance[o$T]=!1,this._changeMaterialReference(o$k,o$o[o$T]),this.event("materialchanged",[this,o$T,o$o[o$T]]))}this._materials=o$o}),o$x(0,o$r,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),o$x(0,o$r,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var o$o=this.boundingBox;o$nr.add(o$o.min,o$o.max,this._boundingBoxCenter),o$nr.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),o$x(0,o$r,"receiveShadow",function(){return this._receiveShadow},function(o$o){this._receiveShadow!==o$o&&((this._receiveShadow=o$o)?this._addShaderDefine(o$vr.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(o$vr.SHADERDEFINE_RECEIVE_SHADOW))}),o$x(0,o$r,"destroyed",function(){return this._destroyed}),o$k._uniqueIDCounter=0,o$p(o$k,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new o$nr,new o$nr,new o$nr,new o$nr,new o$nr,new o$nr,new o$nr,new o$nr]},"_greenColor",function(){return this._greenColor=new o$Vr(0,1,0,1)}]),o$k}(),o$qr=function(o$o){function o$V(o$o){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,o$V.__super.call(this),this._localPosition=new o$nr,this._localRotation=new o$Tr(0,0,0,1),this._localScale=new o$nr(1,1,1),this._localRotationEuler=new o$nr,this._localMatrix=new o$or,this._position=new o$nr,this._rotation=new o$Tr(0,0,0,1),this._scale=new o$nr(1,1,1),this._worldMatrix=new o$or,this._forward=new o$nr,this._up=new o$nr,this._right=new o$nr,this._owner=o$o,this._childs=[]}o$v(o$V,"laya.d3.core.Transform3D",o$D);var o$r=o$V.prototype;return o$r._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)o$or.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var o$o=o$V._tempVector30;o$nr.multiply(this.pivot,this._localScale,o$o);var o$r=o$V._tempVector31;o$nr.subtract(o$o,this.pivot,o$r);var o$T=o$V._tempVector32,o$k=this.localRotation;o$nr.transformQuat(o$o,o$k,o$T),o$nr.subtract(o$T,o$o,o$T);var o$W=o$V._tempVector33;o$nr.subtract(this._localPosition,o$r,o$W),o$nr.subtract(o$W,o$T,o$W),o$or.createAffineTransformation(o$W,o$k,this._localScale,this._localMatrix)}},o$r._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var o$o=0,o$r=this._childs.length;o$o<o$r;o$o++)this._childs[o$o]._onWorldPositionRotationTransform()}},o$r._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var o$o=0,o$r=this._childs.length;o$o<o$r;o$o++)this._childs[o$o]._onWorldPositionScaleTransform()}},o$r._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var o$o=0,o$r=this._childs.length;o$o<o$r;o$o++)this._childs[o$o]._onWorldPositionTransform()}},o$r._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var o$o=0,o$r=this._childs.length;o$o<o$r;o$o++)this._childs[o$o]._onWorldPositionRotationTransform()}},o$r._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var o$o=0,o$r=this._childs.length;o$o<o$r;o$o++)this._childs[o$o]._onWorldPositionScaleTransform()}},o$r._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var o$o=0,o$r=this._childs.length;o$o<o$r;o$o++)this._childs[o$o]._onWorldTransform()}},o$r.translate=function(o$o,o$r){void 0===o$r&&(o$r=!0),o$r?(o$or.createFromQuaternion(this.localRotation,o$V._tempMatrix0),o$nr.transformCoordinate(o$o,o$V._tempMatrix0,o$V._tempVector30),o$nr.add(this.localPosition,o$V._tempVector30,this._localPosition),this.localPosition=this._localPosition):(o$nr.add(this.position,o$o,this._position),this.position=this._position)},o$r.rotate=function(o$o,o$r,o$T){var o$k;void 0===o$r&&(o$r=!0),void 0===o$T&&(o$T=!0),o$k=o$T?o$o:(o$nr.scale(o$o,Math.PI/180,o$V._tempVector30),o$V._tempVector30),o$Tr.createFromYawPitchRoll(o$k.y,o$k.x,o$k.z,o$V._tempQuaternion0),o$r?(o$Tr.multiply(this._localRotation,o$V._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(o$Tr.multiply(o$V._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},o$r.lookAt=function(o$o,o$r,o$T){void 0===o$T&&(o$T=!1);var o$k,o$W=o$o.elements;if(o$T){if(o$k=this._localPosition.elements,Math.abs(o$k[0]-o$W[0])<o$Eo.zeroTolerance&&Math.abs(o$k[1]-o$W[1])<o$Eo.zeroTolerance&&Math.abs(o$k[2]-o$W[2])<o$Eo.zeroTolerance)return;o$Tr.lookAt(this._localPosition,o$o,o$r,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var o$D=this.position;if(o$k=o$D.elements,Math.abs(o$k[0]-o$W[0])<o$Eo.zeroTolerance&&Math.abs(o$k[1]-o$W[1])<o$Eo.zeroTolerance&&Math.abs(o$k[2]-o$W[2])<o$Eo.zeroTolerance)return;o$Tr.lookAt(o$D,o$o,o$r,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},o$x(0,o$r,"_isFrontFaceInvert",function(){var o$o=this.scale,o$r=o$o.x<0;return o$o.y<0&&(o$r=!o$r),o$o.z<0&&(o$r=!o$r),o$r}),o$x(0,o$r,"owner",function(){return this._owner}),o$x(0,o$r,"localRotation",function(){if(this._localQuaternionUpdate){var o$o=this._localRotationEuler.elements;o$Tr.createFromYawPitchRoll(o$o[1]/o$V._angleToRandin,o$o[0]/o$V._angleToRandin,o$o[2]/o$V._angleToRandin,this._localRotation)}return this._localRotation},function(o$o){this._localRotation=o$o,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),o$x(0,o$r,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?o$or.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(o$o){null===this._parent?o$o.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),o$or.multiply(this._localMatrix,o$o,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=o$o,this._worldUpdate=!1}),o$x(0,o$r,"worldNeedUpdate",function(){return this._worldUpdate}),o$x(0,o$r,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(o$o){this._localMatrix=o$o,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),o$x(0,o$r,"dummy",function(){return this._dummy},function(o$o){this._dummy!==o$o&&(this._dummy&&(this._dummy._entity=null),o$o&&(o$o._entity=this),this._dummy=o$o)}),o$x(0,o$r,"localPosition",function(){return this._localPosition},function(o$o){this._localPosition=o$o,this._localUpdate=!0,this._onWorldPositionTransform()}),o$x(0,o$r,"position",function(){if(this._positionUpdate){if(null!=this._parent){var o$o=this._parent.position;o$nr.multiply(this._localPosition,this._parent.scale,o$V._tempVector30),o$nr.transformQuat(o$V._tempVector30,this._parent.rotation,o$V._tempVector30),o$nr.add(o$o,o$V._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(o$o){if(null!=this._parent){o$nr.subtract(o$o,this._parent.position,this._localPosition);var o$r=this._parent.scale.elements,o$T=o$r[0],o$k=o$r[1],o$W=o$r[2];if(1!==o$T||1!==o$k||1!==o$W){var o$D=o$V._tempVector30,o$n=o$D.elements;o$n[0]=1/o$T,o$n[1]=1/o$k,o$n[2]=1/o$W,o$nr.multiply(this._localPosition,o$D,this._localPosition)}this._parent.rotation.invert(o$V._tempQuaternion0),o$nr.transformQuat(this._localPosition,o$V._tempQuaternion0,this._localPosition)}else o$o.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=o$o,this._positionUpdate=!1}),o$x(0,o$r,"localScale",function(){return this._localScale},function(o$o){this._localScale=o$o,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),o$x(0,o$r,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(o$V._tempVector30);var o$o=o$V._tempVector30.elements,o$r=this._localRotationEuler.elements;o$r[0]=o$o[1]*o$V._angleToRandin,o$r[1]=o$o[0]*o$V._angleToRandin,o$r[2]=o$o[2]*o$V._angleToRandin}return this._localRotationEuler},function(o$o){this._localRotationEuler=o$o,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),o$x(0,o$r,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?o$Tr.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(o$o){null!=this._parent?(this._parent.rotation.invert(o$V._tempQuaternion0),o$Tr.multiply(o$o,o$V._tempQuaternion0,this._localRotation)):o$o.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=o$o,this._rotationUpdate=!1}),o$x(0,o$r,"scale",function(){return this._scaleUpdate&&(null!==this._parent?o$nr.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(o$o){if(null!==this._parent){var o$r=this._parent.scale.elements,o$T=o$V._tempVector30.elements;o$T[0]=1/o$r[0],o$T[1]=1/o$r[1],o$T[2]=1/o$r[2],o$nr.multiply(o$o,o$V._tempVector30,this._localScale)}else o$o.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=o$o,this._scaleUpdate=!1}),o$x(0,o$r,"rotationEuler",null,function(o$o){o$Tr.createFromYawPitchRoll(o$o.y,o$o.x,o$o.z,this._rotation),this.rotation=this._rotation}),o$x(0,o$r,"forward",function(){var o$o=this.worldMatrix.elements;return this._forward.elements[0]=-o$o[8],this._forward.elements[1]=-o$o[9],this._forward.elements[2]=-o$o[10],this._forward}),o$x(0,o$r,"up",function(){var o$o=this.worldMatrix.elements;return this._up.elements[0]=o$o[4],this._up.elements[1]=o$o[5],this._up.elements[2]=o$o[6],this._up}),o$x(0,o$r,"right",function(){var o$o=this.worldMatrix.elements;return this._right.elements[0]=o$o[0],this._right.elements[1]=o$o[1],this._right.elements[2]=o$o[2],this._right}),o$x(0,o$r,"parent",function(){return this._parent},function(o$o){if(this._parent!==o$o){if(this._parent){var o$r=this._parent._childs,o$T=o$r.indexOf(this);o$r.splice(o$T,1)}o$o&&(o$o._childs.push(this),o$o&&this._onWorldTransform()),this._parent=o$o}}),o$p(o$V,["_tempVector30",function(){return this._tempVector30=new o$nr},"_tempVector31",function(){return this._tempVector31=new o$nr},"_tempVector32",function(){return this._tempVector32=new o$nr},"_tempVector33",function(){return this._tempVector33=new o$nr},"_tempQuaternion0",function(){return this._tempQuaternion0=new o$Tr},"_tempMatrix0",function(){return this._tempMatrix0=new o$or},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),o$V}(),o$br=(function(o$o){function o$r(){this._rotation=0,this._matNeedUpdte=!1,o$r.__super.call(this),this._matrix=new o$or,this._offset=new o$Dr,this._tiling=new o$Dr(1,1)}o$v(o$r,"laya.d3.core.TransformUV",o$D);var o$T=o$r.prototype;o$S.imps(o$T,{"laya.d3.core.IClone":!0}),o$T._updateMatrix=function(){o$r._tempOffsetV3.elements[0]=this._offset.x,o$r._tempOffsetV3.elements[1]=this._offset.y,o$Tr.createFromYawPitchRoll(0,0,this._rotation,o$r._tempRotationQua),o$r._tempTitlingV3.elements[0]=this._tiling.x,o$r._tempTitlingV3.elements[1]=this._tiling.y,o$or.createAffineTransformation(o$r._tempOffsetV3,o$r._tempRotationQua,o$r._tempTitlingV3,this._matrix)},o$T.cloneTo=function(o$o){o$o._matrix=this._matrix.clone(),o$o._offset=this._offset.clone(),o$o._rotation=this._rotation,o$o._tiling=this._tiling.clone()},o$T.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$T,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),o$x(0,o$T,"tiling",function(){return this._tiling},function(o$o){this._tiling=o$o,this._matNeedUpdte=!0}),o$x(0,o$T,"offset",function(){return this._offset},function(o$o){this._offset=o$o,this._matNeedUpdte=!0}),o$x(0,o$T,"rotation",function(){return this._rotation},function(o$o){this._rotation=o$o,this._matNeedUpdte=!0}),o$p(o$r,["_tempOffsetV3",function(){return this._tempOffsetV3=new o$nr(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new o$Tr},"_tempTitlingV3",function(){return this._tempTitlingV3=new o$nr(1,1,1)}])}(),function(o$T){function o$o(){this.x=NaN,this.y=NaN,this.z=NaN,o$o.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}o$v(o$o,"laya.d3.core.particleShuriKen.module.shape.BoxShape",o$T);var o$r=o$o.prototype;o$r._getShapeBoundBox=function(o$o){var o$r=o$o.min.elements;o$r[0]=.5*-this.x,o$r[1]=.5*-this.y,o$r[2]=.5*-this.z;var o$T=o$o.max.elements;o$T[0]=.5*this.x,o$T[1]=.5*this.y,o$T[2]=.5*this.z},o$r._getSpeedBoundBox=function(o$o){var o$r=o$o.min.elements;o$r[0]=0,o$r[1]=0,o$r[2]=0;var o$T=o$o.max.elements;o$T[0]=0,o$T[1]=1,o$T[2]=0},o$r.generatePositionAndDirection=function(o$o,o$r,o$T,o$k){var o$W=o$o.elements,o$D=o$r.elements;o$T?(o$T.seed=o$k[16],o$N._randomPointInsideHalfUnitBox(o$o,o$T),o$k[16]=o$T.seed):o$N._randomPointInsideHalfUnitBox(o$o),o$W[0]=this.x*o$W[0],o$W[1]=this.y*o$W[1],o$W[2]=this.z*o$W[2],this.randomDirection?o$T?(o$T.seed=o$k[17],o$N._randomPointUnitSphere(o$r,o$T),o$k[17]=o$T.seed):o$N._randomPointUnitSphere(o$r):(o$D[0]=0,o$D[1]=0,o$D[2]=1)},o$r.cloneTo=function(o$o){o$T.prototype.cloneTo.call(this,o$o);var o$r=o$o;o$r.x=this.x,o$r.y=this.y,o$r.z=this.z,o$r.randomDirection=this.randomDirection}}(o$e),function(o$T){function o$n(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,o$n.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}o$v(o$n,"laya.d3.core.particleShuriKen.module.shape.CircleShape",o$T);var o$o=o$n.prototype;o$o._getShapeBoundBox=function(o$o){var o$r=o$o.min.elements;o$r[0]=o$r[2]=-this.radius,o$r[1]=0;var o$T=o$o.max.elements;o$T[0]=o$T[2]=this.radius,o$T[1]=0},o$o._getSpeedBoundBox=function(o$o){var o$r=o$o.min.elements;o$r[0]=o$r[1]=-1,o$r[2]=0;var o$T=o$o.max.elements;o$T[0]=o$T[1]=1,o$T[2]=0},o$o.generatePositionAndDirection=function(o$o,o$r,o$T,o$k){var o$W=o$o.elements,o$D=o$n._tempPositionPoint.elements;o$T?(o$T.seed=o$k[16],this.emitFromEdge?o$N._randomPointUnitArcCircle(this.arc,o$n._tempPositionPoint,o$T):o$N._randomPointInsideUnitArcCircle(this.arc,o$n._tempPositionPoint,o$T),o$k[16]=o$T.seed):this.emitFromEdge?o$N._randomPointUnitArcCircle(this.arc,o$n._tempPositionPoint):o$N._randomPointInsideUnitArcCircle(this.arc,o$n._tempPositionPoint),o$W[0]=-o$D[0],o$W[1]=o$D[1],o$W[2]=0,o$nr.scale(o$o,this.radius,o$o),this.randomDirection?o$T?(o$T.seed=o$k[17],o$N._randomPointUnitSphere(o$r,o$T),o$k[17]=o$T.seed):o$N._randomPointUnitSphere(o$r):o$o.cloneTo(o$r)},o$o.cloneTo=function(o$o){o$T.prototype.cloneTo.call(this,o$o);var o$r=o$o;o$r.radius=this.radius,o$r.arc=this.arc,o$r.emitFromEdge=this.emitFromEdge,o$r.randomDirection=this.randomDirection},o$p(o$n,["_tempPositionPoint",function(){return this._tempPositionPoint=new o$Dr}])}(o$e),function(o$T){function o$i(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,o$i.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}o$v(o$i,"laya.d3.core.particleShuriKen.module.shape.ConeShape",o$T);var o$o=o$i.prototype;o$o._getShapeBoundBox=function(o$o){var o$r=this.radius+this.length*Math.sin(this.angle),o$T=this.length*Math.cos(this.angle),o$k=o$o.min.elements;o$k[0]=o$k[1]=-o$r,o$k[2]=0;var o$W=o$o.max.elements;o$W[0]=o$W[1]=o$r,o$W[2]=o$T},o$o._getSpeedBoundBox=function(o$o){var o$r=Math.sin(this.angle),o$T=o$o.min.elements;o$T[0]=o$T[1]=-o$r,o$T[2]=0;var o$k=o$o.max.elements;o$k[0]=o$T[1]=o$r,o$k[2]=1},o$o.generatePositionAndDirection=function(o$o,o$r,o$T,o$k){var o$W,o$D=o$o.elements,o$n=o$r.elements,o$V=o$i._tempPositionPoint.elements,o$L=NaN,o$U=NaN,o$h=Math.cos(this.angle),o$p=Math.sin(this.angle);switch(this.emitType){case 0:o$T?(o$T.seed=o$k[16],o$N._randomPointInsideUnitCircle(o$i._tempPositionPoint,o$T),o$k[16]=o$T.seed):o$N._randomPointInsideUnitCircle(o$i._tempPositionPoint),o$L=o$V[0],o$U=o$V[1],o$D[0]=o$L*this.radius,o$D[1]=o$U*this.radius,o$D[2]=0,this.randomDirection?(o$T?(o$T.seed=o$k[17],o$N._randomPointInsideUnitCircle(o$i._tempDirectionPoint,o$T),o$k[17]=o$T.seed):o$N._randomPointInsideUnitCircle(o$i._tempDirectionPoint),o$W=o$i._tempDirectionPoint.elements,o$n[0]=o$W[0]*o$p,o$n[1]=o$W[1]*o$p):(o$n[0]=o$L*o$p,o$n[1]=o$U*o$p),o$n[2]=o$h;break;case 1:o$T?(o$T.seed=o$k[16],o$N._randomPointUnitCircle(o$i._tempPositionPoint,o$T),o$k[16]=o$T.seed):o$N._randomPointUnitCircle(o$i._tempPositionPoint),o$L=o$V[0],o$U=o$V[1],o$D[0]=o$L*this.radius,o$D[1]=o$U*this.radius,o$D[2]=0,this.randomDirection?(o$T?(o$T.seed=o$k[17],o$N._randomPointInsideUnitCircle(o$i._tempDirectionPoint,o$T),o$k[17]=o$T.seed):o$N._randomPointInsideUnitCircle(o$i._tempDirectionPoint),o$W=o$i._tempDirectionPoint.elements,o$n[0]=o$W[0]*o$p,o$n[1]=o$W[1]*o$p):(o$n[0]=o$L*o$p,o$n[1]=o$U*o$p),o$n[2]=o$h;break;case 2:o$T?(o$T.seed=o$k[16],o$N._randomPointInsideUnitCircle(o$i._tempPositionPoint,o$T)):o$N._randomPointInsideUnitCircle(o$i._tempPositionPoint),o$L=o$V[0],o$U=o$V[1],o$D[0]=o$L*this.radius,o$D[1]=o$U*this.radius,o$n[o$D[2]=0]=o$L*o$p,o$n[1]=o$U*o$p,o$n[2]=o$h,o$nr.normalize(o$r,o$r),o$T?(o$nr.scale(o$r,this.length*o$T.getFloat(),o$r),o$k[16]=o$T.seed):o$nr.scale(o$r,this.length*Math.random(),o$r),o$nr.add(o$o,o$r,o$o),this.randomDirection&&(o$T?(o$T.seed=o$k[17],o$N._randomPointUnitSphere(o$r,o$T),o$k[17]=o$T.seed):o$N._randomPointUnitSphere(o$r));break;case 3:o$T?(o$T.seed=o$k[16],o$N._randomPointUnitCircle(o$i._tempPositionPoint,o$T)):o$N._randomPointUnitCircle(o$i._tempPositionPoint),o$L=o$V[0],o$U=o$V[1],o$D[0]=o$L*this.radius,o$D[1]=o$U*this.radius,o$n[o$D[2]=0]=o$L*o$p,o$n[1]=o$U*o$p,o$n[2]=o$h,o$nr.normalize(o$r,o$r),o$T?(o$nr.scale(o$r,this.length*o$T.getFloat(),o$r),o$k[16]=o$T.seed):o$nr.scale(o$r,this.length*Math.random(),o$r),o$nr.add(o$o,o$r,o$o),this.randomDirection&&(o$T?(o$T.seed=o$k[17],o$N._randomPointUnitSphere(o$r,o$T),o$k[17]=o$T.seed):o$N._randomPointUnitSphere(o$r));break;default:throw new Error("ConeShape:emitType is invalid.")}},o$o.cloneTo=function(o$o){o$T.prototype.cloneTo.call(this,o$o);var o$r=o$o;o$r.angle=this.angle,o$r.radius=this.radius,o$r.length=this.length,o$r.emitType=this.emitType,o$r.randomDirection=this.randomDirection},o$p(o$i,["_tempPositionPoint",function(){return this._tempPositionPoint=new o$Dr},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new o$Dr}])}(o$e),function(o$T){function o$o(){this.radius=NaN,this.emitFromShell=!1,o$o.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}o$v(o$o,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",o$T);var o$r=o$o.prototype;o$r._getShapeBoundBox=function(o$o){var o$r=o$o.min.elements;o$r[0]=o$r[1]=o$r[2]=-this.radius;var o$T=o$o.max.elements;o$T[0]=o$T[1]=this.radius,o$T[2]=0},o$r._getSpeedBoundBox=function(o$o){var o$r=o$o.min.elements;o$r[0]=o$r[1]=-1,o$r[2]=0;var o$T=o$o.max.elements;o$T[0]=o$T[1]=o$T[2]=1},o$r.generatePositionAndDirection=function(o$o,o$r,o$T,o$k){var o$W=o$o.elements;o$T?(o$T.seed=o$k[16],this.emitFromShell?o$N._randomPointUnitSphere(o$o,o$T):o$N._randomPointInsideUnitSphere(o$o,o$T),o$k[16]=o$T.seed):this.emitFromShell?o$N._randomPointUnitSphere(o$o):o$N._randomPointInsideUnitSphere(o$o),o$nr.scale(o$o,this.radius,o$o);var o$D=o$W[2];o$D<0&&(o$W[2]=-1*o$D),this.randomDirection?o$T?(o$T.seed=o$k[17],o$N._randomPointUnitSphere(o$r,o$T),o$k[17]=o$T.seed):o$N._randomPointUnitSphere(o$r):o$o.cloneTo(o$r)},o$r.cloneTo=function(o$o){o$T.prototype.cloneTo.call(this,o$o);var o$r=o$o;o$r.radius=this.radius,o$r.emitFromShell=this.emitFromShell,o$r.randomDirection=this.randomDirection}}(o$e),function(o$T){function o$o(){this.radius=NaN,this.emitFromShell=!1,o$o.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}o$v(o$o,"laya.d3.core.particleShuriKen.module.shape.SphereShape",o$T);var o$r=o$o.prototype;o$r._getShapeBoundBox=function(o$o){var o$r=o$o.min.elements;o$r[0]=o$r[1]=o$r[2]=-this.radius;var o$T=o$o.max.elements;o$T[0]=o$T[1]=o$T[2]=this.radius},o$r._getSpeedBoundBox=function(o$o){var o$r=o$o.min.elements;o$r[0]=o$r[1]=o$r[2]=-1;var o$T=o$o.max.elements;o$T[0]=o$T[1]=o$T[2]=1},o$r.generatePositionAndDirection=function(o$o,o$r,o$T,o$k){o$T?(o$T.seed=o$k[16],this.emitFromShell?o$N._randomPointUnitSphere(o$o,o$T):o$N._randomPointInsideUnitSphere(o$o,o$T),o$k[16]=o$T.seed):this.emitFromShell?o$N._randomPointUnitSphere(o$o):o$N._randomPointInsideUnitSphere(o$o),o$nr.scale(o$o,this.radius,o$o),this.randomDirection?o$T?(o$T.seed=o$k[17],o$N._randomPointUnitSphere(o$r,o$T),o$k[17]=o$T.seed):o$N._randomPointUnitSphere(o$r):o$o.cloneTo(o$r)},o$r.cloneTo=function(o$o){o$T.prototype.cloneTo.call(this,o$o);var o$r=o$o;o$r.radius=this.radius,o$r.emitFromShell=this.emitFromShell,o$r.randomDirection=this.randomDirection}}(o$e),function(o$o){function o$r(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,o$r.__super.call(this)}return o$v(o$r,"laya.d3.core.render.SubMeshRenderElement",o$G),o$r}()),o$Fr=function(o$o){function o$_(o$o,o$r,o$T,o$k,o$W,o$D){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=o$o,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[o$vr.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[o$ar.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[o$ar.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[o$Rr.SHADERDEFINE_ALPHATEST]="ALPHATEST";o$_.__super.call(this,o$o,o$r,o$T,null,{}),this._attributeMap=o$k;var o$n;for(o$n in o$W){var o$V=o$W[o$n];switch(o$V[1]){case 0:this._renderElementUniformMap[o$n]=o$V[0];break;case 1:this._materialUniformMap[o$n]=o$V[0];break;case 2:this._spriteUniformMap[o$n]=o$V[0];break;case 3:this._cameraUniformMap[o$n]=o$V[0];break;case 4:this._sceneUniformMap[o$n]=o$V[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}o$v(o$_,"laya.d3.shader.ShaderCompile3D",o$y);var o$r=o$_.prototype;return o$r._definesToNameDic=function(o$o,o$r){for(var o$T={},o$k=1,o$W=0;o$W<32&&!(o$o<(o$k=1<<o$W));o$W++)if(o$o&o$k){var o$D=o$r[o$k];o$D&&(o$T[o$D]="")}return o$T},o$r.withCompile=function(o$o,o$r,o$T,o$k){var o$W,o$D,o$n;if(o$D=this.sharders[o$o])if(o$n=o$D[o$r]){if(o$W=o$n[o$T])return o$W}else o$n=o$D[o$r]=[];else o$n=(o$D=this.sharders[o$o]=[])[o$r]=[];var o$V,o$L=this._definesToNameDic(o$o,o$_._globalInt2name),o$U=this._definesToNameDic(o$r,this._spriteInt2name),o$h=this._definesToNameDic(o$T,this._materialInt2name),o$p={},o$i="";if(o$L)for(o$V in o$L)o$i+="#define "+o$V+"\n",o$p[o$V]=!0;if(o$U)for(o$V in o$U)o$i+="#define "+o$V+"\n",o$p[o$V]=!0;if(o$h)for(o$V in o$h)o$i+="#define "+o$V+"\n",o$p[o$V]=!0;var o$v=o$Or.nameKey.getName(this._name)+" compile ("+o$o+","+o$r+","+o$T+")",o$x=this._VS.toscript(o$p,[]),o$j=this._PS.toscript(o$p,[]);o$z.now();if(o$W=o$Or.create(o$i+o$x.join("\n"),o$i+o$j.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,o$k,o$v),o$n[o$T]=o$W,laya.d3.shader.ShaderCompile3D.debugMode)o$z.now();return o$W},o$r.precompileShaderWithShaderDefine=function(o$o,o$r,o$T){this.withCompile(o$o,o$r,o$T,!0)},o$r.addMaterialDefines=function(o$o){var o$r=o$o.defines;for(var o$T in o$r){var o$k=o$r[o$T],o$W=parseInt(o$T);this._materialInt2name[o$W]=o$k,this._materialName2Int[o$k]=o$W}},o$r.addSpriteDefines=function(o$o){var o$r=o$o.defines;for(var o$T in o$r){var o$k=o$r[o$T],o$W=parseInt(o$T);this._spriteInt2name[o$W]=o$k,this._spriteName2Int[o$k]=o$W}},o$r.getMaterialDefineByName=function(o$o){return this._materialName2Int[o$o]},o$r.registerMaterialDefine=function(o$o){var o$r=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[o$r]=o$o,this._materialName2Int[o$o]=o$r},o$r.registerSpriteDefine=function(o$o){var o$r=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[o$r]=o$o,this._spriteName2Int[o$o]=o$r},o$_._globalRegDefine=function(o$o,o$r){o$_._globalInt2name[o$r]=o$o},o$_.add=function(o$o,o$r,o$T,o$k,o$W){return laya.d3.shader.ShaderCompile3D._preCompileShader[o$o]=new o$_(o$o,o$r,o$T,o$k,o$W,o$y.includes)},o$_.get=function(o$o){return laya.d3.shader.ShaderCompile3D._preCompileShader[o$Or.nameKey.getID(o$o)]},o$_._preCompileShader={},o$_._globalInt2name=[],o$_.debugMode=!1,o$_.SHADERDEFINE_HIGHPRECISION=1,o$_.SHADERDEFINE_FOG=4,o$_.SHADERDEFINE_DIRECTIONLIGHT=8,o$_.SHADERDEFINE_POINTLIGHT=16,o$_.SHADERDEFINE_SPOTLIGHT=32,o$_.SHADERDEFINE_UV0=64,o$_.SHADERDEFINE_COLOR=128,o$_.SHADERDEFINE_UV1=256,o$_.SAHDERDEFINE_DEPTHFOG=131072,o$_}(),o$Pr=function(o$o){function o$x(){o$x.__super.call(this)}o$v(o$x,"laya.d3.graphics.MeshSprite3DStaticBatchManager",o$ko);var o$r=o$x.prototype;return o$r._getStaticBatch=function(o$o,o$r,o$T,o$k){var o$W,o$D;return o$D=o$o?o$o.id.toString()+o$T.id.toString()+o$r.id.toString()+o$k.toString():o$T.id.toString()+o$r.id.toString()+o$k.toString(),this._staticBatches[o$D]?o$W=this._staticBatches[o$D]:this._staticBatches[o$D]=o$W=new o$tr(o$D,this,o$o,o$r,o$T),o$W},o$r._initStaticBatchs=function(o$o){var o$r,o$T;this._initBatchRenderElements.sort(o$x._sortPrepareStaticBatch);for(var o$k,o$W=!1,o$D=0,o$n=0,o$V=this._initBatchRenderElements.length;o$n<o$V;o$n++){var o$L,o$U=this._initBatchRenderElements[o$n],o$h=o$U.renderObj._getVertexBuffer(0);o$U._sprite3D;if(o$T===o$h.vertexDeclaration&&o$r===o$U._material)if(o$W)o$k._addCombineBatchRenderObjTest(o$U)?(o$L=o$U._staticBatch)!==o$k&&(o$L&&o$L._deleteCombineBatchRenderObj(o$U),o$k._addCombineBatchRenderObj(o$U)):(o$W=!1,o$D++);else{var o$p=this._initBatchRenderElements[o$n-1],o$i=o$p.renderObj,o$v=o$U.renderObj;o$W=!(65535<o$i._getVertexBuffer().vertexCount+o$v._getVertexBuffer().vertexCount)&&(o$k=this._getStaticBatch(o$o,o$T,o$r,o$D),(o$L=o$p._staticBatch)!==o$k&&(o$L&&o$L._deleteCombineBatchRenderObj(o$p),o$k._addCombineBatchRenderObj(o$p)),(o$L=o$U._staticBatch)!==o$k&&(o$L&&o$L._deleteCombineBatchRenderObj(o$U),o$k._addCombineBatchRenderObj(o$U)),!0)}else o$W=!1,o$D=0;o$r=o$U._material,o$T=o$h.vertexDeclaration}},o$x._sortPrepareStaticBatch=function(o$o,o$r){var o$T=o$o._render,o$k=o$r._render,o$W=o$T.lightmapIndex-o$k.lightmapIndex;if(0!=o$W)return o$W;var o$D=o$T.receiveShadow-o$k.receiveShadow;if(0!=o$D)return o$D;var o$n=o$o._mainSortID-o$r._mainSortID;return 0==o$n?o$o.renderObj.triangleCount-o$r.renderObj.triangleCount:o$n},o$x}(),o$tr=function(o$o){function o$D(o$o,o$r,o$T,o$k,o$W){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,o$D.__super.call(this,o$o,o$r,o$T),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=o$k,this._material=o$W}o$v(o$D,"laya.d3.graphics.SubMeshStaticBatch",o$Wo);var o$r=o$D.prototype;return o$r._compareBatchRenderElement=function(o$o,o$r){return o$o._batchIndexStart>o$r._batchIndexStart},o$r._addCombineBatchRenderObjTest=function(o$o){var o$r=o$o.renderObj._vertexCount;return!(65535<(0<o$r?this._currentCombineVertexCount+o$r:this._currentCombineVertexCount+o$o.renderObj._getVertexBuffer().vertexCount))},o$r._addCombineBatchRenderObj=function(o$o){var o$r=o$o.renderObj,o$T=o$r._vertexCount;this._initBatchRenderElements.push(o$o),o$o._staticBatch=this,0<o$T?(this._currentCombineIndexCount+=o$r._indexCount,this._currentCombineVertexCount+=o$T):(this._currentCombineIndexCount=this._currentCombineIndexCount+o$r._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+o$r._getVertexBuffer().vertexCount),this._needFinishCombine=!0},o$r._deleteCombineBatchRenderObj=function(o$o){var o$r=o$o.renderObj,o$T=this._initBatchRenderElements.indexOf(o$o);if(-1!==o$T){this._initBatchRenderElements.splice(o$T,1),o$o._staticBatch=null;var o$k=o$r._vertexCount;0<o$k?(this._currentCombineIndexCount=this._currentCombineIndexCount-o$r._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-o$k):(this._currentCombineIndexCount=this._currentCombineIndexCount-o$r._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-o$r._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},o$r._finishInit=function(){if(this._needFinishCombine){var o$o=0,o$r=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var o$T=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),o$k=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=o$er.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=o$cr.create("ushort",this._currentCombineIndexCount,35044);for(var o$W=0,o$D=this._initBatchRenderElements.length;o$W<o$D;o$W++){var o$n=this._initBatchRenderElements[o$W],o$V=o$n.renderObj,o$L=o$V._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,o$n._sprite3D),o$U=o$V.getIndices(),o$h=o$n._sprite3D.transform._isFrontFaceInvert,o$p=o$o/(this._vertexDeclaration.vertexStride/4)-o$V._vertexStart,o$i=o$r,o$v=o$i+o$U.length;o$n._batchIndexStart=o$i,o$n._batchIndexEnd=o$v,o$k.set(o$U,o$r);var o$x=0;if(o$h)for(o$x=o$i;o$x<o$v;o$x+=3){o$k[o$x]=o$p+o$k[o$x];var o$j=o$k[o$x+1],o$_=o$k[o$x+2];o$k[o$x+1]=o$p+o$_,o$k[o$x+2]=o$p+o$j}else for(o$x=o$i;o$x<o$v;o$x+=3)o$k[o$x]=o$p+o$k[o$x],o$k[o$x+1]=o$p+o$k[o$x+1],o$k[o$x+2]=o$p+o$k[o$x+2];o$r+=o$U.length,o$T.set(o$L,o$o),o$o+=o$L.length}this._vertexBuffer.setData(o$T),this._indexBuffer.setData(o$k),this._needFinishCombine=!1}},o$r._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new o$br)},o$r._getRenderElement=function(o$o,o$r,o$T){for(var o$k,o$W,o$D=this._batchRenderElements.length,o$n=!0,o$V=0;o$V<o$D;o$V++){var o$L,o$U,o$h=(o$W=this._batchRenderElements[o$V])._sprite3D._render;if(0!==o$V&&(o$n=(o$L=(o$k=this._batchRenderElements[o$V-1])._sprite3D._render).lightmapIndex!==o$h.lightmapIndex||o$L.receiveShadow!==o$h.receiveShadow||o$k._batchIndexEnd!==o$W._batchIndexStart),o$n){(o$U=this._getCombineRenderElementFromPool()).renderObj=this,o$U._material=this._material,o$U._batchIndexStart=o$W._batchIndexStart,o$U._batchIndexEnd=o$W._batchIndexEnd;var o$p=o$h.lightmapIndex,o$i=o$p+1,o$v=this._batchOwnerIndices[o$i];o$v||(o$v=this._batchOwnerIndices[o$i]=[]);var o$x,o$j=o$v[o$W._render.receiveShadow?1:0];void 0===o$j?(o$v[o$h.receiveShadow?1:0]=this._batchOwners.length,(o$x=new o$wr(null,"StaticBatchMeshSprite3D"))._scene=o$r,o$x._transform=this._rootOwner?this._rootOwner._transform:null,o$x._render.lightmapIndex=o$p,o$x._render.receiveShadow=o$W._render.receiveShadow,this._batchOwners.push(o$x)):o$x=this._batchOwners[o$j],o$x._render._renderUpdate(o$T),o$U._sprite3D=o$x,o$o.push(o$U)}else o$U._batchIndexEnd=o$W._batchIndexEnd}},o$r._beforeRender=function(o$o){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},o$r._render=function(o$o){var o$r=o$o.renderElement,o$T=o$r._batchIndexStart,o$k=o$r._batchIndexEnd-o$T;o$u.mainContext.drawElements(4,o$k,5123,2*o$T),o$F.drawCall++,o$F.trianglesFaces+=o$k/3},o$r.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},o$r._getVertexBuffer=function(o$o){return void 0===o$o&&(o$o=0),this._vertexBuffer},o$D}(),o$Hr=function(o$o){function o$r(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,o$r.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}o$v(o$r,"laya.d3.core.ComponentNode",o$U);var o$T=o$r.prototype;return o$T.addComponent=function(o$o){var o$r,o$T=this._componentsMap.indexOf(o$o);if(-1===o$T)o$r=[],this._componentsMap.push(o$o),this._typeComponentsIndices.push(o$r);else if(o$r=this._typeComponentsIndices[o$T],this._components[o$r[0]].isSingleton)throw new Error("无法单实例创建"+o$o+"组件，"+o$o+"组件已存在！");var o$k=o$W.getInstance(o$o);return o$r.push(this._components.length),this._components.push(o$k),o$k instanceof laya.d3.component.Script&&this._scripts.push(o$k),o$k._initialize(this),o$k},o$T._removeComponent=function(o$o,o$r){var o$T=this._typeComponentsIndices[o$o],o$k=o$T[o$r],o$W=this._components[o$k];this._components.splice(o$k,1),o$W instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(o$W),1),o$T.splice(o$r,1),0===o$T.length&&(this._typeComponentsIndices.splice(o$o,1),this._componentsMap.splice(o$o,1));for(var o$D=0,o$n=this._componentsMap.length;o$D<o$n;o$D++)for(var o$V=(o$T=this._typeComponentsIndices[o$D]).length-1;0<=o$V;o$V--){var o$L=o$T[o$V];if(!(o$k<o$L))break;o$T[o$V]=--o$L}o$W._destroy()},o$T.getComponentByType=function(o$o,o$r){void 0===o$r&&(o$r=0);var o$T=this._componentsMap.indexOf(o$o);return-1===o$T?null:this._components[this._typeComponentsIndices[o$T][o$r]]},o$T.getComponentsByType=function(o$o,o$r){var o$T=this._componentsMap.indexOf(o$o);if(-1!==o$T){var o$k=this._typeComponentsIndices[o$T],o$W=o$k.length;o$r.length=o$W;for(var o$D=0;o$D<o$W;o$D++)o$r[o$D]=this._components[o$k[o$D]]}else o$r.length=0},o$T.getComponentByIndex=function(o$o){return this._components[o$o]},o$T.removeComponentByType=function(o$o,o$r){void 0===o$r&&(o$r=0);var o$T=this._componentsMap.indexOf(o$o);-1!==o$T&&this._removeComponent(o$T,o$r)},o$T.removeComponentsByType=function(o$o){var o$r=this._componentsMap.indexOf(o$o);if(-1!==o$r)for(var o$T=this._typeComponentsIndices[o$r],o$k=0,o$W=o$T.length;o$k<o$W;o$T.length<o$W?o$W--:o$k++)this._removeComponent(o$r,o$k)},o$T.removeAllComponent=function(){for(var o$o=0,o$r=this._componentsMap.length;o$o<o$r;this._componentsMap.length<o$r?o$r--:o$o++)this.removeComponentsByType(this._componentsMap[o$o])},o$T._updateComponents=function(o$o){for(var o$r=0,o$T=this._components.length;o$r<o$T;o$r++){var o$k=this._components[o$r];!o$k.started&&(o$k._start(o$o),o$k.started=!0),o$k.enable&&o$k._update(o$o)}},o$T._lateUpdateComponents=function(o$o){for(var o$r=0;o$r<this._components.length;o$r++){var o$T=this._components[o$r];!o$T.started&&(o$T._start(o$o),o$T.started=!0),o$T.enable&&o$T._lateUpdate(o$o)}},o$T._preRenderUpdateComponents=function(o$o){for(var o$r=0;o$r<this._components.length;o$r++){var o$T=this._components[o$r];!o$T.started&&(o$T._start(o$o),o$T.started=!0),o$T.enable&&o$T._preRenderUpdate(o$o)}},o$T._postRenderUpdateComponents=function(o$o){for(var o$r=0;o$r<this._components.length;o$r++){var o$T=this._components[o$r];!o$T.started&&(o$T._start(o$o),o$T.started=!0),o$T.enable&&o$T._postRenderUpdate(o$o)}},o$r}(),o$Rr=function(o$k){function o$o(){o$o.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new o$ir,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new o$Vr(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}o$v(o$o,"laya.d3.core.material.BaseMaterial",o$k);var o$r=o$o.prototype;return o$S.imps(o$r,{"laya.d3.core.IClone":!0}),o$r._addShaderDefine=function(o$o){this._shaderDefineValue|=o$o},o$r._removeShaderDefine=function(o$o){this._shaderDefineValue&=~o$o},o$r._addDisablePublicShaderDefine=function(o$o){this._disablePublicShaderDefine|=o$o},o$r._removeDisablePublicShaderDefine=function(o$o){this._disablePublicShaderDefine&=~o$o},o$r._setBuffer=function(o$o,o$r){this._shaderValues.setValue(o$o,o$r),this._values[o$o]=o$r},o$r._getBuffer=function(o$o){return this._values[o$o]},o$r._setMatrix4x4=function(o$o,o$r){this._shaderValues.setValue(o$o,o$r?o$r.elements:null),this._values[o$o]=o$r},o$r._getMatrix4x4=function(o$o){return this._values[o$o]},o$r._setInt=function(o$o,o$r){this._shaderValues.setValue(o$o,o$r),this._values[o$o]=o$r},o$r._getInt=function(o$o){return this._values[o$o]},o$r._setNumber=function(o$o,o$r){this._shaderValues.setValue(o$o,o$r),this._values[o$o]=o$r},o$r._getNumber=function(o$o){return this._values[o$o]},o$r._setBool=function(o$o,o$r){this._shaderValues.setValue(o$o,o$r),this._values[o$o]=o$r},o$r._getBool=function(o$o){return this._values[o$o]},o$r._setVector2=function(o$o,o$r){this._shaderValues.setValue(o$o,o$r?o$r.elements:null),this._values[o$o]=o$r},o$r._getVector2=function(o$o){return this._values[o$o]},o$r._setColor=function(o$o,o$r){this._shaderValues.setValue(o$o,o$r?o$r.elements:null),this._values[o$o]=o$r},o$r._getColor=function(o$o){return this._values[o$o]},o$r._setTexture=function(o$o,o$r){var o$T=this._values[o$o];this._values[o$o]=o$r,this._shaderValues.setValue(o$o,o$r),0<this.referenceCount&&(o$T&&o$T._removeReference(),o$r&&o$r._addReference())},o$r._getTexture=function(o$o){return this._values[o$o]},o$r._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},o$r._getShader=function(o$o,o$r,o$T){var o$k=(o$o|o$r)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(o$k,o$T,this._shaderDefineValue),this._shader},o$r._setRenderStateBlendDepth=function(){var o$o=o$u.mainContext;switch(o$s.setDepthMask(o$o,this.depthWrite),0===this.depthTest?o$s.setDepthTest(o$o,!1):(o$s.setDepthTest(o$o,!0),o$s.setDepthFunc(o$o,this.depthTest)),this.blend){case 0:o$s.setBlend(o$o,!1);break;case 1:o$s.setBlend(o$o,!0),o$s.setBlendFunc(o$o,this.srcBlend,this.dstBlend);break;case 2:o$s.setBlend(o$o,!0)}},o$r._setRenderStateFrontFace=function(o$o,o$r){var o$T=o$u.mainContext,o$k=0;switch(this.cull){case 0:o$s.setCullFace(o$T,!1);break;case 1:o$s.setCullFace(o$T,!0),o$k=o$o?o$r&&o$r._isFrontFaceInvert?2305:2304:o$r&&o$r._isFrontFaceInvert?2304:2305,o$s.setFrontFace(o$T,o$k);break;case 2:o$s.setCullFace(o$T,!0),o$k=o$o?o$r&&o$r._isFrontFaceInvert?2304:2305:o$r&&o$r._isFrontFaceInvert?2305:2304,o$s.setFrontFace(o$T,o$k)}},o$r.onAsynLoaded=function(o$o,o$r,o$T){var o$k=o$r[0],o$W=o$r[1];switch(o$k.version){case"LAYAMATERIAL:01":var o$D=0,o$n=0,o$V=o$k.props;for(var o$L in o$V)switch(o$L){case"vectors":var o$U=o$V[o$L];for(o$D=0,o$n=o$U.length;o$D<o$n;o$D++){var o$h=o$U[o$D],o$p=o$h.value;switch(o$p.length){case 2:this[o$h.name]=new o$Dr(o$p[0],o$p[1]);break;case 3:this[o$h.name]=new o$nr(o$p[0],o$p[1],o$p[2]);break;case 4:this[o$h.name]=new o$Vr(o$p[0],o$p[1],o$p[2],o$p[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var o$i=o$V[o$L];for(o$D=0,o$n=o$i.length;o$D<o$n;o$D++){var o$v=o$i[o$D],o$x=o$v.path;o$x&&(this[o$v.name]=o$K.getRes(o$W[o$x]))}break;case"defines":var o$j=o$V[o$L];for(o$D=0,o$n=o$j.length;o$D<o$n;o$D++){var o$_=this._shaderCompile.getMaterialDefineByName(o$j[o$D]);this._addShaderDefine(o$_)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[o$L]=o$V[o$L];break;case"renderQueue":switch(o$V[o$L]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[o$L]=o$V[o$L]}break;case"LAYAMATERIAL:02":for(o$L in o$V=o$k.props)switch(o$L){case"vectors":for(o$D=0,o$n=(o$U=o$V[o$L]).length;o$D<o$n;o$D++)switch((o$p=(o$h=o$U[o$D]).value).length){case 2:this[o$h.name]=new o$Dr(o$p[0],o$p[1]);break;case 3:this[o$h.name]=new o$nr(o$p[0],o$p[1],o$p[2]);break;case 4:this[o$h.name]=new o$Vr(o$p[0],o$p[1],o$p[2],o$p[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(o$D=0,o$n=(o$i=o$V[o$L]).length;o$D<o$n;o$D++)(o$x=(o$v=o$i[o$D]).path)&&(this[o$v.name]=o$K.getRes(o$W[o$x]));break;case"defines":for(o$D=0,o$n=(o$j=o$V[o$L]).length;o$D<o$n;o$D++)o$_=this._shaderCompile.getMaterialDefineByName(o$j[o$D]),this._addShaderDefine(o$_);break;default:this[o$L]=o$V[o$L]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},o$r._addReference=function(){o$k.prototype._addReference.call(this);for(var o$o=0,o$r=this._values.length;o$o<o$r;o$o++){var o$T=this._values[o$o];o$T&&o$T instanceof laya.d3.resource.BaseTexture&&o$T._addReference()}},o$r._removeReference=function(){o$k.prototype._removeReference.call(this);for(var o$o=0,o$r=this._values.length;o$o<o$r;o$o++){var o$T=this._values[o$o];o$T&&o$T instanceof laya.d3.resource.BaseTexture&&o$T._removeReference()}},o$r.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},o$r.setShaderName=function(o$o){var o$r=o$Or.nameKey.getID(o$o);if(-1===o$r)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=o$Fr._preCompileShader[o$r]},o$r.cloneTo=function(o$o){var o$r=o$o;o$r.name=this.name,o$r.cull=this.cull,o$r.blend=this.blend,o$r.srcBlend=this.srcBlend,o$r.dstBlend=this.dstBlend,o$r.srcBlendRGB=this.srcBlendRGB,o$r.dstBlendRGB=this.dstBlendRGB,o$r.srcBlendAlpha=this.srcBlendAlpha,o$r.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(o$r.blendConstColor),o$r.blendEquation=this.blendEquation,o$r.blendEquationRGB=this.blendEquationRGB,o$r.blendEquationAlpha=this.blendEquationAlpha,o$r.depthTest=this.depthTest,o$r.depthWrite=this.depthWrite,o$r.renderQueue=this.renderQueue,o$r._shader=this._shader,o$r._disablePublicShaderDefine=this._disablePublicShaderDefine,o$r._shaderDefineValue=this._shaderDefineValue;var o$T,o$k=0,o$W=o$r._shaderValues;o$r._shaderValues.data.length=this._shaderValues.data.length;var o$D=this._values.length,o$n=o$r._values;for(o$k=0,o$T=o$n.length=o$D;o$k<o$T;o$k++){var o$V=this._values[o$k];if(o$V)if("number"==typeof o$V)o$n[o$k]=o$V,o$W.data[o$k]=o$V;else if("number"==typeof o$V&&Math.floor(o$V)==o$V)o$n[o$k]=o$V,o$W.data[o$k]=o$V;else if("boolean"==typeof o$V)o$n[o$k]=o$V,o$W.data[o$k]=o$V;else if(o$V instanceof laya.d3.math.Vector2){var o$L=o$n[o$k]||(o$n[o$k]=new o$Dr);o$V.cloneTo(o$L),o$W.data[o$k]=o$L.elements}else if(o$V instanceof laya.d3.math.Vector3){var o$U=o$n[o$k]||(o$n[o$k]=new o$nr);o$V.cloneTo(o$U),o$W.data[o$k]=o$U.elements}else if(o$V instanceof laya.d3.math.Vector4){var o$h=o$n[o$k]||(o$n[o$k]=new o$Vr);o$V.cloneTo(o$h),o$W.data[o$k]=o$h.elements}else if(o$V instanceof laya.d3.math.Matrix4x4){var o$p=o$n[o$k]||(o$n[o$k]=new o$or);o$V.cloneTo(o$p),o$W.data[o$k]=o$p.elements}else o$V instanceof laya.d3.resource.BaseTexture&&(o$n[o$k]=o$V,o$W.data[o$k]=o$V)}},o$r.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$x(0,o$r,"alphaTestValue",function(){return this._getNumber(0)},function(o$o){this._setNumber(0,o$o)}),o$x(0,o$r,"alphaTest",function(){return this._alphaTest},function(o$o){(this._alphaTest=o$o)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),o$o.__init__=function(){o$o.SHADERDEFINE_ALPHATEST=o$o.shaderDefines.registerDefine("ALPHATEST")},o$o.RENDERQUEUE_OPAQUE=2e3,o$o.RENDERQUEUE_ALPHATEST=2450,o$o.RENDERQUEUE_TRANSPARENT=3e3,o$o.CULL_NONE=0,o$o.CULL_FRONT=1,o$o.CULL_BACK=2,o$o.BLEND_DISABLE=0,o$o.BLEND_ENABLE_ALL=1,o$o.BLEND_ENABLE_SEPERATE=2,o$o.BLENDPARAM_ZERO=0,o$o.BLENDPARAM_ONE=1,o$o.BLENDPARAM_SRC_COLOR=768,o$o.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,o$o.BLENDPARAM_DST_COLOR=774,o$o.BLENDPARAM_ONE_MINUS_DST_COLOR=775,o$o.BLENDPARAM_SRC_ALPHA=770,o$o.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,o$o.BLENDPARAM_DST_ALPHA=772,o$o.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,o$o.BLENDPARAM_SRC_ALPHA_SATURATE=776,o$o.BLENDEQUATION_ADD=0,o$o.BLENDEQUATION_SUBTRACT=1,o$o.BLENDEQUATION_REVERSE_SUBTRACT=2,o$o.DEPTHTEST_OFF=0,o$o.DEPTHTEST_NEVER=512,o$o.DEPTHTEST_LESS=513,o$o.DEPTHTEST_EQUAL=514,o$o.DEPTHTEST_LEQUAL=515,o$o.DEPTHTEST_GREATER=516,o$o.DEPTHTEST_NOTEQUAL=517,o$o.DEPTHTEST_GEQUAL=518,o$o.DEPTHTEST_ALWAYS=519,o$o.SHADERDEFINE_ALPHATEST=1,o$o.ALPHATESTVALUE=0,o$p(o$o,["shaderDefines",function(){return this.shaderDefines=new o$hr}]),o$o}(o$_),o$ur=function(o$o){function o$r(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,o$r.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}o$v(o$r,"laya.d3.resource.BaseTexture",o$_);var o$T=o$r.prototype;return o$x(0,o$T,"width",function(){return this._width}),o$x(0,o$T,"repeat",function(){return this._repeat},function(o$o){if(this._repeat!==o$o&&(this._repeat=o$o,this._source)){var o$r=o$u.mainContext;o$s.bindTexture(o$r,this._type,this._source),o$l.isPOT(this._width,this._height)&&this._repeat?(o$r.texParameteri(this._type,10242,10497),o$r.texParameteri(this._type,10243,10497)):(o$r.texParameteri(this._type,10242,33071),o$r.texParameteri(this._type,10243,33071))}}),o$x(0,o$T,"height",function(){return this._height}),o$x(0,o$T,"magFifter",function(){return this._magFifter},function(o$o){(this._magFifter=o$o)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(o$o)}),o$x(0,o$T,"wrapModeV",function(){return this._wrapModeV}),o$x(0,o$T,"size",function(){return this._size}),o$x(0,o$T,"wrapModeU",function(){return this._wrapModeU}),o$x(0,o$T,"mipmap",function(){return this._mipmap},function(o$o){this._mipmap=o$o,this._mipmap!=o$o&&this._conchTexture&&this._conchTexture.setMipMap(o$o)}),o$x(0,o$T,"minFifter",function(){return this._minFifter},function(o$o){this._minFifter=o$o,this._minFifter!=o$o&&this._conchTexture&&this._conchTexture.setMinFifter(o$o)}),o$x(0,o$T,"format",function(){return this._format}),o$x(0,o$T,"source",function(){return this.activeResource(),this._source}),o$x(0,o$T,"defaulteTexture",function(){return o$Ir.grayTexture}),o$r.WARPMODE_REPEAT=0,o$r.WARPMODE_CLAMP=1,o$r}(),o$sr=function(o$o){function o$r(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,o$r.__super.call(this),this._boundingBoxCorners=o$k(8,null)}o$v(o$r,"laya.d3.resource.models.BaseMesh",o$_);var o$T=o$r.prototype;return o$T._getPositions=function(){throw new Error("未Override,请重载该属性！")},o$T._generateBoundingObject=function(){this._boundingSphere=new o$Bo(new o$nr,0),o$Bo.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new o$Qo(new o$nr,new o$nr),o$Qo.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},o$T.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},o$T.getRenderElement=function(o$o){throw new Error("未Override,请重载该属性！")},o$x(0,o$T,"subMeshCount",function(){return this._subMeshCount}),o$x(0,o$T,"boundingBox",function(){return this._boundingBox}),o$x(0,o$T,"boundingBoxCorners",function(){return this._boundingBoxCorners}),o$x(0,o$T,"boundingSphere",function(){return this._boundingSphere}),o$r}(),o$zr=(function(o$o){function o$r(){o$r.__super.call(this)}o$v(o$r,"laya.d3.component.Script",o$yr);var o$T=o$r.prototype;o$T.onTriggerEnter=function(o$o){},o$T.onTriggerExit=function(o$o){},o$T.onTriggerStay=function(o$o){},o$x(0,o$T,"isSingleton",function(){return o$r._isSingleton}),o$r._isSingleton=!1}(),function(o$o){function o$r(o$o){this._owner=null,this._sharedMesh=null,o$r.__super.call(this),this._owner=o$o}o$v(o$r,"laya.d3.core.MeshFilter",o$o);var o$T=o$r.prototype;return o$T._sharedMeshLoaded=function(){this.event("loaded")},o$T._destroy=function(){o$o.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},o$x(0,o$T,"sharedMesh",function(){return this._sharedMesh},function(o$o){var o$r=this._sharedMesh;o$r&&o$r._removeReference(),(this._sharedMesh=o$o)._addReference(),this.event("meshchanged",[this,o$r,o$o]),o$o.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),o$x(0,o$T,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),o$x(0,o$T,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),o$x(0,o$T,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),o$x(0,o$T,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),o$r}(o$lr)),o$mr=function(o$o){function o$r(o$o){o$r.__super.call(this,o$o),o$o.meshFilter.on("meshchanged",this,this._onMeshChanged)}o$v(o$r,"laya.d3.core.MeshRender",o$Sr);var o$T=o$r.prototype;return o$T._onMeshChanged=function(o$o,o$r,o$T){o$T.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:o$T.once("loaded",this,this._onMeshLoaed)},o$T._onMeshLoaed=function(o$o,o$r){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},o$T._calculateBoundingSphereByInitSphere=function(o$o){var o$r=NaN,o$T=this._owner.transform,o$k=o$T.scale.elements,o$W=Math.abs(o$k[0]),o$D=Math.abs(o$k[1]),o$n=Math.abs(o$k[2]);o$r=o$D<=o$W&&o$n<=o$W?o$W:o$n<=o$D?o$D:o$n,o$nr.transformCoordinate(o$o.center,o$T.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=o$o.radius*o$r},o$T._calculateBoundBoxByInitCorners=function(o$o){for(var o$r=this._owner.transform.worldMatrix,o$T=0;o$T<8;o$T++)o$nr.transformCoordinate(o$o[o$T],o$r,o$Sr._tempBoundBoxCorners[o$T]);o$Qo.createfromPoints(o$Sr._tempBoundBoxCorners,this._boundingBox)},o$T._calculateBoundingSphere=function(){var o$o=this._owner.meshFilter.sharedMesh;null==o$o||null==o$o.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(o$o.boundingSphere)},o$T._calculateBoundingBox=function(){var o$o=this._owner.meshFilter.sharedMesh;null==o$o||null==o$o.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(o$o.boundingBoxCorners)},o$T._renderUpdate=function(o$o){var o$r=this._owner.transform;if(o$r){this._setShaderValueMatrix4x4(0,o$r.worldMatrix);var o$T=this._owner.getProjectionViewWorldMatrix(o$o);this._setShaderValueMatrix4x4(1,o$T)}else this._setShaderValueMatrix4x4(0,o$or.DEFAULT),this._setShaderValueMatrix4x4(1,o$o);return o$Kr.debugMode&&this._renderRenderableBoundBox(),!0},o$r}(),o$Cr=function(o$r){function o$k(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,o$k.__super.call(this),this._renderState=new o$Z,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new o$ir,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new o$ro,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new o$nr(.7,.7,.7),this.ambientColor=new o$nr(.212,.227,.259),o$u.shaderHighPrecision&&this.addShaderDefine(o$Fr.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}o$v(o$k,"laya.d3.core.scene.Scene",o$r);var o$o=o$k.prototype;return o$S.imps(o$o,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),o$o._setUrl=function(o$o){this._url=o$o},o$o._getGroup=function(){return this._group},o$o._setGroup=function(o$o){this._group=o$o},o$o._display=function(){o$S.stage._scenes.push(this),o$S.stage._scenes.sort(o$k._sortScenes);for(var o$o=0,o$r=this._childs.length;o$o<o$r;o$o++){var o$T=this._childs[o$o];o$T.active&&o$T._activeHierarchy()}},o$o._unDisplay=function(){var o$o=o$S.stage._scenes;o$o.splice(o$o.indexOf(this),1);for(var o$r=0,o$T=this._childs.length;o$r<o$T;o$r++){var o$k=this._childs[o$r];o$k.active&&o$k._inActiveHierarchy()}},o$o._addChild3D=function(o$o){o$o.transform._onWorldTransform(),o$o._setBelongScene(this),this.displayedInStage&&o$o.active&&o$o._activeHierarchy()},o$o._removeChild3D=function(o$o){o$o.transform.parent=null,this.displayedInStage&&o$o.active&&o$o._inActiveHierarchy(),o$o._setUnBelongScene()},o$o.initOctree=function(o$o,o$r,o$T,o$k,o$W){void 0===o$W&&(o$W=6),this.treeSize=new o$nr(o$o,o$r,o$T),this.treeLevel=o$W,this.treeRoot=new o$Q(this,0),this.treeRoot.init(o$k,this.treeSize)},o$o._prepareUpdateToRenderState=function(o$o,o$r){o$r.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,o$r.scene=this},o$o._prepareSceneToRender=function(o$o){var o$r=this._lights.length;if(0<o$r)for(var o$T=0,o$k=0;o$k<o$r&&!(this._lights[o$k]._prepareToScene(o$o)&&++o$T>=this._enableLightCount);o$k++);},o$o._updateChilds=function(o$o){for(var o$r=0,o$T=this._childs.length;o$r<o$T;++o$r)this._childs[o$r]._update(o$o)},o$o._preRenderScene=function(o$o,o$r,o$T){var o$k,o$W=o$r._viewMatrix,o$D=o$r._projectionMatrix,o$n=o$r._projectionViewMatrix,o$V=0,o$L=o$r.camera;for(o$L.useOcclusionCulling?this.treeRoot?o$To.renderObjectCullingOctree(o$T,this,o$L,o$W,o$D,o$n):o$To.renderObjectCulling(o$T,this,o$L,o$W,o$D,o$n):o$To.renderObjectCullingNoBoundFrustum(this,o$L,o$W,o$D,o$n),o$V=0,o$k=this._quenes.length;o$V<o$k;o$V++)this._quenes[o$V]&&this._quenes[o$V]._preRender(o$r)},o$o._clear=function(o$o,o$r){var o$T=o$r._viewport,o$k=o$r.camera,o$W=o$T.x,o$D=o$k.renderTargetSize.height-o$T.y-o$T.height,o$n=o$T.width,o$V=o$T.height;o$o.viewport(o$W,o$D,o$n,o$V);var o$L=256,o$U=o$k.renderTarget;switch(o$k.clearFlag){case 0:var o$h=o$k.clearColor;if(o$h){o$o.enable(3089),o$o.scissor(o$W,o$D,o$n,o$V);var o$p=o$h.elements;o$o.clearColor(o$p[0],o$p[1],o$p[2],o$p[3]),o$L|=16384}if(o$U)switch(o$h||(o$L=16384),o$U.depthStencilFormat){case 33189:o$L|=256;break;case 36168:o$L|=1024;break;case 34041:o$L|=256,o$L|=1024}o$o.clear(o$L),o$h&&o$o.disable(3089);break;case 1:case 2:if(o$U)switch(o$L=16384,o$U.depthStencilFormat){case 33189:o$L|=256;break;case 36168:o$L|=1024;break;case 34041:o$L|=256,o$L|=1024}o$o.clear(o$L);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},o$o._renderScene=function(o$o,o$r){var o$T,o$k,o$W=o$r.camera,o$D=0;for(o$D=0;o$D<2;o$D++)(o$k=this._quenes[o$D])&&(o$W.renderTarget?o$k._render(o$r,!0):o$k._render(o$r,!1));if(1===o$W.clearFlag){var o$n=o$W.sky;o$n&&(o$s.setCullFace(o$o,!1),o$s.setDepthFunc(o$o,515),o$s.setDepthMask(o$o,!1),o$n._render(o$r),o$s.setDepthFunc(o$o,513),o$s.setDepthMask(o$o,!0))}for(o$D=2,o$T=this._quenes.length;o$D<o$T;o$D++)(o$k=this._quenes[o$D])&&(o$k._sortAlpha(o$r.camera.transform.position),o$W.renderTarget?o$k._render(o$r,!0):o$k._render(o$r,!1))},o$o._set3DRenderConfig=function(o$o){o$o.disable(3042),o$s._blend=!1,o$o.blendFunc(770,771),o$s._sFactor=770,o$s._dFactor=771,o$o.disable(2929),o$s._depthTest=!1,o$o.enable(2884),o$s._cullFace=!0,o$o.depthMask(1),o$s._depthMask=!0,o$o.frontFace(2304),o$s._frontFace=2304},o$o._set2DRenderConfig=function(o$o){o$s.setBlend(o$o,!0),o$s.setBlendFunc(o$o,1,771),o$s.setDepthTest(o$o,!1),o$s.setCullFace(o$o,!1),o$s.setDepthMask(o$o,!0),o$s.setFrontFace(o$o,2305),o$o.viewport(0,0,o$h.width,o$h.height)},o$o._parseCustomProps=function(o$o,o$r,o$T,o$k){var o$W=o$k.customProps.lightmaps,o$D=o$W.length,o$n=this._lightmaps;o$n.length=o$D;for(var o$V=0;o$V<o$D;o$V++)o$n[o$V]=o$K.getRes(o$r[o$W[o$V].replace(".exr",".png")]);this.setlightmaps(o$n);var o$L=o$k.customProps.ambientColor;o$L&&(this.ambientColor=new o$nr(o$L[0],o$L[1],o$L[2]));var o$U=o$k.customProps.fogColor;o$U&&(this.fogColor=new o$nr(o$U[0],o$U[1],o$U[2]))},o$o._addLight=function(o$o){this._lights.indexOf(o$o)<0&&this._lights.push(o$o)},o$o._removeLight=function(o$o){var o$r=this._lights.indexOf(o$o);0<=o$r&&this._lights.splice(o$r,1)},o$o._updateScene=function(){var o$o=this._renderState;this._prepareUpdateToRenderState(o$u.mainContext,o$o),this._updateComponents(o$o),this._updateChilds(o$o),this._lateUpdateComponents(o$o),this._time+=o$o.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},o$o._updateSceneConch=function(){var o$o=this._renderState;this._prepareUpdateToRenderState(o$u.mainContext,o$o),this._updateComponents(o$o),this._lateUpdateComponents(o$o),this._prepareSceneToRender(o$o);for(var o$r=0,o$T=this._cameraPool.length;o$r<o$T;o$r++){var o$k=this._cameraPool[o$r];(o$o.camera=o$k)._prepareCameraToRender()}},o$o._preRenderShadow=function(o$o,o$r,o$T,o$k,o$W){this.treeRoot?o$To.renderShadowObjectCullingOctree(this,o$r,o$T,o$k,o$W):o$To.renderShadowObjectCulling(this,o$r,o$T,o$k,o$W);for(var o$D=0,o$n=o$T.length;o$D<o$n;o$D++)o$T[o$D]&&o$T[o$D]._preRender(o$o)},o$o._renderShadowMap=function(o$o,o$r,o$T){var o$k=this.parallelSplitShadowMaps[0];o$k._calcAllLightCameraInfo(o$T);var o$W,o$D,o$n,o$V=o$k.PSSMNum;if(this._preRenderShadow(o$r,o$k._lightCulling,o$k._shadowQuenes,o$k._lightVPMatrix[0],o$V),this.addShaderDefine(o$vr.SHADERDEFINE_CAST_SHADOW),1<o$V)for(var o$L=0;o$L<o$V;o$L++)o$W=o$k.getRenderTarget(o$L+1),o$k.beginRenderTarget(o$L+1),o$o.clearColor(1,1,1,1),o$o.clear(16640),o$o.viewport(0,0,o$W.width,o$W.height),o$r.camera=o$n=o$k.getLightCamera(o$L),o$n._prepareCameraToRender(),o$n._prepareCameraViewProject(o$n.viewMatrix,o$n.projectionMatrix),o$r._projectionViewMatrix=o$k._lightVPMatrix[o$L+1],(o$D=o$k._shadowQuenes[o$L])._preRender(o$r),o$D._renderShadow(o$r,!1),o$k.endRenderTarget(o$L+1);else o$W=o$k.getRenderTarget(1),o$k.beginRenderTarget(1),o$o.clearColor(1,1,1,1),o$o.clear(16640),o$o.viewport(0,0,o$W.width,o$W.height),o$r.camera=o$n=o$k.getLightCamera(0),o$n._prepareCameraToRender(),o$n._prepareCameraViewProject(o$n.viewMatrix,o$n.projectionMatrix),o$r._projectionViewMatrix=o$k._lightVPMatrix[0],(o$D=o$k._shadowQuenes[0])._preRender(o$r),o$D._renderShadow(o$r,!0),o$k.endRenderTarget(1);this.removeShaderDefine(o$vr.SHADERDEFINE_CAST_SHADOW)},o$o.addTreeNode=function(o$o){this.treeRoot.addTreeNode(o$o)},o$o.removeTreeNode=function(o$o){this.treeSize&&o$o._treeNode&&o$o._treeNode.removeObject(o$o)},o$o.setlightmaps=function(o$o){this._lightmaps=o$o;for(var o$r=0,o$T=this._renderableSprite3Ds.length;o$r<o$T;o$r++)this._renderableSprite3Ds[o$r]._render._applyLightMapParams()},o$o.getlightmaps=function(){return this._lightmaps},o$o.addChildAt=function(o$o,o$r){if(!(o$o instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(o$o&&o$o.__className));if(!o$o||this.destroyed||o$o===this)return o$o;if(o$o.zOrder&&this._set$P("hasZorder",!0),0<=o$r&&o$r<=this._childs.length){if(o$o._parent===this){var o$T=this.getChildIndex(o$o);this._childs.splice(o$T,1),this._childs.splice(o$r,0,o$o),this.conchModel&&(this.conchModel.removeChild(o$o.conchModel),this.conchModel.addChildAt(o$o.conchModel,o$r)),this._childChanged()}else o$o.parent&&o$o.parent.removeChild(o$o),this._childs===o$U.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(o$r,0,o$o),this.conchModel&&this.conchModel.addChildAt(o$o.conchModel,o$r),(o$o.parent=this)._addChild3D(o$o);return o$o}throw new Error("appendChildAt:The index is out of bounds")},o$o.addChild=function(o$o){if(!(o$o instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!o$o||this.destroyed||o$o===this)return o$o;if(o$o.zOrder&&this._set$P("hasZorder",!0),o$o._parent===this){var o$r=this.getChildIndex(o$o);o$r!==this._childs.length-1&&(this._childs.splice(o$r,1),this._childs.push(o$o),this.conchModel&&(this.conchModel.removeChild(o$o.conchModel),this.conchModel.addChildAt(o$o.conchModel,this._childs.length-1)),this._childChanged())}else o$o.parent&&o$o.parent.removeChild(o$o),this._childs===o$U.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(o$o),this.conchModel&&this.conchModel.addChildAt(o$o.conchModel,this._childs.length-1),(o$o.parent=this)._childChanged(),this._addChild3D(o$o);return o$o},o$o.removeChildAt=function(o$o){var o$r=this.getChildAt(o$o);return o$r&&(this._removeChild3D(o$r),this._childs.splice(o$o,1),this.conchModel&&this.conchModel.removeChild(o$r.conchModel),o$r.parent=null),o$r},o$o.removeChildren=function(o$o,o$r){if(void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=2147483647),this._childs&&0<this._childs.length){var o$T=this._childs;if(0===o$o&&o$D<=o$r){var o$k=o$T;this._childs=o$U.ARRAY_EMPTY}else o$k=o$T.splice(o$o,o$r-o$o);for(var o$W=0,o$D=o$k.length;o$W<o$D;o$W++)this._removeChild3D(o$k[o$W]),o$k[o$W].parent=null,this.conchModel&&this.conchModel.removeChild(o$k[o$W].conchModel)}return this},o$o.addFrustumCullingObject=function(o$o){this.treeRoot?this.addTreeNode(o$o):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(o$o):this._cullingRenders[this._cullingRendersLength]=o$o,o$o._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},o$o.removeFrustumCullingObject=function(o$o){if(this.treeRoot)this.removeTreeNode(o$o);else{this._cullingRendersLength--;var o$r=o$o._indexInSceneFrustumCullingObjects;if(o$r!==this._cullingRendersLength){var o$T=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[o$r]=o$T)._indexInSceneFrustumCullingObjects=o$r,o$o._indexInSceneFrustumCullingObjects=-1}}},o$o.getRenderQueue=function(o$o){return o$o<3e3?this._quenes[1]||(this._quenes[1]=new o$w(this)):this._quenes[2]||(this._quenes[2]=new o$w(this))},o$o.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new o$w(this)},o$o.addShaderDefine=function(o$o){this._shaderDefineValue|=o$o},o$o.removeShaderDefine=function(o$o){this._shaderDefineValue&=~o$o},o$o.addScript=function(o$o){return this._addComponent(o$o)},o$o.getScriptByType=function(o$o,o$r){return void 0===o$r&&(o$r=0),this._getComponentByType(o$o,o$r)},o$o.getScriptsByType=function(o$o,o$r){this._getComponentsByType(o$o,o$r)},o$o.getScriptByIndex=function(o$o){return this._getComponentByIndex(o$o)},o$o.removeScriptByType=function(o$o,o$r){void 0===o$r&&(o$r=0),this._removeComponentByType(o$o,o$r)},o$o.removeScriptsByType=function(o$o){this._removeComponentByType(o$o)},o$o.removeAllScript=function(){this._removeAllComponent()},o$o.render=function(o$o,o$r,o$T){(o$j._context.ctx._renderKey=0)<this._childs.length&&o$o.addRenderObject(this)},o$o.renderSubmit=function(){var o$o=o$u.mainContext,o$r=this._renderState;this._set3DRenderConfig(o$o),this._prepareSceneToRender(this._renderState);var o$T,o$k=0,o$W=0;if(o$Kr.debugMode||o$Q.debugMode)for(o$k=0,o$W=this._cameraPool.length;o$k<o$W;o$k++)o$T=this._cameraPool[o$k],o$Kr._debugPhasorSprite.begin(1,o$T),o$T.activeInHierarchy&&o$T._renderCamera(o$o,o$r,this),o$Kr._debugPhasorSprite.end();else for(o$k=0,o$W=this._cameraPool.length;o$k<o$W;o$k++)(o$T=this._cameraPool[o$k]).activeInHierarchy&&o$T._renderCamera(o$o,o$r,this);return this._set2DRenderConfig(o$o),1},o$o.onAsynLoaded=function(o$o,o$r,o$T){var o$k=o$r[0];if("Scene"!==o$k.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var o$W=o$r[1];o$_r._createNodeByJson(this,o$k,this,o$W),this.event("hierarchyloaded",[this]),this.__loaded=!0},o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),this.destroyed||(o$r.prototype.destroy.call(this,o$o),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,o$K.clearRes(this.url),this.loaded||o$Kr._cancelLoadByUrl(this.url))},o$o.getRenderType=function(){return 0},o$o.releaseRender=function(){},o$o._addComponent=function(o$o){var o$r,o$T=this._componentsMap.indexOf(o$o);if(-1===o$T)o$r=[],this._componentsMap.push(o$o),this._typeComponentsIndices.push(o$r);else if(o$r=this._typeComponentsIndices[o$T],this._components[o$r[0]].isSingleton)throw new Error("无法单实例创建"+o$o+"组件，"+o$o+"组件已存在！");var o$k=o$W.getInstance(o$o);o$r.push(this._components.length),this._components.push(o$k);return o$k._initialize(this),o$k},o$o._removeComponent=function(o$o,o$r){var o$T=this._typeComponentsIndices[o$o],o$k=o$T[o$r],o$W=this._components[o$k];this._components.splice(o$k,1),o$T.splice(o$r,1),0===o$T.length&&(this._typeComponentsIndices.splice(o$o,1),this._componentsMap.splice(o$o,1));for(var o$D=0,o$n=this._componentsMap.length;o$D<o$n;o$D++)for(var o$V=(o$T=this._typeComponentsIndices[o$D]).length-1;0<=o$V;o$V--){var o$L=o$T[o$V];if(!(o$k<o$L))break;o$T[o$V]=--o$L}o$W._destroy()},o$o._getComponentByType=function(o$o,o$r){void 0===o$r&&(o$r=0);var o$T=this._componentsMap.indexOf(o$o);return-1===o$T?null:this._components[this._typeComponentsIndices[o$T][o$r]]},o$o._getComponentsByType=function(o$o,o$r){var o$T=this._componentsMap.indexOf(o$o);if(-1!==o$T){var o$k=this._typeComponentsIndices[o$T],o$W=o$k.length;o$r.length=o$W;for(var o$D=0;o$D<o$W;o$D++)o$r[o$D]=this._components[o$k[o$D]]}else o$r.length=0},o$o._getComponentByIndex=function(o$o){return this._components[o$o]},o$o._removeComponentByType=function(o$o,o$r){void 0===o$r&&(o$r=0);var o$T=this._componentsMap.indexOf(o$o);-1!==o$T&&this._removeComponent(o$T,o$r)},o$o._removeComponentsByType=function(o$o){var o$r=this._componentsMap.indexOf(o$o);if(-1!==o$r)for(var o$T=this._typeComponentsIndices[o$r],o$k=0,o$W=o$T.length;o$k<o$W;o$T.length<o$W?o$W--:o$k++)this._removeComponent(o$r,o$k)},o$o._removeAllComponent=function(){for(var o$o=0,o$r=this._componentsMap.length;o$o<o$r;this._componentsMap.length<o$r?o$r--:o$o++)this._removeComponentsByType(this._componentsMap[o$o])},o$o._updateComponents=function(o$o){for(var o$r=0,o$T=this._components.length;o$r<o$T;o$r++){var o$k=this._components[o$r];!o$k.started&&(o$k._start(o$o),o$k.started=!0),o$k.enable&&o$k._update(o$o)}},o$o._lateUpdateComponents=function(o$o){for(var o$r=0;o$r<this._components.length;o$r++){var o$T=this._components[o$r];!o$T.started&&(o$T._start(o$o),o$T.started=!0),o$T.enable&&o$T._lateUpdate(o$o)}},o$o._preRenderUpdateComponents=function(o$o){for(var o$r=0;o$r<this._components.length;o$r++){var o$T=this._components[o$r];!o$T.started&&(o$T._start(o$o),o$T.started=!0),o$T.enable&&o$T._preRenderUpdate(o$o)}},o$o._postRenderUpdateComponents=function(o$o){for(var o$r=0;o$r<this._components.length;o$r++){var o$T=this._components[o$r];!o$T.started&&(o$T._start(o$o),o$T.started=!0),o$T.enable&&o$T._postRenderUpdate(o$o)}},o$x(0,o$o,"_loaded",null,function(o$o){this.__loaded=o$o}),o$x(0,o$o,"fogColor",function(){return this._fogColor},function(o$o){this._fogColor=o$o,this._shaderValues.setValue(0,o$o.elements)}),o$x(0,o$o,"enableFog",function(){return this._enableFog},function(o$o){this._enableFog!==o$o&&((this._enableFog=o$o)?(this.addShaderDefine(o$Fr.SHADERDEFINE_FOG),this.removeShaderDefine(o$Fr.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(o$Fr.SHADERDEFINE_FOG))}),o$x(0,o$o,"url",function(){return this._url}),o$x(0,o$o,"loaded",function(){return this.__loaded}),o$x(0,o$o,"enableDepthFog",function(){return this._enableDepthFog},function(o$o){this._enableDepthFog!=o$o&&((this._enableDepthFog=o$o)?(this.addShaderDefine(o$Fr.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(o$Fr.SHADERDEFINE_FOG)):this.removeShaderDefine(o$Fr.SAHDERDEFINE_DEPTHFOG))}),o$x(0,o$o,"fogStart",function(){return this._fogStart},function(o$o){this._fogStart=o$o,this._shaderValues.setValue(1,o$o)}),o$x(0,o$o,"fogRange",function(){return this._fogRange},function(o$o){this._fogRange=o$o,this._shaderValues.setValue(2,o$o)}),o$x(0,o$o,"ambientColor",function(){return this._ambientColor},function(o$o){this._ambientColor=o$o,this._shaderValues.setValue(21,o$o.elements)}),o$x(0,o$o,"scene",function(){return this}),o$x(0,o$o,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),o$k._sortScenes=function(o$o,o$r){if(o$o.parent!==o$S.stage||o$r.parent!==o$S.stage)return o$o.parent!==o$S.stage&&o$r.parent!==o$S.stage?o$k._sortScenes(o$o.parent,o$r.parent):o$o.parent===o$S.stage?-1:1;var o$T=o$S.stage._childs;return o$T.indexOf(o$o)-o$T.indexOf(o$r)},o$k.load=function(o$o){return o$S.loader.create(o$o,null,null,o$k)},o$k.FOGCOLOR=0,o$k.FOGSTART=1,o$k.FOGRANGE=2,o$k.LIGHTDIRECTION=3,o$k.LIGHTDIRCOLOR=4,o$k.POINTLIGHTPOS=5,o$k.POINTLIGHTRANGE=6,o$k.POINTLIGHTATTENUATION=7,o$k.POINTLIGHTCOLOR=8,o$k.SPOTLIGHTPOS=9,o$k.SPOTLIGHTDIRECTION=10,o$k.SPOTLIGHTSPOT=11,o$k.SPOTLIGHTRANGE=12,o$k.SPOTLIGHTATTENUATION=13,o$k.SPOTLIGHTCOLOR=14,o$k.SHADOWDISTANCE=15,o$k.SHADOWLIGHTVIEWPROJECT=16,o$k.SHADOWMAPPCFOFFSET=17,o$k.SHADOWMAPTEXTURE1=18,o$k.SHADOWMAPTEXTURE2=19,o$k.SHADOWMAPTEXTURE3=20,o$k.AMBIENTCOLOR=21,o$k.TIME=22,o$k}(o$b),o$Xr=function(o$o){function o$r(o$o){o$r.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new o$or,this._shaderValues=new o$ir,this._colliders=[],this._id=++o$r._uniqueIDCounter,this._transform=new o$qr(this),this.name=o$o||"Sprite3D-"+o$r._nameNumberCounter++,this.layer=o$m.currentCreationLayer,this.active=!0}o$v(o$r,"laya.d3.core.Sprite3D",o$Hr);var o$T=o$r.prototype;return o$S.imps(o$T,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),o$T._setUrl=function(o$o){this._url=o$o},o$T._getGroup=function(){return this._group},o$T._setGroup=function(o$o){this._group=o$o},o$T._addChild3D=function(o$o){o$o.transform.parent=this.transform,this._hierarchyAnimator&&(!o$o._hierarchyAnimator&&o$o._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(o$o,!0,[o$o.name])),this._scene&&(o$o._setBelongScene(this._scene),this._activeInHierarchy&&o$o._active&&o$o._activeHierarchy())},o$T._removeChild3D=function(o$o){o$o.transform.parent=null,this._scene&&(this._activeInHierarchy&&o$o._active&&o$o._inActiveHierarchy(),o$o._setUnBelongScene()),this._hierarchyAnimator&&(o$o._hierarchyAnimator==this._hierarchyAnimator&&o$o._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(o$o,!1,[o$o.name]))},o$T._parseBaseCustomProps=function(o$o){var o$r=this.transform.localPosition;o$o.translate?(o$r.fromArray(o$o.translate),o$r.x*=100,o$r.y*=100,o$r.z*=100):o$r.elements.fill(0),this.transform.localPosition=o$r;var o$T=this.transform.localRotation;o$o.rotation?o$T.fromArray(o$o.rotation):o$T.fromArray([0,0,0,-1]),this.transform.localRotation=o$T;var o$k=this.transform.localScale;o$o.scale?o$k.fromArray(o$o.scale):o$k.elements.fill(1),this.transform.localScale=o$k;var o$W=o$o.layer;null!=o$W&&(this.layer=o$m.getLayerByNumber(o$W))},o$T._parseCustomComponent=function(o$o,o$r,o$T){for(var o$k in o$T){var o$W=o$T[o$k];switch(o$k){case"Animator":var o$D=this.addComponent(Animator);if(o$W.avatarPath)o$D.avatar=o$K.getRes(o$r[o$W.avatarPath]);else{var o$n=o$W.avatar;if(o$n){o$D.avatar=o$K.getRes(o$r[o$n.path]);var o$V=o$n.linkSprites;o$V&&o$o.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[o$D,o$V])}}for(var o$L=o$W.clipPaths,o$U=o$L.length,o$h=0;o$h<o$U;o$h++)o$D.addClip(o$K.getRes(o$r[o$L[o$h]]));o$D.clip=o$K.getRes(o$r[o$L[0]]);var o$p=o$W.playOnWake;void 0!==o$p&&(o$D.playOnWake=o$p);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var o$i=this.addComponent(SphereCollider);o$i.isTrigger=o$W.isTrigger;var o$v=o$i.center;o$v.fromArray(o$W.center),o$i.center=o$v,o$i.radius=o$W.radius;break;case"BoxCollider":var o$x=this.addComponent(BoxCollider);o$x.isTrigger=o$W.isTrigger,o$x.center.fromArray(o$W.center);var o$j=o$x.size;o$j.fromArray(o$W.size),o$x.size=o$j;break;case"MeshCollider":this.addComponent(MeshCollider)}}},o$T._onRootNodeHierarchyLoaded=function(o$o,o$r){for(var o$T in o$r){for(var o$k=this,o$W=o$r[o$T],o$D=0,o$n=o$W.length;o$D<o$n;o$D++){var o$V=o$W[o$D];if(""===o$V)break;if(!(o$k=o$k.getChildByName(o$V)))break}o$k&&o$o.linkSprite3DToAvatarNode(o$T,o$k)}},o$T._setHierarchyAnimator=function(o$o,o$r){this._changeHierarchyAnimator(o$o);for(var o$T=0,o$k=this._childs.length;o$T<o$k;o$T++){var o$W=this._childs[o$T];o$W._hierarchyAnimator==o$r&&o$W._setHierarchyAnimator(o$o,o$r)}},o$T._clearHierarchyAnimator=function(o$o,o$r){this._changeHierarchyAnimator(o$r);for(var o$T=0,o$k=this._childs.length;o$T<o$k;o$T++){var o$W=this._childs[o$T];o$W._hierarchyAnimator==o$o&&o$W._clearHierarchyAnimator(o$o,o$r)}},o$T._getAnimatorToLinkSprite3D=function(o$o,o$r,o$T){var o$k=this.getComponentByType(Animator);if(o$k&&(o$k.avatar?o$k.avatar._version||o$o._setAnimatorToLinkAvatar(o$k,o$r):o$o._setAnimatorToLinkSprite3DNoAvatar(o$k,o$r,o$T)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){o$T.unshift(this._parent.name);var o$W=this._parent;o$W._hierarchyAnimator&&o$W._getAnimatorToLinkSprite3D(o$o,o$r,o$T)}},o$T._setAnimatorToLinkSprite3DNoAvatar=function(o$o,o$r,o$T){var o$k=0,o$W=0;for(o$k=0,o$W=o$o.getClipCount();o$k<o$W;o$k++)o$o._handleSpriteOwnersBySprite(o$k,o$r,o$T,this);for(o$k=0,o$W=this._childs.length;o$k<o$W;o$k++){var o$D=this._childs[o$k],o$n=o$T.length;o$T.push(o$D.name),o$D._setAnimatorToLinkSprite3DNoAvatar(o$o,o$r,o$T),o$T.splice(o$n,1)}},o$T._changeHierarchyAnimator=function(o$o){this._hierarchyAnimator=o$o},o$T._isLinkSpriteToAnimationNode=function(o$o,o$r,o$T){var o$k=o$o._avatarNodes.indexOf(o$r),o$W=o$o._cacheSpriteToNodesMap;if(o$T)this._transform.dummy=o$r.transform,o$o._cacheNodesToSpriteMap[o$k]=o$W.length,o$W.push(o$k);else{this._transform.dummy=null;var o$D=o$o._cacheNodesToSpriteMap[o$k];o$o._cacheNodesToSpriteMap[o$k]=null,o$W.splice(o$D,1)}},o$T._setBelongScene=function(o$o){this._scene=o$o;for(var o$r=0,o$T=this._childs.length;o$r<o$T;o$r++)this._childs[o$r]._setBelongScene(o$o)},o$T._setUnBelongScene=function(){this._scene=null;for(var o$o=0,o$r=this._childs.length;o$o<o$r;o$o++)this._childs[o$o]._setUnBelongScene()},o$T._activeHierarchy=function(){var o$o=0,o$r=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),o$o=0,o$r=this._colliders.length;o$o<o$r;o$o++)this._layer._addCollider(this._colliders[o$o]);for(this.event("activeinhierarchychanged",!0),o$o=0,o$r=this._childs.length;o$o<o$r;o$o++){var o$T=this._childs[o$o];o$T._active&&o$T._activeHierarchy()}},o$T._inActiveHierarchy=function(){var o$o=0,o$r=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),o$o=0,o$r=this._colliders.length;o$o<o$r;o$o++){var o$T=this._colliders[o$o];o$T._clearCollsionMap(),this._layer._removeCollider(o$T)}for(this.event("activeinhierarchychanged",!1),o$o=0,o$r=this._childs.length;o$o<o$r;o$o++){var o$k=this._childs[o$o];o$k._active&&o$k._inActiveHierarchy()}},o$T.addComponent=function(o$o){var o$r,o$T=this._componentsMap.indexOf(o$o);if(-1===o$T)o$r=[],this._componentsMap.push(o$o),this._typeComponentsIndices.push(o$r);else if(o$r=this._typeComponentsIndices[o$T],this._components[o$r[0]].isSingleton)throw new Error("无法单实例创建"+o$o+"组件，"+o$o+"组件已存在！");var o$k=o$W.getInstance(o$o);return o$r.push(this._components.length),this._components.push(o$k),o$k instanceof laya.d3.component.Script&&this._scripts.push(o$k),o$k._initialize(this),o$k},o$T._removeComponent=function(o$o,o$r){var o$T,o$k=0,o$W=this._typeComponentsIndices[o$o],o$D=o$W[o$r],o$n=this._components[o$D];for(o$n instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(o$n),1),o$W.splice(o$r,1),0===o$W.length&&(this._typeComponentsIndices.splice(o$o,1),this._componentsMap.splice(o$o,1)),o$k=0,o$T=this._componentsMap.length;o$k<o$T;o$k++)for(var o$V=(o$W=this._typeComponentsIndices[o$k]).length-1;0<=o$V;o$V--){var o$L=o$W[o$V];if(!(o$D<o$L))break;o$W[o$V]=--o$L}o$n._destroy()},o$T._clearSelfRenderObjects=function(){},o$T._addSelfRenderObjects=function(){},o$T._parseCustomProps=function(o$o,o$r,o$T,o$k){},o$T._updateChilds=function(o$o){var o$r=this._childs.length;if(0!==o$r)for(var o$T=0;o$T<o$r;++o$T)this._childs[o$T]._update(o$o)},o$T._getSortID=function(o$o,o$r){return 1e3*o$r.id+o$o._getVertexBuffer().vertexDeclaration.id},o$T._update=function(o$o){(o$o.owner=this)._activeInHierarchy&&(this._updateComponents(o$o),this._lateUpdateComponents(o$o),o$F.spriteCount++,this._childs.length&&this._updateChilds(o$o))},o$T.getProjectionViewWorldMatrix=function(o$o){return o$or.multiply(o$o,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},o$T.loadHierarchy=function(o$o){this.addChild(laya.d3.core.Sprite3D.load(o$o))},o$T.addChildAt=function(o$o,o$r){if(!(o$o instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!o$o||this.destroyed||o$o===this)return o$o;if(o$o.zOrder&&this._set$P("hasZorder",!0),0<=o$r&&o$r<=this._childs.length){if(o$o._parent===this){var o$T=this.getChildIndex(o$o);this._childs.splice(o$T,1),this._childs.splice(o$r,0,o$o),this.conchModel&&(this.conchModel.removeChild(o$o.conchModel),this.conchModel.addChildAt(o$o.conchModel,o$r)),this._childChanged()}else o$o.parent&&o$o.parent.removeChild(o$o),this._childs===o$U.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(o$r,0,o$o),this.conchModel&&this.conchModel.addChildAt(o$o.conchModel,o$r),(o$o.parent=this)._addChild3D(o$o);return o$o}throw new Error("appendChildAt:The index is out of bounds")},o$T.addChild=function(o$o){if(!(o$o instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!o$o||this.destroyed||o$o===this)return o$o;if(o$o.zOrder&&this._set$P("hasZorder",!0),o$o._parent===this){var o$r=this.getChildIndex(o$o);o$r!==this._childs.length-1&&(this._childs.splice(o$r,1),this._childs.push(o$o),this.conchModel&&(this.conchModel.removeChild(o$o.conchModel),this.conchModel.addChildAt(o$o.conchModel,this._childs.length-1)),this._childChanged())}else o$o.parent&&o$o.parent.removeChild(o$o),this._childs===o$U.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(o$o),this.conchModel&&this.conchModel.addChildAt(o$o.conchModel,this._childs.length-1),(o$o.parent=this)._childChanged(),this._addChild3D(o$o);return o$o},o$T.removeChildAt=function(o$o){var o$r=this.getChildAt(o$o);return o$r&&(this._removeChild3D(o$r),this._childs.splice(o$o,1),this.conchModel&&this.conchModel.removeChild(o$r.conchModel),o$r.parent=null),o$r},o$T.removeChildren=function(o$o,o$r){if(void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=2147483647),this._childs&&0<this._childs.length){var o$T=this._childs;if(0===o$o&&o$D<=o$r){var o$k=o$T;this._childs=o$U.ARRAY_EMPTY}else o$k=o$T.splice(o$o,o$r-o$o);for(var o$W=0,o$D=o$k.length;o$W<o$D;o$W++)this._removeChild3D(o$k[o$W]),o$k[o$W].parent=null,this.conchModel&&this.conchModel.removeChild(o$k[o$W].conchModel)}return this},o$T.onAsynLoaded=function(o$o,o$r,o$T){var o$k=o$r[0];if("Sprite3D"!==o$k.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var o$W=o$r[1];o$_r._createNodeByJson(this,o$k,this,o$W),this.event("hierarchyloaded",[this]),this.__loaded=!0},o$T.cloneTo=function(o$o){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var o$r=o$o;o$r.name=this.name,o$r._destroyed=this._destroyed,o$r.timer=this.timer,o$r._$P=this._$P,o$r.active=this._active;var o$T=o$r.transform.localPosition;this.transform.localPosition.cloneTo(o$T),o$r.transform.localPosition=o$T;var o$k=o$r.transform.localRotation;this.transform.localRotation.cloneTo(o$k),o$r.transform.localRotation=o$k;var o$W=o$r.transform.localScale;this.transform.localScale.cloneTo(o$W),o$r.transform.localScale=o$W,o$r.isStatic=this.isStatic;var o$D=0,o$n=0;for(o$D=0,o$n=this._componentsMap.length;o$D<o$n;o$D++){var o$V=o$r.addComponent(this._componentsMap[o$D]);this._components[o$D]._cloneTo(o$V)}for(o$D=0,o$n=this._childs.length;o$D<o$n;o$D++)o$r.addChild(this._childs[o$D].clone());var o$L=o$r.getComponentByType(Animator);if(o$L){var o$U=o$L._linkSpritesData;if(o$U)for(var o$h in o$U){for(var o$p=o$U[o$h],o$i=o$r,o$v=0,o$x=o$p.length;o$v<o$x&&(o$i=o$i.getChildByName(o$p[o$v]));o$v++);if(o$i){var o$j=o$L._avatarNodeMap[o$h];o$i._isLinkSpriteToAnimationNode(o$L,o$j,!0)}}}},o$T.clone=function(){var o$o=new this.constructor;return this.cloneTo(o$o),o$o},o$T.destroy=function(o$o){if(void 0===o$o&&(o$o=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,o$o);var o$r,o$T=0;for(o$T=0,o$r=this._components.length;o$T<o$r;o$T++)this._components[o$T]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,o$K.clearRes(this.url),this.loaded||o$Kr._cancelLoadByUrl(this.url)}},o$T._handleSpriteToAvatar=function(o$o,o$r){o$o._avatarNodes;var o$T=o$o._avatarNodeMap[this.name];o$T&&o$T.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(o$o,o$T,o$r)},o$T._setAnimatorToLinkAvatar=function(o$o,o$r){this._handleSpriteToAvatar(o$o,o$r);for(var o$T=0,o$k=this._childs.length;o$T<o$k;o$T++){this._childs[o$T]._setAnimatorToLinkAvatar(o$o,o$r)}},o$x(0,o$T,"activeInHierarchy",function(){return this._activeInHierarchy}),o$x(0,o$T,"_loaded",null,function(o$o){this.__loaded=o$o}),o$x(0,o$T,"active",function(){return this._active},function(o$o){this._active!==o$o&&(this._active=o$o,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(o$o?this._activeHierarchy():this._inActiveHierarchy()))}),o$x(0,o$T,"componentsCount",function(){return this._components.length}),o$x(0,o$T,"loaded",function(){return this.__loaded}),o$x(0,o$T,"id",function(){return this._id}),o$x(0,o$T,"url",function(){return this._url}),o$x(0,o$T,"layer",function(){return this._layer},function(o$o){if(this._layer!==o$o){if(!o$o)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var o$r=0,o$T=this._colliders.length;if(this._layer)for(o$r=0;o$r<o$T;o$r++)this._layer._removeCollider(this._colliders[o$r]);for(o$r=0;o$r<o$T;o$r++)o$o._addCollider(this._colliders[o$r])}this._layer=o$o,this.event("layerchanged",o$o)}}),o$x(0,o$T,"scene",function(){return this._scene}),o$x(0,o$T,"transform",function(){return this._transform}),o$r.instantiate=function(o$o,o$r,o$T,o$k,o$W){void 0===o$T&&(o$T=!0);var o$D=o$o.clone();o$r&&o$r.addChild(o$D);var o$n=o$D.transform;if(o$T){var o$V=o$n.worldMatrix;o$o.transform.worldMatrix.cloneTo(o$V),o$n.worldMatrix=o$V}else o$k&&(o$n.position=o$k),o$W&&(o$n.rotation=o$W);return o$D},o$r.load=function(o$o){return o$S.loader.create(o$o,null,null,o$r)},o$r.WORLDMATRIX=0,o$r.MVPMATRIX=1,o$r._uniqueIDCounter=0,o$r._nameNumberCounter=0,o$r}(),o$Or=function(o$o){function o$h(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],o$h.__super.call(this),!o$o||!o$r)throw"Shader Error";this._id=++o$h._count,this._vs=o$o,this._ps=o$r,this._attributeMap=o$T,this._sceneUniformMap=o$k,this._cameraUniformMap=o$W,this._spriteUniformMap=o$D,this._materialUniformMap=o$n,this._renderElementUniformMap=o$V,this._precompile=o$L,this._define=o$U,this._precompile&&o$h.extCompileObj&&o$h.extCompileFunc?o$h.extCompileFunc.call(o$h.extCompileObj,o$o,o$r,o$U):this.recreateResource()}o$v(o$h,"laya.d3.shader.Shader3D",o$T);var o$r=o$h.prototype;return o$r.recreateResource=function(){o$z.now();this._compile(),this.completeCreate(),this.memorySize=0},o$r.disposeResource=function(){o$u.mainContext.deleteShader(this._vshader),o$u.mainContext.deleteShader(this._pshader),o$u.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},o$r._compile=function(){if(!o$u.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var o$o=[this._vs,this._ps],o$r=o$u.mainContext;if(this._program=o$r.createProgram(),this._vshader=o$h._createShader(o$r,o$o[0],35633),this._pshader=o$h._createShader(o$r,o$o[1],35632),o$r.attachShader(this._program,this._vshader),o$r.attachShader(this._program,this._pshader),o$r.linkProgram(this._program),!o$j.isConchApp&&o$Fr.debugMode&&!o$r.getProgramParameter(this._program,35714))throw o$r.getProgramInfoLog(this._program);var o$T,o$k=0,o$W=0,o$D=0;for(o$D=o$j.isConchApp?o$r.getProgramParameterEx(this._vs,this._ps,"",35721):o$r.getProgramParameter(this._program,35721),o$k=0;o$k<o$D;o$k++){var o$n=null;o$T={vartype:"attribute",ivartype:0,attrib:o$n=o$j.isConchApp?o$r.getActiveAttribEx(this._vs,this._ps,"",o$k):o$r.getActiveAttrib(this._program,o$k),location:o$r.getAttribLocation(this._program,o$n.name),name:o$n.name,type:o$n.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(o$T)}var o$V=0;for(o$V=o$j.isConchApp?o$r.getProgramParameterEx(this._vs,this._ps,"",35718):o$r.getProgramParameter(this._program,35718),o$k=0;o$k<o$V;o$k++){var o$L=null;o$L=o$j.isConchApp?o$r.getActiveUniformEx(this._vs,this._ps,"",o$k):o$r.getActiveUniform(this._program,o$k),0<(o$T={vartype:"uniform",ivartype:1,attrib:o$n,location:o$r.getUniformLocation(this._program,o$L.name),name:o$L.name,type:o$L.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(o$T.name=o$T.name.substr(0,o$T.name.length-3),o$T.isArray=!0,o$T.location=o$r.getUniformLocation(this._program,o$T.name)),this._uniformParams.push(o$T)}for(o$k=0,o$W=this._attributeParams.length;o$k<o$W;o$k++)(o$T=this._attributeParams[o$k]).indexOfParams=o$k,o$T.index=1,o$T.value=[o$T.location,null],o$T.codename=o$T.name,o$T.name=null!=this._attributeMap[o$T.codename]?this._attributeMap[o$T.codename]:o$T.codename,this._attributeParamsMap.push(o$T.name),this._attributeParamsMap.push(o$T),o$T._this=this,o$T.uploadedValue=[],o$T.fun=this._attribute;for(o$k=0,o$W=this._uniformParams.length;o$k<o$W;o$k++)switch((o$T=this._uniformParams[o$k]).indexOfParams=o$k,o$T.index=1,o$T.value=[o$T.location,null],o$T.codename=o$T.name,null!=this._sceneUniformMap[o$T.codename]?(o$T.name=this._sceneUniformMap[o$T.codename],this._sceneUniformParamsMap.push(o$T.name),this._sceneUniformParamsMap.push(o$T)):null!=this._cameraUniformMap[o$T.codename]?(o$T.name=this._cameraUniformMap[o$T.codename],this._cameraUniformParamsMap.push(o$T.name),this._cameraUniformParamsMap.push(o$T)):null!=this._spriteUniformMap[o$T.codename]?(o$T.name=this._spriteUniformMap[o$T.codename],this._spriteUniformParamsMap.push(o$T.name),this._spriteUniformParamsMap.push(o$T)):null!=this._materialUniformMap[o$T.codename]?(o$T.name=this._materialUniformMap[o$T.codename],this._materialUniformParamsMap.push(o$T.name),this._materialUniformParamsMap.push(o$T)):null!=this._renderElementUniformMap[o$T.codename]?(o$T.name=this._renderElementUniformMap[o$T.codename],this._renderElementUniformParamsMap.push(o$T.name),this._renderElementUniformParamsMap.push(o$T)):console.log("Shader:can't find uinform name:"+o$T.codename+" in shader file."),o$T._this=this,o$T.uploadedValue=[],o$T.type){case 5124:o$T.fun=o$T.isArray?this._uniform1iv:this._uniform1i;break;case 5126:o$T.fun=o$T.isArray?this._uniform1fv:this._uniform1f;break;case 35664:o$T.fun=o$T.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:o$T.fun=o$T.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:o$T.fun=o$T.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:o$T.fun=this._uniform_sampler2D;break;case 35680:o$T.fun=this._uniform_samplerCube;break;case 35676:o$T.fun=this._uniformMatrix4fv;break;case 35670:o$T.fun=this._uniform1i;break;case 35674:o$T.fun=this._uinformMatrix2fv;break;case 35675:o$T.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},o$r._attribute=function(o$o,o$r){var o$T=o$u.mainContext,o$k=o$V._enableAtributes,o$W=o$o.location;return o$k[o$W]||o$T.enableVertexAttribArray(o$W),o$T.vertexAttribPointer(o$W,o$r[0],o$r[1],o$r[2],o$r[3],o$r[4]),o$k[o$W]=o$V._bindVertexBuffer,1},o$r._uniform1f=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r?(o$u.mainContext.uniform1f(o$o.location,o$T[0]=o$r),1):0},o$r._uniform1fv=function(o$o,o$r){if(o$r.length<4){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]||o$T[2]!==o$r[2]||o$T[3]!==o$r[3]?(o$u.mainContext.uniform1fv(o$o.location,o$r),o$T[0]=o$r[0],o$T[1]=o$r[1],o$T[2]=o$r[2],o$T[3]=o$r[3],1):0}return o$u.mainContext.uniform1fv(o$o.location,o$r),1},o$r._uniform_vec2=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]?(o$u.mainContext.uniform2f(o$o.location,o$T[0]=o$r[0],o$T[1]=o$r[1]),1):0},o$r._uniform_vec2v=function(o$o,o$r){if(o$r.length<2){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]||o$T[2]!==o$r[2]||o$T[3]!==o$r[3]?(o$u.mainContext.uniform2fv(o$o.location,o$r),o$T[0]=o$r[0],o$T[1]=o$r[1],o$T[2]=o$r[2],o$T[3]=o$r[3],1):0}return o$u.mainContext.uniform2fv(o$o.location,o$r),1},o$r._uniform_vec3=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]||o$T[2]!==o$r[2]?(o$u.mainContext.uniform3f(o$o.location,o$T[0]=o$r[0],o$T[1]=o$r[1],o$T[2]=o$r[2]),1):0},o$r._uniform_vec3v=function(o$o,o$r){return o$u.mainContext.uniform3fv(o$o.location,o$r),1},o$r._uniform_vec4=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]||o$T[2]!==o$r[2]||o$T[3]!==o$r[3]?(o$u.mainContext.uniform4f(o$o.location,o$T[0]=o$r[0],o$T[1]=o$r[1],o$T[2]=o$r[2],o$T[3]=o$r[3]),1):0},o$r._uniform_vec4v=function(o$o,o$r){return o$u.mainContext.uniform4fv(o$o.location,o$r),1},o$r._uniformMatrix2fv=function(o$o,o$r){return o$u.mainContext.uniformMatrix2fv(o$o.location,!1,o$r),1},o$r._uniformMatrix3fv=function(o$o,o$r){return o$u.mainContext.uniformMatrix3fv(o$o.location,!1,o$r),1},o$r._uniformMatrix4fv=function(o$o,o$r){return o$u.mainContext.uniformMatrix4fv(o$o.location,!1,o$r),1},o$r._uinformMatrix2fv=function(o$o,o$r){return o$u.mainContext.uniformMatrix2fv(o$o.location,!1,o$r),1},o$r._uinformMatrix3fv=function(o$o,o$r){return o$u.mainContext.uniformMatrix3fv(o$o.location,!1,o$r),1},o$r._uniform1i=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r?(o$u.mainContext.uniform1i(o$o.location,o$T[0]=o$r),1):0},o$r._uniform1iv=function(o$o,o$r){return o$u.mainContext.uniform1iv(o$o.location,o$r),1},o$r._uniform_ivec2=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]?(o$u.mainContext.uniform2i(o$o.location,o$T[0]=o$r[0],o$T[1]=o$r[1]),1):0},o$r._uniform_ivec2v=function(o$o,o$r){return o$u.mainContext.uniform2iv(o$o.location,o$r),1},o$r._uniform_vec3i=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]||o$T[2]!==o$r[2]?(o$u.mainContext.uniform3i(o$o.location,o$T[0]=o$r[0],o$T[1]=o$r[1],o$T[2]=o$r[2]),1):0},o$r._uniform_vec3vi=function(o$o,o$r){return o$u.mainContext.uniform3iv(o$o.location,o$r),1},o$r._uniform_vec4i=function(o$o,o$r){var o$T=o$o.uploadedValue;return o$T[0]!==o$r[0]||o$T[1]!==o$r[1]||o$T[2]!==o$r[2]||o$T[3]!==o$r[3]?(o$u.mainContext.uniform4i(o$o.location,o$T[0]=o$r[0],o$T[1]=o$r[1],o$T[2]=o$r[2],o$T[3]=o$r[3]),1):0},o$r._uniform_vec4vi=function(o$o,o$r){return o$u.mainContext.uniform4iv(o$o.location,o$r),1},o$r._uniform_sampler2D=function(o$o,o$r){var o$T=o$r.source||o$r.defaulteTexture.source,o$k=o$u.mainContext,o$W=o$o.uploadedValue;if(null!=o$W[0])return o$k.activeTexture(o$h._TEXTURES[o$W[0]]),o$T&&o$s.bindTexture(o$k,3553,o$T),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return o$W[0]=this._curActTexIndex,o$k.uniform1i(o$o.location,this._curActTexIndex),o$k.activeTexture(o$h._TEXTURES[this._curActTexIndex]),o$T&&o$s.bindTexture(o$k,3553,o$T),this._curActTexIndex++,1},o$r._uniform_samplerCube=function(o$o,o$r){var o$T=o$r.source||o$r.defaulteTexture.source,o$k=o$u.mainContext,o$W=o$o.uploadedValue;if(null!=o$W[0])return o$k.activeTexture(o$h._TEXTURES[o$W[0]]),o$T?o$s.bindTexture(o$k,34067,o$T):o$s.bindTexture(o$k,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return o$W[0]=this._curActTexIndex,o$k.uniform1i(o$o.location,this._curActTexIndex),o$k.activeTexture(o$h._TEXTURES[this._curActTexIndex]),o$T?o$s.bindTexture(o$k,34067,o$T):o$s.bindTexture(o$k,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},o$r._noSetValue=function(o$o){console.log("no....:"+o$o.name)},o$r.bind=function(){return o$T.activeShader=this,(o$T.bindShader=this).activeResource(),o$s.UseProgram(this._program)},o$r.uploadAttributes=function(o$o,o$r){for(var o$T,o$k,o$W=0,o$D=0,o$n=this._attributeParamsMap.length;o$D<o$n;o$D+=2)o$k=this._attributeParamsMap[o$D+1],null!=(o$T=o$o[this._attributeParamsMap[o$D]])&&(o$r&&o$r[o$k.name]&&o$r[o$k.name].bind(),o$W+=o$k.fun.call(this,o$k,o$T));o$F.shaderCall+=o$W},o$r.uploadAttributesX=function(o$o,o$r){for(var o$T,o$k,o$W=0,o$D=0,o$n=this._attributeParamsMap.length;o$D<o$n;o$D+=2)o$k=this._attributeParamsMap[o$D+1],null!=(o$T=o$o[this._attributeParamsMap[o$D]])&&(o$r._bind(),o$W+=o$k.fun.call(this,o$k,o$T));o$F.shaderCall+=o$W},o$r.uploadSceneUniforms=function(o$o){for(var o$r,o$T,o$k=0,o$W=0,o$D=this._sceneUniformParamsMap.length;o$W<o$D;o$W+=2)o$T=this._sceneUniformParamsMap[o$W+1],null!=(o$r=o$o[this._sceneUniformParamsMap[o$W]])&&(o$k+=o$T.fun.call(this,o$T,o$r));o$F.shaderCall+=o$k},o$r.uploadCameraUniforms=function(o$o){for(var o$r,o$T,o$k=0,o$W=0,o$D=this._cameraUniformParamsMap.length;o$W<o$D;o$W+=2)o$T=this._cameraUniformParamsMap[o$W+1],null!=(o$r=o$o[this._cameraUniformParamsMap[o$W]])&&(o$k+=o$T.fun.call(this,o$T,o$r));o$F.shaderCall+=o$k},o$r.uploadSpriteUniforms=function(o$o){for(var o$r,o$T,o$k=0,o$W=0,o$D=this._spriteUniformParamsMap.length;o$W<o$D;o$W+=2)o$T=this._spriteUniformParamsMap[o$W+1],null!=(o$r=o$o[this._spriteUniformParamsMap[o$W]])&&(o$k+=o$T.fun.call(this,o$T,o$r));o$F.shaderCall+=o$k},o$r.uploadMaterialUniforms=function(o$o){for(var o$r,o$T,o$k=0,o$W=0,o$D=this._materialUniformParamsMap.length;o$W<o$D;o$W+=2)o$T=this._materialUniformParamsMap[o$W+1],null!=(o$r=o$o[this._materialUniformParamsMap[o$W]])&&(o$k+=o$T.fun.call(this,o$T,o$r));o$F.shaderCall+=o$k},o$r.uploadRenderElementUniforms=function(o$o){for(var o$r,o$T,o$k=0,o$W=0,o$D=this._renderElementUniformParamsMap.length;o$W<o$D;o$W+=2)o$T=this._renderElementUniformParamsMap[o$W+1],null!=(o$r=o$o[this._renderElementUniformParamsMap[o$W]])&&(o$k+=o$T.fun.call(this,o$T,o$r));o$F.shaderCall+=o$k},o$h.create=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){return new o$h(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U)},o$h.addInclude=function(o$o,o$r){o$y.addInclude(o$o,o$r)},o$h._createShader=function(o$o,o$r,o$T){var o$k=o$o.createShader(o$T);if(o$o.shaderSource(o$k,o$r),o$o.compileShader(o$k),o$Fr.debugMode&&!o$o.getShaderParameter(o$k,35713))throw o$o.getShaderInfoLog(o$k);return o$k},o$h.PERIOD_RENDERELEMENT=0,o$h.PERIOD_MATERIAL=1,o$h.PERIOD_SPRITE=2,o$h.PERIOD_CAMERA=3,o$h.PERIOD_SCENE=4,o$h._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],o$h._count=0,o$h._preCompile=!1,o$h.extCompileFunc=null,o$h.extCompileObj=null,o$p(o$h,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new o$P}]),o$h}(),o$Mr=function(o$V){function o$L(){this._transformUV=null,o$L.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new o$nr(.6,.6,.6)),this._setColor(10,new o$nr(1,1,1)),this._setColor(11,new o$Vr(1,1,1,8)),this._setColor(12,new o$nr(1,1,1)),this._setColor(7,new o$Vr(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new o$Vr(1,1,0,0)),this.renderMode=1}o$v(o$L,"laya.d3.core.material.StandardMaterial",o$V);var o$o=o$L.prototype;return o$o.disableLight=function(){this._addDisablePublicShaderDefine(o$Fr.SHADERDEFINE_POINTLIGHT|o$Fr.SHADERDEFINE_SPOTLIGHT|o$Fr.SHADERDEFINE_DIRECTIONLIGHT)},o$o.disableFog=function(){this._addDisablePublicShaderDefine(o$Fr.SHADERDEFINE_FOG)},o$o.onAsynLoaded=function(o$o,o$r,o$T){var o$k=o$r[0];if(o$k.version)o$V.prototype.onAsynLoaded.call(this,o$o,o$r,o$T);else{var o$W=o$r[1],o$D=o$k.props;for(var o$n in o$D)this[o$n]=o$D[o$n];o$L._parseStandardMaterial(o$W,this,o$k),this._endLoaded()}},o$o.cloneTo=function(o$o){o$V.prototype.cloneTo.call(this,o$o);var o$r=o$o;this._transformUV&&(o$r._transformUV=this._transformUV.clone())},o$x(0,o$o,"ambientColor",function(){return this._getColor(9)},function(o$o){this._setColor(9,o$o)}),o$x(0,o$o,"ambientTexture",function(){return this._getTexture(5)},function(o$o){o$o?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,o$o)}),o$x(0,o$o,"renderMode",null,function(o$o){switch(o$o){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(o$L.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(o$o)}),o$x(0,o$o,"reflectColor",function(){return this._getColor(12)},function(o$o){this._setColor(12,o$o)}),o$x(0,o$o,"tilingOffset",function(){return this._getColor(15)},function(o$o){if(o$o){var o$r=o$o.elements;1!=o$r[0]||1!=o$r[1]||0!=o$r[2]||0!=o$r[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,o$o)}),o$x(0,o$o,"albedo",function(){return this._getColor(7)},function(o$o){this._setColor(7,o$o)}),o$x(0,o$o,"diffuseColor",function(){return this._getColor(10)},function(o$o){this._setColor(10,o$o)}),o$x(0,o$o,"albedoColor",function(){return this._getColor(7)},function(o$o){this._setColor(7,o$o)}),o$x(0,o$o,"specularColor",function(){return this._getColor(11)},function(o$o){this._setColor(11,o$o)}),o$x(0,o$o,"diffuseTexture",function(){return this._getTexture(1)},function(o$o){o$o?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,o$o)}),o$x(0,o$o,"normalTexture",function(){return this._getTexture(2)},function(o$o){o$o?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,o$o)}),o$x(0,o$o,"specularTexture",function(){return this._getTexture(3)},function(o$o){o$o?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,o$o)}),o$x(0,o$o,"emissiveTexture",function(){return this._getTexture(4)},function(o$o){o$o?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,o$o)}),o$x(0,o$o,"reflectTexture",function(){return this._getTexture(6)},function(o$o){o$o?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,o$o)}),o$x(0,o$o,"transformUV",function(){return this._transformUV},function(o$o){this._transformUV=o$o,this._setMatrix4x4(13,o$o.matrix),o$o?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,o$o.matrix.elements,0)}),o$L.__init__=function(){o$L.SHADERDEFINE_DIFFUSEMAP=o$L.shaderDefines.registerDefine("DIFFUSEMAP"),o$L.SHADERDEFINE_NORMALMAP=o$L.shaderDefines.registerDefine("NORMALMAP"),o$L.SHADERDEFINE_SPECULARMAP=o$L.shaderDefines.registerDefine("SPECULARMAP"),o$L.SHADERDEFINE_EMISSIVEMAP=o$L.shaderDefines.registerDefine("EMISSIVEMAP"),o$L.SHADERDEFINE_AMBIENTMAP=o$L.shaderDefines.registerDefine("AMBIENTMAP"),o$L.SHADERDEFINE_REFLECTMAP=o$L.shaderDefines.registerDefine("REFLECTMAP"),o$L.SHADERDEFINE_UVTRANSFORM=o$L.shaderDefines.registerDefine("UVTRANSFORM"),o$L.SHADERDEFINE_TILINGOFFSET=o$L.shaderDefines.registerDefine("TILINGOFFSET"),o$L.SHADERDEFINE_ADDTIVEFOG=o$L.shaderDefines.registerDefine("ADDTIVEFOG")},o$L.load=function(o$o){return o$S.loader.create(o$o,null,null,o$L)},o$L._parseStandardMaterial=function(o$o,o$r,o$T){var o$k=o$T.customProps,o$W=o$k.ambientColor;o$r.ambientColor=new o$nr(o$W[0],o$W[1],o$W[2]);var o$D=o$k.diffuseColor;o$r.diffuseColor=new o$nr(o$D[0],o$D[1],o$D[2]);var o$n=o$k.specularColor;o$r.specularColor=new o$Vr(o$n[0],o$n[1],o$n[2],o$n[3]);var o$V=o$k.reflectColor;o$r.reflectColor=new o$nr(o$V[0],o$V[1],o$V[2]);var o$L=o$k.albedoColor;o$L&&(o$r.albedo=new o$Vr(o$L[0],o$L[1],o$L[2],o$L[3]));var o$U=o$k.diffuseTexture.texture2D;o$U&&(o$r.diffuseTexture=o$K.getRes(o$o[o$U]));var o$h=o$k.normalTexture.texture2D;o$h&&(o$r.normalTexture=o$K.getRes(o$o[o$h]));var o$p=o$k.specularTexture.texture2D;o$p&&(o$r.specularTexture=o$K.getRes(o$o[o$p]));var o$i=o$k.emissiveTexture.texture2D;o$i&&(o$r.emissiveTexture=o$K.getRes(o$o[o$i]));var o$v=o$k.ambientTexture.texture2D;o$v&&(o$r.ambientTexture=o$K.getRes(o$o[o$v]));var o$x=o$k.reflectTexture.texture2D;o$x&&(o$r.reflectTexture=o$K.getRes(o$o[o$x]))},o$L.RENDERMODE_OPAQUE=1,o$L.RENDERMODE_OPAQUEDOUBLEFACE=2,o$L.RENDERMODE_CUTOUT=3,o$L.RENDERMODE_CUTOUTDOUBLEFACE=4,o$L.RENDERMODE_TRANSPARENT=13,o$L.RENDERMODE_TRANSPARENTDOUBLEFACE=14,o$L.RENDERMODE_ADDTIVE=15,o$L.RENDERMODE_ADDTIVEDOUBLEFACE=16,o$L.RENDERMODE_DEPTHREAD_TRANSPARENT=5,o$L.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,o$L.RENDERMODE_DEPTHREAD_ADDTIVE=7,o$L.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,o$L.RENDERMODE_NONDEPTH_TRANSPARENT=9,o$L.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,o$L.RENDERMODE_NONDEPTH_ADDTIVE=11,o$L.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,o$L.SHADERDEFINE_DIFFUSEMAP=0,o$L.SHADERDEFINE_NORMALMAP=0,o$L.SHADERDEFINE_SPECULARMAP=0,o$L.SHADERDEFINE_EMISSIVEMAP=0,o$L.SHADERDEFINE_AMBIENTMAP=0,o$L.SHADERDEFINE_REFLECTMAP=0,o$L.SHADERDEFINE_UVTRANSFORM=0,o$L.SHADERDEFINE_TILINGOFFSET=0,o$L.SHADERDEFINE_ADDTIVEFOG=0,o$L.DIFFUSETEXTURE=1,o$L.NORMALTEXTURE=2,o$L.SPECULARTEXTURE=3,o$L.EMISSIVETEXTURE=4,o$L.AMBIENTTEXTURE=5,o$L.REFLECTTEXTURE=6,o$L.ALBEDO=7,o$L.UVANIAGE=8,o$L.MATERIALAMBIENT=9,o$L.MATERIALDIFFUSE=10,o$L.MATERIALSPECULAR=11,o$L.MATERIALREFLECT=12,o$L.UVMATRIX=13,o$L.UVAGE=14,o$L.TILINGOFFSET=15,o$p(o$L,["defaultMaterial",function(){var o$o=new o$L;return o$o.lock=!0,this.defaultMaterial=o$o},"shaderDefines",function(){return this.shaderDefines=new o$hr(o$Rr.shaderDefines)}]),o$L}(o$Rr),o$cr=function(o$o){function o$n(o$o,o$r,o$T,o$k,o$W){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===o$T&&(o$T=35044),void 0===o$k&&(o$k=!1),o$n.__super.call(this),this._indexType=o$o,this._indexCount=o$r,this._bufferUsage=o$T,this._bufferType=34963,this._canRead=o$k;var o$D;if("ushort"==o$o)this._indexTypeByteCount=2;else{if("ubyte"!=o$o)throw new Error("unidentification index type.");this._indexTypeByteCount=1}o$D=this._indexTypeByteCount*o$r,this._byteLength=o$D,this._bind(),o$V._gl.bufferData(this._bufferType,o$D,this._bufferUsage),this.uri=o$W,o$k?("ushort"==o$o?this._buffer=new Uint16Array(o$r):"ubyte"==o$o&&(this._buffer=new Uint8Array(o$r)),this.memorySize=2*o$D):this.memorySize=o$D}o$v(o$n,"laya.d3.graphics.IndexBuffer3D",o$o);var o$r=o$n.prototype;return o$r.setData=function(o$o,o$r,o$T,o$k){void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=4294967295);var o$W=0;if("ushort"==this._indexType?(o$W=2,0===o$T&&4294967295===o$k||(o$o=new Uint16Array(o$o.buffer,o$T*o$W,o$k))):"ubyte"==this._indexType&&(o$W=1,0===o$T&&4294967295===o$k||(o$o=new Uint8Array(o$o.buffer,o$T*o$W,o$k))),this._bind(),o$V._gl.bufferSubData(this._bufferType,o$r*o$W,o$o),this._canRead)if(0!==o$r||0!==o$T||4294967295!==o$k){var o$D=this._buffer.length-o$r;o$D<o$k&&(o$k=o$D);for(var o$n=0;o$n<o$k;o$n++)this._buffer[o$r+o$n]=o$o[o$n]}else this._buffer=o$o},o$r.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},o$r.disposeResource=function(){o$o.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},o$x(0,o$r,"indexType",function(){return this._indexType}),o$x(0,o$r,"indexTypeByteCount",function(){return this._indexTypeByteCount}),o$x(0,o$r,"indexCount",function(){return this._indexCount}),o$x(0,o$r,"canRead",function(){return this._canRead}),o$n.INDEXTYPE_UBYTE="ubyte",o$n.INDEXTYPE_USHORT="ushort",o$n.create=function(o$o,o$r,o$T,o$k,o$W){return void 0===o$T&&(o$T=35044),void 0===o$k&&(o$k=!1),new o$n(o$o,o$r,o$T,o$k,o$W)},o$n}(o$V),o$er=function(o$D){function o$n(o$o,o$r,o$T,o$k,o$W){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===o$k&&(o$k=!1),o$n.__super.call(this),this._vertexDeclaration=o$o,this._vertexCount=o$r,this._bufferUsage=o$T,this._bufferType=34962,this._canRead=o$k,this.uri=o$W,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*o$r,this._bind(),o$V._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),o$k&&(this._buffer=new Float32Array(this._byteLength/4))}o$v(o$n,"laya.d3.graphics.VertexBuffer3D",o$D);var o$o=o$n.prototype;return o$o.bindWithIndexBuffer=function(o$o){o$o&&o$o._bind(),this._bind()},o$o.setData=function(o$o,o$r,o$T,o$k){if(void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=4294967295),0===o$T&&4294967295===o$k||(o$o=new Float32Array(o$o.buffer,4*o$T,o$k)),this._bind(),o$V._gl.bufferSubData(this._bufferType,4*o$r,o$o),this._canRead)if(0!==o$r||0!==o$T||4294967295!==o$k){var o$W=this._buffer.length-o$r;o$W<o$k&&(o$k=o$W);for(var o$D=0;o$D<o$k;o$D++)this._buffer[o$r+o$D]=o$o[o$D]}else this._buffer=o$o},o$o.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},o$o.disposeResource=function(){for(var o$o=o$u.mainContext,o$r=this._vertexDeclaration.getVertexElements(),o$T=o$V._enableAtributes,o$k=0,o$W=o$r.length;o$k<o$W;o$k++)o$T[o$k]===this._glBuffer&&(o$o.disableVertexAttribArray(o$k),o$T[o$k]=null);o$D.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},o$x(0,o$o,"vertexDeclaration",function(){return this._vertexDeclaration}),o$x(0,o$o,"vertexCount",function(){return this._vertexCount}),o$x(0,o$o,"canRead",function(){return this._canRead}),o$n.create=function(o$o,o$r,o$T,o$k,o$W){return void 0===o$T&&(o$T=35044),void 0===o$k&&(o$k=!1),new o$n(o$o,o$r,o$T,o$k,o$W)},o$n}(o$V),o$Jr=function(o$o){function o$y(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,o$y.__super.call(this),this._type=3553}o$v(o$y,"laya.d3.resource.DataTexture2D",o$ur);var o$r=o$y.prototype;return o$r.genDebugMipmaps=function(){var o$o=[];return o$o.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),o$o.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),o$o.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),o$o.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),o$o.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),o$o.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),o$o.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),o$o.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),o$o.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),o$o.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),o$o},o$r._onTextureLoaded=function(o$o){},o$r._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var o$o=o$u.mainContext,o$r=this._source=o$o.createTexture(),o$T=this._width,o$k=this._height,o$W=o$s.curBindTexTarget,o$D=o$s.curBindTexValue,o$n=!1;if(o$s.bindTexture(o$o,this._type,o$r),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var o$V=0;o$o.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var o$L=0;o$L<this._mipmaps.length;o$L++){if(this._mipmaps[o$L].byteLength!=o$U*o$h*4)throw"mipmap size error  level:"+o$L;o$o.texSubImage2D(this._type,0,o$y.simLodRect[o$V++],o$y.simLodRect[o$V++],o$y.simLodRect[o$V++],o$y.simLodRect[o$V++],6408,5121,new Uint8Array(this._mipmaps[o$L]))}this.minFifter=9729,this.magFifter=9729}else{var o$U=this._width,o$h=this._height;for(o$V=0,o$o.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),o$L=0;o$L<this._mipmaps.length;o$L++){if(this._mipmaps[o$L].byteLength!=o$U*o$h*4)throw"mipmap size error  level:"+o$L;o$o.texImage2D(this._type,o$L,6408,o$U,o$h,0,6408,5121,new Uint8Array(this._mipmaps[o$L])),(o$U/=2)<1&&(o$U=1),(o$h/=2)<1&&(o$h=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&o$o.pixelStorei(o$o.UNPACK_ALIGNMENT,1),o$o.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var o$p=0,o$i=!1,o$v=!1;this._buffer.byteLength==4*o$T*o$k?(o$p=6408,o$i=!0):this._buffer.byteLength==3*o$T*o$k?(o$p=6407,o$v=!0):o$p=this._format,o$i||o$v?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),o$v&&o$o.pixelStorei(o$o.UNPACK_ALIGNMENT,1),o$o.texImage2D(this._type,0,o$p,o$T,o$k,0,o$p,5121,this._buffer)):o$o&&o$p==o$o.ALPHA?(o$o.texImage2D(3553,0,o$p,o$T,o$k,0,o$p,o$o.UNSIGNED_BYTE,this._buffer),o$n=!0):0!=o$p&&(o$o.compressedTexImage2D(3553,0,o$p,o$T,o$k,0,this._buffer),o$n=!0)}var o$x=this._minFifter,o$j=this._magFifter,o$_=0==this._wrapModeU?10497:33071,o$K=0==this._wrapModeV?10497:33071,o$$=o$l.isPOT(o$T,o$k);o$$?(this._mipmap||this._mipmaps?-1!==o$x||(o$x=9987):-1!==o$x||(o$x=9729),-1!==o$j||(o$j=9729),o$o.texParameteri(this._type,10241,o$x),o$o.texParameteri(this._type,10240,o$j),o$o.texParameteri(this._type,10242,o$_),o$o.texParameteri(this._type,10243,o$K),this._mipmap&&o$o.generateMipmap(this._type)):(-1!==o$x||(o$x=9729),-1!==o$j||(o$j=9729),o$o.texParameteri(this._type,10241,o$x),o$o.texParameteri(this._type,10240,o$j),o$o.texParameteri(this._type,10242,33071),o$o.texParameteri(this._type,10243,33071)),o$W&&o$D&&o$s.bindTexture(o$o,o$W,o$D),this.memorySize=o$n?this._buffer.length:o$$?o$T*o$k*4*(1+1/3):o$T*o$k*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},o$r.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},o$r.onAsynLoaded=function(o$o,o$r,o$T){var o$k;o$T&&(o$k=o$T[0].call(this,o$r)),o$k&&(this._width=o$k.width,this._height=o$k.height,this._buffer=o$k.data),this._src=o$o,this._size=new o$jr(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},o$r.getPixels=function(){return new Uint8Array(this._buffer)},o$r.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(o$u.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},o$x(0,o$r,"src",function(){return this._src}),o$y.create=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){if(void 0===o$k&&(o$k=9729),void 0===o$W&&(o$W=9729),void 0===o$D&&(o$D=!0),!o$o||o$o.byteLength<o$r*o$T*4)throw"DataTexture2D create error";var o$V=new o$y;return o$V.uri=o$n,o$V._buffer=o$o,o$V._width=o$r,o$V._height=o$T,o$V._mipmap=o$D,o$V._magFifter=o$k,o$V._minFifter=o$W,o$V._size=new o$jr(o$V._width,o$V._height),o$V._conchTexture?alert("怎么给runtime传递datatexture数据"):o$V.activeResource(),o$V},o$y.load=function(o$o,o$r,o$T,o$k,o$W){if(void 0===o$r&&(o$r=0),void 0===o$T&&(o$T=0),void 0===o$k&&(o$k=9729),void 0===o$W&&(o$W=9729),"mipmaps"===o$t.getFileExtension(o$o)){var o$D=o$S.loader.create(o$o,null,null,o$y,[function(o$o){this._mipmaps=[];var o$r=new Uint32Array(o$o);this._width=o$r[0];var o$T=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,o$T=1024),this._width!=o$T)throw"现在只支持512x256的环境贴图。当前的是"+o$r[0];this._height=o$r[1];for(var o$k=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,o$W=this._height,o$D=8;;){var o$n=o$k*o$W*4;if(o$D+o$n>o$o.byteLength)throw"load mipmaps data size error ";var o$V=new Uint8Array(o$o,o$D,o$n);if(this._mipmaps.push(o$V),o$D+=o$n,1==o$k&&1==o$W)break;(o$k/=2)<1&&(o$k=1),(o$W/=2)<1&&(o$W=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){o$D.simLodInfo=new Float32Array(40);for(var o$n=0;o$n<o$D.simLodInfo.length;)o$D.simLodInfo[o$n]=(o$y.simLodRect[o$n]+.5)/1024,o$n++,o$D.simLodInfo[o$n]=(o$y.simLodRect[o$n]+.5)/256,o$n++,o$D.simLodInfo[o$n]=Math.max(o$y.simLodRect[o$n]-1,.1)/1024,o$n++,o$D.simLodInfo[o$n]=Math.max(o$y.simLodRect[o$n]-1.5,.1)/256,o$n++}return o$D}if("number"==typeof o$r)return o$S.loader.create(o$o,null,null,o$y,[function(o$o){return this._width=o$r,this._height=o$T,this._buffer=o$o,null}]);if("function"==typeof o$r)return o$S.loader.create(o$o,null,null,o$y,[o$r]);throw new Error("unknown params.")},o$y.lodasatlas=!1,o$p(o$y,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),o$y}(),o$Yr=function(o$o){function o$r(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,o$r.__super.call(this)}o$v(o$r,"laya.d3.resource.models.PrimitiveMesh",o$sr);var o$T=o$r.prototype;return o$S.imps(o$T,{"laya.d3.core.render.IRenderable":!0}),o$T._getVertexBuffer=function(o$o){return void 0===o$o&&(o$o=0),0===o$o?this._vertexBuffer:null},o$T._getVertexBuffers=function(){return null},o$T._getIndexBuffer=function(){return this._indexBuffer},o$T._getPositions=function(){var o$o,o$r=[],o$T=this._vertexBuffer.vertexDeclaration.getVertexElements(),o$k=0;for(o$k=0;o$k<o$T.length;o$k++){var o$W=o$T[o$k];if("vector3"===o$W.elementFormat&&0===o$W.elementUsage){o$o=o$W;break}}var o$D=this._vertexBuffer.getData();for(o$k=0;o$k<o$D.length;o$k+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var o$n=o$k+o$o.offset/4,o$V=new o$nr(o$D[o$n+0],o$D[o$n+1],o$D[o$n+2]);o$r.push(o$V)}return o$r},o$T.getRenderElement=function(o$o){return this},o$T.getRenderElementsCount=function(){return 1},o$T.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},o$T._beforeRender=function(o$o){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},o$T._render=function(o$o){o$u.mainContext.drawElements(4,this._numberIndices,5123,0),o$F.drawCall++,o$F.trianglesFaces+=this._numberIndices/3},o$x(0,o$T,"_vertexBufferCount",function(){return 1}),o$x(0,o$T,"triangleCount",function(){return this._indexBuffer.indexCount/3}),o$r}(),o$Ar=function(o$o){function o$r(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,o$r.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}o$v(o$r,"laya.d3.resource.models.Mesh",o$sr);var o$T=o$r.prototype;return o$T._getPositions=function(){var o$o,o$r,o$T,o$k,o$W,o$D=[],o$n=0,o$V=0,o$L=0;if(0!==this._vertexBuffers.length){var o$U=this._vertexBuffers.length;for(o$n=0;o$n<o$U;o$n++){for(o$T=(o$o=this._vertexBuffers[o$n]).vertexDeclaration.getVertexElements(),o$V=0;o$V<o$T.length;o$V++)if("vector3"===(o$k=o$T[o$V]).elementFormat&&0===o$k.elementUsage){o$r=o$k;break}for(o$W=o$o.getData(),o$V=0;o$V<o$W.length;o$V+=o$o.vertexDeclaration.vertexStride/4)o$L=o$V+o$r.offset/4,o$D.push(new o$nr(o$W[o$L+0],o$W[o$L+1],o$W[o$L+2]))}}else{var o$h=this._subMeshes.length;for(o$n=0;o$n<o$h;o$n++){for(o$T=(o$o=this._subMeshes[o$n]._getVertexBuffer()).vertexDeclaration.getVertexElements(),o$V=0;o$V<o$T.length;o$V++)if("vector3"===(o$k=o$T[o$V]).elementFormat&&0===o$k.elementUsage){o$r=o$k;break}for(o$W=o$o.getData(),o$V=0;o$V<o$W.length;o$V+=o$o.vertexDeclaration.vertexStride/4)o$L=o$V+o$r.offset/4,o$D.push(new o$nr(o$W[o$L+0],o$W[o$L+1],o$W[o$L+2]))}}return o$D},o$T._setSubMeshes=function(o$o){this._subMeshes=o$o,this._subMeshCount=o$o.length;for(var o$r=0;o$r<this._subMeshCount;o$r++)o$o[o$r]._indexInMesh=o$r;this._positions=this._getPositions(),this._generateBoundingObject()},o$T.onAsynLoaded=function(o$o,o$r,o$T){var o$k=o$r[0],o$W=o$r[1];o$Zo.read(o$k,this,this._materials,this._subMeshes,o$W),this.completeCreate(),this._endLoaded()},o$T.getSubMesh=function(o$o){return this._subMeshes[o$o]},o$T.getSubMeshCount=function(){return this._subMeshes.length},o$T.getRenderElementsCount=function(){return this._subMeshes.length},o$T.getRenderElement=function(o$o){return this._subMeshes[o$o]},o$T.disposeResource=function(){for(var o$o=0;o$o<this._subMeshes.length;o$o++)this._subMeshes[o$o].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},o$x(0,o$T,"materials",function(){return this._materials.slice()}),o$x(0,o$T,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),o$r.load=function(o$o){return o$S.loader.create(o$o,null,null,o$r)},o$r}(),o$Ir=(function(o$o){function o$U(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===o$T&&(o$T=6408),void 0===o$k&&(o$k=5121),void 0===o$W&&(o$W=33189),void 0===o$D&&(o$D=!1),void 0===o$n&&(o$n=!1),void 0===o$V&&(o$V=-1),void 0===o$L&&(o$L=-1),o$U.__super.call(this),this._type=3553,this._width=o$o,this._height=o$r,this._size=new o$jr(o$o,o$r),this._surfaceFormat=o$T,this._surfaceType=o$k,this._depthStencilFormat=o$W,o$j.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=o$D,this._repeat=o$n,this._minFifter=o$V,this._magFifter=o$L,this.activeResource(),this._alreadyResolved=!0}o$v(o$U,"laya.d3.resource.RenderTexture",o$ur);var o$r=o$U.prototype;o$r.recreateResource=function(){var o$o=o$u.mainContext;this._frameBuffer=o$o.createFramebuffer(),this._source=o$o.createTexture();var o$r=o$s.curBindTexTarget,o$T=o$s.curBindTexValue;o$s.bindTexture(o$o,this._type,this._source),o$o.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var o$k=this._minFifter,o$W=this._magFifter,o$D=this._repeat?10497:33071;if(o$l.isPOT(this._width,this._height)?(this._mipmap?-1!==o$k||(o$k=9987):-1!==o$k||(o$k=9729),-1!==o$W||(o$W=9729),o$o.texParameteri(this._type,10241,o$k),o$o.texParameteri(this._type,10240,o$W),o$o.texParameteri(this._type,10242,o$D),o$o.texParameteri(this._type,10243,o$D),this._mipmap&&o$o.generateMipmap(this._type)):(-1!==o$k||(o$k=9729),-1!==o$W||(o$W=9729),o$o.texParameteri(this._type,10241,o$k),o$o.texParameteri(this._type,10240,o$W),o$o.texParameteri(this._type,10242,33071),o$o.texParameteri(this._type,10243,33071)),o$r&&o$T&&o$s.bindTexture(o$o,o$r,o$T),o$o.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=o$o.createRenderbuffer(),o$o.bindRenderbuffer(36161,this._depthStencilBuffer),o$o.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),o$o.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:o$o.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:o$o.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:o$o.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}o$o.framebufferTexture2D(36160,36064,3553,this._source,0),o$o.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},o$r.start=function(){o$u.mainContext.bindFramebuffer(36160,this.frameBuffer),(o$U._currentRenderTarget=this)._alreadyResolved=!1},o$r.end=function(){o$u.mainContext.bindFramebuffer(36160,null),o$U._currentRenderTarget=null,this._alreadyResolved=!0},o$r.getData=function(o$o,o$r,o$T,o$k){var o$W=o$u.mainContext;if(o$W.bindFramebuffer(36160,this._frameBuffer),!(36053===o$W.checkFramebufferStatus(36160)))return o$W.bindFramebuffer(36160,null),null;var o$D=new Uint8Array(this._width*this._height*4);return o$W.readPixels(o$o,o$r,o$T,o$k,this._surfaceFormat,this._surfaceType,o$D),o$W.bindFramebuffer(36160,null),o$D},o$r.disposeResource=function(){if(this._frameBuffer){var o$o=o$u.mainContext;o$o.deleteTexture(this._source),o$o.deleteFramebuffer(this._frameBuffer),o$o.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},o$x(0,o$r,"surfaceFormat",function(){return this._surfaceFormat}),o$x(0,o$r,"surfaceType",function(){return this._surfaceType}),o$x(0,o$r,"depthStencilFormat",function(){return this._depthStencilFormat}),o$x(0,o$r,"source",function(){return this._alreadyResolved?o$S.superGet(o$ur,this,"source"):null}),o$x(0,o$r,"depthStencilBuffer",function(){return this._depthStencilBuffer}),o$x(0,o$r,"frameBuffer",function(){return this._frameBuffer}),o$U._currentRenderTarget=null}(),function(o$o){function o$r(o$o){this._color=null,this._pixels=null,o$r.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new o$jr(this.width,this.height),this._color=o$o,this._pixels=new Uint8Array([255*o$o.x,255*o$o.y,255*o$o.z,255*o$o.w]),this.uri="SolidColorTexture2D_"+this.id}o$v(o$r,"laya.d3.resource.SolidColorTexture2D",o$ur);var o$T=o$r.prototype;return o$T._createWebGlTexture=function(){var o$o=o$u.mainContext,o$r=this._source=o$o.createTexture(),o$T=this._width,o$k=this._height,o$W=o$s.curBindTexTarget,o$D=o$s.curBindTexValue;o$s.bindTexture(o$o,this._type,o$r),o$o.texImage2D(this._type,0,6408,o$T,o$k,0,6408,5121,this._pixels);var o$n=this._minFifter,o$V=this._magFifter,o$L=this._repeat?10497:33071,o$U=o$l.isPOT(o$T,o$k);o$U?(this._mipmap?-1!==o$n||(o$n=9987):-1!==o$n||(o$n=9729),-1!==o$V||(o$V=9729),o$o.texParameteri(this._type,10241,o$n),o$o.texParameteri(this._type,10240,o$V),o$o.texParameteri(this._type,10242,o$L),o$o.texParameteri(this._type,10243,o$L),this._mipmap&&o$o.generateMipmap(this._type)):(-1!==o$n||(o$n=9729),-1!==o$V||(o$V=9729),o$o.texParameteri(this._type,10241,o$n),o$o.texParameteri(this._type,10240,o$V),o$o.texParameteri(this._type,10242,33071),o$o.texParameteri(this._type,10243,33071)),o$W&&o$D&&o$s.bindTexture(o$o,o$W,o$D),this.memorySize=o$U?o$T*o$k*4*(1+1/3):o$T*o$k*4},o$T.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},o$T.disposeResource=function(){this._source&&(o$u.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},o$p(o$r,["magentaTexture",function(){var o$o=new o$r(new o$Vr(1,0,1,1));return o$o.lock=!0,this.magentaTexture=o$o},"grayTexture",function(){var o$o=new o$r(new o$Vr(.5,.5,.5,1));return o$o.lock=!0,this.grayTexture=o$o}]),o$r}()),o$Nr=function(o$o){function o$W(o$o,o$r,o$T,o$k){this._canRead=!1,this._image=null,this._pixels=null,void 0===o$o&&(o$o=!1),void 0===o$r&&(o$r=!0),void 0===o$T&&(o$T=6408),void 0===o$k&&(o$k=!0),o$W.__super.call(this),this._type=3553,this._repeat=o$r,this._canRead=o$o,this._format=o$T,this._mipmap=o$k}o$v(o$W,"laya.d3.resource.Texture2D",o$ur);var o$r=o$W.prototype;return o$r._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var o$o=o$u.mainContext,o$r=this._source=o$o.createTexture(),o$T=this._width,o$k=this._height,o$W=o$s.curBindTexTarget,o$D=o$s.curBindTexValue;switch(o$s.bindTexture(o$o,this._type,o$r),this._format){case 6407:case 6408:this._canRead?o$o.texImage2D(this._type,0,this._format,o$T,o$k,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?o$o.texImage2D(this._type,0,this._image._format,o$T,o$k,0,this._image._format,5121,this._image.atlasSource):o$o.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case o$u.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:o$o.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var o$n=this._minFifter,o$V=this._magFifter,o$L=this._repeat?10497:33071,o$U=0==this._wrapModeU?10497:33071,o$h=0==this._wrapModeV?10497:33071,o$p=o$l.isPOT(o$T,o$k);o$p?(this._mipmap?-1!==o$n||(o$n=9987):-1!==o$n||(o$n=9729),-1!==o$V||(o$V=9729),o$o.texParameteri(this._type,10241,o$n),o$o.texParameteri(this._type,10240,o$V),o$o.texParameteri(this._type,10242,o$L),o$o.texParameteri(this._type,10243,o$L),o$o.texParameteri(this._type,10242,o$U),o$o.texParameteri(this._type,10243,o$h),this._mipmap&&o$o.generateMipmap(this._type)):(-1!==o$n||(o$n=9729),-1!==o$V||(o$V=9729),o$o.texParameteri(this._type,10241,o$n),o$o.texParameteri(this._type,10240,o$V),o$o.texParameteri(this._type,10242,33071),o$o.texParameteri(this._type,10243,33071)),o$W&&o$D&&o$s.bindTexture(o$o,o$W,o$D),this._image.onload=null,this._image=null,this.memorySize=o$p?o$T*o$k*4*(1+1/3):o$T*o$k*4},o$r.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},o$r.onAsynLoaded=function(o$o,o$r,o$T){if(o$T){var o$k=o$T[0];void 0!==o$k&&(this._canRead=o$k);var o$W=o$T[1];void 0!==o$W&&(this._repeat=o$W);var o$D=o$T[2];void 0!==o$D&&(this._format=o$D);var o$n=o$T[3];void 0!==o$n&&(this._mipmap=o$n);var o$V=o$T.wrapModeU;void 0!==o$V&&(this._wrapModeU=o$V);var o$L=o$T.wrapModeV;void 0!==o$L&&(this._wrapModeV=o$L)}switch(this._format){case 6407:case 6408:var o$U=(this._image=o$r).width,o$h=o$r.height;this._width=o$U,this._height=o$h,this._size=new o$jr(o$U,o$h),this._canRead&&(o$j.isConchApp?o$r instanceof o$i.HTMLElement&&(this._pixels=new Uint8Array(o$r.getImageData(0,0,o$U,o$h))):(o$z.canvas.size(o$U,o$h),o$z.canvas.clear(),o$z.context.drawImage(o$r,0,0,o$U,o$h),this._pixels=new Uint8Array(o$z.context.getImageData(0,0,o$U,o$h).data.buffer)));break;case o$u.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var o$p=new o$q(o$r);o$p.readUTFBytes(4),o$p.readUTFBytes(2),o$p.getInt16();o$p.endian="bigEndian",this._width=o$p.getInt16(),this._height=o$p.getInt16(),this._size=new o$jr(this._width,this._height);o$p.getInt16(),o$p.getInt16();this._image=new Uint8Array(o$r,o$p.pos)}this.recreateResource(),this._endLoaded()},o$r.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},o$r.disposeResource=function(){this._source&&(o$u.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},o$x(0,o$r,"_src",function(){return this.url}),o$x(0,o$r,"src",function(){return this.url}),o$W.load=function(o$o){return o$S.loader.create(o$o,null,null,o$W)},o$W}(),o$fr=function(o$r){function o$T(o$o,o$r){o$T.__super.call(this),void 0===o$o&&(o$o=.3),void 0===o$r&&(o$r=1e3),this._tempVector3=new o$nr,this._position=new o$nr,this._up=new o$nr,this._forward=new o$nr,this._right=new o$nr,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=o$jr.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=o$o,this._farPlane=o$r,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),o$S.stage.on("resize",this,this._onScreenSizeChanged)}o$v(o$T,"laya.d3.core.BaseCamera",o$r);var o$o=o$T.prototype;return o$o._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var o$o=this.scene._cameraPool,o$r=o$o.length-1,o$T=0;o$T<o$r;o$T++)if(o$o[o$T].renderingOrder>o$o[o$r].renderingOrder){var o$k=o$o[o$T];o$o[o$T]=o$o[o$r],o$o[o$r]=o$k}},o$o._calculateProjectionMatrix=function(){},o$o._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},o$o._prepareCameraToRender=function(){o$m._currentCameraCullingMask=this.cullingMask;var o$o=this._shaderValues;o$o.setValue(0,this.transform.position.elements),o$o.setValue(5,this.forward.elements),o$o.setValue(6,this.up.elements)},o$o._prepareCameraViewProject=function(o$o,o$r){var o$T=this._shaderValues;o$T.setValue(1,o$o.elements),o$T.setValue(2,o$r.elements)},o$o._renderCamera=function(o$o,o$r,o$T){},o$o.addLayer=function(o$o){29!==o$o.number&&30!=o$o.number&&(this.cullingMask=this.cullingMask|o$o.mask)},o$o.removeLayer=function(o$o){29!==o$o.number&&30!=o$o.number&&(this.cullingMask=this.cullingMask&~o$o.mask)},o$o.addAllLayers=function(){this.cullingMask=2147483647},o$o.removeAllLayers=function(){this.cullingMask=0|o$m.getLayerByNumber(29).mask|o$m.getLayerByNumber(30).mask},o$o.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},o$o.moveForward=function(o$o){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=o$o,this.transform.translate(this._tempVector3)},o$o.moveRight=function(o$o){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=o$o,this.transform.translate(this._tempVector3)},o$o.moveVertical=function(o$o){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=o$o,this.transform.translate(this._tempVector3,!1)},o$o._addSelfRenderObjects=function(){var o$o=this.scene._cameraPool,o$r=o$o.length;if(0<o$r){for(var o$T=o$r-1;0<=o$T;o$T--)if(this.renderingOrder<=o$o[o$T].renderingOrder){o$o.splice(o$T+1,0,this);break}}else o$o.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},o$o._clearSelfRenderObjects=function(){var o$o=this.scene._cameraPool;o$o.splice(o$o.indexOf(this),1)},o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,o$S.stage.off("resize",this,this._onScreenSizeChanged),o$r.prototype.destroy.call(this,o$o)},o$x(0,o$o,"sky",function(){return this._sky},function(o$o){(this._sky=o$o)._ownerCamera=this}),o$x(0,o$o,"forward",function(){var o$o=this.transform.worldMatrix.elements,o$r=this._forward.elements;return o$r[0]=-o$o[8],o$r[1]=-o$o[9],o$r[2]=-o$o[10],this._forward}),o$x(0,o$o,"position",function(){var o$o=this.transform.worldMatrix.elements,o$r=this._position.elements;return o$r[0]=o$o[12],o$r[1]=o$o[13],o$r[2]=o$o[14],this._position}),o$x(0,o$o,"renderTarget",function(){return this._renderTarget},function(o$o){null!=(this._renderTarget=o$o)&&(this._renderTargetSize=o$o.size)}),o$x(0,o$o,"up",function(){var o$o=this.transform.worldMatrix.elements,o$r=this._up.elements;return o$r[0]=o$o[4],o$r[1]=o$o[5],o$r[2]=o$o[6],this._up}),o$x(0,o$o,"right",function(){var o$o=this.transform.worldMatrix.elements,o$r=this._right.elements;return o$r[0]=o$o[0],o$r[1]=o$o[1],o$r[2]=o$o[2],this._right}),o$x(0,o$o,"renderTargetSize",function(){return this._renderTargetSize},function(o$o){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=o$o,this._calculateProjectionMatrix()}),o$x(0,o$o,"fieldOfView",function(){return this._fieldOfView},function(o$o){this._fieldOfView=o$o,this._calculateProjectionMatrix()}),o$x(0,o$o,"nearPlane",function(){return this._nearPlane},function(o$o){this._nearPlane=o$o,this._calculateProjectionMatrix()}),o$x(0,o$o,"farPlane",function(){return this._farPlane},function(o$o){this._farPlane=o$o,this._calculateProjectionMatrix()}),o$x(0,o$o,"orthographic",function(){return this._orthographic},function(o$o){this._orthographic=o$o,this._calculateProjectionMatrix()}),o$x(0,o$o,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(o$o){this._orthographicVerticalSize=o$o,this._calculateProjectionMatrix()}),o$x(0,o$o,"renderingOrder",function(){return this._renderingOrder},function(o$o){this._renderingOrder=o$o,this._sortCamerasByRenderingOrder()}),o$T.CAMERAPOS=0,o$T.VIEWMATRIX=1,o$T.PROJECTMATRIX=2,o$T.VPMATRIX=3,o$T.VPMATRIX_NO_TRANSLATE=4,o$T.CAMERADIRECTION=5,o$T.CAMERAUP=6,o$T.ENVIRONMENTDIFFUSE=7,o$T.ENVIRONMENTSPECULAR=8,o$T.SIMLODINFO=9,o$T.DIFFUSEIRRADMATR=10,o$T.DIFFUSEIRRADMATG=11,o$T.DIFFUSEIRRADMATB=12,o$T.HDREXPOSURE=13,o$T.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",o$T.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",o$T.CLEARFLAG_SOLIDCOLOR=0,o$T.CLEARFLAG_SKY=1,o$T.CLEARFLAG_DEPTHONLY=2,o$T.CLEARFLAG_NONE=3,o$p(o$T,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new o$or(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new o$or},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new o$or}]),o$T}(o$Xr),o$ar=function(o$T){function o$r(o$o){this._render=null,this._geometryFilter=null,o$r.__super.call(this,o$o)}o$v(o$r,"laya.d3.core.RenderableSprite3D",o$T);var o$o=o$r.prototype;return o$o._addToInitStaticBatchManager=function(){},o$o._setBelongScene=function(o$o){o$T.prototype._setBelongScene.call(this,o$o),o$o._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},o$o._setUnBelongScene=function(){var o$o=this._scene._renderableSprite3Ds,o$r=o$o.indexOf(this);o$o.splice(o$r,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),o$T.prototype._setUnBelongScene.call(this)},o$o._update=function(o$o){(o$o.owner=this)._activeInHierarchy&&(this._updateComponents(o$o),this._render._updateOctreeNode(),this._lateUpdateComponents(o$o),o$F.spriteCount++,this._childs.length&&this._updateChilds(o$o))},o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),o$T.prototype.destroy.call(this,o$o),this._render._destroy(),this._render=null},o$r.__init__=function(){o$r.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=o$r.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),o$r.SAHDERDEFINE_LIGHTMAP=o$r.shaderDefines.registerDefine("LIGHTMAP")},o$r.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,o$r.SAHDERDEFINE_LIGHTMAP=4,o$r.LIGHTMAPSCALEOFFSET=2,o$r.LIGHTMAP=3,o$p(o$r,["shaderDefines",function(){return this.shaderDefines=new o$hr}]),o$r}(o$Xr),o$Gr=(function(o$o){function o$k(o$o,o$r,o$T){this._long=NaN,this._width=NaN,this._height=NaN,void 0===o$o&&(o$o=1),void 0===o$r&&(o$r=1),void 0===o$T&&(o$T=1),o$k.__super.call(this),this._long=o$o,this._width=o$r,this._height=o$T,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}o$v(o$k,"laya.d3.resource.models.BoxMesh",o$Yr);var o$r=o$k.prototype;o$r.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var o$o=o$uo.vertexDeclaration,o$r=(o$o.vertexStride,this._long/2),o$T=this._height/2,o$k=this._width/2,o$W=new Float32Array([-o$r,o$T,-o$k,0,1,0,0,0,o$r,o$T,-o$k,0,1,0,1,0,o$r,o$T,o$k,0,1,0,1,1,-o$r,o$T,o$k,0,1,0,0,1,-o$r,-o$T,-o$k,0,-1,0,0,1,o$r,-o$T,-o$k,0,-1,0,1,1,o$r,-o$T,o$k,0,-1,0,1,0,-o$r,-o$T,o$k,0,-1,0,0,0,-o$r,o$T,-o$k,-1,0,0,0,0,-o$r,o$T,o$k,-1,0,0,1,0,-o$r,-o$T,o$k,-1,0,0,1,1,-o$r,-o$T,-o$k,-1,0,0,0,1,o$r,o$T,-o$k,1,0,0,1,0,o$r,o$T,o$k,1,0,0,0,0,o$r,-o$T,o$k,1,0,0,0,1,o$r,-o$T,-o$k,1,0,0,1,1,-o$r,o$T,o$k,0,0,1,0,0,o$r,o$T,o$k,0,0,1,1,0,o$r,-o$T,o$k,0,0,1,1,1,-o$r,-o$T,o$k,0,0,1,0,1,-o$r,o$T,-o$k,0,0,-1,1,0,o$r,o$T,-o$k,0,0,-1,0,0,o$r,-o$T,-o$k,0,0,-1,0,1,-o$r,-o$T,-o$k,0,0,-1,1,1]),o$D=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new o$er(o$o,this._numberVertices,35044,!0),this._indexBuffer=new o$cr("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(o$W),this._indexBuffer.setData(o$D),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},o$x(0,o$r,"long",function(){return this._long},function(o$o){this._long!==o$o&&(this._long=o$o,this.releaseResource(),this.activeResource())}),o$x(0,o$r,"width",function(){return this._width},function(o$o){this._width!==o$o&&(this._width=o$o,this.releaseResource(),this.activeResource())}),o$x(0,o$r,"height",function(){return this._height},function(o$o){this._height!==o$o&&(this._height=o$o,this.releaseResource(),this.activeResource())})}(),function(o$o){function o$n(o$o,o$r,o$T){void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=.3),void 0===o$T&&(o$T=1e3),this._viewMatrix=new o$or,this._projectionMatrix=new o$or,this._projectionViewMatrix=new o$or,this._viewport=new o$Lr(0,0,0,0),this._normalizedViewport=new o$Lr(0,0,1,1),this._aspectRatio=o$o,this._boundFrustumUpdate=!0,this._boundFrustum=new o$go(o$or.DEFAULT),o$n.__super.call(this,o$r,o$T),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}o$v(o$n,"laya.d3.core.Camera",o$fr);var o$r=o$n.prototype;return o$r._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},o$r._parseCustomProps=function(o$o,o$r,o$T,o$k){var o$W=o$T.clearColor;this.clearColor=new o$Vr(o$W[0],o$W[1],o$W[2],o$W[3]);var o$D=o$T.viewport;this.normalizedViewport=new o$Lr(o$D[0],o$D[1],o$D[2],o$D[3])},o$r._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var o$o=this.orthographicVerticalSize*this.aspectRatio*.5,o$r=.5*this.orthographicVerticalSize;o$or.createOrthoOffCenterRH(-o$o,o$o,-o$r,o$r,this.nearPlane,this.farPlane,this._projectionMatrix)}else o$or.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},o$r._update=function(o$o){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,o$o)},o$r._renderCamera=function(o$o,o$r,o$T){var o$k,o$W;o$T.parallelSplitShadowMaps[0]&&o$T._renderShadowMap(o$o,o$r,this),(o$r.camera=this)._prepareCameraToRender(),o$T._preRenderUpdateComponents(o$r),o$k=o$r._viewMatrix=this.viewMatrix;var o$D=this._renderTarget;o$D?(o$D.start(),o$or.multiply(o$fr._invertYScaleMatrix,this._projectionMatrix,o$fr._invertYProjectionMatrix),o$or.multiply(o$fr._invertYScaleMatrix,this.projectionViewMatrix,o$fr._invertYProjectionViewMatrix),o$W=o$r._projectionMatrix=o$fr._invertYProjectionMatrix,o$r._projectionViewMatrix=o$fr._invertYProjectionViewMatrix):(o$W=o$r._projectionMatrix=this._projectionMatrix,o$r._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(o$k,o$W),o$r._viewport=this.viewport,o$T._preRenderScene(o$o,o$r,this.boundFrustum),o$T._clear(o$o,o$r),o$T._renderScene(o$o,o$r),o$T._postRenderUpdateComponents(o$r),o$D&&o$D.end()},o$r.viewportPointToRay=function(o$o,o$r){o$xr.calculateCursorRay(o$o,this.viewport,this._projectionMatrix,this.viewMatrix,null,o$r)},o$r.normalizedViewportPointToRay=function(o$o,o$r){var o$T=o$n._tempVector20,o$k=this.viewport,o$W=o$o.elements,o$D=o$T.elements;o$D[0]=o$W[0]*o$k.width,o$D[1]=o$W[1]*o$k.height,o$xr.calculateCursorRay(o$T,this.viewport,this._projectionMatrix,this.viewMatrix,null,o$r)},o$r.worldToViewportPoint=function(o$o,o$r){o$or.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(o$o,this._projectionViewMatrix,o$r);var o$T=o$r.elements;o$T[0]=o$T[0]/o$S.stage.clientScaleX,o$T[1]=o$T[1]/o$S.stage.clientScaleY},o$r.worldToNormalizedViewportPoint=function(o$o,o$r){o$or.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(o$o,this._projectionViewMatrix,o$r);var o$T=o$r.elements;o$T[0]=o$T[0]/o$S.stage.clientScaleX,o$T[1]=o$T[1]/o$S.stage.clientScaleY},o$r.convertScreenCoordToOrthographicCoord=function(o$o,o$r){if(this._orthographic){var o$T=o$Z.clientWidth,o$k=o$Z.clientHeight,o$W=this.orthographicVerticalSize*this.aspectRatio/o$T,o$D=this.orthographicVerticalSize/o$k,o$n=o$o.elements,o$V=o$r.elements;return o$V[0]=(-o$T/2+o$n[0])*o$W,o$V[1]=(o$k/2-o$n[1])*o$D,o$V[2]=(this.nearPlane-this.farPlane)*(o$n[2]+1)/2-this.nearPlane,o$nr.transformCoordinate(o$r,this.transform.worldMatrix,o$r),!0}return!1},o$x(0,o$r,"projectionViewMatrix",function(){return o$or.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),o$x(0,o$r,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var o$o=this.viewport;return o$o.width/o$o.height},function(o$o){if(o$o<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=o$o,this._calculateProjectionMatrix()}),o$x(0,o$r,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),o$x(0,o$r,"needViewport",function(){var o$o=this.normalizedViewport;return 0===o$o.x&&0===o$o.y&&1===o$o.width&&1===o$o.height}),o$x(0,o$r,"viewport",function(){if(this._viewportExpressedInClipSpace){var o$o=this._normalizedViewport,o$r=this.renderTargetSize,o$T=o$r.width,o$k=o$r.height;this._viewport.x=o$o.x*o$T,this._viewport.y=o$o.y*o$k,this._viewport.width=o$o.width*o$T,this._viewport.height=o$o.height*o$k}return this._viewport},function(o$o){if(null!=this.renderTarget&&(o$o.x<0||o$o.y<0||0==o$o.width||0==o$o.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=o$o,this._calculateProjectionMatrix()}),o$x(0,o$r,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var o$o=this._viewport,o$r=this.renderTargetSize,o$T=o$r.width,o$k=o$r.height;this._normalizedViewport.x=o$o.x/o$T,this._normalizedViewport.y=o$o.y/o$k,this._normalizedViewport.width=o$o.width/o$T,this._normalizedViewport.height=o$o.height/o$k}return this._normalizedViewport},function(o$o){o$o.x<0&&(o$o.x=0,console.warn("Camera: viewport.x must large than 0.0.")),o$o.y<0&&(o$o.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<o$o.x+o$o.width&&(o$o.width=1-o$o.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<o$o.y+o$o.height&&(o$o.height=1-o$o.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=o$o,this._calculateProjectionMatrix()}),o$x(0,o$r,"projectionMatrix",function(){return this._projectionMatrix},function(o$o){this._projectionMatrix=o$o,this._useUserProjectionMatrix=!0}),o$x(0,o$r,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),o$p(o$n,["_tempVector20",function(){return this._tempVector20=new o$Dr}]),o$n}()),o$wr=function(o$T){function o$k(o$o,o$r){o$k.__super.call(this,o$r),this._geometryFilter=new o$zr(this),this._render=new o$mr(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),o$o&&(this._geometryFilter.sharedMesh=o$o)instanceof laya.d3.resource.models.Mesh&&(o$o.loaded?this._render.sharedMaterials=o$o.materials:o$o.once("loaded",this,this._applyMeshMaterials))}o$v(o$k,"laya.d3.core.MeshSprite3D",o$T);var o$o=o$k.prototype;return o$o._changeRenderObjectByMesh=function(o$o){var o$r=this._render._renderElements,o$T=o$r[o$o];o$T||(o$T=o$r[o$o]=new o$br),o$T._render=this._render;var o$k=this._render.sharedMaterials[o$o];o$k||(o$k=o$Mr.defaultMaterial);var o$W=this._geometryFilter.sharedMesh.getRenderElement(o$o);return o$T._mainSortID=this._getSortID(o$W,o$k),o$T._sprite3D=this,o$T.renderObj=o$W,o$T._material=o$k,o$T},o$o._changeRenderObjectByMaterial=function(o$o,o$r){var o$T=this._render._renderElements[o$o];o$r||(o$r=o$Mr.defaultMaterial);var o$k=this._geometryFilter.sharedMesh.getRenderElement(o$o);return o$T._mainSortID=this._getSortID(o$k,o$r),o$T._sprite3D=this,o$T.renderObj=o$k,o$T._material=o$r,o$T},o$o._changeRenderObjectsByMesh=function(){var o$o=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=o$o;for(var o$r=0;o$r<o$o;o$r++)this._changeRenderObjectByMesh(o$r)},o$o._onMeshChanged=function(o$o){var o$r=o$o.sharedMesh;o$r.loaded?this._changeRenderObjectsByMesh():o$r.once("loaded",this,this._onMeshLoaded)},o$o._onMeshLoaded=function(o$o){o$o===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},o$o._onMaterialChanged=function(o$o,o$r,o$T){o$r<this._render._renderElements.length&&this._changeRenderObjectByMaterial(o$r,o$T)},o$o._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},o$o._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},o$o._parseCustomProps=function(o$o,o$r,o$T,o$k){var o$W=this.meshRender,o$D=o$T.lightmapIndex;null!=o$D&&(o$W.lightmapIndex=o$D);var o$n,o$V,o$L=o$T.lightmapScaleOffset;if(o$L&&(o$W.lightmapScaleOffset=new o$Vr(o$L[0],o$L[1],o$L[2],o$L[3])),o$k.instanceParams)(o$n=o$k.instanceParams.loadPath)&&(o$V=o$K.getRes(o$r[o$n]),(this.meshFilter.sharedMesh=o$V).loaded?o$W.sharedMaterials=o$V.materials:o$V.once("loaded",this,this._applyMeshMaterials));else{(o$n=o$T.meshPath)&&(o$V=o$K.getRes(o$r[o$n]),this.meshFilter.sharedMesh=o$V);var o$U=o$T.materials;if(o$U){var o$h=o$W.sharedMaterials,o$p=o$U.length;o$h.length=o$p;for(var o$i=0;o$i<o$p;o$i++)o$h[o$i]=o$K.getRes(o$r[o$U[o$i].path]);o$W.sharedMaterials=o$h}}},o$o._applyMeshMaterials=function(o$o){for(var o$r=this._render.sharedMaterials,o$T=o$o.materials,o$k=0,o$W=o$T.length;o$k<o$W;o$k++)o$r[o$k]||(o$r[o$k]=o$T[o$k]);this._render.sharedMaterials=o$r},o$o._addToInitStaticBatchManager=function(){o$k._staticBatchManager._addInitBatchSprite(this)},o$o.cloneTo=function(o$o){var o$r=o$o;o$r._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var o$T=this._render,o$k=o$r._render;o$k.enable=o$T.enable,o$k.sharedMaterials=o$T.sharedMaterials,o$k.castShadow=o$T.castShadow;var o$W=o$T.lightmapScaleOffset;o$W&&(o$k.lightmapScaleOffset=o$W.clone()),o$k.lightmapIndex=o$T.lightmapIndex,o$k.receiveShadow=o$T.receiveShadow,o$k.sortingFudge=o$T.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,o$o)},o$o.destroy=function(o$o){if(void 0===o$o&&(o$o=!0),!this.destroyed){var o$r=this.meshFilter.sharedMesh;null!=o$r&&(o$r.loaded||o$r.off("loaded",this,this._applyMeshMaterials)),o$T.prototype.destroy.call(this,o$o),this._geometryFilter._destroy()}},o$x(0,o$o,"meshFilter",function(){return this._geometryFilter}),o$x(0,o$o,"meshRender",function(){return this._render}),o$k.__init__=function(){o$ko._staticBatchManagers.push(o$k._staticBatchManager)},o$k.load=function(o$o){return o$S.loader.create(o$o,null,null,o$k)},o$p(o$k,["_staticBatchManager",function(){return this._staticBatchManager=new o$Pr}]),o$k}(o$ar)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(o$o,o$r){"use strict";for(var o$T in Object.defineProperty(o$r,"__esModule",{value:!0}),Laya){var o$k=Laya[o$T];o$k&&o$k.__isclass&&(o$r[o$T]=o$k)}}),function(o$o,o$r,o$Wo){o$Wo.un,o$Wo.uns;var o$T=o$Wo.static,o$k=o$Wo.class,o$D=o$Wo.getset,o$j=o$Wo.__newvec,o$V=laya.maths.Bezier,o$p=laya.utils.Browser,o$uo=laya.utils.Byte,o$W=(laya.events.Event,laya.events.EventDispatcher),o$n=laya.display.Graphics,o$L=(laya.resource.HTMLCanvas,laya.utils.Handler),o$U=laya.net.Loader,o$i=laya.maths.MathUtil,o$so=laya.maths.Matrix,o$_=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),o$h=(laya.renders.RenderContext,laya.resource.Resource),o$v=laya.utils.RunDriver,o$Do=laya.display.Sprite,o$x=laya.utils.Stat,o$zo=laya.resource.Texture,o$K=(laya.net.URL,laya.utils.Utils),o$s=function(){function o$o(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return o$k(o$o,"laya.ani.AnimationContent"),o$o}(),o$z=function(){function o$o(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return o$k(o$o,"laya.ani.AnimationNodeContent"),o$o}(),o$y=function(){function o$o(){}return o$k(o$o,"laya.ani.AnimationParser01"),o$o.parse=function(o$o,o$r){var o$T=o$r.__getBuffer(),o$k=0,o$W=0,o$D=0,o$n=0,o$V=0,o$L=0,o$U=0,o$h=o$r.readUTFString();o$o._aniClassName=o$h;var o$p,o$i=o$r.readUTFString().split("\n"),o$v=o$r.getUint8(),o$x=o$r.getUint32(),o$j=o$r.getUint32();0<o$x&&(o$p=o$T.slice(o$x,o$j));var o$_=new o$uo(o$p);for(0<o$j&&(o$o._publicExtData=o$T.slice(o$j,o$T.byteLength)),o$o._useParent=!!o$r.getUint8(),o$o._anis.length=o$v,o$k=0;o$k<o$v;o$k++){var o$K=o$o._anis[o$k]=new o$s;o$K.nodes=new Array;var o$$=o$K.name=o$i[o$r.getUint16()];o$o._aniMap[o$$]=o$k,o$K.bone3DMap={},o$K.playTime=o$r.getFloat32(),o$K.playTime<=0&&console.error("播放时间不能为0  url="+o$o.url+" name="+o$K.name);var o$y=o$K.nodes.length=o$r.getUint8();for(o$W=o$K.totalKeyframeDatasLength=0;o$W<o$y;o$W++){var o$l=o$K.nodes[o$W]=new o$z;o$l.childs=[];var o$S=o$r.getInt16();0<=o$S&&(o$l.name=o$i[o$S],o$K.bone3DMap[o$l.name]=o$W),o$l.keyFrame=new Array,o$l.parentIndex=o$r.getInt16(),-1==o$l.parentIndex?o$l.parent=null:o$l.parent=o$K.nodes[o$l.parentIndex],o$l.lerpType=o$r.getUint8();var o$q=o$r.getUint32();o$_.pos=o$q;var o$b=o$l.keyframeWidth=o$_.getUint16();if(o$K.totalKeyframeDatasLength+=o$b,0===o$l.lerpType||1===o$l.lerpType)for(o$l.interpolationMethod=[],o$l.interpolationMethod.length=o$b,o$D=0;o$D<o$b;o$D++)o$l.interpolationMethod[o$D]=o$X.interpolation[o$_.getUint8()];null!=o$l.parent&&o$l.parent.childs.push(o$l);var o$F=o$r.getUint16();0<o$F&&(o$l.extenData=o$T.slice(o$r.pos,o$r.pos+o$F),o$r.pos+=o$F);var o$P,o$t=o$r.getUint16(),o$H=0;for(o$D=0,o$n=o$l.keyFrame.length=o$t;o$D<o$n;o$D++){if((o$P=o$l.keyFrame[o$D]=new o$m).duration=o$r.getFloat32(),o$P.startTime=o$H,2===o$l.lerpType){o$P.interpolationData=[];var o$R,o$u=o$r.getUint8();switch(o$R=o$r.getFloat32()){case 254:for(o$P.interpolationData.length=o$b,o$U=0;o$U<o$b;o$U++)o$P.interpolationData[o$U]=0;break;case 255:for(o$P.interpolationData.length=o$b,o$U=0;o$U<o$b;o$U++)o$P.interpolationData[o$U]=5;break;default:for(o$P.interpolationData.push(o$R),o$L=1;o$L<o$u;o$L++)o$P.interpolationData.push(o$r.getFloat32())}}for(o$P.data=new Float32Array(o$b),o$V=0;o$V<o$b;o$V++)o$P.data[o$V]=o$r.getFloat32(),-1e-8<o$P.data[o$V]&&o$P.data[o$V]<1e-8&&(o$P.data[o$V]=0);o$H+=o$P.duration}o$P.startTime=o$K.playTime,o$l.playTime=o$K.playTime,o$o._calculateKeyFrame(o$l,o$t,o$b)}}},o$o}(),o$l=function(){function o$S(){}return o$k(o$S,"laya.ani.AnimationParser02"),o$S.READ_DATA=function(){o$S._DATA.offset=o$S._reader.getUint32(),o$S._DATA.size=o$S._reader.getUint32()},o$S.READ_BLOCK=function(){for(var o$o=o$S._BLOCK.count=o$S._reader.getUint16(),o$r=o$S._BLOCK.blockStarts=[],o$T=o$S._BLOCK.blockLengths=[],o$k=0;o$k<o$o;o$k++)o$r.push(o$S._reader.getUint32()),o$T.push(o$S._reader.getUint32())},o$S.READ_STRINGS=function(){var o$o=o$S._reader.getUint32(),o$r=o$S._reader.getUint16(),o$T=o$S._reader.pos;o$S._reader.pos=o$o+o$S._DATA.offset;for(var o$k=0;o$k<o$r;o$k++)o$S._strings[o$k]=o$S._reader.readUTFString();o$S._reader.pos=o$T},o$S.parse=function(o$o,o$r){o$S._templet=o$o;(o$S._reader=o$r).__getBuffer();o$S.READ_DATA(),o$S.READ_BLOCK(),o$S.READ_STRINGS();for(var o$T=0,o$k=o$S._BLOCK.count;o$T<o$k;o$T++){var o$W=o$r.getUint16(),o$D=o$S._strings[o$W],o$n=o$S["READ_"+o$D];if(null==o$n)throw new Error("model file err,no this function:"+o$W+" "+o$D);o$n.call()}},o$S.READ_ANIMATIONS=function(){var o$o=o$S._reader,o$r=o$o.__getBuffer(),o$T=0,o$k=0,o$W=0,o$D=0,o$n=o$o.getUint16(),o$V=[];for(o$V.length=o$n,o$T=0;o$T<o$n;o$T++)o$V[o$T]=o$X.interpolation[o$o.getByte()];var o$L=o$o.getUint8();for(o$S._templet._anis.length=o$L,o$T=0;o$T<o$L;o$T++){var o$U=o$S._templet._anis[o$T]={};o$U.nodes=new Array;var o$h=o$U.name=o$S._strings[o$o.getUint16()];o$S._templet._aniMap[o$h]=o$T,o$U.bone3DMap={},o$U.playTime=o$o.getFloat32();var o$p=o$U.nodes.length=o$o.getInt16();for(o$k=o$U.totalKeyframeDatasLength=0;o$k<o$p;o$k++){var o$i=o$U.nodes[o$k]={};o$i.keyframeWidth=o$n,o$i.childs=[];var o$v=o$o.getUint16();0<=o$v&&(o$i.name=o$S._strings[o$v],o$U.bone3DMap[o$i.name]=o$k),o$i.keyFrame=new Array,o$i.parentIndex=o$o.getInt16(),-1==o$i.parentIndex?o$i.parent=null:o$i.parent=o$U.nodes[o$i.parentIndex],o$U.totalKeyframeDatasLength+=o$n,o$i.interpolationMethod=o$V,null!=o$i.parent&&o$i.parent.childs.push(o$i);var o$x=o$o.getUint16(),o$j=null,o$_=null;for(o$W=0,o$D=o$i.keyFrame.length=o$x;o$W<o$D;o$W++){(o$j=o$i.keyFrame[o$W]={}).startTime=o$o.getFloat32(),o$_&&(o$_.duration=o$j.startTime-o$_.startTime);var o$K=o$S._DATA.offset,o$$=o$o.getUint32(),o$y=4*o$n,o$l=o$r.slice(o$K+o$$,o$K+o$$+o$y);o$j.data=new Float32Array(o$l),o$_=o$j}o$j.duration=0,o$i.playTime=o$U.playTime,o$S._templet._calculateKeyFrame(o$i,o$x,o$n)}}},o$S._templet=null,o$S._reader=null,o$S._strings=[],o$T(o$S,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),o$S}(),o$mo=(function(){function o$o(){}o$k(o$o,"laya.ani.AnimationState"),o$o.stopped=0,o$o.paused=1,o$o.playing=2}(),function(){function o$W(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new o$ao,this.resultMatrix=new o$so,this._children=[]}o$k(o$W,"laya.ani.bone.Bone");var o$o=o$W.prototype;return o$o.setTempMatrix=function(o$o){this._tempMatrix=o$o;var o$r,o$T=0;for(o$T=0,o$r=this._children.length;o$T<o$r;o$T++)this._children[o$T].setTempMatrix(this._tempMatrix)},o$o.update=function(o$o){var o$r;if(this.rotation=this.transform.skX,o$o)o$r=this.resultTransform.getMatrix(),o$so.mul(o$r,o$o,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)o$r=this.resultTransform.getMatrix(),o$so.mul(o$r,this.parentBone.resultMatrix,this.resultMatrix);else{var o$T=this.parentBone,o$k=NaN,o$W=NaN,o$D=NaN,o$n=this.parentBone.resultMatrix;o$r=this.resultTransform.getMatrix();var o$V=o$n.a*o$r.tx+o$n.c*o$r.ty+o$n.tx,o$L=o$n.b*o$r.tx+o$n.d*o$r.ty+o$n.ty,o$U=new o$so;this.inheritRotation?(o$k=Math.atan2(o$T.resultMatrix.b,o$T.resultMatrix.a),o$W=Math.cos(o$k),o$D=Math.sin(o$k),o$U.setTo(o$W,o$D,-o$D,o$W,0,0),o$so.mul(this._tempMatrix,o$U,o$so.TEMP),o$so.TEMP.copyTo(o$U),o$r=this.resultTransform.getMatrix(),o$so.mul(o$r,o$U,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,o$r=this.resultTransform.getMatrix(),o$so.TEMP.identity(),o$so.TEMP.d=this.d,o$so.mul(o$r,o$so.TEMP,this.resultMatrix)),this.resultMatrix.tx=o$V,this.resultMatrix.ty=o$L}else(o$r=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var o$h,o$p=0;for(o$p=0,o$h=this._children.length;o$p<o$h;o$p++)this._children[o$p].update()},o$o.updateChild=function(){var o$o,o$r=0;for(o$r=0,o$o=this._children.length;o$r<o$o;o$r++)this._children[o$r].update()},o$o.setRotation=function(o$o){this._sprite&&(this._sprite.rotation=180*o$o/Math.PI)},o$o.updateDraw=function(o$o,o$r){o$W.ShowBones&&!o$W.ShowBones[this.name]||(this._sprite||(this._sprite=new o$Do,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),o$Wo.stage.addChild(this._sprite)),this._sprite.x=o$o+this.resultMatrix.tx,this._sprite.y=o$r+this.resultMatrix.ty);var o$T,o$k=0;for(o$k=0,o$T=this._children.length;o$k<o$T;o$k++)this._children[o$k].updateDraw(o$o,o$r)},o$o.addChild=function(o$o){this._children.push(o$o),o$o.parentBone=this},o$o.findBone=function(o$o){if(this.name==o$o)return this;var o$r,o$T,o$k=0;for(o$k=0,o$r=this._children.length;o$k<o$r;o$k++)if(o$T=this._children[o$k].findBone(o$o))return o$T;return null},o$o.localToWorld=function(o$o){var o$r=o$o[0],o$T=o$o[1];o$o[0]=o$r*this.resultMatrix.a+o$T*this.resultMatrix.c+this.resultMatrix.tx,o$o[1]=o$r*this.resultMatrix.b+o$T*this.resultMatrix.d+this.resultMatrix.ty},o$W.ShowBones={},o$W}()),o$Co=function(){function o$j(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}o$k(o$j,"laya.ani.bone.BoneSlot");var o$o=o$j.prototype;return o$o.showSlotData=function(o$o,o$r){void 0===o$r&&(o$r=!0),this.currSlotData=o$o,o$r&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},o$o.showDisplayByName=function(o$o){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(o$o))},o$o.replaceDisplayByName=function(o$o,o$r){if(this.currSlotData){var o$T;o$T=this.currSlotData.getDisplayByName(o$o);var o$k;o$k=this.currSlotData.getDisplayByName(o$r),this.replaceDisplayByIndex(o$T,o$k)}},o$o.replaceDisplayByIndex=function(o$o,o$r){this.currSlotData&&(this._replaceDic[o$o]=o$r,this.displayIndex==o$o&&this.showDisplayByIndex(o$o))},o$o.showDisplayByIndex=function(o$o){if(null!=this._replaceDic[o$o]&&(o$o=this._replaceDic[o$o]),this.currSlotData&&-1<o$o&&o$o<this.currSlotData.displayArr.length){if(this.displayIndex=o$o,this.currDisplayData=this.currSlotData.displayArr[o$o],this.currDisplayData){var o$r=this.currDisplayData.name;this.currTexture=this.templet.getTexture(o$r),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!o$_.isConchApp||o$_.isConchApp&&"0.9.15"<o$Do.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},o$o.replaceSkin=function(o$o){this._diyTexture=o$o,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},o$o.setParentMatrix=function(o$o){this._parentMatrix=o$o},o$o.draw=function(o$o,o$r,o$T,o$k){if(void 0===o$T&&(o$T=!1),void 0===o$k&&(o$k=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var o$W,o$D=this.currTexture;switch(this._diyTexture&&(o$D=this._diyTexture),this.currDisplayData.type){case 0:if(o$o){var o$n=this.getDisplayMatrix();if(this._parentMatrix){var o$V=!1;if(o$n){var o$L;if(o$so.mul(o$n,this._parentMatrix,o$so.TEMP),o$L=o$T?(null==this._resultMatrix&&(this._resultMatrix=new o$so),this._resultMatrix):new o$so,!o$_.isWebGL&&this.currDisplayData.uvs||o$_.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var o$U=o$j._tempMatrix;o$U.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(o$U.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(o$V=!0,o$U.rotate(-Math.PI/2)),o$so.mul(o$U,o$so.TEMP,o$L)}else o$so.TEMP.copyTo(o$L);o$V?o$o.drawTexture(o$D,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,o$L):o$o.drawTexture(o$D,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,o$L)}}}break;case 1:if(null==(o$W=o$T?(null==this._skinSprite&&(this._skinSprite=o$j.createSkinMesh()),this._skinSprite):o$j.createSkinMesh()))return;var o$h;if(null==this.currDisplayData.bones){var o$p,o$i=this.currDisplayData.weights;this.deformData&&(o$i=this.deformData),o$p=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=o$b.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=o$b.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=o$i;this.currDisplayData.triangles.length;o$h=this.currDisplayData.triangles,o$W.init2(o$D,null,o$h,this._mVerticleArr,o$p);var o$v,o$x=this.getDisplayMatrix();if(this._parentMatrix)if(o$x)o$so.mul(o$x,this._parentMatrix,o$so.TEMP),o$v=o$T?(null==this._resultMatrix&&(this._resultMatrix=new o$so),this._resultMatrix):new o$so,o$so.TEMP.copyTo(o$v),o$W.transform=o$v}else this.skinMesh(o$r,o$W,o$k);o$o.drawSkin(o$W);break;case 2:if(null==(o$W=o$T?(null==this._skinSprite&&(this._skinSprite=o$j.createSkinMesh()),this._skinSprite):o$j.createSkinMesh()))return;this.skinMesh(o$r,o$W,o$k),o$o.drawSkin(o$W)}}},o$o.skinMesh=function(o$o,o$r,o$T){var o$k,o$W=this.currTexture,o$D=this.currDisplayData.bones;o$k=this._diyTexture?(o$W=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=o$b.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=o$b.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var o$n,o$V,o$L=this.currDisplayData.weights,o$U=this.currDisplayData.triangles,o$h=0,o$p=0,o$i=0,o$v=NaN,o$x=NaN,o$j=0,o$_=0,o$K=[],o$$=0,o$y=0;if(this.deformData&&0<this.deformData.length){var o$l=0;for(o$$=0,o$y=o$D.length;o$$<o$y;){for(o$i=o$D[o$$++]+o$$,o$p=o$h=0;o$$<o$i;o$$++)o$V=o$o[o$D[o$$]],o$v=o$L[o$j]+this.deformData[o$l++],o$x=o$L[o$j+1]+this.deformData[o$l++],o$_=o$L[o$j+2],o$h+=(o$v*o$V.a+o$x*o$V.c+o$V.tx)*o$_,o$p+=(o$v*o$V.b+o$x*o$V.d+o$V.ty)*o$_,o$j+=3;o$K.push(o$h,o$p)}}else for(o$$=0,o$y=o$D.length;o$$<o$y;){for(o$i=o$D[o$$++]+o$$,o$p=o$h=0;o$$<o$i;o$$++)o$V=o$o[o$D[o$$]],o$v=o$L[o$j],o$x=o$L[o$j+1],o$_=o$L[o$j+2],o$h+=(o$v*o$V.a+o$x*o$V.c+o$V.tx)*o$_,o$p+=(o$v*o$V.b+o$x*o$V.d+o$V.ty)*o$_,o$j+=3;o$K.push(o$h,o$p)}this._mVerticleArr=o$K,o$n=o$U,o$r.init2(o$W,null,o$n,this._mVerticleArr,o$k)},o$o.drawBonePoint=function(o$o){o$o&&this._parentMatrix&&o$o.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},o$o.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},o$o.getMatrix=function(){return this._resultMatrix},o$o.copy=function(){var o$o=new o$j;return o$o.type="copy",o$o.name=this.name,o$o.attachmentName=this.attachmentName,o$o.srcDisplayIndex=this.srcDisplayIndex,o$o.parent=this.parent,o$o.displayIndex=this.displayIndex,o$o.templet=this.templet,o$o.currSlotData=this.currSlotData,o$o.currTexture=this.currTexture,o$o.currDisplayData=this.currDisplayData,o$o},o$j.createSkinMesh=function(){return o$_.isWebGL||o$_.isConchApp?o$v.skinAniSprite():(o$_.isWebGL,null)},o$T(o$j,["_tempMatrix",function(){return this._tempMatrix=new o$so}]),o$j}(),o$Xo=function(){function o$o(){this.skinName=null,this.deformSlotDataList=[]}return o$k(o$o,"laya.ani.bone.DeformAniData"),o$o}(),o$Oo=function(){function o$o(){this.deformSlotDisplayList=[]}return o$k(o$o,"laya.ani.bone.DeformSlotData"),o$o}(),o$Mo=function(){function o$o(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}o$k(o$o,"laya.ani.bone.DeformSlotDisplayData");var o$r=o$o.prototype;return o$r.binarySearch1=function(o$o,o$r){var o$T=0,o$k=o$o.length-2;if(0==o$k)return 1;for(var o$W=o$k>>>1;;){if(o$o[Math.floor(o$W+1)]<=o$r?o$T=o$W+1:o$k=o$W,o$T==o$k)return o$T+1;o$W=o$T+o$k>>>1}return 0},o$r.apply=function(o$o,o$r,o$T){if(void 0===o$T&&(o$T=1),o$o+=.05,!(this.timeList.length<=0)){var o$k=0;if(!(o$o<this.timeList[0])){var o$W=this.vectices[0].length,o$D=[],o$n=this.binarySearch1(this.timeList,o$o);if(this.frameIndex=o$n,o$o>=this.timeList[this.timeList.length-1]){var o$V=this.vectices[this.vectices.length-1];if(o$T<1)for(o$k=0;o$k<o$W;o$k++)o$D[o$k]+=(o$V[o$k]-o$D[o$k])*o$T;else for(o$k=0;o$k<o$W;o$k++)o$D[o$k]=o$V[o$k];this.deformData=o$D}else{this.tweenKeyList[this.frameIndex];var o$L=this.vectices[this.frameIndex-1],o$U=this.vectices[this.frameIndex],o$h=this.timeList[this.frameIndex-1],o$p=this.timeList[this.frameIndex];o$T=this.tweenKeyList[o$n-1]?(o$o-o$h)/(o$p-o$h):0;var o$i=NaN;for(o$k=0;o$k<o$W;o$k++)o$i=o$L[o$k],o$D[o$k]=o$i+(o$U[o$k]-o$i)*o$T;this.deformData=o$D}}}},o$o}(),o$co=function(){function o$o(){this.time=NaN,this.drawOrder=[]}return o$k(o$o,"laya.ani.bone.DrawOrderData"),o$o}(),o$eo=function(){function o$o(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return o$k(o$o,"laya.ani.bone.EventData"),o$o}(),o$$=function(){function o$ko(o$o,o$r){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=o$o,this._targetBone=o$r[o$o.targetBoneIndex],this.isSpine=o$o.isSpine,null==this._bones&&(this._bones=[]);for(var o$T=this._bones.length=0,o$k=o$o.boneIndexs.length;o$T<o$k;o$T++)this._bones.push(o$r[o$o.boneIndexs[o$T]]);this.name=o$o.name,this.mix=o$o.mix,this.bendDirection=o$o.bendDirection}o$k(o$ko,"laya.ani.bone.IkConstraint");var o$o=o$ko.prototype;return o$o.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},o$o._applyIk1=function(o$o,o$r,o$T,o$k){var o$W=o$o.parentBone,o$D=1/(o$W.resultMatrix.a*o$W.resultMatrix.d-o$W.resultMatrix.b*o$W.resultMatrix.c),o$n=o$r-o$W.resultMatrix.tx,o$V=o$T-o$W.resultMatrix.ty,o$L=(o$n*o$W.resultMatrix.d-o$V*o$W.resultMatrix.c)*o$D-o$o.transform.x,o$U=(o$V*o$W.resultMatrix.a-o$n*o$W.resultMatrix.b)*o$D-o$o.transform.y,o$h=Math.atan2(o$U,o$L)*o$ko.radDeg-0-o$o.transform.skX;o$o.transform.scX<0&&(o$h+=180),180<o$h?o$h-=360:o$h<-180&&(o$h+=360),o$o.transform.skX=o$o.transform.skY=o$o.transform.skX+o$h*o$k,o$o.update()},o$o.updatePos=function(o$o,o$r){this._sp&&this._sp.pos(o$o,o$r)},o$o._applyIk2=function(o$o,o$r,o$T,o$k,o$W,o$D){if(0!=o$D){var o$n=o$o.resultTransform.x,o$V=o$o.resultTransform.y,o$L=o$o.transform.scX,o$U=o$o.transform.scY,o$h=o$r.transform.scX,o$p=0,o$i=0,o$v=0;o$v=o$L<0?(o$L=-o$L,o$p=180,-1):(o$p=0,1),o$U<0&&(o$U=-o$U,o$v=-o$v),o$i=o$h<0?(o$h=-o$h,180):0;var o$x=o$r.resultTransform.x,o$j=NaN,o$_=NaN,o$K=NaN,o$$=o$o.resultMatrix.a,o$y=o$o.resultMatrix.c,o$l=o$o.resultMatrix.b,o$S=o$o.resultMatrix.d,o$q=Math.abs(o$L-o$U)<=1e-4;o$K=o$q?(o$_=o$$*o$x+o$y*(o$j=o$r.resultTransform.y)+o$o.resultMatrix.tx,o$l*o$x+o$S*o$j+o$o.resultMatrix.ty):(o$j=0,o$_=o$$*o$x+o$o.resultMatrix.tx,o$l*o$x+o$o.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new o$Do,o$Wo.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(o$T,o$k,15,"#ffff00"),this._sp.graphics.drawCircle(o$_,o$K,15,"#ff00ff")),o$o.setRotation(Math.atan2(o$K-o$o.resultMatrix.ty,o$_-o$o.resultMatrix.tx));var o$b=o$o.parentBone;o$$=o$b.resultMatrix.a,o$y=o$b.resultMatrix.c,o$l=o$b.resultMatrix.b;var o$F=1/(o$$*(o$S=o$b.resultMatrix.d)-o$y*o$l),o$P=o$T-o$b.resultMatrix.tx,o$t=o$k-o$b.resultMatrix.ty,o$H=(o$P*o$S-o$t*o$y)*o$F-o$n,o$R=(o$t*o$$-o$P*o$l)*o$F-o$V,o$u=((o$P=o$_-o$b.resultMatrix.tx)*o$S-(o$t=o$K-o$b.resultMatrix.ty)*o$y)*o$F-o$n,o$s=(o$t*o$$-o$P*o$l)*o$F-o$V,o$z=Math.sqrt(o$u*o$u+o$s*o$s),o$m=o$r.length*o$h,o$C=NaN,o$X=NaN;if(o$q){var o$O=(o$H*o$H+o$R*o$R-o$z*o$z-(o$m*=o$L)*o$m)/(2*o$z*o$m);o$O<-1?o$O=-1:1<o$O&&(o$O=1),o$X=Math.acos(o$O)*o$W,o$$=o$z+o$m*o$O,o$y=o$m*Math.sin(o$X),o$C=Math.atan2(o$R*o$$-o$H*o$y,o$H*o$$+o$R*o$y)}else{var o$M=(o$$=o$L*o$m)*o$$,o$c=(o$y=o$U*o$m)*o$y,o$e=o$H*o$H+o$R*o$R,o$J=Math.atan2(o$R,o$H),o$Y=-2*o$c*o$z,o$A=o$c-o$M;if(0<(o$S=o$Y*o$Y-4*o$A*(o$l=o$c*o$z*o$z+o$M*o$e-o$M*o$c))){var o$I=Math.sqrt(o$S);o$Y<0&&(o$I=-o$I);var o$N=(o$I=-(o$Y+o$I)/2)/o$A,o$f=o$l/o$I,o$a=Math.abs(o$N)<Math.abs(o$f)?o$N:o$f;o$a*o$a<=o$e&&(o$t=Math.sqrt(o$e-o$a*o$a)*o$W,o$C=o$J-Math.atan2(o$t,o$a),o$X=Math.atan2(o$t/o$U,(o$a-o$z)/o$L))}var o$G=0,o$w=Number.MAX_VALUE,o$Z=0,o$Q=0,o$g=0,o$B=0,o$E=0,o$d=0;o$B<(o$S=(o$P=o$z+o$$)*o$P)&&(o$g=0,o$B=o$S,o$E=o$P),(o$S=(o$P=o$z-o$$)*o$P)<o$w&&(o$G=Math.PI,o$w=o$S,o$Z=o$P);var o$oo=Math.acos(-o$$*o$z/(o$M-o$c));(o$S=(o$P=o$$*Math.cos(o$oo)+o$z)*o$P+(o$t=o$y*Math.sin(o$oo))*o$t)<o$w&&(o$G=o$oo,o$w=o$S,o$Z=o$P,o$Q=o$t),o$B<o$S&&(o$g=o$oo,o$B=o$S,o$E=o$P,o$d=o$t),o$X=o$e<=(o$w+o$B)/2?(o$C=o$J-Math.atan2(o$Q*o$W,o$Z),o$G*o$W):(o$C=o$J-Math.atan2(o$d*o$W,o$E),o$g*o$W)}var o$ro=Math.atan2(o$j,o$x)*o$v,o$To=o$o.resultTransform.skX;180<(o$C=(o$C-o$ro)*o$ko.radDeg+o$p-o$To)?o$C-=360:o$C<-180&&(o$C+=360),o$o.resultTransform.x=o$n,o$o.resultTransform.y=o$V,o$o.resultTransform.skX=o$o.resultTransform.skY=o$To+o$C*o$D,o$To=o$r.resultTransform.skX,180<(o$X=((o$X+o$ro)*o$ko.radDeg-0)*o$v+o$i-(o$To%=360))?o$X-=360:o$X<-180&&(o$X+=360),o$r.resultTransform.x=o$x,o$r.resultTransform.y=o$j,o$r.resultTransform.skX=o$r.resultTransform.skY=o$r.resultTransform.skY+o$X*o$D,o$o.update()}},o$o._applyIk3=function(o$o,o$r,o$T,o$k,o$W,o$D){if(0!=o$D){var o$n,o$V,o$L=o$r.resultMatrix.a*o$r.length,o$U=o$r.resultMatrix.b*o$r.length,o$h=o$L*o$L+o$U*o$U,o$p=Math.sqrt(o$h),o$i=o$o.resultMatrix.tx,o$v=o$o.resultMatrix.ty,o$x=o$r.resultMatrix.tx,o$j=o$r.resultMatrix.ty,o$_=o$x-o$i,o$K=o$j-o$v,o$$=o$_*o$_+o$K*o$K,o$y=Math.sqrt(o$$),o$l=(o$_=o$T-o$o.resultMatrix.tx)*o$_+(o$K=o$k-o$o.resultMatrix.ty)*o$K,o$S=Math.sqrt(o$l);if(o$p+o$y<=o$S||o$S+o$p<=o$y||o$S+o$y<=o$p){var o$q=NaN;o$x=o$i+(o$q=o$p+o$y<=o$S?1:-1)*(o$T-o$i)*o$y/o$S,o$j=o$v+o$q*(o$k-o$v)*o$y/o$S}else{var o$b=(o$$-o$h+o$l)/(2*o$l),o$F=Math.sqrt(o$$-o$b*o$b*o$l)/o$S,o$P=o$i+o$_*o$b,o$t=o$v+o$K*o$b,o$H=-o$K*o$F,o$R=o$_*o$F;o$j=0<o$W?(o$x=o$P-o$H,o$t-o$R):(o$x=o$P+o$H,o$t+o$R)}o$n=o$x,o$V=o$j,this.isDebug&&(this._sp||(this._sp=new o$Do,o$Wo.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(o$i,o$v,15,"#ff00ff"),this._sp.graphics.drawCircle(o$T,o$k,15,"#ffff00"),this._sp.graphics.drawCircle(o$n,o$V,15,"#ff00ff"));var o$u,o$s;o$u=Math.atan2(o$V-o$o.resultMatrix.ty,o$n-o$o.resultMatrix.tx),o$o.setRotation(o$u),(o$s=o$ko._tempMatrix).identity(),o$s.rotate(o$u),o$s.scale(o$o.resultMatrix.getScaleX(),o$o.resultMatrix.getScaleY()),o$s.translate(o$o.resultMatrix.tx,o$o.resultMatrix.ty),o$s.copyTo(o$o.resultMatrix),o$o.updateChild();var o$z,o$m;o$z=Math.atan2(o$k-o$V,o$T-o$n),o$r.setRotation(o$z),(o$m=o$ko._tempMatrix).identity(),o$m.rotate(o$z),o$m.scale(o$r.resultMatrix.getScaleX(),o$r.resultMatrix.getScaleY()),o$m.translate(o$n,o$V),o$s.copyTo(o$r.resultMatrix),o$r.updateChild()}},o$T(o$ko,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new o$so}]),o$ko}(),o$Jo=function(){function o$o(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return o$k(o$o,"laya.ani.bone.IkConstraintData"),o$o}(),o$S=function(){function o$m(o$o,o$r){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=o$o,this.position=o$o.position,this.spacing=o$o.spacing,this.rotateMix=o$o.rotateMix,this.translateMix=o$o.translateMix,this.bones=[];for(var o$T=this.data.bones,o$k=0,o$W=o$T.length;o$k<o$W;o$k++)this.bones.push(o$r[o$T[o$k]])}o$k(o$m,"laya.ani.bone.PathConstraint");var o$o=o$m.prototype;return o$o.apply=function(o$o,o$r){if(this.target){var o$T=this.translateMix,o$k=this.translateMix,o$W=0<o$k,o$D=this.data.spacingMode,o$n="length"==o$D,o$V=this.data.rotateMode,o$L="tangent"==o$V,o$U="chainScale"==o$V,o$h=[],o$p=this.bones.length,o$i=o$L?o$p:o$p+1,o$v=[];(this._spaces=o$v)[0]=this.position;var o$x=this.spacing;if(o$U||o$n)for(var o$j=0,o$_=o$i-1;o$j<o$_;){var o$K=this.bones[o$j],o$$=o$K.length,o$y=o$$*o$K.resultMatrix.a,o$l=o$$*o$K.resultMatrix.b;o$$=Math.sqrt(o$y*o$y+o$l*o$l),o$U&&(o$h[o$j]=o$$),o$v[++o$j]=o$n?Math.max(0,o$$+o$x):o$x}else for(o$j=1;o$j<o$i;o$j++)o$v[o$j]=o$x;var o$S=this.computeWorldPositions(this.target,o$o,o$r,o$i,o$L,"percent"==this.data.positionMode,"percent"==o$D);if(this._debugKey){for(o$j=0;o$j<o$S.length;o$j++)o$r.drawCircle(o$S[o$j++],o$S[o$j++],5,"#00ff00");var o$q=[];for(o$j=0;o$j<o$S.length;o$j++)o$q.push(o$S[o$j++],o$S[o$j++]);o$r.drawLines(0,0,o$q,"#ff0000")}var o$b=o$S[0],o$F=o$S[1],o$P=this.data.offsetRotation,o$t="chain"==o$V&&0==o$P,o$H=NaN;for(o$j=0,o$H=3;o$j<o$p;o$j++,o$H+=3){(o$K=this.bones[o$j]).resultMatrix.tx+=(o$b-o$K.resultMatrix.tx)*o$T,o$K.resultMatrix.ty+=(o$F-o$K.resultMatrix.ty)*o$T;var o$R=(o$y=o$S[o$H])-o$b,o$u=(o$l=o$S[o$H+1])-o$F;if(o$U&&0!=(o$$=o$h[o$j])){var o$s=(Math.sqrt(o$R*o$R+o$u*o$u)/o$$-1)*o$k+1;o$K.resultMatrix.a*=o$s,o$K.resultMatrix.c*=o$s}if(o$b=o$y,o$F=o$l,o$W){var o$z=o$K.resultMatrix.a,o$m=o$K.resultMatrix.c,o$C=o$K.resultMatrix.b,o$X=o$K.resultMatrix.d,o$O=NaN,o$M=NaN,o$c=NaN;o$O=o$L?o$S[o$H-1]:0==o$v[o$j+1]?o$S[o$H+2]:Math.atan2(o$u,o$R),o$O-=Math.atan2(o$C,o$z)-o$P/180*Math.PI,o$t&&(o$M=Math.cos(o$O),o$c=Math.sin(o$O),o$b+=((o$$=o$K.length)*(o$M*o$z-o$c*o$C)-o$R)*o$k,o$F+=(o$$*(o$c*o$z+o$M*o$C)-o$u)*o$k),o$O>Math.PI?o$O-=2*Math.PI:o$O<-Math.PI&&(o$O+=2*Math.PI),o$O*=o$k,o$M=Math.cos(o$O),o$c=Math.sin(o$O),o$K.resultMatrix.a=o$M*o$z-o$c*o$C,o$K.resultMatrix.c=o$M*o$m-o$c*o$X,o$K.resultMatrix.b=o$c*o$z+o$M*o$C,o$K.resultMatrix.d=o$c*o$m+o$M*o$X}}}},o$o.computeWorldVertices2=function(o$o,o$r,o$T,o$k,o$W,o$D){var o$n,o$V,o$L=o$o.currDisplayData.bones,o$U=o$o.currDisplayData.weights,o$h=o$o.currDisplayData.triangles,o$p=0,o$i=0,o$v=0,o$x=0,o$j=0,o$_=0,o$K=0,o$$=0,o$y=0,o$l=0,o$S=0;if(null!=o$L){for(o$p=0;o$p<o$T;o$p+=2)o$i+=(o$x=o$L[o$i])+1,o$v+=o$x;var o$q=o$r;for(o$j=o$D,o$_=3*o$v;o$j<o$k;o$j+=2){for(o$$=o$K=0,o$x=o$L[o$i++],o$x+=o$i;o$i<o$x;o$i++,o$_+=3){o$n=o$q[o$L[o$i]].resultMatrix,o$y=o$U[o$_],o$l=o$U[o$_+1];var o$b=o$U[o$_+2];o$K+=(o$y*o$n.a+o$l*o$n.c+o$n.tx)*o$b,o$$+=(o$y*o$n.b+o$l*o$n.d+o$n.ty)*o$b}o$W[o$j]=o$K,o$W[o$j+1]=o$$}}else{var o$F,o$P;if(o$h||(o$h=o$U),o$o.deformData&&(o$h=o$o.deformData),o$F=o$o.parent,o$r)for(o$S=o$r.length,o$p=0;o$p<o$S;o$p++)if(o$r[o$p].name==o$F){o$V=o$r[o$p];break}o$V&&(o$P=o$V.resultMatrix),o$P||(o$P=o$m._tempMt);var o$t=o$P.tx,o$H=o$P.ty,o$R=o$P.a,o$u=o$P.b,o$s=o$P.c,o$z=o$P.d;for(o$V&&(o$z*=o$V.d),o$i=o$T,o$j=o$D;o$j<o$k;o$i+=2,o$j+=2)o$y=o$h[o$i],o$l=o$h[o$i+1],o$W[o$j]=o$y*o$R+o$l*o$u+o$t,o$W[o$j+1]=-(o$y*o$s+o$l*o$z+o$H)}},o$o.computeWorldPositions=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n){o$o.currDisplayData.bones,o$o.currDisplayData.weights,o$o.currDisplayData.triangles;var o$V=[],o$L=0,o$U=o$o.currDisplayData.verLen,o$h=this.position,o$p=this._spaces,o$i=[],o$v=[],o$x=o$U/6,o$j=-1,o$_=NaN,o$K=0,o$$=0,o$y=NaN,o$l=NaN,o$S=NaN,o$q=NaN;if(o$x--,o$U-=4,this.computeWorldVertices2(o$o,o$r,2,o$U,o$V,0),this._debugKey)for(o$L=0;o$L<o$V.length;)o$T.drawCircle(o$V[o$L++],o$V[o$L++],10,"#ff0000");o$i=o$V,this._curves.length=o$x;var o$b=this._curves,o$F=o$i[o$_=0],o$P=o$i[1],o$t=0,o$H=0,o$R=0,o$u=0,o$s=0,o$z=0,o$m=NaN,o$C=NaN,o$X=NaN,o$O=NaN,o$M=NaN,o$c=NaN,o$e=NaN,o$J=NaN,o$Y=0;for(o$L=0,o$Y=2;o$L<o$x;o$L++,o$Y+=6)o$t=o$i[o$Y],o$H=o$i[o$Y+1],o$R=o$i[o$Y+2],o$u=o$i[o$Y+3],o$M=2*(o$m=.1875*(o$F-2*o$t+o$R))+(o$X=.09375*(3*(o$t-o$R)-o$F+(o$s=o$i[o$Y+4]))),o$c=2*(o$C=.1875*(o$P-2*o$H+o$u))+(o$O=.09375*(3*(o$H-o$u)-o$P+(o$z=o$i[o$Y+5]))),o$e=.75*(o$t-o$F)+o$m+.16666667*o$X,o$J=.75*(o$H-o$P)+o$C+.16666667*o$O,o$_+=Math.sqrt(o$e*o$e+o$J*o$J),o$e+=o$M,o$J+=o$c,o$M+=o$X,o$c+=o$O,o$_+=Math.sqrt(o$e*o$e+o$J*o$J),o$e+=o$M,o$J+=o$c,o$_+=Math.sqrt(o$e*o$e+o$J*o$J),o$e+=o$M+o$X,o$J+=o$c+o$O,o$_+=Math.sqrt(o$e*o$e+o$J*o$J),o$b[o$L]=o$_,o$F=o$s,o$P=o$z;if(o$D&&(o$h*=o$_),o$n)for(o$L=0;o$L<o$k;o$L++)o$p[o$L]*=o$_;var o$A=this._segments,o$I=0,o$N=0;for(o$N=o$$=o$K=o$L=0;o$L<o$k;o$L++,o$K+=3)if((o$y=o$h+=o$l=o$p[o$L])<0)this.addBeforePosition(o$y,o$i,0,o$v,o$K);else if(o$_<o$y)this.addAfterPosition(o$y-o$_,o$i,o$U-4,o$v,o$K);else{for(;;o$$++)if(!((o$q=o$b[o$$])<o$y)){0==o$$?o$y/=o$q:o$y=(o$y-(o$S=o$b[o$$-1]))/(o$q-o$S);break}if(o$$!=o$j){var o$f=6*(o$j=o$$);for(o$F=o$i[o$f],o$P=o$i[o$f+1],o$t=o$i[o$f+2],o$H=o$i[o$f+3],o$R=o$i[o$f+4],o$u=o$i[o$f+5],o$M=2*(o$m=.03*(o$F-2*o$t+o$R))+(o$X=.006*(3*(o$t-o$R)-o$F+(o$s=o$i[o$f+6]))),o$c=2*(o$C=.03*(o$P-2*o$H+o$u))+(o$O=.006*(3*(o$H-o$u)-o$P+(o$z=o$i[o$f+7]))),o$e=.3*(o$t-o$F)+o$m+.16666667*o$X,o$J=.3*(o$H-o$P)+o$C+.16666667*o$O,o$I=Math.sqrt(o$e*o$e+o$J*o$J),o$A[0]=o$I,o$f=1;o$f<8;o$f++)o$e+=o$M,o$J+=o$c,o$M+=o$X,o$c+=o$O,o$I+=Math.sqrt(o$e*o$e+o$J*o$J),o$A[o$f]=o$I;o$e+=o$M,o$J+=o$c,o$I+=Math.sqrt(o$e*o$e+o$J*o$J),o$A[8]=o$I,o$e+=o$M+o$X,o$J+=o$c+o$O,o$I+=Math.sqrt(o$e*o$e+o$J*o$J),o$A[9]=o$I,o$N=0}for(o$y*=o$I;;o$N++)if(!((o$q=o$A[o$N])<o$y)){0==o$N?o$y/=o$q:o$y=o$N+(o$y-(o$S=o$A[o$N-1]))/(o$q-o$S);break}this.addCurvePosition(.1*o$y,o$F,o$P,o$t,o$H,o$R,o$u,o$s,o$z,o$v,o$K,o$W||0<o$L&&0==o$l)}return o$v},o$o.addBeforePosition=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$r[o$T],o$n=o$r[o$T+1],o$V=o$r[o$T+2]-o$D,o$L=o$r[o$T+3]-o$n,o$U=Math.atan2(o$L,o$V);o$k[o$W]=o$D+o$o*Math.cos(o$U),o$k[o$W+1]=o$n+o$o*Math.sin(o$U),o$k[o$W+2]=o$U},o$o.addAfterPosition=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$r[o$T+2],o$n=o$r[o$T+3],o$V=o$D-o$r[o$T],o$L=o$n-o$r[o$T+1],o$U=Math.atan2(o$L,o$V);o$k[o$W]=o$D+o$o*Math.cos(o$U),o$k[o$W+1]=o$n+o$o*Math.sin(o$U),o$k[o$W+2]=o$U},o$o.addCurvePosition=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h,o$p){0==o$o&&(o$o=1e-4);var o$i=o$o*o$o,o$v=o$i*o$o,o$x=1-o$o,o$j=o$x*o$x,o$_=o$j*o$x,o$K=o$x*o$o,o$$=3*o$K,o$y=o$x*o$$,o$l=o$$*o$o,o$S=o$r*o$_+o$k*o$y+o$D*o$l+o$V*o$v,o$q=o$T*o$_+o$W*o$y+o$n*o$l+o$L*o$v;o$U[o$h]=o$S,o$U[o$h+1]=o$q,o$U[o$h+2]=o$p?Math.atan2(o$q-(o$T*o$j+o$W*o$K*2+o$n*o$i),o$S-(o$r*o$j+o$k*o$K*2+o$D*o$i)):0},o$m.NONE=-1,o$m.BEFORE=-2,o$m.AFTER=-3,o$T(o$m,["_tempMt",function(){return this._tempMt=new o$so}]),o$m}(),o$Yo=function(){function o$o(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return o$k(o$o,"laya.ani.bone.PathConstraintData"),o$o}(),o$Ao=function(){function o$o(){this.name=null,this.slotArr=[]}return o$k(o$o,"laya.ani.bone.SkinData"),o$o}(),o$Io=function(){function o$o(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}o$k(o$o,"laya.ani.bone.SkinSlotDisplayData");var o$r=o$o.prototype;return o$r.createTexture=function(o$o){return this.texture||(this.texture=new o$zo(o$o.bitmap,this.uvs),o$o.bitmap.alphaTexture&&(this.texture.alphaTexture=new o$zo(o$o.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=o$o.height,this.texture.height=o$o.width,this.texture.offsetX=-o$o.offsetX,this.texture.offsetY=-o$o.offsetY,this.texture.sourceWidth=o$o.sourceHeight,this.texture.sourceHeight=o$o.sourceWidth):(this.texture.width=o$o.width,this.texture.height=o$o.height,this.texture.offsetX=-o$o.offsetX,this.texture.offsetY=-o$o.offsetY,this.texture.sourceWidth=o$o.sourceWidth,this.texture.sourceHeight=o$o.sourceHeight),o$_.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},o$r.destory=function(){this.texture&&this.texture.destroy()},o$o}(),o$No=function(){function o$o(){this.name=null,this.displayArr=[]}return o$k(o$o,"laya.ani.bone.SlotData"),o$o.prototype.getDisplayByName=function(o$o){for(var o$r=0,o$T=this.displayArr.length;o$r<o$T;o$r++)if(this.displayArr[o$r].attachmentName==o$o)return o$r;return-1},o$o}(),o$q=function(){function o$o(o$o,o$r){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=o$j(2,0),this._data=o$o,null==this._bones&&(this._bones=[]),this.target=o$r[o$o.targetIndex];var o$T,o$k=0;for(o$k=0,o$T=o$o.boneIndexs.length;o$k<o$T;o$k++)this._bones.push(o$r[o$o.boneIndexs[o$k]]);this.rotateMix=o$o.rotateMix,this.translateMix=o$o.translateMix,this.scaleMix=o$o.scaleMix,this.shearMix=o$o.shearMix}return o$k(o$o,"laya.ani.bone.TfConstraint"),o$o.prototype.apply=function(){for(var o$o,o$r=this.target.resultMatrix.a,o$T=this.target.resultMatrix.b,o$k=this.target.resultMatrix.c,o$W=this.target.resultMatrix.d,o$D=0,o$n=this._bones.length;o$D<o$n;o$D++){if(o$o=this._bones[o$D],0<this.rotateMix){var o$V=o$o.resultMatrix.a,o$L=o$o.resultMatrix.b,o$U=o$o.resultMatrix.c,o$h=o$o.resultMatrix.d,o$p=Math.atan2(o$k,o$r)-Math.atan2(o$U,o$V)+this._data.offsetRotation*Math.PI/180;o$p>Math.PI?o$p-=2*Math.PI:o$p<-Math.PI&&(o$p+=2*Math.PI),o$p*=this.rotateMix;var o$i=Math.cos(o$p),o$v=Math.sin(o$p);o$o.resultMatrix.a=o$i*o$V-o$v*o$U,o$o.resultMatrix.b=o$i*o$L-o$v*o$h,o$o.resultMatrix.c=o$v*o$V+o$i*o$U,o$o.resultMatrix.d=o$v*o$L+o$i*o$h}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),o$o.resultMatrix.tx+=(this._temp[0]-o$o.resultMatrix.tx)*this.translateMix,o$o.resultMatrix.ty+=(this._temp[1]-o$o.resultMatrix.ty)*this.translateMix,o$o.updateChild()),0<this.scaleMix){var o$x=Math.sqrt(o$o.resultMatrix.a*o$o.resultMatrix.a+o$o.resultMatrix.c*o$o.resultMatrix.c),o$j=Math.sqrt(o$r*o$r+o$k*o$k),o$_=1e-5<o$x?(o$x+(o$j-o$x+this._data.offsetScaleX)*this.scaleMix)/o$x:0;o$o.resultMatrix.a*=o$_,o$o.resultMatrix.c*=o$_,o$x=Math.sqrt(o$o.resultMatrix.b*o$o.resultMatrix.b+o$o.resultMatrix.d*o$o.resultMatrix.d),o$j=Math.sqrt(o$T*o$T+o$W*o$W),o$_=1e-5<o$x?(o$x+(o$j-o$x+this._data.offsetScaleY)*this.scaleMix)/o$x:0,o$o.resultMatrix.b*=o$_,o$o.resultMatrix.d*=o$_}if(0<this.shearMix){o$L=o$o.resultMatrix.b,o$h=o$o.resultMatrix.d;var o$K=Math.atan2(o$h,o$L);(o$p=Math.atan2(o$W,o$T)-Math.atan2(o$k,o$r)-(o$K-Math.atan2(o$o.resultMatrix.c,o$o.resultMatrix.a)))>Math.PI?o$p-=2*Math.PI:o$p<-Math.PI&&(o$p+=2*Math.PI),o$p=o$K+(o$p+this._data.offsetShearY*Math.PI/180)*this.shearMix,o$_=Math.sqrt(o$L*o$L+o$h*o$h),o$o.resultMatrix.b=Math.cos(o$p)*o$_,o$o.resultMatrix.d=Math.sin(o$p)*o$_}}},o$o}(),o$fo=function(){function o$o(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return o$k(o$o,"laya.ani.bone.TfConstraintData"),o$o}(),o$ao=function(){function o$o(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}o$k(o$o,"laya.ani.bone.Transform");var o$r=o$o.prototype;return o$r.initData=function(o$o){null!=o$o.x&&(this.x=o$o.x),null!=o$o.y&&(this.y=o$o.y),null!=o$o.skX&&(this.skX=o$o.skX),null!=o$o.skY&&(this.skY=o$o.skY),null!=o$o.scX&&(this.scX=o$o.scX),null!=o$o.scY&&(this.scY=o$o.scY)},o$r.getMatrix=function(){var o$o;return(o$o=this.mMatrix?this.mMatrix:this.mMatrix=new o$so).identity(),o$o.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(o$o,this.skewX*Math.PI/180,this.skewY*Math.PI/180),o$o.rotate(this.skX*Math.PI/180),o$o.translate(this.x,this.y),o$o},o$r.skew=function(o$o,o$r,o$T){var o$k=Math.sin(o$T),o$W=Math.cos(o$T),o$D=Math.sin(o$r),o$n=Math.cos(o$r);return o$o.setTo(o$o.a*o$n-o$o.b*o$k,o$o.a*o$D+o$o.b*o$W,o$o.c*o$n-o$o.d*o$k,o$o.c*o$D+o$o.d*o$W,o$o.tx*o$n-o$o.ty*o$k,o$o.tx*o$D+o$o.ty*o$W),o$o},o$o}(),o$b=function(){function o$o(){}return o$k(o$o,"laya.ani.bone.UVTools"),o$o.getRelativeUV=function(o$o,o$r,o$T){var o$k=o$o[0],o$W=o$o[2]-o$o[0],o$D=o$o[1],o$n=o$o[5]-o$o[1];o$T||(o$T=[]),o$T.length=o$r.length;var o$V,o$L=0;o$V=o$T.length;var o$U=1/o$W,o$h=1/o$n;for(o$L=0;o$L<o$V;o$L+=2)o$T[o$L]=(o$r[o$L]-o$k)*o$U,o$T[o$L+1]=(o$r[o$L+1]-o$D)*o$h;return o$T},o$o.getAbsoluteUV=function(o$o,o$r,o$T){if(0==o$o[0]&&0==o$o[1]&&1==o$o[4]&&1==o$o[5])return o$T?(o$K.copyArray(o$T,o$r),o$T):o$r;var o$k=o$o[0],o$W=o$o[2]-o$o[0],o$D=o$o[1],o$n=o$o[5]-o$o[1];o$T||(o$T=[]),o$T.length=o$r.length;var o$V,o$L=0;for(o$V=o$T.length,o$L=0;o$L<o$V;o$L+=2)o$T[o$L]=o$r[o$L]*o$W+o$k,o$T[o$L+1]=o$r[o$L+1]*o$n+o$D;return o$T},o$o}(),o$m=function(){function o$o(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return o$k(o$o,"laya.ani.KeyFramesContent"),o$o}(),o$F=function(){function o$h(){}return o$k(o$h,"laya.ani.math.BezierLerp"),o$h.getBezierRate=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$h._getBezierParamKey(o$r,o$T,o$k,o$W),o$n=100*o$D+o$o;if(o$h._bezierResultCache[o$n])return o$h._bezierResultCache[o$n];var o$V,o$L=o$h._getBezierPoints(o$r,o$T,o$k,o$W,o$D),o$U=0;for(o$V=o$L.length,o$U=0;o$U<o$V;o$U+=2)if(o$o<=o$L[o$U])return o$h._bezierResultCache[o$n]=o$L[o$U+1],o$L[o$U+1];return o$h._bezierResultCache[o$n]=1},o$h._getBezierParamKey=function(o$o,o$r,o$T,o$k){return 100*(100*(100*(100*o$o+o$r)+o$T)+o$k)},o$h._getBezierPoints=function(o$o,o$r,o$T,o$k,o$W){return o$h._bezierPointsCache[o$W]?o$h._bezierPointsCache[o$W]:(o$D=[0,0,o$o,o$r,o$T,o$k,1,1],o$n=(new o$V).getBezierPoints(o$D,100,3),o$h._bezierPointsCache[o$W]=o$n);var o$D,o$n},o$h._bezierResultCache={},o$h._bezierPointsCache={},o$h}(),o$P=function(o$o){function o$r(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,o$r.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}o$k(o$r,"laya.ani.AnimationPlayer",o$W);var o$T=o$r.prototype;return o$Wo.imps(o$T,{"laya.resource.IDestroy":!0}),o$T._onTempletLoadedComputeFullKeyframeIndices=function(o$o,o$r,o$T){this._templet===o$T&&this._cachePlayRate===o$o&&this._cacheFrameRate===o$r&&this._computeFullKeyframeIndices()},o$T._computeFullKeyframeIndices=function(){for(var o$o=this._fullFrames=[],o$r=this._templet,o$T=this._cacheFrameRateInterval*this._cachePlayRate,o$k=0,o$W=o$r.getAnimationCount();o$k<o$W;o$k++){for(var o$D=[],o$n=0,o$V=o$r.getAnimation(o$k).nodes.length;o$n<o$V;o$n++){for(var o$L=o$r.getAnimation(o$k).nodes[o$n],o$U=Math.floor(o$L.playTime/o$T+.01),o$h=new Uint16Array(o$U+1),o$p=-1,o$i=0,o$v=o$L.keyFrame.length;o$i<o$v;o$i++){var o$x=o$L.keyFrame[o$i],o$j=o$x.startTime,o$_=o$j+o$x.duration+o$T;do{for(var o$K=Math.floor(o$j/o$T+.5),o$$=o$p+1;o$$<o$K;o$$++)o$h[o$$]=o$i;o$h[o$p=o$K]=o$i,o$j+=o$T}while(o$j<=o$_)}o$D.push(o$h)}o$o.push(o$D)}},o$T._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},o$T._calculatePlayDuration=function(){if(0!==this.state){var o$o=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=o$o),this._playEnd>o$o&&(this._playEnd=o$o),this._playDuration=this._playEnd-this._playStart}},o$T._setPlayParams=function(o$o,o$r){this._currentTime=o$o,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/o$r+.01),0),this._currentFrameTime=this._currentKeyframeIndex*o$r},o$T._setPlayParamsWhenStop=function(o$o,o$r){this._currentTime=o$o,this._currentKeyframeIndex=Math.max(Math.floor(o$o/o$r+.01),0),this._currentFrameTime=this._currentKeyframeIndex*o$r,this._currentAnimationClipIndex=-1},o$T._update=function(o$o){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var o$r=this._cacheFrameRateInterval*this._cachePlayRate,o$T=0;this._startUpdateLoopCount!==o$x.loopCount&&(o$T=o$o*this.playbackRate,this._elapsedPlaybackTime+=o$T);var o$k=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=o$k)return this._setPlayParamsWhenStop(o$k,o$r),void this.event("stopped");if(o$T+=this._currentTime,0<o$k)if(o$k<=o$T)do{if(o$T-=o$k,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(o$k,o$r),this._stopWhenCircleFinish=!1,void this.event("stopped");o$T<o$k&&(this._setPlayParams(o$T,o$r),this.event("complete"))}while(o$k<=o$T);else this._setPlayParams(o$T,o$r);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(o$k,o$r),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},o$T._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},o$T.play=function(o$o,o$r,o$T,o$k,o$W){if(void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=1),void 0===o$T&&(o$T=2147483647),void 0===o$k&&(o$k=0),void 0===o$W&&(o$W=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(o$T<0||o$k<0||o$W<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==o$W&&o$W<o$k)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=o$r,this._overallDuration=o$T,this._playStart=o$k,this._playEnd=o$W,this._paused=!1,this._currentAnimationClipIndex=o$o,this._currentKeyframeIndex=0,this._startUpdateLoopCount=o$x.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},o$T.playByFrame=function(o$o,o$r,o$T,o$k,o$W,o$D){void 0===o$o&&(o$o=0),void 0===o$r&&(o$r=1),void 0===o$T&&(o$T=2147483647),void 0===o$k&&(o$k=0),void 0===o$W&&(o$W=0),void 0===o$D&&(o$D=30);var o$n=1e3/o$D;this.play(o$o,o$r,o$T,o$k*o$n,o$W*o$n)},o$T.stop=function(o$o){void 0===o$o&&(o$o=!0),o$o?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},o$D(0,o$T,"playEnd",function(){return this._playEnd}),o$D(0,o$T,"templet",function(){return this._templet},function(o$o){0===!this.state&&this.stop(!0),this._templet!==o$o&&((this._templet=o$o).loaded?this._computeFullKeyframeIndices():o$o.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),o$D(0,o$T,"playStart",function(){return this._playStart}),o$D(0,o$T,"playDuration",function(){return this._playDuration}),o$D(0,o$T,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),o$D(0,o$T,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),o$D(0,o$T,"overallDuration",function(){return this._overallDuration}),o$D(0,o$T,"currentFrameTime",function(){return this._currentFrameTime}),o$D(0,o$T,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),o$D(0,o$T,"currentPlayTime",function(){return this._currentTime+this._playStart}),o$D(0,o$T,"cachePlayRate",function(){return this._cachePlayRate},function(o$o){this._cachePlayRate!==o$o&&(this._cachePlayRate=o$o,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[o$o,this._cacheFrameRate])))}),o$D(0,o$T,"cacheFrameRate",function(){return this._cacheFrameRate},function(o$o){this._cacheFrameRate!==o$o&&(this._cacheFrameRate=o$o,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,o$o])))}),o$D(0,o$T,"currentTime",null,function(o$o){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(o$o<this._playStart||o$o>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=o$x.loopCount;var o$r=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=o$o,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/o$r),0),this._currentFrameTime=this._currentKeyframeIndex*o$r}}),o$D(0,o$T,"paused",function(){return this._paused},function(o$o){(this._paused=o$o)&&this.event("paused")}),o$D(0,o$T,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),o$D(0,o$T,"destroyed",function(){return this._destroyed}),o$r}(),o$C=function(o$o){function o$r(){o$r.__super.call(this),o$_.isConchNode&&(this.drawSkin=function(o$o){o$o.transform||(o$o.transform=o$so.EMPTY),this._addCmd([o$o]),this.setSkinMesh&&this.setSkinMesh(o$o._ps,o$o.mVBData,o$o.mEleNum,0,o$o.mTexture,o$o.transform)})}return o$k(o$r,"laya.ani.GraphicsAni",o$n),o$r.prototype.drawSkin=function(o$o){var o$r=[o$o];this._saveToCmd(o$_._context._drawSkin,o$r)},o$r.create=function(){return o$r._caches.pop()||new o$r},o$r.recycle=function(o$o){o$o.clear(),o$r._caches.push(o$o)},o$r._caches=[],o$r}(),o$X=function(o$o){function o$$(){this._aniMap={},this.unfixedLastAniIndex=-1,o$$.__super.call(this),this._anis=new Array}o$k(o$$,"laya.ani.AnimationTemplet",o$h);var o$r=o$$.prototype;return o$r.parse=function(o$o){var o$r=new o$uo(o$o);this._aniVersion=o$r.readUTFString(),o$y.parse(this,o$r)},o$r._calculateKeyFrame=function(o$o,o$r,o$T){var o$k=o$o.keyFrame;o$k[o$r]=o$k[0];for(var o$W=0;o$W<o$r;o$W++){var o$D=o$k[o$W];o$D.nextData=0===o$D.duration?o$D.data:o$k[o$W+1].data}o$k.length--},o$r.onAsynLoaded=function(o$o,o$r,o$T){var o$k=new o$uo(o$r);switch(this._aniVersion=o$k.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":o$l.parse(this,o$k);break;default:o$y.parse(this,o$k)}this._endLoaded()},o$r.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},o$r.getAnimationCount=function(){return this._anis.length},o$r.getAnimation=function(o$o){return this._anis[o$o]},o$r.getAniDuration=function(o$o){return this._anis[o$o].playTime},o$r.getNodes=function(o$o){return this._anis[o$o].nodes},o$r.getNodeIndexWithName=function(o$o,o$r){return this._anis[o$o].bone3DMap[o$r]},o$r.getNodeCount=function(o$o){return this._anis[o$o].nodes.length},o$r.getTotalkeyframesLength=function(o$o){return this._anis[o$o].totalKeyframeDatasLength},o$r.getPublicExtData=function(){return this._publicExtData},o$r.getAnimationDataWithCache=function(o$o,o$r,o$T,o$k){var o$W=o$r[o$T];if(o$W){var o$D=o$W[o$o];return o$D?o$D[o$k]:null}return null},o$r.setAnimationDataWithCache=function(o$o,o$r,o$T,o$k,o$W){var o$D=o$r[o$T]||(o$r[o$T]={});(o$D[o$o]||(o$D[o$o]=[]))[o$k]=o$W},o$r.getOriginalData=function(o$o,o$r,o$T,o$k,o$W){for(var o$D=this._anis[o$o].nodes,o$n=0,o$V=0,o$L=o$D.length,o$U=0;o$V<o$L;o$V++){var o$h,o$p=o$D[o$V];o$h=o$p.keyFrame[o$T[o$V][o$k]],o$p.dataOffset=o$U;var o$i=o$W-o$h.startTime,o$v=o$p.lerpType;if(o$v)switch(o$v){case 0:case 1:for(o$n=0;o$n<o$p.keyframeWidth;)o$n+=o$p.interpolationMethod[o$n](o$p,o$n,o$r,o$U+o$n,o$h.data,o$i,null,o$h.duration,o$h.nextData);break;case 2:var o$x=o$h.interpolationData,o$j=o$x.length,o$_=0;for(o$n=0;o$n<o$j;){var o$K=o$x[o$n];switch(o$K){case 6:case 7:o$n+=o$$.interpolation[o$K](o$p,o$_,o$r,o$U+o$_,o$h.data,o$i,null,o$h.duration,o$h.nextData,o$x,o$n+1);break;default:o$n+=o$$.interpolation[o$K](o$p,o$_,o$r,o$U+o$_,o$h.data,o$i,null,o$h.duration,o$h.nextData)}o$_++}}else for(o$n=0;o$n<o$p.keyframeWidth;)o$n+=o$p.interpolationMethod[o$n](o$p,o$n,o$r,o$U+o$n,o$h.data,o$i,null,o$h.duration,o$h.nextData);o$U+=o$p.keyframeWidth}},o$r.getNodesCurrentFrameIndex=function(o$o,o$r){var o$T=this._anis[o$o].nodes;o$o!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(o$T.length),this.unfixedCurrentTimes=new Float32Array(o$T.length),this.unfixedLastAniIndex=o$o);for(var o$k=0,o$W=o$T.length;o$k<o$W;o$k++){var o$D=o$T[o$k];for(o$r<this.unfixedCurrentTimes[o$k]&&(this.unfixedCurrentFrameIndexes[o$k]=0),this.unfixedCurrentTimes[o$k]=o$r;this.unfixedCurrentFrameIndexes[o$k]<o$D.keyFrame.length&&!(o$D.keyFrame[this.unfixedCurrentFrameIndexes[o$k]].startTime>this.unfixedCurrentTimes[o$k]);)this.unfixedCurrentFrameIndexes[o$k]++;this.unfixedCurrentFrameIndexes[o$k]--}return this.unfixedCurrentFrameIndexes},o$r.getOriginalDataUnfixedRate=function(o$o,o$r,o$T){var o$k=this._anis[o$o].nodes;o$o!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(o$k.length),this.unfixedCurrentTimes=new Float32Array(o$k.length),this.unfixedKeyframes=o$j(o$k.length),this.unfixedLastAniIndex=o$o);for(var o$W=0,o$D=0,o$n=o$k.length,o$V=0;o$D<o$n;o$D++){var o$L=o$k[o$D];for(o$T<this.unfixedCurrentTimes[o$D]&&(this.unfixedCurrentFrameIndexes[o$D]=0),this.unfixedCurrentTimes[o$D]=o$T;this.unfixedCurrentFrameIndexes[o$D]<o$L.keyFrame.length&&!(o$L.keyFrame[this.unfixedCurrentFrameIndexes[o$D]].startTime>this.unfixedCurrentTimes[o$D]);)this.unfixedKeyframes[o$D]=o$L.keyFrame[this.unfixedCurrentFrameIndexes[o$D]],this.unfixedCurrentFrameIndexes[o$D]++;var o$U=this.unfixedKeyframes[o$D];o$L.dataOffset=o$V;var o$h=o$T-o$U.startTime;if(o$L.lerpType)switch(o$L.lerpType){case 0:case 1:for(o$W=0;o$W<o$L.keyframeWidth;)o$W+=o$L.interpolationMethod[o$W](o$L,o$W,o$r,o$V+o$W,o$U.data,o$h,null,o$U.duration,o$U.nextData);break;case 2:var o$p=o$U.interpolationData,o$i=o$p.length,o$v=0;for(o$W=0;o$W<o$i;){var o$x=o$p[o$W];switch(o$x){case 6:case 7:o$W+=o$$.interpolation[o$x](o$L,o$v,o$r,o$V+o$v,o$U.data,o$h,null,o$U.duration,o$U.nextData,o$p,o$W+1);break;default:o$W+=o$$.interpolation[o$x](o$L,o$v,o$r,o$V+o$v,o$U.data,o$h,null,o$U.duration,o$U.nextData)}o$v++}}else for(o$W=0;o$W<o$L.keyframeWidth;)o$W+=o$L.interpolationMethod[o$W](o$L,o$W,o$r,o$V+o$W,o$U.data,o$h,null,o$U.duration,o$U.nextData);o$V+=o$L.keyframeWidth}},o$$._LinearInterpolation_0=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){var o$h=0===o$V?0:o$D/o$V;return o$T[o$k]=(1-o$h)*o$W[o$r]+o$h*o$L[o$r],1},o$$._QuaternionInterpolation_1=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){var o$h=0===o$V?0:o$D/o$V;return o$i.slerpQuaternionArray(o$W,o$r,o$L,o$r,o$h,o$T,o$k),4},o$$._AngleInterpolation_2=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){return 0},o$$._RadiansInterpolation_3=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){return 0},o$$._Matrix4x4Interpolation_4=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){for(var o$h=0;o$h<16;o$h++,o$r++)o$T[o$k+o$h]=o$W[o$r]+o$D*o$n[o$r];return 16},o$$._NoInterpolation_5=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U){return o$T[o$k]=o$W[o$r],1},o$$._BezierInterpolation_6=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h){return void 0===o$h&&(o$h=0),o$T[o$k]=o$W[o$r]+(o$L[o$r]-o$W[o$r])*o$F.getBezierRate(o$D/o$V,o$U[o$h],o$U[o$h+1],o$U[o$h+2],o$U[o$h+3]),5},o$$._BezierInterpolation_7=function(o$o,o$r,o$T,o$k,o$W,o$D,o$n,o$V,o$L,o$U,o$h){return void 0===o$h&&(o$h=0),o$T[o$k]=o$U[o$h+4]+o$U[o$h+5]*o$F.getBezierRate((.001*o$D+o$U[o$h+6])/o$U[o$h+7],o$U[o$h],o$U[o$h+1],o$U[o$h+2],o$U[o$h+3]),9},o$$.load=function(o$o){return o$Wo.loader.create(o$o,null,null,o$$)},o$$.interpolation=[o$$._LinearInterpolation_0,o$$._QuaternionInterpolation_1,o$$._AngleInterpolation_2,o$$._RadiansInterpolation_3,o$$._Matrix4x4Interpolation_4,o$$._NoInterpolation_5,o$$._BezierInterpolation_6,o$$._BezierInterpolation_7],o$$}(),o$t=function(o$r){function o$T(o$o,o$r){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,o$T.__super.call(this),void 0===o$r&&(o$r=0),o$o&&this.init(o$o,o$r)}o$k(o$T,"laya.ani.bone.Skeleton",o$r);var o$o=o$T.prototype;return o$o.init=function(o$o,o$r){void 0===o$r&&(o$r=0);var o$T,o$k,o$W,o$D=0,o$n=0;if(1==o$r)for(this._graphicsCache=[],o$D=0,o$n=o$o.getAnimationCount();o$D<o$n;o$D++)this._graphicsCache.push([]);if(this._yReverseMatrix=o$o.yReverseMatrix,this._aniMode=o$r,this._templet=o$o,this._player=new o$P,this._player.cacheFrameRate=o$o.rate,this._player.templet=o$o,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=o$o.mBoneArr,this._rootBone=o$o.mRootBone,this._aniSectionDic=o$o.aniSectionDic,0<o$o.ikArr.length)for(this._ikArr=[],o$D=0,o$n=o$o.ikArr.length;o$D<o$n;o$D++)this._ikArr.push(new o$$(o$o.ikArr[o$D],this._boneList));if(0<o$o.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),o$D=0,o$n=o$o.pathArr.length;o$D<o$n;o$D++)o$T=o$o.pathArr[o$D],o$k=new o$S(o$T,this._boneList),(o$W=this._boneSlotDic[o$T.name])&&((o$k=new o$S(o$T,this._boneList)).target=o$W),this._pathDic[o$T.name]=o$k;if(0<o$o.tfArr.length)for(this._tfArr=[],o$D=0,o$n=o$o.tfArr.length;o$D<o$n;o$D++)this._tfArr.push(new o$q(o$o.tfArr[o$D],this._boneList));if(0<o$o.skinDataArray.length){var o$V=this._templet.skinDataArray[this._skinIndex];this._skinName=o$V.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},o$o.load=function(o$o,o$r,o$T){},o$o._onLoaded=function(){},o$o._parseComplete=function(){var o$o=o$H.TEMPLET_DICTIONARY[this._aniPath];o$o&&(this.init(o$o,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},o$o._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},o$o._onPlay=function(){this.event("played")},o$o._onStop=function(){var o$o,o$r=this._templet.eventAniArr[this._aniClipIndex];if(o$r&&this._eventIndex<o$r.length)for(;this._eventIndex<o$r.length;this._eventIndex++)(o$o=o$r[this._eventIndex]).time>=this._player.playStart&&o$o.time<=this._player.playEnd&&this.event("label",o$o);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},o$o._onPause=function(){this.event("paused")},o$o._parseSrcBoneMatrix=function(){var o$o=0,o$r=0;for(o$r=this._templet.srcBoneMatrixArr.length,o$o=0;o$o<o$r;o$o++)this._boneMatrixArray.push(new o$so);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var o$T,o$k,o$W=this._templet.boneSlotArray;for(o$o=0,o$r=o$W.length;o$o<o$r;o$o++)o$T=o$W[o$o],null==(o$k=this._bindBoneBoneSlotDic[o$T.parent])&&(this._bindBoneBoneSlotDic[o$T.parent]=o$k=[]),this._boneSlotDic[o$T.name]=o$T=o$T.copy(),o$k.push(o$T),this._boneSlotArray.push(o$T)}},o$o._emitMissedEvents=function(o$o,o$r,o$T){void 0===o$T&&(o$T=0);var o$k=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(o$k){var o$W,o$D,o$n=0;for(o$W=o$k.length,o$n=o$T;o$n<o$W;o$n++)(o$D=o$k[o$n]).time>=this._player.playStart&&o$D.time<=this._player.playEnd&&this.event("label",o$D)}},o$o._update=function(o$o){if(void 0===o$o&&(o$o=!0),!(this._pause||o$o&&this._indexControl)){var o$r=this.timer.currTimer,o$T=this._player.currentKeyframeIndex,o$k=o$r-this._lastTime;if(o$o?this._player._update(o$k):o$T=-1,this._lastTime=o$r,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<o$k&&this._clipIndex==o$T&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var o$W;this._lastUpdateAniClipIndex=this._aniClipIndex,o$T>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var o$D,o$n=this._templet.eventAniArr[this._aniClipIndex];if(o$n&&this._eventIndex<o$n.length&&((o$W=o$n[this._eventIndex]).time>=this._player.playStart&&o$W.time<=this._player.playEnd?this._player.currentPlayTime>=o$W.time&&(this.event("label",o$W),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(o$D=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=o$D&&(this.graphics=o$D));var o$V=0,o$L=0;for(o$L=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,o$L-1)&&0<o$L;)o$L--;if(o$L<this._clipIndex)for(o$V=o$L;o$V<this._clipIndex;o$V++)this._createGraphics(o$V)}else if(1==this._aniMode){if(o$D=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=o$D&&(this.graphics=o$D));for(o$L=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,o$L-1)&&0<o$L;)o$L--;if(o$L<this._clipIndex)for(o$V=o$L;o$V<this._clipIndex;o$V++)this._createGraphics(o$V)}this._createGraphics()}}},o$o._createGraphics=function(o$o){void 0===o$o&&(o$o=-1),-1==o$o&&(o$o=this._clipIndex);var o$r,o$T,o$k=o$o*this._player.cacheFrameRateInterval,o$W=this._templet.drawOrderAniArr[this._aniClipIndex];if(o$W&&0<o$W.length)for(this._drawOrderIndex=0,o$r=o$W[this._drawOrderIndex];o$k>=o$r.time&&(this._drawOrder=o$r.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=o$W.length));)o$r=o$W[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=o$C.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=o$C.create(),o$T=this.graphics;var o$D=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],o$o,o$k);var o$n,o$V,o$L,o$U,o$h=this._aniSectionDic[this._aniClipIndex],o$p=0,o$i=0,o$v=0,o$x=0,o$j=0,o$_=this._templet.srcBoneMatrixArr.length;for(o$j=o$h[o$i=0];o$i<o$_;o$i++)o$U=this._boneList[o$i],o$L=this._templet.srcBoneMatrixArr[o$i],o$U.resultTransform.scX=o$L.scX*this._curOriginalData[o$p++],o$U.resultTransform.skX=o$L.skX+this._curOriginalData[o$p++],o$U.resultTransform.skY=o$L.skY+this._curOriginalData[o$p++],o$U.resultTransform.scY=o$L.scY*this._curOriginalData[o$p++],o$U.resultTransform.x=o$L.x+this._curOriginalData[o$p++],o$U.resultTransform.y=o$L.y+this._curOriginalData[o$p++],8===this._templet.tMatrixDataLen&&(o$U.resultTransform.skewX=o$L.skewX+this._curOriginalData[o$p++],o$U.resultTransform.skewY=o$L.skewY+this._curOriginalData[o$p++]);var o$K,o$$={},o$y={};for(o$j+=o$h[1];o$i<o$j;o$i++)o$$[(o$K=o$D[o$i]).name]=this._curOriginalData[o$p++],o$y[o$K.name]=this._curOriginalData[o$p++],this._curOriginalData[o$p++],this._curOriginalData[o$p++],this._curOriginalData[o$p++],this._curOriginalData[o$p++];var o$l,o$S,o$q={},o$b={};for(o$j+=o$h[2];o$i<o$j;o$i++)o$q[(o$K=o$D[o$i]).name]=this._curOriginalData[o$p++],o$b[o$K.name]=this._curOriginalData[o$p++],this._curOriginalData[o$p++],this._curOriginalData[o$p++],this._curOriginalData[o$p++],this._curOriginalData[o$p++];if(this._pathDic)for(o$j+=o$h[3];o$i<o$j;o$i++){if(o$K=o$D[o$i],o$l=this._pathDic[o$K.name])switch(new o$uo(o$K.extenData).getByte()){case 1:o$l.position=this._curOriginalData[o$p++];break;case 2:o$l.spacing=this._curOriginalData[o$p++];break;case 3:o$l.rotateMix=this._curOriginalData[o$p++],o$l.translateMix=this._curOriginalData[o$p++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(o$so.TEMP.identity()),this._ikArr)for(o$i=0,o$j=this._ikArr.length;o$i<o$j;o$i++)o$S=this._ikArr[o$i],o$q.hasOwnProperty(o$S.name)&&(o$S.bendDirection=o$q[o$S.name]),o$b.hasOwnProperty(o$S.name)&&(o$S.mix=o$b[o$S.name]),o$S.apply();if(this._pathDic)for(var o$F in this._pathDic)(o$l=this._pathDic[o$F]).apply(this._boneList,o$T);if(this._tfArr)for(o$i=0,o$x=this._tfArr.length;o$i<o$x;o$i++)this._tfArr[o$i].apply();for(o$i=0,o$x=this._boneList.length;o$i<o$x;o$i++)if(o$U=this._boneList[o$i],o$V=this._bindBoneBoneSlotDic[o$U.name],o$U.resultMatrix.copyTo(this._boneMatrixArray[o$i]),o$V)for(o$v=0,o$j=o$V.length;o$v<o$j;o$v++)(o$n=o$V[o$v])&&o$n.setParentMatrix(o$U.resultMatrix);var o$P,o$t,o$H,o$R,o$u={},o$s=this._templet.deformAniArr;if(o$s&&0<o$s.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,o$i=0,o$j=this._boneSlotArray.length;o$i<o$j;o$i++)(o$n=this._boneSlotArray[o$i]).deformData=null;var o$z,o$m=o$s[this._aniClipIndex];for(o$z in o$P=o$m.default,this._setDeform(o$P,o$u,this._boneSlotArray,o$k),o$m)"default"!=o$z&&o$z!=this._skinName&&(o$P=o$m[o$z],this._setDeform(o$P,o$u,this._boneSlotArray,o$k));o$P=o$m[this._skinName],this._setDeform(o$P,o$u,this._boneSlotArray,o$k)}if(this._drawOrder)for(o$i=0,o$j=this._drawOrder.length;o$i<o$j;o$i++)o$t=o$$[(o$n=this._boneSlotArray[this._drawOrder[o$i]]).name],o$H=o$y[o$n.name],isNaN(o$H)||(o$T.save(),o$T.alpha(o$H)),isNaN(o$t)||-2==o$t||(this._templet.attachmentNames?o$n.showDisplayByName(this._templet.attachmentNames[o$t]):o$n.showDisplayByIndex(o$t)),o$u[this._drawOrder[o$i]]?(o$R=o$u[this._drawOrder[o$i]],o$n.currDisplayData&&o$R[o$n.currDisplayData.attachmentName]?o$n.deformData=o$R[o$n.currDisplayData.attachmentName]:o$n.deformData=null):o$n.deformData=null,isNaN(o$H)?o$n.draw(o$T,this._boneMatrixArray,2==this._aniMode):o$n.draw(o$T,this._boneMatrixArray,2==this._aniMode,o$H),isNaN(o$H)||o$T.restore();else for(o$i=0,o$j=this._boneSlotArray.length;o$i<o$j;o$i++)o$t=o$$[(o$n=this._boneSlotArray[o$i]).name],o$H=o$y[o$n.name],isNaN(o$H)||(o$T.save(),o$T.alpha(o$H)),isNaN(o$t)||-2==o$t||(this._templet.attachmentNames?o$n.showDisplayByName(this._templet.attachmentNames[o$t]):o$n.showDisplayByIndex(o$t)),o$u[o$i]?(o$R=o$u[o$i],o$n.currDisplayData&&o$R[o$n.currDisplayData.attachmentName]?o$n.deformData=o$R[o$n.currDisplayData.attachmentName]:o$n.deformData=null):o$n.deformData=null,isNaN(o$H)?o$n.draw(o$T,this._boneMatrixArray,2==this._aniMode):o$n.draw(o$T,this._boneMatrixArray,2==this._aniMode,o$H),isNaN(o$H)||o$T.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,o$o,o$T):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,o$o,o$T)},o$o._setDeform=function(o$o,o$r,o$T,o$k){if(o$o){var o$W,o$D,o$n,o$V=0,o$L=0,o$U=0;if(o$o)for(o$V=0,o$L=o$o.deformSlotDataList.length;o$V<o$L;o$V++)for(o$W=o$o.deformSlotDataList[o$V],o$U=0;o$U<o$W.deformSlotDisplayList.length;o$U++)o$n=o$T[(o$D=o$W.deformSlotDisplayList[o$U]).slotIndex],o$D.apply(o$k,o$n),o$r[o$D.slotIndex]||(o$r[o$D.slotIndex]={}),o$r[o$D.slotIndex][o$D.attachment]=o$D.deformData}},o$o.getAnimNum=function(){return this._templet.getAnimationCount()},o$o.getAniNameByIndex=function(o$o){return this._templet.getAniNameByIndex(o$o)},o$o.getSlotByName=function(o$o){return this._boneSlotDic[o$o]},o$o.showSkinByName=function(o$o,o$r){void 0===o$r&&(o$r=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(o$o),o$r)},o$o.showSkinByIndex=function(o$o,o$r){void 0===o$r&&(o$r=!0);for(var o$T=0;o$T<this._boneSlotArray.length;o$T++)this._boneSlotArray[o$T].showSlotData(null,o$r);if(this._templet.showSkinByIndex(this._boneSlotDic,o$o,o$r)){var o$k=this._templet.skinDataArray[o$o];this._skinIndex=o$o,this._skinName=o$k.name}this._clearCache()},o$o.showSlotSkinByIndex=function(o$o,o$r){if(0!=this._aniMode){var o$T=this.getSlotByName(o$o);o$T&&o$T.showDisplayByIndex(o$r),this._clearCache()}},o$o.showSlotSkinByName=function(o$o,o$r){if(0!=this._aniMode){var o$T=this.getSlotByName(o$o);o$T&&o$T.showDisplayByName(o$r),this._clearCache()}},o$o.replaceSlotSkinName=function(o$o,o$r,o$T){if(0!=this._aniMode){var o$k=this.getSlotByName(o$o);o$k&&o$k.replaceDisplayByName(o$r,o$T),this._clearCache()}},o$o.replaceSlotSkinByIndex=function(o$o,o$r,o$T){if(0!=this._aniMode){var o$k=this.getSlotByName(o$o);o$k&&o$k.replaceDisplayByIndex(o$r,o$T),this._clearCache()}},o$o.setSlotSkin=function(o$o,o$r){if(0!=this._aniMode){var o$T=this.getSlotByName(o$o);o$T&&o$T.replaceSkin(o$r),this._clearCache()}},o$o._clearCache=function(){if(1==this._aniMode)for(var o$o=0,o$r=this._graphicsCache.length;o$o<o$r;o$o++){for(var o$T=0,o$k=this._graphicsCache[o$o].length;o$T<o$k;o$T++){var o$W=this._graphicsCache[o$o][o$T];o$W!=this.graphics&&o$C.recycle(o$W)}this._graphicsCache[o$o].length=0}},o$o.play=function(o$o,o$r,o$T,o$k,o$W,o$D){void 0===o$T&&(o$T=!0),void 0===o$k&&(o$k=0),void 0===o$W&&(o$W=0),void 0===o$D&&(o$D=!0),this._indexControl=!1;var o$n=-1,o$V=NaN;if(o$V=o$r?2147483647:0,"string"==typeof o$o)for(var o$L=0,o$U=this._templet.getAnimationCount();o$L<o$U;o$L++){var o$h=this._templet.getAnimation(o$L);if(o$h&&o$o==o$h.name){o$n=o$L;break}}else o$n=o$o;-1<o$n&&o$n<this.getAnimNum()&&(this._aniClipIndex=o$n,(o$T||this._pause||this._currAniIndex!=o$n)&&(this._currAniIndex=o$n,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(o$n)),this._drawOrder=null,this._eventIndex=0,this._player.play(o$n,this._player.playbackRate,o$V,o$k,o$W),o$D&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=o$p.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},o$o.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},o$o.playbackRate=function(o$o){this._player&&(this._player.playbackRate=o$o)},o$o.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},o$o.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=o$p.now(),this.timer.frameLoop(1,this,this._update,null,!0))},o$o._getGrahicsDataWithCache=function(o$o,o$r){return this._graphicsCache[o$o][o$r]},o$o._setGrahicsDataWithCache=function(o$o,o$r,o$T){this._graphicsCache[o$o][o$r]=o$T},o$o.destroy=function(o$o){void 0===o$o&&(o$o=!0),o$r.prototype.destroy.call(this,o$o),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},o$D(0,o$o,"url",function(){return this._aniPath},function(o$o){this.load(o$o)}),o$D(0,o$o,"index",function(){return this._index},function(o$o){this.player&&(this._index=o$o,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),o$D(0,o$o,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),o$D(0,o$o,"templet",function(){return this._templet}),o$D(0,o$o,"player",function(){return this._player}),o$T.useSimpleMeshInCanvas=!1,o$T}(o$Do),o$H=function(o$r){function o$W(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,o$W.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}o$k(o$W,"laya.ani.bone.Templet",o$r);var o$o=o$W.prototype;return o$o.getLoadList=function(){return this._loadList},o$o.loadAni=function(o$o){this._skBufferUrl=o$o,o$Wo.loader.load(o$o,o$L.create(this,this.onComplete),null,"arraybuffer")},o$o.onComplete=function(o$o){if(this._isDestroyed)this.destroy();else{var o$r=o$U.getRes(this._skBufferUrl);o$r?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,o$r)):this.event("error","load failed:"+this._skBufferUrl)}},o$o.parseData=function(o$o,o$r,o$T){void 0===o$T&&(o$T=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=o$o,this._mainTexture&&o$_.isWebGL&&o$o.bitmap&&(o$o.bitmap.enableMerageInAtlas=!1),this._rate=o$T,this.parse(o$r)},o$o.buildArmature=function(o$o){return void 0===o$o&&(o$o=0),new o$t(this,o$o)},o$o.parse=function(o$o){o$r.prototype.parse.call(this,o$o),this._endLoaded(),this._aniVersion!=o$W.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+o$W.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},o$o._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var o$o=0;this._loadList=[];var o$r,o$T=new o$uo(this.getPublicExtData()),o$k=0,o$W=0,o$D=0,o$n=o$T.getInt32(),o$V=o$T.readUTFString(),o$L=o$V.split("\n");for(o$o=0;o$o<o$n;o$o++)o$r=this._path+o$L[2*o$o],o$V=o$L[2*o$o+1],o$T.getFloat32(),o$T.getFloat32(),o$k=o$T.getFloat32(),o$W=o$T.getFloat32(),o$D=o$T.getFloat32(),isNaN(o$D)?0:o$D,o$D=o$T.getFloat32(),isNaN(o$D)?0:o$D,o$D=o$T.getFloat32(),isNaN(o$D)?o$k:o$D,o$D=o$T.getFloat32(),isNaN(o$D)?o$W:o$D,-1==this._loadList.indexOf(o$r)&&this._loadList.push(o$r);this.event("inited",this)}},o$o._textureComplete=function(){for(var o$o,o$r,o$T=0,o$k=this._loadList.length;o$T<o$k;o$T++)o$r=this._loadList[o$T],o$o=this._textureDic[o$r]=o$U.getRes(o$r),o$_.isWebGL&&o$o&&o$o.bitmap&&(o$o.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},o$o._parsePublicExtData=function(){var o$o=0,o$r=0,o$T=0,o$k=0,o$W=0;for(o$o=0,o$W=this.getAnimationCount();o$o<o$W;o$o++)this._graphicsCache.push([]);var o$D;o$D="Dragon"!=this._aniClassName;var o$n,o$V,o$L=new o$uo(this.getPublicExtData()),o$U=0,o$h=0,o$p=0,o$i=0,o$v=0,o$x=0,o$j=0,o$_=0,o$K=0,o$$=o$L.getInt32(),o$y=o$L.readUTFString(),o$l=o$y.split("\n");for(o$o=0;o$o<o$$;o$o++){if(o$n=this._mainTexture,o$V=this._path+o$l[2*o$o],o$y=o$l[2*o$o+1],null==this._mainTexture&&(o$n=this._textureDic[o$V]),!o$n)return this.event("error",this),void(this.isParseFail=!0);o$U=o$L.getFloat32(),o$h=o$L.getFloat32(),o$p=o$L.getFloat32(),o$i=o$L.getFloat32(),o$K=o$L.getFloat32(),o$v=isNaN(o$K)?0:o$K,o$K=o$L.getFloat32(),o$x=isNaN(o$K)?0:o$K,o$K=o$L.getFloat32(),o$j=isNaN(o$K)?o$p:o$K,o$K=o$L.getFloat32(),o$_=isNaN(o$K)?o$i:o$K,this.subTextureDic[o$y]=o$zo.create(o$n,o$U,o$h,o$p,o$i,-o$v,-o$x,o$j,o$_),o$n.alphaTexture&&(this.subTextureDic[o$y].alphaTexture=o$zo.create(o$n.alphaTexture,o$U,o$h,o$p,o$i,-o$v,-o$x,o$j,o$_))}this._mainTexture=o$n;var o$S,o$q,o$b,o$F,o$P,o$t=o$L.getUint16();for(o$o=0;o$o<o$t;o$o++)(o$S=[]).push(o$L.getUint16()),o$S.push(o$L.getUint16()),o$S.push(o$L.getUint16()),o$S.push(o$L.getUint16()),this.aniSectionDic[o$o]=o$S;var o$H,o$R=o$L.getInt16(),o$u={};for(o$o=0;o$o<o$R;o$o++)o$q=new o$mo,0==o$o?o$H=o$q:o$q.root=o$H,o$q.d=o$D?-1:1,o$F=o$L.readUTFString(),o$P=o$L.readUTFString(),o$q.length=o$L.getFloat32(),1==o$L.getByte()&&(o$q.inheritRotation=!1),1==o$L.getByte()&&(o$q.inheritScale=!1),o$q.name=o$F,o$P&&((o$b=o$u[o$P])?o$b.addChild(o$q):this.mRootBone=o$q),o$u[o$F]=o$q,this.mBoneArr.push(o$q);this.tMatrixDataLen=o$L.getUint16();var o$s,o$z,o$m=o$L.getUint16(),o$C=Math.floor(o$m/this.tMatrixDataLen),o$X=this.srcBoneMatrixArr;for(o$o=0;o$o<o$C;o$o++)(o$s=new o$ao).scX=o$L.getFloat32(),o$s.skX=o$L.getFloat32(),o$s.skY=o$L.getFloat32(),o$s.scY=o$L.getFloat32(),o$s.x=o$L.getFloat32(),o$s.y=o$L.getFloat32(),8===this.tMatrixDataLen&&(o$s.skewX=o$L.getFloat32(),o$s.skewY=o$L.getFloat32()),o$X.push(o$s),(o$q=this.mBoneArr[o$o]).transform=o$s;var o$O,o$M=o$L.getUint16(),o$c=0;for(o$o=0;o$o<o$M;o$o++){for(o$z=new o$Jo,o$c=o$L.getUint16(),o$r=0;o$r<o$c;o$r++)o$z.boneNames.push(o$L.readUTFString()),o$z.boneIndexs.push(o$L.getInt16());o$z.name=o$L.readUTFString(),o$z.targetBoneName=o$L.readUTFString(),o$z.targetBoneIndex=o$L.getInt16(),o$z.bendDirection=o$L.getFloat32(),o$z.mix=o$L.getFloat32(),o$z.isSpine=o$D,this.ikArr.push(o$z)}var o$e,o$J=o$L.getUint16(),o$Y=0;for(o$o=0;o$o<o$J;o$o++){for(o$O=new o$fo,o$Y=o$L.getUint16(),o$r=0;o$r<o$Y;o$r++)o$O.boneIndexs.push(o$L.getInt16());o$O.name=o$L.getUTFString(),o$O.targetIndex=o$L.getInt16(),o$O.rotateMix=o$L.getFloat32(),o$O.translateMix=o$L.getFloat32(),o$O.scaleMix=o$L.getFloat32(),o$O.shearMix=o$L.getFloat32(),o$O.offsetRotation=o$L.getFloat32(),o$O.offsetX=o$L.getFloat32(),o$O.offsetY=o$L.getFloat32(),o$O.offsetScaleX=o$L.getFloat32(),o$O.offsetScaleY=o$L.getFloat32(),o$O.offsetShearY=o$L.getFloat32(),this.tfArr.push(o$O)}var o$A=o$L.getUint16(),o$I=0;for(o$o=0;o$o<o$A;o$o++){for((o$e=new o$Yo).name=o$L.readUTFString(),o$I=o$L.getUint16(),o$r=0;o$r<o$I;o$r++)o$e.bones.push(o$L.getInt16());o$e.target=o$L.readUTFString(),o$e.positionMode=o$L.readUTFString(),o$e.spacingMode=o$L.readUTFString(),o$e.rotateMode=o$L.readUTFString(),o$e.offsetRotation=o$L.getFloat32(),o$e.position=o$L.getFloat32(),o$e.spacing=o$L.getFloat32(),o$e.rotateMix=o$L.getFloat32(),o$e.translateMix=o$L.getFloat32(),this.pathArr.push(o$e)}var o$N,o$f,o$a,o$G,o$w,o$Z=0,o$Q=0,o$g=0,o$B=NaN,o$E=0,o$d=o$L.getInt16();for(o$o=0;o$o<o$d;o$o++){var o$oo=o$L.getUint8(),o$ro={};this.deformAniArr.push(o$ro);for(var o$To=0;o$To<o$oo;o$To++)for((o$N=new o$Xo).skinName=o$L.getUTFString(),o$ro[o$N.skinName]=o$N,o$Z=o$L.getInt16(),o$r=0;o$r<o$Z;o$r++)for(o$f=new o$Oo,o$N.deformSlotDataList.push(o$f),o$Q=o$L.getInt16(),o$T=0;o$T<o$Q;o$T++)for(o$a=new o$Mo,o$f.deformSlotDisplayList.push(o$a),o$a.slotIndex=o$L.getInt16(),o$a.attachment=o$L.getUTFString(),o$g=o$L.getInt16(),o$k=0;o$k<o$g;o$k++)for(1==o$L.getByte()?o$a.tweenKeyList.push(!0):o$a.tweenKeyList.push(!1),o$B=o$L.getFloat32(),o$a.timeList.push(o$B),o$G=[],o$a.vectices.push(o$G),o$E=o$L.getInt16(),o$W=0;o$W<o$E;o$W++)o$G.push(o$L.getFloat32())}var o$ko,o$Wo,o$Do=o$L.getInt16(),o$no=0,o$Vo=0;for(o$o=0;o$o<o$Do;o$o++){for(o$no=o$L.getInt16(),o$w=[],o$r=0;o$r<o$no;o$r++){for((o$ko=new o$co).time=o$L.getFloat32(),o$Vo=o$L.getInt16(),o$T=0;o$T<o$Vo;o$T++)o$ko.drawOrder.push(o$L.getInt16());o$w.push(o$ko)}this.drawOrderAniArr.push(o$w)}var o$Lo,o$Uo=o$L.getInt16(),o$ho=0;for(o$o=0;o$o<o$Uo;o$o++){for(o$ho=o$L.getInt16(),o$Wo=[],o$r=0;o$r<o$ho;o$r++)(o$Lo=new o$eo).name=o$L.getUTFString(),o$Lo.intValue=o$L.getInt32(),o$Lo.floatValue=o$L.getFloat32(),o$Lo.stringValue=o$L.getUTFString(),o$Lo.time=o$L.getFloat32(),o$Wo.push(o$Lo);this.eventAniArr.push(o$Wo)}var o$po=o$L.getInt16();if(0<o$po)for(this.attachmentNames=[],o$o=0;o$o<o$po;o$o++)this.attachmentNames.push(o$L.getUTFString());var o$io,o$vo,o$xo=o$L.getInt16();for(o$o=0;o$o<o$xo;o$o++)(o$io=new o$Co).name=o$L.readUTFString(),o$io.parent=o$L.readUTFString(),o$io.attachmentName=o$L.readUTFString(),o$io.srcDisplayIndex=o$io.displayIndex=o$L.getInt16(),(o$io.templet=this).boneSlotDic[o$io.name]=o$io,null==(o$vo=this.bindBoneBoneSlotDic[o$io.parent])&&(this.bindBoneBoneSlotDic[o$io.parent]=o$vo=[]),o$vo.push(o$io),this.boneSlotArray.push(o$io);var o$jo,o$_o,o$Ko,o$$o=o$L.readUTFString().split("\n"),o$yo=0,o$lo=o$L.getUint8(),o$So=0,o$qo=0,o$bo=0,o$Fo=0,o$Po=0,o$to=0,o$Ho=0;for(o$o=0;o$o<o$lo;o$o++){for((o$jo=new o$Ao).name=o$$o[o$yo++],o$So=o$L.getUint8(),o$r=0;o$r<o$So;o$r++){for((o$_o=new o$No).name=o$$o[o$yo++],o$io=this.boneSlotDic[o$_o.name],o$qo=o$L.getUint8(),o$T=0;o$T<o$qo;o$T++){if(o$Ko=new o$Io,this.skinSlotDisplayDataArr.push(o$Ko),o$Ko.name=o$$o[o$yo++],o$Ko.attachmentName=o$$o[o$yo++],o$Ko.transform=new o$ao,o$Ko.transform.scX=o$L.getFloat32(),o$Ko.transform.skX=o$L.getFloat32(),o$Ko.transform.skY=o$L.getFloat32(),o$Ko.transform.scY=o$L.getFloat32(),o$Ko.transform.x=o$L.getFloat32(),o$Ko.transform.y=o$L.getFloat32(),o$_o.displayArr.push(o$Ko),o$Ko.width=o$L.getFloat32(),o$Ko.height=o$L.getFloat32(),o$Ko.type=o$L.getUint8(),o$Ko.verLen=o$L.getUint16(),0<(o$R=o$L.getUint16()))for(o$Ko.bones=[],o$k=0;o$k<o$R;o$k++){var o$Ro=o$L.getUint16();o$Ko.bones.push(o$Ro)}if(0<(o$bo=o$L.getUint16()))for(o$Ko.uvs=[],o$k=0;o$k<o$bo;o$k++)o$Ko.uvs.push(o$L.getFloat32());if(0<(o$Fo=o$L.getUint16()))for(o$Ko.weights=[],o$k=0;o$k<o$Fo;o$k++)o$Ko.weights.push(o$L.getFloat32());if(0<(o$Po=o$L.getUint16()))for(o$Ko.triangles=[],o$k=0;o$k<o$Po;o$k++)o$Ko.triangles.push(o$L.getUint16());if(0<(o$to=o$L.getUint16()))for(o$Ko.vertices=[],o$k=0;o$k<o$to;o$k++)o$Ko.vertices.push(o$L.getFloat32());if(0<(o$Ho=o$L.getUint16()))for(o$Ko.lengths=[],o$k=0;o$k<o$Ho;o$k++)o$Ko.lengths.push(o$L.getFloat32())}o$jo.slotArr.push(o$_o)}this.skinDic[o$jo.name]=o$jo,this.skinDataArray.push(o$jo)}1==o$L.getUint8()?(this.yReverseMatrix=new o$so(1,0,0,-1,0,0),o$H&&o$H.setTempMatrix(this.yReverseMatrix)):o$H&&o$H.setTempMatrix(new o$so),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},o$o.getTexture=function(o$o){var o$r=this.subTextureDic[o$o];return o$r||(o$r=this.subTextureDic[o$o.substr(0,o$o.length-1)]),null==o$r?this._mainTexture:o$r},o$o.showSkinByIndex=function(o$o,o$r,o$T){if(void 0===o$T&&(o$T=!0),o$r<0&&o$r>=this.skinDataArray.length)return!1;var o$k,o$W,o$D=0,o$n=0,o$V=this.skinDataArray[o$r];if(o$V){for(o$D=0,o$n=o$V.slotArr.length;o$D<o$n;o$D++)(o$W=o$V.slotArr[o$D])&&(o$k=o$o[o$W.name])&&(o$k.showSlotData(o$W,o$T),o$T&&"undefined"!=o$k.attachmentName&&"null"!=o$k.attachmentName?o$k.showDisplayByName(o$k.attachmentName):o$k.showDisplayByIndex(o$k.displayIndex));return!0}return!1},o$o.getSkinIndexByName=function(o$o){for(var o$r=0,o$T=this.skinDataArray.length;o$r<o$T;o$r++)if(this.skinDataArray[o$r].name==o$o)return o$r;return-1},o$o.getGrahicsDataWithCache=function(o$o,o$r){return this._graphicsCache[o$o][o$r]},o$o.setGrahicsDataWithCache=function(o$o,o$r,o$T){this._graphicsCache[o$o][o$r]=o$T},o$o.destroy=function(){var o$o;for(var o$r in this._isDestroyed=!0,this.subTextureDic)(o$o=this.subTextureDic[o$r])&&o$o.destroy();for(o$r in this._textureDic)(o$o=this._textureDic[o$r])&&o$o.destroy();for(var o$T=0,o$k=this.skinSlotDisplayDataArr.length;o$T<o$k;o$T++)this.skinSlotDisplayDataArr[o$T].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete o$W.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},o$o.getAniNameByIndex=function(o$o){var o$r=this.getAnimation(o$o);return o$r?o$r.name:null},o$D(0,o$o,"rate",function(){return this._rate},function(o$o){this._rate=o$o}),o$W.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",o$W.TEMPLET_DICTIONARY=null,o$W}(o$X)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(o$o,o$r){"use strict";for(var o$T in Object.defineProperty(o$r,"__esModule",{value:!0}),Laya){var o$k=Laya[o$T];o$k&&o$k.__isclass&&(o$r[o$T]=o$k)}});