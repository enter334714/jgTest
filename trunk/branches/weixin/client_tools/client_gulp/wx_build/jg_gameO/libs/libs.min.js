var Laya=window.Laya=function(oU,oo){var oh={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(oo,or){return 1==arguments.length?oh.__presubstr.call(this,oo):oh.__presubstr.call(this,oo,0<or?or:this.length+or)},__init:function(oo){oo.forEach(function(oo){oo.__init$&&oo.__init$()})},__isClass:function(oo){return oo&&(oo.__isclass||oo==Object||oo==String||oo==Array)},__newvec:function(oo,or){var oT=[];oT.length=oo;for(var ok=0;ok<oo;ok++)oT[ok]=or;return oT},__extend:function(oo,or){for(var oT in or)if(or.hasOwnProperty(oT)){var ok=Object.getOwnPropertyDescriptor(or,oT),oW=ok.get,oD=ok.set;oW||oD?oW&&oD?Object.defineProperty(oo,oT,ok):(oW&&Object.defineProperty(oo,oT,oW),oD&&Object.defineProperty(oo,oT,oD)):oo[oT]=or[oT]}function on(){oh.un(this,"constructor",oo)}on.prototype=or.prototype,oo.prototype=new on,oh.un(oo.prototype,"__imps",oh.__copy({},or.prototype.__imps))},__copy:function(oo,or){if(!or)return null;for(var oT in oo=oo||{},or)oo[oT]=or[oT];return oo},__package:function(oo,or){if(!oh.__packages[oo]){oh.__packages[oo]=!0;var oT=oU,ok=oo.split(".");if(1<ok.length)for(var oW=0,oD=ok.length-1;oW<oD;oW++){var on=oT[ok[oW]];oT=on||(oT[ok[oW]]={})}oT[ok[ok.length-1]]||(oT[ok[ok.length-1]]=or||{})}},__hasOwnProperty:function(oo,or){return or=or||this,Object.hasOwnProperty.call(or,oo)||function oo(or,oT){if(Object.hasOwnProperty.call(oT.prototype,or))return!0;var ok=oT.prototype.__super;return null==ok?null:oo(or,ok)}(oo,or.__class)},__typeof:function(oo,or){if(!oo||!or)return!1;if(or===String)return"string"==typeof oo;if(or===Number)return"number"==typeof oo;if(or.__interface__)or=or.__interface__;else if("string"!=typeof or)return oo instanceof or;return oo.__imps&&oo.__imps[or]||oo.__class==or},__as:function(oo,or){return this.__typeof(oo,or)?oo:null},__int:function(oo){return oo?parseInt(oo):0},interface:function(oo,or){oh.__package(oo,{});var oT=oh.__internals,ok=oT[oo]=oT[oo]||{self:oo};if(or){var oW=or.split(",");ok.extend=[];for(var oD=0;oD<oW.length;oD++){var on=oW[oD];oT[on]=oT[on]||{self:on},ok.extend.push(oT[on])}}var oV=oU,oL=oo.split(".");for(oD=0;oD<oL.length-1;oD++)oV=oV[oL[oD]];oV[oL[oL.length-1]]={__interface__:oo}},class:function(oo,or,oT,ok){if(oT&&oh.__extend(oo,oT),or)if(oh.__package(or,oo),oh.__classmap[or]=oo,0<or.indexOf(".")){if(0==or.indexOf("laya.")){var oW=or.split(".");ok=ok||oW[oW.length-1],oh[ok]&&console.log("Warning!,this class["+ok+"] already exist:",oh[ok]),oh[ok]=oo}}else"Main"==or?oU.Main=oo:"MainWX"==or?oU.MainWX=oo:(oh[or]&&console.log("Error!,this class["+or+"] already exist:",oh[or]),oh[or]=oo);var oD=oh.un,on=oo.prototype;oD(on,"hasOwnProperty",oh.__hasOwnProperty),oD(on,"__class",oo),oD(on,"__super",oT),oD(on,"__className",or),oD(oo,"__super",oT),oD(oo,"__className",or),oD(oo,"__isclass",!0),oD(oo,"super",function(oo){this.__super.call(oo)})},imps:function(oo,or){if(!or)return null;var oW=oo.__imps||oh.un(oo,"__imps",{});function oD(oo){var or,oT;if((or=oh.__internals[oo])&&(oW[oo]=!0,oT=or.extend))for(var ok=0;ok<oT.length;ok++)oD(oT[ok].self)}for(var oT in or)oD(oT)},superSet:function(oo,or,oT,ok){var oW=oo.prototype["_$set_"+oT];oW&&oW.call(or,ok)},superGet:function(oo,or,oT){var ok=oo.prototype["_$get_"+oT];return ok?ok.call(or):null},getset:function(oo,or,oT,ok,oW){oo?(ok&&(or["_$GET_"+oT]=ok),oW&&(or["_$SET_"+oT]=oW)):(ok&&oh.un(or,"_$get_"+oT,ok),oW&&oh.un(or,"_$set_"+oT,oW)),ok&&oW?Object.defineProperty(or,oT,{get:ok,set:oW,enumerable:!1,configurable:!0}):(ok&&Object.defineProperty(or,oT,{get:ok,enumerable:!1,configurable:!0}),oW&&Object.defineProperty(or,oT,{set:oW,enumerable:!1,configurable:!0}))},static:function(oT,ok){for(var oW=0,oo=ok.length;oW<oo;oW+=2)if("length"==ok[oW])oT.length=ok[oW+1].call(oT);else{function or(){var or=ok[oW],oo=ok[oW+1];Object.defineProperty(oT,or,{get:function(){return delete this[or],this[or]=oo.call(this)},set:function(oo){delete this[or],this[or]=oo},enumerable:!0,configurable:!0})}or()}},un:function(oo,or,oT){return oT||(oT=oo[or]),oh.__propun.value=oT,Object.defineProperty(oo,or,oh.__propun),oT},uns:function(or,oo){oo.forEach(function(oo){oh.un(or,oo)})}};return oU.console=oU.console||{log:function(){}},oU.trace=oU.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),oh}(window,document);!function(oo,or,oT){oT.un,oT.uns,oT.static,oT.class,oT.getset,oT.__newvec}(window,document,Laya),function(on,or,ob){ob.un,ob.uns;var oL=ob.static,oj=ob.class,oh=ob.getset;ob.__newvec;ob.interface("laya.runtime.IMarket"),ob.interface("laya.filters.IFilter"),ob.interface("laya.display.ILayout"),ob.interface("laya.resource.IDispose"),ob.interface("laya.runtime.IPlatform"),ob.interface("laya.resource.IDestroy"),ob.interface("laya.runtime.IConchNode"),ob.interface("laya.filters.IFilterAction"),ob.interface("laya.runtime.ICPlatformClass"),ob.interface("laya.resource.ICreateResource"),ob.interface("laya.runtime.IConchRenderObject"),ob.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var ou=function(){function oD(){}return oj(oD,"laya.utils.RunDriver"),oD.FILTER_ACTIONS=[],oD.pixelRatio=-1,oD._charSizeTestDiv=null,oD.now=function(){return Date.now()},oD.getWindow=function(){return on},oD.getPixelRatio=function(){if(oD.pixelRatio<0){var oo=oe.context,or=oo.backingStorePixelRatio||oo.webkitBackingStorePixelRatio||oo.mozBackingStorePixelRatio||oo.msBackingStorePixelRatio||oo.oBackingStorePixelRatio||oo.backingStorePixelRatio||1;(oD.pixelRatio=(oe.window.devicePixelRatio||1)/or)<1&&(oD.pixelRatio=1)}return oD.pixelRatio},oD.getIncludeStr=function(oo){return null},oD.createShaderCondition=function(oo){var or="(function() {return "+oo+";})";return ob._runScript(or)},oD.fontMap=[],oD.measureText=function(oo,or){var oT=oD.hanzi.test(oo);if(oT&&oD.fontMap[or])return oD.fontMap[or];var ok=oe.context;ok.font=or;var oW=ok.measureText(oo);return oT&&(oD.fontMap[or]=oW),oW},oD.getWebGLContext=function(oo){},oD.beginFlush=function(){},oD.endFinish=function(){},oD.addToAtlas=null,oD.flashFlushImage=function(oo){},oD.drawToCanvas=function(oo,or,oT,ok,oW,oD){var on=oyo.create("2D"),oV=new oX(oT,ok,on);return oO.renders[or]._fun(oo,oV,oW,oD),on},oD.createParticleTemplate2D=null,oD.createGLTextur=null,oD.createWebGLContext2D=null,oD.changeWebGLSize=function(oo,or){},oD.createRenderSprite=function(oo,or){return new oO(oo,or)},oD.createFilterAction=function(oo){return new oy},oD.createGraphics=function(){return new oi},oD.clear=function(oo){oC._context.ctx.clear()},oD.cancelLoadByUrl=function(oo){},oD.clearAtlas=function(oo){},oD.isAtlas=function(oo){return!1},oD.addTextureToAtlas=function(oo){},oD.getTexturePixels=function(oo,or,oT,ok,oW){return null},oD.skinAniSprite=function(){return null},oD.update3DLoop=function(){},oL(oD,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),oD}(),ok=(oh(1,ob,"alertGlobalError",null,function(oo){var oD=0;oe.window.onerror=oo?function(oo,or,oT,ok,oW){oD++<5&&oW&&alert(oW.stack||oW)}:null}),ob.init=function(oo,or,oT){for(var ok=[],oW=2,oD=arguments.length;oW<oD;oW++)ok.push(arguments[oW]);if(!ob._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=ob._arrayBufferSlice),ob._isinit=!0,oe.__init__(),oM.__init__(),oi.__init__(),ob.timer=new oZ,ob.scaleTimer=new oZ,ob.loader=new oLo,oE.__init__(),oW=0;for(var on=ok.length;oW<on;oW++)ok[oW].enable&&ok[oW].enable();return ov.__init__(),oV.__init__(),oc.__init__(),oY.beginCheck(),ob._currentStage=ob.stage=new oKo,ob.stage.conchModel&&ob.stage.conchModel.setRootNode(),ob._getUrlPath(),ob.render=new oC(0,0),ob.stage.size(oo,or),oO.__init__(),op.__init__(),ox.instance.__init__(ob.stage,oC.canvas),oSo.__init__(),oR.autoStopMusic=!0,ot.__init__(),oC.canvas}},ob._getUrlPath=function(){var oo=oe.window.location,or=oo.pathname;or=or&&":"==or.charAt(2)?or.substring(1):or,om.rootPath=om.basePath=om.getPath("file:"==oo.protocol?or:oo.protocol+"//"+oo.host+oo.pathname)},ob._arrayBufferSlice=function(oo,or){var oT=new Uint8Array(this,oo,or-oo),ok=new Uint8Array(oT.length);return ok.set(oT),ok.buffer},ob._runScript=function(oo){return oe.window[ob._evcode](oo)},ob.stage=null,ob.timer=null,ob.scaleTimer=null,ob.loader=null,ob.version="1.8.6",ob.render=null,ob._currentStage=null,ob._isinit=!1,ob.isDebug=!1,ob.MiniAdpter={init:function(){on.navigator&&on.navigator.userAgent&&-1<on.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},oL(ob,["conchMarket",function(){return this.conchMarket=on.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=on.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function oo(){}return oj(oo,"Config"),oo.WebGLTextCacheCount=500,oo.atlasEnable=!1,oo.showCanvasMark=!1,oo.animationInterval=50,oo.isAntialias=!1,oo.isAlpha=!1,oo.premultipliedAlpha=!0,oo.isStencil=!0,oo.preserveDrawingBuffer=!1,oo}()),oU=function(){function oU(){this._events=null}oj(oU,"laya.events.EventDispatcher");var oo=oU.prototype;return oo.hasListener=function(oo){return!!(this._events&&this._events[oo])},oo.event=function(oo,or){if(!this._events||!this._events[oo])return!1;var oT=this._events[oo];if(oT.lock)oT.queue||(oT.queue=[]),oT.queue.push(or);else{var ok;for(oT.lock=!0,oT.cursor=oT.head;oT.cursor;)ok=oT.cursor,oT.cursor=ok.next,ok.once&&oU.delNode(oT,ok),null!=or?ok.args?ok.method.apply(ok.caller,ok.args.concat(or)):or instanceof Array?ok.method.apply(ok.caller,or):ok.method.call(ok.caller,or):ok.method.apply(ok.caller,ok.args),ok.once&&oU.recoverHandler(ok);oT.lock=!1,!oT.head&&this._events&&this._events[oo]==oT&&delete this._events[oo],oT.queue&&oT.queue.length&&this.event(oo,oT.queue.shift())}return!0},oo.on=function(oo,or,oT,ok){return this._createListener(oo,or,oT,ok,!1)},oo.once=function(oo,or,oT,ok){return this._createListener(oo,or,oT,ok,!0)},oo._createListener=function(oo,or,oT,ok,oW,oD){void 0===oD&&(oD=!0),oD&&this.off(oo,or,oT,oW);var on=oU.createHandler(or||this,oT,ok,oW);this._events||(this._events={});var oV=this._events,oL=oV[oo];return oL?oL.tail?(on.prev=oL.tail,oL.tail.next=on,oL.tail=on):oL.head=oL.tail=on:oV[oo]={head:on,tail:on,cursor:null,lock:!1},this},oo.off=function(oo,or,oT,ok){if(void 0===ok&&(ok=!1),!this._events||!this._events[oo])return this;for(var oW=this._events[oo],oD=oW.head;oD;){if((!or||oD.caller===or)&&oD.method===oT&&(!ok||oD.once)){oU.delNode(oW,oD),oW.cursor==oD&&(oW.cursor=oD.next),oU.recoverHandler(oD);break}oD=oD.next}return this},oo.offAll=function(oo){var or=this._events;if(!or)return this;if(oo)this._recoverHandlers(or[oo]),delete or[oo];else{for(var oT in or)this._recoverHandlers(or[oT]);this._events=null}return this},oo._recoverHandlers=function(oo){if(oo){for(var or=oo.head;or;){oU.delNode(oo,or);var oT=or.next;oU.recoverHandler(or),or=oT}oo.cursor=null}},oo.isMouseEvent=function(oo){return oU.MOUSE_EVENTS[oo]},oU.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},oU.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},oU.delNode=function(oo,or){or.prev?or.prev.next=or.next:oo.head=or.next,or.next?or.next.prev=or.prev:oo.tail=or.prev},oU.createHandler=function(oo,or,oT,ok){var oW=oU._freeHandler;return oW?(oU._freeCount--,oU._freeHandler=oW.next,oW.caller=oo,oW.method=or,oW.args=oT,oW.once=ok):oW={caller:oo,method:or,args:oT,once:ok},oW.prev=oW.next=null,oW},oU.recoverHandler=function(oo){oo.caller=oo.method=oo.args=oo.prev=null,oo.next=oU._freeHandler,oU._freeHandler=oo,oU._freeCount++},oU._freeHandler=null,oU._freeCount=0,oU}(),o$=function(){function oW(oo,or,oT,ok){this.once=!1,void(this._id=0)===ok&&(ok=!1),this.setTo(oo,or,oT,ok)}oj(oW,"laya.utils.Handler");var oo=oW.prototype;return oo.setTo=function(oo,or,oT,ok){return this._id=oW._gid++,this.caller=oo,this.method=or,this.args=oT,this.once=ok,this},oo.run=function(){if(null==this.method)return null;var oo=this._id,or=this.method.apply(this.caller,this.args);return this._id===oo&&this.once&&this.recover(),or},oo.runWith=function(oo){if(null==this.method)return null;var or=this._id;if(null==oo)var oT=this.method.apply(this.caller,this.args);else oT=this.args||oo.unshift?this.args?this.method.apply(this.caller,this.args.concat(oo)):this.method.apply(this.caller,oo):this.method.call(this.caller,oo);return this._id===or&&this.once&&this.recover(),oT},oo.clear=function(){return this.caller=null,this.method=null,this.args=null,this},oo.recover=function(){0<this._id&&(this._id=0,this.clear())},oW.create=function(oo,or,oT,ok){return void 0===ok&&(ok=!0),new oW(oo,or,oT,ok)},oW._gid=1,oW}(),oH=function(){function oo(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}oj(oo,"laya.display.BitmapFont");var or=oo.prototype;return or.loadFont=function(oo,or){this._path=oo,this._complete=or,ob.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],o$.create(this,this.onLoaded))},or.onLoaded=function(){this.parseFont(oVo.getRes(this._path),oVo.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},or.parseFont=function(oo,or){if(null!=oo&&null!=or){this._texture=or;var oT=oo.getElementsByTagName("info");if(!oT[0].getAttributeNode)return this.parseFont2(oo,or);this.fontSize=parseInt(oT[0].getAttributeNode("size").nodeValue);var ok,oW=oT[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(oW[0]),parseInt(oW[1]),parseInt(oW[2]),parseInt(oW[3])],ok=oo.getElementsByTagName("char");var oD=0;for(oD=0;oD<ok.length;oD++){var on=ok[oD],oV=parseInt(on.getAttributeNode("id").nodeValue),oL=parseInt(on.getAttributeNode("xoffset").nodeValue)/1,oU=parseInt(on.getAttributeNode("yoffset").nodeValue)/1,oh=parseInt(on.getAttributeNode("xadvance").nodeValue)/1,op=new oP;op.x=parseInt(on.getAttributeNode("x").nodeValue),op.y=parseInt(on.getAttributeNode("y").nodeValue),op.width=parseInt(on.getAttributeNode("width").nodeValue),op.height=parseInt(on.getAttributeNode("height").nodeValue);var oi=oho.create(or,op.x,op.y,op.width,op.height,oL,oU);this._maxWidth=Math.max(this._maxWidth,oh+this.letterSpacing),this._fontCharDic[oV]=oi,this._fontWidthMap[oV]=oh}}},or.parseFont2=function(oo,or){if(null!=oo&&null!=or){this._texture=or;var oT=oo.getElementsByTagName("info");this.fontSize=parseInt(oT[0].attributes.size.nodeValue);var ok=oT[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(ok[0]),parseInt(ok[1]),parseInt(ok[2]),parseInt(ok[3])];var oW=oo.getElementsByTagName("char"),oD=0;for(oD=0;oD<oW.length;oD++){var on=oW[oD].attributes,oV=parseInt(on.id.nodeValue),oL=parseInt(on.xoffset.nodeValue)/1,oU=parseInt(on.yoffset.nodeValue)/1,oh=parseInt(on.xadvance.nodeValue)/1,op=new oP;op.x=parseInt(on.x.nodeValue),op.y=parseInt(on.y.nodeValue),op.width=parseInt(on.width.nodeValue),op.height=parseInt(on.height.nodeValue);var oi=oho.create(or,op.x,op.y,op.width,op.height,oL,oU);this._maxWidth=Math.max(this._maxWidth,oh+this.letterSpacing),this._fontCharDic[oV]=oi,this._fontWidthMap[oV]=oh}}},or.getCharTexture=function(oo){return this._fontCharDic[oo.charCodeAt(0)]},or.destroy=function(){if(this._texture){for(var oo in this._fontCharDic){var or=this._fontCharDic[oo];or&&or.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},or.setSpaceWidth=function(oo){this._spaceWidth=oo},or.getCharWidth=function(oo){var or=oo.charCodeAt(0);return this._fontWidthMap[or]?this._fontWidthMap[or]+this.letterSpacing:" "==oo?this._spaceWidth+this.letterSpacing:0},or.getTextWidth=function(oo){for(var or=0,oT=0,ok=oo.length;oT<ok;oT++)or+=this.getCharWidth(oo.charAt(oT));return or},or.getMaxWidth=function(){return this._maxWidth},or.getMaxHeight=function(){return this.fontSize},or.drawText=function(oo,or,oT,ok,oW,oD){var on,oV=this.getTextWidth(oo),oL=0;"center"===oW&&(oL=(oD-oV)/2),"right"===oW&&(oL=oD-oV);for(var oU=0,oh=0,op=oo.length;oh<op;oh++)(on=this.getCharTexture(oo.charAt(oh)))&&(or.graphics.drawTexture(on,oT+oU+oL,ok),oU+=this.getCharWidth(oo.charAt(oh)))},oo}(),oV=function(){function oT(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=oT._TF_EMPTY}oj(oT,"laya.display.css.Style");var oo=oT.prototype;return oo.getTransform=function(){return this._tf},oo.setTransform=function(oo){this._tf="none"!==oo&&oo?oo:oT._TF_EMPTY},oo.setTranslateX=function(oo){this._tf===oT._TF_EMPTY&&(this._tf=new oW),this._tf.translateX=oo},oo.setTranslateY=function(oo){this._tf===oT._TF_EMPTY&&(this._tf=new oW),this._tf.translateY=oo},oo.setScaleX=function(oo){this._tf===oT._TF_EMPTY&&(this._tf=new oW),this._tf.scaleX=oo},oo.setScale=function(oo,or){this._tf===oT._TF_EMPTY&&(this._tf=new oW),this._tf.scaleX=oo,this._tf.scaleY=or},oo.setScaleY=function(oo){this._tf===oT._TF_EMPTY&&(this._tf=new oW),this._tf.scaleY=oo},oo.setRotate=function(oo){this._tf===oT._TF_EMPTY&&(this._tf=new oW),this._tf.rotate=oo},oo.setSkewX=function(oo){this._tf===oT._TF_EMPTY&&(this._tf=new oW),this._tf.skewX=oo},oo.setSkewY=function(oo){this._tf===oT._TF_EMPTY&&(this._tf=new oW),this._tf.skewY=oo},oo.destroy=function(){this.scrollRect=null},oo.render=function(oo,or,oT,ok){},oo.getCSSStyle=function(){return oro.EMPTY},oo._enableLayout=function(){return!1},oh(0,oo,"scaleX",function(){return this._tf.scaleX},function(oo){this.setScaleX(oo)}),oh(0,oo,"transform",function(){return this.getTransform()},function(oo){this.setTransform(oo)}),oh(0,oo,"translateX",function(){return this._tf.translateX},function(oo){this.setTranslateX(oo)}),oh(0,oo,"translateY",function(){return this._tf.translateY},function(oo){this.setTranslateY(oo)}),oh(0,oo,"scaleY",function(){return this._tf.scaleY},function(oo){this.setScaleY(oo)}),oh(0,oo,"block",function(){return 0!=(1&this._type)}),oh(0,oo,"skewY",function(){return this._tf.skewY},function(oo){this.setSkewY(oo)}),oh(0,oo,"rotate",function(){return this._tf.rotate},function(oo){this.setRotate(oo)}),oh(0,oo,"skewX",function(){return this._tf.skewX},function(oo){this.setSkewX(oo)}),oh(0,oo,"paddingLeft",function(){return 0}),oh(0,oo,"paddingTop",function(){return 0}),oh(0,oo,"absolute",function(){return!0}),oT.__init__=function(){oT._TF_EMPTY=new oW,oT.EMPTY=new oT},oT.EMPTY=null,oT._TF_EMPTY=null,oT}(),ov=function(){function or(oo){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=oI.create(or.defaultColor),this.family=or.defaultFamily,this.stroke=or._STROKE,this.size=or.defaultSize,oo&&oo!==or.EMPTY&&oo.copyTo(this)}oj(or,"laya.display.css.Font");var oo=or.prototype;return oo.set=function(oo){this._text=null;for(var or=oo.split(" "),oT=0,ok=or.length;oT<ok;oT++){var oW=or[oT];switch(oW){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<oW.indexOf("px")&&(this.size=parseInt(oW),this.family=or[oT+1],oT++)}},oo.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},oo.copyTo=function(oo){oo._type=this._type,oo._text=this._text,oo._weight=this._weight,oo._color=this._color,oo.family=this.family,oo.stroke=this.stroke!=or._STROKE?this.stroke.slice():or._STROKE,oo.indent=this.indent,oo.size=this.size},oh(0,oo,"password",function(){return 0!=(1024&this._type)},function(oo){oo?this._type|=1024:this._type&=-1025}),oh(0,oo,"color",function(){return this._color.strColor},function(oo){this._color=oI.create(oo)}),oh(0,oo,"italic",function(){return 0!=(512&this._type)},function(oo){oo?this._type|=512:this._type&=-513}),oh(0,oo,"bold",function(){return 0!=(2048&this._type)},function(oo){oo?this._type|=2048:this._type&=-2049}),oh(0,oo,"weight",function(){return""+this._weight},function(oo){var or=0;switch(oo){case"normal":break;case"bold":this.bold=!0,or=700;break;case"bolder":or=800;break;case"lighter":or=100;break;default:or=parseInt(oo)}this._weight=or,this._text=null}),oh(0,oo,"decoration",function(){return this._decoration?this._decoration.value:null},function(oo){var or=oo.split(" ");switch(this._decoration||(this._decoration={}),or[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=or[0]}or[1]&&(this._decoration.color=oI.create(or)),this._decoration.value=oo}),or.__init__=function(){or.EMPTY=new or(null)},or.EMPTY=null,or.defaultColor="#000000",or.defaultSize=12,or.defaultFamily="Arial",or.defaultFont="12px Arial",or._STROKE=[0,"#000000"],or._ITALIC=512,or._PASSWORD=1024,or._BOLD=2048,or}(),oW=function(){function oo(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return oj(oo,"laya.display.css.TransformInfo"),oo}(),oi=function(){function op(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,oC.isConchNode){this._nativeObj=new on._conchGraphics,this.id=this._nativeObj.conchID}}oj(op,"laya.display.Graphics");var oo=op.prototype;return oo.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},oo.clear=function(oo){void 0===oo&&(oo=!1);var or=0,oT=0;if(oo){var ok=this._one;if(this._cmds){for(oT=this._cmds.length,or=0;or<oT;or++)!(ok=this._cmds[or])||ok.callee!==oC._context._drawTexture&&ok.callee!==oC._context._drawTextureWithTransform||(ok[0]=null,op._cache.push(ok));this._cmds.length=0}else ok&&(!ok||ok.callee!==oC._context._drawTexture&&ok.callee!==oC._context._drawTextureWithTransform||(ok[0]=null,op._cache.push(ok)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(or=0,oT=this._vectorgraphArray.length;or<oT;or++)oB.getInstance().deleteShape(this._vectorgraphArray[or]);this._vectorgraphArray.length=0}},oo._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},oo._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new oT,this._graphicBounds._graphics=this)},oo._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},oo._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},oo.getBounds=function(oo){return void 0===oo&&(oo=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(oo)},oo.getBoundPoints=function(oo){return void 0===oo&&(oo=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(oo)},oo._addCmd=function(oo){this._cmds=this._cmds||[],oo.callee=oo.shift(),this._cmds.push(oo)},oo.setFilters=function(oo){this._saveToCmd(oC._context._setFilters,oo)},oo.drawTexture=function(oo,or,oT,ok,oW,oD,on){if(void 0===or&&(or=0),void 0===oT&&(oT=0),void 0===ok&&(ok=0),void 0===oW&&(oW=0),void 0===on&&(on=1),!oo||on<.01)return null;ok||(ok=oo.sourceWidth),oW||(oW=oo.sourceHeight),on=on<0?0:1<on?1:on;var oV,oL=!oC.isWebGL&&(oe.onFirefox||oe.onEdge||oe.onIE||oe.onSafari)?.5:0,oU=ok/oo.sourceWidth,oh=oW/oo.sourceHeight;return ok=oo.width*oU,oW=oo.height*oh,oo.loaded&&(ok<=0||oW<=0)?null:(or+=oo.offsetX*oU,oT+=oo.offsetY*oh,this._sp&&(this._sp._renderType|=512),or-=oL,oT-=oL,ok+=2*oL,oW+=2*oL,op._cache.length?((oV=op._cache.pop())[0]=oo,oV[1]=or,oV[2]=oT,oV[3]=ok,oV[4]=oW,oV[5]=oD,oV[6]=on):oV=[oo,or,oT,ok,oW,oD,on],oV.callee=oD||1!=on?oC._context._drawTextureWithTransform:oC._context._drawTexture,null!=this._one||oD||1!=on?this._saveToCmd(oV.callee,oV):(this._one=oV,this._render=this._renderOneImg),oo.loaded||oo.once("loaded",this,this._textureLoaded,[oo,oV]),this._repaint(),oV)},oo.cleanByTexture=function(oo,or,oT,ok,oW){if(void 0===ok&&(ok=0),void 0===oW&&(oW=0),!oo)return this.clear();if(this._one&&this._render===this._renderOneImg){ok||(ok=oo.sourceWidth),oW||(oW=oo.sourceHeight);var oD=ok/oo.sourceWidth,on=oW/oo.sourceHeight;ok=oo.width*oD,oW=oo.height*on,or+=oo.offsetX*oD,oT+=oo.offsetY*on,this._one[0]=oo,this._one[1]=or,this._one[2]=oT,this._one[3]=ok,this._one[4]=oW,this._repaint()}else this.clear(),oo&&this.drawTexture(oo,or,oT,ok,oW)},oo.drawTextures=function(oo,or){oo&&this._saveToCmd(oC._context._drawTextures,[oo,or])},oo.fillTexture=function(oo,or,oT,ok,oW,oD,on){if(void 0===ok&&(ok=0),void 0===oW&&(oW=0),void 0===oD&&(oD="repeat"),oo){var oV=[oo,or,oT,ok,oW,oD,on||oF.EMPTY,{}];oo.loaded||oo.once("loaded",this,this._textureLoaded,[oo,oV]),this._saveToCmd(oC._context._fillTexture,oV)}},oo._textureLoaded=function(oo,or){or[3]=or[3]||oo.width,or[4]=or[4]||oo.height,this._repaint()},oo.fillCircle=function(oo,or,oT,ok,oW,oD,on){oT.bitmap.enableMerageInAtlas=!1;var oV=new Float32Array(2*(on+1)),oL=new Float32Array(2*(on+1)),oU=new Uint16Array(3*on),oh=2*Math.PI/on,op=0;oV[0]=ok,oV[1]=oW,oL[0]=ok/oT.width,oL[1]=oW/oT.height;for(var oi=2,ov=0;ov<on;ov++){var ox=oD*Math.cos(op)+ok,oj=oD*Math.sin(op)+oW;oV[oi]=ox,oV[oi+1]=oj,oL[oi]=ox/oT.width,oL[oi+1]=oj/oT.height,op+=oh,oi+=2}for(ov=oi=0;ov<on;ov++)oU[oi++]=0,oU[oi++]=ov+1,oU[oi++]=on+1<=ov+2?1:ov+2;this.drawTriangles(oT,oo,or,oV,oL,oU)},oo.drawTriangles=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){void 0===oV&&(oV=1),this._saveToCmd(oC._context.drawTriangles,[oo,or,oT,ok,oW,oD,on,oV,oL,oU])},oo._saveToCmd=function(oo,or){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=or,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(or)),or.callee=oo,this._repaint(),or},oo.clipRect=function(oo,or,oT,ok){this._saveToCmd(oC._context._clipRect,[oo,or,oT,ok])},oo.fillText=function(oo,or,oT,ok,oW,oD,on){void 0===on&&(on=0),this._saveToCmd(oC._context._fillText,[oo,or,oT,ok||ov.defaultFont,oW,oD])},oo.fillBorderText=function(oo,or,oT,ok,oW,oD,on,oV){this._saveToCmd(oC._context._fillBorderText,[oo,or,oT,ok||ov.defaultFont,oW,oD,on,oV])},oo.strokeText=function(oo,or,oT,ok,oW,oD,on){this._saveToCmd(oC._context._strokeText,[oo,or,oT,ok||ov.defaultFont,oW,oD,on])},oo.alpha=function(oo){oo=oo<0?0:1<oo?1:oo,this._saveToCmd(oC._context._alpha,[oo])},oo.setAlpha=function(oo){oo=oo<0?0:1<oo?1:oo,this._saveToCmd(oC._context._setAlpha,[oo])},oo.transform=function(oo,or,oT){void 0===or&&(or=0),void 0===oT&&(oT=0),this._saveToCmd(oC._context._transform,[oo,or,oT])},oo.rotate=function(oo,or,oT){void 0===or&&(or=0),void 0===oT&&(oT=0),this._saveToCmd(oC._context._rotate,[oo,or,oT])},oo.scale=function(oo,or,oT,ok){void 0===oT&&(oT=0),void 0===ok&&(ok=0),this._saveToCmd(oC._context._scale,[oo,or,oT,ok])},oo.translate=function(oo,or){this._saveToCmd(oC._context._translate,[oo,or])},oo.save=function(){this._saveToCmd(oC._context._save,[])},oo.restore=function(){this._saveToCmd(oC._context._restore,[])},oo.replaceText=function(oo){this._repaint();var or=this._cmds;if(or){for(var oT=or.length-1;-1<oT;oT--)if(this._isTextCmd(or[oT].callee))return or[oT][0].toUpperCase?or[oT][0]=oo:or[oT][0].setText(oo),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=oo:this._one[0].setText(oo),!0;return!1},oo._isTextCmd=function(oo){return oo===oC._context._fillText||oo===oC._context._fillBorderText||oo===oC._context._strokeText},oo.replaceTextColor=function(oo){this._repaint();var or=this._cmds;if(or)for(var oT=or.length-1;-1<oT;oT--)this._isTextCmd(or[oT].callee)&&(or[oT][4]=oo,or[oT][0].toUpperCase||(or[oT][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=oo,this._one[0].toUpperCase||(this._one[0].changed=!0))},oo.loadImage=function(oo,or,oT,ok,oW,oD){var on=this;void 0===or&&(or=0),void 0===oT&&(oT=0),void 0===ok&&(ok=0),void 0===oW&&(oW=0);var oV=oVo.getRes(oo);function oL(oo){oo&&(on.drawTexture(oo,or,oT,ok,oW),null!=oD&&oD.call(on._sp,oo))}oV?oL(oV):ob.loader.load(oo,o$.create(null,oL),null,"image")},oo._renderEmpty=function(oo,or,oT,ok){},oo._renderAll=function(oo,or,oT,ok){for(var oW,oD=this._cmds,on=0,oV=oD.length;on<oV;on++)(oW=oD[on]).callee.call(or,oT,ok,oW)},oo._renderOne=function(oo,or,oT,ok){this._one.callee.call(or,oT,ok,this._one)},oo._renderOneImg=function(oo,or,oT,ok){this._one.callee.call(or,oT,ok,this._one),2305!==oo._renderType&&(oo._renderType|=1)},oo.drawLine=function(oo,or,oT,ok,oW,oD){void 0===oD&&(oD=1);var on=0;oC.isWebGL&&(on=oB.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(on));var oV=oD%2==0?0:.5,oL=[oo+oV,or+oV,oT+oV,ok+oV,oW,oD,on];this._saveToCmd(oC._context._drawLine,oL)},oo.drawLines=function(oo,or,oT,ok,oW){void 0===oW&&(oW=1);var oD=0;if(oT&&!(oT.length<4)){oC.isWebGL&&(oD=oB.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(oD));var on=oW%2==0?0:.5,oV=[oo+on,or+on,oT,ok,oW,oD];this._saveToCmd(oC._context._drawLines,oV)}},oo.drawCurves=function(oo,or,oT,ok,oW){void 0===oW&&(oW=1);var oD=[oo,or,oT,ok,oW];this._saveToCmd(oC._context._drawCurves,oD)},oo.drawRect=function(oo,or,oT,ok,oW,oD,on){void 0===on&&(on=1);var oV=oD?on/2:0,oL=oD?on:0,oU=[oo+oV,or+oV,oT-oL,ok-oL,oW,oD,on];this._saveToCmd(oC._context._drawRect,oU)},oo.drawCircle=function(oo,or,oT,ok,oW,oD){void 0===oD&&(oD=1);var on=oW?oD/2:0,oV=0;oC.isWebGL&&(oV=oB.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(oV));var oL=[oo,or,oT-on,ok,oW,oD,oV];this._saveToCmd(oC._context._drawCircle,oL)},oo.drawPie=function(oo,or,oT,ok,oW,oD,on,oV){void 0===oV&&(oV=1);var oL=on?oV/2:0,oU=on?oV:0,oh=0;oC.isWebGL&&(oh=oB.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(oh));var op=[oo+oL,or+oL,oT-oU,ok,oW,oD,on,oV,oh];op[3]=og.toRadian(ok),op[4]=og.toRadian(oW),this._saveToCmd(oC._context._drawPie,op)},oo.drawPoly=function(oo,or,oT,ok,oW,oD){void 0===oD&&(oD=1);var on=0,oV=!1;oC.isWebGL&&(on=oB.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(on),oV=!(6<oT.length));var oL=oW?oD%2==0?0:.5:0,oU=[oo+oL,or+oL,oT,ok,oW,oD,on,oV];this._saveToCmd(oC._context._drawPoly,oU)},oo.drawPath=function(oo,or,oT,ok,oW){var oD=[oo,or,oT,ok,oW];this._saveToCmd(oC._context._drawPath,oD)},oh(0,oo,"cmds",function(){return this._cmds},function(oo){this._sp&&(this._sp._renderType|=512),this._cmds=oo,this._render=this._renderAll,this._repaint()}),op.__init__=function(){if(oC.isConchNode){for(var oo=laya.display.Graphics.prototype,or=oe.window.ConchGraphics.prototype,oT=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],ok=0,oW=oT.length;ok<=oW;ok++){var oD=oT[ok];oo[oD]=or[oD]}oo._saveToCmd=null,or.drawImageS&&(oo.drawTextures=function(oo,or){if(oo&&oo.loaded&&oo.bitmap&&oo.source){var oT=oo.uv,ok=oo.bitmap.width,oW=oo.bitmap.height;this.drawImageS(oo.bitmap.source,oT[0]*ok,oT[1]*oW,(oT[2]-oT[0])*ok,(oT[5]-oT[3])*oW,oo.offsetX,oo.offsetY,oo.width,oo.height,or)}}),oo.drawTexture=function(oo,or,oT,ok,oW,oD,on){if(void 0===or&&(or=0),void 0===oT&&(oT=0),void 0===ok&&(ok=0),void 0===oW&&(oW=0),void 0===on&&(on=1),oo)if(oo.loaded){if(oo.loaded&&oo.bitmap&&oo.source&&(ok||(ok=oo.sourceWidth),oW||(oW=oo.sourceHeight),on=on<0?0:1<on?1:on,ok=ok-oo.sourceWidth+oo.width,oW=oW-oo.sourceHeight+oo.height,!(ok<=0||oW<=0))){or+=oo.offsetX,oT+=oo.offsetY;var oV=oo.uv,oL=oo.bitmap.width,oU=oo.bitmap.height;oV[4]<oV[0]&&oV[5]<oV[1]?this.drawImageM(oo.bitmap.source,oV[4]*oL,oV[5]*oU,(oV[0]-oV[4])*oL,(oV[1]-oV[5])*oU,or,oT,ok,oW,oD,on):this.drawImageM(oo.bitmap.source,oV[0]*oL,oV[1]*oU,(oV[2]-oV[0])*oL,(oV[5]-oV[3])*oU,or,oT,ok,oW,oD,on),this._repaint()}}else oo.once("loaded",this,function(){this.drawTexture(oo,or,oT,ok,oW,oD)})},oo.fillTexture=function(oo,or,oT,ok,oW,oD,on){if(void 0===ok&&(ok=0),void 0===oW&&(oW=0),void 0===oD&&(oD="repeat"),oo&&oo.loaded){var oV,oL=oC._context.ctx,oU=oo.bitmap.width,oh=oo.bitmap.height,op=oo.uv;oV=oo.uv!=oho.DEF_UV?oL.createPattern(oo.bitmap.source,oD,op[0]*oU,op[1]*oh,(op[2]-op[0])*oU,(op[5]-op[3])*oh):oL.createPattern(oo.bitmap.source,oD);var oi=0,ov=0;on&&(or+=on.x%oo.width,oT+=on.y%oo.height,oi-=on.x%oo.width,ov-=on.y%oo.height),this._fillImage(oV,or,oT,oi,ov,ok,oW)}}}},op._cache=[],op}(),oT=function(){function oy(){this._cacheBoundsType=!1}oj(oy,"laya.display.GraphicsBounds");var oo=oy.prototype;return oo.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},oo.reset=function(){this._temp&&(this._temp.length=0)},oo.getBounds=function(oo){return void 0===oo&&(oo=!1),(!this._bounds||!this._temp||this._temp.length<1||oo!=this._cacheBoundsType)&&(this._bounds=oP._getWrapRec(this.getBoundPoints(oo),this._bounds)),this._cacheBoundsType=oo,this._bounds},oo.getBoundPoints=function(oo){return void 0===oo&&(oo=!1),(!this._temp||this._temp.length<1||oo!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(oo)),this._cacheBoundsType=oo,this._rstBoundPoints=og.copyArray(this._rstBoundPoints,this._temp)},oo._getCmdPoints=function(oo){void 0===oo&&(oo=!1);var or,oT,ok=oC._context,oW=this._graphics.cmds;if((or=this._temp||(this._temp=[])).length=0,oW||null==this._graphics._one||(oy._tempCmds.length=0,oy._tempCmds.push(this._graphics._one),oW=oy._tempCmds),!oW)return or;(oT=oy._tempMatrixArrays).length=0;var oD=oy._initMatrix;oD.identity();for(var on,oV,oL=oy._tempMatrix,oU=NaN,oh=NaN,op=NaN,oi=NaN,ov=NaN,ox=NaN,oj=0,o_=oW.length;oj<o_;oj++)if((on=oW[oj]).callee)switch(on.callee){case ok._save:case 7:oT.push(oD),oD=oD.clone();break;case ok._restore:case 8:oD=oT.pop();break;case ok._scale:case 5:oL.identity(),oL.translate(-on[2],-on[3]),oL.scale(on[0],on[1]),oL.translate(on[2],on[3]),this._switchMatrix(oD,oL);break;case ok._rotate:case 3:oL.identity(),oL.translate(-on[1],-on[2]),oL.rotate(on[0]),oL.translate(on[1],on[2]),this._switchMatrix(oD,oL);break;case ok._translate:case 6:oL.identity(),oL.translate(on[0],on[1]),this._switchMatrix(oD,oL);break;case ok._transform:case 4:oL.identity(),oL.translate(-on[1],-on[2]),oL.concat(on[0]),oL.translate(on[1],on[2]),this._switchMatrix(oD,oL);break;case 16:case 24:oy._addPointArrToRst(or,oP._getBoundPointS(on[0],on[1],on[2],on[3]),oD);break;case 17:oD.copyTo(oL),oL.concat(on[4]),oy._addPointArrToRst(or,oP._getBoundPointS(on[0],on[1],on[2],on[3]),oL);break;case ok._drawTexture:oV=on[0],oo?on[3]&&on[4]?oy._addPointArrToRst(or,oP._getBoundPointS(on[1],on[2],on[3],on[4]),oD):(oV=on[0],oy._addPointArrToRst(or,oP._getBoundPointS(on[1],on[2],oV.width,oV.height),oD)):(oU=(on[3]||oV.sourceWidth)/oV.width,oh=(on[4]||oV.sourceHeight)/oV.height,op=oU*oV.sourceWidth,oi=oh*oV.sourceHeight,ov=0<oV.offsetX?oV.offsetX:0,ox=0<oV.offsetY?oV.offsetY:0,ov*=oU,ox*=oh,oy._addPointArrToRst(or,oP._getBoundPointS(on[1]-ov,on[2]-ox,op,oi),oD));break;case ok._fillTexture:on[3]&&on[4]?oy._addPointArrToRst(or,oP._getBoundPointS(on[1],on[2],on[3],on[4]),oD):(oV=on[0],oy._addPointArrToRst(or,oP._getBoundPointS(on[1],on[2],oV.width,oV.height),oD));break;case ok._drawTextureWithTransform:var oK;oK=on[5]?(oD.copyTo(oL),oL.concat(on[5]),oL):oD,oo?on[3]&&on[4]?oy._addPointArrToRst(or,oP._getBoundPointS(on[1],on[2],on[3],on[4]),oK):(oV=on[0],oy._addPointArrToRst(or,oP._getBoundPointS(on[1],on[2],oV.width,oV.height),oK)):(oV=on[0],oU=(on[3]||oV.sourceWidth)/oV.width,oh=(on[4]||oV.sourceHeight)/oV.height,op=oU*oV.sourceWidth,oi=oh*oV.sourceHeight,ov=0<oV.offsetX?oV.offsetX:0,ox=0<oV.offsetY?oV.offsetY:0,ov*=oU,ox*=oh,oy._addPointArrToRst(or,oP._getBoundPointS(on[1]-ov,on[2]-ox,op,oi),oK));break;case ok._drawRect:case 13:oy._addPointArrToRst(or,oP._getBoundPointS(on[0],on[1],on[2],on[3]),oD);break;case ok._drawCircle:case ok._fillCircle:case 14:oy._addPointArrToRst(or,oP._getBoundPointS(on[0]-on[2],on[1]-on[2],on[2]+on[2],on[2]+on[2]),oD);break;case ok._drawLine:case 20:oy._tempPoints.length=0;var o$;o$=.5*on[5],on[0]==on[2]?oy._tempPoints.push(on[0]+o$,on[1],on[2]+o$,on[3],on[0]-o$,on[1],on[2]-o$,on[3]):on[1]==on[3]?oy._tempPoints.push(on[0],on[1]+o$,on[2],on[3]+o$,on[0],on[1]-o$,on[2],on[3]-o$):oy._tempPoints.push(on[0],on[1],on[2],on[3]),oy._addPointArrToRst(or,oy._tempPoints,oD);break;case ok._drawCurves:case 22:oy._addPointArrToRst(or,ol.I.getBezierPoints(on[2]),oD,on[0],on[1]);break;case ok._drawPoly:case ok._drawLines:case 18:oy._addPointArrToRst(or,on[2],oD,on[0],on[1]);break;case ok._drawPath:case 19:oy._addPointArrToRst(or,this._getPathPoints(on[2]),oD,on[0],on[1]);break;case ok._drawPie:case 15:oy._addPointArrToRst(or,this._getPiePoints(on[0],on[1],on[2],on[3],on[4]),oD)}return 200<or.length?or=og.copyArray(or,oP._getWrapRec(or)._getBoundPoints()):8<or.length&&(or=oS.scanPList(or)),or},oo._switchMatrix=function(oo,or){or.concat(oo),or.copyTo(oo)},oo._getPiePoints=function(oo,or,oT,ok,oW){var oD=oy._tempPoints;oy._tempPoints.length=0,oD.push(oo,or);var on=(oW-ok)%(2*Math.PI)/10,oV=NaN,oL=ok;for(oV=0;oV<=10;oV++)oD.push(oo+oT*Math.cos(oL),or+oT*Math.sin(oL)),oL+=on;return oD},oo._getPathPoints=function(oo){var or,oT,ok=0,oW=oy._tempPoints;for(oW.length=0,or=oo.length,ok=0;ok<or;ok++)1<(oT=oo[ok]).length&&(oW.push(oT[1],oT[2]),3<oT.length&&oW.push(oT[3],oT[4]));return oW},oy._addPointArrToRst=function(oo,or,oT,ok,oW){void 0===ok&&(ok=0),void 0===oW&&(oW=0);var oD,on=0;for(oD=or.length,on=0;on<oD;on+=2)oy._addPointToRst(oo,or[on]+ok,or[on+1]+oW,oT)},oy._addPointToRst=function(oo,or,oT,ok){var oW=oF.TEMP;oW.setTo(or||0,oT||0),ok.transformPoint(oW),oo.push(oW.x,oW.y)},oy._tempPoints=[],oy._tempMatrixArrays=[],oy._tempCmds=[],oL(oy,["_tempMatrix",function(){return this._tempMatrix=new os},"_initMatrix",function(){return this._initMatrix=new os}]),oy}(),oD=function(){function oo(){}oj(oo,"laya.events.Event");var or=oo.prototype;return or.setTo=function(oo,or,oT){return this.type=oo,this.currentTarget=or,this.target=oT,this},or.stopPropagation=function(){this._stoped=!0},oh(0,or,"stageY",function(){return ob.stage.mouseY}),oh(0,or,"charCode",function(){return this.nativeEvent.charCode}),oh(0,or,"touches",function(){var oo=this.nativeEvent.touches;if(oo)for(var or=ob.stage,oT=0,ok=oo.length;oT<ok;oT++){var oW=oo[oT],oD=oF.TEMP;oD.setTo(oW.clientX,oW.clientY),or._canvasTransform.invertTransformPoint(oD),or.transform.invertTransformPoint(oD),oW.stageX=oD.x,oW.stageY=oD.y}return oo}),oh(0,or,"keyLocation",function(){return this.nativeEvent.keyLocation}),oh(0,or,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),oh(0,or,"altKey",function(){return this.nativeEvent.altKey}),oh(0,or,"shiftKey",function(){return this.nativeEvent.shiftKey}),oh(0,or,"stageX",function(){return ob.stage.mouseX}),oo.EMPTY=new oo,oo.MOUSE_DOWN="mousedown",oo.MOUSE_UP="mouseup",oo.CLICK="click",oo.RIGHT_MOUSE_DOWN="rightmousedown",oo.RIGHT_MOUSE_UP="rightmouseup",oo.RIGHT_CLICK="rightclick",oo.MOUSE_MOVE="mousemove",oo.MOUSE_OVER="mouseover",oo.MOUSE_OUT="mouseout",oo.MOUSE_WHEEL="mousewheel",oo.ROLL_OVER="mouseover",oo.ROLL_OUT="mouseout",oo.DOUBLE_CLICK="doubleclick",oo.CHANGE="change",oo.CHANGED="changed",oo.RESIZE="resize",oo.ADDED="added",oo.REMOVED="removed",oo.DISPLAY="display",oo.UNDISPLAY="undisplay",oo.ERROR="error",oo.COMPLETE="complete",oo.LOADED="loaded",oo.INITED="inited",oo.PROGRESS="progress",oo.INPUT="input",oo.RENDER="render",oo.OPEN="open",oo.MESSAGE="message",oo.CLOSE="close",oo.KEY_DOWN="keydown",oo.KEY_PRESS="keypress",oo.KEY_UP="keyup",oo.FRAME="enterframe",oo.DRAG_START="dragstart",oo.DRAG_MOVE="dragmove",oo.DRAG_END="dragend",oo.ENTER="enter",oo.SELECT="select",oo.BLUR="blur",oo.FOCUS="focus",oo.VISIBILITY_CHANGE="visibilitychange",oo.FOCUS_CHANGE="focuschange",oo.PLAYED="played",oo.PAUSED="paused",oo.STOPPED="stopped",oo.START="start",oo.END="end",oo.ENABLE_CHANGED="enablechanged",oo.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",oo.COMPONENT_ADDED="componentadded",oo.COMPONENT_REMOVED="componentremoved",oo.LAYER_CHANGED="layerchanged",oo.HIERARCHY_LOADED="hierarchyloaded",oo.RECOVERED="recovered",oo.RELEASED="released",oo.LINK="link",oo.LABEL="label",oo.FULL_SCREEN_CHANGE="fullscreenchange",oo.DEVICE_LOST="devicelost",oo.MESH_CHANGED="meshchanged",oo.MATERIAL_CHANGED="materialchanged",oo.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",oo.ANIMATION_CHANGED="animationchanged",oo.TRIGGER_ENTER="triggerenter",oo.TRIGGER_STAY="triggerstay",oo.TRIGGER_EXIT="triggerexit",oo.TRAIL_FILTER_CHANGE="trailfilterchange",oo.DOMINO_FILTER_CHANGE="dominofilterchange",oo}(),op=(function(){function oo(){}oj(oo,"laya.events.Keyboard"),oo.NUMBER_0=48,oo.NUMBER_1=49,oo.NUMBER_2=50,oo.NUMBER_3=51,oo.NUMBER_4=52,oo.NUMBER_5=53,oo.NUMBER_6=54,oo.NUMBER_7=55,oo.NUMBER_8=56,oo.NUMBER_9=57,oo.A=65,oo.B=66,oo.C=67,oo.D=68,oo.E=69,oo.F=70,oo.G=71,oo.H=72,oo.I=73,oo.J=74,oo.K=75,oo.L=76,oo.M=77,oo.N=78,oo.O=79,oo.P=80,oo.Q=81,oo.R=82,oo.S=83,oo.T=84,oo.U=85,oo.V=86,oo.W=87,oo.X=88,oo.Y=89,oo.Z=90,oo.F1=112,oo.F2=113,oo.F3=114,oo.F4=115,oo.F5=116,oo.F6=117,oo.F7=118,oo.F8=119,oo.F9=120,oo.F10=121,oo.F11=122,oo.F12=123,oo.F13=124,oo.F14=125,oo.F15=126,oo.NUMPAD=21,oo.NUMPAD_0=96,oo.NUMPAD_1=97,oo.NUMPAD_2=98,oo.NUMPAD_3=99,oo.NUMPAD_4=100,oo.NUMPAD_5=101,oo.NUMPAD_6=102,oo.NUMPAD_7=103,oo.NUMPAD_8=104,oo.NUMPAD_9=105,oo.NUMPAD_ADD=107,oo.NUMPAD_DECIMAL=110,oo.NUMPAD_DIVIDE=111,oo.NUMPAD_ENTER=108,oo.NUMPAD_MULTIPLY=106,oo.NUMPAD_SUBTRACT=109,oo.SEMICOLON=186,oo.EQUAL=187,oo.COMMA=188,oo.MINUS=189,oo.PERIOD=190,oo.SLASH=191,oo.BACKQUOTE=192,oo.LEFTBRACKET=219,oo.BACKSLASH=220,oo.RIGHTBRACKET=221,oo.QUOTE=222,oo.ALTERNATE=18,oo.BACKSPACE=8,oo.CAPS_LOCK=20,oo.COMMAND=15,oo.CONTROL=17,oo.DELETE=46,oo.ENTER=13,oo.ESCAPE=27,oo.PAGE_UP=33,oo.PAGE_DOWN=34,oo.END=35,oo.HOME=36,oo.LEFT=37,oo.UP=38,oo.RIGHT=39,oo.DOWN=40,oo.SHIFT=16,oo.SPACE=32,oo.TAB=9,oo.INSERT=45}(),function(){function oW(){}return oj(oW,"laya.events.KeyBoardManager"),oW.__init__=function(){oW._addEvent("keydown"),oW._addEvent("keypress"),oW._addEvent("keyup")},oW._addEvent=function(or){oe.document.addEventListener(or,function(oo){laya.events.KeyBoardManager._dispatch(oo,or)},!0)},oW._dispatch=function(oo,or){if(oW.enabled){oW._event._stoped=!1,oW._event.nativeEvent=oo,oW._event.keyCode=oo.keyCode||oo.which||oo.charCode,"keydown"===or?oW._pressKeys[oW._event.keyCode]=!0:"keyup"===or&&(oW._pressKeys[oW._event.keyCode]=null);for(var oT=ob.stage.focus&&null!=ob.stage.focus.event&&ob.stage.focus.displayedInStage?ob.stage.focus:ob.stage,ok=oT;ok;)ok.event(or,oW._event.setTo(or,ok,oT)),ok=ok.parent}},oW.hasKeyDown=function(oo){return oW._pressKeys[oo]},oW._pressKeys={},oW.enabled=!0,oL(oW,["_event",function(){return this._event=new oD}]),oW}()),ox=(function(){function oo(){}oj(oo,"laya.events.KeyLocation"),oo.STANDARD=0,oo.LEFT=1,oo.RIGHT=2,oo.NUM_PAD=3}(),function(){function oh(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=oe.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new oD,this._matrix=new os,this._point=new oF,this._rect=new oP,this._prePoint=new oF,this._curTouchID=NaN}oj(oh,"laya.events.MouseManager");var oo=oh.prototype;return oo.__init__=function(oo,or){var oT=this;this._stage=oo;var ok=this,oW=this._eventList;or.oncontextmenu=function(oo){if(oh.enabled)return!1},or.addEventListener("mousedown",function(oo){oh.enabled&&(oe.onIE||oo.preventDefault(),oW.push(oo),ok.mouseDownTime=oe.now())}),or.addEventListener("mouseup",function(oo){oh.enabled&&(oo.preventDefault(),oW.push(oo),ok.mouseDownTime=-oe.now())},!0),or.addEventListener("mousemove",function(oo){if(oh.enabled){oo.preventDefault();var or=oe.now();if(or-ok._lastMoveTimer<10)return;ok._lastMoveTimer=or,oW.push(oo)}},!0),or.addEventListener("mouseout",function(oo){oh.enabled&&oW.push(oo)}),or.addEventListener("mouseover",function(oo){oh.enabled&&oW.push(oo)}),or.addEventListener("touchstart",function(oo){oh.enabled&&(oW.push(oo),oh._isFirstTouch||oSo.isInputting||oo.preventDefault(),ok.mouseDownTime=oe.now())}),or.addEventListener("touchend",function(oo){oh.enabled?(oh._isFirstTouch||oSo.isInputting||oo.preventDefault(),oh._isFirstTouch=!1,oW.push(oo),ok.mouseDownTime=-oe.now()):oT._curTouchID=NaN},!0),or.addEventListener("touchmove",function(oo){oh.enabled&&(oo.preventDefault(),oW.push(oo))},!0),or.addEventListener("touchcancel",function(oo){oh.enabled?(oo.preventDefault(),oW.push(oo)):oT._curTouchID=NaN},!0),or.addEventListener("mousewheel",function(oo){oh.enabled&&oW.push(oo)}),or.addEventListener("DOMMouseScroll",function(oo){oh.enabled&&oW.push(oo)})},oo.initEvent=function(oo,or){var oT;this._event._stoped=!1,this._event.nativeEvent=or||oo,this._target=null,this._point.setTo(oo.pageX||oo.clientX,oo.pageY||oo.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=oo.identifier||0,this._tTouchID=this._event.touchId,(oT=o_.I._event)._stoped=!1,oT.nativeEvent=this._event.nativeEvent,oT.touchId=this._event.touchId},oo.checkMouseWheel=function(oo){this._event.delta=oo.wheelDelta?.025*oo.wheelDelta:-oo.detail;for(var or=o_.I.getLastOvers(),oT=0,ok=or.length;oT<ok;oT++){var oW=or[oT];oW.event("mousewheel",this._event.setTo("mousewheel",oW,this._target))}},oo.onMouseMove=function(oo){o_.I.onMouseMove(oo,this._tTouchID)},oo.onMouseDown=function(oo){if(oSo.isInputting&&ob.stage.focus&&ob.stage.focus.focus&&!ob.stage.focus.contains(this._target)){var or=ob.stage.focus._tf||ob.stage.focus,oT=oo._tf||oo;oT instanceof laya.display.Input&&oT.multiline==or.multiline?or._focusOut():or.focus=!1}o_.I.onMouseDown(oo,this._tTouchID,this._isLeftMouse)},oo.onMouseUp=function(oo){o_.I.onMouseUp(oo,this._tTouchID,this._isLeftMouse)},oo.check=function(oo,or,oT,ok){this._point.setTo(or,oT),oo.fromParentPoint(this._point),or=this._point.x,oT=this._point.y;var oW=oo.scrollRect;if(oW&&(this._rect.setTo(oW.x,oW.y,oW.width,oW.height),!this._rect.contains(or,oT)))return!1;if(!this.disableMouseEvent){if(oo.hitTestPrior&&!oo.mouseThrough&&!this.hitTest(oo,or,oT))return!1;for(var oD=oo._childs.length-1;-1<oD;oD--){var on=oo._childs[oD];if(!on.destroyed&&on.mouseEnabled&&on.visible&&this.check(on,or,oT,ok))return!0}}var oV=!(!oo.hitTestPrior||oo.mouseThrough||this.disableMouseEvent)||this.hitTest(oo,or,oT);return oV?(this._target=oo,ok.call(this,oo)):ok===this.onMouseUp&&oo===this._stage&&(this._target=this._stage,ok.call(this,this._target)),oV},oo.hitTest=function(oo,or,oT){var ok=!1;if(oo.scrollRect&&(or-=oo.scrollRect.x,oT-=oo.scrollRect.y),oo.hitArea instanceof laya.utils.HitArea)return oo.hitArea.isHit(or,oT);if(0<oo.width&&0<oo.height||oo.mouseThrough||oo.hitArea)if(oo.mouseThrough)ok=oo.getGraphicBounds().contains(or,oT);else{var oW=this._rect;oo.hitArea?oW=oo.hitArea:oW.setTo(0,0,oo.width,oo.height),ok=oW.contains(or,oT)}return ok},oo.runEvent=function(){var oo=this._eventList.length;if(oo){var or=this;or.mouseEventTime=oe.now();var oT,ok=0,oW=0,oD=0;try{for(;ok<oo;){var on=this._eventList[ok];switch("mousemove"!==on.type&&(this._prePoint.x=this._prePoint.y=-1e6),on.type){case"mousedown":this._touchIDs[0]=this._id++,oh._isTouchRespond?oh._isTouchRespond=!1:(or._isLeftMouse=0===on.button,or.initEvent(on),or.check(or._stage,or.mouseX,or.mouseY,or.onMouseDown));break;case"mouseup":or._isLeftMouse=0===on.button,or.initEvent(on),or.check(or._stage,or.mouseX,or.mouseY,or.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-on.clientX)+Math.abs(this._prePoint.y-on.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=on.clientX,this._prePoint.y=on.clientY,or.initEvent(on),or.check(or._stage,or.mouseX,or.mouseY,or.onMouseMove));break;case"touchstart":oh._isTouchRespond=!0,or._isLeftMouse=!0;var oV=on.changedTouches;for(oW=0,oD=oV.length;oW<oD;oW++)oT=oV[oW],(oh.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=oT.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[oT.identifier]=this._id++,or.initEvent(oT,on),or.check(or._stage,or.mouseX,or.mouseY,or.onMouseDown));break;case"touchend":case"touchcancel":oh._isTouchRespond=!0,or._isLeftMouse=!0;var oL=on.changedTouches;for(oW=0,oD=oL.length;oW<oD;oW++)if(oT=oL[oW],oh.multiTouchEnabled||oT.identifier==this._curTouchID){this._curTouchID=NaN,or.initEvent(oT,on);or.check(or._stage,or.mouseX,or.mouseY,or.onMouseUp)||or.onMouseUp(null)}break;case"touchmove":var oU=on.changedTouches;for(oW=0,oD=oU.length;oW<oD;oW++)oT=oU[oW],(oh.multiTouchEnabled||oT.identifier==this._curTouchID)&&(or.initEvent(oT,on),or.check(or._stage,or.mouseX,or.mouseY,or.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":or.checkMouseWheel(on);break;case"mouseout":o_.I.stageMouseOut();break;case"mouseover":or._stage.event("mouseover",or._event.setTo("mouseover",or._stage,or._stage))}ok++}}catch(oo){throw this._eventList.length=0,oo}this._eventList.length=0}},oh.enabled=!0,oh.multiTouchEnabled=!0,oh._isTouchRespond=!1,oh._isFirstTouch=!0,oL(oh,["instance",function(){return this.instance=new oh}]),oh}()),o_=function(){function ox(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new oD}oj(ox,"laya.events.TouchManager");var oo=ox.prototype;return oo._clearTempArrs=function(){ox._oldArr.length=0,ox._newArr.length=0,ox._tEleArr.length=0},oo.getTouchFromArr=function(oo,or){var oT,ok,oW=0;for(oT=or.length,oW=0;oW<oT;oW++)if((ok=or[oW]).id==oo)return ok;return null},oo.removeTouchFromArr=function(oo,or){var oT=0;for(oT=or.length-1;0<=oT;oT--)or[oT].id==oo&&or.splice(oT,1)},oo.createTouchO=function(oo,or){var oT;return(oT=oG.getItem("TouchData")||{}).id=or,oT.tar=oo,oT},oo.onMouseDown=function(oo,or,oT){var ok,oW,oD,on;(void 0===oT&&(oT=!1),this.enable)&&(ok=this.getTouchFromArr(or,this.preOvers),oD=this.getEles(oo,null,ox._tEleArr),ok?ok.tar=oo:(oW=this.createTouchO(oo,or),this.preOvers.push(oW)),oe.onMobile&&this.sendEvents(oD,"mouseover",or),on=oT?this.preDowns:this.preRightDowns,(ok=this.getTouchFromArr(or,on))?ok.tar=oo:(oW=this.createTouchO(oo,or),on.push(oW)),this.sendEvents(oD,oT?"mousedown":"rightmousedown",or),this._clearTempArrs())},oo.sendEvents=function(oo,or,oT){void 0===oT&&(oT=0);var ok,oW,oD,on=0;for(ok=oo.length,this._event._stoped=!1,oW=oo[0],on=0;on<ok;on++){if((oD=oo[on]).destroyed)return;if(oD.event(or,this._event.setTo(or,oD,oW)),this._event._stoped)break}},oo.getEles=function(oo,or,oT){for(oT?oT.length=0:oT=[];oo&&oo!=or;)oT.push(oo),oo=oo.parent;return oT},oo.checkMouseOutAndOverOfMove=function(oo,or,oT){if(void 0===oT&&(oT=0),or!=oo){var ok,oW,oD=0,on=0;if(or.contains(oo))oW=this.getEles(oo,or,ox._tEleArr),this.sendEvents(oW,"mouseover",oT);else if(oo.contains(or))oW=this.getEles(or,oo,ox._tEleArr),this.sendEvents(oW,"mouseout",oT);else{var oV,oL;(oW=ox._tEleArr).length=0,oV=this.getEles(or,null,ox._oldArr),oL=this.getEles(oo,null,ox._newArr),on=oV.length;var oU=0;for(oD=0;oD<on;oD++){if(ok=oV[oD],0<=(oU=oL.indexOf(ok))){oL.splice(oU,oL.length-oU);break}oW.push(ok)}0<oW.length&&this.sendEvents(oW,"mouseout",oT),0<oL.length&&this.sendEvents(oL,"mouseover",oT)}}},oo.onMouseMove=function(oo,or){var oT,ok;this.enable&&((oT=this.getTouchFromArr(or,this.preOvers))?(this.checkMouseOutAndOverOfMove(oo,oT.tar),oT.tar=oo,ok=this.getEles(oo,null,ox._tEleArr)):(ok=this.getEles(oo,null,ox._tEleArr),this.sendEvents(ok,"mouseover",or),this.preOvers.push(this.createTouchO(oo,or))),this.sendEvents(ok,"mousemove",or),this._clearTempArrs())},oo.getLastOvers=function(){return(ox._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,ox._tEleArr):(ox._tEleArr.push(ob.stage),ox._tEleArr)},oo.stageMouseOut=function(){var oo;oo=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(oo,"mouseout",0)},oo.onMouseUp=function(oo,or,oT){if(void 0===oT&&(oT=!1),this.enable){var ok,oW,oD,on,oV,oL,oU=0,oh=0,op=oe.onMobile;if(oW=this.getEles(oo,null,ox._tEleArr),this.sendEvents(oW,oT?"mouseup":"rightmouseup",or),oL=oT?this.preDowns:this.preRightDowns,ok=this.getTouchFromArr(or,oL)){var oi,ov=oe.now();if(oi=ov-this._lastClickTime<300,this._lastClickTime=ov,oo==ok.tar)oV=oW;else for(oD=this.getEles(ok.tar,null,ox._oldArr),(oV=ox._newArr).length=0,oh=oD.length,oU=0;oU<oh;oU++)on=oD[oU],0<=oW.indexOf(on)&&oV.push(on);0<oV.length&&this.sendEvents(oV,oT?"click":"rightclick",or),oT&&oi&&this.sendEvents(oV,"doubleclick",or),this.removeTouchFromArr(or,oL),ok.tar=null,oG.recover("TouchData",ok)}else;(ok=this.getTouchFromArr(or,this.preOvers))&&op&&((oV=this.getEles(ok.tar,null,oV))&&0<oV.length&&this.sendEvents(oV,"mouseout",or),this.removeTouchFromArr(or,this.preOvers),ok.tar=null,oG.recover("TouchData",ok)),this._clearTempArrs()}},ox._oldArr=[],ox._newArr=[],ox._tEleArr=[],oL(ox,["I",function(){return this.I=new ox}]),ox}(),oK=function(){function oo(){this._action=null}oj(oo,"laya.filters.Filter");var or=oo.prototype;return ob.imps(or,{"laya.filters.IFilter":!0}),or.callNative=function(oo){},oh(0,or,"type",function(){return-1}),oh(0,or,"action",function(){return this._action}),oo.BLUR=16,oo.COLOR=32,oo.GLOW=8,oo._filterStart=null,oo._filterEnd=null,oo._EndTarget=null,oo._recycleScope=null,oo._filter=null,oo._useSrc=null,oo._endSrc=null,oo._useOut=null,oo._endOut=null,oo}(),oy=function(){function oo(){this.data=null}oj(oo,"laya.filters.ColorFilterAction");var or=oo.prototype;return ob.imps(or,{"laya.filters.IFilterAction":!0}),or.apply=function(oo){var or=oo.ctx.ctx,oT=oo.ctx.ctx.canvas;if(0==oT.width||0==oT.height)return oT;for(var ok,oW=or.getImageData(0,0,oT.width,oT.height),oD=oW.data,on=0,oV=oD.length;on<oV;on+=4)ok=this.getColor(oD[on],oD[on+1],oD[on+2],oD[on+3]),0!=oD[on+3]&&(oD[on]=ok[0],oD[on+1]=ok[1],oD[on+2]=ok[2],oD[on+3]=ok[3]);return or.putImageData(oW,0,0),oo},or.getColor=function(oo,or,oT,ok){var oW=[];if(this.data._mat&&this.data._alpha){var oD=this.data._mat,on=this.data._alpha;oW[0]=oD[0]*oo+oD[1]*or+oD[2]*oT+oD[3]*ok+on[0],oW[1]=oD[4]*oo+oD[5]*or+oD[6]*oT+oD[7]*ok+on[1],oW[2]=oD[8]*oo+oD[9]*or+oD[10]*oT+oD[11]*ok+on[2],oW[3]=oD[12]*oo+oD[13]*or+oD[14]*oT+oD[15]*ok+on[3]}return oW},oo}(),ol=(function(){function oo(){}oj(oo,"laya.maths.Arith"),oo.formatR=function(oo){return oo>Math.PI&&(oo-=2*Math.PI),oo<-Math.PI&&(oo+=2*Math.PI),oo},oo.isPOT=function(oo,or){return 0<oo&&0==(oo&oo-1)&&0<or&&0==(or&or-1)},oo.setMatToArray=function(oo,or){oo.a,oo.b,oo.c,oo.d,oo.tx,oo.ty,or[0]=oo.a,or[1]=oo.b,or[4]=oo.c,or[5]=oo.d,or[12]=oo.tx,or[13]=oo.ty}}(),function(){function oo(){this._controlPoints=[new oF,new oF,new oF],this._calFun=this.getPoint2}oj(oo,"laya.maths.Bezier");var or=oo.prototype;return or._switchPoint=function(oo,or){var oT=this._controlPoints.shift();oT.setTo(oo,or),this._controlPoints.push(oT)},or.getPoint2=function(oo,or){var oT=this._controlPoints[0],ok=this._controlPoints[1],oW=this._controlPoints[2],oD=Math.pow(1-oo,2)*oT.x+2*oo*(1-oo)*ok.x+Math.pow(oo,2)*oW.x,on=Math.pow(1-oo,2)*oT.y+2*oo*(1-oo)*ok.y+Math.pow(oo,2)*oW.y;or.push(oD,on)},or.getPoint3=function(oo,or){var oT=this._controlPoints[0],ok=this._controlPoints[1],oW=this._controlPoints[2],oD=this._controlPoints[3],on=Math.pow(1-oo,3)*oT.x+3*ok.x*oo*(1-oo)*(1-oo)+3*oW.x*oo*oo*(1-oo)+oD.x*Math.pow(oo,3),oV=Math.pow(1-oo,3)*oT.y+3*ok.y*oo*(1-oo)*(1-oo)+3*oW.y*oo*oo*(1-oo)+oD.y*Math.pow(oo,3);or.push(on,oV)},or.insertPoints=function(oo,or){var oT,ok=NaN;for(oT=1/(oo=0<oo?oo:5),ok=0;ok<=1;ok+=oT)this._calFun(ok,or)},or.getBezierPoints=function(oo,or,oT){void 0===or&&(or=5),void 0===oT&&(oT=2);var ok,oW,oD=0;if((ok=oo.length)<2*(oT+1))return[];switch(oW=[],oT){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=oT;)this._controlPoints.push(new oF);for(oD=0;oD<2*oT;oD+=2)this._switchPoint(oo[oD],oo[oD+1]);for(oD=2*oT;oD<ok;oD+=2)this._switchPoint(oo[oD],oo[oD+1]),oD/2%oT==0&&this.insertPoints(or,oW);return oW},oL(oo,["I",function(){return this.I=new oo}]),oo}()),oS=function(){function oU(){}return oj(oU,"laya.maths.GrahamScan"),oU.multiply=function(oo,or,oT){return(oo.x-oT.x)*(or.y-oT.y)-(or.x-oT.x)*(oo.y-oT.y)},oU.dis=function(oo,or){return(oo.x-or.x)*(oo.x-or.x)+(oo.y-or.y)*(oo.y-or.y)},oU._getPoints=function(oo,or,oT){for(void 0===or&&(or=!1),oU._mPointList||(oU._mPointList=[]);oU._mPointList.length<oo;)oU._mPointList.push(new oF);return oT||(oT=[]),oT.length=0,or?oU.getFrom(oT,oU._mPointList,oo):oU.getFromR(oT,oU._mPointList,oo),oT},oU.getFrom=function(oo,or,oT){var ok=0;for(ok=0;ok<oT;ok++)oo.push(or[ok]);return oo},oU.getFromR=function(oo,or,oT){var ok=0;for(ok=0;ok<oT;ok++)oo.push(or.pop());return oo},oU.pListToPointList=function(oo,or){void 0===or&&(or=!1);var oT=0,ok=oo.length/2,oW=oU._getPoints(ok,or,oU._tempPointList);for(oT=0;oT<ok;oT++)oW[oT].setTo(oo[oT+oT],oo[oT+oT+1]);return oW},oU.pointListToPlist=function(oo){var or,oT=0,ok=oo.length,oW=oU._temPList;for(oT=oW.length=0;oT<ok;oT++)or=oo[oT],oW.push(or.x,or.y);return oW},oU.scanPList=function(oo){return og.copyArray(oo,oU.pointListToPlist(oU.scan(oU.pListToPointList(oo,!0))))},oU.scan=function(oo){var or,oT,ok,oW=0,oD=0,on=0,oV=oo.length,oL={};for((oT=oU._temArr).length=0,oW=(oV=oo.length)-1;0<=oW;oW--)ok=(or=oo[oW]).x+"_"+or.y,oL.hasOwnProperty(ok)||(oL[ok]=!0,oT.push(or));for(oV=oT.length,og.copyArray(oo,oT),oW=1;oW<oV;oW++)(oo[oW].y<oo[on].y||oo[oW].y==oo[on].y&&oo[oW].x<oo[on].x)&&(on=oW);for(or=oo[0],oo[0]=oo[on],oo[on]=or,oW=1;oW<oV-1;oW++){for(oD=(on=oW)+1;oD<oV;oD++)(0<oU.multiply(oo[oD],oo[on],oo[0])||0==oU.multiply(oo[oD],oo[on],oo[0])&&oU.dis(oo[0],oo[oD])<oU.dis(oo[0],oo[on]))&&(on=oD);or=oo[oW],oo[oW]=oo[on],oo[on]=or}if((oT=oU._temArr).length=0,oo.length<3)return og.copyArray(oT,oo);for(oT.push(oo[0],oo[1],oo[2]),oW=3;oW<oV;oW++){for(;2<=oT.length&&0<=oU.multiply(oo[oW],oT[oT.length-1],oT[oT.length-2]);)oT.pop();oo[oW]&&oT.push(oo[oW])}return oT},oU._mPointList=null,oU._tempPointList=[],oU._temPList=[],oU._temArr=[],oU}(),oq=function(){function oW(){}return oj(oW,"laya.maths.MathUtil"),oW.subtractVector3=function(oo,or,oT){oT[0]=oo[0]-or[0],oT[1]=oo[1]-or[1],oT[2]=oo[2]-or[2]},oW.lerp=function(oo,or,oT){return oo*(1-oT)+or*oT},oW.scaleVector3=function(oo,or,oT){oT[0]=oo[0]*or,oT[1]=oo[1]*or,oT[2]=oo[2]*or},oW.lerpVector3=function(oo,or,oT,ok){var oW=oo[0],oD=oo[1],on=oo[2];ok[0]=oW+oT*(or[0]-oW),ok[1]=oD+oT*(or[1]-oD),ok[2]=on+oT*(or[2]-on)},oW.lerpVector4=function(oo,or,oT,ok){var oW=oo[0],oD=oo[1],on=oo[2],oV=oo[3];ok[0]=oW+oT*(or[0]-oW),ok[1]=oD+oT*(or[1]-oD),ok[2]=on+oT*(or[2]-on),ok[3]=oV+oT*(or[3]-oV)},oW.slerpQuaternionArray=function(oo,or,oT,ok,oW,oD,on){var oV,oL,oU,oh,op,oi=oo[or+0],ov=oo[or+1],ox=oo[or+2],oj=oo[or+3],o_=oT[ok+0],oK=oT[ok+1],o$=oT[ok+2],oy=oT[ok+3];return(oL=oi*o_+ov*oK+ox*o$+oj*oy)<0&&(oL=-oL,o_=-o_,oK=-oK,o$=-o$,oy=-oy),op=1e-6<1-oL?(oV=Math.acos(oL),oU=Math.sin(oV),oh=Math.sin((1-oW)*oV)/oU,Math.sin(oW*oV)/oU):(oh=1-oW,oW),oD[on+0]=oh*oi+op*o_,oD[on+1]=oh*ov+op*oK,oD[on+2]=oh*ox+op*o$,oD[on+3]=oh*oj+op*oy,oD},oW.getRotation=function(oo,or,oT,ok){return Math.atan2(ok-or,oT-oo)/Math.PI*180},oW.sortBigFirst=function(oo,or){return oo==or?0:oo<or?1:-1},oW.sortSmallFirst=function(oo,or){return oo==or?0:oo<or?-1:1},oW.sortNumBigFirst=function(oo,or){return parseFloat(or)-parseFloat(oo)},oW.sortNumSmallFirst=function(oo,or){return parseFloat(oo)-parseFloat(or)},oW.sortByKey=function(oT,oo,or){var ok;return void 0===oo&&(oo=!1),void 0===or&&(or=!0),ok=oo?or?oW.sortNumBigFirst:oW.sortBigFirst:or?oW.sortNumSmallFirst:oW.sortSmallFirst,function(oo,or){return ok(oo[oT],or[oT])}},oW}(),os=function(){function oT(oo,or,oT,ok,oW,oD){this.inPool=!1,this.bTransform=!1,void 0===oo&&(oo=1),void 0===or&&(or=0),void 0===oT&&(oT=0),void 0===ok&&(ok=1),void 0===oW&&(oW=0),void 0===oD&&(oD=0),this.a=oo,this.b=or,this.c=oT,this.d=ok,this.tx=oW,this.ty=oD,this._checkTransform()}oj(oT,"laya.maths.Matrix");var oo=oT.prototype;return oo.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},oo._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},oo.setTranslate=function(oo,or){return this.tx=oo,this.ty=or,this},oo.translate=function(oo,or){return this.tx+=oo,this.ty+=or,this},oo.scale=function(oo,or){this.a*=oo,this.d*=or,this.c*=oo,this.b*=or,this.tx*=oo,this.ty*=or,this.bTransform=!0},oo.rotate=function(oo){var or=Math.cos(oo),oT=Math.sin(oo),ok=this.a,oW=this.c,oD=this.tx;this.a=ok*or-this.b*oT,this.b=ok*oT+this.b*or,this.c=oW*or-this.d*oT,this.d=oW*oT+this.d*or,this.tx=oD*or-this.ty*oT,this.ty=oD*oT+this.ty*or,this.bTransform=!0},oo.skew=function(oo,or){var oT=Math.tan(oo),ok=Math.tan(or),oW=this.a,oD=this.b;return this.a+=ok*this.c,this.b+=ok*this.d,this.c+=oT*oW,this.d+=oT*oD,this},oo.invertTransformPoint=function(oo){var or=this.a,oT=this.b,ok=this.c,oW=this.d,oD=this.tx,on=or*oW-oT*ok,oV=oW/on,oL=-oT/on,oU=-ok/on,oh=or/on,op=(ok*this.ty-oW*oD)/on,oi=-(or*this.ty-oT*oD)/on;return oo.setTo(oV*oo.x+oU*oo.y+op,oL*oo.x+oh*oo.y+oi)},oo.transformPoint=function(oo){return oo.setTo(this.a*oo.x+this.c*oo.y+this.tx,this.b*oo.x+this.d*oo.y+this.ty)},oo.transformPointN=function(oo){return oo.setTo(this.a*oo.x+this.c*oo.y,this.b*oo.x+this.d*oo.y)},oo.transformPointArray=function(oo,or){for(var oT=oo.length,ok=0;ok<oT;ok+=2){var oW=oo[ok],oD=oo[ok+1];or[ok]=this.a*oW+this.c*oD+this.tx,or[ok+1]=this.b*oW+this.d*oD+this.ty}return or},oo.transformPointArrayScale=function(oo,or){for(var oT=oo.length,ok=0;ok<oT;ok+=2){var oW=oo[ok],oD=oo[ok+1];or[ok]=this.a*oW+this.c*oD,or[ok+1]=this.b*oW+this.d*oD}return or},oo.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},oo.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},oo.invert=function(){var oo=this.a,or=this.b,oT=this.c,ok=this.d,oW=this.tx,oD=oo*ok-or*oT;return this.a=ok/oD,this.b=-or/oD,this.c=-oT/oD,this.d=oo/oD,this.tx=(oT*this.ty-ok*oW)/oD,this.ty=-(oo*this.ty-or*oW)/oD,this},oo.setTo=function(oo,or,oT,ok,oW,oD){return this.a=oo,this.b=or,this.c=oT,this.d=ok,this.tx=oW,this.ty=oD,this},oo.concat=function(oo){var or=this.a,oT=this.c,ok=this.tx;return this.a=or*oo.a+this.b*oo.c,this.b=or*oo.b+this.b*oo.d,this.c=oT*oo.a+this.d*oo.c,this.d=oT*oo.b+this.d*oo.d,this.tx=ok*oo.a+this.ty*oo.c+oo.tx,this.ty=ok*oo.b+this.ty*oo.d+oo.ty,this},oo.scaleEx=function(oo,or){var oT=this.a,ok=this.b,oW=this.c,oD=this.d;0!==ok||0!==oW?(this.a=oo*oT,this.b=oo*ok,this.c=or*oW):(this.a=oo*oT,this.b=0*oD,this.c=0*oT),this.d=or*oD,this.bTransform=!0},oo.rotateEx=function(oo){var or=Math.cos(oo),oT=Math.sin(oo),ok=this.a,oW=this.b,oD=this.c,on=this.d;0!==oW||0!==oD?(this.a=or*ok+oT*oD,this.b=or*oW+oT*on,this.c=-oT*ok+or*oD,this.d=-oT*oW+or*on):(this.a=or*ok,this.b=oT*on,this.c=-oT*ok,this.d=or*on),this.bTransform=!0},oo.clone=function(){var oo=oT.create();return oo.a=this.a,oo.b=this.b,oo.c=this.c,oo.d=this.d,oo.tx=this.tx,oo.ty=this.ty,oo.bTransform=this.bTransform,oo},oo.copyTo=function(oo){return oo.a=this.a,oo.b=this.b,oo.c=this.c,oo.d=this.d,oo.tx=this.tx,oo.ty=this.ty,oo.bTransform=this.bTransform,oo},oo.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},oo.destroy=function(){if(!this.inPool){var oo=oT._cache;this.inPool=!0,oo._length||(oo._length=0),(oo[oo._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},oT.mul=function(oo,or,oT){var ok=oo.a,oW=oo.b,oD=oo.c,on=oo.d,oV=oo.tx,oL=oo.ty,oU=or.a,oh=or.b,op=or.c,oi=or.d,ov=or.tx,ox=or.ty;return 0!==oh||0!==op?(oT.a=ok*oU+oW*op,oT.b=ok*oh+oW*oi,oT.c=oD*oU+on*op,oT.d=oD*oh+on*oi,oT.tx=oU*oV+op*oL+ov,oT.ty=oh*oV+oi*oL+ox):(oT.a=ok*oU,oT.b=oW*oi,oT.c=oD*oU,oT.d=on*oi,oT.tx=oU*oV+ov,oT.ty=oi*oL+ox),oT},oT.mul16=function(oo,or,oT){var ok=oo.a,oW=oo.b,oD=oo.c,on=oo.d,oV=oo.tx,oL=oo.ty,oU=or.a,oh=or.b,op=or.c,oi=or.d,ov=or.tx,ox=or.ty;return 0!==oh||0!==op?(oT[0]=ok*oU+oW*op,oT[1]=ok*oh+oW*oi,oT[4]=oD*oU+on*op,oT[5]=oD*oh+on*oi,oT[12]=oU*oV+op*oL+ov,oT[13]=oh*oV+oi*oL+ox):(oT[0]=ok*oU,oT[1]=oW*oi,oT[4]=oD*oU,oT[5]=on*oi,oT[12]=oU*oV+ov,oT[13]=oi*oL+ox),oT},oT.mulPre=function(oo,or,oT,ok,oW,oD,on,oV){var oL=oo.a,oU=oo.b,oh=oo.c,op=oo.d,oi=oo.tx,ov=oo.ty;return 0!==oT||0!==ok?(oV.a=oL*or+oU*ok,oV.b=oL*oT+oU*oW,oV.c=oh*or+op*ok,oV.d=oh*oT+op*oW,oV.tx=or*oi+ok*ov+oD,oV.ty=oT*oi+oW*ov+on):(oV.a=oL*or,oV.b=oU*oW,oV.c=oh*or,oV.d=op*oW,oV.tx=or*oi+oD,oV.ty=oW*ov+on),oV},oT.mulPos=function(oo,or,oT,ok,oW,oD,on,oV){var oL=oo.a,oU=oo.b,oh=oo.c,op=oo.d,oi=oo.tx,ov=oo.ty;return 0!==oU||0!==oh?(oV.a=or*oL+oT*oh,oV.b=or*oU+oT*op,oV.c=ok*oL+oW*oh,oV.d=ok*oU+oW*op,oV.tx=oL*oD+oh*on+oi,oV.ty=oU*oD+op*on+ov):(oV.a=or*oL,oV.b=oT*op,oV.c=ok*oL,oV.d=oW*op,oV.tx=oL*oD+oi,oV.ty=op*on+ov),oV},oT.preMul=function(oo,or,oT){var ok=oo.a,oW=oo.b,oD=oo.c,on=oo.d,oV=or.a,oL=or.b,oU=or.c,oh=or.d,op=or.tx,oi=or.ty;return oT.a=oV*ok,oT.b=oT.c=0,oT.d=oh*on,oT.tx=op*ok+oo.tx,oT.ty=oi*on+oo.ty,0===oL&&0===oU&&0===oW&&0===oD||(oT.a+=oL*oD,oT.d+=oU*oW,oT.b+=oV*oW+oL*on,oT.c+=oU*ok+oh*oD,oT.tx+=oi*oD,oT.ty+=op*oW),oT},oT.preMulXY=function(oo,or,oT,ok){var oW=oo.a,oD=oo.b,on=oo.c,oV=oo.d;return ok.a=oW,ok.b=oD,ok.c=on,ok.d=oV,ok.tx=or*oW+oo.tx+oT*on,ok.ty=oT*oV+oo.ty+or*oD,ok},oT.create=function(){var oo=oT._cache,or=oo._length?oo[--oo._length]:new oT;return or.inPool=!1,or},oT.EMPTY=new oT,oT.TEMP=new oT,oT._cache=[],oT}(),oF=function(){function oo(oo,or){void 0===oo&&(oo=0),void 0===or&&(or=0),this.x=oo,this.y=or}oj(oo,"laya.maths.Point");var or=oo.prototype;return or.setTo=function(oo,or){return this.x=oo,this.y=or,this},or.distance=function(oo,or){return Math.sqrt((this.x-oo)*(this.x-oo)+(this.y-or)*(this.y-or))},or.toString=function(){return this.x+","+this.y},or.normalize=function(){var oo=Math.sqrt(this.x*this.x+this.y*this.y);if(0<oo){var or=1/oo;this.x*=or,this.y*=or}},oo.TEMP=new oo,oo.EMPTY=new oo,oo}(),oP=function(){function oU(oo,or,oT,ok){void 0===oo&&(oo=0),void 0===or&&(or=0),void 0===oT&&(oT=0),void 0===ok&&(ok=0),this.x=oo,this.y=or,this.width=oT,this.height=ok}oj(oU,"laya.maths.Rectangle");var oo=oU.prototype;return oo.setTo=function(oo,or,oT,ok){return this.x=oo,this.y=or,this.width=oT,this.height=ok,this},oo.copyFrom=function(oo){return this.x=oo.x,this.y=oo.y,this.width=oo.width,this.height=oo.height,this},oo.contains=function(oo,or){return!(this.width<=0||this.height<=0)&&(oo>=this.x&&oo<this.right&&or>=this.y&&or<this.bottom)},oo.intersects=function(oo){return!(oo.x>this.x+this.width||oo.x+oo.width<this.x||oo.y>this.y+this.height||oo.y+oo.height<this.y)},oo.intersection=function(oo,or){return this.intersects(oo)?(or||(or=new oU),or.x=Math.max(this.x,oo.x),or.y=Math.max(this.y,oo.y),or.width=Math.min(this.right,oo.right)-or.x,or.height=Math.min(this.bottom,oo.bottom)-or.y,or):null},oo.union=function(oo,or){return or||(or=new oU),this.clone(or),oo.width<=0||oo.height<=0?or:(or.addPoint(oo.x,oo.y),or.addPoint(oo.right,oo.bottom),this)},oo.clone=function(oo){return oo||(oo=new oU),oo.x=this.x,oo.y=this.y,oo.width=this.width,oo.height=this.height,oo},oo.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},oo.equals=function(oo){return!(!oo||oo.x!==this.x||oo.y!==this.y||oo.width!==this.width||oo.height!==this.height)},oo.addPoint=function(oo,or){return this.x>oo&&(this.width+=this.x-oo,this.x=oo),this.y>or&&(this.height+=this.y-or,this.y=or),this.width<oo-this.x&&(this.width=oo-this.x),this.height<or-this.y&&(this.height=or-this.y),this},oo._getBoundPoints=function(){var oo=oU._temB;return(oo.length=0)==this.width||0==this.height||oo.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),oo},oo.isEmpty=function(){return this.width<=0||this.height<=0},oh(0,oo,"right",function(){return this.x+this.width}),oh(0,oo,"bottom",function(){return this.y+this.height}),oU._getBoundPointS=function(oo,or,oT,ok){var oW=oU._temA;return(oW.length=0)==oT||0==ok||oW.push(oo,or,oo+oT,or,oo,or+ok,oo+oT,or+ok),oW},oU._getWrapRec=function(oo,or){if(!oo||oo.length<1)return or?or.setTo(0,0,0,0):oU.TEMP.setTo(0,0,0,0);or=or||new oU;var oT,ok,oW,oD,on,oV=oo.length,oL=oF.TEMP;for(oW=on=-(ok=oD=99999),oT=0;oT<oV;oT+=2)oL.x=oo[oT],oL.y=oo[oT+1],ok=ok<oL.x?ok:oL.x,oD=oD<oL.y?oD:oL.y,oW=oW>oL.x?oW:oL.x,on=on>oL.y?on:oL.y;return or.setTo(ok,oD,oW-ok,on-oD)},oU.EMPTY=new oU,oU.TEMP=new oU,oU._temB=[],oU._temA=[],oU}(),oR=function(){function oL(){}return oj(oL,"laya.media.SoundManager"),oh(1,oL,"useAudioMusic",function(){return oL._useAudioMusic},function(oo){oL._useAudioMusic=oo,oL._musicClass=oo?oTo:null}),oh(1,oL,"autoStopMusic",function(){return oL._autoStopMusic},function(oo){ob.stage.off("blur",null,oL._stageOnBlur),ob.stage.off("focus",null,oL._stageOnFocus),ob.stage.off("visibilitychange",null,oL._visibilityChange),(oL._autoStopMusic=oo)&&(ob.stage.on("blur",null,oL._stageOnBlur),ob.stage.on("focus",null,oL._stageOnFocus),ob.stage.on("visibilitychange",null,oL._visibilityChange))}),oh(1,oL,"muted",function(){return oL._muted},function(oo){oo!=oL._muted&&(oo&&oL.stopAllSound(),oL.musicMuted=oo,oL._muted=oo)}),oh(1,oL,"musicMuted",function(){return oL._musicMuted},function(oo){oo!=oL._musicMuted&&(oo?(oL._tMusic&&oL._musicChannel&&!oL._musicChannel.isStopped?oL._musicChannel.pause():oL._musicChannel=null,oL._musicMuted=oo):(oL._musicMuted=oo,oL._tMusic&&oL._musicChannel&&oL._musicChannel.resume()))}),oh(1,oL,"soundMuted",function(){return oL._soundMuted},function(oo){oL._soundMuted=oo}),oL.addChannel=function(oo){0<=oL._channels.indexOf(oo)||(oL._channels.push(oo),oL.autoReleaseSound&&0!=oL._notUsedCount&&oL._notUsedUrls[oo.url]&&(delete oL._notUsedUrls[oo.url],0==--oL._notUsedCount&&ob.timer.clear(oL,oL.disposeSoundIfNotUsed)))},oL.removeChannel=function(oo){var or=oL._channels,oT=or.indexOf(oo);if(-1!=oT&&(or.splice(oT,1),oL.autoReleaseSound)){var ok=oo.url,oW=oL.defaultIntervals[ok]||2e4;if(0<oW){var oD=!0;for(oT=or.length-1;0<=oT;oT--)if(or[oT].url==ok){oD=!1;break}oD&&(oL._notUsedUrls[ok]=Date.now()+oW,0==oL._notUsedCount++&&ob.timer.loop(1e4,oL,oL.disposeSoundIfNotUsed))}}},oL.disposeSoundIfNotUsed=function(){var oo=oL._notUsedUrls;if(0!=oL._notUsedCount){var or=Date.now();for(var oT in oo)or>=oo[oT]&&(delete oo[oT],--oL._notUsedCount,oL.destroySound(oT));if(0!=oL._notUsedCount)return}ob.timer.clear(oL,oL.disposeSoundIfNotUsed)},oL._visibilityChange=function(){ob.stage.isVisibility?oL._stageOnFocus():oL._stageOnBlur()},oL._stageOnBlur=function(){oL._isActive=!1,oL._musicChannel&&(oL._musicChannel.isStopped||(oL._blurPaused=!0,oL._musicChannel.pause())),oL.stopAllSound(),ob.stage.once("mousedown",null,oL._stageOnFocus)},oL._recoverWebAudio=function(){oDo.ctx&&"running"!=oDo.ctx.state&&oDo.ctx.resume&&oDo.ctx.resume()},oL._stageOnFocus=function(){if(oL._isActive=!0,oL._recoverWebAudio(),ob.stage.off("mousedown",null,oL._stageOnFocus),oL._blurPaused){var oo=oL._musicChannel;oo&&oL._music&&oo.isStopped&&(oL._blurPaused=!1,oL._music._disposed?oL.playMusic(oo.url,oo.loops,oo.startHandler,oo.completeHandler,oo.startTime):oo.audioBuffer?oo.resume():oL._music.play(oo.startTime,oo.loops,oo.startHandler,oo))}},oL.playSound=function(oo,or,oT,ok,oW,oD){if(void 0===or&&(or=1),void 0===oD&&(oD=0),!oo)return null;if(oL._muted)return null;if(oL._recoverWebAudio(),oo==oL._tMusic){if(oL._musicMuted)return null}else{if(!oL._isActive)return null;if(oL._soundMuted)return null}var on,oV=oL._pool[oo];return oW||(oW=oL._soundClass),oV||((oV=new oW).load(oo),oL._pool[oo]=oV),(on=oV.play(oD,or,oT))?(oo==oL._tMusic&&(oL._music=oV,oL._isActive||(oL._blurPaused=!0,on.pause())),on.url=oo,on.volume=oo==oL._tMusic?oL.musicVolume:oL.soundVolume,on.completeHandler=ok,on):null},oL.destroySound=function(oo){var or=oL._pool[oo];or&&(delete oL._pool[oo],or.dispose())},oL.playMusic=function(oo,or,oT,ok,oW){return void 0===or&&(or=0),void 0===oW&&(oW=0),oL._tMusic=oo,oL._musicChannel&&oL._musicChannel.stop(),oL._musicChannel=oL.playSound(oo,or,oT,ok,null,oW)},oL.stopSound=function(oo){for(var or,oT=oL._channels.length-1;0<=oT;oT--)(or=oL._channels[oT]).url==oo&&or.stop()},oL.stopAll=function(){oL._tMusic=null;var oo=0;for(oo=oL._channels.length-1;0<=oo;oo--)oL._channels[oo].stop()},oL.stopAllSound=function(){var oo,or=0;for(or=oL._channels.length-1;0<=or;or--)(oo=oL._channels[or]).url!=oL._tMusic&&oo.stop()},oL.stopMusic=function(){oL._musicChannel&&oL._musicChannel.stop(),oL._tMusic=null},oL.setSoundVolume=function(oo,or){if(or)oL._setVolume(or,oo);else{oL.soundVolume=oo;var oT,ok=0;for(ok=oL._channels.length-1;0<=ok;ok--)(oT=oL._channels[ok]).url!=oL._tMusic&&(oT.volume=oo)}},oL.setMusicVolume=function(oo){oL.musicVolume=oo,oL._setVolume(oL._tMusic,oo)},oL._setVolume=function(oo,or){for(var oT,ok=oL._channels.length-1;0<=ok;ok--)(oT=oL._channels[ok]).url==oo&&(oT.volume=or)},oL.musicVolume=1,oL.soundVolume=1,oL.playbackRate=1,oL._useAudioMusic=!0,oL._muted=!1,oL._soundMuted=!1,oL._musicMuted=!1,oL._tMusic=null,oL._musicChannel=null,oL._music=null,oL._channels=[],oL._autoStopMusic=!1,oL._blurPaused=!1,oL._isActive=!0,oL._soundClass=null,oL._musicClass=null,oL.autoReleaseSound=!0,oL._pool={},oL.defaultIntervals={},oL._notUsedUrls={},oL._notUsedCount=0,oL}(),ot=function(){var oo;function oT(){}return oj(oT,"laya.net.LocalStorage"),oT.__init__=function(){oT._baseClass||(oT._baseClass=oo).init(),oT.items=oT._baseClass.items,oT.support=oT._baseClass.support},oT.setItem=function(oo,or){oT._baseClass.setItem(oo,or)},oT.getItem=function(oo){return oT._baseClass.getItem(oo)},oT.setJSON=function(oo,or){oT._baseClass.setJSON(oo,or)},oT.getJSON=function(oo){return oT._baseClass.getJSON(oo)},oT.removeItem=function(oo){oT._baseClass.removeItem(oo)},oT.clear=function(){oT._baseClass.clear()},oT._baseClass=null,oT.items=null,oT.support=!1,oT.__init$=function(){oo=function(){function oT(){}return oj(oT,""),oT.init=function(){try{oT.support=!0,oT.items=on.localStorage,oT.setItem("laya","1"),oT.removeItem("laya")}catch(oo){oT.support=!1}oT.support||console.log("LocalStorage is not supprot or browser is private mode.")},oT.setItem=function(oo,or){try{oT.support&&oT.items.setItem(oo,or)}catch(oo){console.warn("set localStorage failed",oo)}},oT.getItem=function(oo){return oT.support?oT.items.getItem(oo):null},oT.setJSON=function(oo,or){try{oT.support&&oT.items.setItem(oo,JSON.stringify(or))}catch(oo){console.warn("set localStorage failed",oo)}},oT.getJSON=function(oo){return JSON.parse(oT.support?oT.items.getItem(oo):null)},oT.removeItem=function(oo){oT.support&&oT.items.removeItem(oo)},oT.clear=function(){oT.support&&oT.items.clear()},oT.items=null,oT.support=!1,oT}()},oT}(),oz=(function(){function ok(){}oj(ok,"laya.net.ResourceVersion"),ok.enable=function(oo,or,oT){void 0===oT&&(oT=2),laya.net.ResourceVersion.type=oT,ob.loader.load(oo,o$.create(null,ok.onManifestLoaded,[or]),null,"json"),om.customFormat=ok.addVersionPrefix},ok.onManifestLoaded=function(oo,or){ok.manifest=or,oo.run(),or||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},ok.addVersionPrefix=function(oo){return ok.manifest&&ok.manifest[oo]?2==ok.type?ok.manifest[oo]:ok.manifest[oo]+"/"+oo:oo},ok.FOLDER_VERSION=1,ok.FILENAME_VERSION=2,ok.manifest=null,ok.type=1}(),function(){function oo(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}oj(oo,"laya.net.TTFLoader");var or=oo.prototype;return or.load=function(oo){var or=(this._url=oo).split(".ttf")[0].split("/");this.fontName=or[or.length-1],oe.window.conch?this._loadConch():oe.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},or._loadConch=function(){this._http=new ono,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},or._onHttpLoaded=function(oo){oe.window.conch.setFontFaceFromBuffer(this.fontName,oo),this._clearHttp(),this._complete()},or._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},or._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},or._complete=function(){ob.timer.clear(this,this._complete),ob.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},or._checkComplete=function(){ou.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},or._loadWithFontFace=function(){var oo=new oe.window.FontFace(this.fontName,"url('"+this._url+"')");oe.window.document.fonts.add(oo);var or=this;oo.loaded.then(function(){or._complete()}),oo.load()},or._createDiv=function(){this._div=oe.createElement("div"),this._div.innerHTML="laya";var oo=this._div.style;oo.fontFamily=this.fontName,oo.position="absolute",oo.left="-100px",oo.top="-100px",oe.document.body.appendChild(this._div)},or._loadWithCSS=function(){var oo=this,or=oe.createElement("style");or.type="text/css",oe.document.body.appendChild(or),or.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=ou.measureText("LayaTTFFont",this._fontTxt).width;var oT=this;or.onload=function(){ob.timer.once(1e4,oT,oo._complete)},ob.timer.loop(20,this,this._checkComplete),this._createDiv()},oo._testString="LayaTTFFont",oo}()),om=function(){function ok(oo){this._url=null,this._path=null,this._url=ok.formatURL(oo),this._path=ok.getPath(oo)}oj(ok,"laya.net.URL");var oo=ok.prototype;return oh(0,oo,"path",function(){return this._path}),oh(0,oo,"url",function(){return this._url}),ok.formatURL=function(oo,or){if(!oo)return"null path";if(0<oo.indexOf(":"))return oo;null!=ok.customFormat&&(oo=ok.customFormat(oo,or));var oT=oo.charAt(0);if("."===oT)return ok.formatRelativePath((or||ok.basePath)+oo);if("~"===oT)return ok.rootPath+oo.substring(1);if("d"===oT){if(0===oo.indexOf("data:image"))return oo}else if("/"===oT)return oo;return(or||ok.basePath)+oo},ok.formatRelativePath=function(oo){for(var or=oo.split("/"),oT=0,ok=or.length;oT<ok;oT++)".."==or[oT]&&(or.splice(oT-1,2),oT-=2);return or.join("/")},ok.isAbsolute=function(oo){return 0<oo.indexOf(":")||"/"==oo.charAt(0)},ok.getPath=function(oo){var or=oo.lastIndexOf("/");return 0<or?oo.substr(0,or+1):""},ok.getFileName=function(oo){var or=oo.lastIndexOf("/");return 0<or?oo.substr(or+1):oo},ok.version={},ok.basePath="",ok.rootPath="",ok.customFormat=function(oo){var or=ok.version[oo];return!oC.isConchApp&&or&&(oo+="?v="+or),oo},ok}(),oC=function(){function oW(oo,or){this._timeId=0;var oT=oW._mainCanvas.source.style;oT.position="absolute",oT.top=oT.left="0px",oT.background="#000000",oW._mainCanvas.source.id="layaCanvas";var ok=laya.renders.Render.isWebGL;oW._mainCanvas.source.width=oo,oW._mainCanvas.source.height=or,ok&&oW.WebGL.init(oW._mainCanvas,oo,or),oe.container.appendChild(oW._mainCanvas.source),(oW._context=new oX(oo,or,ok?null:oW._mainCanvas)).ctx.setIsMainContext(),oe.window.requestAnimationFrame(function oo(or){oe.window.requestAnimationFrame(oo);ob.stage._loop()}),ob.stage.on("visibilitychange",this,this._onVisibilitychange)}oj(oW,"laya.renders.Render");var oo=oW.prototype;return oo._onVisibilitychange=function(){ob.stage.isVisibility?0!=this._timeId&&oe.window.clearInterval(this._timeId):this._timeId=oe.window.setInterval(this._enterFrame,1e3)},oo._enterFrame=function(oo){ob.stage._loop()},oh(1,oW,"context",function(){return oW._context}),oh(1,oW,"canvas",function(){return oW._mainCanvas.source}),oW._context=null,oW._mainCanvas=null,oW.WebGL=null,oW.isConchNode=!1,oW.isConchApp=!1,oW.isConchWebGL=!1,oW.isWebGL=!1,oW.is3DMode=!1,oW.optimizeTextureMemory=function(oo,or){return!0},oW.__init$=function(){on.ConchRenderType=on.ConchRenderType||1,on.ConchRenderType|=on.conch?4:0,oW.isConchNode=5==(5&on.ConchRenderType),oW.isConchApp=4==(4&on.ConchRenderType),oW.isConchWebGL=6==on.ConchRenderType},oW}(),oX=function(){function on(oo,or,oT){this.x=0,this.y=0,this._drawTexture=function(oo,or,oT){oT[0].loaded&&this.ctx.drawTexture(oT[0],oT[1],oT[2],oT[3],oT[4],oo,or)},this._fillTexture=function(oo,or,oT){oT[0].loaded&&this.ctx.fillTexture(oT[0],oT[1]+oo,oT[2]+or,oT[3],oT[4],oT[5],oT[6],oT[7])},this._drawTextureWithTransform=function(oo,or,oT){oT[0].loaded&&this.ctx.drawTextureWithTransform(oT[0],oT[1],oT[2],oT[3],oT[4],oT[5],oo,or,oT[6])},this._fillQuadrangle=function(oo,or,oT){this.ctx.fillQuadrangle(oT[0],oT[1],oT[2],oT[3],oT[4])},this._drawRect=function(oo,or,oT){var ok=this.ctx;null!=oT[4]&&(ok.fillStyle=oT[4],ok.fillRect(oo+oT[0],or+oT[1],oT[2],oT[3],null)),null!=oT[5]&&(ok.strokeStyle=oT[5],ok.lineWidth=oT[6],ok.strokeRect(oo+oT[0],or+oT[1],oT[2],oT[3],oT[6]))},this._drawPie=function(oo,or,oT){var ok=this.ctx;oC.isWebGL&&ok.setPathId(oT[8]),ok.beginPath(),oC.isWebGL?(ok.movePath(oT[0]+oo,oT[1]+or),ok.moveTo(0,0)):ok.moveTo(oo+oT[0],or+oT[1]),ok.arc(oo+oT[0],or+oT[1],oT[2],oT[3],oT[4]),ok.closePath(),this._fillAndStroke(oT[5],oT[6],oT[7],!0)},this._clipRect=function(oo,or,oT){this.ctx.clipRect(oo+oT[0],or+oT[1],oT[2],oT[3])},this._fillRect=function(oo,or,oT){this.ctx.fillRect(oo+oT[0],or+oT[1],oT[2],oT[3],oT[4])},this._drawCircle=function(oo,or,oT){var ok=this.ctx;oC.isWebGL&&ok.setPathId(oT[6]),ow.drawCall++,ok.beginPath(),oC.isWebGL&&ok.movePath(oT[0]+oo,oT[1]+or),ok.arc(oT[0]+oo,oT[1]+or,oT[2],0,on.PI2),ok.closePath(),this._fillAndStroke(oT[3],oT[4],oT[5],!0)},this._fillCircle=function(oo,or,oT){ow.drawCall++;var ok=this.ctx;ok.beginPath(),ok.fillStyle=oT[3],ok.arc(oT[0]+oo,oT[1]+or,oT[2],0,on.PI2),ok.fill()},this._setShader=function(oo,or,oT){this.ctx.setShader(oT[0])},this._drawLine=function(oo,or,oT){var ok=this.ctx;oC.isWebGL&&ok.setPathId(oT[6]),ok.beginPath(),ok.strokeStyle=oT[4],ok.lineWidth=oT[5],oC.isWebGL?(ok.movePath(oo,or),ok.moveTo(oT[0],oT[1]),ok.lineTo(oT[2],oT[3])):(ok.moveTo(oo+oT[0],or+oT[1]),ok.lineTo(oo+oT[2],or+oT[3])),ok.stroke()},this._drawLines=function(oo,or,oT){var ok=this.ctx;oC.isWebGL&&ok.setPathId(oT[5]),ok.beginPath(),oo+=oT[0],or+=oT[1],oC.isWebGL&&ok.movePath(oo,or),ok.strokeStyle=oT[3],ok.lineWidth=oT[4];var oW=oT[2],oD=2,on=oW.length;if(oC.isWebGL)for(ok.moveTo(oW[0],oW[1]);oD<on;)ok.lineTo(oW[oD++],oW[oD++]);else for(ok.moveTo(oo+oW[0],or+oW[1]);oD<on;)ok.lineTo(oo+oW[oD++],or+oW[oD++]);ok.stroke()},this._drawLinesWebGL=function(oo,or,oT){this.ctx.drawLines(oo+this.x+oT[0],or+this.y+oT[1],oT[2],oT[3],oT[4])},this._drawCurves=function(oo,or,oT){this.ctx.drawCurves(oo,or,oT)},this._draw=function(oo,or,oT){oT[0].call(null,this,oo,or)},this._transformByMatrix=function(oo,or,oT){this.ctx.transformByMatrix(oT[0])},this._setTransform=function(oo,or,oT){this.ctx.setTransform(oT[0],oT[1],oT[2],oT[3],oT[4],oT[5])},this._setTransformByMatrix=function(oo,or,oT){this.ctx.setTransformByMatrix(oT[0])},this._save=function(oo,or,oT){this.ctx.save()},this._restore=function(oo,or,oT){this.ctx.restore()},this._translate=function(oo,or,oT){this.ctx.translate(oT[0],oT[1])},this._transform=function(oo,or,oT){this.ctx.translate(oT[1]+oo,oT[2]+or);var ok=oT[0];this.ctx.transform(ok.a,ok.b,ok.c,ok.d,ok.tx,ok.ty),this.ctx.translate(-oo-oT[1],-or-oT[2])},this._rotate=function(oo,or,oT){this.ctx.translate(oT[1]+oo,oT[2]+or),this.ctx.rotate(oT[0]),this.ctx.translate(-oo-oT[1],-or-oT[2])},this._scale=function(oo,or,oT){this.ctx.translate(oT[2]+oo,oT[3]+or),this.ctx.scale(oT[0],oT[1]),this.ctx.translate(-oo-oT[2],-or-oT[3])},this._alpha=function(oo,or,oT){this.ctx.globalAlpha*=oT[0]},this._setAlpha=function(oo,or,oT){this.ctx.globalAlpha=oT[0]},this._fillText=function(oo,or,oT){this.ctx.fillText(oT[0],oT[1]+oo,oT[2]+or,oT[3],oT[4],oT[5])},this._strokeText=function(oo,or,oT){this.ctx.strokeText(oT[0],oT[1]+oo,oT[2]+or,oT[3],oT[4],oT[5],oT[6])},this._fillBorderText=function(oo,or,oT){this.ctx.fillBorderText(oT[0],oT[1]+oo,oT[2]+or,oT[3],oT[4],oT[5],oT[6],oT[7])},this._blendMode=function(oo,or,oT){this.ctx.globalCompositeOperation=oT[0]},this._beginClip=function(oo,or,oT){this.ctx.beginClip&&this.ctx.beginClip(oo+oT[0],or+oT[1],oT[2],oT[3])},this._setIBVB=function(oo,or,oT){this.ctx.setIBVB(oT[0]+oo,oT[1]+or,oT[2],oT[3],oT[4],oT[5],oT[6],oT[7])},this._fillTrangles=function(oo,or,oT){this.ctx.fillTrangles(oT[0],oT[1]+oo,oT[2]+or,oT[3],oT[4])},this._drawPath=function(oo,or,oT){var ok=this.ctx;oC.isWebGL&&ok.setPathId(-1),ok.beginPath(),oo+=oT[0],or+=oT[1],oC.isWebGL&&ok.movePath(oo,or);for(var oW=oT[2],oD=0,on=oW.length;oD<on;oD++){var oV=oW[oD];switch(oV[0]){case"moveTo":oC.isWebGL?ok.moveTo(oV[1],oV[2]):ok.moveTo(oo+oV[1],or+oV[2]);break;case"lineTo":oC.isWebGL?ok.lineTo(oV[1],oV[2]):ok.lineTo(oo+oV[1],or+oV[2]);break;case"arcTo":oC.isWebGL?ok.arcTo(oV[1],oV[2],oV[3],oV[4],oV[5]):ok.arcTo(oo+oV[1],or+oV[2],oo+oV[3],or+oV[4],oV[5]);break;case"closePath":ok.closePath()}}var oL=oT[3];null!=oL&&(ok.fillStyle=oL.fillStyle,ok.fill());var oU=oT[4];null!=oU&&(ok.strokeStyle=oU.strokeStyle,ok.lineWidth=oU.lineWidth||1,ok.lineJoin=oU.lineJoin,ok.lineCap=oU.lineCap,ok.miterLimit=oU.miterLimit,ok.stroke())},this.drawPoly=function(oo,or,oT){this.ctx.drawPoly(oo+this.x+oT[0],or+this.y+oT[1],oT[2],oT[3],oT[4],oT[5],oT[6])},this._drawPoly=function(oo,or,oT){var ok=this.ctx,oW=oT[2],oD=2,on=oW.length;if(oC.isWebGL)for(ok.setPathId(oT[6]),ok.beginPath(),oo+=oT[0],or+=oT[1],ok.movePath(oo,or),ok.moveTo(oW[0],oW[1]);oD<on;)ok.lineTo(oW[oD++],oW[oD++]);else for(ok.beginPath(),oo+=oT[0],or+=oT[1],ok.moveTo(oo+oW[0],or+oW[1]);oD<on;)ok.lineTo(oo+oW[oD++],or+oW[oD++]);ok.closePath(),this._fillAndStroke(oT[3],oT[4],oT[5],oT[7])},this._drawSkin=function(oo,or,oT){var ok=oT[0];if(ok){var oW=this.ctx;ok.render(oW,oo,or)}},this._drawParticle=function(oo,or,oT){this.ctx.drawParticle(oo+this.x,or+this.y,oT[0])},this._setFilters=function(oo,or,oT){this.ctx.setFilters(oT)},oT?this.ctx=oT.getContext("2d"):(oT=oyo.create("3D"),this.ctx=ou.createWebGLContext2D(oT),oT._setContext(this.ctx)),oT.size(oo,or),this.canvas=oT}oj(on,"laya.renders.RenderContext");var oo=on.prototype;return oo.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},oo.drawTexture=function(oo,or,oT,ok,oW){oo.loaded&&this.ctx.drawTexture(oo,or,oT,ok,oW,this.x,this.y)},oo._drawTextures=function(oo,or,oT){oT[0].loaded&&this.ctx.drawTextures(oT[0],oT[1],oo+this.x,or+this.y)},oo.drawTextureWithTransform=function(oo,or,oT,ok,oW,oD,on){oo.loaded&&this.ctx.drawTextureWithTransform(oo,or,oT,ok,oW,oD,this.x,this.y,on)},oo.fillQuadrangle=function(oo,or,oT,ok,oW){this.ctx.fillQuadrangle(oo,or,oT,ok,oW)},oo.drawCanvas=function(oo,or,oT,ok,oW){this.ctx.drawCanvas(oo,or+this.x,oT+this.y,ok,oW)},oo.drawRect=function(oo,or,oT,ok,oW,oD){void 0===oD&&(oD=1);var on=this.ctx;on.strokeStyle=oW,on.lineWidth=oD,on.strokeRect(oo+this.x,or+this.y,oT,ok,oD)},oo._fillAndStroke=function(oo,or,oT,ok){void 0===ok&&(ok=!1);var oW=this.ctx;null!=oo&&(oW.fillStyle=oo,oC.isWebGL?oW.fill(ok):oW.fill()),null!=or&&0<oT&&(oW.strokeStyle=or,oW.lineWidth=oT,oW.stroke())},oo.clipRect=function(oo,or,oT,ok){this.ctx.clipRect(oo+this.x,or+this.y,oT,ok)},oo.fillRect=function(oo,or,oT,ok,oW){this.ctx.fillRect(oo+this.x,or+this.y,oT,ok,oW)},oo.drawCircle=function(oo,or,oT,ok,oW){void 0===oW&&(oW=1),ow.drawCall++;var oD=this.ctx;oD.beginPath(),oD.strokeStyle=ok,oD.lineWidth=oW,oD.arc(oo+this.x,or+this.y,oT,0,on.PI2),oD.stroke()},oo.drawTriangles=function(oo,or,oT){if(oC.isWebGL)this.ctx.drawTriangles(oT[0],oo+oT[1],or+oT[2],oT[3],oT[4],oT[5],oT[6],oT[7],oT[8],oT[9]);else{var ok=oT[5],oW=0,oD=ok.length,on=this.ctx;for(oW=0;oW<oD;oW+=3){var oV=2*ok[oW],oL=2*ok[oW+1],oU=2*ok[oW+2];on.drawTriangle(oT[0],oT[3],oT[4],oV,oL,oU,oT[6],!0)}}},oo.fillCircle=function(oo,or,oT,ok){ow.drawCall++;var oW=this.ctx;oW.beginPath(),oW.fillStyle=ok,oW.arc(oo+this.x,or+this.y,oT,0,on.PI2),oW.fill()},oo.setShader=function(oo){this.ctx.setShader(oo)},oo.drawLine=function(oo,or,oT,ok,oW,oD){void 0===oD&&(oD=1);var on=this.ctx;on.beginPath(),on.strokeStyle=oW,on.lineWidth=oD,on.moveTo(this.x+oo,this.y+or),on.lineTo(this.x+oT,this.y+ok),on.stroke()},oo.clear=function(){this.ctx.clear()},oo.transformByMatrix=function(oo){this.ctx.transformByMatrix(oo)},oo.setTransform=function(oo,or,oT,ok,oW,oD){this.ctx.setTransform(oo,or,oT,ok,oW,oD)},oo.setTransformByMatrix=function(oo){this.ctx.setTransformByMatrix(oo)},oo.save=function(){this.ctx.save()},oo.restore=function(){this.ctx.restore()},oo.translate=function(oo,or){this.ctx.translate(oo,or)},oo.transform=function(oo,or,oT,ok,oW,oD){this.ctx.transform(oo,or,oT,ok,oW,oD)},oo.rotate=function(oo){this.ctx.rotate(oo)},oo.scale=function(oo,or){this.ctx.scale(oo,or)},oo.alpha=function(oo){this.ctx.globalAlpha*=oo},oo.setAlpha=function(oo){this.ctx.globalAlpha=oo},oo.fillWords=function(oo,or,oT,ok,oW,oD){void 0===oD&&(oD=0),this.ctx.fillWords(oo,or,oT,ok,oW,oD)},oo.fillBorderWords=function(oo,or,oT,ok,oW,oD,on){this.ctx.fillBorderWords(oo,or,oT,ok,oW,oD,on)},oo.fillText=function(oo,or,oT,ok,oW,oD){this.ctx.fillText(oo,or+this.x,oT+this.y,ok,oW,oD)},oo.strokeText=function(oo,or,oT,ok,oW,oD,on){this.ctx.strokeText(oo,or+this.x,oT+this.y,ok,oW,oD,on)},oo.blendMode=function(oo){this.ctx.globalCompositeOperation=oo},oo.flush=function(){this.ctx.flush&&this.ctx.flush()},oo.addRenderObject=function(oo){this.ctx.addRenderObject(oo)},oo.beginClip=function(oo,or,oT,ok){this.ctx.beginClip&&this.ctx.beginClip(oo,or,oT,ok)},oo.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},oo.fillTrangles=function(oo,or,oT){this.ctx.fillTrangles(oT[0],oT[1],oT[2],oT[3],4<oT.length?oT[4]:null)},on.PI2=2*Math.PI,on}(),oO=function(){function on(oo,or){switch(this._next=or||on.NORENDER,oo){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=oK._filter);case 69905:return void(this._fun=on._initRenderFun)}this.onCreate(oo)}oj(on,"laya.renders.RenderSprite");var oo=on.prototype;return oo.onCreate=function(oo){},oo._style=function(oo,or,oT,ok){oo._style.render(oo,or,oT,ok);var oW=this._next;oW._fun.call(oW,oo,or,oT,ok)},oo._no=function(oo,or,oT,ok){},oo._custom=function(oo,or,oT,ok){oo.customRender(or,oT,ok);var oW=oo._style._tf;this._next._fun.call(this._next,oo,or,oT-oW.translateX,ok-oW.translateY)},oo._clip=function(oo,or,oT,ok){var oW=this._next;if(oW!=on.NORENDER){var oD=oo._style.scrollRect;or.ctx.save(),or.ctx.clipRect(oT,ok,oD.width,oD.height),oW._fun.call(oW,oo,or,oT-oD.x,ok-oD.y),or.ctx.restore()}},oo._blend=function(oo,or,oT,ok){var oW=oo._style;oW.blendMode&&(or.ctx.globalCompositeOperation=oW.blendMode);var oD=this._next;oD._fun.call(oD,oo,or,oT,ok),or.ctx.globalCompositeOperation="source-over"},oo._mask=function(oo,or,oT,ok){var oW=this._next;oW._fun.call(oW,oo,or,oT,ok);var oD=oo.mask;oD&&(or.ctx.globalCompositeOperation="destination-in",(0<oD.numChildren||!oD.graphics._isOnlyOne())&&(oD.cacheAsBitmap=!0),oD.render(or,oT-oo.pivotX,ok-oo.pivotY)),or.ctx.globalCompositeOperation="source-over"},oo._graphics=function(oo,or,oT,ok){var oW=oo._style._tf;oo._graphics&&oo._graphics._render(oo,or,oT-oW.translateX,ok-oW.translateY);var oD=this._next;oD._fun.call(oD,oo,or,oT,ok)},oo._image=function(oo,or,oT,ok){var oW=oo._style;or.ctx.drawTexture2(oT,ok,oW._tf.translateX,oW._tf.translateY,oo.transform,oW.alpha,oW.blendMode,oo._graphics._one)},oo._image2=function(oo,or,oT,ok){var oW=oo._style._tf;or.ctx.drawTexture2(oT,ok,oW.translateX,oW.translateY,oo.transform,1,null,oo._graphics._one)},oo._alpha=function(oo,or,oT,ok){var oW;if(.01<(oW=oo._style.alpha)||oo._needRepaint()){var oD=or.ctx.globalAlpha;or.ctx.globalAlpha*=oW;var on=this._next;on._fun.call(on,oo,or,oT,ok),or.ctx.globalAlpha=oD}},oo._transform=function(oo,or,oT,ok){var oW=oo.transform,oD=this._next;oW&&oD!=on.NORENDER?(or.save(),or.transform(oW.a,oW.b,oW.c,oW.d,oW.tx+oT,oW.ty+ok),oD._fun.call(oD,oo,or,0,0),or.restore()):oD._fun.call(oD,oo,or,oT,ok)},oo._childs=function(oo,or,oT,ok){var oW=oo._style,oD=oW._tf;if(oT=oT-oD.translateX+oW.paddingLeft,ok=ok-oD.translateY+oW.paddingTop,oW._calculation){var on=oo._getWords();if(on){var oV=oW;oV&&(oV.stroke?or.fillBorderWords(on,oT,ok,oV.font,oV.color,oV.strokeColor,oV.stroke):or.fillWords(on,oT,ok,oV.font,oV.color,"none"!=oV.textDecoration&&oV.underLine?1:0))}}var oL,oU=oo._childs,oh=oU.length;if(oo.viewport||oo.optimizeScrollRect&&oo._style.scrollRect){var op=oo.viewport||oo._style.scrollRect,oi=op.x,ov=op.y,ox=op.right,oj=op.bottom,o_=NaN,oK=NaN;for(o$=0;o$<oh;++o$)(oL=oU[o$]).visible&&(o_=oL._x)<ox&&o_+oL.width>oi&&(oK=oL._y)<oj&&oK+oL.height>ov&&oL.render(or,oT,ok)}else for(var o$=0;o$<oh;++o$)(oL=oU[o$])._style.visible&&oL.render(or,oT,ok)},oo._canvas=function(oo,or,oT,ok){var oW=oo._$P.cacheCanvas;if(oW){"bitmap"===oW.type?ow.canvasBitmap++:ow.canvasNormal++;var oD=oW.ctx;if(oo._needRepaint()||!oD)this._canvas_repaint(oo,or,oT,ok);else{var on=oW._cacheRec;or.drawCanvas(oD.canvas,oT+on.x,ok+on.y,on.width,on.height)}}else this._next._fun.call(this._next,oo,or,oT,ok)},oo._canvas_repaint=function(oo,or,oT,ok){var oW=oo._$P.cacheCanvas,oD=this._next;if(oW){var on,oV,oL,oU,oh=oW.ctx,op=oo._needRepaint()||!oh,oi=oW.type;if("bitmap"===oi?ow.canvasBitmap++:ow.canvasNormal++,op){var ov,ox;oW._cacheRec||(oW._cacheRec=new oP),oC.isWebGL&&"bitmap"!==oi?oW._cacheRec.setTo(-oo.pivotX,-oo.pivotY,1,1):((oU=oo.getSelfBounds()).x=oU.x-oo.pivotX,oU.y=oU.y-oo.pivotY,oU.x=oU.x-16,oU.y=oU.y-16,oU.width=oU.width+32,oU.height=oU.height+32,oU.x=Math.floor(oU.x+oT)-oT,oU.y=Math.floor(oU.y+ok)-ok,oU.width=Math.floor(oU.width),oU.height=Math.floor(oU.height),oW._cacheRec.copyFrom(oU)),oU=oW._cacheRec;var oj,o_=oC.isWebGL?1:oe.pixelRatio*ob.stage.clientScaleX,oK=oC.isWebGL?1:oe.pixelRatio*ob.stage.clientScaleY;if(!oC.isWebGL){var o$,oy=1,ol=1;for(o$=oo;o$&&o$!=ob.stage;)oy*=o$.scaleX,ol*=o$.scaleY,o$=o$.parent;oC.isWebGL?(oy<1&&(o_*=oy),ol<1&&(oK*=ol)):(1<oy&&(o_*=oy),1<ol&&(oK*=ol))}if(oo.scrollRect){var oS=oo.scrollRect;oU.x-=oS.x,oU.y-=oS.y}if(ov=oU.width*o_,ox=oU.height*oK,oV=oU.x,oL=oU.y,oC.isWebGL&&"bitmap"===oi&&(2048<ov||2048<ox))return console.warn("cache bitmap size larger than 2048,cache ignored"),oW.ctx&&(oG.recover("RenderContext",oW.ctx),oW.ctx.canvas.size(0,0),oW.ctx=null),void oD._fun.call(oD,oo,or,oT,ok);if(oh||(oh=oW.ctx=oG.getItem("RenderContext")||new oX(ov,ox,oyo.create("AUTO"))),oh.ctx.sprite=oo,(on=oh.canvas).clear(),(on.width!=ov||on.height!=ox)&&on.size(ov,ox),"bitmap"===oi?on.context.asBitmap=!0:"normal"===oi&&(on.context.asBitmap=!1),1!=o_||1!=oK){var oq=oh.ctx;oq.save(),oq.scale(o_,oK),!oC.isConchWebGL&&oC.isConchApp&&(oj=oo._$P.cf)&&oq.setFilterMatrix&&oq.setFilterMatrix(oj._mat,oj._alpha),oD._fun.call(oD,oo,oh,-oV,-oL),oq.restore(),oC.isConchApp&&!oC.isConchWebGL||oo._applyFilters()}else oq=oh.ctx,!oC.isConchWebGL&&oC.isConchApp&&(oj=oo._$P.cf)&&oq.setFilterMatrix&&oq.setFilterMatrix(oj._mat,oj._alpha),oD._fun.call(oD,oo,oh,-oV,-oL),oC.isConchApp&&!oC.isConchWebGL||oo._applyFilters();oo._$P.staticCache&&(oW.reCache=!1),ow.canvasReCache++}else oV=(oU=oW._cacheRec).x,oL=oU.y,on=oh.canvas;or.drawCanvas(on,oT+oV,ok+oL,oU.width,oU.height)}else oD._fun.call(oD,oo,oh,oT,ok)},on.__init__=function(){var oo,or,oT=0;for(or=ou.createRenderSprite(69905,null),oo=on.renders.length=4096,oT=0;oT<oo;oT++)on.renders[oT]=or;on.renders[0]=ou.createRenderSprite(0,null),function(oo,or){for(var oT=0,ok=0;ok<oo.length;ok++)oT|=oo[ok],on.renders[oT]=or}([1,512,4,2],new on(1,null)),on.renders[513]=ou.createRenderSprite(513,null),on.renders[517]=new on(517,null)},on._initRenderFun=function(oo,or,oT,ok){var oW=oo._renderType;(on.renders[oW]=on._getTypeRender(oW))._fun(oo,or,oT,ok)},on._getTypeRender=function(oo){for(var or=null,oT=2048;1<oT;)oT&oo&&(or=ou.createRenderSprite(oT,or)),oT>>=1;return or},on.IMAGE=1,on.ALPHA=2,on.TRANSFORM=4,on.BLEND=8,on.CANVAS=16,on.FILTERS=32,on.MASK=64,on.CLIP=128,on.STYLE=256,on.GRAPHICS=512,on.CUSTOM=1024,on.CHILDS=2048,on.INIT=69905,on.renders=[],on.NORENDER=new on(0,null),on}(),oM=function(){function oV(){this._repaint=!1}oj(oV,"laya.resource.Context");var oo=oV.prototype;return oo.replaceReset=function(){var oo,or,oT=0;for(oo=oV.replaceKeys.length,oT=0;oT<oo;oT++)or=oV.replaceKeys[oT],this[oV.newKeys[oT]]=this[or]},oo.replaceResotre=function(){this.__restore(),this.__reset()},oo.setIsMainContext=function(){},oo.drawTextures=function(oo,or,oT,ok){ow.drawCall+=or.length/2;for(var oW=oo.width,oD=oo.height,on=0,oV=or.length;on<oV;on+=2)this.drawTexture(oo,or[on],or[on+1],oW,oD,oT,ok)},oo.drawCanvas=function(oo,or,oT,ok,oW){ow.drawCall++,this.drawImage(oo.source,or,oT,ok,oW)},oo.fillRect=function(oo,or,oT,ok,oW){ow.drawCall++,oW&&(this.fillStyle=oW),this.__fillRect(oo,or,oT,ok)},oo.fillText=function(oo,or,oT,ok,oW,oD){ow.drawCall++,3<arguments.length&&null!=ok&&(this.font=ok,this.fillStyle=oW,this.textAlign=oD,this.textBaseline="top"),this.__fillText(oo,or,oT)},oo.fillBorderText=function(oo,or,oT,ok,oW,oD,on,oV){ow.drawCall++,this.font=ok,this.fillStyle=oW,this.textBaseline="top",this.strokeStyle=oD,this.lineWidth=on,this.textAlign=oV,this.__strokeText(oo,or,oT),this.__fillText(oo,or,oT)},oo.strokeText=function(oo,or,oT,ok,oW,oD,on){ow.drawCall++,3<arguments.length&&null!=ok&&(this.font=ok,this.strokeStyle=oW,this.lineWidth=oD,this.textAlign=on,this.textBaseline="top"),this.__strokeText(oo,or,oT)},oo.transformByMatrix=function(oo){this.transform(oo.a,oo.b,oo.c,oo.d,oo.tx,oo.ty)},oo.setTransformByMatrix=function(oo){this.setTransform(oo.a,oo.b,oo.c,oo.d,oo.tx,oo.ty)},oo.clipRect=function(oo,or,oT,ok){ow.drawCall++,this.beginPath(),this.rect(oo,or,oT,ok),this.clip()},oo.drawTexture=function(oo,or,oT,ok,oW,oD,on){ow.drawCall++;var oV=oo.uv,oL=oo.bitmap.width,oU=oo.bitmap.height;this.drawImage(oo.source,oV[0]*oL,oV[1]*oU,(oV[2]-oV[0])*oL,(oV[5]-oV[3])*oU,or+oD,oT+on,ok,oW)},oo.drawTextureWithTransform=function(oo,or,oT,ok,oW,oD,on,oV,oL){ow.drawCall++;var oU=oo.uv,oh=oo.bitmap.width,op=oo.bitmap.height;this.save(),1!=oL&&(this.globalAlpha*=oL),oD?(this.transform(oD.a,oD.b,oD.c,oD.d,oD.tx+on,oD.ty+oV),this.drawImage(oo.source,oU[0]*oh,oU[1]*op,(oU[2]-oU[0])*oh,(oU[5]-oU[3])*op,or,oT,ok,oW)):this.drawImage(oo.source,oU[0]*oh,oU[1]*op,(oU[2]-oU[0])*oh,(oU[5]-oU[3])*op,or+on,oT+oV,ok,oW),this.restore()},oo.drawTexture2=function(oo,or,oT,ok,oW,oD,on,oV){var oL=oV[0];if(oL.loaded&&oL.bitmap&&oL.source){ow.drawCall++;var oU=1!==oD;if(oU){var oh=this.globalAlpha;this.globalAlpha*=oD}var op=oL.uv,oi=oL.bitmap.width,ov=oL.bitmap.height;oW?(this.save(),this.transform(oW.a,oW.b,oW.c,oW.d,oW.tx+oo,oW.ty+or),this.drawImage(oL.source,op[0]*oi,op[1]*ov,(op[2]-op[0])*oi,(op[5]-op[3])*ov,oV[1]-oT,oV[2]-ok,oV[3],oV[4]),this.restore()):this.drawImage(oL.source,op[0]*oi,op[1]*ov,(op[2]-op[0])*oi,(op[5]-op[3])*ov,oV[1]-oT+oo,oV[2]-ok+or,oV[3],oV[4]),oU&&(this.globalAlpha=oh)}},oo.fillTexture=function(oo,or,oT,ok,oW,oD,on,oV){if(!oV.pat){if(oo.uv!=oho.DEF_UV){var oL=new oyo("2D");oL.getContext("2d"),oL.size(oo.width,oo.height),oL.context.drawTexture(oo,0,0,oo.width,oo.height,0,0),oo=new oho(oL)}oV.pat=this.createPattern(oo.bitmap.source,oD)}var oU=or,oh=oT,op=0,oi=0;on&&(oU+=on.x%oo.width,oh+=on.y%oo.height,op-=on.x%oo.width,oi-=on.y%oo.height),this.translate(oU,oh),this.fillRect(op,oi,ok,oW,oV.pat),this.translate(-oU,-oh)},oo.drawTriangle=function(oo,or,oT,ok,oW,oD,on,oV){var oL=oo.bitmap,oU=oL.source,oh=oo.width,op=oo.height,oi=oL.width,ov=oL.height,ox=oT[ok]*oi,oj=oT[oW]*oi,o_=oT[oD]*oi,oK=oT[ok+1]*ov,o$=oT[oW+1]*ov,oy=oT[oD+1]*ov,ol=or[ok],oS=or[oW],oq=or[oD],ob=or[ok+1],oF=or[oW+1],oP=or[oD+1];if(oV){var ot=(ol+oS+oq)/3,oH=(ob+oF+oP)/3,oR=ol-ot,ou=ob-oH,os=Math.sqrt(oR*oR+ou*ou);ol=ot+oR/os*(os+1),ob=oH+ou/os*(os+1),ou=oF-oH,oS=ot+(oR=oS-ot)/(os=Math.sqrt(oR*oR+ou*ou))*(os+1),oF=oH+ou/os*(os+1),ou=oP-oH,oq=ot+(oR=oq-ot)/(os=Math.sqrt(oR*oR+ou*ou))*(os+1),oP=oH+ou/os*(os+1)}this.save(),on&&this.transform(on.a,on.b,on.c,on.d,on.tx,on.ty),this.beginPath(),this.moveTo(ol,ob),this.lineTo(oS,oF),this.lineTo(oq,oP),this.closePath(),this.clip();var oz=1/(ox*o$+oK*o_+oj*oy-o$*o_-oK*oj-ox*oy),om=ol*o$+oK*oq+oS*oy-o$*oq-oK*oS-ol*oy,oC=ox*oS+ol*o_+oj*oq-oS*o_-ol*oj-ox*oq,oX=ox*o$*oq+oK*oS*o_+ol*oj*oy-ol*o$*o_-oK*oj*oq-ox*oS*oy,oO=ob*o$+oK*oP+oF*oy-o$*oP-oK*oF-ob*oy,oM=ox*oF+ob*o_+oj*oP-oF*o_-ob*oj-ox*oP,oc=ox*o$*oP+oK*oF*o_+ob*oj*oy-ob*o$*o_-oK*oj*oP-ox*oF*oy;this.transform(om*oz,oO*oz,oC*oz,oM*oz,oX*oz,oc*oz),this.drawImage(oU,oo.uv[0]*oi,oo.uv[1]*ov,oh,op,oo.uv[0]*oi,oo.uv[1]*ov,oh,op),this.restore()},oo.flush=function(){return 0},oo.fillWords=function(oo,or,oT,ok,oW,oD){ok&&(this.font=ok),oW&&(this.fillStyle=oW);this.textBaseline="top",this.textAlign="left";for(var on=0,oV=oo.length;on<oV;on++){var oL=oo[on];if(this.__fillText(oL.char,oL.x+or,oL.y+oT),1===oD){var oU=oL.height,oh=.5*oL.style.letterSpacing;oh||(oh=0),this.beginPath(),this.strokeStyle=oW,this.lineWidth=1,this.moveTo(or+oL.x-oh+.5,oT+oL.y+oU+.5),this.lineTo(or+oL.x+oL.width+oh+.5,oT+oL.y+oU+.5),this.stroke()}}},oo.fillBorderWords=function(oo,or,oT,ok,oW,oD,on){ok&&(this.font=ok),oW&&(this.fillStyle=oW),this.textBaseline="top",this.lineWidth=on,this.textAlign="left",this.strokeStyle=oD;for(var oV=0,oL=oo.length;oV<oL;oV++){var oU=oo[oV];this.__strokeText(oU.char,oU.x+or,oU.y+oT),this.__fillText(oU.char,oU.x+or,oU.y+oT)}},oo.destroy=function(){this.canvas.width=this.canvas.height=0},oo.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},oo.drawCurves=function(oo,or,oT){this.beginPath(),this.strokeStyle=oT[3],this.lineWidth=oT[4];var ok=oT[2];oo+=oT[0],or+=oT[1],this.moveTo(oo+ok[0],or+ok[1]);for(var oW=2,oD=ok.length;oW<oD;)this.quadraticCurveTo(oo+ok[oW++],or+ok[oW++],oo+ok[oW++],or+ok[oW++]);this.stroke()},oV.__init__=function(or){var oT=laya.resource.Context.prototype;if(!(or=or||CanvasRenderingContext2D.prototype).inited){or.inited=!0,or.__fillText=or.fillText,or.__fillRect=or.fillRect,or.__strokeText=or.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(oo){or[oo]=oT[oo]})}},oV.replaceCanvasGetSet=function(oo,or){var oT=Object.getOwnPropertyDescriptor(oo,or);if(!oT||!oT.configurable)return!1;var ok,oW={};for(ok in oT)"set"!=ok&&(oW[ok]=oT[ok]);var oD=oT.set;return oW.set=function(oo){oD.call(this,oo);var or=this.getContext("2d");or&&"__reset"in or&&or.__reset()},Object.defineProperty(oo,or,oW),!0},oV.replaceGetSet=function(oo,or){var oT=Object.getOwnPropertyDescriptor(oo,or);if(!oT||!oT.configurable)return!1;var ok,oW={};for(ok in oT)"set"!=ok&&(oW[ok]=oT[ok]);var oD=oT.set,on="___"+or+"__";return oV.newKeys.push(on),oW.set=function(oo){oo!=this[on]&&(this[on]=oo,oD.call(this,oo))},Object.defineProperty(oo,or,oW),!0},oV._default=new oV,oV.newKeys=[],oL(oV,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),oV}(),oc=function(){function oD(oo){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++oD._uniqueIDCounter,this._name=oo||"Content Manager",oD._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,oD._resourceManagers.push(this),this._resources=[],this._records={}}oj(oD,"laya.resource.ResourceManager");var oo=oD.prototype;return ob.imps(oo,{"laya.resource.IDispose":!0}),oo.getResourceByIndex=function(oo){return this._resources[oo]},oo.getResourcesLength=function(){return this._resources.length},oo.addResource=function(oo){return oo.resourceManager&&oo.resourceManager.removeResource(oo),-1===this._resources.indexOf(oo)&&((oo._resourceManager=this)._resources.push(oo),this.addRecord(oo.uri,oo.__className,oo.memorySize),this.addSize(oo.memorySize),!0)},oo.removeResource=function(oo){var or=this._resources.indexOf(oo);return-1!==or&&(this._resources.splice(or,1),oo._resourceManager=null,this._memorySize-=oo.memorySize,this.addRecord(oo.uri,oo.__className,-oo.memorySize),!0)},oo.unload=function(){for(var oo=this._resources.slice(0,this._resources.length),or=0;or<oo.length;or++){oo[or].destroy()}oo.length=0},oo.dispose=function(){if(this===oD._systemResourceManager)throw new Error("systemResourceManager不能被释放！");oD._resourceManagers.splice(oD._resourceManagers.indexOf(this),1),oD._isResourceManagersSorted=!1;for(var oo=this._resources.slice(0,this._resources.length),or=0;or<oo.length;or++){var oT=oo[or];oT.resourceManager.removeResource(oT),oT.destroy()}oo.length=0},oo.addSize=function(oo){oo&&(this.autoRelease&&0<oo&&this._memorySize+oo>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=oo)},oo.addRecord=function(oo,or,oT){DEBUG&&oT&&!oo&&console.error(oo,or,oT),oo&&(this._records.hasOwnProperty(or+"|"+oo)||(this._records[or+"|"+oo]=0),this._records[or+"|"+oo]+=oT,DEBUG&&this._records[or+"|"+oo]<0&&console.error(oo,or,this._records[or+"|"+oo]))},oo.garbageCollection=function(oo){var or=this._resources;(or=or.slice()).sort(function(oo,or){if(!oo||!or)throw new Error("a或b不能为空！");return oo.released&&or.released?0:oo.released?1:or.released?-1:oo._lastUseFrameCount-or._lastUseFrameCount});for(var oT=ow.loopCount,ok=0,oW=or.length;ok<oW;ok++){var oD=or[ok];if(!(1<oT-oD._lastUseFrameCount))return void(this._memorySize>=oo&&(this._isOverflow=!0));if(oD.releaseResource(),this._memorySize<oo)return void(this._isOverflow=!1)}},oh(0,oo,"id",function(){return this._id}),oh(0,oo,"name",function(){return this._name},function(oo){!oo&&""===oo||this._name===oo||(this._name=oo,oD._isResourceManagersSorted=!1)}),oh(0,oo,"memorySize",function(){return this._memorySize}),oh(0,oo,"records",function(){return this._records}),oh(1,oD,"systemResourceManager",function(){return oD._systemResourceManager}),oD.__init__=function(){oD.currentResourceManager=oD.systemResourceManager},oD.getLoadedResourceManagerByIndex=function(oo){return oD._resourceManagers[oo]},oD.getLoadedResourceManagersCount=function(){return oD._resourceManagers.length},oD.recreateContentManagers=function(oo){void 0===oo&&(oo=!1);for(var or=oD.currentResourceManager,oT=0;oT<oD._resourceManagers.length;oT++){oD.currentResourceManager=oD._resourceManagers[oT];for(var ok=0;ok<oD.currentResourceManager._resources.length;ok++)oD.currentResourceManager._resources[ok].releaseResource(oo),oD.currentResourceManager._resources[ok].activeResource(oo)}oD.currentResourceManager=or},oD.releaseContentManagers=function(oo){void 0===oo&&(oo=!1);for(var or=oD.currentResourceManager,oT=0;oT<oD._resourceManagers.length;oT++){oD.currentResourceManager=oD._resourceManagers[oT];for(var ok=0;ok<oD.currentResourceManager._resources.length;ok++){var oW=oD.currentResourceManager._resources[ok];!oW.released&&oW.releaseResource(oo)}}oD.currentResourceManager=or},oD._uniqueIDCounter=0,oD._isResourceManagersSorted=!1,oD._resourceManagers=[],oL(oD,["_systemResourceManager",function(){return this._systemResourceManager=new oD("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=oD._systemResourceManager}]),oD}(),oe=(function(){function oo(){}oj(oo,"laya.system.System"),oo.changeDefinition=function(oo,or){ob[oo]=or;var oT=oo+"=classObj";ob._runScript(oT)},oo.__init__=function(){oC.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function oT(){}return oj(oT,"laya.utils.Browser"),oh(1,oT,"pixelRatio",function(){return oT.__init__(),-1<oT.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:ou.getPixelRatio()}),oh(1,oT,"height",function(){return oT.__init__(),(ob.stage&&ob.stage.canvasRotation?oT.clientWidth:oT.clientHeight)*oT.pixelRatio}),oh(1,oT,"clientWidth",function(){return oT.__init__(),oT.window.innerWidth||oT.document.body.clientWidth}),oh(1,oT,"window",function(){return oT.__init__(),oT._window}),oh(1,oT,"clientHeight",function(){return oT.__init__(),oT.window.innerHeight||oT.document.body.clientHeight||oT.document.documentElement.clientHeight}),oh(1,oT,"width",function(){return oT.__init__(),(ob.stage&&ob.stage.canvasRotation?oT.clientHeight:oT.clientWidth)*oT.pixelRatio}),oh(1,oT,"container",function(){return oT.__init__(),oT._container||((oT._container=oT.createElement("div")).id="layaContainer",oT.document.body.appendChild(oT._container)),oT._container},function(oo){oT._container=oo}),oh(1,oT,"document",function(){return oT.__init__(),oT._document}),oT.__init__=function(){if(!oT._window){oT._window=ou.getWindow(),oT._document=oT.window.document,oT._window.addEventListener("message",function(oo){laya.utils.Browser._onMessage(oo)},!1),oT.document.__createElement=oT.document.createElement,on.requestAnimationFrame=on.requestAnimationFrame||on.webkitRequestAnimationFrame||on.mozRequestAnimationFrame||on.oRequestAnimationFrame||on.msRequestAnimationFrame||function(oo){return on.setTimeout(oo,1e3/60)};var oo=on.document.body.style;oo["-webkit-user-select"]="none",oo["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",oT.userAgent=oT.window.navigator.userAgent,oT.onIOS=!!(oT.u=oT.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),oT.onMobile=-1<oT.u.indexOf("Mobile"),oT.onIPhone=-1<oT.u.indexOf("iPhone"),oT.onMac=-1<oT.u.indexOf("Mac OS X"),oT.onIPad=-1<oT.u.indexOf("iPad"),oT.onAndroid=-1<oT.u.indexOf("Android")||-1<oT.u.indexOf("Adr"),oT.onWP=-1<oT.u.indexOf("Windows Phone"),oT.onQQBrowser=-1<oT.u.indexOf("QQBrowser"),oT.onMQQBrowser=-1<oT.u.indexOf("MQQBrowser")||-1<oT.u.indexOf("Mobile")&&-1<oT.u.indexOf("QQ"),oT.onIE=!!oT.window.ActiveXObject||"ActiveXObject"in oT.window,oT.onWeiXin=-1<oT.u.indexOf("MicroMessenger"),oT.onPC=!oT.onMobile,oT.onSafari=-1<oT.u.indexOf("Safari"),oT.onFirefox=-1<oT.u.indexOf("Firefox"),oT.onEdge=-1<oT.u.indexOf("Edge"),oT.onMiniGame=-1<oT.u.indexOf("MiniGame"),oT.onLimixiu=-1<oT.u.indexOf("limixiu"),oT.httpProtocol="http:"==oT.window.location.protocol,oT.onMiniGame&&null==oT.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),oT.webAudioEnabled=!!(oT.window.AudioContext||oT.window.webkitAudioContext||oT.window.mozAudioContext),oT.soundType=oT.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",oWo=oT.webAudioEnabled?oDo:oTo,oT.webAudioEnabled&&oDo.initWebAudio(),oTo._initMusicAudio(),oT.enableTouch="ontouchstart"in on||on.DocumentTouch&&or instanceof DocumentTouch,on.focus(),oR._soundClass=oWo,oR._musicClass=oTo,oC._mainCanvas=oC._mainCanvas||oyo.create("2D"),oT.canvas||(oT.canvas=oyo.create("2D"),oT.context=oT.canvas.getContext("2d"))}},oT._onMessage=function(oo){if(oo.data&&"size"==oo.data.name){if(oT.window.innerWidth=oo.data.width,oT.window.innerHeight=oo.data.height,oT.window.__innerHeight=oo.data.clientHeight,!oT.document.createEvent)return void console.warn("no document.createEvent");var or=oT.document.createEvent("HTMLEvents");return or.initEvent("resize",!1,!1),void oT.window.dispatchEvent(or)}},oT.createElement=function(oo){return oT.__init__(),oT.document.__createElement(oo)},oT.getElementById=function(oo){return oT.__init__(),oT.document.getElementById(oo)},oT.removeElement=function(oo){oo&&oo.parentNode&&oo.parentNode.removeChild(oo)},oT.now=function(){return ou.now()},oT._window=null,oT._document=null,oT._container=null,oT.userAgent=null,oT.u=null,oT.onIOS=!1,oT.onMac=!1,oT.onMobile=!1,oT.onIPhone=!1,oT.onIPad=!1,oT.onAndroid=!1,oT.onWP=!1,oT.onQQBrowser=!1,oT.onMQQBrowser=!1,oT.onSafari=!1,oT.onFirefox=!1,oT.onEdge=!1,oT.onIE=!1,oT.onWeiXin=!1,oT.onMiniGame=!1,oT.onLimixiu=!1,oT.onPC=!1,oT.httpProtocol=!1,oT.webAudioEnabled=!1,oT.soundType=null,oT.enableTouch=!1,oT.canvas=null,oT.context=null,oT.__init$=function(){},oT}()),oJ=function(){function or(oo){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,oo?(this._u8d_=new Uint8Array(oo),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}oj(or,"laya.utils.Byte");var oo=or.prototype;return oo.___resizeBuffer=function(or){try{var oo=new Uint8Array(or);null!=this._u8d_&&(this._u8d_.length<=or?oo.set(this._u8d_):oo.set(this._u8d_.subarray(0,or))),this._u8d_=oo,this._d_=new DataView(oo.buffer)}catch(oo){throw"___resizeBuffer err:"+or}},oo.getString=function(){return this.rUTF(this.getUint16())},oo.getFloat32Array=function(oo,or){var oT=oo+or;oT=oT>this._length?this._length:oT;var ok=new Float32Array(this._d_.buffer.slice(oo,oT));return this._pos_=oT,ok},oo.getUint8Array=function(oo,or){var oT=oo+or;oT=oT>this._length?this._length:oT;var ok=new Uint8Array(this._d_.buffer.slice(oo,oT));return this._pos_=oT,ok},oo.getInt16Array=function(oo,or){var oT=oo+or;oT=oT>this._length?this._length:oT;var ok=new Int16Array(this._d_.buffer.slice(oo,oT));return this._pos_=oT,ok},oo.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var oo=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,oo},oo.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var oo=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,oo},oo.writeFloat32=function(oo){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,oo,this._xd_),this._pos_+=4},oo.writeFloat64=function(oo){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,oo,this._xd_),this._pos_+=8},oo.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var oo=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,oo},oo.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var oo=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,oo},oo.writeInt32=function(oo){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,oo,this._xd_),this._pos_+=4},oo.writeUint32=function(oo){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,oo,this._xd_),this._pos_+=4},oo.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var oo=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,oo},oo.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var oo=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,oo},oo.writeUint16=function(oo){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,oo,this._xd_),this._pos_+=2},oo.writeInt16=function(oo){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,oo,this._xd_),this._pos_+=2},oo.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},oo.writeUint8=function(oo){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,oo),this._pos_++},oo._getUInt8=function(oo){return this._d_.getUint8(oo)},oo._getUint16=function(oo){return this._d_.getUint16(oo,this._xd_)},oo._getMatrix=function(){return new os(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},oo.rUTF=function(oo){for(var or=[],oT=this._pos_+oo,ok=0,oW=0,oD=0,on=String.fromCharCode,oV=this._u8d_;this._pos_<oT;)(ok=oV[this._pos_++])<128?0!=ok&&or.push(on(ok)):ok<224?or.push(on((63&ok)<<6|127&oV[this._pos_++])):ok<240?(oW=oV[this._pos_++],or.push(on((31&ok)<<12|(127&oW)<<6|127&oV[this._pos_++]))):(oW=oV[this._pos_++],oD=oV[this._pos_++],or.push(on((15&ok)<<18|(127&oW)<<12|oD<<6&127|127&oV[this._pos_++]))),0;return or.join("")},oo.getCustomString=function(oo){for(var or=[],oT=0,ok=0,oW=0,oD=String.fromCharCode,on=this._u8d_;0<oo;)if((ok=on[this._pos_])<128)or.push(oD(ok)),this._pos_++,oo--;else for(oT=ok-128,this._pos_++,oo-=oT;0<oT;)ok=on[this._pos_++],oW=on[this._pos_++],or.push(oD(oW<<8|ok)),oT--;return or.join("")},oo.clear=function(){this._pos_=0,this.length=0},oo.__getBuffer=function(){return this._d_.buffer},oo.writeUTFBytes=function(oo){for(var or=0,oT=(oo+="").length;or<oT;or++){var ok=oo.charCodeAt(or);ok<=127?this.writeByte(ok):ok<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|ok>>6,128|63&ok],this._pos_),this._pos_+=2):ok<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|ok>>12,128|ok>>6&63,128|63&ok],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|ok>>18,128|ok>>12&63,128|ok>>6&63,128|63&ok],this._pos_),this._pos_+=4)}},oo.writeUTFString=function(oo){var or=this.pos;this.writeUint16(1),this.writeUTFBytes(oo);var oT=this.pos-or-2;if(65536<=oT)throw"writeUTFString byte len more than 65536";this._d_.setUint16(or,oT,this._xd_)},oo.readUTFString=function(){return this.readUTFBytes(this.getUint16())},oo.getUTFString=function(){return this.readUTFString()},oo.readUTFBytes=function(oo){if(void 0===oo&&(oo=-1),0==oo)return"";var or=this.bytesAvailable;if(or<oo)throw"readUTFBytes error - Out of bounds";return oo=0<oo?oo:or,this.rUTF(oo)},oo.getUTFBytes=function(oo){return void 0===oo&&(oo=-1),this.readUTFBytes(oo)},oo.writeByte=function(oo){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,oo),this._pos_+=1},oo.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},oo.getByte=function(){return this.readByte()},oo.ensureWrite=function(oo){this._length<oo&&(this._length=oo),this._allocated_<oo&&(this.length=oo)},oo.writeArrayBuffer=function(oo,or,oT){if(void 0===or&&(or=0),void 0===oT&&(oT=0),or<0||oT<0)throw"writeArrayBuffer error - Out of bounds";0==oT&&(oT=oo.byteLength-or),this.ensureWrite(this._pos_+oT);var ok=new Uint8Array(oo);this._u8d_.set(ok.subarray(or,or+oT),this._pos_),this._pos_+=oT},oh(0,oo,"buffer",function(){var oo=this._d_.buffer;return oo.byteLength==this.length?oo:oo.slice(0,this.length)}),oh(0,oo,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(oo){this._xd_="littleEndian"==oo}),oh(0,oo,"length",function(){return this._length},function(oo){this._allocated_<oo?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(oo,2*this._allocated_))):this._allocated_>oo&&this.___resizeBuffer(this._allocated_=oo),this._length=oo}),oh(0,oo,"pos",function(){return this._pos_},function(oo){this._pos_=oo}),oh(0,oo,"bytesAvailable",function(){return this._length-this._pos_}),or.getSystemEndian=function(){if(!or._sysEndian){var oo=new ArrayBuffer(2);new DataView(oo).setInt16(0,256,!0),or._sysEndian=256===new Int16Array(oo)[0]?"littleEndian":"bigEndian"}return or._sysEndian},or.BIG_ENDIAN="bigEndian",or.LITTLE_ENDIAN="littleEndian",or._sysEndian=null,or}(),oY=function(){function oW(){}return oj(oW,"laya.utils.CacheManager"),oW.regCacheByFunction=function(oo,or){var oT;oW.unRegCacheByFunction(oo,or),oT={tryDispose:oo,getCacheList:or},oW._cacheList.push(oT)},oW.unRegCacheByFunction=function(oo,or){var oT,ok=0;for(oT=oW._cacheList.length,ok=0;ok<oT;ok++)if(oW._cacheList[ok].tryDispose==oo&&oW._cacheList[ok].getCacheList==or)return void oW._cacheList.splice(ok,1)},oW.forceDispose=function(){var oo=0,or=oW._cacheList.length;for(oo=0;oo<or;oo++)oW._cacheList[oo].tryDispose(!0)},oW.beginCheck=function(oo){void 0===oo&&(oo=15e3),ob.timer.loop(oo,null,oW._checkLoop)},oW.stopCheck=function(){ob.timer.clear(null,oW._checkLoop)},oW._checkLoop=function(){var oo=oW._cacheList;if(!(oo.length<1)){var or,oT=oe.now(),ok=0;for(or=ok=oo.length;0<ok&&(oo[oW._index=++oW._index%or].tryDispose(!1),!(oe.now()-oT>oW.loopTimeLimit));)ok--}},oW.loopTimeLimit=2,oW._cacheList=[],oW._index=0,oW}(),oA=function(){function ov(){}return oj(ov,"laya.utils.ClassUtils"),ov.regClass=function(oo,or){ov._classMap[oo]=or},ov.getRegClass=function(oo){return ov._classMap[oo]},ov.getInstance=function(oo){var or=ov.getClass(oo);return or?new or:(console.warn("[error] Undefined class:",oo),null)},ov.createByJson=function(oo,or,oT,ok,oW){"string"==typeof oo&&(oo=JSON.parse(oo));var oD=oo.props;if(!or&&!(or=oW?oW.runWith(oo):ov.getInstance(oD.runtime||oo.type)))return null;var on=oo.child;if(on)for(var oV=0,oL=on.length;oV<oL;oV++){var oU=on[oV];if("render"!==oU.props.name&&"render"!==oU.props.renderType||!or._$set_itemRender)if("Graphic"==oU.type)ov.addGraphicsToSprite(oU,or);else if(ov.isDrawType(oU.type))ov.addGraphicToSprite(oU,or,!0);else{var oh=ov.createByJson(oU,null,oT,ok,oW);"Script"==oU.type?oh.hasOwnProperty("owner")?oh.owner=or:oh.hasOwnProperty("target")&&(oh.target=or):"mask"==oU.props.renderType?or.mask=oh:or.addChild(oh)}else or.itemRender=oU}if(oD)for(var op in oD){var oi=oD[op];"var"===op&&oT?oT[oi]=or:oi instanceof Array&&"function"==typeof or[op]?or[op].apply(or,oi):or[op]=oi}return ok&&oo.customProps&&ok.runWith([or,oo]),or.created&&or.created(),or},ov.addGraphicsToSprite=function(oo,or){var oT;if((oT=oo.child)&&!(oT.length<1)){var ok;ok=ov._getGraphicsFromSprite(oo,or);var oW=0,oD=0;oo.props&&(oW=ov._getObjVar(oo.props,"x",0),oD=ov._getObjVar(oo.props,"y",0)),0!=oW&&0!=oD&&ok.translate(oW,oD);var on,oV=0;for(on=oT.length,oV=0;oV<on;oV++)ov._addGraphicToGraphics(oT[oV],ok);0!=oW&&0!=oD&&ok.translate(-oW,-oD)}},ov.addGraphicToSprite=function(oo,or,oT){var ok;void 0===oT&&(oT=!1),ok=oT?ov._getGraphicsFromSprite(oo,or):or.graphics,ov._addGraphicToGraphics(oo,ok)},ov._getGraphicsFromSprite=function(oo,or){var oT,ok;if(!oo||!oo.props)return or.graphics;switch(ok=oo.props.renderType){case"hit":case"unHit":var oW;or.hitArea||(or.hitArea=new oa),(oW=or.hitArea)[ok]||(oW[ok]=new oi),oT=oW[ok]}return oT||(oT=or.graphics),oT},ov._getTransformData=function(oo){var or;(oo.hasOwnProperty("pivotX")||oo.hasOwnProperty("pivotY"))&&(or=or||new os).translate(-ov._getObjVar(oo,"pivotX",0),-ov._getObjVar(oo,"pivotY",0));var oT=ov._getObjVar(oo,"scaleX",1),ok=ov._getObjVar(oo,"scaleY",1),oW=ov._getObjVar(oo,"rotation",0);ov._getObjVar(oo,"skewX",0),ov._getObjVar(oo,"skewY",0);return 1==oT&&1==ok&&0==oW||((or=or||new os).scale(oT,ok),or.rotate(.0174532922222222*oW)),or},ov._addGraphicToGraphics=function(oo,or){var oT,ok;if((oT=oo.props)&&(ok=ov.DrawTypeDic[oo.type])){var oW,oD;oW=or;var on=ov._getParams(oT,ok[1],ok[2],ok[3]);((oD=ov._tM)||1!=ov._alpha)&&(oW.save(),oD&&oW.transform(oD),1!=ov._alpha&&oW.alpha(ov._alpha)),oW[ok[0]].apply(oW,on),(oD||1!=ov._alpha)&&oW.restore()}},ov._adptLineData=function(oo){return oo[2]=parseFloat(oo[0])+parseFloat(oo[2]),oo[3]=parseFloat(oo[1])+parseFloat(oo[3]),oo},ov._adptTextureData=function(oo){return oo[0]=oVo.getRes(oo[0]),oo},ov._adptLinesData=function(oo){return oo[2]=ov._getPointListByStr(oo[2]),oo},ov.isDrawType=function(oo){return"Image"!=oo&&ov.DrawTypeDic.hasOwnProperty(oo)},ov._getParams=function(oo,or,oT,ok){var oW;void 0===oT&&(oT=0),(oW=ov._temParam).length=or.length;var oD,on,oV=0;for(oD=or.length,oV=0;oV<oD;oV++)oW[oV]=ov._getObjVar(oo,or[oV][0],or[oV][1]);return ov._alpha=ov._getObjVar(oo,"alpha",1),on=ov._getTransformData(oo),ov._tM=on?(oT||(oT=0),on.translate(oW[oT],oW[oT+1]),oW[oT]=oW[oT+1]=0,on):null,ok&&ov[ok]&&(oW=ov[ok](oW)),oW},ov._getPointListByStr=function(oo){var or,oT,ok=0;for(oT=(or=oo.split(",")).length,ok=0;ok<oT;ok++)or[ok]=parseFloat(or[ok]);return or},ov._getObjVar=function(oo,or,oT){return oo.hasOwnProperty(or)?oo[or]:oT},ov._temParam=[],ov._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},ov.getClass=function(oo){var or=ov._classMap[oo]||oo;return"string"==typeof or?ob.__classmap[or]:or},ov._tM=null,ov._alpha=NaN,oL(ov,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),ov}(),oI=function(){function oD(oo){if(this._color=[],"string"==typeof oo){null===(this.strColor=oo)&&(oo="#000000"),"#"==oo.charAt(0)&&(oo=oo.substr(1));var or=oo.length;if(3==or||4==or){for(var oT="",ok=0;ok<or;ok++)oT+=oo[ok]+oo[ok];oo=oT}var oW=this.numColor=parseInt(oo,16);if(8==oo.length)return void(this._color=[parseInt(oo.substr(0,2),16)/255,((16711680&oW)>>16)/255,((65280&oW)>>8)/255,(255&oW)/255])}else oW=this.numColor=oo,this.strColor=og.toHexColor(oW);this._color=[((16711680&oW)>>16)/255,((65280&oW)>>8)/255,(255&oW)/255,1],this._color.__id=++oD._COLODID}return oj(oD,"laya.utils.Color"),oD._initDefault=function(){for(var oo in oD._DEFAULT={},oD._COLOR_MAP)oD._SAVE[oo]=oD._DEFAULT[oo]=new oD(oD._COLOR_MAP[oo]);return oD._DEFAULT},oD._initSaveMap=function(){for(var oo in oD._SAVE_SIZE=0,oD._SAVE={},oD._DEFAULT)oD._SAVE[oo]=oD._DEFAULT[oo]},oD.create=function(oo){var or=oD._SAVE[oo+""];return null!=or?or:(oD._SAVE_SIZE<1e3||oD._initSaveMap(),oD._SAVE[oo+""]=new oD(oo))},oD._SAVE={},oD._SAVE_SIZE=0,oD._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},oD._DEFAULT=oD._initDefault(),oD._COLODID=1,oD}(),oN=(function(){function oo(){this._values=[],this._keys=[]}oj(oo,"laya.utils.Dictionary");var or=oo.prototype;or.set=function(oo,or){var oT=this.indexOf(oo);0<=oT?this._values[oT]=or:(this._keys.push(oo),this._values.push(or))},or.indexOf=function(oo){var or=this._keys.indexOf(oo);return 0<=or?or:(oo="string"==typeof oo?Number(oo):"number"==typeof oo?oo.toString():oo,this._keys.indexOf(oo))},or.get=function(oo){var or=this.indexOf(oo);return or<0?null:this._values[or]},or.remove=function(oo){var or=this.indexOf(oo);return 0<=or&&(this._keys.splice(or,1),this._values.splice(or,1),!0)},or.clear=function(){this._values.length=0,this._keys.length=0},oh(0,or,"values",function(){return this._values}),oh(0,or,"keys",function(){return this._keys})}(),function(){function oo(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}oj(oo,"laya.utils.Dragging");var or=oo.prototype;return or.start=function(oo,or,oT,ok,oW,oD,on,oV){void 0===oV&&(oV=.92),this.clearTimer(),this.target=oo,this.area=or,this.hasInertia=oT,this.elasticDistance=or?ok:0,this.elasticBackTime=oW,this.data=oD,this._disableMouseEvent=on,this.ratio=oV,1!=oo.globalScaleX||1!=oo.globalScaleY?this._parent=oo.parent:this._parent=ob.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,ob.stage.on("mouseup",this,this.onStageMouseUp),ob.stage.on("mouseout",this,this.onStageMouseUp),ob.timer.frameLoop(1,this,this.loop)},or.clearTimer=function(){ob.timer.clear(this,this.loop),ob.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},or.stop=function(){this._dragging&&(ox.instance.disableMouseEvent=!1,ob.stage.off("mouseup",this,this.onStageMouseUp),ob.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},or.loop=function(){var oo=this._parent.getMousePoint(),or=oo.x,oT=oo.y,ok=or-this._lastX,oW=oT-this._lastY;if(this._clickOnly){if(!(1<Math.abs(ok*ob.stage._canvasTransform.getScaleX())||1<Math.abs(oW*ob.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),ox.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(ok,oW);0==ok&&0==oW||(this._lastX=or,this._lastY=oT,this.target.x+=ok*this._elasticRateX,this.target.y+=oW*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},or.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var oo=this.area.x-this.target.x;else oo=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-oo/this.elasticDistance),this.target.y<this.area.y)var or=this.area.y-this.target.y;else or=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-or/this.elasticDistance)}},or.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},or.onStageMouseUp=function(oo){if(ox.instance.disableMouseEvent=!1,ob.stage.off("mouseup",this,this.onStageMouseUp),ob.stage.off("mouseout",this,this.onStageMouseUp),ob.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var or=this._offsets.length,oT=Math.min(or,6),ok=this._offsets.length-oT,oW=or-1;ok<oW;oW--)this._offsetY+=this._offsets[oW--],this._offsetX+=this._offsets[oW];this._offsetX=this._offsetX/oT*2,this._offsetY=this._offsetY/oT*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),ob.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},or.checkElastic=function(){var oo=NaN,or=NaN;if(this.target.x<this.area.x?oo=this.area.x:this.target.x>this.area.x+this.area.width&&(oo=this.area.x+this.area.width),this.target.y<this.area.y?or=this.area.y:this.target.y>this.area.y+this.area.height&&(or=this.area.y+this.area.height),isNaN(oo)&&isNaN(or))this.clear();else{var oT={};isNaN(oo)||(oT.x=oo),isNaN(or)||(oT.y=or),this._tween=oQ.to(this.target,oT,this.elasticBackTime,of.sineOut,o$.create(this,this.clear),0,!1,!1)}},or.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(ob.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},or.clear=function(){if(this.target){this.clearTimer();var oo=this.target;this.target=null,this._parent=null,oo.event("dragend",this.data)}},oo}()),of=function(){function oV(){}return oj(oV,"laya.utils.Ease"),oV.linearNone=function(oo,or,oT,ok){return oT*oo/ok+or},oV.linearIn=function(oo,or,oT,ok){return oT*oo/ok+or},oV.linearInOut=function(oo,or,oT,ok){return oT*oo/ok+or},oV.linearOut=function(oo,or,oT,ok){return oT*oo/ok+or},oV.bounceIn=function(oo,or,oT,ok){return oT-oV.bounceOut(ok-oo,0,oT,ok)+or},oV.bounceInOut=function(oo,or,oT,ok){return oo<.5*ok?.5*oV.bounceIn(2*oo,0,oT,ok)+or:.5*oV.bounceOut(2*oo-ok,0,oT,ok)+.5*oT+or},oV.bounceOut=function(oo,or,oT,ok){return(oo/=ok)<1/2.75?oT*(7.5625*oo*oo)+or:oo<2/2.75?oT*(7.5625*(oo-=1.5/2.75)*oo+.75)+or:oo<2.5/2.75?oT*(7.5625*(oo-=2.25/2.75)*oo+.9375)+or:oT*(7.5625*(oo-=2.625/2.75)*oo+.984375)+or},oV.backIn=function(oo,or,oT,ok,oW){return void 0===oW&&(oW=1.70158),oT*(oo/=ok)*oo*((oW+1)*oo-oW)+or},oV.backInOut=function(oo,or,oT,ok,oW){return void 0===oW&&(oW=1.70158),(oo/=.5*ok)<1?.5*oT*(oo*oo*((1+(oW*=1.525))*oo-oW))+or:oT/2*((oo-=2)*oo*((1+(oW*=1.525))*oo+oW)+2)+or},oV.backOut=function(oo,or,oT,ok,oW){return void 0===oW&&(oW=1.70158),oT*((oo=oo/ok-1)*oo*((oW+1)*oo+oW)+1)+or},oV.elasticIn=function(oo,or,oT,ok,oW,oD){var on;return void 0===oW&&(oW=0),void 0===oD&&(oD=0),0==oo?or:1==(oo/=ok)?or+oT:(oD||(oD=.3*ok),on=!oW||0<oT&&oW<oT||oT<0&&oW<-oT?(oW=oT,oD/4):oD/oV.PI2*Math.asin(oT/oW),-oW*Math.pow(2,10*(oo-=1))*Math.sin((oo*ok-on)*oV.PI2/oD)+or)},oV.elasticInOut=function(oo,or,oT,ok,oW,oD){var on;return void 0===oW&&(oW=0),void 0===oD&&(oD=0),0==oo?or:2==(oo/=.5*ok)?or+oT:(oD||(oD=ok*(.3*1.5)),on=!oW||0<oT&&oW<oT||oT<0&&oW<-oT?(oW=oT,oD/4):oD/oV.PI2*Math.asin(oT/oW),oo<1?oW*Math.pow(2,10*(oo-=1))*Math.sin((oo*ok-on)*oV.PI2/oD)*-.5+or:oW*Math.pow(2,-10*(oo-=1))*Math.sin((oo*ok-on)*oV.PI2/oD)*.5+oT+or)},oV.elasticOut=function(oo,or,oT,ok,oW,oD){var on;return void 0===oW&&(oW=0),void 0===oD&&(oD=0),0==oo?or:1==(oo/=ok)?or+oT:(oD||(oD=.3*ok),on=!oW||0<oT&&oW<oT||oT<0&&oW<-oT?(oW=oT,oD/4):oD/oV.PI2*Math.asin(oT/oW),oW*Math.pow(2,-10*oo)*Math.sin((oo*ok-on)*oV.PI2/oD)+oT+or)},oV.strongIn=function(oo,or,oT,ok){return oT*(oo/=ok)*oo*oo*oo*oo+or},oV.strongInOut=function(oo,or,oT,ok){return(oo/=.5*ok)<1?.5*oT*oo*oo*oo*oo*oo+or:.5*oT*((oo-=2)*oo*oo*oo*oo+2)+or},oV.strongOut=function(oo,or,oT,ok){return oT*((oo=oo/ok-1)*oo*oo*oo*oo+1)+or},oV.sineInOut=function(oo,or,oT,ok){return.5*-oT*(Math.cos(Math.PI*oo/ok)-1)+or},oV.sineIn=function(oo,or,oT,ok){return-oT*Math.cos(oo/ok*oV.HALF_PI)+oT+or},oV.sineOut=function(oo,or,oT,ok){return oT*Math.sin(oo/ok*oV.HALF_PI)+or},oV.quintIn=function(oo,or,oT,ok){return oT*(oo/=ok)*oo*oo*oo*oo+or},oV.quintInOut=function(oo,or,oT,ok){return(oo/=.5*ok)<1?.5*oT*oo*oo*oo*oo*oo+or:.5*oT*((oo-=2)*oo*oo*oo*oo+2)+or},oV.quintOut=function(oo,or,oT,ok){return oT*((oo=oo/ok-1)*oo*oo*oo*oo+1)+or},oV.quartIn=function(oo,or,oT,ok){return oT*(oo/=ok)*oo*oo*oo+or},oV.quartInOut=function(oo,or,oT,ok){return(oo/=.5*ok)<1?.5*oT*oo*oo*oo*oo+or:.5*-oT*((oo-=2)*oo*oo*oo-2)+or},oV.quartOut=function(oo,or,oT,ok){return-oT*((oo=oo/ok-1)*oo*oo*oo-1)+or},oV.cubicIn=function(oo,or,oT,ok){return oT*(oo/=ok)*oo*oo+or},oV.cubicInOut=function(oo,or,oT,ok){return(oo/=.5*ok)<1?.5*oT*oo*oo*oo+or:.5*oT*((oo-=2)*oo*oo+2)+or},oV.cubicOut=function(oo,or,oT,ok){return oT*((oo=oo/ok-1)*oo*oo+1)+or},oV.quadIn=function(oo,or,oT,ok){return oT*(oo/=ok)*oo+or},oV.quadInOut=function(oo,or,oT,ok){return(oo/=.5*ok)<1?.5*oT*oo*oo+or:.5*-oT*(--oo*(oo-2)-1)+or},oV.quadOut=function(oo,or,oT,ok){return-oT*(oo/=ok)*(oo-2)+or},oV.expoIn=function(oo,or,oT,ok){return 0==oo?or:oT*Math.pow(2,10*(oo/ok-1))+or-.001*oT},oV.expoInOut=function(oo,or,oT,ok){return 0==oo?or:oo==ok?or+oT:(oo/=.5*ok)<1?.5*oT*Math.pow(2,10*(oo-1))+or:.5*oT*(2-Math.pow(2,-10*--oo))+or},oV.expoOut=function(oo,or,oT,ok){return oo==ok?or+oT:oT*(1-Math.pow(2,-10*oo/ok))+or},oV.circIn=function(oo,or,oT,ok){return-oT*(Math.sqrt(1-(oo/=ok)*oo)-1)+or},oV.circInOut=function(oo,or,oT,ok){return(oo/=.5*ok)<1?.5*-oT*(Math.sqrt(1-oo*oo)-1)+or:.5*oT*(Math.sqrt(1-(oo-=2)*oo)+1)+or},oV.circOut=function(oo,or,oT,ok){return oT*Math.sqrt(1-(oo=oo/ok-1)*oo)+or},oV.HALF_PI=.5*Math.PI,oV.PI2=2*Math.PI,oV}(),oa=function(){function op(){this._hit=null,this._unHit=null}oj(op,"laya.utils.HitArea");var oo=op.prototype;return oo.isHit=function(oo,or){return!!op.isHitGraphic(oo,or,this.hit)&&!op.isHitGraphic(oo,or,this.unHit)},oo.contains=function(oo,or){return this.isHit(oo,or)},oh(0,oo,"hit",function(){return this._hit||(this._hit=new oi),this._hit},function(oo){this._hit=oo}),oh(0,oo,"unHit",function(){return this._unHit||(this._unHit=new oi),this._unHit},function(oo){this._unHit=oo}),op.isHitGraphic=function(oo,or,oT){if(!oT)return!1;var ok;if(!(ok=oT.cmds)&&oT._one&&((ok=op._cmds).length=1,ok[0]=oT._one),!ok)return!1;var oW,oD,on=0;for(oW=ok.length,on=0;on<oW;on++)if(oD=ok[on]){var oV=oC._context;switch(oD.callee){case oV._translate:case 6:oo-=oD[0],or-=oD[1]}if(op.isHitCmd(oo,or,oD))return!0}return!1},op.isHitCmd=function(oo,or,oT){if(!oT)return!1;var ok=oC._context,oW=!1;switch(oT.callee){case ok._drawRect:case 13:op._rec.setTo(oT[0],oT[1],oT[2],oT[3]),oW=op._rec.contains(oo,or);break;case ok._drawCircle:case ok._fillCircle:case 14:oW=(oo-=oT[0])*oo+(or-=oT[1])*or<oT[2]*oT[2];break;case ok._drawPoly:case 18:oo-=oT[0],or-=oT[1],oW=op.ptInPolygon(oo,or,oT[2])}return oW},op.ptInPolygon=function(oo,or,oT){var ok;(ok=op._ptPoint).setTo(oo,or);var oW,oD=0,on=NaN,oV=NaN,oL=NaN,oU=NaN;oW=oT.length;for(var oh=0;oh<oW;oh+=2){if(on=oT[oh],oV=oT[oh+1],oL=oT[(oh+2)%oW],oV!=(oU=oT[(oh+3)%oW]))if(!(ok.y<Math.min(oV,oU)))if(!(ok.y>=Math.max(oV,oU)))(ok.y-oV)*(oL-on)/(oU-oV)+on>ok.x&&oD++}return oD%2==1},op._cmds=[],oL(op,["_rec",function(){return this._rec=new oP},"_ptPoint",function(){return this._ptPoint=new oF}]),op}(),oG=(function(){function oW(oo,or,oT,ok){this.char=oo,this.charNum=oo.charCodeAt(0),this._x=this._y=0,this.width=or,this.height=oT,this.style=ok,this.isWord=!oW._isWordRegExp.test(oo)}oj(oW,"laya.utils.HTMLChar");var oo=oW.prototype;ob.imps(oo,{"laya.display.ILayout":!0}),oo.setSprite=function(oo){this._sprite=oo},oo.getSprite=function(){return this._sprite},oo._isChar=function(){return!0},oo._getCSSStyle=function(){return this.style},oh(0,oo,"width",function(){return this._w},function(oo){this._w=oo}),oh(0,oo,"x",function(){return this._x},function(oo){this._sprite&&(this._sprite.x=oo),this._x=oo}),oh(0,oo,"y",function(){return this._y},function(oo){this._sprite&&(this._sprite.y=oo),this._y=oo}),oh(0,oo,"height",function(){return this._h},function(oo){this._h=oo}),oW._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function or(){}oj(or,"laya.utils.Log"),or.enable=function(){or._logdiv||(or._logdiv=oe.window.document.createElement("div"),oe.window.document.body.appendChild(or._logdiv),or._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},or.toggle=function(){var oo=or._logdiv.style;"1px"==oo.width?oo.width=oo.height="50%":oo.width=oo.height="1px"},or.print=function(oo){or._logdiv&&(or.maxCount<=or._count&&or.clear(),or._count++,or._logdiv.innerText+=oo+"\n",or._logdiv.scrollTop=or._logdiv.scrollHeight)},or.clear=function(){or._logdiv.innerText="",or._count=0},or._logdiv=null,or._count=0,or.maxCount=20}(),function(){function or(){}oj(or,"laya.utils.Mouse"),oh(1,or,"cursor",function(){return or._style.cursor},function(oo){or._style.cursor=oo}),or.hide=function(){"none"!=or.cursor&&(or._preCursor=or.cursor,or.cursor="none")},or.show=function(){"none"==or.cursor&&(or.cursor=or._preCursor?or._preCursor:"auto")},or._preCursor=null,oL(or,["_style",function(){return this._style=oe.document.body.style}])}(),function(){function oD(){}return oj(oD,"laya.utils.Pool"),oD.getPoolBySign=function(oo){return oD._poolDic[oo]||(oD._poolDic[oo]=[])},oD.clearBySign=function(oo){oD._poolDic[oo]&&(oD._poolDic[oo].length=0)},oD.recover=function(oo,or){or.__InPool||(or.__InPool=!0,oD.getPoolBySign(oo).push(or))},oD.getItemByClass=function(oo,or){var oT=oD.getPoolBySign(oo),ok=oT.length?oT.pop():new or;return ok.__InPool=!1,ok},oD.getItemByCreateFun=function(oo,or,oT){var ok=oD.getPoolBySign(oo),oW=ok.length?ok.pop():or.call(oT);return oW.__InPool=!1,oW},oD.getItem=function(oo){var or=oD.getPoolBySign(oo),oT=or.length?or.pop():null;return oT&&(oT.__InPool=!1),oT},oD._poolDic={},oD.InPoolSign="__InPool",oD}()),ow=function(){function oL(){}return oj(oL,"laya.utils.Stat"),oh(1,oL,"onclick",null,function(oo){oL._sp&&oL._sp.on("click",oL._sp,oo),oL._canvas&&(oL._canvas.source.onclick=oo,oL._canvas.source.style.pointerEvents="")}),oL.show=function(oo,or,oT){if(void 0===oo&&(oo=0),void 0===or&&(or=0),void 0===oT&&(oT=0),!oC.isConchApp||oC.isConchWebGL){if(oC.isConchWebGL||oe.onMiniGame||oe.onLimixiu||(oL._useCanvas=!0),oL._show=!0,oL._fpsData.length=60,oL._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},oL._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},oL._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},oL._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},oC.isWebGL)if(oL._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},oC.is3DMode){if(oL._view[0].title="FPS(3D)",oL._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},oL._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},oL._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==oT){var ok=8;oL._view[ok++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},oL._view[ok++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},oL._view[ok++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},oL._view[ok++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},oL._view[ok++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},oL._view[ok++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},oL._view[ok++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},oL._view[ok++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},oL._view[ok++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==oT){ok=8;oL._view[ok++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},oL._view[ok++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},oL._view[ok++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},oL._view[ok++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},oL._view[ok++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},oL._view[ok++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},oL._view[ok++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else oL._view[0].title="FPS(WebGL)",oL._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else oL._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};oL._useCanvas?oL.createUIPre(oo,or):oL.createUI(oo,or),oL.enable()}else oe.window.conch.showFPS&&oe.window.conch.showFPS(oo,or)},oL.createUIPre=function(oo,or){var oT=oe.pixelRatio;oL._width=170*oT,oL._vx=75*oT,oL._height=oT*(12*oL._view.length+3*oT)+4,oL._fontSize=12*oT;for(var ok=0;ok<oL._view.length;ok++)oL._view[ok].x=4,oL._view[ok].y=ok*oL._fontSize+2*oT;oL._canvas||((oL._canvas=new oyo("2D")).size(oL._width,oL._height),(oL._ctx=oL._canvas.getContext("2d")).textBaseline="top",oL._ctx.font=oL._fontSize+"px Sans-serif",oL._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+oo+"px;top:"+or+"px;width:"+oL._width/oT+"px;height:"+oL._height/oT+"px;"),oL._first=!0,oL.loop(),oL._first=!1,oe.container.appendChild(oL._canvas.source)},oL.createUI=function(oo,or){var oT=oL._sp,ok=oe.pixelRatio;oT||(oT=new opo,(oL._leftText=new o_o).pos(5,5),oL._leftText.color="#ffffff",oT.addChild(oL._leftText),(oL._txt=new o_o).pos(80*ok,5),oL._txt.color="#ffffff",oT.addChild(oL._txt),oL._sp=oT),oT.pos(oo,or);for(var oW="",oD=0;oD<oL._view.length;oD++){oW+=oL._view[oD].title+"\n"}oL._leftText.text=oW;var on=170*ok,oV=ok*(12*oL._view.length+3*ok)+4;oL._txt.fontSize=oL._fontSize*ok,oL._leftText.fontSize=oL._fontSize*ok,oT.size(on,oV),oT.graphics.clear(),oT.graphics.setAlpha(.5),oT.graphics.drawRect(0,0,on,oV,"#999999"),oT.graphics.setAlpha(1),oL.loop()},oL.enable=function(){ob.timer.frameLoop(1,oL,oL.loop)},oL.hide=function(){oL._show=!1,ob.timer.clear(oL,oL.loop),oL._canvas&&oe.removeElement(oL._canvas.source)},oL.clear=function(){oL.trianglesFaces=oL.drawCall=oL.shaderCall=oL.spriteCount=oL.spriteRenderUseCacheCount=oL.treeNodeCollision=oL.treeSpriteCollision=oL.canvasNormal=oL.canvasBitmap=oL.canvasReCache=0},oL.loop=function(){oL._count++;var oo=oe.now();if(!(oo-oL._timer<1e3)){var or=oL._count;if(oL.FPS=Math.round(1e3*or/(oo-oL._timer)),oL._show){oL.trianglesFaces=Math.round(oL.trianglesFaces/or),oL.spriteCount=oL._useCanvas?(oL.drawCall=Math.round(oL.drawCall/or)-2,oL.shaderCall=Math.round(oL.shaderCall/or),Math.round(oL.spriteCount/or)-1):(oL.drawCall=Math.round(oL.drawCall/or)-2,oL.shaderCall=Math.round(oL.shaderCall/or)-4,Math.round(oL.spriteCount/or)-4),oL.spriteRenderUseCacheCount=Math.round(oL.spriteRenderUseCacheCount/or),oL.canvasNormal=Math.round(oL.canvasNormal/or),oL.canvasBitmap=Math.round(oL.canvasBitmap/or),oL.canvasReCache=Math.ceil(oL.canvasReCache/or),oL.treeNodeCollision=Math.round(oL.treeNodeCollision/or),oL.treeSpriteCollision=Math.round(oL.treeSpriteCollision/or);var oT=0<oL.FPS?Math.floor(1e3/oL.FPS).toString():" ";oL._fpsStr=oL.FPS+(oL.renderSlow?" slow":"")+" "+oT,oL._spriteStr=oL.spriteCount+(oL.spriteRenderUseCacheCount?"/"+oL.spriteRenderUseCacheCount:""),oL._canvasStr=oL.canvasReCache+"/"+oL.canvasNormal+"/"+oL.canvasBitmap,oL.currentMemorySize=oc.systemResourceManager.memorySize,oL._useCanvas?oL.renderInfoPre():oL.renderInfo(),oL.clear()}oL._count=0,oL._timer=oo}},oL.renderInfoPre=function(){if(oL._canvas){var oo=oL._ctx;oo.clearRect(oL._first?0:oL._vx,0,oL._width,oL._height);for(var or=oC.WebGL.mainContext,oT=0;oT<oL._view.length;oT++){var ok=oL._view[oT];oL._first&&(oo.fillStyle="white",oo.fillText(ok.title,ok.x,ok.y,null,null,null)),oo.fillStyle=ok.color;var oW=-1;if((ok=oL._view[oT]).varying){if(or)switch(ok.varying){case 1:oW=or.getParameter(or[ok.value]);break;case 2:oW=or.getExtension(ok.value)}}else oW=oL[ok.value];"M"==ok.units&&(oW=Math.floor(oW/1048576*100)/100+" M"),"K"==ok.units&&(oW=Math.floor(oW/1024*100)/100+" K"),"string"==ok.units&&(oW=oW.match(/\d+\.?\d/i)),oo.fillText(oW+"",ok.x+oL._vx,ok.y,null,null,null)}}},oL.renderInfo=function(){for(var oo="",or=oC.WebGL.mainContext,oT=0;oT<oL._view.length;oT++){var ok=oL._view[oT],oW=-1;if(ok.varying){if(or)switch(ok.varying){case 1:oW=or.getParameter(or[ok.value]);break;case 2:oW=or.getExtension(ok.value)}}else oW=oL[ok.value];"M"==ok.units&&(oW=Math.floor(oW/1048576*100)/100+" M"),"K"==ok.units&&(oW=Math.floor(oW/1024*100)/100+" K"),"string"==ok.units&&(oW=oW.match(/\d+\.?\d/i)),oo+=oW+"\n"}oL._txt.text=oo},oL.FPS=0,oL.loopCount=0,oL.shaderCall=0,oL.drawCall=0,oL.trianglesFaces=0,oL.spriteCount=0,oL.spriteRenderUseCacheCount=0,oL.treeNodeCollision=0,oL.treeSpriteCollision=0,oL.canvasNormal=0,oL.canvasBitmap=0,oL.canvasReCache=0,oL.renderSlow=!1,oL.currentMemorySize=0,oL._fpsStr=null,oL._canvasStr=null,oL._spriteStr=null,oL._fpsData=[],oL._timer=0,oL._count=0,oL._view=[],oL._fontSize=12,oL._txt=null,oL._leftText=null,oL._sp=null,oL._show=!1,oL._useCanvas=!1,oL._canvas=null,oL._ctx=null,oL._first=!1,oL._vx=NaN,oL._width=0,oL._height=100,oL}(),oZ=(function(){function oo(){this._strsToID={},this._idToStrs=[],this._length=0}oj(oo,"laya.utils.StringKey");var or=oo.prototype;or.add=function(oo){var or=this._strsToID[oo];return null!=or?or:(this._idToStrs[this._length]=oo,this._strsToID[oo]=this._length++)},or.getID=function(oo){var or=this._strsToID[oo];return null==or?-1:or},or.getName=function(oo){var or=this._idToStrs[oo];return null==or?void 0:or}}(),function(){var oU;function oo(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}oj(oo,"laya.utils.Timer");var or=oo.prototype;return or._init=function(){ob.timer&&ob.timer.frameLoop(1,this,this._update)},or._now=function(){return Date.now()},or._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var oo=this.currFrame=this.currFrame+this.scale,or=this._now();this._delta=(or-this._lastTimer)*this.scale;var oT=this.currTimer=this.currTimer+this._delta;ob.isDebug&&6e4<Math.abs(or-this._lastTimer)&&console.error("系统时间错误！"+(or-this._lastTimer)),this._lastTimer=or;var ok=this._handlers;for(on=this._count=0,oV=ok.length;on<oV;on++)if(null!==(oL=ok[on]).method){var oW=oL.userFrame?oo:oT;if(oW>=oL.exeTime)if(oL.repeat)if(oL.jumpFrame)for(;oW>=oL.exeTime;)oL.exeTime+=oL.delay,oL.run(!1);else oL.exeTime+=oL.delay,oL.run(!1),oW>oL.exeTime&&(oL.exeTime+=Math.ceil((oW-oL.exeTime)/oL.delay)*oL.delay);else oL.run(!0)}else this._count++;(30<this._count||oo%200==0)&&this._clearHandlers();for(var oD=this._laters,on=0,oV=oD.length-1;on<=oV;on++){var oL=oD[on];this._isIgnoreRecover(oL)||(null!==oL.method&&(delete this._map[oL.key],oL.run(!1)),this._recoverHandler(oL)),on===oV&&(oV=oD.length-1)}oD.length=0}},or._clearHandlers=function(){for(var oo=this._handlers,or=0,oT=oo.length;or<oT;or++){var ok=oo[or];null!==ok.method?this._temp.push(ok):this._isIgnoreRecover(ok)?this._temp.push(ok):this._recoverHandler(ok)}this._handlers=this._temp,this._temp=oo,this._temp.length=0},or._recoverHandler=function(oo){this._map[oo.key]==oo&&delete this._map[oo.key],oo.recover()},or._create=function(oo,or,oT,ok,oW,oD,on,oV){if(!oT)return oW.apply(ok,oD),null;if(on){var oL=this._getHandler(ok,oW);if(oL)return oL.repeat=or,oL.userFrame=oo,oL.delay=oT,oL.ignoreRecover=oV,oL.caller=ok,oL.method=oW,oL.args=oD,oL.exeTime=oT+(oo?this.currFrame:this.currTimer+this._now()-this._lastTimer),oL}return(oL=oU.create()).repeat=or,oL.userFrame=oo,oL.delay=oT,oL.ignoreRecover=oV,oL.caller=ok,oL.method=oW,oL.args=oD,oL.exeTime=oT+(oo?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(oL),this._handlers.push(oL),oL},or._indexHandler=function(oo){var or=oo.caller,oT=oo.method,ok=or?or.$_GID||(or.$_GID=og.getGID()):0,oW=oT.$_TID||(oT.$_TID=this._mid++);oo.key=ok+"_"+oW,this._map[oo.key]=oo},or.once=function(oo,or,oT,ok,oW){void 0===oW&&(oW=!0),this._create(!1,!1,oo,or,oT,ok,oW,!1)},or.loop=function(oo,or,oT,ok,oW,oD,on){void 0===oW&&(oW=!0),void 0===oD&&(oD=!1),void 0===on&&(on=!1);var oV=this._create(!1,!0,oo,or,oT,ok,oW,on);oV&&(oV.jumpFrame=oD)},or.frameOnce=function(oo,or,oT,ok,oW){void 0===oW&&(oW=!0),this._create(!0,!1,oo,or,oT,ok,oW,!1)},or.frameLoop=function(oo,or,oT,ok,oW,oD){void 0===oW&&(oW=!0),void 0===oD&&(oD=!1),this._create(!0,!0,oo,or,oT,ok,oW,oD)},or.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+oU._freeCount},or.clear=function(oo,or){var oT=this._getHandler(oo,or);return!(!oT||this._isIgnoreRecover(oT))&&(delete this._map[oT.key],oT.key=null,oT.clear(),!0)},or.clearAll=function(oo){if(oo)for(var or=0,oT=this._handlers.length;or<oT;or++){var ok=this._handlers[or];ok.caller===oo&&(this._isIgnoreRecover(ok)||(delete this._map[ok.key],ok.key=null,ok.clear()))}},or._getHandler=function(oo,or){var oT=oo?oo.$_GID||(oo.$_GID=og.getGID()):0,ok=or.$_TID||(or.$_TID=this._mid++);return this._map[oT+"_"+ok]},or._isIgnoreRecover=function(oo){if(oo.ignoreRecover||oo.caller&&"IgnoreRecover"==oo.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var or="";try{arguments.propertyIsEnumerable.caller}catch(oo){or=oo.stack}ob.recordError("报错：核心定时器销毁忽略  "+or)}return!0}return!1},or.hasHandler=function(oo,or){return this._map[oo.$_GID+"_"+or.$_TID]},or.callLater=function(oo,or,oT){if(null==this._getHandler(oo,or)){var ok=oU.create();ok.caller=oo,ok.method=or,ok.args=oT,this._indexHandler(ok),this._laters.push(ok)}},or.runCallLater=function(oo,or){var oT=this._getHandler(oo,or);oT&&null!=oT.method&&(this._isIgnoreRecover(oT)||(delete this._map[oT.key],oT.run(!0)))},or.runTimer=function(oo,or){this.runCallLater(oo,or)},oh(0,or,"delta",function(){return this._delta}),oo.__init$=function(){oU=function(){function or(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}oj(or,"");var oo=or.prototype;return oo.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},oo.recover=function(){this.clear(),this.args=or._freeHandler,or._freeHandler=this,or._freeCount++},oo.run=function(oo){var or=this.caller;if(or&&or.destroyed)return this.clear();var oT=this.method,ok=this.args;oo&&this.clear(),null!=oT&&(ok?oT.apply(or,ok):oT.call(or))},or._freeHandler=null,or._freeCount=0,or.create=function(){var oo=or._freeHandler;return oo?(or._freeHandler=oo.args,--or._freeCount,oo.args=null,oo):new or},or}()},oo}()),oQ=function(){function op(){this.gid=0}oj(op,"laya.utils.Tween");var oo=op.prototype;return oo.to=function(oo,or,oT,ok,oW,oD,on){return void 0===oD&&(oD=0),void 0===on&&(on=!1),this._create(oo,or,oT,ok,oW,oD,on,!0,!1,!0)},oo.from=function(oo,or,oT,ok,oW,oD,on){return void 0===oD&&(oD=0),void 0===on&&(on=!1),this._create(oo,or,oT,ok,oW,oD,on,!1,!1,!0)},oo._create=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){if(!oo)throw new Error("Tween:target is null");this._target=oo,this._duration=oT,this._ease=ok||or.ease||op.easeNone,this._complete=oW||or.complete,this._delay=oD,this._props=[],this._usedTimer=0,this._startTimer=oe.now(),this._usedPool=oL,this._delayParam=null,this.update=or.update;var oh=oo.$_GID||(oo.$_GID=og.getGID());return op.tweenMap[oh]?(on&&op.clearTween(oo),op.tweenMap[oh].push(this)):op.tweenMap[oh]=[this],oU?oD<=0?this.firstStart(oo,or,oV):(this._delayParam=[oo,or,oV],ob.scaleTimer.once(oD,this,this.firstStart,this._delayParam)):this._initProps(oo,or,oV),this},oo.firstStart=function(oo,or,oT){this._delayParam=null,oo.destroyed?this.clear():(this._initProps(oo,or,oT),this._beginLoop())},oo._initProps=function(oo,or,oT){for(var ok in or)if("number"==typeof oo[ok]){var oW=oT?oo[ok]:or[ok],oD=oT?or[ok]:oo[ok];this._props.push([ok,oW,oD-oW]),oT||(oo[ok]=oW)}},oo._beginLoop=function(){ob.scaleTimer.frameLoop(1,this,this._doEase)},oo._doEase=function(){this._updateEase(oe.now())},oo._updateEase=function(oo){var or=this._target;if(or){if(or.destroyed)return op.clearTween(or);var oT=this._usedTimer=oo-this._startTimer-this._delay;if(!(oT<0)){if(oT>=this._duration)return this.complete();for(var ok=0<oT?this._ease(oT,0,1,this._duration):0,oW=this._props,oD=0,on=oW.length;oD<on;oD++){var oV=oW[oD];or[oV[0]]=oV[1]+ok*oV[2]}this.update&&this.update.run()}}},oo.complete=function(){if(this._target){ob.scaleTimer.runTimer(this,this.firstStart);for(var oo=this._target,or=this._props,oT=this._complete,ok=0,oW=or.length;ok<oW;ok++){var oD=or[ok];oo[oD[0]]=oD[1]+oD[2]}this.update&&this.update.run(),this.clear(),oT&&oT.run()}},oo.pause=function(){ob.scaleTimer.clear(this,this._beginLoop),ob.scaleTimer.clear(this,this._doEase),ob.scaleTimer.clear(this,this.firstStart);var oo;(oo=oe.now()-this._startTimer-this._delay)<0&&(this._usedTimer=oo)},oo.setStartTime=function(oo){this._startTimer=oo},oo.clear=function(){this._target&&(this._remove(),this._clear())},oo._clear=function(){this.pause(),ob.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,oG.recover("tween",this))},oo.recover=function(){this._usedPool=!0,this._clear()},oo._remove=function(){var oo=op.tweenMap[this._target.$_GID];if(oo)for(var or=0,oT=oo.length;or<oT;or++)if(oo[or]===this){oo.splice(or,1);break}},oo.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=oe.now(),this._delayParam)ob.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var oo=this._props,or=0,oT=oo.length;or<oT;or++){var ok=oo[or];this._target[ok[0]]=ok[1]}ob.scaleTimer.once(this._delay,this,this._beginLoop)}},oo.resume=function(){this._usedTimer>=this._duration||(this._startTimer=oe.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?ob.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},oh(0,oo,"progress",null,function(oo){var or=oo*this._duration;this._startTimer=oe.now()-this._delay-or}),op.to=function(oo,or,oT,ok,oW,oD,on,oV){return void 0===oD&&(oD=0),void 0===on&&(on=!1),void 0===oV&&(oV=!0),oG.getItemByClass("tween",op)._create(oo,or,oT,ok,oW,oD,on,!0,oV,!0)},op.from=function(oo,or,oT,ok,oW,oD,on,oV){return void 0===oD&&(oD=0),void 0===on&&(on=!1),void 0===oV&&(oV=!0),oG.getItemByClass("tween",op)._create(oo,or,oT,ok,oW,oD,on,!1,oV,!0)},op.clearAll=function(oo){if(oo&&oo.$_GID){var or=op.tweenMap[oo.$_GID];if(or){for(var oT=0,ok=or.length;oT<ok;oT++)or[oT]._clear();or.length=0}}},op.clear=function(oo){oo.clear()},op.clearTween=function(oo){op.clearAll(oo)},op.easeNone=function(oo,or,oT,ok){return oT*oo/ok+or},op.tweenMap={},op}(),og=function(){function oV(){}return oj(oV,"laya.utils.Utils"),oV.toRadian=function(oo){return oo*oV._pi2},oV.toAngle=function(oo){return oo*oV._pi},oV.toHexColor=function(oo){if(oo<0||isNaN(oo))return null;for(var or=oo.toString(16);or.length<6;)or="0"+or;return"#"+or},oV.getGID=function(){return oV._gid++},oV.concatArray=function(oo,or){if(!or)return oo;if(!oo)return or;var oT=0,ok=or.length;for(oT=0;oT<ok;oT++)oo.push(or[oT]);return oo},oV.clearArray=function(oo){return oo&&(oo.length=0),oo},oV.copyArray=function(oo,or){if(oo||(oo=[]),!or)return oo;oo.length=or.length;var oT=0,ok=or.length;for(oT=0;oT<ok;oT++)oo[oT]=or[oT];return oo},oV.getGlobalRecByPoints=function(oo,or,oT,ok,oW){var oD,on;return oD=new oF(or,oT),oD=oo.localToGlobal(oD),on=new oF(ok,oW),on=oo.localToGlobal(on),oP._getWrapRec([oD.x,oD.y,on.x,on.y])},oV.getGlobalPosAndScale=function(oo){return oV.getGlobalRecByPoints(oo,0,0,1,1)},oV.bind=function(oo,or){return oo.bind(or)},oV.measureText=function(oo,or){return ou.measureText(oo,or)},oV.updateOrder=function(oo){if(!oo||oo.length<2)return!1;for(var or,oT=1,ok=0,oW=oo.length,oD=NaN;oT<oW;){for(or=oo[ok=oT],oD=oo[ok]._zOrder;-1<--ok&&oo[ok]._zOrder>oD;)oo[ok+1]=oo[ok];oo[ok+1]=or,oT++}var on=or.parent.conchModel;if(on)if(null!=on.updateZOrder)on.updateZOrder();else{for(oT=0;oT<oW;oT++)on.removeChild(oo[oT].conchModel);for(oT=0;oT<oW;oT++)on.addChildAt(oo[oT].conchModel,oT)}return!0},oV.transPointList=function(oo,or,oT){var ok=0,oW=oo.length;for(ok=0;ok<oW;ok+=2)oo[ok]+=or,oo[ok+1]+=oT},oV.parseInt=function(oo,or){void 0===or&&(or=0);var oT=oe.window.parseInt(oo,or);return isNaN(oT)?0:oT},oV.getFileExtension=function(oo){oV._extReg.lastIndex=oo.lastIndexOf(".");var or=oV._extReg.exec(oo);return or&&1<or.length?or[1].toLowerCase():null},oV.getTransformRelativeToWindow=function(oo,or,oT){var ok=ob.stage,oW=laya.utils.Utils.getGlobalPosAndScale(oo),oD=ok._canvasTransform.clone(),on=oD.tx,oV=oD.ty;oD.rotate(-Math.PI/180*ob.stage.canvasDegree),oD.scale(ob.stage.clientScaleX,ob.stage.clientScaleY);var oL=ob.stage.canvasDegree%180!=0,oU=NaN,oh=NaN;oL?(oU=oT+oW.y,oh=or+oW.x,oU*=oD.d,oh*=oD.a,90==ob.stage.canvasDegree?(oU=on-oU,oh+=oV):(oU+=on,oh=oV-oh)):(oU=or+oW.x,oh=oT+oW.y,oU*=oD.a,oh*=oD.d,oU+=on,oh+=oV);var op=NaN,oi=NaN;return oi=oL?(op=oD.d*oW.height,oD.a*oW.width):(op=oD.a*oW.width,oD.d*oW.height),{x:oU,y:oh,scaleX:op,scaleY:oi}},oV.fitDOMElementInArea=function(oo,or,oT,ok,oW,oD){oo._fitLayaAirInitialized||(oo._fitLayaAirInitialized=!0,oo.style.transformOrigin=oo.style.webKittransformOrigin="left top",oo.style.position="absolute");var on=oV.getTransformRelativeToWindow(or,oT,ok);oo.style.transform=oo.style.webkitTransform="scale("+on.scaleX+","+on.scaleY+") rotate("+ob.stage.canvasDegree+"deg)",oo.style.width=oW+"px",oo.style.height=oD+"px",oo.style.left=on.x+"px",oo.style.top=on.y+"px"},oV.isOkTextureList=function(oo){if(!oo)return!1;var or,oT=0,ok=oo.length;for(oT=0;oT<ok;oT++)if(!(or=oo[oT])||!or.source)return!1;return!0},oV.isOKCmdList=function(oo){if(!oo)return!1;var or,oT,ok=0,oW=oo.length,oD=oC._context;for(ok=0;ok<oW;ok++)switch((or=oo[ok]).callee){case oD._drawTexture:case oD._fillTexture:case oD._drawTextureWithTransform:if(!(oT=or[0])||!oT.source)return!1}return!0},oV._gid=1,oV._pi=180/Math.PI,oV._pi2=Math.PI/180,oV._extReg=/\.(\w+)\??/g,oV.parseXMLFromString=function(oo){var or;if(oo=oo.replace(/>\s+</g,"><"),-1<(or=(new DOMParser).parseFromString(oo,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(or.firstChild.firstChild.textContent);return or},oV}(),oB=function(){function oo(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],oC.isWebGL&&oY.regCacheByFunction(og.bind(this.startDispose,this),og.bind(this.getCacheList,this))}oj(oo,"laya.utils.VectorGraphManager");var or=oo.prototype;return or.getId=function(){return this._id++},or.addShape=function(oo,or){this.shapeDic[oo]=or,this.useDic[oo]||(this.useDic[oo]=!0)},or.addLine=function(oo,or){this.shapeLineDic[oo]=or,this.shapeLineDic[oo]||(this.shapeLineDic[oo]=!0)},or.getShape=function(oo){this._checkKey&&null!=this.useDic[oo]&&(this.useDic[oo]=!0)},or.deleteShape=function(oo){this.shapeDic[oo]&&(this.shapeDic[oo]=null,delete this.shapeDic[oo]),this.shapeLineDic[oo]&&(this.shapeLineDic[oo]=null,delete this.shapeLineDic[oo]),null!=this.useDic[oo]&&delete this.useDic[oo]},or.getCacheList=function(){var oo,or=[];for(oo in this.shapeDic)or.push(this.shapeDic[oo]);for(oo in this.shapeLineDic)or.push(this.shapeLineDic[oo]);return or},or.startDispose=function(oo){var or;for(or in this.useDic)this.useDic[or]=!1;this._checkKey=!0},or.endDispose=function(){if(this._checkKey){var oo;for(oo in this.useDic)this.useDic[oo]||this.deleteShape(oo);this._checkKey=!1}},oo.getInstance=function(){return oo.instance=oo.instance||new oo},oo.instance=null,oo}(),oE=function(){function ok(){this._obj=null,this._obj=ok.supportWeakMap?new oe.window.WeakMap:{},ok.supportWeakMap||ok._maps.push(this)}oj(ok,"laya.utils.WeakObject");var oo=ok.prototype;return oo.set=function(oo,or){if(null!=oo)if(ok.supportWeakMap){var oT=oo;"string"!=typeof oo&&"number"!=typeof oo||(oT=ok._keys[oo])||(oT=ok._keys[oo]={k:oo}),this._obj.set(oT,or)}else"string"==typeof oo||"number"==typeof oo?this._obj[oo]=or:(oo.$_GID||(oo.$_GID=og.getGID()),this._obj[oo.$_GID]=or)},oo.get=function(oo){if(null==oo)return null;if(ok.supportWeakMap){var or="string"==typeof oo||"number"==typeof oo?ok._keys[oo]:oo;return or?this._obj.get(or):null}return"string"==typeof oo||"number"==typeof oo?this._obj[oo]:this._obj[oo.$_GID]},oo.del=function(oo){if(null!=oo)if(ok.supportWeakMap){var or="string"==typeof oo||"number"==typeof oo?ok._keys[oo]:oo;if(!or)return;this._obj.delete(or)}else"string"==typeof oo||"number"==typeof oo?delete this._obj[oo]:delete this._obj[this._obj.$_GID]},oo.has=function(oo){if(null==oo)return!1;if(ok.supportWeakMap){var or="string"==typeof oo||"number"==typeof oo?ok._keys[oo]:oo;return this._obj.has(or)}return"string"==typeof oo||"number"==typeof oo?null!=this._obj[oo]:null!=this._obj[this._obj.$_GID]},ok.__init__=function(){(ok.supportWeakMap=null!=oe.window.WeakMap)||ob.timer.loop(ok.delInterval,null,ok.clearCache)},ok.clearCache=function(){for(var oo=0,or=ok._maps.length;oo<or;oo++){ok._maps[oo]._obj={}}},ok.supportWeakMap=!1,ok.delInterval=3e5,ok._keys={},ok._maps=[],oL(ok,["I",function(){return this.I=new ok}]),ok}(),od=function(){function oo(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}oj(oo,"laya.utils.WordText");var or=oo.prototype;return or.setText=function(oo){this.changed=!0,this._text=oo},or.toString=function(){return this._text},or.charCodeAt=function(oo){return this._text?this._text.charCodeAt(oo):NaN},or.charAt=function(oo){return this._text?this._text.charAt(oo):null},oh(0,or,"length",function(){return this._text?this._text.length:0}),oo}(),ooo=function(oo){function on(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,on.__super.call(this),this._childs=on.ARRAY_EMPTY,this._$P=on.PROP_EMPTY,this.timer=ob.scaleTimer,this.conchModel=oC.isConchNode?this.createConchModel():null}oj(on,"laya.display.Node",oU);var or=on.prototype;return or._setBit=function(oo,or){1==oo&&(this._getBit(oo)!=or&&this._updateDisplayedInstage());or?this._bits|=oo:this._bits&=~oo},or._getBit=function(oo){return 0!=(this._bits&oo)},or._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},or._setUpNoticeType=function(oo){var or=this;for(or._setBit(oo,!0),or=or.parent;or;){if(or._getBit(oo))return;or._setBit(oo,!0),or=or.parent}},or.on=function(oo,or,oT,ok){return"display"!==oo&&"undisplay"!==oo||this._getBit(1)||this._setUpNoticeType(1),this._createListener(oo,or,oT,ok,!1)},or.once=function(oo,or,oT,ok){return"display"!==oo&&"undisplay"!==oo||this._getBit(1)||this._setUpNoticeType(1),this._createListener(oo,or,oT,ok,!0)},or.createConchModel=function(){return null},or.destroy=function(oo){void 0===oo&&(oo=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(oo?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},or.destroyChildren=function(){if(this._childs)for(var oo=this._childs.length-1;-1<oo;oo--)this._childs[oo].destroy(!0)},or.addChild=function(oo){if(!oo||this.destroyed||oo===this)return oo;if(oo.zOrder&&this._set$P("hasZorder",!0),oo._parent===this){var or=this.getChildIndex(oo);or!==this._childs.length-1&&(this._childs.splice(or,1),this._childs.push(oo),this.conchModel&&(this.conchModel.removeChild(oo.conchModel),this.conchModel.addChildAt(oo.conchModel,this._childs.length-1)),this._childChanged())}else oo.parent&&oo.parent.removeChild(oo),this._childs===on.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(oo),this.conchModel&&this.conchModel.addChildAt(oo.conchModel,this._childs.length-1),(oo.parent=this)._childChanged();return oo},or.addChildren=function(oo){for(var or=arguments,oT=0,ok=or.length;oT<ok;)this.addChild(or[oT++])},or.addChildAt=function(oo,or){if(!oo||this.destroyed||oo===this)return oo;if(oo.zOrder&&this._set$P("hasZorder",!0),0<=or&&or<=this._childs.length){if(oo._parent===this){var oT=this.getChildIndex(oo);this._childs.splice(oT,1),this._childs.splice(or,0,oo),this.conchModel&&(this.conchModel.removeChild(oo.conchModel),this.conchModel.addChildAt(oo.conchModel,or)),this._childChanged()}else oo.parent&&oo.parent.removeChild(oo),this._childs===on.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(or,0,oo),this.conchModel&&this.conchModel.addChildAt(oo.conchModel,or),oo.parent=this;return oo}throw new Error("appendChildAt:The index is out of bounds")},or.getChildIndex=function(oo){return this._childs.indexOf(oo)},or.getChildByName=function(oo){var or=this._childs;if(or)for(var oT=0,ok=or.length;oT<ok;oT++){var oW=or[oT];if(oW.name===oo)return oW}return null},or._get$P=function(oo){return this._$P[oo]},or._set$P=function(oo,or){return this.destroyed||(this._$P===on.PROP_EMPTY&&(this._$P={}),this._$P[oo]=or),or},or.getChildAt=function(oo){return this._childs[oo]},or.setChildIndex=function(oo,or){var oT=this._childs;if(or<0||or>=oT.length)throw new Error("setChildIndex:The index is out of bounds.");var ok=this.getChildIndex(oo);if(ok<0)throw new Error("setChildIndex:node is must child of this object.");return oT.splice(ok,1),oT.splice(or,0,oo),this.conchModel&&(this.conchModel.removeChild(oo.conchModel),this.conchModel.addChildAt(oo.conchModel,or)),this._childChanged(),oo},or._childChanged=function(oo){},or.removeChild=function(oo){if(!this._childs)return oo;var or=this._childs.indexOf(oo);return this.removeChildAt(or)},or.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},or.removeChildByName=function(oo){var or=this.getChildByName(oo);return or&&this.removeChild(or),or},or.removeChildAt=function(oo){var or=this.getChildAt(oo);if(or){for(var oT=this._childs.length-1,ok=oo;ok<oT;++ok)this._childs[ok]=this._childs[ok+1];this._childs.length=oT,this.conchModel&&this.conchModel.removeChild(or.conchModel),or.parent=null}return or},or.removeChildren=function(oo,or){if(void 0===oo&&(oo=0),void 0===or&&(or=2147483647),this._childs&&0<this._childs.length){var oT=this._childs;if(0===oo&&oD<=or){var ok=oT;this._childs=on.ARRAY_EMPTY}else ok=oT.splice(oo,or-oo);for(var oW=0,oD=ok.length;oW<oD;oW++)ok[oW].parent=null,this.conchModel&&this.conchModel.removeChild(ok[oW].conchModel)}return this},or.replaceChild=function(oo,or){var oT=this._childs.indexOf(or);return-1<oT?(this._childs.splice(oT,1,oo),this.conchModel&&(this.conchModel.removeChild(or.conchModel),this.conchModel.addChildAt(oo.conchModel,oT)),or.parent=null,oo.parent=this,oo):null},or._updateDisplayedInstage=function(){var oo;oo=this;var or=ob.stage;for(this._displayedInStage=!1;oo;){if(oo._getBit(1)){this._displayedInStage=oo._displayedInStage;break}if(oo==or||oo._displayedInStage){this._displayedInStage=!0;break}oo=oo.parent}},or._setDisplay=function(oo){this._displayedInStage!==oo&&((this._displayedInStage=oo)?this.event("display"):this.event("undisplay"))},or._displayChild=function(oo,or){var oT=oo._childs;if(oT)for(var ok=0;ok<oT.length;ok++){var oW=oT[ok];oW&&oW._getBit(1)&&(0<oW._childs.length?this._displayChild(oW,or):oW._setDisplay(or))}oo._setDisplay(or)},or.contains=function(oo){if(oo===this)return!0;for(;oo;){if(oo.parent===this)return!0;oo=oo.parent}return!1},or.timerLoop=function(oo,or,oT,ok,oW,oD){void 0===oW&&(oW=!0),void 0===oD&&(oD=!1),this.timer.loop(oo,or,oT,ok,oW,oD)},or.timerOnce=function(oo,or,oT,ok,oW){void 0===oW&&(oW=!0),this.timer._create(!1,!1,oo,or,oT,ok,oW)},or.frameLoop=function(oo,or,oT,ok,oW){void 0===oW&&(oW=!0),this.timer._create(!0,!0,oo,or,oT,ok,oW)},or.frameOnce=function(oo,or,oT,ok,oW){void 0===oW&&(oW=!0),this.timer._create(!0,!1,oo,or,oT,ok,oW)},or.clearTimer=function(oo,or){this.timer.clear(oo,or)},oh(0,or,"numChildren",function(){return this._childs.length}),oh(0,or,"destroyed",function(){return this._destroyed}),oh(0,or,"parent",function(){return this._parent},function(oo){this._parent!==oo&&(oo?(this._parent=oo,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),oo.displayedInStage&&this._displayChild(this,!0)),oo._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=oo))}),oh(0,or,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),on.ARRAY_EMPTY=[],on.PROP_EMPTY={},on.NOTICE_DISPLAY=1,on.MOUSEENABLE=2,on}(),oro=function(oo){function oi(oo){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,oi.__super.call(this),this._padding=oi._PADDING,this._spacing=oi._SPACING,this._aligns=oi._ALIGNS,this._font=ov.EMPTY,this._ower=oo}oj(oi,"laya.display.css.CSSStyle",oo);var or=oi.prototype;return or.destroy=function(){this._ower=null,this._font=null,this._rect=null},or.inherit=function(oo){this._font=oo._font,this._spacing=oo._spacing===oi._SPACING?oi._SPACING:oo._spacing.slice(),this.lineHeight=oo.lineHeight},or._widthAuto=function(){return 0!=(262144&this._type)},or.widthed=function(oo){return 0!=(8&this._type)},or._calculation=function(oo,or){if(or.indexOf("%")<0)return!1;var ok=this._ower,oW=ok.parent,oD=this._rect;function on(oo,or,oT){return oo*oT[0]+or*oT[1]+oT[2]}function oT(oo){var or=oW.width,oT=ok.width;oD.width&&(ok.width=on(or,oT,oD.width)),oD.height&&(ok.height=on(or,oT,oD.height)),oD.left&&(ok.x=on(or,oT,oD.left)),oD.top&&(ok.y=on(or,oT,oD.top))}null===oD&&(oW._getCSSStyle()._type|=524288,oW.on("resize",this,oT),this._rect=oD={input:{}});var oV=or.split(" ");return oV[0]=parseFloat(oV[0])/100,1==oV.length?oV[1]=oV[2]=0:(oV[1]=parseFloat(oV[1])/100,oV[2]=parseFloat(oV[2])),oD[oo]=oV,oD.input[oo]=or,oT(),!0},or.heighted=function(oo){return 0!=(8192&this._type)},or.size=function(oo,or){var oT=this._ower,ok=!1;-1!==oo&&oo!=this._ower.width&&(this._type|=8,this._ower.width=oo,ok=!0),-1!==or&&or!=this._ower.height&&(this._type|=8192,this._ower.height=or,ok=!0),ok&&(oT._layoutLater(),524288&this._type&&oT.event("resize",this))},or._getAlign=function(){return this._aligns[0]},or._getValign=function(){return this._aligns[1]},or._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},or._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new ov(this._font))},or.render=function(oo,or,oT,ok){var oW=oo.width,oD=oo.height;oT-=oo.pivotX,ok-=oo.pivotY,this._bgground&&null!=this._bgground.color&&or.ctx.fillRect(oT,ok,oW,oD,this._bgground.color),this._border&&this._border.color&&or.drawRect(oT,ok,oW,oD,this._border.color.strColor,this._border.size)},or.getCSSStyle=function(){return this},or.cssText=function(oo){this.attrs(oi.parseOneCSS(oo,";"))},or.attrs=function(oo){if(oo)for(var or=0,oT=oo.length;or<oT;or++){var ok=oo[or];this[ok[0]]=ok[1]}},or.setTransform=function(oo){"none"===oo?this._tf=oV._TF_EMPTY:this.attrs(oi.parseOneCSS(oo,","))},or.translate=function(oo,or){this._tf===oV._TF_EMPTY&&(this._tf=new oW),this._tf.translateX=oo,this._tf.translateY=or},or.scale=function(oo,or){this._tf===oV._TF_EMPTY&&(this._tf=new oW),this._tf.scaleX=oo,this._tf.scaleY=or},or._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},oh(0,or,"block",oo.prototype._$get_block,function(oo){oo?this._type|=1:this._type&=-2}),oh(0,or,"valign",function(){return oi._valigndef[this._aligns[1]]},function(oo){this._aligns===oi._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=oi._valigndef[oo]}),oh(0,or,"height",null,function(oo){if(this._type|=8192,"string"==typeof oo){if(this._calculation("height",oo))return;oo=parseInt(oo)}this.size(-1,oo)}),oh(0,or,"width",null,function(oo){if(this._type|=8,"string"==typeof oo){var or=oo.indexOf("auto");if(0<=or&&(this._type|=262144,oo=oo.substr(0,or)),this._calculation("width",oo))return;oo=parseInt(oo)}this.size(oo,-1)}),oh(0,or,"fontWeight",function(){return this._font.weight},function(oo){this._createFont().weight=oo}),oh(0,or,"left",null,function(oo){var or=this._ower;if("string"==typeof oo){if("center"===oo?oo="50% -50% 0":"right"===oo&&(oo="100% -100% 0"),this._calculation("left",oo))return;oo=parseInt(oo)}or.x=oo}),oh(0,or,"_translate",null,function(oo){this.translate(oo[0],oo[1])}),oh(0,or,"absolute",function(){return 0!=(4&this._type)}),oh(0,or,"top",null,function(oo){var or=this._ower;if("string"==typeof oo){if("middle"===oo?oo="50% -50% 0":"bottom"===oo&&(oo="100% -100% 0"),this._calculation("top",oo))return;oo=parseInt(oo)}or.y=oo}),oh(0,or,"align",function(){return oi._aligndef[this._aligns[0]]},function(oo){this._aligns===oi._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=oi._aligndef[oo]}),oh(0,or,"bold",function(){return this._font.bold},function(oo){this._createFont().bold=oo}),oh(0,or,"padding",function(){return this._padding},function(oo){this._padding=oo}),oh(0,or,"leading",function(){return this._spacing[1]},function(oo){"string"==typeof oo&&(oo=parseInt(oo+"")),this._spacing===oi._SPACING&&(this._spacing=[0,0]),this._spacing[1]=oo}),oh(0,or,"lineElement",function(){return 0!=(65536&this._type)},function(oo){oo?this._type|=65536:this._type&=-65537}),oh(0,or,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(oo){this.lineElement=!1,"right"===oo?this._type|=32768:this._type&=-32769}),oh(0,or,"textDecoration",function(){return this._font.decoration},function(oo){this._createFont().decoration=oo}),oh(0,or,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(oo){"nowrap"===oo&&(this._type|=131072),"none"===oo&&(this._type&=-131073)}),oh(0,or,"background",null,function(oo){oo?(this._bgground||(this._bgground={}),this._bgground.color=oo,this._ower.conchModel&&this._ower.conchModel.bgColor(oo),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),oh(0,or,"wordWrap",function(){return 0==(131072&this._type)},function(oo){oo?this._type&=-131073:this._type|=131072}),oh(0,or,"color",function(){return this._font.color},function(oo){this._createFont().color=oo}),oh(0,or,"password",function(){return this._font.password},function(oo){this._createFont().password=oo}),oh(0,or,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(oo){"none"===oo?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=oo),this._ower.conchModel&&this._ower.conchModel.bgColor(oo),this._ower._renderType|=256}),oh(0,or,"font",function(){return this._font.toString()},function(oo){this._createFont().set(oo)}),oh(0,or,"weight",null,function(oo){this._createFont().weight=oo}),oh(0,or,"letterSpacing",function(){return this._spacing[0]},function(oo){"string"==typeof oo&&(oo=parseInt(oo+"")),this._spacing===oi._SPACING&&(this._spacing=[0,0]),this._spacing[0]=oo}),oh(0,or,"fontSize",function(){return this._font.size},function(oo){this._createFont().size=oo}),oh(0,or,"italic",function(){return this._font.italic},function(oo){this._createFont().italic=oo}),oh(0,or,"fontFamily",function(){return this._font.family},function(oo){this._createFont().family=oo}),oh(0,or,"stroke",function(){return this._font.stroke[0]},function(oo){this._createFont().stroke===ov._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=oo}),oh(0,or,"strokeColor",function(){return this._font.stroke[1]},function(oo){this._createFont().stroke===ov._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=oo}),oh(0,or,"border",function(){return this._border?this._border.value:""},function(oo){if("none"!=oo){this._border||(this._border={});var or=(this._border.value=oo).split(" ");if(this._border.color=oI.create(or[or.length-1]),1==or.length)return this._border.size=1,void(this._border.type="solid");var oT=0;0<or[0].indexOf("px")?(this._border.size=parseInt(or[0]),oT++):this._border.size=1,this._border.type=or[oT],this._ower._renderType|=256}else this._border=null}),oh(0,or,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(oo){oo?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==oo?null:oI.create(oo),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),oh(0,or,"position",function(){return 4&this._type?"absolute":""},function(oo){"absolute"==oo?this._type|=4:this._type&=-5}),oh(0,or,"display",null,function(oo){switch(oo){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),oh(0,or,"paddingLeft",function(){return this.padding[3]}),oh(0,or,"paddingTop",function(){return this.padding[0]}),oh(0,or,"_scale",null,function(oo){this._ower.scale(oo[0],oo[1])}),oh(0,or,"_rotate",null,function(oo){this._ower.rotation=oo}),oi.parseOneCSS=function(oo,or){for(var oT,ok=[],oW=oo.split(or),oD=0,on=oW.length;oD<on;oD++){var oV=oW[oD],oL=oV.indexOf(":"),oU=oV.substr(0,oL).replace(/^\s+|\s+$/g,"");if(0!=oU.length){var oh=oV.substr(oL+1).replace(/^\s+|\s+$/g,""),op=[oU,oh];switch(oU){case"italic":case"bold":op[1]="true"==oh;break;case"line-height":op[0]="lineHeight",op[1]=parseInt(oh);break;case"font-size":op[0]="fontSize",op[1]=parseInt(oh);break;case"padding":1<(oT=oh.split(" ")).length||(oT[1]=oT[2]=oT[3]=oT[0]),op[1]=[parseInt(oT[0]),parseInt(oT[1]),parseInt(oT[2]),parseInt(oT[3])];break;case"rotate":op[0]="_rotate",op[1]=parseFloat(oh);break;case"scale":oT=oh.split(" "),op[0]="_scale",op[1]=[parseFloat(oT[0]),parseFloat(oT[1])];break;case"translate":oT=oh.split(" "),op[0]="_translate",op[1]=[parseInt(oT[0]),parseInt(oT[1])];break;default:(op[0]=oi._CSSTOVALUE[oU])||(op[0]=oU)}ok.push(op)}}return ok},oi.parseCSS=function(oo,or){for(var oT;null!=(oT=oi._parseCSSRegExp.exec(oo));)oi.styleSheets[oT[1]]=oi.parseOneCSS(oT[2],";")},oi.EMPTY=new oi(null),oi._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},oi._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),oi._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},oi._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},oi.styleSheets={},oi.ALIGN_CENTER=1,oi.ALIGN_RIGHT=2,oi.VALIGN_MIDDLE=1,oi.VALIGN_BOTTOM=2,oi._CSS_BLOCK=1,oi._DISPLAY_NONE=2,oi._ABSOLUTE=4,oi._WIDTH_SET=8,oi._PADDING=[0,0,0,0],oi._RECT=[-1,-1,-1,-1],oi._SPACING=[0,0],oi._ALIGNS=[0,0,0],oi.ADDLAYOUTED=512,oi._NEWFONT=4096,oi._HEIGHT_SET=8192,oi._BACKGROUND_SET=16384,oi._FLOAT_RIGHT=32768,oi._LINE_ELEMENT=65536,oi._NOWARP=131072,oi._WIDTHAUTO=262144,oi._LISTERRESZIE=524288,oi}(oV),oTo=function(oo){function on(){this.url=null,this.audio=null,this.loaded=!1,on.__super.call(this)}oj(on,"laya.media.h5audio.AudioSound",oU);var or=on.prototype;return or.dispose=function(){var oo=on._audioCache[this.url];oo&&(oo.src="",delete on._audioCache[this.url])},or.load=function(oo){var or;if(oo=om.formatURL(oo),(this.url=oo)==oR._tMusic?(on._initMusicAudio(),(or=on._musicAudio).src!=oo&&(on._audioCache[or.src]=null,or=null)):or=on._audioCache[oo],or&&2<=or.readyState)this.event("complete");else{or||(or=oo==oR._tMusic?(on._initMusicAudio(),on._musicAudio):oe.createElement("audio"),(on._audioCache[oo]=or).src=oo),or.addEventListener("canplaythrough",ok),or.addEventListener("error",oW);var oT=this;(this.audio=or).load?or.load():oW()}function ok(){oD(),oT.loaded=!0,oT.event("complete")}function oW(){or.load=null,oD(),oT.event("error")}function oD(){or.removeEventListener("canplaythrough",ok),or.removeEventListener("error",oW)}},or.play=function(oo,or,oT){if(void 0===oo&&(oo=0),void 0===or&&(or=0),!this.url)return null;var ok,oW;if(!(ok=this.url==oR._tMusic?on._musicAudio:on._audioCache[this.url]))return null;oW=oG.getItem("audio:"+this.url),oC.isConchApp?oW||((oW=oe.createElement("audio")).src=this.url):this.url==oR._tMusic?(on._initMusicAudio(),(oW=on._musicAudio).src=this.url):oW=oW||ok.cloneNode(!0);var oD=new oio(oW);return oD.url=this.url,oD.loops=or,oD.startTime=oo,oD.startHandler=oT,oD.play(!1),oR.addChannel(oD),oD},oh(0,or,"duration",function(){var oo;return(oo=on._audioCache[this.url])?oo.duration:0}),on._initMusicAudio=function(){on._musicAudio||(on._musicAudio||(on._musicAudio=oe.createElement("audio")),oC.isConchApp||oe.document.addEventListener("mousedown",on._makeMusicOK))},on._makeMusicOK=function(){oe.document.removeEventListener("mousedown",on._makeMusicOK),on._musicAudio.src?on._musicAudio.play():(on._musicAudio.src="",on._musicAudio.load())},on._audioCache={},on._musicAudio=null,on}(),oko=function(oo){function or(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,or.__super.call(this)}oj(or,"laya.media.SoundChannel",oU);var oT=or.prototype;return oT.play=function(){},oT.stop=function(){},oT.pause=function(){},oT.resume=function(){},oT.__runComplete=function(oo){oo&&oo.run()},oh(0,oT,"volume",function(){return 1},function(oo){}),oh(0,oT,"position",function(){return 0}),oh(0,oT,"duration",function(){return 0}),or}(),oWo=function(oo){function or(){or.__super.call(this)}oj(or,"laya.media.Sound",oU);var oT=or.prototype;return oT.load=function(oo){},oT.play=function(oo,or,oT){return void 0===oo&&(oo=0),void 0===or&&(or=0),null},oT.dispose=function(){},oh(0,oT,"duration",function(){return 0}),or}(),oDo=function(oo){function oW(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,oW.__super.call(this)}oj(oW,"laya.media.webaudio.WebAudioSound",oU);var or=oW.prototype;return or.load=function(oo){this.url=oo,this.audioBuffer=oW._dataCache[oo],this.audioBuffer?this._loaded(this.audioBuffer):(oW.e.on("loaded:"+oo,this,this._loaded),oW.e.on("err:"+oo,this,this._err),oW.__loadingSound[oo]||(oW.__loadingSound[oo]=!0,ob.loader.load(oo,o$.create(this,this.onloaded),null,oVo.BUFFER,4,!1,null,!0)))},or.onloaded=function(oo){oo||this._err(),this._disposed?this._removeLoadEvents():(this.data=oo,oW.buffs.push({buffer:this.data,url:this.url}),oW.decode())},or._err=function(){if(this._removeLoadEvents(),oW.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var oo,or,oT,ok=0;for(oo=(or=this.__toPlays).length,ok=0;ok<oo;ok++)(oT=or[ok])[3]&&!oT[3].isStopped&&oT[3].event("error");this.__toPlays.length=0}},or._loaded=function(oo){this._removeLoadEvents(),this._disposed||(this.audioBuffer=oo,this.loaded=!0,this.event("complete"))},or._removeLoadEvents=function(){oW.e.off("loaded:"+this.url,this,this._loaded),oW.e.off("err:"+this.url,this,this._err)},or.__playAfterLoaded=function(){if(this.__toPlays){var oo,or,oT,ok=0;for(oo=(or=this.__toPlays).length,ok=0;ok<oo;ok++)(oT=or[ok])[3]&&!oT[3].isStopped&&this.play(oT[0],oT[1],oT[2],oT[3]);this.__toPlays.length=0}},or.play=function(oo,or,oT,ok){return void 0===oo&&(oo=0),void 0===or&&(or=0),ok=ok||new ovo,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([oo,or,oT,ok]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),ok.url=this.url,ok.loops=or,ok.audioBuffer=this.audioBuffer,ok.startTime=oo,ok.startHandler=oT,ok.play(!1),oR.addChannel(ok),ok},or.dispose=function(){this._disposed=!0,delete oW._dataCache[this.url],delete oW.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},oh(0,or,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),oW.decode=function(){if(!(oW.buffs.length<=0||oW.isDecoding))if(oW.isDecoding=!0,(oW.tInfo=oW.buffs.shift())&&oW.tInfo.buffer&&oW.tInfo.buffer.byteLength)try{oW.ctx.decodeAudioData(oW.tInfo.buffer,oW._done,oW._fail)}catch(oo){console.error("decodeAudioData error  byteLength:"+oW.tInfo.buffer.byteLength+"  url:"+oW.tInfo.url)}else oW._fail()},oW._done=function(oo){oW.e.event("loaded:"+oW.tInfo.url,oo),oW._dataCache[oW.tInfo.url]=oo,oW.isDecoding=!1,oW.decode()},oW._fail=function(){oW.e.event("err:"+oW.tInfo.url,null),oW.isDecoding=!1,oW.decode()},oW._playEmptySound=function(){if(null!=oW.ctx){if(oW._emptySource&&(oW._emptySource.stop(),oW._emptySource.disconnect(0),!ovo._tryCleanFailed))try{oW._emptySource.buffer=null}catch(oo){ovo._tryCleanFailed=!0}var oo=oW.ctx.createBufferSource();oo.buffer=oW._miniBuffer,oo.connect(oW.ctx.destination),oo.start(0,0,0),oW._emptySource=oo}},oW._unlock=function(){oW._unlocked||(oW._playEmptySound(),"running"==oW.ctx.state?(oe.document.removeEventListener("mousedown",oW._unlock,!0),oe.document.removeEventListener("touchend",oW._unlock,!0),oe.document.removeEventListener("touchstart",oW._unlock,!0),oW._unlocked=!0):"suspended"==oW.ctx.state&&oR._recoverWebAudio())},oW.initWebAudio=function(){"running"!=oW.ctx.state&&(oW._unlock(),oe.document.addEventListener("mousedown",oW._unlock,!0),oe.document.addEventListener("touchend",oW._unlock,!0),oe.document.addEventListener("touchstart",oW._unlock,!0))},oW._emptySource=null,oW._dataCache={},oW.buffs=[],oW.isDecoding=!1,oW._unlocked=!1,oW.tInfo=null,oW.__loadingSound={},oL(oW,["window",function(){return this.window=oe.window},"webAudioEnabled",function(){return this.webAudioEnabled=oW.window.AudioContext||oW.window.webkitAudioContext||oW.window.mozAudioContext},"ctx",function(){return this.ctx=oW.webAudioEnabled?new(oW.window.AudioContext||oW.window.webkitAudioContext||oW.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=oW.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new oU}]),oW}(),ono=function(oo){function or(){this._responseType=null,this._data=null,or.__super.call(this),this._http=new oe.window.XMLHttpRequest}oj(or,"laya.net.HttpRequest",oU);var oT=or.prototype;return oT.send=function(oo,or,oT,ok,oW){void 0===oT&&(oT="get"),void 0===ok&&(ok="text"),this._responseType=ok,this._data=null;var oD=this,on=this._http;if(on.open(oT,oo,!0),oW)for(var oV=0;oV<oW.length;oV++)on.setRequestHeader(oW[oV++],oW[oV]);else oC.isConchApp||(or&&"string"!=typeof or?on.setRequestHeader("Content-Type","application/json"):on.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));on.responseType="arraybuffer"!==ok?"text":"arraybuffer",on.onerror=function(oo){oD._onError(oo)},on.onabort=function(oo){oD._onAbort(oo)},on.onprogress=function(oo){oD._onProgress(oo)},on.onload=function(oo){oD._onLoad(oo)},on.send(or)},oT._onProgress=function(oo){oo&&oo.lengthComputable&&this.event("progress",oo.loaded/oo.total)},oT._onAbort=function(oo){this.error("Request was aborted by user")},oT._onError=function(oo){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},oT._onLoad=function(oo){var or=this._http,oT=void 0!==or.status?or.status:200;200===oT||204===oT||0===oT?this.complete():this.error("["+or.status+"]"+or.statusText+":"+or.responseURL)},oT.error=function(oo){this.clear(),this.event("error",oo)},oT.complete=function(){this.clear();var or=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=og.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(oo){or=!1,this.error(oo.message)}or&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},oT.clear=function(){var oo=this._http;oo.onerror=oo.onabort=oo.onprogress=oo.onload=null},oh(0,oT,"url",function(){return this._http.responseURL}),oh(0,oT,"http",function(){return this._http}),oh(0,oT,"data",function(){return this._data}),or}(),oVo=function(oo){function ot(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,ot.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}oj(ot,"laya.net.Loader",oU);var or=ot.prototype;return or.load=function(oo,or,oT,ok,oW){if(oo&&""!=oo||console.error("Loader 加载的url不合法 "+oo),void 0===oT&&(oT=!0),void 0===oW&&(oW=!1),0===(this._url=oo).indexOf("data:image")?this._type=or="image":this._type=or||(or=this.getTypeFromUrl(oo)),this._cache=oT,this._data=null,!oW&&ot.loadedMap[oo])return this._data=ot.loadedMap[oo],this.event("progress",1),void this.event("complete",this._data);if(ok&&ot.setGroup(oo,ok),null!=ot.parserMap[or])return this._customParse=!0,void(ot.parserMap[or]instanceof laya.utils.Handler?ot.parserMap[or].runWith(this):ot.parserMap[or].call(null,this));if("image"===or||"htmlimage"===or||"nativeimage"===or)return this._loadImage(oo);if("ttf"===or)return this._loadTTF(oo);switch(or){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:or}ot.preLoadedMap[oo]?this.onLoaded(ot.preLoadedMap[oo]):on.resMgrLoad(oo,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},or.getTypeFromUrl=function(oo){var or=og.getFileExtension(oo);return or?ot.typeMap[or]:(console.warn("Not recognize the resources suffix",oo),"text")},or._loadTTF=function(oo){oo=om.formatURL(oo);var or=new oz;or.complete=o$.create(this,this.onLoaded),or.load(oo)},or._loadImage=function(oo){on.imgMgrLoad(oo,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},or._loadImageComplete=function(oo,or,oT){if(null!=oT)if(oT instanceof ArrayBuffer){var ok=new DataView(oT),oW=new laya.webgl.resource.WebGLImage(new Uint8Array(oT,8),oo,0,!1,ok.getUint32(0),ok.getUint32(4));this.onLoaded(oW)}else if(oT instanceof oho)ot.imgMgrSet[oo]=or,on.imgMgrLock(oo,ot.imgMgrSet[oo]),this._url=oo,this.complete(oT);else{var oD=-1!=oo.indexOf(".png",oo.length-4)?6408:6407;oW=new laya.webgl.resource.WebGLImage(oT,oo,oD,!1,oT.width,oT.height);this.onLoaded(oW)}else this.event("error","Load image failed")},or._loadSound=function(oo){var or=new oR._soundClass,oT=this;function ok(){or.offAll()}or.on("complete",this,function(){ok(),oT.onLoaded(or)}),or.on("error",this,function(){ok(),or.dispose(),oT.event("error","Load sound failed")}),or.load(oo)},or.onProgress=function(oo){"atlas"===this._type?this.event("progress",.3*oo):this.event("progress",oo)},or.onError=function(oo){this.event("error",oo)},or._loadedComplete=function(oo,or,oT){if(null!=oT)switch(this._type){case"atlas":case"plf":case"json":var ok=new oJ(oT);this.onLoaded(JSON.parse(ok.readUTFBytes()));break;case"font":ok=new oJ(oT);this.onLoaded(og.parseXMLFromString(ok.readUTFBytes()));break;default:this.onLoaded(oT)}else this.event("error",oo)},or.onLoaded=function(oo){var or=this._type;if("plf"==or)this.parsePLFData(oo),this.complete(oo);else if("image"===or){var oT=new oho(oo);oT.url=this._url,this.complete(oT)}else if("sound"===or||"htmlimage"===or||"nativeimage"===or)this.complete(oo);else if("atlas"===or){if(!oo.src&&!oo._setContext){if(!this._data){if((this._data=oo).meta&&oo.meta.image)for(var ok=oo.meta.image.split(","),oW=0<=this._url.indexOf("/")?"/":"\\",oD=this._url.lastIndexOf(oW),on=0<=oD?this._url.substr(0,oD+1):"",oV=0,oL=ok.length;oV<oL;oV++)ok[oV]=on+ok[oV];else ok=[this._url.replace(".json",".png")];ok.reverse(),oo.toLoads=ok,oo.pics=[]}return this.event("progress",.3+1/ok.length*.6),this._loadImage(ok.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(oo),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var oU=this._data.frames,oh=this._url.split("?")[0],op=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:oh.substring(0,oh.lastIndexOf("."))+"/",oi=this._data.pics,ov=om.formatURL(this._url),ox=ot.atlasMap[ov]||(ot.atlasMap[ov]=[]);ox.dir=op;var oj=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var o_ in oj=parseFloat(this._data.meta.scale),oU){var oK,o$=oU[o_],oy=oi[o$.frame.idx?o$.frame.idx:0],ol=om.formatURL(op+o_);oy.scaleRate=oj,oK=oho.create(oy,o$.frame.x,o$.frame.y,o$.frame.w,o$.frame.h,o$.spriteSourceSize.x,o$.spriteSourceSize.y,o$.sourceSize.w,o$.sourceSize.h),ot.cacheRes(ol,oK),ot.keepCache(this._url,op+o_),oK.url=ol,ox.push(ol)}else for(o_ in oU)oy=oi[(o$=oU[o_]).frame.idx?o$.frame.idx:0],ol=om.formatURL(op+o_),ot.cacheRes(ol,oho.create(oy,o$.frame.x,o$.frame.y,o$.frame.w,o$.frame.h,o$.spriteSourceSize.x,o$.spriteSourceSize.y,o$.sourceSize.w,o$.sourceSize.h)),ot.loadedMap[ol].url=ol,ot.keepCache(this._url,op+o_),ox.push(ol);delete this._data.pics,this.complete(this._data)}else if("font"==or){if(!oo.src)return this._data=oo,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var oS=new oH;oS.parseFont(this._data,oo);var oq=this._url.split(".fnt")[0].split("/"),ob=oq[oq.length-1];o_o.registerBitmapFont(ob,oS),this._data=oS,this.complete(this._data)}else if("pkm"==or){var oF=oqo.create(oo,this._url),oP=new oho(oF);oP.url=this._url,this.complete(oP)}else this.complete(oo)},or.parsePLFData=function(oo){var or,oT,ok;for(or in oo)switch(ok=oo[or],or){case"json":case"text":for(oT in ok)ot.preLoadedMap[om.formatURL(oT)]=ok[oT];break;default:for(oT in ok)ot.preLoadedMap[om.formatURL(oT)]=ok[oT]}},or.complete=function(oo){this._data=oo,this._customParse?this.event("loaded",oo instanceof Array?[oo]:oo):(ot._loaders.push(this),ot._isWorking||ot.checkNext())},or.endLoad=function(oo){oo&&(this._data=oo),this._cache&&ot.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},oh(0,or,"url",function(){return this._url}),oh(0,or,"data",function(){return this._data}),oh(0,or,"cache",function(){return this._cache}),oh(0,or,"type",function(){return this._type}),ot.checkNext=function(){ot._isWorking=!0;for(var oo=oe.now();ot._startIndex<ot._loaders.length;)if(oe.now(),ot._loaders[ot._startIndex].endLoad(),ot._startIndex++,oe.now()-oo>ot.maxTimeOut)return console.warn("loader callback cost a long time:"+(oe.now()-oo)+" url="+ot._loaders[ot._startIndex-1].url),void ob.timer.frameOnce(1,null,ot.checkNext);ot._loaders.length=0,ot._startIndex=0,ot._isWorking=!1},ot.clearRes=function(oo,or){if(null!=oo){void 0===or&&(or=!1),oo=om.formatURL(oo);var oT=ot.getAtlas(oo);if(oT){for(var ok=0,oW=oT.length;ok<oW;ok++){var oD=oT[ok],on=ot.getRes(oD);delete ot.loadedMap[oD],ot.clearCache(oo.substring(om.basePath.length),oD.substring(om.basePath.length)),on&&on.destroy(or)}oT.length=0,delete ot.atlasMap[oo],delete ot.loadedMap[oo]}else{var oV=ot.loadedMap[oo];oV&&(delete ot.loadedMap[oo],oV instanceof laya.resource.Texture&&oV.bitmap&&oV.destroy(or))}}},ot.clearTextureRes=function(oo){oo=om.formatURL(oo);var or=laya.net.Loader.getAtlas(oo),oT=or&&0<or.length?laya.net.Loader.getRes(or[0]):laya.net.Loader.getRes(oo);oT&&oT.bitmap&&(oC.isConchApp&&!oC.isConchWebGL?oT.bitmap.source.releaseTexture&&oT.bitmap.source.releaseTexture():null==oT.bitmap._atlaser&&oT.bitmap.releaseResource(!0))},ot.getRes=function(oo){return ot.loadedMap[om.formatURL(oo)]},ot.getAtlas=function(oo){return ot.atlasMap[om.formatURL(oo)]},ot.cacheRes=function(oo,or){oo=om.formatURL(oo),null!=ot.loadedMap[oo]?console.warn("Resources already exist,is repeated loading:",oo):ot.loadedMap[oo]=or},ot.setGroup=function(oo,or){ot.groupMap[or]||(ot.groupMap[or]=[]),ot.groupMap[or].push(oo)},ot.clearResByGroup=function(oo){if(ot.groupMap[oo]){var or=ot.groupMap[oo],oT=0,ok=or.length;for(oT=0;oT<ok;oT++)ot.clearRes(or[oT]);or.length=0}},ot.keepCache=function(oo,or){if(oo&&or){var oT=ot.cacheSet[or];oT?-1==oT.indexOf(oo)&&oT.push(oo):ot.cacheSet[or]=[oo]}},ot.clearCache=function(oo,or){if(oo&&or){var oT=ot.cacheSet[or];if(oT){var ok=oT.indexOf(oo);if(-1!==ok){var oW=oT.length-1;0==oW?(delete ot.cacheSet[or],0<ot.imgMgrSet[or]?on.imgMgrFree(or,ot.imgMgrSet[or]):ot.clearRes(or,!0)):(oT[ok]=oT[oW],oT.length=oW)}}}},ot.saveObject=function(oo,or,oT){if(or&&oo){var ok=ot.objectSet[oo];ok?(console.warn("Loader.saveObject: "+oo),ok[0]=or,ok[1]=oT):ot.objectSet[oo]=[or,oT,[]]}},ot.findObject=function(oo){if(oo){var or=ot.objectSet[oo];if(or)return or[0]}return null},ot.keepObject=function(oo,or){if(oo&&or){var oT=ot.objectSet[or];oT&&-1===oT[2].indexOf(oo)&&oT[2].push(oo)}},ot.clearObject=function(oo,or){if(oo&&or){var oT=ot.objectSet[or];if(oT){var ok=oT[2],oW=ok.indexOf(oo);if(-1!==oW){var oD=ok.length-1;0==oD?(delete ot.objectSet[or],oT[1]&&oT[1].call(null,oT[0])):(ok[oW]=ok[oD],ok.length=oD)}}}},ot.TEXT="text",ot.JSON="json",ot.XML="xml",ot.BUFFER="arraybuffer",ot.IMAGE="image",ot.SOUND="sound",ot.ATLAS="atlas",ot.FONT="font",ot.TTF="ttf",ot.PLF="plf",ot.PKM="pkm",ot.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},ot.parserMap={},ot.groupMap={},ot.maxTimeOut=100,ot.loadedMap={},ot.preLoadedMap={},ot.atlasMap={},ot._loaders=[],ot._isWorking=!1,ot._startIndex=0,ot.imgCache={},ot.cacheSet={},ot.objectSet={},ot.imgMgrSet={},ot}(),oLo=function(oo){var oi;function ov(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},ov.__super.call(this);for(var oo=0;oo<this._maxPriority;oo++)this._resInfos[oo]=[]}oj(ov,"laya.net.LoaderManager",oU);var or=ov.prototype;return or.create=function(oo,oT,or,ok,oW,oD,on,oV){if(null==oD&&(oD=2),null==on&&(on=!0),oo instanceof Array){var oL=oo,oU=oL.length,oh=0;if(or)var op=o$.create(or.caller,or.method,or.args,!1);for(var oi=0;oi<oU;oi++){var ov=oL[oi];"string"==typeof ov&&(ov=oL[oi]={url:ov}),ov.progress=0}for(oi=0;oi<oU;oi++){ov=oL[oi];var ox=or?o$.create(null,oK,[ov],!1):null,oj=or||oT?o$.create(null,o_,[ov]):null;this._create(ov.url,oj,ox,ov.clas||ok,ov.params||oW,null!=ov.priority&&0<=ov.priority?ov.priority:oD,on,ov.group||oV)}function o_(oo,or){oh++,oo.progress=1,oh===oU&&oT&&oT.run()}function oK(oo,or){oo.progress=or;for(var oT=0,ok=0;ok<oU;ok++){oT+=oL[ok].progress}var oW=oT/oU;op.runWith(oW)}return!0}return this._create(oo,oT,or,ok,oW,oD,on,oV)},or._create=function(or,oT,oo,ok,oW,oD,on,oV){or&&""!=or||console.error("加载的url不合法 "+or),null==oD&&(oD=2),null==on&&(on=!0);var oL=om.formatURL(or),oU=this.getRes(oL);if(oU)!oU.hasOwnProperty("loaded")||oU.loaded?(oo&&oo.runWith(1),oT&&oT.run()):oT&&ob.loader._createListener(or,oT.caller,oT.method,oT.args,!0,!1);else{var oh=og.getFileExtension(or),op=ov.createMap[oh];if(!op)throw new Error("LoaderManager:unknown file("+or+") extension with: "+oh+".");ok||(ok=op[0]);var oi=op[1];if("atlas"==oh)this.load(or,oT,oo,oi,oD,on);else{ok===oho&&(oi="htmlimage"),(oU=ok?new ok:null).hasOwnProperty("_loaded")&&(oU._loaded=!1),oU._setUrl(or),oV&&oU._setGroup(oV),this._createLoad(oU,or,o$.create(null,function(oo){oU&&!oU.destroyed&&oo&&oU.onAsynLoaded.call(oU,or,oo,oW),oT&&oT.run();ob.loader.event(or)}),oo,oi,oD,!1,oV,!0),on&&this.cacheRes(oL,oU)}}return oU},or.load=function(oo,or,oT,ok,oW,oD,on,oV){oo&&""!=oo||console.error("加载的url不合法 "+oo);var oL=this;if(null==oW&&(oW=2),null==oD&&(oD=!0),void 0===oV&&(oV=!1),oo instanceof Array)return this._loadAssets(oo,or,oT,ok,oW,oD,on);var oU=oVo.getRes(oo);if(null!=oU)ob.timer.frameOnce(1,null,function(){oT&&oT.runWith(1),or&&or.runWith(oU),oL._loaderCount||oL.event("complete")});else{var oh=ov._resMap[oo];oh?(or&&oh._createListener("complete",or.caller,or.method,or.args,!1,!1),oT&&oh._createListener("progress",oT.caller,oT.method,oT.args,!1,!1)):((oh=this._infoPool.length?this._infoPool.pop():new oi).url=oo,oh.type=ok,oh.cache=oD,oh.group=on,oh.ignoreCache=oV,oh.priority=oW,or&&oh.on("complete",or.caller,or.method,or.args),oT&&oh.on("progress",oT.caller,oT.method,oT.args),ov._resMap[oo]=oh,oW=oW<this._maxPriority?0<=oW?oW:0:this._maxPriority-1,this._resInfos[oW].push(oh),this._next())}return this},or._createLoad=function(oo,or,oT,ok,oW,oD,on,oV,oL){var oU=this;if(null==oD&&(oD=2),null==on&&(on=!0),void 0===oL&&(oL=!1),or instanceof Array)return this._loadAssets(or,oT,ok,oW,oD,on,oV);var oh=oVo.getRes(or);if(null!=oh)ob.timer.frameOnce(1,null,function(){ok&&ok.runWith(1),oT&&oT.runWith(oh),oU._loaderCount||oU.event("complete")});else{var op=ov._resMap[or];op?(oT&&op._createListener("complete",oT.caller,oT.method,oT.args,!1,!1),ok&&op._createListener("progress",ok.caller,ok.method,ok.args,!1,!1)):((op=this._infoPool.length?this._infoPool.pop():new oi).url=or,op.clas=oo,op.type=oW,op.cache=on,op.group=oV,op.ignoreCache=oL,op.priority=oD,oT&&op.on("complete",oT.caller,oT.method,oT.args),ok&&op.on("progress",ok.caller,ok.method,ok.args),ov._resMap[or]=op,oD=oD<this._maxPriority?0<=oD?oD:0:this._maxPriority-1,this._resInfos[oD].push(op),this._next())}return this},or._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var oo=0;oo<this._maxPriority;oo++)for(var or=this._resInfos[oo];0<or.length;){var oT=or.shift();if(oT)return this._doLoad(oT)}this._loaderCount||this.event("complete")}},or._doLoad=function(or){this._loaderCount++;var oT=this._loaders.length?this._loaders.pop():new oVo;oT.on("complete",null,oW),oT.on("progress",null,function(oo){or.event("progress",oo)}),oT.on("error",null,function(oo){oW(null)});var ok=this;function oW(oo){oT.offAll(),oT._data=null,oT._customParse=!1,ok._loaders.push(oT),ok._endLoad(or,oo instanceof Array?[oo]:oo),ok._loaderCount--,ok._next()}oT._class=or.clas,1<=or.priority?(oT.priority=or.priority,oT.realTime=!1):(oT.priority=0,oT.realTime=!0),oT.load(or.url,or.type,or.cache,or.group,or.ignoreCache)},or._endLoad=function(oo,or){var oT=oo.url;if(null==or){var ok=this._failRes[oT]||0;if(ok<this.retryNum)return console.warn("[warn]Retry to load:",oT),this._failRes[oT]=ok+1,void ob.timer.once(this.retryDelay,this,this._addReTry,[oo],!1);console.warn("[error]Failed to load:",oT),this.event("error",oT)}this._failRes[oT]&&(this._failRes[oT]=0),delete ov._resMap[oT],oo.event("complete",or),oo.offAll(),this._infoPool.push(oo)},or._addReTry=function(oo){this._resInfos[this._maxPriority-1].push(oo),this._next()},or.clearRes=function(oo,or){void 0===or&&(or=!1),oVo.clearRes(oo,or)},or.getRes=function(oo){return oVo.getRes(oo)},or.cacheRes=function(oo,or){oVo.cacheRes(oo,or)},or.clearTextureRes=function(oo){oVo.clearTextureRes(oo)},or.setGroup=function(oo,or){oVo.setGroup(oo,or)},or.clearResByGroup=function(oo){oVo.clearResByGroup(oo)},or.clearUnLoaded=function(){for(var oo=0;oo<this._maxPriority;oo++){for(var or=this._resInfos[oo],oT=or.length-1;-1<oT;oT--){var ok=or[oT];ok&&(ok.offAll(),this._infoPool.push(ok))}or.length=0}this._loaderCount=0,ov._resMap={}},or.cancelLoadByUrls=function(oo){if(oo)for(var or=0,oT=oo.length;or<oT;or++)this.cancelLoadByUrl(oo[or])},or.cancelLoadByUrl=function(oo){for(var or=0;or<this._maxPriority;or++)for(var oT=this._resInfos[or],ok=oT.length-1;-1<ok;ok--){var oW=oT[ok];oW&&oW.url===oo&&(oT[ok]=null,oW.offAll(),this._infoPool.push(oW))}ov._resMap[oo]&&delete ov._resMap[oo]},or._loadAssets=function(oo,oT,on,or,ok,oW,oD){null==ok&&(ok=2),null==oW&&(oW=!0);for(var oV=oo.length,oL=0,oU=0,oh=[],op=!0,oi=0;oi<oV;oi++){var ov=oo[oi];if(!ov)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+oo);"string"==typeof ov&&(ov={url:ov,type:or,size:1,priority:ok}),ov.size||(ov.size=1),ov.progress=0,oU+=ov.size,oh.push(ov);var ox=on?o$.create(null,oK,[ov],!1):null,oj=oT||on?o$.create(null,o_,[ov]):null;this.load(ov.url,oj,ox,ov.type,null!=ov.priority&&0<=ov.priority?ov.priority:2,oW,ov.group||oD)}function o_(oo,or){oL++,oo.progress=1,or||(op=!1),oL===oV&&oT&&oT.runWith(op)}function oK(oo,or){if(null!=on){oo.progress=or;for(var oT=0,ok=0;ok<oh.length;ok++){var oW=oh[ok];oT+=oW.size*oW.progress}var oD=oT/oU;on.runWith(oD)}}return this},ov.cacheRes=function(oo,or){oVo.cacheRes(oo,or)},ov._resMap={},oL(ov,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),ov.__init$=function(){oi=function(oo){function or(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,or.__super.call(this)}return oj(or,"",oU),or}()},ov}(),oUo=(function(oo){function oW(oo){oW.__super.call(this),oo||(oo=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var or=0,oT=0,ok=0;ok<20;ok++)ok%5!=4?this._mat[or++]=oo[ok]:this._alpha[oT++]=oo[ok];this._action=ou.createFilterAction(32),this._action.data=this}oj(oW,"laya.filters.ColorFilter",oK);var or=oW.prototype;ob.imps(or,{"laya.filters.IFilter":!0}),or.callNative=function(oo){oo._$P.cf=this;oo.conchModel&&oo.conchModel.setFilterMatrix&&oo.conchModel.setFilterMatrix(this._mat,this._alpha)},oh(0,or,"type",function(){return 32}),oh(0,or,"action",function(){return this._action})}(),function(oo){function ok(oo,or,oT){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===or&&(or=0),ok.__super.call(this),this._byteClass=oT||oJ,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,oo&&0<or&&or<65535&&this.connect(oo,or)}oj(ok,"laya.net.Socket",oU);var or=ok.prototype;or.connect=function(oo,or){var oT="ws://"+oo+":"+or;oT="https:"==oe.window.location.protocol?"wss://"+oo+":"+or:"ws://"+oo+":"+or,this.connectByUrl(oT)},or.connectByUrl=function(oo){var or=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new oe.window.WebSocket(oo,this.protocols):this._socket=new oe.window.WebSocket(oo),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(oo){or._onOpen(oo)},this._socket.onmessage=function(oo){or._onMessage(oo)},this._socket.onclose=function(oo){or._onClose(oo)},this._socket.onerror=function(oo){or._onError(oo)}},or.cleanSocket=function(){try{this._socket.close()}catch(oo){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},or.close=function(){if(null!=this._socket)try{this._socket.close()}catch(oo){}},or._onOpen=function(oo){this._connected=!0,this.event("open",oo)},or._onMessage=function(oo){if(oo&&oo.data){var or=oo.data;if(this.disableInput&&or)this.event("message",or);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var oT=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,or&&("string"==typeof or?this._input.writeUTFBytes(or):this._input.writeArrayBuffer(or),this._addInputPosition=this._input.pos,this._input.pos=oT),this.event("message",or)}}},or._onClose=function(oo){this._connected=!1,this.event("close",oo)},or._onError=function(oo){this.event("error",oo)},or.send=function(oo){this._socket.send(oo)},or.flush=function(){if(this._output&&0<this._output.length){var or;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(oo){or=oo}this._output.endian=this.endian,this._output.clear(),or&&this.event("error",or)}},oh(0,or,"input",function(){return this._input}),oh(0,or,"output",function(){return this._output}),oh(0,or,"connected",function(){return this._connected}),oh(0,or,"endian",function(){return this._endian},function(oo){this._endian=oo,null!=this._input&&(this._input.endian=oo),null!=this._output&&(this._output.endian=oo)}),ok.LITTLE_ENDIAN="littleEndian",ok.BIG_ENDIAN="bigEndian"}(),function(oo){function oV(){oV.__super.call(this),this._$1__id=++oV._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(oV._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,oc.currentResourceManager&&oc.currentResourceManager.addResource(this)}oj(oV,"laya.resource.Resource",oU);var or=oV.prototype;return ob.imps(or,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),or._setUrl=function(oo){var or;this._url!==oo&&(this._url&&((or=oV._urlResourcesMap[this._url]).splice(or.indexOf(this),1),0===or.length&&delete oV._urlResourcesMap[this._url]),oo&&((or=oV._urlResourcesMap[oo])||(oV._urlResourcesMap[oo]=or=[]),or.push(this)),this._url=oo)},or._getGroup=function(){return this._group},or._setGroup=function(oo){var or;this._group!==oo&&(this._group&&((or=oV._groupResourcesMap[this._group]).splice(or.indexOf(this),1),0===or.length&&delete oV._groupResourcesMap[this._group]),oo&&((or=oV._groupResourcesMap[oo])||(oV._groupResourcesMap[oo]=or=[]),or.push(this)),this._group=oo)},or._addReference=function(){this._referenceCount++},or._removeReference=function(){this._referenceCount--},or._clearReference=function(){this._referenceCount=0},or._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},or.recreateResource=function(){this.completeCreate()},or.disposeResource=function(){},or.activeResource=function(oo){void 0===oo&&(oo=!1),this._lastUseFrameCount=ow.loopCount,!this._destroyed&&this.__loaded&&(this._released||oo)&&this.recreateResource()},or.releaseResource=function(oo){return void 0===oo&&(oo=!0),!(!oo&&this.lock)&&(!(this._released&&!oo)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},or.onAsynLoaded=function(oo,or,oT){throw new Error("Resource: must override this function!")},or.destroy=function(){var oo;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete oV._idResourcesMap[this.id],this._url&&((oo=oV._urlResourcesMap[this._url])&&(oo.splice(oo.indexOf(this),1),0===oo.length&&delete oV._urlResourcesMap[this.url]),oVo.clearRes(this._url),this.__loaded||ou.cancelLoadByUrl(this._url)),this._group&&((oo=oV._groupResourcesMap[this._group]).splice(oo.indexOf(this),1),0===oo.length&&delete oV._groupResourcesMap[this.url]))},or.completeCreate=function(){this._released=!1,this.event("recovered",this)},or.dispose=function(){this.destroy()},oh(0,or,"memorySize",function(){return this._memorySize},function(oo){var or=oo-this._memorySize;this._memorySize=oo,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,or),this.resourceManager&&this.resourceManager.addSize(or)}),oh(0,or,"_loaded",null,function(oo){this.__loaded=oo}),oh(0,or,"loaded",function(){return this.__loaded}),oh(0,or,"id",function(){return this._$1__id}),oh(0,or,"destroyed",function(){return this._destroyed}),oh(0,or,"group",function(){return this._getGroup()},function(oo){this._setGroup(oo)}),oh(0,or,"resourceManager",function(){return this._resourceManager}),oh(0,or,"url",function(){return this._url}),oh(0,or,"released",function(){return this._released}),oh(0,or,"referenceCount",function(){return this._referenceCount}),oV.getResourceByID=function(oo){return oV._idResourcesMap[oo]},oV.getResourceByURL=function(oo,or){return void 0===or&&(or=0),null==oV._urlResourcesMap[oo]?null:oV._urlResourcesMap[oo][or]},oV.getResourceCountByURL=function(oo){return oV._urlResourcesMap[oo].length},oV.destroyUnusedResources=function(oo){var or;if(oo){var oT=oV._groupResourcesMap[oo];if(oT)for(var ok=oT.slice(),oW=0,oD=ok.length;oW<oD;oW++)(or=ok[oW]).lock||0!==or._referenceCount||or.destroy()}else for(var on in oV._idResourcesMap)(or=oV._idResourcesMap[on]).lock||0!==or._referenceCount||or.destroy()},oV._uniqueIDCounter=0,oV._idResourcesMap={},oV._urlResourcesMap={},oV._groupResourcesMap={},oV}()),oho=function(oo){function ot(oo,or){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,ot.__super.call(this),oo&&null!=oo._addReference&&oo._addReference(),this.setTo(oo,or)}oj(ot,"laya.resource.Texture",oU);var or=ot.prototype;return or._setUrl=function(oo){this.url=oo},or.setTo=function(oo,or){if(oo instanceof on.HTMLElement){var oT=oyo.create("2D",oo);this.bitmap=oT}else this.bitmap=oo;if(this.uv=or||ot.DEF_UV,oo){this._w=oo.width,this._h=oo.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var ok=this;if(this._loaded)ou.addToAtlas&&ou.addToAtlas(ok);else{var oW=oo;oW instanceof laya.resource.HTMLImage&&oW.image&&oW.image.addEventListener("load",function(oo){ou.addToAtlas&&ou.addToAtlas(ok)},!1)}}},or.active=function(){this.bitmap&&this.bitmap.activeResource()},or.destroy=function(oo){if(void 0===oo&&(oo=!1),this.alphaTexture&&(this.alphaTexture.destroy(oo),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var or=this.bitmap;oo?(oC.isConchApp&&or.source&&or.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,or.dispose(),or._clearReference()):(or._removeReference(),0==or.referenceCount&&(oC.isConchApp&&or.source&&or.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,or.dispose())),this.url&&this===ob.loader.getRes(this.url)&&ob.loader.clearRes(this.url,oo),this._loaded=!1}},or.load=function(oo){var or=this;this._loaded=!1,oo=om.customFormat(oo);var oT=this.bitmap||(this.bitmap=oqo.create(oo));oT.uri=oo,oT&&oT._addReference();var ok=this;oT.onload=function(){oT.onload=null,ok._loaded=!0,or.sourceWidth=or._w=oT.width,or.sourceHeight=or._h=oT.height,ok.event("loaded",this),ou.addToAtlas&&ou.addToAtlas(ok)}},or.addTextureToAtlas=function(oo){ou.addTextureToAtlas(this)},or.getPixels=function(oo,or,oT,ok){if(oC.isConchApp){var oW=this.bitmap;if(oW.source&&oW.source.getImageData){var oD=oW.source.getImageData(oo,or,oT,ok),on=new Uint8Array(oD);return Array.from(on)}return null}return oC.isWebGL?ou.getTexturePixels(this,oo,or,oT,ok):(oe.canvas.size(oT,ok),oe.canvas.clear(),oe.context.drawTexture(this,-oo,-or,this.width,this.height,0,0),oe.context.getImageData(0,0,oT,ok).data)},or.onAsynLoaded=function(oo,or){if(or){if("function"!=typeof or._addReference)throw new Error("bitmap._addReference is not a function. "+or.className+" "+typeof or._addReference+" "+or.constructor);or._addReference()}this.setTo(or,this.uv),this._loaded&&this.event("loaded",this)},oh(0,or,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),oh(0,or,"loaded",function(){return this._loaded}),oh(0,or,"released",function(){return!this.bitmap||this.bitmap.released}),oh(0,or,"width",function(){return this._w?this._w:this.uv&&this.uv!==ot.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(oo){this._w=oo,this.sourceWidth||(this.sourceWidth=oo)}),oh(0,or,"repeat",function(){return!oC.isWebGL||!this.bitmap||this.bitmap.repeat},function(oo){oo&&oC.isWebGL&&this.bitmap&&(this.bitmap.repeat=oo)&&(this.bitmap.enableMerageInAtlas=!1)}),oh(0,or,"height",function(){return this._h?this._h:this.uv&&this.uv!==ot.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(oo){this._h=oo,this.sourceHeight||(this.sourceHeight=oo)}),oh(0,or,"isLinearSampling",function(){return!oC.isWebGL||9728!=this.bitmap.minFifter},function(oo){!oo&&oC.isWebGL&&(oo||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),ot.moveUV=function(oo,or,oT){for(var ok=0;ok<8;ok+=2)oT[ok]+=oo,oT[ok+1]+=or;return oT},ot.create=function(oo,or,oT,ok,oW,oD,on,oV,oL){void 0===oD&&(oD=0),void 0===on&&(on=0),void 0===oV&&(oV=0),void 0===oL&&(oL=0);var oU=oo instanceof laya.resource.Texture,oh=oU?oo.uv:ot.DEF_UV,op=oU?oo.bitmap:oo,oi=ou.isAtlas(op);if(oi){var ov=op._atlaser,ox=oo._atlasID;if(-1==ox)throw new Error("create texture error");op=ov._inAtlasTextureBitmapValue[ox],oh=ov._inAtlasTextureOriUVValue[ox]}var oj=new ot(op,null);op.width&&or+ok>op.width&&(ok=op.width-or),op.height&&oT+oW>op.height&&(oW=op.height-oT),oj.width=ok,oj.height=oW,oj.offsetX=oD,oj.offsetY=on,oj.sourceWidth=oV||ok,oj.sourceHeight=oL||oW;var o_=1/op.width,oK=1/op.height;or*=o_,oT*=oK,ok*=o_,oW*=oK;var o$=oj.uv[0],oy=oj.uv[1],ol=oj.uv[4],oS=oj.uv[5],oq=ol-o$,ob=oS-oy,oF=ot.moveUV(oh[0],oh[1],[or,oT,or+ok,oT,or+ok,oT+oW,or,oT+oW]);oj.uv=[o$+oF[0]*oq,oy+oF[1]*ob,ol-(1-oF[2])*oq,oy+oF[3]*ob,ol-(1-oF[4])*oq,oS-(1-oF[5])*ob,o$+oF[6]*oq,oS-(1-oF[7])*ob],oi&&oj.addTextureToAtlas();var oP=op.scaleRate;return oP&&1!=oP?(oj.sourceWidth/=oP,oj.sourceHeight/=oP,oj.width/=oP,oj.height/=oP,oj.scaleRate=oP,oj.offsetX/=oP,oj.offsetY/=oP):oj.scaleRate=1,oj},ot.createFromTexture=function(oo,or,oT,ok,oW){var oD=oo.scaleRate;1!=oD&&(or*=oD,oT*=oD,ok*=oD,oW*=oD);var on=oP.TEMP.setTo(or-oo.offsetX,oT-oo.offsetY,ok,oW),oV=on.intersection(ot._rect1.setTo(0,0,oo.width,oo.height),ot._rect2);if(!oV)return null;var oL=ot.create(oo,oV.x,oV.y,oV.width,oV.height,oV.x-on.x,oV.y-on.y,ok,oW);if(oL.bitmap&&oL.bitmap._removeReference)return oL.bitmap._removeReference(),oL;var oU="bitmap:"+(oL.bitmap?oL.bitmap.constructor?oL.bitmap.constructor.name:oL.bitmap.__className:"")+", url:"+(oo.url+" | "+(oL.bitmap?oL.bitmap.url:oo.url))+", x="+or+",y="+oT+",width="+ok+",height="+oW+", result="+(oV?oV.x+","+oV.y+","+oV.width+","+oV.height:"null")+", rect="+on.x+","+on.y+","+on.width+","+on.height;throw new Error("报错：bitmap._removeReference is not a function  "+oU)},ot.DEF_UV=[0,0,1,0,1,1,0,1],ot.INV_UV=[0,1,1,1,1,0,0,0],ot._rect1=new oP,ot._rect2=new oP,ot}(),oo=function(oo){var oV;function oD(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,oD.__super.call(this)}oj(oD,"laya.utils.TimeLine",oU);var or=oD.prototype;return or.to=function(oo,or,oT,ok,oW){return void 0===oW&&(oW=0),this._create(oo,or,oT,ok,oW,!0)},or.from=function(oo,or,oT,ok,oW){return void 0===oW&&(oW=0),this._create(oo,or,oT,ok,oW,!1)},or._create=function(oo,or,oT,ok,oW,oD){var on=oG.getItemByClass("tweenData",oV);return on.isTo=oD,on.type=0,on.target=oo,on.duration=oT,on.data=or,on.startTime=this._startTime+oW,on.endTime=on.startTime+on.duration,on.ease=ok,this._startTime=Math.max(on.endTime,this._startTime),this._tweenDataList.push(on),this._startTimeSort=!0,this._endTimeSort=!0,this},or.addLabel=function(oo,or){var oT=oG.getItemByClass("tweenData",oV);return oT.type=1,oT.data=oo,oT.endTime=oT.startTime=this._startTime+or,this._labelDic||(this._labelDic={}),this._labelDic[oo]=oT,this._tweenDataList.push(oT),this},or.removeLabel=function(oo){if(this._labelDic&&this._labelDic[oo]){var or=this._labelDic[oo];if(or){var oT=this._tweenDataList.indexOf(or);-1<oT&&this._tweenDataList.splice(oT,1)}delete this._labelDic[oo]}},or.gotoTime=function(oo){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var or,oT,ok,oW;for(var oD in this._firstTweenDic)if(oT=this._firstTweenDic[oD])for(var on in oT)oT.diyTarget.hasOwnProperty(on)&&(oT.diyTarget[on]=oT[on]);for(oD in this._tweenDic)(or=this._tweenDic[oD]).clear(),delete this._tweenDic[oD];if(this._index=0,this._gidIndex=0,this._currTime=oo,this._lastTime=oe.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=ok=this._tweenDataList.concat(),ok.sort(function(oo,or){return oo.endTime>or.endTime?1:oo.endTime<or.endTime?-1:0})}else ok=this._endTweenDataList;for(var oV=0,oL=ok.length;oV<oL;oV++)if(0==(oW=ok[oV]).type){if(!(oo>=oW.endTime))break;this._index=Math.max(this._index,oV+1);var oU=oW.data;if(oW.isTo)for(var oh in oU)oW.target[oh]=oU[oh]}for(oV=0,oL=this._tweenDataList.length;oV<oL;oV++)0==(oW=this._tweenDataList[oV]).type&&oo>=oW.startTime&&oo<oW.endTime&&(this._index=Math.max(this._index,oV+1),this._gidIndex++,(or=oG.getItemByClass("tween",oQ))._create(oW.target,oW.data,oW.duration,oW.ease,o$.create(this,this._animComplete,[this._gidIndex]),0,!1,oW.isTo,!0,!1),or.setStartTime(this._currTime-(oo-oW.startTime)),or._updateEase(this._currTime),or.gid=this._gidIndex,this._tweenDic[this._gidIndex]=or)}},or.gotoLabel=function(oo){if(null!=this._labelDic){var or=this._labelDic[oo];or&&this.gotoTime(or.startTime)}},or.pause=function(){ob.timer.clear(this,this._update)},or.resume=function(){this.play(this._currTime,this._loopKey)},or.play=function(oo,or){if(void 0===oo&&(oo=0),void 0===or&&(or=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(oo,or){return oo.startTime>or.startTime?1:oo.startTime<or.startTime?-1:0});for(var oT=0,ok=this._tweenDataList.length;oT<ok;oT++){var oW=this._tweenDataList[oT];if(null!=oW&&0==oW.type){var oD=oW.target,on=oD.$_GID||(oD.$_GID=og.getGID()),oV=null;for(var oL in null==this._firstTweenDic[on]?((oV={}).diyTarget=oD,this._firstTweenDic[on]=oV):oV=this._firstTweenDic[on],oW.data)null==oV[oL]&&(oV[oL]=oD[oL])}}}"string"==typeof oo?this.gotoLabel(oo):this.gotoTime(oo),this._loopKey=or,this._lastTime=oe.now(),ob.timer.frameLoop(1,this,this._update)}},or._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var oo in this._tweenDic)(or=this._tweenDic[oo]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var or,oT=oe.now(),ok=oT-this._lastTime,oW=this._currTime+=ok*this.scale;for(oo in this._lastTime=oT,this._tweenDic)(or=this._tweenDic[oo])._updateEase(oW);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var oD=this._tweenDataList[this._index];oW>=oD.startTime&&(this._index++,0==oD.type?(this._gidIndex++,(or=oG.getItemByClass("tween",oQ))._create(oD.target,oD.data,oD.duration,oD.ease,o$.create(this,this._animComplete,[this._gidIndex]),0,!1,oD.isTo,!0,!1),or.setStartTime(oW),or.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=or)._updateEase(oW)):this.event("label",oD.data))}},or._animComplete=function(oo){this._tweenDic[oo]&&delete this._tweenDic[oo]},or._complete=function(){this.event("complete")},or.reset=function(){var oo;if(this._labelDic)for(oo in this._labelDic)delete this._labelDic[oo];for(oo in this._tweenDic)this._tweenDic[oo].clear(),delete this._tweenDic[oo];for(oo in this._firstTweenDic)delete this._firstTweenDic[oo];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var or,oT=0;for(or=this._tweenDataList.length,oT=0;oT<or;oT++)this._tweenDataList[oT]&&this._tweenDataList[oT].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,ob.timer.clear(this,this._update)},or.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},oh(0,or,"index",function(){return this._frameIndex},function(oo){this._frameIndex=oo,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),oh(0,or,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),oD.to=function(oo,or,oT,ok,oW){return void 0===oW&&(oW=0),(new oD).to(oo,or,oT,ok,oW)},oD.from=function(oo,or,oT,ok,oW){return void 0===oW&&(oW=0),(new oD).from(oo,or,oT,ok,oW)},oD.__init$=function(){oV=function(){function oo(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return oj(oo,""),oo.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,oG.recover("tweenData",this)},oo}()},oD}(),opo=function(oW){function oT(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,oT.__super.call(this),this._style=oV.EMPTY}oj(oT,"laya.display.Sprite",oW);var oo=oT.prototype;return ob.imps(oo,{"laya.display.ILayout":!0}),oo.createConchModel=function(){return new ConchNode},oo.destroy=function(oo){if(void 0===oo&&(oo=!0),this._releaseMem(),!this._destroyed){this.filters=null;var or=this.mask;or&&(this.mask=null,or.destroy(oo))}oW.prototype.destroy.call(this,oo),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},oo.updateZOrder=function(){og.updateOrder(this._childs)&&this.repaint()},oo.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},oo.setBounds=function(oo){this._set$P("uBounds",oo)},oo.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new oP),oP._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},oo.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new oP),oP._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},oo._boundPointsToParent=function(oo){void 0===oo&&(oo=!1);var or=0,oT=0;this._style&&(or=this._style._tf.translateX,oT=this._style._tf.translateY,oo=oo||0!==this._style._tf.rotate,this._style.scrollRect&&(or+=this._style.scrollRect.x,oT+=this._style.scrollRect.y));var ok=this._getBoundPointsM(oo);if(!ok||ok.length<1)return ok;if(8!=ok.length&&(ok=oo?oS.scanPList(ok):oP._getWrapRec(ok,oP.TEMP)._getBoundPoints()),!this.transform)return og.transPointList(ok,this._x-or,this._y-oT),ok;var oW=oF.TEMP,oD=0,on=ok.length;for(oD=0;oD<on;oD+=2)oW.x=ok[oD],oW.y=ok[oD+1],this.toParentPoint(oW),ok[oD]=oW.x,ok[oD+1]=oW.y;return ok},oo.getGraphicBounds=function(oo){return void 0===oo&&(oo=!1),this._graphics?this._graphics.getBounds(oo):oP.TEMP.setTo(0,0,0,0)},oo._getBoundPointsM=function(oo){if(void 0===oo&&(oo=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var or=og.clearArray(this._$P.temBM),oT=oP.TEMP;return oT.copyFrom(this.scrollRect),og.concatArray(or,oT._getBoundPoints()),or}for(var ok,oW,oD,on=this._graphics?this._graphics.getBoundPoints():og.clearArray(this._$P.temBM),oV=0,oL=(oD=this._childs).length;oV<oL;oV++)(ok=oD[oV])instanceof laya.display.Sprite&&1==ok.visible&&(oW=ok._boundPointsToParent(oo))&&(on=on?og.concatArray(on,oW):oW);return on},oo.getStyle=function(){return this._style===oV.EMPTY&&(this._style=new oV),this._style},oo.setStyle=function(oo){this._style=oo},oo._adjustTransform=function(){this._tfChanged=!1;var oo,or=this._style._tf,oT=or.scaleX,ok=or.scaleY;if(or.rotate||1!==oT||1!==ok||or.skewX||or.skewY){(oo=this._transform||(this._transform=os.create())).bTransform=!0;var oW=.0174532922222222*(or.rotate-or.skewX),oD=.0174532922222222*(or.rotate+or.skewY),on=Math.cos(oD),oV=Math.sin(oD),oL=Math.sin(oW),oU=Math.cos(oW);return oo.a=oT*on,oo.b=oT*oV,oo.c=-ok*oL,oo.d=ok*oU,oo.tx=oo.ty=0,oo}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,oo},oo.pos=function(oo,or,oT){if(void 0===oT&&(oT=!1),this._x!==oo||this._y!==or){if(this.destroyed)return this;if(oT){this._x=oo,this._y=or,this.conchModel&&this.conchModel.pos(this._x,this._y);var ok=this._parent;ok&&0===ok._repaint&&(ok._repaint=1,ok.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=oo,this.y=or}return this},oo.pivot=function(oo,or){return this.pivotX=oo,this.pivotY=or,this},oo.size=function(oo,or){return this.width=oo,this.height=or,this},oo.scale=function(oo,or,oT){void 0===oT&&(oT=!1);var ok=this.getStyle(),oW=ok._tf;if(oW.scaleX!=oo||oW.scaleY!=or){if(this.destroyed)return this;if(oT){ok.setScale(oo,or),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(oo,or),this._renderType|=4;var oD=this._parent;oD&&0===oD._repaint&&(oD._repaint=1,oD.parentRepaint())}else this.scaleX=oo,this.scaleY=or}return this},oo.skew=function(oo,or){return this.skewX=oo,this.skewY=or,this},oo.render=function(oo,or,oT){ow.spriteCount++,oO.renders[this._renderType]._fun(this,oo,or+this._x,oT+this._y),this._repaint=0},oo.drawToCanvas=function(oo,or,oT,ok){if(oC.isConchNode){var oW=oyo.create("2D");return new oX(oo,or,oW).ctx.setCanvasType(1),this.conchModel.drawToCanvas(oW.source,oT,ok),oW}return ou.drawToCanvas(this,this._renderType,oo,or,oT,ok)},oo.customRender=function(oo,or,oT){this._renderType|=1024},oo._applyFilters=function(){var oo;if(!oC.isWebGL&&((oo=this._$P.filters)&&!(oo.length<1)))for(var or=0,oT=oo.length;or<oT;or++)oo[or].action.apply(this._$P.cacheCanvas)},oo._isHaveGlowFilter=function(){var oo,or=0;if(this.filters)for(or=0;or<this.filters.length;or++)if(8==this.filters[or].type)return!0;for(or=0,oo=this._childs.length;or<oo;or++)if(this._childs[or]._isHaveGlowFilter())return!0;return!1},oo.localToGlobal=function(oo,or){void 0===or&&(or=!1),!0===or&&(oo=new oF(oo.x,oo.y));for(var oT=this;oT&&oT!=ob.stage;)oo=oT.toParentPoint(oo),oT=oT.parent;return oo},oo.globalToLocal=function(oo,or){void 0===or&&(or=!1),or&&(oo=new oF(oo.x,oo.y));for(var oT=this,ok=[];oT&&oT!=ob.stage;)ok.push(oT),oT=oT.parent;for(var oW=ok.length-1;0<=oW;)oo=(oT=ok[oW]).fromParentPoint(oo),oW--;return oo},oo.toParentPoint=function(oo){if(!oo)return oo;oo.x-=this.pivotX,oo.y-=this.pivotY,this.transform&&this._transform.transformPoint(oo),oo.x+=this._x,oo.y+=this._y;var or=this._style.scrollRect;return or&&(oo.x-=or.x,oo.y-=or.y),oo},oo.fromParentPoint=function(oo){if(!oo)return oo;oo.x-=this._x,oo.y-=this._y;var or=this._style.scrollRect;return or&&(oo.x+=or.x,oo.y+=or.y),this.transform&&this._transform.invertTransformPoint(oo),oo.x+=this.pivotX,oo.y+=this.pivotY,oo},oo.on=function(oo,or,oT,ok){return 1!==this._mouseEnableState&&this.isMouseEvent(oo)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(oo,or,oT,ok,!1)):oW.prototype.on.call(this,oo,or,oT,ok)},oo.once=function(oo,or,oT,ok){return 1!==this._mouseEnableState&&this.isMouseEvent(oo)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(oo,or,oT,ok,!0)):oW.prototype.once.call(this,oo,or,oT,ok)},oo._$2__onDisplay=function(){if(1!==this._mouseEnableState){var oo=this;for(oo=oo.parent;oo&&1!==oo._mouseEnableState&&!oo._getBit(2);)oo.mouseEnabled=!0,oo._setBit(2,!0),oo=oo.parent}},oo.loadImage=function(oo,or,oT,ok,oW,oD){var on=this;return void 0===or&&(or=0),void 0===oT&&(oT=0),void 0===ok&&(ok=0),void 0===oW&&(oW=0),this.graphics.loadImage(oo,or,oT,ok,oW,function(oo){on.destroyed||(on.size(or+(ok||oo.width),oT+(oW||oo.height)),on.repaint(),oD&&oD.runWith(oo))}),this},oo.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},oo._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},oo._childChanged=function(oo){this._childs.length?this._renderType|=2048:this._renderType&=-2049,oo&&this._get$P("hasZorder")&&ob.timer.callLater(this,this.updateZOrder),this.repaint()},oo.parentRepaint=function(){var oo=this._parent;oo&&0===oo._repaint&&(oo._repaint=1,oo.parentRepaint())},oo.startDrag=function(oo,or,oT,ok,oW,oD,on){void 0===or&&(or=!1),void 0===oT&&(oT=0),void 0===ok&&(ok=300),void 0===oD&&(oD=!1),void 0===on&&(on=.92),this._$P.dragging||this._set$P("dragging",new oN),this._$P.dragging.start(this,oo,or,oT,ok,oW,oD,on)},oo.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},oo._releaseMem=function(){if(this._$P){var oo=this._$P.cacheCanvas;oo&&oo.ctx&&(oG.recover("RenderContext",oo.ctx),oo.ctx.canvas.size(0,0),oo.ctx=null);var or=this._$P._filterCache;or&&(or.destroy(),or.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},oo._setDisplay=function(oo){oo||this._releaseMem(),oW.prototype._setDisplay.call(this,oo)},oo.hitTestPoint=function(oo,or){var oT=this.globalToLocal(oF.TEMP.setTo(oo,or));return oo=oT.x,or=oT.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?oP.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(oo,or)},oo.getMousePoint=function(){return this.globalToLocal(oF.TEMP.setTo(ob.stage.mouseX,ob.stage.mouseY))},oo._getWords=function(){return null},oo._addChildsToLayout=function(oo){var or=this._getWords();if(null==or&&0==this._childs.length)return!1;if(or)for(var oT=0,ok=or.length;oT<ok;oT++)oo.push(or[oT]);oT=0;for(var oW=this._childs.length;oT<oW;++oT){var oD=this._childs[oT];oD._style._enableLayout()&&oD._addToLayout(oo)}return!0},oo._addToLayout=function(oo){this._style.absolute||(this._style.block?oo.push(this):this._addChildsToLayout(oo)&&(this.x=this.y=0))},oo._isChar=function(){return!1},oo._getCSSStyle=function(){return this._style.getCSSStyle()},oo._setAttributes=function(oo,or){switch(oo){case"x":this.x=parseFloat(or);break;case"y":this.y=parseFloat(or);break;case"width":this.width=parseFloat(or);break;case"height":this.height=parseFloat(or);break;default:this[oo]=or}},oo._layoutLater=function(){this.parent&&this.parent._layoutLater()},oh(0,oo,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(oo){this._optimizeScrollRect!=oo&&(this._optimizeScrollRect=oo,this.conchModel&&this.conchModel.optimizeScrollRect(oo))}),oh(0,oo,"customRenderEnable",null,function(oo){if(oo&&(this._renderType|=1024,oC.isConchNode)){oT.CustomList.push(this);var or=new oyo("2d");or._setContext(new CanvasRenderingContext2D),this.customContext=new oX(0,0,or),or.context.setCanvasType&&or.context.setCanvasType(2),this.conchModel.custom(or.context)}}),oh(0,oo,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(oo){this.cacheAs=oo?this._$P.hasFilter?"none":"normal":"none"}),oh(0,oo,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(oo){var or=this._$P.cacheCanvas;if(oo!==(or?or.type:"none")){if("none"!==oo)this._getBit(1)||this._setUpNoticeType(1),or||(or=this._set$P("cacheCanvas",oG.getItemByClass("cacheCanvas",Object))),or.type=oo,or.reCache=!0,this._renderType|=16,"bitmap"==oo&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(or){var oT=or;oT&&oT.ctx&&(oG.recover("RenderContext",oT.ctx),oT.ctx.canvas.size(0,0),oT.ctx=null),oG.recover("cacheCanvas",or)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),oh(0,oo,"zOrder",function(){return this._zOrder},function(oo){this._zOrder!=oo&&(this._zOrder=oo,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(oo),this._parent&&(oo&&this._parent._set$P("hasZorder",!0),ob.timer.callLater(this._parent,this.updateZOrder)))}),oh(0,oo,"rotation",function(){return this._style._tf.rotate},function(oo){var or=this.getStyle();if(or._tf.rotate!==oo){or.setRotate(oo),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(oo),this._renderType|=4;var oT=this._parent;oT&&0===oT._repaint&&(oT._repaint=1,oT.parentRepaint())}}),oh(0,oo,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(oo){this._width!==oo&&(this._width=oo,this.conchModel&&this.conchModel.size(oo,this._height),this.repaint())}),oh(0,oo,"x",function(){return this._x},function(oo){if(this._x!==oo){if(this.destroyed)return;this._x=oo,this.conchModel&&this.conchModel.pos(oo,this._y);var or=this._parent;or&&0===or._repaint&&(or._repaint=1,or.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),oh(0,oo,"globalScaleY",function(){for(var oo=1,or=this;or&&or!==ob.stage;)oo*=or.scaleY,or=or.parent;return oo}),oh(0,oo,"hitArea",function(){return this._$P.hitArea},function(oo){this._set$P("hitArea",oo)}),oh(0,oo,"staticCache",function(){return this._$P.staticCache},function(oo){this._set$P("staticCache",oo),oo||this.reCache()}),oh(0,oo,"texture",function(){return this._texture},function(oo){this._texture!=oo&&(this._texture=oo,this.graphics.cleanByTexture(oo,0,0))}),oh(0,oo,"y",function(){return this._y},function(oo){if(this._y!==oo){if(this.destroyed)return;this._y=oo,this.conchModel&&this.conchModel.pos(this._x,oo);var or=this._parent;or&&0===or._repaint&&(or._repaint=1,or.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),oh(0,oo,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(oo){this._height!==oo&&(this._height=oo,this.conchModel&&this.conchModel.size(this._width,oo),this.repaint())}),oh(0,oo,"blendMode",function(){return this._style.blendMode},function(oo){this.getStyle().blendMode=oo,this.conchModel&&this.conchModel.blendMode(oo),oo&&"source-over"!=oo?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),oh(0,oo,"scaleX",function(){return this._style._tf.scaleX},function(oo){var or=this.getStyle();if(or._tf.scaleX!==oo){or.setScaleX(oo),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(oo,or._tf.scaleY),this._renderType|=4;var oT=this._parent;oT&&0===oT._repaint&&(oT._repaint=1,oT.parentRepaint())}}),oh(0,oo,"scaleY",function(){return this._style._tf.scaleY},function(oo){var or=this.getStyle();if(or._tf.scaleY!==oo){or.setScaleY(oo),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(or._tf.scaleX,oo),this._renderType|=4;var oT=this._parent;oT&&0===oT._repaint&&(oT._repaint=1,oT.parentRepaint())}}),oh(0,oo,"stage",function(){return ob.stage}),oh(0,oo,"skewX",function(){return this._style._tf.skewX},function(oo){var or=this.getStyle();if(or._tf.skewX!==oo){or.setSkewX(oo),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(oo,or._tf.skewY),this._renderType|=4;var oT=this._parent;oT&&0===oT._repaint&&(oT._repaint=1,oT.parentRepaint())}}),oh(0,oo,"scrollRect",function(){return this._style.scrollRect},function(oo){this.getStyle().scrollRect=oo,this.repaint(),oo?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(oo.x,oo.y,oo.width,oo.height)):(this._renderType&=-129,this.conchModel&&(oT.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),oh(0,oo,"skewY",function(){return this._style._tf.skewY},function(oo){var or=this.getStyle();if(or._tf.skewY!==oo){or.setSkewY(oo),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(or._tf.skewX,oo),this._renderType|=4;var oT=this._parent;oT&&0===oT._repaint&&(oT._repaint=1,oT.parentRepaint())}}),oh(0,oo,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(oo){this._tfChanged=!1,(this._transform=oo)&&(this._x=oo.tx,this._y=oo.ty,oo.tx=oo.ty=0,this.conchModel&&this.conchModel.transform(oo.a,oo.b,oo.c,oo.d,this._x,this._y)),oo?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),oh(0,oo,"pivotX",function(){return this._style._tf.translateX},function(oo){this.getStyle().setTranslateX(oo),this.conchModel&&this.conchModel.pivot(oo,this._style._tf.translateY),this.repaint()}),oh(0,oo,"pivotY",function(){return this._style._tf.translateY},function(oo){this.getStyle().setTranslateY(oo),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,oo),this.repaint()}),oh(0,oo,"alpha",function(){return this._style.alpha},function(oo){this._style&&this._style.alpha!==oo&&(oo=oo<0?0:1<oo?1:oo,this.getStyle().alpha=oo,this.conchModel&&this.conchModel.alpha(oo),1!==oo?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),oh(0,oo,"visible",function(){return this._style.visible},function(oo){this._style&&this._style.visible!==oo&&(this.getStyle().visible=oo,this.conchModel&&this.conchModel.visible(oo),this.parentRepaint())}),oh(0,oo,"graphics",function(){return this._graphics||(this.graphics=ou.createGraphics())},function(oo){this._graphics&&(this._graphics._sp=null),(this._graphics=oo)?(this._renderType&=-2,this._renderType|=512,(oo._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(oT.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),oh(0,oo,"filters",function(){return this._$P.filters},function(oo){oo&&0===oo.length&&(oo=null),this._$P.filters!=oo&&(this._set$P("filters",oo?oo.slice():null),oC.isConchApp&&(this.conchModel&&(oT.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),oC.isWebGL&&(oo&&oo.length?this._renderType|=32:this._renderType&=-33),oo&&0<oo.length?(this._getBit(1)||this._setUpNoticeType(1),oC.isWebGL&&1==oo.length&&oo[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(oC.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),oh(0,oo,"parent",oW.prototype._$get_parent,function(oo){ob.superSet(ooo,this,"parent",oo),oo&&this._getBit(2)&&this._$2__onDisplay()}),oh(0,oo,"mask",function(){return this._$P._mask},function(oo){oo&&this.mask&&this.mask._$P.maskParent||(oo?(this.cacheAs="bitmap",this._set$P("_mask",oo),oo._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",oo),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(oo?oo.conchModel:null),this._renderType|=64,this.parentRepaint())}),oh(0,oo,"mouseEnabled",function(){return 1<this._mouseEnableState},function(oo){this._mouseEnableState=oo?2:1}),oh(0,oo,"globalScaleX",function(){for(var oo=1,or=this;or&&or!==ob.stage;)oo*=or.scaleX,or=or.parent;return oo}),oh(0,oo,"mouseX",function(){return this.getMousePoint().x}),oh(0,oo,"mouseY",function(){return this.getMousePoint().y}),oT.fromImage=function(oo){return(new oT).loadImage(oo)},oT._cachePool=[],oT.CustomList=[],oL(oT,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=on.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),oT}(ooo),oio=function(oo){function or(oo){this._audio=null,this._onEnd=null,this._resumePlay=null,or.__super.call(this),this._onEnd=og.bind(this.__onEnd,this),this._resumePlay=og.bind(this.__resumePlay,this),oo.addEventListener("ended",this._onEnd),this._audio=oo}oj(or,"laya.media.h5audio.AudioSoundChannel",oko);var oT=or.prototype;return oT.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(ob.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},oT.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,oe.container.appendChild(this._audio),this._audio.play()}catch(oo){this.event("error")}},oT.play=function(oo){this.isStopped=!1;try{this._audio.playbackRate=oR.playbackRate,this._audio.currentTime=this.startTime}catch(oo){return void this._audio.addEventListener("canplay",this._resumePlay)}oR.addChannel(this),oe.container.appendChild(this._audio),!oo&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},oT.stop=function(){this.isStopped=!0,oR.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&oC.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),oe.onIE||this._audio!=oTo._musicAudio&&oG.recover("audio:"+this.url,this._audio),oe.removeElement(this._audio),this._audio=null)},oT.pause=function(){this.isStopped=!0,oR.removeChannel(this),"pause"in this._audio&&this._audio.pause()},oT.resume=function(){this._audio&&(this.isStopped=!1,oR.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},oh(0,oT,"position",function(){return this._audio?this._audio.currentTime:0}),oh(0,oT,"duration",function(){return this._audio?this._audio.duration:0}),oh(0,oT,"volume",function(){return this._audio?this._audio.volume:1},function(oo){this._audio&&(this._audio.volume=oo)}),or}(),ovo=function(oo){function or(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=oDo.ctx,or.__super.call(this),this._onPlayEnd=og.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}oj(or,"laya.media.webaudio.WebAudioSoundChannel",oko);var oT=or.prototype;return oT.play=function(oo){if(oR.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var or=this.context,oT=this.gain,ok=or.createBufferSource();(this.bufferSource=ok).buffer=this.audioBuffer,ok.connect(oT),oT&&oT.disconnect(),oT.connect(or.destination),ok.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=oe.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(ok.loop=!0),ok.playbackRate.setTargetAtTime?ok.playbackRate.setTargetAtTime(oR.playbackRate,this.context.currentTime,.1):ok.playbackRate.value=oR.playbackRate,ok.start(0,this.startTime),!oo&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},oT.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(ob.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},oT._clearBufferSource=function(){if(this.bufferSource){var oo=this.bufferSource;oo.stop?oo.stop(0):oo.noteOff(0),oo.disconnect(0),oo.onended=null,or._tryCleanFailed||this._tryClearBuffer(oo),this.bufferSource=null}},oT._tryClearBuffer=function(oo){try{oo.buffer=null}catch(oo){or._tryCleanFailed=!0}},oT.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,oR.removeChannel(this),this.startHandler=null,this.completeHandler=null},oT.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,oR.removeChannel(this)},oT.resume=function(){this.startTime=this._pauseTime,this.play(!1)},oh(0,oT,"position",function(){return this.bufferSource?(oe.now()-this._startTime)/1e3+this.startTime:0}),oh(0,oT,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),oh(0,oT,"volume",function(){return this._volume},function(oo){this.isStopped||(this._volume=oo,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(oo,this.context.currentTime,.1):this.gain.gain.value=oo)}),or._tryCleanFailed=!1,or}(),oxo=function(oo){function or(){or.__super.call(this),this._w=0,this._h=0}oj(or,"laya.resource.Bitmap",oUo);var oT=or.prototype;return oh(0,oT,"width",function(){return this._w}),oh(0,oT,"height",function(){return this._h}),oh(0,oT,"source",function(){return this._source}),or}(),ojo=function(or){function oo(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,oo.__super.call(this),this._interval=ok.animationInterval,this._setUpNoticeType(1)}oj(oo,"laya.display.AnimationPlayerBase",or);var oT=oo.prototype;return oT.play=function(oo,or,oT,ok){void 0===oo&&(oo=0),void 0===or&&(or=!0),void 0===oT&&(oT=""),void 0===ok&&(ok=!0),this._isPlaying=!0,this.index="string"==typeof oo?this._getFrameByLabel(oo):oo,this.loop=or,this._actionName=oT,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},oT._getFrameByLabel=function(oo){var or=0;for(or=0;or<this._count;or++)if(this._labels[or]&&0<=this._labels[or].indexOf(oo))return or;return 0},oT._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},oT._setControlNode=function(oo){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=oo)&&oo!=this&&(oo.on("display",this,this._checkResumePlaying),oo.on("undisplay",this,this._checkResumePlaying))},oT._setDisplay=function(oo){or.prototype._setDisplay.call(this,oo),this._checkResumePlaying()},oT._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},oT.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},oT.addLabel=function(oo,or){this._labels||(this._labels={}),this._labels[or]||(this._labels[or]=[]),this._labels[or].push(oo)},oT.removeLabel=function(oo){if(oo){if(this._labels)for(var or in this._labels)this._removeLabelFromLabelList(this._labels[or],oo)}else this._labels=null},oT._removeLabelFromLabelList=function(oo,or){if(oo)for(var oT=oo.length-1;0<=oT;oT--)oo[oT]==or&&oo.splice(oT,1)},oT.gotoAndStop=function(oo){this.index="string"==typeof oo?this._getFrameByLabel(oo):oo,this.stop()},oT._displayToIndex=function(oo){},oT.clear=function(){this.stop(),this._labels=null},oh(0,oT,"interval",function(){return this._interval},function(oo){this._interval!=oo&&(this._frameRateChanged=!0,this._interval=oo,this._isPlaying&&0<oo&&this.timerLoop(oo,this,this._frameLoop,null,!0,!0))}),oh(0,oT,"isPlaying",function(){return this._isPlaying}),oh(0,oT,"index",function(){return this._index},function(oo){if(this._index=oo,this._displayToIndex(oo),this._labels&&this._labels[oo])for(var or=this._labels[oo],oT=0,ok=or.length;oT<ok;oT++)this.event("label",or[oT])}),oh(0,oT,"count",function(){return this._count}),oo.WRAP_POSITIVE=0,oo.WRAP_REVERSE=1,oo.WRAP_PINGPONG=2,oo}(opo),o_o=function(or){function ov(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,ov.__super.call(this),this.overflow=ov.VISIBLE,this._style=new oro(this),this._style.wordWrap=!1}oj(ov,"laya.display.Text",or);var oo=ov.prototype;return oo.destroy=function(oo){void 0===oo&&(oo=!0),or.prototype.destroy.call(this,oo),this._lines=null,this._words&&(this._words.length=0,this._words=null)},oo._getBoundPointsM=function(oo){void 0===oo&&(oo=!1);var or=oP.TEMP;return or.setTo(0,0,this.width,this.height),or._getBoundPoints()},oo.getGraphicBounds=function(oo){void 0===oo&&(oo=!1);var or=oP.TEMP;return or.setTo(0,0,this.width,this.height),or},oo._getCSSStyle=function(){return this._style},oo.lang=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh){if(oo=ov.langPacks&&ov.langPacks[oo]?ov.langPacks[oo]:oo,arguments.length<2)this._text=oo;else{for(var op=0,oi=arguments.length;op<oi;op++)oo=oo.replace("{"+op+"}",arguments[op+1]);this._text=oo}},oo._isPassWordMode=function(){var oo=this._style.password;return"prompt"in this&&this.prompt==this._text&&(oo=!1),oo},oo._getPassWordTxt=function(oo){var or;or="";for(var oT=oo.length;0<oT;oT--)or+="●";return or},oo.renderText=function(oo,or){var oT=this.graphics;oT.clear(!0);var ok=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(oe.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);oe.context.font=ok;var oW=this.padding,oD=oW[3],on="left",oV=this._lines,oL=this.leading+this._charSize.height,oU=this._currBitmapFont;oU&&(oL=this.leading+oU.getMaxHeight());var oh=oW[0];if(!oU&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(on="right",oD=this._width-oW[1]):"center"==this.align&&(on="center",oD=.5*this._width+oW[3]-oW[1])),0<this._height){var op=this._textHeight>this._height?"top":this.valign;"middle"===op?oh=.5*(this._height-or*oL)+oW[0]-oW[2]:"bottom"===op&&(oh=this._height-or*oL-oW[2])}var oi=this._style;if(oU&&oU.autoScaleSize)var ov=oU.fontSize/this.fontSize;if(this._clipPoint)if(oT.save(),oU&&oU.autoScaleSize){var ox=0,oj=0;ox=this._width?this._width-oW[3]-oW[1]:this._textWidth,oj=this._height?this._height-oW[0]-oW[2]:this._textHeight,ox*=ov,oj*=ov,oT.clipRect(oW[3],oW[0],ox,oj)}else oT.clipRect(oW[3],oW[0],this._width?this._width-oW[3]-oW[1]:this._textWidth,this._height?this._height-oW[0]-oW[2]:this._textHeight);var o_=oi.password;"prompt"in this&&this.prompt==this._text&&(o_=!1);for(var oK=0,o$=0,oy=Math.min(this._lines.length,or+oo)||1,ol=oo;ol<oy;ol++){var oS,oq=oV[ol];if(o_){var ob=oq.length;oq="";for(var oF=ob;0<oF;oF--)oq+="●"}if(oK=oD-(this._clipPoint?this._clipPoint.x:0),o$=oh+oL*ol-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(on,oK,o$,ol),oU){var oP=this.width;oU.autoScaleSize&&(oP=this.width*ov),oU.drawText(oq,this,oK,o$,this.align,oP)}else oC.isWebGL?(this._words||(this._words=[]),(oS=this._words.length>ol-oo?this._words[ol-oo]:new od).setText(oq)):oS=oq,oi.stroke?oT.fillBorderText(oS,oK,o$,ok,this.color,oi.strokeColor,oi.stroke,on):oT.fillText(oS,oK,o$,ok,this.color,on)}if(oU&&oU.autoScaleSize){var ot=1/ov;this.scale(ot,ot)}this._clipPoint&&oT.restore(),this._startX=oD,this._startY=oh},oo.drawUnderline=function(oo,or,oT,ok){var oW=this._lineWidths[ok];switch(oo){case"center":or-=oW/2;break;case"right":or-=oW}oT+=this._charSize.height,this._graphics.drawLine(or,oT,or+oW,oT,this.underlineColor||this.color,1)},oo.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);oe.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new oF(0,0)):this._clipPoint=null;var oo=this._lines.length;if(this.overflow!=ov.VISIBLE){var or=this.overflow==ov.HIDDEN?Math.floor:Math.ceil;oo=Math.min(oo,or((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var oT=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(oT,oo),this.repaint()},oo.evalTextSize=function(){var oo,or=NaN;oo=Math.max.apply(this,this._lineWidths),or=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],oo==this._textWidth&&or==this._textHeight||(this._textWidth=oo,this._textHeight=or,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},oo.checkEnabledViewportOrNot=function(){return this.overflow==ov.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},oo.changeText=function(oo){this._text!==oo&&(this.lang(oo+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},oo.parseLines=function(oo){var or=this.wordWrap||this.overflow==ov.HIDDEN;if(or)var oT=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var ok=oe.context.measureText(ov._testWord);oC.isConchApp&&0===ok.width&&0===ok.height&&(ok=oe.context.measureText("W")),this._charSize.width=ok.width,this._charSize.height=ok.height||this.fontSize}for(var oW=oo.replace(/\r\n/g,"\n").split("\n"),oD=0,on=oW.length;oD<on;oD++){var oV=oW[oD];or?this.parseLine(oV,oT):(this._lineWidths.push(this.getTextWidth(oV)),this._lines.push(oV))}},oo.parseLine=function(oo,or){oe.context;var oT,ok=this._lines,oW=0,oD=NaN,on=NaN,oV=0;if((oD=this.getTextWidth(oo))<=or)return ok.push(oo),void this._lineWidths.push(oD);oD=this._charSize.width,0==(oW=Math.floor(or/oD))&&(oW=1),on=oD=this.getTextWidth(oo.substring(0,oW));for(var oL=oW,oU=oo.length;oL<oU;oL++)if(or<(on+=oD=this.getTextWidth(oo.charAt(oL))))if(this.wordWrap){var oh=oo.substring(oV,oL);if(oh.charCodeAt(oh.length-1)<255?(oT=/(?:\w|-)+$/.exec(oh))&&(oL=oT.index+oV,0==oT.index?oL+=oh.length:oh=oo.substring(oV,oL)):ov.RightToLeft&&(oT=/([\u0600-\u06FF])+$/.exec(oh))&&(oL=oT.index+oV,0==oT.index?oL+=oh.length:oh=oo.substring(oV,oL)),ok.push(oh),this._lineWidths.push(on-oD),!((oV=oL)+oW<oU)){ok.push(oo.substring(oV,oU)),this._lineWidths.push(this.getTextWidth(ok[ok.length-1])),oV=-1;break}oL+=oW,on=oD=this.getTextWidth(oo.substring(oV,oL)),oL--}else if(this.overflow==ov.HIDDEN)return ok.push(oo.substring(0,oL)),void this._lineWidths.push(this.getTextWidth(ok[ok.length-1]));this.wordWrap&&-1!=oV&&(ok.push(oo.substring(oV,oU)),this._lineWidths.push(this.getTextWidth(ok[ok.length-1])))},oo.getTextWidth=function(oo){return this._currBitmapFont?this._currBitmapFont.getTextWidth(oo):oe.context.measureText(oo).width},oo.getWordWrapWidth=function(){var oo=this.padding,or=NaN;return(or=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(or=this.wordWrap?100:oe.width),or<=0&&(or=100),or-oo[3]-oo[1]},oo.getCharPoint=function(oo,or){this._isChanged&&ob.timer.runCallLater(this,this.typeset);for(var oT=0,ok=this._lines,oW=0,oD=0,on=ok.length;oD<on;oD++){if(oo<(oT+=ok[oD].length)){var oV=oD;break}oW=oT}var oL=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;oe.context.font=oL;var oU=this.getTextWidth(this._text.substring(oW,oo));return(or||new oF).setTo(this._startX+oU-(this._clipPoint?this._clipPoint.x:0),this._startY+oV*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},oh(0,oo,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(oo){oo!=this._width&&(ob.superSet(opo,this,"width",oo),this.isChanged=!0)}),oh(0,oo,"textWidth",function(){return this._isChanged&&ob.timer.runCallLater(this,this.typeset),this._textWidth}),oh(0,oo,"height",function(){return this._height?this._height:this.textHeight},function(oo){oo!=this._height&&(ob.superSet(opo,this,"height",oo),this.isChanged=!0)}),oh(0,oo,"textHeight",function(){return this._isChanged&&ob.timer.runCallLater(this,this.typeset),this._textHeight}),oh(0,oo,"padding",function(){return this._getCSSStyle().padding},function(oo){this._getCSSStyle().padding=oo,this.isChanged=!0}),oh(0,oo,"bold",function(){return this._getCSSStyle().bold},function(oo){this._getCSSStyle().bold=oo,this.isChanged=!0}),oh(0,oo,"text",function(){return this._text||""},function(oo){this._text!==oo&&(this.lang(oo+""),this.isChanged=!0,this.event("change"))}),oh(0,oo,"color",function(){return this._getCSSStyle().color},function(oo){this._getCSSStyle().color!=oo&&(this._getCSSStyle().color=oo,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),oh(0,oo,"font",function(){return this._getCSSStyle().fontFamily},function(oo){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),ov._bitmapFonts&&ov._bitmapFonts[oo]&&(this._currBitmapFont=ov._bitmapFonts[oo]),this._getCSSStyle().fontFamily=oo,this.isChanged=!0}),oh(0,oo,"fontSize",function(){return this._getCSSStyle().fontSize},function(oo){this._getCSSStyle().fontSize=oo,this.isChanged=!0}),oh(0,oo,"italic",function(){return this._getCSSStyle().italic},function(oo){this._getCSSStyle().italic=oo,this.isChanged=!0}),oh(0,oo,"align",function(){return this._getCSSStyle().align},function(oo){this._getCSSStyle().align=oo,this.isChanged=!0}),oh(0,oo,"valign",function(){return this._getCSSStyle().valign},function(oo){this._getCSSStyle().valign=oo,this.isChanged=!0}),oh(0,oo,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(oo){this._getCSSStyle().wordWrap=oo,this.isChanged=!0}),oh(0,oo,"leading",function(){return this._getCSSStyle().leading},function(oo){this._getCSSStyle().leading=oo,this.isChanged=!0}),oh(0,oo,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(oo){this._getCSSStyle().backgroundColor=oo,this.isChanged=!0}),oh(0,oo,"borderColor",function(){return this._getCSSStyle().borderColor},function(oo){this._getCSSStyle().borderColor=oo,this.isChanged=!0}),oh(0,oo,"stroke",function(){return this._getCSSStyle().stroke},function(oo){this._getCSSStyle().stroke=oo,this.isChanged=!0}),oh(0,oo,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(oo){this._getCSSStyle().strokeColor=oo,this.isChanged=!0}),oh(0,oo,"isChanged",null,function(oo){this._isChanged!==oo&&(this._isChanged=oo)&&ob.timer.callLater(this,this.typeset)}),oh(0,oo,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(oo){if(!(this.overflow!=ov.SCROLL||this.textWidth<this._width)&&this._clipPoint){oo=oo<this.padding[3]?this.padding[3]:oo;var or=this._textWidth-this._width;oo=or<oo?or:oo;var oT=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=oo,this.renderText(this._lastVisibleLineIndex,oT)}}),oh(0,oo,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(oo){if(!(this.overflow!=ov.SCROLL||this.textHeight<this._height)&&this._clipPoint){oo=oo<this.padding[0]?this.padding[0]:oo;var or=this._textHeight-this._height,oT=(oo=or<oo?or:oo)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=oT;var ok=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=oo,this.renderText(oT,ok)}}),oh(0,oo,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),oh(0,oo,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),oh(0,oo,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),oh(0,oo,"underlineColor",function(){return this._underlineColor},function(oo){this._underlineColor=oo,this._isChanged=!0,this.typeset()}),ov.registerBitmapFont=function(oo,or){ov._bitmapFonts||(ov._bitmapFonts={}),ov._bitmapFonts[oo]=or},ov.unregisterBitmapFont=function(oo,or){if(void 0===or&&(or=!0),ov._bitmapFonts&&ov._bitmapFonts[oo]){var oT=ov._bitmapFonts[oo];or&&oT.destroy(),delete ov._bitmapFonts[oo]}},ov.setTextRightToLeft=function(){var oo;(oo=oe.canvas.source.style).display="none",oo.position="absolute",oo.direction="rtl",oC._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,oe.document.body.appendChild(oe.canvas.source)},ov.supportFont=function(oo){oe.context.font="10px sans-serif";var or=oe.context.measureText("abcji").width;oe.context.font="10px "+oo;var oT=oe.context.measureText("abcji").width;return console.log(or,oT),or!==oT},ov._testWord="游",ov.langPacks=null,ov.VISIBLE="visible",ov.SCROLL="scroll",ov.HIDDEN="hidden",ov.CharacterCache=!0,ov.RightToLeft=!1,ov._bitmapFonts=null,oL(ov,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),ov}(opo),oKo=function(op){function on(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",on.__super.call(this),this.offset=new oF,this._canvasTransform=new os,this._previousOrientation=oe.window.orientation;var or=this;this.transform=os.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var oo=oe.window,oT=this;oo.addEventListener("focus",function(){or._isFocused=!0,oT.event("focus"),oT.event("focuschange")}),oo.addEventListener("blur",function(){or._isFocused=!1,oT.event("blur"),oT.event("focuschange"),oT._isInputting()&&(oSo.inputElement.target.focus=!1)});var ok="visibilityState",oW="visibilitychange",oD=oo.document;void 0!==oD.hidden?(oW="visibilitychange",ok="visibilityState"):void 0!==oD.mozHidden?(oW="mozvisibilitychange",ok="mozVisibilityState"):void 0!==oD.msHidden?(oW="msvisibilitychange",ok="msVisibilityState"):void 0!==oD.webkitHidden&&(oW="webkitvisibilitychange",ok="webkitVisibilityState"),oo.document.addEventListener(oW,function(){"hidden"==oe.document[ok]?oT._setStageVisible(!1):oT._setStageVisible(!0)}),oo.document.addEventListener("qbrowserVisibilityChange",function(oo){oT._setStageVisible(!oo.hidden)}),oo.addEventListener("resize",function(){var oo=oe.window.orientation;null!=oo&&oo!=or._previousOrientation&&oT._isInputting()&&(oSo.inputElement.target.focus=!1),or._previousOrientation=oo,oT._isInputting()||oT._resetCanvas()}),oo.addEventListener("orientationchange",function(oo){oT._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),oe.onMobile&&this.on("mousedown",this,this._onmouseMove)}oj(on,"laya.display.Stage",op);var oo=on.prototype;return oo._setStageVisible=function(oo){this._isVisibility!=oo&&(this._isVisibility=oo,this._isVisibility||this._isInputting()&&(oSo.inputElement.target.focus=!1),this.event("visibilitychange"))},oo._isInputting=function(){return oe.onMobile&&oSo.isInputting},oo._changeCanvasSize=function(){this.setScreenSize(oe.clientWidth*oe.pixelRatio,oe.clientHeight*oe.pixelRatio)},oo._resetCanvas=function(){if(this.screenAdaptationEnabled){var oo=oC._mainCanvas;oo.source.style;oo.size(1,1),ob.timer.once(100,this,this._changeCanvasSize)}},oo.setScreenSize=function(oo,or){var oT=!1;if("none"!==this._screenMode&&(oT=(oo/or<1?"vertical":"horizontal")!==this._screenMode)){var ok=or;or=oo,oo=ok}this.canvasRotation=oT;var oW=oC._mainCanvas,oD=oW.source.style,on=this._canvasTransform.identity(),oV=this._scaleMode,oL=oo/this.designWidth,oU=or/this.designHeight,oh=this.designWidth,op=this.designHeight,oi=oo,ov=or,ox=oe.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,oV){case"noscale":oL=oU=1,oi=this.designWidth,ov=this.designHeight;break;case"showall":oL=oU=Math.min(oL,oU),oh=oi=Math.round(this.designWidth*oL),op=ov=Math.round(this.designHeight*oU);break;case"noborder":oL=oU=Math.max(oL,oU),oi=Math.round(this.designWidth*oL),ov=Math.round(this.designHeight*oU);break;case"full":oL=oU=1,this._width=oh=oo,this._height=op=or;break;case"fixedwidth":oU=oL,this._height=op=Math.round(or/oL);break;case"fixedheight":oL=oU,this._width=oh=Math.round(oo/oU);break;case"fixedauto":oo/or<this.designWidth/this.designHeight?(oU=oL,this._height=op=Math.round(or/oL)):(oL=oU,this._width=oh=Math.round(oo/oU))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,oh=oh+1&2147483646,op=op+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),oL*=this.scaleX,oU*=this.scaleY,1===oL&&1===oU?this.transform.identity():(this.transform.a=this._formatData(oL/(oi/oh)),this.transform.d=this._formatData(oU/(ov/op)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),oW.size(oh,op),ou.changeWebGLSize(oh,op),on.scale(oi/oh/ox,ov/op/ox),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(oo-oi)/ox:this.offset.x=.5*(oo-oi)/ox,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(or-ov)/ox:this.offset.y=.5*(or-ov)/ox,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),on.translate(this.offset.x,this.offset.y),this.canvasDegree=0,oT&&("horizontal"===this._screenMode?(on.rotate(Math.PI/2),on.translate(or/ox,0),this.canvasDegree=90):(on.rotate(-Math.PI/2),on.translate(0,oo/ox),this.canvasDegree=-90)),on.a=this._formatData(on.a),on.d=this._formatData(on.d),on.tx=this._formatData(on.tx),on.ty=this._formatData(on.ty),oD.transformOrigin=oD.webkitTransformOrigin=oD.msTransformOrigin=oD.mozTransformOrigin=oD.oTransformOrigin="0px 0px 0px",oD.transform=oD.webkitTransform=oD.msTransform=oD.mozTransform=oD.oTransform="matrix("+on.toString()+")",on.translate(parseInt(oD.left)||0,parseInt(oD.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},oo._formatData=function(oo){return Math.abs(oo)<1e-6?0:Math.abs(1-oo)<.001?0<oo?1:-1:oo},oo.getMousePoint=function(){return oF.TEMP.setTo(this.mouseX,this.mouseY)},oo.repaint=function(){this._repaint=1},oo.parentRepaint=function(){},oo._loop=function(){return this.render(oC.context,0,0),!0},oo._onmouseMove=function(oo){this._mouseMoveTime=oe.now()},oo.getTimeFromFrameStart=function(){return oe.now()-this._frameStartTime},oo.render=function(oo,or,oT){if("sleep"===this._frameRate&&!oC.isConchApp){var ok=oe.now();if(!(1e3<=ok-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(ow.loopCount++,ox.instance.runEvent(),ob.timer._update()));this._frameStartTime=ok}if(this._renderCount++,oC.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=oe.now();var oW="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),oD=this._renderCount%2==0;if(ow.renderSlow=!oW,oW||oD||oC.isConchApp){var on;ow.loopCount++,ox.instance.runEvent(),ob.timer._update(),ou.update3DLoop();var oV=0,oL=0;if(oC.isConchNode)for(oV=0,oL=this._scenes.length;oV<oL;oV++)(on=this._scenes[oV])&&on._updateSceneConch();else for(oV=0,oL=this._scenes.length;oV<oL;oV++)(on=this._scenes[oV])&&on._updateScene();if(oC.isConchNode){var oU=opo.CustomList;for(oV=0,oL=oU.length;oV<oL;oV++){var oh=oU[oV];oh.customRender(oh.customContext,0,0)}return}}oC.isConchNode||this.renderingEnabled&&(oW||!oD||oC.isConchWebGL)&&(oC.isWebGL?oC.WebGL.mainContext&&!oC.WebGL.mainContext.isContextLost()&&(oo.clear(),op.prototype.render.call(this,oo,or,oT),ow._show&&ow._sp&&ow._sp.render(oo,or,oT),ou.clear(this._bgColor),ou.beginFlush(),oo.flush(),ou.endFinish(),oB.instance&&oB.getInstance().endDispose()):(ou.clear(this._bgColor),op.prototype.render.call(this,oo,or,oT),ow._show&&ow._sp&&ow._sp.render(oo,or,oT)))}else this._renderCount%5==0&&(ow.loopCount++,ox.instance.runEvent(),ob.timer._update())},oo._requestFullscreen=function(){var oo=oe.document.documentElement;oo.requestFullscreen?oo.requestFullscreen():oo.mozRequestFullScreen?oo.mozRequestFullScreen():oo.webkitRequestFullscreen?oo.webkitRequestFullscreen():oo.msRequestFullscreen&&oo.msRequestFullscreen()},oo._fullScreenChanged=function(){ob.stage.event("fullscreenchange")},oo.exitFullscreen=function(){var oo=oe.document;oo.exitFullscreen?oo.exitFullscreen():oo.mozCancelFullScreen?oo.mozCancelFullScreen():oo.webkitExitFullscreen&&oo.webkitExitFullscreen()},oh(0,oo,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),oh(0,oo,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),oh(0,oo,"frameRate",function(){return this._frameRate},function(oo){if(this._frameRate=oo,oC.isConchApp)switch(this._frameRate){case"slow":oe.window.conch&&oe.window.conchConfig.setSlowFrame&&oe.window.conchConfig.setSlowFrame(!0);break;case"fast":oe.window.conch&&oe.window.conchConfig.setSlowFrame&&oe.window.conchConfig.setSlowFrame(!1);break;case"mouse":oe.window.conch&&oe.window.conchConfig.setMouseFrame&&oe.window.conchConfig.setMouseFrame(2e3);break;case"sleep":oe.window.conch&&oe.window.conchConfig.setLimitFPS&&oe.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),oh(0,oo,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),oh(0,oo,"width",op.prototype._$get_width,function(oo){this.designWidth=oo,ob.superSet(opo,this,"width",oo),ob.timer.callLater(this,this._changeCanvasSize)}),oh(0,oo,"alignH",function(){return this._alignH},function(oo){this._alignH=oo,ob.timer.callLater(this,this._changeCanvasSize)}),oh(0,oo,"isFocused",function(){return this._isFocused}),oh(0,oo,"height",op.prototype._$get_height,function(oo){this.designHeight=oo,ob.superSet(opo,this,"height",oo),ob.timer.callLater(this,this._changeCanvasSize)}),oh(0,oo,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||os.create()},op.prototype._$set_transform),oh(0,oo,"isVisibility",function(){return this._isVisibility}),oh(0,oo,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),oh(0,oo,"scaleMode",function(){return this._scaleMode},function(oo){this._scaleMode=oo,ob.timer.callLater(this,this._changeCanvasSize)}),oh(0,oo,"alignV",function(){return this._alignV},function(oo){this._alignV=oo,ob.timer.callLater(this,this._changeCanvasSize)}),oh(0,oo,"bgColor",function(){return this._bgColor},function(oo){this._bgColor=oo,this.conchModel&&this.conchModel.bgColor(oo),oC.isWebGL&&(oo?on._wgColor=oI.create(oo)._color:oe.onMiniGame||(on._wgColor=null)),oe.onLimixiu?on._wgColor=oI.create(oo)._color:oC.canvas.style.background=oo||"none"}),oh(0,oo,"mouseX",function(){return Math.round(ox.instance.mouseX/this.clientScaleX)}),oh(0,oo,"mouseY",function(){return Math.round(ox.instance.mouseY/this.clientScaleY)}),oh(0,oo,"screenMode",function(){return this._screenMode},function(oo){this._screenMode=oo}),oh(0,oo,"visible",op.prototype._$get_visible,function(oo){this.visible!==oo&&(ob.superSet(opo,this,"visible",oo),oC._mainCanvas.source.style.visibility=oo?"visible":"hidden")}),oh(0,oo,"fullScreenEnabled",null,function(oo){var or=oe.document,oT=oC.canvas;oo?(oT.addEventListener("mousedown",this._requestFullscreen),oT.addEventListener("touchstart",this._requestFullscreen),or.addEventListener("fullscreenchange",this._fullScreenChanged),or.addEventListener("mozfullscreenchange",this._fullScreenChanged),or.addEventListener("webkitfullscreenchange",this._fullScreenChanged),or.addEventListener("msfullscreenchange",this._fullScreenChanged)):(oT.removeEventListener("mousedown",this._requestFullscreen),oT.removeEventListener("touchstart",this._requestFullscreen),or.removeEventListener("fullscreenchange",this._fullScreenChanged),or.removeEventListener("mozfullscreenchange",this._fullScreenChanged),or.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),or.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),on.SCALE_NOSCALE="noscale",on.SCALE_EXACTFIT="exactfit",on.SCALE_SHOWALL="showall",on.SCALE_NOBORDER="noborder",on.SCALE_FULL="full",on.SCALE_FIXED_WIDTH="fixedwidth",on.SCALE_FIXED_HEIGHT="fixedheight",on.SCALE_FIXED_AUTO="fixedauto",on.ALIGN_LEFT="left",on.ALIGN_RIGHT="right",on.ALIGN_CENTER="center",on.ALIGN_TOP="top",on.ALIGN_MIDDLE="middle",on.ALIGN_BOTTOM="bottom",on.SCREEN_NONE="none",on.SCREEN_HORIZONTAL="horizontal",on.SCREEN_VERTICAL="vertical",on.FRAME_FAST="fast",on.FRAME_SLOW="slow",on.FRAME_MOUSE="mouse",on.FRAME_SLEEP="sleep",on.FRAME_MOUSE_THREDHOLD=2e3,oL(on,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),on}(opo),o$o=(function(oo){function or(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,or.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}oj(or,"laya.media.SoundNode",opo);var oT=or.prototype;oT._onParentChange=function(){this.target=this.parent},oT.play=function(oo,or){void 0===oo&&(oo=1),isNaN(oo)&&(oo=1),this.url&&(this.stop(),this._channel=oR.playSound(this.url,oo,null,or))},oT.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},oT._setPlayAction=function(oo,or,oT,ok){void 0===ok&&(ok=!0),this[oT]&&oo&&(ok?oo.on(or,this,this[oT]):oo.off(or,this,this[oT]))},oT._setPlayActions=function(oo,or,oT,ok){if(void 0===ok&&(ok=!0),oo&&or){var oW,oD=or.split(","),on=0;for(oW=oD.length,on=0;on<oW;on++)this._setPlayAction(oo,oD[on],oT,ok)}},oh(0,oT,"playEvent",null,function(oo){(this._playEvents=oo)&&this._tar&&this._setPlayActions(this._tar,oo,"play")}),oh(0,oT,"target",null,function(oo){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=oo,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),oh(0,oT,"stopEvent",null,function(oo){(this._stopEvents=oo)&&this._tar&&this._setPlayActions(this._tar,oo,"stop")})}(),function(oo){function or(){this._src=null,this._onload=null,this._onerror=null,or.__super.call(this)}oj(or,"laya.resource.FileBitmap",oxo);var oT=or.prototype;return oh(0,oT,"src",function(){return this._src},function(oo){this._src=oo}),oh(0,oT,"onload",null,function(oo){}),oh(0,oT,"onerror",null,function(oo){}),or}()),oyo=function(oo){function oT(oo,or){this._is2D=!1,oT.__super.call(this);var ok=this;if(this._source=this,"2D"===oo||"AUTO"===oo&&!oC.isWebGL){this._is2D=!0,this._source=or||oe.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var oW=this;oW.getContext=function(oo,or){if(ok._ctx)return ok._ctx;var oT=ok._ctx=ok._source.getContext(oo,or);return oT&&(oT._canvas=oW,oC.isFlash||oe.onLimixiu||(oT.size=function(oo,or){})),oT}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}oj(oT,"laya.resource.HTMLCanvas",oxo);var or=oT.prototype;return or.clear=function(){this._ctx&&this._ctx.clear()},or.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},or.release=function(){},or._setContext=function(oo){this._ctx=oo},or.getContext=function(oo,or){return this._ctx?this._ctx:this._ctx=oT._createContext(this)},or.getMemSize=function(){return 0},or.size=function(oo,or){(this._w!=oo||this._h!=or||this._source&&(this._source.width!=oo||this._source.height!=or))&&(this._w=oo,this._h=or,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(oo,or),this._source&&(this._source.height=or,this._source.width=oo))},or.getCanvas=function(){return this._source},or.toBase64=function(oo,or,oT){if(this._source)if(oC.isConchApp&&this._source.toBase64)this._source.toBase64(oo,or,oT);else{var ok=this._source.toDataURL(oo,or);oT.call(this,ok)}},oh(0,or,"context",function(){return this._ctx}),oh(0,or,"asBitmap",null,function(oo){}),oT.create=function(oo,or){return new oT(oo,or)},oT.TYPE2D="2D",oT.TYPE3D="3D",oT.TYPEAUTO="AUTO",oT._createContext=null,oT}(),olo=(function(oo){function oL(oo,or,oT,ok,oW,oD,on,oV){throw oL.__super.call(this),new Error("不允许new！")}oj(oL,"laya.resource.HTMLSubImage",oxo),oL.create=function(oo,or,oT,ok,oW,oD,on,oV){return void 0===oV&&(oV=!1),new oL(oo,or,oT,ok,oW,oD,on,oV)}}(),function(oo){function op(){this._frames=null,this._url=null,op.__super.call(this),this._setControlNode(this)}oj(op,"laya.display.Animation",oo);var or=op.prototype;or.destroy=function(oo){void 0===oo&&(oo=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,oo),this._frames=null,this._labels=null},or.play=function(oo,or,oT,ok){void 0===oo&&(oo=0),void 0===or&&(or=!0),void 0===oT&&(oT=""),void 0===ok&&(ok=!0),oT&&this._setFramesFromCache(oT,ok),this._isPlaying=!0,this.index="string"==typeof oo?this._getFrameByLabel(oo):oo,this.loop=or,this._actionName=oT,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},or._setFramesFromCache=function(oo,or){var oT;return void 0===or&&(or=!1),this._url&&(oo=this._url+"#"+oo),oo&&op.framesMap[oo]?((oT=op.framesMap[oo])instanceof Array?(this._frames=op.framesMap[oo],this._count=this._frames.length):(oT.nodeRoot&&(op.framesMap[oo]=this._parseGraphicAnimationByData(oT),oT=op.framesMap[oo]),this._frames=oT.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=oT.interval),this._labels=this._copyLabels(oT.labels)),!0):(or&&console.log("ani not found:",oo),!1)},or._copyLabels=function(oo){if(!oo)return null;var or,oT;for(oT in or={},oo)or[oT]=og.copyArray([],oo[oT]);return or},or._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&oo.prototype._frameLoop.call(this)},or._displayToIndex=function(oo){this._frames&&(this.graphics=this._frames[oo])},or.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},or.loadImages=function(oo,or){return void 0===or&&(or=""),this._url="",this._setFramesFromCache(or)||(this.frames=op.framesMap[or]?op.framesMap[or]:op.createFrames(oo,or)),this},or.loadAtlas=function(or,oT,ok){void 0===ok&&(ok=""),this._url="";var oW=this;function oo(oo){or===oo&&(oW.frames=op.framesMap[ok]?op.framesMap[ok]:op.createFrames(or,ok),oT&&oT.run())}return oW._setFramesFromCache(ok)||(oVo.getAtlas(or)?oo(or):ob.loader.load(or,o$.create(null,oo,[or]),null,"atlas")),this},or.loadAnimation=function(oo,or,oT){this._url=oo;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,or&&or.run()):!oT||oVo.getAtlas(oT)?this._loadAnimationData(oo,or,oT):ob.loader.load(oT,o$.create(this,this._loadAnimationData,[oo,or,oT]),null,"atlas"),this},or._loadAnimationData=function(oV,oL,oo){var oU=this;if(!oo||oVo.getAtlas(oo)){var oh=this;oVo.getRes(oV)?or(oV):ob.loader.load(oV,o$.create(null,or,[oV]),null,"json"),oVo.clearRes(oV)}else console.warn("atlas load fail:"+oo);function or(oo){if(oVo.getRes(oo)&&oV===oo){var or;if(op.framesMap[oV+"#"])oh._setFramesFromCache(oU._actionName,!0),oU.index=0,oU._checkResumePlaying();else{var oT=oh._parseGraphicAnimation(oVo.getRes(oV));if(!oT)return;var ok,oW=oT.animationList,oD=0,on=oW.length;for(oD=0;oD<on;oD++)or=oW[oD],op.framesMap[oV+"#"+or.name]=or,ok||(ok=or);ok&&(op.framesMap[oV+"#"]=ok,oh._setFramesFromCache(oU._actionName,!0),oU.index=0),oU._checkResumePlaying()}oL&&oL.run()}}},or._parseGraphicAnimation=function(oo){return obo.parseAnimationData(oo)},or._parseGraphicAnimationByData=function(oo){return obo.parseAnimationByData(oo)},oh(0,or,"frames",function(){return this._frames},function(oo){(this._frames=oo)&&(this._count=oo.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),oh(0,or,"autoPlay",null,function(oo){oo?this.play():this.stop()}),oh(0,or,"source",null,function(oo){-1<oo.indexOf(".ani")?this.loadAnimation(oo):-1<oo.indexOf(".json")||-1<oo.indexOf("als")||-1<oo.indexOf("atlas")?this.loadAtlas(oo):this.loadImages(oo.split(","))}),oh(0,or,"autoAnimation",null,function(oo){this.play(0,!0,oo,!1)}),op.createFrames=function(oo,or){var oT,ok,oW=0,oD=0;if("string"==typeof oo){var on=oVo.getAtlas(oo);if(on&&on.length)for(oT=[],oW=0,oD=on.length;oW<oD;oW++)(ok=new ou.createGraphics).drawTexture(oVo.getRes(on[oW]),0,0),oT.push(ok)}else if(oo instanceof Array)for(oT=[],oW=0,oD=oo.length;oW<oD;oW++)(ok=new ou.createGraphics).loadImage(oo[oW],0,0),oT.push(ok);return or&&(op.framesMap[or]=oT),oT},op.clearCache=function(oo){var or,oT=op.framesMap,ok=oo+"#";for(or in oT)or!==oo&&0!=or.indexOf(ok)||delete op.framesMap[or]},op.framesMap={}}(ojo),function(oo){function oD(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,oD.__super.call(this),null==oD._sortIndexFun&&(oD._sortIndexFun=oq.sortByKey("index",!1,!0))}oj(oD,"laya.display.FrameAnimation",oo);var or=oD.prototype;return or._setUp=function(oo,or){this._labels=null,this._animationNewFrames=null,this._targetDic=oo,this._animationData=or,this.interval=1e3/or.frameRate,or.parsed?(this._count=or.count,this._labels=or.labels,this._animationNewFrames=or.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),or.parsed=!0,or.labels=this._labels,or.count=this._count,or.animationNewFrames=this._animationNewFrames},or.clear=function(){oo.prototype.clear.call(this),this._targetDic=null,this._animationData=null},or._displayToIndex=function(oo){if(this._animationData){oo<0&&(oo=0),oo>this._count&&(oo=this._count);var or=this._animationData.nodes,oT=0,ok=or.length;for(oT=0;oT<ok;oT++)this._displayNodeToFrame(or[oT],oo)}},or._displayNodeToFrame=function(oo,or,oT){oT||(oT=this._targetDic);var ok=oT[oo.target];if(ok){var oW,oD,on,oV=oo.frames,oL=oo.keys,oU=0,oh=oL.length;for(oU=0;oU<oh;oU++)on=(oD=oV[oW=oL[oU]]).length>or?oD[or]:oD[oD.length-1],ok[oW]=on}},or._calculateDatas=function(){if(this._animationData){var oo,or=this._animationData.nodes,oT=0,ok=or.length;for(oT=this._count=0;oT<ok;oT++)oo=or[oT],this._calculateNodeKeyFrames(oo);this._count+=1}},or._calculateNodeKeyFrames=function(oo){var or,oT,ok=oo.keyframes,oW=oo.target;for(or in oo.frames||(oo.frames={}),oo.keys?oo.keys.length=0:oo.keys=[],oo.initValues||(oo.initValues={}),ok)oT=ok[or],oo.frames[or]||(oo.frames[or]=[]),this._targetDic&&this._targetDic[oW]&&(oo.initValues[or]=this._targetDic[oW][or]),oT.sort(oD._sortIndexFun),oo.keys.push(or),this._calculateNodePropFrames(oT,oo.frames[or],or,oW)},or.resetToInitState=function(){if(this._targetDic&&this._animationData){var oo,or,oT=this._animationData.nodes,ok=0,oW=oT.length;for(ok=0;ok<oW;ok++)if(or=(oo=oT[ok]).initValues){var oD,on=this._targetDic[oo.target];if(on)for(oD in or)on[oD]=or[oD]}}},or._calculateNodePropFrames=function(oo,or,oT,ok){var oW=0,oD=oo.length-1;if(0<oD){for(or.length=oo[oD].index+1,oW=0;oW<oD;oW++)this._dealKeyFrame(oo[oW]),this._calculateFrameValues(oo[oW],oo[oW+1],or);this._dealKeyFrame(oo[oW])}0==oD&&(or[oo[0].index]=oo[0].value,this._animationNewFrames&&(this._animationNewFrames[oo[0].index]=!0))},or._dealKeyFrame=function(oo){oo.label&&""!=oo.label&&this.addLabel(oo.label,oo.index)},or._calculateFrameValues=function(oo,or,oT){var ok,oW=0,oD=oo.index,on=or.index,oV=oo.value,oL=or.value-oo.value,oU=on-oD;if(on>this._count&&(this._count=on),oo.tween)for(null==(ok=of[oo.tweenMethod])&&(ok=of.linearNone),oW=oD;oW<on;oW++)oT[oW]=ok(oW-oD,oV,oL,oU),this._animationNewFrames&&(this._animationNewFrames[oW]=!0);else for(oW=oD;oW<on;oW++)oT[oW]=oV;this._animationNewFrames&&(this._animationNewFrames[oo.index]=!0,this._animationNewFrames[or.index]=!0),oT[or.index]=or.value},oD._sortIndexFun=null,oD}(ojo)),oSo=function(or){function oW(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",oW.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=o_o.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}oj(oW,"laya.display.Input",or);var oo=oW.prototype;return oo.setSelection=function(oo,or){this.focus=!0,laya.display.Input.inputElement.selectionStart=oo,laya.display.Input.inputElement.selectionEnd=or},oo._onUnDisplay=function(oo){this.focus=!1},oo._onMouseDown=function(oo){this.focus=!0},oo._syncInputTransform=function(){var oo=this.nativeInput,or=og.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),oT=this._width-this.padding[1]-this.padding[3],ok=this._height-this.padding[0]-this.padding[2];oC.isConchApp?(oo.setScale(or.scaleX,or.scaleY),oo.setSize(oT,ok),oo.setPos(or.x,or.y)):(oW.inputContainer.style.transform=oW.inputContainer.style.webkitTransform="scale("+or.scaleX+","+or.scaleY+") rotate("+ob.stage.canvasDegree+"deg)",oo.style.width=oT+"px",oo.style.height=ok+"px",oW.inputContainer.style.left=or.x+"px",oW.inputContainer.style.top=or.y+"px")},oo.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},oo._setInputMethod=function(){oW.input.parentElement&&oW.inputContainer.removeChild(oW.input),oW.area.parentElement&&oW.inputContainer.removeChild(oW.area),oW.inputElement=this._multiline?oW.area:oW.input,oW.inputContainer.appendChild(oW.inputElement),o_o.RightToLeft&&(oW.inputElement.style.direction="rtl")},oo._focusIn=function(){laya.display.Input.isInputting=!0;var oo=this.nativeInput;this._focus=!0;var or=oo.style;or.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),oo.readOnly=!this._editable,oC.isConchApp&&(oo.setType(this._type),oo.setForbidEdit(!this._editable)),oo.maxLength=this._maxChars;this.padding;if(oo.type=this._type,oo.value=this._content,oo.placeholder=this._prompt,ob.stage.off("keydown",this,this._onKeyDown),ob.stage.on("keydown",this,this._onKeyDown),(ob.stage.focus=this).event("focus"),oe.onPC&&oo.focus(),!oe.onMiniGame){this._text;this._text=null}this.typeset(),oo.setColor(this._originColor),oo.setFontSize(this.fontSize),oo.setFontFace(oe.onIPhone&&o_o._fontFamilyMap[this.font]||this.font),oC.isConchApp&&oo.setMultiAble&&oo.setMultiAble(this._multiline),or.lineHeight=this.leading+this.fontSize+"px",or.fontStyle=this.italic?"italic":"normal",or.fontWeight=this.bold?"bold":"normal",or.textAlign=this.align,or.padding="0 0",this._syncInputTransform(),!oC.isConchApp&&oe.onPC&&ob.timer.frameLoop(1,this,this._syncInputTransform)},oo._setPromptColor=function(){(oW.promptStyleDOM=oe.getElementById("promptStyle"))||((oW.promptStyleDOM=oe.createElement("style")).setAttribute("id","promptStyle"),oe.document.head.appendChild(oW.promptStyleDOM)),oW.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},oo._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(ob.superSet(o_o,this,"text",this._content),ob.superSet(o_o,this,"color",this._originColor)):(ob.superSet(o_o,this,"text",this._prompt),ob.superSet(o_o,this,"color",this._promptColor)),ob.stage.off("keydown",this,this._onKeyDown),ob.stage.focus=null,this.event("blur"),oC.isConchApp&&this.nativeInput.blur(),oe.onPC&&ob.timer.clear(this,this._syncInputTransform)},oo._onKeyDown=function(oo){13===oo.keyCode&&(oe.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},oo.changeText=function(oo){this._content=oo,this._focus?(this.nativeInput.value=oo||"",this.event("change")):or.prototype.changeText.call(this,oo)},oh(0,oo,"color",or.prototype._$get_color,function(oo){this._focus&&this.nativeInput.setColor(oo),ob.superSet(o_o,this,"color",this._content?oo:this._promptColor),this._originColor=oo}),oh(0,oo,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(oo){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),oh(0,oo,"multiline",function(){return this._multiline},function(oo){this._multiline=oo,this.valign=oo?"top":"middle"}),oh(0,oo,"maxChars",function(){return this._maxChars},function(oo){oo<=0&&(oo=1e5),this._maxChars=oo}),oh(0,oo,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(oo){ob.superSet(o_o,this,"color",this._originColor),oo+="",this._focus?(this.nativeInput.value=oo||"",this.event("change")):(this._multiline||(oo=oo.replace(/\r?\n/g,"")),(this._content=oo)?ob.superSet(o_o,this,"text",oo):(ob.superSet(o_o,this,"text",this._prompt),ob.superSet(o_o,this,"color",this.promptColor)))}),oh(0,oo,"nativeInput",function(){return this._multiline?oW.area:oW.input}),oh(0,oo,"prompt",function(){return this._prompt},function(oo){!this._text&&oo&&ob.superSet(o_o,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?ob.superSet(o_o,this,"text",this._text==this._prompt?oo:this._text):ob.superSet(o_o,this,"text",oo),this._prompt=o_o.langPacks&&o_o.langPacks[oo]?o_o.langPacks[oo]:oo}),oh(0,oo,"focus",function(){return this._focus},function(oo){var or=this.nativeInput;this._focus!==oo&&(oo?(or.target?or.target._focusOut():this._setInputMethod(),(or.target=this)._focusIn()):(or.target=null,this._focusOut(),oe.document.body.scrollTop=0,or.blur(),oC.isConchApp?or.setPos(-1e4,-1e4):oW.inputContainer.contains(or)&&oW.inputContainer.removeChild(or)))}),oh(0,oo,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(oo){oo?(-1<(oo="[^"+oo+"]").indexOf("^^")&&(oo=oo.replace("^^","")),this._restrictPattern=new RegExp(oo,"g")):this._restrictPattern=null}),oh(0,oo,"editable",function(){return this._editable},function(oo){this._editable=oo,oC.isConchApp&&oW.input.setForbidEdit(!oo)}),oh(0,oo,"promptColor",function(){return this._promptColor},function(oo){this._promptColor=oo,this._content||ob.superSet(o_o,this,"color",oo)}),oh(0,oo,"type",function(){return this._type},function(oo){this._getCSSStyle().password="password"==oo,this._type=oo,oC.isConchApp&&this.nativeInput.setType(oo)}),oh(0,oo,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(oo){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),oh(0,oo,"asPassword",function(){return this._getCSSStyle().password},function(oo){this._getCSSStyle().password=oo,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),oW.__init__=function(){oW._createInputElement(),oe.onMobile&&oC.canvas.addEventListener(oW.IOS_IFRAME?oe.onMiniGame?"touchend":"click":"touchend",oW._popupInputMethod)},oW._popupInputMethod=function(oo){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},oW._createInputElement=function(){oW._initInput(oW.area=oe.createElement("textarea")),oW._initInput(oW.input=oe.createElement("input")),(oW.inputContainer=oe.createElement("div")).style.position="absolute",oW.inputContainer.style.zIndex=1e5,oe.container.appendChild(oW.inputContainer),oW.inputContainer.setPos=function(oo,or){oW.inputContainer.style.left=oo+"px",oW.inputContainer.style.top=or+"px"}},oW._initInput=function(or){var oo=or.style;oo.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",oo.resize="none",oo.backgroundColor="transparent",oo.border="none",oo.outline="none",oo.zIndex=1,or.addEventListener("input",oW._processInputting),or.addEventListener("mousemove",oW._stopEvent),or.addEventListener("mousedown",oW._stopEvent),or.addEventListener("touchmove",oW._stopEvent),or.setFontFace=function(oo){or.style.fontFamily=oo},oC.isConchApp||(or.setColor=function(oo){or.style.color=oo},or.setFontSize=function(oo){or.style.fontSize=oo+"px"})},oW._processInputting=function(oo){var or=laya.display.Input.inputElement.target;if(or){var oT=laya.display.Input.inputElement.value;or._restrictPattern&&(oT=oT.replace(/\u2006|\x27/g,""),or._restrictPattern.test(oT)&&(oT=oT.replace(or._restrictPattern,""),laya.display.Input.inputElement.value=oT)),or._text=oT,or.event("input")}},oW._stopEvent=function(oo){"touchmove"==oo.type&&oo.preventDefault(),oo.stopPropagation&&oo.stopPropagation()},oW.TYPE_TEXT="text",oW.TYPE_PASSWORD="password",oW.TYPE_EMAIL="email",oW.TYPE_URL="url",oW.TYPE_NUMBER="number",oW.TYPE_RANGE="range",oW.TYPE_DATE="date",oW.TYPE_MONTH="month",oW.TYPE_WEEK="week",oW.TYPE_TIME="time",oW.TYPE_DATE_TIME="datetime",oW.TYPE_DATE_TIME_LOCAL="datetime-local",oW.TYPE_SEARCH="search",oW.input=null,oW.area=null,oW.inputElement=null,oW.inputContainer=null,oW.confirmButton=null,oW.promptStyleDOM=null,oW.inputHeight=45,oW.isInputting=!1,oW.stageMatrix=null,oL(oW,["IOS_IFRAME",function(){return this.IOS_IFRAME=oe.onIOS&&oe.window.top!=oe.window.self}]),oW}(o_o),oqo=function(oo){function oT(oo,or){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,oT.__super.call(this),oo&&this._init_(oo,or)}oj(oT,"laya.resource.HTMLImage",o$o);var or=oT.prototype;return or._init_=function(oo,or){this._src=oo,this._source=new oe.window.Image,or&&(or.onload&&(this.onload=or.onload),or.onerror&&(this.onerror=or.onerror),or.onCreate&&or.onCreate(this)),0!=oo.indexOf("data:image")&&(this._source.crossOrigin=""),oo&&(this._source.src=oo)},or.recreateResource=function(){var oo=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var or=this;this._source=new oe.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(or._needReleaseAgain)return or._needReleaseAgain=!1,or._source.onload=null,void(or._source=null);or._source.onload=null,or.memorySize=oo._w*oo._h*4,or._recreateLock=!1,or.completeCreate()},this._source.src=this._src}},or.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},or.onresize=function(){this._w=this._source.width,this._h=this._source.height},oh(0,or,"onload",null,function(oo){var or=this;this._onload=oo,this._source&&(this._source.onload=null!=this._onload?function(){or.onresize(),or._onload()}:null)}),oh(0,or,"onerror",null,function(oo){var or=this;this._onerror=oo,this._source&&(this._source.onerror=null!=this._onerror?function(){or._onerror()}:null)}),oh(0,or,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(oo){this._enableMerageInAtlas=oo,oC.isConchApp&&this._source&&(this._source.enableMerageInAtlas=oo)}),oT.create=function(oo,or){return new oT(oo,or)},oT}(),obo=(function(oD){function oo(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,oo.__super.call(this)}oj(oo,"laya.display.EffectAnimation",oD);var or=oo.prototype;or._onOtherBegin=function(oo){oo!=this&&this.stop()},or.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},or._onPlayAction=function(){this.play(0,!1)},or.play=function(oo,or,oT,ok){void 0===oo&&(oo=0),void 0===or&&(or=!0),void 0===oT&&(oT=""),void 0===ok&&(ok=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,oo,or,oT,ok))},or._recordInitData=function(){if(this._aniKeys){var oo,or,oT=0;for(oo=this._aniKeys.length,oT=0;oT<oo;oT++)or=this._aniKeys[oT],this._initData[or]=this._target[or]}},or._displayToIndex=function(oo){if(this._animationData){oo<0&&(oo=0),oo>this._count&&(oo=this._count);var or=this._animationData.nodes,oT=0,ok=or.length;for(ok=1<ok?1:ok,oT=0;oT<ok;oT++)this._displayNodeToFrame(or[oT],oo)}},or._displayNodeToFrame=function(oo,or,oT){if(this._target){var ok;ok=this._target;var oW,oD,on,oV,oL=oo.frames,oU=oo.keys,oh=0,op=oU.length;oV=oo.secondFrames;var oi,ov,ox,oj,o_=0;for(oh=0;oh<op;oh++)oD=oL[oW=oU[oh]],on=-1==(o_=oV[oW])?this._initData[oW]:or<o_?(ox=(ov=oo.keyframes[oW])[0]).tween?(null==(oi=of[ox.tweenMethod])&&(oi=of.linearNone),oj=ov[1],oi(or,this._initData[oW],oj.value-this._initData[oW],oj.index)):this._initData[oW]:oD.length>or?oD[or]:oD[oD.length-1],ok[oW]=on}},or._calculateNodeKeyFrames=function(oo){oD.prototype._calculateNodeKeyFrames.call(this,oo);var or,oT,ok,oW=oo.keyframes;oo.target;for(or in ok={},oo.secondFrames=ok,oW)(oT=oW[or]).length<=1?ok[or]=-1:ok[or]=oT[1].index},oh(0,or,"target",function(){return this._target},function(oo){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=oo,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),oh(0,or,"playEvent",null,function(oo){(this._playEvents=oo)&&this.addEvent()}),oh(0,or,"effectData",null,function(oo){var or;oo&&((or=oo.animations)&&or[0]&&(this._setUp({},or[0]),or[0].nodes&&or[0].nodes[0]&&(this._aniKeys=or[0].nodes[0].keys)))}),oh(0,or,"effectClass",null,function(oo){var or,oT;(this._effectClass=oA.getClass(oo),this._effectClass)&&((or=this._effectClass.uiView)&&(oT=or.animations)&&oT[0]&&(this._setUp({},oT[0]),oT[0].nodes&&oT[0].nodes[0]&&(this._aniKeys=oT[0].nodes[0].keys)))}),oo.EffectAnimationBegin="effectanimationbegin"}(olo),function(or){var oH;function oR(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,oR.__super.call(this)}oj(oR,"laya.utils.GraphicAnimation",or);var oo=oR.prototype;return oo._parseNodeList=function(oo){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[oo.compId]=oo.props,oo.compId&&this._nodeList.push(oo.compId);var or=oo.child;if(or){var oT=0,ok=or.length;for(oT=0;oT<ok;oT++)this._parseNodeList(or[oT])}},oo._calGraphicData=function(oo){var or;if(this._setUp(null,oo),this._createGraphicData(),this._nodeIDAniDic)for(or in this._nodeIDAniDic)this._nodeIDAniDic[or]=null},oo._createGraphicData=function(){var oo,or=[],oT=0,ok=this.count,oW=this._animationNewFrames;for(oW||(oW=[]),oT=0;oT<ok;oT++)!oW[oT]&&oo||(oo=this._createFrameGraphic(oT)),or.push(oo);this._gList=or},oo._createFrameGraphic=function(oo){var or=ou.createGraphics();return oR._rootMatrix||(oR._rootMatrix=new os),this._updateNodeGraphic(this._rootNode,oo,oR._rootMatrix,or),or},oo._updateNodeGraphic=function(oo,or,oT,ok,oW){var oD;void 0===oW&&(oW=1);var on,oV,oL,oU=(oD=this._nodeGDic[oo.compId]=this._getNodeGraphicData(oo.compId,or,this._nodeGDic[oo.compId])).alpha*oW;if(!(oU<.01)&&(oD.resultTransform||(oD.resultTransform=os.create()),on=oD.resultTransform,os.mul(oD.transform,oT,on),oD.skin&&(oV=this._getTextureByUrl(oD.skin))&&(on._checkTransform()?(ok.drawTexture(oV,0,0,oD.width,oD.height,on,oU),oD.resultTransform=null):ok.drawTexture(oV,on.tx,on.ty,oD.width,oD.height,null,oU)),oL=oo.child)){var oh,op=0;for(oh=oL.length,op=0;op<oh;op++)this._updateNodeGraphic(oL[op],or,on,ok,oU)}},oo._updateNoChilds=function(oo,or){if(oo.skin){var oT=this._getTextureByUrl(oo.skin);if(oT){var ok=oo.transform;ok._checkTransform();!ok.bTransform?or.drawTexture(oT,ok.tx,ok.ty,oo.width,oo.height,null,oo.alpha):or.drawTexture(oT,0,0,oo.width,oo.height,ok.clone(),oo.alpha)}}},oo._updateNodeGraphic2=function(oo,or,oT){var ok;if(ok=this._nodeGDic[oo.compId]=this._getNodeGraphicData(oo.compId,or,this._nodeGDic[oo.compId]),oo.child){var oW=ok.transform;oW._checkTransform();var oD,on;on=(oD=!oW.bTransform)&&(0!=oW.tx||0!=oW.ty);var oV,oL,oU;if((oV=oW.bTransform||1!=ok.alpha)&&oT.save(),1!=ok.alpha&&oT.alpha(ok.alpha),oD?on&&oT.translate(oW.tx,oW.ty):oT.transform(oW.clone()),oL=oo.child,ok.skin&&(oU=this._getTextureByUrl(ok.skin))&&oT.drawTexture(oU,0,0,ok.width,ok.height),oL){var oh,op=0;for(oh=oL.length,op=0;op<oh;op++)this._updateNodeGraphic2(oL[op],or,oT)}oV?oT.restore():oD?on&&oT.translate(-oW.tx,-oW.ty):oT.transform(oW.clone().invert())}else this._updateNoChilds(ok,oT)},oo._calculateNodeKeyFrames=function(oo){or.prototype._calculateNodeKeyFrames.call(this,oo),this._nodeIDAniDic[oo.target]=oo},oo.getNodeDataByID=function(oo){return this._nodeIDAniDic[oo]},oo._getParams=function(oo,or,oT,ok){var oW=oR._temParam;oW.length=or.length;var oD=0,on=or.length;for(oD=0;oD<on;oD++)oW[oD]=this._getObjVar(oo,or[oD][0],oT,or[oD][1],ok);return oW},oo._getObjVar=function(oo,or,oT,ok,oW){if(oo.hasOwnProperty(or)){var oD=oo[or];if(oT>=oD.length&&(oT=oD.length-1),null!=oo[or][oT])return oo[or][oT]}return oW.hasOwnProperty(or)?oW[or]:ok},oo._getNodeGraphicData=function(oo,or,oT){oT||(oT=oH.create()),oT.transform?oT.transform.identity():oT.transform=os.create();var ok=this.getNodeDataByID(oo);if(!ok)return oT;var oW,oD,on=ok.frames,oV=this._getParams(on,oR._drawTextureCmd,or,this._nodeDefaultProps[oo]),oL=oV[0],oU=NaN,oh=NaN,op=oV[5],oi=oV[6],ov=oV[13],ox=oV[14],oj=oV[7],o_=oV[8],oK=oV[9],o$=oV[11],oy=oV[12];oU=oV[3],oh=oV[4],0!=oU&&0!=oh||(oL=null),-1==oU&&(oU=0),-1==oh&&(oh=0),oT.skin=oL,oT.width=oU,oT.height=oh,oL&&((oW=this._getTextureByUrl(oL))?(oU||(oU=oW.sourceWidth),oh||(oh=oW.sourceHeight)):console.warn("lost skin:",oL,",you may load pics first")),oT.alpha=oV[10],oD=oT.transform,0!=ov&&(op=ov*oU),0!=ox&&(oi=ox*oh),0==op&&0==oi||oD.translate(-op,-oi);var ol=null;if(oK||1!==oj||1!==o_||o$||oy){(ol=oR._tempMt).identity(),ol.bTransform=!0;var oS=.0174532922222222*(oK-o$),oq=.0174532922222222*(oK+oy),ob=Math.cos(oq),oF=Math.sin(oq),oP=Math.sin(oS),ot=Math.cos(oS);ol.a=oj*ob,ol.b=oj*oF,ol.c=-o_*oP,ol.d=o_*ot,ol.tx=ol.ty=0}return ol&&(oD=os.mul(oD,ol,oD)),oD.translate(oV[1],oV[2]),oT},oo._getTextureByUrl=function(oo){return oVo.getRes(oo)},oo.setAniData=function(oo,or){if(oo.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=oo,this._parseNodeList(oo);var oT,ok={},oW=[],oD=oo.animations,on=0,oV=oD.length;for(on=0;on<oV;on++)if(oT=oD[on],this._labels=null,(!or||or==oT.name)&&oT){try{this._calGraphicData(oT)}catch(oo){console.warn("parse animation fail:"+oT.name+",empty animation created"),this._gList=[]}var oL={};oL.interval=1e3/oT.frameRate,oL.frames=this._gList,oL.labels=this._labels,oL.name=oT.name,oW.push(oL),ok[oT.name]=oL}this.animationList=oW,this.animationDic=ok}oR._temParam.length=0},oo.parseByData=function(oo){var or,oT;or=oo.nodeRoot,oT=oo.aniO,delete oo.nodeRoot,delete oo.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=or,this._parseNodeList(or),this._labels=null;try{this._calGraphicData(oT)}catch(oo){console.warn("parse animation fail:"+oT.name+",empty animation created"),this._gList=[]}var ok=oo;return ok.interval=1e3/oT.frameRate,ok.frames=this._gList,ok.labels=this._labels,ok.name=oT.name,ok},oo.setUpAniData=function(oo){if(oo.animations){var or,oT={},ok=[],oW=oo.animations,oD=0,on=oW.length;for(oD=0;oD<on;oD++)if(or=oW[oD]){var oV={};oV.name=or.name,oV.aniO=or,oV.nodeRoot=oo,ok.push(oV),oT[or.name]=oV}this.animationList=ok,this.animationDic=oT}},oo._clear=function(){var oo,or;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(oo in this._nodeGDic)(or=this._nodeGDic[oo])&&or.recover();this._nodeGDic=null},oR.parseAnimationByData=function(oo){var or;return oR._I||(oR._I=new oR),or=oR._I.parseByData(oo),oR._I._clear(),or},oR.parseAnimationData=function(oo){var or;return oR._I||(oR._I=new oR),oR._I.setUpAniData(oo),(or={}).animationList=oR._I.animationList,or.animationDic=oR._I.animationDic,oR._I._clear(),or},oR._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],oR._temParam=[],oR._I=null,oR._rootMatrix=null,oL(oR,["_tempMt",function(){return this._tempMt=new os}]),oR.__init$=function(){oH=function(){function oo(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return oj(oo,""),oo.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),oG.recover("GraphicNode",this)},oo.create=function(){return oG.getItemByClass("GraphicNode",oo)},oo}()},oR}(olo));ob.__init([oU,oLo,oC,oe,oZ,ot,oo,obo])}(window,document,Laya),function(oo,or,oT){oT.un,oT.uns,oT.static;var ok=oT.class;oT.getset,oT.__newvec;new(function(){function oo(){}return ok(oo,"LayaMain"),oo}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(oo,or){"use strict";for(var oT in Object.defineProperty(or,"__esModule",{value:!0}),Laya){var ok=Laya[oT];ok&&ok.__isclass&&(or[oT]=ok)}}),function(oo,or,oq){oq.un,oq.uns;var on=oq.static,oi=oq.class,ok=oq.getset,oD=oq.__newvec,oh=laya.maths.Arith,op=laya.maths.Bezier,oT=laya.resource.Bitmap,ov=laya.utils.Browser,oL=laya.utils.Byte,ox=laya.utils.Color,ob=(laya.filters.ColorFilter,oq.Config),oW=laya.resource.Context,oF=(laya.events.Event,laya.filters.Filter),oV=laya.display.Graphics,oU=laya.resource.HTMLCanvas,oj=(laya.utils.HTMLChar,laya.resource.HTMLImage),o_=laya.resource.HTMLSubImage,oP=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),ot=laya.maths.Point,oH=laya.maths.Rectangle,oK=laya.renders.Render,o$=(laya.renders.RenderContext,laya.renders.RenderSprite),oy=laya.resource.Resource,ol=laya.resource.ResourceManager,oS=laya.utils.RunDriver,oR=laya.display.Sprite,ou=laya.display.Stage,os=laya.utils.Stat,oz=laya.utils.StringKey,om=(laya.display.css.Style,laya.system.System),oC=laya.display.Text,oX=laya.resource.Texture,oO=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),oM=laya.utils.VectorGraphManager;laya.utils.WordText;oq.interface("laya.webgl.shapes.IShape"),oq.interface("laya.webgl.submit.ISubmit"),oq.interface("laya.webgl.text.ICharSegment"),oq.interface("laya.webgl.canvas.save.ISaveData"),oq.interface("laya.webgl.resource.IMergeAtlasBitmap"),oq.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var oc=function(){function oo(){}oi(oo,"laya.filters.webgl.FilterActionGL");var or=oo.prototype;return oq.imps(or,{"laya.filters.IFilterActionGL":!0}),or.setValue=function(oo){},or.setValueMix=function(oo){},or.apply3d=function(oo,or,oT,ok,oW){return null},or.apply=function(oo){return null},ok(0,or,"typeMix",function(){return 0}),oo}(),oe=function(){function oo(){}return oi(oo,"laya.webgl.shader.ShaderValue"),oo}(),oJ=function(){var ok,oW;function oo(oo,or,oT){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new oW,void 0===oo&&(oo=0),void 0===or&&(or=0),void 0===oT&&(oT=0),this._cells=null,this._rowInfo=null,this._init(oo,or),this._atlasID=oT}oi(oo,"laya.webgl.atlas.AtlasGrid");var or=oo.prototype;return or.getAltasID=function(){return this._atlasID},or.setAltasID=function(oo){0<=oo&&(this._atlasID=oo)},or.addTex=function(oo,or,oT){var ok=this._get(or,oT);return 0==ok.ret||(this._fill(ok.x,ok.y,or,oT,oo),this._texCount++),ok},or._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},or._init=function(oo,or){if(this._width=oo,this._height=or,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=oD(this._height);for(var oT=0;oT<this._height;oT++)this._rowInfo[oT]=new ok;return this._clear(),!0},or._get=function(oo,or){var oT=new oA;if(oo>=this._failSize.width&&or>=this._failSize.height)return oT;for(var ok=-1,oW=-1,oD=this._width,on=this._height,oV=this._cells,oL=0;oL<on;oL++)if(!(this._rowInfo[oL].spaceCount<oo))for(var oU=0;oU<oD;){var oh=3*(oL*oD+oU);if(0!=oV[oh]||oV[1+oh]<oo||oV[2+oh]<or)oU+=oV[1+oh];else{ok=oU,oW=oL;for(var op=0;op<oo;op++)if(oV[3*op+oh+2]<or){ok=-1;break}if(!(ok<0))return oT.ret=!0,oT.x=ok,oT.y=oW,oT;oU+=oV[1+oh]}}return oT},or._fill=function(oo,or,oT,ok,oW){var oD=this._width,on=this._height;this._check(oo+oT<=oD&&or+ok<=on);for(var oV=or;oV<ok+or;++oV){this._check(this._rowInfo[oV].spaceCount>=oT),this._rowInfo[oV].spaceCount-=oT;for(var oL=0;oL<oT;oL++){var oU=3*(oo+oV*oD+oL);this._check(0==this._cells[oU]),this._cells[oU]=oW,this._cells[1+oU]=oT,this._cells[2+oU]=ok}}if(0<oo)for(oV=0;oV<ok;++oV){var oh=0;for(oL=oo-1;0<=oL&&0==this._cells[3*((or+oV)*oD+oL)];--oL,++oh);for(oL=oh;0<oL;--oL)this._cells[3*((or+oV)*oD+oo-oL)+1]=oL,this._check(0<oL)}if(0<or)for(oL=oo;oL<oo+oT;++oL){for(oh=0,oV=or-1;0<=oV&&0==this._cells[3*(oL+oV*oD)];--oV,oh++);for(oV=oh;0<oV;--oV)this._cells[3*(oL+(or-oV)*oD)+2]=oV,this._check(0<oV)}},or._check=function(oo){0==oo&&console.log("xtexMerger 错误啦")},or._clear=function(){for(var oo=this._texCount=0;oo<this._height;oo++)this._rowInfo[oo].spaceCount=this._width;for(var or=0;or<this._height;or++)for(var oT=0;oT<this._width;oT++){var ok=3*(or*this._width+oT);this._cells[ok]=0,this._cells[1+ok]=this._width-oT,this._cells[2+ok]=this._width-or}this._failSize.width=this._width+1,this._failSize.height=this._height+1},oo.__init$=function(){ok=function(){function oo(){this.spaceCount=0}return oi(oo,""),oo}(),oW=function(){function oo(){this.width=0,this.height=0}return oi(oo,""),oo}()},oo}(),oY=function(){function oK(oo,or,oT,ok){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=oo,this._height=or,this._gridSize=oT,this._maxAtlaserCount=ok,this._gridNumX=oo/oT,this._gridNumY=or/oT,this._curAtlasIndex=0,this._atlaserArray=[]}oi(oK,"laya.webgl.atlas.AtlasResourceManager");var oo=oK.prototype;return oo.setAtlasParam=function(oo,or,oT,ok){if(1==this._setAtlasParam)return oK._sid_=0,this._width=oo,this._height=or,this._gridSize=oT,this._maxAtlaserCount=ok,this._gridNumX=oo/oT,this._gridNumY=or/oT,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},oo.pushData=function(oo){var or,oT=oo.bitmap,ok=-1,oW=null,oD=0,on=0;for(oD=0,or=this._atlaserArray.length;oD<or&&(on=(this._curAtlasIndex+oD)%or,-1==(ok=(oW=this._atlaserArray[on]).findBitmapIsExist(oT)));oD++);if(-1!=ok){var oV=oW.InAtlasWebGLImagesOffsetValue[ok];return ox=oV[0],oj=oV[1],oW.addToAtlas(oo,ox,oj),!0}this._setAtlasParam=!1;for(var oL=Math.ceil((oo.bitmap.width+2)/this._gridSize),oU=Math.ceil((oo.bitmap.height+2)/this._gridSize),oh=!1,op=0;op<2;op++){var oi=this._maxAtlaserCount;for(oD=0;oD<oi;oD++){on=(this._curAtlasIndex+oD)%oi,this._atlaserArray.length-1>=on||this._atlaserArray.push(new oHo(this._gridNumX,this._gridNumY,this._width,this._height,oK._sid_++));var ov=this._atlaserArray[on],ox=0,oj=0,o_=ov.addTex(1,oL,oU);if(o_.ret){ox=o_.x*this._gridSize+1,oj=o_.y*this._gridSize+1,oT.lock=!0,ov.addToAtlasTexture(oT,ox,oj),ov.addToAtlas(oo,ox,oj),oh=!0,this._curAtlasIndex=on;break}}if(oh)break;this._atlaserArray.push(new oHo(this._gridNumX,this._gridNumY,this._width,this._height,oK._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return oh||console.log(">>>AtlasManager pushData error"),oh},oo.addToAtlas=function(oo){laya.webgl.atlas.AtlasResourceManager.instance.pushData(oo)},oo.garbageCollection=function(){if(!0===this._needGC){for(var oo=this._atlaserArray.length-this._maxAtlaserCount,or=0;or<oo;or++)this._atlaserArray[or].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+oo),this._atlaserArray.splice(0,oo),this._needGC=!1}return!0},oo.freeAll=function(){for(var oo=0,or=this._atlaserArray.length;oo<or;oo++)this._atlaserArray[oo].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},oo.getAtlaserCount=function(){return this._atlaserArray.length},oo.getAtlaserByIndex=function(oo){return this._atlaserArray[oo]},ok(1,oK,"instance",function(){return oK._Instance||(oK._Instance=new oK(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),oK._Instance}),ok(1,oK,"enabled",function(){return ob.atlasEnable}),ok(1,oK,"atlasLimitWidth",function(){return oK._atlasLimitWidth},function(oo){oK._atlasLimitWidth=oo}),ok(1,oK,"atlasLimitHeight",function(){return oK._atlasLimitHeight},function(oo){oK._atlasLimitHeight=oo}),oK._enable=function(){ob.atlasEnable=!0},oK._disable=function(){ob.atlasEnable=!1},oK.__init__=function(){oK.atlasTextureWidth=2048,oK.atlasTextureHeight=2048,oK.maxTextureCount=6,oK.atlasLimitWidth=512,oK.atlasLimitHeight=512},oK._atlasLimitWidth=0,oK._atlasLimitHeight=0,oK.gridSize=16,oK.atlasTextureWidth=0,oK.atlasTextureHeight=0,oK.maxTextureCount=0,oK._atlasRestore=0,oK.BOARDER_TYPE_NO=0,oK.BOARDER_TYPE_RIGHT=1,oK.BOARDER_TYPE_LEFT=2,oK.BOARDER_TYPE_BOTTOM=4,oK.BOARDER_TYPE_TOP=8,oK.BOARDER_TYPE_ALL=15,oK._sid_=0,oK._Instance=null,oK}(),oA=function(){function oo(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return oi(oo,"laya.webgl.atlas.MergeFillInfo"),oo}(),oI=function(){function or(){}return oi(or,"laya.webgl.canvas.BlendMode"),or._init_=function(oo){or.fns=[or.BlendNormal,or.BlendAdd,or.BlendMultiply,or.BlendScreen,or.BlendOverlay,or.BlendLight,or.BlendMask,or.BlendDestinationOut],or.targetFns=[or.BlendNormalTarget,or.BlendAddTarget,or.BlendMultiplyTarget,or.BlendScreenTarget,or.BlendOverlayTarget,or.BlendLightTarget,or.BlendMask,or.BlendDestinationOut]},or.BlendNormal=function(oo){oo.blendFunc(1,771)},or.BlendAdd=function(oo){oo.blendFunc(1,772)},or.BlendMultiply=function(oo){oo.blendFunc(774,771)},or.BlendScreen=function(oo){oo.blendFunc(1,1)},or.BlendOverlay=function(oo){oo.blendFunc(1,769)},or.BlendLight=function(oo){oo.blendFunc(1,1)},or.BlendNormalTarget=function(oo){oo.blendFunc(1,771)},or.BlendAddTarget=function(oo){oo.blendFunc(1,772)},or.BlendMultiplyTarget=function(oo){oo.blendFunc(774,771)},or.BlendScreenTarget=function(oo){oo.blendFunc(1,1)},or.BlendOverlayTarget=function(oo){oo.blendFunc(1,769)},or.BlendLightTarget=function(oo){oo.blendFunc(1,1)},or.BlendMask=function(oo){oo.blendFunc(0,770)},or.BlendDestinationOut=function(oo){oo.blendFunc(0,0)},or.activeBlendFunction=null,or.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],or.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},or.NORMAL="normal",or.ADD="add",or.MULTIPLY="multiply",or.SCREEN="screen",or.LIGHT="light",or.OVERLAY="overlay",or.DESTINATIONOUT="destination-out",or.fns=[],or.targetFns=[],or}(),oN=function(){function oT(oo){this._color=ox.create("black"),this.setValue(oo)}oi(oT,"laya.webgl.canvas.DrawStyle");var oo=oT.prototype;return oo.setValue=function(oo){if(oo){if("string"==typeof oo)return void(this._color=ox.create(oo));if(oo instanceof laya.utils.Color)return void(this._color=oo)}},oo.reset=function(){this._color=ox.create("black")},oo.equal=function(oo){return"string"==typeof oo?this._color.strColor===oo:oo instanceof laya.utils.Color&&this._color.numColor===oo.numColor},oo.toColorStr=function(){return this._color.strColor},oT.create=function(oo){var or;if(oo&&("string"==typeof oo?or=ox.create(oo):oo instanceof laya.utils.Color&&(or=oo),or))return or._drawStyle||(or._drawStyle=new oT(oo));return laya.webgl.canvas.DrawStyle.DEFAULT},on(oT,["DEFAULT",function(){return this.DEFAULT=new oT("#000000")}]),oT}(),of=function(){function oo(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];olo.mainContext;this.ib=oEo.create(35048),this.vb=odo.create(5)}oi(oo,"laya.webgl.canvas.Path");var or=oo.prototype;return or.addPoint=function(oo,or){this.tempArray.push(oo,or)},or.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},or.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},or.polygon=function(oo,or,oT,ok,oW,oD){var on;return this.geomatrys.push(this._curGeomatry=on=new ozo(oo,or,oT,ok,oW,oD)),ok||(on.fill=!1),null==oD&&(on.borderWidth=0),on},or.setGeomtry=function(oo){this.geomatrys.push(this._curGeomatry=oo)},or.drawLine=function(oo,or,oT,ok,oW){var oD;return this.closePath?this.geomatrys.push(this._curGeomatry=oD=new oso(oo,or,oT,ok,oW)):this.geomatrys.push(this._curGeomatry=oD=new ouo(oo,or,oT,ok,oW)),oD.fill=!1,oD},or.update=function(){var oo=this.ib._byteLength,or=this.geomatrys.length;this.offset=oo;for(var oT=this.geoStart;oT<or;oT++)this.geomatrys[oT].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=or,this.count=(this.ib._byteLength-oo)/ojo.BYTES_PIDX},or.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},or.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},oo}(),oa=function(){function oV(){}oi(oV,"laya.webgl.canvas.save.SaveBase");var oo=oV.prototype;return oq.imps(oo,{"laya.webgl.canvas.save.ISaveData":!0}),oo.isSaveMark=function(){return!1},oo.restore=function(oo){this._dataObj[this._valueName]=this._value,(oV._cache[oV._cache._length++]=this)._newSubmit&&(oo._curSubmit=oDo.RENDERBASE,oo._renderKey=0)},oV._createArray=function(){var oo=[];return oo._length=0,oo},oV._init=function(){var oo=oV._namemap={};return oo[1]="ALPHA",oo[2]="fillStyle",oo[8]="font",oo[256]="lineWidth",oo[512]="strokeStyle",oo[8192]="_mergeID",oo[1024]=oo[2048]=oo[4096]=[],oo[16384]="textBaseline",oo[32768]="textAlign",oo[65536]="_nBlendType",oo[1048576]="shader",oo[2097152]="filters",oo},oV.save=function(oo,or,oT,ok){if((oo._saveMark._saveuse&or)!==or){oo._saveMark._saveuse|=or;var oW=oV._cache,oD=0<oW._length?oW[--oW._length]:new oV;oD._value=oT[oD._valueName=oV._namemap[or]],oD._dataObj=oT,oD._newSubmit=ok;var on=oo._save;on[on._length++]=oD}},oV._cache=laya.webgl.canvas.save.SaveBase._createArray(),oV._namemap=oV._init(),oV}(),oG=function(){function oD(){this._clipRect=new oH}oi(oD,"laya.webgl.canvas.save.SaveClipRect");var oo=oD.prototype;return oq.imps(oo,{"laya.webgl.canvas.save.ISaveData":!0}),oo.isSaveMark=function(){return!1},oo.restore=function(oo){oo._clipRect=this._clipSaveRect,(oD._cache[oD._cache._length++]=this)._submitScissor.submitLength=oo._submits._length-this._submitScissor.submitIndex,oo._curSubmit=oDo.RENDERBASE,oo._renderKey=0},oD.save=function(oo,or){if(131072!=(131072&oo._saveMark._saveuse)){oo._saveMark._saveuse|=131072;var oT=oD._cache,ok=0<oT._length?oT[--oT._length]:new oD;ok._clipSaveRect=oo._clipRect,oo._clipRect=ok._clipRect.copyFrom(oo._clipRect),ok._submitScissor=or;var oW=oo._save;oW[oW._length++]=ok}},on(oD,["_cache",function(){return this._cache=oa._createArray()}]),oD}(),ow=function(){function ov(){this._contextX=0,this._contextY=0,this._clipRect=new oH,this._rect=new oH,this._matrix=new oP}oi(ov,"laya.webgl.canvas.save.SaveClipRectStencil");var oo=ov.prototype;return oq.imps(oo,{"laya.webgl.canvas.save.ISaveData":!0}),oo.isSaveMark=function(){return!1},oo.restore=function(oo){oho.restore(oo,this._rect,this._saveMatrix,this._contextX,this._contextY),oo._clipRect=this._clipSaveRect,oo._curMat=this._saveMatrix,oo._x=this._contextX,oo._y=this._contextY,ov._cache[ov._cache._length++]=this,oo._curSubmit=oDo.RENDERBASE},ov.save=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){if(262144!=(262144&oo._saveMark._saveuse)){oo._saveMark._saveuse|=262144;var oh=ov._cache,op=0<oh._length?oh[--oh._length]:new ov;op._clipSaveRect=oo._clipRect,op._clipRect.setTo(on,oV,oL,oU),oo._clipRect=op._clipRect,op._rect.x=oT,op._rect.y=ok,op._rect.width=oW,op._rect.height=oD,op._contextX=oo._x,op._contextY=oo._y,op._saveMatrix=oo._curMat,oo._curMat.copyTo(op._matrix),oo._curMat=op._matrix,op._submitStencil=or;var oi=oo._save;oi[oi._length++]=op}},on(ov,["_cache",function(){return this._cache=oa._createArray()}]),ov}(),oZ=function(){function ok(){this._saveuse=0}oi(ok,"laya.webgl.canvas.save.SaveMark");var oo=ok.prototype;return oq.imps(oo,{"laya.webgl.canvas.save.ISaveData":!0}),oo.isSaveMark=function(){return!0},oo.restore=function(oo){oo._saveMark=this._preSaveMark,ok._no[ok._no._length++]=this},ok.Create=function(oo){var or=ok._no,oT=0<or._length?or[--or._length]:new ok;return oT._saveuse=0,oT._preSaveMark=oo._saveMark,oo._saveMark=oT},on(ok,["_no",function(){return this._no=oa._createArray()}]),ok}(),oQ=function(){function oD(){this._matrix=new oP}oi(oD,"laya.webgl.canvas.save.SaveTransform");var oo=oD.prototype;return oq.imps(oo,{"laya.webgl.canvas.save.ISaveData":!0}),oo.isSaveMark=function(){return!1},oo.restore=function(oo){oo._curMat=this._savematrix,oD._no[oD._no._length++]=this},oD.save=function(oo){var or=oo._saveMark;if(2048!=(2048&or._saveuse)){or._saveuse|=2048;var oT=oD._no,ok=0<oT._length?oT[--oT._length]:new oD;ok._savematrix=oo._curMat,oo._curMat=oo._curMat.copyTo(ok._matrix);var oW=oo._save;oW[oW._length++]=ok}},on(oD,["_no",function(){return this._no=oa._createArray()}]),oD}(),og=function(){function oW(){}oi(oW,"laya.webgl.canvas.save.SaveTranslate");var oo=oW.prototype;return oq.imps(oo,{"laya.webgl.canvas.save.ISaveData":!0}),oo.isSaveMark=function(){return!1},oo.restore=function(oo){oo._curMat;oo._x=this._x,oo._y=this._y,oW._no[oW._no._length++]=this},oW.save=function(oo){var or=oW._no,oT=0<or._length?or[--or._length]:new oW;oT._x=oo._x,oT._y=oo._y;var ok=oo._save;ok[ok._length++]=oT},on(oW,["_no",function(){return this._no=oa._createArray()}]),oW}(),oB=function(){function oo(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new oH}oi(oo,"laya.webgl.resource.RenderTargetMAX");var or=oo.prototype;return or.setSP=function(oo){this._sp=oo},or.size=function(oo,or){var oT=this;this._width!==oo||this._height!==or?(this.repaint=!0,this._width=oo,this._height=or,this.target?this.target.size(oo,or):this.target=oMo.create(oo,or),this.target.hasListener("recovered")||this.target.on("recovered",this,function(oo){oq.timer.callLater(oT._sp,oT._sp.repaint)})):this.target.size(oo,or)},or._flushToTarget=function(oo,or){if(!or._destroy){var oT=o$o.worldScissorTest,ok=o$o.worldClipRect;o$o.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,o$o.worldScissorTest=!1,olo.mainContext.disable(3089);var oW=o$o.worldAlpha,oD=o$o.worldMatrix4,on=o$o.worldMatrix,oV=o$o.worldFilters,oL=o$o.worldShaderDefines;if(o$o.worldMatrix=oP.EMPTY,o$o.restoreTempArray(),o$o.worldMatrix4=o$o.TEMPMAT4_ARRAY,o$o.worldAlpha=1,o$o.worldFilters=null,o$o.worldShaderDefines=null,oOo.activeShader=null,or.start(),ob.showCanvasMark?or.clear(0,1,0,.3):or.clear(0,0,0,0),oo.flush(),or.end(),oOo.activeShader=null,o$o.worldAlpha=oW,o$o.worldMatrix4=oD,o$o.worldMatrix=on,o$o.worldFilters=oV,o$o.worldShaderDefines=oL,o$o.worldScissorTest=oT){var oU=o$o.height-ok.y-ok.height;olo.mainContext.scissor(ok.x,oU,ok.width,ok.height),olo.mainContext.enable(3089)}o$o.worldClipRect=ok}},or.flush=function(oo){this.repaint&&(this._flushToTarget(oo,this.target),this.repaint=!1)},or.drawTo=function(oo,or,oT,ok,oW){oo.drawTexture(this.target.getTexture(),or,oT,ok,oW,0,0)},or.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},oo}(),oE=function(){function oo(){this.ALPHA=1,this.shaderType=0,this.defines=new oRo}return oi(oo,"laya.webgl.shader.d2.Shader2D"),oo.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},oo.__init__=function(){var oo,or;oZo.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),oZo.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),oZo.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),oZo.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),oZo.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),oZo.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),oZo.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),oZo.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),oo="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",or='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',oZo.preCompile2D(0,1,oo,or,null),oo="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",or='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',oZo.preCompile2D(0,2,oo,or,null),oo="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",or="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",oZo.preCompile2D(0,4,oo,or,null),oo="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",or='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',oZo.preCompile2D(0,256,oo,or,null),oo="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",or="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",oZo.preCompile2D(0,512,oo,or,null)},oo}(),od=function(){function or(oo,or,oT){this._value=0,this._name2int=oo,this._int2name=or,this._int2nameMap=oT}oi(or,"laya.webgl.shader.ShaderDefines");var oo=or.prototype;return oo.add=function(oo){return"string"==typeof oo&&(oo=this._name2int[oo]),this._value|=oo,this._value},oo.addInt=function(oo){return this._value|=oo,this._value},oo.remove=function(oo){return"string"==typeof oo&&(oo=this._name2int[oo]),this._value&=~oo,this._value},oo.isDefine=function(oo){return(this._value&oo)===oo},oo.getValue=function(){return this._value},oo.setValue=function(oo){this._value=oo},oo.toNameDic=function(){var oo=this._int2nameMap[this._value];return oo||or._toText(this._value,this._int2name,this._int2nameMap)},or._reg=function(oo,or,oT,ok){ok[oT[oo]=or]=oo},or._toText=function(oo,or,oT){var ok=oT[oo];if(ok)return ok;for(var oW={},oD=1,on=0;on<32&&!(oo<(oD=1<<on));on++)if(oo&oD){var oV=or[oD];oV&&(oW[oV]="")}return oT[oo]=oW},or._toInt=function(oo,or){for(var oT=oo.split("."),ok=0,oW=0,oD=oT.length;oW<oD;oW++){var on=or[oT[oW]];if(!on)throw new Error("Defines to int err:"+oo+"/"+oT[oW]);ok|=on}return ok},or}(),ooo=function(){function on(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new oP}oi(on,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var oo=on.prototype;return oo.init=function(oo,or,oT){if(or)this._vs=or;else{this._vs=[];var ok=oo.width,oW=oo.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(ok,0,1,0,1,1,1,1),this._vs.push(ok,oW,1,1,1,1,1,1),this._vs.push(0,oW,0,1,1,1,1,1)}oT?this._ps=oT:(on._defaultPS||(on._defaultPS=[]).push(0,1,3,3,1,2),this._ps=on._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=oo},oo.init2=function(oo,or,oT,ok,oW){this.transform&&(this.transform=null),oT?this._ps=oT:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=ok,this._uvs=oW,this.mEleNum=this._ps.length,this.mTexture=oo,(oK.isConchNode||oK.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},oo._initMyData=function(){var oo=0,or=0,oT=4*this._verticles.length;this._vs=on._tempVS;var ok=!1;if(oK.isConchNode||oK.isConchApp?(this._vs.length=oT,ok=!0):this._vs.length<oT&&(this._vs.length=oT,ok=!0),on._tVSLen=oT,ok)for(;oo<oT;)this._vs[oo]=this._verticles[or],this._vs[oo+1]=this._verticles[or+1],this._vs[oo+2]=this._uvs[or],this._vs[oo+3]=this._uvs[or+1],this._vs[oo+4]=1,this._vs[oo+5]=1,this._vs[oo+6]=1,this._vs[oo+7]=1,oo+=8,or+=2;else for(;oo<oT;)this._vs[oo]=this._verticles[or],this._vs[oo+1]=this._verticles[or+1],this._vs[oo+2]=this._uvs[or],this._vs[oo+3]=this._uvs[or+1],oo+=8,or+=2},oo.getData2=function(oo,or,oT){var ok;this.mVBBuffer=oo,this.mIBBuffer=or,this._initMyData(),oo.appendEx2(this._vs,Float32Array,on._tVSLen,4),this._indexStart=or._byteLength,(ok=on._tempIB).length<this._ps.length&&(ok.length=this._ps.length);for(var oW=0,oD=this._ps.length;oW<oD;oW++)ok[oW]=this._ps[oW]+oT;or.appendEx2(ok,Uint16Array,this._ps.length,2)},oo.getData=function(oo,or,oT){if(this.mVBBuffer=oo,this.mIBBuffer=or,oo.append(this.mVBData),this._indexStart=or._byteLength,this.mIBData.start!=oT){for(var ok=0,oW=this._ps.length;ok<oW;ok++)this.mIBData[ok]=this._ps[ok]+oT;this.mIBData.start=oT}or.append(this.mIBData)},oo.render=function(oo,or,oT){if(oK.isWebGL&&this.mTexture){oo._renderKey=0,oo._shader2D.glTexture=null,oro.getInstance().addSkinMesh(this);var ok=oDo.createShape(oo,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,oFo.create(512,0));this.transform||(this.transform=oP.EMPTY),this.transform.translate(or,oT),oP.mul(this.transform,oo._curMat,this._tempMatrix),this.transform.translate(-or,-oT);var oW=ok.shaderValue,oD=oW.u_mmat2||o$o.getMatrArray();o$o.mat2MatArray(this._tempMatrix,oD),oW.textureHost=this.mTexture,oW.offsetX=0,oW.offsetY=0,oW.u_mmat2=oD,oW.ALPHA=oo._shader2D.ALPHA,oo._submits[oo._submits._length++]=ok}else oK.isConchApp&&this.mTexture&&(this.transform||(this.transform=oP.EMPTY),oo.setSkinMesh&&oo.setSkinMesh(or,oT,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},on._tempVS=[],on._tempIB=[],on._defaultPS=null,on._tVSLen=0,on}(),oro=function(){function oo(){this.ib=null,this.vb=null;olo.mainContext;this.ib=oEo.create(35048),this.vb=odo.create(8)}oi(oo,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var or=oo.prototype;return or.addSkinMesh=function(oo){oo.getData2(this.vb,this.ib,this.vb._byteLength/32)},or.reset=function(){this.vb.clear(),this.ib.clear()},oo.getInstance=function(){return oo.instance=oo.instance||new oo},oo.instance=null,oo}(),oTo=function(){function oo(oo,or,oT,ok,oW,oD,on,oV,oL){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===oL&&(oL=0),this.x=oo,this.y=or,this.width=oT,this.height=ok,this.edges=oW,this.color=oD,this.borderWidth=on,this.borderColor=oV}oi(oo,"laya.webgl.shapes.BasePoly");var or=oo.prototype;return oq.imps(or,{"laya.webgl.shapes.IShape":!0}),or.getData=function(oo,or,oT){},or.rebuild=function(oo){},or.setMatrix=function(oo){},or.needUpdate=function(oo){return!0},or.sector=function(oo,or,oT){var ok=this.x,oW=this.y,oD=this.edges,on=(this.r1-this.r0)/oD,oV=this.width,oL=this.height,oU=this.color,oh=(oU>>16&255)/255,op=(oU>>8&255)/255,oi=(255&oU)/255;oo.push(ok,oW,oh,op,oi);for(var ov=0;ov<oD+1;ov++)oo.push(ok+Math.sin(on*ov+this.r0)*oV,oW+Math.cos(on*ov+this.r0)*oL),oo.push(oh,op,oi);for(ov=0;ov<oD;ov++)or.push(oT,oT+ov+1,oT+ov+2)},or.createLine2=function(oo,or,oT,ok,oW,oD){var on,oV,oL,oU,oh,op,oi,ov,ox,oj,o_,oK,o$,oy,ol,oS,oq,ob,oF,oP,ot=oo.concat(),oH=oW,oR=this.borderColor,ou=(oR>>16&255)/255,os=(oR>>8&255)/255,oz=(255&oR)/255,om=ot.length/2,oC=ok,oX=oT/2;oL=ot[0],oU=ot[1],oj=oL-(oh=ot[2]),ox=(ox=-(oU-(op=ot[3])))/(oP=Math.sqrt(ox*ox+oj*oj))*oX,oj=oj/oP*oX,oH.push(oL-ox+this.x,oU-oj+this.y,ou,os,oz,oL+ox+this.x,oU+oj+this.y,ou,os,oz);for(var oO=1;oO<om-1;oO++)oL=ot[2*(oO-1)],oU=ot[2*(oO-1)+1],oh=ot[2*oO],op=ot[2*oO+1],oi=ot[2*(oO+1)],ov=ot[2*(oO+1)+1],oj=oL-oh,oK=oh-oi,ol=(-(ox=(ox=-(oU-op))/(oP=Math.sqrt(ox*ox+oj*oj))*oX)+oL)*(-(oj=oj/oP*oX)+op)-(-ox+oh)*(-oj+oU),ob=(-(o_=(o_=-(op-ov))/(oP=Math.sqrt(o_*o_+oK*oK))*oX)+oi)*(-(oK=oK/oP*oX)+op)-(-o_+oh)*(-oK+ov),oF=(o$=-oj+oU-(-oj+op))*(oq=-o_+oh-(-o_+oi))-(oS=-oK+ov-(-oK+op))*(oy=-ox+oh-(-ox+oL)),Math.abs(oF)<.1?(oF+=10.1,oH.push(oh-ox+this.x,op-oj+this.y,ou,os,oz,oh+ox+this.x,op+oj+this.y,ou,os,oz)):(((on=(oy*ob-oq*ol)/oF)-oh)*(on-oh)+((oV=(oS*ol-o$*ob)/oF)-op)+(oV-op),oH.push(on+this.x,oV+this.y,ou,os,oz,oh-(on-oh)+this.x,op-(oV-op)+this.y,ou,os,oz));oL=ot[ot.length-4],oU=ot[ot.length-3],oj=oL-(oh=ot[ot.length-2]),ox=(ox=-(oU-(op=ot[ot.length-1])))/(oP=Math.sqrt(ox*ox+oj*oj))*oX,oj=oj/oP*oX,oH.push(oh-ox+this.x,op-oj+this.y,ou,os,oz,oh+ox+this.x,op+oj+this.y,ou,os,oz);var oM=oD;for(oO=1;oO<oM;oO++)or.push(oC+2*(oO-1),oC+2*(oO-1)+1,oC+2*oO+1,oC+2*oO+1,oC+2*oO,oC+2*(oO-1));return oH},or.createLine=function(oo,or,oT,ok){var oW=oo.concat(),oD=oo,on=this.borderColor,oV=(on>>16&255)/255,oL=(on>>8&255)/255,oU=(255&on)/255;oW.splice(0,5);var oh,op,oi,ov,ox,oj,o_,oK,o$,oy,ol,oS,oq,ob,oF,oP,ot,oH,oR,ou,os=oW.length/5,oz=ok,om=oT/2;oi=oW[0],ov=oW[1],oy=oi-(ox=oW[5]),o$=(o$=-(ov-(oj=oW[6])))/(ou=Math.sqrt(o$*o$+oy*oy))*om,oy=oy/ou*om,oD.push(oi-o$,ov-oy,oV,oL,oU,oi+o$,ov+oy,oV,oL,oU);for(var oC=1;oC<os-1;oC++)oi=oW[5*(oC-1)],ov=oW[5*(oC-1)+1],ox=oW[5*oC],oj=oW[5*oC+1],o_=oW[5*(oC+1)],oK=oW[5*(oC+1)+1],oy=oi-ox,oS=ox-o_,oF=(-(o$=(o$=-(ov-oj))/(ou=Math.sqrt(o$*o$+oy*oy))*om)+oi)*(-(oy=oy/ou*om)+oj)-(-o$+ox)*(-oy+ov),oH=(-(ol=(ol=-(oj-oK))/(ou=Math.sqrt(ol*ol+oS*oS))*om)+o_)*(-(oS=oS/ou*om)+oj)-(-ol+ox)*(-oS+oK),oR=(oq=-oy+ov-(-oy+oj))*(ot=-ol+ox-(-ol+o_))-(oP=-oS+oK-(-oS+oj))*(ob=-o$+ox-(-o$+oi)),Math.abs(oR)<.1?(oR+=10.1,oD.push(ox-o$,oj-oy,oV,oL,oU,ox+o$,oj+oy,oV,oL,oU)):(((oh=(ob*oH-ot*oF)/oR)-ox)*(oh-ox)+((op=(oP*oF-oq*oH)/oR)-oj)+(op-oj),oD.push(oh,op,oV,oL,oU,ox-(oh-ox),oj-(op-oj),oV,oL,oU));oi=oW[oW.length-10],ov=oW[oW.length-9],oy=oi-(ox=oW[oW.length-5]),o$=(o$=-(ov-(oj=oW[oW.length-4])))/(ou=Math.sqrt(o$*o$+oy*oy))*om,oy=oy/ou*om,oD.push(ox-o$,oj-oy,oV,oL,oU,ox+o$,oj+oy,oV,oL,oU);var oX=this.edges+1;for(oC=1;oC<oX;oC++)or.push(oz+2*(oC-1),oz+2*(oC-1)+1,oz+2*oC+1,oz+2*oC+1,oz+2*oC,oz+2*(oC-1));return oD},or.createLoopLine=function(oo,or,oT,ok,oW,oD){var on=oo.concat(),oV=oW||oo,oL=this.borderColor,oU=(oL>>16&255)/255,oh=(oL>>8&255)/255,op=(255&oL)/255;on.splice(0,5);var oi=[on[0],on[1]],ov=[on[on.length-5],on[on.length-4]],ox=ov[0]+.5*(oi[0]-ov[0]),oj=ov[1]+.5*(oi[1]-ov[1]);on.unshift(ox,oj,0,0,0),on.push(ox,oj,0,0,0);var o_,oK,o$,oy,ol,oS,oq,ob,oF,oP,ot,oH,oR,ou,os,oz,om,oC,oX,oO,oM=on.length/5,oc=ok,oe=oT/2;o$=on[0],oy=on[1],oP=o$-(ol=on[5]),oF=(oF=-(oy-(oS=on[6])))/(oO=Math.sqrt(oF*oF+oP*oP))*oe,oP=oP/oO*oe,oV.push(o$-oF,oy-oP,oU,oh,op,o$+oF,oy+oP,oU,oh,op);for(var oJ=1;oJ<oM-1;oJ++)o$=on[5*(oJ-1)],oy=on[5*(oJ-1)+1],ol=on[5*oJ],oS=on[5*oJ+1],oq=on[5*(oJ+1)],ob=on[5*(oJ+1)+1],oP=o$-ol,oH=ol-oq,os=(-(oF=(oF=-(oy-oS))/(oO=Math.sqrt(oF*oF+oP*oP))*oe)+o$)*(-(oP=oP/oO*oe)+oS)-(-oF+ol)*(-oP+oy),oC=(-(ot=(ot=-(oS-ob))/(oO=Math.sqrt(ot*ot+oH*oH))*oe)+oq)*(-(oH=oH/oO*oe)+oS)-(-ot+ol)*(-oH+ob),oX=(oR=-oP+oy-(-oP+oS))*(om=-ot+ol-(-ot+oq))-(oz=-oH+ob-(-oH+oS))*(ou=-oF+ol-(-oF+o$)),Math.abs(oX)<.1?(oX+=10.1,oV.push(ol-oF,oS-oP,oU,oh,op,ol+oF,oS+oP,oU,oh,op)):(((o_=(ou*oC-om*os)/oX)-ol)*(o_-ol)+((oK=(oz*os-oR*oC)/oX)-oS)+(oK-oS),oV.push(o_,oK,oU,oh,op,ol-(o_-ol),oS-(oK-oS),oU,oh,op));oD&&(or=oD);var oY=this.edges+1;for(oJ=1;oJ<oY;oJ++)or.push(oc+2*(oJ-1),oc+2*(oJ-1)+1,oc+2*oJ+1,oc+2*oJ+1,oc+2*oJ,oc+2*(oJ-1));return or.push(oc+2*(oJ-1),oc+2*(oJ-1)+1,oc+1,oc+1,oc,oc+2*(oJ-1)),oV},oo}(),oko=function(){function oj(){}return oi(oj,"laya.webgl.shapes.Earcut"),oj.earcut=function(oo,or,oT){oT=oT||2;var ok,oW,oD,on,oV,oL,oU,oh=or&&or.length,op=oh?or[0]*oT:oo.length,oi=oj.linkedList(oo,0,op,oT,!0),ov=[];if(!oi)return ov;if(oh&&(oi=oj.eliminateHoles(oo,or,oi,oT)),oo.length>80*oT){ok=oD=oo[0],oW=on=oo[1];for(var ox=oT;ox<op;ox+=oT)(oV=oo[ox])<ok&&(ok=oV),(oL=oo[ox+1])<oW&&(oW=oL),oD<oV&&(oD=oV),on<oL&&(on=oL);oU=0!==(oU=Math.max(oD-ok,on-oW))?1/oU:0}return oj.earcutLinked(oi,ov,oT,ok,oW,oU),ov},oj.linkedList=function(oo,or,oT,ok,oW){var oD,on;if(oW===0<oj.signedArea(oo,or,oT,ok))for(oD=or;oD<oT;oD+=ok)on=oj.insertNode(oD,oo[oD],oo[oD+1],on);else for(oD=oT-ok;or<=oD;oD-=ok)on=oj.insertNode(oD,oo[oD],oo[oD+1],on);return on&&oj.equals(on,on.next)&&(oj.removeNode(on),on=on.next),on},oj.filterPoints=function(oo,or){if(!oo)return oo;or||(or=oo);var oT,ok=oo;do{if(oT=!1,ok.steiner||!oj.equals(ok,ok.next)&&0!==oj.area(ok.prev,ok,ok.next))ok=ok.next;else{if(oj.removeNode(ok),(ok=or=ok.prev)===ok.next)break;oT=!0}}while(oT||ok!==or);return or},oj.earcutLinked=function(oo,or,oT,ok,oW,oD,on){if(oo){!on&&oD&&oj.indexCurve(oo,ok,oW,oD);for(var oV,oL,oU=oo;oo.prev!==oo.next;)if(oV=oo.prev,oL=oo.next,oD?oj.isEarHashed(oo,ok,oW,oD):oj.isEar(oo))or.push(oV.i/oT),or.push(oo.i/oT),or.push(oL.i/oT),oj.removeNode(oo),oo=oL.next,oU=oL.next;else if((oo=oL)===oU){on?1===on?(oo=oj.cureLocalIntersections(oo,or,oT),oj.earcutLinked(oo,or,oT,ok,oW,oD,2)):2===on&&oj.splitEarcut(oo,or,oT,ok,oW,oD):oj.earcutLinked(oj.filterPoints(oo,null),or,oT,ok,oW,oD,1);break}}},oj.isEar=function(oo){var or=oo.prev,oT=oo,ok=oo.next;if(0<=oj.area(or,oT,ok))return!1;for(var oW=oo.next.next;oW!==oo.prev;){if(oj.pointInTriangle(or.x,or.y,oT.x,oT.y,ok.x,ok.y,oW.x,oW.y)&&0<=oj.area(oW.prev,oW,oW.next))return!1;oW=oW.next}return!0},oj.isEarHashed=function(oo,or,oT,ok){var oW=oo.prev,oD=oo,on=oo.next;if(0<=oj.area(oW,oD,on))return!1;for(var oV=oW.x<oD.x?oW.x<on.x?oW.x:on.x:oD.x<on.x?oD.x:on.x,oL=oW.y<oD.y?oW.y<on.y?oW.y:on.y:oD.y<on.y?oD.y:on.y,oU=oW.x>oD.x?oW.x>on.x?oW.x:on.x:oD.x>on.x?oD.x:on.x,oh=oW.y>oD.y?oW.y>on.y?oW.y:on.y:oD.y>on.y?oD.y:on.y,op=oj.zOrder(oV,oL,or,oT,ok),oi=oj.zOrder(oU,oh,or,oT,ok),ov=oo.nextZ;ov&&ov.z<=oi;){if(ov!==oo.prev&&ov!==oo.next&&oj.pointInTriangle(oW.x,oW.y,oD.x,oD.y,on.x,on.y,ov.x,ov.y)&&0<=oj.area(ov.prev,ov,ov.next))return!1;ov=ov.nextZ}for(ov=oo.prevZ;ov&&ov.z>=op;){if(ov!==oo.prev&&ov!==oo.next&&oj.pointInTriangle(oW.x,oW.y,oD.x,oD.y,on.x,on.y,ov.x,ov.y)&&0<=oj.area(ov.prev,ov,ov.next))return!1;ov=ov.prevZ}return!0},oj.cureLocalIntersections=function(oo,or,oT){var ok=oo;do{var oW=ok.prev,oD=ok.next.next;!oj.equals(oW,oD)&&oj.intersects(oW,ok,ok.next,oD)&&oj.locallyInside(oW,oD)&&oj.locallyInside(oD,oW)&&(or.push(oW.i/oT),or.push(ok.i/oT),or.push(oD.i/oT),oj.removeNode(ok),oj.removeNode(ok.next),ok=oo=oD),ok=ok.next}while(ok!==oo);return ok},oj.splitEarcut=function(oo,or,oT,ok,oW,oD){var on=oo;do{for(var oV=on.next.next;oV!==on.prev;){if(on.i!==oV.i&&oj.isValidDiagonal(on,oV)){var oL=oj.splitPolygon(on,oV);return on=oj.filterPoints(on,on.next),oL=oj.filterPoints(oL,oL.next),oj.earcutLinked(on,or,oT,ok,oW,oD),void oj.earcutLinked(oL,or,oT,ok,oW,oD)}oV=oV.next}on=on.next}while(on!==oo)},oj.eliminateHoles=function(oo,or,oT,ok){var oW,oD,on,oV,oL,oU=[];for(oW=0,oD=or.length;oW<oD;oW++)on=or[oW]*ok,oV=oW<oD-1?or[oW+1]*ok:oo.length,(oL=oj.linkedList(oo,on,oV,ok,!1))===oL.next&&(oL.steiner=!0),oU.push(oj.getLeftmost(oL));for(oU.sort(oj.compareX),oW=0;oW<oU.length;oW++)oj.eliminateHole(oU[oW],oT),oT=oj.filterPoints(oT,oT.next);return oT},oj.compareX=function(oo,or){return oo.x-or.x},oj.eliminateHole=function(oo,or){if(or=oj.findHoleBridge(oo,or)){var oT=oj.splitPolygon(or,oo);oj.filterPoints(oT,oT.next)}},oj.findHoleBridge=function(oo,or){var oT,ok=or,oW=oo.x,oD=oo.y,on=-1/0;do{if(oD<=ok.y&&oD>=ok.next.y&&ok.next.y!==ok.y){var oV=ok.x+(oD-ok.y)*(ok.next.x-ok.x)/(ok.next.y-ok.y);if(oV<=oW&&on<oV){if((on=oV)===oW){if(oD===ok.y)return ok;if(oD===ok.next.y)return ok.next}oT=ok.x<ok.next.x?ok:ok.next}}ok=ok.next}while(ok!==or);if(!oT)return null;if(oW===on)return oT.prev;var oL,oU=oT,oh=oT.x,op=oT.y,oi=1/0;for(ok=oT.next;ok!==oU;)oW>=ok.x&&ok.x>=oh&&oW!==ok.x&&oj.pointInTriangle(oD<op?oW:on,oD,oh,op,oD<op?on:oW,oD,ok.x,ok.y)&&((oL=Math.abs(oD-ok.y)/(oW-ok.x))<oi||oL===oi&&ok.x>oT.x)&&oj.locallyInside(ok,oo)&&(oT=ok,oi=oL),ok=ok.next;return oT},oj.indexCurve=function(oo,or,oT,ok){for(var oW=oo;null===oW.z&&(oW.z=oj.zOrder(oW.x,oW.y,or,oT,ok)),oW.prevZ=oW.prev,oW.nextZ=oW.next,(oW=oW.next)!==oo;);oW.prevZ.nextZ=null,oW.prevZ=null,oj.sortLinked(oW)},oj.sortLinked=function(oo){var or,oT,ok,oW,oD,on,oV,oL,oU=1;do{for(oT=oo,oD=oo=null,on=0;oT;){for(on++,ok=oT,or=oV=0;or<oU&&(oV++,ok=ok.nextZ);or++);for(oL=oU;0<oV||0<oL&&ok;)0!==oV&&(0===oL||!ok||oT.z<=ok.z)?(oT=(oW=oT).nextZ,oV--):(ok=(oW=ok).nextZ,oL--),oD?oD.nextZ=oW:oo=oW,oW.prevZ=oD,oD=oW;oT=ok}oD.nextZ=null,oU*=2}while(1<on);return oo},oj.zOrder=function(oo,or,oT,ok,oW){return(oo=1431655765&((oo=858993459&((oo=252645135&((oo=16711935&((oo=32767*(oo-oT)*oW)|oo<<8))|oo<<4))|oo<<2))|oo<<1))|(or=1431655765&((or=858993459&((or=252645135&((or=16711935&((or=32767*(or-ok)*oW)|or<<8))|or<<4))|or<<2))|or<<1))<<1},oj.getLeftmost=function(oo){for(var or=oo,oT=oo;or.x<oT.x&&(oT=or),(or=or.next)!==oo;);return oT},oj.pointInTriangle=function(oo,or,oT,ok,oW,oD,on,oV){return 0<=(oW-on)*(or-oV)-(oo-on)*(oD-oV)&&0<=(oo-on)*(ok-oV)-(oT-on)*(or-oV)&&0<=(oT-on)*(oD-oV)-(oW-on)*(ok-oV)},oj.isValidDiagonal=function(oo,or){return oo.next.i!==or.i&&oo.prev.i!==or.i&&!oj.intersectsPolygon(oo,or)&&oj.locallyInside(oo,or)&&oj.locallyInside(or,oo)&&oj.middleInside(oo,or)},oj.area=function(oo,or,oT){return(or.y-oo.y)*(oT.x-or.x)-(or.x-oo.x)*(oT.y-or.y)},oj.equals=function(oo,or){return oo.x===or.x&&oo.y===or.y},oj.intersects=function(oo,or,oT,ok){return!!(oj.equals(oo,or)&&oj.equals(oT,ok)||oj.equals(oo,ok)&&oj.equals(oT,or))||0<oj.area(oo,or,oT)!=0<oj.area(oo,or,ok)&&0<oj.area(oT,ok,oo)!=0<oj.area(oT,ok,or)},oj.intersectsPolygon=function(oo,or){var oT=oo;do{if(oT.i!==oo.i&&oT.next.i!==oo.i&&oT.i!==or.i&&oT.next.i!==or.i&&oj.intersects(oT,oT.next,oo,or))return!0;oT=oT.next}while(oT!==oo);return!1},oj.locallyInside=function(oo,or){return oj.area(oo.prev,oo,oo.next)<0?0<=oj.area(oo,or,oo.next)&&0<=oj.area(oo,oo.prev,or):oj.area(oo,or,oo.prev)<0||oj.area(oo,oo.next,or)<0},oj.middleInside=function(oo,or){for(var oT=oo,ok=!1,oW=(oo.x+or.x)/2,oD=(oo.y+or.y)/2;oT.y>oD!=oT.next.y>oD&&oT.next.y!==oT.y&&oW<(oT.next.x-oT.x)*(oD-oT.y)/(oT.next.y-oT.y)+oT.x&&(ok=!ok),(oT=oT.next)!==oo;);return ok},oj.splitPolygon=function(oo,or){var oT=new oWo(oo.i,oo.x,oo.y),ok=new oWo(or.i,or.x,or.y),oW=oo.next,oD=or.prev;return(oo.next=or).prev=oo,(oT.next=oW).prev=oT,(ok.next=oT).prev=ok,(oD.next=ok).prev=oD,ok},oj.insertNode=function(oo,or,oT,ok){var oW=new oWo(oo,or,oT);return ok?(oW.next=ok.next,(oW.prev=ok).next.prev=oW,ok.next=oW):(oW.prev=oW).next=oW,oW},oj.removeNode=function(oo){oo.next.prev=oo.prev,oo.prev.next=oo.next,oo.prevZ&&(oo.prevZ.nextZ=oo.nextZ),oo.nextZ&&(oo.nextZ.prevZ=oo.prevZ)},oj.signedArea=function(oo,or,oT,ok){for(var oW=0,oD=or,on=oT-ok;oD<oT;oD+=ok)oW+=(oo[on]-oo[oD])*(oo[oD+1]+oo[on+1]),on=oD;return oW},oj}(),oWo=function(){function oo(oo,or,oT){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=oo,this.x=or,this.y=oT,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return oi(oo,"laya.webgl.shapes.EarcutNode"),oo}(),oDo=(function(){function oo(oo,or,oT,ok,oW,oD,on){this.lineWidth=oo,this.lineColor=or,this.lineAlpha=oT,this.fillColor=ok,this.fillAlpha=oW,this.shape=on,this.fill=oD}oi(oo,"laya.webgl.shapes.GeometryData");var or=oo.prototype;or.clone=function(){return new oo(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},or.getIndexData=function(){return null},or.getVertexData=function(){return null},or.destroy=function(){this.shape=null}}(),function(){function oo(oo){if(oo instanceof Float32Array)this.points=oo;else if(oo instanceof Array){oo.length;this.points=new Float32Array(oo)}}oi(oo,"laya.webgl.shapes.Vertex");var or=oo.prototype;oq.imps(or,{"laya.webgl.shapes.IShape":!0}),or.getData=function(oo,or,oT){},or.needUpdate=function(oo){return!1},or.rebuild=function(oo){},or.setMatrix=function(oo){}}(),function(){function oL(oo){void 0===oo&&(oo=1e4),this._renderType=oo}oi(oL,"laya.webgl.submit.Submit");var oo=oL.prototype;return oq.imps(oo,{"laya.webgl.submit.ISubmit":!0}),oo.releaseRender=function(){var oo=oL._cache;(oo[oo._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},oo.getRenderType=function(){return this._renderType},oo.renderSubmit=function(){if(0===this._numEle)return 1;var oo=this.shaderValue.textureHost;if(oo){var or=oo.source;if(!oo.bitmap||!or)return 1;this.shaderValue.texture=or,oo.alphaTexture&&oo.alphaTexture.source&&(this.shaderValue.texture1=oo.alphaTexture.source)}this._vb.bind_upload(this._ib);var oT=olo.mainContext;return this.shaderValue.upload(),oI.activeBlendFunction!==this._blendFn&&(oT.enable(3042),this._blendFn(oT),oI.activeBlendFunction=this._blendFn),os.drawCall++,os.trianglesFaces+=this._numEle/3,oT.drawElements(4,this._numEle,5123,this._startIdx),1},oL.__init__=function(){var oo=oL.RENDERBASE=new oL(-1);oo.shaderValue=new oFo(0,0),oo.shaderValue.ALPHA=-1234},oL.createSubmit=function(oo,or,oT,ok,oW){var oD=oL._cache._length?oL._cache[--oL._cache._length]:new oL;null==oT&&((oT=oD._selfVb||(oD._selfVb=odo.create(-1))).clear(),ok=0),oD._ib=or,oD._vb=oT,oD._startIdx=ok*ojo.BYTES_PIDX,oD._numEle=0;var on=oo._nBlendType;oD._blendFn=oo._targets?oI.targetFns[on]:oI.fns[on],oD.shaderValue=oW,oD.shaderValue.setValue(oo._shader2D);var oV=oo._shader2D.filters;return oV&&oD.shaderValue.setFilters(oV),oD},oL.createShape=function(oo,or,oT,ok,oW,oD){var on=oL._cache._length?oL._cache[--oL._cache._length]:new oL;on._ib=or,on._vb=oT,on._numEle=ok,on._startIdx=oW,on.shaderValue=oD,on.shaderValue.setValue(oo._shader2D);var oV=oo._nBlendType;return on._blendFn=oo._targets?oI.targetFns[oV]:oI.fns[oV],on},oL.TYPE_2D=1e4,oL.TYPE_CANVAS=10003,oL.TYPE_CMDSETRT=10004,oL.TYPE_CUSTOM=10005,oL.TYPE_BLURRT=10006,oL.TYPE_CMDDESTORYPRERT=10007,oL.TYPE_DISABLESTENCIL=10008,oL.TYPE_OTHERIBVB=10009,oL.TYPE_PRIMITIVE=10010,oL.TYPE_RT=10011,oL.TYPE_BLUR_RT=10012,oL.TYPE_TARGET=10013,oL.TYPE_CHANGE_VALUE=10014,oL.TYPE_SHAPE=10015,oL.TYPE_TEXTURE=10016,oL.TYPE_FILLTEXTURE=10017,oL.RENDERBASE=null,oL._cache=((oL._cache=[])._length=0,oL._cache),oL}()),ono=function(){function ok(){this.fun=null,this.args=null}oi(ok,"laya.webgl.submit.SubmitCMD");var oo=ok.prototype;return oq.imps(oo,{"laya.webgl.submit.ISubmit":!0}),oo.renderSubmit=function(){return this.fun.apply(null,this.args),1},oo.getRenderType=function(){return 0},oo.releaseRender=function(){var oo=ok._cache;oo[oo._length++]=this},ok.create=function(oo,or){var oT=ok._cache._length?ok._cache[--ok._cache._length]:new ok;return oT.fun=or,oT.args=oo,oT},ok._cache=((ok._cache=[])._length=0,ok._cache),ok}(),oVo=function(){function or(){this.variables={}}oi(or,"laya.webgl.submit.SubmitCMDScope");var oo=or.prototype;return oo.getValue=function(oo){return this.variables[oo]},oo.addValue=function(oo,or){return this.variables[oo]=or},oo.setValue=function(oo,or){return this.variables.hasOwnProperty(oo)?this.variables[oo]=or:null},oo.clear=function(){for(var oo in this.variables)delete this.variables[oo]},oo.recycle=function(){this.clear(),or.POOL.push(this)},or.create=function(){var oo=or.POOL.pop();return oo||(oo=new or),oo},or.POOL=[],or}(),oLo=function(){function op(){this.offset=0,this.startIndex=0,this._mat=oP.create()}oi(op,"laya.webgl.submit.SubmitOtherIBVB");var oo=op.prototype;return oq.imps(oo,{"laya.webgl.submit.ISubmit":!0}),oo.releaseRender=function(){var oo=op._cache;(oo[oo._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},oo.getRenderType=function(){return 10009},oo.renderSubmit=function(){var oo=this._shaderValue.textureHost;if(oo){var or=oo.source;if(!oo.bitmap||!or)return 1;this._shaderValue.texture=or}this._vb.bind_upload(this._ib);var oT=o$o.worldMatrix4,ok=oP.TEMP;oP.mulPre(this._mat,oT[0],oT[1],oT[4],oT[5],oT[12],oT[13],ok);var oW=o$o.worldMatrix4=op.tempMatrix4;oW[0]=ok.a,oW[1]=ok.b,oW[4]=ok.c,oW[5]=ok.d,oW[12]=ok.tx,oW[13]=ok.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var oD=olo.mainContext;return oI.activeBlendFunction!==this._blendFn&&(oD.enable(3042),this._blendFn(oD),oI.activeBlendFunction=this._blendFn),os.drawCall++,os.trianglesFaces+=this._numEle/3,oD.drawElements(4,this._numEle,5123,this.startIndex),o$o.worldMatrix4=oT,oOo.activeShader=null,1},op.create=function(oo,or,oT,ok,oW,oD,on,oV,oL){void 0===oL&&(oL=0);var oU=op._cache._length?op._cache[--op._cache._length]:new op;oU._ib=oT,oU._vb=or,oU._numEle=ok,oU._shader=oW,oU._shaderValue=oD;var oh=oo._nBlendType;switch(oU._blendFn=oo._targets?oI.targetFns[oh]:oI.fns[oh],oL){case 0:oU.offset=0,oU.startIndex=oV/(ojo.BYTES_PE*or.vertexStride)*1.5,oU.startIndex*=ojo.BYTES_PIDX;break;case 1:oU.startIndex=on,oU.offset=oV}return oU},op._cache=((op._cache=[])._length=0,op._cache),op.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],op}(),oUo=function(){function oT(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new oH,this.screenRect=new oH}oi(oT,"laya.webgl.submit.SubmitScissor");var oo=oT.prototype;return oq.imps(oo,{"laya.webgl.submit.ISubmit":!0}),oo._scissor=function(oo,or,oT,ok){var oW=o$o.worldMatrix4,oD=oW[0],on=oW[5],oV=oW[12],oL=oW[13];if(ok*=on,(oT*=oD)<1||ok<1)return!1;var oU=(oo=oo*oD+oV)+oT,oh=(or=or*on+oL)+ok;oo<0&&(oT=oU-(oo=0)),or<0&&(ok=oh-(or=0));var op=o$o.worldClipRect;if(oo=Math.max(oo,op.x),or=Math.max(or,op.y),oT=Math.min(oU,op.right)-oo,ok=Math.min(oh,op.bottom)-or,oT<1||ok<1)return!1;var oi=o$o.worldScissorTest;return this.screenRect.copyFrom(op),op.x=oo,op.y=or,op.width=oT,op.height=ok,o$o.worldScissorTest=!0,or=o$o.height-or-ok,olo.mainContext.scissor(oo,or,oT,ok),olo.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),oi?(or=o$o.height-this.screenRect.y-this.screenRect.height,olo.mainContext.scissor(this.screenRect.x,or,this.screenRect.width,this.screenRect.height),olo.mainContext.enable(3089)):(olo.mainContext.disable(3089),o$o.worldScissorTest=!1),op.copyFrom(this.screenRect),!0},oo._scissorWithTagart=function(oo,or,oT,ok){if(oT<1||ok<1)return!1;var oW=oo+oT,oD=or+ok;oo<0&&(oT=oW-(oo=0)),or<0&&(ok=oD-(or=0));var on=o$o.worldClipRect;if(oo=Math.max(oo,on.x),or=Math.max(or,on.y),oT=Math.min(oW,on.right)-oo,ok=Math.min(oD,on.bottom)-or,oT<1||ok<1)return!1;var oV=o$o.worldScissorTest;return this.screenRect.copyFrom(on),o$o.worldScissorTest=!0,on.x=oo,on.y=or,on.width=oT,on.height=ok,or=o$o.height-or-ok,olo.mainContext.scissor(oo,or,oT,ok),olo.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),oV?(or=o$o.height-this.screenRect.y-this.screenRect.height,olo.mainContext.scissor(this.screenRect.x,or,this.screenRect.width,this.screenRect.height),olo.mainContext.enable(3089)):(olo.mainContext.disable(3089),o$o.worldScissorTest=!1),on.copyFrom(this.screenRect),!0},oo.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},oo.getRenderType=function(){return 0},oo.releaseRender=function(){var oo=oT._cache;(oo[oo._length++]=this).context=null},oT.create=function(oo){var or=oT._cache._length?oT._cache[--oT._cache._length]:new oT;return or.context=oo,or},oT._cache=((oT._cache=[])._length=0,oT._cache),oT}(),oho=function(){function oL(){this.step=0,this.blendMode=null,this.level=0}oi(oL,"laya.webgl.submit.SubmitStencil");var oo=oL.prototype;return oq.imps(oo,{"laya.webgl.submit.ISubmit":!0}),oo.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},oo.getRenderType=function(){return 0},oo.releaseRender=function(){var oo=oL._cache;oo[oo._length++]=this},oo.do1=function(){var oo=olo.mainContext;oo.enable(2960),oo.clear(1024),oo.colorMask(!1,!1,!1,!1),oo.stencilFunc(514,this.level,255),oo.stencilOp(7680,7680,7682)},oo.do2=function(){var oo=olo.mainContext;oo.stencilFunc(514,this.level+1,255),oo.colorMask(!0,!0,!0,!0),oo.stencilOp(7680,7680,7680)},oo.do3=function(){var oo=olo.mainContext;oo.colorMask(!0,!0,!0,!0),oo.stencilOp(7680,7680,7680),oo.clear(1024),oo.disable(2960)},oo.do4=function(){var oo=olo.mainContext;0==this.level&&(oo.enable(2960),oo.clear(1024)),oo.colorMask(!1,!1,!1,!1),oo.stencilFunc(519,0,255),oo.stencilOp(7680,7680,7682)},oo.do5=function(){var oo=olo.mainContext;oo.stencilFunc(514,this.level,255),oo.colorMask(!0,!0,!0,!0),oo.stencilOp(7680,7680,7680)},oo.do6=function(){var oo=olo.mainContext;oI.targetFns[oI.TOINT[this.blendMode]](oo)},oo.do7=function(){var oo=olo.mainContext;oo.colorMask(!1,!1,!1,!1),oo.stencilOp(7680,7680,7683)},oo.do8=function(){var oo=olo.mainContext;oo.colorMask(!0,!0,!0,!0),oo.stencilFunc(514,this.level,255),oo.stencilOp(7680,7680,7680)},oL.restore=function(oo,or,oT,ok,oW){var oD;if((oo._renderKey=0)<oL._mask&&oL._mask--,0==oL._mask)oD=laya.webgl.submit.SubmitStencil.create(3),oo.addRenderObject(oD),oo._curSubmit=oDo.RENDERBASE;else{oD=laya.webgl.submit.SubmitStencil.create(7),oo.addRenderObject(oD);var on=oo._vb;on._byteLength;if(o_o.fillRectImgVb(on,null,or.x,or.y,or.width,or.height,oX.DEF_UV,oT,ok,oW,0,0)){oo._shader2D.glTexture=null;var oV=oo._curSubmit=oDo.createSubmit(oo,oo._ib,on,(on._byteLength-64)/32*3,oFo.create(2,0));oV.shaderValue.ALPHA=1,oo._submits[oo._submits._length++]=oV,oo._curSubmit._numEle+=6,oo._curSubmit=oDo.RENDERBASE}else alert("clipRect calc stencil rect error");oD=laya.webgl.submit.SubmitStencil.create(8),oo.addRenderObject(oD)}},oL.restore2=function(oo,or){var oT;(oo._renderKey=0)<oL._mask&&oL._mask--,0==oL._mask?(oT=laya.webgl.submit.SubmitStencil.create(3),oo.addRenderObject(oT),oo._curSubmit=oDo.RENDERBASE):(oT=laya.webgl.submit.SubmitStencil.create(7),oo.addRenderObject(oT),oo._submits[oo._submits._length++]=or,oT=laya.webgl.submit.SubmitStencil.create(8),oo.addRenderObject(oT))},oL.create=function(oo){var or=oL._cache._length?oL._cache[--oL._cache._length]:new oL;return 5==(or.step=oo)&&++oL._mask,or.level=oL._mask,or},oL._cache=((oL._cache=[])._length=0,oL._cache),oL._mask=0,oL}(),opo=function(){function oV(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}oi(oV,"laya.webgl.submit.SubmitTarget");var oo=oV.prototype;return oq.imps(oo,{"laya.webgl.submit.ISubmit":!0}),oo.renderSubmit=function(){this._vb.bind_upload(this._ib);var oo=this.scope.getValue(this.proName);return oo&&(this.shaderValue.texture=oo.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[oo.width,oo.height]),this.shaderValue.upload(),this.blend(),os.drawCall++,os.trianglesFaces+=this._numEle/3,olo.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},oo.blend=function(){if(oI.activeBlendFunction!==oI.fns[this.blendType]){var oo=olo.mainContext;oo.enable(3042),oI.fns[this.blendType](oo),oI.activeBlendFunction=oI.fns[this.blendType]}},oo.getRenderType=function(){return 0},oo.releaseRender=function(){var oo=oV._cache;(oo[oo._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},oV.create=function(oo,or,oT,ok,oW,oD){var on=oV._cache._length?oV._cache[--oV._cache._length]:new oV;return on._ib=or,on._vb=oT,on.proName=oD,on._startIdx=ok*ojo.BYTES_PIDX,on._numEle=0,on.blendType=oo._nBlendType,on.shaderValue=oW,on.shaderValue.setValue(oo._shader2D),on},oV._cache=((oV._cache=[])._length=0,oV._cache),oV}(),oio=function(){function oo(){this._sourceStr=null}oi(oo,"laya.webgl.text.CharSegment");var or=oo.prototype;return oq.imps(or,{"laya.webgl.text.ICharSegment":!0}),or.textToSpit=function(oo){this._sourceStr=oo},or.getChar=function(oo){return this._sourceStr.charAt(oo)},or.getCharCode=function(oo){return this._sourceStr.charCodeAt(oo)},or.length=function(){return this._sourceStr.length},oo}(),ovo=function(){var oo;function os(){}return oi(os,"laya.webgl.text.DrawText"),os.__init__=function(){os._charsTemp=new Array,os._drawValue=new oo,os._charSeg=new oio},os.customCharSeg=function(oo){os._charSeg=oo},os.getChar=function(oo,or,oT){var ok=oao.createOneChar(oo,oT);return-1!=or&&(os._charsCache[or]=ok),ok},os._drawSlow=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh,op,oi,ov,ox){var oj,o_,oK=os._drawValue.value(oD,oV,oL,oU,oi,ov,ox),o$=0,oy=0,ol=os._charsTemp,oS=0,oq=NaN;if(ok)for(ol.length=ok.length,o$=0,oy=ok.length;o$<oy;o$++)(o_=ok[o$])&&(oq=o_.charNum+oK.txtID,ol[o$]=oj=os._charsCache[oq]||os.getChar(o_.char,oq,oK),oj.active());else{var ob=oT instanceof laya.utils.WordText?oT.toString():oT;if(oC.CharacterCache){os._charSeg.textToSpit(ob);var oF=os._charSeg.length();for(o$=0,oy=ol.length=oF;o$<oy;o$++)oq=os._charSeg.getCharCode(o$)+oK.txtID,ol[o$]=oj=os._charsCache[oq]||os.getChar(os._charSeg.getChar(o$),oq,oK),oj.active(),oS+=oj.cw}else ol.length=0,(oj=os.getChar(ob,-1,oK)).active(),oS+=oj.cw,ol[0]=oj}var oP=0;null!==on&&"left"!==on&&(oP=-("center"==on?oS/2:oS));var ot,oH,oR=NaN,ou=0;if(ok)for(o$=0,oy=ol.length;o$<oy;o$++)oj=ol[o$],o_=ok[o$],oj&&o_&&!oj.isSpace&&(oR=oj.borderSize,ot=oj.texture,or._drawText(ot,oh+oP+o_.x*oi-oR,op+o_.y*ov-oR,ot.width,ot.height,oW,0,0,0,0));else{for(o$=0,oy=ol.length;o$<oy;o$++)(oj=ol[o$])&&!oj.isSpace&&(oR=oj.borderSize,ot=oj.texture,or._drawText(ot,oh+oP-oR,op-oR,ot.width,ot.height,oW,0,0,0,0),oo&&((oH=oo[ou++])||(oH=oo[ou-1]=[]),oH[0]=ot,oH[1]=oP-oR,oH[2]=-oR)),oP+=oj.cw;oo&&(oo.length=ou)}},os._drawFast=function(oo,or,oT,ok,oW){for(var oD,on,oV=0,oL=oo.length;oV<oL;oV++)(oD=(on=oo[oV])[0]).active(),or._drawText(oD,ok+on[1],oW+on[2],oD.width,oD.height,oT,0,0,0,0)},os.drawText=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh,op){if(void 0===op&&(op=0),!(or&&0===or.length||oT&&0===oT.length)){var oi=ok.a,ov=ok.d;(0!==ok.b||0!==ok.c)&&(oi=ov=1);var ox=1!==oi||1!==ov;if(ox&&oq.stage.transform){var oj=oq.stage.transform;ox=oj.a===oi&&oj.d===ov}else ox=!1;if(ox){var o_=(ok=ok.copyTo(obo._tmpMatrix)).tx,oK=ok.ty;ok.scale(1/oi,1/ov),ok._checkTransform(),oU*=oi,oh*=ov,oU+=o_-ok.tx,oh+=oK-ok.ty}else oi=ov=1;if(oT)os._drawSlow(null,oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh,oi,ov,op);else{if(null===or.toUpperCase){var o$=oi+1e5*ov,oy=or;return void(oy.changed||oy.id!==o$?(oy.id=o$,oy.changed=!1,os._drawSlow(oy.save,oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh,oi,ov,op)):os._drawFast(oy.save,oo,ok,oU,oh))}var ol=or+oW.toString()+on+oV+oL+oi+ov+oD,oS=os._textsCache[ol];oC.CharacterCache?oS?os._drawFast(oS,oo,ok,oU,oh):(os._textsCache.__length||(os._textsCache.__length=0),os._textsCache.__length>ob.WebGLTextCacheCount&&((os._textsCache={}).__length=0,os._curPoolIndex=0),os._textCachesPool[os._curPoolIndex]?(oS=os._textsCache[ol]=os._textCachesPool[os._curPoolIndex]).length=0:os._textCachesPool[os._curPoolIndex]=oS=os._textsCache[ol]=[],os._textsCache.__length++,os._curPoolIndex++,os._drawSlow(oS,oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh,oi,ov,op)):os._drawSlow(oS,oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh,oi,ov,op)}}},os._charsTemp=null,os._textCachesPool=[],os._curPoolIndex=0,os._charsCache={},os._textsCache={},os._drawValue=null,os.d=[],os._charSeg=null,os.__init$=function(){oo=function(){function oL(){}return oi(oL,""),oL.prototype.value=function(oo,or,oT,ok,oW,oD,on){this.font=oo,this.fillColor=or,this.borderColor=oT,this.lineWidth=ok,this.scaleX=oW,this.scaleY=oD,this.underLine=on;var oV=oo.toString()+oW+oD+ok+(or?or.toLowerCase():" ")+(oT?oT.toLowerCase():" ")+on;return this.txtID=oL._keymap[oV],this.txtID||(this.txtID=1e-7*++oL._keymapCount,oL._keymap[oV]=this.txtID),this},oL.clear=function(){oL._keymap={},oL._keymapCount=1},oL._keymap={},oL._keymapCount=1,oL}()},os}(),oxo=function(){function oW(oo){this._index=0,this._size=14,this._italic=-2,oW._cache2=oW._cache2||[],this.setFont(oo||"14px Arial")}oi(oW,"laya.webgl.text.FontInContext");var oo=oW.prototype;return oo.setFont=function(oo){var or=oW._cache2[oo];if(or)this._words=or[0],this._size=or[1];else{this._words=oo.split(" ");for(var oT=0,ok=this._words.length;oT<ok;oT++)if(0<this._words[oT].indexOf("px")){this._index=oT;break}this._size=parseInt(this._words[this._index]),oW._cache2[oo]=[this._words,this._size]}this._text=null,this._italic=-2},oo.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},oo.hasType=function(oo){for(var or=0,oT=this._words.length;or<oT;or++)if(this._words[or]===oo)return or;return-1},oo.removeType=function(oo){for(var or=0,oT=this._words.length;or<oT;or++)if(this._words[or]===oo){this._words.splice(or,1),this._index>or&&this._index--;break}this._text=null,this._italic=-2},oo.copyTo=function(oo){return oo._text=this._text,oo._size=this._size,oo._index=this._index,oo._words=this._words.slice(),oo._italic=-2,oo},oo.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},ok(0,oo,"size",function(){return this._size},function(oo){this._size=oo,this._words[this._index]=oo+"px",this._text=null}),oW.create=function(oo){var or=oW._cache[oo];return or||(or=oW._cache[oo]=new oW(oo))},oW.EMPTY=new oW,oW._cache={},oW._cache2=null,oW}(),ojo=function(){function oo(){}return oi(oo,"laya.webgl.utils.CONST3D2D"),oo.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],oo.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],oo.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],oo._TMPARRAY=[],oo._OFFSETX=0,oo._OFFSETY=0,on(oo,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),oo}(),o_o=function(){function ox(){}return oi(ox,"laya.webgl.utils.GlUtils"),ox.make2DProjection=function(oo,or,oT){return[2/oo,0,0,0,0,-2/or,0,0,0,0,2/oT,0,-1,1,0,1]},ox.fillIBQuadrangle=function(oo,or){if(65535/4<or)throw Error("IBQuadrangle count:"+or+" must<:"+Math.floor(65535/4));or=Math.floor(or),oo._resizeBuffer(6*(or+1)*2,!1),oo.byteLength=oo.bufferLength;for(var oT=oo.getUint16Array(),ok=0,oW=0;oW<or;oW++)oT[ok++]=4*oW,oT[ok++]=4*oW+2,oT[ok++]=4*oW+1,oT[ok++]=4*oW,oT[ok++]=4*oW+3,oT[ok++]=4*oW+2;return oo.setNeedUpload(),!0},ox.expandIBQuadrangle=function(oo,or){oo.bufferLength>=6*or*2||ox.fillIBQuadrangle(oo,or)},ox.mathCeilPowerOfTwo=function(oo){return oo--,oo|=oo>>1,oo|=oo>>2,oo|=oo>>4,oo|=oo>>8,oo|=oo>>16,++oo},ox.fillQuadrangleImgVb=function(oo,or,oT,ok,oW,oD,on,oV){var oL=16+(oo._byteLength>>2);oo.byteLength=oL<<2;var oU=oo.getFloat32Array();oU[(oL-=16)+2]=oW[0],oU[oL+3]=oW[1],oU[oL+6]=oW[2],oU[oL+7]=oW[3],oU[oL+10]=oW[4],oU[oL+11]=oW[5],oU[oL+14]=oW[6],oU[oL+15]=oW[7];var oh=oD.a,op=oD.b,oi=oD.c,ov=oD.d;if(1!==oh||0!==op||0!==oi||1!==ov){oD.bTransform=!0;var ox=oD.tx+on,oj=oD.ty+oV;oU[oL]=(ok[0]+or)*oh+(ok[1]+oT)*oi+ox,oU[oL+1]=(ok[0]+or)*op+(ok[1]+oT)*ov+oj,oU[oL+4]=(ok[2]+or)*oh+(ok[3]+oT)*oi+ox,oU[oL+5]=(ok[2]+or)*op+(ok[3]+oT)*ov+oj,oU[oL+8]=(ok[4]+or)*oh+(ok[5]+oT)*oi+ox,oU[oL+9]=(ok[4]+or)*op+(ok[5]+oT)*ov+oj,oU[oL+12]=(ok[6]+or)*oh+(ok[7]+oT)*oi+ox,oU[oL+13]=(ok[6]+or)*op+(ok[7]+oT)*ov+oj}else oD.bTransform=!1,or+=oD.tx+on,oT+=oD.ty+oV,oU[oL]=or+ok[0],oU[oL+1]=oT+ok[1],oU[oL+4]=or+ok[2],oU[oL+5]=oT+ok[3],oU[oL+8]=or+ok[4],oU[oL+9]=oT+ok[5],oU[oL+12]=or+ok[6],oU[oL+13]=oT+ok[7];return oo._upload=!0},ox.fillTranglesVB=function(oo,or,oT,ok,oW,oD,on){var oV=(oo._byteLength>>2)+ok.length;oo.byteLength=oV<<2;var oL=oo.getFloat32Array();oV-=ok.length;for(var oU=ok.length,oh=oW.a,op=oW.b,oi=oW.c,ov=oW.d,ox=0;ox<oU;ox+=4)if(oL[oV+ox+2]=ok[ox+2],oL[oV+ox+3]=ok[ox+3],1!==oh||0!==op||0!==oi||1!==ov){oW.bTransform=!0;var oj=oW.tx+oD,o_=oW.ty+on;oL[oV+ox]=(ok[ox]+or)*oh+(ok[ox+1]+oT)*oi+oj,oL[oV+ox+1]=(ok[ox]+or)*op+(ok[ox+1]+oT)*ov+o_}else oW.bTransform=!1,or+=oW.tx+oD,oT+=oW.ty+on,oL[oV+ox]=or+ok[ox],oL[oV+ox+1]=oT+ok[ox+1];return oo._upload=!0},ox.copyPreImgVb=function(oo,or,oT){var ok=oo._byteLength>>2;oo.byteLength=ok+16<<2;for(var oW=oo.getFloat32Array(),oD=0,on=ok-16;oD<4;oD++)oW[ok]=oW[on]+or,++on,oW[++ok]=oW[on]+oT,++on,oW[++ok]=oW[on],++on,oW[++ok]=oW[on],++ok,++on;oo._upload=!0},ox.fillRectImgVb=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh,op,oi){void 0===oi&&(oi=!1);var ov,ox,oj,o_,oK,o$,oy,ol,oS,oq,ob,oF,oP,ot,oH,oR,ou=1,os=oV.a,oz=oV.b,om=oV.c,oC=oV.d,oX=or&&or.width<99999999;if(1!==os||0!==oz||0!==om||1!==oC?(oV.bTransform=!0,0===oz&&0===om&&(ou=23,oS=oW+oT,oq=oD+ok,ov=os*oT+(ob=oV.tx+oL),oj=os*oS+ob,ox=oC*ok+(oF=oV.ty+oU),o_=oC*oq+oF)):(ou=23,oV.bTransform=!1,oj=(ov=oT+oV.tx+oL)+oW,o_=(ox=ok+oV.ty+oU)+oD),oX&&(oK=or.x,o$=or.y,oy=or.width+oK,ol=or.height+o$),1!==ou){if(Math.min(ov,oj)>=oy)return!1;if(Math.min(ox,o_)>=ol)return!1;if(Math.max(oj,ov)<=oK)return!1;if(Math.max(o_,ox)<=o$)return!1}var oO=oo._byteLength>>2;oo.byteLength=16+oO<<2;var oM=oo.getFloat32Array();switch(oM[2+oO]=on[0],oM[3+oO]=on[1],oM[6+oO]=on[2],oM[7+oO]=on[3],oM[10+oO]=on[4],oM[11+oO]=on[5],oM[14+oO]=on[6],oM[15+oO]=on[7],ou){case 1:ob=oV.tx+oL,oF=oV.ty+oU;var oc=os*oT,oe=om*ok,oJ=oC*ok,oY=oz*oT,oA=os*(oS=oW+oT),oI=om*(oq=oD+ok),oN=oC*oq,of=oz*oS;oi?(oP=oc+oe+ob,oH=Math.round(oP)-oP,ot=oJ+oY+oF,oR=Math.round(ot)-ot,oM[oO]=oP+oH,oM[1+oO]=ot+oR,oM[4+oO]=oA+oe+ob+oH,oM[5+oO]=oJ+of+oF+oR,oM[8+oO]=oA+oI+ob+oH,oM[9+oO]=oN+of+oF+oR,oM[12+oO]=oc+oI+ob+oH,oM[13+oO]=oN+oY+oF+oR):(oM[oO]=oc+oe+ob,oM[1+oO]=oJ+oY+oF,oM[4+oO]=oA+oe+ob,oM[5+oO]=oJ+of+oF,oM[8+oO]=oA+oI+ob,oM[9+oO]=oN+of+oF,oM[12+oO]=oc+oI+ob,oM[13+oO]=oN+oY+oF);break;case 23:oi?(oP=ov+oh,oH=Math.round(oP)-oP,ot=ox,oR=Math.round(ot)-ot,oM[oO]=oP+oH,oM[1+oO]=ot+oR,oM[4+oO]=oj+oh+oH,oM[5+oO]=ox+oR,oM[8+oO]=oj+oH,oM[9+oO]=o_+oR,oM[12+oO]=ov+oH,oM[13+oO]=o_+oR):(oM[oO]=ov+oh,oM[1+oO]=ox,oM[4+oO]=oj+oh,oM[5+oO]=ox,oM[8+oO]=oj,oM[9+oO]=o_,oM[12+oO]=ov,oM[13+oO]=o_)}return oo._upload=!0},ox.fillLineVb=function(oo,or,oT,ok,oW,oD,on,oV){var oL=.5*on,oU=ox._fillLineArray,oh=-(ok-oD),op=oT-oW,oi=Math.sqrt(oh*oh+op*op);oh/=oi,op/=oi,oh*=oL,op*=oL,oU[0]=oT-oh,oU[1]=ok-op,oU[4]=oT+oh,oU[5]=ok+op,oU[8]=oW+oh,oU[9]=oD+op,oU[12]=oW-oh,oU[13]=oD-op,oV&&oV.transformPointArray(oU,oU);var ov=16+(oo._byteLength>>2);return oo.byteLength=ov<<2,oo.insertData(oU,ov-16),!0},ox._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ox}(),oKo=(function(){function oL(){}oi(oL,"laya.webgl.utils.MatirxArray"),oL.ArrayMul=function(oo,or,oT){if(oo)if(or)for(var ok=NaN,oW=NaN,oD=NaN,on=NaN,oV=0;oV<4;oV++)ok=oo[oV],oW=oo[oV+4],oD=oo[oV+8],on=oo[oV+12],oT[oV]=ok*or[0]+oW*or[1]+oD*or[2]+on*or[3],oT[oV+4]=ok*or[4]+oW*or[5]+oD*or[6]+on*or[7],oT[oV+8]=ok*or[8]+oW*or[9]+oD*or[10]+on*or[11],oT[oV+12]=ok*or[12]+oW*or[13]+oD*or[14]+on*or[15];else oL.copyArray(oo,oT);else oL.copyArray(or,oT)},oL.copyArray=function(oo,or){if(oo&&or)for(var oT=0;oT<oo.length;oT++)or[oT]=oo[oT]}}(),function(){function or(oo,or,oT){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=oo,this._vb=new odo(oo,35048),or&&this._vb._resizeBuffer(or,!1),this._ib=new oEo,oT&&this._ib._resizeBuffer(oT,!1)}oi(or,"laya.webgl.utils.Mesh2D");var oo=or.prototype;return oo.cloneWithNewVB=function(){var oo=new or(this._stride,0,0);return oo._ib=this._ib,oo._quadNum=this._quadNum,oo._attribInfo=this._attribInfo,oo},oo.cloneWithNewVBIB=function(){var oo=new or(this._stride,0,0);return oo._attribInfo=this._attribInfo,oo},oo.getVBW=function(){return this._vb.setNeedUpload(),this._vb},oo.getVBR=function(){return this._vb},oo.getIBR=function(){return this._ib},oo.getIBW=function(){return this._ib.setNeedUpload(),this._ib},oo.createQuadIB=function(oo){this._quadNum=oo,this._ib._resizeBuffer(6*oo*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var or=this._ib.getUint16Array(),oT=0,ok=0,oW=0;oW<oo;oW++)or[oT++]=ok,or[oT++]=ok+2,or[oT++]=ok+1,or[oT++]=ok,or[oT++]=ok+3,or[oT++]=ok+2,ok+=4;this._ib.setNeedUpload()},oo.setAttributes=function(oo){if(this._attribInfo=oo,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},oo.getEleNum=function(){return this._ib.getBuffer().byteLength/2},oo.releaseMesh=function(){},oo.destroy=function(){},oo.clearVB=function(){this._vb.clear()},or._gvaoid=0,or}()),o$o=function(){function oW(){}return oi(oW,"laya.webgl.utils.RenderState2D"),oW.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},oW.mat2MatArray=function(oo,or){var oT=oo,ok=or;return ok[0]=oT.a,ok[1]=oT.b,ok[2]=oW.EMPTYMAT4_ARRAY[2],ok[3]=oW.EMPTYMAT4_ARRAY[3],ok[4]=oT.c,ok[5]=oT.d,ok[6]=oW.EMPTYMAT4_ARRAY[6],ok[7]=oW.EMPTYMAT4_ARRAY[7],ok[8]=oW.EMPTYMAT4_ARRAY[8],ok[9]=oW.EMPTYMAT4_ARRAY[9],ok[10]=oW.EMPTYMAT4_ARRAY[10],ok[11]=oW.EMPTYMAT4_ARRAY[11],ok[12]=oT.tx,ok[13]=oT.ty,ok[14]=oW.EMPTYMAT4_ARRAY[14],ok[15]=oW.EMPTYMAT4_ARRAY[15],or},oW.restoreTempArray=function(){oW.TEMPMAT4_ARRAY[0]=1,oW.TEMPMAT4_ARRAY[1]=0,oW.TEMPMAT4_ARRAY[4]=0,oW.TEMPMAT4_ARRAY[5]=1,oW.TEMPMAT4_ARRAY[12]=0,oW.TEMPMAT4_ARRAY[13]=0},oW.clear=function(){oW.worldScissorTest=!1,oW.worldShaderDefines=null,oW.worldFilters=null,oW.worldAlpha=1,oW.worldClipRect.x=oW.worldClipRect.y=0,oW.worldClipRect.width=oW.width,oW.worldClipRect.height=oW.height,oW.curRenderTarget=null},oW._MAXSIZE=99999999,oW.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],oW.worldMatrix4=oW.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],oW.worldAlpha=1,oW.worldScissorTest=!1,oW.worldFilters=null,oW.worldShaderDefines=null,oW.curRenderTarget=null,oW.width=0,oW.height=0,on(oW,["worldMatrix",function(){return this.worldMatrix=new oP},"worldClipRect",function(){return this.worldClipRect=new oH(0,0,99999999,99999999)}]),oW}(),oyo=function(){var o$,oT;function oy(oo,or,oT,ok,oW){var oD=this;function on(oo){var or=[],oT=new o$(or);return oD._compileToTree(oT,oo.split("\n"),0,or,oW),oT}var oV=ov.now();this._VS=on(or),this._PS=on(oT),this._nameMap=ok,2<ov.now()-oV&&console.log("ShaderCompile use time:"+(ov.now()-oV)+"  size:"+or.length+"/"+oT.length)}oi(oy,"laya.webgl.utils.ShaderCompile");var oo=oy.prototype;return oo._compileToTree=function(oo,or,oT,ok,oW){var oD,on,oV,oL,oU,oh,op,oi=0,ov=0,ox=0,oj=0;for(ov=oT;ov<or.length;ov++)if(!((oV=or[ov]).length<1)&&0!==(oi=oV.indexOf("//"))){if(0<=oi&&(oV=oV.substr(0,oi)),oD=op||new o$(ok),op=null,oD.text=oV,oD.noCompile=!0,0<=(oi=oV.indexOf("#"))){for(oL="#",oj=oi+1,ox=oV.length;oj<ox;oj++){var o_=oV.charAt(oj);if(" "===o_||"\t"===o_||"\r"===o_||"\n"===o_||"?"===o_)break;oL+=o_}switch(oD.name=oL){case"#ifdef":case"#ifndef":if(oD.src=oV,oD.noCompile=null!=oV.match(/[!&|()=<>]/),oD.noCompile?console.log("function():Boolean{return "+oV.substr(oi+oD.name.length)+"}"):(oh=oV.replace(/^\s*/,"").split(/\s+/),oD.setCondition(oh[1],"#ifdef"===oL?1:2),oD.text="//"+oD.text),oD.setParent(oo),oo=oD,oW)for(oh=oV.substr(oj).split(oy._splitToWordExps3),oj=0;oj<oh.length;oj++)(oV=oh[oj]).length&&(oW[oV]=!0);continue;case"#if":if(oD.src=oV,oD.noCompile=!0,oD.setParent(oo),oo=oD,oW)for(oh=oV.substr(oj).split(oy._splitToWordExps3),oj=0;oj<oh.length;oj++)(oV=oh[oj]).length&&"defined"!=oV&&(oW[oV]=!0);continue;case"#else":oD.src=oV,on=(oo=oo.parent).childs[oo.childs.length-1],oD.noCompile=on.noCompile,oD.noCompile||(oD.condition=on.condition,oD.conditionType=1==on.conditionType?2:1,oD.text="//"+oD.text+" "+on.text+" "+oD.conditionType),oD.setParent(oo),oo=oD;continue;case"#endif":on=(oo=oo.parent).childs[oo.childs.length-1],oD.noCompile=on.noCompile,oD.noCompile||(oD.text="//"+oD.text),oD.setParent(oo);continue;case"#include":oh=oy.splitToWords(oV,null);var oK=oy.includes[oh[1]];if(!oK)throw"ShaderCompile error no this include file:"+oh[1];if((oi=oh[0].indexOf("?"))<0){oD.setParent(oo),oV=oK.getWith("with"==oh[2]?oh[3]:null),this._compileToTree(oD,oV.split("\n"),0,ok,oW),oD.text="";continue}oD.setCondition(oh[0].substr(oi+1),1),oD.text=oK.getWith("with"==oh[2]?oh[3]:null);break;case"#import":oU=(oh=oy.splitToWords(oV,null))[1],ok.push({node:oD,file:oy.includes[oU],ofs:oD.text.length});continue}}else{if((on=oo.childs[oo.childs.length-1])&&!on.name){0<ok.length&&oy.splitToWords(oV,on),op=oD,on.text+="\n"+oV;continue}0<ok.length&&oy.splitToWords(oV,oD)}oD.setParent(oo)}},oo.createShader=function(oo,or,oT){var ok={},oW="";if(oo)for(var oD in oo)oW+="#define "+oD+"\n",ok[oD]=!0;var on=this._VS.toscript(ok,[]),oV=this._PS.toscript(ok,[]);return(oT||oZo.create)(oW+on.join("\n"),oW+oV.join("\n"),or,this._nameMap)},oy._parseOne=function(oo,or,oT,ok,oW,oD){var on={type:oy.shaderParamsMap[oT[ok+1]],name:oT[ok+2],size:isNaN(parseInt(oT[ok+3]))?1:parseInt(oT[ok+3])};return oD&&("attribute"==oW?oo.push(on):or.push(on)),":"==oT[ok+3]&&(on.type=oT[ok+4],ok+=2),ok+=2},oy.addInclude=function(oo,or){if(!or||0===or.length)throw new Error("add shader include file err:"+oo);if(oy.includes[oo])throw new Error("add shader include file err, has add:"+oo);oy.includes[oo]=new oT(or)},oy.preGetParams=function(oo,or){var oT=[oo,or],ok={},oW=[],oD=[],on={},oV=[];ok.attributes=oW,ok.uniforms=oD,ok.defines=on;for(var oL=0,oU=0,oh=0;oh<2;oh++){oT[oh]=oT[oh].replace(oy._removeAnnotation,"");var op,oi=oT[oh].match(oy._reg);for(oL=0,oU=oi.length;oL<oU;oL++){var ov=oi[oL];if("attribute"==ov||"uniform"==ov)oL=oy._parseOne(oW,oD,oi,oL,ov,!0);else{if("#define"==ov){oV[ov=oi[++oL]]=1;continue}if("#ifdef"==ov){on[op=oi[++oL]]=on[op]||[];for(oL++;oL<oU;oL++)if("attribute"==(ov=oi[oL])||"uniform"==ov)oL=oy._parseOne(oW,oD,oi,oL,ov,oV[op]);else if("#else"==ov)for(oL++;oL<oU;oL++)if("attribute"==(ov=oi[oL])||"uniform"==ov)oL=oy._parseOne(oW,oD,oi,oL,ov,!oV[op]);else if("#endif"==ov)break}}}}return ok},oy.splitToWords=function(oo,or){for(var oT,ok,oW=[],oD=-1,on=0,oV=oo.length;on<oV;on++)if(oT=oo.charAt(on),0<=" \t=+-*/&%!<>()'\",;".indexOf(oT)){if(0<=oD&&1<on-oD&&(ok=oo.substr(oD,on-oD),oW.push(ok)),'"'==oT||"'"==oT){var oL=oo.indexOf(oT,on+1);if(oL<0)throw"Sharder err:"+oo;oW.push(oo.substr(on+1,oL-on-1)),on=oL,oD=-1;continue}"("==oT&&or&&0<oW.length&&(ok=oW[oW.length-1]+";","vec4;main;".indexOf(ok)<0&&(or.useFuns+=ok)),oD=-1}else oD<0&&(oD=on);return oD<oV&&1<oV-oD&&(ok=oo.substr(oD,oV-oD),oW.push(ok)),oW},oy.IFDEF_NO=0,oy.IFDEF_YES=1,oy.IFDEF_ELSE=2,oy.IFDEF_PARENT=3,oy._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),oy._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),oy._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),oy.includes={},on(oy,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),oy.__init$=function(){o$=function(){function oT(oo){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=oo}oi(oT,"");var oo=oT.prototype;return oo.setParent=function(oo){oo.childs.push(this),this.z=oo.z+1,this.parent=oo},oo.setCondition=function(oo,or){oo&&(this.conditionType=or,oo=oo.replace(/(\s*$)/g,""),this.condition=function(){return this[oo]},this.condition.__condition=oo)},oo.toscript=function(oo,or){return this._toscript(oo,or,++oT.__id)},oo._toscript=function(ok,oW,oD){if(this.childs.length<1&&!this.text)return oW;oW.length;if(this.condition){var oo=!!this.condition.call(ok);if(2===this.conditionType&&(oo=!oo),!oo)return oW}if(this.text&&oW.push(this.text),0<this.childs.length&&this.childs.forEach(function(oo,or,oT){oo._toscript(ok,oW,oD)}),0<this.includefiles.length&&0<this.useFuns.length)for(var or,oT=0,on=this.includefiles.length;oT<on;oT++)this.includefiles[oT].curUseID!=oD&&0<(or=this.includefiles[oT].file.getFunsScript(this.useFuns)).length&&(this.includefiles[oT].curUseID=oD,oW[0]=or+oW[0]);return oW},oT.__id=1,oT}(),oT=function(){function oo(oo){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=oo;for(var or=0,oT=0,ok=0;!((or=oo.indexOf("#begin",or))<0);){for(ok=or+5;!((ok=oo.indexOf("#end",ok))<0)&&"i"===oo.charAt(ok+4);)ok+=5;if(ok<0)throw"add include err,no #end:"+oo;oT=oo.indexOf("\n",or);var oW=oy.splitToWords(oo.substr(or,oT-or),null);"code"==oW[1]?this.codes[oW[2]]=oo.substr(oT+1,ok-oT-1):"function"==oW[1]&&(oT=oo.indexOf("function",or),oT+="function".length,this.funs[oW[3]]=oo.substr(oT+1,ok-oT-1),this.funnames+=oW[3]+";"),or=ok+1}}oi(oo,"");var or=oo.prototype;return or.getWith=function(oo){var or=oo?this.codes[oo]:this.script;if(!or)throw"get with error:"+oo;return or},or.getFunsScript=function(oo){var or="";for(var oT in this.funs)0<=oo.indexOf(oT+";")&&(or+=this.funs[oT]);return or},oo}()},oy}(),olo=function(){function on(){}return oi(on,"laya.webgl.WebGL"),on._uint8ArraySlice=function(){for(var oo=this.length,or=new Uint8Array(this.length),oT=0;oT<oo;oT++)or[oT]=this[oT];return or},on._float32ArraySlice=function(){for(var oo=this.length,or=new Float32Array(this.length),oT=0;oT<oo;oT++)or[oT]=this[oT];return or},on._uint16ArraySlice=function(oo){var or,oT=arguments,ok=0,oW=0;if(0===oT.length)for(ok=this.length,or=new Uint16Array(ok),oW=0;oW<ok;oW++)or[oW]=this[oW];else if(2===oT.length){var oD=oT[0],on=oT[1];if(oD<on)for(ok=on-oD,or=new Uint16Array(ok),oW=oD;oW<on;oW++)or[oW-oD]=this[oW];else or=new Uint16Array(0)}return or},on.expandContext=function(){var oo=oW.prototype,or=CanvasRenderingContext2D.prototype;or.fillTrangles=oo.fillTrangles,oQo.__int__(null),or.setIBVB=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){void 0===oL&&(oL=0),void 0===oU&&(oU=0),null===oT&&(this._ib=this._ib||oEo.QuadrangleIB,oT=this._ib,o_o.expandIBQuadrangle(oT,ok._byteLength/64+8)),this._setIBVB(oo,or,oT,ok,oW,oD,on,oV,oL,oU)},or.fillTrangles=function(oo,or,oT,ok,oW){this._curMat=this._curMat||oP.create(),this._vb=this._vb||odo.create(),this._ib||(this._ib=oEo.create(),o_o.fillIBQuadrangle(this._ib,on/4));var oD=this._vb,on=ok.length>>4;o_o.fillTranglesVB(oD,or,oT,ok,oW||this._curMat,0,0),o_o.expandIBQuadrangle(this._ib,oD._byteLength/64+8);var oV=new oFo(1,0);oV.textureHost=oo;var oL=new oBo("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");oD._vertType=3,this._setIBVB(or,oT,this._ib,oD,6*on,oW,oL,oV,0,0)}},on.enable=function(){if(ov.__init__(),oK.isConchApp&&!oK.isConchWebGL)return oS.skinAniSprite=function(){return new ooo},on.expandContext(),!1;if(oS.getWebGLContext=function(oo){for(var or,oT=["webgl","experimental-webgl","webkit-3d","moz-webgl"],ok=0;ok<oT.length;ok++){try{or=oo.getContext(oT[ok],{stencil:ob.isStencil,alpha:ob.isAlpha,antialias:ob.isAntialias,premultipliedAlpha:ob.premultipliedAlpha,preserveDrawingBuffer:ob.preserveDrawingBuffer})}catch(oo){}if(or)return or}return null},null==(on.mainContext=oS.getWebGLContext(oK._mainCanvas)))return!1;if(oK.isWebGL)return!0;oj.create=function(oo,or){return new oor(oo,or)},o_.create=function(oo,or,oT,ok,oW,oD,on){return new owo(oo,or,oT,ok,oW,oD,on)},oK.WebGL=on,oK.isWebGL=!0,ovo.__init__(),oS.createRenderSprite=function(oo,or){return new oPo(oo,or)},oS.createWebGLContext2D=function(oo){return new obo(oo)},oS.changeWebGLSize=function(oo,or){laya.webgl.WebGL.onStageResize(oo,or)},oS.createGraphics=function(){return new oqo};var oo=oS.createFilterAction;return oS.createFilterAction=oo||function(oo){return new oto},oS.clear=function(oo){o$o.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var or=oK.context.ctx,oT=0==or._submits._length||ob.preserveDrawingBuffer?ox.create(oo)._color:ou._wgColor;oT&&or.clearBG(oT[0],oT[1],oT[2],oT[3]),o$o.clear()},oS.addToAtlas=function(oo,or){void 0===or&&(or=!1);var oT=oo.bitmap;oK.optimizeTextureMemory(oo.url,oo)?oq.__typeof(oT,"laya.webgl.resource.IMergeAtlasBitmap")&&oT.allowMerageInAtlas&&oT.on("recovered",oo,oo.addTextureToAtlas):oT.enableMerageInAtlas=!1},oS.isAtlas=function(oo){return oo instanceof laya.webgl.atlas.AtlasWebGLCanvas},oY._enable(),oS.beginFlush=function(){for(var oo=oY.instance,or=oo.getAtlaserCount(),oT=0;oT<or;oT++){var ok=oo.getAtlaserByIndex(oT).texture;ok._flashCacheImageNeedFlush&&oS.flashFlushImage(ok)}},oS.drawToCanvas=function(oo,or,oT,ok,oW,oD){(oT<=0||ok<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),oT|=0,ok|=0,oW|=0,oD|=0;var on=oMo.create(oT,ok,6408,5121,0,!1);on.start(),on.clear(0,0,0,0),oK.context.clear(),o$.renders[or]._fun(oo,oK.context,oW,o$o.height-ok+oD),oK.context.flush(),on.end();var oV=on.getData(0,0,oT,ok);if(on.recycle(),oV.byteLength==oT*ok*4){var oL=new ofo;oL._canvas=ov.createElement("canvas"),oL.size(oT,ok);var oU=oL._canvas.getContext("2d");ov.canvas.size(oT,ok);var oh=ov.context,op=oh.createImageData(oT,ok);return op.data.set(new Uint8ClampedArray(oV.buffer)),oL._imgData=op,oh.putImageData(op,0,0),oU.save(),oU.translate(0,ok),oU.scale(1,-1),oU.drawImage(ov.canvas.source,0,0),oU.restore(),oL}console.log("drawToCanvas error: w:"+oT+",h:"+ok+",datalen:"+oV.byteLength)},oS.createFilterAction=function(oo){var or;switch(oo){case 32:or=new oto}return or},oS.addTextureToAtlas=function(oo){oo._uvID++,oY._atlasRestore++,oo.bitmap.enableMerageInAtlas&&oY.instance.addToAtlas(oo)},oS.getTexturePixels=function(oo,or,oT,ok,oW){oK.context.ctx.clear();var oD=new oR;oD.graphics.drawTexture(oo,-or,-oT);var on=oMo.create(ok,oW);on.start(),on.clear(0,0,0,0),oD.render(oK.context,0,0),oK.context.ctx.flush(),on.end();for(var oV=on.getData(0,0,ok,oW),oL=[],oU=0,oh=oW-1;0<=oh;oh--)for(var op=0;op<ok;op++)oU=4*(oh*ok+op),oL.push(oV[oU]),oL.push(oV[oU+1]),oL.push(oV[oU+2]),oL.push(oV[oU+3]);return oL},oS.skinAniSprite=function(){return new ooo},oU.create=function(oo,or){var oT=new ofo;return oT._imgData=or,oT.flipY=!1,oT},oF._filterStart=function(oo,or,oT,ok,oW){var oD=oo.getValue("bounds"),on=oMo.create(oD.width,oD.height);if(on.start(),on.clear(0,0,0,0),oo.addValue("src",on),oo.addValue("ScissorTest",o$o.worldScissorTest),o$o.worldScissorTest){var oV=new oH;oV.copyFrom(oT.ctx._clipRect),oo.addValue("clipRect",oV),o$o.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},oF._filterEnd=function(oo,or,oT,ok,oW){var oD=oo.getValue("bounds");oo.getValue("src").end();var on=oMo.create(oD.width,oD.height);on.start(),on.clear(0,0,0,0),oo.addValue("out",on),or._set$P("_filterCache",on),or._set$P("_isHaveGlowFilter",oo.getValue("_isHaveGlowFilter"))},oF._EndTarget=function(oo,or){if(oo.getValue("src").recycle(),oo.getValue("out").end(),oo.getValue("ScissorTest")){o$o.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),or.ctx.save();var oT=oo.getValue("clipRect");or.ctx.clipRect(oT.x,oT.y,oT.width,oT.height)}},oF._useSrc=function(oo){var or=oo.getValue("out");or.end(),(or=oo.getValue("src")).start(),or.clear(0,0,0,0)},oF._endSrc=function(oo){oo.getValue("src").end()},oF._useOut=function(oo){var or=oo.getValue("src");or.end(),(or=oo.getValue("out")).start(),or.clear(0,0,0,0)},oF._endOut=function(oo){oo.getValue("out").end()},oF._recycleScope=function(oo){oo.recycle()},oF._filter=function(oo,or,oT,ok){var oW=this._next;if(oW){var oD,on,oV=oo.filters,oL=oV.length;if(1==oL&&32==oV[0].type)return or.ctx.save(),or.ctx.setFilters([oV[0]]),oW._fun.call(oW,oo,or,oT,ok),void or.ctx.restore();var oU=oVo.create(),oh=ot.TEMP,op=or.ctx._getTransformMatrix(),oi=oP.create();op.copyTo(oi);var ov=0,ox=0,oj=!1,o_=oo._$P._filterCache?oo._$P._filterCache:null;if(!o_||oo._repaint){oj=oo._isHaveGlowFilter(),oU.addValue("_isHaveGlowFilter",oj),oj&&(ov=50,ox=25),(on=new oH).copyFrom(oo.getSelfBounds()),on.x+=oo.x,on.y+=oo.y,on.x-=oo.pivotX+4,on.y-=oo.pivotY+4;var oK=on.x,o$=on.y;if(on.width+=ov+8,on.height+=ov+8,oh.x=on.x*oi.a+on.y*oi.c,oh.y=on.y*oi.d+on.x*oi.b,on.x=oh.x,on.y=oh.y,oh.x=on.width*oi.a+on.height*oi.c,oh.y=on.height*oi.d+on.width*oi.b,on.width=oh.x,on.height=oh.y,on.width<=0||on.height<=0)return;o_&&o_.recycle(),oU.addValue("bounds",on);var oy=ono.create([oU,oo,or,0,0],oF._filterStart);or.addRenderObject(oy),or.ctx._renderKey=0,or.ctx._shader2D.glTexture=null;var ol=oo.x-oK+ox,oS=oo.y-o$+ox;oW._fun.call(oW,oo,or,ol,oS),oy=ono.create([oU,oo,or,0,0],oF._filterEnd),or.addRenderObject(oy);for(var oq=0;oq<oL;oq++){0!=oq&&(oy=ono.create([oU],oF._useSrc),or.addRenderObject(oy),oD=oFo.create(1,0),oP.TEMP.identity(),or.ctx.drawTarget(oU,0,0,on.width,on.height,oP.TEMP,"out",oD,null,oI.TOINT.overlay),oy=ono.create([oU],oF._useOut),or.addRenderObject(oy)),oV[oq].action.apply3d(oU,oo,or,0,0)}oy=ono.create([oU,or],oF._EndTarget),or.addRenderObject(oy)}else{if((oj=!!oo._$P._isHaveGlowFilter&&oo._$P._isHaveGlowFilter)&&(ov=50,ox=25),(on=oo.getBounds()).width<=0||on.height<=0)return;on.width+=ov,on.height+=ov,oh.x=on.x*oi.a+on.y*oi.c,oh.y=on.y*oi.d+on.x*oi.b,on.x=oh.x,on.y=oh.y,oh.x=on.width*oi.a+on.height*oi.c,oh.y=on.height*oi.d+on.width*oi.b,on.width=oh.x,on.height=oh.y,oU.addValue("out",o_)}oT=oT-ox-oo.x,ok=ok-ox-oo.y,oh.setTo(oT,ok),oi.transformPoint(oh),oT=oh.x+on.x,ok=oh.y+on.y,oD=oFo.create(1,0),oP.TEMP.identity(),or.ctx.drawTarget(oU,oT,ok,on.width,on.height,oP.TEMP,"out",oD,null,oI.TOINT.overlay),oy=ono.create([oU],oF._recycleScope),or.addRenderObject(oy),oi.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=on._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=on._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=on._uint8ArraySlice),!0},on.onStageResize=function(oo,or){null!=on.mainContext&&(on.mainContext.viewport(0,0,oo,or),o$o.width=oo,o$o.height=or)},on.onInvalidGLRes=function(){oY.instance.freeAll(),ol.releaseContentManagers(!0),on.doNodeRepaint(oq.stage),on.mainContext.viewport(0,0,o$o.width,o$o.height),oq.stage.event("devicelost")},on.doNodeRepaint=function(oo){0==oo.numChildren&&oo.repaint();for(var or=0;or<oo.numChildren;or++)on.doNodeRepaint(oo.getChildAt(or))},on.init=function(oo,or,oT){on.mainCanvas=oo,oU._createContext=function(oo){return new obo(oo)},ofo._createContext=function(oo){return new obo(oo)};var ok=laya.webgl.WebGL.mainContext;if(null!=ok.getShaderPrecisionFormat){var oW=ok.getShaderPrecisionFormat(35633,36338),oD=ok.getShaderPrecisionFormat(35632,36338);on.shaderHighPrecision=!(!oW.precision||!oD.precision)}else on.shaderHighPrecision=!1;if(ok.deleteTexture1=ok.deleteTexture,ok.deleteTexture=function(oo){oo==oSo.curBindTexValue&&(oSo.curBindTexValue=null),ok.deleteTexture1(oo)},on.onStageResize(or,oT),null==on.mainContext)throw new Error("webGL getContext err!");om.__init__(),oY.__init__(),oRo.__init__(),oDo.__init__(),obo.__init__(),oFo.__init__(),oE.__init__(),oQo.__int__(ok),oI._init_(ok),oK.isConchApp&&conch.setOnInvalidGLRes(on.onInvalidGLRes)},on.mainCanvas=null,on.mainContext=null,on.antialias=!0,on.shaderHighPrecision=!1,on._bg_null=[0,0,0,0],on}(),oSo=function(){function ok(){}return oi(ok,"laya.webgl.WebGLContext"),ok.UseProgram=function(oo){return ok._useProgram!==oo&&(olo.mainContext.useProgram(oo),ok._useProgram=oo,!0)},ok.setDepthTest=function(oo,or){or!==ok._depthTest&&((ok._depthTest=or)?oo.enable(2929):oo.disable(2929))},ok.setDepthMask=function(oo,or){or!==ok._depthMask&&(ok._depthMask=or,oo.depthMask(or))},ok.setDepthFunc=function(oo,or){or!==ok._depthFunc&&(ok._depthFunc=or,oo.depthFunc(or))},ok.setBlend=function(oo,or){or!==ok._blend&&((ok._blend=or)?oo.enable(3042):oo.disable(3042))},ok.setBlendFunc=function(oo,or,oT){(or!==ok._sFactor||oT!==ok._dFactor)&&(ok._sFactor=or,ok._dFactor=oT,oo.blendFunc(or,oT))},ok.setCullFace=function(oo,or){or!==ok._cullFace&&((ok._cullFace=or)?oo.enable(2884):oo.disable(2884))},ok.setFrontFace=function(oo,or){or!==ok._frontFace&&(ok._frontFace=or,oo.frontFace(or))},ok.bindTexture=function(oo,or,oT){oo.bindTexture(or,oT),ok.curBindTexTarget=or,ok.curBindTexValue=oT},ok.DEPTH_BUFFER_BIT=256,ok.STENCIL_BUFFER_BIT=1024,ok.COLOR_BUFFER_BIT=16384,ok.POINTS=0,ok.LINES=1,ok.LINE_LOOP=2,ok.LINE_STRIP=3,ok.TRIANGLES=4,ok.TRIANGLE_STRIP=5,ok.TRIANGLE_FAN=6,ok.ZERO=0,ok.ONE=1,ok.SRC_COLOR=768,ok.ONE_MINUS_SRC_COLOR=769,ok.SRC_ALPHA=770,ok.ONE_MINUS_SRC_ALPHA=771,ok.DST_ALPHA=772,ok.ONE_MINUS_DST_ALPHA=773,ok.DST_COLOR=774,ok.ONE_MINUS_DST_COLOR=775,ok.SRC_ALPHA_SATURATE=776,ok.FUNC_ADD=32774,ok.BLEND_EQUATION=32777,ok.BLEND_EQUATION_RGB=32777,ok.BLEND_EQUATION_ALPHA=34877,ok.FUNC_SUBTRACT=32778,ok.FUNC_REVERSE_SUBTRACT=32779,ok.BLEND_DST_RGB=32968,ok.BLEND_SRC_RGB=32969,ok.BLEND_DST_ALPHA=32970,ok.BLEND_SRC_ALPHA=32971,ok.CONSTANT_COLOR=32769,ok.ONE_MINUS_CONSTANT_COLOR=32770,ok.CONSTANT_ALPHA=32771,ok.ONE_MINUS_CONSTANT_ALPHA=32772,ok.BLEND_COLOR=32773,ok.ARRAY_BUFFER=34962,ok.ELEMENT_ARRAY_BUFFER=34963,ok.ARRAY_BUFFER_BINDING=34964,ok.ELEMENT_ARRAY_BUFFER_BINDING=34965,ok.STREAM_DRAW=35040,ok.STATIC_DRAW=35044,ok.DYNAMIC_DRAW=35048,ok.BUFFER_SIZE=34660,ok.BUFFER_USAGE=34661,ok.CURRENT_VERTEX_ATTRIB=34342,ok.FRONT=1028,ok.BACK=1029,ok.CULL_FACE=2884,ok.FRONT_AND_BACK=1032,ok.BLEND=3042,ok.DITHER=3024,ok.STENCIL_TEST=2960,ok.DEPTH_TEST=2929,ok.SCISSOR_TEST=3089,ok.POLYGON_OFFSET_FILL=32823,ok.SAMPLE_ALPHA_TO_COVERAGE=32926,ok.SAMPLE_COVERAGE=32928,ok.NO_ERROR=0,ok.INVALID_ENUM=1280,ok.INVALID_VALUE=1281,ok.INVALID_OPERATION=1282,ok.OUT_OF_MEMORY=1285,ok.CW=2304,ok.CCW=2305,ok.LINE_WIDTH=2849,ok.ALIASED_POINT_SIZE_RANGE=33901,ok.ALIASED_LINE_WIDTH_RANGE=33902,ok.CULL_FACE_MODE=2885,ok.FRONT_FACE=2886,ok.DEPTH_RANGE=2928,ok.DEPTH_WRITEMASK=2930,ok.DEPTH_CLEAR_VALUE=2931,ok.DEPTH_FUNC=2932,ok.STENCIL_CLEAR_VALUE=2961,ok.STENCIL_FUNC=2962,ok.STENCIL_FAIL=2964,ok.STENCIL_PASS_DEPTH_FAIL=2965,ok.STENCIL_PASS_DEPTH_PASS=2966,ok.STENCIL_REF=2967,ok.STENCIL_VALUE_MASK=2963,ok.STENCIL_WRITEMASK=2968,ok.STENCIL_BACK_FUNC=34816,ok.STENCIL_BACK_FAIL=34817,ok.STENCIL_BACK_PASS_DEPTH_FAIL=34818,ok.STENCIL_BACK_PASS_DEPTH_PASS=34819,ok.STENCIL_BACK_REF=36003,ok.STENCIL_BACK_VALUE_MASK=36004,ok.STENCIL_BACK_WRITEMASK=36005,ok.VIEWPORT=2978,ok.SCISSOR_BOX=3088,ok.COLOR_CLEAR_VALUE=3106,ok.COLOR_WRITEMASK=3107,ok.UNPACK_ALIGNMENT=3317,ok.PACK_ALIGNMENT=3333,ok.MAX_TEXTURE_SIZE=3379,ok.MAX_VIEWPORT_DIMS=3386,ok.SUBPIXEL_BITS=3408,ok.RED_BITS=3410,ok.GREEN_BITS=3411,ok.BLUE_BITS=3412,ok.ALPHA_BITS=3413,ok.DEPTH_BITS=3414,ok.STENCIL_BITS=3415,ok.POLYGON_OFFSET_UNITS=10752,ok.POLYGON_OFFSET_FACTOR=32824,ok.TEXTURE_BINDING_2D=32873,ok.SAMPLE_BUFFERS=32936,ok.SAMPLES=32937,ok.SAMPLE_COVERAGE_VALUE=32938,ok.SAMPLE_COVERAGE_INVERT=32939,ok.NUM_COMPRESSED_TEXTURE_FORMATS=34466,ok.COMPRESSED_TEXTURE_FORMATS=34467,ok.DONT_CARE=4352,ok.FASTEST=4353,ok.NICEST=4354,ok.GENERATE_MIPMAP_HINT=33170,ok.BYTE=5120,ok.UNSIGNED_BYTE=5121,ok.SHORT=5122,ok.UNSIGNED_SHORT=5123,ok.INT=5124,ok.UNSIGNED_INT=5125,ok.FLOAT=5126,ok.DEPTH_COMPONENT=6402,ok.ALPHA=6406,ok.RGB=6407,ok.RGBA=6408,ok.LUMINANCE=6409,ok.LUMINANCE_ALPHA=6410,ok.UNSIGNED_SHORT_4_4_4_4=32819,ok.UNSIGNED_SHORT_5_5_5_1=32820,ok.UNSIGNED_SHORT_5_6_5=33635,ok.FRAGMENT_SHADER=35632,ok.VERTEX_SHADER=35633,ok.MAX_VERTEX_ATTRIBS=34921,ok.MAX_VERTEX_UNIFORM_VECTORS=36347,ok.MAX_VARYING_VECTORS=36348,ok.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,ok.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,ok.MAX_TEXTURE_IMAGE_UNITS=34930,ok.MAX_FRAGMENT_UNIFORM_VECTORS=36349,ok.SHADER_TYPE=35663,ok.DELETE_STATUS=35712,ok.LINK_STATUS=35714,ok.VALIDATE_STATUS=35715,ok.ATTACHED_SHADERS=35717,ok.ACTIVE_UNIFORMS=35718,ok.ACTIVE_ATTRIBUTES=35721,ok.SHADING_LANGUAGE_VERSION=35724,ok.CURRENT_PROGRAM=35725,ok.NEVER=512,ok.LESS=513,ok.EQUAL=514,ok.LEQUAL=515,ok.GREATER=516,ok.NOTEQUAL=517,ok.GEQUAL=518,ok.ALWAYS=519,ok.KEEP=7680,ok.REPLACE=7681,ok.INCR=7682,ok.DECR=7683,ok.INVERT=5386,ok.INCR_WRAP=34055,ok.DECR_WRAP=34056,ok.VENDOR=7936,ok.RENDERER=7937,ok.VERSION=7938,ok.NEAREST=9728,ok.LINEAR=9729,ok.NEAREST_MIPMAP_NEAREST=9984,ok.LINEAR_MIPMAP_NEAREST=9985,ok.NEAREST_MIPMAP_LINEAR=9986,ok.LINEAR_MIPMAP_LINEAR=9987,ok.TEXTURE_MAG_FILTER=10240,ok.TEXTURE_MIN_FILTER=10241,ok.TEXTURE_WRAP_S=10242,ok.TEXTURE_WRAP_T=10243,ok.TEXTURE_2D=3553,ok.TEXTURE=5890,ok.TEXTURE_CUBE_MAP=34067,ok.TEXTURE_BINDING_CUBE_MAP=34068,ok.TEXTURE_CUBE_MAP_POSITIVE_X=34069,ok.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,ok.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,ok.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,ok.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,ok.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,ok.MAX_CUBE_MAP_TEXTURE_SIZE=34076,ok.TEXTURE0=33984,ok.TEXTURE1=33985,ok.TEXTURE2=33986,ok.TEXTURE3=33987,ok.TEXTURE4=33988,ok.TEXTURE5=33989,ok.TEXTURE6=33990,ok.TEXTURE7=33991,ok.TEXTURE8=33992,ok.TEXTURE9=33993,ok.TEXTURE10=33994,ok.TEXTURE11=33995,ok.TEXTURE12=33996,ok.TEXTURE13=33997,ok.TEXTURE14=33998,ok.TEXTURE15=33999,ok.TEXTURE16=34e3,ok.TEXTURE17=34001,ok.TEXTURE18=34002,ok.TEXTURE19=34003,ok.TEXTURE20=34004,ok.TEXTURE21=34005,ok.TEXTURE22=34006,ok.TEXTURE23=34007,ok.TEXTURE24=34008,ok.TEXTURE25=34009,ok.TEXTURE26=34010,ok.TEXTURE27=34011,ok.TEXTURE28=34012,ok.TEXTURE29=34013,ok.TEXTURE30=34014,ok.TEXTURE31=34015,ok.ACTIVE_TEXTURE=34016,ok.REPEAT=10497,ok.CLAMP_TO_EDGE=33071,ok.MIRRORED_REPEAT=33648,ok.FLOAT_VEC2=35664,ok.FLOAT_VEC3=35665,ok.FLOAT_VEC4=35666,ok.INT_VEC2=35667,ok.INT_VEC3=35668,ok.INT_VEC4=35669,ok.BOOL=35670,ok.BOOL_VEC2=35671,ok.BOOL_VEC3=35672,ok.BOOL_VEC4=35673,ok.FLOAT_MAT2=35674,ok.FLOAT_MAT3=35675,ok.FLOAT_MAT4=35676,ok.SAMPLER_2D=35678,ok.SAMPLER_CUBE=35680,ok.VERTEX_ATTRIB_ARRAY_ENABLED=34338,ok.VERTEX_ATTRIB_ARRAY_SIZE=34339,ok.VERTEX_ATTRIB_ARRAY_STRIDE=34340,ok.VERTEX_ATTRIB_ARRAY_TYPE=34341,ok.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,ok.VERTEX_ATTRIB_ARRAY_POINTER=34373,ok.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,ok.COMPILE_STATUS=35713,ok.LOW_FLOAT=36336,ok.MEDIUM_FLOAT=36337,ok.HIGH_FLOAT=36338,ok.LOW_INT=36339,ok.MEDIUM_INT=36340,ok.HIGH_INT=36341,ok.FRAMEBUFFER=36160,ok.RENDERBUFFER=36161,ok.RGBA4=32854,ok.RGB5_A1=32855,ok.RGB565=36194,ok.DEPTH_COMPONENT16=33189,ok.STENCIL_INDEX=6401,ok.STENCIL_INDEX8=36168,ok.DEPTH_STENCIL=34041,ok.RENDERBUFFER_WIDTH=36162,ok.RENDERBUFFER_HEIGHT=36163,ok.RENDERBUFFER_INTERNAL_FORMAT=36164,ok.RENDERBUFFER_RED_SIZE=36176,ok.RENDERBUFFER_GREEN_SIZE=36177,ok.RENDERBUFFER_BLUE_SIZE=36178,ok.RENDERBUFFER_ALPHA_SIZE=36179,ok.RENDERBUFFER_DEPTH_SIZE=36180,ok.RENDERBUFFER_STENCIL_SIZE=36181,ok.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,ok.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,ok.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,ok.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,ok.COLOR_ATTACHMENT0=36064,ok.DEPTH_ATTACHMENT=36096,ok.STENCIL_ATTACHMENT=36128,ok.DEPTH_STENCIL_ATTACHMENT=33306,ok.NONE=0,ok.FRAMEBUFFER_COMPLETE=36053,ok.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,ok.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,ok.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,ok.FRAMEBUFFER_UNSUPPORTED=36061,ok.FRAMEBUFFER_BINDING=36006,ok.RENDERBUFFER_BINDING=36007,ok.MAX_RENDERBUFFER_SIZE=34024,ok.INVALID_FRAMEBUFFER_OPERATION=1286,ok.UNPACK_FLIP_Y_WEBGL=37440,ok.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,ok.CONTEXT_LOST_WEBGL=37442,ok.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,ok.BROWSER_DEFAULT_WEBGL=37444,ok._useProgram=null,ok._depthTest=!0,ok._depthMask=!0,ok._blend=!1,ok._cullFace=!1,ok.curBindTexTarget=null,ok.curBindTexValue=null,on(ok,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),ok}(),oqo=function(oo){function or(){or.__super.call(this)}oi(or,"laya.webgl.display.GraphicsGL",oV);var oT=or.prototype;return oT.setShader=function(oo){this._saveToCmd(oK.context._setShader,[oo])},oT.setIBVB=function(oo,or,oT,ok,oW,oD){this._saveToCmd(oK.context._setIBVB,[oo,or,oT,ok,oW,oD])},oT.drawParticle=function(oo,or,oT){var ok=oS.createParticleTemplate2D(oT);ok.x=oo,ok.y=or,this._saveToCmd(oK.context._drawParticle,[ok])},or}(),obo=function(oo){var oT;function oJ(oo){this._x=0,this._y=0,this._id=++oJ._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,oJ.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=oJ.MAXCLIPRECT,this.mOutPoint,this._canvas=oo,this._canvas._addReference(),oJ._contextcount++,oK.isFlash?(this._ib=oEo.create(35044),o_o.fillIBQuadrangle(this._ib,16)):this._ib=oEo.QuadrangleIB,this.clear()}oi(oJ,"laya.webgl.canvas.WebGLContext2D",oW);var or=oJ.prototype;return or.setIsMainContext=function(){this._isMain=!0},or.clearBG=function(oo,or,oT,ok){var oW=olo.mainContext;oW.clearColor(oo,or,oT,ok),oW.clear(16384)},or._getSubmits=function(){return this._submits},or._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var oo=0,or=this._submits._length;oo<or;oo++)this._submits[oo].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},or.destroy=function(){--oJ._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=oEo.QuadrangleIB&&this._ib.releaseResource()},or.clear=function(){this._submits||(this._other=oT.DEFAULT,this._curMat=oP.create(),this._vb=odo.create(-1),this._submits=[],this._save=[oZ.Create(this)],this._save.length=10,this._shader2D=new oE,this._triangleMesh=oXo.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=oT.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=oJ.MAXCLIPRECT,this._curSubmit=oDo.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=oN.DEFAULT;for(var oo=0,or=this._submits._length;oo<or;oo++)this._submits[oo].releaseRender(),this._submits[oo]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},or.size=function(oo,or){if(this._width!=oo||this._height!=or)if(0==oo||0==or){0!=this._vb._byteLength&&(this._width=oo,this._height=or,this._vb.clear(),this._vb.upload());for(var oT=0,ok=this._submits._length;oT<ok;oT++)this._submits[oT].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=oo,this._height=or,this._targets&&this._targets.size(oo,or),this._canvas.memorySize-=this._canvas.memorySize;0===oo&&0===or&&this._releaseMem()},or._getTransformMatrix=function(){return this._curMat},or.translate=function(oo,or){0===oo&&0===or||(og.save(this),this._curMat.bTransform&&(oQ.save(this),this._curMat.transformPointN(ot.TEMP.setTo(oo,or)),oo=ot.TEMP.x,or=ot.TEMP.y),this._x+=oo,this._y+=or)},or.save=function(){this._save[this._save._length++]=oZ.Create(this)},or.restore=function(){var oo=this._save._length;if(!(oo<1))for(var or=oo-1;0<=or;or--){var oT=this._save[or];if(oT.restore(this),oT.isSaveMark())return void(this._save._length=or)}},or._fillText=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){void 0===oU&&(oU=0);var oh=this._shader2D,op=this._curSubmit.shaderValue,oi=oW?oxo.create(oW):this._other.font;if(oY.enabled)oh.ALPHA!==op.ALPHA&&(oh.glTexture=null),ovo.drawText(this,oo,or,this._curMat,oi,oL||this._other.textAlign,oD,on,oV,oT,ok,oU);else{this._shader2D.defines.getValue();var ov=oD?ox.create(oD)._color:oh.colorAdd;oh.ALPHA===op.ALPHA&&ov===oh.colorAdd&&op.colorAdd===oh.colorAdd||(oh.glTexture=null,oh.colorAdd=ov),ovo.drawText(this,oo,or,this._curMat,oi,oL||this._other.textAlign,oD,on,oV,oT,ok,oU)}},or.fillWords=function(oo,or,oT,ok,oW,oD){this._fillText(null,oo,or,oT,ok,oW,null,-1,null,oD)},or.fillBorderWords=function(oo,or,oT,ok,oW,oD,on){this._fillBorderText(null,oo,or,oT,ok,oW,oD,on,null)},or.fillText=function(oo,or,oT,ok,oW,oD){this._fillText(oo,null,or,oT,ok,oW,null,-1,oD)},or.strokeText=function(oo,or,oT,ok,oW,oD,on){this._fillText(oo,null,or,oT,ok,null,oW,oD||1,on)},or.fillBorderText=function(oo,or,oT,ok,oW,oD,on,oV){this._fillBorderText(oo,null,or,oT,ok,oW,oD,on,oV)},or._fillBorderText=function(oo,or,oT,ok,oW,oD,on,oV,oL){if(!oY.enabled)return this._fillText(oo,or,oT,ok,oW,null,on,oV||1,oL),void this._fillText(oo,or,oT,ok,oW,oD,null,-1,oL);var oU=this._shader2D,oh=this._curSubmit.shaderValue;oU.ALPHA!==oh.ALPHA&&(oU.glTexture=null);var op=oW?(oJ._fontTemp.setFont(oW),oJ._fontTemp):this._other.font;ovo.drawText(this,oo,or,this._curMat,op,oL||this._other.textAlign,oD,on,oV||1,oT,ok,0)},or.fillRect=function(oo,or,oT,ok,oW){var oD=this._vb;if(o_o.fillRectImgVb(oD,this._clipRect,oo,or,oT,ok,oX.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var on=this._shader2D.fillStyle;oW&&(this._shader2D.fillStyle=oN.create(oW));var oV=this._shader2D,oL=this._curSubmit.shaderValue;if(oV.fillStyle!==oL.fillStyle||oV.ALPHA!==oL.ALPHA){oV.glTexture=null;var oU=this._curSubmit=oDo.createSubmit(this,this._ib,oD,(oD._byteLength-64)/32*3,oFo.create(2,0));oU.shaderValue.color=oV.fillStyle._color._color,oU.shaderValue.ALPHA=oV.ALPHA,this._submits[this._submits._length++]=oU}this._curSubmit._numEle+=6,this._shader2D.fillStyle=on}},or.fillTexture=function(oo,or,oT,ok,oW,oD,on,oV){if(oo.loaded&&oo.bitmap&&oo.source){var oL=this._vb,oU=oo.bitmap.width,oh=oo.bitmap.height,op=oo.uv,oi=on.x%oo.width,ov=on.y%oo.height;if(oU!=oV.w||oh!=oV.h){if(!oV.w&&!oV.h)switch(oV.oy=oV.ox=0,oD){case"repeat":oV.width=ok,oV.height=oW;break;case"repeat-x":oV.width=ok,ov<0?oo.height+ov>oW?oV.height=oW:oV.height=oo.height+ov:(oV.oy=ov,oo.height+ov>oW?oV.height=oW-ov:oV.height=oo.height);break;case"repeat-y":oi<0?oo.width+oi>ok?oV.width=ok:oV.width=oo.width+oi:(oV.ox=oi,oo.width+oi>ok?oV.width=ok-oi:oV.width=oo.width),oV.height=oW;break;case"no-repeat":oi<0?oo.width+oi>ok?oV.width=ok:oV.width=oo.width+oi:(oV.ox=oi,oo.width+oi>ok?oV.width=ok-oi:oV.width=oo.width),ov<0?oo.height+ov>oW?oV.height=oW:oV.height=oo.height+ov:(oV.oy=ov,oo.height+ov>oW?oV.height=oW-ov:oV.height=oo.height);break;default:oV.width=ok,oV.height=oW}oV.w=oU,oV.h=oh,oV.uv=[0,0,oV.width/oU,0,oV.width/oU,oV.height/oh,0,oV.height/oh]}if(or+=oV.ox,oT+=oV.oy,oi-=oV.ox,ov-=oV.oy,o_o.fillRectImgVb(oL,this._clipRect,or,oT,oV.width,oV.height,oV.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var ox=oCo.create(this,this._ib,oL,(oL._byteLength-64)/32*3,oFo.create(256,0)),oj=(this._submits[this._submits._length++]=ox).shaderValue;oj.textureHost=oo;var o_=op[0]*oU,oK=op[1]*oh,o$=(op[2]-op[0])*oU,oy=(op[5]-op[3])*oh,ol=-oi/oU,oS=-ov/oh;oj.u_TexRange[0]=o_/oU,oj.u_TexRange[1]=o$/oU,oj.u_TexRange[2]=oK/oh,oj.u_TexRange[3]=oy/oh,oj.u_offset[0]=ol,oj.u_offset[1]=oS,oY.enabled&&!this._isMain&&ox.addTexture(oo,(oL._byteLength>>2)-16),(this._curSubmit=ox)._renderType=10017,ox._numEle+=6}}else this.sprite&&oq.timer.callLater(this,this._repaintSprite)},or.setShader=function(oo){oa.save(this,1048576,this._shader2D,!0),this._shader2D.shader=oo},or.setFilters=function(oo){oa.save(this,2097152,this._shader2D,!0),this._shader2D.filters=oo,this._curSubmit=oDo.RENDERBASE,this._renderKey=0,this._drawCount++},or.drawTexture=function(oo,or,oT,ok,oW,oD,on){this._drawTextureM(oo,or,oT,ok,oW,oD,on,null,1)},or.addTextureVb=function(oo,or,oT){var ok=this._curSubmit._vb||this._vb,oW=ok._byteLength>>2;ok.byteLength=oW+16<<2;for(var oD=ok.getFloat32Array(),on=0;on<16;on+=4)oD[oW++]=oo[on]+or,oD[oW++]=oo[on+1]+oT,oD[oW++]=oo[on+2],oD[oW++]=oo[on+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),ok._upload=!0},or.willDrawTexture=function(oo,or){if(!(oo.loaded&&oo.bitmap&&oo.source))return this.sprite&&oq.timer.callLater(this,this._repaintSprite),0;var oT=oo.bitmap,ok=oT.id+this._shader2D.ALPHA*or+10016;if(ok==this._renderKey)return ok;var oW=this._shader2D,oD=oW.ALPHA,on=this._curSubmit.shaderValue;oW.ALPHA*=or,this._renderKey=ok,this._drawCount++,oW.glTexture=oT;var oV=this._vb,oL=null,oU=oV._byteLength/32*3,oh=on.textureHost&&on.textureHost==oo&&on.textureHost.alphaTexture==oo.alphaTexture;return oL=oCo.create(this,this._ib,oV,oU,oFo.create(1,0)),(this._submits[this._submits._length++]=oL).shaderValue.textureHost=oo,oL._renderType=10016,oL._preIsSameTextureShader=10016===this._curSubmit._renderType&&oW.ALPHA===on.ALPHA&&oh,this._curSubmit=oL,oW.ALPHA=oD,ok},or.drawTextures=function(oo,or,oT,ok){if(oo.loaded&&oo.bitmap&&oo.source){var oW=this._clipRect;if(this._clipRect=oJ.MAXCLIPRECT,this._drawTextureM(oo,or[0],or[1],oo.width,oo.height,oT,ok,null,1)){if(this._clipRect=oW,os.drawCall++,!(or.length<4)){for(var oD=this._curSubmit._vb||this._vb,on=this._curMat.a,oV=this._curMat.d,oL=2,oU=or.length;oL<oU;oL+=2)o_o.copyPreImgVb(oD,(or[oL]-or[oL-2])*on,(or[oL+1]-or[oL-1])*oV),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&oq.timer.callLater(this,this._repaintSprite)},or._drawTextureM=function(oo,or,oT,ok,oW,oD,on,oV,oL){if(!oo.loaded||!oo.source)return this.sprite&&oq.timer.callLater(this,this._repaintSprite),!1;var oU=this._curSubmit._vb||this._vb,oh=oo.bitmap;or+=oD,oT+=on,this._drawCount++;var op=oh.id+this._shader2D.ALPHA*oL+10016;if(op!=this._renderKey){this._renderKey=op;var oi=this._curSubmit.shaderValue,ov=this._shader2D,ox=ov.ALPHA;ov.ALPHA*=oL,ov.glTexture=oh;var oj=this._vb,o_=null,oK=oj._byteLength/32*3,o$=oi.textureHost&&oi.textureHost==oo&&oi.textureHost.alphaTexture==oo.alphaTexture;o_=oCo.create(this,this._ib,oj,oK,oFo.create(1,0)),(this._submits[this._submits._length++]=o_).shaderValue.textureHost=oo,o_._renderType=10016,o_._preIsSameTextureShader=10016===this._curSubmit._renderType&&ov.ALPHA===oi.ALPHA&&o$,this._curSubmit=o_,oU=this._curSubmit._vb||this._vb,ov.ALPHA=ox}return!!o_o.fillRectImgVb(oU,this._clipRect,or,oT,ok||oo.width,oW||oo.height,oo.uv,oV||this._curMat,this._x,this._y,0,0)&&(oY.enabled&&!this._isMain&&this._curSubmit.addTexture(oo,(oU._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},or._repaintSprite=function(){this.sprite&&this.sprite.repaint()},or._drawText=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){var oh=oo.bitmap;this._drawCount++;var op=oh.id+this._shader2D.ALPHA+10016;if(op!=this._renderKey){this._renderKey=op;var oi=this._curSubmit.shaderValue,ov=this._shader2D;ov.glTexture=oh;var ox=this._vb,oj=null,o_=ox._byteLength/32*3,oK=oi.textureHost&&oi.textureHost==oo&&oi.textureHost.alphaTexture==oo.alphaTexture;(oj=oY.enabled?oCo.create(this,this._ib,ox,o_,oFo.create(1,0)):oCo.create(this,this._ib,ox,o_,ogo.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&ov.ALPHA===oi.ALPHA&&oK,(this._submits[this._submits._length++]=oj).shaderValue.textureHost=oo,oj._renderType=10016,this._curSubmit=oj}oo.active();var o$=this._curSubmit._vb||this._vb;o_o.fillRectImgVb(o$,this._clipRect,or+on,oT+oV,ok||oo.width,oW||oo.height,oo.uv,oD||this._curMat,this._x,this._y,oL,oU,!0)&&(oY.enabled&&!this._isMain&&this._curSubmit.addTexture(oo,(o$._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},or.drawTextureWithTransform=function(oo,or,oT,ok,oW,oD,on,oV,oL){if(oD){var oU=this._curMat,oh=this._x,op=this._y;(0!==on||0!==oV)&&(this._x=on*oU.a+oV*oU.c,this._y=oV*oU.d+on*oU.b),oD&&oU.bTransform?(oP.mul(oD,oU,oJ._tmpMatrix),(oD=oJ._tmpMatrix)._checkTransform()):(this._x+=oU.tx,this._y+=oU.ty),this._drawTextureM(oo,or,oT,ok,oW,0,0,oD,oL),this._x=oh,this._y=op}else this._drawTextureM(oo,or,oT,ok,oW,on,oV,null,oL)},or.fillQuadrangle=function(oo,or,oT,ok,oW){var oD=this._curSubmit,on=this._vb,oV=this._shader2D,oL=oD.shaderValue;if(this._renderKey=0,oo.bitmap){var oU=oo.bitmap;oV.glTexture==oU&&oV.ALPHA===oL.ALPHA||(oV.glTexture=oU,(oD=this._curSubmit=oDo.createSubmit(this,this._ib,on,on._byteLength/32*3,oFo.create(1,0))).shaderValue.glTexture=oU,this._submits[this._submits._length++]=oD),o_o.fillQuadrangleImgVb(on,or,oT,ok,oo.uv,oW||this._curMat,this._x,this._y)}else oD.shaderValue.fillStyle&&oD.shaderValue.fillStyle.equal(oo)&&oV.ALPHA===oL.ALPHA||(oV.glTexture=null,(oD=this._curSubmit=oDo.createSubmit(this,this._ib,on,on._byteLength/32*3,oFo.create(2,0))).shaderValue.defines.add(2),oD.shaderValue.fillStyle=oN.create(oo),this._submits[this._submits._length++]=oD),o_o.fillQuadrangleImgVb(on,or,oT,ok,oX.DEF_UV,oW||this._curMat,this._x,this._y);oD._numEle+=6},or.drawTexture2=function(oo,or,oT,ok,oW,oD,on,oV){if(0!=oD){var oL=this._curMat;if(this._x=oo*oL.a+or*oL.c,this._y=or*oL.d+oo*oL.b,oW&&(oW=oL.bTransform||oW.bTransform?(oP.mul(oW,oL,oJ._tmpMatrix),oJ._tmpMatrix):(this._x+=oW.tx+oL.tx,this._y+=oW.ty+oL.ty,oP.EMPTY)),1!==oD||on){var oU=this._shader2D.ALPHA,oh=this._nBlendType;this._shader2D.ALPHA=oD,on&&(this._nBlendType=oI.TOINT(on)),this._drawTextureM(oV[0],oV[1]-oT,oV[2]-ok,oV[3],oV[4],0,0,oW,1),this._shader2D.ALPHA=oU,this._nBlendType=oh}else this._drawTextureM(oV[0],oV[1]-oT,oV[2]-ok,oV[3],oV[4],0,0,oW,1);this._x=this._y=0}},or.drawCanvas=function(oo,or,oT,ok,oW){var oD=oo.context;if(this._renderKey=0,oD._targets)this._submits[this._submits._length++]=omo.create(oD,0,null),this._curSubmit=oDo.RENDERBASE,oD._targets.drawTo(this,or,oT,ok,oW);else{var on=this._submits[this._submits._length++]=omo.create(oD,this._shader2D.ALPHA,this._shader2D.filters),oV=ok/oo.width,oL=oW/oo.height,oU=on._matrix;this._curMat.copyTo(oU),1!=oV&&1!=oL&&oU.scale(oV,oL);var oh=oU.tx,op=oU.ty;oU.tx=oU.ty=0,oU.transformPoint(ot.TEMP.setTo(or,oT)),oU.translate(ot.TEMP.x+oh,ot.TEMP.y+op),this._curSubmit=oDo.RENDERBASE}ob.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=oD._targets?"yellow":"green",this.strokeRect(or-1,oT-1,ok+2,oW+2,1),this.strokeRect(or,oT,ok,oW,1),this.restore())},or.drawTarget=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){void 0===oU&&(oU=-1);var oh=this._vb;if(o_o.fillRectImgVb(oh,this._clipRect,or,oT,ok,oW,oL||oX.DEF_UV,oD||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var op=this._curSubmit=opo.create(this,this._ib,oh,(oh._byteLength-64)/32*3,oV,on);op.blendType=-1==oU?this._nBlendType:oU,op.scope=oo,this._submits[this._submits._length++]=op,this._curSubmit._numEle+=6}},or.mixRGBandAlpha=function(oo){return this._mixRGBandAlpha(oo,this._shader2D.ALPHA)},or._mixRGBandAlpha=function(oo,or){var oT=(4278190080&oo)>>>24;return 0!=oT?oT*=or:oT=255*or,16777215&oo|oT<<24},or.drawTriangles=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){if(!oo.loaded||!oo.source)return this.sprite&&oq.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;oo.bitmap;var oh=this._mixRGBandAlpha(4294967295,oV),op=(ok.length,oD.length);this._renderKey=-1;var oi=this._curSubmit=oCo.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,oFo.create(1,0));return oi.shaderValue.textureHost=oo,oi._renderType=10016,this._submits[this._submits._length++]=oi,on?(oJ._tmpMatrix.a=on.a,oJ._tmpMatrix.b=on.b,oJ._tmpMatrix.c=on.c,oJ._tmpMatrix.d=on.d,oJ._tmpMatrix.tx=on.tx+or,oJ._tmpMatrix.ty=on.ty+oT,oP.mul(oJ._tmpMatrix,this._curMat,oJ._tmpMatrix)):(oJ._tmpMatrix.a=this._curMat.a,oJ._tmpMatrix.b=this._curMat.b,oJ._tmpMatrix.c=this._curMat.c,oJ._tmpMatrix.d=this._curMat.d,oJ._tmpMatrix.tx=this._curMat.tx+or,oJ._tmpMatrix.ty=this._curMat.ty+oT),this._triangleMesh.addData(ok,oW,oD,oJ._tmpMatrix,oh,this),this._curSubmit._numEle+=op,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},or.transform=function(oo,or,oT,ok,oW,oD){oQ.save(this),oP.mul(oP.TEMP.setTo(oo,or,oT,ok,oW,oD),this._curMat,this._curMat),this._curMat._checkTransform()},or.setTransformByMatrix=function(oo){oo.copyTo(this._curMat)},or.transformByMatrix=function(oo){oQ.save(this),oP.mul(oo,this._curMat,this._curMat),this._curMat._checkTransform()},or.rotate=function(oo){oQ.save(this),this._curMat.rotateEx(oo)},or.scale=function(oo,or){oQ.save(this),this._curMat.scaleEx(oo,or)},or.clipRect=function(oo,or,oT,ok){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var oW=oho.create(4);this.addRenderObject(oW);var oD=this._vb,on=oD._byteLength>>2;if(o_o.fillRectImgVb(oD,null,oo,or,oT,ok,oX.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var oV=this._curSubmit=oDo.createSubmit(this,this._ib,oD,(oD._byteLength-64)/32*3,oFo.create(2,0));oV.shaderValue.ALPHA=1,this._submits[this._submits._length++]=oV,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var oL=oho.create(5);this.addRenderObject(oL);var oU=oD.getFloat32Array(),oh=Math.min(Math.min(Math.min(oU[0+on],oU[4+on]),oU[8+on]),oU[12+on]),op=Math.max(Math.max(Math.max(oU[0+on],oU[4+on]),oU[8+on]),oU[12+on]),oi=Math.min(Math.min(Math.min(oU[1+on],oU[5+on]),oU[9+on]),oU[13+on]),ov=Math.max(Math.max(Math.max(oU[1+on],oU[5+on]),oU[9+on]),oU[13+on]);ow.save(this,oL,oo,or,oT,ok,oh,oi,op-oh,ov-oi),this._curSubmit=oDo.RENDERBASE}else{oT*=this._curMat.a,ok*=this._curMat.d;var ox=ot.TEMP;this._curMat.transformPoint(ox.setTo(oo,or)),oT<0&&(ox.x=ox.x+oT,oT=-oT),ok<0&&(ox.y=ox.y+ok,ok=-ok),this._renderKey=0;var oj=this._curSubmit=oUo.create(this);(this._submits[this._submits._length++]=oj).submitIndex=this._submits._length,oj.submitLength=9999999,oG.save(this,oj);var o_=this._clipRect,oK=o_.x,o$=o_.y,oy=ox.x+oT,ol=ox.y+ok;oK<ox.x&&(o_.x=ox.x),o$<ox.y&&(o_.y=ox.y),o_.width=Math.min(oy,oK+o_.width)-o_.x,o_.height=Math.min(ol,o$+o_.height)-o_.y,this._shader2D.glTexture=null,oj.clipRect.copyFrom(o_),this._curSubmit=oDo.RENDERBASE}},or.setIBVB=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh){if(void 0===oL&&(oL=0),void 0===oU&&(oU=0),void 0===oh&&(oh=0),null===oT){if(oK.isFlash){var op=ok;op._selfIB||(op._selfIB=oEo.create(35044)),op._selfIB.clear(),oT=op._selfIB}else oT=this._ib;o_o.expandIBQuadrangle(oT,ok._byteLength/(4*ok.vertexStride*4))}if(!oV||!on)throw Error("setIBVB must input:shader shaderValues");var oi=oLo.create(this,ok,oT,oW,on,oV,oL,oU,oh);oD||(oD=oP.EMPTY),oD.translate(oo,or),oP.mul(oD,this._curMat,oi._mat),oD.translate(-oo,-or),this._submits[this._submits._length++]=oi,this._curSubmit=oDo.RENDERBASE,this._renderKey=0},or.addRenderObject=function(oo){this._submits[this._submits._length++]=oo},or.fillTrangles=function(oo,or,oT,ok,oW){var oD=this._curSubmit,on=this._vb,oV=this._shader2D,oL=oD.shaderValue,oU=ok.length>>4,oh=oo.bitmap;this._renderKey=0,oV.glTexture==oh&&oV.ALPHA===oL.ALPHA||((oD=this._curSubmit=oDo.createSubmit(this,this._ib,on,on._byteLength/32*3,oFo.create(1,0))).shaderValue.textureHost=oo,this._submits[this._submits._length++]=oD),o_o.fillTranglesVB(on,or,oT,ok,oW||this._curMat,this._x,this._y),oD._numEle+=6*oU},or.submitElement=function(oo,or){var oT=this._submits;for(or<0&&(or=oT._length);oo<or;)oo+=oT[oo].renderSubmit()},or.finish=function(){olo.mainContext.finish()},or.flush=function(){var oo=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(oo>this._ib.bufferLength/12&&o_o.expandIBQuadrangle(this._ib,oo),!this._isMain&&oY.enabled&&oY._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=oY._atlasRestore;for(var or=this._submits,oT=0,ok=or._length;oT<ok;oT++){var oW=or[oT];10016===oW.getRenderType()&&oW.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),oro.instance&&oro.getInstance().reset();var oD;for(oT=0,oD=this.meshlist.length;oT<oD;oT++){var on=this.meshlist[oT];on.canReuse?on.releaseMesh():on.destroy()}return this.meshlist.length=0,this._curSubmit=oDo.RENDERBASE,this._renderKey=0,this._triangleMesh=oXo.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},or.setPathId=function(oo){if(this.mId=oo,-1!=this.mId){this.mHaveKey=!1;var or=oM.getInstance();or.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,or.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},or.movePath=function(oo,or){var oT=oo,ok=or;oo=this._curMat.a*oT+this._curMat.c*ok+this._curMat.tx,or=this._curMat.b*oT+this._curMat.d*ok+this._curMat.ty,this.mX+=oo,this.mY+=or},or.beginPath=function(){var oo=this._getPath();oo.tempArray.length=0,oo.closePath=!1,this.mX=0,this.mY=0},or.closePath=function(){this._path.closePath=!0},or.fill=function(oo){void 0===oo&&(oo=!1);var or=this._getPath();this.drawPoly(0,0,or.tempArray,this.fillStyle._color.numColor,0,0,oo)},or.stroke=function(){var oo=this._getPath();if(0<this.lineWidth){if(-1==this.mId)oo.drawLine(0,0,oo.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var or=oM.getInstance().shapeLineDic[this.mId];or.rebuild(oo.tempArray),oo.setGeomtry(or)}else oM.getInstance().addLine(this.mId,oo.drawLine(0,0,oo.tempArray,this.lineWidth,this.strokeStyle._color.numColor));oo.update();var oT=[this.mX,this.mY],ok=oDo.createShape(this,oo.ib,oo.vb,oo.count,oo.offset,oFo.create(4,0));ok.shaderValue.ALPHA=this._shader2D.ALPHA,ok.shaderValue.u_pos=oT,ok.shaderValue.u_mmat2=o$o.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=ok,this._renderKey=-1}},or.line=function(oo,or,oT,ok,oW,oD){var on=this._curSubmit,oV=this._vb;if(o_o.fillLineVb(oV,this._clipRect,oo,or,oT,ok,oW,oD)){this._renderKey=0;var oL=this._shader2D,oU=on.shaderValue;oL.strokeStyle===oU.strokeStyle&&oL.ALPHA===oU.ALPHA||(oL.glTexture=null,(on=this._curSubmit=oDo.createSubmit(this,this._ib,oV,(oV._byteLength-64)/32*3,oFo.create(2,0))).shaderValue.strokeStyle=oL.strokeStyle,on.shaderValue.mainID=2,on.shaderValue.ALPHA=oL.ALPHA,this._submits[this._submits._length++]=on),on._numEle+=6}},or.moveTo=function(oo,or,oT){void 0===oT&&(oT=!0);var ok=this._getPath();if(oT){var oW=oo,oD=or;oo=this._curMat.a*oW+this._curMat.c*oD,or=this._curMat.b*oW+this._curMat.d*oD}ok.addPoint(oo,or)},or.lineTo=function(oo,or,oT){void 0===oT&&(oT=!0);var ok=this._getPath();if(oT){var oW=oo,oD=or;oo=this._curMat.a*oW+this._curMat.c*oD,or=this._curMat.b*oW+this._curMat.d*oD}ok.addPoint(oo,or)},or.drawCurves=function(oo,or,oT){this.setPathId(-1),this.beginPath(),this.strokeStyle=oT[3],this.lineWidth=oT[4];var ok=oT[2];oo+=oT[0],or+=oT[1],this.movePath(oo,or),this.moveTo(ok[0],ok[1]);for(var oW=2,oD=ok.length;oW<oD;)this.quadraticCurveTo(ok[oW++],ok[oW++],ok[oW++],ok[oW++]);this.stroke()},or.arcTo=function(oo,or,oT,ok,oW){if(-1==this.mId||!this.mHaveKey){var oD=0,on=0,oV=0,oL=this._getPath();this._curMat.copyTo(oJ._tmpMatrix),oJ._tmpMatrix.tx=oJ._tmpMatrix.ty=0,oJ._tempPoint.setTo(oL.getEndPointX(),oL.getEndPointY()),oJ._tmpMatrix.invertTransformPoint(oJ._tempPoint);var oU=oJ._tempPoint.x-oo,oh=oJ._tempPoint.y-or,op=Math.sqrt(oU*oU+oh*oh);if(!(op<=1e-6)){var oi=oU/op,ov=oh/op,ox=oT-oo,oj=ok-or,o_=ox*ox+oj*oj,oK=Math.sqrt(o_);if(!(oK<=1e-6)){var o$=ox/oK,oy=oj/oK,ol=oi+o$,oS=ov+oy,oq=Math.sqrt(ol*ol+oS*oS);if(!(oq<=1e-6)){var ob=ol/oq,oF=oS/oq,oP=Math.acos(ob*oi+oF*ov),ot=Math.PI/2-oP,oH=(op=oW/Math.tan(ot))*oi+oo,oR=op*ov+or,ou=Math.sqrt(op*op+oW*oW),os=oo+ob*ou,oz=or+oF*ou,om=0,oC=0;if(0<=oi*oy-ov*o$){var oX=2*ot/oJ.SEGNUM;om=Math.sin(oX),oC=Math.cos(oX)}else oX=2*-ot/oJ.SEGNUM,om=Math.sin(oX),oC=Math.cos(oX);on=this._curMat.a*oH+this._curMat.c*oR,oV=this._curMat.b*oH+this._curMat.d*oR,on==this._path.getEndPointX()&&oV==this._path.getEndPointY()||oL.addPoint(on,oV);var oO=oH-os,oM=oR-oz;for(oD=0;oD<oJ.SEGNUM;oD++){var oc=oO*oC+oM*om,oe=-oO*om+oM*oC;on=oc+os,oV=oe+oz,oo=this._curMat.a*on+this._curMat.c*oV,oV=or=this._curMat.b*on+this._curMat.d*oV,(on=oo)==this._path.getEndPointX()&&oV==this._path.getEndPointY()||oL.addPoint(on,oV),oO=oc,oM=oe}}}}}},or.arc=function(oo,or,oT,ok,oW,oD,on){if(void 0===oD&&(oD=!1),void 0===on&&(on=!0),-1!=this.mId){var oV=oM.getInstance().shapeDic[this.mId];if(oV&&this.mHaveKey&&!oV.needUpdate(this._curMat))return;or=oo=0}var oL,oU=0,oh=0,op=0,oi=0,ov=0,ox=0,oj=0;if(oh=oW-ok,oD)if(Math.abs(oh)>=2*Math.PI)oh=2*-Math.PI;else for(;0<oh;)oh-=2*Math.PI;else if(Math.abs(oh)>=2*Math.PI)oh=2*Math.PI;else for(;oh<0;)oh+=2*Math.PI;oL=oh/(oj=oT<101?Math.max(10,oh*oT/5):oT<201?Math.max(10,oh*oT/20):Math.max(10,oh*oT/40))/2,op=Math.abs(4/3*(1-Math.cos(oL))/Math.sin(oL)),oD&&(op=-op);var o_=this._getPath(),oK=NaN,o$=NaN;for(ox=0;ox<=oj;ox++)oU=ok+oh*(ox/oj),oi=oo+Math.cos(oU)*oT,ov=or+Math.sin(oU)*oT,on&&(oK=oi,o$=ov,oi=this._curMat.a*oK+this._curMat.c*o$,ov=this._curMat.b*oK+this._curMat.d*o$),oi==this._path.getEndPointX()&&ov==this._path.getEndPointY()||o_.addPoint(oi,ov);oi=oo+Math.cos(oW)*oT,ov=or+Math.sin(oW)*oT,on&&(oK=oi,o$=ov,oi=this._curMat.a*oK+this._curMat.c*o$,ov=this._curMat.b*oK+this._curMat.d*o$),oi==this._path.getEndPointX()&&ov==this._path.getEndPointY()||o_.addPoint(oi,ov)},or.quadraticCurveTo=function(oo,or,oT,ok){var oW=op.I,oD=oT,on=ok;oT=this._curMat.a*oD+this._curMat.c*on,ok=this._curMat.b*oD+this._curMat.d*on,oD=oo,on=or,oo=this._curMat.a*oD+this._curMat.c*on,or=this._curMat.b*oD+this._curMat.d*on;for(var oV=oW.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),oo,or,oT,ok],30,2),oL=0,oU=oV.length/2;oL<oU;oL++)this.lineTo(oV[2*oL],oV[2*oL+1],!1);this.lineTo(oT,ok,!1)},or.rect=function(oo,or,oT,ok){this._other=this._other.make(),this._other.path||(this._other.path=new of),this._other.path.rect(oo,or,oT,ok)},or.strokeRect=function(oo,or,oT,ok,oW){var oD=.5*oW;this.line(oo-oD,or,oo+oT+oD,or,oW,this._curMat),this.line(oo+oT,or,oo+oT,or+ok,oW,this._curMat),this.line(oo,or,oo,or+ok,oW,this._curMat),this.line(oo-oD,or+ok,oo+oT+oD,or+ok,oW,this._curMat)},or.clip=function(){},or.drawPoly=function(oo,or,oT,ok,oW,oD,on){void 0===on&&(on=!1),this._renderKey=0,this._shader2D.glTexture=null;var oV=this._getPath();if(-1==this.mId)oV.polygon(oo,or,oT,ok,oW||1,oD);else if(this.mHaveKey){var oL=oM.getInstance().shapeDic[this.mId];oL.setMatrix(this._curMat),oL.rebuild(oV.tempArray),oV.setGeomtry(oL)}else{var oU=oV.polygon(oo,or,oT,ok,oW||1,oD);oM.getInstance().addShape(this.mId,oU),oU.setMatrix(this._curMat)}oV.update();var oh,op=[this.mX,this.mY];if((oh=oDo.createShape(this,oV.ib,oV.vb,oV.count,oV.offset,oFo.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,oh.shaderValue.u_pos=op,oh.shaderValue.u_mmat2=o$o.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=oh,0<oW){if(this.mHaveLineKey){var oi=oM.getInstance().shapeLineDic[this.mId];oi.rebuild(oV.tempArray),oV.setGeomtry(oi)}else oM.getInstance().addShape(this.mId,oV.drawLine(oo,or,oT,oW,oD));oV.update(),(oh=oDo.createShape(this,oV.ib,oV.vb,oV.count,oV.offset,oFo.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,oh.shaderValue.u_mmat2=o$o.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=oh}},or.drawParticle=function(oo,or,oT){oT.x=oo,oT.y=or,this._submits[this._submits._length++]=oT},or._getPath=function(){return this._path||(this._path=new of)},ok(0,or,"globalCompositeOperation",function(){return oI.NAMES[this._nBlendType]},function(oo){var or=oI.TOINT[oo];null==or||this._nBlendType===or||(oa.save(this,65536,this,!0),this._curSubmit=oDo.RENDERBASE,this._renderKey=0,this._nBlendType=or)}),ok(0,or,"strokeStyle",function(){return this._shader2D.strokeStyle},function(oo){this._shader2D.strokeStyle.equal(oo)||(oa.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=oN.create(oo))}),ok(0,or,"globalAlpha",function(){return this._shader2D.ALPHA},function(oo){(oo=Math.floor(1e3*oo)/1e3)!=this._shader2D.ALPHA&&(oa.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=oo)}),ok(0,or,"asBitmap",null,function(oo){if(oo){if(this._targets||(this._targets=new oB),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),ok(0,or,"fillStyle",function(){return this._shader2D.fillStyle},function(oo){this._shader2D.fillStyle.equal(oo)||(oa.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=oN.create(oo))}),ok(0,or,"textAlign",function(){return this._other.textAlign},function(oo){this._other.textAlign===oo||(this._other=this._other.make(),oa.save(this,32768,this._other,!1),this._other.textAlign=oo)}),ok(0,or,"lineWidth",function(){return this._other.lineWidth},function(oo){this._other.lineWidth===oo||(this._other=this._other.make(),oa.save(this,256,this._other,!1),this._other.lineWidth=oo)}),ok(0,or,"textBaseline",function(){return this._other.textBaseline},function(oo){this._other.textBaseline===oo||(this._other=this._other.make(),oa.save(this,16384,this._other,!1),this._other.textBaseline=oo)}),ok(0,or,"font",null,function(oo){oo!=this._other.font.toString()&&(this._other=this._other.make(),oa.save(this,8,this._other,!1),this._other.font===oxo.EMPTY?this._other.font=new oxo(oo):this._other.font.setFont(oo))}),oJ.__init__=function(){oT.DEFAULT=new oT},oJ._tempPoint=new ot,oJ._SUBMITVBSIZE=32e3,oJ._MAXSIZE=99999999,oJ._RECTVBSIZE=16,oJ.MAXCLIPRECT=new oH(0,0,99999999,99999999),oJ._COUNT=0,oJ._tmpMatrix=new oP,oJ.SEGNUM=32,oJ._contextcount=0,on(oJ,["_fontTemp",function(){return this._fontTemp=new oxo},"_drawStyleTemp",function(){return this._drawStyleTemp=new oN(null)}]),oJ.__init$=function(){oT=function(){function oo(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=oxo.EMPTY}oi(oo,"");var or=oo.prototype;return or.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=oxo.EMPTY},or.make=function(){return this===oo.DEFAULT?new oo:this},oo.DEFAULT=null,oo}()},oJ}(),oFo=function(oo){function ok(oo,or){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,ok.__super.call(this),this.defines=new oRo,this.position=ok._POSITION,this.mainID=oo,this.subID=or,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=oo|or,this._inClassCache=ok._cache[this._cacheID],0<oo&&!this._inClassCache&&(this._inClassCache=ok._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}oi(ok,"laya.webgl.shader.d2.value.Value2D",oe);var or=ok.prototype;return or.setValue=function(oo){},or.refresh=function(){var oo=this.size;return oo[0]=o$o.width,oo[1]=o$o.height,this.alpha=this.ALPHA*o$o.worldAlpha,this.mmat=o$o.worldMatrix4,this},or._ShaderWithCompile=function(){return oZo.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,oBo.create)},or._withWorldShaderDefines=function(){var oo=o$o.worldShaderDefines,or=oZo.sharders[this.mainID|this.defines._value|oo.getValue()];if(!or){var oT,ok={};for(oT in this.defines.toNameDic())ok[oT]="";for(oT in oo.toNameDic())ok[oT]="";or=oZo.withCompile2D(0,this.mainID,ok,this.mainID|this.defines._value|oo.getValue(),oBo.create)}var oW=o$o.worldFilters;if(!oW)return or;for(var oD,on=oW.length,oV=0;oV<on;oV++)(oD=oW[oV])&&oD.action.setValue(this);return or},or.upload=function(){var oo=o$o;this.alpha=this.ALPHA*oo.worldAlpha,o$o.worldMatrix4!==o$o.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),olo.shaderHighPrecision&&this.defines.add(1024);var or,oT=oo.worldShaderDefines?this._withWorldShaderDefines():oZo.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=oo.width,this.size[1]=oo.height,this.mmat=oo.worldMatrix4,oOo.activeShader!==oT?oT._shaderValueWidth!==oo.width||oT._shaderValueHeight!==oo.height?(oT._shaderValueWidth=oo.width,oT._shaderValueHeight=oo.height):or=oT._params2dQuick2||oT._make2dQuick2():oT._shaderValueWidth!==oo.width||oT._shaderValueHeight!==oo.height?(oT._shaderValueWidth=oo.width,oT._shaderValueHeight=oo.height):or=oT._params2dQuick1||oT._make2dQuick1(),oT.upload(this,or)},or.setFilters=function(oo){if(this.filters=oo)for(var or,oT=oo.length,ok=0;ok<oT;ok++)(or=oo[ok])&&(this.defines.add(or.type),or.action.setValue(this))},or.clear=function(){this.defines.setValue(this.subID)},or.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},ok._initone=function(oo,or){ok._typeClass[oo]=or,ok._cache[oo]=[],ok._cache[oo]._length=0},ok.__init__=function(){ok._POSITION=[2,5126,!1,4*ojo.BYTES_PE,0],ok._TEXCOORD=[2,5126,!1,4*ojo.BYTES_PE,2*ojo.BYTES_PE],ok._initone(2,oJo),ok._initone(4,oIo),ok._initone(256,oYo),ok._initone(512,oeo),ok._initone(1,oAo),ok._initone(65,ogo),ok._initone(9,oAo)},ok.create=function(oo,or){var oT=ok._cache[oo|or];return oT._length?oT[--oT._length]:new ok._typeClass[oo|or](or)},ok._POSITION=null,ok._TEXCOORD=null,ok._cache=[],ok._typeClass=[],ok.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ok}(),oPo=function(oo){function o_(oo,or){o_.__super.call(this,oo,or)}oi(o_,"laya.webgl.utils.RenderSprite3D",o$);var or=o_.prototype;return or.onCreate=function(oo){switch(oo){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},or._mask=function(oo,or,oT,ok){var oW,oD,on=this._next,oV=oo.mask;if(oV){or.ctx.save();var oL=or.ctx.globalCompositeOperation,oU=new oH;if(oU.copyFrom(oV.getBounds()),oU.width=Math.round(oU.width),oU.height=Math.round(oU.height),oU.x=Math.round(oU.x),oU.y=Math.round(oU.y),0<oU.width&&0<oU.height){var oh=oo._style._tf,op=oVo.create();op.addValue("bounds",oU),oW=ono.create([op,or],laya.webgl.utils.RenderSprite3D.tmpTarget),or.addRenderObject(oW),oV.render(or,-oU.x,-oU.y),oW=ono.create([op],laya.webgl.utils.RenderSprite3D.endTmpTarget),or.addRenderObject(oW),or.ctx.save(),or.clipRect(oT-oh.translateX+oU.x,ok-oh.translateY+oU.y,oU.width,oU.height),on._fun.call(on,oo,or,oT,ok),or.ctx.restore(),oD=oho.create(6),oL=or.ctx.globalCompositeOperation,oD.blendMode="mask",or.addRenderObject(oD),oP.TEMP.identity();var oi=oFo.create(1,0),ov=oX.INV_UV,ox=oU.width,oj=oU.height;(oU.width<32||oU.height<32)&&((ov=o_.tempUV)[0]=0,ov[1]=0,ov[2]=32<=oU.width?1:oU.width/32,ov[3]=0,ov[4]=32<=oU.width?1:oU.width/32,ov[5]=32<=oU.height?1:oU.height/32,ov[6]=0,ov[7]=32<=oU.height?1:oU.height/32,oU.width=32<=oU.width?oU.width:32,oU.height=32<=oU.height?oU.height:32,ov[1]*=-1,ov[3]*=-1,ov[5]*=-1,ov[7]*=-1,ov[1]+=1,ov[3]+=1,ov[5]+=1,ov[7]+=1),or.ctx.drawTarget(op,oT+oU.x-oh.translateX,ok+oU.y-oh.translateY,ox,oj,oP.TEMP,"tmpTarget",oi,ov,6),oW=ono.create([op],laya.webgl.utils.RenderSprite3D.recycleTarget),or.addRenderObject(oW),(oD=oho.create(6)).blendMode=oL,or.addRenderObject(oD)}or.ctx.restore()}else on._fun.call(on,oo,or,oT,ok)},or._blend=function(oo,or,oT,ok){var oW=oo._style,oD=this._next;oW.blendMode?(or.ctx.save(),or.ctx.globalCompositeOperation=oW.blendMode,oD._fun.call(oD,oo,or,oT,ok),or.ctx.restore()):oD._fun.call(oD,oo,or,oT,ok)},or._transform=function(oo,or,oT,ok){var oW=oo.transform,oD=this._next;if(oW&&oD!=o$.NORENDER){var on=or.ctx;oo._style;oW.tx=oT,oW.ty=ok;var oV=on._getTransformMatrix(),oL=oV.clone();oP.mul(oW,oV,oV),oV._checkTransform(),oW.tx=oW.ty=0,oD._fun.call(oD,oo,or,0,0),oL.copyTo(oV),oL.destroy()}else oD._fun.call(oD,oo,or,oT,ok)},o_.tmpTarget=function(oo,or){var oT=oo.getValue("bounds"),ok=oMo.create(oT.width,oT.height);ok.start(),ok.clear(0,0,0,0),oo.addValue("tmpTarget",ok)},o_.endTmpTarget=function(oo){oo.getValue("tmpTarget").end()},o_.recycleTarget=function(oo){oo.getValue("tmpTarget").recycle(),oo.recycle()},on(o_,["tempUV",function(){return this.tempUV=new Array(8)}]),o_}(),oto=function(oo){function or(){this.data=null,or.__super.call(this)}oi(or,"laya.filters.webgl.ColorFilterActionGL",oc);var oT=or.prototype;return oq.imps(oT,{"laya.filters.IFilterActionGL":!0}),oT.setValue=function(oo){oo.colorMat=this.data._mat,oo.colorAlpha=this.data._alpha},oT.apply3d=function(oo,or,oT,ok,oW){var oD=oo.getValue("bounds"),on=oFo.create(1,0);on.setFilters([this.data]);var oV=oP.TEMP;oV.identity(),oT.ctx.drawTarget(oo,0,0,oD.width,oD.height,oV,"src",on)},or}(),oHo=function(oo){function oD(oo,or,oT,ok,oW){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,oD.__super.call(this,oo,or,oW),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new oNo,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=oT,this._atlasCanvas.height=ok,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}oi(oD,"laya.webgl.atlas.Atlaser",oJ);var or=oD.prototype;return or.computeUVinAtlasTexture=function(oo,or,oT,ok){var oW=oY.atlasTextureWidth,oD=oY.atlasTextureHeight,on=oT/oW,oV=ok/oD,oL=(oT+oo.bitmap.width)/oW,oU=(ok+oo.bitmap.height)/oD,oh=oo.bitmap.width/oW,op=oo.bitmap.height/oD;oo.uv=[on+or[0]*oh,oV+or[1]*op,oL-(1-or[2])*oh,oV+or[3]*op,oL-(1-or[4])*oh,oU-(1-or[5])*op,on+or[6]*oh,oU-(1-or[7])*op]},or.findBitmapIsExist=function(oo){if(oo instanceof laya.webgl.resource.WebGLImage){var or=oo,oT=or.url,ok=this._InAtlasWebGLImagesKey[oT||or.id];if(ok)return ok.offsetInfoID}return-1},or.addToAtlasTexture=function(oo,or,oT){if(oo instanceof laya.webgl.resource.WebGLImage){var ok=oo,oW=ok.url;this._InAtlasWebGLImagesKey[oW||ok.id]={bitmap:oo,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([or,oT])}this._atlasCanvas.texSubImage2D(or,oT,oo.atlasSource),oo.clearAtlasSource()},or.addToAtlas=function(oo,or,oT){oo._atlasID=this._inAtlasTextureKey.length;var ok=oo.uv.slice(),oW=oo.bitmap;this._inAtlasTextureKey.push(oo),this._inAtlasTextureOriUVValue.push(ok),this._inAtlasTextureBitmapValue.push(oW),this.computeUVinAtlasTexture(oo,ok,or,oT),oo.bitmap=this._atlasCanvas},or.clear=function(){for(var oo=0,or=this._inAtlasTextureKey.length;oo<or;oo++)this._inAtlasTextureKey[oo].bitmap=this._inAtlasTextureBitmapValue[oo],this._inAtlasTextureKey[oo].uv=this._inAtlasTextureOriUVValue[oo],this._inAtlasTextureKey[oo]._atlasID=-1,this._inAtlasTextureKey[oo].bitmap.lock=!1,this._inAtlasTextureKey[oo].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},or.dispose=function(){this.clear(),this._atlasCanvas.destroy()},ok(0,or,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),ok(0,or,"texture",function(){return this._atlasCanvas}),ok(0,or,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),oD}(),oRo=function(oo){function oT(){oT.__super.call(this,oT.__name2int,oT.__int2name,oT.__int2nameMap)}return oi(oT,"laya.webgl.shader.d2.ShaderDefines2D",od),oT.__init__=function(){oT.reg("TEXTURE2D",1),oT.reg("COLOR2D",2),oT.reg("PRIMITIVE",4),oT.reg("GLOW_FILTER",8),oT.reg("BLUR_FILTER",16),oT.reg("COLOR_FILTER",32),oT.reg("COLOR_ADD",64),oT.reg("WORLDMAT",128),oT.reg("FILLTEXTURE",256),oT.reg("FSHIGHPRECISION",1024),oT.reg("TXTALPHA",2048),oT.reg("TXTCOMPRESS",4096)},oT.reg=function(oo,or){od._reg(oo,or,oT.__name2int,oT.__int2name)},oT.toText=function(oo,or,oT){return od._toText(oo,or,oT)},oT.toInt=function(oo){return od._toInt(oo,oT.__name2int)},oT.TEXTURE2D=1,oT.COLOR2D=2,oT.PRIMITIVE=4,oT.FILTERGLOW=8,oT.FILTERBLUR=16,oT.FILTERCOLOR=32,oT.COLORADD=64,oT.WORLDMAT=128,oT.FILLTEXTURE=256,oT.SKINMESH=512,oT.SHADERDEFINE_FSHIGHPRECISION=1024,oT.TXTALPHA=2048,oT.TXTCOMPRESS=4096,oT.__name2int={},oT.__int2name=[],oT.__int2nameMap=[],oT}(),ouo=(function(oo){function oV(oo,or,oT,ok,oW,oD,on){oV.__super.call(this,oo,or,oT,ok,40,oW,oD,on)}oi(oV,"laya.webgl.shapes.Ellipse",oTo)}(),function(oo){function oD(oo,or,oT,ok,oW){this._points=[],this.rebuild(oT),oD.__super.call(this,oo,or,0,0,0,oW,ok,oW,0)}oi(oD,"laya.webgl.shapes.Line",oTo);var or=oD.prototype;return or.rebuild=function(oo){var or=oo.length;or!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(or/2-1)),this.mFloat32Array=new Float32Array(5*or)),this._points.length=0;for(var oT=NaN,ok=NaN,oW=-1,oD=-1,on=oo.length/2,oV=0;oV<on;oV++)oT=oo[2*oV],ok=oo[2*oV+1],(.01<Math.abs(oW-oT)||.01<Math.abs(oD-ok))&&this._points.push(oT,ok),oW=oT,oD=ok},or.getData=function(oo,or,oT){var ok=[],oW=[];0<this.borderWidth&&this.createLine2(this._points,ok,this.borderWidth,oT,oW,this._points.length/2),this.mUint16Array.set(ok,0),this.mFloat32Array.set(oW,0),oo.append(this.mUint16Array),or.append(this.mFloat32Array)},oD}()),oso=function(oo){function op(oo,or,oT,ok,oW){this._points=[];for(var oD=NaN,on=NaN,oV=-1,oL=-1,oU=oT.length/2-1,oh=0;oh<oU;oh++)oD=oT[2*oh],on=oT[2*oh+1],(.01<Math.abs(oV-oD)||.01<Math.abs(oL-on))&&this._points.push(oD,on),oV=oD,oL=on;oD=oT[2*oU],on=oT[2*oU+1],oV=this._points[0],oL=this._points[1],(.01<Math.abs(oV-oD)||.01<Math.abs(oL-on))&&this._points.push(oD,on),op.__super.call(this,oo,or,0,0,this._points.length/2,0,ok,oW)}oi(op,"laya.webgl.shapes.LoopLine",oTo);var or=op.prototype;return or.getData=function(oo,or,oT){if(0<this.borderWidth){for(var ok=this.color,oW=(ok>>16&255)/255,oD=(ok>>8&255)/255,on=(255&ok)/255,oV=[],oL=0,oU=0,oh=[],op=Math.floor(this._points.length/2),oi=0;oi<op;oi++)oL=this._points[2*oi],oU=this._points[2*oi+1],oV.push(this.x+oL,this.y+oU,oW,oD,on);this.createLoopLine(oV,oh,this.borderWidth,oT+oV.length/5),oo.append(new Uint16Array(oh)),or.append(new Float32Array(oV))}},or.createLoopLine=function(oo,or,oT,ok,oW,oD){oo.length;var on=oo.concat(),oV=oW||oo,oL=this.borderColor,oU=(oL>>16&255)/255,oh=(oL>>8&255)/255,op=(255&oL)/255,oi=[on[0],on[1]],ov=[on[on.length-5],on[on.length-4]],ox=ov[0]+.5*(oi[0]-ov[0]),oj=ov[1]+.5*(oi[1]-ov[1]);on.unshift(ox,oj,0,0,0),on.push(ox,oj,0,0,0);var o_,oK,o$,oy,ol,oS,oq,ob,oF,oP,ot,oH,oR,ou,os,oz,om,oC,oX,oO,oM=on.length/5,oc=ok,oe=oT/2;o$=on[0],oy=on[1],oP=o$-(ol=on[5]),oF=(oF=-(oy-(oS=on[6])))/(oO=Math.sqrt(oF*oF+oP*oP))*oe,oP=oP/oO*oe,oV.push(o$-oF,oy-oP,oU,oh,op,o$+oF,oy+oP,oU,oh,op);for(var oJ=1;oJ<oM-1;oJ++)o$=on[5*(oJ-1)],oy=on[5*(oJ-1)+1],ol=on[5*oJ],oS=on[5*oJ+1],oq=on[5*(oJ+1)],ob=on[5*(oJ+1)+1],oP=o$-ol,oH=ol-oq,os=(-(oF=(oF=-(oy-oS))/(oO=Math.sqrt(oF*oF+oP*oP))*oe)+o$)*(-(oP=oP/oO*oe)+oS)-(-oF+ol)*(-oP+oy),oC=(-(ot=(ot=-(oS-ob))/(oO=Math.sqrt(ot*ot+oH*oH))*oe)+oq)*(-(oH=oH/oO*oe)+oS)-(-ot+ol)*(-oH+ob),oX=(oR=-oP+oy-(-oP+oS))*(om=-ot+ol-(-ot+oq))-(oz=-oH+ob-(-oH+oS))*(ou=-oF+ol-(-oF+o$)),Math.abs(oX)<.1?(oX+=10.1,oV.push(ol-oF,oS-oP,oU,oh,op,ol+oF,oS+oP,oU,oh,op)):(((o_=(ou*oC-om*os)/oX)-ol)*(o_-ol)+((oK=(oz*os-oR*oC)/oX)-oS)+(oK-oS),oV.push(o_,oK,oU,oh,op,ol-(o_-ol),oS-(oK-oS),oU,oh,op));oD&&(or=oD);var oY=this.edges+1;for(oJ=1;oJ<oY;oJ++)or.push(oc+2*(oJ-1),oc+2*(oJ-1)+1,oc+2*oJ+1,oc+2*oJ+1,oc+2*oJ,oc+2*(oJ-1));return or.push(oc+2*(oJ-1),oc+2*(oJ-1)+1,oc+1,oc+1,oc,oc+2*(oJ-1)),oV},op}(),ozo=function(oo){function on(oo,or,oT,ok,oW,oD){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=oP.create(),this._points=oT.slice(0,oT.length),on.__super.call(this,oo,or,0,0,this._points.length/2,ok,oW,oD)}oi(on,"laya.webgl.shapes.Polygon",oTo);var or=on.prototype;return or.rebuild=function(oo){this._repaint||(this._points.length=0,this._points=this._points.concat(oo))},or.setMatrix=function(oo){oo.copyTo(this._mat)},or.needUpdate=function(oo){return this._repaint=this._mat.a==oo.a&&this._mat.b==oo.b&&this._mat.c==oo.c&&this._mat.d==oo.d&&this._mat.tx==oo.tx&&this._mat.ty==oo.ty,!this._repaint},or.getData=function(oo,or,oT){var ok,oW=0,oD=this._points,on=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=oT){for(this._start=oT,ok=[],on=this.earcutTriangles.length,oW=0;oW<on;oW++)ok.push(this.earcutTriangles[oW]+oT);this.mUint16Array=new Uint16Array(ok)}}else{this._start=oT,ok=[];var oV=[],oL=[],oU=this.color,oh=(oU>>16&255)/255,op=(oU>>8&255)/255,oi=(255&oU)/255;for(on=Math.floor(oD.length/2),oW=0;oW<on;oW++)oV.push(this.x+oD[2*oW],this.y+oD[2*oW+1],oh,op,oi),oL.push(this.x+oD[2*oW],this.y+oD[2*oW+1]);for(this.earcutTriangles=oko.earcut(oL,null,2),on=this.earcutTriangles.length,oW=0;oW<on;oW++)ok.push(this.earcutTriangles[oW]+oT);this.mUint16Array=new Uint16Array(ok),this.mFloat32Array=new Float32Array(oV)}oo.append(this.mUint16Array),or.append(this.mFloat32Array)},on}(),omo=function(oo){function oD(){this._matrix=new oP,this._matrix4=ojo.defaultMatrix4.concat(),oD.__super.call(this,1e4),this.shaderValue=new oFo(0,0)}oi(oD,"laya.webgl.submit.SubmitCanvas",oDo);var or=oD.prototype;return or.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var oo=o$o.worldAlpha,or=o$o.worldMatrix4,oT=o$o.worldMatrix,ok=o$o.worldFilters,oW=o$o.worldShaderDefines,oD=this.shaderValue,on=this._matrix,oV=this._matrix4,oL=oP.TEMP;return oP.mul(on,oT,oL),oV[0]=oL.a,oV[1]=oL.b,oV[4]=oL.c,oV[5]=oL.d,oV[12]=oL.tx,oV[13]=oL.ty,o$o.worldMatrix=oL.clone(),o$o.worldMatrix4=oV,o$o.worldAlpha=o$o.worldAlpha*oD.alpha,oD.filters&&oD.filters.length&&(o$o.worldFilters=oD.filters,o$o.worldShaderDefines=oD.defines),this._ctx_src.flush(),o$o.worldAlpha=oo,o$o.worldMatrix4=or,o$o.worldMatrix.destroy(),o$o.worldMatrix=oT,o$o.worldFilters=ok,o$o.worldShaderDefines=oW,1},or.releaseRender=function(){var oo=oD._cache;this._ctx_src=null,oo[oo._length++]=this},or.getRenderType=function(){return 10003},oD.create=function(oo,or,oT){var ok=oD._cache._length?oD._cache[--oD._cache._length]:new oD;ok._ctx_src=oo;var oW=ok.shaderValue;return oW.alpha=or,oW.defines.setValue(0),oT&&oT.length&&oW.setFilters(oT),ok},oD._cache=((oD._cache=[])._length=0,oD._cache),oD}(),oCo=function(oo){function oU(oo){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===oo&&(oo=1e4),oU.__super.call(this,oo)}oi(oU,"laya.webgl.submit.SubmitTexture",oDo);var or=oU.prototype;return or.releaseRender=function(){var oo=oU._cache;(oo[oo._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},or.addTexture=function(oo,or){this._texsID[this._texs.length]=oo._uvID,this._texs.push(oo),this._vbPos.push(or)},or.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var oo=this.shaderValue.textureHost.bitmap;if(null!==oo)for(var or=this._vb.getFloat32Array(),oT=0,ok=this._texs.length;oT<ok;oT++){var oW=this._texs[oT];oW.active();var oD=oW.uv;if(this._texsID[oT]!==oW._uvID){this._texsID[oT]=oW._uvID;var on=this._vbPos[oT];or[on+2]=oD[0],or[on+3]=oD[1],or[on+6]=oD[2],or[on+7]=oD[3],or[on+10]=oD[4],or[on+11]=oD[5],or[on+14]=oD[6],or[on+15]=oD[7],this._vb.setNeedUpload()}oW.bitmap!==oo&&(this._isSameTexture=!1)}}},or.renderSubmit=function(){if(0===this._numEle)return oU._shaderSet=!1,1;var oo=this.shaderValue.textureHost;if(oo){var or=oo.source;if(!oo.bitmap||!or)return oU._shaderSet=!1,1;this.shaderValue.texture=or,oo.alphaTexture&&oo.alphaTexture.source&&(this.shaderValue.texture1=oo.alphaTexture.source)}this._vb.bind_upload(this._ib);var oT=olo.mainContext;if(oI.activeBlendFunction!==this._blendFn&&(oT.enable(3042),this._blendFn(oT),oI.activeBlendFunction=this._blendFn),os.drawCall++,os.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&oOo.activeShader&&oU._shaderSet?(oOo.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&oOo.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),oU._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var ok=oo.bitmap,oW=0,oD=oOo.activeShader,on=0,oV=this._texs.length;on<oV;on++){var oL=this._texs[on];oL.bitmap===ok&&on+1!==oV||(oD.uploadTexture2D(oL.source),oT.drawElements(4,6*(on-oW+1),5123,this._startIdx+6*oW*ojo.BYTES_PIDX),ok=oL.bitmap,oW=on)}else oT.drawElements(4,this._numEle,5123,this._startIdx);return 1},oU.create=function(oo,or,oT,ok,oW){var oD=oU._cache._length?oU._cache[--oU._cache._length]:new oU;null==oT&&((oT=oD._selfVb||(oD._selfVb=odo.create(-1))).clear(),ok=0),oD._ib=or,oD._vb=oT,oD._startIdx=ok*ojo.BYTES_PIDX,oD._numEle=0;var on=oo._nBlendType;oD._blendFn=oo._targets?oI.targetFns[on]:oI.fns[on],oD.shaderValue=oW,oD.shaderValue.setValue(oo._shader2D);var oV=oo._shader2D.filters;return oV&&oD.shaderValue.setFilters(oV),oD},oU._cache=((oU._cache=[])._length=0,oU._cache),oU._shaderSet=!0,oU}(),oXo=function(oo){function oK(){oK.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}oi(oK,"laya.webgl.utils.MeshTexture",oKo);var or=oK.prototype;return or.addData=function(oo,or,oT,ok,oW,oD){for(var on=oo.length/2,oV=this._vb.needSize(on*oK.const_stride)>>2,oL=this._vb.getFloat32Array(),oU=0,oh=0;oh<on;oh++){var op=oo[oU],oi=oo[oU+1],ov=op*ok.a+oi*ok.c+ok.tx,ox=op*ok.b+oi*ok.d+ok.ty;oL[oV++]=ov,oL[oV++]=ox,oL[oV++]=or[oU],oL[oV++]=or[oU+1],oU+=2}this._vb.setNeedUpload();var oj=this.vertNum;if(0<oj){(on=oT.length)>oK.tmpIdx.length&&(oK.tmpIdx=new Uint16Array(on));for(var o_=0;o_<on;o_++)oK.tmpIdx[o_]=oT[o_]+oj;this._ib.appendU16Array(oK.tmpIdx,oT.length)}else this._ib.append(oT);this._ib.setNeedUpload(),this.vertNum+=on,this.indexNum+=oT.length},or.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},or.destroy=function(){this._ib.destroy(),this._vb.destroy()},oK.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new oK},oK.const_stride=16,oK._POOL=[],on(oK,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),oK}(),oOo=function(oo){function or(){or.__super.call(this),this.lock=!0}return oi(or,"laya.webgl.shader.BaseShader",oy),or.activeShader=null,or.bindShader=null,or}(),oMo=function(or){function oh(oo,or,oT,ok,oW,oD,on,oV,oL){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===oT&&(oT=6408),void 0===ok&&(ok=5121),void 0===oW&&(oW=34041),void 0===oD&&(oD=!1),void 0===on&&(on=!1),void 0===oV&&(oV=-1),void 0===oL&&(oL=-1),this._type=1,this._w=oo,this._h=or,this._surfaceFormat=oT,this._surfaceType=ok,this._depthStencilFormat=oW,oK.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=oD,this._repeat=on,this._minFifter=oV,this._magFifter=oL,this._createWebGLRenderTarget(),this.bitmap.lock=!0,oh.__super.call(this,this.bitmap,oX.INV_UV)}oi(oh,"laya.webgl.resource.RenderTarget2D",or);var oo=oh.prototype;return oq.imps(oo,{"laya.resource.IDispose":!0}),oo.getType=function(){return this._type},oo.getTexture=function(){return this},oo.size=function(oo,or){this._w==oo&&this._h==or||(this._w=oo,this._h=or,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},oo.release=function(){this.destroy()},oo.recycle=function(){oh.POOL.push(this)},oo.start=function(){var oo=olo.mainContext;return this._preRenderTarget=o$o.curRenderTarget,o$o.curRenderTarget=this,oo.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(oo.viewport(0,0,this._w,this._h),this._svWidth=o$o.width,this._svHeight=o$o.height,o$o.width=this._w,o$o.height=this._h,oOo.activeShader=null),this},oo.clear=function(oo,or,oT,ok){void 0===oo&&(oo=0),void 0===or&&(or=0),void 0===oT&&(oT=0),void 0===ok&&(ok=1);var oW=olo.mainContext;oW.clearColor(oo,or,oT,ok);var oD=16384;switch(this._depthStencilFormat){case 33189:oD|=256;break;case 36168:oD|=1024;break;case 34041:oD|=256,oD|=1024}oW.clear(oD)},oo.end=function(){var oo=olo.mainContext;oo.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,o$o.curRenderTarget=this._preRenderTarget,1==this._type?(oo.viewport(0,0,this._svWidth,this._svHeight),o$o.width=this._svWidth,o$o.height=this._svHeight,oOo.activeShader=null):oo.viewport(0,0,oq.stage.width,oq.stage.height)},oo.getData=function(oo,or,oT,ok){var oW=olo.mainContext;if(oW.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===oW.checkFramebufferStatus(36160)))return oW.bindFramebuffer(36160,null),null;var oD=new Uint8Array(this._w*this._h*4);return oW.readPixels(oo,or,oT,ok,this._surfaceFormat,this._surfaceType,oD),oW.bindFramebuffer(36160,null),oD},oo.destroy=function(oo){void 0===oo&&(oo=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,or.prototype.destroy.call(this))},oo.dispose=function(){},oo._createWebGLRenderTarget=function(){this.bitmap=new oGo(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(oo){this.event("recovered")})},ok(0,oo,"surfaceFormat",function(){return this._surfaceFormat}),ok(0,oo,"magFifter",function(){return this._magFifter}),ok(0,oo,"surfaceType",function(){return this._surfaceType}),ok(0,oo,"mipMap",function(){return this._mipMap}),ok(0,oo,"depthStencilFormat",function(){return this._depthStencilFormat}),ok(0,oo,"minFifter",function(){return this._minFifter}),ok(0,oo,"source",function(){return this._alreadyResolved?oq.superGet(oX,this,"source"):null}),oh.create=function(oo,or,oT,ok,oW,oD,on,oV,oL){void 0===oT&&(oT=6408),void 0===ok&&(ok=5121),void 0===oW&&(oW=34041),void 0===oD&&(oD=!1),void 0===on&&(on=!1),void 0===oV&&(oV=-1),void 0===oL&&(oL=-1);var oU=oh.POOL.pop();return oU||(oU=new oh(oo,or)),oU.bitmap&&oU._w==oo&&oU._h==or&&oU._surfaceFormat==oT&&oU._surfaceType==ok&&oU._depthStencilFormat==oW&&oU._mipMap==oD&&oU._repeat==on&&oU._minFifter==oV&&oU._magFifter==oL||(oU._w=oo,oU._h=or,oU._surfaceFormat=oT,oU._surfaceType=ok,oU._depthStencilFormat=oW,oK.isConchWebGL&&34041===oU._depthStencilFormat&&(oU._depthStencilFormat=33189),oU._mipMap=oD,oU._repeat=on,oU._minFifter=oV,oU._magFifter=oL,oU.release(),oU._createWebGLRenderTarget()),oU},oh.TYPE2D=1,oh.TYPE3D=2,oh.POOL=[],oh}(oX),oco=function(oo){function or(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,or.__super.call(this),or._gl=olo.mainContext}oi(or,"laya.webgl.utils.Buffer",oy);var oT=or.prototype;return oT._bind=function(){this.activeResource(),or._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(or._bindVertexBuffer=this._glBuffer),or._gl.bindBuffer(this._bufferType,or._bindActive[this._bufferType]=this._glBuffer),oOo.activeShader=null)},oT.recreateResource=function(){this._glBuffer||(this._glBuffer=or._gl.createBuffer()),this.completeCreate()},oT.disposeResource=function(){this._glBuffer&&(olo.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},ok(0,oT,"bufferUsage",function(){return this._bufferUsage}),or._gl=null,or._bindActive={},or._bindVertexBuffer=null,or._enableAtributes=[],or}(),oeo=function(oo){function oT(oo){this.texcoord=null,this.offsetX=300,this.offsetY=0,oT.__super.call(this,512,0);var or=8*ojo.BYTES_PE;this.position=[2,5126,!1,or,0],this.texcoord=[2,5126,!1,or,2*ojo.BYTES_PE],this.color=[4,5126,!1,or,4*ojo.BYTES_PE]}return oi(oT,"laya.webgl.shader.d2.skinAnishader.SkinSV",oFo),oT}(),oJo=function(oo){function or(oo){or.__super.call(this,2,0),this.color=[]}return oi(or,"laya.webgl.shader.d2.value.Color2dSV",oFo),or.prototype.setValue=function(oo){oo.fillStyle&&(this.color=oo.fillStyle._color._color),oo.strokeStyle&&(this.color=oo.strokeStyle._color._color)},or}(),oYo=function(oo){function or(oo){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=oFo._TEXCOORD,or.__super.call(this,256,0)}oi(or,"laya.webgl.shader.d2.value.FillTextureSV",oFo);var oT=or.prototype;return oT.setValue=function(oo){this.ALPHA=oo.ALPHA,oo.filters&&this.setFilters(oo.filters)},oT.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},or}(),oAo=function(oo){function or(oo){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=oFo._TEXCOORD,void 0===oo&&(oo=0),or.__super.call(this,1,oo)}oi(or,"laya.webgl.shader.d2.value.TextureSV",oFo);var oT=or.prototype;return oT.setValue=function(oo){this.ALPHA=oo.ALPHA,oo.filters&&this.setFilters(oo.filters)},oT.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},or}(),oIo=function(oo){function or(oo){this.a_color=null,this.u_pos=[0,0],or.__super.call(this,4,0),this.position=[2,5126,!1,5*ojo.BYTES_PE,0],this.a_color=[3,5126,!1,5*ojo.BYTES_PE,2*ojo.BYTES_PE]}return oi(or,"laya.webgl.shader.d2.value.PrimitiveSV",oFo),or}(),oNo=function(oo){function or(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,or.__super.call(this)}oi(or,"laya.webgl.atlas.AtlasWebGLCanvas",oo);var oT=or.prototype;return oT.recreateResource=function(){var oo=olo.mainContext,or=this._source=oo.createTexture(),oT=oSo.curBindTexTarget,ok=oSo.curBindTexValue;oSo.bindTexture(oo,3553,or),oo.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),oo.texParameteri(3553,10241,9729),oo.texParameteri(3553,10240,9729),oo.texParameteri(3553,10242,33071),oo.texParameteri(3553,10243,33071),oT&&ok&&oSo.bindTexture(oo,oT,ok),this.memorySize=this._w*this._h*4,this.completeCreate()},oT.disposeResource=function(){this._source&&(olo.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},oT.texSubImage2D=function(oo,or,oT){if(oK.isFlash){this._flashCacheImage||(this._flashCacheImage=oj.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var ok=oT.bitmapdata;this._flashCacheImage._image.copyPixels(ok,0,0,ok.width,ok.height,oo,or),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var oW=olo.mainContext,oD=oSo.curBindTexTarget,on=oSo.curBindTexValue;oSo.bindTexture(oW,3553,this._source),oW.pixelStorei(37441,!0),0<=oo-1&&oW.texSubImage2D(3553,0,oo-1,or,6408,5121,oT),oo+1<=this._w&&oW.texSubImage2D(3553,0,oo+1,or,6408,5121,oT),0<=or-1&&oW.texSubImage2D(3553,0,oo,or-1,6408,5121,oT),or+1<=this._h&&oW.texSubImage2D(3553,0,oo,or+1,6408,5121,oT),oW.texSubImage2D(3553,0,oo,or,6408,5121,oT),oW.pixelStorei(37441,!1),oD&&on&&oSo.bindTexture(oW,oD,on)}},oT.texSubImage2DPixel=function(oo,or,oT,ok,oW){var oD=olo.mainContext,on=oSo.curBindTexTarget,oV=oSo.curBindTexValue;oSo.bindTexture(oD,3553,this._source);var oL=new Uint8Array(oW.data);oD.pixelStorei(37441,!0),oD.texSubImage2D(3553,0,oo,or,oT,ok,6408,5121,oL),oD.pixelStorei(37441,!1),on&&oV&&oSo.bindTexture(oD,on,oV)},ok(0,oT,"width",oo.prototype._$get_width,function(oo){this._w=oo}),ok(0,oT,"height",oo.prototype._$get_height,function(oo){this._h=oo}),or}(oT),ofo=function(oo){function oW(){this.flipY=!0,this.alwaysChange=!1,oW.__super.call(this)}oi(oW,"laya.webgl.resource.WebGLCanvas",oT);var or=oW.prototype;return or.getCanvas=function(){return this._canvas},or.clear=function(){this._ctx&&this._ctx.clear()},or.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},or._setContext=function(oo){this._ctx=oo},or.getContext=function(oo,or){return this._ctx?this._ctx:this._ctx=oW._createContext(this)},or.size=function(oo,or){this._w==oo&&this._h==or||(this._w=oo,this._h=or,this._ctx&&this._ctx.size(oo,or),this._canvas&&(this._canvas.height=or,this._canvas.width=oo))},or.activeResource=function(oo){void 0===oo&&(oo=!1),this._source||this.recreateResource()},or.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},or.disposeResource=function(){this._source&&!this.iscpuSource&&(olo.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},or.createWebGlTexture=function(){var oo=olo.mainContext;this._canvas;var or=this._source=oo.createTexture();this.iscpuSource=!1;var oT=oSo.curBindTexTarget,ok=oSo.curBindTexValue;oSo.bindTexture(oo,3553,or),oo.pixelStorei(37440,this.flipY?1:0),oW.premulAlpha&&oo.pixelStorei(37441,!0),oo.texImage2D(3553,0,6408,6408,5121,this._imgData),oW.premulAlpha&&oo.pixelStorei(37441,!1),oo.texParameteri(3553,10240,9729),oo.texParameteri(3553,10241,9729),oo.texParameteri(3553,10242,33071),oo.texParameteri(3553,10243,33071),oo.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,oT&&ok&&oSo.bindTexture(oo,oT,ok)},or.reloadCanvasData=function(){var oo=olo.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var or=oSo.curBindTexTarget,oT=oSo.curBindTexValue;oSo.bindTexture(oo,3553,this._source),oW.premulAlpha&&oo.pixelStorei(37441,!0),oo.texImage2D(3553,0,6408,6408,5121,this._imgData),oW.premulAlpha&&oo.pixelStorei(37441,!1),oo.pixelStorei(37440,0),or&&oT&&oSo.bindTexture(oo,or,oT)},or.texSubImage2D=function(oo,or,oT){var ok=olo.mainContext,oW=oSo.curBindTexTarget,oD=oSo.curBindTexValue;oSo.bindTexture(ok,3553,this._source),ok.pixelStorei(37441,!0),ok.texSubImage2D(3553,0,or,oT,6408,5121,oo._source),ok.pixelStorei(37441,!1),oW&&oD&&oSo.bindTexture(ok,oW,oD)},or.toBase64=function(oo,or,oT){var ok=null;this._canvas&&(ok=this._canvas.toDataURL(oo,or)),oT.call(this,ok)},ok(0,or,"context",function(){return this._ctx}),ok(0,or,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),ok(0,or,"asBitmap",null,function(oo){this._ctx&&(this._ctx.asBitmap=oo)}),oW._createContext=null,oW.premulAlpha=!1,oW}(),oao=function(oo){function oD(oo,or){this.CborderSize=12,oD.__super.call(this),this.char=oo,this.isSpace=" "===oo,this.xs=or.scaleX,this.ys=or.scaleY,this.font=or.font.toString(),this.fontSize=or.font.size,this.fillColor=or.fillColor,this.borderColor=or.borderColor,this.lineWidth=or.lineWidth,this.underLine=or.underLine;var oT,ok=oK.isConchApp;ok?((oT=ConchTextCanvas)._source=ConchTextCanvas,oT._source.canvas=ConchTextCanvas):oT=ov.canvas.source,this.canvas=oT,this._enableMerageInAtlas=!0,this._ctx=ok?oT:this.canvas.getContext("2d",void 0);var oW=oO.measureText(this.char,this.font);this.cw=oW.width*this.xs,this.ch=(oW.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new oX(this)}oi(oD,"laya.webgl.resource.WebGLCharImage",oT);var or=oD.prototype;return oq.imps(or,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),or.active=function(){this.texture.active()},or.recreateResource=function(){var oo=oK.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),oo){var or=this.fontSize;1==this.xs&&1==this.ys||(or=parseInt(or*(this.xs>this.ys?this.xs:this.ys)+""));var oT="normal 100 "+this.font;oT=oT.replace(oD._fontSizeReg,or),this.borderColor&&(oT+=" 1 "+this.borderColor),this._ctx.font=oT,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,oC.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var ok=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(ok,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},or.onresize=function(oo,or){this._w=oo,this._h=or,this._allowMerageInAtlas=!0},or.clearAtlasSource=function(){},ok(0,or,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),ok(0,or,"atlasSource",function(){return this.canvas}),ok(0,or,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(oo){this._enableMerageInAtlas=oo}),oD.createOneChar=function(oo,or){return new oD(oo,or)},oD._fontSizeReg=new RegExp("\\d+(?=px)","g"),oD}(),oGo=function(oo){function oU(oo,or,oT,ok,oW,oD,on,oV,oL){void 0===oT&&(oT=6408),void 0===ok&&(ok=5121),void 0===oW&&(oW=34041),void 0===oD&&(oD=!1),void 0===on&&(on=!1),void 0===oV&&(oV=-1),void 0===oL&&(oL=1),oU.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=oo,this._h=or,this._surfaceFormat=oT,this._surfaceType=ok,this._depthStencilFormat=oW,this._mipMap=oD,this._repeat=on,this._minFifter=oV,this._magFifter=oL}oi(oU,"laya.webgl.resource.WebGLRenderTarget",oT);var or=oU.prototype;return or.recreateResource=function(){var oo=olo.mainContext;this._frameBuffer||(this._frameBuffer=oo.createFramebuffer()),this._source||(this._source=oo.createTexture());var or=oSo.curBindTexTarget,oT=oSo.curBindTexValue;oSo.bindTexture(oo,3553,this._source),oo.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var ok=this._minFifter,oW=this._magFifter,oD=this._repeat?10497:33071,on=oh.isPOT(this._w,this._h);if(on?(this._mipMap?-1!==ok||(ok=9987):-1!==ok||(ok=9729),-1!==oW||(oW=9729),oo.texParameteri(3553,10241,ok),oo.texParameteri(3553,10240,oW),oo.texParameteri(3553,10242,oD),oo.texParameteri(3553,10243,oD),this._mipMap&&oo.generateMipmap(3553)):(-1!==ok||(ok=9729),-1!==oW||(oW=9729),oo.texParameteri(3553,10241,ok),oo.texParameteri(3553,10240,oW),oo.texParameteri(3553,10242,33071),oo.texParameteri(3553,10243,33071)),oo.bindFramebuffer(36160,this._frameBuffer),oo.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=oo.createRenderbuffer()),oo.bindRenderbuffer(36161,this._depthStencilBuffer),oo.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:oo.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:oo.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:oo.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}oo.bindFramebuffer(36160,null),or&&oT&&oSo.bindTexture(oo,or,oT),oo.bindRenderbuffer(36161,null),on&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},or.disposeResource=function(){this._frameBuffer&&(olo.mainContext.deleteTexture(this._source),olo.mainContext.deleteFramebuffer(this._frameBuffer),olo.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},ok(0,or,"depthStencilBuffer",function(){return this._depthStencilBuffer}),ok(0,or,"frameBuffer",function(){return this._frameBuffer}),oU}(),owo=function(oo){function oV(oo,or,oT,ok,oW,oD,on){this.offsetX=0,this.offsetY=0,oV.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=oD,this.canvas=oo,this._ctx=oo.getContext("2d",void 0),this._w=ok,this._h=oW,this.offsetX=or,this.offsetY=oT,this.src=on,this._enableMerageInAtlas=!0,oY.enabled&&this._w<oY.atlasLimitWidth&&this._h<oY.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}oi(oV,"laya.webgl.resource.WebGLSubImage",oT);var or=oV.prototype;return oq.imps(or,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),or.size=function(oo,or){this._w=oo,this._h=or,this._ctx&&this._ctx.size(oo,or),this.canvas&&(this.canvas.height=or,this.canvas.width=oo)},or.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},or.createWebGlTexture=function(){var oo=olo.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var or=this._source=oo.createTexture(),oT=oSo.curBindTexTarget,ok=oSo.curBindTexValue;oSo.bindTexture(oo,3553,or),oo.pixelStorei(37441,!0),oo.texImage2D(3553,0,6408,6408,5121,this.canvas),oo.pixelStorei(37441,!1);var oW=this.minFifter,oD=this.magFifter,on=this.repeat?10497:33071,oV=oh.isPOT(this.width,this.height);oV?(this.mipmap?-1!==oW||(oW=9987):-1!==oW||(oW=9729),-1!==oD||(oD=9729),oo.texParameteri(3553,10240,oD),oo.texParameteri(3553,10241,oW),oo.texParameteri(3553,10242,on),oo.texParameteri(3553,10243,on),this.mipmap&&oo.generateMipmap(3553)):(-1!==oW||(oW=9729),-1!==oD||(oD=9729),oo.texParameteri(3553,10241,oW),oo.texParameteri(3553,10240,oD),oo.texParameteri(3553,10242,33071),oo.texParameteri(3553,10243,33071)),oT&&ok&&oSo.bindTexture(oo,oT,ok),this.canvas=null,oV&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},or.disposeResource=function(){oY.enabled&&this._allowMerageInAtlas||!this._source||(olo.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},or.clearAtlasSource=function(){},ok(0,or,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),ok(0,or,"atlasSource",function(){return this.canvas}),ok(0,or,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(oo){this._allowMerageInAtlas=oo}),oV}(),oZo=function(oo){function oU(oo,or,oT,ok){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,oU.__super.call(this),!oo||!or)throw"Shader Error";this._id=++oU._count,this._vs=oo,this._ps=or,this._nameMap=ok||{},null!=oT&&(oU.sharders[oT]=this)}oi(oU,"laya.webgl.shader.Shader",oOo);var or=oU.prototype;return or.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},or.disposeResource=function(){olo.mainContext.deleteShader(this._vshader),olo.mainContext.deleteShader(this._pshader),olo.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},or._compile=function(){if(!olo.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var oo=[this._vs,this._ps],or=olo.mainContext;if(this._program=or.createProgram(),this._vshader=oU._createShader(or,oo[0],35633),this._pshader=oU._createShader(or,oo[1],35632),or.attachShader(this._program,this._vshader),or.attachShader(this._program,this._pshader),or.linkProgram(this._program),!oK.isConchApp&&!or.getProgramParameter(this._program,35714))throw or.getProgramInfoLog(this._program);var oT,ok,oW=0,oD=0;for(oD=oK.isConchApp?or.getProgramParameterEx(this._vs,this._ps,"",35721):or.getProgramParameter(this._program,35721),oW=0;oW<oD;oW++){var on=null;oT={vartype:"attribute",glfun:null,ivartype:0,attrib:on=oK.isConchApp?or.getActiveAttribEx(this._vs,this._ps,"",oW):or.getActiveAttrib(this._program,oW),location:or.getAttribLocation(this._program,on.name),name:on.name,type:on.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(oT)}var oV=0;for(oV=oK.isConchApp?or.getProgramParameterEx(this._vs,this._ps,"",35718):or.getProgramParameter(this._program,35718),oW=0;oW<oV;oW++){var oL=null;oL=oK.isConchApp?or.getActiveUniformEx(this._vs,this._ps,"",oW):or.getActiveUniform(this._program,oW),0<(oT={vartype:"uniform",glfun:null,ivartype:1,attrib:on,location:or.getUniformLocation(this._program,oL.name),name:oL.name,type:oL.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(oT.name=oT.name.substr(0,oT.name.length-3),oT.isArray=!0,oT.location=or.getUniformLocation(this._program,oT.name)),this._params.push(oT)}for(oW=0,ok=this._params.length;oW<ok;oW++)if((oT=this._params[oW]).indexOfParams=oW,oT.index=1,oT.value=[oT.location,null],oT.codename=oT.name,oT.name=this._nameMap[oT.codename]?this._nameMap[oT.codename]:oT.codename,(this._paramsMap[oT.name]=oT)._this=this,oT.uploadedValue=[],"attribute"!==oT.vartype)switch(oT.type){case 5124:oT.fun=oT.isArray?this._uniform1iv:this._uniform1i;break;case 5126:oT.fun=oT.isArray?this._uniform1fv:this._uniform1f;break;case 35664:oT.fun=oT.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:oT.fun=oT.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:oT.fun=oT.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:oT.fun=this._uniform_sampler2D;break;case 35680:oT.fun=this._uniform_samplerCube;break;case 35676:oT.glfun=or.uniformMatrix4fv,oT.fun=this._uniformMatrix4fv;break;case 35670:oT.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else oT.fun=this._attribute}},or.getUniform=function(oo){return this._paramsMap[oo]},or._attribute=function(oo,or){var oT=olo.mainContext,ok=oco._enableAtributes,oW=oo.location;return ok[oW]||oT.enableVertexAttribArray(oW),oT.vertexAttribPointer(oW,or[0],or[1],or[2],or[3],or[4]+this._offset),ok[oW]=oco._bindVertexBuffer,1},or._uniform1f=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or?(olo.mainContext.uniform1f(oo.location,oT[0]=or),1):0},or._uniform1fv=function(oo,or){if(or.length<4){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]||oT[2]!==or[2]||oT[3]!==or[3]?(olo.mainContext.uniform1fv(oo.location,or),oT[0]=or[0],oT[1]=or[1],oT[2]=or[2],oT[3]=or[3],1):0}return olo.mainContext.uniform1fv(oo.location,or),1},or._uniform_vec2=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]?(olo.mainContext.uniform2f(oo.location,oT[0]=or[0],oT[1]=or[1]),1):0},or._uniform_vec2v=function(oo,or){if(or.length<2){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]||oT[2]!==or[2]||oT[3]!==or[3]?(olo.mainContext.uniform2fv(oo.location,or),oT[0]=or[0],oT[1]=or[1],oT[2]=or[2],oT[3]=or[3],1):0}return olo.mainContext.uniform2fv(oo.location,or),1},or._uniform_vec3=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]||oT[2]!==or[2]?(olo.mainContext.uniform3f(oo.location,oT[0]=or[0],oT[1]=or[1],oT[2]=or[2]),1):0},or._uniform_vec3v=function(oo,or){return olo.mainContext.uniform3fv(oo.location,or),1},or._uniform_vec4=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]||oT[2]!==or[2]||oT[3]!==or[3]?(olo.mainContext.uniform4f(oo.location,oT[0]=or[0],oT[1]=or[1],oT[2]=or[2],oT[3]=or[3]),1):0},or._uniform_vec4v=function(oo,or){return olo.mainContext.uniform4fv(oo.location,or),1},or._uniformMatrix2fv=function(oo,or){return olo.mainContext.uniformMatrix2fv(oo.location,!1,or),1},or._uniformMatrix3fv=function(oo,or){return olo.mainContext.uniformMatrix3fv(oo.location,!1,or),1},or._uniformMatrix4fv=function(oo,or){return olo.mainContext.uniformMatrix4fv(oo.location,!1,or),1},or._uniform1i=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or?(olo.mainContext.uniform1i(oo.location,oT[0]=or),1):0},or._uniform1iv=function(oo,or){return olo.mainContext.uniform1iv(oo.location,or),1},or._uniform_ivec2=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]?(olo.mainContext.uniform2i(oo.location,oT[0]=or[0],oT[1]=or[1]),1):0},or._uniform_ivec2v=function(oo,or){return olo.mainContext.uniform2iv(oo.location,or),1},or._uniform_vec3i=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]||oT[2]!==or[2]?(olo.mainContext.uniform3i(oo.location,oT[0]=or[0],oT[1]=or[1],oT[2]=or[2]),1):0},or._uniform_vec3vi=function(oo,or){return olo.mainContext.uniform3iv(oo.location,or),1},or._uniform_vec4i=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]||oT[2]!==or[2]||oT[3]!==or[3]?(olo.mainContext.uniform4i(oo.location,oT[0]=or[0],oT[1]=or[1],oT[2]=or[2],oT[3]=or[3]),1):0},or._uniform_vec4vi=function(oo,or){return olo.mainContext.uniform4iv(oo.location,or),1},or._uniform_sampler2D=function(oo,or){var oT=olo.mainContext,ok=oo.uploadedValue;return null==ok[0]?(ok[0]=this._curActTexIndex,oT.uniform1i(oo.location,this._curActTexIndex),oT.activeTexture(oU._TEXTURES[this._curActTexIndex]),oSo.bindTexture(oT,3553,or),this._curActTexIndex++,1):(oT.activeTexture(oU._TEXTURES[ok[0]]),oSo.bindTexture(oT,3553,or),0)},or._uniform_samplerCube=function(oo,or){var oT=olo.mainContext,ok=oo.uploadedValue;return null==ok[0]?(ok[0]=this._curActTexIndex,oT.uniform1i(oo.location,this._curActTexIndex),oT.activeTexture(oU._TEXTURES[this._curActTexIndex]),oSo.bindTexture(oT,34067,or),this._curActTexIndex++,1):(oT.activeTexture(oU._TEXTURES[ok[0]]),oSo.bindTexture(oT,34067,or),0)},or._noSetValue=function(oo){console.log("no....:"+oo.name)},or.uploadOne=function(oo,or){this.activeResource(),oSo.UseProgram(this._program);var oT=this._paramsMap[oo];oT.fun.call(this,oT,or)},or.uploadTexture2D=function(oo){os.shaderCall++;var or=olo.mainContext;or.activeTexture(33984),oSo.bindTexture(or,3553,oo)},or.uploadTexture2D1=function(oo){os.shaderCall++;var or=olo.mainContext;or.activeTexture(33985),oSo.bindTexture(or,3553,oo)},or.upload=function(oo,or){oOo.activeShader=oOo.bindShader=this,this._lastUseFrameCount===os.loopCount||this.activeResource(),oSo.UseProgram(this._program),this._reCompile?(or=this._params,this._reCompile=!1):or=or||this._params;olo.mainContext;for(var oT,ok,oW=or.length,oD=0,on=0;on<oW;on++)null!==(ok=oo[(oT=or[on]).name])&&(oD+=oT.fun.call(this,oT,ok));os.shaderCall+=oD},or.uploadArray=function(oo,or,oT){oOo.activeShader=this,(oOo.bindShader=this).activeResource(),oSo.UseProgram(this._program);this._params;for(var ok,oW,oD=0,on=or-2;0<=on;on-=2)(oW=this._paramsMap[oo[on]])&&null!=(ok=oo[on+1])&&(oT&&oT[oW.name]&&oT[oW.name].bind(),oD+=oW.fun.call(this,oW,ok));os.shaderCall+=oD},or.getParams=function(){return this._params},oU.getShader=function(oo){return oU.sharders[oo]},oU.create=function(oo,or,oT,ok){return new oU(oo,or,oT,ok)},oU.withCompile=function(oo,or,oT,ok){if(oT&&oU.sharders[oT])return oU.sharders[oT];var oW=oU._preCompileShader[2e-4*oo];if(!oW)throw new Error("withCompile shader err!"+oo);return oW.createShader(or,oT,ok)},oU.withCompile2D=function(oo,or,oT,ok,oW){if(ok&&oU.sharders[ok])return oU.sharders[ok];var oD=oU._preCompileShader[2e-4*oo+or];if(!oD)throw new Error("withCompile shader err!"+oo+" "+or);return oD.createShader(oT,ok,oW)},oU.addInclude=function(oo,or){oyo.addInclude(oo,or)},oU.preCompile=function(oo,or,oT,ok){var oW=2e-4*oo;oU._preCompileShader[oW]=new oyo(oW,or,oT,ok)},oU.preCompile2D=function(oo,or,oT,ok,oW){var oD=2e-4*oo+or;oU._preCompileShader[oD]=new oyo(oD,oT,ok,oW)},oU._createShader=function(oo,or,oT){var ok=oo.createShader(oT);return oo.shaderSource(ok,or),oo.compileShader(ok),ok},oU._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],oU._count=0,oU._preCompileShader={},oU.SHADERNAME2ID=2e-4,oU.sharders=((oU.sharders=[]).length=32,oU.sharders),on(oU,["nameKey",function(){return this.nameKey=new oz}]),oU}(),oQo=function(oo){function or(){this._maxsize=0,this._upload=!0,this._uploadSize=0,or.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}oi(or,"laya.webgl.utils.Buffer2D",oo);var oT=or.prototype;return oT.needSize=function(oo){var or=this._byteLength;if(oo){var oT=this._byteLength+oo;oT<=this._buffer.byteLength||this._resizeBuffer(oT<<1,!0),this._byteLength=oT}return or},oT._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),os.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,oco._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),oco._gl.bufferSubData(this._bufferType,0,this._buffer)},oT._bufferSubData=function(oo,or,oT){if(void 0===oo&&(oo=0),void 0===or&&(or=0),void 0===oT&&(oT=0),this._maxsize=Math.max(this._maxsize,this._byteLength),os.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,oco._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),or||oT){var ok=this._buffer.slice(or,oT);oco._gl.bufferSubData(this._bufferType,oo,ok)}else oco._gl.bufferSubData(this._bufferType,oo,this._buffer)},oT._checkArrayUse=function(){},oT._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},oT._bind_subUpload=function(oo,or,oT){return void 0===oo&&(oo=0),void 0===or&&(or=0),void 0===oT&&(oT=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(oo,or,oT),!0)},oT._resizeBuffer=function(oo,or){if(oo<this._buffer.byteLength)return this;if(this.memorySize=oo,or&&this._buffer&&0<this._buffer.byteLength){var oT=new ArrayBuffer(oo);new Uint8Array(oT).set(new Uint8Array(this._buffer),0),this._buffer=oT}else this._buffer=new ArrayBuffer(oo);return this._checkArrayUse(),this._upload=!0,this},oT.append=function(oo){this._upload=!0;var or,oT;or=oo.byteLength,oo instanceof Uint8Array?(this._resizeBuffer(this._byteLength+or,!0),oT=new Uint8Array(this._buffer,this._byteLength)):oo instanceof Uint16Array?(this._resizeBuffer(this._byteLength+or,!0),oT=new Uint16Array(this._buffer,this._byteLength)):oo instanceof Float32Array&&(this._resizeBuffer(this._byteLength+or,!0),oT=new Float32Array(this._buffer,this._byteLength)),oT.set(oo,0),this._byteLength+=or,this._checkArrayUse()},oT.appendU16Array=function(oo,or){this._resizeBuffer(this._byteLength+2*or,!0);for(var oT=new Uint16Array(this._buffer,this._byteLength,or),ok=0;ok<or;ok++)oT[ok]=oo[ok];this._byteLength+=2*or,this._checkArrayUse()},oT.appendEx=function(oo,or){this._upload=!0;var oT;oT=oo.byteLength,this._resizeBuffer(this._byteLength+oT,!0),new or(this._buffer,this._byteLength).set(oo,0),this._byteLength+=oT,this._checkArrayUse()},oT.appendEx2=function(oo,or,oT,ok){void 0===ok&&(ok=1),this._upload=!0;var oW,oD;oW=oT*ok,this._resizeBuffer(this._byteLength+oW,!0),oD=new or(this._buffer,this._byteLength);var on=0;for(on=0;on<oT;on++)oD[on]=oo[on];this._byteLength+=oW,this._checkArrayUse()},oT.getBuffer=function(){return this._buffer},oT.setNeedUpload=function(){this._upload=!0},oT.getNeedUpload=function(){return this._upload},oT.upload=function(){var oo=this._bind_upload();return oco._gl.bindBuffer(this._bufferType,null),oco._bindActive[this._bufferType]=null,oOo.activeShader=null,oo},oT.subUpload=function(oo,or,oT){void 0===oo&&(oo=0),void 0===or&&(or=0),void 0===oT&&(oT=0);var ok=this._bind_subUpload();return oco._gl.bindBuffer(this._bufferType,null),oco._bindActive[this._bufferType]=null,oOo.activeShader=null,ok},oT.disposeResource=function(){oo.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},oT.clear=function(){this._byteLength=0,this._upload=!0},ok(0,oT,"bufferLength",function(){return this._buffer.byteLength}),ok(0,oT,"byteLength",null,function(oo){this._byteLength!==oo&&(oo<=this._buffer.byteLength||this._resizeBuffer(2*oo+256,!0),this._byteLength=oo)}),or.__int__=function(oo){oEo.QuadrangleIB=oEo.create(35044),o_o.fillIBQuadrangle(oEo.QuadrangleIB,16)},or.FLOAT32=4,or.SHORT=2,or}(oco),ogo=(function(or){function oT(oo){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,oT.__super.call(this,9)}oi(oT,"laya.webgl.shader.d2.value.GlowSV",or);var oo=oT.prototype;oo.setValue=function(oo){or.prototype.setValue.call(this,oo)},oo.clear=function(){or.prototype.clear.call(this)}}(oAo),function(oo){function or(oo){or.__super.call(this,64),this.defines.add(64)}oi(or,"laya.webgl.shader.d2.value.TextSV",oo);var oT=or.prototype;return oT.release=function(){(or.pool[or._length++]=this).clear()},oT.clear=function(){oo.prototype.clear.call(this)},or.create=function(){return or._length?or.pool[--or._length]:new or(null)},or.pool=[],or._length=0,or}(oAo)),oBo=function(oo){function oW(oo,or,oT,ok){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,oW.__super.call(this,oo,or,oT,ok)}oi(oW,"laya.webgl.shader.d2.Shader2X",oo);var or=oW.prototype;return or.upload2dQuick1=function(oo){this.upload(oo,this._params2dQuick1||this._make2dQuick1())},or._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var oo,or=this._params,oT=0,ok=or.length;oT<ok;oT++)oo=or[oT],(oK.isFlash||"size"!==oo.name&&"position"!==oo.name&&"texcoord"!==oo.name)&&this._params2dQuick1.push(oo)}return this._params2dQuick1},or.disposeResource=function(){oo.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},or.upload2dQuick2=function(oo){this.upload(oo,this._params2dQuick2||this._make2dQuick2())},or._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var oo,or=this._params,oT=0,ok=or.length;oT<ok;oT++)oo=or[oT],(oK.isFlash||"size"!==oo.name)&&this._params2dQuick2.push(oo)}return this._params2dQuick2},oW.create=function(oo,or,oT,ok){return new oW(oo,or,oT,ok)},oW}(oZo),oEo=function(oo){function or(oo){this._uint8Array=null,this._uint16Array=null,void 0===oo&&(oo=35044),or.__super.call(this),this._bufferUsage=oo,this._bufferType=34963,oK.isFlash||(this._buffer=new ArrayBuffer(8))}oi(or,"laya.webgl.utils.IndexBuffer2D",oQo);var oT=or.prototype;return oT._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},oT.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},oT.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},oT.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},or.QuadrangleIB=null,or.create=function(oo){return void 0===oo&&(oo=35044),new or(oo)},or}(),odo=function(oo){function oT(oo,or){this._floatArray32=null,this._vertexStride=0,oT.__super.call(this),this._vertexStride=oo,this._bufferUsage=or,this._bufferType=34962,oK.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}oi(oT,"laya.webgl.utils.VertexBuffer2D",oo);var or=oT.prototype;return or.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},or.bind=function(oo){oo&&oo._bind(),this._bind()},or.insertData=function(oo,or){this.getFloat32Array().set(oo,or),this._upload=!0},or.bind_upload=function(oo){oo._bind_upload()||oo._bind(),this._bind_upload()||this._bind()},or._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},or.disposeResource=function(){oo.prototype.disposeResource.call(this)},or.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},ok(0,or,"vertexStride",function(){return this._vertexStride}),oT.create=function(oo,or){return void 0===or&&(or=35048),new oT(oo,or)},oT}(oQo),oor=function(oo){function oV(oo,or,oT,ok,oW,oD){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===oT&&(oT=6408),void 0===ok&&(ok=!0),oV.__super.call(this,oo,or),oo){if(this._format=oT,this._mipmap=ok,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof oo)this._url=oo,this._src=oo,this._image=new ov.window.Image,or&&(or.onload&&(this.onload=or.onload),or.onerror&&(this.onerror=or.onerror),or.onCreate&&or.onCreate(this)),this._image.crossOrigin=oo&&0==oo.indexOf("data:")?null:"",oo&&(this._image.src=oo);else if(oo instanceof ArrayBuffer){this._src=or,this._url=this._src;var on=new oL(oo);on.readUTFBytes(4),on.readUTFBytes(2),on.getInt16();on.endian="bigEndian",this._w=on.getInt16(),this._h=on.getInt16();on.getInt16(),on.getInt16();this._image=new Uint8Array(oo,on.pos),this._format=olo.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,oY.enabled&&this._w<oY.atlasLimitWidth&&this._h<oY.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(oo instanceof Uint8Array))return this._src=or,this._url=this._src,this._image=oo.source||oo,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=or,this._url=this._src,this._w=oW,this._h=oD,this._image=oo,this._format=0===oT?oo.byteLength/(oW*oD)==4?6408:6407:oT}this._$5__enableMerageInAtlas=!0}}oi(oV,"laya.webgl.resource.WebGLImage",oj);var or=oV.prototype;return oq.imps(or,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),or._init_=function(oo,or){},or._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var oo=olo.mainContext,or=this._source=oo.createTexture(),oT=oSo.curBindTexTarget,ok=oSo.curBindTexValue;oSo.bindTexture(oo,3553,or);var oW=this.minFifter,oD=this.magFifter,on=this.repeat?10497:33071,oV=oh.isPOT(this._w,this._h),oL=!1;switch(oV?(this.mipmap?-1!==oW||(oW=9987):-1!==oW||(oW=9729),-1!==oD||(oD=9729),oo.texParameteri(3553,10241,oW),oo.texParameteri(3553,10240,oD),oo.texParameteri(3553,10242,on),oo.texParameteri(3553,10243,on),this.mipmap&&oo.generateMipmap(3553)):(-1!==oW||(oW=9729),-1!==oD||(oD=9729),oo.texParameteri(3553,10241,oW),oo.texParameteri(3553,10240,oD),oo.texParameteri(3553,10242,33071),oo.texParameteri(3553,10243,33071)),oo.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&oo.pixelStorei(oo.UNPACK_ALIGNMENT,1),oo.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&oo.pixelStorei(oo.UNPACK_ALIGNMENT,1),oo.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:oL=!0,oo.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case olo.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:oL=!0,oo.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}oo.pixelStorei(37441,!1),oT&&ok&&oSo.bindTexture(oo,oT,ok),this.uri||(this.uri=this._url),oL?this.memorySize=this._image.length:oV&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},or.recreateResource=function(){var oo=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var or=this;this._image=new ov.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(or._needReleaseAgain)return or._needReleaseAgain=!1,or._image.onload=null,void(or._image=null);or._allowMerageInAtlas&&or._enableMerageInAtlas?(oo.memorySize=0,oo._recreateLock=!1):or._createWebGlTexture(),or.completeCreate()},this._image.src=this._src}},or.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&olo.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},or.onresize=function(){this._w=this._image.width,this._h=this._image.height,oY.enabled&&this._w<oY.atlasLimitWidth&&this._h<oY.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},or.clearAtlasSource=function(){this._image=null},ok(0,or,"format",function(){return this._format}),ok(0,or,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(oo){this._$5__enableMerageInAtlas=oo}),ok(0,or,"mipmap",function(){return this._mipmap}),ok(0,or,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),ok(0,or,"atlasSource",function(){return this._image}),ok(0,or,"onload",null,function(oo){var or=this;this._onload=oo,this._image&&(this._image.onload=null!=this._onload?function(){or.onresize(),or._onload()}:null)}),ok(0,or,"onerror",null,function(oo){var or=this;this._onerror=oo,this._image&&(this._image.onerror=null!=this._onerror?function(){or._onerror()}:null)}),oV}();oq.__init([ovo,oJ,obo,oyo])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(oo,or){"use strict";for(var oT in Object.defineProperty(or,"__esModule",{value:!0}),Laya){var ok=Laya[oT];ok&&ok.__isclass&&(or[oT]=ok)}}),function(oD,oo,ok){ok.un,ok.uns;var oW=ok.static,on=ok.class,oV=ok.getset,oL=(ok.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),ox=laya.utils.ClassUtils,op=(laya.events.Event,laya.utils.HTMLChar),oU=laya.net.Loader,oh=(laya.display.Node,laya.maths.Rectangle),oi=laya.renders.Render,ov=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),oj=laya.utils.Stat,oO=laya.display.Text,o_=laya.resource.Texture,oK=laya.net.URL,o$=laya.utils.Utils,oy=function(){function ov(){}return on(ov,"laya.html.utils.HTMLParse"),ov.parse=function(oo,or,oT){or=(or="<root>"+(or=or.replace(/<br>/g,"<br/>"))+"</root>").replace(ov.spacePattern,ov.char255);var ok=o$.parseXMLFromString(or);ov._parseXML(oo,ok.childNodes[0].childNodes,oT)},ov._parseXML=function(oo,or,oT,ok){var oW=0,oD=0;if(or.join||or.item)for(oW=0,oD=or.length;oW<oD;++oW)ov._parseXML(oo,or[oW],oT,ok);else{var on,oV,oL;if(3==or.nodeType)return void(oo instanceof laya.html.dom.HTMLDivElement?(null==or.nodeName&&(or.nodeName="#text"),oV=or.nodeName.toLowerCase(),0<(oL=or.textContent.replace(/^\s+|\s+$/g,"")).length&&(on=ox.getInstance(oV))&&(oo.addChild(on),on.innerTEXT=oL.replace(ov.char255AndOneSpacePattern," "))):0<(oL=or.textContent.replace(/^\s+|\s+$/g,"")).length&&(oo.innerTEXT=oL.replace(ov.char255AndOneSpacePattern," ")));if("#comment"==(oV=or.nodeName.toLowerCase()))return;if(on=ox.getInstance(oV)){(on=oo.addChild(on)).URI=oT,on.href=ok;var oU=or.attributes;if(oU&&0<oU.length)for(oW=0,oD=oU.length;oW<oD;++oW){var oh=oU[oW],op=oh.nodeName,oi=oh.value;on._setAttributes(op,oi)}ov._parseXML(on,or.childNodes,oT,on.href)}else ov._parseXML(oo,or.childNodes,oT,ok)}},ov.char255=String.fromCharCode(255),ov.spacePattern=/&nbsp;|&#160;/g,ov.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),ov}(),ol=function(){function oX(){}return on(oX,"laya.html.utils.Layout"),oX.later=function(oo){null==oX._will&&(oX._will=[],ok.stage.frameLoop(1,null,function(){if(!(oX._will.length<1)){for(var oo=0;oo<oX._will.length;oo++)laya.html.utils.Layout.layout(oX._will[oo]);oX._will.length=0}})),oX._will.push(oo)},oX.layout=function(oo){if(!oo||!oo._style)return null;if(0==(512&oo._style._type))return null;oo.getStyle()._type&=-513;var or=oX._multiLineLayout(oo);return oi.isConchApp&&oo.layaoutCallNative&&oo.layaoutCallNative(),or},oX._multiLineLayout=function(oo){if(oO.RightToLeft)return oX._multiLineLayout2(oo);var or=new Array;oo._addChildsToLayout(or);var oT,ok,oW,oD,on,oV=0,oL=or.length,oU=oo._getCSSStyle(),oh=oU.letterSpacing,op=oU.leading,oi=oU.lineHeight,ov=oU._widthAuto()||!oU.wordWrap,ox=ov?999999:oo.width,oj=(oo.height,0),o_=oU.italic?oU.fontSize/3:0,oK=oU._getAlign(),o$=oU._getValign(),oy=0!==o$||0!==oK||0!=oi,ol=0,oS=0,oq=0,ob=0,oF=new Array,oP=oF[0]=new oM,ot=!1,oH=!1;oP.h=0,oU.italic&&(ox-=oU.fontSize/3);var oR=0,ou=!0;function os(){oP.y=oS,oS+=oP.h+op,0==oP.h&&(oS+=oi),oP.mWidth=oR,oR=0,oP=new oM,oF.push(oP),oP.h=0,ot=!(ou=!(ol=0))}for(oV=0;oV<oL;oV++)if(null!=(oT=or[oV]))if(ou=!1,oT instanceof laya.html.dom.HTMLBrElement)os(),oP.y=oS;else{if(oT._isChar()){if((oD=oT).isWord)ot=oH||"\n"===oD.char,oP.wordStartIndex=oP.elements.length;else{if(oq=oD.width+oD.style.letterSpacin,0<oF.length&&ox<ol+oq&&0<oP.wordStartIndex){var oz;oz=oP.elements.length-oP.wordStartIndex+1,oP.elements.length=oP.wordStartIndex,oV-=oz,os();continue}ot=!1,oR+=oD.width}oq=oD.width+oh,ob=oD.height,oH=!1,(ot=ot||ox<ol+oq)&&os(),oP.minTextHeight=Math.min(oP.minTextHeight,oT.height)}else ok=oT._getCSSStyle(),on=oT,oW=ok.padding,0===ok._getCssFloat()||(oy=!0),ot=oH||ok.lineElement,oq=on.width*on._style._tf.scaleX+oW[1]+oW[3]+oh,ob=on.height*on._style._tf.scaleY+oW[0]+oW[2],oH=ok.lineElement,(ot=ot||ox<ol+oq&&ok.wordWrap)&&os();oP.elements.push(oT),oP.h=Math.max(oP.h,ob),oT.x=ol,oT.y=oS,ol+=oq,oP.w=ol-oh,oP.y=oS,oj=Math.max(ol+o_,oj)}else ou||(ol+=oX.DIV_ELEMENT_PADDING),oP.wordStartIndex=oP.elements.length;if(oS=oP.y+oP.h,oy){var om=0,oC=ox;for(ov&&0<oo.width&&(oC=oo.width),oV=0,oL=oF.length;oV<oL;oV++)oF[oV].updatePos(0,oC,oV,om,oK,o$,oi),om+=Math.max(oi,oF[oV].h+op);oS=om}return ov&&(oo.width=oj),oS>oo.height&&(oo.height=oS),[oj,oS]},oX._multiLineLayout2=function(oo){var or=new Array;oo._addChildsToLayout(or);var oT,ok,oW,oD,on,oV=0,oL=or.length,oU=oo._getCSSStyle(),oh=oU.letterSpacing,op=oU.leading,oi=oU.lineHeight,ov=oU._widthAuto()||!oU.wordWrap,ox=ov?999999:oo.width,oj=(oo.height,0),o_=oU.italic?oU.fontSize/3:0,oK=2-oU._getAlign(),o$=oU._getValign(),oy=0!==o$||0!=oK||0!=oi,ol=0,oS=0,oq=0,ob=0,oF=new Array,oP=oF[0]=new oM,ot=!1,oH=!1;oP.h=0,oU.italic&&(ox-=oU.fontSize/3);var oR=0,ou=!0;function os(){oP.y=oS,oS+=oP.h+op,0==oP.h&&(oS+=oi),oP.mWidth=oR,oR=0,oP=new oM,oF.push(oP),oP.h=0,ot=!(ou=!(ol=0))}for(oV=0;oV<oL;oV++)if(null!=(oT=or[oV]))if(ou=!1,oT instanceof laya.html.dom.HTMLBrElement)os(),oP.y=oS;else{if(oT._isChar()){if((oD=oT).isWord)ot=oH||"\n"===oD.char,oP.wordStartIndex=oP.elements.length;else{if(0<oF.length&&ox<ol+oq&&0<oP.wordStartIndex){var oz;oz=oP.elements.length-oP.wordStartIndex+1,oP.elements.length=oP.wordStartIndex,oV-=oz,os();continue}ot=!1,oR+=oD.width}oq=oD.width+oh,ob=oD.height,oH=!1,(ot=ot||ox<ol+oq)&&os(),oP.minTextHeight=Math.min(oP.minTextHeight,oT.height)}else ok=oT._getCSSStyle(),on=oT,oW=ok.padding,0===ok._getCssFloat()||(oy=!0),ot=oH||ok.lineElement,oq=on.width*on._style._tf.scaleX+oW[1]+oW[3]+oh,ob=on.height*on._style._tf.scaleY+oW[0]+oW[2],oH=ok.lineElement,(ot=ot||ox<ol+oq&&ok.wordWrap)&&os();oP.elements.push(oT),oP.h=Math.max(oP.h,ob),oT.x=ol,oT.y=oS,ol+=oq,oP.w=ol-oh,oP.y=oS,oj=Math.max(ol+o_,oj)}else ou||(ol+=oX.DIV_ELEMENT_PADDING),oP.wordStartIndex=oP.elements.length;if(oS=oP.y+oP.h,oy){var om=0,oC=ox;for(oV=0,oL=oF.length;oV<oL;oV++)oF[oV].updatePos(0,oC,oV,om,oK,o$,oi),om+=Math.max(oi,oF[oV].h+op);oS=om}for(ov&&(oo.width=oj),oS>oo.height&&(oo.height=oS),oV=0,oL=oF.length;oV<oL;oV++)oF[oV].revertOrder(ox);return[oj,oS]},oX._will=null,oX.DIV_ELEMENT_PADDING=0,oX}(),oM=function(){function oo(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}on(oo,"laya.html.utils.LayoutLine");var or=oo.prototype;return or.updatePos=function(oo,or,oT,ok,oW,oD,on){var oV,oL=0;0<this.elements.length&&(oL=(oV=this.elements[this.elements.length-1]).x+oV.width-this.elements[0].x);var oU=0,oh=NaN;1===oW&&(oU=(or-oL)/2),2===oW&&(oU=or-oL),0===on||0!=oD||(oD=1);for(var op=0,oi=this.elements.length;op<oi;op++){var ov=(oV=this.elements[op])._getCSSStyle();switch(0!==oU&&(oV.x+=oU),ov._getValign()){case 0:oV.y=ok;break;case 1:var ox=0;99999!=this.minTextHeight&&(ox=this.minTextHeight);var oj=(ox+on)/2;oj=Math.max(oj,this.h),oh=(laya.html.dom.HTMLImageElement,ok+oj-oV.height),oV.y=oh;break;case 2:oV.y=ok+(on-oV.height)}}},or.revertOrder=function(oo){var or;if(0<this.elements.length){var oT,ok=0;for(oT=this.elements.length,ok=0;ok<oT;ok++)(or=this.elements[ok]).x=oo-or.x-or.width}},oo}(),oS=function(oT){function or(){this.URI=null,this._href=null,or.__super.call(this),this._text=or._EMPTYTEXT,this.setStyle(new oL(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}on(or,"laya.html.dom.HTMLElement",oT);var oo=or.prototype;return oo.layaoutCallNative=function(){var oo=0;if(this._childs&&0<(oo=this._childs.length))for(var or=0;or<oo;or++)this._childs[or].layaoutCallNative&&this._childs[or].layaoutCallNative();var oT=this._getWords();oT?laya.html.dom.HTMLElement.fillWords(this,oT,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},oo.appendChild=function(oo){return this.addChild(oo)},oo._getWords2=function(){var oo=this._text.text;if(!oo||0===oo.length)return null;var or,oT,ok=0,oW=0;if(this._text.drawWords)oT=this._text.drawWords;else{for(oW=(or=oo.split(" ")).length-1,oT=[],ok=0;ok<oW;ok++)oT.push(or[ok]," ");0<=oW&&oT.push(or[oW]),this._text.drawWords=oT}var oD,on=this._text.words;if(on&&on.length===oT.length)return on;null===on&&(this._text.words=on=[]),on.length=oT.length;var oV=this.style,oL=oV.font;for(ok=0,oW=oT.length;ok<oW;ok++){oD=o$.measureText(oT[ok],oL);var oU=on[ok]=new op(oT[ok],oD.width,oD.height||oV.fontSize,oV);if(1<oU.char.length&&(oU.charNum=oU.char),this.href){var oh=new ov;this.addChild(oh),oU.setSprite(oh)}}return on},oo._getWords=function(){if(!oO.CharacterCache)return this._getWords2();var oo=this._text.text;if(!oo||0===oo.length)return null;var or,oT=this._text.words;if(oT&&oT.length===oo.length)return oT;null===oT&&(this._text.words=oT=[]),oT.length=oo.length;for(var ok=this.style,oW=ok.font,oD=0,on=oo.length;oD<on;oD++)if(or=o$.measureText(oo.charAt(oD),oW)){var oV=oT[oD]=new op(oo.charAt(oD),or.width,or.height||ok.fontSize,ok);if(this.href){var oL=new ov;this.addChild(oL),oV.setSprite(oL)}}else console.warn("_getWords size is null"+oo.charAt(oD),oW);return oT},oo.showLinkSprite=function(){var oo=this._text.words;if(oo)for(var or,oT,ok=[],oW=0;oW<oo.length;oW++)oT=oo[oW],(or=new ov).graphics.drawRect(0,0,oT.width,oT.height,"#ff0000"),or.width=oT.width,or.height=oT.height,this.addChild(or),ok.push(or)},oo._layoutLater=function(){var oo=this.style;512&oo._type||(oo.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&oo.block?(ol.later(this),oo._type|=512):this.parent&&this.parent._layoutLater())},oo._setAttributes=function(oo,or){switch(oo){case"style":return void this.style.cssText(or);case"class":return void(this.className=or)}oT.prototype._setAttributes.call(this,oo,or)},oo.updateHref=function(){if(null!=this._href){var oo=this._getWords();if(oo)for(var or,oT,ok=0;ok<oo.length;ok++)(oT=(or=oo[ok]).getSprite())&&(oT.size(or.width,or.height),oT.on("click",this,this.onLinkHandler))}},oo.onLinkHandler=function(oo){switch(oo.type){case"click":for(var or=this;or;)or.event("link",[this.href]),or=or.parent}},oo.formatURL=function(oo){return this.URI?oK.formatURL(oo,this.URI?this.URI.path:null):oo},oV(0,oo,"href",function(){return this._href},function(oo){null!=(this._href=oo)&&(this._getCSSStyle().underLine=1,this.updateHref())}),oV(0,oo,"color",null,function(oo){this.style.color=oo}),oV(0,oo,"onClick",null,function(oo){ok._runScript("fn=function(event){"+oo+";}"),this.on("click",this,void 0)}),oV(0,oo,"id",null,function(oo){oq.document.setElementById(oo,this)}),oV(0,oo,"innerTEXT",function(){return this._text.text},function(oo){this.text=oo}),oV(0,oo,"style",function(){return this._style}),oV(0,oo,"text",function(){return this._text.text},function(oo){this._text==or._EMPTYTEXT?this._text={text:oo,words:null}:(this._text.text=oo,this._text.words&&(this._text.words.length=0)),oi.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),oV(0,oo,"parent",oT.prototype._$get_parent,function(oo){if(oo instanceof laya.html.dom.HTMLElement){var or=oo;this.URI||(this.URI=or.URI),this.style.inherit(or.style)}ok.superSet(ov,this,"parent",oo)}),oV(0,oo,"className",null,function(oo){this.style.attrs(oq.document.styleSheets["."+oo])}),or.fillWords=function(oo,or,oT,ok,oW,oD,on){oo.graphics.clear();for(var oV=0,oL=or.length;oV<oL;oV++){var oU=or[oV];oo.graphics.fillText(oU.char,oU.x+oT,oU.y+ok,oW,oD,"left",on)}},or._EMPTYTEXT={text:null,words:null},or}(ov),or=(function(oo){function or(){or.__super.call(this),this.style.lineElement=!0,this.style.block=!0}on(or,"laya.html.dom.HTMLBrElement",oS)}(),function(oo){function or(){this.contextHeight=NaN,this.contextWidth=NaN,or.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}on(or,"laya.html.dom.HTMLDivElement",oo);var oT=or.prototype;return oT.appendHTML=function(oo){oy.parse(this,oo,this.URI),this.layout()},oT._addChildsToLayout=function(or){var oo=this._getWords();if(null==oo&&0==this._childs.length)return!1;oo&&oo.forEach(function(oo){or.push(oo)});for(var oT=!0,ok=0,oW=this._childs.length;ok<oW;ok++){var oD=this._childs[ok];oT?oT=!1:or.push(null),oD._addToLayout(or)}return!0},oT._addToLayout=function(oo){this.layout()},oT.layout=function(){if(this.style){this.style._type|=512;var oo=ol.layout(this);if(oo){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new oh);var or=this._$P.mHtmlBounds;or.x=or.y=0,or.width=this.contextWidth=oo[0],or.height=this.contextHeight=oo[1],this.setBounds(or)}}},oV(0,oT,"height",function(){return this._height?this._height:this.contextHeight},oo.prototype._$set_height),oV(0,oT,"innerHTML",null,function(oo){this.destroyChildren(),this.appendHTML(oo)}),oV(0,oT,"width",function(){return this._width?this._width:this.contextWidth},function(oo){var or=!1;or=0===oo?oo!=this._width:oo!=this.width,ok.superSet(oS,this,"width",oo),or&&this.layout()}),or}(oS)),oq=function(oo){function or(){this.all=new Array,this.styleSheets=oL.styleSheets,or.__super.call(this)}on(or,"laya.html.dom.HTMLDocument",oS);var oT=or.prototype;return oT.getElementById=function(oo){return this.all[oo]},oT.setElementById=function(oo,or){this.all[oo]=or},oW(or,["document",function(){return this.document=new or}]),or}();(function(oo){function or(){this._tex=null,this._url=null,this._renderArgs=[],or.__super.call(this),this.style.block=!0}on(or,"laya.html.dom.HTMLImageElement",oS);var oT=or.prototype;oT._addToLayout=function(oo){!this._style.absolute&&oo.push(this)},oT.render=function(oo,or,oT){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(oj.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,oo.ctx.drawTexture2(or,oT,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},oT.layaoutCallNative=function(){var oo=0;if(this._childs&&0<(oo=this._childs.length))for(var or=0;or<oo;or++)this._childs[or].layaoutCallNative&&this._childs[or].layaoutCallNative()},oV(0,oT,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(oo){this._width!==oo&&(this._width=oo,this._style.width=oo,this.repaint())}),oV(0,oT,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(oo){this._height!==oo&&(this._height=oo,this._style.height=oo,this.repaint())}),oT.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),oU.clearCache(this,this._url),this._tex=null),oS.prototype.destroy.call(this)},oT.onloaded=function(){var oo=this._style;oo&&!oo.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),oo&&!oo.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),oi.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},oT._loadImageComplete=function(oo,or,oT){if(!this._destroyed)if(null!=oT)if(oT instanceof ArrayBuffer){var ok=new DataView(oT);new laya.webgl.resource.WebGLImage(new Uint8Array(oT,8),oo,0,!1,ok.getUint32(0),ok.getUint32(4));this.onloaded()}else if(oT instanceof o_)oU.imgMgrSet[oo]=or,oD.imgMgrLock(oo,oU.imgMgrSet[oo]),this._url=oo,this._tex=oT,oU.keepCache(this,oo),oU.cacheRes(oo,this._tex),this.onloaded();else{var oW=-1!=oo.indexOf(".png",oo.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(oT,oo,oW,!1,oT.width,oT.height);this.onloaded()}else this.event("error","Load image failed")},oV(0,oT,"src",null,function(oo){(oo=this.formatURL(oo),this._url!=oo)&&(null!=this._tex&&(oU.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=oo,(this._tex=oU.getRes(oo))?(oU.keepCache(this,oo),this.onloaded()):oD.imgMgrLoad(oo,this._loadImageComplete.bind(this),2,!1))})})(),function(oo){function or(){this.type=null,or.__super.call(this),this.visible=!1}on(or,"laya.html.dom.HTMLLinkElement",oo);var oT=or.prototype;oT._onload=function(oo){switch(this.type){case"text/css":oL.parseCSS(oo,this.URI)}},oV(0,oT,"href",oo.prototype._$get_href,function(oo){var or=this;oo=this.formatURL(oo),this.URI=new oK(oo);var oT=new oU;oT.once("complete",null,function(oo){or._onload(oo)}),oT.load(oo,"text")}),or._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(oS),function(oo){function or(){or.__super.call(this),this.visible=!1}on(or,"laya.html.dom.HTMLStyleElement",oo),oV(0,or.prototype,"text",oo.prototype._$get_text,function(oo){oL.parseCSS(oo,null)})}(oS),function(oo){function or(){or.__super.call(this),this._getCSSStyle().valign="middle"}on(or,"laya.html.dom.HTMLIframeElement",oo),oV(0,or.prototype,"href",oo.prototype._$get_href,function(oT){var ok=this;oT=this.formatURL(oT);var oo=new oU;oo.once("complete",null,function(oo){var or=ok.URI;ok.URI=new oK(oT),ok.innerHTML=oo,!or||(ok.URI=or)}),oo.load(oT,"text")})}(or)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(oo,or){"use strict";for(var oT in Object.defineProperty(or,"__esModule",{value:!0}),Laya){var ok=Laya[oT];ok&&ok.__isclass&&(or[oT]=ok)}}),function(oo,or,oj){oj.un,oj.uns;var ok=oj.static,oD=oj.class,oW=oj.getset,oT=(oj.__newvec,laya.display.Animation),o_=(laya.utils.Browser,laya.utils.ClassUtils),on=laya.filters.ColorFilter,oV=laya.utils.Ease,oL=laya.events.Event,oU=(laya.events.EventDispatcher,laya.display.css.Font),oh=laya.display.FrameAnimation,op=laya.display.Graphics,oi=laya.utils.Handler,ov=laya.display.Input,o$=laya.net.Loader,ox=(laya.display.Node,laya.maths.Point),oK=laya.maths.Rectangle,oy=laya.renders.Render,ol=laya.display.Sprite,oS=laya.display.Text,oq=laya.resource.Texture,ob=laya.utils.Tween,oF=laya.utils.Utils,oP=laya.utils.WeakObject;oj.interface("laya.ui.IItem"),oj.interface("laya.ui.ISelect"),oj.interface("laya.ui.IRender"),oj.interface("laya.ui.IComponent"),oj.interface("laya.ui.IBox","IComponent");var ot=function(){function oo(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return oD(oo,"laya.ui.LayoutStyle"),ok(oo,["EMPTY",function(){return this.EMPTY=new oo}]),oo}(),oH=function(){function oo(){}return oD(oo,"laya.ui.Styles"),oo.labelColor="#000000",oo.buttonStateNum=3,oo.scrollBarMinNum=15,oo.scrollBarDelayTime=500,ok(oo,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),oo}(),oR=function(){function oW(){}return oD(oW,"laya.ui.UIUtils"),oW.fillArray=function(oo,or,oT){var ok=oo.concat();if(or)for(var oW=or.split(","),oD=0,on=Math.min(ok.length,oW.length);oD<on;oD++){var oV=oW[oD];ok[oD]="true"==oV||"false"!=oV&&oV,null!=oT&&(ok[oD]=oT(oV))}return ok},oW.toColor=function(oo){return oF.toHexColor(oo)},oW.gray=function(oo,or){void 0===or&&(or=!0),or?oW.addFilter(oo,oW.grayFilter):oW.clearFilter(oo,on)},oW.addFilter=function(oo,or){var oT=oo.filters||[];oT.push(or),oo.filters=oT},oW.clearFilter=function(oo,or){var oT=oo.filters;if(null!=oT&&0<oT.length){for(var ok=oT.length-1;-1<ok;ok--){var oW=oT[ok];oj.__typeof(oW,or)&&oT.splice(ok,1)}oo.filters=oT}},oW._getReplaceStr=function(oo){return oW.escapeSequence[oo]},oW.adptString=function(oo){return oo.replace(/\\(\w)/g,oW._getReplaceStr)},oW.getBindFun=function(oo){var or=oW._funMap.get(oo);if(null==or){var oT='"'+oo+'"',ok="(function(data){if(data==null)return;with(data){try{\nreturn "+(oT=oT.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";or=oj._runScript(ok),oW._funMap.set(oo,or)}return or},ok(oW,["grayFilter",function(){return this.grayFilter=new on([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new oP}]),oW}(),ou=function(){function oo(){}return oD(oo,"UIConfig"),oo.touchScrollEnable=!0,oo.mouseWheelEnable=!0,oo.showButtons=!0,oo.popupBgColor="#000000",oo.popupBgAlpha=.5,oo.closeDialogOnSide=!0,oo}(),os=function(oT){function oK(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,oK.__super.call(this),this._weakKeys=[]}oD(oK,"laya.ui.AutoBitmap",oT);var oo=oK.prototype;return oo.destroy=function(){if(o$.clearObject(this,this._weakKey),this._weakKeys){for(var oo=0,or=this._weakKeys.length;oo<or;++oo)o$.clearObject(this,this._weakKeys[oo]);this._weakKeys=null}oT.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},oo._setChanged=function(){this._isChanged||(this._isChanged=!0,oj.timer.callLater(this,this.changeSource))},oo.changeSource=function(){this._isChanged=!1;var oo=this._source;if(oo&&oo.bitmap){var or=this.width,oT=this.height,ok=this._sizeGrid,oW=oo.sourceWidth,oD=oo.sourceHeight;if(!ok||oW===or&&oD===oT)this.cleanByTexture(oo,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,or,oT);else{o$.clearObject(this,this._weakKey),oo.$_GID||(oo.$_GID=oF.getGID());var on=oo.$_GID+"."+or+"."+oT+"."+ok.join("."),oV=o$.findObject(on);if(oF.isOKCmdList(oV))return this._weakKey=on,o$.keepObject(this,this._weakKey),void(this.cmds=oV);this.clear();var oL,oU,oh=ok[0],op=ok[1],oi=ok[2],ov=ok[3],ox=ok[4],oj=!1;if(or==oW&&(ov=op=0),oT==oD&&(oh=oi=0),or<ov+op){var o_=or;oj=!0,or=ov+op,this.save(),this.clipRect(0,0,o_,oT)}ov&&oh&&(oL=oK.getTexture(oo,0,0,ov,oh),oU=this._weakKeys[0],oL?(oU!=oL.weakKey&&(o$.clearObject(this,oU),o$.keepObject(this,oL.weakKey),this._weakKeys[0]=oL.weakKey),this.drawTexture(oL,0,0,ov,oh)):(o$.clearObject(this,oU),this._weakKeys[0]="")),op&&oh&&(oL=oK.getTexture(oo,oW-op,0,op,oh),oU=this._weakKeys[1],oL?(oU!=oL.weakKey&&(o$.clearObject(this,oU),o$.keepObject(this,oL.weakKey),this._weakKeys[1]=oL.weakKey),this.drawTexture(oL,or-op,0,op,oh)):(o$.clearObject(this,oU),this._weakKeys[1]="")),ov&&oi&&(oL=oK.getTexture(oo,0,oD-oi,ov,oi),oU=this._weakKeys[2],oL?(oU!=oL.weakKey&&(o$.clearObject(this,oU),o$.keepObject(this,oL.weakKey),this._weakKeys[2]=oL.weakKey),this.drawTexture(oL,0,oT-oi,ov,oi)):(o$.clearObject(this,oU),this._weakKeys[2]="")),op&&oi&&(oL=oK.getTexture(oo,oW-op,oD-oi,op,oi),oU=this._weakKeys[3],oL?(oU!=oL.weakKey&&(o$.clearObject(this,oU),o$.keepObject(this,oL.weakKey),this._weakKeys[3]=oL.weakKey),this.drawTexture(oL,or-op,oT-oi,op,oi)):(o$.clearObject(this,oU),this._weakKeys[3]="")),oh&&(oL=oK.getTexture(oo,ov,0,oW-ov-op,oh),oU=this._weakKeys[4],oL?(oU!=oL.weakKey&&(o$.clearObject(this,oU),o$.keepObject(this,oL.weakKey),this._weakKeys[4]=oL.weakKey),this.drawBitmap(ox,oL,ov,0,or-ov-op,oh)):(o$.clearObject(this,oU),this._weakKeys[4]="")),oi&&(oL=oK.getTexture(oo,ov,oD-oi,oW-ov-op,oi),oU=this._weakKeys[5],oL?(oU!=oL.weakKey&&(o$.clearObject(this,oU),o$.keepObject(this,oL.weakKey),this._weakKeys[5]=oL.weakKey),this.drawBitmap(ox,oL,ov,oT-oi,or-ov-op,oi)):(o$.clearObject(this,oU),this._weakKeys[5]="")),ov&&(oL=oK.getTexture(oo,0,oh,ov,oD-oh-oi),oU=this._weakKeys[6],oL?(oU!=oL.weakKey&&(o$.clearObject(this,oU),o$.keepObject(this,oL.weakKey),this._weakKeys[6]=oL.weakKey),this.drawBitmap(ox,oL,0,oh,ov,oT-oh-oi)):(o$.clearObject(this,oU),this._weakKeys[6]="")),op&&(oL=oK.getTexture(oo,oW-op,oh,op,oD-oh-oi),oU=this._weakKeys[7],oL?(oU!=oL.weakKey&&(o$.clearObject(this,oU),o$.keepObject(this,oL.weakKey),this._weakKeys[7]=oL.weakKey),this.drawBitmap(ox,oL,or-op,oh,op,oT-oh-oi)):(o$.clearObject(this,oU),this._weakKeys[7]="")),oL=oK.getTexture(oo,ov,oh,oW-ov-op,oD-oh-oi),oU=this._weakKeys[8],oL?(oU!=oL.weakKey&&(o$.clearObject(this,oU),o$.keepObject(this,oL.weakKey),this._weakKeys[8]=oL.weakKey),this.drawBitmap(ox,oL,ov,oh,or-ov-op,oT-oh-oi)):(o$.clearObject(this,oU),this._weakKeys[8]=""),oj&&this.restore(),this.autoCacheCmd&&!oy.isConchApp&&(o$.saveObject(on,this.cmds,null),this._weakKey=on,o$.keepObject(this,this._weakKey))}this._repaint()}},oo.drawBitmap=function(oo,or,oT,ok,oW,oD){void 0===oW&&(oW=0),void 0===oD&&(oD=0),oW<.1||oD<.1||(!oo||or.width==oW&&or.height==oD?this.drawTexture(or,oT,ok,oW,oD):this.fillTexture(or,oT,ok,oW,oD))},oo.clear=function(oo){void 0===oo&&(oo=!0),oT.prototype.clear.call(this,!1)},oW(0,oo,"sizeGrid",function(){return this._sizeGrid},function(oo){this._sizeGrid=oo,this._setChanged()}),oW(0,oo,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(oo){this._width!=oo&&(this._width=oo,this._setChanged())}),oW(0,oo,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(oo){this._height!=oo&&(this._height=oo,this._setChanged())}),oW(0,oo,"source",function(){return this._source},function(oo){oo?(this._source=oo,this._setChanged()):(this._source=null,this.clear())}),oK.getTexture=function(oo,or,oT,ok,oW){ok<=0&&(ok=1),oW<=0&&(oW=1),oo.$_GID||(oo.$_GID=oF.getGID());var oD=oo.$_GID+"."+or+"."+oT+"."+ok+"."+oW,on=o$.findObject(oD);if((!on||!on.source)&&(on=oq.createFromTexture(oo,or,oT,ok,oW))){if(oo.alphaTexture){var oV=oo.width/oo.alphaTexture.width;on.alphaTexture=oq.createFromTexture(oo.alphaTexture,or/oV,oT/oV,ok/oV,oW/oV)}o$.saveObject(oD,on),on.weakKey=oD}return on},oK}(op),oz=(function(oo){function or(){or.__super.call(this)}oD(or,"laya.ui.UIEvent",oL),or.SHOW_TIP="showtip",or.HIDE_TIP="hidetip"}(),function(or){function oo(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,oo.__super.call(this),this._layout=ot.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}oD(oo,"laya.ui.Component",or);var oT=oo.prototype;return oj.imps(oT,{"laya.ui.IComponent":!0}),oT.destroy=function(oo){void 0===oo&&(oo=!0),or.prototype.destroy.call(this,oo),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},oT.preinitialize=function(){},oT.createChildren=function(){},oT.initialize=function(){},oT.callLater=function(oo,or){oj.timer.callLater(this,oo,or)},oT.runCallLater=function(oo){oj.timer.runCallLater(this,oo)},oT.commitMeasure=function(){},oT.changeSize=function(){this.event("resize")},oT.getLayout=function(){return this._layout===ot.EMPTY&&(this._layout=new ot),this._layout},oT._setLayoutEnabled=function(oo){this._layout&&this._layout.enable!=oo&&(this._layout.enable=oo,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},oT.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},oT.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},oT.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},oT.resetLayoutX=function(){var oo=this._layout;if(isNaN(oo.anchorX)||(this.pivotX=oo.anchorX*this.width),this.layoutEnabled){var or=this.parent;or&&(isNaN(oo.centerX)?isNaN(oo.left)?isNaN(oo.right)||(this.x=Math.round(or.width-this.displayWidth-oo.right+this.pivotX*this.scaleX)):(this.x=Math.round(oo.left+this.pivotX*this.scaleX),isNaN(oo.right)||(this.width=(or._width-oo.left-oo.right)/(this.scaleX||.01))):this.x=Math.round(.5*(or.width-this.displayWidth)+oo.centerX+this.pivotX*this.scaleX))}},oT.resetLayoutY=function(){var oo=this._layout;if(isNaN(oo.anchorY)||(this.pivotY=oo.anchorY*this.height),this.layoutEnabled){var or=this.parent;or&&(isNaN(oo.centerY)?isNaN(oo.top)?isNaN(oo.bottom)||(this.y=Math.round(or.height-this.displayHeight-oo.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(oo.top+this.pivotY*this.scaleY),isNaN(oo.bottom)||(this.height=(or._height-oo.top-oo.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(or.height-this.displayHeight)+oo.centerY+this.pivotY*this.scaleY))}},oT.onMouseOver=function(oo){oj.stage.event("showtip",this._toolTip)},oT.onMouseOut=function(oo){oj.stage.event("hidetip",this._toolTip)},oW(0,oT,"displayWidth",function(){return this.width*this.scaleX}),oW(0,oT,"width",function(){return this._width?this._width:this.measureWidth},function(oo){this._width!=oo&&(this._width=oo,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),oW(0,oT,"measureWidth",function(){var oo=0;this.commitMeasure();for(var or=this.numChildren-1;-1<or;or--){var oT=this.getChildAt(or);oT.visible&&(oo=Math.max(oT.x+oT.width*oT.scaleX,oo))}return oo}),oW(0,oT,"displayHeight",function(){return this.height*this.scaleY}),oW(0,oT,"height",function(){return this._height?this._height:this.measureHeight},function(oo){this._height!=oo&&(this._height=oo,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),oW(0,oT,"dataSource",function(){return this._dataSource},function(oo){for(var or in this._dataSource=oo,this._dataSource)this.hasOwnProperty(or)&&"function"!=typeof this[or]&&(this[or]=this._dataSource[or])}),oW(0,oT,"scaleY",or.prototype._$get_scaleY,function(oo){oj.superGet(ol,this,"scaleY")!=oo&&(oj.superSet(ol,this,"scaleY",oo),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),oW(0,oT,"measureHeight",function(){var oo=0;this.commitMeasure();for(var or=this.numChildren-1;-1<or;or--){var oT=this.getChildAt(or);oT.visible&&(oo=Math.max(oT.y+oT.height*oT.scaleY,oo))}return oo}),oW(0,oT,"scaleX",or.prototype._$get_scaleX,function(oo){oj.superGet(ol,this,"scaleX")!=oo&&(oj.superSet(ol,this,"scaleX",oo),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),oW(0,oT,"top",function(){return this._layout.top},function(oo){oo!=this._layout.top&&(this.getLayout().top=oo,this._setLayoutEnabled(!0)),this.resetLayoutY()}),oW(0,oT,"bottom",function(){return this._layout.bottom},function(oo){oo!=this._layout.bottom&&(this.getLayout().bottom=oo,this._setLayoutEnabled(!0)),this.resetLayoutY()}),oW(0,oT,"left",function(){return this._layout.left},function(oo){oo!=this._layout.left&&(this.getLayout().left=oo,this._setLayoutEnabled(!0)),this.resetLayoutX()}),oW(0,oT,"right",function(){return this._layout.right},function(oo){oo!=this._layout.right&&(this.getLayout().right=oo,this._setLayoutEnabled(!0)),this.resetLayoutX()}),oW(0,oT,"centerX",function(){return this._layout.centerX},function(oo){oo!=this._layout.centerX&&(this.getLayout().centerX=oo,this._setLayoutEnabled(!0)),this.resetLayoutX()}),oW(0,oT,"centerY",function(){return this._layout.centerY},function(oo){oo!=this._layout.centerY&&(this.getLayout().centerY=oo,this._setLayoutEnabled(!0)),this.resetLayoutY()}),oW(0,oT,"anchorX",function(){return this._layout.anchorX},function(oo){oo!=this._layout.anchorX&&(this.getLayout().anchorX=oo,this._setLayoutEnabled(!0)),this.resetLayoutX()}),oW(0,oT,"anchorY",function(){return this._layout.anchorY},function(oo){oo!=this._layout.anchorY&&(this.getLayout().anchorY=oo,this._setLayoutEnabled(!0)),this.resetLayoutY()}),oW(0,oT,"tag",function(){return this._tag},function(oo){this._tag=oo}),oW(0,oT,"toolTip",function(){return this._toolTip},function(oo){this._toolTip!=oo&&(null!=(this._toolTip=oo)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),oW(0,oT,"comXml",function(){return this._comXml},function(oo){this._comXml=oo}),oW(0,oT,"gray",function(){return this._gray},function(oo){oo!==this._gray&&(this._gray=oo,oR.gray(this,oo))}),oW(0,oT,"disabled",function(){return this._disabled},function(oo){oo!==this._disabled&&(this.gray=this._disabled=oo,this.mouseEnabled=!oo)}),oo}(ol)),om=function(oo){function or(){this.lockLayer=null,this.popupEffect=function(oo){oo.scale(1,1),ob.from(oo,{x:oj.stage.width/2,y:oj.stage.height/2,scaleX:0,scaleY:0},300,oV.backOut,oi.create(this,this.doOpen,[oo]))},this.closeEffect=function(oo,or){ob.to(oo,{x:oj.stage.width/2,y:oj.stage.height/2,scaleX:0,scaleY:0},300,oV.strongOut,oi.create(this,this.doClose,[oo,or]))},or.__super.call(this),this.maskLayer=new ol,this.popupEffectHandler=oi.create(this,this.popupEffect,null,!1),this.closeEffectHandler=oi.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,oj.stage.addChild(this),oj.stage.on("resize",this,this._onResize),ou.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}oD(or,"laya.ui.DialogManager",ol);var oT=or.prototype;return oT._closeOnSide=function(){var oo=this.getChildAt(this.numChildren-1);oo instanceof laya.ui.Dialog&&oo.close("side")},oT.setLockView=function(oo){this.lockLayer||(this.lockLayer=new oC,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(oj.stage.width,oj.stage.height)),this.lockLayer.removeChildren(),oo&&(oo.centerX=oo.centerY=0,this.lockLayer.addChild(oo))},oT._onResize=function(oo){var or=this.maskLayer.width=oj.stage.width,oT=this.maskLayer.height=oj.stage.height;this.lockLayer&&this.lockLayer.size(or,oT),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,or,oT,ou.popupBgColor),this.maskLayer.alpha=ou.popupBgAlpha;for(var ok=this.numChildren-1;-1<ok;ok--){var oW=this.getChildAt(ok);oW.popupCenter&&this._centerDialog(oW)}},oT._centerDialog=function(oo){oo.x=Math.round((oj.stage.width-oo.width>>1)+oo.pivotX),oo.y=Math.round((oj.stage.height-oo.height>>1)+oo.pivotY)},oT.open=function(oo,or,oT){void 0===or&&(or=!1),void 0===oT&&(oT=!1),or&&this._closeAll(),oo.popupCenter&&this._centerDialog(oo),this.addChild(oo),(oo.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),oT&&null!=oo.popupEffect?oo.popupEffect.runWith(oo):this.doOpen(oo),this.event("open")},oT.doOpen=function(oo){oo.onOpened()},oT.lock=function(oo){this.lockLayer&&(oo?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},oT.close=function(oo,or,oT){void 0===oT&&(oT=!1),oT&&null!=oo.closeEffect?oo.closeEffect.runWith([oo,or]):this.doClose(oo,or),this.event("close")},oT.doClose=function(oo,or){oo.removeSelf(),oo.isModal&&this._checkMask(),oo.closeHandler&&oo.closeHandler.runWith(or),oo.onClosed(or)},oT.closeAll=function(){this._closeAll(),this.event("close")},oT._closeAll=function(){for(var oo=this.numChildren-1;-1<oo;oo--){var or=this.getChildAt(oo);or&&null!=or.close&&this.doClose(or)}},oT.getDialogsByGroup=function(oo){for(var or=[],oT=this.numChildren-1;-1<oT;oT--){var ok=this.getChildAt(oT);ok&&ok.group===oo&&or.push(ok)}return or},oT.closeByGroup=function(oo){for(var or=[],oT=this.numChildren-1;-1<oT;oT--){var ok=this.getChildAt(oT);ok&&ok.group===oo&&(ok.close(),or.push(ok))}return or},oT._checkMask=function(){this.maskLayer.removeSelf();for(var oo=this.numChildren-1;-1<oo;oo--){var or=this.getChildAt(oo);if(or&&or.isModal)return void this.addChildAt(this.maskLayer,oo)}},or}(),oC=function(oo){function or(){or.__super.call(this)}oD(or,"laya.ui.Box",oo);var oT=or.prototype;return oj.imps(oT,{"laya.ui.IBox":!0}),oW(0,oT,"dataSource",oo.prototype._$get_dataSource,function(oo){for(var or in this._dataSource=oo){var oT=this.getChildByName(or);oT?oT.dataSource=oo[or]:this.hasOwnProperty(or)&&"function"!=typeof this[or]&&(this[or]=oo[or])}}),or}(oz),oX=function(or){function oT(oo,or){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,oT.__super.call(this),this._labelColors=oH.buttonLabelColors,this._stateNum=oH.buttonStateNum,void 0===or&&(or=""),this.skin=oo,this.label=or}oD(oT,"laya.ui.Button",or);var oo=oT.prototype;return oj.imps(oo,{"laya.ui.ISelect":!0}),oo.destroy=function(oo){o$.clearCache(this,this._skin),o$.clearObject(this,this._weakKey),void 0===oo&&(oo=!0),or.prototype.destroy.call(this,oo),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(oo),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},oo.createChildren=function(){this.graphics=this._bitmap=new os},oo.createText=function(){this._text||(this._text=new oS,this._text.overflow=oS.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},oo.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},oo.onMouse=function(oo){if(!1!==this.toggle||!this._selected)return"click"===oo.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=oT.stateMap[oo.type]))},oo.changeClips=function(){var oo=o$.getRes(this._skin);if(oo&&this._skin&&""!=this._skin){o$.clearObject(this,this._weakKey);var or=oo.sourceWidth,oT=oo.sourceHeight/this._stateNum;oo.$_GID||(oo.$_GID=oF.getGID());var ok=oo.$_GID+"-"+this._stateNum,oW=o$.findObject(ok);if(oF.isOkTextureList(oW)||(oW=null),oW)this._weakKey=ok,o$.keepObject(this,this._weakKey),this._sources=oW;else{if(this._sources=[],1===this._stateNum)this._sources.push(oo);else for(var oD=0;oD<this._stateNum;oD++){var on=oq.createFromTexture(oo,0,oT*oD,or,oT);if(oo.alphaTexture){var oV=oo.width/oo.alphaTexture.width;on.alphaTexture=oq.createFromTexture(oo.alphaTexture,0/oV,oT*oD/oV,or/oV,oT/oV)}this._sources.push(on)}o$.saveObject(ok,this._sources),this._weakKey=ok,o$.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||or,this._bitmap.height=this._height||oT,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=or)}else console.warn("lose skin ",this._skin,this.name,this.__className)},oo.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var oo=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[oo]),this.label&&(this._text.color=this._labelColors[oo],this._strokeColors&&(this._text.strokeColor=this._strokeColors[oo]))},oo._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},oW(0,oo,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(oo){this.createText(),this._text.strokeColor=oo}),oW(0,oo,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),oW(0,oo,"skin",function(){return this._skin},function(oo){this._skin!=oo&&(o$.clearCache(this,this._skin),this._skin=oo,o$.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),oW(0,oo,"state",function(){return this._state},function(oo){this._state!=oo&&(this._state=oo,this._setStateChanged())}),oW(0,oo,"text",function(){return this.createText(),this._text}),oW(0,oo,"stateNum",function(){return this._stateNum},function(oo){"string"==typeof oo&&(oo=parseInt(oo)),this._stateNum!=oo&&(this._stateNum=oo<1?1:3<oo?3:oo,this.callLater(this.changeClips))}),oW(0,oo,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(oo){this._strokeColors=oR.fillArray(oH.buttonLabelColors,oo,String),this._setStateChanged()}),oW(0,oo,"labelColors",function(){return this._labelColors.join(",")},function(oo){this._labelColors=oR.fillArray(oH.buttonLabelColors,oo,String),this._setStateChanged()}),oW(0,oo,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),oW(0,oo,"label",function(){return this._text?this._text.text:null},function(oo){(this._text||oo)&&(this.createText(),this._text.text!=oo&&(oo&&!this._text.parent&&this.addChild(this._text),this._text.text=(oo+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),oW(0,oo,"selected",function(){return this._selected},function(oo){this._selected!=oo&&(this._selected=oo,this.state=this._selected?2:0,this.event("change"))}),oW(0,oo,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(oo){this.createText(),this._text.padding=oR.fillArray(oH.labelPadding,oo,Number)}),oW(0,oo,"labelSize",function(){return this.createText(),this._text.fontSize},function(oo){this.createText(),this._text.fontSize=oo}),oW(0,oo,"labelStroke",function(){return this.createText(),this._text.stroke},function(oo){this.createText(),this._text.stroke=oo}),oW(0,oo,"labelBold",function(){return this.createText(),this._text.bold},function(oo){this.createText(),this._text.bold=oo}),oW(0,oo,"labelFont",function(){return this.createText(),this._text.font},function(oo){this.createText(),this._text.font=oo}),oW(0,oo,"labelAlign",function(){return this.createText(),this._text.align},function(oo){this.createText(),this._text.align=oo}),oW(0,oo,"clickHandler",function(){return this._clickHandler},function(oo){this._clickHandler=oo}),oW(0,oo,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(oo){this._bitmap.sizeGrid=oR.fillArray(oH.defaultSizeGrid,oo,Number)}),oW(0,oo,"width",or.prototype._$get_width,function(oo){oj.superSet(oz,this,"width",oo),this._autoSize&&(this._bitmap.width=oo,this._text&&(this._text.width=oo))}),oW(0,oo,"height",or.prototype._$get_height,function(oo){oj.superSet(oz,this,"height",oo),this._autoSize&&(this._bitmap.height=oo,this._text&&(this._text.height=oo))}),oW(0,oo,"dataSource",or.prototype._$get_dataSource,function(oo){"number"==typeof(this._dataSource=oo)||"string"==typeof oo?this.label=oo+"":oj.superSet(oz,this,"dataSource",oo)}),oW(0,oo,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(oo){this._bitmap._offset=oo?oR.fillArray([1,1],oo,Number):[]}),ok(oT,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),oT}(oz),oO=function(or){function ok(oo,or,oT){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,ok.__super.call(this),void 0===or&&(or=1),void 0===oT&&(oT=1),this._clipX=or,this._clipY=oT,this.skin=oo}oD(ok,"laya.ui.Clip",or);var oo=ok.prototype;return oo.destroy=function(oo){o$.clearCache(this,this._skin),o$.clearObject(this,this._weakKey),void 0===oo&&(oo=!0),or.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},oo.dispose=function(){this.destroy(!0),oj.loader.clearRes(this._skin)},oo.createChildren=function(){this.graphics=this._bitmap=new os},oo._onDisplay=function(oo){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},oo.changeClip=function(){if(this._clipChanged=!1,this._skin){var oo=o$.getRes(this._skin);oo?this.loadComplete(this._skin,oo):oj.loader.load(this._skin,oi.create(this,this.loadComplete,[this._skin]))}},oo.loadComplete=function(oo,or){if(oo===this._skin&&or){o$.clearObject(this,this._weakKey);var oT=this._clipWidth||Math.ceil(or.sourceWidth/this._clipX),ok=this._clipHeight||Math.ceil(or.sourceHeight/this._clipY),oW=this._skin+oT+ok,oD=o$.findObject(oW);if(oF.isOkTextureList(oD)||(oD=null),oD)this._weakKey=oW,o$.keepObject(this,this._weakKey),this._sources=oD;else{this._sources=[];for(var on=0;on<this._clipY;on++)for(var oV=0;oV<this._clipX;oV++){var oL=oq.createFromTexture(or,oT*oV,ok*on,oT,ok);if(or.alphaTexture){var oU=or.width/or.alphaTexture.width;oL.alphaTexture=oq.createFromTexture(or.alphaTexture,oT*oV/oU,ok*on/oU,oT/oU,ok/oU)}this._sources.push(oL)}o$.saveObject(oW,this._sources),this._weakKey=oW,o$.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},oo.play=function(oo,or){void 0===oo&&(oo=0),void 0===or&&(or=-1),this._isPlaying=!0,this.index=oo,this._toIndex=or,this._index++,oj.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},oo._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},oo.stop=function(){this._isPlaying=!1,oj.timer.clear(this,this._loop),this.event("complete")},oo._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},oW(0,oo,"interval",function(){return this._interval},function(oo){this._interval!=oo&&(this._interval=oo,this._isPlaying&&this.play())}),oW(0,oo,"skin",function(){return this._skin},function(oo){this._skin!=oo&&(o$.clearCache(this,this._skin),(this._skin=oo)?(o$.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),oW(0,oo,"sources",function(){return this._sources},function(oo){this._sources=oo,this.index=this._index,this.event("loaded")}),oW(0,oo,"clipX",function(){return this._clipX},function(oo){this._clipX=oo||1,this._setClipChanged()}),oW(0,oo,"clipY",function(){return this._clipY},function(oo){this._clipY=oo||1,this._setClipChanged()}),oW(0,oo,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),oW(0,oo,"clipWidth",function(){return this._clipWidth},function(oo){this._clipWidth=oo,this._setClipChanged()}),oW(0,oo,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(oo){this._bitmap.sizeGrid=oR.fillArray(oH.defaultSizeGrid,oo,Number)}),oW(0,oo,"group",function(){return this._group},function(oo){oo&&this._skin&&o$.setGroup(this._skin,oo),this._group=oo}),oW(0,oo,"clipHeight",function(){return this._clipHeight},function(oo){this._clipHeight=oo,this._setClipChanged()}),oW(0,oo,"width",or.prototype._$get_width,function(oo){oj.superSet(oz,this,"width",oo),this._bitmap.width=oo}),oW(0,oo,"height",or.prototype._$get_height,function(oo){oj.superSet(oz,this,"height",oo),this._bitmap.height=oo}),oW(0,oo,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),oW(0,oo,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),oW(0,oo,"index",function(){return this._index},function(oo){this._index=oo,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[oo]),this.event("change")}),oW(0,oo,"autoPlay",function(){return this._autoPlay},function(oo){this._autoPlay!=oo&&((this._autoPlay=oo)?this.play():this.stop())}),oW(0,oo,"isPlaying",function(){return this._isPlaying},function(oo){this._isPlaying=oo}),oW(0,oo,"dataSource",or.prototype._$get_dataSource,function(oo){"number"==typeof(this._dataSource=oo)&&Math.floor(oo)==oo||"string"==typeof oo?this.index=parseInt(oo):oj.superSet(oz,this,"dataSource",oo)}),oW(0,oo,"bitmap",function(){return this._bitmap}),ok}(oz),oM=function(or){function oo(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,oo.__super.call(this)}oD(oo,"laya.ui.ColorPicker",or);var oT=oo.prototype;return oT.destroy=function(oo){void 0===oo&&(oo=!0),or.prototype.destroy.call(this,oo),this._colorPanel&&this._colorPanel.destroy(oo),this._colorButton&&this._colorButton.destroy(oo),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},oT.createChildren=function(){this.addChild(this._colorButton=new oX),this._colorPanel=new oC,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new ol),this._colorPanel.addChild(this._colorBlock=new ol),this._colorPanel.addChild(this._colorInput=new ov)},oT.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},oT.onPanelMouseDown=function(oo){oo.stopPropagation()},oT.changePanel=function(){this._panelChanged=!1;var oo=this._colorPanel.graphics;oo.clear(),oo.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(oo=this._colorTiles.graphics).clear();for(var or=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],oT=0;oT<12;oT++)for(var ok=0;ok<20;ok++){var oW=0;oW=0===ok?or[oT]:1===ok?0:51*(((3*oT+ok/6)%3<<0)+3*(oT/6<<0))<<16|ok%6*51<<8|(oT<<0)%6*51;var oD=oR.toColor(oW);this._colors.push(oD);var on=ok*this._gridSize,oV=oT*this._gridSize;oo.drawRect(on,oV,this._gridSize,this._gridSize,oD,"#000000")}},oT.onColorButtonClick=function(oo){this._colorPanel.parent?this.close():this.open()},oT.open=function(){var oo=this.localToGlobal(new ox),or=oo.x+this._colorPanel.width<=oj.stage.width?oo.x:oj.stage.width-this._colorPanel.width,oT=oo.y+this._colorButton.height;oT=oT+this._colorPanel.height<=oj.stage.height?oT:oo.y-this._colorPanel.height,this._colorPanel.pos(or,oT),this._colorPanel.zOrder=1001,oj._currentStage.addChild(this._colorPanel),oj.stage.on("mousedown",this,this.removeColorBox)},oT.close=function(){oj.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},oT.removeColorBox=function(oo){this.close()},oT.onColorFieldKeyDown=function(oo){13==oo.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),oo.stopPropagation())},oT.onColorInputChange=function(oo){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},oT.onColorTilesClick=function(oo){this.selectedColor=this.getColorByMouse(),this.close()},oT.onColorTilesMouseMove=function(oo){this._colorInput.focus=!1;var or=this.getColorByMouse();this._colorInput.text=or,this.drawBlock(or)},oT.getColorByMouse=function(){var oo=this._colorTiles.getMousePoint(),or=Math.floor(oo.x/this._gridSize),oT=Math.floor(oo.y/this._gridSize);return this._colors[20*oT+or]},oT.drawBlock=function(oo){var or=this._colorBlock.graphics;or.clear();var oT=oo||"#ffffff";or.drawRect(0,0,50,20,oT,this._borderColor),oo||or.drawLine(0,0,50,20,"#ff0000")},oT.changeColor=function(){var oo=this.graphics;oo.clear();var or=this._selectedColor||"#000000";oo.drawRect(0,0,this._colorButton.width,this._colorButton.height,or)},oT._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},oW(0,oT,"inputBgColor",function(){return this._inputBgColor},function(oo){this._inputBgColor=oo,this._setPanelChanged()}),oW(0,oT,"selectedColor",function(){return this._selectedColor},function(oo){this._selectedColor!=oo&&(this._selectedColor=this._colorInput.text=oo,this.drawBlock(oo),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",oL.EMPTY.setTo("change",this,this)))}),oW(0,oT,"skin",function(){return this._colorButton.skin},function(oo){this._colorButton.skin=oo,this.changeColor()}),oW(0,oT,"bgColor",function(){return this._bgColor},function(oo){this._bgColor=oo,this._setPanelChanged()}),oW(0,oT,"borderColor",function(){return this._borderColor},function(oo){this._borderColor=oo,this._setPanelChanged()}),oW(0,oT,"inputColor",function(){return this._inputColor},function(oo){this._inputColor=oo,this._setPanelChanged()}),oo}(oz),oc=function(or){function oT(oo,or){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,oT.__super.call(this),this._itemColors=oH.comboBoxItemColors,this.skin=oo,this.labels=or}oD(oT,"laya.ui.ComboBox",or);var oo=oT.prototype;return oo.destroy=function(oo){void 0===oo&&(oo=!0),or.prototype.destroy.call(this,oo),this._button&&this._button.destroy(oo),this._list&&this._list.destroy(oo),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},oo.createChildren=function(){this.addChild(this._button=new oX),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},oo._createList=function(){this._list=new ow,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},oo._setListEvent=function(oo){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=oi.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},oo.onListDown=function(oo){oo.stopPropagation()},oo.onScrollBarDown=function(oo){oo.stopPropagation()},oo.onButtonMouseDown=function(oo){this.callLater(this.switchTo,[!this._isOpen])},oo.changeList=function(){this._listChanged=!1;var oo=this.width-2,or=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:oo,height:this._itemHeight,fontSize:this._itemSize,color:or}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},oo.onlistItemMouse=function(oo,or){var oT=oo.type;if("mouseover"===oT||"mouseout"===oT){if(this._isCustomList)return;var ok=this._list.getCell(or);if(!ok)return;var oW=ok.getChildByName("label");oW&&("mouseover"===oT?(oW.bgColor=this._itemColors[0],oW.color=this._itemColors[1]):(oW.bgColor=null,oW.color=this._itemColors[2]))}else"click"===oT&&(this.selectedIndex=or,this.isOpen=!1)},oo.switchTo=function(oo){this.isOpen=oo},oo.changeOpen=function(){this.isOpen=!this._isOpen},oo.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var oo=this._list.graphics;oo.clear(),oo.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var or=this._list.array||[],oT=or.length=0,ok=this._labels.length;oT<ok;oT++)or.push({label:this._labels[oT]});this._list.height=this._listHeight,this._list.array=or},oo.changeSelected=function(){this._button.label=this.selectedLabel},oo._onStageMouseWheel=function(oo){this._list&&!this._list.contains(oo.target)&&this.removeList(null)},oo.removeList=function(oo){oj.stage.off("mousedown",this,this.removeList),oj.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},oW(0,oo,"selectedIndex",function(){return this._selectedIndex},function(oo){this._selectedIndex!=oo&&(this._selectedIndex=oo,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[oL.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),oW(0,oo,"measureHeight",function(){return this._button.height}),oW(0,oo,"skin",function(){return this._button.skin},function(oo){this._button.skin!=oo&&(this._button.skin=oo,this._listChanged=!0)}),oW(0,oo,"measureWidth",function(){return this._button.width}),oW(0,oo,"width",or.prototype._$get_width,function(oo){oj.superSet(oz,this,"width",oo),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),oW(0,oo,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(oo){this.selectedIndex=this._labels.indexOf(oo)}),oW(0,oo,"labels",function(){return this._labels.join(",")},function(oo){0<this._labels.length&&(this.selectedIndex=-1),oo?this._labels=oo.split(","):this._labels.length=0,this._itemChanged=!0}),oW(0,oo,"height",or.prototype._$get_height,function(oo){oj.superSet(oz,this,"height",oo),this._button.height=this._height}),oW(0,oo,"selectHandler",function(){return this._selectHandler},function(oo){this._selectHandler=oo}),oW(0,oo,"visibleNum",function(){return this._visibleNum},function(oo){this._visibleNum=oo,this._listChanged=!0}),oW(0,oo,"labelBold",function(){return this._button.text.bold},function(oo){this._button.text.bold=oo}),oW(0,oo,"itemColors",function(){return String(this._itemColors)},function(oo){this._itemColors=oR.fillArray(this._itemColors,oo,String),this._listChanged=!0}),oW(0,oo,"itemSize",function(){return this._itemSize},function(oo){this._itemSize=oo,this._listChanged=!0}),oW(0,oo,"scrollBar",function(){return this.list.scrollBar}),oW(0,oo,"isOpen",function(){return this._isOpen},function(oo){if(this._isOpen!=oo)if(this._isOpen=oo,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var or=this.localToGlobal(ox.TEMP.setTo(0,0)),oT=or.y+this._button.height;oT=oT+this._listHeight<=oj.stage.height?oT:or.y-this._listHeight,this._list.pos(or.x,oT),this._list.zOrder=1001,oj._currentStage.addChild(this._list),oj.stage.once("mousedown",this,this.removeList),oj.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),oW(0,oo,"scrollBarSkin",function(){return this._scrollBarSkin},function(oo){this._scrollBarSkin=oo}),oW(0,oo,"sizeGrid",function(){return this._button.sizeGrid},function(oo){this._button.sizeGrid=oo}),oW(0,oo,"button",function(){return this._button}),oW(0,oo,"list",function(){return this._list||this._createList(),this._list},function(oo){oo&&(oo.removeSelf(),this._isCustomList=!0,this._list=oo,this._setListEvent(oo),this._itemHeight=oo.getCell(0).height+oo.spaceY)}),oW(0,oo,"dataSource",or.prototype._$get_dataSource,function(oo){"number"==typeof(this._dataSource=oo)&&Math.floor(oo)==oo||"string"==typeof oo?this.selectedIndex=parseInt(oo):oo instanceof Array?this.labels=oo.join(","):oj.superSet(oz,this,"dataSource",oo)}),oW(0,oo,"labelColors",function(){return this._button.labelColors},function(oo){this._button.labelColors!=oo&&(this._button.labelColors=oo)}),oW(0,oo,"labelPadding",function(){return this._button.text.padding.join(",")},function(oo){this._button.text.padding=oR.fillArray(oH.labelPadding,oo,Number)}),oW(0,oo,"labelSize",function(){return this._button.text.fontSize},function(oo){this._button.text.fontSize=oo}),oW(0,oo,"labelFont",function(){return this._button.text.font},function(oo){this._button.text.font=oo}),oW(0,oo,"stateNum",function(){return this._button.stateNum},function(oo){this._button.stateNum=oo}),oT}(oz),oe=function(or){function oT(oo){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,oT.__super.call(this),this._showButtons=ou.showButtons,this._touchScrollEnable=ou.touchScrollEnable,this._mouseWheelEnable=ou.mouseWheelEnable,this.skin=oo,this.max=1}oD(oT,"laya.ui.ScrollBar",or);var oo=oT.prototype;return oo.destroy=function(oo){void 0===oo&&(oo=!0),this.stopScroll(),this.target=null,or.prototype.destroy.call(this,oo),this.upButton&&this.upButton.destroy(oo),this.downButton&&this.downButton.destroy(oo),this.slider&&this.slider.destroy(oo),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},oo.createChildren=function(){this.addChild(this.slider=new oJ),this.addChild(this.upButton=new oX),this.addChild(this.downButton=new oX)},oo.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},oo.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},oo.onButtonMouseDown=function(oo){var or=oo.currentTarget===this.upButton;this.slide(or),oj.timer.once(oH.scrollBarDelayTime,this,this.startLoop,[or]),oj.stage.once("mouseup",this,this.onStageMouseUp)},oo.startLoop=function(oo){oj.timer.frameLoop(1,this,this.slide,[oo])},oo.slide=function(oo){oo?this.value-=this._scrollSize:this.value+=this._scrollSize},oo.onStageMouseUp=function(oo){oj.timer.clear(this,this.startLoop),oj.timer.clear(this,this.slide)},oo.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},oo.changeSize=function(){or.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},oo.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},oo.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},oo.setScroll=function(oo,or,oT){this.runCallLater(this.changeSize),this.slider.setSlider(oo,or,oT),this.slider.bar.visible=0<or,!this._hide&&this.autoHide&&(this.visible=!1)},oo.onTargetMouseWheel=function(oo){this.value-=oo.delta*this._scrollSize,this.target=this._target},oo.onTargetMouseDown=function(oo){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new ox),this._lastPoint.setTo(oj.stage.mouseX,oj.stage.mouseY),oj.timer.clear(this,this.tweenMove),ob.clearTween(this),oj.stage.once("mouseup",this,this.onStageMouseUp2),oj.stage.once("mouseout",this,this.onStageMouseUp2),oj.timer.frameLoop(1,this,this.loop)},oo.loop=function(){var oo=oj.stage.mouseY,or=oj.stage.mouseX;if(this._lastOffset=this.isVertical?oo-this._lastPoint.y:or-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?oj.stage._canvasTransform.getScaleY():oj.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=or,this._lastPoint.y=oo,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},oo.onStageMouseUp2=function(oo){if(oj.stage.off("mouseup",this,this.onStageMouseUp2),oj.stage.off("mouseout",this,this.onStageMouseUp2),oj.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?ob.to(this,{value:this.min},this.elasticBackTime,oV.sineOut,oi.create(this,this.elasticOver)):this._value>this.max&&ob.to(this,{value:this.max},this.elasticBackTime,oV.sineOut,oi.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?oj.stage.mouseY-this._lastPoint.y:oj.stage.mouseX-this._lastPoint.x);for(var or=0,oT=Math.min(this._offsets.length,3),ok=0;ok<oT;ok++)or+=this._offsets[this._offsets.length-1-ok];if(this._lastOffset=or/oT,(or=Math.abs(this._lastOffset))<2)return void this.event("end");60<or&&(this._lastOffset=0<this._lastOffset?60:-60);var oW=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));oj.timer.frameLoop(1,this,this.tweenMove,[oW])}},oo.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&ob.to(this,{alpha:0},500),this.event("end")},oo.tweenMove=function(oo){this._lastOffset*=this.rollRatio;var or=NaN;if(0<oo&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,or=.5*-(this.min-oo-this.value),this._lastOffset>or&&(this._lastOffset=or)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,or=.5*-(this.max+oo-this.value),this._lastOffset<or&&(this._lastOffset=or))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(oj.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?ob.to(this,{value:this.min},this.elasticBackTime,oV.sineOut,oi.create(this,this.elasticOver)):this._value>this.max?ob.to(this,{value:this.max},this.elasticBackTime,oV.sineOut,oi.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&ob.to(this,{alpha:0},500)}},oo.stopScroll=function(){this.onStageMouseUp2(null),oj.timer.clear(this,this.tweenMove),ob.clearTween(this)},oW(0,oo,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),oW(0,oo,"skin",function(){return this._skin},function(oo){this._skin!=oo&&(this._skin=oo,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),oW(0,oo,"max",function(){return this.slider.max},function(oo){this.slider.max=oo}),oW(0,oo,"showButtons",function(){return this._showButtons},function(oo){this._showButtons=oo,this.callLater(this.changeScrollBar)}),oW(0,oo,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),oW(0,oo,"min",function(){return this.slider.min},function(oo){this.slider.min=oo}),oW(0,oo,"value",function(){return this._value},function(oo){oo!==this._value&&(this._value=oo,this._isElastic||(this.slider._value!=oo&&(this.slider._value=oo,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),oW(0,oo,"isVertical",function(){return this.slider.isVertical},function(oo){this.slider.isVertical=oo}),oW(0,oo,"sizeGrid",function(){return this.slider.sizeGrid},function(oo){this.slider.sizeGrid=oo}),oW(0,oo,"scrollSize",function(){return this._scrollSize},function(oo){this._scrollSize=oo}),oW(0,oo,"dataSource",or.prototype._$get_dataSource,function(oo){"number"==typeof(this._dataSource=oo)||"string"==typeof oo?this.value=Number(oo):oj.superSet(oz,this,"dataSource",oo)}),oW(0,oo,"thumbPercent",function(){return this._thumbPercent},function(oo){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),oo=1<=oo?.99:oo,this._thumbPercent=oo,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*oo,oH.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*oo,oH.scrollBarMinNum))}),oW(0,oo,"target",function(){return this._target},function(oo){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=oo)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),oW(0,oo,"hide",function(){return this._hide},function(oo){this._hide=oo,this.visible=!oo}),oW(0,oo,"touchScrollEnable",function(){return this._touchScrollEnable},function(oo){this._touchScrollEnable=oo,this.target=this._target}),oW(0,oo,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(oo){this._mouseWheelEnable=oo,this.target=this._target}),oW(0,oo,"tick",function(){return this.slider.tick},function(oo){this.slider.tick=oo}),oT}(oz),oJ=function(or){function oT(oo){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,oT.__super.call(this),this.skin=oo}oD(oT,"laya.ui.Slider",or);var oo=oT.prototype;return oo.destroy=function(oo){void 0===oo&&(oo=!0),or.prototype.destroy.call(this,oo),this._bg&&this._bg.destroy(oo),this._bar&&this._bar.destroy(oo),this._progress&&this._progress.destroy(oo),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},oo.createChildren=function(){this.addChild(this._bg=new oY),this.addChild(this._bar=new oX)},oo.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},oo.onBarMouseDown=function(oo){this._globalSacle||(this._globalSacle=new ox),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=oj.stage.mouseX,this._ty=oj.stage.mouseY,oj.stage.on("mousemove",this,this.mouseMove),oj.stage.once("mouseup",this,this.mouseUp),oj.stage.once("mouseout",this,this.mouseUp),this.showValueText()},oo.showValueText=function(){if(this.showLabel){var oo=laya.ui.Slider.label;this.addChild(oo),oo.textField.changeText(this._value+""),this.isVertical?(oo.x=this._bar.x+20,oo.y=.5*(this._bar.height-oo.height)+this._bar.y):(oo.y=this._bar.y-20,oo.x=.5*(this._bar.width-oo.width)+this._bar.x)}},oo.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},oo.mouseUp=function(oo){oj.stage.off("mousemove",this,this.mouseMove),oj.stage.off("mouseup",this,this.mouseUp),oj.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},oo.mouseMove=function(oo){var or=this._value;this.isVertical?(this._bar.y+=(oj.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(oj.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=oj.stage.mouseX,this._ty=oj.stage.mouseY;var oT=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*oT)/oT,this._value!=or&&this.sendChangeEvent(),this.showValueText()},oo.sendChangeEvent=function(oo){void 0===oo&&(oo="change"),this.event(oo),this.changeHandler&&this.changeHandler.runWith(this._value)},oo.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},oo.changeSize=function(){or.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},oo.setSlider=function(oo,or,oT){this._value=-1,this._min=oo,this._max=oo<or?or:oo,this.value=oT<oo?oo:or<oT?or:oT},oo.changeValue=function(){var oo=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*oo)/oo,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var or=this._max-this._min;0===or&&(or=1),this.isVertical?(this._bar.y=(this._value-this._min)/or*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/or*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},oo.onBgMouseDown=function(oo){var or=this._bg.getMousePoint();this.isVertical?this.value=or.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=or.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},oW(0,oo,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),oW(0,oo,"skin",function(){return this._skin},function(oo){if(this._skin!=oo){this._skin=oo,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var or=this._skin.replace(".png","$progress.png");o$.getRes(or)&&(this._progress||(this.addChild(this._progress=new oY),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=or),this.setBarPoint(),this.callLater(this.changeValue)}}),oW(0,oo,"allowClickBack",function(){return this._allowClickBack},function(oo){this._allowClickBack!=oo&&((this._allowClickBack=oo)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),oW(0,oo,"max",function(){return this._max},function(oo){this._max!=oo&&(this._max=oo,this.callLater(this.changeValue))}),oW(0,oo,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),oW(0,oo,"tick",function(){return this._tick},function(oo){this._tick!=oo&&(this._tick=oo,this.callLater(this.changeValue))}),oW(0,oo,"sizeGrid",function(){return this._bg.sizeGrid},function(oo){this._bg.sizeGrid=oo,this._bar.sizeGrid=oo,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),oW(0,oo,"min",function(){return this._min},function(oo){this._min!=oo&&(this._min=oo,this.callLater(this.changeValue))}),oW(0,oo,"value",function(){return this._value},function(oo){if(this._value!=oo){var or=this._value;this._value=oo,this.changeValue(),this._value!=or&&this.sendChangeEvent()}}),oW(0,oo,"dataSource",or.prototype._$get_dataSource,function(oo){"number"==typeof(this._dataSource=oo)||"string"==typeof oo?this.value=Number(oo):oj.superSet(oz,this,"dataSource",oo)}),oW(0,oo,"bar",function(){return this._bar}),ok(oT,["label",function(){return this.label=new oA}]),oT}(oz),oY=function(or){function oT(oo){this._bitmap=null,this._skin=null,this._group=null,oT.__super.call(this),this.skin=oo}oD(oT,"laya.ui.Image",or);var oo=oT.prototype;return oo.destroy=function(oo){void 0===oo&&(oo=!0),or.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,o$.clearCache(this,this._skin)},oo.dispose=function(){this.destroy(!0),o$.clearCache(this,this._skin)},oo.createChildren=function(){this.graphics=this._bitmap=new os},oo.setSource=function(oo,or){oo===this._skin&&or&&(this.source=or,this.onCompResize())},oW(0,oo,"source",function(){return this._bitmap.source},function(oo){this._bitmap&&(this._bitmap.source=oo,this.event("loaded"),this.repaint())}),oW(0,oo,"dataSource",or.prototype._$get_dataSource,function(oo){"string"==typeof(this._dataSource=oo)?this.skin=oo:oj.superSet(oz,this,"dataSource",oo)}),oW(0,oo,"measureHeight",function(){return this._bitmap.height}),oW(0,oo,"skin",function(){return this._skin},function(oo){if(this._skin!=oo)if(o$.clearCache(this,this._skin),this._skin=oo){o$.keepCache(this,this._skin);var or=o$.getRes(oo);or?(this.source=or,this.onCompResize()):oj.loader.load(this._skin,oi.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),oW(0,oo,"group",function(){return this._group},function(oo){oo&&this._skin&&o$.setGroup(this._skin,oo),this._group=oo}),oW(0,oo,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(oo){this._bitmap.sizeGrid=oR.fillArray(oH.defaultSizeGrid,oo,Number)}),oW(0,oo,"measureWidth",function(){return this._bitmap.width}),oW(0,oo,"width",or.prototype._$get_width,function(oo){oj.superSet(oz,this,"width",oo),this._bitmap.width=0==oo?1e-7:oo}),oW(0,oo,"height",or.prototype._$get_height,function(oo){oj.superSet(oz,this,"height",oo),this._bitmap.height=0==oo?1e-7:oo}),oT}(oz),oA=function(or){function oT(oo){this._tf=null,oT.__super.call(this),void 0===oo&&(oo=""),oU.defaultColor=oH.labelColor,this.text=oo}oD(oT,"laya.ui.Label",or);var oo=oT.prototype;return oo.destroy=function(oo){void 0===oo&&(oo=!0),or.prototype.destroy.call(this,oo),this._tf=null},oo.createChildren=function(){this.addChild(this._tf=new oS)},oo.changeText=function(oo){this._tf.changeText(oo)},oW(0,oo,"padding",function(){return this._tf.padding.join(",")},function(oo){this._tf.padding=oR.fillArray(oH.labelPadding,oo,Number)}),oW(0,oo,"bold",function(){return this._tf.bold},function(oo){this._tf.bold=oo}),oW(0,oo,"align",function(){return this._tf.align},function(oo){this._tf.align=oo}),oW(0,oo,"text",function(){return this._tf.text},function(oo){this._tf.text!=oo&&(oo&&(oo=oR.adptString(oo+"")),this._tf.text=oo,this.event("change"),this._width&&this._height||this.onCompResize())}),oW(0,oo,"italic",function(){return this._tf.italic},function(oo){this._tf.italic=oo}),oW(0,oo,"wordWrap",function(){return this._tf.wordWrap},function(oo){this._tf.wordWrap=oo}),oW(0,oo,"font",function(){return this._tf.font},function(oo){this._tf.font=oo}),oW(0,oo,"dataSource",or.prototype._$get_dataSource,function(oo){"number"==typeof(this._dataSource=oo)||"string"==typeof oo?this.text=oo+"":oj.superSet(oz,this,"dataSource",oo)}),oW(0,oo,"color",function(){return this._tf.color},function(oo){this._tf.color=oo}),oW(0,oo,"valign",function(){return this._tf.valign},function(oo){this._tf.valign=oo}),oW(0,oo,"leading",function(){return this._tf.leading},function(oo){this._tf.leading=oo}),oW(0,oo,"fontSize",function(){return this._tf.fontSize},function(oo){this._tf.fontSize=oo}),oW(0,oo,"bgColor",function(){return this._tf.bgColor},function(oo){this._tf.bgColor=oo}),oW(0,oo,"borderColor",function(){return this._tf.borderColor},function(oo){this._tf.borderColor=oo}),oW(0,oo,"stroke",function(){return this._tf.stroke},function(oo){this._tf.stroke=oo}),oW(0,oo,"strokeColor",function(){return this._tf.strokeColor},function(oo){this._tf.strokeColor=oo}),oW(0,oo,"textField",function(){return this._tf}),oW(0,oo,"measureWidth",function(){return this._tf.width}),oW(0,oo,"measureHeight",function(){return this._tf.height}),oW(0,oo,"width",function(){return this._width||this._tf.text?oj.superGet(oz,this,"width"):0},function(oo){oj.superSet(oz,this,"width",oo),this._tf.width=oo}),oW(0,oo,"height",function(){return this._height||this._tf.text?oj.superGet(oz,this,"height"):0},function(oo){oj.superSet(oz,this,"height",oo),this._tf.height=oo}),oW(0,oo,"overflow",function(){return this._tf.overflow},function(oo){this._tf.overflow=oo}),oW(0,oo,"underline",function(){return this._tf.underline},function(oo){this._tf.underline=oo}),oW(0,oo,"underlineColor",function(){return this._tf.underlineColor},function(oo){this._tf.underlineColor=oo}),oT}(oz),oI=function(or){function oT(oo){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,oT.__super.call(this),this.skin=oo}oD(oT,"laya.ui.ProgressBar",or);var oo=oT.prototype;return oo.destroy=function(oo){void 0===oo&&(oo=!0),or.prototype.destroy.call(this,oo),this._bg&&this._bg.destroy(oo),this._bar&&this._bar.destroy(oo),this._bg=this._bar=null,this.changeHandler=null},oo.createChildren=function(){this.addChild(this._bg=new oY),this.addChild(this._bar=new oY)},oo.changeValue=function(){if(this.sizeGrid){var oo=this.sizeGrid.split(","),or=Number(oo[3]),oT=Number(oo[1]),ok=(this.width-or-oT)*this._value;this._bar.width=or+oT+ok,this._bar.visible=this._bar.width>or+oT}else this._bar.width=this.width*this._value},oW(0,oo,"measureHeight",function(){return this._bg.height}),oW(0,oo,"skin",function(){return this._skin},function(oo){this._skin!=oo&&(this._skin=oo,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),oW(0,oo,"measureWidth",function(){return this._bg.width}),oW(0,oo,"height",or.prototype._$get_height,function(oo){oj.superSet(oz,this,"height",oo),this._bg.height=this._height,this._bar.height=this._height}),oW(0,oo,"bar",function(){return this._bar}),oW(0,oo,"value",function(){return this._value},function(oo){this._value!=oo&&(oo=1<oo?1:oo<0?0:oo,this._value=oo,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(oo))}),oW(0,oo,"bg",function(){return this._bg}),oW(0,oo,"sizeGrid",function(){return this._bg.sizeGrid},function(oo){this._bg.sizeGrid=this._bar.sizeGrid=oo}),oW(0,oo,"width",or.prototype._$get_width,function(oo){oj.superSet(oz,this,"width",oo),this._bg.width=this._width,this.callLater(this.changeValue)}),oW(0,oo,"dataSource",or.prototype._$get_dataSource,function(oo){"number"==typeof(this._dataSource=oo)||"string"==typeof oo?this.value=Number(oo):oj.superSet(oz,this,"dataSource",oo)}),oT}(oz),oN=(function(oo){function oT(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,oT.__super.call(this),this._tipBox=new oz,this._tipBox.addChild(this._tipText=new oS),this._tipText.x=this._tipText.y=5,this._tipText.color=oT.tipTextColor,this._defaultTipHandler=this._showDefaultTip,oj.stage.on("showtip",this,this._onStageShowTip),oj.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}oD(oT,"laya.ui.TipManager",oz);var or=oT.prototype;or._onStageHideTip=function(oo){oj.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},or._onStageShowTip=function(oo){oj.timer.once(oT.tipDelay,this,this._showTip,[oo],!0)},or._showTip=function(oo){if("string"==typeof oo){var or=String(oo);Boolean(or)&&this._defaultTipHandler(or)}else oo instanceof laya.utils.Handler?oo.run():"function"==typeof oo&&oo.apply();oj.stage.on("mousemove",this,this._onStageMouseMove),oj.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},or._onStageMouseDown=function(oo){this.closeAll()},or._onStageMouseMove=function(oo){this._showToStage(this,oT.offsetX,oT.offsetY)},or._showToStage=function(oo,or,oT){void 0===or&&(or=0),void 0===oT&&(oT=0);var ok=oo.getBounds();oo.x=oj.stage.mouseX+or,oo.y=oj.stage.mouseY+oT,oo.x+ok.width>oj.stage.width&&(oo.x-=ok.width+or),oo.y+ok.height>oj.stage.height&&(oo.y-=ok.height+oT)},or.closeAll=function(){oj.timer.clear(this,this._showTip),oj.stage.off("mousemove",this,this._onStageMouseMove),oj.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},or.showDislayTip=function(oo){this.addChild(oo),this._showToStage(this),oj._currentStage.addChild(this)},or._showDefaultTip=function(oo){this._tipText.text=oo;var or=this._tipBox.graphics;or.clear(),or.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,oT.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),oj._currentStage.addChild(this)},oW(0,or,"defaultTipHandler",function(){return this._defaultTipHandler},function(oo){this._defaultTipHandler=oo}),oT.offsetX=10,oT.offsetY=15,oT.tipTextColor="#ffffff",oT.tipBackColor="#111111",oT.tipDelay=200}(),function(oo){var ov;function ox(){this._idMap=null,this._aniList=null,this._watchMap={},ox.__super.call(this)}oD(ox,"laya.ui.View",oC);var or=ox.prototype;return or.createView=function(oo){if(oo.animations&&!this._idMap&&(this._idMap={}),ox.createComp(oo,this,this),oo.animations){var or,oT,ok=[],oW=oo.animations,oD=0,on=oW.length;for(oD=0;oD<on;oD++){switch(or=new oh,oT=oW[oD],or._setUp(this._idMap,oT),(this[oT.name]=or)._setControlNode(this),oT.action){case 1:or.play(0,!1);break;case 2:or.play(0,!0)}ok.push(or)}this._aniList=ok}0<this._width&&null==oo.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},or.onEvent=function(oo,or){},or.loadUI=function(oo){var or=ox.uiMap[oo];or&&this.createView(or)},or.destroy=function(oo){void 0===oo&&(oo=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,oo)},or.changeData=function(oo){var or=this._watchMap[oo];if(or){console.log("change",oo);for(var oT=0,ok=or.length;oT<ok;oT++){or[oT].exe(this)}}},ox._regs=function(){for(var oo in ox.uiClassMap)o_.regClass(oo,ox.uiClassMap[oo])},ox.createComp=function(oo,or,oT,ok){if(!(or=or||ox.getCompInstance(oo)))return console.warn("can not create:"+oo.type),null;var oW=oo.child;if(oW)for(var oD=or instanceof laya.ui.List,on=0,oV=oW.length;on<oV;on++){var oL=oW[on];if(!or.hasOwnProperty("itemRender")||"render"!=oL.props.name&&"render"!==oL.props.renderType)if("Graphic"==oL.type)o_.addGraphicsToSprite(oL,or);else if(o_.isDrawType(oL.type))o_.addGraphicToSprite(oL,or,!0);else{if(oD){var oU=[],oh=ox.createComp(oL,null,oT,oU);oU.length&&(oh._$bindData=oU)}else oh=ox.createComp(oL,null,oT,ok);"Script"==oL.type?"owner"in oh?oh.owner=or:"target"in oh&&(oh.target=or):"mask"==oL.props.renderType||"mask"==oL.props.name?or.mask=oh:oh instanceof laya.display.Sprite&&or.addChild(oh)}else or.itemRender=oL}var op=oo.props;for(var oi in op){var ov=op[oi];ox.eventDic[oi]?ov&&oT&&or.on(oi,oT,oT.onEvent,[ov]):ox.setCompValue(or,oi,ov,oT,ok)}return oj.__typeof(or,"laya.ui.IItem")&&or.initItems(),oo.compId&&oT&&oT._idMap&&(oT._idMap[oo.compId]=or),or},ox.setCompValue=function(oo,or,oT,ok,oW){if("string"==typeof oT&&-1<oT.indexOf("${")){if(ox._sheet||(ox._sheet=o_.getClass("laya.data.Table")),!ox._sheet)return void console.warn("Can not find class Sheet");if(oW)oW.push(oo,or,oT);else if(ok){-1==oT.indexOf("].")&&(oT=oT.replace(".","[0]."));var oD,on,oV=new ov(oo,or,oT);oV.exe(ok);for(var oL=oT.replace(/\[.*?\]\./g,".");null!=(oD=ox._parseWatchData.exec(oL));){for(var oU=oD[1];null!=(on=ox._parseKeyWord.exec(oU));){var oh=on[0],op=ok._watchMap[oh]||(ok._watchMap[oh]=[]);op.push(oV),ox._sheet.I.notifer.on(oh,ok,ok.changeData,[oh])}(op=ok._watchMap[oU]||(ok._watchMap[oU]=[])).push(oV),ox._sheet.I.notifer.on(oU,ok,ok.changeData,[oU])}}}else if("var"===or&&ok)ok[oT]=oo;else if("onClick"==or){var oi=oj._runScript("(function(){"+oT+"})");oo.on("click",ok,oi)}else oo[or]="true"===oT||"false"!==oT&&oT},ox.getCompInstance=function(oo){var or,oT=oo.props?oo.props.runtime:null;return or=oT?ox.viewClassMap[oT]||ox.uiClassMap[oT]||oj.__classmap[oT]:ox.uiClassMap[oo.type],oo.props&&oo.props.hasOwnProperty("renderType")&&"instance"==oo.props.renderType?or.instance:or?new or:null},ox.regComponent=function(oo,or){ox.uiClassMap[oo]=or,o_.regClass(oo,or)},ox.regViewRuntime=function(oo,or){ox.viewClassMap[oo]=or},ox.uiMap={},ox.viewClassMap={},ox._sheet=null,ok(ox,["uiClassMap",function(){return this.uiClassMap={ViewStack:ooo,LinkButton:oX,TextArea:oUo,ColorPicker:oM,Box:oC,Button:oX,CheckBox:of,Clip:oO,ComboBox:oc,Component:oz,HScrollBar:oZ,HSlider:og,Image:oY,Label:oA,List:ow,Panel:oQ,ProgressBar:oI,Radio:oE,RadioGroup:oVo,ScrollBar:oe,Slider:oJ,Tab:oLo,TextInput:oTo,View:ox,VScrollBar:oro,VSlider:oko,Tree:od,HBox:oDo,VBox:ono,Sprite:ol,Animation:oT,Text:oS,FontClip:oG}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),ox.__init$=function(){ox._regs(),ov=function(){function oo(oo,or,oT){this.comp=null,this.prop=null,this.value=null,this.comp=oo,this.prop=or,this.value=oT}return oD(oo,""),oo.prototype.exe=function(oo){var or=oR.getBindFun(this.value);this.comp[this.prop]=or.call(this,oo)},oo}()},ox}()),of=function(oo){function oT(oo,or){void 0===or&&(or=""),oT.__super.call(this,oo,or)}oD(oT,"laya.ui.CheckBox",oo);var or=oT.prototype;return or.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},or.initialize=function(){oo.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},oW(0,or,"dataSource",oo.prototype._$get_dataSource,function(oo){"boolean"==typeof(this._dataSource=oo)?this.selected=oo:"string"==typeof oo?this.selected="true"===oo:oj.superSet(oX,this,"dataSource",oo)}),oT}(oX),oa=function(oo){function or(){this._space=0,this._align="none",this._itemChanged=!1,or.__super.call(this)}oD(or,"laya.ui.LayoutBox",oC);var oT=or.prototype;return oT.addChild=function(oo){return oo.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,oo)},oT.onResize=function(oo){this._setItemChanged()},oT.addChildAt=function(oo,or){return oo.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,oo,or)},oT.removeChild=function(oo){return oo.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,oo)},oT.removeChildAt=function(oo){return this.getChildAt(oo).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,oo)},oT.refresh=function(){this._setItemChanged()},oT.changeItems=function(){this._itemChanged=!1},oT.sortItem=function(oo){oo&&oo.sort(function(oo,or){return oo.y-or.y})},oT._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},oW(0,oT,"space",function(){return this._space},function(oo){this._space=oo,this._setItemChanged()}),oW(0,oT,"align",function(){return this._align},function(oo){this._align=oo,this._setItemChanged()}),or}(),oG=function(or){function oT(oo,or){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,oT.__super.call(this),oo&&(this.skin=oo),or&&(this.sheet=or)}oD(oT,"laya.ui.FontClip",or);var oo=oT.prototype;return oo.createChildren=function(){this._bitmap=new os,this.on("loaded",this,this._onClipLoaded)},oo._onClipLoaded=function(){this.callLater(this.changeValue)},oo.changeValue=function(){var oo;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),oo=this._sources[0]))){var or="horizontal"===this._direction;or?(this._wordsW=this._valueArr.length*(oo.sourceWidth+this.spaceX),this._wordsH=oo.sourceHeight):(this._wordsW=oo.sourceWidth,this._wordsH=(oo.sourceHeight+this.spaceY)*this._valueArr.length);var oT=0;if(this._width)switch(this._align){case"center":oT=.5*(this._width-this._wordsW);break;case"right":oT=this._width-this._wordsW;break;default:oT=0}for(var ok=0,oW=this._valueArr.length;ok<oW;ok++){var oD=this._indexMap[this._valueArr.charAt(ok)];this.sources[oD]&&(oo=this.sources[oD],or?this.graphics.drawTexture(oo,oT+ok*(oo.sourceWidth+this.spaceX),0,oo.sourceWidth,oo.sourceHeight):this.graphics.drawTexture(oo,0+oT,ok*(oo.sourceHeight+this.spaceY),oo.sourceWidth,oo.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},oo.destroy=function(oo){void 0===oo&&(oo=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),or.prototype.destroy.call(this,oo)},oW(0,oo,"sheet",function(){return this._sheet},function(oo){oo+="";var or=(this._sheet=oo).split(" ");this._clipX=String(or[0]).length,this.clipY=or.length,this._indexMap={};for(var oT=0;oT<this._clipY;oT++)for(var ok=or[oT].split(""),oW=0,oD=ok.length;oW<oD;oW++)this._indexMap[ok[oW]]=oT*this._clipX+oW}),oW(0,oo,"height",or.prototype._$get_height,function(oo){oj.superSet(oO,this,"height",oo),this.callLater(this.changeValue)}),oW(0,oo,"direction",function(){return this._direction},function(oo){this._direction=oo,this.callLater(this.changeValue)}),oW(0,oo,"value",function(){return this._valueArr?this._valueArr:""},function(oo){oo+="",this._valueArr=oo,this.callLater(this.changeValue)}),oW(0,oo,"width",or.prototype._$get_width,function(oo){oj.superSet(oO,this,"width",oo),this.callLater(this.changeValue)}),oW(0,oo,"spaceX",function(){return this._spaceX},function(oo){this._spaceX=oo,"horizontal"===this._direction&&this.callLater(this.changeValue)}),oW(0,oo,"spaceY",function(){return this._spaceY},function(oo){this._spaceY=oo,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),oW(0,oo,"align",function(){return this._align},function(oo){this._align=oo,this.callLater(this.changeValue)}),oW(0,oo,"measureWidth",function(){return this._wordsW}),oW(0,oo,"measureHeight",function(){return this._wordsH}),oT}(oO),ow=function(oo){function or(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new ox,or.__super.call(this)}oD(or,"laya.ui.List",oo);var oT=or.prototype;return oj.imps(oT,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),oT.destroy=function(oo){void 0===oo&&(oo=!0),this._content&&this._content.destroy(oo),this._scrollBar&&this._scrollBar.destroy(oo),laya.ui.Component.prototype.destroy.call(this,oo),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},oT.createChildren=function(){this.addChild(this._content=new oC)},oT.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=oj.superGet(oC,this,"cacheAs")),oj.superSet(oC,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},oT.onScrollEnd=function(){oj.superSet(oC,this,"cacheAs",this._$P.cacheAs)},oT._removePreScrollBar=function(){var oo=this.removeChildByName("scrollBar");oo&&oo.destroy(!0)},oT.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var oo=this._getOneCell(),or=oo.width+this._spaceX||1,oT=oo.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/or):Math.ceil(this._width/or)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/oT):Math.round(this._height/oT));var ok=this._width?this._width:or*this.repeatX-this._spaceX,oW=this._height?this._height:oT*this.repeatY-this._spaceY;this._cellSize=this._isVertical?oT:or,this._cellOffset=this._isVertical?oT*Math.max(this._repeatY2,this._repeatY)-oW-this._spaceY:or*Math.max(this._repeatX2,this._repeatX)-ok-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=oW:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=ok),this.setContentSize(ok,oW);var oD=this._isVertical?this.repeatX:this.repeatY,on=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,oD,on),this._createdLine=on,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},oT._getOneCell=function(){if(0===this._cells.length){var oo=this.createItem();if(this._offset.setTo(oo.x,oo.y),this.cacheContent)return oo;this._cells.push(oo)}return this._cells[0]},oT._createItems=function(oo,or,oT){var ok=this._content,oW=this._getOneCell(),oD=oW.width+this._spaceX,on=oW.height+this._spaceY;if(this.cacheContent){var oV=new oC;oV.cacheAsBitmap=!0,oV.pos((this._isVertical?0:oo)*oD,(this._isVertical?oo:0)*on),this._content.addChild(oV),this._content.optimizeScrollRect=!0,ok=oV}else{for(var oL=[],oU=this._cells.length-1;-1<oU;oU--){var oh=this._cells[oU];oh.removeSelf(),oL.push(oh)}this._cells.length=0}for(var op=oo;op<oT;op++)for(var oi=0;oi<or;oi++)(oW=oL&&oL.length?oL.pop():this.createItem()).x=(this._isVertical?oi:op)*oD-ok.x,oW.y=(this._isVertical?op:oi)*on-ok.y,oW.name="item"+(op*or+oi),ok.addChild(oW),this.addCell(oW)},oT.createItem=function(){var oo=[];if("function"==typeof this._itemRender)var or=new this._itemRender;else or=oN.createComp(this._itemRender,null,null,oo);if(0==oo.length&&or._watchMap){var oT=or._watchMap;for(var ok in oT)for(var oW=oT[ok],oD=0;oD<oW.length;oD++){var on=oW[oD];oo.push(on.comp,on.prop,on.value)}}return oo.length&&(or._$bindData=oo),or},oT.addCell=function(oo){oo.on("click",this,this.onCellMouse),oo.on("rightclick",this,this.onCellMouse),oo.on("mouseover",this,this.onCellMouse),oo.on("mouseout",this,this.onCellMouse),oo.on("mousedown",this,this.onCellMouse),oo.on("mouseup",this,this.onCellMouse),this._cells.push(oo)},oT.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var oo=0,or=oo=0;or<1e4;or++){var oT=this.getChildByName("item"+or);if(!oT)break;this.addCell(oT),oo++}this.repeatY=oo}},oT.setContentSize=function(oo,or){this._content.width=oo,this._content.height=or,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new oK),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,oo,or),this._content.scrollRect=this._content.scrollRect),this.event("resize")},oT.onCellMouse=function(oo){"mousedown"===oo.type&&(this._isMoved=!1);var or=oo.currentTarget,oT=this._startIndex+this._cells.indexOf(or);oT<0||("click"===oo.type||"rightclick"===oo.type?this.selectEnable&&!this._isMoved?this.selectedIndex=oT:this.changeCellState(or,!0,0):"mouseover"!==oo.type&&"mouseout"!==oo.type||this._selectedIndex===oT||this.changeCellState(or,"mouseover"===oo.type,0),this.mouseHandler&&this.mouseHandler.runWith([oo,oT]))},oT.changeCellState=function(oo,or,oT){var ok=oo.getChildByName("selectBox");ok&&(this.selectEnable=!0,ok.visible=or,ok.index=oT)},oT.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},oT.onScrollBarChange=function(oo){this.runCallLater(this.changeCells);var or=this._scrollBar.value,oT=this._isVertical?this.repeatX:this.repeatY,ok=this._isVertical?this.repeatY:this.repeatX,oW=Math.floor(or/this._cellSize);if(this.cacheContent)on=ok+1,this._createdLine-oW<on&&(this._createItems(this._createdLine,oT,this._createdLine+on),this.renderItems(this._createdLine*oT,0),this._createdLine+=on);else{var oD=oW*oT,on=0;if(oD>this._startIndex){on=oD-this._startIndex;var oV=!0,oL=this._startIndex+oT*(ok+1);this._isMoved=!0}else oD<this._startIndex&&(on=this._startIndex-oD,oV=!1,oL=this._startIndex-1,this._isMoved=!0);for(var oU=0;oU<on;oU++){if(oV){var oh=this._cells.shift();this._cells[this._cells.length]=oh;var op=oL+oU}else oh=this._cells.pop(),this._cells.unshift(oh),op=oL-oU;var oi=Math.floor(op/oT)*this._cellSize;this._isVertical?oh.y=oi:oh.x=oi,this.renderItem(oh,op)}this._startIndex=oD,this.changeSelectStatus()}var ov=this._content.scrollRect;this._isVertical?(ov.y=or-this._offset.y,ov.x=-this._offset.x):(ov.y=-this._offset.y,ov.x=or-this._offset.x),this._content.scrollRect=ov},oT.posCell=function(oo,or){if(this._scrollBar){var oT=this._isVertical?this.repeatX:this.repeatY,ok=(this._isVertical?this.repeatY:this.repeatX,Math.floor(or/oT)*this._cellSize);this._isVertical?oo.y=ok:oo.x=ok}},oT.changeSelectStatus=function(){for(var oo=0,or=this._cells.length;oo<or;oo++)this.changeCellState(this._cells[oo],this._selectedIndex===this._startIndex+oo,1)},oT.renderItems=function(oo,or){void 0===oo&&(oo=0),void 0===or&&(or=0);for(var oT=oo,ok=or||this._cells.length;oT<ok;oT++)this.renderItem(this._cells[oT],this._startIndex+oT);this.changeSelectStatus()},oT.renderItem=function(oo,or){this._array&&0<=or&&or<this._array.length?(oo.visible=!0,oo._$bindData?(oo._dataSource=this._array[or],this._bindData(oo,this._array[or])):oo.dataSource=this._array[or],this.cacheContent||this.posCell(oo,or),this.hasListener("render")&&this.event("render",[oo,or]),this.renderHandler&&this.renderHandler.runWith([oo,or])):(oo.visible=!1,oo.dataSource=null)},oT._bindData=function(oo,or){for(var oT=oo._$bindData,ok=0,oW=oT.length;ok<oW;ok++){var oD=oT[ok++],on=oT[ok++],oV=oT[ok],oL=oR.getBindFun(oV);oD[on]=oL.call(this,or)}},oT.refresh=function(){this.array=this._array},oT.getItem=function(oo){return-1<oo&&oo<this._array.length?this._array[oo]:null},oT.changeItem=function(oo,or){-1<oo&&oo<this._array.length&&(this._array[oo]=or,oo>=this._startIndex&&oo<this._startIndex+this._cells.length&&this.renderItem(this.getCell(oo),oo))},oT.setItem=function(oo,or){this.changeItem(oo,or)},oT.addItem=function(oo){this._array.push(oo),this.array=this._array},oT.addItemAt=function(oo,or){this._array.splice(or,0,oo),this.array=this._array},oT.deleteItem=function(oo){this._array.splice(oo,1),this.array=this._array},oT.getCell=function(oo){return this.runCallLater(this.changeCells),-1<oo&&this._cells?this._cells[(oo-this._startIndex)%this._cells.length]:null},oT.scrollTo=function(oo){if(this._scrollBar){var or=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(oo/or)*this._cellSize}else this.startIndex=oo},oT.tweenTo=function(oo,or,oT){if(void 0===or&&(or=200),this._scrollBar){var ok=this._isVertical?this.repeatX:this.repeatY;ob.to(this._scrollBar,{value:Math.floor(oo/ok)*this._cellSize},or,null,oT,0,!0)}else this.startIndex=oo,oT&&oT.run()},oT._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},oT.commitMeasure=function(){this.runCallLater(this.changeCells)},oW(0,oT,"cacheAs",oo.prototype._$get_cacheAs,function(oo){oj.superSet(oC,this,"cacheAs",oo),this._scrollBar&&(this._$P.cacheAs=null,"none"!==oo?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),oW(0,oT,"content",function(){return this._content}),oW(0,oT,"height",oo.prototype._$get_height,function(oo){oo!=this._height&&(oj.superSet(oC,this,"height",oo),this._setCellChanged())}),oW(0,oT,"itemRender",function(){return this._itemRender},function(oo){if(this._itemRender!=oo){this._itemRender=oo;for(var or=this._cells.length-1;-1<or;or--)this._cells[or].destroy();this._cells.length=0,this._setCellChanged()}}),oW(0,oT,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(oo){this._removePreScrollBar();var or=new oro;or.name="scrollBar",or.right=0,oo&&" "!=oo&&(or.skin=oo),this.scrollBar=or,this.addChild(or),this._setCellChanged()}),oW(0,oT,"page",function(){return this._page},function(oo){this._page=oo,this._array&&(this._page=0<oo?oo:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),oW(0,oT,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(oo){this._removePreScrollBar();var or=new oZ;or.name="scrollBar",or.bottom=0,oo&&" "!=oo&&(or.skin=oo),this.scrollBar=or,this.addChild(or),this._setCellChanged()}),oW(0,oT,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(oo){this._repeatX=oo,this._setCellChanged()}),oW(0,oT,"scrollBar",function(){return this._scrollBar},function(oo){this._scrollBar!=oo&&(this._scrollBar=oo)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),oW(0,oT,"width",oo.prototype._$get_width,function(oo){oo!=this._width&&(oj.superSet(oC,this,"width",oo),this._setCellChanged())}),oW(0,oT,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(oo){this._repeatY=oo,this._setCellChanged()}),oW(0,oT,"spaceX",function(){return this._spaceX},function(oo){this._spaceX=oo,this._setCellChanged()}),oW(0,oT,"spaceY",function(){return this._spaceY},function(oo){this._spaceY=oo,this._setCellChanged()}),oW(0,oT,"selectedIndex",function(){return this._selectedIndex},function(oo){this._selectedIndex!=oo&&(this._selectedIndex=oo,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(oo),this.startIndex=this._startIndex)}),oW(0,oT,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(oo){this.selectedIndex=this._array.indexOf(oo)}),oW(0,oT,"length",function(){return this._array?this._array.length:0}),oW(0,oT,"selection",function(){return this.getCell(this._selectedIndex)},function(oo){this.selectedIndex=this._startIndex+this._cells.indexOf(oo)}),oW(0,oT,"startIndex",function(){return this._startIndex},function(oo){this._startIndex=0<oo?oo:0,this.callLater(this.renderItems)}),oW(0,oT,"array",function(){return this._array},function(oo){this.runCallLater(this.changeCells),this._array=oo||[];var or=this._array.length;if(this.totalPage=Math.ceil(or/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<or?this._selectedIndex:or-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var oT=this._isVertical?this.repeatX:this.repeatY,ok=this._isVertical?this.repeatY:this.repeatX,oW=Math.ceil(or/oT);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=ok/oW,this._scrollBar.setScroll(0,(oW-ok)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),oW(0,oT,"dataSource",oo.prototype._$get_dataSource,function(oo){"number"==typeof(this._dataSource=oo)&&Math.floor(oo)==oo||"string"==typeof oo?this.selectedIndex=parseInt(oo):oo instanceof Array?this.array=oo:oj.superSet(oC,this,"dataSource",oo)}),oW(0,oT,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),or}(oC),oZ=function(oo){function or(){or.__super.call(this)}return oD(or,"laya.ui.HScrollBar",oo),or.prototype.initialize=function(){oo.prototype.initialize.call(this),this.slider.isVertical=!1},or}(oe),oQ=function(oo){function or(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,or.__super.call(this),this.width=this.height=100}oD(or,"laya.ui.Panel",oo);var oT=or.prototype;return oT.destroy=function(oo){void 0===oo&&(oo=!0),laya.ui.Component.prototype.destroy.call(this,oo),this._content&&this._content.destroy(oo),this._vScrollBar&&this._vScrollBar.destroy(oo),this._hScrollBar&&this._hScrollBar.destroy(oo),this._vScrollBar=null,this._hScrollBar=null,this._content=null},oT.destroyChildren=function(){this._content.destroyChildren()},oT.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new oC)},oT.addChild=function(oo){return oo.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(oo)},oT.onResize=function(){this._setScrollChanged()},oT.addChildAt=function(oo,or){return oo.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(oo,or)},oT.removeChild=function(oo){return oo.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(oo)},oT.removeChildAt=function(oo){return this.getChildAt(oo).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(oo)},oT.removeChildren=function(oo,or){return void 0===oo&&(oo=0),void 0===or&&(or=2147483647),this._content.removeChildren(oo,or),this._setScrollChanged(),this},oT.getChildAt=function(oo){return this._content.getChildAt(oo)},oT.getChildByName=function(oo){return this._content.getChildByName(oo)},oT.getChildIndex=function(oo){return this._content.getChildIndex(oo)},oT.changeScroll=function(){this._scrollChanged=!1;var oo=this.contentWidth||1,or=this.contentHeight||1,oT=this._vScrollBar,ok=this._hScrollBar,oW=oT&&or>this._height,oD=ok&&oo>this._width,on=oW?this._width-oT.width:this._width,oV=oD?this._height-ok.height:this._height;oT&&(oT.x=this._width-oT.width,oT.y=0,oT.height=this._height-(oD?ok.height:0),oT.scrollSize=Math.max(.033*this._height,1),oT.thumbPercent=oV/or,oT.setScroll(0,or-oV,oT.value)),ok&&(ok.x=0,ok.y=this._height-ok.height,ok.width=this._width-(oW?oT.width:0),ok.scrollSize=Math.max(.033*this._width,1),ok.thumbPercent=on/oo,ok.setScroll(0,oo-on,ok.value))},oT.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},oT.setContentSize=function(oo,or){var oT=this._content;oT.width=oo,oT.height=or,oT.scrollRect||(oT.scrollRect=new oK),oT.scrollRect.setTo(0,0,oo,or),oT.scrollRect=oT.scrollRect},oT.onScrollBarChange=function(oo){var or=this._content.scrollRect;if(or){var oT=Math.round(oo.value);oo.isVertical?or.y=oT:or.x=oT,this._content.scrollRect=or}},oT.scrollTo=function(oo,or){void 0===oo&&(oo=0),void 0===or&&(or=0),this.vScrollBar&&(this.vScrollBar.value=or),this.hScrollBar&&(this.hScrollBar.value=oo)},oT.refresh=function(){this.changeScroll()},oT.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=oj.superGet(oC,this,"cacheAs")),oj.superSet(oC,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},oT.onScrollEnd=function(){oj.superSet(oC,this,"cacheAs",this._$P.cacheAs)},oT._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},oW(0,oT,"numChildren",function(){return this._content.numChildren}),oW(0,oT,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(oo){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new oZ),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=oo}),oW(0,oT,"contentWidth",function(){for(var oo=0,or=this._content.numChildren-1;-1<or;or--){var oT=this._content.getChildAt(or);oo=Math.max(oT.x+oT.width*oT.scaleX,oo)}return oo}),oW(0,oT,"contentHeight",function(){for(var oo=0,or=this._content.numChildren-1;-1<or;or--){var oT=this._content.getChildAt(or);oo=Math.max(oT.y+oT.height*oT.scaleY,oo)}return oo}),oW(0,oT,"width",oo.prototype._$get_width,function(oo){oj.superSet(oC,this,"width",oo),this._setScrollChanged()}),oW(0,oT,"hScrollBar",function(){return this._hScrollBar}),oW(0,oT,"content",function(){return this._content}),oW(0,oT,"height",oo.prototype._$get_height,function(oo){oj.superSet(oC,this,"height",oo),this._setScrollChanged()}),oW(0,oT,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(oo){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new oro),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=oo}),oW(0,oT,"vScrollBar",function(){return this._vScrollBar}),oW(0,oT,"cacheAs",oo.prototype._$get_cacheAs,function(oo){oj.superSet(oC,this,"cacheAs",oo),this._$P.cacheAs=null,"none"!==oo?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),or}(oC),og=function(oo){function or(oo){or.__super.call(this,oo),this.isVertical=!1}return oD(or,"laya.ui.HSlider",oJ),or}(),oB=function(oo){function oT(oo,or){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,oT.__super.call(this),this.skin=or,this.labels=oo}oD(oT,"laya.ui.UIGroup",oo);var or=oT.prototype;return oj.imps(or,{"laya.ui.IItem":!0}),or.preinitialize=function(){this.mouseEnabled=!0},or.destroy=function(oo){void 0===oo&&(oo=!0),laya.ui.Component.prototype.destroy.call(this,oo),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},or.addItem=function(oo,or){void 0===or&&(or=!0);var oT=oo,ok=this._items.length;if(oT.name="item"+ok,this.addChild(oT),this.initItems(),or&&0<ok){var oW=this._items[ok-1];"horizontal"==this._direction?oT.x=oW.x+oW.width+this._space:oT.y=oW.y+oW.height+this._space}else or&&(oT.x=0,oT.y=0);return ok},or.delItem=function(oo,or){void 0===or&&(or=!0);var oT=this._items.indexOf(oo);if(-1!=oT){var ok=oo;this.removeChild(ok);for(var oW=oT+1,oD=this._items.length;oW<oD;oW++){var on=this._items[oW];on.name="item"+(oW-1),or&&("horizontal"==this._direction?on.x-=ok.width+this._space:on.y-=ok.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var oV;oV=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=oV}}},or.initItems=function(){this._items||(this._items=[]);for(var oo=this._items.length=0;oo<1e4;oo++){var or=this.getChildByName("item"+oo);if(null==or)break;this._items.push(or),or.selected=oo===this._selectedIndex,or.clickHandler=oi.create(this,this.itemClick,[oo],!1)}},or.itemClick=function(oo){this.selectedIndex=oo},or.setSelect=function(oo,or){this._items&&-1<oo&&oo<this._items.length&&(this._items[oo].selected=or)},or.createItem=function(oo,or){return null},or.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var oo=0,or=0,oT=this._items.length;or<oT;or++){var ok=this._items[or];this._skin&&(ok.skin=this._skin),this._labelColors&&(ok.labelColors=this._labelColors),this._labelSize&&(ok.labelSize=this._labelSize),this._labelStroke&&(ok.labelStroke=this._labelStroke),this._labelStrokeColor&&(ok.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(ok.strokeColors=this._strokeColors),this._labelBold&&(ok.labelBold=this._labelBold),this._labelPadding&&(ok.labelPadding=this._labelPadding),this._labelAlign&&(ok.labelAlign=this._labelAlign),this._stateNum&&(ok.stateNum=this._stateNum),this._labelFont&&(ok.labelFont=this._labelFont),"horizontal"===this._direction?(ok.y=0,ok.x=oo,oo+=ok.width+this._space):(ok.x=0,ok.y=oo,oo+=ok.height+this._space)}this.changeSize()},or.commitMeasure=function(){this.runCallLater(this.changeLabels)},or._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},oW(0,or,"labelStrokeColor",function(){return this._labelStrokeColor},function(oo){this._labelStrokeColor!=oo&&(this._labelStrokeColor=oo,this._setLabelChanged())}),oW(0,or,"skin",function(){return this._skin},function(oo){this._skin!=oo&&(this._skin=oo,this._setLabelChanged())}),oW(0,or,"selectedIndex",function(){return this._selectedIndex},function(oo){this._selectedIndex!=oo&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=oo,this.setSelect(oo,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),oW(0,or,"labels",function(){return this._labels},function(oo){if(this._labels!=oo){if(this._labels=oo,this.removeChildren(),this._setLabelChanged(),this._labels)for(var or=this._labels.split(","),oT=0,ok=or.length;oT<ok;oT++){var oW=this.createItem(this._skin,or[oT]);oW.name="item"+oT,this.addChild(oW)}this.initItems()}}),oW(0,or,"strokeColors",function(){return this._strokeColors},function(oo){this._strokeColors!=oo&&(this._strokeColors=oo,this._setLabelChanged())}),oW(0,or,"labelColors",function(){return this._labelColors},function(oo){this._labelColors!=oo&&(this._labelColors=oo,this._setLabelChanged())}),oW(0,or,"labelStroke",function(){return this._labelStroke},function(oo){this._labelStroke!=oo&&(this._labelStroke=oo,this._setLabelChanged())}),oW(0,or,"labelSize",function(){return this._labelSize},function(oo){this._labelSize!=oo&&(this._labelSize=oo,this._setLabelChanged())}),oW(0,or,"stateNum",function(){return this._stateNum},function(oo){this._stateNum!=oo&&(this._stateNum=oo,this._setLabelChanged())}),oW(0,or,"labelBold",function(){return this._labelBold},function(oo){this._labelBold!=oo&&(this._labelBold=oo,this._setLabelChanged())}),oW(0,or,"labelFont",function(){return this._labelFont},function(oo){this._labelFont!=oo&&(this._labelFont=oo,this._setLabelChanged())}),oW(0,or,"labelPadding",function(){return this._labelPadding},function(oo){this._labelPadding!=oo&&(this._labelPadding=oo,this._setLabelChanged())}),oW(0,or,"direction",function(){return this._direction},function(oo){this._direction=oo,this._setLabelChanged()}),oW(0,or,"space",function(){return this._space},function(oo){this._space=oo,this._setLabelChanged()}),oW(0,or,"items",function(){return this._items}),oW(0,or,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(oo){this.selectedIndex=this._items.indexOf(oo)}),oW(0,or,"dataSource",oo.prototype._$get_dataSource,function(oo){"number"==typeof(this._dataSource=oo)&&Math.floor(oo)==oo||"string"==typeof oo?this.selectedIndex=parseInt(oo):oo instanceof Array?this.labels=oo.join(","):oj.superSet(oC,this,"dataSource",oo)}),oT}(oC),oE=function(or){function oT(oo,or){this._value=null,void 0===or&&(or=""),oT.__super.call(this,oo,or)}oD(oT,"laya.ui.Radio",or);var oo=oT.prototype;return oo.destroy=function(oo){void 0===oo&&(oo=!0),or.prototype.destroy.call(this,oo),this._value=null},oo.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},oo.initialize=function(){or.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},oo.onClick=function(oo){this.selected=!0},oW(0,oo,"value",function(){return null!=this._value?this._value:this.label},function(oo){this._value=oo}),oT}(oX),od=function(oo){function or(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,or.__super.call(this),this.width=this.height=200}oD(or,"laya.ui.Tree",oo);var oT=or.prototype;return oj.imps(oT,{"laya.ui.IRender":!0}),oT.destroy=function(oo){void 0===oo&&(oo=!0),laya.ui.Component.prototype.destroy.call(this,oo),this._list&&this._list.destroy(oo),this._list=null,this._source=null,this._renderHandler=null},oT.createChildren=function(){this.addChild(this._list=new ow),this._list.renderHandler=oi.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},oT.onListChange=function(oo){this.event("change")},oT.getArray=function(){var oo,or=[];for(var oT in this._source)oo=this._source[oT],this.getParentOpenStatus(oo)&&(oo.x=this._spaceLeft*this.getDepth(oo),or.push(oo));return or},oT.getDepth=function(oo,or){return void 0===or&&(or=0),null==oo.nodeParent?or:this.getDepth(oo.nodeParent,or+1)},oT.getParentOpenStatus=function(oo){var or=oo.nodeParent;return null==or||!!or.isOpen&&(null==or.nodeParent||this.getParentOpenStatus(or))},oT.renderItem=function(oo,or){var oT=oo.dataSource;if(oT){oo.left=oT.x;var ok=oo.getChildByName("arrow");ok&&(oT.hasChild?(ok.visible=!0,ok.index=oT.isOpen?1:0,ok.tag=or,ok.off("click",this,this.onArrowClick),ok.on("click",this,this.onArrowClick)):ok.visible=!1);var oW=oo.getChildByName("folder");oW&&(2==oW.clipY?oW.index=oT.isDirectory?0:1:oW.index=oT.isDirectory?oT.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([oo,or])}},oT.onArrowClick=function(oo){var or=oo.currentTarget.tag;this._list.array[or].isOpen=!this._list.array[or].isOpen,this.event("open"),this._list.array=this.getArray()},oT.setItemState=function(oo,or){this._list.array[oo]&&(this._list.array[oo].isOpen=or,this._list.array=this.getArray())},oT.fresh=function(){this._list.array=this.getArray(),this.repaint()},oT.parseXml=function(oo,or,oT,ok){var oW,oD=oo.childNodes,on=oD.length;if(!ok){oW={};var oV,oL=oo.attributes;for(var oU in oL){var oh=(oV=oL[oU]).nodeName,op=oV.nodeValue;oW[oh]="true"==op||"false"!=op&&op}oW.nodeParent=oT,0<on&&(oW.isDirectory=!0),oW.hasChild=0<on,or.push(oW)}for(var oi=0;oi<on;oi++){var ov=oD[oi];this.parseXml(ov,or,oW,!1)}},oT.parseOpenStatus=function(oo,or){for(var oT=0,ok=or.length;oT<ok;oT++){var oW=or[oT];if(oW.isDirectory)for(var oD=0,on=oo.length;oD<on;oD++){var oV=oo[oD];if(oV.isDirectory&&this.isSameParent(oV,oW)&&oW.label==oV.label){oW.isOpen=oV.isOpen;break}}}},oT.isSameParent=function(oo,or){return null==oo.nodeParent&&null==or.nodeParent||null!=oo.nodeParent&&null!=or.nodeParent&&(oo.nodeParent.label==or.nodeParent.label&&this.isSameParent(oo.nodeParent,or.nodeParent))},oT.filter=function(oo){if(Boolean(oo)){var or=[];this.getFilterSource(this._source,or,oo),this._list.array=or}else this._list.array=this.getArray()},oT.getFilterSource=function(oo,or,oT){var ok;for(var oW in oT=oT.toLocaleLowerCase(),oo)!(ok=oo[oW]).isDirectory&&-1<String(ok.label).toLowerCase().indexOf(oT)&&(ok.x=0,or.push(ok)),ok.child&&0<ok.child.length&&this.getFilterSource(ok.child,or,oT)},oW(0,oT,"spaceBottom",function(){return this._list.spaceY},function(oo){this._list.spaceY=oo}),oW(0,oT,"keepStatus",function(){return this._keepStatus},function(oo){this._keepStatus=oo}),oW(0,oT,"itemRender",function(){return this._list.itemRender},function(oo){this._list.itemRender=oo}),oW(0,oT,"array",function(){return this._list.array},function(oo){this._keepStatus&&this._list.array&&oo&&this.parseOpenStatus(this._list.array,oo),this._source=oo,this._list.array=this.getArray()}),oW(0,oT,"mouseHandler",function(){return this._list.mouseHandler},function(oo){this._list.mouseHandler=oo}),oW(0,oT,"dataSource",oo.prototype._$get_dataSource,function(oo){this._dataSource=oo,oj.superSet(oC,this,"dataSource",oo)}),oW(0,oT,"source",function(){return this._source}),oW(0,oT,"scrollBar",function(){return this._list.scrollBar}),oW(0,oT,"list",function(){return this._list}),oW(0,oT,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(oo){this._list.vScrollBarSkin=oo}),oW(0,oT,"renderHandler",function(){return this._renderHandler},function(oo){this._renderHandler=oo}),oW(0,oT,"selectedIndex",function(){return this._list.selectedIndex},function(oo){this._list.selectedIndex=oo}),oW(0,oT,"spaceLeft",function(){return this._spaceLeft},function(oo){this._spaceLeft=oo}),oW(0,oT,"selectedItem",function(){return this._list.selectedItem},function(oo){this._list.selectedItem=oo}),oW(0,oT,"width",oo.prototype._$get_width,function(oo){oj.superSet(oC,this,"width",oo),this._list.width=oo}),oW(0,oT,"height",oo.prototype._$get_height,function(oo){oj.superSet(oC,this,"height",oo),this._list.height=oo}),oW(0,oT,"xml",null,function(oo){var or=[];this.parseXml(oo.childNodes[0],or,null,!0),this.array=or}),oW(0,oT,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),or}(oC),ooo=function(oo){function or(){this._items=null,this._selectedIndex=0,or.__super.call(this),this._setIndexHandler=oi.create(this,this.setIndex,null,!1)}oD(or,"laya.ui.ViewStack",oo);var oT=or.prototype;return oj.imps(oT,{"laya.ui.IItem":!0}),oT.setItems=function(oo){this.removeChildren();for(var or=0,oT=0,ok=oo.length;oT<ok;oT++){var oW=oo[oT];oW&&(oW.name="item"+or,this.addChild(oW),or++)}this.initItems()},oT.addItem=function(oo){oo.name="item"+this._items.length,this.addChild(oo),this.initItems()},oT.initItems=function(){this._items=[];for(var oo=0;oo<1e4;oo++){var or=this.getChildByName("item"+oo);if(null==or)break;this._items.push(or),or.visible=oo==this._selectedIndex}},oT.setSelect=function(oo,or){this._items&&-1<oo&&oo<this._items.length&&(this._items[oo].visible=or)},oT.setIndex=function(oo){this.selectedIndex=oo},oW(0,oT,"dataSource",oo.prototype._$get_dataSource,function(oo){if("number"==typeof(this._dataSource=oo)&&Math.floor(oo)==oo||"string"==typeof oo)this.selectedIndex=parseInt(oo);else for(var or in this._dataSource)this.hasOwnProperty(or)&&(this[or]=this._dataSource[or])}),oW(0,oT,"selectedIndex",function(){return this._selectedIndex},function(oo){this._selectedIndex!=oo&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=oo,this.setSelect(this._selectedIndex,!0))}),oW(0,oT,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(oo){this.selectedIndex=this._items.indexOf(oo)}),oW(0,oT,"items",function(){return this._items}),oW(0,oT,"setIndexHandler",function(){return this._setIndexHandler},function(oo){this._setIndexHandler=oo}),or}(oC),oro=function(oo){function or(){or.__super.call(this)}return oD(or,"laya.ui.VScrollBar",oe),or}(),oTo=function(or){function oT(oo){this._bg=null,this._skin=null,oT.__super.call(this),void 0===oo&&(oo=""),this.text=oo,this.skin=this.skin}oD(oT,"laya.ui.TextInput",or);var oo=oT.prototype;return oo.preinitialize=function(){this.mouseEnabled=!0},oo.destroy=function(oo){o$.clearCache(this,this._skin),void 0===oo&&(oo=!0),or.prototype.destroy.call(this,oo),this._bg&&this._bg.destroy(),this._bg=null},oo.createChildren=function(){this.addChild(this._tf=new ov),this._tf.padding=oH.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},oo._onFocus=function(){this.event("focus",this)},oo._onBlur=function(){this.event("blur",this)},oo._onInput=function(){this.event("input",this)},oo._onEnter=function(){this.event("enter",this)},oo.initialize=function(){this.width=128,this.height=22},oo.select=function(){this._tf.select()},oo.setSelection=function(oo,or){this._tf.setSelection(oo,or)},oW(0,oo,"text",or.prototype._$get_text,function(oo){this._tf.text!=oo&&(oo+="",this._tf.text=oo,this.event("change"))}),oW(0,oo,"bg",function(){return this._bg},function(oo){this.graphics=this._bg=oo}),oW(0,oo,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(oo){this._tf.inputElementYAdjuster=oo}),oW(0,oo,"multiline",function(){return this._tf.multiline},function(oo){this._tf.multiline=oo}),oW(0,oo,"skin",function(){return this._skin},function(oo){this._skin!=oo&&(o$.clearCache(this,this._skin),this._skin=oo,this._bg||(this.graphics=this._bg=new os),o$.keepCache(this,this._skin),this._bg.source=o$.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),oW(0,oo,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(oo){this._bg||(this.graphics=this._bg=new os),this._bg.sizeGrid=oR.fillArray(oH.defaultSizeGrid,oo,Number)}),oW(0,oo,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(oo){this._tf.inputElementXAdjuster=oo}),oW(0,oo,"width",or.prototype._$get_width,function(oo){oj.superSet(oA,this,"width",oo),this._bg&&(this._bg.width=oo)}),oW(0,oo,"height",or.prototype._$get_height,function(oo){oj.superSet(oA,this,"height",oo),this._bg&&(this._bg.height=oo)}),oW(0,oo,"editable",function(){return this._tf.editable},function(oo){this._tf.editable=oo}),oW(0,oo,"restrict",function(){return this._tf.restrict},function(oo){this._tf.restrict=oo}),oW(0,oo,"prompt",function(){return this._tf.prompt},function(oo){this._tf.prompt=oo}),oW(0,oo,"promptColor",function(){return this._tf.promptColor},function(oo){this._tf.promptColor=oo}),oW(0,oo,"maxChars",function(){return this._tf.maxChars},function(oo){this._tf.maxChars=oo}),oW(0,oo,"focus",function(){return this._tf.focus},function(oo){this._tf.focus=oo}),oW(0,oo,"type",function(){return this._tf.type},function(oo){this._tf.type=oo}),oW(0,oo,"asPassword",function(){return this._tf.asPassword},function(oo){this._tf.asPassword=oo}),oT}(oA),oko=function(oo){function or(){or.__super.call(this)}return oD(or,"laya.ui.VSlider",oJ),or}(),oWo=function(oo){function ok(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,ok.__super.call(this)}oD(ok,"laya.ui.Dialog",oo);var or=ok.prototype;return or.initialize=function(){this.popupEffect=ok.manager.popupEffectHandler,this.closeEffect=ok.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},or._dealDragArea=function(){var oo=this.getChildByName("drag");oo&&(this.dragArea=oo.x+","+oo.y+","+oo.width+","+oo.height,oo.removeSelf())},or._onClick=function(oo){var or=oo.target;if(or)switch(or.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(or.name)}},or.show=function(oo,or){void 0===oo&&(oo=!1),void 0===or&&(or=!0),this._open(!1,oo,or)},or.popup=function(oo,or){void 0===oo&&(oo=!1),void 0===or&&(or=!0),this._open(!0,oo,or)},or._open=function(oo,or,oT){ok.manager.lock(!1),this.isModal=oo,ok.manager.open(this,or,oT)},or.onOpened=function(){},or.close=function(oo,or){void 0===or&&(or=!0),ok.manager.close(this,oo,or)},or.onClosed=function(oo){},or._onMouseDown=function(oo){var or=this.getMousePoint();this._dragArea.contains(or.x,or.y)?this.startDrag():this.stopDrag()},oW(0,or,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(oo){if(oo){var or=oR.fillArray([0,0,0,0],oo,Number);this._dragArea=new oK(or[0],or[1],or[2],or[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),oW(0,or,"isPopup",function(){return null!=this.parent}),oW(0,or,"zOrder",oo.prototype._$get_zOrder,function(oo){oj.superSet(oN,this,"zOrder",oo),ok.manager._checkMask()}),oW(1,ok,"manager",function(){return ok._manager=ok._manager||new om},function(oo){ok._manager=oo}),ok.setLockView=function(oo){ok.manager.setLockView(oo)},ok.lock=function(oo){ok.manager.lock(oo)},ok.closeAll=function(){ok.manager.closeAll()},ok.getDialogsByGroup=function(oo){return ok.manager.getDialogsByGroup(oo)},ok.closeByGroup=function(oo){return ok.manager.closeByGroup(oo)},ok.CLOSE="close",ok.CANCEL="cancel",ok.SURE="sure",ok.NO="no",ok.OK="ok",ok.YES="yes",ok._manager=null,ok}(oN),oDo=function(oo){function or(){or.__super.call(this)}oD(or,"laya.ui.HBox",oo);var oT=or.prototype;return oT.sortItem=function(oo){oo&&oo.sort(function(oo,or){return oo.x-or.x})},oT.changeItems=function(){this._itemChanged=!1;for(var oo=[],or=0,oT=0,ok=this.numChildren;oT<ok;oT++){var oW=this.getChildAt(oT);oW&&oW.layoutEnabled&&(oo.push(oW),or=this._height?this._height:Math.max(or,oW.height*oW.scaleY))}this.sortItem(oo);var oD=0;for(oT=0,ok=oo.length;oT<ok;oT++)(oW=oo[oT]).x=oD,oD+=oW.width*oW.scaleX+this._space,"top"==this._align?oW.y=0:"middle"==this._align?oW.y=.5*(or-oW.height*oW.scaleY):"bottom"==this._align&&(oW.y=or-oW.height*oW.scaleY);this.changeSize()},oW(0,oT,"height",oo.prototype._$get_height,function(oo){this._height!=oo&&(oj.superSet(oa,this,"height",oo),this.callLater(this.changeItems))}),or.NONE="none",or.TOP="top",or.MIDDLE="middle",or.BOTTOM="bottom",or}(oa),ono=function(oo){function or(){or.__super.call(this)}oD(or,"laya.ui.VBox",oo);var oT=or.prototype;return oT.changeItems=function(){this._itemChanged=!1;for(var oo=[],or=0,oT=0,ok=this.numChildren;oT<ok;oT++){var oW=this.getChildAt(oT);oW&&oW.layoutEnabled&&(oo.push(oW),or=this._width?this._width:Math.max(or,oW.width*oW.scaleX))}this.sortItem(oo);var oD=0;for(oT=0,ok=oo.length;oT<ok;oT++)(oW=oo[oT]).y=oD,oD+=oW.height*oW.scaleY+this._space,"left"==this._align?oW.x=0:"center"==this._align?oW.x=.5*(or-oW.width*oW.scaleX):"right"==this._align&&(oW.x=or-oW.width*oW.scaleX);this.changeSize()},oW(0,oT,"width",oo.prototype._$get_width,function(oo){this._width!=oo&&(oj.superSet(oa,this,"width",oo),this.callLater(this.changeItems))}),or.NONE="none",or.LEFT="left",or.CENTER="center",or.RIGHT="right",or}(oa),oVo=function(oo){function or(){or.__super.call(this)}return oD(or,"laya.ui.RadioGroup",oB),or.prototype.createItem=function(oo,or){return new oE(oo,or)},or}(),oLo=function(oo){function or(){or.__super.call(this)}return oD(or,"laya.ui.Tab",oB),or.prototype.createItem=function(oo,or){return new oX(oo,or)},or}(),oUo=function(or){function oT(oo){this._vScrollBar=null,this._hScrollBar=null,void 0===oo&&(oo=""),oT.__super.call(this,oo)}oD(oT,"laya.ui.TextArea",or);var oo=oT.prototype;return oo.destroy=function(oo){void 0===oo&&(oo=!0),or.prototype.destroy.call(this,oo),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},oo.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},oo.onVBarChanged=function(oo){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},oo.onHBarChanged=function(oo){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},oo.changeScroll=function(){var oo=this._vScrollBar&&0<this._tf.maxScrollY,or=this._hScrollBar&&0<this._tf.maxScrollX,oT=oo?this._width-this._vScrollBar.width:this._width,ok=or?this._height-this._hScrollBar.height:this._height,oW=this._tf.padding||oH.labelPadding;this._tf.width=oT,this._tf.height=ok,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-oW[2],this._vScrollBar.y=oW[1],this._vScrollBar.height=this._height-(or?this._hScrollBar.height:0)-oW[1]-oW[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=ok/Math.max(this._tf.textHeight,ok),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=oo),this._hScrollBar&&(this._hScrollBar.x=oW[0],this._hScrollBar.y=this._height-this._hScrollBar.height-oW[3],this._hScrollBar.width=this._width-(oo?this._vScrollBar.width:0)-oW[0]-oW[2],this._hScrollBar.scrollSize=Math.max(.033*oT,1),this._hScrollBar.thumbPercent=oT/Math.max(this._tf.textWidth,oT),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=or)},oo.scrollTo=function(oo){this.commitMeasure(),this._tf.scrollY=oo},oW(0,oo,"scrollY",function(){return this._tf.scrollY}),oW(0,oo,"width",or.prototype._$get_width,function(oo){oj.superSet(oTo,this,"width",oo),this.callLater(this.changeScroll)}),oW(0,oo,"hScrollBar",function(){return this._hScrollBar}),oW(0,oo,"height",or.prototype._$get_height,function(oo){oj.superSet(oTo,this,"height",oo),this.callLater(this.changeScroll)}),oW(0,oo,"maxScrollX",function(){return this._tf.maxScrollX}),oW(0,oo,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(oo){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new oro),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=oo}),oW(0,oo,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(oo){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new oZ),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=oo}),oW(0,oo,"vScrollBar",function(){return this._vScrollBar}),oW(0,oo,"maxScrollY",function(){return this._tf.maxScrollY}),oW(0,oo,"scrollX",function(){return this._tf.scrollX}),oT}(oTo);!function(oo){function or(){this._uiView=null,this.isCloseOther=!1,or.__super.call(this)}oD(or,"laya.ui.AsynDialog",oWo);var oT=or.prototype;oT.createView=function(oo){this._uiView=oo},oT._open=function(oo,or,oT){this.isModal=oo,this.isCloseOther=or,oWo.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},oT.onCreated=function(){this.createUI(),this.onOpen()},oT.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},oT.onOpen=function(){oWo.manager.open(this,this.isCloseOther),oWo.manager.lock(!1)},oT.close=function(oo,or){void 0===or&&(or=!0),oWo.manager.close(this),this.onClose()},oT.onClose=function(){},oT.destroy=function(oo){void 0===oo&&(oo=!0),laya.ui.View.prototype.destroy.call(this,oo),this._uiView=null,this.onDestroy()},oT.onDestroy=function(){}}();oj.__init([oN])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(oo,or){"use strict";for(var oT in Object.defineProperty(or,"__esModule",{value:!0}),Laya){var ok=Laya[oT];ok&&ok.__isclass&&(or[oT]=ok)}}),function(oi,oo,oS){oS.un,oS.uns;var op=oS.static,ov=oS.class,ox=oS.getset,ok=oS.__newvec,ol=laya.maths.Arith,on=laya.webgl.atlas.AtlasResourceManager,oT=laya.webgl.shader.BaseShader,oz=laya.utils.Browser,oV=laya.webgl.utils.Buffer,oq=laya.utils.Byte,oW=laya.utils.ClassUtils,oL=oS.Config,oD=(laya.events.Event,laya.events.EventDispatcher),oH=laya.utils.Handler,oK=laya.net.Loader,or=laya.net.LoaderManager,oU=(laya.maths.MathUtil,laya.display.Node),oj=laya.renders.Render,oh=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),o_=laya.resource.Resource,o$=laya.utils.RunDriver,oy=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),ob=laya.display.Sprite,oF=laya.utils.Stat,oP=laya.utils.StringKey,oR=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),ot=laya.utils.Utils,ou=laya.webgl.WebGL,os=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;oS.interface("laya.d3.core.IClone"),oS.interface("laya.d3.graphics.IVertex"),oS.interface("laya.d3.core.render.IUpdate"),oS.interface("laya.d3.core.scene.ITreeNode"),oS.interface("laya.d3.core.render.IRenderable");(function(){function oX(){}ov(oX,"laya.d3.animation.AnimationClipParser01"),oX.READ_DATA=function(){oX._DATA.offset=oX._reader.getUint32(),oX._DATA.size=oX._reader.getUint32()},oX.READ_BLOCK=function(){for(var oo=oX._BLOCK.count=oX._reader.getUint16(),or=oX._BLOCK.blockStarts=[],oT=oX._BLOCK.blockLengths=[],ok=0;ok<oo;ok++)or.push(oX._reader.getUint32()),oT.push(oX._reader.getUint32())},oX.READ_STRINGS=function(){var oo=oX._reader.getUint32(),or=oX._reader.getUint16(),oT=oX._reader.pos;oX._reader.pos=oo+oX._DATA.offset;for(var ok=0;ok<or;ok++)oX._strings[ok]=oX._reader.readUTFString();oX._reader.pos=oT},oX.parse=function(oo,or){oX._animationClip=oo;(oX._reader=or).__getBuffer();oX.READ_DATA(),oX.READ_BLOCK(),oX.READ_STRINGS();for(var oT=0,ok=oX._BLOCK.count;oT<ok;oT++){var oW=or.getUint16(),oD=oX._strings[oW],on=oX["READ_"+oD];if(null==on)throw new Error("model file err,no this function:"+oW+" "+oD);on.call()}},oX.READ_ANIMATIONS=function(){var oo,or=0,oT=0,ok=oX._reader,oW=ok.__getBuffer(),oD=[],on=ok.getUint8();for(oD.length=on,or=0;or<on;or++)oD[or]=ok.getUint16();var oV=[],oL=ok.getUint16();for(oV.length=oL,or=0;or<oL;or++)oV[or]=ok.getFloat32();var oU=oX._animationClip;oU.name=oX._strings[ok.getUint16()];var oh=oU._duration=ok.getFloat32();oU.islooping=!!ok.getByte(),oU._frameRate=ok.getInt16();var op=ok.getInt16(),oi=oU._nodes=new Array;oi.length=op,(oU._publicClipDatas=[]).length=op;var ov=oU._nodesMap={},ox=0,oj=0;for(or=0;or<op;or++){oo=oi[or]=new oI;var o_=ok.getUint16(),oK=oo.path=[];for(oK.length=o_,oT=0;oT<o_;oT++)oK[oT]=oX._strings[ok.getUint16()];var o$=oK.join("/"),oy=ov[o$];oy||(ov[o$]=oy=[]),oy.push(oo);var ol=ok.getInt16();-1!==ol&&(oo.componentType=oX._strings[ol]);var oS=oY._propertyIndexDic[oX._strings[ok.getUint16()]];if(null==oS)throw new Error("AnimationClipParser01:unknown property name.");var oq=oS<4,ob=!oq||oq&&""===oK[0];(oo._cacheProperty=ob)?ox++:oj++,oo.propertyNameID=oS;var oF=oD[ok.getUint8()];oo.keyFrameWidth=oF/4;var oP=oo.keyFrames=[],ot=oP.length=ok.getUint16(),oH=null,oR=NaN;for(oT=0;oT<ot;oT++){var ou=oP[oT]=new oA;oR=ou.startTime=oV[ok.getUint16()];var os=ok.pos;ou.inTangent=new Float32Array(oW.slice(os,os+oF)),ok.pos+=oF,os=ok.pos,ou.outTangent=new Float32Array(oW.slice(os,os+oF)),ok.pos+=oF,os=ok.pos,ou.data=new Float32Array(oW.slice(os,os+oF)),ok.pos+=oF,oH&&(oH.next=ou,oH.duration=oR-oH.startTime),oH=ou}ou.next=null,ou.duration=oh-oR}var oz=oU._nodeToCachePropertyMap=new Int32Array(op),om=oU._cachePropertyMap=new Int32Array(ox),oC=oU._unCachePropertyMap=new Int32Array(oj);for(ox=oj=0,or=0;or<op;or++)(oo=oi[or])._cacheProperty?(oz[or]=ox,om[ox++]=or):oC[oj++]=or},oX._animationClip=null,oX._reader=null,oX._strings=[],op(oX,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function oe(){}ov(oe,"laya.d3.animation.AnimationClipParser02"),oe.READ_DATA=function(){oe._DATA.offset=oe._reader.getUint32(),oe._DATA.size=oe._reader.getUint32()},oe.READ_BLOCK=function(){for(var oo=oe._BLOCK.count=oe._reader.getUint16(),or=oe._BLOCK.blockStarts=[],oT=oe._BLOCK.blockLengths=[],ok=0;ok<oo;ok++)or.push(oe._reader.getUint32()),oT.push(oe._reader.getUint32())},oe.READ_STRINGS=function(){var oo=oe._reader.getUint32(),or=oe._reader.getUint16(),oT=oe._reader.pos;oe._reader.pos=oo+oe._DATA.offset;for(var ok=0;ok<or;ok++)oe._strings[ok]=oe._reader.readUTFString();oe._reader.pos=oT},oe.parse=function(oo,or){oe._animationClip=oo;(oe._reader=or).__getBuffer();oe.READ_DATA(),oe.READ_BLOCK(),oe.READ_STRINGS();for(var oT=0,ok=oe._BLOCK.count;oT<ok;oT++){var oW=or.getUint16(),oD=oe._strings[oW],on=oe["READ_"+oD];if(null==on)throw new Error("model file err,no this function:"+oW+" "+oD);on.call()}},oe.READ_ANIMATIONS=function(){var oo,or=0,oT=0,ok=oe._reader,oW=ok.__getBuffer(),oD=[],on=ok.getUint8();for(oD.length=on,or=0;or<on;or++)oD[or]=ok.getUint16();var oV=[],oL=ok.getUint16();for(oV.length=oL,or=0;or<oL;or++)oV[or]=ok.getFloat32();var oU=oe._animationClip;oU.name=oe._strings[ok.getUint16()];var oh=oU._duration=ok.getFloat32();oU.islooping=!!ok.getByte(),oU._frameRate=ok.getInt16();var op=ok.getInt16(),oi=oU._nodes=new Array;oi.length=op,(oU._publicClipDatas=[]).length=op;var ov=oU._nodesMap={},ox=0,oj=0;for(or=0;or<op;or++){oo=oi[or]=new oI;var o_=ok.getUint16(),oK=oo.path=[];for(oK.length=o_,oT=0;oT<o_;oT++)oK[oT]=oe._strings[ok.getUint16()];var o$=oK.join("/"),oy=ov[o$];oy||(ov[o$]=oy=[]),oy.push(oo);var ol=ok.getInt16();-1!==ol&&(oo.componentType=oe._strings[ol]);var oS=oY._propertyIndexDic[oe._strings[ok.getUint16()]];if(null==oS)throw new Error("AnimationClipParser02:unknown property name.");var oq=oS<4,ob=!oq||oq&&""===oK[0];(oo._cacheProperty=ob)?ox++:oj++,oo.propertyNameID=oS;var oF=oD[ok.getUint8()];oo.keyFrameWidth=oF/4;var oP=oo.keyFrames=[],ot=oP.length=ok.getUint16(),oH=null,oR=NaN;for(oT=0;oT<ot;oT++){var ou=oP[oT]=new oA;oR=ou.startTime=oV[ok.getUint16()];var os=ok.pos;ou.inTangent=new Float32Array(oW.slice(os,os+oF)),ok.pos+=oF,os=ok.pos,ou.outTangent=new Float32Array(oW.slice(os,os+oF)),ok.pos+=oF,os=ok.pos,ou.data=new Float32Array(oW.slice(os,os+oF)),ok.pos+=oF,oH&&(oH.next=ou,oH.duration=oR-oH.startTime),oH=ou}ou.next=null,ou.duration=oh-oR}var oz=ok.getUint16();for(or=0;or<oz;or++){var om,oC=new oJ;oC.time=ok.getFloat32(),oC.eventName=oe._strings[ok.getUint16()];var oX=ok.getUint16();for(0<oX&&(oC.params=om=[]),oT=0;oT<oX;oT++){switch(ok.getByte()){case 0:om.push(!!ok.getByte());break;case 1:om.push(ok.getInt32());break;case 2:om.push(ok.getFloat32());break;case 3:om.push(oe._strings[ok.getUint16()]);break;default:throw new Error("unknown type.")}}oU.addEvent(oC)}var oO=oU._nodeToCachePropertyMap=new Int32Array(op),oM=oU._cachePropertyMap=new Int32Array(ox),oc=oU._unCachePropertyMap=new Int32Array(oj);for(ox=oj=0,or=0;or<op;or++)(oo=oi[or])._cacheProperty?(oO[or]=ox,oM[ox++]=or):oc[oj++]=or},oe._animationClip=null,oe._reader=null,oe._strings=[],op(oe,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var oJ=function(){function oo(){this.time=NaN,this.eventName=null,this.params=null}return ov(oo,"laya.d3.animation.AnimationEvent"),oo}(),oY=function(){function ok(){this._childs=[],this.transform=new o$r(this)}ov(ok,"laya.d3.animation.AnimationNode");var oo=ok.prototype;return oS.imps(oo,{"laya.d3.core.IClone":!0}),oo.addChild=function(oo){oo._parent=this,oo.transform.setParent(this.transform),this._childs.push(oo)},oo.removeChild=function(oo){var or=this._childs.indexOf(oo);-1!==or&&this._childs.splice(or,1)},oo.getChildByName=function(oo){for(var or=0,oT=this._childs.length;or<oT;or++){var ok=this._childs[or];if(ok.name===oo)return ok}return null},oo.getChildByIndex=function(oo){return this._childs[oo]},oo.getChildCount=function(){return this._childs.length},oo.cloneTo=function(oo){var or=oo;or.name=this.name;for(var oT=0,ok=this._childs.length;oT<ok;oT++){var oW=this._childs[oT],oD=oW.clone();or.addChild(oD);var on=oW.transform,oV=oD.transform;oV.setLocalPosition(on.getLocalPosition()),oV.setLocalRotation(on.getLocalRotation()),oV.setLocalScale(on.getLocalScale()),oV._localRotationEuler=on._localRotationEuler,oV._setWorldMatrixIgnoreUpdate(on.getWorldMatrix())}},oo.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ok.__init__=function(){ok.registerAnimationNodeProperty("localPosition",ok._getLocalPosition,ok._setLocalPosition),ok.registerAnimationNodeProperty("localRotation",ok._getLocalRotation,ok._setLocalRotation),ok.registerAnimationNodeProperty("localScale",ok._getLocalScale,ok._setLocalScale),ok.registerAnimationNodeProperty("localRotationEuler",ok._getLocalRotationEuler,ok._setLocalRotationEuler),ok.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",ok._getParticleRenderSharedMaterialTintColor,ok._setParticleRenderSharedMaterialTintColor),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",ok._getMeshRenderSharedMaterialTilingOffset,ok._setMeshRenderSharedMaterialTilingOffset),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",ok._getMeshRenderSharedMaterialAlbedo,ok._setMeshRenderSharedMaterialAlbedo),ok.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",ok._getSkinnedMeshRenderSharedMaterialTilingOffset,ok._setSkinnedMeshRenderSharedMaterialTilingOffset),ok.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",ok._getSkinnedMeshRenderSharedMaterialAlbedo,ok._setSkinnedMeshRenderSharedMaterialAlbedo),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",ok._getMeshRenderSharedMaterialAlbedo,ok._setMeshRenderSharedMaterialAlbedo),ok.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",ok._getSkinnedMeshRenderSharedMaterialAlbedo,ok._setSkinnedMeshRenderSharedMaterialAlbedo),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",ok._getMeshRenderSharedMaterialIntensity,ok._setMeshRenderSharedMaterialIntensity),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",ok._getMeshRenderSharedMaterialAlpha,ok._setMeshRenderSharedMaterialAlpha),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",ok._getMeshRenderSharedMaterialAlphaColor,ok._setMeshRenderSharedMaterialAlphaColor),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",ok._getMeshRenderSharedMaterialBaseColor,ok._setMeshRenderSharedMaterialBaseColor),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",ok._getMeshRenderSharedMaterialDissolve,ok._setMeshRenderSharedMaterialDissolve),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",ok._getMeshRenderSharedMaterialDissolveSpeed,ok._setMeshRenderSharedMaterialDissolveSpeed),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",ok._getMeshRenderSharedMaterialMMultiplier,ok._setMeshRenderSharedMaterialMMultiplier),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",ok._getMeshRenderSharedMaterialBaseScrollSpeedX,ok._setMeshRenderSharedMaterialBaseScrollSpeedX),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",ok._getMeshRenderSharedMaterialBaseScrollSpeedY,ok._setMeshRenderSharedMaterialBaseScrollSpeedY),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",ok._getMeshRenderSharedMaterialSecondScrollSpeedX,ok._setMeshRenderSharedMaterialSecondScrollSpeedX),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",ok._getMeshRenderSharedMaterialSecondScrollSpeedY,ok._setMeshRenderSharedMaterialSecondScrollSpeedY),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",ok._getMeshRenderSharedMaterialDetailTilingOffset,ok._setMeshRenderSharedMaterialDetailTilingOffset),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",ok._getMeshRenderSharedMaterialDissolveTilingOffset,ok._setMeshRenderSharedMaterialDissolveTilingOffset),ok.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",ok._getMeshRenderSharedMaterialMaskTilingOffset,ok._setMeshRenderSharedMaterialMaskTilingOffset)},ok.registerAnimationNodeProperty=function(oo,or,oT){if(ok._propertyIndexDic[oo])throw new Error("AnimationNode: this propertyName has registered.");ok._propertyIndexDic[oo]=ok._propertyIDCounter,ok._propertyGetFuncs[ok._propertyIDCounter]=or,ok._propertySetFuncs[ok._propertyIDCounter]=oT,ok._propertyIDCounter++},ok._getLocalPosition=function(oo,or){return oo?oo.transform.getLocalPosition():or._transform.localPosition.elements},ok._setLocalPosition=function(oo,or,oT){if(oo)oo.transform.setLocalPosition(oT);else{var ok=or._transform,oW=ok.localPosition;oW.elements=oT,ok.localPosition=oW}},ok._getLocalRotation=function(oo,or){return oo?oo.transform.getLocalRotation():or._transform.localRotation.elements},ok._setLocalRotation=function(oo,or,oT){if(oo)oo.transform.setLocalRotation(oT);else{var ok=or._transform,oW=ok.localRotation;oW.elements=oT,ok.localRotation=oW}},ok._getLocalScale=function(oo,or){return oo?oo.transform.getLocalScale():or._transform.localScale.elements},ok._setLocalScale=function(oo,or,oT){if(oo)oo.transform.setLocalScale(oT);else{var ok=or._transform,oW=ok.localScale;oW.elements=oT,ok.localScale=oW}},ok._getLocalRotationEuler=function(oo,or){return oo?oo.transform.getLocalRotationEuler():or._transform.localRotationEuler.elements},ok._setLocalRotationEuler=function(oo,or,oT){if(oo)oo.transform.setLocalRotationEuler(oT);else{var ok=or._transform,oW=ok.localRotationEuler;oW.elements=oT,ok.localRotationEuler=oW}},ok._getMeshRenderSharedMaterialTilingOffset=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return or.meshRender.sharedMaterial.tilingOffset.elements},ok._setMeshRenderSharedMaterialTilingOffset=function(oo,or,oT){var ok,oW;if(oo){var oD=oo.transform._entity;oD&&((oW=(ok=oD.owner.meshRender.material).tilingOffset).elements=oT,ok.tilingOffset=oW)}else(oW=(ok=or.meshRender.material).tilingOffset).elements=oT,ok.tilingOffset=oW},ok._getMeshRenderSharedMaterialAlbedo=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.albedoColor.elements:null}return or.meshRender.sharedMaterial.albedoColor.elements},ok._setMeshRenderSharedMaterialAlbedo=function(oo,or,oT){var ok,oW;if(oo){var oD=oo.transform._entity;oD&&((oW=(ok=oD.owner.meshRender.material).albedoColor).elements=oT,ok.albedoColor=oW)}else(oW=(ok=or.meshRender.material).albedoColor).elements=oT,ok.albedoColor=oW},ok._getSkinnedMeshRenderSharedMaterialTilingOffset=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return or.skinnedMeshRender.sharedMaterial.tilingOffset.elements},ok._setSkinnedMeshRenderSharedMaterialTilingOffset=function(oo,or,oT){var ok,oW;if(oo){var oD=oo.transform._entity;oD&&((oW=(ok=oD.owner.skinnedMeshRender.material).tilingOffset).elements=oT,ok.tilingOffset=oW)}else(oW=(ok=or.skinnedMeshRender.material).tilingOffset).elements=oT,ok.tilingOffset=oW},ok._getSkinnedMeshRenderSharedMaterialAlbedo=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return or.skinnedMeshRender.sharedMaterial.albedoColor.elements},ok._setSkinnedMeshRenderSharedMaterialAlbedo=function(oo,or,oT){var ok,oW;if(oo){var oD=oo.transform._entity;oD&&((oW=(ok=oD.owner.skinnedMeshRender.material).albedoColor).elements=oT,ok.albedoColor=oW)}else(oW=(ok=or.skinnedMeshRender.material).albedoColor).elements=oT,ok.albedoColor=oW},ok._getParticleRenderSharedMaterialTintColor=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.particleRender.sharedMaterial.tintColor.elements:null}return or.particleRender.sharedMaterial.tintColor.elements},ok._setParticleRenderSharedMaterialTintColor=function(oo,or,oT){var ok,oW;if(oo){var oD=oo.transform._entity;oD&&((oW=(ok=oD.owner.particleRender.material).tintColor).elements=oT,ok.tintColor=oW)}else(oW=(ok=or.particleRender.material).tintColor).elements=oT,ok.tintColor=oW},ok._getMeshRenderSharedMaterialAlphaColor=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.alphaColor.elements:null}return or.meshRender.sharedMaterial.alphaColor.elements},ok._setMeshRenderSharedMaterialAlphaColor=function(oo,or,oT){var ok,oW;if(oo){var oD=oo.transform._entity;oD&&((oW=(ok=oD.owner.meshRender.material).alphaColor).elements=oT,ok.alphaColor=oW)}else(oW=(ok=or.meshRender.material).alphaColor).elements=oT,ok.alphaColor=oW},ok._getMeshRenderSharedMaterialBaseColor=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.baseColor.elements:null}return or.meshRender.sharedMaterial.baseColor.elements},ok._setMeshRenderSharedMaterialBaseColor=function(oo,or,oT){var ok,oW;if(oo){var oD=oo.transform._entity;oD&&((oW=(ok=oD.owner.meshRender.material).baseColor).elements=oT,ok.baseColor=oW)}else(oW=(ok=or.meshRender.material).baseColor).elements=oT,ok.baseColor=oW},ok._getMeshRenderSharedMaterialDissolve=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.dissolve:0}return or.meshRender.sharedMaterial.dissolve},ok._setMeshRenderSharedMaterialDissolve=function(oo,or,oT){if(oo){var ok=oo.transform._entity;ok&&(ok.owner.meshRender.material.dissolve=oT[0])}else or.meshRender.material.dissolve=oT[0]},ok._getMeshRenderSharedMaterialDissolveSpeed=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.dissolveSpeed:0}return or.meshRender.sharedMaterial.dissolveSpeed},ok._setMeshRenderSharedMaterialDissolveSpeed=function(oo,or,oT){if(oo){var ok=oo.transform._entity;ok&&(ok.owner.meshRender.material.dissolveSpeed=oT[0])}else or.meshRender.material.dissolveSpeed=oT[0]},ok._getMeshRenderSharedMaterialMMultiplier=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.mMultiplier:0}return or.meshRender.sharedMaterial.mMultiplier},ok._setMeshRenderSharedMaterialMMultiplier=function(oo,or,oT){if(oo){var ok=oo.transform._entity;ok&&(ok.owner.meshRender.material.mMultiplier=oT[0])}else or.meshRender.material.mMultiplier=oT[0]},ok._getMeshRenderSharedMaterialBaseScrollSpeedX=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return or.meshRender.sharedMaterial.baseScrollSpeedX},ok._setMeshRenderSharedMaterialBaseScrollSpeedX=function(oo,or,oT){if(oo){var ok=oo.transform._entity;ok&&(ok.owner.meshRender.material.baseScrollSpeedX=oT[0])}else or.meshRender.material.baseScrollSpeedX=oT[0]},ok._getMeshRenderSharedMaterialBaseScrollSpeedY=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return or.meshRender.sharedMaterial.baseScrollSpeedY},ok._setMeshRenderSharedMaterialBaseScrollSpeedY=function(oo,or,oT){if(oo){var ok=oo.transform._entity;ok&&(ok.owner.meshRender.material.baseScrollSpeedY=oT[0])}else or.meshRender.material.baseScrollSpeedY=oT[0]},ok._getMeshRenderSharedMaterialSecondScrollSpeedX=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return or.meshRender.sharedMaterial.secondScrollSpeedX},ok._setMeshRenderSharedMaterialSecondScrollSpeedX=function(oo,or,oT){if(oo){var ok=oo.transform._entity;ok&&(ok.owner.meshRender.material.secondScrollSpeedX=oT[0])}else or.meshRender.material.secondScrollSpeedX=oT[0]},ok._getMeshRenderSharedMaterialSecondScrollSpeedY=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return or.meshRender.sharedMaterial.secondScrollSpeedY},ok._setMeshRenderSharedMaterialSecondScrollSpeedY=function(oo,or,oT){if(oo){var ok=oo.transform._entity;ok&&(ok.owner.meshRender.material.secondScrollSpeedY=oT[0])}else or.meshRender.material.secondScrollSpeedY=oT[0]},ok._getMeshRenderSharedMaterialAlpha=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.alpha:0}return or.meshRender.sharedMaterial.alpha},ok._setMeshRenderSharedMaterialAlpha=function(oo,or,oT){if(oo){var ok=oo.transform._entity;ok&&(ok.owner.meshRender.material.alpha=oT[0])}else or.meshRender.material.alpha=oT[0]},ok._getMeshRenderSharedMaterialIntensity=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.intensity:0}return or.meshRender.sharedMaterial.intensity},ok._setMeshRenderSharedMaterialIntensity=function(oo,or,oT){if(oo){var ok=oo.transform._entity;ok&&(ok.owner.meshRender.material.intensity=oT[0])}else or.meshRender.material.intensity=oT[0]},ok._getMeshRenderSharedMaterialDetailTilingOffset=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return or.meshRender.sharedMaterial.detailTilingOffset.elements},ok._setMeshRenderSharedMaterialDetailTilingOffset=function(oo,or,oT){var ok,oW;if(oo){var oD=oo.transform._entity;oD&&((oW=(ok=oD.owner.meshRender.material).detailTilingOffset).elements=oT,ok.detailTilingOffset=oW)}else(oW=(ok=or.meshRender.material).detailTilingOffset).elements=oT,ok.detailTilingOffset=oW},ok._getMeshRenderSharedMaterialDissolveTilingOffset=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return or.meshRender.sharedMaterial.dissolveTilingOffset.elements},ok._setMeshRenderSharedMaterialDissolveTilingOffset=function(oo,or,oT){var ok,oW;if(oo){var oD=oo.transform._entity;oD&&((oW=(ok=oD.owner.meshRender.material).dissolveTilingOffset).elements=oT,ok.dissolveTilingOffset=oW)}else(oW=(ok=or.meshRender.material).dissolveTilingOffset).elements=oT,ok.dissolveTilingOffset=oW},ok._getMeshRenderSharedMaterialMaskTilingOffset=function(oo,or){if(oo){var oT=oo.transform._entity;return oT?oT.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return or.meshRender.sharedMaterial.maskTilingOffset.elements},ok._setMeshRenderSharedMaterialMaskTilingOffset=function(oo,or,oT){var ok,oW;if(oo){var oD=oo.transform._entity;oD&&((oW=(ok=oD.owner.meshRender.material).maskTilingOffset).elements=oT,ok.maskTilingOffset=oW)}else(oW=(ok=or.meshRender.material).maskTilingOffset).elements=oT,ok.maskTilingOffset=oW},ok._propertyIDCounter=0,ok._propertyIndexDic={},ok._propertySetFuncs=[],ok._propertyGetFuncs=[],ok}(),oA=function(){function oo(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return ov(oo,"laya.d3.animation.Keyframe"),oo}(),oI=function(){function oo(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return ov(oo,"laya.d3.animation.KeyframeNode"),oo}(),om=(function(){function oo(){this._tempVector30=new onr,this._tempVector31=new onr,this._tempVector32=new onr,this._a=new onr,this._b=new onr,this._c=new onr,this._d=new onr}ov(oo,"laya.d3.core.glitter.SplineCurvePositionVelocity");var or=oo.prototype;or.Init=function(oo,or,oT,ok){oo.cloneTo(this._d),or.cloneTo(this._c),onr.scale(oo,2,this._a),onr.scale(oT,2,this._tempVector30),onr.subtract(this._a,this._tempVector30,this._a),onr.add(this._a,or,this._a),onr.add(this._a,ok,this._a),onr.scale(oT,3,this._b),onr.scale(oo,3,this._tempVector30),onr.subtract(this._b,this._tempVector30,this._b),onr.subtract(this._b,ok,this._b),onr.scale(or,2,this._tempVector30),onr.subtract(this._b,this._tempVector30,this._b)},or.Slerp=function(oo,or){onr.scale(this._a,oo*oo*oo,this._tempVector30),onr.scale(this._b,oo*oo,this._tempVector31),onr.scale(this._c,oo,this._tempVector32),onr.add(this._tempVector30,this._tempVector31,or),onr.add(or,this._tempVector32,or),onr.add(or,this._d,or)}}(),function(){function oM(oo,or,oT,ok){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=oo,this._h=or,this._minHeight=oT,this._maxHeight=ok}ov(oM,"laya.d3.core.HeightMap");var oo=oM.prototype;oo._inBounds=function(oo,or){return 0<=oo&&oo<this._h&&0<=or&&or<this._w},oo.getHeight=function(oo,or){return this._inBounds(oo,or)?this._datas[oo][or]:NaN},ox(0,oo,"width",function(){return this._w}),ox(0,oo,"height",function(){return this._h}),ox(0,oo,"maxHeight",function(){return this._maxHeight}),ox(0,oo,"minHeight",function(){return this._minHeight}),oM.creatFromMesh=function(oo,or,oT,ok){for(var oW=[],oD=[],on=oo.getSubMeshCount(),oV=0;oV<on;oV++){for(var oL=oo.getSubMesh(oV),oU=oL._getVertexBuffer(),oh=oU.getData(),op=[],oi=0;oi<oh.length;oi+=oU.vertexDeclaration.vertexStride/4){var ov=new onr(oh[oi+0],oh[oi+1],oh[oi+2]);op.push(ov)}oW.push(op);var ox=oL._getIndexBuffer();oD.push(ox.getData())}var oj=oo.boundingBox,o_=oj.min.x,oK=oj.min.z,o$=oj.max.x,oy=oj.max.z,ol=oj.min.y,oS=oj.max.y,oq=o$-o_,ob=oy-oK,oF=ok.elements[0]=oq/(or-1),oP=ok.elements[1]=ob/(oT-1),ot=new oM(or,oT,ol,oS),oH=oM._tempRay,oR=oH.direction.elements;oR[0]=0,oR[1]=-1,oR[2]=0;var ou=oS+.1;oH.origin.elements[1]=ou;for(var os=0;os<oT;os++){var oz=oK+os*oP;ot._datas[os]=[];for(var om=0;om<or;om++){var oC=o_+om*oF,oX=oH.origin.elements;oX[0]=oC,oX[2]=oz;var oO=oM._getPosition(oH,oW,oD);ot._datas[os][om]=oO===Number.MAX_VALUE?NaN:ou-oO}}return ot},oM.createFromImage=function(oo,or,oT){for(var ok=oo.width,oW=oo.height,oD=new oM(ok,oW,or,oT),on=(oT-or)/254,oV=oo.getPixels(),oL=0,oU=0;oU<oW;oU++)for(var oh=oD._datas[oU]=[],op=0;op<ok;op++){var oi=oV[oL++],ov=oV[oL++],ox=oV[oL++],oj=oV[oL++];oh[op]=255==oi&&255==ov&&255==ox&&255==oj?NaN:(oi+ov+ox)/3*on+or}return oD},oM._getPosition=function(oo,or,oT){for(var ok=Number.MAX_VALUE,oW=0;oW<or.length;oW++)for(var oD=or[oW],on=oT[oW],oV=0;oV<on.length;oV+=3){var oL=oD[on[oV+0]],oU=oD[on[oV+1]],oh=oD[on[oV+2]],op=oxr.rayIntersectsTriangle(oo,oL,oU,oh);!isNaN(op)&&op<ok&&(ok=op)}return ok},op(oM,["_tempRay",function(){return this._tempRay=new oWr(new onr,new onr)}])}(),function(){function oW(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}ov(oW,"laya.d3.core.Layer");var oo=oW.prototype;return oo._binarySearchIndex=function(){for(var oo=0,or=oW._collsionTestList.length-1,oT=0;oo<=or;){oT=Math.floor((oo+or)/2);var ok=oW._collsionTestList[oT];if(ok==this._number)return oT;ok>this._number?or=oT-1:oo=oT+1}return oo},oo._addCollider=function(oo){0===this._colliders.length&&oW._collsionTestList.splice(this._binarySearchIndex(),0,this._number),oo._isRigidbody?(this._colliders.unshift(oo),this._nonRigidbodyOffset++):this._colliders.push(oo)},oo._removeCollider=function(oo){var or=this._colliders.indexOf(oo);or<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(or,1),0===this._colliders.length&&oW._collsionTestList.splice(oW._collsionTestList.indexOf(this._number),1)},ox(0,oo,"number",function(){return this._number}),ox(0,oo,"visible",function(){return this._visible},function(oo){this._visible=oo,oW._visibleLayers=oo?oW._visibleLayers|this.mask:oW._visibleLayers&~this.mask}),ox(0,oo,"mask",function(){return this._mask}),ox(1,oW,"visibleLayers",function(){return oW._visibleLayers},function(oo){oW._visibleLayers=oo;for(var or=0,oT=oW._layerList.length;or<oT;or++){var ok=oW._layerList[or];ok._visible=0!=(ok._mask&oW._visibleLayers)}}),oW.__init__=function(){oW._layerList.length=31;for(var oo=0;oo<31;oo++){var or=new oW;oW._layerList[oo]=or,0===oo?(or.name="Default Layer",or.visible=!0):(or.name="Layer-"+oo,or.visible=!1),or._number=oo,or._mask=Math.pow(2,oo)}oW.currentCreationLayer=oW._layerList[0]},oW.getLayerByNumber=function(oo){if(oo<0||30<oo)throw new Error("无法返回指定Layer，该number超出范围！");return oW._layerList[oo]},oW.getLayerByName=function(oo){for(var or=0;or<31;or++)if(oW._layerList[or].name===oo)return oW._layerList[or];throw new Error("无法返回指定Layer,该name不存在")},oW.isVisible=function(oo){return 0!=(oo&oW._currentCameraCullingMask&oW._visibleLayers)},oW._layerList=[],oW._visibleLayers=2147483647,oW._collsionTestList=[],oW._currentCameraCullingMask=2147483647,oW.maxCount=31,oW.currentCreationLayer=null,oW}()),oC=(function(){function oo(oo,or,oT){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=oo,this._minCount=or,this._maxCount=oT}ov(oo,"laya.d3.core.particleShuriKen.module.Burst");var or=oo.prototype;oS.imps(or,{"laya.d3.core.IClone":!0}),or.cloneTo=function(oo){var or=oo;or._time=this._time,or._minCount=this._minCount,or._maxCount=this._maxCount},or.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,or,"time",function(){return this._time}),ox(0,or,"minCount",function(){return this._minCount}),ox(0,or,"maxCount",function(){return this._maxCount})}(),function(){function oo(oo){this._color=null,this.enbale=!1,this._color=oo}ov(oo,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var or=oo.prototype;or.cloneTo=function(oo){var or=oo;this._color.cloneTo(or._color),or.enbale=this.enbale},or.clone=function(){var oo;switch(this._color.type){case 0:oo=oO.createByConstant(this._color.constant.clone());break;case 1:oo=oO.createByGradient(this._color.gradient.clone());break;case 2:oo=oO.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:oo=oO.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var or=new this.constructor(oo);return or.enbale=this.enbale,or},ox(0,or,"color",function(){return this._color})}(),function(){function oo(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}ov(oo,"laya.d3.core.particleShuriKen.module.Emission");var or=oo.prototype;oS.imps(or,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),or._destroy=function(){this._bursts=null,this._destroyed=!0},or.getBurstsCount=function(){return this._bursts.length},or.getBurstByIndex=function(oo){return this._bursts[oo]},or.addBurst=function(oo){var or=this._bursts.length;if(0<or)for(var oT=0;oT<or;oT++)this._bursts[oT].time>oo.time&&this._bursts.splice(oT,0,oo);this._bursts.push(oo)},or.removeBurst=function(oo){var or=this._bursts.indexOf(oo);-1!==or&&this._bursts.splice(or,1)},or.removeBurstByIndex=function(oo){this._bursts.splice(oo,1)},or.clearBurst=function(){this._bursts.length=0},or.cloneTo=function(oo){var or=oo,oT=or._bursts;oT.length=this._bursts.length;for(var ok=0,oW=this._bursts.length;ok<oW;ok++){var oD=oT[ok];oD?this._bursts[ok].cloneTo(oD):oT[ok]=this._bursts[ok].clone()}or._emissionRate=this._emissionRate,or.enbale=this.enbale},or.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,or,"destroyed",function(){return this._destroyed}),ox(0,or,"emissionRate",function(){return this._emissionRate},function(oo){if(oo<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=oo})}(),function(){function ok(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}ov(ok,"laya.d3.core.particleShuriKen.module.FrameOverTime");var oo=ok.prototype;return oS.imps(oo,{"laya.d3.core.IClone":!0}),oo.cloneTo=function(oo){var or=oo;or._type=this._type,or._constant=this._constant,this._overTime.cloneTo(or._overTime),or._constantMin=this._constantMin,or._constantMax=this._constantMax,this._overTimeMin.cloneTo(or._overTimeMin),this._overTimeMax.cloneTo(or._overTimeMax)},oo.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,oo,"frameOverTimeData",function(){return this._overTime}),ox(0,oo,"constant",function(){return this._constant}),ox(0,oo,"type",function(){return this._type}),ox(0,oo,"frameOverTimeDataMin",function(){return this._overTimeMin}),ox(0,oo,"constantMin",function(){return this._constantMin}),ox(0,oo,"frameOverTimeDataMax",function(){return this._overTimeMax}),ox(0,oo,"constantMax",function(){return this._constantMax}),ok.createByConstant=function(oo){var or=new ok;return or._type=0,or._constant=oo,or},ok.createByOverTime=function(oo){var or=new ok;return or._type=1,or._overTime=oo,or},ok.createByRandomTwoConstant=function(oo,or){var oT=new ok;return oT._type=2,oT._constantMin=oo,oT._constantMax=or,oT},ok.createByRandomTwoOverTime=function(oo,or){var oT=new ok;return oT._type=3,oT._overTimeMin=oo,oT._overTimeMax=or,oT},ok}()),oX=function(){function oU(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}ov(oU,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var oo=oU.prototype;return oS.imps(oo,{"laya.d3.core.IClone":!0}),oo.cloneTo=function(oo){var or=oo;or._type=this._type,or._separateAxes=this._separateAxes,or._constant=this._constant,this._constantSeparate.cloneTo(or._constantSeparate),this._gradient.cloneTo(or._gradient),this._gradientX.cloneTo(or._gradientX),this._gradientY.cloneTo(or._gradientY),this._gradientZ.cloneTo(or._gradientZ),or._constantMin=this._constantMin,or._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(or._constantMinSeparate),this._constantMaxSeparate.cloneTo(or._constantMaxSeparate),this._gradientMin.cloneTo(or._gradientMin),this._gradientMax.cloneTo(or._gradientMax),this._gradientXMin.cloneTo(or._gradientXMin),this._gradientXMax.cloneTo(or._gradientXMax),this._gradientYMin.cloneTo(or._gradientYMin),this._gradientYMax.cloneTo(or._gradientYMax),this._gradientZMin.cloneTo(or._gradientZMin),this._gradientZMax.cloneTo(or._gradientZMax)},oo.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,oo,"gradientZ",function(){return this._gradientZ}),ox(0,oo,"constant",function(){return this._constant}),ox(0,oo,"gradient",function(){return this._gradient}),ox(0,oo,"separateAxes",function(){return this._separateAxes}),ox(0,oo,"type",function(){return this._type}),ox(0,oo,"constantSeparate",function(){return this._constantSeparate}),ox(0,oo,"gradientX",function(){return this._gradientX}),ox(0,oo,"gradientY",function(){return this._gradientY}),ox(0,oo,"gradientW",function(){return this._gradientW}),ox(0,oo,"gradientMin",function(){return this._gradientMin}),ox(0,oo,"constantMin",function(){return this._constantMin}),ox(0,oo,"gradientMax",function(){return this._gradientMax}),ox(0,oo,"constantMax",function(){return this._constantMax}),ox(0,oo,"gradientWMin",function(){return this._gradientWMin}),ox(0,oo,"constantMinSeparate",function(){return this._constantMinSeparate}),ox(0,oo,"constantMaxSeparate",function(){return this._constantMaxSeparate}),ox(0,oo,"gradientXMin",function(){return this._gradientXMin}),ox(0,oo,"gradientXMax",function(){return this._gradientXMax}),ox(0,oo,"gradientWMax",function(){return this._gradientWMax}),ox(0,oo,"gradientYMin",function(){return this._gradientYMin}),ox(0,oo,"gradientYMax",function(){return this._gradientYMax}),ox(0,oo,"gradientZMin",function(){return this._gradientZMin}),ox(0,oo,"gradientZMax",function(){return this._gradientZMax}),oU.createByConstant=function(oo){var or=new oU;return or._type=0,or._separateAxes=!1,or._constant=oo,or},oU.createByConstantSeparate=function(oo){var or=new oU;return or._type=0,or._separateAxes=!0,or._constantSeparate=oo,or},oU.createByGradient=function(oo){var or=new oU;return or._type=1,or._separateAxes=!1,or._gradient=oo,or},oU.createByGradientSeparate=function(oo,or,oT,ok){var oW=new oU;return oW._type=1,oW._separateAxes=!0,oW._gradientX=oo,oW._gradientY=or,oW._gradientZ=oT,oW._gradientW=ok,oW},oU.createByRandomTwoConstant=function(oo,or){var oT=new oU;return oT._type=2,oT._separateAxes=!1,oT._constantMin=oo,oT._constantMax=or,oT},oU.createByRandomTwoConstantSeparate=function(oo,or){var oT=new oU;return oT._type=2,oT._separateAxes=!0,oT._constantMinSeparate=oo,oT._constantMaxSeparate=or,oT},oU.createByRandomTwoGradient=function(oo,or){var oT=new oU;return oT._type=3,oT._separateAxes=!1,oT._gradientMin=oo,oT._gradientMax=or,oT},oU.createByRandomTwoGradientSeparate=function(oo,or,oT,ok,oW,oD,on,oV){var oL=new oU;return oL._type=3,oL._separateAxes=!0,oL._gradientXMin=oo,oL._gradientXMax=or,oL._gradientYMin=oT,oL._gradientYMax=ok,oL._gradientZMin=oW,oL._gradientZMax=oD,oL._gradientWMin=on,oL._gradientWMax=oV,oL},oU}(),oO=function(){function ok(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}ov(ok,"laya.d3.core.particleShuriKen.module.GradientColor");var oo=ok.prototype;return oS.imps(oo,{"laya.d3.core.IClone":!0}),oo.cloneTo=function(oo){var or=oo;or._type=this._type,this._constant.cloneTo(or._constant),this._constantMin.cloneTo(or._constantMin),this._constantMax.cloneTo(or._constantMax),this._gradient.cloneTo(or._gradient),this._gradientMin.cloneTo(or._gradientMin),this._gradientMax.cloneTo(or._gradientMax)},oo.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,oo,"gradient",function(){return this._gradient}),ox(0,oo,"constant",function(){return this._constant}),ox(0,oo,"type",function(){return this._type}),ox(0,oo,"gradientMin",function(){return this._gradientMin}),ox(0,oo,"constantMin",function(){return this._constantMin}),ox(0,oo,"gradientMax",function(){return this._gradientMax}),ox(0,oo,"constantMax",function(){return this._constantMax}),ok.createByConstant=function(oo){var or=new ok;return or._type=0,or._constant=oo,or},ok.createByGradient=function(oo){var or=new ok;return or._type=1,or._gradient=oo,or},ok.createByRandomTwoConstant=function(oo,or){var oT=new ok;return oT._type=2,oT._constantMin=oo,oT._constantMax=or,oT},ok.createByRandomTwoGradient=function(oo,or){var oT=new ok;return oT._type=3,oT._gradientMin=oo,oT._gradientMax=or,oT},ok}(),oM=(function(){function oo(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}ov(oo,"laya.d3.core.particleShuriKen.module.GradientDataColor");var or=oo.prototype;oS.imps(or,{"laya.d3.core.IClone":!0}),or.addAlpha=function(oo,or){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==oo&&(oo=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=oo,this._alphaElements[this._alphaCurrentLength++]=or):DEBUG},or.addRGB=function(oo,or){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==oo&&(oo=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=oo,this._rgbElements[this._rgbCurrentLength++]=or.x,this._rgbElements[this._rgbCurrentLength++]=or.y,this._rgbElements[this._rgbCurrentLength++]=or.z):DEBUG},or.cloneTo=function(oo){var or=oo,oT=0,ok=0;or._alphaCurrentLength=this._alphaCurrentLength;var oW=or._alphaElements;for(oW.length=this._alphaElements.length,oT=0,ok=this._alphaElements.length;oT<ok;oT++)oW[oT]=this._alphaElements[oT];or._rgbCurrentLength=this._rgbCurrentLength;var oD=or._rgbElements;for(oD.length=this._rgbElements.length,oT=0,ok=this._rgbElements.length;oT<ok;oT++)oD[oT]=this._rgbElements[oT]},or.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,or,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),ox(0,or,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function oo(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}ov(oo,"laya.d3.core.particleShuriKen.module.GradientDataInt");var or=oo.prototype;oS.imps(or,{"laya.d3.core.IClone":!0}),or.add=function(oo,or){this._currentLength<8?(6===this._currentLength&&1!==oo&&(oo=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=oo,this._elements[this._currentLength++]=or):console.log("Warning:data count must lessEqual than 4")},or.cloneTo=function(oo){var or=oo;or._currentLength=this._currentLength;var oT=or._elements;oT.length=this._elements.length;for(var ok=0,oW=this._elements.length;ok<oW;ok++)oT[ok]=this._elements[ok]},or.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,or,"gradientCount",function(){return this._currentLength/2})}(),function(){function oo(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}ov(oo,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var or=oo.prototype;oS.imps(or,{"laya.d3.core.IClone":!0}),or.add=function(oo,or){this._currentLength<8?(6===this._currentLength&&1!==oo&&(oo=1,DEBUG),this._elements[this._currentLength++]=oo,this._elements[this._currentLength++]=or):DEBUG},or.getKeyByIndex=function(oo){return this._elements[2*oo]},or.getValueByIndex=function(oo){return this._elements[2*oo+1]},or.getAverageValue=function(){for(var oo=0,or=this._currentLength-2;oo<or;oo+=2){this._elements[oo+1];this._elements[oo+3],this._elements[oo+2]-this._elements[oo]}return 0},or.cloneTo=function(oo){var or=oo;or._currentLength=this._currentLength;var oT=or._elements;oT.length=this._elements.length;for(var ok=0,oW=this._elements.length;ok<oW;ok++)oT[ok]=this._elements[ok]},or.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,or,"gradientCount",function(){return this._currentLength/2})}(),function(){function oo(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}ov(oo,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var or=oo.prototype;oS.imps(or,{"laya.d3.core.IClone":!0}),or.add=function(oo,or){this._currentLength<8?(6===this._currentLength&&1!==oo&&(oo=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=oo,this._elements[this._currentLength++]=or.x,this._elements[this._currentLength++]=or.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},or.cloneTo=function(oo){var or=oo;or._currentLength=this._currentLength;var oT=or._elements;oT.length=this._elements.length;for(var ok=0,oW=this._elements.length;ok<oW;ok++)oT[ok]=this._elements[ok]},or.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,or,"gradientCount",function(){return this._currentLength/3})}(),function(){function oV(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}ov(oV,"laya.d3.core.particleShuriKen.module.GradientSize");var oo=oV.prototype;return oS.imps(oo,{"laya.d3.core.IClone":!0}),oo.getMaxSizeInGradient=function(){var oo=0,or=0,oT=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(oo=0,or=this._gradientX.gradientCount;oo<or;oo++)oT=Math.max(oT,this._gradientX.getValueByIndex(oo));for(oo=0,or=this._gradientY.gradientCount;oo<or;oo++)oT=Math.max(oT,this._gradientY.getValueByIndex(oo))}else for(oo=0,or=this._gradient.gradientCount;oo<or;oo++)oT=Math.max(oT,this._gradient.getValueByIndex(oo));break;case 1:oT=this._separateAxes?(oT=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),oT=Math.max(oT,this._constantMinSeparate.y),Math.max(oT,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(oo=0,or=this._gradientXMin.gradientCount;oo<or;oo++)oT=Math.max(oT,this._gradientXMin.getValueByIndex(oo));for(oo=0,or=this._gradientXMax.gradientCount;oo<or;oo++)oT=Math.max(oT,this._gradientXMax.getValueByIndex(oo));for(oo=0,or=this._gradientYMin.gradientCount;oo<or;oo++)oT=Math.max(oT,this._gradientYMin.getValueByIndex(oo));for(oo=0,or=this._gradientZMax.gradientCount;oo<or;oo++)oT=Math.max(oT,this._gradientZMax.getValueByIndex(oo))}else{for(oo=0,or=this._gradientMin.gradientCount;oo<or;oo++)oT=Math.max(oT,this._gradientMin.getValueByIndex(oo));for(oo=0,or=this._gradientMax.gradientCount;oo<or;oo++)oT=Math.max(oT,this._gradientMax.getValueByIndex(oo))}}return oT},oo.cloneTo=function(oo){var or=oo;or._type=this._type,or._separateAxes=this._separateAxes,this._gradient.cloneTo(or._gradient),this._gradientX.cloneTo(or._gradientX),this._gradientY.cloneTo(or._gradientY),this._gradientZ.cloneTo(or._gradientZ),or._constantMin=this._constantMin,or._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(or._constantMinSeparate),this._constantMaxSeparate.cloneTo(or._constantMaxSeparate),this._gradientMin.cloneTo(or._gradientMin),this._gradientMax.cloneTo(or._gradientMax),this._gradientXMin.cloneTo(or._gradientXMin),this._gradientXMax.cloneTo(or._gradientXMax),this._gradientYMin.cloneTo(or._gradientYMin),this._gradientYMax.cloneTo(or._gradientYMax),this._gradientZMin.cloneTo(or._gradientZMin),this._gradientZMax.cloneTo(or._gradientZMax)},oo.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,oo,"gradientZ",function(){return this._gradientZ}),ox(0,oo,"gradient",function(){return this._gradient}),ox(0,oo,"separateAxes",function(){return this._separateAxes}),ox(0,oo,"type",function(){return this._type}),ox(0,oo,"gradientMin",function(){return this._gradientMin}),ox(0,oo,"constantMin",function(){return this._constantMin}),ox(0,oo,"gradientX",function(){return this._gradientX}),ox(0,oo,"gradientY",function(){return this._gradientY}),ox(0,oo,"gradientMax",function(){return this._gradientMax}),ox(0,oo,"constantMax",function(){return this._constantMax}),ox(0,oo,"constantMinSeparate",function(){return this._constantMinSeparate}),ox(0,oo,"constantMaxSeparate",function(){return this._constantMaxSeparate}),ox(0,oo,"gradientXMin",function(){return this._gradientXMin}),ox(0,oo,"gradientXMax",function(){return this._gradientXMax}),ox(0,oo,"gradientYMin",function(){return this._gradientYMin}),ox(0,oo,"gradientYMax",function(){return this._gradientYMax}),ox(0,oo,"gradientZMin",function(){return this._gradientZMin}),ox(0,oo,"gradientZMax",function(){return this._gradientZMax}),oV.createByGradient=function(oo){var or=new oV;return or._type=0,or._separateAxes=!1,or._gradient=oo,or},oV.createByGradientSeparate=function(oo,or,oT){var ok=new oV;return ok._type=0,ok._separateAxes=!0,ok._gradientX=oo,ok._gradientY=or,ok._gradientZ=oT,ok},oV.createByRandomTwoConstant=function(oo,or){var oT=new oV;return oT._type=1,oT._separateAxes=!1,oT._constantMin=oo,oT._constantMax=or,oT},oV.createByRandomTwoConstantSeparate=function(oo,or){var oT=new oV;return oT._type=1,oT._separateAxes=!0,oT._constantMinSeparate=oo,oT._constantMaxSeparate=or,oT},oV.createByRandomTwoGradient=function(oo,or){var oT=new oV;return oT._type=2,oT._separateAxes=!1,oT._gradientMin=oo,oT._gradientMax=or,oT},oV.createByRandomTwoGradientSeparate=function(oo,or,oT,ok,oW,oD){var on=new oV;return on._type=2,on._separateAxes=!0,on._gradientXMin=oo,on._gradientXMax=or,on._gradientYMin=oT,on._gradientYMax=ok,on._gradientZMin=oW,on._gradientZMax=oD,on},oV}()),oc=function(){function oV(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}ov(oV,"laya.d3.core.particleShuriKen.module.GradientVelocity");var oo=oV.prototype;return oS.imps(oo,{"laya.d3.core.IClone":!0}),oo.cloneTo=function(oo){var or=oo;or._type=this._type,this._constant.cloneTo(or._constant),this._gradientX.cloneTo(or._gradientX),this._gradientY.cloneTo(or._gradientY),this._gradientZ.cloneTo(or._gradientZ),this._constantMin.cloneTo(or._constantMin),this._constantMax.cloneTo(or._constantMax),this._gradientXMin.cloneTo(or._gradientXMin),this._gradientXMax.cloneTo(or._gradientXMax),this._gradientYMin.cloneTo(or._gradientYMin),this._gradientYMax.cloneTo(or._gradientYMax),this._gradientZMin.cloneTo(or._gradientZMin),this._gradientZMax.cloneTo(or._gradientZMax)},oo.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,oo,"gradientZ",function(){return this._gradientZ}),ox(0,oo,"constant",function(){return this._constant}),ox(0,oo,"type",function(){return this._type}),ox(0,oo,"gradientXMax",function(){return this._gradientXMax}),ox(0,oo,"constantMin",function(){return this._constantMin}),ox(0,oo,"gradientX",function(){return this._gradientX}),ox(0,oo,"gradientY",function(){return this._gradientY}),ox(0,oo,"gradientXMin",function(){return this._gradientXMin}),ox(0,oo,"constantMax",function(){return this._constantMax}),ox(0,oo,"gradientYMin",function(){return this._gradientYMin}),ox(0,oo,"gradientYMax",function(){return this._gradientYMax}),ox(0,oo,"gradientZMin",function(){return this._gradientZMin}),ox(0,oo,"gradientZMax",function(){return this._gradientZMax}),oV.createByConstant=function(oo){var or=new oV;return or._type=0,or._constant=oo,or},oV.createByGradient=function(oo,or,oT){var ok=new oV;return ok._type=1,ok._gradientX=oo,ok._gradientY=or,ok._gradientZ=oT,ok},oV.createByRandomTwoConstant=function(oo,or){var oT=new oV;return oT._type=2,oT._constantMin=oo,oT._constantMax=or,oT},oV.createByRandomTwoGradient=function(oo,or,oT,ok,oW,oD){var on=new oV;return on._type=3,on._gradientXMin=oo,on._gradientXMax=or,on._gradientYMin=oT,on._gradientYMax=ok,on._gradientZMin=oW,on._gradientZMax=oD,on},oV}(),oe=(function(){function oo(oo){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=oo}ov(oo,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var or=oo.prototype;oS.imps(or,{"laya.d3.core.IClone":!0}),or.cloneTo=function(oo){var or=oo;this._angularVelocity.cloneTo(or._angularVelocity),or.enbale=this.enbale},or.clone=function(){var oo;switch(this._angularVelocity.type){case 0:oo=this._angularVelocity.separateAxes?oX.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):oX.createByConstant(this._angularVelocity.constant);break;case 1:oo=this._angularVelocity.separateAxes?oX.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):oX.createByGradient(this._angularVelocity.gradient.clone());break;case 2:oo=this._angularVelocity.separateAxes?oX.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):oX.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:oo=this._angularVelocity.separateAxes?oX.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):oX.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var or=new this.constructor(oo);return or.enbale=this.enbale,or},ox(0,or,"angularVelocity",function(){return this._angularVelocity})}(),function(){function oo(){this.enable=!1,this.randomDirection=!1}ov(oo,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var or=oo.prototype;return oS.imps(or,{"laya.d3.core.IClone":!0}),or._getShapeBoundBox=function(oo){throw new Error("BaseShape: must override it.")},or._getSpeedBoundBox=function(oo){throw new Error("BaseShape: must override it.")},or.generatePositionAndDirection=function(oo,or,oT,ok){throw new Error("BaseShape: must override it.")},or._calculateProceduralBounds=function(oo,or,oT){this._getShapeBoundBox(oo);var ok=oo.min,oW=oo.max;onr.multiply(ok,or,ok),onr.multiply(oW,or,oW);var oD=new oQo(new onr,new onr);this.randomDirection?(oD.min=new onr(-1,-1,-1),oD.max=new onr(1,1,1)):this._getSpeedBoundBox(oD);var on=new oQo(new onr,new onr),oV=on.min,oL=on.max;onr.scale(oD.min,oT.y,oV),onr.scale(oD.max,oT.y,oL),onr.add(oo.min,oV,oV),onr.add(oo.max,oL,oL),onr.min(oo.min,oV,oo.min),onr.max(oo.max,oV,oo.max);var oU=new oQo(new onr,new onr),oh=oU.min,op=oU.max;onr.scale(oD.min,oT.x,oh),onr.scale(oD.max,oT.x,op),onr.min(oU.min,op,oV),onr.max(oU.min,op,oL),onr.min(oo.min,oV,oo.min),onr.max(oo.max,oV,oo.max)},or.cloneTo=function(oo){oo.enable=this.enable},or.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},oo}()),oN=function(){function oD(){}return ov(oD,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),oD._randomPointUnitArcCircle=function(oo,or,oT){var ok=or.elements,oW=NaN;oW=oT?oT.getFloat()*oo:Math.random()*oo,ok[0]=Math.cos(oW),ok[1]=Math.sin(oW)},oD._randomPointInsideUnitArcCircle=function(oo,or,oT){var ok=or.elements;oD._randomPointUnitArcCircle(oo,or,oT);var oW=NaN;oW=oT?Math.pow(oT.getFloat(),.5):Math.pow(Math.random(),.5),ok[0]=ok[0]*oW,ok[1]=ok[1]*oW},oD._randomPointUnitCircle=function(oo,or){var oT=oo.elements,ok=NaN;ok=or?or.getFloat()*Math.PI*2:Math.random()*Math.PI*2,oT[0]=Math.cos(ok),oT[1]=Math.sin(ok)},oD._randomPointInsideUnitCircle=function(oo,or){var oT=oo.elements;oD._randomPointUnitCircle(oo);var ok=NaN;ok=or?Math.pow(or.getFloat(),.5):Math.pow(Math.random(),.5),oT[0]=oT[0]*ok,oT[1]=oT[1]*ok},oD._randomPointUnitSphere=function(oo,or){var oT=oo.elements,ok=NaN,oW=NaN;oW=or?(ok=oT[2]=2*or.getFloat()-1,or.getFloat()*Math.PI*2):(ok=oT[2]=2*Math.random()-1,Math.random()*Math.PI*2);var oD=Math.sqrt(1-ok*ok);oT[0]=oD*Math.cos(oW),oT[1]=oD*Math.sin(oW)},oD._randomPointInsideUnitSphere=function(oo,or){var oT=oo.elements;oD._randomPointUnitSphere(oo);var ok=NaN;ok=or?Math.pow(or.getFloat(),1/3):Math.pow(Math.random(),1/3),oT[0]=oT[0]*ok,oT[1]=oT[1]*ok,oT[2]=oT[2]*ok},oD._randomPointInsideHalfUnitBox=function(oo,or){var oT=oo.elements;or?(oT[0]=or.getFloat()-.5,oT[1]=or.getFloat()-.5,oT[2]=or.getFloat()-.5):(oT[0]=Math.random()-.5,oT[1]=Math.random()-.5,oT[2]=Math.random()-.5)},oD}(),of=(function(){function oo(oo){this._size=null,this.enbale=!1,this._size=oo}ov(oo,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var or=oo.prototype;oS.imps(or,{"laya.d3.core.IClone":!0}),or.cloneTo=function(oo){var or=oo;this._size.cloneTo(or._size),or.enbale=this.enbale},or.clone=function(){var oo;switch(this._size.type){case 0:oo=this._size.separateAxes?oM.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):oM.createByGradient(this._size.gradient.clone());break;case 1:oo=this._size.separateAxes?oM.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):oM.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:oo=this._size.separateAxes?oM.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):oM.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var or=new this.constructor(oo);return or.enbale=this.enbale,or},ox(0,or,"size",function(){return this._size})}(),function(){function ok(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}ov(ok,"laya.d3.core.particleShuriKen.module.StartFrame");var oo=ok.prototype;return oS.imps(oo,{"laya.d3.core.IClone":!0}),oo.cloneTo=function(oo){var or=oo;or._type=this._type,or._constant=this._constant,or._constantMin=this._constantMin,or._constantMax=this._constantMax},oo.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,oo,"constant",function(){return this._constant}),ox(0,oo,"type",function(){return this._type}),ox(0,oo,"constantMin",function(){return this._constantMin}),ox(0,oo,"constantMax",function(){return this._constantMax}),ok.createByConstant=function(oo){var or=new ok;return or._type=0,or._constant=oo,or},ok.createByRandomTwoConstant=function(oo,or){var oT=new ok;return oT._type=1,oT._constantMin=oo,oT._constantMax=or,oT},ok}()),oa=(function(){function oo(oo,or){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new oDr(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=oo,this._startFrame=or}ov(oo,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var or=oo.prototype;oS.imps(or,{"laya.d3.core.IClone":!0}),or.cloneTo=function(oo){var or=oo;this.tiles.cloneTo(or.tiles),or.type=this.type,or.randomRow=this.randomRow,this._frame.cloneTo(or._frame),this._startFrame.cloneTo(or._startFrame),or.cycles=this.cycles,or.enableUVChannels=this.enableUVChannels,or.enable=this.enable},or.clone=function(){var oo,or;switch(this._frame.type){case 0:oo=oC.createByConstant(this._frame.constant);break;case 1:oo=oC.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:oo=oC.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:oo=oC.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:or=of.createByConstant(this._startFrame.constant);break;case 1:or=of.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var oT=new this.constructor(oo,or);return this.tiles.cloneTo(oT.tiles),oT.type=this.type,oT.randomRow=this.randomRow,oT.cycles=this.cycles,oT.enableUVChannels=this.enableUVChannels,oT.enable=this.enable,oT},ox(0,or,"frame",function(){return this._frame}),ox(0,or,"startFrame",function(){return this._startFrame})}(),function(){function oo(oo){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=oo}ov(oo,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var or=oo.prototype;oS.imps(or,{"laya.d3.core.IClone":!0}),or.cloneTo=function(oo){var or=oo;this._velocity.cloneTo(or._velocity),or.enbale=this.enbale,or.space=this.space},or.clone=function(){var oo;switch(this._velocity.type){case 0:oo=oc.createByConstant(this._velocity.constant.clone());break;case 1:oo=oc.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:oo=oc.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:oo=oc.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var or=new this.constructor(oo);return or.enbale=this.enbale,or.space=this.space,or},ox(0,or,"velocity",function(){return this._velocity})}(),function(){function oo(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new oir,this._vb=oer.create(oo._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=ocr.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=oOr.nameKey.getID("LINE"),this._shaderCompile=oFr._preCompileShader[this._sharderNameID]}ov(oo,"laya.d3.core.PhasorSpriter3D");var or=oo.prototype;return or.line=function(oo,or,oT,ok){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(oo.x,oo.y,oo.z,or.x,or.y,or.z,or.w),this.addVertex(oT.x,oT.y,oT.z,ok.x,ok.y,ok.z,ok.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},or.circle=function(oo,or,oT,ok,oW,oD){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*or,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/or,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*oo,Math.cos(this._tempNumver0)*oo,0,oT,ok,oW,oD),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},or.plane=function(oo,or,oT,ok,oW,oD,on,oV,oL){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=ok/2,this._tempNumver1=oW/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(oo-this._tempNumver0,or+this._tempNumver1,oT,oD,on,oV,oL),this.addVertex(oo+this._tempNumver0,or+this._tempNumver1,oT,oD,on,oV,oL),this.addVertex(oo-this._tempNumver0,or-this._tempNumver1,oT,oD,on,oV,oL),this.addVertex(oo+this._tempNumver0,or-this._tempNumver1,oT,oD,on,oV,oL),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},or.box=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=ok/2,this._tempNumver1=oW/2,this._tempNumver2=oD/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(oo-this._tempNumver0,or+this._tempNumver1,oT+this._tempNumver2,on,oV,oL,oU),this.addVertex(oo+this._tempNumver0,or+this._tempNumver1,oT+this._tempNumver2,on,oV,oL,oU),this.addVertex(oo-this._tempNumver0,or-this._tempNumver1,oT+this._tempNumver2,on,oV,oL,oU),this.addVertex(oo+this._tempNumver0,or-this._tempNumver1,oT+this._tempNumver2,on,oV,oL,oU),this.addVertex(oo+this._tempNumver0,or+this._tempNumver1,oT-this._tempNumver2,on,oV,oL,oU),this.addVertex(oo-this._tempNumver0,or+this._tempNumver1,oT-this._tempNumver2,on,oV,oL,oU),this.addVertex(oo+this._tempNumver0,or-this._tempNumver1,oT-this._tempNumver2,on,oV,oL,oU),this.addVertex(oo-this._tempNumver0,or-this._tempNumver1,oT-this._tempNumver2,on,oV,oL,oU),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},or.cone=function(oo,or,oT,ok,oW,oD,on){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*oT+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*oT>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/oT,this.addVertexIndex(0,or,0,ok,oW,oD,on,this._tempUint0),this.addVertexIndex(0,0,0,ok,oW,oD,on,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<oT;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(oo*this._tempNumver2,0,oo*this._tempNumver3,ok,oW,oD,on,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==oT-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(oo*this._tempNumver2,0,oo*this._tempNumver3,ok,oW,oD,on,this._tempUint0+(this._tempInt0+oT)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==oT-1?this.addIndexes(this._tempUint1+oT+2):this.addIndexes(this._tempUint1+this._tempInt0+oT+1),this.addIndexes(this._tempUint1+this._tempInt0+oT),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},or.boundingBoxLine=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(oo,oW,oD,on,oV,oL,oU),this.addVertex(ok,oW,oD,on,oV,oL,oU),this.addVertex(oo,or,oD,on,oV,oL,oU),this.addVertex(ok,or,oD,on,oV,oL,oU),this.addVertex(ok,oW,oT,on,oV,oL,oU),this.addVertex(oo,oW,oT,on,oV,oL,oU),this.addVertex(ok,or,oT,on,oV,oL,oU),this.addVertex(oo,or,oT,on,oV,oL,oU),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},or.addVertex=function(oo,or,oT,ok,oW,oD,on){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=oo,this._vbData[this._posInVBData+1]=or,this._vbData[this._posInVBData+2]=oT,this._vbData[this._posInVBData+3]=ok,this._vbData[this._posInVBData+4]=oW,this._vbData[this._posInVBData+5]=oD,this._vbData[this._posInVBData+6]=on,this._posInVBData+=this._floatSizePerVer,this},or.addVertexIndex=function(oo,or,oT,ok,oW,oD,on,oV){return this._hasBegun||this.addVertexIndexException(),this._vbData[oV]=oo,this._vbData[oV+1]=or,this._vbData[oV+2]=oT,this._vbData[oV+3]=ok,this._vbData[oV+4]=oW,this._vbData[oV+5]=oD,this._vbData[oV+6]=on,(oV+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=oV),this},or.addIndexes=function(oo){var or=arguments;this._hasBegun||this.addVertexIndexException();for(var oT=0;oT<or.length;oT++)this._ibData[this._posInIBData]=or[oT],this._posInIBData++;return this},or.begin=function(oo,or){return this._hasBegun&&this.beginException0(),1!==oo&&4!==oo&&this.beginException1(),this._primitiveType=oo,this._camera=or,this._hasBegun=!0,this},or.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},or.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(oo._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),oF.drawCall++,ou.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},or.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},or.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},or.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},or.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},or.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},or.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(28,[new ono(0,"vector3",0),new ono(12,"vector4",1)])}]),oo}()),oG=function(){function oo(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++oo._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new oir}ov(oo,"laya.d3.core.render.RenderElement");var or=oo.prototype;return or.getDynamicBatchBakedVertexs=function(oo){for(var or=this._renderObj._getVertexBuffer(oo),oT=or.getData().slice(),ok=or.vertexDeclaration,oW=ok.getVertexElementByUsage(0).offset/4,oD=ok.getVertexElementByUsage(3).offset/4,on=this._sprite3D.transform,oV=on.worldMatrix,oL=on.rotation,oU=ok.vertexStride/4,oh=0,op=oT.length;oh<op;oh+=oU){var oi=oh+oW,ov=oh+oD;o_r.transformVector3ArrayToVector3ArrayCoordinate(oT,oi,oV,oT,oi),o_r.transformVector3ArrayByQuat(oT,ov,oL,oT,ov)}return oT},or.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},or._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},ox(0,or,"id",function(){return this._id}),ox(0,or,"renderObj",function(){return this._renderObj},function(oo){this._renderObj!==oo&&(this._renderObj=oo)}),oo._uniqueIDCounter=0,oo}(),ow=function(){function or(oo){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++or._uniqueIDCounter,this._needSort=!1,this._scene=oo,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}ov(or,"laya.d3.core.render.RenderQueue");var oo=or.prototype;return oo._sortOpaqueFunc=function(oo,or){if(oo._render&&or._render){var oT=oo._material.renderQueue-or._material.renderQueue;return 0==oT?oo._render._distanceForSort-or._render._distanceForSort:oT}return 0},oo._sortAlphaFunc=function(oo,or){if(oo._render&&or._render){var oT=oo._material.renderQueue-or._material.renderQueue;return 0==oT?or._render._distanceForSort-oo._render._distanceForSort:oT}return 0},oo._begainRenderElement=function(oo,or,oT){return!!or._beforeRender(oo)},oo._sortAlpha=function(oo){or._cameraPosition=oo,this._finalElements.sort(this._sortAlphaFunc)},oo._sortOpaque=function(oo){or._cameraPosition=oo,this._finalElements.sort(this._sortOpaqueFunc)},oo._preRender=function(oo){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},oo._render=function(oo,or){for(var oT,ok,oW,oD,on,oV,oL=oF.loopCount,oU=this._scene,oh=oo.camera,op=(oh.id,!1),oi=0,ov=this._finalElements.length;oi<ov;oi++){var ox,oj,o_,oK=this._finalElements[oi];if(null!=oK._onPreRenderFunction&&oK._onPreRenderFunction.call(oK._sprite3D,oo),0===oK._type){if(oo.owner=o_=oK._sprite3D,oo.renderElement=oK,o_._preRenderUpdateComponents(oo),ox=oK.renderObj,oj=oK._material,this._begainRenderElement(oo,ox,oj)){if(oT=ox._getVertexBuffers(),!(oW=(ok=ox._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[ok.id]){this._errorRecord[ok.id]=1;var o$="vertexBuffer:"+("("+ok._destroyed+","+ok._released+","+ok._referenceCount+","+ok._buffer+")")+", material:"+(oj?oj.__className+"("+oj._destroyed+","+oj._released+")":"null")+", owner:"+(o_?o_.__className+"("+o_._destroyed+","+o_._activeInHierarchy+","+o_._displayedInStage+")":"null")+", renderObj:"+(ox?ox.__className+"("+ox._destroyed+","+ox._released+","+ox._referenceCount+")":"")+", parent:, url:"+(o_?o_.url:"")+", disposeStack:"+ok.disposeStack;oS.recordError("报错：unknown vertexDeclaration  "+o$)}continue}if(op=(oD=oo._shader=oj._getShader(oU._shaderDefineValue,oW.shaderDefineValue,o_._shaderDefineValue)).bind()||oL!==oD._uploadLoopCount,oT){if(oD._uploadVertexBuffer!==oT||op){for(var oy=0;oy<oT.length;oy++){var ol=oT[oy];oD.uploadAttributesX(ol.vertexDeclaration.shaderValues.data,ol)}oD._uploadVertexBuffer=oT}}else(oD._uploadVertexBuffer!==ok||op)&&(oD.uploadAttributes(oW.shaderValues.data,null),oD._uploadVertexBuffer=ok);(oD._uploadScene!==oU||op)&&(oD.uploadSceneUniforms(oU._shaderValues.data),oD._uploadScene=oU),(oh!==oD._uploadCamera||oD._uploadSprite3D!==o_||op)&&(oD.uploadSpriteUniforms(o_._shaderValues.data),oD._uploadSprite3D=o_),(oh!==oD._uploadCamera||op)&&(oD.uploadCameraUniforms(oh._shaderValues.data),oD._uploadCamera=oh),(oD._uploadMaterial!==oj||op)&&(oj._upload(),oD._uploadMaterial=oj),on!==oj?(oj._setRenderStateBlendDepth(),oj._setRenderStateFrontFace(or,o_.transform),on=oj,oV=o_):oV!==o_&&(oj._setRenderStateFrontFace(or,o_.transform),oV=o_),ox._render(oo),oD._uploadLoopCount=oL}o_._postRenderUpdateComponents(oo)}else if(2===oK._type){oK.renderObj;oo.owner=o_=oK._sprite3D,oo.renderElement=oK,oo._batchIndexStart=oK._tempBatchIndexStart,oo._batchIndexEnd=oK._tempBatchIndexEnd,ox=oK.renderObj,oj=oK._material,this._begainRenderElement(oo,ox,oj)&&(oW=(ok=ox._getVertexBuffer(0)).vertexDeclaration,op=(oD=oo._shader=oj._getShader(oU._shaderDefineValue,oW.shaderDefineValue,o_._shaderDefineValue)).bind()||oL!==oD._uploadLoopCount,(oD._uploadVertexBuffer!==ok||op)&&(oD.uploadAttributes(oW.shaderValues.data,null),oD._uploadVertexBuffer=ok),(oD._uploadScene!==oU||op)&&(oD.uploadSceneUniforms(oU._shaderValues.data),oD._uploadScene=oU),(oh!==oD._uploadCamera||oD._uploadSprite3D!==o_||op)&&(oD.uploadSpriteUniforms(o_._shaderValues.data),oD._uploadSprite3D=o_),(oh!==oD._uploadCamera||op)&&(oD.uploadCameraUniforms(oh._shaderValues.data),oD._uploadCamera=oh),(oD._uploadMaterial!==oj||op)&&(oj._upload(),oD._uploadMaterial=oj),on!==oj?(oj._setRenderStateBlendDepth(),oj._setRenderStateFrontFace(or,o_.transform),on=oj,oV=o_):oV!==o_&&(oj._setRenderStateFrontFace(or,o_.transform),oV=o_),ox._render(oo),oD._uploadLoopCount=oL)}}},oo._renderShadow=function(oo,or){for(var oT,ok,oW,oD,on,oV=oF.loopCount,oL=this._scene,oU=oo.camera,oh=!1,op=0,oi=this._finalElements.length;op<oi;op++){var ov,ox,oj,o_=this._finalElements[op];0===o_._type&&(oo.owner=oj=o_._sprite3D,or||oj._projectionViewWorldUpdateCamera===oU&&oj._projectionViewWorldUpdateLoopCount===oF.loopCount||(oj._render._renderUpdate(oo._projectionViewMatrix),oj._projectionViewWorldUpdateLoopCount=oF.loopCount,oj._projectionViewWorldUpdateCamera=oU),oo.renderElement=o_,oj._preRenderUpdateComponents(oo),ov=o_.renderObj,ox=o_._material,this._begainRenderElement(oo,ov,null)&&(ok=(oT=ov._getVertexBuffer(0)).vertexDeclaration,oh=(oW=oo._shader=ox._getShader(oL._shaderDefineValue,ok.shaderDefineValue,oj._shaderDefineValue)).bind()||oV!==oW._uploadLoopCount,(oW._uploadVertexBuffer!==oT||oh)&&(oW.uploadAttributes(ok.shaderValues.data,null),oW._uploadVertexBuffer=oT),(oU!==oW._uploadCamera||oW._uploadSprite3D!==oj||oh)&&(oW.uploadSpriteUniforms(oj._shaderValues.data),oW._uploadSprite3D=oj),(oU!==oW._uploadCamera||oh)&&(oW.uploadCameraUniforms(oU._shaderValues.data),oW._uploadCamera=oU),(oW._uploadMaterial!==ox||oh)&&(ox._upload(),oW._uploadMaterial=ox),oW._uploadRenderElement,oD!==ox?(ox._setRenderStateFrontFace(!1,oj.transform),oD=ox,on=oj):on!==oj&&(ox._setRenderStateFrontFace(!1,oj.transform),on=oj),ov._render(oo),oW._uploadLoopCount=oV),oj._postRenderUpdateComponents(oo))}},oo._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},oo._addRenderElement=function(oo){this._renderElements.push(oo),this._needSort=!0},oo._addDynamicBatchElement=function(oo){this._dynamicBatchCombineRenderElements.push(oo)},ox(0,oo,"id",function(){return this._id}),or._uniqueIDCounter=0,or._cameraPosition=null,or}(),oZ=function(){function oo(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return ov(oo,"laya.d3.core.render.RenderState"),oo.clientWidth=0,oo.clientHeight=0,oo}(),oQ=function(){function on(oo,or){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new oBo(new onr,0),this._corners=[new onr,new onr,new onr,new onr,new onr,new onr,new onr,new onr],this._boundingBoxCenter=new onr,this._children=ok(8),this._objects=[],this._tempBoundBoxCorners=[new onr,new onr,new onr,new onr,new onr,new onr,new onr,new onr],this._scene=oo,this._currentDepth=or}ov(on,"laya.d3.core.scene.OctreeNode");var oo=on.prototype;return oS.imps(oo,{"laya.d3.core.scene.ITreeNode":!0}),oo.init=function(oo,or){var oT=new onr,ok=new onr;onr.scale(or,-.5,oT),onr.scale(or,.5,ok),onr.add(oT,oo,oT),onr.add(ok,oo,ok),this.exactBox=new oQo(oT,ok),this.relaxBox=new oQo(oT,ok)},oo.addTreeNode=function(oo){1===Collision.boxContainsBox(this._relaxBox,oo.boundingBox)?this.addNodeDown(oo,0):this.addObject(oo)},oo.addChild=function(oo){var or=this._children[oo];if(null==or){or=new on(this._scene,this._currentDepth+1),(this._children[oo]=or)._parent=this,onr.subtract(this._exactBox.max,this._exactBox.min,on.tempSize),onr.multiply(on.tempSize,on._octreeSplit[oo],on.tempCenter),onr.add(this._exactBox.min,on.tempCenter,on.tempCenter),onr.scale(on.tempSize,.25,on.tempSize);var oT=new onr,ok=new onr;onr.subtract(on.tempCenter,on.tempSize,oT),onr.add(on.tempCenter,on.tempSize,ok),or.exactBox=new oQo(oT,ok),onr.scale(on.tempSize,on.relax,on.tempSize);var oW=new onr,oD=new onr;onr.subtract(on.tempCenter,on.tempSize,oW),onr.add(on.tempCenter,on.tempSize,oD),or.relaxBox=new oQo(oW,oD)}return or},oo.addObject=function(oo){(oo._treeNode=this)._objects.push(oo)},oo.removeObject=function(oo){if(oo._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var or=this._objects.indexOf(oo);return-1!==or&&(this._objects.splice(or,1),!0)},oo.clearObject=function(){this._objects.length=0},oo.addNodeUp=function(oo,or){this._parent&&1!==Collision.boxContainsBox(this._exactBox,oo.boundingBox)?this._parent.addNodeUp(oo,or-1):this.addNodeDown(oo,or)},oo.addNodeDown=function(oo,or){if(or<this._scene.treeLevel){var oT=this.inChildIndex(oo.boundingBoxCenter),ok=this.addChild(oT);1===Collision.boxContainsBox(ok._relaxBox,oo.boundingBox)?ok.addNodeDown(oo,++or):this.addObject(oo)}else this.addObject(oo)},oo.inChildIndex=function(oo){return 4*(oo.z<this._boundingBoxCenter.z?0:1)+2*(oo.y<this._boundingBoxCenter.y?0:1)+(oo.x<this._boundingBoxCenter.x?0:1)},oo.updateObject=function(oo){1===Collision.boxContainsBox(this._relaxBox,oo.boundingBox)?(this.removeObject(oo),oo._treeNode=null,this.addNodeDown(oo,this._currentDepth)):this._parent&&(this.removeObject(oo),oo._treeNode=null,this._parent.addNodeUp(oo,this._currentDepth-1))},oo.cullingObjects=function(oo,or,oT,ok,oW){var oD,on=0,oV=0,oL=0,oU=this._scene._dynamicBatchManager;for(on=0,oD=this._objects.length;on<oD;on++){var oh=this._objects[on];if(om.isVisible(oh._owner.layer.mask)&&oh.enable){if(or&&(oF.treeSpriteCollision+=1,0===oo.containsBoundSphere(oh.boundingSphere)))continue;oh._renderUpdate(oW),oh._distanceForSort=onr.distance(oh.boundingSphere.center,ok)+oh.sortingFudge;var op=oh._renderElements;for(oV=0,oL=op.length;oV<oL;oV++){var oi=op[oV],ov=oi._staticBatch;if(ov&&ov._material===oi._material)ov._addBatchRenderElement(oi);else{var ox=oi.renderObj;ox.triangleCount<10&&1===ox._vertexBufferCount&&ox._getIndexBuffer()&&oi._material.renderQueue<2&&oi._canDynamicBatch&&!oh._owner.isStatic?oU._addPrepareRenderElement(oi):this._scene.getRenderQueue(oi._material.renderQueue)._addRenderElement(oi)}}}}for(on=0;on<8;on++){var oj=this._children[on];if(null!=oj){var o_=or;if(or){var oK=oo.containsBoundBox(oj._relaxBox);if(oF.treeNodeCollision+=1,0===oK)continue;o_=2===oK}oj.cullingObjects(oo,o_,oT,ok,oW)}}},oo.cullingShadowObjects=function(oo,or,oT,ok,oW){var oD,on=0,oV=0,oL=0;this._scene._dynamicBatchManager;for(on=0,oD=this._objects.length;on<oD;on++){var oU=this._objects[on];if(oU.castShadow&&om.isVisible(oU._owner.layer.mask)&&oU.enable){if(oT&&0===oo[0].containsBoundSphere(oU.boundingSphere))continue;for(var oh=1,op=oo.length;oh<op;oh++){var oi=or[oh-1];if(0!==oo[oh].containsBoundSphere(oU.boundingSphere)){var ov=oU._renderElements;for(oV=0,oL=ov.length;oV<oL;oV++)oi._addRenderElement(ov[oV])}}}}for(on=0;on<8;on++){var ox=this._children[on];if(null!=ox){var oj=oT;if(oT){var o_=oo[0].containsBoundBox(ox._relaxBox);if(0===o_)continue;oj=2===o_}ox.cullingShadowObjects(oo,or,oj,ok,oW)}}},oo.cullingShadowObjectsOnePSSM=function(oo,or,oT,ok,oW,oD){var on,oV=or[0],oL=0,oU=0,oh=0;for(oL=0,on=this._objects.length;oL<on;oL++){var op=this._objects[oL];if(op.castShadow&&om.isVisible(op._owner.layer.mask)&&op.enable){if(ok&&0===oo.containsBoundSphere(op.boundingSphere))continue;op._renderUpdate(oT);var oi=op._renderElements;for(oU=0,oh=oi.length;oU<oh;oU++)oV._addRenderElement(oi[oU])}}for(oL=0;oL<8;oL++){var ov=this._children[oL];if(null!=ov){var ox=ok;if(ok){var oj=oo.containsBoundBox(ov._relaxBox);if(0===oj)continue;ox=2===oj}ov.cullingShadowObjectsOnePSSM(oo,or,oT,ox,oW,oD)}}},oo.renderBoudingBox=function(oo){this._renderBoudingBox(oo);for(var or=0;or<8;++or){var oT=this._children[or];oT&&oT.renderBoudingBox(oo)}},oo.buildAllChild=function(oo){if(oo<this._scene.treeLevel)for(var or=0;or<8;or++){this.addChild(or).buildAllChild(oo+1)}},oo._renderBoudingBox=function(oo){},ox(0,oo,"exactBox",function(){return this._exactBox},function(oo){this._exactBox=oo,onr.add(oo.min,oo.max,this._boundingBoxCenter),onr.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),ox(0,oo,"relaxBox",function(){return this._relaxBox},function(oo){(this._relaxBox=oo).getCorners(this._corners),oBo.createfromPoints(this._corners,this._boundingSphere)}),on.debugMode=!1,on.relax=1.15,on.CHILDNUM=8,op(on,["tempVector0",function(){return this.tempVector0=new onr},"tempSize",function(){return this.tempSize=new onr},"tempCenter",function(){return this.tempCenter=new onr},"_octreeSplit",function(){return this._octreeSplit=[new onr(.25,.25,.25),new onr(.75,.25,.25),new onr(.25,.75,.25),new onr(.75,.75,.25),new onr(.25,.25,.75),new onr(.75,.25,.75),new onr(.25,.75,.75),new onr(.75,.75,.75)]}]),on}(),og=(function(){function oo(){}ov(oo,"laya.d3.core.scene.SceneManager")}(),function(){function oo(oo,or,oT,ok){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===oo&&(oo=1),void 0===or&&(or=1),void 0===oT&&(oT=1),void 0===ok&&(ok=1),this._r=oo,this._g=or,this._b=oT,this._a=ok}return ov(oo,"laya.d3.core.trail.module.Color",null,"Color$1"),oo.prototype.cloneTo=function(oo){oo._r=this._r,oo._g=this._g,oo._b=this._b,oo._a=this._a},op(oo,["RED",function(){return this.RED=new oo(1,0,0,1)},"GREEN",function(){return this.GREEN=new oo(0,1,0,1)},"BLUE",function(){return this.BLUE=new oo(0,0,1,1)},"CYAN",function(){return this.CYAN=new oo(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new oo(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new oo(1,0,1,1)},"GRAY",function(){return this.GRAY=new oo(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new oo(1,1,1,1)},"BLACK",function(){return this.BLACK=new oo(0,0,0,1)}]),oo}()),oB=(function(){function oo(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}ov(oo,"laya.d3.core.trail.module.Gradient");var or=oo.prototype;or.setKeys=function(oo,or){var oT,ok;this._colorKeys=oo;for(var oW=this.index=0;oW<oo.length;oW++){var oD=(oT=oo[oW]).color;this._colorKeyData[this.index++]=oD._r,this._colorKeyData[this.index++]=oD._g,this._colorKeyData[this.index++]=oD._b,this._colorKeyData[this.index++]=oT.time}this._alphaKeys=or;for(var on=this.index=0;on<or.length;on++)ok=or[on],this._alphaKeyData[this.index++]=ok.alpha,this._alphaKeyData[this.index++]=ok.time},or.cloneTo=function(oo){var or=0,oT=0,ok=this.colorKeys,oW=[];for(or=0,oT=ok.length;or<oT;or++){var oD=new oE;ok[or].cloneTo(oD),oW.push(oD)}var on=this.alphaKeys,oV=[];for(or=0,oT=on.length;or<oT;or++){var oL=new oB;on[or].cloneTo(oL),oV.push(oL)}oo.setKeys(oW,oV)},ox(0,or,"mode",function(){return this._mode},function(oo){this._mode=oo}),ox(0,or,"colorKeys",function(){return this._colorKeys},function(oo){this._colorKeys=oo;for(var or=this.index=0;or<oo.length;or++){var oT=oo[or],ok=oT.color;this._colorKeyData[this.index++]=ok._r,this._colorKeyData[this.index++]=ok._g,this._colorKeyData[this.index++]=ok._b,this._colorKeyData[this.index++]=oT.time}}),ox(0,or,"alphaKeys",function(){return this._alphaKeys},function(oo){this._alphaKeys=oo;for(var or=this.index=0;or<oo.length;or++){var oT=oo[or];this._alphaKeyData[this.index++]=oT.alpha,this._alphaKeyData[this.index++]=oT.time}})}(),function(){function oo(oo,or){this._alpha=NaN,this._time=NaN,void 0===oo&&(oo=0),void 0===or&&(or=0),this._alpha=oo,this._time=or}ov(oo,"laya.d3.core.trail.module.GradientAlphaKey");var or=oo.prototype;return or.cloneTo=function(oo){oo.alpha=this.alpha,oo.time=this.time},ox(0,or,"alpha",function(){return this._alpha},function(oo){this._alpha=oo}),ox(0,or,"time",function(){return this._time},function(oo){this._time=oo}),oo}()),oE=function(){function oo(oo,or){this._color=null,this._time=NaN,void 0===or&&(or=0),this._color=oo||new og,this._time=or}ov(oo,"laya.d3.core.trail.module.GradientColorKey");var or=oo.prototype;return or.cloneTo=function(oo){this.color.cloneTo(oo.color),oo.time=this.time},ox(0,or,"color",function(){return this._color},function(oo){this._color=oo}),ox(0,or,"time",function(){return this._time},function(oo){this._time=oo}),oo}(),od=(function(){function oo(){}ov(oo,"laya.d3.core.trail.module.GradientMode"),oo.Blend=0,oo.Fixed=1}(),function(){function oo(){}ov(oo,"laya.d3.core.trail.module.TextureMode"),oo.Stretch=0,oo.Tile=1}(),function(){function oo(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}ov(oo,"laya.d3.core.trail.module.TrailKeyFrame"),oo.prototype.cloneTo=function(oo){oo.time=this.time,oo.inTangent=this.inTangent,oo.outTangent=this.outTangent,oo.value=this.value}}(),function(){function or(oo){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new onr,this._curPosition=new onr,this._delVector3=new onr,this._lastFixedVertexPosition=new onr,this._pointAtoBVector3=new onr,this._pointA=new onr,this._pointB=new onr,this._owner=oo,this._id=or.renderElementCount++,0==this._id?oo._owner.transform.position.cloneTo(this._lastPosition):oo._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new oer(od.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new oer(od.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}ov(or,"laya.d3.core.trail.TrailRenderElement");var oo=or.prototype;oS.imps(oo,{"laya.d3.core.render.IRenderable":!0}),oo._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},oo._addTrailByFirstPosition=function(oo,or){onr.subtract(or,oo,this._delVector3),onr.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),onr.normalize(this._pointAtoBVector3,this._pointAtoBVector3),onr.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(oo),oo.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},oo._addTrailByNextPosition=function(oo){onr.subtract(oo,this._lastFixedVertexPosition,this._delVector3),onr.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),onr.normalize(this._pointAtoBVector3,this._pointAtoBVector3),onr.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=onr.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=oEo.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(oo),oo.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(oo),this._virtualVerticesCount=2)},oo._updateVerticesByPosition=function(oo){this._pointe=oo.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},oo._updateVertexBuffer2=function(){var oo,or=0,oT=0,ok=0;for(ok=0,oo=(this._verticesCount+this._virtualVerticesCount)/2;ok<oo;ok++)oT=0==this._owner.textureMode?(this._VerticesToTailLength[ok]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[ok],this._vertices2[or++]=1-oT,this._vertices2[or++]=1-oT;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},oo._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},oo._updateDisappear=function(){var oo,or=0;for(or=this._curDisappearIndex,oo=(this._verticesCount+this._virtualVerticesCount)/2;or<oo;or++)this._owner._curtime-this._everyGroupVertexBirthTime[or]>=this._owner.time+oEo.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},oo._beforeRender=function(oo){return this._camera=oo.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),onr.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},oo._render=function(oo){this._isDead||(ou.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),oF.drawCall++,oF.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},oo._getVertexBuffer=function(oo){return void 0===oo&&(oo=0),0===oo?this._vertexBuffer1:1===oo?this._vertexBuffer2:null},oo._getVertexBuffers=function(){return this._vertexBuffers},oo._getIndexBuffer=function(){return null},oo.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},oo._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},ox(0,oo,"_vertexBufferCount",function(){return this._vertexBuffers.length}),ox(0,oo,"triangleCount",function(){return 0}),or.renderElementCount=0}(),function(){function oo(){}ov(oo,"laya.d3.core.trail.VertexTrail");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration1}),ox(1,oo,"vertexDeclaration1",function(){return oo._vertexDeclaration1}),ox(1,oo,"vertexDeclaration2",function(){return oo._vertexDeclaration2}),op(oo,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new oDo(32,[new ono(0,"vector3",0),new ono(12,"vector3",41),new ono(24,"single",33),new ono(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new oDo(4,[new ono(0,"single",38)])}]),oo}()),ooo=function(){function ol(oo){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=oo}ov(ol,"laya.d3.graphics.DynamicBatch");var oo=ol.prototype;return oS.imps(oo,{"laya.d3.core.render.IRenderable":!0}),oo._getVertexBuffer=function(oo){return void 0===oo&&(oo=0),0===oo?this._vertexBuffer:null},oo._getIndexBuffer=function(){return this._indexBuffer},oo._getCombineRenderElementFromPool=function(oo,or,oT){var ok=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return ok||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=ok=new oG,ok._sprite3D=new owr),ok._sprite3D._render._renderUpdate(oT),ok},oo._getRenderElement=function(oo,or,oT){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*ol.maxVertexCount),this._indexDatas=new Uint16Array(ol.maxIndexCount),this._vertexBuffer=oer.create(this._vertexDeclaration,ol.maxVertexCount,35048),this._indexBuffer=ocr.create("ushort",ol.maxIndexCount,35048));for(var ok=this._merageElements.length=0,oW=0,oD=0,on=this._combineRenderElements.length;oD<on;oD++){var oV=this._combineRenderElements[oD],oL=oV.getDynamicBatchBakedVertexs(0),oU=oV.getBakedIndices(),oh=oV._sprite3D.transform._isFrontFaceInvert,op=ok/(this._vertexDeclaration.vertexStride/4),oi=oW,ov=oi+oU.length;oV._tempBatchIndexStart=oi,oV._tempBatchIndexEnd=ov,this._indexDatas.set(oU,oW);var ox=0;if(oh)for(ox=oi;ox<ov;ox+=3){this._indexDatas[ox]=op+this._indexDatas[ox];var oj=this._indexDatas[ox+1],o_=this._indexDatas[ox+2];this._indexDatas[ox+1]=op+o_,this._indexDatas[ox+2]=op+oj}else for(ox=oi;ox<ov;ox+=3)this._indexDatas[ox]=op+this._indexDatas[ox],this._indexDatas[ox+1]=op+this._indexDatas[ox+1],this._indexDatas[ox+2]=op+this._indexDatas[ox+2];oW+=oU.length,this._vertexDatas.set(oL,ok),ok+=oL.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),oD=this._combineRenderElementPoolIndex=0,on=this._materials.length;oD<on;oD++){var oK=this._getCombineRenderElementFromPool(oo,or,oT);oK._type=2,oK._staticBatch=null;var o$=(oK.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[oD]]._tempBatchIndexStart,oy=oD+1===this._materialToRenderElementsOffsets.length?oW:this._combineRenderElements[this._materialToRenderElementsOffsets[oD+1]]._tempBatchIndexStart;oK._tempBatchIndexStart=o$,oK._tempBatchIndexEnd=oy,oK._material=this._materials[oD],this._merageElements.push(oK)}},oo._addCombineRenderObjTest=function(oo){var or=oo.renderObj,oT=this._currentCombineIndexCount+or._getIndexBuffer().indexCount,ok=this._currentCombineVertexCount+or._getVertexBuffer().vertexCount;return!(ol.maxVertexCount<ok||ol.maxIndexCount<oT)},oo._addCombineRenderObj=function(oo){var or=oo.renderObj;this._combineRenderElements.push(oo),this._currentCombineIndexCount=this._currentCombineIndexCount+or._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+or._getVertexBuffer().vertexCount},oo._addCombineMaterial=function(oo){this._materials.push(oo)},oo._addMaterialToRenderElementOffset=function(oo){this._materialToRenderElementsOffsets.push(oo)},oo._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},oo._addToRenderQueue=function(oo,or,oT,ok){this._getRenderElement(or,oT,ok);for(var oW=0,oD=this._materials.length;oW<oD;oW++)oo.getRenderQueue(this._materials[oW].renderQueue)._addDynamicBatchElement(this._merageElements[oW])},oo._beforeRender=function(oo){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},oo._render=function(oo){var or=oo._batchIndexEnd-oo._batchIndexStart;ou.mainContext.drawElements(4,or,5123,2*oo._batchIndexStart),oF.drawCall++,oF.trianglesFaces+=or/3},oo._getVertexBuffers=function(){return null},ox(0,oo,"_vertexBufferCount",function(){return 1}),ox(0,oo,"triangleCount",function(){return this._indexBuffer.indexCount/3}),ox(0,oo,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),ol.maxVertexCount=2e4,ol.maxIndexCount=4e4,ol.maxCombineTriangleCount=10,ol}(),oro=function(){function ol(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}ov(ol,"laya.d3.graphics.DynamicBatchManager");var oo=ol.prototype;return oo.getDynamicBatch=function(oo,or){var oT,ok=oo.id.toString()+or;return this._dynamicBatches[ok]?oT=this._dynamicBatches[ok]:this._dynamicBatches[ok]=oT=new ooo(oo),oT},oo._garbageCollection=function(){for(var oo in this._dynamicBatches)0===this._dynamicBatches[oo].combineRenderElementsCount&&delete this._dynamicBatches[oo]},oo._addPrepareRenderElement=function(oo){this._prepareDynamicBatchCombineElements.push(oo)},oo._finishCombineDynamicBatch=function(oo){var or,oT,ok;this._prepareDynamicBatchCombineElements.sort(ol._sortPrepareDynamicBatch);for(var oW,oD,on,oV,oL,oU=-1,oh=!0,op=0,oi=-1,ov=0,ox=this._prepareDynamicBatchCombineElements.length;ov<ox;ov++){var oj=(oD=this._prepareDynamicBatchCombineElements[ov]).renderObj._getVertexBuffer(0).vertexDeclaration,o_=oT!==oj;o_&&(op=0,oT=oj);var oK=op!==oU;if(oK&&(oU=op),(o_||oK)&&(on=this.getDynamicBatch(oj,op),or=null),oh)if(on._addCombineRenderObjTest(oD)){if(or!==(oW=oD._material))oV&&(oo.getRenderQueue(oL._material.renderQueue)._addRenderElement(oL),oL=oV=null,oi=-1),oV=oW,oi=on.combineRenderElementsCount,oL=oD,or=oW;else if(oV){var o$=oL.renderObj,oy=oD.renderObj;o$._getVertexBuffer().vertexCount+oy._getVertexBuffer().vertexCount>ooo.maxVertexCount||o$._getIndexBuffer().indexCount+oy._getIndexBuffer().indexCount>ooo.maxIndexCount?(oo.getRenderQueue(oL._material.renderQueue)._addRenderElement(oL),oV=oW,oi=on.combineRenderElementsCount,oL=oD):(on._addCombineMaterial(oV),on._addMaterialToRenderElementOffset(oi),on._addCombineRenderObj(oL),oL=oV=null,oi=-1,on._addCombineRenderObj(oD))}else on._addCombineRenderObj(oD);oh=!0}else oV&&(oo.getRenderQueue(oL._material.renderQueue)._addRenderElement(oL),oL=oV=null,oi=-1),op++,oh=!1;else ok=this._prepareDynamicBatchCombineElements[ov-1],on._addMaterialToRenderElementOffset(on.combineRenderElementsCount),or=ok._material,on._addCombineMaterial(or),on._addCombineRenderObj(ok),oh=!0,or!==(oW=oD._material)?(oV=oW,oi=on.combineRenderElementsCount,oL=oD):on._addCombineRenderObj(oD),or=oW}oV&&(oo.getRenderQueue(oL._material.renderQueue)._addRenderElement(oL),oL=oV=null,oi=-1),this._prepareDynamicBatchCombineElements.length=0},oo._clearRenderElements=function(){for(var oo in this._dynamicBatches)this._dynamicBatches[oo]._clearRenderElements()},oo._addToRenderQueue=function(oo,or,oT,ok){for(var oW in this._dynamicBatches){var oD=this._dynamicBatches[oW];0<oD.combineRenderElementsCount&&oD._addToRenderQueue(oo,or,oT,ok)}},oo.dispose=function(){this._dynamicBatches=null},ol._sortPrepareDynamicBatch=function(oo,or){return oo._mainSortID-or._mainSortID},ol}(),oTo=function(){function oo(){}return ov(oo,"laya.d3.graphics.FrustumCulling"),oo.renderShadowObjectCulling=function(oo,or,oT,ok,oW){var oD=0,on=0,oV=0,oL=0;for(oD=0,oV=oT.length;oD<oV;oD++){var oU=oT[oD];oU&&oU._clearRenderElements()}var oh,op,oi,ov=oo._cullingRenders;if(1<oW){for(oD=0,oV=oo._cullingRendersLength;oD<oV;oD++)if((oh=ov[oD]).castShadow&&om.isVisible(oh._owner.layer.mask)&&oh.enable)for(var ox=1,oj=or.length;ox<oj;ox++)if(op=oT[ox-1],0!==or[ox].containsBoundSphere(oh.boundingSphere))for(on=0,oL=(oi=oh._renderElements).length;on<oL;on++)op._addRenderElement(oi[on])}else for(oD=0,oV=oo._cullingRendersLength;oD<oV;oD++)if((oh=ov[oD]).castShadow&&om.isVisible(oh._owner.layer.mask)&&oh.enable&&0!==or[0].containsBoundSphere(oh.boundingSphere))for(oh._renderUpdate(ok),op=oT[0],on=0,oL=(oi=oh._renderElements).length;on<oL;on++)op._addRenderElement(oi[on])},oo.renderShadowObjectCullingOctree=function(oo,or,oT,ok,oW){for(var oD=0,on=oT.length;oD<on;oD++){var oV=oT[oD];oV&&oV._clearRenderElements()}1<oW?oo.treeRoot.cullingShadowObjects(or,oT,!0,0,oo):oo.treeRoot.cullingShadowObjectsOnePSSM(or[0],oT,ok,!0,0,oo)},oo.renderObjectCulling=function(oo,or,oT,ok,oW,oD){var on=0,oV=0,oL=0,oU=0,oh=or._quenes,op=or._dynamicBatchManager,oi=or._cullingRenders;for(on=0,oV=oh.length;on<oV;on++){var ov=oh[on];ov&&ov._clearRenderElements()}var ox=oko._staticBatchManagers;for(on=0,oV=ox.length;on<oV;on++)ox[on]._clearRenderElements();op._clearRenderElements();var oj=oT.transform.position;for(on=0,oV=or._cullingRendersLength;on<oV;on++){var o_=oi[on];if(om.isVisible(o_._owner.layer.mask)&&o_.enable&&0!==oo.containsBoundSphere(o_.boundingSphere)&&o_._renderUpdate(oD)){o_._distanceForSort=onr.distance(o_.boundingSphere.center,oj)+o_.sortingFudge;var oK=o_._renderElements;for(oL=0,oU=oK.length;oL<oU;oL++){var o$=oK[oL],oy=o$._staticBatch;if(oy&&oy._material===o$._material)oy._addBatchRenderElement(o$);else{var ol=o$.renderObj;ol.triangleCount<10&&1===ol._vertexBufferCount&&ol._getIndexBuffer()&&o$._material.renderQueue<2&&o$._canDynamicBatch&&!o_._owner.isStatic?op._addPrepareRenderElement(o$):or.getRenderQueue(o$._material.renderQueue)._addRenderElement(o$)}}}}for(on=0,oV=ox.length;on<oV;on++)ox[on]._addToRenderQueue(or,ok,oW,oD);op._finishCombineDynamicBatch(or),op._addToRenderQueue(or,ok,oW,oD)},oo.renderObjectCullingOctree=function(oo,or,oT,ok,oW,oD){var on=0,oV=0,oL=or._quenes,oU=or._dynamicBatchManager;for(on=0,oV=oL.length;on<oV;on++){var oh=oL[on];oh&&oh._clearRenderElements()}var op=oko._staticBatchManagers;for(on=0,oV=op.length;on<oV;on++)op[on]._clearRenderElements();for(oU._clearRenderElements(),or._cullingRenders.length=0,or.treeRoot.cullingObjects(oo,!0,0,oT.transform.position,oD),on=0,oV=op.length;on<oV;on++)op[on]._addToRenderQueue(or,ok,oW,oD);oU._finishCombineDynamicBatch(or),oU._addToRenderQueue(or,ok,oW,oD)},oo.renderObjectCullingNoBoundFrustum=function(oo,or,oT,ok,oW){var oD=0,on=0,oV=0,oL=0,oU=oo._quenes,oh=oo._dynamicBatchManager,op=oo._cullingRenders;for(oD=0,on=oU.length;oD<on;oD++){var oi=oU[oD];oi&&oi._clearRenderElements()}var ov=oko._staticBatchManagers;for(oD=0,on=ov.length;oD<on;oD++)ov[oD]._clearRenderElements();oh._clearRenderElements();var ox=or.transform.position;for(oD=0,on=oo._cullingRendersLength;oD<on;oD++){var oj=op[oD];if(om.isVisible(oj._owner.layer.mask)&&oj.enable){oj._renderUpdate(oW),oj._distanceForSort=onr.distance(oj.boundingSphere.center,ox)+oj.sortingFudge;var o_=oj._renderElements;for(oV=0,oL=o_.length;oV<oL;oV++){var oK=o_[oV],o$=oK._staticBatch;if(o$&&o$._material===oK._material)o$._addBatchRenderElement(oK);else{var oy=oK.renderObj;oy.triangleCount<10&&1===oy._vertexBufferCount&&oy._getIndexBuffer()&&oK._material.renderQueue<2&&oK._canDynamicBatch&&!oj._owner.isStatic?oh._addPrepareRenderElement(oK):oo.getRenderQueue(oK._material.renderQueue)._addRenderElement(oK)}}}}for(oD=0,on=ov.length;oD<on;oD++)ov[oD]._addToRenderQueue(oo,oT,ok,oW);oh._finishCombineDynamicBatch(oo),oh._addToRenderQueue(oo,oT,ok,oW)},oo}(),oko=function(){function oD(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}ov(oD,"laya.d3.graphics.StaticBatchManager");var oo=oD.prototype;return oo._finishInit=function(){for(var oo in this._staticBatches)this._staticBatches[oo]._finishInit();this._initBatchRenderElements.length=0},oo._initStaticBatchs=function(oo){throw new Error("StaticBatchManager:must override this function.")},oo._addInitBatchSprite=function(oo){for(var or=oo._render._renderElements,oT=0,ok=or.length;oT<ok;oT++)this._initBatchRenderElements.push(or[oT])},oo._clearRenderElements=function(){for(var oo in this._staticBatches)this._staticBatches[oo]._clearRenderElements()},oo._garbageCollection=function(oo){var or=oo._staticBatch,oT=or._initBatchRenderElements,ok=oT.indexOf(oo);oT.splice(ok,1),0===oT.length&&(or.dispose(),delete this._staticBatches[or._key])},oo._addToRenderQueue=function(oo,or,oT,ok){for(var oW in this._staticBatches){var oD=this._staticBatches[oW];0<oD._batchRenderElements.length&&oD._updateToRenderQueue(oo,ok)}},oo.dispose=function(){this._staticBatches=null},oD._addToStaticBatchQueue=function(oo){oo instanceof laya.d3.core.RenderableSprite3D&&oo._addToInitStaticBatchManager();for(var or=0,oT=oo.numChildren;or<oT;or++)oD._addToStaticBatchQueue(oo._childs[or])},oD.combine=function(oo,or){var oT,ok=0,oW=0;if(or)for(ok=0,oW=or.length;ok<oW;ok++){or[ok]._addToInitStaticBatchManager()}else oo&&oD._addToStaticBatchQueue(oo);for(ok=0,oW=oD._staticBatchManagers.length;ok<oW;ok++)(oT=oD._staticBatchManagers[ok])._initStaticBatchs(oo),oT._finishInit()},oD._staticBatchManagers=[],oD}(),oWo=function(){function oo(oo,or,oT){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=oo,this._manager=or,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=oT}ov(oo,"laya.d3.graphics.StaticBatch");var or=oo.prototype;return oS.imps(or,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),or._binarySearch=function(oo){for(var or=0,oT=this._batchRenderElements.length-1,ok=0;or<=oT;)ok=Math.floor((or+oT)/2),this._compareBatchRenderElement(this._batchRenderElements[ok],oo)?oT=ok-1:or=ok+1;return or},or._compareBatchRenderElement=function(oo,or){throw new Error("StaticBatch:must override this function.")},or._getVertexDecLightMap=function(oo){return oo===oco.vertexDeclaration?omo.vertexDeclaration:oo===oMo.vertexDeclaration?ozo.vertexDeclaration:oo===oPo.vertexDeclaration?olo.vertexDeclaration:oo===oAo.vertexDeclaration?null:oo===ojo.vertexDeclaration?o_o.vertexDeclaration:oo===oJo.vertexDeclaration?oXo.vertexDeclaration:oo===ouo.vertexDeclaration?oso.vertexDeclaration:oo===oeo.vertexDeclaration?oCo.vertexDeclaration:oo===oMo.vertexDeclaration?ozo.vertexDeclaration:oo===oto.vertexDeclaration?oSo.vertexDeclaration:oo===oAo.vertexDeclaration?null:oo===ojo.vertexDeclaration?o_o.vertexDeclaration:oo===oYo.vertexDeclaration?oOo.vertexDeclaration:oo===ouo.vertexDeclaration?oso.vertexDeclaration:oo},or._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},or._addBatchRenderElement=function(oo){this._batchRenderElements.splice(this._binarySearch(oo),0,oo)},or._updateToRenderQueue=function(oo,or){this._combineRenderElementPoolIndex=0,this._getRenderElement(oo.getRenderQueue(this._material.renderQueue)._renderElements,oo,or)},or._getRenderElement=function(oo,or,oT){throw new Error("StaticBatch:must override this function.")},or._finishInit=function(){throw new Error("StaticBatch:must override this function.")},or._clearRenderElements=function(){this._batchRenderElements.length=0},or.dispose=function(){},or._getVertexBuffer=function(oo){return void 0===oo&&(oo=0),null},or._getIndexBuffer=function(){return null},or._beforeRender=function(oo){return!0},or._render=function(oo){},or._getVertexBuffers=function(){return null},ox(0,or,"_vertexBufferCount",function(){return 1}),ox(0,or,"triangleCount",function(){return 0}),oo.combine=function(oo){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),oko.combine(oo)},oo.maxBatchVertexCount=65535,oo}(),oDo=function(){function on(oo,or){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++on._uniqueIDCounter,this._id>on.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",on.maxVertexDeclaration);this._shaderValues=new oir,this._vertexElementsDic={},this._vertexStride=oo,this._vertexElements=or;for(var oT=0;oT<or.length;oT++){var ok=or[oT],oW=ok.elementUsage;this._vertexElementsDic[oW]=ok;var oD=[on._getTypeSize(ok.elementFormat)/4,5126,!1,this._vertexStride,ok.offset];switch(this._shaderValues.setValue(oW,oD),oW){case 1:this._addShaderDefine(oFr.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(oFr.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(oFr.SHADERDEFINE_UV1)}}}ov(on,"laya.d3.graphics.VertexDeclaration");var oo=on.prototype;return oo._addShaderDefine=function(oo){this._shaderDefineValue|=oo},oo._removeShaderDefine=function(oo){this._shaderDefineValue&=~oo},oo.getVertexElements=function(){return this._vertexElements.slice()},oo.getVertexElementByUsage=function(oo){return this._vertexElementsDic[oo]},oo.unBinding=function(){},ox(0,oo,"shaderDefineValue",function(){return this._shaderDefineValue}),ox(0,oo,"id",function(){return this._id}),ox(0,oo,"vertexStride",function(){return this._vertexStride}),ox(0,oo,"shaderValues",function(){return this._shaderValues}),on._getTypeSize=function(oo){switch(oo){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},on.getVertexStride=function(oo){for(var or=0,oT=0;oT<oo.Length;oT++){var ok=oo[oT],oW=ok.offset+on._getTypeSize(ok.elementFormat);or<oW&&(or=oW)}return or},on._maxVertexDeclarationBit=1e3,on._uniqueIDCounter=1,op(on,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),on}(),ono=function(){function oo(oo,or,oT){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=oo,this.elementFormat=or,this.elementUsage=oT}return ov(oo,"laya.d3.graphics.VertexElement"),oo}(),oVo=(function(){function oo(){}ov(oo,"laya.d3.graphics.VertexElementFormat"),oo.Single="single",oo.Vector2="vector2",oo.Vector3="vector3",oo.Vector4="vector4",oo.Color="color",oo.Byte4="byte4",oo.Short2="short2",oo.Short4="short4",oo.NormalizedShort2="normalizedshort2",oo.NormalizedShort4="normalizedshort4",oo.HalfVector2="halfvector2",oo.HalfVector4="halfvector4"}(),function(){function oo(){}ov(oo,"laya.d3.graphics.VertexElementUsage"),oo.POSITION0=0,oo.COLOR0=1,oo.TEXTURECOORDINATE0=2,oo.NORMAL0=3,oo.BINORMAL0=4,oo.TANGENT0=5,oo.BLENDINDICES0=6,oo.BLENDWEIGHT0=7,oo.DEPTH0=8,oo.FOG0=9,oo.POINTSIZE0=10,oo.SAMPLE0=11,oo.TESSELLATEFACTOR0=12,oo.COLOR1=13,oo.NEXTTEXTURECOORDINATE0=14,oo.TEXTURECOORDINATE1=15,oo.NEXTTEXTURECOORDINATE1=16,oo.CORNERTEXTURECOORDINATE0=17,oo.VELOCITY0=18,oo.STARTCOLOR0=19,oo.STARTSIZE=20,oo.AGEADDSCALE0=21,oo.STARTROTATION=22,oo.ENDCOLOR0=23,oo.STARTLIFETIME=24,oo.TIME0=33,oo.SHAPEPOSITIONSTARTLIFETIME=30,oo.DIRECTIONTIME=32,oo.SIZEROTATION0=27,oo.RADIUS0=28,oo.RADIAN0=29,oo.STARTSPEED=31,oo.RANDOM0=34,oo.RANDOM1=35,oo.SIMULATIONWORLDPOSTION=36,oo.SIMULATIONWORLDROTATION=37,oo.TEXTURECOORDINATE0X=38,oo.TEXTURECOORDINATE0X1=39,oo.TEXTURECOORDINATE0Y=40,oo.OFFSETVECTOR=41}(),function(){function oo(oo,or,oT){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=oo,this._textureCoordinate0=or,this._time=oT}ov(oo,"laya.d3.graphics.VertexGlitter");var or=oo.prototype;oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate0}),ox(0,or,"position",function(){return this._position}),ox(0,or,"time",function(){return this._time}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(24,[new ono(0,"vector3",0),new ono(12,"vector2",2),new ono(20,"single",33)])}])}(),function(){function oo(oo,or,oT,ok,oW,oD,on,oV,oL,oU){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=oo,this._position=or,this._velocity=oT,this._startColor=ok,this._endColor=oW,this._sizeRotation=oD,this._radius=on,this._radian=oV,this._ageAddScale=oL,this._time=oU}ov(oo,"laya.d3.graphics.VertexParticle");var or=oo.prototype;oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"endColor",function(){return this._endColor}),ox(0,or,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),ox(0,or,"sizeRotation",function(){return this._sizeRotation}),ox(0,or,"velocity",function(){return this._velocity}),ox(0,or,"position",function(){return this._position}),ox(0,or,"startColor",function(){return this._startColor}),ox(0,or,"radius",function(){return this._radius}),ox(0,or,"radian",function(){return this._radian}),ox(0,or,"ageAddScale",function(){return this._ageAddScale}),ox(0,or,"time",function(){return this._time}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(116,[new ono(0,"vector4",17),new ono(16,"vector3",0),new ono(28,"vector3",18),new ono(40,"vector4",19),new ono(56,"vector4",23),new ono(72,"vector3",27),new ono(84,"vector2",28),new ono(92,"vector4",29),new ono(108,"single",24),new ono(112,"single",33)])}])}(),function(){function oo(oo){this._position=null,this._position=oo}ov(oo,"laya.d3.graphics.VertexPosition");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"position",function(){return this._position}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(12,[new ono(0,"vector3",0)])}]),oo}()),oLo=function(){function oo(oo,or){this._position=null,this._normal=null,this._position=oo,this._normal=or}ov(oo,"laya.d3.graphics.VertexPositionNormal");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(24,[new ono(0,"vector3",0),new ono(12,"vector3",3)])}]),oo}(),oUo=function(){function oo(oo,or,oT){this._position=null,this._normal=null,this._color=null,this._position=oo,this._normal=or,this._color=oT}ov(oo,"laya.d3.graphics.VertexPositionNormalColor");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"color",function(){return this._color}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(40,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1)])}]),oo}(),oho=function(){function oo(oo,or,oT,ok,oW){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=oo,this._normal=or,this._color=oT,this._blendIndex=ok,this._blendWeight=oW}ov(oo,"laya.d3.graphics.VertexPositionNormalColorSkin");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(0,or,"color",function(){return this._color}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(72,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector4",7),new ono(56,"vector4",6)])}]),oo}(),opo=function(){function oo(oo,or,oT,ok,oW,oD){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=oo,this._normal=or,this._color=oT,this._tangent=ok,this._blendIndex=oW,this._blendWeight=oD}ov(oo,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(0,or,"color",function(){return this._color}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(88,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector4",7),new ono(56,"vector4",6),new ono(72,"vector4",5)])}]),oo}(),oio=function(){function oo(oo,or,oT,ok,oW,oD){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=oo,this._normal=or,this._color=oT,this._tangent=ok,this._blendIndex=oW,this._blendWeight=oD}ov(oo,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(0,or,"color",function(){return this._color}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(84,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector4",7),new ono(56,"vector4",6),new ono(72,"vector3",5)])}]),oo}(),ovo=function(){function oo(oo,or,oT,ok){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=oo,this._normal=or,this._color=oT,this._tangent=ok}ov(oo,"laya.d3.graphics.VertexPositionNormalColorSTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"color",function(){return this._color}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(56,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector4",5)])}]),oo}(),oxo=function(){function oo(oo,or,oT,ok){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=oo,this._normal=or,this._color=oT,this._tangent=ok}ov(oo,"laya.d3.graphics.VertexPositionNormalColorTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"color",function(){return this._color}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(52,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector3",5)])}]),oo}(),ojo=function(){function oo(oo,or,oT,ok){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=oo,this._normal=or,this._color=oT,this._textureCoordinate=ok}ov(oo,"laya.d3.graphics.VertexPositionNormalColorTexture");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"color",function(){return this._color}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(48,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector2",2)])}]),oo}(),o_o=function(){function oo(oo,or,oT,ok,oW){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=oo,this._normal=or,this._color=oT,this._textureCoordinate0=ok,this._textureCoordinate1=oW}ov(oo,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"color",function(){return this._color}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(0,or,"textureCoordinate1",function(){return this._textureCoordinate1}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(56,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector2",2),new ono(48,"vector2",15)])}]),oo}(),oKo=function(){function oo(oo,or,oT,ok,oW,oD,on){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=oo,this._normal=or,this._color=oT,this._textureCoordinate0=ok,this._textureCoordinate1=oW,this._blendIndex=oD,this._blendWeight=on}ov(oo,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(0,or,"color",function(){return this._color}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(0,or,"textureCoordinate1",function(){return this._textureCoordinate1}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(88,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector2",2),new ono(48,"vector2",15),new ono(56,"vector4",7),new ono(72,"vector4",6)])}]),oo}(),o$o=function(){function oo(oo,or,oT,ok,oW,oD,on,oV){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=oo,this._normal=or,this._color=oT,this._textureCoordinate0=ok,this._textureCoordinate1=oW,this._tangent=oD,this._blendIndex=on,this._blendWeight=oV}ov(oo,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(0,or,"color",function(){return this._color}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(0,or,"textureCoordinate1",function(){return this._textureCoordinate1}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(104,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector2",2),new ono(48,"vector2",15),new ono(56,"vector4",7),new ono(72,"vector4",6),new ono(88,"vector4",5)])}]),oo}(),oyo=function(){function oo(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}ov(oo,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),or.VertexPositionNormalColorTexture0SkinTangent=function(oo,or,oT,ok,oW,oD,on,oV){this._position=oo,this._normal=or,this._color=oT,this._textureCoordinate0=ok,this._textureCoordinate1=oW,this._tangent=oD,this._blendIndex=on,this._blendWeight=oV},ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(0,or,"color",function(){return this._color}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(0,or,"textureCoordinate1",function(){return this._textureCoordinate1}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(100,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector2",2),new ono(48,"vector2",15),new ono(56,"vector4",7),new ono(72,"vector4",6),new ono(88,"vector3",5)])}]),oo}(),olo=function(){function oo(oo,or,oT,ok,oW,oD){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=oo,this._normal=or,this._color=oT,this._textureCoordinate0=ok,this._textureCoordinate1=oW,this._tangent=oD}ov(oo,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"color",function(){return this._color}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(0,or,"textureCoordinate1",function(){return this._textureCoordinate1}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(72,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector2",2),new ono(48,"vector2",15),new ono(56,"vector4",5)])}]),oo}(),oSo=function(){function oo(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}ov(oo,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),or.VertexPositionNormalColorTexture0Tangent=function(oo,or,oT,ok,oW,oD){this._position=oo,this._normal=or,this._color=oT,this._textureCoordinate0=ok,this._textureCoordinate1=oW,this._tangent=oD},ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"color",function(){return this._color}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(0,or,"textureCoordinate1",function(){return this._textureCoordinate1}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(68,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector2",2),new ono(48,"vector2",15),new ono(56,"vector3",5)])}]),oo}(),oqo=function(){function oo(oo,or,oT,ok,oW,oD){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=oo,this._normal=or,this._color=oT,this._textureCoordinate=ok,this._blendIndex=oW,this._blendWeight=oD}ov(oo,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(0,or,"color",function(){return this._color}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(80,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector2",2),new ono(48,"vector4",7),new ono(64,"vector4",6)])}]),oo}(),obo=function(){function oo(oo,or,oT,ok,oW,oD,on){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=oo,this._normal=or,this._color=oT,this._textureCoordinate=ok,this._tangent=oW,this._blendIndex=oD,this._blendWeight=on}ov(oo,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(0,or,"color",function(){return this._color}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(96,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector2",2),new ono(48,"vector4",7),new ono(64,"vector4",6),new ono(80,"vector4",5)])}]),oo}(),oFo=function(){function oo(oo,or,oT,ok,oW,oD,on){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=oo,this._normal=or,this._color=oT,this._textureCoordinate=ok,this._tangent=oW,this._blendIndex=oD,this._blendWeight=on}ov(oo,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(0,or,"color",function(){return this._color}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(92,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector2",2),new ono(48,"vector4",7),new ono(64,"vector4",6),new ono(80,"vector3",5)])}]),oo}(),oPo=function(){function oo(oo,or,oT,ok,oW){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=oo,this._normal=or,this._color=oT,this._textureCoordinate=ok,this._tangent=oW}ov(oo,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"color",function(){return this._color}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(64,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector2",2),new ono(48,"vector4",5)])}]),oo}(),oto=function(){function oo(oo,or,oT,ok,oW){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=oo,this._normal=or,this._color=oT,this._textureCoordinate=ok,this._tangent=oW}ov(oo,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"color",function(){return this._color}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(60,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",1),new ono(40,"vector2",2),new ono(48,"vector3",5)])}]),oo}(),oHo=function(){function oo(oo,or,oT){this._position=null,this._normal=null,this._tangent=null,this._position=oo,this._normal=or,this._tangent=oT}ov(oo,"laya.d3.graphics.VertexPositionNormalSTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(40,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector4",5)])}]),oo}(),oRo=function(){function oo(oo,or,oT){this._position=null,this._normal=null,this._tangent=null,this._position=oo,this._normal=or,this._tangent=oT}ov(oo,"laya.d3.graphics.VertexPositionNormalTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(36,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector3",5)])}]),oo}(),ouo=function(){function oo(oo,or,oT){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=oo,this._normal=or,this._textureCoordinate=oT}ov(oo,"laya.d3.graphics.VertexPositionNormalTexture");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(32,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector2",2)])}]),oo}(),oso=function(){function oo(oo,or,oT,ok){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=oo,this._normal=or,this._textureCoordinate0=oT,this._textureCoordinate1=ok}ov(oo,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(0,or,"textureCoordinate1",function(){return this._textureCoordinate1}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(40,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector2",2),new ono(32,"vector2",15)])}]),oo}(),ozo=function(){function oo(oo,or,oT,ok,oW,oD){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=oo,this._normal=or,this._textureCoordinate0=oT,this._textureCoordinate1=ok,this._blendIndex=oW,this._blendWeight=oD}ov(oo,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(0,or,"textureCoordinate1",function(){return this._textureCoordinate1}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(72,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector2",2),new ono(32,"vector2",15),new ono(40,"vector4",7),new ono(56,"vector4",6)])}]),oo}(),omo=function(){function oo(oo,or,oT,ok,oW,oD,on){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=oo,this._normal=or,this._textureCoordinate0=oT,this._textureCoordinate1=ok,this._tangent=oW,this._blendIndex=oD,this._blendWeight=on}ov(oo,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(0,or,"textureCoordinate1",function(){return this._textureCoordinate1}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(88,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector2",2),new ono(32,"vector2",15),new ono(40,"vector4",7),new ono(56,"vector4",6),new ono(72,"vector4",5)])}]),oo}(),oCo=function(){function oo(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}ov(oo,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),or.VertexPositionNormalTexture0SkinTangent=function(oo,or,oT,ok,oW,oD,on){this._position=oo,this._normal=or,this._textureCoordinate0=oT,this._textureCoordinate1=ok,this._tangent=oW,this._blendIndex=oD,this._blendWeight=on},ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(0,or,"textureCoordinate1",function(){return this._textureCoordinate1}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(84,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector2",2),new ono(32,"vector2",15),new ono(40,"vector4",7),new ono(56,"vector4",6),new ono(72,"vector3",5)])}]),oo}(),oXo=function(){function oo(oo,or,oT,ok,oW){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=oo,this._normal=or,this._textureCoordinate0=oT,this._textureCoordinate1=ok,this._tangent=oW}ov(oo,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(0,or,"textureCoordinate1",function(){return this._textureCoordinate1}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(56,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector2",2),new ono(32,"vector2",15),new ono(40,"vector4",5)])}]),oo}(),oOo=function(){function oo(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}ov(oo,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),or.VertexPositionNormalTexture0Tangent=function(oo,or,oT,ok,oW){this._position=oo,this._normal=or,this._textureCoordinate0=oT,this._textureCoordinate1=ok,this._tangent=oW},ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(0,or,"textureCoordinate1",function(){return this._textureCoordinate1}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(52,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector2",2),new ono(32,"vector2",15),new ono(40,"vector3",5)])}]),oo}(),oMo=function(){function oo(oo,or,oT,ok,oW){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=oo,this._normal=or,this._textureCoordinate=oT,this._blendIndex=ok,this._blendWeight=oW}ov(oo,"laya.d3.graphics.VertexPositionNormalTextureSkin");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(64,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector2",2),new ono(32,"vector4",7),new ono(48,"vector4",6)])}]),oo}(),oco=function(){function oo(oo,or,oT,ok,oW,oD){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=oo,this._normal=or,this._textureCoordinate=oT,this._tangent=ok,this._blendIndex=oW,this._blendWeight=oD}ov(oo,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(80,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector2",2),new ono(32,"vector4",7),new ono(48,"vector4",6),new ono(64,"vector4",5)])}]),oo}(),oeo=function(){function oo(oo,or,oT,ok,oW,oD){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=oo,this._normal=or,this._textureCoordinate=oT,this._tangent=ok,this._blendIndex=oW,this._blendWeight=oD}ov(oo,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(76,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector2",2),new ono(32,"vector4",7),new ono(48,"vector4",6),new ono(64,"vector3",5)])}]),oo}(),oJo=function(){function oo(oo,or,oT,ok){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=oo,this._normal=or,this._textureCoordinate=oT,this._tangent=ok}ov(oo,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(48,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector2",2),new ono(32,"vector4",5)])}]),oo}(),oYo=function(){function oo(oo,or,oT,ok){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=oo,this._normal=or,this._textureCoordinate=oT,this._tangent=ok}ov(oo,"laya.d3.graphics.VertexPositionNormalTextureTangent");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(44,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector2",2),new ono(32,"vector3",5)])}]),oo}(),oAo=function(){function oo(oo,or,oT){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=oo,this._normal=or,this._textureCoordinate=oT}ov(oo,"laya.d3.graphics.VertexPositionNTBTexture");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(56,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector3",5),new ono(36,"vector3",4),new ono(48,"vector2",2)])}]),oo}(),oIo=function(){function oo(oo,or,oT,ok,oW,oD,on,oV){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=oo,this._normal=or,this._textureCoordinate0=ok,this._textureCoordinate1=oW,this._tangent=oD,oT=oT,this._blendIndex=on,this._blendWeight=oV}ov(oo,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"tangent",function(){return this._tangent}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(0,or,"textureCoordinate1",function(){return this._textureCoordinate1}),ox(0,or,"blendIndex",function(){return this._blendIndex}),ox(0,or,"blendWeight",function(){return this._blendWeight}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(96,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector3",5),new ono(36,"vector3",4),new ono(48,"vector2",2),new ono(56,"vector2",15),new ono(64,"vector4",7),new ono(80,"vector4",6)])}]),oo}(),oNo=function(){function oo(oo,or,oT){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=oo,this._normal=or,this._textureCoordinate=oT}ov(oo,"laya.d3.graphics.VertexPositionNTBTextureSkin");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"textureCoordinate",function(){return this._textureCoordinate}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(88,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector3",5),new ono(36,"vector3",4),new ono(48,"vector2",2),new ono(56,"vector4",7),new ono(72,"vector4",6)])}]),oo}(),ofo=(function(){function oo(oo,or,oT,ok){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=oo,this._normal=or,this._textureCoord0=oT,this._textureCoord1=ok}ov(oo,"laya.d3.graphics.VertexPositionTerrain");var or=oo.prototype;oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"normal",function(){return this._normal}),ox(0,or,"position",function(){return this._position}),ox(0,or,"textureCoord0",function(){return this._textureCoord0}),ox(0,or,"textureCoord1",function(){return this._textureCoord1}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(40,[new ono(0,"vector3",0),new ono(12,"vector3",3),new ono(24,"vector2",2),new ono(32,"vector2",15)])}])}(),function(){function oo(oo,or){this._position=null,this._textureCoordinate0=null,this._position=oo,this._textureCoordinate0=or}ov(oo,"laya.d3.graphics.VertexPositionTexture0");var or=oo.prototype;return oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"position",function(){return this._position}),ox(0,or,"textureCoordinate0",function(){return this._textureCoordinate0}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(20,[new ono(0,"vector3",0),new ono(12,"vector2",2)])}]),oo}()),oao=(function(){function oo(oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh,op,oi,ov){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=oo,this._positionStartLifeTime=or,this._velocity=oT,this._startColor=ok,this._startSize=oW,this._startRotation0=oD,this._startRotation1=on,this._startRotation2=oV,this._startLifeTime=oL,this._time=oU,this._startSpeed=oh,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=ov}ov(oo,"laya.d3.graphics.VertexShurikenParticleBillboard");var or=oo.prototype;oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),ox(0,or,"random1",function(){return this._randoms1}),ox(0,or,"startRotation2",function(){return this._startRotation2}),ox(0,or,"positionStartLifeTime",function(){return this._positionStartLifeTime}),ox(0,or,"velocity",function(){return this._velocity}),ox(0,or,"random0",function(){return this._randoms0}),ox(0,or,"startSize",function(){return this._startSize}),ox(0,or,"startColor",function(){return this._startColor}),ox(0,or,"startRotation0",function(){return this._startRotation0}),ox(0,or,"startRotation1",function(){return this._startRotation1}),ox(0,or,"startLifeTime",function(){return this._startLifeTime}),ox(0,or,"time",function(){return this._time}),ox(0,or,"startSpeed",function(){return this._startSpeed}),ox(0,or,"simulationWorldPostion",function(){return this._simulationWorldPostion}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(152,[new ono(0,"vector4",17),new ono(16,"vector4",30),new ono(32,"vector4",32),new ono(48,"vector4",19),new ono(64,"vector3",20),new ono(76,"vector3",22),new ono(88,"single",31),new ono(92,"vector4",34),new ono(108,"vector4",35),new ono(124,"vector3",36),new ono(136,"vector4",37)])}])}(),function(){function oo(oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh,op,oi,ov){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=oo,this._positionStartLifeTime=or,this._velocity=oT,this._startColor=ok,this._startSize=oW,this._startRotation0=oD,this._startRotation1=on,this._startRotation2=oV,this._startLifeTime=oL,this._time=oU,this._startSpeed=oh,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=ov}ov(oo,"laya.d3.graphics.VertexShurikenParticleMesh");var or=oo.prototype;oS.imps(or,{"laya.d3.graphics.IVertex":!0}),ox(0,or,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),ox(0,or,"velocity",function(){return this._velocity}),ox(0,or,"position",function(){return this._positionStartLifeTime}),ox(0,or,"random0",function(){return this._randoms0}),ox(0,or,"startSize",function(){return this._startSize}),ox(0,or,"startColor",function(){return this._startColor}),ox(0,or,"startRotation0",function(){return this._startRotation0}),ox(0,or,"startRotation1",function(){return this._startRotation1}),ox(0,or,"random1",function(){return this._randoms1}),ox(0,or,"startRotation2",function(){return this._startRotation2}),ox(0,or,"startLifeTime",function(){return this._startLifeTime}),ox(0,or,"time",function(){return this._time}),ox(0,or,"startSpeed",function(){return this._startSpeed}),ox(0,or,"simulationWorldPostion",function(){return this._simulationWorldPostion}),ox(0,or,"vertexDeclaration",function(){return oo._vertexDeclaration}),ox(1,oo,"vertexDeclaration",function(){return oo._vertexDeclaration}),op(oo,["_vertexDeclaration",function(){return this._vertexDeclaration=new oDo(172,[new ono(0,"vector3",0),new ono(12,"vector4",1),new ono(28,"vector2",2),new ono(36,"vector4",30),new ono(52,"vector4",32),new ono(68,"vector4",19),new ono(84,"vector3",20),new ono(96,"vector3",22),new ono(108,"single",31),new ono(112,"vector4",34),new ono(128,"vector4",35),new ono(144,"vector3",36),new ono(156,"vector4",37)])}])}(),function(){function oy(oo,or,oT,ok,oW,oD){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=oT,this._materials=ok,this._subMeshes=oW,this._materialMap=oD,this._version=or,this._onLoaded(oo)}ov(oy,"laya.d3.loaders.LoadModelV01");var oo=oy.prototype;return oo._onLoaded=function(oo){this._readData=oo,this.READ_BLOCK();for(var or=0;or<this._BLOCK.count;or++){var oT=this._readData.getUint16(),ok=this._strings[oT],oW=this["READ_"+ok];if(null==oW)throw new Error("model file err,no this function:"+oT+" "+ok);if(!oW.call(this))break}return this._mesh},oo.onError=function(){},oo._readString=function(){return this._strings[this._readData.getUint16()]},oo.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},oo.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},oo.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var oo=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var or=0;or<this._STRINGS.size;or++)this._strings[or]=this._readData.readUTFString();return this._readData.pos=oo,!0},oo.READ_MATERIAL=function(){var oo=this._readData.getUint16(),or=(this._readString(),this._readString());return this._materials[oo]="null"!==or?oK.getRes(this._materialMap[or]):new oRr,!0},oo.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var oo,or=this._readData.__getBuffer(),oT=0,ok=this._readData.getUint32(),oW=this._readData.getUint32(),oD=(new Float32Array(or.slice(ok+this._DATA.offset,ok+this._DATA.offset+oW)),this._readData.getUint32()),on=this._readData.getUint32(),oV=new Float32Array(or.slice(oD+this._DATA.offset,oD+this._DATA.offset+on));for(this.mesh._inverseBindPoses=[],oT=0,oo=oV.length;oT<oo;oT+=16){var oL=new oor(oV[oT+0],oV[oT+1],oV[oT+2],oV[oT+3],oV[oT+4],oV[oT+5],oV[oT+6],oV[oT+7],oV[oT+8],oV[oT+9],oV[oT+10],oV[oT+11],oV[oT+12],oV[oT+13],oV[oT+14],oV[oT+15]);this.mesh._inverseBindPoses.push(oL)}break;default:throw new Error("LoadModel:unknown version.")}return!0},oo.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var oo=this._readString();this._shaderAttributes=oo.match(oy._attrReg);var or=this._readData.getUint32(),oT=this._readData.getUint32(),ok=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),oW=this._readData.getUint32(),oD=this._readData.getUint32(),on=this._readData.getUint32(),oV=this._readData.__getBuffer(),oL=new oUr(this._mesh),oU=this._getVertexDeclaration(),oh=oer.create(oU,oW/oU.vertexStride,35044,!0),op=ok+this._DATA.offset,oi=oV.slice(op,op+oW);oh.setData(new Float32Array(oi));for(var ov=(oL._vertexBuffer=oh).vertexDeclaration.getVertexElements(),ox=0;ox<ov.length;ox++)oL._bufferUsage[ov[ox].elementUsage]=oh;var oj=ocr.create("ushort",oT/2,35044,!0),o_=or+this._DATA.offset,oK=oV.slice(o_,o_+oT);oj.setData(new Uint16Array(oK)),oL._indexBuffer=oj;var o$=oV.slice(oD+this._DATA.offset,oD+this._DATA.offset+on);return oL._boneIndicesList[0]=new Uint8Array(o$),this._subMeshes.push(oL),!0},oo.READ_DATAAREA=function(){return!1},oo._getVertexDeclaration=function(){for(var oo,or=!1,oT=!1,ok=!1,oW=!1,oD=!1,on=!1,oV=!1,oL=!1,oU=!1,oh=0;oh<this._shaderAttributes.length;oh+=8)switch(this._shaderAttributes[oh]){case"POSITION":or=!0;break;case"NORMAL":oT=!0;break;case"COLOR":ok=!0;break;case"UV":oW=!0;break;case"UV1":oD=!0;break;case"BLENDWEIGHT":oV=!0;break;case"BLENDINDICES":oL=!0;break;case"TANGENT":on=!0;break;case"BINORMAL":oU=!0}return or&&oT&&ok&&oW&&oD&&oV&&oL&&on?oo=oyo.vertexDeclaration:or&&oT&&ok&&oW&&oD&&oV&&oL?oo=oKo.vertexDeclaration:or&&oT&&oW&&oD&&oV&&oL&&on?oo=oCo.vertexDeclaration:or&&oT&&oW&&oD&&oV&&oL?oo=ozo.vertexDeclaration:or&&oT&&ok&&oW&&oV&&oL&&on?oo=oFo.vertexDeclaration:or&&oT&&ok&&oW&&oV&&oL?oo=oqo.vertexDeclaration:or&&oT&&on&&oU&&oW&&oV&&oL?oo=oNo.vertexDeclaration:or&&oT&&oW&&oV&&oL&&on?oo=oeo.vertexDeclaration:or&&oT&&oW&&oV&&oL?oo=oMo.vertexDeclaration:or&&oT&&ok&&oV&&oL&&on?oo=oio.vertexDeclaration:or&&oT&&ok&&oV&&oL?oo=oho.vertexDeclaration:or&&oT&&ok&&oW&&oD&&on?oo=oSo.vertexDeclaration:or&&oT&&ok&&oW&&oD?oo=o_o.vertexDeclaration:or&&oT&&oW&&oD&&on?oo=oOo.vertexDeclaration:or&&oT&&oW&&oD?oo=oso.vertexDeclaration:or&&oT&&ok&&oW&&on?oo=oto.vertexDeclaration:or&&oT&&oW&&on&&oU?oo=oAo.vertexDeclaration:or&&oT&&ok&&oW?oo=ojo.vertexDeclaration:or&&oT&&oW&&on?oo=oYo.vertexDeclaration:or&&oT&&oW?oo=ouo.vertexDeclaration:or&&oT&&ok&&on?oo=oxo.vertexDeclaration:or&&oT&&ok&&(oo=oUo.vertexDeclaration),oo},ox(0,oo,"mesh",function(){return this._mesh}),oy._attrReg=new RegExp("(\\w+)|([:,;])","g"),oy}()),oGo=function(){function ob(){}return ov(ob,"laya.d3.loaders.LoadModelV02"),ob.parse=function(oo,or,oT,ok,oW,oD){ob._mesh=oT,ob._materials=ok,ob._subMeshes=oW,ob._materialMap=oD,ob._version=or,ob._readData=oo,ob.READ_DATA(),ob.READ_BLOCK(),ob.READ_STRINGS();for(var on=0,oV=ob._BLOCK.count;on<oV;on++){ob._readData.pos=ob._BLOCK.blockStarts[on];var oL=ob._readData.getUint16(),oU=ob._strings[oL],oh=ob["READ_"+oU];if(null==oh)throw new Error("model file err,no this function:"+oL+" "+oU);oh.call()}ob._strings.length=0,ob._readData=null,ob._version=null,ob._mesh=null,ob._materials=null,ob._subMeshes=null,ob._materialMap=null},ob._readString=function(){return ob._strings[ob._readData.getUint16()]},ob.READ_DATA=function(){ob._DATA.offset=ob._readData.getUint32(),ob._DATA.size=ob._readData.getUint32()},ob.READ_BLOCK=function(){for(var oo=ob._BLOCK.count=ob._readData.getUint16(),or=ob._BLOCK.blockStarts=[],oT=ob._BLOCK.blockLengths=[],ok=0;ok<oo;ok++)or.push(ob._readData.getUint32()),oT.push(ob._readData.getUint32())},ob.READ_STRINGS=function(){var oo=ob._readData.getUint32(),or=ob._readData.getUint16(),oT=ob._readData.pos;ob._readData.pos=oo+ob._DATA.offset;for(var ok=0;ok<or;ok++)ob._strings[ok]=ob._readData.readUTFString();ob._readData.pos=oT},ob.READ_MATERIAL=function(){ob._readString(),ob._readString();var oo=ob._readString();return""!==oo&&ob._materials.push(oK.getRes(ob._materialMap[oo])),!0},ob.READ_MESH=function(){ob._readString();var oo,or=ob._readData.__getBuffer(),oT=0,ok=ob._readData.getInt16(),oW=ob._DATA.offset;for(oT=0;oT<ok;oT++){var oD=oW+ob._readData.getUint32(),on=ob._readData.getUint32(),oV=new Float32Array(or.slice(oD,oD+on)),oL=ob._readString().match(ob._attrReg),oU=ob._getVertexDeclaration(oL),oh=oer.create(oU,4*oV.length/oU.vertexStride,35044,!0);oh.setData(oV),ob._mesh._vertexBuffers.push(oh)}var op=oW+ob._readData.getUint32(),oi=ob._readData.getUint32(),ov=new Uint16Array(or.slice(op,op+oi)),ox=ocr.create("ushort",oi/2,35044,!0);ox.setData(ov),ob._mesh._indexBuffer=ox;var oj=ob._mesh._boneNames=[],o_=ob._readData.getUint16();for(oj.length=o_,oT=0;oT<o_;oT++)oj[oT]=ob._strings[ob._readData.getUint16()];var oK=ob._readData.getUint32(),o$=ob._readData.getUint32(),oy=(new Float32Array(or.slice(oW+oK,oW+oK+o$)),ob._readData.getUint32()),ol=ob._readData.getUint32(),oS=new Float32Array(or.slice(oW+oy,oW+oy+ol));for(ob._mesh._inverseBindPoses=[],oT=0,oo=oS.length;oT<oo;oT+=16){var oq=new oor(oS[oT+0],oS[oT+1],oS[oT+2],oS[oT+3],oS[oT+4],oS[oT+5],oS[oT+6],oS[oT+7],oS[oT+8],oS[oT+9],oS[oT+10],oS[oT+11],oS[oT+12],oS[oT+13],oS[oT+14],oS[oT+15]);ob._mesh._inverseBindPoses.push(oq)}return ob._mesh._skinnedDatas=new Float32Array(16*oS.length),!0},ob.READ_SUBMESH=function(){var oo=ob._readData.__getBuffer(),or=new oUr(ob._mesh),oT=ob._readData.getInt16(),ok=ob._readData.getUint32(),oW=ob._readData.getUint32();or._vertexBuffer=ob._mesh._vertexBuffers[oT],or._vertexStart=ok,or._vertexCount=oW;var oD=ob._readData.getUint32(),on=ob._readData.getUint32(),oV=ob._mesh._indexBuffer;or._indexBuffer=oV,or._indexStart=oD,or._indexCount=on,or._indices=new Uint16Array(oV.getData().buffer,2*oD,on);var oL=ob._DATA.offset,oU=or._subIndexBufferStart,oh=or._subIndexBufferCount,op=or._boneIndicesList,oi=ob._readData.getUint16();oU.length=oi,oh.length=oi,op.length=oi;for(var ov=0;ov<oi;ov++){oU[ov]=ob._readData.getUint32(),oh[ov]=ob._readData.getUint32();var ox=ob._readData.getUint32(),oj=ob._readData.getUint32();or._boneIndicesList[ov]=new Uint8Array(oo.slice(oL+ox,oL+ox+oj))}return ob._subMeshes.push(or),!0},ob._getVertexDeclaration=function(oo){for(var or,oT=!1,ok=!1,oW=!1,oD=!1,on=!1,oV=!1,oL=!1,oU=!1,oh=!1,op=0;op<oo.length;op++)switch(oo[op]){case"POSITION":oT=!0;break;case"NORMAL":ok=!0;break;case"COLOR":oW=!0;break;case"UV":oD=!0;break;case"UV1":on=!0;break;case"BLENDWEIGHT":oL=!0;break;case"BLENDINDICES":oU=!0;break;case"TANGENT":oV=!0;break;case"BINORMAL":oh=!0}return oT&&ok&&oW&&oD&&on&&oL&&oU&&oV?or=oyo.vertexDeclaration:oT&&ok&&oW&&oD&&on&&oL&&oU?or=oKo.vertexDeclaration:oT&&ok&&oD&&on&&oL&&oU&&oV?or=oCo.vertexDeclaration:oT&&ok&&oD&&on&&oL&&oU?or=ozo.vertexDeclaration:oT&&ok&&oW&&oD&&oL&&oU&&oV?or=oFo.vertexDeclaration:oT&&ok&&oW&&oD&&oL&&oU?or=oqo.vertexDeclaration:oT&&ok&&oD&&oL&&oU&&oV?or=oeo.vertexDeclaration:oT&&ok&&oD&&oL&&oU?or=oMo.vertexDeclaration:oT&&ok&&oW&&oL&&oU&&oV?or=oio.vertexDeclaration:oT&&ok&&oW&&oL&&oU?or=oho.vertexDeclaration:oT&&ok&&oW&&oD&&on&&oV?or=oSo.vertexDeclaration:oT&&ok&&oW&&oD&&on?or=o_o.vertexDeclaration:oT&&ok&&oD&&on&&oV?or=oOo.vertexDeclaration:oT&&ok&&oD&&on?or=oso.vertexDeclaration:oT&&ok&&oW&&oD&&oV?or=oto.vertexDeclaration:oT&&ok&&oD&&oV&&oh?or=oAo.vertexDeclaration:oT&&ok&&oW&&oD?or=ojo.vertexDeclaration:oT&&ok&&oD&&oV?or=oYo.vertexDeclaration:oT&&ok&&oD?or=ouo.vertexDeclaration:oT&&ok&&oW&&oV?or=oxo.vertexDeclaration:oT&&ok&&oW&&(or=oUo.vertexDeclaration),or},ob._attrReg=new RegExp("(\\w+)|([:,;])","g"),ob._strings=[],ob._readData=null,ob._version=null,ob._mesh=null,ob._materials=null,ob._subMeshes=null,ob._materialMap=null,op(ob,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),ob}(),owo=function(){function oq(){}return ov(oq,"laya.d3.loaders.LoadModelV03"),oq.parse=function(oo,or,oT,ok,oW){oq._mesh=oT,oq._subMeshes=ok,oq._materialMap=oW,oq._version=or,oq._readData=oo,oq.READ_DATA(),oq.READ_BLOCK(),oq.READ_STRINGS();for(var oD=0,on=oq._BLOCK.count;oD<on;oD++){oq._readData.pos=oq._BLOCK.blockStarts[oD];var oV=oq._readData.getUint16(),oL=oq._strings[oV],oU=oq["READ_"+oL];if(null==oU)throw new Error("model file err,no this function:"+oV+" "+oL);oU.call()}oq._strings.length=0,oq._readData=null,oq._version=null,oq._mesh=null,oq._subMeshes=null,oq._materialMap=null},oq._readString=function(){return oq._strings[oq._readData.getUint16()]},oq.READ_DATA=function(){oq._DATA.offset=oq._readData.getUint32(),oq._DATA.size=oq._readData.getUint32()},oq.READ_BLOCK=function(){for(var oo=oq._BLOCK.count=oq._readData.getUint16(),or=oq._BLOCK.blockStarts=[],oT=oq._BLOCK.blockLengths=[],ok=0;ok<oo;ok++)or.push(oq._readData.getUint32()),oT.push(oq._readData.getUint32())},oq.READ_STRINGS=function(){var oo=oq._readData.getUint32(),or=oq._readData.getUint16(),oT=oq._readData.pos;oq._readData.pos=oo+oq._DATA.offset;for(var ok=0;ok<or;ok++)oq._strings[ok]=oq._readData.readUTFString();oq._readData.pos=oT},oq.READ_MESH=function(){var oo,or=oq._readString(),oT=oq._readData.__getBuffer(),ok=0,oW=oq._readData.getInt16(),oD=oq._DATA.offset;for(ok=0;ok<oW;ok++){var on,oV=oD+oq._readData.getUint32(),oL=oq._readData.getUint32(),oU=new Float32Array(oT.slice(oV,oV+oL)),oh=oq._readString();switch(oq._version){case"LAYAMODEL:03":on=oq._vertexDeclarationMap_Discard[oh];break;case"LAYAMODEL:0301":on=oq._vertexDeclarationMap[oh];break;default:throw new Error("LoadModelV03: unknown version.")}if(!on)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+oq._version+"  bufferAttribute="+oh+"  name="+or+"  url="+(oq._mesh?oq._mesh.url:"null"));var op=oer.create(on,4*oU.length/on.vertexStride,35044,!0,oq._mesh._url+"_"+ok);op.setData(oU),oq._mesh._vertexBuffers.push(op)}var oi=oD+oq._readData.getUint32(),ov=oq._readData.getUint32(),ox=new Uint16Array(oT.slice(oi,oi+ov)),oj=ocr.create("ushort",ov/2,35044,!0,oq._mesh._url);oj.setData(ox),oq._mesh._indexBuffer=oj;var o_=oq._mesh._boneNames=[],oK=oq._readData.getUint16();for(o_.length=oK,ok=0;ok<oK;ok++)o_[ok]=oq._strings[oq._readData.getUint16()];oq._readData.pos+=8;var o$=oq._readData.getUint32(),oy=oq._readData.getUint32(),ol=new Float32Array(oT.slice(oD+o$,oD+o$+oy));for(oq._mesh._inverseBindPoses=[],ok=0,oo=ol.length;ok<oo;ok+=16){var oS=new oor(ol[ok+0],ol[ok+1],ol[ok+2],ol[ok+3],ol[ok+4],ol[ok+5],ol[ok+6],ol[ok+7],ol[ok+8],ol[ok+9],ol[ok+10],ol[ok+11],ol[ok+12],ol[ok+13],ol[ok+14],ol[ok+15]);oq._mesh._inverseBindPoses.push(oS)}return oq._mesh._skinnedDatas=new Float32Array(16*ol.length),!0},oq.READ_SUBMESH=function(){var oo=oq._readData.__getBuffer(),or=new oUr(oq._mesh),oT=oq._readData.getInt16(),ok=oq._readData.getUint32(),oW=oq._readData.getUint32();or._vertexBuffer=oq._mesh._vertexBuffers[oT],or._vertexStart=ok,or._vertexCount=oW;var oD=oq._readData.getUint32(),on=oq._readData.getUint32(),oV=oq._mesh._indexBuffer;or._indexBuffer=oV,or._indexStart=oD,or._indexCount=on,or._indices=new Uint16Array(oV.getData().buffer,2*oD,on);var oL=oq._DATA.offset,oU=or._subIndexBufferStart,oh=or._subIndexBufferCount,op=or._boneIndicesList,oi=oq._readData.getUint16();oU.length=oi,oh.length=oi,op.length=oi;for(var ov=0;ov<oi;ov++){oU[ov]=oq._readData.getUint32(),oh[ov]=oq._readData.getUint32();var ox=oq._readData.getUint32(),oj=oq._readData.getUint32();op[ov]=new Uint8Array(oo.slice(oL+ox,oL+ox+oj))}return oq._subMeshes.push(or),!0},oq._strings=[],oq._readData=null,oq._version=null,oq._mesh=null,oq._subMeshes=null,oq._materialMap=null,op(oq,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":oyo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":oKo.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":oIo.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":oCo.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":ozo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":oFo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":oqo.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":oeo.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":oMo.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":oio.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":oho.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":oSo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":o_o.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":oOo.vertexDeclaration,"POSITION,NORMAL,UV,UV1":oso.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":oto.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":oAo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":ojo.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":oYo.vertexDeclaration,"POSITION,NORMAL,UV":ouo.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":oxo.vertexDeclaration,"POSITION,NORMAL,COLOR":oUo.vertexDeclaration,"POSITION,NORMAL,TANGENT":oRo.vertexDeclaration,"POSITION,NORMAL":oLo.vertexDeclaration,"POSITION,UV":ofo.vertexDeclaration,POSITION:oVo.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":o$o.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":oKo.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":oIo.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":omo.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":ozo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":obo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":oqo.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":oco.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":oMo.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":opo.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":oho.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":olo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":o_o.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":oXo.vertexDeclaration,"POSITION,NORMAL,UV,UV1":oso.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":oPo.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":oAo.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":ojo.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":oJo.vertexDeclaration,"POSITION,NORMAL,UV":ouo.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":ovo.vertexDeclaration,"POSITION,NORMAL,COLOR":oUo.vertexDeclaration,"POSITION,NORMAL,TANGENT":oHo.vertexDeclaration,"POSITION,NORMAL":oLo.vertexDeclaration,"POSITION,UV":ofo.vertexDeclaration,POSITION:oVo.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),oq}(),oZo=function(){function oV(){}return ov(oV,"laya.d3.loaders.MeshReader"),oV.read=function(oo,or,oT,ok,oW){var oD=new oq(oo);oD.pos=0;var on=oD.readUTFString();switch(on){case"LAYAMODEL:01":case"LAYASKINANI:01":oV._readVersion01(oD,on,or,oT,ok,oW);break;case"LAYAMODEL:02":oGo.parse(oD,on,or,oT,ok,oW);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":owo.parse(oD,on,or,ok,oW);break;default:throw new Error("MeshReader: unknown mesh version.")}or._setSubMeshes(ok)},oV._readVersion01=function(oo,or,oT,ok,oW,oD){new oao(oo,or,oT,ok,oW,oD)},oV}(),oQo=function(){function oo(oo,or){this.min=null,this.max=null,this.min=oo,this.max=or}ov(oo,"laya.d3.math.BoundBox");var or=oo.prototype;return oS.imps(or,{"laya.d3.core.IClone":!0}),or.getCorners=function(oo){oo.length=8;var or=this.min.elements,oT=this.max.elements,ok=or[0],oW=or[1],oD=or[2],on=oT[0],oV=oT[1],oL=oT[2];oo[0]=new onr(ok,oV,oL),oo[1]=new onr(on,oV,oL),oo[2]=new onr(on,oW,oL),oo[3]=new onr(ok,oW,oL),oo[4]=new onr(ok,oV,oD),oo[5]=new onr(on,oV,oD),oo[6]=new onr(on,oW,oD),oo[7]=new onr(ok,oW,oD)},or.toDefault=function(){this.min.toDefault(),this.max.toDefault()},or.cloneTo=function(oo){var or=oo;this.min.cloneTo(or.min),this.max.cloneTo(or.max)},or.clone=function(){var oo=new this.constructor(new onr,new onr);return this.cloneTo(oo),oo},oo.createfromPoints=function(oo,or){if(null==oo)throw new Error("points");var oT=or.min,ok=or.max,oW=oT.elements;oW[0]=Number.MAX_VALUE,oW[1]=Number.MAX_VALUE,oW[2]=Number.MAX_VALUE;var oD=ok.elements;oD[0]=-Number.MAX_VALUE,oD[1]=-Number.MAX_VALUE,oD[2]=-Number.MAX_VALUE;for(var on=0,oV=oo.length;on<oV;++on)onr.min(oT,oo[on],oT),onr.max(ok,oo[on],ok)},oo.merge=function(oo,or,oT){onr.min(oo.min,or.min,oT.min),onr.max(oo.max,or.max,oT.max)},oo}(),ogo=function(){function oU(oo){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=oo,this._near=new orr(new onr),this._far=new orr(new onr),this._left=new orr(new onr),this._right=new orr(new onr),this._top=new orr(new onr),this._bottom=new orr(new onr),oU._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}ov(oU,"laya.d3.math.BoundFrustum");var oo=oU.prototype;return oo.equalsBoundFrustum=function(oo){return this._matrix.equalsOtherMatrix(oo.matrix)},oo.equalsObj=function(oo){if(oo instanceof laya.d3.math.BoundFrustum){var or=oo;return this.equalsBoundFrustum(or)}return!1},oo.getPlane=function(oo){switch(oo){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},oo.getCorners=function(oo){oU._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(oo[0]),oU._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(oo[1]),oU._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(oo[2]),oU._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(oo[3]),oU._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(oo[4]),oU._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(oo[5]),oU._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(oo[6]),oU._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(oo[7])},oo.containsPoint=function(oo){for(var or=orr.PlaneIntersectionType_Front,oT=orr.PlaneIntersectionType_Front,ok=0;ok<6;ok++){switch(ok){case 0:oT=Collision.intersectsPlaneAndPoint(this._near,oo);break;case 1:oT=Collision.intersectsPlaneAndPoint(this._far,oo);break;case 2:oT=Collision.intersectsPlaneAndPoint(this._left,oo);break;case 3:oT=Collision.intersectsPlaneAndPoint(this._right,oo);break;case 4:oT=Collision.intersectsPlaneAndPoint(this._top,oo);break;case 5:oT=Collision.intersectsPlaneAndPoint(this._bottom,oo)}switch(oT){case orr.PlaneIntersectionType_Back:return 0;case orr.PlaneIntersectionType_Intersecting:or=orr.PlaneIntersectionType_Intersecting}}switch(or){case orr.PlaneIntersectionType_Intersecting:return 2;default:return 1}},oo.containsBoundBox=function(oo){for(var or,oT=oU._tempV30,ok=oU._tempV31,oW=1,oD=0;oD<6;oD++){if(or=this.getPlane(oD),this._getBoxToPlanePVertexNVertex(oo,or.normal,oT,ok),Collision.intersectsPlaneAndPoint(or,oT)===orr.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(or,ok)===orr.PlaneIntersectionType_Back&&(oW=2)}return oW},oo.containsBoundSphere=function(oo){for(var or=orr.PlaneIntersectionType_Front,oT=orr.PlaneIntersectionType_Front,ok=0;ok<6;ok++){switch(ok){case 0:oT=Collision.intersectsPlaneAndSphere(this._near,oo);break;case 1:oT=Collision.intersectsPlaneAndSphere(this._far,oo);break;case 2:oT=Collision.intersectsPlaneAndSphere(this._left,oo);break;case 3:oT=Collision.intersectsPlaneAndSphere(this._right,oo);break;case 4:oT=Collision.intersectsPlaneAndSphere(this._top,oo);break;case 5:oT=Collision.intersectsPlaneAndSphere(this._bottom,oo)}switch(oT){case orr.PlaneIntersectionType_Back:return 0;case orr.PlaneIntersectionType_Intersecting:or=orr.PlaneIntersectionType_Intersecting}}switch(or){case orr.PlaneIntersectionType_Intersecting:return 2;default:return 1}},oo._getBoxToPlanePVertexNVertex=function(oo,or,oT,ok){var oW=oo.min,oD=oW.elements,on=oo.max,oV=on.elements,oL=or.elements,oU=oL[0],oh=oL[1],op=oL[2];oW.cloneTo(oT);var oi=oT.elements;0<=oU&&(oi[0]=oV[0]),0<=oh&&(oi[1]=oV[1]),0<=op&&(oi[2]=oV[2]),on.cloneTo(ok);var ov=ok.elements;0<=oU&&(ov[0]=oD[0]),0<=oh&&(ov[1]=oD[1]),0<=op&&(ov[2]=oD[2])},ox(0,oo,"top",function(){return this._top}),ox(0,oo,"matrix",function(){return this._matrix},function(oo){this._matrix=oo,oU._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),ox(0,oo,"near",function(){return this._near}),ox(0,oo,"far",function(){return this._far}),ox(0,oo,"left",function(){return this._left}),ox(0,oo,"right",function(){return this._right}),ox(0,oo,"bottom",function(){return this._bottom}),oU._getPlanesFromMatrix=function(oo,or,oT,ok,oW,oD,on){var oV=oo.elements,oL=oV[0],oU=oV[1],oh=oV[2],op=oV[3],oi=oV[4],ov=oV[5],ox=oV[6],oj=oV[7],o_=oV[8],oK=oV[9],o$=oV[10],oy=oV[11],ol=oV[12],oS=oV[13],oq=oV[14],ob=oV[15],oF=or.normal.elements;oF[0]=op+oh,oF[1]=oj+ox,oF[2]=oy+o$,or.distance=ob+oq,or.normalize();var oP=oT.normal.elements;oP[0]=op-oh,oP[1]=oj-ox,oP[2]=oy-o$,oT.distance=ob-oq,oT.normalize();var ot=ok.normal.elements;ot[0]=op+oL,ot[1]=oj+oi,ot[2]=oy+o_,ok.distance=ob+ol,ok.normalize();var oH=oW.normal.elements;oH[0]=op-oL,oH[1]=oj-oi,oH[2]=oy-o_,oW.distance=ob-ol,oW.normalize();var oR=oD.normal.elements;oR[0]=op-oU,oR[1]=oj-ov,oR[2]=oy-oK,oD.distance=ob-oS,oD.normalize();var ou=on.normal.elements;ou[0]=op+oU,ou[1]=oj+ov,ou[2]=oy+oK,on.distance=ob+oS,on.normalize()},oU._get3PlaneInterPoint=function(oo,or,oT){var ok=oo.normal,oW=or.normal,oD=oT.normal;onr.cross(oW,oD,oU._tempV30),onr.cross(oD,ok,oU._tempV31),onr.cross(ok,oW,oU._tempV32);var on=onr.dot(ok,oU._tempV30),oV=onr.dot(oW,oU._tempV31),oL=onr.dot(oD,oU._tempV32);return onr.scale(oU._tempV30,-oo.distance/on,oU._tempV33),onr.scale(oU._tempV31,-or.distance/oV,oU._tempV34),onr.scale(oU._tempV32,-oT.distance/oL,oU._tempV35),onr.add(oU._tempV33,oU._tempV34,oU._tempV36),onr.add(oU._tempV35,oU._tempV36,oU._tempV37),oU._tempV37},op(oU,["_tempV30",function(){return this._tempV30=new onr},"_tempV31",function(){return this._tempV31=new onr},"_tempV32",function(){return this._tempV32=new onr},"_tempV33",function(){return this._tempV33=new onr},"_tempV34",function(){return this._tempV34=new onr},"_tempV35",function(){return this._tempV35=new onr},"_tempV36",function(){return this._tempV36=new onr},"_tempV37",function(){return this._tempV37=new onr}]),oU}(),oBo=function(){function oh(oo,or){this.center=null,this.radius=NaN,this.center=oo,this.radius=or}ov(oh,"laya.d3.math.BoundSphere");var oo=oh.prototype;return oS.imps(oo,{"laya.d3.core.IClone":!0}),oo.toDefault=function(){this.center.toDefault(),this.radius=0},oo.intersectsRayDistance=function(oo){return Collision.intersectsRayAndSphereRD(oo,this)},oo.intersectsRayPoint=function(oo,or){return Collision.intersectsRayAndSphereRP(oo,this,or)},oo.cloneTo=function(oo){var or=oo;this.center.cloneTo(or.center),or.radius=this.radius},oo.clone=function(){var oo=new this.constructor(new onr,new onr);return this.cloneTo(oo),oo},oh.createFromSubPoints=function(oo,or,oT,ok){if(null==oo)throw new Error("points");if(or<0||or>=oo.length)throw new Error("start"+or+"Must be in the range [0, "+(oo.length-1)+"]");if(oT<0||or+oT>oo.length)throw new Error("count"+oT+"Must be in the range <= "+oo.length+"}");var oW=or+oT,oD=oh._tempVector3;oD.elements[0]=0,oD.elements[1]=0,oD.elements[2]=0;for(var on=or;on<oW;++on)onr.add(oo[on],oD,oD);var oV=ok.center;onr.scale(oD,1/oT,oV);var oL=0;for(on=or;on<oW;++on){var oU=onr.distanceSquared(oV,oo[on]);oL<oU&&(oL=oU)}ok.radius=Math.sqrt(oL)},oh.createfromPoints=function(oo,or){if(null==oo)throw new Error("points");oh.createFromSubPoints(oo,0,oo.length,or)},op(oh,["_tempVector3",function(){return this._tempVector3=new onr}]),oh}(),oEo=(function(){function oo(){}ov(oo,"laya.d3.math.ContainmentType"),oo.Disjoint=0,oo.Contains=1,oo.Intersects=2}(),function(){function oT(){}return ov(oT,"laya.d3.math.MathUtils3D"),oT.isZero=function(oo){return Math.abs(oo)<oT.zeroTolerance},oT.nearEqual=function(oo,or){return!!oT.isZero(oo-or)},oT.fastInvSqrt=function(oo){return oT.isZero(oo)?oo:1/Math.sqrt(oo)},op(oT,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),oT}()),odo=function(){function oL(){var oo=this.elements=new Float32Array(9);oo[0]=1,oo[1]=0,oo[2]=0,oo[3]=0,oo[4]=1,oo[5]=0,oo[6]=0,oo[7]=0,oo[8]=1}ov(oL,"laya.d3.math.Matrix3x3");var oo=oL.prototype;return oS.imps(oo,{"laya.d3.core.IClone":!0}),oo.determinant=function(){var oo=this.elements,or=oo[0],oT=oo[1],ok=oo[2],oW=oo[3],oD=oo[4],on=oo[5],oV=oo[6],oL=oo[7],oU=oo[8];return or*(oU*oD-on*oL)+oT*(-oU*oW+on*oV)+ok*(oL*oW-oD*oV)},oo.translate=function(oo,or){var oT=or.elements,ok=this.elements,oW=oo.elements,oD=ok[0],on=ok[1],oV=ok[2],oL=ok[3],oU=ok[4],oh=ok[5],op=ok[6],oi=ok[7],ov=ok[8],ox=oW[0],oj=oW[1];oT[0]=oD,oT[1]=on,oT[2]=oV,oT[3]=oL,oT[4]=oU,oT[5]=oh,oT[6]=ox*oD+oj*oL+op,oT[7]=ox*on+oj*oU+oi,oT[8]=ox*oV+oj*oh+ov},oo.rotate=function(oo,or){var oT=or.elements,ok=this.elements,oW=ok[0],oD=ok[1],on=ok[2],oV=ok[3],oL=ok[4],oU=ok[5],oh=ok[6],op=ok[7],oi=ok[8],ov=Math.sin(oo),ox=Math.cos(oo);oT[0]=ox*oW+ov*oV,oT[1]=ox*oD+ov*oL,oT[2]=ox*on+ov*oU,oT[3]=ox*oV-ov*oW,oT[4]=ox*oL-ov*oD,oT[5]=ox*oU-ov*on,oT[6]=oh,oT[7]=op,oT[8]=oi},oo.scale=function(oo,or){var oT=or.elements,ok=this.elements,oW=oo.elements,oD=oW[0],on=oW[1];oT[0]=oD*ok[0],oT[1]=oD*ok[1],oT[2]=oD*ok[2],oT[3]=on*ok[3],oT[4]=on*ok[4],oT[5]=on*ok[5],oT[6]=ok[6],oT[7]=ok[7],oT[8]=ok[8]},oo.invert=function(oo){var or=oo.elements,oT=this.elements,ok=oT[0],oW=oT[1],oD=oT[2],on=oT[3],oV=oT[4],oL=oT[5],oU=oT[6],oh=oT[7],op=oT[8],oi=op*oV-oL*oh,ov=-op*on+oL*oU,ox=oh*on-oV*oU,oj=ok*oi+oW*ov+oD*ox;oj||(oo=null),oj=1/oj,or[0]=oi*oj,or[1]=(-op*oW+oD*oh)*oj,or[2]=(oL*oW-oD*oV)*oj,or[3]=ov*oj,or[4]=(op*ok-oD*oU)*oj,or[5]=(-oL*ok+oD*on)*oj,or[6]=ox*oj,or[7]=(-oh*ok+oW*oU)*oj,or[8]=(oV*ok-oW*on)*oj},oo.transpose=function(oo){var or=oo.elements,oT=this.elements;if(oo===this){var ok=oT[1],oW=oT[2],oD=oT[5];or[1]=oT[3],or[2]=oT[6],or[3]=ok,or[5]=oT[7],or[6]=oW,or[7]=oD}else or[0]=oT[0],or[1]=oT[3],or[2]=oT[6],or[3]=oT[1],or[4]=oT[4],or[5]=oT[7],or[6]=oT[2],or[7]=oT[5],or[8]=oT[8]},oo.identity=function(){var oo=this.elements;oo[0]=1,oo[1]=0,oo[2]=0,oo[3]=0,oo[4]=1,oo[5]=0,oo[6]=0,oo[7]=0,oo[8]=1},oo.cloneTo=function(oo){var or,oT,ok;if((oT=this.elements)!==(ok=oo.elements))for(or=0;or<9;++or)ok[or]=oT[or]},oo.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},oL.createFromTranslation=function(oo,or){or.elements;var oT=oo.elements;or[0]=1,or[1]=0,or[2]=0,or[3]=0,or[4]=1,or[5]=0,or[6]=oT[0],or[7]=oT[1],or[8]=1},oL.createFromRotation=function(oo,or){var oT=or.elements,ok=Math.sin(oo),oW=Math.cos(oo);oT[0]=oW,oT[1]=ok,oT[2]=0,oT[3]=-ok,oT[4]=oW,oT[5]=0,oT[6]=0,oT[7]=0,oT[8]=1},oL.createFromScaling=function(oo,or){var oT=or.elements,ok=oo.elements;oT[0]=ok[0],oT[1]=0,oT[2]=0,oT[3]=0,oT[4]=ok[1],oT[5]=0,oT[6]=0,oT[7]=0,oT[8]=1},oL.createFromMatrix4x4=function(oo,or){or[0]=oo[0],or[1]=oo[1],or[2]=oo[2],or[3]=oo[4],or[4]=oo[5],or[5]=oo[6],or[6]=oo[8],or[7]=oo[9],or[8]=oo[10]},oL.multiply=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or.elements,on=oW[0],oV=oW[1],oL=oW[2],oU=oW[3],oh=oW[4],op=oW[5],oi=oW[6],ov=oW[7],ox=oW[8],oj=oD[0],o_=oD[1],oK=oD[2],o$=oD[3],oy=oD[4],ol=oD[5],oS=oD[6],oq=oD[7],ob=oD[8];ok[0]=oj*on+o_*oU+oK*oi,ok[1]=oj*oV+o_*oh+oK*ov,ok[2]=oj*oL+o_*op+oK*ox,ok[3]=o$*on+oy*oU+ol*oi,ok[4]=o$*oV+oy*oh+ol*ov,ok[5]=o$*oL+oy*op+ol*ox,ok[6]=oS*on+oq*oU+ob*oi,ok[7]=oS*oV+oq*oh+ob*ov,ok[8]=oS*oL+oq*op+ob*ox},oL.lookAt=function(oo,or,oT,ok){onr.subtract(oo,or,oL._tempV30),onr.normalize(oL._tempV30,oL._tempV30),onr.cross(oT,oL._tempV30,oL._tempV31),onr.normalize(oL._tempV31,oL._tempV31),onr.cross(oL._tempV30,oL._tempV31,oL._tempV32);var oW=oL._tempV30.elements,oD=oL._tempV31.elements,on=oL._tempV32.elements,oV=ok.elements;oV[0]=oD[0],oV[3]=oD[1],oV[6]=oD[2],oV[1]=on[0],oV[4]=on[1],oV[7]=on[2],oV[2]=oW[0],oV[5]=oW[1],oV[8]=oW[2]},oL.DEFAULT=new oL,op(oL,["_tempV30",function(){return this._tempV30=new onr},"_tempV31",function(){return this._tempV31=new onr},"_tempV32",function(){return this._tempV32=new onr}]),oL}(),oor=function(){function oP(oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh,op,oi,ov,ox,oj){void 0===oo&&(oo=1),void 0===or&&(or=0),void 0===oT&&(oT=0),void 0===ok&&(ok=0),void 0===oW&&(oW=0),void 0===oD&&(oD=1),void 0===on&&(on=0),void 0===oV&&(oV=0),void 0===oL&&(oL=0),void 0===oU&&(oU=0),void 0===oh&&(oh=1),void 0===op&&(op=0),void 0===oi&&(oi=0),void 0===ov&&(ov=0),void 0===ox&&(ox=0),void 0===oj&&(oj=1);var o_=this.elements=new Float32Array(16);o_[0]=oo,o_[1]=or,o_[2]=oT,o_[3]=ok,o_[4]=oW,o_[5]=oD,o_[6]=on,o_[7]=oV,o_[8]=oL,o_[9]=oU,o_[10]=oh,o_[11]=op,o_[12]=oi,o_[13]=ov,o_[14]=ox,o_[15]=oj}ov(oP,"laya.d3.math.Matrix4x4");var oo=oP.prototype;return oS.imps(oo,{"laya.d3.core.IClone":!0}),oo.getElementByRowColumn=function(oo,or){if(oo<0||3<oo)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(or<0||3<or)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*oo+or]},oo.setElementByRowColumn=function(oo,or,oT){if(oo<0||3<oo)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(or<0||3<or)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*oo+or]=oT},oo.equalsOtherMatrix=function(oo){var or=this.elements,oT=oo.elements;return oEo.nearEqual(or[0],oT[0])&&oEo.nearEqual(or[1],oT[1])&&oEo.nearEqual(or[2],oT[2])&&oEo.nearEqual(or[3],oT[3])&&oEo.nearEqual(or[4],oT[4])&&oEo.nearEqual(or[5],oT[5])&&oEo.nearEqual(or[6],oT[6])&&oEo.nearEqual(or[7],oT[7])&&oEo.nearEqual(or[8],oT[8])&&oEo.nearEqual(or[9],oT[9])&&oEo.nearEqual(or[10],oT[10])&&oEo.nearEqual(or[11],oT[11])&&oEo.nearEqual(or[12],oT[12])&&oEo.nearEqual(or[13],oT[13])&&oEo.nearEqual(or[14],oT[14])&&oEo.nearEqual(or[15],oT[15])},oo.decomposeTransRotScale=function(oo,or,oT){var ok=oP._tempMatrix4x4;return this.decomposeTransRotMatScale(oo,ok,oT)?(oTr.createFromMatrix4x4(ok,or),!0):(or.identity(),!1)},oo.decomposeTransRotMatScale=function(oo,or,oT){var ok=this.elements,oW=oo.elements,oD=or.elements,on=oT.elements;oW[0]=ok[12],oW[1]=ok[13],oW[2]=ok[14];var oV=ok[0],oL=ok[1],oU=ok[2],oh=ok[4],op=ok[5],oi=ok[6],ov=ok[8],ox=ok[9],oj=ok[10],o_=on[0]=Math.sqrt(oV*oV+oL*oL+oU*oU),oK=on[1]=Math.sqrt(oh*oh+op*op+oi*oi),o$=on[2]=Math.sqrt(ov*ov+ox*ox+oj*oj);if(oEo.isZero(o_)||oEo.isZero(oK)||oEo.isZero(o$))return oD[1]=oD[2]=oD[3]=oD[4]=oD[6]=oD[7]=oD[8]=oD[9]=oD[11]=oD[12]=oD[13]=oD[14]=0,oD[0]=oD[5]=oD[10]=oD[15]=1,!1;var oy=oP._tempVector0,ol=oy.elements;ol[0]=ov/o$,ol[1]=ox/o$,ol[2]=oj/o$;var oS=oP._tempVector1,oq=oS.elements;oq[0]=oV/o_,oq[1]=oL/o_,oq[2]=oU/o_;var ob=oP._tempVector2;onr.cross(oy,oS,ob);var oF=oP._tempVector1;return onr.cross(ob,oy,oF),oD[3]=oD[7]=oD[11]=oD[12]=oD[13]=oD[14]=0,oD[15]=1,oD[0]=oF.x,oD[1]=oF.y,oD[2]=oF.z,oD[4]=ob.x,oD[5]=ob.y,oD[6]=ob.z,oD[8]=oy.x,oD[9]=oy.y,oD[10]=oy.z,oD[0]*oV+oD[1]*oL+oD[2]*oU<0&&(on[0]=-o_),oD[4]*oh+oD[5]*op+oD[6]*oi<0&&(on[1]=-oK),oD[8]*ov+oD[9]*ox+oD[10]*oj<0&&(on[2]=-o$),!0},oo.decomposeYawPitchRoll=function(oo){var or=oo.elements,oT=Math.asin(-this.elements[9]);or[1]=oT,Math.cos(oT)>oEo.zeroTolerance?(or[2]=Math.atan2(this.elements[1],this.elements[5]),or[0]=Math.atan2(this.elements[8],this.elements[10])):(or[2]=Math.atan2(-this.elements[4],this.elements[0]),or[0]=0)},oo.normalize=function(){var oo=this.elements,or=oo[0],oT=oo[1],ok=oo[2],oW=Math.sqrt(or*or+oT*oT+ok*ok);if(!oW)return oo[0]=0,oo[1]=0,void(oo[2]=0);1!=oW&&(oW=1/oW,oo[0]=or*oW,oo[1]=oT*oW,oo[2]=ok*oW)},oo.transpose=function(){var oo,or;return or=(oo=this.elements)[1],oo[1]=oo[4],oo[4]=or,or=oo[2],oo[2]=oo[8],oo[8]=or,or=oo[3],oo[3]=oo[12],oo[12]=or,or=oo[6],oo[6]=oo[9],oo[9]=or,or=oo[7],oo[7]=oo[13],oo[13]=or,or=oo[11],oo[11]=oo[14],oo[14]=or,this},oo.invert=function(oo){var or=this.elements,oT=oo.elements,ok=or[0],oW=or[1],oD=or[2],on=or[3],oV=or[4],oL=or[5],oU=or[6],oh=or[7],op=or[8],oi=or[9],ov=or[10],ox=or[11],oj=or[12],o_=or[13],oK=or[14],o$=or[15],oy=ok*oL-oW*oV,ol=ok*oU-oD*oV,oS=ok*oh-on*oV,oq=oW*oU-oD*oL,ob=oW*oh-on*oL,oF=oD*oh-on*oU,oP=op*o_-oi*oj,ot=op*oK-ov*oj,oH=op*o$-ox*oj,oR=oi*oK-ov*o_,ou=oi*o$-ox*o_,os=ov*o$-ox*oK,oz=oy*os-ol*ou+oS*oR+oq*oH-ob*ot+oF*oP;0!==Math.abs(oz)&&(oz=1/oz,oT[0]=(oL*os-oU*ou+oh*oR)*oz,oT[1]=(oD*ou-oW*os-on*oR)*oz,oT[2]=(o_*oF-oK*ob+o$*oq)*oz,oT[3]=(ov*ob-oi*oF-ox*oq)*oz,oT[4]=(oU*oH-oV*os-oh*ot)*oz,oT[5]=(ok*os-oD*oH+on*ot)*oz,oT[6]=(oK*oS-oj*oF-o$*ol)*oz,oT[7]=(op*oF-ov*oS+ox*ol)*oz,oT[8]=(oV*ou-oL*oH+oh*oP)*oz,oT[9]=(oW*oH-ok*ou-on*oP)*oz,oT[10]=(oj*ob-o_*oS+o$*oy)*oz,oT[11]=(oi*oS-op*ob-ox*oy)*oz,oT[12]=(oL*ot-oV*oR-oU*oP)*oz,oT[13]=(ok*oR-oW*ot+oD*oP)*oz,oT[14]=(o_*ol-oj*oq-oK*oy)*oz,oT[15]=(op*oq-oi*ol+ov*oy)*oz)},oo.identity=function(){var oo=this.elements;oo[1]=oo[2]=oo[3]=oo[4]=oo[6]=oo[7]=oo[8]=oo[9]=oo[11]=oo[12]=oo[13]=oo[14]=0,oo[0]=oo[5]=oo[10]=oo[15]=1},oo.cloneTo=function(oo){var or,oT,ok;if((oT=this.elements)!==(ok=oo.elements))for(or=0;or<16;++or)ok[or]=oT[or]},oo.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},oo.getTranslationVector=function(oo){var or=this.elements,oT=oo.elements;oT[0]=or[12],oT[1]=or[13],oT[2]=or[14]},oo.setTranslationVector=function(oo){var or=this.elements,oT=oo.elements;or[12]=oT[0],or[13]=oT[1],or[14]=oT[2]},oo.getForward=function(oo){var or=this.elements,oT=oo.elements;oT[0]=-or[8],oT[1]=-or[9],oT[2]=-or[10]},oo.setForward=function(oo){var or=this.elements,oT=oo.elements;or[8]=-oT[0],or[9]=-oT[1],or[10]=-oT[2]},oP.createRotationX=function(oo,or){var oT=or.elements,ok=Math.sin(oo),oW=Math.cos(oo);oT[1]=oT[2]=oT[3]=oT[4]=oT[7]=oT[8]=oT[11]=oT[12]=oT[13]=oT[14]=0,oT[0]=oT[15]=1,oT[5]=oT[10]=oW,oT[6]=ok,oT[9]=-ok},oP.createRotationY=function(oo,or){var oT=or.elements,ok=Math.sin(oo),oW=Math.cos(oo);oT[1]=oT[3]=oT[4]=oT[6]=oT[7]=oT[9]=oT[11]=oT[12]=oT[13]=oT[14]=0,oT[5]=oT[15]=1,oT[0]=oT[10]=oW,oT[2]=-ok,oT[8]=ok},oP.createRotationZ=function(oo,or){var oT=or.elements,ok=Math.sin(oo),oW=Math.cos(oo);oT[2]=oT[3]=oT[6]=oT[7]=oT[8]=oT[9]=oT[11]=oT[12]=oT[13]=oT[14]=0,oT[10]=oT[15]=1,oT[0]=oT[5]=oW,oT[1]=ok,oT[4]=-ok},oP.createRotationYawPitchRoll=function(oo,or,oT,ok){oTr.createFromYawPitchRoll(oo,or,oT,oP._tempQuaternion),oP.createRotationQuaternion(oP._tempQuaternion,ok)},oP.createRotationAxis=function(oo,or,oT){var ok=oo.elements,oW=ok[0],oD=ok[1],on=ok[2],oV=Math.cos(or),oL=Math.sin(or),oU=oW*oW,oh=oD*oD,op=on*on,oi=oW*oD,ov=oW*on,ox=oD*on,oj=oT.elements;oj[3]=oj[7]=oj[11]=oj[12]=oj[13]=oj[14]=0,oj[15]=1,oj[0]=oU+oV*(1-oU),oj[1]=oi-oV*oi+oL*on,oj[2]=ov-oV*ov-oL*oD,oj[4]=oi-oV*oi-oL*on,oj[5]=oh+oV*(1-oh),oj[6]=ox-oV*ox+oL*oW,oj[8]=ov-oV*ov+oL*oD,oj[9]=ox-oV*ox-oL*oW,oj[10]=op+oV*(1-op)},oP.createRotationQuaternion=function(oo,or){var oT=oo.elements,ok=or.elements,oW=oT[0],oD=oT[1],on=oT[2],oV=oT[3],oL=oW*oW,oU=oD*oD,oh=on*on,op=oW*oD,oi=on*oV,ov=on*oW,ox=oD*oV,oj=oD*on,o_=oW*oV;ok[3]=ok[7]=ok[11]=ok[12]=ok[13]=ok[14]=0,ok[15]=1,ok[0]=1-2*(oU+oh),ok[1]=2*(op+oi),ok[2]=2*(ov-ox),ok[4]=2*(op-oi),ok[5]=1-2*(oh+oL),ok[6]=2*(oj+o_),ok[8]=2*(ov+ox),ok[9]=2*(oj-o_),ok[10]=1-2*(oU+oL)},oP.createTranslate=function(oo,or){var oT=oo.elements,ok=or.elements;ok[4]=ok[8]=ok[1]=ok[9]=ok[2]=ok[6]=ok[3]=ok[7]=ok[11]=0,ok[0]=ok[5]=ok[10]=ok[15]=1,ok[12]=oT[0],ok[13]=oT[1],ok[14]=oT[2]},oP.createScaling=function(oo,or){var oT=oo.elements,ok=or.elements;ok[0]=oT[0],ok[5]=oT[1],ok[10]=oT[2],ok[1]=ok[4]=ok[8]=ok[12]=ok[9]=ok[13]=ok[2]=ok[6]=ok[14]=ok[3]=ok[7]=ok[11]=0,ok[15]=1},oP.multiply=function(oo,or,oT){var ok,oW,oD,on,oV,oL,oU,oh;for(oW=oT.elements,oD=oo.elements,oW===(on=or.elements)&&(on=on.slice()),ok=0;ok<4;ok++)oV=oD[ok],oL=oD[ok+4],oU=oD[ok+8],oh=oD[ok+12],oW[ok]=oV*on[0]+oL*on[1]+oU*on[2]+oh*on[3],oW[ok+4]=oV*on[4]+oL*on[5]+oU*on[6]+oh*on[7],oW[ok+8]=oV*on[8]+oL*on[9]+oU*on[10]+oh*on[11],oW[ok+12]=oV*on[12]+oL*on[13]+oU*on[14]+oh*on[15]},oP.createFromQuaternion=function(oo,or){var oT=or.elements,ok=oo.elements,oW=ok[0],oD=ok[1],on=ok[2],oV=ok[3],oL=oW+oW,oU=oD+oD,oh=on+on,op=oW*oL,oi=oD*oL,ov=oD*oU,ox=on*oL,oj=on*oU,o_=on*oh,oK=oV*oL,o$=oV*oU,oy=oV*oh;oT[0]=1-ov-o_,oT[1]=oi+oy,oT[2]=ox-o$,oT[3]=0,oT[4]=oi-oy,oT[5]=1-op-o_,oT[6]=oj+oK,oT[7]=0,oT[8]=ox+o$,oT[9]=oj-oK,oT[10]=1-op-ov,oT[11]=0,oT[12]=0,oT[13]=0,oT[14]=0,oT[15]=1},oP.createAffineTransformation=function(oo,or,oT,ok){var oW=oo.elements,oD=or.elements,on=oT.elements,oV=ok.elements,oL=oD[0],oU=oD[1],oh=oD[2],op=oD[3],oi=oL+oL,ov=oU+oU,ox=oh+oh,oj=oL*oi,o_=oL*ov,oK=oL*ox,o$=oU*ov,oy=oU*ox,ol=oh*ox,oS=op*oi,oq=op*ov,ob=op*ox,oF=on[0],oP=on[1],ot=on[2];oV[0]=(1-(o$+ol))*oF,oV[1]=(o_+ob)*oF,oV[2]=(oK-oq)*oF,oV[3]=0,oV[4]=(o_-ob)*oP,oV[5]=(1-(oj+ol))*oP,oV[6]=(oy+oS)*oP,oV[7]=0,oV[8]=(oK+oq)*ot,oV[9]=(oy-oS)*ot,oV[10]=(1-(oj+o$))*ot,oV[11]=0,oV[12]=oW[0],oV[13]=oW[1],oV[14]=oW[2],oV[15]=1},oP.createLookAt=function(oo,or,oT,ok){var oW=ok.elements,oD=oP._tempVector0,on=oP._tempVector1,oV=oP._tempVector2;onr.subtract(oo,or,oV),onr.normalize(oV,oV),onr.cross(oT,oV,oD),onr.normalize(oD,oD),onr.cross(oV,oD,on),ok.identity(),oW[0]=oD.x,oW[4]=oD.y,oW[8]=oD.z,oW[1]=on.x,oW[5]=on.y,oW[9]=on.z,oW[2]=oV.x,oW[6]=oV.y,oW[10]=oV.z,oW[12]=-onr.dot(oD,oo),oW[13]=-onr.dot(on,oo),oW[14]=-onr.dot(oV,oo)},oP.createPerspective=function(oo,or,oT,ok,oW){var oD=oW.elements,on=1/Math.tan(oo/2),oV=1/(oT-ok);oD[0]=on/or,oD[5]=on,oD[10]=(ok+oT)*oV,oD[11]=-1,oD[14]=2*ok*oT*oV,oD[1]=oD[2]=oD[3]=oD[4]=oD[6]=oD[7]=oD[8]=oD[9]=oD[12]=oD[13]=oD[15]=0},oP.createOrthoOffCenterRH=function(oo,or,oT,ok,oW,oD,on){var oV=on.elements,oL=1/(oo-or),oU=1/(oT-ok),oh=1/(oW-oD);oV[1]=oV[2]=oV[3]=oV[4]=oV[6]=oV[7]=oV[8]=oV[9]=oV[11]=0,oV[15]=1,oV[0]=-2*oL,oV[5]=-2*oU,oV[10]=2*oh,oV[12]=(oo+or)*oL,oV[13]=(ok+oT)*oU,oV[14]=(oD+oW)*oh},oP.translation=function(oo,or){var oT=oo.elements,ok=or.elements;ok[0]=ok[5]=ok[10]=ok[15]=1,ok[12]=oT[0],ok[13]=oT[1],ok[14]=oT[2]},op(oP,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new oP},"_tempVector0",function(){return this._tempVector0=new onr},"_tempVector1",function(){return this._tempVector1=new onr},"_tempVector2",function(){return this._tempVector2=new onr},"_tempQuaternion",function(){return this._tempQuaternion=new oTr},"DEFAULT",function(){return this.DEFAULT=new oP},"ZERO",function(){return this.ZERO=new oP(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),oP}(),orr=(function(){function oy(oo,or){this.extents=null,this.transformation=null,this.extents=oo,this.transformation=or}ov(oy,"laya.d3.math.OrientedBoundBox");var oo=oy.prototype;oo.getCorners=function(oo){var or=oy._tempV30.elements,oT=oy._tempV31.elements,ok=oy._tempV32.elements,oW=this.extents.elements;or[0]=oW[0],or[1]=or[2]=0,oT[1]=oW[1],oT[0]=oT[2]=0,ok[2]=oW[2],ok[0]=ok[1]=0,onr.TransformNormal(oy._tempV30,this.transformation,oy._tempV30),onr.TransformNormal(oy._tempV31,this.transformation,oy._tempV31),onr.TransformNormal(oy._tempV32,this.transformation,oy._tempV32);var oD=oy._tempV33;this.transformation.getTranslationVector(oD),oo.length=8,onr.add(oD,oy._tempV30,oy._tempV34),onr.add(oy._tempV34,oy._tempV31,oy._tempV34),onr.add(oy._tempV34,oy._tempV32,oo[0]),onr.add(oD,oy._tempV30,oy._tempV34),onr.add(oy._tempV34,oy._tempV31,oy._tempV34),onr.subtract(oy._tempV34,oy._tempV32,oo[1]),onr.subtract(oD,oy._tempV30,oy._tempV34),onr.add(oy._tempV34,oy._tempV31,oy._tempV34),onr.subtract(oy._tempV34,oy._tempV32,oo[2]),onr.subtract(oD,oy._tempV30,oy._tempV34),onr.add(oy._tempV34,oy._tempV31,oy._tempV34),onr.add(oy._tempV34,oy._tempV32,oo[3]),onr.add(oD,oy._tempV30,oy._tempV34),onr.subtract(oy._tempV34,oy._tempV31,oy._tempV34),onr.add(oy._tempV34,oy._tempV32,oo[4]),onr.add(oD,oy._tempV30,oy._tempV34),onr.subtract(oy._tempV34,oy._tempV31,oy._tempV34),onr.subtract(oy._tempV34,oy._tempV32,oo[5]),onr.subtract(oD,oy._tempV30,oy._tempV34),onr.subtract(oy._tempV34,oy._tempV31,oy._tempV34),onr.subtract(oy._tempV34,oy._tempV32,oo[6]),onr.subtract(oD,oy._tempV30,oy._tempV34),onr.subtract(oy._tempV34,oy._tempV31,oy._tempV34),onr.add(oy._tempV34,oy._tempV32,oo[7])},oo.transform=function(oo){oor.multiply(this.transformation,oo,this.transformation)},oo.scale=function(oo){onr.multiply(this.extents,oo,this.extents)},oo.translate=function(oo){this.transformation.getTranslationVector(oy._tempV30),onr.add(oy._tempV30,oo,oy._tempV31),this.transformation.setTranslationVector(oy._tempV31)},oo.Size=function(oo){onr.scale(this.extents,2,oo)},oo.getSize=function(oo){var or=this.extents.elements;oy._tempV30.x=or[0],oy._tempV31.y=or[1],oy._tempV32.z=or[2],onr.TransformNormal(oy._tempV30,this.transformation,oy._tempV30),onr.TransformNormal(oy._tempV31,this.transformation,oy._tempV31),onr.TransformNormal(oy._tempV31,this.transformation,oy._tempV32);var oT=oo.elements;oT[0]=onr.scalarLength(oy._tempV30),oT[1]=onr.scalarLength(oy._tempV31),oT[2]=onr.scalarLength(oy._tempV32)},oo.getSizeSquared=function(oo){var or=this.extents.elements;oy._tempV30.x=or[0],oy._tempV31.y=or[1],oy._tempV32.z=or[2],onr.TransformNormal(oy._tempV30,this.transformation,oy._tempV30),onr.TransformNormal(oy._tempV31,this.transformation,oy._tempV31),onr.TransformNormal(oy._tempV31,this.transformation,oy._tempV32);var oT=oo.elements;oT[0]=onr.scalarLengthSquared(oy._tempV30),oT[1]=onr.scalarLengthSquared(oy._tempV31),oT[2]=onr.scalarLengthSquared(oy._tempV32)},oo.getCenter=function(oo){this.transformation.getTranslationVector(oo)},oo.containsPoint=function(oo){var or=this.extents.elements,oT=or[0],ok=or[1],oW=or[2];this.transformation.invert(oy._tempM0),onr.transformCoordinate(oo,oy._tempM0,oy._tempV30);var oD=oy._tempV30.elements,on=Math.abs(oD[0]),oV=Math.abs(oD[1]),oL=Math.abs(oD[2]);return oEo.nearEqual(on,oT)&&oEo.nearEqual(oV,ok)&&oEo.nearEqual(oL,oW)?2:on<oT&&oV<ok&&oL<oW?1:0},oo.containsPoints=function(oo){var or=this.extents.elements,oT=or[0],ok=or[1],oW=or[2];this.transformation.invert(oy._tempM0);for(var oD=!0,on=!1,oV=0;oV<oo.length;oV++){onr.transformCoordinate(oo[oV],oy._tempM0,oy._tempV30);var oL=oy._tempV30.elements,oU=Math.abs(oL[0]),oh=Math.abs(oL[1]),op=Math.abs(oL[2]);oEo.nearEqual(oU,oT)&&oEo.nearEqual(oh,ok)&&oEo.nearEqual(op,oW)&&(on=!0),oU<oT&&oh<ok&&op<oW?on=!0:oD=!1}return oD?1:on?2:0},oo.containsSphere=function(oo,or){void 0===or&&(or=!1);var oT=this.extents.elements,ok=oT[0],oW=oT[1],oD=oT[2],on=oo.radius;this.transformation.invert(oy._tempM0),onr.transformCoordinate(oo.center,oy._tempM0,oy._tempV30);var oV=NaN;if(oV=or?on:(onr.scale(onr.UnitX,on,oy._tempV31),onr.TransformNormal(oy._tempV31,oy._tempM0,oy._tempV31),onr.scalarLength(oy._tempV31)),onr.scale(this.extents,-1,oy._tempV32),onr.Clamp(oy._tempV30,oy._tempV32,this.extents,oy._tempV33),oV*oV<onr.distanceSquared(oy._tempV30,oy._tempV33))return 0;var oL=oy._tempV30.elements,oU=oL[0],oh=oL[1],op=oL[2],oi=oy._tempV32.elements,ov=oi[0],ox=oi[1],oj=oi[2];return ov+oV<=oU&&oU<=ok-oV&&oV<ok-ov&&ox+oV<=oh&&oh<=oW-oV&&oV<oW-ox&&oj+oV<=op&&op<=oD-oV&&oV<oD-oj?1:2},oo.containsOrientedBoundBox=function(oo){var or=0,oT=0;oo.getCorners(oy._corners);var ok=this.containsPoints(oy._corners);if(0!=ok)return ok;var oW=this.extents.elements;oo.extents.cloneTo(oy._tempV35);var oD=oy._tempV35.elements;oy._getRows(this.transformation,oy._rows1),oy._getRows(oo.transformation,oy._rows2);var on=NaN;for(or=0;or<4;or++)for(oT=0;oT<4;oT++)3==or||3==oT?(oy._tempM0.setElementByRowColumn(or,oT,0),oy._tempM1.setElementByRowColumn(or,oT,0)):(on=onr.dot(oy._rows1[or],oy._rows2[oT]),oy._tempM0.setElementByRowColumn(or,oT,on),oy._tempM1.setElementByRowColumn(or,oT,Math.abs(on)));oo.getCenter(oy._tempV34),this.getCenter(oy._tempV36),onr.subtract(oy._tempV34,oy._tempV36,oy._tempV30);var oV=oy._tempV31.elements;oV[0]=onr.dot(oy._tempV30,oy._rows1[0]),oV[1]=onr.dot(oy._tempV30,oy._rows1[1]),oV[2]=onr.dot(oy._tempV30,oy._rows1[2]);var oL=oy._tempV32.elements,oU=oy._tempV33.elements;for(or=0;or<3;or++)if(oL[0]=oy._tempM1.getElementByRowColumn(or,0),oL[1]=oy._tempM1.getElementByRowColumn(or,1),oL[2]=oy._tempM1.getElementByRowColumn(or,2),oW[or]+onr.dot(oy._tempV35,oy._tempV32)<Math.abs(oV[or]))return 0;for(oT=0;oT<3;oT++)if(oL[0]=oy._tempM1.getElementByRowColumn(0,oT),oL[1]=oy._tempM1.getElementByRowColumn(1,oT),oL[2]=oy._tempM1.getElementByRowColumn(2,oT),oU[0]=oy._tempM0.getElementByRowColumn(0,oT),oU[1]=oy._tempM0.getElementByRowColumn(1,oT),oU[2]=oy._tempM0.getElementByRowColumn(2,oT),onr.dot(this.extents,oy._tempV32)+oD[oT]<Math.abs(onr.dot(oy._tempV31,oy._tempV33)))return 0;for(or=0;or<3;or++)for(oT=0;oT<3;oT++){var oh=(or+1)%3,op=(or+2)%3,oi=(oT+1)%3,ov=(oT+2)%3;if(oW[oh]*oy._tempM1.getElementByRowColumn(op,oT)+oW[op]*oy._tempM1.getElementByRowColumn(oh,oT)+(oD[oi]*oy._tempM1.getElementByRowColumn(or,ov)+oD[ov]*oy._tempM1.getElementByRowColumn(or,oi))<Math.abs(oV[op]*oy._tempM0.getElementByRowColumn(oh,oT)-oV[oh]*oy._tempM0.getElementByRowColumn(op,oT)))return 0}return 2},oo.containsLine=function(oo,or){oy._corners[0]=oo,oy._corners[1]=or;var oT=this.containsPoints(oy._corners);if(0!=oT)return oT;var ok=this.extents.elements,oW=ok[0],oD=ok[1],on=ok[2];this.transformation.invert(oy._tempM0),onr.transformCoordinate(oo,oy._tempM0,oy._tempV30),onr.transformCoordinate(or,oy._tempM0,oy._tempV31),onr.add(oy._tempV30,oy._tempV31,oy._tempV32),onr.scale(oy._tempV32,.5,oy._tempV32),onr.subtract(oy._tempV30,oy._tempV32,oy._tempV33);var oV=oy._tempV33.elements,oL=oV[0],oU=oV[1],oh=oV[2],op=oy._tempV34.elements,oi=op[0]=Math.abs(oV[0]),ov=op[1]=Math.abs(oV[1]),ox=op[2]=Math.abs(oV[2]),oj=oy._tempV32.elements,o_=oj[0],oK=oj[1],o$=oj[2];return Math.abs(o_)>oW+oi?0:Math.abs(oK)>oD+ov?0:Math.abs(o$)>on+ox?0:Math.abs(oK*oh-o$*oU)>oD*ox+on*ov?0:Math.abs(o_*oh-o$*oL)>oW*ox+on*oi?0:Math.abs(o_*oU-oK*oL)>oW*ov+oD*oi?0:2},oo.containsBoundBox=function(oo){var or=0,oT=0,ok=oo.min,oW=oo.max;oo.getCorners(oy._corners);var oD=this.containsPoints(oy._corners);if(0!=oD)return oD;onr.subtract(oW,ok,oy._tempV30),onr.scale(oy._tempV30,.5,oy._tempV30),onr.add(ok,oy._tempV30,oy._tempV30),onr.subtract(oW,oy._tempV30,oy._tempV31);var on=this.extents.elements,oV=oy._tempV31.elements;oy._getRows(this.transformation,oy._rows1),this.transformation.invert(oy._tempM0);for(or=0;or<3;or++)for(oT=0;oT<3;oT++)oy._tempM1.setElementByRowColumn(or,oT,Math.abs(oy._tempM0.getElementByRowColumn(or,oT)));this.getCenter(oy._tempV35),onr.subtract(oy._tempV30,oy._tempV35,oy._tempV32);var oL=oy._tempV31.elements;oL[0]=onr.dot(oy._tempV32,oy._rows1[0]),oL[1]=onr.dot(oy._tempV32,oy._rows1[1]),oL[2]=onr.dot(oy._tempV32,oy._rows1[2]);var oU=oy._tempV33.elements,oh=oy._tempV34.elements;for(or=0;or<3;or++)if(oU[0]=oy._tempM1.getElementByRowColumn(or,0),oU[1]=oy._tempM1.getElementByRowColumn(or,1),oU[2]=oy._tempM1.getElementByRowColumn(or,2),on[or]+onr.dot(oy._tempV31,oy._tempV33)<Math.abs(oL[or]))return 0;for(oT=0;oT<3;oT++)if(oU[0]=oy._tempM1.getElementByRowColumn(0,oT),oU[1]=oy._tempM1.getElementByRowColumn(1,oT),oU[2]=oy._tempM1.getElementByRowColumn(2,oT),oh[0]=oy._tempM0.getElementByRowColumn(0,oT),oh[1]=oy._tempM0.getElementByRowColumn(1,oT),oh[2]=oy._tempM0.getElementByRowColumn(2,oT),onr.dot(this.extents,oy._tempV33)+oV[oT]<Math.abs(onr.dot(oy._tempV31,oy._tempV34)))return 0;for(or=0;or<3;or++)for(oT=0;oT<3;oT++){var op=(or+1)%3,oi=(or+2)%3,ov=(oT+1)%3,ox=(oT+2)%3;if(on[op]*oy._tempM1.getElementByRowColumn(oi,oT)+on[oi]*oy._tempM1.getElementByRowColumn(op,oT)+(oV[ov]*oy._tempM1.getElementByRowColumn(or,ox)+oV[ox]*oy._tempM1.getElementByRowColumn(or,ov))<Math.abs(oL[oi]*oy._tempM0.getElementByRowColumn(op,oT)-oL[op]*oy._tempM0.getElementByRowColumn(oi,oT)))return 0}return 2},oo.intersectsRay=function(oo,or){onr.scale(this.extents,-1,oy._tempV30),this.transformation.invert(oy._tempM0),onr.TransformNormal(oo.direction,oy._tempM0,oy._ray.direction),onr.transformCoordinate(oo.origin,oy._tempM0,oy._ray.origin),oy._boxBound1.min=oy._tempV30,oy._boxBound1.max=this.extents;var oT=Collision.intersectsRayAndBoxRP(oy._ray,oy._boxBound1,or);return-1!==oT&&onr.transformCoordinate(or,this.transformation,or),oT},oo._getLocalCorners=function(oo){oo.length=8;var or=this.extents.elements;oy._tempV30.x=or[0],oy._tempV31.y=or[1],oy._tempV32.z=or[2],onr.add(oy._tempV30,oy._tempV31,oy._tempV33),onr.add(oy._tempV33,oy._tempV32,oo[0]),onr.add(oy._tempV30,oy._tempV31,oy._tempV33),onr.subtract(oy._tempV33,oy._tempV32,oo[1]),onr.subtract(oy._tempV31,oy._tempV30,oy._tempV33),onr.subtract(oy._tempV33,oy._tempV30,oo[2]),onr.subtract(oy._tempV31,oy._tempV30,oy._tempV33),onr.add(oy._tempV33,oy._tempV32,oo[3]),onr.subtract(oy._tempV30,oy._tempV31,oy._tempV33),onr.add(oy._tempV33,oy._tempV32,oo[4]),onr.subtract(oy._tempV30,oy._tempV31,oy._tempV33),onr.subtract(oy._tempV33,oy._tempV32,oo[5]),onr.scale(oo[0],-1,oo[6]),onr.subtract(oy._tempV32,oy._tempV30,oy._tempV33),onr.subtract(oy._tempV33,oy._tempV31,oo[7])},oo.equals=function(oo){return this.extents==oo.extents&&this.transformation==oo.transformation},oo.cloneTo=function(oo){var or=oo;this.extents.cloneTo(or.extents),this.transformation.cloneTo(or.transformation)},oy.createByBoundBox=function(oo,or){var oT=oo.min,ok=oo.max;onr.subtract(ok,oT,oy._tempV30),onr.scale(oy._tempV30,.5,oy._tempV30),onr.add(oT,oy._tempV30,oy._tempV31),onr.subtract(ok,oy._tempV31,oy._tempV32),oor.translation(oy._tempV31,oy._tempM0);var oW=oy._tempV32.clone(),oD=oy._tempM0.clone();or.extents=oW,or.transformation=oD},oy.createByMinAndMaxVertex=function(oo,or){return onr.subtract(or,oo,oy._tempV30),onr.scale(oy._tempV30,.5,oy._tempV30),onr.add(oo,oy._tempV30,oy._tempV31),onr.subtract(or,oy._tempV31,oy._tempV32),oor.translation(oy._tempV31,oy._tempM0),new oy(oy._tempV32,oy._tempM0)},oy._getRows=function(oo,or){or.length=3;var oT=oo.elements,ok=or[0].elements;ok[0]=oT[0],ok[1]=oT[1],ok[2]=oT[2];var oW=or[1].elements;oW[0]=oT[4],oW[1]=oT[5],oW[2]=oT[6];var oD=or[2].elements;oD[0]=oT[8],oD[1]=oT[9],oD[2]=oT[10]},oy.getObbtoObbMatrix4x4=function(oo,or,oT,ok){var oW=oo.transformation,oD=or.transformation;if(oT){oy._getRows(oW,oy._rows1),oy._getRows(oD,oy._rows2);for(var on=0;on<3;on++)for(var oV=0;oV<3;oV++)ok.setElementByRowColumn(on,oV,onr.dot(oy._rows2[on],oy._rows1[oV]));or.getCenter(oy._tempV30),oo.getCenter(oy._tempV31),onr.subtract(oy._tempV30,oy._tempV31,oy._tempV32);var oL=ok.elements;oL[12]=onr.dot(oy._tempV32,oy._rows1[0]),oL[13]=onr.dot(oy._tempV32,oy._rows1[1]),oL[14]=onr.dot(oy._tempV32,oy._rows1[2]),oL[15]=1}else oW.invert(oy._tempM0),oor.multiply(oD,oy._tempM0,ok)},oy.merge=function(oo,or,oT){var ok=oo.extents,oW=oo.transformation;oy.getObbtoObbMatrix4x4(oo,or,oT,oy._tempM0),or._getLocalCorners(oy._corners),onr.transformCoordinate(oy._corners[0],oy._tempM0,oy._corners[0]),onr.transformCoordinate(oy._corners[1],oy._tempM0,oy._corners[1]),onr.transformCoordinate(oy._corners[2],oy._tempM0,oy._corners[2]),onr.transformCoordinate(oy._corners[3],oy._tempM0,oy._corners[3]),onr.transformCoordinate(oy._corners[4],oy._tempM0,oy._corners[4]),onr.transformCoordinate(oy._corners[5],oy._tempM0,oy._corners[5]),onr.transformCoordinate(oy._corners[6],oy._tempM0,oy._corners[6]),onr.transformCoordinate(oy._corners[7],oy._tempM0,oy._corners[7]),onr.scale(ok,-1,oy._boxBound1.min),ok.cloneTo(oy._boxBound1.max),oQo.createfromPoints(oy._corners,oy._boxBound2),oQo.merge(oy._boxBound2,oy._boxBound1,oy._boxBound3);var oD=oy._boxBound3.min,on=oy._boxBound3.max;onr.subtract(on,oD,oy._tempV30),onr.scale(oy._tempV30,.5,oy._tempV30),onr.add(oD,oy._tempV30,oy._tempV32),onr.subtract(on,oy._tempV32,ok),onr.transformCoordinate(oy._tempV32,oW,oy._tempV33)},op(oy,["_tempV30",function(){return this._tempV30=new onr},"_tempV31",function(){return this._tempV31=new onr},"_tempV32",function(){return this._tempV32=new onr},"_tempV33",function(){return this._tempV33=new onr},"_tempV34",function(){return this._tempV34=new onr},"_tempV35",function(){return this._tempV35=new onr},"_tempV36",function(){return this._tempV36=new onr},"_tempM0",function(){return this._tempM0=new oor},"_tempM1",function(){return this._tempM1=new oor},"_corners",function(){return this._corners=[new onr,new onr,new onr,new onr,new onr,new onr,new onr,new onr]},"_rows1",function(){return this._rows1=[new onr,new onr,new onr]},"_rows2",function(){return this._rows2=[new onr,new onr,new onr]},"_ray",function(){return this._ray=new oWr(new onr,new onr)},"_boxBound1",function(){return this._boxBound1=new oQo(new onr,new onr)},"_boxBound2",function(){return this._boxBound2=new oQo(new onr,new onr)},"_boxBound3",function(){return this._boxBound3=new oQo(new onr,new onr)}])}(),function(){function oS(oo,or){this.normal=null,this.distance=NaN,void 0===or&&(or=0),this.normal=oo,this.distance=or}return ov(oS,"laya.d3.math.Plane"),oS.prototype.normalize=function(){var oo=this.normal.elements,or=oo[0],oT=oo[1],ok=oo[2],oW=1/Math.sqrt(or*or+oT*oT+ok*ok);oo[0]=or*oW,oo[1]=oT*oW,oo[2]=ok*oW,this.distance*=oW},oS.createPlaneBy3P=function(oo,or,oT){var ok=oo.elements,oW=or.elements,oD=oT.elements,on=oW[0]-ok[0],oV=oW[1]-ok[1],oL=oW[2]-ok[2],oU=oD[0]-ok[0],oh=oD[1]-ok[1],op=oD[2]-ok[2],oi=oV*op-oL*oh,ov=oL*oU-on*op,ox=on*oh-oV*oU,oj=1/Math.sqrt(oi*oi+ov*ov+ox*ox),o_=oi*oj,oK=ov*oj,o$=ox*oj,oy=oS._TEMPVec3.elements;oy[0]=o_,oy[1]=oK,oy[2]=o$;var ol=-(o_*ok[0]+oK*ok[1]+o$*ok[2]);return new oS(oS._TEMPVec3,ol)},oS.PlaneIntersectionType_Back=0,oS.PlaneIntersectionType_Front=1,oS.PlaneIntersectionType_Intersecting=2,op(oS,["_TEMPVec3",function(){return this._TEMPVec3=new onr}]),oS}()),oTr=function(){function oW(oo,or,oT,ok){this.elements=new Float32Array(4),void 0===oo&&(oo=0),void 0===or&&(or=0),void 0===oT&&(oT=0),void 0===ok&&(ok=1),this.elements[0]=oo,this.elements[1]=or,this.elements[2]=oT,this.elements[3]=ok}ov(oW,"laya.d3.math.Quaternion");var oo=oW.prototype;return oS.imps(oo,{"laya.d3.core.IClone":!0}),oo.scaling=function(oo,or){var oT=or.elements,ok=this.elements;oT[0]=ok[0]*oo,oT[1]=ok[1]*oo,oT[2]=ok[2]*oo,oT[3]=ok[3]*oo},oo.normalize=function(oo){var or=oo.elements,oT=this.elements,ok=oT[0],oW=oT[1],oD=oT[2],on=oT[3],oV=ok*ok+oW*oW+oD*oD+on*on;0<oV&&(oV=1/Math.sqrt(oV),or[0]=ok*oV,or[1]=oW*oV,or[2]=oD*oV,or[3]=on*oV)},oo.length=function(){var oo=this.elements,or=oo[0],oT=oo[1],ok=oo[2],oW=oo[3];return Math.sqrt(or*or+oT*oT+ok*ok+oW*oW)},oo.rotateX=function(oo,or){var oT=or.elements,ok=this.elements;oo*=.5;var oW=ok[0],oD=ok[1],on=ok[2],oV=ok[3],oL=Math.sin(oo),oU=Math.cos(oo);oT[0]=oW*oU+oV*oL,oT[1]=oD*oU+on*oL,oT[2]=on*oU-oD*oL,oT[3]=oV*oU-oW*oL},oo.rotateY=function(oo,or){var oT=or.elements,ok=this.elements;oo*=.5;var oW=ok[0],oD=ok[1],on=ok[2],oV=ok[3],oL=Math.sin(oo),oU=Math.cos(oo);oT[0]=oW*oU-on*oL,oT[1]=oD*oU+oV*oL,oT[2]=on*oU+oW*oL,oT[3]=oV*oU-oD*oL},oo.rotateZ=function(oo,or){var oT=or.elements,ok=this.elements;oo*=.5;var oW=ok[0],oD=ok[1],on=ok[2],oV=ok[3],oL=Math.sin(oo),oU=Math.cos(oo);oT[0]=oW*oU+oD*oL,oT[1]=oD*oU-oW*oL,oT[2]=on*oU+oV*oL,oT[3]=oV*oU-on*oL},oo.getYawPitchRoll=function(oo){onr.transformQuat(onr.ForwardRH,this,oW.TEMPVector31),onr.transformQuat(onr.Up,this,oW.TEMPVector32);var or=oW.TEMPVector32.elements;oW.angleTo(onr.ZERO,oW.TEMPVector31,oW.TEMPVector33);var oT=oW.TEMPVector33.elements;oT[0]==Math.PI/2?(oT[1]=oW.arcTanAngle(or[2],or[0]),oT[2]=0):oT[0]==-Math.PI/2?(oT[1]=oW.arcTanAngle(-or[2],-or[0]),oT[2]=0):(oor.createRotationY(-oT[1],oW.TEMPMatrix0),oor.createRotationX(-oT[0],oW.TEMPMatrix1),onr.transformCoordinate(oW.TEMPVector32,oW.TEMPMatrix0,oW.TEMPVector32),onr.transformCoordinate(oW.TEMPVector32,oW.TEMPMatrix1,oW.TEMPVector32),oT[2]=oW.arcTanAngle(or[1],-or[0])),oT[1]<=-Math.PI&&(oT[1]=Math.PI),oT[2]<=-Math.PI&&(oT[2]=Math.PI),oT[1]>=Math.PI&&oT[2]>=Math.PI&&(oT[1]=0,oT[2]=0,oT[0]=Math.PI-oT[0]);var ok=oo.elements;ok[0]=oT[1],ok[1]=oT[0],ok[2]=oT[2]},oo.invert=function(oo){var or=oo.elements,oT=this.elements,ok=oT[0],oW=oT[1],oD=oT[2],on=oT[3],oV=ok*ok+oW*oW+oD*oD+on*on,oL=oV?1/oV:0;or[0]=-ok*oL,or[1]=-oW*oL,or[2]=-oD*oL,or[3]=on*oL},oo.identity=function(){var oo=this.elements;oo[0]=0,oo[1]=0,oo[2]=0,oo[3]=1},oo.fromArray=function(oo,or){void 0===or&&(or=0),this.elements[0]=oo[or+0],this.elements[1]=oo[or+1],this.elements[2]=oo[or+2],this.elements[3]=oo[or+3]},oo.cloneTo=function(oo){var or,oT,ok;if((oT=this.elements)!==(ok=oo.elements))for(or=0;or<4;++or)ok[or]=oT[or]},oo.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},oo.equals=function(oo){var or=this.elements,oT=oo.elements;return oEo.nearEqual(or[0],oT[0])&&oEo.nearEqual(or[1],oT[1])&&oEo.nearEqual(or[2],oT[2])&&oEo.nearEqual(or[3],oT[3])},oo.lengthSquared=function(){var oo=this.elements[0],or=this.elements[1],oT=this.elements[2],ok=this.elements[3];return oo*oo+or*or+oT*oT+ok*ok},ox(0,oo,"x",function(){return this.elements[0]}),ox(0,oo,"y",function(){return this.elements[1]}),ox(0,oo,"z",function(){return this.elements[2]}),ox(0,oo,"w",function(){return this.elements[3]}),oW.createFromYawPitchRoll=function(oo,or,oT,ok){var oW=.5*oT,oD=.5*or,on=.5*oo,oV=Math.sin(oW),oL=Math.cos(oW),oU=Math.sin(oD),oh=Math.cos(oD),op=Math.sin(on),oi=Math.cos(on),ov=ok.elements;ov[0]=oi*oU*oL+op*oh*oV,ov[1]=op*oh*oL-oi*oU*oV,ov[2]=oi*oh*oV-op*oU*oL,ov[3]=oi*oh*oL+op*oU*oV},oW.multiply=function(oo,or,oT){var ok=oo.elements,oW=or.elements,oD=oT.elements,on=ok[0],oV=ok[1],oL=ok[2],oU=ok[3],oh=oW[0],op=oW[1],oi=oW[2],ov=oW[3],ox=oV*oi-oL*op,oj=oL*oh-on*oi,o_=on*op-oV*oh,oK=on*oh+oV*op+oL*oi;oD[0]=on*ov+oh*oU+ox,oD[1]=oV*ov+op*oU+oj,oD[2]=oL*ov+oi*oU+o_,oD[3]=oU*ov-oK},oW.arcTanAngle=function(oo,or){return 0==oo?1==or?Math.PI/2:-Math.PI/2:0<oo?Math.atan(or/oo):oo<0?0<or?Math.atan(or/oo)+Math.PI:Math.atan(or/oo)-Math.PI:0},oW.angleTo=function(oo,or,oT){onr.subtract(or,oo,oW.TEMPVector30),onr.normalize(oW.TEMPVector30,oW.TEMPVector30),oT.elements[0]=Math.asin(oW.TEMPVector30.y),oT.elements[1]=oW.arcTanAngle(-oW.TEMPVector30.z,-oW.TEMPVector30.x)},oW.createFromAxisAngle=function(oo,or,oT){var ok=oT.elements,oW=oo.elements;or*=.5;var oD=Math.sin(or);ok[0]=oD*oW[0],ok[1]=oD*oW[1],ok[2]=oD*oW[2],ok[3]=Math.cos(or)},oW.createFromMatrix3x3=function(oo,or){var oT,ok=or.elements,oW=oo.elements,oD=oW[0]+oW[4]+oW[8];if(0<oD)oT=Math.sqrt(oD+1),ok[3]=.5*oT,oT=.5/oT,ok[0]=(oW[5]-oW[7])*oT,ok[1]=(oW[6]-oW[2])*oT,ok[2]=(oW[1]-oW[3])*oT;else{var on=0;oW[4]>oW[0]&&(on=1),oW[8]>oW[3*on+on]&&(on=2);var oV=(on+1)%3,oL=(on+2)%3;oT=Math.sqrt(oW[3*on+on]-oW[3*oV+oV]-oW[3*oL+oL]+1),ok[on]=.5*oT,oT=.5/oT,ok[3]=(oW[3*oV+oL]-oW[3*oL+oV])*oT,ok[oV]=(oW[3*oV+on]+oW[3*on+oV])*oT,ok[oL]=(oW[3*oL+on]+oW[3*on+oL])*oT}},oW.createFromMatrix4x4=function(oo,or){var oT,ok,oW=oo.elements,oD=or.elements,on=oW[0]+oW[5]+oW[10];0<on?(oT=Math.sqrt(on+1),oD[3]=.5*oT,oT=.5/oT,oD[0]=(oW[6]-oW[9])*oT,oD[1]=(oW[8]-oW[2])*oT,oD[2]=(oW[1]-oW[4])*oT):oW[0]>=oW[5]&&oW[0]>=oW[10]?(ok=.5/(oT=Math.sqrt(1+oW[0]-oW[5]-oW[10])),oD[0]=.5*oT,oD[1]=(oW[1]+oW[4])*ok,oD[2]=(oW[2]+oW[8])*ok,oD[3]=(oW[6]-oW[9])*ok):oW[5]>oW[10]?(ok=.5/(oT=Math.sqrt(1+oW[5]-oW[0]-oW[10])),oD[0]=(oW[4]+oW[1])*ok,oD[1]=.5*oT,oD[2]=(oW[9]+oW[6])*ok,oD[3]=(oW[8]-oW[2])*ok):(ok=.5/(oT=Math.sqrt(1+oW[10]-oW[0]-oW[5])),oD[0]=(oW[8]+oW[2])*ok,oD[1]=(oW[9]+oW[6])*ok,oD[2]=.5*oT,oD[3]=(oW[1]-oW[4])*ok)},oW.slerp=function(oo,or,oT,ok){var oW,oD,on,oV,oL,oU=oo.elements,oh=or.elements,op=ok.elements,oi=oU[0],ov=oU[1],ox=oU[2],oj=oU[3],o_=oh[0],oK=oh[1],o$=oh[2],oy=oh[3];return(oD=oi*o_+ov*oK+ox*o$+oj*oy)<0&&(oD=-oD,o_=-o_,oK=-oK,o$=-o$,oy=-oy),oL=1e-6<1-oD?(oW=Math.acos(oD),on=Math.sin(oW),oV=Math.sin((1-oT)*oW)/on,Math.sin(oT*oW)/on):(oV=1-oT,oT),op[0]=oV*oi+oL*o_,op[1]=oV*ov+oL*oK,op[2]=oV*ox+oL*o$,op[3]=oV*oj+oL*oy,op},oW.lerp=function(oo,or,oT,ok){var oW=ok.elements,oD=oo.elements,on=or.elements,oV=oD[0],oL=oD[1],oU=oD[2],oh=oD[3];oW[0]=oV+oT*(on[0]-oV),oW[1]=oL+oT*(on[1]-oL),oW[2]=oU+oT*(on[2]-oU),oW[3]=oh+oT*(on[3]-oh)},oW.add=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or.elements;ok[0]=oW[0]+oD[0],ok[1]=oW[1]+oD[1],ok[2]=oW[2]+oD[2],ok[3]=oW[3]+oD[3]},oW.dot=function(oo,or){var oT=oo.elements,ok=or.elements;return oT[0]*ok[0]+oT[1]*ok[1]+oT[2]*ok[2]+oT[3]*ok[3]},oW.rotationLookAt=function(oo,or,oT){oW.lookAt(onr.ZERO,oo,or,oT)},oW.lookAt=function(oo,or,oT,ok){odo.lookAt(oo,or,oT,oW._tempMatrix3x3),oW.rotationMatrix(oW._tempMatrix3x3,ok)},oW.invert=function(oo,or){var oT=oo.elements,ok=or.elements,oW=oo.lengthSquared();oEo.isZero(oW)||(oW=1/oW,ok[0]=-oT[0]*oW,ok[1]=-oT[1]*oW,ok[2]=-oT[2]*oW,ok[3]=oT[3]*oW)},oW.rotationMatrix=function(oo,or){var oT=oo.elements,ok=oT[0],oW=oT[1],oD=oT[2],on=oT[3],oV=oT[4],oL=oT[5],oU=oT[6],oh=oT[7],op=oT[8],oi=or.elements,ov=NaN,ox=NaN,oj=ok+oV+op;0<oj?(ov=Math.sqrt(oj+1),oi[3]=.5*ov,ov=.5/ov,oi[0]=(oL-oh)*ov,oi[1]=(oU-oD)*ov,oi[2]=(oW-on)*ov):oV<=ok&&op<=ok?(ox=.5/(ov=Math.sqrt(1+ok-oV-op)),oi[0]=.5*ov,oi[1]=(oW+on)*ox,oi[2]=(oD+oU)*ox,oi[3]=(oL-oh)*ox):op<oV?(ox=.5/(ov=Math.sqrt(1+oV-ok-op)),oi[0]=(on+oW)*ox,oi[1]=.5*ov,oi[2]=(oh+oL)*ox,oi[3]=(oU-oD)*ox):(ox=.5/(ov=Math.sqrt(1+op-ok-oV)),oi[0]=(oU+oD)*ox,oi[1]=(oh+oL)*ox,oi[2]=.5*ov,oi[3]=(oW-on)*ox)},oW.DEFAULT=new oW,op(oW,["TEMPVector30",function(){return this.TEMPVector30=new onr},"TEMPVector31",function(){return this.TEMPVector31=new onr},"TEMPVector32",function(){return this.TEMPVector32=new onr},"TEMPVector33",function(){return this.TEMPVector33=new onr},"TEMPMatrix0",function(){return this.TEMPMatrix0=new oor},"TEMPMatrix1",function(){return this.TEMPMatrix1=new oor},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new odo},"NAN",function(){return this.NAN=new oW(NaN,NaN,NaN,NaN)}]),oW}(),okr=function(){function oo(oo){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=oo,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}ov(oo,"laya.d3.math.Rand");var or=oo.prototype;return or.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},or.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},or.getSignedFloat=function(){return 2*this.getFloat()-1},ox(0,or,"seed",function(){return this.seeds[0]},function(oo){this.seeds[0]=oo,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),oo.getFloatFromInt=function(oo){return 1/8388607*(8388607&oo)},oo.getByteFromInt=function(oo){return(8388607&oo)>>>15},oo}(),oWr=(function(){function oW(oo){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(oo instanceof Array)||4!==oo.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|oo[0],this._state0L=0|oo[1],this._state1U=0|oo[2],this._state1L=0|oo[3]}ov(oW,"laya.d3.math.RandX");var oo=oW.prototype;oo.randomint=function(){var oo=this._state0U,or=this._state0L,oT=this._state1U,ok=this._state1L,oW=(ok>>>0)+(or>>>0),oD=oT+oo+(oW/2>>>31)>>>0,on=oW>>>0,oV=0,oL=0;oV=(oo^=oV=oo<<23|(-512&or)>>>9)^(this._state0U=oT),oL=(or^=oL=or<<23)^(this._state0L=ok);oV^=oo>>>18,oL^=or>>>18|(262143&oo)<<14;return oV^=oT>>>5,oL^=ok>>>5|(31&oT)<<27,this._state1U=oV,this._state1L=oL,[oD,on]},oo.random=function(){var oo=this.randomint(),or=oo[0],oT=1023<<20|or>>>12,ok=0|(oo[1]>>>12|(4095&or)<<20);return oW._CONVERTION_BUFFER.setUint32(0,oT,!1),oW._CONVERTION_BUFFER.setUint32(4,ok,!1),okr._CONVERTION_BUFFER.getFloat64(0,!1)-1},op(oW,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new okr([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function oo(oo,or){this.origin=null,this.direction=null,this.origin=oo,this.direction=or}return ov(oo,"laya.d3.math.Ray"),oo}()),oDr=function(){function oo(oo,or){this.elements=new Float32Array(2),void 0===oo&&(oo=0),void 0===or&&(or=0);var oT=this.elements;oT[0]=oo,oT[1]=or}ov(oo,"laya.d3.math.Vector2");var or=oo.prototype;return oS.imps(or,{"laya.d3.core.IClone":!0}),or.fromArray=function(oo,or){void 0===or&&(or=0),this.elements[0]=oo[or+0],this.elements[1]=oo[or+1]},or.cloneTo=function(oo){var or=oo.elements,oT=this.elements;or[0]=oT[0],or[1]=oT[1]},or.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,or,"x",function(){return this.elements[0]},function(oo){this.elements[0]=oo}),ox(0,or,"y",function(){return this.elements[1]},function(oo){this.elements[1]=oo}),oo.scale=function(oo,or,oT){var ok=oT.elements,oW=oo.elements;ok[0]=oW[0]*or,ok[1]=oW[1]*or},op(oo,["ZERO",function(){return this.ZERO=new oo(0,0)},"ONE",function(){return this.ONE=new oo(1,1)}]),oo}(),onr=function(){function oh(oo,or,oT){this.elements=new Float32Array(3),void 0===oo&&(oo=0),void 0===or&&(or=0),void 0===oT&&(oT=0);var ok=this.elements;ok[0]=oo,ok[1]=or,ok[2]=oT}ov(oh,"laya.d3.math.Vector3");var oo=oh.prototype;return oS.imps(oo,{"laya.d3.core.IClone":!0}),oo.fromArray=function(oo,or){void 0===or&&(or=0),this.elements[0]=oo[or+0],this.elements[1]=oo[or+1],this.elements[2]=oo[or+2]},oo.cloneTo=function(oo){var or=oo.elements,oT=this.elements;or[0]=oT[0],or[1]=oT[1],or[2]=oT[2]},oo.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},oo.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},oo.reset=function(oo,or,oT){this.elements[0]=oo,this.elements[1]=or,this.elements[2]=oT},ox(0,oo,"x",function(){return this.elements[0]},function(oo){this.elements[0]=oo}),ox(0,oo,"y",function(){return this.elements[1]},function(oo){this.elements[1]=oo}),ox(0,oo,"z",function(){return this.elements[2]},function(oo){this.elements[2]=oo}),oh.distanceSquared=function(oo,or){var oT=oo.elements,ok=or.elements,oW=oT[0]-ok[0],oD=oT[1]-ok[1],on=oT[2]-ok[2];return oW*oW+oD*oD+on*on},oh.distance=function(oo,or){var oT=oo.elements,ok=or.elements,oW=oT[0]-ok[0],oD=oT[1]-ok[1],on=oT[2]-ok[2];return Math.sqrt(oW*oW+oD*oD+on*on)},oh.min=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or.elements;ok[0]=Math.min(oW[0],oD[0]),ok[1]=Math.min(oW[1],oD[1]),ok[2]=Math.min(oW[2],oD[2])},oh.max=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or.elements;ok[0]=Math.max(oW[0],oD[0]),ok[1]=Math.max(oW[1],oD[1]),ok[2]=Math.max(oW[2],oD[2])},oh.transformQuat=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or.elements,on=oW[0],oV=oW[1],oL=oW[2],oU=oD[0],oh=oD[1],op=oD[2],oi=oD[3],ov=oi*on+oh*oL-op*oV,ox=oi*oV+op*on-oU*oL,oj=oi*oL+oU*oV-oh*on,o_=-oU*on-oh*oV-op*oL;ok[0]=ov*oi+o_*-oU+ox*-op-oj*-oh,ok[1]=ox*oi+o_*-oh+oj*-oU-ov*-op,ok[2]=oj*oi+o_*-op+ov*-oh-ox*-oU},oh.scalarLength=function(oo){var or=oo.elements,oT=or[0],ok=or[1],oW=or[2];return Math.sqrt(oT*oT+ok*ok+oW*oW)},oh.scalarLengthSquared=function(oo){var or=oo.elements,oT=or[0],ok=or[1],oW=or[2];return oT*oT+ok*ok+oW*oW},oh.normalize=function(oo,or){var oT=oo.elements,ok=or.elements,oW=oT[0],oD=oT[1],on=oT[2],oV=oW*oW+oD*oD+on*on;0<oV&&(oV=1/Math.sqrt(oV),ok[0]=oT[0]*oV,ok[1]=oT[1]*oV,ok[2]=oT[2]*oV)},oh.multiply=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or.elements;ok[0]=oW[0]*oD[0],ok[1]=oW[1]*oD[1],ok[2]=oW[2]*oD[2]},oh.scale=function(oo,or,oT){var ok=oT.elements,oW=oo.elements;ok[0]=oW[0]*or,ok[1]=oW[1]*or,ok[2]=oW[2]*or},oh.lerp=function(oo,or,oT,ok){var oW=ok.elements,oD=oo.elements,on=or.elements,oV=oD[0],oL=oD[1],oU=oD[2];oW[0]=oV+oT*(on[0]-oV),oW[1]=oL+oT*(on[1]-oL),oW[2]=oU+oT*(on[2]-oU)},oh.transformV3ToV3=function(oo,or,oT){var ok=oh._tempVector4;oh.transformV3ToV4(oo,or,ok);var oW=ok.elements,oD=oT.elements;oD[0]=oW[0],oD[1]=oW[1],oD[2]=oW[2]},oh.transformV3ToV4=function(oo,or,oT){var ok=oo.elements,oW=ok[0],oD=ok[1],on=ok[2],oV=or.elements,oL=oT.elements;oL[0]=oW*oV[0]+oD*oV[4]+on*oV[8]+oV[12],oL[1]=oW*oV[1]+oD*oV[5]+on*oV[9]+oV[13],oL[2]=oW*oV[2]+oD*oV[6]+on*oV[10]+oV[14],oL[3]=oW*oV[3]+oD*oV[7]+on*oV[11]+oV[15]},oh.TransformNormal=function(oo,or,oT){var ok=oo.elements,oW=ok[0],oD=ok[1],on=ok[2],oV=or.elements,oL=oT.elements;oL[0]=oW*oV[0]+oD*oV[4]+on*oV[8],oL[1]=oW*oV[1]+oD*oV[5]+on*oV[9],oL[2]=oW*oV[2]+oD*oV[6]+on*oV[10]},oh.transformCoordinate=function(oo,or,oT){var ok=oh._tempVector4.elements,oW=oo.elements,oD=oW[0],on=oW[1],oV=oW[2],oL=or.elements;ok[0]=oD*oL[0]+on*oL[4]+oV*oL[8]+oL[12],ok[1]=oD*oL[1]+on*oL[5]+oV*oL[9]+oL[13],ok[2]=oD*oL[2]+on*oL[6]+oV*oL[10]+oL[14],ok[3]=1/(oD*oL[3]+on*oL[7]+oV*oL[11]+oL[15]);var oU=oT.elements;oU[0]=ok[0]*ok[3],oU[1]=ok[1]*ok[3],oU[2]=ok[2]*ok[3]},oh.Clamp=function(oo,or,oT,ok){var oW=oo.elements,oD=oW[0],on=oW[1],oV=oW[2],oL=or.elements,oU=oL[0],oh=oL[1],op=oL[2],oi=oT.elements,ov=oi[0],ox=oi[1],oj=oi[2],o_=ok.elements;oD=(oD=ov<oD?ov:oD)<oU?oU:oD,on=(on=ox<on?ox:on)<oh?oh:on,oV=(oV=oj<oV?oj:oV)<op?op:oV,o_[0]=oD,o_[1]=on,o_[2]=oV},oh.add=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or.elements;ok[0]=oW[0]+oD[0],ok[1]=oW[1]+oD[1],ok[2]=oW[2]+oD[2]},oh.subtract=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or.elements;ok[0]=oW[0]-oD[0],ok[1]=oW[1]-oD[1],ok[2]=oW[2]-oD[2]},oh.cross=function(oo,or,oT){var ok=oo.elements,oW=or.elements,oD=oT.elements,on=ok[0],oV=ok[1],oL=ok[2],oU=oW[0],oh=oW[1],op=oW[2];oD[0]=oV*op-oL*oh,oD[1]=oL*oU-on*op,oD[2]=on*oh-oV*oU},oh.dot=function(oo,or){var oT=oo.elements,ok=or.elements;return oT[0]*ok[0]+oT[1]*ok[1]+oT[2]*ok[2]},oh.equals=function(oo,or){var oT=oo.elements,ok=or.elements;return oEo.nearEqual(Math.abs(oT[0]),Math.abs(ok[0]))&&oEo.nearEqual(Math.abs(oT[1]),Math.abs(ok[1]))&&oEo.nearEqual(Math.abs(oT[2]),Math.abs(ok[2]))},oh.ZERO=new oh(0,0,0),oh.ONE=new oh(1,1,1),oh.NegativeUnitX=new oh(-1,0,0),oh.UnitX=new oh(1,0,0),oh.UnitY=new oh(0,1,0),oh.UnitZ=new oh(0,0,1),oh.ForwardRH=new oh(0,0,-1),oh.ForwardLH=new oh(0,0,1),oh.Up=new oh(0,1,0),oh.NAN=new oh(NaN,NaN,NaN),op(oh,["_tempVector4",function(){return this._tempVector4=new oVr}]),oh}(),oVr=function(){function oo(oo,or,oT,ok){this.elements=new Float32Array(4),void 0===oo&&(oo=0),void 0===or&&(or=0),void 0===oT&&(oT=0),void 0===ok&&(ok=0);var oW=this.elements;oW[0]=oo,oW[1]=or,oW[2]=oT,oW[3]=ok}ov(oo,"laya.d3.math.Vector4");var or=oo.prototype;return oS.imps(or,{"laya.d3.core.IClone":!0}),or.fromArray=function(oo,or){void 0===or&&(or=0),this.elements[0]=oo[or+0],this.elements[1]=oo[or+1],this.elements[2]=oo[or+2],this.elements[3]=oo[or+3]},or.cloneTo=function(oo){var or=oo.elements,oT=this.elements;or[0]=oT[0],or[1]=oT[1],or[2]=oT[2],or[3]=oT[3]},or.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},or.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},or.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},ox(0,or,"x",function(){return this.elements[0]},function(oo){this.elements[0]=oo}),ox(0,or,"y",function(){return this.elements[1]},function(oo){this.elements[1]=oo}),ox(0,or,"z",function(){return this.elements[2]},function(oo){this.elements[2]=oo}),ox(0,or,"w",function(){return this.elements[3]},function(oo){this.elements[3]=oo}),oo.lerp=function(oo,or,oT,ok){var oW=ok.elements,oD=oo.elements,on=or.elements,oV=oD[0],oL=oD[1],oU=oD[2],oh=oD[3];oW[0]=oV+oT*(on[0]-oV),oW[1]=oL+oT*(on[1]-oL),oW[2]=oU+oT*(on[2]-oU),oW[3]=oh+oT*(on[3]-oh)},oo.transformByM4x4=function(oo,or,oT){var ok=oo.elements,oW=ok[0],oD=ok[1],on=ok[2],oV=ok[3],oL=or.elements,oU=oT.elements;oU[0]=oW*oL[0]+oD*oL[4]+on*oL[8]+oV*oL[12],oU[1]=oW*oL[1]+oD*oL[5]+on*oL[9]+oV*oL[13],oU[2]=oW*oL[2]+oD*oL[6]+on*oL[10]+oV*oL[14],oU[3]=oW*oL[3]+oD*oL[7]+on*oL[11]+oV*oL[15]},oo.equals=function(oo,or){var oT=oo.elements,ok=or.elements;return oEo.nearEqual(Math.abs(oT[0]),Math.abs(ok[0]))&&oEo.nearEqual(Math.abs(oT[1]),Math.abs(ok[1]))&&oEo.nearEqual(Math.abs(oT[2]),Math.abs(ok[2]))&&oEo.nearEqual(Math.abs(oT[3]),Math.abs(ok[3]))},oo.normalize=function(oo,or){var oT=oo.elements,ok=or.elements,oW=oo.length();0<oW&&(ok[0]=oT[0]*oW,ok[1]=oT[1]*oW,ok[2]=oT[2]*oW,ok[3]=oT[3]*oW)},oo.add=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or.elements;ok[0]=oW[0]+oD[0],ok[1]=oW[1]+oD[1],ok[2]=oW[2]+oD[2],ok[3]=oW[3]+oD[3]},oo.subtract=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or.elements;ok[0]=oW[0]-oD[0],ok[1]=oW[1]-oD[1],ok[2]=oW[2]-oD[2],ok[3]=oW[3]-oD[3]},oo.multiply=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or.elements;ok[0]=oW[0]*oD[0],ok[1]=oW[1]*oD[1],ok[2]=oW[2]*oD[2],ok[3]=oW[3]*oD[3]},oo.scale=function(oo,or,oT){var ok=oT.elements,oW=oo.elements;ok[0]=oW[0]*or,ok[1]=oW[1]*or,ok[2]=oW[2]*or,ok[3]=oW[3]*or},oo.Clamp=function(oo,or,oT,ok){var oW=oo.elements,oD=oW[0],on=oW[1],oV=oW[2],oL=oW[3],oU=or.elements,oh=oU[0],op=oU[1],oi=oU[2],ov=oU[3],ox=oT.elements,oj=ox[0],o_=ox[1],oK=ox[2],o$=ox[3],oy=ok.elements;oD=(oD=oj<oD?oj:oD)<oh?oh:oD,on=(on=o_<on?o_:on)<op?op:on,oV=(oV=oK<oV?oK:oV)<oi?oi:oV,oL=(oL=o$<oL?o$:oL)<ov?ov:oL,oy[0]=oD,oy[1]=on,oy[2]=oV,oy[3]=oL},oo.distanceSquared=function(oo,or){var oT=oo.elements,ok=or.elements,oW=oT[0]-ok[0],oD=oT[1]-ok[1],on=oT[2]-ok[2],oV=oT[3]-ok[3];return oW*oW+oD*oD+on*on+oV*oV},oo.distance=function(oo,or){var oT=oo.elements,ok=or.elements,oW=oT[0]-ok[0],oD=oT[1]-ok[1],on=oT[2]-ok[2],oV=oT[3]-ok[3];return Math.sqrt(oW*oW+oD*oD+on*on+oV*oV)},oo.dot=function(oo,or){var oT=oo.elements,ok=or.elements;return oT[0]*ok[0]+oT[1]*ok[1]+oT[2]*ok[2]+oT[3]*ok[3]},oo.min=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or.elements;ok[0]=Math.min(oW[0],oD[0]),ok[1]=Math.min(oW[1],oD[1]),ok[2]=Math.min(oW[2],oD[2]),ok[3]=Math.min(oW[3],oD[3])},oo.max=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or.elements;ok[0]=Math.max(oW[0],oD[0]),ok[1]=Math.max(oW[1],oD[1]),ok[2]=Math.max(oW[2],oD[2]),ok[3]=Math.max(oW[3],oD[3])},op(oo,["ZERO",function(){return this.ZERO=new oo},"ONE",function(){return this.ONE=new oo(1,1,1,1)},"UnitX",function(){return this.UnitX=new oo(1,0,0,0)},"UnitY",function(){return this.UnitY=new oo(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new oo(0,0,1,0)},"UnitW",function(){return this.UnitW=new oo(0,0,0,1)}]),oo}(),oLr=function(){function oD(oo,or,oT,ok){this.minDepth=0,this.maxDepth=1,this.x=oo,this.y=or,this.width=oT,this.height=ok}ov(oD,"laya.d3.math.Viewport");var oo=oD.prototype;return oo.project=function(oo,or,oT){onr.transformV3ToV3(oo,or,oT);var ok=oo.elements,oW=or.elements,oD=oT.elements,on=ok[0]*oW[3]+ok[1]*oW[7]+ok[2]*oW[11]+oW[15];1!==on&&(oD[0]=oD[0]/on,oD[1]=oD[1]/on,oD[2]=oD[2]/on),oD[0]=.5*(oD[0]+1)*this.width+this.x,oD[1]=.5*(1-oD[1])*this.height+this.y,oD[2]=oD[2]*(this.maxDepth-this.minDepth)+this.minDepth},oo.unprojectFromMat=function(oo,or,oT){var ok=oo.elements,oW=or.elements,oD=oT.elements;oD[0]=(ok[0]-this.x)/this.width*2-1,oD[1]=-((ok[1]-this.y)/this.height*2-1);var on=(this.maxDepth-this.minDepth)/2;oD[2]=(ok[2]-this.minDepth-on)/on;var oV=oD[0]*oW[3]+oD[1]*oW[7]+oD[2]*oW[11]+oW[15];onr.transformV3ToV3(oT,or,oT),1!==oV&&(oD[0]=oD[0]/oV,oD[1]=oD[1]/oV,oD[2]=oD[2]/oV)},oo.unprojectFromWVP=function(oo,or,oT,ok,oW){oor.multiply(or,oT,oD._tempMatrix4x4),ok&&oor.multiply(oD._tempMatrix4x4,ok,oD._tempMatrix4x4),oD._tempMatrix4x4.invert(oD._tempMatrix4x4),this.unprojectFromMat(oo,oD._tempMatrix4x4,oW)},op(oD,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new oor}]),oD}(),oUr=function(){function oR(oo){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=oo,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}ov(oR,"laya.d3.resource.models.SubMesh");var oo=oR.prototype;return oS.imps(oo,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),oo._getVertexBuffer=function(oo){return void 0===oo&&(oo=0),0===oo?this._vertexBuffer:null},oo._getIndexBuffer=function(){return this._indexBuffer},oo._getStaticBatchBakedVertexs=function(oo,or){var oT,ok,oW=this._vertexBuffer,oD=oW.vertexDeclaration,on=oD.getVertexElementByUsage(0).offset/4,oV=oD.getVertexElementByUsage(3).offset/4,oL=or.meshRender.lightmapScaleOffset,oU=0,oh=0,op=0,oi=0,ov=0,ox=0;if(oL)if(ok=oD.getVertexElementByUsage(15))op=oD.vertexStride/4,oT=0<this._vertexCount?oW.getData().slice(this._vertexStart*op,(this._vertexStart+this._vertexCount)*op):oW.getData().slice(),oi=ok.offset/4;else{op=(ox=oD.vertexStride/4)+2,oT=this._vertexCount?new Float32Array(this._vertexCount*(oW.vertexDeclaration.vertexStride/4+2)):new Float32Array(oW.vertexCount*(oW.vertexDeclaration.vertexStride/4+2)),oi=(ov=oD.getVertexElementByUsage(2).offset/4)+2;var oj=oW.getData();for(oU=0,oh=oj.length/ox;oU<oh;oU++){var o_=0;o_=0<this._vertexCount?(this._vertexStart+oU)*ox:oU*ox;var oK=oU*op,o$=0;for(o$=0;o$<oi;o$++)oT[oK+o$]=oj[o_+o$];for(o$=oi;o$<ox;o$++)oT[oK+o$+2]=oj[o_+o$]}}else op=oD.vertexStride/4,oT=this._vertexCount?oW.getData().slice(this._vertexStart*op,(this._vertexStart+this._vertexCount)*op):oW.getData().slice();if(oo){var oy=oo.worldMatrix,ol=oR._tempMatrix4x40;oy.invert(ol);var oS=oR._tempMatrix4x41,oq=or.transform.worldMatrix;oor.multiply(ol,oq,oS)}else oS=or.transform.worldMatrix;var ob=oR._tempQuaternion0;for(oS.decomposeTransRotScale(oR._tempVector30,ob,oR._tempVector31),oU=0,oh=oT.length/op;oU<oh;oU++){var oF=oU*op+on,oP=oU*op+oV;if(o_r.transformVector3ArrayToVector3ArrayCoordinate(oT,oF,oS,oT,oF),o_r.transformVector3ArrayByQuat(oT,oP,ob,oT,oP),oL){var ot=oU*op+oi;if(ok)o_r.transformLightingMapTexcoordByUV1Array(oT,ot,oL,oT,ot);else{var oH=oU*ox+ov;o_r.transformLightingMapTexcoordByUV0Array(oj,oH,oL,oT,ot)}}}return oT},oo._getVertexBuffers=function(){return null},oo._beforeRender=function(oo){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},oo._render=function(oo){var or,oT=0,ok=oo.renderElement;if(1<this._indexCount){var oW=this._boneIndicesList.length;if(1<oW){for(var oD=0;oD<oW;oD++)(or=ok._skinAnimationDatas||this._skinAnimationDatas)&&(ok._shaderValue.setValue(0,or[oD]),oo._shader.uploadRenderElementUniforms(ok._shaderValue.data)),ou.mainContext.drawElements(4,this._subIndexBufferCount[oD],5123,2*this._subIndexBufferStart[oD]);oF.drawCall+=oW}else(or=ok._skinAnimationDatas||this._skinAnimationDatas)&&(ok._shaderValue.setValue(0,or[0]),oo._shader.uploadRenderElementUniforms(ok._shaderValue.data)),ou.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),oF.drawCall++;oT=this._indexCount}else oT=this._indexBuffer.indexCount,(or=ok._skinAnimationDatas||this._skinAnimationDatas)&&(ok._shaderValue.setValue(0,or[0]),oo._shader.uploadRenderElementUniforms(ok._shaderValue.data)),ou.mainContext.drawElements(4,oT,5123,0),oF.drawCall++;oF.trianglesFaces+=oT/3},oo.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},oo.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},ox(0,oo,"_vertexBufferCount",function(){return 1}),ox(0,oo,"triangleCount",function(){return this._indexBuffer.indexCount/3}),op(oR,["_tempVector30",function(){return this._tempVector30=new onr},"_tempVector31",function(){return this._tempVector31=new onr},"_tempQuaternion0",function(){return this._tempQuaternion0=new oTr},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new oor},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new oor}]),oR}(),ohr=function(){function oo(oo){this.defineCounter=0,this.defines=null,oo?(this.defineCounter=oo.defineCounter,this.defines=oo.defines.slice()):(this.defineCounter=0,this.defines=[])}return ov(oo,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),oo.prototype.registerDefine=function(oo){var or=Math.pow(2,this.defineCounter++);return this.defines[or]=oo,or},oo}(),opr=function(){function oo(){}return ov(oo,"laya.d3.shader.ShaderInit3D"),oo.__init__=function(){var oo,or;oFr._globalRegDefine("HIGHPRECISION",oFr.SHADERDEFINE_HIGHPRECISION),oFr._globalRegDefine("FOG",oFr.SHADERDEFINE_FOG),oFr._globalRegDefine("DIRECTIONLIGHT",oFr.SHADERDEFINE_DIRECTIONLIGHT),oFr._globalRegDefine("POINTLIGHT",oFr.SHADERDEFINE_POINTLIGHT),oFr._globalRegDefine("SPOTLIGHT",oFr.SHADERDEFINE_SPOTLIGHT),oFr._globalRegDefine("UV",oFr.SHADERDEFINE_UV0),oFr._globalRegDefine("COLOR",oFr.SHADERDEFINE_COLOR),oFr._globalRegDefine("UV1",oFr.SHADERDEFINE_UV1),oFr._globalRegDefine("CASTSHADOW",ovr.SHADERDEFINE_CAST_SHADOW),oFr._globalRegDefine("SHADOWMAP_PSSM1",ovr.SHADERDEFINE_SHADOW_PSSM1),oFr._globalRegDefine("SHADOWMAP_PSSM2",ovr.SHADERDEFINE_SHADOW_PSSM2),oFr._globalRegDefine("SHADOWMAP_PSSM3",ovr.SHADERDEFINE_SHADOW_PSSM3),oFr._globalRegDefine("SHADOWMAP_PCF_NO",ovr.SHADERDEFINE_SHADOW_PCF_NO),oFr._globalRegDefine("SHADOWMAP_PCF1",ovr.SHADERDEFINE_SHADOW_PCF1),oFr._globalRegDefine("SHADOWMAP_PCF2",ovr.SHADERDEFINE_SHADOW_PCF2),oFr._globalRegDefine("SHADOWMAP_PCF3",ovr.SHADERDEFINE_SHADOW_PCF3),oFr._globalRegDefine("DEPTHFOG",oFr.SAHDERDEFINE_DEPTHFOG),oOr.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),oOr.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),oo={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},or={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var oT=oOr.nameKey.add("SIMPLE");shaderCompile=oFr.add(oT,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',oo,or),oMr.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),oMr.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),oMr.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),oMr.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),oMr.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),oMr.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),oMr.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),oMr.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),oMr.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},oo}(),oir=function(){function oo(){this._data=null,this._data=[]}ov(oo,"laya.d3.shader.ValusArray");var or=oo.prototype;return or.setValue=function(oo,or){this._data[oo]=or},ox(0,or,"data",function(){return this._data}),oo}(),ovr=function(){function oo(){}return oo.SHADERDEFINE_RECEIVE_SHADOW=1,oo.SHADERDEFINE_CAST_SHADOW=512,oo.SHADERDEFINE_SHADOW_PSSM1=1024,oo.SHADERDEFINE_SHADOW_PSSM2=2048,oo.SHADERDEFINE_SHADOW_PSSM3=4096,oo.SHADERDEFINE_SHADOW_PCF_NO=8192,oo.SHADERDEFINE_SHADOW_PCF1=16384,oo.SHADERDEFINE_SHADOW_PCF2=32768,oo.SHADERDEFINE_SHADOW_PCF3=65536,oo.MAX_PSSM_COUNT=3,oo}(),oxr=function(){function ow(){}return ov(ow,"laya.d3.utils.Picker"),ow.calculateCursorRay=function(oo,or,oT,ok,oW,oD){var on=oo.elements[0],oV=oo.elements[1],oL=ow._tempVector30,oU=oL.elements;oU[0]=on,oU[1]=oV,oU[2]=or.minDepth;var oh=ow._tempVector31,op=oh.elements;op[0]=on,op[1]=oV,op[2]=or.maxDepth;var oi=oD.origin,ov=ow._tempVector32;or.unprojectFromWVP(oL,oT,ok,oW,oi),or.unprojectFromWVP(oh,oT,ok,oW,ov);var ox=oD.direction.elements;ox[0]=ov.x-oi.x,ox[1]=ov.y-oi.y,ox[2]=ov.z-oi.z,onr.normalize(oD.direction,oD.direction)},ow.rayIntersectsPositionsAndIndices=function(oo,or,oT,ok,oW){for(var oD=oT.vertexStride/4,on=oT.getVertexElementByUsage(0).offset/4,oV=Number.MAX_VALUE,oL=-1,oU=-1,oh=-1,op=0;op<ok.length;op+=3){var oi=ow._tempVector35,ov=oi.elements,ox=ok[op]*oD,oj=ox+on;ov[0]=or[oj],ov[1]=or[1+oj],ov[2]=or[2+oj];var o_=ow._tempVector36,oK=o_.elements,o$=ok[op+1]*oD,oy=o$+on;oK[0]=or[oy],oK[1]=or[1+oy],oK[2]=or[2+oy];var ol=ow._tempVector37,oS=ol.elements,oq=ok[op+2]*oD,ob=oq+on;oS[0]=or[ob],oS[1]=or[1+ob],oS[2]=or[2+ob];var oF=laya.d3.utils.Picker.rayIntersectsTriangle(oo,oi,o_,ol);!isNaN(oF)&&oF<oV&&(oV=oF,oL=ox,oU=o$,oh=oq)}if(oV===Number.MAX_VALUE)return oW.position.toDefault(),oW.distance=Number.MAX_VALUE,oW.trianglePositions[0].toDefault(),oW.trianglePositions[1].toDefault(),oW.trianglePositions[2].toDefault(),oW.triangleNormals[0].toDefault(),oW.triangleNormals[1].toDefault(),oW.triangleNormals[2].toDefault(),!1;oW.distance=oV,onr.scale(oo.direction,oV,oW.position),onr.add(oo.origin,oW.position,oW.position);var oP=oW.trianglePositions,ot=oP[0],oH=oP[1],oR=oP[2],ou=ot.elements,os=oH.elements,oz=oR.elements,om=oL+on;ou[0]=or[om],ou[1]=or[om+1],ou[2]=or[om+2];var oC=oU+on;os[0]=or[oC],os[1]=or[oC+1],os[2]=or[oC+2];var oX=oh+on;oz[0]=or[oX],oz[1]=or[oX+1],oz[2]=or[oX+2];var oO=oT.getVertexElementByUsage(3);if(oO){var oM=oO.offset/4,oc=oW.triangleNormals,oe=oc[0],oJ=oc[1],oY=oc[2],oA=oe.elements,oI=oJ.elements,oN=oY.elements,of=oL+oM;oA[0]=or[of],oA[1]=or[of+1],oA[2]=or[of+2];var oa=oU+oM;oI[0]=or[oa],oI[1]=or[oa+1],oI[2]=or[oa+2];var oG=oh+oM;oN[0]=or[oG],oN[1]=or[oG+1],oN[2]=or[oG+2]}return!0},ow.rayIntersectsTriangle=function(oo,or,oT,ok){var oW=ow._tempVector30,oD=ow._tempVector31;onr.subtract(oT,or,oW),onr.subtract(ok,or,oD);var on,oV=ow._tempVector32;if(onr.cross(oo.direction,oD,oV),(on=onr.dot(oW,oV))>-Number.MIN_VALUE&&on<Number.MIN_VALUE)return Number.NaN;var oL,oU=1/on,oh=ow._tempVector33;if(onr.subtract(oo.origin,or,oh),oL=onr.dot(oh,oV),(oL*=oU)<0||1<oL)return Number.NaN;var op,oi,ov=ow._tempVector34;return onr.cross(oh,oW,ov),op=onr.dot(oo.direction,ov),(op*=oU)<0||1<oL+op?Number.NaN:(oi=onr.dot(oD,ov),(oi*=oU)<0?Number.NaN:oi)},op(ow,["_tempVector30",function(){return this._tempVector30=new onr},"_tempVector31",function(){return this._tempVector31=new onr},"_tempVector32",function(){return this._tempVector32=new onr},"_tempVector33",function(){return this._tempVector33=new onr},"_tempVector34",function(){return this._tempVector34=new onr},"_tempVector35",function(){return this._tempVector35=new onr},"_tempVector36",function(){return this._tempVector36=new onr},"_tempVector37",function(){return this._tempVector37=new onr}]),ow}(),ojr=(function(){function oo(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new onr,new onr,new onr],this.trianglePositions.length=3,this.triangleNormals=[new onr,new onr,new onr],this.triangleNormals.length=3,this.position=new onr}ov(oo,"laya.d3.utils.RaycastHit"),oo.prototype.cloneTo=function(oo){oo.distance=this.distance,this.trianglePositions[0].cloneTo(oo.trianglePositions[0]),this.trianglePositions[1].cloneTo(oo.trianglePositions[1]),this.trianglePositions[2].cloneTo(oo.trianglePositions[2]),this.triangleNormals[0].cloneTo(oo.triangleNormals[0]),this.triangleNormals[1].cloneTo(oo.triangleNormals[1]),this.triangleNormals[2].cloneTo(oo.triangleNormals[2]),this.position.cloneTo(oo.position),oo.sprite3D=this.sprite3D}}(),function(){function oo(oo,or){this._width=0,this._height=0,this._width=oo,this._height=or}ov(oo,"laya.d3.utils.Size");var or=oo.prototype;return ox(0,or,"width",function(){return-1===this._width?oZ.clientWidth:this._width}),ox(0,or,"height",function(){return-1===this._height?oZ.clientHeight:this._height}),ox(1,oo,"fullScreen",function(){return new oo(-1,-1)}),oo}()),o_r=function(){function om(){}return ov(om,"laya.d3.utils.Utils3D"),om._rotationTransformScaleSkinAnimation=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh,op){var oi,ov,ox,oj,o_,oK=om._tempArray16_0,o$=om._tempArray16_1,oy=om._tempArray16_2,ol=ok+ok,oS=oW+oW,oq=oD+oD,ob=ok*ol,oF=oW*ol,oP=oW*oS,ot=oD*ol,oH=oD*oS,oR=oD*oq,ou=on*ol,os=on*oS,oz=on*oq;for(oK[15]=1,oK[0]=1-oP-oR,oK[1]=oF+oz,oK[2]=ot-os,oK[4]=oF-oz,oK[5]=1-ob-oR,oK[6]=oH+ou,oK[8]=ot+os,oK[9]=oH-ou,oK[10]=1-ob-oP,o$[15]=1,o$[0]=oV,o$[5]=oL,o$[10]=oU,oi=0;oi<4;oi++)ov=oK[oi],ox=oK[oi+4],oj=oK[oi+8],o_=oK[oi+12],oy[oi]=ov,oy[oi+4]=ox,oy[oi+8]=oj,oy[oi+12]=ov*oo+ox*or+oj*oT+o_;for(oi=0;oi<4;oi++)ov=oy[oi],ox=oy[oi+4],oj=oy[oi+8],o_=oy[oi+12],oh[oi+op]=ov*o$[0]+ox*o$[1]+oj*o$[2]+o_*o$[3],oh[oi+op+4]=ov*o$[4]+ox*o$[5]+oj*o$[6]+o_*o$[7],oh[oi+op+8]=ov*o$[8]+ox*o$[9]+oj*o$[10]+o_*o$[11],oh[oi+op+12]=ov*o$[12]+ox*o$[13]+oj*o$[14]+o_*o$[15]},om._createNodeByJson=function(oo,or,oT,ok){if(!oT)switch(or.type){case"Sprite3D":oT=new oXr;break;case"MeshSprite3D":oT=new owr;break;case"SkinnedMeshSprite3D":oT=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":oT=new ShuriKenParticle3D;break;case"TrailSprite3D":oT=new TrailSprite3D;break;case"Terrain":oT=new Terrain;break;case"Camera":oT=new oGr;break;case"DirectionLight":oT=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var oW=or.props;if(oW)for(var oD in oW)oT[oD]=oW[oD];var on=or.customProps;on&&(oT instanceof laya.d3.core.Sprite3D?(oT._parseBaseCustomProps(on),oT._parseCustomProps(oo,ok,on,or),oT._parseCustomComponent(oo,ok,or.components)):oT._parseCustomProps(oo,ok,on,or));var oV=or.child;if(oV)for(var oL=0,oU=oV.length;oL<oU;oL++){var oh=om._createNodeByJson(oo,oV[oL],null,ok);oT.addChild(oh)}return oT},om._computeBoneAndAnimationDatasByBindPoseMatrxix=function(oo,or,oT,ok,oW,oD){var on,oV,oL=0,oU=0,oh=oo.length;for(on=0;on<oh;oL+=oo[on].keyframeWidth,oU+=16,on++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(or[oL+0],or[oL+1],or[oL+2],or[oL+3],or[oL+4],or[oL+5],or[oL+6],or[oL+7],or[oL+8],or[oL+9],ok,oU),0!=on&&(oV=16*oo[on].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(ok,oV,ok,oU,ok,oU));var op=oT.length;for(on=0;on<op;on++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(ok,16*oD[on],oT[on],oW,16*on)},om._computeAnimationDatasByArrayAndMatrixFast=function(oo,or,oT,ok){for(var oW=0,oD=oo.length;oW<oD;oW++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(or,16*ok[oW],oo[oW],oT,16*oW)},om._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(oo,or,oT,ok,oW){var oD,on,oV=0,oL=0,oU=oo.length;for(oD=0;oD<oU;oV+=oo[oD].keyframeWidth,oL+=16,oD++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(or[oV+7],or[oV+8],or[oV+9],or[oV+3],or[oV+4],or[oV+5],or[oV+6],or[oV+0],or[oV+1],or[oV+2],ok,oL),0!=oD&&(on=16*oo[oD].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(ok,on,ok,oL,ok,oL));var oh=oT.length;for(oD=0;oD<oh;oD++){var op=16*oD;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(ok,op,oT[oD],oW,op)}},om._computeAnimationDatasByArrayAndMatrixFastOld=function(oo,or,oT){for(var ok=oo.length,oW=0;oW<ok;oW++){var oD=16*oW;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(or,oD,oo[oW],oT,oD)}},om._computeRootAnimationData=function(oo,or,oT){for(var ok=0,oW=0,oD=0,on=oo.length;ok<on;oW+=oo[ok].keyframeWidth,oD+=16,ok++)laya.d3.utils.Utils3D.createAffineTransformationArray(or[oW+0],or[oW+1],or[oW+2],or[oW+3],or[oW+4],or[oW+5],or[oW+6],or[oW+7],or[oW+8],or[oW+9],oT,oD)},om.transformVector3ArrayByQuat=function(oo,or,oT,ok,oW){var oD=oT.elements,on=oo[or],oV=oo[or+1],oL=oo[or+2],oU=oD[0],oh=oD[1],op=oD[2],oi=oD[3],ov=oi*on+oh*oL-op*oV,ox=oi*oV+op*on-oU*oL,oj=oi*oL+oU*oV-oh*on,o_=-oU*on-oh*oV-op*oL;ok[oW]=ov*oi+o_*-oU+ox*-op-oj*-oh,ok[oW+1]=ox*oi+o_*-oh+oj*-oU-ov*-op,ok[oW+2]=oj*oi+o_*-op+ov*-oh-ox*-oU},om.mulMatrixByArray=function(oo,or,oT,ok,oW,oD){var on,oV,oL,oU,oh;if(oW===oT){for(oT=om._tempArray16_3,on=0;on<16;++on)oT[on]=oW[oD+on];ok=0}for(on=0;on<4;on++)oV=oo[or+on],oL=oo[or+on+4],oU=oo[or+on+8],oh=oo[or+on+12],oW[oD+on]=oV*oT[ok+0]+oL*oT[ok+1]+oU*oT[ok+2]+oh*oT[ok+3],oW[oD+on+4]=oV*oT[ok+4]+oL*oT[ok+5]+oU*oT[ok+6]+oh*oT[ok+7],oW[oD+on+8]=oV*oT[ok+8]+oL*oT[ok+9]+oU*oT[ok+10]+oh*oT[ok+11],oW[oD+on+12]=oV*oT[ok+12]+oL*oT[ok+13]+oU*oT[ok+14]+oh*oT[ok+15]},om.mulMatrixByArrayFast=function(oo,or,oT,ok,oW,oD){var on,oV,oL,oU,oh;for(on=0;on<4;on++)oV=oo[or+on],oL=oo[or+on+4],oU=oo[or+on+8],oh=oo[or+on+12],oW[oD+on]=oV*oT[ok+0]+oL*oT[ok+1]+oU*oT[ok+2]+oh*oT[ok+3],oW[oD+on+4]=oV*oT[ok+4]+oL*oT[ok+5]+oU*oT[ok+6]+oh*oT[ok+7],oW[oD+on+8]=oV*oT[ok+8]+oL*oT[ok+9]+oU*oT[ok+10]+oh*oT[ok+11],oW[oD+on+12]=oV*oT[ok+12]+oL*oT[ok+13]+oU*oT[ok+14]+oh*oT[ok+15]},om.mulMatrixByArrayAndMatrixFast=function(oo,or,oT,ok,oW){var oD,on,oV,oL,oU,oh=oT.elements,op=oh[0],oi=oh[1],ov=oh[2],ox=oh[3],oj=oh[4],o_=oh[5],oK=oh[6],o$=oh[7],oy=oh[8],ol=oh[9],oS=oh[10],oq=oh[11],ob=oh[12],oF=oh[13],oP=oh[14],ot=oh[15],oH=or,oR=or+4,ou=or+8,os=or+12,oz=oW,om=oW+4,oC=oW+8,oX=oW+12;for(oD=0;oD<4;oD++)on=oo[oH+oD],oV=oo[oR+oD],oL=oo[ou+oD],oU=oo[os+oD],ok[oz+oD]=on*op+oV*oi+oL*ov+oU*ox,ok[om+oD]=on*oj+oV*o_+oL*oK+oU*o$,ok[oC+oD]=on*oy+oV*ol+oL*oS+oU*oq,ok[oX+oD]=on*ob+oV*oF+oL*oP+oU*ot},om.createAffineTransformationArray=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh,op){var oi=ok+ok,ov=oW+oW,ox=oD+oD,oj=ok*oi,o_=ok*ov,oK=ok*ox,o$=oW*ov,oy=oW*ox,ol=oD*ox,oS=on*oi,oq=on*ov,ob=on*ox;oh[op+0]=(1-(o$+ol))*oV,oh[op+1]=(o_+ob)*oV,oh[op+2]=(oK-oq)*oV,oh[op+3]=0,oh[op+4]=(o_-ob)*oL,oh[op+5]=(1-(oj+ol))*oL,oh[op+6]=(oy+oS)*oL,oh[op+7]=0,oh[op+8]=(oK+oq)*oU,oh[op+9]=(oy-oS)*oU,oh[op+10]=(1-(oj+o$))*oU,oh[op+11]=0,oh[op+12]=oo,oh[op+13]=or,oh[op+14]=oT,oh[op+15]=1},om.transformVector3ArrayToVector3ArrayCoordinate=function(oo,or,oT,ok,oW){var oD=om._tempArray4_0,on=oo[or+0],oV=oo[or+1],oL=oo[or+2],oU=oT.elements;oD[0]=on*oU[0]+oV*oU[4]+oL*oU[8]+oU[12],oD[1]=on*oU[1]+oV*oU[5]+oL*oU[9]+oU[13],oD[2]=on*oU[2]+oV*oU[6]+oL*oU[10]+oU[14],oD[3]=1/(on*oU[3]+oV*oU[7]+oL*oU[11]+oU[15]),ok[oW+0]=oD[0]*oD[3],ok[oW+1]=oD[1]*oD[3],ok[oW+2]=oD[2]*oD[3]},om.transformLightingMapTexcoordByUV0Array=function(oo,or,oT,ok,oW){var oD=oT.elements;ok[oW+0]=oo[or+0]*oD[0]+oD[2],ok[oW+1]=(oo[or+1]-1)*oD[1]+oD[3]},om.transformLightingMapTexcoordByUV1Array=function(oo,or,oT,ok,oW){var oD=oT.elements;ok[oW+0]=oo[or+0]*oD[0]+oD[2],ok[oW+1]=1+oo[or+1]*oD[1]+oD[3]},om.getURLVerion=function(oo){var or=oo.indexOf("?");return 0<=or?oo.substr(or):null},om._quaternionCreateFromYawPitchRollArray=function(oo,or,oT,ok){var oW=.5*oT,oD=.5*or,on=.5*oo,oV=Math.sin(oW),oL=Math.cos(oW),oU=Math.sin(oD),oh=Math.cos(oD),op=Math.sin(on),oi=Math.cos(on);ok[0]=oi*oU*oL+op*oh*oV,ok[1]=op*oh*oL-oi*oU*oV,ok[2]=oi*oh*oV-op*oU*oL,ok[3]=oi*oh*oL+op*oU*oV},om._createAffineTransformationArray=function(oo,or,oT,ok){var oW=or[0],oD=or[1],on=or[2],oV=or[3],oL=oW+oW,oU=oD+oD,oh=on+on,op=oW*oL,oi=oW*oU,ov=oW*oh,ox=oD*oU,oj=oD*oh,o_=on*oh,oK=oV*oL,o$=oV*oU,oy=oV*oh,ol=oT[0],oS=oT[1],oq=oT[2];ok[0]=(1-(ox+o_))*ol,ok[1]=(oi+oy)*ol,ok[2]=(ov-o$)*ol,ok[3]=0,ok[4]=(oi-oy)*oS,ok[5]=(1-(op+o_))*oS,ok[6]=(oj+oK)*oS,ok[7]=0,ok[8]=(ov+o$)*oq,ok[9]=(oj-oK)*oq,ok[10]=(1-(op+ox))*oq,ok[11]=0,ok[12]=oo[0],ok[13]=oo[1],ok[14]=oo[2],ok[15]=1},om._mulMatrixArray=function(oo,or,oT,ok){var oW,oD,on,oV,oL,oU=or.elements,oh=oU[0],op=oU[1],oi=oU[2],ov=oU[3],ox=oU[4],oj=oU[5],o_=oU[6],oK=oU[7],o$=oU[8],oy=oU[9],ol=oU[10],oS=oU[11],oq=oU[12],ob=oU[13],oF=oU[14],oP=oU[15],ot=ok,oH=ok+4,oR=ok+8,ou=ok+12;for(oW=0;oW<4;oW++)oD=oo[oW],on=oo[oW+4],oV=oo[oW+8],oL=oo[oW+12],oT[ot+oW]=oD*oh+on*op+oV*oi+oL*ov,oT[oH+oW]=oD*ox+on*oj+oV*o_+oL*oK,oT[oR+oW]=oD*o$+on*oy+oV*ol+oL*oS,oT[ou+oW]=oD*oq+on*ob+oV*oF+oL*oP},om.getYawPitchRoll=function(oo,or){om.transformQuat(onr.ForwardRH,oo,oTr.TEMPVector31),om.transformQuat(onr.Up,oo,oTr.TEMPVector32);var oT=oTr.TEMPVector32.elements;om.angleTo(onr.ZERO,oTr.TEMPVector31,oTr.TEMPVector33);var ok=oTr.TEMPVector33.elements;ok[0]==Math.PI/2?(ok[1]=om.arcTanAngle(oT[2],oT[0]),ok[2]=0):ok[0]==-Math.PI/2?(ok[1]=om.arcTanAngle(-oT[2],-oT[0]),ok[2]=0):(oor.createRotationY(-ok[1],oTr.TEMPMatrix0),oor.createRotationX(-ok[0],oTr.TEMPMatrix1),onr.transformCoordinate(oTr.TEMPVector32,oTr.TEMPMatrix0,oTr.TEMPVector32),onr.transformCoordinate(oTr.TEMPVector32,oTr.TEMPMatrix1,oTr.TEMPVector32),ok[2]=om.arcTanAngle(oT[1],-oT[0])),ok[1]<=-Math.PI&&(ok[1]=Math.PI),ok[2]<=-Math.PI&&(ok[2]=Math.PI),ok[1]>=Math.PI&&ok[2]>=Math.PI&&(ok[1]=0,ok[2]=0,ok[0]=Math.PI-ok[0]),or[0]=ok[1],or[1]=ok[0],or[2]=ok[2]},om.arcTanAngle=function(oo,or){return 0==oo?1==or?Math.PI/2:-Math.PI/2:0<oo?Math.atan(or/oo):oo<0?0<or?Math.atan(or/oo)+Math.PI:Math.atan(or/oo)-Math.PI:0},om.angleTo=function(oo,or,oT){onr.subtract(or,oo,oTr.TEMPVector30),onr.normalize(oTr.TEMPVector30,oTr.TEMPVector30),oT.elements[0]=Math.asin(oTr.TEMPVector30.y),oT.elements[1]=om.arcTanAngle(-oTr.TEMPVector30.z,-oTr.TEMPVector30.x)},om.transformQuat=function(oo,or,oT){var ok=oT.elements,oW=oo.elements,oD=or,on=oW[0],oV=oW[1],oL=oW[2],oU=oD[0],oh=oD[1],op=oD[2],oi=oD[3],ov=oi*on+oh*oL-op*oV,ox=oi*oV+op*on-oU*oL,oj=oi*oL+oU*oV-oh*on,o_=-oU*on-oh*oV-op*oL;ok[0]=ov*oi+o_*-oU+ox*-op-oj*-oh,ok[1]=ox*oi+o_*-oh+oj*-oU-ov*-op,ok[2]=oj*oi+o_*-op+ov*-oh-ox*-oU},om.quaterionNormalize=function(oo,or){var oT=oo[0],ok=oo[1],oW=oo[2],oD=oo[3],on=oT*oT+ok*ok+oW*oW+oD*oD;0<on&&(on=1/Math.sqrt(on),or[0]=oT*on,or[1]=ok*on,or[2]=oW*on,or[3]=oD*on)},om.matrix4x4MultiplyFFF=function(oo,or,oT){var ok,oW,oD,on,oV;if(oT===or)for(or=new Float32Array(16),ok=0;ok<16;++ok)or[ok]=oT[ok];for(ok=0;ok<4;ok++)oW=oo[ok],oD=oo[ok+4],on=oo[ok+8],oV=oo[ok+12],oT[ok]=oW*or[0]+oD*or[1]+on*or[2]+oV*or[3],oT[ok+4]=oW*or[4]+oD*or[5]+on*or[6]+oV*or[7],oT[ok+8]=oW*or[8]+oD*or[9]+on*or[10]+oV*or[11],oT[ok+12]=oW*or[12]+oD*or[13]+on*or[14]+oV*or[15]},om.matrix4x4MultiplyMFM=function(oo,or,oT){om.matrix4x4MultiplyFFF(oo.elements,or,oT.elements)},op(om,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new onr},"_tempVector3_1",function(){return this._tempVector3_1=new onr},"_tempVector3_2",function(){return this._tempVector3_2=new onr},"_tempVector3_3",function(){return this._tempVector3_3=new onr},"_tempVector3_4",function(){return this._tempVector3_4=new onr},"_tempVector3_5",function(){return this._tempVector3_5=new onr},"_tempVector3_6",function(){return this._tempVector3_6=new onr},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),om}(),oKr=function(){function os(){}return ov(os,"Laya3D"),os._cancelLoadByUrl=function(oo){oS.loader.cancelLoadByUrl(oo),os._innerFirstLevelLoaderManager.cancelLoadByUrl(oo),os._innerSecondLevelLoaderManager.cancelLoadByUrl(oo),os._innerThirdLevelLoaderManager.cancelLoadByUrl(oo),os._innerFourthLevelLoaderManager.cancelLoadByUrl(oo)},os._changeWebGLSize=function(oo,or){ou.onStageResize(oo,or),oZ.clientWidth=oo,oZ.clientHeight=or},os.__init__=function(){var oo=or.createMap;oo.lh=[oXr,"SPRITE3DHIERARCHY"],oo.ls=[oCr,"SPRITE3DHIERARCHY"],oo.lm=[oAr,"MESH"],oo.lmat=[oMr,"MATERIAL"],oo.jpg=[oNr,"nativeimage"],oo.jpeg=[oNr,"nativeimage"],oo.png=[oNr,"nativeimage"],oo.pkm=[oNr,"arraybuffer"],oo.raw=[oJr,"arraybuffer"],oo.mipmaps=[oJr,"arraybuffer"],oK.parserMap.SPRITE3DHIERARCHY=os._loadHierarchy,oK.parserMap.MESH=os._loadMesh,oK.parserMap.MATERIAL=os._loadMaterial,oK.parserMap.TEXTURECUBE=os._loadTextureCube,oK.parserMap.TERRAIN=os._loadTerrain,os._innerFirstLevelLoaderManager.on("error",null,os._eventLoadManagerError),os._innerSecondLevelLoaderManager.on("error",null,os._eventLoadManagerError),os._innerThirdLevelLoaderManager.on("error",null,os._eventLoadManagerError),os._innerFourthLevelLoaderManager.on("error",null,os._eventLoadManagerError)},os.READ_BLOCK=function(){return os._readData.pos+=4,!0},os.READ_DATA=function(){return os._DATA.offset=os._readData.getUint32(),os._DATA.size=os._readData.getUint32(),!0},os.READ_STRINGS=function(){var oo=[],or={offset:0,size:0};or.offset=os._readData.getUint16(),or.size=os._readData.getUint16();os._readData.pos;os._readData.pos=or.offset+os._DATA.offset;for(var oT=0;oT<or.size;oT++){var ok=os._readData.readUTFString();-1===ok.lastIndexOf(".lmat")&&-1===ok.lastIndexOf(".lpbr")||oo.push(ok)}return oo},os.formatRelativePath=function(oo,or){var oT;if("."===or.charAt(0)){for(var ok=(oo+or).split("/"),oW=0,oD=ok.length;oW<oD;oW++)if(".."==ok[oW]){var on=oW-1;0<on&&".."!==ok[on]&&(ok.splice(on,2),oW-=2)}oT=ok.join("/")}else oT=oo+or;return null!=oR.customFormat&&(oT=oR.customFormat(oT,null)),oT},os._eventLoadManagerError=function(oo){oS.loader.event("error",oo)},os._addHierarchyInnerUrls=function(oo,or,oT,ok,oW,oD){var on=os.formatRelativePath(ok,oW);oT&&(on+=oT),oo.push({url:on,clas:oD}),or[oW]=on},os._getSprite3DHierarchyInnerUrls=function(oo,or,oT,ok,oW,oD,on){var oV,oL=0,oU=0;switch(oo.type){case"Scene":var oh=oo.customProps.lightmaps;for(oL=0,oU=oh.length;oL<oU;oL++){var op=oh[oL].replace(".exr",".png");os._addHierarchyInnerUrls(ok,oW,oD,on,op,oNr)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var oi;if(oo.instanceParams)(oi=oo.instanceParams.loadPath)&&os._addHierarchyInnerUrls(or,oW,oD,on,oi,oAr);else{(oi=(oV=oo.customProps).meshPath)&&os._addHierarchyInnerUrls(or,oW,oD,on,oi,oAr);var ov=oV.materials;if(ov)for(oL=0,oU=ov.length;oL<oU;oL++){for(var ox=ov[oL],oj=ox.type.split("."),o_=oz.window,oK=0,o$=oj.length;oK<o$;++oK){o_=o_[this.clasPaths[oK]]}if("function"!=typeof o_)throw"_getSprite3DHierarchyInnerUrls 错误: "+ox.type+" 不是类";os._addHierarchyInnerUrls(oT,oW,oD,on,ox.path,o_)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var oy=(oV=oo.customProps).meshPath;oy&&os._addHierarchyInnerUrls(or,oW,oD,on,oy,oAr);var ol=oV.material;if(ol){oj=ol.type.split("."),o_=oz.window;for(oK=0,o$=oj.length;oK<o$;++oK){o_=o_[this.clasPaths[oK]]}os._addHierarchyInnerUrls(oT,oW,oD,on,ol.path,o_)}else{var oS=oV.materialPath;if(oS)os._addHierarchyInnerUrls(oT,oW,oD,on,oS,ShurikenParticleMaterial);else{var oq=oV.texturePath;oq&&os._addHierarchyInnerUrls(ok,oW,oD,on,oq,oNr)}}break;case"Terrain":os._addHierarchyInnerUrls(ok,oW,oD,on,oo.customProps.dataPath,TerrainRes)}var ob=oo.components;for(var oF in ob){var oP=ob[oF];switch(oF){case"Animator":var ot=oP.avatarPath;if(ot)os._addHierarchyInnerUrls(ok,oW,oD,on,ot,Avatar);else{var oH=oP.avatar;oH&&os._addHierarchyInnerUrls(ok,oW,oD,on,oH.path,Avatar)}var oR=oP.clipPaths;for(oL=0,oU=oR.length;oL<oU;oL++)os._addHierarchyInnerUrls(ok,oW,oD,on,oR[oL],AnimationClip)}}var ou=oo.child;for(oL=0,oU=ou.length;oL<oU;oL++)os._getSprite3DHierarchyInnerUrls(ou[oL],or,oT,ok,oW,oD,on)},os._loadHierarchy=function(oo){oo.on("loaded",null,os._onHierarchylhLoaded,[oo,oo._class._getGroup()]),oo.load(oo.url,"json",!1,null,!0)},os._onHierarchylhLoaded=function(oo,or,oT){if(oo._class.destroyed)oo.endLoad();else{var ok=oo.url,oW=o_r.getURLVerion(ok),oD=oR.getPath(ok),on=[],oV=[],oL=[],oU={};os._getSprite3DHierarchyInnerUrls(oT,on,oV,oL,oU,oW,oD);var oh=on.length+oV.length+oL.length,op=oh+1,oi=1/op;if(os._onProcessChange(oo,0,oi,1),0<oL.length){var ov=oh/op,ox=oH.create(null,os._onProcessChange,[oo,oi,ov],!1);os._innerFourthLevelLoaderManager.create(oL,oH.create(null,os._onHierarchyInnerForthLevResouLoaded,[oo,or,ox,oT,oU,on,oV,oi+ov*oL.length,ov]),ox,null,null,1,!0,or)}else os._onHierarchyInnerForthLevResouLoaded(oo,or,null,oT,oU,on,oV,oi,ov)}},os._onHierarchyInnerForthLevResouLoaded=function(oo,or,oT,ok,oW,oD,on,oV,oL){if(oo._class.destroyed)oo.endLoad();else if(oT&&oT.recover(),0<on.length){var oU=oH.create(null,os._onProcessChange,[oo,oV,oL],!1);os._innerSecondLevelLoaderManager.create(on,oH.create(null,os._onHierarchyInnerSecondLevResouLoaded,[oo,or,oU,ok,oW,oD,oV+oL*on.length,oL]),oT,null,null,1,!0,or)}else os._onHierarchyInnerSecondLevResouLoaded(oo,or,null,ok,oW,oD,oV,oL)},os._onHierarchyInnerSecondLevResouLoaded=function(oo,or,oT,ok,oW,oD,on,oV){if(oo._class.destroyed)oo.endLoad();else if(oT&&oT.recover(),0<oD.length){var oL=oH.create(null,os._onProcessChange,[oo,on,oV],!1);os._innerFirstLevelLoaderManager.create(oD,oH.create(null,os._onHierarchyInnerFirstLevResouLoaded,[oo,oL,ok,oW]),oT,null,null,1,!0,or)}else os._onHierarchyInnerFirstLevResouLoaded(oo,null,ok,oW)},os._onHierarchyInnerFirstLevResouLoaded=function(oo,or,oT,ok){or&&or.recover(),oo.endLoad([oT,ok])},os._loadTerrain=function(oo){oo.on("loaded",null,os._onTerrainLtLoaded,[oo,oo._class._getGroup()]),oo.load(oo.url,"json",!1,null,!0)},os._onTerrainLtLoaded=function(oo,or,oT){if(oo._class.destroyed)oo.endLoad();else{var ok,oW,oD=oo.url,on=o_r.getURLVerion(oD),oV=oR.getPath(oD),oL=[],oU={},oh=0,op=0,oi=oT.heightData;ok=oi.url,oW=os.formatRelativePath(oV,ok),on&&(oW+=on),ok=oU[ok]=oW;var ov=oT.detailTexture;for(oh=0,op=ov.length;oh<op;oh++)oL.push({url:ov[oh].diffuse});var ox=oT.normalMap;for(oh=0,op=ox.length;oh<op;oh++)oL.push({url:ox[oh]});var oj=oT.alphaMap;for(oh=0,op=oj.length;oh<op;oh++)oL.push({url:oj[oh],params:[!1,!1,6408,!0]});for(oh=0,op=oL.length;oh<op;oh++){var o_=oL[oh].url;oW=os.formatRelativePath(oV,o_),on&&(oW+=on),oL[oh].url=oW,oU[o_]=oW}var oK=oL.length,o$=oK+2,oy=1/o$;os._onProcessChange(oo,0,oy,1);var ol={heightMapLoaded:!1,texturesLoaded:!1},oS=oH.create(null,os._onProcessChange,[oo,oy,oy],!1);os._innerFourthLevelLoaderManager.create(ok,oH.create(null,os._onTerrainHeightMapLoaded,[oo,oS,oT,oU,ol]),oS,null,[oi.numX,oi.numZ,oi.bitType,oi.value],1,!0,or);var oq=oH.create(null,os._onProcessChange,[oo,2*oy,oK/o$],!1);os._innerFourthLevelLoaderManager.create(oL,oH.create(null,os._onTerrainTexturesLoaded,[oo,oq,oT,oU,ol]),oq,null,null,1,!0,or)}},os._onTerrainHeightMapLoaded=function(oo,or,oT,ok,oW){oW.heightMapLoaded=!0,oW.texturesLoaded&&(oo.endLoad([oT,ok]),or.recover())},os._onTerrainTexturesLoaded=function(oo,or,oT,ok,oW){oW.texturesLoaded=!0,oW.heightMapLoaded&&(oo.endLoad([oT,ok]),or.recover())},os._loadMesh=function(oo){oo.on("loaded",null,os._onMeshLmLoaded,[oo,oo._class._getGroup()]),oo.load(oo.url,"arraybuffer",!1,null,!0)},os._onMeshLmLoaded=function(oo,or,oT){if(oo._class.destroyed)oo.endLoad();else{var ok,oW,oD,on=oo.url,oV=o_r.getURLVerion(on),oL=oR.getPath(on),oU={},oh=0,op=0;switch((os._readData=new oq(oT)).pos=0,os._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var oi=os._readData.getUint32();os._readData.pos=os._readData.pos+4,op=os._readData.getUint16(),os._readData.pos=os._readData.pos+8*op;var ov=os._readData.getUint32();for(op=os._readData.getUint16(),os._readData.pos=oi+ov,ok=[],oh=0;oh<op;oh++){var ox=os._readData.readUTFString();-1!==ox.lastIndexOf(".lmat")&&ok.push(ox)}break;default:for(os.READ_BLOCK(),oh=0;oh<2;oh++){var oj=os._readData.getUint16(),o_=os._strings[oj],oK=os["READ_"+o_];if(null==oK)throw new Error("model file err,no this function:"+oj+" "+o_);1===oh?ok=oK.call():oK.call()}}for(oh=0,oD=ok.length;oh<oD;oh++){var o$=ok[oh];oW=os.formatRelativePath(oL,o$),oV&&(oW+=oV),ok[oh]=oW,oU[o$]=oW}if(0<ok.length){os._onProcessChange(oo,0,.5,1);var oy=oH.create(null,os._onProcessChange,[oo,.5,.5],!1);os._innerSecondLevelLoaderManager.create(ok,oH.create(null,os._onMeshMateialLoaded,[oo,oy,oT,oU]),oy,null,null,1,!0,or)}else oo.endLoad([oT,oU])}},os._onMeshMateialLoaded=function(oo,or,oT,ok){oo.endLoad([oT,ok]),or.recover()},os._getMaterialTexturePath=function(oo,or,oT){var ok=oo.length-4;return oo.indexOf(".dds")!=ok&&oo.indexOf(".tga")!=ok&&oo.indexOf(".exr")!=ok&&oo.indexOf(".DDS")!=ok&&oo.indexOf(".TGA")!=ok&&oo.indexOf(".EXR")!=ok||(oo=oo.substr(0,ok)+".png"),oo=os.formatRelativePath(oT,oo),or&&(oo+=or),oo},os._loadMaterial=function(oo){oo.on("loaded",null,os._onMaterilLmatLoaded,[oo,oo._class._getGroup()]),oo.load(oo.url,"json",!1,null,!0)},os._onMaterilLmatLoaded=function(oo,or,oT){if(oo._class.destroyed)oo.endLoad();else{var ok,oW=oo.url,oD=o_r.getURLVerion(oW),on=oR.getPath(oW),oV=[],oL={},oU=oT.customProps,oh=oT.version;if(oh)switch(oh){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var op=oT.props.textures,oi=0,ov=op.length;oi<ov;oi++){var ox=op[oi],oj=ox.path;if(oj){var o_=oj.length-4;oj.indexOf(".exr")!=o_&&oj.indexOf(".EXR")!=o_||(oj=oj.substr(0,o_)+".png"),ok=os.formatRelativePath(on,oj),oD&&(ok+=oD),oV.push({url:ok,params:ox.params}),oL[oj]=ok}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var oK=oU.diffuseTexture.texture2D;if(oK&&(ok=os._getMaterialTexturePath(oK,oD,on),oV.push(ok),oL[oK]=ok),oU.normalTexture){var o$=oU.normalTexture.texture2D;o$&&(ok=os._getMaterialTexturePath(o$,oD,on),oV.push(ok),oL[o$]=ok)}if(oU.specularTexture){var oy=oU.specularTexture.texture2D;oy&&(ok=os._getMaterialTexturePath(oy,oD,on),oV.push(ok),oL[oy]=ok)}if(oU.emissiveTexture){var ol=oU.emissiveTexture.texture2D;ol&&(ok=os._getMaterialTexturePath(ol,oD,on),oV.push(ok),oL[ol]=ok)}if(oU.ambientTexture){var oS=oU.ambientTexture.texture2D;oS&&(ok=os._getMaterialTexturePath(oS,oD,on),oV.push(ok),oL[oS]=ok)}if(oU.reflectTexture){var oq=oU.reflectTexture.texture2D;oq&&(ok=os._getMaterialTexturePath(oq,oD,on),oV.push(ok),oL[oq]=ok)}}var ob=oV.length,oF=ob+1,oP=1/oF;if(os._onProcessChange(oo,0,oP,1),0<ob){var ot=oH.create(null,os._onProcessChange,[oo,oP,ob/oF],!1);os._innerFourthLevelLoaderManager.create(oV,oH.create(null,os._onMateialTexturesLoaded,[oo,ot,oT,oL]),ot,oNr,null,1,!0,or)}else os._onMateialTexturesLoaded(oo,null,oT,null)}},os._onMateialTexturesLoaded=function(oo,or,oT,ok){oo.endLoad([oT,ok]),or&&or.recover()},os._loadTextureCube=function(oo){oo.on("loaded",null,os._onTextureCubeLtcLoaded,[oo]),oo.load(oo.url,"json",!1,null,!0)},os._onTextureCubeLtcLoaded=function(oo,or){if(oo._class.destroyed)oo.endLoad();else{var oT=oR.getPath(oo.url),ok=[os.formatRelativePath(oT,or.px),os.formatRelativePath(oT,or.nx),os.formatRelativePath(oT,or.py),os.formatRelativePath(oT,or.ny),os.formatRelativePath(oT,or.pz),os.formatRelativePath(oT,or.nz)];os._onProcessChange(oo,0,1/7,1);var oW=oH.create(null,os._onProcessChange,[oo,1/7,6/7],!1);os._innerFourthLevelLoaderManager.load(ok,oH.create(null,os._onTextureCubeImagesLoaded,[oo,ok,oW]),oW,"nativeimage")}},os._onTextureCubeImagesLoaded=function(oo,or,oT){var ok=[];ok.length=6;for(var oW=0;oW<6;oW++){var oD=or[oW];ok[oW]=oK.getRes(oD),oK.clearRes(oD)}oo.endLoad(ok),oT.recover()},os._onProcessChange=function(oo,or,oT,ok){(ok=or+ok*oT)<1&&oo.event("progress",ok)},os.init=function(oo,or,oT,ok,oW,oD){if(void 0===oT&&(oT=!1),void 0===ok&&(ok=!1),void 0===oW&&(oW=!0),void 0===oD&&(oD=!0),o$.update3DLoop=function(){},o$.cancelLoadByUrl=function(oo){os._cancelLoadByUrl(oo)},oL.isAntialias=oT,oL.isAlpha=ok,oL.premultipliedAlpha=oW,oL.isStencil=oD,!ou.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");o$.changeWebGLSize=os._changeWebGLSize,oj.is3DMode=!0,oS.init(oo,or),om.__init__(),opr.__init__(),owr.__init__(),oY.__init__(),os.__init__(),on.maxTextureCount=2,(os.debugMode||oQ.debugMode)&&(os._debugPhasorSprite=new oa)},os.HIERARCHY="SPRITE3DHIERARCHY",os.MESH="MESH",os.MATERIAL="MATERIAL",os.PBRMATERIAL="PBRMTL",os.TEXTURECUBE="TEXTURECUBE",os.TERRAIN="TERRAIN",os._readData=null,os._debugPhasorSprite=null,os.debugMode=!1,op(os,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new or},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new or},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new or},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new or}]),os}(),o$r=function(oo){function oW(oo){oW.__super.call(this),this._owner=oo,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}ov(oW,"laya.d3.animation.AnimationTransform3D",oD);var or=oW.prototype;return or._getlocalMatrix=function(){return this._localUpdate&&(o_r._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},or._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var oo=0,or=this._childs.length;oo<or;oo++)this._childs[oo]._onWorldTransform()}},or._setWorldMatrixAndUpdate=function(oo){if(this._worldMatrix=oo,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var or=this._getlocalMatrix(),oT=0;oT<16;++oT)this._worldMatrix[oT]=or[oT];else o_r.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},or._setWorldMatrixNoUpdate=function(oo){this._worldMatrix=oo},or._setWorldMatrixIgnoreUpdate=function(oo){this._worldMatrix=oo,this._worldUpdate=!1},or.getLocalPosition=function(){return this._localPosition},or.setLocalPosition=function(oo){if(this._parent)this._localPosition=oo,this._localUpdate=!0,this._onWorldTransform();else{var or=this._entity.owner._transform,oT=this._entity.localPosition,ok=oT.elements;ok[0]=oo[0],ok[1]=oo[1],ok[2]=oo[2],or.localPosition=oT}},or.getLocalRotation=function(){if(this._localQuaternionUpdate){var oo=this._localRotationEuler;o_r._quaternionCreateFromYawPitchRollArray(oo[1]/oW._angleToRandin,oo[0]/oW._angleToRandin,oo[2]/oW._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},or.setLocalRotation=function(oo){if(this._parent)this._localRotation=oo,o_r.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var or=this._entity.owner._transform,oT=this._entity.localRotation,ok=oT.elements;ok[0]=oo[0],ok[1]=oo[1],ok[2]=oo[2],ok[3]=oo[3],or.localRotation=oT}},or.getLocalScale=function(){return this._localScale},or.setLocalScale=function(oo){if(this._parent)this._localScale=oo,this._localUpdate=!0,this._onWorldTransform();else{var or=this._entity.owner._transform,oT=this._entity.localScale,ok=oT.elements;ok[0]=oo[0],ok[1]=oo[1],ok[2]=oo[2],or.localScale=oT}},or.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){o_r.getYawPitchRoll(this._localRotation,oW._tempVector3);var oo=oW._tempVector3,or=this._localRotationEuler;or[0]=oo[1]*oW._angleToRandin,or[1]=oo[0]*oW._angleToRandin,or[2]=oo[2]*oW._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},or.setLocalRotationEuler=function(oo){if(this._parent)o_r._quaternionCreateFromYawPitchRollArray(oo[1]/oW._angleToRandin,oo[0]/oW._angleToRandin,oo[2]/oW._angleToRandin,this._localRotation),this._localRotationEuler=oo,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var or=this._entity.owner._transform,oT=this._entity.localRotationEuler,ok=oT.elements;ok[0]=oo[0],ok[1]=oo[1],ok[2]=oo[2],or.localRotationEuler=oT}},or.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)o_r.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var oo=this._getlocalMatrix(),or=0;or<16;++or)this._worldMatrix[or]=oo[or];this._worldUpdate=!1}return this._worldMatrix},or.setParent=function(oo){if(this._parent!==oo){if(this._parent){var or=this._parent._childs,oT=or.indexOf(this);or.splice(oT,1)}oo&&(oo._childs.push(this),oo&&this._onWorldTransform()),this._parent=oo}},op(oW,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),oW}(),oyr=function(oo){function or(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,or.__super.call(this),this._destroyed=!1,this._id=or._uniqueIDCounter,or._uniqueIDCounter++}ov(or,"laya.d3.component.Component3D",oD);var oT=or.prototype;return oS.imps(oT,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),oT._initialize=function(oo){this._owner=oo,this._enable=!0,this.started=!1,this._load(oo)},oT._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},oT._load=function(oo){},oT._start=function(oo){},oT._update=function(oo){},oT._lateUpdate=function(oo){},oT._preRenderUpdate=function(oo){},oT._postRenderUpdate=function(oo){},oT._unload=function(oo){this.offAll()},oT._cloneTo=function(oo){},ox(0,oT,"id",function(){return this._id}),ox(0,oT,"destroyed",function(){return this._destroyed}),ox(0,oT,"owner",function(){return this._owner}),ox(0,oT,"enable",function(){return this._enable},function(oo){this._enable!==oo&&(this._enable=oo,this.event("enablechanged",this._enable))}),ox(0,oT,"isSingleton",function(){return or._isSingleton}),or._isSingleton=!0,or._uniqueIDCounter=1,or}(),olr=function(oo){function or(){this._destroyed=!1,or.__super.call(this),this._destroyed=!1}ov(or,"laya.d3.core.GeometryFilter",oD);var oT=or.prototype;return oS.imps(oT,{"laya.resource.IDestroy":!0}),oT._destroy=function(){this.offAll(),this._destroyed=!0},ox(0,oT,"_isAsyncLoaded",function(){return!0}),ox(0,oT,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),ox(0,oT,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),ox(0,oT,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),ox(0,oT,"destroyed",function(){return this._destroyed}),or}(),oSr=function(oo){function ok(oo){ok.__super.call(this),this._id=++ok._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new oQo(new onr,new onr),this._boundingBoxCenter=new onr,this._boundingSphere=new oBo(new onr,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=oo,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}ov(ok,"laya.d3.core.render.BaseRender",oD);var or=ok.prototype;return oS.imps(or,{"laya.resource.IDestroy":!0}),or._changeMaterialReference=function(oo,or){oo&&oo._removeReference(),or._addReference()},or._getInstanceMaterial=function(oo,or){var oT=new oo.constructor;return oo.cloneTo(oT),oT.name=oT.name+"(Instance)",this._materialsInstance[or]=!0,this._changeMaterialReference(this._materials[or],oT),this._materials[or]=oT},or._setShaderValuelightMap=function(oo){this._setShaderValueTexture(3,oo)},or._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},or._renderRenderableBoundBox=function(){var oo=oKr._debugPhasorSprite,or=this.boundingBox,oT=ok._tempBoundBoxCorners;or.getCorners(oT),oo.line(oT[0],ok._greenColor,oT[1],ok._greenColor),oo.line(oT[2],ok._greenColor,oT[3],ok._greenColor),oo.line(oT[4],ok._greenColor,oT[5],ok._greenColor),oo.line(oT[6],ok._greenColor,oT[7],ok._greenColor),oo.line(oT[0],ok._greenColor,oT[3],ok._greenColor),oo.line(oT[1],ok._greenColor,oT[2],ok._greenColor),oo.line(oT[2],ok._greenColor,oT[6],ok._greenColor),oo.line(oT[3],ok._greenColor,oT[7],ok._greenColor),oo.line(oT[0],ok._greenColor,oT[4],ok._greenColor),oo.line(oT[1],ok._greenColor,oT[5],ok._greenColor),oo.line(oT[4],ok._greenColor,oT[7],ok._greenColor),oo.line(oT[5],ok._greenColor,oT[6],ok._greenColor)},or._calculateBoundingSphere=function(){throw"BaseRender: must override it."},or._calculateBoundingBox=function(){throw"BaseRender: must override it."},or._setShaderValueTexture=function(oo,or){this._owner._shaderValues.setValue(oo,or)},or._setShaderValueMatrix4x4=function(oo,or){this._owner._shaderValues.setValue(oo,or?or.elements:null)},or._setShaderValueColor=function(oo,or){this._owner._shaderValues.setValue(oo,or?or.elements:null)},or._setShaderValueBuffer=function(oo,or){this._owner._shaderValues.setValue(oo,or)},or._setShaderValueInt=function(oo,or){this._owner._shaderValues.setValue(oo,or)},or._setShaderValueBool=function(oo,or){this._owner._shaderValues.setValue(oo,or)},or._setShaderValueNumber=function(oo,or){this._owner._shaderValues.setValue(oo,or)},or._setShaderValueVector2=function(oo,or){this._owner._shaderValues.setValue(oo,or?or.elements:null)},or._addShaderDefine=function(oo){this._owner._shaderDefineValue|=oo},or._removeShaderDefine=function(oo){this._owner._shaderDefineValue&=~oo},or._renderUpdate=function(oo){return!0},or._applyLightMapParams=function(){if(0<=this._lightmapIndex){var oo=this._owner.scene;if(oo){var or=oo.getlightmaps()[this._lightmapIndex];or?(this._addShaderDefine(oar.SAHDERDEFINE_LIGHTMAP),or.loaded?this._setShaderValuelightMap(or):or.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(oar.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(oar.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(oar.SAHDERDEFINE_LIGHTMAP)},or._updateOctreeNode=function(){var oo=this._treeNode;oo&&this._octreeNodeNeedChange&&(oo.updateObject(this),this._octreeNodeNeedChange=!1)},or._destroy=function(){this.offAll();var oo=0,or=0;for(oo=0,or=this._renderElements.length;oo<or;oo++)this._renderElements[oo]._destroy();for(oo=0,or=this._materials.length;oo<or;oo++)this._materials[oo]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},ox(0,or,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),ox(0,or,"id",function(){return this._id}),ox(0,or,"material",function(){var oo=this._materials[0];if(oo&&!this._materialsInstance[0]){var or=this._getInstanceMaterial(oo,0);this.event("materialchanged",[this,0,or])}return this._materials[0]},function(oo){this.sharedMaterial=oo}),ox(0,or,"sharedMaterial",function(){return this._materials[0]},function(oo){var or=this._materials[0];or!==oo&&(this._materials[0]=oo,this._materialsInstance[0]=!1,this._changeMaterialReference(or,oo),this.event("materialchanged",[this,0,oo]))}),ox(0,or,"lightmapIndex",function(){return this._lightmapIndex},function(oo){this._lightmapIndex=oo,this._applyLightMapParams()}),ox(0,or,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(oo){this._lightmapScaleOffset=oo,this._setShaderValueColor(2,oo),this._addShaderDefine(oar.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),ox(0,or,"enable",function(){return this._enable},function(oo){this._enable=oo,this.event("enablechanged",[this,oo])}),ox(0,or,"materials",function(){for(var oo=0,or=this._materials.length;oo<or;oo++)if(!this._materialsInstance[oo]){var oT=this._getInstanceMaterial(this._materials[oo],oo);this.event("materialchanged",[this,oo,oT])}return this._materials.slice()},function(oo){this.sharedMaterials=oo}),ox(0,or,"sharedMaterials",function(){return this._materials.slice()},function(oo){if(!oo)throw new Error("MeshRender: shadredMaterials value can't be null.");var or=oo.length;this._materialsInstance.length=or;for(var oT=0;oT<or;oT++){var ok=this._materials[oT];ok!==oo[oT]&&(this._materialsInstance[oT]=!1,this._changeMaterialReference(ok,oo[oT]),this.event("materialchanged",[this,oT,oo[oT]]))}this._materials=oo}),ox(0,or,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),ox(0,or,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var oo=this.boundingBox;onr.add(oo.min,oo.max,this._boundingBoxCenter),onr.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),ox(0,or,"receiveShadow",function(){return this._receiveShadow},function(oo){this._receiveShadow!==oo&&((this._receiveShadow=oo)?this._addShaderDefine(ovr.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(ovr.SHADERDEFINE_RECEIVE_SHADOW))}),ox(0,or,"destroyed",function(){return this._destroyed}),ok._uniqueIDCounter=0,op(ok,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new onr,new onr,new onr,new onr,new onr,new onr,new onr,new onr]},"_greenColor",function(){return this._greenColor=new oVr(0,1,0,1)}]),ok}(),oqr=function(oo){function oV(oo){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,oV.__super.call(this),this._localPosition=new onr,this._localRotation=new oTr(0,0,0,1),this._localScale=new onr(1,1,1),this._localRotationEuler=new onr,this._localMatrix=new oor,this._position=new onr,this._rotation=new oTr(0,0,0,1),this._scale=new onr(1,1,1),this._worldMatrix=new oor,this._forward=new onr,this._up=new onr,this._right=new onr,this._owner=oo,this._childs=[]}ov(oV,"laya.d3.core.Transform3D",oD);var or=oV.prototype;return or._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)oor.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var oo=oV._tempVector30;onr.multiply(this.pivot,this._localScale,oo);var or=oV._tempVector31;onr.subtract(oo,this.pivot,or);var oT=oV._tempVector32,ok=this.localRotation;onr.transformQuat(oo,ok,oT),onr.subtract(oT,oo,oT);var oW=oV._tempVector33;onr.subtract(this._localPosition,or,oW),onr.subtract(oW,oT,oW),oor.createAffineTransformation(oW,ok,this._localScale,this._localMatrix)}},or._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var oo=0,or=this._childs.length;oo<or;oo++)this._childs[oo]._onWorldPositionRotationTransform()}},or._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var oo=0,or=this._childs.length;oo<or;oo++)this._childs[oo]._onWorldPositionScaleTransform()}},or._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var oo=0,or=this._childs.length;oo<or;oo++)this._childs[oo]._onWorldPositionTransform()}},or._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var oo=0,or=this._childs.length;oo<or;oo++)this._childs[oo]._onWorldPositionRotationTransform()}},or._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var oo=0,or=this._childs.length;oo<or;oo++)this._childs[oo]._onWorldPositionScaleTransform()}},or._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var oo=0,or=this._childs.length;oo<or;oo++)this._childs[oo]._onWorldTransform()}},or.translate=function(oo,or){void 0===or&&(or=!0),or?(oor.createFromQuaternion(this.localRotation,oV._tempMatrix0),onr.transformCoordinate(oo,oV._tempMatrix0,oV._tempVector30),onr.add(this.localPosition,oV._tempVector30,this._localPosition),this.localPosition=this._localPosition):(onr.add(this.position,oo,this._position),this.position=this._position)},or.rotate=function(oo,or,oT){var ok;void 0===or&&(or=!0),void 0===oT&&(oT=!0),ok=oT?oo:(onr.scale(oo,Math.PI/180,oV._tempVector30),oV._tempVector30),oTr.createFromYawPitchRoll(ok.y,ok.x,ok.z,oV._tempQuaternion0),or?(oTr.multiply(this._localRotation,oV._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(oTr.multiply(oV._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},or.lookAt=function(oo,or,oT){void 0===oT&&(oT=!1);var ok,oW=oo.elements;if(oT){if(ok=this._localPosition.elements,Math.abs(ok[0]-oW[0])<oEo.zeroTolerance&&Math.abs(ok[1]-oW[1])<oEo.zeroTolerance&&Math.abs(ok[2]-oW[2])<oEo.zeroTolerance)return;oTr.lookAt(this._localPosition,oo,or,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var oD=this.position;if(ok=oD.elements,Math.abs(ok[0]-oW[0])<oEo.zeroTolerance&&Math.abs(ok[1]-oW[1])<oEo.zeroTolerance&&Math.abs(ok[2]-oW[2])<oEo.zeroTolerance)return;oTr.lookAt(oD,oo,or,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},ox(0,or,"_isFrontFaceInvert",function(){var oo=this.scale,or=oo.x<0;return oo.y<0&&(or=!or),oo.z<0&&(or=!or),or}),ox(0,or,"owner",function(){return this._owner}),ox(0,or,"localRotation",function(){if(this._localQuaternionUpdate){var oo=this._localRotationEuler.elements;oTr.createFromYawPitchRoll(oo[1]/oV._angleToRandin,oo[0]/oV._angleToRandin,oo[2]/oV._angleToRandin,this._localRotation)}return this._localRotation},function(oo){this._localRotation=oo,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),ox(0,or,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?oor.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(oo){null===this._parent?oo.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),oor.multiply(this._localMatrix,oo,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=oo,this._worldUpdate=!1}),ox(0,or,"worldNeedUpdate",function(){return this._worldUpdate}),ox(0,or,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(oo){this._localMatrix=oo,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),ox(0,or,"dummy",function(){return this._dummy},function(oo){this._dummy!==oo&&(this._dummy&&(this._dummy._entity=null),oo&&(oo._entity=this),this._dummy=oo)}),ox(0,or,"localPosition",function(){return this._localPosition},function(oo){this._localPosition=oo,this._localUpdate=!0,this._onWorldPositionTransform()}),ox(0,or,"position",function(){if(this._positionUpdate){if(null!=this._parent){var oo=this._parent.position;onr.multiply(this._localPosition,this._parent.scale,oV._tempVector30),onr.transformQuat(oV._tempVector30,this._parent.rotation,oV._tempVector30),onr.add(oo,oV._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(oo){if(null!=this._parent){onr.subtract(oo,this._parent.position,this._localPosition);var or=this._parent.scale.elements,oT=or[0],ok=or[1],oW=or[2];if(1!==oT||1!==ok||1!==oW){var oD=oV._tempVector30,on=oD.elements;on[0]=1/oT,on[1]=1/ok,on[2]=1/oW,onr.multiply(this._localPosition,oD,this._localPosition)}this._parent.rotation.invert(oV._tempQuaternion0),onr.transformQuat(this._localPosition,oV._tempQuaternion0,this._localPosition)}else oo.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=oo,this._positionUpdate=!1}),ox(0,or,"localScale",function(){return this._localScale},function(oo){this._localScale=oo,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),ox(0,or,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(oV._tempVector30);var oo=oV._tempVector30.elements,or=this._localRotationEuler.elements;or[0]=oo[1]*oV._angleToRandin,or[1]=oo[0]*oV._angleToRandin,or[2]=oo[2]*oV._angleToRandin}return this._localRotationEuler},function(oo){this._localRotationEuler=oo,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),ox(0,or,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?oTr.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(oo){null!=this._parent?(this._parent.rotation.invert(oV._tempQuaternion0),oTr.multiply(oo,oV._tempQuaternion0,this._localRotation)):oo.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=oo,this._rotationUpdate=!1}),ox(0,or,"scale",function(){return this._scaleUpdate&&(null!==this._parent?onr.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(oo){if(null!==this._parent){var or=this._parent.scale.elements,oT=oV._tempVector30.elements;oT[0]=1/or[0],oT[1]=1/or[1],oT[2]=1/or[2],onr.multiply(oo,oV._tempVector30,this._localScale)}else oo.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=oo,this._scaleUpdate=!1}),ox(0,or,"rotationEuler",null,function(oo){oTr.createFromYawPitchRoll(oo.y,oo.x,oo.z,this._rotation),this.rotation=this._rotation}),ox(0,or,"forward",function(){var oo=this.worldMatrix.elements;return this._forward.elements[0]=-oo[8],this._forward.elements[1]=-oo[9],this._forward.elements[2]=-oo[10],this._forward}),ox(0,or,"up",function(){var oo=this.worldMatrix.elements;return this._up.elements[0]=oo[4],this._up.elements[1]=oo[5],this._up.elements[2]=oo[6],this._up}),ox(0,or,"right",function(){var oo=this.worldMatrix.elements;return this._right.elements[0]=oo[0],this._right.elements[1]=oo[1],this._right.elements[2]=oo[2],this._right}),ox(0,or,"parent",function(){return this._parent},function(oo){if(this._parent!==oo){if(this._parent){var or=this._parent._childs,oT=or.indexOf(this);or.splice(oT,1)}oo&&(oo._childs.push(this),oo&&this._onWorldTransform()),this._parent=oo}}),op(oV,["_tempVector30",function(){return this._tempVector30=new onr},"_tempVector31",function(){return this._tempVector31=new onr},"_tempVector32",function(){return this._tempVector32=new onr},"_tempVector33",function(){return this._tempVector33=new onr},"_tempQuaternion0",function(){return this._tempQuaternion0=new oTr},"_tempMatrix0",function(){return this._tempMatrix0=new oor},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),oV}(),obr=(function(oo){function or(){this._rotation=0,this._matNeedUpdte=!1,or.__super.call(this),this._matrix=new oor,this._offset=new oDr,this._tiling=new oDr(1,1)}ov(or,"laya.d3.core.TransformUV",oD);var oT=or.prototype;oS.imps(oT,{"laya.d3.core.IClone":!0}),oT._updateMatrix=function(){or._tempOffsetV3.elements[0]=this._offset.x,or._tempOffsetV3.elements[1]=this._offset.y,oTr.createFromYawPitchRoll(0,0,this._rotation,or._tempRotationQua),or._tempTitlingV3.elements[0]=this._tiling.x,or._tempTitlingV3.elements[1]=this._tiling.y,oor.createAffineTransformation(or._tempOffsetV3,or._tempRotationQua,or._tempTitlingV3,this._matrix)},oT.cloneTo=function(oo){oo._matrix=this._matrix.clone(),oo._offset=this._offset.clone(),oo._rotation=this._rotation,oo._tiling=this._tiling.clone()},oT.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,oT,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),ox(0,oT,"tiling",function(){return this._tiling},function(oo){this._tiling=oo,this._matNeedUpdte=!0}),ox(0,oT,"offset",function(){return this._offset},function(oo){this._offset=oo,this._matNeedUpdte=!0}),ox(0,oT,"rotation",function(){return this._rotation},function(oo){this._rotation=oo,this._matNeedUpdte=!0}),op(or,["_tempOffsetV3",function(){return this._tempOffsetV3=new onr(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new oTr},"_tempTitlingV3",function(){return this._tempTitlingV3=new onr(1,1,1)}])}(),function(oT){function oo(){this.x=NaN,this.y=NaN,this.z=NaN,oo.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}ov(oo,"laya.d3.core.particleShuriKen.module.shape.BoxShape",oT);var or=oo.prototype;or._getShapeBoundBox=function(oo){var or=oo.min.elements;or[0]=.5*-this.x,or[1]=.5*-this.y,or[2]=.5*-this.z;var oT=oo.max.elements;oT[0]=.5*this.x,oT[1]=.5*this.y,oT[2]=.5*this.z},or._getSpeedBoundBox=function(oo){var or=oo.min.elements;or[0]=0,or[1]=0,or[2]=0;var oT=oo.max.elements;oT[0]=0,oT[1]=1,oT[2]=0},or.generatePositionAndDirection=function(oo,or,oT,ok){var oW=oo.elements,oD=or.elements;oT?(oT.seed=ok[16],oN._randomPointInsideHalfUnitBox(oo,oT),ok[16]=oT.seed):oN._randomPointInsideHalfUnitBox(oo),oW[0]=this.x*oW[0],oW[1]=this.y*oW[1],oW[2]=this.z*oW[2],this.randomDirection?oT?(oT.seed=ok[17],oN._randomPointUnitSphere(or,oT),ok[17]=oT.seed):oN._randomPointUnitSphere(or):(oD[0]=0,oD[1]=0,oD[2]=1)},or.cloneTo=function(oo){oT.prototype.cloneTo.call(this,oo);var or=oo;or.x=this.x,or.y=this.y,or.z=this.z,or.randomDirection=this.randomDirection}}(oe),function(oT){function on(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,on.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}ov(on,"laya.d3.core.particleShuriKen.module.shape.CircleShape",oT);var oo=on.prototype;oo._getShapeBoundBox=function(oo){var or=oo.min.elements;or[0]=or[2]=-this.radius,or[1]=0;var oT=oo.max.elements;oT[0]=oT[2]=this.radius,oT[1]=0},oo._getSpeedBoundBox=function(oo){var or=oo.min.elements;or[0]=or[1]=-1,or[2]=0;var oT=oo.max.elements;oT[0]=oT[1]=1,oT[2]=0},oo.generatePositionAndDirection=function(oo,or,oT,ok){var oW=oo.elements,oD=on._tempPositionPoint.elements;oT?(oT.seed=ok[16],this.emitFromEdge?oN._randomPointUnitArcCircle(this.arc,on._tempPositionPoint,oT):oN._randomPointInsideUnitArcCircle(this.arc,on._tempPositionPoint,oT),ok[16]=oT.seed):this.emitFromEdge?oN._randomPointUnitArcCircle(this.arc,on._tempPositionPoint):oN._randomPointInsideUnitArcCircle(this.arc,on._tempPositionPoint),oW[0]=-oD[0],oW[1]=oD[1],oW[2]=0,onr.scale(oo,this.radius,oo),this.randomDirection?oT?(oT.seed=ok[17],oN._randomPointUnitSphere(or,oT),ok[17]=oT.seed):oN._randomPointUnitSphere(or):oo.cloneTo(or)},oo.cloneTo=function(oo){oT.prototype.cloneTo.call(this,oo);var or=oo;or.radius=this.radius,or.arc=this.arc,or.emitFromEdge=this.emitFromEdge,or.randomDirection=this.randomDirection},op(on,["_tempPositionPoint",function(){return this._tempPositionPoint=new oDr}])}(oe),function(oT){function oi(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,oi.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}ov(oi,"laya.d3.core.particleShuriKen.module.shape.ConeShape",oT);var oo=oi.prototype;oo._getShapeBoundBox=function(oo){var or=this.radius+this.length*Math.sin(this.angle),oT=this.length*Math.cos(this.angle),ok=oo.min.elements;ok[0]=ok[1]=-or,ok[2]=0;var oW=oo.max.elements;oW[0]=oW[1]=or,oW[2]=oT},oo._getSpeedBoundBox=function(oo){var or=Math.sin(this.angle),oT=oo.min.elements;oT[0]=oT[1]=-or,oT[2]=0;var ok=oo.max.elements;ok[0]=oT[1]=or,ok[2]=1},oo.generatePositionAndDirection=function(oo,or,oT,ok){var oW,oD=oo.elements,on=or.elements,oV=oi._tempPositionPoint.elements,oL=NaN,oU=NaN,oh=Math.cos(this.angle),op=Math.sin(this.angle);switch(this.emitType){case 0:oT?(oT.seed=ok[16],oN._randomPointInsideUnitCircle(oi._tempPositionPoint,oT),ok[16]=oT.seed):oN._randomPointInsideUnitCircle(oi._tempPositionPoint),oL=oV[0],oU=oV[1],oD[0]=oL*this.radius,oD[1]=oU*this.radius,oD[2]=0,this.randomDirection?(oT?(oT.seed=ok[17],oN._randomPointInsideUnitCircle(oi._tempDirectionPoint,oT),ok[17]=oT.seed):oN._randomPointInsideUnitCircle(oi._tempDirectionPoint),oW=oi._tempDirectionPoint.elements,on[0]=oW[0]*op,on[1]=oW[1]*op):(on[0]=oL*op,on[1]=oU*op),on[2]=oh;break;case 1:oT?(oT.seed=ok[16],oN._randomPointUnitCircle(oi._tempPositionPoint,oT),ok[16]=oT.seed):oN._randomPointUnitCircle(oi._tempPositionPoint),oL=oV[0],oU=oV[1],oD[0]=oL*this.radius,oD[1]=oU*this.radius,oD[2]=0,this.randomDirection?(oT?(oT.seed=ok[17],oN._randomPointInsideUnitCircle(oi._tempDirectionPoint,oT),ok[17]=oT.seed):oN._randomPointInsideUnitCircle(oi._tempDirectionPoint),oW=oi._tempDirectionPoint.elements,on[0]=oW[0]*op,on[1]=oW[1]*op):(on[0]=oL*op,on[1]=oU*op),on[2]=oh;break;case 2:oT?(oT.seed=ok[16],oN._randomPointInsideUnitCircle(oi._tempPositionPoint,oT)):oN._randomPointInsideUnitCircle(oi._tempPositionPoint),oL=oV[0],oU=oV[1],oD[0]=oL*this.radius,oD[1]=oU*this.radius,on[oD[2]=0]=oL*op,on[1]=oU*op,on[2]=oh,onr.normalize(or,or),oT?(onr.scale(or,this.length*oT.getFloat(),or),ok[16]=oT.seed):onr.scale(or,this.length*Math.random(),or),onr.add(oo,or,oo),this.randomDirection&&(oT?(oT.seed=ok[17],oN._randomPointUnitSphere(or,oT),ok[17]=oT.seed):oN._randomPointUnitSphere(or));break;case 3:oT?(oT.seed=ok[16],oN._randomPointUnitCircle(oi._tempPositionPoint,oT)):oN._randomPointUnitCircle(oi._tempPositionPoint),oL=oV[0],oU=oV[1],oD[0]=oL*this.radius,oD[1]=oU*this.radius,on[oD[2]=0]=oL*op,on[1]=oU*op,on[2]=oh,onr.normalize(or,or),oT?(onr.scale(or,this.length*oT.getFloat(),or),ok[16]=oT.seed):onr.scale(or,this.length*Math.random(),or),onr.add(oo,or,oo),this.randomDirection&&(oT?(oT.seed=ok[17],oN._randomPointUnitSphere(or,oT),ok[17]=oT.seed):oN._randomPointUnitSphere(or));break;default:throw new Error("ConeShape:emitType is invalid.")}},oo.cloneTo=function(oo){oT.prototype.cloneTo.call(this,oo);var or=oo;or.angle=this.angle,or.radius=this.radius,or.length=this.length,or.emitType=this.emitType,or.randomDirection=this.randomDirection},op(oi,["_tempPositionPoint",function(){return this._tempPositionPoint=new oDr},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new oDr}])}(oe),function(oT){function oo(){this.radius=NaN,this.emitFromShell=!1,oo.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}ov(oo,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",oT);var or=oo.prototype;or._getShapeBoundBox=function(oo){var or=oo.min.elements;or[0]=or[1]=or[2]=-this.radius;var oT=oo.max.elements;oT[0]=oT[1]=this.radius,oT[2]=0},or._getSpeedBoundBox=function(oo){var or=oo.min.elements;or[0]=or[1]=-1,or[2]=0;var oT=oo.max.elements;oT[0]=oT[1]=oT[2]=1},or.generatePositionAndDirection=function(oo,or,oT,ok){var oW=oo.elements;oT?(oT.seed=ok[16],this.emitFromShell?oN._randomPointUnitSphere(oo,oT):oN._randomPointInsideUnitSphere(oo,oT),ok[16]=oT.seed):this.emitFromShell?oN._randomPointUnitSphere(oo):oN._randomPointInsideUnitSphere(oo),onr.scale(oo,this.radius,oo);var oD=oW[2];oD<0&&(oW[2]=-1*oD),this.randomDirection?oT?(oT.seed=ok[17],oN._randomPointUnitSphere(or,oT),ok[17]=oT.seed):oN._randomPointUnitSphere(or):oo.cloneTo(or)},or.cloneTo=function(oo){oT.prototype.cloneTo.call(this,oo);var or=oo;or.radius=this.radius,or.emitFromShell=this.emitFromShell,or.randomDirection=this.randomDirection}}(oe),function(oT){function oo(){this.radius=NaN,this.emitFromShell=!1,oo.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}ov(oo,"laya.d3.core.particleShuriKen.module.shape.SphereShape",oT);var or=oo.prototype;or._getShapeBoundBox=function(oo){var or=oo.min.elements;or[0]=or[1]=or[2]=-this.radius;var oT=oo.max.elements;oT[0]=oT[1]=oT[2]=this.radius},or._getSpeedBoundBox=function(oo){var or=oo.min.elements;or[0]=or[1]=or[2]=-1;var oT=oo.max.elements;oT[0]=oT[1]=oT[2]=1},or.generatePositionAndDirection=function(oo,or,oT,ok){oT?(oT.seed=ok[16],this.emitFromShell?oN._randomPointUnitSphere(oo,oT):oN._randomPointInsideUnitSphere(oo,oT),ok[16]=oT.seed):this.emitFromShell?oN._randomPointUnitSphere(oo):oN._randomPointInsideUnitSphere(oo),onr.scale(oo,this.radius,oo),this.randomDirection?oT?(oT.seed=ok[17],oN._randomPointUnitSphere(or,oT),ok[17]=oT.seed):oN._randomPointUnitSphere(or):oo.cloneTo(or)},or.cloneTo=function(oo){oT.prototype.cloneTo.call(this,oo);var or=oo;or.radius=this.radius,or.emitFromShell=this.emitFromShell,or.randomDirection=this.randomDirection}}(oe),function(oo){function or(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,or.__super.call(this)}return ov(or,"laya.d3.core.render.SubMeshRenderElement",oG),or}()),oFr=function(oo){function o_(oo,or,oT,ok,oW,oD){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=oo,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[ovr.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[oar.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[oar.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[oRr.SHADERDEFINE_ALPHATEST]="ALPHATEST";o_.__super.call(this,oo,or,oT,null,{}),this._attributeMap=ok;var on;for(on in oW){var oV=oW[on];switch(oV[1]){case 0:this._renderElementUniformMap[on]=oV[0];break;case 1:this._materialUniformMap[on]=oV[0];break;case 2:this._spriteUniformMap[on]=oV[0];break;case 3:this._cameraUniformMap[on]=oV[0];break;case 4:this._sceneUniformMap[on]=oV[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}ov(o_,"laya.d3.shader.ShaderCompile3D",oy);var or=o_.prototype;return or._definesToNameDic=function(oo,or){for(var oT={},ok=1,oW=0;oW<32&&!(oo<(ok=1<<oW));oW++)if(oo&ok){var oD=or[ok];oD&&(oT[oD]="")}return oT},or.withCompile=function(oo,or,oT,ok){var oW,oD,on;if(oD=this.sharders[oo])if(on=oD[or]){if(oW=on[oT])return oW}else on=oD[or]=[];else on=(oD=this.sharders[oo]=[])[or]=[];var oV,oL=this._definesToNameDic(oo,o_._globalInt2name),oU=this._definesToNameDic(or,this._spriteInt2name),oh=this._definesToNameDic(oT,this._materialInt2name),op={},oi="";if(oL)for(oV in oL)oi+="#define "+oV+"\n",op[oV]=!0;if(oU)for(oV in oU)oi+="#define "+oV+"\n",op[oV]=!0;if(oh)for(oV in oh)oi+="#define "+oV+"\n",op[oV]=!0;var ov=oOr.nameKey.getName(this._name)+" compile ("+oo+","+or+","+oT+")",ox=this._VS.toscript(op,[]),oj=this._PS.toscript(op,[]);oz.now();if(oW=oOr.create(oi+ox.join("\n"),oi+oj.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,ok,ov),on[oT]=oW,laya.d3.shader.ShaderCompile3D.debugMode)oz.now();return oW},or.precompileShaderWithShaderDefine=function(oo,or,oT){this.withCompile(oo,or,oT,!0)},or.addMaterialDefines=function(oo){var or=oo.defines;for(var oT in or){var ok=or[oT],oW=parseInt(oT);this._materialInt2name[oW]=ok,this._materialName2Int[ok]=oW}},or.addSpriteDefines=function(oo){var or=oo.defines;for(var oT in or){var ok=or[oT],oW=parseInt(oT);this._spriteInt2name[oW]=ok,this._spriteName2Int[ok]=oW}},or.getMaterialDefineByName=function(oo){return this._materialName2Int[oo]},or.registerMaterialDefine=function(oo){var or=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[or]=oo,this._materialName2Int[oo]=or},or.registerSpriteDefine=function(oo){var or=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[or]=oo,this._spriteName2Int[oo]=or},o_._globalRegDefine=function(oo,or){o_._globalInt2name[or]=oo},o_.add=function(oo,or,oT,ok,oW){return laya.d3.shader.ShaderCompile3D._preCompileShader[oo]=new o_(oo,or,oT,ok,oW,oy.includes)},o_.get=function(oo){return laya.d3.shader.ShaderCompile3D._preCompileShader[oOr.nameKey.getID(oo)]},o_._preCompileShader={},o_._globalInt2name=[],o_.debugMode=!1,o_.SHADERDEFINE_HIGHPRECISION=1,o_.SHADERDEFINE_FOG=4,o_.SHADERDEFINE_DIRECTIONLIGHT=8,o_.SHADERDEFINE_POINTLIGHT=16,o_.SHADERDEFINE_SPOTLIGHT=32,o_.SHADERDEFINE_UV0=64,o_.SHADERDEFINE_COLOR=128,o_.SHADERDEFINE_UV1=256,o_.SAHDERDEFINE_DEPTHFOG=131072,o_}(),oPr=function(oo){function ox(){ox.__super.call(this)}ov(ox,"laya.d3.graphics.MeshSprite3DStaticBatchManager",oko);var or=ox.prototype;return or._getStaticBatch=function(oo,or,oT,ok){var oW,oD;return oD=oo?oo.id.toString()+oT.id.toString()+or.id.toString()+ok.toString():oT.id.toString()+or.id.toString()+ok.toString(),this._staticBatches[oD]?oW=this._staticBatches[oD]:this._staticBatches[oD]=oW=new otr(oD,this,oo,or,oT),oW},or._initStaticBatchs=function(oo){var or,oT;this._initBatchRenderElements.sort(ox._sortPrepareStaticBatch);for(var ok,oW=!1,oD=0,on=0,oV=this._initBatchRenderElements.length;on<oV;on++){var oL,oU=this._initBatchRenderElements[on],oh=oU.renderObj._getVertexBuffer(0);oU._sprite3D;if(oT===oh.vertexDeclaration&&or===oU._material)if(oW)ok._addCombineBatchRenderObjTest(oU)?(oL=oU._staticBatch)!==ok&&(oL&&oL._deleteCombineBatchRenderObj(oU),ok._addCombineBatchRenderObj(oU)):(oW=!1,oD++);else{var op=this._initBatchRenderElements[on-1],oi=op.renderObj,ov=oU.renderObj;oW=!(65535<oi._getVertexBuffer().vertexCount+ov._getVertexBuffer().vertexCount)&&(ok=this._getStaticBatch(oo,oT,or,oD),(oL=op._staticBatch)!==ok&&(oL&&oL._deleteCombineBatchRenderObj(op),ok._addCombineBatchRenderObj(op)),(oL=oU._staticBatch)!==ok&&(oL&&oL._deleteCombineBatchRenderObj(oU),ok._addCombineBatchRenderObj(oU)),!0)}else oW=!1,oD=0;or=oU._material,oT=oh.vertexDeclaration}},ox._sortPrepareStaticBatch=function(oo,or){var oT=oo._render,ok=or._render,oW=oT.lightmapIndex-ok.lightmapIndex;if(0!=oW)return oW;var oD=oT.receiveShadow-ok.receiveShadow;if(0!=oD)return oD;var on=oo._mainSortID-or._mainSortID;return 0==on?oo.renderObj.triangleCount-or.renderObj.triangleCount:on},ox}(),otr=function(oo){function oD(oo,or,oT,ok,oW){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,oD.__super.call(this,oo,or,oT),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=ok,this._material=oW}ov(oD,"laya.d3.graphics.SubMeshStaticBatch",oWo);var or=oD.prototype;return or._compareBatchRenderElement=function(oo,or){return oo._batchIndexStart>or._batchIndexStart},or._addCombineBatchRenderObjTest=function(oo){var or=oo.renderObj._vertexCount;return!(65535<(0<or?this._currentCombineVertexCount+or:this._currentCombineVertexCount+oo.renderObj._getVertexBuffer().vertexCount))},or._addCombineBatchRenderObj=function(oo){var or=oo.renderObj,oT=or._vertexCount;this._initBatchRenderElements.push(oo),oo._staticBatch=this,0<oT?(this._currentCombineIndexCount+=or._indexCount,this._currentCombineVertexCount+=oT):(this._currentCombineIndexCount=this._currentCombineIndexCount+or._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+or._getVertexBuffer().vertexCount),this._needFinishCombine=!0},or._deleteCombineBatchRenderObj=function(oo){var or=oo.renderObj,oT=this._initBatchRenderElements.indexOf(oo);if(-1!==oT){this._initBatchRenderElements.splice(oT,1),oo._staticBatch=null;var ok=or._vertexCount;0<ok?(this._currentCombineIndexCount=this._currentCombineIndexCount-or._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-ok):(this._currentCombineIndexCount=this._currentCombineIndexCount-or._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-or._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},or._finishInit=function(){if(this._needFinishCombine){var oo=0,or=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var oT=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),ok=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=oer.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=ocr.create("ushort",this._currentCombineIndexCount,35044);for(var oW=0,oD=this._initBatchRenderElements.length;oW<oD;oW++){var on=this._initBatchRenderElements[oW],oV=on.renderObj,oL=oV._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,on._sprite3D),oU=oV.getIndices(),oh=on._sprite3D.transform._isFrontFaceInvert,op=oo/(this._vertexDeclaration.vertexStride/4)-oV._vertexStart,oi=or,ov=oi+oU.length;on._batchIndexStart=oi,on._batchIndexEnd=ov,ok.set(oU,or);var ox=0;if(oh)for(ox=oi;ox<ov;ox+=3){ok[ox]=op+ok[ox];var oj=ok[ox+1],o_=ok[ox+2];ok[ox+1]=op+o_,ok[ox+2]=op+oj}else for(ox=oi;ox<ov;ox+=3)ok[ox]=op+ok[ox],ok[ox+1]=op+ok[ox+1],ok[ox+2]=op+ok[ox+2];or+=oU.length,oT.set(oL,oo),oo+=oL.length}this._vertexBuffer.setData(oT),this._indexBuffer.setData(ok),this._needFinishCombine=!1}},or._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new obr)},or._getRenderElement=function(oo,or,oT){for(var ok,oW,oD=this._batchRenderElements.length,on=!0,oV=0;oV<oD;oV++){var oL,oU,oh=(oW=this._batchRenderElements[oV])._sprite3D._render;if(0!==oV&&(on=(oL=(ok=this._batchRenderElements[oV-1])._sprite3D._render).lightmapIndex!==oh.lightmapIndex||oL.receiveShadow!==oh.receiveShadow||ok._batchIndexEnd!==oW._batchIndexStart),on){(oU=this._getCombineRenderElementFromPool()).renderObj=this,oU._material=this._material,oU._batchIndexStart=oW._batchIndexStart,oU._batchIndexEnd=oW._batchIndexEnd;var op=oh.lightmapIndex,oi=op+1,ov=this._batchOwnerIndices[oi];ov||(ov=this._batchOwnerIndices[oi]=[]);var ox,oj=ov[oW._render.receiveShadow?1:0];void 0===oj?(ov[oh.receiveShadow?1:0]=this._batchOwners.length,(ox=new owr(null,"StaticBatchMeshSprite3D"))._scene=or,ox._transform=this._rootOwner?this._rootOwner._transform:null,ox._render.lightmapIndex=op,ox._render.receiveShadow=oW._render.receiveShadow,this._batchOwners.push(ox)):ox=this._batchOwners[oj],ox._render._renderUpdate(oT),oU._sprite3D=ox,oo.push(oU)}else oU._batchIndexEnd=oW._batchIndexEnd}},or._beforeRender=function(oo){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},or._render=function(oo){var or=oo.renderElement,oT=or._batchIndexStart,ok=or._batchIndexEnd-oT;ou.mainContext.drawElements(4,ok,5123,2*oT),oF.drawCall++,oF.trianglesFaces+=ok/3},or.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},or._getVertexBuffer=function(oo){return void 0===oo&&(oo=0),this._vertexBuffer},oD}(),oHr=function(oo){function or(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,or.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}ov(or,"laya.d3.core.ComponentNode",oU);var oT=or.prototype;return oT.addComponent=function(oo){var or,oT=this._componentsMap.indexOf(oo);if(-1===oT)or=[],this._componentsMap.push(oo),this._typeComponentsIndices.push(or);else if(or=this._typeComponentsIndices[oT],this._components[or[0]].isSingleton)throw new Error("无法单实例创建"+oo+"组件，"+oo+"组件已存在！");var ok=oW.getInstance(oo);return or.push(this._components.length),this._components.push(ok),ok instanceof laya.d3.component.Script&&this._scripts.push(ok),ok._initialize(this),ok},oT._removeComponent=function(oo,or){var oT=this._typeComponentsIndices[oo],ok=oT[or],oW=this._components[ok];this._components.splice(ok,1),oW instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(oW),1),oT.splice(or,1),0===oT.length&&(this._typeComponentsIndices.splice(oo,1),this._componentsMap.splice(oo,1));for(var oD=0,on=this._componentsMap.length;oD<on;oD++)for(var oV=(oT=this._typeComponentsIndices[oD]).length-1;0<=oV;oV--){var oL=oT[oV];if(!(ok<oL))break;oT[oV]=--oL}oW._destroy()},oT.getComponentByType=function(oo,or){void 0===or&&(or=0);var oT=this._componentsMap.indexOf(oo);return-1===oT?null:this._components[this._typeComponentsIndices[oT][or]]},oT.getComponentsByType=function(oo,or){var oT=this._componentsMap.indexOf(oo);if(-1!==oT){var ok=this._typeComponentsIndices[oT],oW=ok.length;or.length=oW;for(var oD=0;oD<oW;oD++)or[oD]=this._components[ok[oD]]}else or.length=0},oT.getComponentByIndex=function(oo){return this._components[oo]},oT.removeComponentByType=function(oo,or){void 0===or&&(or=0);var oT=this._componentsMap.indexOf(oo);-1!==oT&&this._removeComponent(oT,or)},oT.removeComponentsByType=function(oo){var or=this._componentsMap.indexOf(oo);if(-1!==or)for(var oT=this._typeComponentsIndices[or],ok=0,oW=oT.length;ok<oW;oT.length<oW?oW--:ok++)this._removeComponent(or,ok)},oT.removeAllComponent=function(){for(var oo=0,or=this._componentsMap.length;oo<or;this._componentsMap.length<or?or--:oo++)this.removeComponentsByType(this._componentsMap[oo])},oT._updateComponents=function(oo){for(var or=0,oT=this._components.length;or<oT;or++){var ok=this._components[or];!ok.started&&(ok._start(oo),ok.started=!0),ok.enable&&ok._update(oo)}},oT._lateUpdateComponents=function(oo){for(var or=0;or<this._components.length;or++){var oT=this._components[or];!oT.started&&(oT._start(oo),oT.started=!0),oT.enable&&oT._lateUpdate(oo)}},oT._preRenderUpdateComponents=function(oo){for(var or=0;or<this._components.length;or++){var oT=this._components[or];!oT.started&&(oT._start(oo),oT.started=!0),oT.enable&&oT._preRenderUpdate(oo)}},oT._postRenderUpdateComponents=function(oo){for(var or=0;or<this._components.length;or++){var oT=this._components[or];!oT.started&&(oT._start(oo),oT.started=!0),oT.enable&&oT._postRenderUpdate(oo)}},or}(),oRr=function(ok){function oo(){oo.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new oir,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new oVr(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}ov(oo,"laya.d3.core.material.BaseMaterial",ok);var or=oo.prototype;return oS.imps(or,{"laya.d3.core.IClone":!0}),or._addShaderDefine=function(oo){this._shaderDefineValue|=oo},or._removeShaderDefine=function(oo){this._shaderDefineValue&=~oo},or._addDisablePublicShaderDefine=function(oo){this._disablePublicShaderDefine|=oo},or._removeDisablePublicShaderDefine=function(oo){this._disablePublicShaderDefine&=~oo},or._setBuffer=function(oo,or){this._shaderValues.setValue(oo,or),this._values[oo]=or},or._getBuffer=function(oo){return this._values[oo]},or._setMatrix4x4=function(oo,or){this._shaderValues.setValue(oo,or?or.elements:null),this._values[oo]=or},or._getMatrix4x4=function(oo){return this._values[oo]},or._setInt=function(oo,or){this._shaderValues.setValue(oo,or),this._values[oo]=or},or._getInt=function(oo){return this._values[oo]},or._setNumber=function(oo,or){this._shaderValues.setValue(oo,or),this._values[oo]=or},or._getNumber=function(oo){return this._values[oo]},or._setBool=function(oo,or){this._shaderValues.setValue(oo,or),this._values[oo]=or},or._getBool=function(oo){return this._values[oo]},or._setVector2=function(oo,or){this._shaderValues.setValue(oo,or?or.elements:null),this._values[oo]=or},or._getVector2=function(oo){return this._values[oo]},or._setColor=function(oo,or){this._shaderValues.setValue(oo,or?or.elements:null),this._values[oo]=or},or._getColor=function(oo){return this._values[oo]},or._setTexture=function(oo,or){var oT=this._values[oo];this._values[oo]=or,this._shaderValues.setValue(oo,or),0<this.referenceCount&&(oT&&oT._removeReference(),or&&or._addReference())},or._getTexture=function(oo){return this._values[oo]},or._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},or._getShader=function(oo,or,oT){var ok=(oo|or)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(ok,oT,this._shaderDefineValue),this._shader},or._setRenderStateBlendDepth=function(){var oo=ou.mainContext;switch(os.setDepthMask(oo,this.depthWrite),0===this.depthTest?os.setDepthTest(oo,!1):(os.setDepthTest(oo,!0),os.setDepthFunc(oo,this.depthTest)),this.blend){case 0:os.setBlend(oo,!1);break;case 1:os.setBlend(oo,!0),os.setBlendFunc(oo,this.srcBlend,this.dstBlend);break;case 2:os.setBlend(oo,!0)}},or._setRenderStateFrontFace=function(oo,or){var oT=ou.mainContext,ok=0;switch(this.cull){case 0:os.setCullFace(oT,!1);break;case 1:os.setCullFace(oT,!0),ok=oo?or&&or._isFrontFaceInvert?2305:2304:or&&or._isFrontFaceInvert?2304:2305,os.setFrontFace(oT,ok);break;case 2:os.setCullFace(oT,!0),ok=oo?or&&or._isFrontFaceInvert?2304:2305:or&&or._isFrontFaceInvert?2305:2304,os.setFrontFace(oT,ok)}},or.onAsynLoaded=function(oo,or,oT){var ok=or[0],oW=or[1];switch(ok.version){case"LAYAMATERIAL:01":var oD=0,on=0,oV=ok.props;for(var oL in oV)switch(oL){case"vectors":var oU=oV[oL];for(oD=0,on=oU.length;oD<on;oD++){var oh=oU[oD],op=oh.value;switch(op.length){case 2:this[oh.name]=new oDr(op[0],op[1]);break;case 3:this[oh.name]=new onr(op[0],op[1],op[2]);break;case 4:this[oh.name]=new oVr(op[0],op[1],op[2],op[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var oi=oV[oL];for(oD=0,on=oi.length;oD<on;oD++){var ov=oi[oD],ox=ov.path;ox&&(this[ov.name]=oK.getRes(oW[ox]))}break;case"defines":var oj=oV[oL];for(oD=0,on=oj.length;oD<on;oD++){var o_=this._shaderCompile.getMaterialDefineByName(oj[oD]);this._addShaderDefine(o_)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[oL]=oV[oL];break;case"renderQueue":switch(oV[oL]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[oL]=oV[oL]}break;case"LAYAMATERIAL:02":for(oL in oV=ok.props)switch(oL){case"vectors":for(oD=0,on=(oU=oV[oL]).length;oD<on;oD++)switch((op=(oh=oU[oD]).value).length){case 2:this[oh.name]=new oDr(op[0],op[1]);break;case 3:this[oh.name]=new onr(op[0],op[1],op[2]);break;case 4:this[oh.name]=new oVr(op[0],op[1],op[2],op[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(oD=0,on=(oi=oV[oL]).length;oD<on;oD++)(ox=(ov=oi[oD]).path)&&(this[ov.name]=oK.getRes(oW[ox]));break;case"defines":for(oD=0,on=(oj=oV[oL]).length;oD<on;oD++)o_=this._shaderCompile.getMaterialDefineByName(oj[oD]),this._addShaderDefine(o_);break;default:this[oL]=oV[oL]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},or._addReference=function(){ok.prototype._addReference.call(this);for(var oo=0,or=this._values.length;oo<or;oo++){var oT=this._values[oo];oT&&oT instanceof laya.d3.resource.BaseTexture&&oT._addReference()}},or._removeReference=function(){ok.prototype._removeReference.call(this);for(var oo=0,or=this._values.length;oo<or;oo++){var oT=this._values[oo];oT&&oT instanceof laya.d3.resource.BaseTexture&&oT._removeReference()}},or.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},or.setShaderName=function(oo){var or=oOr.nameKey.getID(oo);if(-1===or)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=oFr._preCompileShader[or]},or.cloneTo=function(oo){var or=oo;or.name=this.name,or.cull=this.cull,or.blend=this.blend,or.srcBlend=this.srcBlend,or.dstBlend=this.dstBlend,or.srcBlendRGB=this.srcBlendRGB,or.dstBlendRGB=this.dstBlendRGB,or.srcBlendAlpha=this.srcBlendAlpha,or.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(or.blendConstColor),or.blendEquation=this.blendEquation,or.blendEquationRGB=this.blendEquationRGB,or.blendEquationAlpha=this.blendEquationAlpha,or.depthTest=this.depthTest,or.depthWrite=this.depthWrite,or.renderQueue=this.renderQueue,or._shader=this._shader,or._disablePublicShaderDefine=this._disablePublicShaderDefine,or._shaderDefineValue=this._shaderDefineValue;var oT,ok=0,oW=or._shaderValues;or._shaderValues.data.length=this._shaderValues.data.length;var oD=this._values.length,on=or._values;for(ok=0,oT=on.length=oD;ok<oT;ok++){var oV=this._values[ok];if(oV)if("number"==typeof oV)on[ok]=oV,oW.data[ok]=oV;else if("number"==typeof oV&&Math.floor(oV)==oV)on[ok]=oV,oW.data[ok]=oV;else if("boolean"==typeof oV)on[ok]=oV,oW.data[ok]=oV;else if(oV instanceof laya.d3.math.Vector2){var oL=on[ok]||(on[ok]=new oDr);oV.cloneTo(oL),oW.data[ok]=oL.elements}else if(oV instanceof laya.d3.math.Vector3){var oU=on[ok]||(on[ok]=new onr);oV.cloneTo(oU),oW.data[ok]=oU.elements}else if(oV instanceof laya.d3.math.Vector4){var oh=on[ok]||(on[ok]=new oVr);oV.cloneTo(oh),oW.data[ok]=oh.elements}else if(oV instanceof laya.d3.math.Matrix4x4){var op=on[ok]||(on[ok]=new oor);oV.cloneTo(op),oW.data[ok]=op.elements}else oV instanceof laya.d3.resource.BaseTexture&&(on[ok]=oV,oW.data[ok]=oV)}},or.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},ox(0,or,"alphaTestValue",function(){return this._getNumber(0)},function(oo){this._setNumber(0,oo)}),ox(0,or,"alphaTest",function(){return this._alphaTest},function(oo){(this._alphaTest=oo)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),oo.__init__=function(){oo.SHADERDEFINE_ALPHATEST=oo.shaderDefines.registerDefine("ALPHATEST")},oo.RENDERQUEUE_OPAQUE=2e3,oo.RENDERQUEUE_ALPHATEST=2450,oo.RENDERQUEUE_TRANSPARENT=3e3,oo.CULL_NONE=0,oo.CULL_FRONT=1,oo.CULL_BACK=2,oo.BLEND_DISABLE=0,oo.BLEND_ENABLE_ALL=1,oo.BLEND_ENABLE_SEPERATE=2,oo.BLENDPARAM_ZERO=0,oo.BLENDPARAM_ONE=1,oo.BLENDPARAM_SRC_COLOR=768,oo.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,oo.BLENDPARAM_DST_COLOR=774,oo.BLENDPARAM_ONE_MINUS_DST_COLOR=775,oo.BLENDPARAM_SRC_ALPHA=770,oo.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,oo.BLENDPARAM_DST_ALPHA=772,oo.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,oo.BLENDPARAM_SRC_ALPHA_SATURATE=776,oo.BLENDEQUATION_ADD=0,oo.BLENDEQUATION_SUBTRACT=1,oo.BLENDEQUATION_REVERSE_SUBTRACT=2,oo.DEPTHTEST_OFF=0,oo.DEPTHTEST_NEVER=512,oo.DEPTHTEST_LESS=513,oo.DEPTHTEST_EQUAL=514,oo.DEPTHTEST_LEQUAL=515,oo.DEPTHTEST_GREATER=516,oo.DEPTHTEST_NOTEQUAL=517,oo.DEPTHTEST_GEQUAL=518,oo.DEPTHTEST_ALWAYS=519,oo.SHADERDEFINE_ALPHATEST=1,oo.ALPHATESTVALUE=0,op(oo,["shaderDefines",function(){return this.shaderDefines=new ohr}]),oo}(o_),our=function(oo){function or(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,or.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}ov(or,"laya.d3.resource.BaseTexture",o_);var oT=or.prototype;return ox(0,oT,"width",function(){return this._width}),ox(0,oT,"repeat",function(){return this._repeat},function(oo){if(this._repeat!==oo&&(this._repeat=oo,this._source)){var or=ou.mainContext;os.bindTexture(or,this._type,this._source),ol.isPOT(this._width,this._height)&&this._repeat?(or.texParameteri(this._type,10242,10497),or.texParameteri(this._type,10243,10497)):(or.texParameteri(this._type,10242,33071),or.texParameteri(this._type,10243,33071))}}),ox(0,oT,"height",function(){return this._height}),ox(0,oT,"magFifter",function(){return this._magFifter},function(oo){(this._magFifter=oo)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(oo)}),ox(0,oT,"wrapModeV",function(){return this._wrapModeV}),ox(0,oT,"size",function(){return this._size}),ox(0,oT,"wrapModeU",function(){return this._wrapModeU}),ox(0,oT,"mipmap",function(){return this._mipmap},function(oo){this._mipmap=oo,this._mipmap!=oo&&this._conchTexture&&this._conchTexture.setMipMap(oo)}),ox(0,oT,"minFifter",function(){return this._minFifter},function(oo){this._minFifter=oo,this._minFifter!=oo&&this._conchTexture&&this._conchTexture.setMinFifter(oo)}),ox(0,oT,"format",function(){return this._format}),ox(0,oT,"source",function(){return this.activeResource(),this._source}),ox(0,oT,"defaulteTexture",function(){return oIr.grayTexture}),or.WARPMODE_REPEAT=0,or.WARPMODE_CLAMP=1,or}(),osr=function(oo){function or(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,or.__super.call(this),this._boundingBoxCorners=ok(8,null)}ov(or,"laya.d3.resource.models.BaseMesh",o_);var oT=or.prototype;return oT._getPositions=function(){throw new Error("未Override,请重载该属性！")},oT._generateBoundingObject=function(){this._boundingSphere=new oBo(new onr,0),oBo.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new oQo(new onr,new onr),oQo.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},oT.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},oT.getRenderElement=function(oo){throw new Error("未Override,请重载该属性！")},ox(0,oT,"subMeshCount",function(){return this._subMeshCount}),ox(0,oT,"boundingBox",function(){return this._boundingBox}),ox(0,oT,"boundingBoxCorners",function(){return this._boundingBoxCorners}),ox(0,oT,"boundingSphere",function(){return this._boundingSphere}),or}(),ozr=(function(oo){function or(){or.__super.call(this)}ov(or,"laya.d3.component.Script",oyr);var oT=or.prototype;oT.onTriggerEnter=function(oo){},oT.onTriggerExit=function(oo){},oT.onTriggerStay=function(oo){},ox(0,oT,"isSingleton",function(){return or._isSingleton}),or._isSingleton=!1}(),function(oo){function or(oo){this._owner=null,this._sharedMesh=null,or.__super.call(this),this._owner=oo}ov(or,"laya.d3.core.MeshFilter",oo);var oT=or.prototype;return oT._sharedMeshLoaded=function(){this.event("loaded")},oT._destroy=function(){oo.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},ox(0,oT,"sharedMesh",function(){return this._sharedMesh},function(oo){var or=this._sharedMesh;or&&or._removeReference(),(this._sharedMesh=oo)._addReference(),this.event("meshchanged",[this,or,oo]),oo.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),ox(0,oT,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),ox(0,oT,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),ox(0,oT,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),ox(0,oT,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),or}(olr)),omr=function(oo){function or(oo){or.__super.call(this,oo),oo.meshFilter.on("meshchanged",this,this._onMeshChanged)}ov(or,"laya.d3.core.MeshRender",oSr);var oT=or.prototype;return oT._onMeshChanged=function(oo,or,oT){oT.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:oT.once("loaded",this,this._onMeshLoaed)},oT._onMeshLoaed=function(oo,or){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},oT._calculateBoundingSphereByInitSphere=function(oo){var or=NaN,oT=this._owner.transform,ok=oT.scale.elements,oW=Math.abs(ok[0]),oD=Math.abs(ok[1]),on=Math.abs(ok[2]);or=oD<=oW&&on<=oW?oW:on<=oD?oD:on,onr.transformCoordinate(oo.center,oT.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=oo.radius*or},oT._calculateBoundBoxByInitCorners=function(oo){for(var or=this._owner.transform.worldMatrix,oT=0;oT<8;oT++)onr.transformCoordinate(oo[oT],or,oSr._tempBoundBoxCorners[oT]);oQo.createfromPoints(oSr._tempBoundBoxCorners,this._boundingBox)},oT._calculateBoundingSphere=function(){var oo=this._owner.meshFilter.sharedMesh;null==oo||null==oo.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(oo.boundingSphere)},oT._calculateBoundingBox=function(){var oo=this._owner.meshFilter.sharedMesh;null==oo||null==oo.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(oo.boundingBoxCorners)},oT._renderUpdate=function(oo){var or=this._owner.transform;if(or){this._setShaderValueMatrix4x4(0,or.worldMatrix);var oT=this._owner.getProjectionViewWorldMatrix(oo);this._setShaderValueMatrix4x4(1,oT)}else this._setShaderValueMatrix4x4(0,oor.DEFAULT),this._setShaderValueMatrix4x4(1,oo);return oKr.debugMode&&this._renderRenderableBoundBox(),!0},or}(),oCr=function(or){function ok(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,ok.__super.call(this),this._renderState=new oZ,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new oir,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new oro,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new onr(.7,.7,.7),this.ambientColor=new onr(.212,.227,.259),ou.shaderHighPrecision&&this.addShaderDefine(oFr.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}ov(ok,"laya.d3.core.scene.Scene",or);var oo=ok.prototype;return oS.imps(oo,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),oo._setUrl=function(oo){this._url=oo},oo._getGroup=function(){return this._group},oo._setGroup=function(oo){this._group=oo},oo._display=function(){oS.stage._scenes.push(this),oS.stage._scenes.sort(ok._sortScenes);for(var oo=0,or=this._childs.length;oo<or;oo++){var oT=this._childs[oo];oT.active&&oT._activeHierarchy()}},oo._unDisplay=function(){var oo=oS.stage._scenes;oo.splice(oo.indexOf(this),1);for(var or=0,oT=this._childs.length;or<oT;or++){var ok=this._childs[or];ok.active&&ok._inActiveHierarchy()}},oo._addChild3D=function(oo){oo.transform._onWorldTransform(),oo._setBelongScene(this),this.displayedInStage&&oo.active&&oo._activeHierarchy()},oo._removeChild3D=function(oo){oo.transform.parent=null,this.displayedInStage&&oo.active&&oo._inActiveHierarchy(),oo._setUnBelongScene()},oo.initOctree=function(oo,or,oT,ok,oW){void 0===oW&&(oW=6),this.treeSize=new onr(oo,or,oT),this.treeLevel=oW,this.treeRoot=new oQ(this,0),this.treeRoot.init(ok,this.treeSize)},oo._prepareUpdateToRenderState=function(oo,or){or.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,or.scene=this},oo._prepareSceneToRender=function(oo){var or=this._lights.length;if(0<or)for(var oT=0,ok=0;ok<or&&!(this._lights[ok]._prepareToScene(oo)&&++oT>=this._enableLightCount);ok++);},oo._updateChilds=function(oo){for(var or=0,oT=this._childs.length;or<oT;++or)this._childs[or]._update(oo)},oo._preRenderScene=function(oo,or,oT){var ok,oW=or._viewMatrix,oD=or._projectionMatrix,on=or._projectionViewMatrix,oV=0,oL=or.camera;for(oL.useOcclusionCulling?this.treeRoot?oTo.renderObjectCullingOctree(oT,this,oL,oW,oD,on):oTo.renderObjectCulling(oT,this,oL,oW,oD,on):oTo.renderObjectCullingNoBoundFrustum(this,oL,oW,oD,on),oV=0,ok=this._quenes.length;oV<ok;oV++)this._quenes[oV]&&this._quenes[oV]._preRender(or)},oo._clear=function(oo,or){var oT=or._viewport,ok=or.camera,oW=oT.x,oD=ok.renderTargetSize.height-oT.y-oT.height,on=oT.width,oV=oT.height;oo.viewport(oW,oD,on,oV);var oL=256,oU=ok.renderTarget;switch(ok.clearFlag){case 0:var oh=ok.clearColor;if(oh){oo.enable(3089),oo.scissor(oW,oD,on,oV);var op=oh.elements;oo.clearColor(op[0],op[1],op[2],op[3]),oL|=16384}if(oU)switch(oh||(oL=16384),oU.depthStencilFormat){case 33189:oL|=256;break;case 36168:oL|=1024;break;case 34041:oL|=256,oL|=1024}oo.clear(oL),oh&&oo.disable(3089);break;case 1:case 2:if(oU)switch(oL=16384,oU.depthStencilFormat){case 33189:oL|=256;break;case 36168:oL|=1024;break;case 34041:oL|=256,oL|=1024}oo.clear(oL);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},oo._renderScene=function(oo,or){var oT,ok,oW=or.camera,oD=0;for(oD=0;oD<2;oD++)(ok=this._quenes[oD])&&(oW.renderTarget?ok._render(or,!0):ok._render(or,!1));if(1===oW.clearFlag){var on=oW.sky;on&&(os.setCullFace(oo,!1),os.setDepthFunc(oo,515),os.setDepthMask(oo,!1),on._render(or),os.setDepthFunc(oo,513),os.setDepthMask(oo,!0))}for(oD=2,oT=this._quenes.length;oD<oT;oD++)(ok=this._quenes[oD])&&(ok._sortAlpha(or.camera.transform.position),oW.renderTarget?ok._render(or,!0):ok._render(or,!1))},oo._set3DRenderConfig=function(oo){oo.disable(3042),os._blend=!1,oo.blendFunc(770,771),os._sFactor=770,os._dFactor=771,oo.disable(2929),os._depthTest=!1,oo.enable(2884),os._cullFace=!0,oo.depthMask(1),os._depthMask=!0,oo.frontFace(2304),os._frontFace=2304},oo._set2DRenderConfig=function(oo){os.setBlend(oo,!0),os.setBlendFunc(oo,1,771),os.setDepthTest(oo,!1),os.setCullFace(oo,!1),os.setDepthMask(oo,!0),os.setFrontFace(oo,2305),oo.viewport(0,0,oh.width,oh.height)},oo._parseCustomProps=function(oo,or,oT,ok){var oW=ok.customProps.lightmaps,oD=oW.length,on=this._lightmaps;on.length=oD;for(var oV=0;oV<oD;oV++)on[oV]=oK.getRes(or[oW[oV].replace(".exr",".png")]);this.setlightmaps(on);var oL=ok.customProps.ambientColor;oL&&(this.ambientColor=new onr(oL[0],oL[1],oL[2]));var oU=ok.customProps.fogColor;oU&&(this.fogColor=new onr(oU[0],oU[1],oU[2]))},oo._addLight=function(oo){this._lights.indexOf(oo)<0&&this._lights.push(oo)},oo._removeLight=function(oo){var or=this._lights.indexOf(oo);0<=or&&this._lights.splice(or,1)},oo._updateScene=function(){var oo=this._renderState;this._prepareUpdateToRenderState(ou.mainContext,oo),this._updateComponents(oo),this._updateChilds(oo),this._lateUpdateComponents(oo),this._time+=oo.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},oo._updateSceneConch=function(){var oo=this._renderState;this._prepareUpdateToRenderState(ou.mainContext,oo),this._updateComponents(oo),this._lateUpdateComponents(oo),this._prepareSceneToRender(oo);for(var or=0,oT=this._cameraPool.length;or<oT;or++){var ok=this._cameraPool[or];(oo.camera=ok)._prepareCameraToRender()}},oo._preRenderShadow=function(oo,or,oT,ok,oW){this.treeRoot?oTo.renderShadowObjectCullingOctree(this,or,oT,ok,oW):oTo.renderShadowObjectCulling(this,or,oT,ok,oW);for(var oD=0,on=oT.length;oD<on;oD++)oT[oD]&&oT[oD]._preRender(oo)},oo._renderShadowMap=function(oo,or,oT){var ok=this.parallelSplitShadowMaps[0];ok._calcAllLightCameraInfo(oT);var oW,oD,on,oV=ok.PSSMNum;if(this._preRenderShadow(or,ok._lightCulling,ok._shadowQuenes,ok._lightVPMatrix[0],oV),this.addShaderDefine(ovr.SHADERDEFINE_CAST_SHADOW),1<oV)for(var oL=0;oL<oV;oL++)oW=ok.getRenderTarget(oL+1),ok.beginRenderTarget(oL+1),oo.clearColor(1,1,1,1),oo.clear(16640),oo.viewport(0,0,oW.width,oW.height),or.camera=on=ok.getLightCamera(oL),on._prepareCameraToRender(),on._prepareCameraViewProject(on.viewMatrix,on.projectionMatrix),or._projectionViewMatrix=ok._lightVPMatrix[oL+1],(oD=ok._shadowQuenes[oL])._preRender(or),oD._renderShadow(or,!1),ok.endRenderTarget(oL+1);else oW=ok.getRenderTarget(1),ok.beginRenderTarget(1),oo.clearColor(1,1,1,1),oo.clear(16640),oo.viewport(0,0,oW.width,oW.height),or.camera=on=ok.getLightCamera(0),on._prepareCameraToRender(),on._prepareCameraViewProject(on.viewMatrix,on.projectionMatrix),or._projectionViewMatrix=ok._lightVPMatrix[0],(oD=ok._shadowQuenes[0])._preRender(or),oD._renderShadow(or,!0),ok.endRenderTarget(1);this.removeShaderDefine(ovr.SHADERDEFINE_CAST_SHADOW)},oo.addTreeNode=function(oo){this.treeRoot.addTreeNode(oo)},oo.removeTreeNode=function(oo){this.treeSize&&oo._treeNode&&oo._treeNode.removeObject(oo)},oo.setlightmaps=function(oo){this._lightmaps=oo;for(var or=0,oT=this._renderableSprite3Ds.length;or<oT;or++)this._renderableSprite3Ds[or]._render._applyLightMapParams()},oo.getlightmaps=function(){return this._lightmaps},oo.addChildAt=function(oo,or){if(!(oo instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(oo&&oo.__className));if(!oo||this.destroyed||oo===this)return oo;if(oo.zOrder&&this._set$P("hasZorder",!0),0<=or&&or<=this._childs.length){if(oo._parent===this){var oT=this.getChildIndex(oo);this._childs.splice(oT,1),this._childs.splice(or,0,oo),this.conchModel&&(this.conchModel.removeChild(oo.conchModel),this.conchModel.addChildAt(oo.conchModel,or)),this._childChanged()}else oo.parent&&oo.parent.removeChild(oo),this._childs===oU.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(or,0,oo),this.conchModel&&this.conchModel.addChildAt(oo.conchModel,or),(oo.parent=this)._addChild3D(oo);return oo}throw new Error("appendChildAt:The index is out of bounds")},oo.addChild=function(oo){if(!(oo instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!oo||this.destroyed||oo===this)return oo;if(oo.zOrder&&this._set$P("hasZorder",!0),oo._parent===this){var or=this.getChildIndex(oo);or!==this._childs.length-1&&(this._childs.splice(or,1),this._childs.push(oo),this.conchModel&&(this.conchModel.removeChild(oo.conchModel),this.conchModel.addChildAt(oo.conchModel,this._childs.length-1)),this._childChanged())}else oo.parent&&oo.parent.removeChild(oo),this._childs===oU.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(oo),this.conchModel&&this.conchModel.addChildAt(oo.conchModel,this._childs.length-1),(oo.parent=this)._childChanged(),this._addChild3D(oo);return oo},oo.removeChildAt=function(oo){var or=this.getChildAt(oo);return or&&(this._removeChild3D(or),this._childs.splice(oo,1),this.conchModel&&this.conchModel.removeChild(or.conchModel),or.parent=null),or},oo.removeChildren=function(oo,or){if(void 0===oo&&(oo=0),void 0===or&&(or=2147483647),this._childs&&0<this._childs.length){var oT=this._childs;if(0===oo&&oD<=or){var ok=oT;this._childs=oU.ARRAY_EMPTY}else ok=oT.splice(oo,or-oo);for(var oW=0,oD=ok.length;oW<oD;oW++)this._removeChild3D(ok[oW]),ok[oW].parent=null,this.conchModel&&this.conchModel.removeChild(ok[oW].conchModel)}return this},oo.addFrustumCullingObject=function(oo){this.treeRoot?this.addTreeNode(oo):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(oo):this._cullingRenders[this._cullingRendersLength]=oo,oo._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},oo.removeFrustumCullingObject=function(oo){if(this.treeRoot)this.removeTreeNode(oo);else{this._cullingRendersLength--;var or=oo._indexInSceneFrustumCullingObjects;if(or!==this._cullingRendersLength){var oT=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[or]=oT)._indexInSceneFrustumCullingObjects=or,oo._indexInSceneFrustumCullingObjects=-1}}},oo.getRenderQueue=function(oo){return oo<3e3?this._quenes[1]||(this._quenes[1]=new ow(this)):this._quenes[2]||(this._quenes[2]=new ow(this))},oo.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new ow(this)},oo.addShaderDefine=function(oo){this._shaderDefineValue|=oo},oo.removeShaderDefine=function(oo){this._shaderDefineValue&=~oo},oo.addScript=function(oo){return this._addComponent(oo)},oo.getScriptByType=function(oo,or){return void 0===or&&(or=0),this._getComponentByType(oo,or)},oo.getScriptsByType=function(oo,or){this._getComponentsByType(oo,or)},oo.getScriptByIndex=function(oo){return this._getComponentByIndex(oo)},oo.removeScriptByType=function(oo,or){void 0===or&&(or=0),this._removeComponentByType(oo,or)},oo.removeScriptsByType=function(oo){this._removeComponentByType(oo)},oo.removeAllScript=function(){this._removeAllComponent()},oo.render=function(oo,or,oT){(oj._context.ctx._renderKey=0)<this._childs.length&&oo.addRenderObject(this)},oo.renderSubmit=function(){var oo=ou.mainContext,or=this._renderState;this._set3DRenderConfig(oo),this._prepareSceneToRender(this._renderState);var oT,ok=0,oW=0;if(oKr.debugMode||oQ.debugMode)for(ok=0,oW=this._cameraPool.length;ok<oW;ok++)oT=this._cameraPool[ok],oKr._debugPhasorSprite.begin(1,oT),oT.activeInHierarchy&&oT._renderCamera(oo,or,this),oKr._debugPhasorSprite.end();else for(ok=0,oW=this._cameraPool.length;ok<oW;ok++)(oT=this._cameraPool[ok]).activeInHierarchy&&oT._renderCamera(oo,or,this);return this._set2DRenderConfig(oo),1},oo.onAsynLoaded=function(oo,or,oT){var ok=or[0];if("Scene"!==ok.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var oW=or[1];o_r._createNodeByJson(this,ok,this,oW),this.event("hierarchyloaded",[this]),this.__loaded=!0},oo.destroy=function(oo){void 0===oo&&(oo=!0),this.destroyed||(or.prototype.destroy.call(this,oo),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,oK.clearRes(this.url),this.loaded||oKr._cancelLoadByUrl(this.url))},oo.getRenderType=function(){return 0},oo.releaseRender=function(){},oo._addComponent=function(oo){var or,oT=this._componentsMap.indexOf(oo);if(-1===oT)or=[],this._componentsMap.push(oo),this._typeComponentsIndices.push(or);else if(or=this._typeComponentsIndices[oT],this._components[or[0]].isSingleton)throw new Error("无法单实例创建"+oo+"组件，"+oo+"组件已存在！");var ok=oW.getInstance(oo);or.push(this._components.length),this._components.push(ok);return ok._initialize(this),ok},oo._removeComponent=function(oo,or){var oT=this._typeComponentsIndices[oo],ok=oT[or],oW=this._components[ok];this._components.splice(ok,1),oT.splice(or,1),0===oT.length&&(this._typeComponentsIndices.splice(oo,1),this._componentsMap.splice(oo,1));for(var oD=0,on=this._componentsMap.length;oD<on;oD++)for(var oV=(oT=this._typeComponentsIndices[oD]).length-1;0<=oV;oV--){var oL=oT[oV];if(!(ok<oL))break;oT[oV]=--oL}oW._destroy()},oo._getComponentByType=function(oo,or){void 0===or&&(or=0);var oT=this._componentsMap.indexOf(oo);return-1===oT?null:this._components[this._typeComponentsIndices[oT][or]]},oo._getComponentsByType=function(oo,or){var oT=this._componentsMap.indexOf(oo);if(-1!==oT){var ok=this._typeComponentsIndices[oT],oW=ok.length;or.length=oW;for(var oD=0;oD<oW;oD++)or[oD]=this._components[ok[oD]]}else or.length=0},oo._getComponentByIndex=function(oo){return this._components[oo]},oo._removeComponentByType=function(oo,or){void 0===or&&(or=0);var oT=this._componentsMap.indexOf(oo);-1!==oT&&this._removeComponent(oT,or)},oo._removeComponentsByType=function(oo){var or=this._componentsMap.indexOf(oo);if(-1!==or)for(var oT=this._typeComponentsIndices[or],ok=0,oW=oT.length;ok<oW;oT.length<oW?oW--:ok++)this._removeComponent(or,ok)},oo._removeAllComponent=function(){for(var oo=0,or=this._componentsMap.length;oo<or;this._componentsMap.length<or?or--:oo++)this._removeComponentsByType(this._componentsMap[oo])},oo._updateComponents=function(oo){for(var or=0,oT=this._components.length;or<oT;or++){var ok=this._components[or];!ok.started&&(ok._start(oo),ok.started=!0),ok.enable&&ok._update(oo)}},oo._lateUpdateComponents=function(oo){for(var or=0;or<this._components.length;or++){var oT=this._components[or];!oT.started&&(oT._start(oo),oT.started=!0),oT.enable&&oT._lateUpdate(oo)}},oo._preRenderUpdateComponents=function(oo){for(var or=0;or<this._components.length;or++){var oT=this._components[or];!oT.started&&(oT._start(oo),oT.started=!0),oT.enable&&oT._preRenderUpdate(oo)}},oo._postRenderUpdateComponents=function(oo){for(var or=0;or<this._components.length;or++){var oT=this._components[or];!oT.started&&(oT._start(oo),oT.started=!0),oT.enable&&oT._postRenderUpdate(oo)}},ox(0,oo,"_loaded",null,function(oo){this.__loaded=oo}),ox(0,oo,"fogColor",function(){return this._fogColor},function(oo){this._fogColor=oo,this._shaderValues.setValue(0,oo.elements)}),ox(0,oo,"enableFog",function(){return this._enableFog},function(oo){this._enableFog!==oo&&((this._enableFog=oo)?(this.addShaderDefine(oFr.SHADERDEFINE_FOG),this.removeShaderDefine(oFr.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(oFr.SHADERDEFINE_FOG))}),ox(0,oo,"url",function(){return this._url}),ox(0,oo,"loaded",function(){return this.__loaded}),ox(0,oo,"enableDepthFog",function(){return this._enableDepthFog},function(oo){this._enableDepthFog!=oo&&((this._enableDepthFog=oo)?(this.addShaderDefine(oFr.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(oFr.SHADERDEFINE_FOG)):this.removeShaderDefine(oFr.SAHDERDEFINE_DEPTHFOG))}),ox(0,oo,"fogStart",function(){return this._fogStart},function(oo){this._fogStart=oo,this._shaderValues.setValue(1,oo)}),ox(0,oo,"fogRange",function(){return this._fogRange},function(oo){this._fogRange=oo,this._shaderValues.setValue(2,oo)}),ox(0,oo,"ambientColor",function(){return this._ambientColor},function(oo){this._ambientColor=oo,this._shaderValues.setValue(21,oo.elements)}),ox(0,oo,"scene",function(){return this}),ox(0,oo,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),ok._sortScenes=function(oo,or){if(oo.parent!==oS.stage||or.parent!==oS.stage)return oo.parent!==oS.stage&&or.parent!==oS.stage?ok._sortScenes(oo.parent,or.parent):oo.parent===oS.stage?-1:1;var oT=oS.stage._childs;return oT.indexOf(oo)-oT.indexOf(or)},ok.load=function(oo){return oS.loader.create(oo,null,null,ok)},ok.FOGCOLOR=0,ok.FOGSTART=1,ok.FOGRANGE=2,ok.LIGHTDIRECTION=3,ok.LIGHTDIRCOLOR=4,ok.POINTLIGHTPOS=5,ok.POINTLIGHTRANGE=6,ok.POINTLIGHTATTENUATION=7,ok.POINTLIGHTCOLOR=8,ok.SPOTLIGHTPOS=9,ok.SPOTLIGHTDIRECTION=10,ok.SPOTLIGHTSPOT=11,ok.SPOTLIGHTRANGE=12,ok.SPOTLIGHTATTENUATION=13,ok.SPOTLIGHTCOLOR=14,ok.SHADOWDISTANCE=15,ok.SHADOWLIGHTVIEWPROJECT=16,ok.SHADOWMAPPCFOFFSET=17,ok.SHADOWMAPTEXTURE1=18,ok.SHADOWMAPTEXTURE2=19,ok.SHADOWMAPTEXTURE3=20,ok.AMBIENTCOLOR=21,ok.TIME=22,ok}(ob),oXr=function(oo){function or(oo){or.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new oor,this._shaderValues=new oir,this._colliders=[],this._id=++or._uniqueIDCounter,this._transform=new oqr(this),this.name=oo||"Sprite3D-"+or._nameNumberCounter++,this.layer=om.currentCreationLayer,this.active=!0}ov(or,"laya.d3.core.Sprite3D",oHr);var oT=or.prototype;return oS.imps(oT,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),oT._setUrl=function(oo){this._url=oo},oT._getGroup=function(){return this._group},oT._setGroup=function(oo){this._group=oo},oT._addChild3D=function(oo){oo.transform.parent=this.transform,this._hierarchyAnimator&&(!oo._hierarchyAnimator&&oo._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(oo,!0,[oo.name])),this._scene&&(oo._setBelongScene(this._scene),this._activeInHierarchy&&oo._active&&oo._activeHierarchy())},oT._removeChild3D=function(oo){oo.transform.parent=null,this._scene&&(this._activeInHierarchy&&oo._active&&oo._inActiveHierarchy(),oo._setUnBelongScene()),this._hierarchyAnimator&&(oo._hierarchyAnimator==this._hierarchyAnimator&&oo._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(oo,!1,[oo.name]))},oT._parseBaseCustomProps=function(oo){var or=this.transform.localPosition;oo.translate?(or.fromArray(oo.translate),or.x*=100,or.y*=100,or.z*=100):or.elements.fill(0),this.transform.localPosition=or;var oT=this.transform.localRotation;oo.rotation?oT.fromArray(oo.rotation):oT.fromArray([0,0,0,-1]),this.transform.localRotation=oT;var ok=this.transform.localScale;oo.scale?ok.fromArray(oo.scale):ok.elements.fill(1),this.transform.localScale=ok;var oW=oo.layer;null!=oW&&(this.layer=om.getLayerByNumber(oW))},oT._parseCustomComponent=function(oo,or,oT){for(var ok in oT){var oW=oT[ok];switch(ok){case"Animator":var oD=this.addComponent(Animator);if(oW.avatarPath)oD.avatar=oK.getRes(or[oW.avatarPath]);else{var on=oW.avatar;if(on){oD.avatar=oK.getRes(or[on.path]);var oV=on.linkSprites;oV&&oo.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[oD,oV])}}for(var oL=oW.clipPaths,oU=oL.length,oh=0;oh<oU;oh++)oD.addClip(oK.getRes(or[oL[oh]]));oD.clip=oK.getRes(or[oL[0]]);var op=oW.playOnWake;void 0!==op&&(oD.playOnWake=op);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var oi=this.addComponent(SphereCollider);oi.isTrigger=oW.isTrigger;var ov=oi.center;ov.fromArray(oW.center),oi.center=ov,oi.radius=oW.radius;break;case"BoxCollider":var ox=this.addComponent(BoxCollider);ox.isTrigger=oW.isTrigger,ox.center.fromArray(oW.center);var oj=ox.size;oj.fromArray(oW.size),ox.size=oj;break;case"MeshCollider":this.addComponent(MeshCollider)}}},oT._onRootNodeHierarchyLoaded=function(oo,or){for(var oT in or){for(var ok=this,oW=or[oT],oD=0,on=oW.length;oD<on;oD++){var oV=oW[oD];if(""===oV)break;if(!(ok=ok.getChildByName(oV)))break}ok&&oo.linkSprite3DToAvatarNode(oT,ok)}},oT._setHierarchyAnimator=function(oo,or){this._changeHierarchyAnimator(oo);for(var oT=0,ok=this._childs.length;oT<ok;oT++){var oW=this._childs[oT];oW._hierarchyAnimator==or&&oW._setHierarchyAnimator(oo,or)}},oT._clearHierarchyAnimator=function(oo,or){this._changeHierarchyAnimator(or);for(var oT=0,ok=this._childs.length;oT<ok;oT++){var oW=this._childs[oT];oW._hierarchyAnimator==oo&&oW._clearHierarchyAnimator(oo,or)}},oT._getAnimatorToLinkSprite3D=function(oo,or,oT){var ok=this.getComponentByType(Animator);if(ok&&(ok.avatar?ok.avatar._version||oo._setAnimatorToLinkAvatar(ok,or):oo._setAnimatorToLinkSprite3DNoAvatar(ok,or,oT)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){oT.unshift(this._parent.name);var oW=this._parent;oW._hierarchyAnimator&&oW._getAnimatorToLinkSprite3D(oo,or,oT)}},oT._setAnimatorToLinkSprite3DNoAvatar=function(oo,or,oT){var ok=0,oW=0;for(ok=0,oW=oo.getClipCount();ok<oW;ok++)oo._handleSpriteOwnersBySprite(ok,or,oT,this);for(ok=0,oW=this._childs.length;ok<oW;ok++){var oD=this._childs[ok],on=oT.length;oT.push(oD.name),oD._setAnimatorToLinkSprite3DNoAvatar(oo,or,oT),oT.splice(on,1)}},oT._changeHierarchyAnimator=function(oo){this._hierarchyAnimator=oo},oT._isLinkSpriteToAnimationNode=function(oo,or,oT){var ok=oo._avatarNodes.indexOf(or),oW=oo._cacheSpriteToNodesMap;if(oT)this._transform.dummy=or.transform,oo._cacheNodesToSpriteMap[ok]=oW.length,oW.push(ok);else{this._transform.dummy=null;var oD=oo._cacheNodesToSpriteMap[ok];oo._cacheNodesToSpriteMap[ok]=null,oW.splice(oD,1)}},oT._setBelongScene=function(oo){this._scene=oo;for(var or=0,oT=this._childs.length;or<oT;or++)this._childs[or]._setBelongScene(oo)},oT._setUnBelongScene=function(){this._scene=null;for(var oo=0,or=this._childs.length;oo<or;oo++)this._childs[oo]._setUnBelongScene()},oT._activeHierarchy=function(){var oo=0,or=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),oo=0,or=this._colliders.length;oo<or;oo++)this._layer._addCollider(this._colliders[oo]);for(this.event("activeinhierarchychanged",!0),oo=0,or=this._childs.length;oo<or;oo++){var oT=this._childs[oo];oT._active&&oT._activeHierarchy()}},oT._inActiveHierarchy=function(){var oo=0,or=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),oo=0,or=this._colliders.length;oo<or;oo++){var oT=this._colliders[oo];oT._clearCollsionMap(),this._layer._removeCollider(oT)}for(this.event("activeinhierarchychanged",!1),oo=0,or=this._childs.length;oo<or;oo++){var ok=this._childs[oo];ok._active&&ok._inActiveHierarchy()}},oT.addComponent=function(oo){var or,oT=this._componentsMap.indexOf(oo);if(-1===oT)or=[],this._componentsMap.push(oo),this._typeComponentsIndices.push(or);else if(or=this._typeComponentsIndices[oT],this._components[or[0]].isSingleton)throw new Error("无法单实例创建"+oo+"组件，"+oo+"组件已存在！");var ok=oW.getInstance(oo);return or.push(this._components.length),this._components.push(ok),ok instanceof laya.d3.component.Script&&this._scripts.push(ok),ok._initialize(this),ok},oT._removeComponent=function(oo,or){var oT,ok=0,oW=this._typeComponentsIndices[oo],oD=oW[or],on=this._components[oD];for(on instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(on),1),oW.splice(or,1),0===oW.length&&(this._typeComponentsIndices.splice(oo,1),this._componentsMap.splice(oo,1)),ok=0,oT=this._componentsMap.length;ok<oT;ok++)for(var oV=(oW=this._typeComponentsIndices[ok]).length-1;0<=oV;oV--){var oL=oW[oV];if(!(oD<oL))break;oW[oV]=--oL}on._destroy()},oT._clearSelfRenderObjects=function(){},oT._addSelfRenderObjects=function(){},oT._parseCustomProps=function(oo,or,oT,ok){},oT._updateChilds=function(oo){var or=this._childs.length;if(0!==or)for(var oT=0;oT<or;++oT)this._childs[oT]._update(oo)},oT._getSortID=function(oo,or){return 1e3*or.id+oo._getVertexBuffer().vertexDeclaration.id},oT._update=function(oo){(oo.owner=this)._activeInHierarchy&&(this._updateComponents(oo),this._lateUpdateComponents(oo),oF.spriteCount++,this._childs.length&&this._updateChilds(oo))},oT.getProjectionViewWorldMatrix=function(oo){return oor.multiply(oo,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},oT.loadHierarchy=function(oo){this.addChild(laya.d3.core.Sprite3D.load(oo))},oT.addChildAt=function(oo,or){if(!(oo instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!oo||this.destroyed||oo===this)return oo;if(oo.zOrder&&this._set$P("hasZorder",!0),0<=or&&or<=this._childs.length){if(oo._parent===this){var oT=this.getChildIndex(oo);this._childs.splice(oT,1),this._childs.splice(or,0,oo),this.conchModel&&(this.conchModel.removeChild(oo.conchModel),this.conchModel.addChildAt(oo.conchModel,or)),this._childChanged()}else oo.parent&&oo.parent.removeChild(oo),this._childs===oU.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(or,0,oo),this.conchModel&&this.conchModel.addChildAt(oo.conchModel,or),(oo.parent=this)._addChild3D(oo);return oo}throw new Error("appendChildAt:The index is out of bounds")},oT.addChild=function(oo){if(!(oo instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!oo||this.destroyed||oo===this)return oo;if(oo.zOrder&&this._set$P("hasZorder",!0),oo._parent===this){var or=this.getChildIndex(oo);or!==this._childs.length-1&&(this._childs.splice(or,1),this._childs.push(oo),this.conchModel&&(this.conchModel.removeChild(oo.conchModel),this.conchModel.addChildAt(oo.conchModel,this._childs.length-1)),this._childChanged())}else oo.parent&&oo.parent.removeChild(oo),this._childs===oU.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(oo),this.conchModel&&this.conchModel.addChildAt(oo.conchModel,this._childs.length-1),(oo.parent=this)._childChanged(),this._addChild3D(oo);return oo},oT.removeChildAt=function(oo){var or=this.getChildAt(oo);return or&&(this._removeChild3D(or),this._childs.splice(oo,1),this.conchModel&&this.conchModel.removeChild(or.conchModel),or.parent=null),or},oT.removeChildren=function(oo,or){if(void 0===oo&&(oo=0),void 0===or&&(or=2147483647),this._childs&&0<this._childs.length){var oT=this._childs;if(0===oo&&oD<=or){var ok=oT;this._childs=oU.ARRAY_EMPTY}else ok=oT.splice(oo,or-oo);for(var oW=0,oD=ok.length;oW<oD;oW++)this._removeChild3D(ok[oW]),ok[oW].parent=null,this.conchModel&&this.conchModel.removeChild(ok[oW].conchModel)}return this},oT.onAsynLoaded=function(oo,or,oT){var ok=or[0];if("Sprite3D"!==ok.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var oW=or[1];o_r._createNodeByJson(this,ok,this,oW),this.event("hierarchyloaded",[this]),this.__loaded=!0},oT.cloneTo=function(oo){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var or=oo;or.name=this.name,or._destroyed=this._destroyed,or.timer=this.timer,or._$P=this._$P,or.active=this._active;var oT=or.transform.localPosition;this.transform.localPosition.cloneTo(oT),or.transform.localPosition=oT;var ok=or.transform.localRotation;this.transform.localRotation.cloneTo(ok),or.transform.localRotation=ok;var oW=or.transform.localScale;this.transform.localScale.cloneTo(oW),or.transform.localScale=oW,or.isStatic=this.isStatic;var oD=0,on=0;for(oD=0,on=this._componentsMap.length;oD<on;oD++){var oV=or.addComponent(this._componentsMap[oD]);this._components[oD]._cloneTo(oV)}for(oD=0,on=this._childs.length;oD<on;oD++)or.addChild(this._childs[oD].clone());var oL=or.getComponentByType(Animator);if(oL){var oU=oL._linkSpritesData;if(oU)for(var oh in oU){for(var op=oU[oh],oi=or,ov=0,ox=op.length;ov<ox&&(oi=oi.getChildByName(op[ov]));ov++);if(oi){var oj=oL._avatarNodeMap[oh];oi._isLinkSpriteToAnimationNode(oL,oj,!0)}}}},oT.clone=function(){var oo=new this.constructor;return this.cloneTo(oo),oo},oT.destroy=function(oo){if(void 0===oo&&(oo=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,oo);var or,oT=0;for(oT=0,or=this._components.length;oT<or;oT++)this._components[oT]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,oK.clearRes(this.url),this.loaded||oKr._cancelLoadByUrl(this.url)}},oT._handleSpriteToAvatar=function(oo,or){oo._avatarNodes;var oT=oo._avatarNodeMap[this.name];oT&&oT.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(oo,oT,or)},oT._setAnimatorToLinkAvatar=function(oo,or){this._handleSpriteToAvatar(oo,or);for(var oT=0,ok=this._childs.length;oT<ok;oT++){this._childs[oT]._setAnimatorToLinkAvatar(oo,or)}},ox(0,oT,"activeInHierarchy",function(){return this._activeInHierarchy}),ox(0,oT,"_loaded",null,function(oo){this.__loaded=oo}),ox(0,oT,"active",function(){return this._active},function(oo){this._active!==oo&&(this._active=oo,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(oo?this._activeHierarchy():this._inActiveHierarchy()))}),ox(0,oT,"componentsCount",function(){return this._components.length}),ox(0,oT,"loaded",function(){return this.__loaded}),ox(0,oT,"id",function(){return this._id}),ox(0,oT,"url",function(){return this._url}),ox(0,oT,"layer",function(){return this._layer},function(oo){if(this._layer!==oo){if(!oo)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var or=0,oT=this._colliders.length;if(this._layer)for(or=0;or<oT;or++)this._layer._removeCollider(this._colliders[or]);for(or=0;or<oT;or++)oo._addCollider(this._colliders[or])}this._layer=oo,this.event("layerchanged",oo)}}),ox(0,oT,"scene",function(){return this._scene}),ox(0,oT,"transform",function(){return this._transform}),or.instantiate=function(oo,or,oT,ok,oW){void 0===oT&&(oT=!0);var oD=oo.clone();or&&or.addChild(oD);var on=oD.transform;if(oT){var oV=on.worldMatrix;oo.transform.worldMatrix.cloneTo(oV),on.worldMatrix=oV}else ok&&(on.position=ok),oW&&(on.rotation=oW);return oD},or.load=function(oo){return oS.loader.create(oo,null,null,or)},or.WORLDMATRIX=0,or.MVPMATRIX=1,or._uniqueIDCounter=0,or._nameNumberCounter=0,or}(),oOr=function(oo){function oh(oo,or,oT,ok,oW,oD,on,oV,oL,oU){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],oh.__super.call(this),!oo||!or)throw"Shader Error";this._id=++oh._count,this._vs=oo,this._ps=or,this._attributeMap=oT,this._sceneUniformMap=ok,this._cameraUniformMap=oW,this._spriteUniformMap=oD,this._materialUniformMap=on,this._renderElementUniformMap=oV,this._precompile=oL,this._define=oU,this._precompile&&oh.extCompileObj&&oh.extCompileFunc?oh.extCompileFunc.call(oh.extCompileObj,oo,or,oU):this.recreateResource()}ov(oh,"laya.d3.shader.Shader3D",oT);var or=oh.prototype;return or.recreateResource=function(){oz.now();this._compile(),this.completeCreate(),this.memorySize=0},or.disposeResource=function(){ou.mainContext.deleteShader(this._vshader),ou.mainContext.deleteShader(this._pshader),ou.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},or._compile=function(){if(!ou.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var oo=[this._vs,this._ps],or=ou.mainContext;if(this._program=or.createProgram(),this._vshader=oh._createShader(or,oo[0],35633),this._pshader=oh._createShader(or,oo[1],35632),or.attachShader(this._program,this._vshader),or.attachShader(this._program,this._pshader),or.linkProgram(this._program),!oj.isConchApp&&oFr.debugMode&&!or.getProgramParameter(this._program,35714))throw or.getProgramInfoLog(this._program);var oT,ok=0,oW=0,oD=0;for(oD=oj.isConchApp?or.getProgramParameterEx(this._vs,this._ps,"",35721):or.getProgramParameter(this._program,35721),ok=0;ok<oD;ok++){var on=null;oT={vartype:"attribute",ivartype:0,attrib:on=oj.isConchApp?or.getActiveAttribEx(this._vs,this._ps,"",ok):or.getActiveAttrib(this._program,ok),location:or.getAttribLocation(this._program,on.name),name:on.name,type:on.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(oT)}var oV=0;for(oV=oj.isConchApp?or.getProgramParameterEx(this._vs,this._ps,"",35718):or.getProgramParameter(this._program,35718),ok=0;ok<oV;ok++){var oL=null;oL=oj.isConchApp?or.getActiveUniformEx(this._vs,this._ps,"",ok):or.getActiveUniform(this._program,ok),0<(oT={vartype:"uniform",ivartype:1,attrib:on,location:or.getUniformLocation(this._program,oL.name),name:oL.name,type:oL.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(oT.name=oT.name.substr(0,oT.name.length-3),oT.isArray=!0,oT.location=or.getUniformLocation(this._program,oT.name)),this._uniformParams.push(oT)}for(ok=0,oW=this._attributeParams.length;ok<oW;ok++)(oT=this._attributeParams[ok]).indexOfParams=ok,oT.index=1,oT.value=[oT.location,null],oT.codename=oT.name,oT.name=null!=this._attributeMap[oT.codename]?this._attributeMap[oT.codename]:oT.codename,this._attributeParamsMap.push(oT.name),this._attributeParamsMap.push(oT),oT._this=this,oT.uploadedValue=[],oT.fun=this._attribute;for(ok=0,oW=this._uniformParams.length;ok<oW;ok++)switch((oT=this._uniformParams[ok]).indexOfParams=ok,oT.index=1,oT.value=[oT.location,null],oT.codename=oT.name,null!=this._sceneUniformMap[oT.codename]?(oT.name=this._sceneUniformMap[oT.codename],this._sceneUniformParamsMap.push(oT.name),this._sceneUniformParamsMap.push(oT)):null!=this._cameraUniformMap[oT.codename]?(oT.name=this._cameraUniformMap[oT.codename],this._cameraUniformParamsMap.push(oT.name),this._cameraUniformParamsMap.push(oT)):null!=this._spriteUniformMap[oT.codename]?(oT.name=this._spriteUniformMap[oT.codename],this._spriteUniformParamsMap.push(oT.name),this._spriteUniformParamsMap.push(oT)):null!=this._materialUniformMap[oT.codename]?(oT.name=this._materialUniformMap[oT.codename],this._materialUniformParamsMap.push(oT.name),this._materialUniformParamsMap.push(oT)):null!=this._renderElementUniformMap[oT.codename]?(oT.name=this._renderElementUniformMap[oT.codename],this._renderElementUniformParamsMap.push(oT.name),this._renderElementUniformParamsMap.push(oT)):console.log("Shader:can't find uinform name:"+oT.codename+" in shader file."),oT._this=this,oT.uploadedValue=[],oT.type){case 5124:oT.fun=oT.isArray?this._uniform1iv:this._uniform1i;break;case 5126:oT.fun=oT.isArray?this._uniform1fv:this._uniform1f;break;case 35664:oT.fun=oT.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:oT.fun=oT.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:oT.fun=oT.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:oT.fun=this._uniform_sampler2D;break;case 35680:oT.fun=this._uniform_samplerCube;break;case 35676:oT.fun=this._uniformMatrix4fv;break;case 35670:oT.fun=this._uniform1i;break;case 35674:oT.fun=this._uinformMatrix2fv;break;case 35675:oT.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},or._attribute=function(oo,or){var oT=ou.mainContext,ok=oV._enableAtributes,oW=oo.location;return ok[oW]||oT.enableVertexAttribArray(oW),oT.vertexAttribPointer(oW,or[0],or[1],or[2],or[3],or[4]),ok[oW]=oV._bindVertexBuffer,1},or._uniform1f=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or?(ou.mainContext.uniform1f(oo.location,oT[0]=or),1):0},or._uniform1fv=function(oo,or){if(or.length<4){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]||oT[2]!==or[2]||oT[3]!==or[3]?(ou.mainContext.uniform1fv(oo.location,or),oT[0]=or[0],oT[1]=or[1],oT[2]=or[2],oT[3]=or[3],1):0}return ou.mainContext.uniform1fv(oo.location,or),1},or._uniform_vec2=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]?(ou.mainContext.uniform2f(oo.location,oT[0]=or[0],oT[1]=or[1]),1):0},or._uniform_vec2v=function(oo,or){if(or.length<2){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]||oT[2]!==or[2]||oT[3]!==or[3]?(ou.mainContext.uniform2fv(oo.location,or),oT[0]=or[0],oT[1]=or[1],oT[2]=or[2],oT[3]=or[3],1):0}return ou.mainContext.uniform2fv(oo.location,or),1},or._uniform_vec3=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]||oT[2]!==or[2]?(ou.mainContext.uniform3f(oo.location,oT[0]=or[0],oT[1]=or[1],oT[2]=or[2]),1):0},or._uniform_vec3v=function(oo,or){return ou.mainContext.uniform3fv(oo.location,or),1},or._uniform_vec4=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]||oT[2]!==or[2]||oT[3]!==or[3]?(ou.mainContext.uniform4f(oo.location,oT[0]=or[0],oT[1]=or[1],oT[2]=or[2],oT[3]=or[3]),1):0},or._uniform_vec4v=function(oo,or){return ou.mainContext.uniform4fv(oo.location,or),1},or._uniformMatrix2fv=function(oo,or){return ou.mainContext.uniformMatrix2fv(oo.location,!1,or),1},or._uniformMatrix3fv=function(oo,or){return ou.mainContext.uniformMatrix3fv(oo.location,!1,or),1},or._uniformMatrix4fv=function(oo,or){return ou.mainContext.uniformMatrix4fv(oo.location,!1,or),1},or._uinformMatrix2fv=function(oo,or){return ou.mainContext.uniformMatrix2fv(oo.location,!1,or),1},or._uinformMatrix3fv=function(oo,or){return ou.mainContext.uniformMatrix3fv(oo.location,!1,or),1},or._uniform1i=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or?(ou.mainContext.uniform1i(oo.location,oT[0]=or),1):0},or._uniform1iv=function(oo,or){return ou.mainContext.uniform1iv(oo.location,or),1},or._uniform_ivec2=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]?(ou.mainContext.uniform2i(oo.location,oT[0]=or[0],oT[1]=or[1]),1):0},or._uniform_ivec2v=function(oo,or){return ou.mainContext.uniform2iv(oo.location,or),1},or._uniform_vec3i=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]||oT[2]!==or[2]?(ou.mainContext.uniform3i(oo.location,oT[0]=or[0],oT[1]=or[1],oT[2]=or[2]),1):0},or._uniform_vec3vi=function(oo,or){return ou.mainContext.uniform3iv(oo.location,or),1},or._uniform_vec4i=function(oo,or){var oT=oo.uploadedValue;return oT[0]!==or[0]||oT[1]!==or[1]||oT[2]!==or[2]||oT[3]!==or[3]?(ou.mainContext.uniform4i(oo.location,oT[0]=or[0],oT[1]=or[1],oT[2]=or[2],oT[3]=or[3]),1):0},or._uniform_vec4vi=function(oo,or){return ou.mainContext.uniform4iv(oo.location,or),1},or._uniform_sampler2D=function(oo,or){var oT=or.source||or.defaulteTexture.source,ok=ou.mainContext,oW=oo.uploadedValue;if(null!=oW[0])return ok.activeTexture(oh._TEXTURES[oW[0]]),oT&&os.bindTexture(ok,3553,oT),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return oW[0]=this._curActTexIndex,ok.uniform1i(oo.location,this._curActTexIndex),ok.activeTexture(oh._TEXTURES[this._curActTexIndex]),oT&&os.bindTexture(ok,3553,oT),this._curActTexIndex++,1},or._uniform_samplerCube=function(oo,or){var oT=or.source||or.defaulteTexture.source,ok=ou.mainContext,oW=oo.uploadedValue;if(null!=oW[0])return ok.activeTexture(oh._TEXTURES[oW[0]]),oT?os.bindTexture(ok,34067,oT):os.bindTexture(ok,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return oW[0]=this._curActTexIndex,ok.uniform1i(oo.location,this._curActTexIndex),ok.activeTexture(oh._TEXTURES[this._curActTexIndex]),oT?os.bindTexture(ok,34067,oT):os.bindTexture(ok,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},or._noSetValue=function(oo){console.log("no....:"+oo.name)},or.bind=function(){return oT.activeShader=this,(oT.bindShader=this).activeResource(),os.UseProgram(this._program)},or.uploadAttributes=function(oo,or){for(var oT,ok,oW=0,oD=0,on=this._attributeParamsMap.length;oD<on;oD+=2)ok=this._attributeParamsMap[oD+1],null!=(oT=oo[this._attributeParamsMap[oD]])&&(or&&or[ok.name]&&or[ok.name].bind(),oW+=ok.fun.call(this,ok,oT));oF.shaderCall+=oW},or.uploadAttributesX=function(oo,or){for(var oT,ok,oW=0,oD=0,on=this._attributeParamsMap.length;oD<on;oD+=2)ok=this._attributeParamsMap[oD+1],null!=(oT=oo[this._attributeParamsMap[oD]])&&(or._bind(),oW+=ok.fun.call(this,ok,oT));oF.shaderCall+=oW},or.uploadSceneUniforms=function(oo){for(var or,oT,ok=0,oW=0,oD=this._sceneUniformParamsMap.length;oW<oD;oW+=2)oT=this._sceneUniformParamsMap[oW+1],null!=(or=oo[this._sceneUniformParamsMap[oW]])&&(ok+=oT.fun.call(this,oT,or));oF.shaderCall+=ok},or.uploadCameraUniforms=function(oo){for(var or,oT,ok=0,oW=0,oD=this._cameraUniformParamsMap.length;oW<oD;oW+=2)oT=this._cameraUniformParamsMap[oW+1],null!=(or=oo[this._cameraUniformParamsMap[oW]])&&(ok+=oT.fun.call(this,oT,or));oF.shaderCall+=ok},or.uploadSpriteUniforms=function(oo){for(var or,oT,ok=0,oW=0,oD=this._spriteUniformParamsMap.length;oW<oD;oW+=2)oT=this._spriteUniformParamsMap[oW+1],null!=(or=oo[this._spriteUniformParamsMap[oW]])&&(ok+=oT.fun.call(this,oT,or));oF.shaderCall+=ok},or.uploadMaterialUniforms=function(oo){for(var or,oT,ok=0,oW=0,oD=this._materialUniformParamsMap.length;oW<oD;oW+=2)oT=this._materialUniformParamsMap[oW+1],null!=(or=oo[this._materialUniformParamsMap[oW]])&&(ok+=oT.fun.call(this,oT,or));oF.shaderCall+=ok},or.uploadRenderElementUniforms=function(oo){for(var or,oT,ok=0,oW=0,oD=this._renderElementUniformParamsMap.length;oW<oD;oW+=2)oT=this._renderElementUniformParamsMap[oW+1],null!=(or=oo[this._renderElementUniformParamsMap[oW]])&&(ok+=oT.fun.call(this,oT,or));oF.shaderCall+=ok},oh.create=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){return new oh(oo,or,oT,ok,oW,oD,on,oV,oL,oU)},oh.addInclude=function(oo,or){oy.addInclude(oo,or)},oh._createShader=function(oo,or,oT){var ok=oo.createShader(oT);if(oo.shaderSource(ok,or),oo.compileShader(ok),oFr.debugMode&&!oo.getShaderParameter(ok,35713))throw oo.getShaderInfoLog(ok);return ok},oh.PERIOD_RENDERELEMENT=0,oh.PERIOD_MATERIAL=1,oh.PERIOD_SPRITE=2,oh.PERIOD_CAMERA=3,oh.PERIOD_SCENE=4,oh._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],oh._count=0,oh._preCompile=!1,oh.extCompileFunc=null,oh.extCompileObj=null,op(oh,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new oP}]),oh}(),oMr=function(oV){function oL(){this._transformUV=null,oL.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new onr(.6,.6,.6)),this._setColor(10,new onr(1,1,1)),this._setColor(11,new oVr(1,1,1,8)),this._setColor(12,new onr(1,1,1)),this._setColor(7,new oVr(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new oVr(1,1,0,0)),this.renderMode=1}ov(oL,"laya.d3.core.material.StandardMaterial",oV);var oo=oL.prototype;return oo.disableLight=function(){this._addDisablePublicShaderDefine(oFr.SHADERDEFINE_POINTLIGHT|oFr.SHADERDEFINE_SPOTLIGHT|oFr.SHADERDEFINE_DIRECTIONLIGHT)},oo.disableFog=function(){this._addDisablePublicShaderDefine(oFr.SHADERDEFINE_FOG)},oo.onAsynLoaded=function(oo,or,oT){var ok=or[0];if(ok.version)oV.prototype.onAsynLoaded.call(this,oo,or,oT);else{var oW=or[1],oD=ok.props;for(var on in oD)this[on]=oD[on];oL._parseStandardMaterial(oW,this,ok),this._endLoaded()}},oo.cloneTo=function(oo){oV.prototype.cloneTo.call(this,oo);var or=oo;this._transformUV&&(or._transformUV=this._transformUV.clone())},ox(0,oo,"ambientColor",function(){return this._getColor(9)},function(oo){this._setColor(9,oo)}),ox(0,oo,"ambientTexture",function(){return this._getTexture(5)},function(oo){oo?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,oo)}),ox(0,oo,"renderMode",null,function(oo){switch(oo){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(oL.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(oo)}),ox(0,oo,"reflectColor",function(){return this._getColor(12)},function(oo){this._setColor(12,oo)}),ox(0,oo,"tilingOffset",function(){return this._getColor(15)},function(oo){if(oo){var or=oo.elements;1!=or[0]||1!=or[1]||0!=or[2]||0!=or[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,oo)}),ox(0,oo,"albedo",function(){return this._getColor(7)},function(oo){this._setColor(7,oo)}),ox(0,oo,"diffuseColor",function(){return this._getColor(10)},function(oo){this._setColor(10,oo)}),ox(0,oo,"albedoColor",function(){return this._getColor(7)},function(oo){this._setColor(7,oo)}),ox(0,oo,"specularColor",function(){return this._getColor(11)},function(oo){this._setColor(11,oo)}),ox(0,oo,"diffuseTexture",function(){return this._getTexture(1)},function(oo){oo?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,oo)}),ox(0,oo,"normalTexture",function(){return this._getTexture(2)},function(oo){oo?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,oo)}),ox(0,oo,"specularTexture",function(){return this._getTexture(3)},function(oo){oo?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,oo)}),ox(0,oo,"emissiveTexture",function(){return this._getTexture(4)},function(oo){oo?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,oo)}),ox(0,oo,"reflectTexture",function(){return this._getTexture(6)},function(oo){oo?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,oo)}),ox(0,oo,"transformUV",function(){return this._transformUV},function(oo){this._transformUV=oo,this._setMatrix4x4(13,oo.matrix),oo?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,oo.matrix.elements,0)}),oL.__init__=function(){oL.SHADERDEFINE_DIFFUSEMAP=oL.shaderDefines.registerDefine("DIFFUSEMAP"),oL.SHADERDEFINE_NORMALMAP=oL.shaderDefines.registerDefine("NORMALMAP"),oL.SHADERDEFINE_SPECULARMAP=oL.shaderDefines.registerDefine("SPECULARMAP"),oL.SHADERDEFINE_EMISSIVEMAP=oL.shaderDefines.registerDefine("EMISSIVEMAP"),oL.SHADERDEFINE_AMBIENTMAP=oL.shaderDefines.registerDefine("AMBIENTMAP"),oL.SHADERDEFINE_REFLECTMAP=oL.shaderDefines.registerDefine("REFLECTMAP"),oL.SHADERDEFINE_UVTRANSFORM=oL.shaderDefines.registerDefine("UVTRANSFORM"),oL.SHADERDEFINE_TILINGOFFSET=oL.shaderDefines.registerDefine("TILINGOFFSET"),oL.SHADERDEFINE_ADDTIVEFOG=oL.shaderDefines.registerDefine("ADDTIVEFOG")},oL.load=function(oo){return oS.loader.create(oo,null,null,oL)},oL._parseStandardMaterial=function(oo,or,oT){var ok=oT.customProps,oW=ok.ambientColor;or.ambientColor=new onr(oW[0],oW[1],oW[2]);var oD=ok.diffuseColor;or.diffuseColor=new onr(oD[0],oD[1],oD[2]);var on=ok.specularColor;or.specularColor=new oVr(on[0],on[1],on[2],on[3]);var oV=ok.reflectColor;or.reflectColor=new onr(oV[0],oV[1],oV[2]);var oL=ok.albedoColor;oL&&(or.albedo=new oVr(oL[0],oL[1],oL[2],oL[3]));var oU=ok.diffuseTexture.texture2D;oU&&(or.diffuseTexture=oK.getRes(oo[oU]));var oh=ok.normalTexture.texture2D;oh&&(or.normalTexture=oK.getRes(oo[oh]));var op=ok.specularTexture.texture2D;op&&(or.specularTexture=oK.getRes(oo[op]));var oi=ok.emissiveTexture.texture2D;oi&&(or.emissiveTexture=oK.getRes(oo[oi]));var ov=ok.ambientTexture.texture2D;ov&&(or.ambientTexture=oK.getRes(oo[ov]));var ox=ok.reflectTexture.texture2D;ox&&(or.reflectTexture=oK.getRes(oo[ox]))},oL.RENDERMODE_OPAQUE=1,oL.RENDERMODE_OPAQUEDOUBLEFACE=2,oL.RENDERMODE_CUTOUT=3,oL.RENDERMODE_CUTOUTDOUBLEFACE=4,oL.RENDERMODE_TRANSPARENT=13,oL.RENDERMODE_TRANSPARENTDOUBLEFACE=14,oL.RENDERMODE_ADDTIVE=15,oL.RENDERMODE_ADDTIVEDOUBLEFACE=16,oL.RENDERMODE_DEPTHREAD_TRANSPARENT=5,oL.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,oL.RENDERMODE_DEPTHREAD_ADDTIVE=7,oL.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,oL.RENDERMODE_NONDEPTH_TRANSPARENT=9,oL.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,oL.RENDERMODE_NONDEPTH_ADDTIVE=11,oL.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,oL.SHADERDEFINE_DIFFUSEMAP=0,oL.SHADERDEFINE_NORMALMAP=0,oL.SHADERDEFINE_SPECULARMAP=0,oL.SHADERDEFINE_EMISSIVEMAP=0,oL.SHADERDEFINE_AMBIENTMAP=0,oL.SHADERDEFINE_REFLECTMAP=0,oL.SHADERDEFINE_UVTRANSFORM=0,oL.SHADERDEFINE_TILINGOFFSET=0,oL.SHADERDEFINE_ADDTIVEFOG=0,oL.DIFFUSETEXTURE=1,oL.NORMALTEXTURE=2,oL.SPECULARTEXTURE=3,oL.EMISSIVETEXTURE=4,oL.AMBIENTTEXTURE=5,oL.REFLECTTEXTURE=6,oL.ALBEDO=7,oL.UVANIAGE=8,oL.MATERIALAMBIENT=9,oL.MATERIALDIFFUSE=10,oL.MATERIALSPECULAR=11,oL.MATERIALREFLECT=12,oL.UVMATRIX=13,oL.UVAGE=14,oL.TILINGOFFSET=15,op(oL,["defaultMaterial",function(){var oo=new oL;return oo.lock=!0,this.defaultMaterial=oo},"shaderDefines",function(){return this.shaderDefines=new ohr(oRr.shaderDefines)}]),oL}(oRr),ocr=function(oo){function on(oo,or,oT,ok,oW){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===oT&&(oT=35044),void 0===ok&&(ok=!1),on.__super.call(this),this._indexType=oo,this._indexCount=or,this._bufferUsage=oT,this._bufferType=34963,this._canRead=ok;var oD;if("ushort"==oo)this._indexTypeByteCount=2;else{if("ubyte"!=oo)throw new Error("unidentification index type.");this._indexTypeByteCount=1}oD=this._indexTypeByteCount*or,this._byteLength=oD,this._bind(),oV._gl.bufferData(this._bufferType,oD,this._bufferUsage),this.uri=oW,ok?("ushort"==oo?this._buffer=new Uint16Array(or):"ubyte"==oo&&(this._buffer=new Uint8Array(or)),this.memorySize=2*oD):this.memorySize=oD}ov(on,"laya.d3.graphics.IndexBuffer3D",oo);var or=on.prototype;return or.setData=function(oo,or,oT,ok){void 0===or&&(or=0),void 0===oT&&(oT=0),void 0===ok&&(ok=4294967295);var oW=0;if("ushort"==this._indexType?(oW=2,0===oT&&4294967295===ok||(oo=new Uint16Array(oo.buffer,oT*oW,ok))):"ubyte"==this._indexType&&(oW=1,0===oT&&4294967295===ok||(oo=new Uint8Array(oo.buffer,oT*oW,ok))),this._bind(),oV._gl.bufferSubData(this._bufferType,or*oW,oo),this._canRead)if(0!==or||0!==oT||4294967295!==ok){var oD=this._buffer.length-or;oD<ok&&(ok=oD);for(var on=0;on<ok;on++)this._buffer[or+on]=oo[on]}else this._buffer=oo},or.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},or.disposeResource=function(){oo.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},ox(0,or,"indexType",function(){return this._indexType}),ox(0,or,"indexTypeByteCount",function(){return this._indexTypeByteCount}),ox(0,or,"indexCount",function(){return this._indexCount}),ox(0,or,"canRead",function(){return this._canRead}),on.INDEXTYPE_UBYTE="ubyte",on.INDEXTYPE_USHORT="ushort",on.create=function(oo,or,oT,ok,oW){return void 0===oT&&(oT=35044),void 0===ok&&(ok=!1),new on(oo,or,oT,ok,oW)},on}(oV),oer=function(oD){function on(oo,or,oT,ok,oW){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===ok&&(ok=!1),on.__super.call(this),this._vertexDeclaration=oo,this._vertexCount=or,this._bufferUsage=oT,this._bufferType=34962,this._canRead=ok,this.uri=oW,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*or,this._bind(),oV._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),ok&&(this._buffer=new Float32Array(this._byteLength/4))}ov(on,"laya.d3.graphics.VertexBuffer3D",oD);var oo=on.prototype;return oo.bindWithIndexBuffer=function(oo){oo&&oo._bind(),this._bind()},oo.setData=function(oo,or,oT,ok){if(void 0===or&&(or=0),void 0===oT&&(oT=0),void 0===ok&&(ok=4294967295),0===oT&&4294967295===ok||(oo=new Float32Array(oo.buffer,4*oT,ok)),this._bind(),oV._gl.bufferSubData(this._bufferType,4*or,oo),this._canRead)if(0!==or||0!==oT||4294967295!==ok){var oW=this._buffer.length-or;oW<ok&&(ok=oW);for(var oD=0;oD<ok;oD++)this._buffer[or+oD]=oo[oD]}else this._buffer=oo},oo.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},oo.disposeResource=function(){for(var oo=ou.mainContext,or=this._vertexDeclaration.getVertexElements(),oT=oV._enableAtributes,ok=0,oW=or.length;ok<oW;ok++)oT[ok]===this._glBuffer&&(oo.disableVertexAttribArray(ok),oT[ok]=null);oD.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},ox(0,oo,"vertexDeclaration",function(){return this._vertexDeclaration}),ox(0,oo,"vertexCount",function(){return this._vertexCount}),ox(0,oo,"canRead",function(){return this._canRead}),on.create=function(oo,or,oT,ok,oW){return void 0===oT&&(oT=35044),void 0===ok&&(ok=!1),new on(oo,or,oT,ok,oW)},on}(oV),oJr=function(oo){function oy(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,oy.__super.call(this),this._type=3553}ov(oy,"laya.d3.resource.DataTexture2D",our);var or=oy.prototype;return or.genDebugMipmaps=function(){var oo=[];return oo.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),oo.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),oo.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),oo.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),oo.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),oo.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),oo.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),oo.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),oo.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),oo.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),oo},or._onTextureLoaded=function(oo){},or._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var oo=ou.mainContext,or=this._source=oo.createTexture(),oT=this._width,ok=this._height,oW=os.curBindTexTarget,oD=os.curBindTexValue,on=!1;if(os.bindTexture(oo,this._type,or),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var oV=0;oo.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var oL=0;oL<this._mipmaps.length;oL++){if(this._mipmaps[oL].byteLength!=oU*oh*4)throw"mipmap size error  level:"+oL;oo.texSubImage2D(this._type,0,oy.simLodRect[oV++],oy.simLodRect[oV++],oy.simLodRect[oV++],oy.simLodRect[oV++],6408,5121,new Uint8Array(this._mipmaps[oL]))}this.minFifter=9729,this.magFifter=9729}else{var oU=this._width,oh=this._height;for(oV=0,oo.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),oL=0;oL<this._mipmaps.length;oL++){if(this._mipmaps[oL].byteLength!=oU*oh*4)throw"mipmap size error  level:"+oL;oo.texImage2D(this._type,oL,6408,oU,oh,0,6408,5121,new Uint8Array(this._mipmaps[oL])),(oU/=2)<1&&(oU=1),(oh/=2)<1&&(oh=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&oo.pixelStorei(oo.UNPACK_ALIGNMENT,1),oo.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var op=0,oi=!1,ov=!1;this._buffer.byteLength==4*oT*ok?(op=6408,oi=!0):this._buffer.byteLength==3*oT*ok?(op=6407,ov=!0):op=this._format,oi||ov?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),ov&&oo.pixelStorei(oo.UNPACK_ALIGNMENT,1),oo.texImage2D(this._type,0,op,oT,ok,0,op,5121,this._buffer)):oo&&op==oo.ALPHA?(oo.texImage2D(3553,0,op,oT,ok,0,op,oo.UNSIGNED_BYTE,this._buffer),on=!0):0!=op&&(oo.compressedTexImage2D(3553,0,op,oT,ok,0,this._buffer),on=!0)}var ox=this._minFifter,oj=this._magFifter,o_=0==this._wrapModeU?10497:33071,oK=0==this._wrapModeV?10497:33071,o$=ol.isPOT(oT,ok);o$?(this._mipmap||this._mipmaps?-1!==ox||(ox=9987):-1!==ox||(ox=9729),-1!==oj||(oj=9729),oo.texParameteri(this._type,10241,ox),oo.texParameteri(this._type,10240,oj),oo.texParameteri(this._type,10242,o_),oo.texParameteri(this._type,10243,oK),this._mipmap&&oo.generateMipmap(this._type)):(-1!==ox||(ox=9729),-1!==oj||(oj=9729),oo.texParameteri(this._type,10241,ox),oo.texParameteri(this._type,10240,oj),oo.texParameteri(this._type,10242,33071),oo.texParameteri(this._type,10243,33071)),oW&&oD&&os.bindTexture(oo,oW,oD),this.memorySize=on?this._buffer.length:o$?oT*ok*4*(1+1/3):oT*ok*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},or.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},or.onAsynLoaded=function(oo,or,oT){var ok;oT&&(ok=oT[0].call(this,or)),ok&&(this._width=ok.width,this._height=ok.height,this._buffer=ok.data),this._src=oo,this._size=new ojr(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},or.getPixels=function(){return new Uint8Array(this._buffer)},or.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(ou.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},ox(0,or,"src",function(){return this._src}),oy.create=function(oo,or,oT,ok,oW,oD,on){if(void 0===ok&&(ok=9729),void 0===oW&&(oW=9729),void 0===oD&&(oD=!0),!oo||oo.byteLength<or*oT*4)throw"DataTexture2D create error";var oV=new oy;return oV.uri=on,oV._buffer=oo,oV._width=or,oV._height=oT,oV._mipmap=oD,oV._magFifter=ok,oV._minFifter=oW,oV._size=new ojr(oV._width,oV._height),oV._conchTexture?alert("怎么给runtime传递datatexture数据"):oV.activeResource(),oV},oy.load=function(oo,or,oT,ok,oW){if(void 0===or&&(or=0),void 0===oT&&(oT=0),void 0===ok&&(ok=9729),void 0===oW&&(oW=9729),"mipmaps"===ot.getFileExtension(oo)){var oD=oS.loader.create(oo,null,null,oy,[function(oo){this._mipmaps=[];var or=new Uint32Array(oo);this._width=or[0];var oT=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,oT=1024),this._width!=oT)throw"现在只支持512x256的环境贴图。当前的是"+or[0];this._height=or[1];for(var ok=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,oW=this._height,oD=8;;){var on=ok*oW*4;if(oD+on>oo.byteLength)throw"load mipmaps data size error ";var oV=new Uint8Array(oo,oD,on);if(this._mipmaps.push(oV),oD+=on,1==ok&&1==oW)break;(ok/=2)<1&&(ok=1),(oW/=2)<1&&(oW=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){oD.simLodInfo=new Float32Array(40);for(var on=0;on<oD.simLodInfo.length;)oD.simLodInfo[on]=(oy.simLodRect[on]+.5)/1024,on++,oD.simLodInfo[on]=(oy.simLodRect[on]+.5)/256,on++,oD.simLodInfo[on]=Math.max(oy.simLodRect[on]-1,.1)/1024,on++,oD.simLodInfo[on]=Math.max(oy.simLodRect[on]-1.5,.1)/256,on++}return oD}if("number"==typeof or)return oS.loader.create(oo,null,null,oy,[function(oo){return this._width=or,this._height=oT,this._buffer=oo,null}]);if("function"==typeof or)return oS.loader.create(oo,null,null,oy,[or]);throw new Error("unknown params.")},oy.lodasatlas=!1,op(oy,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),oy}(),oYr=function(oo){function or(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,or.__super.call(this)}ov(or,"laya.d3.resource.models.PrimitiveMesh",osr);var oT=or.prototype;return oS.imps(oT,{"laya.d3.core.render.IRenderable":!0}),oT._getVertexBuffer=function(oo){return void 0===oo&&(oo=0),0===oo?this._vertexBuffer:null},oT._getVertexBuffers=function(){return null},oT._getIndexBuffer=function(){return this._indexBuffer},oT._getPositions=function(){var oo,or=[],oT=this._vertexBuffer.vertexDeclaration.getVertexElements(),ok=0;for(ok=0;ok<oT.length;ok++){var oW=oT[ok];if("vector3"===oW.elementFormat&&0===oW.elementUsage){oo=oW;break}}var oD=this._vertexBuffer.getData();for(ok=0;ok<oD.length;ok+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var on=ok+oo.offset/4,oV=new onr(oD[on+0],oD[on+1],oD[on+2]);or.push(oV)}return or},oT.getRenderElement=function(oo){return this},oT.getRenderElementsCount=function(){return 1},oT.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},oT._beforeRender=function(oo){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},oT._render=function(oo){ou.mainContext.drawElements(4,this._numberIndices,5123,0),oF.drawCall++,oF.trianglesFaces+=this._numberIndices/3},ox(0,oT,"_vertexBufferCount",function(){return 1}),ox(0,oT,"triangleCount",function(){return this._indexBuffer.indexCount/3}),or}(),oAr=function(oo){function or(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,or.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}ov(or,"laya.d3.resource.models.Mesh",osr);var oT=or.prototype;return oT._getPositions=function(){var oo,or,oT,ok,oW,oD=[],on=0,oV=0,oL=0;if(0!==this._vertexBuffers.length){var oU=this._vertexBuffers.length;for(on=0;on<oU;on++){for(oT=(oo=this._vertexBuffers[on]).vertexDeclaration.getVertexElements(),oV=0;oV<oT.length;oV++)if("vector3"===(ok=oT[oV]).elementFormat&&0===ok.elementUsage){or=ok;break}for(oW=oo.getData(),oV=0;oV<oW.length;oV+=oo.vertexDeclaration.vertexStride/4)oL=oV+or.offset/4,oD.push(new onr(oW[oL+0],oW[oL+1],oW[oL+2]))}}else{var oh=this._subMeshes.length;for(on=0;on<oh;on++){for(oT=(oo=this._subMeshes[on]._getVertexBuffer()).vertexDeclaration.getVertexElements(),oV=0;oV<oT.length;oV++)if("vector3"===(ok=oT[oV]).elementFormat&&0===ok.elementUsage){or=ok;break}for(oW=oo.getData(),oV=0;oV<oW.length;oV+=oo.vertexDeclaration.vertexStride/4)oL=oV+or.offset/4,oD.push(new onr(oW[oL+0],oW[oL+1],oW[oL+2]))}}return oD},oT._setSubMeshes=function(oo){this._subMeshes=oo,this._subMeshCount=oo.length;for(var or=0;or<this._subMeshCount;or++)oo[or]._indexInMesh=or;this._positions=this._getPositions(),this._generateBoundingObject()},oT.onAsynLoaded=function(oo,or,oT){var ok=or[0],oW=or[1];oZo.read(ok,this,this._materials,this._subMeshes,oW),this.completeCreate(),this._endLoaded()},oT.getSubMesh=function(oo){return this._subMeshes[oo]},oT.getSubMeshCount=function(){return this._subMeshes.length},oT.getRenderElementsCount=function(){return this._subMeshes.length},oT.getRenderElement=function(oo){return this._subMeshes[oo]},oT.disposeResource=function(){for(var oo=0;oo<this._subMeshes.length;oo++)this._subMeshes[oo].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},ox(0,oT,"materials",function(){return this._materials.slice()}),ox(0,oT,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),or.load=function(oo){return oS.loader.create(oo,null,null,or)},or}(),oIr=(function(oo){function oU(oo,or,oT,ok,oW,oD,on,oV,oL){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===oT&&(oT=6408),void 0===ok&&(ok=5121),void 0===oW&&(oW=33189),void 0===oD&&(oD=!1),void 0===on&&(on=!1),void 0===oV&&(oV=-1),void 0===oL&&(oL=-1),oU.__super.call(this),this._type=3553,this._width=oo,this._height=or,this._size=new ojr(oo,or),this._surfaceFormat=oT,this._surfaceType=ok,this._depthStencilFormat=oW,oj.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=oD,this._repeat=on,this._minFifter=oV,this._magFifter=oL,this.activeResource(),this._alreadyResolved=!0}ov(oU,"laya.d3.resource.RenderTexture",our);var or=oU.prototype;or.recreateResource=function(){var oo=ou.mainContext;this._frameBuffer=oo.createFramebuffer(),this._source=oo.createTexture();var or=os.curBindTexTarget,oT=os.curBindTexValue;os.bindTexture(oo,this._type,this._source),oo.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var ok=this._minFifter,oW=this._magFifter,oD=this._repeat?10497:33071;if(ol.isPOT(this._width,this._height)?(this._mipmap?-1!==ok||(ok=9987):-1!==ok||(ok=9729),-1!==oW||(oW=9729),oo.texParameteri(this._type,10241,ok),oo.texParameteri(this._type,10240,oW),oo.texParameteri(this._type,10242,oD),oo.texParameteri(this._type,10243,oD),this._mipmap&&oo.generateMipmap(this._type)):(-1!==ok||(ok=9729),-1!==oW||(oW=9729),oo.texParameteri(this._type,10241,ok),oo.texParameteri(this._type,10240,oW),oo.texParameteri(this._type,10242,33071),oo.texParameteri(this._type,10243,33071)),or&&oT&&os.bindTexture(oo,or,oT),oo.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=oo.createRenderbuffer(),oo.bindRenderbuffer(36161,this._depthStencilBuffer),oo.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),oo.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:oo.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:oo.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:oo.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}oo.framebufferTexture2D(36160,36064,3553,this._source,0),oo.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},or.start=function(){ou.mainContext.bindFramebuffer(36160,this.frameBuffer),(oU._currentRenderTarget=this)._alreadyResolved=!1},or.end=function(){ou.mainContext.bindFramebuffer(36160,null),oU._currentRenderTarget=null,this._alreadyResolved=!0},or.getData=function(oo,or,oT,ok){var oW=ou.mainContext;if(oW.bindFramebuffer(36160,this._frameBuffer),!(36053===oW.checkFramebufferStatus(36160)))return oW.bindFramebuffer(36160,null),null;var oD=new Uint8Array(this._width*this._height*4);return oW.readPixels(oo,or,oT,ok,this._surfaceFormat,this._surfaceType,oD),oW.bindFramebuffer(36160,null),oD},or.disposeResource=function(){if(this._frameBuffer){var oo=ou.mainContext;oo.deleteTexture(this._source),oo.deleteFramebuffer(this._frameBuffer),oo.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},ox(0,or,"surfaceFormat",function(){return this._surfaceFormat}),ox(0,or,"surfaceType",function(){return this._surfaceType}),ox(0,or,"depthStencilFormat",function(){return this._depthStencilFormat}),ox(0,or,"source",function(){return this._alreadyResolved?oS.superGet(our,this,"source"):null}),ox(0,or,"depthStencilBuffer",function(){return this._depthStencilBuffer}),ox(0,or,"frameBuffer",function(){return this._frameBuffer}),oU._currentRenderTarget=null}(),function(oo){function or(oo){this._color=null,this._pixels=null,or.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new ojr(this.width,this.height),this._color=oo,this._pixels=new Uint8Array([255*oo.x,255*oo.y,255*oo.z,255*oo.w]),this.uri="SolidColorTexture2D_"+this.id}ov(or,"laya.d3.resource.SolidColorTexture2D",our);var oT=or.prototype;return oT._createWebGlTexture=function(){var oo=ou.mainContext,or=this._source=oo.createTexture(),oT=this._width,ok=this._height,oW=os.curBindTexTarget,oD=os.curBindTexValue;os.bindTexture(oo,this._type,or),oo.texImage2D(this._type,0,6408,oT,ok,0,6408,5121,this._pixels);var on=this._minFifter,oV=this._magFifter,oL=this._repeat?10497:33071,oU=ol.isPOT(oT,ok);oU?(this._mipmap?-1!==on||(on=9987):-1!==on||(on=9729),-1!==oV||(oV=9729),oo.texParameteri(this._type,10241,on),oo.texParameteri(this._type,10240,oV),oo.texParameteri(this._type,10242,oL),oo.texParameteri(this._type,10243,oL),this._mipmap&&oo.generateMipmap(this._type)):(-1!==on||(on=9729),-1!==oV||(oV=9729),oo.texParameteri(this._type,10241,on),oo.texParameteri(this._type,10240,oV),oo.texParameteri(this._type,10242,33071),oo.texParameteri(this._type,10243,33071)),oW&&oD&&os.bindTexture(oo,oW,oD),this.memorySize=oU?oT*ok*4*(1+1/3):oT*ok*4},oT.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},oT.disposeResource=function(){this._source&&(ou.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},op(or,["magentaTexture",function(){var oo=new or(new oVr(1,0,1,1));return oo.lock=!0,this.magentaTexture=oo},"grayTexture",function(){var oo=new or(new oVr(.5,.5,.5,1));return oo.lock=!0,this.grayTexture=oo}]),or}()),oNr=function(oo){function oW(oo,or,oT,ok){this._canRead=!1,this._image=null,this._pixels=null,void 0===oo&&(oo=!1),void 0===or&&(or=!0),void 0===oT&&(oT=6408),void 0===ok&&(ok=!0),oW.__super.call(this),this._type=3553,this._repeat=or,this._canRead=oo,this._format=oT,this._mipmap=ok}ov(oW,"laya.d3.resource.Texture2D",our);var or=oW.prototype;return or._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var oo=ou.mainContext,or=this._source=oo.createTexture(),oT=this._width,ok=this._height,oW=os.curBindTexTarget,oD=os.curBindTexValue;switch(os.bindTexture(oo,this._type,or),this._format){case 6407:case 6408:this._canRead?oo.texImage2D(this._type,0,this._format,oT,ok,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?oo.texImage2D(this._type,0,this._image._format,oT,ok,0,this._image._format,5121,this._image.atlasSource):oo.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case ou.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:oo.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var on=this._minFifter,oV=this._magFifter,oL=this._repeat?10497:33071,oU=0==this._wrapModeU?10497:33071,oh=0==this._wrapModeV?10497:33071,op=ol.isPOT(oT,ok);op?(this._mipmap?-1!==on||(on=9987):-1!==on||(on=9729),-1!==oV||(oV=9729),oo.texParameteri(this._type,10241,on),oo.texParameteri(this._type,10240,oV),oo.texParameteri(this._type,10242,oL),oo.texParameteri(this._type,10243,oL),oo.texParameteri(this._type,10242,oU),oo.texParameteri(this._type,10243,oh),this._mipmap&&oo.generateMipmap(this._type)):(-1!==on||(on=9729),-1!==oV||(oV=9729),oo.texParameteri(this._type,10241,on),oo.texParameteri(this._type,10240,oV),oo.texParameteri(this._type,10242,33071),oo.texParameteri(this._type,10243,33071)),oW&&oD&&os.bindTexture(oo,oW,oD),this._image.onload=null,this._image=null,this.memorySize=op?oT*ok*4*(1+1/3):oT*ok*4},or.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},or.onAsynLoaded=function(oo,or,oT){if(oT){var ok=oT[0];void 0!==ok&&(this._canRead=ok);var oW=oT[1];void 0!==oW&&(this._repeat=oW);var oD=oT[2];void 0!==oD&&(this._format=oD);var on=oT[3];void 0!==on&&(this._mipmap=on);var oV=oT.wrapModeU;void 0!==oV&&(this._wrapModeU=oV);var oL=oT.wrapModeV;void 0!==oL&&(this._wrapModeV=oL)}switch(this._format){case 6407:case 6408:var oU=(this._image=or).width,oh=or.height;this._width=oU,this._height=oh,this._size=new ojr(oU,oh),this._canRead&&(oj.isConchApp?or instanceof oi.HTMLElement&&(this._pixels=new Uint8Array(or.getImageData(0,0,oU,oh))):(oz.canvas.size(oU,oh),oz.canvas.clear(),oz.context.drawImage(or,0,0,oU,oh),this._pixels=new Uint8Array(oz.context.getImageData(0,0,oU,oh).data.buffer)));break;case ou.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var op=new oq(or);op.readUTFBytes(4),op.readUTFBytes(2),op.getInt16();op.endian="bigEndian",this._width=op.getInt16(),this._height=op.getInt16(),this._size=new ojr(this._width,this._height);op.getInt16(),op.getInt16();this._image=new Uint8Array(or,op.pos)}this.recreateResource(),this._endLoaded()},or.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},or.disposeResource=function(){this._source&&(ou.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},ox(0,or,"_src",function(){return this.url}),ox(0,or,"src",function(){return this.url}),oW.load=function(oo){return oS.loader.create(oo,null,null,oW)},oW}(),ofr=function(or){function oT(oo,or){oT.__super.call(this),void 0===oo&&(oo=.3),void 0===or&&(or=1e3),this._tempVector3=new onr,this._position=new onr,this._up=new onr,this._forward=new onr,this._right=new onr,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=ojr.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=oo,this._farPlane=or,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),oS.stage.on("resize",this,this._onScreenSizeChanged)}ov(oT,"laya.d3.core.BaseCamera",or);var oo=oT.prototype;return oo._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var oo=this.scene._cameraPool,or=oo.length-1,oT=0;oT<or;oT++)if(oo[oT].renderingOrder>oo[or].renderingOrder){var ok=oo[oT];oo[oT]=oo[or],oo[or]=ok}},oo._calculateProjectionMatrix=function(){},oo._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},oo._prepareCameraToRender=function(){om._currentCameraCullingMask=this.cullingMask;var oo=this._shaderValues;oo.setValue(0,this.transform.position.elements),oo.setValue(5,this.forward.elements),oo.setValue(6,this.up.elements)},oo._prepareCameraViewProject=function(oo,or){var oT=this._shaderValues;oT.setValue(1,oo.elements),oT.setValue(2,or.elements)},oo._renderCamera=function(oo,or,oT){},oo.addLayer=function(oo){29!==oo.number&&30!=oo.number&&(this.cullingMask=this.cullingMask|oo.mask)},oo.removeLayer=function(oo){29!==oo.number&&30!=oo.number&&(this.cullingMask=this.cullingMask&~oo.mask)},oo.addAllLayers=function(){this.cullingMask=2147483647},oo.removeAllLayers=function(){this.cullingMask=0|om.getLayerByNumber(29).mask|om.getLayerByNumber(30).mask},oo.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},oo.moveForward=function(oo){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=oo,this.transform.translate(this._tempVector3)},oo.moveRight=function(oo){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=oo,this.transform.translate(this._tempVector3)},oo.moveVertical=function(oo){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=oo,this.transform.translate(this._tempVector3,!1)},oo._addSelfRenderObjects=function(){var oo=this.scene._cameraPool,or=oo.length;if(0<or){for(var oT=or-1;0<=oT;oT--)if(this.renderingOrder<=oo[oT].renderingOrder){oo.splice(oT+1,0,this);break}}else oo.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},oo._clearSelfRenderObjects=function(){var oo=this.scene._cameraPool;oo.splice(oo.indexOf(this),1)},oo.destroy=function(oo){void 0===oo&&(oo=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,oS.stage.off("resize",this,this._onScreenSizeChanged),or.prototype.destroy.call(this,oo)},ox(0,oo,"sky",function(){return this._sky},function(oo){(this._sky=oo)._ownerCamera=this}),ox(0,oo,"forward",function(){var oo=this.transform.worldMatrix.elements,or=this._forward.elements;return or[0]=-oo[8],or[1]=-oo[9],or[2]=-oo[10],this._forward}),ox(0,oo,"position",function(){var oo=this.transform.worldMatrix.elements,or=this._position.elements;return or[0]=oo[12],or[1]=oo[13],or[2]=oo[14],this._position}),ox(0,oo,"renderTarget",function(){return this._renderTarget},function(oo){null!=(this._renderTarget=oo)&&(this._renderTargetSize=oo.size)}),ox(0,oo,"up",function(){var oo=this.transform.worldMatrix.elements,or=this._up.elements;return or[0]=oo[4],or[1]=oo[5],or[2]=oo[6],this._up}),ox(0,oo,"right",function(){var oo=this.transform.worldMatrix.elements,or=this._right.elements;return or[0]=oo[0],or[1]=oo[1],or[2]=oo[2],this._right}),ox(0,oo,"renderTargetSize",function(){return this._renderTargetSize},function(oo){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=oo,this._calculateProjectionMatrix()}),ox(0,oo,"fieldOfView",function(){return this._fieldOfView},function(oo){this._fieldOfView=oo,this._calculateProjectionMatrix()}),ox(0,oo,"nearPlane",function(){return this._nearPlane},function(oo){this._nearPlane=oo,this._calculateProjectionMatrix()}),ox(0,oo,"farPlane",function(){return this._farPlane},function(oo){this._farPlane=oo,this._calculateProjectionMatrix()}),ox(0,oo,"orthographic",function(){return this._orthographic},function(oo){this._orthographic=oo,this._calculateProjectionMatrix()}),ox(0,oo,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(oo){this._orthographicVerticalSize=oo,this._calculateProjectionMatrix()}),ox(0,oo,"renderingOrder",function(){return this._renderingOrder},function(oo){this._renderingOrder=oo,this._sortCamerasByRenderingOrder()}),oT.CAMERAPOS=0,oT.VIEWMATRIX=1,oT.PROJECTMATRIX=2,oT.VPMATRIX=3,oT.VPMATRIX_NO_TRANSLATE=4,oT.CAMERADIRECTION=5,oT.CAMERAUP=6,oT.ENVIRONMENTDIFFUSE=7,oT.ENVIRONMENTSPECULAR=8,oT.SIMLODINFO=9,oT.DIFFUSEIRRADMATR=10,oT.DIFFUSEIRRADMATG=11,oT.DIFFUSEIRRADMATB=12,oT.HDREXPOSURE=13,oT.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",oT.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",oT.CLEARFLAG_SOLIDCOLOR=0,oT.CLEARFLAG_SKY=1,oT.CLEARFLAG_DEPTHONLY=2,oT.CLEARFLAG_NONE=3,op(oT,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new oor(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new oor},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new oor}]),oT}(oXr),oar=function(oT){function or(oo){this._render=null,this._geometryFilter=null,or.__super.call(this,oo)}ov(or,"laya.d3.core.RenderableSprite3D",oT);var oo=or.prototype;return oo._addToInitStaticBatchManager=function(){},oo._setBelongScene=function(oo){oT.prototype._setBelongScene.call(this,oo),oo._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},oo._setUnBelongScene=function(){var oo=this._scene._renderableSprite3Ds,or=oo.indexOf(this);oo.splice(or,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),oT.prototype._setUnBelongScene.call(this)},oo._update=function(oo){(oo.owner=this)._activeInHierarchy&&(this._updateComponents(oo),this._render._updateOctreeNode(),this._lateUpdateComponents(oo),oF.spriteCount++,this._childs.length&&this._updateChilds(oo))},oo.destroy=function(oo){void 0===oo&&(oo=!0),oT.prototype.destroy.call(this,oo),this._render._destroy(),this._render=null},or.__init__=function(){or.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=or.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),or.SAHDERDEFINE_LIGHTMAP=or.shaderDefines.registerDefine("LIGHTMAP")},or.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,or.SAHDERDEFINE_LIGHTMAP=4,or.LIGHTMAPSCALEOFFSET=2,or.LIGHTMAP=3,op(or,["shaderDefines",function(){return this.shaderDefines=new ohr}]),or}(oXr),oGr=(function(oo){function ok(oo,or,oT){this._long=NaN,this._width=NaN,this._height=NaN,void 0===oo&&(oo=1),void 0===or&&(or=1),void 0===oT&&(oT=1),ok.__super.call(this),this._long=oo,this._width=or,this._height=oT,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}ov(ok,"laya.d3.resource.models.BoxMesh",oYr);var or=ok.prototype;or.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var oo=ouo.vertexDeclaration,or=(oo.vertexStride,this._long/2),oT=this._height/2,ok=this._width/2,oW=new Float32Array([-or,oT,-ok,0,1,0,0,0,or,oT,-ok,0,1,0,1,0,or,oT,ok,0,1,0,1,1,-or,oT,ok,0,1,0,0,1,-or,-oT,-ok,0,-1,0,0,1,or,-oT,-ok,0,-1,0,1,1,or,-oT,ok,0,-1,0,1,0,-or,-oT,ok,0,-1,0,0,0,-or,oT,-ok,-1,0,0,0,0,-or,oT,ok,-1,0,0,1,0,-or,-oT,ok,-1,0,0,1,1,-or,-oT,-ok,-1,0,0,0,1,or,oT,-ok,1,0,0,1,0,or,oT,ok,1,0,0,0,0,or,-oT,ok,1,0,0,0,1,or,-oT,-ok,1,0,0,1,1,-or,oT,ok,0,0,1,0,0,or,oT,ok,0,0,1,1,0,or,-oT,ok,0,0,1,1,1,-or,-oT,ok,0,0,1,0,1,-or,oT,-ok,0,0,-1,1,0,or,oT,-ok,0,0,-1,0,0,or,-oT,-ok,0,0,-1,0,1,-or,-oT,-ok,0,0,-1,1,1]),oD=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new oer(oo,this._numberVertices,35044,!0),this._indexBuffer=new ocr("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(oW),this._indexBuffer.setData(oD),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},ox(0,or,"long",function(){return this._long},function(oo){this._long!==oo&&(this._long=oo,this.releaseResource(),this.activeResource())}),ox(0,or,"width",function(){return this._width},function(oo){this._width!==oo&&(this._width=oo,this.releaseResource(),this.activeResource())}),ox(0,or,"height",function(){return this._height},function(oo){this._height!==oo&&(this._height=oo,this.releaseResource(),this.activeResource())})}(),function(oo){function on(oo,or,oT){void 0===oo&&(oo=0),void 0===or&&(or=.3),void 0===oT&&(oT=1e3),this._viewMatrix=new oor,this._projectionMatrix=new oor,this._projectionViewMatrix=new oor,this._viewport=new oLr(0,0,0,0),this._normalizedViewport=new oLr(0,0,1,1),this._aspectRatio=oo,this._boundFrustumUpdate=!0,this._boundFrustum=new ogo(oor.DEFAULT),on.__super.call(this,or,oT),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}ov(on,"laya.d3.core.Camera",ofr);var or=on.prototype;return or._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},or._parseCustomProps=function(oo,or,oT,ok){var oW=oT.clearColor;this.clearColor=new oVr(oW[0],oW[1],oW[2],oW[3]);var oD=oT.viewport;this.normalizedViewport=new oLr(oD[0],oD[1],oD[2],oD[3])},or._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var oo=this.orthographicVerticalSize*this.aspectRatio*.5,or=.5*this.orthographicVerticalSize;oor.createOrthoOffCenterRH(-oo,oo,-or,or,this.nearPlane,this.farPlane,this._projectionMatrix)}else oor.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},or._update=function(oo){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,oo)},or._renderCamera=function(oo,or,oT){var ok,oW;oT.parallelSplitShadowMaps[0]&&oT._renderShadowMap(oo,or,this),(or.camera=this)._prepareCameraToRender(),oT._preRenderUpdateComponents(or),ok=or._viewMatrix=this.viewMatrix;var oD=this._renderTarget;oD?(oD.start(),oor.multiply(ofr._invertYScaleMatrix,this._projectionMatrix,ofr._invertYProjectionMatrix),oor.multiply(ofr._invertYScaleMatrix,this.projectionViewMatrix,ofr._invertYProjectionViewMatrix),oW=or._projectionMatrix=ofr._invertYProjectionMatrix,or._projectionViewMatrix=ofr._invertYProjectionViewMatrix):(oW=or._projectionMatrix=this._projectionMatrix,or._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(ok,oW),or._viewport=this.viewport,oT._preRenderScene(oo,or,this.boundFrustum),oT._clear(oo,or),oT._renderScene(oo,or),oT._postRenderUpdateComponents(or),oD&&oD.end()},or.viewportPointToRay=function(oo,or){oxr.calculateCursorRay(oo,this.viewport,this._projectionMatrix,this.viewMatrix,null,or)},or.normalizedViewportPointToRay=function(oo,or){var oT=on._tempVector20,ok=this.viewport,oW=oo.elements,oD=oT.elements;oD[0]=oW[0]*ok.width,oD[1]=oW[1]*ok.height,oxr.calculateCursorRay(oT,this.viewport,this._projectionMatrix,this.viewMatrix,null,or)},or.worldToViewportPoint=function(oo,or){oor.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(oo,this._projectionViewMatrix,or);var oT=or.elements;oT[0]=oT[0]/oS.stage.clientScaleX,oT[1]=oT[1]/oS.stage.clientScaleY},or.worldToNormalizedViewportPoint=function(oo,or){oor.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(oo,this._projectionViewMatrix,or);var oT=or.elements;oT[0]=oT[0]/oS.stage.clientScaleX,oT[1]=oT[1]/oS.stage.clientScaleY},or.convertScreenCoordToOrthographicCoord=function(oo,or){if(this._orthographic){var oT=oZ.clientWidth,ok=oZ.clientHeight,oW=this.orthographicVerticalSize*this.aspectRatio/oT,oD=this.orthographicVerticalSize/ok,on=oo.elements,oV=or.elements;return oV[0]=(-oT/2+on[0])*oW,oV[1]=(ok/2-on[1])*oD,oV[2]=(this.nearPlane-this.farPlane)*(on[2]+1)/2-this.nearPlane,onr.transformCoordinate(or,this.transform.worldMatrix,or),!0}return!1},ox(0,or,"projectionViewMatrix",function(){return oor.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),ox(0,or,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var oo=this.viewport;return oo.width/oo.height},function(oo){if(oo<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=oo,this._calculateProjectionMatrix()}),ox(0,or,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),ox(0,or,"needViewport",function(){var oo=this.normalizedViewport;return 0===oo.x&&0===oo.y&&1===oo.width&&1===oo.height}),ox(0,or,"viewport",function(){if(this._viewportExpressedInClipSpace){var oo=this._normalizedViewport,or=this.renderTargetSize,oT=or.width,ok=or.height;this._viewport.x=oo.x*oT,this._viewport.y=oo.y*ok,this._viewport.width=oo.width*oT,this._viewport.height=oo.height*ok}return this._viewport},function(oo){if(null!=this.renderTarget&&(oo.x<0||oo.y<0||0==oo.width||0==oo.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=oo,this._calculateProjectionMatrix()}),ox(0,or,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var oo=this._viewport,or=this.renderTargetSize,oT=or.width,ok=or.height;this._normalizedViewport.x=oo.x/oT,this._normalizedViewport.y=oo.y/ok,this._normalizedViewport.width=oo.width/oT,this._normalizedViewport.height=oo.height/ok}return this._normalizedViewport},function(oo){oo.x<0&&(oo.x=0,console.warn("Camera: viewport.x must large than 0.0.")),oo.y<0&&(oo.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<oo.x+oo.width&&(oo.width=1-oo.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<oo.y+oo.height&&(oo.height=1-oo.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=oo,this._calculateProjectionMatrix()}),ox(0,or,"projectionMatrix",function(){return this._projectionMatrix},function(oo){this._projectionMatrix=oo,this._useUserProjectionMatrix=!0}),ox(0,or,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),op(on,["_tempVector20",function(){return this._tempVector20=new oDr}]),on}()),owr=function(oT){function ok(oo,or){ok.__super.call(this,or),this._geometryFilter=new ozr(this),this._render=new omr(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),oo&&(this._geometryFilter.sharedMesh=oo)instanceof laya.d3.resource.models.Mesh&&(oo.loaded?this._render.sharedMaterials=oo.materials:oo.once("loaded",this,this._applyMeshMaterials))}ov(ok,"laya.d3.core.MeshSprite3D",oT);var oo=ok.prototype;return oo._changeRenderObjectByMesh=function(oo){var or=this._render._renderElements,oT=or[oo];oT||(oT=or[oo]=new obr),oT._render=this._render;var ok=this._render.sharedMaterials[oo];ok||(ok=oMr.defaultMaterial);var oW=this._geometryFilter.sharedMesh.getRenderElement(oo);return oT._mainSortID=this._getSortID(oW,ok),oT._sprite3D=this,oT.renderObj=oW,oT._material=ok,oT},oo._changeRenderObjectByMaterial=function(oo,or){var oT=this._render._renderElements[oo];or||(or=oMr.defaultMaterial);var ok=this._geometryFilter.sharedMesh.getRenderElement(oo);return oT._mainSortID=this._getSortID(ok,or),oT._sprite3D=this,oT.renderObj=ok,oT._material=or,oT},oo._changeRenderObjectsByMesh=function(){var oo=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=oo;for(var or=0;or<oo;or++)this._changeRenderObjectByMesh(or)},oo._onMeshChanged=function(oo){var or=oo.sharedMesh;or.loaded?this._changeRenderObjectsByMesh():or.once("loaded",this,this._onMeshLoaded)},oo._onMeshLoaded=function(oo){oo===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},oo._onMaterialChanged=function(oo,or,oT){or<this._render._renderElements.length&&this._changeRenderObjectByMaterial(or,oT)},oo._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},oo._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},oo._parseCustomProps=function(oo,or,oT,ok){var oW=this.meshRender,oD=oT.lightmapIndex;null!=oD&&(oW.lightmapIndex=oD);var on,oV,oL=oT.lightmapScaleOffset;if(oL&&(oW.lightmapScaleOffset=new oVr(oL[0],oL[1],oL[2],oL[3])),ok.instanceParams)(on=ok.instanceParams.loadPath)&&(oV=oK.getRes(or[on]),(this.meshFilter.sharedMesh=oV).loaded?oW.sharedMaterials=oV.materials:oV.once("loaded",this,this._applyMeshMaterials));else{(on=oT.meshPath)&&(oV=oK.getRes(or[on]),this.meshFilter.sharedMesh=oV);var oU=oT.materials;if(oU){var oh=oW.sharedMaterials,op=oU.length;oh.length=op;for(var oi=0;oi<op;oi++)oh[oi]=oK.getRes(or[oU[oi].path]);oW.sharedMaterials=oh}}},oo._applyMeshMaterials=function(oo){for(var or=this._render.sharedMaterials,oT=oo.materials,ok=0,oW=oT.length;ok<oW;ok++)or[ok]||(or[ok]=oT[ok]);this._render.sharedMaterials=or},oo._addToInitStaticBatchManager=function(){ok._staticBatchManager._addInitBatchSprite(this)},oo.cloneTo=function(oo){var or=oo;or._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var oT=this._render,ok=or._render;ok.enable=oT.enable,ok.sharedMaterials=oT.sharedMaterials,ok.castShadow=oT.castShadow;var oW=oT.lightmapScaleOffset;oW&&(ok.lightmapScaleOffset=oW.clone()),ok.lightmapIndex=oT.lightmapIndex,ok.receiveShadow=oT.receiveShadow,ok.sortingFudge=oT.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,oo)},oo.destroy=function(oo){if(void 0===oo&&(oo=!0),!this.destroyed){var or=this.meshFilter.sharedMesh;null!=or&&(or.loaded||or.off("loaded",this,this._applyMeshMaterials)),oT.prototype.destroy.call(this,oo),this._geometryFilter._destroy()}},ox(0,oo,"meshFilter",function(){return this._geometryFilter}),ox(0,oo,"meshRender",function(){return this._render}),ok.__init__=function(){oko._staticBatchManagers.push(ok._staticBatchManager)},ok.load=function(oo){return oS.loader.create(oo,null,null,ok)},op(ok,["_staticBatchManager",function(){return this._staticBatchManager=new oPr}]),ok}(oar)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(oo,or){"use strict";for(var oT in Object.defineProperty(or,"__esModule",{value:!0}),Laya){var ok=Laya[oT];ok&&ok.__isclass&&(or[oT]=ok)}}),function(oo,or,oWo){oWo.un,oWo.uns;var oT=oWo.static,ok=oWo.class,oD=oWo.getset,oj=oWo.__newvec,oV=laya.maths.Bezier,op=laya.utils.Browser,ouo=laya.utils.Byte,oW=(laya.events.Event,laya.events.EventDispatcher),on=laya.display.Graphics,oL=(laya.resource.HTMLCanvas,laya.utils.Handler),oU=laya.net.Loader,oi=laya.maths.MathUtil,oso=laya.maths.Matrix,o_=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),oh=(laya.renders.RenderContext,laya.resource.Resource),ov=laya.utils.RunDriver,oDo=laya.display.Sprite,ox=laya.utils.Stat,ozo=laya.resource.Texture,oK=(laya.net.URL,laya.utils.Utils),os=function(){function oo(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return ok(oo,"laya.ani.AnimationContent"),oo}(),oz=function(){function oo(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return ok(oo,"laya.ani.AnimationNodeContent"),oo}(),oy=function(){function oo(){}return ok(oo,"laya.ani.AnimationParser01"),oo.parse=function(oo,or){var oT=or.__getBuffer(),ok=0,oW=0,oD=0,on=0,oV=0,oL=0,oU=0,oh=or.readUTFString();oo._aniClassName=oh;var op,oi=or.readUTFString().split("\n"),ov=or.getUint8(),ox=or.getUint32(),oj=or.getUint32();0<ox&&(op=oT.slice(ox,oj));var o_=new ouo(op);for(0<oj&&(oo._publicExtData=oT.slice(oj,oT.byteLength)),oo._useParent=!!or.getUint8(),oo._anis.length=ov,ok=0;ok<ov;ok++){var oK=oo._anis[ok]=new os;oK.nodes=new Array;var o$=oK.name=oi[or.getUint16()];oo._aniMap[o$]=ok,oK.bone3DMap={},oK.playTime=or.getFloat32(),oK.playTime<=0&&console.error("播放时间不能为0  url="+oo.url+" name="+oK.name);var oy=oK.nodes.length=or.getUint8();for(oW=oK.totalKeyframeDatasLength=0;oW<oy;oW++){var ol=oK.nodes[oW]=new oz;ol.childs=[];var oS=or.getInt16();0<=oS&&(ol.name=oi[oS],oK.bone3DMap[ol.name]=oW),ol.keyFrame=new Array,ol.parentIndex=or.getInt16(),-1==ol.parentIndex?ol.parent=null:ol.parent=oK.nodes[ol.parentIndex],ol.lerpType=or.getUint8();var oq=or.getUint32();o_.pos=oq;var ob=ol.keyframeWidth=o_.getUint16();if(oK.totalKeyframeDatasLength+=ob,0===ol.lerpType||1===ol.lerpType)for(ol.interpolationMethod=[],ol.interpolationMethod.length=ob,oD=0;oD<ob;oD++)ol.interpolationMethod[oD]=oX.interpolation[o_.getUint8()];null!=ol.parent&&ol.parent.childs.push(ol);var oF=or.getUint16();0<oF&&(ol.extenData=oT.slice(or.pos,or.pos+oF),or.pos+=oF);var oP,ot=or.getUint16(),oH=0;for(oD=0,on=ol.keyFrame.length=ot;oD<on;oD++){if((oP=ol.keyFrame[oD]=new om).duration=or.getFloat32(),oP.startTime=oH,2===ol.lerpType){oP.interpolationData=[];var oR,ou=or.getUint8();switch(oR=or.getFloat32()){case 254:for(oP.interpolationData.length=ob,oU=0;oU<ob;oU++)oP.interpolationData[oU]=0;break;case 255:for(oP.interpolationData.length=ob,oU=0;oU<ob;oU++)oP.interpolationData[oU]=5;break;default:for(oP.interpolationData.push(oR),oL=1;oL<ou;oL++)oP.interpolationData.push(or.getFloat32())}}for(oP.data=new Float32Array(ob),oV=0;oV<ob;oV++)oP.data[oV]=or.getFloat32(),-1e-8<oP.data[oV]&&oP.data[oV]<1e-8&&(oP.data[oV]=0);oH+=oP.duration}oP.startTime=oK.playTime,ol.playTime=oK.playTime,oo._calculateKeyFrame(ol,ot,ob)}}},oo}(),ol=function(){function oS(){}return ok(oS,"laya.ani.AnimationParser02"),oS.READ_DATA=function(){oS._DATA.offset=oS._reader.getUint32(),oS._DATA.size=oS._reader.getUint32()},oS.READ_BLOCK=function(){for(var oo=oS._BLOCK.count=oS._reader.getUint16(),or=oS._BLOCK.blockStarts=[],oT=oS._BLOCK.blockLengths=[],ok=0;ok<oo;ok++)or.push(oS._reader.getUint32()),oT.push(oS._reader.getUint32())},oS.READ_STRINGS=function(){var oo=oS._reader.getUint32(),or=oS._reader.getUint16(),oT=oS._reader.pos;oS._reader.pos=oo+oS._DATA.offset;for(var ok=0;ok<or;ok++)oS._strings[ok]=oS._reader.readUTFString();oS._reader.pos=oT},oS.parse=function(oo,or){oS._templet=oo;(oS._reader=or).__getBuffer();oS.READ_DATA(),oS.READ_BLOCK(),oS.READ_STRINGS();for(var oT=0,ok=oS._BLOCK.count;oT<ok;oT++){var oW=or.getUint16(),oD=oS._strings[oW],on=oS["READ_"+oD];if(null==on)throw new Error("model file err,no this function:"+oW+" "+oD);on.call()}},oS.READ_ANIMATIONS=function(){var oo=oS._reader,or=oo.__getBuffer(),oT=0,ok=0,oW=0,oD=0,on=oo.getUint16(),oV=[];for(oV.length=on,oT=0;oT<on;oT++)oV[oT]=oX.interpolation[oo.getByte()];var oL=oo.getUint8();for(oS._templet._anis.length=oL,oT=0;oT<oL;oT++){var oU=oS._templet._anis[oT]={};oU.nodes=new Array;var oh=oU.name=oS._strings[oo.getUint16()];oS._templet._aniMap[oh]=oT,oU.bone3DMap={},oU.playTime=oo.getFloat32();var op=oU.nodes.length=oo.getInt16();for(ok=oU.totalKeyframeDatasLength=0;ok<op;ok++){var oi=oU.nodes[ok]={};oi.keyframeWidth=on,oi.childs=[];var ov=oo.getUint16();0<=ov&&(oi.name=oS._strings[ov],oU.bone3DMap[oi.name]=ok),oi.keyFrame=new Array,oi.parentIndex=oo.getInt16(),-1==oi.parentIndex?oi.parent=null:oi.parent=oU.nodes[oi.parentIndex],oU.totalKeyframeDatasLength+=on,oi.interpolationMethod=oV,null!=oi.parent&&oi.parent.childs.push(oi);var ox=oo.getUint16(),oj=null,o_=null;for(oW=0,oD=oi.keyFrame.length=ox;oW<oD;oW++){(oj=oi.keyFrame[oW]={}).startTime=oo.getFloat32(),o_&&(o_.duration=oj.startTime-o_.startTime);var oK=oS._DATA.offset,o$=oo.getUint32(),oy=4*on,ol=or.slice(oK+o$,oK+o$+oy);oj.data=new Float32Array(ol),o_=oj}oj.duration=0,oi.playTime=oU.playTime,oS._templet._calculateKeyFrame(oi,ox,on)}}},oS._templet=null,oS._reader=null,oS._strings=[],oT(oS,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),oS}(),omo=(function(){function oo(){}ok(oo,"laya.ani.AnimationState"),oo.stopped=0,oo.paused=1,oo.playing=2}(),function(){function oW(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new oao,this.resultMatrix=new oso,this._children=[]}ok(oW,"laya.ani.bone.Bone");var oo=oW.prototype;return oo.setTempMatrix=function(oo){this._tempMatrix=oo;var or,oT=0;for(oT=0,or=this._children.length;oT<or;oT++)this._children[oT].setTempMatrix(this._tempMatrix)},oo.update=function(oo){var or;if(this.rotation=this.transform.skX,oo)or=this.resultTransform.getMatrix(),oso.mul(or,oo,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)or=this.resultTransform.getMatrix(),oso.mul(or,this.parentBone.resultMatrix,this.resultMatrix);else{var oT=this.parentBone,ok=NaN,oW=NaN,oD=NaN,on=this.parentBone.resultMatrix;or=this.resultTransform.getMatrix();var oV=on.a*or.tx+on.c*or.ty+on.tx,oL=on.b*or.tx+on.d*or.ty+on.ty,oU=new oso;this.inheritRotation?(ok=Math.atan2(oT.resultMatrix.b,oT.resultMatrix.a),oW=Math.cos(ok),oD=Math.sin(ok),oU.setTo(oW,oD,-oD,oW,0,0),oso.mul(this._tempMatrix,oU,oso.TEMP),oso.TEMP.copyTo(oU),or=this.resultTransform.getMatrix(),oso.mul(or,oU,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,or=this.resultTransform.getMatrix(),oso.TEMP.identity(),oso.TEMP.d=this.d,oso.mul(or,oso.TEMP,this.resultMatrix)),this.resultMatrix.tx=oV,this.resultMatrix.ty=oL}else(or=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var oh,op=0;for(op=0,oh=this._children.length;op<oh;op++)this._children[op].update()},oo.updateChild=function(){var oo,or=0;for(or=0,oo=this._children.length;or<oo;or++)this._children[or].update()},oo.setRotation=function(oo){this._sprite&&(this._sprite.rotation=180*oo/Math.PI)},oo.updateDraw=function(oo,or){oW.ShowBones&&!oW.ShowBones[this.name]||(this._sprite||(this._sprite=new oDo,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),oWo.stage.addChild(this._sprite)),this._sprite.x=oo+this.resultMatrix.tx,this._sprite.y=or+this.resultMatrix.ty);var oT,ok=0;for(ok=0,oT=this._children.length;ok<oT;ok++)this._children[ok].updateDraw(oo,or)},oo.addChild=function(oo){this._children.push(oo),oo.parentBone=this},oo.findBone=function(oo){if(this.name==oo)return this;var or,oT,ok=0;for(ok=0,or=this._children.length;ok<or;ok++)if(oT=this._children[ok].findBone(oo))return oT;return null},oo.localToWorld=function(oo){var or=oo[0],oT=oo[1];oo[0]=or*this.resultMatrix.a+oT*this.resultMatrix.c+this.resultMatrix.tx,oo[1]=or*this.resultMatrix.b+oT*this.resultMatrix.d+this.resultMatrix.ty},oW.ShowBones={},oW}()),oCo=function(){function oj(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}ok(oj,"laya.ani.bone.BoneSlot");var oo=oj.prototype;return oo.showSlotData=function(oo,or){void 0===or&&(or=!0),this.currSlotData=oo,or&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},oo.showDisplayByName=function(oo){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(oo))},oo.replaceDisplayByName=function(oo,or){if(this.currSlotData){var oT;oT=this.currSlotData.getDisplayByName(oo);var ok;ok=this.currSlotData.getDisplayByName(or),this.replaceDisplayByIndex(oT,ok)}},oo.replaceDisplayByIndex=function(oo,or){this.currSlotData&&(this._replaceDic[oo]=or,this.displayIndex==oo&&this.showDisplayByIndex(oo))},oo.showDisplayByIndex=function(oo){if(null!=this._replaceDic[oo]&&(oo=this._replaceDic[oo]),this.currSlotData&&-1<oo&&oo<this.currSlotData.displayArr.length){if(this.displayIndex=oo,this.currDisplayData=this.currSlotData.displayArr[oo],this.currDisplayData){var or=this.currDisplayData.name;this.currTexture=this.templet.getTexture(or),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!o_.isConchApp||o_.isConchApp&&"0.9.15"<oDo.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},oo.replaceSkin=function(oo){this._diyTexture=oo,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},oo.setParentMatrix=function(oo){this._parentMatrix=oo},oo.draw=function(oo,or,oT,ok){if(void 0===oT&&(oT=!1),void 0===ok&&(ok=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var oW,oD=this.currTexture;switch(this._diyTexture&&(oD=this._diyTexture),this.currDisplayData.type){case 0:if(oo){var on=this.getDisplayMatrix();if(this._parentMatrix){var oV=!1;if(on){var oL;if(oso.mul(on,this._parentMatrix,oso.TEMP),oL=oT?(null==this._resultMatrix&&(this._resultMatrix=new oso),this._resultMatrix):new oso,!o_.isWebGL&&this.currDisplayData.uvs||o_.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var oU=oj._tempMatrix;oU.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(oU.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(oV=!0,oU.rotate(-Math.PI/2)),oso.mul(oU,oso.TEMP,oL)}else oso.TEMP.copyTo(oL);oV?oo.drawTexture(oD,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,oL):oo.drawTexture(oD,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,oL)}}}break;case 1:if(null==(oW=oT?(null==this._skinSprite&&(this._skinSprite=oj.createSkinMesh()),this._skinSprite):oj.createSkinMesh()))return;var oh;if(null==this.currDisplayData.bones){var op,oi=this.currDisplayData.weights;this.deformData&&(oi=this.deformData),op=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=ob.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=ob.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=oi;this.currDisplayData.triangles.length;oh=this.currDisplayData.triangles,oW.init2(oD,null,oh,this._mVerticleArr,op);var ov,ox=this.getDisplayMatrix();if(this._parentMatrix)if(ox)oso.mul(ox,this._parentMatrix,oso.TEMP),ov=oT?(null==this._resultMatrix&&(this._resultMatrix=new oso),this._resultMatrix):new oso,oso.TEMP.copyTo(ov),oW.transform=ov}else this.skinMesh(or,oW,ok);oo.drawSkin(oW);break;case 2:if(null==(oW=oT?(null==this._skinSprite&&(this._skinSprite=oj.createSkinMesh()),this._skinSprite):oj.createSkinMesh()))return;this.skinMesh(or,oW,ok),oo.drawSkin(oW)}}},oo.skinMesh=function(oo,or,oT){var ok,oW=this.currTexture,oD=this.currDisplayData.bones;ok=this._diyTexture?(oW=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=ob.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=ob.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var on,oV,oL=this.currDisplayData.weights,oU=this.currDisplayData.triangles,oh=0,op=0,oi=0,ov=NaN,ox=NaN,oj=0,o_=0,oK=[],o$=0,oy=0;if(this.deformData&&0<this.deformData.length){var ol=0;for(o$=0,oy=oD.length;o$<oy;){for(oi=oD[o$++]+o$,op=oh=0;o$<oi;o$++)oV=oo[oD[o$]],ov=oL[oj]+this.deformData[ol++],ox=oL[oj+1]+this.deformData[ol++],o_=oL[oj+2],oh+=(ov*oV.a+ox*oV.c+oV.tx)*o_,op+=(ov*oV.b+ox*oV.d+oV.ty)*o_,oj+=3;oK.push(oh,op)}}else for(o$=0,oy=oD.length;o$<oy;){for(oi=oD[o$++]+o$,op=oh=0;o$<oi;o$++)oV=oo[oD[o$]],ov=oL[oj],ox=oL[oj+1],o_=oL[oj+2],oh+=(ov*oV.a+ox*oV.c+oV.tx)*o_,op+=(ov*oV.b+ox*oV.d+oV.ty)*o_,oj+=3;oK.push(oh,op)}this._mVerticleArr=oK,on=oU,or.init2(oW,null,on,this._mVerticleArr,ok)},oo.drawBonePoint=function(oo){oo&&this._parentMatrix&&oo.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},oo.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},oo.getMatrix=function(){return this._resultMatrix},oo.copy=function(){var oo=new oj;return oo.type="copy",oo.name=this.name,oo.attachmentName=this.attachmentName,oo.srcDisplayIndex=this.srcDisplayIndex,oo.parent=this.parent,oo.displayIndex=this.displayIndex,oo.templet=this.templet,oo.currSlotData=this.currSlotData,oo.currTexture=this.currTexture,oo.currDisplayData=this.currDisplayData,oo},oj.createSkinMesh=function(){return o_.isWebGL||o_.isConchApp?ov.skinAniSprite():(o_.isWebGL,null)},oT(oj,["_tempMatrix",function(){return this._tempMatrix=new oso}]),oj}(),oXo=function(){function oo(){this.skinName=null,this.deformSlotDataList=[]}return ok(oo,"laya.ani.bone.DeformAniData"),oo}(),oOo=function(){function oo(){this.deformSlotDisplayList=[]}return ok(oo,"laya.ani.bone.DeformSlotData"),oo}(),oMo=function(){function oo(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}ok(oo,"laya.ani.bone.DeformSlotDisplayData");var or=oo.prototype;return or.binarySearch1=function(oo,or){var oT=0,ok=oo.length-2;if(0==ok)return 1;for(var oW=ok>>>1;;){if(oo[Math.floor(oW+1)]<=or?oT=oW+1:ok=oW,oT==ok)return oT+1;oW=oT+ok>>>1}return 0},or.apply=function(oo,or,oT){if(void 0===oT&&(oT=1),oo+=.05,!(this.timeList.length<=0)){var ok=0;if(!(oo<this.timeList[0])){var oW=this.vectices[0].length,oD=[],on=this.binarySearch1(this.timeList,oo);if(this.frameIndex=on,oo>=this.timeList[this.timeList.length-1]){var oV=this.vectices[this.vectices.length-1];if(oT<1)for(ok=0;ok<oW;ok++)oD[ok]+=(oV[ok]-oD[ok])*oT;else for(ok=0;ok<oW;ok++)oD[ok]=oV[ok];this.deformData=oD}else{this.tweenKeyList[this.frameIndex];var oL=this.vectices[this.frameIndex-1],oU=this.vectices[this.frameIndex],oh=this.timeList[this.frameIndex-1],op=this.timeList[this.frameIndex];oT=this.tweenKeyList[on-1]?(oo-oh)/(op-oh):0;var oi=NaN;for(ok=0;ok<oW;ok++)oi=oL[ok],oD[ok]=oi+(oU[ok]-oi)*oT;this.deformData=oD}}}},oo}(),oco=function(){function oo(){this.time=NaN,this.drawOrder=[]}return ok(oo,"laya.ani.bone.DrawOrderData"),oo}(),oeo=function(){function oo(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return ok(oo,"laya.ani.bone.EventData"),oo}(),o$=function(){function oko(oo,or){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=oo,this._targetBone=or[oo.targetBoneIndex],this.isSpine=oo.isSpine,null==this._bones&&(this._bones=[]);for(var oT=this._bones.length=0,ok=oo.boneIndexs.length;oT<ok;oT++)this._bones.push(or[oo.boneIndexs[oT]]);this.name=oo.name,this.mix=oo.mix,this.bendDirection=oo.bendDirection}ok(oko,"laya.ani.bone.IkConstraint");var oo=oko.prototype;return oo.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},oo._applyIk1=function(oo,or,oT,ok){var oW=oo.parentBone,oD=1/(oW.resultMatrix.a*oW.resultMatrix.d-oW.resultMatrix.b*oW.resultMatrix.c),on=or-oW.resultMatrix.tx,oV=oT-oW.resultMatrix.ty,oL=(on*oW.resultMatrix.d-oV*oW.resultMatrix.c)*oD-oo.transform.x,oU=(oV*oW.resultMatrix.a-on*oW.resultMatrix.b)*oD-oo.transform.y,oh=Math.atan2(oU,oL)*oko.radDeg-0-oo.transform.skX;oo.transform.scX<0&&(oh+=180),180<oh?oh-=360:oh<-180&&(oh+=360),oo.transform.skX=oo.transform.skY=oo.transform.skX+oh*ok,oo.update()},oo.updatePos=function(oo,or){this._sp&&this._sp.pos(oo,or)},oo._applyIk2=function(oo,or,oT,ok,oW,oD){if(0!=oD){var on=oo.resultTransform.x,oV=oo.resultTransform.y,oL=oo.transform.scX,oU=oo.transform.scY,oh=or.transform.scX,op=0,oi=0,ov=0;ov=oL<0?(oL=-oL,op=180,-1):(op=0,1),oU<0&&(oU=-oU,ov=-ov),oi=oh<0?(oh=-oh,180):0;var ox=or.resultTransform.x,oj=NaN,o_=NaN,oK=NaN,o$=oo.resultMatrix.a,oy=oo.resultMatrix.c,ol=oo.resultMatrix.b,oS=oo.resultMatrix.d,oq=Math.abs(oL-oU)<=1e-4;oK=oq?(o_=o$*ox+oy*(oj=or.resultTransform.y)+oo.resultMatrix.tx,ol*ox+oS*oj+oo.resultMatrix.ty):(oj=0,o_=o$*ox+oo.resultMatrix.tx,ol*ox+oo.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new oDo,oWo.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(oT,ok,15,"#ffff00"),this._sp.graphics.drawCircle(o_,oK,15,"#ff00ff")),oo.setRotation(Math.atan2(oK-oo.resultMatrix.ty,o_-oo.resultMatrix.tx));var ob=oo.parentBone;o$=ob.resultMatrix.a,oy=ob.resultMatrix.c,ol=ob.resultMatrix.b;var oF=1/(o$*(oS=ob.resultMatrix.d)-oy*ol),oP=oT-ob.resultMatrix.tx,ot=ok-ob.resultMatrix.ty,oH=(oP*oS-ot*oy)*oF-on,oR=(ot*o$-oP*ol)*oF-oV,ou=((oP=o_-ob.resultMatrix.tx)*oS-(ot=oK-ob.resultMatrix.ty)*oy)*oF-on,os=(ot*o$-oP*ol)*oF-oV,oz=Math.sqrt(ou*ou+os*os),om=or.length*oh,oC=NaN,oX=NaN;if(oq){var oO=(oH*oH+oR*oR-oz*oz-(om*=oL)*om)/(2*oz*om);oO<-1?oO=-1:1<oO&&(oO=1),oX=Math.acos(oO)*oW,o$=oz+om*oO,oy=om*Math.sin(oX),oC=Math.atan2(oR*o$-oH*oy,oH*o$+oR*oy)}else{var oM=(o$=oL*om)*o$,oc=(oy=oU*om)*oy,oe=oH*oH+oR*oR,oJ=Math.atan2(oR,oH),oY=-2*oc*oz,oA=oc-oM;if(0<(oS=oY*oY-4*oA*(ol=oc*oz*oz+oM*oe-oM*oc))){var oI=Math.sqrt(oS);oY<0&&(oI=-oI);var oN=(oI=-(oY+oI)/2)/oA,of=ol/oI,oa=Math.abs(oN)<Math.abs(of)?oN:of;oa*oa<=oe&&(ot=Math.sqrt(oe-oa*oa)*oW,oC=oJ-Math.atan2(ot,oa),oX=Math.atan2(ot/oU,(oa-oz)/oL))}var oG=0,ow=Number.MAX_VALUE,oZ=0,oQ=0,og=0,oB=0,oE=0,od=0;oB<(oS=(oP=oz+o$)*oP)&&(og=0,oB=oS,oE=oP),(oS=(oP=oz-o$)*oP)<ow&&(oG=Math.PI,ow=oS,oZ=oP);var ooo=Math.acos(-o$*oz/(oM-oc));(oS=(oP=o$*Math.cos(ooo)+oz)*oP+(ot=oy*Math.sin(ooo))*ot)<ow&&(oG=ooo,ow=oS,oZ=oP,oQ=ot),oB<oS&&(og=ooo,oB=oS,oE=oP,od=ot),oX=oe<=(ow+oB)/2?(oC=oJ-Math.atan2(oQ*oW,oZ),oG*oW):(oC=oJ-Math.atan2(od*oW,oE),og*oW)}var oro=Math.atan2(oj,ox)*ov,oTo=oo.resultTransform.skX;180<(oC=(oC-oro)*oko.radDeg+op-oTo)?oC-=360:oC<-180&&(oC+=360),oo.resultTransform.x=on,oo.resultTransform.y=oV,oo.resultTransform.skX=oo.resultTransform.skY=oTo+oC*oD,oTo=or.resultTransform.skX,180<(oX=((oX+oro)*oko.radDeg-0)*ov+oi-(oTo%=360))?oX-=360:oX<-180&&(oX+=360),or.resultTransform.x=ox,or.resultTransform.y=oj,or.resultTransform.skX=or.resultTransform.skY=or.resultTransform.skY+oX*oD,oo.update()}},oo._applyIk3=function(oo,or,oT,ok,oW,oD){if(0!=oD){var on,oV,oL=or.resultMatrix.a*or.length,oU=or.resultMatrix.b*or.length,oh=oL*oL+oU*oU,op=Math.sqrt(oh),oi=oo.resultMatrix.tx,ov=oo.resultMatrix.ty,ox=or.resultMatrix.tx,oj=or.resultMatrix.ty,o_=ox-oi,oK=oj-ov,o$=o_*o_+oK*oK,oy=Math.sqrt(o$),ol=(o_=oT-oo.resultMatrix.tx)*o_+(oK=ok-oo.resultMatrix.ty)*oK,oS=Math.sqrt(ol);if(op+oy<=oS||oS+op<=oy||oS+oy<=op){var oq=NaN;ox=oi+(oq=op+oy<=oS?1:-1)*(oT-oi)*oy/oS,oj=ov+oq*(ok-ov)*oy/oS}else{var ob=(o$-oh+ol)/(2*ol),oF=Math.sqrt(o$-ob*ob*ol)/oS,oP=oi+o_*ob,ot=ov+oK*ob,oH=-oK*oF,oR=o_*oF;oj=0<oW?(ox=oP-oH,ot-oR):(ox=oP+oH,ot+oR)}on=ox,oV=oj,this.isDebug&&(this._sp||(this._sp=new oDo,oWo.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(oi,ov,15,"#ff00ff"),this._sp.graphics.drawCircle(oT,ok,15,"#ffff00"),this._sp.graphics.drawCircle(on,oV,15,"#ff00ff"));var ou,os;ou=Math.atan2(oV-oo.resultMatrix.ty,on-oo.resultMatrix.tx),oo.setRotation(ou),(os=oko._tempMatrix).identity(),os.rotate(ou),os.scale(oo.resultMatrix.getScaleX(),oo.resultMatrix.getScaleY()),os.translate(oo.resultMatrix.tx,oo.resultMatrix.ty),os.copyTo(oo.resultMatrix),oo.updateChild();var oz,om;oz=Math.atan2(ok-oV,oT-on),or.setRotation(oz),(om=oko._tempMatrix).identity(),om.rotate(oz),om.scale(or.resultMatrix.getScaleX(),or.resultMatrix.getScaleY()),om.translate(on,oV),os.copyTo(or.resultMatrix),or.updateChild()}},oT(oko,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new oso}]),oko}(),oJo=function(){function oo(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return ok(oo,"laya.ani.bone.IkConstraintData"),oo}(),oS=function(){function om(oo,or){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=oo,this.position=oo.position,this.spacing=oo.spacing,this.rotateMix=oo.rotateMix,this.translateMix=oo.translateMix,this.bones=[];for(var oT=this.data.bones,ok=0,oW=oT.length;ok<oW;ok++)this.bones.push(or[oT[ok]])}ok(om,"laya.ani.bone.PathConstraint");var oo=om.prototype;return oo.apply=function(oo,or){if(this.target){var oT=this.translateMix,ok=this.translateMix,oW=0<ok,oD=this.data.spacingMode,on="length"==oD,oV=this.data.rotateMode,oL="tangent"==oV,oU="chainScale"==oV,oh=[],op=this.bones.length,oi=oL?op:op+1,ov=[];(this._spaces=ov)[0]=this.position;var ox=this.spacing;if(oU||on)for(var oj=0,o_=oi-1;oj<o_;){var oK=this.bones[oj],o$=oK.length,oy=o$*oK.resultMatrix.a,ol=o$*oK.resultMatrix.b;o$=Math.sqrt(oy*oy+ol*ol),oU&&(oh[oj]=o$),ov[++oj]=on?Math.max(0,o$+ox):ox}else for(oj=1;oj<oi;oj++)ov[oj]=ox;var oS=this.computeWorldPositions(this.target,oo,or,oi,oL,"percent"==this.data.positionMode,"percent"==oD);if(this._debugKey){for(oj=0;oj<oS.length;oj++)or.drawCircle(oS[oj++],oS[oj++],5,"#00ff00");var oq=[];for(oj=0;oj<oS.length;oj++)oq.push(oS[oj++],oS[oj++]);or.drawLines(0,0,oq,"#ff0000")}var ob=oS[0],oF=oS[1],oP=this.data.offsetRotation,ot="chain"==oV&&0==oP,oH=NaN;for(oj=0,oH=3;oj<op;oj++,oH+=3){(oK=this.bones[oj]).resultMatrix.tx+=(ob-oK.resultMatrix.tx)*oT,oK.resultMatrix.ty+=(oF-oK.resultMatrix.ty)*oT;var oR=(oy=oS[oH])-ob,ou=(ol=oS[oH+1])-oF;if(oU&&0!=(o$=oh[oj])){var os=(Math.sqrt(oR*oR+ou*ou)/o$-1)*ok+1;oK.resultMatrix.a*=os,oK.resultMatrix.c*=os}if(ob=oy,oF=ol,oW){var oz=oK.resultMatrix.a,om=oK.resultMatrix.c,oC=oK.resultMatrix.b,oX=oK.resultMatrix.d,oO=NaN,oM=NaN,oc=NaN;oO=oL?oS[oH-1]:0==ov[oj+1]?oS[oH+2]:Math.atan2(ou,oR),oO-=Math.atan2(oC,oz)-oP/180*Math.PI,ot&&(oM=Math.cos(oO),oc=Math.sin(oO),ob+=((o$=oK.length)*(oM*oz-oc*oC)-oR)*ok,oF+=(o$*(oc*oz+oM*oC)-ou)*ok),oO>Math.PI?oO-=2*Math.PI:oO<-Math.PI&&(oO+=2*Math.PI),oO*=ok,oM=Math.cos(oO),oc=Math.sin(oO),oK.resultMatrix.a=oM*oz-oc*oC,oK.resultMatrix.c=oM*om-oc*oX,oK.resultMatrix.b=oc*oz+oM*oC,oK.resultMatrix.d=oc*om+oM*oX}}}},oo.computeWorldVertices2=function(oo,or,oT,ok,oW,oD){var on,oV,oL=oo.currDisplayData.bones,oU=oo.currDisplayData.weights,oh=oo.currDisplayData.triangles,op=0,oi=0,ov=0,ox=0,oj=0,o_=0,oK=0,o$=0,oy=0,ol=0,oS=0;if(null!=oL){for(op=0;op<oT;op+=2)oi+=(ox=oL[oi])+1,ov+=ox;var oq=or;for(oj=oD,o_=3*ov;oj<ok;oj+=2){for(o$=oK=0,ox=oL[oi++],ox+=oi;oi<ox;oi++,o_+=3){on=oq[oL[oi]].resultMatrix,oy=oU[o_],ol=oU[o_+1];var ob=oU[o_+2];oK+=(oy*on.a+ol*on.c+on.tx)*ob,o$+=(oy*on.b+ol*on.d+on.ty)*ob}oW[oj]=oK,oW[oj+1]=o$}}else{var oF,oP;if(oh||(oh=oU),oo.deformData&&(oh=oo.deformData),oF=oo.parent,or)for(oS=or.length,op=0;op<oS;op++)if(or[op].name==oF){oV=or[op];break}oV&&(oP=oV.resultMatrix),oP||(oP=om._tempMt);var ot=oP.tx,oH=oP.ty,oR=oP.a,ou=oP.b,os=oP.c,oz=oP.d;for(oV&&(oz*=oV.d),oi=oT,oj=oD;oj<ok;oi+=2,oj+=2)oy=oh[oi],ol=oh[oi+1],oW[oj]=oy*oR+ol*ou+ot,oW[oj+1]=-(oy*os+ol*oz+oH)}},oo.computeWorldPositions=function(oo,or,oT,ok,oW,oD,on){oo.currDisplayData.bones,oo.currDisplayData.weights,oo.currDisplayData.triangles;var oV=[],oL=0,oU=oo.currDisplayData.verLen,oh=this.position,op=this._spaces,oi=[],ov=[],ox=oU/6,oj=-1,o_=NaN,oK=0,o$=0,oy=NaN,ol=NaN,oS=NaN,oq=NaN;if(ox--,oU-=4,this.computeWorldVertices2(oo,or,2,oU,oV,0),this._debugKey)for(oL=0;oL<oV.length;)oT.drawCircle(oV[oL++],oV[oL++],10,"#ff0000");oi=oV,this._curves.length=ox;var ob=this._curves,oF=oi[o_=0],oP=oi[1],ot=0,oH=0,oR=0,ou=0,os=0,oz=0,om=NaN,oC=NaN,oX=NaN,oO=NaN,oM=NaN,oc=NaN,oe=NaN,oJ=NaN,oY=0;for(oL=0,oY=2;oL<ox;oL++,oY+=6)ot=oi[oY],oH=oi[oY+1],oR=oi[oY+2],ou=oi[oY+3],oM=2*(om=.1875*(oF-2*ot+oR))+(oX=.09375*(3*(ot-oR)-oF+(os=oi[oY+4]))),oc=2*(oC=.1875*(oP-2*oH+ou))+(oO=.09375*(3*(oH-ou)-oP+(oz=oi[oY+5]))),oe=.75*(ot-oF)+om+.16666667*oX,oJ=.75*(oH-oP)+oC+.16666667*oO,o_+=Math.sqrt(oe*oe+oJ*oJ),oe+=oM,oJ+=oc,oM+=oX,oc+=oO,o_+=Math.sqrt(oe*oe+oJ*oJ),oe+=oM,oJ+=oc,o_+=Math.sqrt(oe*oe+oJ*oJ),oe+=oM+oX,oJ+=oc+oO,o_+=Math.sqrt(oe*oe+oJ*oJ),ob[oL]=o_,oF=os,oP=oz;if(oD&&(oh*=o_),on)for(oL=0;oL<ok;oL++)op[oL]*=o_;var oA=this._segments,oI=0,oN=0;for(oN=o$=oK=oL=0;oL<ok;oL++,oK+=3)if((oy=oh+=ol=op[oL])<0)this.addBeforePosition(oy,oi,0,ov,oK);else if(o_<oy)this.addAfterPosition(oy-o_,oi,oU-4,ov,oK);else{for(;;o$++)if(!((oq=ob[o$])<oy)){0==o$?oy/=oq:oy=(oy-(oS=ob[o$-1]))/(oq-oS);break}if(o$!=oj){var of=6*(oj=o$);for(oF=oi[of],oP=oi[of+1],ot=oi[of+2],oH=oi[of+3],oR=oi[of+4],ou=oi[of+5],oM=2*(om=.03*(oF-2*ot+oR))+(oX=.006*(3*(ot-oR)-oF+(os=oi[of+6]))),oc=2*(oC=.03*(oP-2*oH+ou))+(oO=.006*(3*(oH-ou)-oP+(oz=oi[of+7]))),oe=.3*(ot-oF)+om+.16666667*oX,oJ=.3*(oH-oP)+oC+.16666667*oO,oI=Math.sqrt(oe*oe+oJ*oJ),oA[0]=oI,of=1;of<8;of++)oe+=oM,oJ+=oc,oM+=oX,oc+=oO,oI+=Math.sqrt(oe*oe+oJ*oJ),oA[of]=oI;oe+=oM,oJ+=oc,oI+=Math.sqrt(oe*oe+oJ*oJ),oA[8]=oI,oe+=oM+oX,oJ+=oc+oO,oI+=Math.sqrt(oe*oe+oJ*oJ),oA[9]=oI,oN=0}for(oy*=oI;;oN++)if(!((oq=oA[oN])<oy)){0==oN?oy/=oq:oy=oN+(oy-(oS=oA[oN-1]))/(oq-oS);break}this.addCurvePosition(.1*oy,oF,oP,ot,oH,oR,ou,os,oz,ov,oK,oW||0<oL&&0==ol)}return ov},oo.addBeforePosition=function(oo,or,oT,ok,oW){var oD=or[oT],on=or[oT+1],oV=or[oT+2]-oD,oL=or[oT+3]-on,oU=Math.atan2(oL,oV);ok[oW]=oD+oo*Math.cos(oU),ok[oW+1]=on+oo*Math.sin(oU),ok[oW+2]=oU},oo.addAfterPosition=function(oo,or,oT,ok,oW){var oD=or[oT+2],on=or[oT+3],oV=oD-or[oT],oL=on-or[oT+1],oU=Math.atan2(oL,oV);ok[oW]=oD+oo*Math.cos(oU),ok[oW+1]=on+oo*Math.sin(oU),ok[oW+2]=oU},oo.addCurvePosition=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh,op){0==oo&&(oo=1e-4);var oi=oo*oo,ov=oi*oo,ox=1-oo,oj=ox*ox,o_=oj*ox,oK=ox*oo,o$=3*oK,oy=ox*o$,ol=o$*oo,oS=or*o_+ok*oy+oD*ol+oV*ov,oq=oT*o_+oW*oy+on*ol+oL*ov;oU[oh]=oS,oU[oh+1]=oq,oU[oh+2]=op?Math.atan2(oq-(oT*oj+oW*oK*2+on*oi),oS-(or*oj+ok*oK*2+oD*oi)):0},om.NONE=-1,om.BEFORE=-2,om.AFTER=-3,oT(om,["_tempMt",function(){return this._tempMt=new oso}]),om}(),oYo=function(){function oo(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return ok(oo,"laya.ani.bone.PathConstraintData"),oo}(),oAo=function(){function oo(){this.name=null,this.slotArr=[]}return ok(oo,"laya.ani.bone.SkinData"),oo}(),oIo=function(){function oo(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}ok(oo,"laya.ani.bone.SkinSlotDisplayData");var or=oo.prototype;return or.createTexture=function(oo){return this.texture||(this.texture=new ozo(oo.bitmap,this.uvs),oo.bitmap.alphaTexture&&(this.texture.alphaTexture=new ozo(oo.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=oo.height,this.texture.height=oo.width,this.texture.offsetX=-oo.offsetX,this.texture.offsetY=-oo.offsetY,this.texture.sourceWidth=oo.sourceHeight,this.texture.sourceHeight=oo.sourceWidth):(this.texture.width=oo.width,this.texture.height=oo.height,this.texture.offsetX=-oo.offsetX,this.texture.offsetY=-oo.offsetY,this.texture.sourceWidth=oo.sourceWidth,this.texture.sourceHeight=oo.sourceHeight),o_.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},or.destory=function(){this.texture&&this.texture.destroy()},oo}(),oNo=function(){function oo(){this.name=null,this.displayArr=[]}return ok(oo,"laya.ani.bone.SlotData"),oo.prototype.getDisplayByName=function(oo){for(var or=0,oT=this.displayArr.length;or<oT;or++)if(this.displayArr[or].attachmentName==oo)return or;return-1},oo}(),oq=function(){function oo(oo,or){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=oj(2,0),this._data=oo,null==this._bones&&(this._bones=[]),this.target=or[oo.targetIndex];var oT,ok=0;for(ok=0,oT=oo.boneIndexs.length;ok<oT;ok++)this._bones.push(or[oo.boneIndexs[ok]]);this.rotateMix=oo.rotateMix,this.translateMix=oo.translateMix,this.scaleMix=oo.scaleMix,this.shearMix=oo.shearMix}return ok(oo,"laya.ani.bone.TfConstraint"),oo.prototype.apply=function(){for(var oo,or=this.target.resultMatrix.a,oT=this.target.resultMatrix.b,ok=this.target.resultMatrix.c,oW=this.target.resultMatrix.d,oD=0,on=this._bones.length;oD<on;oD++){if(oo=this._bones[oD],0<this.rotateMix){var oV=oo.resultMatrix.a,oL=oo.resultMatrix.b,oU=oo.resultMatrix.c,oh=oo.resultMatrix.d,op=Math.atan2(ok,or)-Math.atan2(oU,oV)+this._data.offsetRotation*Math.PI/180;op>Math.PI?op-=2*Math.PI:op<-Math.PI&&(op+=2*Math.PI),op*=this.rotateMix;var oi=Math.cos(op),ov=Math.sin(op);oo.resultMatrix.a=oi*oV-ov*oU,oo.resultMatrix.b=oi*oL-ov*oh,oo.resultMatrix.c=ov*oV+oi*oU,oo.resultMatrix.d=ov*oL+oi*oh}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),oo.resultMatrix.tx+=(this._temp[0]-oo.resultMatrix.tx)*this.translateMix,oo.resultMatrix.ty+=(this._temp[1]-oo.resultMatrix.ty)*this.translateMix,oo.updateChild()),0<this.scaleMix){var ox=Math.sqrt(oo.resultMatrix.a*oo.resultMatrix.a+oo.resultMatrix.c*oo.resultMatrix.c),oj=Math.sqrt(or*or+ok*ok),o_=1e-5<ox?(ox+(oj-ox+this._data.offsetScaleX)*this.scaleMix)/ox:0;oo.resultMatrix.a*=o_,oo.resultMatrix.c*=o_,ox=Math.sqrt(oo.resultMatrix.b*oo.resultMatrix.b+oo.resultMatrix.d*oo.resultMatrix.d),oj=Math.sqrt(oT*oT+oW*oW),o_=1e-5<ox?(ox+(oj-ox+this._data.offsetScaleY)*this.scaleMix)/ox:0,oo.resultMatrix.b*=o_,oo.resultMatrix.d*=o_}if(0<this.shearMix){oL=oo.resultMatrix.b,oh=oo.resultMatrix.d;var oK=Math.atan2(oh,oL);(op=Math.atan2(oW,oT)-Math.atan2(ok,or)-(oK-Math.atan2(oo.resultMatrix.c,oo.resultMatrix.a)))>Math.PI?op-=2*Math.PI:op<-Math.PI&&(op+=2*Math.PI),op=oK+(op+this._data.offsetShearY*Math.PI/180)*this.shearMix,o_=Math.sqrt(oL*oL+oh*oh),oo.resultMatrix.b=Math.cos(op)*o_,oo.resultMatrix.d=Math.sin(op)*o_}}},oo}(),ofo=function(){function oo(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return ok(oo,"laya.ani.bone.TfConstraintData"),oo}(),oao=function(){function oo(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}ok(oo,"laya.ani.bone.Transform");var or=oo.prototype;return or.initData=function(oo){null!=oo.x&&(this.x=oo.x),null!=oo.y&&(this.y=oo.y),null!=oo.skX&&(this.skX=oo.skX),null!=oo.skY&&(this.skY=oo.skY),null!=oo.scX&&(this.scX=oo.scX),null!=oo.scY&&(this.scY=oo.scY)},or.getMatrix=function(){var oo;return(oo=this.mMatrix?this.mMatrix:this.mMatrix=new oso).identity(),oo.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(oo,this.skewX*Math.PI/180,this.skewY*Math.PI/180),oo.rotate(this.skX*Math.PI/180),oo.translate(this.x,this.y),oo},or.skew=function(oo,or,oT){var ok=Math.sin(oT),oW=Math.cos(oT),oD=Math.sin(or),on=Math.cos(or);return oo.setTo(oo.a*on-oo.b*ok,oo.a*oD+oo.b*oW,oo.c*on-oo.d*ok,oo.c*oD+oo.d*oW,oo.tx*on-oo.ty*ok,oo.tx*oD+oo.ty*oW),oo},oo}(),ob=function(){function oo(){}return ok(oo,"laya.ani.bone.UVTools"),oo.getRelativeUV=function(oo,or,oT){var ok=oo[0],oW=oo[2]-oo[0],oD=oo[1],on=oo[5]-oo[1];oT||(oT=[]),oT.length=or.length;var oV,oL=0;oV=oT.length;var oU=1/oW,oh=1/on;for(oL=0;oL<oV;oL+=2)oT[oL]=(or[oL]-ok)*oU,oT[oL+1]=(or[oL+1]-oD)*oh;return oT},oo.getAbsoluteUV=function(oo,or,oT){if(0==oo[0]&&0==oo[1]&&1==oo[4]&&1==oo[5])return oT?(oK.copyArray(oT,or),oT):or;var ok=oo[0],oW=oo[2]-oo[0],oD=oo[1],on=oo[5]-oo[1];oT||(oT=[]),oT.length=or.length;var oV,oL=0;for(oV=oT.length,oL=0;oL<oV;oL+=2)oT[oL]=or[oL]*oW+ok,oT[oL+1]=or[oL+1]*on+oD;return oT},oo}(),om=function(){function oo(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return ok(oo,"laya.ani.KeyFramesContent"),oo}(),oF=function(){function oh(){}return ok(oh,"laya.ani.math.BezierLerp"),oh.getBezierRate=function(oo,or,oT,ok,oW){var oD=oh._getBezierParamKey(or,oT,ok,oW),on=100*oD+oo;if(oh._bezierResultCache[on])return oh._bezierResultCache[on];var oV,oL=oh._getBezierPoints(or,oT,ok,oW,oD),oU=0;for(oV=oL.length,oU=0;oU<oV;oU+=2)if(oo<=oL[oU])return oh._bezierResultCache[on]=oL[oU+1],oL[oU+1];return oh._bezierResultCache[on]=1},oh._getBezierParamKey=function(oo,or,oT,ok){return 100*(100*(100*(100*oo+or)+oT)+ok)},oh._getBezierPoints=function(oo,or,oT,ok,oW){return oh._bezierPointsCache[oW]?oh._bezierPointsCache[oW]:(oD=[0,0,oo,or,oT,ok,1,1],on=(new oV).getBezierPoints(oD,100,3),oh._bezierPointsCache[oW]=on);var oD,on},oh._bezierResultCache={},oh._bezierPointsCache={},oh}(),oP=function(oo){function or(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,or.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}ok(or,"laya.ani.AnimationPlayer",oW);var oT=or.prototype;return oWo.imps(oT,{"laya.resource.IDestroy":!0}),oT._onTempletLoadedComputeFullKeyframeIndices=function(oo,or,oT){this._templet===oT&&this._cachePlayRate===oo&&this._cacheFrameRate===or&&this._computeFullKeyframeIndices()},oT._computeFullKeyframeIndices=function(){for(var oo=this._fullFrames=[],or=this._templet,oT=this._cacheFrameRateInterval*this._cachePlayRate,ok=0,oW=or.getAnimationCount();ok<oW;ok++){for(var oD=[],on=0,oV=or.getAnimation(ok).nodes.length;on<oV;on++){for(var oL=or.getAnimation(ok).nodes[on],oU=Math.floor(oL.playTime/oT+.01),oh=new Uint16Array(oU+1),op=-1,oi=0,ov=oL.keyFrame.length;oi<ov;oi++){var ox=oL.keyFrame[oi],oj=ox.startTime,o_=oj+ox.duration+oT;do{for(var oK=Math.floor(oj/oT+.5),o$=op+1;o$<oK;o$++)oh[o$]=oi;oh[op=oK]=oi,oj+=oT}while(oj<=o_)}oD.push(oh)}oo.push(oD)}},oT._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},oT._calculatePlayDuration=function(){if(0!==this.state){var oo=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=oo),this._playEnd>oo&&(this._playEnd=oo),this._playDuration=this._playEnd-this._playStart}},oT._setPlayParams=function(oo,or){this._currentTime=oo,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/or+.01),0),this._currentFrameTime=this._currentKeyframeIndex*or},oT._setPlayParamsWhenStop=function(oo,or){this._currentTime=oo,this._currentKeyframeIndex=Math.max(Math.floor(oo/or+.01),0),this._currentFrameTime=this._currentKeyframeIndex*or,this._currentAnimationClipIndex=-1},oT._update=function(oo){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var or=this._cacheFrameRateInterval*this._cachePlayRate,oT=0;this._startUpdateLoopCount!==ox.loopCount&&(oT=oo*this.playbackRate,this._elapsedPlaybackTime+=oT);var ok=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=ok)return this._setPlayParamsWhenStop(ok,or),void this.event("stopped");if(oT+=this._currentTime,0<ok)if(ok<=oT)do{if(oT-=ok,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(ok,or),this._stopWhenCircleFinish=!1,void this.event("stopped");oT<ok&&(this._setPlayParams(oT,or),this.event("complete"))}while(ok<=oT);else this._setPlayParams(oT,or);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(ok,or),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},oT._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},oT.play=function(oo,or,oT,ok,oW){if(void 0===oo&&(oo=0),void 0===or&&(or=1),void 0===oT&&(oT=2147483647),void 0===ok&&(ok=0),void 0===oW&&(oW=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(oT<0||ok<0||oW<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==oW&&oW<ok)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=or,this._overallDuration=oT,this._playStart=ok,this._playEnd=oW,this._paused=!1,this._currentAnimationClipIndex=oo,this._currentKeyframeIndex=0,this._startUpdateLoopCount=ox.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},oT.playByFrame=function(oo,or,oT,ok,oW,oD){void 0===oo&&(oo=0),void 0===or&&(or=1),void 0===oT&&(oT=2147483647),void 0===ok&&(ok=0),void 0===oW&&(oW=0),void 0===oD&&(oD=30);var on=1e3/oD;this.play(oo,or,oT,ok*on,oW*on)},oT.stop=function(oo){void 0===oo&&(oo=!0),oo?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},oD(0,oT,"playEnd",function(){return this._playEnd}),oD(0,oT,"templet",function(){return this._templet},function(oo){0===!this.state&&this.stop(!0),this._templet!==oo&&((this._templet=oo).loaded?this._computeFullKeyframeIndices():oo.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),oD(0,oT,"playStart",function(){return this._playStart}),oD(0,oT,"playDuration",function(){return this._playDuration}),oD(0,oT,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),oD(0,oT,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),oD(0,oT,"overallDuration",function(){return this._overallDuration}),oD(0,oT,"currentFrameTime",function(){return this._currentFrameTime}),oD(0,oT,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),oD(0,oT,"currentPlayTime",function(){return this._currentTime+this._playStart}),oD(0,oT,"cachePlayRate",function(){return this._cachePlayRate},function(oo){this._cachePlayRate!==oo&&(this._cachePlayRate=oo,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[oo,this._cacheFrameRate])))}),oD(0,oT,"cacheFrameRate",function(){return this._cacheFrameRate},function(oo){this._cacheFrameRate!==oo&&(this._cacheFrameRate=oo,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,oo])))}),oD(0,oT,"currentTime",null,function(oo){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(oo<this._playStart||oo>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=ox.loopCount;var or=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=oo,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/or),0),this._currentFrameTime=this._currentKeyframeIndex*or}}),oD(0,oT,"paused",function(){return this._paused},function(oo){(this._paused=oo)&&this.event("paused")}),oD(0,oT,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),oD(0,oT,"destroyed",function(){return this._destroyed}),or}(),oC=function(oo){function or(){or.__super.call(this),o_.isConchNode&&(this.drawSkin=function(oo){oo.transform||(oo.transform=oso.EMPTY),this._addCmd([oo]),this.setSkinMesh&&this.setSkinMesh(oo._ps,oo.mVBData,oo.mEleNum,0,oo.mTexture,oo.transform)})}return ok(or,"laya.ani.GraphicsAni",on),or.prototype.drawSkin=function(oo){var or=[oo];this._saveToCmd(o_._context._drawSkin,or)},or.create=function(){return or._caches.pop()||new or},or.recycle=function(oo){oo.clear(),or._caches.push(oo)},or._caches=[],or}(),oX=function(oo){function o$(){this._aniMap={},this.unfixedLastAniIndex=-1,o$.__super.call(this),this._anis=new Array}ok(o$,"laya.ani.AnimationTemplet",oh);var or=o$.prototype;return or.parse=function(oo){var or=new ouo(oo);this._aniVersion=or.readUTFString(),oy.parse(this,or)},or._calculateKeyFrame=function(oo,or,oT){var ok=oo.keyFrame;ok[or]=ok[0];for(var oW=0;oW<or;oW++){var oD=ok[oW];oD.nextData=0===oD.duration?oD.data:ok[oW+1].data}ok.length--},or.onAsynLoaded=function(oo,or,oT){var ok=new ouo(or);switch(this._aniVersion=ok.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":ol.parse(this,ok);break;default:oy.parse(this,ok)}this._endLoaded()},or.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},or.getAnimationCount=function(){return this._anis.length},or.getAnimation=function(oo){return this._anis[oo]},or.getAniDuration=function(oo){return this._anis[oo].playTime},or.getNodes=function(oo){return this._anis[oo].nodes},or.getNodeIndexWithName=function(oo,or){return this._anis[oo].bone3DMap[or]},or.getNodeCount=function(oo){return this._anis[oo].nodes.length},or.getTotalkeyframesLength=function(oo){return this._anis[oo].totalKeyframeDatasLength},or.getPublicExtData=function(){return this._publicExtData},or.getAnimationDataWithCache=function(oo,or,oT,ok){var oW=or[oT];if(oW){var oD=oW[oo];return oD?oD[ok]:null}return null},or.setAnimationDataWithCache=function(oo,or,oT,ok,oW){var oD=or[oT]||(or[oT]={});(oD[oo]||(oD[oo]=[]))[ok]=oW},or.getOriginalData=function(oo,or,oT,ok,oW){for(var oD=this._anis[oo].nodes,on=0,oV=0,oL=oD.length,oU=0;oV<oL;oV++){var oh,op=oD[oV];oh=op.keyFrame[oT[oV][ok]],op.dataOffset=oU;var oi=oW-oh.startTime,ov=op.lerpType;if(ov)switch(ov){case 0:case 1:for(on=0;on<op.keyframeWidth;)on+=op.interpolationMethod[on](op,on,or,oU+on,oh.data,oi,null,oh.duration,oh.nextData);break;case 2:var ox=oh.interpolationData,oj=ox.length,o_=0;for(on=0;on<oj;){var oK=ox[on];switch(oK){case 6:case 7:on+=o$.interpolation[oK](op,o_,or,oU+o_,oh.data,oi,null,oh.duration,oh.nextData,ox,on+1);break;default:on+=o$.interpolation[oK](op,o_,or,oU+o_,oh.data,oi,null,oh.duration,oh.nextData)}o_++}}else for(on=0;on<op.keyframeWidth;)on+=op.interpolationMethod[on](op,on,or,oU+on,oh.data,oi,null,oh.duration,oh.nextData);oU+=op.keyframeWidth}},or.getNodesCurrentFrameIndex=function(oo,or){var oT=this._anis[oo].nodes;oo!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(oT.length),this.unfixedCurrentTimes=new Float32Array(oT.length),this.unfixedLastAniIndex=oo);for(var ok=0,oW=oT.length;ok<oW;ok++){var oD=oT[ok];for(or<this.unfixedCurrentTimes[ok]&&(this.unfixedCurrentFrameIndexes[ok]=0),this.unfixedCurrentTimes[ok]=or;this.unfixedCurrentFrameIndexes[ok]<oD.keyFrame.length&&!(oD.keyFrame[this.unfixedCurrentFrameIndexes[ok]].startTime>this.unfixedCurrentTimes[ok]);)this.unfixedCurrentFrameIndexes[ok]++;this.unfixedCurrentFrameIndexes[ok]--}return this.unfixedCurrentFrameIndexes},or.getOriginalDataUnfixedRate=function(oo,or,oT){var ok=this._anis[oo].nodes;oo!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(ok.length),this.unfixedCurrentTimes=new Float32Array(ok.length),this.unfixedKeyframes=oj(ok.length),this.unfixedLastAniIndex=oo);for(var oW=0,oD=0,on=ok.length,oV=0;oD<on;oD++){var oL=ok[oD];for(oT<this.unfixedCurrentTimes[oD]&&(this.unfixedCurrentFrameIndexes[oD]=0),this.unfixedCurrentTimes[oD]=oT;this.unfixedCurrentFrameIndexes[oD]<oL.keyFrame.length&&!(oL.keyFrame[this.unfixedCurrentFrameIndexes[oD]].startTime>this.unfixedCurrentTimes[oD]);)this.unfixedKeyframes[oD]=oL.keyFrame[this.unfixedCurrentFrameIndexes[oD]],this.unfixedCurrentFrameIndexes[oD]++;var oU=this.unfixedKeyframes[oD];oL.dataOffset=oV;var oh=oT-oU.startTime;if(oL.lerpType)switch(oL.lerpType){case 0:case 1:for(oW=0;oW<oL.keyframeWidth;)oW+=oL.interpolationMethod[oW](oL,oW,or,oV+oW,oU.data,oh,null,oU.duration,oU.nextData);break;case 2:var op=oU.interpolationData,oi=op.length,ov=0;for(oW=0;oW<oi;){var ox=op[oW];switch(ox){case 6:case 7:oW+=o$.interpolation[ox](oL,ov,or,oV+ov,oU.data,oh,null,oU.duration,oU.nextData,op,oW+1);break;default:oW+=o$.interpolation[ox](oL,ov,or,oV+ov,oU.data,oh,null,oU.duration,oU.nextData)}ov++}}else for(oW=0;oW<oL.keyframeWidth;)oW+=oL.interpolationMethod[oW](oL,oW,or,oV+oW,oU.data,oh,null,oU.duration,oU.nextData);oV+=oL.keyframeWidth}},o$._LinearInterpolation_0=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){var oh=0===oV?0:oD/oV;return oT[ok]=(1-oh)*oW[or]+oh*oL[or],1},o$._QuaternionInterpolation_1=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){var oh=0===oV?0:oD/oV;return oi.slerpQuaternionArray(oW,or,oL,or,oh,oT,ok),4},o$._AngleInterpolation_2=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){return 0},o$._RadiansInterpolation_3=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){return 0},o$._Matrix4x4Interpolation_4=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){for(var oh=0;oh<16;oh++,or++)oT[ok+oh]=oW[or]+oD*on[or];return 16},o$._NoInterpolation_5=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU){return oT[ok]=oW[or],1},o$._BezierInterpolation_6=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh){return void 0===oh&&(oh=0),oT[ok]=oW[or]+(oL[or]-oW[or])*oF.getBezierRate(oD/oV,oU[oh],oU[oh+1],oU[oh+2],oU[oh+3]),5},o$._BezierInterpolation_7=function(oo,or,oT,ok,oW,oD,on,oV,oL,oU,oh){return void 0===oh&&(oh=0),oT[ok]=oU[oh+4]+oU[oh+5]*oF.getBezierRate((.001*oD+oU[oh+6])/oU[oh+7],oU[oh],oU[oh+1],oU[oh+2],oU[oh+3]),9},o$.load=function(oo){return oWo.loader.create(oo,null,null,o$)},o$.interpolation=[o$._LinearInterpolation_0,o$._QuaternionInterpolation_1,o$._AngleInterpolation_2,o$._RadiansInterpolation_3,o$._Matrix4x4Interpolation_4,o$._NoInterpolation_5,o$._BezierInterpolation_6,o$._BezierInterpolation_7],o$}(),ot=function(or){function oT(oo,or){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,oT.__super.call(this),void 0===or&&(or=0),oo&&this.init(oo,or)}ok(oT,"laya.ani.bone.Skeleton",or);var oo=oT.prototype;return oo.init=function(oo,or){void 0===or&&(or=0);var oT,ok,oW,oD=0,on=0;if(1==or)for(this._graphicsCache=[],oD=0,on=oo.getAnimationCount();oD<on;oD++)this._graphicsCache.push([]);if(this._yReverseMatrix=oo.yReverseMatrix,this._aniMode=or,this._templet=oo,this._player=new oP,this._player.cacheFrameRate=oo.rate,this._player.templet=oo,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=oo.mBoneArr,this._rootBone=oo.mRootBone,this._aniSectionDic=oo.aniSectionDic,0<oo.ikArr.length)for(this._ikArr=[],oD=0,on=oo.ikArr.length;oD<on;oD++)this._ikArr.push(new o$(oo.ikArr[oD],this._boneList));if(0<oo.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),oD=0,on=oo.pathArr.length;oD<on;oD++)oT=oo.pathArr[oD],ok=new oS(oT,this._boneList),(oW=this._boneSlotDic[oT.name])&&((ok=new oS(oT,this._boneList)).target=oW),this._pathDic[oT.name]=ok;if(0<oo.tfArr.length)for(this._tfArr=[],oD=0,on=oo.tfArr.length;oD<on;oD++)this._tfArr.push(new oq(oo.tfArr[oD],this._boneList));if(0<oo.skinDataArray.length){var oV=this._templet.skinDataArray[this._skinIndex];this._skinName=oV.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},oo.load=function(oo,or,oT){},oo._onLoaded=function(){},oo._parseComplete=function(){var oo=oH.TEMPLET_DICTIONARY[this._aniPath];oo&&(this.init(oo,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},oo._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},oo._onPlay=function(){this.event("played")},oo._onStop=function(){var oo,or=this._templet.eventAniArr[this._aniClipIndex];if(or&&this._eventIndex<or.length)for(;this._eventIndex<or.length;this._eventIndex++)(oo=or[this._eventIndex]).time>=this._player.playStart&&oo.time<=this._player.playEnd&&this.event("label",oo);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},oo._onPause=function(){this.event("paused")},oo._parseSrcBoneMatrix=function(){var oo=0,or=0;for(or=this._templet.srcBoneMatrixArr.length,oo=0;oo<or;oo++)this._boneMatrixArray.push(new oso);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var oT,ok,oW=this._templet.boneSlotArray;for(oo=0,or=oW.length;oo<or;oo++)oT=oW[oo],null==(ok=this._bindBoneBoneSlotDic[oT.parent])&&(this._bindBoneBoneSlotDic[oT.parent]=ok=[]),this._boneSlotDic[oT.name]=oT=oT.copy(),ok.push(oT),this._boneSlotArray.push(oT)}},oo._emitMissedEvents=function(oo,or,oT){void 0===oT&&(oT=0);var ok=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(ok){var oW,oD,on=0;for(oW=ok.length,on=oT;on<oW;on++)(oD=ok[on]).time>=this._player.playStart&&oD.time<=this._player.playEnd&&this.event("label",oD)}},oo._update=function(oo){if(void 0===oo&&(oo=!0),!(this._pause||oo&&this._indexControl)){var or=this.timer.currTimer,oT=this._player.currentKeyframeIndex,ok=or-this._lastTime;if(oo?this._player._update(ok):oT=-1,this._lastTime=or,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<ok&&this._clipIndex==oT&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var oW;this._lastUpdateAniClipIndex=this._aniClipIndex,oT>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var oD,on=this._templet.eventAniArr[this._aniClipIndex];if(on&&this._eventIndex<on.length&&((oW=on[this._eventIndex]).time>=this._player.playStart&&oW.time<=this._player.playEnd?this._player.currentPlayTime>=oW.time&&(this.event("label",oW),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(oD=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=oD&&(this.graphics=oD));var oV=0,oL=0;for(oL=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,oL-1)&&0<oL;)oL--;if(oL<this._clipIndex)for(oV=oL;oV<this._clipIndex;oV++)this._createGraphics(oV)}else if(1==this._aniMode){if(oD=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=oD&&(this.graphics=oD));for(oL=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,oL-1)&&0<oL;)oL--;if(oL<this._clipIndex)for(oV=oL;oV<this._clipIndex;oV++)this._createGraphics(oV)}this._createGraphics()}}},oo._createGraphics=function(oo){void 0===oo&&(oo=-1),-1==oo&&(oo=this._clipIndex);var or,oT,ok=oo*this._player.cacheFrameRateInterval,oW=this._templet.drawOrderAniArr[this._aniClipIndex];if(oW&&0<oW.length)for(this._drawOrderIndex=0,or=oW[this._drawOrderIndex];ok>=or.time&&(this._drawOrder=or.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=oW.length));)or=oW[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=oC.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=oC.create(),oT=this.graphics;var oD=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],oo,ok);var on,oV,oL,oU,oh=this._aniSectionDic[this._aniClipIndex],op=0,oi=0,ov=0,ox=0,oj=0,o_=this._templet.srcBoneMatrixArr.length;for(oj=oh[oi=0];oi<o_;oi++)oU=this._boneList[oi],oL=this._templet.srcBoneMatrixArr[oi],oU.resultTransform.scX=oL.scX*this._curOriginalData[op++],oU.resultTransform.skX=oL.skX+this._curOriginalData[op++],oU.resultTransform.skY=oL.skY+this._curOriginalData[op++],oU.resultTransform.scY=oL.scY*this._curOriginalData[op++],oU.resultTransform.x=oL.x+this._curOriginalData[op++],oU.resultTransform.y=oL.y+this._curOriginalData[op++],8===this._templet.tMatrixDataLen&&(oU.resultTransform.skewX=oL.skewX+this._curOriginalData[op++],oU.resultTransform.skewY=oL.skewY+this._curOriginalData[op++]);var oK,o$={},oy={};for(oj+=oh[1];oi<oj;oi++)o$[(oK=oD[oi]).name]=this._curOriginalData[op++],oy[oK.name]=this._curOriginalData[op++],this._curOriginalData[op++],this._curOriginalData[op++],this._curOriginalData[op++],this._curOriginalData[op++];var ol,oS,oq={},ob={};for(oj+=oh[2];oi<oj;oi++)oq[(oK=oD[oi]).name]=this._curOriginalData[op++],ob[oK.name]=this._curOriginalData[op++],this._curOriginalData[op++],this._curOriginalData[op++],this._curOriginalData[op++],this._curOriginalData[op++];if(this._pathDic)for(oj+=oh[3];oi<oj;oi++){if(oK=oD[oi],ol=this._pathDic[oK.name])switch(new ouo(oK.extenData).getByte()){case 1:ol.position=this._curOriginalData[op++];break;case 2:ol.spacing=this._curOriginalData[op++];break;case 3:ol.rotateMix=this._curOriginalData[op++],ol.translateMix=this._curOriginalData[op++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(oso.TEMP.identity()),this._ikArr)for(oi=0,oj=this._ikArr.length;oi<oj;oi++)oS=this._ikArr[oi],oq.hasOwnProperty(oS.name)&&(oS.bendDirection=oq[oS.name]),ob.hasOwnProperty(oS.name)&&(oS.mix=ob[oS.name]),oS.apply();if(this._pathDic)for(var oF in this._pathDic)(ol=this._pathDic[oF]).apply(this._boneList,oT);if(this._tfArr)for(oi=0,ox=this._tfArr.length;oi<ox;oi++)this._tfArr[oi].apply();for(oi=0,ox=this._boneList.length;oi<ox;oi++)if(oU=this._boneList[oi],oV=this._bindBoneBoneSlotDic[oU.name],oU.resultMatrix.copyTo(this._boneMatrixArray[oi]),oV)for(ov=0,oj=oV.length;ov<oj;ov++)(on=oV[ov])&&on.setParentMatrix(oU.resultMatrix);var oP,ot,oH,oR,ou={},os=this._templet.deformAniArr;if(os&&0<os.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,oi=0,oj=this._boneSlotArray.length;oi<oj;oi++)(on=this._boneSlotArray[oi]).deformData=null;var oz,om=os[this._aniClipIndex];for(oz in oP=om.default,this._setDeform(oP,ou,this._boneSlotArray,ok),om)"default"!=oz&&oz!=this._skinName&&(oP=om[oz],this._setDeform(oP,ou,this._boneSlotArray,ok));oP=om[this._skinName],this._setDeform(oP,ou,this._boneSlotArray,ok)}if(this._drawOrder)for(oi=0,oj=this._drawOrder.length;oi<oj;oi++)ot=o$[(on=this._boneSlotArray[this._drawOrder[oi]]).name],oH=oy[on.name],isNaN(oH)||(oT.save(),oT.alpha(oH)),isNaN(ot)||-2==ot||(this._templet.attachmentNames?on.showDisplayByName(this._templet.attachmentNames[ot]):on.showDisplayByIndex(ot)),ou[this._drawOrder[oi]]?(oR=ou[this._drawOrder[oi]],on.currDisplayData&&oR[on.currDisplayData.attachmentName]?on.deformData=oR[on.currDisplayData.attachmentName]:on.deformData=null):on.deformData=null,isNaN(oH)?on.draw(oT,this._boneMatrixArray,2==this._aniMode):on.draw(oT,this._boneMatrixArray,2==this._aniMode,oH),isNaN(oH)||oT.restore();else for(oi=0,oj=this._boneSlotArray.length;oi<oj;oi++)ot=o$[(on=this._boneSlotArray[oi]).name],oH=oy[on.name],isNaN(oH)||(oT.save(),oT.alpha(oH)),isNaN(ot)||-2==ot||(this._templet.attachmentNames?on.showDisplayByName(this._templet.attachmentNames[ot]):on.showDisplayByIndex(ot)),ou[oi]?(oR=ou[oi],on.currDisplayData&&oR[on.currDisplayData.attachmentName]?on.deformData=oR[on.currDisplayData.attachmentName]:on.deformData=null):on.deformData=null,isNaN(oH)?on.draw(oT,this._boneMatrixArray,2==this._aniMode):on.draw(oT,this._boneMatrixArray,2==this._aniMode,oH),isNaN(oH)||oT.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,oo,oT):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,oo,oT)},oo._setDeform=function(oo,or,oT,ok){if(oo){var oW,oD,on,oV=0,oL=0,oU=0;if(oo)for(oV=0,oL=oo.deformSlotDataList.length;oV<oL;oV++)for(oW=oo.deformSlotDataList[oV],oU=0;oU<oW.deformSlotDisplayList.length;oU++)on=oT[(oD=oW.deformSlotDisplayList[oU]).slotIndex],oD.apply(ok,on),or[oD.slotIndex]||(or[oD.slotIndex]={}),or[oD.slotIndex][oD.attachment]=oD.deformData}},oo.getAnimNum=function(){return this._templet.getAnimationCount()},oo.getAniNameByIndex=function(oo){return this._templet.getAniNameByIndex(oo)},oo.getSlotByName=function(oo){return this._boneSlotDic[oo]},oo.showSkinByName=function(oo,or){void 0===or&&(or=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(oo),or)},oo.showSkinByIndex=function(oo,or){void 0===or&&(or=!0);for(var oT=0;oT<this._boneSlotArray.length;oT++)this._boneSlotArray[oT].showSlotData(null,or);if(this._templet.showSkinByIndex(this._boneSlotDic,oo,or)){var ok=this._templet.skinDataArray[oo];this._skinIndex=oo,this._skinName=ok.name}this._clearCache()},oo.showSlotSkinByIndex=function(oo,or){if(0!=this._aniMode){var oT=this.getSlotByName(oo);oT&&oT.showDisplayByIndex(or),this._clearCache()}},oo.showSlotSkinByName=function(oo,or){if(0!=this._aniMode){var oT=this.getSlotByName(oo);oT&&oT.showDisplayByName(or),this._clearCache()}},oo.replaceSlotSkinName=function(oo,or,oT){if(0!=this._aniMode){var ok=this.getSlotByName(oo);ok&&ok.replaceDisplayByName(or,oT),this._clearCache()}},oo.replaceSlotSkinByIndex=function(oo,or,oT){if(0!=this._aniMode){var ok=this.getSlotByName(oo);ok&&ok.replaceDisplayByIndex(or,oT),this._clearCache()}},oo.setSlotSkin=function(oo,or){if(0!=this._aniMode){var oT=this.getSlotByName(oo);oT&&oT.replaceSkin(or),this._clearCache()}},oo._clearCache=function(){if(1==this._aniMode)for(var oo=0,or=this._graphicsCache.length;oo<or;oo++){for(var oT=0,ok=this._graphicsCache[oo].length;oT<ok;oT++){var oW=this._graphicsCache[oo][oT];oW!=this.graphics&&oC.recycle(oW)}this._graphicsCache[oo].length=0}},oo.play=function(oo,or,oT,ok,oW,oD){void 0===oT&&(oT=!0),void 0===ok&&(ok=0),void 0===oW&&(oW=0),void 0===oD&&(oD=!0),this._indexControl=!1;var on=-1,oV=NaN;if(oV=or?2147483647:0,"string"==typeof oo)for(var oL=0,oU=this._templet.getAnimationCount();oL<oU;oL++){var oh=this._templet.getAnimation(oL);if(oh&&oo==oh.name){on=oL;break}}else on=oo;-1<on&&on<this.getAnimNum()&&(this._aniClipIndex=on,(oT||this._pause||this._currAniIndex!=on)&&(this._currAniIndex=on,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(on)),this._drawOrder=null,this._eventIndex=0,this._player.play(on,this._player.playbackRate,oV,ok,oW),oD&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=op.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},oo.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},oo.playbackRate=function(oo){this._player&&(this._player.playbackRate=oo)},oo.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},oo.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=op.now(),this.timer.frameLoop(1,this,this._update,null,!0))},oo._getGrahicsDataWithCache=function(oo,or){return this._graphicsCache[oo][or]},oo._setGrahicsDataWithCache=function(oo,or,oT){this._graphicsCache[oo][or]=oT},oo.destroy=function(oo){void 0===oo&&(oo=!0),or.prototype.destroy.call(this,oo),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},oD(0,oo,"url",function(){return this._aniPath},function(oo){this.load(oo)}),oD(0,oo,"index",function(){return this._index},function(oo){this.player&&(this._index=oo,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),oD(0,oo,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),oD(0,oo,"templet",function(){return this._templet}),oD(0,oo,"player",function(){return this._player}),oT.useSimpleMeshInCanvas=!1,oT}(oDo),oH=function(or){function oW(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,oW.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}ok(oW,"laya.ani.bone.Templet",or);var oo=oW.prototype;return oo.getLoadList=function(){return this._loadList},oo.loadAni=function(oo){this._skBufferUrl=oo,oWo.loader.load(oo,oL.create(this,this.onComplete),null,"arraybuffer")},oo.onComplete=function(oo){if(this._isDestroyed)this.destroy();else{var or=oU.getRes(this._skBufferUrl);or?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,or)):this.event("error","load failed:"+this._skBufferUrl)}},oo.parseData=function(oo,or,oT){void 0===oT&&(oT=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=oo,this._mainTexture&&o_.isWebGL&&oo.bitmap&&(oo.bitmap.enableMerageInAtlas=!1),this._rate=oT,this.parse(or)},oo.buildArmature=function(oo){return void 0===oo&&(oo=0),new ot(this,oo)},oo.parse=function(oo){or.prototype.parse.call(this,oo),this._endLoaded(),this._aniVersion!=oW.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+oW.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},oo._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var oo=0;this._loadList=[];var or,oT=new ouo(this.getPublicExtData()),ok=0,oW=0,oD=0,on=oT.getInt32(),oV=oT.readUTFString(),oL=oV.split("\n");for(oo=0;oo<on;oo++)or=this._path+oL[2*oo],oV=oL[2*oo+1],oT.getFloat32(),oT.getFloat32(),ok=oT.getFloat32(),oW=oT.getFloat32(),oD=oT.getFloat32(),isNaN(oD)?0:oD,oD=oT.getFloat32(),isNaN(oD)?0:oD,oD=oT.getFloat32(),isNaN(oD)?ok:oD,oD=oT.getFloat32(),isNaN(oD)?oW:oD,-1==this._loadList.indexOf(or)&&this._loadList.push(or);this.event("inited",this)}},oo._textureComplete=function(){for(var oo,or,oT=0,ok=this._loadList.length;oT<ok;oT++)or=this._loadList[oT],oo=this._textureDic[or]=oU.getRes(or),o_.isWebGL&&oo&&oo.bitmap&&(oo.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},oo._parsePublicExtData=function(){var oo=0,or=0,oT=0,ok=0,oW=0;for(oo=0,oW=this.getAnimationCount();oo<oW;oo++)this._graphicsCache.push([]);var oD;oD="Dragon"!=this._aniClassName;var on,oV,oL=new ouo(this.getPublicExtData()),oU=0,oh=0,op=0,oi=0,ov=0,ox=0,oj=0,o_=0,oK=0,o$=oL.getInt32(),oy=oL.readUTFString(),ol=oy.split("\n");for(oo=0;oo<o$;oo++){if(on=this._mainTexture,oV=this._path+ol[2*oo],oy=ol[2*oo+1],null==this._mainTexture&&(on=this._textureDic[oV]),!on)return this.event("error",this),void(this.isParseFail=!0);oU=oL.getFloat32(),oh=oL.getFloat32(),op=oL.getFloat32(),oi=oL.getFloat32(),oK=oL.getFloat32(),ov=isNaN(oK)?0:oK,oK=oL.getFloat32(),ox=isNaN(oK)?0:oK,oK=oL.getFloat32(),oj=isNaN(oK)?op:oK,oK=oL.getFloat32(),o_=isNaN(oK)?oi:oK,this.subTextureDic[oy]=ozo.create(on,oU,oh,op,oi,-ov,-ox,oj,o_),on.alphaTexture&&(this.subTextureDic[oy].alphaTexture=ozo.create(on.alphaTexture,oU,oh,op,oi,-ov,-ox,oj,o_))}this._mainTexture=on;var oS,oq,ob,oF,oP,ot=oL.getUint16();for(oo=0;oo<ot;oo++)(oS=[]).push(oL.getUint16()),oS.push(oL.getUint16()),oS.push(oL.getUint16()),oS.push(oL.getUint16()),this.aniSectionDic[oo]=oS;var oH,oR=oL.getInt16(),ou={};for(oo=0;oo<oR;oo++)oq=new omo,0==oo?oH=oq:oq.root=oH,oq.d=oD?-1:1,oF=oL.readUTFString(),oP=oL.readUTFString(),oq.length=oL.getFloat32(),1==oL.getByte()&&(oq.inheritRotation=!1),1==oL.getByte()&&(oq.inheritScale=!1),oq.name=oF,oP&&((ob=ou[oP])?ob.addChild(oq):this.mRootBone=oq),ou[oF]=oq,this.mBoneArr.push(oq);this.tMatrixDataLen=oL.getUint16();var os,oz,om=oL.getUint16(),oC=Math.floor(om/this.tMatrixDataLen),oX=this.srcBoneMatrixArr;for(oo=0;oo<oC;oo++)(os=new oao).scX=oL.getFloat32(),os.skX=oL.getFloat32(),os.skY=oL.getFloat32(),os.scY=oL.getFloat32(),os.x=oL.getFloat32(),os.y=oL.getFloat32(),8===this.tMatrixDataLen&&(os.skewX=oL.getFloat32(),os.skewY=oL.getFloat32()),oX.push(os),(oq=this.mBoneArr[oo]).transform=os;var oO,oM=oL.getUint16(),oc=0;for(oo=0;oo<oM;oo++){for(oz=new oJo,oc=oL.getUint16(),or=0;or<oc;or++)oz.boneNames.push(oL.readUTFString()),oz.boneIndexs.push(oL.getInt16());oz.name=oL.readUTFString(),oz.targetBoneName=oL.readUTFString(),oz.targetBoneIndex=oL.getInt16(),oz.bendDirection=oL.getFloat32(),oz.mix=oL.getFloat32(),oz.isSpine=oD,this.ikArr.push(oz)}var oe,oJ=oL.getUint16(),oY=0;for(oo=0;oo<oJ;oo++){for(oO=new ofo,oY=oL.getUint16(),or=0;or<oY;or++)oO.boneIndexs.push(oL.getInt16());oO.name=oL.getUTFString(),oO.targetIndex=oL.getInt16(),oO.rotateMix=oL.getFloat32(),oO.translateMix=oL.getFloat32(),oO.scaleMix=oL.getFloat32(),oO.shearMix=oL.getFloat32(),oO.offsetRotation=oL.getFloat32(),oO.offsetX=oL.getFloat32(),oO.offsetY=oL.getFloat32(),oO.offsetScaleX=oL.getFloat32(),oO.offsetScaleY=oL.getFloat32(),oO.offsetShearY=oL.getFloat32(),this.tfArr.push(oO)}var oA=oL.getUint16(),oI=0;for(oo=0;oo<oA;oo++){for((oe=new oYo).name=oL.readUTFString(),oI=oL.getUint16(),or=0;or<oI;or++)oe.bones.push(oL.getInt16());oe.target=oL.readUTFString(),oe.positionMode=oL.readUTFString(),oe.spacingMode=oL.readUTFString(),oe.rotateMode=oL.readUTFString(),oe.offsetRotation=oL.getFloat32(),oe.position=oL.getFloat32(),oe.spacing=oL.getFloat32(),oe.rotateMix=oL.getFloat32(),oe.translateMix=oL.getFloat32(),this.pathArr.push(oe)}var oN,of,oa,oG,ow,oZ=0,oQ=0,og=0,oB=NaN,oE=0,od=oL.getInt16();for(oo=0;oo<od;oo++){var ooo=oL.getUint8(),oro={};this.deformAniArr.push(oro);for(var oTo=0;oTo<ooo;oTo++)for((oN=new oXo).skinName=oL.getUTFString(),oro[oN.skinName]=oN,oZ=oL.getInt16(),or=0;or<oZ;or++)for(of=new oOo,oN.deformSlotDataList.push(of),oQ=oL.getInt16(),oT=0;oT<oQ;oT++)for(oa=new oMo,of.deformSlotDisplayList.push(oa),oa.slotIndex=oL.getInt16(),oa.attachment=oL.getUTFString(),og=oL.getInt16(),ok=0;ok<og;ok++)for(1==oL.getByte()?oa.tweenKeyList.push(!0):oa.tweenKeyList.push(!1),oB=oL.getFloat32(),oa.timeList.push(oB),oG=[],oa.vectices.push(oG),oE=oL.getInt16(),oW=0;oW<oE;oW++)oG.push(oL.getFloat32())}var oko,oWo,oDo=oL.getInt16(),ono=0,oVo=0;for(oo=0;oo<oDo;oo++){for(ono=oL.getInt16(),ow=[],or=0;or<ono;or++){for((oko=new oco).time=oL.getFloat32(),oVo=oL.getInt16(),oT=0;oT<oVo;oT++)oko.drawOrder.push(oL.getInt16());ow.push(oko)}this.drawOrderAniArr.push(ow)}var oLo,oUo=oL.getInt16(),oho=0;for(oo=0;oo<oUo;oo++){for(oho=oL.getInt16(),oWo=[],or=0;or<oho;or++)(oLo=new oeo).name=oL.getUTFString(),oLo.intValue=oL.getInt32(),oLo.floatValue=oL.getFloat32(),oLo.stringValue=oL.getUTFString(),oLo.time=oL.getFloat32(),oWo.push(oLo);this.eventAniArr.push(oWo)}var opo=oL.getInt16();if(0<opo)for(this.attachmentNames=[],oo=0;oo<opo;oo++)this.attachmentNames.push(oL.getUTFString());var oio,ovo,oxo=oL.getInt16();for(oo=0;oo<oxo;oo++)(oio=new oCo).name=oL.readUTFString(),oio.parent=oL.readUTFString(),oio.attachmentName=oL.readUTFString(),oio.srcDisplayIndex=oio.displayIndex=oL.getInt16(),(oio.templet=this).boneSlotDic[oio.name]=oio,null==(ovo=this.bindBoneBoneSlotDic[oio.parent])&&(this.bindBoneBoneSlotDic[oio.parent]=ovo=[]),ovo.push(oio),this.boneSlotArray.push(oio);var ojo,o_o,oKo,o$o=oL.readUTFString().split("\n"),oyo=0,olo=oL.getUint8(),oSo=0,oqo=0,obo=0,oFo=0,oPo=0,oto=0,oHo=0;for(oo=0;oo<olo;oo++){for((ojo=new oAo).name=o$o[oyo++],oSo=oL.getUint8(),or=0;or<oSo;or++){for((o_o=new oNo).name=o$o[oyo++],oio=this.boneSlotDic[o_o.name],oqo=oL.getUint8(),oT=0;oT<oqo;oT++){if(oKo=new oIo,this.skinSlotDisplayDataArr.push(oKo),oKo.name=o$o[oyo++],oKo.attachmentName=o$o[oyo++],oKo.transform=new oao,oKo.transform.scX=oL.getFloat32(),oKo.transform.skX=oL.getFloat32(),oKo.transform.skY=oL.getFloat32(),oKo.transform.scY=oL.getFloat32(),oKo.transform.x=oL.getFloat32(),oKo.transform.y=oL.getFloat32(),o_o.displayArr.push(oKo),oKo.width=oL.getFloat32(),oKo.height=oL.getFloat32(),oKo.type=oL.getUint8(),oKo.verLen=oL.getUint16(),0<(oR=oL.getUint16()))for(oKo.bones=[],ok=0;ok<oR;ok++){var oRo=oL.getUint16();oKo.bones.push(oRo)}if(0<(obo=oL.getUint16()))for(oKo.uvs=[],ok=0;ok<obo;ok++)oKo.uvs.push(oL.getFloat32());if(0<(oFo=oL.getUint16()))for(oKo.weights=[],ok=0;ok<oFo;ok++)oKo.weights.push(oL.getFloat32());if(0<(oPo=oL.getUint16()))for(oKo.triangles=[],ok=0;ok<oPo;ok++)oKo.triangles.push(oL.getUint16());if(0<(oto=oL.getUint16()))for(oKo.vertices=[],ok=0;ok<oto;ok++)oKo.vertices.push(oL.getFloat32());if(0<(oHo=oL.getUint16()))for(oKo.lengths=[],ok=0;ok<oHo;ok++)oKo.lengths.push(oL.getFloat32())}ojo.slotArr.push(o_o)}this.skinDic[ojo.name]=ojo,this.skinDataArray.push(ojo)}1==oL.getUint8()?(this.yReverseMatrix=new oso(1,0,0,-1,0,0),oH&&oH.setTempMatrix(this.yReverseMatrix)):oH&&oH.setTempMatrix(new oso),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},oo.getTexture=function(oo){var or=this.subTextureDic[oo];return or||(or=this.subTextureDic[oo.substr(0,oo.length-1)]),null==or?this._mainTexture:or},oo.showSkinByIndex=function(oo,or,oT){if(void 0===oT&&(oT=!0),or<0&&or>=this.skinDataArray.length)return!1;var ok,oW,oD=0,on=0,oV=this.skinDataArray[or];if(oV){for(oD=0,on=oV.slotArr.length;oD<on;oD++)(oW=oV.slotArr[oD])&&(ok=oo[oW.name])&&(ok.showSlotData(oW,oT),oT&&"undefined"!=ok.attachmentName&&"null"!=ok.attachmentName?ok.showDisplayByName(ok.attachmentName):ok.showDisplayByIndex(ok.displayIndex));return!0}return!1},oo.getSkinIndexByName=function(oo){for(var or=0,oT=this.skinDataArray.length;or<oT;or++)if(this.skinDataArray[or].name==oo)return or;return-1},oo.getGrahicsDataWithCache=function(oo,or){return this._graphicsCache[oo][or]},oo.setGrahicsDataWithCache=function(oo,or,oT){this._graphicsCache[oo][or]=oT},oo.destroy=function(){var oo;for(var or in this._isDestroyed=!0,this.subTextureDic)(oo=this.subTextureDic[or])&&oo.destroy();for(or in this._textureDic)(oo=this._textureDic[or])&&oo.destroy();for(var oT=0,ok=this.skinSlotDisplayDataArr.length;oT<ok;oT++)this.skinSlotDisplayDataArr[oT].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete oW.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},oo.getAniNameByIndex=function(oo){var or=this.getAnimation(oo);return or?or.name:null},oD(0,oo,"rate",function(){return this._rate},function(oo){this._rate=oo}),oW.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",oW.TEMPLET_DICTIONARY=null,oW}(oX)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(oo,or){"use strict";for(var oT in Object.defineProperty(or,"__esModule",{value:!0}),Laya){var ok=Laya[oT];ok&&ok.__isclass&&(or[oT]=ok)}});