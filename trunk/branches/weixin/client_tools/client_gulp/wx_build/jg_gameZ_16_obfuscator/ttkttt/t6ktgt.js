var W=wx.$l;import Sdk from"../utils/ad_mini-sdk.js";var config={game_id:256,game_pkg:W[1800],partner_label:W[1801],partner_id:W[1802],game_ver:W[1803],is_auth:!1,game_key:W[1804],client_key:W[1805],partner_game_id:118};window.config=config;var $LTDFNP=$LTFPND();var HOST=W[1806];var $LTDFPN=null;var $LTFNPD=null;var user_invite_by_activity=null;var sysInfo=wx.getSystemInfoSync();var platform=sysInfo.platform;var sdkUserInfo=null;var AD_HOST=W[1807];function $LTFPND(){var i={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0;console.log(W[1808]);var t=this;var n;n=wx.getStorageSync(W[1809])?0:(n=t.uuid(16,32),wx.setStorageSync(W[1809],n),1),wx.getStorageSync(W[1810])||(i=t.uuid(16,32),wx.setStorageSync(W[1810],i));var i=wx.getLaunchOptionsSync();var o=i.scene||"";console.log(W[1811],JSON.stringify(i)),t.log(W[1812],{install:n,scene:o}),wx.showShareMenu();t=i.query&&i.query.invite?i.query.invite:"";var a=i.query&&i.query.invite_type?i.query.invite_type:"";var s=i.query&&i.query.cp_activity_id?i.query.cp_activity_id:"";s||(a=(s=i.query&&i.query.shareMessageToFriendScene?i.query.shareMessageToFriendScene:"")?W[1813]:""),s&&(user_invite_by_activity={invite:t,invite_type:a,is_new:n,scene:o,cp_activity_id:s}),t&&($LTFNPD={invite:t,invite_type:a,is_new:n,scene:o}),e&&(config.game_ver=e,this.checkGameVersion(e,function(e){r&&r(e)}))},login:function(e,r){var t=this;var n={game_id:config.partner_game_id,sdk_ver:config.game_ver,game_key:config.game_key,client_key:config.client_key};Sdk.$LDN(n,function(e){e&&(console.log(e),Sdk.sdkLogin(function(e){console.log(W[1814],e),window.sdkUser=e,wx.setStorage({key:W[1815],data:e}),console.log(W[1816]),t.do_login(e)}))}),i[W[261]]=typeof r==W[1012]?r:null},do_login:function(e){var t=this;var r=t.getPublicData();if(r[W[1817]]=JSON.stringify(e),$LTFNPD&&typeof $LTFNPD==W[912])for(var n in $LTFNPD)r[n]=$LTFNPD[n];wx.request({url:W[1818]+HOST+W[1819],method:W[225],dataType:W[1257],header:{"content-type":W[409]},data:r,success:function(e){if(console.log(W[1820]+JSON.stringify(e)),200==e.statusCode){e=e.data;if(e.state){try{wx.setStorageSync(W[1821],e.data.sdk_token),wx.setStorageSync(W[1822],e.data.user_id),wx.setStorageSync(W[1823],e.data.username),e.data.ext&&wx.setStorageSync(W[1824],e.data.ext),sdkUserInfo=wx.getStorageSync(W[1815]),console.log(W[1825]+JSON.stringify(sdkUserInfo)),typeof sdkUserInfo!==W[908]&&""!==sdkUserInfo||(console.log(W[1826]+JSON.stringify(window.sdkUser)),sdkUserInfo=window.sdkUser)}catch(e){i[W[261]]&&i[W[261]](1,{errMsg:W[1827]})}var r={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};i[W[261]]&&i[W[261]](0,r)}else i[W[261]]&&i[W[261]](1,{errMsg:e.msg});t.getShareInfo(W[1828],function(e){console.log(W[1829]),wx.onShareAppMessage(function(){return t.logStartShare(W[1828]),{title:e.title,imageUrl:e.img,query:e.query}})})}else i[W[261]]&&i[W[261]](1,{errMsg:W[1830]})}})},share:function(e){i[W[366]]=typeof callback==W[1012]?callback:null;var r=e.type||W[366];var t=e.cp_activity_id||"";console.log(W[1831]+r);var n=this;this.getShareInfo(r,function(e){""!=t&&""!=e.query&&(e.query=e.query+W[1832]+t),n.logStartShare(r),wx.shareAppMessage({title:e.title,imageUrl:e.img,query:e.query})})},logStartShare:function(e){var r=wx.getStorageSync(W[1821]);wx.request({url:W[1818]+HOST+W[1833],method:W[225],dataType:W[1257],header:{"content-type":W[409]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:$LTDFPN?$LTDFPN.server_id:"",role_id:$LTDFPN?$LTDFPN.role_id:"",type:e},success:function(e){}})},openService:function(e){e?(e={user_id:sdkUserInfo.uid,game_id:config.game_id,role_name:e.roleName,role_id:e.roleId,server_name:e.serverName,server_id:e.serverId},Sdk.openGS(e)):wx.openCustomerServiceConversation()},checkGameVersion:function(e,t){console.log(W[1834]);wx.getStorageSync(W[1821]);wx.request({url:W[1818]+HOST+W[1835],method:W[225],dataType:W[1257],header:{"content-type":W[409]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(W[1836]),console.log(e),200==e.statusCode&&(r=e.data).state?t&&t(r.data):t&&t({develop:0})}})},getShareInfo:function(e,r){console.log(W[1837]);var t=wx.getStorageSync(W[1821]);wx.request({url:W[1818]+HOST+W[1838],method:W[225],dataType:W[1257],header:{"content-type":W[409]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,type:e,server_id:$LTDFPN?$LTDFPN.server_id:"",role_id:$LTDFPN?$LTDFPN.role_id:"",no_log:1},success:function(e){console.log(W[1839]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?r&&r(e.data):i[W[366]]&&i[W[366]](1,{errMsg:W[1840]+e.msg}):i[W[366]]&&i[W[366]](1,{errMsg:W[1841]})}})},updateShare:function(e,r,t,n,i,o){console.log(W[1842]);var a=wx.getStorageSync(W[1821]);wx.request({url:W[1818]+HOST+W[1843],method:W[225],dataType:W[1257],header:{"content-type":W[409]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:a,invite:e,invite_type:r,is_new:t,role_id:n,sever_id:i,scene:o},success:function(e){console.log(W[1844]+JSON.stringify(e))}})},msgCheck:function(e,r){sdkUserInfo=wx.getStorageSync(W[1815]),console.log(W[1845]);var t=wx.getStorageSync(W[1821]);wx.request({url:W[1818]+AD_HOST+W[1846]+config.partner_id+"/"+config.game_pkg,method:W[225],dataType:W[1257],header:{"content-type":W[409]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,content:e,openid:sdkUserInfo.open_id},success:function(e){console.log(W[1847]),console.log(e),r&&r(e)}})},pay:function(e,r){this.startPay(e,r)},startPay:function(e,r){console.log(W[1848]),console.log(e);var t=this;i[W[348]]=typeof r==W[1012]?r:null;r=wx.getStorageSync(W[1821]);wx.getStorageSync(W[1824]);r?(wx.getSystemInfoSync(),r={cpbill:e.cpbill,serverid:e.serverid,servername:e.servername,price:e.price,productid:e.productid,productname:e.productname,extension:e.extension,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,sdk_token:r,uid:sdkUserInfo.uid,buyAmount:e.buyAmount||1},t.order_data=r,(e=t.getPublicData())[W[1850]]=JSON.stringify(r),wx.request({url:W[1818]+HOST+W[1851],method:W[225],dataType:W[1257],header:{"content-type":W[409]},data:e,success:function(e){console.log(W[1852]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?""==e.data.ext?(config.game_id,config.game_ver,config.game_key,config.client_key,Sdk.sdkGenOrder(e.data.pay_data,function(e){console.log(W[1853],e)})):t.extDo({ext1:e.data.ext,ext2:e.data.pay_data}):i[W[348]]&&i[W[348]](1,{errMsg:e.msg}):i[W[261]]&&i[W[261]](1,{errMsg:W[1830]})}})):i[W[348]]&&i[W[348]](1,{errMsg:W[1849]})},extDo:function(e){wx.navigateToMiniProgram({appId:e.ext1,path:W[1854]+e.ext2.cpOrderId+W[1855]+e.ext2.money,extraData:{},envVersion:W[1856],success(e){}})},logCreateRole:function(e){var r=wx.getStorageSync(W[1822]);var t=wx.getStorageSync(W[1823]);var n={};n[W[1857]]=r,n[W[1858]]=t,n[W[1859]]=e.roleId,n[W[1860]]=e.roleLevel,n[W[1861]]=e.roleName,n[W[24]]=e.serverId,n[W[314]]=e.serverName,e.roleid&&e.serverid&&($LTDFPN={role_id:e.roleId,server_id:e.serverId});config.game_id,config.game_ver,config.game_key,config.client_key;t={loginType:1,user_id:sdkUserInfo.uid,game_id:config.game_id,server_id:e.serverId,server_name:e.serverName,role_id:e.roleId,role_name:e.roleName,level:e.roleLevel};var i,o,a;Sdk.sdkReportEvent(t),this.log(W[490],n),user_invite_by_activity&&(t=user_invite_by_activity.scene,n=user_invite_by_activity.is_new,i=user_invite_by_activity.invite,o=user_invite_by_activity&&user_invite_by_activity.invite_type?user_invite_by_activity.invite_type:"",a=user_invite_by_activity.cp_activity_id,r={uid:r,role_id:e.roleId,role_name:e.roleName,server_id:e.serverId,server_name:e.serverName,game_id:config.game_id,partner_id:config.partner_id,game_pkg:config.game_pkg,scene:t,is_new:n,invite_code:i,invite_type:o,cp_activity_id:a},wx.request({url:W[1818]+HOST+W[1862],method:W[225],dataType:W[1257],header:{"content-type":W[409]},data:r,success:function(e){console.log(W[1863]+JSON.stringify(e))}}))},logEnterGame:function(e){var r=wx.getStorageSync(W[1822]);var t=wx.getStorageSync(W[1823]);var n={};n[W[1857]]=r,n[W[1858]]=t,n[W[1859]]=e.roleId,n[W[1860]]=e.roleLevel,n[W[1861]]=e.roleName,n[W[24]]=e.serverId,n[W[314]]=e.serverName,e.roleid&&e.serverid&&($LTDFPN={role_id:e.roleId,server_id:e.serverId}),this.log(W[1864],n);config.game_id,config.game_ver,config.game_key,config.client_key;r={loginType:4,user_id:sdkUserInfo.uid,game_id:config.game_id,server_id:e.serverId,server_name:e.serverName,role_id:e.roleId,role_name:e.roleName,level:e.roleLevel};Sdk.sdkReportEvent(r),$LTFNPD&&this.updateShare($LTFNPD.invite,$LTFNPD.invite_type,$LTFNPD.is_new,e.roleId,e.serverId,$LTFNPD.scene)},logRoleUpLevel:function(e){var r=wx.getStorageSync(W[1822]);var t=wx.getStorageSync(W[1823]);var n={};n[W[1857]]=r,n[W[1858]]=t,n[W[1859]]=e.roleId,n[W[1860]]=e.roleLevel,n[W[1861]]=e.roleName,n[W[24]]=e.serverId,n[W[314]]=e.serverName,e.roleid&&e.serverid&&($LTDFPN={role_id:e.roleId,server_id:e.serverId}),this.log(W[1865],n);config.game_id,config.game_ver,config.game_key,config.client_key;r={loginType:2,user_id:sdkUserInfo.uid,game_id:config.game_id,server_id:e.serverId,server_name:e.serverName,role_id:e.roleId,role_name:e.roleName,level:e.roleLevel};Sdk.sdkReportEvent(r)},uuid:function(e,r){var t=W[1866].split("");var n,i=[];var o;if(e=e||t.length,r)for(n=0;n<r;n++)i[n]=t[0|Math.random()*e];else for(i[8]=i[13]=i[18]=i[23]="-",i[14]="4",n=0;n<36;n++)i[n]||(o=0|16*Math.random(),i[n]=t[19==n?3&o|8:o]);return i.join("")},getPublicData:function(){var e=wx.getSystemInfoSync();var r=wx.getStorageSync(W[1809]);var t=wx.getStorageSync(W[1810]);return{is_from_min:1,game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,ad_code:"",uuid:r,idfv:t,dname:e.model,mac:W[1867],net_type:0==e.wifiSignal?"4G":W[1868],os_ver:e.system,sdk_ver:e.version,game_ver:config.game_ver,device:e.platform==W[111]?1:2}},log:function(e,r){var t=this.getPublicData();for(var n in r)t[n]=r[n];console.log(W[1869]+e),console.log(W[1870]+t),wx.request({url:W[1818]+HOST+W[1871]+e+W[1872]+encodeURIComponent(JSON.stringify(t))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(){sdk.Download()},setMessageToFriendQuery:function(e,r){e=e.activity_id;e=wx.setMessageToFriendQuery({shareMessageToFriendScene:e});r&&r(e)},getFriendShareInfo:function(r){this.getShareInfo(W[1813],function(e){r&&r({title:e.title,img:e.img})})}}}function run(e,r,t){e in $LTDFNP&&$LTDFNP[e](r,t)}exports.init=function(e,r){run(W[238],e,r)},exports.login=function(e){run(W[261],"",e)},exports.pay=function(e,r){run(W[348],e,r)},exports.openService=function(e){run(W[367],e)},exports.isChangePay=function(e,r){run(W[1873],e,r)},exports.logCreateRole=function(e,r,t,n,i){run(W[361],{serverId:e,serverName:r,roleId:t,roleName:n,roleLevel:i})},exports.logEnterGame=function(e,r,t,n,i){run(W[363],{serverId:e,serverName:r,roleId:t,roleName:n,roleLevel:i})},exports.logRoleUpLevel=function(e,r,t,n,i){run(W[365],{serverId:e,serverName:r,roleId:t,roleName:n,roleLevel:i})},exports.share=function(e,r){r=r&&r.activity_id?r.activity_id:"";run(W[366],{type:e,cp_activity_id:r})},exports.msgCheck=function(e,r){run(W[201],e,r)},exports.downloadClient=function(){run(W[1874])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(W[1875])},exports.weiduanHelper=function(){run(W[369])},exports.setMessageToFriendQuery=function(e,r){run(W[1876],e,r)},exports.getFriendShareInfo=function(e){run(W[1877],e)};