var Laya=window.Laya=function(uc,uW){var uR={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(uW,uj){return 1==arguments.length?uR.__presubstr.call(this,uW):uR.__presubstr.call(this,uW,0<uj?uj:this.length+uj)},__init:function(uW){uW.forEach(function(uW){uW.__init$&&uW.__init$()})},__isClass:function(uW){return uW&&(uW.__isclass||uW==Object||uW==String||uW==Array)},__newvec:function(uW,uj){var ut=[];ut.length=uW;for(var ud=0;ud<uW;ud++)ut[ud]=uj;return ut},__extend:function(uW,uj){for(var ut in uj)if(uj.hasOwnProperty(ut)){var ud=Object.getOwnPropertyDescriptor(uj,ut),ub=ud.get,uE=ud.set;ub||uE?ub&&uE?Object.defineProperty(uW,ut,ud):(ub&&Object.defineProperty(uW,ut,ub),uE&&Object.defineProperty(uW,ut,uE)):uW[ut]=uj[ut]}function uO(){uR.un(this,"constructor",uW)}uO.prototype=uj.prototype,uW.prototype=new uO,uR.un(uW.prototype,"__imps",uR.__copy({},uj.prototype.__imps))},__copy:function(uW,uj){if(!uj)return null;for(var ut in uW=uW||{},uj)uW[ut]=uj[ut];return uW},__package:function(uW,uj){if(!uR.__packages[uW]){uR.__packages[uW]=!0;var ut=uc,ud=uW.split(".");if(1<ud.length)for(var ub=0,uE=ud.length-1;ub<uE;ub++){var uO=ut[ud[ub]];ut=uO||(ut[ud[ub]]={})}ut[ud[ud.length-1]]||(ut[ud[ud.length-1]]=uj||{})}},__hasOwnProperty:function(uW,uj){return uj=uj||this,Object.hasOwnProperty.call(uj,uW)||function uW(uj,ut){if(Object.hasOwnProperty.call(ut.prototype,uj))return!0;var ud=ut.prototype.__super;return null==ud?null:uW(uj,ud)}(uW,uj.__class)},__typeof:function(uW,uj){if(!uW||!uj)return!1;if(uj===String)return"string"==typeof uW;if(uj===Number)return"number"==typeof uW;if(uj.__interface__)uj=uj.__interface__;else if("string"!=typeof uj)return uW instanceof uj;return uW.__imps&&uW.__imps[uj]||uW.__class==uj},__as:function(uW,uj){return this.__typeof(uW,uj)?uW:null},__int:function(uW){return uW?parseInt(uW):0},interface:function(uW,uj){uR.__package(uW,{});var ut=uR.__internals,ud=ut[uW]=ut[uW]||{self:uW};if(uj){var ub=uj.split(",");ud.extend=[];for(var uE=0;uE<ub.length;uE++){var uO=ub[uE];ut[uO]=ut[uO]||{self:uO},ud.extend.push(ut[uO])}}var uq=uc,uA=uW.split(".");for(uE=0;uE<uA.length-1;uE++)uq=uq[uA[uE]];uq[uA[uA.length-1]]={__interface__:uW}},class:function(uW,uj,ut,ud){if(ut&&uR.__extend(uW,ut),uj)if(uR.__package(uj,uW),uR.__classmap[uj]=uW,0<uj.indexOf(".")){if(0==uj.indexOf("laya.")){var ub=uj.split(".");ud=ud||ub[ub.length-1],uR[ud]&&console.log("Warning!,this class["+ud+"] already exist:",uR[ud]),uR[ud]=uW}}else"Main"==uj?uc.Main=uW:"MainWX"==uj?uc.MainWX=uW:(uR[uj]&&console.log("Error!,this class["+uj+"] already exist:",uR[uj]),uR[uj]=uW);var uE=uR.un,uO=uW.prototype;uE(uO,"hasOwnProperty",uR.__hasOwnProperty),uE(uO,"__class",uW),uE(uO,"__super",ut),uE(uO,"__className",uj),uE(uW,"__super",ut),uE(uW,"__className",uj),uE(uW,"__isclass",!0),uE(uW,"super",function(uW){this.__super.call(uW)})},imps:function(uW,uj){if(!uj)return null;var ub=uW.__imps||uR.un(uW,"__imps",{});function uE(uW){var uj,ut;if((uj=uR.__internals[uW])&&(ub[uW]=!0,ut=uj.extend))for(var ud=0;ud<ut.length;ud++)uE(ut[ud].self)}for(var ut in uj)uE(ut)},superSet:function(uW,uj,ut,ud){var ub=uW.prototype["_$set_"+ut];ub&&ub.call(uj,ud)},superGet:function(uW,uj,ut){var ud=uW.prototype["_$get_"+ut];return ud?ud.call(uj):null},getset:function(uW,uj,ut,ud,ub){uW?(ud&&(uj["_$GET_"+ut]=ud),ub&&(uj["_$SET_"+ut]=ub)):(ud&&uR.un(uj,"_$get_"+ut,ud),ub&&uR.un(uj,"_$set_"+ut,ub)),ud&&ub?Object.defineProperty(uj,ut,{get:ud,set:ub,enumerable:!1,configurable:!0}):(ud&&Object.defineProperty(uj,ut,{get:ud,enumerable:!1,configurable:!0}),ub&&Object.defineProperty(uj,ut,{set:ub,enumerable:!1,configurable:!0}))},static:function(ut,ud){for(var ub=0,uW=ud.length;ub<uW;ub+=2)if("length"==ud[ub])ut.length=ud[ub+1].call(ut);else{function uj(){var uj=ud[ub],uW=ud[ub+1];Object.defineProperty(ut,uj,{get:function(){return delete this[uj],this[uj]=uW.call(this)},set:function(uW){delete this[uj],this[uj]=uW},enumerable:!0,configurable:!0})}uj()}},un:function(uW,uj,ut){return ut||(ut=uW[uj]),uR.__propun.value=ut,Object.defineProperty(uW,uj,uR.__propun),ut},uns:function(uj,uW){uW.forEach(function(uW){uR.un(uj,uW)})}};return uc.console=uc.console||{log:function(){}},uc.trace=uc.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),uR}(window,document);!function(uW,uj,ut){ut.un,ut.uns,ut.static,ut.class,ut.getset,ut.__newvec}(window,document,Laya),function(uO,uj,uN){uN.un,uN.uns;var uA=uN.static,ue=uN.class,uR=uN.getset;uN.__newvec;uN.interface("laya.runtime.IMarket"),uN.interface("laya.filters.IFilter"),uN.interface("laya.display.ILayout"),uN.interface("laya.resource.IDispose"),uN.interface("laya.runtime.IPlatform"),uN.interface("laya.resource.IDestroy"),uN.interface("laya.runtime.IConchNode"),uN.interface("laya.filters.IFilterAction"),uN.interface("laya.runtime.ICPlatformClass"),uN.interface("laya.resource.ICreateResource"),uN.interface("laya.runtime.IConchRenderObject"),uN.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var uG=function(){function uE(){}return ue(uE,"laya.utils.RunDriver"),uE.FILTER_ACTIONS=[],uE.pixelRatio=-1,uE._charSizeTestDiv=null,uE.now=function(){return Date.now()},uE.getWindow=function(){return uO},uE.getPixelRatio=function(){if(uE.pixelRatio<0){var uW=uY.context,uj=uW.backingStorePixelRatio||uW.webkitBackingStorePixelRatio||uW.mozBackingStorePixelRatio||uW.msBackingStorePixelRatio||uW.oBackingStorePixelRatio||uW.backingStorePixelRatio||1;(uE.pixelRatio=(uY.window.devicePixelRatio||1)/uj)<1&&(uE.pixelRatio=1)}return uE.pixelRatio},uE.getIncludeStr=function(uW){return null},uE.createShaderCondition=function(uW){var uj="(function() {return "+uW+";})";return uN._runScript(uj)},uE.fontMap=[],uE.measureText=function(uW,uj){var ut=uE.hanzi.test(uW);if(ut&&uE.fontMap[uj])return uE.fontMap[uj];var ud=uY.context;ud.font=uj;var ub=ud.measureText(uW);return ut&&(uE.fontMap[uj]=ub),ub},uE.getWebGLContext=function(uW){},uE.beginFlush=function(){},uE.endFinish=function(){},uE.addToAtlas=null,uE.flashFlushImage=function(uW){},uE.drawToCanvas=function(uW,uj,ut,ud,ub,uE){var uO=uMW.create("2D"),uq=new ua(ut,ud,uO);return uu.renders[uj]._fun(uW,uq,ub,uE),uO},uE.createParticleTemplate2D=null,uE.createGLTextur=null,uE.createWebGLContext2D=null,uE.changeWebGLSize=function(uW,uj){},uE.createRenderSprite=function(uW,uj){return new uu(uW,uj)},uE.createFilterAction=function(uW){return new uM},uE.createGraphics=function(){return new uQ},uE.clear=function(uW){uy._context.ctx.clear()},uE.cancelLoadByUrl=function(uW){},uE.clearAtlas=function(uW){},uE.isAtlas=function(uW){return!1},uE.addTextureToAtlas=function(uW){},uE.getTexturePixels=function(uW,uj,ut,ud,ub){return null},uE.skinAniSprite=function(){return null},uE.update3DLoop=function(){},uA(uE,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),uE}(),ud=(uR(1,uN,"alertGlobalError",null,function(uW){var uE=0;uY.window.onerror=uW?function(uW,uj,ut,ud,ub){uE++<5&&ub&&alert(ub.stack||ub)}:null}),uN.init=function(uW,uj,ut){for(var ud=[],ub=2,uE=arguments.length;ub<uE;ub++)ud.push(arguments[ub]);if(!uN._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=uN._arrayBufferSlice),uN._isinit=!0,uY.__init__(),uD.__init__(),uQ.__init__(),uN.timer=new ui,uN.scaleTimer=new ui,uN.loader=new uAW,up.__init__(),ub=0;for(var uO=ud.length;ub<uO;ub++)ud[ub].enable&&ud[ub].enable();return uT.__init__(),uq.__init__(),us.__init__(),uI.beginCheck(),uN._currentStage=uN.stage=new uoW,uN.stage.conchModel&&uN.stage.conchModel.setRootNode(),uN._getUrlPath(),uN.render=new uy(0,0),uN.stage.size(uW,uj),uu.__init__(),um.__init__(),u$.instance.__init__(uN.stage,uy.canvas),uXW.__init__(),ux.autoStopMusic=!0,uL.__init__(),uy.canvas}},uN._getUrlPath=function(){var uW=uY.window.location,uj=uW.pathname;uj=uj&&":"==uj.charAt(2)?uj.substring(1):uj,uv.rootPath=uv.basePath=uv.getPath("file:"==uW.protocol?uj:uW.protocol+"//"+uW.host+uW.pathname)},uN._arrayBufferSlice=function(uW,uj){var ut=new Uint8Array(this,uW,uj-uW),ud=new Uint8Array(ut.length);return ud.set(ut),ud.buffer},uN._runScript=function(uW){return uY.window[uN._evcode](uW)},uN.stage=null,uN.timer=null,uN.scaleTimer=null,uN.loader=null,uN.version="1.8.6",uN.render=null,uN._currentStage=null,uN._isinit=!1,uN.isDebug=!1,uN.MiniAdpter={init:function(){uO.navigator&&uO.navigator.userAgent&&-1<uO.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},uA(uN,["conchMarket",function(){return this.conchMarket=uO.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=uO.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function uW(){}return ue(uW,"Config"),uW.WebGLTextCacheCount=500,uW.atlasEnable=!1,uW.showCanvasMark=!1,uW.animationInterval=50,uW.isAntialias=!1,uW.isAlpha=!1,uW.premultipliedAlpha=!0,uW.isStencil=!0,uW.preserveDrawingBuffer=!1,uW}()),uc=function(){function uc(){this._events=null}ue(uc,"laya.events.EventDispatcher");var uW=uc.prototype;return uW.hasListener=function(uW){return!!(this._events&&this._events[uW])},uW.event=function(uW,uj){if(!this._events||!this._events[uW])return!1;var ut=this._events[uW];if(ut.lock)ut.queue||(ut.queue=[]),ut.queue.push(uj);else{var ud;for(ut.lock=!0,ut.cursor=ut.head;ut.cursor;)ud=ut.cursor,ut.cursor=ud.next,ud.once&&uc.delNode(ut,ud),null!=uj?ud.args?ud.method.apply(ud.caller,ud.args.concat(uj)):uj instanceof Array?ud.method.apply(ud.caller,uj):ud.method.call(ud.caller,uj):ud.method.apply(ud.caller,ud.args),ud.once&&uc.recoverHandler(ud);ut.lock=!1,!ut.head&&this._events&&this._events[uW]==ut&&delete this._events[uW],ut.queue&&ut.queue.length&&this.event(uW,ut.queue.shift())}return!0},uW.on=function(uW,uj,ut,ud){return this._createListener(uW,uj,ut,ud,!1)},uW.once=function(uW,uj,ut,ud){return this._createListener(uW,uj,ut,ud,!0)},uW._createListener=function(uW,uj,ut,ud,ub,uE){void 0===uE&&(uE=!0),uE&&this.off(uW,uj,ut,ub);var uO=uc.createHandler(uj||this,ut,ud,ub);this._events||(this._events={});var uq=this._events,uA=uq[uW];return uA?uA.tail?(uO.prev=uA.tail,uA.tail.next=uO,uA.tail=uO):uA.head=uA.tail=uO:uq[uW]={head:uO,tail:uO,cursor:null,lock:!1},this},uW.off=function(uW,uj,ut,ud){if(void 0===ud&&(ud=!1),!this._events||!this._events[uW])return this;for(var ub=this._events[uW],uE=ub.head;uE;){if((!uj||uE.caller===uj)&&uE.method===ut&&(!ud||uE.once)){uc.delNode(ub,uE),ub.cursor==uE&&(ub.cursor=uE.next),uc.recoverHandler(uE);break}uE=uE.next}return this},uW.offAll=function(uW){var uj=this._events;if(!uj)return this;if(uW)this._recoverHandlers(uj[uW]),delete uj[uW];else{for(var ut in uj)this._recoverHandlers(uj[ut]);this._events=null}return this},uW._recoverHandlers=function(uW){if(uW){for(var uj=uW.head;uj;){uc.delNode(uW,uj);var ut=uj.next;uc.recoverHandler(uj),uj=ut}uW.cursor=null}},uW.isMouseEvent=function(uW){return uc.MOUSE_EVENTS[uW]},uc.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},uc.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},uc.delNode=function(uW,uj){uj.prev?uj.prev.next=uj.next:uW.head=uj.next,uj.next?uj.next.prev=uj.prev:uW.tail=uj.prev},uc.createHandler=function(uW,uj,ut,ud){var ub=uc._freeHandler;return ub?(uc._freeCount--,uc._freeHandler=ub.next,ub.caller=uW,ub.method=uj,ub.args=ut,ub.once=ud):ub={caller:uW,method:uj,args:ut,once:ud},ub.prev=ub.next=null,ub},uc.recoverHandler=function(uW){uW.caller=uW.method=uW.args=uW.prev=null,uW.next=uc._freeHandler,uc._freeHandler=uW,uc._freeCount++},uc._freeHandler=null,uc._freeCount=0,uc}(),uS=function(){function ub(uW,uj,ut,ud){this.once=!1,void(this._id=0)===ud&&(ud=!1),this.setTo(uW,uj,ut,ud)}ue(ub,"laya.utils.Handler");var uW=ub.prototype;return uW.setTo=function(uW,uj,ut,ud){return this._id=ub._gid++,this.caller=uW,this.method=uj,this.args=ut,this.once=ud,this},uW.run=function(){if(null==this.method)return null;var uW=this._id,uj=this.method.apply(this.caller,this.args);return this._id===uW&&this.once&&this.recover(),uj},uW.runWith=function(uW){if(null==this.method)return null;var uj=this._id;if(null==uW)var ut=this.method.apply(this.caller,this.args);else ut=this.args||uW.unshift?this.args?this.method.apply(this.caller,this.args.concat(uW)):this.method.apply(this.caller,uW):this.method.call(this.caller,uW);return this._id===uj&&this.once&&this.recover(),ut},uW.clear=function(){return this.caller=null,this.method=null,this.args=null,this},uW.recover=function(){0<this._id&&(this._id=0,this.clear())},ub.create=function(uW,uj,ut,ud){return void 0===ud&&(ud=!0),new ub(uW,uj,ut,ud)},ub._gid=1,ub}(),uV=function(){function uW(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}ue(uW,"laya.display.BitmapFont");var uj=uW.prototype;return uj.loadFont=function(uW,uj){this._path=uW,this._complete=uj,uN.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],uS.create(this,this.onLoaded))},uj.onLoaded=function(){this.parseFont(uqW.getRes(this._path),uqW.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},uj.parseFont=function(uW,uj){if(null!=uW&&null!=uj){this._texture=uj;var ut=uW.getElementsByTagName("info");if(!ut[0].getAttributeNode)return this.parseFont2(uW,uj);this.fontSize=parseInt(ut[0].getAttributeNode("size").nodeValue);var ud,ub=ut[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(ub[0]),parseInt(ub[1]),parseInt(ub[2]),parseInt(ub[3])],ud=uW.getElementsByTagName("char");var uE=0;for(uE=0;uE<ud.length;uE++){var uO=ud[uE],uq=parseInt(uO.getAttributeNode("id").nodeValue),uA=parseInt(uO.getAttributeNode("xoffset").nodeValue)/1,uc=parseInt(uO.getAttributeNode("yoffset").nodeValue)/1,uR=parseInt(uO.getAttributeNode("xadvance").nodeValue)/1,um=new uC;um.x=parseInt(uO.getAttributeNode("x").nodeValue),um.y=parseInt(uO.getAttributeNode("y").nodeValue),um.width=parseInt(uO.getAttributeNode("width").nodeValue),um.height=parseInt(uO.getAttributeNode("height").nodeValue);var uQ=uRW.create(uj,um.x,um.y,um.width,um.height,uA,uc);this._maxWidth=Math.max(this._maxWidth,uR+this.letterSpacing),this._fontCharDic[uq]=uQ,this._fontWidthMap[uq]=uR}}},uj.parseFont2=function(uW,uj){if(null!=uW&&null!=uj){this._texture=uj;var ut=uW.getElementsByTagName("info");this.fontSize=parseInt(ut[0].attributes.size.nodeValue);var ud=ut[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(ud[0]),parseInt(ud[1]),parseInt(ud[2]),parseInt(ud[3])];var ub=uW.getElementsByTagName("char"),uE=0;for(uE=0;uE<ub.length;uE++){var uO=ub[uE].attributes,uq=parseInt(uO.id.nodeValue),uA=parseInt(uO.xoffset.nodeValue)/1,uc=parseInt(uO.yoffset.nodeValue)/1,uR=parseInt(uO.xadvance.nodeValue)/1,um=new uC;um.x=parseInt(uO.x.nodeValue),um.y=parseInt(uO.y.nodeValue),um.width=parseInt(uO.width.nodeValue),um.height=parseInt(uO.height.nodeValue);var uQ=uRW.create(uj,um.x,um.y,um.width,um.height,uA,uc);this._maxWidth=Math.max(this._maxWidth,uR+this.letterSpacing),this._fontCharDic[uq]=uQ,this._fontWidthMap[uq]=uR}}},uj.getCharTexture=function(uW){return this._fontCharDic[uW.charCodeAt(0)]},uj.destroy=function(){if(this._texture){for(var uW in this._fontCharDic){var uj=this._fontCharDic[uW];uj&&uj.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},uj.setSpaceWidth=function(uW){this._spaceWidth=uW},uj.getCharWidth=function(uW){var uj=uW.charCodeAt(0);return this._fontWidthMap[uj]?this._fontWidthMap[uj]+this.letterSpacing:" "==uW?this._spaceWidth+this.letterSpacing:0},uj.getTextWidth=function(uW){for(var uj=0,ut=0,ud=uW.length;ut<ud;ut++)uj+=this.getCharWidth(uW.charAt(ut));return uj},uj.getMaxWidth=function(){return this._maxWidth},uj.getMaxHeight=function(){return this.fontSize},uj.drawText=function(uW,uj,ut,ud,ub,uE){var uO,uq=this.getTextWidth(uW),uA=0;"center"===ub&&(uA=(uE-uq)/2),"right"===ub&&(uA=uE-uq);for(var uc=0,uR=0,um=uW.length;uR<um;uR++)(uO=this.getCharTexture(uW.charAt(uR)))&&(uj.graphics.drawTexture(uO,ut+uc+uA,ud),uc+=this.getCharWidth(uW.charAt(uR)))},uW}(),uq=function(){function ut(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=ut._TF_EMPTY}ue(ut,"laya.display.css.Style");var uW=ut.prototype;return uW.getTransform=function(){return this._tf},uW.setTransform=function(uW){this._tf="none"!==uW&&uW?uW:ut._TF_EMPTY},uW.setTranslateX=function(uW){this._tf===ut._TF_EMPTY&&(this._tf=new ub),this._tf.translateX=uW},uW.setTranslateY=function(uW){this._tf===ut._TF_EMPTY&&(this._tf=new ub),this._tf.translateY=uW},uW.setScaleX=function(uW){this._tf===ut._TF_EMPTY&&(this._tf=new ub),this._tf.scaleX=uW},uW.setScale=function(uW,uj){this._tf===ut._TF_EMPTY&&(this._tf=new ub),this._tf.scaleX=uW,this._tf.scaleY=uj},uW.setScaleY=function(uW){this._tf===ut._TF_EMPTY&&(this._tf=new ub),this._tf.scaleY=uW},uW.setRotate=function(uW){this._tf===ut._TF_EMPTY&&(this._tf=new ub),this._tf.rotate=uW},uW.setSkewX=function(uW){this._tf===ut._TF_EMPTY&&(this._tf=new ub),this._tf.skewX=uW},uW.setSkewY=function(uW){this._tf===ut._TF_EMPTY&&(this._tf=new ub),this._tf.skewY=uW},uW.destroy=function(){this.scrollRect=null},uW.render=function(uW,uj,ut,ud){},uW.getCSSStyle=function(){return ujW.EMPTY},uW._enableLayout=function(){return!1},uR(0,uW,"scaleX",function(){return this._tf.scaleX},function(uW){this.setScaleX(uW)}),uR(0,uW,"transform",function(){return this.getTransform()},function(uW){this.setTransform(uW)}),uR(0,uW,"translateX",function(){return this._tf.translateX},function(uW){this.setTranslateX(uW)}),uR(0,uW,"translateY",function(){return this._tf.translateY},function(uW){this.setTranslateY(uW)}),uR(0,uW,"scaleY",function(){return this._tf.scaleY},function(uW){this.setScaleY(uW)}),uR(0,uW,"block",function(){return 0!=(1&this._type)}),uR(0,uW,"skewY",function(){return this._tf.skewY},function(uW){this.setSkewY(uW)}),uR(0,uW,"rotate",function(){return this._tf.rotate},function(uW){this.setRotate(uW)}),uR(0,uW,"skewX",function(){return this._tf.skewX},function(uW){this.setSkewX(uW)}),uR(0,uW,"paddingLeft",function(){return 0}),uR(0,uW,"paddingTop",function(){return 0}),uR(0,uW,"absolute",function(){return!0}),ut.__init__=function(){ut._TF_EMPTY=new ub,ut.EMPTY=new ut},ut.EMPTY=null,ut._TF_EMPTY=null,ut}(),uT=function(){function uj(uW){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=uf.create(uj.defaultColor),this.family=uj.defaultFamily,this.stroke=uj._STROKE,this.size=uj.defaultSize,uW&&uW!==uj.EMPTY&&uW.copyTo(this)}ue(uj,"laya.display.css.Font");var uW=uj.prototype;return uW.set=function(uW){this._text=null;for(var uj=uW.split(" "),ut=0,ud=uj.length;ut<ud;ut++){var ub=uj[ut];switch(ub){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<ub.indexOf("px")&&(this.size=parseInt(ub),this.family=uj[ut+1],ut++)}},uW.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},uW.copyTo=function(uW){uW._type=this._type,uW._text=this._text,uW._weight=this._weight,uW._color=this._color,uW.family=this.family,uW.stroke=this.stroke!=uj._STROKE?this.stroke.slice():uj._STROKE,uW.indent=this.indent,uW.size=this.size},uR(0,uW,"password",function(){return 0!=(1024&this._type)},function(uW){uW?this._type|=1024:this._type&=-1025}),uR(0,uW,"color",function(){return this._color.strColor},function(uW){this._color=uf.create(uW)}),uR(0,uW,"italic",function(){return 0!=(512&this._type)},function(uW){uW?this._type|=512:this._type&=-513}),uR(0,uW,"bold",function(){return 0!=(2048&this._type)},function(uW){uW?this._type|=2048:this._type&=-2049}),uR(0,uW,"weight",function(){return""+this._weight},function(uW){var uj=0;switch(uW){case"normal":break;case"bold":this.bold=!0,uj=700;break;case"bolder":uj=800;break;case"lighter":uj=100;break;default:uj=parseInt(uW)}this._weight=uj,this._text=null}),uR(0,uW,"decoration",function(){return this._decoration?this._decoration.value:null},function(uW){var uj=uW.split(" ");switch(this._decoration||(this._decoration={}),uj[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=uj[0]}uj[1]&&(this._decoration.color=uf.create(uj)),this._decoration.value=uW}),uj.__init__=function(){uj.EMPTY=new uj(null)},uj.EMPTY=null,uj.defaultColor="#000000",uj.defaultSize=12,uj.defaultFamily="Arial",uj.defaultFont="12px Arial",uj._STROKE=[0,"#000000"],uj._ITALIC=512,uj._PASSWORD=1024,uj._BOLD=2048,uj}(),ub=function(){function uW(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return ue(uW,"laya.display.css.TransformInfo"),uW}(),uQ=function(){function um(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,uy.isConchNode){this._nativeObj=new uO._conchGraphics,this.id=this._nativeObj.conchID}}ue(um,"laya.display.Graphics");var uW=um.prototype;return uW.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},uW.clear=function(uW){void 0===uW&&(uW=!1);var uj=0,ut=0;if(uW){var ud=this._one;if(this._cmds){for(ut=this._cmds.length,uj=0;uj<ut;uj++)!(ud=this._cmds[uj])||ud.callee!==uy._context._drawTexture&&ud.callee!==uy._context._drawTextureWithTransform||(ud[0]=null,um._cache.push(ud));this._cmds.length=0}else ud&&(!ud||ud.callee!==uy._context._drawTexture&&ud.callee!==uy._context._drawTextureWithTransform||(ud[0]=null,um._cache.push(ud)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(uj=0,ut=this._vectorgraphArray.length;uj<ut;uj++)uk.getInstance().deleteShape(this._vectorgraphArray[uj]);this._vectorgraphArray.length=0}},uW._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},uW._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new ut,this._graphicBounds._graphics=this)},uW._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},uW._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},uW.getBounds=function(uW){return void 0===uW&&(uW=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(uW)},uW.getBoundPoints=function(uW){return void 0===uW&&(uW=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(uW)},uW._addCmd=function(uW){this._cmds=this._cmds||[],uW.callee=uW.shift(),this._cmds.push(uW)},uW.setFilters=function(uW){this._saveToCmd(uy._context._setFilters,uW)},uW.drawTexture=function(uW,uj,ut,ud,ub,uE,uO){if(void 0===uj&&(uj=0),void 0===ut&&(ut=0),void 0===ud&&(ud=0),void 0===ub&&(ub=0),void 0===uO&&(uO=1),!uW||uO<.01)return null;ud||(ud=uW.sourceWidth),ub||(ub=uW.sourceHeight),uO=uO<0?0:1<uO?1:uO;var uq,uA=!uy.isWebGL&&(uY.onFirefox||uY.onEdge||uY.onIE||uY.onSafari)?.5:0,uc=ud/uW.sourceWidth,uR=ub/uW.sourceHeight;return ud=uW.width*uc,ub=uW.height*uR,uW.loaded&&(ud<=0||ub<=0)?null:(uj+=uW.offsetX*uc,ut+=uW.offsetY*uR,this._sp&&(this._sp._renderType|=512),uj-=uA,ut-=uA,ud+=2*uA,ub+=2*uA,um._cache.length?((uq=um._cache.pop())[0]=uW,uq[1]=uj,uq[2]=ut,uq[3]=ud,uq[4]=ub,uq[5]=uE,uq[6]=uO):uq=[uW,uj,ut,ud,ub,uE,uO],uq.callee=uE||1!=uO?uy._context._drawTextureWithTransform:uy._context._drawTexture,null!=this._one||uE||1!=uO?this._saveToCmd(uq.callee,uq):(this._one=uq,this._render=this._renderOneImg),uW.loaded||uW.once("loaded",this,this._textureLoaded,[uW,uq]),this._repaint(),uq)},uW.cleanByTexture=function(uW,uj,ut,ud,ub){if(void 0===ud&&(ud=0),void 0===ub&&(ub=0),!uW)return this.clear();if(this._one&&this._render===this._renderOneImg){ud||(ud=uW.sourceWidth),ub||(ub=uW.sourceHeight);var uE=ud/uW.sourceWidth,uO=ub/uW.sourceHeight;ud=uW.width*uE,ub=uW.height*uO,uj+=uW.offsetX*uE,ut+=uW.offsetY*uO,this._one[0]=uW,this._one[1]=uj,this._one[2]=ut,this._one[3]=ud,this._one[4]=ub,this._repaint()}else this.clear(),uW&&this.drawTexture(uW,uj,ut,ud,ub)},uW.drawTextures=function(uW,uj){uW&&this._saveToCmd(uy._context._drawTextures,[uW,uj])},uW.fillTexture=function(uW,uj,ut,ud,ub,uE,uO){if(void 0===ud&&(ud=0),void 0===ub&&(ub=0),void 0===uE&&(uE="repeat"),uW){var uq=[uW,uj,ut,ud,ub,uE,uO||uz.EMPTY,{}];uW.loaded||uW.once("loaded",this,this._textureLoaded,[uW,uq]),this._saveToCmd(uy._context._fillTexture,uq)}},uW._textureLoaded=function(uW,uj){uj[3]=uj[3]||uW.width,uj[4]=uj[4]||uW.height,this._repaint()},uW.fillCircle=function(uW,uj,ut,ud,ub,uE,uO){ut.bitmap.enableMerageInAtlas=!1;var uq=new Float32Array(2*(uO+1)),uA=new Float32Array(2*(uO+1)),uc=new Uint16Array(3*uO),uR=2*Math.PI/uO,um=0;uq[0]=ud,uq[1]=ub,uA[0]=ud/ut.width,uA[1]=ub/ut.height;for(var uQ=2,uT=0;uT<uO;uT++){var u$=uE*Math.cos(um)+ud,ue=uE*Math.sin(um)+ub;uq[uQ]=u$,uq[uQ+1]=ue,uA[uQ]=u$/ut.width,uA[uQ+1]=ue/ut.height,um+=uR,uQ+=2}for(uT=uQ=0;uT<uO;uT++)uc[uQ++]=0,uc[uQ++]=uT+1,uc[uQ++]=uO+1<=uT+2?1:uT+2;this.drawTriangles(ut,uW,uj,uq,uA,uc)},uW.drawTriangles=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){void 0===uq&&(uq=1),this._saveToCmd(uy._context.drawTriangles,[uW,uj,ut,ud,ub,uE,uO,uq,uA,uc])},uW._saveToCmd=function(uW,uj){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=uj,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(uj)),uj.callee=uW,this._repaint(),uj},uW.clipRect=function(uW,uj,ut,ud){this._saveToCmd(uy._context._clipRect,[uW,uj,ut,ud])},uW.fillText=function(uW,uj,ut,ud,ub,uE,uO){void 0===uO&&(uO=0),this._saveToCmd(uy._context._fillText,[uW,uj,ut,ud||uT.defaultFont,ub,uE])},uW.fillBorderText=function(uW,uj,ut,ud,ub,uE,uO,uq){this._saveToCmd(uy._context._fillBorderText,[uW,uj,ut,ud||uT.defaultFont,ub,uE,uO,uq])},uW.strokeText=function(uW,uj,ut,ud,ub,uE,uO){this._saveToCmd(uy._context._strokeText,[uW,uj,ut,ud||uT.defaultFont,ub,uE,uO])},uW.alpha=function(uW){uW=uW<0?0:1<uW?1:uW,this._saveToCmd(uy._context._alpha,[uW])},uW.setAlpha=function(uW){uW=uW<0?0:1<uW?1:uW,this._saveToCmd(uy._context._setAlpha,[uW])},uW.transform=function(uW,uj,ut){void 0===uj&&(uj=0),void 0===ut&&(ut=0),this._saveToCmd(uy._context._transform,[uW,uj,ut])},uW.rotate=function(uW,uj,ut){void 0===uj&&(uj=0),void 0===ut&&(ut=0),this._saveToCmd(uy._context._rotate,[uW,uj,ut])},uW.scale=function(uW,uj,ut,ud){void 0===ut&&(ut=0),void 0===ud&&(ud=0),this._saveToCmd(uy._context._scale,[uW,uj,ut,ud])},uW.translate=function(uW,uj){this._saveToCmd(uy._context._translate,[uW,uj])},uW.save=function(){this._saveToCmd(uy._context._save,[])},uW.restore=function(){this._saveToCmd(uy._context._restore,[])},uW.replaceText=function(uW){this._repaint();var uj=this._cmds;if(uj){for(var ut=uj.length-1;-1<ut;ut--)if(this._isTextCmd(uj[ut].callee))return uj[ut][0].toUpperCase?uj[ut][0]=uW:uj[ut][0].setText(uW),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=uW:this._one[0].setText(uW),!0;return!1},uW._isTextCmd=function(uW){return uW===uy._context._fillText||uW===uy._context._fillBorderText||uW===uy._context._strokeText},uW.replaceTextColor=function(uW){this._repaint();var uj=this._cmds;if(uj)for(var ut=uj.length-1;-1<ut;ut--)this._isTextCmd(uj[ut].callee)&&(uj[ut][4]=uW,uj[ut][0].toUpperCase||(uj[ut][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=uW,this._one[0].toUpperCase||(this._one[0].changed=!0))},uW.loadImage=function(uW,uj,ut,ud,ub,uE){var uO=this;void 0===uj&&(uj=0),void 0===ut&&(ut=0),void 0===ud&&(ud=0),void 0===ub&&(ub=0);var uq=uqW.getRes(uW);function uA(uW){uW&&(uO.drawTexture(uW,uj,ut,ud,ub),null!=uE&&uE.call(uO._sp,uW))}uq?uA(uq):uN.loader.load(uW,uS.create(null,uA),null,"image")},uW._renderEmpty=function(uW,uj,ut,ud){},uW._renderAll=function(uW,uj,ut,ud){for(var ub,uE=this._cmds,uO=0,uq=uE.length;uO<uq;uO++)(ub=uE[uO]).callee.call(uj,ut,ud,ub)},uW._renderOne=function(uW,uj,ut,ud){this._one.callee.call(uj,ut,ud,this._one)},uW._renderOneImg=function(uW,uj,ut,ud){this._one.callee.call(uj,ut,ud,this._one),2305!==uW._renderType&&(uW._renderType|=1)},uW.drawLine=function(uW,uj,ut,ud,ub,uE){void 0===uE&&(uE=1);var uO=0;uy.isWebGL&&(uO=uk.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(uO));var uq=uE%2==0?0:.5,uA=[uW+uq,uj+uq,ut+uq,ud+uq,ub,uE,uO];this._saveToCmd(uy._context._drawLine,uA)},uW.drawLines=function(uW,uj,ut,ud,ub){void 0===ub&&(ub=1);var uE=0;if(ut&&!(ut.length<4)){uy.isWebGL&&(uE=uk.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(uE));var uO=ub%2==0?0:.5,uq=[uW+uO,uj+uO,ut,ud,ub,uE];this._saveToCmd(uy._context._drawLines,uq)}},uW.drawCurves=function(uW,uj,ut,ud,ub){void 0===ub&&(ub=1);var uE=[uW,uj,ut,ud,ub];this._saveToCmd(uy._context._drawCurves,uE)},uW.drawRect=function(uW,uj,ut,ud,ub,uE,uO){void 0===uO&&(uO=1);var uq=uE?uO/2:0,uA=uE?uO:0,uc=[uW+uq,uj+uq,ut-uA,ud-uA,ub,uE,uO];this._saveToCmd(uy._context._drawRect,uc)},uW.drawCircle=function(uW,uj,ut,ud,ub,uE){void 0===uE&&(uE=1);var uO=ub?uE/2:0,uq=0;uy.isWebGL&&(uq=uk.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(uq));var uA=[uW,uj,ut-uO,ud,ub,uE,uq];this._saveToCmd(uy._context._drawCircle,uA)},uW.drawPie=function(uW,uj,ut,ud,ub,uE,uO,uq){void 0===uq&&(uq=1);var uA=uO?uq/2:0,uc=uO?uq:0,uR=0;uy.isWebGL&&(uR=uk.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(uR));var um=[uW+uA,uj+uA,ut-uc,ud,ub,uE,uO,uq,uR];um[3]=un.toRadian(ud),um[4]=un.toRadian(ub),this._saveToCmd(uy._context._drawPie,um)},uW.drawPoly=function(uW,uj,ut,ud,ub,uE){void 0===uE&&(uE=1);var uO=0,uq=!1;uy.isWebGL&&(uO=uk.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(uO),uq=!(6<ut.length));var uA=ub?uE%2==0?0:.5:0,uc=[uW+uA,uj+uA,ut,ud,ub,uE,uO,uq];this._saveToCmd(uy._context._drawPoly,uc)},uW.drawPath=function(uW,uj,ut,ud,ub){var uE=[uW,uj,ut,ud,ub];this._saveToCmd(uy._context._drawPath,uE)},uR(0,uW,"cmds",function(){return this._cmds},function(uW){this._sp&&(this._sp._renderType|=512),this._cmds=uW,this._render=this._renderAll,this._repaint()}),um.__init__=function(){if(uy.isConchNode){for(var uW=laya.display.Graphics.prototype,uj=uY.window.ConchGraphics.prototype,ut=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],ud=0,ub=ut.length;ud<=ub;ud++){var uE=ut[ud];uW[uE]=uj[uE]}uW._saveToCmd=null,uj.drawImageS&&(uW.drawTextures=function(uW,uj){if(uW&&uW.loaded&&uW.bitmap&&uW.source){var ut=uW.uv,ud=uW.bitmap.width,ub=uW.bitmap.height;this.drawImageS(uW.bitmap.source,ut[0]*ud,ut[1]*ub,(ut[2]-ut[0])*ud,(ut[5]-ut[3])*ub,uW.offsetX,uW.offsetY,uW.width,uW.height,uj)}}),uW.drawTexture=function(uW,uj,ut,ud,ub,uE,uO){if(void 0===uj&&(uj=0),void 0===ut&&(ut=0),void 0===ud&&(ud=0),void 0===ub&&(ub=0),void 0===uO&&(uO=1),uW)if(uW.loaded){if(uW.loaded&&uW.bitmap&&uW.source&&(ud||(ud=uW.sourceWidth),ub||(ub=uW.sourceHeight),uO=uO<0?0:1<uO?1:uO,ud=ud-uW.sourceWidth+uW.width,ub=ub-uW.sourceHeight+uW.height,!(ud<=0||ub<=0))){uj+=uW.offsetX,ut+=uW.offsetY;var uq=uW.uv,uA=uW.bitmap.width,uc=uW.bitmap.height;uq[4]<uq[0]&&uq[5]<uq[1]?this.drawImageM(uW.bitmap.source,uq[4]*uA,uq[5]*uc,(uq[0]-uq[4])*uA,(uq[1]-uq[5])*uc,uj,ut,ud,ub,uE,uO):this.drawImageM(uW.bitmap.source,uq[0]*uA,uq[1]*uc,(uq[2]-uq[0])*uA,(uq[5]-uq[3])*uc,uj,ut,ud,ub,uE,uO),this._repaint()}}else uW.once("loaded",this,function(){this.drawTexture(uW,uj,ut,ud,ub,uE)})},uW.fillTexture=function(uW,uj,ut,ud,ub,uE,uO){if(void 0===ud&&(ud=0),void 0===ub&&(ub=0),void 0===uE&&(uE="repeat"),uW&&uW.loaded){var uq,uA=uy._context.ctx,uc=uW.bitmap.width,uR=uW.bitmap.height,um=uW.uv;uq=uW.uv!=uRW.DEF_UV?uA.createPattern(uW.bitmap.source,uE,um[0]*uc,um[1]*uR,(um[2]-um[0])*uc,(um[5]-um[3])*uR):uA.createPattern(uW.bitmap.source,uE);var uQ=0,uT=0;uO&&(uj+=uO.x%uW.width,ut+=uO.y%uW.height,uQ-=uO.x%uW.width,uT-=uO.y%uW.height),this._fillImage(uq,uj,ut,uQ,uT,ud,ub)}}}},um._cache=[],um}(),ut=function(){function uM(){this._cacheBoundsType=!1}ue(uM,"laya.display.GraphicsBounds");var uW=uM.prototype;return uW.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},uW.reset=function(){this._temp&&(this._temp.length=0)},uW.getBounds=function(uW){return void 0===uW&&(uW=!1),(!this._bounds||!this._temp||this._temp.length<1||uW!=this._cacheBoundsType)&&(this._bounds=uC._getWrapRec(this.getBoundPoints(uW),this._bounds)),this._cacheBoundsType=uW,this._bounds},uW.getBoundPoints=function(uW){return void 0===uW&&(uW=!1),(!this._temp||this._temp.length<1||uW!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(uW)),this._cacheBoundsType=uW,this._rstBoundPoints=un.copyArray(this._rstBoundPoints,this._temp)},uW._getCmdPoints=function(uW){void 0===uW&&(uW=!1);var uj,ut,ud=uy._context,ub=this._graphics.cmds;if((uj=this._temp||(this._temp=[])).length=0,ub||null==this._graphics._one||(uM._tempCmds.length=0,uM._tempCmds.push(this._graphics._one),ub=uM._tempCmds),!ub)return uj;(ut=uM._tempMatrixArrays).length=0;var uE=uM._initMatrix;uE.identity();for(var uO,uq,uA=uM._tempMatrix,uc=NaN,uR=NaN,um=NaN,uQ=NaN,uT=NaN,u$=NaN,ue=0,uK=ub.length;ue<uK;ue++)if((uO=ub[ue]).callee)switch(uO.callee){case ud._save:case 7:ut.push(uE),uE=uE.clone();break;case ud._restore:case 8:uE=ut.pop();break;case ud._scale:case 5:uA.identity(),uA.translate(-uO[2],-uO[3]),uA.scale(uO[0],uO[1]),uA.translate(uO[2],uO[3]),this._switchMatrix(uE,uA);break;case ud._rotate:case 3:uA.identity(),uA.translate(-uO[1],-uO[2]),uA.rotate(uO[0]),uA.translate(uO[1],uO[2]),this._switchMatrix(uE,uA);break;case ud._translate:case 6:uA.identity(),uA.translate(uO[0],uO[1]),this._switchMatrix(uE,uA);break;case ud._transform:case 4:uA.identity(),uA.translate(-uO[1],-uO[2]),uA.concat(uO[0]),uA.translate(uO[1],uO[2]),this._switchMatrix(uE,uA);break;case 16:case 24:uM._addPointArrToRst(uj,uC._getBoundPointS(uO[0],uO[1],uO[2],uO[3]),uE);break;case 17:uE.copyTo(uA),uA.concat(uO[4]),uM._addPointArrToRst(uj,uC._getBoundPointS(uO[0],uO[1],uO[2],uO[3]),uA);break;case ud._drawTexture:uq=uO[0],uW?uO[3]&&uO[4]?uM._addPointArrToRst(uj,uC._getBoundPointS(uO[1],uO[2],uO[3],uO[4]),uE):(uq=uO[0],uM._addPointArrToRst(uj,uC._getBoundPointS(uO[1],uO[2],uq.width,uq.height),uE)):(uc=(uO[3]||uq.sourceWidth)/uq.width,uR=(uO[4]||uq.sourceHeight)/uq.height,um=uc*uq.sourceWidth,uQ=uR*uq.sourceHeight,uT=0<uq.offsetX?uq.offsetX:0,u$=0<uq.offsetY?uq.offsetY:0,uT*=uc,u$*=uR,uM._addPointArrToRst(uj,uC._getBoundPointS(uO[1]-uT,uO[2]-u$,um,uQ),uE));break;case ud._fillTexture:uO[3]&&uO[4]?uM._addPointArrToRst(uj,uC._getBoundPointS(uO[1],uO[2],uO[3],uO[4]),uE):(uq=uO[0],uM._addPointArrToRst(uj,uC._getBoundPointS(uO[1],uO[2],uq.width,uq.height),uE));break;case ud._drawTextureWithTransform:var uo;uo=uO[5]?(uE.copyTo(uA),uA.concat(uO[5]),uA):uE,uW?uO[3]&&uO[4]?uM._addPointArrToRst(uj,uC._getBoundPointS(uO[1],uO[2],uO[3],uO[4]),uo):(uq=uO[0],uM._addPointArrToRst(uj,uC._getBoundPointS(uO[1],uO[2],uq.width,uq.height),uo)):(uq=uO[0],uc=(uO[3]||uq.sourceWidth)/uq.width,uR=(uO[4]||uq.sourceHeight)/uq.height,um=uc*uq.sourceWidth,uQ=uR*uq.sourceHeight,uT=0<uq.offsetX?uq.offsetX:0,u$=0<uq.offsetY?uq.offsetY:0,uT*=uc,u$*=uR,uM._addPointArrToRst(uj,uC._getBoundPointS(uO[1]-uT,uO[2]-u$,um,uQ),uo));break;case ud._drawRect:case 13:uM._addPointArrToRst(uj,uC._getBoundPointS(uO[0],uO[1],uO[2],uO[3]),uE);break;case ud._drawCircle:case ud._fillCircle:case 14:uM._addPointArrToRst(uj,uC._getBoundPointS(uO[0]-uO[2],uO[1]-uO[2],uO[2]+uO[2],uO[2]+uO[2]),uE);break;case ud._drawLine:case 20:uM._tempPoints.length=0;var uS;uS=.5*uO[5],uO[0]==uO[2]?uM._tempPoints.push(uO[0]+uS,uO[1],uO[2]+uS,uO[3],uO[0]-uS,uO[1],uO[2]-uS,uO[3]):uO[1]==uO[3]?uM._tempPoints.push(uO[0],uO[1]+uS,uO[2],uO[3]+uS,uO[0],uO[1]-uS,uO[2],uO[3]-uS):uM._tempPoints.push(uO[0],uO[1],uO[2],uO[3]),uM._addPointArrToRst(uj,uM._tempPoints,uE);break;case ud._drawCurves:case 22:uM._addPointArrToRst(uj,uZ.I.getBezierPoints(uO[2]),uE,uO[0],uO[1]);break;case ud._drawPoly:case ud._drawLines:case 18:uM._addPointArrToRst(uj,uO[2],uE,uO[0],uO[1]);break;case ud._drawPath:case 19:uM._addPointArrToRst(uj,this._getPathPoints(uO[2]),uE,uO[0],uO[1]);break;case ud._drawPie:case 15:uM._addPointArrToRst(uj,this._getPiePoints(uO[0],uO[1],uO[2],uO[3],uO[4]),uE)}return 200<uj.length?uj=un.copyArray(uj,uC._getWrapRec(uj)._getBoundPoints()):8<uj.length&&(uj=uX.scanPList(uj)),uj},uW._switchMatrix=function(uW,uj){uj.concat(uW),uj.copyTo(uW)},uW._getPiePoints=function(uW,uj,ut,ud,ub){var uE=uM._tempPoints;uM._tempPoints.length=0,uE.push(uW,uj);var uO=(ub-ud)%(2*Math.PI)/10,uq=NaN,uA=ud;for(uq=0;uq<=10;uq++)uE.push(uW+ut*Math.cos(uA),uj+ut*Math.sin(uA)),uA+=uO;return uE},uW._getPathPoints=function(uW){var uj,ut,ud=0,ub=uM._tempPoints;for(ub.length=0,uj=uW.length,ud=0;ud<uj;ud++)1<(ut=uW[ud]).length&&(ub.push(ut[1],ut[2]),3<ut.length&&ub.push(ut[3],ut[4]));return ub},uM._addPointArrToRst=function(uW,uj,ut,ud,ub){void 0===ud&&(ud=0),void 0===ub&&(ub=0);var uE,uO=0;for(uE=uj.length,uO=0;uO<uE;uO+=2)uM._addPointToRst(uW,uj[uO]+ud,uj[uO+1]+ub,ut)},uM._addPointToRst=function(uW,uj,ut,ud){var ub=uz.TEMP;ub.setTo(uj||0,ut||0),ud.transformPoint(ub),uW.push(ub.x,ub.y)},uM._tempPoints=[],uM._tempMatrixArrays=[],uM._tempCmds=[],uA(uM,["_tempMatrix",function(){return this._tempMatrix=new ul},"_initMatrix",function(){return this._initMatrix=new ul}]),uM}(),uE=function(){function uW(){}ue(uW,"laya.events.Event");var uj=uW.prototype;return uj.setTo=function(uW,uj,ut){return this.type=uW,this.currentTarget=uj,this.target=ut,this},uj.stopPropagation=function(){this._stoped=!0},uR(0,uj,"stageY",function(){return uN.stage.mouseY}),uR(0,uj,"charCode",function(){return this.nativeEvent.charCode}),uR(0,uj,"touches",function(){var uW=this.nativeEvent.touches;if(uW)for(var uj=uN.stage,ut=0,ud=uW.length;ut<ud;ut++){var ub=uW[ut],uE=uz.TEMP;uE.setTo(ub.clientX,ub.clientY),uj._canvasTransform.invertTransformPoint(uE),uj.transform.invertTransformPoint(uE),ub.stageX=uE.x,ub.stageY=uE.y}return uW}),uR(0,uj,"keyLocation",function(){return this.nativeEvent.keyLocation}),uR(0,uj,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),uR(0,uj,"altKey",function(){return this.nativeEvent.altKey}),uR(0,uj,"shiftKey",function(){return this.nativeEvent.shiftKey}),uR(0,uj,"stageX",function(){return uN.stage.mouseX}),uW.EMPTY=new uW,uW.MOUSE_DOWN="mousedown",uW.MOUSE_UP="mouseup",uW.CLICK="click",uW.RIGHT_MOUSE_DOWN="rightmousedown",uW.RIGHT_MOUSE_UP="rightmouseup",uW.RIGHT_CLICK="rightclick",uW.MOUSE_MOVE="mousemove",uW.MOUSE_OVER="mouseover",uW.MOUSE_OUT="mouseout",uW.MOUSE_WHEEL="mousewheel",uW.ROLL_OVER="mouseover",uW.ROLL_OUT="mouseout",uW.DOUBLE_CLICK="doubleclick",uW.CHANGE="change",uW.CHANGED="changed",uW.RESIZE="resize",uW.ADDED="added",uW.REMOVED="removed",uW.DISPLAY="display",uW.UNDISPLAY="undisplay",uW.ERROR="error",uW.COMPLETE="complete",uW.LOADED="loaded",uW.INITED="inited",uW.PROGRESS="progress",uW.INPUT="input",uW.RENDER="render",uW.OPEN="open",uW.MESSAGE="message",uW.CLOSE="close",uW.KEY_DOWN="keydown",uW.KEY_PRESS="keypress",uW.KEY_UP="keyup",uW.FRAME="enterframe",uW.DRAG_START="dragstart",uW.DRAG_MOVE="dragmove",uW.DRAG_END="dragend",uW.ENTER="enter",uW.SELECT="select",uW.BLUR="blur",uW.FOCUS="focus",uW.VISIBILITY_CHANGE="visibilitychange",uW.FOCUS_CHANGE="focuschange",uW.PLAYED="played",uW.PAUSED="paused",uW.STOPPED="stopped",uW.START="start",uW.END="end",uW.ENABLE_CHANGED="enablechanged",uW.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",uW.COMPONENT_ADDED="componentadded",uW.COMPONENT_REMOVED="componentremoved",uW.LAYER_CHANGED="layerchanged",uW.HIERARCHY_LOADED="hierarchyloaded",uW.RECOVERED="recovered",uW.RELEASED="released",uW.LINK="link",uW.LABEL="label",uW.FULL_SCREEN_CHANGE="fullscreenchange",uW.DEVICE_LOST="devicelost",uW.MESH_CHANGED="meshchanged",uW.MATERIAL_CHANGED="materialchanged",uW.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",uW.ANIMATION_CHANGED="animationchanged",uW.TRIGGER_ENTER="triggerenter",uW.TRIGGER_STAY="triggerstay",uW.TRIGGER_EXIT="triggerexit",uW.TRAIL_FILTER_CHANGE="trailfilterchange",uW.DOMINO_FILTER_CHANGE="dominofilterchange",uW}(),um=(function(){function uW(){}ue(uW,"laya.events.Keyboard"),uW.NUMBER_0=48,uW.NUMBER_1=49,uW.NUMBER_2=50,uW.NUMBER_3=51,uW.NUMBER_4=52,uW.NUMBER_5=53,uW.NUMBER_6=54,uW.NUMBER_7=55,uW.NUMBER_8=56,uW.NUMBER_9=57,uW.A=65,uW.B=66,uW.C=67,uW.D=68,uW.E=69,uW.F=70,uW.G=71,uW.H=72,uW.I=73,uW.J=74,uW.K=75,uW.L=76,uW.M=77,uW.N=78,uW.O=79,uW.P=80,uW.Q=81,uW.R=82,uW.S=83,uW.T=84,uW.U=85,uW.V=86,uW.W=87,uW.X=88,uW.Y=89,uW.Z=90,uW.F1=112,uW.F2=113,uW.F3=114,uW.F4=115,uW.F5=116,uW.F6=117,uW.F7=118,uW.F8=119,uW.F9=120,uW.F10=121,uW.F11=122,uW.F12=123,uW.F13=124,uW.F14=125,uW.F15=126,uW.NUMPAD=21,uW.NUMPAD_0=96,uW.NUMPAD_1=97,uW.NUMPAD_2=98,uW.NUMPAD_3=99,uW.NUMPAD_4=100,uW.NUMPAD_5=101,uW.NUMPAD_6=102,uW.NUMPAD_7=103,uW.NUMPAD_8=104,uW.NUMPAD_9=105,uW.NUMPAD_ADD=107,uW.NUMPAD_DECIMAL=110,uW.NUMPAD_DIVIDE=111,uW.NUMPAD_ENTER=108,uW.NUMPAD_MULTIPLY=106,uW.NUMPAD_SUBTRACT=109,uW.SEMICOLON=186,uW.EQUAL=187,uW.COMMA=188,uW.MINUS=189,uW.PERIOD=190,uW.SLASH=191,uW.BACKQUOTE=192,uW.LEFTBRACKET=219,uW.BACKSLASH=220,uW.RIGHTBRACKET=221,uW.QUOTE=222,uW.ALTERNATE=18,uW.BACKSPACE=8,uW.CAPS_LOCK=20,uW.COMMAND=15,uW.CONTROL=17,uW.DELETE=46,uW.ENTER=13,uW.ESCAPE=27,uW.PAGE_UP=33,uW.PAGE_DOWN=34,uW.END=35,uW.HOME=36,uW.LEFT=37,uW.UP=38,uW.RIGHT=39,uW.DOWN=40,uW.SHIFT=16,uW.SPACE=32,uW.TAB=9,uW.INSERT=45}(),function(){function ub(){}return ue(ub,"laya.events.KeyBoardManager"),ub.__init__=function(){ub._addEvent("keydown"),ub._addEvent("keypress"),ub._addEvent("keyup")},ub._addEvent=function(uj){uY.document.addEventListener(uj,function(uW){laya.events.KeyBoardManager._dispatch(uW,uj)},!0)},ub._dispatch=function(uW,uj){if(ub.enabled){ub._event._stoped=!1,ub._event.nativeEvent=uW,ub._event.keyCode=uW.keyCode||uW.which||uW.charCode,"keydown"===uj?ub._pressKeys[ub._event.keyCode]=!0:"keyup"===uj&&(ub._pressKeys[ub._event.keyCode]=null);for(var ut=uN.stage.focus&&null!=uN.stage.focus.event&&uN.stage.focus.displayedInStage?uN.stage.focus:uN.stage,ud=ut;ud;)ud.event(uj,ub._event.setTo(uj,ud,ut)),ud=ud.parent}},ub.hasKeyDown=function(uW){return ub._pressKeys[uW]},ub._pressKeys={},ub.enabled=!0,uA(ub,["_event",function(){return this._event=new uE}]),ub}()),u$=(function(){function uW(){}ue(uW,"laya.events.KeyLocation"),uW.STANDARD=0,uW.LEFT=1,uW.RIGHT=2,uW.NUM_PAD=3}(),function(){function uR(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=uY.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new uE,this._matrix=new ul,this._point=new uz,this._rect=new uC,this._prePoint=new uz,this._curTouchID=NaN}ue(uR,"laya.events.MouseManager");var uW=uR.prototype;return uW.__init__=function(uW,uj){var ut=this;this._stage=uW;var ud=this,ub=this._eventList;uj.oncontextmenu=function(uW){if(uR.enabled)return!1},uj.addEventListener("mousedown",function(uW){uR.enabled&&(uY.onIE||uW.preventDefault(),ub.push(uW),ud.mouseDownTime=uY.now())}),uj.addEventListener("mouseup",function(uW){uR.enabled&&(uW.preventDefault(),ub.push(uW),ud.mouseDownTime=-uY.now())},!0),uj.addEventListener("mousemove",function(uW){if(uR.enabled){uW.preventDefault();var uj=uY.now();if(uj-ud._lastMoveTimer<10)return;ud._lastMoveTimer=uj,ub.push(uW)}},!0),uj.addEventListener("mouseout",function(uW){uR.enabled&&ub.push(uW)}),uj.addEventListener("mouseover",function(uW){uR.enabled&&ub.push(uW)}),uj.addEventListener("touchstart",function(uW){uR.enabled&&(ub.push(uW),uR._isFirstTouch||uXW.isInputting||uW.preventDefault(),ud.mouseDownTime=uY.now())}),uj.addEventListener("touchend",function(uW){uR.enabled?(uR._isFirstTouch||uXW.isInputting||uW.preventDefault(),uR._isFirstTouch=!1,ub.push(uW),ud.mouseDownTime=-uY.now()):ut._curTouchID=NaN},!0),uj.addEventListener("touchmove",function(uW){uR.enabled&&(uW.preventDefault(),ub.push(uW))},!0),uj.addEventListener("touchcancel",function(uW){uR.enabled?(uW.preventDefault(),ub.push(uW)):ut._curTouchID=NaN},!0),uj.addEventListener("mousewheel",function(uW){uR.enabled&&ub.push(uW)}),uj.addEventListener("DOMMouseScroll",function(uW){uR.enabled&&ub.push(uW)})},uW.initEvent=function(uW,uj){var ut;this._event._stoped=!1,this._event.nativeEvent=uj||uW,this._target=null,this._point.setTo(uW.pageX||uW.clientX,uW.pageY||uW.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=uW.identifier||0,this._tTouchID=this._event.touchId,(ut=uK.I._event)._stoped=!1,ut.nativeEvent=this._event.nativeEvent,ut.touchId=this._event.touchId},uW.checkMouseWheel=function(uW){this._event.delta=uW.wheelDelta?.025*uW.wheelDelta:-uW.detail;for(var uj=uK.I.getLastOvers(),ut=0,ud=uj.length;ut<ud;ut++){var ub=uj[ut];ub.event("mousewheel",this._event.setTo("mousewheel",ub,this._target))}},uW.onMouseMove=function(uW){uK.I.onMouseMove(uW,this._tTouchID)},uW.onMouseDown=function(uW){if(uXW.isInputting&&uN.stage.focus&&uN.stage.focus.focus&&!uN.stage.focus.contains(this._target)){var uj=uN.stage.focus._tf||uN.stage.focus,ut=uW._tf||uW;ut instanceof laya.display.Input&&ut.multiline==uj.multiline?uj._focusOut():uj.focus=!1}uK.I.onMouseDown(uW,this._tTouchID,this._isLeftMouse)},uW.onMouseUp=function(uW){uK.I.onMouseUp(uW,this._tTouchID,this._isLeftMouse)},uW.check=function(uW,uj,ut,ud){this._point.setTo(uj,ut),uW.fromParentPoint(this._point),uj=this._point.x,ut=this._point.y;var ub=uW.scrollRect;if(ub&&(this._rect.setTo(ub.x,ub.y,ub.width,ub.height),!this._rect.contains(uj,ut)))return!1;if(!this.disableMouseEvent){if(uW.hitTestPrior&&!uW.mouseThrough&&!this.hitTest(uW,uj,ut))return!1;for(var uE=uW._childs.length-1;-1<uE;uE--){var uO=uW._childs[uE];if(!uO.destroyed&&uO.mouseEnabled&&uO.visible&&this.check(uO,uj,ut,ud))return!0}}var uq=!(!uW.hitTestPrior||uW.mouseThrough||this.disableMouseEvent)||this.hitTest(uW,uj,ut);return uq?(this._target=uW,ud.call(this,uW)):ud===this.onMouseUp&&uW===this._stage&&(this._target=this._stage,ud.call(this,this._target)),uq},uW.hitTest=function(uW,uj,ut){var ud=!1;if(uW.scrollRect&&(uj-=uW.scrollRect.x,ut-=uW.scrollRect.y),uW.hitArea instanceof laya.utils.HitArea)return uW.hitArea.isHit(uj,ut);if(0<uW.width&&0<uW.height||uW.mouseThrough||uW.hitArea)if(uW.mouseThrough)ud=uW.getGraphicBounds().contains(uj,ut);else{var ub=this._rect;uW.hitArea?ub=uW.hitArea:ub.setTo(0,0,uW.width,uW.height),ud=ub.contains(uj,ut)}return ud},uW.runEvent=function(){var uW=this._eventList.length;if(uW){var uj=this;uj.mouseEventTime=uY.now();var ut,ud=0,ub=0,uE=0;try{for(;ud<uW;){var uO=this._eventList[ud];switch("mousemove"!==uO.type&&(this._prePoint.x=this._prePoint.y=-1e6),uO.type){case"mousedown":this._touchIDs[0]=this._id++,uR._isTouchRespond?uR._isTouchRespond=!1:(uj._isLeftMouse=0===uO.button,uj.initEvent(uO),uj.check(uj._stage,uj.mouseX,uj.mouseY,uj.onMouseDown));break;case"mouseup":uj._isLeftMouse=0===uO.button,uj.initEvent(uO),uj.check(uj._stage,uj.mouseX,uj.mouseY,uj.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-uO.clientX)+Math.abs(this._prePoint.y-uO.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=uO.clientX,this._prePoint.y=uO.clientY,uj.initEvent(uO),uj.check(uj._stage,uj.mouseX,uj.mouseY,uj.onMouseMove));break;case"touchstart":uR._isTouchRespond=!0,uj._isLeftMouse=!0;var uq=uO.changedTouches;for(ub=0,uE=uq.length;ub<uE;ub++)ut=uq[ub],(uR.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=ut.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[ut.identifier]=this._id++,uj.initEvent(ut,uO),uj.check(uj._stage,uj.mouseX,uj.mouseY,uj.onMouseDown));break;case"touchend":case"touchcancel":uR._isTouchRespond=!0,uj._isLeftMouse=!0;var uA=uO.changedTouches;for(ub=0,uE=uA.length;ub<uE;ub++)if(ut=uA[ub],uR.multiTouchEnabled||ut.identifier==this._curTouchID){this._curTouchID=NaN,uj.initEvent(ut,uO);uj.check(uj._stage,uj.mouseX,uj.mouseY,uj.onMouseUp)||uj.onMouseUp(null)}break;case"touchmove":var uc=uO.changedTouches;for(ub=0,uE=uc.length;ub<uE;ub++)ut=uc[ub],(uR.multiTouchEnabled||ut.identifier==this._curTouchID)&&(uj.initEvent(ut,uO),uj.check(uj._stage,uj.mouseX,uj.mouseY,uj.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":uj.checkMouseWheel(uO);break;case"mouseout":uK.I.stageMouseOut();break;case"mouseover":uj._stage.event("mouseover",uj._event.setTo("mouseover",uj._stage,uj._stage))}ud++}}catch(uW){throw this._eventList.length=0,uW}this._eventList.length=0}},uR.enabled=!0,uR.multiTouchEnabled=!0,uR._isTouchRespond=!1,uR._isFirstTouch=!0,uA(uR,["instance",function(){return this.instance=new uR}]),uR}()),uK=function(){function u$(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new uE}ue(u$,"laya.events.TouchManager");var uW=u$.prototype;return uW._clearTempArrs=function(){u$._oldArr.length=0,u$._newArr.length=0,u$._tEleArr.length=0},uW.getTouchFromArr=function(uW,uj){var ut,ud,ub=0;for(ut=uj.length,ub=0;ub<ut;ub++)if((ud=uj[ub]).id==uW)return ud;return null},uW.removeTouchFromArr=function(uW,uj){var ut=0;for(ut=uj.length-1;0<=ut;ut--)uj[ut].id==uW&&uj.splice(ut,1)},uW.createTouchO=function(uW,uj){var ut;return(ut=ur.getItem("TouchData")||{}).id=uj,ut.tar=uW,ut},uW.onMouseDown=function(uW,uj,ut){var ud,ub,uE,uO;(void 0===ut&&(ut=!1),this.enable)&&(ud=this.getTouchFromArr(uj,this.preOvers),uE=this.getEles(uW,null,u$._tEleArr),ud?ud.tar=uW:(ub=this.createTouchO(uW,uj),this.preOvers.push(ub)),uY.onMobile&&this.sendEvents(uE,"mouseover",uj),uO=ut?this.preDowns:this.preRightDowns,(ud=this.getTouchFromArr(uj,uO))?ud.tar=uW:(ub=this.createTouchO(uW,uj),uO.push(ub)),this.sendEvents(uE,ut?"mousedown":"rightmousedown",uj),this._clearTempArrs())},uW.sendEvents=function(uW,uj,ut){void 0===ut&&(ut=0);var ud,ub,uE,uO=0;for(ud=uW.length,this._event._stoped=!1,ub=uW[0],uO=0;uO<ud;uO++){if((uE=uW[uO]).destroyed)return;if(uE.event(uj,this._event.setTo(uj,uE,ub)),this._event._stoped)break}},uW.getEles=function(uW,uj,ut){for(ut?ut.length=0:ut=[];uW&&uW!=uj;)ut.push(uW),uW=uW.parent;return ut},uW.checkMouseOutAndOverOfMove=function(uW,uj,ut){if(void 0===ut&&(ut=0),uj!=uW){var ud,ub,uE=0,uO=0;if(uj.contains(uW))ub=this.getEles(uW,uj,u$._tEleArr),this.sendEvents(ub,"mouseover",ut);else if(uW.contains(uj))ub=this.getEles(uj,uW,u$._tEleArr),this.sendEvents(ub,"mouseout",ut);else{var uq,uA;(ub=u$._tEleArr).length=0,uq=this.getEles(uj,null,u$._oldArr),uA=this.getEles(uW,null,u$._newArr),uO=uq.length;var uc=0;for(uE=0;uE<uO;uE++){if(ud=uq[uE],0<=(uc=uA.indexOf(ud))){uA.splice(uc,uA.length-uc);break}ub.push(ud)}0<ub.length&&this.sendEvents(ub,"mouseout",ut),0<uA.length&&this.sendEvents(uA,"mouseover",ut)}}},uW.onMouseMove=function(uW,uj){var ut,ud;this.enable&&((ut=this.getTouchFromArr(uj,this.preOvers))?(this.checkMouseOutAndOverOfMove(uW,ut.tar),ut.tar=uW,ud=this.getEles(uW,null,u$._tEleArr)):(ud=this.getEles(uW,null,u$._tEleArr),this.sendEvents(ud,"mouseover",uj),this.preOvers.push(this.createTouchO(uW,uj))),this.sendEvents(ud,"mousemove",uj),this._clearTempArrs())},uW.getLastOvers=function(){return(u$._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,u$._tEleArr):(u$._tEleArr.push(uN.stage),u$._tEleArr)},uW.stageMouseOut=function(){var uW;uW=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(uW,"mouseout",0)},uW.onMouseUp=function(uW,uj,ut){if(void 0===ut&&(ut=!1),this.enable){var ud,ub,uE,uO,uq,uA,uc=0,uR=0,um=uY.onMobile;if(ub=this.getEles(uW,null,u$._tEleArr),this.sendEvents(ub,ut?"mouseup":"rightmouseup",uj),uA=ut?this.preDowns:this.preRightDowns,ud=this.getTouchFromArr(uj,uA)){var uQ,uT=uY.now();if(uQ=uT-this._lastClickTime<300,this._lastClickTime=uT,uW==ud.tar)uq=ub;else for(uE=this.getEles(ud.tar,null,u$._oldArr),(uq=u$._newArr).length=0,uR=uE.length,uc=0;uc<uR;uc++)uO=uE[uc],0<=ub.indexOf(uO)&&uq.push(uO);0<uq.length&&this.sendEvents(uq,ut?"click":"rightclick",uj),ut&&uQ&&this.sendEvents(uq,"doubleclick",uj),this.removeTouchFromArr(uj,uA),ud.tar=null,ur.recover("TouchData",ud)}else;(ud=this.getTouchFromArr(uj,this.preOvers))&&um&&((uq=this.getEles(ud.tar,null,uq))&&0<uq.length&&this.sendEvents(uq,"mouseout",uj),this.removeTouchFromArr(uj,this.preOvers),ud.tar=null,ur.recover("TouchData",ud)),this._clearTempArrs()}},u$._oldArr=[],u$._newArr=[],u$._tEleArr=[],uA(u$,["I",function(){return this.I=new u$}]),u$}(),uo=function(){function uW(){this._action=null}ue(uW,"laya.filters.Filter");var uj=uW.prototype;return uN.imps(uj,{"laya.filters.IFilter":!0}),uj.callNative=function(uW){},uR(0,uj,"type",function(){return-1}),uR(0,uj,"action",function(){return this._action}),uW.BLUR=16,uW.COLOR=32,uW.GLOW=8,uW._filterStart=null,uW._filterEnd=null,uW._EndTarget=null,uW._recycleScope=null,uW._filter=null,uW._useSrc=null,uW._endSrc=null,uW._useOut=null,uW._endOut=null,uW}(),uM=function(){function uW(){this.data=null}ue(uW,"laya.filters.ColorFilterAction");var uj=uW.prototype;return uN.imps(uj,{"laya.filters.IFilterAction":!0}),uj.apply=function(uW){var uj=uW.ctx.ctx,ut=uW.ctx.ctx.canvas;if(0==ut.width||0==ut.height)return ut;for(var ud,ub=uj.getImageData(0,0,ut.width,ut.height),uE=ub.data,uO=0,uq=uE.length;uO<uq;uO+=4)ud=this.getColor(uE[uO],uE[uO+1],uE[uO+2],uE[uO+3]),0!=uE[uO+3]&&(uE[uO]=ud[0],uE[uO+1]=ud[1],uE[uO+2]=ud[2],uE[uO+3]=ud[3]);return uj.putImageData(ub,0,0),uW},uj.getColor=function(uW,uj,ut,ud){var ub=[];if(this.data._mat&&this.data._alpha){var uE=this.data._mat,uO=this.data._alpha;ub[0]=uE[0]*uW+uE[1]*uj+uE[2]*ut+uE[3]*ud+uO[0],ub[1]=uE[4]*uW+uE[5]*uj+uE[6]*ut+uE[7]*ud+uO[1],ub[2]=uE[8]*uW+uE[9]*uj+uE[10]*ut+uE[11]*ud+uO[2],ub[3]=uE[12]*uW+uE[13]*uj+uE[14]*ut+uE[15]*ud+uO[3]}return ub},uW}(),uZ=(function(){function uW(){}ue(uW,"laya.maths.Arith"),uW.formatR=function(uW){return uW>Math.PI&&(uW-=2*Math.PI),uW<-Math.PI&&(uW+=2*Math.PI),uW},uW.isPOT=function(uW,uj){return 0<uW&&0==(uW&uW-1)&&0<uj&&0==(uj&uj-1)},uW.setMatToArray=function(uW,uj){uW.a,uW.b,uW.c,uW.d,uW.tx,uW.ty,uj[0]=uW.a,uj[1]=uW.b,uj[4]=uW.c,uj[5]=uW.d,uj[12]=uW.tx,uj[13]=uW.ty}}(),function(){function uW(){this._controlPoints=[new uz,new uz,new uz],this._calFun=this.getPoint2}ue(uW,"laya.maths.Bezier");var uj=uW.prototype;return uj._switchPoint=function(uW,uj){var ut=this._controlPoints.shift();ut.setTo(uW,uj),this._controlPoints.push(ut)},uj.getPoint2=function(uW,uj){var ut=this._controlPoints[0],ud=this._controlPoints[1],ub=this._controlPoints[2],uE=Math.pow(1-uW,2)*ut.x+2*uW*(1-uW)*ud.x+Math.pow(uW,2)*ub.x,uO=Math.pow(1-uW,2)*ut.y+2*uW*(1-uW)*ud.y+Math.pow(uW,2)*ub.y;uj.push(uE,uO)},uj.getPoint3=function(uW,uj){var ut=this._controlPoints[0],ud=this._controlPoints[1],ub=this._controlPoints[2],uE=this._controlPoints[3],uO=Math.pow(1-uW,3)*ut.x+3*ud.x*uW*(1-uW)*(1-uW)+3*ub.x*uW*uW*(1-uW)+uE.x*Math.pow(uW,3),uq=Math.pow(1-uW,3)*ut.y+3*ud.y*uW*(1-uW)*(1-uW)+3*ub.y*uW*uW*(1-uW)+uE.y*Math.pow(uW,3);uj.push(uO,uq)},uj.insertPoints=function(uW,uj){var ut,ud=NaN;for(ut=1/(uW=0<uW?uW:5),ud=0;ud<=1;ud+=ut)this._calFun(ud,uj)},uj.getBezierPoints=function(uW,uj,ut){void 0===uj&&(uj=5),void 0===ut&&(ut=2);var ud,ub,uE=0;if((ud=uW.length)<2*(ut+1))return[];switch(ub=[],ut){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=ut;)this._controlPoints.push(new uz);for(uE=0;uE<2*ut;uE+=2)this._switchPoint(uW[uE],uW[uE+1]);for(uE=2*ut;uE<ud;uE+=2)this._switchPoint(uW[uE],uW[uE+1]),uE/2%ut==0&&this.insertPoints(uj,ub);return ub},uA(uW,["I",function(){return this.I=new uW}]),uW}()),uX=function(){function uc(){}return ue(uc,"laya.maths.GrahamScan"),uc.multiply=function(uW,uj,ut){return(uW.x-ut.x)*(uj.y-ut.y)-(uj.x-ut.x)*(uW.y-ut.y)},uc.dis=function(uW,uj){return(uW.x-uj.x)*(uW.x-uj.x)+(uW.y-uj.y)*(uW.y-uj.y)},uc._getPoints=function(uW,uj,ut){for(void 0===uj&&(uj=!1),uc._mPointList||(uc._mPointList=[]);uc._mPointList.length<uW;)uc._mPointList.push(new uz);return ut||(ut=[]),ut.length=0,uj?uc.getFrom(ut,uc._mPointList,uW):uc.getFromR(ut,uc._mPointList,uW),ut},uc.getFrom=function(uW,uj,ut){var ud=0;for(ud=0;ud<ut;ud++)uW.push(uj[ud]);return uW},uc.getFromR=function(uW,uj,ut){var ud=0;for(ud=0;ud<ut;ud++)uW.push(uj.pop());return uW},uc.pListToPointList=function(uW,uj){void 0===uj&&(uj=!1);var ut=0,ud=uW.length/2,ub=uc._getPoints(ud,uj,uc._tempPointList);for(ut=0;ut<ud;ut++)ub[ut].setTo(uW[ut+ut],uW[ut+ut+1]);return ub},uc.pointListToPlist=function(uW){var uj,ut=0,ud=uW.length,ub=uc._temPList;for(ut=ub.length=0;ut<ud;ut++)uj=uW[ut],ub.push(uj.x,uj.y);return ub},uc.scanPList=function(uW){return un.copyArray(uW,uc.pointListToPlist(uc.scan(uc.pListToPointList(uW,!0))))},uc.scan=function(uW){var uj,ut,ud,ub=0,uE=0,uO=0,uq=uW.length,uA={};for((ut=uc._temArr).length=0,ub=(uq=uW.length)-1;0<=ub;ub--)ud=(uj=uW[ub]).x+"_"+uj.y,uA.hasOwnProperty(ud)||(uA[ud]=!0,ut.push(uj));for(uq=ut.length,un.copyArray(uW,ut),ub=1;ub<uq;ub++)(uW[ub].y<uW[uO].y||uW[ub].y==uW[uO].y&&uW[ub].x<uW[uO].x)&&(uO=ub);for(uj=uW[0],uW[0]=uW[uO],uW[uO]=uj,ub=1;ub<uq-1;ub++){for(uE=(uO=ub)+1;uE<uq;uE++)(0<uc.multiply(uW[uE],uW[uO],uW[0])||0==uc.multiply(uW[uE],uW[uO],uW[0])&&uc.dis(uW[0],uW[uE])<uc.dis(uW[0],uW[uO]))&&(uO=uE);uj=uW[ub],uW[ub]=uW[uO],uW[uO]=uj}if((ut=uc._temArr).length=0,uW.length<3)return un.copyArray(ut,uW);for(ut.push(uW[0],uW[1],uW[2]),ub=3;ub<uq;ub++){for(;2<=ut.length&&0<=uc.multiply(uW[ub],ut[ut.length-1],ut[ut.length-2]);)ut.pop();uW[ub]&&ut.push(uW[ub])}return ut},uc._mPointList=null,uc._tempPointList=[],uc._temPList=[],uc._temArr=[],uc}(),u_=function(){function ub(){}return ue(ub,"laya.maths.MathUtil"),ub.subtractVector3=function(uW,uj,ut){ut[0]=uW[0]-uj[0],ut[1]=uW[1]-uj[1],ut[2]=uW[2]-uj[2]},ub.lerp=function(uW,uj,ut){return uW*(1-ut)+uj*ut},ub.scaleVector3=function(uW,uj,ut){ut[0]=uW[0]*uj,ut[1]=uW[1]*uj,ut[2]=uW[2]*uj},ub.lerpVector3=function(uW,uj,ut,ud){var ub=uW[0],uE=uW[1],uO=uW[2];ud[0]=ub+ut*(uj[0]-ub),ud[1]=uE+ut*(uj[1]-uE),ud[2]=uO+ut*(uj[2]-uO)},ub.lerpVector4=function(uW,uj,ut,ud){var ub=uW[0],uE=uW[1],uO=uW[2],uq=uW[3];ud[0]=ub+ut*(uj[0]-ub),ud[1]=uE+ut*(uj[1]-uE),ud[2]=uO+ut*(uj[2]-uO),ud[3]=uq+ut*(uj[3]-uq)},ub.slerpQuaternionArray=function(uW,uj,ut,ud,ub,uE,uO){var uq,uA,uc,uR,um,uQ=uW[uj+0],uT=uW[uj+1],u$=uW[uj+2],ue=uW[uj+3],uK=ut[ud+0],uo=ut[ud+1],uS=ut[ud+2],uM=ut[ud+3];return(uA=uQ*uK+uT*uo+u$*uS+ue*uM)<0&&(uA=-uA,uK=-uK,uo=-uo,uS=-uS,uM=-uM),um=1e-6<1-uA?(uq=Math.acos(uA),uc=Math.sin(uq),uR=Math.sin((1-ub)*uq)/uc,Math.sin(ub*uq)/uc):(uR=1-ub,ub),uE[uO+0]=uR*uQ+um*uK,uE[uO+1]=uR*uT+um*uo,uE[uO+2]=uR*u$+um*uS,uE[uO+3]=uR*ue+um*uM,uE},ub.getRotation=function(uW,uj,ut,ud){return Math.atan2(ud-uj,ut-uW)/Math.PI*180},ub.sortBigFirst=function(uW,uj){return uW==uj?0:uW<uj?1:-1},ub.sortSmallFirst=function(uW,uj){return uW==uj?0:uW<uj?-1:1},ub.sortNumBigFirst=function(uW,uj){return parseFloat(uj)-parseFloat(uW)},ub.sortNumSmallFirst=function(uW,uj){return parseFloat(uW)-parseFloat(uj)},ub.sortByKey=function(ut,uW,uj){var ud;return void 0===uW&&(uW=!1),void 0===uj&&(uj=!0),ud=uW?uj?ub.sortNumBigFirst:ub.sortBigFirst:uj?ub.sortNumSmallFirst:ub.sortSmallFirst,function(uW,uj){return ud(uW[ut],uj[ut])}},ub}(),ul=function(){function ut(uW,uj,ut,ud,ub,uE){this.inPool=!1,this.bTransform=!1,void 0===uW&&(uW=1),void 0===uj&&(uj=0),void 0===ut&&(ut=0),void 0===ud&&(ud=1),void 0===ub&&(ub=0),void 0===uE&&(uE=0),this.a=uW,this.b=uj,this.c=ut,this.d=ud,this.tx=ub,this.ty=uE,this._checkTransform()}ue(ut,"laya.maths.Matrix");var uW=ut.prototype;return uW.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},uW._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},uW.setTranslate=function(uW,uj){return this.tx=uW,this.ty=uj,this},uW.translate=function(uW,uj){return this.tx+=uW,this.ty+=uj,this},uW.scale=function(uW,uj){this.a*=uW,this.d*=uj,this.c*=uW,this.b*=uj,this.tx*=uW,this.ty*=uj,this.bTransform=!0},uW.rotate=function(uW){var uj=Math.cos(uW),ut=Math.sin(uW),ud=this.a,ub=this.c,uE=this.tx;this.a=ud*uj-this.b*ut,this.b=ud*ut+this.b*uj,this.c=ub*uj-this.d*ut,this.d=ub*ut+this.d*uj,this.tx=uE*uj-this.ty*ut,this.ty=uE*ut+this.ty*uj,this.bTransform=!0},uW.skew=function(uW,uj){var ut=Math.tan(uW),ud=Math.tan(uj),ub=this.a,uE=this.b;return this.a+=ud*this.c,this.b+=ud*this.d,this.c+=ut*ub,this.d+=ut*uE,this},uW.invertTransformPoint=function(uW){var uj=this.a,ut=this.b,ud=this.c,ub=this.d,uE=this.tx,uO=uj*ub-ut*ud,uq=ub/uO,uA=-ut/uO,uc=-ud/uO,uR=uj/uO,um=(ud*this.ty-ub*uE)/uO,uQ=-(uj*this.ty-ut*uE)/uO;return uW.setTo(uq*uW.x+uc*uW.y+um,uA*uW.x+uR*uW.y+uQ)},uW.transformPoint=function(uW){return uW.setTo(this.a*uW.x+this.c*uW.y+this.tx,this.b*uW.x+this.d*uW.y+this.ty)},uW.transformPointN=function(uW){return uW.setTo(this.a*uW.x+this.c*uW.y,this.b*uW.x+this.d*uW.y)},uW.transformPointArray=function(uW,uj){for(var ut=uW.length,ud=0;ud<ut;ud+=2){var ub=uW[ud],uE=uW[ud+1];uj[ud]=this.a*ub+this.c*uE+this.tx,uj[ud+1]=this.b*ub+this.d*uE+this.ty}return uj},uW.transformPointArrayScale=function(uW,uj){for(var ut=uW.length,ud=0;ud<ut;ud+=2){var ub=uW[ud],uE=uW[ud+1];uj[ud]=this.a*ub+this.c*uE,uj[ud+1]=this.b*ub+this.d*uE}return uj},uW.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},uW.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},uW.invert=function(){var uW=this.a,uj=this.b,ut=this.c,ud=this.d,ub=this.tx,uE=uW*ud-uj*ut;return this.a=ud/uE,this.b=-uj/uE,this.c=-ut/uE,this.d=uW/uE,this.tx=(ut*this.ty-ud*ub)/uE,this.ty=-(uW*this.ty-uj*ub)/uE,this},uW.setTo=function(uW,uj,ut,ud,ub,uE){return this.a=uW,this.b=uj,this.c=ut,this.d=ud,this.tx=ub,this.ty=uE,this},uW.concat=function(uW){var uj=this.a,ut=this.c,ud=this.tx;return this.a=uj*uW.a+this.b*uW.c,this.b=uj*uW.b+this.b*uW.d,this.c=ut*uW.a+this.d*uW.c,this.d=ut*uW.b+this.d*uW.d,this.tx=ud*uW.a+this.ty*uW.c+uW.tx,this.ty=ud*uW.b+this.ty*uW.d+uW.ty,this},uW.scaleEx=function(uW,uj){var ut=this.a,ud=this.b,ub=this.c,uE=this.d;0!==ud||0!==ub?(this.a=uW*ut,this.b=uW*ud,this.c=uj*ub):(this.a=uW*ut,this.b=0*uE,this.c=0*ut),this.d=uj*uE,this.bTransform=!0},uW.rotateEx=function(uW){var uj=Math.cos(uW),ut=Math.sin(uW),ud=this.a,ub=this.b,uE=this.c,uO=this.d;0!==ub||0!==uE?(this.a=uj*ud+ut*uE,this.b=uj*ub+ut*uO,this.c=-ut*ud+uj*uE,this.d=-ut*ub+uj*uO):(this.a=uj*ud,this.b=ut*uO,this.c=-ut*ud,this.d=uj*uO),this.bTransform=!0},uW.clone=function(){var uW=ut.create();return uW.a=this.a,uW.b=this.b,uW.c=this.c,uW.d=this.d,uW.tx=this.tx,uW.ty=this.ty,uW.bTransform=this.bTransform,uW},uW.copyTo=function(uW){return uW.a=this.a,uW.b=this.b,uW.c=this.c,uW.d=this.d,uW.tx=this.tx,uW.ty=this.ty,uW.bTransform=this.bTransform,uW},uW.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},uW.destroy=function(){if(!this.inPool){var uW=ut._cache;this.inPool=!0,uW._length||(uW._length=0),(uW[uW._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},ut.mul=function(uW,uj,ut){var ud=uW.a,ub=uW.b,uE=uW.c,uO=uW.d,uq=uW.tx,uA=uW.ty,uc=uj.a,uR=uj.b,um=uj.c,uQ=uj.d,uT=uj.tx,u$=uj.ty;return 0!==uR||0!==um?(ut.a=ud*uc+ub*um,ut.b=ud*uR+ub*uQ,ut.c=uE*uc+uO*um,ut.d=uE*uR+uO*uQ,ut.tx=uc*uq+um*uA+uT,ut.ty=uR*uq+uQ*uA+u$):(ut.a=ud*uc,ut.b=ub*uQ,ut.c=uE*uc,ut.d=uO*uQ,ut.tx=uc*uq+uT,ut.ty=uQ*uA+u$),ut},ut.mul16=function(uW,uj,ut){var ud=uW.a,ub=uW.b,uE=uW.c,uO=uW.d,uq=uW.tx,uA=uW.ty,uc=uj.a,uR=uj.b,um=uj.c,uQ=uj.d,uT=uj.tx,u$=uj.ty;return 0!==uR||0!==um?(ut[0]=ud*uc+ub*um,ut[1]=ud*uR+ub*uQ,ut[4]=uE*uc+uO*um,ut[5]=uE*uR+uO*uQ,ut[12]=uc*uq+um*uA+uT,ut[13]=uR*uq+uQ*uA+u$):(ut[0]=ud*uc,ut[1]=ub*uQ,ut[4]=uE*uc,ut[5]=uO*uQ,ut[12]=uc*uq+uT,ut[13]=uQ*uA+u$),ut},ut.mulPre=function(uW,uj,ut,ud,ub,uE,uO,uq){var uA=uW.a,uc=uW.b,uR=uW.c,um=uW.d,uQ=uW.tx,uT=uW.ty;return 0!==ut||0!==ud?(uq.a=uA*uj+uc*ud,uq.b=uA*ut+uc*ub,uq.c=uR*uj+um*ud,uq.d=uR*ut+um*ub,uq.tx=uj*uQ+ud*uT+uE,uq.ty=ut*uQ+ub*uT+uO):(uq.a=uA*uj,uq.b=uc*ub,uq.c=uR*uj,uq.d=um*ub,uq.tx=uj*uQ+uE,uq.ty=ub*uT+uO),uq},ut.mulPos=function(uW,uj,ut,ud,ub,uE,uO,uq){var uA=uW.a,uc=uW.b,uR=uW.c,um=uW.d,uQ=uW.tx,uT=uW.ty;return 0!==uc||0!==uR?(uq.a=uj*uA+ut*uR,uq.b=uj*uc+ut*um,uq.c=ud*uA+ub*uR,uq.d=ud*uc+ub*um,uq.tx=uA*uE+uR*uO+uQ,uq.ty=uc*uE+um*uO+uT):(uq.a=uj*uA,uq.b=ut*um,uq.c=ud*uA,uq.d=ub*um,uq.tx=uA*uE+uQ,uq.ty=um*uO+uT),uq},ut.preMul=function(uW,uj,ut){var ud=uW.a,ub=uW.b,uE=uW.c,uO=uW.d,uq=uj.a,uA=uj.b,uc=uj.c,uR=uj.d,um=uj.tx,uQ=uj.ty;return ut.a=uq*ud,ut.b=ut.c=0,ut.d=uR*uO,ut.tx=um*ud+uW.tx,ut.ty=uQ*uO+uW.ty,0===uA&&0===uc&&0===ub&&0===uE||(ut.a+=uA*uE,ut.d+=uc*ub,ut.b+=uq*ub+uA*uO,ut.c+=uc*ud+uR*uE,ut.tx+=uQ*uE,ut.ty+=um*ub),ut},ut.preMulXY=function(uW,uj,ut,ud){var ub=uW.a,uE=uW.b,uO=uW.c,uq=uW.d;return ud.a=ub,ud.b=uE,ud.c=uO,ud.d=uq,ud.tx=uj*ub+uW.tx+ut*uO,ud.ty=ut*uq+uW.ty+uj*uE,ud},ut.create=function(){var uW=ut._cache,uj=uW._length?uW[--uW._length]:new ut;return uj.inPool=!1,uj},ut.EMPTY=new ut,ut.TEMP=new ut,ut._cache=[],ut}(),uz=function(){function uW(uW,uj){void 0===uW&&(uW=0),void 0===uj&&(uj=0),this.x=uW,this.y=uj}ue(uW,"laya.maths.Point");var uj=uW.prototype;return uj.setTo=function(uW,uj){return this.x=uW,this.y=uj,this},uj.distance=function(uW,uj){return Math.sqrt((this.x-uW)*(this.x-uW)+(this.y-uj)*(this.y-uj))},uj.toString=function(){return this.x+","+this.y},uj.normalize=function(){var uW=Math.sqrt(this.x*this.x+this.y*this.y);if(0<uW){var uj=1/uW;this.x*=uj,this.y*=uj}},uW.TEMP=new uW,uW.EMPTY=new uW,uW}(),uC=function(){function uc(uW,uj,ut,ud){void 0===uW&&(uW=0),void 0===uj&&(uj=0),void 0===ut&&(ut=0),void 0===ud&&(ud=0),this.x=uW,this.y=uj,this.width=ut,this.height=ud}ue(uc,"laya.maths.Rectangle");var uW=uc.prototype;return uW.setTo=function(uW,uj,ut,ud){return this.x=uW,this.y=uj,this.width=ut,this.height=ud,this},uW.copyFrom=function(uW){return this.x=uW.x,this.y=uW.y,this.width=uW.width,this.height=uW.height,this},uW.contains=function(uW,uj){return!(this.width<=0||this.height<=0)&&(uW>=this.x&&uW<this.right&&uj>=this.y&&uj<this.bottom)},uW.intersects=function(uW){return!(uW.x>this.x+this.width||uW.x+uW.width<this.x||uW.y>this.y+this.height||uW.y+uW.height<this.y)},uW.intersection=function(uW,uj){return this.intersects(uW)?(uj||(uj=new uc),uj.x=Math.max(this.x,uW.x),uj.y=Math.max(this.y,uW.y),uj.width=Math.min(this.right,uW.right)-uj.x,uj.height=Math.min(this.bottom,uW.bottom)-uj.y,uj):null},uW.union=function(uW,uj){return uj||(uj=new uc),this.clone(uj),uW.width<=0||uW.height<=0?uj:(uj.addPoint(uW.x,uW.y),uj.addPoint(uW.right,uW.bottom),this)},uW.clone=function(uW){return uW||(uW=new uc),uW.x=this.x,uW.y=this.y,uW.width=this.width,uW.height=this.height,uW},uW.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},uW.equals=function(uW){return!(!uW||uW.x!==this.x||uW.y!==this.y||uW.width!==this.width||uW.height!==this.height)},uW.addPoint=function(uW,uj){return this.x>uW&&(this.width+=this.x-uW,this.x=uW),this.y>uj&&(this.height+=this.y-uj,this.y=uj),this.width<uW-this.x&&(this.width=uW-this.x),this.height<uj-this.y&&(this.height=uj-this.y),this},uW._getBoundPoints=function(){var uW=uc._temB;return(uW.length=0)==this.width||0==this.height||uW.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),uW},uW.isEmpty=function(){return this.width<=0||this.height<=0},uR(0,uW,"right",function(){return this.x+this.width}),uR(0,uW,"bottom",function(){return this.y+this.height}),uc._getBoundPointS=function(uW,uj,ut,ud){var ub=uc._temA;return(ub.length=0)==ut||0==ud||ub.push(uW,uj,uW+ut,uj,uW,uj+ud,uW+ut,uj+ud),ub},uc._getWrapRec=function(uW,uj){if(!uW||uW.length<1)return uj?uj.setTo(0,0,0,0):uc.TEMP.setTo(0,0,0,0);uj=uj||new uc;var ut,ud,ub,uE,uO,uq=uW.length,uA=uz.TEMP;for(ub=uO=-(ud=uE=99999),ut=0;ut<uq;ut+=2)uA.x=uW[ut],uA.y=uW[ut+1],ud=ud<uA.x?ud:uA.x,uE=uE<uA.y?uE:uA.y,ub=ub>uA.x?ub:uA.x,uO=uO>uA.y?uO:uA.y;return uj.setTo(ud,uE,ub-ud,uO-uE)},uc.EMPTY=new uc,uc.TEMP=new uc,uc._temB=[],uc._temA=[],uc}(),ux=function(){function uA(){}return ue(uA,"laya.media.SoundManager"),uR(1,uA,"useAudioMusic",function(){return uA._useAudioMusic},function(uW){uA._useAudioMusic=uW,uA._musicClass=uW?utW:null}),uR(1,uA,"autoStopMusic",function(){return uA._autoStopMusic},function(uW){uN.stage.off("blur",null,uA._stageOnBlur),uN.stage.off("focus",null,uA._stageOnFocus),uN.stage.off("visibilitychange",null,uA._visibilityChange),(uA._autoStopMusic=uW)&&(uN.stage.on("blur",null,uA._stageOnBlur),uN.stage.on("focus",null,uA._stageOnFocus),uN.stage.on("visibilitychange",null,uA._visibilityChange))}),uR(1,uA,"muted",function(){return uA._muted},function(uW){uW!=uA._muted&&(uW&&uA.stopAllSound(),uA.musicMuted=uW,uA._muted=uW)}),uR(1,uA,"musicMuted",function(){return uA._musicMuted},function(uW){uW!=uA._musicMuted&&(uW?(uA._tMusic&&uA._musicChannel&&!uA._musicChannel.isStopped?uA._musicChannel.pause():uA._musicChannel=null,uA._musicMuted=uW):(uA._musicMuted=uW,uA._tMusic&&uA._musicChannel&&uA._musicChannel.resume()))}),uR(1,uA,"soundMuted",function(){return uA._soundMuted},function(uW){uA._soundMuted=uW}),uA.addChannel=function(uW){0<=uA._channels.indexOf(uW)||(uA._channels.push(uW),uA.autoReleaseSound&&0!=uA._notUsedCount&&uA._notUsedUrls[uW.url]&&(delete uA._notUsedUrls[uW.url],0==--uA._notUsedCount&&uN.timer.clear(uA,uA.disposeSoundIfNotUsed)))},uA.removeChannel=function(uW){var uj=uA._channels,ut=uj.indexOf(uW);if(-1!=ut&&(uj.splice(ut,1),uA.autoReleaseSound)){var ud=uW.url,ub=uA.defaultIntervals[ud]||2e4;if(0<ub){var uE=!0;for(ut=uj.length-1;0<=ut;ut--)if(uj[ut].url==ud){uE=!1;break}uE&&(uA._notUsedUrls[ud]=Date.now()+ub,0==uA._notUsedCount++&&uN.timer.loop(1e4,uA,uA.disposeSoundIfNotUsed))}}},uA.disposeSoundIfNotUsed=function(){var uW=uA._notUsedUrls;if(0!=uA._notUsedCount){var uj=Date.now();for(var ut in uW)uj>=uW[ut]&&(delete uW[ut],--uA._notUsedCount,uA.destroySound(ut));if(0!=uA._notUsedCount)return}uN.timer.clear(uA,uA.disposeSoundIfNotUsed)},uA._visibilityChange=function(){uN.stage.isVisibility?uA._stageOnFocus():uA._stageOnBlur()},uA._stageOnBlur=function(){uA._isActive=!1,uA._musicChannel&&(uA._musicChannel.isStopped||(uA._blurPaused=!0,uA._musicChannel.pause())),uA.stopAllSound(),uN.stage.once("mousedown",null,uA._stageOnFocus)},uA._recoverWebAudio=function(){uEW.ctx&&"running"!=uEW.ctx.state&&uEW.ctx.resume&&uEW.ctx.resume()},uA._stageOnFocus=function(){if(uA._isActive=!0,uA._recoverWebAudio(),uN.stage.off("mousedown",null,uA._stageOnFocus),uA._blurPaused){var uW=uA._musicChannel;uW&&uA._music&&uW.isStopped&&(uA._blurPaused=!1,uA._music._disposed?uA.playMusic(uW.url,uW.loops,uW.startHandler,uW.completeHandler,uW.startTime):uW.audioBuffer?uW.resume():uA._music.play(uW.startTime,uW.loops,uW.startHandler,uW))}},uA.playSound=function(uW,uj,ut,ud,ub,uE){if(void 0===uj&&(uj=1),void 0===uE&&(uE=0),!uW)return null;if(uA._muted)return null;if(uA._recoverWebAudio(),uW==uA._tMusic){if(uA._musicMuted)return null}else{if(!uA._isActive)return null;if(uA._soundMuted)return null}var uO,uq=uA._pool[uW];return ub||(ub=uA._soundClass),uq||((uq=new ub).load(uW),uA._pool[uW]=uq),(uO=uq.play(uE,uj,ut))?(uW==uA._tMusic&&(uA._music=uq,uA._isActive||(uA._blurPaused=!0,uO.pause())),uO.url=uW,uO.volume=uW==uA._tMusic?uA.musicVolume:uA.soundVolume,uO.completeHandler=ud,uO):null},uA.destroySound=function(uW){var uj=uA._pool[uW];uj&&(delete uA._pool[uW],uj.dispose())},uA.playMusic=function(uW,uj,ut,ud,ub){return void 0===uj&&(uj=0),void 0===ub&&(ub=0),uA._tMusic=uW,uA._musicChannel&&uA._musicChannel.stop(),uA._musicChannel=uA.playSound(uW,uj,ut,ud,null,ub)},uA.stopSound=function(uW){for(var uj,ut=uA._channels.length-1;0<=ut;ut--)(uj=uA._channels[ut]).url==uW&&uj.stop()},uA.stopAll=function(){uA._tMusic=null;var uW=0;for(uW=uA._channels.length-1;0<=uW;uW--)uA._channels[uW].stop()},uA.stopAllSound=function(){var uW,uj=0;for(uj=uA._channels.length-1;0<=uj;uj--)(uW=uA._channels[uj]).url!=uA._tMusic&&uW.stop()},uA.stopMusic=function(){uA._musicChannel&&uA._musicChannel.stop(),uA._tMusic=null},uA.setSoundVolume=function(uW,uj){if(uj)uA._setVolume(uj,uW);else{uA.soundVolume=uW;var ut,ud=0;for(ud=uA._channels.length-1;0<=ud;ud--)(ut=uA._channels[ud]).url!=uA._tMusic&&(ut.volume=uW)}},uA.setMusicVolume=function(uW){uA.musicVolume=uW,uA._setVolume(uA._tMusic,uW)},uA._setVolume=function(uW,uj){for(var ut,ud=uA._channels.length-1;0<=ud;ud--)(ut=uA._channels[ud]).url==uW&&(ut.volume=uj)},uA.musicVolume=1,uA.soundVolume=1,uA.playbackRate=1,uA._useAudioMusic=!0,uA._muted=!1,uA._soundMuted=!1,uA._musicMuted=!1,uA._tMusic=null,uA._musicChannel=null,uA._music=null,uA._channels=[],uA._autoStopMusic=!1,uA._blurPaused=!1,uA._isActive=!0,uA._soundClass=null,uA._musicClass=null,uA.autoReleaseSound=!0,uA._pool={},uA.defaultIntervals={},uA._notUsedUrls={},uA._notUsedCount=0,uA}(),uL=function(){var uW;function ut(){}return ue(ut,"laya.net.LocalStorage"),ut.__init__=function(){ut._baseClass||(ut._baseClass=uW).init(),ut.items=ut._baseClass.items,ut.support=ut._baseClass.support},ut.setItem=function(uW,uj){ut._baseClass.setItem(uW,uj)},ut.getItem=function(uW){return ut._baseClass.getItem(uW)},ut.setJSON=function(uW,uj){ut._baseClass.setJSON(uW,uj)},ut.getJSON=function(uW){return ut._baseClass.getJSON(uW)},ut.removeItem=function(uW){ut._baseClass.removeItem(uW)},ut.clear=function(){ut._baseClass.clear()},ut._baseClass=null,ut.items=null,ut.support=!1,ut.__init$=function(){uW=function(){function ut(){}return ue(ut,""),ut.init=function(){try{ut.support=!0,ut.items=uO.localStorage,ut.setItem("laya","1"),ut.removeItem("laya")}catch(uW){ut.support=!1}ut.support||console.log("LocalStorage is not supprot or browser is private mode.")},ut.setItem=function(uW,uj){try{ut.support&&ut.items.setItem(uW,uj)}catch(uW){console.warn("set localStorage failed",uW)}},ut.getItem=function(uW){return ut.support?ut.items.getItem(uW):null},ut.setJSON=function(uW,uj){try{ut.support&&ut.items.setItem(uW,JSON.stringify(uj))}catch(uW){console.warn("set localStorage failed",uW)}},ut.getJSON=function(uW){return JSON.parse(ut.support?ut.items.getItem(uW):null)},ut.removeItem=function(uW){ut.support&&ut.items.removeItem(uW)},ut.clear=function(){ut.support&&ut.items.clear()},ut.items=null,ut.support=!1,ut}()},ut}(),uh=(function(){function ud(){}ue(ud,"laya.net.ResourceVersion"),ud.enable=function(uW,uj,ut){void 0===ut&&(ut=2),laya.net.ResourceVersion.type=ut,uN.loader.load(uW,uS.create(null,ud.onManifestLoaded,[uj]),null,"json"),uv.customFormat=ud.addVersionPrefix},ud.onManifestLoaded=function(uW,uj){ud.manifest=uj,uW.run(),uj||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},ud.addVersionPrefix=function(uW){return ud.manifest&&ud.manifest[uW]?2==ud.type?ud.manifest[uW]:ud.manifest[uW]+"/"+uW:uW},ud.FOLDER_VERSION=1,ud.FILENAME_VERSION=2,ud.manifest=null,ud.type=1}(),function(){function uW(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}ue(uW,"laya.net.TTFLoader");var uj=uW.prototype;return uj.load=function(uW){var uj=(this._url=uW).split(".ttf")[0].split("/");this.fontName=uj[uj.length-1],uY.window.conch?this._loadConch():uY.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},uj._loadConch=function(){this._http=new uOW,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},uj._onHttpLoaded=function(uW){uY.window.conch.setFontFaceFromBuffer(this.fontName,uW),this._clearHttp(),this._complete()},uj._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},uj._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},uj._complete=function(){uN.timer.clear(this,this._complete),uN.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},uj._checkComplete=function(){uG.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},uj._loadWithFontFace=function(){var uW=new uY.window.FontFace(this.fontName,"url('"+this._url+"')");uY.window.document.fonts.add(uW);var uj=this;uW.loaded.then(function(){uj._complete()}),uW.load()},uj._createDiv=function(){this._div=uY.createElement("div"),this._div.innerHTML="laya";var uW=this._div.style;uW.fontFamily=this.fontName,uW.position="absolute",uW.left="-100px",uW.top="-100px",uY.document.body.appendChild(this._div)},uj._loadWithCSS=function(){var uW=this,uj=uY.createElement("style");uj.type="text/css",uY.document.body.appendChild(uj),uj.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=uG.measureText("LayaTTFFont",this._fontTxt).width;var ut=this;uj.onload=function(){uN.timer.once(1e4,ut,uW._complete)},uN.timer.loop(20,this,this._checkComplete),this._createDiv()},uW._testString="LayaTTFFont",uW}()),uv=function(){function ud(uW){this._url=null,this._path=null,this._url=ud.formatURL(uW),this._path=ud.getPath(uW)}ue(ud,"laya.net.URL");var uW=ud.prototype;return uR(0,uW,"path",function(){return this._path}),uR(0,uW,"url",function(){return this._url}),ud.formatURL=function(uW,uj){if(!uW)return"null path";if(0<uW.indexOf(":"))return uW;null!=ud.customFormat&&(uW=ud.customFormat(uW,uj));var ut=uW.charAt(0);if("."===ut)return ud.formatRelativePath((uj||ud.basePath)+uW);if("~"===ut)return ud.rootPath+uW.substring(1);if("d"===ut){if(0===uW.indexOf("data:image"))return uW}else if("/"===ut)return uW;return(uj||ud.basePath)+uW},ud.formatRelativePath=function(uW){for(var uj=uW.split("/"),ut=0,ud=uj.length;ut<ud;ut++)".."==uj[ut]&&(uj.splice(ut-1,2),ut-=2);return uj.join("/")},ud.isAbsolute=function(uW){return 0<uW.indexOf(":")||"/"==uW.charAt(0)},ud.getPath=function(uW){var uj=uW.lastIndexOf("/");return 0<uj?uW.substr(0,uj+1):""},ud.getFileName=function(uW){var uj=uW.lastIndexOf("/");return 0<uj?uW.substr(uj+1):uW},ud.version={},ud.basePath="",ud.rootPath="",ud.customFormat=function(uW){var uj=ud.version[uW];return!uy.isConchApp&&uj&&(uW+="?v="+uj),uW},ud}(),uy=function(){function ub(uW,uj){this._timeId=0;var ut=ub._mainCanvas.source.style;ut.position="absolute",ut.top=ut.left="0px",ut.background="#000000",ub._mainCanvas.source.id="layaCanvas";var ud=laya.renders.Render.isWebGL;ub._mainCanvas.source.width=uW,ub._mainCanvas.source.height=uj,ud&&ub.WebGL.init(ub._mainCanvas,uW,uj),uY.container.appendChild(ub._mainCanvas.source),(ub._context=new ua(uW,uj,ud?null:ub._mainCanvas)).ctx.setIsMainContext(),uY.window.requestAnimationFrame(function uW(uj){uY.window.requestAnimationFrame(uW);uN.stage._loop()}),uN.stage.on("visibilitychange",this,this._onVisibilitychange)}ue(ub,"laya.renders.Render");var uW=ub.prototype;return uW._onVisibilitychange=function(){uN.stage.isVisibility?0!=this._timeId&&uY.window.clearInterval(this._timeId):this._timeId=uY.window.setInterval(this._enterFrame,1e3)},uW._enterFrame=function(uW){uN.stage._loop()},uR(1,ub,"context",function(){return ub._context}),uR(1,ub,"canvas",function(){return ub._mainCanvas.source}),ub._context=null,ub._mainCanvas=null,ub.WebGL=null,ub.isConchNode=!1,ub.isConchApp=!1,ub.isConchWebGL=!1,ub.isWebGL=!1,ub.is3DMode=!1,ub.optimizeTextureMemory=function(uW,uj){return!0},ub.__init$=function(){uO.ConchRenderType=uO.ConchRenderType||1,uO.ConchRenderType|=uO.conch?4:0,ub.isConchNode=5==(5&uO.ConchRenderType),ub.isConchApp=4==(4&uO.ConchRenderType),ub.isConchWebGL=6==uO.ConchRenderType},ub}(),ua=function(){function uO(uW,uj,ut){this.x=0,this.y=0,this._drawTexture=function(uW,uj,ut){ut[0].loaded&&this.ctx.drawTexture(ut[0],ut[1],ut[2],ut[3],ut[4],uW,uj)},this._fillTexture=function(uW,uj,ut){ut[0].loaded&&this.ctx.fillTexture(ut[0],ut[1]+uW,ut[2]+uj,ut[3],ut[4],ut[5],ut[6],ut[7])},this._drawTextureWithTransform=function(uW,uj,ut){ut[0].loaded&&this.ctx.drawTextureWithTransform(ut[0],ut[1],ut[2],ut[3],ut[4],ut[5],uW,uj,ut[6])},this._fillQuadrangle=function(uW,uj,ut){this.ctx.fillQuadrangle(ut[0],ut[1],ut[2],ut[3],ut[4])},this._drawRect=function(uW,uj,ut){var ud=this.ctx;null!=ut[4]&&(ud.fillStyle=ut[4],ud.fillRect(uW+ut[0],uj+ut[1],ut[2],ut[3],null)),null!=ut[5]&&(ud.strokeStyle=ut[5],ud.lineWidth=ut[6],ud.strokeRect(uW+ut[0],uj+ut[1],ut[2],ut[3],ut[6]))},this._drawPie=function(uW,uj,ut){var ud=this.ctx;uy.isWebGL&&ud.setPathId(ut[8]),ud.beginPath(),uy.isWebGL?(ud.movePath(ut[0]+uW,ut[1]+uj),ud.moveTo(0,0)):ud.moveTo(uW+ut[0],uj+ut[1]),ud.arc(uW+ut[0],uj+ut[1],ut[2],ut[3],ut[4]),ud.closePath(),this._fillAndStroke(ut[5],ut[6],ut[7],!0)},this._clipRect=function(uW,uj,ut){this.ctx.clipRect(uW+ut[0],uj+ut[1],ut[2],ut[3])},this._fillRect=function(uW,uj,ut){this.ctx.fillRect(uW+ut[0],uj+ut[1],ut[2],ut[3],ut[4])},this._drawCircle=function(uW,uj,ut){var ud=this.ctx;uy.isWebGL&&ud.setPathId(ut[6]),uP.drawCall++,ud.beginPath(),uy.isWebGL&&ud.movePath(ut[0]+uW,ut[1]+uj),ud.arc(ut[0]+uW,ut[1]+uj,ut[2],0,uO.PI2),ud.closePath(),this._fillAndStroke(ut[3],ut[4],ut[5],!0)},this._fillCircle=function(uW,uj,ut){uP.drawCall++;var ud=this.ctx;ud.beginPath(),ud.fillStyle=ut[3],ud.arc(ut[0]+uW,ut[1]+uj,ut[2],0,uO.PI2),ud.fill()},this._setShader=function(uW,uj,ut){this.ctx.setShader(ut[0])},this._drawLine=function(uW,uj,ut){var ud=this.ctx;uy.isWebGL&&ud.setPathId(ut[6]),ud.beginPath(),ud.strokeStyle=ut[4],ud.lineWidth=ut[5],uy.isWebGL?(ud.movePath(uW,uj),ud.moveTo(ut[0],ut[1]),ud.lineTo(ut[2],ut[3])):(ud.moveTo(uW+ut[0],uj+ut[1]),ud.lineTo(uW+ut[2],uj+ut[3])),ud.stroke()},this._drawLines=function(uW,uj,ut){var ud=this.ctx;uy.isWebGL&&ud.setPathId(ut[5]),ud.beginPath(),uW+=ut[0],uj+=ut[1],uy.isWebGL&&ud.movePath(uW,uj),ud.strokeStyle=ut[3],ud.lineWidth=ut[4];var ub=ut[2],uE=2,uO=ub.length;if(uy.isWebGL)for(ud.moveTo(ub[0],ub[1]);uE<uO;)ud.lineTo(ub[uE++],ub[uE++]);else for(ud.moveTo(uW+ub[0],uj+ub[1]);uE<uO;)ud.lineTo(uW+ub[uE++],uj+ub[uE++]);ud.stroke()},this._drawLinesWebGL=function(uW,uj,ut){this.ctx.drawLines(uW+this.x+ut[0],uj+this.y+ut[1],ut[2],ut[3],ut[4])},this._drawCurves=function(uW,uj,ut){this.ctx.drawCurves(uW,uj,ut)},this._draw=function(uW,uj,ut){ut[0].call(null,this,uW,uj)},this._transformByMatrix=function(uW,uj,ut){this.ctx.transformByMatrix(ut[0])},this._setTransform=function(uW,uj,ut){this.ctx.setTransform(ut[0],ut[1],ut[2],ut[3],ut[4],ut[5])},this._setTransformByMatrix=function(uW,uj,ut){this.ctx.setTransformByMatrix(ut[0])},this._save=function(uW,uj,ut){this.ctx.save()},this._restore=function(uW,uj,ut){this.ctx.restore()},this._translate=function(uW,uj,ut){this.ctx.translate(ut[0],ut[1])},this._transform=function(uW,uj,ut){this.ctx.translate(ut[1]+uW,ut[2]+uj);var ud=ut[0];this.ctx.transform(ud.a,ud.b,ud.c,ud.d,ud.tx,ud.ty),this.ctx.translate(-uW-ut[1],-uj-ut[2])},this._rotate=function(uW,uj,ut){this.ctx.translate(ut[1]+uW,ut[2]+uj),this.ctx.rotate(ut[0]),this.ctx.translate(-uW-ut[1],-uj-ut[2])},this._scale=function(uW,uj,ut){this.ctx.translate(ut[2]+uW,ut[3]+uj),this.ctx.scale(ut[0],ut[1]),this.ctx.translate(-uW-ut[2],-uj-ut[3])},this._alpha=function(uW,uj,ut){this.ctx.globalAlpha*=ut[0]},this._setAlpha=function(uW,uj,ut){this.ctx.globalAlpha=ut[0]},this._fillText=function(uW,uj,ut){this.ctx.fillText(ut[0],ut[1]+uW,ut[2]+uj,ut[3],ut[4],ut[5])},this._strokeText=function(uW,uj,ut){this.ctx.strokeText(ut[0],ut[1]+uW,ut[2]+uj,ut[3],ut[4],ut[5],ut[6])},this._fillBorderText=function(uW,uj,ut){this.ctx.fillBorderText(ut[0],ut[1]+uW,ut[2]+uj,ut[3],ut[4],ut[5],ut[6],ut[7])},this._blendMode=function(uW,uj,ut){this.ctx.globalCompositeOperation=ut[0]},this._beginClip=function(uW,uj,ut){this.ctx.beginClip&&this.ctx.beginClip(uW+ut[0],uj+ut[1],ut[2],ut[3])},this._setIBVB=function(uW,uj,ut){this.ctx.setIBVB(ut[0]+uW,ut[1]+uj,ut[2],ut[3],ut[4],ut[5],ut[6],ut[7])},this._fillTrangles=function(uW,uj,ut){this.ctx.fillTrangles(ut[0],ut[1]+uW,ut[2]+uj,ut[3],ut[4])},this._drawPath=function(uW,uj,ut){var ud=this.ctx;uy.isWebGL&&ud.setPathId(-1),ud.beginPath(),uW+=ut[0],uj+=ut[1],uy.isWebGL&&ud.movePath(uW,uj);for(var ub=ut[2],uE=0,uO=ub.length;uE<uO;uE++){var uq=ub[uE];switch(uq[0]){case"moveTo":uy.isWebGL?ud.moveTo(uq[1],uq[2]):ud.moveTo(uW+uq[1],uj+uq[2]);break;case"lineTo":uy.isWebGL?ud.lineTo(uq[1],uq[2]):ud.lineTo(uW+uq[1],uj+uq[2]);break;case"arcTo":uy.isWebGL?ud.arcTo(uq[1],uq[2],uq[3],uq[4],uq[5]):ud.arcTo(uW+uq[1],uj+uq[2],uW+uq[3],uj+uq[4],uq[5]);break;case"closePath":ud.closePath()}}var uA=ut[3];null!=uA&&(ud.fillStyle=uA.fillStyle,ud.fill());var uc=ut[4];null!=uc&&(ud.strokeStyle=uc.strokeStyle,ud.lineWidth=uc.lineWidth||1,ud.lineJoin=uc.lineJoin,ud.lineCap=uc.lineCap,ud.miterLimit=uc.miterLimit,ud.stroke())},this.drawPoly=function(uW,uj,ut){this.ctx.drawPoly(uW+this.x+ut[0],uj+this.y+ut[1],ut[2],ut[3],ut[4],ut[5],ut[6])},this._drawPoly=function(uW,uj,ut){var ud=this.ctx,ub=ut[2],uE=2,uO=ub.length;if(uy.isWebGL)for(ud.setPathId(ut[6]),ud.beginPath(),uW+=ut[0],uj+=ut[1],ud.movePath(uW,uj),ud.moveTo(ub[0],ub[1]);uE<uO;)ud.lineTo(ub[uE++],ub[uE++]);else for(ud.beginPath(),uW+=ut[0],uj+=ut[1],ud.moveTo(uW+ub[0],uj+ub[1]);uE<uO;)ud.lineTo(uW+ub[uE++],uj+ub[uE++]);ud.closePath(),this._fillAndStroke(ut[3],ut[4],ut[5],ut[7])},this._drawSkin=function(uW,uj,ut){var ud=ut[0];if(ud){var ub=this.ctx;ud.render(ub,uW,uj)}},this._drawParticle=function(uW,uj,ut){this.ctx.drawParticle(uW+this.x,uj+this.y,ut[0])},this._setFilters=function(uW,uj,ut){this.ctx.setFilters(ut)},ut?this.ctx=ut.getContext("2d"):(ut=uMW.create("3D"),this.ctx=uG.createWebGLContext2D(ut),ut._setContext(this.ctx)),ut.size(uW,uj),this.canvas=ut}ue(uO,"laya.renders.RenderContext");var uW=uO.prototype;return uW.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},uW.drawTexture=function(uW,uj,ut,ud,ub){uW.loaded&&this.ctx.drawTexture(uW,uj,ut,ud,ub,this.x,this.y)},uW._drawTextures=function(uW,uj,ut){ut[0].loaded&&this.ctx.drawTextures(ut[0],ut[1],uW+this.x,uj+this.y)},uW.drawTextureWithTransform=function(uW,uj,ut,ud,ub,uE,uO){uW.loaded&&this.ctx.drawTextureWithTransform(uW,uj,ut,ud,ub,uE,this.x,this.y,uO)},uW.fillQuadrangle=function(uW,uj,ut,ud,ub){this.ctx.fillQuadrangle(uW,uj,ut,ud,ub)},uW.drawCanvas=function(uW,uj,ut,ud,ub){this.ctx.drawCanvas(uW,uj+this.x,ut+this.y,ud,ub)},uW.drawRect=function(uW,uj,ut,ud,ub,uE){void 0===uE&&(uE=1);var uO=this.ctx;uO.strokeStyle=ub,uO.lineWidth=uE,uO.strokeRect(uW+this.x,uj+this.y,ut,ud,uE)},uW._fillAndStroke=function(uW,uj,ut,ud){void 0===ud&&(ud=!1);var ub=this.ctx;null!=uW&&(ub.fillStyle=uW,uy.isWebGL?ub.fill(ud):ub.fill()),null!=uj&&0<ut&&(ub.strokeStyle=uj,ub.lineWidth=ut,ub.stroke())},uW.clipRect=function(uW,uj,ut,ud){this.ctx.clipRect(uW+this.x,uj+this.y,ut,ud)},uW.fillRect=function(uW,uj,ut,ud,ub){this.ctx.fillRect(uW+this.x,uj+this.y,ut,ud,ub)},uW.drawCircle=function(uW,uj,ut,ud,ub){void 0===ub&&(ub=1),uP.drawCall++;var uE=this.ctx;uE.beginPath(),uE.strokeStyle=ud,uE.lineWidth=ub,uE.arc(uW+this.x,uj+this.y,ut,0,uO.PI2),uE.stroke()},uW.drawTriangles=function(uW,uj,ut){if(uy.isWebGL)this.ctx.drawTriangles(ut[0],uW+ut[1],uj+ut[2],ut[3],ut[4],ut[5],ut[6],ut[7],ut[8],ut[9]);else{var ud=ut[5],ub=0,uE=ud.length,uO=this.ctx;for(ub=0;ub<uE;ub+=3){var uq=2*ud[ub],uA=2*ud[ub+1],uc=2*ud[ub+2];uO.drawTriangle(ut[0],ut[3],ut[4],uq,uA,uc,ut[6],!0)}}},uW.fillCircle=function(uW,uj,ut,ud){uP.drawCall++;var ub=this.ctx;ub.beginPath(),ub.fillStyle=ud,ub.arc(uW+this.x,uj+this.y,ut,0,uO.PI2),ub.fill()},uW.setShader=function(uW){this.ctx.setShader(uW)},uW.drawLine=function(uW,uj,ut,ud,ub,uE){void 0===uE&&(uE=1);var uO=this.ctx;uO.beginPath(),uO.strokeStyle=ub,uO.lineWidth=uE,uO.moveTo(this.x+uW,this.y+uj),uO.lineTo(this.x+ut,this.y+ud),uO.stroke()},uW.clear=function(){this.ctx.clear()},uW.transformByMatrix=function(uW){this.ctx.transformByMatrix(uW)},uW.setTransform=function(uW,uj,ut,ud,ub,uE){this.ctx.setTransform(uW,uj,ut,ud,ub,uE)},uW.setTransformByMatrix=function(uW){this.ctx.setTransformByMatrix(uW)},uW.save=function(){this.ctx.save()},uW.restore=function(){this.ctx.restore()},uW.translate=function(uW,uj){this.ctx.translate(uW,uj)},uW.transform=function(uW,uj,ut,ud,ub,uE){this.ctx.transform(uW,uj,ut,ud,ub,uE)},uW.rotate=function(uW){this.ctx.rotate(uW)},uW.scale=function(uW,uj){this.ctx.scale(uW,uj)},uW.alpha=function(uW){this.ctx.globalAlpha*=uW},uW.setAlpha=function(uW){this.ctx.globalAlpha=uW},uW.fillWords=function(uW,uj,ut,ud,ub,uE){void 0===uE&&(uE=0),this.ctx.fillWords(uW,uj,ut,ud,ub,uE)},uW.fillBorderWords=function(uW,uj,ut,ud,ub,uE,uO){this.ctx.fillBorderWords(uW,uj,ut,ud,ub,uE,uO)},uW.fillText=function(uW,uj,ut,ud,ub,uE){this.ctx.fillText(uW,uj+this.x,ut+this.y,ud,ub,uE)},uW.strokeText=function(uW,uj,ut,ud,ub,uE,uO){this.ctx.strokeText(uW,uj+this.x,ut+this.y,ud,ub,uE,uO)},uW.blendMode=function(uW){this.ctx.globalCompositeOperation=uW},uW.flush=function(){this.ctx.flush&&this.ctx.flush()},uW.addRenderObject=function(uW){this.ctx.addRenderObject(uW)},uW.beginClip=function(uW,uj,ut,ud){this.ctx.beginClip&&this.ctx.beginClip(uW,uj,ut,ud)},uW.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},uW.fillTrangles=function(uW,uj,ut){this.ctx.fillTrangles(ut[0],ut[1],ut[2],ut[3],4<ut.length?ut[4]:null)},uO.PI2=2*Math.PI,uO}(),uu=function(){function uO(uW,uj){switch(this._next=uj||uO.NORENDER,uW){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=uo._filter);case 69905:return void(this._fun=uO._initRenderFun)}this.onCreate(uW)}ue(uO,"laya.renders.RenderSprite");var uW=uO.prototype;return uW.onCreate=function(uW){},uW._style=function(uW,uj,ut,ud){uW._style.render(uW,uj,ut,ud);var ub=this._next;ub._fun.call(ub,uW,uj,ut,ud)},uW._no=function(uW,uj,ut,ud){},uW._custom=function(uW,uj,ut,ud){uW.customRender(uj,ut,ud);var ub=uW._style._tf;this._next._fun.call(this._next,uW,uj,ut-ub.translateX,ud-ub.translateY)},uW._clip=function(uW,uj,ut,ud){var ub=this._next;if(ub!=uO.NORENDER){var uE=uW._style.scrollRect;uj.ctx.save(),uj.ctx.clipRect(ut,ud,uE.width,uE.height),ub._fun.call(ub,uW,uj,ut-uE.x,ud-uE.y),uj.ctx.restore()}},uW._blend=function(uW,uj,ut,ud){var ub=uW._style;ub.blendMode&&(uj.ctx.globalCompositeOperation=ub.blendMode);var uE=this._next;uE._fun.call(uE,uW,uj,ut,ud),uj.ctx.globalCompositeOperation="source-over"},uW._mask=function(uW,uj,ut,ud){var ub=this._next;ub._fun.call(ub,uW,uj,ut,ud);var uE=uW.mask;uE&&(uj.ctx.globalCompositeOperation="destination-in",(0<uE.numChildren||!uE.graphics._isOnlyOne())&&(uE.cacheAsBitmap=!0),uE.render(uj,ut-uW.pivotX,ud-uW.pivotY)),uj.ctx.globalCompositeOperation="source-over"},uW._graphics=function(uW,uj,ut,ud){var ub=uW._style._tf;uW._graphics&&uW._graphics._render(uW,uj,ut-ub.translateX,ud-ub.translateY);var uE=this._next;uE._fun.call(uE,uW,uj,ut,ud)},uW._image=function(uW,uj,ut,ud){var ub=uW._style;uj.ctx.drawTexture2(ut,ud,ub._tf.translateX,ub._tf.translateY,uW.transform,ub.alpha,ub.blendMode,uW._graphics._one)},uW._image2=function(uW,uj,ut,ud){var ub=uW._style._tf;uj.ctx.drawTexture2(ut,ud,ub.translateX,ub.translateY,uW.transform,1,null,uW._graphics._one)},uW._alpha=function(uW,uj,ut,ud){var ub;if(.01<(ub=uW._style.alpha)||uW._needRepaint()){var uE=uj.ctx.globalAlpha;uj.ctx.globalAlpha*=ub;var uO=this._next;uO._fun.call(uO,uW,uj,ut,ud),uj.ctx.globalAlpha=uE}},uW._transform=function(uW,uj,ut,ud){var ub=uW.transform,uE=this._next;ub&&uE!=uO.NORENDER?(uj.save(),uj.transform(ub.a,ub.b,ub.c,ub.d,ub.tx+ut,ub.ty+ud),uE._fun.call(uE,uW,uj,0,0),uj.restore()):uE._fun.call(uE,uW,uj,ut,ud)},uW._childs=function(uW,uj,ut,ud){var ub=uW._style,uE=ub._tf;if(ut=ut-uE.translateX+ub.paddingLeft,ud=ud-uE.translateY+ub.paddingTop,ub._calculation){var uO=uW._getWords();if(uO){var uq=ub;uq&&(uq.stroke?uj.fillBorderWords(uO,ut,ud,uq.font,uq.color,uq.strokeColor,uq.stroke):uj.fillWords(uO,ut,ud,uq.font,uq.color,"none"!=uq.textDecoration&&uq.underLine?1:0))}}var uA,uc=uW._childs,uR=uc.length;if(uW.viewport||uW.optimizeScrollRect&&uW._style.scrollRect){var um=uW.viewport||uW._style.scrollRect,uQ=um.x,uT=um.y,u$=um.right,ue=um.bottom,uK=NaN,uo=NaN;for(uS=0;uS<uR;++uS)(uA=uc[uS]).visible&&(uK=uA._x)<u$&&uK+uA.width>uQ&&(uo=uA._y)<ue&&uo+uA.height>uT&&uA.render(uj,ut,ud)}else for(var uS=0;uS<uR;++uS)(uA=uc[uS])._style.visible&&uA.render(uj,ut,ud)},uW._canvas=function(uW,uj,ut,ud){var ub=uW._$P.cacheCanvas;if(ub){"bitmap"===ub.type?uP.canvasBitmap++:uP.canvasNormal++;var uE=ub.ctx;if(uW._needRepaint()||!uE)this._canvas_repaint(uW,uj,ut,ud);else{var uO=ub._cacheRec;uj.drawCanvas(uE.canvas,ut+uO.x,ud+uO.y,uO.width,uO.height)}}else this._next._fun.call(this._next,uW,uj,ut,ud)},uW._canvas_repaint=function(uW,uj,ut,ud){var ub=uW._$P.cacheCanvas,uE=this._next;if(ub){var uO,uq,uA,uc,uR=ub.ctx,um=uW._needRepaint()||!uR,uQ=ub.type;if("bitmap"===uQ?uP.canvasBitmap++:uP.canvasNormal++,um){var uT,u$;ub._cacheRec||(ub._cacheRec=new uC),uy.isWebGL&&"bitmap"!==uQ?ub._cacheRec.setTo(-uW.pivotX,-uW.pivotY,1,1):((uc=uW.getSelfBounds()).x=uc.x-uW.pivotX,uc.y=uc.y-uW.pivotY,uc.x=uc.x-16,uc.y=uc.y-16,uc.width=uc.width+32,uc.height=uc.height+32,uc.x=Math.floor(uc.x+ut)-ut,uc.y=Math.floor(uc.y+ud)-ud,uc.width=Math.floor(uc.width),uc.height=Math.floor(uc.height),ub._cacheRec.copyFrom(uc)),uc=ub._cacheRec;var ue,uK=uy.isWebGL?1:uY.pixelRatio*uN.stage.clientScaleX,uo=uy.isWebGL?1:uY.pixelRatio*uN.stage.clientScaleY;if(!uy.isWebGL){var uS,uM=1,uZ=1;for(uS=uW;uS&&uS!=uN.stage;)uM*=uS.scaleX,uZ*=uS.scaleY,uS=uS.parent;uy.isWebGL?(uM<1&&(uK*=uM),uZ<1&&(uo*=uZ)):(1<uM&&(uK*=uM),1<uZ&&(uo*=uZ))}if(uW.scrollRect){var uX=uW.scrollRect;uc.x-=uX.x,uc.y-=uX.y}if(uT=uc.width*uK,u$=uc.height*uo,uq=uc.x,uA=uc.y,uy.isWebGL&&"bitmap"===uQ&&(2048<uT||2048<u$))return console.warn("cache bitmap size larger than 2048,cache ignored"),ub.ctx&&(ur.recover("RenderContext",ub.ctx),ub.ctx.canvas.size(0,0),ub.ctx=null),void uE._fun.call(uE,uW,uj,ut,ud);if(uR||(uR=ub.ctx=ur.getItem("RenderContext")||new ua(uT,u$,uMW.create("AUTO"))),uR.ctx.sprite=uW,(uO=uR.canvas).clear(),(uO.width!=uT||uO.height!=u$)&&uO.size(uT,u$),"bitmap"===uQ?uO.context.asBitmap=!0:"normal"===uQ&&(uO.context.asBitmap=!1),1!=uK||1!=uo){var u_=uR.ctx;u_.save(),u_.scale(uK,uo),!uy.isConchWebGL&&uy.isConchApp&&(ue=uW._$P.cf)&&u_.setFilterMatrix&&u_.setFilterMatrix(ue._mat,ue._alpha),uE._fun.call(uE,uW,uR,-uq,-uA),u_.restore(),uy.isConchApp&&!uy.isConchWebGL||uW._applyFilters()}else u_=uR.ctx,!uy.isConchWebGL&&uy.isConchApp&&(ue=uW._$P.cf)&&u_.setFilterMatrix&&u_.setFilterMatrix(ue._mat,ue._alpha),uE._fun.call(uE,uW,uR,-uq,-uA),uy.isConchApp&&!uy.isConchWebGL||uW._applyFilters();uW._$P.staticCache&&(ub.reCache=!1),uP.canvasReCache++}else uq=(uc=ub._cacheRec).x,uA=uc.y,uO=uR.canvas;uj.drawCanvas(uO,ut+uq,ud+uA,uc.width,uc.height)}else uE._fun.call(uE,uW,uR,ut,ud)},uO.__init__=function(){var uW,uj,ut=0;for(uj=uG.createRenderSprite(69905,null),uW=uO.renders.length=4096,ut=0;ut<uW;ut++)uO.renders[ut]=uj;uO.renders[0]=uG.createRenderSprite(0,null),function(uW,uj){for(var ut=0,ud=0;ud<uW.length;ud++)ut|=uW[ud],uO.renders[ut]=uj}([1,512,4,2],new uO(1,null)),uO.renders[513]=uG.createRenderSprite(513,null),uO.renders[517]=new uO(517,null)},uO._initRenderFun=function(uW,uj,ut,ud){var ub=uW._renderType;(uO.renders[ub]=uO._getTypeRender(ub))._fun(uW,uj,ut,ud)},uO._getTypeRender=function(uW){for(var uj=null,ut=2048;1<ut;)ut&uW&&(uj=uG.createRenderSprite(ut,uj)),ut>>=1;return uj},uO.IMAGE=1,uO.ALPHA=2,uO.TRANSFORM=4,uO.BLEND=8,uO.CANVAS=16,uO.FILTERS=32,uO.MASK=64,uO.CLIP=128,uO.STYLE=256,uO.GRAPHICS=512,uO.CUSTOM=1024,uO.CHILDS=2048,uO.INIT=69905,uO.renders=[],uO.NORENDER=new uO(0,null),uO}(),uD=function(){function uq(){this._repaint=!1}ue(uq,"laya.resource.Context");var uW=uq.prototype;return uW.replaceReset=function(){var uW,uj,ut=0;for(uW=uq.replaceKeys.length,ut=0;ut<uW;ut++)uj=uq.replaceKeys[ut],this[uq.newKeys[ut]]=this[uj]},uW.replaceResotre=function(){this.__restore(),this.__reset()},uW.setIsMainContext=function(){},uW.drawTextures=function(uW,uj,ut,ud){uP.drawCall+=uj.length/2;for(var ub=uW.width,uE=uW.height,uO=0,uq=uj.length;uO<uq;uO+=2)this.drawTexture(uW,uj[uO],uj[uO+1],ub,uE,ut,ud)},uW.drawCanvas=function(uW,uj,ut,ud,ub){uP.drawCall++,this.drawImage(uW.source,uj,ut,ud,ub)},uW.fillRect=function(uW,uj,ut,ud,ub){uP.drawCall++,ub&&(this.fillStyle=ub),this.__fillRect(uW,uj,ut,ud)},uW.fillText=function(uW,uj,ut,ud,ub,uE){uP.drawCall++,3<arguments.length&&null!=ud&&(this.font=ud,this.fillStyle=ub,this.textAlign=uE,this.textBaseline="top"),this.__fillText(uW,uj,ut)},uW.fillBorderText=function(uW,uj,ut,ud,ub,uE,uO,uq){uP.drawCall++,this.font=ud,this.fillStyle=ub,this.textBaseline="top",this.strokeStyle=uE,this.lineWidth=uO,this.textAlign=uq,this.__strokeText(uW,uj,ut),this.__fillText(uW,uj,ut)},uW.strokeText=function(uW,uj,ut,ud,ub,uE,uO){uP.drawCall++,3<arguments.length&&null!=ud&&(this.font=ud,this.strokeStyle=ub,this.lineWidth=uE,this.textAlign=uO,this.textBaseline="top"),this.__strokeText(uW,uj,ut)},uW.transformByMatrix=function(uW){this.transform(uW.a,uW.b,uW.c,uW.d,uW.tx,uW.ty)},uW.setTransformByMatrix=function(uW){this.setTransform(uW.a,uW.b,uW.c,uW.d,uW.tx,uW.ty)},uW.clipRect=function(uW,uj,ut,ud){uP.drawCall++,this.beginPath(),this.rect(uW,uj,ut,ud),this.clip()},uW.drawTexture=function(uW,uj,ut,ud,ub,uE,uO){uP.drawCall++;var uq=uW.uv,uA=uW.bitmap.width,uc=uW.bitmap.height;this.drawImage(uW.source,uq[0]*uA,uq[1]*uc,(uq[2]-uq[0])*uA,(uq[5]-uq[3])*uc,uj+uE,ut+uO,ud,ub)},uW.drawTextureWithTransform=function(uW,uj,ut,ud,ub,uE,uO,uq,uA){uP.drawCall++;var uc=uW.uv,uR=uW.bitmap.width,um=uW.bitmap.height;this.save(),1!=uA&&(this.globalAlpha*=uA),uE?(this.transform(uE.a,uE.b,uE.c,uE.d,uE.tx+uO,uE.ty+uq),this.drawImage(uW.source,uc[0]*uR,uc[1]*um,(uc[2]-uc[0])*uR,(uc[5]-uc[3])*um,uj,ut,ud,ub)):this.drawImage(uW.source,uc[0]*uR,uc[1]*um,(uc[2]-uc[0])*uR,(uc[5]-uc[3])*um,uj+uO,ut+uq,ud,ub),this.restore()},uW.drawTexture2=function(uW,uj,ut,ud,ub,uE,uO,uq){var uA=uq[0];if(uA.loaded&&uA.bitmap&&uA.source){uP.drawCall++;var uc=1!==uE;if(uc){var uR=this.globalAlpha;this.globalAlpha*=uE}var um=uA.uv,uQ=uA.bitmap.width,uT=uA.bitmap.height;ub?(this.save(),this.transform(ub.a,ub.b,ub.c,ub.d,ub.tx+uW,ub.ty+uj),this.drawImage(uA.source,um[0]*uQ,um[1]*uT,(um[2]-um[0])*uQ,(um[5]-um[3])*uT,uq[1]-ut,uq[2]-ud,uq[3],uq[4]),this.restore()):this.drawImage(uA.source,um[0]*uQ,um[1]*uT,(um[2]-um[0])*uQ,(um[5]-um[3])*uT,uq[1]-ut+uW,uq[2]-ud+uj,uq[3],uq[4]),uc&&(this.globalAlpha=uR)}},uW.fillTexture=function(uW,uj,ut,ud,ub,uE,uO,uq){if(!uq.pat){if(uW.uv!=uRW.DEF_UV){var uA=new uMW("2D");uA.getContext("2d"),uA.size(uW.width,uW.height),uA.context.drawTexture(uW,0,0,uW.width,uW.height,0,0),uW=new uRW(uA)}uq.pat=this.createPattern(uW.bitmap.source,uE)}var uc=uj,uR=ut,um=0,uQ=0;uO&&(uc+=uO.x%uW.width,uR+=uO.y%uW.height,um-=uO.x%uW.width,uQ-=uO.y%uW.height),this.translate(uc,uR),this.fillRect(um,uQ,ud,ub,uq.pat),this.translate(-uc,-uR)},uW.drawTriangle=function(uW,uj,ut,ud,ub,uE,uO,uq){var uA=uW.bitmap,uc=uA.source,uR=uW.width,um=uW.height,uQ=uA.width,uT=uA.height,u$=ut[ud]*uQ,ue=ut[ub]*uQ,uK=ut[uE]*uQ,uo=ut[ud+1]*uT,uS=ut[ub+1]*uT,uM=ut[uE+1]*uT,uZ=uj[ud],uX=uj[ub],u_=uj[uE],uN=uj[ud+1],uz=uj[ub+1],uC=uj[uE+1];if(uq){var uL=(uZ+uX+u_)/3,uV=(uN+uz+uC)/3,ux=uZ-uL,uG=uN-uV,ul=Math.sqrt(ux*ux+uG*uG);uZ=uL+ux/ul*(ul+1),uN=uV+uG/ul*(ul+1),uG=uz-uV,uX=uL+(ux=uX-uL)/(ul=Math.sqrt(ux*ux+uG*uG))*(ul+1),uz=uV+uG/ul*(ul+1),uG=uC-uV,u_=uL+(ux=u_-uL)/(ul=Math.sqrt(ux*ux+uG*uG))*(ul+1),uC=uV+uG/ul*(ul+1)}this.save(),uO&&this.transform(uO.a,uO.b,uO.c,uO.d,uO.tx,uO.ty),this.beginPath(),this.moveTo(uZ,uN),this.lineTo(uX,uz),this.lineTo(u_,uC),this.closePath(),this.clip();var uh=1/(u$*uS+uo*uK+ue*uM-uS*uK-uo*ue-u$*uM),uv=uZ*uS+uo*u_+uX*uM-uS*u_-uo*uX-uZ*uM,uy=u$*uX+uZ*uK+ue*u_-uX*uK-uZ*ue-u$*u_,ua=u$*uS*u_+uo*uX*uK+uZ*ue*uM-uZ*uS*uK-uo*ue*u_-u$*uX*uM,uu=uN*uS+uo*uC+uz*uM-uS*uC-uo*uz-uN*uM,uD=u$*uz+uN*uK+ue*uC-uz*uK-uN*ue-u$*uC,us=u$*uS*uC+uo*uz*uK+uN*ue*uM-uN*uS*uK-uo*ue*uC-u$*uz*uM;this.transform(uv*uh,uu*uh,uy*uh,uD*uh,ua*uh,us*uh),this.drawImage(uc,uW.uv[0]*uQ,uW.uv[1]*uT,uR,um,uW.uv[0]*uQ,uW.uv[1]*uT,uR,um),this.restore()},uW.flush=function(){return 0},uW.fillWords=function(uW,uj,ut,ud,ub,uE){ud&&(this.font=ud),ub&&(this.fillStyle=ub);this.textBaseline="top",this.textAlign="left";for(var uO=0,uq=uW.length;uO<uq;uO++){var uA=uW[uO];if(this.__fillText(uA.char,uA.x+uj,uA.y+ut),1===uE){var uc=uA.height,uR=.5*uA.style.letterSpacing;uR||(uR=0),this.beginPath(),this.strokeStyle=ub,this.lineWidth=1,this.moveTo(uj+uA.x-uR+.5,ut+uA.y+uc+.5),this.lineTo(uj+uA.x+uA.width+uR+.5,ut+uA.y+uc+.5),this.stroke()}}},uW.fillBorderWords=function(uW,uj,ut,ud,ub,uE,uO){ud&&(this.font=ud),ub&&(this.fillStyle=ub),this.textBaseline="top",this.lineWidth=uO,this.textAlign="left",this.strokeStyle=uE;for(var uq=0,uA=uW.length;uq<uA;uq++){var uc=uW[uq];this.__strokeText(uc.char,uc.x+uj,uc.y+ut),this.__fillText(uc.char,uc.x+uj,uc.y+ut)}},uW.destroy=function(){this.canvas.width=this.canvas.height=0},uW.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},uW.drawCurves=function(uW,uj,ut){this.beginPath(),this.strokeStyle=ut[3],this.lineWidth=ut[4];var ud=ut[2];uW+=ut[0],uj+=ut[1],this.moveTo(uW+ud[0],uj+ud[1]);for(var ub=2,uE=ud.length;ub<uE;)this.quadraticCurveTo(uW+ud[ub++],uj+ud[ub++],uW+ud[ub++],uj+ud[ub++]);this.stroke()},uq.__init__=function(uj){var ut=laya.resource.Context.prototype;if(!(uj=uj||CanvasRenderingContext2D.prototype).inited){uj.inited=!0,uj.__fillText=uj.fillText,uj.__fillRect=uj.fillRect,uj.__strokeText=uj.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(uW){uj[uW]=ut[uW]})}},uq.replaceCanvasGetSet=function(uW,uj){var ut=Object.getOwnPropertyDescriptor(uW,uj);if(!ut||!ut.configurable)return!1;var ud,ub={};for(ud in ut)"set"!=ud&&(ub[ud]=ut[ud]);var uE=ut.set;return ub.set=function(uW){uE.call(this,uW);var uj=this.getContext("2d");uj&&"__reset"in uj&&uj.__reset()},Object.defineProperty(uW,uj,ub),!0},uq.replaceGetSet=function(uW,uj){var ut=Object.getOwnPropertyDescriptor(uW,uj);if(!ut||!ut.configurable)return!1;var ud,ub={};for(ud in ut)"set"!=ud&&(ub[ud]=ut[ud]);var uE=ut.set,uO="___"+uj+"__";return uq.newKeys.push(uO),ub.set=function(uW){uW!=this[uO]&&(this[uO]=uW,uE.call(this,uW))},Object.defineProperty(uW,uj,ub),!0},uq._default=new uq,uq.newKeys=[],uA(uq,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),uq}(),us=function(){function uE(uW){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++uE._uniqueIDCounter,this._name=uW||"Content Manager",uE._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,uE._resourceManagers.push(this),this._resources=[],this._records={}}ue(uE,"laya.resource.ResourceManager");var uW=uE.prototype;return uN.imps(uW,{"laya.resource.IDispose":!0}),uW.getResourceByIndex=function(uW){return this._resources[uW]},uW.getResourcesLength=function(){return this._resources.length},uW.addResource=function(uW){return uW.resourceManager&&uW.resourceManager.removeResource(uW),-1===this._resources.indexOf(uW)&&((uW._resourceManager=this)._resources.push(uW),this.addRecord(uW.uri,uW.__className,uW.memorySize),this.addSize(uW.memorySize),!0)},uW.removeResource=function(uW){var uj=this._resources.indexOf(uW);return-1!==uj&&(this._resources.splice(uj,1),uW._resourceManager=null,this._memorySize-=uW.memorySize,this.addRecord(uW.uri,uW.__className,-uW.memorySize),!0)},uW.unload=function(){for(var uW=this._resources.slice(0,this._resources.length),uj=0;uj<uW.length;uj++){uW[uj].destroy()}uW.length=0},uW.dispose=function(){if(this===uE._systemResourceManager)throw new Error("systemResourceManager不能被释放！");uE._resourceManagers.splice(uE._resourceManagers.indexOf(this),1),uE._isResourceManagersSorted=!1;for(var uW=this._resources.slice(0,this._resources.length),uj=0;uj<uW.length;uj++){var ut=uW[uj];ut.resourceManager.removeResource(ut),ut.destroy()}uW.length=0},uW.addSize=function(uW){uW&&(this.autoRelease&&0<uW&&this._memorySize+uW>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=uW)},uW.addRecord=function(uW,uj,ut){DEBUG&&ut&&!uW&&console.error(uW,uj,ut),uW&&(this._records.hasOwnProperty(uj+"|"+uW)||(this._records[uj+"|"+uW]=0),this._records[uj+"|"+uW]+=ut,DEBUG&&this._records[uj+"|"+uW]<0&&console.error(uW,uj,this._records[uj+"|"+uW]))},uW.garbageCollection=function(uW){var uj=this._resources;(uj=uj.slice()).sort(function(uW,uj){if(!uW||!uj)throw new Error("a或b不能为空！");return uW.released&&uj.released?0:uW.released?1:uj.released?-1:uW._lastUseFrameCount-uj._lastUseFrameCount});for(var ut=uP.loopCount,ud=0,ub=uj.length;ud<ub;ud++){var uE=uj[ud];if(!(1<ut-uE._lastUseFrameCount))return void(this._memorySize>=uW&&(this._isOverflow=!0));if(uE.releaseResource(),this._memorySize<uW)return void(this._isOverflow=!1)}},uR(0,uW,"id",function(){return this._id}),uR(0,uW,"name",function(){return this._name},function(uW){!uW&&""===uW||this._name===uW||(this._name=uW,uE._isResourceManagersSorted=!1)}),uR(0,uW,"memorySize",function(){return this._memorySize}),uR(0,uW,"records",function(){return this._records}),uR(1,uE,"systemResourceManager",function(){return uE._systemResourceManager}),uE.__init__=function(){uE.currentResourceManager=uE.systemResourceManager},uE.getLoadedResourceManagerByIndex=function(uW){return uE._resourceManagers[uW]},uE.getLoadedResourceManagersCount=function(){return uE._resourceManagers.length},uE.recreateContentManagers=function(uW){void 0===uW&&(uW=!1);for(var uj=uE.currentResourceManager,ut=0;ut<uE._resourceManagers.length;ut++){uE.currentResourceManager=uE._resourceManagers[ut];for(var ud=0;ud<uE.currentResourceManager._resources.length;ud++)uE.currentResourceManager._resources[ud].releaseResource(uW),uE.currentResourceManager._resources[ud].activeResource(uW)}uE.currentResourceManager=uj},uE.releaseContentManagers=function(uW){void 0===uW&&(uW=!1);for(var uj=uE.currentResourceManager,ut=0;ut<uE._resourceManagers.length;ut++){uE.currentResourceManager=uE._resourceManagers[ut];for(var ud=0;ud<uE.currentResourceManager._resources.length;ud++){var ub=uE.currentResourceManager._resources[ud];!ub.released&&ub.releaseResource(uW)}}uE.currentResourceManager=uj},uE._uniqueIDCounter=0,uE._isResourceManagersSorted=!1,uE._resourceManagers=[],uA(uE,["_systemResourceManager",function(){return this._systemResourceManager=new uE("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=uE._systemResourceManager}]),uE}(),uY=(function(){function uW(){}ue(uW,"laya.system.System"),uW.changeDefinition=function(uW,uj){uN[uW]=uj;var ut=uW+"=classObj";uN._runScript(ut)},uW.__init__=function(){uy.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function ut(){}return ue(ut,"laya.utils.Browser"),uR(1,ut,"pixelRatio",function(){return ut.__init__(),-1<ut.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:uG.getPixelRatio()}),uR(1,ut,"height",function(){return ut.__init__(),(uN.stage&&uN.stage.canvasRotation?ut.clientWidth:ut.clientHeight)*ut.pixelRatio}),uR(1,ut,"clientWidth",function(){return ut.__init__(),ut.window.innerWidth||ut.document.body.clientWidth}),uR(1,ut,"window",function(){return ut.__init__(),ut._window}),uR(1,ut,"clientHeight",function(){return ut.__init__(),ut.window.innerHeight||ut.document.body.clientHeight||ut.document.documentElement.clientHeight}),uR(1,ut,"width",function(){return ut.__init__(),(uN.stage&&uN.stage.canvasRotation?ut.clientHeight:ut.clientWidth)*ut.pixelRatio}),uR(1,ut,"container",function(){return ut.__init__(),ut._container||((ut._container=ut.createElement("div")).id="layaContainer",ut.document.body.appendChild(ut._container)),ut._container},function(uW){ut._container=uW}),uR(1,ut,"document",function(){return ut.__init__(),ut._document}),ut.__init__=function(){if(!ut._window){ut._window=uG.getWindow(),ut._document=ut.window.document,ut._window.addEventListener("message",function(uW){laya.utils.Browser._onMessage(uW)},!1),ut.document.__createElement=ut.document.createElement,uO.requestAnimationFrame=uO.requestAnimationFrame||uO.webkitRequestAnimationFrame||uO.mozRequestAnimationFrame||uO.oRequestAnimationFrame||uO.msRequestAnimationFrame||function(uW){return uO.setTimeout(uW,1e3/60)};var uW=uO.document.body.style;uW["-webkit-user-select"]="none",uW["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",ut.userAgent=ut.window.navigator.userAgent,ut.onIOS=!!(ut.u=ut.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),ut.onMobile=-1<ut.u.indexOf("Mobile"),ut.onIPhone=-1<ut.u.indexOf("iPhone"),ut.onMac=-1<ut.u.indexOf("Mac OS X"),ut.onIPad=-1<ut.u.indexOf("iPad"),ut.onAndroid=-1<ut.u.indexOf("Android")||-1<ut.u.indexOf("Adr"),ut.onWP=-1<ut.u.indexOf("Windows Phone"),ut.onQQBrowser=-1<ut.u.indexOf("QQBrowser"),ut.onMQQBrowser=-1<ut.u.indexOf("MQQBrowser")||-1<ut.u.indexOf("Mobile")&&-1<ut.u.indexOf("QQ"),ut.onIE=!!ut.window.ActiveXObject||"ActiveXObject"in ut.window,ut.onWeiXin=-1<ut.u.indexOf("MicroMessenger"),ut.onPC=!ut.onMobile,ut.onSafari=-1<ut.u.indexOf("Safari"),ut.onFirefox=-1<ut.u.indexOf("Firefox"),ut.onEdge=-1<ut.u.indexOf("Edge"),ut.onMiniGame=-1<ut.u.indexOf("MiniGame"),ut.onLimixiu=-1<ut.u.indexOf("limixiu"),ut.httpProtocol="http:"==ut.window.location.protocol,ut.onMiniGame&&null==ut.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),ut.webAudioEnabled=!!(ut.window.AudioContext||ut.window.webkitAudioContext||ut.window.mozAudioContext),ut.soundType=ut.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",ubW=ut.webAudioEnabled?uEW:utW,ut.webAudioEnabled&&uEW.initWebAudio(),utW._initMusicAudio(),ut.enableTouch="ontouchstart"in uO||uO.DocumentTouch&&uj instanceof DocumentTouch,uO.focus(),ux._soundClass=ubW,ux._musicClass=utW,uy._mainCanvas=uy._mainCanvas||uMW.create("2D"),ut.canvas||(ut.canvas=uMW.create("2D"),ut.context=ut.canvas.getContext("2d"))}},ut._onMessage=function(uW){if(uW.data&&"size"==uW.data.name){if(ut.window.innerWidth=uW.data.width,ut.window.innerHeight=uW.data.height,ut.window.__innerHeight=uW.data.clientHeight,!ut.document.createEvent)return void console.warn("no document.createEvent");var uj=ut.document.createEvent("HTMLEvents");return uj.initEvent("resize",!1,!1),void ut.window.dispatchEvent(uj)}},ut.createElement=function(uW){return ut.__init__(),ut.document.__createElement(uW)},ut.getElementById=function(uW){return ut.__init__(),ut.document.getElementById(uW)},ut.removeElement=function(uW){uW&&uW.parentNode&&uW.parentNode.removeChild(uW)},ut.now=function(){return uG.now()},ut._window=null,ut._document=null,ut._container=null,ut.userAgent=null,ut.u=null,ut.onIOS=!1,ut.onMac=!1,ut.onMobile=!1,ut.onIPhone=!1,ut.onIPad=!1,ut.onAndroid=!1,ut.onWP=!1,ut.onQQBrowser=!1,ut.onMQQBrowser=!1,ut.onSafari=!1,ut.onFirefox=!1,ut.onEdge=!1,ut.onIE=!1,ut.onWeiXin=!1,ut.onMiniGame=!1,ut.onLimixiu=!1,ut.onPC=!1,ut.httpProtocol=!1,ut.webAudioEnabled=!1,ut.soundType=null,ut.enableTouch=!1,ut.canvas=null,ut.context=null,ut.__init$=function(){},ut}()),uH=function(){function uj(uW){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,uW?(this._u8d_=new Uint8Array(uW),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}ue(uj,"laya.utils.Byte");var uW=uj.prototype;return uW.___resizeBuffer=function(uj){try{var uW=new Uint8Array(uj);null!=this._u8d_&&(this._u8d_.length<=uj?uW.set(this._u8d_):uW.set(this._u8d_.subarray(0,uj))),this._u8d_=uW,this._d_=new DataView(uW.buffer)}catch(uW){throw"___resizeBuffer err:"+uj}},uW.getString=function(){return this.rUTF(this.getUint16())},uW.getFloat32Array=function(uW,uj){var ut=uW+uj;ut=ut>this._length?this._length:ut;var ud=new Float32Array(this._d_.buffer.slice(uW,ut));return this._pos_=ut,ud},uW.getUint8Array=function(uW,uj){var ut=uW+uj;ut=ut>this._length?this._length:ut;var ud=new Uint8Array(this._d_.buffer.slice(uW,ut));return this._pos_=ut,ud},uW.getInt16Array=function(uW,uj){var ut=uW+uj;ut=ut>this._length?this._length:ut;var ud=new Int16Array(this._d_.buffer.slice(uW,ut));return this._pos_=ut,ud},uW.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var uW=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,uW},uW.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var uW=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,uW},uW.writeFloat32=function(uW){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,uW,this._xd_),this._pos_+=4},uW.writeFloat64=function(uW){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,uW,this._xd_),this._pos_+=8},uW.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var uW=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,uW},uW.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var uW=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,uW},uW.writeInt32=function(uW){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,uW,this._xd_),this._pos_+=4},uW.writeUint32=function(uW){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,uW,this._xd_),this._pos_+=4},uW.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var uW=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,uW},uW.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var uW=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,uW},uW.writeUint16=function(uW){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,uW,this._xd_),this._pos_+=2},uW.writeInt16=function(uW){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,uW,this._xd_),this._pos_+=2},uW.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},uW.writeUint8=function(uW){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,uW),this._pos_++},uW._getUInt8=function(uW){return this._d_.getUint8(uW)},uW._getUint16=function(uW){return this._d_.getUint16(uW,this._xd_)},uW._getMatrix=function(){return new ul(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},uW.rUTF=function(uW){for(var uj=[],ut=this._pos_+uW,ud=0,ub=0,uE=0,uO=String.fromCharCode,uq=this._u8d_;this._pos_<ut;)(ud=uq[this._pos_++])<128?0!=ud&&uj.push(uO(ud)):ud<224?uj.push(uO((63&ud)<<6|127&uq[this._pos_++])):ud<240?(ub=uq[this._pos_++],uj.push(uO((31&ud)<<12|(127&ub)<<6|127&uq[this._pos_++]))):(ub=uq[this._pos_++],uE=uq[this._pos_++],uj.push(uO((15&ud)<<18|(127&ub)<<12|uE<<6&127|127&uq[this._pos_++]))),0;return uj.join("")},uW.getCustomString=function(uW){for(var uj=[],ut=0,ud=0,ub=0,uE=String.fromCharCode,uO=this._u8d_;0<uW;)if((ud=uO[this._pos_])<128)uj.push(uE(ud)),this._pos_++,uW--;else for(ut=ud-128,this._pos_++,uW-=ut;0<ut;)ud=uO[this._pos_++],ub=uO[this._pos_++],uj.push(uE(ub<<8|ud)),ut--;return uj.join("")},uW.clear=function(){this._pos_=0,this.length=0},uW.__getBuffer=function(){return this._d_.buffer},uW.writeUTFBytes=function(uW){for(var uj=0,ut=(uW+="").length;uj<ut;uj++){var ud=uW.charCodeAt(uj);ud<=127?this.writeByte(ud):ud<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|ud>>6,128|63&ud],this._pos_),this._pos_+=2):ud<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|ud>>12,128|ud>>6&63,128|63&ud],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|ud>>18,128|ud>>12&63,128|ud>>6&63,128|63&ud],this._pos_),this._pos_+=4)}},uW.writeUTFString=function(uW){var uj=this.pos;this.writeUint16(1),this.writeUTFBytes(uW);var ut=this.pos-uj-2;if(65536<=ut)throw"writeUTFString byte len more than 65536";this._d_.setUint16(uj,ut,this._xd_)},uW.readUTFString=function(){return this.readUTFBytes(this.getUint16())},uW.getUTFString=function(){return this.readUTFString()},uW.readUTFBytes=function(uW){if(void 0===uW&&(uW=-1),0==uW)return"";var uj=this.bytesAvailable;if(uj<uW)throw"readUTFBytes error - Out of bounds";return uW=0<uW?uW:uj,this.rUTF(uW)},uW.getUTFBytes=function(uW){return void 0===uW&&(uW=-1),this.readUTFBytes(uW)},uW.writeByte=function(uW){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,uW),this._pos_+=1},uW.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},uW.getByte=function(){return this.readByte()},uW.ensureWrite=function(uW){this._length<uW&&(this._length=uW),this._allocated_<uW&&(this.length=uW)},uW.writeArrayBuffer=function(uW,uj,ut){if(void 0===uj&&(uj=0),void 0===ut&&(ut=0),uj<0||ut<0)throw"writeArrayBuffer error - Out of bounds";0==ut&&(ut=uW.byteLength-uj),this.ensureWrite(this._pos_+ut);var ud=new Uint8Array(uW);this._u8d_.set(ud.subarray(uj,uj+ut),this._pos_),this._pos_+=ut},uR(0,uW,"buffer",function(){var uW=this._d_.buffer;return uW.byteLength==this.length?uW:uW.slice(0,this.length)}),uR(0,uW,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(uW){this._xd_="littleEndian"==uW}),uR(0,uW,"length",function(){return this._length},function(uW){this._allocated_<uW?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(uW,2*this._allocated_))):this._allocated_>uW&&this.___resizeBuffer(this._allocated_=uW),this._length=uW}),uR(0,uW,"pos",function(){return this._pos_},function(uW){this._pos_=uW}),uR(0,uW,"bytesAvailable",function(){return this._length-this._pos_}),uj.getSystemEndian=function(){if(!uj._sysEndian){var uW=new ArrayBuffer(2);new DataView(uW).setInt16(0,256,!0),uj._sysEndian=256===new Int16Array(uW)[0]?"littleEndian":"bigEndian"}return uj._sysEndian},uj.BIG_ENDIAN="bigEndian",uj.LITTLE_ENDIAN="littleEndian",uj._sysEndian=null,uj}(),uI=function(){function ub(){}return ue(ub,"laya.utils.CacheManager"),ub.regCacheByFunction=function(uW,uj){var ut;ub.unRegCacheByFunction(uW,uj),ut={tryDispose:uW,getCacheList:uj},ub._cacheList.push(ut)},ub.unRegCacheByFunction=function(uW,uj){var ut,ud=0;for(ut=ub._cacheList.length,ud=0;ud<ut;ud++)if(ub._cacheList[ud].tryDispose==uW&&ub._cacheList[ud].getCacheList==uj)return void ub._cacheList.splice(ud,1)},ub.forceDispose=function(){var uW=0,uj=ub._cacheList.length;for(uW=0;uW<uj;uW++)ub._cacheList[uW].tryDispose(!0)},ub.beginCheck=function(uW){void 0===uW&&(uW=15e3),uN.timer.loop(uW,null,ub._checkLoop)},ub.stopCheck=function(){uN.timer.clear(null,ub._checkLoop)},ub._checkLoop=function(){var uW=ub._cacheList;if(!(uW.length<1)){var uj,ut=uY.now(),ud=0;for(uj=ud=uW.length;0<ud&&(uW[ub._index=++ub._index%uj].tryDispose(!1),!(uY.now()-ut>ub.loopTimeLimit));)ud--}},ub.loopTimeLimit=2,ub._cacheList=[],ub._index=0,ub}(),ug=function(){function uT(){}return ue(uT,"laya.utils.ClassUtils"),uT.regClass=function(uW,uj){uT._classMap[uW]=uj},uT.getRegClass=function(uW){return uT._classMap[uW]},uT.getInstance=function(uW){var uj=uT.getClass(uW);return uj?new uj:(console.warn("[error] Undefined class:",uW),null)},uT.createByJson=function(uW,uj,ut,ud,ub){"string"==typeof uW&&(uW=JSON.parse(uW));var uE=uW.props;if(!uj&&!(uj=ub?ub.runWith(uW):uT.getInstance(uE.runtime||uW.type)))return null;var uO=uW.child;if(uO)for(var uq=0,uA=uO.length;uq<uA;uq++){var uc=uO[uq];if("render"!==uc.props.name&&"render"!==uc.props.renderType||!uj._$set_itemRender)if("Graphic"==uc.type)uT.addGraphicsToSprite(uc,uj);else if(uT.isDrawType(uc.type))uT.addGraphicToSprite(uc,uj,!0);else{var uR=uT.createByJson(uc,null,ut,ud,ub);"Script"==uc.type?uR.hasOwnProperty("owner")?uR.owner=uj:uR.hasOwnProperty("target")&&(uR.target=uj):"mask"==uc.props.renderType?uj.mask=uR:uj.addChild(uR)}else uj.itemRender=uc}if(uE)for(var um in uE){var uQ=uE[um];"var"===um&&ut?ut[uQ]=uj:uQ instanceof Array&&"function"==typeof uj[um]?uj[um].apply(uj,uQ):uj[um]=uQ}return ud&&uW.customProps&&ud.runWith([uj,uW]),uj.created&&uj.created(),uj},uT.addGraphicsToSprite=function(uW,uj){var ut;if((ut=uW.child)&&!(ut.length<1)){var ud;ud=uT._getGraphicsFromSprite(uW,uj);var ub=0,uE=0;uW.props&&(ub=uT._getObjVar(uW.props,"x",0),uE=uT._getObjVar(uW.props,"y",0)),0!=ub&&0!=uE&&ud.translate(ub,uE);var uO,uq=0;for(uO=ut.length,uq=0;uq<uO;uq++)uT._addGraphicToGraphics(ut[uq],ud);0!=ub&&0!=uE&&ud.translate(-ub,-uE)}},uT.addGraphicToSprite=function(uW,uj,ut){var ud;void 0===ut&&(ut=!1),ud=ut?uT._getGraphicsFromSprite(uW,uj):uj.graphics,uT._addGraphicToGraphics(uW,ud)},uT._getGraphicsFromSprite=function(uW,uj){var ut,ud;if(!uW||!uW.props)return uj.graphics;switch(ud=uW.props.renderType){case"hit":case"unHit":var ub;uj.hitArea||(uj.hitArea=new uJ),(ub=uj.hitArea)[ud]||(ub[ud]=new uQ),ut=ub[ud]}return ut||(ut=uj.graphics),ut},uT._getTransformData=function(uW){var uj;(uW.hasOwnProperty("pivotX")||uW.hasOwnProperty("pivotY"))&&(uj=uj||new ul).translate(-uT._getObjVar(uW,"pivotX",0),-uT._getObjVar(uW,"pivotY",0));var ut=uT._getObjVar(uW,"scaleX",1),ud=uT._getObjVar(uW,"scaleY",1),ub=uT._getObjVar(uW,"rotation",0);uT._getObjVar(uW,"skewX",0),uT._getObjVar(uW,"skewY",0);return 1==ut&&1==ud&&0==ub||((uj=uj||new ul).scale(ut,ud),uj.rotate(.0174532922222222*ub)),uj},uT._addGraphicToGraphics=function(uW,uj){var ut,ud;if((ut=uW.props)&&(ud=uT.DrawTypeDic[uW.type])){var ub,uE;ub=uj;var uO=uT._getParams(ut,ud[1],ud[2],ud[3]);((uE=uT._tM)||1!=uT._alpha)&&(ub.save(),uE&&ub.transform(uE),1!=uT._alpha&&ub.alpha(uT._alpha)),ub[ud[0]].apply(ub,uO),(uE||1!=uT._alpha)&&ub.restore()}},uT._adptLineData=function(uW){return uW[2]=parseFloat(uW[0])+parseFloat(uW[2]),uW[3]=parseFloat(uW[1])+parseFloat(uW[3]),uW},uT._adptTextureData=function(uW){return uW[0]=uqW.getRes(uW[0]),uW},uT._adptLinesData=function(uW){return uW[2]=uT._getPointListByStr(uW[2]),uW},uT.isDrawType=function(uW){return"Image"!=uW&&uT.DrawTypeDic.hasOwnProperty(uW)},uT._getParams=function(uW,uj,ut,ud){var ub;void 0===ut&&(ut=0),(ub=uT._temParam).length=uj.length;var uE,uO,uq=0;for(uE=uj.length,uq=0;uq<uE;uq++)ub[uq]=uT._getObjVar(uW,uj[uq][0],uj[uq][1]);return uT._alpha=uT._getObjVar(uW,"alpha",1),uO=uT._getTransformData(uW),uT._tM=uO?(ut||(ut=0),uO.translate(ub[ut],ub[ut+1]),ub[ut]=ub[ut+1]=0,uO):null,ud&&uT[ud]&&(ub=uT[ud](ub)),ub},uT._getPointListByStr=function(uW){var uj,ut,ud=0;for(ut=(uj=uW.split(",")).length,ud=0;ud<ut;ud++)uj[ud]=parseFloat(uj[ud]);return uj},uT._getObjVar=function(uW,uj,ut){return uW.hasOwnProperty(uj)?uW[uj]:ut},uT._temParam=[],uT._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},uT.getClass=function(uW){var uj=uT._classMap[uW]||uW;return"string"==typeof uj?uN.__classmap[uj]:uj},uT._tM=null,uT._alpha=NaN,uA(uT,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),uT}(),uf=function(){function uE(uW){if(this._color=[],"string"==typeof uW){null===(this.strColor=uW)&&(uW="#000000"),"#"==uW.charAt(0)&&(uW=uW.substr(1));var uj=uW.length;if(3==uj||4==uj){for(var ut="",ud=0;ud<uj;ud++)ut+=uW[ud]+uW[ud];uW=ut}var ub=this.numColor=parseInt(uW,16);if(8==uW.length)return void(this._color=[parseInt(uW.substr(0,2),16)/255,((16711680&ub)>>16)/255,((65280&ub)>>8)/255,(255&ub)/255])}else ub=this.numColor=uW,this.strColor=un.toHexColor(ub);this._color=[((16711680&ub)>>16)/255,((65280&ub)>>8)/255,(255&ub)/255,1],this._color.__id=++uE._COLODID}return ue(uE,"laya.utils.Color"),uE._initDefault=function(){for(var uW in uE._DEFAULT={},uE._COLOR_MAP)uE._SAVE[uW]=uE._DEFAULT[uW]=new uE(uE._COLOR_MAP[uW]);return uE._DEFAULT},uE._initSaveMap=function(){for(var uW in uE._SAVE_SIZE=0,uE._SAVE={},uE._DEFAULT)uE._SAVE[uW]=uE._DEFAULT[uW]},uE.create=function(uW){var uj=uE._SAVE[uW+""];return null!=uj?uj:(uE._SAVE_SIZE<1e3||uE._initSaveMap(),uE._SAVE[uW+""]=new uE(uW))},uE._SAVE={},uE._SAVE_SIZE=0,uE._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},uE._DEFAULT=uE._initDefault(),uE._COLODID=1,uE}(),uw=(function(){function uW(){this._values=[],this._keys=[]}ue(uW,"laya.utils.Dictionary");var uj=uW.prototype;uj.set=function(uW,uj){var ut=this.indexOf(uW);0<=ut?this._values[ut]=uj:(this._keys.push(uW),this._values.push(uj))},uj.indexOf=function(uW){var uj=this._keys.indexOf(uW);return 0<=uj?uj:(uW="string"==typeof uW?Number(uW):"number"==typeof uW?uW.toString():uW,this._keys.indexOf(uW))},uj.get=function(uW){var uj=this.indexOf(uW);return uj<0?null:this._values[uj]},uj.remove=function(uW){var uj=this.indexOf(uW);return 0<=uj&&(this._keys.splice(uj,1),this._values.splice(uj,1),!0)},uj.clear=function(){this._values.length=0,this._keys.length=0},uR(0,uj,"values",function(){return this._values}),uR(0,uj,"keys",function(){return this._keys})}(),function(){function uW(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}ue(uW,"laya.utils.Dragging");var uj=uW.prototype;return uj.start=function(uW,uj,ut,ud,ub,uE,uO,uq){void 0===uq&&(uq=.92),this.clearTimer(),this.target=uW,this.area=uj,this.hasInertia=ut,this.elasticDistance=uj?ud:0,this.elasticBackTime=ub,this.data=uE,this._disableMouseEvent=uO,this.ratio=uq,1!=uW.globalScaleX||1!=uW.globalScaleY?this._parent=uW.parent:this._parent=uN.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,uN.stage.on("mouseup",this,this.onStageMouseUp),uN.stage.on("mouseout",this,this.onStageMouseUp),uN.timer.frameLoop(1,this,this.loop)},uj.clearTimer=function(){uN.timer.clear(this,this.loop),uN.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},uj.stop=function(){this._dragging&&(u$.instance.disableMouseEvent=!1,uN.stage.off("mouseup",this,this.onStageMouseUp),uN.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},uj.loop=function(){var uW=this._parent.getMousePoint(),uj=uW.x,ut=uW.y,ud=uj-this._lastX,ub=ut-this._lastY;if(this._clickOnly){if(!(1<Math.abs(ud*uN.stage._canvasTransform.getScaleX())||1<Math.abs(ub*uN.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),u$.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(ud,ub);0==ud&&0==ub||(this._lastX=uj,this._lastY=ut,this.target.x+=ud*this._elasticRateX,this.target.y+=ub*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},uj.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var uW=this.area.x-this.target.x;else uW=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-uW/this.elasticDistance),this.target.y<this.area.y)var uj=this.area.y-this.target.y;else uj=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-uj/this.elasticDistance)}},uj.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},uj.onStageMouseUp=function(uW){if(u$.instance.disableMouseEvent=!1,uN.stage.off("mouseup",this,this.onStageMouseUp),uN.stage.off("mouseout",this,this.onStageMouseUp),uN.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var uj=this._offsets.length,ut=Math.min(uj,6),ud=this._offsets.length-ut,ub=uj-1;ud<ub;ub--)this._offsetY+=this._offsets[ub--],this._offsetX+=this._offsets[ub];this._offsetX=this._offsetX/ut*2,this._offsetY=this._offsetY/ut*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),uN.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},uj.checkElastic=function(){var uW=NaN,uj=NaN;if(this.target.x<this.area.x?uW=this.area.x:this.target.x>this.area.x+this.area.width&&(uW=this.area.x+this.area.width),this.target.y<this.area.y?uj=this.area.y:this.target.y>this.area.y+this.area.height&&(uj=this.area.y+this.area.height),isNaN(uW)&&isNaN(uj))this.clear();else{var ut={};isNaN(uW)||(ut.x=uW),isNaN(uj)||(ut.y=uj),this._tween=uB.to(this.target,ut,this.elasticBackTime,uU.sineOut,uS.create(this,this.clear),0,!1,!1)}},uj.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(uN.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},uj.clear=function(){if(this.target){this.clearTimer();var uW=this.target;this.target=null,this._parent=null,uW.event("dragend",this.data)}},uW}()),uU=function(){function uq(){}return ue(uq,"laya.utils.Ease"),uq.linearNone=function(uW,uj,ut,ud){return ut*uW/ud+uj},uq.linearIn=function(uW,uj,ut,ud){return ut*uW/ud+uj},uq.linearInOut=function(uW,uj,ut,ud){return ut*uW/ud+uj},uq.linearOut=function(uW,uj,ut,ud){return ut*uW/ud+uj},uq.bounceIn=function(uW,uj,ut,ud){return ut-uq.bounceOut(ud-uW,0,ut,ud)+uj},uq.bounceInOut=function(uW,uj,ut,ud){return uW<.5*ud?.5*uq.bounceIn(2*uW,0,ut,ud)+uj:.5*uq.bounceOut(2*uW-ud,0,ut,ud)+.5*ut+uj},uq.bounceOut=function(uW,uj,ut,ud){return(uW/=ud)<1/2.75?ut*(7.5625*uW*uW)+uj:uW<2/2.75?ut*(7.5625*(uW-=1.5/2.75)*uW+.75)+uj:uW<2.5/2.75?ut*(7.5625*(uW-=2.25/2.75)*uW+.9375)+uj:ut*(7.5625*(uW-=2.625/2.75)*uW+.984375)+uj},uq.backIn=function(uW,uj,ut,ud,ub){return void 0===ub&&(ub=1.70158),ut*(uW/=ud)*uW*((ub+1)*uW-ub)+uj},uq.backInOut=function(uW,uj,ut,ud,ub){return void 0===ub&&(ub=1.70158),(uW/=.5*ud)<1?.5*ut*(uW*uW*((1+(ub*=1.525))*uW-ub))+uj:ut/2*((uW-=2)*uW*((1+(ub*=1.525))*uW+ub)+2)+uj},uq.backOut=function(uW,uj,ut,ud,ub){return void 0===ub&&(ub=1.70158),ut*((uW=uW/ud-1)*uW*((ub+1)*uW+ub)+1)+uj},uq.elasticIn=function(uW,uj,ut,ud,ub,uE){var uO;return void 0===ub&&(ub=0),void 0===uE&&(uE=0),0==uW?uj:1==(uW/=ud)?uj+ut:(uE||(uE=.3*ud),uO=!ub||0<ut&&ub<ut||ut<0&&ub<-ut?(ub=ut,uE/4):uE/uq.PI2*Math.asin(ut/ub),-ub*Math.pow(2,10*(uW-=1))*Math.sin((uW*ud-uO)*uq.PI2/uE)+uj)},uq.elasticInOut=function(uW,uj,ut,ud,ub,uE){var uO;return void 0===ub&&(ub=0),void 0===uE&&(uE=0),0==uW?uj:2==(uW/=.5*ud)?uj+ut:(uE||(uE=ud*(.3*1.5)),uO=!ub||0<ut&&ub<ut||ut<0&&ub<-ut?(ub=ut,uE/4):uE/uq.PI2*Math.asin(ut/ub),uW<1?ub*Math.pow(2,10*(uW-=1))*Math.sin((uW*ud-uO)*uq.PI2/uE)*-.5+uj:ub*Math.pow(2,-10*(uW-=1))*Math.sin((uW*ud-uO)*uq.PI2/uE)*.5+ut+uj)},uq.elasticOut=function(uW,uj,ut,ud,ub,uE){var uO;return void 0===ub&&(ub=0),void 0===uE&&(uE=0),0==uW?uj:1==(uW/=ud)?uj+ut:(uE||(uE=.3*ud),uO=!ub||0<ut&&ub<ut||ut<0&&ub<-ut?(ub=ut,uE/4):uE/uq.PI2*Math.asin(ut/ub),ub*Math.pow(2,-10*uW)*Math.sin((uW*ud-uO)*uq.PI2/uE)+ut+uj)},uq.strongIn=function(uW,uj,ut,ud){return ut*(uW/=ud)*uW*uW*uW*uW+uj},uq.strongInOut=function(uW,uj,ut,ud){return(uW/=.5*ud)<1?.5*ut*uW*uW*uW*uW*uW+uj:.5*ut*((uW-=2)*uW*uW*uW*uW+2)+uj},uq.strongOut=function(uW,uj,ut,ud){return ut*((uW=uW/ud-1)*uW*uW*uW*uW+1)+uj},uq.sineInOut=function(uW,uj,ut,ud){return.5*-ut*(Math.cos(Math.PI*uW/ud)-1)+uj},uq.sineIn=function(uW,uj,ut,ud){return-ut*Math.cos(uW/ud*uq.HALF_PI)+ut+uj},uq.sineOut=function(uW,uj,ut,ud){return ut*Math.sin(uW/ud*uq.HALF_PI)+uj},uq.quintIn=function(uW,uj,ut,ud){return ut*(uW/=ud)*uW*uW*uW*uW+uj},uq.quintInOut=function(uW,uj,ut,ud){return(uW/=.5*ud)<1?.5*ut*uW*uW*uW*uW*uW+uj:.5*ut*((uW-=2)*uW*uW*uW*uW+2)+uj},uq.quintOut=function(uW,uj,ut,ud){return ut*((uW=uW/ud-1)*uW*uW*uW*uW+1)+uj},uq.quartIn=function(uW,uj,ut,ud){return ut*(uW/=ud)*uW*uW*uW+uj},uq.quartInOut=function(uW,uj,ut,ud){return(uW/=.5*ud)<1?.5*ut*uW*uW*uW*uW+uj:.5*-ut*((uW-=2)*uW*uW*uW-2)+uj},uq.quartOut=function(uW,uj,ut,ud){return-ut*((uW=uW/ud-1)*uW*uW*uW-1)+uj},uq.cubicIn=function(uW,uj,ut,ud){return ut*(uW/=ud)*uW*uW+uj},uq.cubicInOut=function(uW,uj,ut,ud){return(uW/=.5*ud)<1?.5*ut*uW*uW*uW+uj:.5*ut*((uW-=2)*uW*uW+2)+uj},uq.cubicOut=function(uW,uj,ut,ud){return ut*((uW=uW/ud-1)*uW*uW+1)+uj},uq.quadIn=function(uW,uj,ut,ud){return ut*(uW/=ud)*uW+uj},uq.quadInOut=function(uW,uj,ut,ud){return(uW/=.5*ud)<1?.5*ut*uW*uW+uj:.5*-ut*(--uW*(uW-2)-1)+uj},uq.quadOut=function(uW,uj,ut,ud){return-ut*(uW/=ud)*(uW-2)+uj},uq.expoIn=function(uW,uj,ut,ud){return 0==uW?uj:ut*Math.pow(2,10*(uW/ud-1))+uj-.001*ut},uq.expoInOut=function(uW,uj,ut,ud){return 0==uW?uj:uW==ud?uj+ut:(uW/=.5*ud)<1?.5*ut*Math.pow(2,10*(uW-1))+uj:.5*ut*(2-Math.pow(2,-10*--uW))+uj},uq.expoOut=function(uW,uj,ut,ud){return uW==ud?uj+ut:ut*(1-Math.pow(2,-10*uW/ud))+uj},uq.circIn=function(uW,uj,ut,ud){return-ut*(Math.sqrt(1-(uW/=ud)*uW)-1)+uj},uq.circInOut=function(uW,uj,ut,ud){return(uW/=.5*ud)<1?.5*-ut*(Math.sqrt(1-uW*uW)-1)+uj:.5*ut*(Math.sqrt(1-(uW-=2)*uW)+1)+uj},uq.circOut=function(uW,uj,ut,ud){return ut*Math.sqrt(1-(uW=uW/ud-1)*uW)+uj},uq.HALF_PI=.5*Math.PI,uq.PI2=2*Math.PI,uq}(),uJ=function(){function um(){this._hit=null,this._unHit=null}ue(um,"laya.utils.HitArea");var uW=um.prototype;return uW.isHit=function(uW,uj){return!!um.isHitGraphic(uW,uj,this.hit)&&!um.isHitGraphic(uW,uj,this.unHit)},uW.contains=function(uW,uj){return this.isHit(uW,uj)},uR(0,uW,"hit",function(){return this._hit||(this._hit=new uQ),this._hit},function(uW){this._hit=uW}),uR(0,uW,"unHit",function(){return this._unHit||(this._unHit=new uQ),this._unHit},function(uW){this._unHit=uW}),um.isHitGraphic=function(uW,uj,ut){if(!ut)return!1;var ud;if(!(ud=ut.cmds)&&ut._one&&((ud=um._cmds).length=1,ud[0]=ut._one),!ud)return!1;var ub,uE,uO=0;for(ub=ud.length,uO=0;uO<ub;uO++)if(uE=ud[uO]){var uq=uy._context;switch(uE.callee){case uq._translate:case 6:uW-=uE[0],uj-=uE[1]}if(um.isHitCmd(uW,uj,uE))return!0}return!1},um.isHitCmd=function(uW,uj,ut){if(!ut)return!1;var ud=uy._context,ub=!1;switch(ut.callee){case ud._drawRect:case 13:um._rec.setTo(ut[0],ut[1],ut[2],ut[3]),ub=um._rec.contains(uW,uj);break;case ud._drawCircle:case ud._fillCircle:case 14:ub=(uW-=ut[0])*uW+(uj-=ut[1])*uj<ut[2]*ut[2];break;case ud._drawPoly:case 18:uW-=ut[0],uj-=ut[1],ub=um.ptInPolygon(uW,uj,ut[2])}return ub},um.ptInPolygon=function(uW,uj,ut){var ud;(ud=um._ptPoint).setTo(uW,uj);var ub,uE=0,uO=NaN,uq=NaN,uA=NaN,uc=NaN;ub=ut.length;for(var uR=0;uR<ub;uR+=2){if(uO=ut[uR],uq=ut[uR+1],uA=ut[(uR+2)%ub],uq!=(uc=ut[(uR+3)%ub]))if(!(ud.y<Math.min(uq,uc)))if(!(ud.y>=Math.max(uq,uc)))(ud.y-uq)*(uA-uO)/(uc-uq)+uO>ud.x&&uE++}return uE%2==1},um._cmds=[],uA(um,["_rec",function(){return this._rec=new uC},"_ptPoint",function(){return this._ptPoint=new uz}]),um}(),ur=(function(){function ub(uW,uj,ut,ud){this.char=uW,this.charNum=uW.charCodeAt(0),this._x=this._y=0,this.width=uj,this.height=ut,this.style=ud,this.isWord=!ub._isWordRegExp.test(uW)}ue(ub,"laya.utils.HTMLChar");var uW=ub.prototype;uN.imps(uW,{"laya.display.ILayout":!0}),uW.setSprite=function(uW){this._sprite=uW},uW.getSprite=function(){return this._sprite},uW._isChar=function(){return!0},uW._getCSSStyle=function(){return this.style},uR(0,uW,"width",function(){return this._w},function(uW){this._w=uW}),uR(0,uW,"x",function(){return this._x},function(uW){this._sprite&&(this._sprite.x=uW),this._x=uW}),uR(0,uW,"y",function(){return this._y},function(uW){this._sprite&&(this._sprite.y=uW),this._y=uW}),uR(0,uW,"height",function(){return this._h},function(uW){this._h=uW}),ub._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function uj(){}ue(uj,"laya.utils.Log"),uj.enable=function(){uj._logdiv||(uj._logdiv=uY.window.document.createElement("div"),uY.window.document.body.appendChild(uj._logdiv),uj._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},uj.toggle=function(){var uW=uj._logdiv.style;"1px"==uW.width?uW.width=uW.height="50%":uW.width=uW.height="1px"},uj.print=function(uW){uj._logdiv&&(uj.maxCount<=uj._count&&uj.clear(),uj._count++,uj._logdiv.innerText+=uW+"\n",uj._logdiv.scrollTop=uj._logdiv.scrollHeight)},uj.clear=function(){uj._logdiv.innerText="",uj._count=0},uj._logdiv=null,uj._count=0,uj.maxCount=20}(),function(){function uj(){}ue(uj,"laya.utils.Mouse"),uR(1,uj,"cursor",function(){return uj._style.cursor},function(uW){uj._style.cursor=uW}),uj.hide=function(){"none"!=uj.cursor&&(uj._preCursor=uj.cursor,uj.cursor="none")},uj.show=function(){"none"==uj.cursor&&(uj.cursor=uj._preCursor?uj._preCursor:"auto")},uj._preCursor=null,uA(uj,["_style",function(){return this._style=uY.document.body.style}])}(),function(){function uE(){}return ue(uE,"laya.utils.Pool"),uE.getPoolBySign=function(uW){return uE._poolDic[uW]||(uE._poolDic[uW]=[])},uE.clearBySign=function(uW){uE._poolDic[uW]&&(uE._poolDic[uW].length=0)},uE.recover=function(uW,uj){uj.__InPool||(uj.__InPool=!0,uE.getPoolBySign(uW).push(uj))},uE.getItemByClass=function(uW,uj){var ut=uE.getPoolBySign(uW),ud=ut.length?ut.pop():new uj;return ud.__InPool=!1,ud},uE.getItemByCreateFun=function(uW,uj,ut){var ud=uE.getPoolBySign(uW),ub=ud.length?ud.pop():uj.call(ut);return ub.__InPool=!1,ub},uE.getItem=function(uW){var uj=uE.getPoolBySign(uW),ut=uj.length?uj.pop():null;return ut&&(ut.__InPool=!1),ut},uE._poolDic={},uE.InPoolSign="__InPool",uE}()),uP=function(){function uA(){}return ue(uA,"laya.utils.Stat"),uR(1,uA,"onclick",null,function(uW){uA._sp&&uA._sp.on("click",uA._sp,uW),uA._canvas&&(uA._canvas.source.onclick=uW,uA._canvas.source.style.pointerEvents="")}),uA.show=function(uW,uj,ut){if(void 0===uW&&(uW=0),void 0===uj&&(uj=0),void 0===ut&&(ut=0),!uy.isConchApp||uy.isConchWebGL){if(uy.isConchWebGL||uY.onMiniGame||uY.onLimixiu||(uA._useCanvas=!0),uA._show=!0,uA._fpsData.length=60,uA._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},uA._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},uA._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},uA._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},uy.isWebGL)if(uA._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},uy.is3DMode){if(uA._view[0].title="FPS(3D)",uA._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},uA._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},uA._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==ut){var ud=8;uA._view[ud++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},uA._view[ud++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},uA._view[ud++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},uA._view[ud++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},uA._view[ud++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},uA._view[ud++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},uA._view[ud++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},uA._view[ud++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},uA._view[ud++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==ut){ud=8;uA._view[ud++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},uA._view[ud++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},uA._view[ud++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},uA._view[ud++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},uA._view[ud++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},uA._view[ud++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},uA._view[ud++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else uA._view[0].title="FPS(WebGL)",uA._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else uA._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};uA._useCanvas?uA.createUIPre(uW,uj):uA.createUI(uW,uj),uA.enable()}else uY.window.conch.showFPS&&uY.window.conch.showFPS(uW,uj)},uA.createUIPre=function(uW,uj){var ut=uY.pixelRatio;uA._width=170*ut,uA._vx=75*ut,uA._height=ut*(12*uA._view.length+3*ut)+4,uA._fontSize=12*ut;for(var ud=0;ud<uA._view.length;ud++)uA._view[ud].x=4,uA._view[ud].y=ud*uA._fontSize+2*ut;uA._canvas||((uA._canvas=new uMW("2D")).size(uA._width,uA._height),(uA._ctx=uA._canvas.getContext("2d")).textBaseline="top",uA._ctx.font=uA._fontSize+"px Sans-serif",uA._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+uW+"px;top:"+uj+"px;width:"+uA._width/ut+"px;height:"+uA._height/ut+"px;"),uA._first=!0,uA.loop(),uA._first=!1,uY.container.appendChild(uA._canvas.source)},uA.createUI=function(uW,uj){var ut=uA._sp,ud=uY.pixelRatio;ut||(ut=new umW,(uA._leftText=new uKW).pos(5,5),uA._leftText.color="#ffffff",ut.addChild(uA._leftText),(uA._txt=new uKW).pos(80*ud,5),uA._txt.color="#ffffff",ut.addChild(uA._txt),uA._sp=ut),ut.pos(uW,uj);for(var ub="",uE=0;uE<uA._view.length;uE++){ub+=uA._view[uE].title+"\n"}uA._leftText.text=ub;var uO=170*ud,uq=ud*(12*uA._view.length+3*ud)+4;uA._txt.fontSize=uA._fontSize*ud,uA._leftText.fontSize=uA._fontSize*ud,ut.size(uO,uq),ut.graphics.clear(),ut.graphics.setAlpha(.5),ut.graphics.drawRect(0,0,uO,uq,"#999999"),ut.graphics.setAlpha(1),uA.loop()},uA.enable=function(){uN.timer.frameLoop(1,uA,uA.loop)},uA.hide=function(){uA._show=!1,uN.timer.clear(uA,uA.loop),uA._canvas&&uY.removeElement(uA._canvas.source)},uA.clear=function(){uA.trianglesFaces=uA.drawCall=uA.shaderCall=uA.spriteCount=uA.spriteRenderUseCacheCount=uA.treeNodeCollision=uA.treeSpriteCollision=uA.canvasNormal=uA.canvasBitmap=uA.canvasReCache=0},uA.loop=function(){uA._count++;var uW=uY.now();if(!(uW-uA._timer<1e3)){var uj=uA._count;if(uA.FPS=Math.round(1e3*uj/(uW-uA._timer)),uA._show){uA.trianglesFaces=Math.round(uA.trianglesFaces/uj),uA.spriteCount=uA._useCanvas?(uA.drawCall=Math.round(uA.drawCall/uj)-2,uA.shaderCall=Math.round(uA.shaderCall/uj),Math.round(uA.spriteCount/uj)-1):(uA.drawCall=Math.round(uA.drawCall/uj)-2,uA.shaderCall=Math.round(uA.shaderCall/uj)-4,Math.round(uA.spriteCount/uj)-4),uA.spriteRenderUseCacheCount=Math.round(uA.spriteRenderUseCacheCount/uj),uA.canvasNormal=Math.round(uA.canvasNormal/uj),uA.canvasBitmap=Math.round(uA.canvasBitmap/uj),uA.canvasReCache=Math.ceil(uA.canvasReCache/uj),uA.treeNodeCollision=Math.round(uA.treeNodeCollision/uj),uA.treeSpriteCollision=Math.round(uA.treeSpriteCollision/uj);var ut=0<uA.FPS?Math.floor(1e3/uA.FPS).toString():" ";uA._fpsStr=uA.FPS+(uA.renderSlow?" slow":"")+" "+ut,uA._spriteStr=uA.spriteCount+(uA.spriteRenderUseCacheCount?"/"+uA.spriteRenderUseCacheCount:""),uA._canvasStr=uA.canvasReCache+"/"+uA.canvasNormal+"/"+uA.canvasBitmap,uA.currentMemorySize=us.systemResourceManager.memorySize,uA._useCanvas?uA.renderInfoPre():uA.renderInfo(),uA.clear()}uA._count=0,uA._timer=uW}},uA.renderInfoPre=function(){if(uA._canvas){var uW=uA._ctx;uW.clearRect(uA._first?0:uA._vx,0,uA._width,uA._height);for(var uj=uy.WebGL.mainContext,ut=0;ut<uA._view.length;ut++){var ud=uA._view[ut];uA._first&&(uW.fillStyle="white",uW.fillText(ud.title,ud.x,ud.y,null,null,null)),uW.fillStyle=ud.color;var ub=-1;if((ud=uA._view[ut]).varying){if(uj)switch(ud.varying){case 1:ub=uj.getParameter(uj[ud.value]);break;case 2:ub=uj.getExtension(ud.value)}}else ub=uA[ud.value];"M"==ud.units&&(ub=Math.floor(ub/1048576*100)/100+" M"),"K"==ud.units&&(ub=Math.floor(ub/1024*100)/100+" K"),"string"==ud.units&&(ub=ub.match(/\d+\.?\d/i)),uW.fillText(ub+"",ud.x+uA._vx,ud.y,null,null,null)}}},uA.renderInfo=function(){for(var uW="",uj=uy.WebGL.mainContext,ut=0;ut<uA._view.length;ut++){var ud=uA._view[ut],ub=-1;if(ud.varying){if(uj)switch(ud.varying){case 1:ub=uj.getParameter(uj[ud.value]);break;case 2:ub=uj.getExtension(ud.value)}}else ub=uA[ud.value];"M"==ud.units&&(ub=Math.floor(ub/1048576*100)/100+" M"),"K"==ud.units&&(ub=Math.floor(ub/1024*100)/100+" K"),"string"==ud.units&&(ub=ub.match(/\d+\.?\d/i)),uW+=ub+"\n"}uA._txt.text=uW},uA.FPS=0,uA.loopCount=0,uA.shaderCall=0,uA.drawCall=0,uA.trianglesFaces=0,uA.spriteCount=0,uA.spriteRenderUseCacheCount=0,uA.treeNodeCollision=0,uA.treeSpriteCollision=0,uA.canvasNormal=0,uA.canvasBitmap=0,uA.canvasReCache=0,uA.renderSlow=!1,uA.currentMemorySize=0,uA._fpsStr=null,uA._canvasStr=null,uA._spriteStr=null,uA._fpsData=[],uA._timer=0,uA._count=0,uA._view=[],uA._fontSize=12,uA._txt=null,uA._leftText=null,uA._sp=null,uA._show=!1,uA._useCanvas=!1,uA._canvas=null,uA._ctx=null,uA._first=!1,uA._vx=NaN,uA._width=0,uA._height=100,uA}(),ui=(function(){function uW(){this._strsToID={},this._idToStrs=[],this._length=0}ue(uW,"laya.utils.StringKey");var uj=uW.prototype;uj.add=function(uW){var uj=this._strsToID[uW];return null!=uj?uj:(this._idToStrs[this._length]=uW,this._strsToID[uW]=this._length++)},uj.getID=function(uW){var uj=this._strsToID[uW];return null==uj?-1:uj},uj.getName=function(uW){var uj=this._idToStrs[uW];return null==uj?void 0:uj}}(),function(){var uc;function uW(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}ue(uW,"laya.utils.Timer");var uj=uW.prototype;return uj._init=function(){uN.timer&&uN.timer.frameLoop(1,this,this._update)},uj._now=function(){return Date.now()},uj._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var uW=this.currFrame=this.currFrame+this.scale,uj=this._now();this._delta=(uj-this._lastTimer)*this.scale;var ut=this.currTimer=this.currTimer+this._delta;uN.isDebug&&6e4<Math.abs(uj-this._lastTimer)&&console.error("系统时间错误！"+(uj-this._lastTimer)),this._lastTimer=uj;var ud=this._handlers;for(uO=this._count=0,uq=ud.length;uO<uq;uO++)if(null!==(uA=ud[uO]).method){var ub=uA.userFrame?uW:ut;if(ub>=uA.exeTime)if(uA.repeat)if(uA.jumpFrame)for(;ub>=uA.exeTime;)uA.exeTime+=uA.delay,uA.run(!1);else uA.exeTime+=uA.delay,uA.run(!1),ub>uA.exeTime&&(uA.exeTime+=Math.ceil((ub-uA.exeTime)/uA.delay)*uA.delay);else uA.run(!0)}else this._count++;(30<this._count||uW%200==0)&&this._clearHandlers();for(var uE=this._laters,uO=0,uq=uE.length-1;uO<=uq;uO++){var uA=uE[uO];this._isIgnoreRecover(uA)||(null!==uA.method&&(delete this._map[uA.key],uA.run(!1)),this._recoverHandler(uA)),uO===uq&&(uq=uE.length-1)}uE.length=0}},uj._clearHandlers=function(){for(var uW=this._handlers,uj=0,ut=uW.length;uj<ut;uj++){var ud=uW[uj];null!==ud.method?this._temp.push(ud):this._isIgnoreRecover(ud)?this._temp.push(ud):this._recoverHandler(ud)}this._handlers=this._temp,this._temp=uW,this._temp.length=0},uj._recoverHandler=function(uW){this._map[uW.key]==uW&&delete this._map[uW.key],uW.recover()},uj._create=function(uW,uj,ut,ud,ub,uE,uO,uq){if(!ut)return ub.apply(ud,uE),null;if(uO){var uA=this._getHandler(ud,ub);if(uA)return uA.repeat=uj,uA.userFrame=uW,uA.delay=ut,uA.ignoreRecover=uq,uA.caller=ud,uA.method=ub,uA.args=uE,uA.exeTime=ut+(uW?this.currFrame:this.currTimer+this._now()-this._lastTimer),uA}return(uA=uc.create()).repeat=uj,uA.userFrame=uW,uA.delay=ut,uA.ignoreRecover=uq,uA.caller=ud,uA.method=ub,uA.args=uE,uA.exeTime=ut+(uW?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(uA),this._handlers.push(uA),uA},uj._indexHandler=function(uW){var uj=uW.caller,ut=uW.method,ud=uj?uj.$_GID||(uj.$_GID=un.getGID()):0,ub=ut.$_TID||(ut.$_TID=this._mid++);uW.key=ud+"_"+ub,this._map[uW.key]=uW},uj.once=function(uW,uj,ut,ud,ub){void 0===ub&&(ub=!0),this._create(!1,!1,uW,uj,ut,ud,ub,!1)},uj.loop=function(uW,uj,ut,ud,ub,uE,uO){void 0===ub&&(ub=!0),void 0===uE&&(uE=!1),void 0===uO&&(uO=!1);var uq=this._create(!1,!0,uW,uj,ut,ud,ub,uO);uq&&(uq.jumpFrame=uE)},uj.frameOnce=function(uW,uj,ut,ud,ub){void 0===ub&&(ub=!0),this._create(!0,!1,uW,uj,ut,ud,ub,!1)},uj.frameLoop=function(uW,uj,ut,ud,ub,uE){void 0===ub&&(ub=!0),void 0===uE&&(uE=!1),this._create(!0,!0,uW,uj,ut,ud,ub,uE)},uj.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+uc._freeCount},uj.clear=function(uW,uj){var ut=this._getHandler(uW,uj);return!(!ut||this._isIgnoreRecover(ut))&&(delete this._map[ut.key],ut.key=null,ut.clear(),!0)},uj.clearAll=function(uW){if(uW)for(var uj=0,ut=this._handlers.length;uj<ut;uj++){var ud=this._handlers[uj];ud.caller===uW&&(this._isIgnoreRecover(ud)||(delete this._map[ud.key],ud.key=null,ud.clear()))}},uj._getHandler=function(uW,uj){var ut=uW?uW.$_GID||(uW.$_GID=un.getGID()):0,ud=uj.$_TID||(uj.$_TID=this._mid++);return this._map[ut+"_"+ud]},uj._isIgnoreRecover=function(uW){if(uW.ignoreRecover||uW.caller&&"IgnoreRecover"==uW.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var uj="";try{arguments.propertyIsEnumerable.caller}catch(uW){uj=uW.stack}uN.recordError("报错：核心定时器销毁忽略  "+uj)}return!0}return!1},uj.hasHandler=function(uW,uj){return this._map[uW.$_GID+"_"+uj.$_TID]},uj.callLater=function(uW,uj,ut){if(null==this._getHandler(uW,uj)){var ud=uc.create();ud.caller=uW,ud.method=uj,ud.args=ut,this._indexHandler(ud),this._laters.push(ud)}},uj.runCallLater=function(uW,uj){var ut=this._getHandler(uW,uj);ut&&null!=ut.method&&(this._isIgnoreRecover(ut)||(delete this._map[ut.key],ut.run(!0)))},uj.runTimer=function(uW,uj){this.runCallLater(uW,uj)},uR(0,uj,"delta",function(){return this._delta}),uW.__init$=function(){uc=function(){function uj(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}ue(uj,"");var uW=uj.prototype;return uW.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},uW.recover=function(){this.clear(),this.args=uj._freeHandler,uj._freeHandler=this,uj._freeCount++},uW.run=function(uW){var uj=this.caller;if(uj&&uj.destroyed)return this.clear();var ut=this.method,ud=this.args;uW&&this.clear(),null!=ut&&(ud?ut.apply(uj,ud):ut.call(uj))},uj._freeHandler=null,uj._freeCount=0,uj.create=function(){var uW=uj._freeHandler;return uW?(uj._freeHandler=uW.args,--uj._freeCount,uW.args=null,uW):new uj},uj}()},uW}()),uB=function(){function um(){this.gid=0}ue(um,"laya.utils.Tween");var uW=um.prototype;return uW.to=function(uW,uj,ut,ud,ub,uE,uO){return void 0===uE&&(uE=0),void 0===uO&&(uO=!1),this._create(uW,uj,ut,ud,ub,uE,uO,!0,!1,!0)},uW.from=function(uW,uj,ut,ud,ub,uE,uO){return void 0===uE&&(uE=0),void 0===uO&&(uO=!1),this._create(uW,uj,ut,ud,ub,uE,uO,!1,!1,!0)},uW._create=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){if(!uW)throw new Error("Tween:target is null");this._target=uW,this._duration=ut,this._ease=ud||uj.ease||um.easeNone,this._complete=ub||uj.complete,this._delay=uE,this._props=[],this._usedTimer=0,this._startTimer=uY.now(),this._usedPool=uA,this._delayParam=null,this.update=uj.update;var uR=uW.$_GID||(uW.$_GID=un.getGID());return um.tweenMap[uR]?(uO&&um.clearTween(uW),um.tweenMap[uR].push(this)):um.tweenMap[uR]=[this],uc?uE<=0?this.firstStart(uW,uj,uq):(this._delayParam=[uW,uj,uq],uN.scaleTimer.once(uE,this,this.firstStart,this._delayParam)):this._initProps(uW,uj,uq),this},uW.firstStart=function(uW,uj,ut){this._delayParam=null,uW.destroyed?this.clear():(this._initProps(uW,uj,ut),this._beginLoop())},uW._initProps=function(uW,uj,ut){for(var ud in uj)if("number"==typeof uW[ud]){var ub=ut?uW[ud]:uj[ud],uE=ut?uj[ud]:uW[ud];this._props.push([ud,ub,uE-ub]),ut||(uW[ud]=ub)}},uW._beginLoop=function(){uN.scaleTimer.frameLoop(1,this,this._doEase)},uW._doEase=function(){this._updateEase(uY.now())},uW._updateEase=function(uW){var uj=this._target;if(uj){if(uj.destroyed)return um.clearTween(uj);var ut=this._usedTimer=uW-this._startTimer-this._delay;if(!(ut<0)){if(ut>=this._duration)return this.complete();for(var ud=0<ut?this._ease(ut,0,1,this._duration):0,ub=this._props,uE=0,uO=ub.length;uE<uO;uE++){var uq=ub[uE];uj[uq[0]]=uq[1]+ud*uq[2]}this.update&&this.update.run()}}},uW.complete=function(){if(this._target){uN.scaleTimer.runTimer(this,this.firstStart);for(var uW=this._target,uj=this._props,ut=this._complete,ud=0,ub=uj.length;ud<ub;ud++){var uE=uj[ud];uW[uE[0]]=uE[1]+uE[2]}this.update&&this.update.run(),this.clear(),ut&&ut.run()}},uW.pause=function(){uN.scaleTimer.clear(this,this._beginLoop),uN.scaleTimer.clear(this,this._doEase),uN.scaleTimer.clear(this,this.firstStart);var uW;(uW=uY.now()-this._startTimer-this._delay)<0&&(this._usedTimer=uW)},uW.setStartTime=function(uW){this._startTimer=uW},uW.clear=function(){this._target&&(this._remove(),this._clear())},uW._clear=function(){this.pause(),uN.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,ur.recover("tween",this))},uW.recover=function(){this._usedPool=!0,this._clear()},uW._remove=function(){var uW=um.tweenMap[this._target.$_GID];if(uW)for(var uj=0,ut=uW.length;uj<ut;uj++)if(uW[uj]===this){uW.splice(uj,1);break}},uW.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=uY.now(),this._delayParam)uN.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var uW=this._props,uj=0,ut=uW.length;uj<ut;uj++){var ud=uW[uj];this._target[ud[0]]=ud[1]}uN.scaleTimer.once(this._delay,this,this._beginLoop)}},uW.resume=function(){this._usedTimer>=this._duration||(this._startTimer=uY.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?uN.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},uR(0,uW,"progress",null,function(uW){var uj=uW*this._duration;this._startTimer=uY.now()-this._delay-uj}),um.to=function(uW,uj,ut,ud,ub,uE,uO,uq){return void 0===uE&&(uE=0),void 0===uO&&(uO=!1),void 0===uq&&(uq=!0),ur.getItemByClass("tween",um)._create(uW,uj,ut,ud,ub,uE,uO,!0,uq,!0)},um.from=function(uW,uj,ut,ud,ub,uE,uO,uq){return void 0===uE&&(uE=0),void 0===uO&&(uO=!1),void 0===uq&&(uq=!0),ur.getItemByClass("tween",um)._create(uW,uj,ut,ud,ub,uE,uO,!1,uq,!0)},um.clearAll=function(uW){if(uW&&uW.$_GID){var uj=um.tweenMap[uW.$_GID];if(uj){for(var ut=0,ud=uj.length;ut<ud;ut++)uj[ut]._clear();uj.length=0}}},um.clear=function(uW){uW.clear()},um.clearTween=function(uW){um.clearAll(uW)},um.easeNone=function(uW,uj,ut,ud){return ut*uW/ud+uj},um.tweenMap={},um}(),un=function(){function uq(){}return ue(uq,"laya.utils.Utils"),uq.toRadian=function(uW){return uW*uq._pi2},uq.toAngle=function(uW){return uW*uq._pi},uq.toHexColor=function(uW){if(uW<0||isNaN(uW))return null;for(var uj=uW.toString(16);uj.length<6;)uj="0"+uj;return"#"+uj},uq.getGID=function(){return uq._gid++},uq.concatArray=function(uW,uj){if(!uj)return uW;if(!uW)return uj;var ut=0,ud=uj.length;for(ut=0;ut<ud;ut++)uW.push(uj[ut]);return uW},uq.clearArray=function(uW){return uW&&(uW.length=0),uW},uq.copyArray=function(uW,uj){if(uW||(uW=[]),!uj)return uW;uW.length=uj.length;var ut=0,ud=uj.length;for(ut=0;ut<ud;ut++)uW[ut]=uj[ut];return uW},uq.getGlobalRecByPoints=function(uW,uj,ut,ud,ub){var uE,uO;return uE=new uz(uj,ut),uE=uW.localToGlobal(uE),uO=new uz(ud,ub),uO=uW.localToGlobal(uO),uC._getWrapRec([uE.x,uE.y,uO.x,uO.y])},uq.getGlobalPosAndScale=function(uW){return uq.getGlobalRecByPoints(uW,0,0,1,1)},uq.bind=function(uW,uj){return uW.bind(uj)},uq.measureText=function(uW,uj){return uG.measureText(uW,uj)},uq.updateOrder=function(uW){if(!uW||uW.length<2)return!1;for(var uj,ut=1,ud=0,ub=uW.length,uE=NaN;ut<ub;){for(uj=uW[ud=ut],uE=uW[ud]._zOrder;-1<--ud&&uW[ud]._zOrder>uE;)uW[ud+1]=uW[ud];uW[ud+1]=uj,ut++}var uO=uj.parent.conchModel;if(uO)if(null!=uO.updateZOrder)uO.updateZOrder();else{for(ut=0;ut<ub;ut++)uO.removeChild(uW[ut].conchModel);for(ut=0;ut<ub;ut++)uO.addChildAt(uW[ut].conchModel,ut)}return!0},uq.transPointList=function(uW,uj,ut){var ud=0,ub=uW.length;for(ud=0;ud<ub;ud+=2)uW[ud]+=uj,uW[ud+1]+=ut},uq.parseInt=function(uW,uj){void 0===uj&&(uj=0);var ut=uY.window.parseInt(uW,uj);return isNaN(ut)?0:ut},uq.getFileExtension=function(uW){uq._extReg.lastIndex=uW.lastIndexOf(".");var uj=uq._extReg.exec(uW);return uj&&1<uj.length?uj[1].toLowerCase():null},uq.getTransformRelativeToWindow=function(uW,uj,ut){var ud=uN.stage,ub=laya.utils.Utils.getGlobalPosAndScale(uW),uE=ud._canvasTransform.clone(),uO=uE.tx,uq=uE.ty;uE.rotate(-Math.PI/180*uN.stage.canvasDegree),uE.scale(uN.stage.clientScaleX,uN.stage.clientScaleY);var uA=uN.stage.canvasDegree%180!=0,uc=NaN,uR=NaN;uA?(uc=ut+ub.y,uR=uj+ub.x,uc*=uE.d,uR*=uE.a,90==uN.stage.canvasDegree?(uc=uO-uc,uR+=uq):(uc+=uO,uR=uq-uR)):(uc=uj+ub.x,uR=ut+ub.y,uc*=uE.a,uR*=uE.d,uc+=uO,uR+=uq);var um=NaN,uQ=NaN;return uQ=uA?(um=uE.d*ub.height,uE.a*ub.width):(um=uE.a*ub.width,uE.d*ub.height),{x:uc,y:uR,scaleX:um,scaleY:uQ}},uq.fitDOMElementInArea=function(uW,uj,ut,ud,ub,uE){uW._fitLayaAirInitialized||(uW._fitLayaAirInitialized=!0,uW.style.transformOrigin=uW.style.webKittransformOrigin="left top",uW.style.position="absolute");var uO=uq.getTransformRelativeToWindow(uj,ut,ud);uW.style.transform=uW.style.webkitTransform="scale("+uO.scaleX+","+uO.scaleY+") rotate("+uN.stage.canvasDegree+"deg)",uW.style.width=ub+"px",uW.style.height=uE+"px",uW.style.left=uO.x+"px",uW.style.top=uO.y+"px"},uq.isOkTextureList=function(uW){if(!uW)return!1;var uj,ut=0,ud=uW.length;for(ut=0;ut<ud;ut++)if(!(uj=uW[ut])||!uj.source)return!1;return!0},uq.isOKCmdList=function(uW){if(!uW)return!1;var uj,ut,ud=0,ub=uW.length,uE=uy._context;for(ud=0;ud<ub;ud++)switch((uj=uW[ud]).callee){case uE._drawTexture:case uE._fillTexture:case uE._drawTextureWithTransform:if(!(ut=uj[0])||!ut.source)return!1}return!0},uq._gid=1,uq._pi=180/Math.PI,uq._pi2=Math.PI/180,uq._extReg=/\.(\w+)\??/g,uq.parseXMLFromString=function(uW){var uj;if(uW=uW.replace(/>\s+</g,"><"),-1<(uj=(new DOMParser).parseFromString(uW,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(uj.firstChild.firstChild.textContent);return uj},uq}(),uk=function(){function uW(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],uy.isWebGL&&uI.regCacheByFunction(un.bind(this.startDispose,this),un.bind(this.getCacheList,this))}ue(uW,"laya.utils.VectorGraphManager");var uj=uW.prototype;return uj.getId=function(){return this._id++},uj.addShape=function(uW,uj){this.shapeDic[uW]=uj,this.useDic[uW]||(this.useDic[uW]=!0)},uj.addLine=function(uW,uj){this.shapeLineDic[uW]=uj,this.shapeLineDic[uW]||(this.shapeLineDic[uW]=!0)},uj.getShape=function(uW){this._checkKey&&null!=this.useDic[uW]&&(this.useDic[uW]=!0)},uj.deleteShape=function(uW){this.shapeDic[uW]&&(this.shapeDic[uW]=null,delete this.shapeDic[uW]),this.shapeLineDic[uW]&&(this.shapeLineDic[uW]=null,delete this.shapeLineDic[uW]),null!=this.useDic[uW]&&delete this.useDic[uW]},uj.getCacheList=function(){var uW,uj=[];for(uW in this.shapeDic)uj.push(this.shapeDic[uW]);for(uW in this.shapeLineDic)uj.push(this.shapeLineDic[uW]);return uj},uj.startDispose=function(uW){var uj;for(uj in this.useDic)this.useDic[uj]=!1;this._checkKey=!0},uj.endDispose=function(){if(this._checkKey){var uW;for(uW in this.useDic)this.useDic[uW]||this.deleteShape(uW);this._checkKey=!1}},uW.getInstance=function(){return uW.instance=uW.instance||new uW},uW.instance=null,uW}(),up=function(){function ud(){this._obj=null,this._obj=ud.supportWeakMap?new uY.window.WeakMap:{},ud.supportWeakMap||ud._maps.push(this)}ue(ud,"laya.utils.WeakObject");var uW=ud.prototype;return uW.set=function(uW,uj){if(null!=uW)if(ud.supportWeakMap){var ut=uW;"string"!=typeof uW&&"number"!=typeof uW||(ut=ud._keys[uW])||(ut=ud._keys[uW]={k:uW}),this._obj.set(ut,uj)}else"string"==typeof uW||"number"==typeof uW?this._obj[uW]=uj:(uW.$_GID||(uW.$_GID=un.getGID()),this._obj[uW.$_GID]=uj)},uW.get=function(uW){if(null==uW)return null;if(ud.supportWeakMap){var uj="string"==typeof uW||"number"==typeof uW?ud._keys[uW]:uW;return uj?this._obj.get(uj):null}return"string"==typeof uW||"number"==typeof uW?this._obj[uW]:this._obj[uW.$_GID]},uW.del=function(uW){if(null!=uW)if(ud.supportWeakMap){var uj="string"==typeof uW||"number"==typeof uW?ud._keys[uW]:uW;if(!uj)return;this._obj.delete(uj)}else"string"==typeof uW||"number"==typeof uW?delete this._obj[uW]:delete this._obj[this._obj.$_GID]},uW.has=function(uW){if(null==uW)return!1;if(ud.supportWeakMap){var uj="string"==typeof uW||"number"==typeof uW?ud._keys[uW]:uW;return this._obj.has(uj)}return"string"==typeof uW||"number"==typeof uW?null!=this._obj[uW]:null!=this._obj[this._obj.$_GID]},ud.__init__=function(){(ud.supportWeakMap=null!=uY.window.WeakMap)||uN.timer.loop(ud.delInterval,null,ud.clearCache)},ud.clearCache=function(){for(var uW=0,uj=ud._maps.length;uW<uj;uW++){ud._maps[uW]._obj={}}},ud.supportWeakMap=!1,ud.delInterval=3e5,ud._keys={},ud._maps=[],uA(ud,["I",function(){return this.I=new ud}]),ud}(),uF=function(){function uW(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}ue(uW,"laya.utils.WordText");var uj=uW.prototype;return uj.setText=function(uW){this.changed=!0,this._text=uW},uj.toString=function(){return this._text},uj.charCodeAt=function(uW){return this._text?this._text.charCodeAt(uW):NaN},uj.charAt=function(uW){return this._text?this._text.charAt(uW):null},uR(0,uj,"length",function(){return this._text?this._text.length:0}),uW}(),uWW=function(uW){function uO(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,uO.__super.call(this),this._childs=uO.ARRAY_EMPTY,this._$P=uO.PROP_EMPTY,this.timer=uN.scaleTimer,this.conchModel=uy.isConchNode?this.createConchModel():null}ue(uO,"laya.display.Node",uc);var uj=uO.prototype;return uj._setBit=function(uW,uj){1==uW&&(this._getBit(uW)!=uj&&this._updateDisplayedInstage());uj?this._bits|=uW:this._bits&=~uW},uj._getBit=function(uW){return 0!=(this._bits&uW)},uj._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},uj._setUpNoticeType=function(uW){var uj=this;for(uj._setBit(uW,!0),uj=uj.parent;uj;){if(uj._getBit(uW))return;uj._setBit(uW,!0),uj=uj.parent}},uj.on=function(uW,uj,ut,ud){return"display"!==uW&&"undisplay"!==uW||this._getBit(1)||this._setUpNoticeType(1),this._createListener(uW,uj,ut,ud,!1)},uj.once=function(uW,uj,ut,ud){return"display"!==uW&&"undisplay"!==uW||this._getBit(1)||this._setUpNoticeType(1),this._createListener(uW,uj,ut,ud,!0)},uj.createConchModel=function(){return null},uj.destroy=function(uW){void 0===uW&&(uW=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(uW?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},uj.destroyChildren=function(){if(this._childs)for(var uW=this._childs.length-1;-1<uW;uW--)this._childs[uW].destroy(!0)},uj.addChild=function(uW){if(!uW||this.destroyed||uW===this)return uW;if(uW.zOrder&&this._set$P("hasZorder",!0),uW._parent===this){var uj=this.getChildIndex(uW);uj!==this._childs.length-1&&(this._childs.splice(uj,1),this._childs.push(uW),this.conchModel&&(this.conchModel.removeChild(uW.conchModel),this.conchModel.addChildAt(uW.conchModel,this._childs.length-1)),this._childChanged())}else uW.parent&&uW.parent.removeChild(uW),this._childs===uO.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(uW),this.conchModel&&this.conchModel.addChildAt(uW.conchModel,this._childs.length-1),(uW.parent=this)._childChanged();return uW},uj.addChildren=function(uW){for(var uj=arguments,ut=0,ud=uj.length;ut<ud;)this.addChild(uj[ut++])},uj.addChildAt=function(uW,uj){if(!uW||this.destroyed||uW===this)return uW;if(uW.zOrder&&this._set$P("hasZorder",!0),0<=uj&&uj<=this._childs.length){if(uW._parent===this){var ut=this.getChildIndex(uW);this._childs.splice(ut,1),this._childs.splice(uj,0,uW),this.conchModel&&(this.conchModel.removeChild(uW.conchModel),this.conchModel.addChildAt(uW.conchModel,uj)),this._childChanged()}else uW.parent&&uW.parent.removeChild(uW),this._childs===uO.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(uj,0,uW),this.conchModel&&this.conchModel.addChildAt(uW.conchModel,uj),uW.parent=this;return uW}throw new Error("appendChildAt:The index is out of bounds")},uj.getChildIndex=function(uW){return this._childs.indexOf(uW)},uj.getChildByName=function(uW){var uj=this._childs;if(uj)for(var ut=0,ud=uj.length;ut<ud;ut++){var ub=uj[ut];if(ub.name===uW)return ub}return null},uj._get$P=function(uW){return this._$P[uW]},uj._set$P=function(uW,uj){return this.destroyed||(this._$P===uO.PROP_EMPTY&&(this._$P={}),this._$P[uW]=uj),uj},uj.getChildAt=function(uW){return this._childs[uW]},uj.setChildIndex=function(uW,uj){var ut=this._childs;if(uj<0||uj>=ut.length)throw new Error("setChildIndex:The index is out of bounds.");var ud=this.getChildIndex(uW);if(ud<0)throw new Error("setChildIndex:node is must child of this object.");return ut.splice(ud,1),ut.splice(uj,0,uW),this.conchModel&&(this.conchModel.removeChild(uW.conchModel),this.conchModel.addChildAt(uW.conchModel,uj)),this._childChanged(),uW},uj._childChanged=function(uW){},uj.removeChild=function(uW){if(!this._childs)return uW;var uj=this._childs.indexOf(uW);return this.removeChildAt(uj)},uj.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},uj.removeChildByName=function(uW){var uj=this.getChildByName(uW);return uj&&this.removeChild(uj),uj},uj.removeChildAt=function(uW){var uj=this.getChildAt(uW);if(uj){for(var ut=this._childs.length-1,ud=uW;ud<ut;++ud)this._childs[ud]=this._childs[ud+1];this._childs.length=ut,this.conchModel&&this.conchModel.removeChild(uj.conchModel),uj.parent=null}return uj},uj.removeChildren=function(uW,uj){if(void 0===uW&&(uW=0),void 0===uj&&(uj=2147483647),this._childs&&0<this._childs.length){var ut=this._childs;if(0===uW&&uE<=uj){var ud=ut;this._childs=uO.ARRAY_EMPTY}else ud=ut.splice(uW,uj-uW);for(var ub=0,uE=ud.length;ub<uE;ub++)ud[ub].parent=null,this.conchModel&&this.conchModel.removeChild(ud[ub].conchModel)}return this},uj.replaceChild=function(uW,uj){var ut=this._childs.indexOf(uj);return-1<ut?(this._childs.splice(ut,1,uW),this.conchModel&&(this.conchModel.removeChild(uj.conchModel),this.conchModel.addChildAt(uW.conchModel,ut)),uj.parent=null,uW.parent=this,uW):null},uj._updateDisplayedInstage=function(){var uW;uW=this;var uj=uN.stage;for(this._displayedInStage=!1;uW;){if(uW._getBit(1)){this._displayedInStage=uW._displayedInStage;break}if(uW==uj||uW._displayedInStage){this._displayedInStage=!0;break}uW=uW.parent}},uj._setDisplay=function(uW){this._displayedInStage!==uW&&((this._displayedInStage=uW)?this.event("display"):this.event("undisplay"))},uj._displayChild=function(uW,uj){var ut=uW._childs;if(ut)for(var ud=0;ud<ut.length;ud++){var ub=ut[ud];ub&&ub._getBit(1)&&(0<ub._childs.length?this._displayChild(ub,uj):ub._setDisplay(uj))}uW._setDisplay(uj)},uj.contains=function(uW){if(uW===this)return!0;for(;uW;){if(uW.parent===this)return!0;uW=uW.parent}return!1},uj.timerLoop=function(uW,uj,ut,ud,ub,uE){void 0===ub&&(ub=!0),void 0===uE&&(uE=!1),this.timer.loop(uW,uj,ut,ud,ub,uE)},uj.timerOnce=function(uW,uj,ut,ud,ub){void 0===ub&&(ub=!0),this.timer._create(!1,!1,uW,uj,ut,ud,ub)},uj.frameLoop=function(uW,uj,ut,ud,ub){void 0===ub&&(ub=!0),this.timer._create(!0,!0,uW,uj,ut,ud,ub)},uj.frameOnce=function(uW,uj,ut,ud,ub){void 0===ub&&(ub=!0),this.timer._create(!0,!1,uW,uj,ut,ud,ub)},uj.clearTimer=function(uW,uj){this.timer.clear(uW,uj)},uR(0,uj,"numChildren",function(){return this._childs.length}),uR(0,uj,"destroyed",function(){return this._destroyed}),uR(0,uj,"parent",function(){return this._parent},function(uW){this._parent!==uW&&(uW?(this._parent=uW,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),uW.displayedInStage&&this._displayChild(this,!0)),uW._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=uW))}),uR(0,uj,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),uO.ARRAY_EMPTY=[],uO.PROP_EMPTY={},uO.NOTICE_DISPLAY=1,uO.MOUSEENABLE=2,uO}(),ujW=function(uW){function uQ(uW){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,uQ.__super.call(this),this._padding=uQ._PADDING,this._spacing=uQ._SPACING,this._aligns=uQ._ALIGNS,this._font=uT.EMPTY,this._ower=uW}ue(uQ,"laya.display.css.CSSStyle",uW);var uj=uQ.prototype;return uj.destroy=function(){this._ower=null,this._font=null,this._rect=null},uj.inherit=function(uW){this._font=uW._font,this._spacing=uW._spacing===uQ._SPACING?uQ._SPACING:uW._spacing.slice(),this.lineHeight=uW.lineHeight},uj._widthAuto=function(){return 0!=(262144&this._type)},uj.widthed=function(uW){return 0!=(8&this._type)},uj._calculation=function(uW,uj){if(uj.indexOf("%")<0)return!1;var ud=this._ower,ub=ud.parent,uE=this._rect;function uO(uW,uj,ut){return uW*ut[0]+uj*ut[1]+ut[2]}function ut(uW){var uj=ub.width,ut=ud.width;uE.width&&(ud.width=uO(uj,ut,uE.width)),uE.height&&(ud.height=uO(uj,ut,uE.height)),uE.left&&(ud.x=uO(uj,ut,uE.left)),uE.top&&(ud.y=uO(uj,ut,uE.top))}null===uE&&(ub._getCSSStyle()._type|=524288,ub.on("resize",this,ut),this._rect=uE={input:{}});var uq=uj.split(" ");return uq[0]=parseFloat(uq[0])/100,1==uq.length?uq[1]=uq[2]=0:(uq[1]=parseFloat(uq[1])/100,uq[2]=parseFloat(uq[2])),uE[uW]=uq,uE.input[uW]=uj,ut(),!0},uj.heighted=function(uW){return 0!=(8192&this._type)},uj.size=function(uW,uj){var ut=this._ower,ud=!1;-1!==uW&&uW!=this._ower.width&&(this._type|=8,this._ower.width=uW,ud=!0),-1!==uj&&uj!=this._ower.height&&(this._type|=8192,this._ower.height=uj,ud=!0),ud&&(ut._layoutLater(),524288&this._type&&ut.event("resize",this))},uj._getAlign=function(){return this._aligns[0]},uj._getValign=function(){return this._aligns[1]},uj._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},uj._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new uT(this._font))},uj.render=function(uW,uj,ut,ud){var ub=uW.width,uE=uW.height;ut-=uW.pivotX,ud-=uW.pivotY,this._bgground&&null!=this._bgground.color&&uj.ctx.fillRect(ut,ud,ub,uE,this._bgground.color),this._border&&this._border.color&&uj.drawRect(ut,ud,ub,uE,this._border.color.strColor,this._border.size)},uj.getCSSStyle=function(){return this},uj.cssText=function(uW){this.attrs(uQ.parseOneCSS(uW,";"))},uj.attrs=function(uW){if(uW)for(var uj=0,ut=uW.length;uj<ut;uj++){var ud=uW[uj];this[ud[0]]=ud[1]}},uj.setTransform=function(uW){"none"===uW?this._tf=uq._TF_EMPTY:this.attrs(uQ.parseOneCSS(uW,","))},uj.translate=function(uW,uj){this._tf===uq._TF_EMPTY&&(this._tf=new ub),this._tf.translateX=uW,this._tf.translateY=uj},uj.scale=function(uW,uj){this._tf===uq._TF_EMPTY&&(this._tf=new ub),this._tf.scaleX=uW,this._tf.scaleY=uj},uj._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},uR(0,uj,"block",uW.prototype._$get_block,function(uW){uW?this._type|=1:this._type&=-2}),uR(0,uj,"valign",function(){return uQ._valigndef[this._aligns[1]]},function(uW){this._aligns===uQ._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=uQ._valigndef[uW]}),uR(0,uj,"height",null,function(uW){if(this._type|=8192,"string"==typeof uW){if(this._calculation("height",uW))return;uW=parseInt(uW)}this.size(-1,uW)}),uR(0,uj,"width",null,function(uW){if(this._type|=8,"string"==typeof uW){var uj=uW.indexOf("auto");if(0<=uj&&(this._type|=262144,uW=uW.substr(0,uj)),this._calculation("width",uW))return;uW=parseInt(uW)}this.size(uW,-1)}),uR(0,uj,"fontWeight",function(){return this._font.weight},function(uW){this._createFont().weight=uW}),uR(0,uj,"left",null,function(uW){var uj=this._ower;if("string"==typeof uW){if("center"===uW?uW="50% -50% 0":"right"===uW&&(uW="100% -100% 0"),this._calculation("left",uW))return;uW=parseInt(uW)}uj.x=uW}),uR(0,uj,"_translate",null,function(uW){this.translate(uW[0],uW[1])}),uR(0,uj,"absolute",function(){return 0!=(4&this._type)}),uR(0,uj,"top",null,function(uW){var uj=this._ower;if("string"==typeof uW){if("middle"===uW?uW="50% -50% 0":"bottom"===uW&&(uW="100% -100% 0"),this._calculation("top",uW))return;uW=parseInt(uW)}uj.y=uW}),uR(0,uj,"align",function(){return uQ._aligndef[this._aligns[0]]},function(uW){this._aligns===uQ._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=uQ._aligndef[uW]}),uR(0,uj,"bold",function(){return this._font.bold},function(uW){this._createFont().bold=uW}),uR(0,uj,"padding",function(){return this._padding},function(uW){this._padding=uW}),uR(0,uj,"leading",function(){return this._spacing[1]},function(uW){"string"==typeof uW&&(uW=parseInt(uW+"")),this._spacing===uQ._SPACING&&(this._spacing=[0,0]),this._spacing[1]=uW}),uR(0,uj,"lineElement",function(){return 0!=(65536&this._type)},function(uW){uW?this._type|=65536:this._type&=-65537}),uR(0,uj,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(uW){this.lineElement=!1,"right"===uW?this._type|=32768:this._type&=-32769}),uR(0,uj,"textDecoration",function(){return this._font.decoration},function(uW){this._createFont().decoration=uW}),uR(0,uj,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(uW){"nowrap"===uW&&(this._type|=131072),"none"===uW&&(this._type&=-131073)}),uR(0,uj,"background",null,function(uW){uW?(this._bgground||(this._bgground={}),this._bgground.color=uW,this._ower.conchModel&&this._ower.conchModel.bgColor(uW),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),uR(0,uj,"wordWrap",function(){return 0==(131072&this._type)},function(uW){uW?this._type&=-131073:this._type|=131072}),uR(0,uj,"color",function(){return this._font.color},function(uW){this._createFont().color=uW}),uR(0,uj,"password",function(){return this._font.password},function(uW){this._createFont().password=uW}),uR(0,uj,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(uW){"none"===uW?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=uW),this._ower.conchModel&&this._ower.conchModel.bgColor(uW),this._ower._renderType|=256}),uR(0,uj,"font",function(){return this._font.toString()},function(uW){this._createFont().set(uW)}),uR(0,uj,"weight",null,function(uW){this._createFont().weight=uW}),uR(0,uj,"letterSpacing",function(){return this._spacing[0]},function(uW){"string"==typeof uW&&(uW=parseInt(uW+"")),this._spacing===uQ._SPACING&&(this._spacing=[0,0]),this._spacing[0]=uW}),uR(0,uj,"fontSize",function(){return this._font.size},function(uW){this._createFont().size=uW}),uR(0,uj,"italic",function(){return this._font.italic},function(uW){this._createFont().italic=uW}),uR(0,uj,"fontFamily",function(){return this._font.family},function(uW){this._createFont().family=uW}),uR(0,uj,"stroke",function(){return this._font.stroke[0]},function(uW){this._createFont().stroke===uT._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=uW}),uR(0,uj,"strokeColor",function(){return this._font.stroke[1]},function(uW){this._createFont().stroke===uT._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=uW}),uR(0,uj,"border",function(){return this._border?this._border.value:""},function(uW){if("none"!=uW){this._border||(this._border={});var uj=(this._border.value=uW).split(" ");if(this._border.color=uf.create(uj[uj.length-1]),1==uj.length)return this._border.size=1,void(this._border.type="solid");var ut=0;0<uj[0].indexOf("px")?(this._border.size=parseInt(uj[0]),ut++):this._border.size=1,this._border.type=uj[ut],this._ower._renderType|=256}else this._border=null}),uR(0,uj,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(uW){uW?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==uW?null:uf.create(uW),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),uR(0,uj,"position",function(){return 4&this._type?"absolute":""},function(uW){"absolute"==uW?this._type|=4:this._type&=-5}),uR(0,uj,"display",null,function(uW){switch(uW){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),uR(0,uj,"paddingLeft",function(){return this.padding[3]}),uR(0,uj,"paddingTop",function(){return this.padding[0]}),uR(0,uj,"_scale",null,function(uW){this._ower.scale(uW[0],uW[1])}),uR(0,uj,"_rotate",null,function(uW){this._ower.rotation=uW}),uQ.parseOneCSS=function(uW,uj){for(var ut,ud=[],ub=uW.split(uj),uE=0,uO=ub.length;uE<uO;uE++){var uq=ub[uE],uA=uq.indexOf(":"),uc=uq.substr(0,uA).replace(/^\s+|\s+$/g,"");if(0!=uc.length){var uR=uq.substr(uA+1).replace(/^\s+|\s+$/g,""),um=[uc,uR];switch(uc){case"italic":case"bold":um[1]="true"==uR;break;case"line-height":um[0]="lineHeight",um[1]=parseInt(uR);break;case"font-size":um[0]="fontSize",um[1]=parseInt(uR);break;case"padding":1<(ut=uR.split(" ")).length||(ut[1]=ut[2]=ut[3]=ut[0]),um[1]=[parseInt(ut[0]),parseInt(ut[1]),parseInt(ut[2]),parseInt(ut[3])];break;case"rotate":um[0]="_rotate",um[1]=parseFloat(uR);break;case"scale":ut=uR.split(" "),um[0]="_scale",um[1]=[parseFloat(ut[0]),parseFloat(ut[1])];break;case"translate":ut=uR.split(" "),um[0]="_translate",um[1]=[parseInt(ut[0]),parseInt(ut[1])];break;default:(um[0]=uQ._CSSTOVALUE[uc])||(um[0]=uc)}ud.push(um)}}return ud},uQ.parseCSS=function(uW,uj){for(var ut;null!=(ut=uQ._parseCSSRegExp.exec(uW));)uQ.styleSheets[ut[1]]=uQ.parseOneCSS(ut[2],";")},uQ.EMPTY=new uQ(null),uQ._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},uQ._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),uQ._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},uQ._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},uQ.styleSheets={},uQ.ALIGN_CENTER=1,uQ.ALIGN_RIGHT=2,uQ.VALIGN_MIDDLE=1,uQ.VALIGN_BOTTOM=2,uQ._CSS_BLOCK=1,uQ._DISPLAY_NONE=2,uQ._ABSOLUTE=4,uQ._WIDTH_SET=8,uQ._PADDING=[0,0,0,0],uQ._RECT=[-1,-1,-1,-1],uQ._SPACING=[0,0],uQ._ALIGNS=[0,0,0],uQ.ADDLAYOUTED=512,uQ._NEWFONT=4096,uQ._HEIGHT_SET=8192,uQ._BACKGROUND_SET=16384,uQ._FLOAT_RIGHT=32768,uQ._LINE_ELEMENT=65536,uQ._NOWARP=131072,uQ._WIDTHAUTO=262144,uQ._LISTERRESZIE=524288,uQ}(uq),utW=function(uW){function uO(){this.url=null,this.audio=null,this.loaded=!1,uO.__super.call(this)}ue(uO,"laya.media.h5audio.AudioSound",uc);var uj=uO.prototype;return uj.dispose=function(){var uW=uO._audioCache[this.url];uW&&(uW.src="",delete uO._audioCache[this.url])},uj.load=function(uW){var uj;if(uW=uv.formatURL(uW),(this.url=uW)==ux._tMusic?(uO._initMusicAudio(),(uj=uO._musicAudio).src!=uW&&(uO._audioCache[uj.src]=null,uj=null)):uj=uO._audioCache[uW],uj&&2<=uj.readyState)this.event("complete");else{uj||(uj=uW==ux._tMusic?(uO._initMusicAudio(),uO._musicAudio):uY.createElement("audio"),(uO._audioCache[uW]=uj).src=uW),uj.addEventListener("canplaythrough",ud),uj.addEventListener("error",ub);var ut=this;(this.audio=uj).load?uj.load():ub()}function ud(){uE(),ut.loaded=!0,ut.event("complete")}function ub(){uj.load=null,uE(),ut.event("error")}function uE(){uj.removeEventListener("canplaythrough",ud),uj.removeEventListener("error",ub)}},uj.play=function(uW,uj,ut){if(void 0===uW&&(uW=0),void 0===uj&&(uj=0),!this.url)return null;var ud,ub;if(!(ud=this.url==ux._tMusic?uO._musicAudio:uO._audioCache[this.url]))return null;ub=ur.getItem("audio:"+this.url),uy.isConchApp?ub||((ub=uY.createElement("audio")).src=this.url):this.url==ux._tMusic?(uO._initMusicAudio(),(ub=uO._musicAudio).src=this.url):ub=ub||ud.cloneNode(!0);var uE=new uQW(ub);return uE.url=this.url,uE.loops=uj,uE.startTime=uW,uE.startHandler=ut,uE.play(!1),ux.addChannel(uE),uE},uR(0,uj,"duration",function(){var uW;return(uW=uO._audioCache[this.url])?uW.duration:0}),uO._initMusicAudio=function(){uO._musicAudio||(uO._musicAudio||(uO._musicAudio=uY.createElement("audio")),uy.isConchApp||uY.document.addEventListener("mousedown",uO._makeMusicOK))},uO._makeMusicOK=function(){uY.document.removeEventListener("mousedown",uO._makeMusicOK),uO._musicAudio.src?uO._musicAudio.play():(uO._musicAudio.src="",uO._musicAudio.load())},uO._audioCache={},uO._musicAudio=null,uO}(),udW=function(uW){function uj(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,uj.__super.call(this)}ue(uj,"laya.media.SoundChannel",uc);var ut=uj.prototype;return ut.play=function(){},ut.stop=function(){},ut.pause=function(){},ut.resume=function(){},ut.__runComplete=function(uW){uW&&uW.run()},uR(0,ut,"volume",function(){return 1},function(uW){}),uR(0,ut,"position",function(){return 0}),uR(0,ut,"duration",function(){return 0}),uj}(),ubW=function(uW){function uj(){uj.__super.call(this)}ue(uj,"laya.media.Sound",uc);var ut=uj.prototype;return ut.load=function(uW){},ut.play=function(uW,uj,ut){return void 0===uW&&(uW=0),void 0===uj&&(uj=0),null},ut.dispose=function(){},uR(0,ut,"duration",function(){return 0}),uj}(),uEW=function(uW){function ub(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,ub.__super.call(this)}ue(ub,"laya.media.webaudio.WebAudioSound",uc);var uj=ub.prototype;return uj.load=function(uW){this.url=uW,this.audioBuffer=ub._dataCache[uW],this.audioBuffer?this._loaded(this.audioBuffer):(ub.e.on("loaded:"+uW,this,this._loaded),ub.e.on("err:"+uW,this,this._err),ub.__loadingSound[uW]||(ub.__loadingSound[uW]=!0,uN.loader.load(uW,uS.create(this,this.onloaded),null,uqW.BUFFER,4,!1,null,!0)))},uj.onloaded=function(uW){uW||this._err(),this._disposed?this._removeLoadEvents():(this.data=uW,ub.buffs.push({buffer:this.data,url:this.url}),ub.decode())},uj._err=function(){if(this._removeLoadEvents(),ub.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var uW,uj,ut,ud=0;for(uW=(uj=this.__toPlays).length,ud=0;ud<uW;ud++)(ut=uj[ud])[3]&&!ut[3].isStopped&&ut[3].event("error");this.__toPlays.length=0}},uj._loaded=function(uW){this._removeLoadEvents(),this._disposed||(this.audioBuffer=uW,this.loaded=!0,this.event("complete"))},uj._removeLoadEvents=function(){ub.e.off("loaded:"+this.url,this,this._loaded),ub.e.off("err:"+this.url,this,this._err)},uj.__playAfterLoaded=function(){if(this.__toPlays){var uW,uj,ut,ud=0;for(uW=(uj=this.__toPlays).length,ud=0;ud<uW;ud++)(ut=uj[ud])[3]&&!ut[3].isStopped&&this.play(ut[0],ut[1],ut[2],ut[3]);this.__toPlays.length=0}},uj.play=function(uW,uj,ut,ud){return void 0===uW&&(uW=0),void 0===uj&&(uj=0),ud=ud||new uTW,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([uW,uj,ut,ud]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),ud.url=this.url,ud.loops=uj,ud.audioBuffer=this.audioBuffer,ud.startTime=uW,ud.startHandler=ut,ud.play(!1),ux.addChannel(ud),ud},uj.dispose=function(){this._disposed=!0,delete ub._dataCache[this.url],delete ub.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},uR(0,uj,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),ub.decode=function(){if(!(ub.buffs.length<=0||ub.isDecoding))if(ub.isDecoding=!0,(ub.tInfo=ub.buffs.shift())&&ub.tInfo.buffer&&ub.tInfo.buffer.byteLength)try{ub.ctx.decodeAudioData(ub.tInfo.buffer,ub._done,ub._fail)}catch(uW){console.error("decodeAudioData error  byteLength:"+ub.tInfo.buffer.byteLength+"  url:"+ub.tInfo.url)}else ub._fail()},ub._done=function(uW){ub.e.event("loaded:"+ub.tInfo.url,uW),ub._dataCache[ub.tInfo.url]=uW,ub.isDecoding=!1,ub.decode()},ub._fail=function(){ub.e.event("err:"+ub.tInfo.url,null),ub.isDecoding=!1,ub.decode()},ub._playEmptySound=function(){if(null!=ub.ctx){if(ub._emptySource&&(ub._emptySource.stop(),ub._emptySource.disconnect(0),!uTW._tryCleanFailed))try{ub._emptySource.buffer=null}catch(uW){uTW._tryCleanFailed=!0}var uW=ub.ctx.createBufferSource();uW.buffer=ub._miniBuffer,uW.connect(ub.ctx.destination),uW.start(0,0,0),ub._emptySource=uW}},ub._unlock=function(){ub._unlocked||(ub._playEmptySound(),"running"==ub.ctx.state?(uY.document.removeEventListener("mousedown",ub._unlock,!0),uY.document.removeEventListener("touchend",ub._unlock,!0),uY.document.removeEventListener("touchstart",ub._unlock,!0),ub._unlocked=!0):"suspended"==ub.ctx.state&&ux._recoverWebAudio())},ub.initWebAudio=function(){"running"!=ub.ctx.state&&(ub._unlock(),uY.document.addEventListener("mousedown",ub._unlock,!0),uY.document.addEventListener("touchend",ub._unlock,!0),uY.document.addEventListener("touchstart",ub._unlock,!0))},ub._emptySource=null,ub._dataCache={},ub.buffs=[],ub.isDecoding=!1,ub._unlocked=!1,ub.tInfo=null,ub.__loadingSound={},uA(ub,["window",function(){return this.window=uY.window},"webAudioEnabled",function(){return this.webAudioEnabled=ub.window.AudioContext||ub.window.webkitAudioContext||ub.window.mozAudioContext},"ctx",function(){return this.ctx=ub.webAudioEnabled?new(ub.window.AudioContext||ub.window.webkitAudioContext||ub.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=ub.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new uc}]),ub}(),uOW=function(uW){function uj(){this._responseType=null,this._data=null,uj.__super.call(this),this._http=new uY.window.XMLHttpRequest}ue(uj,"laya.net.HttpRequest",uc);var ut=uj.prototype;return ut.send=function(uW,uj,ut,ud,ub){void 0===ut&&(ut="get"),void 0===ud&&(ud="text"),this._responseType=ud,this._data=null;var uE=this,uO=this._http;if(uO.open(ut,uW,!0),ub)for(var uq=0;uq<ub.length;uq++)uO.setRequestHeader(ub[uq++],ub[uq]);else uy.isConchApp||(uj&&"string"!=typeof uj?uO.setRequestHeader("Content-Type","application/json"):uO.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));uO.responseType="arraybuffer"!==ud?"text":"arraybuffer",uO.onerror=function(uW){uE._onError(uW)},uO.onabort=function(uW){uE._onAbort(uW)},uO.onprogress=function(uW){uE._onProgress(uW)},uO.onload=function(uW){uE._onLoad(uW)},uO.send(uj)},ut._onProgress=function(uW){uW&&uW.lengthComputable&&this.event("progress",uW.loaded/uW.total)},ut._onAbort=function(uW){this.error("Request was aborted by user")},ut._onError=function(uW){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},ut._onLoad=function(uW){var uj=this._http,ut=void 0!==uj.status?uj.status:200;200===ut||204===ut||0===ut?this.complete():this.error("["+uj.status+"]"+uj.statusText+":"+uj.responseURL)},ut.error=function(uW){this.clear(),this.event("error",uW)},ut.complete=function(){this.clear();var uj=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=un.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(uW){uj=!1,this.error(uW.message)}uj&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},ut.clear=function(){var uW=this._http;uW.onerror=uW.onabort=uW.onprogress=uW.onload=null},uR(0,ut,"url",function(){return this._http.responseURL}),uR(0,ut,"http",function(){return this._http}),uR(0,ut,"data",function(){return this._data}),uj}(),uqW=function(uW){function uL(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,uL.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}ue(uL,"laya.net.Loader",uc);var uj=uL.prototype;return uj.load=function(uW,uj,ut,ud,ub){if(uW&&""!=uW||console.error("Loader 加载的url不合法 "+uW),void 0===ut&&(ut=!0),void 0===ub&&(ub=!1),0===(this._url=uW).indexOf("data:image")?this._type=uj="image":this._type=uj||(uj=this.getTypeFromUrl(uW)),this._cache=ut,this._data=null,!ub&&uL.loadedMap[uW])return this._data=uL.loadedMap[uW],this.event("progress",1),void this.event("complete",this._data);if(ud&&uL.setGroup(uW,ud),null!=uL.parserMap[uj])return this._customParse=!0,void(uL.parserMap[uj]instanceof laya.utils.Handler?uL.parserMap[uj].runWith(this):uL.parserMap[uj].call(null,this));if("image"===uj||"htmlimage"===uj||"nativeimage"===uj)return this._loadImage(uW);if("ttf"===uj)return this._loadTTF(uW);switch(uj){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:uj}uL.preLoadedMap[uW]?this.onLoaded(uL.preLoadedMap[uW]):uO.resMgrLoad(uW,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},uj.getTypeFromUrl=function(uW){var uj=un.getFileExtension(uW);return uj?uL.typeMap[uj]:(console.warn("Not recognize the resources suffix",uW),"text")},uj._loadTTF=function(uW){uW=uv.formatURL(uW);var uj=new uh;uj.complete=uS.create(this,this.onLoaded),uj.load(uW)},uj._loadImage=function(uW){uO.imgMgrLoad(uW,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},uj._loadImageComplete=function(uW,uj,ut){if(null!=ut)if(ut instanceof ArrayBuffer){var ud=new DataView(ut),ub=new laya.webgl.resource.WebGLImage(new Uint8Array(ut,8),uW,0,!1,ud.getUint32(0),ud.getUint32(4));this.onLoaded(ub)}else if(ut instanceof uRW)uL.imgMgrSet[uW]=uj,uO.imgMgrLock(uW,uL.imgMgrSet[uW]),this._url=uW,this.complete(ut);else{var uE=-1!=uW.indexOf(".png",uW.length-4)?6408:6407;ub=new laya.webgl.resource.WebGLImage(ut,uW,uE,!1,ut.width,ut.height);this.onLoaded(ub)}else this.event("error","Load image failed")},uj._loadSound=function(uW){var uj=new ux._soundClass,ut=this;function ud(){uj.offAll()}uj.on("complete",this,function(){ud(),ut.onLoaded(uj)}),uj.on("error",this,function(){ud(),uj.dispose(),ut.event("error","Load sound failed")}),uj.load(uW)},uj.onProgress=function(uW){"atlas"===this._type?this.event("progress",.3*uW):this.event("progress",uW)},uj.onError=function(uW){this.event("error",uW)},uj._loadedComplete=function(uW,uj,ut){if(null!=ut)switch(this._type){case"atlas":case"plf":case"json":var ud=new uH(ut);this.onLoaded(JSON.parse(ud.readUTFBytes()));break;case"font":ud=new uH(ut);this.onLoaded(un.parseXMLFromString(ud.readUTFBytes()));break;default:this.onLoaded(ut)}else this.event("error",uW)},uj.onLoaded=function(uW){var uj=this._type;if("plf"==uj)this.parsePLFData(uW),this.complete(uW);else if("image"===uj){var ut=new uRW(uW);ut.url=this._url,this.complete(ut)}else if("sound"===uj||"htmlimage"===uj||"nativeimage"===uj)this.complete(uW);else if("atlas"===uj){if(!uW.src&&!uW._setContext){if(!this._data){if((this._data=uW).meta&&uW.meta.image)for(var ud=uW.meta.image.split(","),ub=0<=this._url.indexOf("/")?"/":"\\",uE=this._url.lastIndexOf(ub),uO=0<=uE?this._url.substr(0,uE+1):"",uq=0,uA=ud.length;uq<uA;uq++)ud[uq]=uO+ud[uq];else ud=[this._url.replace(".json",".png")];ud.reverse(),uW.toLoads=ud,uW.pics=[]}return this.event("progress",.3+1/ud.length*.6),this._loadImage(ud.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(uW),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var uc=this._data.frames,uR=this._url.split("?")[0],um=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:uR.substring(0,uR.lastIndexOf("."))+"/",uQ=this._data.pics,uT=uv.formatURL(this._url),u$=uL.atlasMap[uT]||(uL.atlasMap[uT]=[]);u$.dir=um;var ue=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var uK in ue=parseFloat(this._data.meta.scale),uc){var uo,uS=uc[uK],uM=uQ[uS.frame.idx?uS.frame.idx:0],uZ=uv.formatURL(um+uK);uM.scaleRate=ue,uo=uRW.create(uM,uS.frame.x,uS.frame.y,uS.frame.w,uS.frame.h,uS.spriteSourceSize.x,uS.spriteSourceSize.y,uS.sourceSize.w,uS.sourceSize.h),uL.cacheRes(uZ,uo),uL.keepCache(this._url,um+uK),uo.url=uZ,u$.push(uZ)}else for(uK in uc)uM=uQ[(uS=uc[uK]).frame.idx?uS.frame.idx:0],uZ=uv.formatURL(um+uK),uL.cacheRes(uZ,uRW.create(uM,uS.frame.x,uS.frame.y,uS.frame.w,uS.frame.h,uS.spriteSourceSize.x,uS.spriteSourceSize.y,uS.sourceSize.w,uS.sourceSize.h)),uL.loadedMap[uZ].url=uZ,uL.keepCache(this._url,um+uK),u$.push(uZ);delete this._data.pics,this.complete(this._data)}else if("font"==uj){if(!uW.src)return this._data=uW,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var uX=new uV;uX.parseFont(this._data,uW);var u_=this._url.split(".fnt")[0].split("/"),uN=u_[u_.length-1];uKW.registerBitmapFont(uN,uX),this._data=uX,this.complete(this._data)}else if("pkm"==uj){var uz=u_W.create(uW,this._url),uC=new uRW(uz);uC.url=this._url,this.complete(uC)}else this.complete(uW)},uj.parsePLFData=function(uW){var uj,ut,ud;for(uj in uW)switch(ud=uW[uj],uj){case"json":case"text":for(ut in ud)uL.preLoadedMap[uv.formatURL(ut)]=ud[ut];break;default:for(ut in ud)uL.preLoadedMap[uv.formatURL(ut)]=ud[ut]}},uj.complete=function(uW){this._data=uW,this._customParse?this.event("loaded",uW instanceof Array?[uW]:uW):(uL._loaders.push(this),uL._isWorking||uL.checkNext())},uj.endLoad=function(uW){uW&&(this._data=uW),this._cache&&uL.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},uR(0,uj,"url",function(){return this._url}),uR(0,uj,"data",function(){return this._data}),uR(0,uj,"cache",function(){return this._cache}),uR(0,uj,"type",function(){return this._type}),uL.checkNext=function(){uL._isWorking=!0;for(var uW=uY.now();uL._startIndex<uL._loaders.length;)if(uY.now(),uL._loaders[uL._startIndex].endLoad(),uL._startIndex++,uY.now()-uW>uL.maxTimeOut)return console.warn("loader callback cost a long time:"+(uY.now()-uW)+" url="+uL._loaders[uL._startIndex-1].url),void uN.timer.frameOnce(1,null,uL.checkNext);uL._loaders.length=0,uL._startIndex=0,uL._isWorking=!1},uL.clearRes=function(uW,uj){if(null!=uW){void 0===uj&&(uj=!1),uW=uv.formatURL(uW);var ut=uL.getAtlas(uW);if(ut){for(var ud=0,ub=ut.length;ud<ub;ud++){var uE=ut[ud],uO=uL.getRes(uE);delete uL.loadedMap[uE],uL.clearCache(uW.substring(uv.basePath.length),uE.substring(uv.basePath.length)),uO&&uO.destroy(uj)}ut.length=0,delete uL.atlasMap[uW],delete uL.loadedMap[uW]}else{var uq=uL.loadedMap[uW];uq&&(delete uL.loadedMap[uW],uq instanceof laya.resource.Texture&&uq.bitmap&&uq.destroy(uj))}}},uL.clearTextureRes=function(uW){uW=uv.formatURL(uW);var uj=laya.net.Loader.getAtlas(uW),ut=uj&&0<uj.length?laya.net.Loader.getRes(uj[0]):laya.net.Loader.getRes(uW);ut&&ut.bitmap&&(uy.isConchApp&&!uy.isConchWebGL?ut.bitmap.source.releaseTexture&&ut.bitmap.source.releaseTexture():null==ut.bitmap._atlaser&&ut.bitmap.releaseResource(!0))},uL.getRes=function(uW){return uL.loadedMap[uv.formatURL(uW)]},uL.getAtlas=function(uW){return uL.atlasMap[uv.formatURL(uW)]},uL.cacheRes=function(uW,uj){uW=uv.formatURL(uW),null!=uL.loadedMap[uW]?console.warn("Resources already exist,is repeated loading:",uW):uL.loadedMap[uW]=uj},uL.setGroup=function(uW,uj){uL.groupMap[uj]||(uL.groupMap[uj]=[]),uL.groupMap[uj].push(uW)},uL.clearResByGroup=function(uW){if(uL.groupMap[uW]){var uj=uL.groupMap[uW],ut=0,ud=uj.length;for(ut=0;ut<ud;ut++)uL.clearRes(uj[ut]);uj.length=0}},uL.keepCache=function(uW,uj){if(uW&&uj){var ut=uL.cacheSet[uj];ut?-1==ut.indexOf(uW)&&ut.push(uW):uL.cacheSet[uj]=[uW]}},uL.clearCache=function(uW,uj){if(uW&&uj){var ut=uL.cacheSet[uj];if(ut){var ud=ut.indexOf(uW);if(-1!==ud){var ub=ut.length-1;0==ub?(delete uL.cacheSet[uj],0<uL.imgMgrSet[uj]?uO.imgMgrFree(uj,uL.imgMgrSet[uj]):uL.clearRes(uj,!0)):(ut[ud]=ut[ub],ut.length=ub)}}}},uL.saveObject=function(uW,uj,ut){if(uj&&uW){var ud=uL.objectSet[uW];ud?(console.warn("Loader.saveObject: "+uW),ud[0]=uj,ud[1]=ut):uL.objectSet[uW]=[uj,ut,[]]}},uL.findObject=function(uW){if(uW){var uj=uL.objectSet[uW];if(uj)return uj[0]}return null},uL.keepObject=function(uW,uj){if(uW&&uj){var ut=uL.objectSet[uj];ut&&-1===ut[2].indexOf(uW)&&ut[2].push(uW)}},uL.clearObject=function(uW,uj){if(uW&&uj){var ut=uL.objectSet[uj];if(ut){var ud=ut[2],ub=ud.indexOf(uW);if(-1!==ub){var uE=ud.length-1;0==uE?(delete uL.objectSet[uj],ut[1]&&ut[1].call(null,ut[0])):(ud[ub]=ud[uE],ud.length=uE)}}}},uL.TEXT="text",uL.JSON="json",uL.XML="xml",uL.BUFFER="arraybuffer",uL.IMAGE="image",uL.SOUND="sound",uL.ATLAS="atlas",uL.FONT="font",uL.TTF="ttf",uL.PLF="plf",uL.PKM="pkm",uL.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},uL.parserMap={},uL.groupMap={},uL.maxTimeOut=100,uL.loadedMap={},uL.preLoadedMap={},uL.atlasMap={},uL._loaders=[],uL._isWorking=!1,uL._startIndex=0,uL.imgCache={},uL.cacheSet={},uL.objectSet={},uL.imgMgrSet={},uL}(),uAW=function(uW){var uQ;function uT(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},uT.__super.call(this);for(var uW=0;uW<this._maxPriority;uW++)this._resInfos[uW]=[]}ue(uT,"laya.net.LoaderManager",uc);var uj=uT.prototype;return uj.create=function(uW,ut,uj,ud,ub,uE,uO,uq){if(null==uE&&(uE=2),null==uO&&(uO=!0),uW instanceof Array){var uA=uW,uc=uA.length,uR=0;if(uj)var um=uS.create(uj.caller,uj.method,uj.args,!1);for(var uQ=0;uQ<uc;uQ++){var uT=uA[uQ];"string"==typeof uT&&(uT=uA[uQ]={url:uT}),uT.progress=0}for(uQ=0;uQ<uc;uQ++){uT=uA[uQ];var u$=uj?uS.create(null,uo,[uT],!1):null,ue=uj||ut?uS.create(null,uK,[uT]):null;this._create(uT.url,ue,u$,uT.clas||ud,uT.params||ub,null!=uT.priority&&0<=uT.priority?uT.priority:uE,uO,uT.group||uq)}function uK(uW,uj){uR++,uW.progress=1,uR===uc&&ut&&ut.run()}function uo(uW,uj){uW.progress=uj;for(var ut=0,ud=0;ud<uc;ud++){ut+=uA[ud].progress}var ub=ut/uc;um.runWith(ub)}return!0}return this._create(uW,ut,uj,ud,ub,uE,uO,uq)},uj._create=function(uj,ut,uW,ud,ub,uE,uO,uq){uj&&""!=uj||console.error("加载的url不合法 "+uj),null==uE&&(uE=2),null==uO&&(uO=!0);var uA=uv.formatURL(uj),uc=this.getRes(uA);if(uc)!uc.hasOwnProperty("loaded")||uc.loaded?(uW&&uW.runWith(1),ut&&ut.run()):ut&&uN.loader._createListener(uj,ut.caller,ut.method,ut.args,!0,!1);else{var uR=un.getFileExtension(uj),um=uT.createMap[uR];if(!um)throw new Error("LoaderManager:unknown file("+uj+") extension with: "+uR+".");ud||(ud=um[0]);var uQ=um[1];if("atlas"==uR)this.load(uj,ut,uW,uQ,uE,uO);else{ud===uRW&&(uQ="htmlimage"),(uc=ud?new ud:null).hasOwnProperty("_loaded")&&(uc._loaded=!1),uc._setUrl(uj),uq&&uc._setGroup(uq),this._createLoad(uc,uj,uS.create(null,function(uW){uc&&!uc.destroyed&&uW&&uc.onAsynLoaded.call(uc,uj,uW,ub),ut&&ut.run();uN.loader.event(uj)}),uW,uQ,uE,!1,uq,!0),uO&&this.cacheRes(uA,uc)}}return uc},uj.load=function(uW,uj,ut,ud,ub,uE,uO,uq){uW&&""!=uW||console.error("加载的url不合法 "+uW);var uA=this;if(null==ub&&(ub=2),null==uE&&(uE=!0),void 0===uq&&(uq=!1),uW instanceof Array)return this._loadAssets(uW,uj,ut,ud,ub,uE,uO);var uc=uqW.getRes(uW);if(null!=uc)uN.timer.frameOnce(1,null,function(){ut&&ut.runWith(1),uj&&uj.runWith(uc),uA._loaderCount||uA.event("complete")});else{var uR=uT._resMap[uW];uR?(uj&&uR._createListener("complete",uj.caller,uj.method,uj.args,!1,!1),ut&&uR._createListener("progress",ut.caller,ut.method,ut.args,!1,!1)):((uR=this._infoPool.length?this._infoPool.pop():new uQ).url=uW,uR.type=ud,uR.cache=uE,uR.group=uO,uR.ignoreCache=uq,uR.priority=ub,uj&&uR.on("complete",uj.caller,uj.method,uj.args),ut&&uR.on("progress",ut.caller,ut.method,ut.args),uT._resMap[uW]=uR,ub=ub<this._maxPriority?0<=ub?ub:0:this._maxPriority-1,this._resInfos[ub].push(uR),this._next())}return this},uj._createLoad=function(uW,uj,ut,ud,ub,uE,uO,uq,uA){var uc=this;if(null==uE&&(uE=2),null==uO&&(uO=!0),void 0===uA&&(uA=!1),uj instanceof Array)return this._loadAssets(uj,ut,ud,ub,uE,uO,uq);var uR=uqW.getRes(uj);if(null!=uR)uN.timer.frameOnce(1,null,function(){ud&&ud.runWith(1),ut&&ut.runWith(uR),uc._loaderCount||uc.event("complete")});else{var um=uT._resMap[uj];um?(ut&&um._createListener("complete",ut.caller,ut.method,ut.args,!1,!1),ud&&um._createListener("progress",ud.caller,ud.method,ud.args,!1,!1)):((um=this._infoPool.length?this._infoPool.pop():new uQ).url=uj,um.clas=uW,um.type=ub,um.cache=uO,um.group=uq,um.ignoreCache=uA,um.priority=uE,ut&&um.on("complete",ut.caller,ut.method,ut.args),ud&&um.on("progress",ud.caller,ud.method,ud.args),uT._resMap[uj]=um,uE=uE<this._maxPriority?0<=uE?uE:0:this._maxPriority-1,this._resInfos[uE].push(um),this._next())}return this},uj._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var uW=0;uW<this._maxPriority;uW++)for(var uj=this._resInfos[uW];0<uj.length;){var ut=uj.shift();if(ut)return this._doLoad(ut)}this._loaderCount||this.event("complete")}},uj._doLoad=function(uj){this._loaderCount++;var ut=this._loaders.length?this._loaders.pop():new uqW;ut.on("complete",null,ub),ut.on("progress",null,function(uW){uj.event("progress",uW)}),ut.on("error",null,function(uW){ub(null)});var ud=this;function ub(uW){ut.offAll(),ut._data=null,ut._customParse=!1,ud._loaders.push(ut),ud._endLoad(uj,uW instanceof Array?[uW]:uW),ud._loaderCount--,ud._next()}ut._class=uj.clas,1<=uj.priority?(ut.priority=uj.priority,ut.realTime=!1):(ut.priority=0,ut.realTime=!0),ut.load(uj.url,uj.type,uj.cache,uj.group,uj.ignoreCache)},uj._endLoad=function(uW,uj){var ut=uW.url;if(null==uj){var ud=this._failRes[ut]||0;if(ud<this.retryNum)return console.warn("[warn]Retry to load:",ut),this._failRes[ut]=ud+1,void uN.timer.once(this.retryDelay,this,this._addReTry,[uW],!1);console.warn("[error]Failed to load:",ut),this.event("error",ut)}this._failRes[ut]&&(this._failRes[ut]=0),delete uT._resMap[ut],uW.event("complete",uj),uW.offAll(),this._infoPool.push(uW)},uj._addReTry=function(uW){this._resInfos[this._maxPriority-1].push(uW),this._next()},uj.clearRes=function(uW,uj){void 0===uj&&(uj=!1),uqW.clearRes(uW,uj)},uj.getRes=function(uW){return uqW.getRes(uW)},uj.cacheRes=function(uW,uj){uqW.cacheRes(uW,uj)},uj.clearTextureRes=function(uW){uqW.clearTextureRes(uW)},uj.setGroup=function(uW,uj){uqW.setGroup(uW,uj)},uj.clearResByGroup=function(uW){uqW.clearResByGroup(uW)},uj.clearUnLoaded=function(){for(var uW=0;uW<this._maxPriority;uW++){for(var uj=this._resInfos[uW],ut=uj.length-1;-1<ut;ut--){var ud=uj[ut];ud&&(ud.offAll(),this._infoPool.push(ud))}uj.length=0}this._loaderCount=0,uT._resMap={}},uj.cancelLoadByUrls=function(uW){if(uW)for(var uj=0,ut=uW.length;uj<ut;uj++)this.cancelLoadByUrl(uW[uj])},uj.cancelLoadByUrl=function(uW){for(var uj=0;uj<this._maxPriority;uj++)for(var ut=this._resInfos[uj],ud=ut.length-1;-1<ud;ud--){var ub=ut[ud];ub&&ub.url===uW&&(ut[ud]=null,ub.offAll(),this._infoPool.push(ub))}uT._resMap[uW]&&delete uT._resMap[uW]},uj._loadAssets=function(uW,ut,uO,uj,ud,ub,uE){null==ud&&(ud=2),null==ub&&(ub=!0);for(var uq=uW.length,uA=0,uc=0,uR=[],um=!0,uQ=0;uQ<uq;uQ++){var uT=uW[uQ];if(!uT)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+uW);"string"==typeof uT&&(uT={url:uT,type:uj,size:1,priority:ud}),uT.size||(uT.size=1),uT.progress=0,uc+=uT.size,uR.push(uT);var u$=uO?uS.create(null,uo,[uT],!1):null,ue=ut||uO?uS.create(null,uK,[uT]):null;this.load(uT.url,ue,u$,uT.type,null!=uT.priority&&0<=uT.priority?uT.priority:2,ub,uT.group||uE)}function uK(uW,uj){uA++,uW.progress=1,uj||(um=!1),uA===uq&&ut&&ut.runWith(um)}function uo(uW,uj){if(null!=uO){uW.progress=uj;for(var ut=0,ud=0;ud<uR.length;ud++){var ub=uR[ud];ut+=ub.size*ub.progress}var uE=ut/uc;uO.runWith(uE)}}return this},uT.cacheRes=function(uW,uj){uqW.cacheRes(uW,uj)},uT._resMap={},uA(uT,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),uT.__init$=function(){uQ=function(uW){function uj(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,uj.__super.call(this)}return ue(uj,"",uc),uj}()},uT}(),ucW=(function(uW){function ub(uW){ub.__super.call(this),uW||(uW=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var uj=0,ut=0,ud=0;ud<20;ud++)ud%5!=4?this._mat[uj++]=uW[ud]:this._alpha[ut++]=uW[ud];this._action=uG.createFilterAction(32),this._action.data=this}ue(ub,"laya.filters.ColorFilter",uo);var uj=ub.prototype;uN.imps(uj,{"laya.filters.IFilter":!0}),uj.callNative=function(uW){uW._$P.cf=this;uW.conchModel&&uW.conchModel.setFilterMatrix&&uW.conchModel.setFilterMatrix(this._mat,this._alpha)},uR(0,uj,"type",function(){return 32}),uR(0,uj,"action",function(){return this._action})}(),function(uW){function ud(uW,uj,ut){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===uj&&(uj=0),ud.__super.call(this),this._byteClass=ut||uH,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,uW&&0<uj&&uj<65535&&this.connect(uW,uj)}ue(ud,"laya.net.Socket",uc);var uj=ud.prototype;uj.connect=function(uW,uj){var ut="ws://"+uW+":"+uj;ut="https:"==uY.window.location.protocol?"wss://"+uW+":"+uj:"ws://"+uW+":"+uj,this.connectByUrl(ut)},uj.connectByUrl=function(uW){var uj=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new uY.window.WebSocket(uW,this.protocols):this._socket=new uY.window.WebSocket(uW),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(uW){uj._onOpen(uW)},this._socket.onmessage=function(uW){uj._onMessage(uW)},this._socket.onclose=function(uW){uj._onClose(uW)},this._socket.onerror=function(uW){uj._onError(uW)}},uj.cleanSocket=function(){try{this._socket.close()}catch(uW){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},uj.close=function(){if(null!=this._socket)try{this._socket.close()}catch(uW){}},uj._onOpen=function(uW){this._connected=!0,this.event("open",uW)},uj._onMessage=function(uW){if(uW&&uW.data){var uj=uW.data;if(this.disableInput&&uj)this.event("message",uj);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var ut=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,uj&&("string"==typeof uj?this._input.writeUTFBytes(uj):this._input.writeArrayBuffer(uj),this._addInputPosition=this._input.pos,this._input.pos=ut),this.event("message",uj)}}},uj._onClose=function(uW){this._connected=!1,this.event("close",uW)},uj._onError=function(uW){this.event("error",uW)},uj.send=function(uW){this._socket.send(uW)},uj.flush=function(){if(this._output&&0<this._output.length){var uj;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(uW){uj=uW}this._output.endian=this.endian,this._output.clear(),uj&&this.event("error",uj)}},uR(0,uj,"input",function(){return this._input}),uR(0,uj,"output",function(){return this._output}),uR(0,uj,"connected",function(){return this._connected}),uR(0,uj,"endian",function(){return this._endian},function(uW){this._endian=uW,null!=this._input&&(this._input.endian=uW),null!=this._output&&(this._output.endian=uW)}),ud.LITTLE_ENDIAN="littleEndian",ud.BIG_ENDIAN="bigEndian"}(),function(uW){function uq(){uq.__super.call(this),this._$1__id=++uq._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(uq._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,us.currentResourceManager&&us.currentResourceManager.addResource(this)}ue(uq,"laya.resource.Resource",uc);var uj=uq.prototype;return uN.imps(uj,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),uj._setUrl=function(uW){var uj;this._url!==uW&&(this._url&&((uj=uq._urlResourcesMap[this._url]).splice(uj.indexOf(this),1),0===uj.length&&delete uq._urlResourcesMap[this._url]),uW&&((uj=uq._urlResourcesMap[uW])||(uq._urlResourcesMap[uW]=uj=[]),uj.push(this)),this._url=uW)},uj._getGroup=function(){return this._group},uj._setGroup=function(uW){var uj;this._group!==uW&&(this._group&&((uj=uq._groupResourcesMap[this._group]).splice(uj.indexOf(this),1),0===uj.length&&delete uq._groupResourcesMap[this._group]),uW&&((uj=uq._groupResourcesMap[uW])||(uq._groupResourcesMap[uW]=uj=[]),uj.push(this)),this._group=uW)},uj._addReference=function(){this._referenceCount++},uj._removeReference=function(){this._referenceCount--},uj._clearReference=function(){this._referenceCount=0},uj._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},uj.recreateResource=function(){this.completeCreate()},uj.disposeResource=function(){},uj.activeResource=function(uW){void 0===uW&&(uW=!1),this._lastUseFrameCount=uP.loopCount,!this._destroyed&&this.__loaded&&(this._released||uW)&&this.recreateResource()},uj.releaseResource=function(uW){return void 0===uW&&(uW=!0),!(!uW&&this.lock)&&(!(this._released&&!uW)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},uj.onAsynLoaded=function(uW,uj,ut){throw new Error("Resource: must override this function!")},uj.destroy=function(){var uW;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete uq._idResourcesMap[this.id],this._url&&((uW=uq._urlResourcesMap[this._url])&&(uW.splice(uW.indexOf(this),1),0===uW.length&&delete uq._urlResourcesMap[this.url]),uqW.clearRes(this._url),this.__loaded||uG.cancelLoadByUrl(this._url)),this._group&&((uW=uq._groupResourcesMap[this._group]).splice(uW.indexOf(this),1),0===uW.length&&delete uq._groupResourcesMap[this.url]))},uj.completeCreate=function(){this._released=!1,this.event("recovered",this)},uj.dispose=function(){this.destroy()},uR(0,uj,"memorySize",function(){return this._memorySize},function(uW){var uj=uW-this._memorySize;this._memorySize=uW,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,uj),this.resourceManager&&this.resourceManager.addSize(uj)}),uR(0,uj,"_loaded",null,function(uW){this.__loaded=uW}),uR(0,uj,"loaded",function(){return this.__loaded}),uR(0,uj,"id",function(){return this._$1__id}),uR(0,uj,"destroyed",function(){return this._destroyed}),uR(0,uj,"group",function(){return this._getGroup()},function(uW){this._setGroup(uW)}),uR(0,uj,"resourceManager",function(){return this._resourceManager}),uR(0,uj,"url",function(){return this._url}),uR(0,uj,"released",function(){return this._released}),uR(0,uj,"referenceCount",function(){return this._referenceCount}),uq.getResourceByID=function(uW){return uq._idResourcesMap[uW]},uq.getResourceByURL=function(uW,uj){return void 0===uj&&(uj=0),null==uq._urlResourcesMap[uW]?null:uq._urlResourcesMap[uW][uj]},uq.getResourceCountByURL=function(uW){return uq._urlResourcesMap[uW].length},uq.destroyUnusedResources=function(uW){var uj;if(uW){var ut=uq._groupResourcesMap[uW];if(ut)for(var ud=ut.slice(),ub=0,uE=ud.length;ub<uE;ub++)(uj=ud[ub]).lock||0!==uj._referenceCount||uj.destroy()}else for(var uO in uq._idResourcesMap)(uj=uq._idResourcesMap[uO]).lock||0!==uj._referenceCount||uj.destroy()},uq._uniqueIDCounter=0,uq._idResourcesMap={},uq._urlResourcesMap={},uq._groupResourcesMap={},uq}()),uRW=function(uW){function uL(uW,uj){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,uL.__super.call(this),uW&&null!=uW._addReference&&uW._addReference(),this.setTo(uW,uj)}ue(uL,"laya.resource.Texture",uc);var uj=uL.prototype;return uj._setUrl=function(uW){this.url=uW},uj.setTo=function(uW,uj){if(uW instanceof uO.HTMLElement){var ut=uMW.create("2D",uW);this.bitmap=ut}else this.bitmap=uW;if(this.uv=uj||uL.DEF_UV,uW){this._w=uW.width,this._h=uW.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var ud=this;if(this._loaded)uG.addToAtlas&&uG.addToAtlas(ud);else{var ub=uW;ub instanceof laya.resource.HTMLImage&&ub.image&&ub.image.addEventListener("load",function(uW){uG.addToAtlas&&uG.addToAtlas(ud)},!1)}}},uj.active=function(){this.bitmap&&this.bitmap.activeResource()},uj.destroy=function(uW){if(void 0===uW&&(uW=!1),this.alphaTexture&&(this.alphaTexture.destroy(uW),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var uj=this.bitmap;uW?(uy.isConchApp&&uj.source&&uj.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,uj.dispose(),uj._clearReference()):(uj._removeReference(),0==uj.referenceCount&&(uy.isConchApp&&uj.source&&uj.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,uj.dispose())),this.url&&this===uN.loader.getRes(this.url)&&uN.loader.clearRes(this.url,uW),this._loaded=!1}},uj.load=function(uW){var uj=this;this._loaded=!1,uW=uv.customFormat(uW);var ut=this.bitmap||(this.bitmap=u_W.create(uW));ut.uri=uW,ut&&ut._addReference();var ud=this;ut.onload=function(){ut.onload=null,ud._loaded=!0,uj.sourceWidth=uj._w=ut.width,uj.sourceHeight=uj._h=ut.height,ud.event("loaded",this),uG.addToAtlas&&uG.addToAtlas(ud)}},uj.addTextureToAtlas=function(uW){uG.addTextureToAtlas(this)},uj.getPixels=function(uW,uj,ut,ud){if(uy.isConchApp){var ub=this.bitmap;if(ub.source&&ub.source.getImageData){var uE=ub.source.getImageData(uW,uj,ut,ud),uO=new Uint8Array(uE);return Array.from(uO)}return null}return uy.isWebGL?uG.getTexturePixels(this,uW,uj,ut,ud):(uY.canvas.size(ut,ud),uY.canvas.clear(),uY.context.drawTexture(this,-uW,-uj,this.width,this.height,0,0),uY.context.getImageData(0,0,ut,ud).data)},uj.onAsynLoaded=function(uW,uj){if(uj){if("function"!=typeof uj._addReference)throw new Error("bitmap._addReference is not a function. "+uj.className+" "+typeof uj._addReference+" "+uj.constructor);uj._addReference()}this.setTo(uj,this.uv),this._loaded&&this.event("loaded",this)},uR(0,uj,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),uR(0,uj,"loaded",function(){return this._loaded}),uR(0,uj,"released",function(){return!this.bitmap||this.bitmap.released}),uR(0,uj,"width",function(){return this._w?this._w:this.uv&&this.uv!==uL.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(uW){this._w=uW,this.sourceWidth||(this.sourceWidth=uW)}),uR(0,uj,"repeat",function(){return!uy.isWebGL||!this.bitmap||this.bitmap.repeat},function(uW){uW&&uy.isWebGL&&this.bitmap&&(this.bitmap.repeat=uW)&&(this.bitmap.enableMerageInAtlas=!1)}),uR(0,uj,"height",function(){return this._h?this._h:this.uv&&this.uv!==uL.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(uW){this._h=uW,this.sourceHeight||(this.sourceHeight=uW)}),uR(0,uj,"isLinearSampling",function(){return!uy.isWebGL||9728!=this.bitmap.minFifter},function(uW){!uW&&uy.isWebGL&&(uW||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),uL.moveUV=function(uW,uj,ut){for(var ud=0;ud<8;ud+=2)ut[ud]+=uW,ut[ud+1]+=uj;return ut},uL.create=function(uW,uj,ut,ud,ub,uE,uO,uq,uA){void 0===uE&&(uE=0),void 0===uO&&(uO=0),void 0===uq&&(uq=0),void 0===uA&&(uA=0);var uc=uW instanceof laya.resource.Texture,uR=uc?uW.uv:uL.DEF_UV,um=uc?uW.bitmap:uW,uQ=uG.isAtlas(um);if(uQ){var uT=um._atlaser,u$=uW._atlasID;if(-1==u$)throw new Error("create texture error");um=uT._inAtlasTextureBitmapValue[u$],uR=uT._inAtlasTextureOriUVValue[u$]}var ue=new uL(um,null);um.width&&uj+ud>um.width&&(ud=um.width-uj),um.height&&ut+ub>um.height&&(ub=um.height-ut),ue.width=ud,ue.height=ub,ue.offsetX=uE,ue.offsetY=uO,ue.sourceWidth=uq||ud,ue.sourceHeight=uA||ub;var uK=1/um.width,uo=1/um.height;uj*=uK,ut*=uo,ud*=uK,ub*=uo;var uS=ue.uv[0],uM=ue.uv[1],uZ=ue.uv[4],uX=ue.uv[5],u_=uZ-uS,uN=uX-uM,uz=uL.moveUV(uR[0],uR[1],[uj,ut,uj+ud,ut,uj+ud,ut+ub,uj,ut+ub]);ue.uv=[uS+uz[0]*u_,uM+uz[1]*uN,uZ-(1-uz[2])*u_,uM+uz[3]*uN,uZ-(1-uz[4])*u_,uX-(1-uz[5])*uN,uS+uz[6]*u_,uX-(1-uz[7])*uN],uQ&&ue.addTextureToAtlas();var uC=um.scaleRate;return uC&&1!=uC?(ue.sourceWidth/=uC,ue.sourceHeight/=uC,ue.width/=uC,ue.height/=uC,ue.scaleRate=uC,ue.offsetX/=uC,ue.offsetY/=uC):ue.scaleRate=1,ue},uL.createFromTexture=function(uW,uj,ut,ud,ub){var uE=uW.scaleRate;1!=uE&&(uj*=uE,ut*=uE,ud*=uE,ub*=uE);var uO=uC.TEMP.setTo(uj-uW.offsetX,ut-uW.offsetY,ud,ub),uq=uO.intersection(uL._rect1.setTo(0,0,uW.width,uW.height),uL._rect2);if(!uq)return null;var uA=uL.create(uW,uq.x,uq.y,uq.width,uq.height,uq.x-uO.x,uq.y-uO.y,ud,ub);if(uA.bitmap&&uA.bitmap._removeReference)return uA.bitmap._removeReference(),uA;var uc="bitmap:"+(uA.bitmap?uA.bitmap.constructor?uA.bitmap.constructor.name:uA.bitmap.__className:"")+", url:"+(uW.url+" | "+(uA.bitmap?uA.bitmap.url:uW.url))+", x="+uj+",y="+ut+",width="+ud+",height="+ub+", result="+(uq?uq.x+","+uq.y+","+uq.width+","+uq.height:"null")+", rect="+uO.x+","+uO.y+","+uO.width+","+uO.height;throw new Error("报错：bitmap._removeReference is not a function  "+uc)},uL.DEF_UV=[0,0,1,0,1,1,0,1],uL.INV_UV=[0,1,1,1,1,0,0,0],uL._rect1=new uC,uL._rect2=new uC,uL}(),uW=function(uW){var uq;function uE(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,uE.__super.call(this)}ue(uE,"laya.utils.TimeLine",uc);var uj=uE.prototype;return uj.to=function(uW,uj,ut,ud,ub){return void 0===ub&&(ub=0),this._create(uW,uj,ut,ud,ub,!0)},uj.from=function(uW,uj,ut,ud,ub){return void 0===ub&&(ub=0),this._create(uW,uj,ut,ud,ub,!1)},uj._create=function(uW,uj,ut,ud,ub,uE){var uO=ur.getItemByClass("tweenData",uq);return uO.isTo=uE,uO.type=0,uO.target=uW,uO.duration=ut,uO.data=uj,uO.startTime=this._startTime+ub,uO.endTime=uO.startTime+uO.duration,uO.ease=ud,this._startTime=Math.max(uO.endTime,this._startTime),this._tweenDataList.push(uO),this._startTimeSort=!0,this._endTimeSort=!0,this},uj.addLabel=function(uW,uj){var ut=ur.getItemByClass("tweenData",uq);return ut.type=1,ut.data=uW,ut.endTime=ut.startTime=this._startTime+uj,this._labelDic||(this._labelDic={}),this._labelDic[uW]=ut,this._tweenDataList.push(ut),this},uj.removeLabel=function(uW){if(this._labelDic&&this._labelDic[uW]){var uj=this._labelDic[uW];if(uj){var ut=this._tweenDataList.indexOf(uj);-1<ut&&this._tweenDataList.splice(ut,1)}delete this._labelDic[uW]}},uj.gotoTime=function(uW){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var uj,ut,ud,ub;for(var uE in this._firstTweenDic)if(ut=this._firstTweenDic[uE])for(var uO in ut)ut.diyTarget.hasOwnProperty(uO)&&(ut.diyTarget[uO]=ut[uO]);for(uE in this._tweenDic)(uj=this._tweenDic[uE]).clear(),delete this._tweenDic[uE];if(this._index=0,this._gidIndex=0,this._currTime=uW,this._lastTime=uY.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=ud=this._tweenDataList.concat(),ud.sort(function(uW,uj){return uW.endTime>uj.endTime?1:uW.endTime<uj.endTime?-1:0})}else ud=this._endTweenDataList;for(var uq=0,uA=ud.length;uq<uA;uq++)if(0==(ub=ud[uq]).type){if(!(uW>=ub.endTime))break;this._index=Math.max(this._index,uq+1);var uc=ub.data;if(ub.isTo)for(var uR in uc)ub.target[uR]=uc[uR]}for(uq=0,uA=this._tweenDataList.length;uq<uA;uq++)0==(ub=this._tweenDataList[uq]).type&&uW>=ub.startTime&&uW<ub.endTime&&(this._index=Math.max(this._index,uq+1),this._gidIndex++,(uj=ur.getItemByClass("tween",uB))._create(ub.target,ub.data,ub.duration,ub.ease,uS.create(this,this._animComplete,[this._gidIndex]),0,!1,ub.isTo,!0,!1),uj.setStartTime(this._currTime-(uW-ub.startTime)),uj._updateEase(this._currTime),uj.gid=this._gidIndex,this._tweenDic[this._gidIndex]=uj)}},uj.gotoLabel=function(uW){if(null!=this._labelDic){var uj=this._labelDic[uW];uj&&this.gotoTime(uj.startTime)}},uj.pause=function(){uN.timer.clear(this,this._update)},uj.resume=function(){this.play(this._currTime,this._loopKey)},uj.play=function(uW,uj){if(void 0===uW&&(uW=0),void 0===uj&&(uj=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(uW,uj){return uW.startTime>uj.startTime?1:uW.startTime<uj.startTime?-1:0});for(var ut=0,ud=this._tweenDataList.length;ut<ud;ut++){var ub=this._tweenDataList[ut];if(null!=ub&&0==ub.type){var uE=ub.target,uO=uE.$_GID||(uE.$_GID=un.getGID()),uq=null;for(var uA in null==this._firstTweenDic[uO]?((uq={}).diyTarget=uE,this._firstTweenDic[uO]=uq):uq=this._firstTweenDic[uO],ub.data)null==uq[uA]&&(uq[uA]=uE[uA])}}}"string"==typeof uW?this.gotoLabel(uW):this.gotoTime(uW),this._loopKey=uj,this._lastTime=uY.now(),uN.timer.frameLoop(1,this,this._update)}},uj._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var uW in this._tweenDic)(uj=this._tweenDic[uW]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var uj,ut=uY.now(),ud=ut-this._lastTime,ub=this._currTime+=ud*this.scale;for(uW in this._lastTime=ut,this._tweenDic)(uj=this._tweenDic[uW])._updateEase(ub);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var uE=this._tweenDataList[this._index];ub>=uE.startTime&&(this._index++,0==uE.type?(this._gidIndex++,(uj=ur.getItemByClass("tween",uB))._create(uE.target,uE.data,uE.duration,uE.ease,uS.create(this,this._animComplete,[this._gidIndex]),0,!1,uE.isTo,!0,!1),uj.setStartTime(ub),uj.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=uj)._updateEase(ub)):this.event("label",uE.data))}},uj._animComplete=function(uW){this._tweenDic[uW]&&delete this._tweenDic[uW]},uj._complete=function(){this.event("complete")},uj.reset=function(){var uW;if(this._labelDic)for(uW in this._labelDic)delete this._labelDic[uW];for(uW in this._tweenDic)this._tweenDic[uW].clear(),delete this._tweenDic[uW];for(uW in this._firstTweenDic)delete this._firstTweenDic[uW];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var uj,ut=0;for(uj=this._tweenDataList.length,ut=0;ut<uj;ut++)this._tweenDataList[ut]&&this._tweenDataList[ut].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,uN.timer.clear(this,this._update)},uj.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},uR(0,uj,"index",function(){return this._frameIndex},function(uW){this._frameIndex=uW,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),uR(0,uj,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),uE.to=function(uW,uj,ut,ud,ub){return void 0===ub&&(ub=0),(new uE).to(uW,uj,ut,ud,ub)},uE.from=function(uW,uj,ut,ud,ub){return void 0===ub&&(ub=0),(new uE).from(uW,uj,ut,ud,ub)},uE.__init$=function(){uq=function(){function uW(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return ue(uW,""),uW.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,ur.recover("tweenData",this)},uW}()},uE}(),umW=function(ub){function ut(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,ut.__super.call(this),this._style=uq.EMPTY}ue(ut,"laya.display.Sprite",ub);var uW=ut.prototype;return uN.imps(uW,{"laya.display.ILayout":!0}),uW.createConchModel=function(){return new ConchNode},uW.destroy=function(uW){if(void 0===uW&&(uW=!0),this._releaseMem(),!this._destroyed){this.filters=null;var uj=this.mask;uj&&(this.mask=null,uj.destroy(uW))}ub.prototype.destroy.call(this,uW),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},uW.updateZOrder=function(){un.updateOrder(this._childs)&&this.repaint()},uW.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},uW.setBounds=function(uW){this._set$P("uBounds",uW)},uW.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new uC),uC._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},uW.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new uC),uC._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},uW._boundPointsToParent=function(uW){void 0===uW&&(uW=!1);var uj=0,ut=0;this._style&&(uj=this._style._tf.translateX,ut=this._style._tf.translateY,uW=uW||0!==this._style._tf.rotate,this._style.scrollRect&&(uj+=this._style.scrollRect.x,ut+=this._style.scrollRect.y));var ud=this._getBoundPointsM(uW);if(!ud||ud.length<1)return ud;if(8!=ud.length&&(ud=uW?uX.scanPList(ud):uC._getWrapRec(ud,uC.TEMP)._getBoundPoints()),!this.transform)return un.transPointList(ud,this._x-uj,this._y-ut),ud;var ub=uz.TEMP,uE=0,uO=ud.length;for(uE=0;uE<uO;uE+=2)ub.x=ud[uE],ub.y=ud[uE+1],this.toParentPoint(ub),ud[uE]=ub.x,ud[uE+1]=ub.y;return ud},uW.getGraphicBounds=function(uW){return void 0===uW&&(uW=!1),this._graphics?this._graphics.getBounds(uW):uC.TEMP.setTo(0,0,0,0)},uW._getBoundPointsM=function(uW){if(void 0===uW&&(uW=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var uj=un.clearArray(this._$P.temBM),ut=uC.TEMP;return ut.copyFrom(this.scrollRect),un.concatArray(uj,ut._getBoundPoints()),uj}for(var ud,ub,uE,uO=this._graphics?this._graphics.getBoundPoints():un.clearArray(this._$P.temBM),uq=0,uA=(uE=this._childs).length;uq<uA;uq++)(ud=uE[uq])instanceof laya.display.Sprite&&1==ud.visible&&(ub=ud._boundPointsToParent(uW))&&(uO=uO?un.concatArray(uO,ub):ub);return uO},uW.getStyle=function(){return this._style===uq.EMPTY&&(this._style=new uq),this._style},uW.setStyle=function(uW){this._style=uW},uW._adjustTransform=function(){this._tfChanged=!1;var uW,uj=this._style._tf,ut=uj.scaleX,ud=uj.scaleY;if(uj.rotate||1!==ut||1!==ud||uj.skewX||uj.skewY){(uW=this._transform||(this._transform=ul.create())).bTransform=!0;var ub=.0174532922222222*(uj.rotate-uj.skewX),uE=.0174532922222222*(uj.rotate+uj.skewY),uO=Math.cos(uE),uq=Math.sin(uE),uA=Math.sin(ub),uc=Math.cos(ub);return uW.a=ut*uO,uW.b=ut*uq,uW.c=-ud*uA,uW.d=ud*uc,uW.tx=uW.ty=0,uW}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,uW},uW.pos=function(uW,uj,ut){if(void 0===ut&&(ut=!1),this._x!==uW||this._y!==uj){if(this.destroyed)return this;if(ut){this._x=uW,this._y=uj,this.conchModel&&this.conchModel.pos(this._x,this._y);var ud=this._parent;ud&&0===ud._repaint&&(ud._repaint=1,ud.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=uW,this.y=uj}return this},uW.pivot=function(uW,uj){return this.pivotX=uW,this.pivotY=uj,this},uW.size=function(uW,uj){return this.width=uW,this.height=uj,this},uW.scale=function(uW,uj,ut){void 0===ut&&(ut=!1);var ud=this.getStyle(),ub=ud._tf;if(ub.scaleX!=uW||ub.scaleY!=uj){if(this.destroyed)return this;if(ut){ud.setScale(uW,uj),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(uW,uj),this._renderType|=4;var uE=this._parent;uE&&0===uE._repaint&&(uE._repaint=1,uE.parentRepaint())}else this.scaleX=uW,this.scaleY=uj}return this},uW.skew=function(uW,uj){return this.skewX=uW,this.skewY=uj,this},uW.render=function(uW,uj,ut){uP.spriteCount++,uu.renders[this._renderType]._fun(this,uW,uj+this._x,ut+this._y),this._repaint=0},uW.drawToCanvas=function(uW,uj,ut,ud){if(uy.isConchNode){var ub=uMW.create("2D");return new ua(uW,uj,ub).ctx.setCanvasType(1),this.conchModel.drawToCanvas(ub.source,ut,ud),ub}return uG.drawToCanvas(this,this._renderType,uW,uj,ut,ud)},uW.customRender=function(uW,uj,ut){this._renderType|=1024},uW._applyFilters=function(){var uW;if(!uy.isWebGL&&((uW=this._$P.filters)&&!(uW.length<1)))for(var uj=0,ut=uW.length;uj<ut;uj++)uW[uj].action.apply(this._$P.cacheCanvas)},uW._isHaveGlowFilter=function(){var uW,uj=0;if(this.filters)for(uj=0;uj<this.filters.length;uj++)if(8==this.filters[uj].type)return!0;for(uj=0,uW=this._childs.length;uj<uW;uj++)if(this._childs[uj]._isHaveGlowFilter())return!0;return!1},uW.localToGlobal=function(uW,uj){void 0===uj&&(uj=!1),!0===uj&&(uW=new uz(uW.x,uW.y));for(var ut=this;ut&&ut!=uN.stage;)uW=ut.toParentPoint(uW),ut=ut.parent;return uW},uW.globalToLocal=function(uW,uj){void 0===uj&&(uj=!1),uj&&(uW=new uz(uW.x,uW.y));for(var ut=this,ud=[];ut&&ut!=uN.stage;)ud.push(ut),ut=ut.parent;for(var ub=ud.length-1;0<=ub;)uW=(ut=ud[ub]).fromParentPoint(uW),ub--;return uW},uW.toParentPoint=function(uW){if(!uW)return uW;uW.x-=this.pivotX,uW.y-=this.pivotY,this.transform&&this._transform.transformPoint(uW),uW.x+=this._x,uW.y+=this._y;var uj=this._style.scrollRect;return uj&&(uW.x-=uj.x,uW.y-=uj.y),uW},uW.fromParentPoint=function(uW){if(!uW)return uW;uW.x-=this._x,uW.y-=this._y;var uj=this._style.scrollRect;return uj&&(uW.x+=uj.x,uW.y+=uj.y),this.transform&&this._transform.invertTransformPoint(uW),uW.x+=this.pivotX,uW.y+=this.pivotY,uW},uW.on=function(uW,uj,ut,ud){return 1!==this._mouseEnableState&&this.isMouseEvent(uW)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(uW,uj,ut,ud,!1)):ub.prototype.on.call(this,uW,uj,ut,ud)},uW.once=function(uW,uj,ut,ud){return 1!==this._mouseEnableState&&this.isMouseEvent(uW)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(uW,uj,ut,ud,!0)):ub.prototype.once.call(this,uW,uj,ut,ud)},uW._$2__onDisplay=function(){if(1!==this._mouseEnableState){var uW=this;for(uW=uW.parent;uW&&1!==uW._mouseEnableState&&!uW._getBit(2);)uW.mouseEnabled=!0,uW._setBit(2,!0),uW=uW.parent}},uW.loadImage=function(uW,uj,ut,ud,ub,uE){var uO=this;return void 0===uj&&(uj=0),void 0===ut&&(ut=0),void 0===ud&&(ud=0),void 0===ub&&(ub=0),this.graphics.loadImage(uW,uj,ut,ud,ub,function(uW){uO.destroyed||(uO.size(uj+(ud||uW.width),ut+(ub||uW.height)),uO.repaint(),uE&&uE.runWith(uW))}),this},uW.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},uW._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},uW._childChanged=function(uW){this._childs.length?this._renderType|=2048:this._renderType&=-2049,uW&&this._get$P("hasZorder")&&uN.timer.callLater(this,this.updateZOrder),this.repaint()},uW.parentRepaint=function(){var uW=this._parent;uW&&0===uW._repaint&&(uW._repaint=1,uW.parentRepaint())},uW.startDrag=function(uW,uj,ut,ud,ub,uE,uO){void 0===uj&&(uj=!1),void 0===ut&&(ut=0),void 0===ud&&(ud=300),void 0===uE&&(uE=!1),void 0===uO&&(uO=.92),this._$P.dragging||this._set$P("dragging",new uw),this._$P.dragging.start(this,uW,uj,ut,ud,ub,uE,uO)},uW.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},uW._releaseMem=function(){if(this._$P){var uW=this._$P.cacheCanvas;uW&&uW.ctx&&(ur.recover("RenderContext",uW.ctx),uW.ctx.canvas.size(0,0),uW.ctx=null);var uj=this._$P._filterCache;uj&&(uj.destroy(),uj.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},uW._setDisplay=function(uW){uW||this._releaseMem(),ub.prototype._setDisplay.call(this,uW)},uW.hitTestPoint=function(uW,uj){var ut=this.globalToLocal(uz.TEMP.setTo(uW,uj));return uW=ut.x,uj=ut.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?uC.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(uW,uj)},uW.getMousePoint=function(){return this.globalToLocal(uz.TEMP.setTo(uN.stage.mouseX,uN.stage.mouseY))},uW._getWords=function(){return null},uW._addChildsToLayout=function(uW){var uj=this._getWords();if(null==uj&&0==this._childs.length)return!1;if(uj)for(var ut=0,ud=uj.length;ut<ud;ut++)uW.push(uj[ut]);ut=0;for(var ub=this._childs.length;ut<ub;++ut){var uE=this._childs[ut];uE._style._enableLayout()&&uE._addToLayout(uW)}return!0},uW._addToLayout=function(uW){this._style.absolute||(this._style.block?uW.push(this):this._addChildsToLayout(uW)&&(this.x=this.y=0))},uW._isChar=function(){return!1},uW._getCSSStyle=function(){return this._style.getCSSStyle()},uW._setAttributes=function(uW,uj){switch(uW){case"x":this.x=parseFloat(uj);break;case"y":this.y=parseFloat(uj);break;case"width":this.width=parseFloat(uj);break;case"height":this.height=parseFloat(uj);break;default:this[uW]=uj}},uW._layoutLater=function(){this.parent&&this.parent._layoutLater()},uR(0,uW,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(uW){this._optimizeScrollRect!=uW&&(this._optimizeScrollRect=uW,this.conchModel&&this.conchModel.optimizeScrollRect(uW))}),uR(0,uW,"customRenderEnable",null,function(uW){if(uW&&(this._renderType|=1024,uy.isConchNode)){ut.CustomList.push(this);var uj=new uMW("2d");uj._setContext(new CanvasRenderingContext2D),this.customContext=new ua(0,0,uj),uj.context.setCanvasType&&uj.context.setCanvasType(2),this.conchModel.custom(uj.context)}}),uR(0,uW,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(uW){this.cacheAs=uW?this._$P.hasFilter?"none":"normal":"none"}),uR(0,uW,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(uW){var uj=this._$P.cacheCanvas;if(uW!==(uj?uj.type:"none")){if("none"!==uW)this._getBit(1)||this._setUpNoticeType(1),uj||(uj=this._set$P("cacheCanvas",ur.getItemByClass("cacheCanvas",Object))),uj.type=uW,uj.reCache=!0,this._renderType|=16,"bitmap"==uW&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(uj){var ut=uj;ut&&ut.ctx&&(ur.recover("RenderContext",ut.ctx),ut.ctx.canvas.size(0,0),ut.ctx=null),ur.recover("cacheCanvas",uj)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),uR(0,uW,"zOrder",function(){return this._zOrder},function(uW){this._zOrder!=uW&&(this._zOrder=uW,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(uW),this._parent&&(uW&&this._parent._set$P("hasZorder",!0),uN.timer.callLater(this._parent,this.updateZOrder)))}),uR(0,uW,"rotation",function(){return this._style._tf.rotate},function(uW){var uj=this.getStyle();if(uj._tf.rotate!==uW){uj.setRotate(uW),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(uW),this._renderType|=4;var ut=this._parent;ut&&0===ut._repaint&&(ut._repaint=1,ut.parentRepaint())}}),uR(0,uW,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(uW){this._width!==uW&&(this._width=uW,this.conchModel&&this.conchModel.size(uW,this._height),this.repaint())}),uR(0,uW,"x",function(){return this._x},function(uW){if(this._x!==uW){if(this.destroyed)return;this._x=uW,this.conchModel&&this.conchModel.pos(uW,this._y);var uj=this._parent;uj&&0===uj._repaint&&(uj._repaint=1,uj.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),uR(0,uW,"globalScaleY",function(){for(var uW=1,uj=this;uj&&uj!==uN.stage;)uW*=uj.scaleY,uj=uj.parent;return uW}),uR(0,uW,"hitArea",function(){return this._$P.hitArea},function(uW){this._set$P("hitArea",uW)}),uR(0,uW,"staticCache",function(){return this._$P.staticCache},function(uW){this._set$P("staticCache",uW),uW||this.reCache()}),uR(0,uW,"texture",function(){return this._texture},function(uW){this._texture!=uW&&(this._texture=uW,this.graphics.cleanByTexture(uW,0,0))}),uR(0,uW,"y",function(){return this._y},function(uW){if(this._y!==uW){if(this.destroyed)return;this._y=uW,this.conchModel&&this.conchModel.pos(this._x,uW);var uj=this._parent;uj&&0===uj._repaint&&(uj._repaint=1,uj.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),uR(0,uW,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(uW){this._height!==uW&&(this._height=uW,this.conchModel&&this.conchModel.size(this._width,uW),this.repaint())}),uR(0,uW,"blendMode",function(){return this._style.blendMode},function(uW){this.getStyle().blendMode=uW,this.conchModel&&this.conchModel.blendMode(uW),uW&&"source-over"!=uW?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),uR(0,uW,"scaleX",function(){return this._style._tf.scaleX},function(uW){var uj=this.getStyle();if(uj._tf.scaleX!==uW){uj.setScaleX(uW),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(uW,uj._tf.scaleY),this._renderType|=4;var ut=this._parent;ut&&0===ut._repaint&&(ut._repaint=1,ut.parentRepaint())}}),uR(0,uW,"scaleY",function(){return this._style._tf.scaleY},function(uW){var uj=this.getStyle();if(uj._tf.scaleY!==uW){uj.setScaleY(uW),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(uj._tf.scaleX,uW),this._renderType|=4;var ut=this._parent;ut&&0===ut._repaint&&(ut._repaint=1,ut.parentRepaint())}}),uR(0,uW,"stage",function(){return uN.stage}),uR(0,uW,"skewX",function(){return this._style._tf.skewX},function(uW){var uj=this.getStyle();if(uj._tf.skewX!==uW){uj.setSkewX(uW),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(uW,uj._tf.skewY),this._renderType|=4;var ut=this._parent;ut&&0===ut._repaint&&(ut._repaint=1,ut.parentRepaint())}}),uR(0,uW,"scrollRect",function(){return this._style.scrollRect},function(uW){this.getStyle().scrollRect=uW,this.repaint(),uW?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(uW.x,uW.y,uW.width,uW.height)):(this._renderType&=-129,this.conchModel&&(ut.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),uR(0,uW,"skewY",function(){return this._style._tf.skewY},function(uW){var uj=this.getStyle();if(uj._tf.skewY!==uW){uj.setSkewY(uW),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(uj._tf.skewX,uW),this._renderType|=4;var ut=this._parent;ut&&0===ut._repaint&&(ut._repaint=1,ut.parentRepaint())}}),uR(0,uW,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(uW){this._tfChanged=!1,(this._transform=uW)&&(this._x=uW.tx,this._y=uW.ty,uW.tx=uW.ty=0,this.conchModel&&this.conchModel.transform(uW.a,uW.b,uW.c,uW.d,this._x,this._y)),uW?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),uR(0,uW,"pivotX",function(){return this._style._tf.translateX},function(uW){this.getStyle().setTranslateX(uW),this.conchModel&&this.conchModel.pivot(uW,this._style._tf.translateY),this.repaint()}),uR(0,uW,"pivotY",function(){return this._style._tf.translateY},function(uW){this.getStyle().setTranslateY(uW),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,uW),this.repaint()}),uR(0,uW,"alpha",function(){return this._style.alpha},function(uW){this._style&&this._style.alpha!==uW&&(uW=uW<0?0:1<uW?1:uW,this.getStyle().alpha=uW,this.conchModel&&this.conchModel.alpha(uW),1!==uW?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),uR(0,uW,"visible",function(){return this._style.visible},function(uW){this._style&&this._style.visible!==uW&&(this.getStyle().visible=uW,this.conchModel&&this.conchModel.visible(uW),this.parentRepaint())}),uR(0,uW,"graphics",function(){return this._graphics||(this.graphics=uG.createGraphics())},function(uW){this._graphics&&(this._graphics._sp=null),(this._graphics=uW)?(this._renderType&=-2,this._renderType|=512,(uW._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(ut.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),uR(0,uW,"filters",function(){return this._$P.filters},function(uW){uW&&0===uW.length&&(uW=null),this._$P.filters!=uW&&(this._set$P("filters",uW?uW.slice():null),uy.isConchApp&&(this.conchModel&&(ut.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),uy.isWebGL&&(uW&&uW.length?this._renderType|=32:this._renderType&=-33),uW&&0<uW.length?(this._getBit(1)||this._setUpNoticeType(1),uy.isWebGL&&1==uW.length&&uW[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(uy.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),uR(0,uW,"parent",ub.prototype._$get_parent,function(uW){uN.superSet(uWW,this,"parent",uW),uW&&this._getBit(2)&&this._$2__onDisplay()}),uR(0,uW,"mask",function(){return this._$P._mask},function(uW){uW&&this.mask&&this.mask._$P.maskParent||(uW?(this.cacheAs="bitmap",this._set$P("_mask",uW),uW._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",uW),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(uW?uW.conchModel:null),this._renderType|=64,this.parentRepaint())}),uR(0,uW,"mouseEnabled",function(){return 1<this._mouseEnableState},function(uW){this._mouseEnableState=uW?2:1}),uR(0,uW,"globalScaleX",function(){for(var uW=1,uj=this;uj&&uj!==uN.stage;)uW*=uj.scaleX,uj=uj.parent;return uW}),uR(0,uW,"mouseX",function(){return this.getMousePoint().x}),uR(0,uW,"mouseY",function(){return this.getMousePoint().y}),ut.fromImage=function(uW){return(new ut).loadImage(uW)},ut._cachePool=[],ut.CustomList=[],uA(ut,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=uO.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),ut}(uWW),uQW=function(uW){function uj(uW){this._audio=null,this._onEnd=null,this._resumePlay=null,uj.__super.call(this),this._onEnd=un.bind(this.__onEnd,this),this._resumePlay=un.bind(this.__resumePlay,this),uW.addEventListener("ended",this._onEnd),this._audio=uW}ue(uj,"laya.media.h5audio.AudioSoundChannel",udW);var ut=uj.prototype;return ut.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(uN.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},ut.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,uY.container.appendChild(this._audio),this._audio.play()}catch(uW){this.event("error")}},ut.play=function(uW){this.isStopped=!1;try{this._audio.playbackRate=ux.playbackRate,this._audio.currentTime=this.startTime}catch(uW){return void this._audio.addEventListener("canplay",this._resumePlay)}ux.addChannel(this),uY.container.appendChild(this._audio),!uW&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},ut.stop=function(){this.isStopped=!0,ux.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&uy.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),uY.onIE||this._audio!=utW._musicAudio&&ur.recover("audio:"+this.url,this._audio),uY.removeElement(this._audio),this._audio=null)},ut.pause=function(){this.isStopped=!0,ux.removeChannel(this),"pause"in this._audio&&this._audio.pause()},ut.resume=function(){this._audio&&(this.isStopped=!1,ux.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},uR(0,ut,"position",function(){return this._audio?this._audio.currentTime:0}),uR(0,ut,"duration",function(){return this._audio?this._audio.duration:0}),uR(0,ut,"volume",function(){return this._audio?this._audio.volume:1},function(uW){this._audio&&(this._audio.volume=uW)}),uj}(),uTW=function(uW){function uj(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=uEW.ctx,uj.__super.call(this),this._onPlayEnd=un.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}ue(uj,"laya.media.webaudio.WebAudioSoundChannel",udW);var ut=uj.prototype;return ut.play=function(uW){if(ux.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var uj=this.context,ut=this.gain,ud=uj.createBufferSource();(this.bufferSource=ud).buffer=this.audioBuffer,ud.connect(ut),ut&&ut.disconnect(),ut.connect(uj.destination),ud.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=uY.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(ud.loop=!0),ud.playbackRate.setTargetAtTime?ud.playbackRate.setTargetAtTime(ux.playbackRate,this.context.currentTime,.1):ud.playbackRate.value=ux.playbackRate,ud.start(0,this.startTime),!uW&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},ut.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(uN.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},ut._clearBufferSource=function(){if(this.bufferSource){var uW=this.bufferSource;uW.stop?uW.stop(0):uW.noteOff(0),uW.disconnect(0),uW.onended=null,uj._tryCleanFailed||this._tryClearBuffer(uW),this.bufferSource=null}},ut._tryClearBuffer=function(uW){try{uW.buffer=null}catch(uW){uj._tryCleanFailed=!0}},ut.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,ux.removeChannel(this),this.startHandler=null,this.completeHandler=null},ut.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,ux.removeChannel(this)},ut.resume=function(){this.startTime=this._pauseTime,this.play(!1)},uR(0,ut,"position",function(){return this.bufferSource?(uY.now()-this._startTime)/1e3+this.startTime:0}),uR(0,ut,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),uR(0,ut,"volume",function(){return this._volume},function(uW){this.isStopped||(this._volume=uW,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(uW,this.context.currentTime,.1):this.gain.gain.value=uW)}),uj._tryCleanFailed=!1,uj}(),u$W=function(uW){function uj(){uj.__super.call(this),this._w=0,this._h=0}ue(uj,"laya.resource.Bitmap",ucW);var ut=uj.prototype;return uR(0,ut,"width",function(){return this._w}),uR(0,ut,"height",function(){return this._h}),uR(0,ut,"source",function(){return this._source}),uj}(),ueW=function(uj){function uW(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,uW.__super.call(this),this._interval=ud.animationInterval,this._setUpNoticeType(1)}ue(uW,"laya.display.AnimationPlayerBase",uj);var ut=uW.prototype;return ut.play=function(uW,uj,ut,ud){void 0===uW&&(uW=0),void 0===uj&&(uj=!0),void 0===ut&&(ut=""),void 0===ud&&(ud=!0),this._isPlaying=!0,this.index="string"==typeof uW?this._getFrameByLabel(uW):uW,this.loop=uj,this._actionName=ut,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},ut._getFrameByLabel=function(uW){var uj=0;for(uj=0;uj<this._count;uj++)if(this._labels[uj]&&0<=this._labels[uj].indexOf(uW))return uj;return 0},ut._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},ut._setControlNode=function(uW){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=uW)&&uW!=this&&(uW.on("display",this,this._checkResumePlaying),uW.on("undisplay",this,this._checkResumePlaying))},ut._setDisplay=function(uW){uj.prototype._setDisplay.call(this,uW),this._checkResumePlaying()},ut._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},ut.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},ut.addLabel=function(uW,uj){this._labels||(this._labels={}),this._labels[uj]||(this._labels[uj]=[]),this._labels[uj].push(uW)},ut.removeLabel=function(uW){if(uW){if(this._labels)for(var uj in this._labels)this._removeLabelFromLabelList(this._labels[uj],uW)}else this._labels=null},ut._removeLabelFromLabelList=function(uW,uj){if(uW)for(var ut=uW.length-1;0<=ut;ut--)uW[ut]==uj&&uW.splice(ut,1)},ut.gotoAndStop=function(uW){this.index="string"==typeof uW?this._getFrameByLabel(uW):uW,this.stop()},ut._displayToIndex=function(uW){},ut.clear=function(){this.stop(),this._labels=null},uR(0,ut,"interval",function(){return this._interval},function(uW){this._interval!=uW&&(this._frameRateChanged=!0,this._interval=uW,this._isPlaying&&0<uW&&this.timerLoop(uW,this,this._frameLoop,null,!0,!0))}),uR(0,ut,"isPlaying",function(){return this._isPlaying}),uR(0,ut,"index",function(){return this._index},function(uW){if(this._index=uW,this._displayToIndex(uW),this._labels&&this._labels[uW])for(var uj=this._labels[uW],ut=0,ud=uj.length;ut<ud;ut++)this.event("label",uj[ut])}),uR(0,ut,"count",function(){return this._count}),uW.WRAP_POSITIVE=0,uW.WRAP_REVERSE=1,uW.WRAP_PINGPONG=2,uW}(umW),uKW=function(uj){function uT(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,uT.__super.call(this),this.overflow=uT.VISIBLE,this._style=new ujW(this),this._style.wordWrap=!1}ue(uT,"laya.display.Text",uj);var uW=uT.prototype;return uW.destroy=function(uW){void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,uW),this._lines=null,this._words&&(this._words.length=0,this._words=null)},uW._getBoundPointsM=function(uW){void 0===uW&&(uW=!1);var uj=uC.TEMP;return uj.setTo(0,0,this.width,this.height),uj._getBoundPoints()},uW.getGraphicBounds=function(uW){void 0===uW&&(uW=!1);var uj=uC.TEMP;return uj.setTo(0,0,this.width,this.height),uj},uW._getCSSStyle=function(){return this._style},uW.lang=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR){if(uW=uT.langPacks&&uT.langPacks[uW]?uT.langPacks[uW]:uW,arguments.length<2)this._text=uW;else{for(var um=0,uQ=arguments.length;um<uQ;um++)uW=uW.replace("{"+um+"}",arguments[um+1]);this._text=uW}},uW._isPassWordMode=function(){var uW=this._style.password;return"prompt"in this&&this.prompt==this._text&&(uW=!1),uW},uW._getPassWordTxt=function(uW){var uj;uj="";for(var ut=uW.length;0<ut;ut--)uj+="●";return uj},uW.renderText=function(uW,uj){var ut=this.graphics;ut.clear(!0);var ud=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(uY.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);uY.context.font=ud;var ub=this.padding,uE=ub[3],uO="left",uq=this._lines,uA=this.leading+this._charSize.height,uc=this._currBitmapFont;uc&&(uA=this.leading+uc.getMaxHeight());var uR=ub[0];if(!uc&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(uO="right",uE=this._width-ub[1]):"center"==this.align&&(uO="center",uE=.5*this._width+ub[3]-ub[1])),0<this._height){var um=this._textHeight>this._height?"top":this.valign;"middle"===um?uR=.5*(this._height-uj*uA)+ub[0]-ub[2]:"bottom"===um&&(uR=this._height-uj*uA-ub[2])}var uQ=this._style;if(uc&&uc.autoScaleSize)var uT=uc.fontSize/this.fontSize;if(this._clipPoint)if(ut.save(),uc&&uc.autoScaleSize){var u$=0,ue=0;u$=this._width?this._width-ub[3]-ub[1]:this._textWidth,ue=this._height?this._height-ub[0]-ub[2]:this._textHeight,u$*=uT,ue*=uT,ut.clipRect(ub[3],ub[0],u$,ue)}else ut.clipRect(ub[3],ub[0],this._width?this._width-ub[3]-ub[1]:this._textWidth,this._height?this._height-ub[0]-ub[2]:this._textHeight);var uK=uQ.password;"prompt"in this&&this.prompt==this._text&&(uK=!1);for(var uo=0,uS=0,uM=Math.min(this._lines.length,uj+uW)||1,uZ=uW;uZ<uM;uZ++){var uX,u_=uq[uZ];if(uK){var uN=u_.length;u_="";for(var uz=uN;0<uz;uz--)u_+="●"}if(uo=uE-(this._clipPoint?this._clipPoint.x:0),uS=uR+uA*uZ-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(uO,uo,uS,uZ),uc){var uC=this.width;uc.autoScaleSize&&(uC=this.width*uT),uc.drawText(u_,this,uo,uS,this.align,uC)}else uy.isWebGL?(this._words||(this._words=[]),(uX=this._words.length>uZ-uW?this._words[uZ-uW]:new uF).setText(u_)):uX=u_,uQ.stroke?ut.fillBorderText(uX,uo,uS,ud,this.color,uQ.strokeColor,uQ.stroke,uO):ut.fillText(uX,uo,uS,ud,this.color,uO)}if(uc&&uc.autoScaleSize){var uL=1/uT;this.scale(uL,uL)}this._clipPoint&&ut.restore(),this._startX=uE,this._startY=uR},uW.drawUnderline=function(uW,uj,ut,ud){var ub=this._lineWidths[ud];switch(uW){case"center":uj-=ub/2;break;case"right":uj-=ub}ut+=this._charSize.height,this._graphics.drawLine(uj,ut,uj+ub,ut,this.underlineColor||this.color,1)},uW.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);uY.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new uz(0,0)):this._clipPoint=null;var uW=this._lines.length;if(this.overflow!=uT.VISIBLE){var uj=this.overflow==uT.HIDDEN?Math.floor:Math.ceil;uW=Math.min(uW,uj((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var ut=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(ut,uW),this.repaint()},uW.evalTextSize=function(){var uW,uj=NaN;uW=Math.max.apply(this,this._lineWidths),uj=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],uW==this._textWidth&&uj==this._textHeight||(this._textWidth=uW,this._textHeight=uj,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},uW.checkEnabledViewportOrNot=function(){return this.overflow==uT.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},uW.changeText=function(uW){this._text!==uW&&(this.lang(uW+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},uW.parseLines=function(uW){var uj=this.wordWrap||this.overflow==uT.HIDDEN;if(uj)var ut=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var ud=uY.context.measureText(uT._testWord);uy.isConchApp&&0===ud.width&&0===ud.height&&(ud=uY.context.measureText("W")),this._charSize.width=ud.width,this._charSize.height=ud.height||this.fontSize}for(var ub=uW.replace(/\r\n/g,"\n").split("\n"),uE=0,uO=ub.length;uE<uO;uE++){var uq=ub[uE];uj?this.parseLine(uq,ut):(this._lineWidths.push(this.getTextWidth(uq)),this._lines.push(uq))}},uW.parseLine=function(uW,uj){uY.context;var ut,ud=this._lines,ub=0,uE=NaN,uO=NaN,uq=0;if((uE=this.getTextWidth(uW))<=uj)return ud.push(uW),void this._lineWidths.push(uE);uE=this._charSize.width,0==(ub=Math.floor(uj/uE))&&(ub=1),uO=uE=this.getTextWidth(uW.substring(0,ub));for(var uA=ub,uc=uW.length;uA<uc;uA++)if(uj<(uO+=uE=this.getTextWidth(uW.charAt(uA))))if(this.wordWrap){var uR=uW.substring(uq,uA);if(uR.charCodeAt(uR.length-1)<255?(ut=/(?:\w|-)+$/.exec(uR))&&(uA=ut.index+uq,0==ut.index?uA+=uR.length:uR=uW.substring(uq,uA)):uT.RightToLeft&&(ut=/([\u0600-\u06FF])+$/.exec(uR))&&(uA=ut.index+uq,0==ut.index?uA+=uR.length:uR=uW.substring(uq,uA)),ud.push(uR),this._lineWidths.push(uO-uE),!((uq=uA)+ub<uc)){ud.push(uW.substring(uq,uc)),this._lineWidths.push(this.getTextWidth(ud[ud.length-1])),uq=-1;break}uA+=ub,uO=uE=this.getTextWidth(uW.substring(uq,uA)),uA--}else if(this.overflow==uT.HIDDEN)return ud.push(uW.substring(0,uA)),void this._lineWidths.push(this.getTextWidth(ud[ud.length-1]));this.wordWrap&&-1!=uq&&(ud.push(uW.substring(uq,uc)),this._lineWidths.push(this.getTextWidth(ud[ud.length-1])))},uW.getTextWidth=function(uW){return this._currBitmapFont?this._currBitmapFont.getTextWidth(uW):uY.context.measureText(uW).width},uW.getWordWrapWidth=function(){var uW=this.padding,uj=NaN;return(uj=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(uj=this.wordWrap?100:uY.width),uj<=0&&(uj=100),uj-uW[3]-uW[1]},uW.getCharPoint=function(uW,uj){this._isChanged&&uN.timer.runCallLater(this,this.typeset);for(var ut=0,ud=this._lines,ub=0,uE=0,uO=ud.length;uE<uO;uE++){if(uW<(ut+=ud[uE].length)){var uq=uE;break}ub=ut}var uA=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;uY.context.font=uA;var uc=this.getTextWidth(this._text.substring(ub,uW));return(uj||new uz).setTo(this._startX+uc-(this._clipPoint?this._clipPoint.x:0),this._startY+uq*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},uR(0,uW,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(uW){uW!=this._width&&(uN.superSet(umW,this,"width",uW),this.isChanged=!0)}),uR(0,uW,"textWidth",function(){return this._isChanged&&uN.timer.runCallLater(this,this.typeset),this._textWidth}),uR(0,uW,"height",function(){return this._height?this._height:this.textHeight},function(uW){uW!=this._height&&(uN.superSet(umW,this,"height",uW),this.isChanged=!0)}),uR(0,uW,"textHeight",function(){return this._isChanged&&uN.timer.runCallLater(this,this.typeset),this._textHeight}),uR(0,uW,"padding",function(){return this._getCSSStyle().padding},function(uW){this._getCSSStyle().padding=uW,this.isChanged=!0}),uR(0,uW,"bold",function(){return this._getCSSStyle().bold},function(uW){this._getCSSStyle().bold=uW,this.isChanged=!0}),uR(0,uW,"text",function(){return this._text||""},function(uW){this._text!==uW&&(this.lang(uW+""),this.isChanged=!0,this.event("change"))}),uR(0,uW,"color",function(){return this._getCSSStyle().color},function(uW){this._getCSSStyle().color!=uW&&(this._getCSSStyle().color=uW,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),uR(0,uW,"font",function(){return this._getCSSStyle().fontFamily},function(uW){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),uT._bitmapFonts&&uT._bitmapFonts[uW]&&(this._currBitmapFont=uT._bitmapFonts[uW]),this._getCSSStyle().fontFamily=uW,this.isChanged=!0}),uR(0,uW,"fontSize",function(){return this._getCSSStyle().fontSize},function(uW){this._getCSSStyle().fontSize=uW,this.isChanged=!0}),uR(0,uW,"italic",function(){return this._getCSSStyle().italic},function(uW){this._getCSSStyle().italic=uW,this.isChanged=!0}),uR(0,uW,"align",function(){return this._getCSSStyle().align},function(uW){this._getCSSStyle().align=uW,this.isChanged=!0}),uR(0,uW,"valign",function(){return this._getCSSStyle().valign},function(uW){this._getCSSStyle().valign=uW,this.isChanged=!0}),uR(0,uW,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(uW){this._getCSSStyle().wordWrap=uW,this.isChanged=!0}),uR(0,uW,"leading",function(){return this._getCSSStyle().leading},function(uW){this._getCSSStyle().leading=uW,this.isChanged=!0}),uR(0,uW,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(uW){this._getCSSStyle().backgroundColor=uW,this.isChanged=!0}),uR(0,uW,"borderColor",function(){return this._getCSSStyle().borderColor},function(uW){this._getCSSStyle().borderColor=uW,this.isChanged=!0}),uR(0,uW,"stroke",function(){return this._getCSSStyle().stroke},function(uW){this._getCSSStyle().stroke=uW,this.isChanged=!0}),uR(0,uW,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(uW){this._getCSSStyle().strokeColor=uW,this.isChanged=!0}),uR(0,uW,"isChanged",null,function(uW){this._isChanged!==uW&&(this._isChanged=uW)&&uN.timer.callLater(this,this.typeset)}),uR(0,uW,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(uW){if(!(this.overflow!=uT.SCROLL||this.textWidth<this._width)&&this._clipPoint){uW=uW<this.padding[3]?this.padding[3]:uW;var uj=this._textWidth-this._width;uW=uj<uW?uj:uW;var ut=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=uW,this.renderText(this._lastVisibleLineIndex,ut)}}),uR(0,uW,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(uW){if(!(this.overflow!=uT.SCROLL||this.textHeight<this._height)&&this._clipPoint){uW=uW<this.padding[0]?this.padding[0]:uW;var uj=this._textHeight-this._height,ut=(uW=uj<uW?uj:uW)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=ut;var ud=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=uW,this.renderText(ut,ud)}}),uR(0,uW,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),uR(0,uW,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),uR(0,uW,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),uR(0,uW,"underlineColor",function(){return this._underlineColor},function(uW){this._underlineColor=uW,this._isChanged=!0,this.typeset()}),uT.registerBitmapFont=function(uW,uj){uT._bitmapFonts||(uT._bitmapFonts={}),uT._bitmapFonts[uW]=uj},uT.unregisterBitmapFont=function(uW,uj){if(void 0===uj&&(uj=!0),uT._bitmapFonts&&uT._bitmapFonts[uW]){var ut=uT._bitmapFonts[uW];uj&&ut.destroy(),delete uT._bitmapFonts[uW]}},uT.setTextRightToLeft=function(){var uW;(uW=uY.canvas.source.style).display="none",uW.position="absolute",uW.direction="rtl",uy._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,uY.document.body.appendChild(uY.canvas.source)},uT.supportFont=function(uW){uY.context.font="10px sans-serif";var uj=uY.context.measureText("abcji").width;uY.context.font="10px "+uW;var ut=uY.context.measureText("abcji").width;return console.log(uj,ut),uj!==ut},uT._testWord="游",uT.langPacks=null,uT.VISIBLE="visible",uT.SCROLL="scroll",uT.HIDDEN="hidden",uT.CharacterCache=!0,uT.RightToLeft=!1,uT._bitmapFonts=null,uA(uT,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),uT}(umW),uoW=function(um){function uO(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",uO.__super.call(this),this.offset=new uz,this._canvasTransform=new ul,this._previousOrientation=uY.window.orientation;var uj=this;this.transform=ul.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var uW=uY.window,ut=this;uW.addEventListener("focus",function(){uj._isFocused=!0,ut.event("focus"),ut.event("focuschange")}),uW.addEventListener("blur",function(){uj._isFocused=!1,ut.event("blur"),ut.event("focuschange"),ut._isInputting()&&(uXW.inputElement.target.focus=!1)});var ud="visibilityState",ub="visibilitychange",uE=uW.document;void 0!==uE.hidden?(ub="visibilitychange",ud="visibilityState"):void 0!==uE.mozHidden?(ub="mozvisibilitychange",ud="mozVisibilityState"):void 0!==uE.msHidden?(ub="msvisibilitychange",ud="msVisibilityState"):void 0!==uE.webkitHidden&&(ub="webkitvisibilitychange",ud="webkitVisibilityState"),uW.document.addEventListener(ub,function(){"hidden"==uY.document[ud]?ut._setStageVisible(!1):ut._setStageVisible(!0)}),uW.document.addEventListener("qbrowserVisibilityChange",function(uW){ut._setStageVisible(!uW.hidden)}),uW.addEventListener("resize",function(){var uW=uY.window.orientation;null!=uW&&uW!=uj._previousOrientation&&ut._isInputting()&&(uXW.inputElement.target.focus=!1),uj._previousOrientation=uW,ut._isInputting()||ut._resetCanvas()}),uW.addEventListener("orientationchange",function(uW){ut._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),uY.onMobile&&this.on("mousedown",this,this._onmouseMove)}ue(uO,"laya.display.Stage",um);var uW=uO.prototype;return uW._setStageVisible=function(uW){this._isVisibility!=uW&&(this._isVisibility=uW,this._isVisibility||this._isInputting()&&(uXW.inputElement.target.focus=!1),this.event("visibilitychange"))},uW._isInputting=function(){return uY.onMobile&&uXW.isInputting},uW._changeCanvasSize=function(){this.setScreenSize(uY.clientWidth*uY.pixelRatio,uY.clientHeight*uY.pixelRatio)},uW._resetCanvas=function(){if(this.screenAdaptationEnabled){var uW=uy._mainCanvas;uW.source.style;uW.size(1,1),uN.timer.once(100,this,this._changeCanvasSize)}},uW.setScreenSize=function(uW,uj){var ut=!1;if("none"!==this._screenMode&&(ut=(uW/uj<1?"vertical":"horizontal")!==this._screenMode)){var ud=uj;uj=uW,uW=ud}this.canvasRotation=ut;var ub=uy._mainCanvas,uE=ub.source.style,uO=this._canvasTransform.identity(),uq=this._scaleMode,uA=uW/this.designWidth,uc=uj/this.designHeight,uR=this.designWidth,um=this.designHeight,uQ=uW,uT=uj,u$=uY.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,uq){case"noscale":uA=uc=1,uQ=this.designWidth,uT=this.designHeight;break;case"showall":uA=uc=Math.min(uA,uc),uR=uQ=Math.round(this.designWidth*uA),um=uT=Math.round(this.designHeight*uc);break;case"noborder":uA=uc=Math.max(uA,uc),uQ=Math.round(this.designWidth*uA),uT=Math.round(this.designHeight*uc);break;case"full":uA=uc=1,this._width=uR=uW,this._height=um=uj;break;case"fixedwidth":uc=uA,this._height=um=Math.round(uj/uA);break;case"fixedheight":uA=uc,this._width=uR=Math.round(uW/uc);break;case"fixedauto":uW/uj<this.designWidth/this.designHeight?(uc=uA,this._height=um=Math.round(uj/uA)):(uA=uc,this._width=uR=Math.round(uW/uc))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,uR=uR+1&2147483646,um=um+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),uA*=this.scaleX,uc*=this.scaleY,1===uA&&1===uc?this.transform.identity():(this.transform.a=this._formatData(uA/(uQ/uR)),this.transform.d=this._formatData(uc/(uT/um)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),ub.size(uR,um),uG.changeWebGLSize(uR,um),uO.scale(uQ/uR/u$,uT/um/u$),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(uW-uQ)/u$:this.offset.x=.5*(uW-uQ)/u$,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(uj-uT)/u$:this.offset.y=.5*(uj-uT)/u$,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),uO.translate(this.offset.x,this.offset.y),this.canvasDegree=0,ut&&("horizontal"===this._screenMode?(uO.rotate(Math.PI/2),uO.translate(uj/u$,0),this.canvasDegree=90):(uO.rotate(-Math.PI/2),uO.translate(0,uW/u$),this.canvasDegree=-90)),uO.a=this._formatData(uO.a),uO.d=this._formatData(uO.d),uO.tx=this._formatData(uO.tx),uO.ty=this._formatData(uO.ty),uE.transformOrigin=uE.webkitTransformOrigin=uE.msTransformOrigin=uE.mozTransformOrigin=uE.oTransformOrigin="0px 0px 0px",uE.transform=uE.webkitTransform=uE.msTransform=uE.mozTransform=uE.oTransform="matrix("+uO.toString()+")",uO.translate(parseInt(uE.left)||0,parseInt(uE.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},uW._formatData=function(uW){return Math.abs(uW)<1e-6?0:Math.abs(1-uW)<.001?0<uW?1:-1:uW},uW.getMousePoint=function(){return uz.TEMP.setTo(this.mouseX,this.mouseY)},uW.repaint=function(){this._repaint=1},uW.parentRepaint=function(){},uW._loop=function(){return this.render(uy.context,0,0),!0},uW._onmouseMove=function(uW){this._mouseMoveTime=uY.now()},uW.getTimeFromFrameStart=function(){return uY.now()-this._frameStartTime},uW.render=function(uW,uj,ut){if("sleep"===this._frameRate&&!uy.isConchApp){var ud=uY.now();if(!(1e3<=ud-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(uP.loopCount++,u$.instance.runEvent(),uN.timer._update()));this._frameStartTime=ud}if(this._renderCount++,uy.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=uY.now();var ub="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),uE=this._renderCount%2==0;if(uP.renderSlow=!ub,ub||uE||uy.isConchApp){var uO;uP.loopCount++,u$.instance.runEvent(),uN.timer._update(),uG.update3DLoop();var uq=0,uA=0;if(uy.isConchNode)for(uq=0,uA=this._scenes.length;uq<uA;uq++)(uO=this._scenes[uq])&&uO._updateSceneConch();else for(uq=0,uA=this._scenes.length;uq<uA;uq++)(uO=this._scenes[uq])&&uO._updateScene();if(uy.isConchNode){var uc=umW.CustomList;for(uq=0,uA=uc.length;uq<uA;uq++){var uR=uc[uq];uR.customRender(uR.customContext,0,0)}return}}uy.isConchNode||this.renderingEnabled&&(ub||!uE||uy.isConchWebGL)&&(uy.isWebGL?uy.WebGL.mainContext&&!uy.WebGL.mainContext.isContextLost()&&(uW.clear(),um.prototype.render.call(this,uW,uj,ut),uP._show&&uP._sp&&uP._sp.render(uW,uj,ut),uG.clear(this._bgColor),uG.beginFlush(),uW.flush(),uG.endFinish(),uk.instance&&uk.getInstance().endDispose()):(uG.clear(this._bgColor),um.prototype.render.call(this,uW,uj,ut),uP._show&&uP._sp&&uP._sp.render(uW,uj,ut)))}else this._renderCount%5==0&&(uP.loopCount++,u$.instance.runEvent(),uN.timer._update())},uW._requestFullscreen=function(){var uW=uY.document.documentElement;uW.requestFullscreen?uW.requestFullscreen():uW.mozRequestFullScreen?uW.mozRequestFullScreen():uW.webkitRequestFullscreen?uW.webkitRequestFullscreen():uW.msRequestFullscreen&&uW.msRequestFullscreen()},uW._fullScreenChanged=function(){uN.stage.event("fullscreenchange")},uW.exitFullscreen=function(){var uW=uY.document;uW.exitFullscreen?uW.exitFullscreen():uW.mozCancelFullScreen?uW.mozCancelFullScreen():uW.webkitExitFullscreen&&uW.webkitExitFullscreen()},uR(0,uW,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),uR(0,uW,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),uR(0,uW,"frameRate",function(){return this._frameRate},function(uW){if(this._frameRate=uW,uy.isConchApp)switch(this._frameRate){case"slow":uY.window.conch&&uY.window.conchConfig.setSlowFrame&&uY.window.conchConfig.setSlowFrame(!0);break;case"fast":uY.window.conch&&uY.window.conchConfig.setSlowFrame&&uY.window.conchConfig.setSlowFrame(!1);break;case"mouse":uY.window.conch&&uY.window.conchConfig.setMouseFrame&&uY.window.conchConfig.setMouseFrame(2e3);break;case"sleep":uY.window.conch&&uY.window.conchConfig.setLimitFPS&&uY.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),uR(0,uW,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),uR(0,uW,"width",um.prototype._$get_width,function(uW){this.designWidth=uW,uN.superSet(umW,this,"width",uW),uN.timer.callLater(this,this._changeCanvasSize)}),uR(0,uW,"alignH",function(){return this._alignH},function(uW){this._alignH=uW,uN.timer.callLater(this,this._changeCanvasSize)}),uR(0,uW,"isFocused",function(){return this._isFocused}),uR(0,uW,"height",um.prototype._$get_height,function(uW){this.designHeight=uW,uN.superSet(umW,this,"height",uW),uN.timer.callLater(this,this._changeCanvasSize)}),uR(0,uW,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||ul.create()},um.prototype._$set_transform),uR(0,uW,"isVisibility",function(){return this._isVisibility}),uR(0,uW,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),uR(0,uW,"scaleMode",function(){return this._scaleMode},function(uW){this._scaleMode=uW,uN.timer.callLater(this,this._changeCanvasSize)}),uR(0,uW,"alignV",function(){return this._alignV},function(uW){this._alignV=uW,uN.timer.callLater(this,this._changeCanvasSize)}),uR(0,uW,"bgColor",function(){return this._bgColor},function(uW){this._bgColor=uW,this.conchModel&&this.conchModel.bgColor(uW),uy.isWebGL&&(uW?uO._wgColor=uf.create(uW)._color:uY.onMiniGame||(uO._wgColor=null)),uY.onLimixiu?uO._wgColor=uf.create(uW)._color:uy.canvas.style.background=uW||"none"}),uR(0,uW,"mouseX",function(){return Math.round(u$.instance.mouseX/this.clientScaleX)}),uR(0,uW,"mouseY",function(){return Math.round(u$.instance.mouseY/this.clientScaleY)}),uR(0,uW,"screenMode",function(){return this._screenMode},function(uW){this._screenMode=uW}),uR(0,uW,"visible",um.prototype._$get_visible,function(uW){this.visible!==uW&&(uN.superSet(umW,this,"visible",uW),uy._mainCanvas.source.style.visibility=uW?"visible":"hidden")}),uR(0,uW,"fullScreenEnabled",null,function(uW){var uj=uY.document,ut=uy.canvas;uW?(ut.addEventListener("mousedown",this._requestFullscreen),ut.addEventListener("touchstart",this._requestFullscreen),uj.addEventListener("fullscreenchange",this._fullScreenChanged),uj.addEventListener("mozfullscreenchange",this._fullScreenChanged),uj.addEventListener("webkitfullscreenchange",this._fullScreenChanged),uj.addEventListener("msfullscreenchange",this._fullScreenChanged)):(ut.removeEventListener("mousedown",this._requestFullscreen),ut.removeEventListener("touchstart",this._requestFullscreen),uj.removeEventListener("fullscreenchange",this._fullScreenChanged),uj.removeEventListener("mozfullscreenchange",this._fullScreenChanged),uj.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),uj.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),uO.SCALE_NOSCALE="noscale",uO.SCALE_EXACTFIT="exactfit",uO.SCALE_SHOWALL="showall",uO.SCALE_NOBORDER="noborder",uO.SCALE_FULL="full",uO.SCALE_FIXED_WIDTH="fixedwidth",uO.SCALE_FIXED_HEIGHT="fixedheight",uO.SCALE_FIXED_AUTO="fixedauto",uO.ALIGN_LEFT="left",uO.ALIGN_RIGHT="right",uO.ALIGN_CENTER="center",uO.ALIGN_TOP="top",uO.ALIGN_MIDDLE="middle",uO.ALIGN_BOTTOM="bottom",uO.SCREEN_NONE="none",uO.SCREEN_HORIZONTAL="horizontal",uO.SCREEN_VERTICAL="vertical",uO.FRAME_FAST="fast",uO.FRAME_SLOW="slow",uO.FRAME_MOUSE="mouse",uO.FRAME_SLEEP="sleep",uO.FRAME_MOUSE_THREDHOLD=2e3,uA(uO,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),uO}(umW),uSW=(function(uW){function uj(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,uj.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}ue(uj,"laya.media.SoundNode",umW);var ut=uj.prototype;ut._onParentChange=function(){this.target=this.parent},ut.play=function(uW,uj){void 0===uW&&(uW=1),isNaN(uW)&&(uW=1),this.url&&(this.stop(),this._channel=ux.playSound(this.url,uW,null,uj))},ut.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},ut._setPlayAction=function(uW,uj,ut,ud){void 0===ud&&(ud=!0),this[ut]&&uW&&(ud?uW.on(uj,this,this[ut]):uW.off(uj,this,this[ut]))},ut._setPlayActions=function(uW,uj,ut,ud){if(void 0===ud&&(ud=!0),uW&&uj){var ub,uE=uj.split(","),uO=0;for(ub=uE.length,uO=0;uO<ub;uO++)this._setPlayAction(uW,uE[uO],ut,ud)}},uR(0,ut,"playEvent",null,function(uW){(this._playEvents=uW)&&this._tar&&this._setPlayActions(this._tar,uW,"play")}),uR(0,ut,"target",null,function(uW){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=uW,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),uR(0,ut,"stopEvent",null,function(uW){(this._stopEvents=uW)&&this._tar&&this._setPlayActions(this._tar,uW,"stop")})}(),function(uW){function uj(){this._src=null,this._onload=null,this._onerror=null,uj.__super.call(this)}ue(uj,"laya.resource.FileBitmap",u$W);var ut=uj.prototype;return uR(0,ut,"src",function(){return this._src},function(uW){this._src=uW}),uR(0,ut,"onload",null,function(uW){}),uR(0,ut,"onerror",null,function(uW){}),uj}()),uMW=function(uW){function ut(uW,uj){this._is2D=!1,ut.__super.call(this);var ud=this;if(this._source=this,"2D"===uW||"AUTO"===uW&&!uy.isWebGL){this._is2D=!0,this._source=uj||uY.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var ub=this;ub.getContext=function(uW,uj){if(ud._ctx)return ud._ctx;var ut=ud._ctx=ud._source.getContext(uW,uj);return ut&&(ut._canvas=ub,uy.isFlash||uY.onLimixiu||(ut.size=function(uW,uj){})),ut}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}ue(ut,"laya.resource.HTMLCanvas",u$W);var uj=ut.prototype;return uj.clear=function(){this._ctx&&this._ctx.clear()},uj.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},uj.release=function(){},uj._setContext=function(uW){this._ctx=uW},uj.getContext=function(uW,uj){return this._ctx?this._ctx:this._ctx=ut._createContext(this)},uj.getMemSize=function(){return 0},uj.size=function(uW,uj){(this._w!=uW||this._h!=uj||this._source&&(this._source.width!=uW||this._source.height!=uj))&&(this._w=uW,this._h=uj,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(uW,uj),this._source&&(this._source.height=uj,this._source.width=uW))},uj.getCanvas=function(){return this._source},uj.toBase64=function(uW,uj,ut){if(this._source)if(uy.isConchApp&&this._source.toBase64)this._source.toBase64(uW,uj,ut);else{var ud=this._source.toDataURL(uW,uj);ut.call(this,ud)}},uR(0,uj,"context",function(){return this._ctx}),uR(0,uj,"asBitmap",null,function(uW){}),ut.create=function(uW,uj){return new ut(uW,uj)},ut.TYPE2D="2D",ut.TYPE3D="3D",ut.TYPEAUTO="AUTO",ut._createContext=null,ut}(),uZW=(function(uW){function uA(uW,uj,ut,ud,ub,uE,uO,uq){throw uA.__super.call(this),new Error("不允许new！")}ue(uA,"laya.resource.HTMLSubImage",u$W),uA.create=function(uW,uj,ut,ud,ub,uE,uO,uq){return void 0===uq&&(uq=!1),new uA(uW,uj,ut,ud,ub,uE,uO,uq)}}(),function(uW){function um(){this._frames=null,this._url=null,um.__super.call(this),this._setControlNode(this)}ue(um,"laya.display.Animation",uW);var uj=um.prototype;uj.destroy=function(uW){void 0===uW&&(uW=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,uW),this._frames=null,this._labels=null},uj.play=function(uW,uj,ut,ud){void 0===uW&&(uW=0),void 0===uj&&(uj=!0),void 0===ut&&(ut=""),void 0===ud&&(ud=!0),ut&&this._setFramesFromCache(ut,ud),this._isPlaying=!0,this.index="string"==typeof uW?this._getFrameByLabel(uW):uW,this.loop=uj,this._actionName=ut,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},uj._setFramesFromCache=function(uW,uj){var ut;return void 0===uj&&(uj=!1),this._url&&(uW=this._url+"#"+uW),uW&&um.framesMap[uW]?((ut=um.framesMap[uW])instanceof Array?(this._frames=um.framesMap[uW],this._count=this._frames.length):(ut.nodeRoot&&(um.framesMap[uW]=this._parseGraphicAnimationByData(ut),ut=um.framesMap[uW]),this._frames=ut.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=ut.interval),this._labels=this._copyLabels(ut.labels)),!0):(uj&&console.log("ani not found:",uW),!1)},uj._copyLabels=function(uW){if(!uW)return null;var uj,ut;for(ut in uj={},uW)uj[ut]=un.copyArray([],uW[ut]);return uj},uj._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&uW.prototype._frameLoop.call(this)},uj._displayToIndex=function(uW){this._frames&&(this.graphics=this._frames[uW])},uj.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},uj.loadImages=function(uW,uj){return void 0===uj&&(uj=""),this._url="",this._setFramesFromCache(uj)||(this.frames=um.framesMap[uj]?um.framesMap[uj]:um.createFrames(uW,uj)),this},uj.loadAtlas=function(uj,ut,ud){void 0===ud&&(ud=""),this._url="";var ub=this;function uW(uW){uj===uW&&(ub.frames=um.framesMap[ud]?um.framesMap[ud]:um.createFrames(uj,ud),ut&&ut.run())}return ub._setFramesFromCache(ud)||(uqW.getAtlas(uj)?uW(uj):uN.loader.load(uj,uS.create(null,uW,[uj]),null,"atlas")),this},uj.loadAnimation=function(uW,uj,ut){this._url=uW;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,uj&&uj.run()):!ut||uqW.getAtlas(ut)?this._loadAnimationData(uW,uj,ut):uN.loader.load(ut,uS.create(this,this._loadAnimationData,[uW,uj,ut]),null,"atlas"),this},uj._loadAnimationData=function(uq,uA,uW){var uc=this;if(!uW||uqW.getAtlas(uW)){var uR=this;uqW.getRes(uq)?uj(uq):uN.loader.load(uq,uS.create(null,uj,[uq]),null,"json"),uqW.clearRes(uq)}else console.warn("atlas load fail:"+uW);function uj(uW){if(uqW.getRes(uW)&&uq===uW){var uj;if(um.framesMap[uq+"#"])uR._setFramesFromCache(uc._actionName,!0),uc.index=0,uc._checkResumePlaying();else{var ut=uR._parseGraphicAnimation(uqW.getRes(uq));if(!ut)return;var ud,ub=ut.animationList,uE=0,uO=ub.length;for(uE=0;uE<uO;uE++)uj=ub[uE],um.framesMap[uq+"#"+uj.name]=uj,ud||(ud=uj);ud&&(um.framesMap[uq+"#"]=ud,uR._setFramesFromCache(uc._actionName,!0),uc.index=0),uc._checkResumePlaying()}uA&&uA.run()}}},uj._parseGraphicAnimation=function(uW){return uNW.parseAnimationData(uW)},uj._parseGraphicAnimationByData=function(uW){return uNW.parseAnimationByData(uW)},uR(0,uj,"frames",function(){return this._frames},function(uW){(this._frames=uW)&&(this._count=uW.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),uR(0,uj,"autoPlay",null,function(uW){uW?this.play():this.stop()}),uR(0,uj,"source",null,function(uW){-1<uW.indexOf(".ani")?this.loadAnimation(uW):-1<uW.indexOf(".json")||-1<uW.indexOf("als")||-1<uW.indexOf("atlas")?this.loadAtlas(uW):this.loadImages(uW.split(","))}),uR(0,uj,"autoAnimation",null,function(uW){this.play(0,!0,uW,!1)}),um.createFrames=function(uW,uj){var ut,ud,ub=0,uE=0;if("string"==typeof uW){var uO=uqW.getAtlas(uW);if(uO&&uO.length)for(ut=[],ub=0,uE=uO.length;ub<uE;ub++)(ud=new uG.createGraphics).drawTexture(uqW.getRes(uO[ub]),0,0),ut.push(ud)}else if(uW instanceof Array)for(ut=[],ub=0,uE=uW.length;ub<uE;ub++)(ud=new uG.createGraphics).loadImage(uW[ub],0,0),ut.push(ud);return uj&&(um.framesMap[uj]=ut),ut},um.clearCache=function(uW){var uj,ut=um.framesMap,ud=uW+"#";for(uj in ut)uj!==uW&&0!=uj.indexOf(ud)||delete um.framesMap[uj]},um.framesMap={}}(ueW),function(uW){function uE(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,uE.__super.call(this),null==uE._sortIndexFun&&(uE._sortIndexFun=u_.sortByKey("index",!1,!0))}ue(uE,"laya.display.FrameAnimation",uW);var uj=uE.prototype;return uj._setUp=function(uW,uj){this._labels=null,this._animationNewFrames=null,this._targetDic=uW,this._animationData=uj,this.interval=1e3/uj.frameRate,uj.parsed?(this._count=uj.count,this._labels=uj.labels,this._animationNewFrames=uj.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),uj.parsed=!0,uj.labels=this._labels,uj.count=this._count,uj.animationNewFrames=this._animationNewFrames},uj.clear=function(){uW.prototype.clear.call(this),this._targetDic=null,this._animationData=null},uj._displayToIndex=function(uW){if(this._animationData){uW<0&&(uW=0),uW>this._count&&(uW=this._count);var uj=this._animationData.nodes,ut=0,ud=uj.length;for(ut=0;ut<ud;ut++)this._displayNodeToFrame(uj[ut],uW)}},uj._displayNodeToFrame=function(uW,uj,ut){ut||(ut=this._targetDic);var ud=ut[uW.target];if(ud){var ub,uE,uO,uq=uW.frames,uA=uW.keys,uc=0,uR=uA.length;for(uc=0;uc<uR;uc++)uO=(uE=uq[ub=uA[uc]]).length>uj?uE[uj]:uE[uE.length-1],ud[ub]=uO}},uj._calculateDatas=function(){if(this._animationData){var uW,uj=this._animationData.nodes,ut=0,ud=uj.length;for(ut=this._count=0;ut<ud;ut++)uW=uj[ut],this._calculateNodeKeyFrames(uW);this._count+=1}},uj._calculateNodeKeyFrames=function(uW){var uj,ut,ud=uW.keyframes,ub=uW.target;for(uj in uW.frames||(uW.frames={}),uW.keys?uW.keys.length=0:uW.keys=[],uW.initValues||(uW.initValues={}),ud)ut=ud[uj],uW.frames[uj]||(uW.frames[uj]=[]),this._targetDic&&this._targetDic[ub]&&(uW.initValues[uj]=this._targetDic[ub][uj]),ut.sort(uE._sortIndexFun),uW.keys.push(uj),this._calculateNodePropFrames(ut,uW.frames[uj],uj,ub)},uj.resetToInitState=function(){if(this._targetDic&&this._animationData){var uW,uj,ut=this._animationData.nodes,ud=0,ub=ut.length;for(ud=0;ud<ub;ud++)if(uj=(uW=ut[ud]).initValues){var uE,uO=this._targetDic[uW.target];if(uO)for(uE in uj)uO[uE]=uj[uE]}}},uj._calculateNodePropFrames=function(uW,uj,ut,ud){var ub=0,uE=uW.length-1;if(0<uE){for(uj.length=uW[uE].index+1,ub=0;ub<uE;ub++)this._dealKeyFrame(uW[ub]),this._calculateFrameValues(uW[ub],uW[ub+1],uj);this._dealKeyFrame(uW[ub])}0==uE&&(uj[uW[0].index]=uW[0].value,this._animationNewFrames&&(this._animationNewFrames[uW[0].index]=!0))},uj._dealKeyFrame=function(uW){uW.label&&""!=uW.label&&this.addLabel(uW.label,uW.index)},uj._calculateFrameValues=function(uW,uj,ut){var ud,ub=0,uE=uW.index,uO=uj.index,uq=uW.value,uA=uj.value-uW.value,uc=uO-uE;if(uO>this._count&&(this._count=uO),uW.tween)for(null==(ud=uU[uW.tweenMethod])&&(ud=uU.linearNone),ub=uE;ub<uO;ub++)ut[ub]=ud(ub-uE,uq,uA,uc),this._animationNewFrames&&(this._animationNewFrames[ub]=!0);else for(ub=uE;ub<uO;ub++)ut[ub]=uq;this._animationNewFrames&&(this._animationNewFrames[uW.index]=!0,this._animationNewFrames[uj.index]=!0),ut[uj.index]=uj.value},uE._sortIndexFun=null,uE}(ueW)),uXW=function(uj){function ub(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",ub.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=uKW.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}ue(ub,"laya.display.Input",uj);var uW=ub.prototype;return uW.setSelection=function(uW,uj){this.focus=!0,laya.display.Input.inputElement.selectionStart=uW,laya.display.Input.inputElement.selectionEnd=uj},uW._onUnDisplay=function(uW){this.focus=!1},uW._onMouseDown=function(uW){this.focus=!0},uW._syncInputTransform=function(){var uW=this.nativeInput,uj=un.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),ut=this._width-this.padding[1]-this.padding[3],ud=this._height-this.padding[0]-this.padding[2];uy.isConchApp?(uW.setScale(uj.scaleX,uj.scaleY),uW.setSize(ut,ud),uW.setPos(uj.x,uj.y)):(ub.inputContainer.style.transform=ub.inputContainer.style.webkitTransform="scale("+uj.scaleX+","+uj.scaleY+") rotate("+uN.stage.canvasDegree+"deg)",uW.style.width=ut+"px",uW.style.height=ud+"px",ub.inputContainer.style.left=uj.x+"px",ub.inputContainer.style.top=uj.y+"px")},uW.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},uW._setInputMethod=function(){ub.input.parentElement&&ub.inputContainer.removeChild(ub.input),ub.area.parentElement&&ub.inputContainer.removeChild(ub.area),ub.inputElement=this._multiline?ub.area:ub.input,ub.inputContainer.appendChild(ub.inputElement),uKW.RightToLeft&&(ub.inputElement.style.direction="rtl")},uW._focusIn=function(){laya.display.Input.isInputting=!0;var uW=this.nativeInput;this._focus=!0;var uj=uW.style;uj.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),uW.readOnly=!this._editable,uy.isConchApp&&(uW.setType(this._type),uW.setForbidEdit(!this._editable)),uW.maxLength=this._maxChars;this.padding;if(uW.type=this._type,uW.value=this._content,uW.placeholder=this._prompt,uN.stage.off("keydown",this,this._onKeyDown),uN.stage.on("keydown",this,this._onKeyDown),(uN.stage.focus=this).event("focus"),uY.onPC&&uW.focus(),!uY.onMiniGame){this._text;this._text=null}this.typeset(),uW.setColor(this._originColor),uW.setFontSize(this.fontSize),uW.setFontFace(uY.onIPhone&&uKW._fontFamilyMap[this.font]||this.font),uy.isConchApp&&uW.setMultiAble&&uW.setMultiAble(this._multiline),uj.lineHeight=this.leading+this.fontSize+"px",uj.fontStyle=this.italic?"italic":"normal",uj.fontWeight=this.bold?"bold":"normal",uj.textAlign=this.align,uj.padding="0 0",this._syncInputTransform(),!uy.isConchApp&&uY.onPC&&uN.timer.frameLoop(1,this,this._syncInputTransform)},uW._setPromptColor=function(){(ub.promptStyleDOM=uY.getElementById("promptStyle"))||((ub.promptStyleDOM=uY.createElement("style")).setAttribute("id","promptStyle"),uY.document.head.appendChild(ub.promptStyleDOM)),ub.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},uW._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(uN.superSet(uKW,this,"text",this._content),uN.superSet(uKW,this,"color",this._originColor)):(uN.superSet(uKW,this,"text",this._prompt),uN.superSet(uKW,this,"color",this._promptColor)),uN.stage.off("keydown",this,this._onKeyDown),uN.stage.focus=null,this.event("blur"),uy.isConchApp&&this.nativeInput.blur(),uY.onPC&&uN.timer.clear(this,this._syncInputTransform)},uW._onKeyDown=function(uW){13===uW.keyCode&&(uY.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},uW.changeText=function(uW){this._content=uW,this._focus?(this.nativeInput.value=uW||"",this.event("change")):uj.prototype.changeText.call(this,uW)},uR(0,uW,"color",uj.prototype._$get_color,function(uW){this._focus&&this.nativeInput.setColor(uW),uN.superSet(uKW,this,"color",this._content?uW:this._promptColor),this._originColor=uW}),uR(0,uW,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(uW){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),uR(0,uW,"multiline",function(){return this._multiline},function(uW){this._multiline=uW,this.valign=uW?"top":"middle"}),uR(0,uW,"maxChars",function(){return this._maxChars},function(uW){uW<=0&&(uW=1e5),this._maxChars=uW}),uR(0,uW,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(uW){uN.superSet(uKW,this,"color",this._originColor),uW+="",this._focus?(this.nativeInput.value=uW||"",this.event("change")):(this._multiline||(uW=uW.replace(/\r?\n/g,"")),(this._content=uW)?uN.superSet(uKW,this,"text",uW):(uN.superSet(uKW,this,"text",this._prompt),uN.superSet(uKW,this,"color",this.promptColor)))}),uR(0,uW,"nativeInput",function(){return this._multiline?ub.area:ub.input}),uR(0,uW,"prompt",function(){return this._prompt},function(uW){!this._text&&uW&&uN.superSet(uKW,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?uN.superSet(uKW,this,"text",this._text==this._prompt?uW:this._text):uN.superSet(uKW,this,"text",uW),this._prompt=uKW.langPacks&&uKW.langPacks[uW]?uKW.langPacks[uW]:uW}),uR(0,uW,"focus",function(){return this._focus},function(uW){var uj=this.nativeInput;this._focus!==uW&&(uW?(uj.target?uj.target._focusOut():this._setInputMethod(),(uj.target=this)._focusIn()):(uj.target=null,this._focusOut(),uY.document.body.scrollTop=0,uj.blur(),uy.isConchApp?uj.setPos(-1e4,-1e4):ub.inputContainer.contains(uj)&&ub.inputContainer.removeChild(uj)))}),uR(0,uW,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(uW){uW?(-1<(uW="[^"+uW+"]").indexOf("^^")&&(uW=uW.replace("^^","")),this._restrictPattern=new RegExp(uW,"g")):this._restrictPattern=null}),uR(0,uW,"editable",function(){return this._editable},function(uW){this._editable=uW,uy.isConchApp&&ub.input.setForbidEdit(!uW)}),uR(0,uW,"promptColor",function(){return this._promptColor},function(uW){this._promptColor=uW,this._content||uN.superSet(uKW,this,"color",uW)}),uR(0,uW,"type",function(){return this._type},function(uW){this._getCSSStyle().password="password"==uW,this._type=uW,uy.isConchApp&&this.nativeInput.setType(uW)}),uR(0,uW,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(uW){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),uR(0,uW,"asPassword",function(){return this._getCSSStyle().password},function(uW){this._getCSSStyle().password=uW,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),ub.__init__=function(){ub._createInputElement(),uY.onMobile&&uy.canvas.addEventListener(ub.IOS_IFRAME?uY.onMiniGame?"touchend":"click":"touchend",ub._popupInputMethod)},ub._popupInputMethod=function(uW){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},ub._createInputElement=function(){ub._initInput(ub.area=uY.createElement("textarea")),ub._initInput(ub.input=uY.createElement("input")),(ub.inputContainer=uY.createElement("div")).style.position="absolute",ub.inputContainer.style.zIndex=1e5,uY.container.appendChild(ub.inputContainer),ub.inputContainer.setPos=function(uW,uj){ub.inputContainer.style.left=uW+"px",ub.inputContainer.style.top=uj+"px"}},ub._initInput=function(uj){var uW=uj.style;uW.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",uW.resize="none",uW.backgroundColor="transparent",uW.border="none",uW.outline="none",uW.zIndex=1,uj.addEventListener("input",ub._processInputting),uj.addEventListener("mousemove",ub._stopEvent),uj.addEventListener("mousedown",ub._stopEvent),uj.addEventListener("touchmove",ub._stopEvent),uj.setFontFace=function(uW){uj.style.fontFamily=uW},uy.isConchApp||(uj.setColor=function(uW){uj.style.color=uW},uj.setFontSize=function(uW){uj.style.fontSize=uW+"px"})},ub._processInputting=function(uW){var uj=laya.display.Input.inputElement.target;if(uj){var ut=laya.display.Input.inputElement.value;uj._restrictPattern&&(ut=ut.replace(/\u2006|\x27/g,""),uj._restrictPattern.test(ut)&&(ut=ut.replace(uj._restrictPattern,""),laya.display.Input.inputElement.value=ut)),uj._text=ut,uj.event("input")}},ub._stopEvent=function(uW){"touchmove"==uW.type&&uW.preventDefault(),uW.stopPropagation&&uW.stopPropagation()},ub.TYPE_TEXT="text",ub.TYPE_PASSWORD="password",ub.TYPE_EMAIL="email",ub.TYPE_URL="url",ub.TYPE_NUMBER="number",ub.TYPE_RANGE="range",ub.TYPE_DATE="date",ub.TYPE_MONTH="month",ub.TYPE_WEEK="week",ub.TYPE_TIME="time",ub.TYPE_DATE_TIME="datetime",ub.TYPE_DATE_TIME_LOCAL="datetime-local",ub.TYPE_SEARCH="search",ub.input=null,ub.area=null,ub.inputElement=null,ub.inputContainer=null,ub.confirmButton=null,ub.promptStyleDOM=null,ub.inputHeight=45,ub.isInputting=!1,ub.stageMatrix=null,uA(ub,["IOS_IFRAME",function(){return this.IOS_IFRAME=uY.onIOS&&uY.window.top!=uY.window.self}]),ub}(uKW),u_W=function(uW){function ut(uW,uj){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,ut.__super.call(this),uW&&this._init_(uW,uj)}ue(ut,"laya.resource.HTMLImage",uSW);var uj=ut.prototype;return uj._init_=function(uW,uj){this._src=uW,this._source=new uY.window.Image,uj&&(uj.onload&&(this.onload=uj.onload),uj.onerror&&(this.onerror=uj.onerror),uj.onCreate&&uj.onCreate(this)),0!=uW.indexOf("data:image")&&(this._source.crossOrigin=""),uW&&(this._source.src=uW)},uj.recreateResource=function(){var uW=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var uj=this;this._source=new uY.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(uj._needReleaseAgain)return uj._needReleaseAgain=!1,uj._source.onload=null,void(uj._source=null);uj._source.onload=null,uj.memorySize=uW._w*uW._h*4,uj._recreateLock=!1,uj.completeCreate()},this._source.src=this._src}},uj.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},uj.onresize=function(){this._w=this._source.width,this._h=this._source.height},uR(0,uj,"onload",null,function(uW){var uj=this;this._onload=uW,this._source&&(this._source.onload=null!=this._onload?function(){uj.onresize(),uj._onload()}:null)}),uR(0,uj,"onerror",null,function(uW){var uj=this;this._onerror=uW,this._source&&(this._source.onerror=null!=this._onerror?function(){uj._onerror()}:null)}),uR(0,uj,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(uW){this._enableMerageInAtlas=uW,uy.isConchApp&&this._source&&(this._source.enableMerageInAtlas=uW)}),ut.create=function(uW,uj){return new ut(uW,uj)},ut}(),uNW=(function(uE){function uW(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,uW.__super.call(this)}ue(uW,"laya.display.EffectAnimation",uE);var uj=uW.prototype;uj._onOtherBegin=function(uW){uW!=this&&this.stop()},uj.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},uj._onPlayAction=function(){this.play(0,!1)},uj.play=function(uW,uj,ut,ud){void 0===uW&&(uW=0),void 0===uj&&(uj=!0),void 0===ut&&(ut=""),void 0===ud&&(ud=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,uW,uj,ut,ud))},uj._recordInitData=function(){if(this._aniKeys){var uW,uj,ut=0;for(uW=this._aniKeys.length,ut=0;ut<uW;ut++)uj=this._aniKeys[ut],this._initData[uj]=this._target[uj]}},uj._displayToIndex=function(uW){if(this._animationData){uW<0&&(uW=0),uW>this._count&&(uW=this._count);var uj=this._animationData.nodes,ut=0,ud=uj.length;for(ud=1<ud?1:ud,ut=0;ut<ud;ut++)this._displayNodeToFrame(uj[ut],uW)}},uj._displayNodeToFrame=function(uW,uj,ut){if(this._target){var ud;ud=this._target;var ub,uE,uO,uq,uA=uW.frames,uc=uW.keys,uR=0,um=uc.length;uq=uW.secondFrames;var uQ,uT,u$,ue,uK=0;for(uR=0;uR<um;uR++)uE=uA[ub=uc[uR]],uO=-1==(uK=uq[ub])?this._initData[ub]:uj<uK?(u$=(uT=uW.keyframes[ub])[0]).tween?(null==(uQ=uU[u$.tweenMethod])&&(uQ=uU.linearNone),ue=uT[1],uQ(uj,this._initData[ub],ue.value-this._initData[ub],ue.index)):this._initData[ub]:uE.length>uj?uE[uj]:uE[uE.length-1],ud[ub]=uO}},uj._calculateNodeKeyFrames=function(uW){uE.prototype._calculateNodeKeyFrames.call(this,uW);var uj,ut,ud,ub=uW.keyframes;uW.target;for(uj in ud={},uW.secondFrames=ud,ub)(ut=ub[uj]).length<=1?ud[uj]=-1:ud[uj]=ut[1].index},uR(0,uj,"target",function(){return this._target},function(uW){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=uW,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),uR(0,uj,"playEvent",null,function(uW){(this._playEvents=uW)&&this.addEvent()}),uR(0,uj,"effectData",null,function(uW){var uj;uW&&((uj=uW.animations)&&uj[0]&&(this._setUp({},uj[0]),uj[0].nodes&&uj[0].nodes[0]&&(this._aniKeys=uj[0].nodes[0].keys)))}),uR(0,uj,"effectClass",null,function(uW){var uj,ut;(this._effectClass=ug.getClass(uW),this._effectClass)&&((uj=this._effectClass.uiView)&&(ut=uj.animations)&&ut[0]&&(this._setUp({},ut[0]),ut[0].nodes&&ut[0].nodes[0]&&(this._aniKeys=ut[0].nodes[0].keys)))}),uW.EffectAnimationBegin="effectanimationbegin"}(uZW),function(uj){var uV;function ux(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,ux.__super.call(this)}ue(ux,"laya.utils.GraphicAnimation",uj);var uW=ux.prototype;return uW._parseNodeList=function(uW){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[uW.compId]=uW.props,uW.compId&&this._nodeList.push(uW.compId);var uj=uW.child;if(uj){var ut=0,ud=uj.length;for(ut=0;ut<ud;ut++)this._parseNodeList(uj[ut])}},uW._calGraphicData=function(uW){var uj;if(this._setUp(null,uW),this._createGraphicData(),this._nodeIDAniDic)for(uj in this._nodeIDAniDic)this._nodeIDAniDic[uj]=null},uW._createGraphicData=function(){var uW,uj=[],ut=0,ud=this.count,ub=this._animationNewFrames;for(ub||(ub=[]),ut=0;ut<ud;ut++)!ub[ut]&&uW||(uW=this._createFrameGraphic(ut)),uj.push(uW);this._gList=uj},uW._createFrameGraphic=function(uW){var uj=uG.createGraphics();return ux._rootMatrix||(ux._rootMatrix=new ul),this._updateNodeGraphic(this._rootNode,uW,ux._rootMatrix,uj),uj},uW._updateNodeGraphic=function(uW,uj,ut,ud,ub){var uE;void 0===ub&&(ub=1);var uO,uq,uA,uc=(uE=this._nodeGDic[uW.compId]=this._getNodeGraphicData(uW.compId,uj,this._nodeGDic[uW.compId])).alpha*ub;if(!(uc<.01)&&(uE.resultTransform||(uE.resultTransform=ul.create()),uO=uE.resultTransform,ul.mul(uE.transform,ut,uO),uE.skin&&(uq=this._getTextureByUrl(uE.skin))&&(uO._checkTransform()?(ud.drawTexture(uq,0,0,uE.width,uE.height,uO,uc),uE.resultTransform=null):ud.drawTexture(uq,uO.tx,uO.ty,uE.width,uE.height,null,uc)),uA=uW.child)){var uR,um=0;for(uR=uA.length,um=0;um<uR;um++)this._updateNodeGraphic(uA[um],uj,uO,ud,uc)}},uW._updateNoChilds=function(uW,uj){if(uW.skin){var ut=this._getTextureByUrl(uW.skin);if(ut){var ud=uW.transform;ud._checkTransform();!ud.bTransform?uj.drawTexture(ut,ud.tx,ud.ty,uW.width,uW.height,null,uW.alpha):uj.drawTexture(ut,0,0,uW.width,uW.height,ud.clone(),uW.alpha)}}},uW._updateNodeGraphic2=function(uW,uj,ut){var ud;if(ud=this._nodeGDic[uW.compId]=this._getNodeGraphicData(uW.compId,uj,this._nodeGDic[uW.compId]),uW.child){var ub=ud.transform;ub._checkTransform();var uE,uO;uO=(uE=!ub.bTransform)&&(0!=ub.tx||0!=ub.ty);var uq,uA,uc;if((uq=ub.bTransform||1!=ud.alpha)&&ut.save(),1!=ud.alpha&&ut.alpha(ud.alpha),uE?uO&&ut.translate(ub.tx,ub.ty):ut.transform(ub.clone()),uA=uW.child,ud.skin&&(uc=this._getTextureByUrl(ud.skin))&&ut.drawTexture(uc,0,0,ud.width,ud.height),uA){var uR,um=0;for(uR=uA.length,um=0;um<uR;um++)this._updateNodeGraphic2(uA[um],uj,ut)}uq?ut.restore():uE?uO&&ut.translate(-ub.tx,-ub.ty):ut.transform(ub.clone().invert())}else this._updateNoChilds(ud,ut)},uW._calculateNodeKeyFrames=function(uW){uj.prototype._calculateNodeKeyFrames.call(this,uW),this._nodeIDAniDic[uW.target]=uW},uW.getNodeDataByID=function(uW){return this._nodeIDAniDic[uW]},uW._getParams=function(uW,uj,ut,ud){var ub=ux._temParam;ub.length=uj.length;var uE=0,uO=uj.length;for(uE=0;uE<uO;uE++)ub[uE]=this._getObjVar(uW,uj[uE][0],ut,uj[uE][1],ud);return ub},uW._getObjVar=function(uW,uj,ut,ud,ub){if(uW.hasOwnProperty(uj)){var uE=uW[uj];if(ut>=uE.length&&(ut=uE.length-1),null!=uW[uj][ut])return uW[uj][ut]}return ub.hasOwnProperty(uj)?ub[uj]:ud},uW._getNodeGraphicData=function(uW,uj,ut){ut||(ut=uV.create()),ut.transform?ut.transform.identity():ut.transform=ul.create();var ud=this.getNodeDataByID(uW);if(!ud)return ut;var ub,uE,uO=ud.frames,uq=this._getParams(uO,ux._drawTextureCmd,uj,this._nodeDefaultProps[uW]),uA=uq[0],uc=NaN,uR=NaN,um=uq[5],uQ=uq[6],uT=uq[13],u$=uq[14],ue=uq[7],uK=uq[8],uo=uq[9],uS=uq[11],uM=uq[12];uc=uq[3],uR=uq[4],0!=uc&&0!=uR||(uA=null),-1==uc&&(uc=0),-1==uR&&(uR=0),ut.skin=uA,ut.width=uc,ut.height=uR,uA&&((ub=this._getTextureByUrl(uA))?(uc||(uc=ub.sourceWidth),uR||(uR=ub.sourceHeight)):console.warn("lost skin:",uA,",you may load pics first")),ut.alpha=uq[10],uE=ut.transform,0!=uT&&(um=uT*uc),0!=u$&&(uQ=u$*uR),0==um&&0==uQ||uE.translate(-um,-uQ);var uZ=null;if(uo||1!==ue||1!==uK||uS||uM){(uZ=ux._tempMt).identity(),uZ.bTransform=!0;var uX=.0174532922222222*(uo-uS),u_=.0174532922222222*(uo+uM),uN=Math.cos(u_),uz=Math.sin(u_),uC=Math.sin(uX),uL=Math.cos(uX);uZ.a=ue*uN,uZ.b=ue*uz,uZ.c=-uK*uC,uZ.d=uK*uL,uZ.tx=uZ.ty=0}return uZ&&(uE=ul.mul(uE,uZ,uE)),uE.translate(uq[1],uq[2]),ut},uW._getTextureByUrl=function(uW){return uqW.getRes(uW)},uW.setAniData=function(uW,uj){if(uW.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=uW,this._parseNodeList(uW);var ut,ud={},ub=[],uE=uW.animations,uO=0,uq=uE.length;for(uO=0;uO<uq;uO++)if(ut=uE[uO],this._labels=null,(!uj||uj==ut.name)&&ut){try{this._calGraphicData(ut)}catch(uW){console.warn("parse animation fail:"+ut.name+",empty animation created"),this._gList=[]}var uA={};uA.interval=1e3/ut.frameRate,uA.frames=this._gList,uA.labels=this._labels,uA.name=ut.name,ub.push(uA),ud[ut.name]=uA}this.animationList=ub,this.animationDic=ud}ux._temParam.length=0},uW.parseByData=function(uW){var uj,ut;uj=uW.nodeRoot,ut=uW.aniO,delete uW.nodeRoot,delete uW.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=uj,this._parseNodeList(uj),this._labels=null;try{this._calGraphicData(ut)}catch(uW){console.warn("parse animation fail:"+ut.name+",empty animation created"),this._gList=[]}var ud=uW;return ud.interval=1e3/ut.frameRate,ud.frames=this._gList,ud.labels=this._labels,ud.name=ut.name,ud},uW.setUpAniData=function(uW){if(uW.animations){var uj,ut={},ud=[],ub=uW.animations,uE=0,uO=ub.length;for(uE=0;uE<uO;uE++)if(uj=ub[uE]){var uq={};uq.name=uj.name,uq.aniO=uj,uq.nodeRoot=uW,ud.push(uq),ut[uj.name]=uq}this.animationList=ud,this.animationDic=ut}},uW._clear=function(){var uW,uj;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(uW in this._nodeGDic)(uj=this._nodeGDic[uW])&&uj.recover();this._nodeGDic=null},ux.parseAnimationByData=function(uW){var uj;return ux._I||(ux._I=new ux),uj=ux._I.parseByData(uW),ux._I._clear(),uj},ux.parseAnimationData=function(uW){var uj;return ux._I||(ux._I=new ux),ux._I.setUpAniData(uW),(uj={}).animationList=ux._I.animationList,uj.animationDic=ux._I.animationDic,ux._I._clear(),uj},ux._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],ux._temParam=[],ux._I=null,ux._rootMatrix=null,uA(ux,["_tempMt",function(){return this._tempMt=new ul}]),ux.__init$=function(){uV=function(){function uW(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return ue(uW,""),uW.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),ur.recover("GraphicNode",this)},uW.create=function(){return ur.getItemByClass("GraphicNode",uW)},uW}()},ux}(uZW));uN.__init([uc,uAW,uy,uY,ui,uL,uW,uNW])}(window,document,Laya),function(uW,uj,ut){ut.un,ut.uns,ut.static;var ud=ut.class;ut.getset,ut.__newvec;new(function(){function uW(){}return ud(uW,"LayaMain"),uW}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(uW,uj){"use strict";for(var ut in Object.defineProperty(uj,"__esModule",{value:!0}),Laya){var ud=Laya[ut];ud&&ud.__isclass&&(uj[ut]=ud)}}),function(uW,uj,u_){u_.un,u_.uns;var uO=u_.static,uQ=u_.class,ud=u_.getset,uE=u_.__newvec,uR=laya.maths.Arith,um=laya.maths.Bezier,ut=laya.resource.Bitmap,uT=laya.utils.Browser,uA=laya.utils.Byte,u$=laya.utils.Color,uN=(laya.filters.ColorFilter,u_.Config),ub=laya.resource.Context,uz=(laya.events.Event,laya.filters.Filter),uq=laya.display.Graphics,uc=laya.resource.HTMLCanvas,ue=(laya.utils.HTMLChar,laya.resource.HTMLImage),uK=laya.resource.HTMLSubImage,uC=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),uL=laya.maths.Point,uV=laya.maths.Rectangle,uo=laya.renders.Render,uS=(laya.renders.RenderContext,laya.renders.RenderSprite),uM=laya.resource.Resource,uZ=laya.resource.ResourceManager,uX=laya.utils.RunDriver,ux=laya.display.Sprite,uG=laya.display.Stage,ul=laya.utils.Stat,uh=laya.utils.StringKey,uv=(laya.display.css.Style,laya.system.System),uy=laya.display.Text,ua=laya.resource.Texture,uu=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),uD=laya.utils.VectorGraphManager;laya.utils.WordText;u_.interface("laya.webgl.shapes.IShape"),u_.interface("laya.webgl.submit.ISubmit"),u_.interface("laya.webgl.text.ICharSegment"),u_.interface("laya.webgl.canvas.save.ISaveData"),u_.interface("laya.webgl.resource.IMergeAtlasBitmap"),u_.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var us=function(){function uW(){}uQ(uW,"laya.filters.webgl.FilterActionGL");var uj=uW.prototype;return u_.imps(uj,{"laya.filters.IFilterActionGL":!0}),uj.setValue=function(uW){},uj.setValueMix=function(uW){},uj.apply3d=function(uW,uj,ut,ud,ub){return null},uj.apply=function(uW){return null},ud(0,uj,"typeMix",function(){return 0}),uW}(),uY=function(){function uW(){}return uQ(uW,"laya.webgl.shader.ShaderValue"),uW}(),uH=function(){var ud,ub;function uW(uW,uj,ut){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new ub,void 0===uW&&(uW=0),void 0===uj&&(uj=0),void 0===ut&&(ut=0),this._cells=null,this._rowInfo=null,this._init(uW,uj),this._atlasID=ut}uQ(uW,"laya.webgl.atlas.AtlasGrid");var uj=uW.prototype;return uj.getAltasID=function(){return this._atlasID},uj.setAltasID=function(uW){0<=uW&&(this._atlasID=uW)},uj.addTex=function(uW,uj,ut){var ud=this._get(uj,ut);return 0==ud.ret||(this._fill(ud.x,ud.y,uj,ut,uW),this._texCount++),ud},uj._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},uj._init=function(uW,uj){if(this._width=uW,this._height=uj,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=uE(this._height);for(var ut=0;ut<this._height;ut++)this._rowInfo[ut]=new ud;return this._clear(),!0},uj._get=function(uW,uj){var ut=new ug;if(uW>=this._failSize.width&&uj>=this._failSize.height)return ut;for(var ud=-1,ub=-1,uE=this._width,uO=this._height,uq=this._cells,uA=0;uA<uO;uA++)if(!(this._rowInfo[uA].spaceCount<uW))for(var uc=0;uc<uE;){var uR=3*(uA*uE+uc);if(0!=uq[uR]||uq[1+uR]<uW||uq[2+uR]<uj)uc+=uq[1+uR];else{ud=uc,ub=uA;for(var um=0;um<uW;um++)if(uq[3*um+uR+2]<uj){ud=-1;break}if(!(ud<0))return ut.ret=!0,ut.x=ud,ut.y=ub,ut;uc+=uq[1+uR]}}return ut},uj._fill=function(uW,uj,ut,ud,ub){var uE=this._width,uO=this._height;this._check(uW+ut<=uE&&uj+ud<=uO);for(var uq=uj;uq<ud+uj;++uq){this._check(this._rowInfo[uq].spaceCount>=ut),this._rowInfo[uq].spaceCount-=ut;for(var uA=0;uA<ut;uA++){var uc=3*(uW+uq*uE+uA);this._check(0==this._cells[uc]),this._cells[uc]=ub,this._cells[1+uc]=ut,this._cells[2+uc]=ud}}if(0<uW)for(uq=0;uq<ud;++uq){var uR=0;for(uA=uW-1;0<=uA&&0==this._cells[3*((uj+uq)*uE+uA)];--uA,++uR);for(uA=uR;0<uA;--uA)this._cells[3*((uj+uq)*uE+uW-uA)+1]=uA,this._check(0<uA)}if(0<uj)for(uA=uW;uA<uW+ut;++uA){for(uR=0,uq=uj-1;0<=uq&&0==this._cells[3*(uA+uq*uE)];--uq,uR++);for(uq=uR;0<uq;--uq)this._cells[3*(uA+(uj-uq)*uE)+2]=uq,this._check(0<uq)}},uj._check=function(uW){0==uW&&console.log("xtexMerger 错误啦")},uj._clear=function(){for(var uW=this._texCount=0;uW<this._height;uW++)this._rowInfo[uW].spaceCount=this._width;for(var uj=0;uj<this._height;uj++)for(var ut=0;ut<this._width;ut++){var ud=3*(uj*this._width+ut);this._cells[ud]=0,this._cells[1+ud]=this._width-ut,this._cells[2+ud]=this._width-uj}this._failSize.width=this._width+1,this._failSize.height=this._height+1},uW.__init$=function(){ud=function(){function uW(){this.spaceCount=0}return uQ(uW,""),uW}(),ub=function(){function uW(){this.width=0,this.height=0}return uQ(uW,""),uW}()},uW}(),uI=function(){function uo(uW,uj,ut,ud){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=uW,this._height=uj,this._gridSize=ut,this._maxAtlaserCount=ud,this._gridNumX=uW/ut,this._gridNumY=uj/ut,this._curAtlasIndex=0,this._atlaserArray=[]}uQ(uo,"laya.webgl.atlas.AtlasResourceManager");var uW=uo.prototype;return uW.setAtlasParam=function(uW,uj,ut,ud){if(1==this._setAtlasParam)return uo._sid_=0,this._width=uW,this._height=uj,this._gridSize=ut,this._maxAtlaserCount=ud,this._gridNumX=uW/ut,this._gridNumY=uj/ut,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},uW.pushData=function(uW){var uj,ut=uW.bitmap,ud=-1,ub=null,uE=0,uO=0;for(uE=0,uj=this._atlaserArray.length;uE<uj&&(uO=(this._curAtlasIndex+uE)%uj,-1==(ud=(ub=this._atlaserArray[uO]).findBitmapIsExist(ut)));uE++);if(-1!=ud){var uq=ub.InAtlasWebGLImagesOffsetValue[ud];return u$=uq[0],ue=uq[1],ub.addToAtlas(uW,u$,ue),!0}this._setAtlasParam=!1;for(var uA=Math.ceil((uW.bitmap.width+2)/this._gridSize),uc=Math.ceil((uW.bitmap.height+2)/this._gridSize),uR=!1,um=0;um<2;um++){var uQ=this._maxAtlaserCount;for(uE=0;uE<uQ;uE++){uO=(this._curAtlasIndex+uE)%uQ,this._atlaserArray.length-1>=uO||this._atlaserArray.push(new uVW(this._gridNumX,this._gridNumY,this._width,this._height,uo._sid_++));var uT=this._atlaserArray[uO],u$=0,ue=0,uK=uT.addTex(1,uA,uc);if(uK.ret){u$=uK.x*this._gridSize+1,ue=uK.y*this._gridSize+1,ut.lock=!0,uT.addToAtlasTexture(ut,u$,ue),uT.addToAtlas(uW,u$,ue),uR=!0,this._curAtlasIndex=uO;break}}if(uR)break;this._atlaserArray.push(new uVW(this._gridNumX,this._gridNumY,this._width,this._height,uo._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return uR||console.log(">>>AtlasManager pushData error"),uR},uW.addToAtlas=function(uW){laya.webgl.atlas.AtlasResourceManager.instance.pushData(uW)},uW.garbageCollection=function(){if(!0===this._needGC){for(var uW=this._atlaserArray.length-this._maxAtlaserCount,uj=0;uj<uW;uj++)this._atlaserArray[uj].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+uW),this._atlaserArray.splice(0,uW),this._needGC=!1}return!0},uW.freeAll=function(){for(var uW=0,uj=this._atlaserArray.length;uW<uj;uW++)this._atlaserArray[uW].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},uW.getAtlaserCount=function(){return this._atlaserArray.length},uW.getAtlaserByIndex=function(uW){return this._atlaserArray[uW]},ud(1,uo,"instance",function(){return uo._Instance||(uo._Instance=new uo(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),uo._Instance}),ud(1,uo,"enabled",function(){return uN.atlasEnable}),ud(1,uo,"atlasLimitWidth",function(){return uo._atlasLimitWidth},function(uW){uo._atlasLimitWidth=uW}),ud(1,uo,"atlasLimitHeight",function(){return uo._atlasLimitHeight},function(uW){uo._atlasLimitHeight=uW}),uo._enable=function(){uN.atlasEnable=!0},uo._disable=function(){uN.atlasEnable=!1},uo.__init__=function(){uo.atlasTextureWidth=2048,uo.atlasTextureHeight=2048,uo.maxTextureCount=6,uo.atlasLimitWidth=512,uo.atlasLimitHeight=512},uo._atlasLimitWidth=0,uo._atlasLimitHeight=0,uo.gridSize=16,uo.atlasTextureWidth=0,uo.atlasTextureHeight=0,uo.maxTextureCount=0,uo._atlasRestore=0,uo.BOARDER_TYPE_NO=0,uo.BOARDER_TYPE_RIGHT=1,uo.BOARDER_TYPE_LEFT=2,uo.BOARDER_TYPE_BOTTOM=4,uo.BOARDER_TYPE_TOP=8,uo.BOARDER_TYPE_ALL=15,uo._sid_=0,uo._Instance=null,uo}(),ug=function(){function uW(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return uQ(uW,"laya.webgl.atlas.MergeFillInfo"),uW}(),uf=function(){function uj(){}return uQ(uj,"laya.webgl.canvas.BlendMode"),uj._init_=function(uW){uj.fns=[uj.BlendNormal,uj.BlendAdd,uj.BlendMultiply,uj.BlendScreen,uj.BlendOverlay,uj.BlendLight,uj.BlendMask,uj.BlendDestinationOut],uj.targetFns=[uj.BlendNormalTarget,uj.BlendAddTarget,uj.BlendMultiplyTarget,uj.BlendScreenTarget,uj.BlendOverlayTarget,uj.BlendLightTarget,uj.BlendMask,uj.BlendDestinationOut]},uj.BlendNormal=function(uW){uW.blendFunc(1,771)},uj.BlendAdd=function(uW){uW.blendFunc(1,772)},uj.BlendMultiply=function(uW){uW.blendFunc(774,771)},uj.BlendScreen=function(uW){uW.blendFunc(1,1)},uj.BlendOverlay=function(uW){uW.blendFunc(1,769)},uj.BlendLight=function(uW){uW.blendFunc(1,1)},uj.BlendNormalTarget=function(uW){uW.blendFunc(1,771)},uj.BlendAddTarget=function(uW){uW.blendFunc(1,772)},uj.BlendMultiplyTarget=function(uW){uW.blendFunc(774,771)},uj.BlendScreenTarget=function(uW){uW.blendFunc(1,1)},uj.BlendOverlayTarget=function(uW){uW.blendFunc(1,769)},uj.BlendLightTarget=function(uW){uW.blendFunc(1,1)},uj.BlendMask=function(uW){uW.blendFunc(0,770)},uj.BlendDestinationOut=function(uW){uW.blendFunc(0,0)},uj.activeBlendFunction=null,uj.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],uj.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},uj.NORMAL="normal",uj.ADD="add",uj.MULTIPLY="multiply",uj.SCREEN="screen",uj.LIGHT="light",uj.OVERLAY="overlay",uj.DESTINATIONOUT="destination-out",uj.fns=[],uj.targetFns=[],uj}(),uw=function(){function ut(uW){this._color=u$.create("black"),this.setValue(uW)}uQ(ut,"laya.webgl.canvas.DrawStyle");var uW=ut.prototype;return uW.setValue=function(uW){if(uW){if("string"==typeof uW)return void(this._color=u$.create(uW));if(uW instanceof laya.utils.Color)return void(this._color=uW)}},uW.reset=function(){this._color=u$.create("black")},uW.equal=function(uW){return"string"==typeof uW?this._color.strColor===uW:uW instanceof laya.utils.Color&&this._color.numColor===uW.numColor},uW.toColorStr=function(){return this._color.strColor},ut.create=function(uW){var uj;if(uW&&("string"==typeof uW?uj=u$.create(uW):uW instanceof laya.utils.Color&&(uj=uW),uj))return uj._drawStyle||(uj._drawStyle=new ut(uW));return laya.webgl.canvas.DrawStyle.DEFAULT},uO(ut,["DEFAULT",function(){return this.DEFAULT=new ut("#000000")}]),ut}(),uU=function(){function uW(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];uZW.mainContext;this.ib=upW.create(35048),this.vb=uFW.create(5)}uQ(uW,"laya.webgl.canvas.Path");var uj=uW.prototype;return uj.addPoint=function(uW,uj){this.tempArray.push(uW,uj)},uj.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},uj.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},uj.polygon=function(uW,uj,ut,ud,ub,uE){var uO;return this.geomatrys.push(this._curGeomatry=uO=new uhW(uW,uj,ut,ud,ub,uE)),ud||(uO.fill=!1),null==uE&&(uO.borderWidth=0),uO},uj.setGeomtry=function(uW){this.geomatrys.push(this._curGeomatry=uW)},uj.drawLine=function(uW,uj,ut,ud,ub){var uE;return this.closePath?this.geomatrys.push(this._curGeomatry=uE=new ulW(uW,uj,ut,ud,ub)):this.geomatrys.push(this._curGeomatry=uE=new uGW(uW,uj,ut,ud,ub)),uE.fill=!1,uE},uj.update=function(){var uW=this.ib._byteLength,uj=this.geomatrys.length;this.offset=uW;for(var ut=this.geoStart;ut<uj;ut++)this.geomatrys[ut].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=uj,this.count=(this.ib._byteLength-uW)/ueW.BYTES_PIDX},uj.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},uj.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},uW}(),uJ=function(){function uq(){}uQ(uq,"laya.webgl.canvas.save.SaveBase");var uW=uq.prototype;return u_.imps(uW,{"laya.webgl.canvas.save.ISaveData":!0}),uW.isSaveMark=function(){return!1},uW.restore=function(uW){this._dataObj[this._valueName]=this._value,(uq._cache[uq._cache._length++]=this)._newSubmit&&(uW._curSubmit=uEW.RENDERBASE,uW._renderKey=0)},uq._createArray=function(){var uW=[];return uW._length=0,uW},uq._init=function(){var uW=uq._namemap={};return uW[1]="ALPHA",uW[2]="fillStyle",uW[8]="font",uW[256]="lineWidth",uW[512]="strokeStyle",uW[8192]="_mergeID",uW[1024]=uW[2048]=uW[4096]=[],uW[16384]="textBaseline",uW[32768]="textAlign",uW[65536]="_nBlendType",uW[1048576]="shader",uW[2097152]="filters",uW},uq.save=function(uW,uj,ut,ud){if((uW._saveMark._saveuse&uj)!==uj){uW._saveMark._saveuse|=uj;var ub=uq._cache,uE=0<ub._length?ub[--ub._length]:new uq;uE._value=ut[uE._valueName=uq._namemap[uj]],uE._dataObj=ut,uE._newSubmit=ud;var uO=uW._save;uO[uO._length++]=uE}},uq._cache=laya.webgl.canvas.save.SaveBase._createArray(),uq._namemap=uq._init(),uq}(),ur=function(){function uE(){this._clipRect=new uV}uQ(uE,"laya.webgl.canvas.save.SaveClipRect");var uW=uE.prototype;return u_.imps(uW,{"laya.webgl.canvas.save.ISaveData":!0}),uW.isSaveMark=function(){return!1},uW.restore=function(uW){uW._clipRect=this._clipSaveRect,(uE._cache[uE._cache._length++]=this)._submitScissor.submitLength=uW._submits._length-this._submitScissor.submitIndex,uW._curSubmit=uEW.RENDERBASE,uW._renderKey=0},uE.save=function(uW,uj){if(131072!=(131072&uW._saveMark._saveuse)){uW._saveMark._saveuse|=131072;var ut=uE._cache,ud=0<ut._length?ut[--ut._length]:new uE;ud._clipSaveRect=uW._clipRect,uW._clipRect=ud._clipRect.copyFrom(uW._clipRect),ud._submitScissor=uj;var ub=uW._save;ub[ub._length++]=ud}},uO(uE,["_cache",function(){return this._cache=uJ._createArray()}]),uE}(),uP=function(){function uT(){this._contextX=0,this._contextY=0,this._clipRect=new uV,this._rect=new uV,this._matrix=new uC}uQ(uT,"laya.webgl.canvas.save.SaveClipRectStencil");var uW=uT.prototype;return u_.imps(uW,{"laya.webgl.canvas.save.ISaveData":!0}),uW.isSaveMark=function(){return!1},uW.restore=function(uW){uRW.restore(uW,this._rect,this._saveMatrix,this._contextX,this._contextY),uW._clipRect=this._clipSaveRect,uW._curMat=this._saveMatrix,uW._x=this._contextX,uW._y=this._contextY,uT._cache[uT._cache._length++]=this,uW._curSubmit=uEW.RENDERBASE},uT.save=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){if(262144!=(262144&uW._saveMark._saveuse)){uW._saveMark._saveuse|=262144;var uR=uT._cache,um=0<uR._length?uR[--uR._length]:new uT;um._clipSaveRect=uW._clipRect,um._clipRect.setTo(uO,uq,uA,uc),uW._clipRect=um._clipRect,um._rect.x=ut,um._rect.y=ud,um._rect.width=ub,um._rect.height=uE,um._contextX=uW._x,um._contextY=uW._y,um._saveMatrix=uW._curMat,uW._curMat.copyTo(um._matrix),uW._curMat=um._matrix,um._submitStencil=uj;var uQ=uW._save;uQ[uQ._length++]=um}},uO(uT,["_cache",function(){return this._cache=uJ._createArray()}]),uT}(),ui=function(){function ud(){this._saveuse=0}uQ(ud,"laya.webgl.canvas.save.SaveMark");var uW=ud.prototype;return u_.imps(uW,{"laya.webgl.canvas.save.ISaveData":!0}),uW.isSaveMark=function(){return!0},uW.restore=function(uW){uW._saveMark=this._preSaveMark,ud._no[ud._no._length++]=this},ud.Create=function(uW){var uj=ud._no,ut=0<uj._length?uj[--uj._length]:new ud;return ut._saveuse=0,ut._preSaveMark=uW._saveMark,uW._saveMark=ut},uO(ud,["_no",function(){return this._no=uJ._createArray()}]),ud}(),uB=function(){function uE(){this._matrix=new uC}uQ(uE,"laya.webgl.canvas.save.SaveTransform");var uW=uE.prototype;return u_.imps(uW,{"laya.webgl.canvas.save.ISaveData":!0}),uW.isSaveMark=function(){return!1},uW.restore=function(uW){uW._curMat=this._savematrix,uE._no[uE._no._length++]=this},uE.save=function(uW){var uj=uW._saveMark;if(2048!=(2048&uj._saveuse)){uj._saveuse|=2048;var ut=uE._no,ud=0<ut._length?ut[--ut._length]:new uE;ud._savematrix=uW._curMat,uW._curMat=uW._curMat.copyTo(ud._matrix);var ub=uW._save;ub[ub._length++]=ud}},uO(uE,["_no",function(){return this._no=uJ._createArray()}]),uE}(),un=function(){function ub(){}uQ(ub,"laya.webgl.canvas.save.SaveTranslate");var uW=ub.prototype;return u_.imps(uW,{"laya.webgl.canvas.save.ISaveData":!0}),uW.isSaveMark=function(){return!1},uW.restore=function(uW){uW._curMat;uW._x=this._x,uW._y=this._y,ub._no[ub._no._length++]=this},ub.save=function(uW){var uj=ub._no,ut=0<uj._length?uj[--uj._length]:new ub;ut._x=uW._x,ut._y=uW._y;var ud=uW._save;ud[ud._length++]=ut},uO(ub,["_no",function(){return this._no=uJ._createArray()}]),ub}(),uk=function(){function uW(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new uV}uQ(uW,"laya.webgl.resource.RenderTargetMAX");var uj=uW.prototype;return uj.setSP=function(uW){this._sp=uW},uj.size=function(uW,uj){var ut=this;this._width!==uW||this._height!==uj?(this.repaint=!0,this._width=uW,this._height=uj,this.target?this.target.size(uW,uj):this.target=uDW.create(uW,uj),this.target.hasListener("recovered")||this.target.on("recovered",this,function(uW){u_.timer.callLater(ut._sp,ut._sp.repaint)})):this.target.size(uW,uj)},uj._flushToTarget=function(uW,uj){if(!uj._destroy){var ut=uSW.worldScissorTest,ud=uSW.worldClipRect;uSW.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,uSW.worldScissorTest=!1,uZW.mainContext.disable(3089);var ub=uSW.worldAlpha,uE=uSW.worldMatrix4,uO=uSW.worldMatrix,uq=uSW.worldFilters,uA=uSW.worldShaderDefines;if(uSW.worldMatrix=uC.EMPTY,uSW.restoreTempArray(),uSW.worldMatrix4=uSW.TEMPMAT4_ARRAY,uSW.worldAlpha=1,uSW.worldFilters=null,uSW.worldShaderDefines=null,uuW.activeShader=null,uj.start(),uN.showCanvasMark?uj.clear(0,1,0,.3):uj.clear(0,0,0,0),uW.flush(),uj.end(),uuW.activeShader=null,uSW.worldAlpha=ub,uSW.worldMatrix4=uE,uSW.worldMatrix=uO,uSW.worldFilters=uq,uSW.worldShaderDefines=uA,uSW.worldScissorTest=ut){var uc=uSW.height-ud.y-ud.height;uZW.mainContext.scissor(ud.x,uc,ud.width,ud.height),uZW.mainContext.enable(3089)}uSW.worldClipRect=ud}},uj.flush=function(uW){this.repaint&&(this._flushToTarget(uW,this.target),this.repaint=!1)},uj.drawTo=function(uW,uj,ut,ud,ub){uW.drawTexture(this.target.getTexture(),uj,ut,ud,ub,0,0)},uj.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},uW}(),up=function(){function uW(){this.ALPHA=1,this.shaderType=0,this.defines=new uxW}return uQ(uW,"laya.webgl.shader.d2.Shader2D"),uW.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},uW.__init__=function(){var uW,uj;uiW.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),uiW.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),uiW.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),uiW.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),uiW.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),uiW.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),uiW.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),uiW.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),uW="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",uj='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',uiW.preCompile2D(0,1,uW,uj,null),uW="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",uj='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',uiW.preCompile2D(0,2,uW,uj,null),uW="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",uj="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",uiW.preCompile2D(0,4,uW,uj,null),uW="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",uj='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',uiW.preCompile2D(0,256,uW,uj,null),uW="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",uj="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",uiW.preCompile2D(0,512,uW,uj,null)},uW}(),uF=function(){function uj(uW,uj,ut){this._value=0,this._name2int=uW,this._int2name=uj,this._int2nameMap=ut}uQ(uj,"laya.webgl.shader.ShaderDefines");var uW=uj.prototype;return uW.add=function(uW){return"string"==typeof uW&&(uW=this._name2int[uW]),this._value|=uW,this._value},uW.addInt=function(uW){return this._value|=uW,this._value},uW.remove=function(uW){return"string"==typeof uW&&(uW=this._name2int[uW]),this._value&=~uW,this._value},uW.isDefine=function(uW){return(this._value&uW)===uW},uW.getValue=function(){return this._value},uW.setValue=function(uW){this._value=uW},uW.toNameDic=function(){var uW=this._int2nameMap[this._value];return uW||uj._toText(this._value,this._int2name,this._int2nameMap)},uj._reg=function(uW,uj,ut,ud){ud[ut[uW]=uj]=uW},uj._toText=function(uW,uj,ut){var ud=ut[uW];if(ud)return ud;for(var ub={},uE=1,uO=0;uO<32&&!(uW<(uE=1<<uO));uO++)if(uW&uE){var uq=uj[uE];uq&&(ub[uq]="")}return ut[uW]=ub},uj._toInt=function(uW,uj){for(var ut=uW.split("."),ud=0,ub=0,uE=ut.length;ub<uE;ub++){var uO=uj[ut[ub]];if(!uO)throw new Error("Defines to int err:"+uW+"/"+ut[ub]);ud|=uO}return ud},uj}(),uWW=function(){function uO(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new uC}uQ(uO,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var uW=uO.prototype;return uW.init=function(uW,uj,ut){if(uj)this._vs=uj;else{this._vs=[];var ud=uW.width,ub=uW.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(ud,0,1,0,1,1,1,1),this._vs.push(ud,ub,1,1,1,1,1,1),this._vs.push(0,ub,0,1,1,1,1,1)}ut?this._ps=ut:(uO._defaultPS||(uO._defaultPS=[]).push(0,1,3,3,1,2),this._ps=uO._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=uW},uW.init2=function(uW,uj,ut,ud,ub){this.transform&&(this.transform=null),ut?this._ps=ut:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=ud,this._uvs=ub,this.mEleNum=this._ps.length,this.mTexture=uW,(uo.isConchNode||uo.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},uW._initMyData=function(){var uW=0,uj=0,ut=4*this._verticles.length;this._vs=uO._tempVS;var ud=!1;if(uo.isConchNode||uo.isConchApp?(this._vs.length=ut,ud=!0):this._vs.length<ut&&(this._vs.length=ut,ud=!0),uO._tVSLen=ut,ud)for(;uW<ut;)this._vs[uW]=this._verticles[uj],this._vs[uW+1]=this._verticles[uj+1],this._vs[uW+2]=this._uvs[uj],this._vs[uW+3]=this._uvs[uj+1],this._vs[uW+4]=1,this._vs[uW+5]=1,this._vs[uW+6]=1,this._vs[uW+7]=1,uW+=8,uj+=2;else for(;uW<ut;)this._vs[uW]=this._verticles[uj],this._vs[uW+1]=this._verticles[uj+1],this._vs[uW+2]=this._uvs[uj],this._vs[uW+3]=this._uvs[uj+1],uW+=8,uj+=2},uW.getData2=function(uW,uj,ut){var ud;this.mVBBuffer=uW,this.mIBBuffer=uj,this._initMyData(),uW.appendEx2(this._vs,Float32Array,uO._tVSLen,4),this._indexStart=uj._byteLength,(ud=uO._tempIB).length<this._ps.length&&(ud.length=this._ps.length);for(var ub=0,uE=this._ps.length;ub<uE;ub++)ud[ub]=this._ps[ub]+ut;uj.appendEx2(ud,Uint16Array,this._ps.length,2)},uW.getData=function(uW,uj,ut){if(this.mVBBuffer=uW,this.mIBBuffer=uj,uW.append(this.mVBData),this._indexStart=uj._byteLength,this.mIBData.start!=ut){for(var ud=0,ub=this._ps.length;ud<ub;ud++)this.mIBData[ud]=this._ps[ud]+ut;this.mIBData.start=ut}uj.append(this.mIBData)},uW.render=function(uW,uj,ut){if(uo.isWebGL&&this.mTexture){uW._renderKey=0,uW._shader2D.glTexture=null,ujW.getInstance().addSkinMesh(this);var ud=uEW.createShape(uW,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,uzW.create(512,0));this.transform||(this.transform=uC.EMPTY),this.transform.translate(uj,ut),uC.mul(this.transform,uW._curMat,this._tempMatrix),this.transform.translate(-uj,-ut);var ub=ud.shaderValue,uE=ub.u_mmat2||uSW.getMatrArray();uSW.mat2MatArray(this._tempMatrix,uE),ub.textureHost=this.mTexture,ub.offsetX=0,ub.offsetY=0,ub.u_mmat2=uE,ub.ALPHA=uW._shader2D.ALPHA,uW._submits[uW._submits._length++]=ud}else uo.isConchApp&&this.mTexture&&(this.transform||(this.transform=uC.EMPTY),uW.setSkinMesh&&uW.setSkinMesh(uj,ut,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},uO._tempVS=[],uO._tempIB=[],uO._defaultPS=null,uO._tVSLen=0,uO}(),ujW=function(){function uW(){this.ib=null,this.vb=null;uZW.mainContext;this.ib=upW.create(35048),this.vb=uFW.create(8)}uQ(uW,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var uj=uW.prototype;return uj.addSkinMesh=function(uW){uW.getData2(this.vb,this.ib,this.vb._byteLength/32)},uj.reset=function(){this.vb.clear(),this.ib.clear()},uW.getInstance=function(){return uW.instance=uW.instance||new uW},uW.instance=null,uW}(),utW=function(){function uW(uW,uj,ut,ud,ub,uE,uO,uq,uA){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===uA&&(uA=0),this.x=uW,this.y=uj,this.width=ut,this.height=ud,this.edges=ub,this.color=uE,this.borderWidth=uO,this.borderColor=uq}uQ(uW,"laya.webgl.shapes.BasePoly");var uj=uW.prototype;return u_.imps(uj,{"laya.webgl.shapes.IShape":!0}),uj.getData=function(uW,uj,ut){},uj.rebuild=function(uW){},uj.setMatrix=function(uW){},uj.needUpdate=function(uW){return!0},uj.sector=function(uW,uj,ut){var ud=this.x,ub=this.y,uE=this.edges,uO=(this.r1-this.r0)/uE,uq=this.width,uA=this.height,uc=this.color,uR=(uc>>16&255)/255,um=(uc>>8&255)/255,uQ=(255&uc)/255;uW.push(ud,ub,uR,um,uQ);for(var uT=0;uT<uE+1;uT++)uW.push(ud+Math.sin(uO*uT+this.r0)*uq,ub+Math.cos(uO*uT+this.r0)*uA),uW.push(uR,um,uQ);for(uT=0;uT<uE;uT++)uj.push(ut,ut+uT+1,ut+uT+2)},uj.createLine2=function(uW,uj,ut,ud,ub,uE){var uO,uq,uA,uc,uR,um,uQ,uT,u$,ue,uK,uo,uS,uM,uZ,uX,u_,uN,uz,uC,uL=uW.concat(),uV=ub,ux=this.borderColor,uG=(ux>>16&255)/255,ul=(ux>>8&255)/255,uh=(255&ux)/255,uv=uL.length/2,uy=ud,ua=ut/2;uA=uL[0],uc=uL[1],ue=uA-(uR=uL[2]),u$=(u$=-(uc-(um=uL[3])))/(uC=Math.sqrt(u$*u$+ue*ue))*ua,ue=ue/uC*ua,uV.push(uA-u$+this.x,uc-ue+this.y,uG,ul,uh,uA+u$+this.x,uc+ue+this.y,uG,ul,uh);for(var uu=1;uu<uv-1;uu++)uA=uL[2*(uu-1)],uc=uL[2*(uu-1)+1],uR=uL[2*uu],um=uL[2*uu+1],uQ=uL[2*(uu+1)],uT=uL[2*(uu+1)+1],ue=uA-uR,uo=uR-uQ,uZ=(-(u$=(u$=-(uc-um))/(uC=Math.sqrt(u$*u$+ue*ue))*ua)+uA)*(-(ue=ue/uC*ua)+um)-(-u$+uR)*(-ue+uc),uN=(-(uK=(uK=-(um-uT))/(uC=Math.sqrt(uK*uK+uo*uo))*ua)+uQ)*(-(uo=uo/uC*ua)+um)-(-uK+uR)*(-uo+uT),uz=(uS=-ue+uc-(-ue+um))*(u_=-uK+uR-(-uK+uQ))-(uX=-uo+uT-(-uo+um))*(uM=-u$+uR-(-u$+uA)),Math.abs(uz)<.1?(uz+=10.1,uV.push(uR-u$+this.x,um-ue+this.y,uG,ul,uh,uR+u$+this.x,um+ue+this.y,uG,ul,uh)):(((uO=(uM*uN-u_*uZ)/uz)-uR)*(uO-uR)+((uq=(uX*uZ-uS*uN)/uz)-um)+(uq-um),uV.push(uO+this.x,uq+this.y,uG,ul,uh,uR-(uO-uR)+this.x,um-(uq-um)+this.y,uG,ul,uh));uA=uL[uL.length-4],uc=uL[uL.length-3],ue=uA-(uR=uL[uL.length-2]),u$=(u$=-(uc-(um=uL[uL.length-1])))/(uC=Math.sqrt(u$*u$+ue*ue))*ua,ue=ue/uC*ua,uV.push(uR-u$+this.x,um-ue+this.y,uG,ul,uh,uR+u$+this.x,um+ue+this.y,uG,ul,uh);var uD=uE;for(uu=1;uu<uD;uu++)uj.push(uy+2*(uu-1),uy+2*(uu-1)+1,uy+2*uu+1,uy+2*uu+1,uy+2*uu,uy+2*(uu-1));return uV},uj.createLine=function(uW,uj,ut,ud){var ub=uW.concat(),uE=uW,uO=this.borderColor,uq=(uO>>16&255)/255,uA=(uO>>8&255)/255,uc=(255&uO)/255;ub.splice(0,5);var uR,um,uQ,uT,u$,ue,uK,uo,uS,uM,uZ,uX,u_,uN,uz,uC,uL,uV,ux,uG,ul=ub.length/5,uh=ud,uv=ut/2;uQ=ub[0],uT=ub[1],uM=uQ-(u$=ub[5]),uS=(uS=-(uT-(ue=ub[6])))/(uG=Math.sqrt(uS*uS+uM*uM))*uv,uM=uM/uG*uv,uE.push(uQ-uS,uT-uM,uq,uA,uc,uQ+uS,uT+uM,uq,uA,uc);for(var uy=1;uy<ul-1;uy++)uQ=ub[5*(uy-1)],uT=ub[5*(uy-1)+1],u$=ub[5*uy],ue=ub[5*uy+1],uK=ub[5*(uy+1)],uo=ub[5*(uy+1)+1],uM=uQ-u$,uX=u$-uK,uz=(-(uS=(uS=-(uT-ue))/(uG=Math.sqrt(uS*uS+uM*uM))*uv)+uQ)*(-(uM=uM/uG*uv)+ue)-(-uS+u$)*(-uM+uT),uV=(-(uZ=(uZ=-(ue-uo))/(uG=Math.sqrt(uZ*uZ+uX*uX))*uv)+uK)*(-(uX=uX/uG*uv)+ue)-(-uZ+u$)*(-uX+uo),ux=(u_=-uM+uT-(-uM+ue))*(uL=-uZ+u$-(-uZ+uK))-(uC=-uX+uo-(-uX+ue))*(uN=-uS+u$-(-uS+uQ)),Math.abs(ux)<.1?(ux+=10.1,uE.push(u$-uS,ue-uM,uq,uA,uc,u$+uS,ue+uM,uq,uA,uc)):(((uR=(uN*uV-uL*uz)/ux)-u$)*(uR-u$)+((um=(uC*uz-u_*uV)/ux)-ue)+(um-ue),uE.push(uR,um,uq,uA,uc,u$-(uR-u$),ue-(um-ue),uq,uA,uc));uQ=ub[ub.length-10],uT=ub[ub.length-9],uM=uQ-(u$=ub[ub.length-5]),uS=(uS=-(uT-(ue=ub[ub.length-4])))/(uG=Math.sqrt(uS*uS+uM*uM))*uv,uM=uM/uG*uv,uE.push(u$-uS,ue-uM,uq,uA,uc,u$+uS,ue+uM,uq,uA,uc);var ua=this.edges+1;for(uy=1;uy<ua;uy++)uj.push(uh+2*(uy-1),uh+2*(uy-1)+1,uh+2*uy+1,uh+2*uy+1,uh+2*uy,uh+2*(uy-1));return uE},uj.createLoopLine=function(uW,uj,ut,ud,ub,uE){var uO=uW.concat(),uq=ub||uW,uA=this.borderColor,uc=(uA>>16&255)/255,uR=(uA>>8&255)/255,um=(255&uA)/255;uO.splice(0,5);var uQ=[uO[0],uO[1]],uT=[uO[uO.length-5],uO[uO.length-4]],u$=uT[0]+.5*(uQ[0]-uT[0]),ue=uT[1]+.5*(uQ[1]-uT[1]);uO.unshift(u$,ue,0,0,0),uO.push(u$,ue,0,0,0);var uK,uo,uS,uM,uZ,uX,u_,uN,uz,uC,uL,uV,ux,uG,ul,uh,uv,uy,ua,uu,uD=uO.length/5,us=ud,uY=ut/2;uS=uO[0],uM=uO[1],uC=uS-(uZ=uO[5]),uz=(uz=-(uM-(uX=uO[6])))/(uu=Math.sqrt(uz*uz+uC*uC))*uY,uC=uC/uu*uY,uq.push(uS-uz,uM-uC,uc,uR,um,uS+uz,uM+uC,uc,uR,um);for(var uH=1;uH<uD-1;uH++)uS=uO[5*(uH-1)],uM=uO[5*(uH-1)+1],uZ=uO[5*uH],uX=uO[5*uH+1],u_=uO[5*(uH+1)],uN=uO[5*(uH+1)+1],uC=uS-uZ,uV=uZ-u_,ul=(-(uz=(uz=-(uM-uX))/(uu=Math.sqrt(uz*uz+uC*uC))*uY)+uS)*(-(uC=uC/uu*uY)+uX)-(-uz+uZ)*(-uC+uM),uy=(-(uL=(uL=-(uX-uN))/(uu=Math.sqrt(uL*uL+uV*uV))*uY)+u_)*(-(uV=uV/uu*uY)+uX)-(-uL+uZ)*(-uV+uN),ua=(ux=-uC+uM-(-uC+uX))*(uv=-uL+uZ-(-uL+u_))-(uh=-uV+uN-(-uV+uX))*(uG=-uz+uZ-(-uz+uS)),Math.abs(ua)<.1?(ua+=10.1,uq.push(uZ-uz,uX-uC,uc,uR,um,uZ+uz,uX+uC,uc,uR,um)):(((uK=(uG*uy-uv*ul)/ua)-uZ)*(uK-uZ)+((uo=(uh*ul-ux*uy)/ua)-uX)+(uo-uX),uq.push(uK,uo,uc,uR,um,uZ-(uK-uZ),uX-(uo-uX),uc,uR,um));uE&&(uj=uE);var uI=this.edges+1;for(uH=1;uH<uI;uH++)uj.push(us+2*(uH-1),us+2*(uH-1)+1,us+2*uH+1,us+2*uH+1,us+2*uH,us+2*(uH-1));return uj.push(us+2*(uH-1),us+2*(uH-1)+1,us+1,us+1,us,us+2*(uH-1)),uq},uW}(),udW=function(){function ue(){}return uQ(ue,"laya.webgl.shapes.Earcut"),ue.earcut=function(uW,uj,ut){ut=ut||2;var ud,ub,uE,uO,uq,uA,uc,uR=uj&&uj.length,um=uR?uj[0]*ut:uW.length,uQ=ue.linkedList(uW,0,um,ut,!0),uT=[];if(!uQ)return uT;if(uR&&(uQ=ue.eliminateHoles(uW,uj,uQ,ut)),uW.length>80*ut){ud=uE=uW[0],ub=uO=uW[1];for(var u$=ut;u$<um;u$+=ut)(uq=uW[u$])<ud&&(ud=uq),(uA=uW[u$+1])<ub&&(ub=uA),uE<uq&&(uE=uq),uO<uA&&(uO=uA);uc=0!==(uc=Math.max(uE-ud,uO-ub))?1/uc:0}return ue.earcutLinked(uQ,uT,ut,ud,ub,uc),uT},ue.linkedList=function(uW,uj,ut,ud,ub){var uE,uO;if(ub===0<ue.signedArea(uW,uj,ut,ud))for(uE=uj;uE<ut;uE+=ud)uO=ue.insertNode(uE,uW[uE],uW[uE+1],uO);else for(uE=ut-ud;uj<=uE;uE-=ud)uO=ue.insertNode(uE,uW[uE],uW[uE+1],uO);return uO&&ue.equals(uO,uO.next)&&(ue.removeNode(uO),uO=uO.next),uO},ue.filterPoints=function(uW,uj){if(!uW)return uW;uj||(uj=uW);var ut,ud=uW;do{if(ut=!1,ud.steiner||!ue.equals(ud,ud.next)&&0!==ue.area(ud.prev,ud,ud.next))ud=ud.next;else{if(ue.removeNode(ud),(ud=uj=ud.prev)===ud.next)break;ut=!0}}while(ut||ud!==uj);return uj},ue.earcutLinked=function(uW,uj,ut,ud,ub,uE,uO){if(uW){!uO&&uE&&ue.indexCurve(uW,ud,ub,uE);for(var uq,uA,uc=uW;uW.prev!==uW.next;)if(uq=uW.prev,uA=uW.next,uE?ue.isEarHashed(uW,ud,ub,uE):ue.isEar(uW))uj.push(uq.i/ut),uj.push(uW.i/ut),uj.push(uA.i/ut),ue.removeNode(uW),uW=uA.next,uc=uA.next;else if((uW=uA)===uc){uO?1===uO?(uW=ue.cureLocalIntersections(uW,uj,ut),ue.earcutLinked(uW,uj,ut,ud,ub,uE,2)):2===uO&&ue.splitEarcut(uW,uj,ut,ud,ub,uE):ue.earcutLinked(ue.filterPoints(uW,null),uj,ut,ud,ub,uE,1);break}}},ue.isEar=function(uW){var uj=uW.prev,ut=uW,ud=uW.next;if(0<=ue.area(uj,ut,ud))return!1;for(var ub=uW.next.next;ub!==uW.prev;){if(ue.pointInTriangle(uj.x,uj.y,ut.x,ut.y,ud.x,ud.y,ub.x,ub.y)&&0<=ue.area(ub.prev,ub,ub.next))return!1;ub=ub.next}return!0},ue.isEarHashed=function(uW,uj,ut,ud){var ub=uW.prev,uE=uW,uO=uW.next;if(0<=ue.area(ub,uE,uO))return!1;for(var uq=ub.x<uE.x?ub.x<uO.x?ub.x:uO.x:uE.x<uO.x?uE.x:uO.x,uA=ub.y<uE.y?ub.y<uO.y?ub.y:uO.y:uE.y<uO.y?uE.y:uO.y,uc=ub.x>uE.x?ub.x>uO.x?ub.x:uO.x:uE.x>uO.x?uE.x:uO.x,uR=ub.y>uE.y?ub.y>uO.y?ub.y:uO.y:uE.y>uO.y?uE.y:uO.y,um=ue.zOrder(uq,uA,uj,ut,ud),uQ=ue.zOrder(uc,uR,uj,ut,ud),uT=uW.nextZ;uT&&uT.z<=uQ;){if(uT!==uW.prev&&uT!==uW.next&&ue.pointInTriangle(ub.x,ub.y,uE.x,uE.y,uO.x,uO.y,uT.x,uT.y)&&0<=ue.area(uT.prev,uT,uT.next))return!1;uT=uT.nextZ}for(uT=uW.prevZ;uT&&uT.z>=um;){if(uT!==uW.prev&&uT!==uW.next&&ue.pointInTriangle(ub.x,ub.y,uE.x,uE.y,uO.x,uO.y,uT.x,uT.y)&&0<=ue.area(uT.prev,uT,uT.next))return!1;uT=uT.prevZ}return!0},ue.cureLocalIntersections=function(uW,uj,ut){var ud=uW;do{var ub=ud.prev,uE=ud.next.next;!ue.equals(ub,uE)&&ue.intersects(ub,ud,ud.next,uE)&&ue.locallyInside(ub,uE)&&ue.locallyInside(uE,ub)&&(uj.push(ub.i/ut),uj.push(ud.i/ut),uj.push(uE.i/ut),ue.removeNode(ud),ue.removeNode(ud.next),ud=uW=uE),ud=ud.next}while(ud!==uW);return ud},ue.splitEarcut=function(uW,uj,ut,ud,ub,uE){var uO=uW;do{for(var uq=uO.next.next;uq!==uO.prev;){if(uO.i!==uq.i&&ue.isValidDiagonal(uO,uq)){var uA=ue.splitPolygon(uO,uq);return uO=ue.filterPoints(uO,uO.next),uA=ue.filterPoints(uA,uA.next),ue.earcutLinked(uO,uj,ut,ud,ub,uE),void ue.earcutLinked(uA,uj,ut,ud,ub,uE)}uq=uq.next}uO=uO.next}while(uO!==uW)},ue.eliminateHoles=function(uW,uj,ut,ud){var ub,uE,uO,uq,uA,uc=[];for(ub=0,uE=uj.length;ub<uE;ub++)uO=uj[ub]*ud,uq=ub<uE-1?uj[ub+1]*ud:uW.length,(uA=ue.linkedList(uW,uO,uq,ud,!1))===uA.next&&(uA.steiner=!0),uc.push(ue.getLeftmost(uA));for(uc.sort(ue.compareX),ub=0;ub<uc.length;ub++)ue.eliminateHole(uc[ub],ut),ut=ue.filterPoints(ut,ut.next);return ut},ue.compareX=function(uW,uj){return uW.x-uj.x},ue.eliminateHole=function(uW,uj){if(uj=ue.findHoleBridge(uW,uj)){var ut=ue.splitPolygon(uj,uW);ue.filterPoints(ut,ut.next)}},ue.findHoleBridge=function(uW,uj){var ut,ud=uj,ub=uW.x,uE=uW.y,uO=-1/0;do{if(uE<=ud.y&&uE>=ud.next.y&&ud.next.y!==ud.y){var uq=ud.x+(uE-ud.y)*(ud.next.x-ud.x)/(ud.next.y-ud.y);if(uq<=ub&&uO<uq){if((uO=uq)===ub){if(uE===ud.y)return ud;if(uE===ud.next.y)return ud.next}ut=ud.x<ud.next.x?ud:ud.next}}ud=ud.next}while(ud!==uj);if(!ut)return null;if(ub===uO)return ut.prev;var uA,uc=ut,uR=ut.x,um=ut.y,uQ=1/0;for(ud=ut.next;ud!==uc;)ub>=ud.x&&ud.x>=uR&&ub!==ud.x&&ue.pointInTriangle(uE<um?ub:uO,uE,uR,um,uE<um?uO:ub,uE,ud.x,ud.y)&&((uA=Math.abs(uE-ud.y)/(ub-ud.x))<uQ||uA===uQ&&ud.x>ut.x)&&ue.locallyInside(ud,uW)&&(ut=ud,uQ=uA),ud=ud.next;return ut},ue.indexCurve=function(uW,uj,ut,ud){for(var ub=uW;null===ub.z&&(ub.z=ue.zOrder(ub.x,ub.y,uj,ut,ud)),ub.prevZ=ub.prev,ub.nextZ=ub.next,(ub=ub.next)!==uW;);ub.prevZ.nextZ=null,ub.prevZ=null,ue.sortLinked(ub)},ue.sortLinked=function(uW){var uj,ut,ud,ub,uE,uO,uq,uA,uc=1;do{for(ut=uW,uE=uW=null,uO=0;ut;){for(uO++,ud=ut,uj=uq=0;uj<uc&&(uq++,ud=ud.nextZ);uj++);for(uA=uc;0<uq||0<uA&&ud;)0!==uq&&(0===uA||!ud||ut.z<=ud.z)?(ut=(ub=ut).nextZ,uq--):(ud=(ub=ud).nextZ,uA--),uE?uE.nextZ=ub:uW=ub,ub.prevZ=uE,uE=ub;ut=ud}uE.nextZ=null,uc*=2}while(1<uO);return uW},ue.zOrder=function(uW,uj,ut,ud,ub){return(uW=1431655765&((uW=858993459&((uW=252645135&((uW=16711935&((uW=32767*(uW-ut)*ub)|uW<<8))|uW<<4))|uW<<2))|uW<<1))|(uj=1431655765&((uj=858993459&((uj=252645135&((uj=16711935&((uj=32767*(uj-ud)*ub)|uj<<8))|uj<<4))|uj<<2))|uj<<1))<<1},ue.getLeftmost=function(uW){for(var uj=uW,ut=uW;uj.x<ut.x&&(ut=uj),(uj=uj.next)!==uW;);return ut},ue.pointInTriangle=function(uW,uj,ut,ud,ub,uE,uO,uq){return 0<=(ub-uO)*(uj-uq)-(uW-uO)*(uE-uq)&&0<=(uW-uO)*(ud-uq)-(ut-uO)*(uj-uq)&&0<=(ut-uO)*(uE-uq)-(ub-uO)*(ud-uq)},ue.isValidDiagonal=function(uW,uj){return uW.next.i!==uj.i&&uW.prev.i!==uj.i&&!ue.intersectsPolygon(uW,uj)&&ue.locallyInside(uW,uj)&&ue.locallyInside(uj,uW)&&ue.middleInside(uW,uj)},ue.area=function(uW,uj,ut){return(uj.y-uW.y)*(ut.x-uj.x)-(uj.x-uW.x)*(ut.y-uj.y)},ue.equals=function(uW,uj){return uW.x===uj.x&&uW.y===uj.y},ue.intersects=function(uW,uj,ut,ud){return!!(ue.equals(uW,uj)&&ue.equals(ut,ud)||ue.equals(uW,ud)&&ue.equals(ut,uj))||0<ue.area(uW,uj,ut)!=0<ue.area(uW,uj,ud)&&0<ue.area(ut,ud,uW)!=0<ue.area(ut,ud,uj)},ue.intersectsPolygon=function(uW,uj){var ut=uW;do{if(ut.i!==uW.i&&ut.next.i!==uW.i&&ut.i!==uj.i&&ut.next.i!==uj.i&&ue.intersects(ut,ut.next,uW,uj))return!0;ut=ut.next}while(ut!==uW);return!1},ue.locallyInside=function(uW,uj){return ue.area(uW.prev,uW,uW.next)<0?0<=ue.area(uW,uj,uW.next)&&0<=ue.area(uW,uW.prev,uj):ue.area(uW,uj,uW.prev)<0||ue.area(uW,uW.next,uj)<0},ue.middleInside=function(uW,uj){for(var ut=uW,ud=!1,ub=(uW.x+uj.x)/2,uE=(uW.y+uj.y)/2;ut.y>uE!=ut.next.y>uE&&ut.next.y!==ut.y&&ub<(ut.next.x-ut.x)*(uE-ut.y)/(ut.next.y-ut.y)+ut.x&&(ud=!ud),(ut=ut.next)!==uW;);return ud},ue.splitPolygon=function(uW,uj){var ut=new ubW(uW.i,uW.x,uW.y),ud=new ubW(uj.i,uj.x,uj.y),ub=uW.next,uE=uj.prev;return(uW.next=uj).prev=uW,(ut.next=ub).prev=ut,(ud.next=ut).prev=ud,(uE.next=ud).prev=uE,ud},ue.insertNode=function(uW,uj,ut,ud){var ub=new ubW(uW,uj,ut);return ud?(ub.next=ud.next,(ub.prev=ud).next.prev=ub,ud.next=ub):(ub.prev=ub).next=ub,ub},ue.removeNode=function(uW){uW.next.prev=uW.prev,uW.prev.next=uW.next,uW.prevZ&&(uW.prevZ.nextZ=uW.nextZ),uW.nextZ&&(uW.nextZ.prevZ=uW.prevZ)},ue.signedArea=function(uW,uj,ut,ud){for(var ub=0,uE=uj,uO=ut-ud;uE<ut;uE+=ud)ub+=(uW[uO]-uW[uE])*(uW[uE+1]+uW[uO+1]),uO=uE;return ub},ue}(),ubW=function(){function uW(uW,uj,ut){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=uW,this.x=uj,this.y=ut,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return uQ(uW,"laya.webgl.shapes.EarcutNode"),uW}(),uEW=(function(){function uW(uW,uj,ut,ud,ub,uE,uO){this.lineWidth=uW,this.lineColor=uj,this.lineAlpha=ut,this.fillColor=ud,this.fillAlpha=ub,this.shape=uO,this.fill=uE}uQ(uW,"laya.webgl.shapes.GeometryData");var uj=uW.prototype;uj.clone=function(){return new uW(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},uj.getIndexData=function(){return null},uj.getVertexData=function(){return null},uj.destroy=function(){this.shape=null}}(),function(){function uW(uW){if(uW instanceof Float32Array)this.points=uW;else if(uW instanceof Array){uW.length;this.points=new Float32Array(uW)}}uQ(uW,"laya.webgl.shapes.Vertex");var uj=uW.prototype;u_.imps(uj,{"laya.webgl.shapes.IShape":!0}),uj.getData=function(uW,uj,ut){},uj.needUpdate=function(uW){return!1},uj.rebuild=function(uW){},uj.setMatrix=function(uW){}}(),function(){function uA(uW){void 0===uW&&(uW=1e4),this._renderType=uW}uQ(uA,"laya.webgl.submit.Submit");var uW=uA.prototype;return u_.imps(uW,{"laya.webgl.submit.ISubmit":!0}),uW.releaseRender=function(){var uW=uA._cache;(uW[uW._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},uW.getRenderType=function(){return this._renderType},uW.renderSubmit=function(){if(0===this._numEle)return 1;var uW=this.shaderValue.textureHost;if(uW){var uj=uW.source;if(!uW.bitmap||!uj)return 1;this.shaderValue.texture=uj,uW.alphaTexture&&uW.alphaTexture.source&&(this.shaderValue.texture1=uW.alphaTexture.source)}this._vb.bind_upload(this._ib);var ut=uZW.mainContext;return this.shaderValue.upload(),uf.activeBlendFunction!==this._blendFn&&(ut.enable(3042),this._blendFn(ut),uf.activeBlendFunction=this._blendFn),ul.drawCall++,ul.trianglesFaces+=this._numEle/3,ut.drawElements(4,this._numEle,5123,this._startIdx),1},uA.__init__=function(){var uW=uA.RENDERBASE=new uA(-1);uW.shaderValue=new uzW(0,0),uW.shaderValue.ALPHA=-1234},uA.createSubmit=function(uW,uj,ut,ud,ub){var uE=uA._cache._length?uA._cache[--uA._cache._length]:new uA;null==ut&&((ut=uE._selfVb||(uE._selfVb=uFW.create(-1))).clear(),ud=0),uE._ib=uj,uE._vb=ut,uE._startIdx=ud*ueW.BYTES_PIDX,uE._numEle=0;var uO=uW._nBlendType;uE._blendFn=uW._targets?uf.targetFns[uO]:uf.fns[uO],uE.shaderValue=ub,uE.shaderValue.setValue(uW._shader2D);var uq=uW._shader2D.filters;return uq&&uE.shaderValue.setFilters(uq),uE},uA.createShape=function(uW,uj,ut,ud,ub,uE){var uO=uA._cache._length?uA._cache[--uA._cache._length]:new uA;uO._ib=uj,uO._vb=ut,uO._numEle=ud,uO._startIdx=ub,uO.shaderValue=uE,uO.shaderValue.setValue(uW._shader2D);var uq=uW._nBlendType;return uO._blendFn=uW._targets?uf.targetFns[uq]:uf.fns[uq],uO},uA.TYPE_2D=1e4,uA.TYPE_CANVAS=10003,uA.TYPE_CMDSETRT=10004,uA.TYPE_CUSTOM=10005,uA.TYPE_BLURRT=10006,uA.TYPE_CMDDESTORYPRERT=10007,uA.TYPE_DISABLESTENCIL=10008,uA.TYPE_OTHERIBVB=10009,uA.TYPE_PRIMITIVE=10010,uA.TYPE_RT=10011,uA.TYPE_BLUR_RT=10012,uA.TYPE_TARGET=10013,uA.TYPE_CHANGE_VALUE=10014,uA.TYPE_SHAPE=10015,uA.TYPE_TEXTURE=10016,uA.TYPE_FILLTEXTURE=10017,uA.RENDERBASE=null,uA._cache=((uA._cache=[])._length=0,uA._cache),uA}()),uOW=function(){function ud(){this.fun=null,this.args=null}uQ(ud,"laya.webgl.submit.SubmitCMD");var uW=ud.prototype;return u_.imps(uW,{"laya.webgl.submit.ISubmit":!0}),uW.renderSubmit=function(){return this.fun.apply(null,this.args),1},uW.getRenderType=function(){return 0},uW.releaseRender=function(){var uW=ud._cache;uW[uW._length++]=this},ud.create=function(uW,uj){var ut=ud._cache._length?ud._cache[--ud._cache._length]:new ud;return ut.fun=uj,ut.args=uW,ut},ud._cache=((ud._cache=[])._length=0,ud._cache),ud}(),uqW=function(){function uj(){this.variables={}}uQ(uj,"laya.webgl.submit.SubmitCMDScope");var uW=uj.prototype;return uW.getValue=function(uW){return this.variables[uW]},uW.addValue=function(uW,uj){return this.variables[uW]=uj},uW.setValue=function(uW,uj){return this.variables.hasOwnProperty(uW)?this.variables[uW]=uj:null},uW.clear=function(){for(var uW in this.variables)delete this.variables[uW]},uW.recycle=function(){this.clear(),uj.POOL.push(this)},uj.create=function(){var uW=uj.POOL.pop();return uW||(uW=new uj),uW},uj.POOL=[],uj}(),uAW=function(){function um(){this.offset=0,this.startIndex=0,this._mat=uC.create()}uQ(um,"laya.webgl.submit.SubmitOtherIBVB");var uW=um.prototype;return u_.imps(uW,{"laya.webgl.submit.ISubmit":!0}),uW.releaseRender=function(){var uW=um._cache;(uW[uW._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},uW.getRenderType=function(){return 10009},uW.renderSubmit=function(){var uW=this._shaderValue.textureHost;if(uW){var uj=uW.source;if(!uW.bitmap||!uj)return 1;this._shaderValue.texture=uj}this._vb.bind_upload(this._ib);var ut=uSW.worldMatrix4,ud=uC.TEMP;uC.mulPre(this._mat,ut[0],ut[1],ut[4],ut[5],ut[12],ut[13],ud);var ub=uSW.worldMatrix4=um.tempMatrix4;ub[0]=ud.a,ub[1]=ud.b,ub[4]=ud.c,ub[5]=ud.d,ub[12]=ud.tx,ub[13]=ud.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var uE=uZW.mainContext;return uf.activeBlendFunction!==this._blendFn&&(uE.enable(3042),this._blendFn(uE),uf.activeBlendFunction=this._blendFn),ul.drawCall++,ul.trianglesFaces+=this._numEle/3,uE.drawElements(4,this._numEle,5123,this.startIndex),uSW.worldMatrix4=ut,uuW.activeShader=null,1},um.create=function(uW,uj,ut,ud,ub,uE,uO,uq,uA){void 0===uA&&(uA=0);var uc=um._cache._length?um._cache[--um._cache._length]:new um;uc._ib=ut,uc._vb=uj,uc._numEle=ud,uc._shader=ub,uc._shaderValue=uE;var uR=uW._nBlendType;switch(uc._blendFn=uW._targets?uf.targetFns[uR]:uf.fns[uR],uA){case 0:uc.offset=0,uc.startIndex=uq/(ueW.BYTES_PE*uj.vertexStride)*1.5,uc.startIndex*=ueW.BYTES_PIDX;break;case 1:uc.startIndex=uO,uc.offset=uq}return uc},um._cache=((um._cache=[])._length=0,um._cache),um.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],um}(),ucW=function(){function ut(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new uV,this.screenRect=new uV}uQ(ut,"laya.webgl.submit.SubmitScissor");var uW=ut.prototype;return u_.imps(uW,{"laya.webgl.submit.ISubmit":!0}),uW._scissor=function(uW,uj,ut,ud){var ub=uSW.worldMatrix4,uE=ub[0],uO=ub[5],uq=ub[12],uA=ub[13];if(ud*=uO,(ut*=uE)<1||ud<1)return!1;var uc=(uW=uW*uE+uq)+ut,uR=(uj=uj*uO+uA)+ud;uW<0&&(ut=uc-(uW=0)),uj<0&&(ud=uR-(uj=0));var um=uSW.worldClipRect;if(uW=Math.max(uW,um.x),uj=Math.max(uj,um.y),ut=Math.min(uc,um.right)-uW,ud=Math.min(uR,um.bottom)-uj,ut<1||ud<1)return!1;var uQ=uSW.worldScissorTest;return this.screenRect.copyFrom(um),um.x=uW,um.y=uj,um.width=ut,um.height=ud,uSW.worldScissorTest=!0,uj=uSW.height-uj-ud,uZW.mainContext.scissor(uW,uj,ut,ud),uZW.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),uQ?(uj=uSW.height-this.screenRect.y-this.screenRect.height,uZW.mainContext.scissor(this.screenRect.x,uj,this.screenRect.width,this.screenRect.height),uZW.mainContext.enable(3089)):(uZW.mainContext.disable(3089),uSW.worldScissorTest=!1),um.copyFrom(this.screenRect),!0},uW._scissorWithTagart=function(uW,uj,ut,ud){if(ut<1||ud<1)return!1;var ub=uW+ut,uE=uj+ud;uW<0&&(ut=ub-(uW=0)),uj<0&&(ud=uE-(uj=0));var uO=uSW.worldClipRect;if(uW=Math.max(uW,uO.x),uj=Math.max(uj,uO.y),ut=Math.min(ub,uO.right)-uW,ud=Math.min(uE,uO.bottom)-uj,ut<1||ud<1)return!1;var uq=uSW.worldScissorTest;return this.screenRect.copyFrom(uO),uSW.worldScissorTest=!0,uO.x=uW,uO.y=uj,uO.width=ut,uO.height=ud,uj=uSW.height-uj-ud,uZW.mainContext.scissor(uW,uj,ut,ud),uZW.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),uq?(uj=uSW.height-this.screenRect.y-this.screenRect.height,uZW.mainContext.scissor(this.screenRect.x,uj,this.screenRect.width,this.screenRect.height),uZW.mainContext.enable(3089)):(uZW.mainContext.disable(3089),uSW.worldScissorTest=!1),uO.copyFrom(this.screenRect),!0},uW.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},uW.getRenderType=function(){return 0},uW.releaseRender=function(){var uW=ut._cache;(uW[uW._length++]=this).context=null},ut.create=function(uW){var uj=ut._cache._length?ut._cache[--ut._cache._length]:new ut;return uj.context=uW,uj},ut._cache=((ut._cache=[])._length=0,ut._cache),ut}(),uRW=function(){function uA(){this.step=0,this.blendMode=null,this.level=0}uQ(uA,"laya.webgl.submit.SubmitStencil");var uW=uA.prototype;return u_.imps(uW,{"laya.webgl.submit.ISubmit":!0}),uW.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},uW.getRenderType=function(){return 0},uW.releaseRender=function(){var uW=uA._cache;uW[uW._length++]=this},uW.do1=function(){var uW=uZW.mainContext;uW.enable(2960),uW.clear(1024),uW.colorMask(!1,!1,!1,!1),uW.stencilFunc(514,this.level,255),uW.stencilOp(7680,7680,7682)},uW.do2=function(){var uW=uZW.mainContext;uW.stencilFunc(514,this.level+1,255),uW.colorMask(!0,!0,!0,!0),uW.stencilOp(7680,7680,7680)},uW.do3=function(){var uW=uZW.mainContext;uW.colorMask(!0,!0,!0,!0),uW.stencilOp(7680,7680,7680),uW.clear(1024),uW.disable(2960)},uW.do4=function(){var uW=uZW.mainContext;0==this.level&&(uW.enable(2960),uW.clear(1024)),uW.colorMask(!1,!1,!1,!1),uW.stencilFunc(519,0,255),uW.stencilOp(7680,7680,7682)},uW.do5=function(){var uW=uZW.mainContext;uW.stencilFunc(514,this.level,255),uW.colorMask(!0,!0,!0,!0),uW.stencilOp(7680,7680,7680)},uW.do6=function(){var uW=uZW.mainContext;uf.targetFns[uf.TOINT[this.blendMode]](uW)},uW.do7=function(){var uW=uZW.mainContext;uW.colorMask(!1,!1,!1,!1),uW.stencilOp(7680,7680,7683)},uW.do8=function(){var uW=uZW.mainContext;uW.colorMask(!0,!0,!0,!0),uW.stencilFunc(514,this.level,255),uW.stencilOp(7680,7680,7680)},uA.restore=function(uW,uj,ut,ud,ub){var uE;if((uW._renderKey=0)<uA._mask&&uA._mask--,0==uA._mask)uE=laya.webgl.submit.SubmitStencil.create(3),uW.addRenderObject(uE),uW._curSubmit=uEW.RENDERBASE;else{uE=laya.webgl.submit.SubmitStencil.create(7),uW.addRenderObject(uE);var uO=uW._vb;uO._byteLength;if(uKW.fillRectImgVb(uO,null,uj.x,uj.y,uj.width,uj.height,ua.DEF_UV,ut,ud,ub,0,0)){uW._shader2D.glTexture=null;var uq=uW._curSubmit=uEW.createSubmit(uW,uW._ib,uO,(uO._byteLength-64)/32*3,uzW.create(2,0));uq.shaderValue.ALPHA=1,uW._submits[uW._submits._length++]=uq,uW._curSubmit._numEle+=6,uW._curSubmit=uEW.RENDERBASE}else alert("clipRect calc stencil rect error");uE=laya.webgl.submit.SubmitStencil.create(8),uW.addRenderObject(uE)}},uA.restore2=function(uW,uj){var ut;(uW._renderKey=0)<uA._mask&&uA._mask--,0==uA._mask?(ut=laya.webgl.submit.SubmitStencil.create(3),uW.addRenderObject(ut),uW._curSubmit=uEW.RENDERBASE):(ut=laya.webgl.submit.SubmitStencil.create(7),uW.addRenderObject(ut),uW._submits[uW._submits._length++]=uj,ut=laya.webgl.submit.SubmitStencil.create(8),uW.addRenderObject(ut))},uA.create=function(uW){var uj=uA._cache._length?uA._cache[--uA._cache._length]:new uA;return 5==(uj.step=uW)&&++uA._mask,uj.level=uA._mask,uj},uA._cache=((uA._cache=[])._length=0,uA._cache),uA._mask=0,uA}(),umW=function(){function uq(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}uQ(uq,"laya.webgl.submit.SubmitTarget");var uW=uq.prototype;return u_.imps(uW,{"laya.webgl.submit.ISubmit":!0}),uW.renderSubmit=function(){this._vb.bind_upload(this._ib);var uW=this.scope.getValue(this.proName);return uW&&(this.shaderValue.texture=uW.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[uW.width,uW.height]),this.shaderValue.upload(),this.blend(),ul.drawCall++,ul.trianglesFaces+=this._numEle/3,uZW.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},uW.blend=function(){if(uf.activeBlendFunction!==uf.fns[this.blendType]){var uW=uZW.mainContext;uW.enable(3042),uf.fns[this.blendType](uW),uf.activeBlendFunction=uf.fns[this.blendType]}},uW.getRenderType=function(){return 0},uW.releaseRender=function(){var uW=uq._cache;(uW[uW._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},uq.create=function(uW,uj,ut,ud,ub,uE){var uO=uq._cache._length?uq._cache[--uq._cache._length]:new uq;return uO._ib=uj,uO._vb=ut,uO.proName=uE,uO._startIdx=ud*ueW.BYTES_PIDX,uO._numEle=0,uO.blendType=uW._nBlendType,uO.shaderValue=ub,uO.shaderValue.setValue(uW._shader2D),uO},uq._cache=((uq._cache=[])._length=0,uq._cache),uq}(),uQW=function(){function uW(){this._sourceStr=null}uQ(uW,"laya.webgl.text.CharSegment");var uj=uW.prototype;return u_.imps(uj,{"laya.webgl.text.ICharSegment":!0}),uj.textToSpit=function(uW){this._sourceStr=uW},uj.getChar=function(uW){return this._sourceStr.charAt(uW)},uj.getCharCode=function(uW){return this._sourceStr.charCodeAt(uW)},uj.length=function(){return this._sourceStr.length},uW}(),uTW=function(){var uW;function ul(){}return uQ(ul,"laya.webgl.text.DrawText"),ul.__init__=function(){ul._charsTemp=new Array,ul._drawValue=new uW,ul._charSeg=new uQW},ul.customCharSeg=function(uW){ul._charSeg=uW},ul.getChar=function(uW,uj,ut){var ud=uJW.createOneChar(uW,ut);return-1!=uj&&(ul._charsCache[uj]=ud),ud},ul._drawSlow=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR,um,uQ,uT,u$){var ue,uK,uo=ul._drawValue.value(uE,uq,uA,uc,uQ,uT,u$),uS=0,uM=0,uZ=ul._charsTemp,uX=0,u_=NaN;if(ud)for(uZ.length=ud.length,uS=0,uM=ud.length;uS<uM;uS++)(uK=ud[uS])&&(u_=uK.charNum+uo.txtID,uZ[uS]=ue=ul._charsCache[u_]||ul.getChar(uK.char,u_,uo),ue.active());else{var uN=ut instanceof laya.utils.WordText?ut.toString():ut;if(uy.CharacterCache){ul._charSeg.textToSpit(uN);var uz=ul._charSeg.length();for(uS=0,uM=uZ.length=uz;uS<uM;uS++)u_=ul._charSeg.getCharCode(uS)+uo.txtID,uZ[uS]=ue=ul._charsCache[u_]||ul.getChar(ul._charSeg.getChar(uS),u_,uo),ue.active(),uX+=ue.cw}else uZ.length=0,(ue=ul.getChar(uN,-1,uo)).active(),uX+=ue.cw,uZ[0]=ue}var uC=0;null!==uO&&"left"!==uO&&(uC=-("center"==uO?uX/2:uX));var uL,uV,ux=NaN,uG=0;if(ud)for(uS=0,uM=uZ.length;uS<uM;uS++)ue=uZ[uS],uK=ud[uS],ue&&uK&&!ue.isSpace&&(ux=ue.borderSize,uL=ue.texture,uj._drawText(uL,uR+uC+uK.x*uQ-ux,um+uK.y*uT-ux,uL.width,uL.height,ub,0,0,0,0));else{for(uS=0,uM=uZ.length;uS<uM;uS++)(ue=uZ[uS])&&!ue.isSpace&&(ux=ue.borderSize,uL=ue.texture,uj._drawText(uL,uR+uC-ux,um-ux,uL.width,uL.height,ub,0,0,0,0),uW&&((uV=uW[uG++])||(uV=uW[uG-1]=[]),uV[0]=uL,uV[1]=uC-ux,uV[2]=-ux)),uC+=ue.cw;uW&&(uW.length=uG)}},ul._drawFast=function(uW,uj,ut,ud,ub){for(var uE,uO,uq=0,uA=uW.length;uq<uA;uq++)(uE=(uO=uW[uq])[0]).active(),uj._drawText(uE,ud+uO[1],ub+uO[2],uE.width,uE.height,ut,0,0,0,0)},ul.drawText=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR,um){if(void 0===um&&(um=0),!(uj&&0===uj.length||ut&&0===ut.length)){var uQ=ud.a,uT=ud.d;(0!==ud.b||0!==ud.c)&&(uQ=uT=1);var u$=1!==uQ||1!==uT;if(u$&&u_.stage.transform){var ue=u_.stage.transform;u$=ue.a===uQ&&ue.d===uT}else u$=!1;if(u$){var uK=(ud=ud.copyTo(uNW._tmpMatrix)).tx,uo=ud.ty;ud.scale(1/uQ,1/uT),ud._checkTransform(),uc*=uQ,uR*=uT,uc+=uK-ud.tx,uR+=uo-ud.ty}else uQ=uT=1;if(ut)ul._drawSlow(null,uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR,uQ,uT,um);else{if(null===uj.toUpperCase){var uS=uQ+1e5*uT,uM=uj;return void(uM.changed||uM.id!==uS?(uM.id=uS,uM.changed=!1,ul._drawSlow(uM.save,uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR,uQ,uT,um)):ul._drawFast(uM.save,uW,ud,uc,uR))}var uZ=uj+ub.toString()+uO+uq+uA+uQ+uT+uE,uX=ul._textsCache[uZ];uy.CharacterCache?uX?ul._drawFast(uX,uW,ud,uc,uR):(ul._textsCache.__length||(ul._textsCache.__length=0),ul._textsCache.__length>uN.WebGLTextCacheCount&&((ul._textsCache={}).__length=0,ul._curPoolIndex=0),ul._textCachesPool[ul._curPoolIndex]?(uX=ul._textsCache[uZ]=ul._textCachesPool[ul._curPoolIndex]).length=0:ul._textCachesPool[ul._curPoolIndex]=uX=ul._textsCache[uZ]=[],ul._textsCache.__length++,ul._curPoolIndex++,ul._drawSlow(uX,uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR,uQ,uT,um)):ul._drawSlow(uX,uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR,uQ,uT,um)}}},ul._charsTemp=null,ul._textCachesPool=[],ul._curPoolIndex=0,ul._charsCache={},ul._textsCache={},ul._drawValue=null,ul.d=[],ul._charSeg=null,ul.__init$=function(){uW=function(){function uA(){}return uQ(uA,""),uA.prototype.value=function(uW,uj,ut,ud,ub,uE,uO){this.font=uW,this.fillColor=uj,this.borderColor=ut,this.lineWidth=ud,this.scaleX=ub,this.scaleY=uE,this.underLine=uO;var uq=uW.toString()+ub+uE+ud+(uj?uj.toLowerCase():" ")+(ut?ut.toLowerCase():" ")+uO;return this.txtID=uA._keymap[uq],this.txtID||(this.txtID=1e-7*++uA._keymapCount,uA._keymap[uq]=this.txtID),this},uA.clear=function(){uA._keymap={},uA._keymapCount=1},uA._keymap={},uA._keymapCount=1,uA}()},ul}(),u$W=function(){function ub(uW){this._index=0,this._size=14,this._italic=-2,ub._cache2=ub._cache2||[],this.setFont(uW||"14px Arial")}uQ(ub,"laya.webgl.text.FontInContext");var uW=ub.prototype;return uW.setFont=function(uW){var uj=ub._cache2[uW];if(uj)this._words=uj[0],this._size=uj[1];else{this._words=uW.split(" ");for(var ut=0,ud=this._words.length;ut<ud;ut++)if(0<this._words[ut].indexOf("px")){this._index=ut;break}this._size=parseInt(this._words[this._index]),ub._cache2[uW]=[this._words,this._size]}this._text=null,this._italic=-2},uW.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},uW.hasType=function(uW){for(var uj=0,ut=this._words.length;uj<ut;uj++)if(this._words[uj]===uW)return uj;return-1},uW.removeType=function(uW){for(var uj=0,ut=this._words.length;uj<ut;uj++)if(this._words[uj]===uW){this._words.splice(uj,1),this._index>uj&&this._index--;break}this._text=null,this._italic=-2},uW.copyTo=function(uW){return uW._text=this._text,uW._size=this._size,uW._index=this._index,uW._words=this._words.slice(),uW._italic=-2,uW},uW.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},ud(0,uW,"size",function(){return this._size},function(uW){this._size=uW,this._words[this._index]=uW+"px",this._text=null}),ub.create=function(uW){var uj=ub._cache[uW];return uj||(uj=ub._cache[uW]=new ub(uW))},ub.EMPTY=new ub,ub._cache={},ub._cache2=null,ub}(),ueW=function(){function uW(){}return uQ(uW,"laya.webgl.utils.CONST3D2D"),uW.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],uW.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],uW.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],uW._TMPARRAY=[],uW._OFFSETX=0,uW._OFFSETY=0,uO(uW,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),uW}(),uKW=function(){function u$(){}return uQ(u$,"laya.webgl.utils.GlUtils"),u$.make2DProjection=function(uW,uj,ut){return[2/uW,0,0,0,0,-2/uj,0,0,0,0,2/ut,0,-1,1,0,1]},u$.fillIBQuadrangle=function(uW,uj){if(65535/4<uj)throw Error("IBQuadrangle count:"+uj+" must<:"+Math.floor(65535/4));uj=Math.floor(uj),uW._resizeBuffer(6*(uj+1)*2,!1),uW.byteLength=uW.bufferLength;for(var ut=uW.getUint16Array(),ud=0,ub=0;ub<uj;ub++)ut[ud++]=4*ub,ut[ud++]=4*ub+2,ut[ud++]=4*ub+1,ut[ud++]=4*ub,ut[ud++]=4*ub+3,ut[ud++]=4*ub+2;return uW.setNeedUpload(),!0},u$.expandIBQuadrangle=function(uW,uj){uW.bufferLength>=6*uj*2||u$.fillIBQuadrangle(uW,uj)},u$.mathCeilPowerOfTwo=function(uW){return uW--,uW|=uW>>1,uW|=uW>>2,uW|=uW>>4,uW|=uW>>8,uW|=uW>>16,++uW},u$.fillQuadrangleImgVb=function(uW,uj,ut,ud,ub,uE,uO,uq){var uA=16+(uW._byteLength>>2);uW.byteLength=uA<<2;var uc=uW.getFloat32Array();uc[(uA-=16)+2]=ub[0],uc[uA+3]=ub[1],uc[uA+6]=ub[2],uc[uA+7]=ub[3],uc[uA+10]=ub[4],uc[uA+11]=ub[5],uc[uA+14]=ub[6],uc[uA+15]=ub[7];var uR=uE.a,um=uE.b,uQ=uE.c,uT=uE.d;if(1!==uR||0!==um||0!==uQ||1!==uT){uE.bTransform=!0;var u$=uE.tx+uO,ue=uE.ty+uq;uc[uA]=(ud[0]+uj)*uR+(ud[1]+ut)*uQ+u$,uc[uA+1]=(ud[0]+uj)*um+(ud[1]+ut)*uT+ue,uc[uA+4]=(ud[2]+uj)*uR+(ud[3]+ut)*uQ+u$,uc[uA+5]=(ud[2]+uj)*um+(ud[3]+ut)*uT+ue,uc[uA+8]=(ud[4]+uj)*uR+(ud[5]+ut)*uQ+u$,uc[uA+9]=(ud[4]+uj)*um+(ud[5]+ut)*uT+ue,uc[uA+12]=(ud[6]+uj)*uR+(ud[7]+ut)*uQ+u$,uc[uA+13]=(ud[6]+uj)*um+(ud[7]+ut)*uT+ue}else uE.bTransform=!1,uj+=uE.tx+uO,ut+=uE.ty+uq,uc[uA]=uj+ud[0],uc[uA+1]=ut+ud[1],uc[uA+4]=uj+ud[2],uc[uA+5]=ut+ud[3],uc[uA+8]=uj+ud[4],uc[uA+9]=ut+ud[5],uc[uA+12]=uj+ud[6],uc[uA+13]=ut+ud[7];return uW._upload=!0},u$.fillTranglesVB=function(uW,uj,ut,ud,ub,uE,uO){var uq=(uW._byteLength>>2)+ud.length;uW.byteLength=uq<<2;var uA=uW.getFloat32Array();uq-=ud.length;for(var uc=ud.length,uR=ub.a,um=ub.b,uQ=ub.c,uT=ub.d,u$=0;u$<uc;u$+=4)if(uA[uq+u$+2]=ud[u$+2],uA[uq+u$+3]=ud[u$+3],1!==uR||0!==um||0!==uQ||1!==uT){ub.bTransform=!0;var ue=ub.tx+uE,uK=ub.ty+uO;uA[uq+u$]=(ud[u$]+uj)*uR+(ud[u$+1]+ut)*uQ+ue,uA[uq+u$+1]=(ud[u$]+uj)*um+(ud[u$+1]+ut)*uT+uK}else ub.bTransform=!1,uj+=ub.tx+uE,ut+=ub.ty+uO,uA[uq+u$]=uj+ud[u$],uA[uq+u$+1]=ut+ud[u$+1];return uW._upload=!0},u$.copyPreImgVb=function(uW,uj,ut){var ud=uW._byteLength>>2;uW.byteLength=ud+16<<2;for(var ub=uW.getFloat32Array(),uE=0,uO=ud-16;uE<4;uE++)ub[ud]=ub[uO]+uj,++uO,ub[++ud]=ub[uO]+ut,++uO,ub[++ud]=ub[uO],++uO,ub[++ud]=ub[uO],++ud,++uO;uW._upload=!0},u$.fillRectImgVb=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR,um,uQ){void 0===uQ&&(uQ=!1);var uT,u$,ue,uK,uo,uS,uM,uZ,uX,u_,uN,uz,uC,uL,uV,ux,uG=1,ul=uq.a,uh=uq.b,uv=uq.c,uy=uq.d,ua=uj&&uj.width<99999999;if(1!==ul||0!==uh||0!==uv||1!==uy?(uq.bTransform=!0,0===uh&&0===uv&&(uG=23,uX=ub+ut,u_=uE+ud,uT=ul*ut+(uN=uq.tx+uA),ue=ul*uX+uN,u$=uy*ud+(uz=uq.ty+uc),uK=uy*u_+uz)):(uG=23,uq.bTransform=!1,ue=(uT=ut+uq.tx+uA)+ub,uK=(u$=ud+uq.ty+uc)+uE),ua&&(uo=uj.x,uS=uj.y,uM=uj.width+uo,uZ=uj.height+uS),1!==uG){if(Math.min(uT,ue)>=uM)return!1;if(Math.min(u$,uK)>=uZ)return!1;if(Math.max(ue,uT)<=uo)return!1;if(Math.max(uK,u$)<=uS)return!1}var uu=uW._byteLength>>2;uW.byteLength=16+uu<<2;var uD=uW.getFloat32Array();switch(uD[2+uu]=uO[0],uD[3+uu]=uO[1],uD[6+uu]=uO[2],uD[7+uu]=uO[3],uD[10+uu]=uO[4],uD[11+uu]=uO[5],uD[14+uu]=uO[6],uD[15+uu]=uO[7],uG){case 1:uN=uq.tx+uA,uz=uq.ty+uc;var us=ul*ut,uY=uv*ud,uH=uy*ud,uI=uh*ut,ug=ul*(uX=ub+ut),uf=uv*(u_=uE+ud),uw=uy*u_,uU=uh*uX;uQ?(uC=us+uY+uN,uV=Math.round(uC)-uC,uL=uH+uI+uz,ux=Math.round(uL)-uL,uD[uu]=uC+uV,uD[1+uu]=uL+ux,uD[4+uu]=ug+uY+uN+uV,uD[5+uu]=uH+uU+uz+ux,uD[8+uu]=ug+uf+uN+uV,uD[9+uu]=uw+uU+uz+ux,uD[12+uu]=us+uf+uN+uV,uD[13+uu]=uw+uI+uz+ux):(uD[uu]=us+uY+uN,uD[1+uu]=uH+uI+uz,uD[4+uu]=ug+uY+uN,uD[5+uu]=uH+uU+uz,uD[8+uu]=ug+uf+uN,uD[9+uu]=uw+uU+uz,uD[12+uu]=us+uf+uN,uD[13+uu]=uw+uI+uz);break;case 23:uQ?(uC=uT+uR,uV=Math.round(uC)-uC,uL=u$,ux=Math.round(uL)-uL,uD[uu]=uC+uV,uD[1+uu]=uL+ux,uD[4+uu]=ue+uR+uV,uD[5+uu]=u$+ux,uD[8+uu]=ue+uV,uD[9+uu]=uK+ux,uD[12+uu]=uT+uV,uD[13+uu]=uK+ux):(uD[uu]=uT+uR,uD[1+uu]=u$,uD[4+uu]=ue+uR,uD[5+uu]=u$,uD[8+uu]=ue,uD[9+uu]=uK,uD[12+uu]=uT,uD[13+uu]=uK)}return uW._upload=!0},u$.fillLineVb=function(uW,uj,ut,ud,ub,uE,uO,uq){var uA=.5*uO,uc=u$._fillLineArray,uR=-(ud-uE),um=ut-ub,uQ=Math.sqrt(uR*uR+um*um);uR/=uQ,um/=uQ,uR*=uA,um*=uA,uc[0]=ut-uR,uc[1]=ud-um,uc[4]=ut+uR,uc[5]=ud+um,uc[8]=ub+uR,uc[9]=uE+um,uc[12]=ub-uR,uc[13]=uE-um,uq&&uq.transformPointArray(uc,uc);var uT=16+(uW._byteLength>>2);return uW.byteLength=uT<<2,uW.insertData(uc,uT-16),!0},u$._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],u$}(),uoW=(function(){function uA(){}uQ(uA,"laya.webgl.utils.MatirxArray"),uA.ArrayMul=function(uW,uj,ut){if(uW)if(uj)for(var ud=NaN,ub=NaN,uE=NaN,uO=NaN,uq=0;uq<4;uq++)ud=uW[uq],ub=uW[uq+4],uE=uW[uq+8],uO=uW[uq+12],ut[uq]=ud*uj[0]+ub*uj[1]+uE*uj[2]+uO*uj[3],ut[uq+4]=ud*uj[4]+ub*uj[5]+uE*uj[6]+uO*uj[7],ut[uq+8]=ud*uj[8]+ub*uj[9]+uE*uj[10]+uO*uj[11],ut[uq+12]=ud*uj[12]+ub*uj[13]+uE*uj[14]+uO*uj[15];else uA.copyArray(uW,ut);else uA.copyArray(uj,ut)},uA.copyArray=function(uW,uj){if(uW&&uj)for(var ut=0;ut<uW.length;ut++)uj[ut]=uW[ut]}}(),function(){function uj(uW,uj,ut){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=uW,this._vb=new uFW(uW,35048),uj&&this._vb._resizeBuffer(uj,!1),this._ib=new upW,ut&&this._ib._resizeBuffer(ut,!1)}uQ(uj,"laya.webgl.utils.Mesh2D");var uW=uj.prototype;return uW.cloneWithNewVB=function(){var uW=new uj(this._stride,0,0);return uW._ib=this._ib,uW._quadNum=this._quadNum,uW._attribInfo=this._attribInfo,uW},uW.cloneWithNewVBIB=function(){var uW=new uj(this._stride,0,0);return uW._attribInfo=this._attribInfo,uW},uW.getVBW=function(){return this._vb.setNeedUpload(),this._vb},uW.getVBR=function(){return this._vb},uW.getIBR=function(){return this._ib},uW.getIBW=function(){return this._ib.setNeedUpload(),this._ib},uW.createQuadIB=function(uW){this._quadNum=uW,this._ib._resizeBuffer(6*uW*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var uj=this._ib.getUint16Array(),ut=0,ud=0,ub=0;ub<uW;ub++)uj[ut++]=ud,uj[ut++]=ud+2,uj[ut++]=ud+1,uj[ut++]=ud,uj[ut++]=ud+3,uj[ut++]=ud+2,ud+=4;this._ib.setNeedUpload()},uW.setAttributes=function(uW){if(this._attribInfo=uW,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},uW.getEleNum=function(){return this._ib.getBuffer().byteLength/2},uW.releaseMesh=function(){},uW.destroy=function(){},uW.clearVB=function(){this._vb.clear()},uj._gvaoid=0,uj}()),uSW=function(){function ub(){}return uQ(ub,"laya.webgl.utils.RenderState2D"),ub.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},ub.mat2MatArray=function(uW,uj){var ut=uW,ud=uj;return ud[0]=ut.a,ud[1]=ut.b,ud[2]=ub.EMPTYMAT4_ARRAY[2],ud[3]=ub.EMPTYMAT4_ARRAY[3],ud[4]=ut.c,ud[5]=ut.d,ud[6]=ub.EMPTYMAT4_ARRAY[6],ud[7]=ub.EMPTYMAT4_ARRAY[7],ud[8]=ub.EMPTYMAT4_ARRAY[8],ud[9]=ub.EMPTYMAT4_ARRAY[9],ud[10]=ub.EMPTYMAT4_ARRAY[10],ud[11]=ub.EMPTYMAT4_ARRAY[11],ud[12]=ut.tx,ud[13]=ut.ty,ud[14]=ub.EMPTYMAT4_ARRAY[14],ud[15]=ub.EMPTYMAT4_ARRAY[15],uj},ub.restoreTempArray=function(){ub.TEMPMAT4_ARRAY[0]=1,ub.TEMPMAT4_ARRAY[1]=0,ub.TEMPMAT4_ARRAY[4]=0,ub.TEMPMAT4_ARRAY[5]=1,ub.TEMPMAT4_ARRAY[12]=0,ub.TEMPMAT4_ARRAY[13]=0},ub.clear=function(){ub.worldScissorTest=!1,ub.worldShaderDefines=null,ub.worldFilters=null,ub.worldAlpha=1,ub.worldClipRect.x=ub.worldClipRect.y=0,ub.worldClipRect.width=ub.width,ub.worldClipRect.height=ub.height,ub.curRenderTarget=null},ub._MAXSIZE=99999999,ub.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ub.worldMatrix4=ub.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ub.worldAlpha=1,ub.worldScissorTest=!1,ub.worldFilters=null,ub.worldShaderDefines=null,ub.curRenderTarget=null,ub.width=0,ub.height=0,uO(ub,["worldMatrix",function(){return this.worldMatrix=new uC},"worldClipRect",function(){return this.worldClipRect=new uV(0,0,99999999,99999999)}]),ub}(),uMW=function(){var uS,ut;function uM(uW,uj,ut,ud,ub){var uE=this;function uO(uW){var uj=[],ut=new uS(uj);return uE._compileToTree(ut,uW.split("\n"),0,uj,ub),ut}var uq=uT.now();this._VS=uO(uj),this._PS=uO(ut),this._nameMap=ud,2<uT.now()-uq&&console.log("ShaderCompile use time:"+(uT.now()-uq)+"  size:"+uj.length+"/"+ut.length)}uQ(uM,"laya.webgl.utils.ShaderCompile");var uW=uM.prototype;return uW._compileToTree=function(uW,uj,ut,ud,ub){var uE,uO,uq,uA,uc,uR,um,uQ=0,uT=0,u$=0,ue=0;for(uT=ut;uT<uj.length;uT++)if(!((uq=uj[uT]).length<1)&&0!==(uQ=uq.indexOf("//"))){if(0<=uQ&&(uq=uq.substr(0,uQ)),uE=um||new uS(ud),um=null,uE.text=uq,uE.noCompile=!0,0<=(uQ=uq.indexOf("#"))){for(uA="#",ue=uQ+1,u$=uq.length;ue<u$;ue++){var uK=uq.charAt(ue);if(" "===uK||"\t"===uK||"\r"===uK||"\n"===uK||"?"===uK)break;uA+=uK}switch(uE.name=uA){case"#ifdef":case"#ifndef":if(uE.src=uq,uE.noCompile=null!=uq.match(/[!&|()=<>]/),uE.noCompile?console.log("function():Boolean{return "+uq.substr(uQ+uE.name.length)+"}"):(uR=uq.replace(/^\s*/,"").split(/\s+/),uE.setCondition(uR[1],"#ifdef"===uA?1:2),uE.text="//"+uE.text),uE.setParent(uW),uW=uE,ub)for(uR=uq.substr(ue).split(uM._splitToWordExps3),ue=0;ue<uR.length;ue++)(uq=uR[ue]).length&&(ub[uq]=!0);continue;case"#if":if(uE.src=uq,uE.noCompile=!0,uE.setParent(uW),uW=uE,ub)for(uR=uq.substr(ue).split(uM._splitToWordExps3),ue=0;ue<uR.length;ue++)(uq=uR[ue]).length&&"defined"!=uq&&(ub[uq]=!0);continue;case"#else":uE.src=uq,uO=(uW=uW.parent).childs[uW.childs.length-1],uE.noCompile=uO.noCompile,uE.noCompile||(uE.condition=uO.condition,uE.conditionType=1==uO.conditionType?2:1,uE.text="//"+uE.text+" "+uO.text+" "+uE.conditionType),uE.setParent(uW),uW=uE;continue;case"#endif":uO=(uW=uW.parent).childs[uW.childs.length-1],uE.noCompile=uO.noCompile,uE.noCompile||(uE.text="//"+uE.text),uE.setParent(uW);continue;case"#include":uR=uM.splitToWords(uq,null);var uo=uM.includes[uR[1]];if(!uo)throw"ShaderCompile error no this include file:"+uR[1];if((uQ=uR[0].indexOf("?"))<0){uE.setParent(uW),uq=uo.getWith("with"==uR[2]?uR[3]:null),this._compileToTree(uE,uq.split("\n"),0,ud,ub),uE.text="";continue}uE.setCondition(uR[0].substr(uQ+1),1),uE.text=uo.getWith("with"==uR[2]?uR[3]:null);break;case"#import":uc=(uR=uM.splitToWords(uq,null))[1],ud.push({node:uE,file:uM.includes[uc],ofs:uE.text.length});continue}}else{if((uO=uW.childs[uW.childs.length-1])&&!uO.name){0<ud.length&&uM.splitToWords(uq,uO),um=uE,uO.text+="\n"+uq;continue}0<ud.length&&uM.splitToWords(uq,uE)}uE.setParent(uW)}},uW.createShader=function(uW,uj,ut){var ud={},ub="";if(uW)for(var uE in uW)ub+="#define "+uE+"\n",ud[uE]=!0;var uO=this._VS.toscript(ud,[]),uq=this._PS.toscript(ud,[]);return(ut||uiW.create)(ub+uO.join("\n"),ub+uq.join("\n"),uj,this._nameMap)},uM._parseOne=function(uW,uj,ut,ud,ub,uE){var uO={type:uM.shaderParamsMap[ut[ud+1]],name:ut[ud+2],size:isNaN(parseInt(ut[ud+3]))?1:parseInt(ut[ud+3])};return uE&&("attribute"==ub?uW.push(uO):uj.push(uO)),":"==ut[ud+3]&&(uO.type=ut[ud+4],ud+=2),ud+=2},uM.addInclude=function(uW,uj){if(!uj||0===uj.length)throw new Error("add shader include file err:"+uW);if(uM.includes[uW])throw new Error("add shader include file err, has add:"+uW);uM.includes[uW]=new ut(uj)},uM.preGetParams=function(uW,uj){var ut=[uW,uj],ud={},ub=[],uE=[],uO={},uq=[];ud.attributes=ub,ud.uniforms=uE,ud.defines=uO;for(var uA=0,uc=0,uR=0;uR<2;uR++){ut[uR]=ut[uR].replace(uM._removeAnnotation,"");var um,uQ=ut[uR].match(uM._reg);for(uA=0,uc=uQ.length;uA<uc;uA++){var uT=uQ[uA];if("attribute"==uT||"uniform"==uT)uA=uM._parseOne(ub,uE,uQ,uA,uT,!0);else{if("#define"==uT){uq[uT=uQ[++uA]]=1;continue}if("#ifdef"==uT){uO[um=uQ[++uA]]=uO[um]||[];for(uA++;uA<uc;uA++)if("attribute"==(uT=uQ[uA])||"uniform"==uT)uA=uM._parseOne(ub,uE,uQ,uA,uT,uq[um]);else if("#else"==uT)for(uA++;uA<uc;uA++)if("attribute"==(uT=uQ[uA])||"uniform"==uT)uA=uM._parseOne(ub,uE,uQ,uA,uT,!uq[um]);else if("#endif"==uT)break}}}}return ud},uM.splitToWords=function(uW,uj){for(var ut,ud,ub=[],uE=-1,uO=0,uq=uW.length;uO<uq;uO++)if(ut=uW.charAt(uO),0<=" \t=+-*/&%!<>()'\",;".indexOf(ut)){if(0<=uE&&1<uO-uE&&(ud=uW.substr(uE,uO-uE),ub.push(ud)),'"'==ut||"'"==ut){var uA=uW.indexOf(ut,uO+1);if(uA<0)throw"Sharder err:"+uW;ub.push(uW.substr(uO+1,uA-uO-1)),uO=uA,uE=-1;continue}"("==ut&&uj&&0<ub.length&&(ud=ub[ub.length-1]+";","vec4;main;".indexOf(ud)<0&&(uj.useFuns+=ud)),uE=-1}else uE<0&&(uE=uO);return uE<uq&&1<uq-uE&&(ud=uW.substr(uE,uq-uE),ub.push(ud)),ub},uM.IFDEF_NO=0,uM.IFDEF_YES=1,uM.IFDEF_ELSE=2,uM.IFDEF_PARENT=3,uM._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),uM._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),uM._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),uM.includes={},uO(uM,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),uM.__init$=function(){uS=function(){function ut(uW){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=uW}uQ(ut,"");var uW=ut.prototype;return uW.setParent=function(uW){uW.childs.push(this),this.z=uW.z+1,this.parent=uW},uW.setCondition=function(uW,uj){uW&&(this.conditionType=uj,uW=uW.replace(/(\s*$)/g,""),this.condition=function(){return this[uW]},this.condition.__condition=uW)},uW.toscript=function(uW,uj){return this._toscript(uW,uj,++ut.__id)},uW._toscript=function(ud,ub,uE){if(this.childs.length<1&&!this.text)return ub;ub.length;if(this.condition){var uW=!!this.condition.call(ud);if(2===this.conditionType&&(uW=!uW),!uW)return ub}if(this.text&&ub.push(this.text),0<this.childs.length&&this.childs.forEach(function(uW,uj,ut){uW._toscript(ud,ub,uE)}),0<this.includefiles.length&&0<this.useFuns.length)for(var uj,ut=0,uO=this.includefiles.length;ut<uO;ut++)this.includefiles[ut].curUseID!=uE&&0<(uj=this.includefiles[ut].file.getFunsScript(this.useFuns)).length&&(this.includefiles[ut].curUseID=uE,ub[0]=uj+ub[0]);return ub},ut.__id=1,ut}(),ut=function(){function uW(uW){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=uW;for(var uj=0,ut=0,ud=0;!((uj=uW.indexOf("#begin",uj))<0);){for(ud=uj+5;!((ud=uW.indexOf("#end",ud))<0)&&"i"===uW.charAt(ud+4);)ud+=5;if(ud<0)throw"add include err,no #end:"+uW;ut=uW.indexOf("\n",uj);var ub=uM.splitToWords(uW.substr(uj,ut-uj),null);"code"==ub[1]?this.codes[ub[2]]=uW.substr(ut+1,ud-ut-1):"function"==ub[1]&&(ut=uW.indexOf("function",uj),ut+="function".length,this.funs[ub[3]]=uW.substr(ut+1,ud-ut-1),this.funnames+=ub[3]+";"),uj=ud+1}}uQ(uW,"");var uj=uW.prototype;return uj.getWith=function(uW){var uj=uW?this.codes[uW]:this.script;if(!uj)throw"get with error:"+uW;return uj},uj.getFunsScript=function(uW){var uj="";for(var ut in this.funs)0<=uW.indexOf(ut+";")&&(uj+=this.funs[ut]);return uj},uW}()},uM}(),uZW=function(){function uO(){}return uQ(uO,"laya.webgl.WebGL"),uO._uint8ArraySlice=function(){for(var uW=this.length,uj=new Uint8Array(this.length),ut=0;ut<uW;ut++)uj[ut]=this[ut];return uj},uO._float32ArraySlice=function(){for(var uW=this.length,uj=new Float32Array(this.length),ut=0;ut<uW;ut++)uj[ut]=this[ut];return uj},uO._uint16ArraySlice=function(uW){var uj,ut=arguments,ud=0,ub=0;if(0===ut.length)for(ud=this.length,uj=new Uint16Array(ud),ub=0;ub<ud;ub++)uj[ub]=this[ub];else if(2===ut.length){var uE=ut[0],uO=ut[1];if(uE<uO)for(ud=uO-uE,uj=new Uint16Array(ud),ub=uE;ub<uO;ub++)uj[ub-uE]=this[ub];else uj=new Uint16Array(0)}return uj},uO.expandContext=function(){var uW=ub.prototype,uj=CanvasRenderingContext2D.prototype;uj.fillTrangles=uW.fillTrangles,uBW.__int__(null),uj.setIBVB=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){void 0===uA&&(uA=0),void 0===uc&&(uc=0),null===ut&&(this._ib=this._ib||upW.QuadrangleIB,ut=this._ib,uKW.expandIBQuadrangle(ut,ud._byteLength/64+8)),this._setIBVB(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc)},uj.fillTrangles=function(uW,uj,ut,ud,ub){this._curMat=this._curMat||uC.create(),this._vb=this._vb||uFW.create(),this._ib||(this._ib=upW.create(),uKW.fillIBQuadrangle(this._ib,uO/4));var uE=this._vb,uO=ud.length>>4;uKW.fillTranglesVB(uE,uj,ut,ud,ub||this._curMat,0,0),uKW.expandIBQuadrangle(this._ib,uE._byteLength/64+8);var uq=new uzW(1,0);uq.textureHost=uW;var uA=new ukW("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");uE._vertType=3,this._setIBVB(uj,ut,this._ib,uE,6*uO,ub,uA,uq,0,0)}},uO.enable=function(){if(uT.__init__(),uo.isConchApp&&!uo.isConchWebGL)return uX.skinAniSprite=function(){return new uWW},uO.expandContext(),!1;if(uX.getWebGLContext=function(uW){for(var uj,ut=["webgl","experimental-webgl","webkit-3d","moz-webgl"],ud=0;ud<ut.length;ud++){try{uj=uW.getContext(ut[ud],{stencil:uN.isStencil,alpha:uN.isAlpha,antialias:uN.isAntialias,premultipliedAlpha:uN.premultipliedAlpha,preserveDrawingBuffer:uN.preserveDrawingBuffer})}catch(uW){}if(uj)return uj}return null},null==(uO.mainContext=uX.getWebGLContext(uo._mainCanvas)))return!1;if(uo.isWebGL)return!0;ue.create=function(uW,uj){return new uWj(uW,uj)},uK.create=function(uW,uj,ut,ud,ub,uE,uO){return new uPW(uW,uj,ut,ud,ub,uE,uO)},uo.WebGL=uO,uo.isWebGL=!0,uTW.__init__(),uX.createRenderSprite=function(uW,uj){return new uCW(uW,uj)},uX.createWebGLContext2D=function(uW){return new uNW(uW)},uX.changeWebGLSize=function(uW,uj){laya.webgl.WebGL.onStageResize(uW,uj)},uX.createGraphics=function(){return new u_W};var uW=uX.createFilterAction;return uX.createFilterAction=uW||function(uW){return new uLW},uX.clear=function(uW){uSW.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var uj=uo.context.ctx,ut=0==uj._submits._length||uN.preserveDrawingBuffer?u$.create(uW)._color:uG._wgColor;ut&&uj.clearBG(ut[0],ut[1],ut[2],ut[3]),uSW.clear()},uX.addToAtlas=function(uW,uj){void 0===uj&&(uj=!1);var ut=uW.bitmap;uo.optimizeTextureMemory(uW.url,uW)?u_.__typeof(ut,"laya.webgl.resource.IMergeAtlasBitmap")&&ut.allowMerageInAtlas&&ut.on("recovered",uW,uW.addTextureToAtlas):ut.enableMerageInAtlas=!1},uX.isAtlas=function(uW){return uW instanceof laya.webgl.atlas.AtlasWebGLCanvas},uI._enable(),uX.beginFlush=function(){for(var uW=uI.instance,uj=uW.getAtlaserCount(),ut=0;ut<uj;ut++){var ud=uW.getAtlaserByIndex(ut).texture;ud._flashCacheImageNeedFlush&&uX.flashFlushImage(ud)}},uX.drawToCanvas=function(uW,uj,ut,ud,ub,uE){(ut<=0||ud<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),ut|=0,ud|=0,ub|=0,uE|=0;var uO=uDW.create(ut,ud,6408,5121,0,!1);uO.start(),uO.clear(0,0,0,0),uo.context.clear(),uS.renders[uj]._fun(uW,uo.context,ub,uSW.height-ud+uE),uo.context.flush(),uO.end();var uq=uO.getData(0,0,ut,ud);if(uO.recycle(),uq.byteLength==ut*ud*4){var uA=new uUW;uA._canvas=uT.createElement("canvas"),uA.size(ut,ud);var uc=uA._canvas.getContext("2d");uT.canvas.size(ut,ud);var uR=uT.context,um=uR.createImageData(ut,ud);return um.data.set(new Uint8ClampedArray(uq.buffer)),uA._imgData=um,uR.putImageData(um,0,0),uc.save(),uc.translate(0,ud),uc.scale(1,-1),uc.drawImage(uT.canvas.source,0,0),uc.restore(),uA}console.log("drawToCanvas error: w:"+ut+",h:"+ud+",datalen:"+uq.byteLength)},uX.createFilterAction=function(uW){var uj;switch(uW){case 32:uj=new uLW}return uj},uX.addTextureToAtlas=function(uW){uW._uvID++,uI._atlasRestore++,uW.bitmap.enableMerageInAtlas&&uI.instance.addToAtlas(uW)},uX.getTexturePixels=function(uW,uj,ut,ud,ub){uo.context.ctx.clear();var uE=new ux;uE.graphics.drawTexture(uW,-uj,-ut);var uO=uDW.create(ud,ub);uO.start(),uO.clear(0,0,0,0),uE.render(uo.context,0,0),uo.context.ctx.flush(),uO.end();for(var uq=uO.getData(0,0,ud,ub),uA=[],uc=0,uR=ub-1;0<=uR;uR--)for(var um=0;um<ud;um++)uc=4*(uR*ud+um),uA.push(uq[uc]),uA.push(uq[uc+1]),uA.push(uq[uc+2]),uA.push(uq[uc+3]);return uA},uX.skinAniSprite=function(){return new uWW},uc.create=function(uW,uj){var ut=new uUW;return ut._imgData=uj,ut.flipY=!1,ut},uz._filterStart=function(uW,uj,ut,ud,ub){var uE=uW.getValue("bounds"),uO=uDW.create(uE.width,uE.height);if(uO.start(),uO.clear(0,0,0,0),uW.addValue("src",uO),uW.addValue("ScissorTest",uSW.worldScissorTest),uSW.worldScissorTest){var uq=new uV;uq.copyFrom(ut.ctx._clipRect),uW.addValue("clipRect",uq),uSW.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},uz._filterEnd=function(uW,uj,ut,ud,ub){var uE=uW.getValue("bounds");uW.getValue("src").end();var uO=uDW.create(uE.width,uE.height);uO.start(),uO.clear(0,0,0,0),uW.addValue("out",uO),uj._set$P("_filterCache",uO),uj._set$P("_isHaveGlowFilter",uW.getValue("_isHaveGlowFilter"))},uz._EndTarget=function(uW,uj){if(uW.getValue("src").recycle(),uW.getValue("out").end(),uW.getValue("ScissorTest")){uSW.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),uj.ctx.save();var ut=uW.getValue("clipRect");uj.ctx.clipRect(ut.x,ut.y,ut.width,ut.height)}},uz._useSrc=function(uW){var uj=uW.getValue("out");uj.end(),(uj=uW.getValue("src")).start(),uj.clear(0,0,0,0)},uz._endSrc=function(uW){uW.getValue("src").end()},uz._useOut=function(uW){var uj=uW.getValue("src");uj.end(),(uj=uW.getValue("out")).start(),uj.clear(0,0,0,0)},uz._endOut=function(uW){uW.getValue("out").end()},uz._recycleScope=function(uW){uW.recycle()},uz._filter=function(uW,uj,ut,ud){var ub=this._next;if(ub){var uE,uO,uq=uW.filters,uA=uq.length;if(1==uA&&32==uq[0].type)return uj.ctx.save(),uj.ctx.setFilters([uq[0]]),ub._fun.call(ub,uW,uj,ut,ud),void uj.ctx.restore();var uc=uqW.create(),uR=uL.TEMP,um=uj.ctx._getTransformMatrix(),uQ=uC.create();um.copyTo(uQ);var uT=0,u$=0,ue=!1,uK=uW._$P._filterCache?uW._$P._filterCache:null;if(!uK||uW._repaint){ue=uW._isHaveGlowFilter(),uc.addValue("_isHaveGlowFilter",ue),ue&&(uT=50,u$=25),(uO=new uV).copyFrom(uW.getSelfBounds()),uO.x+=uW.x,uO.y+=uW.y,uO.x-=uW.pivotX+4,uO.y-=uW.pivotY+4;var uo=uO.x,uS=uO.y;if(uO.width+=uT+8,uO.height+=uT+8,uR.x=uO.x*uQ.a+uO.y*uQ.c,uR.y=uO.y*uQ.d+uO.x*uQ.b,uO.x=uR.x,uO.y=uR.y,uR.x=uO.width*uQ.a+uO.height*uQ.c,uR.y=uO.height*uQ.d+uO.width*uQ.b,uO.width=uR.x,uO.height=uR.y,uO.width<=0||uO.height<=0)return;uK&&uK.recycle(),uc.addValue("bounds",uO);var uM=uOW.create([uc,uW,uj,0,0],uz._filterStart);uj.addRenderObject(uM),uj.ctx._renderKey=0,uj.ctx._shader2D.glTexture=null;var uZ=uW.x-uo+u$,uX=uW.y-uS+u$;ub._fun.call(ub,uW,uj,uZ,uX),uM=uOW.create([uc,uW,uj,0,0],uz._filterEnd),uj.addRenderObject(uM);for(var u_=0;u_<uA;u_++){0!=u_&&(uM=uOW.create([uc],uz._useSrc),uj.addRenderObject(uM),uE=uzW.create(1,0),uC.TEMP.identity(),uj.ctx.drawTarget(uc,0,0,uO.width,uO.height,uC.TEMP,"out",uE,null,uf.TOINT.overlay),uM=uOW.create([uc],uz._useOut),uj.addRenderObject(uM)),uq[u_].action.apply3d(uc,uW,uj,0,0)}uM=uOW.create([uc,uj],uz._EndTarget),uj.addRenderObject(uM)}else{if((ue=!!uW._$P._isHaveGlowFilter&&uW._$P._isHaveGlowFilter)&&(uT=50,u$=25),(uO=uW.getBounds()).width<=0||uO.height<=0)return;uO.width+=uT,uO.height+=uT,uR.x=uO.x*uQ.a+uO.y*uQ.c,uR.y=uO.y*uQ.d+uO.x*uQ.b,uO.x=uR.x,uO.y=uR.y,uR.x=uO.width*uQ.a+uO.height*uQ.c,uR.y=uO.height*uQ.d+uO.width*uQ.b,uO.width=uR.x,uO.height=uR.y,uc.addValue("out",uK)}ut=ut-u$-uW.x,ud=ud-u$-uW.y,uR.setTo(ut,ud),uQ.transformPoint(uR),ut=uR.x+uO.x,ud=uR.y+uO.y,uE=uzW.create(1,0),uC.TEMP.identity(),uj.ctx.drawTarget(uc,ut,ud,uO.width,uO.height,uC.TEMP,"out",uE,null,uf.TOINT.overlay),uM=uOW.create([uc],uz._recycleScope),uj.addRenderObject(uM),uQ.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=uO._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=uO._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=uO._uint8ArraySlice),!0},uO.onStageResize=function(uW,uj){null!=uO.mainContext&&(uO.mainContext.viewport(0,0,uW,uj),uSW.width=uW,uSW.height=uj)},uO.onInvalidGLRes=function(){uI.instance.freeAll(),uZ.releaseContentManagers(!0),uO.doNodeRepaint(u_.stage),uO.mainContext.viewport(0,0,uSW.width,uSW.height),u_.stage.event("devicelost")},uO.doNodeRepaint=function(uW){0==uW.numChildren&&uW.repaint();for(var uj=0;uj<uW.numChildren;uj++)uO.doNodeRepaint(uW.getChildAt(uj))},uO.init=function(uW,uj,ut){uO.mainCanvas=uW,uc._createContext=function(uW){return new uNW(uW)},uUW._createContext=function(uW){return new uNW(uW)};var ud=laya.webgl.WebGL.mainContext;if(null!=ud.getShaderPrecisionFormat){var ub=ud.getShaderPrecisionFormat(35633,36338),uE=ud.getShaderPrecisionFormat(35632,36338);uO.shaderHighPrecision=!(!ub.precision||!uE.precision)}else uO.shaderHighPrecision=!1;if(ud.deleteTexture1=ud.deleteTexture,ud.deleteTexture=function(uW){uW==uXW.curBindTexValue&&(uXW.curBindTexValue=null),ud.deleteTexture1(uW)},uO.onStageResize(uj,ut),null==uO.mainContext)throw new Error("webGL getContext err!");uv.__init__(),uI.__init__(),uxW.__init__(),uEW.__init__(),uNW.__init__(),uzW.__init__(),up.__init__(),uBW.__int__(ud),uf._init_(ud),uo.isConchApp&&conch.setOnInvalidGLRes(uO.onInvalidGLRes)},uO.mainCanvas=null,uO.mainContext=null,uO.antialias=!0,uO.shaderHighPrecision=!1,uO._bg_null=[0,0,0,0],uO}(),uXW=function(){function ud(){}return uQ(ud,"laya.webgl.WebGLContext"),ud.UseProgram=function(uW){return ud._useProgram!==uW&&(uZW.mainContext.useProgram(uW),ud._useProgram=uW,!0)},ud.setDepthTest=function(uW,uj){uj!==ud._depthTest&&((ud._depthTest=uj)?uW.enable(2929):uW.disable(2929))},ud.setDepthMask=function(uW,uj){uj!==ud._depthMask&&(ud._depthMask=uj,uW.depthMask(uj))},ud.setDepthFunc=function(uW,uj){uj!==ud._depthFunc&&(ud._depthFunc=uj,uW.depthFunc(uj))},ud.setBlend=function(uW,uj){uj!==ud._blend&&((ud._blend=uj)?uW.enable(3042):uW.disable(3042))},ud.setBlendFunc=function(uW,uj,ut){(uj!==ud._sFactor||ut!==ud._dFactor)&&(ud._sFactor=uj,ud._dFactor=ut,uW.blendFunc(uj,ut))},ud.setCullFace=function(uW,uj){uj!==ud._cullFace&&((ud._cullFace=uj)?uW.enable(2884):uW.disable(2884))},ud.setFrontFace=function(uW,uj){uj!==ud._frontFace&&(ud._frontFace=uj,uW.frontFace(uj))},ud.bindTexture=function(uW,uj,ut){uW.bindTexture(uj,ut),ud.curBindTexTarget=uj,ud.curBindTexValue=ut},ud.DEPTH_BUFFER_BIT=256,ud.STENCIL_BUFFER_BIT=1024,ud.COLOR_BUFFER_BIT=16384,ud.POINTS=0,ud.LINES=1,ud.LINE_LOOP=2,ud.LINE_STRIP=3,ud.TRIANGLES=4,ud.TRIANGLE_STRIP=5,ud.TRIANGLE_FAN=6,ud.ZERO=0,ud.ONE=1,ud.SRC_COLOR=768,ud.ONE_MINUS_SRC_COLOR=769,ud.SRC_ALPHA=770,ud.ONE_MINUS_SRC_ALPHA=771,ud.DST_ALPHA=772,ud.ONE_MINUS_DST_ALPHA=773,ud.DST_COLOR=774,ud.ONE_MINUS_DST_COLOR=775,ud.SRC_ALPHA_SATURATE=776,ud.FUNC_ADD=32774,ud.BLEND_EQUATION=32777,ud.BLEND_EQUATION_RGB=32777,ud.BLEND_EQUATION_ALPHA=34877,ud.FUNC_SUBTRACT=32778,ud.FUNC_REVERSE_SUBTRACT=32779,ud.BLEND_DST_RGB=32968,ud.BLEND_SRC_RGB=32969,ud.BLEND_DST_ALPHA=32970,ud.BLEND_SRC_ALPHA=32971,ud.CONSTANT_COLOR=32769,ud.ONE_MINUS_CONSTANT_COLOR=32770,ud.CONSTANT_ALPHA=32771,ud.ONE_MINUS_CONSTANT_ALPHA=32772,ud.BLEND_COLOR=32773,ud.ARRAY_BUFFER=34962,ud.ELEMENT_ARRAY_BUFFER=34963,ud.ARRAY_BUFFER_BINDING=34964,ud.ELEMENT_ARRAY_BUFFER_BINDING=34965,ud.STREAM_DRAW=35040,ud.STATIC_DRAW=35044,ud.DYNAMIC_DRAW=35048,ud.BUFFER_SIZE=34660,ud.BUFFER_USAGE=34661,ud.CURRENT_VERTEX_ATTRIB=34342,ud.FRONT=1028,ud.BACK=1029,ud.CULL_FACE=2884,ud.FRONT_AND_BACK=1032,ud.BLEND=3042,ud.DITHER=3024,ud.STENCIL_TEST=2960,ud.DEPTH_TEST=2929,ud.SCISSOR_TEST=3089,ud.POLYGON_OFFSET_FILL=32823,ud.SAMPLE_ALPHA_TO_COVERAGE=32926,ud.SAMPLE_COVERAGE=32928,ud.NO_ERROR=0,ud.INVALID_ENUM=1280,ud.INVALID_VALUE=1281,ud.INVALID_OPERATION=1282,ud.OUT_OF_MEMORY=1285,ud.CW=2304,ud.CCW=2305,ud.LINE_WIDTH=2849,ud.ALIASED_POINT_SIZE_RANGE=33901,ud.ALIASED_LINE_WIDTH_RANGE=33902,ud.CULL_FACE_MODE=2885,ud.FRONT_FACE=2886,ud.DEPTH_RANGE=2928,ud.DEPTH_WRITEMASK=2930,ud.DEPTH_CLEAR_VALUE=2931,ud.DEPTH_FUNC=2932,ud.STENCIL_CLEAR_VALUE=2961,ud.STENCIL_FUNC=2962,ud.STENCIL_FAIL=2964,ud.STENCIL_PASS_DEPTH_FAIL=2965,ud.STENCIL_PASS_DEPTH_PASS=2966,ud.STENCIL_REF=2967,ud.STENCIL_VALUE_MASK=2963,ud.STENCIL_WRITEMASK=2968,ud.STENCIL_BACK_FUNC=34816,ud.STENCIL_BACK_FAIL=34817,ud.STENCIL_BACK_PASS_DEPTH_FAIL=34818,ud.STENCIL_BACK_PASS_DEPTH_PASS=34819,ud.STENCIL_BACK_REF=36003,ud.STENCIL_BACK_VALUE_MASK=36004,ud.STENCIL_BACK_WRITEMASK=36005,ud.VIEWPORT=2978,ud.SCISSOR_BOX=3088,ud.COLOR_CLEAR_VALUE=3106,ud.COLOR_WRITEMASK=3107,ud.UNPACK_ALIGNMENT=3317,ud.PACK_ALIGNMENT=3333,ud.MAX_TEXTURE_SIZE=3379,ud.MAX_VIEWPORT_DIMS=3386,ud.SUBPIXEL_BITS=3408,ud.RED_BITS=3410,ud.GREEN_BITS=3411,ud.BLUE_BITS=3412,ud.ALPHA_BITS=3413,ud.DEPTH_BITS=3414,ud.STENCIL_BITS=3415,ud.POLYGON_OFFSET_UNITS=10752,ud.POLYGON_OFFSET_FACTOR=32824,ud.TEXTURE_BINDING_2D=32873,ud.SAMPLE_BUFFERS=32936,ud.SAMPLES=32937,ud.SAMPLE_COVERAGE_VALUE=32938,ud.SAMPLE_COVERAGE_INVERT=32939,ud.NUM_COMPRESSED_TEXTURE_FORMATS=34466,ud.COMPRESSED_TEXTURE_FORMATS=34467,ud.DONT_CARE=4352,ud.FASTEST=4353,ud.NICEST=4354,ud.GENERATE_MIPMAP_HINT=33170,ud.BYTE=5120,ud.UNSIGNED_BYTE=5121,ud.SHORT=5122,ud.UNSIGNED_SHORT=5123,ud.INT=5124,ud.UNSIGNED_INT=5125,ud.FLOAT=5126,ud.DEPTH_COMPONENT=6402,ud.ALPHA=6406,ud.RGB=6407,ud.RGBA=6408,ud.LUMINANCE=6409,ud.LUMINANCE_ALPHA=6410,ud.UNSIGNED_SHORT_4_4_4_4=32819,ud.UNSIGNED_SHORT_5_5_5_1=32820,ud.UNSIGNED_SHORT_5_6_5=33635,ud.FRAGMENT_SHADER=35632,ud.VERTEX_SHADER=35633,ud.MAX_VERTEX_ATTRIBS=34921,ud.MAX_VERTEX_UNIFORM_VECTORS=36347,ud.MAX_VARYING_VECTORS=36348,ud.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,ud.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,ud.MAX_TEXTURE_IMAGE_UNITS=34930,ud.MAX_FRAGMENT_UNIFORM_VECTORS=36349,ud.SHADER_TYPE=35663,ud.DELETE_STATUS=35712,ud.LINK_STATUS=35714,ud.VALIDATE_STATUS=35715,ud.ATTACHED_SHADERS=35717,ud.ACTIVE_UNIFORMS=35718,ud.ACTIVE_ATTRIBUTES=35721,ud.SHADING_LANGUAGE_VERSION=35724,ud.CURRENT_PROGRAM=35725,ud.NEVER=512,ud.LESS=513,ud.EQUAL=514,ud.LEQUAL=515,ud.GREATER=516,ud.NOTEQUAL=517,ud.GEQUAL=518,ud.ALWAYS=519,ud.KEEP=7680,ud.REPLACE=7681,ud.INCR=7682,ud.DECR=7683,ud.INVERT=5386,ud.INCR_WRAP=34055,ud.DECR_WRAP=34056,ud.VENDOR=7936,ud.RENDERER=7937,ud.VERSION=7938,ud.NEAREST=9728,ud.LINEAR=9729,ud.NEAREST_MIPMAP_NEAREST=9984,ud.LINEAR_MIPMAP_NEAREST=9985,ud.NEAREST_MIPMAP_LINEAR=9986,ud.LINEAR_MIPMAP_LINEAR=9987,ud.TEXTURE_MAG_FILTER=10240,ud.TEXTURE_MIN_FILTER=10241,ud.TEXTURE_WRAP_S=10242,ud.TEXTURE_WRAP_T=10243,ud.TEXTURE_2D=3553,ud.TEXTURE=5890,ud.TEXTURE_CUBE_MAP=34067,ud.TEXTURE_BINDING_CUBE_MAP=34068,ud.TEXTURE_CUBE_MAP_POSITIVE_X=34069,ud.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,ud.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,ud.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,ud.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,ud.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,ud.MAX_CUBE_MAP_TEXTURE_SIZE=34076,ud.TEXTURE0=33984,ud.TEXTURE1=33985,ud.TEXTURE2=33986,ud.TEXTURE3=33987,ud.TEXTURE4=33988,ud.TEXTURE5=33989,ud.TEXTURE6=33990,ud.TEXTURE7=33991,ud.TEXTURE8=33992,ud.TEXTURE9=33993,ud.TEXTURE10=33994,ud.TEXTURE11=33995,ud.TEXTURE12=33996,ud.TEXTURE13=33997,ud.TEXTURE14=33998,ud.TEXTURE15=33999,ud.TEXTURE16=34e3,ud.TEXTURE17=34001,ud.TEXTURE18=34002,ud.TEXTURE19=34003,ud.TEXTURE20=34004,ud.TEXTURE21=34005,ud.TEXTURE22=34006,ud.TEXTURE23=34007,ud.TEXTURE24=34008,ud.TEXTURE25=34009,ud.TEXTURE26=34010,ud.TEXTURE27=34011,ud.TEXTURE28=34012,ud.TEXTURE29=34013,ud.TEXTURE30=34014,ud.TEXTURE31=34015,ud.ACTIVE_TEXTURE=34016,ud.REPEAT=10497,ud.CLAMP_TO_EDGE=33071,ud.MIRRORED_REPEAT=33648,ud.FLOAT_VEC2=35664,ud.FLOAT_VEC3=35665,ud.FLOAT_VEC4=35666,ud.INT_VEC2=35667,ud.INT_VEC3=35668,ud.INT_VEC4=35669,ud.BOOL=35670,ud.BOOL_VEC2=35671,ud.BOOL_VEC3=35672,ud.BOOL_VEC4=35673,ud.FLOAT_MAT2=35674,ud.FLOAT_MAT3=35675,ud.FLOAT_MAT4=35676,ud.SAMPLER_2D=35678,ud.SAMPLER_CUBE=35680,ud.VERTEX_ATTRIB_ARRAY_ENABLED=34338,ud.VERTEX_ATTRIB_ARRAY_SIZE=34339,ud.VERTEX_ATTRIB_ARRAY_STRIDE=34340,ud.VERTEX_ATTRIB_ARRAY_TYPE=34341,ud.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,ud.VERTEX_ATTRIB_ARRAY_POINTER=34373,ud.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,ud.COMPILE_STATUS=35713,ud.LOW_FLOAT=36336,ud.MEDIUM_FLOAT=36337,ud.HIGH_FLOAT=36338,ud.LOW_INT=36339,ud.MEDIUM_INT=36340,ud.HIGH_INT=36341,ud.FRAMEBUFFER=36160,ud.RENDERBUFFER=36161,ud.RGBA4=32854,ud.RGB5_A1=32855,ud.RGB565=36194,ud.DEPTH_COMPONENT16=33189,ud.STENCIL_INDEX=6401,ud.STENCIL_INDEX8=36168,ud.DEPTH_STENCIL=34041,ud.RENDERBUFFER_WIDTH=36162,ud.RENDERBUFFER_HEIGHT=36163,ud.RENDERBUFFER_INTERNAL_FORMAT=36164,ud.RENDERBUFFER_RED_SIZE=36176,ud.RENDERBUFFER_GREEN_SIZE=36177,ud.RENDERBUFFER_BLUE_SIZE=36178,ud.RENDERBUFFER_ALPHA_SIZE=36179,ud.RENDERBUFFER_DEPTH_SIZE=36180,ud.RENDERBUFFER_STENCIL_SIZE=36181,ud.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,ud.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,ud.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,ud.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,ud.COLOR_ATTACHMENT0=36064,ud.DEPTH_ATTACHMENT=36096,ud.STENCIL_ATTACHMENT=36128,ud.DEPTH_STENCIL_ATTACHMENT=33306,ud.NONE=0,ud.FRAMEBUFFER_COMPLETE=36053,ud.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,ud.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,ud.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,ud.FRAMEBUFFER_UNSUPPORTED=36061,ud.FRAMEBUFFER_BINDING=36006,ud.RENDERBUFFER_BINDING=36007,ud.MAX_RENDERBUFFER_SIZE=34024,ud.INVALID_FRAMEBUFFER_OPERATION=1286,ud.UNPACK_FLIP_Y_WEBGL=37440,ud.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,ud.CONTEXT_LOST_WEBGL=37442,ud.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,ud.BROWSER_DEFAULT_WEBGL=37444,ud._useProgram=null,ud._depthTest=!0,ud._depthMask=!0,ud._blend=!1,ud._cullFace=!1,ud.curBindTexTarget=null,ud.curBindTexValue=null,uO(ud,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),ud}(),u_W=function(uW){function uj(){uj.__super.call(this)}uQ(uj,"laya.webgl.display.GraphicsGL",uq);var ut=uj.prototype;return ut.setShader=function(uW){this._saveToCmd(uo.context._setShader,[uW])},ut.setIBVB=function(uW,uj,ut,ud,ub,uE){this._saveToCmd(uo.context._setIBVB,[uW,uj,ut,ud,ub,uE])},ut.drawParticle=function(uW,uj,ut){var ud=uX.createParticleTemplate2D(ut);ud.x=uW,ud.y=uj,this._saveToCmd(uo.context._drawParticle,[ud])},uj}(),uNW=function(uW){var ut;function uH(uW){this._x=0,this._y=0,this._id=++uH._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,uH.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=uH.MAXCLIPRECT,this.mOutPoint,this._canvas=uW,this._canvas._addReference(),uH._contextcount++,uo.isFlash?(this._ib=upW.create(35044),uKW.fillIBQuadrangle(this._ib,16)):this._ib=upW.QuadrangleIB,this.clear()}uQ(uH,"laya.webgl.canvas.WebGLContext2D",ub);var uj=uH.prototype;return uj.setIsMainContext=function(){this._isMain=!0},uj.clearBG=function(uW,uj,ut,ud){var ub=uZW.mainContext;ub.clearColor(uW,uj,ut,ud),ub.clear(16384)},uj._getSubmits=function(){return this._submits},uj._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var uW=0,uj=this._submits._length;uW<uj;uW++)this._submits[uW].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},uj.destroy=function(){--uH._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=upW.QuadrangleIB&&this._ib.releaseResource()},uj.clear=function(){this._submits||(this._other=ut.DEFAULT,this._curMat=uC.create(),this._vb=uFW.create(-1),this._submits=[],this._save=[ui.Create(this)],this._save.length=10,this._shader2D=new up,this._triangleMesh=uaW.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=ut.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=uH.MAXCLIPRECT,this._curSubmit=uEW.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=uw.DEFAULT;for(var uW=0,uj=this._submits._length;uW<uj;uW++)this._submits[uW].releaseRender(),this._submits[uW]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},uj.size=function(uW,uj){if(this._width!=uW||this._height!=uj)if(0==uW||0==uj){0!=this._vb._byteLength&&(this._width=uW,this._height=uj,this._vb.clear(),this._vb.upload());for(var ut=0,ud=this._submits._length;ut<ud;ut++)this._submits[ut].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=uW,this._height=uj,this._targets&&this._targets.size(uW,uj),this._canvas.memorySize-=this._canvas.memorySize;0===uW&&0===uj&&this._releaseMem()},uj._getTransformMatrix=function(){return this._curMat},uj.translate=function(uW,uj){0===uW&&0===uj||(un.save(this),this._curMat.bTransform&&(uB.save(this),this._curMat.transformPointN(uL.TEMP.setTo(uW,uj)),uW=uL.TEMP.x,uj=uL.TEMP.y),this._x+=uW,this._y+=uj)},uj.save=function(){this._save[this._save._length++]=ui.Create(this)},uj.restore=function(){var uW=this._save._length;if(!(uW<1))for(var uj=uW-1;0<=uj;uj--){var ut=this._save[uj];if(ut.restore(this),ut.isSaveMark())return void(this._save._length=uj)}},uj._fillText=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){void 0===uc&&(uc=0);var uR=this._shader2D,um=this._curSubmit.shaderValue,uQ=ub?u$W.create(ub):this._other.font;if(uI.enabled)uR.ALPHA!==um.ALPHA&&(uR.glTexture=null),uTW.drawText(this,uW,uj,this._curMat,uQ,uA||this._other.textAlign,uE,uO,uq,ut,ud,uc);else{this._shader2D.defines.getValue();var uT=uE?u$.create(uE)._color:uR.colorAdd;uR.ALPHA===um.ALPHA&&uT===uR.colorAdd&&um.colorAdd===uR.colorAdd||(uR.glTexture=null,uR.colorAdd=uT),uTW.drawText(this,uW,uj,this._curMat,uQ,uA||this._other.textAlign,uE,uO,uq,ut,ud,uc)}},uj.fillWords=function(uW,uj,ut,ud,ub,uE){this._fillText(null,uW,uj,ut,ud,ub,null,-1,null,uE)},uj.fillBorderWords=function(uW,uj,ut,ud,ub,uE,uO){this._fillBorderText(null,uW,uj,ut,ud,ub,uE,uO,null)},uj.fillText=function(uW,uj,ut,ud,ub,uE){this._fillText(uW,null,uj,ut,ud,ub,null,-1,uE)},uj.strokeText=function(uW,uj,ut,ud,ub,uE,uO){this._fillText(uW,null,uj,ut,ud,null,ub,uE||1,uO)},uj.fillBorderText=function(uW,uj,ut,ud,ub,uE,uO,uq){this._fillBorderText(uW,null,uj,ut,ud,ub,uE,uO,uq)},uj._fillBorderText=function(uW,uj,ut,ud,ub,uE,uO,uq,uA){if(!uI.enabled)return this._fillText(uW,uj,ut,ud,ub,null,uO,uq||1,uA),void this._fillText(uW,uj,ut,ud,ub,uE,null,-1,uA);var uc=this._shader2D,uR=this._curSubmit.shaderValue;uc.ALPHA!==uR.ALPHA&&(uc.glTexture=null);var um=ub?(uH._fontTemp.setFont(ub),uH._fontTemp):this._other.font;uTW.drawText(this,uW,uj,this._curMat,um,uA||this._other.textAlign,uE,uO,uq||1,ut,ud,0)},uj.fillRect=function(uW,uj,ut,ud,ub){var uE=this._vb;if(uKW.fillRectImgVb(uE,this._clipRect,uW,uj,ut,ud,ua.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var uO=this._shader2D.fillStyle;ub&&(this._shader2D.fillStyle=uw.create(ub));var uq=this._shader2D,uA=this._curSubmit.shaderValue;if(uq.fillStyle!==uA.fillStyle||uq.ALPHA!==uA.ALPHA){uq.glTexture=null;var uc=this._curSubmit=uEW.createSubmit(this,this._ib,uE,(uE._byteLength-64)/32*3,uzW.create(2,0));uc.shaderValue.color=uq.fillStyle._color._color,uc.shaderValue.ALPHA=uq.ALPHA,this._submits[this._submits._length++]=uc}this._curSubmit._numEle+=6,this._shader2D.fillStyle=uO}},uj.fillTexture=function(uW,uj,ut,ud,ub,uE,uO,uq){if(uW.loaded&&uW.bitmap&&uW.source){var uA=this._vb,uc=uW.bitmap.width,uR=uW.bitmap.height,um=uW.uv,uQ=uO.x%uW.width,uT=uO.y%uW.height;if(uc!=uq.w||uR!=uq.h){if(!uq.w&&!uq.h)switch(uq.oy=uq.ox=0,uE){case"repeat":uq.width=ud,uq.height=ub;break;case"repeat-x":uq.width=ud,uT<0?uW.height+uT>ub?uq.height=ub:uq.height=uW.height+uT:(uq.oy=uT,uW.height+uT>ub?uq.height=ub-uT:uq.height=uW.height);break;case"repeat-y":uQ<0?uW.width+uQ>ud?uq.width=ud:uq.width=uW.width+uQ:(uq.ox=uQ,uW.width+uQ>ud?uq.width=ud-uQ:uq.width=uW.width),uq.height=ub;break;case"no-repeat":uQ<0?uW.width+uQ>ud?uq.width=ud:uq.width=uW.width+uQ:(uq.ox=uQ,uW.width+uQ>ud?uq.width=ud-uQ:uq.width=uW.width),uT<0?uW.height+uT>ub?uq.height=ub:uq.height=uW.height+uT:(uq.oy=uT,uW.height+uT>ub?uq.height=ub-uT:uq.height=uW.height);break;default:uq.width=ud,uq.height=ub}uq.w=uc,uq.h=uR,uq.uv=[0,0,uq.width/uc,0,uq.width/uc,uq.height/uR,0,uq.height/uR]}if(uj+=uq.ox,ut+=uq.oy,uQ-=uq.ox,uT-=uq.oy,uKW.fillRectImgVb(uA,this._clipRect,uj,ut,uq.width,uq.height,uq.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var u$=uyW.create(this,this._ib,uA,(uA._byteLength-64)/32*3,uzW.create(256,0)),ue=(this._submits[this._submits._length++]=u$).shaderValue;ue.textureHost=uW;var uK=um[0]*uc,uo=um[1]*uR,uS=(um[2]-um[0])*uc,uM=(um[5]-um[3])*uR,uZ=-uQ/uc,uX=-uT/uR;ue.u_TexRange[0]=uK/uc,ue.u_TexRange[1]=uS/uc,ue.u_TexRange[2]=uo/uR,ue.u_TexRange[3]=uM/uR,ue.u_offset[0]=uZ,ue.u_offset[1]=uX,uI.enabled&&!this._isMain&&u$.addTexture(uW,(uA._byteLength>>2)-16),(this._curSubmit=u$)._renderType=10017,u$._numEle+=6}}else this.sprite&&u_.timer.callLater(this,this._repaintSprite)},uj.setShader=function(uW){uJ.save(this,1048576,this._shader2D,!0),this._shader2D.shader=uW},uj.setFilters=function(uW){uJ.save(this,2097152,this._shader2D,!0),this._shader2D.filters=uW,this._curSubmit=uEW.RENDERBASE,this._renderKey=0,this._drawCount++},uj.drawTexture=function(uW,uj,ut,ud,ub,uE,uO){this._drawTextureM(uW,uj,ut,ud,ub,uE,uO,null,1)},uj.addTextureVb=function(uW,uj,ut){var ud=this._curSubmit._vb||this._vb,ub=ud._byteLength>>2;ud.byteLength=ub+16<<2;for(var uE=ud.getFloat32Array(),uO=0;uO<16;uO+=4)uE[ub++]=uW[uO]+uj,uE[ub++]=uW[uO+1]+ut,uE[ub++]=uW[uO+2],uE[ub++]=uW[uO+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),ud._upload=!0},uj.willDrawTexture=function(uW,uj){if(!(uW.loaded&&uW.bitmap&&uW.source))return this.sprite&&u_.timer.callLater(this,this._repaintSprite),0;var ut=uW.bitmap,ud=ut.id+this._shader2D.ALPHA*uj+10016;if(ud==this._renderKey)return ud;var ub=this._shader2D,uE=ub.ALPHA,uO=this._curSubmit.shaderValue;ub.ALPHA*=uj,this._renderKey=ud,this._drawCount++,ub.glTexture=ut;var uq=this._vb,uA=null,uc=uq._byteLength/32*3,uR=uO.textureHost&&uO.textureHost==uW&&uO.textureHost.alphaTexture==uW.alphaTexture;return uA=uyW.create(this,this._ib,uq,uc,uzW.create(1,0)),(this._submits[this._submits._length++]=uA).shaderValue.textureHost=uW,uA._renderType=10016,uA._preIsSameTextureShader=10016===this._curSubmit._renderType&&ub.ALPHA===uO.ALPHA&&uR,this._curSubmit=uA,ub.ALPHA=uE,ud},uj.drawTextures=function(uW,uj,ut,ud){if(uW.loaded&&uW.bitmap&&uW.source){var ub=this._clipRect;if(this._clipRect=uH.MAXCLIPRECT,this._drawTextureM(uW,uj[0],uj[1],uW.width,uW.height,ut,ud,null,1)){if(this._clipRect=ub,ul.drawCall++,!(uj.length<4)){for(var uE=this._curSubmit._vb||this._vb,uO=this._curMat.a,uq=this._curMat.d,uA=2,uc=uj.length;uA<uc;uA+=2)uKW.copyPreImgVb(uE,(uj[uA]-uj[uA-2])*uO,(uj[uA+1]-uj[uA-1])*uq),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&u_.timer.callLater(this,this._repaintSprite)},uj._drawTextureM=function(uW,uj,ut,ud,ub,uE,uO,uq,uA){if(!uW.loaded||!uW.source)return this.sprite&&u_.timer.callLater(this,this._repaintSprite),!1;var uc=this._curSubmit._vb||this._vb,uR=uW.bitmap;uj+=uE,ut+=uO,this._drawCount++;var um=uR.id+this._shader2D.ALPHA*uA+10016;if(um!=this._renderKey){this._renderKey=um;var uQ=this._curSubmit.shaderValue,uT=this._shader2D,u$=uT.ALPHA;uT.ALPHA*=uA,uT.glTexture=uR;var ue=this._vb,uK=null,uo=ue._byteLength/32*3,uS=uQ.textureHost&&uQ.textureHost==uW&&uQ.textureHost.alphaTexture==uW.alphaTexture;uK=uyW.create(this,this._ib,ue,uo,uzW.create(1,0)),(this._submits[this._submits._length++]=uK).shaderValue.textureHost=uW,uK._renderType=10016,uK._preIsSameTextureShader=10016===this._curSubmit._renderType&&uT.ALPHA===uQ.ALPHA&&uS,this._curSubmit=uK,uc=this._curSubmit._vb||this._vb,uT.ALPHA=u$}return!!uKW.fillRectImgVb(uc,this._clipRect,uj,ut,ud||uW.width,ub||uW.height,uW.uv,uq||this._curMat,this._x,this._y,0,0)&&(uI.enabled&&!this._isMain&&this._curSubmit.addTexture(uW,(uc._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},uj._repaintSprite=function(){this.sprite&&this.sprite.repaint()},uj._drawText=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){var uR=uW.bitmap;this._drawCount++;var um=uR.id+this._shader2D.ALPHA+10016;if(um!=this._renderKey){this._renderKey=um;var uQ=this._curSubmit.shaderValue,uT=this._shader2D;uT.glTexture=uR;var u$=this._vb,ue=null,uK=u$._byteLength/32*3,uo=uQ.textureHost&&uQ.textureHost==uW&&uQ.textureHost.alphaTexture==uW.alphaTexture;(ue=uI.enabled?uyW.create(this,this._ib,u$,uK,uzW.create(1,0)):uyW.create(this,this._ib,u$,uK,unW.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&uT.ALPHA===uQ.ALPHA&&uo,(this._submits[this._submits._length++]=ue).shaderValue.textureHost=uW,ue._renderType=10016,this._curSubmit=ue}uW.active();var uS=this._curSubmit._vb||this._vb;uKW.fillRectImgVb(uS,this._clipRect,uj+uO,ut+uq,ud||uW.width,ub||uW.height,uW.uv,uE||this._curMat,this._x,this._y,uA,uc,!0)&&(uI.enabled&&!this._isMain&&this._curSubmit.addTexture(uW,(uS._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},uj.drawTextureWithTransform=function(uW,uj,ut,ud,ub,uE,uO,uq,uA){if(uE){var uc=this._curMat,uR=this._x,um=this._y;(0!==uO||0!==uq)&&(this._x=uO*uc.a+uq*uc.c,this._y=uq*uc.d+uO*uc.b),uE&&uc.bTransform?(uC.mul(uE,uc,uH._tmpMatrix),(uE=uH._tmpMatrix)._checkTransform()):(this._x+=uc.tx,this._y+=uc.ty),this._drawTextureM(uW,uj,ut,ud,ub,0,0,uE,uA),this._x=uR,this._y=um}else this._drawTextureM(uW,uj,ut,ud,ub,uO,uq,null,uA)},uj.fillQuadrangle=function(uW,uj,ut,ud,ub){var uE=this._curSubmit,uO=this._vb,uq=this._shader2D,uA=uE.shaderValue;if(this._renderKey=0,uW.bitmap){var uc=uW.bitmap;uq.glTexture==uc&&uq.ALPHA===uA.ALPHA||(uq.glTexture=uc,(uE=this._curSubmit=uEW.createSubmit(this,this._ib,uO,uO._byteLength/32*3,uzW.create(1,0))).shaderValue.glTexture=uc,this._submits[this._submits._length++]=uE),uKW.fillQuadrangleImgVb(uO,uj,ut,ud,uW.uv,ub||this._curMat,this._x,this._y)}else uE.shaderValue.fillStyle&&uE.shaderValue.fillStyle.equal(uW)&&uq.ALPHA===uA.ALPHA||(uq.glTexture=null,(uE=this._curSubmit=uEW.createSubmit(this,this._ib,uO,uO._byteLength/32*3,uzW.create(2,0))).shaderValue.defines.add(2),uE.shaderValue.fillStyle=uw.create(uW),this._submits[this._submits._length++]=uE),uKW.fillQuadrangleImgVb(uO,uj,ut,ud,ua.DEF_UV,ub||this._curMat,this._x,this._y);uE._numEle+=6},uj.drawTexture2=function(uW,uj,ut,ud,ub,uE,uO,uq){if(0!=uE){var uA=this._curMat;if(this._x=uW*uA.a+uj*uA.c,this._y=uj*uA.d+uW*uA.b,ub&&(ub=uA.bTransform||ub.bTransform?(uC.mul(ub,uA,uH._tmpMatrix),uH._tmpMatrix):(this._x+=ub.tx+uA.tx,this._y+=ub.ty+uA.ty,uC.EMPTY)),1!==uE||uO){var uc=this._shader2D.ALPHA,uR=this._nBlendType;this._shader2D.ALPHA=uE,uO&&(this._nBlendType=uf.TOINT(uO)),this._drawTextureM(uq[0],uq[1]-ut,uq[2]-ud,uq[3],uq[4],0,0,ub,1),this._shader2D.ALPHA=uc,this._nBlendType=uR}else this._drawTextureM(uq[0],uq[1]-ut,uq[2]-ud,uq[3],uq[4],0,0,ub,1);this._x=this._y=0}},uj.drawCanvas=function(uW,uj,ut,ud,ub){var uE=uW.context;if(this._renderKey=0,uE._targets)this._submits[this._submits._length++]=uvW.create(uE,0,null),this._curSubmit=uEW.RENDERBASE,uE._targets.drawTo(this,uj,ut,ud,ub);else{var uO=this._submits[this._submits._length++]=uvW.create(uE,this._shader2D.ALPHA,this._shader2D.filters),uq=ud/uW.width,uA=ub/uW.height,uc=uO._matrix;this._curMat.copyTo(uc),1!=uq&&1!=uA&&uc.scale(uq,uA);var uR=uc.tx,um=uc.ty;uc.tx=uc.ty=0,uc.transformPoint(uL.TEMP.setTo(uj,ut)),uc.translate(uL.TEMP.x+uR,uL.TEMP.y+um),this._curSubmit=uEW.RENDERBASE}uN.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=uE._targets?"yellow":"green",this.strokeRect(uj-1,ut-1,ud+2,ub+2,1),this.strokeRect(uj,ut,ud,ub,1),this.restore())},uj.drawTarget=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){void 0===uc&&(uc=-1);var uR=this._vb;if(uKW.fillRectImgVb(uR,this._clipRect,uj,ut,ud,ub,uA||ua.DEF_UV,uE||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var um=this._curSubmit=umW.create(this,this._ib,uR,(uR._byteLength-64)/32*3,uq,uO);um.blendType=-1==uc?this._nBlendType:uc,um.scope=uW,this._submits[this._submits._length++]=um,this._curSubmit._numEle+=6}},uj.mixRGBandAlpha=function(uW){return this._mixRGBandAlpha(uW,this._shader2D.ALPHA)},uj._mixRGBandAlpha=function(uW,uj){var ut=(4278190080&uW)>>>24;return 0!=ut?ut*=uj:ut=255*uj,16777215&uW|ut<<24},uj.drawTriangles=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){if(!uW.loaded||!uW.source)return this.sprite&&u_.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;uW.bitmap;var uR=this._mixRGBandAlpha(4294967295,uq),um=(ud.length,uE.length);this._renderKey=-1;var uQ=this._curSubmit=uyW.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,uzW.create(1,0));return uQ.shaderValue.textureHost=uW,uQ._renderType=10016,this._submits[this._submits._length++]=uQ,uO?(uH._tmpMatrix.a=uO.a,uH._tmpMatrix.b=uO.b,uH._tmpMatrix.c=uO.c,uH._tmpMatrix.d=uO.d,uH._tmpMatrix.tx=uO.tx+uj,uH._tmpMatrix.ty=uO.ty+ut,uC.mul(uH._tmpMatrix,this._curMat,uH._tmpMatrix)):(uH._tmpMatrix.a=this._curMat.a,uH._tmpMatrix.b=this._curMat.b,uH._tmpMatrix.c=this._curMat.c,uH._tmpMatrix.d=this._curMat.d,uH._tmpMatrix.tx=this._curMat.tx+uj,uH._tmpMatrix.ty=this._curMat.ty+ut),this._triangleMesh.addData(ud,ub,uE,uH._tmpMatrix,uR,this),this._curSubmit._numEle+=um,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},uj.transform=function(uW,uj,ut,ud,ub,uE){uB.save(this),uC.mul(uC.TEMP.setTo(uW,uj,ut,ud,ub,uE),this._curMat,this._curMat),this._curMat._checkTransform()},uj.setTransformByMatrix=function(uW){uW.copyTo(this._curMat)},uj.transformByMatrix=function(uW){uB.save(this),uC.mul(uW,this._curMat,this._curMat),this._curMat._checkTransform()},uj.rotate=function(uW){uB.save(this),this._curMat.rotateEx(uW)},uj.scale=function(uW,uj){uB.save(this),this._curMat.scaleEx(uW,uj)},uj.clipRect=function(uW,uj,ut,ud){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var ub=uRW.create(4);this.addRenderObject(ub);var uE=this._vb,uO=uE._byteLength>>2;if(uKW.fillRectImgVb(uE,null,uW,uj,ut,ud,ua.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var uq=this._curSubmit=uEW.createSubmit(this,this._ib,uE,(uE._byteLength-64)/32*3,uzW.create(2,0));uq.shaderValue.ALPHA=1,this._submits[this._submits._length++]=uq,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var uA=uRW.create(5);this.addRenderObject(uA);var uc=uE.getFloat32Array(),uR=Math.min(Math.min(Math.min(uc[0+uO],uc[4+uO]),uc[8+uO]),uc[12+uO]),um=Math.max(Math.max(Math.max(uc[0+uO],uc[4+uO]),uc[8+uO]),uc[12+uO]),uQ=Math.min(Math.min(Math.min(uc[1+uO],uc[5+uO]),uc[9+uO]),uc[13+uO]),uT=Math.max(Math.max(Math.max(uc[1+uO],uc[5+uO]),uc[9+uO]),uc[13+uO]);uP.save(this,uA,uW,uj,ut,ud,uR,uQ,um-uR,uT-uQ),this._curSubmit=uEW.RENDERBASE}else{ut*=this._curMat.a,ud*=this._curMat.d;var u$=uL.TEMP;this._curMat.transformPoint(u$.setTo(uW,uj)),ut<0&&(u$.x=u$.x+ut,ut=-ut),ud<0&&(u$.y=u$.y+ud,ud=-ud),this._renderKey=0;var ue=this._curSubmit=ucW.create(this);(this._submits[this._submits._length++]=ue).submitIndex=this._submits._length,ue.submitLength=9999999,ur.save(this,ue);var uK=this._clipRect,uo=uK.x,uS=uK.y,uM=u$.x+ut,uZ=u$.y+ud;uo<u$.x&&(uK.x=u$.x),uS<u$.y&&(uK.y=u$.y),uK.width=Math.min(uM,uo+uK.width)-uK.x,uK.height=Math.min(uZ,uS+uK.height)-uK.y,this._shader2D.glTexture=null,ue.clipRect.copyFrom(uK),this._curSubmit=uEW.RENDERBASE}},uj.setIBVB=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR){if(void 0===uA&&(uA=0),void 0===uc&&(uc=0),void 0===uR&&(uR=0),null===ut){if(uo.isFlash){var um=ud;um._selfIB||(um._selfIB=upW.create(35044)),um._selfIB.clear(),ut=um._selfIB}else ut=this._ib;uKW.expandIBQuadrangle(ut,ud._byteLength/(4*ud.vertexStride*4))}if(!uq||!uO)throw Error("setIBVB must input:shader shaderValues");var uQ=uAW.create(this,ud,ut,ub,uO,uq,uA,uc,uR);uE||(uE=uC.EMPTY),uE.translate(uW,uj),uC.mul(uE,this._curMat,uQ._mat),uE.translate(-uW,-uj),this._submits[this._submits._length++]=uQ,this._curSubmit=uEW.RENDERBASE,this._renderKey=0},uj.addRenderObject=function(uW){this._submits[this._submits._length++]=uW},uj.fillTrangles=function(uW,uj,ut,ud,ub){var uE=this._curSubmit,uO=this._vb,uq=this._shader2D,uA=uE.shaderValue,uc=ud.length>>4,uR=uW.bitmap;this._renderKey=0,uq.glTexture==uR&&uq.ALPHA===uA.ALPHA||((uE=this._curSubmit=uEW.createSubmit(this,this._ib,uO,uO._byteLength/32*3,uzW.create(1,0))).shaderValue.textureHost=uW,this._submits[this._submits._length++]=uE),uKW.fillTranglesVB(uO,uj,ut,ud,ub||this._curMat,this._x,this._y),uE._numEle+=6*uc},uj.submitElement=function(uW,uj){var ut=this._submits;for(uj<0&&(uj=ut._length);uW<uj;)uW+=ut[uW].renderSubmit()},uj.finish=function(){uZW.mainContext.finish()},uj.flush=function(){var uW=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(uW>this._ib.bufferLength/12&&uKW.expandIBQuadrangle(this._ib,uW),!this._isMain&&uI.enabled&&uI._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=uI._atlasRestore;for(var uj=this._submits,ut=0,ud=uj._length;ut<ud;ut++){var ub=uj[ut];10016===ub.getRenderType()&&ub.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),ujW.instance&&ujW.getInstance().reset();var uE;for(ut=0,uE=this.meshlist.length;ut<uE;ut++){var uO=this.meshlist[ut];uO.canReuse?uO.releaseMesh():uO.destroy()}return this.meshlist.length=0,this._curSubmit=uEW.RENDERBASE,this._renderKey=0,this._triangleMesh=uaW.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},uj.setPathId=function(uW){if(this.mId=uW,-1!=this.mId){this.mHaveKey=!1;var uj=uD.getInstance();uj.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,uj.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},uj.movePath=function(uW,uj){var ut=uW,ud=uj;uW=this._curMat.a*ut+this._curMat.c*ud+this._curMat.tx,uj=this._curMat.b*ut+this._curMat.d*ud+this._curMat.ty,this.mX+=uW,this.mY+=uj},uj.beginPath=function(){var uW=this._getPath();uW.tempArray.length=0,uW.closePath=!1,this.mX=0,this.mY=0},uj.closePath=function(){this._path.closePath=!0},uj.fill=function(uW){void 0===uW&&(uW=!1);var uj=this._getPath();this.drawPoly(0,0,uj.tempArray,this.fillStyle._color.numColor,0,0,uW)},uj.stroke=function(){var uW=this._getPath();if(0<this.lineWidth){if(-1==this.mId)uW.drawLine(0,0,uW.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var uj=uD.getInstance().shapeLineDic[this.mId];uj.rebuild(uW.tempArray),uW.setGeomtry(uj)}else uD.getInstance().addLine(this.mId,uW.drawLine(0,0,uW.tempArray,this.lineWidth,this.strokeStyle._color.numColor));uW.update();var ut=[this.mX,this.mY],ud=uEW.createShape(this,uW.ib,uW.vb,uW.count,uW.offset,uzW.create(4,0));ud.shaderValue.ALPHA=this._shader2D.ALPHA,ud.shaderValue.u_pos=ut,ud.shaderValue.u_mmat2=uSW.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=ud,this._renderKey=-1}},uj.line=function(uW,uj,ut,ud,ub,uE){var uO=this._curSubmit,uq=this._vb;if(uKW.fillLineVb(uq,this._clipRect,uW,uj,ut,ud,ub,uE)){this._renderKey=0;var uA=this._shader2D,uc=uO.shaderValue;uA.strokeStyle===uc.strokeStyle&&uA.ALPHA===uc.ALPHA||(uA.glTexture=null,(uO=this._curSubmit=uEW.createSubmit(this,this._ib,uq,(uq._byteLength-64)/32*3,uzW.create(2,0))).shaderValue.strokeStyle=uA.strokeStyle,uO.shaderValue.mainID=2,uO.shaderValue.ALPHA=uA.ALPHA,this._submits[this._submits._length++]=uO),uO._numEle+=6}},uj.moveTo=function(uW,uj,ut){void 0===ut&&(ut=!0);var ud=this._getPath();if(ut){var ub=uW,uE=uj;uW=this._curMat.a*ub+this._curMat.c*uE,uj=this._curMat.b*ub+this._curMat.d*uE}ud.addPoint(uW,uj)},uj.lineTo=function(uW,uj,ut){void 0===ut&&(ut=!0);var ud=this._getPath();if(ut){var ub=uW,uE=uj;uW=this._curMat.a*ub+this._curMat.c*uE,uj=this._curMat.b*ub+this._curMat.d*uE}ud.addPoint(uW,uj)},uj.drawCurves=function(uW,uj,ut){this.setPathId(-1),this.beginPath(),this.strokeStyle=ut[3],this.lineWidth=ut[4];var ud=ut[2];uW+=ut[0],uj+=ut[1],this.movePath(uW,uj),this.moveTo(ud[0],ud[1]);for(var ub=2,uE=ud.length;ub<uE;)this.quadraticCurveTo(ud[ub++],ud[ub++],ud[ub++],ud[ub++]);this.stroke()},uj.arcTo=function(uW,uj,ut,ud,ub){if(-1==this.mId||!this.mHaveKey){var uE=0,uO=0,uq=0,uA=this._getPath();this._curMat.copyTo(uH._tmpMatrix),uH._tmpMatrix.tx=uH._tmpMatrix.ty=0,uH._tempPoint.setTo(uA.getEndPointX(),uA.getEndPointY()),uH._tmpMatrix.invertTransformPoint(uH._tempPoint);var uc=uH._tempPoint.x-uW,uR=uH._tempPoint.y-uj,um=Math.sqrt(uc*uc+uR*uR);if(!(um<=1e-6)){var uQ=uc/um,uT=uR/um,u$=ut-uW,ue=ud-uj,uK=u$*u$+ue*ue,uo=Math.sqrt(uK);if(!(uo<=1e-6)){var uS=u$/uo,uM=ue/uo,uZ=uQ+uS,uX=uT+uM,u_=Math.sqrt(uZ*uZ+uX*uX);if(!(u_<=1e-6)){var uN=uZ/u_,uz=uX/u_,uC=Math.acos(uN*uQ+uz*uT),uL=Math.PI/2-uC,uV=(um=ub/Math.tan(uL))*uQ+uW,ux=um*uT+uj,uG=Math.sqrt(um*um+ub*ub),ul=uW+uN*uG,uh=uj+uz*uG,uv=0,uy=0;if(0<=uQ*uM-uT*uS){var ua=2*uL/uH.SEGNUM;uv=Math.sin(ua),uy=Math.cos(ua)}else ua=2*-uL/uH.SEGNUM,uv=Math.sin(ua),uy=Math.cos(ua);uO=this._curMat.a*uV+this._curMat.c*ux,uq=this._curMat.b*uV+this._curMat.d*ux,uO==this._path.getEndPointX()&&uq==this._path.getEndPointY()||uA.addPoint(uO,uq);var uu=uV-ul,uD=ux-uh;for(uE=0;uE<uH.SEGNUM;uE++){var us=uu*uy+uD*uv,uY=-uu*uv+uD*uy;uO=us+ul,uq=uY+uh,uW=this._curMat.a*uO+this._curMat.c*uq,uq=uj=this._curMat.b*uO+this._curMat.d*uq,(uO=uW)==this._path.getEndPointX()&&uq==this._path.getEndPointY()||uA.addPoint(uO,uq),uu=us,uD=uY}}}}}},uj.arc=function(uW,uj,ut,ud,ub,uE,uO){if(void 0===uE&&(uE=!1),void 0===uO&&(uO=!0),-1!=this.mId){var uq=uD.getInstance().shapeDic[this.mId];if(uq&&this.mHaveKey&&!uq.needUpdate(this._curMat))return;uj=uW=0}var uA,uc=0,uR=0,um=0,uQ=0,uT=0,u$=0,ue=0;if(uR=ub-ud,uE)if(Math.abs(uR)>=2*Math.PI)uR=2*-Math.PI;else for(;0<uR;)uR-=2*Math.PI;else if(Math.abs(uR)>=2*Math.PI)uR=2*Math.PI;else for(;uR<0;)uR+=2*Math.PI;uA=uR/(ue=ut<101?Math.max(10,uR*ut/5):ut<201?Math.max(10,uR*ut/20):Math.max(10,uR*ut/40))/2,um=Math.abs(4/3*(1-Math.cos(uA))/Math.sin(uA)),uE&&(um=-um);var uK=this._getPath(),uo=NaN,uS=NaN;for(u$=0;u$<=ue;u$++)uc=ud+uR*(u$/ue),uQ=uW+Math.cos(uc)*ut,uT=uj+Math.sin(uc)*ut,uO&&(uo=uQ,uS=uT,uQ=this._curMat.a*uo+this._curMat.c*uS,uT=this._curMat.b*uo+this._curMat.d*uS),uQ==this._path.getEndPointX()&&uT==this._path.getEndPointY()||uK.addPoint(uQ,uT);uQ=uW+Math.cos(ub)*ut,uT=uj+Math.sin(ub)*ut,uO&&(uo=uQ,uS=uT,uQ=this._curMat.a*uo+this._curMat.c*uS,uT=this._curMat.b*uo+this._curMat.d*uS),uQ==this._path.getEndPointX()&&uT==this._path.getEndPointY()||uK.addPoint(uQ,uT)},uj.quadraticCurveTo=function(uW,uj,ut,ud){var ub=um.I,uE=ut,uO=ud;ut=this._curMat.a*uE+this._curMat.c*uO,ud=this._curMat.b*uE+this._curMat.d*uO,uE=uW,uO=uj,uW=this._curMat.a*uE+this._curMat.c*uO,uj=this._curMat.b*uE+this._curMat.d*uO;for(var uq=ub.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),uW,uj,ut,ud],30,2),uA=0,uc=uq.length/2;uA<uc;uA++)this.lineTo(uq[2*uA],uq[2*uA+1],!1);this.lineTo(ut,ud,!1)},uj.rect=function(uW,uj,ut,ud){this._other=this._other.make(),this._other.path||(this._other.path=new uU),this._other.path.rect(uW,uj,ut,ud)},uj.strokeRect=function(uW,uj,ut,ud,ub){var uE=.5*ub;this.line(uW-uE,uj,uW+ut+uE,uj,ub,this._curMat),this.line(uW+ut,uj,uW+ut,uj+ud,ub,this._curMat),this.line(uW,uj,uW,uj+ud,ub,this._curMat),this.line(uW-uE,uj+ud,uW+ut+uE,uj+ud,ub,this._curMat)},uj.clip=function(){},uj.drawPoly=function(uW,uj,ut,ud,ub,uE,uO){void 0===uO&&(uO=!1),this._renderKey=0,this._shader2D.glTexture=null;var uq=this._getPath();if(-1==this.mId)uq.polygon(uW,uj,ut,ud,ub||1,uE);else if(this.mHaveKey){var uA=uD.getInstance().shapeDic[this.mId];uA.setMatrix(this._curMat),uA.rebuild(uq.tempArray),uq.setGeomtry(uA)}else{var uc=uq.polygon(uW,uj,ut,ud,ub||1,uE);uD.getInstance().addShape(this.mId,uc),uc.setMatrix(this._curMat)}uq.update();var uR,um=[this.mX,this.mY];if((uR=uEW.createShape(this,uq.ib,uq.vb,uq.count,uq.offset,uzW.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,uR.shaderValue.u_pos=um,uR.shaderValue.u_mmat2=uSW.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=uR,0<ub){if(this.mHaveLineKey){var uQ=uD.getInstance().shapeLineDic[this.mId];uQ.rebuild(uq.tempArray),uq.setGeomtry(uQ)}else uD.getInstance().addShape(this.mId,uq.drawLine(uW,uj,ut,ub,uE));uq.update(),(uR=uEW.createShape(this,uq.ib,uq.vb,uq.count,uq.offset,uzW.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,uR.shaderValue.u_mmat2=uSW.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=uR}},uj.drawParticle=function(uW,uj,ut){ut.x=uW,ut.y=uj,this._submits[this._submits._length++]=ut},uj._getPath=function(){return this._path||(this._path=new uU)},ud(0,uj,"globalCompositeOperation",function(){return uf.NAMES[this._nBlendType]},function(uW){var uj=uf.TOINT[uW];null==uj||this._nBlendType===uj||(uJ.save(this,65536,this,!0),this._curSubmit=uEW.RENDERBASE,this._renderKey=0,this._nBlendType=uj)}),ud(0,uj,"strokeStyle",function(){return this._shader2D.strokeStyle},function(uW){this._shader2D.strokeStyle.equal(uW)||(uJ.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=uw.create(uW))}),ud(0,uj,"globalAlpha",function(){return this._shader2D.ALPHA},function(uW){(uW=Math.floor(1e3*uW)/1e3)!=this._shader2D.ALPHA&&(uJ.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=uW)}),ud(0,uj,"asBitmap",null,function(uW){if(uW){if(this._targets||(this._targets=new uk),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),ud(0,uj,"fillStyle",function(){return this._shader2D.fillStyle},function(uW){this._shader2D.fillStyle.equal(uW)||(uJ.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=uw.create(uW))}),ud(0,uj,"textAlign",function(){return this._other.textAlign},function(uW){this._other.textAlign===uW||(this._other=this._other.make(),uJ.save(this,32768,this._other,!1),this._other.textAlign=uW)}),ud(0,uj,"lineWidth",function(){return this._other.lineWidth},function(uW){this._other.lineWidth===uW||(this._other=this._other.make(),uJ.save(this,256,this._other,!1),this._other.lineWidth=uW)}),ud(0,uj,"textBaseline",function(){return this._other.textBaseline},function(uW){this._other.textBaseline===uW||(this._other=this._other.make(),uJ.save(this,16384,this._other,!1),this._other.textBaseline=uW)}),ud(0,uj,"font",null,function(uW){uW!=this._other.font.toString()&&(this._other=this._other.make(),uJ.save(this,8,this._other,!1),this._other.font===u$W.EMPTY?this._other.font=new u$W(uW):this._other.font.setFont(uW))}),uH.__init__=function(){ut.DEFAULT=new ut},uH._tempPoint=new uL,uH._SUBMITVBSIZE=32e3,uH._MAXSIZE=99999999,uH._RECTVBSIZE=16,uH.MAXCLIPRECT=new uV(0,0,99999999,99999999),uH._COUNT=0,uH._tmpMatrix=new uC,uH.SEGNUM=32,uH._contextcount=0,uO(uH,["_fontTemp",function(){return this._fontTemp=new u$W},"_drawStyleTemp",function(){return this._drawStyleTemp=new uw(null)}]),uH.__init$=function(){ut=function(){function uW(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=u$W.EMPTY}uQ(uW,"");var uj=uW.prototype;return uj.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=u$W.EMPTY},uj.make=function(){return this===uW.DEFAULT?new uW:this},uW.DEFAULT=null,uW}()},uH}(),uzW=function(uW){function ud(uW,uj){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,ud.__super.call(this),this.defines=new uxW,this.position=ud._POSITION,this.mainID=uW,this.subID=uj,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=uW|uj,this._inClassCache=ud._cache[this._cacheID],0<uW&&!this._inClassCache&&(this._inClassCache=ud._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}uQ(ud,"laya.webgl.shader.d2.value.Value2D",uY);var uj=ud.prototype;return uj.setValue=function(uW){},uj.refresh=function(){var uW=this.size;return uW[0]=uSW.width,uW[1]=uSW.height,this.alpha=this.ALPHA*uSW.worldAlpha,this.mmat=uSW.worldMatrix4,this},uj._ShaderWithCompile=function(){return uiW.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,ukW.create)},uj._withWorldShaderDefines=function(){var uW=uSW.worldShaderDefines,uj=uiW.sharders[this.mainID|this.defines._value|uW.getValue()];if(!uj){var ut,ud={};for(ut in this.defines.toNameDic())ud[ut]="";for(ut in uW.toNameDic())ud[ut]="";uj=uiW.withCompile2D(0,this.mainID,ud,this.mainID|this.defines._value|uW.getValue(),ukW.create)}var ub=uSW.worldFilters;if(!ub)return uj;for(var uE,uO=ub.length,uq=0;uq<uO;uq++)(uE=ub[uq])&&uE.action.setValue(this);return uj},uj.upload=function(){var uW=uSW;this.alpha=this.ALPHA*uW.worldAlpha,uSW.worldMatrix4!==uSW.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),uZW.shaderHighPrecision&&this.defines.add(1024);var uj,ut=uW.worldShaderDefines?this._withWorldShaderDefines():uiW.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=uW.width,this.size[1]=uW.height,this.mmat=uW.worldMatrix4,uuW.activeShader!==ut?ut._shaderValueWidth!==uW.width||ut._shaderValueHeight!==uW.height?(ut._shaderValueWidth=uW.width,ut._shaderValueHeight=uW.height):uj=ut._params2dQuick2||ut._make2dQuick2():ut._shaderValueWidth!==uW.width||ut._shaderValueHeight!==uW.height?(ut._shaderValueWidth=uW.width,ut._shaderValueHeight=uW.height):uj=ut._params2dQuick1||ut._make2dQuick1(),ut.upload(this,uj)},uj.setFilters=function(uW){if(this.filters=uW)for(var uj,ut=uW.length,ud=0;ud<ut;ud++)(uj=uW[ud])&&(this.defines.add(uj.type),uj.action.setValue(this))},uj.clear=function(){this.defines.setValue(this.subID)},uj.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},ud._initone=function(uW,uj){ud._typeClass[uW]=uj,ud._cache[uW]=[],ud._cache[uW]._length=0},ud.__init__=function(){ud._POSITION=[2,5126,!1,4*ueW.BYTES_PE,0],ud._TEXCOORD=[2,5126,!1,4*ueW.BYTES_PE,2*ueW.BYTES_PE],ud._initone(2,uHW),ud._initone(4,ufW),ud._initone(256,uIW),ud._initone(512,uYW),ud._initone(1,ugW),ud._initone(65,unW),ud._initone(9,ugW)},ud.create=function(uW,uj){var ut=ud._cache[uW|uj];return ut._length?ut[--ut._length]:new ud._typeClass[uW|uj](uj)},ud._POSITION=null,ud._TEXCOORD=null,ud._cache=[],ud._typeClass=[],ud.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ud}(),uCW=function(uW){function uK(uW,uj){uK.__super.call(this,uW,uj)}uQ(uK,"laya.webgl.utils.RenderSprite3D",uS);var uj=uK.prototype;return uj.onCreate=function(uW){switch(uW){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},uj._mask=function(uW,uj,ut,ud){var ub,uE,uO=this._next,uq=uW.mask;if(uq){uj.ctx.save();var uA=uj.ctx.globalCompositeOperation,uc=new uV;if(uc.copyFrom(uq.getBounds()),uc.width=Math.round(uc.width),uc.height=Math.round(uc.height),uc.x=Math.round(uc.x),uc.y=Math.round(uc.y),0<uc.width&&0<uc.height){var uR=uW._style._tf,um=uqW.create();um.addValue("bounds",uc),ub=uOW.create([um,uj],laya.webgl.utils.RenderSprite3D.tmpTarget),uj.addRenderObject(ub),uq.render(uj,-uc.x,-uc.y),ub=uOW.create([um],laya.webgl.utils.RenderSprite3D.endTmpTarget),uj.addRenderObject(ub),uj.ctx.save(),uj.clipRect(ut-uR.translateX+uc.x,ud-uR.translateY+uc.y,uc.width,uc.height),uO._fun.call(uO,uW,uj,ut,ud),uj.ctx.restore(),uE=uRW.create(6),uA=uj.ctx.globalCompositeOperation,uE.blendMode="mask",uj.addRenderObject(uE),uC.TEMP.identity();var uQ=uzW.create(1,0),uT=ua.INV_UV,u$=uc.width,ue=uc.height;(uc.width<32||uc.height<32)&&((uT=uK.tempUV)[0]=0,uT[1]=0,uT[2]=32<=uc.width?1:uc.width/32,uT[3]=0,uT[4]=32<=uc.width?1:uc.width/32,uT[5]=32<=uc.height?1:uc.height/32,uT[6]=0,uT[7]=32<=uc.height?1:uc.height/32,uc.width=32<=uc.width?uc.width:32,uc.height=32<=uc.height?uc.height:32,uT[1]*=-1,uT[3]*=-1,uT[5]*=-1,uT[7]*=-1,uT[1]+=1,uT[3]+=1,uT[5]+=1,uT[7]+=1),uj.ctx.drawTarget(um,ut+uc.x-uR.translateX,ud+uc.y-uR.translateY,u$,ue,uC.TEMP,"tmpTarget",uQ,uT,6),ub=uOW.create([um],laya.webgl.utils.RenderSprite3D.recycleTarget),uj.addRenderObject(ub),(uE=uRW.create(6)).blendMode=uA,uj.addRenderObject(uE)}uj.ctx.restore()}else uO._fun.call(uO,uW,uj,ut,ud)},uj._blend=function(uW,uj,ut,ud){var ub=uW._style,uE=this._next;ub.blendMode?(uj.ctx.save(),uj.ctx.globalCompositeOperation=ub.blendMode,uE._fun.call(uE,uW,uj,ut,ud),uj.ctx.restore()):uE._fun.call(uE,uW,uj,ut,ud)},uj._transform=function(uW,uj,ut,ud){var ub=uW.transform,uE=this._next;if(ub&&uE!=uS.NORENDER){var uO=uj.ctx;uW._style;ub.tx=ut,ub.ty=ud;var uq=uO._getTransformMatrix(),uA=uq.clone();uC.mul(ub,uq,uq),uq._checkTransform(),ub.tx=ub.ty=0,uE._fun.call(uE,uW,uj,0,0),uA.copyTo(uq),uA.destroy()}else uE._fun.call(uE,uW,uj,ut,ud)},uK.tmpTarget=function(uW,uj){var ut=uW.getValue("bounds"),ud=uDW.create(ut.width,ut.height);ud.start(),ud.clear(0,0,0,0),uW.addValue("tmpTarget",ud)},uK.endTmpTarget=function(uW){uW.getValue("tmpTarget").end()},uK.recycleTarget=function(uW){uW.getValue("tmpTarget").recycle(),uW.recycle()},uO(uK,["tempUV",function(){return this.tempUV=new Array(8)}]),uK}(),uLW=function(uW){function uj(){this.data=null,uj.__super.call(this)}uQ(uj,"laya.filters.webgl.ColorFilterActionGL",us);var ut=uj.prototype;return u_.imps(ut,{"laya.filters.IFilterActionGL":!0}),ut.setValue=function(uW){uW.colorMat=this.data._mat,uW.colorAlpha=this.data._alpha},ut.apply3d=function(uW,uj,ut,ud,ub){var uE=uW.getValue("bounds"),uO=uzW.create(1,0);uO.setFilters([this.data]);var uq=uC.TEMP;uq.identity(),ut.ctx.drawTarget(uW,0,0,uE.width,uE.height,uq,"src",uO)},uj}(),uVW=function(uW){function uE(uW,uj,ut,ud,ub){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,uE.__super.call(this,uW,uj,ub),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new uwW,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=ut,this._atlasCanvas.height=ud,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}uQ(uE,"laya.webgl.atlas.Atlaser",uH);var uj=uE.prototype;return uj.computeUVinAtlasTexture=function(uW,uj,ut,ud){var ub=uI.atlasTextureWidth,uE=uI.atlasTextureHeight,uO=ut/ub,uq=ud/uE,uA=(ut+uW.bitmap.width)/ub,uc=(ud+uW.bitmap.height)/uE,uR=uW.bitmap.width/ub,um=uW.bitmap.height/uE;uW.uv=[uO+uj[0]*uR,uq+uj[1]*um,uA-(1-uj[2])*uR,uq+uj[3]*um,uA-(1-uj[4])*uR,uc-(1-uj[5])*um,uO+uj[6]*uR,uc-(1-uj[7])*um]},uj.findBitmapIsExist=function(uW){if(uW instanceof laya.webgl.resource.WebGLImage){var uj=uW,ut=uj.url,ud=this._InAtlasWebGLImagesKey[ut||uj.id];if(ud)return ud.offsetInfoID}return-1},uj.addToAtlasTexture=function(uW,uj,ut){if(uW instanceof laya.webgl.resource.WebGLImage){var ud=uW,ub=ud.url;this._InAtlasWebGLImagesKey[ub||ud.id]={bitmap:uW,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([uj,ut])}this._atlasCanvas.texSubImage2D(uj,ut,uW.atlasSource),uW.clearAtlasSource()},uj.addToAtlas=function(uW,uj,ut){uW._atlasID=this._inAtlasTextureKey.length;var ud=uW.uv.slice(),ub=uW.bitmap;this._inAtlasTextureKey.push(uW),this._inAtlasTextureOriUVValue.push(ud),this._inAtlasTextureBitmapValue.push(ub),this.computeUVinAtlasTexture(uW,ud,uj,ut),uW.bitmap=this._atlasCanvas},uj.clear=function(){for(var uW=0,uj=this._inAtlasTextureKey.length;uW<uj;uW++)this._inAtlasTextureKey[uW].bitmap=this._inAtlasTextureBitmapValue[uW],this._inAtlasTextureKey[uW].uv=this._inAtlasTextureOriUVValue[uW],this._inAtlasTextureKey[uW]._atlasID=-1,this._inAtlasTextureKey[uW].bitmap.lock=!1,this._inAtlasTextureKey[uW].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},uj.dispose=function(){this.clear(),this._atlasCanvas.destroy()},ud(0,uj,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),ud(0,uj,"texture",function(){return this._atlasCanvas}),ud(0,uj,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),uE}(),uxW=function(uW){function ut(){ut.__super.call(this,ut.__name2int,ut.__int2name,ut.__int2nameMap)}return uQ(ut,"laya.webgl.shader.d2.ShaderDefines2D",uF),ut.__init__=function(){ut.reg("TEXTURE2D",1),ut.reg("COLOR2D",2),ut.reg("PRIMITIVE",4),ut.reg("GLOW_FILTER",8),ut.reg("BLUR_FILTER",16),ut.reg("COLOR_FILTER",32),ut.reg("COLOR_ADD",64),ut.reg("WORLDMAT",128),ut.reg("FILLTEXTURE",256),ut.reg("FSHIGHPRECISION",1024),ut.reg("TXTALPHA",2048),ut.reg("TXTCOMPRESS",4096)},ut.reg=function(uW,uj){uF._reg(uW,uj,ut.__name2int,ut.__int2name)},ut.toText=function(uW,uj,ut){return uF._toText(uW,uj,ut)},ut.toInt=function(uW){return uF._toInt(uW,ut.__name2int)},ut.TEXTURE2D=1,ut.COLOR2D=2,ut.PRIMITIVE=4,ut.FILTERGLOW=8,ut.FILTERBLUR=16,ut.FILTERCOLOR=32,ut.COLORADD=64,ut.WORLDMAT=128,ut.FILLTEXTURE=256,ut.SKINMESH=512,ut.SHADERDEFINE_FSHIGHPRECISION=1024,ut.TXTALPHA=2048,ut.TXTCOMPRESS=4096,ut.__name2int={},ut.__int2name=[],ut.__int2nameMap=[],ut}(),uGW=(function(uW){function uq(uW,uj,ut,ud,ub,uE,uO){uq.__super.call(this,uW,uj,ut,ud,40,ub,uE,uO)}uQ(uq,"laya.webgl.shapes.Ellipse",utW)}(),function(uW){function uE(uW,uj,ut,ud,ub){this._points=[],this.rebuild(ut),uE.__super.call(this,uW,uj,0,0,0,ub,ud,ub,0)}uQ(uE,"laya.webgl.shapes.Line",utW);var uj=uE.prototype;return uj.rebuild=function(uW){var uj=uW.length;uj!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(uj/2-1)),this.mFloat32Array=new Float32Array(5*uj)),this._points.length=0;for(var ut=NaN,ud=NaN,ub=-1,uE=-1,uO=uW.length/2,uq=0;uq<uO;uq++)ut=uW[2*uq],ud=uW[2*uq+1],(.01<Math.abs(ub-ut)||.01<Math.abs(uE-ud))&&this._points.push(ut,ud),ub=ut,uE=ud},uj.getData=function(uW,uj,ut){var ud=[],ub=[];0<this.borderWidth&&this.createLine2(this._points,ud,this.borderWidth,ut,ub,this._points.length/2),this.mUint16Array.set(ud,0),this.mFloat32Array.set(ub,0),uW.append(this.mUint16Array),uj.append(this.mFloat32Array)},uE}()),ulW=function(uW){function um(uW,uj,ut,ud,ub){this._points=[];for(var uE=NaN,uO=NaN,uq=-1,uA=-1,uc=ut.length/2-1,uR=0;uR<uc;uR++)uE=ut[2*uR],uO=ut[2*uR+1],(.01<Math.abs(uq-uE)||.01<Math.abs(uA-uO))&&this._points.push(uE,uO),uq=uE,uA=uO;uE=ut[2*uc],uO=ut[2*uc+1],uq=this._points[0],uA=this._points[1],(.01<Math.abs(uq-uE)||.01<Math.abs(uA-uO))&&this._points.push(uE,uO),um.__super.call(this,uW,uj,0,0,this._points.length/2,0,ud,ub)}uQ(um,"laya.webgl.shapes.LoopLine",utW);var uj=um.prototype;return uj.getData=function(uW,uj,ut){if(0<this.borderWidth){for(var ud=this.color,ub=(ud>>16&255)/255,uE=(ud>>8&255)/255,uO=(255&ud)/255,uq=[],uA=0,uc=0,uR=[],um=Math.floor(this._points.length/2),uQ=0;uQ<um;uQ++)uA=this._points[2*uQ],uc=this._points[2*uQ+1],uq.push(this.x+uA,this.y+uc,ub,uE,uO);this.createLoopLine(uq,uR,this.borderWidth,ut+uq.length/5),uW.append(new Uint16Array(uR)),uj.append(new Float32Array(uq))}},uj.createLoopLine=function(uW,uj,ut,ud,ub,uE){uW.length;var uO=uW.concat(),uq=ub||uW,uA=this.borderColor,uc=(uA>>16&255)/255,uR=(uA>>8&255)/255,um=(255&uA)/255,uQ=[uO[0],uO[1]],uT=[uO[uO.length-5],uO[uO.length-4]],u$=uT[0]+.5*(uQ[0]-uT[0]),ue=uT[1]+.5*(uQ[1]-uT[1]);uO.unshift(u$,ue,0,0,0),uO.push(u$,ue,0,0,0);var uK,uo,uS,uM,uZ,uX,u_,uN,uz,uC,uL,uV,ux,uG,ul,uh,uv,uy,ua,uu,uD=uO.length/5,us=ud,uY=ut/2;uS=uO[0],uM=uO[1],uC=uS-(uZ=uO[5]),uz=(uz=-(uM-(uX=uO[6])))/(uu=Math.sqrt(uz*uz+uC*uC))*uY,uC=uC/uu*uY,uq.push(uS-uz,uM-uC,uc,uR,um,uS+uz,uM+uC,uc,uR,um);for(var uH=1;uH<uD-1;uH++)uS=uO[5*(uH-1)],uM=uO[5*(uH-1)+1],uZ=uO[5*uH],uX=uO[5*uH+1],u_=uO[5*(uH+1)],uN=uO[5*(uH+1)+1],uC=uS-uZ,uV=uZ-u_,ul=(-(uz=(uz=-(uM-uX))/(uu=Math.sqrt(uz*uz+uC*uC))*uY)+uS)*(-(uC=uC/uu*uY)+uX)-(-uz+uZ)*(-uC+uM),uy=(-(uL=(uL=-(uX-uN))/(uu=Math.sqrt(uL*uL+uV*uV))*uY)+u_)*(-(uV=uV/uu*uY)+uX)-(-uL+uZ)*(-uV+uN),ua=(ux=-uC+uM-(-uC+uX))*(uv=-uL+uZ-(-uL+u_))-(uh=-uV+uN-(-uV+uX))*(uG=-uz+uZ-(-uz+uS)),Math.abs(ua)<.1?(ua+=10.1,uq.push(uZ-uz,uX-uC,uc,uR,um,uZ+uz,uX+uC,uc,uR,um)):(((uK=(uG*uy-uv*ul)/ua)-uZ)*(uK-uZ)+((uo=(uh*ul-ux*uy)/ua)-uX)+(uo-uX),uq.push(uK,uo,uc,uR,um,uZ-(uK-uZ),uX-(uo-uX),uc,uR,um));uE&&(uj=uE);var uI=this.edges+1;for(uH=1;uH<uI;uH++)uj.push(us+2*(uH-1),us+2*(uH-1)+1,us+2*uH+1,us+2*uH+1,us+2*uH,us+2*(uH-1));return uj.push(us+2*(uH-1),us+2*(uH-1)+1,us+1,us+1,us,us+2*(uH-1)),uq},um}(),uhW=function(uW){function uO(uW,uj,ut,ud,ub,uE){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=uC.create(),this._points=ut.slice(0,ut.length),uO.__super.call(this,uW,uj,0,0,this._points.length/2,ud,ub,uE)}uQ(uO,"laya.webgl.shapes.Polygon",utW);var uj=uO.prototype;return uj.rebuild=function(uW){this._repaint||(this._points.length=0,this._points=this._points.concat(uW))},uj.setMatrix=function(uW){uW.copyTo(this._mat)},uj.needUpdate=function(uW){return this._repaint=this._mat.a==uW.a&&this._mat.b==uW.b&&this._mat.c==uW.c&&this._mat.d==uW.d&&this._mat.tx==uW.tx&&this._mat.ty==uW.ty,!this._repaint},uj.getData=function(uW,uj,ut){var ud,ub=0,uE=this._points,uO=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=ut){for(this._start=ut,ud=[],uO=this.earcutTriangles.length,ub=0;ub<uO;ub++)ud.push(this.earcutTriangles[ub]+ut);this.mUint16Array=new Uint16Array(ud)}}else{this._start=ut,ud=[];var uq=[],uA=[],uc=this.color,uR=(uc>>16&255)/255,um=(uc>>8&255)/255,uQ=(255&uc)/255;for(uO=Math.floor(uE.length/2),ub=0;ub<uO;ub++)uq.push(this.x+uE[2*ub],this.y+uE[2*ub+1],uR,um,uQ),uA.push(this.x+uE[2*ub],this.y+uE[2*ub+1]);for(this.earcutTriangles=udW.earcut(uA,null,2),uO=this.earcutTriangles.length,ub=0;ub<uO;ub++)ud.push(this.earcutTriangles[ub]+ut);this.mUint16Array=new Uint16Array(ud),this.mFloat32Array=new Float32Array(uq)}uW.append(this.mUint16Array),uj.append(this.mFloat32Array)},uO}(),uvW=function(uW){function uE(){this._matrix=new uC,this._matrix4=ueW.defaultMatrix4.concat(),uE.__super.call(this,1e4),this.shaderValue=new uzW(0,0)}uQ(uE,"laya.webgl.submit.SubmitCanvas",uEW);var uj=uE.prototype;return uj.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var uW=uSW.worldAlpha,uj=uSW.worldMatrix4,ut=uSW.worldMatrix,ud=uSW.worldFilters,ub=uSW.worldShaderDefines,uE=this.shaderValue,uO=this._matrix,uq=this._matrix4,uA=uC.TEMP;return uC.mul(uO,ut,uA),uq[0]=uA.a,uq[1]=uA.b,uq[4]=uA.c,uq[5]=uA.d,uq[12]=uA.tx,uq[13]=uA.ty,uSW.worldMatrix=uA.clone(),uSW.worldMatrix4=uq,uSW.worldAlpha=uSW.worldAlpha*uE.alpha,uE.filters&&uE.filters.length&&(uSW.worldFilters=uE.filters,uSW.worldShaderDefines=uE.defines),this._ctx_src.flush(),uSW.worldAlpha=uW,uSW.worldMatrix4=uj,uSW.worldMatrix.destroy(),uSW.worldMatrix=ut,uSW.worldFilters=ud,uSW.worldShaderDefines=ub,1},uj.releaseRender=function(){var uW=uE._cache;this._ctx_src=null,uW[uW._length++]=this},uj.getRenderType=function(){return 10003},uE.create=function(uW,uj,ut){var ud=uE._cache._length?uE._cache[--uE._cache._length]:new uE;ud._ctx_src=uW;var ub=ud.shaderValue;return ub.alpha=uj,ub.defines.setValue(0),ut&&ut.length&&ub.setFilters(ut),ud},uE._cache=((uE._cache=[])._length=0,uE._cache),uE}(),uyW=function(uW){function uc(uW){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===uW&&(uW=1e4),uc.__super.call(this,uW)}uQ(uc,"laya.webgl.submit.SubmitTexture",uEW);var uj=uc.prototype;return uj.releaseRender=function(){var uW=uc._cache;(uW[uW._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},uj.addTexture=function(uW,uj){this._texsID[this._texs.length]=uW._uvID,this._texs.push(uW),this._vbPos.push(uj)},uj.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var uW=this.shaderValue.textureHost.bitmap;if(null!==uW)for(var uj=this._vb.getFloat32Array(),ut=0,ud=this._texs.length;ut<ud;ut++){var ub=this._texs[ut];ub.active();var uE=ub.uv;if(this._texsID[ut]!==ub._uvID){this._texsID[ut]=ub._uvID;var uO=this._vbPos[ut];uj[uO+2]=uE[0],uj[uO+3]=uE[1],uj[uO+6]=uE[2],uj[uO+7]=uE[3],uj[uO+10]=uE[4],uj[uO+11]=uE[5],uj[uO+14]=uE[6],uj[uO+15]=uE[7],this._vb.setNeedUpload()}ub.bitmap!==uW&&(this._isSameTexture=!1)}}},uj.renderSubmit=function(){if(0===this._numEle)return uc._shaderSet=!1,1;var uW=this.shaderValue.textureHost;if(uW){var uj=uW.source;if(!uW.bitmap||!uj)return uc._shaderSet=!1,1;this.shaderValue.texture=uj,uW.alphaTexture&&uW.alphaTexture.source&&(this.shaderValue.texture1=uW.alphaTexture.source)}this._vb.bind_upload(this._ib);var ut=uZW.mainContext;if(uf.activeBlendFunction!==this._blendFn&&(ut.enable(3042),this._blendFn(ut),uf.activeBlendFunction=this._blendFn),ul.drawCall++,ul.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&uuW.activeShader&&uc._shaderSet?(uuW.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&uuW.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),uc._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var ud=uW.bitmap,ub=0,uE=uuW.activeShader,uO=0,uq=this._texs.length;uO<uq;uO++){var uA=this._texs[uO];uA.bitmap===ud&&uO+1!==uq||(uE.uploadTexture2D(uA.source),ut.drawElements(4,6*(uO-ub+1),5123,this._startIdx+6*ub*ueW.BYTES_PIDX),ud=uA.bitmap,ub=uO)}else ut.drawElements(4,this._numEle,5123,this._startIdx);return 1},uc.create=function(uW,uj,ut,ud,ub){var uE=uc._cache._length?uc._cache[--uc._cache._length]:new uc;null==ut&&((ut=uE._selfVb||(uE._selfVb=uFW.create(-1))).clear(),ud=0),uE._ib=uj,uE._vb=ut,uE._startIdx=ud*ueW.BYTES_PIDX,uE._numEle=0;var uO=uW._nBlendType;uE._blendFn=uW._targets?uf.targetFns[uO]:uf.fns[uO],uE.shaderValue=ub,uE.shaderValue.setValue(uW._shader2D);var uq=uW._shader2D.filters;return uq&&uE.shaderValue.setFilters(uq),uE},uc._cache=((uc._cache=[])._length=0,uc._cache),uc._shaderSet=!0,uc}(),uaW=function(uW){function uo(){uo.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}uQ(uo,"laya.webgl.utils.MeshTexture",uoW);var uj=uo.prototype;return uj.addData=function(uW,uj,ut,ud,ub,uE){for(var uO=uW.length/2,uq=this._vb.needSize(uO*uo.const_stride)>>2,uA=this._vb.getFloat32Array(),uc=0,uR=0;uR<uO;uR++){var um=uW[uc],uQ=uW[uc+1],uT=um*ud.a+uQ*ud.c+ud.tx,u$=um*ud.b+uQ*ud.d+ud.ty;uA[uq++]=uT,uA[uq++]=u$,uA[uq++]=uj[uc],uA[uq++]=uj[uc+1],uc+=2}this._vb.setNeedUpload();var ue=this.vertNum;if(0<ue){(uO=ut.length)>uo.tmpIdx.length&&(uo.tmpIdx=new Uint16Array(uO));for(var uK=0;uK<uO;uK++)uo.tmpIdx[uK]=ut[uK]+ue;this._ib.appendU16Array(uo.tmpIdx,ut.length)}else this._ib.append(ut);this._ib.setNeedUpload(),this.vertNum+=uO,this.indexNum+=ut.length},uj.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},uj.destroy=function(){this._ib.destroy(),this._vb.destroy()},uo.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new uo},uo.const_stride=16,uo._POOL=[],uO(uo,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),uo}(),uuW=function(uW){function uj(){uj.__super.call(this),this.lock=!0}return uQ(uj,"laya.webgl.shader.BaseShader",uM),uj.activeShader=null,uj.bindShader=null,uj}(),uDW=function(uj){function uR(uW,uj,ut,ud,ub,uE,uO,uq,uA){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===ut&&(ut=6408),void 0===ud&&(ud=5121),void 0===ub&&(ub=34041),void 0===uE&&(uE=!1),void 0===uO&&(uO=!1),void 0===uq&&(uq=-1),void 0===uA&&(uA=-1),this._type=1,this._w=uW,this._h=uj,this._surfaceFormat=ut,this._surfaceType=ud,this._depthStencilFormat=ub,uo.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=uE,this._repeat=uO,this._minFifter=uq,this._magFifter=uA,this._createWebGLRenderTarget(),this.bitmap.lock=!0,uR.__super.call(this,this.bitmap,ua.INV_UV)}uQ(uR,"laya.webgl.resource.RenderTarget2D",uj);var uW=uR.prototype;return u_.imps(uW,{"laya.resource.IDispose":!0}),uW.getType=function(){return this._type},uW.getTexture=function(){return this},uW.size=function(uW,uj){this._w==uW&&this._h==uj||(this._w=uW,this._h=uj,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},uW.release=function(){this.destroy()},uW.recycle=function(){uR.POOL.push(this)},uW.start=function(){var uW=uZW.mainContext;return this._preRenderTarget=uSW.curRenderTarget,uSW.curRenderTarget=this,uW.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(uW.viewport(0,0,this._w,this._h),this._svWidth=uSW.width,this._svHeight=uSW.height,uSW.width=this._w,uSW.height=this._h,uuW.activeShader=null),this},uW.clear=function(uW,uj,ut,ud){void 0===uW&&(uW=0),void 0===uj&&(uj=0),void 0===ut&&(ut=0),void 0===ud&&(ud=1);var ub=uZW.mainContext;ub.clearColor(uW,uj,ut,ud);var uE=16384;switch(this._depthStencilFormat){case 33189:uE|=256;break;case 36168:uE|=1024;break;case 34041:uE|=256,uE|=1024}ub.clear(uE)},uW.end=function(){var uW=uZW.mainContext;uW.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,uSW.curRenderTarget=this._preRenderTarget,1==this._type?(uW.viewport(0,0,this._svWidth,this._svHeight),uSW.width=this._svWidth,uSW.height=this._svHeight,uuW.activeShader=null):uW.viewport(0,0,u_.stage.width,u_.stage.height)},uW.getData=function(uW,uj,ut,ud){var ub=uZW.mainContext;if(ub.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===ub.checkFramebufferStatus(36160)))return ub.bindFramebuffer(36160,null),null;var uE=new Uint8Array(this._w*this._h*4);return ub.readPixels(uW,uj,ut,ud,this._surfaceFormat,this._surfaceType,uE),ub.bindFramebuffer(36160,null),uE},uW.destroy=function(uW){void 0===uW&&(uW=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,uj.prototype.destroy.call(this))},uW.dispose=function(){},uW._createWebGLRenderTarget=function(){this.bitmap=new urW(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(uW){this.event("recovered")})},ud(0,uW,"surfaceFormat",function(){return this._surfaceFormat}),ud(0,uW,"magFifter",function(){return this._magFifter}),ud(0,uW,"surfaceType",function(){return this._surfaceType}),ud(0,uW,"mipMap",function(){return this._mipMap}),ud(0,uW,"depthStencilFormat",function(){return this._depthStencilFormat}),ud(0,uW,"minFifter",function(){return this._minFifter}),ud(0,uW,"source",function(){return this._alreadyResolved?u_.superGet(ua,this,"source"):null}),uR.create=function(uW,uj,ut,ud,ub,uE,uO,uq,uA){void 0===ut&&(ut=6408),void 0===ud&&(ud=5121),void 0===ub&&(ub=34041),void 0===uE&&(uE=!1),void 0===uO&&(uO=!1),void 0===uq&&(uq=-1),void 0===uA&&(uA=-1);var uc=uR.POOL.pop();return uc||(uc=new uR(uW,uj)),uc.bitmap&&uc._w==uW&&uc._h==uj&&uc._surfaceFormat==ut&&uc._surfaceType==ud&&uc._depthStencilFormat==ub&&uc._mipMap==uE&&uc._repeat==uO&&uc._minFifter==uq&&uc._magFifter==uA||(uc._w=uW,uc._h=uj,uc._surfaceFormat=ut,uc._surfaceType=ud,uc._depthStencilFormat=ub,uo.isConchWebGL&&34041===uc._depthStencilFormat&&(uc._depthStencilFormat=33189),uc._mipMap=uE,uc._repeat=uO,uc._minFifter=uq,uc._magFifter=uA,uc.release(),uc._createWebGLRenderTarget()),uc},uR.TYPE2D=1,uR.TYPE3D=2,uR.POOL=[],uR}(ua),usW=function(uW){function uj(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,uj.__super.call(this),uj._gl=uZW.mainContext}uQ(uj,"laya.webgl.utils.Buffer",uM);var ut=uj.prototype;return ut._bind=function(){this.activeResource(),uj._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(uj._bindVertexBuffer=this._glBuffer),uj._gl.bindBuffer(this._bufferType,uj._bindActive[this._bufferType]=this._glBuffer),uuW.activeShader=null)},ut.recreateResource=function(){this._glBuffer||(this._glBuffer=uj._gl.createBuffer()),this.completeCreate()},ut.disposeResource=function(){this._glBuffer&&(uZW.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},ud(0,ut,"bufferUsage",function(){return this._bufferUsage}),uj._gl=null,uj._bindActive={},uj._bindVertexBuffer=null,uj._enableAtributes=[],uj}(),uYW=function(uW){function ut(uW){this.texcoord=null,this.offsetX=300,this.offsetY=0,ut.__super.call(this,512,0);var uj=8*ueW.BYTES_PE;this.position=[2,5126,!1,uj,0],this.texcoord=[2,5126,!1,uj,2*ueW.BYTES_PE],this.color=[4,5126,!1,uj,4*ueW.BYTES_PE]}return uQ(ut,"laya.webgl.shader.d2.skinAnishader.SkinSV",uzW),ut}(),uHW=function(uW){function uj(uW){uj.__super.call(this,2,0),this.color=[]}return uQ(uj,"laya.webgl.shader.d2.value.Color2dSV",uzW),uj.prototype.setValue=function(uW){uW.fillStyle&&(this.color=uW.fillStyle._color._color),uW.strokeStyle&&(this.color=uW.strokeStyle._color._color)},uj}(),uIW=function(uW){function uj(uW){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=uzW._TEXCOORD,uj.__super.call(this,256,0)}uQ(uj,"laya.webgl.shader.d2.value.FillTextureSV",uzW);var ut=uj.prototype;return ut.setValue=function(uW){this.ALPHA=uW.ALPHA,uW.filters&&this.setFilters(uW.filters)},ut.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},uj}(),ugW=function(uW){function uj(uW){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=uzW._TEXCOORD,void 0===uW&&(uW=0),uj.__super.call(this,1,uW)}uQ(uj,"laya.webgl.shader.d2.value.TextureSV",uzW);var ut=uj.prototype;return ut.setValue=function(uW){this.ALPHA=uW.ALPHA,uW.filters&&this.setFilters(uW.filters)},ut.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},uj}(),ufW=function(uW){function uj(uW){this.a_color=null,this.u_pos=[0,0],uj.__super.call(this,4,0),this.position=[2,5126,!1,5*ueW.BYTES_PE,0],this.a_color=[3,5126,!1,5*ueW.BYTES_PE,2*ueW.BYTES_PE]}return uQ(uj,"laya.webgl.shader.d2.value.PrimitiveSV",uzW),uj}(),uwW=function(uW){function uj(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,uj.__super.call(this)}uQ(uj,"laya.webgl.atlas.AtlasWebGLCanvas",uW);var ut=uj.prototype;return ut.recreateResource=function(){var uW=uZW.mainContext,uj=this._source=uW.createTexture(),ut=uXW.curBindTexTarget,ud=uXW.curBindTexValue;uXW.bindTexture(uW,3553,uj),uW.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),uW.texParameteri(3553,10241,9729),uW.texParameteri(3553,10240,9729),uW.texParameteri(3553,10242,33071),uW.texParameteri(3553,10243,33071),ut&&ud&&uXW.bindTexture(uW,ut,ud),this.memorySize=this._w*this._h*4,this.completeCreate()},ut.disposeResource=function(){this._source&&(uZW.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},ut.texSubImage2D=function(uW,uj,ut){if(uo.isFlash){this._flashCacheImage||(this._flashCacheImage=ue.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var ud=ut.bitmapdata;this._flashCacheImage._image.copyPixels(ud,0,0,ud.width,ud.height,uW,uj),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var ub=uZW.mainContext,uE=uXW.curBindTexTarget,uO=uXW.curBindTexValue;uXW.bindTexture(ub,3553,this._source),ub.pixelStorei(37441,!0),0<=uW-1&&ub.texSubImage2D(3553,0,uW-1,uj,6408,5121,ut),uW+1<=this._w&&ub.texSubImage2D(3553,0,uW+1,uj,6408,5121,ut),0<=uj-1&&ub.texSubImage2D(3553,0,uW,uj-1,6408,5121,ut),uj+1<=this._h&&ub.texSubImage2D(3553,0,uW,uj+1,6408,5121,ut),ub.texSubImage2D(3553,0,uW,uj,6408,5121,ut),ub.pixelStorei(37441,!1),uE&&uO&&uXW.bindTexture(ub,uE,uO)}},ut.texSubImage2DPixel=function(uW,uj,ut,ud,ub){var uE=uZW.mainContext,uO=uXW.curBindTexTarget,uq=uXW.curBindTexValue;uXW.bindTexture(uE,3553,this._source);var uA=new Uint8Array(ub.data);uE.pixelStorei(37441,!0),uE.texSubImage2D(3553,0,uW,uj,ut,ud,6408,5121,uA),uE.pixelStorei(37441,!1),uO&&uq&&uXW.bindTexture(uE,uO,uq)},ud(0,ut,"width",uW.prototype._$get_width,function(uW){this._w=uW}),ud(0,ut,"height",uW.prototype._$get_height,function(uW){this._h=uW}),uj}(ut),uUW=function(uW){function ub(){this.flipY=!0,this.alwaysChange=!1,ub.__super.call(this)}uQ(ub,"laya.webgl.resource.WebGLCanvas",ut);var uj=ub.prototype;return uj.getCanvas=function(){return this._canvas},uj.clear=function(){this._ctx&&this._ctx.clear()},uj.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},uj._setContext=function(uW){this._ctx=uW},uj.getContext=function(uW,uj){return this._ctx?this._ctx:this._ctx=ub._createContext(this)},uj.size=function(uW,uj){this._w==uW&&this._h==uj||(this._w=uW,this._h=uj,this._ctx&&this._ctx.size(uW,uj),this._canvas&&(this._canvas.height=uj,this._canvas.width=uW))},uj.activeResource=function(uW){void 0===uW&&(uW=!1),this._source||this.recreateResource()},uj.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},uj.disposeResource=function(){this._source&&!this.iscpuSource&&(uZW.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},uj.createWebGlTexture=function(){var uW=uZW.mainContext;this._canvas;var uj=this._source=uW.createTexture();this.iscpuSource=!1;var ut=uXW.curBindTexTarget,ud=uXW.curBindTexValue;uXW.bindTexture(uW,3553,uj),uW.pixelStorei(37440,this.flipY?1:0),ub.premulAlpha&&uW.pixelStorei(37441,!0),uW.texImage2D(3553,0,6408,6408,5121,this._imgData),ub.premulAlpha&&uW.pixelStorei(37441,!1),uW.texParameteri(3553,10240,9729),uW.texParameteri(3553,10241,9729),uW.texParameteri(3553,10242,33071),uW.texParameteri(3553,10243,33071),uW.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,ut&&ud&&uXW.bindTexture(uW,ut,ud)},uj.reloadCanvasData=function(){var uW=uZW.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var uj=uXW.curBindTexTarget,ut=uXW.curBindTexValue;uXW.bindTexture(uW,3553,this._source),ub.premulAlpha&&uW.pixelStorei(37441,!0),uW.texImage2D(3553,0,6408,6408,5121,this._imgData),ub.premulAlpha&&uW.pixelStorei(37441,!1),uW.pixelStorei(37440,0),uj&&ut&&uXW.bindTexture(uW,uj,ut)},uj.texSubImage2D=function(uW,uj,ut){var ud=uZW.mainContext,ub=uXW.curBindTexTarget,uE=uXW.curBindTexValue;uXW.bindTexture(ud,3553,this._source),ud.pixelStorei(37441,!0),ud.texSubImage2D(3553,0,uj,ut,6408,5121,uW._source),ud.pixelStorei(37441,!1),ub&&uE&&uXW.bindTexture(ud,ub,uE)},uj.toBase64=function(uW,uj,ut){var ud=null;this._canvas&&(ud=this._canvas.toDataURL(uW,uj)),ut.call(this,ud)},ud(0,uj,"context",function(){return this._ctx}),ud(0,uj,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),ud(0,uj,"asBitmap",null,function(uW){this._ctx&&(this._ctx.asBitmap=uW)}),ub._createContext=null,ub.premulAlpha=!1,ub}(),uJW=function(uW){function uE(uW,uj){this.CborderSize=12,uE.__super.call(this),this.char=uW,this.isSpace=" "===uW,this.xs=uj.scaleX,this.ys=uj.scaleY,this.font=uj.font.toString(),this.fontSize=uj.font.size,this.fillColor=uj.fillColor,this.borderColor=uj.borderColor,this.lineWidth=uj.lineWidth,this.underLine=uj.underLine;var ut,ud=uo.isConchApp;ud?((ut=ConchTextCanvas)._source=ConchTextCanvas,ut._source.canvas=ConchTextCanvas):ut=uT.canvas.source,this.canvas=ut,this._enableMerageInAtlas=!0,this._ctx=ud?ut:this.canvas.getContext("2d",void 0);var ub=uu.measureText(this.char,this.font);this.cw=ub.width*this.xs,this.ch=(ub.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new ua(this)}uQ(uE,"laya.webgl.resource.WebGLCharImage",ut);var uj=uE.prototype;return u_.imps(uj,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),uj.active=function(){this.texture.active()},uj.recreateResource=function(){var uW=uo.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),uW){var uj=this.fontSize;1==this.xs&&1==this.ys||(uj=parseInt(uj*(this.xs>this.ys?this.xs:this.ys)+""));var ut="normal 100 "+this.font;ut=ut.replace(uE._fontSizeReg,uj),this.borderColor&&(ut+=" 1 "+this.borderColor),this._ctx.font=ut,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,uy.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var ud=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(ud,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},uj.onresize=function(uW,uj){this._w=uW,this._h=uj,this._allowMerageInAtlas=!0},uj.clearAtlasSource=function(){},ud(0,uj,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),ud(0,uj,"atlasSource",function(){return this.canvas}),ud(0,uj,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(uW){this._enableMerageInAtlas=uW}),uE.createOneChar=function(uW,uj){return new uE(uW,uj)},uE._fontSizeReg=new RegExp("\\d+(?=px)","g"),uE}(),urW=function(uW){function uc(uW,uj,ut,ud,ub,uE,uO,uq,uA){void 0===ut&&(ut=6408),void 0===ud&&(ud=5121),void 0===ub&&(ub=34041),void 0===uE&&(uE=!1),void 0===uO&&(uO=!1),void 0===uq&&(uq=-1),void 0===uA&&(uA=1),uc.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=uW,this._h=uj,this._surfaceFormat=ut,this._surfaceType=ud,this._depthStencilFormat=ub,this._mipMap=uE,this._repeat=uO,this._minFifter=uq,this._magFifter=uA}uQ(uc,"laya.webgl.resource.WebGLRenderTarget",ut);var uj=uc.prototype;return uj.recreateResource=function(){var uW=uZW.mainContext;this._frameBuffer||(this._frameBuffer=uW.createFramebuffer()),this._source||(this._source=uW.createTexture());var uj=uXW.curBindTexTarget,ut=uXW.curBindTexValue;uXW.bindTexture(uW,3553,this._source),uW.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var ud=this._minFifter,ub=this._magFifter,uE=this._repeat?10497:33071,uO=uR.isPOT(this._w,this._h);if(uO?(this._mipMap?-1!==ud||(ud=9987):-1!==ud||(ud=9729),-1!==ub||(ub=9729),uW.texParameteri(3553,10241,ud),uW.texParameteri(3553,10240,ub),uW.texParameteri(3553,10242,uE),uW.texParameteri(3553,10243,uE),this._mipMap&&uW.generateMipmap(3553)):(-1!==ud||(ud=9729),-1!==ub||(ub=9729),uW.texParameteri(3553,10241,ud),uW.texParameteri(3553,10240,ub),uW.texParameteri(3553,10242,33071),uW.texParameteri(3553,10243,33071)),uW.bindFramebuffer(36160,this._frameBuffer),uW.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=uW.createRenderbuffer()),uW.bindRenderbuffer(36161,this._depthStencilBuffer),uW.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:uW.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:uW.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:uW.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}uW.bindFramebuffer(36160,null),uj&&ut&&uXW.bindTexture(uW,uj,ut),uW.bindRenderbuffer(36161,null),uO&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},uj.disposeResource=function(){this._frameBuffer&&(uZW.mainContext.deleteTexture(this._source),uZW.mainContext.deleteFramebuffer(this._frameBuffer),uZW.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},ud(0,uj,"depthStencilBuffer",function(){return this._depthStencilBuffer}),ud(0,uj,"frameBuffer",function(){return this._frameBuffer}),uc}(),uPW=function(uW){function uq(uW,uj,ut,ud,ub,uE,uO){this.offsetX=0,this.offsetY=0,uq.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=uE,this.canvas=uW,this._ctx=uW.getContext("2d",void 0),this._w=ud,this._h=ub,this.offsetX=uj,this.offsetY=ut,this.src=uO,this._enableMerageInAtlas=!0,uI.enabled&&this._w<uI.atlasLimitWidth&&this._h<uI.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}uQ(uq,"laya.webgl.resource.WebGLSubImage",ut);var uj=uq.prototype;return u_.imps(uj,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),uj.size=function(uW,uj){this._w=uW,this._h=uj,this._ctx&&this._ctx.size(uW,uj),this.canvas&&(this.canvas.height=uj,this.canvas.width=uW)},uj.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},uj.createWebGlTexture=function(){var uW=uZW.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var uj=this._source=uW.createTexture(),ut=uXW.curBindTexTarget,ud=uXW.curBindTexValue;uXW.bindTexture(uW,3553,uj),uW.pixelStorei(37441,!0),uW.texImage2D(3553,0,6408,6408,5121,this.canvas),uW.pixelStorei(37441,!1);var ub=this.minFifter,uE=this.magFifter,uO=this.repeat?10497:33071,uq=uR.isPOT(this.width,this.height);uq?(this.mipmap?-1!==ub||(ub=9987):-1!==ub||(ub=9729),-1!==uE||(uE=9729),uW.texParameteri(3553,10240,uE),uW.texParameteri(3553,10241,ub),uW.texParameteri(3553,10242,uO),uW.texParameteri(3553,10243,uO),this.mipmap&&uW.generateMipmap(3553)):(-1!==ub||(ub=9729),-1!==uE||(uE=9729),uW.texParameteri(3553,10241,ub),uW.texParameteri(3553,10240,uE),uW.texParameteri(3553,10242,33071),uW.texParameteri(3553,10243,33071)),ut&&ud&&uXW.bindTexture(uW,ut,ud),this.canvas=null,uq&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},uj.disposeResource=function(){uI.enabled&&this._allowMerageInAtlas||!this._source||(uZW.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},uj.clearAtlasSource=function(){},ud(0,uj,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),ud(0,uj,"atlasSource",function(){return this.canvas}),ud(0,uj,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(uW){this._allowMerageInAtlas=uW}),uq}(),uiW=function(uW){function uc(uW,uj,ut,ud){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,uc.__super.call(this),!uW||!uj)throw"Shader Error";this._id=++uc._count,this._vs=uW,this._ps=uj,this._nameMap=ud||{},null!=ut&&(uc.sharders[ut]=this)}uQ(uc,"laya.webgl.shader.Shader",uuW);var uj=uc.prototype;return uj.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},uj.disposeResource=function(){uZW.mainContext.deleteShader(this._vshader),uZW.mainContext.deleteShader(this._pshader),uZW.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},uj._compile=function(){if(!uZW.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var uW=[this._vs,this._ps],uj=uZW.mainContext;if(this._program=uj.createProgram(),this._vshader=uc._createShader(uj,uW[0],35633),this._pshader=uc._createShader(uj,uW[1],35632),uj.attachShader(this._program,this._vshader),uj.attachShader(this._program,this._pshader),uj.linkProgram(this._program),!uo.isConchApp&&!uj.getProgramParameter(this._program,35714))throw uj.getProgramInfoLog(this._program);var ut,ud,ub=0,uE=0;for(uE=uo.isConchApp?uj.getProgramParameterEx(this._vs,this._ps,"",35721):uj.getProgramParameter(this._program,35721),ub=0;ub<uE;ub++){var uO=null;ut={vartype:"attribute",glfun:null,ivartype:0,attrib:uO=uo.isConchApp?uj.getActiveAttribEx(this._vs,this._ps,"",ub):uj.getActiveAttrib(this._program,ub),location:uj.getAttribLocation(this._program,uO.name),name:uO.name,type:uO.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(ut)}var uq=0;for(uq=uo.isConchApp?uj.getProgramParameterEx(this._vs,this._ps,"",35718):uj.getProgramParameter(this._program,35718),ub=0;ub<uq;ub++){var uA=null;uA=uo.isConchApp?uj.getActiveUniformEx(this._vs,this._ps,"",ub):uj.getActiveUniform(this._program,ub),0<(ut={vartype:"uniform",glfun:null,ivartype:1,attrib:uO,location:uj.getUniformLocation(this._program,uA.name),name:uA.name,type:uA.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(ut.name=ut.name.substr(0,ut.name.length-3),ut.isArray=!0,ut.location=uj.getUniformLocation(this._program,ut.name)),this._params.push(ut)}for(ub=0,ud=this._params.length;ub<ud;ub++)if((ut=this._params[ub]).indexOfParams=ub,ut.index=1,ut.value=[ut.location,null],ut.codename=ut.name,ut.name=this._nameMap[ut.codename]?this._nameMap[ut.codename]:ut.codename,(this._paramsMap[ut.name]=ut)._this=this,ut.uploadedValue=[],"attribute"!==ut.vartype)switch(ut.type){case 5124:ut.fun=ut.isArray?this._uniform1iv:this._uniform1i;break;case 5126:ut.fun=ut.isArray?this._uniform1fv:this._uniform1f;break;case 35664:ut.fun=ut.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:ut.fun=ut.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:ut.fun=ut.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:ut.fun=this._uniform_sampler2D;break;case 35680:ut.fun=this._uniform_samplerCube;break;case 35676:ut.glfun=uj.uniformMatrix4fv,ut.fun=this._uniformMatrix4fv;break;case 35670:ut.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else ut.fun=this._attribute}},uj.getUniform=function(uW){return this._paramsMap[uW]},uj._attribute=function(uW,uj){var ut=uZW.mainContext,ud=usW._enableAtributes,ub=uW.location;return ud[ub]||ut.enableVertexAttribArray(ub),ut.vertexAttribPointer(ub,uj[0],uj[1],uj[2],uj[3],uj[4]+this._offset),ud[ub]=usW._bindVertexBuffer,1},uj._uniform1f=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj?(uZW.mainContext.uniform1f(uW.location,ut[0]=uj),1):0},uj._uniform1fv=function(uW,uj){if(uj.length<4){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]||ut[2]!==uj[2]||ut[3]!==uj[3]?(uZW.mainContext.uniform1fv(uW.location,uj),ut[0]=uj[0],ut[1]=uj[1],ut[2]=uj[2],ut[3]=uj[3],1):0}return uZW.mainContext.uniform1fv(uW.location,uj),1},uj._uniform_vec2=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]?(uZW.mainContext.uniform2f(uW.location,ut[0]=uj[0],ut[1]=uj[1]),1):0},uj._uniform_vec2v=function(uW,uj){if(uj.length<2){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]||ut[2]!==uj[2]||ut[3]!==uj[3]?(uZW.mainContext.uniform2fv(uW.location,uj),ut[0]=uj[0],ut[1]=uj[1],ut[2]=uj[2],ut[3]=uj[3],1):0}return uZW.mainContext.uniform2fv(uW.location,uj),1},uj._uniform_vec3=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]||ut[2]!==uj[2]?(uZW.mainContext.uniform3f(uW.location,ut[0]=uj[0],ut[1]=uj[1],ut[2]=uj[2]),1):0},uj._uniform_vec3v=function(uW,uj){return uZW.mainContext.uniform3fv(uW.location,uj),1},uj._uniform_vec4=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]||ut[2]!==uj[2]||ut[3]!==uj[3]?(uZW.mainContext.uniform4f(uW.location,ut[0]=uj[0],ut[1]=uj[1],ut[2]=uj[2],ut[3]=uj[3]),1):0},uj._uniform_vec4v=function(uW,uj){return uZW.mainContext.uniform4fv(uW.location,uj),1},uj._uniformMatrix2fv=function(uW,uj){return uZW.mainContext.uniformMatrix2fv(uW.location,!1,uj),1},uj._uniformMatrix3fv=function(uW,uj){return uZW.mainContext.uniformMatrix3fv(uW.location,!1,uj),1},uj._uniformMatrix4fv=function(uW,uj){return uZW.mainContext.uniformMatrix4fv(uW.location,!1,uj),1},uj._uniform1i=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj?(uZW.mainContext.uniform1i(uW.location,ut[0]=uj),1):0},uj._uniform1iv=function(uW,uj){return uZW.mainContext.uniform1iv(uW.location,uj),1},uj._uniform_ivec2=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]?(uZW.mainContext.uniform2i(uW.location,ut[0]=uj[0],ut[1]=uj[1]),1):0},uj._uniform_ivec2v=function(uW,uj){return uZW.mainContext.uniform2iv(uW.location,uj),1},uj._uniform_vec3i=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]||ut[2]!==uj[2]?(uZW.mainContext.uniform3i(uW.location,ut[0]=uj[0],ut[1]=uj[1],ut[2]=uj[2]),1):0},uj._uniform_vec3vi=function(uW,uj){return uZW.mainContext.uniform3iv(uW.location,uj),1},uj._uniform_vec4i=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]||ut[2]!==uj[2]||ut[3]!==uj[3]?(uZW.mainContext.uniform4i(uW.location,ut[0]=uj[0],ut[1]=uj[1],ut[2]=uj[2],ut[3]=uj[3]),1):0},uj._uniform_vec4vi=function(uW,uj){return uZW.mainContext.uniform4iv(uW.location,uj),1},uj._uniform_sampler2D=function(uW,uj){var ut=uZW.mainContext,ud=uW.uploadedValue;return null==ud[0]?(ud[0]=this._curActTexIndex,ut.uniform1i(uW.location,this._curActTexIndex),ut.activeTexture(uc._TEXTURES[this._curActTexIndex]),uXW.bindTexture(ut,3553,uj),this._curActTexIndex++,1):(ut.activeTexture(uc._TEXTURES[ud[0]]),uXW.bindTexture(ut,3553,uj),0)},uj._uniform_samplerCube=function(uW,uj){var ut=uZW.mainContext,ud=uW.uploadedValue;return null==ud[0]?(ud[0]=this._curActTexIndex,ut.uniform1i(uW.location,this._curActTexIndex),ut.activeTexture(uc._TEXTURES[this._curActTexIndex]),uXW.bindTexture(ut,34067,uj),this._curActTexIndex++,1):(ut.activeTexture(uc._TEXTURES[ud[0]]),uXW.bindTexture(ut,34067,uj),0)},uj._noSetValue=function(uW){console.log("no....:"+uW.name)},uj.uploadOne=function(uW,uj){this.activeResource(),uXW.UseProgram(this._program);var ut=this._paramsMap[uW];ut.fun.call(this,ut,uj)},uj.uploadTexture2D=function(uW){ul.shaderCall++;var uj=uZW.mainContext;uj.activeTexture(33984),uXW.bindTexture(uj,3553,uW)},uj.uploadTexture2D1=function(uW){ul.shaderCall++;var uj=uZW.mainContext;uj.activeTexture(33985),uXW.bindTexture(uj,3553,uW)},uj.upload=function(uW,uj){uuW.activeShader=uuW.bindShader=this,this._lastUseFrameCount===ul.loopCount||this.activeResource(),uXW.UseProgram(this._program),this._reCompile?(uj=this._params,this._reCompile=!1):uj=uj||this._params;uZW.mainContext;for(var ut,ud,ub=uj.length,uE=0,uO=0;uO<ub;uO++)null!==(ud=uW[(ut=uj[uO]).name])&&(uE+=ut.fun.call(this,ut,ud));ul.shaderCall+=uE},uj.uploadArray=function(uW,uj,ut){uuW.activeShader=this,(uuW.bindShader=this).activeResource(),uXW.UseProgram(this._program);this._params;for(var ud,ub,uE=0,uO=uj-2;0<=uO;uO-=2)(ub=this._paramsMap[uW[uO]])&&null!=(ud=uW[uO+1])&&(ut&&ut[ub.name]&&ut[ub.name].bind(),uE+=ub.fun.call(this,ub,ud));ul.shaderCall+=uE},uj.getParams=function(){return this._params},uc.getShader=function(uW){return uc.sharders[uW]},uc.create=function(uW,uj,ut,ud){return new uc(uW,uj,ut,ud)},uc.withCompile=function(uW,uj,ut,ud){if(ut&&uc.sharders[ut])return uc.sharders[ut];var ub=uc._preCompileShader[2e-4*uW];if(!ub)throw new Error("withCompile shader err!"+uW);return ub.createShader(uj,ut,ud)},uc.withCompile2D=function(uW,uj,ut,ud,ub){if(ud&&uc.sharders[ud])return uc.sharders[ud];var uE=uc._preCompileShader[2e-4*uW+uj];if(!uE)throw new Error("withCompile shader err!"+uW+" "+uj);return uE.createShader(ut,ud,ub)},uc.addInclude=function(uW,uj){uMW.addInclude(uW,uj)},uc.preCompile=function(uW,uj,ut,ud){var ub=2e-4*uW;uc._preCompileShader[ub]=new uMW(ub,uj,ut,ud)},uc.preCompile2D=function(uW,uj,ut,ud,ub){var uE=2e-4*uW+uj;uc._preCompileShader[uE]=new uMW(uE,ut,ud,ub)},uc._createShader=function(uW,uj,ut){var ud=uW.createShader(ut);return uW.shaderSource(ud,uj),uW.compileShader(ud),ud},uc._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],uc._count=0,uc._preCompileShader={},uc.SHADERNAME2ID=2e-4,uc.sharders=((uc.sharders=[]).length=32,uc.sharders),uO(uc,["nameKey",function(){return this.nameKey=new uh}]),uc}(),uBW=function(uW){function uj(){this._maxsize=0,this._upload=!0,this._uploadSize=0,uj.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}uQ(uj,"laya.webgl.utils.Buffer2D",uW);var ut=uj.prototype;return ut.needSize=function(uW){var uj=this._byteLength;if(uW){var ut=this._byteLength+uW;ut<=this._buffer.byteLength||this._resizeBuffer(ut<<1,!0),this._byteLength=ut}return uj},ut._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),ul.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,usW._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),usW._gl.bufferSubData(this._bufferType,0,this._buffer)},ut._bufferSubData=function(uW,uj,ut){if(void 0===uW&&(uW=0),void 0===uj&&(uj=0),void 0===ut&&(ut=0),this._maxsize=Math.max(this._maxsize,this._byteLength),ul.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,usW._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),uj||ut){var ud=this._buffer.slice(uj,ut);usW._gl.bufferSubData(this._bufferType,uW,ud)}else usW._gl.bufferSubData(this._bufferType,uW,this._buffer)},ut._checkArrayUse=function(){},ut._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},ut._bind_subUpload=function(uW,uj,ut){return void 0===uW&&(uW=0),void 0===uj&&(uj=0),void 0===ut&&(ut=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(uW,uj,ut),!0)},ut._resizeBuffer=function(uW,uj){if(uW<this._buffer.byteLength)return this;if(this.memorySize=uW,uj&&this._buffer&&0<this._buffer.byteLength){var ut=new ArrayBuffer(uW);new Uint8Array(ut).set(new Uint8Array(this._buffer),0),this._buffer=ut}else this._buffer=new ArrayBuffer(uW);return this._checkArrayUse(),this._upload=!0,this},ut.append=function(uW){this._upload=!0;var uj,ut;uj=uW.byteLength,uW instanceof Uint8Array?(this._resizeBuffer(this._byteLength+uj,!0),ut=new Uint8Array(this._buffer,this._byteLength)):uW instanceof Uint16Array?(this._resizeBuffer(this._byteLength+uj,!0),ut=new Uint16Array(this._buffer,this._byteLength)):uW instanceof Float32Array&&(this._resizeBuffer(this._byteLength+uj,!0),ut=new Float32Array(this._buffer,this._byteLength)),ut.set(uW,0),this._byteLength+=uj,this._checkArrayUse()},ut.appendU16Array=function(uW,uj){this._resizeBuffer(this._byteLength+2*uj,!0);for(var ut=new Uint16Array(this._buffer,this._byteLength,uj),ud=0;ud<uj;ud++)ut[ud]=uW[ud];this._byteLength+=2*uj,this._checkArrayUse()},ut.appendEx=function(uW,uj){this._upload=!0;var ut;ut=uW.byteLength,this._resizeBuffer(this._byteLength+ut,!0),new uj(this._buffer,this._byteLength).set(uW,0),this._byteLength+=ut,this._checkArrayUse()},ut.appendEx2=function(uW,uj,ut,ud){void 0===ud&&(ud=1),this._upload=!0;var ub,uE;ub=ut*ud,this._resizeBuffer(this._byteLength+ub,!0),uE=new uj(this._buffer,this._byteLength);var uO=0;for(uO=0;uO<ut;uO++)uE[uO]=uW[uO];this._byteLength+=ub,this._checkArrayUse()},ut.getBuffer=function(){return this._buffer},ut.setNeedUpload=function(){this._upload=!0},ut.getNeedUpload=function(){return this._upload},ut.upload=function(){var uW=this._bind_upload();return usW._gl.bindBuffer(this._bufferType,null),usW._bindActive[this._bufferType]=null,uuW.activeShader=null,uW},ut.subUpload=function(uW,uj,ut){void 0===uW&&(uW=0),void 0===uj&&(uj=0),void 0===ut&&(ut=0);var ud=this._bind_subUpload();return usW._gl.bindBuffer(this._bufferType,null),usW._bindActive[this._bufferType]=null,uuW.activeShader=null,ud},ut.disposeResource=function(){uW.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},ut.clear=function(){this._byteLength=0,this._upload=!0},ud(0,ut,"bufferLength",function(){return this._buffer.byteLength}),ud(0,ut,"byteLength",null,function(uW){this._byteLength!==uW&&(uW<=this._buffer.byteLength||this._resizeBuffer(2*uW+256,!0),this._byteLength=uW)}),uj.__int__=function(uW){upW.QuadrangleIB=upW.create(35044),uKW.fillIBQuadrangle(upW.QuadrangleIB,16)},uj.FLOAT32=4,uj.SHORT=2,uj}(usW),unW=(function(uj){function ut(uW){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,ut.__super.call(this,9)}uQ(ut,"laya.webgl.shader.d2.value.GlowSV",uj);var uW=ut.prototype;uW.setValue=function(uW){uj.prototype.setValue.call(this,uW)},uW.clear=function(){uj.prototype.clear.call(this)}}(ugW),function(uW){function uj(uW){uj.__super.call(this,64),this.defines.add(64)}uQ(uj,"laya.webgl.shader.d2.value.TextSV",uW);var ut=uj.prototype;return ut.release=function(){(uj.pool[uj._length++]=this).clear()},ut.clear=function(){uW.prototype.clear.call(this)},uj.create=function(){return uj._length?uj.pool[--uj._length]:new uj(null)},uj.pool=[],uj._length=0,uj}(ugW)),ukW=function(uW){function ub(uW,uj,ut,ud){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,ub.__super.call(this,uW,uj,ut,ud)}uQ(ub,"laya.webgl.shader.d2.Shader2X",uW);var uj=ub.prototype;return uj.upload2dQuick1=function(uW){this.upload(uW,this._params2dQuick1||this._make2dQuick1())},uj._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var uW,uj=this._params,ut=0,ud=uj.length;ut<ud;ut++)uW=uj[ut],(uo.isFlash||"size"!==uW.name&&"position"!==uW.name&&"texcoord"!==uW.name)&&this._params2dQuick1.push(uW)}return this._params2dQuick1},uj.disposeResource=function(){uW.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},uj.upload2dQuick2=function(uW){this.upload(uW,this._params2dQuick2||this._make2dQuick2())},uj._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var uW,uj=this._params,ut=0,ud=uj.length;ut<ud;ut++)uW=uj[ut],(uo.isFlash||"size"!==uW.name)&&this._params2dQuick2.push(uW)}return this._params2dQuick2},ub.create=function(uW,uj,ut,ud){return new ub(uW,uj,ut,ud)},ub}(uiW),upW=function(uW){function uj(uW){this._uint8Array=null,this._uint16Array=null,void 0===uW&&(uW=35044),uj.__super.call(this),this._bufferUsage=uW,this._bufferType=34963,uo.isFlash||(this._buffer=new ArrayBuffer(8))}uQ(uj,"laya.webgl.utils.IndexBuffer2D",uBW);var ut=uj.prototype;return ut._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},ut.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},ut.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},ut.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},uj.QuadrangleIB=null,uj.create=function(uW){return void 0===uW&&(uW=35044),new uj(uW)},uj}(),uFW=function(uW){function ut(uW,uj){this._floatArray32=null,this._vertexStride=0,ut.__super.call(this),this._vertexStride=uW,this._bufferUsage=uj,this._bufferType=34962,uo.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}uQ(ut,"laya.webgl.utils.VertexBuffer2D",uW);var uj=ut.prototype;return uj.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},uj.bind=function(uW){uW&&uW._bind(),this._bind()},uj.insertData=function(uW,uj){this.getFloat32Array().set(uW,uj),this._upload=!0},uj.bind_upload=function(uW){uW._bind_upload()||uW._bind(),this._bind_upload()||this._bind()},uj._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},uj.disposeResource=function(){uW.prototype.disposeResource.call(this)},uj.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},ud(0,uj,"vertexStride",function(){return this._vertexStride}),ut.create=function(uW,uj){return void 0===uj&&(uj=35048),new ut(uW,uj)},ut}(uBW),uWj=function(uW){function uq(uW,uj,ut,ud,ub,uE){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===ut&&(ut=6408),void 0===ud&&(ud=!0),uq.__super.call(this,uW,uj),uW){if(this._format=ut,this._mipmap=ud,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof uW)this._url=uW,this._src=uW,this._image=new uT.window.Image,uj&&(uj.onload&&(this.onload=uj.onload),uj.onerror&&(this.onerror=uj.onerror),uj.onCreate&&uj.onCreate(this)),this._image.crossOrigin=uW&&0==uW.indexOf("data:")?null:"",uW&&(this._image.src=uW);else if(uW instanceof ArrayBuffer){this._src=uj,this._url=this._src;var uO=new uA(uW);uO.readUTFBytes(4),uO.readUTFBytes(2),uO.getInt16();uO.endian="bigEndian",this._w=uO.getInt16(),this._h=uO.getInt16();uO.getInt16(),uO.getInt16();this._image=new Uint8Array(uW,uO.pos),this._format=uZW.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,uI.enabled&&this._w<uI.atlasLimitWidth&&this._h<uI.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(uW instanceof Uint8Array))return this._src=uj,this._url=this._src,this._image=uW.source||uW,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=uj,this._url=this._src,this._w=ub,this._h=uE,this._image=uW,this._format=0===ut?uW.byteLength/(ub*uE)==4?6408:6407:ut}this._$5__enableMerageInAtlas=!0}}uQ(uq,"laya.webgl.resource.WebGLImage",ue);var uj=uq.prototype;return u_.imps(uj,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),uj._init_=function(uW,uj){},uj._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var uW=uZW.mainContext,uj=this._source=uW.createTexture(),ut=uXW.curBindTexTarget,ud=uXW.curBindTexValue;uXW.bindTexture(uW,3553,uj);var ub=this.minFifter,uE=this.magFifter,uO=this.repeat?10497:33071,uq=uR.isPOT(this._w,this._h),uA=!1;switch(uq?(this.mipmap?-1!==ub||(ub=9987):-1!==ub||(ub=9729),-1!==uE||(uE=9729),uW.texParameteri(3553,10241,ub),uW.texParameteri(3553,10240,uE),uW.texParameteri(3553,10242,uO),uW.texParameteri(3553,10243,uO),this.mipmap&&uW.generateMipmap(3553)):(-1!==ub||(ub=9729),-1!==uE||(uE=9729),uW.texParameteri(3553,10241,ub),uW.texParameteri(3553,10240,uE),uW.texParameteri(3553,10242,33071),uW.texParameteri(3553,10243,33071)),uW.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&uW.pixelStorei(uW.UNPACK_ALIGNMENT,1),uW.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&uW.pixelStorei(uW.UNPACK_ALIGNMENT,1),uW.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:uA=!0,uW.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case uZW.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:uA=!0,uW.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}uW.pixelStorei(37441,!1),ut&&ud&&uXW.bindTexture(uW,ut,ud),this.uri||(this.uri=this._url),uA?this.memorySize=this._image.length:uq&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},uj.recreateResource=function(){var uW=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var uj=this;this._image=new uT.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(uj._needReleaseAgain)return uj._needReleaseAgain=!1,uj._image.onload=null,void(uj._image=null);uj._allowMerageInAtlas&&uj._enableMerageInAtlas?(uW.memorySize=0,uW._recreateLock=!1):uj._createWebGlTexture(),uj.completeCreate()},this._image.src=this._src}},uj.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&uZW.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},uj.onresize=function(){this._w=this._image.width,this._h=this._image.height,uI.enabled&&this._w<uI.atlasLimitWidth&&this._h<uI.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},uj.clearAtlasSource=function(){this._image=null},ud(0,uj,"format",function(){return this._format}),ud(0,uj,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(uW){this._$5__enableMerageInAtlas=uW}),ud(0,uj,"mipmap",function(){return this._mipmap}),ud(0,uj,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),ud(0,uj,"atlasSource",function(){return this._image}),ud(0,uj,"onload",null,function(uW){var uj=this;this._onload=uW,this._image&&(this._image.onload=null!=this._onload?function(){uj.onresize(),uj._onload()}:null)}),ud(0,uj,"onerror",null,function(uW){var uj=this;this._onerror=uW,this._image&&(this._image.onerror=null!=this._onerror?function(){uj._onerror()}:null)}),uq}();u_.__init([uTW,uH,uNW,uMW])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(uW,uj){"use strict";for(var ut in Object.defineProperty(uj,"__esModule",{value:!0}),Laya){var ud=Laya[ut];ud&&ud.__isclass&&(uj[ut]=ud)}}),function(uE,uW,ud){ud.un,ud.uns;var ub=ud.static,uO=ud.class,uq=ud.getset,uA=(ud.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),u$=laya.utils.ClassUtils,um=(laya.events.Event,laya.utils.HTMLChar),uc=laya.net.Loader,uR=(laya.display.Node,laya.maths.Rectangle),uQ=laya.renders.Render,uT=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),ue=laya.utils.Stat,uu=laya.display.Text,uK=laya.resource.Texture,uo=laya.net.URL,uS=laya.utils.Utils,uM=function(){function uT(){}return uO(uT,"laya.html.utils.HTMLParse"),uT.parse=function(uW,uj,ut){uj=(uj="<root>"+(uj=uj.replace(/<br>/g,"<br/>"))+"</root>").replace(uT.spacePattern,uT.char255);var ud=uS.parseXMLFromString(uj);uT._parseXML(uW,ud.childNodes[0].childNodes,ut)},uT._parseXML=function(uW,uj,ut,ud){var ub=0,uE=0;if(uj.join||uj.item)for(ub=0,uE=uj.length;ub<uE;++ub)uT._parseXML(uW,uj[ub],ut,ud);else{var uO,uq,uA;if(3==uj.nodeType)return void(uW instanceof laya.html.dom.HTMLDivElement?(null==uj.nodeName&&(uj.nodeName="#text"),uq=uj.nodeName.toLowerCase(),0<(uA=uj.textContent.replace(/^\s+|\s+$/g,"")).length&&(uO=u$.getInstance(uq))&&(uW.addChild(uO),uO.innerTEXT=uA.replace(uT.char255AndOneSpacePattern," "))):0<(uA=uj.textContent.replace(/^\s+|\s+$/g,"")).length&&(uW.innerTEXT=uA.replace(uT.char255AndOneSpacePattern," ")));if("#comment"==(uq=uj.nodeName.toLowerCase()))return;if(uO=u$.getInstance(uq)){(uO=uW.addChild(uO)).URI=ut,uO.href=ud;var uc=uj.attributes;if(uc&&0<uc.length)for(ub=0,uE=uc.length;ub<uE;++ub){var uR=uc[ub],um=uR.nodeName,uQ=uR.value;uO._setAttributes(um,uQ)}uT._parseXML(uO,uj.childNodes,ut,uO.href)}else uT._parseXML(uW,uj.childNodes,ut,ud)}},uT.char255=String.fromCharCode(255),uT.spacePattern=/&nbsp;|&#160;/g,uT.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),uT}(),uZ=function(){function ua(){}return uO(ua,"laya.html.utils.Layout"),ua.later=function(uW){null==ua._will&&(ua._will=[],ud.stage.frameLoop(1,null,function(){if(!(ua._will.length<1)){for(var uW=0;uW<ua._will.length;uW++)laya.html.utils.Layout.layout(ua._will[uW]);ua._will.length=0}})),ua._will.push(uW)},ua.layout=function(uW){if(!uW||!uW._style)return null;if(0==(512&uW._style._type))return null;uW.getStyle()._type&=-513;var uj=ua._multiLineLayout(uW);return uQ.isConchApp&&uW.layaoutCallNative&&uW.layaoutCallNative(),uj},ua._multiLineLayout=function(uW){if(uu.RightToLeft)return ua._multiLineLayout2(uW);var uj=new Array;uW._addChildsToLayout(uj);var ut,ud,ub,uE,uO,uq=0,uA=uj.length,uc=uW._getCSSStyle(),uR=uc.letterSpacing,um=uc.leading,uQ=uc.lineHeight,uT=uc._widthAuto()||!uc.wordWrap,u$=uT?999999:uW.width,ue=(uW.height,0),uK=uc.italic?uc.fontSize/3:0,uo=uc._getAlign(),uS=uc._getValign(),uM=0!==uS||0!==uo||0!=uQ,uZ=0,uX=0,u_=0,uN=0,uz=new Array,uC=uz[0]=new uD,uL=!1,uV=!1;uC.h=0,uc.italic&&(u$-=uc.fontSize/3);var ux=0,uG=!0;function ul(){uC.y=uX,uX+=uC.h+um,0==uC.h&&(uX+=uQ),uC.mWidth=ux,ux=0,uC=new uD,uz.push(uC),uC.h=0,uL=!(uG=!(uZ=0))}for(uq=0;uq<uA;uq++)if(null!=(ut=uj[uq]))if(uG=!1,ut instanceof laya.html.dom.HTMLBrElement)ul(),uC.y=uX;else{if(ut._isChar()){if((uE=ut).isWord)uL=uV||"\n"===uE.char,uC.wordStartIndex=uC.elements.length;else{if(u_=uE.width+uE.style.letterSpacin,0<uz.length&&u$<uZ+u_&&0<uC.wordStartIndex){var uh;uh=uC.elements.length-uC.wordStartIndex+1,uC.elements.length=uC.wordStartIndex,uq-=uh,ul();continue}uL=!1,ux+=uE.width}u_=uE.width+uR,uN=uE.height,uV=!1,(uL=uL||u$<uZ+u_)&&ul(),uC.minTextHeight=Math.min(uC.minTextHeight,ut.height)}else ud=ut._getCSSStyle(),uO=ut,ub=ud.padding,0===ud._getCssFloat()||(uM=!0),uL=uV||ud.lineElement,u_=uO.width*uO._style._tf.scaleX+ub[1]+ub[3]+uR,uN=uO.height*uO._style._tf.scaleY+ub[0]+ub[2],uV=ud.lineElement,(uL=uL||u$<uZ+u_&&ud.wordWrap)&&ul();uC.elements.push(ut),uC.h=Math.max(uC.h,uN),ut.x=uZ,ut.y=uX,uZ+=u_,uC.w=uZ-uR,uC.y=uX,ue=Math.max(uZ+uK,ue)}else uG||(uZ+=ua.DIV_ELEMENT_PADDING),uC.wordStartIndex=uC.elements.length;if(uX=uC.y+uC.h,uM){var uv=0,uy=u$;for(uT&&0<uW.width&&(uy=uW.width),uq=0,uA=uz.length;uq<uA;uq++)uz[uq].updatePos(0,uy,uq,uv,uo,uS,uQ),uv+=Math.max(uQ,uz[uq].h+um);uX=uv}return uT&&(uW.width=ue),uX>uW.height&&(uW.height=uX),[ue,uX]},ua._multiLineLayout2=function(uW){var uj=new Array;uW._addChildsToLayout(uj);var ut,ud,ub,uE,uO,uq=0,uA=uj.length,uc=uW._getCSSStyle(),uR=uc.letterSpacing,um=uc.leading,uQ=uc.lineHeight,uT=uc._widthAuto()||!uc.wordWrap,u$=uT?999999:uW.width,ue=(uW.height,0),uK=uc.italic?uc.fontSize/3:0,uo=2-uc._getAlign(),uS=uc._getValign(),uM=0!==uS||0!=uo||0!=uQ,uZ=0,uX=0,u_=0,uN=0,uz=new Array,uC=uz[0]=new uD,uL=!1,uV=!1;uC.h=0,uc.italic&&(u$-=uc.fontSize/3);var ux=0,uG=!0;function ul(){uC.y=uX,uX+=uC.h+um,0==uC.h&&(uX+=uQ),uC.mWidth=ux,ux=0,uC=new uD,uz.push(uC),uC.h=0,uL=!(uG=!(uZ=0))}for(uq=0;uq<uA;uq++)if(null!=(ut=uj[uq]))if(uG=!1,ut instanceof laya.html.dom.HTMLBrElement)ul(),uC.y=uX;else{if(ut._isChar()){if((uE=ut).isWord)uL=uV||"\n"===uE.char,uC.wordStartIndex=uC.elements.length;else{if(0<uz.length&&u$<uZ+u_&&0<uC.wordStartIndex){var uh;uh=uC.elements.length-uC.wordStartIndex+1,uC.elements.length=uC.wordStartIndex,uq-=uh,ul();continue}uL=!1,ux+=uE.width}u_=uE.width+uR,uN=uE.height,uV=!1,(uL=uL||u$<uZ+u_)&&ul(),uC.minTextHeight=Math.min(uC.minTextHeight,ut.height)}else ud=ut._getCSSStyle(),uO=ut,ub=ud.padding,0===ud._getCssFloat()||(uM=!0),uL=uV||ud.lineElement,u_=uO.width*uO._style._tf.scaleX+ub[1]+ub[3]+uR,uN=uO.height*uO._style._tf.scaleY+ub[0]+ub[2],uV=ud.lineElement,(uL=uL||u$<uZ+u_&&ud.wordWrap)&&ul();uC.elements.push(ut),uC.h=Math.max(uC.h,uN),ut.x=uZ,ut.y=uX,uZ+=u_,uC.w=uZ-uR,uC.y=uX,ue=Math.max(uZ+uK,ue)}else uG||(uZ+=ua.DIV_ELEMENT_PADDING),uC.wordStartIndex=uC.elements.length;if(uX=uC.y+uC.h,uM){var uv=0,uy=u$;for(uq=0,uA=uz.length;uq<uA;uq++)uz[uq].updatePos(0,uy,uq,uv,uo,uS,uQ),uv+=Math.max(uQ,uz[uq].h+um);uX=uv}for(uT&&(uW.width=ue),uX>uW.height&&(uW.height=uX),uq=0,uA=uz.length;uq<uA;uq++)uz[uq].revertOrder(u$);return[ue,uX]},ua._will=null,ua.DIV_ELEMENT_PADDING=0,ua}(),uD=function(){function uW(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}uO(uW,"laya.html.utils.LayoutLine");var uj=uW.prototype;return uj.updatePos=function(uW,uj,ut,ud,ub,uE,uO){var uq,uA=0;0<this.elements.length&&(uA=(uq=this.elements[this.elements.length-1]).x+uq.width-this.elements[0].x);var uc=0,uR=NaN;1===ub&&(uc=(uj-uA)/2),2===ub&&(uc=uj-uA),0===uO||0!=uE||(uE=1);for(var um=0,uQ=this.elements.length;um<uQ;um++){var uT=(uq=this.elements[um])._getCSSStyle();switch(0!==uc&&(uq.x+=uc),uT._getValign()){case 0:uq.y=ud;break;case 1:var u$=0;99999!=this.minTextHeight&&(u$=this.minTextHeight);var ue=(u$+uO)/2;ue=Math.max(ue,this.h),uR=(laya.html.dom.HTMLImageElement,ud+ue-uq.height),uq.y=uR;break;case 2:uq.y=ud+(uO-uq.height)}}},uj.revertOrder=function(uW){var uj;if(0<this.elements.length){var ut,ud=0;for(ut=this.elements.length,ud=0;ud<ut;ud++)(uj=this.elements[ud]).x=uW-uj.x-uj.width}},uW}(),uX=function(ut){function uj(){this.URI=null,this._href=null,uj.__super.call(this),this._text=uj._EMPTYTEXT,this.setStyle(new uA(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}uO(uj,"laya.html.dom.HTMLElement",ut);var uW=uj.prototype;return uW.layaoutCallNative=function(){var uW=0;if(this._childs&&0<(uW=this._childs.length))for(var uj=0;uj<uW;uj++)this._childs[uj].layaoutCallNative&&this._childs[uj].layaoutCallNative();var ut=this._getWords();ut?laya.html.dom.HTMLElement.fillWords(this,ut,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},uW.appendChild=function(uW){return this.addChild(uW)},uW._getWords2=function(){var uW=this._text.text;if(!uW||0===uW.length)return null;var uj,ut,ud=0,ub=0;if(this._text.drawWords)ut=this._text.drawWords;else{for(ub=(uj=uW.split(" ")).length-1,ut=[],ud=0;ud<ub;ud++)ut.push(uj[ud]," ");0<=ub&&ut.push(uj[ub]),this._text.drawWords=ut}var uE,uO=this._text.words;if(uO&&uO.length===ut.length)return uO;null===uO&&(this._text.words=uO=[]),uO.length=ut.length;var uq=this.style,uA=uq.font;for(ud=0,ub=ut.length;ud<ub;ud++){uE=uS.measureText(ut[ud],uA);var uc=uO[ud]=new um(ut[ud],uE.width,uE.height||uq.fontSize,uq);if(1<uc.char.length&&(uc.charNum=uc.char),this.href){var uR=new uT;this.addChild(uR),uc.setSprite(uR)}}return uO},uW._getWords=function(){if(!uu.CharacterCache)return this._getWords2();var uW=this._text.text;if(!uW||0===uW.length)return null;var uj,ut=this._text.words;if(ut&&ut.length===uW.length)return ut;null===ut&&(this._text.words=ut=[]),ut.length=uW.length;for(var ud=this.style,ub=ud.font,uE=0,uO=uW.length;uE<uO;uE++)if(uj=uS.measureText(uW.charAt(uE),ub)){var uq=ut[uE]=new um(uW.charAt(uE),uj.width,uj.height||ud.fontSize,ud);if(this.href){var uA=new uT;this.addChild(uA),uq.setSprite(uA)}}else console.warn("_getWords size is null"+uW.charAt(uE),ub);return ut},uW.showLinkSprite=function(){var uW=this._text.words;if(uW)for(var uj,ut,ud=[],ub=0;ub<uW.length;ub++)ut=uW[ub],(uj=new uT).graphics.drawRect(0,0,ut.width,ut.height,"#ff0000"),uj.width=ut.width,uj.height=ut.height,this.addChild(uj),ud.push(uj)},uW._layoutLater=function(){var uW=this.style;512&uW._type||(uW.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&uW.block?(uZ.later(this),uW._type|=512):this.parent&&this.parent._layoutLater())},uW._setAttributes=function(uW,uj){switch(uW){case"style":return void this.style.cssText(uj);case"class":return void(this.className=uj)}ut.prototype._setAttributes.call(this,uW,uj)},uW.updateHref=function(){if(null!=this._href){var uW=this._getWords();if(uW)for(var uj,ut,ud=0;ud<uW.length;ud++)(ut=(uj=uW[ud]).getSprite())&&(ut.size(uj.width,uj.height),ut.on("click",this,this.onLinkHandler))}},uW.onLinkHandler=function(uW){switch(uW.type){case"click":for(var uj=this;uj;)uj.event("link",[this.href]),uj=uj.parent}},uW.formatURL=function(uW){return this.URI?uo.formatURL(uW,this.URI?this.URI.path:null):uW},uq(0,uW,"href",function(){return this._href},function(uW){null!=(this._href=uW)&&(this._getCSSStyle().underLine=1,this.updateHref())}),uq(0,uW,"color",null,function(uW){this.style.color=uW}),uq(0,uW,"onClick",null,function(uW){ud._runScript("fn=function(event){"+uW+";}"),this.on("click",this,void 0)}),uq(0,uW,"id",null,function(uW){u_.document.setElementById(uW,this)}),uq(0,uW,"innerTEXT",function(){return this._text.text},function(uW){this.text=uW}),uq(0,uW,"style",function(){return this._style}),uq(0,uW,"text",function(){return this._text.text},function(uW){this._text==uj._EMPTYTEXT?this._text={text:uW,words:null}:(this._text.text=uW,this._text.words&&(this._text.words.length=0)),uQ.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),uq(0,uW,"parent",ut.prototype._$get_parent,function(uW){if(uW instanceof laya.html.dom.HTMLElement){var uj=uW;this.URI||(this.URI=uj.URI),this.style.inherit(uj.style)}ud.superSet(uT,this,"parent",uW)}),uq(0,uW,"className",null,function(uW){this.style.attrs(u_.document.styleSheets["."+uW])}),uj.fillWords=function(uW,uj,ut,ud,ub,uE,uO){uW.graphics.clear();for(var uq=0,uA=uj.length;uq<uA;uq++){var uc=uj[uq];uW.graphics.fillText(uc.char,uc.x+ut,uc.y+ud,ub,uE,"left",uO)}},uj._EMPTYTEXT={text:null,words:null},uj}(uT),uj=(function(uW){function uj(){uj.__super.call(this),this.style.lineElement=!0,this.style.block=!0}uO(uj,"laya.html.dom.HTMLBrElement",uX)}(),function(uW){function uj(){this.contextHeight=NaN,this.contextWidth=NaN,uj.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}uO(uj,"laya.html.dom.HTMLDivElement",uW);var ut=uj.prototype;return ut.appendHTML=function(uW){uM.parse(this,uW,this.URI),this.layout()},ut._addChildsToLayout=function(uj){var uW=this._getWords();if(null==uW&&0==this._childs.length)return!1;uW&&uW.forEach(function(uW){uj.push(uW)});for(var ut=!0,ud=0,ub=this._childs.length;ud<ub;ud++){var uE=this._childs[ud];ut?ut=!1:uj.push(null),uE._addToLayout(uj)}return!0},ut._addToLayout=function(uW){this.layout()},ut.layout=function(){if(this.style){this.style._type|=512;var uW=uZ.layout(this);if(uW){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new uR);var uj=this._$P.mHtmlBounds;uj.x=uj.y=0,uj.width=this.contextWidth=uW[0],uj.height=this.contextHeight=uW[1],this.setBounds(uj)}}},uq(0,ut,"height",function(){return this._height?this._height:this.contextHeight},uW.prototype._$set_height),uq(0,ut,"innerHTML",null,function(uW){this.destroyChildren(),this.appendHTML(uW)}),uq(0,ut,"width",function(){return this._width?this._width:this.contextWidth},function(uW){var uj=!1;uj=0===uW?uW!=this._width:uW!=this.width,ud.superSet(uX,this,"width",uW),uj&&this.layout()}),uj}(uX)),u_=function(uW){function uj(){this.all=new Array,this.styleSheets=uA.styleSheets,uj.__super.call(this)}uO(uj,"laya.html.dom.HTMLDocument",uX);var ut=uj.prototype;return ut.getElementById=function(uW){return this.all[uW]},ut.setElementById=function(uW,uj){this.all[uW]=uj},ub(uj,["document",function(){return this.document=new uj}]),uj}();(function(uW){function uj(){this._tex=null,this._url=null,this._renderArgs=[],uj.__super.call(this),this.style.block=!0}uO(uj,"laya.html.dom.HTMLImageElement",uX);var ut=uj.prototype;ut._addToLayout=function(uW){!this._style.absolute&&uW.push(this)},ut.render=function(uW,uj,ut){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(ue.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,uW.ctx.drawTexture2(uj,ut,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},ut.layaoutCallNative=function(){var uW=0;if(this._childs&&0<(uW=this._childs.length))for(var uj=0;uj<uW;uj++)this._childs[uj].layaoutCallNative&&this._childs[uj].layaoutCallNative()},uq(0,ut,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(uW){this._width!==uW&&(this._width=uW,this._style.width=uW,this.repaint())}),uq(0,ut,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(uW){this._height!==uW&&(this._height=uW,this._style.height=uW,this.repaint())}),ut.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),uc.clearCache(this,this._url),this._tex=null),uX.prototype.destroy.call(this)},ut.onloaded=function(){var uW=this._style;uW&&!uW.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),uW&&!uW.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),uQ.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},ut._loadImageComplete=function(uW,uj,ut){if(!this._destroyed)if(null!=ut)if(ut instanceof ArrayBuffer){var ud=new DataView(ut);new laya.webgl.resource.WebGLImage(new Uint8Array(ut,8),uW,0,!1,ud.getUint32(0),ud.getUint32(4));this.onloaded()}else if(ut instanceof uK)uc.imgMgrSet[uW]=uj,uE.imgMgrLock(uW,uc.imgMgrSet[uW]),this._url=uW,this._tex=ut,uc.keepCache(this,uW),uc.cacheRes(uW,this._tex),this.onloaded();else{var ub=-1!=uW.indexOf(".png",uW.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(ut,uW,ub,!1,ut.width,ut.height);this.onloaded()}else this.event("error","Load image failed")},uq(0,ut,"src",null,function(uW){(uW=this.formatURL(uW),this._url!=uW)&&(null!=this._tex&&(uc.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=uW,(this._tex=uc.getRes(uW))?(uc.keepCache(this,uW),this.onloaded()):uE.imgMgrLoad(uW,this._loadImageComplete.bind(this),2,!1))})})(),function(uW){function uj(){this.type=null,uj.__super.call(this),this.visible=!1}uO(uj,"laya.html.dom.HTMLLinkElement",uW);var ut=uj.prototype;ut._onload=function(uW){switch(this.type){case"text/css":uA.parseCSS(uW,this.URI)}},uq(0,ut,"href",uW.prototype._$get_href,function(uW){var uj=this;uW=this.formatURL(uW),this.URI=new uo(uW);var ut=new uc;ut.once("complete",null,function(uW){uj._onload(uW)}),ut.load(uW,"text")}),uj._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(uX),function(uW){function uj(){uj.__super.call(this),this.visible=!1}uO(uj,"laya.html.dom.HTMLStyleElement",uW),uq(0,uj.prototype,"text",uW.prototype._$get_text,function(uW){uA.parseCSS(uW,null)})}(uX),function(uW){function uj(){uj.__super.call(this),this._getCSSStyle().valign="middle"}uO(uj,"laya.html.dom.HTMLIframeElement",uW),uq(0,uj.prototype,"href",uW.prototype._$get_href,function(ut){var ud=this;ut=this.formatURL(ut);var uW=new uc;uW.once("complete",null,function(uW){var uj=ud.URI;ud.URI=new uo(ut),ud.innerHTML=uW,!uj||(ud.URI=uj)}),uW.load(ut,"text")})}(uj)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(uW,uj){"use strict";for(var ut in Object.defineProperty(uj,"__esModule",{value:!0}),Laya){var ud=Laya[ut];ud&&ud.__isclass&&(uj[ut]=ud)}}),function(uW,uj,ue){ue.un,ue.uns;var ud=ue.static,uE=ue.class,ub=ue.getset,ut=(ue.__newvec,laya.display.Animation),uK=(laya.utils.Browser,laya.utils.ClassUtils),uO=laya.filters.ColorFilter,uq=laya.utils.Ease,uA=laya.events.Event,uc=(laya.events.EventDispatcher,laya.display.css.Font),uR=laya.display.FrameAnimation,um=laya.display.Graphics,uQ=laya.utils.Handler,uT=laya.display.Input,uS=laya.net.Loader,u$=(laya.display.Node,laya.maths.Point),uo=laya.maths.Rectangle,uM=laya.renders.Render,uZ=laya.display.Sprite,uX=laya.display.Text,u_=laya.resource.Texture,uN=laya.utils.Tween,uz=laya.utils.Utils,uC=laya.utils.WeakObject;ue.interface("laya.ui.IItem"),ue.interface("laya.ui.ISelect"),ue.interface("laya.ui.IRender"),ue.interface("laya.ui.IComponent"),ue.interface("laya.ui.IBox","IComponent");var uL=function(){function uW(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return uE(uW,"laya.ui.LayoutStyle"),ud(uW,["EMPTY",function(){return this.EMPTY=new uW}]),uW}(),uV=function(){function uW(){}return uE(uW,"laya.ui.Styles"),uW.labelColor="#000000",uW.buttonStateNum=3,uW.scrollBarMinNum=15,uW.scrollBarDelayTime=500,ud(uW,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),uW}(),ux=function(){function ub(){}return uE(ub,"laya.ui.UIUtils"),ub.fillArray=function(uW,uj,ut){var ud=uW.concat();if(uj)for(var ub=uj.split(","),uE=0,uO=Math.min(ud.length,ub.length);uE<uO;uE++){var uq=ub[uE];ud[uE]="true"==uq||"false"!=uq&&uq,null!=ut&&(ud[uE]=ut(uq))}return ud},ub.toColor=function(uW){return uz.toHexColor(uW)},ub.gray=function(uW,uj){void 0===uj&&(uj=!0),uj?ub.addFilter(uW,ub.grayFilter):ub.clearFilter(uW,uO)},ub.addFilter=function(uW,uj){var ut=uW.filters||[];ut.push(uj),uW.filters=ut},ub.clearFilter=function(uW,uj){var ut=uW.filters;if(null!=ut&&0<ut.length){for(var ud=ut.length-1;-1<ud;ud--){var ub=ut[ud];ue.__typeof(ub,uj)&&ut.splice(ud,1)}uW.filters=ut}},ub._getReplaceStr=function(uW){return ub.escapeSequence[uW]},ub.adptString=function(uW){return uW.replace(/\\(\w)/g,ub._getReplaceStr)},ub.getBindFun=function(uW){var uj=ub._funMap.get(uW);if(null==uj){var ut='"'+uW+'"',ud="(function(data){if(data==null)return;with(data){try{\nreturn "+(ut=ut.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";uj=ue._runScript(ud),ub._funMap.set(uW,uj)}return uj},ud(ub,["grayFilter",function(){return this.grayFilter=new uO([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new uC}]),ub}(),uG=function(){function uW(){}return uE(uW,"UIConfig"),uW.touchScrollEnable=!0,uW.mouseWheelEnable=!0,uW.showButtons=!0,uW.popupBgColor="#000000",uW.popupBgAlpha=.5,uW.closeDialogOnSide=!0,uW}(),ul=function(ut){function uo(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,uo.__super.call(this),this._weakKeys=[]}uE(uo,"laya.ui.AutoBitmap",ut);var uW=uo.prototype;return uW.destroy=function(){if(uS.clearObject(this,this._weakKey),this._weakKeys){for(var uW=0,uj=this._weakKeys.length;uW<uj;++uW)uS.clearObject(this,this._weakKeys[uW]);this._weakKeys=null}ut.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},uW._setChanged=function(){this._isChanged||(this._isChanged=!0,ue.timer.callLater(this,this.changeSource))},uW.changeSource=function(){this._isChanged=!1;var uW=this._source;if(uW&&uW.bitmap){var uj=this.width,ut=this.height,ud=this._sizeGrid,ub=uW.sourceWidth,uE=uW.sourceHeight;if(!ud||ub===uj&&uE===ut)this.cleanByTexture(uW,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,uj,ut);else{uS.clearObject(this,this._weakKey),uW.$_GID||(uW.$_GID=uz.getGID());var uO=uW.$_GID+"."+uj+"."+ut+"."+ud.join("."),uq=uS.findObject(uO);if(uz.isOKCmdList(uq))return this._weakKey=uO,uS.keepObject(this,this._weakKey),void(this.cmds=uq);this.clear();var uA,uc,uR=ud[0],um=ud[1],uQ=ud[2],uT=ud[3],u$=ud[4],ue=!1;if(uj==ub&&(uT=um=0),ut==uE&&(uR=uQ=0),uj<uT+um){var uK=uj;ue=!0,uj=uT+um,this.save(),this.clipRect(0,0,uK,ut)}uT&&uR&&(uA=uo.getTexture(uW,0,0,uT,uR),uc=this._weakKeys[0],uA?(uc!=uA.weakKey&&(uS.clearObject(this,uc),uS.keepObject(this,uA.weakKey),this._weakKeys[0]=uA.weakKey),this.drawTexture(uA,0,0,uT,uR)):(uS.clearObject(this,uc),this._weakKeys[0]="")),um&&uR&&(uA=uo.getTexture(uW,ub-um,0,um,uR),uc=this._weakKeys[1],uA?(uc!=uA.weakKey&&(uS.clearObject(this,uc),uS.keepObject(this,uA.weakKey),this._weakKeys[1]=uA.weakKey),this.drawTexture(uA,uj-um,0,um,uR)):(uS.clearObject(this,uc),this._weakKeys[1]="")),uT&&uQ&&(uA=uo.getTexture(uW,0,uE-uQ,uT,uQ),uc=this._weakKeys[2],uA?(uc!=uA.weakKey&&(uS.clearObject(this,uc),uS.keepObject(this,uA.weakKey),this._weakKeys[2]=uA.weakKey),this.drawTexture(uA,0,ut-uQ,uT,uQ)):(uS.clearObject(this,uc),this._weakKeys[2]="")),um&&uQ&&(uA=uo.getTexture(uW,ub-um,uE-uQ,um,uQ),uc=this._weakKeys[3],uA?(uc!=uA.weakKey&&(uS.clearObject(this,uc),uS.keepObject(this,uA.weakKey),this._weakKeys[3]=uA.weakKey),this.drawTexture(uA,uj-um,ut-uQ,um,uQ)):(uS.clearObject(this,uc),this._weakKeys[3]="")),uR&&(uA=uo.getTexture(uW,uT,0,ub-uT-um,uR),uc=this._weakKeys[4],uA?(uc!=uA.weakKey&&(uS.clearObject(this,uc),uS.keepObject(this,uA.weakKey),this._weakKeys[4]=uA.weakKey),this.drawBitmap(u$,uA,uT,0,uj-uT-um,uR)):(uS.clearObject(this,uc),this._weakKeys[4]="")),uQ&&(uA=uo.getTexture(uW,uT,uE-uQ,ub-uT-um,uQ),uc=this._weakKeys[5],uA?(uc!=uA.weakKey&&(uS.clearObject(this,uc),uS.keepObject(this,uA.weakKey),this._weakKeys[5]=uA.weakKey),this.drawBitmap(u$,uA,uT,ut-uQ,uj-uT-um,uQ)):(uS.clearObject(this,uc),this._weakKeys[5]="")),uT&&(uA=uo.getTexture(uW,0,uR,uT,uE-uR-uQ),uc=this._weakKeys[6],uA?(uc!=uA.weakKey&&(uS.clearObject(this,uc),uS.keepObject(this,uA.weakKey),this._weakKeys[6]=uA.weakKey),this.drawBitmap(u$,uA,0,uR,uT,ut-uR-uQ)):(uS.clearObject(this,uc),this._weakKeys[6]="")),um&&(uA=uo.getTexture(uW,ub-um,uR,um,uE-uR-uQ),uc=this._weakKeys[7],uA?(uc!=uA.weakKey&&(uS.clearObject(this,uc),uS.keepObject(this,uA.weakKey),this._weakKeys[7]=uA.weakKey),this.drawBitmap(u$,uA,uj-um,uR,um,ut-uR-uQ)):(uS.clearObject(this,uc),this._weakKeys[7]="")),uA=uo.getTexture(uW,uT,uR,ub-uT-um,uE-uR-uQ),uc=this._weakKeys[8],uA?(uc!=uA.weakKey&&(uS.clearObject(this,uc),uS.keepObject(this,uA.weakKey),this._weakKeys[8]=uA.weakKey),this.drawBitmap(u$,uA,uT,uR,uj-uT-um,ut-uR-uQ)):(uS.clearObject(this,uc),this._weakKeys[8]=""),ue&&this.restore(),this.autoCacheCmd&&!uM.isConchApp&&(uS.saveObject(uO,this.cmds,null),this._weakKey=uO,uS.keepObject(this,this._weakKey))}this._repaint()}},uW.drawBitmap=function(uW,uj,ut,ud,ub,uE){void 0===ub&&(ub=0),void 0===uE&&(uE=0),ub<.1||uE<.1||(!uW||uj.width==ub&&uj.height==uE?this.drawTexture(uj,ut,ud,ub,uE):this.fillTexture(uj,ut,ud,ub,uE))},uW.clear=function(uW){void 0===uW&&(uW=!0),ut.prototype.clear.call(this,!1)},ub(0,uW,"sizeGrid",function(){return this._sizeGrid},function(uW){this._sizeGrid=uW,this._setChanged()}),ub(0,uW,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(uW){this._width!=uW&&(this._width=uW,this._setChanged())}),ub(0,uW,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(uW){this._height!=uW&&(this._height=uW,this._setChanged())}),ub(0,uW,"source",function(){return this._source},function(uW){uW?(this._source=uW,this._setChanged()):(this._source=null,this.clear())}),uo.getTexture=function(uW,uj,ut,ud,ub){ud<=0&&(ud=1),ub<=0&&(ub=1),uW.$_GID||(uW.$_GID=uz.getGID());var uE=uW.$_GID+"."+uj+"."+ut+"."+ud+"."+ub,uO=uS.findObject(uE);if((!uO||!uO.source)&&(uO=u_.createFromTexture(uW,uj,ut,ud,ub))){if(uW.alphaTexture){var uq=uW.width/uW.alphaTexture.width;uO.alphaTexture=u_.createFromTexture(uW.alphaTexture,uj/uq,ut/uq,ud/uq,ub/uq)}uS.saveObject(uE,uO),uO.weakKey=uE}return uO},uo}(um),uh=(function(uW){function uj(){uj.__super.call(this)}uE(uj,"laya.ui.UIEvent",uA),uj.SHOW_TIP="showtip",uj.HIDE_TIP="hidetip"}(),function(uj){function uW(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,uW.__super.call(this),this._layout=uL.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}uE(uW,"laya.ui.Component",uj);var ut=uW.prototype;return ue.imps(ut,{"laya.ui.IComponent":!0}),ut.destroy=function(uW){void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,uW),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},ut.preinitialize=function(){},ut.createChildren=function(){},ut.initialize=function(){},ut.callLater=function(uW,uj){ue.timer.callLater(this,uW,uj)},ut.runCallLater=function(uW){ue.timer.runCallLater(this,uW)},ut.commitMeasure=function(){},ut.changeSize=function(){this.event("resize")},ut.getLayout=function(){return this._layout===uL.EMPTY&&(this._layout=new uL),this._layout},ut._setLayoutEnabled=function(uW){this._layout&&this._layout.enable!=uW&&(this._layout.enable=uW,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},ut.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},ut.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},ut.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},ut.resetLayoutX=function(){var uW=this._layout;if(isNaN(uW.anchorX)||(this.pivotX=uW.anchorX*this.width),this.layoutEnabled){var uj=this.parent;uj&&(isNaN(uW.centerX)?isNaN(uW.left)?isNaN(uW.right)||(this.x=Math.round(uj.width-this.displayWidth-uW.right+this.pivotX*this.scaleX)):(this.x=Math.round(uW.left+this.pivotX*this.scaleX),isNaN(uW.right)||(this.width=(uj._width-uW.left-uW.right)/(this.scaleX||.01))):this.x=Math.round(.5*(uj.width-this.displayWidth)+uW.centerX+this.pivotX*this.scaleX))}},ut.resetLayoutY=function(){var uW=this._layout;if(isNaN(uW.anchorY)||(this.pivotY=uW.anchorY*this.height),this.layoutEnabled){var uj=this.parent;uj&&(isNaN(uW.centerY)?isNaN(uW.top)?isNaN(uW.bottom)||(this.y=Math.round(uj.height-this.displayHeight-uW.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(uW.top+this.pivotY*this.scaleY),isNaN(uW.bottom)||(this.height=(uj._height-uW.top-uW.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(uj.height-this.displayHeight)+uW.centerY+this.pivotY*this.scaleY))}},ut.onMouseOver=function(uW){ue.stage.event("showtip",this._toolTip)},ut.onMouseOut=function(uW){ue.stage.event("hidetip",this._toolTip)},ub(0,ut,"displayWidth",function(){return this.width*this.scaleX}),ub(0,ut,"width",function(){return this._width?this._width:this.measureWidth},function(uW){this._width!=uW&&(this._width=uW,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),ub(0,ut,"measureWidth",function(){var uW=0;this.commitMeasure();for(var uj=this.numChildren-1;-1<uj;uj--){var ut=this.getChildAt(uj);ut.visible&&(uW=Math.max(ut.x+ut.width*ut.scaleX,uW))}return uW}),ub(0,ut,"displayHeight",function(){return this.height*this.scaleY}),ub(0,ut,"height",function(){return this._height?this._height:this.measureHeight},function(uW){this._height!=uW&&(this._height=uW,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),ub(0,ut,"dataSource",function(){return this._dataSource},function(uW){for(var uj in this._dataSource=uW,this._dataSource)this.hasOwnProperty(uj)&&"function"!=typeof this[uj]&&(this[uj]=this._dataSource[uj])}),ub(0,ut,"scaleY",uj.prototype._$get_scaleY,function(uW){ue.superGet(uZ,this,"scaleY")!=uW&&(ue.superSet(uZ,this,"scaleY",uW),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),ub(0,ut,"measureHeight",function(){var uW=0;this.commitMeasure();for(var uj=this.numChildren-1;-1<uj;uj--){var ut=this.getChildAt(uj);ut.visible&&(uW=Math.max(ut.y+ut.height*ut.scaleY,uW))}return uW}),ub(0,ut,"scaleX",uj.prototype._$get_scaleX,function(uW){ue.superGet(uZ,this,"scaleX")!=uW&&(ue.superSet(uZ,this,"scaleX",uW),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),ub(0,ut,"top",function(){return this._layout.top},function(uW){uW!=this._layout.top&&(this.getLayout().top=uW,this._setLayoutEnabled(!0)),this.resetLayoutY()}),ub(0,ut,"bottom",function(){return this._layout.bottom},function(uW){uW!=this._layout.bottom&&(this.getLayout().bottom=uW,this._setLayoutEnabled(!0)),this.resetLayoutY()}),ub(0,ut,"left",function(){return this._layout.left},function(uW){uW!=this._layout.left&&(this.getLayout().left=uW,this._setLayoutEnabled(!0)),this.resetLayoutX()}),ub(0,ut,"right",function(){return this._layout.right},function(uW){uW!=this._layout.right&&(this.getLayout().right=uW,this._setLayoutEnabled(!0)),this.resetLayoutX()}),ub(0,ut,"centerX",function(){return this._layout.centerX},function(uW){uW!=this._layout.centerX&&(this.getLayout().centerX=uW,this._setLayoutEnabled(!0)),this.resetLayoutX()}),ub(0,ut,"centerY",function(){return this._layout.centerY},function(uW){uW!=this._layout.centerY&&(this.getLayout().centerY=uW,this._setLayoutEnabled(!0)),this.resetLayoutY()}),ub(0,ut,"anchorX",function(){return this._layout.anchorX},function(uW){uW!=this._layout.anchorX&&(this.getLayout().anchorX=uW,this._setLayoutEnabled(!0)),this.resetLayoutX()}),ub(0,ut,"anchorY",function(){return this._layout.anchorY},function(uW){uW!=this._layout.anchorY&&(this.getLayout().anchorY=uW,this._setLayoutEnabled(!0)),this.resetLayoutY()}),ub(0,ut,"tag",function(){return this._tag},function(uW){this._tag=uW}),ub(0,ut,"toolTip",function(){return this._toolTip},function(uW){this._toolTip!=uW&&(null!=(this._toolTip=uW)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),ub(0,ut,"comXml",function(){return this._comXml},function(uW){this._comXml=uW}),ub(0,ut,"gray",function(){return this._gray},function(uW){uW!==this._gray&&(this._gray=uW,ux.gray(this,uW))}),ub(0,ut,"disabled",function(){return this._disabled},function(uW){uW!==this._disabled&&(this.gray=this._disabled=uW,this.mouseEnabled=!uW)}),uW}(uZ)),uv=function(uW){function uj(){this.lockLayer=null,this.popupEffect=function(uW){uW.scale(1,1),uN.from(uW,{x:ue.stage.width/2,y:ue.stage.height/2,scaleX:0,scaleY:0},300,uq.backOut,uQ.create(this,this.doOpen,[uW]))},this.closeEffect=function(uW,uj){uN.to(uW,{x:ue.stage.width/2,y:ue.stage.height/2,scaleX:0,scaleY:0},300,uq.strongOut,uQ.create(this,this.doClose,[uW,uj]))},uj.__super.call(this),this.maskLayer=new uZ,this.popupEffectHandler=uQ.create(this,this.popupEffect,null,!1),this.closeEffectHandler=uQ.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,ue.stage.addChild(this),ue.stage.on("resize",this,this._onResize),uG.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}uE(uj,"laya.ui.DialogManager",uZ);var ut=uj.prototype;return ut._closeOnSide=function(){var uW=this.getChildAt(this.numChildren-1);uW instanceof laya.ui.Dialog&&uW.close("side")},ut.setLockView=function(uW){this.lockLayer||(this.lockLayer=new uy,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(ue.stage.width,ue.stage.height)),this.lockLayer.removeChildren(),uW&&(uW.centerX=uW.centerY=0,this.lockLayer.addChild(uW))},ut._onResize=function(uW){var uj=this.maskLayer.width=ue.stage.width,ut=this.maskLayer.height=ue.stage.height;this.lockLayer&&this.lockLayer.size(uj,ut),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,uj,ut,uG.popupBgColor),this.maskLayer.alpha=uG.popupBgAlpha;for(var ud=this.numChildren-1;-1<ud;ud--){var ub=this.getChildAt(ud);ub.popupCenter&&this._centerDialog(ub)}},ut._centerDialog=function(uW){uW.x=Math.round((ue.stage.width-uW.width>>1)+uW.pivotX),uW.y=Math.round((ue.stage.height-uW.height>>1)+uW.pivotY)},ut.open=function(uW,uj,ut){void 0===uj&&(uj=!1),void 0===ut&&(ut=!1),uj&&this._closeAll(),uW.popupCenter&&this._centerDialog(uW),this.addChild(uW),(uW.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),ut&&null!=uW.popupEffect?uW.popupEffect.runWith(uW):this.doOpen(uW),this.event("open")},ut.doOpen=function(uW){uW.onOpened()},ut.lock=function(uW){this.lockLayer&&(uW?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},ut.close=function(uW,uj,ut){void 0===ut&&(ut=!1),ut&&null!=uW.closeEffect?uW.closeEffect.runWith([uW,uj]):this.doClose(uW,uj),this.event("close")},ut.doClose=function(uW,uj){uW.removeSelf(),uW.isModal&&this._checkMask(),uW.closeHandler&&uW.closeHandler.runWith(uj),uW.onClosed(uj)},ut.closeAll=function(){this._closeAll(),this.event("close")},ut._closeAll=function(){for(var uW=this.numChildren-1;-1<uW;uW--){var uj=this.getChildAt(uW);uj&&null!=uj.close&&this.doClose(uj)}},ut.getDialogsByGroup=function(uW){for(var uj=[],ut=this.numChildren-1;-1<ut;ut--){var ud=this.getChildAt(ut);ud&&ud.group===uW&&uj.push(ud)}return uj},ut.closeByGroup=function(uW){for(var uj=[],ut=this.numChildren-1;-1<ut;ut--){var ud=this.getChildAt(ut);ud&&ud.group===uW&&(ud.close(),uj.push(ud))}return uj},ut._checkMask=function(){this.maskLayer.removeSelf();for(var uW=this.numChildren-1;-1<uW;uW--){var uj=this.getChildAt(uW);if(uj&&uj.isModal)return void this.addChildAt(this.maskLayer,uW)}},uj}(),uy=function(uW){function uj(){uj.__super.call(this)}uE(uj,"laya.ui.Box",uW);var ut=uj.prototype;return ue.imps(ut,{"laya.ui.IBox":!0}),ub(0,ut,"dataSource",uW.prototype._$get_dataSource,function(uW){for(var uj in this._dataSource=uW){var ut=this.getChildByName(uj);ut?ut.dataSource=uW[uj]:this.hasOwnProperty(uj)&&"function"!=typeof this[uj]&&(this[uj]=uW[uj])}}),uj}(uh),ua=function(uj){function ut(uW,uj){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,ut.__super.call(this),this._labelColors=uV.buttonLabelColors,this._stateNum=uV.buttonStateNum,void 0===uj&&(uj=""),this.skin=uW,this.label=uj}uE(ut,"laya.ui.Button",uj);var uW=ut.prototype;return ue.imps(uW,{"laya.ui.ISelect":!0}),uW.destroy=function(uW){uS.clearCache(this,this._skin),uS.clearObject(this,this._weakKey),void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,uW),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(uW),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},uW.createChildren=function(){this.graphics=this._bitmap=new ul},uW.createText=function(){this._text||(this._text=new uX,this._text.overflow=uX.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},uW.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},uW.onMouse=function(uW){if(!1!==this.toggle||!this._selected)return"click"===uW.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=ut.stateMap[uW.type]))},uW.changeClips=function(){var uW=uS.getRes(this._skin);if(uW&&this._skin&&""!=this._skin){uS.clearObject(this,this._weakKey);var uj=uW.sourceWidth,ut=uW.sourceHeight/this._stateNum;uW.$_GID||(uW.$_GID=uz.getGID());var ud=uW.$_GID+"-"+this._stateNum,ub=uS.findObject(ud);if(uz.isOkTextureList(ub)||(ub=null),ub)this._weakKey=ud,uS.keepObject(this,this._weakKey),this._sources=ub;else{if(this._sources=[],1===this._stateNum)this._sources.push(uW);else for(var uE=0;uE<this._stateNum;uE++){var uO=u_.createFromTexture(uW,0,ut*uE,uj,ut);if(uW.alphaTexture){var uq=uW.width/uW.alphaTexture.width;uO.alphaTexture=u_.createFromTexture(uW.alphaTexture,0/uq,ut*uE/uq,uj/uq,ut/uq)}this._sources.push(uO)}uS.saveObject(ud,this._sources),this._weakKey=ud,uS.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||uj,this._bitmap.height=this._height||ut,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=uj)}else console.warn("lose skin ",this._skin,this.name,this.__className)},uW.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var uW=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[uW]),this.label&&(this._text.color=this._labelColors[uW],this._strokeColors&&(this._text.strokeColor=this._strokeColors[uW]))},uW._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},ub(0,uW,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(uW){this.createText(),this._text.strokeColor=uW}),ub(0,uW,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),ub(0,uW,"skin",function(){return this._skin},function(uW){this._skin!=uW&&(uS.clearCache(this,this._skin),this._skin=uW,uS.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),ub(0,uW,"state",function(){return this._state},function(uW){this._state!=uW&&(this._state=uW,this._setStateChanged())}),ub(0,uW,"text",function(){return this.createText(),this._text}),ub(0,uW,"stateNum",function(){return this._stateNum},function(uW){"string"==typeof uW&&(uW=parseInt(uW)),this._stateNum!=uW&&(this._stateNum=uW<1?1:3<uW?3:uW,this.callLater(this.changeClips))}),ub(0,uW,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(uW){this._strokeColors=ux.fillArray(uV.buttonLabelColors,uW,String),this._setStateChanged()}),ub(0,uW,"labelColors",function(){return this._labelColors.join(",")},function(uW){this._labelColors=ux.fillArray(uV.buttonLabelColors,uW,String),this._setStateChanged()}),ub(0,uW,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),ub(0,uW,"label",function(){return this._text?this._text.text:null},function(uW){(this._text||uW)&&(this.createText(),this._text.text!=uW&&(uW&&!this._text.parent&&this.addChild(this._text),this._text.text=(uW+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),ub(0,uW,"selected",function(){return this._selected},function(uW){this._selected!=uW&&(this._selected=uW,this.state=this._selected?2:0,this.event("change"))}),ub(0,uW,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(uW){this.createText(),this._text.padding=ux.fillArray(uV.labelPadding,uW,Number)}),ub(0,uW,"labelSize",function(){return this.createText(),this._text.fontSize},function(uW){this.createText(),this._text.fontSize=uW}),ub(0,uW,"labelStroke",function(){return this.createText(),this._text.stroke},function(uW){this.createText(),this._text.stroke=uW}),ub(0,uW,"labelBold",function(){return this.createText(),this._text.bold},function(uW){this.createText(),this._text.bold=uW}),ub(0,uW,"labelFont",function(){return this.createText(),this._text.font},function(uW){this.createText(),this._text.font=uW}),ub(0,uW,"labelAlign",function(){return this.createText(),this._text.align},function(uW){this.createText(),this._text.align=uW}),ub(0,uW,"clickHandler",function(){return this._clickHandler},function(uW){this._clickHandler=uW}),ub(0,uW,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(uW){this._bitmap.sizeGrid=ux.fillArray(uV.defaultSizeGrid,uW,Number)}),ub(0,uW,"width",uj.prototype._$get_width,function(uW){ue.superSet(uh,this,"width",uW),this._autoSize&&(this._bitmap.width=uW,this._text&&(this._text.width=uW))}),ub(0,uW,"height",uj.prototype._$get_height,function(uW){ue.superSet(uh,this,"height",uW),this._autoSize&&(this._bitmap.height=uW,this._text&&(this._text.height=uW))}),ub(0,uW,"dataSource",uj.prototype._$get_dataSource,function(uW){"number"==typeof(this._dataSource=uW)||"string"==typeof uW?this.label=uW+"":ue.superSet(uh,this,"dataSource",uW)}),ub(0,uW,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(uW){this._bitmap._offset=uW?ux.fillArray([1,1],uW,Number):[]}),ud(ut,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),ut}(uh),uu=function(uj){function ud(uW,uj,ut){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,ud.__super.call(this),void 0===uj&&(uj=1),void 0===ut&&(ut=1),this._clipX=uj,this._clipY=ut,this.skin=uW}uE(ud,"laya.ui.Clip",uj);var uW=ud.prototype;return uW.destroy=function(uW){uS.clearCache(this,this._skin),uS.clearObject(this,this._weakKey),void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},uW.dispose=function(){this.destroy(!0),ue.loader.clearRes(this._skin)},uW.createChildren=function(){this.graphics=this._bitmap=new ul},uW._onDisplay=function(uW){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},uW.changeClip=function(){if(this._clipChanged=!1,this._skin){var uW=uS.getRes(this._skin);uW?this.loadComplete(this._skin,uW):ue.loader.load(this._skin,uQ.create(this,this.loadComplete,[this._skin]))}},uW.loadComplete=function(uW,uj){if(uW===this._skin&&uj){uS.clearObject(this,this._weakKey);var ut=this._clipWidth||Math.ceil(uj.sourceWidth/this._clipX),ud=this._clipHeight||Math.ceil(uj.sourceHeight/this._clipY),ub=this._skin+ut+ud,uE=uS.findObject(ub);if(uz.isOkTextureList(uE)||(uE=null),uE)this._weakKey=ub,uS.keepObject(this,this._weakKey),this._sources=uE;else{this._sources=[];for(var uO=0;uO<this._clipY;uO++)for(var uq=0;uq<this._clipX;uq++){var uA=u_.createFromTexture(uj,ut*uq,ud*uO,ut,ud);if(uj.alphaTexture){var uc=uj.width/uj.alphaTexture.width;uA.alphaTexture=u_.createFromTexture(uj.alphaTexture,ut*uq/uc,ud*uO/uc,ut/uc,ud/uc)}this._sources.push(uA)}uS.saveObject(ub,this._sources),this._weakKey=ub,uS.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},uW.play=function(uW,uj){void 0===uW&&(uW=0),void 0===uj&&(uj=-1),this._isPlaying=!0,this.index=uW,this._toIndex=uj,this._index++,ue.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},uW._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},uW.stop=function(){this._isPlaying=!1,ue.timer.clear(this,this._loop),this.event("complete")},uW._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},ub(0,uW,"interval",function(){return this._interval},function(uW){this._interval!=uW&&(this._interval=uW,this._isPlaying&&this.play())}),ub(0,uW,"skin",function(){return this._skin},function(uW){this._skin!=uW&&(uS.clearCache(this,this._skin),(this._skin=uW)?(uS.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),ub(0,uW,"sources",function(){return this._sources},function(uW){this._sources=uW,this.index=this._index,this.event("loaded")}),ub(0,uW,"clipX",function(){return this._clipX},function(uW){this._clipX=uW||1,this._setClipChanged()}),ub(0,uW,"clipY",function(){return this._clipY},function(uW){this._clipY=uW||1,this._setClipChanged()}),ub(0,uW,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),ub(0,uW,"clipWidth",function(){return this._clipWidth},function(uW){this._clipWidth=uW,this._setClipChanged()}),ub(0,uW,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(uW){this._bitmap.sizeGrid=ux.fillArray(uV.defaultSizeGrid,uW,Number)}),ub(0,uW,"group",function(){return this._group},function(uW){uW&&this._skin&&uS.setGroup(this._skin,uW),this._group=uW}),ub(0,uW,"clipHeight",function(){return this._clipHeight},function(uW){this._clipHeight=uW,this._setClipChanged()}),ub(0,uW,"width",uj.prototype._$get_width,function(uW){ue.superSet(uh,this,"width",uW),this._bitmap.width=uW}),ub(0,uW,"height",uj.prototype._$get_height,function(uW){ue.superSet(uh,this,"height",uW),this._bitmap.height=uW}),ub(0,uW,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),ub(0,uW,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),ub(0,uW,"index",function(){return this._index},function(uW){this._index=uW,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[uW]),this.event("change")}),ub(0,uW,"autoPlay",function(){return this._autoPlay},function(uW){this._autoPlay!=uW&&((this._autoPlay=uW)?this.play():this.stop())}),ub(0,uW,"isPlaying",function(){return this._isPlaying},function(uW){this._isPlaying=uW}),ub(0,uW,"dataSource",uj.prototype._$get_dataSource,function(uW){"number"==typeof(this._dataSource=uW)&&Math.floor(uW)==uW||"string"==typeof uW?this.index=parseInt(uW):ue.superSet(uh,this,"dataSource",uW)}),ub(0,uW,"bitmap",function(){return this._bitmap}),ud}(uh),uD=function(uj){function uW(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,uW.__super.call(this)}uE(uW,"laya.ui.ColorPicker",uj);var ut=uW.prototype;return ut.destroy=function(uW){void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,uW),this._colorPanel&&this._colorPanel.destroy(uW),this._colorButton&&this._colorButton.destroy(uW),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},ut.createChildren=function(){this.addChild(this._colorButton=new ua),this._colorPanel=new uy,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new uZ),this._colorPanel.addChild(this._colorBlock=new uZ),this._colorPanel.addChild(this._colorInput=new uT)},ut.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},ut.onPanelMouseDown=function(uW){uW.stopPropagation()},ut.changePanel=function(){this._panelChanged=!1;var uW=this._colorPanel.graphics;uW.clear(),uW.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(uW=this._colorTiles.graphics).clear();for(var uj=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],ut=0;ut<12;ut++)for(var ud=0;ud<20;ud++){var ub=0;ub=0===ud?uj[ut]:1===ud?0:51*(((3*ut+ud/6)%3<<0)+3*(ut/6<<0))<<16|ud%6*51<<8|(ut<<0)%6*51;var uE=ux.toColor(ub);this._colors.push(uE);var uO=ud*this._gridSize,uq=ut*this._gridSize;uW.drawRect(uO,uq,this._gridSize,this._gridSize,uE,"#000000")}},ut.onColorButtonClick=function(uW){this._colorPanel.parent?this.close():this.open()},ut.open=function(){var uW=this.localToGlobal(new u$),uj=uW.x+this._colorPanel.width<=ue.stage.width?uW.x:ue.stage.width-this._colorPanel.width,ut=uW.y+this._colorButton.height;ut=ut+this._colorPanel.height<=ue.stage.height?ut:uW.y-this._colorPanel.height,this._colorPanel.pos(uj,ut),this._colorPanel.zOrder=1001,ue._currentStage.addChild(this._colorPanel),ue.stage.on("mousedown",this,this.removeColorBox)},ut.close=function(){ue.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},ut.removeColorBox=function(uW){this.close()},ut.onColorFieldKeyDown=function(uW){13==uW.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),uW.stopPropagation())},ut.onColorInputChange=function(uW){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},ut.onColorTilesClick=function(uW){this.selectedColor=this.getColorByMouse(),this.close()},ut.onColorTilesMouseMove=function(uW){this._colorInput.focus=!1;var uj=this.getColorByMouse();this._colorInput.text=uj,this.drawBlock(uj)},ut.getColorByMouse=function(){var uW=this._colorTiles.getMousePoint(),uj=Math.floor(uW.x/this._gridSize),ut=Math.floor(uW.y/this._gridSize);return this._colors[20*ut+uj]},ut.drawBlock=function(uW){var uj=this._colorBlock.graphics;uj.clear();var ut=uW||"#ffffff";uj.drawRect(0,0,50,20,ut,this._borderColor),uW||uj.drawLine(0,0,50,20,"#ff0000")},ut.changeColor=function(){var uW=this.graphics;uW.clear();var uj=this._selectedColor||"#000000";uW.drawRect(0,0,this._colorButton.width,this._colorButton.height,uj)},ut._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},ub(0,ut,"inputBgColor",function(){return this._inputBgColor},function(uW){this._inputBgColor=uW,this._setPanelChanged()}),ub(0,ut,"selectedColor",function(){return this._selectedColor},function(uW){this._selectedColor!=uW&&(this._selectedColor=this._colorInput.text=uW,this.drawBlock(uW),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",uA.EMPTY.setTo("change",this,this)))}),ub(0,ut,"skin",function(){return this._colorButton.skin},function(uW){this._colorButton.skin=uW,this.changeColor()}),ub(0,ut,"bgColor",function(){return this._bgColor},function(uW){this._bgColor=uW,this._setPanelChanged()}),ub(0,ut,"borderColor",function(){return this._borderColor},function(uW){this._borderColor=uW,this._setPanelChanged()}),ub(0,ut,"inputColor",function(){return this._inputColor},function(uW){this._inputColor=uW,this._setPanelChanged()}),uW}(uh),us=function(uj){function ut(uW,uj){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,ut.__super.call(this),this._itemColors=uV.comboBoxItemColors,this.skin=uW,this.labels=uj}uE(ut,"laya.ui.ComboBox",uj);var uW=ut.prototype;return uW.destroy=function(uW){void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,uW),this._button&&this._button.destroy(uW),this._list&&this._list.destroy(uW),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},uW.createChildren=function(){this.addChild(this._button=new ua),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},uW._createList=function(){this._list=new uP,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},uW._setListEvent=function(uW){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=uQ.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},uW.onListDown=function(uW){uW.stopPropagation()},uW.onScrollBarDown=function(uW){uW.stopPropagation()},uW.onButtonMouseDown=function(uW){this.callLater(this.switchTo,[!this._isOpen])},uW.changeList=function(){this._listChanged=!1;var uW=this.width-2,uj=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:uW,height:this._itemHeight,fontSize:this._itemSize,color:uj}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},uW.onlistItemMouse=function(uW,uj){var ut=uW.type;if("mouseover"===ut||"mouseout"===ut){if(this._isCustomList)return;var ud=this._list.getCell(uj);if(!ud)return;var ub=ud.getChildByName("label");ub&&("mouseover"===ut?(ub.bgColor=this._itemColors[0],ub.color=this._itemColors[1]):(ub.bgColor=null,ub.color=this._itemColors[2]))}else"click"===ut&&(this.selectedIndex=uj,this.isOpen=!1)},uW.switchTo=function(uW){this.isOpen=uW},uW.changeOpen=function(){this.isOpen=!this._isOpen},uW.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var uW=this._list.graphics;uW.clear(),uW.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var uj=this._list.array||[],ut=uj.length=0,ud=this._labels.length;ut<ud;ut++)uj.push({label:this._labels[ut]});this._list.height=this._listHeight,this._list.array=uj},uW.changeSelected=function(){this._button.label=this.selectedLabel},uW._onStageMouseWheel=function(uW){this._list&&!this._list.contains(uW.target)&&this.removeList(null)},uW.removeList=function(uW){ue.stage.off("mousedown",this,this.removeList),ue.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},ub(0,uW,"selectedIndex",function(){return this._selectedIndex},function(uW){this._selectedIndex!=uW&&(this._selectedIndex=uW,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[uA.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),ub(0,uW,"measureHeight",function(){return this._button.height}),ub(0,uW,"skin",function(){return this._button.skin},function(uW){this._button.skin!=uW&&(this._button.skin=uW,this._listChanged=!0)}),ub(0,uW,"measureWidth",function(){return this._button.width}),ub(0,uW,"width",uj.prototype._$get_width,function(uW){ue.superSet(uh,this,"width",uW),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),ub(0,uW,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(uW){this.selectedIndex=this._labels.indexOf(uW)}),ub(0,uW,"labels",function(){return this._labels.join(",")},function(uW){0<this._labels.length&&(this.selectedIndex=-1),uW?this._labels=uW.split(","):this._labels.length=0,this._itemChanged=!0}),ub(0,uW,"height",uj.prototype._$get_height,function(uW){ue.superSet(uh,this,"height",uW),this._button.height=this._height}),ub(0,uW,"selectHandler",function(){return this._selectHandler},function(uW){this._selectHandler=uW}),ub(0,uW,"visibleNum",function(){return this._visibleNum},function(uW){this._visibleNum=uW,this._listChanged=!0}),ub(0,uW,"labelBold",function(){return this._button.text.bold},function(uW){this._button.text.bold=uW}),ub(0,uW,"itemColors",function(){return String(this._itemColors)},function(uW){this._itemColors=ux.fillArray(this._itemColors,uW,String),this._listChanged=!0}),ub(0,uW,"itemSize",function(){return this._itemSize},function(uW){this._itemSize=uW,this._listChanged=!0}),ub(0,uW,"scrollBar",function(){return this.list.scrollBar}),ub(0,uW,"isOpen",function(){return this._isOpen},function(uW){if(this._isOpen!=uW)if(this._isOpen=uW,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var uj=this.localToGlobal(u$.TEMP.setTo(0,0)),ut=uj.y+this._button.height;ut=ut+this._listHeight<=ue.stage.height?ut:uj.y-this._listHeight,this._list.pos(uj.x,ut),this._list.zOrder=1001,ue._currentStage.addChild(this._list),ue.stage.once("mousedown",this,this.removeList),ue.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),ub(0,uW,"scrollBarSkin",function(){return this._scrollBarSkin},function(uW){this._scrollBarSkin=uW}),ub(0,uW,"sizeGrid",function(){return this._button.sizeGrid},function(uW){this._button.sizeGrid=uW}),ub(0,uW,"button",function(){return this._button}),ub(0,uW,"list",function(){return this._list||this._createList(),this._list},function(uW){uW&&(uW.removeSelf(),this._isCustomList=!0,this._list=uW,this._setListEvent(uW),this._itemHeight=uW.getCell(0).height+uW.spaceY)}),ub(0,uW,"dataSource",uj.prototype._$get_dataSource,function(uW){"number"==typeof(this._dataSource=uW)&&Math.floor(uW)==uW||"string"==typeof uW?this.selectedIndex=parseInt(uW):uW instanceof Array?this.labels=uW.join(","):ue.superSet(uh,this,"dataSource",uW)}),ub(0,uW,"labelColors",function(){return this._button.labelColors},function(uW){this._button.labelColors!=uW&&(this._button.labelColors=uW)}),ub(0,uW,"labelPadding",function(){return this._button.text.padding.join(",")},function(uW){this._button.text.padding=ux.fillArray(uV.labelPadding,uW,Number)}),ub(0,uW,"labelSize",function(){return this._button.text.fontSize},function(uW){this._button.text.fontSize=uW}),ub(0,uW,"labelFont",function(){return this._button.text.font},function(uW){this._button.text.font=uW}),ub(0,uW,"stateNum",function(){return this._button.stateNum},function(uW){this._button.stateNum=uW}),ut}(uh),uY=function(uj){function ut(uW){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,ut.__super.call(this),this._showButtons=uG.showButtons,this._touchScrollEnable=uG.touchScrollEnable,this._mouseWheelEnable=uG.mouseWheelEnable,this.skin=uW,this.max=1}uE(ut,"laya.ui.ScrollBar",uj);var uW=ut.prototype;return uW.destroy=function(uW){void 0===uW&&(uW=!0),this.stopScroll(),this.target=null,uj.prototype.destroy.call(this,uW),this.upButton&&this.upButton.destroy(uW),this.downButton&&this.downButton.destroy(uW),this.slider&&this.slider.destroy(uW),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},uW.createChildren=function(){this.addChild(this.slider=new uH),this.addChild(this.upButton=new ua),this.addChild(this.downButton=new ua)},uW.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},uW.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},uW.onButtonMouseDown=function(uW){var uj=uW.currentTarget===this.upButton;this.slide(uj),ue.timer.once(uV.scrollBarDelayTime,this,this.startLoop,[uj]),ue.stage.once("mouseup",this,this.onStageMouseUp)},uW.startLoop=function(uW){ue.timer.frameLoop(1,this,this.slide,[uW])},uW.slide=function(uW){uW?this.value-=this._scrollSize:this.value+=this._scrollSize},uW.onStageMouseUp=function(uW){ue.timer.clear(this,this.startLoop),ue.timer.clear(this,this.slide)},uW.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},uW.changeSize=function(){uj.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},uW.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},uW.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},uW.setScroll=function(uW,uj,ut){this.runCallLater(this.changeSize),this.slider.setSlider(uW,uj,ut),this.slider.bar.visible=0<uj,!this._hide&&this.autoHide&&(this.visible=!1)},uW.onTargetMouseWheel=function(uW){this.value-=uW.delta*this._scrollSize,this.target=this._target},uW.onTargetMouseDown=function(uW){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new u$),this._lastPoint.setTo(ue.stage.mouseX,ue.stage.mouseY),ue.timer.clear(this,this.tweenMove),uN.clearTween(this),ue.stage.once("mouseup",this,this.onStageMouseUp2),ue.stage.once("mouseout",this,this.onStageMouseUp2),ue.timer.frameLoop(1,this,this.loop)},uW.loop=function(){var uW=ue.stage.mouseY,uj=ue.stage.mouseX;if(this._lastOffset=this.isVertical?uW-this._lastPoint.y:uj-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?ue.stage._canvasTransform.getScaleY():ue.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=uj,this._lastPoint.y=uW,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},uW.onStageMouseUp2=function(uW){if(ue.stage.off("mouseup",this,this.onStageMouseUp2),ue.stage.off("mouseout",this,this.onStageMouseUp2),ue.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?uN.to(this,{value:this.min},this.elasticBackTime,uq.sineOut,uQ.create(this,this.elasticOver)):this._value>this.max&&uN.to(this,{value:this.max},this.elasticBackTime,uq.sineOut,uQ.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?ue.stage.mouseY-this._lastPoint.y:ue.stage.mouseX-this._lastPoint.x);for(var uj=0,ut=Math.min(this._offsets.length,3),ud=0;ud<ut;ud++)uj+=this._offsets[this._offsets.length-1-ud];if(this._lastOffset=uj/ut,(uj=Math.abs(this._lastOffset))<2)return void this.event("end");60<uj&&(this._lastOffset=0<this._lastOffset?60:-60);var ub=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));ue.timer.frameLoop(1,this,this.tweenMove,[ub])}},uW.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&uN.to(this,{alpha:0},500),this.event("end")},uW.tweenMove=function(uW){this._lastOffset*=this.rollRatio;var uj=NaN;if(0<uW&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,uj=.5*-(this.min-uW-this.value),this._lastOffset>uj&&(this._lastOffset=uj)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,uj=.5*-(this.max+uW-this.value),this._lastOffset<uj&&(this._lastOffset=uj))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(ue.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?uN.to(this,{value:this.min},this.elasticBackTime,uq.sineOut,uQ.create(this,this.elasticOver)):this._value>this.max?uN.to(this,{value:this.max},this.elasticBackTime,uq.sineOut,uQ.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&uN.to(this,{alpha:0},500)}},uW.stopScroll=function(){this.onStageMouseUp2(null),ue.timer.clear(this,this.tweenMove),uN.clearTween(this)},ub(0,uW,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),ub(0,uW,"skin",function(){return this._skin},function(uW){this._skin!=uW&&(this._skin=uW,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),ub(0,uW,"max",function(){return this.slider.max},function(uW){this.slider.max=uW}),ub(0,uW,"showButtons",function(){return this._showButtons},function(uW){this._showButtons=uW,this.callLater(this.changeScrollBar)}),ub(0,uW,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),ub(0,uW,"min",function(){return this.slider.min},function(uW){this.slider.min=uW}),ub(0,uW,"value",function(){return this._value},function(uW){uW!==this._value&&(this._value=uW,this._isElastic||(this.slider._value!=uW&&(this.slider._value=uW,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),ub(0,uW,"isVertical",function(){return this.slider.isVertical},function(uW){this.slider.isVertical=uW}),ub(0,uW,"sizeGrid",function(){return this.slider.sizeGrid},function(uW){this.slider.sizeGrid=uW}),ub(0,uW,"scrollSize",function(){return this._scrollSize},function(uW){this._scrollSize=uW}),ub(0,uW,"dataSource",uj.prototype._$get_dataSource,function(uW){"number"==typeof(this._dataSource=uW)||"string"==typeof uW?this.value=Number(uW):ue.superSet(uh,this,"dataSource",uW)}),ub(0,uW,"thumbPercent",function(){return this._thumbPercent},function(uW){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),uW=1<=uW?.99:uW,this._thumbPercent=uW,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*uW,uV.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*uW,uV.scrollBarMinNum))}),ub(0,uW,"target",function(){return this._target},function(uW){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=uW)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),ub(0,uW,"hide",function(){return this._hide},function(uW){this._hide=uW,this.visible=!uW}),ub(0,uW,"touchScrollEnable",function(){return this._touchScrollEnable},function(uW){this._touchScrollEnable=uW,this.target=this._target}),ub(0,uW,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(uW){this._mouseWheelEnable=uW,this.target=this._target}),ub(0,uW,"tick",function(){return this.slider.tick},function(uW){this.slider.tick=uW}),ut}(uh),uH=function(uj){function ut(uW){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,ut.__super.call(this),this.skin=uW}uE(ut,"laya.ui.Slider",uj);var uW=ut.prototype;return uW.destroy=function(uW){void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,uW),this._bg&&this._bg.destroy(uW),this._bar&&this._bar.destroy(uW),this._progress&&this._progress.destroy(uW),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},uW.createChildren=function(){this.addChild(this._bg=new uI),this.addChild(this._bar=new ua)},uW.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},uW.onBarMouseDown=function(uW){this._globalSacle||(this._globalSacle=new u$),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=ue.stage.mouseX,this._ty=ue.stage.mouseY,ue.stage.on("mousemove",this,this.mouseMove),ue.stage.once("mouseup",this,this.mouseUp),ue.stage.once("mouseout",this,this.mouseUp),this.showValueText()},uW.showValueText=function(){if(this.showLabel){var uW=laya.ui.Slider.label;this.addChild(uW),uW.textField.changeText(this._value+""),this.isVertical?(uW.x=this._bar.x+20,uW.y=.5*(this._bar.height-uW.height)+this._bar.y):(uW.y=this._bar.y-20,uW.x=.5*(this._bar.width-uW.width)+this._bar.x)}},uW.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},uW.mouseUp=function(uW){ue.stage.off("mousemove",this,this.mouseMove),ue.stage.off("mouseup",this,this.mouseUp),ue.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},uW.mouseMove=function(uW){var uj=this._value;this.isVertical?(this._bar.y+=(ue.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(ue.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=ue.stage.mouseX,this._ty=ue.stage.mouseY;var ut=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*ut)/ut,this._value!=uj&&this.sendChangeEvent(),this.showValueText()},uW.sendChangeEvent=function(uW){void 0===uW&&(uW="change"),this.event(uW),this.changeHandler&&this.changeHandler.runWith(this._value)},uW.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},uW.changeSize=function(){uj.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},uW.setSlider=function(uW,uj,ut){this._value=-1,this._min=uW,this._max=uW<uj?uj:uW,this.value=ut<uW?uW:uj<ut?uj:ut},uW.changeValue=function(){var uW=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*uW)/uW,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var uj=this._max-this._min;0===uj&&(uj=1),this.isVertical?(this._bar.y=(this._value-this._min)/uj*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/uj*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},uW.onBgMouseDown=function(uW){var uj=this._bg.getMousePoint();this.isVertical?this.value=uj.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=uj.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},ub(0,uW,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),ub(0,uW,"skin",function(){return this._skin},function(uW){if(this._skin!=uW){this._skin=uW,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var uj=this._skin.replace(".png","$progress.png");uS.getRes(uj)&&(this._progress||(this.addChild(this._progress=new uI),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=uj),this.setBarPoint(),this.callLater(this.changeValue)}}),ub(0,uW,"allowClickBack",function(){return this._allowClickBack},function(uW){this._allowClickBack!=uW&&((this._allowClickBack=uW)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),ub(0,uW,"max",function(){return this._max},function(uW){this._max!=uW&&(this._max=uW,this.callLater(this.changeValue))}),ub(0,uW,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),ub(0,uW,"tick",function(){return this._tick},function(uW){this._tick!=uW&&(this._tick=uW,this.callLater(this.changeValue))}),ub(0,uW,"sizeGrid",function(){return this._bg.sizeGrid},function(uW){this._bg.sizeGrid=uW,this._bar.sizeGrid=uW,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),ub(0,uW,"min",function(){return this._min},function(uW){this._min!=uW&&(this._min=uW,this.callLater(this.changeValue))}),ub(0,uW,"value",function(){return this._value},function(uW){if(this._value!=uW){var uj=this._value;this._value=uW,this.changeValue(),this._value!=uj&&this.sendChangeEvent()}}),ub(0,uW,"dataSource",uj.prototype._$get_dataSource,function(uW){"number"==typeof(this._dataSource=uW)||"string"==typeof uW?this.value=Number(uW):ue.superSet(uh,this,"dataSource",uW)}),ub(0,uW,"bar",function(){return this._bar}),ud(ut,["label",function(){return this.label=new ug}]),ut}(uh),uI=function(uj){function ut(uW){this._bitmap=null,this._skin=null,this._group=null,ut.__super.call(this),this.skin=uW}uE(ut,"laya.ui.Image",uj);var uW=ut.prototype;return uW.destroy=function(uW){void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,uS.clearCache(this,this._skin)},uW.dispose=function(){this.destroy(!0),uS.clearCache(this,this._skin)},uW.createChildren=function(){this.graphics=this._bitmap=new ul},uW.setSource=function(uW,uj){uW===this._skin&&uj&&(this.source=uj,this.onCompResize())},ub(0,uW,"source",function(){return this._bitmap.source},function(uW){this._bitmap&&(this._bitmap.source=uW,this.event("loaded"),this.repaint())}),ub(0,uW,"dataSource",uj.prototype._$get_dataSource,function(uW){"string"==typeof(this._dataSource=uW)?this.skin=uW:ue.superSet(uh,this,"dataSource",uW)}),ub(0,uW,"measureHeight",function(){return this._bitmap.height}),ub(0,uW,"skin",function(){return this._skin},function(uW){if(this._skin!=uW)if(uS.clearCache(this,this._skin),this._skin=uW){uS.keepCache(this,this._skin);var uj=uS.getRes(uW);uj?(this.source=uj,this.onCompResize()):ue.loader.load(this._skin,uQ.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),ub(0,uW,"group",function(){return this._group},function(uW){uW&&this._skin&&uS.setGroup(this._skin,uW),this._group=uW}),ub(0,uW,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(uW){this._bitmap.sizeGrid=ux.fillArray(uV.defaultSizeGrid,uW,Number)}),ub(0,uW,"measureWidth",function(){return this._bitmap.width}),ub(0,uW,"width",uj.prototype._$get_width,function(uW){ue.superSet(uh,this,"width",uW),this._bitmap.width=0==uW?1e-7:uW}),ub(0,uW,"height",uj.prototype._$get_height,function(uW){ue.superSet(uh,this,"height",uW),this._bitmap.height=0==uW?1e-7:uW}),ut}(uh),ug=function(uj){function ut(uW){this._tf=null,ut.__super.call(this),void 0===uW&&(uW=""),uc.defaultColor=uV.labelColor,this.text=uW}uE(ut,"laya.ui.Label",uj);var uW=ut.prototype;return uW.destroy=function(uW){void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,uW),this._tf=null},uW.createChildren=function(){this.addChild(this._tf=new uX)},uW.changeText=function(uW){this._tf.changeText(uW)},ub(0,uW,"padding",function(){return this._tf.padding.join(",")},function(uW){this._tf.padding=ux.fillArray(uV.labelPadding,uW,Number)}),ub(0,uW,"bold",function(){return this._tf.bold},function(uW){this._tf.bold=uW}),ub(0,uW,"align",function(){return this._tf.align},function(uW){this._tf.align=uW}),ub(0,uW,"text",function(){return this._tf.text},function(uW){this._tf.text!=uW&&(uW&&(uW=ux.adptString(uW+"")),this._tf.text=uW,this.event("change"),this._width&&this._height||this.onCompResize())}),ub(0,uW,"italic",function(){return this._tf.italic},function(uW){this._tf.italic=uW}),ub(0,uW,"wordWrap",function(){return this._tf.wordWrap},function(uW){this._tf.wordWrap=uW}),ub(0,uW,"font",function(){return this._tf.font},function(uW){this._tf.font=uW}),ub(0,uW,"dataSource",uj.prototype._$get_dataSource,function(uW){"number"==typeof(this._dataSource=uW)||"string"==typeof uW?this.text=uW+"":ue.superSet(uh,this,"dataSource",uW)}),ub(0,uW,"color",function(){return this._tf.color},function(uW){this._tf.color=uW}),ub(0,uW,"valign",function(){return this._tf.valign},function(uW){this._tf.valign=uW}),ub(0,uW,"leading",function(){return this._tf.leading},function(uW){this._tf.leading=uW}),ub(0,uW,"fontSize",function(){return this._tf.fontSize},function(uW){this._tf.fontSize=uW}),ub(0,uW,"bgColor",function(){return this._tf.bgColor},function(uW){this._tf.bgColor=uW}),ub(0,uW,"borderColor",function(){return this._tf.borderColor},function(uW){this._tf.borderColor=uW}),ub(0,uW,"stroke",function(){return this._tf.stroke},function(uW){this._tf.stroke=uW}),ub(0,uW,"strokeColor",function(){return this._tf.strokeColor},function(uW){this._tf.strokeColor=uW}),ub(0,uW,"textField",function(){return this._tf}),ub(0,uW,"measureWidth",function(){return this._tf.width}),ub(0,uW,"measureHeight",function(){return this._tf.height}),ub(0,uW,"width",function(){return this._width||this._tf.text?ue.superGet(uh,this,"width"):0},function(uW){ue.superSet(uh,this,"width",uW),this._tf.width=uW}),ub(0,uW,"height",function(){return this._height||this._tf.text?ue.superGet(uh,this,"height"):0},function(uW){ue.superSet(uh,this,"height",uW),this._tf.height=uW}),ub(0,uW,"overflow",function(){return this._tf.overflow},function(uW){this._tf.overflow=uW}),ub(0,uW,"underline",function(){return this._tf.underline},function(uW){this._tf.underline=uW}),ub(0,uW,"underlineColor",function(){return this._tf.underlineColor},function(uW){this._tf.underlineColor=uW}),ut}(uh),uf=function(uj){function ut(uW){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,ut.__super.call(this),this.skin=uW}uE(ut,"laya.ui.ProgressBar",uj);var uW=ut.prototype;return uW.destroy=function(uW){void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,uW),this._bg&&this._bg.destroy(uW),this._bar&&this._bar.destroy(uW),this._bg=this._bar=null,this.changeHandler=null},uW.createChildren=function(){this.addChild(this._bg=new uI),this.addChild(this._bar=new uI)},uW.changeValue=function(){if(this.sizeGrid){var uW=this.sizeGrid.split(","),uj=Number(uW[3]),ut=Number(uW[1]),ud=(this.width-uj-ut)*this._value;this._bar.width=uj+ut+ud,this._bar.visible=this._bar.width>uj+ut}else this._bar.width=this.width*this._value},ub(0,uW,"measureHeight",function(){return this._bg.height}),ub(0,uW,"skin",function(){return this._skin},function(uW){this._skin!=uW&&(this._skin=uW,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),ub(0,uW,"measureWidth",function(){return this._bg.width}),ub(0,uW,"height",uj.prototype._$get_height,function(uW){ue.superSet(uh,this,"height",uW),this._bg.height=this._height,this._bar.height=this._height}),ub(0,uW,"bar",function(){return this._bar}),ub(0,uW,"value",function(){return this._value},function(uW){this._value!=uW&&(uW=1<uW?1:uW<0?0:uW,this._value=uW,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(uW))}),ub(0,uW,"bg",function(){return this._bg}),ub(0,uW,"sizeGrid",function(){return this._bg.sizeGrid},function(uW){this._bg.sizeGrid=this._bar.sizeGrid=uW}),ub(0,uW,"width",uj.prototype._$get_width,function(uW){ue.superSet(uh,this,"width",uW),this._bg.width=this._width,this.callLater(this.changeValue)}),ub(0,uW,"dataSource",uj.prototype._$get_dataSource,function(uW){"number"==typeof(this._dataSource=uW)||"string"==typeof uW?this.value=Number(uW):ue.superSet(uh,this,"dataSource",uW)}),ut}(uh),uw=(function(uW){function ut(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,ut.__super.call(this),this._tipBox=new uh,this._tipBox.addChild(this._tipText=new uX),this._tipText.x=this._tipText.y=5,this._tipText.color=ut.tipTextColor,this._defaultTipHandler=this._showDefaultTip,ue.stage.on("showtip",this,this._onStageShowTip),ue.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}uE(ut,"laya.ui.TipManager",uh);var uj=ut.prototype;uj._onStageHideTip=function(uW){ue.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},uj._onStageShowTip=function(uW){ue.timer.once(ut.tipDelay,this,this._showTip,[uW],!0)},uj._showTip=function(uW){if("string"==typeof uW){var uj=String(uW);Boolean(uj)&&this._defaultTipHandler(uj)}else uW instanceof laya.utils.Handler?uW.run():"function"==typeof uW&&uW.apply();ue.stage.on("mousemove",this,this._onStageMouseMove),ue.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},uj._onStageMouseDown=function(uW){this.closeAll()},uj._onStageMouseMove=function(uW){this._showToStage(this,ut.offsetX,ut.offsetY)},uj._showToStage=function(uW,uj,ut){void 0===uj&&(uj=0),void 0===ut&&(ut=0);var ud=uW.getBounds();uW.x=ue.stage.mouseX+uj,uW.y=ue.stage.mouseY+ut,uW.x+ud.width>ue.stage.width&&(uW.x-=ud.width+uj),uW.y+ud.height>ue.stage.height&&(uW.y-=ud.height+ut)},uj.closeAll=function(){ue.timer.clear(this,this._showTip),ue.stage.off("mousemove",this,this._onStageMouseMove),ue.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},uj.showDislayTip=function(uW){this.addChild(uW),this._showToStage(this),ue._currentStage.addChild(this)},uj._showDefaultTip=function(uW){this._tipText.text=uW;var uj=this._tipBox.graphics;uj.clear(),uj.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,ut.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),ue._currentStage.addChild(this)},ub(0,uj,"defaultTipHandler",function(){return this._defaultTipHandler},function(uW){this._defaultTipHandler=uW}),ut.offsetX=10,ut.offsetY=15,ut.tipTextColor="#ffffff",ut.tipBackColor="#111111",ut.tipDelay=200}(),function(uW){var uT;function u$(){this._idMap=null,this._aniList=null,this._watchMap={},u$.__super.call(this)}uE(u$,"laya.ui.View",uy);var uj=u$.prototype;return uj.createView=function(uW){if(uW.animations&&!this._idMap&&(this._idMap={}),u$.createComp(uW,this,this),uW.animations){var uj,ut,ud=[],ub=uW.animations,uE=0,uO=ub.length;for(uE=0;uE<uO;uE++){switch(uj=new uR,ut=ub[uE],uj._setUp(this._idMap,ut),(this[ut.name]=uj)._setControlNode(this),ut.action){case 1:uj.play(0,!1);break;case 2:uj.play(0,!0)}ud.push(uj)}this._aniList=ud}0<this._width&&null==uW.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},uj.onEvent=function(uW,uj){},uj.loadUI=function(uW){var uj=u$.uiMap[uW];uj&&this.createView(uj)},uj.destroy=function(uW){void 0===uW&&(uW=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,uW)},uj.changeData=function(uW){var uj=this._watchMap[uW];if(uj){console.log("change",uW);for(var ut=0,ud=uj.length;ut<ud;ut++){uj[ut].exe(this)}}},u$._regs=function(){for(var uW in u$.uiClassMap)uK.regClass(uW,u$.uiClassMap[uW])},u$.createComp=function(uW,uj,ut,ud){if(!(uj=uj||u$.getCompInstance(uW)))return console.warn("can not create:"+uW.type),null;var ub=uW.child;if(ub)for(var uE=uj instanceof laya.ui.List,uO=0,uq=ub.length;uO<uq;uO++){var uA=ub[uO];if(!uj.hasOwnProperty("itemRender")||"render"!=uA.props.name&&"render"!==uA.props.renderType)if("Graphic"==uA.type)uK.addGraphicsToSprite(uA,uj);else if(uK.isDrawType(uA.type))uK.addGraphicToSprite(uA,uj,!0);else{if(uE){var uc=[],uR=u$.createComp(uA,null,ut,uc);uc.length&&(uR._$bindData=uc)}else uR=u$.createComp(uA,null,ut,ud);"Script"==uA.type?"owner"in uR?uR.owner=uj:"target"in uR&&(uR.target=uj):"mask"==uA.props.renderType||"mask"==uA.props.name?uj.mask=uR:uR instanceof laya.display.Sprite&&uj.addChild(uR)}else uj.itemRender=uA}var um=uW.props;for(var uQ in um){var uT=um[uQ];u$.eventDic[uQ]?uT&&ut&&uj.on(uQ,ut,ut.onEvent,[uT]):u$.setCompValue(uj,uQ,uT,ut,ud)}return ue.__typeof(uj,"laya.ui.IItem")&&uj.initItems(),uW.compId&&ut&&ut._idMap&&(ut._idMap[uW.compId]=uj),uj},u$.setCompValue=function(uW,uj,ut,ud,ub){if("string"==typeof ut&&-1<ut.indexOf("${")){if(u$._sheet||(u$._sheet=uK.getClass("laya.data.Table")),!u$._sheet)return void console.warn("Can not find class Sheet");if(ub)ub.push(uW,uj,ut);else if(ud){-1==ut.indexOf("].")&&(ut=ut.replace(".","[0]."));var uE,uO,uq=new uT(uW,uj,ut);uq.exe(ud);for(var uA=ut.replace(/\[.*?\]\./g,".");null!=(uE=u$._parseWatchData.exec(uA));){for(var uc=uE[1];null!=(uO=u$._parseKeyWord.exec(uc));){var uR=uO[0],um=ud._watchMap[uR]||(ud._watchMap[uR]=[]);um.push(uq),u$._sheet.I.notifer.on(uR,ud,ud.changeData,[uR])}(um=ud._watchMap[uc]||(ud._watchMap[uc]=[])).push(uq),u$._sheet.I.notifer.on(uc,ud,ud.changeData,[uc])}}}else if("var"===uj&&ud)ud[ut]=uW;else if("onClick"==uj){var uQ=ue._runScript("(function(){"+ut+"})");uW.on("click",ud,uQ)}else uW[uj]="true"===ut||"false"!==ut&&ut},u$.getCompInstance=function(uW){var uj,ut=uW.props?uW.props.runtime:null;return uj=ut?u$.viewClassMap[ut]||u$.uiClassMap[ut]||ue.__classmap[ut]:u$.uiClassMap[uW.type],uW.props&&uW.props.hasOwnProperty("renderType")&&"instance"==uW.props.renderType?uj.instance:uj?new uj:null},u$.regComponent=function(uW,uj){u$.uiClassMap[uW]=uj,uK.regClass(uW,uj)},u$.regViewRuntime=function(uW,uj){u$.viewClassMap[uW]=uj},u$.uiMap={},u$.viewClassMap={},u$._sheet=null,ud(u$,["uiClassMap",function(){return this.uiClassMap={ViewStack:uWW,LinkButton:ua,TextArea:ucW,ColorPicker:uD,Box:uy,Button:ua,CheckBox:uU,Clip:uu,ComboBox:us,Component:uh,HScrollBar:ui,HSlider:un,Image:uI,Label:ug,List:uP,Panel:uB,ProgressBar:uf,Radio:up,RadioGroup:uqW,ScrollBar:uY,Slider:uH,Tab:uAW,TextInput:utW,View:u$,VScrollBar:ujW,VSlider:udW,Tree:uF,HBox:uEW,VBox:uOW,Sprite:uZ,Animation:ut,Text:uX,FontClip:ur}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),u$.__init$=function(){u$._regs(),uT=function(){function uW(uW,uj,ut){this.comp=null,this.prop=null,this.value=null,this.comp=uW,this.prop=uj,this.value=ut}return uE(uW,""),uW.prototype.exe=function(uW){var uj=ux.getBindFun(this.value);this.comp[this.prop]=uj.call(this,uW)},uW}()},u$}()),uU=function(uW){function ut(uW,uj){void 0===uj&&(uj=""),ut.__super.call(this,uW,uj)}uE(ut,"laya.ui.CheckBox",uW);var uj=ut.prototype;return uj.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},uj.initialize=function(){uW.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},ub(0,uj,"dataSource",uW.prototype._$get_dataSource,function(uW){"boolean"==typeof(this._dataSource=uW)?this.selected=uW:"string"==typeof uW?this.selected="true"===uW:ue.superSet(ua,this,"dataSource",uW)}),ut}(ua),uJ=function(uW){function uj(){this._space=0,this._align="none",this._itemChanged=!1,uj.__super.call(this)}uE(uj,"laya.ui.LayoutBox",uy);var ut=uj.prototype;return ut.addChild=function(uW){return uW.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,uW)},ut.onResize=function(uW){this._setItemChanged()},ut.addChildAt=function(uW,uj){return uW.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,uW,uj)},ut.removeChild=function(uW){return uW.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,uW)},ut.removeChildAt=function(uW){return this.getChildAt(uW).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,uW)},ut.refresh=function(){this._setItemChanged()},ut.changeItems=function(){this._itemChanged=!1},ut.sortItem=function(uW){uW&&uW.sort(function(uW,uj){return uW.y-uj.y})},ut._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},ub(0,ut,"space",function(){return this._space},function(uW){this._space=uW,this._setItemChanged()}),ub(0,ut,"align",function(){return this._align},function(uW){this._align=uW,this._setItemChanged()}),uj}(),ur=function(uj){function ut(uW,uj){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,ut.__super.call(this),uW&&(this.skin=uW),uj&&(this.sheet=uj)}uE(ut,"laya.ui.FontClip",uj);var uW=ut.prototype;return uW.createChildren=function(){this._bitmap=new ul,this.on("loaded",this,this._onClipLoaded)},uW._onClipLoaded=function(){this.callLater(this.changeValue)},uW.changeValue=function(){var uW;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),uW=this._sources[0]))){var uj="horizontal"===this._direction;uj?(this._wordsW=this._valueArr.length*(uW.sourceWidth+this.spaceX),this._wordsH=uW.sourceHeight):(this._wordsW=uW.sourceWidth,this._wordsH=(uW.sourceHeight+this.spaceY)*this._valueArr.length);var ut=0;if(this._width)switch(this._align){case"center":ut=.5*(this._width-this._wordsW);break;case"right":ut=this._width-this._wordsW;break;default:ut=0}for(var ud=0,ub=this._valueArr.length;ud<ub;ud++){var uE=this._indexMap[this._valueArr.charAt(ud)];this.sources[uE]&&(uW=this.sources[uE],uj?this.graphics.drawTexture(uW,ut+ud*(uW.sourceWidth+this.spaceX),0,uW.sourceWidth,uW.sourceHeight):this.graphics.drawTexture(uW,0+ut,ud*(uW.sourceHeight+this.spaceY),uW.sourceWidth,uW.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},uW.destroy=function(uW){void 0===uW&&(uW=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),uj.prototype.destroy.call(this,uW)},ub(0,uW,"sheet",function(){return this._sheet},function(uW){uW+="";var uj=(this._sheet=uW).split(" ");this._clipX=String(uj[0]).length,this.clipY=uj.length,this._indexMap={};for(var ut=0;ut<this._clipY;ut++)for(var ud=uj[ut].split(""),ub=0,uE=ud.length;ub<uE;ub++)this._indexMap[ud[ub]]=ut*this._clipX+ub}),ub(0,uW,"height",uj.prototype._$get_height,function(uW){ue.superSet(uu,this,"height",uW),this.callLater(this.changeValue)}),ub(0,uW,"direction",function(){return this._direction},function(uW){this._direction=uW,this.callLater(this.changeValue)}),ub(0,uW,"value",function(){return this._valueArr?this._valueArr:""},function(uW){uW+="",this._valueArr=uW,this.callLater(this.changeValue)}),ub(0,uW,"width",uj.prototype._$get_width,function(uW){ue.superSet(uu,this,"width",uW),this.callLater(this.changeValue)}),ub(0,uW,"spaceX",function(){return this._spaceX},function(uW){this._spaceX=uW,"horizontal"===this._direction&&this.callLater(this.changeValue)}),ub(0,uW,"spaceY",function(){return this._spaceY},function(uW){this._spaceY=uW,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),ub(0,uW,"align",function(){return this._align},function(uW){this._align=uW,this.callLater(this.changeValue)}),ub(0,uW,"measureWidth",function(){return this._wordsW}),ub(0,uW,"measureHeight",function(){return this._wordsH}),ut}(uu),uP=function(uW){function uj(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new u$,uj.__super.call(this)}uE(uj,"laya.ui.List",uW);var ut=uj.prototype;return ue.imps(ut,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),ut.destroy=function(uW){void 0===uW&&(uW=!0),this._content&&this._content.destroy(uW),this._scrollBar&&this._scrollBar.destroy(uW),laya.ui.Component.prototype.destroy.call(this,uW),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},ut.createChildren=function(){this.addChild(this._content=new uy)},ut.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=ue.superGet(uy,this,"cacheAs")),ue.superSet(uy,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},ut.onScrollEnd=function(){ue.superSet(uy,this,"cacheAs",this._$P.cacheAs)},ut._removePreScrollBar=function(){var uW=this.removeChildByName("scrollBar");uW&&uW.destroy(!0)},ut.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var uW=this._getOneCell(),uj=uW.width+this._spaceX||1,ut=uW.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/uj):Math.ceil(this._width/uj)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/ut):Math.round(this._height/ut));var ud=this._width?this._width:uj*this.repeatX-this._spaceX,ub=this._height?this._height:ut*this.repeatY-this._spaceY;this._cellSize=this._isVertical?ut:uj,this._cellOffset=this._isVertical?ut*Math.max(this._repeatY2,this._repeatY)-ub-this._spaceY:uj*Math.max(this._repeatX2,this._repeatX)-ud-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=ub:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=ud),this.setContentSize(ud,ub);var uE=this._isVertical?this.repeatX:this.repeatY,uO=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,uE,uO),this._createdLine=uO,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},ut._getOneCell=function(){if(0===this._cells.length){var uW=this.createItem();if(this._offset.setTo(uW.x,uW.y),this.cacheContent)return uW;this._cells.push(uW)}return this._cells[0]},ut._createItems=function(uW,uj,ut){var ud=this._content,ub=this._getOneCell(),uE=ub.width+this._spaceX,uO=ub.height+this._spaceY;if(this.cacheContent){var uq=new uy;uq.cacheAsBitmap=!0,uq.pos((this._isVertical?0:uW)*uE,(this._isVertical?uW:0)*uO),this._content.addChild(uq),this._content.optimizeScrollRect=!0,ud=uq}else{for(var uA=[],uc=this._cells.length-1;-1<uc;uc--){var uR=this._cells[uc];uR.removeSelf(),uA.push(uR)}this._cells.length=0}for(var um=uW;um<ut;um++)for(var uQ=0;uQ<uj;uQ++)(ub=uA&&uA.length?uA.pop():this.createItem()).x=(this._isVertical?uQ:um)*uE-ud.x,ub.y=(this._isVertical?um:uQ)*uO-ud.y,ub.name="item"+(um*uj+uQ),ud.addChild(ub),this.addCell(ub)},ut.createItem=function(){var uW=[];if("function"==typeof this._itemRender)var uj=new this._itemRender;else uj=uw.createComp(this._itemRender,null,null,uW);if(0==uW.length&&uj._watchMap){var ut=uj._watchMap;for(var ud in ut)for(var ub=ut[ud],uE=0;uE<ub.length;uE++){var uO=ub[uE];uW.push(uO.comp,uO.prop,uO.value)}}return uW.length&&(uj._$bindData=uW),uj},ut.addCell=function(uW){uW.on("click",this,this.onCellMouse),uW.on("rightclick",this,this.onCellMouse),uW.on("mouseover",this,this.onCellMouse),uW.on("mouseout",this,this.onCellMouse),uW.on("mousedown",this,this.onCellMouse),uW.on("mouseup",this,this.onCellMouse),this._cells.push(uW)},ut.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var uW=0,uj=uW=0;uj<1e4;uj++){var ut=this.getChildByName("item"+uj);if(!ut)break;this.addCell(ut),uW++}this.repeatY=uW}},ut.setContentSize=function(uW,uj){this._content.width=uW,this._content.height=uj,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new uo),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,uW,uj),this._content.scrollRect=this._content.scrollRect),this.event("resize")},ut.onCellMouse=function(uW){"mousedown"===uW.type&&(this._isMoved=!1);var uj=uW.currentTarget,ut=this._startIndex+this._cells.indexOf(uj);ut<0||("click"===uW.type||"rightclick"===uW.type?this.selectEnable&&!this._isMoved?this.selectedIndex=ut:this.changeCellState(uj,!0,0):"mouseover"!==uW.type&&"mouseout"!==uW.type||this._selectedIndex===ut||this.changeCellState(uj,"mouseover"===uW.type,0),this.mouseHandler&&this.mouseHandler.runWith([uW,ut]))},ut.changeCellState=function(uW,uj,ut){var ud=uW.getChildByName("selectBox");ud&&(this.selectEnable=!0,ud.visible=uj,ud.index=ut)},ut.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},ut.onScrollBarChange=function(uW){this.runCallLater(this.changeCells);var uj=this._scrollBar.value,ut=this._isVertical?this.repeatX:this.repeatY,ud=this._isVertical?this.repeatY:this.repeatX,ub=Math.floor(uj/this._cellSize);if(this.cacheContent)uO=ud+1,this._createdLine-ub<uO&&(this._createItems(this._createdLine,ut,this._createdLine+uO),this.renderItems(this._createdLine*ut,0),this._createdLine+=uO);else{var uE=ub*ut,uO=0;if(uE>this._startIndex){uO=uE-this._startIndex;var uq=!0,uA=this._startIndex+ut*(ud+1);this._isMoved=!0}else uE<this._startIndex&&(uO=this._startIndex-uE,uq=!1,uA=this._startIndex-1,this._isMoved=!0);for(var uc=0;uc<uO;uc++){if(uq){var uR=this._cells.shift();this._cells[this._cells.length]=uR;var um=uA+uc}else uR=this._cells.pop(),this._cells.unshift(uR),um=uA-uc;var uQ=Math.floor(um/ut)*this._cellSize;this._isVertical?uR.y=uQ:uR.x=uQ,this.renderItem(uR,um)}this._startIndex=uE,this.changeSelectStatus()}var uT=this._content.scrollRect;this._isVertical?(uT.y=uj-this._offset.y,uT.x=-this._offset.x):(uT.y=-this._offset.y,uT.x=uj-this._offset.x),this._content.scrollRect=uT},ut.posCell=function(uW,uj){if(this._scrollBar){var ut=this._isVertical?this.repeatX:this.repeatY,ud=(this._isVertical?this.repeatY:this.repeatX,Math.floor(uj/ut)*this._cellSize);this._isVertical?uW.y=ud:uW.x=ud}},ut.changeSelectStatus=function(){for(var uW=0,uj=this._cells.length;uW<uj;uW++)this.changeCellState(this._cells[uW],this._selectedIndex===this._startIndex+uW,1)},ut.renderItems=function(uW,uj){void 0===uW&&(uW=0),void 0===uj&&(uj=0);for(var ut=uW,ud=uj||this._cells.length;ut<ud;ut++)this.renderItem(this._cells[ut],this._startIndex+ut);this.changeSelectStatus()},ut.renderItem=function(uW,uj){this._array&&0<=uj&&uj<this._array.length?(uW.visible=!0,uW._$bindData?(uW._dataSource=this._array[uj],this._bindData(uW,this._array[uj])):uW.dataSource=this._array[uj],this.cacheContent||this.posCell(uW,uj),this.hasListener("render")&&this.event("render",[uW,uj]),this.renderHandler&&this.renderHandler.runWith([uW,uj])):(uW.visible=!1,uW.dataSource=null)},ut._bindData=function(uW,uj){for(var ut=uW._$bindData,ud=0,ub=ut.length;ud<ub;ud++){var uE=ut[ud++],uO=ut[ud++],uq=ut[ud],uA=ux.getBindFun(uq);uE[uO]=uA.call(this,uj)}},ut.refresh=function(){this.array=this._array},ut.getItem=function(uW){return-1<uW&&uW<this._array.length?this._array[uW]:null},ut.changeItem=function(uW,uj){-1<uW&&uW<this._array.length&&(this._array[uW]=uj,uW>=this._startIndex&&uW<this._startIndex+this._cells.length&&this.renderItem(this.getCell(uW),uW))},ut.setItem=function(uW,uj){this.changeItem(uW,uj)},ut.addItem=function(uW){this._array.push(uW),this.array=this._array},ut.addItemAt=function(uW,uj){this._array.splice(uj,0,uW),this.array=this._array},ut.deleteItem=function(uW){this._array.splice(uW,1),this.array=this._array},ut.getCell=function(uW){return this.runCallLater(this.changeCells),-1<uW&&this._cells?this._cells[(uW-this._startIndex)%this._cells.length]:null},ut.scrollTo=function(uW){if(this._scrollBar){var uj=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(uW/uj)*this._cellSize}else this.startIndex=uW},ut.tweenTo=function(uW,uj,ut){if(void 0===uj&&(uj=200),this._scrollBar){var ud=this._isVertical?this.repeatX:this.repeatY;uN.to(this._scrollBar,{value:Math.floor(uW/ud)*this._cellSize},uj,null,ut,0,!0)}else this.startIndex=uW,ut&&ut.run()},ut._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},ut.commitMeasure=function(){this.runCallLater(this.changeCells)},ub(0,ut,"cacheAs",uW.prototype._$get_cacheAs,function(uW){ue.superSet(uy,this,"cacheAs",uW),this._scrollBar&&(this._$P.cacheAs=null,"none"!==uW?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),ub(0,ut,"content",function(){return this._content}),ub(0,ut,"height",uW.prototype._$get_height,function(uW){uW!=this._height&&(ue.superSet(uy,this,"height",uW),this._setCellChanged())}),ub(0,ut,"itemRender",function(){return this._itemRender},function(uW){if(this._itemRender!=uW){this._itemRender=uW;for(var uj=this._cells.length-1;-1<uj;uj--)this._cells[uj].destroy();this._cells.length=0,this._setCellChanged()}}),ub(0,ut,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(uW){this._removePreScrollBar();var uj=new ujW;uj.name="scrollBar",uj.right=0,uW&&" "!=uW&&(uj.skin=uW),this.scrollBar=uj,this.addChild(uj),this._setCellChanged()}),ub(0,ut,"page",function(){return this._page},function(uW){this._page=uW,this._array&&(this._page=0<uW?uW:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),ub(0,ut,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(uW){this._removePreScrollBar();var uj=new ui;uj.name="scrollBar",uj.bottom=0,uW&&" "!=uW&&(uj.skin=uW),this.scrollBar=uj,this.addChild(uj),this._setCellChanged()}),ub(0,ut,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(uW){this._repeatX=uW,this._setCellChanged()}),ub(0,ut,"scrollBar",function(){return this._scrollBar},function(uW){this._scrollBar!=uW&&(this._scrollBar=uW)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),ub(0,ut,"width",uW.prototype._$get_width,function(uW){uW!=this._width&&(ue.superSet(uy,this,"width",uW),this._setCellChanged())}),ub(0,ut,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(uW){this._repeatY=uW,this._setCellChanged()}),ub(0,ut,"spaceX",function(){return this._spaceX},function(uW){this._spaceX=uW,this._setCellChanged()}),ub(0,ut,"spaceY",function(){return this._spaceY},function(uW){this._spaceY=uW,this._setCellChanged()}),ub(0,ut,"selectedIndex",function(){return this._selectedIndex},function(uW){this._selectedIndex!=uW&&(this._selectedIndex=uW,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(uW),this.startIndex=this._startIndex)}),ub(0,ut,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(uW){this.selectedIndex=this._array.indexOf(uW)}),ub(0,ut,"length",function(){return this._array?this._array.length:0}),ub(0,ut,"selection",function(){return this.getCell(this._selectedIndex)},function(uW){this.selectedIndex=this._startIndex+this._cells.indexOf(uW)}),ub(0,ut,"startIndex",function(){return this._startIndex},function(uW){this._startIndex=0<uW?uW:0,this.callLater(this.renderItems)}),ub(0,ut,"array",function(){return this._array},function(uW){this.runCallLater(this.changeCells),this._array=uW||[];var uj=this._array.length;if(this.totalPage=Math.ceil(uj/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<uj?this._selectedIndex:uj-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var ut=this._isVertical?this.repeatX:this.repeatY,ud=this._isVertical?this.repeatY:this.repeatX,ub=Math.ceil(uj/ut);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=ud/ub,this._scrollBar.setScroll(0,(ub-ud)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),ub(0,ut,"dataSource",uW.prototype._$get_dataSource,function(uW){"number"==typeof(this._dataSource=uW)&&Math.floor(uW)==uW||"string"==typeof uW?this.selectedIndex=parseInt(uW):uW instanceof Array?this.array=uW:ue.superSet(uy,this,"dataSource",uW)}),ub(0,ut,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),uj}(uy),ui=function(uW){function uj(){uj.__super.call(this)}return uE(uj,"laya.ui.HScrollBar",uW),uj.prototype.initialize=function(){uW.prototype.initialize.call(this),this.slider.isVertical=!1},uj}(uY),uB=function(uW){function uj(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,uj.__super.call(this),this.width=this.height=100}uE(uj,"laya.ui.Panel",uW);var ut=uj.prototype;return ut.destroy=function(uW){void 0===uW&&(uW=!0),laya.ui.Component.prototype.destroy.call(this,uW),this._content&&this._content.destroy(uW),this._vScrollBar&&this._vScrollBar.destroy(uW),this._hScrollBar&&this._hScrollBar.destroy(uW),this._vScrollBar=null,this._hScrollBar=null,this._content=null},ut.destroyChildren=function(){this._content.destroyChildren()},ut.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new uy)},ut.addChild=function(uW){return uW.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(uW)},ut.onResize=function(){this._setScrollChanged()},ut.addChildAt=function(uW,uj){return uW.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(uW,uj)},ut.removeChild=function(uW){return uW.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(uW)},ut.removeChildAt=function(uW){return this.getChildAt(uW).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(uW)},ut.removeChildren=function(uW,uj){return void 0===uW&&(uW=0),void 0===uj&&(uj=2147483647),this._content.removeChildren(uW,uj),this._setScrollChanged(),this},ut.getChildAt=function(uW){return this._content.getChildAt(uW)},ut.getChildByName=function(uW){return this._content.getChildByName(uW)},ut.getChildIndex=function(uW){return this._content.getChildIndex(uW)},ut.changeScroll=function(){this._scrollChanged=!1;var uW=this.contentWidth||1,uj=this.contentHeight||1,ut=this._vScrollBar,ud=this._hScrollBar,ub=ut&&uj>this._height,uE=ud&&uW>this._width,uO=ub?this._width-ut.width:this._width,uq=uE?this._height-ud.height:this._height;ut&&(ut.x=this._width-ut.width,ut.y=0,ut.height=this._height-(uE?ud.height:0),ut.scrollSize=Math.max(.033*this._height,1),ut.thumbPercent=uq/uj,ut.setScroll(0,uj-uq,ut.value)),ud&&(ud.x=0,ud.y=this._height-ud.height,ud.width=this._width-(ub?ut.width:0),ud.scrollSize=Math.max(.033*this._width,1),ud.thumbPercent=uO/uW,ud.setScroll(0,uW-uO,ud.value))},ut.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},ut.setContentSize=function(uW,uj){var ut=this._content;ut.width=uW,ut.height=uj,ut.scrollRect||(ut.scrollRect=new uo),ut.scrollRect.setTo(0,0,uW,uj),ut.scrollRect=ut.scrollRect},ut.onScrollBarChange=function(uW){var uj=this._content.scrollRect;if(uj){var ut=Math.round(uW.value);uW.isVertical?uj.y=ut:uj.x=ut,this._content.scrollRect=uj}},ut.scrollTo=function(uW,uj){void 0===uW&&(uW=0),void 0===uj&&(uj=0),this.vScrollBar&&(this.vScrollBar.value=uj),this.hScrollBar&&(this.hScrollBar.value=uW)},ut.refresh=function(){this.changeScroll()},ut.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=ue.superGet(uy,this,"cacheAs")),ue.superSet(uy,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},ut.onScrollEnd=function(){ue.superSet(uy,this,"cacheAs",this._$P.cacheAs)},ut._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},ub(0,ut,"numChildren",function(){return this._content.numChildren}),ub(0,ut,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(uW){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new ui),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=uW}),ub(0,ut,"contentWidth",function(){for(var uW=0,uj=this._content.numChildren-1;-1<uj;uj--){var ut=this._content.getChildAt(uj);uW=Math.max(ut.x+ut.width*ut.scaleX,uW)}return uW}),ub(0,ut,"contentHeight",function(){for(var uW=0,uj=this._content.numChildren-1;-1<uj;uj--){var ut=this._content.getChildAt(uj);uW=Math.max(ut.y+ut.height*ut.scaleY,uW)}return uW}),ub(0,ut,"width",uW.prototype._$get_width,function(uW){ue.superSet(uy,this,"width",uW),this._setScrollChanged()}),ub(0,ut,"hScrollBar",function(){return this._hScrollBar}),ub(0,ut,"content",function(){return this._content}),ub(0,ut,"height",uW.prototype._$get_height,function(uW){ue.superSet(uy,this,"height",uW),this._setScrollChanged()}),ub(0,ut,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(uW){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new ujW),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=uW}),ub(0,ut,"vScrollBar",function(){return this._vScrollBar}),ub(0,ut,"cacheAs",uW.prototype._$get_cacheAs,function(uW){ue.superSet(uy,this,"cacheAs",uW),this._$P.cacheAs=null,"none"!==uW?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),uj}(uy),un=function(uW){function uj(uW){uj.__super.call(this,uW),this.isVertical=!1}return uE(uj,"laya.ui.HSlider",uH),uj}(),uk=function(uW){function ut(uW,uj){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,ut.__super.call(this),this.skin=uj,this.labels=uW}uE(ut,"laya.ui.UIGroup",uW);var uj=ut.prototype;return ue.imps(uj,{"laya.ui.IItem":!0}),uj.preinitialize=function(){this.mouseEnabled=!0},uj.destroy=function(uW){void 0===uW&&(uW=!0),laya.ui.Component.prototype.destroy.call(this,uW),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},uj.addItem=function(uW,uj){void 0===uj&&(uj=!0);var ut=uW,ud=this._items.length;if(ut.name="item"+ud,this.addChild(ut),this.initItems(),uj&&0<ud){var ub=this._items[ud-1];"horizontal"==this._direction?ut.x=ub.x+ub.width+this._space:ut.y=ub.y+ub.height+this._space}else uj&&(ut.x=0,ut.y=0);return ud},uj.delItem=function(uW,uj){void 0===uj&&(uj=!0);var ut=this._items.indexOf(uW);if(-1!=ut){var ud=uW;this.removeChild(ud);for(var ub=ut+1,uE=this._items.length;ub<uE;ub++){var uO=this._items[ub];uO.name="item"+(ub-1),uj&&("horizontal"==this._direction?uO.x-=ud.width+this._space:uO.y-=ud.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var uq;uq=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=uq}}},uj.initItems=function(){this._items||(this._items=[]);for(var uW=this._items.length=0;uW<1e4;uW++){var uj=this.getChildByName("item"+uW);if(null==uj)break;this._items.push(uj),uj.selected=uW===this._selectedIndex,uj.clickHandler=uQ.create(this,this.itemClick,[uW],!1)}},uj.itemClick=function(uW){this.selectedIndex=uW},uj.setSelect=function(uW,uj){this._items&&-1<uW&&uW<this._items.length&&(this._items[uW].selected=uj)},uj.createItem=function(uW,uj){return null},uj.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var uW=0,uj=0,ut=this._items.length;uj<ut;uj++){var ud=this._items[uj];this._skin&&(ud.skin=this._skin),this._labelColors&&(ud.labelColors=this._labelColors),this._labelSize&&(ud.labelSize=this._labelSize),this._labelStroke&&(ud.labelStroke=this._labelStroke),this._labelStrokeColor&&(ud.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(ud.strokeColors=this._strokeColors),this._labelBold&&(ud.labelBold=this._labelBold),this._labelPadding&&(ud.labelPadding=this._labelPadding),this._labelAlign&&(ud.labelAlign=this._labelAlign),this._stateNum&&(ud.stateNum=this._stateNum),this._labelFont&&(ud.labelFont=this._labelFont),"horizontal"===this._direction?(ud.y=0,ud.x=uW,uW+=ud.width+this._space):(ud.x=0,ud.y=uW,uW+=ud.height+this._space)}this.changeSize()},uj.commitMeasure=function(){this.runCallLater(this.changeLabels)},uj._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},ub(0,uj,"labelStrokeColor",function(){return this._labelStrokeColor},function(uW){this._labelStrokeColor!=uW&&(this._labelStrokeColor=uW,this._setLabelChanged())}),ub(0,uj,"skin",function(){return this._skin},function(uW){this._skin!=uW&&(this._skin=uW,this._setLabelChanged())}),ub(0,uj,"selectedIndex",function(){return this._selectedIndex},function(uW){this._selectedIndex!=uW&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=uW,this.setSelect(uW,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),ub(0,uj,"labels",function(){return this._labels},function(uW){if(this._labels!=uW){if(this._labels=uW,this.removeChildren(),this._setLabelChanged(),this._labels)for(var uj=this._labels.split(","),ut=0,ud=uj.length;ut<ud;ut++){var ub=this.createItem(this._skin,uj[ut]);ub.name="item"+ut,this.addChild(ub)}this.initItems()}}),ub(0,uj,"strokeColors",function(){return this._strokeColors},function(uW){this._strokeColors!=uW&&(this._strokeColors=uW,this._setLabelChanged())}),ub(0,uj,"labelColors",function(){return this._labelColors},function(uW){this._labelColors!=uW&&(this._labelColors=uW,this._setLabelChanged())}),ub(0,uj,"labelStroke",function(){return this._labelStroke},function(uW){this._labelStroke!=uW&&(this._labelStroke=uW,this._setLabelChanged())}),ub(0,uj,"labelSize",function(){return this._labelSize},function(uW){this._labelSize!=uW&&(this._labelSize=uW,this._setLabelChanged())}),ub(0,uj,"stateNum",function(){return this._stateNum},function(uW){this._stateNum!=uW&&(this._stateNum=uW,this._setLabelChanged())}),ub(0,uj,"labelBold",function(){return this._labelBold},function(uW){this._labelBold!=uW&&(this._labelBold=uW,this._setLabelChanged())}),ub(0,uj,"labelFont",function(){return this._labelFont},function(uW){this._labelFont!=uW&&(this._labelFont=uW,this._setLabelChanged())}),ub(0,uj,"labelPadding",function(){return this._labelPadding},function(uW){this._labelPadding!=uW&&(this._labelPadding=uW,this._setLabelChanged())}),ub(0,uj,"direction",function(){return this._direction},function(uW){this._direction=uW,this._setLabelChanged()}),ub(0,uj,"space",function(){return this._space},function(uW){this._space=uW,this._setLabelChanged()}),ub(0,uj,"items",function(){return this._items}),ub(0,uj,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(uW){this.selectedIndex=this._items.indexOf(uW)}),ub(0,uj,"dataSource",uW.prototype._$get_dataSource,function(uW){"number"==typeof(this._dataSource=uW)&&Math.floor(uW)==uW||"string"==typeof uW?this.selectedIndex=parseInt(uW):uW instanceof Array?this.labels=uW.join(","):ue.superSet(uy,this,"dataSource",uW)}),ut}(uy),up=function(uj){function ut(uW,uj){this._value=null,void 0===uj&&(uj=""),ut.__super.call(this,uW,uj)}uE(ut,"laya.ui.Radio",uj);var uW=ut.prototype;return uW.destroy=function(uW){void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,uW),this._value=null},uW.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},uW.initialize=function(){uj.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},uW.onClick=function(uW){this.selected=!0},ub(0,uW,"value",function(){return null!=this._value?this._value:this.label},function(uW){this._value=uW}),ut}(ua),uF=function(uW){function uj(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,uj.__super.call(this),this.width=this.height=200}uE(uj,"laya.ui.Tree",uW);var ut=uj.prototype;return ue.imps(ut,{"laya.ui.IRender":!0}),ut.destroy=function(uW){void 0===uW&&(uW=!0),laya.ui.Component.prototype.destroy.call(this,uW),this._list&&this._list.destroy(uW),this._list=null,this._source=null,this._renderHandler=null},ut.createChildren=function(){this.addChild(this._list=new uP),this._list.renderHandler=uQ.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},ut.onListChange=function(uW){this.event("change")},ut.getArray=function(){var uW,uj=[];for(var ut in this._source)uW=this._source[ut],this.getParentOpenStatus(uW)&&(uW.x=this._spaceLeft*this.getDepth(uW),uj.push(uW));return uj},ut.getDepth=function(uW,uj){return void 0===uj&&(uj=0),null==uW.nodeParent?uj:this.getDepth(uW.nodeParent,uj+1)},ut.getParentOpenStatus=function(uW){var uj=uW.nodeParent;return null==uj||!!uj.isOpen&&(null==uj.nodeParent||this.getParentOpenStatus(uj))},ut.renderItem=function(uW,uj){var ut=uW.dataSource;if(ut){uW.left=ut.x;var ud=uW.getChildByName("arrow");ud&&(ut.hasChild?(ud.visible=!0,ud.index=ut.isOpen?1:0,ud.tag=uj,ud.off("click",this,this.onArrowClick),ud.on("click",this,this.onArrowClick)):ud.visible=!1);var ub=uW.getChildByName("folder");ub&&(2==ub.clipY?ub.index=ut.isDirectory?0:1:ub.index=ut.isDirectory?ut.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([uW,uj])}},ut.onArrowClick=function(uW){var uj=uW.currentTarget.tag;this._list.array[uj].isOpen=!this._list.array[uj].isOpen,this.event("open"),this._list.array=this.getArray()},ut.setItemState=function(uW,uj){this._list.array[uW]&&(this._list.array[uW].isOpen=uj,this._list.array=this.getArray())},ut.fresh=function(){this._list.array=this.getArray(),this.repaint()},ut.parseXml=function(uW,uj,ut,ud){var ub,uE=uW.childNodes,uO=uE.length;if(!ud){ub={};var uq,uA=uW.attributes;for(var uc in uA){var uR=(uq=uA[uc]).nodeName,um=uq.nodeValue;ub[uR]="true"==um||"false"!=um&&um}ub.nodeParent=ut,0<uO&&(ub.isDirectory=!0),ub.hasChild=0<uO,uj.push(ub)}for(var uQ=0;uQ<uO;uQ++){var uT=uE[uQ];this.parseXml(uT,uj,ub,!1)}},ut.parseOpenStatus=function(uW,uj){for(var ut=0,ud=uj.length;ut<ud;ut++){var ub=uj[ut];if(ub.isDirectory)for(var uE=0,uO=uW.length;uE<uO;uE++){var uq=uW[uE];if(uq.isDirectory&&this.isSameParent(uq,ub)&&ub.label==uq.label){ub.isOpen=uq.isOpen;break}}}},ut.isSameParent=function(uW,uj){return null==uW.nodeParent&&null==uj.nodeParent||null!=uW.nodeParent&&null!=uj.nodeParent&&(uW.nodeParent.label==uj.nodeParent.label&&this.isSameParent(uW.nodeParent,uj.nodeParent))},ut.filter=function(uW){if(Boolean(uW)){var uj=[];this.getFilterSource(this._source,uj,uW),this._list.array=uj}else this._list.array=this.getArray()},ut.getFilterSource=function(uW,uj,ut){var ud;for(var ub in ut=ut.toLocaleLowerCase(),uW)!(ud=uW[ub]).isDirectory&&-1<String(ud.label).toLowerCase().indexOf(ut)&&(ud.x=0,uj.push(ud)),ud.child&&0<ud.child.length&&this.getFilterSource(ud.child,uj,ut)},ub(0,ut,"spaceBottom",function(){return this._list.spaceY},function(uW){this._list.spaceY=uW}),ub(0,ut,"keepStatus",function(){return this._keepStatus},function(uW){this._keepStatus=uW}),ub(0,ut,"itemRender",function(){return this._list.itemRender},function(uW){this._list.itemRender=uW}),ub(0,ut,"array",function(){return this._list.array},function(uW){this._keepStatus&&this._list.array&&uW&&this.parseOpenStatus(this._list.array,uW),this._source=uW,this._list.array=this.getArray()}),ub(0,ut,"mouseHandler",function(){return this._list.mouseHandler},function(uW){this._list.mouseHandler=uW}),ub(0,ut,"dataSource",uW.prototype._$get_dataSource,function(uW){this._dataSource=uW,ue.superSet(uy,this,"dataSource",uW)}),ub(0,ut,"source",function(){return this._source}),ub(0,ut,"scrollBar",function(){return this._list.scrollBar}),ub(0,ut,"list",function(){return this._list}),ub(0,ut,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(uW){this._list.vScrollBarSkin=uW}),ub(0,ut,"renderHandler",function(){return this._renderHandler},function(uW){this._renderHandler=uW}),ub(0,ut,"selectedIndex",function(){return this._list.selectedIndex},function(uW){this._list.selectedIndex=uW}),ub(0,ut,"spaceLeft",function(){return this._spaceLeft},function(uW){this._spaceLeft=uW}),ub(0,ut,"selectedItem",function(){return this._list.selectedItem},function(uW){this._list.selectedItem=uW}),ub(0,ut,"width",uW.prototype._$get_width,function(uW){ue.superSet(uy,this,"width",uW),this._list.width=uW}),ub(0,ut,"height",uW.prototype._$get_height,function(uW){ue.superSet(uy,this,"height",uW),this._list.height=uW}),ub(0,ut,"xml",null,function(uW){var uj=[];this.parseXml(uW.childNodes[0],uj,null,!0),this.array=uj}),ub(0,ut,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),uj}(uy),uWW=function(uW){function uj(){this._items=null,this._selectedIndex=0,uj.__super.call(this),this._setIndexHandler=uQ.create(this,this.setIndex,null,!1)}uE(uj,"laya.ui.ViewStack",uW);var ut=uj.prototype;return ue.imps(ut,{"laya.ui.IItem":!0}),ut.setItems=function(uW){this.removeChildren();for(var uj=0,ut=0,ud=uW.length;ut<ud;ut++){var ub=uW[ut];ub&&(ub.name="item"+uj,this.addChild(ub),uj++)}this.initItems()},ut.addItem=function(uW){uW.name="item"+this._items.length,this.addChild(uW),this.initItems()},ut.initItems=function(){this._items=[];for(var uW=0;uW<1e4;uW++){var uj=this.getChildByName("item"+uW);if(null==uj)break;this._items.push(uj),uj.visible=uW==this._selectedIndex}},ut.setSelect=function(uW,uj){this._items&&-1<uW&&uW<this._items.length&&(this._items[uW].visible=uj)},ut.setIndex=function(uW){this.selectedIndex=uW},ub(0,ut,"dataSource",uW.prototype._$get_dataSource,function(uW){if("number"==typeof(this._dataSource=uW)&&Math.floor(uW)==uW||"string"==typeof uW)this.selectedIndex=parseInt(uW);else for(var uj in this._dataSource)this.hasOwnProperty(uj)&&(this[uj]=this._dataSource[uj])}),ub(0,ut,"selectedIndex",function(){return this._selectedIndex},function(uW){this._selectedIndex!=uW&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=uW,this.setSelect(this._selectedIndex,!0))}),ub(0,ut,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(uW){this.selectedIndex=this._items.indexOf(uW)}),ub(0,ut,"items",function(){return this._items}),ub(0,ut,"setIndexHandler",function(){return this._setIndexHandler},function(uW){this._setIndexHandler=uW}),uj}(uy),ujW=function(uW){function uj(){uj.__super.call(this)}return uE(uj,"laya.ui.VScrollBar",uY),uj}(),utW=function(uj){function ut(uW){this._bg=null,this._skin=null,ut.__super.call(this),void 0===uW&&(uW=""),this.text=uW,this.skin=this.skin}uE(ut,"laya.ui.TextInput",uj);var uW=ut.prototype;return uW.preinitialize=function(){this.mouseEnabled=!0},uW.destroy=function(uW){uS.clearCache(this,this._skin),void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,uW),this._bg&&this._bg.destroy(),this._bg=null},uW.createChildren=function(){this.addChild(this._tf=new uT),this._tf.padding=uV.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},uW._onFocus=function(){this.event("focus",this)},uW._onBlur=function(){this.event("blur",this)},uW._onInput=function(){this.event("input",this)},uW._onEnter=function(){this.event("enter",this)},uW.initialize=function(){this.width=128,this.height=22},uW.select=function(){this._tf.select()},uW.setSelection=function(uW,uj){this._tf.setSelection(uW,uj)},ub(0,uW,"text",uj.prototype._$get_text,function(uW){this._tf.text!=uW&&(uW+="",this._tf.text=uW,this.event("change"))}),ub(0,uW,"bg",function(){return this._bg},function(uW){this.graphics=this._bg=uW}),ub(0,uW,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(uW){this._tf.inputElementYAdjuster=uW}),ub(0,uW,"multiline",function(){return this._tf.multiline},function(uW){this._tf.multiline=uW}),ub(0,uW,"skin",function(){return this._skin},function(uW){this._skin!=uW&&(uS.clearCache(this,this._skin),this._skin=uW,this._bg||(this.graphics=this._bg=new ul),uS.keepCache(this,this._skin),this._bg.source=uS.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),ub(0,uW,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(uW){this._bg||(this.graphics=this._bg=new ul),this._bg.sizeGrid=ux.fillArray(uV.defaultSizeGrid,uW,Number)}),ub(0,uW,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(uW){this._tf.inputElementXAdjuster=uW}),ub(0,uW,"width",uj.prototype._$get_width,function(uW){ue.superSet(ug,this,"width",uW),this._bg&&(this._bg.width=uW)}),ub(0,uW,"height",uj.prototype._$get_height,function(uW){ue.superSet(ug,this,"height",uW),this._bg&&(this._bg.height=uW)}),ub(0,uW,"editable",function(){return this._tf.editable},function(uW){this._tf.editable=uW}),ub(0,uW,"restrict",function(){return this._tf.restrict},function(uW){this._tf.restrict=uW}),ub(0,uW,"prompt",function(){return this._tf.prompt},function(uW){this._tf.prompt=uW}),ub(0,uW,"promptColor",function(){return this._tf.promptColor},function(uW){this._tf.promptColor=uW}),ub(0,uW,"maxChars",function(){return this._tf.maxChars},function(uW){this._tf.maxChars=uW}),ub(0,uW,"focus",function(){return this._tf.focus},function(uW){this._tf.focus=uW}),ub(0,uW,"type",function(){return this._tf.type},function(uW){this._tf.type=uW}),ub(0,uW,"asPassword",function(){return this._tf.asPassword},function(uW){this._tf.asPassword=uW}),ut}(ug),udW=function(uW){function uj(){uj.__super.call(this)}return uE(uj,"laya.ui.VSlider",uH),uj}(),ubW=function(uW){function ud(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,ud.__super.call(this)}uE(ud,"laya.ui.Dialog",uW);var uj=ud.prototype;return uj.initialize=function(){this.popupEffect=ud.manager.popupEffectHandler,this.closeEffect=ud.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},uj._dealDragArea=function(){var uW=this.getChildByName("drag");uW&&(this.dragArea=uW.x+","+uW.y+","+uW.width+","+uW.height,uW.removeSelf())},uj._onClick=function(uW){var uj=uW.target;if(uj)switch(uj.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(uj.name)}},uj.show=function(uW,uj){void 0===uW&&(uW=!1),void 0===uj&&(uj=!0),this._open(!1,uW,uj)},uj.popup=function(uW,uj){void 0===uW&&(uW=!1),void 0===uj&&(uj=!0),this._open(!0,uW,uj)},uj._open=function(uW,uj,ut){ud.manager.lock(!1),this.isModal=uW,ud.manager.open(this,uj,ut)},uj.onOpened=function(){},uj.close=function(uW,uj){void 0===uj&&(uj=!0),ud.manager.close(this,uW,uj)},uj.onClosed=function(uW){},uj._onMouseDown=function(uW){var uj=this.getMousePoint();this._dragArea.contains(uj.x,uj.y)?this.startDrag():this.stopDrag()},ub(0,uj,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(uW){if(uW){var uj=ux.fillArray([0,0,0,0],uW,Number);this._dragArea=new uo(uj[0],uj[1],uj[2],uj[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),ub(0,uj,"isPopup",function(){return null!=this.parent}),ub(0,uj,"zOrder",uW.prototype._$get_zOrder,function(uW){ue.superSet(uw,this,"zOrder",uW),ud.manager._checkMask()}),ub(1,ud,"manager",function(){return ud._manager=ud._manager||new uv},function(uW){ud._manager=uW}),ud.setLockView=function(uW){ud.manager.setLockView(uW)},ud.lock=function(uW){ud.manager.lock(uW)},ud.closeAll=function(){ud.manager.closeAll()},ud.getDialogsByGroup=function(uW){return ud.manager.getDialogsByGroup(uW)},ud.closeByGroup=function(uW){return ud.manager.closeByGroup(uW)},ud.CLOSE="close",ud.CANCEL="cancel",ud.SURE="sure",ud.NO="no",ud.OK="ok",ud.YES="yes",ud._manager=null,ud}(uw),uEW=function(uW){function uj(){uj.__super.call(this)}uE(uj,"laya.ui.HBox",uW);var ut=uj.prototype;return ut.sortItem=function(uW){uW&&uW.sort(function(uW,uj){return uW.x-uj.x})},ut.changeItems=function(){this._itemChanged=!1;for(var uW=[],uj=0,ut=0,ud=this.numChildren;ut<ud;ut++){var ub=this.getChildAt(ut);ub&&ub.layoutEnabled&&(uW.push(ub),uj=this._height?this._height:Math.max(uj,ub.height*ub.scaleY))}this.sortItem(uW);var uE=0;for(ut=0,ud=uW.length;ut<ud;ut++)(ub=uW[ut]).x=uE,uE+=ub.width*ub.scaleX+this._space,"top"==this._align?ub.y=0:"middle"==this._align?ub.y=.5*(uj-ub.height*ub.scaleY):"bottom"==this._align&&(ub.y=uj-ub.height*ub.scaleY);this.changeSize()},ub(0,ut,"height",uW.prototype._$get_height,function(uW){this._height!=uW&&(ue.superSet(uJ,this,"height",uW),this.callLater(this.changeItems))}),uj.NONE="none",uj.TOP="top",uj.MIDDLE="middle",uj.BOTTOM="bottom",uj}(uJ),uOW=function(uW){function uj(){uj.__super.call(this)}uE(uj,"laya.ui.VBox",uW);var ut=uj.prototype;return ut.changeItems=function(){this._itemChanged=!1;for(var uW=[],uj=0,ut=0,ud=this.numChildren;ut<ud;ut++){var ub=this.getChildAt(ut);ub&&ub.layoutEnabled&&(uW.push(ub),uj=this._width?this._width:Math.max(uj,ub.width*ub.scaleX))}this.sortItem(uW);var uE=0;for(ut=0,ud=uW.length;ut<ud;ut++)(ub=uW[ut]).y=uE,uE+=ub.height*ub.scaleY+this._space,"left"==this._align?ub.x=0:"center"==this._align?ub.x=.5*(uj-ub.width*ub.scaleX):"right"==this._align&&(ub.x=uj-ub.width*ub.scaleX);this.changeSize()},ub(0,ut,"width",uW.prototype._$get_width,function(uW){this._width!=uW&&(ue.superSet(uJ,this,"width",uW),this.callLater(this.changeItems))}),uj.NONE="none",uj.LEFT="left",uj.CENTER="center",uj.RIGHT="right",uj}(uJ),uqW=function(uW){function uj(){uj.__super.call(this)}return uE(uj,"laya.ui.RadioGroup",uk),uj.prototype.createItem=function(uW,uj){return new up(uW,uj)},uj}(),uAW=function(uW){function uj(){uj.__super.call(this)}return uE(uj,"laya.ui.Tab",uk),uj.prototype.createItem=function(uW,uj){return new ua(uW,uj)},uj}(),ucW=function(uj){function ut(uW){this._vScrollBar=null,this._hScrollBar=null,void 0===uW&&(uW=""),ut.__super.call(this,uW)}uE(ut,"laya.ui.TextArea",uj);var uW=ut.prototype;return uW.destroy=function(uW){void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,uW),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},uW.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},uW.onVBarChanged=function(uW){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},uW.onHBarChanged=function(uW){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},uW.changeScroll=function(){var uW=this._vScrollBar&&0<this._tf.maxScrollY,uj=this._hScrollBar&&0<this._tf.maxScrollX,ut=uW?this._width-this._vScrollBar.width:this._width,ud=uj?this._height-this._hScrollBar.height:this._height,ub=this._tf.padding||uV.labelPadding;this._tf.width=ut,this._tf.height=ud,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-ub[2],this._vScrollBar.y=ub[1],this._vScrollBar.height=this._height-(uj?this._hScrollBar.height:0)-ub[1]-ub[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=ud/Math.max(this._tf.textHeight,ud),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=uW),this._hScrollBar&&(this._hScrollBar.x=ub[0],this._hScrollBar.y=this._height-this._hScrollBar.height-ub[3],this._hScrollBar.width=this._width-(uW?this._vScrollBar.width:0)-ub[0]-ub[2],this._hScrollBar.scrollSize=Math.max(.033*ut,1),this._hScrollBar.thumbPercent=ut/Math.max(this._tf.textWidth,ut),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=uj)},uW.scrollTo=function(uW){this.commitMeasure(),this._tf.scrollY=uW},ub(0,uW,"scrollY",function(){return this._tf.scrollY}),ub(0,uW,"width",uj.prototype._$get_width,function(uW){ue.superSet(utW,this,"width",uW),this.callLater(this.changeScroll)}),ub(0,uW,"hScrollBar",function(){return this._hScrollBar}),ub(0,uW,"height",uj.prototype._$get_height,function(uW){ue.superSet(utW,this,"height",uW),this.callLater(this.changeScroll)}),ub(0,uW,"maxScrollX",function(){return this._tf.maxScrollX}),ub(0,uW,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(uW){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new ujW),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=uW}),ub(0,uW,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(uW){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new ui),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=uW}),ub(0,uW,"vScrollBar",function(){return this._vScrollBar}),ub(0,uW,"maxScrollY",function(){return this._tf.maxScrollY}),ub(0,uW,"scrollX",function(){return this._tf.scrollX}),ut}(utW);!function(uW){function uj(){this._uiView=null,this.isCloseOther=!1,uj.__super.call(this)}uE(uj,"laya.ui.AsynDialog",ubW);var ut=uj.prototype;ut.createView=function(uW){this._uiView=uW},ut._open=function(uW,uj,ut){this.isModal=uW,this.isCloseOther=uj,ubW.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},ut.onCreated=function(){this.createUI(),this.onOpen()},ut.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},ut.onOpen=function(){ubW.manager.open(this,this.isCloseOther),ubW.manager.lock(!1)},ut.close=function(uW,uj){void 0===uj&&(uj=!0),ubW.manager.close(this),this.onClose()},ut.onClose=function(){},ut.destroy=function(uW){void 0===uW&&(uW=!0),laya.ui.View.prototype.destroy.call(this,uW),this._uiView=null,this.onDestroy()},ut.onDestroy=function(){}}();ue.__init([uw])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(uW,uj){"use strict";for(var ut in Object.defineProperty(uj,"__esModule",{value:!0}),Laya){var ud=Laya[ut];ud&&ud.__isclass&&(uj[ut]=ud)}}),function(uQ,uW,uX){uX.un,uX.uns;var um=uX.static,uT=uX.class,u$=uX.getset,ud=uX.__newvec,uZ=laya.maths.Arith,uO=laya.webgl.atlas.AtlasResourceManager,ut=laya.webgl.shader.BaseShader,uh=laya.utils.Browser,uq=laya.webgl.utils.Buffer,u_=laya.utils.Byte,ub=laya.utils.ClassUtils,uA=uX.Config,uE=(laya.events.Event,laya.events.EventDispatcher),uV=laya.utils.Handler,uo=laya.net.Loader,uj=laya.net.LoaderManager,uc=(laya.maths.MathUtil,laya.display.Node),ue=laya.renders.Render,uR=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),uK=laya.resource.Resource,uS=laya.utils.RunDriver,uM=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),uN=laya.display.Sprite,uz=laya.utils.Stat,uC=laya.utils.StringKey,ux=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),uL=laya.utils.Utils,uG=laya.webgl.WebGL,ul=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;uX.interface("laya.d3.core.IClone"),uX.interface("laya.d3.graphics.IVertex"),uX.interface("laya.d3.core.render.IUpdate"),uX.interface("laya.d3.core.scene.ITreeNode"),uX.interface("laya.d3.core.render.IRenderable");(function(){function ua(){}uT(ua,"laya.d3.animation.AnimationClipParser01"),ua.READ_DATA=function(){ua._DATA.offset=ua._reader.getUint32(),ua._DATA.size=ua._reader.getUint32()},ua.READ_BLOCK=function(){for(var uW=ua._BLOCK.count=ua._reader.getUint16(),uj=ua._BLOCK.blockStarts=[],ut=ua._BLOCK.blockLengths=[],ud=0;ud<uW;ud++)uj.push(ua._reader.getUint32()),ut.push(ua._reader.getUint32())},ua.READ_STRINGS=function(){var uW=ua._reader.getUint32(),uj=ua._reader.getUint16(),ut=ua._reader.pos;ua._reader.pos=uW+ua._DATA.offset;for(var ud=0;ud<uj;ud++)ua._strings[ud]=ua._reader.readUTFString();ua._reader.pos=ut},ua.parse=function(uW,uj){ua._animationClip=uW;(ua._reader=uj).__getBuffer();ua.READ_DATA(),ua.READ_BLOCK(),ua.READ_STRINGS();for(var ut=0,ud=ua._BLOCK.count;ut<ud;ut++){var ub=uj.getUint16(),uE=ua._strings[ub],uO=ua["READ_"+uE];if(null==uO)throw new Error("model file err,no this function:"+ub+" "+uE);uO.call()}},ua.READ_ANIMATIONS=function(){var uW,uj=0,ut=0,ud=ua._reader,ub=ud.__getBuffer(),uE=[],uO=ud.getUint8();for(uE.length=uO,uj=0;uj<uO;uj++)uE[uj]=ud.getUint16();var uq=[],uA=ud.getUint16();for(uq.length=uA,uj=0;uj<uA;uj++)uq[uj]=ud.getFloat32();var uc=ua._animationClip;uc.name=ua._strings[ud.getUint16()];var uR=uc._duration=ud.getFloat32();uc.islooping=!!ud.getByte(),uc._frameRate=ud.getInt16();var um=ud.getInt16(),uQ=uc._nodes=new Array;uQ.length=um,(uc._publicClipDatas=[]).length=um;var uT=uc._nodesMap={},u$=0,ue=0;for(uj=0;uj<um;uj++){uW=uQ[uj]=new uf;var uK=ud.getUint16(),uo=uW.path=[];for(uo.length=uK,ut=0;ut<uK;ut++)uo[ut]=ua._strings[ud.getUint16()];var uS=uo.join("/"),uM=uT[uS];uM||(uT[uS]=uM=[]),uM.push(uW);var uZ=ud.getInt16();-1!==uZ&&(uW.componentType=ua._strings[uZ]);var uX=uI._propertyIndexDic[ua._strings[ud.getUint16()]];if(null==uX)throw new Error("AnimationClipParser01:unknown property name.");var u_=uX<4,uN=!u_||u_&&""===uo[0];(uW._cacheProperty=uN)?u$++:ue++,uW.propertyNameID=uX;var uz=uE[ud.getUint8()];uW.keyFrameWidth=uz/4;var uC=uW.keyFrames=[],uL=uC.length=ud.getUint16(),uV=null,ux=NaN;for(ut=0;ut<uL;ut++){var uG=uC[ut]=new ug;ux=uG.startTime=uq[ud.getUint16()];var ul=ud.pos;uG.inTangent=new Float32Array(ub.slice(ul,ul+uz)),ud.pos+=uz,ul=ud.pos,uG.outTangent=new Float32Array(ub.slice(ul,ul+uz)),ud.pos+=uz,ul=ud.pos,uG.data=new Float32Array(ub.slice(ul,ul+uz)),ud.pos+=uz,uV&&(uV.next=uG,uV.duration=ux-uV.startTime),uV=uG}uG.next=null,uG.duration=uR-ux}var uh=uc._nodeToCachePropertyMap=new Int32Array(um),uv=uc._cachePropertyMap=new Int32Array(u$),uy=uc._unCachePropertyMap=new Int32Array(ue);for(u$=ue=0,uj=0;uj<um;uj++)(uW=uQ[uj])._cacheProperty?(uh[uj]=u$,uv[u$++]=uj):uy[ue++]=uj},ua._animationClip=null,ua._reader=null,ua._strings=[],um(ua,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function uY(){}uT(uY,"laya.d3.animation.AnimationClipParser02"),uY.READ_DATA=function(){uY._DATA.offset=uY._reader.getUint32(),uY._DATA.size=uY._reader.getUint32()},uY.READ_BLOCK=function(){for(var uW=uY._BLOCK.count=uY._reader.getUint16(),uj=uY._BLOCK.blockStarts=[],ut=uY._BLOCK.blockLengths=[],ud=0;ud<uW;ud++)uj.push(uY._reader.getUint32()),ut.push(uY._reader.getUint32())},uY.READ_STRINGS=function(){var uW=uY._reader.getUint32(),uj=uY._reader.getUint16(),ut=uY._reader.pos;uY._reader.pos=uW+uY._DATA.offset;for(var ud=0;ud<uj;ud++)uY._strings[ud]=uY._reader.readUTFString();uY._reader.pos=ut},uY.parse=function(uW,uj){uY._animationClip=uW;(uY._reader=uj).__getBuffer();uY.READ_DATA(),uY.READ_BLOCK(),uY.READ_STRINGS();for(var ut=0,ud=uY._BLOCK.count;ut<ud;ut++){var ub=uj.getUint16(),uE=uY._strings[ub],uO=uY["READ_"+uE];if(null==uO)throw new Error("model file err,no this function:"+ub+" "+uE);uO.call()}},uY.READ_ANIMATIONS=function(){var uW,uj=0,ut=0,ud=uY._reader,ub=ud.__getBuffer(),uE=[],uO=ud.getUint8();for(uE.length=uO,uj=0;uj<uO;uj++)uE[uj]=ud.getUint16();var uq=[],uA=ud.getUint16();for(uq.length=uA,uj=0;uj<uA;uj++)uq[uj]=ud.getFloat32();var uc=uY._animationClip;uc.name=uY._strings[ud.getUint16()];var uR=uc._duration=ud.getFloat32();uc.islooping=!!ud.getByte(),uc._frameRate=ud.getInt16();var um=ud.getInt16(),uQ=uc._nodes=new Array;uQ.length=um,(uc._publicClipDatas=[]).length=um;var uT=uc._nodesMap={},u$=0,ue=0;for(uj=0;uj<um;uj++){uW=uQ[uj]=new uf;var uK=ud.getUint16(),uo=uW.path=[];for(uo.length=uK,ut=0;ut<uK;ut++)uo[ut]=uY._strings[ud.getUint16()];var uS=uo.join("/"),uM=uT[uS];uM||(uT[uS]=uM=[]),uM.push(uW);var uZ=ud.getInt16();-1!==uZ&&(uW.componentType=uY._strings[uZ]);var uX=uI._propertyIndexDic[uY._strings[ud.getUint16()]];if(null==uX)throw new Error("AnimationClipParser02:unknown property name.");var u_=uX<4,uN=!u_||u_&&""===uo[0];(uW._cacheProperty=uN)?u$++:ue++,uW.propertyNameID=uX;var uz=uE[ud.getUint8()];uW.keyFrameWidth=uz/4;var uC=uW.keyFrames=[],uL=uC.length=ud.getUint16(),uV=null,ux=NaN;for(ut=0;ut<uL;ut++){var uG=uC[ut]=new ug;ux=uG.startTime=uq[ud.getUint16()];var ul=ud.pos;uG.inTangent=new Float32Array(ub.slice(ul,ul+uz)),ud.pos+=uz,ul=ud.pos,uG.outTangent=new Float32Array(ub.slice(ul,ul+uz)),ud.pos+=uz,ul=ud.pos,uG.data=new Float32Array(ub.slice(ul,ul+uz)),ud.pos+=uz,uV&&(uV.next=uG,uV.duration=ux-uV.startTime),uV=uG}uG.next=null,uG.duration=uR-ux}var uh=ud.getUint16();for(uj=0;uj<uh;uj++){var uv,uy=new uH;uy.time=ud.getFloat32(),uy.eventName=uY._strings[ud.getUint16()];var ua=ud.getUint16();for(0<ua&&(uy.params=uv=[]),ut=0;ut<ua;ut++){switch(ud.getByte()){case 0:uv.push(!!ud.getByte());break;case 1:uv.push(ud.getInt32());break;case 2:uv.push(ud.getFloat32());break;case 3:uv.push(uY._strings[ud.getUint16()]);break;default:throw new Error("unknown type.")}}uc.addEvent(uy)}var uu=uc._nodeToCachePropertyMap=new Int32Array(um),uD=uc._cachePropertyMap=new Int32Array(u$),us=uc._unCachePropertyMap=new Int32Array(ue);for(u$=ue=0,uj=0;uj<um;uj++)(uW=uQ[uj])._cacheProperty?(uu[uj]=u$,uD[u$++]=uj):us[ue++]=uj},uY._animationClip=null,uY._reader=null,uY._strings=[],um(uY,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var uH=function(){function uW(){this.time=NaN,this.eventName=null,this.params=null}return uT(uW,"laya.d3.animation.AnimationEvent"),uW}(),uI=function(){function ud(){this._childs=[],this.transform=new uSj(this)}uT(ud,"laya.d3.animation.AnimationNode");var uW=ud.prototype;return uX.imps(uW,{"laya.d3.core.IClone":!0}),uW.addChild=function(uW){uW._parent=this,uW.transform.setParent(this.transform),this._childs.push(uW)},uW.removeChild=function(uW){var uj=this._childs.indexOf(uW);-1!==uj&&this._childs.splice(uj,1)},uW.getChildByName=function(uW){for(var uj=0,ut=this._childs.length;uj<ut;uj++){var ud=this._childs[uj];if(ud.name===uW)return ud}return null},uW.getChildByIndex=function(uW){return this._childs[uW]},uW.getChildCount=function(){return this._childs.length},uW.cloneTo=function(uW){var uj=uW;uj.name=this.name;for(var ut=0,ud=this._childs.length;ut<ud;ut++){var ub=this._childs[ut],uE=ub.clone();uj.addChild(uE);var uO=ub.transform,uq=uE.transform;uq.setLocalPosition(uO.getLocalPosition()),uq.setLocalRotation(uO.getLocalRotation()),uq.setLocalScale(uO.getLocalScale()),uq._localRotationEuler=uO._localRotationEuler,uq._setWorldMatrixIgnoreUpdate(uO.getWorldMatrix())}},uW.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},ud.__init__=function(){ud.registerAnimationNodeProperty("localPosition",ud._getLocalPosition,ud._setLocalPosition),ud.registerAnimationNodeProperty("localRotation",ud._getLocalRotation,ud._setLocalRotation),ud.registerAnimationNodeProperty("localScale",ud._getLocalScale,ud._setLocalScale),ud.registerAnimationNodeProperty("localRotationEuler",ud._getLocalRotationEuler,ud._setLocalRotationEuler),ud.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",ud._getParticleRenderSharedMaterialTintColor,ud._setParticleRenderSharedMaterialTintColor),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",ud._getMeshRenderSharedMaterialTilingOffset,ud._setMeshRenderSharedMaterialTilingOffset),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",ud._getMeshRenderSharedMaterialAlbedo,ud._setMeshRenderSharedMaterialAlbedo),ud.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",ud._getSkinnedMeshRenderSharedMaterialTilingOffset,ud._setSkinnedMeshRenderSharedMaterialTilingOffset),ud.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",ud._getSkinnedMeshRenderSharedMaterialAlbedo,ud._setSkinnedMeshRenderSharedMaterialAlbedo),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",ud._getMeshRenderSharedMaterialAlbedo,ud._setMeshRenderSharedMaterialAlbedo),ud.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",ud._getSkinnedMeshRenderSharedMaterialAlbedo,ud._setSkinnedMeshRenderSharedMaterialAlbedo),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",ud._getMeshRenderSharedMaterialIntensity,ud._setMeshRenderSharedMaterialIntensity),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",ud._getMeshRenderSharedMaterialAlpha,ud._setMeshRenderSharedMaterialAlpha),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",ud._getMeshRenderSharedMaterialAlphaColor,ud._setMeshRenderSharedMaterialAlphaColor),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",ud._getMeshRenderSharedMaterialBaseColor,ud._setMeshRenderSharedMaterialBaseColor),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",ud._getMeshRenderSharedMaterialDissolve,ud._setMeshRenderSharedMaterialDissolve),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",ud._getMeshRenderSharedMaterialDissolveSpeed,ud._setMeshRenderSharedMaterialDissolveSpeed),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",ud._getMeshRenderSharedMaterialMMultiplier,ud._setMeshRenderSharedMaterialMMultiplier),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",ud._getMeshRenderSharedMaterialBaseScrollSpeedX,ud._setMeshRenderSharedMaterialBaseScrollSpeedX),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",ud._getMeshRenderSharedMaterialBaseScrollSpeedY,ud._setMeshRenderSharedMaterialBaseScrollSpeedY),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",ud._getMeshRenderSharedMaterialSecondScrollSpeedX,ud._setMeshRenderSharedMaterialSecondScrollSpeedX),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",ud._getMeshRenderSharedMaterialSecondScrollSpeedY,ud._setMeshRenderSharedMaterialSecondScrollSpeedY),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",ud._getMeshRenderSharedMaterialDetailTilingOffset,ud._setMeshRenderSharedMaterialDetailTilingOffset),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",ud._getMeshRenderSharedMaterialDissolveTilingOffset,ud._setMeshRenderSharedMaterialDissolveTilingOffset),ud.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",ud._getMeshRenderSharedMaterialMaskTilingOffset,ud._setMeshRenderSharedMaterialMaskTilingOffset)},ud.registerAnimationNodeProperty=function(uW,uj,ut){if(ud._propertyIndexDic[uW])throw new Error("AnimationNode: this propertyName has registered.");ud._propertyIndexDic[uW]=ud._propertyIDCounter,ud._propertyGetFuncs[ud._propertyIDCounter]=uj,ud._propertySetFuncs[ud._propertyIDCounter]=ut,ud._propertyIDCounter++},ud._getLocalPosition=function(uW,uj){return uW?uW.transform.getLocalPosition():uj._transform.localPosition.elements},ud._setLocalPosition=function(uW,uj,ut){if(uW)uW.transform.setLocalPosition(ut);else{var ud=uj._transform,ub=ud.localPosition;ub.elements=ut,ud.localPosition=ub}},ud._getLocalRotation=function(uW,uj){return uW?uW.transform.getLocalRotation():uj._transform.localRotation.elements},ud._setLocalRotation=function(uW,uj,ut){if(uW)uW.transform.setLocalRotation(ut);else{var ud=uj._transform,ub=ud.localRotation;ub.elements=ut,ud.localRotation=ub}},ud._getLocalScale=function(uW,uj){return uW?uW.transform.getLocalScale():uj._transform.localScale.elements},ud._setLocalScale=function(uW,uj,ut){if(uW)uW.transform.setLocalScale(ut);else{var ud=uj._transform,ub=ud.localScale;ub.elements=ut,ud.localScale=ub}},ud._getLocalRotationEuler=function(uW,uj){return uW?uW.transform.getLocalRotationEuler():uj._transform.localRotationEuler.elements},ud._setLocalRotationEuler=function(uW,uj,ut){if(uW)uW.transform.setLocalRotationEuler(ut);else{var ud=uj._transform,ub=ud.localRotationEuler;ub.elements=ut,ud.localRotationEuler=ub}},ud._getMeshRenderSharedMaterialTilingOffset=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return uj.meshRender.sharedMaterial.tilingOffset.elements},ud._setMeshRenderSharedMaterialTilingOffset=function(uW,uj,ut){var ud,ub;if(uW){var uE=uW.transform._entity;uE&&((ub=(ud=uE.owner.meshRender.material).tilingOffset).elements=ut,ud.tilingOffset=ub)}else(ub=(ud=uj.meshRender.material).tilingOffset).elements=ut,ud.tilingOffset=ub},ud._getMeshRenderSharedMaterialAlbedo=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.albedoColor.elements:null}return uj.meshRender.sharedMaterial.albedoColor.elements},ud._setMeshRenderSharedMaterialAlbedo=function(uW,uj,ut){var ud,ub;if(uW){var uE=uW.transform._entity;uE&&((ub=(ud=uE.owner.meshRender.material).albedoColor).elements=ut,ud.albedoColor=ub)}else(ub=(ud=uj.meshRender.material).albedoColor).elements=ut,ud.albedoColor=ub},ud._getSkinnedMeshRenderSharedMaterialTilingOffset=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return uj.skinnedMeshRender.sharedMaterial.tilingOffset.elements},ud._setSkinnedMeshRenderSharedMaterialTilingOffset=function(uW,uj,ut){var ud,ub;if(uW){var uE=uW.transform._entity;uE&&((ub=(ud=uE.owner.skinnedMeshRender.material).tilingOffset).elements=ut,ud.tilingOffset=ub)}else(ub=(ud=uj.skinnedMeshRender.material).tilingOffset).elements=ut,ud.tilingOffset=ub},ud._getSkinnedMeshRenderSharedMaterialAlbedo=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return uj.skinnedMeshRender.sharedMaterial.albedoColor.elements},ud._setSkinnedMeshRenderSharedMaterialAlbedo=function(uW,uj,ut){var ud,ub;if(uW){var uE=uW.transform._entity;uE&&((ub=(ud=uE.owner.skinnedMeshRender.material).albedoColor).elements=ut,ud.albedoColor=ub)}else(ub=(ud=uj.skinnedMeshRender.material).albedoColor).elements=ut,ud.albedoColor=ub},ud._getParticleRenderSharedMaterialTintColor=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.particleRender.sharedMaterial.tintColor.elements:null}return uj.particleRender.sharedMaterial.tintColor.elements},ud._setParticleRenderSharedMaterialTintColor=function(uW,uj,ut){var ud,ub;if(uW){var uE=uW.transform._entity;uE&&((ub=(ud=uE.owner.particleRender.material).tintColor).elements=ut,ud.tintColor=ub)}else(ub=(ud=uj.particleRender.material).tintColor).elements=ut,ud.tintColor=ub},ud._getMeshRenderSharedMaterialAlphaColor=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.alphaColor.elements:null}return uj.meshRender.sharedMaterial.alphaColor.elements},ud._setMeshRenderSharedMaterialAlphaColor=function(uW,uj,ut){var ud,ub;if(uW){var uE=uW.transform._entity;uE&&((ub=(ud=uE.owner.meshRender.material).alphaColor).elements=ut,ud.alphaColor=ub)}else(ub=(ud=uj.meshRender.material).alphaColor).elements=ut,ud.alphaColor=ub},ud._getMeshRenderSharedMaterialBaseColor=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.baseColor.elements:null}return uj.meshRender.sharedMaterial.baseColor.elements},ud._setMeshRenderSharedMaterialBaseColor=function(uW,uj,ut){var ud,ub;if(uW){var uE=uW.transform._entity;uE&&((ub=(ud=uE.owner.meshRender.material).baseColor).elements=ut,ud.baseColor=ub)}else(ub=(ud=uj.meshRender.material).baseColor).elements=ut,ud.baseColor=ub},ud._getMeshRenderSharedMaterialDissolve=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.dissolve:0}return uj.meshRender.sharedMaterial.dissolve},ud._setMeshRenderSharedMaterialDissolve=function(uW,uj,ut){if(uW){var ud=uW.transform._entity;ud&&(ud.owner.meshRender.material.dissolve=ut[0])}else uj.meshRender.material.dissolve=ut[0]},ud._getMeshRenderSharedMaterialDissolveSpeed=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.dissolveSpeed:0}return uj.meshRender.sharedMaterial.dissolveSpeed},ud._setMeshRenderSharedMaterialDissolveSpeed=function(uW,uj,ut){if(uW){var ud=uW.transform._entity;ud&&(ud.owner.meshRender.material.dissolveSpeed=ut[0])}else uj.meshRender.material.dissolveSpeed=ut[0]},ud._getMeshRenderSharedMaterialMMultiplier=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.mMultiplier:0}return uj.meshRender.sharedMaterial.mMultiplier},ud._setMeshRenderSharedMaterialMMultiplier=function(uW,uj,ut){if(uW){var ud=uW.transform._entity;ud&&(ud.owner.meshRender.material.mMultiplier=ut[0])}else uj.meshRender.material.mMultiplier=ut[0]},ud._getMeshRenderSharedMaterialBaseScrollSpeedX=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return uj.meshRender.sharedMaterial.baseScrollSpeedX},ud._setMeshRenderSharedMaterialBaseScrollSpeedX=function(uW,uj,ut){if(uW){var ud=uW.transform._entity;ud&&(ud.owner.meshRender.material.baseScrollSpeedX=ut[0])}else uj.meshRender.material.baseScrollSpeedX=ut[0]},ud._getMeshRenderSharedMaterialBaseScrollSpeedY=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return uj.meshRender.sharedMaterial.baseScrollSpeedY},ud._setMeshRenderSharedMaterialBaseScrollSpeedY=function(uW,uj,ut){if(uW){var ud=uW.transform._entity;ud&&(ud.owner.meshRender.material.baseScrollSpeedY=ut[0])}else uj.meshRender.material.baseScrollSpeedY=ut[0]},ud._getMeshRenderSharedMaterialSecondScrollSpeedX=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return uj.meshRender.sharedMaterial.secondScrollSpeedX},ud._setMeshRenderSharedMaterialSecondScrollSpeedX=function(uW,uj,ut){if(uW){var ud=uW.transform._entity;ud&&(ud.owner.meshRender.material.secondScrollSpeedX=ut[0])}else uj.meshRender.material.secondScrollSpeedX=ut[0]},ud._getMeshRenderSharedMaterialSecondScrollSpeedY=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return uj.meshRender.sharedMaterial.secondScrollSpeedY},ud._setMeshRenderSharedMaterialSecondScrollSpeedY=function(uW,uj,ut){if(uW){var ud=uW.transform._entity;ud&&(ud.owner.meshRender.material.secondScrollSpeedY=ut[0])}else uj.meshRender.material.secondScrollSpeedY=ut[0]},ud._getMeshRenderSharedMaterialAlpha=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.alpha:0}return uj.meshRender.sharedMaterial.alpha},ud._setMeshRenderSharedMaterialAlpha=function(uW,uj,ut){if(uW){var ud=uW.transform._entity;ud&&(ud.owner.meshRender.material.alpha=ut[0])}else uj.meshRender.material.alpha=ut[0]},ud._getMeshRenderSharedMaterialIntensity=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.intensity:0}return uj.meshRender.sharedMaterial.intensity},ud._setMeshRenderSharedMaterialIntensity=function(uW,uj,ut){if(uW){var ud=uW.transform._entity;ud&&(ud.owner.meshRender.material.intensity=ut[0])}else uj.meshRender.material.intensity=ut[0]},ud._getMeshRenderSharedMaterialDetailTilingOffset=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return uj.meshRender.sharedMaterial.detailTilingOffset.elements},ud._setMeshRenderSharedMaterialDetailTilingOffset=function(uW,uj,ut){var ud,ub;if(uW){var uE=uW.transform._entity;uE&&((ub=(ud=uE.owner.meshRender.material).detailTilingOffset).elements=ut,ud.detailTilingOffset=ub)}else(ub=(ud=uj.meshRender.material).detailTilingOffset).elements=ut,ud.detailTilingOffset=ub},ud._getMeshRenderSharedMaterialDissolveTilingOffset=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return uj.meshRender.sharedMaterial.dissolveTilingOffset.elements},ud._setMeshRenderSharedMaterialDissolveTilingOffset=function(uW,uj,ut){var ud,ub;if(uW){var uE=uW.transform._entity;uE&&((ub=(ud=uE.owner.meshRender.material).dissolveTilingOffset).elements=ut,ud.dissolveTilingOffset=ub)}else(ub=(ud=uj.meshRender.material).dissolveTilingOffset).elements=ut,ud.dissolveTilingOffset=ub},ud._getMeshRenderSharedMaterialMaskTilingOffset=function(uW,uj){if(uW){var ut=uW.transform._entity;return ut?ut.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return uj.meshRender.sharedMaterial.maskTilingOffset.elements},ud._setMeshRenderSharedMaterialMaskTilingOffset=function(uW,uj,ut){var ud,ub;if(uW){var uE=uW.transform._entity;uE&&((ub=(ud=uE.owner.meshRender.material).maskTilingOffset).elements=ut,ud.maskTilingOffset=ub)}else(ub=(ud=uj.meshRender.material).maskTilingOffset).elements=ut,ud.maskTilingOffset=ub},ud._propertyIDCounter=0,ud._propertyIndexDic={},ud._propertySetFuncs=[],ud._propertyGetFuncs=[],ud}(),ug=function(){function uW(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return uT(uW,"laya.d3.animation.Keyframe"),uW}(),uf=function(){function uW(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return uT(uW,"laya.d3.animation.KeyframeNode"),uW}(),uv=(function(){function uW(){this._tempVector30=new uOj,this._tempVector31=new uOj,this._tempVector32=new uOj,this._a=new uOj,this._b=new uOj,this._c=new uOj,this._d=new uOj}uT(uW,"laya.d3.core.glitter.SplineCurvePositionVelocity");var uj=uW.prototype;uj.Init=function(uW,uj,ut,ud){uW.cloneTo(this._d),uj.cloneTo(this._c),uOj.scale(uW,2,this._a),uOj.scale(ut,2,this._tempVector30),uOj.subtract(this._a,this._tempVector30,this._a),uOj.add(this._a,uj,this._a),uOj.add(this._a,ud,this._a),uOj.scale(ut,3,this._b),uOj.scale(uW,3,this._tempVector30),uOj.subtract(this._b,this._tempVector30,this._b),uOj.subtract(this._b,ud,this._b),uOj.scale(uj,2,this._tempVector30),uOj.subtract(this._b,this._tempVector30,this._b)},uj.Slerp=function(uW,uj){uOj.scale(this._a,uW*uW*uW,this._tempVector30),uOj.scale(this._b,uW*uW,this._tempVector31),uOj.scale(this._c,uW,this._tempVector32),uOj.add(this._tempVector30,this._tempVector31,uj),uOj.add(uj,this._tempVector32,uj),uOj.add(uj,this._d,uj)}}(),function(){function uD(uW,uj,ut,ud){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=uW,this._h=uj,this._minHeight=ut,this._maxHeight=ud}uT(uD,"laya.d3.core.HeightMap");var uW=uD.prototype;uW._inBounds=function(uW,uj){return 0<=uW&&uW<this._h&&0<=uj&&uj<this._w},uW.getHeight=function(uW,uj){return this._inBounds(uW,uj)?this._datas[uW][uj]:NaN},u$(0,uW,"width",function(){return this._w}),u$(0,uW,"height",function(){return this._h}),u$(0,uW,"maxHeight",function(){return this._maxHeight}),u$(0,uW,"minHeight",function(){return this._minHeight}),uD.creatFromMesh=function(uW,uj,ut,ud){for(var ub=[],uE=[],uO=uW.getSubMeshCount(),uq=0;uq<uO;uq++){for(var uA=uW.getSubMesh(uq),uc=uA._getVertexBuffer(),uR=uc.getData(),um=[],uQ=0;uQ<uR.length;uQ+=uc.vertexDeclaration.vertexStride/4){var uT=new uOj(uR[uQ+0],uR[uQ+1],uR[uQ+2]);um.push(uT)}ub.push(um);var u$=uA._getIndexBuffer();uE.push(u$.getData())}var ue=uW.boundingBox,uK=ue.min.x,uo=ue.min.z,uS=ue.max.x,uM=ue.max.z,uZ=ue.min.y,uX=ue.max.y,u_=uS-uK,uN=uM-uo,uz=ud.elements[0]=u_/(uj-1),uC=ud.elements[1]=uN/(ut-1),uL=new uD(uj,ut,uZ,uX),uV=uD._tempRay,ux=uV.direction.elements;ux[0]=0,ux[1]=-1,ux[2]=0;var uG=uX+.1;uV.origin.elements[1]=uG;for(var ul=0;ul<ut;ul++){var uh=uo+ul*uC;uL._datas[ul]=[];for(var uv=0;uv<uj;uv++){var uy=uK+uv*uz,ua=uV.origin.elements;ua[0]=uy,ua[2]=uh;var uu=uD._getPosition(uV,ub,uE);uL._datas[ul][uv]=uu===Number.MAX_VALUE?NaN:uG-uu}}return uL},uD.createFromImage=function(uW,uj,ut){for(var ud=uW.width,ub=uW.height,uE=new uD(ud,ub,uj,ut),uO=(ut-uj)/254,uq=uW.getPixels(),uA=0,uc=0;uc<ub;uc++)for(var uR=uE._datas[uc]=[],um=0;um<ud;um++){var uQ=uq[uA++],uT=uq[uA++],u$=uq[uA++],ue=uq[uA++];uR[um]=255==uQ&&255==uT&&255==u$&&255==ue?NaN:(uQ+uT+u$)/3*uO+uj}return uE},uD._getPosition=function(uW,uj,ut){for(var ud=Number.MAX_VALUE,ub=0;ub<uj.length;ub++)for(var uE=uj[ub],uO=ut[ub],uq=0;uq<uO.length;uq+=3){var uA=uE[uO[uq+0]],uc=uE[uO[uq+1]],uR=uE[uO[uq+2]],um=u$j.rayIntersectsTriangle(uW,uA,uc,uR);!isNaN(um)&&um<ud&&(ud=um)}return ud},um(uD,["_tempRay",function(){return this._tempRay=new ubj(new uOj,new uOj)}])}(),function(){function ub(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}uT(ub,"laya.d3.core.Layer");var uW=ub.prototype;return uW._binarySearchIndex=function(){for(var uW=0,uj=ub._collsionTestList.length-1,ut=0;uW<=uj;){ut=Math.floor((uW+uj)/2);var ud=ub._collsionTestList[ut];if(ud==this._number)return ut;ud>this._number?uj=ut-1:uW=ut+1}return uW},uW._addCollider=function(uW){0===this._colliders.length&&ub._collsionTestList.splice(this._binarySearchIndex(),0,this._number),uW._isRigidbody?(this._colliders.unshift(uW),this._nonRigidbodyOffset++):this._colliders.push(uW)},uW._removeCollider=function(uW){var uj=this._colliders.indexOf(uW);uj<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(uj,1),0===this._colliders.length&&ub._collsionTestList.splice(ub._collsionTestList.indexOf(this._number),1)},u$(0,uW,"number",function(){return this._number}),u$(0,uW,"visible",function(){return this._visible},function(uW){this._visible=uW,ub._visibleLayers=uW?ub._visibleLayers|this.mask:ub._visibleLayers&~this.mask}),u$(0,uW,"mask",function(){return this._mask}),u$(1,ub,"visibleLayers",function(){return ub._visibleLayers},function(uW){ub._visibleLayers=uW;for(var uj=0,ut=ub._layerList.length;uj<ut;uj++){var ud=ub._layerList[uj];ud._visible=0!=(ud._mask&ub._visibleLayers)}}),ub.__init__=function(){ub._layerList.length=31;for(var uW=0;uW<31;uW++){var uj=new ub;ub._layerList[uW]=uj,0===uW?(uj.name="Default Layer",uj.visible=!0):(uj.name="Layer-"+uW,uj.visible=!1),uj._number=uW,uj._mask=Math.pow(2,uW)}ub.currentCreationLayer=ub._layerList[0]},ub.getLayerByNumber=function(uW){if(uW<0||30<uW)throw new Error("无法返回指定Layer，该number超出范围！");return ub._layerList[uW]},ub.getLayerByName=function(uW){for(var uj=0;uj<31;uj++)if(ub._layerList[uj].name===uW)return ub._layerList[uj];throw new Error("无法返回指定Layer,该name不存在")},ub.isVisible=function(uW){return 0!=(uW&ub._currentCameraCullingMask&ub._visibleLayers)},ub._layerList=[],ub._visibleLayers=2147483647,ub._collsionTestList=[],ub._currentCameraCullingMask=2147483647,ub.maxCount=31,ub.currentCreationLayer=null,ub}()),uy=(function(){function uW(uW,uj,ut){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=uW,this._minCount=uj,this._maxCount=ut}uT(uW,"laya.d3.core.particleShuriKen.module.Burst");var uj=uW.prototype;uX.imps(uj,{"laya.d3.core.IClone":!0}),uj.cloneTo=function(uW){var uj=uW;uj._time=this._time,uj._minCount=this._minCount,uj._maxCount=this._maxCount},uj.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uj,"time",function(){return this._time}),u$(0,uj,"minCount",function(){return this._minCount}),u$(0,uj,"maxCount",function(){return this._maxCount})}(),function(){function uW(uW){this._color=null,this.enbale=!1,this._color=uW}uT(uW,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var uj=uW.prototype;uj.cloneTo=function(uW){var uj=uW;this._color.cloneTo(uj._color),uj.enbale=this.enbale},uj.clone=function(){var uW;switch(this._color.type){case 0:uW=uu.createByConstant(this._color.constant.clone());break;case 1:uW=uu.createByGradient(this._color.gradient.clone());break;case 2:uW=uu.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:uW=uu.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var uj=new this.constructor(uW);return uj.enbale=this.enbale,uj},u$(0,uj,"color",function(){return this._color})}(),function(){function uW(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}uT(uW,"laya.d3.core.particleShuriKen.module.Emission");var uj=uW.prototype;uX.imps(uj,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),uj._destroy=function(){this._bursts=null,this._destroyed=!0},uj.getBurstsCount=function(){return this._bursts.length},uj.getBurstByIndex=function(uW){return this._bursts[uW]},uj.addBurst=function(uW){var uj=this._bursts.length;if(0<uj)for(var ut=0;ut<uj;ut++)this._bursts[ut].time>uW.time&&this._bursts.splice(ut,0,uW);this._bursts.push(uW)},uj.removeBurst=function(uW){var uj=this._bursts.indexOf(uW);-1!==uj&&this._bursts.splice(uj,1)},uj.removeBurstByIndex=function(uW){this._bursts.splice(uW,1)},uj.clearBurst=function(){this._bursts.length=0},uj.cloneTo=function(uW){var uj=uW,ut=uj._bursts;ut.length=this._bursts.length;for(var ud=0,ub=this._bursts.length;ud<ub;ud++){var uE=ut[ud];uE?this._bursts[ud].cloneTo(uE):ut[ud]=this._bursts[ud].clone()}uj._emissionRate=this._emissionRate,uj.enbale=this.enbale},uj.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uj,"destroyed",function(){return this._destroyed}),u$(0,uj,"emissionRate",function(){return this._emissionRate},function(uW){if(uW<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=uW})}(),function(){function ud(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}uT(ud,"laya.d3.core.particleShuriKen.module.FrameOverTime");var uW=ud.prototype;return uX.imps(uW,{"laya.d3.core.IClone":!0}),uW.cloneTo=function(uW){var uj=uW;uj._type=this._type,uj._constant=this._constant,this._overTime.cloneTo(uj._overTime),uj._constantMin=this._constantMin,uj._constantMax=this._constantMax,this._overTimeMin.cloneTo(uj._overTimeMin),this._overTimeMax.cloneTo(uj._overTimeMax)},uW.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uW,"frameOverTimeData",function(){return this._overTime}),u$(0,uW,"constant",function(){return this._constant}),u$(0,uW,"type",function(){return this._type}),u$(0,uW,"frameOverTimeDataMin",function(){return this._overTimeMin}),u$(0,uW,"constantMin",function(){return this._constantMin}),u$(0,uW,"frameOverTimeDataMax",function(){return this._overTimeMax}),u$(0,uW,"constantMax",function(){return this._constantMax}),ud.createByConstant=function(uW){var uj=new ud;return uj._type=0,uj._constant=uW,uj},ud.createByOverTime=function(uW){var uj=new ud;return uj._type=1,uj._overTime=uW,uj},ud.createByRandomTwoConstant=function(uW,uj){var ut=new ud;return ut._type=2,ut._constantMin=uW,ut._constantMax=uj,ut},ud.createByRandomTwoOverTime=function(uW,uj){var ut=new ud;return ut._type=3,ut._overTimeMin=uW,ut._overTimeMax=uj,ut},ud}()),ua=function(){function uc(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}uT(uc,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var uW=uc.prototype;return uX.imps(uW,{"laya.d3.core.IClone":!0}),uW.cloneTo=function(uW){var uj=uW;uj._type=this._type,uj._separateAxes=this._separateAxes,uj._constant=this._constant,this._constantSeparate.cloneTo(uj._constantSeparate),this._gradient.cloneTo(uj._gradient),this._gradientX.cloneTo(uj._gradientX),this._gradientY.cloneTo(uj._gradientY),this._gradientZ.cloneTo(uj._gradientZ),uj._constantMin=this._constantMin,uj._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(uj._constantMinSeparate),this._constantMaxSeparate.cloneTo(uj._constantMaxSeparate),this._gradientMin.cloneTo(uj._gradientMin),this._gradientMax.cloneTo(uj._gradientMax),this._gradientXMin.cloneTo(uj._gradientXMin),this._gradientXMax.cloneTo(uj._gradientXMax),this._gradientYMin.cloneTo(uj._gradientYMin),this._gradientYMax.cloneTo(uj._gradientYMax),this._gradientZMin.cloneTo(uj._gradientZMin),this._gradientZMax.cloneTo(uj._gradientZMax)},uW.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uW,"gradientZ",function(){return this._gradientZ}),u$(0,uW,"constant",function(){return this._constant}),u$(0,uW,"gradient",function(){return this._gradient}),u$(0,uW,"separateAxes",function(){return this._separateAxes}),u$(0,uW,"type",function(){return this._type}),u$(0,uW,"constantSeparate",function(){return this._constantSeparate}),u$(0,uW,"gradientX",function(){return this._gradientX}),u$(0,uW,"gradientY",function(){return this._gradientY}),u$(0,uW,"gradientW",function(){return this._gradientW}),u$(0,uW,"gradientMin",function(){return this._gradientMin}),u$(0,uW,"constantMin",function(){return this._constantMin}),u$(0,uW,"gradientMax",function(){return this._gradientMax}),u$(0,uW,"constantMax",function(){return this._constantMax}),u$(0,uW,"gradientWMin",function(){return this._gradientWMin}),u$(0,uW,"constantMinSeparate",function(){return this._constantMinSeparate}),u$(0,uW,"constantMaxSeparate",function(){return this._constantMaxSeparate}),u$(0,uW,"gradientXMin",function(){return this._gradientXMin}),u$(0,uW,"gradientXMax",function(){return this._gradientXMax}),u$(0,uW,"gradientWMax",function(){return this._gradientWMax}),u$(0,uW,"gradientYMin",function(){return this._gradientYMin}),u$(0,uW,"gradientYMax",function(){return this._gradientYMax}),u$(0,uW,"gradientZMin",function(){return this._gradientZMin}),u$(0,uW,"gradientZMax",function(){return this._gradientZMax}),uc.createByConstant=function(uW){var uj=new uc;return uj._type=0,uj._separateAxes=!1,uj._constant=uW,uj},uc.createByConstantSeparate=function(uW){var uj=new uc;return uj._type=0,uj._separateAxes=!0,uj._constantSeparate=uW,uj},uc.createByGradient=function(uW){var uj=new uc;return uj._type=1,uj._separateAxes=!1,uj._gradient=uW,uj},uc.createByGradientSeparate=function(uW,uj,ut,ud){var ub=new uc;return ub._type=1,ub._separateAxes=!0,ub._gradientX=uW,ub._gradientY=uj,ub._gradientZ=ut,ub._gradientW=ud,ub},uc.createByRandomTwoConstant=function(uW,uj){var ut=new uc;return ut._type=2,ut._separateAxes=!1,ut._constantMin=uW,ut._constantMax=uj,ut},uc.createByRandomTwoConstantSeparate=function(uW,uj){var ut=new uc;return ut._type=2,ut._separateAxes=!0,ut._constantMinSeparate=uW,ut._constantMaxSeparate=uj,ut},uc.createByRandomTwoGradient=function(uW,uj){var ut=new uc;return ut._type=3,ut._separateAxes=!1,ut._gradientMin=uW,ut._gradientMax=uj,ut},uc.createByRandomTwoGradientSeparate=function(uW,uj,ut,ud,ub,uE,uO,uq){var uA=new uc;return uA._type=3,uA._separateAxes=!0,uA._gradientXMin=uW,uA._gradientXMax=uj,uA._gradientYMin=ut,uA._gradientYMax=ud,uA._gradientZMin=ub,uA._gradientZMax=uE,uA._gradientWMin=uO,uA._gradientWMax=uq,uA},uc}(),uu=function(){function ud(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}uT(ud,"laya.d3.core.particleShuriKen.module.GradientColor");var uW=ud.prototype;return uX.imps(uW,{"laya.d3.core.IClone":!0}),uW.cloneTo=function(uW){var uj=uW;uj._type=this._type,this._constant.cloneTo(uj._constant),this._constantMin.cloneTo(uj._constantMin),this._constantMax.cloneTo(uj._constantMax),this._gradient.cloneTo(uj._gradient),this._gradientMin.cloneTo(uj._gradientMin),this._gradientMax.cloneTo(uj._gradientMax)},uW.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uW,"gradient",function(){return this._gradient}),u$(0,uW,"constant",function(){return this._constant}),u$(0,uW,"type",function(){return this._type}),u$(0,uW,"gradientMin",function(){return this._gradientMin}),u$(0,uW,"constantMin",function(){return this._constantMin}),u$(0,uW,"gradientMax",function(){return this._gradientMax}),u$(0,uW,"constantMax",function(){return this._constantMax}),ud.createByConstant=function(uW){var uj=new ud;return uj._type=0,uj._constant=uW,uj},ud.createByGradient=function(uW){var uj=new ud;return uj._type=1,uj._gradient=uW,uj},ud.createByRandomTwoConstant=function(uW,uj){var ut=new ud;return ut._type=2,ut._constantMin=uW,ut._constantMax=uj,ut},ud.createByRandomTwoGradient=function(uW,uj){var ut=new ud;return ut._type=3,ut._gradientMin=uW,ut._gradientMax=uj,ut},ud}(),uD=(function(){function uW(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}uT(uW,"laya.d3.core.particleShuriKen.module.GradientDataColor");var uj=uW.prototype;uX.imps(uj,{"laya.d3.core.IClone":!0}),uj.addAlpha=function(uW,uj){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==uW&&(uW=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=uW,this._alphaElements[this._alphaCurrentLength++]=uj):DEBUG},uj.addRGB=function(uW,uj){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==uW&&(uW=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=uW,this._rgbElements[this._rgbCurrentLength++]=uj.x,this._rgbElements[this._rgbCurrentLength++]=uj.y,this._rgbElements[this._rgbCurrentLength++]=uj.z):DEBUG},uj.cloneTo=function(uW){var uj=uW,ut=0,ud=0;uj._alphaCurrentLength=this._alphaCurrentLength;var ub=uj._alphaElements;for(ub.length=this._alphaElements.length,ut=0,ud=this._alphaElements.length;ut<ud;ut++)ub[ut]=this._alphaElements[ut];uj._rgbCurrentLength=this._rgbCurrentLength;var uE=uj._rgbElements;for(uE.length=this._rgbElements.length,ut=0,ud=this._rgbElements.length;ut<ud;ut++)uE[ut]=this._rgbElements[ut]},uj.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uj,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),u$(0,uj,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function uW(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}uT(uW,"laya.d3.core.particleShuriKen.module.GradientDataInt");var uj=uW.prototype;uX.imps(uj,{"laya.d3.core.IClone":!0}),uj.add=function(uW,uj){this._currentLength<8?(6===this._currentLength&&1!==uW&&(uW=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=uW,this._elements[this._currentLength++]=uj):console.log("Warning:data count must lessEqual than 4")},uj.cloneTo=function(uW){var uj=uW;uj._currentLength=this._currentLength;var ut=uj._elements;ut.length=this._elements.length;for(var ud=0,ub=this._elements.length;ud<ub;ud++)ut[ud]=this._elements[ud]},uj.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uj,"gradientCount",function(){return this._currentLength/2})}(),function(){function uW(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}uT(uW,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var uj=uW.prototype;uX.imps(uj,{"laya.d3.core.IClone":!0}),uj.add=function(uW,uj){this._currentLength<8?(6===this._currentLength&&1!==uW&&(uW=1,DEBUG),this._elements[this._currentLength++]=uW,this._elements[this._currentLength++]=uj):DEBUG},uj.getKeyByIndex=function(uW){return this._elements[2*uW]},uj.getValueByIndex=function(uW){return this._elements[2*uW+1]},uj.getAverageValue=function(){for(var uW=0,uj=this._currentLength-2;uW<uj;uW+=2){this._elements[uW+1];this._elements[uW+3],this._elements[uW+2]-this._elements[uW]}return 0},uj.cloneTo=function(uW){var uj=uW;uj._currentLength=this._currentLength;var ut=uj._elements;ut.length=this._elements.length;for(var ud=0,ub=this._elements.length;ud<ub;ud++)ut[ud]=this._elements[ud]},uj.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uj,"gradientCount",function(){return this._currentLength/2})}(),function(){function uW(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}uT(uW,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var uj=uW.prototype;uX.imps(uj,{"laya.d3.core.IClone":!0}),uj.add=function(uW,uj){this._currentLength<8?(6===this._currentLength&&1!==uW&&(uW=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=uW,this._elements[this._currentLength++]=uj.x,this._elements[this._currentLength++]=uj.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},uj.cloneTo=function(uW){var uj=uW;uj._currentLength=this._currentLength;var ut=uj._elements;ut.length=this._elements.length;for(var ud=0,ub=this._elements.length;ud<ub;ud++)ut[ud]=this._elements[ud]},uj.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uj,"gradientCount",function(){return this._currentLength/3})}(),function(){function uq(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}uT(uq,"laya.d3.core.particleShuriKen.module.GradientSize");var uW=uq.prototype;return uX.imps(uW,{"laya.d3.core.IClone":!0}),uW.getMaxSizeInGradient=function(){var uW=0,uj=0,ut=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(uW=0,uj=this._gradientX.gradientCount;uW<uj;uW++)ut=Math.max(ut,this._gradientX.getValueByIndex(uW));for(uW=0,uj=this._gradientY.gradientCount;uW<uj;uW++)ut=Math.max(ut,this._gradientY.getValueByIndex(uW))}else for(uW=0,uj=this._gradient.gradientCount;uW<uj;uW++)ut=Math.max(ut,this._gradient.getValueByIndex(uW));break;case 1:ut=this._separateAxes?(ut=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),ut=Math.max(ut,this._constantMinSeparate.y),Math.max(ut,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(uW=0,uj=this._gradientXMin.gradientCount;uW<uj;uW++)ut=Math.max(ut,this._gradientXMin.getValueByIndex(uW));for(uW=0,uj=this._gradientXMax.gradientCount;uW<uj;uW++)ut=Math.max(ut,this._gradientXMax.getValueByIndex(uW));for(uW=0,uj=this._gradientYMin.gradientCount;uW<uj;uW++)ut=Math.max(ut,this._gradientYMin.getValueByIndex(uW));for(uW=0,uj=this._gradientZMax.gradientCount;uW<uj;uW++)ut=Math.max(ut,this._gradientZMax.getValueByIndex(uW))}else{for(uW=0,uj=this._gradientMin.gradientCount;uW<uj;uW++)ut=Math.max(ut,this._gradientMin.getValueByIndex(uW));for(uW=0,uj=this._gradientMax.gradientCount;uW<uj;uW++)ut=Math.max(ut,this._gradientMax.getValueByIndex(uW))}}return ut},uW.cloneTo=function(uW){var uj=uW;uj._type=this._type,uj._separateAxes=this._separateAxes,this._gradient.cloneTo(uj._gradient),this._gradientX.cloneTo(uj._gradientX),this._gradientY.cloneTo(uj._gradientY),this._gradientZ.cloneTo(uj._gradientZ),uj._constantMin=this._constantMin,uj._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(uj._constantMinSeparate),this._constantMaxSeparate.cloneTo(uj._constantMaxSeparate),this._gradientMin.cloneTo(uj._gradientMin),this._gradientMax.cloneTo(uj._gradientMax),this._gradientXMin.cloneTo(uj._gradientXMin),this._gradientXMax.cloneTo(uj._gradientXMax),this._gradientYMin.cloneTo(uj._gradientYMin),this._gradientYMax.cloneTo(uj._gradientYMax),this._gradientZMin.cloneTo(uj._gradientZMin),this._gradientZMax.cloneTo(uj._gradientZMax)},uW.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uW,"gradientZ",function(){return this._gradientZ}),u$(0,uW,"gradient",function(){return this._gradient}),u$(0,uW,"separateAxes",function(){return this._separateAxes}),u$(0,uW,"type",function(){return this._type}),u$(0,uW,"gradientMin",function(){return this._gradientMin}),u$(0,uW,"constantMin",function(){return this._constantMin}),u$(0,uW,"gradientX",function(){return this._gradientX}),u$(0,uW,"gradientY",function(){return this._gradientY}),u$(0,uW,"gradientMax",function(){return this._gradientMax}),u$(0,uW,"constantMax",function(){return this._constantMax}),u$(0,uW,"constantMinSeparate",function(){return this._constantMinSeparate}),u$(0,uW,"constantMaxSeparate",function(){return this._constantMaxSeparate}),u$(0,uW,"gradientXMin",function(){return this._gradientXMin}),u$(0,uW,"gradientXMax",function(){return this._gradientXMax}),u$(0,uW,"gradientYMin",function(){return this._gradientYMin}),u$(0,uW,"gradientYMax",function(){return this._gradientYMax}),u$(0,uW,"gradientZMin",function(){return this._gradientZMin}),u$(0,uW,"gradientZMax",function(){return this._gradientZMax}),uq.createByGradient=function(uW){var uj=new uq;return uj._type=0,uj._separateAxes=!1,uj._gradient=uW,uj},uq.createByGradientSeparate=function(uW,uj,ut){var ud=new uq;return ud._type=0,ud._separateAxes=!0,ud._gradientX=uW,ud._gradientY=uj,ud._gradientZ=ut,ud},uq.createByRandomTwoConstant=function(uW,uj){var ut=new uq;return ut._type=1,ut._separateAxes=!1,ut._constantMin=uW,ut._constantMax=uj,ut},uq.createByRandomTwoConstantSeparate=function(uW,uj){var ut=new uq;return ut._type=1,ut._separateAxes=!0,ut._constantMinSeparate=uW,ut._constantMaxSeparate=uj,ut},uq.createByRandomTwoGradient=function(uW,uj){var ut=new uq;return ut._type=2,ut._separateAxes=!1,ut._gradientMin=uW,ut._gradientMax=uj,ut},uq.createByRandomTwoGradientSeparate=function(uW,uj,ut,ud,ub,uE){var uO=new uq;return uO._type=2,uO._separateAxes=!0,uO._gradientXMin=uW,uO._gradientXMax=uj,uO._gradientYMin=ut,uO._gradientYMax=ud,uO._gradientZMin=ub,uO._gradientZMax=uE,uO},uq}()),us=function(){function uq(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}uT(uq,"laya.d3.core.particleShuriKen.module.GradientVelocity");var uW=uq.prototype;return uX.imps(uW,{"laya.d3.core.IClone":!0}),uW.cloneTo=function(uW){var uj=uW;uj._type=this._type,this._constant.cloneTo(uj._constant),this._gradientX.cloneTo(uj._gradientX),this._gradientY.cloneTo(uj._gradientY),this._gradientZ.cloneTo(uj._gradientZ),this._constantMin.cloneTo(uj._constantMin),this._constantMax.cloneTo(uj._constantMax),this._gradientXMin.cloneTo(uj._gradientXMin),this._gradientXMax.cloneTo(uj._gradientXMax),this._gradientYMin.cloneTo(uj._gradientYMin),this._gradientYMax.cloneTo(uj._gradientYMax),this._gradientZMin.cloneTo(uj._gradientZMin),this._gradientZMax.cloneTo(uj._gradientZMax)},uW.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uW,"gradientZ",function(){return this._gradientZ}),u$(0,uW,"constant",function(){return this._constant}),u$(0,uW,"type",function(){return this._type}),u$(0,uW,"gradientXMax",function(){return this._gradientXMax}),u$(0,uW,"constantMin",function(){return this._constantMin}),u$(0,uW,"gradientX",function(){return this._gradientX}),u$(0,uW,"gradientY",function(){return this._gradientY}),u$(0,uW,"gradientXMin",function(){return this._gradientXMin}),u$(0,uW,"constantMax",function(){return this._constantMax}),u$(0,uW,"gradientYMin",function(){return this._gradientYMin}),u$(0,uW,"gradientYMax",function(){return this._gradientYMax}),u$(0,uW,"gradientZMin",function(){return this._gradientZMin}),u$(0,uW,"gradientZMax",function(){return this._gradientZMax}),uq.createByConstant=function(uW){var uj=new uq;return uj._type=0,uj._constant=uW,uj},uq.createByGradient=function(uW,uj,ut){var ud=new uq;return ud._type=1,ud._gradientX=uW,ud._gradientY=uj,ud._gradientZ=ut,ud},uq.createByRandomTwoConstant=function(uW,uj){var ut=new uq;return ut._type=2,ut._constantMin=uW,ut._constantMax=uj,ut},uq.createByRandomTwoGradient=function(uW,uj,ut,ud,ub,uE){var uO=new uq;return uO._type=3,uO._gradientXMin=uW,uO._gradientXMax=uj,uO._gradientYMin=ut,uO._gradientYMax=ud,uO._gradientZMin=ub,uO._gradientZMax=uE,uO},uq}(),uY=(function(){function uW(uW){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=uW}uT(uW,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var uj=uW.prototype;uX.imps(uj,{"laya.d3.core.IClone":!0}),uj.cloneTo=function(uW){var uj=uW;this._angularVelocity.cloneTo(uj._angularVelocity),uj.enbale=this.enbale},uj.clone=function(){var uW;switch(this._angularVelocity.type){case 0:uW=this._angularVelocity.separateAxes?ua.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):ua.createByConstant(this._angularVelocity.constant);break;case 1:uW=this._angularVelocity.separateAxes?ua.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):ua.createByGradient(this._angularVelocity.gradient.clone());break;case 2:uW=this._angularVelocity.separateAxes?ua.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):ua.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:uW=this._angularVelocity.separateAxes?ua.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):ua.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var uj=new this.constructor(uW);return uj.enbale=this.enbale,uj},u$(0,uj,"angularVelocity",function(){return this._angularVelocity})}(),function(){function uW(){this.enable=!1,this.randomDirection=!1}uT(uW,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.core.IClone":!0}),uj._getShapeBoundBox=function(uW){throw new Error("BaseShape: must override it.")},uj._getSpeedBoundBox=function(uW){throw new Error("BaseShape: must override it.")},uj.generatePositionAndDirection=function(uW,uj,ut,ud){throw new Error("BaseShape: must override it.")},uj._calculateProceduralBounds=function(uW,uj,ut){this._getShapeBoundBox(uW);var ud=uW.min,ub=uW.max;uOj.multiply(ud,uj,ud),uOj.multiply(ub,uj,ub);var uE=new uBW(new uOj,new uOj);this.randomDirection?(uE.min=new uOj(-1,-1,-1),uE.max=new uOj(1,1,1)):this._getSpeedBoundBox(uE);var uO=new uBW(new uOj,new uOj),uq=uO.min,uA=uO.max;uOj.scale(uE.min,ut.y,uq),uOj.scale(uE.max,ut.y,uA),uOj.add(uW.min,uq,uq),uOj.add(uW.max,uA,uA),uOj.min(uW.min,uq,uW.min),uOj.max(uW.max,uq,uW.max);var uc=new uBW(new uOj,new uOj),uR=uc.min,um=uc.max;uOj.scale(uE.min,ut.x,uR),uOj.scale(uE.max,ut.x,um),uOj.min(uc.min,um,uq),uOj.max(uc.min,um,uA),uOj.min(uW.min,uq,uW.min),uOj.max(uW.max,uq,uW.max)},uj.cloneTo=function(uW){uW.enable=this.enable},uj.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},uW}()),uw=function(){function uE(){}return uT(uE,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),uE._randomPointUnitArcCircle=function(uW,uj,ut){var ud=uj.elements,ub=NaN;ub=ut?ut.getFloat()*uW:Math.random()*uW,ud[0]=Math.cos(ub),ud[1]=Math.sin(ub)},uE._randomPointInsideUnitArcCircle=function(uW,uj,ut){var ud=uj.elements;uE._randomPointUnitArcCircle(uW,uj,ut);var ub=NaN;ub=ut?Math.pow(ut.getFloat(),.5):Math.pow(Math.random(),.5),ud[0]=ud[0]*ub,ud[1]=ud[1]*ub},uE._randomPointUnitCircle=function(uW,uj){var ut=uW.elements,ud=NaN;ud=uj?uj.getFloat()*Math.PI*2:Math.random()*Math.PI*2,ut[0]=Math.cos(ud),ut[1]=Math.sin(ud)},uE._randomPointInsideUnitCircle=function(uW,uj){var ut=uW.elements;uE._randomPointUnitCircle(uW);var ud=NaN;ud=uj?Math.pow(uj.getFloat(),.5):Math.pow(Math.random(),.5),ut[0]=ut[0]*ud,ut[1]=ut[1]*ud},uE._randomPointUnitSphere=function(uW,uj){var ut=uW.elements,ud=NaN,ub=NaN;ub=uj?(ud=ut[2]=2*uj.getFloat()-1,uj.getFloat()*Math.PI*2):(ud=ut[2]=2*Math.random()-1,Math.random()*Math.PI*2);var uE=Math.sqrt(1-ud*ud);ut[0]=uE*Math.cos(ub),ut[1]=uE*Math.sin(ub)},uE._randomPointInsideUnitSphere=function(uW,uj){var ut=uW.elements;uE._randomPointUnitSphere(uW);var ud=NaN;ud=uj?Math.pow(uj.getFloat(),1/3):Math.pow(Math.random(),1/3),ut[0]=ut[0]*ud,ut[1]=ut[1]*ud,ut[2]=ut[2]*ud},uE._randomPointInsideHalfUnitBox=function(uW,uj){var ut=uW.elements;uj?(ut[0]=uj.getFloat()-.5,ut[1]=uj.getFloat()-.5,ut[2]=uj.getFloat()-.5):(ut[0]=Math.random()-.5,ut[1]=Math.random()-.5,ut[2]=Math.random()-.5)},uE}(),uU=(function(){function uW(uW){this._size=null,this.enbale=!1,this._size=uW}uT(uW,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var uj=uW.prototype;uX.imps(uj,{"laya.d3.core.IClone":!0}),uj.cloneTo=function(uW){var uj=uW;this._size.cloneTo(uj._size),uj.enbale=this.enbale},uj.clone=function(){var uW;switch(this._size.type){case 0:uW=this._size.separateAxes?uD.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):uD.createByGradient(this._size.gradient.clone());break;case 1:uW=this._size.separateAxes?uD.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):uD.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:uW=this._size.separateAxes?uD.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):uD.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var uj=new this.constructor(uW);return uj.enbale=this.enbale,uj},u$(0,uj,"size",function(){return this._size})}(),function(){function ud(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}uT(ud,"laya.d3.core.particleShuriKen.module.StartFrame");var uW=ud.prototype;return uX.imps(uW,{"laya.d3.core.IClone":!0}),uW.cloneTo=function(uW){var uj=uW;uj._type=this._type,uj._constant=this._constant,uj._constantMin=this._constantMin,uj._constantMax=this._constantMax},uW.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uW,"constant",function(){return this._constant}),u$(0,uW,"type",function(){return this._type}),u$(0,uW,"constantMin",function(){return this._constantMin}),u$(0,uW,"constantMax",function(){return this._constantMax}),ud.createByConstant=function(uW){var uj=new ud;return uj._type=0,uj._constant=uW,uj},ud.createByRandomTwoConstant=function(uW,uj){var ut=new ud;return ut._type=1,ut._constantMin=uW,ut._constantMax=uj,ut},ud}()),uJ=(function(){function uW(uW,uj){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new uEj(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=uW,this._startFrame=uj}uT(uW,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var uj=uW.prototype;uX.imps(uj,{"laya.d3.core.IClone":!0}),uj.cloneTo=function(uW){var uj=uW;this.tiles.cloneTo(uj.tiles),uj.type=this.type,uj.randomRow=this.randomRow,this._frame.cloneTo(uj._frame),this._startFrame.cloneTo(uj._startFrame),uj.cycles=this.cycles,uj.enableUVChannels=this.enableUVChannels,uj.enable=this.enable},uj.clone=function(){var uW,uj;switch(this._frame.type){case 0:uW=uy.createByConstant(this._frame.constant);break;case 1:uW=uy.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:uW=uy.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:uW=uy.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:uj=uU.createByConstant(this._startFrame.constant);break;case 1:uj=uU.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var ut=new this.constructor(uW,uj);return this.tiles.cloneTo(ut.tiles),ut.type=this.type,ut.randomRow=this.randomRow,ut.cycles=this.cycles,ut.enableUVChannels=this.enableUVChannels,ut.enable=this.enable,ut},u$(0,uj,"frame",function(){return this._frame}),u$(0,uj,"startFrame",function(){return this._startFrame})}(),function(){function uW(uW){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=uW}uT(uW,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var uj=uW.prototype;uX.imps(uj,{"laya.d3.core.IClone":!0}),uj.cloneTo=function(uW){var uj=uW;this._velocity.cloneTo(uj._velocity),uj.enbale=this.enbale,uj.space=this.space},uj.clone=function(){var uW;switch(this._velocity.type){case 0:uW=us.createByConstant(this._velocity.constant.clone());break;case 1:uW=us.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:uW=us.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:uW=us.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var uj=new this.constructor(uW);return uj.enbale=this.enbale,uj.space=this.space,uj},u$(0,uj,"velocity",function(){return this._velocity})}(),function(){function uW(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new uQj,this._vb=uYj.create(uW._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=usj.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=uuj.nameKey.getID("LINE"),this._shaderCompile=uzj._preCompileShader[this._sharderNameID]}uT(uW,"laya.d3.core.PhasorSpriter3D");var uj=uW.prototype;return uj.line=function(uW,uj,ut,ud){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(uW.x,uW.y,uW.z,uj.x,uj.y,uj.z,uj.w),this.addVertex(ut.x,ut.y,ut.z,ud.x,ud.y,ud.z,ud.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},uj.circle=function(uW,uj,ut,ud,ub,uE){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*uj,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/uj,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*uW,Math.cos(this._tempNumver0)*uW,0,ut,ud,ub,uE),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},uj.plane=function(uW,uj,ut,ud,ub,uE,uO,uq,uA){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=ud/2,this._tempNumver1=ub/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(uW-this._tempNumver0,uj+this._tempNumver1,ut,uE,uO,uq,uA),this.addVertex(uW+this._tempNumver0,uj+this._tempNumver1,ut,uE,uO,uq,uA),this.addVertex(uW-this._tempNumver0,uj-this._tempNumver1,ut,uE,uO,uq,uA),this.addVertex(uW+this._tempNumver0,uj-this._tempNumver1,ut,uE,uO,uq,uA),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},uj.box=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=ud/2,this._tempNumver1=ub/2,this._tempNumver2=uE/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(uW-this._tempNumver0,uj+this._tempNumver1,ut+this._tempNumver2,uO,uq,uA,uc),this.addVertex(uW+this._tempNumver0,uj+this._tempNumver1,ut+this._tempNumver2,uO,uq,uA,uc),this.addVertex(uW-this._tempNumver0,uj-this._tempNumver1,ut+this._tempNumver2,uO,uq,uA,uc),this.addVertex(uW+this._tempNumver0,uj-this._tempNumver1,ut+this._tempNumver2,uO,uq,uA,uc),this.addVertex(uW+this._tempNumver0,uj+this._tempNumver1,ut-this._tempNumver2,uO,uq,uA,uc),this.addVertex(uW-this._tempNumver0,uj+this._tempNumver1,ut-this._tempNumver2,uO,uq,uA,uc),this.addVertex(uW+this._tempNumver0,uj-this._tempNumver1,ut-this._tempNumver2,uO,uq,uA,uc),this.addVertex(uW-this._tempNumver0,uj-this._tempNumver1,ut-this._tempNumver2,uO,uq,uA,uc),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},uj.cone=function(uW,uj,ut,ud,ub,uE,uO){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*ut+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*ut>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/ut,this.addVertexIndex(0,uj,0,ud,ub,uE,uO,this._tempUint0),this.addVertexIndex(0,0,0,ud,ub,uE,uO,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<ut;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(uW*this._tempNumver2,0,uW*this._tempNumver3,ud,ub,uE,uO,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==ut-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(uW*this._tempNumver2,0,uW*this._tempNumver3,ud,ub,uE,uO,this._tempUint0+(this._tempInt0+ut)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==ut-1?this.addIndexes(this._tempUint1+ut+2):this.addIndexes(this._tempUint1+this._tempInt0+ut+1),this.addIndexes(this._tempUint1+this._tempInt0+ut),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},uj.boundingBoxLine=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(uW,ub,uE,uO,uq,uA,uc),this.addVertex(ud,ub,uE,uO,uq,uA,uc),this.addVertex(uW,uj,uE,uO,uq,uA,uc),this.addVertex(ud,uj,uE,uO,uq,uA,uc),this.addVertex(ud,ub,ut,uO,uq,uA,uc),this.addVertex(uW,ub,ut,uO,uq,uA,uc),this.addVertex(ud,uj,ut,uO,uq,uA,uc),this.addVertex(uW,uj,ut,uO,uq,uA,uc),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},uj.addVertex=function(uW,uj,ut,ud,ub,uE,uO){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=uW,this._vbData[this._posInVBData+1]=uj,this._vbData[this._posInVBData+2]=ut,this._vbData[this._posInVBData+3]=ud,this._vbData[this._posInVBData+4]=ub,this._vbData[this._posInVBData+5]=uE,this._vbData[this._posInVBData+6]=uO,this._posInVBData+=this._floatSizePerVer,this},uj.addVertexIndex=function(uW,uj,ut,ud,ub,uE,uO,uq){return this._hasBegun||this.addVertexIndexException(),this._vbData[uq]=uW,this._vbData[uq+1]=uj,this._vbData[uq+2]=ut,this._vbData[uq+3]=ud,this._vbData[uq+4]=ub,this._vbData[uq+5]=uE,this._vbData[uq+6]=uO,(uq+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=uq),this},uj.addIndexes=function(uW){var uj=arguments;this._hasBegun||this.addVertexIndexException();for(var ut=0;ut<uj.length;ut++)this._ibData[this._posInIBData]=uj[ut],this._posInIBData++;return this},uj.begin=function(uW,uj){return this._hasBegun&&this.beginException0(),1!==uW&&4!==uW&&this.beginException1(),this._primitiveType=uW,this._camera=uj,this._hasBegun=!0,this},uj.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},uj.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(uW._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),uz.drawCall++,uG.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},uj.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},uj.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},uj.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},uj.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},uj.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},uj.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(28,[new uOW(0,"vector3",0),new uOW(12,"vector4",1)])}]),uW}()),ur=function(){function uW(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++uW._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new uQj}uT(uW,"laya.d3.core.render.RenderElement");var uj=uW.prototype;return uj.getDynamicBatchBakedVertexs=function(uW){for(var uj=this._renderObj._getVertexBuffer(uW),ut=uj.getData().slice(),ud=uj.vertexDeclaration,ub=ud.getVertexElementByUsage(0).offset/4,uE=ud.getVertexElementByUsage(3).offset/4,uO=this._sprite3D.transform,uq=uO.worldMatrix,uA=uO.rotation,uc=ud.vertexStride/4,uR=0,um=ut.length;uR<um;uR+=uc){var uQ=uR+ub,uT=uR+uE;uKj.transformVector3ArrayToVector3ArrayCoordinate(ut,uQ,uq,ut,uQ),uKj.transformVector3ArrayByQuat(ut,uT,uA,ut,uT)}return ut},uj.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},uj._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},u$(0,uj,"id",function(){return this._id}),u$(0,uj,"renderObj",function(){return this._renderObj},function(uW){this._renderObj!==uW&&(this._renderObj=uW)}),uW._uniqueIDCounter=0,uW}(),uP=function(){function uj(uW){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++uj._uniqueIDCounter,this._needSort=!1,this._scene=uW,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}uT(uj,"laya.d3.core.render.RenderQueue");var uW=uj.prototype;return uW._sortOpaqueFunc=function(uW,uj){if(uW._render&&uj._render){var ut=uW._material.renderQueue-uj._material.renderQueue;return 0==ut?uW._render._distanceForSort-uj._render._distanceForSort:ut}return 0},uW._sortAlphaFunc=function(uW,uj){if(uW._render&&uj._render){var ut=uW._material.renderQueue-uj._material.renderQueue;return 0==ut?uj._render._distanceForSort-uW._render._distanceForSort:ut}return 0},uW._begainRenderElement=function(uW,uj,ut){return!!uj._beforeRender(uW)},uW._sortAlpha=function(uW){uj._cameraPosition=uW,this._finalElements.sort(this._sortAlphaFunc)},uW._sortOpaque=function(uW){uj._cameraPosition=uW,this._finalElements.sort(this._sortOpaqueFunc)},uW._preRender=function(uW){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},uW._render=function(uW,uj){for(var ut,ud,ub,uE,uO,uq,uA=uz.loopCount,uc=this._scene,uR=uW.camera,um=(uR.id,!1),uQ=0,uT=this._finalElements.length;uQ<uT;uQ++){var u$,ue,uK,uo=this._finalElements[uQ];if(null!=uo._onPreRenderFunction&&uo._onPreRenderFunction.call(uo._sprite3D,uW),0===uo._type){if(uW.owner=uK=uo._sprite3D,uW.renderElement=uo,uK._preRenderUpdateComponents(uW),u$=uo.renderObj,ue=uo._material,this._begainRenderElement(uW,u$,ue)){if(ut=u$._getVertexBuffers(),!(ub=(ud=u$._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[ud.id]){this._errorRecord[ud.id]=1;var uS="vertexBuffer:"+("("+ud._destroyed+","+ud._released+","+ud._referenceCount+","+ud._buffer+")")+", material:"+(ue?ue.__className+"("+ue._destroyed+","+ue._released+")":"null")+", owner:"+(uK?uK.__className+"("+uK._destroyed+","+uK._activeInHierarchy+","+uK._displayedInStage+")":"null")+", renderObj:"+(u$?u$.__className+"("+u$._destroyed+","+u$._released+","+u$._referenceCount+")":"")+", parent:, url:"+(uK?uK.url:"")+", disposeStack:"+ud.disposeStack;uX.recordError("报错：unknown vertexDeclaration  "+uS)}continue}if(um=(uE=uW._shader=ue._getShader(uc._shaderDefineValue,ub.shaderDefineValue,uK._shaderDefineValue)).bind()||uA!==uE._uploadLoopCount,ut){if(uE._uploadVertexBuffer!==ut||um){for(var uM=0;uM<ut.length;uM++){var uZ=ut[uM];uE.uploadAttributesX(uZ.vertexDeclaration.shaderValues.data,uZ)}uE._uploadVertexBuffer=ut}}else(uE._uploadVertexBuffer!==ud||um)&&(uE.uploadAttributes(ub.shaderValues.data,null),uE._uploadVertexBuffer=ud);(uE._uploadScene!==uc||um)&&(uE.uploadSceneUniforms(uc._shaderValues.data),uE._uploadScene=uc),(uR!==uE._uploadCamera||uE._uploadSprite3D!==uK||um)&&(uE.uploadSpriteUniforms(uK._shaderValues.data),uE._uploadSprite3D=uK),(uR!==uE._uploadCamera||um)&&(uE.uploadCameraUniforms(uR._shaderValues.data),uE._uploadCamera=uR),(uE._uploadMaterial!==ue||um)&&(ue._upload(),uE._uploadMaterial=ue),uO!==ue?(ue._setRenderStateBlendDepth(),ue._setRenderStateFrontFace(uj,uK.transform),uO=ue,uq=uK):uq!==uK&&(ue._setRenderStateFrontFace(uj,uK.transform),uq=uK),u$._render(uW),uE._uploadLoopCount=uA}uK._postRenderUpdateComponents(uW)}else if(2===uo._type){uo.renderObj;uW.owner=uK=uo._sprite3D,uW.renderElement=uo,uW._batchIndexStart=uo._tempBatchIndexStart,uW._batchIndexEnd=uo._tempBatchIndexEnd,u$=uo.renderObj,ue=uo._material,this._begainRenderElement(uW,u$,ue)&&(ub=(ud=u$._getVertexBuffer(0)).vertexDeclaration,um=(uE=uW._shader=ue._getShader(uc._shaderDefineValue,ub.shaderDefineValue,uK._shaderDefineValue)).bind()||uA!==uE._uploadLoopCount,(uE._uploadVertexBuffer!==ud||um)&&(uE.uploadAttributes(ub.shaderValues.data,null),uE._uploadVertexBuffer=ud),(uE._uploadScene!==uc||um)&&(uE.uploadSceneUniforms(uc._shaderValues.data),uE._uploadScene=uc),(uR!==uE._uploadCamera||uE._uploadSprite3D!==uK||um)&&(uE.uploadSpriteUniforms(uK._shaderValues.data),uE._uploadSprite3D=uK),(uR!==uE._uploadCamera||um)&&(uE.uploadCameraUniforms(uR._shaderValues.data),uE._uploadCamera=uR),(uE._uploadMaterial!==ue||um)&&(ue._upload(),uE._uploadMaterial=ue),uO!==ue?(ue._setRenderStateBlendDepth(),ue._setRenderStateFrontFace(uj,uK.transform),uO=ue,uq=uK):uq!==uK&&(ue._setRenderStateFrontFace(uj,uK.transform),uq=uK),u$._render(uW),uE._uploadLoopCount=uA)}}},uW._renderShadow=function(uW,uj){for(var ut,ud,ub,uE,uO,uq=uz.loopCount,uA=this._scene,uc=uW.camera,uR=!1,um=0,uQ=this._finalElements.length;um<uQ;um++){var uT,u$,ue,uK=this._finalElements[um];0===uK._type&&(uW.owner=ue=uK._sprite3D,uj||ue._projectionViewWorldUpdateCamera===uc&&ue._projectionViewWorldUpdateLoopCount===uz.loopCount||(ue._render._renderUpdate(uW._projectionViewMatrix),ue._projectionViewWorldUpdateLoopCount=uz.loopCount,ue._projectionViewWorldUpdateCamera=uc),uW.renderElement=uK,ue._preRenderUpdateComponents(uW),uT=uK.renderObj,u$=uK._material,this._begainRenderElement(uW,uT,null)&&(ud=(ut=uT._getVertexBuffer(0)).vertexDeclaration,uR=(ub=uW._shader=u$._getShader(uA._shaderDefineValue,ud.shaderDefineValue,ue._shaderDefineValue)).bind()||uq!==ub._uploadLoopCount,(ub._uploadVertexBuffer!==ut||uR)&&(ub.uploadAttributes(ud.shaderValues.data,null),ub._uploadVertexBuffer=ut),(uc!==ub._uploadCamera||ub._uploadSprite3D!==ue||uR)&&(ub.uploadSpriteUniforms(ue._shaderValues.data),ub._uploadSprite3D=ue),(uc!==ub._uploadCamera||uR)&&(ub.uploadCameraUniforms(uc._shaderValues.data),ub._uploadCamera=uc),(ub._uploadMaterial!==u$||uR)&&(u$._upload(),ub._uploadMaterial=u$),ub._uploadRenderElement,uE!==u$?(u$._setRenderStateFrontFace(!1,ue.transform),uE=u$,uO=ue):uO!==ue&&(u$._setRenderStateFrontFace(!1,ue.transform),uO=ue),uT._render(uW),ub._uploadLoopCount=uq),ue._postRenderUpdateComponents(uW))}},uW._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},uW._addRenderElement=function(uW){this._renderElements.push(uW),this._needSort=!0},uW._addDynamicBatchElement=function(uW){this._dynamicBatchCombineRenderElements.push(uW)},u$(0,uW,"id",function(){return this._id}),uj._uniqueIDCounter=0,uj._cameraPosition=null,uj}(),ui=function(){function uW(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return uT(uW,"laya.d3.core.render.RenderState"),uW.clientWidth=0,uW.clientHeight=0,uW}(),uB=function(){function uO(uW,uj){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new ukW(new uOj,0),this._corners=[new uOj,new uOj,new uOj,new uOj,new uOj,new uOj,new uOj,new uOj],this._boundingBoxCenter=new uOj,this._children=ud(8),this._objects=[],this._tempBoundBoxCorners=[new uOj,new uOj,new uOj,new uOj,new uOj,new uOj,new uOj,new uOj],this._scene=uW,this._currentDepth=uj}uT(uO,"laya.d3.core.scene.OctreeNode");var uW=uO.prototype;return uX.imps(uW,{"laya.d3.core.scene.ITreeNode":!0}),uW.init=function(uW,uj){var ut=new uOj,ud=new uOj;uOj.scale(uj,-.5,ut),uOj.scale(uj,.5,ud),uOj.add(ut,uW,ut),uOj.add(ud,uW,ud),this.exactBox=new uBW(ut,ud),this.relaxBox=new uBW(ut,ud)},uW.addTreeNode=function(uW){1===Collision.boxContainsBox(this._relaxBox,uW.boundingBox)?this.addNodeDown(uW,0):this.addObject(uW)},uW.addChild=function(uW){var uj=this._children[uW];if(null==uj){uj=new uO(this._scene,this._currentDepth+1),(this._children[uW]=uj)._parent=this,uOj.subtract(this._exactBox.max,this._exactBox.min,uO.tempSize),uOj.multiply(uO.tempSize,uO._octreeSplit[uW],uO.tempCenter),uOj.add(this._exactBox.min,uO.tempCenter,uO.tempCenter),uOj.scale(uO.tempSize,.25,uO.tempSize);var ut=new uOj,ud=new uOj;uOj.subtract(uO.tempCenter,uO.tempSize,ut),uOj.add(uO.tempCenter,uO.tempSize,ud),uj.exactBox=new uBW(ut,ud),uOj.scale(uO.tempSize,uO.relax,uO.tempSize);var ub=new uOj,uE=new uOj;uOj.subtract(uO.tempCenter,uO.tempSize,ub),uOj.add(uO.tempCenter,uO.tempSize,uE),uj.relaxBox=new uBW(ub,uE)}return uj},uW.addObject=function(uW){(uW._treeNode=this)._objects.push(uW)},uW.removeObject=function(uW){if(uW._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var uj=this._objects.indexOf(uW);return-1!==uj&&(this._objects.splice(uj,1),!0)},uW.clearObject=function(){this._objects.length=0},uW.addNodeUp=function(uW,uj){this._parent&&1!==Collision.boxContainsBox(this._exactBox,uW.boundingBox)?this._parent.addNodeUp(uW,uj-1):this.addNodeDown(uW,uj)},uW.addNodeDown=function(uW,uj){if(uj<this._scene.treeLevel){var ut=this.inChildIndex(uW.boundingBoxCenter),ud=this.addChild(ut);1===Collision.boxContainsBox(ud._relaxBox,uW.boundingBox)?ud.addNodeDown(uW,++uj):this.addObject(uW)}else this.addObject(uW)},uW.inChildIndex=function(uW){return 4*(uW.z<this._boundingBoxCenter.z?0:1)+2*(uW.y<this._boundingBoxCenter.y?0:1)+(uW.x<this._boundingBoxCenter.x?0:1)},uW.updateObject=function(uW){1===Collision.boxContainsBox(this._relaxBox,uW.boundingBox)?(this.removeObject(uW),uW._treeNode=null,this.addNodeDown(uW,this._currentDepth)):this._parent&&(this.removeObject(uW),uW._treeNode=null,this._parent.addNodeUp(uW,this._currentDepth-1))},uW.cullingObjects=function(uW,uj,ut,ud,ub){var uE,uO=0,uq=0,uA=0,uc=this._scene._dynamicBatchManager;for(uO=0,uE=this._objects.length;uO<uE;uO++){var uR=this._objects[uO];if(uv.isVisible(uR._owner.layer.mask)&&uR.enable){if(uj&&(uz.treeSpriteCollision+=1,0===uW.containsBoundSphere(uR.boundingSphere)))continue;uR._renderUpdate(ub),uR._distanceForSort=uOj.distance(uR.boundingSphere.center,ud)+uR.sortingFudge;var um=uR._renderElements;for(uq=0,uA=um.length;uq<uA;uq++){var uQ=um[uq],uT=uQ._staticBatch;if(uT&&uT._material===uQ._material)uT._addBatchRenderElement(uQ);else{var u$=uQ.renderObj;u$.triangleCount<10&&1===u$._vertexBufferCount&&u$._getIndexBuffer()&&uQ._material.renderQueue<2&&uQ._canDynamicBatch&&!uR._owner.isStatic?uc._addPrepareRenderElement(uQ):this._scene.getRenderQueue(uQ._material.renderQueue)._addRenderElement(uQ)}}}}for(uO=0;uO<8;uO++){var ue=this._children[uO];if(null!=ue){var uK=uj;if(uj){var uo=uW.containsBoundBox(ue._relaxBox);if(uz.treeNodeCollision+=1,0===uo)continue;uK=2===uo}ue.cullingObjects(uW,uK,ut,ud,ub)}}},uW.cullingShadowObjects=function(uW,uj,ut,ud,ub){var uE,uO=0,uq=0,uA=0;this._scene._dynamicBatchManager;for(uO=0,uE=this._objects.length;uO<uE;uO++){var uc=this._objects[uO];if(uc.castShadow&&uv.isVisible(uc._owner.layer.mask)&&uc.enable){if(ut&&0===uW[0].containsBoundSphere(uc.boundingSphere))continue;for(var uR=1,um=uW.length;uR<um;uR++){var uQ=uj[uR-1];if(0!==uW[uR].containsBoundSphere(uc.boundingSphere)){var uT=uc._renderElements;for(uq=0,uA=uT.length;uq<uA;uq++)uQ._addRenderElement(uT[uq])}}}}for(uO=0;uO<8;uO++){var u$=this._children[uO];if(null!=u$){var ue=ut;if(ut){var uK=uW[0].containsBoundBox(u$._relaxBox);if(0===uK)continue;ue=2===uK}u$.cullingShadowObjects(uW,uj,ue,ud,ub)}}},uW.cullingShadowObjectsOnePSSM=function(uW,uj,ut,ud,ub,uE){var uO,uq=uj[0],uA=0,uc=0,uR=0;for(uA=0,uO=this._objects.length;uA<uO;uA++){var um=this._objects[uA];if(um.castShadow&&uv.isVisible(um._owner.layer.mask)&&um.enable){if(ud&&0===uW.containsBoundSphere(um.boundingSphere))continue;um._renderUpdate(ut);var uQ=um._renderElements;for(uc=0,uR=uQ.length;uc<uR;uc++)uq._addRenderElement(uQ[uc])}}for(uA=0;uA<8;uA++){var uT=this._children[uA];if(null!=uT){var u$=ud;if(ud){var ue=uW.containsBoundBox(uT._relaxBox);if(0===ue)continue;u$=2===ue}uT.cullingShadowObjectsOnePSSM(uW,uj,ut,u$,ub,uE)}}},uW.renderBoudingBox=function(uW){this._renderBoudingBox(uW);for(var uj=0;uj<8;++uj){var ut=this._children[uj];ut&&ut.renderBoudingBox(uW)}},uW.buildAllChild=function(uW){if(uW<this._scene.treeLevel)for(var uj=0;uj<8;uj++){this.addChild(uj).buildAllChild(uW+1)}},uW._renderBoudingBox=function(uW){},u$(0,uW,"exactBox",function(){return this._exactBox},function(uW){this._exactBox=uW,uOj.add(uW.min,uW.max,this._boundingBoxCenter),uOj.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),u$(0,uW,"relaxBox",function(){return this._relaxBox},function(uW){(this._relaxBox=uW).getCorners(this._corners),ukW.createfromPoints(this._corners,this._boundingSphere)}),uO.debugMode=!1,uO.relax=1.15,uO.CHILDNUM=8,um(uO,["tempVector0",function(){return this.tempVector0=new uOj},"tempSize",function(){return this.tempSize=new uOj},"tempCenter",function(){return this.tempCenter=new uOj},"_octreeSplit",function(){return this._octreeSplit=[new uOj(.25,.25,.25),new uOj(.75,.25,.25),new uOj(.25,.75,.25),new uOj(.75,.75,.25),new uOj(.25,.25,.75),new uOj(.75,.25,.75),new uOj(.25,.75,.75),new uOj(.75,.75,.75)]}]),uO}(),un=(function(){function uW(){}uT(uW,"laya.d3.core.scene.SceneManager")}(),function(){function uW(uW,uj,ut,ud){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===uW&&(uW=1),void 0===uj&&(uj=1),void 0===ut&&(ut=1),void 0===ud&&(ud=1),this._r=uW,this._g=uj,this._b=ut,this._a=ud}return uT(uW,"laya.d3.core.trail.module.Color",null,"Color$1"),uW.prototype.cloneTo=function(uW){uW._r=this._r,uW._g=this._g,uW._b=this._b,uW._a=this._a},um(uW,["RED",function(){return this.RED=new uW(1,0,0,1)},"GREEN",function(){return this.GREEN=new uW(0,1,0,1)},"BLUE",function(){return this.BLUE=new uW(0,0,1,1)},"CYAN",function(){return this.CYAN=new uW(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new uW(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new uW(1,0,1,1)},"GRAY",function(){return this.GRAY=new uW(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new uW(1,1,1,1)},"BLACK",function(){return this.BLACK=new uW(0,0,0,1)}]),uW}()),uk=(function(){function uW(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}uT(uW,"laya.d3.core.trail.module.Gradient");var uj=uW.prototype;uj.setKeys=function(uW,uj){var ut,ud;this._colorKeys=uW;for(var ub=this.index=0;ub<uW.length;ub++){var uE=(ut=uW[ub]).color;this._colorKeyData[this.index++]=uE._r,this._colorKeyData[this.index++]=uE._g,this._colorKeyData[this.index++]=uE._b,this._colorKeyData[this.index++]=ut.time}this._alphaKeys=uj;for(var uO=this.index=0;uO<uj.length;uO++)ud=uj[uO],this._alphaKeyData[this.index++]=ud.alpha,this._alphaKeyData[this.index++]=ud.time},uj.cloneTo=function(uW){var uj=0,ut=0,ud=this.colorKeys,ub=[];for(uj=0,ut=ud.length;uj<ut;uj++){var uE=new up;ud[uj].cloneTo(uE),ub.push(uE)}var uO=this.alphaKeys,uq=[];for(uj=0,ut=uO.length;uj<ut;uj++){var uA=new uk;uO[uj].cloneTo(uA),uq.push(uA)}uW.setKeys(ub,uq)},u$(0,uj,"mode",function(){return this._mode},function(uW){this._mode=uW}),u$(0,uj,"colorKeys",function(){return this._colorKeys},function(uW){this._colorKeys=uW;for(var uj=this.index=0;uj<uW.length;uj++){var ut=uW[uj],ud=ut.color;this._colorKeyData[this.index++]=ud._r,this._colorKeyData[this.index++]=ud._g,this._colorKeyData[this.index++]=ud._b,this._colorKeyData[this.index++]=ut.time}}),u$(0,uj,"alphaKeys",function(){return this._alphaKeys},function(uW){this._alphaKeys=uW;for(var uj=this.index=0;uj<uW.length;uj++){var ut=uW[uj];this._alphaKeyData[this.index++]=ut.alpha,this._alphaKeyData[this.index++]=ut.time}})}(),function(){function uW(uW,uj){this._alpha=NaN,this._time=NaN,void 0===uW&&(uW=0),void 0===uj&&(uj=0),this._alpha=uW,this._time=uj}uT(uW,"laya.d3.core.trail.module.GradientAlphaKey");var uj=uW.prototype;return uj.cloneTo=function(uW){uW.alpha=this.alpha,uW.time=this.time},u$(0,uj,"alpha",function(){return this._alpha},function(uW){this._alpha=uW}),u$(0,uj,"time",function(){return this._time},function(uW){this._time=uW}),uW}()),up=function(){function uW(uW,uj){this._color=null,this._time=NaN,void 0===uj&&(uj=0),this._color=uW||new un,this._time=uj}uT(uW,"laya.d3.core.trail.module.GradientColorKey");var uj=uW.prototype;return uj.cloneTo=function(uW){this.color.cloneTo(uW.color),uW.time=this.time},u$(0,uj,"color",function(){return this._color},function(uW){this._color=uW}),u$(0,uj,"time",function(){return this._time},function(uW){this._time=uW}),uW}(),uF=(function(){function uW(){}uT(uW,"laya.d3.core.trail.module.GradientMode"),uW.Blend=0,uW.Fixed=1}(),function(){function uW(){}uT(uW,"laya.d3.core.trail.module.TextureMode"),uW.Stretch=0,uW.Tile=1}(),function(){function uW(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}uT(uW,"laya.d3.core.trail.module.TrailKeyFrame"),uW.prototype.cloneTo=function(uW){uW.time=this.time,uW.inTangent=this.inTangent,uW.outTangent=this.outTangent,uW.value=this.value}}(),function(){function uj(uW){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new uOj,this._curPosition=new uOj,this._delVector3=new uOj,this._lastFixedVertexPosition=new uOj,this._pointAtoBVector3=new uOj,this._pointA=new uOj,this._pointB=new uOj,this._owner=uW,this._id=uj.renderElementCount++,0==this._id?uW._owner.transform.position.cloneTo(this._lastPosition):uW._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new uYj(uF.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new uYj(uF.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}uT(uj,"laya.d3.core.trail.TrailRenderElement");var uW=uj.prototype;uX.imps(uW,{"laya.d3.core.render.IRenderable":!0}),uW._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},uW._addTrailByFirstPosition=function(uW,uj){uOj.subtract(uj,uW,this._delVector3),uOj.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),uOj.normalize(this._pointAtoBVector3,this._pointAtoBVector3),uOj.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(uW),uW.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},uW._addTrailByNextPosition=function(uW){uOj.subtract(uW,this._lastFixedVertexPosition,this._delVector3),uOj.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),uOj.normalize(this._pointAtoBVector3,this._pointAtoBVector3),uOj.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=uOj.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=upW.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(uW),uW.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(uW),this._virtualVerticesCount=2)},uW._updateVerticesByPosition=function(uW){this._pointe=uW.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},uW._updateVertexBuffer2=function(){var uW,uj=0,ut=0,ud=0;for(ud=0,uW=(this._verticesCount+this._virtualVerticesCount)/2;ud<uW;ud++)ut=0==this._owner.textureMode?(this._VerticesToTailLength[ud]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[ud],this._vertices2[uj++]=1-ut,this._vertices2[uj++]=1-ut;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},uW._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},uW._updateDisappear=function(){var uW,uj=0;for(uj=this._curDisappearIndex,uW=(this._verticesCount+this._virtualVerticesCount)/2;uj<uW;uj++)this._owner._curtime-this._everyGroupVertexBirthTime[uj]>=this._owner.time+upW.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},uW._beforeRender=function(uW){return this._camera=uW.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),uOj.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},uW._render=function(uW){this._isDead||(uG.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),uz.drawCall++,uz.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},uW._getVertexBuffer=function(uW){return void 0===uW&&(uW=0),0===uW?this._vertexBuffer1:1===uW?this._vertexBuffer2:null},uW._getVertexBuffers=function(){return this._vertexBuffers},uW._getIndexBuffer=function(){return null},uW.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},uW._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},u$(0,uW,"_vertexBufferCount",function(){return this._vertexBuffers.length}),u$(0,uW,"triangleCount",function(){return 0}),uj.renderElementCount=0}(),function(){function uW(){}uT(uW,"laya.d3.core.trail.VertexTrail");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration1}),u$(1,uW,"vertexDeclaration1",function(){return uW._vertexDeclaration1}),u$(1,uW,"vertexDeclaration2",function(){return uW._vertexDeclaration2}),um(uW,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new uEW(32,[new uOW(0,"vector3",0),new uOW(12,"vector3",41),new uOW(24,"single",33),new uOW(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new uEW(4,[new uOW(0,"single",38)])}]),uW}()),uWW=function(){function uZ(uW){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=uW}uT(uZ,"laya.d3.graphics.DynamicBatch");var uW=uZ.prototype;return uX.imps(uW,{"laya.d3.core.render.IRenderable":!0}),uW._getVertexBuffer=function(uW){return void 0===uW&&(uW=0),0===uW?this._vertexBuffer:null},uW._getIndexBuffer=function(){return this._indexBuffer},uW._getCombineRenderElementFromPool=function(uW,uj,ut){var ud=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return ud||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=ud=new ur,ud._sprite3D=new uPj),ud._sprite3D._render._renderUpdate(ut),ud},uW._getRenderElement=function(uW,uj,ut){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*uZ.maxVertexCount),this._indexDatas=new Uint16Array(uZ.maxIndexCount),this._vertexBuffer=uYj.create(this._vertexDeclaration,uZ.maxVertexCount,35048),this._indexBuffer=usj.create("ushort",uZ.maxIndexCount,35048));for(var ud=this._merageElements.length=0,ub=0,uE=0,uO=this._combineRenderElements.length;uE<uO;uE++){var uq=this._combineRenderElements[uE],uA=uq.getDynamicBatchBakedVertexs(0),uc=uq.getBakedIndices(),uR=uq._sprite3D.transform._isFrontFaceInvert,um=ud/(this._vertexDeclaration.vertexStride/4),uQ=ub,uT=uQ+uc.length;uq._tempBatchIndexStart=uQ,uq._tempBatchIndexEnd=uT,this._indexDatas.set(uc,ub);var u$=0;if(uR)for(u$=uQ;u$<uT;u$+=3){this._indexDatas[u$]=um+this._indexDatas[u$];var ue=this._indexDatas[u$+1],uK=this._indexDatas[u$+2];this._indexDatas[u$+1]=um+uK,this._indexDatas[u$+2]=um+ue}else for(u$=uQ;u$<uT;u$+=3)this._indexDatas[u$]=um+this._indexDatas[u$],this._indexDatas[u$+1]=um+this._indexDatas[u$+1],this._indexDatas[u$+2]=um+this._indexDatas[u$+2];ub+=uc.length,this._vertexDatas.set(uA,ud),ud+=uA.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),uE=this._combineRenderElementPoolIndex=0,uO=this._materials.length;uE<uO;uE++){var uo=this._getCombineRenderElementFromPool(uW,uj,ut);uo._type=2,uo._staticBatch=null;var uS=(uo.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[uE]]._tempBatchIndexStart,uM=uE+1===this._materialToRenderElementsOffsets.length?ub:this._combineRenderElements[this._materialToRenderElementsOffsets[uE+1]]._tempBatchIndexStart;uo._tempBatchIndexStart=uS,uo._tempBatchIndexEnd=uM,uo._material=this._materials[uE],this._merageElements.push(uo)}},uW._addCombineRenderObjTest=function(uW){var uj=uW.renderObj,ut=this._currentCombineIndexCount+uj._getIndexBuffer().indexCount,ud=this._currentCombineVertexCount+uj._getVertexBuffer().vertexCount;return!(uZ.maxVertexCount<ud||uZ.maxIndexCount<ut)},uW._addCombineRenderObj=function(uW){var uj=uW.renderObj;this._combineRenderElements.push(uW),this._currentCombineIndexCount=this._currentCombineIndexCount+uj._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+uj._getVertexBuffer().vertexCount},uW._addCombineMaterial=function(uW){this._materials.push(uW)},uW._addMaterialToRenderElementOffset=function(uW){this._materialToRenderElementsOffsets.push(uW)},uW._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},uW._addToRenderQueue=function(uW,uj,ut,ud){this._getRenderElement(uj,ut,ud);for(var ub=0,uE=this._materials.length;ub<uE;ub++)uW.getRenderQueue(this._materials[ub].renderQueue)._addDynamicBatchElement(this._merageElements[ub])},uW._beforeRender=function(uW){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},uW._render=function(uW){var uj=uW._batchIndexEnd-uW._batchIndexStart;uG.mainContext.drawElements(4,uj,5123,2*uW._batchIndexStart),uz.drawCall++,uz.trianglesFaces+=uj/3},uW._getVertexBuffers=function(){return null},u$(0,uW,"_vertexBufferCount",function(){return 1}),u$(0,uW,"triangleCount",function(){return this._indexBuffer.indexCount/3}),u$(0,uW,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),uZ.maxVertexCount=2e4,uZ.maxIndexCount=4e4,uZ.maxCombineTriangleCount=10,uZ}(),ujW=function(){function uZ(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}uT(uZ,"laya.d3.graphics.DynamicBatchManager");var uW=uZ.prototype;return uW.getDynamicBatch=function(uW,uj){var ut,ud=uW.id.toString()+uj;return this._dynamicBatches[ud]?ut=this._dynamicBatches[ud]:this._dynamicBatches[ud]=ut=new uWW(uW),ut},uW._garbageCollection=function(){for(var uW in this._dynamicBatches)0===this._dynamicBatches[uW].combineRenderElementsCount&&delete this._dynamicBatches[uW]},uW._addPrepareRenderElement=function(uW){this._prepareDynamicBatchCombineElements.push(uW)},uW._finishCombineDynamicBatch=function(uW){var uj,ut,ud;this._prepareDynamicBatchCombineElements.sort(uZ._sortPrepareDynamicBatch);for(var ub,uE,uO,uq,uA,uc=-1,uR=!0,um=0,uQ=-1,uT=0,u$=this._prepareDynamicBatchCombineElements.length;uT<u$;uT++){var ue=(uE=this._prepareDynamicBatchCombineElements[uT]).renderObj._getVertexBuffer(0).vertexDeclaration,uK=ut!==ue;uK&&(um=0,ut=ue);var uo=um!==uc;if(uo&&(uc=um),(uK||uo)&&(uO=this.getDynamicBatch(ue,um),uj=null),uR)if(uO._addCombineRenderObjTest(uE)){if(uj!==(ub=uE._material))uq&&(uW.getRenderQueue(uA._material.renderQueue)._addRenderElement(uA),uA=uq=null,uQ=-1),uq=ub,uQ=uO.combineRenderElementsCount,uA=uE,uj=ub;else if(uq){var uS=uA.renderObj,uM=uE.renderObj;uS._getVertexBuffer().vertexCount+uM._getVertexBuffer().vertexCount>uWW.maxVertexCount||uS._getIndexBuffer().indexCount+uM._getIndexBuffer().indexCount>uWW.maxIndexCount?(uW.getRenderQueue(uA._material.renderQueue)._addRenderElement(uA),uq=ub,uQ=uO.combineRenderElementsCount,uA=uE):(uO._addCombineMaterial(uq),uO._addMaterialToRenderElementOffset(uQ),uO._addCombineRenderObj(uA),uA=uq=null,uQ=-1,uO._addCombineRenderObj(uE))}else uO._addCombineRenderObj(uE);uR=!0}else uq&&(uW.getRenderQueue(uA._material.renderQueue)._addRenderElement(uA),uA=uq=null,uQ=-1),um++,uR=!1;else ud=this._prepareDynamicBatchCombineElements[uT-1],uO._addMaterialToRenderElementOffset(uO.combineRenderElementsCount),uj=ud._material,uO._addCombineMaterial(uj),uO._addCombineRenderObj(ud),uR=!0,uj!==(ub=uE._material)?(uq=ub,uQ=uO.combineRenderElementsCount,uA=uE):uO._addCombineRenderObj(uE),uj=ub}uq&&(uW.getRenderQueue(uA._material.renderQueue)._addRenderElement(uA),uA=uq=null,uQ=-1),this._prepareDynamicBatchCombineElements.length=0},uW._clearRenderElements=function(){for(var uW in this._dynamicBatches)this._dynamicBatches[uW]._clearRenderElements()},uW._addToRenderQueue=function(uW,uj,ut,ud){for(var ub in this._dynamicBatches){var uE=this._dynamicBatches[ub];0<uE.combineRenderElementsCount&&uE._addToRenderQueue(uW,uj,ut,ud)}},uW.dispose=function(){this._dynamicBatches=null},uZ._sortPrepareDynamicBatch=function(uW,uj){return uW._mainSortID-uj._mainSortID},uZ}(),utW=function(){function uW(){}return uT(uW,"laya.d3.graphics.FrustumCulling"),uW.renderShadowObjectCulling=function(uW,uj,ut,ud,ub){var uE=0,uO=0,uq=0,uA=0;for(uE=0,uq=ut.length;uE<uq;uE++){var uc=ut[uE];uc&&uc._clearRenderElements()}var uR,um,uQ,uT=uW._cullingRenders;if(1<ub){for(uE=0,uq=uW._cullingRendersLength;uE<uq;uE++)if((uR=uT[uE]).castShadow&&uv.isVisible(uR._owner.layer.mask)&&uR.enable)for(var u$=1,ue=uj.length;u$<ue;u$++)if(um=ut[u$-1],0!==uj[u$].containsBoundSphere(uR.boundingSphere))for(uO=0,uA=(uQ=uR._renderElements).length;uO<uA;uO++)um._addRenderElement(uQ[uO])}else for(uE=0,uq=uW._cullingRendersLength;uE<uq;uE++)if((uR=uT[uE]).castShadow&&uv.isVisible(uR._owner.layer.mask)&&uR.enable&&0!==uj[0].containsBoundSphere(uR.boundingSphere))for(uR._renderUpdate(ud),um=ut[0],uO=0,uA=(uQ=uR._renderElements).length;uO<uA;uO++)um._addRenderElement(uQ[uO])},uW.renderShadowObjectCullingOctree=function(uW,uj,ut,ud,ub){for(var uE=0,uO=ut.length;uE<uO;uE++){var uq=ut[uE];uq&&uq._clearRenderElements()}1<ub?uW.treeRoot.cullingShadowObjects(uj,ut,!0,0,uW):uW.treeRoot.cullingShadowObjectsOnePSSM(uj[0],ut,ud,!0,0,uW)},uW.renderObjectCulling=function(uW,uj,ut,ud,ub,uE){var uO=0,uq=0,uA=0,uc=0,uR=uj._quenes,um=uj._dynamicBatchManager,uQ=uj._cullingRenders;for(uO=0,uq=uR.length;uO<uq;uO++){var uT=uR[uO];uT&&uT._clearRenderElements()}var u$=udW._staticBatchManagers;for(uO=0,uq=u$.length;uO<uq;uO++)u$[uO]._clearRenderElements();um._clearRenderElements();var ue=ut.transform.position;for(uO=0,uq=uj._cullingRendersLength;uO<uq;uO++){var uK=uQ[uO];if(uv.isVisible(uK._owner.layer.mask)&&uK.enable&&0!==uW.containsBoundSphere(uK.boundingSphere)&&uK._renderUpdate(uE)){uK._distanceForSort=uOj.distance(uK.boundingSphere.center,ue)+uK.sortingFudge;var uo=uK._renderElements;for(uA=0,uc=uo.length;uA<uc;uA++){var uS=uo[uA],uM=uS._staticBatch;if(uM&&uM._material===uS._material)uM._addBatchRenderElement(uS);else{var uZ=uS.renderObj;uZ.triangleCount<10&&1===uZ._vertexBufferCount&&uZ._getIndexBuffer()&&uS._material.renderQueue<2&&uS._canDynamicBatch&&!uK._owner.isStatic?um._addPrepareRenderElement(uS):uj.getRenderQueue(uS._material.renderQueue)._addRenderElement(uS)}}}}for(uO=0,uq=u$.length;uO<uq;uO++)u$[uO]._addToRenderQueue(uj,ud,ub,uE);um._finishCombineDynamicBatch(uj),um._addToRenderQueue(uj,ud,ub,uE)},uW.renderObjectCullingOctree=function(uW,uj,ut,ud,ub,uE){var uO=0,uq=0,uA=uj._quenes,uc=uj._dynamicBatchManager;for(uO=0,uq=uA.length;uO<uq;uO++){var uR=uA[uO];uR&&uR._clearRenderElements()}var um=udW._staticBatchManagers;for(uO=0,uq=um.length;uO<uq;uO++)um[uO]._clearRenderElements();for(uc._clearRenderElements(),uj._cullingRenders.length=0,uj.treeRoot.cullingObjects(uW,!0,0,ut.transform.position,uE),uO=0,uq=um.length;uO<uq;uO++)um[uO]._addToRenderQueue(uj,ud,ub,uE);uc._finishCombineDynamicBatch(uj),uc._addToRenderQueue(uj,ud,ub,uE)},uW.renderObjectCullingNoBoundFrustum=function(uW,uj,ut,ud,ub){var uE=0,uO=0,uq=0,uA=0,uc=uW._quenes,uR=uW._dynamicBatchManager,um=uW._cullingRenders;for(uE=0,uO=uc.length;uE<uO;uE++){var uQ=uc[uE];uQ&&uQ._clearRenderElements()}var uT=udW._staticBatchManagers;for(uE=0,uO=uT.length;uE<uO;uE++)uT[uE]._clearRenderElements();uR._clearRenderElements();var u$=uj.transform.position;for(uE=0,uO=uW._cullingRendersLength;uE<uO;uE++){var ue=um[uE];if(uv.isVisible(ue._owner.layer.mask)&&ue.enable){ue._renderUpdate(ub),ue._distanceForSort=uOj.distance(ue.boundingSphere.center,u$)+ue.sortingFudge;var uK=ue._renderElements;for(uq=0,uA=uK.length;uq<uA;uq++){var uo=uK[uq],uS=uo._staticBatch;if(uS&&uS._material===uo._material)uS._addBatchRenderElement(uo);else{var uM=uo.renderObj;uM.triangleCount<10&&1===uM._vertexBufferCount&&uM._getIndexBuffer()&&uo._material.renderQueue<2&&uo._canDynamicBatch&&!ue._owner.isStatic?uR._addPrepareRenderElement(uo):uW.getRenderQueue(uo._material.renderQueue)._addRenderElement(uo)}}}}for(uE=0,uO=uT.length;uE<uO;uE++)uT[uE]._addToRenderQueue(uW,ut,ud,ub);uR._finishCombineDynamicBatch(uW),uR._addToRenderQueue(uW,ut,ud,ub)},uW}(),udW=function(){function uE(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}uT(uE,"laya.d3.graphics.StaticBatchManager");var uW=uE.prototype;return uW._finishInit=function(){for(var uW in this._staticBatches)this._staticBatches[uW]._finishInit();this._initBatchRenderElements.length=0},uW._initStaticBatchs=function(uW){throw new Error("StaticBatchManager:must override this function.")},uW._addInitBatchSprite=function(uW){for(var uj=uW._render._renderElements,ut=0,ud=uj.length;ut<ud;ut++)this._initBatchRenderElements.push(uj[ut])},uW._clearRenderElements=function(){for(var uW in this._staticBatches)this._staticBatches[uW]._clearRenderElements()},uW._garbageCollection=function(uW){var uj=uW._staticBatch,ut=uj._initBatchRenderElements,ud=ut.indexOf(uW);ut.splice(ud,1),0===ut.length&&(uj.dispose(),delete this._staticBatches[uj._key])},uW._addToRenderQueue=function(uW,uj,ut,ud){for(var ub in this._staticBatches){var uE=this._staticBatches[ub];0<uE._batchRenderElements.length&&uE._updateToRenderQueue(uW,ud)}},uW.dispose=function(){this._staticBatches=null},uE._addToStaticBatchQueue=function(uW){uW instanceof laya.d3.core.RenderableSprite3D&&uW._addToInitStaticBatchManager();for(var uj=0,ut=uW.numChildren;uj<ut;uj++)uE._addToStaticBatchQueue(uW._childs[uj])},uE.combine=function(uW,uj){var ut,ud=0,ub=0;if(uj)for(ud=0,ub=uj.length;ud<ub;ud++){uj[ud]._addToInitStaticBatchManager()}else uW&&uE._addToStaticBatchQueue(uW);for(ud=0,ub=uE._staticBatchManagers.length;ud<ub;ud++)(ut=uE._staticBatchManagers[ud])._initStaticBatchs(uW),ut._finishInit()},uE._staticBatchManagers=[],uE}(),ubW=function(){function uW(uW,uj,ut){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=uW,this._manager=uj,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=ut}uT(uW,"laya.d3.graphics.StaticBatch");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),uj._binarySearch=function(uW){for(var uj=0,ut=this._batchRenderElements.length-1,ud=0;uj<=ut;)ud=Math.floor((uj+ut)/2),this._compareBatchRenderElement(this._batchRenderElements[ud],uW)?ut=ud-1:uj=ud+1;return uj},uj._compareBatchRenderElement=function(uW,uj){throw new Error("StaticBatch:must override this function.")},uj._getVertexDecLightMap=function(uW){return uW===usW.vertexDeclaration?uvW.vertexDeclaration:uW===uDW.vertexDeclaration?uhW.vertexDeclaration:uW===uCW.vertexDeclaration?uZW.vertexDeclaration:uW===ugW.vertexDeclaration?null:uW===ueW.vertexDeclaration?uKW.vertexDeclaration:uW===uHW.vertexDeclaration?uaW.vertexDeclaration:uW===uGW.vertexDeclaration?ulW.vertexDeclaration:uW===uYW.vertexDeclaration?uyW.vertexDeclaration:uW===uDW.vertexDeclaration?uhW.vertexDeclaration:uW===uLW.vertexDeclaration?uXW.vertexDeclaration:uW===ugW.vertexDeclaration?null:uW===ueW.vertexDeclaration?uKW.vertexDeclaration:uW===uIW.vertexDeclaration?uuW.vertexDeclaration:uW===uGW.vertexDeclaration?ulW.vertexDeclaration:uW},uj._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},uj._addBatchRenderElement=function(uW){this._batchRenderElements.splice(this._binarySearch(uW),0,uW)},uj._updateToRenderQueue=function(uW,uj){this._combineRenderElementPoolIndex=0,this._getRenderElement(uW.getRenderQueue(this._material.renderQueue)._renderElements,uW,uj)},uj._getRenderElement=function(uW,uj,ut){throw new Error("StaticBatch:must override this function.")},uj._finishInit=function(){throw new Error("StaticBatch:must override this function.")},uj._clearRenderElements=function(){this._batchRenderElements.length=0},uj.dispose=function(){},uj._getVertexBuffer=function(uW){return void 0===uW&&(uW=0),null},uj._getIndexBuffer=function(){return null},uj._beforeRender=function(uW){return!0},uj._render=function(uW){},uj._getVertexBuffers=function(){return null},u$(0,uj,"_vertexBufferCount",function(){return 1}),u$(0,uj,"triangleCount",function(){return 0}),uW.combine=function(uW){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),udW.combine(uW)},uW.maxBatchVertexCount=65535,uW}(),uEW=function(){function uO(uW,uj){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++uO._uniqueIDCounter,this._id>uO.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",uO.maxVertexDeclaration);this._shaderValues=new uQj,this._vertexElementsDic={},this._vertexStride=uW,this._vertexElements=uj;for(var ut=0;ut<uj.length;ut++){var ud=uj[ut],ub=ud.elementUsage;this._vertexElementsDic[ub]=ud;var uE=[uO._getTypeSize(ud.elementFormat)/4,5126,!1,this._vertexStride,ud.offset];switch(this._shaderValues.setValue(ub,uE),ub){case 1:this._addShaderDefine(uzj.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(uzj.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(uzj.SHADERDEFINE_UV1)}}}uT(uO,"laya.d3.graphics.VertexDeclaration");var uW=uO.prototype;return uW._addShaderDefine=function(uW){this._shaderDefineValue|=uW},uW._removeShaderDefine=function(uW){this._shaderDefineValue&=~uW},uW.getVertexElements=function(){return this._vertexElements.slice()},uW.getVertexElementByUsage=function(uW){return this._vertexElementsDic[uW]},uW.unBinding=function(){},u$(0,uW,"shaderDefineValue",function(){return this._shaderDefineValue}),u$(0,uW,"id",function(){return this._id}),u$(0,uW,"vertexStride",function(){return this._vertexStride}),u$(0,uW,"shaderValues",function(){return this._shaderValues}),uO._getTypeSize=function(uW){switch(uW){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},uO.getVertexStride=function(uW){for(var uj=0,ut=0;ut<uW.Length;ut++){var ud=uW[ut],ub=ud.offset+uO._getTypeSize(ud.elementFormat);uj<ub&&(uj=ub)}return uj},uO._maxVertexDeclarationBit=1e3,uO._uniqueIDCounter=1,um(uO,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),uO}(),uOW=function(){function uW(uW,uj,ut){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=uW,this.elementFormat=uj,this.elementUsage=ut}return uT(uW,"laya.d3.graphics.VertexElement"),uW}(),uqW=(function(){function uW(){}uT(uW,"laya.d3.graphics.VertexElementFormat"),uW.Single="single",uW.Vector2="vector2",uW.Vector3="vector3",uW.Vector4="vector4",uW.Color="color",uW.Byte4="byte4",uW.Short2="short2",uW.Short4="short4",uW.NormalizedShort2="normalizedshort2",uW.NormalizedShort4="normalizedshort4",uW.HalfVector2="halfvector2",uW.HalfVector4="halfvector4"}(),function(){function uW(){}uT(uW,"laya.d3.graphics.VertexElementUsage"),uW.POSITION0=0,uW.COLOR0=1,uW.TEXTURECOORDINATE0=2,uW.NORMAL0=3,uW.BINORMAL0=4,uW.TANGENT0=5,uW.BLENDINDICES0=6,uW.BLENDWEIGHT0=7,uW.DEPTH0=8,uW.FOG0=9,uW.POINTSIZE0=10,uW.SAMPLE0=11,uW.TESSELLATEFACTOR0=12,uW.COLOR1=13,uW.NEXTTEXTURECOORDINATE0=14,uW.TEXTURECOORDINATE1=15,uW.NEXTTEXTURECOORDINATE1=16,uW.CORNERTEXTURECOORDINATE0=17,uW.VELOCITY0=18,uW.STARTCOLOR0=19,uW.STARTSIZE=20,uW.AGEADDSCALE0=21,uW.STARTROTATION=22,uW.ENDCOLOR0=23,uW.STARTLIFETIME=24,uW.TIME0=33,uW.SHAPEPOSITIONSTARTLIFETIME=30,uW.DIRECTIONTIME=32,uW.SIZEROTATION0=27,uW.RADIUS0=28,uW.RADIAN0=29,uW.STARTSPEED=31,uW.RANDOM0=34,uW.RANDOM1=35,uW.SIMULATIONWORLDPOSTION=36,uW.SIMULATIONWORLDROTATION=37,uW.TEXTURECOORDINATE0X=38,uW.TEXTURECOORDINATE0X1=39,uW.TEXTURECOORDINATE0Y=40,uW.OFFSETVECTOR=41}(),function(){function uW(uW,uj,ut){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=uW,this._textureCoordinate0=uj,this._time=ut}uT(uW,"laya.d3.graphics.VertexGlitter");var uj=uW.prototype;uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate0}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"time",function(){return this._time}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(24,[new uOW(0,"vector3",0),new uOW(12,"vector2",2),new uOW(20,"single",33)])}])}(),function(){function uW(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=uW,this._position=uj,this._velocity=ut,this._startColor=ud,this._endColor=ub,this._sizeRotation=uE,this._radius=uO,this._radian=uq,this._ageAddScale=uA,this._time=uc}uT(uW,"laya.d3.graphics.VertexParticle");var uj=uW.prototype;uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"endColor",function(){return this._endColor}),u$(0,uj,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),u$(0,uj,"sizeRotation",function(){return this._sizeRotation}),u$(0,uj,"velocity",function(){return this._velocity}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"startColor",function(){return this._startColor}),u$(0,uj,"radius",function(){return this._radius}),u$(0,uj,"radian",function(){return this._radian}),u$(0,uj,"ageAddScale",function(){return this._ageAddScale}),u$(0,uj,"time",function(){return this._time}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(116,[new uOW(0,"vector4",17),new uOW(16,"vector3",0),new uOW(28,"vector3",18),new uOW(40,"vector4",19),new uOW(56,"vector4",23),new uOW(72,"vector3",27),new uOW(84,"vector2",28),new uOW(92,"vector4",29),new uOW(108,"single",24),new uOW(112,"single",33)])}])}(),function(){function uW(uW){this._position=null,this._position=uW}uT(uW,"laya.d3.graphics.VertexPosition");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(12,[new uOW(0,"vector3",0)])}]),uW}()),uAW=function(){function uW(uW,uj){this._position=null,this._normal=null,this._position=uW,this._normal=uj}uT(uW,"laya.d3.graphics.VertexPositionNormal");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(24,[new uOW(0,"vector3",0),new uOW(12,"vector3",3)])}]),uW}(),ucW=function(){function uW(uW,uj,ut){this._position=null,this._normal=null,this._color=null,this._position=uW,this._normal=uj,this._color=ut}uT(uW,"laya.d3.graphics.VertexPositionNormalColor");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(40,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1)])}]),uW}(),uRW=function(){function uW(uW,uj,ut,ud,ub){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=uW,this._normal=uj,this._color=ut,this._blendIndex=ud,this._blendWeight=ub}uT(uW,"laya.d3.graphics.VertexPositionNormalColorSkin");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(72,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector4",7),new uOW(56,"vector4",6)])}]),uW}(),umW=function(){function uW(uW,uj,ut,ud,ub,uE){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=uW,this._normal=uj,this._color=ut,this._tangent=ud,this._blendIndex=ub,this._blendWeight=uE}uT(uW,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(88,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector4",7),new uOW(56,"vector4",6),new uOW(72,"vector4",5)])}]),uW}(),uQW=function(){function uW(uW,uj,ut,ud,ub,uE){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=uW,this._normal=uj,this._color=ut,this._tangent=ud,this._blendIndex=ub,this._blendWeight=uE}uT(uW,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(84,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector4",7),new uOW(56,"vector4",6),new uOW(72,"vector3",5)])}]),uW}(),uTW=function(){function uW(uW,uj,ut,ud){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=uW,this._normal=uj,this._color=ut,this._tangent=ud}uT(uW,"laya.d3.graphics.VertexPositionNormalColorSTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(56,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector4",5)])}]),uW}(),u$W=function(){function uW(uW,uj,ut,ud){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=uW,this._normal=uj,this._color=ut,this._tangent=ud}uT(uW,"laya.d3.graphics.VertexPositionNormalColorTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(52,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector3",5)])}]),uW}(),ueW=function(){function uW(uW,uj,ut,ud){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=uW,this._normal=uj,this._color=ut,this._textureCoordinate=ud}uT(uW,"laya.d3.graphics.VertexPositionNormalColorTexture");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(48,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector2",2)])}]),uW}(),uKW=function(){function uW(uW,uj,ut,ud,ub){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=uW,this._normal=uj,this._color=ut,this._textureCoordinate0=ud,this._textureCoordinate1=ub}uT(uW,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(0,uj,"textureCoordinate1",function(){return this._textureCoordinate1}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(56,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector2",2),new uOW(48,"vector2",15)])}]),uW}(),uoW=function(){function uW(uW,uj,ut,ud,ub,uE,uO){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=uW,this._normal=uj,this._color=ut,this._textureCoordinate0=ud,this._textureCoordinate1=ub,this._blendIndex=uE,this._blendWeight=uO}uT(uW,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(0,uj,"textureCoordinate1",function(){return this._textureCoordinate1}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(88,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector2",2),new uOW(48,"vector2",15),new uOW(56,"vector4",7),new uOW(72,"vector4",6)])}]),uW}(),uSW=function(){function uW(uW,uj,ut,ud,ub,uE,uO,uq){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=uW,this._normal=uj,this._color=ut,this._textureCoordinate0=ud,this._textureCoordinate1=ub,this._tangent=uE,this._blendIndex=uO,this._blendWeight=uq}uT(uW,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(0,uj,"textureCoordinate1",function(){return this._textureCoordinate1}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(104,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector2",2),new uOW(48,"vector2",15),new uOW(56,"vector4",7),new uOW(72,"vector4",6),new uOW(88,"vector4",5)])}]),uW}(),uMW=function(){function uW(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}uT(uW,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),uj.VertexPositionNormalColorTexture0SkinTangent=function(uW,uj,ut,ud,ub,uE,uO,uq){this._position=uW,this._normal=uj,this._color=ut,this._textureCoordinate0=ud,this._textureCoordinate1=ub,this._tangent=uE,this._blendIndex=uO,this._blendWeight=uq},u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(0,uj,"textureCoordinate1",function(){return this._textureCoordinate1}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(100,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector2",2),new uOW(48,"vector2",15),new uOW(56,"vector4",7),new uOW(72,"vector4",6),new uOW(88,"vector3",5)])}]),uW}(),uZW=function(){function uW(uW,uj,ut,ud,ub,uE){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=uW,this._normal=uj,this._color=ut,this._textureCoordinate0=ud,this._textureCoordinate1=ub,this._tangent=uE}uT(uW,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(0,uj,"textureCoordinate1",function(){return this._textureCoordinate1}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(72,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector2",2),new uOW(48,"vector2",15),new uOW(56,"vector4",5)])}]),uW}(),uXW=function(){function uW(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}uT(uW,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),uj.VertexPositionNormalColorTexture0Tangent=function(uW,uj,ut,ud,ub,uE){this._position=uW,this._normal=uj,this._color=ut,this._textureCoordinate0=ud,this._textureCoordinate1=ub,this._tangent=uE},u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(0,uj,"textureCoordinate1",function(){return this._textureCoordinate1}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(68,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector2",2),new uOW(48,"vector2",15),new uOW(56,"vector3",5)])}]),uW}(),u_W=function(){function uW(uW,uj,ut,ud,ub,uE){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=uW,this._normal=uj,this._color=ut,this._textureCoordinate=ud,this._blendIndex=ub,this._blendWeight=uE}uT(uW,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(80,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector2",2),new uOW(48,"vector4",7),new uOW(64,"vector4",6)])}]),uW}(),uNW=function(){function uW(uW,uj,ut,ud,ub,uE,uO){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=uW,this._normal=uj,this._color=ut,this._textureCoordinate=ud,this._tangent=ub,this._blendIndex=uE,this._blendWeight=uO}uT(uW,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(96,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector2",2),new uOW(48,"vector4",7),new uOW(64,"vector4",6),new uOW(80,"vector4",5)])}]),uW}(),uzW=function(){function uW(uW,uj,ut,ud,ub,uE,uO){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=uW,this._normal=uj,this._color=ut,this._textureCoordinate=ud,this._tangent=ub,this._blendIndex=uE,this._blendWeight=uO}uT(uW,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(92,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector2",2),new uOW(48,"vector4",7),new uOW(64,"vector4",6),new uOW(80,"vector3",5)])}]),uW}(),uCW=function(){function uW(uW,uj,ut,ud,ub){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=uW,this._normal=uj,this._color=ut,this._textureCoordinate=ud,this._tangent=ub}uT(uW,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(64,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector2",2),new uOW(48,"vector4",5)])}]),uW}(),uLW=function(){function uW(uW,uj,ut,ud,ub){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=uW,this._normal=uj,this._color=ut,this._textureCoordinate=ud,this._tangent=ub}uT(uW,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"color",function(){return this._color}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(60,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",1),new uOW(40,"vector2",2),new uOW(48,"vector3",5)])}]),uW}(),uVW=function(){function uW(uW,uj,ut){this._position=null,this._normal=null,this._tangent=null,this._position=uW,this._normal=uj,this._tangent=ut}uT(uW,"laya.d3.graphics.VertexPositionNormalSTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(40,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector4",5)])}]),uW}(),uxW=function(){function uW(uW,uj,ut){this._position=null,this._normal=null,this._tangent=null,this._position=uW,this._normal=uj,this._tangent=ut}uT(uW,"laya.d3.graphics.VertexPositionNormalTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(36,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector3",5)])}]),uW}(),uGW=function(){function uW(uW,uj,ut){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=uW,this._normal=uj,this._textureCoordinate=ut}uT(uW,"laya.d3.graphics.VertexPositionNormalTexture");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(32,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector2",2)])}]),uW}(),ulW=function(){function uW(uW,uj,ut,ud){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=uW,this._normal=uj,this._textureCoordinate0=ut,this._textureCoordinate1=ud}uT(uW,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(0,uj,"textureCoordinate1",function(){return this._textureCoordinate1}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(40,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector2",2),new uOW(32,"vector2",15)])}]),uW}(),uhW=function(){function uW(uW,uj,ut,ud,ub,uE){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=uW,this._normal=uj,this._textureCoordinate0=ut,this._textureCoordinate1=ud,this._blendIndex=ub,this._blendWeight=uE}uT(uW,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(0,uj,"textureCoordinate1",function(){return this._textureCoordinate1}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(72,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector2",2),new uOW(32,"vector2",15),new uOW(40,"vector4",7),new uOW(56,"vector4",6)])}]),uW}(),uvW=function(){function uW(uW,uj,ut,ud,ub,uE,uO){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=uW,this._normal=uj,this._textureCoordinate0=ut,this._textureCoordinate1=ud,this._tangent=ub,this._blendIndex=uE,this._blendWeight=uO}uT(uW,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(0,uj,"textureCoordinate1",function(){return this._textureCoordinate1}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(88,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector2",2),new uOW(32,"vector2",15),new uOW(40,"vector4",7),new uOW(56,"vector4",6),new uOW(72,"vector4",5)])}]),uW}(),uyW=function(){function uW(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}uT(uW,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),uj.VertexPositionNormalTexture0SkinTangent=function(uW,uj,ut,ud,ub,uE,uO){this._position=uW,this._normal=uj,this._textureCoordinate0=ut,this._textureCoordinate1=ud,this._tangent=ub,this._blendIndex=uE,this._blendWeight=uO},u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(0,uj,"textureCoordinate1",function(){return this._textureCoordinate1}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(84,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector2",2),new uOW(32,"vector2",15),new uOW(40,"vector4",7),new uOW(56,"vector4",6),new uOW(72,"vector3",5)])}]),uW}(),uaW=function(){function uW(uW,uj,ut,ud,ub){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=uW,this._normal=uj,this._textureCoordinate0=ut,this._textureCoordinate1=ud,this._tangent=ub}uT(uW,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(0,uj,"textureCoordinate1",function(){return this._textureCoordinate1}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(56,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector2",2),new uOW(32,"vector2",15),new uOW(40,"vector4",5)])}]),uW}(),uuW=function(){function uW(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}uT(uW,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),uj.VertexPositionNormalTexture0Tangent=function(uW,uj,ut,ud,ub){this._position=uW,this._normal=uj,this._textureCoordinate0=ut,this._textureCoordinate1=ud,this._tangent=ub},u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(0,uj,"textureCoordinate1",function(){return this._textureCoordinate1}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(52,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector2",2),new uOW(32,"vector2",15),new uOW(40,"vector3",5)])}]),uW}(),uDW=function(){function uW(uW,uj,ut,ud,ub){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=uW,this._normal=uj,this._textureCoordinate=ut,this._blendIndex=ud,this._blendWeight=ub}uT(uW,"laya.d3.graphics.VertexPositionNormalTextureSkin");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(64,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector2",2),new uOW(32,"vector4",7),new uOW(48,"vector4",6)])}]),uW}(),usW=function(){function uW(uW,uj,ut,ud,ub,uE){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=uW,this._normal=uj,this._textureCoordinate=ut,this._tangent=ud,this._blendIndex=ub,this._blendWeight=uE}uT(uW,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(80,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector2",2),new uOW(32,"vector4",7),new uOW(48,"vector4",6),new uOW(64,"vector4",5)])}]),uW}(),uYW=function(){function uW(uW,uj,ut,ud,ub,uE){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=uW,this._normal=uj,this._textureCoordinate=ut,this._tangent=ud,this._blendIndex=ub,this._blendWeight=uE}uT(uW,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(76,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector2",2),new uOW(32,"vector4",7),new uOW(48,"vector4",6),new uOW(64,"vector3",5)])}]),uW}(),uHW=function(){function uW(uW,uj,ut,ud){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=uW,this._normal=uj,this._textureCoordinate=ut,this._tangent=ud}uT(uW,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(48,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector2",2),new uOW(32,"vector4",5)])}]),uW}(),uIW=function(){function uW(uW,uj,ut,ud){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=uW,this._normal=uj,this._textureCoordinate=ut,this._tangent=ud}uT(uW,"laya.d3.graphics.VertexPositionNormalTextureTangent");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(44,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector2",2),new uOW(32,"vector3",5)])}]),uW}(),ugW=function(){function uW(uW,uj,ut){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=uW,this._normal=uj,this._textureCoordinate=ut}uT(uW,"laya.d3.graphics.VertexPositionNTBTexture");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(56,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector3",5),new uOW(36,"vector3",4),new uOW(48,"vector2",2)])}]),uW}(),ufW=function(){function uW(uW,uj,ut,ud,ub,uE,uO,uq){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=uW,this._normal=uj,this._textureCoordinate0=ud,this._textureCoordinate1=ub,this._tangent=uE,ut=ut,this._blendIndex=uO,this._blendWeight=uq}uT(uW,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"tangent",function(){return this._tangent}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(0,uj,"textureCoordinate1",function(){return this._textureCoordinate1}),u$(0,uj,"blendIndex",function(){return this._blendIndex}),u$(0,uj,"blendWeight",function(){return this._blendWeight}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(96,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector3",5),new uOW(36,"vector3",4),new uOW(48,"vector2",2),new uOW(56,"vector2",15),new uOW(64,"vector4",7),new uOW(80,"vector4",6)])}]),uW}(),uwW=function(){function uW(uW,uj,ut){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=uW,this._normal=uj,this._textureCoordinate=ut}uT(uW,"laya.d3.graphics.VertexPositionNTBTextureSkin");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"textureCoordinate",function(){return this._textureCoordinate}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(88,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector3",5),new uOW(36,"vector3",4),new uOW(48,"vector2",2),new uOW(56,"vector4",7),new uOW(72,"vector4",6)])}]),uW}(),uUW=(function(){function uW(uW,uj,ut,ud){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=uW,this._normal=uj,this._textureCoord0=ut,this._textureCoord1=ud}uT(uW,"laya.d3.graphics.VertexPositionTerrain");var uj=uW.prototype;uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"normal",function(){return this._normal}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"textureCoord0",function(){return this._textureCoord0}),u$(0,uj,"textureCoord1",function(){return this._textureCoord1}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(40,[new uOW(0,"vector3",0),new uOW(12,"vector3",3),new uOW(24,"vector2",2),new uOW(32,"vector2",15)])}])}(),function(){function uW(uW,uj){this._position=null,this._textureCoordinate0=null,this._position=uW,this._textureCoordinate0=uj}uT(uW,"laya.d3.graphics.VertexPositionTexture0");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"position",function(){return this._position}),u$(0,uj,"textureCoordinate0",function(){return this._textureCoordinate0}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(20,[new uOW(0,"vector3",0),new uOW(12,"vector2",2)])}]),uW}()),uJW=(function(){function uW(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR,um,uQ,uT){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=uW,this._positionStartLifeTime=uj,this._velocity=ut,this._startColor=ud,this._startSize=ub,this._startRotation0=uE,this._startRotation1=uO,this._startRotation2=uq,this._startLifeTime=uA,this._time=uc,this._startSpeed=uR,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=uT}uT(uW,"laya.d3.graphics.VertexShurikenParticleBillboard");var uj=uW.prototype;uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),u$(0,uj,"random1",function(){return this._randoms1}),u$(0,uj,"startRotation2",function(){return this._startRotation2}),u$(0,uj,"positionStartLifeTime",function(){return this._positionStartLifeTime}),u$(0,uj,"velocity",function(){return this._velocity}),u$(0,uj,"random0",function(){return this._randoms0}),u$(0,uj,"startSize",function(){return this._startSize}),u$(0,uj,"startColor",function(){return this._startColor}),u$(0,uj,"startRotation0",function(){return this._startRotation0}),u$(0,uj,"startRotation1",function(){return this._startRotation1}),u$(0,uj,"startLifeTime",function(){return this._startLifeTime}),u$(0,uj,"time",function(){return this._time}),u$(0,uj,"startSpeed",function(){return this._startSpeed}),u$(0,uj,"simulationWorldPostion",function(){return this._simulationWorldPostion}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(152,[new uOW(0,"vector4",17),new uOW(16,"vector4",30),new uOW(32,"vector4",32),new uOW(48,"vector4",19),new uOW(64,"vector3",20),new uOW(76,"vector3",22),new uOW(88,"single",31),new uOW(92,"vector4",34),new uOW(108,"vector4",35),new uOW(124,"vector3",36),new uOW(136,"vector4",37)])}])}(),function(){function uW(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR,um,uQ,uT){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=uW,this._positionStartLifeTime=uj,this._velocity=ut,this._startColor=ud,this._startSize=ub,this._startRotation0=uE,this._startRotation1=uO,this._startRotation2=uq,this._startLifeTime=uA,this._time=uc,this._startSpeed=uR,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=uT}uT(uW,"laya.d3.graphics.VertexShurikenParticleMesh");var uj=uW.prototype;uX.imps(uj,{"laya.d3.graphics.IVertex":!0}),u$(0,uj,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),u$(0,uj,"velocity",function(){return this._velocity}),u$(0,uj,"position",function(){return this._positionStartLifeTime}),u$(0,uj,"random0",function(){return this._randoms0}),u$(0,uj,"startSize",function(){return this._startSize}),u$(0,uj,"startColor",function(){return this._startColor}),u$(0,uj,"startRotation0",function(){return this._startRotation0}),u$(0,uj,"startRotation1",function(){return this._startRotation1}),u$(0,uj,"random1",function(){return this._randoms1}),u$(0,uj,"startRotation2",function(){return this._startRotation2}),u$(0,uj,"startLifeTime",function(){return this._startLifeTime}),u$(0,uj,"time",function(){return this._time}),u$(0,uj,"startSpeed",function(){return this._startSpeed}),u$(0,uj,"simulationWorldPostion",function(){return this._simulationWorldPostion}),u$(0,uj,"vertexDeclaration",function(){return uW._vertexDeclaration}),u$(1,uW,"vertexDeclaration",function(){return uW._vertexDeclaration}),um(uW,["_vertexDeclaration",function(){return this._vertexDeclaration=new uEW(172,[new uOW(0,"vector3",0),new uOW(12,"vector4",1),new uOW(28,"vector2",2),new uOW(36,"vector4",30),new uOW(52,"vector4",32),new uOW(68,"vector4",19),new uOW(84,"vector3",20),new uOW(96,"vector3",22),new uOW(108,"single",31),new uOW(112,"vector4",34),new uOW(128,"vector4",35),new uOW(144,"vector3",36),new uOW(156,"vector4",37)])}])}(),function(){function uM(uW,uj,ut,ud,ub,uE){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=ut,this._materials=ud,this._subMeshes=ub,this._materialMap=uE,this._version=uj,this._onLoaded(uW)}uT(uM,"laya.d3.loaders.LoadModelV01");var uW=uM.prototype;return uW._onLoaded=function(uW){this._readData=uW,this.READ_BLOCK();for(var uj=0;uj<this._BLOCK.count;uj++){var ut=this._readData.getUint16(),ud=this._strings[ut],ub=this["READ_"+ud];if(null==ub)throw new Error("model file err,no this function:"+ut+" "+ud);if(!ub.call(this))break}return this._mesh},uW.onError=function(){},uW._readString=function(){return this._strings[this._readData.getUint16()]},uW.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},uW.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},uW.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var uW=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var uj=0;uj<this._STRINGS.size;uj++)this._strings[uj]=this._readData.readUTFString();return this._readData.pos=uW,!0},uW.READ_MATERIAL=function(){var uW=this._readData.getUint16(),uj=(this._readString(),this._readString());return this._materials[uW]="null"!==uj?uo.getRes(this._materialMap[uj]):new uxj,!0},uW.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var uW,uj=this._readData.__getBuffer(),ut=0,ud=this._readData.getUint32(),ub=this._readData.getUint32(),uE=(new Float32Array(uj.slice(ud+this._DATA.offset,ud+this._DATA.offset+ub)),this._readData.getUint32()),uO=this._readData.getUint32(),uq=new Float32Array(uj.slice(uE+this._DATA.offset,uE+this._DATA.offset+uO));for(this.mesh._inverseBindPoses=[],ut=0,uW=uq.length;ut<uW;ut+=16){var uA=new uWj(uq[ut+0],uq[ut+1],uq[ut+2],uq[ut+3],uq[ut+4],uq[ut+5],uq[ut+6],uq[ut+7],uq[ut+8],uq[ut+9],uq[ut+10],uq[ut+11],uq[ut+12],uq[ut+13],uq[ut+14],uq[ut+15]);this.mesh._inverseBindPoses.push(uA)}break;default:throw new Error("LoadModel:unknown version.")}return!0},uW.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var uW=this._readString();this._shaderAttributes=uW.match(uM._attrReg);var uj=this._readData.getUint32(),ut=this._readData.getUint32(),ud=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),ub=this._readData.getUint32(),uE=this._readData.getUint32(),uO=this._readData.getUint32(),uq=this._readData.__getBuffer(),uA=new ucj(this._mesh),uc=this._getVertexDeclaration(),uR=uYj.create(uc,ub/uc.vertexStride,35044,!0),um=ud+this._DATA.offset,uQ=uq.slice(um,um+ub);uR.setData(new Float32Array(uQ));for(var uT=(uA._vertexBuffer=uR).vertexDeclaration.getVertexElements(),u$=0;u$<uT.length;u$++)uA._bufferUsage[uT[u$].elementUsage]=uR;var ue=usj.create("ushort",ut/2,35044,!0),uK=uj+this._DATA.offset,uo=uq.slice(uK,uK+ut);ue.setData(new Uint16Array(uo)),uA._indexBuffer=ue;var uS=uq.slice(uE+this._DATA.offset,uE+this._DATA.offset+uO);return uA._boneIndicesList[0]=new Uint8Array(uS),this._subMeshes.push(uA),!0},uW.READ_DATAAREA=function(){return!1},uW._getVertexDeclaration=function(){for(var uW,uj=!1,ut=!1,ud=!1,ub=!1,uE=!1,uO=!1,uq=!1,uA=!1,uc=!1,uR=0;uR<this._shaderAttributes.length;uR+=8)switch(this._shaderAttributes[uR]){case"POSITION":uj=!0;break;case"NORMAL":ut=!0;break;case"COLOR":ud=!0;break;case"UV":ub=!0;break;case"UV1":uE=!0;break;case"BLENDWEIGHT":uq=!0;break;case"BLENDINDICES":uA=!0;break;case"TANGENT":uO=!0;break;case"BINORMAL":uc=!0}return uj&&ut&&ud&&ub&&uE&&uq&&uA&&uO?uW=uMW.vertexDeclaration:uj&&ut&&ud&&ub&&uE&&uq&&uA?uW=uoW.vertexDeclaration:uj&&ut&&ub&&uE&&uq&&uA&&uO?uW=uyW.vertexDeclaration:uj&&ut&&ub&&uE&&uq&&uA?uW=uhW.vertexDeclaration:uj&&ut&&ud&&ub&&uq&&uA&&uO?uW=uzW.vertexDeclaration:uj&&ut&&ud&&ub&&uq&&uA?uW=u_W.vertexDeclaration:uj&&ut&&uO&&uc&&ub&&uq&&uA?uW=uwW.vertexDeclaration:uj&&ut&&ub&&uq&&uA&&uO?uW=uYW.vertexDeclaration:uj&&ut&&ub&&uq&&uA?uW=uDW.vertexDeclaration:uj&&ut&&ud&&uq&&uA&&uO?uW=uQW.vertexDeclaration:uj&&ut&&ud&&uq&&uA?uW=uRW.vertexDeclaration:uj&&ut&&ud&&ub&&uE&&uO?uW=uXW.vertexDeclaration:uj&&ut&&ud&&ub&&uE?uW=uKW.vertexDeclaration:uj&&ut&&ub&&uE&&uO?uW=uuW.vertexDeclaration:uj&&ut&&ub&&uE?uW=ulW.vertexDeclaration:uj&&ut&&ud&&ub&&uO?uW=uLW.vertexDeclaration:uj&&ut&&ub&&uO&&uc?uW=ugW.vertexDeclaration:uj&&ut&&ud&&ub?uW=ueW.vertexDeclaration:uj&&ut&&ub&&uO?uW=uIW.vertexDeclaration:uj&&ut&&ub?uW=uGW.vertexDeclaration:uj&&ut&&ud&&uO?uW=u$W.vertexDeclaration:uj&&ut&&ud&&(uW=ucW.vertexDeclaration),uW},u$(0,uW,"mesh",function(){return this._mesh}),uM._attrReg=new RegExp("(\\w+)|([:,;])","g"),uM}()),urW=function(){function uN(){}return uT(uN,"laya.d3.loaders.LoadModelV02"),uN.parse=function(uW,uj,ut,ud,ub,uE){uN._mesh=ut,uN._materials=ud,uN._subMeshes=ub,uN._materialMap=uE,uN._version=uj,uN._readData=uW,uN.READ_DATA(),uN.READ_BLOCK(),uN.READ_STRINGS();for(var uO=0,uq=uN._BLOCK.count;uO<uq;uO++){uN._readData.pos=uN._BLOCK.blockStarts[uO];var uA=uN._readData.getUint16(),uc=uN._strings[uA],uR=uN["READ_"+uc];if(null==uR)throw new Error("model file err,no this function:"+uA+" "+uc);uR.call()}uN._strings.length=0,uN._readData=null,uN._version=null,uN._mesh=null,uN._materials=null,uN._subMeshes=null,uN._materialMap=null},uN._readString=function(){return uN._strings[uN._readData.getUint16()]},uN.READ_DATA=function(){uN._DATA.offset=uN._readData.getUint32(),uN._DATA.size=uN._readData.getUint32()},uN.READ_BLOCK=function(){for(var uW=uN._BLOCK.count=uN._readData.getUint16(),uj=uN._BLOCK.blockStarts=[],ut=uN._BLOCK.blockLengths=[],ud=0;ud<uW;ud++)uj.push(uN._readData.getUint32()),ut.push(uN._readData.getUint32())},uN.READ_STRINGS=function(){var uW=uN._readData.getUint32(),uj=uN._readData.getUint16(),ut=uN._readData.pos;uN._readData.pos=uW+uN._DATA.offset;for(var ud=0;ud<uj;ud++)uN._strings[ud]=uN._readData.readUTFString();uN._readData.pos=ut},uN.READ_MATERIAL=function(){uN._readString(),uN._readString();var uW=uN._readString();return""!==uW&&uN._materials.push(uo.getRes(uN._materialMap[uW])),!0},uN.READ_MESH=function(){uN._readString();var uW,uj=uN._readData.__getBuffer(),ut=0,ud=uN._readData.getInt16(),ub=uN._DATA.offset;for(ut=0;ut<ud;ut++){var uE=ub+uN._readData.getUint32(),uO=uN._readData.getUint32(),uq=new Float32Array(uj.slice(uE,uE+uO)),uA=uN._readString().match(uN._attrReg),uc=uN._getVertexDeclaration(uA),uR=uYj.create(uc,4*uq.length/uc.vertexStride,35044,!0);uR.setData(uq),uN._mesh._vertexBuffers.push(uR)}var um=ub+uN._readData.getUint32(),uQ=uN._readData.getUint32(),uT=new Uint16Array(uj.slice(um,um+uQ)),u$=usj.create("ushort",uQ/2,35044,!0);u$.setData(uT),uN._mesh._indexBuffer=u$;var ue=uN._mesh._boneNames=[],uK=uN._readData.getUint16();for(ue.length=uK,ut=0;ut<uK;ut++)ue[ut]=uN._strings[uN._readData.getUint16()];var uo=uN._readData.getUint32(),uS=uN._readData.getUint32(),uM=(new Float32Array(uj.slice(ub+uo,ub+uo+uS)),uN._readData.getUint32()),uZ=uN._readData.getUint32(),uX=new Float32Array(uj.slice(ub+uM,ub+uM+uZ));for(uN._mesh._inverseBindPoses=[],ut=0,uW=uX.length;ut<uW;ut+=16){var u_=new uWj(uX[ut+0],uX[ut+1],uX[ut+2],uX[ut+3],uX[ut+4],uX[ut+5],uX[ut+6],uX[ut+7],uX[ut+8],uX[ut+9],uX[ut+10],uX[ut+11],uX[ut+12],uX[ut+13],uX[ut+14],uX[ut+15]);uN._mesh._inverseBindPoses.push(u_)}return uN._mesh._skinnedDatas=new Float32Array(16*uX.length),!0},uN.READ_SUBMESH=function(){var uW=uN._readData.__getBuffer(),uj=new ucj(uN._mesh),ut=uN._readData.getInt16(),ud=uN._readData.getUint32(),ub=uN._readData.getUint32();uj._vertexBuffer=uN._mesh._vertexBuffers[ut],uj._vertexStart=ud,uj._vertexCount=ub;var uE=uN._readData.getUint32(),uO=uN._readData.getUint32(),uq=uN._mesh._indexBuffer;uj._indexBuffer=uq,uj._indexStart=uE,uj._indexCount=uO,uj._indices=new Uint16Array(uq.getData().buffer,2*uE,uO);var uA=uN._DATA.offset,uc=uj._subIndexBufferStart,uR=uj._subIndexBufferCount,um=uj._boneIndicesList,uQ=uN._readData.getUint16();uc.length=uQ,uR.length=uQ,um.length=uQ;for(var uT=0;uT<uQ;uT++){uc[uT]=uN._readData.getUint32(),uR[uT]=uN._readData.getUint32();var u$=uN._readData.getUint32(),ue=uN._readData.getUint32();uj._boneIndicesList[uT]=new Uint8Array(uW.slice(uA+u$,uA+u$+ue))}return uN._subMeshes.push(uj),!0},uN._getVertexDeclaration=function(uW){for(var uj,ut=!1,ud=!1,ub=!1,uE=!1,uO=!1,uq=!1,uA=!1,uc=!1,uR=!1,um=0;um<uW.length;um++)switch(uW[um]){case"POSITION":ut=!0;break;case"NORMAL":ud=!0;break;case"COLOR":ub=!0;break;case"UV":uE=!0;break;case"UV1":uO=!0;break;case"BLENDWEIGHT":uA=!0;break;case"BLENDINDICES":uc=!0;break;case"TANGENT":uq=!0;break;case"BINORMAL":uR=!0}return ut&&ud&&ub&&uE&&uO&&uA&&uc&&uq?uj=uMW.vertexDeclaration:ut&&ud&&ub&&uE&&uO&&uA&&uc?uj=uoW.vertexDeclaration:ut&&ud&&uE&&uO&&uA&&uc&&uq?uj=uyW.vertexDeclaration:ut&&ud&&uE&&uO&&uA&&uc?uj=uhW.vertexDeclaration:ut&&ud&&ub&&uE&&uA&&uc&&uq?uj=uzW.vertexDeclaration:ut&&ud&&ub&&uE&&uA&&uc?uj=u_W.vertexDeclaration:ut&&ud&&uE&&uA&&uc&&uq?uj=uYW.vertexDeclaration:ut&&ud&&uE&&uA&&uc?uj=uDW.vertexDeclaration:ut&&ud&&ub&&uA&&uc&&uq?uj=uQW.vertexDeclaration:ut&&ud&&ub&&uA&&uc?uj=uRW.vertexDeclaration:ut&&ud&&ub&&uE&&uO&&uq?uj=uXW.vertexDeclaration:ut&&ud&&ub&&uE&&uO?uj=uKW.vertexDeclaration:ut&&ud&&uE&&uO&&uq?uj=uuW.vertexDeclaration:ut&&ud&&uE&&uO?uj=ulW.vertexDeclaration:ut&&ud&&ub&&uE&&uq?uj=uLW.vertexDeclaration:ut&&ud&&uE&&uq&&uR?uj=ugW.vertexDeclaration:ut&&ud&&ub&&uE?uj=ueW.vertexDeclaration:ut&&ud&&uE&&uq?uj=uIW.vertexDeclaration:ut&&ud&&uE?uj=uGW.vertexDeclaration:ut&&ud&&ub&&uq?uj=u$W.vertexDeclaration:ut&&ud&&ub&&(uj=ucW.vertexDeclaration),uj},uN._attrReg=new RegExp("(\\w+)|([:,;])","g"),uN._strings=[],uN._readData=null,uN._version=null,uN._mesh=null,uN._materials=null,uN._subMeshes=null,uN._materialMap=null,um(uN,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),uN}(),uPW=function(){function u_(){}return uT(u_,"laya.d3.loaders.LoadModelV03"),u_.parse=function(uW,uj,ut,ud,ub){u_._mesh=ut,u_._subMeshes=ud,u_._materialMap=ub,u_._version=uj,u_._readData=uW,u_.READ_DATA(),u_.READ_BLOCK(),u_.READ_STRINGS();for(var uE=0,uO=u_._BLOCK.count;uE<uO;uE++){u_._readData.pos=u_._BLOCK.blockStarts[uE];var uq=u_._readData.getUint16(),uA=u_._strings[uq],uc=u_["READ_"+uA];if(null==uc)throw new Error("model file err,no this function:"+uq+" "+uA);uc.call()}u_._strings.length=0,u_._readData=null,u_._version=null,u_._mesh=null,u_._subMeshes=null,u_._materialMap=null},u_._readString=function(){return u_._strings[u_._readData.getUint16()]},u_.READ_DATA=function(){u_._DATA.offset=u_._readData.getUint32(),u_._DATA.size=u_._readData.getUint32()},u_.READ_BLOCK=function(){for(var uW=u_._BLOCK.count=u_._readData.getUint16(),uj=u_._BLOCK.blockStarts=[],ut=u_._BLOCK.blockLengths=[],ud=0;ud<uW;ud++)uj.push(u_._readData.getUint32()),ut.push(u_._readData.getUint32())},u_.READ_STRINGS=function(){var uW=u_._readData.getUint32(),uj=u_._readData.getUint16(),ut=u_._readData.pos;u_._readData.pos=uW+u_._DATA.offset;for(var ud=0;ud<uj;ud++)u_._strings[ud]=u_._readData.readUTFString();u_._readData.pos=ut},u_.READ_MESH=function(){var uW,uj=u_._readString(),ut=u_._readData.__getBuffer(),ud=0,ub=u_._readData.getInt16(),uE=u_._DATA.offset;for(ud=0;ud<ub;ud++){var uO,uq=uE+u_._readData.getUint32(),uA=u_._readData.getUint32(),uc=new Float32Array(ut.slice(uq,uq+uA)),uR=u_._readString();switch(u_._version){case"LAYAMODEL:03":uO=u_._vertexDeclarationMap_Discard[uR];break;case"LAYAMODEL:0301":uO=u_._vertexDeclarationMap[uR];break;default:throw new Error("LoadModelV03: unknown version.")}if(!uO)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+u_._version+"  bufferAttribute="+uR+"  name="+uj+"  url="+(u_._mesh?u_._mesh.url:"null"));var um=uYj.create(uO,4*uc.length/uO.vertexStride,35044,!0,u_._mesh._url+"_"+ud);um.setData(uc),u_._mesh._vertexBuffers.push(um)}var uQ=uE+u_._readData.getUint32(),uT=u_._readData.getUint32(),u$=new Uint16Array(ut.slice(uQ,uQ+uT)),ue=usj.create("ushort",uT/2,35044,!0,u_._mesh._url);ue.setData(u$),u_._mesh._indexBuffer=ue;var uK=u_._mesh._boneNames=[],uo=u_._readData.getUint16();for(uK.length=uo,ud=0;ud<uo;ud++)uK[ud]=u_._strings[u_._readData.getUint16()];u_._readData.pos+=8;var uS=u_._readData.getUint32(),uM=u_._readData.getUint32(),uZ=new Float32Array(ut.slice(uE+uS,uE+uS+uM));for(u_._mesh._inverseBindPoses=[],ud=0,uW=uZ.length;ud<uW;ud+=16){var uX=new uWj(uZ[ud+0],uZ[ud+1],uZ[ud+2],uZ[ud+3],uZ[ud+4],uZ[ud+5],uZ[ud+6],uZ[ud+7],uZ[ud+8],uZ[ud+9],uZ[ud+10],uZ[ud+11],uZ[ud+12],uZ[ud+13],uZ[ud+14],uZ[ud+15]);u_._mesh._inverseBindPoses.push(uX)}return u_._mesh._skinnedDatas=new Float32Array(16*uZ.length),!0},u_.READ_SUBMESH=function(){var uW=u_._readData.__getBuffer(),uj=new ucj(u_._mesh),ut=u_._readData.getInt16(),ud=u_._readData.getUint32(),ub=u_._readData.getUint32();uj._vertexBuffer=u_._mesh._vertexBuffers[ut],uj._vertexStart=ud,uj._vertexCount=ub;var uE=u_._readData.getUint32(),uO=u_._readData.getUint32(),uq=u_._mesh._indexBuffer;uj._indexBuffer=uq,uj._indexStart=uE,uj._indexCount=uO,uj._indices=new Uint16Array(uq.getData().buffer,2*uE,uO);var uA=u_._DATA.offset,uc=uj._subIndexBufferStart,uR=uj._subIndexBufferCount,um=uj._boneIndicesList,uQ=u_._readData.getUint16();uc.length=uQ,uR.length=uQ,um.length=uQ;for(var uT=0;uT<uQ;uT++){uc[uT]=u_._readData.getUint32(),uR[uT]=u_._readData.getUint32();var u$=u_._readData.getUint32(),ue=u_._readData.getUint32();um[uT]=new Uint8Array(uW.slice(uA+u$,uA+u$+ue))}return u_._subMeshes.push(uj),!0},u_._strings=[],u_._readData=null,u_._version=null,u_._mesh=null,u_._subMeshes=null,u_._materialMap=null,um(u_,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":uMW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":uoW.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":ufW.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":uyW.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":uhW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":uzW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":u_W.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":uYW.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":uDW.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":uQW.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":uRW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":uXW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":uKW.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":uuW.vertexDeclaration,"POSITION,NORMAL,UV,UV1":ulW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":uLW.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":ugW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":ueW.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":uIW.vertexDeclaration,"POSITION,NORMAL,UV":uGW.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":u$W.vertexDeclaration,"POSITION,NORMAL,COLOR":ucW.vertexDeclaration,"POSITION,NORMAL,TANGENT":uxW.vertexDeclaration,"POSITION,NORMAL":uAW.vertexDeclaration,"POSITION,UV":uUW.vertexDeclaration,POSITION:uqW.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":uSW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":uoW.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":ufW.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":uvW.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":uhW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":uNW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":u_W.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":usW.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":uDW.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":umW.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":uRW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":uZW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":uKW.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":uaW.vertexDeclaration,"POSITION,NORMAL,UV,UV1":ulW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":uCW.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":ugW.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":ueW.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":uHW.vertexDeclaration,"POSITION,NORMAL,UV":uGW.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":uTW.vertexDeclaration,"POSITION,NORMAL,COLOR":ucW.vertexDeclaration,"POSITION,NORMAL,TANGENT":uVW.vertexDeclaration,"POSITION,NORMAL":uAW.vertexDeclaration,"POSITION,UV":uUW.vertexDeclaration,POSITION:uqW.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),u_}(),uiW=function(){function uq(){}return uT(uq,"laya.d3.loaders.MeshReader"),uq.read=function(uW,uj,ut,ud,ub){var uE=new u_(uW);uE.pos=0;var uO=uE.readUTFString();switch(uO){case"LAYAMODEL:01":case"LAYASKINANI:01":uq._readVersion01(uE,uO,uj,ut,ud,ub);break;case"LAYAMODEL:02":urW.parse(uE,uO,uj,ut,ud,ub);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":uPW.parse(uE,uO,uj,ud,ub);break;default:throw new Error("MeshReader: unknown mesh version.")}uj._setSubMeshes(ud)},uq._readVersion01=function(uW,uj,ut,ud,ub,uE){new uJW(uW,uj,ut,ud,ub,uE)},uq}(),uBW=function(){function uW(uW,uj){this.min=null,this.max=null,this.min=uW,this.max=uj}uT(uW,"laya.d3.math.BoundBox");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.core.IClone":!0}),uj.getCorners=function(uW){uW.length=8;var uj=this.min.elements,ut=this.max.elements,ud=uj[0],ub=uj[1],uE=uj[2],uO=ut[0],uq=ut[1],uA=ut[2];uW[0]=new uOj(ud,uq,uA),uW[1]=new uOj(uO,uq,uA),uW[2]=new uOj(uO,ub,uA),uW[3]=new uOj(ud,ub,uA),uW[4]=new uOj(ud,uq,uE),uW[5]=new uOj(uO,uq,uE),uW[6]=new uOj(uO,ub,uE),uW[7]=new uOj(ud,ub,uE)},uj.toDefault=function(){this.min.toDefault(),this.max.toDefault()},uj.cloneTo=function(uW){var uj=uW;this.min.cloneTo(uj.min),this.max.cloneTo(uj.max)},uj.clone=function(){var uW=new this.constructor(new uOj,new uOj);return this.cloneTo(uW),uW},uW.createfromPoints=function(uW,uj){if(null==uW)throw new Error("points");var ut=uj.min,ud=uj.max,ub=ut.elements;ub[0]=Number.MAX_VALUE,ub[1]=Number.MAX_VALUE,ub[2]=Number.MAX_VALUE;var uE=ud.elements;uE[0]=-Number.MAX_VALUE,uE[1]=-Number.MAX_VALUE,uE[2]=-Number.MAX_VALUE;for(var uO=0,uq=uW.length;uO<uq;++uO)uOj.min(ut,uW[uO],ut),uOj.max(ud,uW[uO],ud)},uW.merge=function(uW,uj,ut){uOj.min(uW.min,uj.min,ut.min),uOj.max(uW.max,uj.max,ut.max)},uW}(),unW=function(){function uc(uW){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=uW,this._near=new ujj(new uOj),this._far=new ujj(new uOj),this._left=new ujj(new uOj),this._right=new ujj(new uOj),this._top=new ujj(new uOj),this._bottom=new ujj(new uOj),uc._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}uT(uc,"laya.d3.math.BoundFrustum");var uW=uc.prototype;return uW.equalsBoundFrustum=function(uW){return this._matrix.equalsOtherMatrix(uW.matrix)},uW.equalsObj=function(uW){if(uW instanceof laya.d3.math.BoundFrustum){var uj=uW;return this.equalsBoundFrustum(uj)}return!1},uW.getPlane=function(uW){switch(uW){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},uW.getCorners=function(uW){uc._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(uW[0]),uc._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(uW[1]),uc._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(uW[2]),uc._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(uW[3]),uc._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(uW[4]),uc._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(uW[5]),uc._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(uW[6]),uc._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(uW[7])},uW.containsPoint=function(uW){for(var uj=ujj.PlaneIntersectionType_Front,ut=ujj.PlaneIntersectionType_Front,ud=0;ud<6;ud++){switch(ud){case 0:ut=Collision.intersectsPlaneAndPoint(this._near,uW);break;case 1:ut=Collision.intersectsPlaneAndPoint(this._far,uW);break;case 2:ut=Collision.intersectsPlaneAndPoint(this._left,uW);break;case 3:ut=Collision.intersectsPlaneAndPoint(this._right,uW);break;case 4:ut=Collision.intersectsPlaneAndPoint(this._top,uW);break;case 5:ut=Collision.intersectsPlaneAndPoint(this._bottom,uW)}switch(ut){case ujj.PlaneIntersectionType_Back:return 0;case ujj.PlaneIntersectionType_Intersecting:uj=ujj.PlaneIntersectionType_Intersecting}}switch(uj){case ujj.PlaneIntersectionType_Intersecting:return 2;default:return 1}},uW.containsBoundBox=function(uW){for(var uj,ut=uc._tempV30,ud=uc._tempV31,ub=1,uE=0;uE<6;uE++){if(uj=this.getPlane(uE),this._getBoxToPlanePVertexNVertex(uW,uj.normal,ut,ud),Collision.intersectsPlaneAndPoint(uj,ut)===ujj.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(uj,ud)===ujj.PlaneIntersectionType_Back&&(ub=2)}return ub},uW.containsBoundSphere=function(uW){for(var uj=ujj.PlaneIntersectionType_Front,ut=ujj.PlaneIntersectionType_Front,ud=0;ud<6;ud++){switch(ud){case 0:ut=Collision.intersectsPlaneAndSphere(this._near,uW);break;case 1:ut=Collision.intersectsPlaneAndSphere(this._far,uW);break;case 2:ut=Collision.intersectsPlaneAndSphere(this._left,uW);break;case 3:ut=Collision.intersectsPlaneAndSphere(this._right,uW);break;case 4:ut=Collision.intersectsPlaneAndSphere(this._top,uW);break;case 5:ut=Collision.intersectsPlaneAndSphere(this._bottom,uW)}switch(ut){case ujj.PlaneIntersectionType_Back:return 0;case ujj.PlaneIntersectionType_Intersecting:uj=ujj.PlaneIntersectionType_Intersecting}}switch(uj){case ujj.PlaneIntersectionType_Intersecting:return 2;default:return 1}},uW._getBoxToPlanePVertexNVertex=function(uW,uj,ut,ud){var ub=uW.min,uE=ub.elements,uO=uW.max,uq=uO.elements,uA=uj.elements,uc=uA[0],uR=uA[1],um=uA[2];ub.cloneTo(ut);var uQ=ut.elements;0<=uc&&(uQ[0]=uq[0]),0<=uR&&(uQ[1]=uq[1]),0<=um&&(uQ[2]=uq[2]),uO.cloneTo(ud);var uT=ud.elements;0<=uc&&(uT[0]=uE[0]),0<=uR&&(uT[1]=uE[1]),0<=um&&(uT[2]=uE[2])},u$(0,uW,"top",function(){return this._top}),u$(0,uW,"matrix",function(){return this._matrix},function(uW){this._matrix=uW,uc._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),u$(0,uW,"near",function(){return this._near}),u$(0,uW,"far",function(){return this._far}),u$(0,uW,"left",function(){return this._left}),u$(0,uW,"right",function(){return this._right}),u$(0,uW,"bottom",function(){return this._bottom}),uc._getPlanesFromMatrix=function(uW,uj,ut,ud,ub,uE,uO){var uq=uW.elements,uA=uq[0],uc=uq[1],uR=uq[2],um=uq[3],uQ=uq[4],uT=uq[5],u$=uq[6],ue=uq[7],uK=uq[8],uo=uq[9],uS=uq[10],uM=uq[11],uZ=uq[12],uX=uq[13],u_=uq[14],uN=uq[15],uz=uj.normal.elements;uz[0]=um+uR,uz[1]=ue+u$,uz[2]=uM+uS,uj.distance=uN+u_,uj.normalize();var uC=ut.normal.elements;uC[0]=um-uR,uC[1]=ue-u$,uC[2]=uM-uS,ut.distance=uN-u_,ut.normalize();var uL=ud.normal.elements;uL[0]=um+uA,uL[1]=ue+uQ,uL[2]=uM+uK,ud.distance=uN+uZ,ud.normalize();var uV=ub.normal.elements;uV[0]=um-uA,uV[1]=ue-uQ,uV[2]=uM-uK,ub.distance=uN-uZ,ub.normalize();var ux=uE.normal.elements;ux[0]=um-uc,ux[1]=ue-uT,ux[2]=uM-uo,uE.distance=uN-uX,uE.normalize();var uG=uO.normal.elements;uG[0]=um+uc,uG[1]=ue+uT,uG[2]=uM+uo,uO.distance=uN+uX,uO.normalize()},uc._get3PlaneInterPoint=function(uW,uj,ut){var ud=uW.normal,ub=uj.normal,uE=ut.normal;uOj.cross(ub,uE,uc._tempV30),uOj.cross(uE,ud,uc._tempV31),uOj.cross(ud,ub,uc._tempV32);var uO=uOj.dot(ud,uc._tempV30),uq=uOj.dot(ub,uc._tempV31),uA=uOj.dot(uE,uc._tempV32);return uOj.scale(uc._tempV30,-uW.distance/uO,uc._tempV33),uOj.scale(uc._tempV31,-uj.distance/uq,uc._tempV34),uOj.scale(uc._tempV32,-ut.distance/uA,uc._tempV35),uOj.add(uc._tempV33,uc._tempV34,uc._tempV36),uOj.add(uc._tempV35,uc._tempV36,uc._tempV37),uc._tempV37},um(uc,["_tempV30",function(){return this._tempV30=new uOj},"_tempV31",function(){return this._tempV31=new uOj},"_tempV32",function(){return this._tempV32=new uOj},"_tempV33",function(){return this._tempV33=new uOj},"_tempV34",function(){return this._tempV34=new uOj},"_tempV35",function(){return this._tempV35=new uOj},"_tempV36",function(){return this._tempV36=new uOj},"_tempV37",function(){return this._tempV37=new uOj}]),uc}(),ukW=function(){function uR(uW,uj){this.center=null,this.radius=NaN,this.center=uW,this.radius=uj}uT(uR,"laya.d3.math.BoundSphere");var uW=uR.prototype;return uX.imps(uW,{"laya.d3.core.IClone":!0}),uW.toDefault=function(){this.center.toDefault(),this.radius=0},uW.intersectsRayDistance=function(uW){return Collision.intersectsRayAndSphereRD(uW,this)},uW.intersectsRayPoint=function(uW,uj){return Collision.intersectsRayAndSphereRP(uW,this,uj)},uW.cloneTo=function(uW){var uj=uW;this.center.cloneTo(uj.center),uj.radius=this.radius},uW.clone=function(){var uW=new this.constructor(new uOj,new uOj);return this.cloneTo(uW),uW},uR.createFromSubPoints=function(uW,uj,ut,ud){if(null==uW)throw new Error("points");if(uj<0||uj>=uW.length)throw new Error("start"+uj+"Must be in the range [0, "+(uW.length-1)+"]");if(ut<0||uj+ut>uW.length)throw new Error("count"+ut+"Must be in the range <= "+uW.length+"}");var ub=uj+ut,uE=uR._tempVector3;uE.elements[0]=0,uE.elements[1]=0,uE.elements[2]=0;for(var uO=uj;uO<ub;++uO)uOj.add(uW[uO],uE,uE);var uq=ud.center;uOj.scale(uE,1/ut,uq);var uA=0;for(uO=uj;uO<ub;++uO){var uc=uOj.distanceSquared(uq,uW[uO]);uA<uc&&(uA=uc)}ud.radius=Math.sqrt(uA)},uR.createfromPoints=function(uW,uj){if(null==uW)throw new Error("points");uR.createFromSubPoints(uW,0,uW.length,uj)},um(uR,["_tempVector3",function(){return this._tempVector3=new uOj}]),uR}(),upW=(function(){function uW(){}uT(uW,"laya.d3.math.ContainmentType"),uW.Disjoint=0,uW.Contains=1,uW.Intersects=2}(),function(){function ut(){}return uT(ut,"laya.d3.math.MathUtils3D"),ut.isZero=function(uW){return Math.abs(uW)<ut.zeroTolerance},ut.nearEqual=function(uW,uj){return!!ut.isZero(uW-uj)},ut.fastInvSqrt=function(uW){return ut.isZero(uW)?uW:1/Math.sqrt(uW)},um(ut,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),ut}()),uFW=function(){function uA(){var uW=this.elements=new Float32Array(9);uW[0]=1,uW[1]=0,uW[2]=0,uW[3]=0,uW[4]=1,uW[5]=0,uW[6]=0,uW[7]=0,uW[8]=1}uT(uA,"laya.d3.math.Matrix3x3");var uW=uA.prototype;return uX.imps(uW,{"laya.d3.core.IClone":!0}),uW.determinant=function(){var uW=this.elements,uj=uW[0],ut=uW[1],ud=uW[2],ub=uW[3],uE=uW[4],uO=uW[5],uq=uW[6],uA=uW[7],uc=uW[8];return uj*(uc*uE-uO*uA)+ut*(-uc*ub+uO*uq)+ud*(uA*ub-uE*uq)},uW.translate=function(uW,uj){var ut=uj.elements,ud=this.elements,ub=uW.elements,uE=ud[0],uO=ud[1],uq=ud[2],uA=ud[3],uc=ud[4],uR=ud[5],um=ud[6],uQ=ud[7],uT=ud[8],u$=ub[0],ue=ub[1];ut[0]=uE,ut[1]=uO,ut[2]=uq,ut[3]=uA,ut[4]=uc,ut[5]=uR,ut[6]=u$*uE+ue*uA+um,ut[7]=u$*uO+ue*uc+uQ,ut[8]=u$*uq+ue*uR+uT},uW.rotate=function(uW,uj){var ut=uj.elements,ud=this.elements,ub=ud[0],uE=ud[1],uO=ud[2],uq=ud[3],uA=ud[4],uc=ud[5],uR=ud[6],um=ud[7],uQ=ud[8],uT=Math.sin(uW),u$=Math.cos(uW);ut[0]=u$*ub+uT*uq,ut[1]=u$*uE+uT*uA,ut[2]=u$*uO+uT*uc,ut[3]=u$*uq-uT*ub,ut[4]=u$*uA-uT*uE,ut[5]=u$*uc-uT*uO,ut[6]=uR,ut[7]=um,ut[8]=uQ},uW.scale=function(uW,uj){var ut=uj.elements,ud=this.elements,ub=uW.elements,uE=ub[0],uO=ub[1];ut[0]=uE*ud[0],ut[1]=uE*ud[1],ut[2]=uE*ud[2],ut[3]=uO*ud[3],ut[4]=uO*ud[4],ut[5]=uO*ud[5],ut[6]=ud[6],ut[7]=ud[7],ut[8]=ud[8]},uW.invert=function(uW){var uj=uW.elements,ut=this.elements,ud=ut[0],ub=ut[1],uE=ut[2],uO=ut[3],uq=ut[4],uA=ut[5],uc=ut[6],uR=ut[7],um=ut[8],uQ=um*uq-uA*uR,uT=-um*uO+uA*uc,u$=uR*uO-uq*uc,ue=ud*uQ+ub*uT+uE*u$;ue||(uW=null),ue=1/ue,uj[0]=uQ*ue,uj[1]=(-um*ub+uE*uR)*ue,uj[2]=(uA*ub-uE*uq)*ue,uj[3]=uT*ue,uj[4]=(um*ud-uE*uc)*ue,uj[5]=(-uA*ud+uE*uO)*ue,uj[6]=u$*ue,uj[7]=(-uR*ud+ub*uc)*ue,uj[8]=(uq*ud-ub*uO)*ue},uW.transpose=function(uW){var uj=uW.elements,ut=this.elements;if(uW===this){var ud=ut[1],ub=ut[2],uE=ut[5];uj[1]=ut[3],uj[2]=ut[6],uj[3]=ud,uj[5]=ut[7],uj[6]=ub,uj[7]=uE}else uj[0]=ut[0],uj[1]=ut[3],uj[2]=ut[6],uj[3]=ut[1],uj[4]=ut[4],uj[5]=ut[7],uj[6]=ut[2],uj[7]=ut[5],uj[8]=ut[8]},uW.identity=function(){var uW=this.elements;uW[0]=1,uW[1]=0,uW[2]=0,uW[3]=0,uW[4]=1,uW[5]=0,uW[6]=0,uW[7]=0,uW[8]=1},uW.cloneTo=function(uW){var uj,ut,ud;if((ut=this.elements)!==(ud=uW.elements))for(uj=0;uj<9;++uj)ud[uj]=ut[uj]},uW.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},uA.createFromTranslation=function(uW,uj){uj.elements;var ut=uW.elements;uj[0]=1,uj[1]=0,uj[2]=0,uj[3]=0,uj[4]=1,uj[5]=0,uj[6]=ut[0],uj[7]=ut[1],uj[8]=1},uA.createFromRotation=function(uW,uj){var ut=uj.elements,ud=Math.sin(uW),ub=Math.cos(uW);ut[0]=ub,ut[1]=ud,ut[2]=0,ut[3]=-ud,ut[4]=ub,ut[5]=0,ut[6]=0,ut[7]=0,ut[8]=1},uA.createFromScaling=function(uW,uj){var ut=uj.elements,ud=uW.elements;ut[0]=ud[0],ut[1]=0,ut[2]=0,ut[3]=0,ut[4]=ud[1],ut[5]=0,ut[6]=0,ut[7]=0,ut[8]=1},uA.createFromMatrix4x4=function(uW,uj){uj[0]=uW[0],uj[1]=uW[1],uj[2]=uW[2],uj[3]=uW[4],uj[4]=uW[5],uj[5]=uW[6],uj[6]=uW[8],uj[7]=uW[9],uj[8]=uW[10]},uA.multiply=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj.elements,uO=ub[0],uq=ub[1],uA=ub[2],uc=ub[3],uR=ub[4],um=ub[5],uQ=ub[6],uT=ub[7],u$=ub[8],ue=uE[0],uK=uE[1],uo=uE[2],uS=uE[3],uM=uE[4],uZ=uE[5],uX=uE[6],u_=uE[7],uN=uE[8];ud[0]=ue*uO+uK*uc+uo*uQ,ud[1]=ue*uq+uK*uR+uo*uT,ud[2]=ue*uA+uK*um+uo*u$,ud[3]=uS*uO+uM*uc+uZ*uQ,ud[4]=uS*uq+uM*uR+uZ*uT,ud[5]=uS*uA+uM*um+uZ*u$,ud[6]=uX*uO+u_*uc+uN*uQ,ud[7]=uX*uq+u_*uR+uN*uT,ud[8]=uX*uA+u_*um+uN*u$},uA.lookAt=function(uW,uj,ut,ud){uOj.subtract(uW,uj,uA._tempV30),uOj.normalize(uA._tempV30,uA._tempV30),uOj.cross(ut,uA._tempV30,uA._tempV31),uOj.normalize(uA._tempV31,uA._tempV31),uOj.cross(uA._tempV30,uA._tempV31,uA._tempV32);var ub=uA._tempV30.elements,uE=uA._tempV31.elements,uO=uA._tempV32.elements,uq=ud.elements;uq[0]=uE[0],uq[3]=uE[1],uq[6]=uE[2],uq[1]=uO[0],uq[4]=uO[1],uq[7]=uO[2],uq[2]=ub[0],uq[5]=ub[1],uq[8]=ub[2]},uA.DEFAULT=new uA,um(uA,["_tempV30",function(){return this._tempV30=new uOj},"_tempV31",function(){return this._tempV31=new uOj},"_tempV32",function(){return this._tempV32=new uOj}]),uA}(),uWj=function(){function uC(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR,um,uQ,uT,u$,ue){void 0===uW&&(uW=1),void 0===uj&&(uj=0),void 0===ut&&(ut=0),void 0===ud&&(ud=0),void 0===ub&&(ub=0),void 0===uE&&(uE=1),void 0===uO&&(uO=0),void 0===uq&&(uq=0),void 0===uA&&(uA=0),void 0===uc&&(uc=0),void 0===uR&&(uR=1),void 0===um&&(um=0),void 0===uQ&&(uQ=0),void 0===uT&&(uT=0),void 0===u$&&(u$=0),void 0===ue&&(ue=1);var uK=this.elements=new Float32Array(16);uK[0]=uW,uK[1]=uj,uK[2]=ut,uK[3]=ud,uK[4]=ub,uK[5]=uE,uK[6]=uO,uK[7]=uq,uK[8]=uA,uK[9]=uc,uK[10]=uR,uK[11]=um,uK[12]=uQ,uK[13]=uT,uK[14]=u$,uK[15]=ue}uT(uC,"laya.d3.math.Matrix4x4");var uW=uC.prototype;return uX.imps(uW,{"laya.d3.core.IClone":!0}),uW.getElementByRowColumn=function(uW,uj){if(uW<0||3<uW)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(uj<0||3<uj)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*uW+uj]},uW.setElementByRowColumn=function(uW,uj,ut){if(uW<0||3<uW)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(uj<0||3<uj)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*uW+uj]=ut},uW.equalsOtherMatrix=function(uW){var uj=this.elements,ut=uW.elements;return upW.nearEqual(uj[0],ut[0])&&upW.nearEqual(uj[1],ut[1])&&upW.nearEqual(uj[2],ut[2])&&upW.nearEqual(uj[3],ut[3])&&upW.nearEqual(uj[4],ut[4])&&upW.nearEqual(uj[5],ut[5])&&upW.nearEqual(uj[6],ut[6])&&upW.nearEqual(uj[7],ut[7])&&upW.nearEqual(uj[8],ut[8])&&upW.nearEqual(uj[9],ut[9])&&upW.nearEqual(uj[10],ut[10])&&upW.nearEqual(uj[11],ut[11])&&upW.nearEqual(uj[12],ut[12])&&upW.nearEqual(uj[13],ut[13])&&upW.nearEqual(uj[14],ut[14])&&upW.nearEqual(uj[15],ut[15])},uW.decomposeTransRotScale=function(uW,uj,ut){var ud=uC._tempMatrix4x4;return this.decomposeTransRotMatScale(uW,ud,ut)?(utj.createFromMatrix4x4(ud,uj),!0):(uj.identity(),!1)},uW.decomposeTransRotMatScale=function(uW,uj,ut){var ud=this.elements,ub=uW.elements,uE=uj.elements,uO=ut.elements;ub[0]=ud[12],ub[1]=ud[13],ub[2]=ud[14];var uq=ud[0],uA=ud[1],uc=ud[2],uR=ud[4],um=ud[5],uQ=ud[6],uT=ud[8],u$=ud[9],ue=ud[10],uK=uO[0]=Math.sqrt(uq*uq+uA*uA+uc*uc),uo=uO[1]=Math.sqrt(uR*uR+um*um+uQ*uQ),uS=uO[2]=Math.sqrt(uT*uT+u$*u$+ue*ue);if(upW.isZero(uK)||upW.isZero(uo)||upW.isZero(uS))return uE[1]=uE[2]=uE[3]=uE[4]=uE[6]=uE[7]=uE[8]=uE[9]=uE[11]=uE[12]=uE[13]=uE[14]=0,uE[0]=uE[5]=uE[10]=uE[15]=1,!1;var uM=uC._tempVector0,uZ=uM.elements;uZ[0]=uT/uS,uZ[1]=u$/uS,uZ[2]=ue/uS;var uX=uC._tempVector1,u_=uX.elements;u_[0]=uq/uK,u_[1]=uA/uK,u_[2]=uc/uK;var uN=uC._tempVector2;uOj.cross(uM,uX,uN);var uz=uC._tempVector1;return uOj.cross(uN,uM,uz),uE[3]=uE[7]=uE[11]=uE[12]=uE[13]=uE[14]=0,uE[15]=1,uE[0]=uz.x,uE[1]=uz.y,uE[2]=uz.z,uE[4]=uN.x,uE[5]=uN.y,uE[6]=uN.z,uE[8]=uM.x,uE[9]=uM.y,uE[10]=uM.z,uE[0]*uq+uE[1]*uA+uE[2]*uc<0&&(uO[0]=-uK),uE[4]*uR+uE[5]*um+uE[6]*uQ<0&&(uO[1]=-uo),uE[8]*uT+uE[9]*u$+uE[10]*ue<0&&(uO[2]=-uS),!0},uW.decomposeYawPitchRoll=function(uW){var uj=uW.elements,ut=Math.asin(-this.elements[9]);uj[1]=ut,Math.cos(ut)>upW.zeroTolerance?(uj[2]=Math.atan2(this.elements[1],this.elements[5]),uj[0]=Math.atan2(this.elements[8],this.elements[10])):(uj[2]=Math.atan2(-this.elements[4],this.elements[0]),uj[0]=0)},uW.normalize=function(){var uW=this.elements,uj=uW[0],ut=uW[1],ud=uW[2],ub=Math.sqrt(uj*uj+ut*ut+ud*ud);if(!ub)return uW[0]=0,uW[1]=0,void(uW[2]=0);1!=ub&&(ub=1/ub,uW[0]=uj*ub,uW[1]=ut*ub,uW[2]=ud*ub)},uW.transpose=function(){var uW,uj;return uj=(uW=this.elements)[1],uW[1]=uW[4],uW[4]=uj,uj=uW[2],uW[2]=uW[8],uW[8]=uj,uj=uW[3],uW[3]=uW[12],uW[12]=uj,uj=uW[6],uW[6]=uW[9],uW[9]=uj,uj=uW[7],uW[7]=uW[13],uW[13]=uj,uj=uW[11],uW[11]=uW[14],uW[14]=uj,this},uW.invert=function(uW){var uj=this.elements,ut=uW.elements,ud=uj[0],ub=uj[1],uE=uj[2],uO=uj[3],uq=uj[4],uA=uj[5],uc=uj[6],uR=uj[7],um=uj[8],uQ=uj[9],uT=uj[10],u$=uj[11],ue=uj[12],uK=uj[13],uo=uj[14],uS=uj[15],uM=ud*uA-ub*uq,uZ=ud*uc-uE*uq,uX=ud*uR-uO*uq,u_=ub*uc-uE*uA,uN=ub*uR-uO*uA,uz=uE*uR-uO*uc,uC=um*uK-uQ*ue,uL=um*uo-uT*ue,uV=um*uS-u$*ue,ux=uQ*uo-uT*uK,uG=uQ*uS-u$*uK,ul=uT*uS-u$*uo,uh=uM*ul-uZ*uG+uX*ux+u_*uV-uN*uL+uz*uC;0!==Math.abs(uh)&&(uh=1/uh,ut[0]=(uA*ul-uc*uG+uR*ux)*uh,ut[1]=(uE*uG-ub*ul-uO*ux)*uh,ut[2]=(uK*uz-uo*uN+uS*u_)*uh,ut[3]=(uT*uN-uQ*uz-u$*u_)*uh,ut[4]=(uc*uV-uq*ul-uR*uL)*uh,ut[5]=(ud*ul-uE*uV+uO*uL)*uh,ut[6]=(uo*uX-ue*uz-uS*uZ)*uh,ut[7]=(um*uz-uT*uX+u$*uZ)*uh,ut[8]=(uq*uG-uA*uV+uR*uC)*uh,ut[9]=(ub*uV-ud*uG-uO*uC)*uh,ut[10]=(ue*uN-uK*uX+uS*uM)*uh,ut[11]=(uQ*uX-um*uN-u$*uM)*uh,ut[12]=(uA*uL-uq*ux-uc*uC)*uh,ut[13]=(ud*ux-ub*uL+uE*uC)*uh,ut[14]=(uK*uZ-ue*u_-uo*uM)*uh,ut[15]=(um*u_-uQ*uZ+uT*uM)*uh)},uW.identity=function(){var uW=this.elements;uW[1]=uW[2]=uW[3]=uW[4]=uW[6]=uW[7]=uW[8]=uW[9]=uW[11]=uW[12]=uW[13]=uW[14]=0,uW[0]=uW[5]=uW[10]=uW[15]=1},uW.cloneTo=function(uW){var uj,ut,ud;if((ut=this.elements)!==(ud=uW.elements))for(uj=0;uj<16;++uj)ud[uj]=ut[uj]},uW.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},uW.getTranslationVector=function(uW){var uj=this.elements,ut=uW.elements;ut[0]=uj[12],ut[1]=uj[13],ut[2]=uj[14]},uW.setTranslationVector=function(uW){var uj=this.elements,ut=uW.elements;uj[12]=ut[0],uj[13]=ut[1],uj[14]=ut[2]},uW.getForward=function(uW){var uj=this.elements,ut=uW.elements;ut[0]=-uj[8],ut[1]=-uj[9],ut[2]=-uj[10]},uW.setForward=function(uW){var uj=this.elements,ut=uW.elements;uj[8]=-ut[0],uj[9]=-ut[1],uj[10]=-ut[2]},uC.createRotationX=function(uW,uj){var ut=uj.elements,ud=Math.sin(uW),ub=Math.cos(uW);ut[1]=ut[2]=ut[3]=ut[4]=ut[7]=ut[8]=ut[11]=ut[12]=ut[13]=ut[14]=0,ut[0]=ut[15]=1,ut[5]=ut[10]=ub,ut[6]=ud,ut[9]=-ud},uC.createRotationY=function(uW,uj){var ut=uj.elements,ud=Math.sin(uW),ub=Math.cos(uW);ut[1]=ut[3]=ut[4]=ut[6]=ut[7]=ut[9]=ut[11]=ut[12]=ut[13]=ut[14]=0,ut[5]=ut[15]=1,ut[0]=ut[10]=ub,ut[2]=-ud,ut[8]=ud},uC.createRotationZ=function(uW,uj){var ut=uj.elements,ud=Math.sin(uW),ub=Math.cos(uW);ut[2]=ut[3]=ut[6]=ut[7]=ut[8]=ut[9]=ut[11]=ut[12]=ut[13]=ut[14]=0,ut[10]=ut[15]=1,ut[0]=ut[5]=ub,ut[1]=ud,ut[4]=-ud},uC.createRotationYawPitchRoll=function(uW,uj,ut,ud){utj.createFromYawPitchRoll(uW,uj,ut,uC._tempQuaternion),uC.createRotationQuaternion(uC._tempQuaternion,ud)},uC.createRotationAxis=function(uW,uj,ut){var ud=uW.elements,ub=ud[0],uE=ud[1],uO=ud[2],uq=Math.cos(uj),uA=Math.sin(uj),uc=ub*ub,uR=uE*uE,um=uO*uO,uQ=ub*uE,uT=ub*uO,u$=uE*uO,ue=ut.elements;ue[3]=ue[7]=ue[11]=ue[12]=ue[13]=ue[14]=0,ue[15]=1,ue[0]=uc+uq*(1-uc),ue[1]=uQ-uq*uQ+uA*uO,ue[2]=uT-uq*uT-uA*uE,ue[4]=uQ-uq*uQ-uA*uO,ue[5]=uR+uq*(1-uR),ue[6]=u$-uq*u$+uA*ub,ue[8]=uT-uq*uT+uA*uE,ue[9]=u$-uq*u$-uA*ub,ue[10]=um+uq*(1-um)},uC.createRotationQuaternion=function(uW,uj){var ut=uW.elements,ud=uj.elements,ub=ut[0],uE=ut[1],uO=ut[2],uq=ut[3],uA=ub*ub,uc=uE*uE,uR=uO*uO,um=ub*uE,uQ=uO*uq,uT=uO*ub,u$=uE*uq,ue=uE*uO,uK=ub*uq;ud[3]=ud[7]=ud[11]=ud[12]=ud[13]=ud[14]=0,ud[15]=1,ud[0]=1-2*(uc+uR),ud[1]=2*(um+uQ),ud[2]=2*(uT-u$),ud[4]=2*(um-uQ),ud[5]=1-2*(uR+uA),ud[6]=2*(ue+uK),ud[8]=2*(uT+u$),ud[9]=2*(ue-uK),ud[10]=1-2*(uc+uA)},uC.createTranslate=function(uW,uj){var ut=uW.elements,ud=uj.elements;ud[4]=ud[8]=ud[1]=ud[9]=ud[2]=ud[6]=ud[3]=ud[7]=ud[11]=0,ud[0]=ud[5]=ud[10]=ud[15]=1,ud[12]=ut[0],ud[13]=ut[1],ud[14]=ut[2]},uC.createScaling=function(uW,uj){var ut=uW.elements,ud=uj.elements;ud[0]=ut[0],ud[5]=ut[1],ud[10]=ut[2],ud[1]=ud[4]=ud[8]=ud[12]=ud[9]=ud[13]=ud[2]=ud[6]=ud[14]=ud[3]=ud[7]=ud[11]=0,ud[15]=1},uC.multiply=function(uW,uj,ut){var ud,ub,uE,uO,uq,uA,uc,uR;for(ub=ut.elements,uE=uW.elements,ub===(uO=uj.elements)&&(uO=uO.slice()),ud=0;ud<4;ud++)uq=uE[ud],uA=uE[ud+4],uc=uE[ud+8],uR=uE[ud+12],ub[ud]=uq*uO[0]+uA*uO[1]+uc*uO[2]+uR*uO[3],ub[ud+4]=uq*uO[4]+uA*uO[5]+uc*uO[6]+uR*uO[7],ub[ud+8]=uq*uO[8]+uA*uO[9]+uc*uO[10]+uR*uO[11],ub[ud+12]=uq*uO[12]+uA*uO[13]+uc*uO[14]+uR*uO[15]},uC.createFromQuaternion=function(uW,uj){var ut=uj.elements,ud=uW.elements,ub=ud[0],uE=ud[1],uO=ud[2],uq=ud[3],uA=ub+ub,uc=uE+uE,uR=uO+uO,um=ub*uA,uQ=uE*uA,uT=uE*uc,u$=uO*uA,ue=uO*uc,uK=uO*uR,uo=uq*uA,uS=uq*uc,uM=uq*uR;ut[0]=1-uT-uK,ut[1]=uQ+uM,ut[2]=u$-uS,ut[3]=0,ut[4]=uQ-uM,ut[5]=1-um-uK,ut[6]=ue+uo,ut[7]=0,ut[8]=u$+uS,ut[9]=ue-uo,ut[10]=1-um-uT,ut[11]=0,ut[12]=0,ut[13]=0,ut[14]=0,ut[15]=1},uC.createAffineTransformation=function(uW,uj,ut,ud){var ub=uW.elements,uE=uj.elements,uO=ut.elements,uq=ud.elements,uA=uE[0],uc=uE[1],uR=uE[2],um=uE[3],uQ=uA+uA,uT=uc+uc,u$=uR+uR,ue=uA*uQ,uK=uA*uT,uo=uA*u$,uS=uc*uT,uM=uc*u$,uZ=uR*u$,uX=um*uQ,u_=um*uT,uN=um*u$,uz=uO[0],uC=uO[1],uL=uO[2];uq[0]=(1-(uS+uZ))*uz,uq[1]=(uK+uN)*uz,uq[2]=(uo-u_)*uz,uq[3]=0,uq[4]=(uK-uN)*uC,uq[5]=(1-(ue+uZ))*uC,uq[6]=(uM+uX)*uC,uq[7]=0,uq[8]=(uo+u_)*uL,uq[9]=(uM-uX)*uL,uq[10]=(1-(ue+uS))*uL,uq[11]=0,uq[12]=ub[0],uq[13]=ub[1],uq[14]=ub[2],uq[15]=1},uC.createLookAt=function(uW,uj,ut,ud){var ub=ud.elements,uE=uC._tempVector0,uO=uC._tempVector1,uq=uC._tempVector2;uOj.subtract(uW,uj,uq),uOj.normalize(uq,uq),uOj.cross(ut,uq,uE),uOj.normalize(uE,uE),uOj.cross(uq,uE,uO),ud.identity(),ub[0]=uE.x,ub[4]=uE.y,ub[8]=uE.z,ub[1]=uO.x,ub[5]=uO.y,ub[9]=uO.z,ub[2]=uq.x,ub[6]=uq.y,ub[10]=uq.z,ub[12]=-uOj.dot(uE,uW),ub[13]=-uOj.dot(uO,uW),ub[14]=-uOj.dot(uq,uW)},uC.createPerspective=function(uW,uj,ut,ud,ub){var uE=ub.elements,uO=1/Math.tan(uW/2),uq=1/(ut-ud);uE[0]=uO/uj,uE[5]=uO,uE[10]=(ud+ut)*uq,uE[11]=-1,uE[14]=2*ud*ut*uq,uE[1]=uE[2]=uE[3]=uE[4]=uE[6]=uE[7]=uE[8]=uE[9]=uE[12]=uE[13]=uE[15]=0},uC.createOrthoOffCenterRH=function(uW,uj,ut,ud,ub,uE,uO){var uq=uO.elements,uA=1/(uW-uj),uc=1/(ut-ud),uR=1/(ub-uE);uq[1]=uq[2]=uq[3]=uq[4]=uq[6]=uq[7]=uq[8]=uq[9]=uq[11]=0,uq[15]=1,uq[0]=-2*uA,uq[5]=-2*uc,uq[10]=2*uR,uq[12]=(uW+uj)*uA,uq[13]=(ud+ut)*uc,uq[14]=(uE+ub)*uR},uC.translation=function(uW,uj){var ut=uW.elements,ud=uj.elements;ud[0]=ud[5]=ud[10]=ud[15]=1,ud[12]=ut[0],ud[13]=ut[1],ud[14]=ut[2]},um(uC,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new uC},"_tempVector0",function(){return this._tempVector0=new uOj},"_tempVector1",function(){return this._tempVector1=new uOj},"_tempVector2",function(){return this._tempVector2=new uOj},"_tempQuaternion",function(){return this._tempQuaternion=new utj},"DEFAULT",function(){return this.DEFAULT=new uC},"ZERO",function(){return this.ZERO=new uC(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),uC}(),ujj=(function(){function uM(uW,uj){this.extents=null,this.transformation=null,this.extents=uW,this.transformation=uj}uT(uM,"laya.d3.math.OrientedBoundBox");var uW=uM.prototype;uW.getCorners=function(uW){var uj=uM._tempV30.elements,ut=uM._tempV31.elements,ud=uM._tempV32.elements,ub=this.extents.elements;uj[0]=ub[0],uj[1]=uj[2]=0,ut[1]=ub[1],ut[0]=ut[2]=0,ud[2]=ub[2],ud[0]=ud[1]=0,uOj.TransformNormal(uM._tempV30,this.transformation,uM._tempV30),uOj.TransformNormal(uM._tempV31,this.transformation,uM._tempV31),uOj.TransformNormal(uM._tempV32,this.transformation,uM._tempV32);var uE=uM._tempV33;this.transformation.getTranslationVector(uE),uW.length=8,uOj.add(uE,uM._tempV30,uM._tempV34),uOj.add(uM._tempV34,uM._tempV31,uM._tempV34),uOj.add(uM._tempV34,uM._tempV32,uW[0]),uOj.add(uE,uM._tempV30,uM._tempV34),uOj.add(uM._tempV34,uM._tempV31,uM._tempV34),uOj.subtract(uM._tempV34,uM._tempV32,uW[1]),uOj.subtract(uE,uM._tempV30,uM._tempV34),uOj.add(uM._tempV34,uM._tempV31,uM._tempV34),uOj.subtract(uM._tempV34,uM._tempV32,uW[2]),uOj.subtract(uE,uM._tempV30,uM._tempV34),uOj.add(uM._tempV34,uM._tempV31,uM._tempV34),uOj.add(uM._tempV34,uM._tempV32,uW[3]),uOj.add(uE,uM._tempV30,uM._tempV34),uOj.subtract(uM._tempV34,uM._tempV31,uM._tempV34),uOj.add(uM._tempV34,uM._tempV32,uW[4]),uOj.add(uE,uM._tempV30,uM._tempV34),uOj.subtract(uM._tempV34,uM._tempV31,uM._tempV34),uOj.subtract(uM._tempV34,uM._tempV32,uW[5]),uOj.subtract(uE,uM._tempV30,uM._tempV34),uOj.subtract(uM._tempV34,uM._tempV31,uM._tempV34),uOj.subtract(uM._tempV34,uM._tempV32,uW[6]),uOj.subtract(uE,uM._tempV30,uM._tempV34),uOj.subtract(uM._tempV34,uM._tempV31,uM._tempV34),uOj.add(uM._tempV34,uM._tempV32,uW[7])},uW.transform=function(uW){uWj.multiply(this.transformation,uW,this.transformation)},uW.scale=function(uW){uOj.multiply(this.extents,uW,this.extents)},uW.translate=function(uW){this.transformation.getTranslationVector(uM._tempV30),uOj.add(uM._tempV30,uW,uM._tempV31),this.transformation.setTranslationVector(uM._tempV31)},uW.Size=function(uW){uOj.scale(this.extents,2,uW)},uW.getSize=function(uW){var uj=this.extents.elements;uM._tempV30.x=uj[0],uM._tempV31.y=uj[1],uM._tempV32.z=uj[2],uOj.TransformNormal(uM._tempV30,this.transformation,uM._tempV30),uOj.TransformNormal(uM._tempV31,this.transformation,uM._tempV31),uOj.TransformNormal(uM._tempV31,this.transformation,uM._tempV32);var ut=uW.elements;ut[0]=uOj.scalarLength(uM._tempV30),ut[1]=uOj.scalarLength(uM._tempV31),ut[2]=uOj.scalarLength(uM._tempV32)},uW.getSizeSquared=function(uW){var uj=this.extents.elements;uM._tempV30.x=uj[0],uM._tempV31.y=uj[1],uM._tempV32.z=uj[2],uOj.TransformNormal(uM._tempV30,this.transformation,uM._tempV30),uOj.TransformNormal(uM._tempV31,this.transformation,uM._tempV31),uOj.TransformNormal(uM._tempV31,this.transformation,uM._tempV32);var ut=uW.elements;ut[0]=uOj.scalarLengthSquared(uM._tempV30),ut[1]=uOj.scalarLengthSquared(uM._tempV31),ut[2]=uOj.scalarLengthSquared(uM._tempV32)},uW.getCenter=function(uW){this.transformation.getTranslationVector(uW)},uW.containsPoint=function(uW){var uj=this.extents.elements,ut=uj[0],ud=uj[1],ub=uj[2];this.transformation.invert(uM._tempM0),uOj.transformCoordinate(uW,uM._tempM0,uM._tempV30);var uE=uM._tempV30.elements,uO=Math.abs(uE[0]),uq=Math.abs(uE[1]),uA=Math.abs(uE[2]);return upW.nearEqual(uO,ut)&&upW.nearEqual(uq,ud)&&upW.nearEqual(uA,ub)?2:uO<ut&&uq<ud&&uA<ub?1:0},uW.containsPoints=function(uW){var uj=this.extents.elements,ut=uj[0],ud=uj[1],ub=uj[2];this.transformation.invert(uM._tempM0);for(var uE=!0,uO=!1,uq=0;uq<uW.length;uq++){uOj.transformCoordinate(uW[uq],uM._tempM0,uM._tempV30);var uA=uM._tempV30.elements,uc=Math.abs(uA[0]),uR=Math.abs(uA[1]),um=Math.abs(uA[2]);upW.nearEqual(uc,ut)&&upW.nearEqual(uR,ud)&&upW.nearEqual(um,ub)&&(uO=!0),uc<ut&&uR<ud&&um<ub?uO=!0:uE=!1}return uE?1:uO?2:0},uW.containsSphere=function(uW,uj){void 0===uj&&(uj=!1);var ut=this.extents.elements,ud=ut[0],ub=ut[1],uE=ut[2],uO=uW.radius;this.transformation.invert(uM._tempM0),uOj.transformCoordinate(uW.center,uM._tempM0,uM._tempV30);var uq=NaN;if(uq=uj?uO:(uOj.scale(uOj.UnitX,uO,uM._tempV31),uOj.TransformNormal(uM._tempV31,uM._tempM0,uM._tempV31),uOj.scalarLength(uM._tempV31)),uOj.scale(this.extents,-1,uM._tempV32),uOj.Clamp(uM._tempV30,uM._tempV32,this.extents,uM._tempV33),uq*uq<uOj.distanceSquared(uM._tempV30,uM._tempV33))return 0;var uA=uM._tempV30.elements,uc=uA[0],uR=uA[1],um=uA[2],uQ=uM._tempV32.elements,uT=uQ[0],u$=uQ[1],ue=uQ[2];return uT+uq<=uc&&uc<=ud-uq&&uq<ud-uT&&u$+uq<=uR&&uR<=ub-uq&&uq<ub-u$&&ue+uq<=um&&um<=uE-uq&&uq<uE-ue?1:2},uW.containsOrientedBoundBox=function(uW){var uj=0,ut=0;uW.getCorners(uM._corners);var ud=this.containsPoints(uM._corners);if(0!=ud)return ud;var ub=this.extents.elements;uW.extents.cloneTo(uM._tempV35);var uE=uM._tempV35.elements;uM._getRows(this.transformation,uM._rows1),uM._getRows(uW.transformation,uM._rows2);var uO=NaN;for(uj=0;uj<4;uj++)for(ut=0;ut<4;ut++)3==uj||3==ut?(uM._tempM0.setElementByRowColumn(uj,ut,0),uM._tempM1.setElementByRowColumn(uj,ut,0)):(uO=uOj.dot(uM._rows1[uj],uM._rows2[ut]),uM._tempM0.setElementByRowColumn(uj,ut,uO),uM._tempM1.setElementByRowColumn(uj,ut,Math.abs(uO)));uW.getCenter(uM._tempV34),this.getCenter(uM._tempV36),uOj.subtract(uM._tempV34,uM._tempV36,uM._tempV30);var uq=uM._tempV31.elements;uq[0]=uOj.dot(uM._tempV30,uM._rows1[0]),uq[1]=uOj.dot(uM._tempV30,uM._rows1[1]),uq[2]=uOj.dot(uM._tempV30,uM._rows1[2]);var uA=uM._tempV32.elements,uc=uM._tempV33.elements;for(uj=0;uj<3;uj++)if(uA[0]=uM._tempM1.getElementByRowColumn(uj,0),uA[1]=uM._tempM1.getElementByRowColumn(uj,1),uA[2]=uM._tempM1.getElementByRowColumn(uj,2),ub[uj]+uOj.dot(uM._tempV35,uM._tempV32)<Math.abs(uq[uj]))return 0;for(ut=0;ut<3;ut++)if(uA[0]=uM._tempM1.getElementByRowColumn(0,ut),uA[1]=uM._tempM1.getElementByRowColumn(1,ut),uA[2]=uM._tempM1.getElementByRowColumn(2,ut),uc[0]=uM._tempM0.getElementByRowColumn(0,ut),uc[1]=uM._tempM0.getElementByRowColumn(1,ut),uc[2]=uM._tempM0.getElementByRowColumn(2,ut),uOj.dot(this.extents,uM._tempV32)+uE[ut]<Math.abs(uOj.dot(uM._tempV31,uM._tempV33)))return 0;for(uj=0;uj<3;uj++)for(ut=0;ut<3;ut++){var uR=(uj+1)%3,um=(uj+2)%3,uQ=(ut+1)%3,uT=(ut+2)%3;if(ub[uR]*uM._tempM1.getElementByRowColumn(um,ut)+ub[um]*uM._tempM1.getElementByRowColumn(uR,ut)+(uE[uQ]*uM._tempM1.getElementByRowColumn(uj,uT)+uE[uT]*uM._tempM1.getElementByRowColumn(uj,uQ))<Math.abs(uq[um]*uM._tempM0.getElementByRowColumn(uR,ut)-uq[uR]*uM._tempM0.getElementByRowColumn(um,ut)))return 0}return 2},uW.containsLine=function(uW,uj){uM._corners[0]=uW,uM._corners[1]=uj;var ut=this.containsPoints(uM._corners);if(0!=ut)return ut;var ud=this.extents.elements,ub=ud[0],uE=ud[1],uO=ud[2];this.transformation.invert(uM._tempM0),uOj.transformCoordinate(uW,uM._tempM0,uM._tempV30),uOj.transformCoordinate(uj,uM._tempM0,uM._tempV31),uOj.add(uM._tempV30,uM._tempV31,uM._tempV32),uOj.scale(uM._tempV32,.5,uM._tempV32),uOj.subtract(uM._tempV30,uM._tempV32,uM._tempV33);var uq=uM._tempV33.elements,uA=uq[0],uc=uq[1],uR=uq[2],um=uM._tempV34.elements,uQ=um[0]=Math.abs(uq[0]),uT=um[1]=Math.abs(uq[1]),u$=um[2]=Math.abs(uq[2]),ue=uM._tempV32.elements,uK=ue[0],uo=ue[1],uS=ue[2];return Math.abs(uK)>ub+uQ?0:Math.abs(uo)>uE+uT?0:Math.abs(uS)>uO+u$?0:Math.abs(uo*uR-uS*uc)>uE*u$+uO*uT?0:Math.abs(uK*uR-uS*uA)>ub*u$+uO*uQ?0:Math.abs(uK*uc-uo*uA)>ub*uT+uE*uQ?0:2},uW.containsBoundBox=function(uW){var uj=0,ut=0,ud=uW.min,ub=uW.max;uW.getCorners(uM._corners);var uE=this.containsPoints(uM._corners);if(0!=uE)return uE;uOj.subtract(ub,ud,uM._tempV30),uOj.scale(uM._tempV30,.5,uM._tempV30),uOj.add(ud,uM._tempV30,uM._tempV30),uOj.subtract(ub,uM._tempV30,uM._tempV31);var uO=this.extents.elements,uq=uM._tempV31.elements;uM._getRows(this.transformation,uM._rows1),this.transformation.invert(uM._tempM0);for(uj=0;uj<3;uj++)for(ut=0;ut<3;ut++)uM._tempM1.setElementByRowColumn(uj,ut,Math.abs(uM._tempM0.getElementByRowColumn(uj,ut)));this.getCenter(uM._tempV35),uOj.subtract(uM._tempV30,uM._tempV35,uM._tempV32);var uA=uM._tempV31.elements;uA[0]=uOj.dot(uM._tempV32,uM._rows1[0]),uA[1]=uOj.dot(uM._tempV32,uM._rows1[1]),uA[2]=uOj.dot(uM._tempV32,uM._rows1[2]);var uc=uM._tempV33.elements,uR=uM._tempV34.elements;for(uj=0;uj<3;uj++)if(uc[0]=uM._tempM1.getElementByRowColumn(uj,0),uc[1]=uM._tempM1.getElementByRowColumn(uj,1),uc[2]=uM._tempM1.getElementByRowColumn(uj,2),uO[uj]+uOj.dot(uM._tempV31,uM._tempV33)<Math.abs(uA[uj]))return 0;for(ut=0;ut<3;ut++)if(uc[0]=uM._tempM1.getElementByRowColumn(0,ut),uc[1]=uM._tempM1.getElementByRowColumn(1,ut),uc[2]=uM._tempM1.getElementByRowColumn(2,ut),uR[0]=uM._tempM0.getElementByRowColumn(0,ut),uR[1]=uM._tempM0.getElementByRowColumn(1,ut),uR[2]=uM._tempM0.getElementByRowColumn(2,ut),uOj.dot(this.extents,uM._tempV33)+uq[ut]<Math.abs(uOj.dot(uM._tempV31,uM._tempV34)))return 0;for(uj=0;uj<3;uj++)for(ut=0;ut<3;ut++){var um=(uj+1)%3,uQ=(uj+2)%3,uT=(ut+1)%3,u$=(ut+2)%3;if(uO[um]*uM._tempM1.getElementByRowColumn(uQ,ut)+uO[uQ]*uM._tempM1.getElementByRowColumn(um,ut)+(uq[uT]*uM._tempM1.getElementByRowColumn(uj,u$)+uq[u$]*uM._tempM1.getElementByRowColumn(uj,uT))<Math.abs(uA[uQ]*uM._tempM0.getElementByRowColumn(um,ut)-uA[um]*uM._tempM0.getElementByRowColumn(uQ,ut)))return 0}return 2},uW.intersectsRay=function(uW,uj){uOj.scale(this.extents,-1,uM._tempV30),this.transformation.invert(uM._tempM0),uOj.TransformNormal(uW.direction,uM._tempM0,uM._ray.direction),uOj.transformCoordinate(uW.origin,uM._tempM0,uM._ray.origin),uM._boxBound1.min=uM._tempV30,uM._boxBound1.max=this.extents;var ut=Collision.intersectsRayAndBoxRP(uM._ray,uM._boxBound1,uj);return-1!==ut&&uOj.transformCoordinate(uj,this.transformation,uj),ut},uW._getLocalCorners=function(uW){uW.length=8;var uj=this.extents.elements;uM._tempV30.x=uj[0],uM._tempV31.y=uj[1],uM._tempV32.z=uj[2],uOj.add(uM._tempV30,uM._tempV31,uM._tempV33),uOj.add(uM._tempV33,uM._tempV32,uW[0]),uOj.add(uM._tempV30,uM._tempV31,uM._tempV33),uOj.subtract(uM._tempV33,uM._tempV32,uW[1]),uOj.subtract(uM._tempV31,uM._tempV30,uM._tempV33),uOj.subtract(uM._tempV33,uM._tempV30,uW[2]),uOj.subtract(uM._tempV31,uM._tempV30,uM._tempV33),uOj.add(uM._tempV33,uM._tempV32,uW[3]),uOj.subtract(uM._tempV30,uM._tempV31,uM._tempV33),uOj.add(uM._tempV33,uM._tempV32,uW[4]),uOj.subtract(uM._tempV30,uM._tempV31,uM._tempV33),uOj.subtract(uM._tempV33,uM._tempV32,uW[5]),uOj.scale(uW[0],-1,uW[6]),uOj.subtract(uM._tempV32,uM._tempV30,uM._tempV33),uOj.subtract(uM._tempV33,uM._tempV31,uW[7])},uW.equals=function(uW){return this.extents==uW.extents&&this.transformation==uW.transformation},uW.cloneTo=function(uW){var uj=uW;this.extents.cloneTo(uj.extents),this.transformation.cloneTo(uj.transformation)},uM.createByBoundBox=function(uW,uj){var ut=uW.min,ud=uW.max;uOj.subtract(ud,ut,uM._tempV30),uOj.scale(uM._tempV30,.5,uM._tempV30),uOj.add(ut,uM._tempV30,uM._tempV31),uOj.subtract(ud,uM._tempV31,uM._tempV32),uWj.translation(uM._tempV31,uM._tempM0);var ub=uM._tempV32.clone(),uE=uM._tempM0.clone();uj.extents=ub,uj.transformation=uE},uM.createByMinAndMaxVertex=function(uW,uj){return uOj.subtract(uj,uW,uM._tempV30),uOj.scale(uM._tempV30,.5,uM._tempV30),uOj.add(uW,uM._tempV30,uM._tempV31),uOj.subtract(uj,uM._tempV31,uM._tempV32),uWj.translation(uM._tempV31,uM._tempM0),new uM(uM._tempV32,uM._tempM0)},uM._getRows=function(uW,uj){uj.length=3;var ut=uW.elements,ud=uj[0].elements;ud[0]=ut[0],ud[1]=ut[1],ud[2]=ut[2];var ub=uj[1].elements;ub[0]=ut[4],ub[1]=ut[5],ub[2]=ut[6];var uE=uj[2].elements;uE[0]=ut[8],uE[1]=ut[9],uE[2]=ut[10]},uM.getObbtoObbMatrix4x4=function(uW,uj,ut,ud){var ub=uW.transformation,uE=uj.transformation;if(ut){uM._getRows(ub,uM._rows1),uM._getRows(uE,uM._rows2);for(var uO=0;uO<3;uO++)for(var uq=0;uq<3;uq++)ud.setElementByRowColumn(uO,uq,uOj.dot(uM._rows2[uO],uM._rows1[uq]));uj.getCenter(uM._tempV30),uW.getCenter(uM._tempV31),uOj.subtract(uM._tempV30,uM._tempV31,uM._tempV32);var uA=ud.elements;uA[12]=uOj.dot(uM._tempV32,uM._rows1[0]),uA[13]=uOj.dot(uM._tempV32,uM._rows1[1]),uA[14]=uOj.dot(uM._tempV32,uM._rows1[2]),uA[15]=1}else ub.invert(uM._tempM0),uWj.multiply(uE,uM._tempM0,ud)},uM.merge=function(uW,uj,ut){var ud=uW.extents,ub=uW.transformation;uM.getObbtoObbMatrix4x4(uW,uj,ut,uM._tempM0),uj._getLocalCorners(uM._corners),uOj.transformCoordinate(uM._corners[0],uM._tempM0,uM._corners[0]),uOj.transformCoordinate(uM._corners[1],uM._tempM0,uM._corners[1]),uOj.transformCoordinate(uM._corners[2],uM._tempM0,uM._corners[2]),uOj.transformCoordinate(uM._corners[3],uM._tempM0,uM._corners[3]),uOj.transformCoordinate(uM._corners[4],uM._tempM0,uM._corners[4]),uOj.transformCoordinate(uM._corners[5],uM._tempM0,uM._corners[5]),uOj.transformCoordinate(uM._corners[6],uM._tempM0,uM._corners[6]),uOj.transformCoordinate(uM._corners[7],uM._tempM0,uM._corners[7]),uOj.scale(ud,-1,uM._boxBound1.min),ud.cloneTo(uM._boxBound1.max),uBW.createfromPoints(uM._corners,uM._boxBound2),uBW.merge(uM._boxBound2,uM._boxBound1,uM._boxBound3);var uE=uM._boxBound3.min,uO=uM._boxBound3.max;uOj.subtract(uO,uE,uM._tempV30),uOj.scale(uM._tempV30,.5,uM._tempV30),uOj.add(uE,uM._tempV30,uM._tempV32),uOj.subtract(uO,uM._tempV32,ud),uOj.transformCoordinate(uM._tempV32,ub,uM._tempV33)},um(uM,["_tempV30",function(){return this._tempV30=new uOj},"_tempV31",function(){return this._tempV31=new uOj},"_tempV32",function(){return this._tempV32=new uOj},"_tempV33",function(){return this._tempV33=new uOj},"_tempV34",function(){return this._tempV34=new uOj},"_tempV35",function(){return this._tempV35=new uOj},"_tempV36",function(){return this._tempV36=new uOj},"_tempM0",function(){return this._tempM0=new uWj},"_tempM1",function(){return this._tempM1=new uWj},"_corners",function(){return this._corners=[new uOj,new uOj,new uOj,new uOj,new uOj,new uOj,new uOj,new uOj]},"_rows1",function(){return this._rows1=[new uOj,new uOj,new uOj]},"_rows2",function(){return this._rows2=[new uOj,new uOj,new uOj]},"_ray",function(){return this._ray=new ubj(new uOj,new uOj)},"_boxBound1",function(){return this._boxBound1=new uBW(new uOj,new uOj)},"_boxBound2",function(){return this._boxBound2=new uBW(new uOj,new uOj)},"_boxBound3",function(){return this._boxBound3=new uBW(new uOj,new uOj)}])}(),function(){function uX(uW,uj){this.normal=null,this.distance=NaN,void 0===uj&&(uj=0),this.normal=uW,this.distance=uj}return uT(uX,"laya.d3.math.Plane"),uX.prototype.normalize=function(){var uW=this.normal.elements,uj=uW[0],ut=uW[1],ud=uW[2],ub=1/Math.sqrt(uj*uj+ut*ut+ud*ud);uW[0]=uj*ub,uW[1]=ut*ub,uW[2]=ud*ub,this.distance*=ub},uX.createPlaneBy3P=function(uW,uj,ut){var ud=uW.elements,ub=uj.elements,uE=ut.elements,uO=ub[0]-ud[0],uq=ub[1]-ud[1],uA=ub[2]-ud[2],uc=uE[0]-ud[0],uR=uE[1]-ud[1],um=uE[2]-ud[2],uQ=uq*um-uA*uR,uT=uA*uc-uO*um,u$=uO*uR-uq*uc,ue=1/Math.sqrt(uQ*uQ+uT*uT+u$*u$),uK=uQ*ue,uo=uT*ue,uS=u$*ue,uM=uX._TEMPVec3.elements;uM[0]=uK,uM[1]=uo,uM[2]=uS;var uZ=-(uK*ud[0]+uo*ud[1]+uS*ud[2]);return new uX(uX._TEMPVec3,uZ)},uX.PlaneIntersectionType_Back=0,uX.PlaneIntersectionType_Front=1,uX.PlaneIntersectionType_Intersecting=2,um(uX,["_TEMPVec3",function(){return this._TEMPVec3=new uOj}]),uX}()),utj=function(){function ub(uW,uj,ut,ud){this.elements=new Float32Array(4),void 0===uW&&(uW=0),void 0===uj&&(uj=0),void 0===ut&&(ut=0),void 0===ud&&(ud=1),this.elements[0]=uW,this.elements[1]=uj,this.elements[2]=ut,this.elements[3]=ud}uT(ub,"laya.d3.math.Quaternion");var uW=ub.prototype;return uX.imps(uW,{"laya.d3.core.IClone":!0}),uW.scaling=function(uW,uj){var ut=uj.elements,ud=this.elements;ut[0]=ud[0]*uW,ut[1]=ud[1]*uW,ut[2]=ud[2]*uW,ut[3]=ud[3]*uW},uW.normalize=function(uW){var uj=uW.elements,ut=this.elements,ud=ut[0],ub=ut[1],uE=ut[2],uO=ut[3],uq=ud*ud+ub*ub+uE*uE+uO*uO;0<uq&&(uq=1/Math.sqrt(uq),uj[0]=ud*uq,uj[1]=ub*uq,uj[2]=uE*uq,uj[3]=uO*uq)},uW.length=function(){var uW=this.elements,uj=uW[0],ut=uW[1],ud=uW[2],ub=uW[3];return Math.sqrt(uj*uj+ut*ut+ud*ud+ub*ub)},uW.rotateX=function(uW,uj){var ut=uj.elements,ud=this.elements;uW*=.5;var ub=ud[0],uE=ud[1],uO=ud[2],uq=ud[3],uA=Math.sin(uW),uc=Math.cos(uW);ut[0]=ub*uc+uq*uA,ut[1]=uE*uc+uO*uA,ut[2]=uO*uc-uE*uA,ut[3]=uq*uc-ub*uA},uW.rotateY=function(uW,uj){var ut=uj.elements,ud=this.elements;uW*=.5;var ub=ud[0],uE=ud[1],uO=ud[2],uq=ud[3],uA=Math.sin(uW),uc=Math.cos(uW);ut[0]=ub*uc-uO*uA,ut[1]=uE*uc+uq*uA,ut[2]=uO*uc+ub*uA,ut[3]=uq*uc-uE*uA},uW.rotateZ=function(uW,uj){var ut=uj.elements,ud=this.elements;uW*=.5;var ub=ud[0],uE=ud[1],uO=ud[2],uq=ud[3],uA=Math.sin(uW),uc=Math.cos(uW);ut[0]=ub*uc+uE*uA,ut[1]=uE*uc-ub*uA,ut[2]=uO*uc+uq*uA,ut[3]=uq*uc-uO*uA},uW.getYawPitchRoll=function(uW){uOj.transformQuat(uOj.ForwardRH,this,ub.TEMPVector31),uOj.transformQuat(uOj.Up,this,ub.TEMPVector32);var uj=ub.TEMPVector32.elements;ub.angleTo(uOj.ZERO,ub.TEMPVector31,ub.TEMPVector33);var ut=ub.TEMPVector33.elements;ut[0]==Math.PI/2?(ut[1]=ub.arcTanAngle(uj[2],uj[0]),ut[2]=0):ut[0]==-Math.PI/2?(ut[1]=ub.arcTanAngle(-uj[2],-uj[0]),ut[2]=0):(uWj.createRotationY(-ut[1],ub.TEMPMatrix0),uWj.createRotationX(-ut[0],ub.TEMPMatrix1),uOj.transformCoordinate(ub.TEMPVector32,ub.TEMPMatrix0,ub.TEMPVector32),uOj.transformCoordinate(ub.TEMPVector32,ub.TEMPMatrix1,ub.TEMPVector32),ut[2]=ub.arcTanAngle(uj[1],-uj[0])),ut[1]<=-Math.PI&&(ut[1]=Math.PI),ut[2]<=-Math.PI&&(ut[2]=Math.PI),ut[1]>=Math.PI&&ut[2]>=Math.PI&&(ut[1]=0,ut[2]=0,ut[0]=Math.PI-ut[0]);var ud=uW.elements;ud[0]=ut[1],ud[1]=ut[0],ud[2]=ut[2]},uW.invert=function(uW){var uj=uW.elements,ut=this.elements,ud=ut[0],ub=ut[1],uE=ut[2],uO=ut[3],uq=ud*ud+ub*ub+uE*uE+uO*uO,uA=uq?1/uq:0;uj[0]=-ud*uA,uj[1]=-ub*uA,uj[2]=-uE*uA,uj[3]=uO*uA},uW.identity=function(){var uW=this.elements;uW[0]=0,uW[1]=0,uW[2]=0,uW[3]=1},uW.fromArray=function(uW,uj){void 0===uj&&(uj=0),this.elements[0]=uW[uj+0],this.elements[1]=uW[uj+1],this.elements[2]=uW[uj+2],this.elements[3]=uW[uj+3]},uW.cloneTo=function(uW){var uj,ut,ud;if((ut=this.elements)!==(ud=uW.elements))for(uj=0;uj<4;++uj)ud[uj]=ut[uj]},uW.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},uW.equals=function(uW){var uj=this.elements,ut=uW.elements;return upW.nearEqual(uj[0],ut[0])&&upW.nearEqual(uj[1],ut[1])&&upW.nearEqual(uj[2],ut[2])&&upW.nearEqual(uj[3],ut[3])},uW.lengthSquared=function(){var uW=this.elements[0],uj=this.elements[1],ut=this.elements[2],ud=this.elements[3];return uW*uW+uj*uj+ut*ut+ud*ud},u$(0,uW,"x",function(){return this.elements[0]}),u$(0,uW,"y",function(){return this.elements[1]}),u$(0,uW,"z",function(){return this.elements[2]}),u$(0,uW,"w",function(){return this.elements[3]}),ub.createFromYawPitchRoll=function(uW,uj,ut,ud){var ub=.5*ut,uE=.5*uj,uO=.5*uW,uq=Math.sin(ub),uA=Math.cos(ub),uc=Math.sin(uE),uR=Math.cos(uE),um=Math.sin(uO),uQ=Math.cos(uO),uT=ud.elements;uT[0]=uQ*uc*uA+um*uR*uq,uT[1]=um*uR*uA-uQ*uc*uq,uT[2]=uQ*uR*uq-um*uc*uA,uT[3]=uQ*uR*uA+um*uc*uq},ub.multiply=function(uW,uj,ut){var ud=uW.elements,ub=uj.elements,uE=ut.elements,uO=ud[0],uq=ud[1],uA=ud[2],uc=ud[3],uR=ub[0],um=ub[1],uQ=ub[2],uT=ub[3],u$=uq*uQ-uA*um,ue=uA*uR-uO*uQ,uK=uO*um-uq*uR,uo=uO*uR+uq*um+uA*uQ;uE[0]=uO*uT+uR*uc+u$,uE[1]=uq*uT+um*uc+ue,uE[2]=uA*uT+uQ*uc+uK,uE[3]=uc*uT-uo},ub.arcTanAngle=function(uW,uj){return 0==uW?1==uj?Math.PI/2:-Math.PI/2:0<uW?Math.atan(uj/uW):uW<0?0<uj?Math.atan(uj/uW)+Math.PI:Math.atan(uj/uW)-Math.PI:0},ub.angleTo=function(uW,uj,ut){uOj.subtract(uj,uW,ub.TEMPVector30),uOj.normalize(ub.TEMPVector30,ub.TEMPVector30),ut.elements[0]=Math.asin(ub.TEMPVector30.y),ut.elements[1]=ub.arcTanAngle(-ub.TEMPVector30.z,-ub.TEMPVector30.x)},ub.createFromAxisAngle=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements;uj*=.5;var uE=Math.sin(uj);ud[0]=uE*ub[0],ud[1]=uE*ub[1],ud[2]=uE*ub[2],ud[3]=Math.cos(uj)},ub.createFromMatrix3x3=function(uW,uj){var ut,ud=uj.elements,ub=uW.elements,uE=ub[0]+ub[4]+ub[8];if(0<uE)ut=Math.sqrt(uE+1),ud[3]=.5*ut,ut=.5/ut,ud[0]=(ub[5]-ub[7])*ut,ud[1]=(ub[6]-ub[2])*ut,ud[2]=(ub[1]-ub[3])*ut;else{var uO=0;ub[4]>ub[0]&&(uO=1),ub[8]>ub[3*uO+uO]&&(uO=2);var uq=(uO+1)%3,uA=(uO+2)%3;ut=Math.sqrt(ub[3*uO+uO]-ub[3*uq+uq]-ub[3*uA+uA]+1),ud[uO]=.5*ut,ut=.5/ut,ud[3]=(ub[3*uq+uA]-ub[3*uA+uq])*ut,ud[uq]=(ub[3*uq+uO]+ub[3*uO+uq])*ut,ud[uA]=(ub[3*uA+uO]+ub[3*uO+uA])*ut}},ub.createFromMatrix4x4=function(uW,uj){var ut,ud,ub=uW.elements,uE=uj.elements,uO=ub[0]+ub[5]+ub[10];0<uO?(ut=Math.sqrt(uO+1),uE[3]=.5*ut,ut=.5/ut,uE[0]=(ub[6]-ub[9])*ut,uE[1]=(ub[8]-ub[2])*ut,uE[2]=(ub[1]-ub[4])*ut):ub[0]>=ub[5]&&ub[0]>=ub[10]?(ud=.5/(ut=Math.sqrt(1+ub[0]-ub[5]-ub[10])),uE[0]=.5*ut,uE[1]=(ub[1]+ub[4])*ud,uE[2]=(ub[2]+ub[8])*ud,uE[3]=(ub[6]-ub[9])*ud):ub[5]>ub[10]?(ud=.5/(ut=Math.sqrt(1+ub[5]-ub[0]-ub[10])),uE[0]=(ub[4]+ub[1])*ud,uE[1]=.5*ut,uE[2]=(ub[9]+ub[6])*ud,uE[3]=(ub[8]-ub[2])*ud):(ud=.5/(ut=Math.sqrt(1+ub[10]-ub[0]-ub[5])),uE[0]=(ub[8]+ub[2])*ud,uE[1]=(ub[9]+ub[6])*ud,uE[2]=.5*ut,uE[3]=(ub[1]-ub[4])*ud)},ub.slerp=function(uW,uj,ut,ud){var ub,uE,uO,uq,uA,uc=uW.elements,uR=uj.elements,um=ud.elements,uQ=uc[0],uT=uc[1],u$=uc[2],ue=uc[3],uK=uR[0],uo=uR[1],uS=uR[2],uM=uR[3];return(uE=uQ*uK+uT*uo+u$*uS+ue*uM)<0&&(uE=-uE,uK=-uK,uo=-uo,uS=-uS,uM=-uM),uA=1e-6<1-uE?(ub=Math.acos(uE),uO=Math.sin(ub),uq=Math.sin((1-ut)*ub)/uO,Math.sin(ut*ub)/uO):(uq=1-ut,ut),um[0]=uq*uQ+uA*uK,um[1]=uq*uT+uA*uo,um[2]=uq*u$+uA*uS,um[3]=uq*ue+uA*uM,um},ub.lerp=function(uW,uj,ut,ud){var ub=ud.elements,uE=uW.elements,uO=uj.elements,uq=uE[0],uA=uE[1],uc=uE[2],uR=uE[3];ub[0]=uq+ut*(uO[0]-uq),ub[1]=uA+ut*(uO[1]-uA),ub[2]=uc+ut*(uO[2]-uc),ub[3]=uR+ut*(uO[3]-uR)},ub.add=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj.elements;ud[0]=ub[0]+uE[0],ud[1]=ub[1]+uE[1],ud[2]=ub[2]+uE[2],ud[3]=ub[3]+uE[3]},ub.dot=function(uW,uj){var ut=uW.elements,ud=uj.elements;return ut[0]*ud[0]+ut[1]*ud[1]+ut[2]*ud[2]+ut[3]*ud[3]},ub.rotationLookAt=function(uW,uj,ut){ub.lookAt(uOj.ZERO,uW,uj,ut)},ub.lookAt=function(uW,uj,ut,ud){uFW.lookAt(uW,uj,ut,ub._tempMatrix3x3),ub.rotationMatrix(ub._tempMatrix3x3,ud)},ub.invert=function(uW,uj){var ut=uW.elements,ud=uj.elements,ub=uW.lengthSquared();upW.isZero(ub)||(ub=1/ub,ud[0]=-ut[0]*ub,ud[1]=-ut[1]*ub,ud[2]=-ut[2]*ub,ud[3]=ut[3]*ub)},ub.rotationMatrix=function(uW,uj){var ut=uW.elements,ud=ut[0],ub=ut[1],uE=ut[2],uO=ut[3],uq=ut[4],uA=ut[5],uc=ut[6],uR=ut[7],um=ut[8],uQ=uj.elements,uT=NaN,u$=NaN,ue=ud+uq+um;0<ue?(uT=Math.sqrt(ue+1),uQ[3]=.5*uT,uT=.5/uT,uQ[0]=(uA-uR)*uT,uQ[1]=(uc-uE)*uT,uQ[2]=(ub-uO)*uT):uq<=ud&&um<=ud?(u$=.5/(uT=Math.sqrt(1+ud-uq-um)),uQ[0]=.5*uT,uQ[1]=(ub+uO)*u$,uQ[2]=(uE+uc)*u$,uQ[3]=(uA-uR)*u$):um<uq?(u$=.5/(uT=Math.sqrt(1+uq-ud-um)),uQ[0]=(uO+ub)*u$,uQ[1]=.5*uT,uQ[2]=(uR+uA)*u$,uQ[3]=(uc-uE)*u$):(u$=.5/(uT=Math.sqrt(1+um-ud-uq)),uQ[0]=(uc+uE)*u$,uQ[1]=(uR+uA)*u$,uQ[2]=.5*uT,uQ[3]=(ub-uO)*u$)},ub.DEFAULT=new ub,um(ub,["TEMPVector30",function(){return this.TEMPVector30=new uOj},"TEMPVector31",function(){return this.TEMPVector31=new uOj},"TEMPVector32",function(){return this.TEMPVector32=new uOj},"TEMPVector33",function(){return this.TEMPVector33=new uOj},"TEMPMatrix0",function(){return this.TEMPMatrix0=new uWj},"TEMPMatrix1",function(){return this.TEMPMatrix1=new uWj},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new uFW},"NAN",function(){return this.NAN=new ub(NaN,NaN,NaN,NaN)}]),ub}(),udj=function(){function uW(uW){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=uW,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}uT(uW,"laya.d3.math.Rand");var uj=uW.prototype;return uj.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},uj.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},uj.getSignedFloat=function(){return 2*this.getFloat()-1},u$(0,uj,"seed",function(){return this.seeds[0]},function(uW){this.seeds[0]=uW,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),uW.getFloatFromInt=function(uW){return 1/8388607*(8388607&uW)},uW.getByteFromInt=function(uW){return(8388607&uW)>>>15},uW}(),ubj=(function(){function ub(uW){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(uW instanceof Array)||4!==uW.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|uW[0],this._state0L=0|uW[1],this._state1U=0|uW[2],this._state1L=0|uW[3]}uT(ub,"laya.d3.math.RandX");var uW=ub.prototype;uW.randomint=function(){var uW=this._state0U,uj=this._state0L,ut=this._state1U,ud=this._state1L,ub=(ud>>>0)+(uj>>>0),uE=ut+uW+(ub/2>>>31)>>>0,uO=ub>>>0,uq=0,uA=0;uq=(uW^=uq=uW<<23|(-512&uj)>>>9)^(this._state0U=ut),uA=(uj^=uA=uj<<23)^(this._state0L=ud);uq^=uW>>>18,uA^=uj>>>18|(262143&uW)<<14;return uq^=ut>>>5,uA^=ud>>>5|(31&ut)<<27,this._state1U=uq,this._state1L=uA,[uE,uO]},uW.random=function(){var uW=this.randomint(),uj=uW[0],ut=1023<<20|uj>>>12,ud=0|(uW[1]>>>12|(4095&uj)<<20);return ub._CONVERTION_BUFFER.setUint32(0,ut,!1),ub._CONVERTION_BUFFER.setUint32(4,ud,!1),udj._CONVERTION_BUFFER.getFloat64(0,!1)-1},um(ub,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new udj([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function uW(uW,uj){this.origin=null,this.direction=null,this.origin=uW,this.direction=uj}return uT(uW,"laya.d3.math.Ray"),uW}()),uEj=function(){function uW(uW,uj){this.elements=new Float32Array(2),void 0===uW&&(uW=0),void 0===uj&&(uj=0);var ut=this.elements;ut[0]=uW,ut[1]=uj}uT(uW,"laya.d3.math.Vector2");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.core.IClone":!0}),uj.fromArray=function(uW,uj){void 0===uj&&(uj=0),this.elements[0]=uW[uj+0],this.elements[1]=uW[uj+1]},uj.cloneTo=function(uW){var uj=uW.elements,ut=this.elements;uj[0]=ut[0],uj[1]=ut[1]},uj.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uj,"x",function(){return this.elements[0]},function(uW){this.elements[0]=uW}),u$(0,uj,"y",function(){return this.elements[1]},function(uW){this.elements[1]=uW}),uW.scale=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements;ud[0]=ub[0]*uj,ud[1]=ub[1]*uj},um(uW,["ZERO",function(){return this.ZERO=new uW(0,0)},"ONE",function(){return this.ONE=new uW(1,1)}]),uW}(),uOj=function(){function uR(uW,uj,ut){this.elements=new Float32Array(3),void 0===uW&&(uW=0),void 0===uj&&(uj=0),void 0===ut&&(ut=0);var ud=this.elements;ud[0]=uW,ud[1]=uj,ud[2]=ut}uT(uR,"laya.d3.math.Vector3");var uW=uR.prototype;return uX.imps(uW,{"laya.d3.core.IClone":!0}),uW.fromArray=function(uW,uj){void 0===uj&&(uj=0),this.elements[0]=uW[uj+0],this.elements[1]=uW[uj+1],this.elements[2]=uW[uj+2]},uW.cloneTo=function(uW){var uj=uW.elements,ut=this.elements;uj[0]=ut[0],uj[1]=ut[1],uj[2]=ut[2]},uW.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},uW.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},uW.reset=function(uW,uj,ut){this.elements[0]=uW,this.elements[1]=uj,this.elements[2]=ut},u$(0,uW,"x",function(){return this.elements[0]},function(uW){this.elements[0]=uW}),u$(0,uW,"y",function(){return this.elements[1]},function(uW){this.elements[1]=uW}),u$(0,uW,"z",function(){return this.elements[2]},function(uW){this.elements[2]=uW}),uR.distanceSquared=function(uW,uj){var ut=uW.elements,ud=uj.elements,ub=ut[0]-ud[0],uE=ut[1]-ud[1],uO=ut[2]-ud[2];return ub*ub+uE*uE+uO*uO},uR.distance=function(uW,uj){var ut=uW.elements,ud=uj.elements,ub=ut[0]-ud[0],uE=ut[1]-ud[1],uO=ut[2]-ud[2];return Math.sqrt(ub*ub+uE*uE+uO*uO)},uR.min=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj.elements;ud[0]=Math.min(ub[0],uE[0]),ud[1]=Math.min(ub[1],uE[1]),ud[2]=Math.min(ub[2],uE[2])},uR.max=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj.elements;ud[0]=Math.max(ub[0],uE[0]),ud[1]=Math.max(ub[1],uE[1]),ud[2]=Math.max(ub[2],uE[2])},uR.transformQuat=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj.elements,uO=ub[0],uq=ub[1],uA=ub[2],uc=uE[0],uR=uE[1],um=uE[2],uQ=uE[3],uT=uQ*uO+uR*uA-um*uq,u$=uQ*uq+um*uO-uc*uA,ue=uQ*uA+uc*uq-uR*uO,uK=-uc*uO-uR*uq-um*uA;ud[0]=uT*uQ+uK*-uc+u$*-um-ue*-uR,ud[1]=u$*uQ+uK*-uR+ue*-uc-uT*-um,ud[2]=ue*uQ+uK*-um+uT*-uR-u$*-uc},uR.scalarLength=function(uW){var uj=uW.elements,ut=uj[0],ud=uj[1],ub=uj[2];return Math.sqrt(ut*ut+ud*ud+ub*ub)},uR.scalarLengthSquared=function(uW){var uj=uW.elements,ut=uj[0],ud=uj[1],ub=uj[2];return ut*ut+ud*ud+ub*ub},uR.normalize=function(uW,uj){var ut=uW.elements,ud=uj.elements,ub=ut[0],uE=ut[1],uO=ut[2],uq=ub*ub+uE*uE+uO*uO;0<uq&&(uq=1/Math.sqrt(uq),ud[0]=ut[0]*uq,ud[1]=ut[1]*uq,ud[2]=ut[2]*uq)},uR.multiply=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj.elements;ud[0]=ub[0]*uE[0],ud[1]=ub[1]*uE[1],ud[2]=ub[2]*uE[2]},uR.scale=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements;ud[0]=ub[0]*uj,ud[1]=ub[1]*uj,ud[2]=ub[2]*uj},uR.lerp=function(uW,uj,ut,ud){var ub=ud.elements,uE=uW.elements,uO=uj.elements,uq=uE[0],uA=uE[1],uc=uE[2];ub[0]=uq+ut*(uO[0]-uq),ub[1]=uA+ut*(uO[1]-uA),ub[2]=uc+ut*(uO[2]-uc)},uR.transformV3ToV3=function(uW,uj,ut){var ud=uR._tempVector4;uR.transformV3ToV4(uW,uj,ud);var ub=ud.elements,uE=ut.elements;uE[0]=ub[0],uE[1]=ub[1],uE[2]=ub[2]},uR.transformV3ToV4=function(uW,uj,ut){var ud=uW.elements,ub=ud[0],uE=ud[1],uO=ud[2],uq=uj.elements,uA=ut.elements;uA[0]=ub*uq[0]+uE*uq[4]+uO*uq[8]+uq[12],uA[1]=ub*uq[1]+uE*uq[5]+uO*uq[9]+uq[13],uA[2]=ub*uq[2]+uE*uq[6]+uO*uq[10]+uq[14],uA[3]=ub*uq[3]+uE*uq[7]+uO*uq[11]+uq[15]},uR.TransformNormal=function(uW,uj,ut){var ud=uW.elements,ub=ud[0],uE=ud[1],uO=ud[2],uq=uj.elements,uA=ut.elements;uA[0]=ub*uq[0]+uE*uq[4]+uO*uq[8],uA[1]=ub*uq[1]+uE*uq[5]+uO*uq[9],uA[2]=ub*uq[2]+uE*uq[6]+uO*uq[10]},uR.transformCoordinate=function(uW,uj,ut){var ud=uR._tempVector4.elements,ub=uW.elements,uE=ub[0],uO=ub[1],uq=ub[2],uA=uj.elements;ud[0]=uE*uA[0]+uO*uA[4]+uq*uA[8]+uA[12],ud[1]=uE*uA[1]+uO*uA[5]+uq*uA[9]+uA[13],ud[2]=uE*uA[2]+uO*uA[6]+uq*uA[10]+uA[14],ud[3]=1/(uE*uA[3]+uO*uA[7]+uq*uA[11]+uA[15]);var uc=ut.elements;uc[0]=ud[0]*ud[3],uc[1]=ud[1]*ud[3],uc[2]=ud[2]*ud[3]},uR.Clamp=function(uW,uj,ut,ud){var ub=uW.elements,uE=ub[0],uO=ub[1],uq=ub[2],uA=uj.elements,uc=uA[0],uR=uA[1],um=uA[2],uQ=ut.elements,uT=uQ[0],u$=uQ[1],ue=uQ[2],uK=ud.elements;uE=(uE=uT<uE?uT:uE)<uc?uc:uE,uO=(uO=u$<uO?u$:uO)<uR?uR:uO,uq=(uq=ue<uq?ue:uq)<um?um:uq,uK[0]=uE,uK[1]=uO,uK[2]=uq},uR.add=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj.elements;ud[0]=ub[0]+uE[0],ud[1]=ub[1]+uE[1],ud[2]=ub[2]+uE[2]},uR.subtract=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj.elements;ud[0]=ub[0]-uE[0],ud[1]=ub[1]-uE[1],ud[2]=ub[2]-uE[2]},uR.cross=function(uW,uj,ut){var ud=uW.elements,ub=uj.elements,uE=ut.elements,uO=ud[0],uq=ud[1],uA=ud[2],uc=ub[0],uR=ub[1],um=ub[2];uE[0]=uq*um-uA*uR,uE[1]=uA*uc-uO*um,uE[2]=uO*uR-uq*uc},uR.dot=function(uW,uj){var ut=uW.elements,ud=uj.elements;return ut[0]*ud[0]+ut[1]*ud[1]+ut[2]*ud[2]},uR.equals=function(uW,uj){var ut=uW.elements,ud=uj.elements;return upW.nearEqual(Math.abs(ut[0]),Math.abs(ud[0]))&&upW.nearEqual(Math.abs(ut[1]),Math.abs(ud[1]))&&upW.nearEqual(Math.abs(ut[2]),Math.abs(ud[2]))},uR.ZERO=new uR(0,0,0),uR.ONE=new uR(1,1,1),uR.NegativeUnitX=new uR(-1,0,0),uR.UnitX=new uR(1,0,0),uR.UnitY=new uR(0,1,0),uR.UnitZ=new uR(0,0,1),uR.ForwardRH=new uR(0,0,-1),uR.ForwardLH=new uR(0,0,1),uR.Up=new uR(0,1,0),uR.NAN=new uR(NaN,NaN,NaN),um(uR,["_tempVector4",function(){return this._tempVector4=new uqj}]),uR}(),uqj=function(){function uW(uW,uj,ut,ud){this.elements=new Float32Array(4),void 0===uW&&(uW=0),void 0===uj&&(uj=0),void 0===ut&&(ut=0),void 0===ud&&(ud=0);var ub=this.elements;ub[0]=uW,ub[1]=uj,ub[2]=ut,ub[3]=ud}uT(uW,"laya.d3.math.Vector4");var uj=uW.prototype;return uX.imps(uj,{"laya.d3.core.IClone":!0}),uj.fromArray=function(uW,uj){void 0===uj&&(uj=0),this.elements[0]=uW[uj+0],this.elements[1]=uW[uj+1],this.elements[2]=uW[uj+2],this.elements[3]=uW[uj+3]},uj.cloneTo=function(uW){var uj=uW.elements,ut=this.elements;uj[0]=ut[0],uj[1]=ut[1],uj[2]=ut[2],uj[3]=ut[3]},uj.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},uj.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},uj.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},u$(0,uj,"x",function(){return this.elements[0]},function(uW){this.elements[0]=uW}),u$(0,uj,"y",function(){return this.elements[1]},function(uW){this.elements[1]=uW}),u$(0,uj,"z",function(){return this.elements[2]},function(uW){this.elements[2]=uW}),u$(0,uj,"w",function(){return this.elements[3]},function(uW){this.elements[3]=uW}),uW.lerp=function(uW,uj,ut,ud){var ub=ud.elements,uE=uW.elements,uO=uj.elements,uq=uE[0],uA=uE[1],uc=uE[2],uR=uE[3];ub[0]=uq+ut*(uO[0]-uq),ub[1]=uA+ut*(uO[1]-uA),ub[2]=uc+ut*(uO[2]-uc),ub[3]=uR+ut*(uO[3]-uR)},uW.transformByM4x4=function(uW,uj,ut){var ud=uW.elements,ub=ud[0],uE=ud[1],uO=ud[2],uq=ud[3],uA=uj.elements,uc=ut.elements;uc[0]=ub*uA[0]+uE*uA[4]+uO*uA[8]+uq*uA[12],uc[1]=ub*uA[1]+uE*uA[5]+uO*uA[9]+uq*uA[13],uc[2]=ub*uA[2]+uE*uA[6]+uO*uA[10]+uq*uA[14],uc[3]=ub*uA[3]+uE*uA[7]+uO*uA[11]+uq*uA[15]},uW.equals=function(uW,uj){var ut=uW.elements,ud=uj.elements;return upW.nearEqual(Math.abs(ut[0]),Math.abs(ud[0]))&&upW.nearEqual(Math.abs(ut[1]),Math.abs(ud[1]))&&upW.nearEqual(Math.abs(ut[2]),Math.abs(ud[2]))&&upW.nearEqual(Math.abs(ut[3]),Math.abs(ud[3]))},uW.normalize=function(uW,uj){var ut=uW.elements,ud=uj.elements,ub=uW.length();0<ub&&(ud[0]=ut[0]*ub,ud[1]=ut[1]*ub,ud[2]=ut[2]*ub,ud[3]=ut[3]*ub)},uW.add=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj.elements;ud[0]=ub[0]+uE[0],ud[1]=ub[1]+uE[1],ud[2]=ub[2]+uE[2],ud[3]=ub[3]+uE[3]},uW.subtract=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj.elements;ud[0]=ub[0]-uE[0],ud[1]=ub[1]-uE[1],ud[2]=ub[2]-uE[2],ud[3]=ub[3]-uE[3]},uW.multiply=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj.elements;ud[0]=ub[0]*uE[0],ud[1]=ub[1]*uE[1],ud[2]=ub[2]*uE[2],ud[3]=ub[3]*uE[3]},uW.scale=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements;ud[0]=ub[0]*uj,ud[1]=ub[1]*uj,ud[2]=ub[2]*uj,ud[3]=ub[3]*uj},uW.Clamp=function(uW,uj,ut,ud){var ub=uW.elements,uE=ub[0],uO=ub[1],uq=ub[2],uA=ub[3],uc=uj.elements,uR=uc[0],um=uc[1],uQ=uc[2],uT=uc[3],u$=ut.elements,ue=u$[0],uK=u$[1],uo=u$[2],uS=u$[3],uM=ud.elements;uE=(uE=ue<uE?ue:uE)<uR?uR:uE,uO=(uO=uK<uO?uK:uO)<um?um:uO,uq=(uq=uo<uq?uo:uq)<uQ?uQ:uq,uA=(uA=uS<uA?uS:uA)<uT?uT:uA,uM[0]=uE,uM[1]=uO,uM[2]=uq,uM[3]=uA},uW.distanceSquared=function(uW,uj){var ut=uW.elements,ud=uj.elements,ub=ut[0]-ud[0],uE=ut[1]-ud[1],uO=ut[2]-ud[2],uq=ut[3]-ud[3];return ub*ub+uE*uE+uO*uO+uq*uq},uW.distance=function(uW,uj){var ut=uW.elements,ud=uj.elements,ub=ut[0]-ud[0],uE=ut[1]-ud[1],uO=ut[2]-ud[2],uq=ut[3]-ud[3];return Math.sqrt(ub*ub+uE*uE+uO*uO+uq*uq)},uW.dot=function(uW,uj){var ut=uW.elements,ud=uj.elements;return ut[0]*ud[0]+ut[1]*ud[1]+ut[2]*ud[2]+ut[3]*ud[3]},uW.min=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj.elements;ud[0]=Math.min(ub[0],uE[0]),ud[1]=Math.min(ub[1],uE[1]),ud[2]=Math.min(ub[2],uE[2]),ud[3]=Math.min(ub[3],uE[3])},uW.max=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj.elements;ud[0]=Math.max(ub[0],uE[0]),ud[1]=Math.max(ub[1],uE[1]),ud[2]=Math.max(ub[2],uE[2]),ud[3]=Math.max(ub[3],uE[3])},um(uW,["ZERO",function(){return this.ZERO=new uW},"ONE",function(){return this.ONE=new uW(1,1,1,1)},"UnitX",function(){return this.UnitX=new uW(1,0,0,0)},"UnitY",function(){return this.UnitY=new uW(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new uW(0,0,1,0)},"UnitW",function(){return this.UnitW=new uW(0,0,0,1)}]),uW}(),uAj=function(){function uE(uW,uj,ut,ud){this.minDepth=0,this.maxDepth=1,this.x=uW,this.y=uj,this.width=ut,this.height=ud}uT(uE,"laya.d3.math.Viewport");var uW=uE.prototype;return uW.project=function(uW,uj,ut){uOj.transformV3ToV3(uW,uj,ut);var ud=uW.elements,ub=uj.elements,uE=ut.elements,uO=ud[0]*ub[3]+ud[1]*ub[7]+ud[2]*ub[11]+ub[15];1!==uO&&(uE[0]=uE[0]/uO,uE[1]=uE[1]/uO,uE[2]=uE[2]/uO),uE[0]=.5*(uE[0]+1)*this.width+this.x,uE[1]=.5*(1-uE[1])*this.height+this.y,uE[2]=uE[2]*(this.maxDepth-this.minDepth)+this.minDepth},uW.unprojectFromMat=function(uW,uj,ut){var ud=uW.elements,ub=uj.elements,uE=ut.elements;uE[0]=(ud[0]-this.x)/this.width*2-1,uE[1]=-((ud[1]-this.y)/this.height*2-1);var uO=(this.maxDepth-this.minDepth)/2;uE[2]=(ud[2]-this.minDepth-uO)/uO;var uq=uE[0]*ub[3]+uE[1]*ub[7]+uE[2]*ub[11]+ub[15];uOj.transformV3ToV3(ut,uj,ut),1!==uq&&(uE[0]=uE[0]/uq,uE[1]=uE[1]/uq,uE[2]=uE[2]/uq)},uW.unprojectFromWVP=function(uW,uj,ut,ud,ub){uWj.multiply(uj,ut,uE._tempMatrix4x4),ud&&uWj.multiply(uE._tempMatrix4x4,ud,uE._tempMatrix4x4),uE._tempMatrix4x4.invert(uE._tempMatrix4x4),this.unprojectFromMat(uW,uE._tempMatrix4x4,ub)},um(uE,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new uWj}]),uE}(),ucj=function(){function ux(uW){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=uW,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}uT(ux,"laya.d3.resource.models.SubMesh");var uW=ux.prototype;return uX.imps(uW,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),uW._getVertexBuffer=function(uW){return void 0===uW&&(uW=0),0===uW?this._vertexBuffer:null},uW._getIndexBuffer=function(){return this._indexBuffer},uW._getStaticBatchBakedVertexs=function(uW,uj){var ut,ud,ub=this._vertexBuffer,uE=ub.vertexDeclaration,uO=uE.getVertexElementByUsage(0).offset/4,uq=uE.getVertexElementByUsage(3).offset/4,uA=uj.meshRender.lightmapScaleOffset,uc=0,uR=0,um=0,uQ=0,uT=0,u$=0;if(uA)if(ud=uE.getVertexElementByUsage(15))um=uE.vertexStride/4,ut=0<this._vertexCount?ub.getData().slice(this._vertexStart*um,(this._vertexStart+this._vertexCount)*um):ub.getData().slice(),uQ=ud.offset/4;else{um=(u$=uE.vertexStride/4)+2,ut=this._vertexCount?new Float32Array(this._vertexCount*(ub.vertexDeclaration.vertexStride/4+2)):new Float32Array(ub.vertexCount*(ub.vertexDeclaration.vertexStride/4+2)),uQ=(uT=uE.getVertexElementByUsage(2).offset/4)+2;var ue=ub.getData();for(uc=0,uR=ue.length/u$;uc<uR;uc++){var uK=0;uK=0<this._vertexCount?(this._vertexStart+uc)*u$:uc*u$;var uo=uc*um,uS=0;for(uS=0;uS<uQ;uS++)ut[uo+uS]=ue[uK+uS];for(uS=uQ;uS<u$;uS++)ut[uo+uS+2]=ue[uK+uS]}}else um=uE.vertexStride/4,ut=this._vertexCount?ub.getData().slice(this._vertexStart*um,(this._vertexStart+this._vertexCount)*um):ub.getData().slice();if(uW){var uM=uW.worldMatrix,uZ=ux._tempMatrix4x40;uM.invert(uZ);var uX=ux._tempMatrix4x41,u_=uj.transform.worldMatrix;uWj.multiply(uZ,u_,uX)}else uX=uj.transform.worldMatrix;var uN=ux._tempQuaternion0;for(uX.decomposeTransRotScale(ux._tempVector30,uN,ux._tempVector31),uc=0,uR=ut.length/um;uc<uR;uc++){var uz=uc*um+uO,uC=uc*um+uq;if(uKj.transformVector3ArrayToVector3ArrayCoordinate(ut,uz,uX,ut,uz),uKj.transformVector3ArrayByQuat(ut,uC,uN,ut,uC),uA){var uL=uc*um+uQ;if(ud)uKj.transformLightingMapTexcoordByUV1Array(ut,uL,uA,ut,uL);else{var uV=uc*u$+uT;uKj.transformLightingMapTexcoordByUV0Array(ue,uV,uA,ut,uL)}}}return ut},uW._getVertexBuffers=function(){return null},uW._beforeRender=function(uW){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},uW._render=function(uW){var uj,ut=0,ud=uW.renderElement;if(1<this._indexCount){var ub=this._boneIndicesList.length;if(1<ub){for(var uE=0;uE<ub;uE++)(uj=ud._skinAnimationDatas||this._skinAnimationDatas)&&(ud._shaderValue.setValue(0,uj[uE]),uW._shader.uploadRenderElementUniforms(ud._shaderValue.data)),uG.mainContext.drawElements(4,this._subIndexBufferCount[uE],5123,2*this._subIndexBufferStart[uE]);uz.drawCall+=ub}else(uj=ud._skinAnimationDatas||this._skinAnimationDatas)&&(ud._shaderValue.setValue(0,uj[0]),uW._shader.uploadRenderElementUniforms(ud._shaderValue.data)),uG.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),uz.drawCall++;ut=this._indexCount}else ut=this._indexBuffer.indexCount,(uj=ud._skinAnimationDatas||this._skinAnimationDatas)&&(ud._shaderValue.setValue(0,uj[0]),uW._shader.uploadRenderElementUniforms(ud._shaderValue.data)),uG.mainContext.drawElements(4,ut,5123,0),uz.drawCall++;uz.trianglesFaces+=ut/3},uW.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},uW.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},u$(0,uW,"_vertexBufferCount",function(){return 1}),u$(0,uW,"triangleCount",function(){return this._indexBuffer.indexCount/3}),um(ux,["_tempVector30",function(){return this._tempVector30=new uOj},"_tempVector31",function(){return this._tempVector31=new uOj},"_tempQuaternion0",function(){return this._tempQuaternion0=new utj},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new uWj},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new uWj}]),ux}(),uRj=function(){function uW(uW){this.defineCounter=0,this.defines=null,uW?(this.defineCounter=uW.defineCounter,this.defines=uW.defines.slice()):(this.defineCounter=0,this.defines=[])}return uT(uW,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),uW.prototype.registerDefine=function(uW){var uj=Math.pow(2,this.defineCounter++);return this.defines[uj]=uW,uj},uW}(),umj=function(){function uW(){}return uT(uW,"laya.d3.shader.ShaderInit3D"),uW.__init__=function(){var uW,uj;uzj._globalRegDefine("HIGHPRECISION",uzj.SHADERDEFINE_HIGHPRECISION),uzj._globalRegDefine("FOG",uzj.SHADERDEFINE_FOG),uzj._globalRegDefine("DIRECTIONLIGHT",uzj.SHADERDEFINE_DIRECTIONLIGHT),uzj._globalRegDefine("POINTLIGHT",uzj.SHADERDEFINE_POINTLIGHT),uzj._globalRegDefine("SPOTLIGHT",uzj.SHADERDEFINE_SPOTLIGHT),uzj._globalRegDefine("UV",uzj.SHADERDEFINE_UV0),uzj._globalRegDefine("COLOR",uzj.SHADERDEFINE_COLOR),uzj._globalRegDefine("UV1",uzj.SHADERDEFINE_UV1),uzj._globalRegDefine("CASTSHADOW",uTj.SHADERDEFINE_CAST_SHADOW),uzj._globalRegDefine("SHADOWMAP_PSSM1",uTj.SHADERDEFINE_SHADOW_PSSM1),uzj._globalRegDefine("SHADOWMAP_PSSM2",uTj.SHADERDEFINE_SHADOW_PSSM2),uzj._globalRegDefine("SHADOWMAP_PSSM3",uTj.SHADERDEFINE_SHADOW_PSSM3),uzj._globalRegDefine("SHADOWMAP_PCF_NO",uTj.SHADERDEFINE_SHADOW_PCF_NO),uzj._globalRegDefine("SHADOWMAP_PCF1",uTj.SHADERDEFINE_SHADOW_PCF1),uzj._globalRegDefine("SHADOWMAP_PCF2",uTj.SHADERDEFINE_SHADOW_PCF2),uzj._globalRegDefine("SHADOWMAP_PCF3",uTj.SHADERDEFINE_SHADOW_PCF3),uzj._globalRegDefine("DEPTHFOG",uzj.SAHDERDEFINE_DEPTHFOG),uuj.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),uuj.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),uW={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},uj={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var ut=uuj.nameKey.add("SIMPLE");shaderCompile=uzj.add(ut,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',uW,uj),uDj.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),uDj.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),uDj.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),uDj.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),uDj.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),uDj.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),uDj.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),uDj.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),uDj.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},uW}(),uQj=function(){function uW(){this._data=null,this._data=[]}uT(uW,"laya.d3.shader.ValusArray");var uj=uW.prototype;return uj.setValue=function(uW,uj){this._data[uW]=uj},u$(0,uj,"data",function(){return this._data}),uW}(),uTj=function(){function uW(){}return uW.SHADERDEFINE_RECEIVE_SHADOW=1,uW.SHADERDEFINE_CAST_SHADOW=512,uW.SHADERDEFINE_SHADOW_PSSM1=1024,uW.SHADERDEFINE_SHADOW_PSSM2=2048,uW.SHADERDEFINE_SHADOW_PSSM3=4096,uW.SHADERDEFINE_SHADOW_PCF_NO=8192,uW.SHADERDEFINE_SHADOW_PCF1=16384,uW.SHADERDEFINE_SHADOW_PCF2=32768,uW.SHADERDEFINE_SHADOW_PCF3=65536,uW.MAX_PSSM_COUNT=3,uW}(),u$j=function(){function uP(){}return uT(uP,"laya.d3.utils.Picker"),uP.calculateCursorRay=function(uW,uj,ut,ud,ub,uE){var uO=uW.elements[0],uq=uW.elements[1],uA=uP._tempVector30,uc=uA.elements;uc[0]=uO,uc[1]=uq,uc[2]=uj.minDepth;var uR=uP._tempVector31,um=uR.elements;um[0]=uO,um[1]=uq,um[2]=uj.maxDepth;var uQ=uE.origin,uT=uP._tempVector32;uj.unprojectFromWVP(uA,ut,ud,ub,uQ),uj.unprojectFromWVP(uR,ut,ud,ub,uT);var u$=uE.direction.elements;u$[0]=uT.x-uQ.x,u$[1]=uT.y-uQ.y,u$[2]=uT.z-uQ.z,uOj.normalize(uE.direction,uE.direction)},uP.rayIntersectsPositionsAndIndices=function(uW,uj,ut,ud,ub){for(var uE=ut.vertexStride/4,uO=ut.getVertexElementByUsage(0).offset/4,uq=Number.MAX_VALUE,uA=-1,uc=-1,uR=-1,um=0;um<ud.length;um+=3){var uQ=uP._tempVector35,uT=uQ.elements,u$=ud[um]*uE,ue=u$+uO;uT[0]=uj[ue],uT[1]=uj[1+ue],uT[2]=uj[2+ue];var uK=uP._tempVector36,uo=uK.elements,uS=ud[um+1]*uE,uM=uS+uO;uo[0]=uj[uM],uo[1]=uj[1+uM],uo[2]=uj[2+uM];var uZ=uP._tempVector37,uX=uZ.elements,u_=ud[um+2]*uE,uN=u_+uO;uX[0]=uj[uN],uX[1]=uj[1+uN],uX[2]=uj[2+uN];var uz=laya.d3.utils.Picker.rayIntersectsTriangle(uW,uQ,uK,uZ);!isNaN(uz)&&uz<uq&&(uq=uz,uA=u$,uc=uS,uR=u_)}if(uq===Number.MAX_VALUE)return ub.position.toDefault(),ub.distance=Number.MAX_VALUE,ub.trianglePositions[0].toDefault(),ub.trianglePositions[1].toDefault(),ub.trianglePositions[2].toDefault(),ub.triangleNormals[0].toDefault(),ub.triangleNormals[1].toDefault(),ub.triangleNormals[2].toDefault(),!1;ub.distance=uq,uOj.scale(uW.direction,uq,ub.position),uOj.add(uW.origin,ub.position,ub.position);var uC=ub.trianglePositions,uL=uC[0],uV=uC[1],ux=uC[2],uG=uL.elements,ul=uV.elements,uh=ux.elements,uv=uA+uO;uG[0]=uj[uv],uG[1]=uj[uv+1],uG[2]=uj[uv+2];var uy=uc+uO;ul[0]=uj[uy],ul[1]=uj[uy+1],ul[2]=uj[uy+2];var ua=uR+uO;uh[0]=uj[ua],uh[1]=uj[ua+1],uh[2]=uj[ua+2];var uu=ut.getVertexElementByUsage(3);if(uu){var uD=uu.offset/4,us=ub.triangleNormals,uY=us[0],uH=us[1],uI=us[2],ug=uY.elements,uf=uH.elements,uw=uI.elements,uU=uA+uD;ug[0]=uj[uU],ug[1]=uj[uU+1],ug[2]=uj[uU+2];var uJ=uc+uD;uf[0]=uj[uJ],uf[1]=uj[uJ+1],uf[2]=uj[uJ+2];var ur=uR+uD;uw[0]=uj[ur],uw[1]=uj[ur+1],uw[2]=uj[ur+2]}return!0},uP.rayIntersectsTriangle=function(uW,uj,ut,ud){var ub=uP._tempVector30,uE=uP._tempVector31;uOj.subtract(ut,uj,ub),uOj.subtract(ud,uj,uE);var uO,uq=uP._tempVector32;if(uOj.cross(uW.direction,uE,uq),(uO=uOj.dot(ub,uq))>-Number.MIN_VALUE&&uO<Number.MIN_VALUE)return Number.NaN;var uA,uc=1/uO,uR=uP._tempVector33;if(uOj.subtract(uW.origin,uj,uR),uA=uOj.dot(uR,uq),(uA*=uc)<0||1<uA)return Number.NaN;var um,uQ,uT=uP._tempVector34;return uOj.cross(uR,ub,uT),um=uOj.dot(uW.direction,uT),(um*=uc)<0||1<uA+um?Number.NaN:(uQ=uOj.dot(uE,uT),(uQ*=uc)<0?Number.NaN:uQ)},um(uP,["_tempVector30",function(){return this._tempVector30=new uOj},"_tempVector31",function(){return this._tempVector31=new uOj},"_tempVector32",function(){return this._tempVector32=new uOj},"_tempVector33",function(){return this._tempVector33=new uOj},"_tempVector34",function(){return this._tempVector34=new uOj},"_tempVector35",function(){return this._tempVector35=new uOj},"_tempVector36",function(){return this._tempVector36=new uOj},"_tempVector37",function(){return this._tempVector37=new uOj}]),uP}(),uej=(function(){function uW(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new uOj,new uOj,new uOj],this.trianglePositions.length=3,this.triangleNormals=[new uOj,new uOj,new uOj],this.triangleNormals.length=3,this.position=new uOj}uT(uW,"laya.d3.utils.RaycastHit"),uW.prototype.cloneTo=function(uW){uW.distance=this.distance,this.trianglePositions[0].cloneTo(uW.trianglePositions[0]),this.trianglePositions[1].cloneTo(uW.trianglePositions[1]),this.trianglePositions[2].cloneTo(uW.trianglePositions[2]),this.triangleNormals[0].cloneTo(uW.triangleNormals[0]),this.triangleNormals[1].cloneTo(uW.triangleNormals[1]),this.triangleNormals[2].cloneTo(uW.triangleNormals[2]),this.position.cloneTo(uW.position),uW.sprite3D=this.sprite3D}}(),function(){function uW(uW,uj){this._width=0,this._height=0,this._width=uW,this._height=uj}uT(uW,"laya.d3.utils.Size");var uj=uW.prototype;return u$(0,uj,"width",function(){return-1===this._width?ui.clientWidth:this._width}),u$(0,uj,"height",function(){return-1===this._height?ui.clientHeight:this._height}),u$(1,uW,"fullScreen",function(){return new uW(-1,-1)}),uW}()),uKj=function(){function uv(){}return uT(uv,"laya.d3.utils.Utils3D"),uv._rotationTransformScaleSkinAnimation=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR,um){var uQ,uT,u$,ue,uK,uo=uv._tempArray16_0,uS=uv._tempArray16_1,uM=uv._tempArray16_2,uZ=ud+ud,uX=ub+ub,u_=uE+uE,uN=ud*uZ,uz=ub*uZ,uC=ub*uX,uL=uE*uZ,uV=uE*uX,ux=uE*u_,uG=uO*uZ,ul=uO*uX,uh=uO*u_;for(uo[15]=1,uo[0]=1-uC-ux,uo[1]=uz+uh,uo[2]=uL-ul,uo[4]=uz-uh,uo[5]=1-uN-ux,uo[6]=uV+uG,uo[8]=uL+ul,uo[9]=uV-uG,uo[10]=1-uN-uC,uS[15]=1,uS[0]=uq,uS[5]=uA,uS[10]=uc,uQ=0;uQ<4;uQ++)uT=uo[uQ],u$=uo[uQ+4],ue=uo[uQ+8],uK=uo[uQ+12],uM[uQ]=uT,uM[uQ+4]=u$,uM[uQ+8]=ue,uM[uQ+12]=uT*uW+u$*uj+ue*ut+uK;for(uQ=0;uQ<4;uQ++)uT=uM[uQ],u$=uM[uQ+4],ue=uM[uQ+8],uK=uM[uQ+12],uR[uQ+um]=uT*uS[0]+u$*uS[1]+ue*uS[2]+uK*uS[3],uR[uQ+um+4]=uT*uS[4]+u$*uS[5]+ue*uS[6]+uK*uS[7],uR[uQ+um+8]=uT*uS[8]+u$*uS[9]+ue*uS[10]+uK*uS[11],uR[uQ+um+12]=uT*uS[12]+u$*uS[13]+ue*uS[14]+uK*uS[15]},uv._createNodeByJson=function(uW,uj,ut,ud){if(!ut)switch(uj.type){case"Sprite3D":ut=new uaj;break;case"MeshSprite3D":ut=new uPj;break;case"SkinnedMeshSprite3D":ut=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":ut=new ShuriKenParticle3D;break;case"TrailSprite3D":ut=new TrailSprite3D;break;case"Terrain":ut=new Terrain;break;case"Camera":ut=new urj;break;case"DirectionLight":ut=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var ub=uj.props;if(ub)for(var uE in ub)ut[uE]=ub[uE];var uO=uj.customProps;uO&&(ut instanceof laya.d3.core.Sprite3D?(ut._parseBaseCustomProps(uO),ut._parseCustomProps(uW,ud,uO,uj),ut._parseCustomComponent(uW,ud,uj.components)):ut._parseCustomProps(uW,ud,uO,uj));var uq=uj.child;if(uq)for(var uA=0,uc=uq.length;uA<uc;uA++){var uR=uv._createNodeByJson(uW,uq[uA],null,ud);ut.addChild(uR)}return ut},uv._computeBoneAndAnimationDatasByBindPoseMatrxix=function(uW,uj,ut,ud,ub,uE){var uO,uq,uA=0,uc=0,uR=uW.length;for(uO=0;uO<uR;uA+=uW[uO].keyframeWidth,uc+=16,uO++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(uj[uA+0],uj[uA+1],uj[uA+2],uj[uA+3],uj[uA+4],uj[uA+5],uj[uA+6],uj[uA+7],uj[uA+8],uj[uA+9],ud,uc),0!=uO&&(uq=16*uW[uO].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(ud,uq,ud,uc,ud,uc));var um=ut.length;for(uO=0;uO<um;uO++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(ud,16*uE[uO],ut[uO],ub,16*uO)},uv._computeAnimationDatasByArrayAndMatrixFast=function(uW,uj,ut,ud){for(var ub=0,uE=uW.length;ub<uE;ub++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(uj,16*ud[ub],uW[ub],ut,16*ub)},uv._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(uW,uj,ut,ud,ub){var uE,uO,uq=0,uA=0,uc=uW.length;for(uE=0;uE<uc;uq+=uW[uE].keyframeWidth,uA+=16,uE++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(uj[uq+7],uj[uq+8],uj[uq+9],uj[uq+3],uj[uq+4],uj[uq+5],uj[uq+6],uj[uq+0],uj[uq+1],uj[uq+2],ud,uA),0!=uE&&(uO=16*uW[uE].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(ud,uO,ud,uA,ud,uA));var uR=ut.length;for(uE=0;uE<uR;uE++){var um=16*uE;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(ud,um,ut[uE],ub,um)}},uv._computeAnimationDatasByArrayAndMatrixFastOld=function(uW,uj,ut){for(var ud=uW.length,ub=0;ub<ud;ub++){var uE=16*ub;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(uj,uE,uW[ub],ut,uE)}},uv._computeRootAnimationData=function(uW,uj,ut){for(var ud=0,ub=0,uE=0,uO=uW.length;ud<uO;ub+=uW[ud].keyframeWidth,uE+=16,ud++)laya.d3.utils.Utils3D.createAffineTransformationArray(uj[ub+0],uj[ub+1],uj[ub+2],uj[ub+3],uj[ub+4],uj[ub+5],uj[ub+6],uj[ub+7],uj[ub+8],uj[ub+9],ut,uE)},uv.transformVector3ArrayByQuat=function(uW,uj,ut,ud,ub){var uE=ut.elements,uO=uW[uj],uq=uW[uj+1],uA=uW[uj+2],uc=uE[0],uR=uE[1],um=uE[2],uQ=uE[3],uT=uQ*uO+uR*uA-um*uq,u$=uQ*uq+um*uO-uc*uA,ue=uQ*uA+uc*uq-uR*uO,uK=-uc*uO-uR*uq-um*uA;ud[ub]=uT*uQ+uK*-uc+u$*-um-ue*-uR,ud[ub+1]=u$*uQ+uK*-uR+ue*-uc-uT*-um,ud[ub+2]=ue*uQ+uK*-um+uT*-uR-u$*-uc},uv.mulMatrixByArray=function(uW,uj,ut,ud,ub,uE){var uO,uq,uA,uc,uR;if(ub===ut){for(ut=uv._tempArray16_3,uO=0;uO<16;++uO)ut[uO]=ub[uE+uO];ud=0}for(uO=0;uO<4;uO++)uq=uW[uj+uO],uA=uW[uj+uO+4],uc=uW[uj+uO+8],uR=uW[uj+uO+12],ub[uE+uO]=uq*ut[ud+0]+uA*ut[ud+1]+uc*ut[ud+2]+uR*ut[ud+3],ub[uE+uO+4]=uq*ut[ud+4]+uA*ut[ud+5]+uc*ut[ud+6]+uR*ut[ud+7],ub[uE+uO+8]=uq*ut[ud+8]+uA*ut[ud+9]+uc*ut[ud+10]+uR*ut[ud+11],ub[uE+uO+12]=uq*ut[ud+12]+uA*ut[ud+13]+uc*ut[ud+14]+uR*ut[ud+15]},uv.mulMatrixByArrayFast=function(uW,uj,ut,ud,ub,uE){var uO,uq,uA,uc,uR;for(uO=0;uO<4;uO++)uq=uW[uj+uO],uA=uW[uj+uO+4],uc=uW[uj+uO+8],uR=uW[uj+uO+12],ub[uE+uO]=uq*ut[ud+0]+uA*ut[ud+1]+uc*ut[ud+2]+uR*ut[ud+3],ub[uE+uO+4]=uq*ut[ud+4]+uA*ut[ud+5]+uc*ut[ud+6]+uR*ut[ud+7],ub[uE+uO+8]=uq*ut[ud+8]+uA*ut[ud+9]+uc*ut[ud+10]+uR*ut[ud+11],ub[uE+uO+12]=uq*ut[ud+12]+uA*ut[ud+13]+uc*ut[ud+14]+uR*ut[ud+15]},uv.mulMatrixByArrayAndMatrixFast=function(uW,uj,ut,ud,ub){var uE,uO,uq,uA,uc,uR=ut.elements,um=uR[0],uQ=uR[1],uT=uR[2],u$=uR[3],ue=uR[4],uK=uR[5],uo=uR[6],uS=uR[7],uM=uR[8],uZ=uR[9],uX=uR[10],u_=uR[11],uN=uR[12],uz=uR[13],uC=uR[14],uL=uR[15],uV=uj,ux=uj+4,uG=uj+8,ul=uj+12,uh=ub,uv=ub+4,uy=ub+8,ua=ub+12;for(uE=0;uE<4;uE++)uO=uW[uV+uE],uq=uW[ux+uE],uA=uW[uG+uE],uc=uW[ul+uE],ud[uh+uE]=uO*um+uq*uQ+uA*uT+uc*u$,ud[uv+uE]=uO*ue+uq*uK+uA*uo+uc*uS,ud[uy+uE]=uO*uM+uq*uZ+uA*uX+uc*u_,ud[ua+uE]=uO*uN+uq*uz+uA*uC+uc*uL},uv.createAffineTransformationArray=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR,um){var uQ=ud+ud,uT=ub+ub,u$=uE+uE,ue=ud*uQ,uK=ud*uT,uo=ud*u$,uS=ub*uT,uM=ub*u$,uZ=uE*u$,uX=uO*uQ,u_=uO*uT,uN=uO*u$;uR[um+0]=(1-(uS+uZ))*uq,uR[um+1]=(uK+uN)*uq,uR[um+2]=(uo-u_)*uq,uR[um+3]=0,uR[um+4]=(uK-uN)*uA,uR[um+5]=(1-(ue+uZ))*uA,uR[um+6]=(uM+uX)*uA,uR[um+7]=0,uR[um+8]=(uo+u_)*uc,uR[um+9]=(uM-uX)*uc,uR[um+10]=(1-(ue+uS))*uc,uR[um+11]=0,uR[um+12]=uW,uR[um+13]=uj,uR[um+14]=ut,uR[um+15]=1},uv.transformVector3ArrayToVector3ArrayCoordinate=function(uW,uj,ut,ud,ub){var uE=uv._tempArray4_0,uO=uW[uj+0],uq=uW[uj+1],uA=uW[uj+2],uc=ut.elements;uE[0]=uO*uc[0]+uq*uc[4]+uA*uc[8]+uc[12],uE[1]=uO*uc[1]+uq*uc[5]+uA*uc[9]+uc[13],uE[2]=uO*uc[2]+uq*uc[6]+uA*uc[10]+uc[14],uE[3]=1/(uO*uc[3]+uq*uc[7]+uA*uc[11]+uc[15]),ud[ub+0]=uE[0]*uE[3],ud[ub+1]=uE[1]*uE[3],ud[ub+2]=uE[2]*uE[3]},uv.transformLightingMapTexcoordByUV0Array=function(uW,uj,ut,ud,ub){var uE=ut.elements;ud[ub+0]=uW[uj+0]*uE[0]+uE[2],ud[ub+1]=(uW[uj+1]-1)*uE[1]+uE[3]},uv.transformLightingMapTexcoordByUV1Array=function(uW,uj,ut,ud,ub){var uE=ut.elements;ud[ub+0]=uW[uj+0]*uE[0]+uE[2],ud[ub+1]=1+uW[uj+1]*uE[1]+uE[3]},uv.getURLVerion=function(uW){var uj=uW.indexOf("?");return 0<=uj?uW.substr(uj):null},uv._quaternionCreateFromYawPitchRollArray=function(uW,uj,ut,ud){var ub=.5*ut,uE=.5*uj,uO=.5*uW,uq=Math.sin(ub),uA=Math.cos(ub),uc=Math.sin(uE),uR=Math.cos(uE),um=Math.sin(uO),uQ=Math.cos(uO);ud[0]=uQ*uc*uA+um*uR*uq,ud[1]=um*uR*uA-uQ*uc*uq,ud[2]=uQ*uR*uq-um*uc*uA,ud[3]=uQ*uR*uA+um*uc*uq},uv._createAffineTransformationArray=function(uW,uj,ut,ud){var ub=uj[0],uE=uj[1],uO=uj[2],uq=uj[3],uA=ub+ub,uc=uE+uE,uR=uO+uO,um=ub*uA,uQ=ub*uc,uT=ub*uR,u$=uE*uc,ue=uE*uR,uK=uO*uR,uo=uq*uA,uS=uq*uc,uM=uq*uR,uZ=ut[0],uX=ut[1],u_=ut[2];ud[0]=(1-(u$+uK))*uZ,ud[1]=(uQ+uM)*uZ,ud[2]=(uT-uS)*uZ,ud[3]=0,ud[4]=(uQ-uM)*uX,ud[5]=(1-(um+uK))*uX,ud[6]=(ue+uo)*uX,ud[7]=0,ud[8]=(uT+uS)*u_,ud[9]=(ue-uo)*u_,ud[10]=(1-(um+u$))*u_,ud[11]=0,ud[12]=uW[0],ud[13]=uW[1],ud[14]=uW[2],ud[15]=1},uv._mulMatrixArray=function(uW,uj,ut,ud){var ub,uE,uO,uq,uA,uc=uj.elements,uR=uc[0],um=uc[1],uQ=uc[2],uT=uc[3],u$=uc[4],ue=uc[5],uK=uc[6],uo=uc[7],uS=uc[8],uM=uc[9],uZ=uc[10],uX=uc[11],u_=uc[12],uN=uc[13],uz=uc[14],uC=uc[15],uL=ud,uV=ud+4,ux=ud+8,uG=ud+12;for(ub=0;ub<4;ub++)uE=uW[ub],uO=uW[ub+4],uq=uW[ub+8],uA=uW[ub+12],ut[uL+ub]=uE*uR+uO*um+uq*uQ+uA*uT,ut[uV+ub]=uE*u$+uO*ue+uq*uK+uA*uo,ut[ux+ub]=uE*uS+uO*uM+uq*uZ+uA*uX,ut[uG+ub]=uE*u_+uO*uN+uq*uz+uA*uC},uv.getYawPitchRoll=function(uW,uj){uv.transformQuat(uOj.ForwardRH,uW,utj.TEMPVector31),uv.transformQuat(uOj.Up,uW,utj.TEMPVector32);var ut=utj.TEMPVector32.elements;uv.angleTo(uOj.ZERO,utj.TEMPVector31,utj.TEMPVector33);var ud=utj.TEMPVector33.elements;ud[0]==Math.PI/2?(ud[1]=uv.arcTanAngle(ut[2],ut[0]),ud[2]=0):ud[0]==-Math.PI/2?(ud[1]=uv.arcTanAngle(-ut[2],-ut[0]),ud[2]=0):(uWj.createRotationY(-ud[1],utj.TEMPMatrix0),uWj.createRotationX(-ud[0],utj.TEMPMatrix1),uOj.transformCoordinate(utj.TEMPVector32,utj.TEMPMatrix0,utj.TEMPVector32),uOj.transformCoordinate(utj.TEMPVector32,utj.TEMPMatrix1,utj.TEMPVector32),ud[2]=uv.arcTanAngle(ut[1],-ut[0])),ud[1]<=-Math.PI&&(ud[1]=Math.PI),ud[2]<=-Math.PI&&(ud[2]=Math.PI),ud[1]>=Math.PI&&ud[2]>=Math.PI&&(ud[1]=0,ud[2]=0,ud[0]=Math.PI-ud[0]),uj[0]=ud[1],uj[1]=ud[0],uj[2]=ud[2]},uv.arcTanAngle=function(uW,uj){return 0==uW?1==uj?Math.PI/2:-Math.PI/2:0<uW?Math.atan(uj/uW):uW<0?0<uj?Math.atan(uj/uW)+Math.PI:Math.atan(uj/uW)-Math.PI:0},uv.angleTo=function(uW,uj,ut){uOj.subtract(uj,uW,utj.TEMPVector30),uOj.normalize(utj.TEMPVector30,utj.TEMPVector30),ut.elements[0]=Math.asin(utj.TEMPVector30.y),ut.elements[1]=uv.arcTanAngle(-utj.TEMPVector30.z,-utj.TEMPVector30.x)},uv.transformQuat=function(uW,uj,ut){var ud=ut.elements,ub=uW.elements,uE=uj,uO=ub[0],uq=ub[1],uA=ub[2],uc=uE[0],uR=uE[1],um=uE[2],uQ=uE[3],uT=uQ*uO+uR*uA-um*uq,u$=uQ*uq+um*uO-uc*uA,ue=uQ*uA+uc*uq-uR*uO,uK=-uc*uO-uR*uq-um*uA;ud[0]=uT*uQ+uK*-uc+u$*-um-ue*-uR,ud[1]=u$*uQ+uK*-uR+ue*-uc-uT*-um,ud[2]=ue*uQ+uK*-um+uT*-uR-u$*-uc},uv.quaterionNormalize=function(uW,uj){var ut=uW[0],ud=uW[1],ub=uW[2],uE=uW[3],uO=ut*ut+ud*ud+ub*ub+uE*uE;0<uO&&(uO=1/Math.sqrt(uO),uj[0]=ut*uO,uj[1]=ud*uO,uj[2]=ub*uO,uj[3]=uE*uO)},uv.matrix4x4MultiplyFFF=function(uW,uj,ut){var ud,ub,uE,uO,uq;if(ut===uj)for(uj=new Float32Array(16),ud=0;ud<16;++ud)uj[ud]=ut[ud];for(ud=0;ud<4;ud++)ub=uW[ud],uE=uW[ud+4],uO=uW[ud+8],uq=uW[ud+12],ut[ud]=ub*uj[0]+uE*uj[1]+uO*uj[2]+uq*uj[3],ut[ud+4]=ub*uj[4]+uE*uj[5]+uO*uj[6]+uq*uj[7],ut[ud+8]=ub*uj[8]+uE*uj[9]+uO*uj[10]+uq*uj[11],ut[ud+12]=ub*uj[12]+uE*uj[13]+uO*uj[14]+uq*uj[15]},uv.matrix4x4MultiplyMFM=function(uW,uj,ut){uv.matrix4x4MultiplyFFF(uW.elements,uj,ut.elements)},um(uv,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new uOj},"_tempVector3_1",function(){return this._tempVector3_1=new uOj},"_tempVector3_2",function(){return this._tempVector3_2=new uOj},"_tempVector3_3",function(){return this._tempVector3_3=new uOj},"_tempVector3_4",function(){return this._tempVector3_4=new uOj},"_tempVector3_5",function(){return this._tempVector3_5=new uOj},"_tempVector3_6",function(){return this._tempVector3_6=new uOj},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),uv}(),uoj=function(){function ul(){}return uT(ul,"Laya3D"),ul._cancelLoadByUrl=function(uW){uX.loader.cancelLoadByUrl(uW),ul._innerFirstLevelLoaderManager.cancelLoadByUrl(uW),ul._innerSecondLevelLoaderManager.cancelLoadByUrl(uW),ul._innerThirdLevelLoaderManager.cancelLoadByUrl(uW),ul._innerFourthLevelLoaderManager.cancelLoadByUrl(uW)},ul._changeWebGLSize=function(uW,uj){uG.onStageResize(uW,uj),ui.clientWidth=uW,ui.clientHeight=uj},ul.__init__=function(){var uW=uj.createMap;uW.lh=[uaj,"SPRITE3DHIERARCHY"],uW.ls=[uyj,"SPRITE3DHIERARCHY"],uW.lm=[ugj,"MESH"],uW.lmat=[uDj,"MATERIAL"],uW.jpg=[uwj,"nativeimage"],uW.jpeg=[uwj,"nativeimage"],uW.png=[uwj,"nativeimage"],uW.pkm=[uwj,"arraybuffer"],uW.raw=[uHj,"arraybuffer"],uW.mipmaps=[uHj,"arraybuffer"],uo.parserMap.SPRITE3DHIERARCHY=ul._loadHierarchy,uo.parserMap.MESH=ul._loadMesh,uo.parserMap.MATERIAL=ul._loadMaterial,uo.parserMap.TEXTURECUBE=ul._loadTextureCube,uo.parserMap.TERRAIN=ul._loadTerrain,ul._innerFirstLevelLoaderManager.on("error",null,ul._eventLoadManagerError),ul._innerSecondLevelLoaderManager.on("error",null,ul._eventLoadManagerError),ul._innerThirdLevelLoaderManager.on("error",null,ul._eventLoadManagerError),ul._innerFourthLevelLoaderManager.on("error",null,ul._eventLoadManagerError)},ul.READ_BLOCK=function(){return ul._readData.pos+=4,!0},ul.READ_DATA=function(){return ul._DATA.offset=ul._readData.getUint32(),ul._DATA.size=ul._readData.getUint32(),!0},ul.READ_STRINGS=function(){var uW=[],uj={offset:0,size:0};uj.offset=ul._readData.getUint16(),uj.size=ul._readData.getUint16();ul._readData.pos;ul._readData.pos=uj.offset+ul._DATA.offset;for(var ut=0;ut<uj.size;ut++){var ud=ul._readData.readUTFString();-1===ud.lastIndexOf(".lmat")&&-1===ud.lastIndexOf(".lpbr")||uW.push(ud)}return uW},ul.formatRelativePath=function(uW,uj){var ut;if("."===uj.charAt(0)){for(var ud=(uW+uj).split("/"),ub=0,uE=ud.length;ub<uE;ub++)if(".."==ud[ub]){var uO=ub-1;0<uO&&".."!==ud[uO]&&(ud.splice(uO,2),ub-=2)}ut=ud.join("/")}else ut=uW+uj;return null!=ux.customFormat&&(ut=ux.customFormat(ut,null)),ut},ul._eventLoadManagerError=function(uW){uX.loader.event("error",uW)},ul._addHierarchyInnerUrls=function(uW,uj,ut,ud,ub,uE){var uO=ul.formatRelativePath(ud,ub);ut&&(uO+=ut),uW.push({url:uO,clas:uE}),uj[ub]=uO},ul._getSprite3DHierarchyInnerUrls=function(uW,uj,ut,ud,ub,uE,uO){var uq,uA=0,uc=0;switch(uW.type){case"Scene":var uR=uW.customProps.lightmaps;for(uA=0,uc=uR.length;uA<uc;uA++){var um=uR[uA].replace(".exr",".png");ul._addHierarchyInnerUrls(ud,ub,uE,uO,um,uwj)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var uQ;if(uW.instanceParams)(uQ=uW.instanceParams.loadPath)&&ul._addHierarchyInnerUrls(uj,ub,uE,uO,uQ,ugj);else{(uQ=(uq=uW.customProps).meshPath)&&ul._addHierarchyInnerUrls(uj,ub,uE,uO,uQ,ugj);var uT=uq.materials;if(uT)for(uA=0,uc=uT.length;uA<uc;uA++){for(var u$=uT[uA],ue=u$.type.split("."),uK=uh.window,uo=0,uS=ue.length;uo<uS;++uo){uK=uK[this.clasPaths[uo]]}if("function"!=typeof uK)throw"_getSprite3DHierarchyInnerUrls 错误: "+u$.type+" 不是类";ul._addHierarchyInnerUrls(ut,ub,uE,uO,u$.path,uK)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var uM=(uq=uW.customProps).meshPath;uM&&ul._addHierarchyInnerUrls(uj,ub,uE,uO,uM,ugj);var uZ=uq.material;if(uZ){ue=uZ.type.split("."),uK=uh.window;for(uo=0,uS=ue.length;uo<uS;++uo){uK=uK[this.clasPaths[uo]]}ul._addHierarchyInnerUrls(ut,ub,uE,uO,uZ.path,uK)}else{var uX=uq.materialPath;if(uX)ul._addHierarchyInnerUrls(ut,ub,uE,uO,uX,ShurikenParticleMaterial);else{var u_=uq.texturePath;u_&&ul._addHierarchyInnerUrls(ud,ub,uE,uO,u_,uwj)}}break;case"Terrain":ul._addHierarchyInnerUrls(ud,ub,uE,uO,uW.customProps.dataPath,TerrainRes)}var uN=uW.components;for(var uz in uN){var uC=uN[uz];switch(uz){case"Animator":var uL=uC.avatarPath;if(uL)ul._addHierarchyInnerUrls(ud,ub,uE,uO,uL,Avatar);else{var uV=uC.avatar;uV&&ul._addHierarchyInnerUrls(ud,ub,uE,uO,uV.path,Avatar)}var ux=uC.clipPaths;for(uA=0,uc=ux.length;uA<uc;uA++)ul._addHierarchyInnerUrls(ud,ub,uE,uO,ux[uA],AnimationClip)}}var uG=uW.child;for(uA=0,uc=uG.length;uA<uc;uA++)ul._getSprite3DHierarchyInnerUrls(uG[uA],uj,ut,ud,ub,uE,uO)},ul._loadHierarchy=function(uW){uW.on("loaded",null,ul._onHierarchylhLoaded,[uW,uW._class._getGroup()]),uW.load(uW.url,"json",!1,null,!0)},ul._onHierarchylhLoaded=function(uW,uj,ut){if(uW._class.destroyed)uW.endLoad();else{var ud=uW.url,ub=uKj.getURLVerion(ud),uE=ux.getPath(ud),uO=[],uq=[],uA=[],uc={};ul._getSprite3DHierarchyInnerUrls(ut,uO,uq,uA,uc,ub,uE);var uR=uO.length+uq.length+uA.length,um=uR+1,uQ=1/um;if(ul._onProcessChange(uW,0,uQ,1),0<uA.length){var uT=uR/um,u$=uV.create(null,ul._onProcessChange,[uW,uQ,uT],!1);ul._innerFourthLevelLoaderManager.create(uA,uV.create(null,ul._onHierarchyInnerForthLevResouLoaded,[uW,uj,u$,ut,uc,uO,uq,uQ+uT*uA.length,uT]),u$,null,null,1,!0,uj)}else ul._onHierarchyInnerForthLevResouLoaded(uW,uj,null,ut,uc,uO,uq,uQ,uT)}},ul._onHierarchyInnerForthLevResouLoaded=function(uW,uj,ut,ud,ub,uE,uO,uq,uA){if(uW._class.destroyed)uW.endLoad();else if(ut&&ut.recover(),0<uO.length){var uc=uV.create(null,ul._onProcessChange,[uW,uq,uA],!1);ul._innerSecondLevelLoaderManager.create(uO,uV.create(null,ul._onHierarchyInnerSecondLevResouLoaded,[uW,uj,uc,ud,ub,uE,uq+uA*uO.length,uA]),ut,null,null,1,!0,uj)}else ul._onHierarchyInnerSecondLevResouLoaded(uW,uj,null,ud,ub,uE,uq,uA)},ul._onHierarchyInnerSecondLevResouLoaded=function(uW,uj,ut,ud,ub,uE,uO,uq){if(uW._class.destroyed)uW.endLoad();else if(ut&&ut.recover(),0<uE.length){var uA=uV.create(null,ul._onProcessChange,[uW,uO,uq],!1);ul._innerFirstLevelLoaderManager.create(uE,uV.create(null,ul._onHierarchyInnerFirstLevResouLoaded,[uW,uA,ud,ub]),ut,null,null,1,!0,uj)}else ul._onHierarchyInnerFirstLevResouLoaded(uW,null,ud,ub)},ul._onHierarchyInnerFirstLevResouLoaded=function(uW,uj,ut,ud){uj&&uj.recover(),uW.endLoad([ut,ud])},ul._loadTerrain=function(uW){uW.on("loaded",null,ul._onTerrainLtLoaded,[uW,uW._class._getGroup()]),uW.load(uW.url,"json",!1,null,!0)},ul._onTerrainLtLoaded=function(uW,uj,ut){if(uW._class.destroyed)uW.endLoad();else{var ud,ub,uE=uW.url,uO=uKj.getURLVerion(uE),uq=ux.getPath(uE),uA=[],uc={},uR=0,um=0,uQ=ut.heightData;ud=uQ.url,ub=ul.formatRelativePath(uq,ud),uO&&(ub+=uO),ud=uc[ud]=ub;var uT=ut.detailTexture;for(uR=0,um=uT.length;uR<um;uR++)uA.push({url:uT[uR].diffuse});var u$=ut.normalMap;for(uR=0,um=u$.length;uR<um;uR++)uA.push({url:u$[uR]});var ue=ut.alphaMap;for(uR=0,um=ue.length;uR<um;uR++)uA.push({url:ue[uR],params:[!1,!1,6408,!0]});for(uR=0,um=uA.length;uR<um;uR++){var uK=uA[uR].url;ub=ul.formatRelativePath(uq,uK),uO&&(ub+=uO),uA[uR].url=ub,uc[uK]=ub}var uo=uA.length,uS=uo+2,uM=1/uS;ul._onProcessChange(uW,0,uM,1);var uZ={heightMapLoaded:!1,texturesLoaded:!1},uX=uV.create(null,ul._onProcessChange,[uW,uM,uM],!1);ul._innerFourthLevelLoaderManager.create(ud,uV.create(null,ul._onTerrainHeightMapLoaded,[uW,uX,ut,uc,uZ]),uX,null,[uQ.numX,uQ.numZ,uQ.bitType,uQ.value],1,!0,uj);var u_=uV.create(null,ul._onProcessChange,[uW,2*uM,uo/uS],!1);ul._innerFourthLevelLoaderManager.create(uA,uV.create(null,ul._onTerrainTexturesLoaded,[uW,u_,ut,uc,uZ]),u_,null,null,1,!0,uj)}},ul._onTerrainHeightMapLoaded=function(uW,uj,ut,ud,ub){ub.heightMapLoaded=!0,ub.texturesLoaded&&(uW.endLoad([ut,ud]),uj.recover())},ul._onTerrainTexturesLoaded=function(uW,uj,ut,ud,ub){ub.texturesLoaded=!0,ub.heightMapLoaded&&(uW.endLoad([ut,ud]),uj.recover())},ul._loadMesh=function(uW){uW.on("loaded",null,ul._onMeshLmLoaded,[uW,uW._class._getGroup()]),uW.load(uW.url,"arraybuffer",!1,null,!0)},ul._onMeshLmLoaded=function(uW,uj,ut){if(uW._class.destroyed)uW.endLoad();else{var ud,ub,uE,uO=uW.url,uq=uKj.getURLVerion(uO),uA=ux.getPath(uO),uc={},uR=0,um=0;switch((ul._readData=new u_(ut)).pos=0,ul._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var uQ=ul._readData.getUint32();ul._readData.pos=ul._readData.pos+4,um=ul._readData.getUint16(),ul._readData.pos=ul._readData.pos+8*um;var uT=ul._readData.getUint32();for(um=ul._readData.getUint16(),ul._readData.pos=uQ+uT,ud=[],uR=0;uR<um;uR++){var u$=ul._readData.readUTFString();-1!==u$.lastIndexOf(".lmat")&&ud.push(u$)}break;default:for(ul.READ_BLOCK(),uR=0;uR<2;uR++){var ue=ul._readData.getUint16(),uK=ul._strings[ue],uo=ul["READ_"+uK];if(null==uo)throw new Error("model file err,no this function:"+ue+" "+uK);1===uR?ud=uo.call():uo.call()}}for(uR=0,uE=ud.length;uR<uE;uR++){var uS=ud[uR];ub=ul.formatRelativePath(uA,uS),uq&&(ub+=uq),ud[uR]=ub,uc[uS]=ub}if(0<ud.length){ul._onProcessChange(uW,0,.5,1);var uM=uV.create(null,ul._onProcessChange,[uW,.5,.5],!1);ul._innerSecondLevelLoaderManager.create(ud,uV.create(null,ul._onMeshMateialLoaded,[uW,uM,ut,uc]),uM,null,null,1,!0,uj)}else uW.endLoad([ut,uc])}},ul._onMeshMateialLoaded=function(uW,uj,ut,ud){uW.endLoad([ut,ud]),uj.recover()},ul._getMaterialTexturePath=function(uW,uj,ut){var ud=uW.length-4;return uW.indexOf(".dds")!=ud&&uW.indexOf(".tga")!=ud&&uW.indexOf(".exr")!=ud&&uW.indexOf(".DDS")!=ud&&uW.indexOf(".TGA")!=ud&&uW.indexOf(".EXR")!=ud||(uW=uW.substr(0,ud)+".png"),uW=ul.formatRelativePath(ut,uW),uj&&(uW+=uj),uW},ul._loadMaterial=function(uW){uW.on("loaded",null,ul._onMaterilLmatLoaded,[uW,uW._class._getGroup()]),uW.load(uW.url,"json",!1,null,!0)},ul._onMaterilLmatLoaded=function(uW,uj,ut){if(uW._class.destroyed)uW.endLoad();else{var ud,ub=uW.url,uE=uKj.getURLVerion(ub),uO=ux.getPath(ub),uq=[],uA={},uc=ut.customProps,uR=ut.version;if(uR)switch(uR){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var um=ut.props.textures,uQ=0,uT=um.length;uQ<uT;uQ++){var u$=um[uQ],ue=u$.path;if(ue){var uK=ue.length-4;ue.indexOf(".exr")!=uK&&ue.indexOf(".EXR")!=uK||(ue=ue.substr(0,uK)+".png"),ud=ul.formatRelativePath(uO,ue),uE&&(ud+=uE),uq.push({url:ud,params:u$.params}),uA[ue]=ud}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var uo=uc.diffuseTexture.texture2D;if(uo&&(ud=ul._getMaterialTexturePath(uo,uE,uO),uq.push(ud),uA[uo]=ud),uc.normalTexture){var uS=uc.normalTexture.texture2D;uS&&(ud=ul._getMaterialTexturePath(uS,uE,uO),uq.push(ud),uA[uS]=ud)}if(uc.specularTexture){var uM=uc.specularTexture.texture2D;uM&&(ud=ul._getMaterialTexturePath(uM,uE,uO),uq.push(ud),uA[uM]=ud)}if(uc.emissiveTexture){var uZ=uc.emissiveTexture.texture2D;uZ&&(ud=ul._getMaterialTexturePath(uZ,uE,uO),uq.push(ud),uA[uZ]=ud)}if(uc.ambientTexture){var uX=uc.ambientTexture.texture2D;uX&&(ud=ul._getMaterialTexturePath(uX,uE,uO),uq.push(ud),uA[uX]=ud)}if(uc.reflectTexture){var u_=uc.reflectTexture.texture2D;u_&&(ud=ul._getMaterialTexturePath(u_,uE,uO),uq.push(ud),uA[u_]=ud)}}var uN=uq.length,uz=uN+1,uC=1/uz;if(ul._onProcessChange(uW,0,uC,1),0<uN){var uL=uV.create(null,ul._onProcessChange,[uW,uC,uN/uz],!1);ul._innerFourthLevelLoaderManager.create(uq,uV.create(null,ul._onMateialTexturesLoaded,[uW,uL,ut,uA]),uL,uwj,null,1,!0,uj)}else ul._onMateialTexturesLoaded(uW,null,ut,null)}},ul._onMateialTexturesLoaded=function(uW,uj,ut,ud){uW.endLoad([ut,ud]),uj&&uj.recover()},ul._loadTextureCube=function(uW){uW.on("loaded",null,ul._onTextureCubeLtcLoaded,[uW]),uW.load(uW.url,"json",!1,null,!0)},ul._onTextureCubeLtcLoaded=function(uW,uj){if(uW._class.destroyed)uW.endLoad();else{var ut=ux.getPath(uW.url),ud=[ul.formatRelativePath(ut,uj.px),ul.formatRelativePath(ut,uj.nx),ul.formatRelativePath(ut,uj.py),ul.formatRelativePath(ut,uj.ny),ul.formatRelativePath(ut,uj.pz),ul.formatRelativePath(ut,uj.nz)];ul._onProcessChange(uW,0,1/7,1);var ub=uV.create(null,ul._onProcessChange,[uW,1/7,6/7],!1);ul._innerFourthLevelLoaderManager.load(ud,uV.create(null,ul._onTextureCubeImagesLoaded,[uW,ud,ub]),ub,"nativeimage")}},ul._onTextureCubeImagesLoaded=function(uW,uj,ut){var ud=[];ud.length=6;for(var ub=0;ub<6;ub++){var uE=uj[ub];ud[ub]=uo.getRes(uE),uo.clearRes(uE)}uW.endLoad(ud),ut.recover()},ul._onProcessChange=function(uW,uj,ut,ud){(ud=uj+ud*ut)<1&&uW.event("progress",ud)},ul.init=function(uW,uj,ut,ud,ub,uE){if(void 0===ut&&(ut=!1),void 0===ud&&(ud=!1),void 0===ub&&(ub=!0),void 0===uE&&(uE=!0),uS.update3DLoop=function(){},uS.cancelLoadByUrl=function(uW){ul._cancelLoadByUrl(uW)},uA.isAntialias=ut,uA.isAlpha=ud,uA.premultipliedAlpha=ub,uA.isStencil=uE,!uG.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");uS.changeWebGLSize=ul._changeWebGLSize,ue.is3DMode=!0,uX.init(uW,uj),uv.__init__(),umj.__init__(),uPj.__init__(),uI.__init__(),ul.__init__(),uO.maxTextureCount=2,(ul.debugMode||uB.debugMode)&&(ul._debugPhasorSprite=new uJ)},ul.HIERARCHY="SPRITE3DHIERARCHY",ul.MESH="MESH",ul.MATERIAL="MATERIAL",ul.PBRMATERIAL="PBRMTL",ul.TEXTURECUBE="TEXTURECUBE",ul.TERRAIN="TERRAIN",ul._readData=null,ul._debugPhasorSprite=null,ul.debugMode=!1,um(ul,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new uj},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new uj},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new uj},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new uj}]),ul}(),uSj=function(uW){function ub(uW){ub.__super.call(this),this._owner=uW,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}uT(ub,"laya.d3.animation.AnimationTransform3D",uE);var uj=ub.prototype;return uj._getlocalMatrix=function(){return this._localUpdate&&(uKj._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},uj._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var uW=0,uj=this._childs.length;uW<uj;uW++)this._childs[uW]._onWorldTransform()}},uj._setWorldMatrixAndUpdate=function(uW){if(this._worldMatrix=uW,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var uj=this._getlocalMatrix(),ut=0;ut<16;++ut)this._worldMatrix[ut]=uj[ut];else uKj.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},uj._setWorldMatrixNoUpdate=function(uW){this._worldMatrix=uW},uj._setWorldMatrixIgnoreUpdate=function(uW){this._worldMatrix=uW,this._worldUpdate=!1},uj.getLocalPosition=function(){return this._localPosition},uj.setLocalPosition=function(uW){if(this._parent)this._localPosition=uW,this._localUpdate=!0,this._onWorldTransform();else{var uj=this._entity.owner._transform,ut=this._entity.localPosition,ud=ut.elements;ud[0]=uW[0],ud[1]=uW[1],ud[2]=uW[2],uj.localPosition=ut}},uj.getLocalRotation=function(){if(this._localQuaternionUpdate){var uW=this._localRotationEuler;uKj._quaternionCreateFromYawPitchRollArray(uW[1]/ub._angleToRandin,uW[0]/ub._angleToRandin,uW[2]/ub._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},uj.setLocalRotation=function(uW){if(this._parent)this._localRotation=uW,uKj.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var uj=this._entity.owner._transform,ut=this._entity.localRotation,ud=ut.elements;ud[0]=uW[0],ud[1]=uW[1],ud[2]=uW[2],ud[3]=uW[3],uj.localRotation=ut}},uj.getLocalScale=function(){return this._localScale},uj.setLocalScale=function(uW){if(this._parent)this._localScale=uW,this._localUpdate=!0,this._onWorldTransform();else{var uj=this._entity.owner._transform,ut=this._entity.localScale,ud=ut.elements;ud[0]=uW[0],ud[1]=uW[1],ud[2]=uW[2],uj.localScale=ut}},uj.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){uKj.getYawPitchRoll(this._localRotation,ub._tempVector3);var uW=ub._tempVector3,uj=this._localRotationEuler;uj[0]=uW[1]*ub._angleToRandin,uj[1]=uW[0]*ub._angleToRandin,uj[2]=uW[2]*ub._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},uj.setLocalRotationEuler=function(uW){if(this._parent)uKj._quaternionCreateFromYawPitchRollArray(uW[1]/ub._angleToRandin,uW[0]/ub._angleToRandin,uW[2]/ub._angleToRandin,this._localRotation),this._localRotationEuler=uW,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var uj=this._entity.owner._transform,ut=this._entity.localRotationEuler,ud=ut.elements;ud[0]=uW[0],ud[1]=uW[1],ud[2]=uW[2],uj.localRotationEuler=ut}},uj.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)uKj.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var uW=this._getlocalMatrix(),uj=0;uj<16;++uj)this._worldMatrix[uj]=uW[uj];this._worldUpdate=!1}return this._worldMatrix},uj.setParent=function(uW){if(this._parent!==uW){if(this._parent){var uj=this._parent._childs,ut=uj.indexOf(this);uj.splice(ut,1)}uW&&(uW._childs.push(this),uW&&this._onWorldTransform()),this._parent=uW}},um(ub,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),ub}(),uMj=function(uW){function uj(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,uj.__super.call(this),this._destroyed=!1,this._id=uj._uniqueIDCounter,uj._uniqueIDCounter++}uT(uj,"laya.d3.component.Component3D",uE);var ut=uj.prototype;return uX.imps(ut,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),ut._initialize=function(uW){this._owner=uW,this._enable=!0,this.started=!1,this._load(uW)},ut._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},ut._load=function(uW){},ut._start=function(uW){},ut._update=function(uW){},ut._lateUpdate=function(uW){},ut._preRenderUpdate=function(uW){},ut._postRenderUpdate=function(uW){},ut._unload=function(uW){this.offAll()},ut._cloneTo=function(uW){},u$(0,ut,"id",function(){return this._id}),u$(0,ut,"destroyed",function(){return this._destroyed}),u$(0,ut,"owner",function(){return this._owner}),u$(0,ut,"enable",function(){return this._enable},function(uW){this._enable!==uW&&(this._enable=uW,this.event("enablechanged",this._enable))}),u$(0,ut,"isSingleton",function(){return uj._isSingleton}),uj._isSingleton=!0,uj._uniqueIDCounter=1,uj}(),uZj=function(uW){function uj(){this._destroyed=!1,uj.__super.call(this),this._destroyed=!1}uT(uj,"laya.d3.core.GeometryFilter",uE);var ut=uj.prototype;return uX.imps(ut,{"laya.resource.IDestroy":!0}),ut._destroy=function(){this.offAll(),this._destroyed=!0},u$(0,ut,"_isAsyncLoaded",function(){return!0}),u$(0,ut,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),u$(0,ut,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),u$(0,ut,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),u$(0,ut,"destroyed",function(){return this._destroyed}),uj}(),uXj=function(uW){function ud(uW){ud.__super.call(this),this._id=++ud._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new uBW(new uOj,new uOj),this._boundingBoxCenter=new uOj,this._boundingSphere=new ukW(new uOj,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=uW,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}uT(ud,"laya.d3.core.render.BaseRender",uE);var uj=ud.prototype;return uX.imps(uj,{"laya.resource.IDestroy":!0}),uj._changeMaterialReference=function(uW,uj){uW&&uW._removeReference(),uj._addReference()},uj._getInstanceMaterial=function(uW,uj){var ut=new uW.constructor;return uW.cloneTo(ut),ut.name=ut.name+"(Instance)",this._materialsInstance[uj]=!0,this._changeMaterialReference(this._materials[uj],ut),this._materials[uj]=ut},uj._setShaderValuelightMap=function(uW){this._setShaderValueTexture(3,uW)},uj._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},uj._renderRenderableBoundBox=function(){var uW=uoj._debugPhasorSprite,uj=this.boundingBox,ut=ud._tempBoundBoxCorners;uj.getCorners(ut),uW.line(ut[0],ud._greenColor,ut[1],ud._greenColor),uW.line(ut[2],ud._greenColor,ut[3],ud._greenColor),uW.line(ut[4],ud._greenColor,ut[5],ud._greenColor),uW.line(ut[6],ud._greenColor,ut[7],ud._greenColor),uW.line(ut[0],ud._greenColor,ut[3],ud._greenColor),uW.line(ut[1],ud._greenColor,ut[2],ud._greenColor),uW.line(ut[2],ud._greenColor,ut[6],ud._greenColor),uW.line(ut[3],ud._greenColor,ut[7],ud._greenColor),uW.line(ut[0],ud._greenColor,ut[4],ud._greenColor),uW.line(ut[1],ud._greenColor,ut[5],ud._greenColor),uW.line(ut[4],ud._greenColor,ut[7],ud._greenColor),uW.line(ut[5],ud._greenColor,ut[6],ud._greenColor)},uj._calculateBoundingSphere=function(){throw"BaseRender: must override it."},uj._calculateBoundingBox=function(){throw"BaseRender: must override it."},uj._setShaderValueTexture=function(uW,uj){this._owner._shaderValues.setValue(uW,uj)},uj._setShaderValueMatrix4x4=function(uW,uj){this._owner._shaderValues.setValue(uW,uj?uj.elements:null)},uj._setShaderValueColor=function(uW,uj){this._owner._shaderValues.setValue(uW,uj?uj.elements:null)},uj._setShaderValueBuffer=function(uW,uj){this._owner._shaderValues.setValue(uW,uj)},uj._setShaderValueInt=function(uW,uj){this._owner._shaderValues.setValue(uW,uj)},uj._setShaderValueBool=function(uW,uj){this._owner._shaderValues.setValue(uW,uj)},uj._setShaderValueNumber=function(uW,uj){this._owner._shaderValues.setValue(uW,uj)},uj._setShaderValueVector2=function(uW,uj){this._owner._shaderValues.setValue(uW,uj?uj.elements:null)},uj._addShaderDefine=function(uW){this._owner._shaderDefineValue|=uW},uj._removeShaderDefine=function(uW){this._owner._shaderDefineValue&=~uW},uj._renderUpdate=function(uW){return!0},uj._applyLightMapParams=function(){if(0<=this._lightmapIndex){var uW=this._owner.scene;if(uW){var uj=uW.getlightmaps()[this._lightmapIndex];uj?(this._addShaderDefine(uJj.SAHDERDEFINE_LIGHTMAP),uj.loaded?this._setShaderValuelightMap(uj):uj.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(uJj.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(uJj.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(uJj.SAHDERDEFINE_LIGHTMAP)},uj._updateOctreeNode=function(){var uW=this._treeNode;uW&&this._octreeNodeNeedChange&&(uW.updateObject(this),this._octreeNodeNeedChange=!1)},uj._destroy=function(){this.offAll();var uW=0,uj=0;for(uW=0,uj=this._renderElements.length;uW<uj;uW++)this._renderElements[uW]._destroy();for(uW=0,uj=this._materials.length;uW<uj;uW++)this._materials[uW]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},u$(0,uj,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),u$(0,uj,"id",function(){return this._id}),u$(0,uj,"material",function(){var uW=this._materials[0];if(uW&&!this._materialsInstance[0]){var uj=this._getInstanceMaterial(uW,0);this.event("materialchanged",[this,0,uj])}return this._materials[0]},function(uW){this.sharedMaterial=uW}),u$(0,uj,"sharedMaterial",function(){return this._materials[0]},function(uW){var uj=this._materials[0];uj!==uW&&(this._materials[0]=uW,this._materialsInstance[0]=!1,this._changeMaterialReference(uj,uW),this.event("materialchanged",[this,0,uW]))}),u$(0,uj,"lightmapIndex",function(){return this._lightmapIndex},function(uW){this._lightmapIndex=uW,this._applyLightMapParams()}),u$(0,uj,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(uW){this._lightmapScaleOffset=uW,this._setShaderValueColor(2,uW),this._addShaderDefine(uJj.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),u$(0,uj,"enable",function(){return this._enable},function(uW){this._enable=uW,this.event("enablechanged",[this,uW])}),u$(0,uj,"materials",function(){for(var uW=0,uj=this._materials.length;uW<uj;uW++)if(!this._materialsInstance[uW]){var ut=this._getInstanceMaterial(this._materials[uW],uW);this.event("materialchanged",[this,uW,ut])}return this._materials.slice()},function(uW){this.sharedMaterials=uW}),u$(0,uj,"sharedMaterials",function(){return this._materials.slice()},function(uW){if(!uW)throw new Error("MeshRender: shadredMaterials value can't be null.");var uj=uW.length;this._materialsInstance.length=uj;for(var ut=0;ut<uj;ut++){var ud=this._materials[ut];ud!==uW[ut]&&(this._materialsInstance[ut]=!1,this._changeMaterialReference(ud,uW[ut]),this.event("materialchanged",[this,ut,uW[ut]]))}this._materials=uW}),u$(0,uj,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),u$(0,uj,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var uW=this.boundingBox;uOj.add(uW.min,uW.max,this._boundingBoxCenter),uOj.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),u$(0,uj,"receiveShadow",function(){return this._receiveShadow},function(uW){this._receiveShadow!==uW&&((this._receiveShadow=uW)?this._addShaderDefine(uTj.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(uTj.SHADERDEFINE_RECEIVE_SHADOW))}),u$(0,uj,"destroyed",function(){return this._destroyed}),ud._uniqueIDCounter=0,um(ud,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new uOj,new uOj,new uOj,new uOj,new uOj,new uOj,new uOj,new uOj]},"_greenColor",function(){return this._greenColor=new uqj(0,1,0,1)}]),ud}(),u_j=function(uW){function uq(uW){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,uq.__super.call(this),this._localPosition=new uOj,this._localRotation=new utj(0,0,0,1),this._localScale=new uOj(1,1,1),this._localRotationEuler=new uOj,this._localMatrix=new uWj,this._position=new uOj,this._rotation=new utj(0,0,0,1),this._scale=new uOj(1,1,1),this._worldMatrix=new uWj,this._forward=new uOj,this._up=new uOj,this._right=new uOj,this._owner=uW,this._childs=[]}uT(uq,"laya.d3.core.Transform3D",uE);var uj=uq.prototype;return uj._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)uWj.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var uW=uq._tempVector30;uOj.multiply(this.pivot,this._localScale,uW);var uj=uq._tempVector31;uOj.subtract(uW,this.pivot,uj);var ut=uq._tempVector32,ud=this.localRotation;uOj.transformQuat(uW,ud,ut),uOj.subtract(ut,uW,ut);var ub=uq._tempVector33;uOj.subtract(this._localPosition,uj,ub),uOj.subtract(ub,ut,ub),uWj.createAffineTransformation(ub,ud,this._localScale,this._localMatrix)}},uj._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var uW=0,uj=this._childs.length;uW<uj;uW++)this._childs[uW]._onWorldPositionRotationTransform()}},uj._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var uW=0,uj=this._childs.length;uW<uj;uW++)this._childs[uW]._onWorldPositionScaleTransform()}},uj._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var uW=0,uj=this._childs.length;uW<uj;uW++)this._childs[uW]._onWorldPositionTransform()}},uj._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var uW=0,uj=this._childs.length;uW<uj;uW++)this._childs[uW]._onWorldPositionRotationTransform()}},uj._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var uW=0,uj=this._childs.length;uW<uj;uW++)this._childs[uW]._onWorldPositionScaleTransform()}},uj._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var uW=0,uj=this._childs.length;uW<uj;uW++)this._childs[uW]._onWorldTransform()}},uj.translate=function(uW,uj){void 0===uj&&(uj=!0),uj?(uWj.createFromQuaternion(this.localRotation,uq._tempMatrix0),uOj.transformCoordinate(uW,uq._tempMatrix0,uq._tempVector30),uOj.add(this.localPosition,uq._tempVector30,this._localPosition),this.localPosition=this._localPosition):(uOj.add(this.position,uW,this._position),this.position=this._position)},uj.rotate=function(uW,uj,ut){var ud;void 0===uj&&(uj=!0),void 0===ut&&(ut=!0),ud=ut?uW:(uOj.scale(uW,Math.PI/180,uq._tempVector30),uq._tempVector30),utj.createFromYawPitchRoll(ud.y,ud.x,ud.z,uq._tempQuaternion0),uj?(utj.multiply(this._localRotation,uq._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(utj.multiply(uq._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},uj.lookAt=function(uW,uj,ut){void 0===ut&&(ut=!1);var ud,ub=uW.elements;if(ut){if(ud=this._localPosition.elements,Math.abs(ud[0]-ub[0])<upW.zeroTolerance&&Math.abs(ud[1]-ub[1])<upW.zeroTolerance&&Math.abs(ud[2]-ub[2])<upW.zeroTolerance)return;utj.lookAt(this._localPosition,uW,uj,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var uE=this.position;if(ud=uE.elements,Math.abs(ud[0]-ub[0])<upW.zeroTolerance&&Math.abs(ud[1]-ub[1])<upW.zeroTolerance&&Math.abs(ud[2]-ub[2])<upW.zeroTolerance)return;utj.lookAt(uE,uW,uj,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},u$(0,uj,"_isFrontFaceInvert",function(){var uW=this.scale,uj=uW.x<0;return uW.y<0&&(uj=!uj),uW.z<0&&(uj=!uj),uj}),u$(0,uj,"owner",function(){return this._owner}),u$(0,uj,"localRotation",function(){if(this._localQuaternionUpdate){var uW=this._localRotationEuler.elements;utj.createFromYawPitchRoll(uW[1]/uq._angleToRandin,uW[0]/uq._angleToRandin,uW[2]/uq._angleToRandin,this._localRotation)}return this._localRotation},function(uW){this._localRotation=uW,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),u$(0,uj,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?uWj.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(uW){null===this._parent?uW.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),uWj.multiply(this._localMatrix,uW,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=uW,this._worldUpdate=!1}),u$(0,uj,"worldNeedUpdate",function(){return this._worldUpdate}),u$(0,uj,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(uW){this._localMatrix=uW,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),u$(0,uj,"dummy",function(){return this._dummy},function(uW){this._dummy!==uW&&(this._dummy&&(this._dummy._entity=null),uW&&(uW._entity=this),this._dummy=uW)}),u$(0,uj,"localPosition",function(){return this._localPosition},function(uW){this._localPosition=uW,this._localUpdate=!0,this._onWorldPositionTransform()}),u$(0,uj,"position",function(){if(this._positionUpdate){if(null!=this._parent){var uW=this._parent.position;uOj.multiply(this._localPosition,this._parent.scale,uq._tempVector30),uOj.transformQuat(uq._tempVector30,this._parent.rotation,uq._tempVector30),uOj.add(uW,uq._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(uW){if(null!=this._parent){uOj.subtract(uW,this._parent.position,this._localPosition);var uj=this._parent.scale.elements,ut=uj[0],ud=uj[1],ub=uj[2];if(1!==ut||1!==ud||1!==ub){var uE=uq._tempVector30,uO=uE.elements;uO[0]=1/ut,uO[1]=1/ud,uO[2]=1/ub,uOj.multiply(this._localPosition,uE,this._localPosition)}this._parent.rotation.invert(uq._tempQuaternion0),uOj.transformQuat(this._localPosition,uq._tempQuaternion0,this._localPosition)}else uW.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=uW,this._positionUpdate=!1}),u$(0,uj,"localScale",function(){return this._localScale},function(uW){this._localScale=uW,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),u$(0,uj,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(uq._tempVector30);var uW=uq._tempVector30.elements,uj=this._localRotationEuler.elements;uj[0]=uW[1]*uq._angleToRandin,uj[1]=uW[0]*uq._angleToRandin,uj[2]=uW[2]*uq._angleToRandin}return this._localRotationEuler},function(uW){this._localRotationEuler=uW,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),u$(0,uj,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?utj.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(uW){null!=this._parent?(this._parent.rotation.invert(uq._tempQuaternion0),utj.multiply(uW,uq._tempQuaternion0,this._localRotation)):uW.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=uW,this._rotationUpdate=!1}),u$(0,uj,"scale",function(){return this._scaleUpdate&&(null!==this._parent?uOj.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(uW){if(null!==this._parent){var uj=this._parent.scale.elements,ut=uq._tempVector30.elements;ut[0]=1/uj[0],ut[1]=1/uj[1],ut[2]=1/uj[2],uOj.multiply(uW,uq._tempVector30,this._localScale)}else uW.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=uW,this._scaleUpdate=!1}),u$(0,uj,"rotationEuler",null,function(uW){utj.createFromYawPitchRoll(uW.y,uW.x,uW.z,this._rotation),this.rotation=this._rotation}),u$(0,uj,"forward",function(){var uW=this.worldMatrix.elements;return this._forward.elements[0]=-uW[8],this._forward.elements[1]=-uW[9],this._forward.elements[2]=-uW[10],this._forward}),u$(0,uj,"up",function(){var uW=this.worldMatrix.elements;return this._up.elements[0]=uW[4],this._up.elements[1]=uW[5],this._up.elements[2]=uW[6],this._up}),u$(0,uj,"right",function(){var uW=this.worldMatrix.elements;return this._right.elements[0]=uW[0],this._right.elements[1]=uW[1],this._right.elements[2]=uW[2],this._right}),u$(0,uj,"parent",function(){return this._parent},function(uW){if(this._parent!==uW){if(this._parent){var uj=this._parent._childs,ut=uj.indexOf(this);uj.splice(ut,1)}uW&&(uW._childs.push(this),uW&&this._onWorldTransform()),this._parent=uW}}),um(uq,["_tempVector30",function(){return this._tempVector30=new uOj},"_tempVector31",function(){return this._tempVector31=new uOj},"_tempVector32",function(){return this._tempVector32=new uOj},"_tempVector33",function(){return this._tempVector33=new uOj},"_tempQuaternion0",function(){return this._tempQuaternion0=new utj},"_tempMatrix0",function(){return this._tempMatrix0=new uWj},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),uq}(),uNj=(function(uW){function uj(){this._rotation=0,this._matNeedUpdte=!1,uj.__super.call(this),this._matrix=new uWj,this._offset=new uEj,this._tiling=new uEj(1,1)}uT(uj,"laya.d3.core.TransformUV",uE);var ut=uj.prototype;uX.imps(ut,{"laya.d3.core.IClone":!0}),ut._updateMatrix=function(){uj._tempOffsetV3.elements[0]=this._offset.x,uj._tempOffsetV3.elements[1]=this._offset.y,utj.createFromYawPitchRoll(0,0,this._rotation,uj._tempRotationQua),uj._tempTitlingV3.elements[0]=this._tiling.x,uj._tempTitlingV3.elements[1]=this._tiling.y,uWj.createAffineTransformation(uj._tempOffsetV3,uj._tempRotationQua,uj._tempTitlingV3,this._matrix)},ut.cloneTo=function(uW){uW._matrix=this._matrix.clone(),uW._offset=this._offset.clone(),uW._rotation=this._rotation,uW._tiling=this._tiling.clone()},ut.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,ut,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),u$(0,ut,"tiling",function(){return this._tiling},function(uW){this._tiling=uW,this._matNeedUpdte=!0}),u$(0,ut,"offset",function(){return this._offset},function(uW){this._offset=uW,this._matNeedUpdte=!0}),u$(0,ut,"rotation",function(){return this._rotation},function(uW){this._rotation=uW,this._matNeedUpdte=!0}),um(uj,["_tempOffsetV3",function(){return this._tempOffsetV3=new uOj(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new utj},"_tempTitlingV3",function(){return this._tempTitlingV3=new uOj(1,1,1)}])}(),function(ut){function uW(){this.x=NaN,this.y=NaN,this.z=NaN,uW.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}uT(uW,"laya.d3.core.particleShuriKen.module.shape.BoxShape",ut);var uj=uW.prototype;uj._getShapeBoundBox=function(uW){var uj=uW.min.elements;uj[0]=.5*-this.x,uj[1]=.5*-this.y,uj[2]=.5*-this.z;var ut=uW.max.elements;ut[0]=.5*this.x,ut[1]=.5*this.y,ut[2]=.5*this.z},uj._getSpeedBoundBox=function(uW){var uj=uW.min.elements;uj[0]=0,uj[1]=0,uj[2]=0;var ut=uW.max.elements;ut[0]=0,ut[1]=1,ut[2]=0},uj.generatePositionAndDirection=function(uW,uj,ut,ud){var ub=uW.elements,uE=uj.elements;ut?(ut.seed=ud[16],uw._randomPointInsideHalfUnitBox(uW,ut),ud[16]=ut.seed):uw._randomPointInsideHalfUnitBox(uW),ub[0]=this.x*ub[0],ub[1]=this.y*ub[1],ub[2]=this.z*ub[2],this.randomDirection?ut?(ut.seed=ud[17],uw._randomPointUnitSphere(uj,ut),ud[17]=ut.seed):uw._randomPointUnitSphere(uj):(uE[0]=0,uE[1]=0,uE[2]=1)},uj.cloneTo=function(uW){ut.prototype.cloneTo.call(this,uW);var uj=uW;uj.x=this.x,uj.y=this.y,uj.z=this.z,uj.randomDirection=this.randomDirection}}(uY),function(ut){function uO(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,uO.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}uT(uO,"laya.d3.core.particleShuriKen.module.shape.CircleShape",ut);var uW=uO.prototype;uW._getShapeBoundBox=function(uW){var uj=uW.min.elements;uj[0]=uj[2]=-this.radius,uj[1]=0;var ut=uW.max.elements;ut[0]=ut[2]=this.radius,ut[1]=0},uW._getSpeedBoundBox=function(uW){var uj=uW.min.elements;uj[0]=uj[1]=-1,uj[2]=0;var ut=uW.max.elements;ut[0]=ut[1]=1,ut[2]=0},uW.generatePositionAndDirection=function(uW,uj,ut,ud){var ub=uW.elements,uE=uO._tempPositionPoint.elements;ut?(ut.seed=ud[16],this.emitFromEdge?uw._randomPointUnitArcCircle(this.arc,uO._tempPositionPoint,ut):uw._randomPointInsideUnitArcCircle(this.arc,uO._tempPositionPoint,ut),ud[16]=ut.seed):this.emitFromEdge?uw._randomPointUnitArcCircle(this.arc,uO._tempPositionPoint):uw._randomPointInsideUnitArcCircle(this.arc,uO._tempPositionPoint),ub[0]=-uE[0],ub[1]=uE[1],ub[2]=0,uOj.scale(uW,this.radius,uW),this.randomDirection?ut?(ut.seed=ud[17],uw._randomPointUnitSphere(uj,ut),ud[17]=ut.seed):uw._randomPointUnitSphere(uj):uW.cloneTo(uj)},uW.cloneTo=function(uW){ut.prototype.cloneTo.call(this,uW);var uj=uW;uj.radius=this.radius,uj.arc=this.arc,uj.emitFromEdge=this.emitFromEdge,uj.randomDirection=this.randomDirection},um(uO,["_tempPositionPoint",function(){return this._tempPositionPoint=new uEj}])}(uY),function(ut){function uQ(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,uQ.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}uT(uQ,"laya.d3.core.particleShuriKen.module.shape.ConeShape",ut);var uW=uQ.prototype;uW._getShapeBoundBox=function(uW){var uj=this.radius+this.length*Math.sin(this.angle),ut=this.length*Math.cos(this.angle),ud=uW.min.elements;ud[0]=ud[1]=-uj,ud[2]=0;var ub=uW.max.elements;ub[0]=ub[1]=uj,ub[2]=ut},uW._getSpeedBoundBox=function(uW){var uj=Math.sin(this.angle),ut=uW.min.elements;ut[0]=ut[1]=-uj,ut[2]=0;var ud=uW.max.elements;ud[0]=ut[1]=uj,ud[2]=1},uW.generatePositionAndDirection=function(uW,uj,ut,ud){var ub,uE=uW.elements,uO=uj.elements,uq=uQ._tempPositionPoint.elements,uA=NaN,uc=NaN,uR=Math.cos(this.angle),um=Math.sin(this.angle);switch(this.emitType){case 0:ut?(ut.seed=ud[16],uw._randomPointInsideUnitCircle(uQ._tempPositionPoint,ut),ud[16]=ut.seed):uw._randomPointInsideUnitCircle(uQ._tempPositionPoint),uA=uq[0],uc=uq[1],uE[0]=uA*this.radius,uE[1]=uc*this.radius,uE[2]=0,this.randomDirection?(ut?(ut.seed=ud[17],uw._randomPointInsideUnitCircle(uQ._tempDirectionPoint,ut),ud[17]=ut.seed):uw._randomPointInsideUnitCircle(uQ._tempDirectionPoint),ub=uQ._tempDirectionPoint.elements,uO[0]=ub[0]*um,uO[1]=ub[1]*um):(uO[0]=uA*um,uO[1]=uc*um),uO[2]=uR;break;case 1:ut?(ut.seed=ud[16],uw._randomPointUnitCircle(uQ._tempPositionPoint,ut),ud[16]=ut.seed):uw._randomPointUnitCircle(uQ._tempPositionPoint),uA=uq[0],uc=uq[1],uE[0]=uA*this.radius,uE[1]=uc*this.radius,uE[2]=0,this.randomDirection?(ut?(ut.seed=ud[17],uw._randomPointInsideUnitCircle(uQ._tempDirectionPoint,ut),ud[17]=ut.seed):uw._randomPointInsideUnitCircle(uQ._tempDirectionPoint),ub=uQ._tempDirectionPoint.elements,uO[0]=ub[0]*um,uO[1]=ub[1]*um):(uO[0]=uA*um,uO[1]=uc*um),uO[2]=uR;break;case 2:ut?(ut.seed=ud[16],uw._randomPointInsideUnitCircle(uQ._tempPositionPoint,ut)):uw._randomPointInsideUnitCircle(uQ._tempPositionPoint),uA=uq[0],uc=uq[1],uE[0]=uA*this.radius,uE[1]=uc*this.radius,uO[uE[2]=0]=uA*um,uO[1]=uc*um,uO[2]=uR,uOj.normalize(uj,uj),ut?(uOj.scale(uj,this.length*ut.getFloat(),uj),ud[16]=ut.seed):uOj.scale(uj,this.length*Math.random(),uj),uOj.add(uW,uj,uW),this.randomDirection&&(ut?(ut.seed=ud[17],uw._randomPointUnitSphere(uj,ut),ud[17]=ut.seed):uw._randomPointUnitSphere(uj));break;case 3:ut?(ut.seed=ud[16],uw._randomPointUnitCircle(uQ._tempPositionPoint,ut)):uw._randomPointUnitCircle(uQ._tempPositionPoint),uA=uq[0],uc=uq[1],uE[0]=uA*this.radius,uE[1]=uc*this.radius,uO[uE[2]=0]=uA*um,uO[1]=uc*um,uO[2]=uR,uOj.normalize(uj,uj),ut?(uOj.scale(uj,this.length*ut.getFloat(),uj),ud[16]=ut.seed):uOj.scale(uj,this.length*Math.random(),uj),uOj.add(uW,uj,uW),this.randomDirection&&(ut?(ut.seed=ud[17],uw._randomPointUnitSphere(uj,ut),ud[17]=ut.seed):uw._randomPointUnitSphere(uj));break;default:throw new Error("ConeShape:emitType is invalid.")}},uW.cloneTo=function(uW){ut.prototype.cloneTo.call(this,uW);var uj=uW;uj.angle=this.angle,uj.radius=this.radius,uj.length=this.length,uj.emitType=this.emitType,uj.randomDirection=this.randomDirection},um(uQ,["_tempPositionPoint",function(){return this._tempPositionPoint=new uEj},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new uEj}])}(uY),function(ut){function uW(){this.radius=NaN,this.emitFromShell=!1,uW.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}uT(uW,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",ut);var uj=uW.prototype;uj._getShapeBoundBox=function(uW){var uj=uW.min.elements;uj[0]=uj[1]=uj[2]=-this.radius;var ut=uW.max.elements;ut[0]=ut[1]=this.radius,ut[2]=0},uj._getSpeedBoundBox=function(uW){var uj=uW.min.elements;uj[0]=uj[1]=-1,uj[2]=0;var ut=uW.max.elements;ut[0]=ut[1]=ut[2]=1},uj.generatePositionAndDirection=function(uW,uj,ut,ud){var ub=uW.elements;ut?(ut.seed=ud[16],this.emitFromShell?uw._randomPointUnitSphere(uW,ut):uw._randomPointInsideUnitSphere(uW,ut),ud[16]=ut.seed):this.emitFromShell?uw._randomPointUnitSphere(uW):uw._randomPointInsideUnitSphere(uW),uOj.scale(uW,this.radius,uW);var uE=ub[2];uE<0&&(ub[2]=-1*uE),this.randomDirection?ut?(ut.seed=ud[17],uw._randomPointUnitSphere(uj,ut),ud[17]=ut.seed):uw._randomPointUnitSphere(uj):uW.cloneTo(uj)},uj.cloneTo=function(uW){ut.prototype.cloneTo.call(this,uW);var uj=uW;uj.radius=this.radius,uj.emitFromShell=this.emitFromShell,uj.randomDirection=this.randomDirection}}(uY),function(ut){function uW(){this.radius=NaN,this.emitFromShell=!1,uW.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}uT(uW,"laya.d3.core.particleShuriKen.module.shape.SphereShape",ut);var uj=uW.prototype;uj._getShapeBoundBox=function(uW){var uj=uW.min.elements;uj[0]=uj[1]=uj[2]=-this.radius;var ut=uW.max.elements;ut[0]=ut[1]=ut[2]=this.radius},uj._getSpeedBoundBox=function(uW){var uj=uW.min.elements;uj[0]=uj[1]=uj[2]=-1;var ut=uW.max.elements;ut[0]=ut[1]=ut[2]=1},uj.generatePositionAndDirection=function(uW,uj,ut,ud){ut?(ut.seed=ud[16],this.emitFromShell?uw._randomPointUnitSphere(uW,ut):uw._randomPointInsideUnitSphere(uW,ut),ud[16]=ut.seed):this.emitFromShell?uw._randomPointUnitSphere(uW):uw._randomPointInsideUnitSphere(uW),uOj.scale(uW,this.radius,uW),this.randomDirection?ut?(ut.seed=ud[17],uw._randomPointUnitSphere(uj,ut),ud[17]=ut.seed):uw._randomPointUnitSphere(uj):uW.cloneTo(uj)},uj.cloneTo=function(uW){ut.prototype.cloneTo.call(this,uW);var uj=uW;uj.radius=this.radius,uj.emitFromShell=this.emitFromShell,uj.randomDirection=this.randomDirection}}(uY),function(uW){function uj(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,uj.__super.call(this)}return uT(uj,"laya.d3.core.render.SubMeshRenderElement",ur),uj}()),uzj=function(uW){function uK(uW,uj,ut,ud,ub,uE){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=uW,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[uTj.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[uJj.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[uJj.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[uxj.SHADERDEFINE_ALPHATEST]="ALPHATEST";uK.__super.call(this,uW,uj,ut,null,{}),this._attributeMap=ud;var uO;for(uO in ub){var uq=ub[uO];switch(uq[1]){case 0:this._renderElementUniformMap[uO]=uq[0];break;case 1:this._materialUniformMap[uO]=uq[0];break;case 2:this._spriteUniformMap[uO]=uq[0];break;case 3:this._cameraUniformMap[uO]=uq[0];break;case 4:this._sceneUniformMap[uO]=uq[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}uT(uK,"laya.d3.shader.ShaderCompile3D",uM);var uj=uK.prototype;return uj._definesToNameDic=function(uW,uj){for(var ut={},ud=1,ub=0;ub<32&&!(uW<(ud=1<<ub));ub++)if(uW&ud){var uE=uj[ud];uE&&(ut[uE]="")}return ut},uj.withCompile=function(uW,uj,ut,ud){var ub,uE,uO;if(uE=this.sharders[uW])if(uO=uE[uj]){if(ub=uO[ut])return ub}else uO=uE[uj]=[];else uO=(uE=this.sharders[uW]=[])[uj]=[];var uq,uA=this._definesToNameDic(uW,uK._globalInt2name),uc=this._definesToNameDic(uj,this._spriteInt2name),uR=this._definesToNameDic(ut,this._materialInt2name),um={},uQ="";if(uA)for(uq in uA)uQ+="#define "+uq+"\n",um[uq]=!0;if(uc)for(uq in uc)uQ+="#define "+uq+"\n",um[uq]=!0;if(uR)for(uq in uR)uQ+="#define "+uq+"\n",um[uq]=!0;var uT=uuj.nameKey.getName(this._name)+" compile ("+uW+","+uj+","+ut+")",u$=this._VS.toscript(um,[]),ue=this._PS.toscript(um,[]);uh.now();if(ub=uuj.create(uQ+u$.join("\n"),uQ+ue.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,ud,uT),uO[ut]=ub,laya.d3.shader.ShaderCompile3D.debugMode)uh.now();return ub},uj.precompileShaderWithShaderDefine=function(uW,uj,ut){this.withCompile(uW,uj,ut,!0)},uj.addMaterialDefines=function(uW){var uj=uW.defines;for(var ut in uj){var ud=uj[ut],ub=parseInt(ut);this._materialInt2name[ub]=ud,this._materialName2Int[ud]=ub}},uj.addSpriteDefines=function(uW){var uj=uW.defines;for(var ut in uj){var ud=uj[ut],ub=parseInt(ut);this._spriteInt2name[ub]=ud,this._spriteName2Int[ud]=ub}},uj.getMaterialDefineByName=function(uW){return this._materialName2Int[uW]},uj.registerMaterialDefine=function(uW){var uj=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[uj]=uW,this._materialName2Int[uW]=uj},uj.registerSpriteDefine=function(uW){var uj=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[uj]=uW,this._spriteName2Int[uW]=uj},uK._globalRegDefine=function(uW,uj){uK._globalInt2name[uj]=uW},uK.add=function(uW,uj,ut,ud,ub){return laya.d3.shader.ShaderCompile3D._preCompileShader[uW]=new uK(uW,uj,ut,ud,ub,uM.includes)},uK.get=function(uW){return laya.d3.shader.ShaderCompile3D._preCompileShader[uuj.nameKey.getID(uW)]},uK._preCompileShader={},uK._globalInt2name=[],uK.debugMode=!1,uK.SHADERDEFINE_HIGHPRECISION=1,uK.SHADERDEFINE_FOG=4,uK.SHADERDEFINE_DIRECTIONLIGHT=8,uK.SHADERDEFINE_POINTLIGHT=16,uK.SHADERDEFINE_SPOTLIGHT=32,uK.SHADERDEFINE_UV0=64,uK.SHADERDEFINE_COLOR=128,uK.SHADERDEFINE_UV1=256,uK.SAHDERDEFINE_DEPTHFOG=131072,uK}(),uCj=function(uW){function u$(){u$.__super.call(this)}uT(u$,"laya.d3.graphics.MeshSprite3DStaticBatchManager",udW);var uj=u$.prototype;return uj._getStaticBatch=function(uW,uj,ut,ud){var ub,uE;return uE=uW?uW.id.toString()+ut.id.toString()+uj.id.toString()+ud.toString():ut.id.toString()+uj.id.toString()+ud.toString(),this._staticBatches[uE]?ub=this._staticBatches[uE]:this._staticBatches[uE]=ub=new uLj(uE,this,uW,uj,ut),ub},uj._initStaticBatchs=function(uW){var uj,ut;this._initBatchRenderElements.sort(u$._sortPrepareStaticBatch);for(var ud,ub=!1,uE=0,uO=0,uq=this._initBatchRenderElements.length;uO<uq;uO++){var uA,uc=this._initBatchRenderElements[uO],uR=uc.renderObj._getVertexBuffer(0);uc._sprite3D;if(ut===uR.vertexDeclaration&&uj===uc._material)if(ub)ud._addCombineBatchRenderObjTest(uc)?(uA=uc._staticBatch)!==ud&&(uA&&uA._deleteCombineBatchRenderObj(uc),ud._addCombineBatchRenderObj(uc)):(ub=!1,uE++);else{var um=this._initBatchRenderElements[uO-1],uQ=um.renderObj,uT=uc.renderObj;ub=!(65535<uQ._getVertexBuffer().vertexCount+uT._getVertexBuffer().vertexCount)&&(ud=this._getStaticBatch(uW,ut,uj,uE),(uA=um._staticBatch)!==ud&&(uA&&uA._deleteCombineBatchRenderObj(um),ud._addCombineBatchRenderObj(um)),(uA=uc._staticBatch)!==ud&&(uA&&uA._deleteCombineBatchRenderObj(uc),ud._addCombineBatchRenderObj(uc)),!0)}else ub=!1,uE=0;uj=uc._material,ut=uR.vertexDeclaration}},u$._sortPrepareStaticBatch=function(uW,uj){var ut=uW._render,ud=uj._render,ub=ut.lightmapIndex-ud.lightmapIndex;if(0!=ub)return ub;var uE=ut.receiveShadow-ud.receiveShadow;if(0!=uE)return uE;var uO=uW._mainSortID-uj._mainSortID;return 0==uO?uW.renderObj.triangleCount-uj.renderObj.triangleCount:uO},u$}(),uLj=function(uW){function uE(uW,uj,ut,ud,ub){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,uE.__super.call(this,uW,uj,ut),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=ud,this._material=ub}uT(uE,"laya.d3.graphics.SubMeshStaticBatch",ubW);var uj=uE.prototype;return uj._compareBatchRenderElement=function(uW,uj){return uW._batchIndexStart>uj._batchIndexStart},uj._addCombineBatchRenderObjTest=function(uW){var uj=uW.renderObj._vertexCount;return!(65535<(0<uj?this._currentCombineVertexCount+uj:this._currentCombineVertexCount+uW.renderObj._getVertexBuffer().vertexCount))},uj._addCombineBatchRenderObj=function(uW){var uj=uW.renderObj,ut=uj._vertexCount;this._initBatchRenderElements.push(uW),uW._staticBatch=this,0<ut?(this._currentCombineIndexCount+=uj._indexCount,this._currentCombineVertexCount+=ut):(this._currentCombineIndexCount=this._currentCombineIndexCount+uj._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+uj._getVertexBuffer().vertexCount),this._needFinishCombine=!0},uj._deleteCombineBatchRenderObj=function(uW){var uj=uW.renderObj,ut=this._initBatchRenderElements.indexOf(uW);if(-1!==ut){this._initBatchRenderElements.splice(ut,1),uW._staticBatch=null;var ud=uj._vertexCount;0<ud?(this._currentCombineIndexCount=this._currentCombineIndexCount-uj._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-ud):(this._currentCombineIndexCount=this._currentCombineIndexCount-uj._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-uj._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},uj._finishInit=function(){if(this._needFinishCombine){var uW=0,uj=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var ut=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),ud=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=uYj.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=usj.create("ushort",this._currentCombineIndexCount,35044);for(var ub=0,uE=this._initBatchRenderElements.length;ub<uE;ub++){var uO=this._initBatchRenderElements[ub],uq=uO.renderObj,uA=uq._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,uO._sprite3D),uc=uq.getIndices(),uR=uO._sprite3D.transform._isFrontFaceInvert,um=uW/(this._vertexDeclaration.vertexStride/4)-uq._vertexStart,uQ=uj,uT=uQ+uc.length;uO._batchIndexStart=uQ,uO._batchIndexEnd=uT,ud.set(uc,uj);var u$=0;if(uR)for(u$=uQ;u$<uT;u$+=3){ud[u$]=um+ud[u$];var ue=ud[u$+1],uK=ud[u$+2];ud[u$+1]=um+uK,ud[u$+2]=um+ue}else for(u$=uQ;u$<uT;u$+=3)ud[u$]=um+ud[u$],ud[u$+1]=um+ud[u$+1],ud[u$+2]=um+ud[u$+2];uj+=uc.length,ut.set(uA,uW),uW+=uA.length}this._vertexBuffer.setData(ut),this._indexBuffer.setData(ud),this._needFinishCombine=!1}},uj._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new uNj)},uj._getRenderElement=function(uW,uj,ut){for(var ud,ub,uE=this._batchRenderElements.length,uO=!0,uq=0;uq<uE;uq++){var uA,uc,uR=(ub=this._batchRenderElements[uq])._sprite3D._render;if(0!==uq&&(uO=(uA=(ud=this._batchRenderElements[uq-1])._sprite3D._render).lightmapIndex!==uR.lightmapIndex||uA.receiveShadow!==uR.receiveShadow||ud._batchIndexEnd!==ub._batchIndexStart),uO){(uc=this._getCombineRenderElementFromPool()).renderObj=this,uc._material=this._material,uc._batchIndexStart=ub._batchIndexStart,uc._batchIndexEnd=ub._batchIndexEnd;var um=uR.lightmapIndex,uQ=um+1,uT=this._batchOwnerIndices[uQ];uT||(uT=this._batchOwnerIndices[uQ]=[]);var u$,ue=uT[ub._render.receiveShadow?1:0];void 0===ue?(uT[uR.receiveShadow?1:0]=this._batchOwners.length,(u$=new uPj(null,"StaticBatchMeshSprite3D"))._scene=uj,u$._transform=this._rootOwner?this._rootOwner._transform:null,u$._render.lightmapIndex=um,u$._render.receiveShadow=ub._render.receiveShadow,this._batchOwners.push(u$)):u$=this._batchOwners[ue],u$._render._renderUpdate(ut),uc._sprite3D=u$,uW.push(uc)}else uc._batchIndexEnd=ub._batchIndexEnd}},uj._beforeRender=function(uW){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},uj._render=function(uW){var uj=uW.renderElement,ut=uj._batchIndexStart,ud=uj._batchIndexEnd-ut;uG.mainContext.drawElements(4,ud,5123,2*ut),uz.drawCall++,uz.trianglesFaces+=ud/3},uj.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},uj._getVertexBuffer=function(uW){return void 0===uW&&(uW=0),this._vertexBuffer},uE}(),uVj=function(uW){function uj(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,uj.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}uT(uj,"laya.d3.core.ComponentNode",uc);var ut=uj.prototype;return ut.addComponent=function(uW){var uj,ut=this._componentsMap.indexOf(uW);if(-1===ut)uj=[],this._componentsMap.push(uW),this._typeComponentsIndices.push(uj);else if(uj=this._typeComponentsIndices[ut],this._components[uj[0]].isSingleton)throw new Error("无法单实例创建"+uW+"组件，"+uW+"组件已存在！");var ud=ub.getInstance(uW);return uj.push(this._components.length),this._components.push(ud),ud instanceof laya.d3.component.Script&&this._scripts.push(ud),ud._initialize(this),ud},ut._removeComponent=function(uW,uj){var ut=this._typeComponentsIndices[uW],ud=ut[uj],ub=this._components[ud];this._components.splice(ud,1),ub instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(ub),1),ut.splice(uj,1),0===ut.length&&(this._typeComponentsIndices.splice(uW,1),this._componentsMap.splice(uW,1));for(var uE=0,uO=this._componentsMap.length;uE<uO;uE++)for(var uq=(ut=this._typeComponentsIndices[uE]).length-1;0<=uq;uq--){var uA=ut[uq];if(!(ud<uA))break;ut[uq]=--uA}ub._destroy()},ut.getComponentByType=function(uW,uj){void 0===uj&&(uj=0);var ut=this._componentsMap.indexOf(uW);return-1===ut?null:this._components[this._typeComponentsIndices[ut][uj]]},ut.getComponentsByType=function(uW,uj){var ut=this._componentsMap.indexOf(uW);if(-1!==ut){var ud=this._typeComponentsIndices[ut],ub=ud.length;uj.length=ub;for(var uE=0;uE<ub;uE++)uj[uE]=this._components[ud[uE]]}else uj.length=0},ut.getComponentByIndex=function(uW){return this._components[uW]},ut.removeComponentByType=function(uW,uj){void 0===uj&&(uj=0);var ut=this._componentsMap.indexOf(uW);-1!==ut&&this._removeComponent(ut,uj)},ut.removeComponentsByType=function(uW){var uj=this._componentsMap.indexOf(uW);if(-1!==uj)for(var ut=this._typeComponentsIndices[uj],ud=0,ub=ut.length;ud<ub;ut.length<ub?ub--:ud++)this._removeComponent(uj,ud)},ut.removeAllComponent=function(){for(var uW=0,uj=this._componentsMap.length;uW<uj;this._componentsMap.length<uj?uj--:uW++)this.removeComponentsByType(this._componentsMap[uW])},ut._updateComponents=function(uW){for(var uj=0,ut=this._components.length;uj<ut;uj++){var ud=this._components[uj];!ud.started&&(ud._start(uW),ud.started=!0),ud.enable&&ud._update(uW)}},ut._lateUpdateComponents=function(uW){for(var uj=0;uj<this._components.length;uj++){var ut=this._components[uj];!ut.started&&(ut._start(uW),ut.started=!0),ut.enable&&ut._lateUpdate(uW)}},ut._preRenderUpdateComponents=function(uW){for(var uj=0;uj<this._components.length;uj++){var ut=this._components[uj];!ut.started&&(ut._start(uW),ut.started=!0),ut.enable&&ut._preRenderUpdate(uW)}},ut._postRenderUpdateComponents=function(uW){for(var uj=0;uj<this._components.length;uj++){var ut=this._components[uj];!ut.started&&(ut._start(uW),ut.started=!0),ut.enable&&ut._postRenderUpdate(uW)}},uj}(),uxj=function(ud){function uW(){uW.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new uQj,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new uqj(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}uT(uW,"laya.d3.core.material.BaseMaterial",ud);var uj=uW.prototype;return uX.imps(uj,{"laya.d3.core.IClone":!0}),uj._addShaderDefine=function(uW){this._shaderDefineValue|=uW},uj._removeShaderDefine=function(uW){this._shaderDefineValue&=~uW},uj._addDisablePublicShaderDefine=function(uW){this._disablePublicShaderDefine|=uW},uj._removeDisablePublicShaderDefine=function(uW){this._disablePublicShaderDefine&=~uW},uj._setBuffer=function(uW,uj){this._shaderValues.setValue(uW,uj),this._values[uW]=uj},uj._getBuffer=function(uW){return this._values[uW]},uj._setMatrix4x4=function(uW,uj){this._shaderValues.setValue(uW,uj?uj.elements:null),this._values[uW]=uj},uj._getMatrix4x4=function(uW){return this._values[uW]},uj._setInt=function(uW,uj){this._shaderValues.setValue(uW,uj),this._values[uW]=uj},uj._getInt=function(uW){return this._values[uW]},uj._setNumber=function(uW,uj){this._shaderValues.setValue(uW,uj),this._values[uW]=uj},uj._getNumber=function(uW){return this._values[uW]},uj._setBool=function(uW,uj){this._shaderValues.setValue(uW,uj),this._values[uW]=uj},uj._getBool=function(uW){return this._values[uW]},uj._setVector2=function(uW,uj){this._shaderValues.setValue(uW,uj?uj.elements:null),this._values[uW]=uj},uj._getVector2=function(uW){return this._values[uW]},uj._setColor=function(uW,uj){this._shaderValues.setValue(uW,uj?uj.elements:null),this._values[uW]=uj},uj._getColor=function(uW){return this._values[uW]},uj._setTexture=function(uW,uj){var ut=this._values[uW];this._values[uW]=uj,this._shaderValues.setValue(uW,uj),0<this.referenceCount&&(ut&&ut._removeReference(),uj&&uj._addReference())},uj._getTexture=function(uW){return this._values[uW]},uj._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},uj._getShader=function(uW,uj,ut){var ud=(uW|uj)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(ud,ut,this._shaderDefineValue),this._shader},uj._setRenderStateBlendDepth=function(){var uW=uG.mainContext;switch(ul.setDepthMask(uW,this.depthWrite),0===this.depthTest?ul.setDepthTest(uW,!1):(ul.setDepthTest(uW,!0),ul.setDepthFunc(uW,this.depthTest)),this.blend){case 0:ul.setBlend(uW,!1);break;case 1:ul.setBlend(uW,!0),ul.setBlendFunc(uW,this.srcBlend,this.dstBlend);break;case 2:ul.setBlend(uW,!0)}},uj._setRenderStateFrontFace=function(uW,uj){var ut=uG.mainContext,ud=0;switch(this.cull){case 0:ul.setCullFace(ut,!1);break;case 1:ul.setCullFace(ut,!0),ud=uW?uj&&uj._isFrontFaceInvert?2305:2304:uj&&uj._isFrontFaceInvert?2304:2305,ul.setFrontFace(ut,ud);break;case 2:ul.setCullFace(ut,!0),ud=uW?uj&&uj._isFrontFaceInvert?2304:2305:uj&&uj._isFrontFaceInvert?2305:2304,ul.setFrontFace(ut,ud)}},uj.onAsynLoaded=function(uW,uj,ut){var ud=uj[0],ub=uj[1];switch(ud.version){case"LAYAMATERIAL:01":var uE=0,uO=0,uq=ud.props;for(var uA in uq)switch(uA){case"vectors":var uc=uq[uA];for(uE=0,uO=uc.length;uE<uO;uE++){var uR=uc[uE],um=uR.value;switch(um.length){case 2:this[uR.name]=new uEj(um[0],um[1]);break;case 3:this[uR.name]=new uOj(um[0],um[1],um[2]);break;case 4:this[uR.name]=new uqj(um[0],um[1],um[2],um[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var uQ=uq[uA];for(uE=0,uO=uQ.length;uE<uO;uE++){var uT=uQ[uE],u$=uT.path;u$&&(this[uT.name]=uo.getRes(ub[u$]))}break;case"defines":var ue=uq[uA];for(uE=0,uO=ue.length;uE<uO;uE++){var uK=this._shaderCompile.getMaterialDefineByName(ue[uE]);this._addShaderDefine(uK)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[uA]=uq[uA];break;case"renderQueue":switch(uq[uA]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[uA]=uq[uA]}break;case"LAYAMATERIAL:02":for(uA in uq=ud.props)switch(uA){case"vectors":for(uE=0,uO=(uc=uq[uA]).length;uE<uO;uE++)switch((um=(uR=uc[uE]).value).length){case 2:this[uR.name]=new uEj(um[0],um[1]);break;case 3:this[uR.name]=new uOj(um[0],um[1],um[2]);break;case 4:this[uR.name]=new uqj(um[0],um[1],um[2],um[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(uE=0,uO=(uQ=uq[uA]).length;uE<uO;uE++)(u$=(uT=uQ[uE]).path)&&(this[uT.name]=uo.getRes(ub[u$]));break;case"defines":for(uE=0,uO=(ue=uq[uA]).length;uE<uO;uE++)uK=this._shaderCompile.getMaterialDefineByName(ue[uE]),this._addShaderDefine(uK);break;default:this[uA]=uq[uA]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},uj._addReference=function(){ud.prototype._addReference.call(this);for(var uW=0,uj=this._values.length;uW<uj;uW++){var ut=this._values[uW];ut&&ut instanceof laya.d3.resource.BaseTexture&&ut._addReference()}},uj._removeReference=function(){ud.prototype._removeReference.call(this);for(var uW=0,uj=this._values.length;uW<uj;uW++){var ut=this._values[uW];ut&&ut instanceof laya.d3.resource.BaseTexture&&ut._removeReference()}},uj.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},uj.setShaderName=function(uW){var uj=uuj.nameKey.getID(uW);if(-1===uj)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=uzj._preCompileShader[uj]},uj.cloneTo=function(uW){var uj=uW;uj.name=this.name,uj.cull=this.cull,uj.blend=this.blend,uj.srcBlend=this.srcBlend,uj.dstBlend=this.dstBlend,uj.srcBlendRGB=this.srcBlendRGB,uj.dstBlendRGB=this.dstBlendRGB,uj.srcBlendAlpha=this.srcBlendAlpha,uj.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(uj.blendConstColor),uj.blendEquation=this.blendEquation,uj.blendEquationRGB=this.blendEquationRGB,uj.blendEquationAlpha=this.blendEquationAlpha,uj.depthTest=this.depthTest,uj.depthWrite=this.depthWrite,uj.renderQueue=this.renderQueue,uj._shader=this._shader,uj._disablePublicShaderDefine=this._disablePublicShaderDefine,uj._shaderDefineValue=this._shaderDefineValue;var ut,ud=0,ub=uj._shaderValues;uj._shaderValues.data.length=this._shaderValues.data.length;var uE=this._values.length,uO=uj._values;for(ud=0,ut=uO.length=uE;ud<ut;ud++){var uq=this._values[ud];if(uq)if("number"==typeof uq)uO[ud]=uq,ub.data[ud]=uq;else if("number"==typeof uq&&Math.floor(uq)==uq)uO[ud]=uq,ub.data[ud]=uq;else if("boolean"==typeof uq)uO[ud]=uq,ub.data[ud]=uq;else if(uq instanceof laya.d3.math.Vector2){var uA=uO[ud]||(uO[ud]=new uEj);uq.cloneTo(uA),ub.data[ud]=uA.elements}else if(uq instanceof laya.d3.math.Vector3){var uc=uO[ud]||(uO[ud]=new uOj);uq.cloneTo(uc),ub.data[ud]=uc.elements}else if(uq instanceof laya.d3.math.Vector4){var uR=uO[ud]||(uO[ud]=new uqj);uq.cloneTo(uR),ub.data[ud]=uR.elements}else if(uq instanceof laya.d3.math.Matrix4x4){var um=uO[ud]||(uO[ud]=new uWj);uq.cloneTo(um),ub.data[ud]=um.elements}else uq instanceof laya.d3.resource.BaseTexture&&(uO[ud]=uq,ub.data[ud]=uq)}},uj.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},u$(0,uj,"alphaTestValue",function(){return this._getNumber(0)},function(uW){this._setNumber(0,uW)}),u$(0,uj,"alphaTest",function(){return this._alphaTest},function(uW){(this._alphaTest=uW)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),uW.__init__=function(){uW.SHADERDEFINE_ALPHATEST=uW.shaderDefines.registerDefine("ALPHATEST")},uW.RENDERQUEUE_OPAQUE=2e3,uW.RENDERQUEUE_ALPHATEST=2450,uW.RENDERQUEUE_TRANSPARENT=3e3,uW.CULL_NONE=0,uW.CULL_FRONT=1,uW.CULL_BACK=2,uW.BLEND_DISABLE=0,uW.BLEND_ENABLE_ALL=1,uW.BLEND_ENABLE_SEPERATE=2,uW.BLENDPARAM_ZERO=0,uW.BLENDPARAM_ONE=1,uW.BLENDPARAM_SRC_COLOR=768,uW.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,uW.BLENDPARAM_DST_COLOR=774,uW.BLENDPARAM_ONE_MINUS_DST_COLOR=775,uW.BLENDPARAM_SRC_ALPHA=770,uW.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,uW.BLENDPARAM_DST_ALPHA=772,uW.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,uW.BLENDPARAM_SRC_ALPHA_SATURATE=776,uW.BLENDEQUATION_ADD=0,uW.BLENDEQUATION_SUBTRACT=1,uW.BLENDEQUATION_REVERSE_SUBTRACT=2,uW.DEPTHTEST_OFF=0,uW.DEPTHTEST_NEVER=512,uW.DEPTHTEST_LESS=513,uW.DEPTHTEST_EQUAL=514,uW.DEPTHTEST_LEQUAL=515,uW.DEPTHTEST_GREATER=516,uW.DEPTHTEST_NOTEQUAL=517,uW.DEPTHTEST_GEQUAL=518,uW.DEPTHTEST_ALWAYS=519,uW.SHADERDEFINE_ALPHATEST=1,uW.ALPHATESTVALUE=0,um(uW,["shaderDefines",function(){return this.shaderDefines=new uRj}]),uW}(uK),uGj=function(uW){function uj(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,uj.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}uT(uj,"laya.d3.resource.BaseTexture",uK);var ut=uj.prototype;return u$(0,ut,"width",function(){return this._width}),u$(0,ut,"repeat",function(){return this._repeat},function(uW){if(this._repeat!==uW&&(this._repeat=uW,this._source)){var uj=uG.mainContext;ul.bindTexture(uj,this._type,this._source),uZ.isPOT(this._width,this._height)&&this._repeat?(uj.texParameteri(this._type,10242,10497),uj.texParameteri(this._type,10243,10497)):(uj.texParameteri(this._type,10242,33071),uj.texParameteri(this._type,10243,33071))}}),u$(0,ut,"height",function(){return this._height}),u$(0,ut,"magFifter",function(){return this._magFifter},function(uW){(this._magFifter=uW)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(uW)}),u$(0,ut,"wrapModeV",function(){return this._wrapModeV}),u$(0,ut,"size",function(){return this._size}),u$(0,ut,"wrapModeU",function(){return this._wrapModeU}),u$(0,ut,"mipmap",function(){return this._mipmap},function(uW){this._mipmap=uW,this._mipmap!=uW&&this._conchTexture&&this._conchTexture.setMipMap(uW)}),u$(0,ut,"minFifter",function(){return this._minFifter},function(uW){this._minFifter=uW,this._minFifter!=uW&&this._conchTexture&&this._conchTexture.setMinFifter(uW)}),u$(0,ut,"format",function(){return this._format}),u$(0,ut,"source",function(){return this.activeResource(),this._source}),u$(0,ut,"defaulteTexture",function(){return ufj.grayTexture}),uj.WARPMODE_REPEAT=0,uj.WARPMODE_CLAMP=1,uj}(),ulj=function(uW){function uj(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,uj.__super.call(this),this._boundingBoxCorners=ud(8,null)}uT(uj,"laya.d3.resource.models.BaseMesh",uK);var ut=uj.prototype;return ut._getPositions=function(){throw new Error("未Override,请重载该属性！")},ut._generateBoundingObject=function(){this._boundingSphere=new ukW(new uOj,0),ukW.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new uBW(new uOj,new uOj),uBW.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},ut.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},ut.getRenderElement=function(uW){throw new Error("未Override,请重载该属性！")},u$(0,ut,"subMeshCount",function(){return this._subMeshCount}),u$(0,ut,"boundingBox",function(){return this._boundingBox}),u$(0,ut,"boundingBoxCorners",function(){return this._boundingBoxCorners}),u$(0,ut,"boundingSphere",function(){return this._boundingSphere}),uj}(),uhj=(function(uW){function uj(){uj.__super.call(this)}uT(uj,"laya.d3.component.Script",uMj);var ut=uj.prototype;ut.onTriggerEnter=function(uW){},ut.onTriggerExit=function(uW){},ut.onTriggerStay=function(uW){},u$(0,ut,"isSingleton",function(){return uj._isSingleton}),uj._isSingleton=!1}(),function(uW){function uj(uW){this._owner=null,this._sharedMesh=null,uj.__super.call(this),this._owner=uW}uT(uj,"laya.d3.core.MeshFilter",uW);var ut=uj.prototype;return ut._sharedMeshLoaded=function(){this.event("loaded")},ut._destroy=function(){uW.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},u$(0,ut,"sharedMesh",function(){return this._sharedMesh},function(uW){var uj=this._sharedMesh;uj&&uj._removeReference(),(this._sharedMesh=uW)._addReference(),this.event("meshchanged",[this,uj,uW]),uW.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),u$(0,ut,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),u$(0,ut,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),u$(0,ut,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),u$(0,ut,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),uj}(uZj)),uvj=function(uW){function uj(uW){uj.__super.call(this,uW),uW.meshFilter.on("meshchanged",this,this._onMeshChanged)}uT(uj,"laya.d3.core.MeshRender",uXj);var ut=uj.prototype;return ut._onMeshChanged=function(uW,uj,ut){ut.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:ut.once("loaded",this,this._onMeshLoaed)},ut._onMeshLoaed=function(uW,uj){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},ut._calculateBoundingSphereByInitSphere=function(uW){var uj=NaN,ut=this._owner.transform,ud=ut.scale.elements,ub=Math.abs(ud[0]),uE=Math.abs(ud[1]),uO=Math.abs(ud[2]);uj=uE<=ub&&uO<=ub?ub:uO<=uE?uE:uO,uOj.transformCoordinate(uW.center,ut.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=uW.radius*uj},ut._calculateBoundBoxByInitCorners=function(uW){for(var uj=this._owner.transform.worldMatrix,ut=0;ut<8;ut++)uOj.transformCoordinate(uW[ut],uj,uXj._tempBoundBoxCorners[ut]);uBW.createfromPoints(uXj._tempBoundBoxCorners,this._boundingBox)},ut._calculateBoundingSphere=function(){var uW=this._owner.meshFilter.sharedMesh;null==uW||null==uW.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(uW.boundingSphere)},ut._calculateBoundingBox=function(){var uW=this._owner.meshFilter.sharedMesh;null==uW||null==uW.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(uW.boundingBoxCorners)},ut._renderUpdate=function(uW){var uj=this._owner.transform;if(uj){this._setShaderValueMatrix4x4(0,uj.worldMatrix);var ut=this._owner.getProjectionViewWorldMatrix(uW);this._setShaderValueMatrix4x4(1,ut)}else this._setShaderValueMatrix4x4(0,uWj.DEFAULT),this._setShaderValueMatrix4x4(1,uW);return uoj.debugMode&&this._renderRenderableBoundBox(),!0},uj}(),uyj=function(uj){function ud(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,ud.__super.call(this),this._renderState=new ui,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new uQj,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new ujW,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new uOj(.7,.7,.7),this.ambientColor=new uOj(.212,.227,.259),uG.shaderHighPrecision&&this.addShaderDefine(uzj.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}uT(ud,"laya.d3.core.scene.Scene",uj);var uW=ud.prototype;return uX.imps(uW,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),uW._setUrl=function(uW){this._url=uW},uW._getGroup=function(){return this._group},uW._setGroup=function(uW){this._group=uW},uW._display=function(){uX.stage._scenes.push(this),uX.stage._scenes.sort(ud._sortScenes);for(var uW=0,uj=this._childs.length;uW<uj;uW++){var ut=this._childs[uW];ut.active&&ut._activeHierarchy()}},uW._unDisplay=function(){var uW=uX.stage._scenes;uW.splice(uW.indexOf(this),1);for(var uj=0,ut=this._childs.length;uj<ut;uj++){var ud=this._childs[uj];ud.active&&ud._inActiveHierarchy()}},uW._addChild3D=function(uW){uW.transform._onWorldTransform(),uW._setBelongScene(this),this.displayedInStage&&uW.active&&uW._activeHierarchy()},uW._removeChild3D=function(uW){uW.transform.parent=null,this.displayedInStage&&uW.active&&uW._inActiveHierarchy(),uW._setUnBelongScene()},uW.initOctree=function(uW,uj,ut,ud,ub){void 0===ub&&(ub=6),this.treeSize=new uOj(uW,uj,ut),this.treeLevel=ub,this.treeRoot=new uB(this,0),this.treeRoot.init(ud,this.treeSize)},uW._prepareUpdateToRenderState=function(uW,uj){uj.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,uj.scene=this},uW._prepareSceneToRender=function(uW){var uj=this._lights.length;if(0<uj)for(var ut=0,ud=0;ud<uj&&!(this._lights[ud]._prepareToScene(uW)&&++ut>=this._enableLightCount);ud++);},uW._updateChilds=function(uW){for(var uj=0,ut=this._childs.length;uj<ut;++uj)this._childs[uj]._update(uW)},uW._preRenderScene=function(uW,uj,ut){var ud,ub=uj._viewMatrix,uE=uj._projectionMatrix,uO=uj._projectionViewMatrix,uq=0,uA=uj.camera;for(uA.useOcclusionCulling?this.treeRoot?utW.renderObjectCullingOctree(ut,this,uA,ub,uE,uO):utW.renderObjectCulling(ut,this,uA,ub,uE,uO):utW.renderObjectCullingNoBoundFrustum(this,uA,ub,uE,uO),uq=0,ud=this._quenes.length;uq<ud;uq++)this._quenes[uq]&&this._quenes[uq]._preRender(uj)},uW._clear=function(uW,uj){var ut=uj._viewport,ud=uj.camera,ub=ut.x,uE=ud.renderTargetSize.height-ut.y-ut.height,uO=ut.width,uq=ut.height;uW.viewport(ub,uE,uO,uq);var uA=256,uc=ud.renderTarget;switch(ud.clearFlag){case 0:var uR=ud.clearColor;if(uR){uW.enable(3089),uW.scissor(ub,uE,uO,uq);var um=uR.elements;uW.clearColor(um[0],um[1],um[2],um[3]),uA|=16384}if(uc)switch(uR||(uA=16384),uc.depthStencilFormat){case 33189:uA|=256;break;case 36168:uA|=1024;break;case 34041:uA|=256,uA|=1024}uW.clear(uA),uR&&uW.disable(3089);break;case 1:case 2:if(uc)switch(uA=16384,uc.depthStencilFormat){case 33189:uA|=256;break;case 36168:uA|=1024;break;case 34041:uA|=256,uA|=1024}uW.clear(uA);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},uW._renderScene=function(uW,uj){var ut,ud,ub=uj.camera,uE=0;for(uE=0;uE<2;uE++)(ud=this._quenes[uE])&&(ub.renderTarget?ud._render(uj,!0):ud._render(uj,!1));if(1===ub.clearFlag){var uO=ub.sky;uO&&(ul.setCullFace(uW,!1),ul.setDepthFunc(uW,515),ul.setDepthMask(uW,!1),uO._render(uj),ul.setDepthFunc(uW,513),ul.setDepthMask(uW,!0))}for(uE=2,ut=this._quenes.length;uE<ut;uE++)(ud=this._quenes[uE])&&(ud._sortAlpha(uj.camera.transform.position),ub.renderTarget?ud._render(uj,!0):ud._render(uj,!1))},uW._set3DRenderConfig=function(uW){uW.disable(3042),ul._blend=!1,uW.blendFunc(770,771),ul._sFactor=770,ul._dFactor=771,uW.disable(2929),ul._depthTest=!1,uW.enable(2884),ul._cullFace=!0,uW.depthMask(1),ul._depthMask=!0,uW.frontFace(2304),ul._frontFace=2304},uW._set2DRenderConfig=function(uW){ul.setBlend(uW,!0),ul.setBlendFunc(uW,1,771),ul.setDepthTest(uW,!1),ul.setCullFace(uW,!1),ul.setDepthMask(uW,!0),ul.setFrontFace(uW,2305),uW.viewport(0,0,uR.width,uR.height)},uW._parseCustomProps=function(uW,uj,ut,ud){var ub=ud.customProps.lightmaps,uE=ub.length,uO=this._lightmaps;uO.length=uE;for(var uq=0;uq<uE;uq++)uO[uq]=uo.getRes(uj[ub[uq].replace(".exr",".png")]);this.setlightmaps(uO);var uA=ud.customProps.ambientColor;uA&&(this.ambientColor=new uOj(uA[0],uA[1],uA[2]));var uc=ud.customProps.fogColor;uc&&(this.fogColor=new uOj(uc[0],uc[1],uc[2]))},uW._addLight=function(uW){this._lights.indexOf(uW)<0&&this._lights.push(uW)},uW._removeLight=function(uW){var uj=this._lights.indexOf(uW);0<=uj&&this._lights.splice(uj,1)},uW._updateScene=function(){var uW=this._renderState;this._prepareUpdateToRenderState(uG.mainContext,uW),this._updateComponents(uW),this._updateChilds(uW),this._lateUpdateComponents(uW),this._time+=uW.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},uW._updateSceneConch=function(){var uW=this._renderState;this._prepareUpdateToRenderState(uG.mainContext,uW),this._updateComponents(uW),this._lateUpdateComponents(uW),this._prepareSceneToRender(uW);for(var uj=0,ut=this._cameraPool.length;uj<ut;uj++){var ud=this._cameraPool[uj];(uW.camera=ud)._prepareCameraToRender()}},uW._preRenderShadow=function(uW,uj,ut,ud,ub){this.treeRoot?utW.renderShadowObjectCullingOctree(this,uj,ut,ud,ub):utW.renderShadowObjectCulling(this,uj,ut,ud,ub);for(var uE=0,uO=ut.length;uE<uO;uE++)ut[uE]&&ut[uE]._preRender(uW)},uW._renderShadowMap=function(uW,uj,ut){var ud=this.parallelSplitShadowMaps[0];ud._calcAllLightCameraInfo(ut);var ub,uE,uO,uq=ud.PSSMNum;if(this._preRenderShadow(uj,ud._lightCulling,ud._shadowQuenes,ud._lightVPMatrix[0],uq),this.addShaderDefine(uTj.SHADERDEFINE_CAST_SHADOW),1<uq)for(var uA=0;uA<uq;uA++)ub=ud.getRenderTarget(uA+1),ud.beginRenderTarget(uA+1),uW.clearColor(1,1,1,1),uW.clear(16640),uW.viewport(0,0,ub.width,ub.height),uj.camera=uO=ud.getLightCamera(uA),uO._prepareCameraToRender(),uO._prepareCameraViewProject(uO.viewMatrix,uO.projectionMatrix),uj._projectionViewMatrix=ud._lightVPMatrix[uA+1],(uE=ud._shadowQuenes[uA])._preRender(uj),uE._renderShadow(uj,!1),ud.endRenderTarget(uA+1);else ub=ud.getRenderTarget(1),ud.beginRenderTarget(1),uW.clearColor(1,1,1,1),uW.clear(16640),uW.viewport(0,0,ub.width,ub.height),uj.camera=uO=ud.getLightCamera(0),uO._prepareCameraToRender(),uO._prepareCameraViewProject(uO.viewMatrix,uO.projectionMatrix),uj._projectionViewMatrix=ud._lightVPMatrix[0],(uE=ud._shadowQuenes[0])._preRender(uj),uE._renderShadow(uj,!0),ud.endRenderTarget(1);this.removeShaderDefine(uTj.SHADERDEFINE_CAST_SHADOW)},uW.addTreeNode=function(uW){this.treeRoot.addTreeNode(uW)},uW.removeTreeNode=function(uW){this.treeSize&&uW._treeNode&&uW._treeNode.removeObject(uW)},uW.setlightmaps=function(uW){this._lightmaps=uW;for(var uj=0,ut=this._renderableSprite3Ds.length;uj<ut;uj++)this._renderableSprite3Ds[uj]._render._applyLightMapParams()},uW.getlightmaps=function(){return this._lightmaps},uW.addChildAt=function(uW,uj){if(!(uW instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(uW&&uW.__className));if(!uW||this.destroyed||uW===this)return uW;if(uW.zOrder&&this._set$P("hasZorder",!0),0<=uj&&uj<=this._childs.length){if(uW._parent===this){var ut=this.getChildIndex(uW);this._childs.splice(ut,1),this._childs.splice(uj,0,uW),this.conchModel&&(this.conchModel.removeChild(uW.conchModel),this.conchModel.addChildAt(uW.conchModel,uj)),this._childChanged()}else uW.parent&&uW.parent.removeChild(uW),this._childs===uc.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(uj,0,uW),this.conchModel&&this.conchModel.addChildAt(uW.conchModel,uj),(uW.parent=this)._addChild3D(uW);return uW}throw new Error("appendChildAt:The index is out of bounds")},uW.addChild=function(uW){if(!(uW instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!uW||this.destroyed||uW===this)return uW;if(uW.zOrder&&this._set$P("hasZorder",!0),uW._parent===this){var uj=this.getChildIndex(uW);uj!==this._childs.length-1&&(this._childs.splice(uj,1),this._childs.push(uW),this.conchModel&&(this.conchModel.removeChild(uW.conchModel),this.conchModel.addChildAt(uW.conchModel,this._childs.length-1)),this._childChanged())}else uW.parent&&uW.parent.removeChild(uW),this._childs===uc.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(uW),this.conchModel&&this.conchModel.addChildAt(uW.conchModel,this._childs.length-1),(uW.parent=this)._childChanged(),this._addChild3D(uW);return uW},uW.removeChildAt=function(uW){var uj=this.getChildAt(uW);return uj&&(this._removeChild3D(uj),this._childs.splice(uW,1),this.conchModel&&this.conchModel.removeChild(uj.conchModel),uj.parent=null),uj},uW.removeChildren=function(uW,uj){if(void 0===uW&&(uW=0),void 0===uj&&(uj=2147483647),this._childs&&0<this._childs.length){var ut=this._childs;if(0===uW&&uE<=uj){var ud=ut;this._childs=uc.ARRAY_EMPTY}else ud=ut.splice(uW,uj-uW);for(var ub=0,uE=ud.length;ub<uE;ub++)this._removeChild3D(ud[ub]),ud[ub].parent=null,this.conchModel&&this.conchModel.removeChild(ud[ub].conchModel)}return this},uW.addFrustumCullingObject=function(uW){this.treeRoot?this.addTreeNode(uW):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(uW):this._cullingRenders[this._cullingRendersLength]=uW,uW._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},uW.removeFrustumCullingObject=function(uW){if(this.treeRoot)this.removeTreeNode(uW);else{this._cullingRendersLength--;var uj=uW._indexInSceneFrustumCullingObjects;if(uj!==this._cullingRendersLength){var ut=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[uj]=ut)._indexInSceneFrustumCullingObjects=uj,uW._indexInSceneFrustumCullingObjects=-1}}},uW.getRenderQueue=function(uW){return uW<3e3?this._quenes[1]||(this._quenes[1]=new uP(this)):this._quenes[2]||(this._quenes[2]=new uP(this))},uW.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new uP(this)},uW.addShaderDefine=function(uW){this._shaderDefineValue|=uW},uW.removeShaderDefine=function(uW){this._shaderDefineValue&=~uW},uW.addScript=function(uW){return this._addComponent(uW)},uW.getScriptByType=function(uW,uj){return void 0===uj&&(uj=0),this._getComponentByType(uW,uj)},uW.getScriptsByType=function(uW,uj){this._getComponentsByType(uW,uj)},uW.getScriptByIndex=function(uW){return this._getComponentByIndex(uW)},uW.removeScriptByType=function(uW,uj){void 0===uj&&(uj=0),this._removeComponentByType(uW,uj)},uW.removeScriptsByType=function(uW){this._removeComponentByType(uW)},uW.removeAllScript=function(){this._removeAllComponent()},uW.render=function(uW,uj,ut){(ue._context.ctx._renderKey=0)<this._childs.length&&uW.addRenderObject(this)},uW.renderSubmit=function(){var uW=uG.mainContext,uj=this._renderState;this._set3DRenderConfig(uW),this._prepareSceneToRender(this._renderState);var ut,ud=0,ub=0;if(uoj.debugMode||uB.debugMode)for(ud=0,ub=this._cameraPool.length;ud<ub;ud++)ut=this._cameraPool[ud],uoj._debugPhasorSprite.begin(1,ut),ut.activeInHierarchy&&ut._renderCamera(uW,uj,this),uoj._debugPhasorSprite.end();else for(ud=0,ub=this._cameraPool.length;ud<ub;ud++)(ut=this._cameraPool[ud]).activeInHierarchy&&ut._renderCamera(uW,uj,this);return this._set2DRenderConfig(uW),1},uW.onAsynLoaded=function(uW,uj,ut){var ud=uj[0];if("Scene"!==ud.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var ub=uj[1];uKj._createNodeByJson(this,ud,this,ub),this.event("hierarchyloaded",[this]),this.__loaded=!0},uW.destroy=function(uW){void 0===uW&&(uW=!0),this.destroyed||(uj.prototype.destroy.call(this,uW),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,uo.clearRes(this.url),this.loaded||uoj._cancelLoadByUrl(this.url))},uW.getRenderType=function(){return 0},uW.releaseRender=function(){},uW._addComponent=function(uW){var uj,ut=this._componentsMap.indexOf(uW);if(-1===ut)uj=[],this._componentsMap.push(uW),this._typeComponentsIndices.push(uj);else if(uj=this._typeComponentsIndices[ut],this._components[uj[0]].isSingleton)throw new Error("无法单实例创建"+uW+"组件，"+uW+"组件已存在！");var ud=ub.getInstance(uW);uj.push(this._components.length),this._components.push(ud);return ud._initialize(this),ud},uW._removeComponent=function(uW,uj){var ut=this._typeComponentsIndices[uW],ud=ut[uj],ub=this._components[ud];this._components.splice(ud,1),ut.splice(uj,1),0===ut.length&&(this._typeComponentsIndices.splice(uW,1),this._componentsMap.splice(uW,1));for(var uE=0,uO=this._componentsMap.length;uE<uO;uE++)for(var uq=(ut=this._typeComponentsIndices[uE]).length-1;0<=uq;uq--){var uA=ut[uq];if(!(ud<uA))break;ut[uq]=--uA}ub._destroy()},uW._getComponentByType=function(uW,uj){void 0===uj&&(uj=0);var ut=this._componentsMap.indexOf(uW);return-1===ut?null:this._components[this._typeComponentsIndices[ut][uj]]},uW._getComponentsByType=function(uW,uj){var ut=this._componentsMap.indexOf(uW);if(-1!==ut){var ud=this._typeComponentsIndices[ut],ub=ud.length;uj.length=ub;for(var uE=0;uE<ub;uE++)uj[uE]=this._components[ud[uE]]}else uj.length=0},uW._getComponentByIndex=function(uW){return this._components[uW]},uW._removeComponentByType=function(uW,uj){void 0===uj&&(uj=0);var ut=this._componentsMap.indexOf(uW);-1!==ut&&this._removeComponent(ut,uj)},uW._removeComponentsByType=function(uW){var uj=this._componentsMap.indexOf(uW);if(-1!==uj)for(var ut=this._typeComponentsIndices[uj],ud=0,ub=ut.length;ud<ub;ut.length<ub?ub--:ud++)this._removeComponent(uj,ud)},uW._removeAllComponent=function(){for(var uW=0,uj=this._componentsMap.length;uW<uj;this._componentsMap.length<uj?uj--:uW++)this._removeComponentsByType(this._componentsMap[uW])},uW._updateComponents=function(uW){for(var uj=0,ut=this._components.length;uj<ut;uj++){var ud=this._components[uj];!ud.started&&(ud._start(uW),ud.started=!0),ud.enable&&ud._update(uW)}},uW._lateUpdateComponents=function(uW){for(var uj=0;uj<this._components.length;uj++){var ut=this._components[uj];!ut.started&&(ut._start(uW),ut.started=!0),ut.enable&&ut._lateUpdate(uW)}},uW._preRenderUpdateComponents=function(uW){for(var uj=0;uj<this._components.length;uj++){var ut=this._components[uj];!ut.started&&(ut._start(uW),ut.started=!0),ut.enable&&ut._preRenderUpdate(uW)}},uW._postRenderUpdateComponents=function(uW){for(var uj=0;uj<this._components.length;uj++){var ut=this._components[uj];!ut.started&&(ut._start(uW),ut.started=!0),ut.enable&&ut._postRenderUpdate(uW)}},u$(0,uW,"_loaded",null,function(uW){this.__loaded=uW}),u$(0,uW,"fogColor",function(){return this._fogColor},function(uW){this._fogColor=uW,this._shaderValues.setValue(0,uW.elements)}),u$(0,uW,"enableFog",function(){return this._enableFog},function(uW){this._enableFog!==uW&&((this._enableFog=uW)?(this.addShaderDefine(uzj.SHADERDEFINE_FOG),this.removeShaderDefine(uzj.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(uzj.SHADERDEFINE_FOG))}),u$(0,uW,"url",function(){return this._url}),u$(0,uW,"loaded",function(){return this.__loaded}),u$(0,uW,"enableDepthFog",function(){return this._enableDepthFog},function(uW){this._enableDepthFog!=uW&&((this._enableDepthFog=uW)?(this.addShaderDefine(uzj.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(uzj.SHADERDEFINE_FOG)):this.removeShaderDefine(uzj.SAHDERDEFINE_DEPTHFOG))}),u$(0,uW,"fogStart",function(){return this._fogStart},function(uW){this._fogStart=uW,this._shaderValues.setValue(1,uW)}),u$(0,uW,"fogRange",function(){return this._fogRange},function(uW){this._fogRange=uW,this._shaderValues.setValue(2,uW)}),u$(0,uW,"ambientColor",function(){return this._ambientColor},function(uW){this._ambientColor=uW,this._shaderValues.setValue(21,uW.elements)}),u$(0,uW,"scene",function(){return this}),u$(0,uW,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),ud._sortScenes=function(uW,uj){if(uW.parent!==uX.stage||uj.parent!==uX.stage)return uW.parent!==uX.stage&&uj.parent!==uX.stage?ud._sortScenes(uW.parent,uj.parent):uW.parent===uX.stage?-1:1;var ut=uX.stage._childs;return ut.indexOf(uW)-ut.indexOf(uj)},ud.load=function(uW){return uX.loader.create(uW,null,null,ud)},ud.FOGCOLOR=0,ud.FOGSTART=1,ud.FOGRANGE=2,ud.LIGHTDIRECTION=3,ud.LIGHTDIRCOLOR=4,ud.POINTLIGHTPOS=5,ud.POINTLIGHTRANGE=6,ud.POINTLIGHTATTENUATION=7,ud.POINTLIGHTCOLOR=8,ud.SPOTLIGHTPOS=9,ud.SPOTLIGHTDIRECTION=10,ud.SPOTLIGHTSPOT=11,ud.SPOTLIGHTRANGE=12,ud.SPOTLIGHTATTENUATION=13,ud.SPOTLIGHTCOLOR=14,ud.SHADOWDISTANCE=15,ud.SHADOWLIGHTVIEWPROJECT=16,ud.SHADOWMAPPCFOFFSET=17,ud.SHADOWMAPTEXTURE1=18,ud.SHADOWMAPTEXTURE2=19,ud.SHADOWMAPTEXTURE3=20,ud.AMBIENTCOLOR=21,ud.TIME=22,ud}(uN),uaj=function(uW){function uj(uW){uj.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new uWj,this._shaderValues=new uQj,this._colliders=[],this._id=++uj._uniqueIDCounter,this._transform=new u_j(this),this.name=uW||"Sprite3D-"+uj._nameNumberCounter++,this.layer=uv.currentCreationLayer,this.active=!0}uT(uj,"laya.d3.core.Sprite3D",uVj);var ut=uj.prototype;return uX.imps(ut,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),ut._setUrl=function(uW){this._url=uW},ut._getGroup=function(){return this._group},ut._setGroup=function(uW){this._group=uW},ut._addChild3D=function(uW){uW.transform.parent=this.transform,this._hierarchyAnimator&&(!uW._hierarchyAnimator&&uW._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(uW,!0,[uW.name])),this._scene&&(uW._setBelongScene(this._scene),this._activeInHierarchy&&uW._active&&uW._activeHierarchy())},ut._removeChild3D=function(uW){uW.transform.parent=null,this._scene&&(this._activeInHierarchy&&uW._active&&uW._inActiveHierarchy(),uW._setUnBelongScene()),this._hierarchyAnimator&&(uW._hierarchyAnimator==this._hierarchyAnimator&&uW._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(uW,!1,[uW.name]))},ut._parseBaseCustomProps=function(uW){var uj=this.transform.localPosition;uW.translate?(uj.fromArray(uW.translate),uj.x*=100,uj.y*=100,uj.z*=100):uj.elements.fill(0),this.transform.localPosition=uj;var ut=this.transform.localRotation;uW.rotation?ut.fromArray(uW.rotation):ut.fromArray([0,0,0,-1]),this.transform.localRotation=ut;var ud=this.transform.localScale;uW.scale?ud.fromArray(uW.scale):ud.elements.fill(1),this.transform.localScale=ud;var ub=uW.layer;null!=ub&&(this.layer=uv.getLayerByNumber(ub))},ut._parseCustomComponent=function(uW,uj,ut){for(var ud in ut){var ub=ut[ud];switch(ud){case"Animator":var uE=this.addComponent(Animator);if(ub.avatarPath)uE.avatar=uo.getRes(uj[ub.avatarPath]);else{var uO=ub.avatar;if(uO){uE.avatar=uo.getRes(uj[uO.path]);var uq=uO.linkSprites;uq&&uW.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[uE,uq])}}for(var uA=ub.clipPaths,uc=uA.length,uR=0;uR<uc;uR++)uE.addClip(uo.getRes(uj[uA[uR]]));uE.clip=uo.getRes(uj[uA[0]]);var um=ub.playOnWake;void 0!==um&&(uE.playOnWake=um);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var uQ=this.addComponent(SphereCollider);uQ.isTrigger=ub.isTrigger;var uT=uQ.center;uT.fromArray(ub.center),uQ.center=uT,uQ.radius=ub.radius;break;case"BoxCollider":var u$=this.addComponent(BoxCollider);u$.isTrigger=ub.isTrigger,u$.center.fromArray(ub.center);var ue=u$.size;ue.fromArray(ub.size),u$.size=ue;break;case"MeshCollider":this.addComponent(MeshCollider)}}},ut._onRootNodeHierarchyLoaded=function(uW,uj){for(var ut in uj){for(var ud=this,ub=uj[ut],uE=0,uO=ub.length;uE<uO;uE++){var uq=ub[uE];if(""===uq)break;if(!(ud=ud.getChildByName(uq)))break}ud&&uW.linkSprite3DToAvatarNode(ut,ud)}},ut._setHierarchyAnimator=function(uW,uj){this._changeHierarchyAnimator(uW);for(var ut=0,ud=this._childs.length;ut<ud;ut++){var ub=this._childs[ut];ub._hierarchyAnimator==uj&&ub._setHierarchyAnimator(uW,uj)}},ut._clearHierarchyAnimator=function(uW,uj){this._changeHierarchyAnimator(uj);for(var ut=0,ud=this._childs.length;ut<ud;ut++){var ub=this._childs[ut];ub._hierarchyAnimator==uW&&ub._clearHierarchyAnimator(uW,uj)}},ut._getAnimatorToLinkSprite3D=function(uW,uj,ut){var ud=this.getComponentByType(Animator);if(ud&&(ud.avatar?ud.avatar._version||uW._setAnimatorToLinkAvatar(ud,uj):uW._setAnimatorToLinkSprite3DNoAvatar(ud,uj,ut)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){ut.unshift(this._parent.name);var ub=this._parent;ub._hierarchyAnimator&&ub._getAnimatorToLinkSprite3D(uW,uj,ut)}},ut._setAnimatorToLinkSprite3DNoAvatar=function(uW,uj,ut){var ud=0,ub=0;for(ud=0,ub=uW.getClipCount();ud<ub;ud++)uW._handleSpriteOwnersBySprite(ud,uj,ut,this);for(ud=0,ub=this._childs.length;ud<ub;ud++){var uE=this._childs[ud],uO=ut.length;ut.push(uE.name),uE._setAnimatorToLinkSprite3DNoAvatar(uW,uj,ut),ut.splice(uO,1)}},ut._changeHierarchyAnimator=function(uW){this._hierarchyAnimator=uW},ut._isLinkSpriteToAnimationNode=function(uW,uj,ut){var ud=uW._avatarNodes.indexOf(uj),ub=uW._cacheSpriteToNodesMap;if(ut)this._transform.dummy=uj.transform,uW._cacheNodesToSpriteMap[ud]=ub.length,ub.push(ud);else{this._transform.dummy=null;var uE=uW._cacheNodesToSpriteMap[ud];uW._cacheNodesToSpriteMap[ud]=null,ub.splice(uE,1)}},ut._setBelongScene=function(uW){this._scene=uW;for(var uj=0,ut=this._childs.length;uj<ut;uj++)this._childs[uj]._setBelongScene(uW)},ut._setUnBelongScene=function(){this._scene=null;for(var uW=0,uj=this._childs.length;uW<uj;uW++)this._childs[uW]._setUnBelongScene()},ut._activeHierarchy=function(){var uW=0,uj=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),uW=0,uj=this._colliders.length;uW<uj;uW++)this._layer._addCollider(this._colliders[uW]);for(this.event("activeinhierarchychanged",!0),uW=0,uj=this._childs.length;uW<uj;uW++){var ut=this._childs[uW];ut._active&&ut._activeHierarchy()}},ut._inActiveHierarchy=function(){var uW=0,uj=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),uW=0,uj=this._colliders.length;uW<uj;uW++){var ut=this._colliders[uW];ut._clearCollsionMap(),this._layer._removeCollider(ut)}for(this.event("activeinhierarchychanged",!1),uW=0,uj=this._childs.length;uW<uj;uW++){var ud=this._childs[uW];ud._active&&ud._inActiveHierarchy()}},ut.addComponent=function(uW){var uj,ut=this._componentsMap.indexOf(uW);if(-1===ut)uj=[],this._componentsMap.push(uW),this._typeComponentsIndices.push(uj);else if(uj=this._typeComponentsIndices[ut],this._components[uj[0]].isSingleton)throw new Error("无法单实例创建"+uW+"组件，"+uW+"组件已存在！");var ud=ub.getInstance(uW);return uj.push(this._components.length),this._components.push(ud),ud instanceof laya.d3.component.Script&&this._scripts.push(ud),ud._initialize(this),ud},ut._removeComponent=function(uW,uj){var ut,ud=0,ub=this._typeComponentsIndices[uW],uE=ub[uj],uO=this._components[uE];for(uO instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(uO),1),ub.splice(uj,1),0===ub.length&&(this._typeComponentsIndices.splice(uW,1),this._componentsMap.splice(uW,1)),ud=0,ut=this._componentsMap.length;ud<ut;ud++)for(var uq=(ub=this._typeComponentsIndices[ud]).length-1;0<=uq;uq--){var uA=ub[uq];if(!(uE<uA))break;ub[uq]=--uA}uO._destroy()},ut._clearSelfRenderObjects=function(){},ut._addSelfRenderObjects=function(){},ut._parseCustomProps=function(uW,uj,ut,ud){},ut._updateChilds=function(uW){var uj=this._childs.length;if(0!==uj)for(var ut=0;ut<uj;++ut)this._childs[ut]._update(uW)},ut._getSortID=function(uW,uj){return 1e3*uj.id+uW._getVertexBuffer().vertexDeclaration.id},ut._update=function(uW){(uW.owner=this)._activeInHierarchy&&(this._updateComponents(uW),this._lateUpdateComponents(uW),uz.spriteCount++,this._childs.length&&this._updateChilds(uW))},ut.getProjectionViewWorldMatrix=function(uW){return uWj.multiply(uW,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},ut.loadHierarchy=function(uW){this.addChild(laya.d3.core.Sprite3D.load(uW))},ut.addChildAt=function(uW,uj){if(!(uW instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!uW||this.destroyed||uW===this)return uW;if(uW.zOrder&&this._set$P("hasZorder",!0),0<=uj&&uj<=this._childs.length){if(uW._parent===this){var ut=this.getChildIndex(uW);this._childs.splice(ut,1),this._childs.splice(uj,0,uW),this.conchModel&&(this.conchModel.removeChild(uW.conchModel),this.conchModel.addChildAt(uW.conchModel,uj)),this._childChanged()}else uW.parent&&uW.parent.removeChild(uW),this._childs===uc.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(uj,0,uW),this.conchModel&&this.conchModel.addChildAt(uW.conchModel,uj),(uW.parent=this)._addChild3D(uW);return uW}throw new Error("appendChildAt:The index is out of bounds")},ut.addChild=function(uW){if(!(uW instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!uW||this.destroyed||uW===this)return uW;if(uW.zOrder&&this._set$P("hasZorder",!0),uW._parent===this){var uj=this.getChildIndex(uW);uj!==this._childs.length-1&&(this._childs.splice(uj,1),this._childs.push(uW),this.conchModel&&(this.conchModel.removeChild(uW.conchModel),this.conchModel.addChildAt(uW.conchModel,this._childs.length-1)),this._childChanged())}else uW.parent&&uW.parent.removeChild(uW),this._childs===uc.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(uW),this.conchModel&&this.conchModel.addChildAt(uW.conchModel,this._childs.length-1),(uW.parent=this)._childChanged(),this._addChild3D(uW);return uW},ut.removeChildAt=function(uW){var uj=this.getChildAt(uW);return uj&&(this._removeChild3D(uj),this._childs.splice(uW,1),this.conchModel&&this.conchModel.removeChild(uj.conchModel),uj.parent=null),uj},ut.removeChildren=function(uW,uj){if(void 0===uW&&(uW=0),void 0===uj&&(uj=2147483647),this._childs&&0<this._childs.length){var ut=this._childs;if(0===uW&&uE<=uj){var ud=ut;this._childs=uc.ARRAY_EMPTY}else ud=ut.splice(uW,uj-uW);for(var ub=0,uE=ud.length;ub<uE;ub++)this._removeChild3D(ud[ub]),ud[ub].parent=null,this.conchModel&&this.conchModel.removeChild(ud[ub].conchModel)}return this},ut.onAsynLoaded=function(uW,uj,ut){var ud=uj[0];if("Sprite3D"!==ud.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var ub=uj[1];uKj._createNodeByJson(this,ud,this,ub),this.event("hierarchyloaded",[this]),this.__loaded=!0},ut.cloneTo=function(uW){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var uj=uW;uj.name=this.name,uj._destroyed=this._destroyed,uj.timer=this.timer,uj._$P=this._$P,uj.active=this._active;var ut=uj.transform.localPosition;this.transform.localPosition.cloneTo(ut),uj.transform.localPosition=ut;var ud=uj.transform.localRotation;this.transform.localRotation.cloneTo(ud),uj.transform.localRotation=ud;var ub=uj.transform.localScale;this.transform.localScale.cloneTo(ub),uj.transform.localScale=ub,uj.isStatic=this.isStatic;var uE=0,uO=0;for(uE=0,uO=this._componentsMap.length;uE<uO;uE++){var uq=uj.addComponent(this._componentsMap[uE]);this._components[uE]._cloneTo(uq)}for(uE=0,uO=this._childs.length;uE<uO;uE++)uj.addChild(this._childs[uE].clone());var uA=uj.getComponentByType(Animator);if(uA){var uc=uA._linkSpritesData;if(uc)for(var uR in uc){for(var um=uc[uR],uQ=uj,uT=0,u$=um.length;uT<u$&&(uQ=uQ.getChildByName(um[uT]));uT++);if(uQ){var ue=uA._avatarNodeMap[uR];uQ._isLinkSpriteToAnimationNode(uA,ue,!0)}}}},ut.clone=function(){var uW=new this.constructor;return this.cloneTo(uW),uW},ut.destroy=function(uW){if(void 0===uW&&(uW=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,uW);var uj,ut=0;for(ut=0,uj=this._components.length;ut<uj;ut++)this._components[ut]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,uo.clearRes(this.url),this.loaded||uoj._cancelLoadByUrl(this.url)}},ut._handleSpriteToAvatar=function(uW,uj){uW._avatarNodes;var ut=uW._avatarNodeMap[this.name];ut&&ut.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(uW,ut,uj)},ut._setAnimatorToLinkAvatar=function(uW,uj){this._handleSpriteToAvatar(uW,uj);for(var ut=0,ud=this._childs.length;ut<ud;ut++){this._childs[ut]._setAnimatorToLinkAvatar(uW,uj)}},u$(0,ut,"activeInHierarchy",function(){return this._activeInHierarchy}),u$(0,ut,"_loaded",null,function(uW){this.__loaded=uW}),u$(0,ut,"active",function(){return this._active},function(uW){this._active!==uW&&(this._active=uW,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(uW?this._activeHierarchy():this._inActiveHierarchy()))}),u$(0,ut,"componentsCount",function(){return this._components.length}),u$(0,ut,"loaded",function(){return this.__loaded}),u$(0,ut,"id",function(){return this._id}),u$(0,ut,"url",function(){return this._url}),u$(0,ut,"layer",function(){return this._layer},function(uW){if(this._layer!==uW){if(!uW)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var uj=0,ut=this._colliders.length;if(this._layer)for(uj=0;uj<ut;uj++)this._layer._removeCollider(this._colliders[uj]);for(uj=0;uj<ut;uj++)uW._addCollider(this._colliders[uj])}this._layer=uW,this.event("layerchanged",uW)}}),u$(0,ut,"scene",function(){return this._scene}),u$(0,ut,"transform",function(){return this._transform}),uj.instantiate=function(uW,uj,ut,ud,ub){void 0===ut&&(ut=!0);var uE=uW.clone();uj&&uj.addChild(uE);var uO=uE.transform;if(ut){var uq=uO.worldMatrix;uW.transform.worldMatrix.cloneTo(uq),uO.worldMatrix=uq}else ud&&(uO.position=ud),ub&&(uO.rotation=ub);return uE},uj.load=function(uW){return uX.loader.create(uW,null,null,uj)},uj.WORLDMATRIX=0,uj.MVPMATRIX=1,uj._uniqueIDCounter=0,uj._nameNumberCounter=0,uj}(),uuj=function(uW){function uR(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],uR.__super.call(this),!uW||!uj)throw"Shader Error";this._id=++uR._count,this._vs=uW,this._ps=uj,this._attributeMap=ut,this._sceneUniformMap=ud,this._cameraUniformMap=ub,this._spriteUniformMap=uE,this._materialUniformMap=uO,this._renderElementUniformMap=uq,this._precompile=uA,this._define=uc,this._precompile&&uR.extCompileObj&&uR.extCompileFunc?uR.extCompileFunc.call(uR.extCompileObj,uW,uj,uc):this.recreateResource()}uT(uR,"laya.d3.shader.Shader3D",ut);var uj=uR.prototype;return uj.recreateResource=function(){uh.now();this._compile(),this.completeCreate(),this.memorySize=0},uj.disposeResource=function(){uG.mainContext.deleteShader(this._vshader),uG.mainContext.deleteShader(this._pshader),uG.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},uj._compile=function(){if(!uG.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var uW=[this._vs,this._ps],uj=uG.mainContext;if(this._program=uj.createProgram(),this._vshader=uR._createShader(uj,uW[0],35633),this._pshader=uR._createShader(uj,uW[1],35632),uj.attachShader(this._program,this._vshader),uj.attachShader(this._program,this._pshader),uj.linkProgram(this._program),!ue.isConchApp&&uzj.debugMode&&!uj.getProgramParameter(this._program,35714))throw uj.getProgramInfoLog(this._program);var ut,ud=0,ub=0,uE=0;for(uE=ue.isConchApp?uj.getProgramParameterEx(this._vs,this._ps,"",35721):uj.getProgramParameter(this._program,35721),ud=0;ud<uE;ud++){var uO=null;ut={vartype:"attribute",ivartype:0,attrib:uO=ue.isConchApp?uj.getActiveAttribEx(this._vs,this._ps,"",ud):uj.getActiveAttrib(this._program,ud),location:uj.getAttribLocation(this._program,uO.name),name:uO.name,type:uO.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(ut)}var uq=0;for(uq=ue.isConchApp?uj.getProgramParameterEx(this._vs,this._ps,"",35718):uj.getProgramParameter(this._program,35718),ud=0;ud<uq;ud++){var uA=null;uA=ue.isConchApp?uj.getActiveUniformEx(this._vs,this._ps,"",ud):uj.getActiveUniform(this._program,ud),0<(ut={vartype:"uniform",ivartype:1,attrib:uO,location:uj.getUniformLocation(this._program,uA.name),name:uA.name,type:uA.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(ut.name=ut.name.substr(0,ut.name.length-3),ut.isArray=!0,ut.location=uj.getUniformLocation(this._program,ut.name)),this._uniformParams.push(ut)}for(ud=0,ub=this._attributeParams.length;ud<ub;ud++)(ut=this._attributeParams[ud]).indexOfParams=ud,ut.index=1,ut.value=[ut.location,null],ut.codename=ut.name,ut.name=null!=this._attributeMap[ut.codename]?this._attributeMap[ut.codename]:ut.codename,this._attributeParamsMap.push(ut.name),this._attributeParamsMap.push(ut),ut._this=this,ut.uploadedValue=[],ut.fun=this._attribute;for(ud=0,ub=this._uniformParams.length;ud<ub;ud++)switch((ut=this._uniformParams[ud]).indexOfParams=ud,ut.index=1,ut.value=[ut.location,null],ut.codename=ut.name,null!=this._sceneUniformMap[ut.codename]?(ut.name=this._sceneUniformMap[ut.codename],this._sceneUniformParamsMap.push(ut.name),this._sceneUniformParamsMap.push(ut)):null!=this._cameraUniformMap[ut.codename]?(ut.name=this._cameraUniformMap[ut.codename],this._cameraUniformParamsMap.push(ut.name),this._cameraUniformParamsMap.push(ut)):null!=this._spriteUniformMap[ut.codename]?(ut.name=this._spriteUniformMap[ut.codename],this._spriteUniformParamsMap.push(ut.name),this._spriteUniformParamsMap.push(ut)):null!=this._materialUniformMap[ut.codename]?(ut.name=this._materialUniformMap[ut.codename],this._materialUniformParamsMap.push(ut.name),this._materialUniformParamsMap.push(ut)):null!=this._renderElementUniformMap[ut.codename]?(ut.name=this._renderElementUniformMap[ut.codename],this._renderElementUniformParamsMap.push(ut.name),this._renderElementUniformParamsMap.push(ut)):console.log("Shader:can't find uinform name:"+ut.codename+" in shader file."),ut._this=this,ut.uploadedValue=[],ut.type){case 5124:ut.fun=ut.isArray?this._uniform1iv:this._uniform1i;break;case 5126:ut.fun=ut.isArray?this._uniform1fv:this._uniform1f;break;case 35664:ut.fun=ut.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:ut.fun=ut.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:ut.fun=ut.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:ut.fun=this._uniform_sampler2D;break;case 35680:ut.fun=this._uniform_samplerCube;break;case 35676:ut.fun=this._uniformMatrix4fv;break;case 35670:ut.fun=this._uniform1i;break;case 35674:ut.fun=this._uinformMatrix2fv;break;case 35675:ut.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},uj._attribute=function(uW,uj){var ut=uG.mainContext,ud=uq._enableAtributes,ub=uW.location;return ud[ub]||ut.enableVertexAttribArray(ub),ut.vertexAttribPointer(ub,uj[0],uj[1],uj[2],uj[3],uj[4]),ud[ub]=uq._bindVertexBuffer,1},uj._uniform1f=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj?(uG.mainContext.uniform1f(uW.location,ut[0]=uj),1):0},uj._uniform1fv=function(uW,uj){if(uj.length<4){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]||ut[2]!==uj[2]||ut[3]!==uj[3]?(uG.mainContext.uniform1fv(uW.location,uj),ut[0]=uj[0],ut[1]=uj[1],ut[2]=uj[2],ut[3]=uj[3],1):0}return uG.mainContext.uniform1fv(uW.location,uj),1},uj._uniform_vec2=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]?(uG.mainContext.uniform2f(uW.location,ut[0]=uj[0],ut[1]=uj[1]),1):0},uj._uniform_vec2v=function(uW,uj){if(uj.length<2){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]||ut[2]!==uj[2]||ut[3]!==uj[3]?(uG.mainContext.uniform2fv(uW.location,uj),ut[0]=uj[0],ut[1]=uj[1],ut[2]=uj[2],ut[3]=uj[3],1):0}return uG.mainContext.uniform2fv(uW.location,uj),1},uj._uniform_vec3=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]||ut[2]!==uj[2]?(uG.mainContext.uniform3f(uW.location,ut[0]=uj[0],ut[1]=uj[1],ut[2]=uj[2]),1):0},uj._uniform_vec3v=function(uW,uj){return uG.mainContext.uniform3fv(uW.location,uj),1},uj._uniform_vec4=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]||ut[2]!==uj[2]||ut[3]!==uj[3]?(uG.mainContext.uniform4f(uW.location,ut[0]=uj[0],ut[1]=uj[1],ut[2]=uj[2],ut[3]=uj[3]),1):0},uj._uniform_vec4v=function(uW,uj){return uG.mainContext.uniform4fv(uW.location,uj),1},uj._uniformMatrix2fv=function(uW,uj){return uG.mainContext.uniformMatrix2fv(uW.location,!1,uj),1},uj._uniformMatrix3fv=function(uW,uj){return uG.mainContext.uniformMatrix3fv(uW.location,!1,uj),1},uj._uniformMatrix4fv=function(uW,uj){return uG.mainContext.uniformMatrix4fv(uW.location,!1,uj),1},uj._uinformMatrix2fv=function(uW,uj){return uG.mainContext.uniformMatrix2fv(uW.location,!1,uj),1},uj._uinformMatrix3fv=function(uW,uj){return uG.mainContext.uniformMatrix3fv(uW.location,!1,uj),1},uj._uniform1i=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj?(uG.mainContext.uniform1i(uW.location,ut[0]=uj),1):0},uj._uniform1iv=function(uW,uj){return uG.mainContext.uniform1iv(uW.location,uj),1},uj._uniform_ivec2=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]?(uG.mainContext.uniform2i(uW.location,ut[0]=uj[0],ut[1]=uj[1]),1):0},uj._uniform_ivec2v=function(uW,uj){return uG.mainContext.uniform2iv(uW.location,uj),1},uj._uniform_vec3i=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]||ut[2]!==uj[2]?(uG.mainContext.uniform3i(uW.location,ut[0]=uj[0],ut[1]=uj[1],ut[2]=uj[2]),1):0},uj._uniform_vec3vi=function(uW,uj){return uG.mainContext.uniform3iv(uW.location,uj),1},uj._uniform_vec4i=function(uW,uj){var ut=uW.uploadedValue;return ut[0]!==uj[0]||ut[1]!==uj[1]||ut[2]!==uj[2]||ut[3]!==uj[3]?(uG.mainContext.uniform4i(uW.location,ut[0]=uj[0],ut[1]=uj[1],ut[2]=uj[2],ut[3]=uj[3]),1):0},uj._uniform_vec4vi=function(uW,uj){return uG.mainContext.uniform4iv(uW.location,uj),1},uj._uniform_sampler2D=function(uW,uj){var ut=uj.source||uj.defaulteTexture.source,ud=uG.mainContext,ub=uW.uploadedValue;if(null!=ub[0])return ud.activeTexture(uR._TEXTURES[ub[0]]),ut&&ul.bindTexture(ud,3553,ut),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return ub[0]=this._curActTexIndex,ud.uniform1i(uW.location,this._curActTexIndex),ud.activeTexture(uR._TEXTURES[this._curActTexIndex]),ut&&ul.bindTexture(ud,3553,ut),this._curActTexIndex++,1},uj._uniform_samplerCube=function(uW,uj){var ut=uj.source||uj.defaulteTexture.source,ud=uG.mainContext,ub=uW.uploadedValue;if(null!=ub[0])return ud.activeTexture(uR._TEXTURES[ub[0]]),ut?ul.bindTexture(ud,34067,ut):ul.bindTexture(ud,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return ub[0]=this._curActTexIndex,ud.uniform1i(uW.location,this._curActTexIndex),ud.activeTexture(uR._TEXTURES[this._curActTexIndex]),ut?ul.bindTexture(ud,34067,ut):ul.bindTexture(ud,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},uj._noSetValue=function(uW){console.log("no....:"+uW.name)},uj.bind=function(){return ut.activeShader=this,(ut.bindShader=this).activeResource(),ul.UseProgram(this._program)},uj.uploadAttributes=function(uW,uj){for(var ut,ud,ub=0,uE=0,uO=this._attributeParamsMap.length;uE<uO;uE+=2)ud=this._attributeParamsMap[uE+1],null!=(ut=uW[this._attributeParamsMap[uE]])&&(uj&&uj[ud.name]&&uj[ud.name].bind(),ub+=ud.fun.call(this,ud,ut));uz.shaderCall+=ub},uj.uploadAttributesX=function(uW,uj){for(var ut,ud,ub=0,uE=0,uO=this._attributeParamsMap.length;uE<uO;uE+=2)ud=this._attributeParamsMap[uE+1],null!=(ut=uW[this._attributeParamsMap[uE]])&&(uj._bind(),ub+=ud.fun.call(this,ud,ut));uz.shaderCall+=ub},uj.uploadSceneUniforms=function(uW){for(var uj,ut,ud=0,ub=0,uE=this._sceneUniformParamsMap.length;ub<uE;ub+=2)ut=this._sceneUniformParamsMap[ub+1],null!=(uj=uW[this._sceneUniformParamsMap[ub]])&&(ud+=ut.fun.call(this,ut,uj));uz.shaderCall+=ud},uj.uploadCameraUniforms=function(uW){for(var uj,ut,ud=0,ub=0,uE=this._cameraUniformParamsMap.length;ub<uE;ub+=2)ut=this._cameraUniformParamsMap[ub+1],null!=(uj=uW[this._cameraUniformParamsMap[ub]])&&(ud+=ut.fun.call(this,ut,uj));uz.shaderCall+=ud},uj.uploadSpriteUniforms=function(uW){for(var uj,ut,ud=0,ub=0,uE=this._spriteUniformParamsMap.length;ub<uE;ub+=2)ut=this._spriteUniformParamsMap[ub+1],null!=(uj=uW[this._spriteUniformParamsMap[ub]])&&(ud+=ut.fun.call(this,ut,uj));uz.shaderCall+=ud},uj.uploadMaterialUniforms=function(uW){for(var uj,ut,ud=0,ub=0,uE=this._materialUniformParamsMap.length;ub<uE;ub+=2)ut=this._materialUniformParamsMap[ub+1],null!=(uj=uW[this._materialUniformParamsMap[ub]])&&(ud+=ut.fun.call(this,ut,uj));uz.shaderCall+=ud},uj.uploadRenderElementUniforms=function(uW){for(var uj,ut,ud=0,ub=0,uE=this._renderElementUniformParamsMap.length;ub<uE;ub+=2)ut=this._renderElementUniformParamsMap[ub+1],null!=(uj=uW[this._renderElementUniformParamsMap[ub]])&&(ud+=ut.fun.call(this,ut,uj));uz.shaderCall+=ud},uR.create=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){return new uR(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc)},uR.addInclude=function(uW,uj){uM.addInclude(uW,uj)},uR._createShader=function(uW,uj,ut){var ud=uW.createShader(ut);if(uW.shaderSource(ud,uj),uW.compileShader(ud),uzj.debugMode&&!uW.getShaderParameter(ud,35713))throw uW.getShaderInfoLog(ud);return ud},uR.PERIOD_RENDERELEMENT=0,uR.PERIOD_MATERIAL=1,uR.PERIOD_SPRITE=2,uR.PERIOD_CAMERA=3,uR.PERIOD_SCENE=4,uR._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],uR._count=0,uR._preCompile=!1,uR.extCompileFunc=null,uR.extCompileObj=null,um(uR,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new uC}]),uR}(),uDj=function(uq){function uA(){this._transformUV=null,uA.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new uOj(.6,.6,.6)),this._setColor(10,new uOj(1,1,1)),this._setColor(11,new uqj(1,1,1,8)),this._setColor(12,new uOj(1,1,1)),this._setColor(7,new uqj(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new uqj(1,1,0,0)),this.renderMode=1}uT(uA,"laya.d3.core.material.StandardMaterial",uq);var uW=uA.prototype;return uW.disableLight=function(){this._addDisablePublicShaderDefine(uzj.SHADERDEFINE_POINTLIGHT|uzj.SHADERDEFINE_SPOTLIGHT|uzj.SHADERDEFINE_DIRECTIONLIGHT)},uW.disableFog=function(){this._addDisablePublicShaderDefine(uzj.SHADERDEFINE_FOG)},uW.onAsynLoaded=function(uW,uj,ut){var ud=uj[0];if(ud.version)uq.prototype.onAsynLoaded.call(this,uW,uj,ut);else{var ub=uj[1],uE=ud.props;for(var uO in uE)this[uO]=uE[uO];uA._parseStandardMaterial(ub,this,ud),this._endLoaded()}},uW.cloneTo=function(uW){uq.prototype.cloneTo.call(this,uW);var uj=uW;this._transformUV&&(uj._transformUV=this._transformUV.clone())},u$(0,uW,"ambientColor",function(){return this._getColor(9)},function(uW){this._setColor(9,uW)}),u$(0,uW,"ambientTexture",function(){return this._getTexture(5)},function(uW){uW?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,uW)}),u$(0,uW,"renderMode",null,function(uW){switch(uW){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(uA.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(uW)}),u$(0,uW,"reflectColor",function(){return this._getColor(12)},function(uW){this._setColor(12,uW)}),u$(0,uW,"tilingOffset",function(){return this._getColor(15)},function(uW){if(uW){var uj=uW.elements;1!=uj[0]||1!=uj[1]||0!=uj[2]||0!=uj[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,uW)}),u$(0,uW,"albedo",function(){return this._getColor(7)},function(uW){this._setColor(7,uW)}),u$(0,uW,"diffuseColor",function(){return this._getColor(10)},function(uW){this._setColor(10,uW)}),u$(0,uW,"albedoColor",function(){return this._getColor(7)},function(uW){this._setColor(7,uW)}),u$(0,uW,"specularColor",function(){return this._getColor(11)},function(uW){this._setColor(11,uW)}),u$(0,uW,"diffuseTexture",function(){return this._getTexture(1)},function(uW){uW?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,uW)}),u$(0,uW,"normalTexture",function(){return this._getTexture(2)},function(uW){uW?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,uW)}),u$(0,uW,"specularTexture",function(){return this._getTexture(3)},function(uW){uW?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,uW)}),u$(0,uW,"emissiveTexture",function(){return this._getTexture(4)},function(uW){uW?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,uW)}),u$(0,uW,"reflectTexture",function(){return this._getTexture(6)},function(uW){uW?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,uW)}),u$(0,uW,"transformUV",function(){return this._transformUV},function(uW){this._transformUV=uW,this._setMatrix4x4(13,uW.matrix),uW?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,uW.matrix.elements,0)}),uA.__init__=function(){uA.SHADERDEFINE_DIFFUSEMAP=uA.shaderDefines.registerDefine("DIFFUSEMAP"),uA.SHADERDEFINE_NORMALMAP=uA.shaderDefines.registerDefine("NORMALMAP"),uA.SHADERDEFINE_SPECULARMAP=uA.shaderDefines.registerDefine("SPECULARMAP"),uA.SHADERDEFINE_EMISSIVEMAP=uA.shaderDefines.registerDefine("EMISSIVEMAP"),uA.SHADERDEFINE_AMBIENTMAP=uA.shaderDefines.registerDefine("AMBIENTMAP"),uA.SHADERDEFINE_REFLECTMAP=uA.shaderDefines.registerDefine("REFLECTMAP"),uA.SHADERDEFINE_UVTRANSFORM=uA.shaderDefines.registerDefine("UVTRANSFORM"),uA.SHADERDEFINE_TILINGOFFSET=uA.shaderDefines.registerDefine("TILINGOFFSET"),uA.SHADERDEFINE_ADDTIVEFOG=uA.shaderDefines.registerDefine("ADDTIVEFOG")},uA.load=function(uW){return uX.loader.create(uW,null,null,uA)},uA._parseStandardMaterial=function(uW,uj,ut){var ud=ut.customProps,ub=ud.ambientColor;uj.ambientColor=new uOj(ub[0],ub[1],ub[2]);var uE=ud.diffuseColor;uj.diffuseColor=new uOj(uE[0],uE[1],uE[2]);var uO=ud.specularColor;uj.specularColor=new uqj(uO[0],uO[1],uO[2],uO[3]);var uq=ud.reflectColor;uj.reflectColor=new uOj(uq[0],uq[1],uq[2]);var uA=ud.albedoColor;uA&&(uj.albedo=new uqj(uA[0],uA[1],uA[2],uA[3]));var uc=ud.diffuseTexture.texture2D;uc&&(uj.diffuseTexture=uo.getRes(uW[uc]));var uR=ud.normalTexture.texture2D;uR&&(uj.normalTexture=uo.getRes(uW[uR]));var um=ud.specularTexture.texture2D;um&&(uj.specularTexture=uo.getRes(uW[um]));var uQ=ud.emissiveTexture.texture2D;uQ&&(uj.emissiveTexture=uo.getRes(uW[uQ]));var uT=ud.ambientTexture.texture2D;uT&&(uj.ambientTexture=uo.getRes(uW[uT]));var u$=ud.reflectTexture.texture2D;u$&&(uj.reflectTexture=uo.getRes(uW[u$]))},uA.RENDERMODE_OPAQUE=1,uA.RENDERMODE_OPAQUEDOUBLEFACE=2,uA.RENDERMODE_CUTOUT=3,uA.RENDERMODE_CUTOUTDOUBLEFACE=4,uA.RENDERMODE_TRANSPARENT=13,uA.RENDERMODE_TRANSPARENTDOUBLEFACE=14,uA.RENDERMODE_ADDTIVE=15,uA.RENDERMODE_ADDTIVEDOUBLEFACE=16,uA.RENDERMODE_DEPTHREAD_TRANSPARENT=5,uA.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,uA.RENDERMODE_DEPTHREAD_ADDTIVE=7,uA.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,uA.RENDERMODE_NONDEPTH_TRANSPARENT=9,uA.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,uA.RENDERMODE_NONDEPTH_ADDTIVE=11,uA.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,uA.SHADERDEFINE_DIFFUSEMAP=0,uA.SHADERDEFINE_NORMALMAP=0,uA.SHADERDEFINE_SPECULARMAP=0,uA.SHADERDEFINE_EMISSIVEMAP=0,uA.SHADERDEFINE_AMBIENTMAP=0,uA.SHADERDEFINE_REFLECTMAP=0,uA.SHADERDEFINE_UVTRANSFORM=0,uA.SHADERDEFINE_TILINGOFFSET=0,uA.SHADERDEFINE_ADDTIVEFOG=0,uA.DIFFUSETEXTURE=1,uA.NORMALTEXTURE=2,uA.SPECULARTEXTURE=3,uA.EMISSIVETEXTURE=4,uA.AMBIENTTEXTURE=5,uA.REFLECTTEXTURE=6,uA.ALBEDO=7,uA.UVANIAGE=8,uA.MATERIALAMBIENT=9,uA.MATERIALDIFFUSE=10,uA.MATERIALSPECULAR=11,uA.MATERIALREFLECT=12,uA.UVMATRIX=13,uA.UVAGE=14,uA.TILINGOFFSET=15,um(uA,["defaultMaterial",function(){var uW=new uA;return uW.lock=!0,this.defaultMaterial=uW},"shaderDefines",function(){return this.shaderDefines=new uRj(uxj.shaderDefines)}]),uA}(uxj),usj=function(uW){function uO(uW,uj,ut,ud,ub){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===ut&&(ut=35044),void 0===ud&&(ud=!1),uO.__super.call(this),this._indexType=uW,this._indexCount=uj,this._bufferUsage=ut,this._bufferType=34963,this._canRead=ud;var uE;if("ushort"==uW)this._indexTypeByteCount=2;else{if("ubyte"!=uW)throw new Error("unidentification index type.");this._indexTypeByteCount=1}uE=this._indexTypeByteCount*uj,this._byteLength=uE,this._bind(),uq._gl.bufferData(this._bufferType,uE,this._bufferUsage),this.uri=ub,ud?("ushort"==uW?this._buffer=new Uint16Array(uj):"ubyte"==uW&&(this._buffer=new Uint8Array(uj)),this.memorySize=2*uE):this.memorySize=uE}uT(uO,"laya.d3.graphics.IndexBuffer3D",uW);var uj=uO.prototype;return uj.setData=function(uW,uj,ut,ud){void 0===uj&&(uj=0),void 0===ut&&(ut=0),void 0===ud&&(ud=4294967295);var ub=0;if("ushort"==this._indexType?(ub=2,0===ut&&4294967295===ud||(uW=new Uint16Array(uW.buffer,ut*ub,ud))):"ubyte"==this._indexType&&(ub=1,0===ut&&4294967295===ud||(uW=new Uint8Array(uW.buffer,ut*ub,ud))),this._bind(),uq._gl.bufferSubData(this._bufferType,uj*ub,uW),this._canRead)if(0!==uj||0!==ut||4294967295!==ud){var uE=this._buffer.length-uj;uE<ud&&(ud=uE);for(var uO=0;uO<ud;uO++)this._buffer[uj+uO]=uW[uO]}else this._buffer=uW},uj.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},uj.disposeResource=function(){uW.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},u$(0,uj,"indexType",function(){return this._indexType}),u$(0,uj,"indexTypeByteCount",function(){return this._indexTypeByteCount}),u$(0,uj,"indexCount",function(){return this._indexCount}),u$(0,uj,"canRead",function(){return this._canRead}),uO.INDEXTYPE_UBYTE="ubyte",uO.INDEXTYPE_USHORT="ushort",uO.create=function(uW,uj,ut,ud,ub){return void 0===ut&&(ut=35044),void 0===ud&&(ud=!1),new uO(uW,uj,ut,ud,ub)},uO}(uq),uYj=function(uE){function uO(uW,uj,ut,ud,ub){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===ud&&(ud=!1),uO.__super.call(this),this._vertexDeclaration=uW,this._vertexCount=uj,this._bufferUsage=ut,this._bufferType=34962,this._canRead=ud,this.uri=ub,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*uj,this._bind(),uq._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),ud&&(this._buffer=new Float32Array(this._byteLength/4))}uT(uO,"laya.d3.graphics.VertexBuffer3D",uE);var uW=uO.prototype;return uW.bindWithIndexBuffer=function(uW){uW&&uW._bind(),this._bind()},uW.setData=function(uW,uj,ut,ud){if(void 0===uj&&(uj=0),void 0===ut&&(ut=0),void 0===ud&&(ud=4294967295),0===ut&&4294967295===ud||(uW=new Float32Array(uW.buffer,4*ut,ud)),this._bind(),uq._gl.bufferSubData(this._bufferType,4*uj,uW),this._canRead)if(0!==uj||0!==ut||4294967295!==ud){var ub=this._buffer.length-uj;ub<ud&&(ud=ub);for(var uE=0;uE<ud;uE++)this._buffer[uj+uE]=uW[uE]}else this._buffer=uW},uW.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},uW.disposeResource=function(){for(var uW=uG.mainContext,uj=this._vertexDeclaration.getVertexElements(),ut=uq._enableAtributes,ud=0,ub=uj.length;ud<ub;ud++)ut[ud]===this._glBuffer&&(uW.disableVertexAttribArray(ud),ut[ud]=null);uE.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},u$(0,uW,"vertexDeclaration",function(){return this._vertexDeclaration}),u$(0,uW,"vertexCount",function(){return this._vertexCount}),u$(0,uW,"canRead",function(){return this._canRead}),uO.create=function(uW,uj,ut,ud,ub){return void 0===ut&&(ut=35044),void 0===ud&&(ud=!1),new uO(uW,uj,ut,ud,ub)},uO}(uq),uHj=function(uW){function uM(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,uM.__super.call(this),this._type=3553}uT(uM,"laya.d3.resource.DataTexture2D",uGj);var uj=uM.prototype;return uj.genDebugMipmaps=function(){var uW=[];return uW.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),uW.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),uW.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),uW.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),uW.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),uW.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),uW.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),uW.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),uW.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),uW.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),uW},uj._onTextureLoaded=function(uW){},uj._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var uW=uG.mainContext,uj=this._source=uW.createTexture(),ut=this._width,ud=this._height,ub=ul.curBindTexTarget,uE=ul.curBindTexValue,uO=!1;if(ul.bindTexture(uW,this._type,uj),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var uq=0;uW.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var uA=0;uA<this._mipmaps.length;uA++){if(this._mipmaps[uA].byteLength!=uc*uR*4)throw"mipmap size error  level:"+uA;uW.texSubImage2D(this._type,0,uM.simLodRect[uq++],uM.simLodRect[uq++],uM.simLodRect[uq++],uM.simLodRect[uq++],6408,5121,new Uint8Array(this._mipmaps[uA]))}this.minFifter=9729,this.magFifter=9729}else{var uc=this._width,uR=this._height;for(uq=0,uW.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),uA=0;uA<this._mipmaps.length;uA++){if(this._mipmaps[uA].byteLength!=uc*uR*4)throw"mipmap size error  level:"+uA;uW.texImage2D(this._type,uA,6408,uc,uR,0,6408,5121,new Uint8Array(this._mipmaps[uA])),(uc/=2)<1&&(uc=1),(uR/=2)<1&&(uR=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&uW.pixelStorei(uW.UNPACK_ALIGNMENT,1),uW.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var um=0,uQ=!1,uT=!1;this._buffer.byteLength==4*ut*ud?(um=6408,uQ=!0):this._buffer.byteLength==3*ut*ud?(um=6407,uT=!0):um=this._format,uQ||uT?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),uT&&uW.pixelStorei(uW.UNPACK_ALIGNMENT,1),uW.texImage2D(this._type,0,um,ut,ud,0,um,5121,this._buffer)):uW&&um==uW.ALPHA?(uW.texImage2D(3553,0,um,ut,ud,0,um,uW.UNSIGNED_BYTE,this._buffer),uO=!0):0!=um&&(uW.compressedTexImage2D(3553,0,um,ut,ud,0,this._buffer),uO=!0)}var u$=this._minFifter,ue=this._magFifter,uK=0==this._wrapModeU?10497:33071,uo=0==this._wrapModeV?10497:33071,uS=uZ.isPOT(ut,ud);uS?(this._mipmap||this._mipmaps?-1!==u$||(u$=9987):-1!==u$||(u$=9729),-1!==ue||(ue=9729),uW.texParameteri(this._type,10241,u$),uW.texParameteri(this._type,10240,ue),uW.texParameteri(this._type,10242,uK),uW.texParameteri(this._type,10243,uo),this._mipmap&&uW.generateMipmap(this._type)):(-1!==u$||(u$=9729),-1!==ue||(ue=9729),uW.texParameteri(this._type,10241,u$),uW.texParameteri(this._type,10240,ue),uW.texParameteri(this._type,10242,33071),uW.texParameteri(this._type,10243,33071)),ub&&uE&&ul.bindTexture(uW,ub,uE),this.memorySize=uO?this._buffer.length:uS?ut*ud*4*(1+1/3):ut*ud*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},uj.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},uj.onAsynLoaded=function(uW,uj,ut){var ud;ut&&(ud=ut[0].call(this,uj)),ud&&(this._width=ud.width,this._height=ud.height,this._buffer=ud.data),this._src=uW,this._size=new uej(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},uj.getPixels=function(){return new Uint8Array(this._buffer)},uj.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(uG.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},u$(0,uj,"src",function(){return this._src}),uM.create=function(uW,uj,ut,ud,ub,uE,uO){if(void 0===ud&&(ud=9729),void 0===ub&&(ub=9729),void 0===uE&&(uE=!0),!uW||uW.byteLength<uj*ut*4)throw"DataTexture2D create error";var uq=new uM;return uq.uri=uO,uq._buffer=uW,uq._width=uj,uq._height=ut,uq._mipmap=uE,uq._magFifter=ud,uq._minFifter=ub,uq._size=new uej(uq._width,uq._height),uq._conchTexture?alert("怎么给runtime传递datatexture数据"):uq.activeResource(),uq},uM.load=function(uW,uj,ut,ud,ub){if(void 0===uj&&(uj=0),void 0===ut&&(ut=0),void 0===ud&&(ud=9729),void 0===ub&&(ub=9729),"mipmaps"===uL.getFileExtension(uW)){var uE=uX.loader.create(uW,null,null,uM,[function(uW){this._mipmaps=[];var uj=new Uint32Array(uW);this._width=uj[0];var ut=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,ut=1024),this._width!=ut)throw"现在只支持512x256的环境贴图。当前的是"+uj[0];this._height=uj[1];for(var ud=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,ub=this._height,uE=8;;){var uO=ud*ub*4;if(uE+uO>uW.byteLength)throw"load mipmaps data size error ";var uq=new Uint8Array(uW,uE,uO);if(this._mipmaps.push(uq),uE+=uO,1==ud&&1==ub)break;(ud/=2)<1&&(ud=1),(ub/=2)<1&&(ub=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){uE.simLodInfo=new Float32Array(40);for(var uO=0;uO<uE.simLodInfo.length;)uE.simLodInfo[uO]=(uM.simLodRect[uO]+.5)/1024,uO++,uE.simLodInfo[uO]=(uM.simLodRect[uO]+.5)/256,uO++,uE.simLodInfo[uO]=Math.max(uM.simLodRect[uO]-1,.1)/1024,uO++,uE.simLodInfo[uO]=Math.max(uM.simLodRect[uO]-1.5,.1)/256,uO++}return uE}if("number"==typeof uj)return uX.loader.create(uW,null,null,uM,[function(uW){return this._width=uj,this._height=ut,this._buffer=uW,null}]);if("function"==typeof uj)return uX.loader.create(uW,null,null,uM,[uj]);throw new Error("unknown params.")},uM.lodasatlas=!1,um(uM,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),uM}(),uIj=function(uW){function uj(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,uj.__super.call(this)}uT(uj,"laya.d3.resource.models.PrimitiveMesh",ulj);var ut=uj.prototype;return uX.imps(ut,{"laya.d3.core.render.IRenderable":!0}),ut._getVertexBuffer=function(uW){return void 0===uW&&(uW=0),0===uW?this._vertexBuffer:null},ut._getVertexBuffers=function(){return null},ut._getIndexBuffer=function(){return this._indexBuffer},ut._getPositions=function(){var uW,uj=[],ut=this._vertexBuffer.vertexDeclaration.getVertexElements(),ud=0;for(ud=0;ud<ut.length;ud++){var ub=ut[ud];if("vector3"===ub.elementFormat&&0===ub.elementUsage){uW=ub;break}}var uE=this._vertexBuffer.getData();for(ud=0;ud<uE.length;ud+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var uO=ud+uW.offset/4,uq=new uOj(uE[uO+0],uE[uO+1],uE[uO+2]);uj.push(uq)}return uj},ut.getRenderElement=function(uW){return this},ut.getRenderElementsCount=function(){return 1},ut.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},ut._beforeRender=function(uW){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},ut._render=function(uW){uG.mainContext.drawElements(4,this._numberIndices,5123,0),uz.drawCall++,uz.trianglesFaces+=this._numberIndices/3},u$(0,ut,"_vertexBufferCount",function(){return 1}),u$(0,ut,"triangleCount",function(){return this._indexBuffer.indexCount/3}),uj}(),ugj=function(uW){function uj(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,uj.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}uT(uj,"laya.d3.resource.models.Mesh",ulj);var ut=uj.prototype;return ut._getPositions=function(){var uW,uj,ut,ud,ub,uE=[],uO=0,uq=0,uA=0;if(0!==this._vertexBuffers.length){var uc=this._vertexBuffers.length;for(uO=0;uO<uc;uO++){for(ut=(uW=this._vertexBuffers[uO]).vertexDeclaration.getVertexElements(),uq=0;uq<ut.length;uq++)if("vector3"===(ud=ut[uq]).elementFormat&&0===ud.elementUsage){uj=ud;break}for(ub=uW.getData(),uq=0;uq<ub.length;uq+=uW.vertexDeclaration.vertexStride/4)uA=uq+uj.offset/4,uE.push(new uOj(ub[uA+0],ub[uA+1],ub[uA+2]))}}else{var uR=this._subMeshes.length;for(uO=0;uO<uR;uO++){for(ut=(uW=this._subMeshes[uO]._getVertexBuffer()).vertexDeclaration.getVertexElements(),uq=0;uq<ut.length;uq++)if("vector3"===(ud=ut[uq]).elementFormat&&0===ud.elementUsage){uj=ud;break}for(ub=uW.getData(),uq=0;uq<ub.length;uq+=uW.vertexDeclaration.vertexStride/4)uA=uq+uj.offset/4,uE.push(new uOj(ub[uA+0],ub[uA+1],ub[uA+2]))}}return uE},ut._setSubMeshes=function(uW){this._subMeshes=uW,this._subMeshCount=uW.length;for(var uj=0;uj<this._subMeshCount;uj++)uW[uj]._indexInMesh=uj;this._positions=this._getPositions(),this._generateBoundingObject()},ut.onAsynLoaded=function(uW,uj,ut){var ud=uj[0],ub=uj[1];uiW.read(ud,this,this._materials,this._subMeshes,ub),this.completeCreate(),this._endLoaded()},ut.getSubMesh=function(uW){return this._subMeshes[uW]},ut.getSubMeshCount=function(){return this._subMeshes.length},ut.getRenderElementsCount=function(){return this._subMeshes.length},ut.getRenderElement=function(uW){return this._subMeshes[uW]},ut.disposeResource=function(){for(var uW=0;uW<this._subMeshes.length;uW++)this._subMeshes[uW].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},u$(0,ut,"materials",function(){return this._materials.slice()}),u$(0,ut,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),uj.load=function(uW){return uX.loader.create(uW,null,null,uj)},uj}(),ufj=(function(uW){function uc(uW,uj,ut,ud,ub,uE,uO,uq,uA){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===ut&&(ut=6408),void 0===ud&&(ud=5121),void 0===ub&&(ub=33189),void 0===uE&&(uE=!1),void 0===uO&&(uO=!1),void 0===uq&&(uq=-1),void 0===uA&&(uA=-1),uc.__super.call(this),this._type=3553,this._width=uW,this._height=uj,this._size=new uej(uW,uj),this._surfaceFormat=ut,this._surfaceType=ud,this._depthStencilFormat=ub,ue.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=uE,this._repeat=uO,this._minFifter=uq,this._magFifter=uA,this.activeResource(),this._alreadyResolved=!0}uT(uc,"laya.d3.resource.RenderTexture",uGj);var uj=uc.prototype;uj.recreateResource=function(){var uW=uG.mainContext;this._frameBuffer=uW.createFramebuffer(),this._source=uW.createTexture();var uj=ul.curBindTexTarget,ut=ul.curBindTexValue;ul.bindTexture(uW,this._type,this._source),uW.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var ud=this._minFifter,ub=this._magFifter,uE=this._repeat?10497:33071;if(uZ.isPOT(this._width,this._height)?(this._mipmap?-1!==ud||(ud=9987):-1!==ud||(ud=9729),-1!==ub||(ub=9729),uW.texParameteri(this._type,10241,ud),uW.texParameteri(this._type,10240,ub),uW.texParameteri(this._type,10242,uE),uW.texParameteri(this._type,10243,uE),this._mipmap&&uW.generateMipmap(this._type)):(-1!==ud||(ud=9729),-1!==ub||(ub=9729),uW.texParameteri(this._type,10241,ud),uW.texParameteri(this._type,10240,ub),uW.texParameteri(this._type,10242,33071),uW.texParameteri(this._type,10243,33071)),uj&&ut&&ul.bindTexture(uW,uj,ut),uW.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=uW.createRenderbuffer(),uW.bindRenderbuffer(36161,this._depthStencilBuffer),uW.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),uW.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:uW.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:uW.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:uW.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}uW.framebufferTexture2D(36160,36064,3553,this._source,0),uW.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},uj.start=function(){uG.mainContext.bindFramebuffer(36160,this.frameBuffer),(uc._currentRenderTarget=this)._alreadyResolved=!1},uj.end=function(){uG.mainContext.bindFramebuffer(36160,null),uc._currentRenderTarget=null,this._alreadyResolved=!0},uj.getData=function(uW,uj,ut,ud){var ub=uG.mainContext;if(ub.bindFramebuffer(36160,this._frameBuffer),!(36053===ub.checkFramebufferStatus(36160)))return ub.bindFramebuffer(36160,null),null;var uE=new Uint8Array(this._width*this._height*4);return ub.readPixels(uW,uj,ut,ud,this._surfaceFormat,this._surfaceType,uE),ub.bindFramebuffer(36160,null),uE},uj.disposeResource=function(){if(this._frameBuffer){var uW=uG.mainContext;uW.deleteTexture(this._source),uW.deleteFramebuffer(this._frameBuffer),uW.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},u$(0,uj,"surfaceFormat",function(){return this._surfaceFormat}),u$(0,uj,"surfaceType",function(){return this._surfaceType}),u$(0,uj,"depthStencilFormat",function(){return this._depthStencilFormat}),u$(0,uj,"source",function(){return this._alreadyResolved?uX.superGet(uGj,this,"source"):null}),u$(0,uj,"depthStencilBuffer",function(){return this._depthStencilBuffer}),u$(0,uj,"frameBuffer",function(){return this._frameBuffer}),uc._currentRenderTarget=null}(),function(uW){function uj(uW){this._color=null,this._pixels=null,uj.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new uej(this.width,this.height),this._color=uW,this._pixels=new Uint8Array([255*uW.x,255*uW.y,255*uW.z,255*uW.w]),this.uri="SolidColorTexture2D_"+this.id}uT(uj,"laya.d3.resource.SolidColorTexture2D",uGj);var ut=uj.prototype;return ut._createWebGlTexture=function(){var uW=uG.mainContext,uj=this._source=uW.createTexture(),ut=this._width,ud=this._height,ub=ul.curBindTexTarget,uE=ul.curBindTexValue;ul.bindTexture(uW,this._type,uj),uW.texImage2D(this._type,0,6408,ut,ud,0,6408,5121,this._pixels);var uO=this._minFifter,uq=this._magFifter,uA=this._repeat?10497:33071,uc=uZ.isPOT(ut,ud);uc?(this._mipmap?-1!==uO||(uO=9987):-1!==uO||(uO=9729),-1!==uq||(uq=9729),uW.texParameteri(this._type,10241,uO),uW.texParameteri(this._type,10240,uq),uW.texParameteri(this._type,10242,uA),uW.texParameteri(this._type,10243,uA),this._mipmap&&uW.generateMipmap(this._type)):(-1!==uO||(uO=9729),-1!==uq||(uq=9729),uW.texParameteri(this._type,10241,uO),uW.texParameteri(this._type,10240,uq),uW.texParameteri(this._type,10242,33071),uW.texParameteri(this._type,10243,33071)),ub&&uE&&ul.bindTexture(uW,ub,uE),this.memorySize=uc?ut*ud*4*(1+1/3):ut*ud*4},ut.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},ut.disposeResource=function(){this._source&&(uG.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},um(uj,["magentaTexture",function(){var uW=new uj(new uqj(1,0,1,1));return uW.lock=!0,this.magentaTexture=uW},"grayTexture",function(){var uW=new uj(new uqj(.5,.5,.5,1));return uW.lock=!0,this.grayTexture=uW}]),uj}()),uwj=function(uW){function ub(uW,uj,ut,ud){this._canRead=!1,this._image=null,this._pixels=null,void 0===uW&&(uW=!1),void 0===uj&&(uj=!0),void 0===ut&&(ut=6408),void 0===ud&&(ud=!0),ub.__super.call(this),this._type=3553,this._repeat=uj,this._canRead=uW,this._format=ut,this._mipmap=ud}uT(ub,"laya.d3.resource.Texture2D",uGj);var uj=ub.prototype;return uj._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var uW=uG.mainContext,uj=this._source=uW.createTexture(),ut=this._width,ud=this._height,ub=ul.curBindTexTarget,uE=ul.curBindTexValue;switch(ul.bindTexture(uW,this._type,uj),this._format){case 6407:case 6408:this._canRead?uW.texImage2D(this._type,0,this._format,ut,ud,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?uW.texImage2D(this._type,0,this._image._format,ut,ud,0,this._image._format,5121,this._image.atlasSource):uW.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case uG.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:uW.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var uO=this._minFifter,uq=this._magFifter,uA=this._repeat?10497:33071,uc=0==this._wrapModeU?10497:33071,uR=0==this._wrapModeV?10497:33071,um=uZ.isPOT(ut,ud);um?(this._mipmap?-1!==uO||(uO=9987):-1!==uO||(uO=9729),-1!==uq||(uq=9729),uW.texParameteri(this._type,10241,uO),uW.texParameteri(this._type,10240,uq),uW.texParameteri(this._type,10242,uA),uW.texParameteri(this._type,10243,uA),uW.texParameteri(this._type,10242,uc),uW.texParameteri(this._type,10243,uR),this._mipmap&&uW.generateMipmap(this._type)):(-1!==uO||(uO=9729),-1!==uq||(uq=9729),uW.texParameteri(this._type,10241,uO),uW.texParameteri(this._type,10240,uq),uW.texParameteri(this._type,10242,33071),uW.texParameteri(this._type,10243,33071)),ub&&uE&&ul.bindTexture(uW,ub,uE),this._image.onload=null,this._image=null,this.memorySize=um?ut*ud*4*(1+1/3):ut*ud*4},uj.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},uj.onAsynLoaded=function(uW,uj,ut){if(ut){var ud=ut[0];void 0!==ud&&(this._canRead=ud);var ub=ut[1];void 0!==ub&&(this._repeat=ub);var uE=ut[2];void 0!==uE&&(this._format=uE);var uO=ut[3];void 0!==uO&&(this._mipmap=uO);var uq=ut.wrapModeU;void 0!==uq&&(this._wrapModeU=uq);var uA=ut.wrapModeV;void 0!==uA&&(this._wrapModeV=uA)}switch(this._format){case 6407:case 6408:var uc=(this._image=uj).width,uR=uj.height;this._width=uc,this._height=uR,this._size=new uej(uc,uR),this._canRead&&(ue.isConchApp?uj instanceof uQ.HTMLElement&&(this._pixels=new Uint8Array(uj.getImageData(0,0,uc,uR))):(uh.canvas.size(uc,uR),uh.canvas.clear(),uh.context.drawImage(uj,0,0,uc,uR),this._pixels=new Uint8Array(uh.context.getImageData(0,0,uc,uR).data.buffer)));break;case uG.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var um=new u_(uj);um.readUTFBytes(4),um.readUTFBytes(2),um.getInt16();um.endian="bigEndian",this._width=um.getInt16(),this._height=um.getInt16(),this._size=new uej(this._width,this._height);um.getInt16(),um.getInt16();this._image=new Uint8Array(uj,um.pos)}this.recreateResource(),this._endLoaded()},uj.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},uj.disposeResource=function(){this._source&&(uG.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},u$(0,uj,"_src",function(){return this.url}),u$(0,uj,"src",function(){return this.url}),ub.load=function(uW){return uX.loader.create(uW,null,null,ub)},ub}(),uUj=function(uj){function ut(uW,uj){ut.__super.call(this),void 0===uW&&(uW=.3),void 0===uj&&(uj=1e3),this._tempVector3=new uOj,this._position=new uOj,this._up=new uOj,this._forward=new uOj,this._right=new uOj,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=uej.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=uW,this._farPlane=uj,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),uX.stage.on("resize",this,this._onScreenSizeChanged)}uT(ut,"laya.d3.core.BaseCamera",uj);var uW=ut.prototype;return uW._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var uW=this.scene._cameraPool,uj=uW.length-1,ut=0;ut<uj;ut++)if(uW[ut].renderingOrder>uW[uj].renderingOrder){var ud=uW[ut];uW[ut]=uW[uj],uW[uj]=ud}},uW._calculateProjectionMatrix=function(){},uW._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},uW._prepareCameraToRender=function(){uv._currentCameraCullingMask=this.cullingMask;var uW=this._shaderValues;uW.setValue(0,this.transform.position.elements),uW.setValue(5,this.forward.elements),uW.setValue(6,this.up.elements)},uW._prepareCameraViewProject=function(uW,uj){var ut=this._shaderValues;ut.setValue(1,uW.elements),ut.setValue(2,uj.elements)},uW._renderCamera=function(uW,uj,ut){},uW.addLayer=function(uW){29!==uW.number&&30!=uW.number&&(this.cullingMask=this.cullingMask|uW.mask)},uW.removeLayer=function(uW){29!==uW.number&&30!=uW.number&&(this.cullingMask=this.cullingMask&~uW.mask)},uW.addAllLayers=function(){this.cullingMask=2147483647},uW.removeAllLayers=function(){this.cullingMask=0|uv.getLayerByNumber(29).mask|uv.getLayerByNumber(30).mask},uW.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},uW.moveForward=function(uW){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=uW,this.transform.translate(this._tempVector3)},uW.moveRight=function(uW){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=uW,this.transform.translate(this._tempVector3)},uW.moveVertical=function(uW){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=uW,this.transform.translate(this._tempVector3,!1)},uW._addSelfRenderObjects=function(){var uW=this.scene._cameraPool,uj=uW.length;if(0<uj){for(var ut=uj-1;0<=ut;ut--)if(this.renderingOrder<=uW[ut].renderingOrder){uW.splice(ut+1,0,this);break}}else uW.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},uW._clearSelfRenderObjects=function(){var uW=this.scene._cameraPool;uW.splice(uW.indexOf(this),1)},uW.destroy=function(uW){void 0===uW&&(uW=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,uX.stage.off("resize",this,this._onScreenSizeChanged),uj.prototype.destroy.call(this,uW)},u$(0,uW,"sky",function(){return this._sky},function(uW){(this._sky=uW)._ownerCamera=this}),u$(0,uW,"forward",function(){var uW=this.transform.worldMatrix.elements,uj=this._forward.elements;return uj[0]=-uW[8],uj[1]=-uW[9],uj[2]=-uW[10],this._forward}),u$(0,uW,"position",function(){var uW=this.transform.worldMatrix.elements,uj=this._position.elements;return uj[0]=uW[12],uj[1]=uW[13],uj[2]=uW[14],this._position}),u$(0,uW,"renderTarget",function(){return this._renderTarget},function(uW){null!=(this._renderTarget=uW)&&(this._renderTargetSize=uW.size)}),u$(0,uW,"up",function(){var uW=this.transform.worldMatrix.elements,uj=this._up.elements;return uj[0]=uW[4],uj[1]=uW[5],uj[2]=uW[6],this._up}),u$(0,uW,"right",function(){var uW=this.transform.worldMatrix.elements,uj=this._right.elements;return uj[0]=uW[0],uj[1]=uW[1],uj[2]=uW[2],this._right}),u$(0,uW,"renderTargetSize",function(){return this._renderTargetSize},function(uW){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=uW,this._calculateProjectionMatrix()}),u$(0,uW,"fieldOfView",function(){return this._fieldOfView},function(uW){this._fieldOfView=uW,this._calculateProjectionMatrix()}),u$(0,uW,"nearPlane",function(){return this._nearPlane},function(uW){this._nearPlane=uW,this._calculateProjectionMatrix()}),u$(0,uW,"farPlane",function(){return this._farPlane},function(uW){this._farPlane=uW,this._calculateProjectionMatrix()}),u$(0,uW,"orthographic",function(){return this._orthographic},function(uW){this._orthographic=uW,this._calculateProjectionMatrix()}),u$(0,uW,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(uW){this._orthographicVerticalSize=uW,this._calculateProjectionMatrix()}),u$(0,uW,"renderingOrder",function(){return this._renderingOrder},function(uW){this._renderingOrder=uW,this._sortCamerasByRenderingOrder()}),ut.CAMERAPOS=0,ut.VIEWMATRIX=1,ut.PROJECTMATRIX=2,ut.VPMATRIX=3,ut.VPMATRIX_NO_TRANSLATE=4,ut.CAMERADIRECTION=5,ut.CAMERAUP=6,ut.ENVIRONMENTDIFFUSE=7,ut.ENVIRONMENTSPECULAR=8,ut.SIMLODINFO=9,ut.DIFFUSEIRRADMATR=10,ut.DIFFUSEIRRADMATG=11,ut.DIFFUSEIRRADMATB=12,ut.HDREXPOSURE=13,ut.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",ut.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",ut.CLEARFLAG_SOLIDCOLOR=0,ut.CLEARFLAG_SKY=1,ut.CLEARFLAG_DEPTHONLY=2,ut.CLEARFLAG_NONE=3,um(ut,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new uWj(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new uWj},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new uWj}]),ut}(uaj),uJj=function(ut){function uj(uW){this._render=null,this._geometryFilter=null,uj.__super.call(this,uW)}uT(uj,"laya.d3.core.RenderableSprite3D",ut);var uW=uj.prototype;return uW._addToInitStaticBatchManager=function(){},uW._setBelongScene=function(uW){ut.prototype._setBelongScene.call(this,uW),uW._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},uW._setUnBelongScene=function(){var uW=this._scene._renderableSprite3Ds,uj=uW.indexOf(this);uW.splice(uj,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),ut.prototype._setUnBelongScene.call(this)},uW._update=function(uW){(uW.owner=this)._activeInHierarchy&&(this._updateComponents(uW),this._render._updateOctreeNode(),this._lateUpdateComponents(uW),uz.spriteCount++,this._childs.length&&this._updateChilds(uW))},uW.destroy=function(uW){void 0===uW&&(uW=!0),ut.prototype.destroy.call(this,uW),this._render._destroy(),this._render=null},uj.__init__=function(){uj.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=uj.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),uj.SAHDERDEFINE_LIGHTMAP=uj.shaderDefines.registerDefine("LIGHTMAP")},uj.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,uj.SAHDERDEFINE_LIGHTMAP=4,uj.LIGHTMAPSCALEOFFSET=2,uj.LIGHTMAP=3,um(uj,["shaderDefines",function(){return this.shaderDefines=new uRj}]),uj}(uaj),urj=(function(uW){function ud(uW,uj,ut){this._long=NaN,this._width=NaN,this._height=NaN,void 0===uW&&(uW=1),void 0===uj&&(uj=1),void 0===ut&&(ut=1),ud.__super.call(this),this._long=uW,this._width=uj,this._height=ut,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}uT(ud,"laya.d3.resource.models.BoxMesh",uIj);var uj=ud.prototype;uj.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var uW=uGW.vertexDeclaration,uj=(uW.vertexStride,this._long/2),ut=this._height/2,ud=this._width/2,ub=new Float32Array([-uj,ut,-ud,0,1,0,0,0,uj,ut,-ud,0,1,0,1,0,uj,ut,ud,0,1,0,1,1,-uj,ut,ud,0,1,0,0,1,-uj,-ut,-ud,0,-1,0,0,1,uj,-ut,-ud,0,-1,0,1,1,uj,-ut,ud,0,-1,0,1,0,-uj,-ut,ud,0,-1,0,0,0,-uj,ut,-ud,-1,0,0,0,0,-uj,ut,ud,-1,0,0,1,0,-uj,-ut,ud,-1,0,0,1,1,-uj,-ut,-ud,-1,0,0,0,1,uj,ut,-ud,1,0,0,1,0,uj,ut,ud,1,0,0,0,0,uj,-ut,ud,1,0,0,0,1,uj,-ut,-ud,1,0,0,1,1,-uj,ut,ud,0,0,1,0,0,uj,ut,ud,0,0,1,1,0,uj,-ut,ud,0,0,1,1,1,-uj,-ut,ud,0,0,1,0,1,-uj,ut,-ud,0,0,-1,1,0,uj,ut,-ud,0,0,-1,0,0,uj,-ut,-ud,0,0,-1,0,1,-uj,-ut,-ud,0,0,-1,1,1]),uE=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new uYj(uW,this._numberVertices,35044,!0),this._indexBuffer=new usj("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(ub),this._indexBuffer.setData(uE),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},u$(0,uj,"long",function(){return this._long},function(uW){this._long!==uW&&(this._long=uW,this.releaseResource(),this.activeResource())}),u$(0,uj,"width",function(){return this._width},function(uW){this._width!==uW&&(this._width=uW,this.releaseResource(),this.activeResource())}),u$(0,uj,"height",function(){return this._height},function(uW){this._height!==uW&&(this._height=uW,this.releaseResource(),this.activeResource())})}(),function(uW){function uO(uW,uj,ut){void 0===uW&&(uW=0),void 0===uj&&(uj=.3),void 0===ut&&(ut=1e3),this._viewMatrix=new uWj,this._projectionMatrix=new uWj,this._projectionViewMatrix=new uWj,this._viewport=new uAj(0,0,0,0),this._normalizedViewport=new uAj(0,0,1,1),this._aspectRatio=uW,this._boundFrustumUpdate=!0,this._boundFrustum=new unW(uWj.DEFAULT),uO.__super.call(this,uj,ut),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}uT(uO,"laya.d3.core.Camera",uUj);var uj=uO.prototype;return uj._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},uj._parseCustomProps=function(uW,uj,ut,ud){var ub=ut.clearColor;this.clearColor=new uqj(ub[0],ub[1],ub[2],ub[3]);var uE=ut.viewport;this.normalizedViewport=new uAj(uE[0],uE[1],uE[2],uE[3])},uj._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var uW=this.orthographicVerticalSize*this.aspectRatio*.5,uj=.5*this.orthographicVerticalSize;uWj.createOrthoOffCenterRH(-uW,uW,-uj,uj,this.nearPlane,this.farPlane,this._projectionMatrix)}else uWj.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},uj._update=function(uW){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,uW)},uj._renderCamera=function(uW,uj,ut){var ud,ub;ut.parallelSplitShadowMaps[0]&&ut._renderShadowMap(uW,uj,this),(uj.camera=this)._prepareCameraToRender(),ut._preRenderUpdateComponents(uj),ud=uj._viewMatrix=this.viewMatrix;var uE=this._renderTarget;uE?(uE.start(),uWj.multiply(uUj._invertYScaleMatrix,this._projectionMatrix,uUj._invertYProjectionMatrix),uWj.multiply(uUj._invertYScaleMatrix,this.projectionViewMatrix,uUj._invertYProjectionViewMatrix),ub=uj._projectionMatrix=uUj._invertYProjectionMatrix,uj._projectionViewMatrix=uUj._invertYProjectionViewMatrix):(ub=uj._projectionMatrix=this._projectionMatrix,uj._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(ud,ub),uj._viewport=this.viewport,ut._preRenderScene(uW,uj,this.boundFrustum),ut._clear(uW,uj),ut._renderScene(uW,uj),ut._postRenderUpdateComponents(uj),uE&&uE.end()},uj.viewportPointToRay=function(uW,uj){u$j.calculateCursorRay(uW,this.viewport,this._projectionMatrix,this.viewMatrix,null,uj)},uj.normalizedViewportPointToRay=function(uW,uj){var ut=uO._tempVector20,ud=this.viewport,ub=uW.elements,uE=ut.elements;uE[0]=ub[0]*ud.width,uE[1]=ub[1]*ud.height,u$j.calculateCursorRay(ut,this.viewport,this._projectionMatrix,this.viewMatrix,null,uj)},uj.worldToViewportPoint=function(uW,uj){uWj.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(uW,this._projectionViewMatrix,uj);var ut=uj.elements;ut[0]=ut[0]/uX.stage.clientScaleX,ut[1]=ut[1]/uX.stage.clientScaleY},uj.worldToNormalizedViewportPoint=function(uW,uj){uWj.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(uW,this._projectionViewMatrix,uj);var ut=uj.elements;ut[0]=ut[0]/uX.stage.clientScaleX,ut[1]=ut[1]/uX.stage.clientScaleY},uj.convertScreenCoordToOrthographicCoord=function(uW,uj){if(this._orthographic){var ut=ui.clientWidth,ud=ui.clientHeight,ub=this.orthographicVerticalSize*this.aspectRatio/ut,uE=this.orthographicVerticalSize/ud,uO=uW.elements,uq=uj.elements;return uq[0]=(-ut/2+uO[0])*ub,uq[1]=(ud/2-uO[1])*uE,uq[2]=(this.nearPlane-this.farPlane)*(uO[2]+1)/2-this.nearPlane,uOj.transformCoordinate(uj,this.transform.worldMatrix,uj),!0}return!1},u$(0,uj,"projectionViewMatrix",function(){return uWj.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),u$(0,uj,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var uW=this.viewport;return uW.width/uW.height},function(uW){if(uW<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=uW,this._calculateProjectionMatrix()}),u$(0,uj,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),u$(0,uj,"needViewport",function(){var uW=this.normalizedViewport;return 0===uW.x&&0===uW.y&&1===uW.width&&1===uW.height}),u$(0,uj,"viewport",function(){if(this._viewportExpressedInClipSpace){var uW=this._normalizedViewport,uj=this.renderTargetSize,ut=uj.width,ud=uj.height;this._viewport.x=uW.x*ut,this._viewport.y=uW.y*ud,this._viewport.width=uW.width*ut,this._viewport.height=uW.height*ud}return this._viewport},function(uW){if(null!=this.renderTarget&&(uW.x<0||uW.y<0||0==uW.width||0==uW.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=uW,this._calculateProjectionMatrix()}),u$(0,uj,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var uW=this._viewport,uj=this.renderTargetSize,ut=uj.width,ud=uj.height;this._normalizedViewport.x=uW.x/ut,this._normalizedViewport.y=uW.y/ud,this._normalizedViewport.width=uW.width/ut,this._normalizedViewport.height=uW.height/ud}return this._normalizedViewport},function(uW){uW.x<0&&(uW.x=0,console.warn("Camera: viewport.x must large than 0.0.")),uW.y<0&&(uW.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<uW.x+uW.width&&(uW.width=1-uW.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<uW.y+uW.height&&(uW.height=1-uW.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=uW,this._calculateProjectionMatrix()}),u$(0,uj,"projectionMatrix",function(){return this._projectionMatrix},function(uW){this._projectionMatrix=uW,this._useUserProjectionMatrix=!0}),u$(0,uj,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),um(uO,["_tempVector20",function(){return this._tempVector20=new uEj}]),uO}()),uPj=function(ut){function ud(uW,uj){ud.__super.call(this,uj),this._geometryFilter=new uhj(this),this._render=new uvj(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),uW&&(this._geometryFilter.sharedMesh=uW)instanceof laya.d3.resource.models.Mesh&&(uW.loaded?this._render.sharedMaterials=uW.materials:uW.once("loaded",this,this._applyMeshMaterials))}uT(ud,"laya.d3.core.MeshSprite3D",ut);var uW=ud.prototype;return uW._changeRenderObjectByMesh=function(uW){var uj=this._render._renderElements,ut=uj[uW];ut||(ut=uj[uW]=new uNj),ut._render=this._render;var ud=this._render.sharedMaterials[uW];ud||(ud=uDj.defaultMaterial);var ub=this._geometryFilter.sharedMesh.getRenderElement(uW);return ut._mainSortID=this._getSortID(ub,ud),ut._sprite3D=this,ut.renderObj=ub,ut._material=ud,ut},uW._changeRenderObjectByMaterial=function(uW,uj){var ut=this._render._renderElements[uW];uj||(uj=uDj.defaultMaterial);var ud=this._geometryFilter.sharedMesh.getRenderElement(uW);return ut._mainSortID=this._getSortID(ud,uj),ut._sprite3D=this,ut.renderObj=ud,ut._material=uj,ut},uW._changeRenderObjectsByMesh=function(){var uW=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=uW;for(var uj=0;uj<uW;uj++)this._changeRenderObjectByMesh(uj)},uW._onMeshChanged=function(uW){var uj=uW.sharedMesh;uj.loaded?this._changeRenderObjectsByMesh():uj.once("loaded",this,this._onMeshLoaded)},uW._onMeshLoaded=function(uW){uW===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},uW._onMaterialChanged=function(uW,uj,ut){uj<this._render._renderElements.length&&this._changeRenderObjectByMaterial(uj,ut)},uW._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},uW._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},uW._parseCustomProps=function(uW,uj,ut,ud){var ub=this.meshRender,uE=ut.lightmapIndex;null!=uE&&(ub.lightmapIndex=uE);var uO,uq,uA=ut.lightmapScaleOffset;if(uA&&(ub.lightmapScaleOffset=new uqj(uA[0],uA[1],uA[2],uA[3])),ud.instanceParams)(uO=ud.instanceParams.loadPath)&&(uq=uo.getRes(uj[uO]),(this.meshFilter.sharedMesh=uq).loaded?ub.sharedMaterials=uq.materials:uq.once("loaded",this,this._applyMeshMaterials));else{(uO=ut.meshPath)&&(uq=uo.getRes(uj[uO]),this.meshFilter.sharedMesh=uq);var uc=ut.materials;if(uc){var uR=ub.sharedMaterials,um=uc.length;uR.length=um;for(var uQ=0;uQ<um;uQ++)uR[uQ]=uo.getRes(uj[uc[uQ].path]);ub.sharedMaterials=uR}}},uW._applyMeshMaterials=function(uW){for(var uj=this._render.sharedMaterials,ut=uW.materials,ud=0,ub=ut.length;ud<ub;ud++)uj[ud]||(uj[ud]=ut[ud]);this._render.sharedMaterials=uj},uW._addToInitStaticBatchManager=function(){ud._staticBatchManager._addInitBatchSprite(this)},uW.cloneTo=function(uW){var uj=uW;uj._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var ut=this._render,ud=uj._render;ud.enable=ut.enable,ud.sharedMaterials=ut.sharedMaterials,ud.castShadow=ut.castShadow;var ub=ut.lightmapScaleOffset;ub&&(ud.lightmapScaleOffset=ub.clone()),ud.lightmapIndex=ut.lightmapIndex,ud.receiveShadow=ut.receiveShadow,ud.sortingFudge=ut.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,uW)},uW.destroy=function(uW){if(void 0===uW&&(uW=!0),!this.destroyed){var uj=this.meshFilter.sharedMesh;null!=uj&&(uj.loaded||uj.off("loaded",this,this._applyMeshMaterials)),ut.prototype.destroy.call(this,uW),this._geometryFilter._destroy()}},u$(0,uW,"meshFilter",function(){return this._geometryFilter}),u$(0,uW,"meshRender",function(){return this._render}),ud.__init__=function(){udW._staticBatchManagers.push(ud._staticBatchManager)},ud.load=function(uW){return uX.loader.create(uW,null,null,ud)},um(ud,["_staticBatchManager",function(){return this._staticBatchManager=new uCj}]),ud}(uJj)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(uW,uj){"use strict";for(var ut in Object.defineProperty(uj,"__esModule",{value:!0}),Laya){var ud=Laya[ut];ud&&ud.__isclass&&(uj[ut]=ud)}}),function(uW,uj,ubW){ubW.un,ubW.uns;var ut=ubW.static,ud=ubW.class,uE=ubW.getset,ue=ubW.__newvec,uq=laya.maths.Bezier,um=laya.utils.Browser,uGW=laya.utils.Byte,ub=(laya.events.Event,laya.events.EventDispatcher),uO=laya.display.Graphics,uA=(laya.resource.HTMLCanvas,laya.utils.Handler),uc=laya.net.Loader,uQ=laya.maths.MathUtil,ulW=laya.maths.Matrix,uK=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),uR=(laya.renders.RenderContext,laya.resource.Resource),uT=laya.utils.RunDriver,uEW=laya.display.Sprite,u$=laya.utils.Stat,uhW=laya.resource.Texture,uo=(laya.net.URL,laya.utils.Utils),ul=function(){function uW(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return ud(uW,"laya.ani.AnimationContent"),uW}(),uh=function(){function uW(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return ud(uW,"laya.ani.AnimationNodeContent"),uW}(),uM=function(){function uW(){}return ud(uW,"laya.ani.AnimationParser01"),uW.parse=function(uW,uj){var ut=uj.__getBuffer(),ud=0,ub=0,uE=0,uO=0,uq=0,uA=0,uc=0,uR=uj.readUTFString();uW._aniClassName=uR;var um,uQ=uj.readUTFString().split("\n"),uT=uj.getUint8(),u$=uj.getUint32(),ue=uj.getUint32();0<u$&&(um=ut.slice(u$,ue));var uK=new uGW(um);for(0<ue&&(uW._publicExtData=ut.slice(ue,ut.byteLength)),uW._useParent=!!uj.getUint8(),uW._anis.length=uT,ud=0;ud<uT;ud++){var uo=uW._anis[ud]=new ul;uo.nodes=new Array;var uS=uo.name=uQ[uj.getUint16()];uW._aniMap[uS]=ud,uo.bone3DMap={},uo.playTime=uj.getFloat32(),uo.playTime<=0&&console.error("播放时间不能为0  url="+uW.url+" name="+uo.name);var uM=uo.nodes.length=uj.getUint8();for(ub=uo.totalKeyframeDatasLength=0;ub<uM;ub++){var uZ=uo.nodes[ub]=new uh;uZ.childs=[];var uX=uj.getInt16();0<=uX&&(uZ.name=uQ[uX],uo.bone3DMap[uZ.name]=ub),uZ.keyFrame=new Array,uZ.parentIndex=uj.getInt16(),-1==uZ.parentIndex?uZ.parent=null:uZ.parent=uo.nodes[uZ.parentIndex],uZ.lerpType=uj.getUint8();var u_=uj.getUint32();uK.pos=u_;var uN=uZ.keyframeWidth=uK.getUint16();if(uo.totalKeyframeDatasLength+=uN,0===uZ.lerpType||1===uZ.lerpType)for(uZ.interpolationMethod=[],uZ.interpolationMethod.length=uN,uE=0;uE<uN;uE++)uZ.interpolationMethod[uE]=ua.interpolation[uK.getUint8()];null!=uZ.parent&&uZ.parent.childs.push(uZ);var uz=uj.getUint16();0<uz&&(uZ.extenData=ut.slice(uj.pos,uj.pos+uz),uj.pos+=uz);var uC,uL=uj.getUint16(),uV=0;for(uE=0,uO=uZ.keyFrame.length=uL;uE<uO;uE++){if((uC=uZ.keyFrame[uE]=new uv).duration=uj.getFloat32(),uC.startTime=uV,2===uZ.lerpType){uC.interpolationData=[];var ux,uG=uj.getUint8();switch(ux=uj.getFloat32()){case 254:for(uC.interpolationData.length=uN,uc=0;uc<uN;uc++)uC.interpolationData[uc]=0;break;case 255:for(uC.interpolationData.length=uN,uc=0;uc<uN;uc++)uC.interpolationData[uc]=5;break;default:for(uC.interpolationData.push(ux),uA=1;uA<uG;uA++)uC.interpolationData.push(uj.getFloat32())}}for(uC.data=new Float32Array(uN),uq=0;uq<uN;uq++)uC.data[uq]=uj.getFloat32(),-1e-8<uC.data[uq]&&uC.data[uq]<1e-8&&(uC.data[uq]=0);uV+=uC.duration}uC.startTime=uo.playTime,uZ.playTime=uo.playTime,uW._calculateKeyFrame(uZ,uL,uN)}}},uW}(),uZ=function(){function uX(){}return ud(uX,"laya.ani.AnimationParser02"),uX.READ_DATA=function(){uX._DATA.offset=uX._reader.getUint32(),uX._DATA.size=uX._reader.getUint32()},uX.READ_BLOCK=function(){for(var uW=uX._BLOCK.count=uX._reader.getUint16(),uj=uX._BLOCK.blockStarts=[],ut=uX._BLOCK.blockLengths=[],ud=0;ud<uW;ud++)uj.push(uX._reader.getUint32()),ut.push(uX._reader.getUint32())},uX.READ_STRINGS=function(){var uW=uX._reader.getUint32(),uj=uX._reader.getUint16(),ut=uX._reader.pos;uX._reader.pos=uW+uX._DATA.offset;for(var ud=0;ud<uj;ud++)uX._strings[ud]=uX._reader.readUTFString();uX._reader.pos=ut},uX.parse=function(uW,uj){uX._templet=uW;(uX._reader=uj).__getBuffer();uX.READ_DATA(),uX.READ_BLOCK(),uX.READ_STRINGS();for(var ut=0,ud=uX._BLOCK.count;ut<ud;ut++){var ub=uj.getUint16(),uE=uX._strings[ub],uO=uX["READ_"+uE];if(null==uO)throw new Error("model file err,no this function:"+ub+" "+uE);uO.call()}},uX.READ_ANIMATIONS=function(){var uW=uX._reader,uj=uW.__getBuffer(),ut=0,ud=0,ub=0,uE=0,uO=uW.getUint16(),uq=[];for(uq.length=uO,ut=0;ut<uO;ut++)uq[ut]=ua.interpolation[uW.getByte()];var uA=uW.getUint8();for(uX._templet._anis.length=uA,ut=0;ut<uA;ut++){var uc=uX._templet._anis[ut]={};uc.nodes=new Array;var uR=uc.name=uX._strings[uW.getUint16()];uX._templet._aniMap[uR]=ut,uc.bone3DMap={},uc.playTime=uW.getFloat32();var um=uc.nodes.length=uW.getInt16();for(ud=uc.totalKeyframeDatasLength=0;ud<um;ud++){var uQ=uc.nodes[ud]={};uQ.keyframeWidth=uO,uQ.childs=[];var uT=uW.getUint16();0<=uT&&(uQ.name=uX._strings[uT],uc.bone3DMap[uQ.name]=ud),uQ.keyFrame=new Array,uQ.parentIndex=uW.getInt16(),-1==uQ.parentIndex?uQ.parent=null:uQ.parent=uc.nodes[uQ.parentIndex],uc.totalKeyframeDatasLength+=uO,uQ.interpolationMethod=uq,null!=uQ.parent&&uQ.parent.childs.push(uQ);var u$=uW.getUint16(),ue=null,uK=null;for(ub=0,uE=uQ.keyFrame.length=u$;ub<uE;ub++){(ue=uQ.keyFrame[ub]={}).startTime=uW.getFloat32(),uK&&(uK.duration=ue.startTime-uK.startTime);var uo=uX._DATA.offset,uS=uW.getUint32(),uM=4*uO,uZ=uj.slice(uo+uS,uo+uS+uM);ue.data=new Float32Array(uZ),uK=ue}ue.duration=0,uQ.playTime=uc.playTime,uX._templet._calculateKeyFrame(uQ,u$,uO)}}},uX._templet=null,uX._reader=null,uX._strings=[],ut(uX,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),uX}(),uvW=(function(){function uW(){}ud(uW,"laya.ani.AnimationState"),uW.stopped=0,uW.paused=1,uW.playing=2}(),function(){function ub(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new uJW,this.resultMatrix=new ulW,this._children=[]}ud(ub,"laya.ani.bone.Bone");var uW=ub.prototype;return uW.setTempMatrix=function(uW){this._tempMatrix=uW;var uj,ut=0;for(ut=0,uj=this._children.length;ut<uj;ut++)this._children[ut].setTempMatrix(this._tempMatrix)},uW.update=function(uW){var uj;if(this.rotation=this.transform.skX,uW)uj=this.resultTransform.getMatrix(),ulW.mul(uj,uW,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)uj=this.resultTransform.getMatrix(),ulW.mul(uj,this.parentBone.resultMatrix,this.resultMatrix);else{var ut=this.parentBone,ud=NaN,ub=NaN,uE=NaN,uO=this.parentBone.resultMatrix;uj=this.resultTransform.getMatrix();var uq=uO.a*uj.tx+uO.c*uj.ty+uO.tx,uA=uO.b*uj.tx+uO.d*uj.ty+uO.ty,uc=new ulW;this.inheritRotation?(ud=Math.atan2(ut.resultMatrix.b,ut.resultMatrix.a),ub=Math.cos(ud),uE=Math.sin(ud),uc.setTo(ub,uE,-uE,ub,0,0),ulW.mul(this._tempMatrix,uc,ulW.TEMP),ulW.TEMP.copyTo(uc),uj=this.resultTransform.getMatrix(),ulW.mul(uj,uc,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,uj=this.resultTransform.getMatrix(),ulW.TEMP.identity(),ulW.TEMP.d=this.d,ulW.mul(uj,ulW.TEMP,this.resultMatrix)),this.resultMatrix.tx=uq,this.resultMatrix.ty=uA}else(uj=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var uR,um=0;for(um=0,uR=this._children.length;um<uR;um++)this._children[um].update()},uW.updateChild=function(){var uW,uj=0;for(uj=0,uW=this._children.length;uj<uW;uj++)this._children[uj].update()},uW.setRotation=function(uW){this._sprite&&(this._sprite.rotation=180*uW/Math.PI)},uW.updateDraw=function(uW,uj){ub.ShowBones&&!ub.ShowBones[this.name]||(this._sprite||(this._sprite=new uEW,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),ubW.stage.addChild(this._sprite)),this._sprite.x=uW+this.resultMatrix.tx,this._sprite.y=uj+this.resultMatrix.ty);var ut,ud=0;for(ud=0,ut=this._children.length;ud<ut;ud++)this._children[ud].updateDraw(uW,uj)},uW.addChild=function(uW){this._children.push(uW),uW.parentBone=this},uW.findBone=function(uW){if(this.name==uW)return this;var uj,ut,ud=0;for(ud=0,uj=this._children.length;ud<uj;ud++)if(ut=this._children[ud].findBone(uW))return ut;return null},uW.localToWorld=function(uW){var uj=uW[0],ut=uW[1];uW[0]=uj*this.resultMatrix.a+ut*this.resultMatrix.c+this.resultMatrix.tx,uW[1]=uj*this.resultMatrix.b+ut*this.resultMatrix.d+this.resultMatrix.ty},ub.ShowBones={},ub}()),uyW=function(){function ue(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}ud(ue,"laya.ani.bone.BoneSlot");var uW=ue.prototype;return uW.showSlotData=function(uW,uj){void 0===uj&&(uj=!0),this.currSlotData=uW,uj&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},uW.showDisplayByName=function(uW){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(uW))},uW.replaceDisplayByName=function(uW,uj){if(this.currSlotData){var ut;ut=this.currSlotData.getDisplayByName(uW);var ud;ud=this.currSlotData.getDisplayByName(uj),this.replaceDisplayByIndex(ut,ud)}},uW.replaceDisplayByIndex=function(uW,uj){this.currSlotData&&(this._replaceDic[uW]=uj,this.displayIndex==uW&&this.showDisplayByIndex(uW))},uW.showDisplayByIndex=function(uW){if(null!=this._replaceDic[uW]&&(uW=this._replaceDic[uW]),this.currSlotData&&-1<uW&&uW<this.currSlotData.displayArr.length){if(this.displayIndex=uW,this.currDisplayData=this.currSlotData.displayArr[uW],this.currDisplayData){var uj=this.currDisplayData.name;this.currTexture=this.templet.getTexture(uj),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!uK.isConchApp||uK.isConchApp&&"0.9.15"<uEW.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},uW.replaceSkin=function(uW){this._diyTexture=uW,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},uW.setParentMatrix=function(uW){this._parentMatrix=uW},uW.draw=function(uW,uj,ut,ud){if(void 0===ut&&(ut=!1),void 0===ud&&(ud=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var ub,uE=this.currTexture;switch(this._diyTexture&&(uE=this._diyTexture),this.currDisplayData.type){case 0:if(uW){var uO=this.getDisplayMatrix();if(this._parentMatrix){var uq=!1;if(uO){var uA;if(ulW.mul(uO,this._parentMatrix,ulW.TEMP),uA=ut?(null==this._resultMatrix&&(this._resultMatrix=new ulW),this._resultMatrix):new ulW,!uK.isWebGL&&this.currDisplayData.uvs||uK.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var uc=ue._tempMatrix;uc.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(uc.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(uq=!0,uc.rotate(-Math.PI/2)),ulW.mul(uc,ulW.TEMP,uA)}else ulW.TEMP.copyTo(uA);uq?uW.drawTexture(uE,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,uA):uW.drawTexture(uE,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,uA)}}}break;case 1:if(null==(ub=ut?(null==this._skinSprite&&(this._skinSprite=ue.createSkinMesh()),this._skinSprite):ue.createSkinMesh()))return;var uR;if(null==this.currDisplayData.bones){var um,uQ=this.currDisplayData.weights;this.deformData&&(uQ=this.deformData),um=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=uN.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=uN.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=uQ;this.currDisplayData.triangles.length;uR=this.currDisplayData.triangles,ub.init2(uE,null,uR,this._mVerticleArr,um);var uT,u$=this.getDisplayMatrix();if(this._parentMatrix)if(u$)ulW.mul(u$,this._parentMatrix,ulW.TEMP),uT=ut?(null==this._resultMatrix&&(this._resultMatrix=new ulW),this._resultMatrix):new ulW,ulW.TEMP.copyTo(uT),ub.transform=uT}else this.skinMesh(uj,ub,ud);uW.drawSkin(ub);break;case 2:if(null==(ub=ut?(null==this._skinSprite&&(this._skinSprite=ue.createSkinMesh()),this._skinSprite):ue.createSkinMesh()))return;this.skinMesh(uj,ub,ud),uW.drawSkin(ub)}}},uW.skinMesh=function(uW,uj,ut){var ud,ub=this.currTexture,uE=this.currDisplayData.bones;ud=this._diyTexture?(ub=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=uN.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=uN.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var uO,uq,uA=this.currDisplayData.weights,uc=this.currDisplayData.triangles,uR=0,um=0,uQ=0,uT=NaN,u$=NaN,ue=0,uK=0,uo=[],uS=0,uM=0;if(this.deformData&&0<this.deformData.length){var uZ=0;for(uS=0,uM=uE.length;uS<uM;){for(uQ=uE[uS++]+uS,um=uR=0;uS<uQ;uS++)uq=uW[uE[uS]],uT=uA[ue]+this.deformData[uZ++],u$=uA[ue+1]+this.deformData[uZ++],uK=uA[ue+2],uR+=(uT*uq.a+u$*uq.c+uq.tx)*uK,um+=(uT*uq.b+u$*uq.d+uq.ty)*uK,ue+=3;uo.push(uR,um)}}else for(uS=0,uM=uE.length;uS<uM;){for(uQ=uE[uS++]+uS,um=uR=0;uS<uQ;uS++)uq=uW[uE[uS]],uT=uA[ue],u$=uA[ue+1],uK=uA[ue+2],uR+=(uT*uq.a+u$*uq.c+uq.tx)*uK,um+=(uT*uq.b+u$*uq.d+uq.ty)*uK,ue+=3;uo.push(uR,um)}this._mVerticleArr=uo,uO=uc,uj.init2(ub,null,uO,this._mVerticleArr,ud)},uW.drawBonePoint=function(uW){uW&&this._parentMatrix&&uW.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},uW.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},uW.getMatrix=function(){return this._resultMatrix},uW.copy=function(){var uW=new ue;return uW.type="copy",uW.name=this.name,uW.attachmentName=this.attachmentName,uW.srcDisplayIndex=this.srcDisplayIndex,uW.parent=this.parent,uW.displayIndex=this.displayIndex,uW.templet=this.templet,uW.currSlotData=this.currSlotData,uW.currTexture=this.currTexture,uW.currDisplayData=this.currDisplayData,uW},ue.createSkinMesh=function(){return uK.isWebGL||uK.isConchApp?uT.skinAniSprite():(uK.isWebGL,null)},ut(ue,["_tempMatrix",function(){return this._tempMatrix=new ulW}]),ue}(),uaW=function(){function uW(){this.skinName=null,this.deformSlotDataList=[]}return ud(uW,"laya.ani.bone.DeformAniData"),uW}(),uuW=function(){function uW(){this.deformSlotDisplayList=[]}return ud(uW,"laya.ani.bone.DeformSlotData"),uW}(),uDW=function(){function uW(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}ud(uW,"laya.ani.bone.DeformSlotDisplayData");var uj=uW.prototype;return uj.binarySearch1=function(uW,uj){var ut=0,ud=uW.length-2;if(0==ud)return 1;for(var ub=ud>>>1;;){if(uW[Math.floor(ub+1)]<=uj?ut=ub+1:ud=ub,ut==ud)return ut+1;ub=ut+ud>>>1}return 0},uj.apply=function(uW,uj,ut){if(void 0===ut&&(ut=1),uW+=.05,!(this.timeList.length<=0)){var ud=0;if(!(uW<this.timeList[0])){var ub=this.vectices[0].length,uE=[],uO=this.binarySearch1(this.timeList,uW);if(this.frameIndex=uO,uW>=this.timeList[this.timeList.length-1]){var uq=this.vectices[this.vectices.length-1];if(ut<1)for(ud=0;ud<ub;ud++)uE[ud]+=(uq[ud]-uE[ud])*ut;else for(ud=0;ud<ub;ud++)uE[ud]=uq[ud];this.deformData=uE}else{this.tweenKeyList[this.frameIndex];var uA=this.vectices[this.frameIndex-1],uc=this.vectices[this.frameIndex],uR=this.timeList[this.frameIndex-1],um=this.timeList[this.frameIndex];ut=this.tweenKeyList[uO-1]?(uW-uR)/(um-uR):0;var uQ=NaN;for(ud=0;ud<ub;ud++)uQ=uA[ud],uE[ud]=uQ+(uc[ud]-uQ)*ut;this.deformData=uE}}}},uW}(),usW=function(){function uW(){this.time=NaN,this.drawOrder=[]}return ud(uW,"laya.ani.bone.DrawOrderData"),uW}(),uYW=function(){function uW(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return ud(uW,"laya.ani.bone.EventData"),uW}(),uS=function(){function udW(uW,uj){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=uW,this._targetBone=uj[uW.targetBoneIndex],this.isSpine=uW.isSpine,null==this._bones&&(this._bones=[]);for(var ut=this._bones.length=0,ud=uW.boneIndexs.length;ut<ud;ut++)this._bones.push(uj[uW.boneIndexs[ut]]);this.name=uW.name,this.mix=uW.mix,this.bendDirection=uW.bendDirection}ud(udW,"laya.ani.bone.IkConstraint");var uW=udW.prototype;return uW.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},uW._applyIk1=function(uW,uj,ut,ud){var ub=uW.parentBone,uE=1/(ub.resultMatrix.a*ub.resultMatrix.d-ub.resultMatrix.b*ub.resultMatrix.c),uO=uj-ub.resultMatrix.tx,uq=ut-ub.resultMatrix.ty,uA=(uO*ub.resultMatrix.d-uq*ub.resultMatrix.c)*uE-uW.transform.x,uc=(uq*ub.resultMatrix.a-uO*ub.resultMatrix.b)*uE-uW.transform.y,uR=Math.atan2(uc,uA)*udW.radDeg-0-uW.transform.skX;uW.transform.scX<0&&(uR+=180),180<uR?uR-=360:uR<-180&&(uR+=360),uW.transform.skX=uW.transform.skY=uW.transform.skX+uR*ud,uW.update()},uW.updatePos=function(uW,uj){this._sp&&this._sp.pos(uW,uj)},uW._applyIk2=function(uW,uj,ut,ud,ub,uE){if(0!=uE){var uO=uW.resultTransform.x,uq=uW.resultTransform.y,uA=uW.transform.scX,uc=uW.transform.scY,uR=uj.transform.scX,um=0,uQ=0,uT=0;uT=uA<0?(uA=-uA,um=180,-1):(um=0,1),uc<0&&(uc=-uc,uT=-uT),uQ=uR<0?(uR=-uR,180):0;var u$=uj.resultTransform.x,ue=NaN,uK=NaN,uo=NaN,uS=uW.resultMatrix.a,uM=uW.resultMatrix.c,uZ=uW.resultMatrix.b,uX=uW.resultMatrix.d,u_=Math.abs(uA-uc)<=1e-4;uo=u_?(uK=uS*u$+uM*(ue=uj.resultTransform.y)+uW.resultMatrix.tx,uZ*u$+uX*ue+uW.resultMatrix.ty):(ue=0,uK=uS*u$+uW.resultMatrix.tx,uZ*u$+uW.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new uEW,ubW.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(ut,ud,15,"#ffff00"),this._sp.graphics.drawCircle(uK,uo,15,"#ff00ff")),uW.setRotation(Math.atan2(uo-uW.resultMatrix.ty,uK-uW.resultMatrix.tx));var uN=uW.parentBone;uS=uN.resultMatrix.a,uM=uN.resultMatrix.c,uZ=uN.resultMatrix.b;var uz=1/(uS*(uX=uN.resultMatrix.d)-uM*uZ),uC=ut-uN.resultMatrix.tx,uL=ud-uN.resultMatrix.ty,uV=(uC*uX-uL*uM)*uz-uO,ux=(uL*uS-uC*uZ)*uz-uq,uG=((uC=uK-uN.resultMatrix.tx)*uX-(uL=uo-uN.resultMatrix.ty)*uM)*uz-uO,ul=(uL*uS-uC*uZ)*uz-uq,uh=Math.sqrt(uG*uG+ul*ul),uv=uj.length*uR,uy=NaN,ua=NaN;if(u_){var uu=(uV*uV+ux*ux-uh*uh-(uv*=uA)*uv)/(2*uh*uv);uu<-1?uu=-1:1<uu&&(uu=1),ua=Math.acos(uu)*ub,uS=uh+uv*uu,uM=uv*Math.sin(ua),uy=Math.atan2(ux*uS-uV*uM,uV*uS+ux*uM)}else{var uD=(uS=uA*uv)*uS,us=(uM=uc*uv)*uM,uY=uV*uV+ux*ux,uH=Math.atan2(ux,uV),uI=-2*us*uh,ug=us-uD;if(0<(uX=uI*uI-4*ug*(uZ=us*uh*uh+uD*uY-uD*us))){var uf=Math.sqrt(uX);uI<0&&(uf=-uf);var uw=(uf=-(uI+uf)/2)/ug,uU=uZ/uf,uJ=Math.abs(uw)<Math.abs(uU)?uw:uU;uJ*uJ<=uY&&(uL=Math.sqrt(uY-uJ*uJ)*ub,uy=uH-Math.atan2(uL,uJ),ua=Math.atan2(uL/uc,(uJ-uh)/uA))}var ur=0,uP=Number.MAX_VALUE,ui=0,uB=0,un=0,uk=0,up=0,uF=0;uk<(uX=(uC=uh+uS)*uC)&&(un=0,uk=uX,up=uC),(uX=(uC=uh-uS)*uC)<uP&&(ur=Math.PI,uP=uX,ui=uC);var uWW=Math.acos(-uS*uh/(uD-us));(uX=(uC=uS*Math.cos(uWW)+uh)*uC+(uL=uM*Math.sin(uWW))*uL)<uP&&(ur=uWW,uP=uX,ui=uC,uB=uL),uk<uX&&(un=uWW,uk=uX,up=uC,uF=uL),ua=uY<=(uP+uk)/2?(uy=uH-Math.atan2(uB*ub,ui),ur*ub):(uy=uH-Math.atan2(uF*ub,up),un*ub)}var ujW=Math.atan2(ue,u$)*uT,utW=uW.resultTransform.skX;180<(uy=(uy-ujW)*udW.radDeg+um-utW)?uy-=360:uy<-180&&(uy+=360),uW.resultTransform.x=uO,uW.resultTransform.y=uq,uW.resultTransform.skX=uW.resultTransform.skY=utW+uy*uE,utW=uj.resultTransform.skX,180<(ua=((ua+ujW)*udW.radDeg-0)*uT+uQ-(utW%=360))?ua-=360:ua<-180&&(ua+=360),uj.resultTransform.x=u$,uj.resultTransform.y=ue,uj.resultTransform.skX=uj.resultTransform.skY=uj.resultTransform.skY+ua*uE,uW.update()}},uW._applyIk3=function(uW,uj,ut,ud,ub,uE){if(0!=uE){var uO,uq,uA=uj.resultMatrix.a*uj.length,uc=uj.resultMatrix.b*uj.length,uR=uA*uA+uc*uc,um=Math.sqrt(uR),uQ=uW.resultMatrix.tx,uT=uW.resultMatrix.ty,u$=uj.resultMatrix.tx,ue=uj.resultMatrix.ty,uK=u$-uQ,uo=ue-uT,uS=uK*uK+uo*uo,uM=Math.sqrt(uS),uZ=(uK=ut-uW.resultMatrix.tx)*uK+(uo=ud-uW.resultMatrix.ty)*uo,uX=Math.sqrt(uZ);if(um+uM<=uX||uX+um<=uM||uX+uM<=um){var u_=NaN;u$=uQ+(u_=um+uM<=uX?1:-1)*(ut-uQ)*uM/uX,ue=uT+u_*(ud-uT)*uM/uX}else{var uN=(uS-uR+uZ)/(2*uZ),uz=Math.sqrt(uS-uN*uN*uZ)/uX,uC=uQ+uK*uN,uL=uT+uo*uN,uV=-uo*uz,ux=uK*uz;ue=0<ub?(u$=uC-uV,uL-ux):(u$=uC+uV,uL+ux)}uO=u$,uq=ue,this.isDebug&&(this._sp||(this._sp=new uEW,ubW.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(uQ,uT,15,"#ff00ff"),this._sp.graphics.drawCircle(ut,ud,15,"#ffff00"),this._sp.graphics.drawCircle(uO,uq,15,"#ff00ff"));var uG,ul;uG=Math.atan2(uq-uW.resultMatrix.ty,uO-uW.resultMatrix.tx),uW.setRotation(uG),(ul=udW._tempMatrix).identity(),ul.rotate(uG),ul.scale(uW.resultMatrix.getScaleX(),uW.resultMatrix.getScaleY()),ul.translate(uW.resultMatrix.tx,uW.resultMatrix.ty),ul.copyTo(uW.resultMatrix),uW.updateChild();var uh,uv;uh=Math.atan2(ud-uq,ut-uO),uj.setRotation(uh),(uv=udW._tempMatrix).identity(),uv.rotate(uh),uv.scale(uj.resultMatrix.getScaleX(),uj.resultMatrix.getScaleY()),uv.translate(uO,uq),ul.copyTo(uj.resultMatrix),uj.updateChild()}},ut(udW,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new ulW}]),udW}(),uHW=function(){function uW(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return ud(uW,"laya.ani.bone.IkConstraintData"),uW}(),uX=function(){function uv(uW,uj){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=uW,this.position=uW.position,this.spacing=uW.spacing,this.rotateMix=uW.rotateMix,this.translateMix=uW.translateMix,this.bones=[];for(var ut=this.data.bones,ud=0,ub=ut.length;ud<ub;ud++)this.bones.push(uj[ut[ud]])}ud(uv,"laya.ani.bone.PathConstraint");var uW=uv.prototype;return uW.apply=function(uW,uj){if(this.target){var ut=this.translateMix,ud=this.translateMix,ub=0<ud,uE=this.data.spacingMode,uO="length"==uE,uq=this.data.rotateMode,uA="tangent"==uq,uc="chainScale"==uq,uR=[],um=this.bones.length,uQ=uA?um:um+1,uT=[];(this._spaces=uT)[0]=this.position;var u$=this.spacing;if(uc||uO)for(var ue=0,uK=uQ-1;ue<uK;){var uo=this.bones[ue],uS=uo.length,uM=uS*uo.resultMatrix.a,uZ=uS*uo.resultMatrix.b;uS=Math.sqrt(uM*uM+uZ*uZ),uc&&(uR[ue]=uS),uT[++ue]=uO?Math.max(0,uS+u$):u$}else for(ue=1;ue<uQ;ue++)uT[ue]=u$;var uX=this.computeWorldPositions(this.target,uW,uj,uQ,uA,"percent"==this.data.positionMode,"percent"==uE);if(this._debugKey){for(ue=0;ue<uX.length;ue++)uj.drawCircle(uX[ue++],uX[ue++],5,"#00ff00");var u_=[];for(ue=0;ue<uX.length;ue++)u_.push(uX[ue++],uX[ue++]);uj.drawLines(0,0,u_,"#ff0000")}var uN=uX[0],uz=uX[1],uC=this.data.offsetRotation,uL="chain"==uq&&0==uC,uV=NaN;for(ue=0,uV=3;ue<um;ue++,uV+=3){(uo=this.bones[ue]).resultMatrix.tx+=(uN-uo.resultMatrix.tx)*ut,uo.resultMatrix.ty+=(uz-uo.resultMatrix.ty)*ut;var ux=(uM=uX[uV])-uN,uG=(uZ=uX[uV+1])-uz;if(uc&&0!=(uS=uR[ue])){var ul=(Math.sqrt(ux*ux+uG*uG)/uS-1)*ud+1;uo.resultMatrix.a*=ul,uo.resultMatrix.c*=ul}if(uN=uM,uz=uZ,ub){var uh=uo.resultMatrix.a,uv=uo.resultMatrix.c,uy=uo.resultMatrix.b,ua=uo.resultMatrix.d,uu=NaN,uD=NaN,us=NaN;uu=uA?uX[uV-1]:0==uT[ue+1]?uX[uV+2]:Math.atan2(uG,ux),uu-=Math.atan2(uy,uh)-uC/180*Math.PI,uL&&(uD=Math.cos(uu),us=Math.sin(uu),uN+=((uS=uo.length)*(uD*uh-us*uy)-ux)*ud,uz+=(uS*(us*uh+uD*uy)-uG)*ud),uu>Math.PI?uu-=2*Math.PI:uu<-Math.PI&&(uu+=2*Math.PI),uu*=ud,uD=Math.cos(uu),us=Math.sin(uu),uo.resultMatrix.a=uD*uh-us*uy,uo.resultMatrix.c=uD*uv-us*ua,uo.resultMatrix.b=us*uh+uD*uy,uo.resultMatrix.d=us*uv+uD*ua}}}},uW.computeWorldVertices2=function(uW,uj,ut,ud,ub,uE){var uO,uq,uA=uW.currDisplayData.bones,uc=uW.currDisplayData.weights,uR=uW.currDisplayData.triangles,um=0,uQ=0,uT=0,u$=0,ue=0,uK=0,uo=0,uS=0,uM=0,uZ=0,uX=0;if(null!=uA){for(um=0;um<ut;um+=2)uQ+=(u$=uA[uQ])+1,uT+=u$;var u_=uj;for(ue=uE,uK=3*uT;ue<ud;ue+=2){for(uS=uo=0,u$=uA[uQ++],u$+=uQ;uQ<u$;uQ++,uK+=3){uO=u_[uA[uQ]].resultMatrix,uM=uc[uK],uZ=uc[uK+1];var uN=uc[uK+2];uo+=(uM*uO.a+uZ*uO.c+uO.tx)*uN,uS+=(uM*uO.b+uZ*uO.d+uO.ty)*uN}ub[ue]=uo,ub[ue+1]=uS}}else{var uz,uC;if(uR||(uR=uc),uW.deformData&&(uR=uW.deformData),uz=uW.parent,uj)for(uX=uj.length,um=0;um<uX;um++)if(uj[um].name==uz){uq=uj[um];break}uq&&(uC=uq.resultMatrix),uC||(uC=uv._tempMt);var uL=uC.tx,uV=uC.ty,ux=uC.a,uG=uC.b,ul=uC.c,uh=uC.d;for(uq&&(uh*=uq.d),uQ=ut,ue=uE;ue<ud;uQ+=2,ue+=2)uM=uR[uQ],uZ=uR[uQ+1],ub[ue]=uM*ux+uZ*uG+uL,ub[ue+1]=-(uM*ul+uZ*uh+uV)}},uW.computeWorldPositions=function(uW,uj,ut,ud,ub,uE,uO){uW.currDisplayData.bones,uW.currDisplayData.weights,uW.currDisplayData.triangles;var uq=[],uA=0,uc=uW.currDisplayData.verLen,uR=this.position,um=this._spaces,uQ=[],uT=[],u$=uc/6,ue=-1,uK=NaN,uo=0,uS=0,uM=NaN,uZ=NaN,uX=NaN,u_=NaN;if(u$--,uc-=4,this.computeWorldVertices2(uW,uj,2,uc,uq,0),this._debugKey)for(uA=0;uA<uq.length;)ut.drawCircle(uq[uA++],uq[uA++],10,"#ff0000");uQ=uq,this._curves.length=u$;var uN=this._curves,uz=uQ[uK=0],uC=uQ[1],uL=0,uV=0,ux=0,uG=0,ul=0,uh=0,uv=NaN,uy=NaN,ua=NaN,uu=NaN,uD=NaN,us=NaN,uY=NaN,uH=NaN,uI=0;for(uA=0,uI=2;uA<u$;uA++,uI+=6)uL=uQ[uI],uV=uQ[uI+1],ux=uQ[uI+2],uG=uQ[uI+3],uD=2*(uv=.1875*(uz-2*uL+ux))+(ua=.09375*(3*(uL-ux)-uz+(ul=uQ[uI+4]))),us=2*(uy=.1875*(uC-2*uV+uG))+(uu=.09375*(3*(uV-uG)-uC+(uh=uQ[uI+5]))),uY=.75*(uL-uz)+uv+.16666667*ua,uH=.75*(uV-uC)+uy+.16666667*uu,uK+=Math.sqrt(uY*uY+uH*uH),uY+=uD,uH+=us,uD+=ua,us+=uu,uK+=Math.sqrt(uY*uY+uH*uH),uY+=uD,uH+=us,uK+=Math.sqrt(uY*uY+uH*uH),uY+=uD+ua,uH+=us+uu,uK+=Math.sqrt(uY*uY+uH*uH),uN[uA]=uK,uz=ul,uC=uh;if(uE&&(uR*=uK),uO)for(uA=0;uA<ud;uA++)um[uA]*=uK;var ug=this._segments,uf=0,uw=0;for(uw=uS=uo=uA=0;uA<ud;uA++,uo+=3)if((uM=uR+=uZ=um[uA])<0)this.addBeforePosition(uM,uQ,0,uT,uo);else if(uK<uM)this.addAfterPosition(uM-uK,uQ,uc-4,uT,uo);else{for(;;uS++)if(!((u_=uN[uS])<uM)){0==uS?uM/=u_:uM=(uM-(uX=uN[uS-1]))/(u_-uX);break}if(uS!=ue){var uU=6*(ue=uS);for(uz=uQ[uU],uC=uQ[uU+1],uL=uQ[uU+2],uV=uQ[uU+3],ux=uQ[uU+4],uG=uQ[uU+5],uD=2*(uv=.03*(uz-2*uL+ux))+(ua=.006*(3*(uL-ux)-uz+(ul=uQ[uU+6]))),us=2*(uy=.03*(uC-2*uV+uG))+(uu=.006*(3*(uV-uG)-uC+(uh=uQ[uU+7]))),uY=.3*(uL-uz)+uv+.16666667*ua,uH=.3*(uV-uC)+uy+.16666667*uu,uf=Math.sqrt(uY*uY+uH*uH),ug[0]=uf,uU=1;uU<8;uU++)uY+=uD,uH+=us,uD+=ua,us+=uu,uf+=Math.sqrt(uY*uY+uH*uH),ug[uU]=uf;uY+=uD,uH+=us,uf+=Math.sqrt(uY*uY+uH*uH),ug[8]=uf,uY+=uD+ua,uH+=us+uu,uf+=Math.sqrt(uY*uY+uH*uH),ug[9]=uf,uw=0}for(uM*=uf;;uw++)if(!((u_=ug[uw])<uM)){0==uw?uM/=u_:uM=uw+(uM-(uX=ug[uw-1]))/(u_-uX);break}this.addCurvePosition(.1*uM,uz,uC,uL,uV,ux,uG,ul,uh,uT,uo,ub||0<uA&&0==uZ)}return uT},uW.addBeforePosition=function(uW,uj,ut,ud,ub){var uE=uj[ut],uO=uj[ut+1],uq=uj[ut+2]-uE,uA=uj[ut+3]-uO,uc=Math.atan2(uA,uq);ud[ub]=uE+uW*Math.cos(uc),ud[ub+1]=uO+uW*Math.sin(uc),ud[ub+2]=uc},uW.addAfterPosition=function(uW,uj,ut,ud,ub){var uE=uj[ut+2],uO=uj[ut+3],uq=uE-uj[ut],uA=uO-uj[ut+1],uc=Math.atan2(uA,uq);ud[ub]=uE+uW*Math.cos(uc),ud[ub+1]=uO+uW*Math.sin(uc),ud[ub+2]=uc},uW.addCurvePosition=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR,um){0==uW&&(uW=1e-4);var uQ=uW*uW,uT=uQ*uW,u$=1-uW,ue=u$*u$,uK=ue*u$,uo=u$*uW,uS=3*uo,uM=u$*uS,uZ=uS*uW,uX=uj*uK+ud*uM+uE*uZ+uq*uT,u_=ut*uK+ub*uM+uO*uZ+uA*uT;uc[uR]=uX,uc[uR+1]=u_,uc[uR+2]=um?Math.atan2(u_-(ut*ue+ub*uo*2+uO*uQ),uX-(uj*ue+ud*uo*2+uE*uQ)):0},uv.NONE=-1,uv.BEFORE=-2,uv.AFTER=-3,ut(uv,["_tempMt",function(){return this._tempMt=new ulW}]),uv}(),uIW=function(){function uW(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return ud(uW,"laya.ani.bone.PathConstraintData"),uW}(),ugW=function(){function uW(){this.name=null,this.slotArr=[]}return ud(uW,"laya.ani.bone.SkinData"),uW}(),ufW=function(){function uW(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}ud(uW,"laya.ani.bone.SkinSlotDisplayData");var uj=uW.prototype;return uj.createTexture=function(uW){return this.texture||(this.texture=new uhW(uW.bitmap,this.uvs),uW.bitmap.alphaTexture&&(this.texture.alphaTexture=new uhW(uW.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=uW.height,this.texture.height=uW.width,this.texture.offsetX=-uW.offsetX,this.texture.offsetY=-uW.offsetY,this.texture.sourceWidth=uW.sourceHeight,this.texture.sourceHeight=uW.sourceWidth):(this.texture.width=uW.width,this.texture.height=uW.height,this.texture.offsetX=-uW.offsetX,this.texture.offsetY=-uW.offsetY,this.texture.sourceWidth=uW.sourceWidth,this.texture.sourceHeight=uW.sourceHeight),uK.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},uj.destory=function(){this.texture&&this.texture.destroy()},uW}(),uwW=function(){function uW(){this.name=null,this.displayArr=[]}return ud(uW,"laya.ani.bone.SlotData"),uW.prototype.getDisplayByName=function(uW){for(var uj=0,ut=this.displayArr.length;uj<ut;uj++)if(this.displayArr[uj].attachmentName==uW)return uj;return-1},uW}(),u_=function(){function uW(uW,uj){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=ue(2,0),this._data=uW,null==this._bones&&(this._bones=[]),this.target=uj[uW.targetIndex];var ut,ud=0;for(ud=0,ut=uW.boneIndexs.length;ud<ut;ud++)this._bones.push(uj[uW.boneIndexs[ud]]);this.rotateMix=uW.rotateMix,this.translateMix=uW.translateMix,this.scaleMix=uW.scaleMix,this.shearMix=uW.shearMix}return ud(uW,"laya.ani.bone.TfConstraint"),uW.prototype.apply=function(){for(var uW,uj=this.target.resultMatrix.a,ut=this.target.resultMatrix.b,ud=this.target.resultMatrix.c,ub=this.target.resultMatrix.d,uE=0,uO=this._bones.length;uE<uO;uE++){if(uW=this._bones[uE],0<this.rotateMix){var uq=uW.resultMatrix.a,uA=uW.resultMatrix.b,uc=uW.resultMatrix.c,uR=uW.resultMatrix.d,um=Math.atan2(ud,uj)-Math.atan2(uc,uq)+this._data.offsetRotation*Math.PI/180;um>Math.PI?um-=2*Math.PI:um<-Math.PI&&(um+=2*Math.PI),um*=this.rotateMix;var uQ=Math.cos(um),uT=Math.sin(um);uW.resultMatrix.a=uQ*uq-uT*uc,uW.resultMatrix.b=uQ*uA-uT*uR,uW.resultMatrix.c=uT*uq+uQ*uc,uW.resultMatrix.d=uT*uA+uQ*uR}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),uW.resultMatrix.tx+=(this._temp[0]-uW.resultMatrix.tx)*this.translateMix,uW.resultMatrix.ty+=(this._temp[1]-uW.resultMatrix.ty)*this.translateMix,uW.updateChild()),0<this.scaleMix){var u$=Math.sqrt(uW.resultMatrix.a*uW.resultMatrix.a+uW.resultMatrix.c*uW.resultMatrix.c),ue=Math.sqrt(uj*uj+ud*ud),uK=1e-5<u$?(u$+(ue-u$+this._data.offsetScaleX)*this.scaleMix)/u$:0;uW.resultMatrix.a*=uK,uW.resultMatrix.c*=uK,u$=Math.sqrt(uW.resultMatrix.b*uW.resultMatrix.b+uW.resultMatrix.d*uW.resultMatrix.d),ue=Math.sqrt(ut*ut+ub*ub),uK=1e-5<u$?(u$+(ue-u$+this._data.offsetScaleY)*this.scaleMix)/u$:0,uW.resultMatrix.b*=uK,uW.resultMatrix.d*=uK}if(0<this.shearMix){uA=uW.resultMatrix.b,uR=uW.resultMatrix.d;var uo=Math.atan2(uR,uA);(um=Math.atan2(ub,ut)-Math.atan2(ud,uj)-(uo-Math.atan2(uW.resultMatrix.c,uW.resultMatrix.a)))>Math.PI?um-=2*Math.PI:um<-Math.PI&&(um+=2*Math.PI),um=uo+(um+this._data.offsetShearY*Math.PI/180)*this.shearMix,uK=Math.sqrt(uA*uA+uR*uR),uW.resultMatrix.b=Math.cos(um)*uK,uW.resultMatrix.d=Math.sin(um)*uK}}},uW}(),uUW=function(){function uW(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return ud(uW,"laya.ani.bone.TfConstraintData"),uW}(),uJW=function(){function uW(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}ud(uW,"laya.ani.bone.Transform");var uj=uW.prototype;return uj.initData=function(uW){null!=uW.x&&(this.x=uW.x),null!=uW.y&&(this.y=uW.y),null!=uW.skX&&(this.skX=uW.skX),null!=uW.skY&&(this.skY=uW.skY),null!=uW.scX&&(this.scX=uW.scX),null!=uW.scY&&(this.scY=uW.scY)},uj.getMatrix=function(){var uW;return(uW=this.mMatrix?this.mMatrix:this.mMatrix=new ulW).identity(),uW.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(uW,this.skewX*Math.PI/180,this.skewY*Math.PI/180),uW.rotate(this.skX*Math.PI/180),uW.translate(this.x,this.y),uW},uj.skew=function(uW,uj,ut){var ud=Math.sin(ut),ub=Math.cos(ut),uE=Math.sin(uj),uO=Math.cos(uj);return uW.setTo(uW.a*uO-uW.b*ud,uW.a*uE+uW.b*ub,uW.c*uO-uW.d*ud,uW.c*uE+uW.d*ub,uW.tx*uO-uW.ty*ud,uW.tx*uE+uW.ty*ub),uW},uW}(),uN=function(){function uW(){}return ud(uW,"laya.ani.bone.UVTools"),uW.getRelativeUV=function(uW,uj,ut){var ud=uW[0],ub=uW[2]-uW[0],uE=uW[1],uO=uW[5]-uW[1];ut||(ut=[]),ut.length=uj.length;var uq,uA=0;uq=ut.length;var uc=1/ub,uR=1/uO;for(uA=0;uA<uq;uA+=2)ut[uA]=(uj[uA]-ud)*uc,ut[uA+1]=(uj[uA+1]-uE)*uR;return ut},uW.getAbsoluteUV=function(uW,uj,ut){if(0==uW[0]&&0==uW[1]&&1==uW[4]&&1==uW[5])return ut?(uo.copyArray(ut,uj),ut):uj;var ud=uW[0],ub=uW[2]-uW[0],uE=uW[1],uO=uW[5]-uW[1];ut||(ut=[]),ut.length=uj.length;var uq,uA=0;for(uq=ut.length,uA=0;uA<uq;uA+=2)ut[uA]=uj[uA]*ub+ud,ut[uA+1]=uj[uA+1]*uO+uE;return ut},uW}(),uv=function(){function uW(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return ud(uW,"laya.ani.KeyFramesContent"),uW}(),uz=function(){function uR(){}return ud(uR,"laya.ani.math.BezierLerp"),uR.getBezierRate=function(uW,uj,ut,ud,ub){var uE=uR._getBezierParamKey(uj,ut,ud,ub),uO=100*uE+uW;if(uR._bezierResultCache[uO])return uR._bezierResultCache[uO];var uq,uA=uR._getBezierPoints(uj,ut,ud,ub,uE),uc=0;for(uq=uA.length,uc=0;uc<uq;uc+=2)if(uW<=uA[uc])return uR._bezierResultCache[uO]=uA[uc+1],uA[uc+1];return uR._bezierResultCache[uO]=1},uR._getBezierParamKey=function(uW,uj,ut,ud){return 100*(100*(100*(100*uW+uj)+ut)+ud)},uR._getBezierPoints=function(uW,uj,ut,ud,ub){return uR._bezierPointsCache[ub]?uR._bezierPointsCache[ub]:(uE=[0,0,uW,uj,ut,ud,1,1],uO=(new uq).getBezierPoints(uE,100,3),uR._bezierPointsCache[ub]=uO);var uE,uO},uR._bezierResultCache={},uR._bezierPointsCache={},uR}(),uC=function(uW){function uj(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,uj.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}ud(uj,"laya.ani.AnimationPlayer",ub);var ut=uj.prototype;return ubW.imps(ut,{"laya.resource.IDestroy":!0}),ut._onTempletLoadedComputeFullKeyframeIndices=function(uW,uj,ut){this._templet===ut&&this._cachePlayRate===uW&&this._cacheFrameRate===uj&&this._computeFullKeyframeIndices()},ut._computeFullKeyframeIndices=function(){for(var uW=this._fullFrames=[],uj=this._templet,ut=this._cacheFrameRateInterval*this._cachePlayRate,ud=0,ub=uj.getAnimationCount();ud<ub;ud++){for(var uE=[],uO=0,uq=uj.getAnimation(ud).nodes.length;uO<uq;uO++){for(var uA=uj.getAnimation(ud).nodes[uO],uc=Math.floor(uA.playTime/ut+.01),uR=new Uint16Array(uc+1),um=-1,uQ=0,uT=uA.keyFrame.length;uQ<uT;uQ++){var u$=uA.keyFrame[uQ],ue=u$.startTime,uK=ue+u$.duration+ut;do{for(var uo=Math.floor(ue/ut+.5),uS=um+1;uS<uo;uS++)uR[uS]=uQ;uR[um=uo]=uQ,ue+=ut}while(ue<=uK)}uE.push(uR)}uW.push(uE)}},ut._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},ut._calculatePlayDuration=function(){if(0!==this.state){var uW=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=uW),this._playEnd>uW&&(this._playEnd=uW),this._playDuration=this._playEnd-this._playStart}},ut._setPlayParams=function(uW,uj){this._currentTime=uW,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/uj+.01),0),this._currentFrameTime=this._currentKeyframeIndex*uj},ut._setPlayParamsWhenStop=function(uW,uj){this._currentTime=uW,this._currentKeyframeIndex=Math.max(Math.floor(uW/uj+.01),0),this._currentFrameTime=this._currentKeyframeIndex*uj,this._currentAnimationClipIndex=-1},ut._update=function(uW){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var uj=this._cacheFrameRateInterval*this._cachePlayRate,ut=0;this._startUpdateLoopCount!==u$.loopCount&&(ut=uW*this.playbackRate,this._elapsedPlaybackTime+=ut);var ud=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=ud)return this._setPlayParamsWhenStop(ud,uj),void this.event("stopped");if(ut+=this._currentTime,0<ud)if(ud<=ut)do{if(ut-=ud,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(ud,uj),this._stopWhenCircleFinish=!1,void this.event("stopped");ut<ud&&(this._setPlayParams(ut,uj),this.event("complete"))}while(ud<=ut);else this._setPlayParams(ut,uj);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(ud,uj),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},ut._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},ut.play=function(uW,uj,ut,ud,ub){if(void 0===uW&&(uW=0),void 0===uj&&(uj=1),void 0===ut&&(ut=2147483647),void 0===ud&&(ud=0),void 0===ub&&(ub=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(ut<0||ud<0||ub<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==ub&&ub<ud)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=uj,this._overallDuration=ut,this._playStart=ud,this._playEnd=ub,this._paused=!1,this._currentAnimationClipIndex=uW,this._currentKeyframeIndex=0,this._startUpdateLoopCount=u$.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},ut.playByFrame=function(uW,uj,ut,ud,ub,uE){void 0===uW&&(uW=0),void 0===uj&&(uj=1),void 0===ut&&(ut=2147483647),void 0===ud&&(ud=0),void 0===ub&&(ub=0),void 0===uE&&(uE=30);var uO=1e3/uE;this.play(uW,uj,ut,ud*uO,ub*uO)},ut.stop=function(uW){void 0===uW&&(uW=!0),uW?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},uE(0,ut,"playEnd",function(){return this._playEnd}),uE(0,ut,"templet",function(){return this._templet},function(uW){0===!this.state&&this.stop(!0),this._templet!==uW&&((this._templet=uW).loaded?this._computeFullKeyframeIndices():uW.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),uE(0,ut,"playStart",function(){return this._playStart}),uE(0,ut,"playDuration",function(){return this._playDuration}),uE(0,ut,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),uE(0,ut,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),uE(0,ut,"overallDuration",function(){return this._overallDuration}),uE(0,ut,"currentFrameTime",function(){return this._currentFrameTime}),uE(0,ut,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),uE(0,ut,"currentPlayTime",function(){return this._currentTime+this._playStart}),uE(0,ut,"cachePlayRate",function(){return this._cachePlayRate},function(uW){this._cachePlayRate!==uW&&(this._cachePlayRate=uW,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[uW,this._cacheFrameRate])))}),uE(0,ut,"cacheFrameRate",function(){return this._cacheFrameRate},function(uW){this._cacheFrameRate!==uW&&(this._cacheFrameRate=uW,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,uW])))}),uE(0,ut,"currentTime",null,function(uW){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(uW<this._playStart||uW>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=u$.loopCount;var uj=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=uW,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/uj),0),this._currentFrameTime=this._currentKeyframeIndex*uj}}),uE(0,ut,"paused",function(){return this._paused},function(uW){(this._paused=uW)&&this.event("paused")}),uE(0,ut,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),uE(0,ut,"destroyed",function(){return this._destroyed}),uj}(),uy=function(uW){function uj(){uj.__super.call(this),uK.isConchNode&&(this.drawSkin=function(uW){uW.transform||(uW.transform=ulW.EMPTY),this._addCmd([uW]),this.setSkinMesh&&this.setSkinMesh(uW._ps,uW.mVBData,uW.mEleNum,0,uW.mTexture,uW.transform)})}return ud(uj,"laya.ani.GraphicsAni",uO),uj.prototype.drawSkin=function(uW){var uj=[uW];this._saveToCmd(uK._context._drawSkin,uj)},uj.create=function(){return uj._caches.pop()||new uj},uj.recycle=function(uW){uW.clear(),uj._caches.push(uW)},uj._caches=[],uj}(),ua=function(uW){function uS(){this._aniMap={},this.unfixedLastAniIndex=-1,uS.__super.call(this),this._anis=new Array}ud(uS,"laya.ani.AnimationTemplet",uR);var uj=uS.prototype;return uj.parse=function(uW){var uj=new uGW(uW);this._aniVersion=uj.readUTFString(),uM.parse(this,uj)},uj._calculateKeyFrame=function(uW,uj,ut){var ud=uW.keyFrame;ud[uj]=ud[0];for(var ub=0;ub<uj;ub++){var uE=ud[ub];uE.nextData=0===uE.duration?uE.data:ud[ub+1].data}ud.length--},uj.onAsynLoaded=function(uW,uj,ut){var ud=new uGW(uj);switch(this._aniVersion=ud.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":uZ.parse(this,ud);break;default:uM.parse(this,ud)}this._endLoaded()},uj.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},uj.getAnimationCount=function(){return this._anis.length},uj.getAnimation=function(uW){return this._anis[uW]},uj.getAniDuration=function(uW){return this._anis[uW].playTime},uj.getNodes=function(uW){return this._anis[uW].nodes},uj.getNodeIndexWithName=function(uW,uj){return this._anis[uW].bone3DMap[uj]},uj.getNodeCount=function(uW){return this._anis[uW].nodes.length},uj.getTotalkeyframesLength=function(uW){return this._anis[uW].totalKeyframeDatasLength},uj.getPublicExtData=function(){return this._publicExtData},uj.getAnimationDataWithCache=function(uW,uj,ut,ud){var ub=uj[ut];if(ub){var uE=ub[uW];return uE?uE[ud]:null}return null},uj.setAnimationDataWithCache=function(uW,uj,ut,ud,ub){var uE=uj[ut]||(uj[ut]={});(uE[uW]||(uE[uW]=[]))[ud]=ub},uj.getOriginalData=function(uW,uj,ut,ud,ub){for(var uE=this._anis[uW].nodes,uO=0,uq=0,uA=uE.length,uc=0;uq<uA;uq++){var uR,um=uE[uq];uR=um.keyFrame[ut[uq][ud]],um.dataOffset=uc;var uQ=ub-uR.startTime,uT=um.lerpType;if(uT)switch(uT){case 0:case 1:for(uO=0;uO<um.keyframeWidth;)uO+=um.interpolationMethod[uO](um,uO,uj,uc+uO,uR.data,uQ,null,uR.duration,uR.nextData);break;case 2:var u$=uR.interpolationData,ue=u$.length,uK=0;for(uO=0;uO<ue;){var uo=u$[uO];switch(uo){case 6:case 7:uO+=uS.interpolation[uo](um,uK,uj,uc+uK,uR.data,uQ,null,uR.duration,uR.nextData,u$,uO+1);break;default:uO+=uS.interpolation[uo](um,uK,uj,uc+uK,uR.data,uQ,null,uR.duration,uR.nextData)}uK++}}else for(uO=0;uO<um.keyframeWidth;)uO+=um.interpolationMethod[uO](um,uO,uj,uc+uO,uR.data,uQ,null,uR.duration,uR.nextData);uc+=um.keyframeWidth}},uj.getNodesCurrentFrameIndex=function(uW,uj){var ut=this._anis[uW].nodes;uW!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(ut.length),this.unfixedCurrentTimes=new Float32Array(ut.length),this.unfixedLastAniIndex=uW);for(var ud=0,ub=ut.length;ud<ub;ud++){var uE=ut[ud];for(uj<this.unfixedCurrentTimes[ud]&&(this.unfixedCurrentFrameIndexes[ud]=0),this.unfixedCurrentTimes[ud]=uj;this.unfixedCurrentFrameIndexes[ud]<uE.keyFrame.length&&!(uE.keyFrame[this.unfixedCurrentFrameIndexes[ud]].startTime>this.unfixedCurrentTimes[ud]);)this.unfixedCurrentFrameIndexes[ud]++;this.unfixedCurrentFrameIndexes[ud]--}return this.unfixedCurrentFrameIndexes},uj.getOriginalDataUnfixedRate=function(uW,uj,ut){var ud=this._anis[uW].nodes;uW!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(ud.length),this.unfixedCurrentTimes=new Float32Array(ud.length),this.unfixedKeyframes=ue(ud.length),this.unfixedLastAniIndex=uW);for(var ub=0,uE=0,uO=ud.length,uq=0;uE<uO;uE++){var uA=ud[uE];for(ut<this.unfixedCurrentTimes[uE]&&(this.unfixedCurrentFrameIndexes[uE]=0),this.unfixedCurrentTimes[uE]=ut;this.unfixedCurrentFrameIndexes[uE]<uA.keyFrame.length&&!(uA.keyFrame[this.unfixedCurrentFrameIndexes[uE]].startTime>this.unfixedCurrentTimes[uE]);)this.unfixedKeyframes[uE]=uA.keyFrame[this.unfixedCurrentFrameIndexes[uE]],this.unfixedCurrentFrameIndexes[uE]++;var uc=this.unfixedKeyframes[uE];uA.dataOffset=uq;var uR=ut-uc.startTime;if(uA.lerpType)switch(uA.lerpType){case 0:case 1:for(ub=0;ub<uA.keyframeWidth;)ub+=uA.interpolationMethod[ub](uA,ub,uj,uq+ub,uc.data,uR,null,uc.duration,uc.nextData);break;case 2:var um=uc.interpolationData,uQ=um.length,uT=0;for(ub=0;ub<uQ;){var u$=um[ub];switch(u$){case 6:case 7:ub+=uS.interpolation[u$](uA,uT,uj,uq+uT,uc.data,uR,null,uc.duration,uc.nextData,um,ub+1);break;default:ub+=uS.interpolation[u$](uA,uT,uj,uq+uT,uc.data,uR,null,uc.duration,uc.nextData)}uT++}}else for(ub=0;ub<uA.keyframeWidth;)ub+=uA.interpolationMethod[ub](uA,ub,uj,uq+ub,uc.data,uR,null,uc.duration,uc.nextData);uq+=uA.keyframeWidth}},uS._LinearInterpolation_0=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){var uR=0===uq?0:uE/uq;return ut[ud]=(1-uR)*ub[uj]+uR*uA[uj],1},uS._QuaternionInterpolation_1=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){var uR=0===uq?0:uE/uq;return uQ.slerpQuaternionArray(ub,uj,uA,uj,uR,ut,ud),4},uS._AngleInterpolation_2=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){return 0},uS._RadiansInterpolation_3=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){return 0},uS._Matrix4x4Interpolation_4=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){for(var uR=0;uR<16;uR++,uj++)ut[ud+uR]=ub[uj]+uE*uO[uj];return 16},uS._NoInterpolation_5=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc){return ut[ud]=ub[uj],1},uS._BezierInterpolation_6=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR){return void 0===uR&&(uR=0),ut[ud]=ub[uj]+(uA[uj]-ub[uj])*uz.getBezierRate(uE/uq,uc[uR],uc[uR+1],uc[uR+2],uc[uR+3]),5},uS._BezierInterpolation_7=function(uW,uj,ut,ud,ub,uE,uO,uq,uA,uc,uR){return void 0===uR&&(uR=0),ut[ud]=uc[uR+4]+uc[uR+5]*uz.getBezierRate((.001*uE+uc[uR+6])/uc[uR+7],uc[uR],uc[uR+1],uc[uR+2],uc[uR+3]),9},uS.load=function(uW){return ubW.loader.create(uW,null,null,uS)},uS.interpolation=[uS._LinearInterpolation_0,uS._QuaternionInterpolation_1,uS._AngleInterpolation_2,uS._RadiansInterpolation_3,uS._Matrix4x4Interpolation_4,uS._NoInterpolation_5,uS._BezierInterpolation_6,uS._BezierInterpolation_7],uS}(),uL=function(uj){function ut(uW,uj){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,ut.__super.call(this),void 0===uj&&(uj=0),uW&&this.init(uW,uj)}ud(ut,"laya.ani.bone.Skeleton",uj);var uW=ut.prototype;return uW.init=function(uW,uj){void 0===uj&&(uj=0);var ut,ud,ub,uE=0,uO=0;if(1==uj)for(this._graphicsCache=[],uE=0,uO=uW.getAnimationCount();uE<uO;uE++)this._graphicsCache.push([]);if(this._yReverseMatrix=uW.yReverseMatrix,this._aniMode=uj,this._templet=uW,this._player=new uC,this._player.cacheFrameRate=uW.rate,this._player.templet=uW,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=uW.mBoneArr,this._rootBone=uW.mRootBone,this._aniSectionDic=uW.aniSectionDic,0<uW.ikArr.length)for(this._ikArr=[],uE=0,uO=uW.ikArr.length;uE<uO;uE++)this._ikArr.push(new uS(uW.ikArr[uE],this._boneList));if(0<uW.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),uE=0,uO=uW.pathArr.length;uE<uO;uE++)ut=uW.pathArr[uE],ud=new uX(ut,this._boneList),(ub=this._boneSlotDic[ut.name])&&((ud=new uX(ut,this._boneList)).target=ub),this._pathDic[ut.name]=ud;if(0<uW.tfArr.length)for(this._tfArr=[],uE=0,uO=uW.tfArr.length;uE<uO;uE++)this._tfArr.push(new u_(uW.tfArr[uE],this._boneList));if(0<uW.skinDataArray.length){var uq=this._templet.skinDataArray[this._skinIndex];this._skinName=uq.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},uW.load=function(uW,uj,ut){},uW._onLoaded=function(){},uW._parseComplete=function(){var uW=uV.TEMPLET_DICTIONARY[this._aniPath];uW&&(this.init(uW,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},uW._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},uW._onPlay=function(){this.event("played")},uW._onStop=function(){var uW,uj=this._templet.eventAniArr[this._aniClipIndex];if(uj&&this._eventIndex<uj.length)for(;this._eventIndex<uj.length;this._eventIndex++)(uW=uj[this._eventIndex]).time>=this._player.playStart&&uW.time<=this._player.playEnd&&this.event("label",uW);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},uW._onPause=function(){this.event("paused")},uW._parseSrcBoneMatrix=function(){var uW=0,uj=0;for(uj=this._templet.srcBoneMatrixArr.length,uW=0;uW<uj;uW++)this._boneMatrixArray.push(new ulW);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var ut,ud,ub=this._templet.boneSlotArray;for(uW=0,uj=ub.length;uW<uj;uW++)ut=ub[uW],null==(ud=this._bindBoneBoneSlotDic[ut.parent])&&(this._bindBoneBoneSlotDic[ut.parent]=ud=[]),this._boneSlotDic[ut.name]=ut=ut.copy(),ud.push(ut),this._boneSlotArray.push(ut)}},uW._emitMissedEvents=function(uW,uj,ut){void 0===ut&&(ut=0);var ud=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(ud){var ub,uE,uO=0;for(ub=ud.length,uO=ut;uO<ub;uO++)(uE=ud[uO]).time>=this._player.playStart&&uE.time<=this._player.playEnd&&this.event("label",uE)}},uW._update=function(uW){if(void 0===uW&&(uW=!0),!(this._pause||uW&&this._indexControl)){var uj=this.timer.currTimer,ut=this._player.currentKeyframeIndex,ud=uj-this._lastTime;if(uW?this._player._update(ud):ut=-1,this._lastTime=uj,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<ud&&this._clipIndex==ut&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var ub;this._lastUpdateAniClipIndex=this._aniClipIndex,ut>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var uE,uO=this._templet.eventAniArr[this._aniClipIndex];if(uO&&this._eventIndex<uO.length&&((ub=uO[this._eventIndex]).time>=this._player.playStart&&ub.time<=this._player.playEnd?this._player.currentPlayTime>=ub.time&&(this.event("label",ub),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(uE=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=uE&&(this.graphics=uE));var uq=0,uA=0;for(uA=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,uA-1)&&0<uA;)uA--;if(uA<this._clipIndex)for(uq=uA;uq<this._clipIndex;uq++)this._createGraphics(uq)}else if(1==this._aniMode){if(uE=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=uE&&(this.graphics=uE));for(uA=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,uA-1)&&0<uA;)uA--;if(uA<this._clipIndex)for(uq=uA;uq<this._clipIndex;uq++)this._createGraphics(uq)}this._createGraphics()}}},uW._createGraphics=function(uW){void 0===uW&&(uW=-1),-1==uW&&(uW=this._clipIndex);var uj,ut,ud=uW*this._player.cacheFrameRateInterval,ub=this._templet.drawOrderAniArr[this._aniClipIndex];if(ub&&0<ub.length)for(this._drawOrderIndex=0,uj=ub[this._drawOrderIndex];ud>=uj.time&&(this._drawOrder=uj.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=ub.length));)uj=ub[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=uy.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=uy.create(),ut=this.graphics;var uE=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],uW,ud);var uO,uq,uA,uc,uR=this._aniSectionDic[this._aniClipIndex],um=0,uQ=0,uT=0,u$=0,ue=0,uK=this._templet.srcBoneMatrixArr.length;for(ue=uR[uQ=0];uQ<uK;uQ++)uc=this._boneList[uQ],uA=this._templet.srcBoneMatrixArr[uQ],uc.resultTransform.scX=uA.scX*this._curOriginalData[um++],uc.resultTransform.skX=uA.skX+this._curOriginalData[um++],uc.resultTransform.skY=uA.skY+this._curOriginalData[um++],uc.resultTransform.scY=uA.scY*this._curOriginalData[um++],uc.resultTransform.x=uA.x+this._curOriginalData[um++],uc.resultTransform.y=uA.y+this._curOriginalData[um++],8===this._templet.tMatrixDataLen&&(uc.resultTransform.skewX=uA.skewX+this._curOriginalData[um++],uc.resultTransform.skewY=uA.skewY+this._curOriginalData[um++]);var uo,uS={},uM={};for(ue+=uR[1];uQ<ue;uQ++)uS[(uo=uE[uQ]).name]=this._curOriginalData[um++],uM[uo.name]=this._curOriginalData[um++],this._curOriginalData[um++],this._curOriginalData[um++],this._curOriginalData[um++],this._curOriginalData[um++];var uZ,uX,u_={},uN={};for(ue+=uR[2];uQ<ue;uQ++)u_[(uo=uE[uQ]).name]=this._curOriginalData[um++],uN[uo.name]=this._curOriginalData[um++],this._curOriginalData[um++],this._curOriginalData[um++],this._curOriginalData[um++],this._curOriginalData[um++];if(this._pathDic)for(ue+=uR[3];uQ<ue;uQ++){if(uo=uE[uQ],uZ=this._pathDic[uo.name])switch(new uGW(uo.extenData).getByte()){case 1:uZ.position=this._curOriginalData[um++];break;case 2:uZ.spacing=this._curOriginalData[um++];break;case 3:uZ.rotateMix=this._curOriginalData[um++],uZ.translateMix=this._curOriginalData[um++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(ulW.TEMP.identity()),this._ikArr)for(uQ=0,ue=this._ikArr.length;uQ<ue;uQ++)uX=this._ikArr[uQ],u_.hasOwnProperty(uX.name)&&(uX.bendDirection=u_[uX.name]),uN.hasOwnProperty(uX.name)&&(uX.mix=uN[uX.name]),uX.apply();if(this._pathDic)for(var uz in this._pathDic)(uZ=this._pathDic[uz]).apply(this._boneList,ut);if(this._tfArr)for(uQ=0,u$=this._tfArr.length;uQ<u$;uQ++)this._tfArr[uQ].apply();for(uQ=0,u$=this._boneList.length;uQ<u$;uQ++)if(uc=this._boneList[uQ],uq=this._bindBoneBoneSlotDic[uc.name],uc.resultMatrix.copyTo(this._boneMatrixArray[uQ]),uq)for(uT=0,ue=uq.length;uT<ue;uT++)(uO=uq[uT])&&uO.setParentMatrix(uc.resultMatrix);var uC,uL,uV,ux,uG={},ul=this._templet.deformAniArr;if(ul&&0<ul.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,uQ=0,ue=this._boneSlotArray.length;uQ<ue;uQ++)(uO=this._boneSlotArray[uQ]).deformData=null;var uh,uv=ul[this._aniClipIndex];for(uh in uC=uv.default,this._setDeform(uC,uG,this._boneSlotArray,ud),uv)"default"!=uh&&uh!=this._skinName&&(uC=uv[uh],this._setDeform(uC,uG,this._boneSlotArray,ud));uC=uv[this._skinName],this._setDeform(uC,uG,this._boneSlotArray,ud)}if(this._drawOrder)for(uQ=0,ue=this._drawOrder.length;uQ<ue;uQ++)uL=uS[(uO=this._boneSlotArray[this._drawOrder[uQ]]).name],uV=uM[uO.name],isNaN(uV)||(ut.save(),ut.alpha(uV)),isNaN(uL)||-2==uL||(this._templet.attachmentNames?uO.showDisplayByName(this._templet.attachmentNames[uL]):uO.showDisplayByIndex(uL)),uG[this._drawOrder[uQ]]?(ux=uG[this._drawOrder[uQ]],uO.currDisplayData&&ux[uO.currDisplayData.attachmentName]?uO.deformData=ux[uO.currDisplayData.attachmentName]:uO.deformData=null):uO.deformData=null,isNaN(uV)?uO.draw(ut,this._boneMatrixArray,2==this._aniMode):uO.draw(ut,this._boneMatrixArray,2==this._aniMode,uV),isNaN(uV)||ut.restore();else for(uQ=0,ue=this._boneSlotArray.length;uQ<ue;uQ++)uL=uS[(uO=this._boneSlotArray[uQ]).name],uV=uM[uO.name],isNaN(uV)||(ut.save(),ut.alpha(uV)),isNaN(uL)||-2==uL||(this._templet.attachmentNames?uO.showDisplayByName(this._templet.attachmentNames[uL]):uO.showDisplayByIndex(uL)),uG[uQ]?(ux=uG[uQ],uO.currDisplayData&&ux[uO.currDisplayData.attachmentName]?uO.deformData=ux[uO.currDisplayData.attachmentName]:uO.deformData=null):uO.deformData=null,isNaN(uV)?uO.draw(ut,this._boneMatrixArray,2==this._aniMode):uO.draw(ut,this._boneMatrixArray,2==this._aniMode,uV),isNaN(uV)||ut.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,uW,ut):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,uW,ut)},uW._setDeform=function(uW,uj,ut,ud){if(uW){var ub,uE,uO,uq=0,uA=0,uc=0;if(uW)for(uq=0,uA=uW.deformSlotDataList.length;uq<uA;uq++)for(ub=uW.deformSlotDataList[uq],uc=0;uc<ub.deformSlotDisplayList.length;uc++)uO=ut[(uE=ub.deformSlotDisplayList[uc]).slotIndex],uE.apply(ud,uO),uj[uE.slotIndex]||(uj[uE.slotIndex]={}),uj[uE.slotIndex][uE.attachment]=uE.deformData}},uW.getAnimNum=function(){return this._templet.getAnimationCount()},uW.getAniNameByIndex=function(uW){return this._templet.getAniNameByIndex(uW)},uW.getSlotByName=function(uW){return this._boneSlotDic[uW]},uW.showSkinByName=function(uW,uj){void 0===uj&&(uj=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(uW),uj)},uW.showSkinByIndex=function(uW,uj){void 0===uj&&(uj=!0);for(var ut=0;ut<this._boneSlotArray.length;ut++)this._boneSlotArray[ut].showSlotData(null,uj);if(this._templet.showSkinByIndex(this._boneSlotDic,uW,uj)){var ud=this._templet.skinDataArray[uW];this._skinIndex=uW,this._skinName=ud.name}this._clearCache()},uW.showSlotSkinByIndex=function(uW,uj){if(0!=this._aniMode){var ut=this.getSlotByName(uW);ut&&ut.showDisplayByIndex(uj),this._clearCache()}},uW.showSlotSkinByName=function(uW,uj){if(0!=this._aniMode){var ut=this.getSlotByName(uW);ut&&ut.showDisplayByName(uj),this._clearCache()}},uW.replaceSlotSkinName=function(uW,uj,ut){if(0!=this._aniMode){var ud=this.getSlotByName(uW);ud&&ud.replaceDisplayByName(uj,ut),this._clearCache()}},uW.replaceSlotSkinByIndex=function(uW,uj,ut){if(0!=this._aniMode){var ud=this.getSlotByName(uW);ud&&ud.replaceDisplayByIndex(uj,ut),this._clearCache()}},uW.setSlotSkin=function(uW,uj){if(0!=this._aniMode){var ut=this.getSlotByName(uW);ut&&ut.replaceSkin(uj),this._clearCache()}},uW._clearCache=function(){if(1==this._aniMode)for(var uW=0,uj=this._graphicsCache.length;uW<uj;uW++){for(var ut=0,ud=this._graphicsCache[uW].length;ut<ud;ut++){var ub=this._graphicsCache[uW][ut];ub!=this.graphics&&uy.recycle(ub)}this._graphicsCache[uW].length=0}},uW.play=function(uW,uj,ut,ud,ub,uE){void 0===ut&&(ut=!0),void 0===ud&&(ud=0),void 0===ub&&(ub=0),void 0===uE&&(uE=!0),this._indexControl=!1;var uO=-1,uq=NaN;if(uq=uj?2147483647:0,"string"==typeof uW)for(var uA=0,uc=this._templet.getAnimationCount();uA<uc;uA++){var uR=this._templet.getAnimation(uA);if(uR&&uW==uR.name){uO=uA;break}}else uO=uW;-1<uO&&uO<this.getAnimNum()&&(this._aniClipIndex=uO,(ut||this._pause||this._currAniIndex!=uO)&&(this._currAniIndex=uO,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(uO)),this._drawOrder=null,this._eventIndex=0,this._player.play(uO,this._player.playbackRate,uq,ud,ub),uE&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=um.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},uW.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},uW.playbackRate=function(uW){this._player&&(this._player.playbackRate=uW)},uW.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},uW.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=um.now(),this.timer.frameLoop(1,this,this._update,null,!0))},uW._getGrahicsDataWithCache=function(uW,uj){return this._graphicsCache[uW][uj]},uW._setGrahicsDataWithCache=function(uW,uj,ut){this._graphicsCache[uW][uj]=ut},uW.destroy=function(uW){void 0===uW&&(uW=!0),uj.prototype.destroy.call(this,uW),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},uE(0,uW,"url",function(){return this._aniPath},function(uW){this.load(uW)}),uE(0,uW,"index",function(){return this._index},function(uW){this.player&&(this._index=uW,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),uE(0,uW,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),uE(0,uW,"templet",function(){return this._templet}),uE(0,uW,"player",function(){return this._player}),ut.useSimpleMeshInCanvas=!1,ut}(uEW),uV=function(uj){function ub(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,ub.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}ud(ub,"laya.ani.bone.Templet",uj);var uW=ub.prototype;return uW.getLoadList=function(){return this._loadList},uW.loadAni=function(uW){this._skBufferUrl=uW,ubW.loader.load(uW,uA.create(this,this.onComplete),null,"arraybuffer")},uW.onComplete=function(uW){if(this._isDestroyed)this.destroy();else{var uj=uc.getRes(this._skBufferUrl);uj?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,uj)):this.event("error","load failed:"+this._skBufferUrl)}},uW.parseData=function(uW,uj,ut){void 0===ut&&(ut=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=uW,this._mainTexture&&uK.isWebGL&&uW.bitmap&&(uW.bitmap.enableMerageInAtlas=!1),this._rate=ut,this.parse(uj)},uW.buildArmature=function(uW){return void 0===uW&&(uW=0),new uL(this,uW)},uW.parse=function(uW){uj.prototype.parse.call(this,uW),this._endLoaded(),this._aniVersion!=ub.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+ub.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},uW._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var uW=0;this._loadList=[];var uj,ut=new uGW(this.getPublicExtData()),ud=0,ub=0,uE=0,uO=ut.getInt32(),uq=ut.readUTFString(),uA=uq.split("\n");for(uW=0;uW<uO;uW++)uj=this._path+uA[2*uW],uq=uA[2*uW+1],ut.getFloat32(),ut.getFloat32(),ud=ut.getFloat32(),ub=ut.getFloat32(),uE=ut.getFloat32(),isNaN(uE)?0:uE,uE=ut.getFloat32(),isNaN(uE)?0:uE,uE=ut.getFloat32(),isNaN(uE)?ud:uE,uE=ut.getFloat32(),isNaN(uE)?ub:uE,-1==this._loadList.indexOf(uj)&&this._loadList.push(uj);this.event("inited",this)}},uW._textureComplete=function(){for(var uW,uj,ut=0,ud=this._loadList.length;ut<ud;ut++)uj=this._loadList[ut],uW=this._textureDic[uj]=uc.getRes(uj),uK.isWebGL&&uW&&uW.bitmap&&(uW.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},uW._parsePublicExtData=function(){var uW=0,uj=0,ut=0,ud=0,ub=0;for(uW=0,ub=this.getAnimationCount();uW<ub;uW++)this._graphicsCache.push([]);var uE;uE="Dragon"!=this._aniClassName;var uO,uq,uA=new uGW(this.getPublicExtData()),uc=0,uR=0,um=0,uQ=0,uT=0,u$=0,ue=0,uK=0,uo=0,uS=uA.getInt32(),uM=uA.readUTFString(),uZ=uM.split("\n");for(uW=0;uW<uS;uW++){if(uO=this._mainTexture,uq=this._path+uZ[2*uW],uM=uZ[2*uW+1],null==this._mainTexture&&(uO=this._textureDic[uq]),!uO)return this.event("error",this),void(this.isParseFail=!0);uc=uA.getFloat32(),uR=uA.getFloat32(),um=uA.getFloat32(),uQ=uA.getFloat32(),uo=uA.getFloat32(),uT=isNaN(uo)?0:uo,uo=uA.getFloat32(),u$=isNaN(uo)?0:uo,uo=uA.getFloat32(),ue=isNaN(uo)?um:uo,uo=uA.getFloat32(),uK=isNaN(uo)?uQ:uo,this.subTextureDic[uM]=uhW.create(uO,uc,uR,um,uQ,-uT,-u$,ue,uK),uO.alphaTexture&&(this.subTextureDic[uM].alphaTexture=uhW.create(uO.alphaTexture,uc,uR,um,uQ,-uT,-u$,ue,uK))}this._mainTexture=uO;var uX,u_,uN,uz,uC,uL=uA.getUint16();for(uW=0;uW<uL;uW++)(uX=[]).push(uA.getUint16()),uX.push(uA.getUint16()),uX.push(uA.getUint16()),uX.push(uA.getUint16()),this.aniSectionDic[uW]=uX;var uV,ux=uA.getInt16(),uG={};for(uW=0;uW<ux;uW++)u_=new uvW,0==uW?uV=u_:u_.root=uV,u_.d=uE?-1:1,uz=uA.readUTFString(),uC=uA.readUTFString(),u_.length=uA.getFloat32(),1==uA.getByte()&&(u_.inheritRotation=!1),1==uA.getByte()&&(u_.inheritScale=!1),u_.name=uz,uC&&((uN=uG[uC])?uN.addChild(u_):this.mRootBone=u_),uG[uz]=u_,this.mBoneArr.push(u_);this.tMatrixDataLen=uA.getUint16();var ul,uh,uv=uA.getUint16(),uy=Math.floor(uv/this.tMatrixDataLen),ua=this.srcBoneMatrixArr;for(uW=0;uW<uy;uW++)(ul=new uJW).scX=uA.getFloat32(),ul.skX=uA.getFloat32(),ul.skY=uA.getFloat32(),ul.scY=uA.getFloat32(),ul.x=uA.getFloat32(),ul.y=uA.getFloat32(),8===this.tMatrixDataLen&&(ul.skewX=uA.getFloat32(),ul.skewY=uA.getFloat32()),ua.push(ul),(u_=this.mBoneArr[uW]).transform=ul;var uu,uD=uA.getUint16(),us=0;for(uW=0;uW<uD;uW++){for(uh=new uHW,us=uA.getUint16(),uj=0;uj<us;uj++)uh.boneNames.push(uA.readUTFString()),uh.boneIndexs.push(uA.getInt16());uh.name=uA.readUTFString(),uh.targetBoneName=uA.readUTFString(),uh.targetBoneIndex=uA.getInt16(),uh.bendDirection=uA.getFloat32(),uh.mix=uA.getFloat32(),uh.isSpine=uE,this.ikArr.push(uh)}var uY,uH=uA.getUint16(),uI=0;for(uW=0;uW<uH;uW++){for(uu=new uUW,uI=uA.getUint16(),uj=0;uj<uI;uj++)uu.boneIndexs.push(uA.getInt16());uu.name=uA.getUTFString(),uu.targetIndex=uA.getInt16(),uu.rotateMix=uA.getFloat32(),uu.translateMix=uA.getFloat32(),uu.scaleMix=uA.getFloat32(),uu.shearMix=uA.getFloat32(),uu.offsetRotation=uA.getFloat32(),uu.offsetX=uA.getFloat32(),uu.offsetY=uA.getFloat32(),uu.offsetScaleX=uA.getFloat32(),uu.offsetScaleY=uA.getFloat32(),uu.offsetShearY=uA.getFloat32(),this.tfArr.push(uu)}var ug=uA.getUint16(),uf=0;for(uW=0;uW<ug;uW++){for((uY=new uIW).name=uA.readUTFString(),uf=uA.getUint16(),uj=0;uj<uf;uj++)uY.bones.push(uA.getInt16());uY.target=uA.readUTFString(),uY.positionMode=uA.readUTFString(),uY.spacingMode=uA.readUTFString(),uY.rotateMode=uA.readUTFString(),uY.offsetRotation=uA.getFloat32(),uY.position=uA.getFloat32(),uY.spacing=uA.getFloat32(),uY.rotateMix=uA.getFloat32(),uY.translateMix=uA.getFloat32(),this.pathArr.push(uY)}var uw,uU,uJ,ur,uP,ui=0,uB=0,un=0,uk=NaN,up=0,uF=uA.getInt16();for(uW=0;uW<uF;uW++){var uWW=uA.getUint8(),ujW={};this.deformAniArr.push(ujW);for(var utW=0;utW<uWW;utW++)for((uw=new uaW).skinName=uA.getUTFString(),ujW[uw.skinName]=uw,ui=uA.getInt16(),uj=0;uj<ui;uj++)for(uU=new uuW,uw.deformSlotDataList.push(uU),uB=uA.getInt16(),ut=0;ut<uB;ut++)for(uJ=new uDW,uU.deformSlotDisplayList.push(uJ),uJ.slotIndex=uA.getInt16(),uJ.attachment=uA.getUTFString(),un=uA.getInt16(),ud=0;ud<un;ud++)for(1==uA.getByte()?uJ.tweenKeyList.push(!0):uJ.tweenKeyList.push(!1),uk=uA.getFloat32(),uJ.timeList.push(uk),ur=[],uJ.vectices.push(ur),up=uA.getInt16(),ub=0;ub<up;ub++)ur.push(uA.getFloat32())}var udW,ubW,uEW=uA.getInt16(),uOW=0,uqW=0;for(uW=0;uW<uEW;uW++){for(uOW=uA.getInt16(),uP=[],uj=0;uj<uOW;uj++){for((udW=new usW).time=uA.getFloat32(),uqW=uA.getInt16(),ut=0;ut<uqW;ut++)udW.drawOrder.push(uA.getInt16());uP.push(udW)}this.drawOrderAniArr.push(uP)}var uAW,ucW=uA.getInt16(),uRW=0;for(uW=0;uW<ucW;uW++){for(uRW=uA.getInt16(),ubW=[],uj=0;uj<uRW;uj++)(uAW=new uYW).name=uA.getUTFString(),uAW.intValue=uA.getInt32(),uAW.floatValue=uA.getFloat32(),uAW.stringValue=uA.getUTFString(),uAW.time=uA.getFloat32(),ubW.push(uAW);this.eventAniArr.push(ubW)}var umW=uA.getInt16();if(0<umW)for(this.attachmentNames=[],uW=0;uW<umW;uW++)this.attachmentNames.push(uA.getUTFString());var uQW,uTW,u$W=uA.getInt16();for(uW=0;uW<u$W;uW++)(uQW=new uyW).name=uA.readUTFString(),uQW.parent=uA.readUTFString(),uQW.attachmentName=uA.readUTFString(),uQW.srcDisplayIndex=uQW.displayIndex=uA.getInt16(),(uQW.templet=this).boneSlotDic[uQW.name]=uQW,null==(uTW=this.bindBoneBoneSlotDic[uQW.parent])&&(this.bindBoneBoneSlotDic[uQW.parent]=uTW=[]),uTW.push(uQW),this.boneSlotArray.push(uQW);var ueW,uKW,uoW,uSW=uA.readUTFString().split("\n"),uMW=0,uZW=uA.getUint8(),uXW=0,u_W=0,uNW=0,uzW=0,uCW=0,uLW=0,uVW=0;for(uW=0;uW<uZW;uW++){for((ueW=new ugW).name=uSW[uMW++],uXW=uA.getUint8(),uj=0;uj<uXW;uj++){for((uKW=new uwW).name=uSW[uMW++],uQW=this.boneSlotDic[uKW.name],u_W=uA.getUint8(),ut=0;ut<u_W;ut++){if(uoW=new ufW,this.skinSlotDisplayDataArr.push(uoW),uoW.name=uSW[uMW++],uoW.attachmentName=uSW[uMW++],uoW.transform=new uJW,uoW.transform.scX=uA.getFloat32(),uoW.transform.skX=uA.getFloat32(),uoW.transform.skY=uA.getFloat32(),uoW.transform.scY=uA.getFloat32(),uoW.transform.x=uA.getFloat32(),uoW.transform.y=uA.getFloat32(),uKW.displayArr.push(uoW),uoW.width=uA.getFloat32(),uoW.height=uA.getFloat32(),uoW.type=uA.getUint8(),uoW.verLen=uA.getUint16(),0<(ux=uA.getUint16()))for(uoW.bones=[],ud=0;ud<ux;ud++){var uxW=uA.getUint16();uoW.bones.push(uxW)}if(0<(uNW=uA.getUint16()))for(uoW.uvs=[],ud=0;ud<uNW;ud++)uoW.uvs.push(uA.getFloat32());if(0<(uzW=uA.getUint16()))for(uoW.weights=[],ud=0;ud<uzW;ud++)uoW.weights.push(uA.getFloat32());if(0<(uCW=uA.getUint16()))for(uoW.triangles=[],ud=0;ud<uCW;ud++)uoW.triangles.push(uA.getUint16());if(0<(uLW=uA.getUint16()))for(uoW.vertices=[],ud=0;ud<uLW;ud++)uoW.vertices.push(uA.getFloat32());if(0<(uVW=uA.getUint16()))for(uoW.lengths=[],ud=0;ud<uVW;ud++)uoW.lengths.push(uA.getFloat32())}ueW.slotArr.push(uKW)}this.skinDic[ueW.name]=ueW,this.skinDataArray.push(ueW)}1==uA.getUint8()?(this.yReverseMatrix=new ulW(1,0,0,-1,0,0),uV&&uV.setTempMatrix(this.yReverseMatrix)):uV&&uV.setTempMatrix(new ulW),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},uW.getTexture=function(uW){var uj=this.subTextureDic[uW];return uj||(uj=this.subTextureDic[uW.substr(0,uW.length-1)]),null==uj?this._mainTexture:uj},uW.showSkinByIndex=function(uW,uj,ut){if(void 0===ut&&(ut=!0),uj<0&&uj>=this.skinDataArray.length)return!1;var ud,ub,uE=0,uO=0,uq=this.skinDataArray[uj];if(uq){for(uE=0,uO=uq.slotArr.length;uE<uO;uE++)(ub=uq.slotArr[uE])&&(ud=uW[ub.name])&&(ud.showSlotData(ub,ut),ut&&"undefined"!=ud.attachmentName&&"null"!=ud.attachmentName?ud.showDisplayByName(ud.attachmentName):ud.showDisplayByIndex(ud.displayIndex));return!0}return!1},uW.getSkinIndexByName=function(uW){for(var uj=0,ut=this.skinDataArray.length;uj<ut;uj++)if(this.skinDataArray[uj].name==uW)return uj;return-1},uW.getGrahicsDataWithCache=function(uW,uj){return this._graphicsCache[uW][uj]},uW.setGrahicsDataWithCache=function(uW,uj,ut){this._graphicsCache[uW][uj]=ut},uW.destroy=function(){var uW;for(var uj in this._isDestroyed=!0,this.subTextureDic)(uW=this.subTextureDic[uj])&&uW.destroy();for(uj in this._textureDic)(uW=this._textureDic[uj])&&uW.destroy();for(var ut=0,ud=this.skinSlotDisplayDataArr.length;ut<ud;ut++)this.skinSlotDisplayDataArr[ut].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete ub.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},uW.getAniNameByIndex=function(uW){var uj=this.getAnimation(uW);return uj?uj.name:null},uE(0,uW,"rate",function(){return this._rate},function(uW){this._rate=uW}),ub.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",ub.TEMPLET_DICTIONARY=null,ub}(ua)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(uW,uj){"use strict";for(var ut in Object.defineProperty(uj,"__esModule",{value:!0}),Laya){var ud=Laya[ut];ud&&ud.__isclass&&(uj[ut]=ud)}});