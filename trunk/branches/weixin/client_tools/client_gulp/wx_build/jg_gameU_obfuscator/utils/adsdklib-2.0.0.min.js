var NsdvkmV1=require("./reportjs.min.js");var mKcVYKlqh2=require("md5Encryp");let bannerAd=null;let interstitialAd=null;let rewardedVideoAd=null;let ADCONFIG={GETADCODE_API:"https://ad-api.39ej7e.com/sdk/getAdCodeID",API_KEY:"Jp*4Y8vQOYck2*&Z"};let adsdkGlobal={adVersion:"2.0.0",dev:"",refer:"",pid:"",gid:"",adUnitIdConfig:[],adUnitIdLink:{}};var qsL3={appid:"sdk",adversion:adsdkGlobal.adVersion};wx.getSystemInfo({success:function(e){adsdkGlobal.dev=mKcVYKlqh2(e.model),adsdkGlobal.SDKVersion=e.SDKVersion,-1!=e.system.toLowerCase().indexOf("ios")?qsL3.os=2:-1!=e.system.toLowerCase().indexOf("android")?qsL3.os=1:qsL3.os=3,qsL3.osversion=e.system,qsL3.brand=e.brand,qsL3.mode=e.model,qsL3.hpi=e.screenHeight,qsL3.wpi=e.screenWidth,qsL3.wx_version=e.version,qsL3.wx_sdkversion=e.SDKVersion,qsL3.wx_benchmarkLevel=e.benchmarkLevel,qsL3.wx_albumAuthorized=e.albumAuthorized,qsL3.wx_cameraAuthorized=e.cameraAuthorized,qsL3.wx_locationAuthorized=e.locationAuthorized,qsL3.wx_microphoneAuthorized=e.microphoneAuthorized,qsL3.wx_notificationAuthorized=e.notificationAuthorized,qsL3.wx_notificationAlertAuthorized=e.notificationAlertAuthorized,qsL3.wx_notificationBadgeAuthorized=e.notificationBadgeAuthorized,qsL3.wx_notificationSoundAuthorized=e.notificationSoundAuthorized,qsL3.wx_bluetoothEnabled=e.bluetoothEnabled,qsL3.wx_locationEnabled=e.locationEnabled,qsL3.wx_wifiEnabled=e.wifiEnabled,qsL3.densit=e.pixelRatio}}),module.exports={initADSDK:(e,d)=>{adsdkGlobal.pid=e.pid,adsdkGlobal.gid=e.gid,adsdkGlobal.sversion=e.sversion,qsL3.sversion=e.sversion,qsL3.pid=e.pid,qsL3.gid=e.gid,qsL3.cid=e.cid,qsL3.refer=e.refer,qsL3.dev=e.dev,qsL3.wx_onshow=e.wx_onshow,qsL3.wx_aid=e.wx_aid,qsL3.uid=e.uid,qsL3.openid=e.openid,qsL3.ad_income_platform=4,selfMiddle.getAdConfig(function(e){d(e)})},adSceneReach:(e,d)=>{let a=JSON.parse(JSON.stringify(selfMiddle.joinGameParams(e)));a.event="ad_income_locationshow",NsdvkmV1.dataReportSend(a),d()},bannerAdCreate:(d,a)=>{var e;bannerAd&&(bannerAd.destroy(),bannerAd=null),ADSDkUtil.compareVersion(adsdkGlobal.SDKVersion,"2.0.4")<0?wx.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"}):(e=selfMiddle.getAdUnitId(adsdkGlobal.adUnitIdConfig,d.adIncomeLocation,"banner"),adsdkGlobal.adUnitIdLink.banner=e,(bannerAd=wx.createBannerAd({adUnitId:e.ad_code,adIntervals:d.adIntervals,style:d.bannerStyle})).onLoad(()=>{let e=JSON.parse(JSON.stringify(selfMiddle.joinGameParams(d)));e.ad_income_type=2,e.adUnitId=adsdkGlobal.adUnitIdLink.banner.ad_code,e.event="ad_income_initok",NsdvkmV1.dataReportSend(e),a&&a()}),bannerAd.onError(e=>{console.log(e)}))},bannerAdShow:(d,a)=>{bannerAd?bannerAd.show().then(()=>{let e=JSON.parse(JSON.stringify(selfMiddle.joinGameParams(d)));e.ad_income_type=2,e.event="ad_income_succ",e.adUnitId=adsdkGlobal.adUnitIdLink.banner.ad_code,NsdvkmV1.dataReportSend(e),a&&a()}).catch(e=>{console.log(e)}):console.log("\u6ca1\u6709\u521b\u5efa\u5e7f\u544a\u5b9e\u4f8b")},bannerAdHide:(e,d)=>{bannerAd&&(bannerAd.hide(),d&&d())},bannerAdDestroy:(e,d)=>{bannerAd&&(bannerAd.destroy(),bannerAd=null,d&&d())},interstitialAdCreate:(d,a,e)=>{var i;interstitialAd&&(interstitialAd.destroy(),interstitialAd=null),ADSDkUtil.compareVersion(adsdkGlobal.SDKVersion,"2.6.0")<0?wx.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"}):(i=selfMiddle.getAdUnitId(adsdkGlobal.adUnitIdConfig,d.adIncomeLocation,"interaction"),adsdkGlobal.adUnitIdLink.interactionr=i,(interstitialAd=wx.createInterstitialAd({adUnitId:i.ad_code})).onLoad(()=>{let e=JSON.parse(JSON.stringify(selfMiddle.joinGameParams(d)));e.ad_income_type=3,e.event="ad_income_initok",e.adUnitId=adsdkGlobal.adUnitIdLink.interaction.ad_code,NsdvkmV1.dataReportSend(e),a&&a()}),interstitialAd.onClose(()=>{console.log("\u63d2\u5c4f\u5e7f\u544a\u5173\u95ed"),e&&e()}),interstitialAd.onError(e=>{console.log("\u63d2\u5c4f\u5e7f\u544a\u52a0\u8f7d\u5931\u8d25",e)}))},interstitialAdShow:(d,a)=>{interstitialAd&&interstitialAd.show().then(()=>{let e=JSON.parse(JSON.stringify(selfMiddle.joinGameParams(d)));e.ad_income_type=3,e.event="ad_income_succ",e.adUnitId=adsdkGlobal.adUnitIdLink.interaction.ad_code,NsdvkmV1.dataReportSend(e),a&&a()}).catch(e=>{console.log(e)})},interstitialAdDestroy:(e,d)=>{interstitialAd&&(interstitialAd.destroy(),d&&d())},rewardedVideoAdCreate:(d,a,i)=>{var e;ADSDkUtil.compareVersion(adsdkGlobal.SDKVersion,"2.0.4")<0?wx.showModal({title:"\u63d0\u793a",content:"\u5f53\u524d\u5fae\u4fe1\u7248\u672c\u8fc7\u4f4e\uff0c\u65e0\u6cd5\u4f7f\u7528\u8be5\u529f\u80fd\uff0c\u8bf7\u5347\u7ea7\u5230\u6700\u65b0\u5fae\u4fe1\u7248\u672c\u540e\u91cd\u8bd5\u3002"}):(rewardedVideoAd&&(rewardedVideoAd.offLoad(),rewardedVideoAd.offClose(),0<=ADSDkUtil.compareVersion(adsdkGlobal.SDKVersion,"2.8.0")&&rewardedVideoAd.destroy(),rewardedVideoAd=null),e=selfMiddle.getAdUnitId(adsdkGlobal.adUnitIdConfig,d.adIncomeLocation,"rewardvideo"),adsdkGlobal.adUnitIdLink.rewardvideo=e,(rewardedVideoAd=wx.createRewardedVideoAd({adUnitId:e.ad_code,multiton:!0})).onClose(e=>{if(e.isEnded){let e=JSON.parse(JSON.stringify(selfMiddle.joinGameParams(d)));e.event="ad_income_complete",e.ad_income_type=1,e.adUnitId=adsdkGlobal.adUnitIdLink.rewardvideo.ad_code,NsdvkmV1.dataReportSend(e)}i&&i(e)}),rewardedVideoAd.onError(e=>{console.log(e)}),rewardedVideoAd.onLoad(()=>{let e=JSON.parse(JSON.stringify(selfMiddle.joinGameParams(d)));e.event="ad_income_initok",e.ad_income_type=1,e.adUnitId=adsdkGlobal.adUnitIdLink.rewardvideo.ad_code,NsdvkmV1.dataReportSend(e),a&&a()}))},rewardedVideoAdShow:(d,a)=>{rewardedVideoAd?rewardedVideoAd.show().then(()=>{let e=JSON.parse(JSON.stringify(selfMiddle.joinGameParams(d)));e.event="ad_income_succ",e.ad_income_type=1,e.adUnitId=adsdkGlobal.adUnitIdLink.rewardvideo.ad_code,NsdvkmV1.dataReportSend(e),a&&a()}).catch(e=>{console.log(e),rewardedVideoAd.load().then(e=>{rewardedVideoAd.show().then(()=>{let e=JSON.parse(JSON.stringify(selfMiddle.joinGameParams(d)));e.event="ad_income_succ",e.ad_income_type=1,e.adUnitId=adsdkGlobal.adUnitIdLink.rewardvideo.ad_code,NsdvkmV1.dataReportSend(e),a&&a()}).catch(e=>{console.log(e)})})}):console.log("\u8bf7\u5148\u521b\u5efa\u6fc0\u52b1\u89c6\u9891")},rewardedVideoAdDestory:(e,d)=>{rewardedVideoAd&&(rewardedVideoAd.offLoad(),rewardedVideoAd.offClose(),0<=ADSDkUtil.compareVersion(adsdkGlobal.SDKVersion,"2.8.0")&&rewardedVideoAd.destroy(),rewardedVideoAd=null,d&&d())},gridAdCreate:(e,d)=>{}};const selfMiddle={getAdConfig:d=>{let e={pid:adsdkGlobal.pid,gid:adsdkGlobal.gid,time:ADSDkUtil.getTime()};e.sign=ADSDkUtil.getSign(e,ADCONFIG.API_KEY),wx.request({url:ADCONFIG.GETADCODE_API,data:e,method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},success(e){1===e.data.state?(adsdkGlobal.adUnitIdConfig=e.data.data,d&&d(e.data.data)):console.log("\u83b7\u53d6\u5e7f\u544a\u5355\u5143\u5931\u8d25",JSON.stringify(e.data))},fail(e){console.log("\u8bf7\u6c42\u5931\u8d25:"+JSON.stringify(e))}})},joinGameParams:e=>{let d=JSON.parse(JSON.stringify(qsL3));return d.role_id=e.drid,d.role_name=e.drname,d.role_level=e.drlevel,d.vip_level=e.dviplevel,d.server_id=e.dsid,d.server_name=e.dsname,d.ad_income_location=e.adIncomeLocation||"default",d},getAdUnitId:(d,a,i)=>{let o={};for(let e=0;e<d.length;e+=1){if(d[e].ad_scene===a)return d[e];d[e].ad_type===i&&"default"===d[e].ad_scene&&(o=d[e])}return o}};let ADSDkUtil={u$7G80$:(d,a)=>{d=d.split("."),a=a.split(".");var i=window.Math.max(d.length,a.length);for(;d.length<i;)d.push("0");for(;a.length<i;)a.push("0");for(let e=0;e<i;e++){var o=window.parseInt(d[e]);var n=window.parseInt(a[e]);if(n<o)return 1;if(o<n)return-1}return 0},getTime:()=>window.Date.parse(new window.Date)/1e3,getSign:(d,e)=>{var a="";return d=ADSDkUtil.sortObject(d),window.Object.keys(d).forEach(function(e){e=e+"="+d[e];a+=e}),mKcVYKlqh2(a+=e)},sortObject:d=>{var e,a={},i=[];for(window.Object.keys(d).forEach(function(e){d.hasOwnProperty(e)&&i.push(e)}),i.sort(),e=0;e<i.length;e++)a[i[e]]=d[i[e]];return a}};