var o=wx.$U;import sdk from"../utils/sdklib-2.9.4.min.js";var config={game_id:256,game_pkg:o[341811],partner_label:o[341812],partner_id:o[341813],game_ver:o[341814],is_auth:!1,partner_android_pid_id:442,partner_ios_pid_id:484,partner_gid_id:1014883,partner_uid:0,tmpId:{1:o[341815],2:o[341816],3:o[341815]}};window.config=config;var u$7$80G=u$78G0$();var HOST=o[341817];var u$7$8G0=null;var u$780G$=null;var sysInfo=wx.getSystemInfoSync();var platform=sysInfo.platform;var partner_user_info=null;function u$78G0$(){var i={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0;console.log(o[341818]);var t=this;var n;n=wx.getStorageSync(o[341819])?0:(n=t.uuid(16,32),wx.setStorageSync(o[341819],n),1),wx.getStorageSync(o[341820])||(i=t.uuid(16,32),wx.setStorageSync(o[341820],i));var i=wx.getLaunchOptionsSync();var a=i.scene||"";n&&i.query&&i.query.ad_code&&wx.setStorageSync(o[341821],i.query.ad_code),t.log(o[341822],{install:n,scene:a}),wx.showShareMenu();t=i.query&&i.query.invite?i.query.invite:"";i=i.query&&i.query.invite_type?i.query.invite_type:"";t&&(u$780G$={invite:t,invite_type:i,is_new:n,scene:a}),e&&this.checkGameVersion(e,function(e){r&&r(e)})},login:function(e,r){console.log(o[341823]),i[o[340276]]=typeof r==o[341023]?r:null;var t=this;r={pid:sysInfo.platform==o[340111]?config.partner_android_pid_id:config.partner_ios_pid_id,gid:config.partner_gid_id};sdk.login(r,function(e){console.log(o[341824]+JSON.stringify(e)),t.do_login(e)})},do_login:function(e){var t=this;var r=t.getPublicData();if(r[o[341825]]=JSON.stringify(e),u$780G$&&typeof u$780G$==o[340923])for(var n in u$780G$)r[n]=u$780G$[n];wx.request({url:o[341826]+HOST+o[341827],method:o[340241],dataType:o[341268],header:{"content-type":o[340419]},data:r,success:function(e){if(console.log(o[341828]+JSON.stringify(e)),200==e.statusCode){e=e.data;if(e.state){config.partner_uid=e.data.ext.partner_uid;try{wx.setStorageSync(o[341829],e.data.sdk_token),wx.setStorageSync(o[341830],e.data.user_id),wx.setStorageSync(o[341831],e.data.username),e.data.ext&&wx.setStorageSync(o[341832],e.data.ext)}catch(e){}var r={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};i[o[340276]]&&i[o[340276]](0,r)}else i[o[340276]]&&i[o[340276]](1,{errMsg:e.msg});t.getShareInfo(o[341833],function(e){console.log(o[341834]),sdk.setShare({title:e.title,imageUrl:e.img},function(e){console.log(o[341835])})})}else i[o[340276]]&&i[o[340276]](1,{errMsg:o[341836]})}})},share:function(e){i[o[340377]]=typeof callback==o[341023]?callback:null;var r=e.type||o[340377];console.log(o[341837]+r);var t=this;this.getShareInfo(r,function(e){t.logStartShare(r);e.query;e={dsid:u$7$8G0.server_id,dsname:u$7$8G0.server_name,drid:u$7$8G0.role_id,drname:u$7$8G0.role_name,drlevel:u$7$8G0.role_level,drctime:u$7$8G0.role_createtime,acttime:(new Date).getTime(),title:e.title,imageUrl:e.img,gameScene:e.query,query:e.query};sdk.share(e,function(e){console.log(o[341838])})})},logStartShare:function(e){var r=wx.getStorageSync(o[341829]);wx.request({url:o[341826]+HOST+o[341839],method:o[340241],dataType:o[341268],header:{"content-type":o[340419]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:u$7$8G0?u$7$8G0.server_id:"",role_id:u$7$8G0?u$7$8G0.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,t){console.log(o[341840]);wx.getStorageSync(o[341829]);wx.request({url:o[341826]+HOST+o[341841],method:o[340241],dataType:o[341268],header:{"content-type":o[340419]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(o[341842]+JSON.stringify(e)),200==e.statusCode&&(r=e.data).state?t&&t(r.data):t&&t({develop:0})}})},getShareInfo:function(e,r){console.log(o[341843]);var t=wx.getStorageSync(o[341829]);wx.request({url:o[341826]+HOST+o[341844],method:o[340241],dataType:o[341268],header:{"content-type":o[340419]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,type:e,server_id:u$7$8G0?u$7$8G0.server_id:"",role_id:u$7$8G0?u$7$8G0.role_id:"",no_log:1},success:function(e){console.log(o[341845]),console.log(e),200==e.statusCode?(e=e.data).state?r&&r(e.data):i[o[340377]]&&i[o[340377]](1,{errMsg:o[341846]+e.msg}):i[o[340377]]&&i[o[340377]](1,{errMsg:o[341847]})}})},updateShare:function(e,r,t,n,i,a){console.log(o[341848]);var s=wx.getStorageSync(o[341829]);wx.request({url:o[341826]+HOST+o[341849],method:o[340241],dataType:o[341268],header:{"content-type":o[340419]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:s,invite:e,invite_type:r,is_new:t,role_id:n,sever_id:i,scene:a},success:function(e){console.log(o[341850]+JSON.stringify(e))}})},msgCheck:function(e,r){console.log(o[341851]+e);let t={data:{}};e={type:o[341852],data:{content:e}};sdk.checkSecurity(e,function(e){console.log(o[341853]+JSON.stringify(e)),1==e.state?(t.statusCode=200,t.data.state=1):(t.statusCode=0,t.data.state=0),r&&r(t)})},pay:function(e,o){this.startPay(e,o)},startPay:function(e,r){console.log(o[341854]+JSON.stringify(e));i[o[340359]]=typeof r==o[341023]?r:null;r=wx.getStorageSync(o[341829]);var t=wx.getStorageSync(o[341832]);r?(e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:r,session_key:t,platform:platform},this.order_data=e,(r=this.getPublicData())[o[341856]]=JSON.stringify(e),wx.request({url:o[341826]+HOST+o[341857],method:o[340241],dataType:o[341268],header:{"content-type":o[340419]},data:r,success:function(e){console.log(o[341858]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?sysInfo.platform==o[340111]?sdk.androidImport(e.data.pay_data,function(e){console.log(o[341859]+JSON.stringify(e))}):sdk.otherImport(e.data.pay_data,function(e){console.log(o[341859]+JSON.stringify(e))}):i[o[340359]]&&i[o[340359]](1,{errMsg:e.msg}):i[o[340276]]&&i[o[340276]](1,{errMsg:o[341836]})}})):i[o[340359]]&&i[o[340359]](1,{errMsg:o[341855]})},logCreateRole:function(e){var r=wx.getStorageSync(o[341830]);var t=wx.getStorageSync(o[341831]);var n={};n[o[341860]]=r,n[o[341861]]=t,n[o[341862]]=e.roleid,n[o[341863]]=e.rolelevel,n[o[341864]]=e.rolename,n[o[340024]]=e.serverid,e.roleid&&e.serverid&&(u$7$8G0={role_id:e.roleid,server_id:e.serverid}),this.log(o[340500],n);r=Date.parse(new Date).toString();r=r.substr(0,10);t={dsid:e.serverid,dsname:e.servername,drid:e.roleid,drname:e.rolename,drlevel:e.rolelevel,drctime:r,dpname:0,dviplevel:0,drbalance:0,drlevelmtime:0};sdk.createRole(t,function(e){console.log(o[341865]+JSON.stringify(e))})},logEnterGame:function(e){var r=wx.getStorageSync(o[341830]);var t=wx.getStorageSync(o[341831]);var n={};n[o[341860]]=r,n[o[341861]]=t,n[o[341862]]=e.roleid,n[o[341863]]=e.rolelevel,n[o[341864]]=e.rolename,n[o[340024]]=e.serverid,e.rolecreatetime=(e.rolecreatetime+"").substr(0,10),e.roleid&&e.serverid&&(u$7$8G0={role_id:e.roleid,server_id:e.serverid}),this.log(o[341866],n),u$780G$&&this.updateShare(u$780G$.invite,u$780G$.invite_type,u$780G$.is_new,e.roleid,e.serverid,u$780G$.scene);r={dsid:e.serverid,dsname:e.servername,drid:e.roleid,drname:e.rolename,drlevel:e.rolelevel,drctime:e.rolecreatetime,dpname:0,dviplevel:0,drbalance:0,drlevelmtime:0};sdk.enterGame(r,function(e){console.log(o[341867]+JSON.stringify(e))})},logRoleUpLevel:function(e){var r=wx.getStorageSync(o[341830]);var t=wx.getStorageSync(o[341831]);var n={};n[o[341860]]=r,n[o[341861]]=t,n[o[341862]]=e.roleid,n[o[341863]]=e.rolelevel,n[o[341864]]=e.rolename,n[o[340024]]=e.serverid,e.rolecreatetime=(e.rolecreatetime+"").substr(0,10),e.roleid&&e.serverid&&(u$7$8G0={role_id:e.roleid,server_id:e.serverid,server_name:e.servername,role_name:e.rolename,role_level:e.rolelevel,role_createtime:e.rolecreatetime}),this.log(o[341868],n);r={dsid:e.serverid,dsname:e.servername,drid:e.roleid,drname:e.rolename,drlevel:e.rolelevel,drctime:e.rolecreatetime,dpname:0,dviplevel:0,drbalance:0,drlevelmtime:0};sdk.roleLevelUp(r,function(e){console.log(o[341869]+JSON.stringify(e))})},uuid:function(e,r){var t=o[341870].split("");var n,i=[];var a;if(e=e||t.length,r)for(n=0;n<r;n++)i[n]=t[0|Math.random()*e];else for(i[8]=i[13]=i[18]=i[23]="-",i[14]="4",n=0;n<36;n++)i[n]||(a=0|16*Math.random(),i[n]=t[19==n?3&a|8:a]);return i.join("")},getPublicData:function(){var e=wx.getStorageSync(o[341819]);var r=wx.getStorageSync(o[341820]);var t=wx.getStorageSync(o[341821]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:t,uuid:e,idfv:r,mac:o[341871],is_from_min:1,dname:sysInfo.model,net_type:0==sysInfo.wifiSignal?"4G":o[341872],os_ver:sysInfo.system,sdk_ver:sysInfo.version,game_ver:config.game_ver,device:sysInfo.platform==o[340111]?1:2}},log:function(e,r){var t=this.getPublicData();for(var n in r)t[n]=r[n];console.log(o[341873]+e),console.log(t),wx.request({url:o[341826]+HOST+o[341874]+e+o[341875]+encodeURIComponent(JSON.stringify(t))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(){},setMessageToFriendQuery:function(e,o){e=e.activity_id;o(wx.setMessageToFriendQuery({shareMessageToFriendScene:e}))},subscribeMessage:function(e,r){console.log(o[341876]+e),i[o[340388]]=typeof r==o[341023]?r:null,wx.requestSubscribeMessage({tmplIds:e,success(e){console.log(o[341877]),console.log(e),i[o[340388]]&&i[o[340388]](e)},fail(e){console.log(o[341878]),console.log(e),i[o[340388]]&&i[o[340388]](e)}})}}}function run(e,o,r){e in u$7$80G&&u$7$80G[e](o,r)}exports.init=function(e,r){run(o[340254],e,r)},exports.login=function(e){run(o[340276],"",e)},exports.login=function(e){run(o[340276],"",e)},exports.pay=function(e,r){run(o[340359],e,r)},exports.openService=function(){run(o[340378])},exports.logCreateRole=function(e,r,t,n,i,a){run(o[340372],{serverid:e,servername:r,roleid:t,rolename:n,rolelevel:i,rolecreatetime:a})},exports.logEnterGame=function(e,r,t,n,i,a){run(o[340374],{serverid:e,servername:r,roleid:t,rolename:n,rolelevel:i,rolecreatetime:a})},exports.logRoleUpLevel=function(e,r,t,n,i,a){run(o[340376],{serverid:e,servername:r,roleid:t,rolename:n,rolelevel:i,rolecreatetime:a})},exports.share=function(e){run(o[340377],{type:e})},exports.msgCheck=function(e,r){run(o[340201],e,r)},exports.downloadClient=function(){run(o[341879])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(o[341880])},exports.weiduanHelper=function(){run(o[340380])},exports.setMessageToFriendQuery=function(e,r){run(o[341881],e,r)},exports.subscribeMessage=function(e,r){run(o[340388],e,r)};