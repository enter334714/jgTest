var G=wx.$G;module.exports=function(n){var o={};function a(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}return a.m=n,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=2)}([function(e,t,a){"use strict";var n={debug:!1,sence:"",huoIntervalTask:{ish:"ish",game_heart:"game_heart"},floatLoginInit:0,showModalType:!1,showModalTime:null,showModalData:"",userInfo:"",templateShow:1,mp_message:{subscribeShow:"",ts:"",clickcnt:""},baseParams:{app_id:"",client_id:"",format:"json"},gameParams:{"game-pkg_name":"","game-app_ver":"","game-h_ver":"","game-sdk_ver":"2.2.1","game-mp_id":""},agentParams:{"agent-ch":"","agent-sub_ch":""},deviceParams:{"device-device_id":"","device-mac":"","device-ip":"","device-brand":"","device-model":"","device-os":"","device-os_version":"","device-screen":"","device-net":"","device-imsi":"","device-longitude":"","device-latitude":"","device-userua":"","device-disk_space":"","device-open_time":"","device-is_charge":"","device-screen_luminance":"","device-has_sim":"","device-is_break":"","device-scenario":""},extParams:{query:""},setting:{showLoading:!0,loadingParams:{title:"\u52a0\u8f7d\u4e2d",mask:!0},showToast:!1,toastParams:{icon:"none"}},launchOptions:{},baseUrl:"https://mp.1tsdk.com",staticUrl:"https://mpstatic.1tsdk.com",channelId:"2000051"};try{n.gameParams["game-pkg_name"]=wx.canIUse?"":"game",wx.getSystemInfo({success:function(e){n.deviceParams["device-brand"]=encodeURIComponent(e.brand||""),n.deviceParams["device-model"]=encodeURIComponent(e.model),n.deviceParams["device-screen"]=encodeURIComponent(e.screenWidth+"x"+e.screenHeight),n.deviceParams["device-os"]="devtools"===e.platform?"android":encodeURIComponent(e.platform),n.deviceParams["device-os_version"]=encodeURIComponent(e.system)}}),wx.getNetworkType({success:function(e){n.deviceParams["device-net"]=encodeURIComponent(e.networkType)}}),wx.getScreenBrightness({success:function(e){n.deviceParams["device-screen_luminance"]=encodeURIComponent(parseInt(100*e.value))}})}catch(e){}e.exports=n},function(e,a,t){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i=s(t(0)),d=s(t(4));function s(e){return e&&e.__esModule?e:{default:e}}var c=void 0;function u(e){e.preventDefault();var t=(e=e.touches[0]).clientX,e=e.clientY;t>=(GameGlobal.innerWidth-218)/2&&t<=(GameGlobal.innerWidth-218)/2+218&&e>=(GameGlobal.innerHeight-258)/2&&e<=(GameGlobal.innerHeight-258)/2+218?wx.previewImage({urls:[c.data.image]}):(c.qrctx.clearRect(0,0,c.qrcvs.width,c.qrcvs.height),c.canvas.removeEventListener("touchstart",u))}e.exports={ajax:function(n){var o=this.setting(n.conf);return n.conf&&delete n.conf,n=this.params(n),i.default.debug&&console.log((new Date).getTime(),n.url,n.data),new Promise(function(t,a){wx.request(r({},n,{success:function(e){i.default.debug&&console.log((new Date).getTime(),n.url,e),200!==e.statusCode||!e.data||void 0!==e.data.code&&200!==e.data.code?(o.showToast&&(e.data&&e.data.msg&&(o.toastParams.title=e.data.msg),wx.showToast(o.toastParams)),a(e)):t(e)},fail:function(e){i.default.debug&&console.log((new Date).getTime(),n.url,e),o.showToast&&(e.errMsg&&(o.toastParams.title=e.errMsg),wx.showToast(o.toastParams)),a(e)}}))})},params:function(e){var t;return e.method=(e.method||"get").toUpperCase(),"POST"!==e.method||e.header||(e.header={"Content-Type":"application/x-www-form-urlencoded"}),e.private||(t=wx.getStorageSync("huo_userInfo"),i.default.deviceParams["device-scenario"]=this.getScene(),e.data=r({},i.default.baseParams,i.default.gameParams,i.default.agentParams,i.default.deviceParams,i.default.extParams,e.data,{"device-ext":encodeURIComponent(JSON.stringify(i.default.extParams)),token:t?t.user_token:"",ts:(new Date).getTime()})),e.data.sign=this.sign(e),/^http/.test(e.url)||(e.url=i.default.baseUrl+e.url),delete e.private,delete e.signUrl,e},setting:function(){return r({},i.default.setting,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},sign:function(t){var e="";e=t.data.channel_id?"&clientkey&MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDleNmoD8CwcsVduQnG7UAMqD2aYpwwwswmMLSKvwNZ6pQeC4ugwGaG3E8jfzRvMYzIUcCYkQ9uROuKiA3+LGZ9Zyvy3uIVycCcMwM88WgRMjospa2EoGVI4Ef8qcvbfPGC3vwdIKQRs4dnaG6yQsOcyVkgyRtDq4iQnnlG9Onw5QIDAQAB":"&clientkey&MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDHrJSESIbzCdsC0+zIwSn3ft9RGaau0izFCdXodH3i/sWgYcoF+wvbvAMB9336tpTYMSfbks4HfSyt8PDunChqyeCnnraj60DRrySOxAIbjjSAxVxI437R5qZt3mFbH1rgptLfi5RP3N6XIWDk8Ecw2XCdlqfDPiQhGCYleldsdQIDAQAB",t.app_key&&(e="app_key="+t.app_key);var a=(t.signUrl||t.url).substr(1),n=Object.keys(t.data).sort(),o="";return n.forEach(function(e){o+="&"+e+"="+t.data[e]}),t.app_key?(0,d.default)(o.substr(1)+"&"+e):(0,d.default)((t.method+"&"+encodeURIComponent(a)+"&"+encodeURIComponent(o.substr(1))+"&"+e).replace(/\(/g,"%28").replace(/\)/g,"%29"))},renderQRCode:function(e,t,a){var n=t.getContext("2d"),o=wx.createImage();o.src=a.image,o.onload=function(){n.lineJoin="round",n.lineWidth=30,n.strokeStyle="#ffffff",n.strokeRect((GameGlobal.innerWidth-240)/2,(GameGlobal.innerHeight-264)/2,240,264),n.fillStyle="#ffffff",n.fillRect((GameGlobal.innerWidth-220)/2,(GameGlobal.innerHeight-244)/2,220,244),n.fillStyle="#1A83FF",n.font="bold 14px PingFangSC-Medium",n.textAlign="center",n.fillText(a.intro,GameGlobal.innerWidth/2,(GameGlobal.innerHeight-258)/2+218+30,250),n.drawImage(o,(GameGlobal.innerWidth-218)/2,(GameGlobal.innerHeight-258)/2,218,218)},c={canvas:e,qrcvs:t,qrctx:n,data:a},e.addEventListener("touchstart",u)},removeOffScreen:function(){c&&(c.qrctx.clearRect(0,0,c.qrcvs.width,c.qrcvs.height),c.canvas.removeEventListener("touchstart",u))},filterObj:function(t,a){if("object"!==(void 0===t?"undefined":o(t))||!Array.isArray(a))throw new Error("\u53c2\u6570\u683c\u5f0f\u4e0d\u6b63\u786e");var n={};return Object.keys(t).filter(function(e){return a.includes(e)}).forEach(function(e){n[e]=t[e]}),n},huoInterval:function(e,t,a,n,o){var r=a,i="huo_"+o+"_delay",o="huo_"+o+"_interval_id",s=wx.getStorageSync(i)||0,d=wx.getStorageSync(o)||0;if(!r)return"";switch(a=0===parseInt(n)?1:a){case 1:return r=1,d&&clearInterval(d),"";case 2:if(r=2,parseInt(s)===parseInt(n)&&d)return d;r=3;break;case 3:r=3;break;default:return""}var c=1;3===r&&(d&&clearInterval(d),e(t,c)),wx.setStorageSync(i,n),d=setInterval(function(){e(t,++c)},1e3*n),wx.setStorageSync(o,d)},getScene:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=wx.getStorageSync("huo_first_scene"),a=0;try{var n;var o;wx.getEnterOptionsSync&&(n=wx.getEnterOptionsSync(),a=n.scene||0),a||(o=wx.getLaunchOptionsSync(),(a=o.scene||0)||wx.onShow(function(e){e.scene&&(a=e.scene)})),t||(t=a,wx.setStorageSync("huo_first_scene",t))}catch(e){}return e?t:a}}},function(e,t,a){"use strict";var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i=d(a(3)),f=d(a(0)),o=d(a(1));function d(e){return e&&e.__esModule?e:{default:e}}function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}e.exports={init:function(){var m=this,p=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return["app_id","mp_id","showLoading","loadingParams","showToast","toastParams","debug"].map(function(e){void 0!==p[e]&&("app_id"===e?f.default.baseParams[e]=p.app_id:"mp_id"===e?f.default.gameParams["game-mp_id"]=p.mp_id:"debug"===e?f.default.debug=p.debug:f.default.setting[e]=p[e])}),new Promise(function(e,u){if(p.app_id){var t=void 0===(t=(o=wx.getLaunchOptionsSync().query).q)?"":t,a=o.state,n=void 0===a?"":a,o=void 0===(a=o.scene)?"":a;if(t){a=decodeURIComponent(t).split("?")[1];try{a=a&&a.split("&");var r=!0,i=!1,s=void 0;try{for(var d,c=a[Symbol.iterator]();!(r=(d=c.next()).done);r=!0){var l=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){var a=e;var n=t;var o=[],r=!0,e=!1,t=void 0;try{for(var i,s=a[Symbol.iterator]();!(r=(i=s.next()).done)&&(o.push(i.value),!n||o.length!==n);r=!0);}catch(a){e=!0,t=a}finally{try{!r&&s.return&&s.return()}finally{if(e)throw t}}return o}throw new TypeError("Invalid attempt to destructure non-iterable instance")}(d.value.split("="),2),g=l[0],h=l[1];"huo_state"===g&&(n=h)}}catch(e){i=!0,s=e}finally{try{!r&&c.return&&c.return()}finally{if(i)throw s}}}catch(e){console.error(e)}f.default.launchOptions={ext:t,state:n},e(m.reversal())}else f.default.launchOptions={state:o||n||""},e({code:200,msg:"success"})}else u({code:400,msg:"failinit"})})},reversal:function(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(a,n){wx.login({success:function(e){var t;e.code?(o.data=Object.assign({},o.data,(c(t={},"device-ext",f.default.extParams),c(t,"ext",f.default.launchOptions.ext),c(t,"state",f.default.launchOptions.state),c(t,"code",e.code),t)),a(i.default.reversal(o))):n(e)},fail:function(e){n(e)}})})},cpUserCheck:function(){return i.default.cpUserCheck(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},login:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(a,t){i.default.wxLogin(n({},e)).then(function(e){var t=wx.getLaunchOptionsSync();t.query&&t.query.gdt_vid&&i.default.reportAdClick({data:{click_id:t.query&&t.query.gdt_vid||"",url:""}}),t=o.default.filterObj(e.data.userinfo,["mem_id","mg_mem_id","cp_user_token","avatar","username","gender","city","province","country"]),a({data:t,customer_service:e.data.customer_service,code:200,msg:"success"})},function(e){t({code:400,msg:e.msg||"faillogin"})})})},updateUserInfo:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(t,a){i.default.setUserInfo(e).then(function(e){t(n({},e,{code:200,msg:"success"}))},function(e){a({code:400,msg:e.msg||"failupdateUserInfo"})})})},checkPay:function(){return i.default.checkPay(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},mpPayQuery:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};var t;return e.data&&void 0!==e.data["order-order_id"]||(t=wx.getStorageSync("huo_orderInfo"),e.data=n({},e.data,{"order-order_id":t?t.order_id:""})),i.default.mpPayQuery(e)},getShareInfo:function(){return i.default.getShareInfo(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},addShareInfo:function(){return i.default.addShareInfo(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},updateRole:function(){return i.default.upRoleInfo(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},checkMsg:function(){return i.default.checkMsg(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},checkImg:function(){return i.default.checkImg(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},userCheckpay:function(){return i.default.userCheckpay(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},subscribe:function(){return i.default.mpApi(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},sendCode:function(){return i.default.sendCode(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},bindPhone:function(){return i.default.bindPhone(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},getShareQrcode:function(){return i.default.getShareQrcode(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},getUserInfo:function(){return i.default.getUserInfo(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},preOrder:function(e){return i.default.preOrder(e)},mpPay:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(t,a){i.default.mpPay(e).then(function(e){t({code:200,msg:"success"})},function(e){a({msg:e.errMsg||"fail"})})})},midasPay:function(){var o=this,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return new Promise(function(n,t){i.default.midasPay(r).then(function(e){r.conf={showLoading:!1,showToast:!1};var t=0,a=setInterval(function(){t++,o.midasPayQuery(r).then(function(e){2!==e.data.status&&12!==t||clearInterval(a)},function(e){})},15e3);n({code:200,msg:"success"})},function(e){t({msg:e.errMsg||"fail"})})})},midasPayQuery:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};var t;return e.data&&void 0!==e.data["order-order_id"]||(t=wx.getStorageSync("huo_orderInfo"),e.data=n({},e.data,{"order-order_id":t?t.order_id:""})),i.default.midasPayQuery(e)},checkOrderInfo:function(){return i.default.checkOrderInfo(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},checkOrder:function(){return i.default.checkOrder(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},checkQrcode:function(){return new Promise(function(e,t){e({code:"200",msg:"success",data:[]})})},reportAdClick:function(){return i.default.reportAdClick(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},removeOffScreen:function(){i.default.removeOffScreen()},gameMinicard:function(){return i.default.gameMinicard(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},gameHeartbeat:function(){return i.default.gameHeartbeat(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},gameInit:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e["game-app_ver"]&&(f.default.gameParams["game-app_ver"]=e["game-app_ver"]),e.app_id&&(f.default.baseParams.app_id=e.app_id),e=Object.assign(e,{scene_id:o.default.getScene(!0)}),i.default.gameInit({data:e})},memberFreeze:function(){return i.default.memberFreeze(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})},mpPayErrReport:function(){return i.default.mpPayErrReport(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},1<arguments.length&&void 0!==arguments[1]?arguments[1]:"")}}},function(t,a,e){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},g=i(e(1)),s=i(e(0));function i(e){return e&&e.__esModule?e:{default:e}}function q1(e){var n=e.data,o=e.conf;return new Promise(function(t,a){g.default.ajax(e).then(function(e){e.data&&e.data.data?t({code:200,data:e.data.data,msg:e.data.msg}):t({code:e.data.code,msg:"success",data:{}})},function(e){if(e.data&&1002===e.data.code){if(!1===d)return!1;d=!1,wx.setStorageSync("huo_userInfo",""),t(l.wxLogin({data:n,conf:o}).then(function(e){return d=!1,e}))}else if(e.data&&41406===e.data.code)try{hideFuBiao(!1),""!==c&&c.hide(),l.complainInit(e.data)}catch(e){console.error("complainInit",e)}else a({code:400,msg:e.data?e.data.msg||"\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u91cd\u8bd5":e.errMsg})})})}e(5),e(6);var d=!1,n=1,c="",o="",u=!1,l={cpUserCheck:function(e){return q1(r({method:"post",url:"/cp/user/check",private:!0},e))},login:function(e){return s.default.launchOptions.ext?e.data=Object.assign({},e.data,r({state:s.default.launchOptions.state},e)):e.data=Object.assign({},e.data,r({},e)),s.default.launchOptions&&s.default.launchOptions.state&&(e.data.state=s.default.launchOptions.state),q1(r({method:"post",url:"/mp/ua/lg_info"},e)).then(function(e){var t;return 200===e.code&&(s.default.userInfo=e.data.userinfo,s.default.floatLoginInit=e.data.init_float||0,wx.setStorageSync("huo_userInfo",e.data.userinfo),t=setTimeout(function(){l.afterLogin(e,t)},1e3)),e})},afterLogin:function(e,t){var a;clearTimeout(t),l.mpSubscribe(e),e.data.userinfo.report_status&&(t=parseInt(e.data.userinfo.report_status)||0,a=parseInt(e.data.userinfo.report_time)||0,g.default.huoInterval(this.gameHeartbeat,{},t=2===t?3:t,a,s.default.huoIntervalTask.game_heart)),e.data.ish&&(s.default.showModalData={params:e.data.ish,open_type:e.data.open_type,helpParams:e.data.customer_service},t=parseInt(e.data.ish.status)||0,a=parseInt(e.data.ish.interval_time)||0,g.default.huoInterval(l.intervalShowModalFn,{},t=1===t?1:2,a,s.default.huoIntervalTask.ish),2==t&&(s.default.showModalType=!0,this.intervalShowModalFn())),e="",(e=GameGlobal.egret?egret.lifecycle.stage:e)?(GameGlobal.initTouSuInfo(!1,{show:!1,api:this}),GameGlobal.showTouSu(e)):(wx.onUserCaptureScreen&&wx.onUserCaptureScreen(function(){l.memberFreeze()}),console.log("\u4e0d\u652f\u6301\u767d\u9e6d\u6216\u8005laya,\u622a\u5c4f\u4e0a\u4f20\u624b\u52a8\u5f00\u542f"))},wxLogin:function(n){return wx.getStorageSync("huo_userInfo")?new Promise(function(t,a){wx.checkSession({success:function(){d=!0,t(l.login(n))},fail:function(){wx.login({success:function(e){e.code?(n=r({},n.data,{code:e.code,state:n.data&&n.data.state||""}),wx.setStorageSync("huo_userInfo",""),t(l.login(n))):a(e)},fail:function(e){a({code:400,msg:e.msg||"wx.login.error"})}})}})}):new Promise(function(t,a){wx.login({success:function(e){e.code?(n=r({},n.data,{code:e.code,state:n.data&&n.data.state||""}),wx.setStorageSync("huo_userInfo",""),t(l.login(n))):a(e)},fail:function(e){a({code:400,msg:e.msg||"wx.login.error"})}})})},reversal:function(e){return q1(r({method:"post",url:"/mp/reversal"},e))},setUserInfo:function(e){return q1(r({method:"post",url:"/mp/wx/updateinfo"},e)).then(function(e){return wx.setStorageSync("huo_userInfo",e.data),e})},upRoleInfo:function(e){return e.conf={showLoading:!1,showToast:!1},q1(r({method:"post",url:"/mp/user/uprole"},e)).then(function(e){return l.floatInit(s.default.userInfo,n),n++,e})},getUserInfo:function(e){return this.newUserInfo(e)},newUserInfo:function(e){var o=this;return new Promise(function(n,t){q1(r({method:"post",url:"/mp/wx/getuserinfo"},e)).then(function(e){var t,a;void 0===e.data.code&&(e.data.code=200),200===e.data.code&&(e.data.report_status&&(t=parseInt(e.data.report_status)||0,a=parseInt(e.data.report_time)||0,g.default.huoInterval(o.gameHeartbeat,{},t,a,s.default.huoIntervalTask.game_heart)),wx.setStorageSync("huo_userInfo",e.data)),n(e)}).catch(function(e){t(e)})})},floatInit:function(e,n){s.default.debug&&console.log("ent_cnt",n);try{if(1<n){var t="",a=wx.getStorageSync("huo_measuredHeight"),o=wx.getStorageSync("huo_measuredWidth");if(GameGlobal.egret){if(!(t=egret.lifecycle.stage).measuredHeight)return!1;if(!t.measuredWidth)return!1;o&&2*parseInt(o)<parseInt(t.measuredWidth)&&(n=1),wx.setStorageSync("huo_measuredHeight",t.measuredHeight),wx.setStorageSync("huo_measuredWidth",t.measuredWidth),s.default.debug&&console.log(t),s.default.debug&&console.log("ent_cnt:"+n+" measuredHeight:"+a+" stage.measuredHeight:"+t.measuredHeight+"measuredWidth:"+o+" stage.measuredWidth:"+t.measuredWidth+" stage.width:"+t.width+" stage.height:"+t.height)}else GameGlobal.Laya&&(t=Laya.stage,o&&2*parseInt(o)<parseInt(t.designWidth)&&(n=1),wx.setStorageSync("huo_measuredHeight",t.designHeight),wx.setStorageSync("huo_measuredWidth",t.designWidth))}}catch(e){console.log(e),console.warn("\u4e0d\u652f\u6301\u6d6e\u70b9")}if(console.warn("ent_cnt",n),1<n)return!0;var r=this;return q1({method:"post",url:"/mp/float/init"}).then(function(e){if(e.data&&e.data.game_club&&2===e.data.game_club.is_show&&(c=wx.createGameClubButton({type:e.data.game_club.type,image:e.data.game_club.image,icon:e.data.game_club.icon,text:e.data.game_club.text,style:{left:e.data.game_club.style.left,top:e.data.game_club.style.top,width:e.data.game_club.style.width,height:e.data.game_club.style.height,backgroundColor:e.data.game_club.style.background_color,borderColor:e.data.game_club.style.border_color,borderWidth:e.data.game_club.style.border_width,borderRadius:e.data.game_club.style.border_radius,color:e.data.game_club.style.color,textAlign:e.data.game_club.style.text_align,fontSize:e.data.game_club.style.font_size,lineHeight:e.data.game_club.style.line_height}})),e.data&&2===e.data.float_is_show)try{var t="";var a;GameGlobal.egret?t=egret.lifecycle.stage:GameGlobal.Laya&&(t=Laya.stage),t?((a={user:{},auth:{},ptb:{}}).ptb.open_type=e.data.ptb.open_type,a.user.mobile_str=e.data.user.mobile_str||"",a.user.ptb_show=e.data.user.ptb_show||1,a.tasks=e.data.user.tasks,a.user.id=e.data.mem_id,a.user.avatar=e.data.avatar,a.user.nickname=e.data.user.nickname,a.user.ptb_cnt=e.data.user.ptb_cnt,a.user.ptb_rate=e.data.user.ptb_rate,a.user.fb_icon=e.data.user.fb_icon,a.auth.subscribe_gift=e.data.subscribe_gift,a.auth.subscribe_float=e.data.subscribe_float,a.template_id=e.data.template_id,a.api=r,localStorage.setItem("huo_templateId",e.data.template_id),initFuBiao(a),showFuBiao(t,n)):console.warn("\u4e0d\u652f\u6301\u6d6e\u70b91")}catch(e){console.warn(e)}else hideFuBiao(!1)})},mpSubscribe:function(e){if(e=e.data&&e.data.subscribe_msg||"",document.removeEventListener("touchend",l.addEvent,!1),!e||2!==e.status||!e.template_id)return wx.setStorageSync("huo_template_id",e.template_id),!1;s.default.mp_message.subscribeShow=e.status,s.default.mp_message.ts=e.nts,s.default.mp_message.clickcnt=e.ncc,wx.setStorageSync("huo_template_id",e.template_id),o="",u=!1,document.addEventListener("touchend",l.addEvent,!1)},addEvent:function(){var e;""===o&&(e=(new Date).getTime(),wx.setStorageSync("huo_time",e),o=0),wx.requestSubscribeMessage&&2===s.default.mp_message.subscribeShow&&!1===u&&(e=(new Date).getTime(),wx.getStorageSync("huo_time")+1e3*s.default.mp_message.ts<=e&&wx.getStorageSync("huo_time")&&(o===s.default.mp_message.clickcnt&&l.mpApi(""),o++))},mpApi:function(e){var n=(new Date).getTime();return u=!0,new Promise(function(a,t){2===s.default.mp_message.subscribeShow?wx.requestSubscribeMessage({tmplIds:e.data&&e.data.subscribe_msg.template_id||wx.getStorageSync("huo_template_id"),success:function(e){var t=(new Date).getTime();l.accreditReport({data:{template_ids:e,subscribe_msg_ts:t-n}}),o="",u=!1,a({code:200,msg:"success"})},fail:function(e){t({code:400,msg:"failmpApi"})}}):a({code:200,msg:"success"})})},accreditReport:function(e){return q1(r({url:"/mp/accredit/report"},e)).then(function(e){l.mpSubscribe(e)})},giftAdd:function(e){return q1(r({url:"/mp/gift/add"},e))},getShareInfo:function(e){return q1(r({url:"/mp/share/detail"},e))},addShareInfo:function(e){return q1(r({url:"/mp/share/add"},e))},getShareQrcode:function(e){return q1(r({url:"/mp/share/qrcode"},e))},mpPay:function(t){var a=this;return this.preOrder(t).then(function(e){return t.data=r({},t.data,{payway:"wxpay","order-order_id":e.data.order_id}),a.mpOrder(t)})},midasPay:function(t){var a=this;return this.preOrder(t).then(function(e){return a.wxMidasPay(e.data,t)})},wxMidasPay:function(c,u){var l=this;return new Promise(function(t,a){var e=c.mode,n=c.env,o=c.offer_id,r=c.currency,i=c.buy_quantity,s=c.platform,d=c.zone_id;wx.requestMidasPayment({mode:e,env:n,offerId:o,currencyType:r,platform:s,buyQuantity:i,zoneId:d,success:function(e){u.data["order-order_id"]=c.order_id,u.conf={showLoading:!1,showToast:!1},l.midasPayQuery(u).then(function(e){var t,a;e.data&&2!==e.data.status&&(t=0,a=setInterval(function(){t++,l.midasPayQuery(u).then(function(e){2!==e.data.status&&8!==t||clearInterval(a)},function(e){})},15e3))},function(e){}),e.errMsg&&(e.msg=e.errMsg),t(e)},fail:function(e){e.errMsg&&("requestMidasPayment:fail iOS not supported"===e.errMsg?(t=wx.getStorageSync("huo_userInfo"),e.msg=t&&t.ios_text||"\u5c0f\u6e38\u620f\u6682\u4e0d\u652f\u6301IOS\u652f\u4ed8\uff0c\u8bf7\u4f7f\u7528\u5b89\u5353\u767b\u5f55\u540e\u652f\u4ed8\u3002",e.duration=3e3):e.msg=e.errMsg);var t=g.default.setting(u.conf);t.showToast&&(e.msg&&(t.toastParams.title=e.msg),e.duration&&(t.toastParams.duration=e.duration),wx.showToast(t.toastParams)),a(e)}})})},checkPay:function(t){var a=this;return this.preOrder(t).then(function(e){switch(e.data.check){case 1:return t.data["order-order_id"]=e.data.order_id,a.checkPayInfo(t);case 2:return a.wxMidasPay(e.data,t);default:return{code:"400",msg:"fail"}}})},preOrder:function(e){var t=(new Date).getTime(),a=wx.getStorageSync("huo_pre_order_last");return a&&parseInt(t-a)<1e3?{code:"400",msg:"\u4eb2 \u6162\u70b9\u70b9\u51fb"}:q1(r({method:"post",url:"/mp/preorder"},e)).then(function(e){return wx.setStorageSync("huo_pre_order_last",t),wx.setStorageSync("huo_orderInfo",e.data),e},function(e){return e})},mpOrder:function(t){var a=this;return q1(r({method:"post",url:"/mp/wx/pay"},t)).then(function(e){return a.wxMpPay(JSON.parse(e.data.token),t)})},wxMpPay:function(e,n){return new Promise(function(t,a){wx.requestPayment(r({},e,{success:function(e){e.errMsg&&(e.msg=e.errMsg),t(e)},fail:function(e){e.errMsg&&(e.msg=e.errMsg);var t=g.default.setting(n.conf);t.showToast&&(e.msg&&(t.toastParams.title=e.msg),wx.showToast(t.toastParams)),a(e)},complete:function(e){"requestPayment:cancel"===e.errMsg&&a({msg:"requestPayment:fail cancel"}),this.mpPayErrReport(n,e.errMsg)}}))})},mpPayErrReport:function(e,t){q1({method:"post",url:"/mp/pay/error/report",data:{error_msg:t,"order-order_id":e["order-order_id"]||"",error_mp_id:e.error_mp_id||""}}).then(function(e){})},mpPayQuery:function(e){return q1(r({method:"post",url:"/mp/order/query"},e))},midasPayQuery:function(e){return q1(r({url:"/mp/mpay/query"},e))},checkPayInfo:function(i){var s=this;return q1(r({url:"/mp/order/checkinfo"},i)).then(function(r){return r.data.order_id=i.data["order-order_id"],new Promise(function(a,e){r.data.image&&wx.setStorageSync("huo_orderQRCode",r.data.image);var t=r.data;var n,o;wx.getStorageSync("huo_orderQRCode"),r.data&&4===r.data.pay_type?(wx.showModal({title:r.data.recharte_title,content:r.data.recharte_content,showCancel:!1,success:function(e){e.confirm&&wx.openCustomerServiceConversation({sessionFrom:t.session_from,showMessageCard:!0,sendMessageTitle:t.miniprogrampage_title,sendMessagePath:t.miniprogrampage_url,sendMessageImg:t.miniprogrampage_picture})}}),a(r)):r.data&&r.data.mp_id?(n=s,o=i,wx.navigateToMiniProgram({appId:r.data.mp_id,path:r.data.path,fail:function(e){-1===e.errMsg.search("jsapi")&&-1===e.errMsg.search("denied")&&-1===e.errMsg.search("navigateToMiniProgramAppIdList")||(o.data.error_mp_id=r.data.mp_id,o.data.error_mp_msg=e.errMsg,n.checkPayInfo(o))},success:function(){a(r)}})):s.checkQrcode(i).then(function(e){var t=e.data.image;(e=e.data.poster_img||"")?wx.previewImage({current:e,urls:[e]}):t&&(wx.previewImage({current:t,urls:[t]}),wx.setStorageSync("huo_orderQRCode",t)),r.data.image=t,r.data.poster_img=e,a({code:"200",msg:"success",data:[]})},function(e){a(r)})})})},intervalShowModalFn:function(){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;!0===s.default.showModalType&&(s.default.debug&&console.log((new Date).getTime()+" touchend:"+e),document.addEventListener("touchend",l.showModalFn,!1),s.default.showModalType=!1)},showModalFn:function(){s.default.showModalType=!0,document.removeEventListener("touchend",l.showModalFn,!1);var t=s.default.showModalData.params,a=s.default.showModalData.open_type,n=s.default.showModalData.helpParams;wx.showModal({title:t.title,content:t.content,cancelText:t.lb,confirmText:t.rb,success:function(e){e.confirm?2===t.status?wx.navigateToMiniProgram({appId:a.wx_app_id,path:a.wx_path,extraData:a.extra_data||{},envVersion:a.env_version||"release",fail:function(e){wx.setClipboardData({data:n.wx,success:function(e){wx.showModal({title:"\u6e29\u99a8\u63d0\u793a",content:"\u65e0\u6cd5\u8df3\u8f6c\u5c0f\u7a0b\u5e8f\uff0c\u5df2\u5e2e\u60a8\u590d\u5236\u5ba2\u670d\u5fae\u4fe1\u8bf7\u8054\u7cfb\u5ba2\u670d\uff01",success:function(e){console.log("copy showModal success:"+n.wx)}})}})},success:function(){console.log("navigateToMiniProgram success")}}):wx.setClipboardData({data:n.wx,success:function(e){console.log("copy success")}}):e.cancel&&console.log("showModal cancel")}})},checkOrderInfo:function(e){return q1(r({method:"post",url:"/mp/pay/info"},e))},checkOrder:function(t){var a=this;return q1(r({method:"post",url:"/mp/check/pay"},t)).then(function(e){return a.wxMpPay(JSON.parse(e.data.token),t)})},checkQrcode:function(e){return e.data&&(e.data.is_last=2),q1(r({url:"/mp/order/qrcode"},e))},reportAdClick:function(e){return q1(r({url:"/mp/ad/report"},e))},removeOffScreen:function(){g.default.removeOffScreen()},checkMsg:function(e){return q1(r({method:"post",url:"/mp/msg/check"},e))},checkImg:function(e){var n=r({},s.default.baseParams,s.default.gameParams,s.default.agentParams,s.default.deviceParams,{token:wx.getStorageSync("huo_userInfo").user_token,ts:(new Date).getTime()});return n.sign=g.default.sign({url:"/mp/img/check",data:n}),new Promise(function(t,a){wx.uploadFile({url:s.default.baseUrl+"/mp/img/check",filePath:e.data.filePath,name:"image",formData:n,success:function(e){e=e.data,200===(e=JSON.parse(e)).code?t({code:200,msg:"success"}):a({code:400,msg:e.msg||"failcheckImg"})}})})},gameMinicard:function(e){return q1(r({method:"post",url:"/mp/game/minicard"},e))},userCheckpay:function(e){return q1(r({method:"post",url:"/mp/user/checkpay"},e))},gameHeartbeat:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e.conf={showLoading:!1,showToast:!1},q1(r({method:"post",url:"/mp/game/heartbeat"},e)).then(function(e){s.default.floatLoginInit&&(l.floatInit(s.default.userInfo,s.default.floatLoginInit),s.default.floatLoginInit++),l.mpSubscribe(e)})},complainInit:function(e){var n=this;return e.conf={showLoading:!1,showToast:!1},q1(r({method:"post",url:"/mp/complain/index"},e)).then(function(e){try{var t="";var a;(t=GameGlobal.egret?egret.lifecycle.stage:t)&&((a={show:!0,name:e.data.name,icon:e.data.icon,restore_time:e.data.restore_time,session_from:e.data.session_from,miniprogrampage_title:e.data.miniprogrampage_title,miniprogrampage_picture:e.data.miniprogrampage_picture,miniprogrampage_url:e.data.miniprogrampage_url,uploadUrl:e.data.upload_url,customer_service_qq:e.data.customer_service_qq,customer_service_tel:e.data.customer_service_tel,list:e.data.list}).api=n,console.warn("complainInit-41406-\u622a\u5c4f\u521d\u59cb\u5316\u548c\u663e\u793a"),GameGlobal.initTouSuInfo(!0,a),GameGlobal.showTouSu(t))}catch(e){console.error(e)}})},memberFreeze:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=this;return e.conf={showLoading:!1,showToast:!1},new Promise(function(t,a){q1(r({method:"post",url:"/mp/member/freeze"},e)).then(function(e){n.getUserInfo(),t(e)}).catch(function(e){a(e)})})},complainReport:function(e){return e.conf={showLoading:!1,showToast:!1},q1(r({method:"post",url:"/mp/complain/report"},e))},sendCode:function(e){return q1(r({method:"post",url:"/mp/sms/send"},e))},bindPhone:function(e){return q1(r({method:"post",url:"/mp/sms/bind"},e))},gameInit:function(e){return new Promise(function(t,a){q1(r({method:"post",url:"/mp/index/init"},e)).then(function(e){t(e)}).catch(function(e){a(e)})})}};t.exports=l},function(t,a,e){"use strict";function r(e,t){var a=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(a>>16)<<16|65535&a}function i(e,t,a,n,o,i){return r((t=r(r(t,e),r(n,i)))<<o|t>>>32-o,a)}function s(e,t,a,n,o,r,s){return i(t&a|~t&n,e,t,o,r,s)}function d(e,t,a,n,o,r,s){return i(t&n|a&~n,e,t,o,r,s)}function c(e,t,a,n,o,r,s){return i(t^a^n,e,t,o,r,s)}function u(e,t,a,n,o,r,s){return i(a^(t|~n),e,t,o,r,s)}function l(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;var a,n,o,i,p,l=1732584193,g=-271733879,h=-1732584194,m=271733878;for(a=0;a<e.length;a+=16)g=u(g=u(g=u(g=u(g=c(g=c(g=c(g=c(g=d(g=d(g=d(g=d(g=s(g=s(g=s(g=s(o=g,h=s(i=h,m=s(p=m,l=s(n=l,g,h,m,e[a],7,-680876936),g,h,e[a+1],12,-389564586),l,g,e[a+2],17,606105819),m,l,e[a+3],22,-1044525330),h=s(h,m=s(m,l=s(l,g,h,m,e[a+4],7,-176418897),g,h,e[a+5],12,1200080426),l,g,e[a+6],17,-1473231341),m,l,e[a+7],22,-45705983),h=s(h,m=s(m,l=s(l,g,h,m,e[a+8],7,1770035416),g,h,e[a+9],12,-1958414417),l,g,e[a+10],17,-42063),m,l,e[a+11],22,-1990404162),h=s(h,m=s(m,l=s(l,g,h,m,e[a+12],7,1804603682),g,h,e[a+13],12,-40341101),l,g,e[a+14],17,-1502002290),m,l,e[a+15],22,1236535329),h=d(h,m=d(m,l=d(l,g,h,m,e[a+1],5,-165796510),g,h,e[a+6],9,-1069501632),l,g,e[a+11],14,643717713),m,l,e[a],20,-373897302),h=d(h,m=d(m,l=d(l,g,h,m,e[a+5],5,-701558691),g,h,e[a+10],9,38016083),l,g,e[a+15],14,-660478335),m,l,e[a+4],20,-405537848),h=d(h,m=d(m,l=d(l,g,h,m,e[a+9],5,568446438),g,h,e[a+14],9,-1019803690),l,g,e[a+3],14,-187363961),m,l,e[a+8],20,1163531501),h=d(h,m=d(m,l=d(l,g,h,m,e[a+13],5,-1444681467),g,h,e[a+2],9,-51403784),l,g,e[a+7],14,1735328473),m,l,e[a+12],20,-1926607734),h=c(h,m=c(m,l=c(l,g,h,m,e[a+5],4,-378558),g,h,e[a+8],11,-2022574463),l,g,e[a+11],16,1839030562),m,l,e[a+14],23,-35309556),h=c(h,m=c(m,l=c(l,g,h,m,e[a+1],4,-1530992060),g,h,e[a+4],11,1272893353),l,g,e[a+7],16,-155497632),m,l,e[a+10],23,-1094730640),h=c(h,m=c(m,l=c(l,g,h,m,e[a+13],4,681279174),g,h,e[a],11,-358537222),l,g,e[a+3],16,-722521979),m,l,e[a+6],23,76029189),h=c(h,m=c(m,l=c(l,g,h,m,e[a+9],4,-640364487),g,h,e[a+12],11,-421815835),l,g,e[a+15],16,530742520),m,l,e[a+2],23,-995338651),h=u(h,m=u(m,l=u(l,g,h,m,e[a],6,-198630844),g,h,e[a+7],10,1126891415),l,g,e[a+14],15,-1416354905),m,l,e[a+5],21,-57434055),h=u(h,m=u(m,l=u(l,g,h,m,e[a+12],6,1700485571),g,h,e[a+3],10,-1894986606),l,g,e[a+10],15,-1051523),m,l,e[a+1],21,-2054922799),h=u(h,m=u(m,l=u(l,g,h,m,e[a+8],6,1873313359),g,h,e[a+15],10,-30611744),l,g,e[a+6],15,-1560198380),m,l,e[a+13],21,1309151649),h=u(h,m=u(m,l=u(l,g,h,m,e[a+4],6,-145523070),g,h,e[a+11],10,-1120210379),l,g,e[a+2],15,718787259),m,l,e[a+9],21,-343485551),l=r(l,n),g=r(g,o),h=r(h,i),m=r(m,p);return[l,g,h,m]}function g(e){var t,a="",n=32*e.length;for(t=0;t<n;t+=8)a+=String.fromCharCode(e[t>>5]>>>t%32&255);return a}function h(e){var t,a=[];for(a[(e.length>>2)-1]=void 0,t=0;t<a.length;t+=1)a[t]=0;var n=8*e.length;for(t=0;t<n;t+=8)a[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return a}function m(e){var t,a,n="";for(a=0;a<e.length;a+=1)t=e.charCodeAt(a),n+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return n}function f(e){return unescape(encodeURIComponent(e))}function p(e){return g(l(h(e=f(e)),8*e.length))}function v(e,t){e=f(e),t=f(t);var a,n=h(e),o=[],r=[];for(o[15]=r[15]=void 0,16<n.length&&(n=l(n,8*e.length)),a=0;a<16;a+=1)o[a]=909522486^n[a],r[a]=1549556828^n[a];return e=l(o.concat(h(t)),512+8*t.length),g(l(r.concat(e),640))}function w(e,t,a){return t?a?v(t,e):m(v(t,e)):a?p(e):m(p(e))}void 0===(e=function(){return w}.call(a,e,a,t))||(t.exports=e)},function(t,a,n){"use strict";var o=n(0),L=o&&o.__esModule?o:{default:o};void 0===(o=function(o,d,h,m){function t3(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var p=function(){function e(t,a,n){var o;if(!(this instanceof e))throw new TypeError("Cannot call a class as a function");this.curShowFb=!0,this.curDetailTab=0,this.stageW=0,this.stageH=0,this.preloaded=!1,this.loadedNum=0,this.fbTouched=!1,(o=this).stageW=a,o.stageH=n,o.stage=t,o.group=new y,o.bgRect=new _,"egret"===g?(o.group.width=w,o.group.height=b,o.bgRect.touchEnabled=!0):"Laya"===g&&(o.bgRect.mouseEnabled=!1,o.group.width=Laya.Browser.width,o.group.height=Laya.Browser.height),o.groupB=new y,"egret"===g&&(o.groupB.width=a,o.groupB.height=n,o.groupB.touchEnabled=!1),o.groupB.addChild(o.bgRect),o.groupB.addChild(o.group);var r=Math.min(a/w,n/b).toFixed(2);if("egret"===g?o.group.touchEnabled=!1:"Laya"===g&&(o.group.mouseEnabled=!1),o.group.scaleX=o.group.scaleY=r,o.group.x=(a-w*r)/2,o.group.y=(n-b*r)/2,o.group.x<0&&(o.group.x=0),o.group.y<0&&(o.group.y=0),t.addChild(o.groupB),c&&c.user&&c.user.avatar&&(u.head=c.user.avatar),c&&c.user&&c.user.fb_icon&&(u.fbIcon=c.user.fb_icon),c&&c.tasks)for(var i in c.tasks)u[i]=c.tasks[i].icon;o.imgLoader=I;var s=Object.keys(u);for(var d in s)l[s[d]]=s[d];"egret"===g?o.loadAssets():"Laya"===g&&this.show()}return t3(e,[{key:"loadAssets",value:function(){"egret"===g?(this.imgLoader.addEventListener(a,this.loadSucc,this),this.imgLoader.addEventListener(n,this.loadFail,this)):"Laya"===g&&(this.imgLoader.on(a,this,this.loadSucc),this.imgLoader.on(n,this,this.loadFail)),this.preloaded=!1,this.loadedNum=0,this.loadAssetsPer()}},{key:"loadAssetsPer",value:function(){var e=Object.keys(u);0<=this.loadedNum&&this.loadedNum<e.length&&(this.loadedNum+=1,"egret"!==g&&"Laya"!==g||this.imgLoader.load(u[e[this.loadedNum-1]]))}},{key:"loadSucc",value:function(e){var t=Object.keys(u);"egret"===g?e.currentTarget.data&&(P[t[this.loadedNum-1]]=e.currentTarget.data):"Laya"===g&&(P[t[this.loadedNum-1]]=Laya.loader.getRes(t[this.loadedNum-1])),this.loadedNum<Object.keys(u).length?this.loadAssetsPer():this.preloaded||(this.preloaded=!0,"egret"===g?(this.imgLoader.removeEventListener(a,this.loadSucc,this),this.imgLoader.removeEventListener(n,this.loadFail,this)):"Laya"===g&&(this.imgLoader.off(a,this,this.loadSucc),this.imgLoader.off(n,this,this.loadFail)),this.show())}},{key:"loadFail",value:function(e){console.warn("loadFail--\x3e",e),e=Object.keys(u),P[e[this.loadedNum-1]]=null,this.loadedNum<Object.keys(u).length?this.loadAssetsPer():this.preloaded||(this.preloaded=!0,"egret"===g?(this.imgLoader.removeEventListener(a,this.loadSucc,this),this.imgLoader.removeEventListener(n,this.loadFail,this)):"Laya"===g&&(this.imgLoader.off(a,this,this.loadSucc),this.imgLoader.off(n,this,this.loadFail)),this.show())}},{key:"init",value:function(){var e=this;e.fdIco=new r,e.groupB.addChild(e.fdIco),e.drawImage(e.fdIco,281,284,e.stageW-118.02*e.group.scaleX/2,e.stageH/4,l.fbIcon,.42*e.group.scaleX);var t=0;e.drawRect(e.bgRect,0,t,e.stageW,e.stageH,0,.42,!0),e.bg=new r,e.group.addChild(e.bg),e.drawImage(e.bg,690,b,30,170,l.bg),e.headImg=new r,e.group.addChild(e.headImg),e.drawImage(e.headImg,104,104,60,t+192,l.head),e.nameLab=new i,e.group.addChild(e.nameLab),e.drawLab(e.nameLab,28,"middle","left",c.user.nickname,3355443,184,t+208),e.idLab=new i,e.group.addChild(e.idLab),e.drawLab(e.idLab,28,"middle","left",c.user.mobile_str,3355443,184,t+260),e.close=new r,e.group.addChild(e.close),e.drawImage(e.close,50,50,638,t+198,l.close),e.ptbGroup=new y,e.group.addChild(e.ptbGroup),e.ptbGroup.x=0,e.ptbGroup.y=t,e.coinbg=new r,e.ptbGroup.addChild(e.coinbg),e.drawImage(e.coinbg,144,40,60,320,l.coinBg),e.coinImg=new r,e.ptbGroup.addChild(e.coinImg),e.drawImage(e.coinImg,46,46,60,316,l.coin),e.coinLab=new i,e.ptbGroup.addChild(e.coinLab),e.drawLab(e.coinLab,32,"middle","middle",c.user.ptb_cnt*c.user.ptb_rate,3355443,110,324),e.coinTxt=new i,e.ptbGroup.addChild(e.coinTxt),e.drawLab(e.coinTxt,22,"middle","left",c.user.ptb_rate+"\u5e73\u53f0\u5e01=1\u4eba\u6c11\u5e01",6710886,222,328),e.chargeImg=new r,e.ptbGroup.addChild(e.chargeImg),e.drawImage(e.chargeImg,144,62,540,308,l.czBtnBg),c&&c.user&&2===c.user.ptb_show?(e.visible(e.ptbGroup,!0),t+=78):e.visible(e.ptbGroup,!1),e.lineImg=new r,e.group.addChild(e.lineImg),e.drawImage(e.lineImg,690,3,30,t+320,l.lineImg),t+=322;var a=Object.keys(c.tasks),n={};e.taskGroup=[],e.taskElements=[];for(var o=0;o<=7;o++)e.taskGroup[o]=new y,e.taskElements[o]={},e.group.addChild(e.taskGroup[o]),e.taskGroup[o].x=52,e.taskGroup[o].y=t,a[o]?(n=c.tasks[a[o]],t+=156,e.visible(e.taskGroup[o],!0)):e.visible(e.taskGroup[o],!1),e.drawTask(e.taskGroup[o],o,n);e.bg.height=t-136,"egret"===g?(e.fdIco.addEventListener(x,e.clickB,e),e.fdIco.addEventListener(C,e.clickE,e),e.chargeImg.addEventListener(s,e.click,e),e.close.addEventListener(s,e.click,e),e.bgRect.addEventListener(s,e.click,e)):"Laya"===g&&(e.fdIco.on(x,e,e.clickB),e.fdIco.on(C,e,e.clickE),e.chargeImg.on(s,e,e.click),e.close.on(s,e,e.click),e.bgRect.on(s,e,e.click))}},{key:"clickB",value:function(e){this.fbTouched=!0,"egret"===g?(this.setFbPosAcrossFingerPosZ(this.groupB.globalToLocal(e.stageX,e.stageY)),this.stage.addEventListener(S,this.clickM,this)):"Laya"===g&&(e={x:e.stageX,y:e.stageY},this.setFbPosAcrossFingerPosZ(e),this.stage.on(S,this,this.clickM))}},{key:"clickM",value:function(e){this.fbTouched&&("egret"===g?this.setFbPosAcrossFingerPosZ(this.groupB.globalToLocal(e.stageX,e.stageY)):"Laya"===g&&(e={x:e.stageX,y:e.stageY},this.setFbPosAcrossFingerPosZ(e)))}},{key:"clickE",value:function(e){this.fbTouched&&(this.fbTouched=!1,"egret"===g?this.stage.removeEventListener(S,this.clickM,this):"Laya"===g&&this.stage.off(S,this,this.clickM),this.fbTouched=!1,this.curShowFb=!1,this.curDetailTab=0,this.reRedener(),c.api.newUserInfo().then(function(e){c.user.ptb_cnt=e.data.ptb_cnt,c.user.ptb_rate=e.data.ptb_rate,c.tasks=e.data.tasks,c.user.ptb_show=e.data.ptb_show,c.user.mobile_str=e.data.mobile_str,c.user.nickname=e.data.nickname,t&&t.reRedener()}).catch(function(e){console.error(e)}),2===c.auth.subscribe_float&&wx.requestSubscribeMessage&&wx.requestSubscribeMessage({tmplIds:c.template_id,success:function(e){var t;t=c.template_id,c.api.accreditReport({data:{template_ids:e,template_id:t}})},fail:function(e){console.warn(e),console.warn("\u8ba2\u9605\u5931\u8d25")}}))}},{key:"click",value:function(e){e.stopPropagation();var t=this;if(e&&e.target&&e.target.name&&c&&c.tasks)for(var a in c.tasks){var n,o;if(e.target.name===a)return a=(c.tasks[a]||{}).open_type||{},console.log("click, open_type",a),void(1===a.type?(n=a.env_version||"release",o=a.extra_data||{},t.navigateMp(a.wx_app_id,a.wx_path,n,o)):3===a.type&&(console.log("click, open_type",a),t.kefu(a.session_from,a.miniprogrampage_title,a.miniprogrampage_url,a.miniprogrampage_picture)))}switch(e.currentTarget){case t.chargeImg:var r;var i,s;1===(r=c.ptb.open_type).type?(console.log("click, open_type",r),i=r.env_version||"release",s=r.extra_data||{},t.navigateMp(r.wx_app_id,r.wx_path,i,s)):3===r.type&&t.kefu(r.session_from,r.miniprogrampage_title,r.miniprogrampage_url,r.miniprogrampage_picture);break;case t.close:case t.bgRect:t.curShowFb=!0,t.reRedener()}}},{key:"setFbPosAcrossFingerPosZ",value:function(e){var t=this,a=e.x,n=e.y;1<arguments.length&&void 0!==arguments[1]&&arguments[1]||(a=e.x-t.fdIco.width*t.fdIco.scaleX/2,n=e.y-t.fdIco.height*t.fdIco.scaleY/2,a<0?a=0:a>t.stageW-t.fdIco.width*t.fdIco.scaleX&&(a=t.stageW-t.fdIco.width*t.fdIco.scaleX),n<0?n=0:n>t.stageH-t.fdIco.height*t.fdIco.scaleY&&(n=t.stageH-t.fdIco.height*t.fdIco.scaleY)),t.fdIco.x=a,t.fdIco.y=n}},{key:"copy",value:function(e){wx.setClipboardData({data:e})}},{key:"kefu",value:function(e,t,a,n){wx.openCustomerServiceConversation({sessionFrom:e,showMessageCard:!0,sendMessageTitle:t,sendMessagePath:a,sendMessageImg:n})}},{key:"navigateMp",value:function(t,e){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"release";wx.navigateToMiniProgram({appId:t,path:e,extraData:3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},envVersion:a,fail:function(e){-1===e.errMsg.search("jsapi")&&-1===e.errMsg.search("denied")&&-1===e.errMsg.search("navigateToMiniProgramAppIdList")||(e=error_mp_msg,c.api.mpPayErrReport({error_mp_id:t},e))},success:function(){resolve(res)}})}},{key:"show",value:function(){this.curShowFb=!0,this.curDetailTab=0,this.init(),this.reRedener()}},{key:"reRedener",value:function(){var e=this;if(e.curShowFb&&null!==e.fdIco&&null!==e.fdIco.x){"egret"===g||"Laya"===g&&(e.group.mouseEnabled=!1);var t=e.fdIco.x<e.stageW/2?-1*e.fdIco.width*e.fdIco.scaleX/2:e.stageW-e.fdIco.width*e.fdIco.scaleX/2;e.setFbPosAcrossFingerPosZ({x:t,y:e.fdIco.y},!0)}else{"egret"===g||"Laya"===g&&(e.group.mouseEnabled=!0),e.nameLab.text=c.user.nickname,e.idLab.text=c.user.mobile_str,e.coinLab.text=c.user.ptb_cnt*c.user.ptb_rate,e.coinTxt.text=c.user.ptb_rate+"\u5e73\u53f0\u5e01=1\u4eba\u6c11\u5e01";var a=0;c&&c.user&&2===c.user.ptb_show?(e.visible(e.ptbGroup,!0),a+=78):e.visible(e.ptbGroup,!1),e.lineImg.y=a+320,a+=322;for(var n=Object.keys(c.tasks),o=null,r=0;r<=7;r++)e.taskGroup[r].x=52,e.taskGroup[r].y=a,n[r]?(o=c.tasks[n[r]],a+=156,e.visible(e.taskGroup[r],!0)):e.visible(e.taskGroup[r],!1),e.updateTaskData(r,o);e.bg.height=a-136}e.visible(e.fdIco,e.curShowFb),e.visible(e.group,!e.curShowFb),e.visible(e.bgRect,!e.curShowFb)}},{key:"visible",value:function(e,t){e&&(e.visible=t)}},{key:"drawImage",value:function(e,t,a,n,o,r){var i=6<arguments.length&&void 0!==arguments[6]?arguments[6]:1,s=!(7<arguments.length&&void 0!==arguments[7])||arguments[7];e&&(e.width=t,e.height=a,e.x=n,e.y=o,1!==i&&(e.scaleX=e.scaleY=i),this._updateBitmap(e,r),"egret"===g?e.touchEnabled=s:"Laya"===g&&(e.mouseEnabled=s))}},{key:"_updateBitmap",value:function(e,t){e&&("egret"===g?P[t]&&(e.texture||(e.texture=new k),e.texture.bitmapData=P[t],e.$refreshImageData()):"Laya"===g&&u[t]&&(e.source=u[t],e.skin=u[t]))}},{key:"drawLab",value:function(e,t,a,n,o,r,c,u){var l=8<arguments.length&&void 0!==arguments[8]&&arguments[8],i=9<arguments.length&&void 0!==arguments[9]?arguments[9]:0,s=10<arguments.length&&void 0!==arguments[10]?arguments[10]:0,d=!(11<arguments.length&&void 0!==arguments[11])||arguments[11];e&&(e.x=c,e.y=u,e.bold=l,0<i&&(e.width=i),0<s&&(e.height=s),"egret"===g?(e.size=t,e.textAlign=n,e.verticalAlign=a,e.text=o,e.textColor=r,e.touchEnabled=d):"Laya"===g&&(e.fontSize=t,e.align=n,e.valign=a,e.text=o,e.color=r,e.mouseEnabled=d))}},{key:"drawRect",value:function(e,t,a,n,o,r,i){var s=7<arguments.length&&void 0!==arguments[7]&&arguments[7];e&&("egret"===g?(e.graphics.clear(),e.graphics.beginFill(r,i),e.graphics.drawRect(t,a,n,o),e.graphics.endFill(),e.touchEnabled=s):"Laya"===g&&(e.graphics.clear(),e.graphics.drawRect(t,a,n,o,r),e.alpha=i,e.mouseEnabled=s))}},{key:"drawTask",value:function(e,t,a){var n=this;n.taskElements[t].whiteTaskBg=new r,e.addChild(n.taskElements[t].whiteTaskBg),n.drawImage(n.taskElements[t].whiteTaskBg,646,136,0,20,l.whiteTaskBg),n.taskElements[t].taskIcon=new r,e.addChild(n.taskElements[t].taskIcon),n.drawImage(n.taskElements[t].taskIcon,76,76,20,48,a.code||l.helpIcon),n.taskElements[t].taskName=new i,e.addChild(n.taskElements[t].taskName),n.drawLab(n.taskElements[t].taskName,36,"middle","left",a.name,3355443,118,48),n.taskElements[t].taskRwdTitle=new i,e.addChild(n.taskElements[t].taskRwdTitle),n.drawLab(n.taskElements[t].taskRwdTitle,24,"middle","left","\u5956\u52b1",3355443,118,106),n.taskElements[t].taskRwd=new i,e.addChild(n.taskElements[t].taskRwd);var o=a.reward_str||"";n.drawLab(n.taskElements[t].taskRwd,24,"middle","left",o,16711680,176,106),o?n.taskElements[t].taskRwd.text=o:(n.taskElements[t].taskName.y=68,n.visible(n.taskElements[t].taskRwdTitle,!1),n.visible(n.taskElements[t].taskRwd,!1)),n.taskElements[t].yellowBtn=new r,e.addChild(n.taskElements[t].yellowBtn),o=a.btn||l.yellowBtn,n.drawImage(n.taskElements[t].yellowBtn,130,68,492,54,o),n.taskElements[t].yellowBtn.name=a.code||"","egret"===g?n.taskElements[t].yellowBtn.addEventListener(s,n.click,n):"Laya"===g&&n.taskElements[t].yellowBtn.on(s,n,n.click)}},{key:"updateTaskData",value:function(e,t){var a=this;var n;null!==a.taskGroup[e]&&void 0!==a.taskGroup[e]&&""!==a.taskGroup[e]&&a.taskGroup[e]!==[]&&(this._updateBitmap(a.taskElements[e].taskIcon,t.code||l.helpIcon),a.taskElements[e].taskName.text=t.name||"",(n=t.reward_str||"")?(a.taskElements[e].taskName.y=48,a.visible(a.taskElements[e].taskRwdTitle,!0),a.visible(a.taskElements[e].taskRwd,!0),a.taskElements[e].taskRwd.text=n):(a.taskElements[e].taskName.y=68,a.visible(a.taskElements[e].taskRwdTitle,!1),a.visible(a.taskElements[e].taskRwd,!1)),n=t.btn||l.yellowBtn,this._updateBitmap(a.taskElements[e].yellowBtn,n),a.taskElements[e].yellowBtn.name=t.code||"")}}]),e}(),f=!1,v=!1,g="",w=750,b=1334,c={user:{id:0,nickname:"",avatar:"",ptb_cnt:0,ptb_rate:0,entry_image:""},template_id:[],auth:{subscribe_float:0,subscribe_gift:0}},t=void 0,y=void 0,r=void 0,i=void 0,_=void 0,I=void 0,k=void 0,s=void 0,x=void 0,S=void 0,C=void 0,a=void 0,n=void 0,u={fbIcon:L.default.staticUrl+"/mini/float/fd.png",close:L.default.staticUrl+"/mini/float/close.png",tabSel:L.default.staticUrl+"/mini/float/sel.png",bg:L.default.staticUrl+"/mini/float/bg.png",bg2:L.default.staticUrl+"/mini/float/bg2.png",tab0Btn0:L.default.staticUrl+"/mini/float/btnFzCode.png",tab1Btn0:L.default.staticUrl+"/mini/float/btnSGain.png",tab0Btn0_S:L.default.staticUrl+"/mini/float/bgGain2.png",tab0Btn1:L.default.staticUrl+"/mini/float/btnGain.png",btnFz:L.default.staticUrl+"/mini/float/btnFz.png",btnFzG:L.default.staticUrl+"/mini/float/btnFzG.png",btnC:L.default.staticUrl+"/mini/float/btnC.png",coinBg:L.default.staticUrl+"/mini/float/jb_bg.png",coin:L.default.staticUrl+"/mini/float/jb.png",head:L.default.staticUrl+"/mini/float/head.png",yellowBtnBg:L.default.staticUrl+"/mini/float/btn_yellow.png",czBtnBg:L.default.staticUrl+"/mini/float/btn_cz.png",offIcon:L.default.staticUrl+"/mini/float/off.png",oaIcon:L.default.staticUrl+"/mini/float/gzh.png",helpIcon:L.default.staticUrl+"/mini/float/fkwt.png",phoneIcon:L.default.staticUrl+"/mini/float/phone.png",qqIcon:L.default.staticUrl+"/mini/float/qq.png",lineImg:L.default.staticUrl+"/mini/float/xt.png",whiteTaskBg:L.default.staticUrl+"/mini/float/lbbg.png",rBtn:L.default.staticUrl+"/mini/float/btn_qw.png",upBtn:L.default.staticUrl+"/mini/float/btn_sj.png",addBtn:L.default.staticUrl+"/mini/float/btn_tj.png",bdBtn:L.default.staticUrl+"/mini/float/btn_bd.png",oaBtn:L.default.staticUrl+"/mini/float/btn_gz.png"},l={},P={};GameGlobal.initFuBiao=function(e){v=!0,e&&(e="string"==typeof e?JSON.parse(e):e,c=e)},GameGlobal.showFuBiao=function(e){1===(1<arguments.length&&void 0!==arguments[1]?arguments[1]:1)?(t&&e.removeChild(t.groupB),t=void 0,f=!1):t&&t.reRedener(),!f&&v&&(f=!0,GameGlobal.egret?(g="egret",y=egret.DisplayObjectContainer,r=egret.Bitmap,i=egret.TextField,_=egret.Shape,(I=new egret.ImageLoader).crossOrigin="anonymous",k=egret.Texture,s=egret.TouchEvent.TOUCH_TAP,x=egret.TouchEvent.TOUCH_BEGIN,S=egret.TouchEvent.TOUCH_MOVE,C=egret.TouchEvent.TOUCH_END,a=egret.Event.COMPLETE,n=egret.IOErrorEvent.IO_ERROR,t=new p(e,e.stageWidth,e.stageHeight)):GameGlobal.Laya?(g="Laya",y=laya.display.Sprite,r=laya.ui.Image,i=laya.ui.Label,_=laya.display.Sprite,I=Laya.loader,k=Laya.Texture,s=Laya.Event.CLICK,x=Laya.Event.MOUSE_DOWN,S=Laya.Event.MOUSE_MOVE,C=Laya.Event.MOUSE_UP,a=Laya.Event.COMPLETE,n=Laya.Event.ERROR,t=new p(e,e.width,e.height)):e.drawImage(fbCanvas,0,0))},GameGlobal.hideFuBiao=function(e){return!!t&&(t.visible(t.groupB,e),!0)}}.call(a,n,a,t))||(t.exports=o)},function(a,n,o){"use strict";var r=o(0),F=r&&r.__esModule?r:{default:r};void 0===(r=function(l,b,y,_){function V4(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var c={back:F.default.staticUrl+"/mini/complain/back.png",kefu:F.default.staticUrl+"/mini/complain/btnKeFu.png",add:F.default.staticUrl+"/mini/complain/icon_add.png",submit:F.default.staticUrl+"/mini/complain/submit.png",gou:F.default.staticUrl+"/mini/complain/gou.png",gameIco:""},I=void 0,k=void 0,n={};function g(e,t){e&&(e.visible=t)}function h(e,t,a,n,o,r){r=5<arguments.length&&void 0!==r&&r,e&&(e.width=t,e.height=a,e.x=n,e.y=o,e.touchEnabled=r)}function m(e,t,a,n,o,r,i,s,d){i=6<arguments.length&&void 0!==i?i:1,s=7<arguments.length&&void 0!==s?s:1,d=!(8<arguments.length&&void 0!==d)||d,e&&(e.width=t,e.height=a,e.x=n,e.y=o,1!=i&&(e.scaleX=i),1!=s&&(e.scaleY=s),f(e,r),e.touchEnabled=d)}function f(e,t){e&&(t?(e.texture||(e.texture=new egret.Texture),e.texture.bitmapData=t,e.$refreshImageData()):e.source=null)}function p(e,t,a,n,o,c,u,l,r,i,s,d){r=8<arguments.length&&void 0!==r&&r,i=9<arguments.length&&void 0!==i?i:0,s=10<arguments.length&&void 0!==s?s:0,d=!(11<arguments.length&&void 0!==d)||d,e&&(e.size=t,e.textAlign=n,e.verticalAlign=a,e.text=o,e.textColor=c,e.x=u,e.y=l,e.bold=r,0<i&&(e.width=i),0<s&&(e.height=s),e.touchEnabled=d)}function v(e,t,a,n,o,r,c,i,s,d){i=7<arguments.length&&void 0!==i&&i,s=8<arguments.length&&void 0!==s?s:-1,d=9<arguments.length&&void 0!==d?d:0,e&&(e.graphics.clear(),0<=s&&e.graphics.lineStyle(s,d),e.graphics.beginFill(r,c),e.graphics.drawRect(t,a,n,o),e.graphics.endFill(),e.touchEnabled=i)}function w(e,t,a,n,o,r,i,s,d){i=6<arguments.length&&void 0!==i&&i,s=7<arguments.length&&void 0!==s?s:-1,d=8<arguments.length&&void 0!==d?d:0,e&&(e.graphics.clear(),0<=s&&e.graphics.lineStyle(s,d),e.graphics.beginFill(o,r),e.graphics.drawCircle(t,a,n),e.graphics.endFill(),e.touchEnabled=i)}var x=function(){function e(){i(this,e),this.key=""}return V4(e,[{key:"setItem",value:function(e,t,a,n){var o=this;o.init(),o.key=n,o.arrow.visible=a,e&&e.addChild(o.g1),o.txt.text=t}},{key:"setXY",value:function(e,t){this.g1.x=e,this.g1.y=t}},{key:"removeFromP",value:function(){this.g1&&this.g1.parent&&this.g1.parent.removeChild(this.g1)}},{key:"init",value:function(){var e=this;var t;e.txt||(e.g1=new L,h(e.g1,750,92,0,0,!0),e.g1.addEventListener(r,e.touch,e),v(t=new u,0,0,750,90,16777215,1,!1),e.g1.addChild(t),v(t=new u,0,0,750,2,15263976,1,!1),e.g1.addChild(t),e.txt=new o,p(e.txt,32,"middle","left","\u8bf7\u9009\u62e9\u6295\u8bc9\u539f\u56e0",3355443,30,0,!1,0,92,!1),e.g1.addChild(e.txt),e.arrow=new a,m(e.arrow,22,36,702,31,n.back),e.g1.addChild(e.arrow))}},{key:"touch",value:function(e){R&&R.selectReason(this.key)}}]),e}(),S=function(){function e(t,a,n){i(this,e),this.stageW=0,this.stageH=0,this.curPageIndex=-1,this.curReasonK="",this.loading=!1,this.loadTips=!1,this.curPk="z",this.touSuItems=[],this.touSuPool=[],this.isSelEvidence=!1,this.tmpUploadImgs={},this.touSuImgs=[],this.touSuImgId=0;var o=this;o.stageW=a,o.stageH=n,o.stage=t,o.group=new L,o.group.width=750,o.group.height=1334,o.groupB=new L,o.groupB.width=a,o.groupB.height=n,o.groupB.touchEnabled=!0,o.bgRect=new u,v(o.bgRect,0,0,o.groupB.width,o.groupB.height,16316664,1,!1),o.groupB.addChild(o.bgRect),o.groupB.addChild(o.group);var r=+Math.min(a/750,n/1334).toFixed(2);o.group.touchEnabled=!1,o.group.scaleX=o.group.scaleY=r,o.group.x=(a-o.group.width*r)/2,o.group.y=(n-o.group.height*r)/2,t.addChild(o.groupB),o.imgLoader=new egret.ImageLoader,o.imgLoader.crossOrigin="anonymous";var s=[];for(var d in c)c[d]&&s.push(d);0<s.length?o.loadAssets(s,this.show,this):this.show()}return V4(e,[{key:"loadAssets",value:function(e,t,a){var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];this.loading||(this.loading=!0,this.imgLoader.addEventListener(E,this.loadSucc,this),this.imgLoader.addEventListener(T,this.loadFail,this),I=e,k="",this.loadCb=t,this.loadCbThis=a,this.loadTips=n,this.loadAssetsPer())}},{key:"loadAssetsPer",value:function(){0<I.length&&(k=I.pop(),this.imgLoader.load(c[k]))}},{key:"loadSucc",value:function(e){e.currentTarget.data&&(n[k]=e.currentTarget.data),0<I.length?this.loadAssetsPer():(this.imgLoader.removeEventListener(E,this.loadSucc,this),this.imgLoader.removeEventListener(T,this.loadFail,this),this.loading&&(this.loading=!1,this.loadCb&&this.loadCb.call(this.loadCbThis)))}},{key:"loadFail",value:function(e){n[k]=null,this.loadTips&&t.wx_tips("\u7f51\u7edc\u5dee\uff0c\u52a0\u8f7d\u5931\u8d25"),console.warn("loadFail--\x3e",k),0<I.length?this.loadAssetsPer():(this.imgLoader.removeEventListener(E,this.loadSucc,this),this.imgLoader.removeEventListener(T,this.loadFail,this),this.loading&&(this.loading=!1,this.loadCb&&this.loadCb.call(this.loadCbThis)))}},{key:"show",value:function(){this.init(),this.gotoView(0)}},{key:"gotoView",value:function(e){e!=this.curPageIndex&&(this.curPageIndex=e,this.touSuRedener(O))}},{key:"init",value:function(){var e=this;e.g1=new L,h(e.g1,750,1334,0,0),e.group.addChild(e.g1),e.gameIcon=new a,m(e.gameIcon,140,140,305,252,n.gameIco,1,1,!1),e.g1.addChild(e.gameIcon);var t=new u;w(t,376,322,70,14211288,1,!1),e.g1.addChild(t),e.gameIcon.mask=t,e.tip=new o,p(e.tip,40,"middle","center","",3355443,0,440,!1,750),e.g1.addChild(e.tip),e.tip0=new o,p(e.tip0,28,"middle","center","",13421772,0,500,!1,750),e.g1.addChild(e.tip0),e.tip1=new o,p(e.tip1,28,"middle","center","\u5f00\u53d1\u8005\u5c06\u5728\u5b8c\u6210\u66f4\u65b0\u540e\u5c3d\u5feb\u6062\u590d\u670d\u52a1\uff0c\u8bf7\u7a0d\u540e",13421772,0,540,!1,750,0,!0),e.g1.addChild(e.tip1),e.tip2=new o,p(e.tip2,28,"middle","center","\u6295\u8bc9\u4e0e\u53cd\u9988",8686748,0,1194,!1,750),e.g1.addChild(e.tip2),e.tip2.addEventListener(r,e.click,e),e.g2=new L,h(e.g2,750,1334,0,0),e.group.addChild(e.g2),v(t=new u,0,0,750,88,16777215,1),e.g2.addChild(t),e.touSuItemG=new L,h(e.touSuItemG,750,1156,0,178),e.g2.addChild(e.touSuItemG),e.tip3=new o,p(e.tip3,28,"middle","left","\u8bf7\u9009\u62e9\u6295\u8bc9\u539f\u56e0",10066329,30,88,!1,0,90),e.g2.addChild(e.tip3),e.tip8=new o,p(e.tip8,28,"middle","center","\u5982\u9047\u5230\u95ee\u9898\uff0c\u8054\u7cfb\u5f00\u53d1\u5ba2\u670d",8686748,0,1218,!1,750,0),e.g2.addChild(e.tip8),e.tip9=new o,p(e.tip9,28,"middle","center","QQ\uff1a"+s.customer_service_qq+"      \u7535\u8bdd\uff1a"+s.customer_service_tel,8686748,0,1274,!1,750,0),e.g2.addChild(e.tip9),e.g3=new L,h(e.g3,750,1334,0,0),e.group.addChild(e.g3),v(t=new u,0,0,750,88,16777215,1),e.g3.addChild(t),e.tip4=new o,p(e.tip4,28,"middle","left","\u8bf7\u9009\u62e9\u6295\u8bc9\u539f\u56e0",10066329,30,88,!1,0,90),e.g3.addChild(e.tip4),v(t=new u,-5,178,760,118,16777215,1,!1,1,15263976),e.g3.addChild(t),e.gameIco=new a,m(e.gameIco,64,64,28,205,n.gameIco,1,1,!1),e.g3.addChild(e.gameIco),e.gameIcoR=new u,w(e.gameIcoR,60,237,32,16777215,1,!1),e.g3.addChild(e.gameIcoR),e.gameIco.mask=e.gameIcoR,e.tip5=new o,p(e.tip5,32,"middle","left","\u6295\u8bc9\u63cf\u8ff0",10066329,30,296,!1,0,90,!1),e.g3.addChild(e.tip5),e.gameName=new o,p(e.gameName,36,"middle","left",s.name,3355443,134,192,!1,0,90),e.g3.addChild(e.gameName),v(t=new u,-5,386,760,596,16777215,1,!1,2,15263976),e.g3.addChild(t),v(t=new u,20,476,710,2,15263976,1,!1),e.g3.addChild(t),v(t=new u,20,722,710,2,15263976,1,!1),e.g3.addChild(t),e.reasonDesc=new o,p(e.reasonDesc,32,"top","left","",3355443,30,486,!1,690,230),e.reasonDesc.type=G,e.reasonDesc.maxChars=100,e.reasonDesc.multiline=!0,e.reasonDesc.wordWrap=!0,e.reasonDesc.lineSpacing=2,e.g3.addChild(e.reasonDesc),e.reasonLab=new o,p(e.reasonLab,32,"middle","left",d[this.curReasonK]?d[this.curReasonK].txt:"",3355443,30,386,!1,0,90),e.g3.addChild(e.reasonLab),e.tip6=new o,p(e.tip6,32,"middle","left","\u8bc1\u636e\u622a\u56fe",10066329,30,719,!1,0,90),e.g3.addChild(e.tip6),e.descNumLab=new o,p(e.descNumLab,32,"middle","right","0/100",11842740,511,679,!1,200,0),e.g3.addChild(e.descNumLab),e.pcNumLab=new o,p(e.pcNumLab,32,"middle","right","0/2",11842740,511,748,!1,200,0),e.g3.addChild(e.pcNumLab),e.tip7=new o,p(e.tip7,28,"middle","left","\u5141\u8bb8\u5fae\u4fe1\u4f7f\u7528\u5c0f\u7a0b\u5e8f\u5f53\u524d\u9875\u9762\u7684\u6570\u636e\u4f5c\u4e3a\u6295\u8bc9\u8bc1\u636e",11842740,70,1008),e.g3.addChild(e.tip7),e.selRect=new u,v(e.selRect,30,1008,28,28,16777215,1,!0,1,4473924),e.g3.addChild(e.selRect),e.gouImg=new a,m(e.gouImg,28,28,30,1008,n.gou,1,1,!0),e.g3.addChild(e.gouImg),e.pcImg=new a,m(e.pcImg,160,160,30,806,n.add,1,1,!0),e.g3.addChild(e.pcImg),e.pcImg2=new a,m(e.pcImg2,160,160,210,806,null,1,1,!0),e.pcImg2.touchEnabled=!1,e.g3.addChild(e.pcImg2),e.submitImg=new a,m(e.submitImg,694,96,28,1154,n.submit,1,1,!0),e.g3.addChild(e.submitImg),e.selRect.addEventListener(r,e.click,e),e.gouImg.addEventListener(r,e.click,e),e.pcImg.addEventListener(r,e.click,e),e.pcImg2.addEventListener(r,e.click,e),e.submitImg.addEventListener(r,e.click,e),e.reasonDesc.addEventListener(M,e.txtChange,e),e.backImg=new a,m(e.backImg,22,36,46,26,n.back,-1),e.group.addChild(e.backImg),e.backImg.addEventListener(r,e.click,e)}},{key:"setReasonItems",value:function(e){var t=this,a=0;if(t.curPk!=e){for(var n in t.curPk=e,d){var o;d[n].pKey==t.curPk&&(o=void 0,(a+=1)<=t.touSuItems.length?o=t.touSuItems[a-1]:(o=t.getReasonItem(),t.touSuItems.push(o)),o&&o.setItem(t.touSuItemG,d[n].txt,d[n].hasSub,d[n].key))}if(a<t.touSuItems.length)for(var r=t.touSuItems.length-a,i=0;i<r;i++)t.recycleReasonItem(t.touSuItems.pop());for(var s=0;s<t.touSuItems.length;s++)t.touSuItems[s].setXY(0,92*s);t.tip8.y=t.touSuItemG.y+92*t.touSuItemG.numChildren+68,t.tip9.y=t.tip8.y+56}}},{key:"getReasonItem",value:function(){return 0<this.touSuPool.length?this.touSuPool.pop():new x}},{key:"recycleReasonItem",value:function(e){e&&(e.removeFromP(),this.touSuPool.push(e))}},{key:"selectReason",value:function(e){var t=d[e];t?t.hasSub?this.setReasonItems(t.key):(this.curReasonK=e,this.gotoView(2)):console.warn("\u4e0d\u5b58\u5728\u7684\u6295\u8bc9\u539f\u56e0:",e)}},{key:"touSuRedener",value:function(e){var t=this;switch(g(t.backImg,0!=t.curPageIndex),g(t.g1,0==t.curPageIndex),g(t.g2,1==t.curPageIndex),g(t.g3,2==t.curPageIndex),v(t.bgRect,0,0,t.groupB.width,t.groupB.height,0==t.curPageIndex?16777215:16316664,1,!1),t.curPageIndex){case 0:t.tip.text=s.name+"\u5c0f\u7a0b\u5e8f\u7cfb\u7edf\u66f4\u65b0\u7ef4\u62a4\u4e2d",t.tip0.text="\u9884\u8ba1\u6062\u590d\u65f6\u95f4\uff1a"+s.restore_time;break;case 1:t.setReasonItems(e);break;case 2:var a=d[this.curReasonK];t.reasonLab.text=a?a.txt:"",t.reasonDesc.text="",t.descNumLab.text="0/100",t.pcNumLab.text="0/2",g(t.gouImg,t.isSelEvidence);var a=t._updateComplieImg(t.pcImg,c.add,""),n=t._updateComplieImg(t.pcImg2,"","");var o;a||n?(o=[],a&&c[a]&&o.push(a),n&&c[n]&&o.push(n),o&&this.loadAssets(o,this._updateComplieImgShow,this,!0)):this._updateComplieImgShow()}}},{key:"_updateComplieImg",value:function(e,t,a){if(c[e.hashCode+"_img"]!=a&&(c[e.hashCode+"_img"]=a),c[e.hashCode+"_pre"]!=t)if((c[e.hashCode+"_pre"]=t)==c.add?n[e.hashCode+"_pre"]=n.add:n[e.hashCode+"_pre"]=null,n[e.hashCode+"_pre"])f(e,n[e.hashCode+"_pre"]);else{if(""!=t)return e.hashCode+"_pre";f(e,null)}return""}},{key:"_updateComplieImgShow",value:function(){var e=0,t=n[this.pcImg.hashCode+"_pre"],a=n[this.pcImg2.hashCode+"_pre"];t&&(e+=1),a&&(e+=1),a=a||(t&&t!=n.add?n.add:null),t=t||n.add,f(this.pcImg,t),f(this.pcImg2,a),this.pcNumLab.text=Math.min(e,2)+"/2",this.pcImg2.touchEnabled=1<=e}},{key:"click",value:function(e){var t=this,a=this;switch(e.currentTarget){case a.tip2:a.gotoView(1);break;case a.selRect:case a.gouImg:a.isSelEvidence=!a.isSelEvidence,g(a.gouImg,a.isSelEvidence);break;case a.pcImg:var n=a.pcImg.hashCode.toString();a.wx_chooseImage(1,s.uploadUrl,n).then(function(e){!e||(e=a._updateComplieImg(a.pcImg,e.preview_url,e.url))&&c[e]&&a.loadAssets([e],a._updateComplieImgShow,t,!0)});break;case a.pcImg2:n=a.pcImg2.hashCode.toString(),a.wx_chooseImage(1,s.uploadUrl,n).then(function(e){!e||(e=a._updateComplieImg(a.pcImg2,e.preview_url,e.url))&&c[e]&&a.loadAssets([e],a._updateComplieImgShow,t,!0)});break;case a.submitImg:var n=c[a.pcImg.hashCode+"_img"],o=c[a.pcImg2.hashCode+"_img"];o={title:a.reasonLab.text,content:a.reasonDesc.text,image:n=o?n?n+","+o:o:n||""},console.warn("\u622a\u5c4f-\u63d0\u4ea4\u6295\u8bc9"),s.api.complainReport(o),a.wx_tips("\u63d0\u4ea4\u6210\u529f"),a.gotoView(0);break;case a.backImg:2===a.curPageIndex?this.gotoView(1):1==a.curPageIndex&&(a.curPk==O?this.gotoView(0):(n=d[a.curPk],a.touSuRedener(n.pKey)))}}},{key:"txtChange",value:function(e){e=Math.min(e.target.text.length,100),this.descNumLab.text=e+"/100"}},{key:"wx_tips",value:function(e){wx.showToast&&wx.showToast({title:e})}},{key:"wx_chooseImage",value:function(e,o,r){var i=this;return new Promise(function(a,n){wx.chooseImage({count:e,sizeType:["compressed"],sourceType:["album","camera"],success:function(e){var t=e.tempFilePaths[0];if(0<=wx.getSystemInfoSync().model.indexOf("iPhone"))return t=e.tempFilePaths[0],i.wx_uploadFile(o,t,r).then(function(e){e&&a(e)});i.tmpChooseCanvas||(i.tmpChooseCanvas=wx.createCanvas(),i.tmpChooseContext=i.tmpChooseCanvas.getContext("2d"),i.tmpChooseImg=wx.createImage(),i.tmpChooseCanvas.width=i.tmpChooseCanvas.height=160,i.tmpChooseImg.width=i.tmpChooseImg.height=160),i.tmpChooseImg.onload=function(){i.tmpChooseImg.onload=null,i.tmpChooseImg.onerror=null,i.tmpChooseImg.onabort=null,i.tmpChooseContext.drawImage(i.tmpChooseImg,0,0,160,160);var e=i.tmpChooseCanvas.toTempFilePathSync({x:0,y:0,width:160,height:160});return t=e,i.wx_uploadFile(o,t,r).then(function(e){e&&a(e)})},i.tmpChooseImg.onerror=function(){i.tmpChooseImg.onload=null,i.tmpChooseImg.onerror=null,i.tmpChooseImg.onabort=null,i.wx_tips("\u56fe\u7247\u5c3a\u5bf8\u8fc7\u5927"),console.warn("uploadFile\u52a0\u8f7d\u56fe\u7247\u5931\u8d25\uff1a",o),n()},i.tmpChooseImg.onabort=function(){i.tmpChooseImg.onload=null,i.tmpChooseImg.onerror=null,i.tmpChooseImg.onabort=null,n()},i.tmpChooseImg.src=e.tempFilePaths[0]},fail:function(){console.error("chooseImage\u63a5\u53e3\u8c03\u7528\u5931\u8d25"),n()}})})}},{key:"wx_uploadFile",value:function(e,t,o){var r=this;return new Promise(function(a,n){wx.uploadFile({url:e,filePath:t,name:"image",formData:{id:o},success:function(e){var t;console.info("uploadFileSucc:",e.data,e.statusCode),"string"==typeof e.data?0<=e.data.indexOf("<!")?(r.wx_tips("\u52a0\u8f7d\u5931\u8d25"),n()):(t=JSON.parse(e.data),a(t.data)):a(e.data.data)},fail:function(e){console.info("uploadFileFail:==>",e),n()}})})}}]),e}(),C=!1,P=!1,L=void 0,a=void 0,o=void 0,u=void 0,r=void 0,E=void 0,T=void 0,G=void 0,M=void 0,R=void 0,s={show:!1},d={},O="";function U(e){R||GameGlobal.egret&&(L=egret.DisplayObjectContainer,a=egret.Bitmap,o=egret.TextField,u=egret.Shape,egret.ImageLoader,egret.Texture,r=egret.TouchEvent.TOUCH_TAP,E=egret.Event.COMPLETE,T=egret.IOErrorEvent.IO_ERROR,G=egret.TextFieldType.INPUT,M=egret.Event.CHANGE,R=new S(e,e.stageWidth,e.stageHeight))}GameGlobal.initTouSuInfo=function(e,t){console.warn("initTouSuInfo=",e,t),P=!0,t&&(t="string"==typeof t?JSON.parent(t):t,(s=t).icon&&(c.gameIco=s.icon),t.list&&function e(t,a){var n=Object.keys(t);for(var o in n){var r=t[n[o]],i=a?a+"_"+o:o.toString(),s=r.item&&0<r.item.length;d[i]={index:o,key:i,pKey:a,txt:r.text,hasSub:s},s&&e(r.item,i)}}(t.list,O)),s.show=e},GameGlobal.showTouSu=function(e){P&&(C||(C=!0,wx.onUserCaptureScreen&&wx.onUserCaptureScreen(function(){s.show?(U(e),g(R.groupB,!0)):(console.warn("\u622a\u5c4f-\u4e0a\u4f20\u6295\u8bc9"),s.api.memberFreeze({}))})),console.warn("touSuInfo.show",s.show),s.show&&(U(e),g(R.groupB,!0)))}}.call(n,o,n,a))||(a.exports=r)}]);