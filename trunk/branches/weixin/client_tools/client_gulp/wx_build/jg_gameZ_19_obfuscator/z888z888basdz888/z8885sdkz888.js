var u=wx.$x;import huoSdk from"../utils/huosdk-2.2.1";var config={game_id:256,game_pkg:u[1795],partner_label:u[1796],partner_id:u[1797],game_ver:u[1798],is_auth:!1,appId:u[1799],mpId:u[1800],appName:u[1801]};window.config=config;var x1G08A6=x1G86A0();var HOST=u[1802];var x1G086A=null;var x1G8A60=null;var sysInfo=wx.getSystemInfoSync();var platform=sysInfo.platform;var partner_user_info=null;function x1G86A0(){var a={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0;console.log(u[1803]);var o=this;var t;t=wx.getStorageSync(u[1804])?0:(t=o.uuid(16,32),wx.setStorageSync(u[1804],t),1),wx.getStorageSync(u[1805])||(n=o.uuid(16,32),wx.setStorageSync(u[1805],n));var n=wx.getLaunchOptionsSync();var a=n.scene||"";t&&n.query&&n.query.ad_code&&wx.setStorageSync(u[1806],n.query.ad_code),o.log(u[1807],{install:t,scene:a}),wx.showShareMenu();o=n.query&&n.query.invite?n.query.invite:"";n=n.query&&n.query.invite_type?n.query.invite_type:"";o&&(x1G8A60={invite:o,invite_type:n,is_new:t,scene:a}),huoSdk.init({app_id:config[u[1808]],mp_id:config[u[1809]]}).then(e=>{200==e.code?console.log(u[1810],e):r&&r(1,{errMsg:u[1811]})}).catch(e=>{console.log(u[1812],e),r&&r(1,{errMsg:u[1811]})}),e&&this.checkGameVersion(e,function(e){r&&r(e)})},login:function(e,r){console.log(u[1813]),a[u[260]]=typeof r==u[1007]?r:null;var o=this;var t=wx.getLaunchOptionsSync();huoSdk.login({state:t.query.state||t.query.scene||""}).then(e=>{200==e.code?(partner_user_info={user_token:e.data.cp_user_token,mem_id:e.data.mg_mem_id},o.do_login(partner_user_info),console.log(u[1814]+JSON.stringify(e))):(r(1,{errMsg:u[1815]}),console.log(u[1816]+JSON.stringify(e)))}).catch(e=>{r(1,{errMsg:u[1815]}),console.log(u[1816]+JSON.stringify(e))})},do_login:function(e){var r=this.getPublicData();if(r[u[1817]]=JSON.stringify(e),x1G8A60&&typeof x1G8A60==u[907])for(var o in x1G8A60)r[o]=x1G8A60[o];wx.request({url:u[1818]+HOST+u[1819],method:u[225],dataType:u[1252],header:{"content-type":u[405]},data:r,success:function(e){if(console.log(u[1820]+JSON.stringify(e)),200==e.statusCode){e=e.data;if(e.state){try{wx.getStorageSync(u[1821])||wx.setStorageSync(u[1822],new Date),Date.parse(wx.getStorageSync(u[1822])).toString().substr(0,10),partner_user_info={open_id:e.data.ext,user_id:e.data.user_id},wx.setStorageSync(u[1823],e.data.sdk_token),wx.setStorageSync(u[1821],e.data.user_id),wx.setStorageSync(u[1824],e.data.username),e.data.ext&&wx.setStorageSync(u[1825],e.data.ext)}catch(e){}var r={userid:e.data.user_id,account:e.data.nick_name,token:e.data.token,invite_uid:e.data.invite_uid||"",invite_nickname:e.data.invite_nickname||"",invite_head_img:e.data.invite_head_img||"",head_img:e.data.head_img||"",is_client:e.data.is_client||"0",ios_pay:e.data.ios_pay||"0"};a[u[260]]&&a[u[260]](0,r)}else a[u[260]]&&a[u[260]](1,{errMsg:e.msg})}else a[u[260]]&&a[u[260]](1,{errMsg:u[1826]})}})},share:function(e){a[u[362]]=typeof callback==u[1007]?callback:null;var r=e.type||u[362];console.log(u[1827]+r);var o=this;this.getShareInfo(r,function(e){o.logStartShare(r);e.query;o.logStartShare(r),wx.shareAppMessage({title:e.title,imageUrl:e.img,query:e.query})})},logStartShare:function(e){var r=wx.getStorageSync(u[1823]);wx.request({url:u[1818]+HOST+u[1828],method:u[225],dataType:u[1252],header:{"content-type":u[405]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:x1G086A?x1G086A.server_id:"",role_id:x1G086A?x1G086A.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,o){console.log(u[1829]);wx.getStorageSync(u[1823]);wx.request({url:u[1818]+HOST+u[1830],method:u[225],dataType:u[1252],header:{"content-type":u[405]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(u[1831]+JSON.stringify(e)),200==e.statusCode&&(r=e.data).state?o&&o(r.data):o&&o({develop:0})}})},getShareInfo:function(e,r){console.log(u[1832]);var o=wx.getStorageSync(u[1823]);wx.request({url:u[1818]+HOST+u[1833],method:u[225],dataType:u[1252],header:{"content-type":u[405]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:o,type:e,server_id:x1G086A?x1G086A.server_id:"",role_id:x1G086A?x1G086A.role_id:"",no_log:1},success:function(e){console.log(u[1834]),console.log(e),200==e.statusCode?(e=e.data).state?r&&r(e.data):a[u[362]]&&a[u[362]](1,{errMsg:u[1835]+e.msg}):a[u[362]]&&a[u[362]](1,{errMsg:u[1836]})}})},updateShare:function(e,r,o,t,n,a){console.log(u[1837]);var i=wx.getStorageSync(u[1823]);wx.request({url:u[1818]+HOST+u[1838],method:u[225],dataType:u[1252],header:{"content-type":u[405]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:r,is_new:o,role_id:t,sever_id:n,scene:a},success:function(e){console.log(u[1839]+JSON.stringify(e))}})},msgCheck2:function(e,r){console.log(u[1840],e),sdk.msgSecCheck(e).then(e=>{console.log(u[1841],e),r&&r(e)}).catch(e=>{console.log(u[1812],e),r&&r(res)})},msgCheck:function(e,r){console.log(u[1840],e);let o={data:{}};e={data:{content:e}};huoSdk.checkMsg(e).then(e=>{console.log(u[1841],e),200==e.code?o.data.state=1:o.data.state=0,o.statusCode=200,r&&r(o)}).catch(e=>{console.log(u[1812],e),o.data.state=0,o.statusCode=0,r&&r(o)})},pay:function(e,r){this.startPay(e,r)},startPay:function(e,r){console.log(u[1842]+JSON.stringify(e));var o=this;a[u[344]]=typeof r==u[1007]?r:null;r=wx.getStorageSync(u[1823]);var t=wx.getStorageSync(u[1825]);var n;r?(n={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:r,session_key:t,platform:platform},o.order_data=n,(e=o.getPublicData())[u[1844]]=JSON.stringify(n),wx.request({url:u[1818]+HOST+u[1845],method:u[225],dataType:u[1252],header:{"content-type":u[405]},data:e,success:function(e){var r;console.log(u[1846]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?""==e.data.ext?(r={data:{"order-currency":u[1847],"order-cp_order_id":e.data.orderId,"order-product_price":n.price,"order-product_id":n.productid,"order-product_cnt":1,"order-product_name":n.productname,"order-product_desc":n.productdesc,"order-ext":n.extension,"role-event":"5","role-server_id":n.serverid,"role-server_name":n.servername,"role-role_id":n.roleid,"role-role_name":n.rolename,"role-role_level":n.rolelevel,"role-role_vip":0}},console.log(u[1848]+JSON.stringify(r)),huoSdk.checkPay(r).then(e=>{console.log(u[1841],e)}).catch(e=>{console.log(u[1849],e)})):(r={ext1:e.data.ext,ext2:{pay_data:{orderId:e.data.orderId,amount:n.price}}},console.log(u[1850],r),o.extDo(r)):a[u[344]]&&a[u[344]](1,{errMsg:e.msg}):a[u[260]]&&a[u[260]](1,{errMsg:u[1826]})}})):a[u[344]]&&a[u[344]](1,{errMsg:u[1843]})},extDo:function(e){wx.navigateToMiniProgram({appId:e.ext1,path:u[1851]+e.ext2.pay_data.orderId+u[1852]+e.ext2.pay_data.amount,extraData:{},envVersion:u[1853],success(e){}})},gameGoPay:function(e,r){console.log(u[1854]);wx.getStorageSync(u[1825]);wx.request({url:u[1818]+HOST+u[1855]+config.partner_id+"/"+config.game_pkg+"/",method:u[225],dataType:u[1252],header:{"content-type":u[405]},data:{uid:partner_user_info.user_id,open_id:partner_user_info.open_id,user_create_time:wx.getStorageSync(u[1822]),in_sandbox:r.sandbox,cp_order_no:e.cpbill,amount:e.price},success:function(e){console.log(u[1856]),console.log(e),200==e.statusCode&&(1==e.data.state?a[u[344]]&&a[u[344]](0,{}):a[u[344]]&&a[u[344]](1,{errMsg:u[1857]}))},fail:function(){}})},logCreateRole:function(e){var r=wx.getStorageSync(u[1821]);var o=wx.getStorageSync(u[1824]);var t={};t[u[1858]]=r,t[u[1859]]=o,t[u[1860]]=e.roleid,t[u[1861]]=e.rolelevel,t[u[1862]]=e.rolename,t[u[24]]=e.serverid,console.log(u[1863],t),e.roleid&&e.serverid&&(x1G086A={role_id:e.roleid,server_id:e.serverid}),this.log(u[486],t),Date.parse(new Date).toString().substr(0,10),huoSdk.updateRole({data:{"role-event":"2","role-server_id":e.serverid,"role-server_name":e.servername,"role-role_id":e.roleid,"role-role_name":e.rolename,"role-role_level":e.rolelevel,"role-role_vip":0,"role-combat_num":0}}).then(e=>{200==e.code?console.log(u[1864],e):console.log(u[1865],e)},e=>{console.log(u[1866],e)})},logEnterGame:function(e){var r=wx.getStorageSync(u[1821]);var o=wx.getStorageSync(u[1824]);var t={};t[u[1858]]=r,t[u[1859]]=o,t[u[1860]]=e.roleid,t[u[1861]]=e.rolelevel,t[u[1862]]=e.rolename,t[u[24]]=e.serverid,e.roleid&&e.serverid&&(x1G086A={role_id:e.roleid,server_id:e.serverid}),this.log(u[1867],t),x1G8A60&&this.updateShare(x1G8A60.invite,x1G8A60.invite_type,x1G8A60.is_new,e.roleid,e.serverid,x1G8A60.scene),huoSdk.updateRole({data:{"role-event":"1","role-server_id":e.serverid,"role-server_name":e.servername,"role-role_id":e.roleid,"role-role_name":e.rolename,"role-role_level":e.rolelevel,"role-role_vip":0,"role-combat_num":0}}).then(e=>{200==e.code?console.log(u[1868],e):console.log(u[1869],e)},e=>{console.log(u[1870],e)})},logRoleUpLevel:function(e){var r=wx.getStorageSync(u[1821]);var o=wx.getStorageSync(u[1824]);var t={};t[u[1858]]=r,t[u[1859]]=o,t[u[1860]]=e.roleid,t[u[1861]]=e.rolelevel,t[u[1862]]=e.rolename,t[u[24]]=e.serverid,e.roleid&&e.serverid&&(x1G086A={role_id:e.roleid,server_id:e.serverid}),this.log(u[1871],t),huoSdk.updateRole({data:{"role-event":"3","role-server_id":e.serverid,"role-server_name":e.servername,"role-role_id":e.roleid,"role-role_name":e.rolename,"role-role_level":e.rolelevel,"role-role_vip":0,"role-combat_num":0}}).then(e=>{200==e.code?console.log(u[1872],e):console.log(u[1873],e)},e=>{console.log(u[1874],e)})},uuid:function(e,r){var o=u[1875].split("");var t,n=[];var a;if(e=e||o.length,r)for(t=0;t<r;t++)n[t]=o[0|Math.random()*e];else for(n[8]=n[13]=n[18]=n[23]="-",n[14]="4",t=0;t<36;t++)n[t]||(a=0|16*Math.random(),n[t]=o[19==t?3&a|8:a]);return n.join("")},getPublicData:function(){var e=wx.getStorageSync(u[1804]);var r=wx.getStorageSync(u[1805]);var o=wx.getStorageSync(u[1806]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:o,uuid:e,idfv:r,mac:u[1876],is_from_min:1,dname:sysInfo.model,net_type:0==sysInfo.wifiSignal?"4G":u[1877],os_ver:sysInfo.system,sdk_ver:sysInfo.version,game_ver:config.game_ver,device:sysInfo.platform==u[111]?1:2}},subscribeMessage:function(e,r){console.log(u[1878]+e),a[u[373]]=typeof r==u[1007]?r:null,wx.requestSubscribeMessage({tmplIds:e,success(e){console.log(u[1879]),console.log(e),a[u[373]]&&a[u[373]](e)},fail(e){console.log(u[1880]),console.log(e),a[u[373]]&&a[u[373]](e)}})},log:function(e,r){var o=this.getPublicData();for(var t in r)o[t]=r[t];console.log(u[1881]+e),console.log(o),wx.request({url:u[1818]+HOST+u[1882]+e+u[1883]+encodeURIComponent(JSON.stringify(o))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(){},reportStart:function(){JYSDK.sendLoadingLog(u[1807])},reportEnd:function(){JYSDDK.sendLoadingLog(u[1199])},setMessageToFriendQuery:function(e,r){e=e.activity_id;r(wx.setMessageToFriendQuery({shareMessageToFriendScene:e}))}}}function run(e,r,o){e in x1G08A6&&x1G08A6[e](r,o)}exports.init=function(e,r){run(u[238],e,r)},exports.subscribeMessage=function(e,r){run(u[373],e,r)},exports.login=function(e){run(u[260],"",e)},exports.login=function(e){run(u[260],"",e)},exports.pay=function(e,r){run(u[344],e,r)},exports.openService=function(){run(u[363])},exports.logCreateRole=function(e,r,o,t,n){run(u[357],{serverid:e,servername:r,roleid:o,rolename:t,rolelevel:n})},exports.logEnterGame=function(e,r,o,t,n){run(u[359],{serverid:e,servername:r,roleid:o,rolename:t,rolelevel:n})},exports.logRoleUpLevel=function(e,r,o,t,n){run(u[361],{serverid:e,servername:r,roleid:o,rolename:t,rolelevel:n})},exports.share=function(e){run(u[362],{type:e})},exports.msgCheck=function(e,r){run(u[201],e,r)},exports.downloadClient=function(){run(u[1884])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(u[1885])},exports.weiduanHelper=function(){run(u[365])},exports.reportStart=function(){run(u[1886])},exports.reportEnd=function(){run(u[1887])},exports.setMessageToFriendQuery=function(e,r){run(u[1888],e,r)};