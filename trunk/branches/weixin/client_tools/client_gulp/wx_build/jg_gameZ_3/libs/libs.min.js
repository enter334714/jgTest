var Laya=window.Laya=function(b$X,b$M){var b$F={__internals:[],__packages:{},__classmap:{Object:Object,Function:Function,Array:Array,String:String},__sysClass:{object:"Object",array:"Array",string:"String",dictionary:"Dictionary"},__propun:{writable:!0,enumerable:!1,configurable:!0},__presubstr:String.prototype.substr,__substr:function(b$M,b$y){return 1==arguments.length?b$F.__presubstr.call(this,b$M):b$F.__presubstr.call(this,b$M,0<b$y?b$y:this.length+b$y)},__init:function(b$M){b$M.forEach(function(b$M){b$M.__init$&&b$M.__init$()})},__isClass:function(b$M){return b$M&&(b$M.__isclass||b$M==Object||b$M==String||b$M==Array)},__newvec:function(b$M,b$y){var b$i=[];b$i.length=b$M;for(var b$H=0;b$H<b$M;b$H++)b$i[b$H]=b$y;return b$i},__extend:function(b$M,b$y){for(var b$i in b$y)if(b$y.hasOwnProperty(b$i)){var b$H=Object.getOwnPropertyDescriptor(b$y,b$i),b$S=b$H.get,b$f=b$H.set;b$S||b$f?b$S&&b$f?Object.defineProperty(b$M,b$i,b$H):(b$S&&Object.defineProperty(b$M,b$i,b$S),b$f&&Object.defineProperty(b$M,b$i,b$f)):b$M[b$i]=b$y[b$i]}function b$V(){b$F.un(this,"constructor",b$M)}b$V.prototype=b$y.prototype,b$M.prototype=new b$V,b$F.un(b$M.prototype,"__imps",b$F.__copy({},b$y.prototype.__imps))},__copy:function(b$M,b$y){if(!b$y)return null;for(var b$i in b$M=b$M||{},b$y)b$M[b$i]=b$y[b$i];return b$M},__package:function(b$M,b$y){if(!b$F.__packages[b$M]){b$F.__packages[b$M]=!0;var b$i=b$X,b$H=b$M.split(".");if(1<b$H.length)for(var b$S=0,b$f=b$H.length-1;b$S<b$f;b$S++){var b$V=b$i[b$H[b$S]];b$i=b$V||(b$i[b$H[b$S]]={})}b$i[b$H[b$H.length-1]]||(b$i[b$H[b$H.length-1]]=b$y||{})}},__hasOwnProperty:function(b$M,b$y){return b$y=b$y||this,Object.hasOwnProperty.call(b$y,b$M)||function b$M(b$y,b$i){if(Object.hasOwnProperty.call(b$i.prototype,b$y))return!0;var b$H=b$i.prototype.__super;return null==b$H?null:b$M(b$y,b$H)}(b$M,b$y.__class)},__typeof:function(b$M,b$y){if(!b$M||!b$y)return!1;if(b$y===String)return"string"==typeof b$M;if(b$y===Number)return"number"==typeof b$M;if(b$y.__interface__)b$y=b$y.__interface__;else if("string"!=typeof b$y)return b$M instanceof b$y;return b$M.__imps&&b$M.__imps[b$y]||b$M.__class==b$y},__as:function(b$M,b$y){return this.__typeof(b$M,b$y)?b$M:null},__int:function(b$M){return b$M?parseInt(b$M):0},interface:function(b$M,b$y){b$F.__package(b$M,{});var b$i=b$F.__internals,b$H=b$i[b$M]=b$i[b$M]||{self:b$M};if(b$y){var b$S=b$y.split(",");b$H.extend=[];for(var b$f=0;b$f<b$S.length;b$f++){var b$V=b$S[b$f];b$i[b$V]=b$i[b$V]||{self:b$V},b$H.extend.push(b$i[b$V])}}var b$K=b$X,b$k=b$M.split(".");for(b$f=0;b$f<b$k.length-1;b$f++)b$K=b$K[b$k[b$f]];b$K[b$k[b$k.length-1]]={__interface__:b$M}},class:function(b$M,b$y,b$i,b$H){if(b$i&&b$F.__extend(b$M,b$i),b$y)if(b$F.__package(b$y,b$M),b$F.__classmap[b$y]=b$M,0<b$y.indexOf(".")){if(0==b$y.indexOf("laya.")){var b$S=b$y.split(".");b$H=b$H||b$S[b$S.length-1],b$F[b$H]&&console.log("Warning!,this class["+b$H+"] already exist:",b$F[b$H]),b$F[b$H]=b$M}}else"Main"==b$y?b$X.Main=b$M:"MainWX"==b$y?b$X.MainWX=b$M:(b$F[b$y]&&console.log("Error!,this class["+b$y+"] already exist:",b$F[b$y]),b$F[b$y]=b$M);var b$f=b$F.un,b$V=b$M.prototype;b$f(b$V,"hasOwnProperty",b$F.__hasOwnProperty),b$f(b$V,"__class",b$M),b$f(b$V,"__super",b$i),b$f(b$V,"__className",b$y),b$f(b$M,"__super",b$i),b$f(b$M,"__className",b$y),b$f(b$M,"__isclass",!0),b$f(b$M,"super",function(b$M){this.__super.call(b$M)})},imps:function(b$M,b$y){if(!b$y)return null;var b$S=b$M.__imps||b$F.un(b$M,"__imps",{});function b$f(b$M){var b$y,b$i;if((b$y=b$F.__internals[b$M])&&(b$S[b$M]=!0,b$i=b$y.extend))for(var b$H=0;b$H<b$i.length;b$H++)b$f(b$i[b$H].self)}for(var b$i in b$y)b$f(b$i)},superSet:function(b$M,b$y,b$i,b$H){var b$S=b$M.prototype["_$set_"+b$i];b$S&&b$S.call(b$y,b$H)},superGet:function(b$M,b$y,b$i){var b$H=b$M.prototype["_$get_"+b$i];return b$H?b$H.call(b$y):null},getset:function(b$M,b$y,b$i,b$H,b$S){b$M?(b$H&&(b$y["_$GET_"+b$i]=b$H),b$S&&(b$y["_$SET_"+b$i]=b$S)):(b$H&&b$F.un(b$y,"_$get_"+b$i,b$H),b$S&&b$F.un(b$y,"_$set_"+b$i,b$S)),b$H&&b$S?Object.defineProperty(b$y,b$i,{get:b$H,set:b$S,enumerable:!1,configurable:!0}):(b$H&&Object.defineProperty(b$y,b$i,{get:b$H,enumerable:!1,configurable:!0}),b$S&&Object.defineProperty(b$y,b$i,{set:b$S,enumerable:!1,configurable:!0}))},static:function(b$i,b$H){for(var b$S=0,b$M=b$H.length;b$S<b$M;b$S+=2)if("length"==b$H[b$S])b$i.length=b$H[b$S+1].call(b$i);else{function b$y(){var b$y=b$H[b$S],b$M=b$H[b$S+1];Object.defineProperty(b$i,b$y,{get:function(){return delete this[b$y],this[b$y]=b$M.call(this)},set:function(b$M){delete this[b$y],this[b$y]=b$M},enumerable:!0,configurable:!0})}b$y()}},un:function(b$M,b$y,b$i){return b$i||(b$i=b$M[b$y]),b$F.__propun.value=b$i,Object.defineProperty(b$M,b$y,b$F.__propun),b$i},uns:function(b$y,b$M){b$M.forEach(function(b$M){b$F.un(b$y,b$M)})}};return b$X.console=b$X.console||{log:function(){}},b$X.trace=b$X.console.log,Error.prototype.throwError=function(){throw arguments},Object.defineProperty(Array.prototype,"fixed",{enumerable:!1}),b$F}(window,document);!function(b$M,b$y,b$i){b$i.un,b$i.uns,b$i.static,b$i.class,b$i.getset,b$i.__newvec}(window,document,Laya),function(b$V,b$y,b$U){b$U.un,b$U.uns;var b$k=b$U.static,b$F=b$U.class,b$l=b$U.getset;b$U.__newvec;b$U.interface("laya.runtime.IMarket"),b$U.interface("laya.filters.IFilter"),b$U.interface("laya.display.ILayout"),b$U.interface("laya.resource.IDispose"),b$U.interface("laya.runtime.IPlatform"),b$U.interface("laya.resource.IDestroy"),b$U.interface("laya.runtime.IConchNode"),b$U.interface("laya.filters.IFilterAction"),b$U.interface("laya.runtime.ICPlatformClass"),b$U.interface("laya.resource.ICreateResource"),b$U.interface("laya.runtime.IConchRenderObject"),b$U.interface("laya.runtime.IPlatformClass","laya.runtime.IPlatform");var b$T=function(){function b$f(){}return b$F(b$f,"laya.utils.RunDriver"),b$f.FILTER_ACTIONS=[],b$f.pixelRatio=-1,b$f._charSizeTestDiv=null,b$f.now=function(){return Date.now()},b$f.getWindow=function(){return b$V},b$f.getPixelRatio=function(){if(b$f.pixelRatio<0){var b$M=b$u.context,b$y=b$M.backingStorePixelRatio||b$M.webkitBackingStorePixelRatio||b$M.mozBackingStorePixelRatio||b$M.msBackingStorePixelRatio||b$M.oBackingStorePixelRatio||b$M.backingStorePixelRatio||1;(b$f.pixelRatio=(b$u.window.devicePixelRatio||1)/b$y)<1&&(b$f.pixelRatio=1)}return b$f.pixelRatio},b$f.getIncludeStr=function(b$M){return null},b$f.createShaderCondition=function(b$M){var b$y="(function() {return "+b$M+";})";return b$U._runScript(b$y)},b$f.fontMap=[],b$f.measureText=function(b$M,b$y){var b$i=b$f.hanzi.test(b$M);if(b$i&&b$f.fontMap[b$y])return b$f.fontMap[b$y];var b$H=b$u.context;b$H.font=b$y;var b$S=b$H.measureText(b$M);return b$i&&(b$f.fontMap[b$y]=b$S),b$S},b$f.getWebGLContext=function(b$M){},b$f.beginFlush=function(){},b$f.endFinish=function(){},b$f.addToAtlas=null,b$f.flashFlushImage=function(b$M){},b$f.drawToCanvas=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=b$RM.create("2D"),b$K=new b$z(b$i,b$H,b$V);return b$w.renders[b$y]._fun(b$M,b$K,b$S,b$f),b$V},b$f.createParticleTemplate2D=null,b$f.createGLTextur=null,b$f.createWebGLContext2D=null,b$f.changeWebGLSize=function(b$M,b$y){},b$f.createRenderSprite=function(b$M,b$y){return new b$w(b$M,b$y)},b$f.createFilterAction=function(b$M){return new b$R},b$f.createGraphics=function(){return new b$d},b$f.clear=function(b$M){b$D._context.ctx.clear()},b$f.cancelLoadByUrl=function(b$M){},b$f.clearAtlas=function(b$M){},b$f.isAtlas=function(b$M){return!1},b$f.addTextureToAtlas=function(b$M){},b$f.getTexturePixels=function(b$M,b$y,b$i,b$H,b$S){return null},b$f.skinAniSprite=function(){return null},b$f.update3DLoop=function(){},b$k(b$f,["hanzi",function(){return this.hanzi=new RegExp("^[一-龥]$")}]),b$f}(),b$H=(b$l(1,b$U,"alertGlobalError",null,function(b$M){var b$f=0;b$u.window.onerror=b$M?function(b$M,b$y,b$i,b$H,b$S){b$f++<5&&b$S&&alert(b$S.stack||b$S)}:null}),b$U.init=function(b$M,b$y,b$i){for(var b$H=[],b$S=2,b$f=arguments.length;b$S<b$f;b$S++)b$H.push(arguments[b$S]);if(!b$U._isinit){ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=b$U._arrayBufferSlice),b$U._isinit=!0,b$u.__init__(),b$q.__init__(),b$d.__init__(),b$U.timer=new b$$,b$U.scaleTimer=new b$$,b$U.loader=new b$kM,b$O.__init__(),b$S=0;for(var b$V=b$H.length;b$S<b$V;b$S++)b$H[b$S].enable&&b$H[b$S].enable();return b$P.__init__(),b$K.__init__(),b$t.__init__(),b$B.beginCheck(),b$U._currentStage=b$U.stage=new b$CM,b$U.stage.conchModel&&b$U.stage.conchModel.setRootNode(),b$U._getUrlPath(),b$U.render=new b$D(0,0),b$U.stage.size(b$M,b$y),b$w.__init__(),b$o.__init__(),b$J.instance.__init__(b$U.stage,b$D.canvas),b$GM.__init__(),b$a.autoStopMusic=!0,b$c.__init__(),b$D.canvas}},b$U._getUrlPath=function(){var b$M=b$u.window.location,b$y=b$M.pathname;b$y=b$y&&":"==b$y.charAt(2)?b$y.substring(1):b$y,b$s.rootPath=b$s.basePath=b$s.getPath("file:"==b$M.protocol?b$y:b$M.protocol+"//"+b$M.host+b$M.pathname)},b$U._arrayBufferSlice=function(b$M,b$y){var b$i=new Uint8Array(this,b$M,b$y-b$M),b$H=new Uint8Array(b$i.length);return b$H.set(b$i),b$H.buffer},b$U._runScript=function(b$M){return b$u.window[b$U._evcode](b$M)},b$U.stage=null,b$U.timer=null,b$U.scaleTimer=null,b$U.loader=null,b$U.version="1.8.6",b$U.render=null,b$U._currentStage=null,b$U._isinit=!1,b$U.isDebug=!1,b$U.MiniAdpter={init:function(){b$V.navigator&&b$V.navigator.userAgent&&-1<b$V.navigator.userAgent.indexOf("MiniGame")&&console.error("请先引用小游戏适配库laya.wxmini.js,详细教程：https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0")}},b$k(b$U,["conchMarket",function(){return this.conchMarket=b$V.conch?conchMarket:null},"PlatformClass",function(){return this.PlatformClass=b$V.PlatformClass},"_evcode",function(){return this._evcode="e"+String.fromCharCode(118)+"al"}]),function(){function b$M(){}return b$F(b$M,"Config"),b$M.WebGLTextCacheCount=500,b$M.atlasEnable=!1,b$M.showCanvasMark=!1,b$M.animationInterval=50,b$M.isAntialias=!1,b$M.isAlpha=!1,b$M.premultipliedAlpha=!0,b$M.isStencil=!0,b$M.preserveDrawingBuffer=!1,b$M}()),b$X=function(){function b$X(){this._events=null}b$F(b$X,"laya.events.EventDispatcher");var b$M=b$X.prototype;return b$M.hasListener=function(b$M){return!!(this._events&&this._events[b$M])},b$M.event=function(b$M,b$y){if(!this._events||!this._events[b$M])return!1;var b$i=this._events[b$M];if(b$i.lock)b$i.queue||(b$i.queue=[]),b$i.queue.push(b$y);else{var b$H;for(b$i.lock=!0,b$i.cursor=b$i.head;b$i.cursor;)b$H=b$i.cursor,b$i.cursor=b$H.next,b$H.once&&b$X.delNode(b$i,b$H),null!=b$y?b$H.args?b$H.method.apply(b$H.caller,b$H.args.concat(b$y)):b$y instanceof Array?b$H.method.apply(b$H.caller,b$y):b$H.method.call(b$H.caller,b$y):b$H.method.apply(b$H.caller,b$H.args),b$H.once&&b$X.recoverHandler(b$H);b$i.lock=!1,!b$i.head&&this._events&&this._events[b$M]==b$i&&delete this._events[b$M],b$i.queue&&b$i.queue.length&&this.event(b$M,b$i.queue.shift())}return!0},b$M.on=function(b$M,b$y,b$i,b$H){return this._createListener(b$M,b$y,b$i,b$H,!1)},b$M.once=function(b$M,b$y,b$i,b$H){return this._createListener(b$M,b$y,b$i,b$H,!0)},b$M._createListener=function(b$M,b$y,b$i,b$H,b$S,b$f){void 0===b$f&&(b$f=!0),b$f&&this.off(b$M,b$y,b$i,b$S);var b$V=b$X.createHandler(b$y||this,b$i,b$H,b$S);this._events||(this._events={});var b$K=this._events,b$k=b$K[b$M];return b$k?b$k.tail?(b$V.prev=b$k.tail,b$k.tail.next=b$V,b$k.tail=b$V):b$k.head=b$k.tail=b$V:b$K[b$M]={head:b$V,tail:b$V,cursor:null,lock:!1},this},b$M.off=function(b$M,b$y,b$i,b$H){if(void 0===b$H&&(b$H=!1),!this._events||!this._events[b$M])return this;for(var b$S=this._events[b$M],b$f=b$S.head;b$f;){if((!b$y||b$f.caller===b$y)&&b$f.method===b$i&&(!b$H||b$f.once)){b$X.delNode(b$S,b$f),b$S.cursor==b$f&&(b$S.cursor=b$f.next),b$X.recoverHandler(b$f);break}b$f=b$f.next}return this},b$M.offAll=function(b$M){var b$y=this._events;if(!b$y)return this;if(b$M)this._recoverHandlers(b$y[b$M]),delete b$y[b$M];else{for(var b$i in b$y)this._recoverHandlers(b$y[b$i]);this._events=null}return this},b$M._recoverHandlers=function(b$M){if(b$M){for(var b$y=b$M.head;b$y;){b$X.delNode(b$M,b$y);var b$i=b$y.next;b$X.recoverHandler(b$y),b$y=b$i}b$M.cursor=null}},b$M.isMouseEvent=function(b$M){return b$X.MOUSE_EVENTS[b$M]},b$X.MOUSE_EVENTS={rightmousedown:!0,rightmouseup:!0,rightclick:!0,mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0},b$X.__init$=function(){Object.defineProperty(laya.events.EventDispatcher.prototype,"_events",{enumerable:!1,writable:!0})},b$X.delNode=function(b$M,b$y){b$y.prev?b$y.prev.next=b$y.next:b$M.head=b$y.next,b$y.next?b$y.next.prev=b$y.prev:b$M.tail=b$y.prev},b$X.createHandler=function(b$M,b$y,b$i,b$H){var b$S=b$X._freeHandler;return b$S?(b$X._freeCount--,b$X._freeHandler=b$S.next,b$S.caller=b$M,b$S.method=b$y,b$S.args=b$i,b$S.once=b$H):b$S={caller:b$M,method:b$y,args:b$i,once:b$H},b$S.prev=b$S.next=null,b$S},b$X.recoverHandler=function(b$M){b$M.caller=b$M.method=b$M.args=b$M.prev=null,b$M.next=b$X._freeHandler,b$X._freeHandler=b$M,b$X._freeCount++},b$X._freeHandler=null,b$X._freeCount=0,b$X}(),b$v=function(){function b$S(b$M,b$y,b$i,b$H){this.once=!1,void(this._id=0)===b$H&&(b$H=!1),this.setTo(b$M,b$y,b$i,b$H)}b$F(b$S,"laya.utils.Handler");var b$M=b$S.prototype;return b$M.setTo=function(b$M,b$y,b$i,b$H){return this._id=b$S._gid++,this.caller=b$M,this.method=b$y,this.args=b$i,this.once=b$H,this},b$M.run=function(){if(null==this.method)return null;var b$M=this._id,b$y=this.method.apply(this.caller,this.args);return this._id===b$M&&this.once&&this.recover(),b$y},b$M.runWith=function(b$M){if(null==this.method)return null;var b$y=this._id;if(null==b$M)var b$i=this.method.apply(this.caller,this.args);else b$i=this.args||b$M.unshift?this.args?this.method.apply(this.caller,this.args.concat(b$M)):this.method.apply(this.caller,b$M):this.method.call(this.caller,b$M);return this._id===b$y&&this.once&&this.recover(),b$i},b$M.clear=function(){return this.caller=null,this.method=null,this.args=null,this},b$M.recover=function(){0<this._id&&(this._id=0,this.clear())},b$S.create=function(b$M,b$y,b$i,b$H){return void 0===b$H&&(b$H=!0),new b$S(b$M,b$y,b$i,b$H)},b$S._gid=1,b$S}(),b$n=function(){function b$M(){this._texture=null,this._fontCharDic={},this._fontWidthMap={},this._complete=null,this._path=null,this._maxWidth=0,this._spaceWidth=10,this._padding=null,this.fontSize=12,this.autoScaleSize=!1,this.letterSpacing=0}b$F(b$M,"laya.display.BitmapFont");var b$y=b$M.prototype;return b$y.loadFont=function(b$M,b$y){this._path=b$M,this._complete=b$y,b$U.loader.load([{url:this._path,type:"xml"},{url:this._path.replace(".fnt",".png"),type:"image"}],b$v.create(this,this.onLoaded))},b$y.onLoaded=function(){this.parseFont(b$KM.getRes(this._path),b$KM.getRes(this._path.replace(".fnt",".png"))),this._complete&&this._complete.runWith(this._texture?this:null)},b$y.parseFont=function(b$M,b$y){if(null!=b$M&&null!=b$y){this._texture=b$y;var b$i=b$M.getElementsByTagName("info");if(!b$i[0].getAttributeNode)return this.parseFont2(b$M,b$y);this.fontSize=parseInt(b$i[0].getAttributeNode("size").nodeValue);var b$H,b$S=b$i[0].getAttributeNode("padding").nodeValue.split(",");this._padding=[parseInt(b$S[0]),parseInt(b$S[1]),parseInt(b$S[2]),parseInt(b$S[3])],b$H=b$M.getElementsByTagName("char");var b$f=0;for(b$f=0;b$f<b$H.length;b$f++){var b$V=b$H[b$f],b$K=parseInt(b$V.getAttributeNode("id").nodeValue),b$k=parseInt(b$V.getAttributeNode("xoffset").nodeValue)/1,b$X=parseInt(b$V.getAttributeNode("yoffset").nodeValue)/1,b$F=parseInt(b$V.getAttributeNode("xadvance").nodeValue)/1,b$o=new b$W;b$o.x=parseInt(b$V.getAttributeNode("x").nodeValue),b$o.y=parseInt(b$V.getAttributeNode("y").nodeValue),b$o.width=parseInt(b$V.getAttributeNode("width").nodeValue),b$o.height=parseInt(b$V.getAttributeNode("height").nodeValue);var b$d=b$FM.create(b$y,b$o.x,b$o.y,b$o.width,b$o.height,b$k,b$X);this._maxWidth=Math.max(this._maxWidth,b$F+this.letterSpacing),this._fontCharDic[b$K]=b$d,this._fontWidthMap[b$K]=b$F}}},b$y.parseFont2=function(b$M,b$y){if(null!=b$M&&null!=b$y){this._texture=b$y;var b$i=b$M.getElementsByTagName("info");this.fontSize=parseInt(b$i[0].attributes.size.nodeValue);var b$H=b$i[0].attributes.padding.nodeValue.split(",");this._padding=[parseInt(b$H[0]),parseInt(b$H[1]),parseInt(b$H[2]),parseInt(b$H[3])];var b$S=b$M.getElementsByTagName("char"),b$f=0;for(b$f=0;b$f<b$S.length;b$f++){var b$V=b$S[b$f].attributes,b$K=parseInt(b$V.id.nodeValue),b$k=parseInt(b$V.xoffset.nodeValue)/1,b$X=parseInt(b$V.yoffset.nodeValue)/1,b$F=parseInt(b$V.xadvance.nodeValue)/1,b$o=new b$W;b$o.x=parseInt(b$V.x.nodeValue),b$o.y=parseInt(b$V.y.nodeValue),b$o.width=parseInt(b$V.width.nodeValue),b$o.height=parseInt(b$V.height.nodeValue);var b$d=b$FM.create(b$y,b$o.x,b$o.y,b$o.width,b$o.height,b$k,b$X);this._maxWidth=Math.max(this._maxWidth,b$F+this.letterSpacing),this._fontCharDic[b$K]=b$d,this._fontWidthMap[b$K]=b$F}}},b$y.getCharTexture=function(b$M){return this._fontCharDic[b$M.charCodeAt(0)]},b$y.destroy=function(){if(this._texture){for(var b$M in this._fontCharDic){var b$y=this._fontCharDic[b$M];b$y&&b$y.destroy()}this._texture.destroy(),this._fontCharDic=null,this._fontWidthMap=null,this._texture=null}},b$y.setSpaceWidth=function(b$M){this._spaceWidth=b$M},b$y.getCharWidth=function(b$M){var b$y=b$M.charCodeAt(0);return this._fontWidthMap[b$y]?this._fontWidthMap[b$y]+this.letterSpacing:" "==b$M?this._spaceWidth+this.letterSpacing:0},b$y.getTextWidth=function(b$M){for(var b$y=0,b$i=0,b$H=b$M.length;b$i<b$H;b$i++)b$y+=this.getCharWidth(b$M.charAt(b$i));return b$y},b$y.getMaxWidth=function(){return this._maxWidth},b$y.getMaxHeight=function(){return this.fontSize},b$y.drawText=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V,b$K=this.getTextWidth(b$M),b$k=0;"center"===b$S&&(b$k=(b$f-b$K)/2),"right"===b$S&&(b$k=b$f-b$K);for(var b$X=0,b$F=0,b$o=b$M.length;b$F<b$o;b$F++)(b$V=this.getCharTexture(b$M.charAt(b$F)))&&(b$y.graphics.drawTexture(b$V,b$i+b$X+b$k,b$H),b$X+=this.getCharWidth(b$M.charAt(b$F)))},b$M}(),b$K=function(){function b$i(){this.alpha=1,this.visible=!0,this.scrollRect=null,this.blendMode=null,this._type=0,this._tf=b$i._TF_EMPTY}b$F(b$i,"laya.display.css.Style");var b$M=b$i.prototype;return b$M.getTransform=function(){return this._tf},b$M.setTransform=function(b$M){this._tf="none"!==b$M&&b$M?b$M:b$i._TF_EMPTY},b$M.setTranslateX=function(b$M){this._tf===b$i._TF_EMPTY&&(this._tf=new b$S),this._tf.translateX=b$M},b$M.setTranslateY=function(b$M){this._tf===b$i._TF_EMPTY&&(this._tf=new b$S),this._tf.translateY=b$M},b$M.setScaleX=function(b$M){this._tf===b$i._TF_EMPTY&&(this._tf=new b$S),this._tf.scaleX=b$M},b$M.setScale=function(b$M,b$y){this._tf===b$i._TF_EMPTY&&(this._tf=new b$S),this._tf.scaleX=b$M,this._tf.scaleY=b$y},b$M.setScaleY=function(b$M){this._tf===b$i._TF_EMPTY&&(this._tf=new b$S),this._tf.scaleY=b$M},b$M.setRotate=function(b$M){this._tf===b$i._TF_EMPTY&&(this._tf=new b$S),this._tf.rotate=b$M},b$M.setSkewX=function(b$M){this._tf===b$i._TF_EMPTY&&(this._tf=new b$S),this._tf.skewX=b$M},b$M.setSkewY=function(b$M){this._tf===b$i._TF_EMPTY&&(this._tf=new b$S),this._tf.skewY=b$M},b$M.destroy=function(){this.scrollRect=null},b$M.render=function(b$M,b$y,b$i,b$H){},b$M.getCSSStyle=function(){return b$yM.EMPTY},b$M._enableLayout=function(){return!1},b$l(0,b$M,"scaleX",function(){return this._tf.scaleX},function(b$M){this.setScaleX(b$M)}),b$l(0,b$M,"transform",function(){return this.getTransform()},function(b$M){this.setTransform(b$M)}),b$l(0,b$M,"translateX",function(){return this._tf.translateX},function(b$M){this.setTranslateX(b$M)}),b$l(0,b$M,"translateY",function(){return this._tf.translateY},function(b$M){this.setTranslateY(b$M)}),b$l(0,b$M,"scaleY",function(){return this._tf.scaleY},function(b$M){this.setScaleY(b$M)}),b$l(0,b$M,"block",function(){return 0!=(1&this._type)}),b$l(0,b$M,"skewY",function(){return this._tf.skewY},function(b$M){this.setSkewY(b$M)}),b$l(0,b$M,"rotate",function(){return this._tf.rotate},function(b$M){this.setRotate(b$M)}),b$l(0,b$M,"skewX",function(){return this._tf.skewX},function(b$M){this.setSkewX(b$M)}),b$l(0,b$M,"paddingLeft",function(){return 0}),b$l(0,b$M,"paddingTop",function(){return 0}),b$l(0,b$M,"absolute",function(){return!0}),b$i.__init__=function(){b$i._TF_EMPTY=new b$S,b$i.EMPTY=new b$i},b$i.EMPTY=null,b$i._TF_EMPTY=null,b$i}(),b$P=function(){function b$y(b$M){this._type=0,this._weight=0,this._decoration=null,this._text=null,this.indent=0,this._color=b$E.create(b$y.defaultColor),this.family=b$y.defaultFamily,this.stroke=b$y._STROKE,this.size=b$y.defaultSize,b$M&&b$M!==b$y.EMPTY&&b$M.copyTo(this)}b$F(b$y,"laya.display.css.Font");var b$M=b$y.prototype;return b$M.set=function(b$M){this._text=null;for(var b$y=b$M.split(" "),b$i=0,b$H=b$y.length;b$i<b$H;b$i++){var b$S=b$y[b$i];switch(b$S){case"italic":this.italic=!0;continue;case"bold":this.bold=!0;continue}0<b$S.indexOf("px")&&(this.size=parseInt(b$S),this.family=b$y[b$i+1],b$i++)}},b$M.toString=function(){return this._text="",this.italic&&(this._text+="italic "),this.bold&&(this._text+="bold "),this._text+=this.size+"px "+this.family},b$M.copyTo=function(b$M){b$M._type=this._type,b$M._text=this._text,b$M._weight=this._weight,b$M._color=this._color,b$M.family=this.family,b$M.stroke=this.stroke!=b$y._STROKE?this.stroke.slice():b$y._STROKE,b$M.indent=this.indent,b$M.size=this.size},b$l(0,b$M,"password",function(){return 0!=(1024&this._type)},function(b$M){b$M?this._type|=1024:this._type&=-1025}),b$l(0,b$M,"color",function(){return this._color.strColor},function(b$M){this._color=b$E.create(b$M)}),b$l(0,b$M,"italic",function(){return 0!=(512&this._type)},function(b$M){b$M?this._type|=512:this._type&=-513}),b$l(0,b$M,"bold",function(){return 0!=(2048&this._type)},function(b$M){b$M?this._type|=2048:this._type&=-2049}),b$l(0,b$M,"weight",function(){return""+this._weight},function(b$M){var b$y=0;switch(b$M){case"normal":break;case"bold":this.bold=!0,b$y=700;break;case"bolder":b$y=800;break;case"lighter":b$y=100;break;default:b$y=parseInt(b$M)}this._weight=b$y,this._text=null}),b$l(0,b$M,"decoration",function(){return this._decoration?this._decoration.value:null},function(b$M){var b$y=b$M.split(" ");switch(this._decoration||(this._decoration={}),b$y[0]){case"_":this._decoration.type="underline";break;case"-":this._decoration.type="line-through";break;case"overline":this._decoration.type="overline";break;default:this._decoration.type=b$y[0]}b$y[1]&&(this._decoration.color=b$E.create(b$y)),this._decoration.value=b$M}),b$y.__init__=function(){b$y.EMPTY=new b$y(null)},b$y.EMPTY=null,b$y.defaultColor="#000000",b$y.defaultSize=12,b$y.defaultFamily="Arial",b$y.defaultFont="12px Arial",b$y._STROKE=[0,"#000000"],b$y._ITALIC=512,b$y._PASSWORD=1024,b$y._BOLD=2048,b$y}(),b$S=function(){function b$M(){this.translateX=0,this.translateY=0,this.scaleX=1,this.scaleY=1,this.rotate=0,this.skewX=0,this.skewY=0}return b$F(b$M,"laya.display.css.TransformInfo"),b$M}(),b$d=function(){function b$o(){if(this._one=null,this._cmds=null,this._render=this._renderEmpty,b$D.isConchNode){this._nativeObj=new b$V._conchGraphics,this.id=this._nativeObj.conchID}}b$F(b$o,"laya.display.Graphics");var b$M=b$o.prototype;return b$M.destroy=function(){this.clear(),this._graphicBounds&&this._graphicBounds.destroy(),this._graphicBounds=null,this._vectorgraphArray=null,this._sp&&(this._sp._renderType=0),this._sp=null},b$M.clear=function(b$M){void 0===b$M&&(b$M=!1);var b$y=0,b$i=0;if(b$M){var b$H=this._one;if(this._cmds){for(b$i=this._cmds.length,b$y=0;b$y<b$i;b$y++)!(b$H=this._cmds[b$y])||b$H.callee!==b$D._context._drawTexture&&b$H.callee!==b$D._context._drawTextureWithTransform||(b$H[0]=null,b$o._cache.push(b$H));this._cmds.length=0}else b$H&&(!b$H||b$H.callee!==b$D._context._drawTexture&&b$H.callee!==b$D._context._drawTextureWithTransform||(b$H[0]=null,b$o._cache.push(b$H)))}else this._cmds=null;if(this._one=null,this._render=this._renderEmpty,this._sp&&(this._sp._renderType&=-514),this._repaint(),this._vectorgraphArray){for(b$y=0,b$i=this._vectorgraphArray.length;b$y<b$i;b$y++)b$j.getInstance().deleteShape(this._vectorgraphArray[b$y]);this._vectorgraphArray.length=0}},b$M._clearBoundsCache=function(){this._graphicBounds&&this._graphicBounds.reset()},b$M._initGraphicBounds=function(){this._graphicBounds||(this._graphicBounds=new b$i,this._graphicBounds._graphics=this)},b$M._repaint=function(){this._clearBoundsCache(),this._sp&&this._sp.repaint()},b$M._isOnlyOne=function(){return!this._cmds||0===this._cmds.length},b$M.getBounds=function(b$M){return void 0===b$M&&(b$M=!1),this._initGraphicBounds(),this._graphicBounds.getBounds(b$M)},b$M.getBoundPoints=function(b$M){return void 0===b$M&&(b$M=!1),this._initGraphicBounds(),this._graphicBounds.getBoundPoints(b$M)},b$M._addCmd=function(b$M){this._cmds=this._cmds||[],b$M.callee=b$M.shift(),this._cmds.push(b$M)},b$M.setFilters=function(b$M){this._saveToCmd(b$D._context._setFilters,b$M)},b$M.drawTexture=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){if(void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=0),void 0===b$S&&(b$S=0),void 0===b$V&&(b$V=1),!b$M||b$V<.01)return null;b$H||(b$H=b$M.sourceWidth),b$S||(b$S=b$M.sourceHeight),b$V=b$V<0?0:1<b$V?1:b$V;var b$K,b$k=!b$D.isWebGL&&(b$u.onFirefox||b$u.onEdge||b$u.onIE||b$u.onSafari)?.5:0,b$X=b$H/b$M.sourceWidth,b$F=b$S/b$M.sourceHeight;return b$H=b$M.width*b$X,b$S=b$M.height*b$F,b$M.loaded&&(b$H<=0||b$S<=0)?null:(b$y+=b$M.offsetX*b$X,b$i+=b$M.offsetY*b$F,this._sp&&(this._sp._renderType|=512),b$y-=b$k,b$i-=b$k,b$H+=2*b$k,b$S+=2*b$k,b$o._cache.length?((b$K=b$o._cache.pop())[0]=b$M,b$K[1]=b$y,b$K[2]=b$i,b$K[3]=b$H,b$K[4]=b$S,b$K[5]=b$f,b$K[6]=b$V):b$K=[b$M,b$y,b$i,b$H,b$S,b$f,b$V],b$K.callee=b$f||1!=b$V?b$D._context._drawTextureWithTransform:b$D._context._drawTexture,null!=this._one||b$f||1!=b$V?this._saveToCmd(b$K.callee,b$K):(this._one=b$K,this._render=this._renderOneImg),b$M.loaded||b$M.once("loaded",this,this._textureLoaded,[b$M,b$K]),this._repaint(),b$K)},b$M.cleanByTexture=function(b$M,b$y,b$i,b$H,b$S){if(void 0===b$H&&(b$H=0),void 0===b$S&&(b$S=0),!b$M)return this.clear();if(this._one&&this._render===this._renderOneImg){b$H||(b$H=b$M.sourceWidth),b$S||(b$S=b$M.sourceHeight);var b$f=b$H/b$M.sourceWidth,b$V=b$S/b$M.sourceHeight;b$H=b$M.width*b$f,b$S=b$M.height*b$V,b$y+=b$M.offsetX*b$f,b$i+=b$M.offsetY*b$V,this._one[0]=b$M,this._one[1]=b$y,this._one[2]=b$i,this._one[3]=b$H,this._one[4]=b$S,this._repaint()}else this.clear(),b$M&&this.drawTexture(b$M,b$y,b$i,b$H,b$S)},b$M.drawTextures=function(b$M,b$y){b$M&&this._saveToCmd(b$D._context._drawTextures,[b$M,b$y])},b$M.fillTexture=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){if(void 0===b$H&&(b$H=0),void 0===b$S&&(b$S=0),void 0===b$f&&(b$f="repeat"),b$M){var b$K=[b$M,b$y,b$i,b$H,b$S,b$f,b$V||b$Q.EMPTY,{}];b$M.loaded||b$M.once("loaded",this,this._textureLoaded,[b$M,b$K]),this._saveToCmd(b$D._context._fillTexture,b$K)}},b$M._textureLoaded=function(b$M,b$y){b$y[3]=b$y[3]||b$M.width,b$y[4]=b$y[4]||b$M.height,this._repaint()},b$M.fillCircle=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){b$i.bitmap.enableMerageInAtlas=!1;var b$K=new Float32Array(2*(b$V+1)),b$k=new Float32Array(2*(b$V+1)),b$X=new Uint16Array(3*b$V),b$F=2*Math.PI/b$V,b$o=0;b$K[0]=b$H,b$K[1]=b$S,b$k[0]=b$H/b$i.width,b$k[1]=b$S/b$i.height;for(var b$d=2,b$P=0;b$P<b$V;b$P++){var b$l=b$f*Math.cos(b$o)+b$H,b$J=b$f*Math.sin(b$o)+b$S;b$K[b$d]=b$l,b$K[b$d+1]=b$J,b$k[b$d]=b$l/b$i.width,b$k[b$d+1]=b$J/b$i.height,b$o+=b$F,b$d+=2}for(b$P=b$d=0;b$P<b$V;b$P++)b$X[b$d++]=0,b$X[b$d++]=b$P+1,b$X[b$d++]=b$V+1<=b$P+2?1:b$P+2;this.drawTriangles(b$i,b$M,b$y,b$K,b$k,b$X)},b$M.drawTriangles=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){void 0===b$K&&(b$K=1),this._saveToCmd(b$D._context.drawTriangles,[b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X])},b$M._saveToCmd=function(b$M,b$y){return this._sp&&(this._sp._renderType|=512),null==this._one?(this._one=b$y,this._render=this._renderOne):(this._sp&&(this._sp._renderType&=-2),this._render=this._renderAll,0===(this._cmds||(this._cmds=[])).length&&this._cmds.push(this._one),this._cmds.push(b$y)),b$y.callee=b$M,this._repaint(),b$y},b$M.clipRect=function(b$M,b$y,b$i,b$H){this._saveToCmd(b$D._context._clipRect,[b$M,b$y,b$i,b$H])},b$M.fillText=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){void 0===b$V&&(b$V=0),this._saveToCmd(b$D._context._fillText,[b$M,b$y,b$i,b$H||b$P.defaultFont,b$S,b$f])},b$M.fillBorderText=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){this._saveToCmd(b$D._context._fillBorderText,[b$M,b$y,b$i,b$H||b$P.defaultFont,b$S,b$f,b$V,b$K])},b$M.strokeText=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this._saveToCmd(b$D._context._strokeText,[b$M,b$y,b$i,b$H||b$P.defaultFont,b$S,b$f,b$V])},b$M.alpha=function(b$M){b$M=b$M<0?0:1<b$M?1:b$M,this._saveToCmd(b$D._context._alpha,[b$M])},b$M.setAlpha=function(b$M){b$M=b$M<0?0:1<b$M?1:b$M,this._saveToCmd(b$D._context._setAlpha,[b$M])},b$M.transform=function(b$M,b$y,b$i){void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),this._saveToCmd(b$D._context._transform,[b$M,b$y,b$i])},b$M.rotate=function(b$M,b$y,b$i){void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),this._saveToCmd(b$D._context._rotate,[b$M,b$y,b$i])},b$M.scale=function(b$M,b$y,b$i,b$H){void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=0),this._saveToCmd(b$D._context._scale,[b$M,b$y,b$i,b$H])},b$M.translate=function(b$M,b$y){this._saveToCmd(b$D._context._translate,[b$M,b$y])},b$M.save=function(){this._saveToCmd(b$D._context._save,[])},b$M.restore=function(){this._saveToCmd(b$D._context._restore,[])},b$M.replaceText=function(b$M){this._repaint();var b$y=this._cmds;if(b$y){for(var b$i=b$y.length-1;-1<b$i;b$i--)if(this._isTextCmd(b$y[b$i].callee))return b$y[b$i][0].toUpperCase?b$y[b$i][0]=b$M:b$y[b$i][0].setText(b$M),!0}else if(this._one&&this._isTextCmd(this._one.callee))return this._one[0].toUpperCase?this._one[0]=b$M:this._one[0].setText(b$M),!0;return!1},b$M._isTextCmd=function(b$M){return b$M===b$D._context._fillText||b$M===b$D._context._fillBorderText||b$M===b$D._context._strokeText},b$M.replaceTextColor=function(b$M){this._repaint();var b$y=this._cmds;if(b$y)for(var b$i=b$y.length-1;-1<b$i;b$i--)this._isTextCmd(b$y[b$i].callee)&&(b$y[b$i][4]=b$M,b$y[b$i][0].toUpperCase||(b$y[b$i][0].changed=!0));else this._one&&this._isTextCmd(this._one.callee)&&(this._one[4]=b$M,this._one[0].toUpperCase||(this._one[0].changed=!0))},b$M.loadImage=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=this;void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=0),void 0===b$S&&(b$S=0);var b$K=b$KM.getRes(b$M);function b$k(b$M){b$M&&(b$V.drawTexture(b$M,b$y,b$i,b$H,b$S),null!=b$f&&b$f.call(b$V._sp,b$M))}b$K?b$k(b$K):b$U.loader.load(b$M,b$v.create(null,b$k),null,"image")},b$M._renderEmpty=function(b$M,b$y,b$i,b$H){},b$M._renderAll=function(b$M,b$y,b$i,b$H){for(var b$S,b$f=this._cmds,b$V=0,b$K=b$f.length;b$V<b$K;b$V++)(b$S=b$f[b$V]).callee.call(b$y,b$i,b$H,b$S)},b$M._renderOne=function(b$M,b$y,b$i,b$H){this._one.callee.call(b$y,b$i,b$H,this._one)},b$M._renderOneImg=function(b$M,b$y,b$i,b$H){this._one.callee.call(b$y,b$i,b$H,this._one),2305!==b$M._renderType&&(b$M._renderType|=1)},b$M.drawLine=function(b$M,b$y,b$i,b$H,b$S,b$f){void 0===b$f&&(b$f=1);var b$V=0;b$D.isWebGL&&(b$V=b$j.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(b$V));var b$K=b$f%2==0?0:.5,b$k=[b$M+b$K,b$y+b$K,b$i+b$K,b$H+b$K,b$S,b$f,b$V];this._saveToCmd(b$D._context._drawLine,b$k)},b$M.drawLines=function(b$M,b$y,b$i,b$H,b$S){void 0===b$S&&(b$S=1);var b$f=0;if(b$i&&!(b$i.length<4)){b$D.isWebGL&&(b$f=b$j.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(b$f));var b$V=b$S%2==0?0:.5,b$K=[b$M+b$V,b$y+b$V,b$i,b$H,b$S,b$f];this._saveToCmd(b$D._context._drawLines,b$K)}},b$M.drawCurves=function(b$M,b$y,b$i,b$H,b$S){void 0===b$S&&(b$S=1);var b$f=[b$M,b$y,b$i,b$H,b$S];this._saveToCmd(b$D._context._drawCurves,b$f)},b$M.drawRect=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){void 0===b$V&&(b$V=1);var b$K=b$f?b$V/2:0,b$k=b$f?b$V:0,b$X=[b$M+b$K,b$y+b$K,b$i-b$k,b$H-b$k,b$S,b$f,b$V];this._saveToCmd(b$D._context._drawRect,b$X)},b$M.drawCircle=function(b$M,b$y,b$i,b$H,b$S,b$f){void 0===b$f&&(b$f=1);var b$V=b$S?b$f/2:0,b$K=0;b$D.isWebGL&&(b$K=b$j.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(b$K));var b$k=[b$M,b$y,b$i-b$V,b$H,b$S,b$f,b$K];this._saveToCmd(b$D._context._drawCircle,b$k)},b$M.drawPie=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){void 0===b$K&&(b$K=1);var b$k=b$V?b$K/2:0,b$X=b$V?b$K:0,b$F=0;b$D.isWebGL&&(b$F=b$j.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(b$F));var b$o=[b$M+b$k,b$y+b$k,b$i-b$X,b$H,b$S,b$f,b$V,b$K,b$F];b$o[3]=b$g.toRadian(b$H),b$o[4]=b$g.toRadian(b$S),this._saveToCmd(b$D._context._drawPie,b$o)},b$M.drawPoly=function(b$M,b$y,b$i,b$H,b$S,b$f){void 0===b$f&&(b$f=1);var b$V=0,b$K=!1;b$D.isWebGL&&(b$V=b$j.getInstance().getId(),null==this._vectorgraphArray&&(this._vectorgraphArray=[]),this._vectorgraphArray.push(b$V),b$K=!(6<b$i.length));var b$k=b$S?b$f%2==0?0:.5:0,b$X=[b$M+b$k,b$y+b$k,b$i,b$H,b$S,b$f,b$V,b$K];this._saveToCmd(b$D._context._drawPoly,b$X)},b$M.drawPath=function(b$M,b$y,b$i,b$H,b$S){var b$f=[b$M,b$y,b$i,b$H,b$S];this._saveToCmd(b$D._context._drawPath,b$f)},b$l(0,b$M,"cmds",function(){return this._cmds},function(b$M){this._sp&&(this._sp._renderType|=512),this._cmds=b$M,this._render=this._renderAll,this._repaint()}),b$o.__init__=function(){if(b$D.isConchNode){for(var b$M=laya.display.Graphics.prototype,b$y=b$u.window.ConchGraphics.prototype,b$i=["clear","destroy","alpha","rotate","transform","scale","translate","save","restore","clipRect","blendMode","fillText","fillBorderText","_fands","drawRect","drawCircle","drawPie","drawPoly","drawPath","drawImageM","drawLine","drawLines","_drawPs","drawCurves","replaceText","replaceTextColor","_fillImage","fillTexture","setSkinMesh","drawParticle","drawImageS"],b$H=0,b$S=b$i.length;b$H<=b$S;b$H++){var b$f=b$i[b$H];b$M[b$f]=b$y[b$f]}b$M._saveToCmd=null,b$y.drawImageS&&(b$M.drawTextures=function(b$M,b$y){if(b$M&&b$M.loaded&&b$M.bitmap&&b$M.source){var b$i=b$M.uv,b$H=b$M.bitmap.width,b$S=b$M.bitmap.height;this.drawImageS(b$M.bitmap.source,b$i[0]*b$H,b$i[1]*b$S,(b$i[2]-b$i[0])*b$H,(b$i[5]-b$i[3])*b$S,b$M.offsetX,b$M.offsetY,b$M.width,b$M.height,b$y)}}),b$M.drawTexture=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){if(void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=0),void 0===b$S&&(b$S=0),void 0===b$V&&(b$V=1),b$M)if(b$M.loaded){if(b$M.loaded&&b$M.bitmap&&b$M.source&&(b$H||(b$H=b$M.sourceWidth),b$S||(b$S=b$M.sourceHeight),b$V=b$V<0?0:1<b$V?1:b$V,b$H=b$H-b$M.sourceWidth+b$M.width,b$S=b$S-b$M.sourceHeight+b$M.height,!(b$H<=0||b$S<=0))){b$y+=b$M.offsetX,b$i+=b$M.offsetY;var b$K=b$M.uv,b$k=b$M.bitmap.width,b$X=b$M.bitmap.height;b$K[4]<b$K[0]&&b$K[5]<b$K[1]?this.drawImageM(b$M.bitmap.source,b$K[4]*b$k,b$K[5]*b$X,(b$K[0]-b$K[4])*b$k,(b$K[1]-b$K[5])*b$X,b$y,b$i,b$H,b$S,b$f,b$V):this.drawImageM(b$M.bitmap.source,b$K[0]*b$k,b$K[1]*b$X,(b$K[2]-b$K[0])*b$k,(b$K[5]-b$K[3])*b$X,b$y,b$i,b$H,b$S,b$f,b$V),this._repaint()}}else b$M.once("loaded",this,function(){this.drawTexture(b$M,b$y,b$i,b$H,b$S,b$f)})},b$M.fillTexture=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){if(void 0===b$H&&(b$H=0),void 0===b$S&&(b$S=0),void 0===b$f&&(b$f="repeat"),b$M&&b$M.loaded){var b$K,b$k=b$D._context.ctx,b$X=b$M.bitmap.width,b$F=b$M.bitmap.height,b$o=b$M.uv;b$K=b$M.uv!=b$FM.DEF_UV?b$k.createPattern(b$M.bitmap.source,b$f,b$o[0]*b$X,b$o[1]*b$F,(b$o[2]-b$o[0])*b$X,(b$o[5]-b$o[3])*b$F):b$k.createPattern(b$M.bitmap.source,b$f);var b$d=0,b$P=0;b$V&&(b$y+=b$V.x%b$M.width,b$i+=b$V.y%b$M.height,b$d-=b$V.x%b$M.width,b$P-=b$V.y%b$M.height),this._fillImage(b$K,b$y,b$i,b$d,b$P,b$H,b$S)}}}},b$o._cache=[],b$o}(),b$i=function(){function b$R(){this._cacheBoundsType=!1}b$F(b$R,"laya.display.GraphicsBounds");var b$M=b$R.prototype;return b$M.destroy=function(){this._graphics=null,this._temp=null,this._rstBoundPoints=null,this._bounds=null},b$M.reset=function(){this._temp&&(this._temp.length=0)},b$M.getBounds=function(b$M){return void 0===b$M&&(b$M=!1),(!this._bounds||!this._temp||this._temp.length<1||b$M!=this._cacheBoundsType)&&(this._bounds=b$W._getWrapRec(this.getBoundPoints(b$M),this._bounds)),this._cacheBoundsType=b$M,this._bounds},b$M.getBoundPoints=function(b$M){return void 0===b$M&&(b$M=!1),(!this._temp||this._temp.length<1||b$M!=this._cacheBoundsType)&&(this._temp=this._getCmdPoints(b$M)),this._cacheBoundsType=b$M,this._rstBoundPoints=b$g.copyArray(this._rstBoundPoints,this._temp)},b$M._getCmdPoints=function(b$M){void 0===b$M&&(b$M=!1);var b$y,b$i,b$H=b$D._context,b$S=this._graphics.cmds;if((b$y=this._temp||(this._temp=[])).length=0,b$S||null==this._graphics._one||(b$R._tempCmds.length=0,b$R._tempCmds.push(this._graphics._one),b$S=b$R._tempCmds),!b$S)return b$y;(b$i=b$R._tempMatrixArrays).length=0;var b$f=b$R._initMatrix;b$f.identity();for(var b$V,b$K,b$k=b$R._tempMatrix,b$X=NaN,b$F=NaN,b$o=NaN,b$d=NaN,b$P=NaN,b$l=NaN,b$J=0,b$h=b$S.length;b$J<b$h;b$J++)if((b$V=b$S[b$J]).callee)switch(b$V.callee){case b$H._save:case 7:b$i.push(b$f),b$f=b$f.clone();break;case b$H._restore:case 8:b$f=b$i.pop();break;case b$H._scale:case 5:b$k.identity(),b$k.translate(-b$V[2],-b$V[3]),b$k.scale(b$V[0],b$V[1]),b$k.translate(b$V[2],b$V[3]),this._switchMatrix(b$f,b$k);break;case b$H._rotate:case 3:b$k.identity(),b$k.translate(-b$V[1],-b$V[2]),b$k.rotate(b$V[0]),b$k.translate(b$V[1],b$V[2]),this._switchMatrix(b$f,b$k);break;case b$H._translate:case 6:b$k.identity(),b$k.translate(b$V[0],b$V[1]),this._switchMatrix(b$f,b$k);break;case b$H._transform:case 4:b$k.identity(),b$k.translate(-b$V[1],-b$V[2]),b$k.concat(b$V[0]),b$k.translate(b$V[1],b$V[2]),this._switchMatrix(b$f,b$k);break;case 16:case 24:b$R._addPointArrToRst(b$y,b$W._getBoundPointS(b$V[0],b$V[1],b$V[2],b$V[3]),b$f);break;case 17:b$f.copyTo(b$k),b$k.concat(b$V[4]),b$R._addPointArrToRst(b$y,b$W._getBoundPointS(b$V[0],b$V[1],b$V[2],b$V[3]),b$k);break;case b$H._drawTexture:b$K=b$V[0],b$M?b$V[3]&&b$V[4]?b$R._addPointArrToRst(b$y,b$W._getBoundPointS(b$V[1],b$V[2],b$V[3],b$V[4]),b$f):(b$K=b$V[0],b$R._addPointArrToRst(b$y,b$W._getBoundPointS(b$V[1],b$V[2],b$K.width,b$K.height),b$f)):(b$X=(b$V[3]||b$K.sourceWidth)/b$K.width,b$F=(b$V[4]||b$K.sourceHeight)/b$K.height,b$o=b$X*b$K.sourceWidth,b$d=b$F*b$K.sourceHeight,b$P=0<b$K.offsetX?b$K.offsetX:0,b$l=0<b$K.offsetY?b$K.offsetY:0,b$P*=b$X,b$l*=b$F,b$R._addPointArrToRst(b$y,b$W._getBoundPointS(b$V[1]-b$P,b$V[2]-b$l,b$o,b$d),b$f));break;case b$H._fillTexture:b$V[3]&&b$V[4]?b$R._addPointArrToRst(b$y,b$W._getBoundPointS(b$V[1],b$V[2],b$V[3],b$V[4]),b$f):(b$K=b$V[0],b$R._addPointArrToRst(b$y,b$W._getBoundPointS(b$V[1],b$V[2],b$K.width,b$K.height),b$f));break;case b$H._drawTextureWithTransform:var b$C;b$C=b$V[5]?(b$f.copyTo(b$k),b$k.concat(b$V[5]),b$k):b$f,b$M?b$V[3]&&b$V[4]?b$R._addPointArrToRst(b$y,b$W._getBoundPointS(b$V[1],b$V[2],b$V[3],b$V[4]),b$C):(b$K=b$V[0],b$R._addPointArrToRst(b$y,b$W._getBoundPointS(b$V[1],b$V[2],b$K.width,b$K.height),b$C)):(b$K=b$V[0],b$X=(b$V[3]||b$K.sourceWidth)/b$K.width,b$F=(b$V[4]||b$K.sourceHeight)/b$K.height,b$o=b$X*b$K.sourceWidth,b$d=b$F*b$K.sourceHeight,b$P=0<b$K.offsetX?b$K.offsetX:0,b$l=0<b$K.offsetY?b$K.offsetY:0,b$P*=b$X,b$l*=b$F,b$R._addPointArrToRst(b$y,b$W._getBoundPointS(b$V[1]-b$P,b$V[2]-b$l,b$o,b$d),b$C));break;case b$H._drawRect:case 13:b$R._addPointArrToRst(b$y,b$W._getBoundPointS(b$V[0],b$V[1],b$V[2],b$V[3]),b$f);break;case b$H._drawCircle:case b$H._fillCircle:case 14:b$R._addPointArrToRst(b$y,b$W._getBoundPointS(b$V[0]-b$V[2],b$V[1]-b$V[2],b$V[2]+b$V[2],b$V[2]+b$V[2]),b$f);break;case b$H._drawLine:case 20:b$R._tempPoints.length=0;var b$v;b$v=.5*b$V[5],b$V[0]==b$V[2]?b$R._tempPoints.push(b$V[0]+b$v,b$V[1],b$V[2]+b$v,b$V[3],b$V[0]-b$v,b$V[1],b$V[2]-b$v,b$V[3]):b$V[1]==b$V[3]?b$R._tempPoints.push(b$V[0],b$V[1]+b$v,b$V[2],b$V[3]+b$v,b$V[0],b$V[1]-b$v,b$V[2],b$V[3]-b$v):b$R._tempPoints.push(b$V[0],b$V[1],b$V[2],b$V[3]),b$R._addPointArrToRst(b$y,b$R._tempPoints,b$f);break;case b$H._drawCurves:case 22:b$R._addPointArrToRst(b$y,b$A.I.getBezierPoints(b$V[2]),b$f,b$V[0],b$V[1]);break;case b$H._drawPoly:case b$H._drawLines:case 18:b$R._addPointArrToRst(b$y,b$V[2],b$f,b$V[0],b$V[1]);break;case b$H._drawPath:case 19:b$R._addPointArrToRst(b$y,this._getPathPoints(b$V[2]),b$f,b$V[0],b$V[1]);break;case b$H._drawPie:case 15:b$R._addPointArrToRst(b$y,this._getPiePoints(b$V[0],b$V[1],b$V[2],b$V[3],b$V[4]),b$f)}return 200<b$y.length?b$y=b$g.copyArray(b$y,b$W._getWrapRec(b$y)._getBoundPoints()):8<b$y.length&&(b$y=b$G.scanPList(b$y)),b$y},b$M._switchMatrix=function(b$M,b$y){b$y.concat(b$M),b$y.copyTo(b$M)},b$M._getPiePoints=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$R._tempPoints;b$R._tempPoints.length=0,b$f.push(b$M,b$y);var b$V=(b$S-b$H)%(2*Math.PI)/10,b$K=NaN,b$k=b$H;for(b$K=0;b$K<=10;b$K++)b$f.push(b$M+b$i*Math.cos(b$k),b$y+b$i*Math.sin(b$k)),b$k+=b$V;return b$f},b$M._getPathPoints=function(b$M){var b$y,b$i,b$H=0,b$S=b$R._tempPoints;for(b$S.length=0,b$y=b$M.length,b$H=0;b$H<b$y;b$H++)1<(b$i=b$M[b$H]).length&&(b$S.push(b$i[1],b$i[2]),3<b$i.length&&b$S.push(b$i[3],b$i[4]));return b$S},b$R._addPointArrToRst=function(b$M,b$y,b$i,b$H,b$S){void 0===b$H&&(b$H=0),void 0===b$S&&(b$S=0);var b$f,b$V=0;for(b$f=b$y.length,b$V=0;b$V<b$f;b$V+=2)b$R._addPointToRst(b$M,b$y[b$V]+b$H,b$y[b$V+1]+b$S,b$i)},b$R._addPointToRst=function(b$M,b$y,b$i,b$H){var b$S=b$Q.TEMP;b$S.setTo(b$y||0,b$i||0),b$H.transformPoint(b$S),b$M.push(b$S.x,b$S.y)},b$R._tempPoints=[],b$R._tempMatrixArrays=[],b$R._tempCmds=[],b$k(b$R,["_tempMatrix",function(){return this._tempMatrix=new b$m},"_initMatrix",function(){return this._initMatrix=new b$m}]),b$R}(),b$f=function(){function b$M(){}b$F(b$M,"laya.events.Event");var b$y=b$M.prototype;return b$y.setTo=function(b$M,b$y,b$i){return this.type=b$M,this.currentTarget=b$y,this.target=b$i,this},b$y.stopPropagation=function(){this._stoped=!0},b$l(0,b$y,"stageY",function(){return b$U.stage.mouseY}),b$l(0,b$y,"charCode",function(){return this.nativeEvent.charCode}),b$l(0,b$y,"touches",function(){var b$M=this.nativeEvent.touches;if(b$M)for(var b$y=b$U.stage,b$i=0,b$H=b$M.length;b$i<b$H;b$i++){var b$S=b$M[b$i],b$f=b$Q.TEMP;b$f.setTo(b$S.clientX,b$S.clientY),b$y._canvasTransform.invertTransformPoint(b$f),b$y.transform.invertTransformPoint(b$f),b$S.stageX=b$f.x,b$S.stageY=b$f.y}return b$M}),b$l(0,b$y,"keyLocation",function(){return this.nativeEvent.keyLocation}),b$l(0,b$y,"ctrlKey",function(){return this.nativeEvent.ctrlKey}),b$l(0,b$y,"altKey",function(){return this.nativeEvent.altKey}),b$l(0,b$y,"shiftKey",function(){return this.nativeEvent.shiftKey}),b$l(0,b$y,"stageX",function(){return b$U.stage.mouseX}),b$M.EMPTY=new b$M,b$M.MOUSE_DOWN="mousedown",b$M.MOUSE_UP="mouseup",b$M.CLICK="click",b$M.RIGHT_MOUSE_DOWN="rightmousedown",b$M.RIGHT_MOUSE_UP="rightmouseup",b$M.RIGHT_CLICK="rightclick",b$M.MOUSE_MOVE="mousemove",b$M.MOUSE_OVER="mouseover",b$M.MOUSE_OUT="mouseout",b$M.MOUSE_WHEEL="mousewheel",b$M.ROLL_OVER="mouseover",b$M.ROLL_OUT="mouseout",b$M.DOUBLE_CLICK="doubleclick",b$M.CHANGE="change",b$M.CHANGED="changed",b$M.RESIZE="resize",b$M.ADDED="added",b$M.REMOVED="removed",b$M.DISPLAY="display",b$M.UNDISPLAY="undisplay",b$M.ERROR="error",b$M.COMPLETE="complete",b$M.LOADED="loaded",b$M.INITED="inited",b$M.PROGRESS="progress",b$M.INPUT="input",b$M.RENDER="render",b$M.OPEN="open",b$M.MESSAGE="message",b$M.CLOSE="close",b$M.KEY_DOWN="keydown",b$M.KEY_PRESS="keypress",b$M.KEY_UP="keyup",b$M.FRAME="enterframe",b$M.DRAG_START="dragstart",b$M.DRAG_MOVE="dragmove",b$M.DRAG_END="dragend",b$M.ENTER="enter",b$M.SELECT="select",b$M.BLUR="blur",b$M.FOCUS="focus",b$M.VISIBILITY_CHANGE="visibilitychange",b$M.FOCUS_CHANGE="focuschange",b$M.PLAYED="played",b$M.PAUSED="paused",b$M.STOPPED="stopped",b$M.START="start",b$M.END="end",b$M.ENABLE_CHANGED="enablechanged",b$M.ACTIVE_IN_HIERARCHY_CHANGED="activeinhierarchychanged",b$M.COMPONENT_ADDED="componentadded",b$M.COMPONENT_REMOVED="componentremoved",b$M.LAYER_CHANGED="layerchanged",b$M.HIERARCHY_LOADED="hierarchyloaded",b$M.RECOVERED="recovered",b$M.RELEASED="released",b$M.LINK="link",b$M.LABEL="label",b$M.FULL_SCREEN_CHANGE="fullscreenchange",b$M.DEVICE_LOST="devicelost",b$M.MESH_CHANGED="meshchanged",b$M.MATERIAL_CHANGED="materialchanged",b$M.WORLDMATRIX_NEEDCHANGE="worldmatrixneedchanged",b$M.ANIMATION_CHANGED="animationchanged",b$M.TRIGGER_ENTER="triggerenter",b$M.TRIGGER_STAY="triggerstay",b$M.TRIGGER_EXIT="triggerexit",b$M.TRAIL_FILTER_CHANGE="trailfilterchange",b$M.DOMINO_FILTER_CHANGE="dominofilterchange",b$M}(),b$o=(function(){function b$M(){}b$F(b$M,"laya.events.Keyboard"),b$M.NUMBER_0=48,b$M.NUMBER_1=49,b$M.NUMBER_2=50,b$M.NUMBER_3=51,b$M.NUMBER_4=52,b$M.NUMBER_5=53,b$M.NUMBER_6=54,b$M.NUMBER_7=55,b$M.NUMBER_8=56,b$M.NUMBER_9=57,b$M.A=65,b$M.B=66,b$M.C=67,b$M.D=68,b$M.E=69,b$M.F=70,b$M.G=71,b$M.H=72,b$M.I=73,b$M.J=74,b$M.K=75,b$M.L=76,b$M.M=77,b$M.N=78,b$M.O=79,b$M.P=80,b$M.Q=81,b$M.R=82,b$M.S=83,b$M.T=84,b$M.U=85,b$M.V=86,b$M.W=87,b$M.X=88,b$M.Y=89,b$M.Z=90,b$M.F1=112,b$M.F2=113,b$M.F3=114,b$M.F4=115,b$M.F5=116,b$M.F6=117,b$M.F7=118,b$M.F8=119,b$M.F9=120,b$M.F10=121,b$M.F11=122,b$M.F12=123,b$M.F13=124,b$M.F14=125,b$M.F15=126,b$M.NUMPAD=21,b$M.NUMPAD_0=96,b$M.NUMPAD_1=97,b$M.NUMPAD_2=98,b$M.NUMPAD_3=99,b$M.NUMPAD_4=100,b$M.NUMPAD_5=101,b$M.NUMPAD_6=102,b$M.NUMPAD_7=103,b$M.NUMPAD_8=104,b$M.NUMPAD_9=105,b$M.NUMPAD_ADD=107,b$M.NUMPAD_DECIMAL=110,b$M.NUMPAD_DIVIDE=111,b$M.NUMPAD_ENTER=108,b$M.NUMPAD_MULTIPLY=106,b$M.NUMPAD_SUBTRACT=109,b$M.SEMICOLON=186,b$M.EQUAL=187,b$M.COMMA=188,b$M.MINUS=189,b$M.PERIOD=190,b$M.SLASH=191,b$M.BACKQUOTE=192,b$M.LEFTBRACKET=219,b$M.BACKSLASH=220,b$M.RIGHTBRACKET=221,b$M.QUOTE=222,b$M.ALTERNATE=18,b$M.BACKSPACE=8,b$M.CAPS_LOCK=20,b$M.COMMAND=15,b$M.CONTROL=17,b$M.DELETE=46,b$M.ENTER=13,b$M.ESCAPE=27,b$M.PAGE_UP=33,b$M.PAGE_DOWN=34,b$M.END=35,b$M.HOME=36,b$M.LEFT=37,b$M.UP=38,b$M.RIGHT=39,b$M.DOWN=40,b$M.SHIFT=16,b$M.SPACE=32,b$M.TAB=9,b$M.INSERT=45}(),function(){function b$S(){}return b$F(b$S,"laya.events.KeyBoardManager"),b$S.__init__=function(){b$S._addEvent("keydown"),b$S._addEvent("keypress"),b$S._addEvent("keyup")},b$S._addEvent=function(b$y){b$u.document.addEventListener(b$y,function(b$M){laya.events.KeyBoardManager._dispatch(b$M,b$y)},!0)},b$S._dispatch=function(b$M,b$y){if(b$S.enabled){b$S._event._stoped=!1,b$S._event.nativeEvent=b$M,b$S._event.keyCode=b$M.keyCode||b$M.which||b$M.charCode,"keydown"===b$y?b$S._pressKeys[b$S._event.keyCode]=!0:"keyup"===b$y&&(b$S._pressKeys[b$S._event.keyCode]=null);for(var b$i=b$U.stage.focus&&null!=b$U.stage.focus.event&&b$U.stage.focus.displayedInStage?b$U.stage.focus:b$U.stage,b$H=b$i;b$H;)b$H.event(b$y,b$S._event.setTo(b$y,b$H,b$i)),b$H=b$H.parent}},b$S.hasKeyDown=function(b$M){return b$S._pressKeys[b$M]},b$S._pressKeys={},b$S.enabled=!0,b$k(b$S,["_event",function(){return this._event=new b$f}]),b$S}()),b$J=(function(){function b$M(){}b$F(b$M,"laya.events.KeyLocation"),b$M.STANDARD=0,b$M.LEFT=1,b$M.RIGHT=2,b$M.NUM_PAD=3}(),function(){function b$X(){this.mouseX=0,this.mouseY=0,this.disableMouseEvent=!1,this.mouseDownTime=0,this.mouseEventTime=b$u.now(),this.mouseMoveAccuracy=2,this._stage=null,this._target=null,this._lastMoveTimer=0,this._isLeftMouse=!1,this._eventList=[],this._touchIDs={},this._id=1,this._tTouchID=0,this._event=new b$f,this._matrix=new b$m,this._point=new b$Q,this._rect=new b$W,this._prePoint=new b$Q,this._curTouchID=NaN}b$F(b$X,"laya.events.MouseManager");var b$M=b$X.prototype;return b$M.__init__=function(b$M,b$y){var b$i=this;this._stage=b$M;var b$H=this,b$S=this._eventList;b$y.oncontextmenu=function(b$M){if(b$X.enabled)return!1},b$y.addEventListener("mousedown",function(b$M){b$X.enabled&&(b$u.onIE||b$M.preventDefault(),b$S.push(b$M),b$H.mouseDownTime=b$u.now())}),b$y.addEventListener("mouseup",function(b$M){b$X.enabled&&(b$M.preventDefault(),b$S.push(b$M),b$H.mouseDownTime=-b$u.now())},!0),b$y.addEventListener("mousemove",function(b$M){if(b$X.enabled){b$M.preventDefault();var b$y=b$u.now();if(b$y-b$H._lastMoveTimer<10)return;b$H._lastMoveTimer=b$y,b$S.push(b$M)}},!0),b$y.addEventListener("mouseout",function(b$M){b$X.enabled&&b$S.push(b$M)}),b$y.addEventListener("mouseover",function(b$M){b$X.enabled&&b$S.push(b$M)}),b$y.addEventListener("touchstart",function(b$M){b$X.enabled&&(b$S.push(b$M),b$X._isFirstTouch||b$GM.isInputting||b$M.preventDefault(),b$H.mouseDownTime=b$u.now())}),b$y.addEventListener("touchend",function(b$M){b$X.enabled?(b$X._isFirstTouch||b$GM.isInputting||b$M.preventDefault(),b$X._isFirstTouch=!1,b$S.push(b$M),b$H.mouseDownTime=-b$u.now()):b$i._curTouchID=NaN},!0),b$y.addEventListener("touchmove",function(b$M){b$X.enabled&&(b$M.preventDefault(),b$S.push(b$M))},!0),b$y.addEventListener("touchcancel",function(b$M){b$X.enabled?(b$M.preventDefault(),b$S.push(b$M)):b$i._curTouchID=NaN},!0),b$y.addEventListener("mousewheel",function(b$M){b$X.enabled&&b$S.push(b$M)}),b$y.addEventListener("DOMMouseScroll",function(b$M){b$X.enabled&&b$S.push(b$M)})},b$M.initEvent=function(b$M,b$y){var b$i;this._event._stoped=!1,this._event.nativeEvent=b$y||b$M,this._target=null,this._point.setTo(b$M.pageX||b$M.clientX,b$M.pageY||b$M.clientY),this._stage._canvasTransform.invertTransformPoint(this._point),this.mouseX=this._point.x,this.mouseY=this._point.y,this._event.touchId=b$M.identifier||0,this._tTouchID=this._event.touchId,(b$i=b$h.I._event)._stoped=!1,b$i.nativeEvent=this._event.nativeEvent,b$i.touchId=this._event.touchId},b$M.checkMouseWheel=function(b$M){this._event.delta=b$M.wheelDelta?.025*b$M.wheelDelta:-b$M.detail;for(var b$y=b$h.I.getLastOvers(),b$i=0,b$H=b$y.length;b$i<b$H;b$i++){var b$S=b$y[b$i];b$S.event("mousewheel",this._event.setTo("mousewheel",b$S,this._target))}},b$M.onMouseMove=function(b$M){b$h.I.onMouseMove(b$M,this._tTouchID)},b$M.onMouseDown=function(b$M){if(b$GM.isInputting&&b$U.stage.focus&&b$U.stage.focus.focus&&!b$U.stage.focus.contains(this._target)){var b$y=b$U.stage.focus._tf||b$U.stage.focus,b$i=b$M._tf||b$M;b$i instanceof laya.display.Input&&b$i.multiline==b$y.multiline?b$y._focusOut():b$y.focus=!1}b$h.I.onMouseDown(b$M,this._tTouchID,this._isLeftMouse)},b$M.onMouseUp=function(b$M){b$h.I.onMouseUp(b$M,this._tTouchID,this._isLeftMouse)},b$M.check=function(b$M,b$y,b$i,b$H){this._point.setTo(b$y,b$i),b$M.fromParentPoint(this._point),b$y=this._point.x,b$i=this._point.y;var b$S=b$M.scrollRect;if(b$S&&(this._rect.setTo(b$S.x,b$S.y,b$S.width,b$S.height),!this._rect.contains(b$y,b$i)))return!1;if(!this.disableMouseEvent){if(b$M.hitTestPrior&&!b$M.mouseThrough&&!this.hitTest(b$M,b$y,b$i))return!1;for(var b$f=b$M._childs.length-1;-1<b$f;b$f--){var b$V=b$M._childs[b$f];if(!b$V.destroyed&&b$V.mouseEnabled&&b$V.visible&&this.check(b$V,b$y,b$i,b$H))return!0}}var b$K=!(!b$M.hitTestPrior||b$M.mouseThrough||this.disableMouseEvent)||this.hitTest(b$M,b$y,b$i);return b$K?(this._target=b$M,b$H.call(this,b$M)):b$H===this.onMouseUp&&b$M===this._stage&&(this._target=this._stage,b$H.call(this,this._target)),b$K},b$M.hitTest=function(b$M,b$y,b$i){var b$H=!1;if(b$M.scrollRect&&(b$y-=b$M.scrollRect.x,b$i-=b$M.scrollRect.y),b$M.hitArea instanceof laya.utils.HitArea)return b$M.hitArea.isHit(b$y,b$i);if(0<b$M.width&&0<b$M.height||b$M.mouseThrough||b$M.hitArea)if(b$M.mouseThrough)b$H=b$M.getGraphicBounds().contains(b$y,b$i);else{var b$S=this._rect;b$M.hitArea?b$S=b$M.hitArea:b$S.setTo(0,0,b$M.width,b$M.height),b$H=b$S.contains(b$y,b$i)}return b$H},b$M.runEvent=function(){var b$M=this._eventList.length;if(b$M){this.mouseEventTime=b$u.now();var b$y,b$i=0,b$H=0,b$S=0;try{for(;b$i<b$M;){var b$f=this._eventList[b$i];switch("mousemove"!==b$f.type&&(this._prePoint.x=this._prePoint.y=-1e6),b$f.type){case"mousedown":this._touchIDs[0]=this._id++,b$X._isTouchRespond?b$X._isTouchRespond=!1:(this._isLeftMouse=0===b$f.button,this.initEvent(b$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"mouseup":this._isLeftMouse=0===b$f.button,this.initEvent(b$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp);break;case"mousemove":Math.abs(this._prePoint.x-b$f.clientX)+Math.abs(this._prePoint.y-b$f.clientY)>=this.mouseMoveAccuracy&&(this._prePoint.x=b$f.clientX,this._prePoint.y=b$f.clientY,this.initEvent(b$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"touchstart":b$X._isTouchRespond=!0,this._isLeftMouse=!0;var b$V=b$f.changedTouches;for(b$H=0,b$S=b$V.length;b$H<b$S;b$H++)b$y=b$V[b$H],(b$X.multiTouchEnabled||isNaN(this._curTouchID))&&(this._curTouchID=b$y.identifier,this._id%200==0&&(this._touchIDs={}),this._touchIDs[b$y.identifier]=this._id++,this.initEvent(b$y,b$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseDown));break;case"touchend":case"touchcancel":b$X._isTouchRespond=!0,this._isLeftMouse=!0;var b$K=b$f.changedTouches;for(b$H=0,b$S=b$K.length;b$H<b$S;b$H++)if(b$y=b$K[b$H],b$X.multiTouchEnabled||b$y.identifier==this._curTouchID){this._curTouchID=NaN,this.initEvent(b$y,b$f);this.check(this._stage,this.mouseX,this.mouseY,this.onMouseUp)||this.onMouseUp(null)}break;case"touchmove":var b$k=b$f.changedTouches;for(b$H=0,b$S=b$k.length;b$H<b$S;b$H++)b$y=b$k[b$H],(b$X.multiTouchEnabled||b$y.identifier==this._curTouchID)&&(this.initEvent(b$y,b$f),this.check(this._stage,this.mouseX,this.mouseY,this.onMouseMove));break;case"wheel":case"mousewheel":case"DOMMouseScroll":this.checkMouseWheel(b$f);break;case"mouseout":b$h.I.stageMouseOut();break;case"mouseover":this._stage.event("mouseover",this._event.setTo("mouseover",this._stage,this._stage))}b$i++}}catch(b$M){throw this._eventList.length=0,b$M}this._eventList.length=0}},b$X.enabled=!0,b$X.multiTouchEnabled=!0,b$X._isTouchRespond=!1,b$X._isFirstTouch=!0,b$k(b$X,["instance",function(){return this.instance=new b$X}]),b$X}()),b$h=function(){function b$l(){this.preOvers=[],this.preDowns=[],this.preRightDowns=[],this.enable=!0,this._lastClickTime=0,this._event=new b$f}b$F(b$l,"laya.events.TouchManager");var b$M=b$l.prototype;return b$M._clearTempArrs=function(){b$l._oldArr.length=0,b$l._newArr.length=0,b$l._tEleArr.length=0},b$M.getTouchFromArr=function(b$M,b$y){var b$i,b$H,b$S=0;for(b$i=b$y.length,b$S=0;b$S<b$i;b$S++)if((b$H=b$y[b$S]).id==b$M)return b$H;return null},b$M.removeTouchFromArr=function(b$M,b$y){var b$i=0;for(b$i=b$y.length-1;0<=b$i;b$i--)b$y[b$i].id==b$M&&b$y.splice(b$i,1)},b$M.createTouchO=function(b$M,b$y){var b$i;return(b$i=b$r.getItem("TouchData")||{}).id=b$y,b$i.tar=b$M,b$i},b$M.onMouseDown=function(b$M,b$y,b$i){var b$H,b$S,b$f,b$V;(void 0===b$i&&(b$i=!1),this.enable)&&(b$H=this.getTouchFromArr(b$y,this.preOvers),b$f=this.getEles(b$M,null,b$l._tEleArr),b$H?b$H.tar=b$M:(b$S=this.createTouchO(b$M,b$y),this.preOvers.push(b$S)),b$u.onMobile&&this.sendEvents(b$f,"mouseover",b$y),b$V=b$i?this.preDowns:this.preRightDowns,(b$H=this.getTouchFromArr(b$y,b$V))?b$H.tar=b$M:(b$S=this.createTouchO(b$M,b$y),b$V.push(b$S)),this.sendEvents(b$f,b$i?"mousedown":"rightmousedown",b$y),this._clearTempArrs())},b$M.sendEvents=function(b$M,b$y,b$i){void 0===b$i&&(b$i=0);var b$H,b$S,b$f,b$V=0;for(b$H=b$M.length,this._event._stoped=!1,b$S=b$M[0],b$V=0;b$V<b$H;b$V++){if((b$f=b$M[b$V]).destroyed)return;if(b$f.event(b$y,this._event.setTo(b$y,b$f,b$S)),this._event._stoped)break}},b$M.getEles=function(b$M,b$y,b$i){for(b$i?b$i.length=0:b$i=[];b$M&&b$M!=b$y;)b$i.push(b$M),b$M=b$M.parent;return b$i},b$M.checkMouseOutAndOverOfMove=function(b$M,b$y,b$i){if(void 0===b$i&&(b$i=0),b$y!=b$M){var b$H,b$S,b$f=0,b$V=0;if(b$y.contains(b$M))b$S=this.getEles(b$M,b$y,b$l._tEleArr),this.sendEvents(b$S,"mouseover",b$i);else if(b$M.contains(b$y))b$S=this.getEles(b$y,b$M,b$l._tEleArr),this.sendEvents(b$S,"mouseout",b$i);else{var b$K,b$k;(b$S=b$l._tEleArr).length=0,b$K=this.getEles(b$y,null,b$l._oldArr),b$k=this.getEles(b$M,null,b$l._newArr),b$V=b$K.length;var b$X=0;for(b$f=0;b$f<b$V;b$f++){if(b$H=b$K[b$f],0<=(b$X=b$k.indexOf(b$H))){b$k.splice(b$X,b$k.length-b$X);break}b$S.push(b$H)}0<b$S.length&&this.sendEvents(b$S,"mouseout",b$i),0<b$k.length&&this.sendEvents(b$k,"mouseover",b$i)}}},b$M.onMouseMove=function(b$M,b$y){var b$i,b$H;this.enable&&((b$i=this.getTouchFromArr(b$y,this.preOvers))?(this.checkMouseOutAndOverOfMove(b$M,b$i.tar),b$i.tar=b$M,b$H=this.getEles(b$M,null,b$l._tEleArr)):(b$H=this.getEles(b$M,null,b$l._tEleArr),this.sendEvents(b$H,"mouseover",b$y),this.preOvers.push(this.createTouchO(b$M,b$y))),this.sendEvents(b$H,"mousemove",b$y),this._clearTempArrs())},b$M.getLastOvers=function(){return(b$l._tEleArr.length=0)<this.preOvers.length&&this.preOvers[0].tar?this.getEles(this.preOvers[0].tar,null,b$l._tEleArr):(b$l._tEleArr.push(b$U.stage),b$l._tEleArr)},b$M.stageMouseOut=function(){var b$M;b$M=this.getLastOvers(),this.preOvers.length=0,this.sendEvents(b$M,"mouseout",0)},b$M.onMouseUp=function(b$M,b$y,b$i){if(void 0===b$i&&(b$i=!1),this.enable){var b$H,b$S,b$f,b$V,b$K,b$k,b$X=0,b$F=0,b$o=b$u.onMobile;if(b$S=this.getEles(b$M,null,b$l._tEleArr),this.sendEvents(b$S,b$i?"mouseup":"rightmouseup",b$y),b$k=b$i?this.preDowns:this.preRightDowns,b$H=this.getTouchFromArr(b$y,b$k)){var b$d,b$P=b$u.now();if(b$d=b$P-this._lastClickTime<300,this._lastClickTime=b$P,b$M==b$H.tar)b$K=b$S;else for(b$f=this.getEles(b$H.tar,null,b$l._oldArr),(b$K=b$l._newArr).length=0,b$F=b$f.length,b$X=0;b$X<b$F;b$X++)b$V=b$f[b$X],0<=b$S.indexOf(b$V)&&b$K.push(b$V);0<b$K.length&&this.sendEvents(b$K,b$i?"click":"rightclick",b$y),b$i&&b$d&&this.sendEvents(b$K,"doubleclick",b$y),this.removeTouchFromArr(b$y,b$k),b$H.tar=null,b$r.recover("TouchData",b$H)}else;(b$H=this.getTouchFromArr(b$y,this.preOvers))&&b$o&&((b$K=this.getEles(b$H.tar,null,b$K))&&0<b$K.length&&this.sendEvents(b$K,"mouseout",b$y),this.removeTouchFromArr(b$y,this.preOvers),b$H.tar=null,b$r.recover("TouchData",b$H)),this._clearTempArrs()}},b$l._oldArr=[],b$l._newArr=[],b$l._tEleArr=[],b$k(b$l,["I",function(){return this.I=new b$l}]),b$l}(),b$C=function(){function b$M(){this._action=null}b$F(b$M,"laya.filters.Filter");var b$y=b$M.prototype;return b$U.imps(b$y,{"laya.filters.IFilter":!0}),b$y.callNative=function(b$M){},b$l(0,b$y,"type",function(){return-1}),b$l(0,b$y,"action",function(){return this._action}),b$M.BLUR=16,b$M.COLOR=32,b$M.GLOW=8,b$M._filterStart=null,b$M._filterEnd=null,b$M._EndTarget=null,b$M._recycleScope=null,b$M._filter=null,b$M._useSrc=null,b$M._endSrc=null,b$M._useOut=null,b$M._endOut=null,b$M}(),b$R=function(){function b$M(){this.data=null}b$F(b$M,"laya.filters.ColorFilterAction");var b$y=b$M.prototype;return b$U.imps(b$y,{"laya.filters.IFilterAction":!0}),b$y.apply=function(b$M){var b$y=b$M.ctx.ctx,b$i=b$M.ctx.ctx.canvas;if(0==b$i.width||0==b$i.height)return b$i;for(var b$H,b$S=b$y.getImageData(0,0,b$i.width,b$i.height),b$f=b$S.data,b$V=0,b$K=b$f.length;b$V<b$K;b$V+=4)b$H=this.getColor(b$f[b$V],b$f[b$V+1],b$f[b$V+2],b$f[b$V+3]),0!=b$f[b$V+3]&&(b$f[b$V]=b$H[0],b$f[b$V+1]=b$H[1],b$f[b$V+2]=b$H[2],b$f[b$V+3]=b$H[3]);return b$y.putImageData(b$S,0,0),b$M},b$y.getColor=function(b$M,b$y,b$i,b$H){var b$S=[];if(this.data._mat&&this.data._alpha){var b$f=this.data._mat,b$V=this.data._alpha;b$S[0]=b$f[0]*b$M+b$f[1]*b$y+b$f[2]*b$i+b$f[3]*b$H+b$V[0],b$S[1]=b$f[4]*b$M+b$f[5]*b$y+b$f[6]*b$i+b$f[7]*b$H+b$V[1],b$S[2]=b$f[8]*b$M+b$f[9]*b$y+b$f[10]*b$i+b$f[11]*b$H+b$V[2],b$S[3]=b$f[12]*b$M+b$f[13]*b$y+b$f[14]*b$i+b$f[15]*b$H+b$V[3]}return b$S},b$M}(),b$A=(function(){function b$M(){}b$F(b$M,"laya.maths.Arith"),b$M.formatR=function(b$M){return b$M>Math.PI&&(b$M-=2*Math.PI),b$M<-Math.PI&&(b$M+=2*Math.PI),b$M},b$M.isPOT=function(b$M,b$y){return 0<b$M&&0==(b$M&b$M-1)&&0<b$y&&0==(b$y&b$y-1)},b$M.setMatToArray=function(b$M,b$y){b$M.a,b$M.b,b$M.c,b$M.d,b$M.tx,b$M.ty,b$y[0]=b$M.a,b$y[1]=b$M.b,b$y[4]=b$M.c,b$y[5]=b$M.d,b$y[12]=b$M.tx,b$y[13]=b$M.ty}}(),function(){function b$M(){this._controlPoints=[new b$Q,new b$Q,new b$Q],this._calFun=this.getPoint2}b$F(b$M,"laya.maths.Bezier");var b$y=b$M.prototype;return b$y._switchPoint=function(b$M,b$y){var b$i=this._controlPoints.shift();b$i.setTo(b$M,b$y),this._controlPoints.push(b$i)},b$y.getPoint2=function(b$M,b$y){var b$i=this._controlPoints[0],b$H=this._controlPoints[1],b$S=this._controlPoints[2],b$f=Math.pow(1-b$M,2)*b$i.x+2*b$M*(1-b$M)*b$H.x+Math.pow(b$M,2)*b$S.x,b$V=Math.pow(1-b$M,2)*b$i.y+2*b$M*(1-b$M)*b$H.y+Math.pow(b$M,2)*b$S.y;b$y.push(b$f,b$V)},b$y.getPoint3=function(b$M,b$y){var b$i=this._controlPoints[0],b$H=this._controlPoints[1],b$S=this._controlPoints[2],b$f=this._controlPoints[3],b$V=Math.pow(1-b$M,3)*b$i.x+3*b$H.x*b$M*(1-b$M)*(1-b$M)+3*b$S.x*b$M*b$M*(1-b$M)+b$f.x*Math.pow(b$M,3),b$K=Math.pow(1-b$M,3)*b$i.y+3*b$H.y*b$M*(1-b$M)*(1-b$M)+3*b$S.y*b$M*b$M*(1-b$M)+b$f.y*Math.pow(b$M,3);b$y.push(b$V,b$K)},b$y.insertPoints=function(b$M,b$y){var b$i,b$H=NaN;for(b$i=1/(b$M=0<b$M?b$M:5),b$H=0;b$H<=1;b$H+=b$i)this._calFun(b$H,b$y)},b$y.getBezierPoints=function(b$M,b$y,b$i){void 0===b$y&&(b$y=5),void 0===b$i&&(b$i=2);var b$H,b$S,b$f=0;if((b$H=b$M.length)<2*(b$i+1))return[];switch(b$S=[],b$i){case 2:this._calFun=this.getPoint2;break;case 3:this._calFun=this.getPoint3;break;default:return[]}for(;this._controlPoints.length<=b$i;)this._controlPoints.push(new b$Q);for(b$f=0;b$f<2*b$i;b$f+=2)this._switchPoint(b$M[b$f],b$M[b$f+1]);for(b$f=2*b$i;b$f<b$H;b$f+=2)this._switchPoint(b$M[b$f],b$M[b$f+1]),b$f/2%b$i==0&&this.insertPoints(b$y,b$S);return b$S},b$k(b$M,["I",function(){return this.I=new b$M}]),b$M}()),b$G=function(){function b$X(){}return b$F(b$X,"laya.maths.GrahamScan"),b$X.multiply=function(b$M,b$y,b$i){return(b$M.x-b$i.x)*(b$y.y-b$i.y)-(b$y.x-b$i.x)*(b$M.y-b$i.y)},b$X.dis=function(b$M,b$y){return(b$M.x-b$y.x)*(b$M.x-b$y.x)+(b$M.y-b$y.y)*(b$M.y-b$y.y)},b$X._getPoints=function(b$M,b$y,b$i){for(void 0===b$y&&(b$y=!1),b$X._mPointList||(b$X._mPointList=[]);b$X._mPointList.length<b$M;)b$X._mPointList.push(new b$Q);return b$i||(b$i=[]),b$i.length=0,b$y?b$X.getFrom(b$i,b$X._mPointList,b$M):b$X.getFromR(b$i,b$X._mPointList,b$M),b$i},b$X.getFrom=function(b$M,b$y,b$i){var b$H=0;for(b$H=0;b$H<b$i;b$H++)b$M.push(b$y[b$H]);return b$M},b$X.getFromR=function(b$M,b$y,b$i){var b$H=0;for(b$H=0;b$H<b$i;b$H++)b$M.push(b$y.pop());return b$M},b$X.pListToPointList=function(b$M,b$y){void 0===b$y&&(b$y=!1);var b$i=0,b$H=b$M.length/2,b$S=b$X._getPoints(b$H,b$y,b$X._tempPointList);for(b$i=0;b$i<b$H;b$i++)b$S[b$i].setTo(b$M[b$i+b$i],b$M[b$i+b$i+1]);return b$S},b$X.pointListToPlist=function(b$M){var b$y,b$i=0,b$H=b$M.length,b$S=b$X._temPList;for(b$i=b$S.length=0;b$i<b$H;b$i++)b$y=b$M[b$i],b$S.push(b$y.x,b$y.y);return b$S},b$X.scanPList=function(b$M){return b$g.copyArray(b$M,b$X.pointListToPlist(b$X.scan(b$X.pListToPointList(b$M,!0))))},b$X.scan=function(b$M){var b$y,b$i,b$H,b$S=0,b$f=0,b$V=0,b$K=b$M.length,b$k={};for((b$i=b$X._temArr).length=0,b$S=(b$K=b$M.length)-1;0<=b$S;b$S--)b$H=(b$y=b$M[b$S]).x+"_"+b$y.y,b$k.hasOwnProperty(b$H)||(b$k[b$H]=!0,b$i.push(b$y));for(b$K=b$i.length,b$g.copyArray(b$M,b$i),b$S=1;b$S<b$K;b$S++)(b$M[b$S].y<b$M[b$V].y||b$M[b$S].y==b$M[b$V].y&&b$M[b$S].x<b$M[b$V].x)&&(b$V=b$S);for(b$y=b$M[0],b$M[0]=b$M[b$V],b$M[b$V]=b$y,b$S=1;b$S<b$K-1;b$S++){for(b$f=(b$V=b$S)+1;b$f<b$K;b$f++)(0<b$X.multiply(b$M[b$f],b$M[b$V],b$M[0])||0==b$X.multiply(b$M[b$f],b$M[b$V],b$M[0])&&b$X.dis(b$M[0],b$M[b$f])<b$X.dis(b$M[0],b$M[b$V]))&&(b$V=b$f);b$y=b$M[b$S],b$M[b$S]=b$M[b$V],b$M[b$V]=b$y}if((b$i=b$X._temArr).length=0,b$M.length<3)return b$g.copyArray(b$i,b$M);for(b$i.push(b$M[0],b$M[1],b$M[2]),b$S=3;b$S<b$K;b$S++){for(;2<=b$i.length&&0<=b$X.multiply(b$M[b$S],b$i[b$i.length-1],b$i[b$i.length-2]);)b$i.pop();b$M[b$S]&&b$i.push(b$M[b$S])}return b$i},b$X._mPointList=null,b$X._tempPointList=[],b$X._temPList=[],b$X._temArr=[],b$X}(),b$I=function(){function b$S(){}return b$F(b$S,"laya.maths.MathUtil"),b$S.subtractVector3=function(b$M,b$y,b$i){b$i[0]=b$M[0]-b$y[0],b$i[1]=b$M[1]-b$y[1],b$i[2]=b$M[2]-b$y[2]},b$S.lerp=function(b$M,b$y,b$i){return b$M*(1-b$i)+b$y*b$i},b$S.scaleVector3=function(b$M,b$y,b$i){b$i[0]=b$M[0]*b$y,b$i[1]=b$M[1]*b$y,b$i[2]=b$M[2]*b$y},b$S.lerpVector3=function(b$M,b$y,b$i,b$H){var b$S=b$M[0],b$f=b$M[1],b$V=b$M[2];b$H[0]=b$S+b$i*(b$y[0]-b$S),b$H[1]=b$f+b$i*(b$y[1]-b$f),b$H[2]=b$V+b$i*(b$y[2]-b$V)},b$S.lerpVector4=function(b$M,b$y,b$i,b$H){var b$S=b$M[0],b$f=b$M[1],b$V=b$M[2],b$K=b$M[3];b$H[0]=b$S+b$i*(b$y[0]-b$S),b$H[1]=b$f+b$i*(b$y[1]-b$f),b$H[2]=b$V+b$i*(b$y[2]-b$V),b$H[3]=b$K+b$i*(b$y[3]-b$K)},b$S.slerpQuaternionArray=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){var b$K,b$k,b$X,b$F,b$o,b$d=b$M[b$y+0],b$P=b$M[b$y+1],b$l=b$M[b$y+2],b$J=b$M[b$y+3],b$h=b$i[b$H+0],b$C=b$i[b$H+1],b$v=b$i[b$H+2],b$R=b$i[b$H+3];return(b$k=b$d*b$h+b$P*b$C+b$l*b$v+b$J*b$R)<0&&(b$k=-b$k,b$h=-b$h,b$C=-b$C,b$v=-b$v,b$R=-b$R),b$o=1e-6<1-b$k?(b$K=Math.acos(b$k),b$X=Math.sin(b$K),b$F=Math.sin((1-b$S)*b$K)/b$X,Math.sin(b$S*b$K)/b$X):(b$F=1-b$S,b$S),b$f[b$V+0]=b$F*b$d+b$o*b$h,b$f[b$V+1]=b$F*b$P+b$o*b$C,b$f[b$V+2]=b$F*b$l+b$o*b$v,b$f[b$V+3]=b$F*b$J+b$o*b$R,b$f},b$S.getRotation=function(b$M,b$y,b$i,b$H){return Math.atan2(b$H-b$y,b$i-b$M)/Math.PI*180},b$S.sortBigFirst=function(b$M,b$y){return b$M==b$y?0:b$M<b$y?1:-1},b$S.sortSmallFirst=function(b$M,b$y){return b$M==b$y?0:b$M<b$y?-1:1},b$S.sortNumBigFirst=function(b$M,b$y){return parseFloat(b$y)-parseFloat(b$M)},b$S.sortNumSmallFirst=function(b$M,b$y){return parseFloat(b$M)-parseFloat(b$y)},b$S.sortByKey=function(b$i,b$M,b$y){var b$H;return void 0===b$M&&(b$M=!1),void 0===b$y&&(b$y=!0),b$H=b$M?b$y?b$S.sortNumBigFirst:b$S.sortBigFirst:b$y?b$S.sortNumSmallFirst:b$S.sortSmallFirst,function(b$M,b$y){return b$H(b$M[b$i],b$y[b$i])}},b$S}(),b$m=function(){function b$i(b$M,b$y,b$i,b$H,b$S,b$f){this.inPool=!1,this.bTransform=!1,void 0===b$M&&(b$M=1),void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=1),void 0===b$S&&(b$S=0),void 0===b$f&&(b$f=0),this.a=b$M,this.b=b$y,this.c=b$i,this.d=b$H,this.tx=b$S,this.ty=b$f,this._checkTransform()}b$F(b$i,"laya.maths.Matrix");var b$M=b$i.prototype;return b$M.identity=function(){return this.a=this.d=1,this.b=this.tx=this.ty=this.c=0,this.bTransform=!1,this},b$M._checkTransform=function(){return this.bTransform=1!==this.a||0!==this.b||0!==this.c||1!==this.d},b$M.setTranslate=function(b$M,b$y){return this.tx=b$M,this.ty=b$y,this},b$M.translate=function(b$M,b$y){return this.tx+=b$M,this.ty+=b$y,this},b$M.scale=function(b$M,b$y){this.a*=b$M,this.d*=b$y,this.c*=b$M,this.b*=b$y,this.tx*=b$M,this.ty*=b$y,this.bTransform=!0},b$M.rotate=function(b$M){var b$y=Math.cos(b$M),b$i=Math.sin(b$M),b$H=this.a,b$S=this.c,b$f=this.tx;this.a=b$H*b$y-this.b*b$i,this.b=b$H*b$i+this.b*b$y,this.c=b$S*b$y-this.d*b$i,this.d=b$S*b$i+this.d*b$y,this.tx=b$f*b$y-this.ty*b$i,this.ty=b$f*b$i+this.ty*b$y,this.bTransform=!0},b$M.skew=function(b$M,b$y){var b$i=Math.tan(b$M),b$H=Math.tan(b$y),b$S=this.a,b$f=this.b;return this.a+=b$H*this.c,this.b+=b$H*this.d,this.c+=b$i*b$S,this.d+=b$i*b$f,this},b$M.invertTransformPoint=function(b$M){var b$y=this.a,b$i=this.b,b$H=this.c,b$S=this.d,b$f=this.tx,b$V=b$y*b$S-b$i*b$H,b$K=b$S/b$V,b$k=-b$i/b$V,b$X=-b$H/b$V,b$F=b$y/b$V,b$o=(b$H*this.ty-b$S*b$f)/b$V,b$d=-(b$y*this.ty-b$i*b$f)/b$V;return b$M.setTo(b$K*b$M.x+b$X*b$M.y+b$o,b$k*b$M.x+b$F*b$M.y+b$d)},b$M.transformPoint=function(b$M){return b$M.setTo(this.a*b$M.x+this.c*b$M.y+this.tx,this.b*b$M.x+this.d*b$M.y+this.ty)},b$M.transformPointN=function(b$M){return b$M.setTo(this.a*b$M.x+this.c*b$M.y,this.b*b$M.x+this.d*b$M.y)},b$M.transformPointArray=function(b$M,b$y){for(var b$i=b$M.length,b$H=0;b$H<b$i;b$H+=2){var b$S=b$M[b$H],b$f=b$M[b$H+1];b$y[b$H]=this.a*b$S+this.c*b$f+this.tx,b$y[b$H+1]=this.b*b$S+this.d*b$f+this.ty}return b$y},b$M.transformPointArrayScale=function(b$M,b$y){for(var b$i=b$M.length,b$H=0;b$H<b$i;b$H+=2){var b$S=b$M[b$H],b$f=b$M[b$H+1];b$y[b$H]=this.a*b$S+this.c*b$f,b$y[b$H+1]=this.b*b$S+this.d*b$f}return b$y},b$M.getScaleX=function(){return 0===this.b?this.a:Math.sqrt(this.a*this.a+this.b*this.b)},b$M.getScaleY=function(){return 0===this.c?this.d:Math.sqrt(this.c*this.c+this.d*this.d)},b$M.invert=function(){var b$M=this.a,b$y=this.b,b$i=this.c,b$H=this.d,b$S=this.tx,b$f=b$M*b$H-b$y*b$i;return this.a=b$H/b$f,this.b=-b$y/b$f,this.c=-b$i/b$f,this.d=b$M/b$f,this.tx=(b$i*this.ty-b$H*b$S)/b$f,this.ty=-(b$M*this.ty-b$y*b$S)/b$f,this},b$M.setTo=function(b$M,b$y,b$i,b$H,b$S,b$f){return this.a=b$M,this.b=b$y,this.c=b$i,this.d=b$H,this.tx=b$S,this.ty=b$f,this},b$M.concat=function(b$M){var b$y=this.a,b$i=this.c,b$H=this.tx;return this.a=b$y*b$M.a+this.b*b$M.c,this.b=b$y*b$M.b+this.b*b$M.d,this.c=b$i*b$M.a+this.d*b$M.c,this.d=b$i*b$M.b+this.d*b$M.d,this.tx=b$H*b$M.a+this.ty*b$M.c+b$M.tx,this.ty=b$H*b$M.b+this.ty*b$M.d+b$M.ty,this},b$M.scaleEx=function(b$M,b$y){var b$i=this.a,b$H=this.b,b$S=this.c,b$f=this.d;0!==b$H||0!==b$S?(this.a=b$M*b$i,this.b=b$M*b$H,this.c=b$y*b$S):(this.a=b$M*b$i,this.b=0*b$f,this.c=0*b$i),this.d=b$y*b$f,this.bTransform=!0},b$M.rotateEx=function(b$M){var b$y=Math.cos(b$M),b$i=Math.sin(b$M),b$H=this.a,b$S=this.b,b$f=this.c,b$V=this.d;0!==b$S||0!==b$f?(this.a=b$y*b$H+b$i*b$f,this.b=b$y*b$S+b$i*b$V,this.c=-b$i*b$H+b$y*b$f,this.d=-b$i*b$S+b$y*b$V):(this.a=b$y*b$H,this.b=b$i*b$V,this.c=-b$i*b$H,this.d=b$y*b$V),this.bTransform=!0},b$M.clone=function(){var b$M=b$i.create();return b$M.a=this.a,b$M.b=this.b,b$M.c=this.c,b$M.d=this.d,b$M.tx=this.tx,b$M.ty=this.ty,b$M.bTransform=this.bTransform,b$M},b$M.copyTo=function(b$M){return b$M.a=this.a,b$M.b=this.b,b$M.c=this.c,b$M.d=this.d,b$M.tx=this.tx,b$M.ty=this.ty,b$M.bTransform=this.bTransform,b$M},b$M.toString=function(){return this.a+","+this.b+","+this.c+","+this.d+","+this.tx+","+this.ty},b$M.destroy=function(){if(!this.inPool){var b$M=b$i._cache;this.inPool=!0,b$M._length||(b$M._length=0),(b$M[b$M._length++]=this).a=this.d=1,this.b=this.c=this.tx=this.ty=0,this.bTransform=!1}},b$i.mul=function(b$M,b$y,b$i){var b$H=b$M.a,b$S=b$M.b,b$f=b$M.c,b$V=b$M.d,b$K=b$M.tx,b$k=b$M.ty,b$X=b$y.a,b$F=b$y.b,b$o=b$y.c,b$d=b$y.d,b$P=b$y.tx,b$l=b$y.ty;return 0!==b$F||0!==b$o?(b$i.a=b$H*b$X+b$S*b$o,b$i.b=b$H*b$F+b$S*b$d,b$i.c=b$f*b$X+b$V*b$o,b$i.d=b$f*b$F+b$V*b$d,b$i.tx=b$X*b$K+b$o*b$k+b$P,b$i.ty=b$F*b$K+b$d*b$k+b$l):(b$i.a=b$H*b$X,b$i.b=b$S*b$d,b$i.c=b$f*b$X,b$i.d=b$V*b$d,b$i.tx=b$X*b$K+b$P,b$i.ty=b$d*b$k+b$l),b$i},b$i.mul16=function(b$M,b$y,b$i){var b$H=b$M.a,b$S=b$M.b,b$f=b$M.c,b$V=b$M.d,b$K=b$M.tx,b$k=b$M.ty,b$X=b$y.a,b$F=b$y.b,b$o=b$y.c,b$d=b$y.d,b$P=b$y.tx,b$l=b$y.ty;return 0!==b$F||0!==b$o?(b$i[0]=b$H*b$X+b$S*b$o,b$i[1]=b$H*b$F+b$S*b$d,b$i[4]=b$f*b$X+b$V*b$o,b$i[5]=b$f*b$F+b$V*b$d,b$i[12]=b$X*b$K+b$o*b$k+b$P,b$i[13]=b$F*b$K+b$d*b$k+b$l):(b$i[0]=b$H*b$X,b$i[1]=b$S*b$d,b$i[4]=b$f*b$X,b$i[5]=b$V*b$d,b$i[12]=b$X*b$K+b$P,b$i[13]=b$d*b$k+b$l),b$i},b$i.mulPre=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){var b$k=b$M.a,b$X=b$M.b,b$F=b$M.c,b$o=b$M.d,b$d=b$M.tx,b$P=b$M.ty;return 0!==b$i||0!==b$H?(b$K.a=b$k*b$y+b$X*b$H,b$K.b=b$k*b$i+b$X*b$S,b$K.c=b$F*b$y+b$o*b$H,b$K.d=b$F*b$i+b$o*b$S,b$K.tx=b$y*b$d+b$H*b$P+b$f,b$K.ty=b$i*b$d+b$S*b$P+b$V):(b$K.a=b$k*b$y,b$K.b=b$X*b$S,b$K.c=b$F*b$y,b$K.d=b$o*b$S,b$K.tx=b$y*b$d+b$f,b$K.ty=b$S*b$P+b$V),b$K},b$i.mulPos=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){var b$k=b$M.a,b$X=b$M.b,b$F=b$M.c,b$o=b$M.d,b$d=b$M.tx,b$P=b$M.ty;return 0!==b$X||0!==b$F?(b$K.a=b$y*b$k+b$i*b$F,b$K.b=b$y*b$X+b$i*b$o,b$K.c=b$H*b$k+b$S*b$F,b$K.d=b$H*b$X+b$S*b$o,b$K.tx=b$k*b$f+b$F*b$V+b$d,b$K.ty=b$X*b$f+b$o*b$V+b$P):(b$K.a=b$y*b$k,b$K.b=b$i*b$o,b$K.c=b$H*b$k,b$K.d=b$S*b$o,b$K.tx=b$k*b$f+b$d,b$K.ty=b$o*b$V+b$P),b$K},b$i.preMul=function(b$M,b$y,b$i){var b$H=b$M.a,b$S=b$M.b,b$f=b$M.c,b$V=b$M.d,b$K=b$y.a,b$k=b$y.b,b$X=b$y.c,b$F=b$y.d,b$o=b$y.tx,b$d=b$y.ty;return b$i.a=b$K*b$H,b$i.b=b$i.c=0,b$i.d=b$F*b$V,b$i.tx=b$o*b$H+b$M.tx,b$i.ty=b$d*b$V+b$M.ty,0===b$k&&0===b$X&&0===b$S&&0===b$f||(b$i.a+=b$k*b$f,b$i.d+=b$X*b$S,b$i.b+=b$K*b$S+b$k*b$V,b$i.c+=b$X*b$H+b$F*b$f,b$i.tx+=b$d*b$f,b$i.ty+=b$o*b$S),b$i},b$i.preMulXY=function(b$M,b$y,b$i,b$H){var b$S=b$M.a,b$f=b$M.b,b$V=b$M.c,b$K=b$M.d;return b$H.a=b$S,b$H.b=b$f,b$H.c=b$V,b$H.d=b$K,b$H.tx=b$y*b$S+b$M.tx+b$i*b$V,b$H.ty=b$i*b$K+b$M.ty+b$y*b$f,b$H},b$i.create=function(){var b$M=b$i._cache,b$y=b$M._length?b$M[--b$M._length]:new b$i;return b$y.inPool=!1,b$y},b$i.EMPTY=new b$i,b$i.TEMP=new b$i,b$i._cache=[],b$i}(),b$Q=function(){function b$M(b$M,b$y){void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),this.x=b$M,this.y=b$y}b$F(b$M,"laya.maths.Point");var b$y=b$M.prototype;return b$y.setTo=function(b$M,b$y){return this.x=b$M,this.y=b$y,this},b$y.distance=function(b$M,b$y){return Math.sqrt((this.x-b$M)*(this.x-b$M)+(this.y-b$y)*(this.y-b$y))},b$y.toString=function(){return this.x+","+this.y},b$y.normalize=function(){var b$M=Math.sqrt(this.x*this.x+this.y*this.y);if(0<b$M){var b$y=1/b$M;this.x*=b$y,this.y*=b$y}},b$M.TEMP=new b$M,b$M.EMPTY=new b$M,b$M}(),b$W=function(){function b$X(b$M,b$y,b$i,b$H){void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=0),this.x=b$M,this.y=b$y,this.width=b$i,this.height=b$H}b$F(b$X,"laya.maths.Rectangle");var b$M=b$X.prototype;return b$M.setTo=function(b$M,b$y,b$i,b$H){return this.x=b$M,this.y=b$y,this.width=b$i,this.height=b$H,this},b$M.copyFrom=function(b$M){return this.x=b$M.x,this.y=b$M.y,this.width=b$M.width,this.height=b$M.height,this},b$M.contains=function(b$M,b$y){return!(this.width<=0||this.height<=0)&&(b$M>=this.x&&b$M<this.right&&b$y>=this.y&&b$y<this.bottom)},b$M.intersects=function(b$M){return!(b$M.x>this.x+this.width||b$M.x+b$M.width<this.x||b$M.y>this.y+this.height||b$M.y+b$M.height<this.y)},b$M.intersection=function(b$M,b$y){return this.intersects(b$M)?(b$y||(b$y=new b$X),b$y.x=Math.max(this.x,b$M.x),b$y.y=Math.max(this.y,b$M.y),b$y.width=Math.min(this.right,b$M.right)-b$y.x,b$y.height=Math.min(this.bottom,b$M.bottom)-b$y.y,b$y):null},b$M.union=function(b$M,b$y){return b$y||(b$y=new b$X),this.clone(b$y),b$M.width<=0||b$M.height<=0?b$y:(b$y.addPoint(b$M.x,b$M.y),b$y.addPoint(b$M.right,b$M.bottom),this)},b$M.clone=function(b$M){return b$M||(b$M=new b$X),b$M.x=this.x,b$M.y=this.y,b$M.width=this.width,b$M.height=this.height,b$M},b$M.toString=function(){return this.x+","+this.y+","+this.width+","+this.height},b$M.equals=function(b$M){return!(!b$M||b$M.x!==this.x||b$M.y!==this.y||b$M.width!==this.width||b$M.height!==this.height)},b$M.addPoint=function(b$M,b$y){return this.x>b$M&&(this.width+=this.x-b$M,this.x=b$M),this.y>b$y&&(this.height+=this.y-b$y,this.y=b$y),this.width<b$M-this.x&&(this.width=b$M-this.x),this.height<b$y-this.y&&(this.height=b$y-this.y),this},b$M._getBoundPoints=function(){var b$M=b$X._temB;return(b$M.length=0)==this.width||0==this.height||b$M.push(this.x,this.y,this.x+this.width,this.y,this.x,this.y+this.height,this.x+this.width,this.y+this.height),b$M},b$M.isEmpty=function(){return this.width<=0||this.height<=0},b$l(0,b$M,"right",function(){return this.x+this.width}),b$l(0,b$M,"bottom",function(){return this.y+this.height}),b$X._getBoundPointS=function(b$M,b$y,b$i,b$H){var b$S=b$X._temA;return(b$S.length=0)==b$i||0==b$H||b$S.push(b$M,b$y,b$M+b$i,b$y,b$M,b$y+b$H,b$M+b$i,b$y+b$H),b$S},b$X._getWrapRec=function(b$M,b$y){if(!b$M||b$M.length<1)return b$y?b$y.setTo(0,0,0,0):b$X.TEMP.setTo(0,0,0,0);b$y=b$y||new b$X;var b$i,b$H,b$S,b$f,b$V,b$K=b$M.length,b$k=b$Q.TEMP;for(b$S=b$V=-(b$H=b$f=99999),b$i=0;b$i<b$K;b$i+=2)b$k.x=b$M[b$i],b$k.y=b$M[b$i+1],b$H=b$H<b$k.x?b$H:b$k.x,b$f=b$f<b$k.y?b$f:b$k.y,b$S=b$S>b$k.x?b$S:b$k.x,b$V=b$V>b$k.y?b$V:b$k.y;return b$y.setTo(b$H,b$f,b$S-b$H,b$V-b$f)},b$X.EMPTY=new b$X,b$X.TEMP=new b$X,b$X._temB=[],b$X._temA=[],b$X}(),b$a=function(){function b$k(){}return b$F(b$k,"laya.media.SoundManager"),b$l(1,b$k,"useAudioMusic",function(){return b$k._useAudioMusic},function(b$M){b$k._useAudioMusic=b$M,b$k._musicClass=b$M?b$iM:null}),b$l(1,b$k,"autoStopMusic",function(){return b$k._autoStopMusic},function(b$M){b$U.stage.off("blur",null,b$k._stageOnBlur),b$U.stage.off("focus",null,b$k._stageOnFocus),b$U.stage.off("visibilitychange",null,b$k._visibilityChange),(b$k._autoStopMusic=b$M)&&(b$U.stage.on("blur",null,b$k._stageOnBlur),b$U.stage.on("focus",null,b$k._stageOnFocus),b$U.stage.on("visibilitychange",null,b$k._visibilityChange))}),b$l(1,b$k,"muted",function(){return b$k._muted},function(b$M){b$M!=b$k._muted&&(b$M&&b$k.stopAllSound(),b$k.musicMuted=b$M,b$k._muted=b$M)}),b$l(1,b$k,"musicMuted",function(){return b$k._musicMuted},function(b$M){b$M!=b$k._musicMuted&&(b$M?(b$k._tMusic&&b$k._musicChannel&&!b$k._musicChannel.isStopped?b$k._musicChannel.pause():b$k._musicChannel=null,b$k._musicMuted=b$M):(b$k._musicMuted=b$M,b$k._tMusic&&b$k._musicChannel&&b$k._musicChannel.resume()))}),b$l(1,b$k,"soundMuted",function(){return b$k._soundMuted},function(b$M){b$k._soundMuted=b$M}),b$k.addChannel=function(b$M){0<=b$k._channels.indexOf(b$M)||(b$k._channels.push(b$M),b$k.autoReleaseSound&&0!=b$k._notUsedCount&&b$k._notUsedUrls[b$M.url]&&(delete b$k._notUsedUrls[b$M.url],0==--b$k._notUsedCount&&b$U.timer.clear(b$k,b$k.disposeSoundIfNotUsed)))},b$k.removeChannel=function(b$M){var b$y=b$k._channels,b$i=b$y.indexOf(b$M);if(-1!=b$i&&(b$y.splice(b$i,1),b$k.autoReleaseSound)){var b$H=b$M.url,b$S=b$k.defaultIntervals[b$H]||2e4;if(0<b$S){var b$f=!0;for(b$i=b$y.length-1;0<=b$i;b$i--)if(b$y[b$i].url==b$H){b$f=!1;break}b$f&&(b$k._notUsedUrls[b$H]=Date.now()+b$S,0==b$k._notUsedCount++&&b$U.timer.loop(1e4,b$k,b$k.disposeSoundIfNotUsed))}}},b$k.disposeSoundIfNotUsed=function(){var b$M=b$k._notUsedUrls;if(0!=b$k._notUsedCount){var b$y=Date.now();for(var b$i in b$M)b$y>=b$M[b$i]&&(delete b$M[b$i],--b$k._notUsedCount,b$k.destroySound(b$i));if(0!=b$k._notUsedCount)return}b$U.timer.clear(b$k,b$k.disposeSoundIfNotUsed)},b$k._visibilityChange=function(){b$U.stage.isVisibility?b$k._stageOnFocus():b$k._stageOnBlur()},b$k._stageOnBlur=function(){b$k._isActive=!1,b$k._musicChannel&&(b$k._musicChannel.isStopped||(b$k._blurPaused=!0,b$k._musicChannel.pause())),b$k.stopAllSound(),b$U.stage.once("mousedown",null,b$k._stageOnFocus)},b$k._recoverWebAudio=function(){b$fM.ctx&&"running"!=b$fM.ctx.state&&b$fM.ctx.resume&&b$fM.ctx.resume()},b$k._stageOnFocus=function(){if(b$k._isActive=!0,b$k._recoverWebAudio(),b$U.stage.off("mousedown",null,b$k._stageOnFocus),b$k._blurPaused){var b$M=b$k._musicChannel;b$M&&b$k._music&&b$M.isStopped&&(b$k._blurPaused=!1,b$k._music._disposed?b$k.playMusic(b$M.url,b$M.loops,b$M.startHandler,b$M.completeHandler,b$M.startTime):b$M.audioBuffer?b$M.resume():b$k._music.play(b$M.startTime,b$M.loops,b$M.startHandler,b$M))}},b$k.playSound=function(b$M,b$y,b$i,b$H,b$S,b$f){if(void 0===b$y&&(b$y=1),void 0===b$f&&(b$f=0),!b$M)return null;if(b$k._muted)return null;if(b$k._recoverWebAudio(),b$M==b$k._tMusic){if(b$k._musicMuted)return null}else{if(!b$k._isActive)return null;if(b$k._soundMuted)return null}var b$V,b$K=b$k._pool[b$M];return b$S||(b$S=b$k._soundClass),b$K||((b$K=new b$S).load(b$M),b$k._pool[b$M]=b$K),(b$V=b$K.play(b$f,b$y,b$i))?(b$M==b$k._tMusic&&(b$k._music=b$K,b$k._isActive||(b$k._blurPaused=!0,b$V.pause())),b$V.url=b$M,b$V.volume=b$M==b$k._tMusic?b$k.musicVolume:b$k.soundVolume,b$V.completeHandler=b$H,b$V):null},b$k.destroySound=function(b$M){var b$y=b$k._pool[b$M];b$y&&(delete b$k._pool[b$M],b$y.dispose())},b$k.playMusic=function(b$M,b$y,b$i,b$H,b$S){return void 0===b$y&&(b$y=0),void 0===b$S&&(b$S=0),b$k._tMusic=b$M,b$k._musicChannel&&b$k._musicChannel.stop(),b$k._musicChannel=b$k.playSound(b$M,b$y,b$i,b$H,null,b$S)},b$k.stopSound=function(b$M){for(var b$y,b$i=b$k._channels.length-1;0<=b$i;b$i--)(b$y=b$k._channels[b$i]).url==b$M&&b$y.stop()},b$k.stopAll=function(){b$k._tMusic=null;var b$M=0;for(b$M=b$k._channels.length-1;0<=b$M;b$M--)b$k._channels[b$M].stop()},b$k.stopAllSound=function(){var b$M,b$y=0;for(b$y=b$k._channels.length-1;0<=b$y;b$y--)(b$M=b$k._channels[b$y]).url!=b$k._tMusic&&b$M.stop()},b$k.stopMusic=function(){b$k._musicChannel&&b$k._musicChannel.stop(),b$k._tMusic=null},b$k.setSoundVolume=function(b$M,b$y){if(b$y)b$k._setVolume(b$y,b$M);else{b$k.soundVolume=b$M;var b$i,b$H=0;for(b$H=b$k._channels.length-1;0<=b$H;b$H--)(b$i=b$k._channels[b$H]).url!=b$k._tMusic&&(b$i.volume=b$M)}},b$k.setMusicVolume=function(b$M){b$k.musicVolume=b$M,b$k._setVolume(b$k._tMusic,b$M)},b$k._setVolume=function(b$M,b$y){for(var b$i,b$H=b$k._channels.length-1;0<=b$H;b$H--)(b$i=b$k._channels[b$H]).url==b$M&&(b$i.volume=b$y)},b$k.musicVolume=1,b$k.soundVolume=1,b$k.playbackRate=1,b$k._useAudioMusic=!0,b$k._muted=!1,b$k._soundMuted=!1,b$k._musicMuted=!1,b$k._tMusic=null,b$k._musicChannel=null,b$k._music=null,b$k._channels=[],b$k._autoStopMusic=!1,b$k._blurPaused=!1,b$k._isActive=!0,b$k._soundClass=null,b$k._musicClass=null,b$k.autoReleaseSound=!0,b$k._pool={},b$k.defaultIntervals={},b$k._notUsedUrls={},b$k._notUsedCount=0,b$k}(),b$c=function(){var b$M;function b$i(){}return b$F(b$i,"laya.net.LocalStorage"),b$i.__init__=function(){b$i._baseClass||(b$i._baseClass=b$M).init(),b$i.items=b$i._baseClass.items,b$i.support=b$i._baseClass.support},b$i.setItem=function(b$M,b$y){b$i._baseClass.setItem(b$M,b$y)},b$i.getItem=function(b$M){return b$i._baseClass.getItem(b$M)},b$i.setJSON=function(b$M,b$y){b$i._baseClass.setJSON(b$M,b$y)},b$i.getJSON=function(b$M){return b$i._baseClass.getJSON(b$M)},b$i.removeItem=function(b$M){b$i._baseClass.removeItem(b$M)},b$i.clear=function(){b$i._baseClass.clear()},b$i._baseClass=null,b$i.items=null,b$i.support=!1,b$i.__init$=function(){b$M=function(){function b$i(){}return b$F(b$i,""),b$i.init=function(){try{b$i.support=!0,b$i.items=b$V.localStorage,b$i.setItem("laya","1"),b$i.removeItem("laya")}catch(b$M){b$i.support=!1}b$i.support||console.log("LocalStorage is not supprot or browser is private mode.")},b$i.setItem=function(b$M,b$y){try{b$i.support&&b$i.items.setItem(b$M,b$y)}catch(b$M){console.warn("set localStorage failed",b$M)}},b$i.getItem=function(b$M){return b$i.support?b$i.items.getItem(b$M):null},b$i.setJSON=function(b$M,b$y){try{b$i.support&&b$i.items.setItem(b$M,JSON.stringify(b$y))}catch(b$M){console.warn("set localStorage failed",b$M)}},b$i.getJSON=function(b$M){return JSON.parse(b$i.support?b$i.items.getItem(b$M):null)},b$i.removeItem=function(b$M){b$i.support&&b$i.items.removeItem(b$M)},b$i.clear=function(){b$i.support&&b$i.items.clear()},b$i.items=null,b$i.support=!1,b$i}()},b$i}(),b$e=(function(){function b$H(){}b$F(b$H,"laya.net.ResourceVersion"),b$H.enable=function(b$M,b$y,b$i){void 0===b$i&&(b$i=2),laya.net.ResourceVersion.type=b$i,b$U.loader.load(b$M,b$v.create(null,b$H.onManifestLoaded,[b$y]),null,"json"),b$s.customFormat=b$H.addVersionPrefix},b$H.onManifestLoaded=function(b$M,b$y){b$H.manifest=b$y,b$M.run(),b$y||console.warn("资源版本清单文件不存在，不使用资源版本管理。忽略ERR_FILE_NOT_FOUND错误。")},b$H.addVersionPrefix=function(b$M){return b$H.manifest&&b$H.manifest[b$M]?2==b$H.type?b$H.manifest[b$M]:b$H.manifest[b$M]+"/"+b$M:b$M},b$H.FOLDER_VERSION=1,b$H.FILENAME_VERSION=2,b$H.manifest=null,b$H.type=1}(),function(){function b$M(){this.fontName=null,this.complete=null,this.err=null,this._fontTxt=null,this._url=null,this._div=null,this._txtWidth=NaN,this._http=null}b$F(b$M,"laya.net.TTFLoader");var b$y=b$M.prototype;return b$y.load=function(b$M){var b$y=(this._url=b$M).split(".ttf")[0].split("/");this.fontName=b$y[b$y.length-1],b$u.window.conch?this._loadConch():b$u.window.FontFace?this._loadWithFontFace():this._loadWithCSS()},b$y._loadConch=function(){this._http=new b$VM,this._http.on("error",this,this._onErr),this._http.on("complete",this,this._onHttpLoaded),this._http.send(this._url,null,"get","arraybuffer")},b$y._onHttpLoaded=function(b$M){b$u.window.conch.setFontFaceFromBuffer(this.fontName,b$M),this._clearHttp(),this._complete()},b$y._clearHttp=function(){this._http&&(this._http.off("error",this,this._onErr),this._http.off("complete",this,this._onHttpLoaded),this._http=null)},b$y._onErr=function(){this._clearHttp(),this.err&&(this.err.runWith("fail:"+this._url),this.err=null)},b$y._complete=function(){b$U.timer.clear(this,this._complete),b$U.timer.clear(this,this._checkComplete),this._div&&this._div.parentNode&&(this._div.parentNode.removeChild(this._div),this._div=null),this.complete&&(this.complete.runWith(this),this.complete=null)},b$y._checkComplete=function(){b$T.measureText("LayaTTFFont",this._fontTxt).width!=this._txtWidth&&this._complete()},b$y._loadWithFontFace=function(){var b$M=new b$u.window.FontFace(this.fontName,"url('"+this._url+"')");b$u.window.document.fonts.add(b$M);var b$y=this;b$M.loaded.then(function(){b$y._complete()}),b$M.load()},b$y._createDiv=function(){this._div=b$u.createElement("div"),this._div.innerHTML="laya";var b$M=this._div.style;b$M.fontFamily=this.fontName,b$M.position="absolute",b$M.left="-100px",b$M.top="-100px",b$u.document.body.appendChild(this._div)},b$y._loadWithCSS=function(){var b$M=this,b$y=b$u.createElement("style");b$y.type="text/css",b$u.document.body.appendChild(b$y),b$y.textContent="@font-face { font-family:'"+this.fontName+"'; src:url('"+this._url+"');}",this._fontTxt="40px "+this.fontName,this._txtWidth=b$T.measureText("LayaTTFFont",this._fontTxt).width;var b$i=this;b$y.onload=function(){b$U.timer.once(1e4,b$i,b$M._complete)},b$U.timer.loop(20,this,this._checkComplete),this._createDiv()},b$M._testString="LayaTTFFont",b$M}()),b$s=function(){function b$H(b$M){this._url=null,this._path=null,this._url=b$H.formatURL(b$M),this._path=b$H.getPath(b$M)}b$F(b$H,"laya.net.URL");var b$M=b$H.prototype;return b$l(0,b$M,"path",function(){return this._path}),b$l(0,b$M,"url",function(){return this._url}),b$H.formatURL=function(b$M,b$y){if(!b$M)return"null path";if(0<b$M.indexOf(":"))return b$M;null!=b$H.customFormat&&(b$M=b$H.customFormat(b$M,b$y));var b$i=b$M.charAt(0);if("."===b$i)return b$H.formatRelativePath((b$y||b$H.basePath)+b$M);if("~"===b$i)return b$H.rootPath+b$M.substring(1);if("d"===b$i){if(0===b$M.indexOf("data:image"))return b$M}else if("/"===b$i)return b$M;return(b$y||b$H.basePath)+b$M},b$H.formatRelativePath=function(b$M){for(var b$y=b$M.split("/"),b$i=0,b$H=b$y.length;b$i<b$H;b$i++)".."==b$y[b$i]&&(b$y.splice(b$i-1,2),b$i-=2);return b$y.join("/")},b$H.isAbsolute=function(b$M){return 0<b$M.indexOf(":")||"/"==b$M.charAt(0)},b$H.getPath=function(b$M){var b$y=b$M.lastIndexOf("/");return 0<b$y?b$M.substr(0,b$y+1):""},b$H.getFileName=function(b$M){var b$y=b$M.lastIndexOf("/");return 0<b$y?b$M.substr(b$y+1):b$M},b$H.version={},b$H.basePath="",b$H.rootPath="",b$H.customFormat=function(b$M){var b$y=b$H.version[b$M];return!b$D.isConchApp&&b$y&&(b$M+="?v="+b$y),b$M},b$H}(),b$D=function(){function b$S(b$M,b$y){this._timeId=0;var b$i=b$S._mainCanvas.source.style;b$i.position="absolute",b$i.top=b$i.left="0px",b$i.background="#000000",b$S._mainCanvas.source.id="layaCanvas";var b$H=laya.renders.Render.isWebGL;b$S._mainCanvas.source.width=b$M,b$S._mainCanvas.source.height=b$y,b$H&&b$S.WebGL.init(b$S._mainCanvas,b$M,b$y),b$u.container.appendChild(b$S._mainCanvas.source),(b$S._context=new b$z(b$M,b$y,b$H?null:b$S._mainCanvas)).ctx.setIsMainContext(),b$u.window.requestAnimationFrame(function b$M(b$y){b$u.window.requestAnimationFrame(b$M);b$U.stage._loop()}),b$U.stage.on("visibilitychange",this,this._onVisibilitychange)}b$F(b$S,"laya.renders.Render");var b$M=b$S.prototype;return b$M._onVisibilitychange=function(){b$U.stage.isVisibility?0!=this._timeId&&b$u.window.clearInterval(this._timeId):this._timeId=b$u.window.setInterval(this._enterFrame,1e3)},b$M._enterFrame=function(b$M){b$U.stage._loop()},b$l(1,b$S,"context",function(){return b$S._context}),b$l(1,b$S,"canvas",function(){return b$S._mainCanvas.source}),b$S._context=null,b$S._mainCanvas=null,b$S.WebGL=null,b$S.isConchNode=!1,b$S.isConchApp=!1,b$S.isConchWebGL=!1,b$S.isWebGL=!1,b$S.is3DMode=!1,b$S.optimizeTextureMemory=function(b$M,b$y){return!0},b$S.__init$=function(){b$V.ConchRenderType=b$V.ConchRenderType||1,b$V.ConchRenderType|=b$V.conch?4:0,b$S.isConchNode=5==(5&b$V.ConchRenderType),b$S.isConchApp=4==(4&b$V.ConchRenderType),b$S.isConchWebGL=6==b$V.ConchRenderType},b$S}(),b$z=function(){function b$V(b$M,b$y,b$i){this.x=0,this.y=0,this._drawTexture=function(b$M,b$y,b$i){b$i[0].loaded&&this.ctx.drawTexture(b$i[0],b$i[1],b$i[2],b$i[3],b$i[4],b$M,b$y)},this._fillTexture=function(b$M,b$y,b$i){b$i[0].loaded&&this.ctx.fillTexture(b$i[0],b$i[1]+b$M,b$i[2]+b$y,b$i[3],b$i[4],b$i[5],b$i[6],b$i[7])},this._drawTextureWithTransform=function(b$M,b$y,b$i){b$i[0].loaded&&this.ctx.drawTextureWithTransform(b$i[0],b$i[1],b$i[2],b$i[3],b$i[4],b$i[5],b$M,b$y,b$i[6])},this._fillQuadrangle=function(b$M,b$y,b$i){this.ctx.fillQuadrangle(b$i[0],b$i[1],b$i[2],b$i[3],b$i[4])},this._drawRect=function(b$M,b$y,b$i){var b$H=this.ctx;null!=b$i[4]&&(b$H.fillStyle=b$i[4],b$H.fillRect(b$M+b$i[0],b$y+b$i[1],b$i[2],b$i[3],null)),null!=b$i[5]&&(b$H.strokeStyle=b$i[5],b$H.lineWidth=b$i[6],b$H.strokeRect(b$M+b$i[0],b$y+b$i[1],b$i[2],b$i[3],b$i[6]))},this._drawPie=function(b$M,b$y,b$i){var b$H=this.ctx;b$D.isWebGL&&b$H.setPathId(b$i[8]),b$H.beginPath(),b$D.isWebGL?(b$H.movePath(b$i[0]+b$M,b$i[1]+b$y),b$H.moveTo(0,0)):b$H.moveTo(b$M+b$i[0],b$y+b$i[1]),b$H.arc(b$M+b$i[0],b$y+b$i[1],b$i[2],b$i[3],b$i[4]),b$H.closePath(),this._fillAndStroke(b$i[5],b$i[6],b$i[7],!0)},this._clipRect=function(b$M,b$y,b$i){this.ctx.clipRect(b$M+b$i[0],b$y+b$i[1],b$i[2],b$i[3])},this._fillRect=function(b$M,b$y,b$i){this.ctx.fillRect(b$M+b$i[0],b$y+b$i[1],b$i[2],b$i[3],b$i[4])},this._drawCircle=function(b$M,b$y,b$i){var b$H=this.ctx;b$D.isWebGL&&b$H.setPathId(b$i[6]),b$N.drawCall++,b$H.beginPath(),b$D.isWebGL&&b$H.movePath(b$i[0]+b$M,b$i[1]+b$y),b$H.arc(b$i[0]+b$M,b$i[1]+b$y,b$i[2],0,b$V.PI2),b$H.closePath(),this._fillAndStroke(b$i[3],b$i[4],b$i[5],!0)},this._fillCircle=function(b$M,b$y,b$i){b$N.drawCall++;var b$H=this.ctx;b$H.beginPath(),b$H.fillStyle=b$i[3],b$H.arc(b$i[0]+b$M,b$i[1]+b$y,b$i[2],0,b$V.PI2),b$H.fill()},this._setShader=function(b$M,b$y,b$i){this.ctx.setShader(b$i[0])},this._drawLine=function(b$M,b$y,b$i){var b$H=this.ctx;b$D.isWebGL&&b$H.setPathId(b$i[6]),b$H.beginPath(),b$H.strokeStyle=b$i[4],b$H.lineWidth=b$i[5],b$D.isWebGL?(b$H.movePath(b$M,b$y),b$H.moveTo(b$i[0],b$i[1]),b$H.lineTo(b$i[2],b$i[3])):(b$H.moveTo(b$M+b$i[0],b$y+b$i[1]),b$H.lineTo(b$M+b$i[2],b$y+b$i[3])),b$H.stroke()},this._drawLines=function(b$M,b$y,b$i){var b$H=this.ctx;b$D.isWebGL&&b$H.setPathId(b$i[5]),b$H.beginPath(),b$M+=b$i[0],b$y+=b$i[1],b$D.isWebGL&&b$H.movePath(b$M,b$y),b$H.strokeStyle=b$i[3],b$H.lineWidth=b$i[4];var b$S=b$i[2],b$f=2,b$V=b$S.length;if(b$D.isWebGL)for(b$H.moveTo(b$S[0],b$S[1]);b$f<b$V;)b$H.lineTo(b$S[b$f++],b$S[b$f++]);else for(b$H.moveTo(b$M+b$S[0],b$y+b$S[1]);b$f<b$V;)b$H.lineTo(b$M+b$S[b$f++],b$y+b$S[b$f++]);b$H.stroke()},this._drawLinesWebGL=function(b$M,b$y,b$i){this.ctx.drawLines(b$M+this.x+b$i[0],b$y+this.y+b$i[1],b$i[2],b$i[3],b$i[4])},this._drawCurves=function(b$M,b$y,b$i){this.ctx.drawCurves(b$M,b$y,b$i)},this._draw=function(b$M,b$y,b$i){b$i[0].call(null,this,b$M,b$y)},this._transformByMatrix=function(b$M,b$y,b$i){this.ctx.transformByMatrix(b$i[0])},this._setTransform=function(b$M,b$y,b$i){this.ctx.setTransform(b$i[0],b$i[1],b$i[2],b$i[3],b$i[4],b$i[5])},this._setTransformByMatrix=function(b$M,b$y,b$i){this.ctx.setTransformByMatrix(b$i[0])},this._save=function(b$M,b$y,b$i){this.ctx.save()},this._restore=function(b$M,b$y,b$i){this.ctx.restore()},this._translate=function(b$M,b$y,b$i){this.ctx.translate(b$i[0],b$i[1])},this._transform=function(b$M,b$y,b$i){this.ctx.translate(b$i[1]+b$M,b$i[2]+b$y);var b$H=b$i[0];this.ctx.transform(b$H.a,b$H.b,b$H.c,b$H.d,b$H.tx,b$H.ty),this.ctx.translate(-b$M-b$i[1],-b$y-b$i[2])},this._rotate=function(b$M,b$y,b$i){this.ctx.translate(b$i[1]+b$M,b$i[2]+b$y),this.ctx.rotate(b$i[0]),this.ctx.translate(-b$M-b$i[1],-b$y-b$i[2])},this._scale=function(b$M,b$y,b$i){this.ctx.translate(b$i[2]+b$M,b$i[3]+b$y),this.ctx.scale(b$i[0],b$i[1]),this.ctx.translate(-b$M-b$i[2],-b$y-b$i[3])},this._alpha=function(b$M,b$y,b$i){this.ctx.globalAlpha*=b$i[0]},this._setAlpha=function(b$M,b$y,b$i){this.ctx.globalAlpha=b$i[0]},this._fillText=function(b$M,b$y,b$i){this.ctx.fillText(b$i[0],b$i[1]+b$M,b$i[2]+b$y,b$i[3],b$i[4],b$i[5])},this._strokeText=function(b$M,b$y,b$i){this.ctx.strokeText(b$i[0],b$i[1]+b$M,b$i[2]+b$y,b$i[3],b$i[4],b$i[5],b$i[6])},this._fillBorderText=function(b$M,b$y,b$i){this.ctx.fillBorderText(b$i[0],b$i[1]+b$M,b$i[2]+b$y,b$i[3],b$i[4],b$i[5],b$i[6],b$i[7])},this._blendMode=function(b$M,b$y,b$i){this.ctx.globalCompositeOperation=b$i[0]},this._beginClip=function(b$M,b$y,b$i){this.ctx.beginClip&&this.ctx.beginClip(b$M+b$i[0],b$y+b$i[1],b$i[2],b$i[3])},this._setIBVB=function(b$M,b$y,b$i){this.ctx.setIBVB(b$i[0]+b$M,b$i[1]+b$y,b$i[2],b$i[3],b$i[4],b$i[5],b$i[6],b$i[7])},this._fillTrangles=function(b$M,b$y,b$i){this.ctx.fillTrangles(b$i[0],b$i[1]+b$M,b$i[2]+b$y,b$i[3],b$i[4])},this._drawPath=function(b$M,b$y,b$i){var b$H=this.ctx;b$D.isWebGL&&b$H.setPathId(-1),b$H.beginPath(),b$M+=b$i[0],b$y+=b$i[1],b$D.isWebGL&&b$H.movePath(b$M,b$y);for(var b$S=b$i[2],b$f=0,b$V=b$S.length;b$f<b$V;b$f++){var b$K=b$S[b$f];switch(b$K[0]){case"moveTo":b$D.isWebGL?b$H.moveTo(b$K[1],b$K[2]):b$H.moveTo(b$M+b$K[1],b$y+b$K[2]);break;case"lineTo":b$D.isWebGL?b$H.lineTo(b$K[1],b$K[2]):b$H.lineTo(b$M+b$K[1],b$y+b$K[2]);break;case"arcTo":b$D.isWebGL?b$H.arcTo(b$K[1],b$K[2],b$K[3],b$K[4],b$K[5]):b$H.arcTo(b$M+b$K[1],b$y+b$K[2],b$M+b$K[3],b$y+b$K[4],b$K[5]);break;case"closePath":b$H.closePath()}}var b$k=b$i[3];null!=b$k&&(b$H.fillStyle=b$k.fillStyle,b$H.fill());var b$X=b$i[4];null!=b$X&&(b$H.strokeStyle=b$X.strokeStyle,b$H.lineWidth=b$X.lineWidth||1,b$H.lineJoin=b$X.lineJoin,b$H.lineCap=b$X.lineCap,b$H.miterLimit=b$X.miterLimit,b$H.stroke())},this.drawPoly=function(b$M,b$y,b$i){this.ctx.drawPoly(b$M+this.x+b$i[0],b$y+this.y+b$i[1],b$i[2],b$i[3],b$i[4],b$i[5],b$i[6])},this._drawPoly=function(b$M,b$y,b$i){var b$H=this.ctx,b$S=b$i[2],b$f=2,b$V=b$S.length;if(b$D.isWebGL)for(b$H.setPathId(b$i[6]),b$H.beginPath(),b$M+=b$i[0],b$y+=b$i[1],b$H.movePath(b$M,b$y),b$H.moveTo(b$S[0],b$S[1]);b$f<b$V;)b$H.lineTo(b$S[b$f++],b$S[b$f++]);else for(b$H.beginPath(),b$M+=b$i[0],b$y+=b$i[1],b$H.moveTo(b$M+b$S[0],b$y+b$S[1]);b$f<b$V;)b$H.lineTo(b$M+b$S[b$f++],b$y+b$S[b$f++]);b$H.closePath(),this._fillAndStroke(b$i[3],b$i[4],b$i[5],b$i[7])},this._drawSkin=function(b$M,b$y,b$i){var b$H=b$i[0];if(b$H){var b$S=this.ctx;b$H.render(b$S,b$M,b$y)}},this._drawParticle=function(b$M,b$y,b$i){this.ctx.drawParticle(b$M+this.x,b$y+this.y,b$i[0])},this._setFilters=function(b$M,b$y,b$i){this.ctx.setFilters(b$i)},b$i?this.ctx=b$i.getContext("2d"):(b$i=b$RM.create("3D"),this.ctx=b$T.createWebGLContext2D(b$i),b$i._setContext(this.ctx)),b$i.size(b$M,b$y),this.canvas=b$i}b$F(b$V,"laya.renders.RenderContext");var b$M=b$V.prototype;return b$M.destroy=function(){this.canvas&&(this.canvas.destroy(),this.canvas=null,this.ctx=null),this.ctx&&(this.ctx.destroy(),this.ctx=null)},b$M.drawTexture=function(b$M,b$y,b$i,b$H,b$S){b$M.loaded&&this.ctx.drawTexture(b$M,b$y,b$i,b$H,b$S,this.x,this.y)},b$M._drawTextures=function(b$M,b$y,b$i){b$i[0].loaded&&this.ctx.drawTextures(b$i[0],b$i[1],b$M+this.x,b$y+this.y)},b$M.drawTextureWithTransform=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){b$M.loaded&&this.ctx.drawTextureWithTransform(b$M,b$y,b$i,b$H,b$S,b$f,this.x,this.y,b$V)},b$M.fillQuadrangle=function(b$M,b$y,b$i,b$H,b$S){this.ctx.fillQuadrangle(b$M,b$y,b$i,b$H,b$S)},b$M.drawCanvas=function(b$M,b$y,b$i,b$H,b$S){this.ctx.drawCanvas(b$M,b$y+this.x,b$i+this.y,b$H,b$S)},b$M.drawRect=function(b$M,b$y,b$i,b$H,b$S,b$f){void 0===b$f&&(b$f=1);var b$V=this.ctx;b$V.strokeStyle=b$S,b$V.lineWidth=b$f,b$V.strokeRect(b$M+this.x,b$y+this.y,b$i,b$H,b$f)},b$M._fillAndStroke=function(b$M,b$y,b$i,b$H){void 0===b$H&&(b$H=!1);var b$S=this.ctx;null!=b$M&&(b$S.fillStyle=b$M,b$D.isWebGL?b$S.fill(b$H):b$S.fill()),null!=b$y&&0<b$i&&(b$S.strokeStyle=b$y,b$S.lineWidth=b$i,b$S.stroke())},b$M.clipRect=function(b$M,b$y,b$i,b$H){this.ctx.clipRect(b$M+this.x,b$y+this.y,b$i,b$H)},b$M.fillRect=function(b$M,b$y,b$i,b$H,b$S){this.ctx.fillRect(b$M+this.x,b$y+this.y,b$i,b$H,b$S)},b$M.drawCircle=function(b$M,b$y,b$i,b$H,b$S){void 0===b$S&&(b$S=1),b$N.drawCall++;var b$f=this.ctx;b$f.beginPath(),b$f.strokeStyle=b$H,b$f.lineWidth=b$S,b$f.arc(b$M+this.x,b$y+this.y,b$i,0,b$V.PI2),b$f.stroke()},b$M.drawTriangles=function(b$M,b$y,b$i){if(b$D.isWebGL)this.ctx.drawTriangles(b$i[0],b$M+b$i[1],b$y+b$i[2],b$i[3],b$i[4],b$i[5],b$i[6],b$i[7],b$i[8],b$i[9]);else{var b$H=b$i[5],b$S=0,b$f=b$H.length,b$V=this.ctx;for(b$S=0;b$S<b$f;b$S+=3){var b$K=2*b$H[b$S],b$k=2*b$H[b$S+1],b$X=2*b$H[b$S+2];b$V.drawTriangle(b$i[0],b$i[3],b$i[4],b$K,b$k,b$X,b$i[6],!0)}}},b$M.fillCircle=function(b$M,b$y,b$i,b$H){b$N.drawCall++;var b$S=this.ctx;b$S.beginPath(),b$S.fillStyle=b$H,b$S.arc(b$M+this.x,b$y+this.y,b$i,0,b$V.PI2),b$S.fill()},b$M.setShader=function(b$M){this.ctx.setShader(b$M)},b$M.drawLine=function(b$M,b$y,b$i,b$H,b$S,b$f){void 0===b$f&&(b$f=1);var b$V=this.ctx;b$V.beginPath(),b$V.strokeStyle=b$S,b$V.lineWidth=b$f,b$V.moveTo(this.x+b$M,this.y+b$y),b$V.lineTo(this.x+b$i,this.y+b$H),b$V.stroke()},b$M.clear=function(){this.ctx.clear()},b$M.transformByMatrix=function(b$M){this.ctx.transformByMatrix(b$M)},b$M.setTransform=function(b$M,b$y,b$i,b$H,b$S,b$f){this.ctx.setTransform(b$M,b$y,b$i,b$H,b$S,b$f)},b$M.setTransformByMatrix=function(b$M){this.ctx.setTransformByMatrix(b$M)},b$M.save=function(){this.ctx.save()},b$M.restore=function(){this.ctx.restore()},b$M.translate=function(b$M,b$y){this.ctx.translate(b$M,b$y)},b$M.transform=function(b$M,b$y,b$i,b$H,b$S,b$f){this.ctx.transform(b$M,b$y,b$i,b$H,b$S,b$f)},b$M.rotate=function(b$M){this.ctx.rotate(b$M)},b$M.scale=function(b$M,b$y){this.ctx.scale(b$M,b$y)},b$M.alpha=function(b$M){this.ctx.globalAlpha*=b$M},b$M.setAlpha=function(b$M){this.ctx.globalAlpha=b$M},b$M.fillWords=function(b$M,b$y,b$i,b$H,b$S,b$f){void 0===b$f&&(b$f=0),this.ctx.fillWords(b$M,b$y,b$i,b$H,b$S,b$f)},b$M.fillBorderWords=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this.ctx.fillBorderWords(b$M,b$y,b$i,b$H,b$S,b$f,b$V)},b$M.fillText=function(b$M,b$y,b$i,b$H,b$S,b$f){this.ctx.fillText(b$M,b$y+this.x,b$i+this.y,b$H,b$S,b$f)},b$M.strokeText=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this.ctx.strokeText(b$M,b$y+this.x,b$i+this.y,b$H,b$S,b$f,b$V)},b$M.blendMode=function(b$M){this.ctx.globalCompositeOperation=b$M},b$M.flush=function(){this.ctx.flush&&this.ctx.flush()},b$M.addRenderObject=function(b$M){this.ctx.addRenderObject(b$M)},b$M.beginClip=function(b$M,b$y,b$i,b$H){this.ctx.beginClip&&this.ctx.beginClip(b$M,b$y,b$i,b$H)},b$M.endClip=function(){this.ctx.endClip&&this.ctx.endClip()},b$M.fillTrangles=function(b$M,b$y,b$i){this.ctx.fillTrangles(b$i[0],b$i[1],b$i[2],b$i[3],4<b$i.length?b$i[4]:null)},b$V.PI2=2*Math.PI,b$V}(),b$w=function(){function b$V(b$M,b$y){switch(this._next=b$y||b$V.NORENDER,b$M){case 0:return void(this._fun=this._no);case 1:return void(this._fun=this._image);case 2:return void(this._fun=this._alpha);case 4:return void(this._fun=this._transform);case 8:return void(this._fun=this._blend);case 16:return void(this._fun=this._canvas);case 64:return void(this._fun=this._mask);case 128:return void(this._fun=this._clip);case 256:return void(this._fun=this._style);case 512:return void(this._fun=this._graphics);case 2048:return void(this._fun=this._childs);case 1024:return void(this._fun=this._custom);case 513:case 517:return void(this._fun=this._image2);case 32:return void(this._fun=b$C._filter);case 69905:return void(this._fun=b$V._initRenderFun)}this.onCreate(b$M)}b$F(b$V,"laya.renders.RenderSprite");var b$M=b$V.prototype;return b$M.onCreate=function(b$M){},b$M._style=function(b$M,b$y,b$i,b$H){b$M._style.render(b$M,b$y,b$i,b$H);var b$S=this._next;b$S._fun.call(b$S,b$M,b$y,b$i,b$H)},b$M._no=function(b$M,b$y,b$i,b$H){},b$M._custom=function(b$M,b$y,b$i,b$H){b$M.customRender(b$y,b$i,b$H);var b$S=b$M._style._tf;this._next._fun.call(this._next,b$M,b$y,b$i-b$S.translateX,b$H-b$S.translateY)},b$M._clip=function(b$M,b$y,b$i,b$H){var b$S=this._next;if(b$S!=b$V.NORENDER){var b$f=b$M._style.scrollRect;b$y.ctx.save(),b$y.ctx.clipRect(b$i,b$H,b$f.width,b$f.height),b$S._fun.call(b$S,b$M,b$y,b$i-b$f.x,b$H-b$f.y),b$y.ctx.restore()}},b$M._blend=function(b$M,b$y,b$i,b$H){var b$S=b$M._style;b$S.blendMode&&(b$y.ctx.globalCompositeOperation=b$S.blendMode);var b$f=this._next;b$f._fun.call(b$f,b$M,b$y,b$i,b$H),b$y.ctx.globalCompositeOperation="source-over"},b$M._mask=function(b$M,b$y,b$i,b$H){var b$S=this._next;b$S._fun.call(b$S,b$M,b$y,b$i,b$H);var b$f=b$M.mask;b$f&&(b$y.ctx.globalCompositeOperation="destination-in",(0<b$f.numChildren||!b$f.graphics._isOnlyOne())&&(b$f.cacheAsBitmap=!0),b$f.render(b$y,b$i-b$M.pivotX,b$H-b$M.pivotY)),b$y.ctx.globalCompositeOperation="source-over"},b$M._graphics=function(b$M,b$y,b$i,b$H){var b$S=b$M._style._tf;b$M._graphics&&b$M._graphics._render(b$M,b$y,b$i-b$S.translateX,b$H-b$S.translateY);var b$f=this._next;b$f._fun.call(b$f,b$M,b$y,b$i,b$H)},b$M._image=function(b$M,b$y,b$i,b$H){var b$S=b$M._style;b$y.ctx.drawTexture2(b$i,b$H,b$S._tf.translateX,b$S._tf.translateY,b$M.transform,b$S.alpha,b$S.blendMode,b$M._graphics._one)},b$M._image2=function(b$M,b$y,b$i,b$H){var b$S=b$M._style._tf;b$y.ctx.drawTexture2(b$i,b$H,b$S.translateX,b$S.translateY,b$M.transform,1,null,b$M._graphics._one)},b$M._alpha=function(b$M,b$y,b$i,b$H){var b$S;if(.01<(b$S=b$M._style.alpha)||b$M._needRepaint()){var b$f=b$y.ctx.globalAlpha;b$y.ctx.globalAlpha*=b$S;var b$V=this._next;b$V._fun.call(b$V,b$M,b$y,b$i,b$H),b$y.ctx.globalAlpha=b$f}},b$M._transform=function(b$M,b$y,b$i,b$H){var b$S=b$M.transform,b$f=this._next;b$S&&b$f!=b$V.NORENDER?(b$y.save(),b$y.transform(b$S.a,b$S.b,b$S.c,b$S.d,b$S.tx+b$i,b$S.ty+b$H),b$f._fun.call(b$f,b$M,b$y,0,0),b$y.restore()):b$f._fun.call(b$f,b$M,b$y,b$i,b$H)},b$M._childs=function(b$M,b$y,b$i,b$H){var b$S=b$M._style,b$f=b$S._tf;if(b$i=b$i-b$f.translateX+b$S.paddingLeft,b$H=b$H-b$f.translateY+b$S.paddingTop,b$S._calculation){var b$V=b$M._getWords();if(b$V){var b$K=b$S;b$K&&(b$K.stroke?b$y.fillBorderWords(b$V,b$i,b$H,b$K.font,b$K.color,b$K.strokeColor,b$K.stroke):b$y.fillWords(b$V,b$i,b$H,b$K.font,b$K.color,"none"!=b$K.textDecoration&&b$K.underLine?1:0))}}var b$k,b$X=b$M._childs,b$F=b$X.length;if(b$M.viewport||b$M.optimizeScrollRect&&b$M._style.scrollRect){var b$o=b$M.viewport||b$M._style.scrollRect,b$d=b$o.x,b$P=b$o.y,b$l=b$o.right,b$J=b$o.bottom,b$h=NaN,b$C=NaN;for(b$v=0;b$v<b$F;++b$v)(b$k=b$X[b$v]).visible&&(b$h=b$k._x)<b$l&&b$h+b$k.width>b$d&&(b$C=b$k._y)<b$J&&b$C+b$k.height>b$P&&b$k.render(b$y,b$i,b$H)}else for(var b$v=0;b$v<b$F;++b$v)(b$k=b$X[b$v])._style.visible&&b$k.render(b$y,b$i,b$H)},b$M._canvas=function(b$M,b$y,b$i,b$H){var b$S=b$M._$P.cacheCanvas;if(b$S){"bitmap"===b$S.type?b$N.canvasBitmap++:b$N.canvasNormal++;var b$f=b$S.ctx;if(b$M._needRepaint()||!b$f)this._canvas_repaint(b$M,b$y,b$i,b$H);else{var b$V=b$S._cacheRec;b$y.drawCanvas(b$f.canvas,b$i+b$V.x,b$H+b$V.y,b$V.width,b$V.height)}}else this._next._fun.call(this._next,b$M,b$y,b$i,b$H)},b$M._canvas_repaint=function(b$M,b$y,b$i,b$H){var b$S=b$M._$P.cacheCanvas,b$f=this._next;if(b$S){var b$V,b$K,b$k,b$X,b$F=b$S.ctx,b$o=b$M._needRepaint()||!b$F,b$d=b$S.type;if("bitmap"===b$d?b$N.canvasBitmap++:b$N.canvasNormal++,b$o){var b$P,b$l;b$S._cacheRec||(b$S._cacheRec=new b$W),b$D.isWebGL&&"bitmap"!==b$d?b$S._cacheRec.setTo(-b$M.pivotX,-b$M.pivotY,1,1):((b$X=b$M.getSelfBounds()).x=b$X.x-b$M.pivotX,b$X.y=b$X.y-b$M.pivotY,b$X.x=b$X.x-16,b$X.y=b$X.y-16,b$X.width=b$X.width+32,b$X.height=b$X.height+32,b$X.x=Math.floor(b$X.x+b$i)-b$i,b$X.y=Math.floor(b$X.y+b$H)-b$H,b$X.width=Math.floor(b$X.width),b$X.height=Math.floor(b$X.height),b$S._cacheRec.copyFrom(b$X)),b$X=b$S._cacheRec;var b$J,b$h=b$D.isWebGL?1:b$u.pixelRatio*b$U.stage.clientScaleX,b$C=b$D.isWebGL?1:b$u.pixelRatio*b$U.stage.clientScaleY;if(!b$D.isWebGL){var b$v,b$R=1,b$A=1;for(b$v=b$M;b$v&&b$v!=b$U.stage;)b$R*=b$v.scaleX,b$A*=b$v.scaleY,b$v=b$v.parent;b$D.isWebGL?(b$R<1&&(b$h*=b$R),b$A<1&&(b$C*=b$A)):(1<b$R&&(b$h*=b$R),1<b$A&&(b$C*=b$A))}if(b$M.scrollRect){var b$G=b$M.scrollRect;b$X.x-=b$G.x,b$X.y-=b$G.y}if(b$P=b$X.width*b$h,b$l=b$X.height*b$C,b$K=b$X.x,b$k=b$X.y,b$D.isWebGL&&"bitmap"===b$d&&(2048<b$P||2048<b$l))return console.warn("cache bitmap size larger than 2048,cache ignored"),b$S.ctx&&(b$r.recover("RenderContext",b$S.ctx),b$S.ctx.canvas.size(0,0),b$S.ctx=null),void b$f._fun.call(b$f,b$M,b$y,b$i,b$H);if(b$F||(b$F=b$S.ctx=b$r.getItem("RenderContext")||new b$z(b$P,b$l,b$RM.create("AUTO"))),b$F.ctx.sprite=b$M,(b$V=b$F.canvas).clear(),(b$V.width!=b$P||b$V.height!=b$l)&&b$V.size(b$P,b$l),"bitmap"===b$d?b$V.context.asBitmap=!0:"normal"===b$d&&(b$V.context.asBitmap=!1),1!=b$h||1!=b$C){var b$I=b$F.ctx;b$I.save(),b$I.scale(b$h,b$C),!b$D.isConchWebGL&&b$D.isConchApp&&(b$J=b$M._$P.cf)&&b$I.setFilterMatrix&&b$I.setFilterMatrix(b$J._mat,b$J._alpha),b$f._fun.call(b$f,b$M,b$F,-b$K,-b$k),b$I.restore(),b$D.isConchApp&&!b$D.isConchWebGL||b$M._applyFilters()}else b$I=b$F.ctx,!b$D.isConchWebGL&&b$D.isConchApp&&(b$J=b$M._$P.cf)&&b$I.setFilterMatrix&&b$I.setFilterMatrix(b$J._mat,b$J._alpha),b$f._fun.call(b$f,b$M,b$F,-b$K,-b$k),b$D.isConchApp&&!b$D.isConchWebGL||b$M._applyFilters();b$M._$P.staticCache&&(b$S.reCache=!1),b$N.canvasReCache++}else b$K=(b$X=b$S._cacheRec).x,b$k=b$X.y,b$V=b$F.canvas;b$y.drawCanvas(b$V,b$i+b$K,b$H+b$k,b$X.width,b$X.height)}else b$f._fun.call(b$f,b$M,b$F,b$i,b$H)},b$V.__init__=function(){var b$M,b$y,b$i=0;for(b$y=b$T.createRenderSprite(69905,null),b$M=b$V.renders.length=4096,b$i=0;b$i<b$M;b$i++)b$V.renders[b$i]=b$y;b$V.renders[0]=b$T.createRenderSprite(0,null),function(b$M,b$y){for(var b$i=0,b$H=0;b$H<b$M.length;b$H++)b$i|=b$M[b$H],b$V.renders[b$i]=b$y}([1,512,4,2],new b$V(1,null)),b$V.renders[513]=b$T.createRenderSprite(513,null),b$V.renders[517]=new b$V(517,null)},b$V._initRenderFun=function(b$M,b$y,b$i,b$H){var b$S=b$M._renderType;(b$V.renders[b$S]=b$V._getTypeRender(b$S))._fun(b$M,b$y,b$i,b$H)},b$V._getTypeRender=function(b$M){for(var b$y=null,b$i=2048;1<b$i;)b$i&b$M&&(b$y=b$T.createRenderSprite(b$i,b$y)),b$i>>=1;return b$y},b$V.IMAGE=1,b$V.ALPHA=2,b$V.TRANSFORM=4,b$V.BLEND=8,b$V.CANVAS=16,b$V.FILTERS=32,b$V.MASK=64,b$V.CLIP=128,b$V.STYLE=256,b$V.GRAPHICS=512,b$V.CUSTOM=1024,b$V.CHILDS=2048,b$V.INIT=69905,b$V.renders=[],b$V.NORENDER=new b$V(0,null),b$V}(),b$q=function(){function b$K(){this._repaint=!1}b$F(b$K,"laya.resource.Context");var b$M=b$K.prototype;return b$M.replaceReset=function(){var b$M,b$y,b$i=0;for(b$M=b$K.replaceKeys.length,b$i=0;b$i<b$M;b$i++)b$y=b$K.replaceKeys[b$i],this[b$K.newKeys[b$i]]=this[b$y]},b$M.replaceResotre=function(){this.__restore(),this.__reset()},b$M.setIsMainContext=function(){},b$M.drawTextures=function(b$M,b$y,b$i,b$H){b$N.drawCall+=b$y.length/2;for(var b$S=b$M.width,b$f=b$M.height,b$V=0,b$K=b$y.length;b$V<b$K;b$V+=2)this.drawTexture(b$M,b$y[b$V],b$y[b$V+1],b$S,b$f,b$i,b$H)},b$M.drawCanvas=function(b$M,b$y,b$i,b$H,b$S){b$N.drawCall++,this.drawImage(b$M.source,b$y,b$i,b$H,b$S)},b$M.fillRect=function(b$M,b$y,b$i,b$H,b$S){b$N.drawCall++,b$S&&(this.fillStyle=b$S),this.__fillRect(b$M,b$y,b$i,b$H)},b$M.fillText=function(b$M,b$y,b$i,b$H,b$S,b$f){b$N.drawCall++,3<arguments.length&&null!=b$H&&(this.font=b$H,this.fillStyle=b$S,this.textAlign=b$f,this.textBaseline="top"),this.__fillText(b$M,b$y,b$i)},b$M.fillBorderText=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){b$N.drawCall++,this.font=b$H,this.fillStyle=b$S,this.textBaseline="top",this.strokeStyle=b$f,this.lineWidth=b$V,this.textAlign=b$K,this.__strokeText(b$M,b$y,b$i),this.__fillText(b$M,b$y,b$i)},b$M.strokeText=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){b$N.drawCall++,3<arguments.length&&null!=b$H&&(this.font=b$H,this.strokeStyle=b$S,this.lineWidth=b$f,this.textAlign=b$V,this.textBaseline="top"),this.__strokeText(b$M,b$y,b$i)},b$M.transformByMatrix=function(b$M){this.transform(b$M.a,b$M.b,b$M.c,b$M.d,b$M.tx,b$M.ty)},b$M.setTransformByMatrix=function(b$M){this.setTransform(b$M.a,b$M.b,b$M.c,b$M.d,b$M.tx,b$M.ty)},b$M.clipRect=function(b$M,b$y,b$i,b$H){b$N.drawCall++,this.beginPath(),this.rect(b$M,b$y,b$i,b$H),this.clip()},b$M.drawTexture=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){b$N.drawCall++;var b$K=b$M.uv,b$k=b$M.bitmap.width,b$X=b$M.bitmap.height;this.drawImage(b$M.source,b$K[0]*b$k,b$K[1]*b$X,(b$K[2]-b$K[0])*b$k,(b$K[5]-b$K[3])*b$X,b$y+b$f,b$i+b$V,b$H,b$S)},b$M.drawTextureWithTransform=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){b$N.drawCall++;var b$X=b$M.uv,b$F=b$M.bitmap.width,b$o=b$M.bitmap.height;this.save(),1!=b$k&&(this.globalAlpha*=b$k),b$f?(this.transform(b$f.a,b$f.b,b$f.c,b$f.d,b$f.tx+b$V,b$f.ty+b$K),this.drawImage(b$M.source,b$X[0]*b$F,b$X[1]*b$o,(b$X[2]-b$X[0])*b$F,(b$X[5]-b$X[3])*b$o,b$y,b$i,b$H,b$S)):this.drawImage(b$M.source,b$X[0]*b$F,b$X[1]*b$o,(b$X[2]-b$X[0])*b$F,(b$X[5]-b$X[3])*b$o,b$y+b$V,b$i+b$K,b$H,b$S),this.restore()},b$M.drawTexture2=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){var b$k=b$K[0];if(b$k.loaded&&b$k.bitmap&&b$k.source){b$N.drawCall++;var b$X=1!==b$f;if(b$X){var b$F=this.globalAlpha;this.globalAlpha*=b$f}var b$o=b$k.uv,b$d=b$k.bitmap.width,b$P=b$k.bitmap.height;b$S?(this.save(),this.transform(b$S.a,b$S.b,b$S.c,b$S.d,b$S.tx+b$M,b$S.ty+b$y),this.drawImage(b$k.source,b$o[0]*b$d,b$o[1]*b$P,(b$o[2]-b$o[0])*b$d,(b$o[5]-b$o[3])*b$P,b$K[1]-b$i,b$K[2]-b$H,b$K[3],b$K[4]),this.restore()):this.drawImage(b$k.source,b$o[0]*b$d,b$o[1]*b$P,(b$o[2]-b$o[0])*b$d,(b$o[5]-b$o[3])*b$P,b$K[1]-b$i+b$M,b$K[2]-b$H+b$y,b$K[3],b$K[4]),b$X&&(this.globalAlpha=b$F)}},b$M.fillTexture=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){if(!b$K.pat){if(b$M.uv!=b$FM.DEF_UV){var b$k=new b$RM("2D");b$k.getContext("2d"),b$k.size(b$M.width,b$M.height),b$k.context.drawTexture(b$M,0,0,b$M.width,b$M.height,0,0),b$M=new b$FM(b$k)}b$K.pat=this.createPattern(b$M.bitmap.source,b$f)}var b$X=b$y,b$F=b$i,b$o=0,b$d=0;b$V&&(b$X+=b$V.x%b$M.width,b$F+=b$V.y%b$M.height,b$o-=b$V.x%b$M.width,b$d-=b$V.y%b$M.height),this.translate(b$X,b$F),this.fillRect(b$o,b$d,b$H,b$S,b$K.pat),this.translate(-b$X,-b$F)},b$M.drawTriangle=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){var b$k=b$M.bitmap,b$X=b$k.source,b$F=b$M.width,b$o=b$M.height,b$d=b$k.width,b$P=b$k.height,b$l=b$i[b$H]*b$d,b$J=b$i[b$S]*b$d,b$h=b$i[b$f]*b$d,b$C=b$i[b$H+1]*b$P,b$v=b$i[b$S+1]*b$P,b$R=b$i[b$f+1]*b$P,b$A=b$y[b$H],b$G=b$y[b$S],b$I=b$y[b$f],b$U=b$y[b$H+1],b$Q=b$y[b$S+1],b$W=b$y[b$f+1];if(b$K){var b$c=(b$A+b$G+b$I)/3,b$n=(b$U+b$Q+b$W)/3,b$a=b$A-b$c,b$T=b$U-b$n,b$m=Math.sqrt(b$a*b$a+b$T*b$T);b$A=b$c+b$a/b$m*(b$m+1),b$U=b$n+b$T/b$m*(b$m+1),b$T=b$Q-b$n,b$G=b$c+(b$a=b$G-b$c)/(b$m=Math.sqrt(b$a*b$a+b$T*b$T))*(b$m+1),b$Q=b$n+b$T/b$m*(b$m+1),b$T=b$W-b$n,b$I=b$c+(b$a=b$I-b$c)/(b$m=Math.sqrt(b$a*b$a+b$T*b$T))*(b$m+1),b$W=b$n+b$T/b$m*(b$m+1)}this.save(),b$V&&this.transform(b$V.a,b$V.b,b$V.c,b$V.d,b$V.tx,b$V.ty),this.beginPath(),this.moveTo(b$A,b$U),this.lineTo(b$G,b$Q),this.lineTo(b$I,b$W),this.closePath(),this.clip();var b$e=1/(b$l*b$v+b$C*b$h+b$J*b$R-b$v*b$h-b$C*b$J-b$l*b$R),b$s=b$A*b$v+b$C*b$I+b$G*b$R-b$v*b$I-b$C*b$G-b$A*b$R,b$D=b$l*b$G+b$A*b$h+b$J*b$I-b$G*b$h-b$A*b$J-b$l*b$I,b$z=b$l*b$v*b$I+b$C*b$G*b$h+b$A*b$J*b$R-b$A*b$v*b$h-b$C*b$J*b$I-b$l*b$G*b$R,b$w=b$U*b$v+b$C*b$W+b$Q*b$R-b$v*b$W-b$C*b$Q-b$U*b$R,b$q=b$l*b$Q+b$U*b$h+b$J*b$W-b$Q*b$h-b$U*b$J-b$l*b$W,b$t=b$l*b$v*b$W+b$C*b$Q*b$h+b$U*b$J*b$R-b$U*b$v*b$h-b$C*b$J*b$W-b$l*b$Q*b$R;this.transform(b$s*b$e,b$w*b$e,b$D*b$e,b$q*b$e,b$z*b$e,b$t*b$e),this.drawImage(b$X,b$M.uv[0]*b$d,b$M.uv[1]*b$P,b$F,b$o,b$M.uv[0]*b$d,b$M.uv[1]*b$P,b$F,b$o),this.restore()},b$M.flush=function(){return 0},b$M.fillWords=function(b$M,b$y,b$i,b$H,b$S,b$f){b$H&&(this.font=b$H),b$S&&(this.fillStyle=b$S);this.textBaseline="top",this.textAlign="left";for(var b$V=0,b$K=b$M.length;b$V<b$K;b$V++){var b$k=b$M[b$V];if(this.__fillText(b$k.char,b$k.x+b$y,b$k.y+b$i),1===b$f){var b$X=b$k.height,b$F=.5*b$k.style.letterSpacing;b$F||(b$F=0),this.beginPath(),this.strokeStyle=b$S,this.lineWidth=1,this.moveTo(b$y+b$k.x-b$F+.5,b$i+b$k.y+b$X+.5),this.lineTo(b$y+b$k.x+b$k.width+b$F+.5,b$i+b$k.y+b$X+.5),this.stroke()}}},b$M.fillBorderWords=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){b$H&&(this.font=b$H),b$S&&(this.fillStyle=b$S),this.textBaseline="top",this.lineWidth=b$V,this.textAlign="left",this.strokeStyle=b$f;for(var b$K=0,b$k=b$M.length;b$K<b$k;b$K++){var b$X=b$M[b$K];this.__strokeText(b$X.char,b$X.x+b$y,b$X.y+b$i),this.__fillText(b$X.char,b$X.x+b$y,b$X.y+b$i)}},b$M.destroy=function(){this.canvas.width=this.canvas.height=0},b$M.clear=function(){this.clearRect(0,0,this._canvas.width,this._canvas.height),this._repaint=!1},b$M.drawCurves=function(b$M,b$y,b$i){this.beginPath(),this.strokeStyle=b$i[3],this.lineWidth=b$i[4];var b$H=b$i[2];b$M+=b$i[0],b$y+=b$i[1],this.moveTo(b$M+b$H[0],b$y+b$H[1]);for(var b$S=2,b$f=b$H.length;b$S<b$f;)this.quadraticCurveTo(b$M+b$H[b$S++],b$y+b$H[b$S++],b$M+b$H[b$S++],b$y+b$H[b$S++]);this.stroke()},b$K.__init__=function(b$y){var b$i=laya.resource.Context.prototype;if(!(b$y=b$y||CanvasRenderingContext2D.prototype).inited){b$y.inited=!0,b$y.__fillText=b$y.fillText,b$y.__fillRect=b$y.fillRect,b$y.__strokeText=b$y.strokeText;["drawTextures","drawTriangle","fillWords","fillBorderWords","setIsMainContext","fillRect","strokeText","fillTexture","fillText","transformByMatrix","setTransformByMatrix","clipRect","drawTexture","drawTexture2","drawTextureWithTransform","flush","clear","destroy","drawCanvas","fillBorderText","drawCurves"].forEach(function(b$M){b$y[b$M]=b$i[b$M]})}},b$K.replaceCanvasGetSet=function(b$M,b$y){var b$i=Object.getOwnPropertyDescriptor(b$M,b$y);if(!b$i||!b$i.configurable)return!1;var b$H,b$S={};for(b$H in b$i)"set"!=b$H&&(b$S[b$H]=b$i[b$H]);var b$f=b$i.set;return b$S.set=function(b$M){b$f.call(this,b$M);var b$y=this.getContext("2d");b$y&&"__reset"in b$y&&b$y.__reset()},Object.defineProperty(b$M,b$y,b$S),!0},b$K.replaceGetSet=function(b$M,b$y){var b$i=Object.getOwnPropertyDescriptor(b$M,b$y);if(!b$i||!b$i.configurable)return!1;var b$H,b$S={};for(b$H in b$i)"set"!=b$H&&(b$S[b$H]=b$i[b$H]);var b$f=b$i.set,b$V="___"+b$y+"__";return b$K.newKeys.push(b$V),b$S.set=function(b$M){b$M!=this[b$V]&&(this[b$V]=b$M,b$f.call(this,b$M))},Object.defineProperty(b$M,b$y,b$S),!0},b$K._default=new b$K,b$K.newKeys=[],b$k(b$K,["replaceKeys",function(){return this.replaceKeys=["font","fillStyle","textBaseline"]}]),b$K}(),b$t=function(){function b$f(b$M){this._id=0,this._name=null,this._resources=null,this._memorySize=0,this._garbageCollectionRate=NaN,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=0,this._id=++b$f._uniqueIDCounter,this._name=b$M||"Content Manager",b$f._isResourceManagersSorted=!1,this._memorySize=0,this._isOverflow=!1,this.autoRelease=!1,this.autoReleaseMaxSize=536870912,this._garbageCollectionRate=.2,b$f._resourceManagers.push(this),this._resources=[],this._records={}}b$F(b$f,"laya.resource.ResourceManager");var b$M=b$f.prototype;return b$U.imps(b$M,{"laya.resource.IDispose":!0}),b$M.getResourceByIndex=function(b$M){return this._resources[b$M]},b$M.getResourcesLength=function(){return this._resources.length},b$M.addResource=function(b$M){return b$M.resourceManager&&b$M.resourceManager.removeResource(b$M),-1===this._resources.indexOf(b$M)&&((b$M._resourceManager=this)._resources.push(b$M),this.addRecord(b$M.uri,b$M.__className,b$M.memorySize),this.addSize(b$M.memorySize),!0)},b$M.removeResource=function(b$M){var b$y=this._resources.indexOf(b$M);return-1!==b$y&&(this._resources.splice(b$y,1),b$M._resourceManager=null,this._memorySize-=b$M.memorySize,this.addRecord(b$M.uri,b$M.__className,-b$M.memorySize),!0)},b$M.unload=function(){for(var b$M=this._resources.slice(0,this._resources.length),b$y=0;b$y<b$M.length;b$y++){b$M[b$y].destroy()}b$M.length=0},b$M.dispose=function(){if(this===b$f._systemResourceManager)throw new Error("systemResourceManager不能被释放！");b$f._resourceManagers.splice(b$f._resourceManagers.indexOf(this),1),b$f._isResourceManagersSorted=!1;for(var b$M=this._resources.slice(0,this._resources.length),b$y=0;b$y<b$M.length;b$y++){var b$i=b$M[b$y];b$i.resourceManager.removeResource(b$i),b$i.destroy()}b$M.length=0},b$M.addSize=function(b$M){b$M&&(this.autoRelease&&0<b$M&&this._memorySize+b$M>this.autoReleaseMaxSize&&this.garbageCollection((1-this._garbageCollectionRate)*this.autoReleaseMaxSize),this._memorySize+=b$M)},b$M.addRecord=function(b$M,b$y,b$i){DEBUG&&b$i&&!b$M&&console.error(b$M,b$y,b$i),b$M&&(this._records.hasOwnProperty(b$y+"|"+b$M)||(this._records[b$y+"|"+b$M]=0),this._records[b$y+"|"+b$M]+=b$i,DEBUG&&this._records[b$y+"|"+b$M]<0&&console.error(b$M,b$y,this._records[b$y+"|"+b$M]))},b$M.garbageCollection=function(b$M){var b$y=this._resources;(b$y=b$y.slice()).sort(function(b$M,b$y){if(!b$M||!b$y)throw new Error("a或b不能为空！");return b$M.released&&b$y.released?0:b$M.released?1:b$y.released?-1:b$M._lastUseFrameCount-b$y._lastUseFrameCount});for(var b$i=b$N.loopCount,b$H=0,b$S=b$y.length;b$H<b$S;b$H++){var b$f=b$y[b$H];if(!(1<b$i-b$f._lastUseFrameCount))return void(this._memorySize>=b$M&&(this._isOverflow=!0));if(b$f.releaseResource(),this._memorySize<b$M)return void(this._isOverflow=!1)}},b$l(0,b$M,"id",function(){return this._id}),b$l(0,b$M,"name",function(){return this._name},function(b$M){!b$M&&""===b$M||this._name===b$M||(this._name=b$M,b$f._isResourceManagersSorted=!1)}),b$l(0,b$M,"memorySize",function(){return this._memorySize}),b$l(0,b$M,"records",function(){return this._records}),b$l(1,b$f,"systemResourceManager",function(){return b$f._systemResourceManager}),b$f.__init__=function(){b$f.currentResourceManager=b$f.systemResourceManager},b$f.getLoadedResourceManagerByIndex=function(b$M){return b$f._resourceManagers[b$M]},b$f.getLoadedResourceManagersCount=function(){return b$f._resourceManagers.length},b$f.recreateContentManagers=function(b$M){void 0===b$M&&(b$M=!1);for(var b$y=b$f.currentResourceManager,b$i=0;b$i<b$f._resourceManagers.length;b$i++){b$f.currentResourceManager=b$f._resourceManagers[b$i];for(var b$H=0;b$H<b$f.currentResourceManager._resources.length;b$H++)b$f.currentResourceManager._resources[b$H].releaseResource(b$M),b$f.currentResourceManager._resources[b$H].activeResource(b$M)}b$f.currentResourceManager=b$y},b$f.releaseContentManagers=function(b$M){void 0===b$M&&(b$M=!1);for(var b$y=b$f.currentResourceManager,b$i=0;b$i<b$f._resourceManagers.length;b$i++){b$f.currentResourceManager=b$f._resourceManagers[b$i];for(var b$H=0;b$H<b$f.currentResourceManager._resources.length;b$H++){var b$S=b$f.currentResourceManager._resources[b$H];!b$S.released&&b$S.releaseResource(b$M)}}b$f.currentResourceManager=b$y},b$f._uniqueIDCounter=0,b$f._isResourceManagersSorted=!1,b$f._resourceManagers=[],b$k(b$f,["_systemResourceManager",function(){return this._systemResourceManager=new b$f("System Resource Manager")},"currentResourceManager",function(){return this.currentResourceManager=b$f._systemResourceManager}]),b$f}(),b$u=(function(){function b$M(){}b$F(b$M,"laya.system.System"),b$M.changeDefinition=function(b$M,b$y){b$U[b$M]=b$y;var b$i=b$M+"=classObj";b$U._runScript(b$i)},b$M.__init__=function(){b$D.isConchApp&&(conch.disableConchResManager(),conch.disableConchAutoRestoreLostedDevice())}}(),function(){function b$i(){}return b$F(b$i,"laya.utils.Browser"),b$l(1,b$i,"pixelRatio",function(){return b$i.__init__(),-1<b$i.userAgent.indexOf("Mozilla/6.0(Linux; Android 6.0; HUAWEI NXT-AL10 Build/HUAWEINXT-AL10)")?2:b$T.getPixelRatio()}),b$l(1,b$i,"height",function(){return b$i.__init__(),(b$U.stage&&b$U.stage.canvasRotation?b$i.clientWidth:b$i.clientHeight)*b$i.pixelRatio}),b$l(1,b$i,"clientWidth",function(){return b$i.__init__(),b$i.window.innerWidth||b$i.document.body.clientWidth}),b$l(1,b$i,"window",function(){return b$i.__init__(),b$i._window}),b$l(1,b$i,"clientHeight",function(){return b$i.__init__(),b$i.window.innerHeight||b$i.document.body.clientHeight||b$i.document.documentElement.clientHeight}),b$l(1,b$i,"width",function(){return b$i.__init__(),(b$U.stage&&b$U.stage.canvasRotation?b$i.clientHeight:b$i.clientWidth)*b$i.pixelRatio}),b$l(1,b$i,"container",function(){return b$i.__init__(),b$i._container||((b$i._container=b$i.createElement("div")).id="layaContainer",b$i.document.body.appendChild(b$i._container)),b$i._container},function(b$M){b$i._container=b$M}),b$l(1,b$i,"document",function(){return b$i.__init__(),b$i._document}),b$i.__init__=function(){if(!b$i._window){b$i._window=b$T.getWindow(),b$i._document=b$i.window.document,b$i._window.addEventListener("message",function(b$M){laya.utils.Browser._onMessage(b$M)},!1),b$i.document.__createElement=b$i.document.createElement,b$V.requestAnimationFrame=b$V.requestAnimationFrame||b$V.webkitRequestAnimationFrame||b$V.mozRequestAnimationFrame||b$V.oRequestAnimationFrame||b$V.msRequestAnimationFrame||function(b$M){return b$V.setTimeout(b$M,1e3/60)};var b$M=b$V.document.body.style;b$M["-webkit-user-select"]="none",b$M["-webkit-tap-highlight-color"]="rgba(200,200,200,0)",b$i.userAgent=b$i.window.navigator.userAgent,b$i.onIOS=!!(b$i.u=b$i.userAgent).match(/\(i[^;]+;(U;)? CPU.+Mac OS X/),b$i.onMobile=-1<b$i.u.indexOf("Mobile"),b$i.onIPhone=-1<b$i.u.indexOf("iPhone"),b$i.onMac=-1<b$i.u.indexOf("Mac OS X"),b$i.onIPad=-1<b$i.u.indexOf("iPad"),b$i.onAndroid=-1<b$i.u.indexOf("Android")||-1<b$i.u.indexOf("Adr"),b$i.onWP=-1<b$i.u.indexOf("Windows Phone"),b$i.onQQBrowser=-1<b$i.u.indexOf("QQBrowser"),b$i.onMQQBrowser=-1<b$i.u.indexOf("MQQBrowser")||-1<b$i.u.indexOf("Mobile")&&-1<b$i.u.indexOf("QQ"),b$i.onIE=!!b$i.window.ActiveXObject||"ActiveXObject"in b$i.window,b$i.onWeiXin=-1<b$i.u.indexOf("MicroMessenger"),b$i.onPC=!b$i.onMobile,b$i.onSafari=-1<b$i.u.indexOf("Safari"),b$i.onFirefox=-1<b$i.u.indexOf("Firefox"),b$i.onEdge=-1<b$i.u.indexOf("Edge"),b$i.onMiniGame=-1<b$i.u.indexOf("MiniGame"),b$i.onLimixiu=-1<b$i.u.indexOf("limixiu"),b$i.httpProtocol="http:"==b$i.window.location.protocol,b$i.onMiniGame&&null==b$i.window.focus&&console.error("请先初始化小游戏适配库，详细教程https://ldc.layabox.com/doc/?nav=zh-ts-5-0-0"),b$i.webAudioEnabled=!!(b$i.window.AudioContext||b$i.window.webkitAudioContext||b$i.window.mozAudioContext),b$i.soundType=b$i.webAudioEnabled?"WEBAUDIOSOUND":"AUDIOSOUND",b$SM=b$i.webAudioEnabled?b$fM:b$iM,b$i.webAudioEnabled&&b$fM.initWebAudio(),b$iM._initMusicAudio(),b$i.enableTouch="ontouchstart"in b$V||b$V.DocumentTouch&&b$y instanceof DocumentTouch,b$V.focus(),b$a._soundClass=b$SM,b$a._musicClass=b$iM,b$D._mainCanvas=b$D._mainCanvas||b$RM.create("2D"),b$i.canvas||(b$i.canvas=b$RM.create("2D"),b$i.context=b$i.canvas.getContext("2d"))}},b$i._onMessage=function(b$M){if(b$M.data&&"size"==b$M.data.name){if(b$i.window.innerWidth=b$M.data.width,b$i.window.innerHeight=b$M.data.height,b$i.window.__innerHeight=b$M.data.clientHeight,!b$i.document.createEvent)return void console.warn("no document.createEvent");var b$y=b$i.document.createEvent("HTMLEvents");return b$y.initEvent("resize",!1,!1),void b$i.window.dispatchEvent(b$y)}},b$i.createElement=function(b$M){return b$i.__init__(),b$i.document.__createElement(b$M)},b$i.getElementById=function(b$M){return b$i.__init__(),b$i.document.getElementById(b$M)},b$i.removeElement=function(b$M){b$M&&b$M.parentNode&&b$M.parentNode.removeChild(b$M)},b$i.now=function(){return b$T.now()},b$i._window=null,b$i._document=null,b$i._container=null,b$i.userAgent=null,b$i.u=null,b$i.onIOS=!1,b$i.onMac=!1,b$i.onMobile=!1,b$i.onIPhone=!1,b$i.onIPad=!1,b$i.onAndroid=!1,b$i.onWP=!1,b$i.onQQBrowser=!1,b$i.onMQQBrowser=!1,b$i.onSafari=!1,b$i.onFirefox=!1,b$i.onEdge=!1,b$i.onIE=!1,b$i.onWeiXin=!1,b$i.onMiniGame=!1,b$i.onLimixiu=!1,b$i.onPC=!1,b$i.httpProtocol=!1,b$i.webAudioEnabled=!1,b$i.soundType=null,b$i.enableTouch=!1,b$i.canvas=null,b$i.context=null,b$i.__init$=function(){},b$i}()),b$p=function(){function b$y(b$M){this._xd_=!0,this._allocated_=8,this._pos_=0,this._length=0,b$M?(this._u8d_=new Uint8Array(b$M),this._d_=new DataView(this._u8d_.buffer),this._length=this._d_.byteLength):this.___resizeBuffer(this._allocated_)}b$F(b$y,"laya.utils.Byte");var b$M=b$y.prototype;return b$M.___resizeBuffer=function(b$y){try{var b$M=new Uint8Array(b$y);null!=this._u8d_&&(this._u8d_.length<=b$y?b$M.set(this._u8d_):b$M.set(this._u8d_.subarray(0,b$y))),this._u8d_=b$M,this._d_=new DataView(b$M.buffer)}catch(b$M){throw"___resizeBuffer err:"+b$y}},b$M.getString=function(){return this.rUTF(this.getUint16())},b$M.getFloat32Array=function(b$M,b$y){var b$i=b$M+b$y;b$i=b$i>this._length?this._length:b$i;var b$H=new Float32Array(this._d_.buffer.slice(b$M,b$i));return this._pos_=b$i,b$H},b$M.getUint8Array=function(b$M,b$y){var b$i=b$M+b$y;b$i=b$i>this._length?this._length:b$i;var b$H=new Uint8Array(this._d_.buffer.slice(b$M,b$i));return this._pos_=b$i,b$H},b$M.getInt16Array=function(b$M,b$y){var b$i=b$M+b$y;b$i=b$i>this._length?this._length:b$i;var b$H=new Int16Array(this._d_.buffer.slice(b$M,b$i));return this._pos_=b$i,b$H},b$M.getFloat32=function(){if(this._pos_+4>this._length)throw"getFloat32 error - Out of bounds";var b$M=this._d_.getFloat32(this._pos_,this._xd_);return this._pos_+=4,b$M},b$M.getFloat64=function(){if(this._pos_+8>this._length)throw"getFloat64 error - Out of bounds";var b$M=this._d_.getFloat64(this._pos_,this._xd_);return this._pos_+=8,b$M},b$M.writeFloat32=function(b$M){this.ensureWrite(this._pos_+4),this._d_.setFloat32(this._pos_,b$M,this._xd_),this._pos_+=4},b$M.writeFloat64=function(b$M){this.ensureWrite(this._pos_+8),this._d_.setFloat64(this._pos_,b$M,this._xd_),this._pos_+=8},b$M.getInt32=function(){if(this._pos_+4>this._length)throw"getInt32 error - Out of bounds";var b$M=this._d_.getInt32(this._pos_,this._xd_);return this._pos_+=4,b$M},b$M.getUint32=function(){if(this._pos_+4>this._length)throw"getUint32 error - Out of bounds";var b$M=this._d_.getUint32(this._pos_,this._xd_);return this._pos_+=4,b$M},b$M.writeInt32=function(b$M){this.ensureWrite(this._pos_+4),this._d_.setInt32(this._pos_,b$M,this._xd_),this._pos_+=4},b$M.writeUint32=function(b$M){this.ensureWrite(this._pos_+4),this._d_.setUint32(this._pos_,b$M,this._xd_),this._pos_+=4},b$M.getInt16=function(){if(this._pos_+2>this._length)throw"getInt16 error - Out of bounds";var b$M=this._d_.getInt16(this._pos_,this._xd_);return this._pos_+=2,b$M},b$M.getUint16=function(){if(this._pos_+2>this._length)throw"getUint16 error - Out of bounds";var b$M=this._d_.getUint16(this._pos_,this._xd_);return this._pos_+=2,b$M},b$M.writeUint16=function(b$M){this.ensureWrite(this._pos_+2),this._d_.setUint16(this._pos_,b$M,this._xd_),this._pos_+=2},b$M.writeInt16=function(b$M){this.ensureWrite(this._pos_+2),this._d_.setInt16(this._pos_,b$M,this._xd_),this._pos_+=2},b$M.getUint8=function(){if(this._pos_+1>this._length)throw"getUint8 error - Out of bounds";return this._d_.getUint8(this._pos_++)},b$M.writeUint8=function(b$M){this.ensureWrite(this._pos_+1),this._d_.setUint8(this._pos_,b$M),this._pos_++},b$M._getUInt8=function(b$M){return this._d_.getUint8(b$M)},b$M._getUint16=function(b$M){return this._d_.getUint16(b$M,this._xd_)},b$M._getMatrix=function(){return new b$m(this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32(),this.getFloat32())},b$M.rUTF=function(b$M){for(var b$y=[],b$i=this._pos_+b$M,b$H=0,b$S=0,b$f=0,b$V=String.fromCharCode,b$K=this._u8d_;this._pos_<b$i;)(b$H=b$K[this._pos_++])<128?0!=b$H&&b$y.push(b$V(b$H)):b$H<224?b$y.push(b$V((63&b$H)<<6|127&b$K[this._pos_++])):b$H<240?(b$S=b$K[this._pos_++],b$y.push(b$V((31&b$H)<<12|(127&b$S)<<6|127&b$K[this._pos_++]))):(b$S=b$K[this._pos_++],b$f=b$K[this._pos_++],b$y.push(b$V((15&b$H)<<18|(127&b$S)<<12|b$f<<6&127|127&b$K[this._pos_++]))),0;return b$y.join("")},b$M.getCustomString=function(b$M){for(var b$y=[],b$i=0,b$H=0,b$S=0,b$f=String.fromCharCode,b$V=this._u8d_;0<b$M;)if((b$H=b$V[this._pos_])<128)b$y.push(b$f(b$H)),this._pos_++,b$M--;else for(b$i=b$H-128,this._pos_++,b$M-=b$i;0<b$i;)b$H=b$V[this._pos_++],b$S=b$V[this._pos_++],b$y.push(b$f(b$S<<8|b$H)),b$i--;return b$y.join("")},b$M.clear=function(){this._pos_=0,this.length=0},b$M.__getBuffer=function(){return this._d_.buffer},b$M.writeUTFBytes=function(b$M){for(var b$y=0,b$i=(b$M+="").length;b$y<b$i;b$y++){var b$H=b$M.charCodeAt(b$y);b$H<=127?this.writeByte(b$H):b$H<=2047?(this.ensureWrite(this._pos_+2),this._u8d_.set([192|b$H>>6,128|63&b$H],this._pos_),this._pos_+=2):b$H<=65535?(this.ensureWrite(this._pos_+3),this._u8d_.set([224|b$H>>12,128|b$H>>6&63,128|63&b$H],this._pos_),this._pos_+=3):(this.ensureWrite(this._pos_+4),this._u8d_.set([240|b$H>>18,128|b$H>>12&63,128|b$H>>6&63,128|63&b$H],this._pos_),this._pos_+=4)}},b$M.writeUTFString=function(b$M){var b$y=this.pos;this.writeUint16(1),this.writeUTFBytes(b$M);var b$i=this.pos-b$y-2;if(65536<=b$i)throw"writeUTFString byte len more than 65536";this._d_.setUint16(b$y,b$i,this._xd_)},b$M.readUTFString=function(){return this.readUTFBytes(this.getUint16())},b$M.getUTFString=function(){return this.readUTFString()},b$M.readUTFBytes=function(b$M){if(void 0===b$M&&(b$M=-1),0==b$M)return"";var b$y=this.bytesAvailable;if(b$y<b$M)throw"readUTFBytes error - Out of bounds";return b$M=0<b$M?b$M:b$y,this.rUTF(b$M)},b$M.getUTFBytes=function(b$M){return void 0===b$M&&(b$M=-1),this.readUTFBytes(b$M)},b$M.writeByte=function(b$M){this.ensureWrite(this._pos_+1),this._d_.setInt8(this._pos_,b$M),this._pos_+=1},b$M.readByte=function(){if(this._pos_+1>this._length)throw"readByte error - Out of bounds";return this._d_.getInt8(this._pos_++)},b$M.getByte=function(){return this.readByte()},b$M.ensureWrite=function(b$M){this._length<b$M&&(this._length=b$M),this._allocated_<b$M&&(this.length=b$M)},b$M.writeArrayBuffer=function(b$M,b$y,b$i){if(void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),b$y<0||b$i<0)throw"writeArrayBuffer error - Out of bounds";0==b$i&&(b$i=b$M.byteLength-b$y),this.ensureWrite(this._pos_+b$i);var b$H=new Uint8Array(b$M);this._u8d_.set(b$H.subarray(b$y,b$y+b$i),this._pos_),this._pos_+=b$i},b$l(0,b$M,"buffer",function(){var b$M=this._d_.buffer;return b$M.byteLength==this.length?b$M:b$M.slice(0,this.length)}),b$l(0,b$M,"endian",function(){return this._xd_?"littleEndian":"bigEndian"},function(b$M){this._xd_="littleEndian"==b$M}),b$l(0,b$M,"length",function(){return this._length},function(b$M){this._allocated_<b$M?this.___resizeBuffer(this._allocated_=Math.floor(Math.max(b$M,2*this._allocated_))):this._allocated_>b$M&&this.___resizeBuffer(this._allocated_=b$M),this._length=b$M}),b$l(0,b$M,"pos",function(){return this._pos_},function(b$M){this._pos_=b$M}),b$l(0,b$M,"bytesAvailable",function(){return this._length-this._pos_}),b$y.getSystemEndian=function(){if(!b$y._sysEndian){var b$M=new ArrayBuffer(2);new DataView(b$M).setInt16(0,256,!0),b$y._sysEndian=256===new Int16Array(b$M)[0]?"littleEndian":"bigEndian"}return b$y._sysEndian},b$y.BIG_ENDIAN="bigEndian",b$y.LITTLE_ENDIAN="littleEndian",b$y._sysEndian=null,b$y}(),b$B=function(){function b$S(){}return b$F(b$S,"laya.utils.CacheManager"),b$S.regCacheByFunction=function(b$M,b$y){var b$i;b$S.unRegCacheByFunction(b$M,b$y),b$i={tryDispose:b$M,getCacheList:b$y},b$S._cacheList.push(b$i)},b$S.unRegCacheByFunction=function(b$M,b$y){var b$i,b$H=0;for(b$i=b$S._cacheList.length,b$H=0;b$H<b$i;b$H++)if(b$S._cacheList[b$H].tryDispose==b$M&&b$S._cacheList[b$H].getCacheList==b$y)return void b$S._cacheList.splice(b$H,1)},b$S.forceDispose=function(){var b$M=0,b$y=b$S._cacheList.length;for(b$M=0;b$M<b$y;b$M++)b$S._cacheList[b$M].tryDispose(!0)},b$S.beginCheck=function(b$M){void 0===b$M&&(b$M=15e3),b$U.timer.loop(b$M,null,b$S._checkLoop)},b$S.stopCheck=function(){b$U.timer.clear(null,b$S._checkLoop)},b$S._checkLoop=function(){var b$M=b$S._cacheList;if(!(b$M.length<1)){var b$y,b$i=b$u.now(),b$H=0;for(b$y=b$H=b$M.length;0<b$H&&(b$M[b$S._index=++b$S._index%b$y].tryDispose(!1),!(b$u.now()-b$i>b$S.loopTimeLimit));)b$H--}},b$S.loopTimeLimit=2,b$S._cacheList=[],b$S._index=0,b$S}(),b$Z=function(){function b$P(){}return b$F(b$P,"laya.utils.ClassUtils"),b$P.regClass=function(b$M,b$y){b$P._classMap[b$M]=b$y},b$P.getRegClass=function(b$M){return b$P._classMap[b$M]},b$P.getInstance=function(b$M){var b$y=b$P.getClass(b$M);return b$y?new b$y:(console.warn("[error] Undefined class:",b$M),null)},b$P.createByJson=function(b$M,b$y,b$i,b$H,b$S){"string"==typeof b$M&&(b$M=JSON.parse(b$M));var b$f=b$M.props;if(!b$y&&!(b$y=b$S?b$S.runWith(b$M):b$P.getInstance(b$f.runtime||b$M.type)))return null;var b$V=b$M.child;if(b$V)for(var b$K=0,b$k=b$V.length;b$K<b$k;b$K++){var b$X=b$V[b$K];if("render"!==b$X.props.name&&"render"!==b$X.props.renderType||!b$y._$set_itemRender)if("Graphic"==b$X.type)b$P.addGraphicsToSprite(b$X,b$y);else if(b$P.isDrawType(b$X.type))b$P.addGraphicToSprite(b$X,b$y,!0);else{var b$F=b$P.createByJson(b$X,null,b$i,b$H,b$S);"Script"==b$X.type?b$F.hasOwnProperty("owner")?b$F.owner=b$y:b$F.hasOwnProperty("target")&&(b$F.target=b$y):"mask"==b$X.props.renderType?b$y.mask=b$F:b$y.addChild(b$F)}else b$y.itemRender=b$X}if(b$f)for(var b$o in b$f){var b$d=b$f[b$o];"var"===b$o&&b$i?b$i[b$d]=b$y:b$d instanceof Array&&"function"==typeof b$y[b$o]?b$y[b$o].apply(b$y,b$d):b$y[b$o]=b$d}return b$H&&b$M.customProps&&b$H.runWith([b$y,b$M]),b$y.created&&b$y.created(),b$y},b$P.addGraphicsToSprite=function(b$M,b$y){var b$i;if((b$i=b$M.child)&&!(b$i.length<1)){var b$H;b$H=b$P._getGraphicsFromSprite(b$M,b$y);var b$S=0,b$f=0;b$M.props&&(b$S=b$P._getObjVar(b$M.props,"x",0),b$f=b$P._getObjVar(b$M.props,"y",0)),0!=b$S&&0!=b$f&&b$H.translate(b$S,b$f);var b$V,b$K=0;for(b$V=b$i.length,b$K=0;b$K<b$V;b$K++)b$P._addGraphicToGraphics(b$i[b$K],b$H);0!=b$S&&0!=b$f&&b$H.translate(-b$S,-b$f)}},b$P.addGraphicToSprite=function(b$M,b$y,b$i){var b$H;void 0===b$i&&(b$i=!1),b$H=b$i?b$P._getGraphicsFromSprite(b$M,b$y):b$y.graphics,b$P._addGraphicToGraphics(b$M,b$H)},b$P._getGraphicsFromSprite=function(b$M,b$y){var b$i,b$H;if(!b$M||!b$M.props)return b$y.graphics;switch(b$H=b$M.props.renderType){case"hit":case"unHit":var b$S;b$y.hitArea||(b$y.hitArea=new b$Y),(b$S=b$y.hitArea)[b$H]||(b$S[b$H]=new b$d),b$i=b$S[b$H]}return b$i||(b$i=b$y.graphics),b$i},b$P._getTransformData=function(b$M){var b$y;(b$M.hasOwnProperty("pivotX")||b$M.hasOwnProperty("pivotY"))&&(b$y=b$y||new b$m).translate(-b$P._getObjVar(b$M,"pivotX",0),-b$P._getObjVar(b$M,"pivotY",0));var b$i=b$P._getObjVar(b$M,"scaleX",1),b$H=b$P._getObjVar(b$M,"scaleY",1),b$S=b$P._getObjVar(b$M,"rotation",0);b$P._getObjVar(b$M,"skewX",0),b$P._getObjVar(b$M,"skewY",0);return 1==b$i&&1==b$H&&0==b$S||((b$y=b$y||new b$m).scale(b$i,b$H),b$y.rotate(.0174532922222222*b$S)),b$y},b$P._addGraphicToGraphics=function(b$M,b$y){var b$i,b$H;if((b$i=b$M.props)&&(b$H=b$P.DrawTypeDic[b$M.type])){var b$S,b$f;b$S=b$y;var b$V=b$P._getParams(b$i,b$H[1],b$H[2],b$H[3]);((b$f=b$P._tM)||1!=b$P._alpha)&&(b$S.save(),b$f&&b$S.transform(b$f),1!=b$P._alpha&&b$S.alpha(b$P._alpha)),b$S[b$H[0]].apply(b$S,b$V),(b$f||1!=b$P._alpha)&&b$S.restore()}},b$P._adptLineData=function(b$M){return b$M[2]=parseFloat(b$M[0])+parseFloat(b$M[2]),b$M[3]=parseFloat(b$M[1])+parseFloat(b$M[3]),b$M},b$P._adptTextureData=function(b$M){return b$M[0]=b$KM.getRes(b$M[0]),b$M},b$P._adptLinesData=function(b$M){return b$M[2]=b$P._getPointListByStr(b$M[2]),b$M},b$P.isDrawType=function(b$M){return"Image"!=b$M&&b$P.DrawTypeDic.hasOwnProperty(b$M)},b$P._getParams=function(b$M,b$y,b$i,b$H){var b$S;void 0===b$i&&(b$i=0),(b$S=b$P._temParam).length=b$y.length;var b$f,b$V,b$K=0;for(b$f=b$y.length,b$K=0;b$K<b$f;b$K++)b$S[b$K]=b$P._getObjVar(b$M,b$y[b$K][0],b$y[b$K][1]);return b$P._alpha=b$P._getObjVar(b$M,"alpha",1),b$V=b$P._getTransformData(b$M),b$P._tM=b$V?(b$i||(b$i=0),b$V.translate(b$S[b$i],b$S[b$i+1]),b$S[b$i]=b$S[b$i+1]=0,b$V):null,b$H&&b$P[b$H]&&(b$S=b$P[b$H](b$S)),b$S},b$P._getPointListByStr=function(b$M){var b$y,b$i,b$H=0;for(b$i=(b$y=b$M.split(",")).length,b$H=0;b$H<b$i;b$H++)b$y[b$H]=parseFloat(b$y[b$H]);return b$y},b$P._getObjVar=function(b$M,b$y,b$i){return b$M.hasOwnProperty(b$y)?b$M[b$y]:b$i},b$P._temParam=[],b$P._classMap={Sprite:"laya.display.Sprite",Text:"laya.display.Text",Animation:"laya.display.Animation",Skeleton:"laya.ani.bone.Skeleton",Particle2D:"laya.particle.Particle2D",div:"laya.html.dom.HTMLDivElement",p:"laya.html.dom.HTMLElement",img:"laya.html.dom.HTMLImageElement",span:"laya.html.dom.HTMLElement",br:"laya.html.dom.HTMLBrElement",style:"laya.html.dom.HTMLStyleElement",font:"laya.html.dom.HTMLElement",a:"laya.html.dom.HTMLElement","#text":"laya.html.dom.HTMLElement"},b$P.getClass=function(b$M){var b$y=b$P._classMap[b$M]||b$M;return"string"==typeof b$y?b$U.__classmap[b$y]:b$y},b$P._tM=null,b$P._alpha=NaN,b$k(b$P,["DrawTypeDic",function(){return this.DrawTypeDic={Rect:["drawRect",[["x",0],["y",0],["width",0],["height",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Circle:["drawCircle",[["x",0],["y",0],["radius",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Pie:["drawPie",[["x",0],["y",0],["radius",0],["startAngle",0],["endAngle",0],["fillColor",null],["lineColor",null],["lineWidth",1]]],Image:["drawTexture",[["x",0],["y",0],["width",0],["height",0]]],Texture:["drawTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0]],1,"_adptTextureData"],FillTexture:["fillTexture",[["skin",null],["x",0],["y",0],["width",0],["height",0],["repeat",null]],1,"_adptTextureData"],FillText:["fillText",[["text",""],["x",0],["y",0],["font",null],["color",null],["textAlign",null]],1],Line:["drawLine",[["x",0],["y",0],["toX",0],["toY",0],["lineColor",null],["lineWidth",0]],0,"_adptLineData"],Lines:["drawLines",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Curves:["drawCurves",[["x",0],["y",0],["points",""],["lineColor",null],["lineWidth",0]],0,"_adptLinesData"],Poly:["drawPoly",[["x",0],["y",0],["points",""],["fillColor",null],["lineColor",null],["lineWidth",1]],0,"_adptLinesData"]}}]),b$P}(),b$E=function(){function b$f(b$M){if(this._color=[],"string"==typeof b$M){null===(this.strColor=b$M)&&(b$M="#000000"),"#"==b$M.charAt(0)&&(b$M=b$M.substr(1));var b$y=b$M.length;if(3==b$y||4==b$y){for(var b$i="",b$H=0;b$H<b$y;b$H++)b$i+=b$M[b$H]+b$M[b$H];b$M=b$i}var b$S=this.numColor=parseInt(b$M,16);if(8==b$M.length)return void(this._color=[parseInt(b$M.substr(0,2),16)/255,((16711680&b$S)>>16)/255,((65280&b$S)>>8)/255,(255&b$S)/255])}else b$S=this.numColor=b$M,this.strColor=b$g.toHexColor(b$S);this._color=[((16711680&b$S)>>16)/255,((65280&b$S)>>8)/255,(255&b$S)/255,1],this._color.__id=++b$f._COLODID}return b$F(b$f,"laya.utils.Color"),b$f._initDefault=function(){for(var b$M in b$f._DEFAULT={},b$f._COLOR_MAP)b$f._SAVE[b$M]=b$f._DEFAULT[b$M]=new b$f(b$f._COLOR_MAP[b$M]);return b$f._DEFAULT},b$f._initSaveMap=function(){for(var b$M in b$f._SAVE_SIZE=0,b$f._SAVE={},b$f._DEFAULT)b$f._SAVE[b$M]=b$f._DEFAULT[b$M]},b$f.create=function(b$M){var b$y=b$f._SAVE[b$M+""];return null!=b$y?b$y:(b$f._SAVE_SIZE<1e3||b$f._initSaveMap(),b$f._SAVE[b$M+""]=new b$f(b$M))},b$f._SAVE={},b$f._SAVE_SIZE=0,b$f._COLOR_MAP={white:"#FFFFFF",red:"#FF0000",green:"#00FF00",blue:"#0000FF",black:"#000000",yellow:"#FFFF00",gray:"#AAAAAA"},b$f._DEFAULT=b$f._initDefault(),b$f._COLODID=1,b$f}(),b$_=(function(){function b$M(){this._values=[],this._keys=[]}b$F(b$M,"laya.utils.Dictionary");var b$y=b$M.prototype;b$y.set=function(b$M,b$y){var b$i=this.indexOf(b$M);0<=b$i?this._values[b$i]=b$y:(this._keys.push(b$M),this._values.push(b$y))},b$y.indexOf=function(b$M){var b$y=this._keys.indexOf(b$M);return 0<=b$y?b$y:(b$M="string"==typeof b$M?Number(b$M):"number"==typeof b$M?b$M.toString():b$M,this._keys.indexOf(b$M))},b$y.get=function(b$M){var b$y=this.indexOf(b$M);return b$y<0?null:this._values[b$y]},b$y.remove=function(b$M){var b$y=this.indexOf(b$M);return 0<=b$y&&(this._keys.splice(b$y,1),this._values.splice(b$y,1),!0)},b$y.clear=function(){this._values.length=0,this._keys.length=0},b$l(0,b$y,"values",function(){return this._values}),b$l(0,b$y,"keys",function(){return this._keys})}(),function(){function b$M(){this.ratio=.92,this.maxOffset=60,this._dragging=!1,this._clickOnly=!0}b$F(b$M,"laya.utils.Dragging");var b$y=b$M.prototype;return b$y.start=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){void 0===b$K&&(b$K=.92),this.clearTimer(),this.target=b$M,this.area=b$y,this.hasInertia=b$i,this.elasticDistance=b$y?b$H:0,this.elasticBackTime=b$S,this.data=b$f,this._disableMouseEvent=b$V,this.ratio=b$K,1!=b$M.globalScaleX||1!=b$M.globalScaleY?this._parent=b$M.parent:this._parent=b$U.stage,this._clickOnly=!0,this._dragging=!0,this._elasticRateX=this._elasticRateY=1,this._lastX=this._parent.mouseX,this._lastY=this._parent.mouseY,b$U.stage.on("mouseup",this,this.onStageMouseUp),b$U.stage.on("mouseout",this,this.onStageMouseUp),b$U.timer.frameLoop(1,this,this.loop)},b$y.clearTimer=function(){b$U.timer.clear(this,this.loop),b$U.timer.clear(this,this.tweenMove),this._tween&&(this._tween.recover(),this._tween=null)},b$y.stop=function(){this._dragging&&(b$J.instance.disableMouseEvent=!1,b$U.stage.off("mouseup",this,this.onStageMouseUp),b$U.stage.off("mouseout",this,this.onStageMouseUp),this._dragging=!1,this.target&&this.area&&this.backToArea(),this.clear())},b$y.loop=function(){var b$M=this._parent.getMousePoint(),b$y=b$M.x,b$i=b$M.y,b$H=b$y-this._lastX,b$S=b$i-this._lastY;if(this._clickOnly){if(!(1<Math.abs(b$H*b$U.stage._canvasTransform.getScaleX())||1<Math.abs(b$S*b$U.stage._canvasTransform.getScaleY())))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this.target.event("dragstart",this.data),b$J.instance.disableMouseEvent=this._disableMouseEvent,this.target._set$P("$_MOUSEDOWN",!1)}else this._offsets.push(b$H,b$S);0==b$H&&0==b$S||(this._lastX=b$y,this._lastY=b$i,this.target.x+=b$H*this._elasticRateX,this.target.y+=b$S*this._elasticRateY,this.area&&this.checkArea(),this.target.event("dragmove",this.data))},b$y.checkArea=function(){if(this.elasticDistance<=0)this.backToArea();else{if(this.target.x<this.area.x)var b$M=this.area.x-this.target.x;else b$M=this.target.x>this.area.x+this.area.width?this.target.x-this.area.x-this.area.width:0;if(this._elasticRateX=Math.max(0,1-b$M/this.elasticDistance),this.target.y<this.area.y)var b$y=this.area.y-this.target.y;else b$y=this.target.y>this.area.y+this.area.height?this.target.y-this.area.y-this.area.height:0;this._elasticRateY=Math.max(0,1-b$y/this.elasticDistance)}},b$y.backToArea=function(){this.target.x=Math.min(Math.max(this.target.x,this.area.x),this.area.x+this.area.width),this.target.y=Math.min(Math.max(this.target.y,this.area.y),this.area.y+this.area.height)},b$y.onStageMouseUp=function(b$M){if(b$J.instance.disableMouseEvent=!1,b$U.stage.off("mouseup",this,this.onStageMouseUp),b$U.stage.off("mouseout",this,this.onStageMouseUp),b$U.timer.clear(this,this.loop),!this._clickOnly&&this.target)if(this.hasInertia){this._offsets.length<1&&this._offsets.push(this._parent.mouseX-this._lastX,this._parent.mouseY-this._lastY),this._offsetX=this._offsetY=0;for(var b$y=this._offsets.length,b$i=Math.min(b$y,6),b$H=this._offsets.length-b$i,b$S=b$y-1;b$H<b$S;b$S--)this._offsetY+=this._offsets[b$S--],this._offsetX+=this._offsets[b$S];this._offsetX=this._offsetX/b$i*2,this._offsetY=this._offsetY/b$i*2,Math.abs(this._offsetX)>this.maxOffset&&(this._offsetX=0<this._offsetX?this.maxOffset:-this.maxOffset),Math.abs(this._offsetY)>this.maxOffset&&(this._offsetY=0<this._offsetY?this.maxOffset:-this.maxOffset),b$U.timer.frameLoop(1,this,this.tweenMove)}else 0<this.elasticDistance?this.checkElastic():this.clear()},b$y.checkElastic=function(){var b$M=NaN,b$y=NaN;if(this.target.x<this.area.x?b$M=this.area.x:this.target.x>this.area.x+this.area.width&&(b$M=this.area.x+this.area.width),this.target.y<this.area.y?b$y=this.area.y:this.target.y>this.area.y+this.area.height&&(b$y=this.area.y+this.area.height),isNaN(b$M)&&isNaN(b$y))this.clear();else{var b$i={};isNaN(b$M)||(b$i.x=b$M),isNaN(b$y)||(b$i.y=b$y),this._tween=b$x.to(this.target,b$i,this.elasticBackTime,b$b.sineOut,b$v.create(this,this.clear),0,!1,!1)}},b$y.tweenMove=function(){this._offsetX*=this.ratio*this._elasticRateX,this._offsetY*=this.ratio*this._elasticRateY,this.target.x+=this._offsetX,this.target.y+=this._offsetY,this.area&&this.checkArea(),this.target.event("dragmove",this.data),(Math.abs(this._offsetX)<1&&Math.abs(this._offsetY)<1||this._elasticRateX<.5||this._elasticRateY<.5)&&(b$U.timer.clear(this,this.tweenMove),0<this.elasticDistance?this.checkElastic():this.clear())},b$y.clear=function(){if(this.target){this.clearTimer();var b$M=this.target;this.target=null,this._parent=null,b$M.event("dragend",this.data)}},b$M}()),b$b=function(){function b$K(){}return b$F(b$K,"laya.utils.Ease"),b$K.linearNone=function(b$M,b$y,b$i,b$H){return b$i*b$M/b$H+b$y},b$K.linearIn=function(b$M,b$y,b$i,b$H){return b$i*b$M/b$H+b$y},b$K.linearInOut=function(b$M,b$y,b$i,b$H){return b$i*b$M/b$H+b$y},b$K.linearOut=function(b$M,b$y,b$i,b$H){return b$i*b$M/b$H+b$y},b$K.bounceIn=function(b$M,b$y,b$i,b$H){return b$i-b$K.bounceOut(b$H-b$M,0,b$i,b$H)+b$y},b$K.bounceInOut=function(b$M,b$y,b$i,b$H){return b$M<.5*b$H?.5*b$K.bounceIn(2*b$M,0,b$i,b$H)+b$y:.5*b$K.bounceOut(2*b$M-b$H,0,b$i,b$H)+.5*b$i+b$y},b$K.bounceOut=function(b$M,b$y,b$i,b$H){return(b$M/=b$H)<1/2.75?b$i*(7.5625*b$M*b$M)+b$y:b$M<2/2.75?b$i*(7.5625*(b$M-=1.5/2.75)*b$M+.75)+b$y:b$M<2.5/2.75?b$i*(7.5625*(b$M-=2.25/2.75)*b$M+.9375)+b$y:b$i*(7.5625*(b$M-=2.625/2.75)*b$M+.984375)+b$y},b$K.backIn=function(b$M,b$y,b$i,b$H,b$S){return void 0===b$S&&(b$S=1.70158),b$i*(b$M/=b$H)*b$M*((b$S+1)*b$M-b$S)+b$y},b$K.backInOut=function(b$M,b$y,b$i,b$H,b$S){return void 0===b$S&&(b$S=1.70158),(b$M/=.5*b$H)<1?.5*b$i*(b$M*b$M*((1+(b$S*=1.525))*b$M-b$S))+b$y:b$i/2*((b$M-=2)*b$M*((1+(b$S*=1.525))*b$M+b$S)+2)+b$y},b$K.backOut=function(b$M,b$y,b$i,b$H,b$S){return void 0===b$S&&(b$S=1.70158),b$i*((b$M=b$M/b$H-1)*b$M*((b$S+1)*b$M+b$S)+1)+b$y},b$K.elasticIn=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V;return void 0===b$S&&(b$S=0),void 0===b$f&&(b$f=0),0==b$M?b$y:1==(b$M/=b$H)?b$y+b$i:(b$f||(b$f=.3*b$H),b$V=!b$S||0<b$i&&b$S<b$i||b$i<0&&b$S<-b$i?(b$S=b$i,b$f/4):b$f/b$K.PI2*Math.asin(b$i/b$S),-b$S*Math.pow(2,10*(b$M-=1))*Math.sin((b$M*b$H-b$V)*b$K.PI2/b$f)+b$y)},b$K.elasticInOut=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V;return void 0===b$S&&(b$S=0),void 0===b$f&&(b$f=0),0==b$M?b$y:2==(b$M/=.5*b$H)?b$y+b$i:(b$f||(b$f=b$H*(.3*1.5)),b$V=!b$S||0<b$i&&b$S<b$i||b$i<0&&b$S<-b$i?(b$S=b$i,b$f/4):b$f/b$K.PI2*Math.asin(b$i/b$S),b$M<1?b$S*Math.pow(2,10*(b$M-=1))*Math.sin((b$M*b$H-b$V)*b$K.PI2/b$f)*-.5+b$y:b$S*Math.pow(2,-10*(b$M-=1))*Math.sin((b$M*b$H-b$V)*b$K.PI2/b$f)*.5+b$i+b$y)},b$K.elasticOut=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V;return void 0===b$S&&(b$S=0),void 0===b$f&&(b$f=0),0==b$M?b$y:1==(b$M/=b$H)?b$y+b$i:(b$f||(b$f=.3*b$H),b$V=!b$S||0<b$i&&b$S<b$i||b$i<0&&b$S<-b$i?(b$S=b$i,b$f/4):b$f/b$K.PI2*Math.asin(b$i/b$S),b$S*Math.pow(2,-10*b$M)*Math.sin((b$M*b$H-b$V)*b$K.PI2/b$f)+b$i+b$y)},b$K.strongIn=function(b$M,b$y,b$i,b$H){return b$i*(b$M/=b$H)*b$M*b$M*b$M*b$M+b$y},b$K.strongInOut=function(b$M,b$y,b$i,b$H){return(b$M/=.5*b$H)<1?.5*b$i*b$M*b$M*b$M*b$M*b$M+b$y:.5*b$i*((b$M-=2)*b$M*b$M*b$M*b$M+2)+b$y},b$K.strongOut=function(b$M,b$y,b$i,b$H){return b$i*((b$M=b$M/b$H-1)*b$M*b$M*b$M*b$M+1)+b$y},b$K.sineInOut=function(b$M,b$y,b$i,b$H){return.5*-b$i*(Math.cos(Math.PI*b$M/b$H)-1)+b$y},b$K.sineIn=function(b$M,b$y,b$i,b$H){return-b$i*Math.cos(b$M/b$H*b$K.HALF_PI)+b$i+b$y},b$K.sineOut=function(b$M,b$y,b$i,b$H){return b$i*Math.sin(b$M/b$H*b$K.HALF_PI)+b$y},b$K.quintIn=function(b$M,b$y,b$i,b$H){return b$i*(b$M/=b$H)*b$M*b$M*b$M*b$M+b$y},b$K.quintInOut=function(b$M,b$y,b$i,b$H){return(b$M/=.5*b$H)<1?.5*b$i*b$M*b$M*b$M*b$M*b$M+b$y:.5*b$i*((b$M-=2)*b$M*b$M*b$M*b$M+2)+b$y},b$K.quintOut=function(b$M,b$y,b$i,b$H){return b$i*((b$M=b$M/b$H-1)*b$M*b$M*b$M*b$M+1)+b$y},b$K.quartIn=function(b$M,b$y,b$i,b$H){return b$i*(b$M/=b$H)*b$M*b$M*b$M+b$y},b$K.quartInOut=function(b$M,b$y,b$i,b$H){return(b$M/=.5*b$H)<1?.5*b$i*b$M*b$M*b$M*b$M+b$y:.5*-b$i*((b$M-=2)*b$M*b$M*b$M-2)+b$y},b$K.quartOut=function(b$M,b$y,b$i,b$H){return-b$i*((b$M=b$M/b$H-1)*b$M*b$M*b$M-1)+b$y},b$K.cubicIn=function(b$M,b$y,b$i,b$H){return b$i*(b$M/=b$H)*b$M*b$M+b$y},b$K.cubicInOut=function(b$M,b$y,b$i,b$H){return(b$M/=.5*b$H)<1?.5*b$i*b$M*b$M*b$M+b$y:.5*b$i*((b$M-=2)*b$M*b$M+2)+b$y},b$K.cubicOut=function(b$M,b$y,b$i,b$H){return b$i*((b$M=b$M/b$H-1)*b$M*b$M+1)+b$y},b$K.quadIn=function(b$M,b$y,b$i,b$H){return b$i*(b$M/=b$H)*b$M+b$y},b$K.quadInOut=function(b$M,b$y,b$i,b$H){return(b$M/=.5*b$H)<1?.5*b$i*b$M*b$M+b$y:.5*-b$i*(--b$M*(b$M-2)-1)+b$y},b$K.quadOut=function(b$M,b$y,b$i,b$H){return-b$i*(b$M/=b$H)*(b$M-2)+b$y},b$K.expoIn=function(b$M,b$y,b$i,b$H){return 0==b$M?b$y:b$i*Math.pow(2,10*(b$M/b$H-1))+b$y-.001*b$i},b$K.expoInOut=function(b$M,b$y,b$i,b$H){return 0==b$M?b$y:b$M==b$H?b$y+b$i:(b$M/=.5*b$H)<1?.5*b$i*Math.pow(2,10*(b$M-1))+b$y:.5*b$i*(2-Math.pow(2,-10*--b$M))+b$y},b$K.expoOut=function(b$M,b$y,b$i,b$H){return b$M==b$H?b$y+b$i:b$i*(1-Math.pow(2,-10*b$M/b$H))+b$y},b$K.circIn=function(b$M,b$y,b$i,b$H){return-b$i*(Math.sqrt(1-(b$M/=b$H)*b$M)-1)+b$y},b$K.circInOut=function(b$M,b$y,b$i,b$H){return(b$M/=.5*b$H)<1?.5*-b$i*(Math.sqrt(1-b$M*b$M)-1)+b$y:.5*b$i*(Math.sqrt(1-(b$M-=2)*b$M)+1)+b$y},b$K.circOut=function(b$M,b$y,b$i,b$H){return b$i*Math.sqrt(1-(b$M=b$M/b$H-1)*b$M)+b$y},b$K.HALF_PI=.5*Math.PI,b$K.PI2=2*Math.PI,b$K}(),b$Y=function(){function b$o(){this._hit=null,this._unHit=null}b$F(b$o,"laya.utils.HitArea");var b$M=b$o.prototype;return b$M.isHit=function(b$M,b$y){return!!b$o.isHitGraphic(b$M,b$y,this.hit)&&!b$o.isHitGraphic(b$M,b$y,this.unHit)},b$M.contains=function(b$M,b$y){return this.isHit(b$M,b$y)},b$l(0,b$M,"hit",function(){return this._hit||(this._hit=new b$d),this._hit},function(b$M){this._hit=b$M}),b$l(0,b$M,"unHit",function(){return this._unHit||(this._unHit=new b$d),this._unHit},function(b$M){this._unHit=b$M}),b$o.isHitGraphic=function(b$M,b$y,b$i){if(!b$i)return!1;var b$H;if(!(b$H=b$i.cmds)&&b$i._one&&((b$H=b$o._cmds).length=1,b$H[0]=b$i._one),!b$H)return!1;var b$S,b$f,b$V=0;for(b$S=b$H.length,b$V=0;b$V<b$S;b$V++)if(b$f=b$H[b$V]){var b$K=b$D._context;switch(b$f.callee){case b$K._translate:case 6:b$M-=b$f[0],b$y-=b$f[1]}if(b$o.isHitCmd(b$M,b$y,b$f))return!0}return!1},b$o.isHitCmd=function(b$M,b$y,b$i){if(!b$i)return!1;var b$H=b$D._context,b$S=!1;switch(b$i.callee){case b$H._drawRect:case 13:b$o._rec.setTo(b$i[0],b$i[1],b$i[2],b$i[3]),b$S=b$o._rec.contains(b$M,b$y);break;case b$H._drawCircle:case b$H._fillCircle:case 14:b$S=(b$M-=b$i[0])*b$M+(b$y-=b$i[1])*b$y<b$i[2]*b$i[2];break;case b$H._drawPoly:case 18:b$M-=b$i[0],b$y-=b$i[1],b$S=b$o.ptInPolygon(b$M,b$y,b$i[2])}return b$S},b$o.ptInPolygon=function(b$M,b$y,b$i){var b$H;(b$H=b$o._ptPoint).setTo(b$M,b$y);var b$S,b$f=0,b$V=NaN,b$K=NaN,b$k=NaN,b$X=NaN;b$S=b$i.length;for(var b$F=0;b$F<b$S;b$F+=2){if(b$V=b$i[b$F],b$K=b$i[b$F+1],b$k=b$i[(b$F+2)%b$S],b$K!=(b$X=b$i[(b$F+3)%b$S]))if(!(b$H.y<Math.min(b$K,b$X)))if(!(b$H.y>=Math.max(b$K,b$X)))(b$H.y-b$K)*(b$k-b$V)/(b$X-b$K)+b$V>b$H.x&&b$f++}return b$f%2==1},b$o._cmds=[],b$k(b$o,["_rec",function(){return this._rec=new b$W},"_ptPoint",function(){return this._ptPoint=new b$Q}]),b$o}(),b$r=(function(){function b$S(b$M,b$y,b$i,b$H){this.char=b$M,this.charNum=b$M.charCodeAt(0),this._x=this._y=0,this.width=b$y,this.height=b$i,this.style=b$H,this.isWord=!b$S._isWordRegExp.test(b$M)}b$F(b$S,"laya.utils.HTMLChar");var b$M=b$S.prototype;b$U.imps(b$M,{"laya.display.ILayout":!0}),b$M.setSprite=function(b$M){this._sprite=b$M},b$M.getSprite=function(){return this._sprite},b$M._isChar=function(){return!0},b$M._getCSSStyle=function(){return this.style},b$l(0,b$M,"width",function(){return this._w},function(b$M){this._w=b$M}),b$l(0,b$M,"x",function(){return this._x},function(b$M){this._sprite&&(this._sprite.x=b$M),this._x=b$M}),b$l(0,b$M,"y",function(){return this._y},function(b$M){this._sprite&&(this._sprite.y=b$M),this._y=b$M}),b$l(0,b$M,"height",function(){return this._h},function(b$M){this._h=b$M}),b$S._isWordRegExp=new RegExp("[\\w.]","")}(),function(){function b$y(){}b$F(b$y,"laya.utils.Log"),b$y.enable=function(){b$y._logdiv||(b$y._logdiv=b$u.window.document.createElement("div"),b$u.window.document.body.appendChild(b$y._logdiv),b$y._logdiv.style.cssText="pointer-events:none;border:white;overflow:hidden;z-index:1000000;background:rgba(100,100,100,0.6);color:white;position: absolute;left:0px;top:0px;width:50%;height:50%;")},b$y.toggle=function(){var b$M=b$y._logdiv.style;"1px"==b$M.width?b$M.width=b$M.height="50%":b$M.width=b$M.height="1px"},b$y.print=function(b$M){b$y._logdiv&&(b$y.maxCount<=b$y._count&&b$y.clear(),b$y._count++,b$y._logdiv.innerText+=b$M+"\n",b$y._logdiv.scrollTop=b$y._logdiv.scrollHeight)},b$y.clear=function(){b$y._logdiv.innerText="",b$y._count=0},b$y._logdiv=null,b$y._count=0,b$y.maxCount=20}(),function(){function b$y(){}b$F(b$y,"laya.utils.Mouse"),b$l(1,b$y,"cursor",function(){return b$y._style.cursor},function(b$M){b$y._style.cursor=b$M}),b$y.hide=function(){"none"!=b$y.cursor&&(b$y._preCursor=b$y.cursor,b$y.cursor="none")},b$y.show=function(){"none"==b$y.cursor&&(b$y.cursor=b$y._preCursor?b$y._preCursor:"auto")},b$y._preCursor=null,b$k(b$y,["_style",function(){return this._style=b$u.document.body.style}])}(),function(){function b$f(){}return b$F(b$f,"laya.utils.Pool"),b$f.getPoolBySign=function(b$M){return b$f._poolDic[b$M]||(b$f._poolDic[b$M]=[])},b$f.clearBySign=function(b$M){b$f._poolDic[b$M]&&(b$f._poolDic[b$M].length=0)},b$f.recover=function(b$M,b$y){b$y.__InPool||(b$y.__InPool=!0,b$f.getPoolBySign(b$M).push(b$y))},b$f.getItemByClass=function(b$M,b$y){var b$i=b$f.getPoolBySign(b$M),b$H=b$i.length?b$i.pop():new b$y;return b$H.__InPool=!1,b$H},b$f.getItemByCreateFun=function(b$M,b$y,b$i){var b$H=b$f.getPoolBySign(b$M),b$S=b$H.length?b$H.pop():b$y.call(b$i);return b$S.__InPool=!1,b$S},b$f.getItem=function(b$M){var b$y=b$f.getPoolBySign(b$M),b$i=b$y.length?b$y.pop():null;return b$i&&(b$i.__InPool=!1),b$i},b$f._poolDic={},b$f.InPoolSign="__InPool",b$f}()),b$N=function(){function b$k(){}return b$F(b$k,"laya.utils.Stat"),b$l(1,b$k,"onclick",null,function(b$M){b$k._sp&&b$k._sp.on("click",b$k._sp,b$M),b$k._canvas&&(b$k._canvas.source.onclick=b$M,b$k._canvas.source.style.pointerEvents="")}),b$k.show=function(b$M,b$y,b$i){if(void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),!b$D.isConchApp||b$D.isConchWebGL){if(b$D.isConchWebGL||b$u.onMiniGame||b$u.onLimixiu||(b$k._useCanvas=!0),b$k._show=!0,b$k._fpsData.length=60,b$k._view[0]={title:"FPS(Canvas)",value:"_fpsStr",color:"yellow",units:"int"},b$k._view[1]={title:"Sprite",value:"_spriteStr",color:"white",units:"int"},b$k._view[2]={title:"DrawCall",value:"drawCall",color:"green",units:"int"},b$k._view[3]={title:"CurMem",value:"currentMemorySize",color:"yellow",units:"M"},b$D.isWebGL)if(b$k._view[4]={title:"Shader",value:"shaderCall",color:"red",units:"int"},b$D.is3DMode){if(b$k._view[0].title="FPS(3D)",b$k._view[5]={title:"TriFaces",value:"trianglesFaces",color:"blue",units:"int"},b$k._view[6]={title:"treeNodeColl",value:"treeNodeCollision",color:"white",units:"int"},b$k._view[7]={title:"treeSpriteColl",value:"treeSpriteCollision",color:"white",units:"int"},1==b$i){var b$H=8;b$k._view[b$H++]={title:"VATTRIBS",value:"MAX_VERTEX_ATTRIBS",color:"white",units:"int",varying:1},b$k._view[b$H++]={title:"VUNIFORMS",value:"MAX_VERTEX_UNIFORM_VECTORS",color:"white",units:"int",varying:1},b$k._view[b$H++]={title:"VARYINGS",value:"MAX_VARYING_VECTORS",color:"white",units:"int",varying:1},b$k._view[b$H++]={title:"CTEXTURES",value:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},b$k._view[b$H++]={title:"VTEXTURES",value:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},b$k._view[b$H++]={title:"TEXTURES",value:"MAX_TEXTURE_IMAGE_UNITS",color:"white",units:"int",varying:1},b$k._view[b$H++]={title:"FUNIFORMS",value:"MAX_FRAGMENT_UNIFORM_VECTORS",color:"white",units:"int",varying:1},b$k._view[b$H++]={title:"SVERSION",value:"SHADING_LANGUAGE_VERSION",color:"white",units:"string",varying:1},b$k._view[b$H++]={title:"VERSION",value:"VERSION",color:"white",units:"string",varying:1}}else if(2==b$i){b$H=8;b$k._view[b$H++]={title:"astc",value:"WEBGL_compressed_texture_astc",color:"white",units:"object",varying:2},b$k._view[b$H++]={title:"atc",value:"WEBGL_compressed_texture_atc",color:"white",units:"object",varying:2},b$k._view[b$H++]={title:"etc",value:"WEBGL_compressed_texture_etc",color:"white",units:"object",varying:2},b$k._view[b$H++]={title:"etc1",value:"WEBGL_compressed_texture_etc1",color:"white",units:"object",varying:2},b$k._view[b$H++]={title:"pvrtc",value:"WEBGL_compressed_texture_pvrtc",color:"white",units:"object",varying:2},b$k._view[b$H++]={title:"s3tc",value:"WEBGL_compressed_texture_s3tc",color:"white",units:"object",varying:2},b$k._view[b$H++]={title:"srgb",value:"WEBGL_compressed_texture_s3tc_srgb",color:"white",units:"object",varying:2}}}else b$k._view[0].title="FPS(WebGL)",b$k._view[5]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};else b$k._view[4]={title:"Canvas",value:"_canvasStr",color:"white",units:"int"};b$k._useCanvas?b$k.createUIPre(b$M,b$y):b$k.createUI(b$M,b$y),b$k.enable()}else b$u.window.conch.showFPS&&b$u.window.conch.showFPS(b$M,b$y)},b$k.createUIPre=function(b$M,b$y){var b$i=b$u.pixelRatio;b$k._width=170*b$i,b$k._vx=75*b$i,b$k._height=b$i*(12*b$k._view.length+3*b$i)+4,b$k._fontSize=12*b$i;for(var b$H=0;b$H<b$k._view.length;b$H++)b$k._view[b$H].x=4,b$k._view[b$H].y=b$H*b$k._fontSize+2*b$i;b$k._canvas||((b$k._canvas=new b$RM("2D")).size(b$k._width,b$k._height),(b$k._ctx=b$k._canvas.getContext("2d")).textBaseline="top",b$k._ctx.font=b$k._fontSize+"px Sans-serif",b$k._canvas.source.style.cssText="pointer-events:none;background:rgba(150,150,150,0.8);z-index:100000;position: absolute;direction:ltr;left:"+b$M+"px;top:"+b$y+"px;width:"+b$k._width/b$i+"px;height:"+b$k._height/b$i+"px;"),b$k._first=!0,b$k.loop(),b$k._first=!1,b$u.container.appendChild(b$k._canvas.source)},b$k.createUI=function(b$M,b$y){var b$i=b$k._sp,b$H=b$u.pixelRatio;b$i||(b$i=new b$oM,(b$k._leftText=new b$hM).pos(5,5),b$k._leftText.color="#ffffff",b$i.addChild(b$k._leftText),(b$k._txt=new b$hM).pos(80*b$H,5),b$k._txt.color="#ffffff",b$i.addChild(b$k._txt),b$k._sp=b$i),b$i.pos(b$M,b$y);for(var b$S="",b$f=0;b$f<b$k._view.length;b$f++){b$S+=b$k._view[b$f].title+"\n"}b$k._leftText.text=b$S;var b$V=170*b$H,b$K=b$H*(12*b$k._view.length+3*b$H)+4;b$k._txt.fontSize=b$k._fontSize*b$H,b$k._leftText.fontSize=b$k._fontSize*b$H,b$i.size(b$V,b$K),b$i.graphics.clear(),b$i.graphics.setAlpha(.5),b$i.graphics.drawRect(0,0,b$V,b$K,"#999999"),b$i.graphics.setAlpha(1),b$k.loop()},b$k.enable=function(){b$U.timer.frameLoop(1,b$k,b$k.loop)},b$k.hide=function(){b$k._show=!1,b$U.timer.clear(b$k,b$k.loop),b$k._canvas&&b$u.removeElement(b$k._canvas.source)},b$k.clear=function(){b$k.trianglesFaces=b$k.drawCall=b$k.shaderCall=b$k.spriteCount=b$k.spriteRenderUseCacheCount=b$k.treeNodeCollision=b$k.treeSpriteCollision=b$k.canvasNormal=b$k.canvasBitmap=b$k.canvasReCache=0},b$k.loop=function(){b$k._count++;var b$M=b$u.now();if(!(b$M-b$k._timer<1e3)){var b$y=b$k._count;if(b$k.FPS=Math.round(1e3*b$y/(b$M-b$k._timer)),b$k._show){b$k.trianglesFaces=Math.round(b$k.trianglesFaces/b$y),b$k.spriteCount=b$k._useCanvas?(b$k.drawCall=Math.round(b$k.drawCall/b$y)-2,b$k.shaderCall=Math.round(b$k.shaderCall/b$y),Math.round(b$k.spriteCount/b$y)-1):(b$k.drawCall=Math.round(b$k.drawCall/b$y)-2,b$k.shaderCall=Math.round(b$k.shaderCall/b$y)-4,Math.round(b$k.spriteCount/b$y)-4),b$k.spriteRenderUseCacheCount=Math.round(b$k.spriteRenderUseCacheCount/b$y),b$k.canvasNormal=Math.round(b$k.canvasNormal/b$y),b$k.canvasBitmap=Math.round(b$k.canvasBitmap/b$y),b$k.canvasReCache=Math.ceil(b$k.canvasReCache/b$y),b$k.treeNodeCollision=Math.round(b$k.treeNodeCollision/b$y),b$k.treeSpriteCollision=Math.round(b$k.treeSpriteCollision/b$y);var b$i=0<b$k.FPS?Math.floor(1e3/b$k.FPS).toString():" ";b$k._fpsStr=b$k.FPS+(b$k.renderSlow?" slow":"")+" "+b$i,b$k._spriteStr=b$k.spriteCount+(b$k.spriteRenderUseCacheCount?"/"+b$k.spriteRenderUseCacheCount:""),b$k._canvasStr=b$k.canvasReCache+"/"+b$k.canvasNormal+"/"+b$k.canvasBitmap,b$k.currentMemorySize=b$t.systemResourceManager.memorySize,b$k._useCanvas?b$k.renderInfoPre():b$k.renderInfo(),b$k.clear()}b$k._count=0,b$k._timer=b$M}},b$k.renderInfoPre=function(){if(b$k._canvas){var b$M=b$k._ctx;b$M.clearRect(b$k._first?0:b$k._vx,0,b$k._width,b$k._height);for(var b$y=b$D.WebGL.mainContext,b$i=0;b$i<b$k._view.length;b$i++){var b$H=b$k._view[b$i];b$k._first&&(b$M.fillStyle="white",b$M.fillText(b$H.title,b$H.x,b$H.y,null,null,null)),b$M.fillStyle=b$H.color;var b$S=-1;if((b$H=b$k._view[b$i]).varying){if(b$y)switch(b$H.varying){case 1:b$S=b$y.getParameter(b$y[b$H.value]);break;case 2:b$S=b$y.getExtension(b$H.value)}}else b$S=b$k[b$H.value];"M"==b$H.units&&(b$S=Math.floor(b$S/1048576*100)/100+" M"),"K"==b$H.units&&(b$S=Math.floor(b$S/1024*100)/100+" K"),"string"==b$H.units&&(b$S=b$S.match(/\d+\.?\d/i)),b$M.fillText(b$S+"",b$H.x+b$k._vx,b$H.y,null,null,null)}}},b$k.renderInfo=function(){for(var b$M="",b$y=b$D.WebGL.mainContext,b$i=0;b$i<b$k._view.length;b$i++){var b$H=b$k._view[b$i],b$S=-1;if(b$H.varying){if(b$y)switch(b$H.varying){case 1:b$S=b$y.getParameter(b$y[b$H.value]);break;case 2:b$S=b$y.getExtension(b$H.value)}}else b$S=b$k[b$H.value];"M"==b$H.units&&(b$S=Math.floor(b$S/1048576*100)/100+" M"),"K"==b$H.units&&(b$S=Math.floor(b$S/1024*100)/100+" K"),"string"==b$H.units&&(b$S=b$S.match(/\d+\.?\d/i)),b$M+=b$S+"\n"}b$k._txt.text=b$M},b$k.FPS=0,b$k.loopCount=0,b$k.shaderCall=0,b$k.drawCall=0,b$k.trianglesFaces=0,b$k.spriteCount=0,b$k.spriteRenderUseCacheCount=0,b$k.treeNodeCollision=0,b$k.treeSpriteCollision=0,b$k.canvasNormal=0,b$k.canvasBitmap=0,b$k.canvasReCache=0,b$k.renderSlow=!1,b$k.currentMemorySize=0,b$k._fpsStr=null,b$k._canvasStr=null,b$k._spriteStr=null,b$k._fpsData=[],b$k._timer=0,b$k._count=0,b$k._view=[],b$k._fontSize=12,b$k._txt=null,b$k._leftText=null,b$k._sp=null,b$k._show=!1,b$k._useCanvas=!1,b$k._canvas=null,b$k._ctx=null,b$k._first=!1,b$k._vx=NaN,b$k._width=0,b$k._height=100,b$k}(),b$$=(function(){function b$M(){this._strsToID={},this._idToStrs=[],this._length=0}b$F(b$M,"laya.utils.StringKey");var b$y=b$M.prototype;b$y.add=function(b$M){var b$y=this._strsToID[b$M];return null!=b$y?b$y:(this._idToStrs[this._length]=b$M,this._strsToID[b$M]=this._length++)},b$y.getID=function(b$M){var b$y=this._strsToID[b$M];return null==b$y?-1:b$y},b$y.getName=function(b$M){var b$y=this._idToStrs[b$M];return null==b$y?void 0:b$y}}(),function(){var b$X;function b$M(){this._delta=0,this.scale=1,this.currFrame=0,this._mid=1,this._map={},this._laters=[],this._handlers=[],this._temp=[],this._count=0,this._errorRecord=!1,this.currTimer=this._now(),this._lastTimer=this._now(),this._init()}b$F(b$M,"laya.utils.Timer");var b$y=b$M.prototype;return b$y._init=function(){b$U.timer&&b$U.timer.frameLoop(1,this,this._update)},b$y._now=function(){return Date.now()},b$y._update=function(){if(this.scale<=0)this._lastTimer=this._now();else{var b$M=this.currFrame=this.currFrame+this.scale,b$y=this._now();this._delta=(b$y-this._lastTimer)*this.scale;var b$i=this.currTimer=this.currTimer+this._delta;b$U.isDebug&&6e4<Math.abs(b$y-this._lastTimer)&&console.error("系统时间错误！"+(b$y-this._lastTimer)),this._lastTimer=b$y;var b$H=this._handlers;for(b$V=this._count=0,b$K=b$H.length;b$V<b$K;b$V++)if(null!==(b$k=b$H[b$V]).method){var b$S=b$k.userFrame?b$M:b$i;if(b$S>=b$k.exeTime)if(b$k.repeat)if(b$k.jumpFrame)for(;b$S>=b$k.exeTime;)b$k.exeTime+=b$k.delay,b$k.run(!1);else b$k.exeTime+=b$k.delay,b$k.run(!1),b$S>b$k.exeTime&&(b$k.exeTime+=Math.ceil((b$S-b$k.exeTime)/b$k.delay)*b$k.delay);else b$k.run(!0)}else this._count++;(30<this._count||b$M%200==0)&&this._clearHandlers();for(var b$f=this._laters,b$V=0,b$K=b$f.length-1;b$V<=b$K;b$V++){var b$k=b$f[b$V];this._isIgnoreRecover(b$k)||(null!==b$k.method&&(delete this._map[b$k.key],b$k.run(!1)),this._recoverHandler(b$k)),b$V===b$K&&(b$K=b$f.length-1)}b$f.length=0}},b$y._clearHandlers=function(){for(var b$M=this._handlers,b$y=0,b$i=b$M.length;b$y<b$i;b$y++){var b$H=b$M[b$y];null!==b$H.method?this._temp.push(b$H):this._isIgnoreRecover(b$H)?this._temp.push(b$H):this._recoverHandler(b$H)}this._handlers=this._temp,this._temp=b$M,this._temp.length=0},b$y._recoverHandler=function(b$M){this._map[b$M.key]==b$M&&delete this._map[b$M.key],b$M.recover()},b$y._create=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){if(!b$i)return b$S.apply(b$H,b$f),null;if(b$V){var b$k=this._getHandler(b$H,b$S);if(b$k)return b$k.repeat=b$y,b$k.userFrame=b$M,b$k.delay=b$i,b$k.ignoreRecover=b$K,b$k.caller=b$H,b$k.method=b$S,b$k.args=b$f,b$k.exeTime=b$i+(b$M?this.currFrame:this.currTimer+this._now()-this._lastTimer),b$k}return(b$k=b$X.create()).repeat=b$y,b$k.userFrame=b$M,b$k.delay=b$i,b$k.ignoreRecover=b$K,b$k.caller=b$H,b$k.method=b$S,b$k.args=b$f,b$k.exeTime=b$i+(b$M?this.currFrame:this.currTimer+this._now()-this._lastTimer)+1,this._indexHandler(b$k),this._handlers.push(b$k),b$k},b$y._indexHandler=function(b$M){var b$y=b$M.caller,b$i=b$M.method,b$H=b$y?b$y.$_GID||(b$y.$_GID=b$g.getGID()):0,b$S=b$i.$_TID||(b$i.$_TID=this._mid++);b$M.key=b$H+"_"+b$S,this._map[b$M.key]=b$M},b$y.once=function(b$M,b$y,b$i,b$H,b$S){void 0===b$S&&(b$S=!0),this._create(!1,!1,b$M,b$y,b$i,b$H,b$S,!1)},b$y.loop=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){void 0===b$S&&(b$S=!0),void 0===b$f&&(b$f=!1),void 0===b$V&&(b$V=!1);var b$K=this._create(!1,!0,b$M,b$y,b$i,b$H,b$S,b$V);b$K&&(b$K.jumpFrame=b$f)},b$y.frameOnce=function(b$M,b$y,b$i,b$H,b$S){void 0===b$S&&(b$S=!0),this._create(!0,!1,b$M,b$y,b$i,b$H,b$S,!1)},b$y.frameLoop=function(b$M,b$y,b$i,b$H,b$S,b$f){void 0===b$S&&(b$S=!0),void 0===b$f&&(b$f=!1),this._create(!0,!0,b$M,b$y,b$i,b$H,b$S,b$f)},b$y.toString=function(){return"callLater:"+this._laters.length+" handlers:"+this._handlers.length+" pool:"+b$X._freeCount},b$y.clear=function(b$M,b$y){var b$i=this._getHandler(b$M,b$y);return!(!b$i||this._isIgnoreRecover(b$i))&&(delete this._map[b$i.key],b$i.key=null,b$i.clear(),!0)},b$y.clearAll=function(b$M){if(b$M)for(var b$y=0,b$i=this._handlers.length;b$y<b$i;b$y++){var b$H=this._handlers[b$y];b$H.caller===b$M&&(this._isIgnoreRecover(b$H)||(delete this._map[b$H.key],b$H.key=null,b$H.clear()))}},b$y._getHandler=function(b$M,b$y){var b$i=b$M?b$M.$_GID||(b$M.$_GID=b$g.getGID()):0,b$H=b$y.$_TID||(b$y.$_TID=this._mid++);return this._map[b$i+"_"+b$H]},b$y._isIgnoreRecover=function(b$M){if(b$M.ignoreRecover||b$M.caller&&"IgnoreRecover"==b$M.caller.callername){if(this._errorRecord)console.warn("核心定时器销毁忽略");else{this._errorRecord=!0;var b$y="";try{arguments.propertyIsEnumerable.caller}catch(b$M){b$y=b$M.stack}b$U.recordError("报错：核心定时器销毁忽略  "+b$y)}return!0}return!1},b$y.hasHandler=function(b$M,b$y){return this._map[b$M.$_GID+"_"+b$y.$_TID]},b$y.callLater=function(b$M,b$y,b$i){if(null==this._getHandler(b$M,b$y)){var b$H=b$X.create();b$H.caller=b$M,b$H.method=b$y,b$H.args=b$i,this._indexHandler(b$H),this._laters.push(b$H)}},b$y.runCallLater=function(b$M,b$y){var b$i=this._getHandler(b$M,b$y);b$i&&null!=b$i.method&&(this._isIgnoreRecover(b$i)||(delete this._map[b$i.key],b$i.run(!0)))},b$y.runTimer=function(b$M,b$y){this.runCallLater(b$M,b$y)},b$l(0,b$y,"delta",function(){return this._delta}),b$M.__init$=function(){b$X=function(){function b$y(){this.key=null,this.repeat=!1,this.delay=0,this.userFrame=!1,this.ignoreRecover=!1,this.exeTime=0,this.caller=null,this.method=null,this.args=null,this.jumpFrame=!1}b$F(b$y,"");var b$M=b$y.prototype;return b$M.clear=function(){this.caller=null,this.method=null,this.args=null,this.ignoreRecover=!1},b$M.recover=function(){this.clear(),this.args=b$y._freeHandler,b$y._freeHandler=this,b$y._freeCount++},b$M.run=function(b$M){var b$y=this.caller;if(b$y&&b$y.destroyed)return this.clear();var b$i=this.method,b$H=this.args;b$M&&this.clear(),null!=b$i&&(b$H?b$i.apply(b$y,b$H):b$i.call(b$y))},b$y._freeHandler=null,b$y._freeCount=0,b$y.create=function(){var b$M=b$y._freeHandler;return b$M?(b$y._freeHandler=b$M.args,--b$y._freeCount,b$M.args=null,b$M):new b$y},b$y}()},b$M}()),b$x=function(){function b$o(){this.gid=0}b$F(b$o,"laya.utils.Tween");var b$M=b$o.prototype;return b$M.to=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){return void 0===b$f&&(b$f=0),void 0===b$V&&(b$V=!1),this._create(b$M,b$y,b$i,b$H,b$S,b$f,b$V,!0,!1,!0)},b$M.from=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){return void 0===b$f&&(b$f=0),void 0===b$V&&(b$V=!1),this._create(b$M,b$y,b$i,b$H,b$S,b$f,b$V,!1,!1,!0)},b$M._create=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){if(!b$M)throw new Error("Tween:target is null");this._target=b$M,this._duration=b$i,this._ease=b$H||b$y.ease||b$o.easeNone,this._complete=b$S||b$y.complete,this._delay=b$f,this._props=[],this._usedTimer=0,this._startTimer=b$u.now(),this._usedPool=b$k,this._delayParam=null,this.update=b$y.update;var b$F=b$M.$_GID||(b$M.$_GID=b$g.getGID());return b$o.tweenMap[b$F]?(b$V&&b$o.clearTween(b$M),b$o.tweenMap[b$F].push(this)):b$o.tweenMap[b$F]=[this],b$X?b$f<=0?this.firstStart(b$M,b$y,b$K):(this._delayParam=[b$M,b$y,b$K],b$U.scaleTimer.once(b$f,this,this.firstStart,this._delayParam)):this._initProps(b$M,b$y,b$K),this},b$M.firstStart=function(b$M,b$y,b$i){this._delayParam=null,b$M.destroyed?this.clear():(this._initProps(b$M,b$y,b$i),this._beginLoop())},b$M._initProps=function(b$M,b$y,b$i){for(var b$H in b$y)if("number"==typeof b$M[b$H]){var b$S=b$i?b$M[b$H]:b$y[b$H],b$f=b$i?b$y[b$H]:b$M[b$H];this._props.push([b$H,b$S,b$f-b$S]),b$i||(b$M[b$H]=b$S)}},b$M._beginLoop=function(){b$U.scaleTimer.frameLoop(1,this,this._doEase)},b$M._doEase=function(){this._updateEase(b$u.now())},b$M._updateEase=function(b$M){var b$y=this._target;if(b$y){if(b$y.destroyed)return b$o.clearTween(b$y);var b$i=this._usedTimer=b$M-this._startTimer-this._delay;if(!(b$i<0)){if(b$i>=this._duration)return this.complete();for(var b$H=0<b$i?this._ease(b$i,0,1,this._duration):0,b$S=this._props,b$f=0,b$V=b$S.length;b$f<b$V;b$f++){var b$K=b$S[b$f];b$y[b$K[0]]=b$K[1]+b$H*b$K[2]}this.update&&this.update.run()}}},b$M.complete=function(){if(this._target){b$U.scaleTimer.runTimer(this,this.firstStart);for(var b$M=this._target,b$y=this._props,b$i=this._complete,b$H=0,b$S=b$y.length;b$H<b$S;b$H++){var b$f=b$y[b$H];b$M[b$f[0]]=b$f[1]+b$f[2]}this.update&&this.update.run(),this.clear(),b$i&&b$i.run()}},b$M.pause=function(){b$U.scaleTimer.clear(this,this._beginLoop),b$U.scaleTimer.clear(this,this._doEase),b$U.scaleTimer.clear(this,this.firstStart);var b$M;(b$M=b$u.now()-this._startTimer-this._delay)<0&&(this._usedTimer=b$M)},b$M.setStartTime=function(b$M){this._startTimer=b$M},b$M.clear=function(){this._target&&(this._remove(),this._clear())},b$M._clear=function(){this.pause(),b$U.scaleTimer.clear(this,this.firstStart),this._complete=null,this._target=null,this._ease=null,this._props=null,this._delayParam=null,this._usedPool&&(this.update=null,b$r.recover("tween",this))},b$M.recover=function(){this._usedPool=!0,this._clear()},b$M._remove=function(){var b$M=b$o.tweenMap[this._target.$_GID];if(b$M)for(var b$y=0,b$i=b$M.length;b$y<b$i;b$y++)if(b$M[b$y]===this){b$M.splice(b$y,1);break}},b$M.restart=function(){if(this.pause(),this._usedTimer=0,this._startTimer=b$u.now(),this._delayParam)b$U.scaleTimer.once(this._delay,this,this.firstStart,this._delayParam);else{for(var b$M=this._props,b$y=0,b$i=b$M.length;b$y<b$i;b$y++){var b$H=b$M[b$y];this._target[b$H[0]]=b$H[1]}b$U.scaleTimer.once(this._delay,this,this._beginLoop)}},b$M.resume=function(){this._usedTimer>=this._duration||(this._startTimer=b$u.now()-this._usedTimer-this._delay,this._delayParam?this._usedTimer<0?b$U.scaleTimer.once(-this._usedTimer,this,this.firstStart,this._delayParam):this.firstStart.apply(this,this._delayParam):this._beginLoop())},b$l(0,b$M,"progress",null,function(b$M){var b$y=b$M*this._duration;this._startTimer=b$u.now()-this._delay-b$y}),b$o.to=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){return void 0===b$f&&(b$f=0),void 0===b$V&&(b$V=!1),void 0===b$K&&(b$K=!0),b$r.getItemByClass("tween",b$o)._create(b$M,b$y,b$i,b$H,b$S,b$f,b$V,!0,b$K,!0)},b$o.from=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){return void 0===b$f&&(b$f=0),void 0===b$V&&(b$V=!1),void 0===b$K&&(b$K=!0),b$r.getItemByClass("tween",b$o)._create(b$M,b$y,b$i,b$H,b$S,b$f,b$V,!1,b$K,!0)},b$o.clearAll=function(b$M){if(b$M&&b$M.$_GID){var b$y=b$o.tweenMap[b$M.$_GID];if(b$y){for(var b$i=0,b$H=b$y.length;b$i<b$H;b$i++)b$y[b$i]._clear();b$y.length=0}}},b$o.clear=function(b$M){b$M.clear()},b$o.clearTween=function(b$M){b$o.clearAll(b$M)},b$o.easeNone=function(b$M,b$y,b$i,b$H){return b$i*b$M/b$H+b$y},b$o.tweenMap={},b$o}(),b$g=function(){function b$K(){}return b$F(b$K,"laya.utils.Utils"),b$K.toRadian=function(b$M){return b$M*b$K._pi2},b$K.toAngle=function(b$M){return b$M*b$K._pi},b$K.toHexColor=function(b$M){if(b$M<0||isNaN(b$M))return null;for(var b$y=b$M.toString(16);b$y.length<6;)b$y="0"+b$y;return"#"+b$y},b$K.getGID=function(){return b$K._gid++},b$K.concatArray=function(b$M,b$y){if(!b$y)return b$M;if(!b$M)return b$y;var b$i=0,b$H=b$y.length;for(b$i=0;b$i<b$H;b$i++)b$M.push(b$y[b$i]);return b$M},b$K.clearArray=function(b$M){return b$M&&(b$M.length=0),b$M},b$K.copyArray=function(b$M,b$y){if(b$M||(b$M=[]),!b$y)return b$M;b$M.length=b$y.length;var b$i=0,b$H=b$y.length;for(b$i=0;b$i<b$H;b$i++)b$M[b$i]=b$y[b$i];return b$M},b$K.getGlobalRecByPoints=function(b$M,b$y,b$i,b$H,b$S){var b$f,b$V;return b$f=new b$Q(b$y,b$i),b$f=b$M.localToGlobal(b$f),b$V=new b$Q(b$H,b$S),b$V=b$M.localToGlobal(b$V),b$W._getWrapRec([b$f.x,b$f.y,b$V.x,b$V.y])},b$K.getGlobalPosAndScale=function(b$M){return b$K.getGlobalRecByPoints(b$M,0,0,1,1)},b$K.bind=function(b$M,b$y){return b$M.bind(b$y)},b$K.measureText=function(b$M,b$y){return b$T.measureText(b$M,b$y)},b$K.updateOrder=function(b$M){if(!b$M||b$M.length<2)return!1;for(var b$y,b$i=1,b$H=0,b$S=b$M.length,b$f=NaN;b$i<b$S;){for(b$y=b$M[b$H=b$i],b$f=b$M[b$H]._zOrder;-1<--b$H&&b$M[b$H]._zOrder>b$f;)b$M[b$H+1]=b$M[b$H];b$M[b$H+1]=b$y,b$i++}var b$V=b$y.parent.conchModel;if(b$V)if(null!=b$V.updateZOrder)b$V.updateZOrder();else{for(b$i=0;b$i<b$S;b$i++)b$V.removeChild(b$M[b$i].conchModel);for(b$i=0;b$i<b$S;b$i++)b$V.addChildAt(b$M[b$i].conchModel,b$i)}return!0},b$K.transPointList=function(b$M,b$y,b$i){var b$H=0,b$S=b$M.length;for(b$H=0;b$H<b$S;b$H+=2)b$M[b$H]+=b$y,b$M[b$H+1]+=b$i},b$K.parseInt=function(b$M,b$y){void 0===b$y&&(b$y=0);var b$i=b$u.window.parseInt(b$M,b$y);return isNaN(b$i)?0:b$i},b$K.getFileExtension=function(b$M){b$K._extReg.lastIndex=b$M.lastIndexOf(".");var b$y=b$K._extReg.exec(b$M);return b$y&&1<b$y.length?b$y[1].toLowerCase():null},b$K.getTransformRelativeToWindow=function(b$M,b$y,b$i){var b$H=b$U.stage,b$S=laya.utils.Utils.getGlobalPosAndScale(b$M),b$f=b$H._canvasTransform.clone(),b$V=b$f.tx,b$K=b$f.ty;b$f.rotate(-Math.PI/180*b$U.stage.canvasDegree),b$f.scale(b$U.stage.clientScaleX,b$U.stage.clientScaleY);var b$k=b$U.stage.canvasDegree%180!=0,b$X=NaN,b$F=NaN;b$k?(b$X=b$i+b$S.y,b$F=b$y+b$S.x,b$X*=b$f.d,b$F*=b$f.a,90==b$U.stage.canvasDegree?(b$X=b$V-b$X,b$F+=b$K):(b$X+=b$V,b$F=b$K-b$F)):(b$X=b$y+b$S.x,b$F=b$i+b$S.y,b$X*=b$f.a,b$F*=b$f.d,b$X+=b$V,b$F+=b$K);var b$o=NaN,b$d=NaN;return b$d=b$k?(b$o=b$f.d*b$S.height,b$f.a*b$S.width):(b$o=b$f.a*b$S.width,b$f.d*b$S.height),{x:b$X,y:b$F,scaleX:b$o,scaleY:b$d}},b$K.fitDOMElementInArea=function(b$M,b$y,b$i,b$H,b$S,b$f){b$M._fitLayaAirInitialized||(b$M._fitLayaAirInitialized=!0,b$M.style.transformOrigin=b$M.style.webKittransformOrigin="left top",b$M.style.position="absolute");var b$V=b$K.getTransformRelativeToWindow(b$y,b$i,b$H);b$M.style.transform=b$M.style.webkitTransform="scale("+b$V.scaleX+","+b$V.scaleY+") rotate("+b$U.stage.canvasDegree+"deg)",b$M.style.width=b$S+"px",b$M.style.height=b$f+"px",b$M.style.left=b$V.x+"px",b$M.style.top=b$V.y+"px"},b$K.isOkTextureList=function(b$M){if(!b$M)return!1;var b$y,b$i=0,b$H=b$M.length;for(b$i=0;b$i<b$H;b$i++)if(!(b$y=b$M[b$i])||!b$y.source)return!1;return!0},b$K.isOKCmdList=function(b$M){if(!b$M)return!1;var b$y,b$i,b$H=0,b$S=b$M.length,b$f=b$D._context;for(b$H=0;b$H<b$S;b$H++)switch((b$y=b$M[b$H]).callee){case b$f._drawTexture:case b$f._fillTexture:case b$f._drawTextureWithTransform:if(!(b$i=b$y[0])||!b$i.source)return!1}return!0},b$K._gid=1,b$K._pi=180/Math.PI,b$K._pi2=Math.PI/180,b$K._extReg=/\.(\w+)\??/g,b$K.parseXMLFromString=function(b$M){var b$y;if(b$M=b$M.replace(/>\s+</g,"><"),-1<(b$y=(new DOMParser).parseFromString(b$M,"text/xml")).firstChild.textContent.indexOf("This page contains the following errors"))throw new Error(b$y.firstChild.firstChild.textContent);return b$y},b$K}(),b$j=function(){function b$M(){this.useDic={},this.shapeDic={},this.shapeLineDic={},this._id=0,this._checkKey=!1,this._freeIdArray=[],b$D.isWebGL&&b$B.regCacheByFunction(b$g.bind(this.startDispose,this),b$g.bind(this.getCacheList,this))}b$F(b$M,"laya.utils.VectorGraphManager");var b$y=b$M.prototype;return b$y.getId=function(){return this._id++},b$y.addShape=function(b$M,b$y){this.shapeDic[b$M]=b$y,this.useDic[b$M]||(this.useDic[b$M]=!0)},b$y.addLine=function(b$M,b$y){this.shapeLineDic[b$M]=b$y,this.shapeLineDic[b$M]||(this.shapeLineDic[b$M]=!0)},b$y.getShape=function(b$M){this._checkKey&&null!=this.useDic[b$M]&&(this.useDic[b$M]=!0)},b$y.deleteShape=function(b$M){this.shapeDic[b$M]&&(this.shapeDic[b$M]=null,delete this.shapeDic[b$M]),this.shapeLineDic[b$M]&&(this.shapeLineDic[b$M]=null,delete this.shapeLineDic[b$M]),null!=this.useDic[b$M]&&delete this.useDic[b$M]},b$y.getCacheList=function(){var b$M,b$y=[];for(b$M in this.shapeDic)b$y.push(this.shapeDic[b$M]);for(b$M in this.shapeLineDic)b$y.push(this.shapeLineDic[b$M]);return b$y},b$y.startDispose=function(b$M){var b$y;for(b$y in this.useDic)this.useDic[b$y]=!1;this._checkKey=!0},b$y.endDispose=function(){if(this._checkKey){var b$M;for(b$M in this.useDic)this.useDic[b$M]||this.deleteShape(b$M);this._checkKey=!1}},b$M.getInstance=function(){return b$M.instance=b$M.instance||new b$M},b$M.instance=null,b$M}(),b$O=function(){function b$H(){this._obj=null,this._obj=b$H.supportWeakMap?new b$u.window.WeakMap:{},b$H.supportWeakMap||b$H._maps.push(this)}b$F(b$H,"laya.utils.WeakObject");var b$M=b$H.prototype;return b$M.set=function(b$M,b$y){if(null!=b$M)if(b$H.supportWeakMap){var b$i=b$M;"string"!=typeof b$M&&"number"!=typeof b$M||(b$i=b$H._keys[b$M])||(b$i=b$H._keys[b$M]={k:b$M}),this._obj.set(b$i,b$y)}else"string"==typeof b$M||"number"==typeof b$M?this._obj[b$M]=b$y:(b$M.$_GID||(b$M.$_GID=b$g.getGID()),this._obj[b$M.$_GID]=b$y)},b$M.get=function(b$M){if(null==b$M)return null;if(b$H.supportWeakMap){var b$y="string"==typeof b$M||"number"==typeof b$M?b$H._keys[b$M]:b$M;return b$y?this._obj.get(b$y):null}return"string"==typeof b$M||"number"==typeof b$M?this._obj[b$M]:this._obj[b$M.$_GID]},b$M.del=function(b$M){if(null!=b$M)if(b$H.supportWeakMap){var b$y="string"==typeof b$M||"number"==typeof b$M?b$H._keys[b$M]:b$M;if(!b$y)return;this._obj.delete(b$y)}else"string"==typeof b$M||"number"==typeof b$M?delete this._obj[b$M]:delete this._obj[this._obj.$_GID]},b$M.has=function(b$M){if(null==b$M)return!1;if(b$H.supportWeakMap){var b$y="string"==typeof b$M||"number"==typeof b$M?b$H._keys[b$M]:b$M;return this._obj.has(b$y)}return"string"==typeof b$M||"number"==typeof b$M?null!=this._obj[b$M]:null!=this._obj[this._obj.$_GID]},b$H.__init__=function(){(b$H.supportWeakMap=null!=b$u.window.WeakMap)||b$U.timer.loop(b$H.delInterval,null,b$H.clearCache)},b$H.clearCache=function(){for(var b$M=0,b$y=b$H._maps.length;b$M<b$y;b$M++){b$H._maps[b$M]._obj={}}},b$H.supportWeakMap=!1,b$H.delInterval=3e5,b$H._keys={},b$H._maps=[],b$k(b$H,["I",function(){return this.I=new b$H}]),b$H}(),b$L=function(){function b$M(){this.id=NaN,this.save=[],this.toUpperCase=null,this.changed=!1,this._text=null}b$F(b$M,"laya.utils.WordText");var b$y=b$M.prototype;return b$y.setText=function(b$M){this.changed=!0,this._text=b$M},b$y.toString=function(){return this._text},b$y.charCodeAt=function(b$M){return this._text?this._text.charCodeAt(b$M):NaN},b$y.charAt=function(b$M){return this._text?this._text.charAt(b$M):null},b$l(0,b$y,"length",function(){return this._text?this._text.length:0}),b$M}(),b$MM=function(b$M){function b$V(){this._bits=0,this._displayedInStage=!1,this._parent=null,this.conchModel=null,this.name="",this._destroyed=!1,b$V.__super.call(this),this._childs=b$V.ARRAY_EMPTY,this._$P=b$V.PROP_EMPTY,this.timer=b$U.scaleTimer,this.conchModel=b$D.isConchNode?this.createConchModel():null}b$F(b$V,"laya.display.Node",b$X);var b$y=b$V.prototype;return b$y._setBit=function(b$M,b$y){1==b$M&&(this._getBit(b$M)!=b$y&&this._updateDisplayedInstage());b$y?this._bits|=b$M:this._bits&=~b$M},b$y._getBit=function(b$M){return 0!=(this._bits&b$M)},b$y._setUpNoticeChain=function(){this._getBit(1)&&this._setUpNoticeType(1)},b$y._setUpNoticeType=function(b$M){var b$y=this;for(b$y._setBit(b$M,!0),b$y=b$y.parent;b$y;){if(b$y._getBit(b$M))return;b$y._setBit(b$M,!0),b$y=b$y.parent}},b$y.on=function(b$M,b$y,b$i,b$H){return"display"!==b$M&&"undisplay"!==b$M||this._getBit(1)||this._setUpNoticeType(1),this._createListener(b$M,b$y,b$i,b$H,!1)},b$y.once=function(b$M,b$y,b$i,b$H){return"display"!==b$M&&"undisplay"!==b$M||this._getBit(1)||this._setUpNoticeType(1),this._createListener(b$M,b$y,b$i,b$H,!0)},b$y.createConchModel=function(){return null},b$y.destroy=function(b$M){void 0===b$M&&(b$M=!0),this._destroyed=!0,this._parent&&this._parent.removeChild(this),this._childs&&(b$M?this.destroyChildren():this.removeChildren()),this._childs=null,this._$P=null,this.offAll(),this.timer.clearAll(this)},b$y.destroyChildren=function(){if(this._childs)for(var b$M=this._childs.length-1;-1<b$M;b$M--)this._childs[b$M].destroy(!0)},b$y.addChild=function(b$M){if(!b$M||this.destroyed||b$M===this)return b$M;if(b$M.zOrder&&this._set$P("hasZorder",!0),b$M._parent===this){var b$y=this.getChildIndex(b$M);b$y!==this._childs.length-1&&(this._childs.splice(b$y,1),this._childs.push(b$M),this.conchModel&&(this.conchModel.removeChild(b$M.conchModel),this.conchModel.addChildAt(b$M.conchModel,this._childs.length-1)),this._childChanged())}else b$M.parent&&b$M.parent.removeChild(b$M),this._childs===b$V.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(b$M),this.conchModel&&this.conchModel.addChildAt(b$M.conchModel,this._childs.length-1),(b$M.parent=this)._childChanged();return b$M},b$y.addChildren=function(b$M){for(var b$y=arguments,b$i=0,b$H=b$y.length;b$i<b$H;)this.addChild(b$y[b$i++])},b$y.addChildAt=function(b$M,b$y){if(!b$M||this.destroyed||b$M===this)return b$M;if(b$M.zOrder&&this._set$P("hasZorder",!0),0<=b$y&&b$y<=this._childs.length){if(b$M._parent===this){var b$i=this.getChildIndex(b$M);this._childs.splice(b$i,1),this._childs.splice(b$y,0,b$M),this.conchModel&&(this.conchModel.removeChild(b$M.conchModel),this.conchModel.addChildAt(b$M.conchModel,b$y)),this._childChanged()}else b$M.parent&&b$M.parent.removeChild(b$M),this._childs===b$V.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(b$y,0,b$M),this.conchModel&&this.conchModel.addChildAt(b$M.conchModel,b$y),b$M.parent=this;return b$M}throw new Error("appendChildAt:The index is out of bounds")},b$y.getChildIndex=function(b$M){return this._childs.indexOf(b$M)},b$y.getChildByName=function(b$M){var b$y=this._childs;if(b$y)for(var b$i=0,b$H=b$y.length;b$i<b$H;b$i++){var b$S=b$y[b$i];if(b$S.name===b$M)return b$S}return null},b$y._get$P=function(b$M){return this._$P[b$M]},b$y._set$P=function(b$M,b$y){return this.destroyed||(this._$P===b$V.PROP_EMPTY&&(this._$P={}),this._$P[b$M]=b$y),b$y},b$y.getChildAt=function(b$M){return this._childs[b$M]},b$y.setChildIndex=function(b$M,b$y){var b$i=this._childs;if(b$y<0||b$y>=b$i.length)throw new Error("setChildIndex:The index is out of bounds.");var b$H=this.getChildIndex(b$M);if(b$H<0)throw new Error("setChildIndex:node is must child of this object.");return b$i.splice(b$H,1),b$i.splice(b$y,0,b$M),this.conchModel&&(this.conchModel.removeChild(b$M.conchModel),this.conchModel.addChildAt(b$M.conchModel,b$y)),this._childChanged(),b$M},b$y._childChanged=function(b$M){},b$y.removeChild=function(b$M){if(!this._childs)return b$M;var b$y=this._childs.indexOf(b$M);return this.removeChildAt(b$y)},b$y.removeSelf=function(){return this._parent&&this._parent.removeChild(this),this},b$y.removeChildByName=function(b$M){var b$y=this.getChildByName(b$M);return b$y&&this.removeChild(b$y),b$y},b$y.removeChildAt=function(b$M){var b$y=this.getChildAt(b$M);if(b$y){for(var b$i=this._childs.length-1,b$H=b$M;b$H<b$i;++b$H)this._childs[b$H]=this._childs[b$H+1];this._childs.length=b$i,this.conchModel&&this.conchModel.removeChild(b$y.conchModel),b$y.parent=null}return b$y},b$y.removeChildren=function(b$M,b$y){if(void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=2147483647),this._childs&&0<this._childs.length){var b$i=this._childs;if(0===b$M&&b$f<=b$y){var b$H=b$i;this._childs=b$V.ARRAY_EMPTY}else b$H=b$i.splice(b$M,b$y-b$M);for(var b$S=0,b$f=b$H.length;b$S<b$f;b$S++)b$H[b$S].parent=null,this.conchModel&&this.conchModel.removeChild(b$H[b$S].conchModel)}return this},b$y.replaceChild=function(b$M,b$y){var b$i=this._childs.indexOf(b$y);return-1<b$i?(this._childs.splice(b$i,1,b$M),this.conchModel&&(this.conchModel.removeChild(b$y.conchModel),this.conchModel.addChildAt(b$M.conchModel,b$i)),b$y.parent=null,b$M.parent=this,b$M):null},b$y._updateDisplayedInstage=function(){var b$M;b$M=this;var b$y=b$U.stage;for(this._displayedInStage=!1;b$M;){if(b$M._getBit(1)){this._displayedInStage=b$M._displayedInStage;break}if(b$M==b$y||b$M._displayedInStage){this._displayedInStage=!0;break}b$M=b$M.parent}},b$y._setDisplay=function(b$M){this._displayedInStage!==b$M&&((this._displayedInStage=b$M)?this.event("display"):this.event("undisplay"))},b$y._displayChild=function(b$M,b$y){var b$i=b$M._childs;if(b$i)for(var b$H=0;b$H<b$i.length;b$H++){var b$S=b$i[b$H];b$S&&b$S._getBit(1)&&(0<b$S._childs.length?this._displayChild(b$S,b$y):b$S._setDisplay(b$y))}b$M._setDisplay(b$y)},b$y.contains=function(b$M){if(b$M===this)return!0;for(;b$M;){if(b$M.parent===this)return!0;b$M=b$M.parent}return!1},b$y.timerLoop=function(b$M,b$y,b$i,b$H,b$S,b$f){void 0===b$S&&(b$S=!0),void 0===b$f&&(b$f=!1),this.timer.loop(b$M,b$y,b$i,b$H,b$S,b$f)},b$y.timerOnce=function(b$M,b$y,b$i,b$H,b$S){void 0===b$S&&(b$S=!0),this.timer._create(!1,!1,b$M,b$y,b$i,b$H,b$S)},b$y.frameLoop=function(b$M,b$y,b$i,b$H,b$S){void 0===b$S&&(b$S=!0),this.timer._create(!0,!0,b$M,b$y,b$i,b$H,b$S)},b$y.frameOnce=function(b$M,b$y,b$i,b$H,b$S){void 0===b$S&&(b$S=!0),this.timer._create(!0,!1,b$M,b$y,b$i,b$H,b$S)},b$y.clearTimer=function(b$M,b$y){this.timer.clear(b$M,b$y)},b$l(0,b$y,"numChildren",function(){return this._childs.length}),b$l(0,b$y,"destroyed",function(){return this._destroyed}),b$l(0,b$y,"parent",function(){return this._parent},function(b$M){this._parent!==b$M&&(b$M?(this._parent=b$M,this.event("added"),this._getBit(1)&&(this._setUpNoticeChain(),b$M.displayedInStage&&this._displayChild(this,!0)),b$M._childChanged(this)):(this.event("removed"),this._parent._childChanged(),this._getBit(1)&&this._displayChild(this,!1),this._parent=b$M))}),b$l(0,b$y,"displayedInStage",function(){return this._getBit(1)||this._setUpNoticeType(1),this._displayedInStage}),b$V.ARRAY_EMPTY=[],b$V.PROP_EMPTY={},b$V.NOTICE_DISPLAY=1,b$V.MOUSEENABLE=2,b$V}(),b$yM=function(b$M){function b$d(b$M){this._bgground=null,this._border=null,this._rect=null,this.underLine=0,this.lineHeight=0,b$d.__super.call(this),this._padding=b$d._PADDING,this._spacing=b$d._SPACING,this._aligns=b$d._ALIGNS,this._font=b$P.EMPTY,this._ower=b$M}b$F(b$d,"laya.display.css.CSSStyle",b$M);var b$y=b$d.prototype;return b$y.destroy=function(){this._ower=null,this._font=null,this._rect=null},b$y.inherit=function(b$M){this._font=b$M._font,this._spacing=b$M._spacing===b$d._SPACING?b$d._SPACING:b$M._spacing.slice(),this.lineHeight=b$M.lineHeight},b$y._widthAuto=function(){return 0!=(262144&this._type)},b$y.widthed=function(b$M){return 0!=(8&this._type)},b$y._calculation=function(b$M,b$y){if(b$y.indexOf("%")<0)return!1;var b$H=this._ower,b$S=b$H.parent,b$f=this._rect;function b$V(b$M,b$y,b$i){return b$M*b$i[0]+b$y*b$i[1]+b$i[2]}function b$i(b$M){var b$y=b$S.width,b$i=b$H.width;b$f.width&&(b$H.width=b$V(b$y,b$i,b$f.width)),b$f.height&&(b$H.height=b$V(b$y,b$i,b$f.height)),b$f.left&&(b$H.x=b$V(b$y,b$i,b$f.left)),b$f.top&&(b$H.y=b$V(b$y,b$i,b$f.top))}null===b$f&&(b$S._getCSSStyle()._type|=524288,b$S.on("resize",this,b$i),this._rect=b$f={input:{}});var b$K=b$y.split(" ");return b$K[0]=parseFloat(b$K[0])/100,1==b$K.length?b$K[1]=b$K[2]=0:(b$K[1]=parseFloat(b$K[1])/100,b$K[2]=parseFloat(b$K[2])),b$f[b$M]=b$K,b$f.input[b$M]=b$y,b$i(),!0},b$y.heighted=function(b$M){return 0!=(8192&this._type)},b$y.size=function(b$M,b$y){var b$i=this._ower,b$H=!1;-1!==b$M&&b$M!=this._ower.width&&(this._type|=8,this._ower.width=b$M,b$H=!0),-1!==b$y&&b$y!=this._ower.height&&(this._type|=8192,this._ower.height=b$y,b$H=!0),b$H&&(b$i._layoutLater(),524288&this._type&&b$i.event("resize",this))},b$y._getAlign=function(){return this._aligns[0]},b$y._getValign=function(){return this._aligns[1]},b$y._getCssFloat=function(){return 0!=(32768&this._type)?32768:0},b$y._createFont=function(){return 4096&this._type?this._font:(this._type|=4096,this._font=new b$P(this._font))},b$y.render=function(b$M,b$y,b$i,b$H){var b$S=b$M.width,b$f=b$M.height;b$i-=b$M.pivotX,b$H-=b$M.pivotY,this._bgground&&null!=this._bgground.color&&b$y.ctx.fillRect(b$i,b$H,b$S,b$f,this._bgground.color),this._border&&this._border.color&&b$y.drawRect(b$i,b$H,b$S,b$f,this._border.color.strColor,this._border.size)},b$y.getCSSStyle=function(){return this},b$y.cssText=function(b$M){this.attrs(b$d.parseOneCSS(b$M,";"))},b$y.attrs=function(b$M){if(b$M)for(var b$y=0,b$i=b$M.length;b$y<b$i;b$y++){var b$H=b$M[b$y];this[b$H[0]]=b$H[1]}},b$y.setTransform=function(b$M){"none"===b$M?this._tf=b$K._TF_EMPTY:this.attrs(b$d.parseOneCSS(b$M,","))},b$y.translate=function(b$M,b$y){this._tf===b$K._TF_EMPTY&&(this._tf=new b$S),this._tf.translateX=b$M,this._tf.translateY=b$y},b$y.scale=function(b$M,b$y){this._tf===b$K._TF_EMPTY&&(this._tf=new b$S),this._tf.scaleX=b$M,this._tf.scaleY=b$y},b$y._enableLayout=function(){return 0==(2&this._type)&&0==(4&this._type)},b$l(0,b$y,"block",b$M.prototype._$get_block,function(b$M){b$M?this._type|=1:this._type&=-2}),b$l(0,b$y,"valign",function(){return b$d._valigndef[this._aligns[1]]},function(b$M){this._aligns===b$d._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[1]=b$d._valigndef[b$M]}),b$l(0,b$y,"height",null,function(b$M){if(this._type|=8192,"string"==typeof b$M){if(this._calculation("height",b$M))return;b$M=parseInt(b$M)}this.size(-1,b$M)}),b$l(0,b$y,"width",null,function(b$M){if(this._type|=8,"string"==typeof b$M){var b$y=b$M.indexOf("auto");if(0<=b$y&&(this._type|=262144,b$M=b$M.substr(0,b$y)),this._calculation("width",b$M))return;b$M=parseInt(b$M)}this.size(b$M,-1)}),b$l(0,b$y,"fontWeight",function(){return this._font.weight},function(b$M){this._createFont().weight=b$M}),b$l(0,b$y,"left",null,function(b$M){var b$y=this._ower;if("string"==typeof b$M){if("center"===b$M?b$M="50% -50% 0":"right"===b$M&&(b$M="100% -100% 0"),this._calculation("left",b$M))return;b$M=parseInt(b$M)}b$y.x=b$M}),b$l(0,b$y,"_translate",null,function(b$M){this.translate(b$M[0],b$M[1])}),b$l(0,b$y,"absolute",function(){return 0!=(4&this._type)}),b$l(0,b$y,"top",null,function(b$M){var b$y=this._ower;if("string"==typeof b$M){if("middle"===b$M?b$M="50% -50% 0":"bottom"===b$M&&(b$M="100% -100% 0"),this._calculation("top",b$M))return;b$M=parseInt(b$M)}b$y.y=b$M}),b$l(0,b$y,"align",function(){return b$d._aligndef[this._aligns[0]]},function(b$M){this._aligns===b$d._ALIGNS&&(this._aligns=[0,0,0]),this._aligns[0]=b$d._aligndef[b$M]}),b$l(0,b$y,"bold",function(){return this._font.bold},function(b$M){this._createFont().bold=b$M}),b$l(0,b$y,"padding",function(){return this._padding},function(b$M){this._padding=b$M}),b$l(0,b$y,"leading",function(){return this._spacing[1]},function(b$M){"string"==typeof b$M&&(b$M=parseInt(b$M+"")),this._spacing===b$d._SPACING&&(this._spacing=[0,0]),this._spacing[1]=b$M}),b$l(0,b$y,"lineElement",function(){return 0!=(65536&this._type)},function(b$M){b$M?this._type|=65536:this._type&=-65537}),b$l(0,b$y,"cssFloat",function(){return 0!=(32768&this._type)?"right":"left"},function(b$M){this.lineElement=!1,"right"===b$M?this._type|=32768:this._type&=-32769}),b$l(0,b$y,"textDecoration",function(){return this._font.decoration},function(b$M){this._createFont().decoration=b$M}),b$l(0,b$y,"whiteSpace",function(){return 131072&this._type?"nowrap":""},function(b$M){"nowrap"===b$M&&(this._type|=131072),"none"===b$M&&(this._type&=-131073)}),b$l(0,b$y,"background",null,function(b$M){b$M?(this._bgground||(this._bgground={}),this._bgground.color=b$M,this._ower.conchModel&&this._ower.conchModel.bgColor(b$M),this._type|=16384,this._ower._renderType|=256):this._bgground=null}),b$l(0,b$y,"wordWrap",function(){return 0==(131072&this._type)},function(b$M){b$M?this._type&=-131073:this._type|=131072}),b$l(0,b$y,"color",function(){return this._font.color},function(b$M){this._createFont().color=b$M}),b$l(0,b$y,"password",function(){return this._font.password},function(b$M){this._createFont().password=b$M}),b$l(0,b$y,"backgroundColor",function(){return this._bgground?this._bgground.color:null},function(b$M){"none"===b$M?this._bgground=null:(this._bgground||(this._bgground={}),this._bgground.color=b$M),this._ower.conchModel&&this._ower.conchModel.bgColor(b$M),this._ower._renderType|=256}),b$l(0,b$y,"font",function(){return this._font.toString()},function(b$M){this._createFont().set(b$M)}),b$l(0,b$y,"weight",null,function(b$M){this._createFont().weight=b$M}),b$l(0,b$y,"letterSpacing",function(){return this._spacing[0]},function(b$M){"string"==typeof b$M&&(b$M=parseInt(b$M+"")),this._spacing===b$d._SPACING&&(this._spacing=[0,0]),this._spacing[0]=b$M}),b$l(0,b$y,"fontSize",function(){return this._font.size},function(b$M){this._createFont().size=b$M}),b$l(0,b$y,"italic",function(){return this._font.italic},function(b$M){this._createFont().italic=b$M}),b$l(0,b$y,"fontFamily",function(){return this._font.family},function(b$M){this._createFont().family=b$M}),b$l(0,b$y,"stroke",function(){return this._font.stroke[0]},function(b$M){this._createFont().stroke===b$P._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[0]=b$M}),b$l(0,b$y,"strokeColor",function(){return this._font.stroke[1]},function(b$M){this._createFont().stroke===b$P._STROKE&&(this._font.stroke=[0,"#000000"]),this._font.stroke[1]=b$M}),b$l(0,b$y,"border",function(){return this._border?this._border.value:""},function(b$M){if("none"!=b$M){this._border||(this._border={});var b$y=(this._border.value=b$M).split(" ");if(this._border.color=b$E.create(b$y[b$y.length-1]),1==b$y.length)return this._border.size=1,void(this._border.type="solid");var b$i=0;0<b$y[0].indexOf("px")?(this._border.size=parseInt(b$y[0]),b$i++):this._border.size=1,this._border.type=b$y[b$i],this._ower._renderType|=256}else this._border=null}),b$l(0,b$y,"borderColor",function(){return this._border&&this._border.color?this._border.color.strColor:null},function(b$M){b$M?(this._border||(this._border={size:1,type:"solid"}),this._border.color=null==b$M?null:b$E.create(b$M),this._ower.conchModel&&this._ower.conchModel.border(this._border.color.strColor),this._ower._renderType|=256):this._border=null}),b$l(0,b$y,"position",function(){return 4&this._type?"absolute":""},function(b$M){"absolute"==b$M?this._type|=4:this._type&=-5}),b$l(0,b$y,"display",null,function(b$M){switch(b$M){case"":this._type&=-3,this.visible=!0;break;case"none":this._type|=2,this.visible=!1,this._ower._layoutLater()}}),b$l(0,b$y,"paddingLeft",function(){return this.padding[3]}),b$l(0,b$y,"paddingTop",function(){return this.padding[0]}),b$l(0,b$y,"_scale",null,function(b$M){this._ower.scale(b$M[0],b$M[1])}),b$l(0,b$y,"_rotate",null,function(b$M){this._ower.rotation=b$M}),b$d.parseOneCSS=function(b$M,b$y){for(var b$i,b$H=[],b$S=b$M.split(b$y),b$f=0,b$V=b$S.length;b$f<b$V;b$f++){var b$K=b$S[b$f],b$k=b$K.indexOf(":"),b$X=b$K.substr(0,b$k).replace(/^\s+|\s+$/g,"");if(0!=b$X.length){var b$F=b$K.substr(b$k+1).replace(/^\s+|\s+$/g,""),b$o=[b$X,b$F];switch(b$X){case"italic":case"bold":b$o[1]="true"==b$F;break;case"line-height":b$o[0]="lineHeight",b$o[1]=parseInt(b$F);break;case"font-size":b$o[0]="fontSize",b$o[1]=parseInt(b$F);break;case"padding":1<(b$i=b$F.split(" ")).length||(b$i[1]=b$i[2]=b$i[3]=b$i[0]),b$o[1]=[parseInt(b$i[0]),parseInt(b$i[1]),parseInt(b$i[2]),parseInt(b$i[3])];break;case"rotate":b$o[0]="_rotate",b$o[1]=parseFloat(b$F);break;case"scale":b$i=b$F.split(" "),b$o[0]="_scale",b$o[1]=[parseFloat(b$i[0]),parseFloat(b$i[1])];break;case"translate":b$i=b$F.split(" "),b$o[0]="_translate",b$o[1]=[parseInt(b$i[0]),parseInt(b$i[1])];break;default:(b$o[0]=b$d._CSSTOVALUE[b$X])||(b$o[0]=b$X)}b$H.push(b$o)}}return b$H},b$d.parseCSS=function(b$M,b$y){for(var b$i;null!=(b$i=b$d._parseCSSRegExp.exec(b$M));)b$d.styleSheets[b$i[1]]=b$d.parseOneCSS(b$i[2],";")},b$d.EMPTY=new b$d(null),b$d._CSSTOVALUE={"letter-spacing":"letterSpacing","line-spacing":"lineSpacing","white-space":"whiteSpace","line-height":"lineHeight","scale-x":"scaleX","scale-y":"scaleY","translate-x":"translateX","translate-y":"translateY","font-family":"fontFamily","font-weight":"fontWeight","vertical-align":"valign","text-decoration":"textDecoration","background-color":"backgroundColor","border-color":"borderColor",float:"cssFloat"},b$d._parseCSSRegExp=new RegExp("([.#]\\w+)\\s*{([\\s\\S]*?)}","g"),b$d._aligndef={left:0,center:1,right:2,0:"left",1:"center",2:"right"},b$d._valigndef={top:0,middle:1,bottom:2,0:"top",1:"middle",2:"bottom"},b$d.styleSheets={},b$d.ALIGN_CENTER=1,b$d.ALIGN_RIGHT=2,b$d.VALIGN_MIDDLE=1,b$d.VALIGN_BOTTOM=2,b$d._CSS_BLOCK=1,b$d._DISPLAY_NONE=2,b$d._ABSOLUTE=4,b$d._WIDTH_SET=8,b$d._PADDING=[0,0,0,0],b$d._RECT=[-1,-1,-1,-1],b$d._SPACING=[0,0],b$d._ALIGNS=[0,0,0],b$d.ADDLAYOUTED=512,b$d._NEWFONT=4096,b$d._HEIGHT_SET=8192,b$d._BACKGROUND_SET=16384,b$d._FLOAT_RIGHT=32768,b$d._LINE_ELEMENT=65536,b$d._NOWARP=131072,b$d._WIDTHAUTO=262144,b$d._LISTERRESZIE=524288,b$d}(b$K),b$iM=function(b$M){function b$V(){this.url=null,this.audio=null,this.loaded=!1,b$V.__super.call(this)}b$F(b$V,"laya.media.h5audio.AudioSound",b$X);var b$y=b$V.prototype;return b$y.dispose=function(){var b$M=b$V._audioCache[this.url];b$M&&(b$M.src="",delete b$V._audioCache[this.url])},b$y.load=function(b$M){var b$y;if(b$M=b$s.formatURL(b$M),(this.url=b$M)==b$a._tMusic?(b$V._initMusicAudio(),(b$y=b$V._musicAudio).src!=b$M&&(b$V._audioCache[b$y.src]=null,b$y=null)):b$y=b$V._audioCache[b$M],b$y&&2<=b$y.readyState)this.event("complete");else{b$y||(b$y=b$M==b$a._tMusic?(b$V._initMusicAudio(),b$V._musicAudio):b$u.createElement("audio"),(b$V._audioCache[b$M]=b$y).src=b$M),b$y.addEventListener("canplaythrough",b$H),b$y.addEventListener("error",b$S);var b$i=this;(this.audio=b$y).load?b$y.load():b$S()}function b$H(){b$f(),b$i.loaded=!0,b$i.event("complete")}function b$S(){b$y.load=null,b$f(),b$i.event("error")}function b$f(){b$y.removeEventListener("canplaythrough",b$H),b$y.removeEventListener("error",b$S)}},b$y.play=function(b$M,b$y,b$i){if(void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),!this.url)return null;var b$H,b$S;if(!(b$H=this.url==b$a._tMusic?b$V._musicAudio:b$V._audioCache[this.url]))return null;b$S=b$r.getItem("audio:"+this.url),b$D.isConchApp?b$S||((b$S=b$u.createElement("audio")).src=this.url):this.url==b$a._tMusic?(b$V._initMusicAudio(),(b$S=b$V._musicAudio).src=this.url):b$S=b$S||b$H.cloneNode(!0);var b$f=new b$dM(b$S);return b$f.url=this.url,b$f.loops=b$y,b$f.startTime=b$M,b$f.startHandler=b$i,b$f.play(!1),b$a.addChannel(b$f),b$f},b$l(0,b$y,"duration",function(){var b$M;return(b$M=b$V._audioCache[this.url])?b$M.duration:0}),b$V._initMusicAudio=function(){b$V._musicAudio||(b$V._musicAudio||(b$V._musicAudio=b$u.createElement("audio")),b$D.isConchApp||b$u.document.addEventListener("mousedown",b$V._makeMusicOK))},b$V._makeMusicOK=function(){b$u.document.removeEventListener("mousedown",b$V._makeMusicOK),b$V._musicAudio.src?b$V._musicAudio.play():(b$V._musicAudio.src="",b$V._musicAudio.load())},b$V._audioCache={},b$V._musicAudio=null,b$V}(),b$HM=function(b$M){function b$y(){this.url=null,this.loops=0,this.startTime=NaN,this.isStopped=!1,this.startHandler=null,this.completeHandler=null,b$y.__super.call(this)}b$F(b$y,"laya.media.SoundChannel",b$X);var b$i=b$y.prototype;return b$i.play=function(){},b$i.stop=function(){},b$i.pause=function(){},b$i.resume=function(){},b$i.__runComplete=function(b$M){b$M&&b$M.run()},b$l(0,b$i,"volume",function(){return 1},function(b$M){}),b$l(0,b$i,"position",function(){return 0}),b$l(0,b$i,"duration",function(){return 0}),b$y}(),b$SM=function(b$M){function b$y(){b$y.__super.call(this)}b$F(b$y,"laya.media.Sound",b$X);var b$i=b$y.prototype;return b$i.load=function(b$M){},b$i.play=function(b$M,b$y,b$i){return void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),null},b$i.dispose=function(){},b$l(0,b$i,"duration",function(){return 0}),b$y}(),b$fM=function(b$M){function b$S(){this.url=null,this.loaded=!1,this.data=null,this.audioBuffer=null,this.__toPlays=null,this._disposed=!1,b$S.__super.call(this)}b$F(b$S,"laya.media.webaudio.WebAudioSound",b$X);var b$y=b$S.prototype;return b$y.load=function(b$M){this.url=b$M,this.audioBuffer=b$S._dataCache[b$M],this.audioBuffer?this._loaded(this.audioBuffer):(b$S.e.on("loaded:"+b$M,this,this._loaded),b$S.e.on("err:"+b$M,this,this._err),b$S.__loadingSound[b$M]||(b$S.__loadingSound[b$M]=!0,b$U.loader.load(b$M,b$v.create(this,this.onloaded),null,b$KM.BUFFER,4,!1,null,!0)))},b$y.onloaded=function(b$M){b$M||this._err(),this._disposed?this._removeLoadEvents():(this.data=b$M,b$S.buffs.push({buffer:this.data,url:this.url}),b$S.decode())},b$y._err=function(){if(this._removeLoadEvents(),b$S.__loadingSound[this.url]=!1,this.event("error"),this.__toPlays){var b$M,b$y,b$i,b$H=0;for(b$M=(b$y=this.__toPlays).length,b$H=0;b$H<b$M;b$H++)(b$i=b$y[b$H])[3]&&!b$i[3].isStopped&&b$i[3].event("error");this.__toPlays.length=0}},b$y._loaded=function(b$M){this._removeLoadEvents(),this._disposed||(this.audioBuffer=b$M,this.loaded=!0,this.event("complete"))},b$y._removeLoadEvents=function(){b$S.e.off("loaded:"+this.url,this,this._loaded),b$S.e.off("err:"+this.url,this,this._err)},b$y.__playAfterLoaded=function(){if(this.__toPlays){var b$M,b$y,b$i,b$H=0;for(b$M=(b$y=this.__toPlays).length,b$H=0;b$H<b$M;b$H++)(b$i=b$y[b$H])[3]&&!b$i[3].isStopped&&this.play(b$i[0],b$i[1],b$i[2],b$i[3]);this.__toPlays.length=0}},b$y.play=function(b$M,b$y,b$i,b$H){return void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),b$H=b$H||new b$PM,this.audioBuffer||this.url&&(this.__toPlays||(this.__toPlays=[]),this.__toPlays.push([b$M,b$y,b$i,b$H]),this.once("complete",this,this.__playAfterLoaded),this.load(this.url)),b$H.url=this.url,b$H.loops=b$y,b$H.audioBuffer=this.audioBuffer,b$H.startTime=b$M,b$H.startHandler=b$i,b$H.play(!1),b$a.addChannel(b$H),b$H},b$y.dispose=function(){this._disposed=!0,delete b$S._dataCache[this.url],delete b$S.__loadingSound[this.url],this.audioBuffer=null,this.data=null,this.__toPlays=[]},b$l(0,b$y,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),b$S.decode=function(){if(!(b$S.buffs.length<=0||b$S.isDecoding))if(b$S.isDecoding=!0,(b$S.tInfo=b$S.buffs.shift())&&b$S.tInfo.buffer&&b$S.tInfo.buffer.byteLength)try{b$S.ctx.decodeAudioData(b$S.tInfo.buffer,b$S._done,b$S._fail)}catch(b$M){console.error("decodeAudioData error  byteLength:"+b$S.tInfo.buffer.byteLength+"  url:"+b$S.tInfo.url)}else b$S._fail()},b$S._done=function(b$M){b$S.e.event("loaded:"+b$S.tInfo.url,b$M),b$S._dataCache[b$S.tInfo.url]=b$M,b$S.isDecoding=!1,b$S.decode()},b$S._fail=function(){b$S.e.event("err:"+b$S.tInfo.url,null),b$S.isDecoding=!1,b$S.decode()},b$S._playEmptySound=function(){if(null!=b$S.ctx){if(b$S._emptySource&&(b$S._emptySource.stop(),b$S._emptySource.disconnect(0),!b$PM._tryCleanFailed))try{b$S._emptySource.buffer=null}catch(b$M){b$PM._tryCleanFailed=!0}var b$M=b$S.ctx.createBufferSource();b$M.buffer=b$S._miniBuffer,b$M.connect(b$S.ctx.destination),b$M.start(0,0,0),b$S._emptySource=b$M}},b$S._unlock=function(){b$S._unlocked||(b$S._playEmptySound(),"running"==b$S.ctx.state?(b$u.document.removeEventListener("mousedown",b$S._unlock,!0),b$u.document.removeEventListener("touchend",b$S._unlock,!0),b$u.document.removeEventListener("touchstart",b$S._unlock,!0),b$S._unlocked=!0):"suspended"==b$S.ctx.state&&b$a._recoverWebAudio())},b$S.initWebAudio=function(){"running"!=b$S.ctx.state&&(b$S._unlock(),b$u.document.addEventListener("mousedown",b$S._unlock,!0),b$u.document.addEventListener("touchend",b$S._unlock,!0),b$u.document.addEventListener("touchstart",b$S._unlock,!0))},b$S._emptySource=null,b$S._dataCache={},b$S.buffs=[],b$S.isDecoding=!1,b$S._unlocked=!1,b$S.tInfo=null,b$S.__loadingSound={},b$k(b$S,["window",function(){return this.window=b$u.window},"webAudioEnabled",function(){return this.webAudioEnabled=b$S.window.AudioContext||b$S.window.webkitAudioContext||b$S.window.mozAudioContext},"ctx",function(){return this.ctx=b$S.webAudioEnabled?new(b$S.window.AudioContext||b$S.window.webkitAudioContext||b$S.window.mozAudioContext):void 0},"_miniBuffer",function(){return this._miniBuffer=b$S.ctx.createBuffer(1,1,22050)},"e",function(){return this.e=new b$X}]),b$S}(),b$VM=function(b$M){function b$y(){this._responseType=null,this._data=null,b$y.__super.call(this),this._http=new b$u.window.XMLHttpRequest}b$F(b$y,"laya.net.HttpRequest",b$X);var b$i=b$y.prototype;return b$i.send=function(b$M,b$y,b$i,b$H,b$S){void 0===b$i&&(b$i="get"),void 0===b$H&&(b$H="text"),this._responseType=b$H,this._data=null;var b$f=this,b$V=this._http;if(b$V.open(b$i,b$M,!0),b$S)for(var b$K=0;b$K<b$S.length;b$K++)b$V.setRequestHeader(b$S[b$K++],b$S[b$K]);else b$D.isConchApp||(b$y&&"string"!=typeof b$y?b$V.setRequestHeader("Content-Type","application/json"):b$V.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));b$V.responseType="arraybuffer"!==b$H?"text":"arraybuffer",b$V.onerror=function(b$M){b$f._onError(b$M)},b$V.onabort=function(b$M){b$f._onAbort(b$M)},b$V.onprogress=function(b$M){b$f._onProgress(b$M)},b$V.onload=function(b$M){b$f._onLoad(b$M)},b$V.send(b$y)},b$i._onProgress=function(b$M){b$M&&b$M.lengthComputable&&this.event("progress",b$M.loaded/b$M.total)},b$i._onAbort=function(b$M){this.error("Request was aborted by user")},b$i._onError=function(b$M){this.error("Request failed Status:"+this._http.status+" text:"+this._http.statusText)},b$i._onLoad=function(b$M){var b$y=this._http,b$i=void 0!==b$y.status?b$y.status:200;200===b$i||204===b$i||0===b$i?this.complete():this.error("["+b$y.status+"]"+b$y.statusText+":"+b$y.responseURL)},b$i.error=function(b$M){this.clear(),this.event("error",b$M)},b$i.complete=function(){this.clear();var b$y=!0;try{"json"===this._responseType?this._data=JSON.parse(this._http.responseText):"xml"===this._responseType?this._data=b$g.parseXMLFromString(this._http.responseText):this._data=this._http.response||this._http.responseText}catch(b$M){b$y=!1,this.error(b$M.message)}b$y&&this.event("complete",this._data instanceof Array?[this._data]:this._data)},b$i.clear=function(){var b$M=this._http;b$M.onerror=b$M.onabort=b$M.onprogress=b$M.onload=null},b$l(0,b$i,"url",function(){return this._http.responseURL}),b$l(0,b$i,"http",function(){return this._http}),b$l(0,b$i,"data",function(){return this._data}),b$y}(),b$KM=function(b$M){function b$c(){this._data=null,this._class=null,this._url=null,this._type=null,this._cache=!1,this._http=null,this._customParse=!1,b$c.__super.call(this),this._onImageCallback=this._loadImageComplete.bind(this),this._onLoadedCallback=this._loadedComplete.bind(this),this.priority=-1,this.realTime=!1}b$F(b$c,"laya.net.Loader",b$X);var b$y=b$c.prototype;return b$y.load=function(b$M,b$y,b$i,b$H,b$S){if(b$M&&""!=b$M||console.error("Loader 加载的url不合法 "+b$M),void 0===b$i&&(b$i=!0),void 0===b$S&&(b$S=!1),0===(this._url=b$M).indexOf("data:image")?this._type=b$y="image":this._type=b$y||(b$y=this.getTypeFromUrl(b$M)),this._cache=b$i,this._data=null,!b$S&&b$c.loadedMap[b$M])return this._data=b$c.loadedMap[b$M],this.event("progress",1),void this.event("complete",this._data);if(b$H&&b$c.setGroup(b$M,b$H),null!=b$c.parserMap[b$y])return this._customParse=!0,void(b$c.parserMap[b$y]instanceof laya.utils.Handler?b$c.parserMap[b$y].runWith(this):b$c.parserMap[b$y].call(null,this));if("image"===b$y||"htmlimage"===b$y||"nativeimage"===b$y)return this._loadImage(b$M);if("ttf"===b$y)return this._loadTTF(b$M);switch(b$y){case"atlas":case"plf":"json";break;case"font":"xml";break;case"pkm":"arraybuffer";break;default:b$y}b$c.preLoadedMap[b$M]?this.onLoaded(b$c.preLoadedMap[b$M]):b$V.resMgrLoad(b$M,this._onLoadedCallback,0<=this.priority?this.priority:2,this.realTime)},b$y.getTypeFromUrl=function(b$M){var b$y=b$g.getFileExtension(b$M);return b$y?b$c.typeMap[b$y]:(console.warn("Not recognize the resources suffix",b$M),"text")},b$y._loadTTF=function(b$M){b$M=b$s.formatURL(b$M);var b$y=new b$e;b$y.complete=b$v.create(this,this.onLoaded),b$y.load(b$M)},b$y._loadImage=function(b$M){b$V.imgMgrLoad(b$M,this._onImageCallback,0<=this.priority?this.priority:2,this.realTime)},b$y._loadImageComplete=function(b$M,b$y,b$i){if(null!=b$i)if(b$i instanceof ArrayBuffer){var b$H=new DataView(b$i),b$S=new laya.webgl.resource.WebGLImage(new Uint8Array(b$i,8),b$M,0,!1,b$H.getUint32(0),b$H.getUint32(4));this.onLoaded(b$S)}else if(b$i instanceof b$FM)b$c.imgMgrSet[b$M]=b$y,b$V.imgMgrLock(b$M,b$c.imgMgrSet[b$M]),this._url=b$M,this.complete(b$i);else{var b$f=-1!=b$M.indexOf(".png",b$M.length-4)?6408:6407;b$S=new laya.webgl.resource.WebGLImage(b$i,b$M,b$f,!1,b$i.width,b$i.height);this.onLoaded(b$S)}else this.event("error","Load image failed")},b$y._loadSound=function(b$M){var b$y=new b$a._soundClass,b$i=this;function b$H(){b$y.offAll()}b$y.on("complete",this,function(){b$H(),b$i.onLoaded(b$y)}),b$y.on("error",this,function(){b$H(),b$y.dispose(),b$i.event("error","Load sound failed")}),b$y.load(b$M)},b$y.onProgress=function(b$M){"atlas"===this._type?this.event("progress",.3*b$M):this.event("progress",b$M)},b$y.onError=function(b$M){this.event("error",b$M)},b$y._loadedComplete=function(b$M,b$y,b$i){if(null!=b$i)switch(this._type){case"atlas":case"plf":case"json":var b$H=new b$p(b$i);this.onLoaded(JSON.parse(b$H.readUTFBytes()));break;case"font":b$H=new b$p(b$i);this.onLoaded(b$g.parseXMLFromString(b$H.readUTFBytes()));break;default:this.onLoaded(b$i)}else this.event("error",b$M)},b$y.onLoaded=function(b$M){var b$y=this._type;if("plf"==b$y)this.parsePLFData(b$M),this.complete(b$M);else if("image"===b$y){var b$i=new b$FM(b$M);b$i.url=this._url,this.complete(b$i)}else if("sound"===b$y||"htmlimage"===b$y||"nativeimage"===b$y)this.complete(b$M);else if("atlas"===b$y){if(!b$M.src&&!b$M._setContext){if(!this._data){if((this._data=b$M).meta&&b$M.meta.image)for(var b$H=b$M.meta.image.split(","),b$S=0<=this._url.indexOf("/")?"/":"\\",b$f=this._url.lastIndexOf(b$S),b$V=0<=b$f?this._url.substr(0,b$f+1):"",b$K=0,b$k=b$H.length;b$K<b$k;b$K++)b$H[b$K]=b$V+b$H[b$K];else b$H=[this._url.replace(".json",".png")];b$H.reverse(),b$M.toLoads=b$H,b$M.pics=[]}return this.event("progress",.3+1/b$H.length*.6),this._loadImage(b$H.pop())}if(!this._data.pics)throw new Error("this._data.pics == null, "+this._url);if(this._data.pics.push(b$M),0<this._data.toLoads.length)return this.event("progress",.3+1/this._data.toLoads.length*.6),this._loadImage(this._data.toLoads.pop());var b$X=this._data.frames,b$F=this._url.split("?")[0],b$o=this._data.meta&&this._data.meta.prefix?this._data.meta.prefix:b$F.substring(0,b$F.lastIndexOf("."))+"/",b$d=this._data.pics,b$P=b$s.formatURL(this._url),b$l=b$c.atlasMap[b$P]||(b$c.atlasMap[b$P]=[]);b$l.dir=b$o;var b$J=1;if(this._data.meta&&this._data.meta.scale&&1!=this._data.meta.scale)for(var b$h in b$J=parseFloat(this._data.meta.scale),b$X){var b$C,b$v=b$X[b$h],b$R=b$d[b$v.frame.idx?b$v.frame.idx:0],b$A=b$s.formatURL(b$o+b$h);b$R.scaleRate=b$J,b$C=b$FM.create(b$R,b$v.frame.x,b$v.frame.y,b$v.frame.w,b$v.frame.h,b$v.spriteSourceSize.x,b$v.spriteSourceSize.y,b$v.sourceSize.w,b$v.sourceSize.h),b$c.cacheRes(b$A,b$C),b$c.keepCache(this._url,b$o+b$h),b$C.url=b$A,b$l.push(b$A)}else for(b$h in b$X)b$R=b$d[(b$v=b$X[b$h]).frame.idx?b$v.frame.idx:0],b$A=b$s.formatURL(b$o+b$h),b$c.cacheRes(b$A,b$FM.create(b$R,b$v.frame.x,b$v.frame.y,b$v.frame.w,b$v.frame.h,b$v.spriteSourceSize.x,b$v.spriteSourceSize.y,b$v.sourceSize.w,b$v.sourceSize.h)),b$c.loadedMap[b$A].url=b$A,b$c.keepCache(this._url,b$o+b$h),b$l.push(b$A);delete this._data.pics,this.complete(this._data)}else if("font"==b$y){if(!b$M.src)return this._data=b$M,this.event("progress",.5),this._loadImage(this._url.replace(".fnt",".png"));var b$G=new b$n;b$G.parseFont(this._data,b$M);var b$I=this._url.split(".fnt")[0].split("/"),b$U=b$I[b$I.length-1];b$hM.registerBitmapFont(b$U,b$G),this._data=b$G,this.complete(this._data)}else if("pkm"==b$y){var b$Q=b$IM.create(b$M,this._url),b$W=new b$FM(b$Q);b$W.url=this._url,this.complete(b$W)}else this.complete(b$M)},b$y.parsePLFData=function(b$M){var b$y,b$i,b$H;for(b$y in b$M)switch(b$H=b$M[b$y],b$y){case"json":case"text":for(b$i in b$H)b$c.preLoadedMap[b$s.formatURL(b$i)]=b$H[b$i];break;default:for(b$i in b$H)b$c.preLoadedMap[b$s.formatURL(b$i)]=b$H[b$i]}},b$y.complete=function(b$M){this._data=b$M,this._customParse?this.event("loaded",b$M instanceof Array?[b$M]:b$M):(b$c._loaders.push(this),b$c._isWorking||b$c.checkNext())},b$y.endLoad=function(b$M){b$M&&(this._data=b$M),this._cache&&b$c.cacheRes(this._url,this._data),this.event("progress",1),this.event("complete",this.data instanceof Array?[this.data]:this.data)},b$l(0,b$y,"url",function(){return this._url}),b$l(0,b$y,"data",function(){return this._data}),b$l(0,b$y,"cache",function(){return this._cache}),b$l(0,b$y,"type",function(){return this._type}),b$c.checkNext=function(){b$c._isWorking=!0;for(var b$M=b$u.now();b$c._startIndex<b$c._loaders.length;)if(b$u.now(),b$c._loaders[b$c._startIndex].endLoad(),b$c._startIndex++,b$u.now()-b$M>b$c.maxTimeOut)return console.warn("loader callback cost a long time:"+(b$u.now()-b$M)+" url="+b$c._loaders[b$c._startIndex-1].url),void b$U.timer.frameOnce(1,null,b$c.checkNext);b$c._loaders.length=0,b$c._startIndex=0,b$c._isWorking=!1},b$c.clearRes=function(b$M,b$y){if(null!=b$M){void 0===b$y&&(b$y=!1),b$M=b$s.formatURL(b$M);var b$i=b$c.getAtlas(b$M);if(b$i){for(var b$H=0,b$S=b$i.length;b$H<b$S;b$H++){var b$f=b$i[b$H],b$V=b$c.getRes(b$f);delete b$c.loadedMap[b$f],b$c.clearCache(b$M.substring(b$s.basePath.length),b$f.substring(b$s.basePath.length)),b$V&&b$V.destroy(b$y)}b$i.length=0,delete b$c.atlasMap[b$M],delete b$c.loadedMap[b$M]}else{var b$K=b$c.loadedMap[b$M];b$K&&(delete b$c.loadedMap[b$M],b$K instanceof laya.resource.Texture&&b$K.bitmap&&b$K.destroy(b$y))}}},b$c.clearTextureRes=function(b$M){b$M=b$s.formatURL(b$M);var b$y=laya.net.Loader.getAtlas(b$M),b$i=b$y&&0<b$y.length?laya.net.Loader.getRes(b$y[0]):laya.net.Loader.getRes(b$M);b$i&&b$i.bitmap&&(b$D.isConchApp&&!b$D.isConchWebGL?b$i.bitmap.source.releaseTexture&&b$i.bitmap.source.releaseTexture():null==b$i.bitmap._atlaser&&b$i.bitmap.releaseResource(!0))},b$c.getRes=function(b$M){return b$c.loadedMap[b$s.formatURL(b$M)]},b$c.getAtlas=function(b$M){return b$c.atlasMap[b$s.formatURL(b$M)]},b$c.cacheRes=function(b$M,b$y){b$M=b$s.formatURL(b$M),null!=b$c.loadedMap[b$M]?console.warn("Resources already exist,is repeated loading:",b$M):b$c.loadedMap[b$M]=b$y},b$c.setGroup=function(b$M,b$y){b$c.groupMap[b$y]||(b$c.groupMap[b$y]=[]),b$c.groupMap[b$y].push(b$M)},b$c.clearResByGroup=function(b$M){if(b$c.groupMap[b$M]){var b$y=b$c.groupMap[b$M],b$i=0,b$H=b$y.length;for(b$i=0;b$i<b$H;b$i++)b$c.clearRes(b$y[b$i]);b$y.length=0}},b$c.keepCache=function(b$M,b$y){if(b$M&&b$y){var b$i=b$c.cacheSet[b$y];b$i?-1==b$i.indexOf(b$M)&&b$i.push(b$M):b$c.cacheSet[b$y]=[b$M]}},b$c.clearCache=function(b$M,b$y){if(b$M&&b$y){var b$i=b$c.cacheSet[b$y];if(b$i){var b$H=b$i.indexOf(b$M);if(-1!==b$H){var b$S=b$i.length-1;0==b$S?(delete b$c.cacheSet[b$y],0<b$c.imgMgrSet[b$y]?b$V.imgMgrFree(b$y,b$c.imgMgrSet[b$y]):b$c.clearRes(b$y,!0)):(b$i[b$H]=b$i[b$S],b$i.length=b$S)}}}},b$c.saveObject=function(b$M,b$y,b$i){if(b$y&&b$M){var b$H=b$c.objectSet[b$M];b$H?(console.warn("Loader.saveObject: "+b$M),b$H[0]=b$y,b$H[1]=b$i):b$c.objectSet[b$M]=[b$y,b$i,[]]}},b$c.findObject=function(b$M){if(b$M){var b$y=b$c.objectSet[b$M];if(b$y)return b$y[0]}return null},b$c.keepObject=function(b$M,b$y){if(b$M&&b$y){var b$i=b$c.objectSet[b$y];b$i&&-1===b$i[2].indexOf(b$M)&&b$i[2].push(b$M)}},b$c.clearObject=function(b$M,b$y){if(b$M&&b$y){var b$i=b$c.objectSet[b$y];if(b$i){var b$H=b$i[2],b$S=b$H.indexOf(b$M);if(-1!==b$S){var b$f=b$H.length-1;0==b$f?(delete b$c.objectSet[b$y],b$i[1]&&b$i[1].call(null,b$i[0])):(b$H[b$S]=b$H[b$f],b$H.length=b$f)}}}},b$c.TEXT="text",b$c.JSON="json",b$c.XML="xml",b$c.BUFFER="arraybuffer",b$c.IMAGE="image",b$c.SOUND="sound",b$c.ATLAS="atlas",b$c.FONT="font",b$c.TTF="ttf",b$c.PLF="plf",b$c.PKM="pkm",b$c.typeMap={png:"image",jpg:"image",jpeg:"image",txt:"text",json:"json",xml:"xml",als:"atlas",atlas:"atlas",mp3:"sound",ogg:"sound",wav:"sound",part:"json",fnt:"font",pkm:"pkm",ttf:"ttf",plf:"plf"},b$c.parserMap={},b$c.groupMap={},b$c.maxTimeOut=100,b$c.loadedMap={},b$c.preLoadedMap={},b$c.atlasMap={},b$c._loaders=[],b$c._isWorking=!1,b$c._startIndex=0,b$c.imgCache={},b$c.cacheSet={},b$c.objectSet={},b$c.imgMgrSet={},b$c}(),b$kM=function(b$M){var b$d;function b$P(){this.retryNum=3,this.retryDelay=10,this.maxLoader=8,this._loaders=[],this._loaderCount=0,this._resInfos=[],this._infoPool=[],this._maxPriority=5,this._failRes={},b$P.__super.call(this);for(var b$M=0;b$M<this._maxPriority;b$M++)this._resInfos[b$M]=[]}b$F(b$P,"laya.net.LoaderManager",b$X);var b$y=b$P.prototype;return b$y.create=function(b$M,b$i,b$y,b$H,b$S,b$f,b$V,b$K){if(null==b$f&&(b$f=2),null==b$V&&(b$V=!0),b$M instanceof Array){var b$k=b$M,b$X=b$k.length,b$F=0;if(b$y)var b$o=b$v.create(b$y.caller,b$y.method,b$y.args,!1);for(var b$d=0;b$d<b$X;b$d++){var b$P=b$k[b$d];"string"==typeof b$P&&(b$P=b$k[b$d]={url:b$P}),b$P.progress=0}for(b$d=0;b$d<b$X;b$d++){b$P=b$k[b$d];var b$l=b$y?b$v.create(null,b$C,[b$P],!1):null,b$J=b$y||b$i?b$v.create(null,b$h,[b$P]):null;this._create(b$P.url,b$J,b$l,b$P.clas||b$H,b$P.params||b$S,null!=b$P.priority&&0<=b$P.priority?b$P.priority:b$f,b$V,b$P.group||b$K)}function b$h(b$M,b$y){b$F++,b$M.progress=1,b$F===b$X&&b$i&&b$i.run()}function b$C(b$M,b$y){b$M.progress=b$y;for(var b$i=0,b$H=0;b$H<b$X;b$H++){b$i+=b$k[b$H].progress}var b$S=b$i/b$X;b$o.runWith(b$S)}return!0}return this._create(b$M,b$i,b$y,b$H,b$S,b$f,b$V,b$K)},b$y._create=function(b$y,b$i,b$M,b$H,b$S,b$f,b$V,b$K){b$y&&""!=b$y||console.error("加载的url不合法 "+b$y),null==b$f&&(b$f=2),null==b$V&&(b$V=!0);var b$k=b$s.formatURL(b$y),b$X=this.getRes(b$k);if(b$X)!b$X.hasOwnProperty("loaded")||b$X.loaded?(b$M&&b$M.runWith(1),b$i&&b$i.run()):b$i&&b$U.loader._createListener(b$y,b$i.caller,b$i.method,b$i.args,!0,!1);else{var b$F=b$g.getFileExtension(b$y),b$o=b$P.createMap[b$F];if(!b$o)throw new Error("LoaderManager:unknown file("+b$y+") extension with: "+b$F+".");b$H||(b$H=b$o[0]);var b$d=b$o[1];if("atlas"==b$F)this.load(b$y,b$i,b$M,b$d,b$f,b$V);else{b$H===b$FM&&(b$d="htmlimage"),(b$X=b$H?new b$H:null).hasOwnProperty("_loaded")&&(b$X._loaded=!1),b$X._setUrl(b$y),b$K&&b$X._setGroup(b$K),this._createLoad(b$X,b$y,b$v.create(null,function(b$M){b$X&&!b$X.destroyed&&b$M&&b$X.onAsynLoaded.call(b$X,b$y,b$M,b$S),b$i&&b$i.run();b$U.loader.event(b$y)}),b$M,b$d,b$f,!1,b$K,!0),b$V&&this.cacheRes(b$k,b$X)}}return b$X},b$y.load=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){b$M&&""!=b$M||console.error("加载的url不合法 "+b$M);var b$k=this;if(null==b$S&&(b$S=2),null==b$f&&(b$f=!0),void 0===b$K&&(b$K=!1),b$M instanceof Array)return this._loadAssets(b$M,b$y,b$i,b$H,b$S,b$f,b$V);var b$X=b$KM.getRes(b$M);if(null!=b$X)b$U.timer.frameOnce(1,null,function(){b$i&&b$i.runWith(1),b$y&&b$y.runWith(b$X),b$k._loaderCount||b$k.event("complete")});else{var b$F=b$P._resMap[b$M];b$F?(b$y&&b$F._createListener("complete",b$y.caller,b$y.method,b$y.args,!1,!1),b$i&&b$F._createListener("progress",b$i.caller,b$i.method,b$i.args,!1,!1)):((b$F=this._infoPool.length?this._infoPool.pop():new b$d).url=b$M,b$F.type=b$H,b$F.cache=b$f,b$F.group=b$V,b$F.ignoreCache=b$K,b$F.priority=b$S,b$y&&b$F.on("complete",b$y.caller,b$y.method,b$y.args),b$i&&b$F.on("progress",b$i.caller,b$i.method,b$i.args),b$P._resMap[b$M]=b$F,b$S=b$S<this._maxPriority?0<=b$S?b$S:0:this._maxPriority-1,this._resInfos[b$S].push(b$F),this._next())}return this},b$y._createLoad=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){var b$X=this;if(null==b$f&&(b$f=2),null==b$V&&(b$V=!0),void 0===b$k&&(b$k=!1),b$y instanceof Array)return this._loadAssets(b$y,b$i,b$H,b$S,b$f,b$V,b$K);var b$F=b$KM.getRes(b$y);if(null!=b$F)b$U.timer.frameOnce(1,null,function(){b$H&&b$H.runWith(1),b$i&&b$i.runWith(b$F),b$X._loaderCount||b$X.event("complete")});else{var b$o=b$P._resMap[b$y];b$o?(b$i&&b$o._createListener("complete",b$i.caller,b$i.method,b$i.args,!1,!1),b$H&&b$o._createListener("progress",b$H.caller,b$H.method,b$H.args,!1,!1)):((b$o=this._infoPool.length?this._infoPool.pop():new b$d).url=b$y,b$o.clas=b$M,b$o.type=b$S,b$o.cache=b$V,b$o.group=b$K,b$o.ignoreCache=b$k,b$o.priority=b$f,b$i&&b$o.on("complete",b$i.caller,b$i.method,b$i.args),b$H&&b$o.on("progress",b$H.caller,b$H.method,b$H.args),b$P._resMap[b$y]=b$o,b$f=b$f<this._maxPriority?0<=b$f?b$f:0:this._maxPriority-1,this._resInfos[b$f].push(b$o),this._next())}return this},b$y._next=function(){if(!(this._loaderCount>=this.maxLoader)){for(var b$M=0;b$M<this._maxPriority;b$M++)for(var b$y=this._resInfos[b$M];0<b$y.length;){var b$i=b$y.shift();if(b$i)return this._doLoad(b$i)}this._loaderCount||this.event("complete")}},b$y._doLoad=function(b$y){this._loaderCount++;var b$i=this._loaders.length?this._loaders.pop():new b$KM;b$i.on("complete",null,b$S),b$i.on("progress",null,function(b$M){b$y.event("progress",b$M)}),b$i.on("error",null,function(b$M){b$S(null)});var b$H=this;function b$S(b$M){b$i.offAll(),b$i._data=null,b$i._customParse=!1,b$H._loaders.push(b$i),b$H._endLoad(b$y,b$M instanceof Array?[b$M]:b$M),b$H._loaderCount--,b$H._next()}b$i._class=b$y.clas,1<=b$y.priority?(b$i.priority=b$y.priority,b$i.realTime=!1):(b$i.priority=0,b$i.realTime=!0),b$i.load(b$y.url,b$y.type,b$y.cache,b$y.group,b$y.ignoreCache)},b$y._endLoad=function(b$M,b$y){var b$i=b$M.url;if(null==b$y){var b$H=this._failRes[b$i]||0;if(b$H<this.retryNum)return console.warn("[warn]Retry to load:",b$i),this._failRes[b$i]=b$H+1,void b$U.timer.once(this.retryDelay,this,this._addReTry,[b$M],!1);console.warn("[error]Failed to load:",b$i),this.event("error",b$i)}this._failRes[b$i]&&(this._failRes[b$i]=0),delete b$P._resMap[b$i],b$M.event("complete",b$y),b$M.offAll(),this._infoPool.push(b$M)},b$y._addReTry=function(b$M){this._resInfos[this._maxPriority-1].push(b$M),this._next()},b$y.clearRes=function(b$M,b$y){void 0===b$y&&(b$y=!1),b$KM.clearRes(b$M,b$y)},b$y.getRes=function(b$M){return b$KM.getRes(b$M)},b$y.cacheRes=function(b$M,b$y){b$KM.cacheRes(b$M,b$y)},b$y.clearTextureRes=function(b$M){b$KM.clearTextureRes(b$M)},b$y.setGroup=function(b$M,b$y){b$KM.setGroup(b$M,b$y)},b$y.clearResByGroup=function(b$M){b$KM.clearResByGroup(b$M)},b$y.clearUnLoaded=function(){for(var b$M=0;b$M<this._maxPriority;b$M++){for(var b$y=this._resInfos[b$M],b$i=b$y.length-1;-1<b$i;b$i--){var b$H=b$y[b$i];b$H&&(b$H.offAll(),this._infoPool.push(b$H))}b$y.length=0}this._loaderCount=0,b$P._resMap={}},b$y.cancelLoadByUrls=function(b$M){if(b$M)for(var b$y=0,b$i=b$M.length;b$y<b$i;b$y++)this.cancelLoadByUrl(b$M[b$y])},b$y.cancelLoadByUrl=function(b$M){for(var b$y=0;b$y<this._maxPriority;b$y++)for(var b$i=this._resInfos[b$y],b$H=b$i.length-1;-1<b$H;b$H--){var b$S=b$i[b$H];b$S&&b$S.url===b$M&&(b$i[b$H]=null,b$S.offAll(),this._infoPool.push(b$S))}b$P._resMap[b$M]&&delete b$P._resMap[b$M]},b$y._loadAssets=function(b$M,b$i,b$V,b$y,b$H,b$S,b$f){null==b$H&&(b$H=2),null==b$S&&(b$S=!0);for(var b$K=b$M.length,b$k=0,b$X=0,b$F=[],b$o=!0,b$d=0;b$d<b$K;b$d++){var b$P=b$M[b$d];if(!b$P)throw new Error("LoaderManager._loadAssets 加载列表错误 arr="+b$M);"string"==typeof b$P&&(b$P={url:b$P,type:b$y,size:1,priority:b$H}),b$P.size||(b$P.size=1),b$P.progress=0,b$X+=b$P.size,b$F.push(b$P);var b$l=b$V?b$v.create(null,b$C,[b$P],!1):null,b$J=b$i||b$V?b$v.create(null,b$h,[b$P]):null;this.load(b$P.url,b$J,b$l,b$P.type,null!=b$P.priority&&0<=b$P.priority?b$P.priority:2,b$S,b$P.group||b$f)}function b$h(b$M,b$y){b$k++,b$M.progress=1,b$y||(b$o=!1),b$k===b$K&&b$i&&b$i.runWith(b$o)}function b$C(b$M,b$y){if(null!=b$V){b$M.progress=b$y;for(var b$i=0,b$H=0;b$H<b$F.length;b$H++){var b$S=b$F[b$H];b$i+=b$S.size*b$S.progress}var b$f=b$i/b$X;b$V.runWith(b$f)}}return this},b$P.cacheRes=function(b$M,b$y){b$KM.cacheRes(b$M,b$y)},b$P._resMap={},b$k(b$P,["createMap",function(){return this.createMap={atlas:[null,"atlas"]}}]),b$P.__init$=function(){b$d=function(b$M){function b$y(){this.url=null,this.type=null,this.cache=!1,this.group=null,this.ignoreCache=!1,this.clas=null,this.priority=-1,b$y.__super.call(this)}return b$F(b$y,"",b$X),b$y}()},b$P}(),b$XM=(function(b$M){function b$S(b$M){b$S.__super.call(this),b$M||(b$M=[.3,.59,.11,0,0,.3,.59,.11,0,0,.3,.59,.11,0,0,0,0,0,1,0]),this._mat=new Float32Array(16),this._alpha=new Float32Array(4);for(var b$y=0,b$i=0,b$H=0;b$H<20;b$H++)b$H%5!=4?this._mat[b$y++]=b$M[b$H]:this._alpha[b$i++]=b$M[b$H];this._action=b$T.createFilterAction(32),this._action.data=this}b$F(b$S,"laya.filters.ColorFilter",b$C);var b$y=b$S.prototype;b$U.imps(b$y,{"laya.filters.IFilter":!0}),b$y.callNative=function(b$M){b$M._$P.cf=this;b$M.conchModel&&b$M.conchModel.setFilterMatrix&&b$M.conchModel.setFilterMatrix(this._mat,this._alpha)},b$l(0,b$y,"type",function(){return 32}),b$l(0,b$y,"action",function(){return this._action})}(),function(b$M){function b$H(b$M,b$y,b$i){this._endian=null,this._stamp=NaN,this._socket=null,this._connected=!1,this._addInputPosition=0,this._input=null,this._output=null,this.timeout=0,this.objectEncoding=0,this.disableInput=!1,this._byteClass=null,this.protocols=[],void 0===b$y&&(b$y=0),b$H.__super.call(this),this._byteClass=b$i||b$p,this.endian="bigEndian",this.timeout=2e4,this._addInputPosition=0,b$M&&0<b$y&&b$y<65535&&this.connect(b$M,b$y)}b$F(b$H,"laya.net.Socket",b$X);var b$y=b$H.prototype;b$y.connect=function(b$M,b$y){var b$i="ws://"+b$M+":"+b$y;b$i="https:"==b$u.window.location.protocol?"wss://"+b$M+":"+b$y:"ws://"+b$M+":"+b$y,this.connectByUrl(b$i)},b$y.connectByUrl=function(b$M){var b$y=this;null!=this._socket&&this.close(),this._socket&&this.cleanSocket(),this.protocols&&0!=this.protocols.length?this._socket=new b$u.window.WebSocket(b$M,this.protocols):this._socket=new b$u.window.WebSocket(b$M),this._socket.binaryType="arraybuffer",this._output=new this._byteClass,this._output.endian=this.endian,this._input=new this._byteClass,this._input.endian=this.endian,this._addInputPosition=0,this._socket.onopen=function(b$M){b$y._onOpen(b$M)},this._socket.onmessage=function(b$M){b$y._onMessage(b$M)},this._socket.onclose=function(b$M){b$y._onClose(b$M)},this._socket.onerror=function(b$M){b$y._onError(b$M)}},b$y.cleanSocket=function(){try{this._socket.close()}catch(b$M){}this._connected=!1,this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null,this._socket=null},b$y.close=function(){if(null!=this._socket)try{this._socket.close()}catch(b$M){}},b$y._onOpen=function(b$M){this._connected=!0,this.event("open",b$M)},b$y._onMessage=function(b$M){if(b$M&&b$M.data){var b$y=b$M.data;if(this.disableInput&&b$y)this.event("message",b$y);else{0<this._input.length&&this._input.bytesAvailable<1&&(this._input.clear(),this._addInputPosition=0);var b$i=this._input.pos;!this._addInputPosition&&(this._addInputPosition=0),this._input.pos=this._addInputPosition,b$y&&("string"==typeof b$y?this._input.writeUTFBytes(b$y):this._input.writeArrayBuffer(b$y),this._addInputPosition=this._input.pos,this._input.pos=b$i),this.event("message",b$y)}}},b$y._onClose=function(b$M){this._connected=!1,this.event("close",b$M)},b$y._onError=function(b$M){this.event("error",b$M)},b$y.send=function(b$M){this._socket.send(b$M)},b$y.flush=function(){if(this._output&&0<this._output.length){var b$y;try{this._socket&&this._socket.send(this._output.__getBuffer().slice(0,this._output.length))}catch(b$M){b$y=b$M}this._output.endian=this.endian,this._output.clear(),b$y&&this.event("error",b$y)}},b$l(0,b$y,"input",function(){return this._input}),b$l(0,b$y,"output",function(){return this._output}),b$l(0,b$y,"connected",function(){return this._connected}),b$l(0,b$y,"endian",function(){return this._endian},function(b$M){this._endian=b$M,null!=this._input&&(this._input.endian=b$M),null!=this._output&&(this._output.endian=b$M)}),b$H.LITTLE_ENDIAN="littleEndian",b$H.BIG_ENDIAN="bigEndian"}(),function(b$M){function b$K(){b$K.__super.call(this),this._$1__id=++b$K._uniqueIDCounter,this.__loaded=!0,this._destroyed=!1,this._referenceCount=0,(b$K._idResourcesMap[this.id]=this)._released=!0,this.lock=!1,this._memorySize=0,this._lastUseFrameCount=-1,b$t.currentResourceManager&&b$t.currentResourceManager.addResource(this)}b$F(b$K,"laya.resource.Resource",b$X);var b$y=b$K.prototype;return b$U.imps(b$y,{"laya.resource.ICreateResource":!0,"laya.resource.IDispose":!0}),b$y._setUrl=function(b$M){var b$y;this._url!==b$M&&(this._url&&((b$y=b$K._urlResourcesMap[this._url]).splice(b$y.indexOf(this),1),0===b$y.length&&delete b$K._urlResourcesMap[this._url]),b$M&&((b$y=b$K._urlResourcesMap[b$M])||(b$K._urlResourcesMap[b$M]=b$y=[]),b$y.push(this)),this._url=b$M)},b$y._getGroup=function(){return this._group},b$y._setGroup=function(b$M){var b$y;this._group!==b$M&&(this._group&&((b$y=b$K._groupResourcesMap[this._group]).splice(b$y.indexOf(this),1),0===b$y.length&&delete b$K._groupResourcesMap[this._group]),b$M&&((b$y=b$K._groupResourcesMap[b$M])||(b$K._groupResourcesMap[b$M]=b$y=[]),b$y.push(this)),this._group=b$M)},b$y._addReference=function(){this._referenceCount++},b$y._removeReference=function(){this._referenceCount--},b$y._clearReference=function(){this._referenceCount=0},b$y._endLoaded=function(){this.__loaded=!0,this.event("loaded",this)},b$y.recreateResource=function(){this.completeCreate()},b$y.disposeResource=function(){},b$y.activeResource=function(b$M){void 0===b$M&&(b$M=!1),this._lastUseFrameCount=b$N.loopCount,!this._destroyed&&this.__loaded&&(this._released||b$M)&&this.recreateResource()},b$y.releaseResource=function(b$M){return void 0===b$M&&(b$M=!0),!(!b$M&&this.lock)&&(!(this._released&&!b$M)&&(this.disposeResource(),this._released=!0,this._lastUseFrameCount=-1,this.event("released",this),!0))},b$y.onAsynLoaded=function(b$M,b$y,b$i){throw new Error("Resource: must override this function!")},b$y.destroy=function(){var b$M;this._destroyed||(null!==this._resourceManager&&this._resourceManager.removeResource(this),this._destroyed=!0,this.lock=!1,this.releaseResource(),delete b$K._idResourcesMap[this.id],this._url&&((b$M=b$K._urlResourcesMap[this._url])&&(b$M.splice(b$M.indexOf(this),1),0===b$M.length&&delete b$K._urlResourcesMap[this.url]),b$KM.clearRes(this._url),this.__loaded||b$T.cancelLoadByUrl(this._url)),this._group&&((b$M=b$K._groupResourcesMap[this._group]).splice(b$M.indexOf(this),1),0===b$M.length&&delete b$K._groupResourcesMap[this.url]))},b$y.completeCreate=function(){this._released=!1,this.event("recovered",this)},b$y.dispose=function(){this.destroy()},b$l(0,b$y,"memorySize",function(){return this._memorySize},function(b$M){var b$y=b$M-this._memorySize;this._memorySize=b$M,this.resourceManager&&this.resourceManager.addRecord(this.uri,this.__className,b$y),this.resourceManager&&this.resourceManager.addSize(b$y)}),b$l(0,b$y,"_loaded",null,function(b$M){this.__loaded=b$M}),b$l(0,b$y,"loaded",function(){return this.__loaded}),b$l(0,b$y,"id",function(){return this._$1__id}),b$l(0,b$y,"destroyed",function(){return this._destroyed}),b$l(0,b$y,"group",function(){return this._getGroup()},function(b$M){this._setGroup(b$M)}),b$l(0,b$y,"resourceManager",function(){return this._resourceManager}),b$l(0,b$y,"url",function(){return this._url}),b$l(0,b$y,"released",function(){return this._released}),b$l(0,b$y,"referenceCount",function(){return this._referenceCount}),b$K.getResourceByID=function(b$M){return b$K._idResourcesMap[b$M]},b$K.getResourceByURL=function(b$M,b$y){return void 0===b$y&&(b$y=0),null==b$K._urlResourcesMap[b$M]?null:b$K._urlResourcesMap[b$M][b$y]},b$K.getResourceCountByURL=function(b$M){return b$K._urlResourcesMap[b$M].length},b$K.destroyUnusedResources=function(b$M){var b$y;if(b$M){var b$i=b$K._groupResourcesMap[b$M];if(b$i)for(var b$H=b$i.slice(),b$S=0,b$f=b$H.length;b$S<b$f;b$S++)(b$y=b$H[b$S]).lock||0!==b$y._referenceCount||b$y.destroy()}else for(var b$V in b$K._idResourcesMap)(b$y=b$K._idResourcesMap[b$V]).lock||0!==b$y._referenceCount||b$y.destroy()},b$K._uniqueIDCounter=0,b$K._idResourcesMap={},b$K._urlResourcesMap={},b$K._groupResourcesMap={},b$K}()),b$FM=function(b$M){function b$c(b$M,b$y){this.offsetX=0,this.offsetY=0,this.sourceWidth=0,this.sourceHeight=0,this._w=0,this._h=0,this._uvID=0,this._atlasID=-1,this.scaleRate=1,b$c.__super.call(this),b$M&&null!=b$M._addReference&&b$M._addReference(),this.setTo(b$M,b$y)}b$F(b$c,"laya.resource.Texture",b$X);var b$y=b$c.prototype;return b$y._setUrl=function(b$M){this.url=b$M},b$y.setTo=function(b$M,b$y){if(b$M instanceof b$V.HTMLElement){var b$i=b$RM.create("2D",b$M);this.bitmap=b$i}else this.bitmap=b$M;if(this.uv=b$y||b$c.DEF_UV,b$M){this._w=b$M.width,this._h=b$M.height,this.sourceWidth=this.sourceWidth||this._w,this.sourceHeight=this.sourceHeight||this._h,this._loaded=0<this._w;var b$H=this;if(this._loaded)b$T.addToAtlas&&b$T.addToAtlas(b$H);else{var b$S=b$M;b$S instanceof laya.resource.HTMLImage&&b$S.image&&b$S.image.addEventListener("load",function(b$M){b$T.addToAtlas&&b$T.addToAtlas(b$H)},!1)}}},b$y.active=function(){this.bitmap&&this.bitmap.activeResource()},b$y.destroy=function(b$M){if(void 0===b$M&&(b$M=!1),this.alphaTexture&&(this.alphaTexture.destroy(b$M),this.alphaTexture=null),this.bitmap&&0<this.bitmap.referenceCount){var b$y=this.bitmap;b$M?(b$D.isConchApp&&b$y.source&&b$y.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,b$y.dispose(),b$y._clearReference()):(b$y._removeReference(),0==b$y.referenceCount&&(b$D.isConchApp&&b$y.source&&b$y.source.conchDestroy&&this.bitmap.source.conchDestroy(),this.bitmap=null,b$y.dispose())),this.url&&this===b$U.loader.getRes(this.url)&&b$U.loader.clearRes(this.url,b$M),this._loaded=!1}},b$y.load=function(b$M){var b$y=this;this._loaded=!1,b$M=b$s.customFormat(b$M);var b$i=this.bitmap||(this.bitmap=b$IM.create(b$M));b$i.uri=b$M,b$i&&b$i._addReference();var b$H=this;b$i.onload=function(){b$i.onload=null,b$H._loaded=!0,b$y.sourceWidth=b$y._w=b$i.width,b$y.sourceHeight=b$y._h=b$i.height,b$H.event("loaded",this),b$T.addToAtlas&&b$T.addToAtlas(b$H)}},b$y.addTextureToAtlas=function(b$M){b$T.addTextureToAtlas(this)},b$y.getPixels=function(b$M,b$y,b$i,b$H){if(b$D.isConchApp){var b$S=this.bitmap;if(b$S.source&&b$S.source.getImageData){var b$f=b$S.source.getImageData(b$M,b$y,b$i,b$H),b$V=new Uint8Array(b$f);return Array.from(b$V)}return null}return b$D.isWebGL?b$T.getTexturePixels(this,b$M,b$y,b$i,b$H):(b$u.canvas.size(b$i,b$H),b$u.canvas.clear(),b$u.context.drawTexture(this,-b$M,-b$y,this.width,this.height,0,0),b$u.context.getImageData(0,0,b$i,b$H).data)},b$y.onAsynLoaded=function(b$M,b$y){if(b$y){if("function"!=typeof b$y._addReference)throw new Error("bitmap._addReference is not a function. "+b$y.className+" "+typeof b$y._addReference+" "+b$y.constructor);b$y._addReference()}this.setTo(b$y,this.uv),this._loaded&&this.event("loaded",this)},b$l(0,b$y,"source",function(){return this.bitmap?(this.bitmap.activeResource(),this.bitmap.source):null}),b$l(0,b$y,"loaded",function(){return this._loaded}),b$l(0,b$y,"released",function(){return!this.bitmap||this.bitmap.released}),b$l(0,b$y,"width",function(){return this._w?this._w:this.uv&&this.uv!==b$c.DEF_UV?(this.uv[2]-this.uv[0])*this.bitmap.width:this.bitmap.width},function(b$M){this._w=b$M,this.sourceWidth||(this.sourceWidth=b$M)}),b$l(0,b$y,"repeat",function(){return!b$D.isWebGL||!this.bitmap||this.bitmap.repeat},function(b$M){b$M&&b$D.isWebGL&&this.bitmap&&(this.bitmap.repeat=b$M)&&(this.bitmap.enableMerageInAtlas=!1)}),b$l(0,b$y,"height",function(){return this._h?this._h:this.uv&&this.uv!==b$c.DEF_UV?(this.uv[5]-this.uv[1])*this.bitmap.height:this.bitmap.height},function(b$M){this._h=b$M,this.sourceHeight||(this.sourceHeight=b$M)}),b$l(0,b$y,"isLinearSampling",function(){return!b$D.isWebGL||9728!=this.bitmap.minFifter},function(b$M){!b$M&&b$D.isWebGL&&(b$M||-1!=this.bitmap.minFifter||-1!=this.bitmap.magFifter||(this.bitmap.minFifter=9728,this.bitmap.magFifter=9728,this.bitmap.enableMerageInAtlas=!1))}),b$c.moveUV=function(b$M,b$y,b$i){for(var b$H=0;b$H<8;b$H+=2)b$i[b$H]+=b$M,b$i[b$H+1]+=b$y;return b$i},b$c.create=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){void 0===b$f&&(b$f=0),void 0===b$V&&(b$V=0),void 0===b$K&&(b$K=0),void 0===b$k&&(b$k=0);var b$X=b$M instanceof laya.resource.Texture,b$F=b$X?b$M.uv:b$c.DEF_UV,b$o=b$X?b$M.bitmap:b$M,b$d=b$T.isAtlas(b$o);if(b$d){var b$P=b$o._atlaser,b$l=b$M._atlasID;if(-1==b$l)throw new Error("create texture error");b$o=b$P._inAtlasTextureBitmapValue[b$l],b$F=b$P._inAtlasTextureOriUVValue[b$l]}var b$J=new b$c(b$o,null);b$o.width&&b$y+b$H>b$o.width&&(b$H=b$o.width-b$y),b$o.height&&b$i+b$S>b$o.height&&(b$S=b$o.height-b$i),b$J.width=b$H,b$J.height=b$S,b$J.offsetX=b$f,b$J.offsetY=b$V,b$J.sourceWidth=b$K||b$H,b$J.sourceHeight=b$k||b$S;var b$h=1/b$o.width,b$C=1/b$o.height;b$y*=b$h,b$i*=b$C,b$H*=b$h,b$S*=b$C;var b$v=b$J.uv[0],b$R=b$J.uv[1],b$A=b$J.uv[4],b$G=b$J.uv[5],b$I=b$A-b$v,b$U=b$G-b$R,b$Q=b$c.moveUV(b$F[0],b$F[1],[b$y,b$i,b$y+b$H,b$i,b$y+b$H,b$i+b$S,b$y,b$i+b$S]);b$J.uv=[b$v+b$Q[0]*b$I,b$R+b$Q[1]*b$U,b$A-(1-b$Q[2])*b$I,b$R+b$Q[3]*b$U,b$A-(1-b$Q[4])*b$I,b$G-(1-b$Q[5])*b$U,b$v+b$Q[6]*b$I,b$G-(1-b$Q[7])*b$U],b$d&&b$J.addTextureToAtlas();var b$W=b$o.scaleRate;return b$W&&1!=b$W?(b$J.sourceWidth/=b$W,b$J.sourceHeight/=b$W,b$J.width/=b$W,b$J.height/=b$W,b$J.scaleRate=b$W,b$J.offsetX/=b$W,b$J.offsetY/=b$W):b$J.scaleRate=1,b$J},b$c.createFromTexture=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$M.scaleRate;1!=b$f&&(b$y*=b$f,b$i*=b$f,b$H*=b$f,b$S*=b$f);var b$V=b$W.TEMP.setTo(b$y-b$M.offsetX,b$i-b$M.offsetY,b$H,b$S),b$K=b$V.intersection(b$c._rect1.setTo(0,0,b$M.width,b$M.height),b$c._rect2);if(!b$K)return null;var b$k=b$c.create(b$M,b$K.x,b$K.y,b$K.width,b$K.height,b$K.x-b$V.x,b$K.y-b$V.y,b$H,b$S);if(b$k.bitmap&&b$k.bitmap._removeReference)return b$k.bitmap._removeReference(),b$k;var b$X="bitmap:"+(b$k.bitmap?b$k.bitmap.constructor?b$k.bitmap.constructor.name:b$k.bitmap.__className:"")+", url:"+(b$M.url+" | "+(b$k.bitmap?b$k.bitmap.url:b$M.url))+", x="+b$y+",y="+b$i+",width="+b$H+",height="+b$S+", result="+(b$K?b$K.x+","+b$K.y+","+b$K.width+","+b$K.height:"null")+", rect="+b$V.x+","+b$V.y+","+b$V.width+","+b$V.height;throw new Error("报错：bitmap._removeReference is not a function  "+b$X)},b$c.DEF_UV=[0,0,1,0,1,1,0,1],b$c.INV_UV=[0,1,1,1,1,0,0,0],b$c._rect1=new b$W,b$c._rect2=new b$W,b$c}(),b$M=function(b$M){var b$K;function b$f(){this._labelDic=null,this._tweenDic={},this._tweenDataList=[],this._endTweenDataList=null,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this._firstTweenDic={},this._startTimeSort=!1,this._endTimeSort=!1,this._loopKey=!1,this.scale=1,this._frameRate=60,this._frameIndex=0,this._total=0,b$f.__super.call(this)}b$F(b$f,"laya.utils.TimeLine",b$X);var b$y=b$f.prototype;return b$y.to=function(b$M,b$y,b$i,b$H,b$S){return void 0===b$S&&(b$S=0),this._create(b$M,b$y,b$i,b$H,b$S,!0)},b$y.from=function(b$M,b$y,b$i,b$H,b$S){return void 0===b$S&&(b$S=0),this._create(b$M,b$y,b$i,b$H,b$S,!1)},b$y._create=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=b$r.getItemByClass("tweenData",b$K);return b$V.isTo=b$f,b$V.type=0,b$V.target=b$M,b$V.duration=b$i,b$V.data=b$y,b$V.startTime=this._startTime+b$S,b$V.endTime=b$V.startTime+b$V.duration,b$V.ease=b$H,this._startTime=Math.max(b$V.endTime,this._startTime),this._tweenDataList.push(b$V),this._startTimeSort=!0,this._endTimeSort=!0,this},b$y.addLabel=function(b$M,b$y){var b$i=b$r.getItemByClass("tweenData",b$K);return b$i.type=1,b$i.data=b$M,b$i.endTime=b$i.startTime=this._startTime+b$y,this._labelDic||(this._labelDic={}),this._labelDic[b$M]=b$i,this._tweenDataList.push(b$i),this},b$y.removeLabel=function(b$M){if(this._labelDic&&this._labelDic[b$M]){var b$y=this._labelDic[b$M];if(b$y){var b$i=this._tweenDataList.indexOf(b$y);-1<b$i&&this._tweenDataList.splice(b$i,1)}delete this._labelDic[b$M]}},b$y.gotoTime=function(b$M){if(null!=this._tweenDataList&&0!=this._tweenDataList.length){var b$y,b$i,b$H,b$S;for(var b$f in this._firstTweenDic)if(b$i=this._firstTweenDic[b$f])for(var b$V in b$i)b$i.diyTarget.hasOwnProperty(b$V)&&(b$i.diyTarget[b$V]=b$i[b$V]);for(b$f in this._tweenDic)(b$y=this._tweenDic[b$f]).clear(),delete this._tweenDic[b$f];if(this._index=0,this._gidIndex=0,this._currTime=b$M,this._lastTime=b$u.now(),null==this._endTweenDataList||this._endTimeSort){this._endTimeSort=!1,this._endTweenDataList=b$H=this._tweenDataList.concat(),b$H.sort(function(b$M,b$y){return b$M.endTime>b$y.endTime?1:b$M.endTime<b$y.endTime?-1:0})}else b$H=this._endTweenDataList;for(var b$K=0,b$k=b$H.length;b$K<b$k;b$K++)if(0==(b$S=b$H[b$K]).type){if(!(b$M>=b$S.endTime))break;this._index=Math.max(this._index,b$K+1);var b$X=b$S.data;if(b$S.isTo)for(var b$F in b$X)b$S.target[b$F]=b$X[b$F]}for(b$K=0,b$k=this._tweenDataList.length;b$K<b$k;b$K++)0==(b$S=this._tweenDataList[b$K]).type&&b$M>=b$S.startTime&&b$M<b$S.endTime&&(this._index=Math.max(this._index,b$K+1),this._gidIndex++,(b$y=b$r.getItemByClass("tween",b$x))._create(b$S.target,b$S.data,b$S.duration,b$S.ease,b$v.create(this,this._animComplete,[this._gidIndex]),0,!1,b$S.isTo,!0,!1),b$y.setStartTime(this._currTime-(b$M-b$S.startTime)),b$y._updateEase(this._currTime),b$y.gid=this._gidIndex,this._tweenDic[this._gidIndex]=b$y)}},b$y.gotoLabel=function(b$M){if(null!=this._labelDic){var b$y=this._labelDic[b$M];b$y&&this.gotoTime(b$y.startTime)}},b$y.pause=function(){b$U.timer.clear(this,this._update)},b$y.resume=function(){this.play(this._currTime,this._loopKey)},b$y.play=function(b$M,b$y){if(void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=!1),this._tweenDataList){if(this._startTimeSort){this._startTimeSort=!1,this._tweenDataList.sort(function(b$M,b$y){return b$M.startTime>b$y.startTime?1:b$M.startTime<b$y.startTime?-1:0});for(var b$i=0,b$H=this._tweenDataList.length;b$i<b$H;b$i++){var b$S=this._tweenDataList[b$i];if(null!=b$S&&0==b$S.type){var b$f=b$S.target,b$V=b$f.$_GID||(b$f.$_GID=b$g.getGID()),b$K=null;for(var b$k in null==this._firstTweenDic[b$V]?((b$K={}).diyTarget=b$f,this._firstTweenDic[b$V]=b$K):b$K=this._firstTweenDic[b$V],b$S.data)null==b$K[b$k]&&(b$K[b$k]=b$f[b$k])}}}"string"==typeof b$M?this.gotoLabel(b$M):this.gotoTime(b$M),this._loopKey=b$y,this._lastTime=b$u.now(),b$U.timer.frameLoop(1,this,this._update)}},b$y._update=function(){if(this._currTime>=this._startTime){if(!this._loopKey){for(var b$M in this._tweenDic)(b$y=this._tweenDic[b$M]).complete();return this._complete(),void this.pause()}if(this._complete(),!this._tweenDataList)return;this.gotoTime(0)}var b$y,b$i=b$u.now(),b$H=b$i-this._lastTime,b$S=this._currTime+=b$H*this.scale;for(b$M in this._lastTime=b$i,this._tweenDic)(b$y=this._tweenDic[b$M])._updateEase(b$S);if(0!=this._tweenDataList.length&&this._index<this._tweenDataList.length){var b$f=this._tweenDataList[this._index];b$S>=b$f.startTime&&(this._index++,0==b$f.type?(this._gidIndex++,(b$y=b$r.getItemByClass("tween",b$x))._create(b$f.target,b$f.data,b$f.duration,b$f.ease,b$v.create(this,this._animComplete,[this._gidIndex]),0,!1,b$f.isTo,!0,!1),b$y.setStartTime(b$S),b$y.gid=this._gidIndex,(this._tweenDic[this._gidIndex]=b$y)._updateEase(b$S)):this.event("label",b$f.data))}},b$y._animComplete=function(b$M){this._tweenDic[b$M]&&delete this._tweenDic[b$M]},b$y._complete=function(){this.event("complete")},b$y.reset=function(){var b$M;if(this._labelDic)for(b$M in this._labelDic)delete this._labelDic[b$M];for(b$M in this._tweenDic)this._tweenDic[b$M].clear(),delete this._tweenDic[b$M];for(b$M in this._firstTweenDic)delete this._firstTweenDic[b$M];if(this._endTweenDataList=null,this._tweenDataList&&this._tweenDataList.length){var b$y,b$i=0;for(b$y=this._tweenDataList.length,b$i=0;b$i<b$y;b$i++)this._tweenDataList[b$i]&&this._tweenDataList[b$i].destroy()}this._tweenDataList.length=0,this._currTime=0,this._lastTime=0,this._startTime=0,this._index=0,this._gidIndex=0,this.scale=1,b$U.timer.clear(this,this._update)},b$y.destroy=function(){this.reset(),this._labelDic=null,this._tweenDic=null,this._tweenDataList=null,this._firstTweenDic=null},b$l(0,b$y,"index",function(){return this._frameIndex},function(b$M){this._frameIndex=b$M,this.gotoTime(this._frameIndex/this._frameRate*1e3)}),b$l(0,b$y,"total",function(){return this._total=Math.floor(this._startTime/1e3*this._frameRate),this._total}),b$f.to=function(b$M,b$y,b$i,b$H,b$S){return void 0===b$S&&(b$S=0),(new b$f).to(b$M,b$y,b$i,b$H,b$S)},b$f.from=function(b$M,b$y,b$i,b$H,b$S){return void 0===b$S&&(b$S=0),(new b$f).from(b$M,b$y,b$i,b$H,b$S)},b$f.__init$=function(){b$K=function(){function b$M(){this.type=0,this.isTo=!0,this.startTime=NaN,this.endTime=NaN,this.target=null,this.duration=NaN,this.ease=null,this.data=null}return b$F(b$M,""),b$M.prototype.destroy=function(){this.target=null,this.ease=null,this.data=null,this.isTo=!0,this.type=0,b$r.recover("tweenData",this)},b$M}()},b$f}(),b$oM=function(b$S){function b$i(){this._transform=null,this._tfChanged=!1,this._x=0,this._y=0,this._width=0,this._height=0,this._repaint=1,this._mouseEnableState=0,this._zOrder=0,this._graphics=null,this._renderType=0,this._optimizeScrollRect=!1,this._texture=null,this.mouseThrough=!1,this.autoSize=!1,this.hitTestPrior=!1,this.viewport=null,b$i.__super.call(this),this._style=b$K.EMPTY}b$F(b$i,"laya.display.Sprite",b$S);var b$M=b$i.prototype;return b$U.imps(b$M,{"laya.display.ILayout":!0}),b$M.createConchModel=function(){return new ConchNode},b$M.destroy=function(b$M){if(void 0===b$M&&(b$M=!0),this._releaseMem(),!this._destroyed){this.filters=null;var b$y=this.mask;b$y&&(this.mask=null,b$y.destroy(b$M))}b$S.prototype.destroy.call(this,b$M),this._style&&this._style.destroy(),this._transform&&this._transform.destroy(),this._transform=null,this._style=null,this._graphics=null},b$M.updateZOrder=function(){b$g.updateOrder(this._childs)&&this.repaint()},b$M.reCache=function(){this._$P.cacheCanvas&&(this._$P.cacheCanvas.reCache=!0),this._repaint=1},b$M.setBounds=function(b$M){this._set$P("uBounds",b$M)},b$M.getBounds=function(){return this._$P.mBounds||this._set$P("mBounds",new b$W),b$W._getWrapRec(this._boundPointsToParent(),this._$P.mBounds)},b$M.getSelfBounds=function(){return this._$P.uBounds?this._$P.uBounds:(this._$P.mBounds||this._set$P("mBounds",new b$W),b$W._getWrapRec(this._getBoundPointsM(!1),this._$P.mBounds))},b$M._boundPointsToParent=function(b$M){void 0===b$M&&(b$M=!1);var b$y=0,b$i=0;this._style&&(b$y=this._style._tf.translateX,b$i=this._style._tf.translateY,b$M=b$M||0!==this._style._tf.rotate,this._style.scrollRect&&(b$y+=this._style.scrollRect.x,b$i+=this._style.scrollRect.y));var b$H=this._getBoundPointsM(b$M);if(!b$H||b$H.length<1)return b$H;if(8!=b$H.length&&(b$H=b$M?b$G.scanPList(b$H):b$W._getWrapRec(b$H,b$W.TEMP)._getBoundPoints()),!this.transform)return b$g.transPointList(b$H,this._x-b$y,this._y-b$i),b$H;var b$S=b$Q.TEMP,b$f=0,b$V=b$H.length;for(b$f=0;b$f<b$V;b$f+=2)b$S.x=b$H[b$f],b$S.y=b$H[b$f+1],this.toParentPoint(b$S),b$H[b$f]=b$S.x,b$H[b$f+1]=b$S.y;return b$H},b$M.getGraphicBounds=function(b$M){return void 0===b$M&&(b$M=!1),this._graphics?this._graphics.getBounds(b$M):b$W.TEMP.setTo(0,0,0,0)},b$M._getBoundPointsM=function(b$M){if(void 0===b$M&&(b$M=!1),this._$P.uBounds)return this._$P.uBounds._getBoundPoints();if(this._$P.temBM||this._set$P("temBM",[]),this.scrollRect){var b$y=b$g.clearArray(this._$P.temBM),b$i=b$W.TEMP;return b$i.copyFrom(this.scrollRect),b$g.concatArray(b$y,b$i._getBoundPoints()),b$y}for(var b$H,b$S,b$f,b$V=this._graphics?this._graphics.getBoundPoints():b$g.clearArray(this._$P.temBM),b$K=0,b$k=(b$f=this._childs).length;b$K<b$k;b$K++)(b$H=b$f[b$K])instanceof laya.display.Sprite&&1==b$H.visible&&(b$S=b$H._boundPointsToParent(b$M))&&(b$V=b$V?b$g.concatArray(b$V,b$S):b$S);return b$V},b$M.getStyle=function(){return this._style===b$K.EMPTY&&(this._style=new b$K),this._style},b$M.setStyle=function(b$M){this._style=b$M},b$M._adjustTransform=function(){this._tfChanged=!1;var b$M,b$y=this._style._tf,b$i=b$y.scaleX,b$H=b$y.scaleY;if(b$y.rotate||1!==b$i||1!==b$H||b$y.skewX||b$y.skewY){(b$M=this._transform||(this._transform=b$m.create())).bTransform=!0;var b$S=.0174532922222222*(b$y.rotate-b$y.skewX),b$f=.0174532922222222*(b$y.rotate+b$y.skewY),b$V=Math.cos(b$f),b$K=Math.sin(b$f),b$k=Math.sin(b$S),b$X=Math.cos(b$S);return b$M.a=b$i*b$V,b$M.b=b$i*b$K,b$M.c=-b$H*b$k,b$M.d=b$H*b$X,b$M.tx=b$M.ty=0,b$M}return this._transform&&this._transform.destroy(),this._transform=null,this._renderType&=-5,b$M},b$M.pos=function(b$M,b$y,b$i){if(void 0===b$i&&(b$i=!1),this._x!==b$M||this._y!==b$y){if(this.destroyed)return this;if(b$i){this._x=b$M,this._y=b$y,this.conchModel&&this.conchModel.pos(this._x,this._y);var b$H=this._parent;b$H&&0===b$H._repaint&&(b$H._repaint=1,b$H.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}else this.x=b$M,this.y=b$y}return this},b$M.pivot=function(b$M,b$y){return this.pivotX=b$M,this.pivotY=b$y,this},b$M.size=function(b$M,b$y){return this.width=b$M,this.height=b$y,this},b$M.scale=function(b$M,b$y,b$i){void 0===b$i&&(b$i=!1);var b$H=this.getStyle(),b$S=b$H._tf;if(b$S.scaleX!=b$M||b$S.scaleY!=b$y){if(this.destroyed)return this;if(b$i){b$H.setScale(b$M,b$y),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(b$M,b$y),this._renderType|=4;var b$f=this._parent;b$f&&0===b$f._repaint&&(b$f._repaint=1,b$f.parentRepaint())}else this.scaleX=b$M,this.scaleY=b$y}return this},b$M.skew=function(b$M,b$y){return this.skewX=b$M,this.skewY=b$y,this},b$M.render=function(b$M,b$y,b$i){b$N.spriteCount++,b$w.renders[this._renderType]._fun(this,b$M,b$y+this._x,b$i+this._y),this._repaint=0},b$M.drawToCanvas=function(b$M,b$y,b$i,b$H){if(b$D.isConchNode){var b$S=b$RM.create("2D");return new b$z(b$M,b$y,b$S).ctx.setCanvasType(1),this.conchModel.drawToCanvas(b$S.source,b$i,b$H),b$S}return b$T.drawToCanvas(this,this._renderType,b$M,b$y,b$i,b$H)},b$M.customRender=function(b$M,b$y,b$i){this._renderType|=1024},b$M._applyFilters=function(){var b$M;if(!b$D.isWebGL&&((b$M=this._$P.filters)&&!(b$M.length<1)))for(var b$y=0,b$i=b$M.length;b$y<b$i;b$y++)b$M[b$y].action.apply(this._$P.cacheCanvas)},b$M._isHaveGlowFilter=function(){var b$M,b$y=0;if(this.filters)for(b$y=0;b$y<this.filters.length;b$y++)if(8==this.filters[b$y].type)return!0;for(b$y=0,b$M=this._childs.length;b$y<b$M;b$y++)if(this._childs[b$y]._isHaveGlowFilter())return!0;return!1},b$M.localToGlobal=function(b$M,b$y){void 0===b$y&&(b$y=!1),!0===b$y&&(b$M=new b$Q(b$M.x,b$M.y));for(var b$i=this;b$i&&b$i!=b$U.stage;)b$M=b$i.toParentPoint(b$M),b$i=b$i.parent;return b$M},b$M.globalToLocal=function(b$M,b$y){void 0===b$y&&(b$y=!1),b$y&&(b$M=new b$Q(b$M.x,b$M.y));for(var b$i=this,b$H=[];b$i&&b$i!=b$U.stage;)b$H.push(b$i),b$i=b$i.parent;for(var b$S=b$H.length-1;0<=b$S;)b$M=(b$i=b$H[b$S]).fromParentPoint(b$M),b$S--;return b$M},b$M.toParentPoint=function(b$M){if(!b$M)return b$M;b$M.x-=this.pivotX,b$M.y-=this.pivotY,this.transform&&this._transform.transformPoint(b$M),b$M.x+=this._x,b$M.y+=this._y;var b$y=this._style.scrollRect;return b$y&&(b$M.x-=b$y.x,b$M.y-=b$y.y),b$M},b$M.fromParentPoint=function(b$M){if(!b$M)return b$M;b$M.x-=this._x,b$M.y-=this._y;var b$y=this._style.scrollRect;return b$y&&(b$M.x+=b$y.x,b$M.y+=b$y.y),this.transform&&this._transform.invertTransformPoint(b$M),b$M.x+=this.pivotX,b$M.y+=this.pivotY,b$M},b$M.on=function(b$M,b$y,b$i,b$H){return 1!==this._mouseEnableState&&this.isMouseEvent(b$M)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(b$M,b$y,b$i,b$H,!1)):b$S.prototype.on.call(this,b$M,b$y,b$i,b$H)},b$M.once=function(b$M,b$y,b$i,b$H){return 1!==this._mouseEnableState&&this.isMouseEvent(b$M)?(this.mouseEnabled=!0,this._setBit(2,!0),this._parent&&this._$2__onDisplay(),this._createListener(b$M,b$y,b$i,b$H,!0)):b$S.prototype.once.call(this,b$M,b$y,b$i,b$H)},b$M._$2__onDisplay=function(){if(1!==this._mouseEnableState){var b$M=this;for(b$M=b$M.parent;b$M&&1!==b$M._mouseEnableState&&!b$M._getBit(2);)b$M.mouseEnabled=!0,b$M._setBit(2,!0),b$M=b$M.parent}},b$M.loadImage=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=this;return void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=0),void 0===b$S&&(b$S=0),this.graphics.loadImage(b$M,b$y,b$i,b$H,b$S,function(b$M){b$V.destroyed||(b$V.size(b$y+(b$H||b$M.width),b$i+(b$S||b$M.height)),b$V.repaint(),b$f&&b$f.runWith(b$M))}),this},b$M.repaint=function(){this.conchModel&&this.conchModel.repaint&&this.conchModel.repaint(),0===this._repaint&&(this._repaint=1,this.parentRepaint()),this._$P&&this._$P.maskParent&&this._$P.maskParent.repaint()},b$M._needRepaint=function(){return 0!==this._repaint&&this._$P.cacheCanvas&&this._$P.cacheCanvas.reCache},b$M._childChanged=function(b$M){this._childs.length?this._renderType|=2048:this._renderType&=-2049,b$M&&this._get$P("hasZorder")&&b$U.timer.callLater(this,this.updateZOrder),this.repaint()},b$M.parentRepaint=function(){var b$M=this._parent;b$M&&0===b$M._repaint&&(b$M._repaint=1,b$M.parentRepaint())},b$M.startDrag=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){void 0===b$y&&(b$y=!1),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=300),void 0===b$f&&(b$f=!1),void 0===b$V&&(b$V=.92),this._$P.dragging||this._set$P("dragging",new b$_),this._$P.dragging.start(this,b$M,b$y,b$i,b$H,b$S,b$f,b$V)},b$M.stopDrag=function(){this._$P.dragging&&this._$P.dragging.stop()},b$M._releaseMem=function(){if(this._$P){var b$M=this._$P.cacheCanvas;b$M&&b$M.ctx&&(b$r.recover("RenderContext",b$M.ctx),b$M.ctx.canvas.size(0,0),b$M.ctx=null);var b$y=this._$P._filterCache;b$y&&(b$y.destroy(),b$y.recycle(),this._set$P("_filterCache",null)),this._$P._isHaveGlowFilter&&this._set$P("_isHaveGlowFilter",!1),this._$P._isHaveGlowFilter=null}},b$M._setDisplay=function(b$M){b$M||this._releaseMem(),b$S.prototype._setDisplay.call(this,b$M)},b$M.hitTestPoint=function(b$M,b$y){var b$i=this.globalToLocal(b$Q.TEMP.setTo(b$M,b$y));return b$M=b$i.x,b$y=b$i.y,(this._$P.hitArea?this._$P.hitArea:0<this._width&&0<this._height?b$W.TEMP.setTo(0,0,this._width,this._height):this.getSelfBounds()).contains(b$M,b$y)},b$M.getMousePoint=function(){return this.globalToLocal(b$Q.TEMP.setTo(b$U.stage.mouseX,b$U.stage.mouseY))},b$M._getWords=function(){return null},b$M._addChildsToLayout=function(b$M){var b$y=this._getWords();if(null==b$y&&0==this._childs.length)return!1;if(b$y)for(var b$i=0,b$H=b$y.length;b$i<b$H;b$i++)b$M.push(b$y[b$i]);b$i=0;for(var b$S=this._childs.length;b$i<b$S;++b$i){var b$f=this._childs[b$i];b$f._style._enableLayout()&&b$f._addToLayout(b$M)}return!0},b$M._addToLayout=function(b$M){this._style.absolute||(this._style.block?b$M.push(this):this._addChildsToLayout(b$M)&&(this.x=this.y=0))},b$M._isChar=function(){return!1},b$M._getCSSStyle=function(){return this._style.getCSSStyle()},b$M._setAttributes=function(b$M,b$y){switch(b$M){case"x":this.x=parseFloat(b$y);break;case"y":this.y=parseFloat(b$y);break;case"width":this.width=parseFloat(b$y);break;case"height":this.height=parseFloat(b$y);break;default:this[b$M]=b$y}},b$M._layoutLater=function(){this.parent&&this.parent._layoutLater()},b$l(0,b$M,"optimizeScrollRect",function(){return this._optimizeScrollRect},function(b$M){this._optimizeScrollRect!=b$M&&(this._optimizeScrollRect=b$M,this.conchModel&&this.conchModel.optimizeScrollRect(b$M))}),b$l(0,b$M,"customRenderEnable",null,function(b$M){if(b$M&&(this._renderType|=1024,b$D.isConchNode)){b$i.CustomList.push(this);var b$y=new b$RM("2d");b$y._setContext(new CanvasRenderingContext2D),this.customContext=new b$z(0,0,b$y),b$y.context.setCanvasType&&b$y.context.setCanvasType(2),this.conchModel.custom(b$y.context)}}),b$l(0,b$M,"cacheAsBitmap",function(){return"none"!==this.cacheAs},function(b$M){this.cacheAs=b$M?this._$P.hasFilter?"none":"normal":"none"}),b$l(0,b$M,"cacheAs",function(){return null==this._$P.cacheCanvas?"none":this._$P.cacheCanvas.type},function(b$M){var b$y=this._$P.cacheCanvas;if(b$M!==(b$y?b$y.type:"none")){if("none"!==b$M)this._getBit(1)||this._setUpNoticeType(1),b$y||(b$y=this._set$P("cacheCanvas",b$r.getItemByClass("cacheCanvas",Object))),b$y.type=b$M,b$y.reCache=!0,this._renderType|=16,"bitmap"==b$M&&this.conchModel&&this.conchModel.cacheAs(1),this._set$P("cacheForFilters",!1);else if(this._$P._mask);else if(this._$P.hasFilter)this._set$P("cacheForFilters",!0);else{if(b$y){var b$i=b$y;b$i&&b$i.ctx&&(b$r.recover("RenderContext",b$i.ctx),b$i.ctx.canvas.size(0,0),b$i.ctx=null),b$r.recover("cacheCanvas",b$y)}this._$P.cacheCanvas=null,this._renderType&=-17,this.conchModel&&this.conchModel.cacheAs(0)}this.repaint()}}),b$l(0,b$M,"zOrder",function(){return this._zOrder},function(b$M){this._zOrder!=b$M&&(this._zOrder=b$M,this.conchModel&&this.conchModel.setZOrder&&this.conchModel.setZOrder(b$M),this._parent&&(b$M&&this._parent._set$P("hasZorder",!0),b$U.timer.callLater(this._parent,this.updateZOrder)))}),b$l(0,b$M,"rotation",function(){return this._style._tf.rotate},function(b$M){var b$y=this.getStyle();if(b$y._tf.rotate!==b$M){b$y.setRotate(b$M),this._tfChanged=!0,this.conchModel&&this.conchModel.rotate(b$M),this._renderType|=4;var b$i=this._parent;b$i&&0===b$i._repaint&&(b$i._repaint=1,b$i.parentRepaint())}}),b$l(0,b$M,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(b$M){this._width!==b$M&&(this._width=b$M,this.conchModel&&this.conchModel.size(b$M,this._height),this.repaint())}),b$l(0,b$M,"x",function(){return this._x},function(b$M){if(this._x!==b$M){if(this.destroyed)return;this._x=b$M,this.conchModel&&this.conchModel.pos(b$M,this._y);var b$y=this._parent;b$y&&0===b$y._repaint&&(b$y._repaint=1,b$y.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),b$l(0,b$M,"globalScaleY",function(){for(var b$M=1,b$y=this;b$y&&b$y!==b$U.stage;)b$M*=b$y.scaleY,b$y=b$y.parent;return b$M}),b$l(0,b$M,"hitArea",function(){return this._$P.hitArea},function(b$M){this._set$P("hitArea",b$M)}),b$l(0,b$M,"staticCache",function(){return this._$P.staticCache},function(b$M){this._set$P("staticCache",b$M),b$M||this.reCache()}),b$l(0,b$M,"texture",function(){return this._texture},function(b$M){this._texture!=b$M&&(this._texture=b$M,this.graphics.cleanByTexture(b$M,0,0))}),b$l(0,b$M,"y",function(){return this._y},function(b$M){if(this._y!==b$M){if(this.destroyed)return;this._y=b$M,this.conchModel&&this.conchModel.pos(this._x,b$M);var b$y=this._parent;b$y&&0===b$y._repaint&&(b$y._repaint=1,b$y.parentRepaint()),this._$P.maskParent&&0===this._$P.maskParent._repaint&&(this._$P.maskParent._repaint=1,this._$P.maskParent.parentRepaint())}}),b$l(0,b$M,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(b$M){this._height!==b$M&&(this._height=b$M,this.conchModel&&this.conchModel.size(this._width,b$M),this.repaint())}),b$l(0,b$M,"blendMode",function(){return this._style.blendMode},function(b$M){this.getStyle().blendMode=b$M,this.conchModel&&this.conchModel.blendMode(b$M),b$M&&"source-over"!=b$M?this._renderType|=8:this._renderType&=-9,this.parentRepaint()}),b$l(0,b$M,"scaleX",function(){return this._style._tf.scaleX},function(b$M){var b$y=this.getStyle();if(b$y._tf.scaleX!==b$M){b$y.setScaleX(b$M),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(b$M,b$y._tf.scaleY),this._renderType|=4;var b$i=this._parent;b$i&&0===b$i._repaint&&(b$i._repaint=1,b$i.parentRepaint())}}),b$l(0,b$M,"scaleY",function(){return this._style._tf.scaleY},function(b$M){var b$y=this.getStyle();if(b$y._tf.scaleY!==b$M){b$y.setScaleY(b$M),this._tfChanged=!0,this.conchModel&&this.conchModel.scale(b$y._tf.scaleX,b$M),this._renderType|=4;var b$i=this._parent;b$i&&0===b$i._repaint&&(b$i._repaint=1,b$i.parentRepaint())}}),b$l(0,b$M,"stage",function(){return b$U.stage}),b$l(0,b$M,"skewX",function(){return this._style._tf.skewX},function(b$M){var b$y=this.getStyle();if(b$y._tf.skewX!==b$M){b$y.setSkewX(b$M),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(b$M,b$y._tf.skewY),this._renderType|=4;var b$i=this._parent;b$i&&0===b$i._repaint&&(b$i._repaint=1,b$i.parentRepaint())}}),b$l(0,b$M,"scrollRect",function(){return this._style.scrollRect},function(b$M){this.getStyle().scrollRect=b$M,this.repaint(),b$M?(this._renderType|=128,this.conchModel&&this.conchModel.scrollRect(b$M.x,b$M.y,b$M.width,b$M.height)):(this._renderType&=-129,this.conchModel&&(b$i.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(64):this.conchModel.removeType(128)))}),b$l(0,b$M,"skewY",function(){return this._style._tf.skewY},function(b$M){var b$y=this.getStyle();if(b$y._tf.skewY!==b$M){b$y.setSkewY(b$M),this._tfChanged=!0,this.conchModel&&this.conchModel.skew(b$y._tf.skewX,b$M),this._renderType|=4;var b$i=this._parent;b$i&&0===b$i._repaint&&(b$i._repaint=1,b$i.parentRepaint())}}),b$l(0,b$M,"transform",function(){return this._tfChanged?this._adjustTransform():this._transform},function(b$M){this._tfChanged=!1,(this._transform=b$M)&&(this._x=b$M.tx,this._y=b$M.ty,b$M.tx=b$M.ty=0,this.conchModel&&this.conchModel.transform(b$M.a,b$M.b,b$M.c,b$M.d,this._x,this._y)),b$M?this._renderType|=4:(this._renderType&=-5,this.conchModel&&this.conchModel.removeType(4)),this.parentRepaint()}),b$l(0,b$M,"pivotX",function(){return this._style._tf.translateX},function(b$M){this.getStyle().setTranslateX(b$M),this.conchModel&&this.conchModel.pivot(b$M,this._style._tf.translateY),this.repaint()}),b$l(0,b$M,"pivotY",function(){return this._style._tf.translateY},function(b$M){this.getStyle().setTranslateY(b$M),this.conchModel&&this.conchModel.pivot(this._style._tf.translateX,b$M),this.repaint()}),b$l(0,b$M,"alpha",function(){return this._style.alpha},function(b$M){this._style&&this._style.alpha!==b$M&&(b$M=b$M<0?0:1<b$M?1:b$M,this.getStyle().alpha=b$M,this.conchModel&&this.conchModel.alpha(b$M),1!==b$M?this._renderType|=2:this._renderType&=-3,this.parentRepaint())}),b$l(0,b$M,"visible",function(){return this._style.visible},function(b$M){this._style&&this._style.visible!==b$M&&(this.getStyle().visible=b$M,this.conchModel&&this.conchModel.visible(b$M),this.parentRepaint())}),b$l(0,b$M,"graphics",function(){return this._graphics||(this.graphics=b$T.createGraphics())},function(b$M){this._graphics&&(this._graphics._sp=null),(this._graphics=b$M)?(this._renderType&=-2,this._renderType|=512,(b$M._sp=this).conchModel&&this.conchModel.graphics(this._graphics)):(this._renderType&=-513,this._renderType&=-2,this.conchModel&&(b$i.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(256):this.conchModel.removeType(512))),this.repaint()}),b$l(0,b$M,"filters",function(){return this._$P.filters},function(b$M){b$M&&0===b$M.length&&(b$M=null),this._$P.filters!=b$M&&(this._set$P("filters",b$M?b$M.slice():null),b$D.isConchApp&&(this.conchModel&&(b$i.RUNTIMEVERION<"0.9.1"?this.conchModel.removeType(16):this.conchModel.removeType(32)),this._$P.filters&&1==this._$P.filters.length&&this._$P.filters[0].callNative(this)),b$D.isWebGL&&(b$M&&b$M.length?this._renderType|=32:this._renderType&=-33),b$M&&0<b$M.length?(this._getBit(1)||this._setUpNoticeType(1),b$D.isWebGL&&1==b$M.length&&b$M[0]instanceof laya.filters.ColorFilter||("bitmap"!=this.cacheAs&&(b$D.isConchNode||(this.cacheAs="bitmap"),this._set$P("cacheForFilters",!0)),this._set$P("hasFilter",!0))):(this._set$P("hasFilter",!1),this._$P.cacheForFilters&&"bitmap"==this.cacheAs&&(this.cacheAs="none")),this.repaint())}),b$l(0,b$M,"parent",b$S.prototype._$get_parent,function(b$M){b$U.superSet(b$MM,this,"parent",b$M),b$M&&this._getBit(2)&&this._$2__onDisplay()}),b$l(0,b$M,"mask",function(){return this._$P._mask},function(b$M){b$M&&this.mask&&this.mask._$P.maskParent||(b$M?(this.cacheAs="bitmap",this._set$P("_mask",b$M),b$M._set$P("maskParent",this)):(this.mask&&this.mask._set$P("maskParent",null),this._set$P("_mask",b$M),this.cacheAs="none"),this.conchModel&&this.conchModel.mask(b$M?b$M.conchModel:null),this._renderType|=64,this.parentRepaint())}),b$l(0,b$M,"mouseEnabled",function(){return 1<this._mouseEnableState},function(b$M){this._mouseEnableState=b$M?2:1}),b$l(0,b$M,"globalScaleX",function(){for(var b$M=1,b$y=this;b$y&&b$y!==b$U.stage;)b$M*=b$y.scaleX,b$y=b$y.parent;return b$M}),b$l(0,b$M,"mouseX",function(){return this.getMousePoint().x}),b$l(0,b$M,"mouseY",function(){return this.getMousePoint().y}),b$i.fromImage=function(b$M){return(new b$i).loadImage(b$M)},b$i._cachePool=[],b$i.CustomList=[],b$k(b$i,["RUNTIMEVERION",function(){return this.RUNTIMEVERION=b$V.conch?conchConfig.getRuntimeVersion().substr(conchConfig.getRuntimeVersion().lastIndexOf("-")+1):""}]),b$i}(b$MM),b$dM=function(b$M){function b$y(b$M){this._audio=null,this._onEnd=null,this._resumePlay=null,b$y.__super.call(this),this._onEnd=b$g.bind(this.__onEnd,this),this._resumePlay=b$g.bind(this.__resumePlay,this),b$M.addEventListener("ended",this._onEnd),this._audio=b$M}b$F(b$y,"laya.media.h5audio.AudioSoundChannel",b$HM);var b$i=b$y.prototype;return b$i.__onEnd=function(){if(1==this.loops)return this.completeHandler&&(b$U.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},b$i.__resumePlay=function(){this._audio&&this._audio.removeEventListener("canplay",this._resumePlay);try{this._audio.currentTime=this.startTime,b$u.container.appendChild(this._audio),this._audio.play()}catch(b$M){this.event("error")}},b$i.play=function(b$M){this.isStopped=!1;try{this._audio.playbackRate=b$a.playbackRate,this._audio.currentTime=this.startTime}catch(b$M){return void this._audio.addEventListener("canplay",this._resumePlay)}b$a.addChannel(this),b$u.container.appendChild(this._audio),!b$M&&this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play()},b$i.stop=function(){this.isStopped=!0,b$a.removeChannel(this),this.startHandler=null,this.completeHandler=null,this._audio&&("pause"in this._audio&&b$D.isConchApp&&this._audio.stop(),this._audio.pause(),this._audio.removeEventListener("ended",this._onEnd),this._audio.removeEventListener("canplay",this._resumePlay),b$u.onIE||this._audio!=b$iM._musicAudio&&b$r.recover("audio:"+this.url,this._audio),b$u.removeElement(this._audio),this._audio=null)},b$i.pause=function(){this.isStopped=!0,b$a.removeChannel(this),"pause"in this._audio&&this._audio.pause()},b$i.resume=function(){this._audio&&(this.isStopped=!1,b$a.addChannel(this),this.startHandler&&this.startHandler.runWith(this),"play"in this._audio&&this._audio.play())},b$l(0,b$i,"position",function(){return this._audio?this._audio.currentTime:0}),b$l(0,b$i,"duration",function(){return this._audio?this._audio.duration:0}),b$l(0,b$i,"volume",function(){return this._audio?this._audio.volume:1},function(b$M){this._audio&&(this._audio.volume=b$M)}),b$y}(),b$PM=function(b$M){function b$y(){this.audioBuffer=null,this.gain=null,this.bufferSource=null,this._currentTime=0,this._volume=1,this._startTime=0,this._pauseTime=0,this._onPlayEnd=null,this.context=b$fM.ctx,b$y.__super.call(this),this._onPlayEnd=b$g.bind(this.__onPlayEnd,this),this.context.createGain?this.gain=this.context.createGain():this.gain=this.context.createGainNode()}b$F(b$y,"laya.media.webaudio.WebAudioSoundChannel",b$HM);var b$i=b$y.prototype;return b$i.play=function(b$M){if(b$a.addChannel(this),this.isStopped=!1,this._clearBufferSource(),this.audioBuffer){var b$y=this.context,b$i=this.gain,b$H=b$y.createBufferSource();(this.bufferSource=b$H).buffer=this.audioBuffer,b$H.connect(b$i),b$i&&b$i.disconnect(),b$i.connect(b$y.destination),b$H.onended=this._onPlayEnd,this.startTime>=this.duration&&(this.startTime=0),this._startTime=b$u.now(),this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(this._volume,this.context.currentTime,.1):this.gain.gain.value=this._volume,0==this.loops&&(b$H.loop=!0),b$H.playbackRate.setTargetAtTime?b$H.playbackRate.setTargetAtTime(b$a.playbackRate,this.context.currentTime,.1):b$H.playbackRate.value=b$a.playbackRate,b$H.start(0,this.startTime),!b$M&&this.startHandler&&this.startHandler.runWith(this),this._currentTime=0}},b$i.__onPlayEnd=function(){if(1==this.loops)return this.completeHandler&&(b$U.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play(!0)},b$i._clearBufferSource=function(){if(this.bufferSource){var b$M=this.bufferSource;b$M.stop?b$M.stop(0):b$M.noteOff(0),b$M.disconnect(0),b$M.onended=null,b$y._tryCleanFailed||this._tryClearBuffer(b$M),this.bufferSource=null}},b$i._tryClearBuffer=function(b$M){try{b$M.buffer=null}catch(b$M){b$y._tryCleanFailed=!0}},b$i.stop=function(){this._clearBufferSource(),this.audioBuffer=null,this.gain&&this.gain.disconnect(),this.isStopped=!0,b$a.removeChannel(this),this.startHandler=null,this.completeHandler=null},b$i.pause=function(){this.isStopped||(this._pauseTime=this.position),this._clearBufferSource(),this.gain&&this.gain.disconnect(),this.isStopped=!0,b$a.removeChannel(this)},b$i.resume=function(){this.startTime=this._pauseTime,this.play(!1)},b$l(0,b$i,"position",function(){return this.bufferSource?(b$u.now()-this._startTime)/1e3+this.startTime:0}),b$l(0,b$i,"duration",function(){return this.audioBuffer?this.audioBuffer.duration:0}),b$l(0,b$i,"volume",function(){return this._volume},function(b$M){this.isStopped||(this._volume=b$M,this.gain.gain.setTargetAtTime?this.gain.gain.setTargetAtTime(b$M,this.context.currentTime,.1):this.gain.gain.value=b$M)}),b$y._tryCleanFailed=!1,b$y}(),b$lM=function(b$M){function b$y(){b$y.__super.call(this),this._w=0,this._h=0}b$F(b$y,"laya.resource.Bitmap",b$XM);var b$i=b$y.prototype;return b$l(0,b$i,"width",function(){return this._w}),b$l(0,b$i,"height",function(){return this._h}),b$l(0,b$i,"source",function(){return this._source}),b$y}(),b$JM=function(b$y){function b$M(){this.loop=!1,this.wrapMode=0,this._index=0,this._count=0,this._isPlaying=!1,this._labels=null,this._isReverse=!1,this._frameRateChanged=!1,this._controlNode=null,this._actionName=null,b$M.__super.call(this),this._interval=b$H.animationInterval,this._setUpNoticeType(1)}b$F(b$M,"laya.display.AnimationPlayerBase",b$y);var b$i=b$M.prototype;return b$i.play=function(b$M,b$y,b$i,b$H){void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=!0),void 0===b$i&&(b$i=""),void 0===b$H&&(b$H=!0),this._isPlaying=!0,this.index="string"==typeof b$M?this._getFrameByLabel(b$M):b$M,this.loop=b$y,this._actionName=b$i,this._isReverse=1==this.wrapMode,0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},b$i._getFrameByLabel=function(b$M){var b$y=0;for(b$y=0;b$y<this._count;b$y++)if(this._labels[b$y]&&0<=this._labels[b$y].indexOf(b$M))return b$y;return 0},b$i._frameLoop=function(){if(this._isReverse){if(this._index--,this._index<0){if(!this.loop)return this._index=0,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<this._count?1:0,this._isReverse=!1):this._index=this._count-1,this.event("complete")}}else if(this._index++,this._index>=this._count){if(!this.loop)return this._index--,this.stop(),void this.event("complete");2==this.wrapMode?(this._index=0<=this._count-2?this._count-2:0,this._isReverse=!0):this._index=0,this.event("complete")}this.index=this._index},b$i._setControlNode=function(b$M){this._controlNode&&(this._controlNode.off("display",this,this._checkResumePlaying),this._controlNode.off("undisplay",this,this._checkResumePlaying)),(this._controlNode=b$M)&&b$M!=this&&(b$M.on("display",this,this._checkResumePlaying),b$M.on("undisplay",this,this._checkResumePlaying))},b$i._setDisplay=function(b$M){b$y.prototype._setDisplay.call(this,b$M),this._checkResumePlaying()},b$i._checkResumePlaying=function(){this._isPlaying&&(this._controlNode.displayedInStage?this.play(this._index,this.loop,this._actionName):this.clearTimer(this,this._frameLoop))},b$i.stop=function(){this._isPlaying=!1,this.clearTimer(this,this._frameLoop)},b$i.addLabel=function(b$M,b$y){this._labels||(this._labels={}),this._labels[b$y]||(this._labels[b$y]=[]),this._labels[b$y].push(b$M)},b$i.removeLabel=function(b$M){if(b$M){if(this._labels)for(var b$y in this._labels)this._removeLabelFromLabelList(this._labels[b$y],b$M)}else this._labels=null},b$i._removeLabelFromLabelList=function(b$M,b$y){if(b$M)for(var b$i=b$M.length-1;0<=b$i;b$i--)b$M[b$i]==b$y&&b$M.splice(b$i,1)},b$i.gotoAndStop=function(b$M){this.index="string"==typeof b$M?this._getFrameByLabel(b$M):b$M,this.stop()},b$i._displayToIndex=function(b$M){},b$i.clear=function(){this.stop(),this._labels=null},b$l(0,b$i,"interval",function(){return this._interval},function(b$M){this._interval!=b$M&&(this._frameRateChanged=!0,this._interval=b$M,this._isPlaying&&0<b$M&&this.timerLoop(b$M,this,this._frameLoop,null,!0,!0))}),b$l(0,b$i,"isPlaying",function(){return this._isPlaying}),b$l(0,b$i,"index",function(){return this._index},function(b$M){if(this._index=b$M,this._displayToIndex(b$M),this._labels&&this._labels[b$M])for(var b$y=this._labels[b$M],b$i=0,b$H=b$y.length;b$i<b$H;b$i++)this.event("label",b$y[b$i])}),b$l(0,b$i,"count",function(){return this._count}),b$M.WRAP_POSITIVE=0,b$M.WRAP_REVERSE=1,b$M.WRAP_PINGPONG=2,b$M}(b$oM),b$hM=function(b$y){function b$P(){this._clipPoint=null,this._currBitmapFont=null,this._text=null,this._isChanged=!1,this._textWidth=0,this._textHeight=0,this._lines=[],this._lineWidths=[],this._startX=NaN,this._startY=NaN,this._lastVisibleLineIndex=-1,this._words=null,this._charSize={},this.underline=!1,this._underlineColor=null,b$P.__super.call(this),this.overflow=b$P.VISIBLE,this._style=new b$yM(this),this._style.wordWrap=!1}b$F(b$P,"laya.display.Text",b$y);var b$M=b$P.prototype;return b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,b$M),this._lines=null,this._words&&(this._words.length=0,this._words=null)},b$M._getBoundPointsM=function(b$M){void 0===b$M&&(b$M=!1);var b$y=b$W.TEMP;return b$y.setTo(0,0,this.width,this.height),b$y._getBoundPoints()},b$M.getGraphicBounds=function(b$M){void 0===b$M&&(b$M=!1);var b$y=b$W.TEMP;return b$y.setTo(0,0,this.width,this.height),b$y},b$M._getCSSStyle=function(){return this._style},b$M.lang=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F){if(b$M=b$P.langPacks&&b$P.langPacks[b$M]?b$P.langPacks[b$M]:b$M,arguments.length<2)this._text=b$M;else{for(var b$o=0,b$d=arguments.length;b$o<b$d;b$o++)b$M=b$M.replace("{"+b$o+"}",arguments[b$o+1]);this._text=b$M}},b$M._isPassWordMode=function(){var b$M=this._style.password;return"prompt"in this&&this.prompt==this._text&&(b$M=!1),b$M},b$M._getPassWordTxt=function(b$M){var b$y;b$y="";for(var b$i=b$M.length;0<b$i;b$i--)b$y+="●";return b$y},b$M.renderText=function(b$M,b$y){var b$i=this.graphics;b$i.clear(!0);var b$H=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+(b$u.onIPhone&&laya.display.Text._fontFamilyMap[this.font]||this.font);b$u.context.font=b$H;var b$S=this.padding,b$f=b$S[3],b$V="left",b$K=this._lines,b$k=this.leading+this._charSize.height,b$X=this._currBitmapFont;b$X&&(b$k=this.leading+b$X.getMaxHeight());var b$F=b$S[0];if(!b$X&&0<this._width&&this._textWidth<=this._width&&("right"==this.align?(b$V="right",b$f=this._width-b$S[1]):"center"==this.align&&(b$V="center",b$f=.5*this._width+b$S[3]-b$S[1])),0<this._height){var b$o=this._textHeight>this._height?"top":this.valign;"middle"===b$o?b$F=.5*(this._height-b$y*b$k)+b$S[0]-b$S[2]:"bottom"===b$o&&(b$F=this._height-b$y*b$k-b$S[2])}var b$d=this._style;if(b$X&&b$X.autoScaleSize)var b$P=b$X.fontSize/this.fontSize;if(this._clipPoint)if(b$i.save(),b$X&&b$X.autoScaleSize){var b$l=0,b$J=0;b$l=this._width?this._width-b$S[3]-b$S[1]:this._textWidth,b$J=this._height?this._height-b$S[0]-b$S[2]:this._textHeight,b$l*=b$P,b$J*=b$P,b$i.clipRect(b$S[3],b$S[0],b$l,b$J)}else b$i.clipRect(b$S[3],b$S[0],this._width?this._width-b$S[3]-b$S[1]:this._textWidth,this._height?this._height-b$S[0]-b$S[2]:this._textHeight);var b$h=b$d.password;"prompt"in this&&this.prompt==this._text&&(b$h=!1);for(var b$C=0,b$v=0,b$R=Math.min(this._lines.length,b$y+b$M)||1,b$A=b$M;b$A<b$R;b$A++){var b$G,b$I=b$K[b$A];if(b$h){var b$U=b$I.length;b$I="";for(var b$Q=b$U;0<b$Q;b$Q--)b$I+="●"}if(b$C=b$f-(this._clipPoint?this._clipPoint.x:0),b$v=b$F+b$k*b$A-(this._clipPoint?this._clipPoint.y:0),this.underline&&this.drawUnderline(b$V,b$C,b$v,b$A),b$X){var b$W=this.width;b$X.autoScaleSize&&(b$W=this.width*b$P),b$X.drawText(b$I,this,b$C,b$v,this.align,b$W)}else b$D.isWebGL?(this._words||(this._words=[]),(b$G=this._words.length>b$A-b$M?this._words[b$A-b$M]:new b$L).setText(b$I)):b$G=b$I,b$d.stroke?b$i.fillBorderText(b$G,b$C,b$v,b$H,this.color,b$d.strokeColor,b$d.stroke,b$V):b$i.fillText(b$G,b$C,b$v,b$H,this.color,b$V)}if(b$X&&b$X.autoScaleSize){var b$c=1/b$P;this.scale(b$c,b$c)}this._clipPoint&&b$i.restore(),this._startX=b$f,this._startY=b$F},b$M.drawUnderline=function(b$M,b$y,b$i,b$H){var b$S=this._lineWidths[b$H];switch(b$M){case"center":b$y-=b$S/2;break;case"right":b$y-=b$S}b$i+=this._charSize.height,this._graphics.drawLine(b$y,b$i,b$y+b$S,b$i,this.underlineColor||this.color,1)},b$M.typeset=function(){if(this._isChanged=!1,!this._text)return this._clipPoint=null,this._textWidth=this._textHeight=0,void this.graphics.clear(!0);b$u.context.font=this._getCSSStyle().font,this._lines.length=0,this._lineWidths.length=0,this._isPassWordMode()?this.parseLines(this._getPassWordTxt(this._text)):this.parseLines(this._text),this.evalTextSize(),this.checkEnabledViewportOrNot()?this._clipPoint||(this._clipPoint=new b$Q(0,0)):this._clipPoint=null;var b$M=this._lines.length;if(this.overflow!=b$P.VISIBLE){var b$y=this.overflow==b$P.HIDDEN?Math.floor:Math.ceil;b$M=Math.min(b$M,b$y((this.height-this.padding[0]-this.padding[2])/(this.leading+this._charSize.height)))}var b$i=this.scrollY/(this._charSize.height+this.leading)|0;this.renderText(b$i,b$M),this.repaint()},b$M.evalTextSize=function(){var b$M,b$y=NaN;b$M=Math.max.apply(this,this._lineWidths),b$y=this._currBitmapFont?this._lines.length*(this._currBitmapFont.getMaxHeight()+this.leading)+this.padding[0]+this.padding[2]:this._lines.length*(this._charSize.height+this.leading)+this.padding[0]+this.padding[2],b$M==this._textWidth&&b$y==this._textHeight||(this._textWidth=b$M,this._textHeight=b$y,this._width&&this._height||this.conchModel&&this.conchModel.size(this._width||this._textWidth,this._height||this._textHeight))},b$M.checkEnabledViewportOrNot=function(){return this.overflow==b$P.SCROLL&&(0<this._width&&this._textWidth>this._width||0<this._height&&this._textHeight>this._height)},b$M.changeText=function(b$M){this._text!==b$M&&(this.lang(b$M+""),this._graphics&&this._graphics.replaceText(this._text)||this.typeset())},b$M.parseLines=function(b$M){var b$y=this.wordWrap||this.overflow==b$P.HIDDEN;if(b$y)var b$i=this.getWordWrapWidth();if(this._currBitmapFont)this._charSize.width=this._currBitmapFont.getMaxWidth(),this._charSize.height=this._currBitmapFont.getMaxHeight();else{var b$H=b$u.context.measureText(b$P._testWord);b$D.isConchApp&&0===b$H.width&&0===b$H.height&&(b$H=b$u.context.measureText("W")),this._charSize.width=b$H.width,this._charSize.height=b$H.height||this.fontSize}for(var b$S=b$M.replace(/\r\n/g,"\n").split("\n"),b$f=0,b$V=b$S.length;b$f<b$V;b$f++){var b$K=b$S[b$f];b$y?this.parseLine(b$K,b$i):(this._lineWidths.push(this.getTextWidth(b$K)),this._lines.push(b$K))}},b$M.parseLine=function(b$M,b$y){b$u.context;var b$i,b$H=this._lines,b$S=0,b$f=NaN,b$V=NaN,b$K=0;if((b$f=this.getTextWidth(b$M))<=b$y)return b$H.push(b$M),void this._lineWidths.push(b$f);b$f=this._charSize.width,0==(b$S=Math.floor(b$y/b$f))&&(b$S=1),b$V=b$f=this.getTextWidth(b$M.substring(0,b$S));for(var b$k=b$S,b$X=b$M.length;b$k<b$X;b$k++)if(b$y<(b$V+=b$f=this.getTextWidth(b$M.charAt(b$k))))if(this.wordWrap){var b$F=b$M.substring(b$K,b$k);if(b$F.charCodeAt(b$F.length-1)<255?(b$i=/(?:\w|-)+$/.exec(b$F))&&(b$k=b$i.index+b$K,0==b$i.index?b$k+=b$F.length:b$F=b$M.substring(b$K,b$k)):b$P.RightToLeft&&(b$i=/([\u0600-\u06FF])+$/.exec(b$F))&&(b$k=b$i.index+b$K,0==b$i.index?b$k+=b$F.length:b$F=b$M.substring(b$K,b$k)),b$H.push(b$F),this._lineWidths.push(b$V-b$f),!((b$K=b$k)+b$S<b$X)){b$H.push(b$M.substring(b$K,b$X)),this._lineWidths.push(this.getTextWidth(b$H[b$H.length-1])),b$K=-1;break}b$k+=b$S,b$V=b$f=this.getTextWidth(b$M.substring(b$K,b$k)),b$k--}else if(this.overflow==b$P.HIDDEN)return b$H.push(b$M.substring(0,b$k)),void this._lineWidths.push(this.getTextWidth(b$H[b$H.length-1]));this.wordWrap&&-1!=b$K&&(b$H.push(b$M.substring(b$K,b$X)),this._lineWidths.push(this.getTextWidth(b$H[b$H.length-1])))},b$M.getTextWidth=function(b$M){return this._currBitmapFont?this._currBitmapFont.getTextWidth(b$M):b$u.context.measureText(b$M).width},b$M.getWordWrapWidth=function(){var b$M=this.padding,b$y=NaN;return(b$y=this._currBitmapFont&&this._currBitmapFont.autoScaleSize?this._width*(this._currBitmapFont.fontSize/this.fontSize):this._width)<=0&&(b$y=this.wordWrap?100:b$u.width),b$y<=0&&(b$y=100),b$y-b$M[3]-b$M[1]},b$M.getCharPoint=function(b$M,b$y){this._isChanged&&b$U.timer.runCallLater(this,this.typeset);for(var b$i=0,b$H=this._lines,b$S=0,b$f=0,b$V=b$H.length;b$f<b$V;b$f++){if(b$M<(b$i+=b$H[b$f].length)){var b$K=b$f;break}b$S=b$i}var b$k=(this.italic?"italic ":"")+(this.bold?"bold ":"")+this.fontSize+"px "+this.font;b$u.context.font=b$k;var b$X=this.getTextWidth(this._text.substring(b$S,b$M));return(b$y||new b$Q).setTo(this._startX+b$X-(this._clipPoint?this._clipPoint.x:0),this._startY+b$K*(this._charSize.height+this.leading)-(this._clipPoint?this._clipPoint.y:0))},b$l(0,b$M,"width",function(){return this._width?this._width:this.textWidth+this.padding[1]+this.padding[3]},function(b$M){b$M!=this._width&&(b$U.superSet(b$oM,this,"width",b$M),this.isChanged=!0)}),b$l(0,b$M,"textWidth",function(){return this._isChanged&&b$U.timer.runCallLater(this,this.typeset),this._textWidth}),b$l(0,b$M,"height",function(){return this._height?this._height:this.textHeight},function(b$M){b$M!=this._height&&(b$U.superSet(b$oM,this,"height",b$M),this.isChanged=!0)}),b$l(0,b$M,"textHeight",function(){return this._isChanged&&b$U.timer.runCallLater(this,this.typeset),this._textHeight}),b$l(0,b$M,"padding",function(){return this._getCSSStyle().padding},function(b$M){this._getCSSStyle().padding=b$M,this.isChanged=!0}),b$l(0,b$M,"bold",function(){return this._getCSSStyle().bold},function(b$M){this._getCSSStyle().bold=b$M,this.isChanged=!0}),b$l(0,b$M,"text",function(){return this._text||""},function(b$M){this._text!==b$M&&(this.lang(b$M+""),this.isChanged=!0,this.event("change"))}),b$l(0,b$M,"color",function(){return this._getCSSStyle().color},function(b$M){this._getCSSStyle().color!=b$M&&(this._getCSSStyle().color=b$M,!this._isChanged&&this._graphics?this._graphics.replaceTextColor(this.color):this.isChanged=!0)}),b$l(0,b$M,"font",function(){return this._getCSSStyle().fontFamily},function(b$M){this._currBitmapFont&&(this._currBitmapFont=null,this.scale(1,1)),b$P._bitmapFonts&&b$P._bitmapFonts[b$M]&&(this._currBitmapFont=b$P._bitmapFonts[b$M]),this._getCSSStyle().fontFamily=b$M,this.isChanged=!0}),b$l(0,b$M,"fontSize",function(){return this._getCSSStyle().fontSize},function(b$M){this._getCSSStyle().fontSize=b$M,this.isChanged=!0}),b$l(0,b$M,"italic",function(){return this._getCSSStyle().italic},function(b$M){this._getCSSStyle().italic=b$M,this.isChanged=!0}),b$l(0,b$M,"align",function(){return this._getCSSStyle().align},function(b$M){this._getCSSStyle().align=b$M,this.isChanged=!0}),b$l(0,b$M,"valign",function(){return this._getCSSStyle().valign},function(b$M){this._getCSSStyle().valign=b$M,this.isChanged=!0}),b$l(0,b$M,"wordWrap",function(){return this._getCSSStyle().wordWrap},function(b$M){this._getCSSStyle().wordWrap=b$M,this.isChanged=!0}),b$l(0,b$M,"leading",function(){return this._getCSSStyle().leading},function(b$M){this._getCSSStyle().leading=b$M,this.isChanged=!0}),b$l(0,b$M,"bgColor",function(){return this._getCSSStyle().backgroundColor},function(b$M){this._getCSSStyle().backgroundColor=b$M,this.isChanged=!0}),b$l(0,b$M,"borderColor",function(){return this._getCSSStyle().borderColor},function(b$M){this._getCSSStyle().borderColor=b$M,this.isChanged=!0}),b$l(0,b$M,"stroke",function(){return this._getCSSStyle().stroke},function(b$M){this._getCSSStyle().stroke=b$M,this.isChanged=!0}),b$l(0,b$M,"strokeColor",function(){return this._getCSSStyle().strokeColor},function(b$M){this._getCSSStyle().strokeColor=b$M,this.isChanged=!0}),b$l(0,b$M,"isChanged",null,function(b$M){this._isChanged!==b$M&&(this._isChanged=b$M)&&b$U.timer.callLater(this,this.typeset)}),b$l(0,b$M,"scrollX",function(){return this._clipPoint?this._clipPoint.x:0},function(b$M){if(!(this.overflow!=b$P.SCROLL||this.textWidth<this._width)&&this._clipPoint){b$M=b$M<this.padding[3]?this.padding[3]:b$M;var b$y=this._textWidth-this._width;b$M=b$y<b$M?b$y:b$M;var b$i=this._height/(this._charSize.height+this.leading)|1;this._clipPoint.x=b$M,this.renderText(this._lastVisibleLineIndex,b$i)}}),b$l(0,b$M,"scrollY",function(){return this._clipPoint?this._clipPoint.y:0},function(b$M){if(!(this.overflow!=b$P.SCROLL||this.textHeight<this._height)&&this._clipPoint){b$M=b$M<this.padding[0]?this.padding[0]:b$M;var b$y=this._textHeight-this._height,b$i=(b$M=b$y<b$M?b$y:b$M)/(this._charSize.height+this.leading)|0;this._lastVisibleLineIndex=b$i;var b$H=1+(this._height/(this._charSize.height+this.leading)|0);this._clipPoint.y=b$M,this.renderText(b$i,b$H)}}),b$l(0,b$M,"maxScrollX",function(){return this.textWidth<this._width?0:this._textWidth-this._width}),b$l(0,b$M,"maxScrollY",function(){return this.textHeight<this._height?0:this._textHeight-this._height}),b$l(0,b$M,"lines",function(){return this._isChanged&&this.typeset(),this._lines}),b$l(0,b$M,"underlineColor",function(){return this._underlineColor},function(b$M){this._underlineColor=b$M,this._isChanged=!0,this.typeset()}),b$P.registerBitmapFont=function(b$M,b$y){b$P._bitmapFonts||(b$P._bitmapFonts={}),b$P._bitmapFonts[b$M]=b$y},b$P.unregisterBitmapFont=function(b$M,b$y){if(void 0===b$y&&(b$y=!0),b$P._bitmapFonts&&b$P._bitmapFonts[b$M]){var b$i=b$P._bitmapFonts[b$M];b$y&&b$i.destroy(),delete b$P._bitmapFonts[b$M]}},b$P.setTextRightToLeft=function(){var b$M;(b$M=b$u.canvas.source.style).display="none",b$M.position="absolute",b$M.direction="rtl",b$D._mainCanvas.source.style.direction="rtl",laya.display.Text.RightToLeft=!0,b$u.document.body.appendChild(b$u.canvas.source)},b$P.supportFont=function(b$M){b$u.context.font="10px sans-serif";var b$y=b$u.context.measureText("abcji").width;b$u.context.font="10px "+b$M;var b$i=b$u.context.measureText("abcji").width;return console.log(b$y,b$i),b$y!==b$i},b$P._testWord="游",b$P.langPacks=null,b$P.VISIBLE="visible",b$P.SCROLL="scroll",b$P.HIDDEN="hidden",b$P.CharacterCache=!0,b$P.RightToLeft=!1,b$P._bitmapFonts=null,b$k(b$P,["_fontFamilyMap",function(){return this._fontFamilyMap={"报隶":"报隶-简","黑体":"黑体-简","楷体":"楷体-简","兰亭黑":"兰亭黑-简","隶变":"隶变-简","凌慧体":"凌慧体-简","翩翩体":"翩翩体-简","苹方":"苹方-简","手札体":"手札体-简","宋体":"宋体-简","娃娃体":"娃娃体-简","魏碑":"魏碑-简","行楷":"行楷-简","雅痞":"雅痞-简","圆体":"圆体-简"}}]),b$P}(b$oM),b$CM=function(b$o){function b$V(){this.focus=null,this.designWidth=0,this.designHeight=0,this.canvasRotation=!1,this.canvasDegree=0,this.renderingEnabled=!0,this.screenAdaptationEnabled=!0,this._screenMode="none",this._scaleMode="noscale",this._alignV="top",this._alignH="left",this._bgColor="black",this._mouseMoveTime=0,this._renderCount=0,this._frameStartTime=NaN,this._isFocused=!1,this._isVisibility=!1,this._scenes=null,this._frameRate="fast",b$V.__super.call(this),this.offset=new b$Q,this._canvasTransform=new b$m,this._previousOrientation=b$u.window.orientation;var b$y=this;this.transform=b$m.create(),this._scenes=[],this.mouseEnabled=!0,this.hitTestPrior=!0,this.autoSize=!1,this._displayedInStage=!0,this._isFocused=!0,this._isVisibility=!0;var b$M=b$u.window,b$i=this;b$M.addEventListener("focus",function(){b$y._isFocused=!0,b$i.event("focus"),b$i.event("focuschange")}),b$M.addEventListener("blur",function(){b$y._isFocused=!1,b$i.event("blur"),b$i.event("focuschange"),b$i._isInputting()&&(b$GM.inputElement.target.focus=!1)});var b$H="visibilityState",b$S="visibilitychange",b$f=b$M.document;void 0!==b$f.hidden?(b$S="visibilitychange",b$H="visibilityState"):void 0!==b$f.mozHidden?(b$S="mozvisibilitychange",b$H="mozVisibilityState"):void 0!==b$f.msHidden?(b$S="msvisibilitychange",b$H="msVisibilityState"):void 0!==b$f.webkitHidden&&(b$S="webkitvisibilitychange",b$H="webkitVisibilityState"),b$M.document.addEventListener(b$S,function(){"hidden"==b$u.document[b$H]?b$i._setStageVisible(!1):b$i._setStageVisible(!0)}),b$M.document.addEventListener("qbrowserVisibilityChange",function(b$M){b$i._setStageVisible(!b$M.hidden)}),b$M.addEventListener("resize",function(){var b$M=b$u.window.orientation;null!=b$M&&b$M!=b$y._previousOrientation&&b$i._isInputting()&&(b$GM.inputElement.target.focus=!1),b$y._previousOrientation=b$M,b$i._isInputting()||b$i._resetCanvas()}),b$M.addEventListener("orientationchange",function(b$M){b$i._resetCanvas()}),this.on("mousemove",this,this._onmouseMove),b$u.onMobile&&this.on("mousedown",this,this._onmouseMove)}b$F(b$V,"laya.display.Stage",b$o);var b$M=b$V.prototype;return b$M._setStageVisible=function(b$M){this._isVisibility!=b$M&&(this._isVisibility=b$M,this._isVisibility||this._isInputting()&&(b$GM.inputElement.target.focus=!1),this.event("visibilitychange"))},b$M._isInputting=function(){return b$u.onMobile&&b$GM.isInputting},b$M._changeCanvasSize=function(){this.setScreenSize(b$u.clientWidth*b$u.pixelRatio,b$u.clientHeight*b$u.pixelRatio)},b$M._resetCanvas=function(){if(this.screenAdaptationEnabled){var b$M=b$D._mainCanvas;b$M.source.style;b$M.size(1,1),b$U.timer.once(100,this,this._changeCanvasSize)}},b$M.setScreenSize=function(b$M,b$y){var b$i=!1;if("none"!==this._screenMode&&(b$i=(b$M/b$y<1?"vertical":"horizontal")!==this._screenMode)){var b$H=b$y;b$y=b$M,b$M=b$H}this.canvasRotation=b$i;var b$S=b$D._mainCanvas,b$f=b$S.source.style,b$V=this._canvasTransform.identity(),b$K=this._scaleMode,b$k=b$M/this.designWidth,b$X=b$y/this.designHeight,b$F=this.designWidth,b$o=this.designHeight,b$d=b$M,b$P=b$y,b$l=b$u.pixelRatio;switch(this._width=this.designWidth,this._height=this.designHeight,b$K){case"noscale":b$k=b$X=1,b$d=this.designWidth,b$P=this.designHeight;break;case"showall":b$k=b$X=Math.min(b$k,b$X),b$F=b$d=Math.round(this.designWidth*b$k),b$o=b$P=Math.round(this.designHeight*b$X);break;case"noborder":b$k=b$X=Math.max(b$k,b$X),b$d=Math.round(this.designWidth*b$k),b$P=Math.round(this.designHeight*b$X);break;case"full":b$k=b$X=1,this._width=b$F=b$M,this._height=b$o=b$y;break;case"fixedwidth":b$X=b$k,this._height=b$o=Math.round(b$y/b$k);break;case"fixedheight":b$k=b$X,this._width=b$F=Math.round(b$M/b$X);break;case"fixedauto":b$M/b$y<this.designWidth/this.designHeight?(b$X=b$k,this._height=b$o=Math.round(b$y/b$k)):(b$k=b$X,this._width=b$F=Math.round(b$M/b$X))}this._height=this._height+1&2147483646,this._width=this._width+1&2147483646,b$F=b$F+1&2147483646,b$o=b$o+1&2147483646,this.conchModel&&this.conchModel.size(this._width,this._height),b$k*=this.scaleX,b$X*=this.scaleY,1===b$k&&1===b$X?this.transform.identity():(this.transform.a=this._formatData(b$k/(b$d/b$F)),this.transform.d=this._formatData(b$X/(b$P/b$o)),this.conchModel&&this.conchModel.scale(this.transform.a,this.transform.d)),b$S.size(b$F,b$o),b$T.changeWebGLSize(b$F,b$o),b$V.scale(b$d/b$F/b$l,b$P/b$o/b$l),"left"===this._alignH?this.offset.x=0:"right"===this._alignH?this.offset.x=(b$M-b$d)/b$l:this.offset.x=.5*(b$M-b$d)/b$l,"top"===this._alignV?this.offset.y=0:"bottom"===this._alignV?this.offset.y=(b$y-b$P)/b$l:this.offset.y=.5*(b$y-b$P)/b$l,this.offset.x=Math.round(this.offset.x),this.offset.y=Math.round(this.offset.y),b$V.translate(this.offset.x,this.offset.y),this.canvasDegree=0,b$i&&("horizontal"===this._screenMode?(b$V.rotate(Math.PI/2),b$V.translate(b$y/b$l,0),this.canvasDegree=90):(b$V.rotate(-Math.PI/2),b$V.translate(0,b$M/b$l),this.canvasDegree=-90)),b$V.a=this._formatData(b$V.a),b$V.d=this._formatData(b$V.d),b$V.tx=this._formatData(b$V.tx),b$V.ty=this._formatData(b$V.ty),b$f.transformOrigin=b$f.webkitTransformOrigin=b$f.msTransformOrigin=b$f.mozTransformOrigin=b$f.oTransformOrigin="0px 0px 0px",b$f.transform=b$f.webkitTransform=b$f.msTransform=b$f.mozTransform=b$f.oTransform="matrix("+b$V.toString()+")",b$V.translate(parseInt(b$f.left)||0,parseInt(b$f.top)||0),this.visible=!0,this._repaint=1,this.event("resize")},b$M._formatData=function(b$M){return Math.abs(b$M)<1e-6?0:Math.abs(1-b$M)<.001?0<b$M?1:-1:b$M},b$M.getMousePoint=function(){return b$Q.TEMP.setTo(this.mouseX,this.mouseY)},b$M.repaint=function(){this._repaint=1},b$M.parentRepaint=function(){},b$M._loop=function(){return this.render(b$D.context,0,0),!0},b$M._onmouseMove=function(b$M){this._mouseMoveTime=b$u.now()},b$M.getTimeFromFrameStart=function(){return b$u.now()-this._frameStartTime},b$M.render=function(b$M,b$y,b$i){if("sleep"===this._frameRate&&!b$D.isConchApp){var b$H=b$u.now();if(!(1e3<=b$H-this._frameStartTime))return this._renderCount++,void(this._renderCount%2==0&&(b$N.loopCount++,b$J.instance.runEvent(),b$U.timer._update()));this._frameStartTime=b$H}if(this._renderCount++,b$D.isFlash&&this.repaint(),this._style.visible){this._frameStartTime=b$u.now();var b$S="slow"!==("mouse"===this._frameRate?this._frameStartTime-this._mouseMoveTime<2e3?"fast":"slow":this._frameRate),b$f=this._renderCount%2==0;if(b$N.renderSlow=!b$S,b$S||b$f||b$D.isConchApp){var b$V;b$N.loopCount++,b$J.instance.runEvent(),b$U.timer._update(),b$T.update3DLoop();var b$K=0,b$k=0;if(b$D.isConchNode)for(b$K=0,b$k=this._scenes.length;b$K<b$k;b$K++)(b$V=this._scenes[b$K])&&b$V._updateSceneConch();else for(b$K=0,b$k=this._scenes.length;b$K<b$k;b$K++)(b$V=this._scenes[b$K])&&b$V._updateScene();if(b$D.isConchNode){var b$X=b$oM.CustomList;for(b$K=0,b$k=b$X.length;b$K<b$k;b$K++){var b$F=b$X[b$K];b$F.customRender(b$F.customContext,0,0)}return}}b$D.isConchNode||this.renderingEnabled&&(b$S||!b$f||b$D.isConchWebGL)&&(b$D.isWebGL?b$D.WebGL.mainContext&&!b$D.WebGL.mainContext.isContextLost()&&(b$M.clear(),b$o.prototype.render.call(this,b$M,b$y,b$i),b$N._show&&b$N._sp&&b$N._sp.render(b$M,b$y,b$i),b$T.clear(this._bgColor),b$T.beginFlush(),b$M.flush(),b$T.endFinish(),b$j.instance&&b$j.getInstance().endDispose()):(b$T.clear(this._bgColor),b$o.prototype.render.call(this,b$M,b$y,b$i),b$N._show&&b$N._sp&&b$N._sp.render(b$M,b$y,b$i)))}else this._renderCount%5==0&&(b$N.loopCount++,b$J.instance.runEvent(),b$U.timer._update())},b$M._requestFullscreen=function(){var b$M=b$u.document.documentElement;b$M.requestFullscreen?b$M.requestFullscreen():b$M.mozRequestFullScreen?b$M.mozRequestFullScreen():b$M.webkitRequestFullscreen?b$M.webkitRequestFullscreen():b$M.msRequestFullscreen&&b$M.msRequestFullscreen()},b$M._fullScreenChanged=function(){b$U.stage.event("fullscreenchange")},b$M.exitFullscreen=function(){var b$M=b$u.document;b$M.exitFullscreen?b$M.exitFullscreen():b$M.mozCancelFullScreen?b$M.mozCancelFullScreen():b$M.webkitExitFullscreen&&b$M.webkitExitFullscreen()},b$l(0,b$M,"clientScaleX",function(){return this._transform?this._transform.getScaleX():1}),b$l(0,b$M,"desginHeight",function(){return console.debug("desginHeight已经弃用，请使用designHeight代替"),this.designHeight}),b$l(0,b$M,"frameRate",function(){return this._frameRate},function(b$M){if(this._frameRate=b$M,b$D.isConchApp)switch(this._frameRate){case"slow":b$u.window.conch&&b$u.window.conchConfig.setSlowFrame&&b$u.window.conchConfig.setSlowFrame(!0);break;case"fast":b$u.window.conch&&b$u.window.conchConfig.setSlowFrame&&b$u.window.conchConfig.setSlowFrame(!1);break;case"mouse":b$u.window.conch&&b$u.window.conchConfig.setMouseFrame&&b$u.window.conchConfig.setMouseFrame(2e3);break;case"sleep":b$u.window.conch&&b$u.window.conchConfig.setLimitFPS&&b$u.window.conchConfig.setLimitFPS(1);break;default:throw new Error("Stage:frameRate invalid.")}}),b$l(0,b$M,"clientScaleY",function(){return this._transform?this._transform.getScaleY():1}),b$l(0,b$M,"width",b$o.prototype._$get_width,function(b$M){this.designWidth=b$M,b$U.superSet(b$oM,this,"width",b$M),b$U.timer.callLater(this,this._changeCanvasSize)}),b$l(0,b$M,"alignH",function(){return this._alignH},function(b$M){this._alignH=b$M,b$U.timer.callLater(this,this._changeCanvasSize)}),b$l(0,b$M,"isFocused",function(){return this._isFocused}),b$l(0,b$M,"height",b$o.prototype._$get_height,function(b$M){this.designHeight=b$M,b$U.superSet(b$oM,this,"height",b$M),b$U.timer.callLater(this,this._changeCanvasSize)}),b$l(0,b$M,"transform",function(){return this._tfChanged&&this._adjustTransform(),this._transform=this._transform||b$m.create()},b$o.prototype._$set_transform),b$l(0,b$M,"isVisibility",function(){return this._isVisibility}),b$l(0,b$M,"desginWidth",function(){return console.debug("desginWidth已经弃用，请使用designWidth代替"),this.designWidth}),b$l(0,b$M,"scaleMode",function(){return this._scaleMode},function(b$M){this._scaleMode=b$M,b$U.timer.callLater(this,this._changeCanvasSize)}),b$l(0,b$M,"alignV",function(){return this._alignV},function(b$M){this._alignV=b$M,b$U.timer.callLater(this,this._changeCanvasSize)}),b$l(0,b$M,"bgColor",function(){return this._bgColor},function(b$M){this._bgColor=b$M,this.conchModel&&this.conchModel.bgColor(b$M),b$D.isWebGL&&(b$M?b$V._wgColor=b$E.create(b$M)._color:b$u.onMiniGame||(b$V._wgColor=null)),b$u.onLimixiu?b$V._wgColor=b$E.create(b$M)._color:b$D.canvas.style.background=b$M||"none"}),b$l(0,b$M,"mouseX",function(){return Math.round(b$J.instance.mouseX/this.clientScaleX)}),b$l(0,b$M,"mouseY",function(){return Math.round(b$J.instance.mouseY/this.clientScaleY)}),b$l(0,b$M,"screenMode",function(){return this._screenMode},function(b$M){this._screenMode=b$M}),b$l(0,b$M,"visible",b$o.prototype._$get_visible,function(b$M){this.visible!==b$M&&(b$U.superSet(b$oM,this,"visible",b$M),b$D._mainCanvas.source.style.visibility=b$M?"visible":"hidden")}),b$l(0,b$M,"fullScreenEnabled",null,function(b$M){var b$y=b$u.document,b$i=b$D.canvas;b$M?(b$i.addEventListener("mousedown",this._requestFullscreen),b$i.addEventListener("touchstart",this._requestFullscreen),b$y.addEventListener("fullscreenchange",this._fullScreenChanged),b$y.addEventListener("mozfullscreenchange",this._fullScreenChanged),b$y.addEventListener("webkitfullscreenchange",this._fullScreenChanged),b$y.addEventListener("msfullscreenchange",this._fullScreenChanged)):(b$i.removeEventListener("mousedown",this._requestFullscreen),b$i.removeEventListener("touchstart",this._requestFullscreen),b$y.removeEventListener("fullscreenchange",this._fullScreenChanged),b$y.removeEventListener("mozfullscreenchange",this._fullScreenChanged),b$y.removeEventListener("webkitfullscreenchange",this._fullScreenChanged),b$y.removeEventListener("msfullscreenchange",this._fullScreenChanged))}),b$V.SCALE_NOSCALE="noscale",b$V.SCALE_EXACTFIT="exactfit",b$V.SCALE_SHOWALL="showall",b$V.SCALE_NOBORDER="noborder",b$V.SCALE_FULL="full",b$V.SCALE_FIXED_WIDTH="fixedwidth",b$V.SCALE_FIXED_HEIGHT="fixedheight",b$V.SCALE_FIXED_AUTO="fixedauto",b$V.ALIGN_LEFT="left",b$V.ALIGN_RIGHT="right",b$V.ALIGN_CENTER="center",b$V.ALIGN_TOP="top",b$V.ALIGN_MIDDLE="middle",b$V.ALIGN_BOTTOM="bottom",b$V.SCREEN_NONE="none",b$V.SCREEN_HORIZONTAL="horizontal",b$V.SCREEN_VERTICAL="vertical",b$V.FRAME_FAST="fast",b$V.FRAME_SLOW="slow",b$V.FRAME_MOUSE="mouse",b$V.FRAME_SLEEP="sleep",b$V.FRAME_MOUSE_THREDHOLD=2e3,b$k(b$V,["_wgColor",function(){return this._wgColor=[0,0,0,1]}]),b$V}(b$oM),b$vM=(function(b$M){function b$y(){this.url=null,this._channel=null,this._tar=null,this._playEvents=null,this._stopEvents=null,b$y.__super.call(this),this.visible=!1,this.on("added",this,this._onParentChange),this.on("removed",this,this._onParentChange)}b$F(b$y,"laya.media.SoundNode",b$oM);var b$i=b$y.prototype;b$i._onParentChange=function(){this.target=this.parent},b$i.play=function(b$M,b$y){void 0===b$M&&(b$M=1),isNaN(b$M)&&(b$M=1),this.url&&(this.stop(),this._channel=b$a.playSound(this.url,b$M,null,b$y))},b$i.stop=function(){this._channel&&!this._channel.isStopped&&this._channel.stop(),this._channel=null},b$i._setPlayAction=function(b$M,b$y,b$i,b$H){void 0===b$H&&(b$H=!0),this[b$i]&&b$M&&(b$H?b$M.on(b$y,this,this[b$i]):b$M.off(b$y,this,this[b$i]))},b$i._setPlayActions=function(b$M,b$y,b$i,b$H){if(void 0===b$H&&(b$H=!0),b$M&&b$y){var b$S,b$f=b$y.split(","),b$V=0;for(b$S=b$f.length,b$V=0;b$V<b$S;b$V++)this._setPlayAction(b$M,b$f[b$V],b$i,b$H)}},b$l(0,b$i,"playEvent",null,function(b$M){(this._playEvents=b$M)&&this._tar&&this._setPlayActions(this._tar,b$M,"play")}),b$l(0,b$i,"target",null,function(b$M){this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!1),this._setPlayActions(this._tar,this._stopEvents,"stop",!1)),this._tar=b$M,this._tar&&(this._setPlayActions(this._tar,this._playEvents,"play",!0),this._setPlayActions(this._tar,this._stopEvents,"stop",!0))}),b$l(0,b$i,"stopEvent",null,function(b$M){(this._stopEvents=b$M)&&this._tar&&this._setPlayActions(this._tar,b$M,"stop")})}(),function(b$M){function b$y(){this._src=null,this._onload=null,this._onerror=null,b$y.__super.call(this)}b$F(b$y,"laya.resource.FileBitmap",b$lM);var b$i=b$y.prototype;return b$l(0,b$i,"src",function(){return this._src},function(b$M){this._src=b$M}),b$l(0,b$i,"onload",null,function(b$M){}),b$l(0,b$i,"onerror",null,function(b$M){}),b$y}()),b$RM=function(b$M){function b$i(b$M,b$y){this._is2D=!1,b$i.__super.call(this);var b$H=this;if(this._source=this,"2D"===b$M||"AUTO"===b$M&&!b$D.isWebGL){this._is2D=!0,this._source=b$y||b$u.createElement("canvas"),this._w=this._source.width,this._h=this._source.height;var b$S=this;b$S.getContext=function(b$M,b$y){if(b$H._ctx)return b$H._ctx;var b$i=b$H._ctx=b$H._source.getContext(b$M,b$y);return b$i&&(b$i._canvas=b$S,b$D.isFlash||b$u.onLimixiu||(b$i.size=function(b$M,b$y){})),b$i}}this.uri="HTMLCanvas_"+this.id,this.lock=!0}b$F(b$i,"laya.resource.HTMLCanvas",b$lM);var b$y=b$i.prototype;return b$y.clear=function(){this._ctx&&this._ctx.clear()},b$y.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},b$y.release=function(){},b$y._setContext=function(b$M){this._ctx=b$M},b$y.getContext=function(b$M,b$y){return this._ctx?this._ctx:this._ctx=b$i._createContext(this)},b$y.getMemSize=function(){return 0},b$y.size=function(b$M,b$y){(this._w!=b$M||this._h!=b$y||this._source&&(this._source.width!=b$M||this._source.height!=b$y))&&(this._w=b$M,this._h=b$y,this.memorySize=this._w*this._h*4,this._ctx&&this._ctx.size(b$M,b$y),this._source&&(this._source.height=b$y,this._source.width=b$M))},b$y.getCanvas=function(){return this._source},b$y.toBase64=function(b$M,b$y,b$i){if(this._source)if(b$D.isConchApp&&this._source.toBase64)this._source.toBase64(b$M,b$y,b$i);else{var b$H=this._source.toDataURL(b$M,b$y);b$i.call(this,b$H)}},b$l(0,b$y,"context",function(){return this._ctx}),b$l(0,b$y,"asBitmap",null,function(b$M){}),b$i.create=function(b$M,b$y){return new b$i(b$M,b$y)},b$i.TYPE2D="2D",b$i.TYPE3D="3D",b$i.TYPEAUTO="AUTO",b$i._createContext=null,b$i}(),b$AM=(function(b$M){function b$k(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){throw b$k.__super.call(this),new Error("不允许new！")}b$F(b$k,"laya.resource.HTMLSubImage",b$lM),b$k.create=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){return void 0===b$K&&(b$K=!1),new b$k(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K)}}(),function(b$M){function b$o(){this._frames=null,this._url=null,b$o.__super.call(this),this._setControlNode(this)}b$F(b$o,"laya.display.Animation",b$M);var b$y=b$o.prototype;b$y.destroy=function(b$M){void 0===b$M&&(b$M=!0),this.stop(),laya.display.Sprite.prototype.destroy.call(this,b$M),this._frames=null,this._labels=null},b$y.play=function(b$M,b$y,b$i,b$H){void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=!0),void 0===b$i&&(b$i=""),void 0===b$H&&(b$H=!0),b$i&&this._setFramesFromCache(b$i,b$H),this._isPlaying=!0,this.index="string"==typeof b$M?this._getFrameByLabel(b$M):b$M,this.loop=b$y,this._actionName=b$i,this._isReverse=1==this.wrapMode,this._frames&&0<this.interval&&this.timerLoop(this.interval,this,this._frameLoop,null,!0,!0)},b$y._setFramesFromCache=function(b$M,b$y){var b$i;return void 0===b$y&&(b$y=!1),this._url&&(b$M=this._url+"#"+b$M),b$M&&b$o.framesMap[b$M]?((b$i=b$o.framesMap[b$M])instanceof Array?(this._frames=b$o.framesMap[b$M],this._count=this._frames.length):(b$i.nodeRoot&&(b$o.framesMap[b$M]=this._parseGraphicAnimationByData(b$i),b$i=b$o.framesMap[b$M]),this._frames=b$i.frames,this._count=this._frames.length,this._frameRateChanged||(this._interval=b$i.interval),this._labels=this._copyLabels(b$i.labels)),!0):(b$y&&console.log("ani not found:",b$M),!1)},b$y._copyLabels=function(b$M){if(!b$M)return null;var b$y,b$i;for(b$i in b$y={},b$M)b$y[b$i]=b$g.copyArray([],b$M[b$i]);return b$y},b$y._frameLoop=function(){this._style.visible&&.01<this._style.alpha&&b$M.prototype._frameLoop.call(this)},b$y._displayToIndex=function(b$M){this._frames&&(this.graphics=this._frames[b$M])},b$y.clear=function(){this.stop(),this.graphics=null,this._frames=null,this._labels=null},b$y.loadImages=function(b$M,b$y){return void 0===b$y&&(b$y=""),this._url="",this._setFramesFromCache(b$y)||(this.frames=b$o.framesMap[b$y]?b$o.framesMap[b$y]:b$o.createFrames(b$M,b$y)),this},b$y.loadAtlas=function(b$y,b$i,b$H){void 0===b$H&&(b$H=""),this._url="";var b$S=this;function b$M(b$M){b$y===b$M&&(b$S.frames=b$o.framesMap[b$H]?b$o.framesMap[b$H]:b$o.createFrames(b$y,b$H),b$i&&b$i.run())}return b$S._setFramesFromCache(b$H)||(b$KM.getAtlas(b$y)?b$M(b$y):b$U.loader.load(b$y,b$v.create(null,b$M,[b$y]),null,"atlas")),this},b$y.loadAnimation=function(b$M,b$y,b$i){this._url=b$M;return this._actionName||(this._actionName=""),this._setFramesFromCache("")?(this._setFramesFromCache(this._actionName,!0),this.index=0,b$y&&b$y.run()):!b$i||b$KM.getAtlas(b$i)?this._loadAnimationData(b$M,b$y,b$i):b$U.loader.load(b$i,b$v.create(this,this._loadAnimationData,[b$M,b$y,b$i]),null,"atlas"),this},b$y._loadAnimationData=function(b$K,b$k,b$M){var b$X=this;if(!b$M||b$KM.getAtlas(b$M)){var b$F=this;b$KM.getRes(b$K)?b$y(b$K):b$U.loader.load(b$K,b$v.create(null,b$y,[b$K]),null,"json"),b$KM.clearRes(b$K)}else console.warn("atlas load fail:"+b$M);function b$y(b$M){if(b$KM.getRes(b$M)&&b$K===b$M){var b$y;if(b$o.framesMap[b$K+"#"])b$F._setFramesFromCache(b$X._actionName,!0),b$X.index=0,b$X._checkResumePlaying();else{var b$i=b$F._parseGraphicAnimation(b$KM.getRes(b$K));if(!b$i)return;var b$H,b$S=b$i.animationList,b$f=0,b$V=b$S.length;for(b$f=0;b$f<b$V;b$f++)b$y=b$S[b$f],b$o.framesMap[b$K+"#"+b$y.name]=b$y,b$H||(b$H=b$y);b$H&&(b$o.framesMap[b$K+"#"]=b$H,b$F._setFramesFromCache(b$X._actionName,!0),b$X.index=0),b$X._checkResumePlaying()}b$k&&b$k.run()}}},b$y._parseGraphicAnimation=function(b$M){return b$UM.parseAnimationData(b$M)},b$y._parseGraphicAnimationByData=function(b$M){return b$UM.parseAnimationByData(b$M)},b$l(0,b$y,"frames",function(){return this._frames},function(b$M){(this._frames=b$M)&&(this._count=b$M.length,this._isPlaying?this.play(this._index,this.loop,this._actionName):this.index=this._index)}),b$l(0,b$y,"autoPlay",null,function(b$M){b$M?this.play():this.stop()}),b$l(0,b$y,"source",null,function(b$M){-1<b$M.indexOf(".ani")?this.loadAnimation(b$M):-1<b$M.indexOf(".json")||-1<b$M.indexOf("als")||-1<b$M.indexOf("atlas")?this.loadAtlas(b$M):this.loadImages(b$M.split(","))}),b$l(0,b$y,"autoAnimation",null,function(b$M){this.play(0,!0,b$M,!1)}),b$o.createFrames=function(b$M,b$y){var b$i,b$H,b$S=0,b$f=0;if("string"==typeof b$M){var b$V=b$KM.getAtlas(b$M);if(b$V&&b$V.length)for(b$i=[],b$S=0,b$f=b$V.length;b$S<b$f;b$S++)(b$H=new b$T.createGraphics).drawTexture(b$KM.getRes(b$V[b$S]),0,0),b$i.push(b$H)}else if(b$M instanceof Array)for(b$i=[],b$S=0,b$f=b$M.length;b$S<b$f;b$S++)(b$H=new b$T.createGraphics).loadImage(b$M[b$S],0,0),b$i.push(b$H);return b$y&&(b$o.framesMap[b$y]=b$i),b$i},b$o.clearCache=function(b$M){var b$y,b$i=b$o.framesMap,b$H=b$M+"#";for(b$y in b$i)b$y!==b$M&&0!=b$y.indexOf(b$H)||delete b$o.framesMap[b$y]},b$o.framesMap={}}(b$JM),function(b$M){function b$f(){this._targetDic=null,this._animationData=null,this._animationNewFrames=null,b$f.__super.call(this),null==b$f._sortIndexFun&&(b$f._sortIndexFun=b$I.sortByKey("index",!1,!0))}b$F(b$f,"laya.display.FrameAnimation",b$M);var b$y=b$f.prototype;return b$y._setUp=function(b$M,b$y){this._labels=null,this._animationNewFrames=null,this._targetDic=b$M,this._animationData=b$y,this.interval=1e3/b$y.frameRate,b$y.parsed?(this._count=b$y.count,this._labels=b$y.labels,this._animationNewFrames=b$y.animationNewFrames):(this._animationNewFrames=[],this._calculateDatas()),b$y.parsed=!0,b$y.labels=this._labels,b$y.count=this._count,b$y.animationNewFrames=this._animationNewFrames},b$y.clear=function(){b$M.prototype.clear.call(this),this._targetDic=null,this._animationData=null},b$y._displayToIndex=function(b$M){if(this._animationData){b$M<0&&(b$M=0),b$M>this._count&&(b$M=this._count);var b$y=this._animationData.nodes,b$i=0,b$H=b$y.length;for(b$i=0;b$i<b$H;b$i++)this._displayNodeToFrame(b$y[b$i],b$M)}},b$y._displayNodeToFrame=function(b$M,b$y,b$i){b$i||(b$i=this._targetDic);var b$H=b$i[b$M.target];if(b$H){var b$S,b$f,b$V,b$K=b$M.frames,b$k=b$M.keys,b$X=0,b$F=b$k.length;for(b$X=0;b$X<b$F;b$X++)b$V=(b$f=b$K[b$S=b$k[b$X]]).length>b$y?b$f[b$y]:b$f[b$f.length-1],b$H[b$S]=b$V}},b$y._calculateDatas=function(){if(this._animationData){var b$M,b$y=this._animationData.nodes,b$i=0,b$H=b$y.length;for(b$i=this._count=0;b$i<b$H;b$i++)b$M=b$y[b$i],this._calculateNodeKeyFrames(b$M);this._count+=1}},b$y._calculateNodeKeyFrames=function(b$M){var b$y,b$i,b$H=b$M.keyframes,b$S=b$M.target;for(b$y in b$M.frames||(b$M.frames={}),b$M.keys?b$M.keys.length=0:b$M.keys=[],b$M.initValues||(b$M.initValues={}),b$H)b$i=b$H[b$y],b$M.frames[b$y]||(b$M.frames[b$y]=[]),this._targetDic&&this._targetDic[b$S]&&(b$M.initValues[b$y]=this._targetDic[b$S][b$y]),b$i.sort(b$f._sortIndexFun),b$M.keys.push(b$y),this._calculateNodePropFrames(b$i,b$M.frames[b$y],b$y,b$S)},b$y.resetToInitState=function(){if(this._targetDic&&this._animationData){var b$M,b$y,b$i=this._animationData.nodes,b$H=0,b$S=b$i.length;for(b$H=0;b$H<b$S;b$H++)if(b$y=(b$M=b$i[b$H]).initValues){var b$f,b$V=this._targetDic[b$M.target];if(b$V)for(b$f in b$y)b$V[b$f]=b$y[b$f]}}},b$y._calculateNodePropFrames=function(b$M,b$y,b$i,b$H){var b$S=0,b$f=b$M.length-1;if(0<b$f){for(b$y.length=b$M[b$f].index+1,b$S=0;b$S<b$f;b$S++)this._dealKeyFrame(b$M[b$S]),this._calculateFrameValues(b$M[b$S],b$M[b$S+1],b$y);this._dealKeyFrame(b$M[b$S])}0==b$f&&(b$y[b$M[0].index]=b$M[0].value,this._animationNewFrames&&(this._animationNewFrames[b$M[0].index]=!0))},b$y._dealKeyFrame=function(b$M){b$M.label&&""!=b$M.label&&this.addLabel(b$M.label,b$M.index)},b$y._calculateFrameValues=function(b$M,b$y,b$i){var b$H,b$S=0,b$f=b$M.index,b$V=b$y.index,b$K=b$M.value,b$k=b$y.value-b$M.value,b$X=b$V-b$f;if(b$V>this._count&&(this._count=b$V),b$M.tween)for(null==(b$H=b$b[b$M.tweenMethod])&&(b$H=b$b.linearNone),b$S=b$f;b$S<b$V;b$S++)b$i[b$S]=b$H(b$S-b$f,b$K,b$k,b$X),this._animationNewFrames&&(this._animationNewFrames[b$S]=!0);else for(b$S=b$f;b$S<b$V;b$S++)b$i[b$S]=b$K;this._animationNewFrames&&(this._animationNewFrames[b$M.index]=!0,this._animationNewFrames[b$y.index]=!0),b$i[b$y.index]=b$y.value},b$f._sortIndexFun=null,b$f}(b$JM)),b$GM=function(b$y){function b$S(){this._focus=!1,this._multiline=!1,this._editable=!0,this._restrictPattern=null,this._type="text",this._prompt="",this._promptColor="#A9A9A9",this._originColor="#000000",this._content="",b$S.__super.call(this),this._maxChars=1e5,this._width=100,this._height=20,this.multiline=!1,this.overflow=b$hM.SCROLL,this.on("mousedown",this,this._onMouseDown),this.on("undisplay",this,this._onUnDisplay)}b$F(b$S,"laya.display.Input",b$y);var b$M=b$S.prototype;return b$M.setSelection=function(b$M,b$y){this.focus=!0,laya.display.Input.inputElement.selectionStart=b$M,laya.display.Input.inputElement.selectionEnd=b$y},b$M._onUnDisplay=function(b$M){this.focus=!1},b$M._onMouseDown=function(b$M){this.focus=!0},b$M._syncInputTransform=function(){var b$M=this.nativeInput,b$y=b$g.getTransformRelativeToWindow(this,this.padding[3],this.padding[0]),b$i=this._width-this.padding[1]-this.padding[3],b$H=this._height-this.padding[0]-this.padding[2];b$D.isConchApp?(b$M.setScale(b$y.scaleX,b$y.scaleY),b$M.setSize(b$i,b$H),b$M.setPos(b$y.x,b$y.y)):(b$S.inputContainer.style.transform=b$S.inputContainer.style.webkitTransform="scale("+b$y.scaleX+","+b$y.scaleY+") rotate("+b$U.stage.canvasDegree+"deg)",b$M.style.width=b$i+"px",b$M.style.height=b$H+"px",b$S.inputContainer.style.left=b$y.x+"px",b$S.inputContainer.style.top=b$y.y+"px")},b$M.select=function(){this.nativeInput&&this.nativeInput.select&&this.nativeInput.select()},b$M._setInputMethod=function(){b$S.input.parentElement&&b$S.inputContainer.removeChild(b$S.input),b$S.area.parentElement&&b$S.inputContainer.removeChild(b$S.area),b$S.inputElement=this._multiline?b$S.area:b$S.input,b$S.inputContainer.appendChild(b$S.inputElement),b$hM.RightToLeft&&(b$S.inputElement.style.direction="rtl")},b$M._focusIn=function(){laya.display.Input.isInputting=!0;var b$M=this.nativeInput;this._focus=!0;var b$y=b$M.style;b$y.whiteSpace=this.wordWrap?"pre-wrap":"nowrap",this._setPromptColor(),b$M.readOnly=!this._editable,b$D.isConchApp&&(b$M.setType(this._type),b$M.setForbidEdit(!this._editable)),b$M.maxLength=this._maxChars;this.padding;if(b$M.type=this._type,b$M.value=this._content,b$M.placeholder=this._prompt,b$U.stage.off("keydown",this,this._onKeyDown),b$U.stage.on("keydown",this,this._onKeyDown),(b$U.stage.focus=this).event("focus"),b$u.onPC&&b$M.focus(),!b$u.onMiniGame){this._text;this._text=null}this.typeset(),b$M.setColor(this._originColor),b$M.setFontSize(this.fontSize),b$M.setFontFace(b$u.onIPhone&&b$hM._fontFamilyMap[this.font]||this.font),b$D.isConchApp&&b$M.setMultiAble&&b$M.setMultiAble(this._multiline),b$y.lineHeight=this.leading+this.fontSize+"px",b$y.fontStyle=this.italic?"italic":"normal",b$y.fontWeight=this.bold?"bold":"normal",b$y.textAlign=this.align,b$y.padding="0 0",this._syncInputTransform(),!b$D.isConchApp&&b$u.onPC&&b$U.timer.frameLoop(1,this,this._syncInputTransform)},b$M._setPromptColor=function(){(b$S.promptStyleDOM=b$u.getElementById("promptStyle"))||((b$S.promptStyleDOM=b$u.createElement("style")).setAttribute("id","promptStyle"),b$u.document.head.appendChild(b$S.promptStyleDOM)),b$S.promptStyleDOM.innerText="input::-webkit-input-placeholder, textarea::-webkit-input-placeholder {color:"+this._promptColor+"}input:-moz-placeholder, textarea:-moz-placeholder {color:"+this._promptColor+"}input::-moz-placeholder, textarea::-moz-placeholder {color:"+this._promptColor+"}input:-ms-input-placeholder, textarea:-ms-input-placeholder {color:"+this._promptColor+"}"},b$M._focusOut=function(){laya.display.Input.isInputting=!1,this._focus=!1,this._text=null,this._content=this.nativeInput.value,this._content?(b$U.superSet(b$hM,this,"text",this._content),b$U.superSet(b$hM,this,"color",this._originColor)):(b$U.superSet(b$hM,this,"text",this._prompt),b$U.superSet(b$hM,this,"color",this._promptColor)),b$U.stage.off("keydown",this,this._onKeyDown),b$U.stage.focus=null,this.event("blur"),b$D.isConchApp&&this.nativeInput.blur(),b$u.onPC&&b$U.timer.clear(this,this._syncInputTransform)},b$M._onKeyDown=function(b$M){13===b$M.keyCode&&(b$u.onMobile&&!this._multiline&&(this.focus=!1),this.event("enter"))},b$M.changeText=function(b$M){this._content=b$M,this._focus?(this.nativeInput.value=b$M||"",this.event("change")):b$y.prototype.changeText.call(this,b$M)},b$l(0,b$M,"color",b$y.prototype._$get_color,function(b$M){this._focus&&this.nativeInput.setColor(b$M),b$U.superSet(b$hM,this,"color",this._content?b$M:this._promptColor),this._originColor=b$M}),b$l(0,b$M,"inputElementYAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。"),0},function(b$M){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementYAdjuster已弃用。")}),b$l(0,b$M,"multiline",function(){return this._multiline},function(b$M){this._multiline=b$M,this.valign=b$M?"top":"middle"}),b$l(0,b$M,"maxChars",function(){return this._maxChars},function(b$M){b$M<=0&&(b$M=1e5),this._maxChars=b$M}),b$l(0,b$M,"text",function(){return this._focus?this.nativeInput.value:this._content||""},function(b$M){b$U.superSet(b$hM,this,"color",this._originColor),b$M+="",this._focus?(this.nativeInput.value=b$M||"",this.event("change")):(this._multiline||(b$M=b$M.replace(/\r?\n/g,"")),(this._content=b$M)?b$U.superSet(b$hM,this,"text",b$M):(b$U.superSet(b$hM,this,"text",this._prompt),b$U.superSet(b$hM,this,"color",this.promptColor)))}),b$l(0,b$M,"nativeInput",function(){return this._multiline?b$S.area:b$S.input}),b$l(0,b$M,"prompt",function(){return this._prompt},function(b$M){!this._text&&b$M&&b$U.superSet(b$hM,this,"color",this._promptColor),this.promptColor=this._promptColor,this._text?b$U.superSet(b$hM,this,"text",this._text==this._prompt?b$M:this._text):b$U.superSet(b$hM,this,"text",b$M),this._prompt=b$hM.langPacks&&b$hM.langPacks[b$M]?b$hM.langPacks[b$M]:b$M}),b$l(0,b$M,"focus",function(){return this._focus},function(b$M){var b$y=this.nativeInput;this._focus!==b$M&&(b$M?(b$y.target?b$y.target._focusOut():this._setInputMethod(),(b$y.target=this)._focusIn()):(b$y.target=null,this._focusOut(),b$u.document.body.scrollTop=0,b$y.blur(),b$D.isConchApp?b$y.setPos(-1e4,-1e4):b$S.inputContainer.contains(b$y)&&b$S.inputContainer.removeChild(b$y)))}),b$l(0,b$M,"restrict",function(){return this._restrictPattern?this._restrictPattern.source:""},function(b$M){b$M?(-1<(b$M="[^"+b$M+"]").indexOf("^^")&&(b$M=b$M.replace("^^","")),this._restrictPattern=new RegExp(b$M,"g")):this._restrictPattern=null}),b$l(0,b$M,"editable",function(){return this._editable},function(b$M){this._editable=b$M,b$D.isConchApp&&b$S.input.setForbidEdit(!b$M)}),b$l(0,b$M,"promptColor",function(){return this._promptColor},function(b$M){this._promptColor=b$M,this._content||b$U.superSet(b$hM,this,"color",b$M)}),b$l(0,b$M,"type",function(){return this._type},function(b$M){this._getCSSStyle().password="password"==b$M,this._type=b$M,b$D.isConchApp&&this.nativeInput.setType(b$M)}),b$l(0,b$M,"inputElementXAdjuster",function(){return console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。"),0},function(b$M){console.warn("deprecated: 由于即使设置了该值，在各平台和浏览器之间也不一定一致，inputElementXAdjuster已弃用。")}),b$l(0,b$M,"asPassword",function(){return this._getCSSStyle().password},function(b$M){this._getCSSStyle().password=b$M,this._type="password",console.warn('deprecated: 使用type="password"替代设置asPassword, asPassword将在下次重大更新时删去'),this.isChanged=!0}),b$S.__init__=function(){b$S._createInputElement(),b$u.onMobile&&b$D.canvas.addEventListener(b$S.IOS_IFRAME?b$u.onMiniGame?"touchend":"click":"touchend",b$S._popupInputMethod)},b$S._popupInputMethod=function(b$M){laya.display.Input.isInputting&&laya.display.Input.inputElement.focus()},b$S._createInputElement=function(){b$S._initInput(b$S.area=b$u.createElement("textarea")),b$S._initInput(b$S.input=b$u.createElement("input")),(b$S.inputContainer=b$u.createElement("div")).style.position="absolute",b$S.inputContainer.style.zIndex=1e5,b$u.container.appendChild(b$S.inputContainer),b$S.inputContainer.setPos=function(b$M,b$y){b$S.inputContainer.style.left=b$M+"px",b$S.inputContainer.style.top=b$y+"px"}},b$S._initInput=function(b$y){var b$M=b$y.style;b$M.cssText="position:absolute;overflow:hidden;resize:none;transform-origin:0 0;-webkit-transform-origin:0 0;-moz-transform-origin:0 0;-o-transform-origin:0 0;",b$M.resize="none",b$M.backgroundColor="transparent",b$M.border="none",b$M.outline="none",b$M.zIndex=1,b$y.addEventListener("input",b$S._processInputting),b$y.addEventListener("mousemove",b$S._stopEvent),b$y.addEventListener("mousedown",b$S._stopEvent),b$y.addEventListener("touchmove",b$S._stopEvent),b$y.setFontFace=function(b$M){b$y.style.fontFamily=b$M},b$D.isConchApp||(b$y.setColor=function(b$M){b$y.style.color=b$M},b$y.setFontSize=function(b$M){b$y.style.fontSize=b$M+"px"})},b$S._processInputting=function(b$M){var b$y=laya.display.Input.inputElement.target;if(b$y){var b$i=laya.display.Input.inputElement.value;b$y._restrictPattern&&(b$i=b$i.replace(/\u2006|\x27/g,""),b$y._restrictPattern.test(b$i)&&(b$i=b$i.replace(b$y._restrictPattern,""),laya.display.Input.inputElement.value=b$i)),b$y._text=b$i,b$y.event("input")}},b$S._stopEvent=function(b$M){"touchmove"==b$M.type&&b$M.preventDefault(),b$M.stopPropagation&&b$M.stopPropagation()},b$S.TYPE_TEXT="text",b$S.TYPE_PASSWORD="password",b$S.TYPE_EMAIL="email",b$S.TYPE_URL="url",b$S.TYPE_NUMBER="number",b$S.TYPE_RANGE="range",b$S.TYPE_DATE="date",b$S.TYPE_MONTH="month",b$S.TYPE_WEEK="week",b$S.TYPE_TIME="time",b$S.TYPE_DATE_TIME="datetime",b$S.TYPE_DATE_TIME_LOCAL="datetime-local",b$S.TYPE_SEARCH="search",b$S.input=null,b$S.area=null,b$S.inputElement=null,b$S.inputContainer=null,b$S.confirmButton=null,b$S.promptStyleDOM=null,b$S.inputHeight=45,b$S.isInputting=!1,b$S.stageMatrix=null,b$k(b$S,["IOS_IFRAME",function(){return this.IOS_IFRAME=b$u.onIOS&&b$u.window.top!=b$u.window.self}]),b$S}(b$hM),b$IM=function(b$M){function b$i(b$M,b$y){this._recreateLock=!1,this._needReleaseAgain=!1,this._enableMerageInAtlas=!0,b$i.__super.call(this),b$M&&this._init_(b$M,b$y)}b$F(b$i,"laya.resource.HTMLImage",b$vM);var b$y=b$i.prototype;return b$y._init_=function(b$M,b$y){this._src=b$M,this._source=new b$u.window.Image,b$y&&(b$y.onload&&(this.onload=b$y.onload),b$y.onerror&&(this.onerror=b$y.onerror),b$y.onCreate&&b$y.onCreate(this)),0!=b$M.indexOf("data:image")&&(this._source.crossOrigin=""),b$M&&(this._source.src=b$M)},b$y.recreateResource=function(){var b$M=this;if(""===this._src)throw new Error("src no null！");if(this._needReleaseAgain=!1,this._source){if(this._recreateLock)return;this.memorySize=this._w*this._h*4,this._recreateLock=!1,this.completeCreate()}else{this._recreateLock=!0;var b$y=this;this._source=new b$u.window.Image,this._source.crossOrigin="",this._source.onload=function(){if(b$y._needReleaseAgain)return b$y._needReleaseAgain=!1,b$y._source.onload=null,void(b$y._source=null);b$y._source.onload=null,b$y.memorySize=b$M._w*b$M._h*4,b$y._recreateLock=!1,b$y.completeCreate()},this._source.src=this._src}},b$y.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(this._source=null,this.memorySize=0)},b$y.onresize=function(){this._w=this._source.width,this._h=this._source.height},b$l(0,b$y,"onload",null,function(b$M){var b$y=this;this._onload=b$M,this._source&&(this._source.onload=null!=this._onload?function(){b$y.onresize(),b$y._onload()}:null)}),b$l(0,b$y,"onerror",null,function(b$M){var b$y=this;this._onerror=b$M,this._source&&(this._source.onerror=null!=this._onerror?function(){b$y._onerror()}:null)}),b$l(0,b$y,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(b$M){this._enableMerageInAtlas=b$M,b$D.isConchApp&&this._source&&(this._source.enableMerageInAtlas=b$M)}),b$i.create=function(b$M,b$y){return new b$i(b$M,b$y)},b$i}(),b$UM=(function(b$f){function b$M(){this._target=null,this._playEvents=null,this._initData={},this._aniKeys=null,this._effectClass=null,b$M.__super.call(this)}b$F(b$M,"laya.display.EffectAnimation",b$f);var b$y=b$M.prototype;b$y._onOtherBegin=function(b$M){b$M!=this&&this.stop()},b$y.addEvent=function(){this._target&&this._playEvents&&(this._setControlNode(this._target),this._target.on(this._playEvents,this,this._onPlayAction))},b$y._onPlayAction=function(){this.play(0,!1)},b$y.play=function(b$M,b$y,b$i,b$H){void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=!0),void 0===b$i&&(b$i=""),void 0===b$H&&(b$H=!0),this._target&&(this._target.event("effectanimationbegin",[this]),this._recordInitData(),laya.display.AnimationPlayerBase.prototype.play.call(this,b$M,b$y,b$i,b$H))},b$y._recordInitData=function(){if(this._aniKeys){var b$M,b$y,b$i=0;for(b$M=this._aniKeys.length,b$i=0;b$i<b$M;b$i++)b$y=this._aniKeys[b$i],this._initData[b$y]=this._target[b$y]}},b$y._displayToIndex=function(b$M){if(this._animationData){b$M<0&&(b$M=0),b$M>this._count&&(b$M=this._count);var b$y=this._animationData.nodes,b$i=0,b$H=b$y.length;for(b$H=1<b$H?1:b$H,b$i=0;b$i<b$H;b$i++)this._displayNodeToFrame(b$y[b$i],b$M)}},b$y._displayNodeToFrame=function(b$M,b$y,b$i){if(this._target){var b$H;b$H=this._target;var b$S,b$f,b$V,b$K,b$k=b$M.frames,b$X=b$M.keys,b$F=0,b$o=b$X.length;b$K=b$M.secondFrames;var b$d,b$P,b$l,b$J,b$h=0;for(b$F=0;b$F<b$o;b$F++)b$f=b$k[b$S=b$X[b$F]],b$V=-1==(b$h=b$K[b$S])?this._initData[b$S]:b$y<b$h?(b$l=(b$P=b$M.keyframes[b$S])[0]).tween?(null==(b$d=b$b[b$l.tweenMethod])&&(b$d=b$b.linearNone),b$J=b$P[1],b$d(b$y,this._initData[b$S],b$J.value-this._initData[b$S],b$J.index)):this._initData[b$S]:b$f.length>b$y?b$f[b$y]:b$f[b$f.length-1],b$H[b$S]=b$V}},b$y._calculateNodeKeyFrames=function(b$M){b$f.prototype._calculateNodeKeyFrames.call(this,b$M);var b$y,b$i,b$H,b$S=b$M.keyframes;b$M.target;for(b$y in b$H={},b$M.secondFrames=b$H,b$S)(b$i=b$S[b$y]).length<=1?b$H[b$y]=-1:b$H[b$y]=b$i[1].index},b$l(0,b$y,"target",function(){return this._target},function(b$M){this._target&&this._target.off("effectanimationbegin",this,this._onOtherBegin),this._target=b$M,this._target&&this._target.on("effectanimationbegin",this,this._onOtherBegin),this.addEvent()}),b$l(0,b$y,"playEvent",null,function(b$M){(this._playEvents=b$M)&&this.addEvent()}),b$l(0,b$y,"effectData",null,function(b$M){var b$y;b$M&&((b$y=b$M.animations)&&b$y[0]&&(this._setUp({},b$y[0]),b$y[0].nodes&&b$y[0].nodes[0]&&(this._aniKeys=b$y[0].nodes[0].keys)))}),b$l(0,b$y,"effectClass",null,function(b$M){var b$y,b$i;(this._effectClass=b$Z.getClass(b$M),this._effectClass)&&((b$y=this._effectClass.uiView)&&(b$i=b$y.animations)&&b$i[0]&&(this._setUp({},b$i[0]),b$i[0].nodes&&b$i[0].nodes[0]&&(this._aniKeys=b$i[0].nodes[0].keys)))}),b$M.EffectAnimationBegin="effectanimationbegin"}(b$AM),function(b$y){var b$n;function b$a(){this.animationList=null,this.animationDic=null,this._nodeList=null,this._nodeDefaultProps=null,this._gList=null,this._nodeIDAniDic={},this._rootNode=null,this._nodeGDic=null,b$a.__super.call(this)}b$F(b$a,"laya.utils.GraphicAnimation",b$y);var b$M=b$a.prototype;return b$M._parseNodeList=function(b$M){this._nodeList||(this._nodeList=[]),this._nodeDefaultProps[b$M.compId]=b$M.props,b$M.compId&&this._nodeList.push(b$M.compId);var b$y=b$M.child;if(b$y){var b$i=0,b$H=b$y.length;for(b$i=0;b$i<b$H;b$i++)this._parseNodeList(b$y[b$i])}},b$M._calGraphicData=function(b$M){var b$y;if(this._setUp(null,b$M),this._createGraphicData(),this._nodeIDAniDic)for(b$y in this._nodeIDAniDic)this._nodeIDAniDic[b$y]=null},b$M._createGraphicData=function(){var b$M,b$y=[],b$i=0,b$H=this.count,b$S=this._animationNewFrames;for(b$S||(b$S=[]),b$i=0;b$i<b$H;b$i++)!b$S[b$i]&&b$M||(b$M=this._createFrameGraphic(b$i)),b$y.push(b$M);this._gList=b$y},b$M._createFrameGraphic=function(b$M){var b$y=b$T.createGraphics();return b$a._rootMatrix||(b$a._rootMatrix=new b$m),this._updateNodeGraphic(this._rootNode,b$M,b$a._rootMatrix,b$y),b$y},b$M._updateNodeGraphic=function(b$M,b$y,b$i,b$H,b$S){var b$f;void 0===b$S&&(b$S=1);var b$V,b$K,b$k,b$X=(b$f=this._nodeGDic[b$M.compId]=this._getNodeGraphicData(b$M.compId,b$y,this._nodeGDic[b$M.compId])).alpha*b$S;if(!(b$X<.01)&&(b$f.resultTransform||(b$f.resultTransform=b$m.create()),b$V=b$f.resultTransform,b$m.mul(b$f.transform,b$i,b$V),b$f.skin&&(b$K=this._getTextureByUrl(b$f.skin))&&(b$V._checkTransform()?(b$H.drawTexture(b$K,0,0,b$f.width,b$f.height,b$V,b$X),b$f.resultTransform=null):b$H.drawTexture(b$K,b$V.tx,b$V.ty,b$f.width,b$f.height,null,b$X)),b$k=b$M.child)){var b$F,b$o=0;for(b$F=b$k.length,b$o=0;b$o<b$F;b$o++)this._updateNodeGraphic(b$k[b$o],b$y,b$V,b$H,b$X)}},b$M._updateNoChilds=function(b$M,b$y){if(b$M.skin){var b$i=this._getTextureByUrl(b$M.skin);if(b$i){var b$H=b$M.transform;b$H._checkTransform();!b$H.bTransform?b$y.drawTexture(b$i,b$H.tx,b$H.ty,b$M.width,b$M.height,null,b$M.alpha):b$y.drawTexture(b$i,0,0,b$M.width,b$M.height,b$H.clone(),b$M.alpha)}}},b$M._updateNodeGraphic2=function(b$M,b$y,b$i){var b$H;if(b$H=this._nodeGDic[b$M.compId]=this._getNodeGraphicData(b$M.compId,b$y,this._nodeGDic[b$M.compId]),b$M.child){var b$S=b$H.transform;b$S._checkTransform();var b$f,b$V;b$V=(b$f=!b$S.bTransform)&&(0!=b$S.tx||0!=b$S.ty);var b$K,b$k,b$X;if((b$K=b$S.bTransform||1!=b$H.alpha)&&b$i.save(),1!=b$H.alpha&&b$i.alpha(b$H.alpha),b$f?b$V&&b$i.translate(b$S.tx,b$S.ty):b$i.transform(b$S.clone()),b$k=b$M.child,b$H.skin&&(b$X=this._getTextureByUrl(b$H.skin))&&b$i.drawTexture(b$X,0,0,b$H.width,b$H.height),b$k){var b$F,b$o=0;for(b$F=b$k.length,b$o=0;b$o<b$F;b$o++)this._updateNodeGraphic2(b$k[b$o],b$y,b$i)}b$K?b$i.restore():b$f?b$V&&b$i.translate(-b$S.tx,-b$S.ty):b$i.transform(b$S.clone().invert())}else this._updateNoChilds(b$H,b$i)},b$M._calculateNodeKeyFrames=function(b$M){b$y.prototype._calculateNodeKeyFrames.call(this,b$M),this._nodeIDAniDic[b$M.target]=b$M},b$M.getNodeDataByID=function(b$M){return this._nodeIDAniDic[b$M]},b$M._getParams=function(b$M,b$y,b$i,b$H){var b$S=b$a._temParam;b$S.length=b$y.length;var b$f=0,b$V=b$y.length;for(b$f=0;b$f<b$V;b$f++)b$S[b$f]=this._getObjVar(b$M,b$y[b$f][0],b$i,b$y[b$f][1],b$H);return b$S},b$M._getObjVar=function(b$M,b$y,b$i,b$H,b$S){if(b$M.hasOwnProperty(b$y)){var b$f=b$M[b$y];if(b$i>=b$f.length&&(b$i=b$f.length-1),null!=b$M[b$y][b$i])return b$M[b$y][b$i]}return b$S.hasOwnProperty(b$y)?b$S[b$y]:b$H},b$M._getNodeGraphicData=function(b$M,b$y,b$i){b$i||(b$i=b$n.create()),b$i.transform?b$i.transform.identity():b$i.transform=b$m.create();var b$H=this.getNodeDataByID(b$M);if(!b$H)return b$i;var b$S,b$f,b$V=b$H.frames,b$K=this._getParams(b$V,b$a._drawTextureCmd,b$y,this._nodeDefaultProps[b$M]),b$k=b$K[0],b$X=NaN,b$F=NaN,b$o=b$K[5],b$d=b$K[6],b$P=b$K[13],b$l=b$K[14],b$J=b$K[7],b$h=b$K[8],b$C=b$K[9],b$v=b$K[11],b$R=b$K[12];b$X=b$K[3],b$F=b$K[4],0!=b$X&&0!=b$F||(b$k=null),-1==b$X&&(b$X=0),-1==b$F&&(b$F=0),b$i.skin=b$k,b$i.width=b$X,b$i.height=b$F,b$k&&((b$S=this._getTextureByUrl(b$k))?(b$X||(b$X=b$S.sourceWidth),b$F||(b$F=b$S.sourceHeight)):console.warn("lost skin:",b$k,",you may load pics first")),b$i.alpha=b$K[10],b$f=b$i.transform,0!=b$P&&(b$o=b$P*b$X),0!=b$l&&(b$d=b$l*b$F),0==b$o&&0==b$d||b$f.translate(-b$o,-b$d);var b$A=null;if(b$C||1!==b$J||1!==b$h||b$v||b$R){(b$A=b$a._tempMt).identity(),b$A.bTransform=!0;var b$G=.0174532922222222*(b$C-b$v),b$I=.0174532922222222*(b$C+b$R),b$U=Math.cos(b$I),b$Q=Math.sin(b$I),b$W=Math.sin(b$G),b$c=Math.cos(b$G);b$A.a=b$J*b$U,b$A.b=b$J*b$Q,b$A.c=-b$h*b$W,b$A.d=b$h*b$c,b$A.tx=b$A.ty=0}return b$A&&(b$f=b$m.mul(b$f,b$A,b$f)),b$f.translate(b$K[1],b$K[2]),b$i},b$M._getTextureByUrl=function(b$M){return b$KM.getRes(b$M)},b$M.setAniData=function(b$M,b$y){if(b$M.animations){this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=b$M,this._parseNodeList(b$M);var b$i,b$H={},b$S=[],b$f=b$M.animations,b$V=0,b$K=b$f.length;for(b$V=0;b$V<b$K;b$V++)if(b$i=b$f[b$V],this._labels=null,(!b$y||b$y==b$i.name)&&b$i){try{this._calGraphicData(b$i)}catch(b$M){console.warn("parse animation fail:"+b$i.name+",empty animation created"),this._gList=[]}var b$k={};b$k.interval=1e3/b$i.frameRate,b$k.frames=this._gList,b$k.labels=this._labels,b$k.name=b$i.name,b$S.push(b$k),b$H[b$i.name]=b$k}this.animationList=b$S,this.animationDic=b$H}b$a._temParam.length=0},b$M.parseByData=function(b$M){var b$y,b$i;b$y=b$M.nodeRoot,b$i=b$M.aniO,delete b$M.nodeRoot,delete b$M.aniO,this._nodeDefaultProps={},this._nodeGDic={},this._nodeList&&(this._nodeList.length=0),this._rootNode=b$y,this._parseNodeList(b$y),this._labels=null;try{this._calGraphicData(b$i)}catch(b$M){console.warn("parse animation fail:"+b$i.name+",empty animation created"),this._gList=[]}var b$H=b$M;return b$H.interval=1e3/b$i.frameRate,b$H.frames=this._gList,b$H.labels=this._labels,b$H.name=b$i.name,b$H},b$M.setUpAniData=function(b$M){if(b$M.animations){var b$y,b$i={},b$H=[],b$S=b$M.animations,b$f=0,b$V=b$S.length;for(b$f=0;b$f<b$V;b$f++)if(b$y=b$S[b$f]){var b$K={};b$K.name=b$y.name,b$K.aniO=b$y,b$K.nodeRoot=b$M,b$H.push(b$K),b$i[b$y.name]=b$K}this.animationList=b$H,this.animationDic=b$i}},b$M._clear=function(){var b$M,b$y;if(this.animationList=null,this.animationDic=null,this._gList=null,this._nodeGDic)for(b$M in this._nodeGDic)(b$y=this._nodeGDic[b$M])&&b$y.recover();this._nodeGDic=null},b$a.parseAnimationByData=function(b$M){var b$y;return b$a._I||(b$a._I=new b$a),b$y=b$a._I.parseByData(b$M),b$a._I._clear(),b$y},b$a.parseAnimationData=function(b$M){var b$y;return b$a._I||(b$a._I=new b$a),b$a._I.setUpAniData(b$M),(b$y={}).animationList=b$a._I.animationList,b$y.animationDic=b$a._I.animationDic,b$a._I._clear(),b$y},b$a._drawTextureCmd=[["skin",null],["x",0],["y",0],["width",-1],["height",-1],["pivotX",0],["pivotY",0],["scaleX",1],["scaleY",1],["rotation",0],["alpha",1],["skewX",0],["skewY",0],["anchorX",0],["anchorY",0]],b$a._temParam=[],b$a._I=null,b$a._rootMatrix=null,b$k(b$a,["_tempMt",function(){return this._tempMt=new b$m}]),b$a.__init$=function(){b$n=function(){function b$M(){this.skin=null,this.transform=null,this.resultTransform=null,this.width=NaN,this.height=NaN,this.alpha=1}return b$F(b$M,""),b$M.prototype.recover=function(){this.skin=null,this.width=0,this.height=0,this.alpha=1,this.transform&&(this.transform.destroy(),this.transform=null),this.resultTransform&&(this.resultTransform.destroy(),this.resultTransform=null),b$r.recover("GraphicNode",this)},b$M.create=function(){return b$r.getItemByClass("GraphicNode",b$M)},b$M}()},b$a}(b$AM));b$U.__init([b$X,b$kM,b$D,b$u,b$$,b$c,b$M,b$UM])}(window,document,Laya),function(b$M,b$y,b$i){b$i.un,b$i.uns,b$i.static;var b$H=b$i.class;b$i.getset,b$i.__newvec;new(function(){function b$M(){}return b$H(b$M,"LayaMain"),b$M}())}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(b$M,b$y){"use strict";for(var b$i in Object.defineProperty(b$y,"__esModule",{value:!0}),Laya){var b$H=Laya[b$i];b$H&&b$H.__isclass&&(b$y[b$i]=b$H)}}),function(b$M,b$y,b$I){b$I.un,b$I.uns;var b$V=b$I.static,b$d=b$I.class,b$H=b$I.getset,b$f=b$I.__newvec,b$F=laya.maths.Arith,b$o=laya.maths.Bezier,b$i=laya.resource.Bitmap,b$P=laya.utils.Browser,b$k=laya.utils.Byte,b$l=laya.utils.Color,b$U=(laya.filters.ColorFilter,b$I.Config),b$S=laya.resource.Context,b$Q=(laya.events.Event,laya.filters.Filter),b$K=laya.display.Graphics,b$X=laya.resource.HTMLCanvas,b$J=(laya.utils.HTMLChar,laya.resource.HTMLImage),b$h=laya.resource.HTMLSubImage,b$W=(laya.utils.Handler,laya.net.Loader,laya.maths.Matrix),b$c=laya.maths.Point,b$n=laya.maths.Rectangle,b$C=laya.renders.Render,b$v=(laya.renders.RenderContext,laya.renders.RenderSprite),b$R=laya.resource.Resource,b$A=laya.resource.ResourceManager,b$G=laya.utils.RunDriver,b$a=laya.display.Sprite,b$T=laya.display.Stage,b$m=laya.utils.Stat,b$e=laya.utils.StringKey,b$s=(laya.display.css.Style,laya.system.System),b$D=laya.display.Text,b$z=laya.resource.Texture,b$w=(laya.display.css.TransformInfo,laya.net.URL,laya.utils.Utils),b$q=laya.utils.VectorGraphManager;laya.utils.WordText;b$I.interface("laya.webgl.shapes.IShape"),b$I.interface("laya.webgl.submit.ISubmit"),b$I.interface("laya.webgl.text.ICharSegment"),b$I.interface("laya.webgl.canvas.save.ISaveData"),b$I.interface("laya.webgl.resource.IMergeAtlasBitmap"),b$I.interface("laya.filters.IFilterActionGL","laya.filters.IFilterAction");var b$t=function(){function b$M(){}b$d(b$M,"laya.filters.webgl.FilterActionGL");var b$y=b$M.prototype;return b$I.imps(b$y,{"laya.filters.IFilterActionGL":!0}),b$y.setValue=function(b$M){},b$y.setValueMix=function(b$M){},b$y.apply3d=function(b$M,b$y,b$i,b$H,b$S){return null},b$y.apply=function(b$M){return null},b$H(0,b$y,"typeMix",function(){return 0}),b$M}(),b$u=function(){function b$M(){}return b$d(b$M,"laya.webgl.shader.ShaderValue"),b$M}(),b$p=function(){var b$H,b$S;function b$M(b$M,b$y,b$i){this._atlasID=0,this._width=0,this._height=0,this._texCount=0,this._rowInfo=null,this._cells=null,this._failSize=new b$S,void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),this._cells=null,this._rowInfo=null,this._init(b$M,b$y),this._atlasID=b$i}b$d(b$M,"laya.webgl.atlas.AtlasGrid");var b$y=b$M.prototype;return b$y.getAltasID=function(){return this._atlasID},b$y.setAltasID=function(b$M){0<=b$M&&(this._atlasID=b$M)},b$y.addTex=function(b$M,b$y,b$i){var b$H=this._get(b$y,b$i);return 0==b$H.ret||(this._fill(b$H.x,b$H.y,b$y,b$i,b$M),this._texCount++),b$H},b$y._release=function(){null!=this._cells&&(this._cells.length=0,this._cells=null),this._rowInfo&&(this._rowInfo.length=0,this._rowInfo=null)},b$y._init=function(b$M,b$y){if(this._width=b$M,this._height=b$y,this._release(),0==this._width)return!1;this._cells=new Uint8Array(this._width*this._height*3),this._rowInfo=b$f(this._height);for(var b$i=0;b$i<this._height;b$i++)this._rowInfo[b$i]=new b$H;return this._clear(),!0},b$y._get=function(b$M,b$y){var b$i=new b$Z;if(b$M>=this._failSize.width&&b$y>=this._failSize.height)return b$i;for(var b$H=-1,b$S=-1,b$f=this._width,b$V=this._height,b$K=this._cells,b$k=0;b$k<b$V;b$k++)if(!(this._rowInfo[b$k].spaceCount<b$M))for(var b$X=0;b$X<b$f;){var b$F=3*(b$k*b$f+b$X);if(0!=b$K[b$F]||b$K[1+b$F]<b$M||b$K[2+b$F]<b$y)b$X+=b$K[1+b$F];else{b$H=b$X,b$S=b$k;for(var b$o=0;b$o<b$M;b$o++)if(b$K[3*b$o+b$F+2]<b$y){b$H=-1;break}if(!(b$H<0))return b$i.ret=!0,b$i.x=b$H,b$i.y=b$S,b$i;b$X+=b$K[1+b$F]}}return b$i},b$y._fill=function(b$M,b$y,b$i,b$H,b$S){var b$f=this._width,b$V=this._height;this._check(b$M+b$i<=b$f&&b$y+b$H<=b$V);for(var b$K=b$y;b$K<b$H+b$y;++b$K){this._check(this._rowInfo[b$K].spaceCount>=b$i),this._rowInfo[b$K].spaceCount-=b$i;for(var b$k=0;b$k<b$i;b$k++){var b$X=3*(b$M+b$K*b$f+b$k);this._check(0==this._cells[b$X]),this._cells[b$X]=b$S,this._cells[1+b$X]=b$i,this._cells[2+b$X]=b$H}}if(0<b$M)for(b$K=0;b$K<b$H;++b$K){var b$F=0;for(b$k=b$M-1;0<=b$k&&0==this._cells[3*((b$y+b$K)*b$f+b$k)];--b$k,++b$F);for(b$k=b$F;0<b$k;--b$k)this._cells[3*((b$y+b$K)*b$f+b$M-b$k)+1]=b$k,this._check(0<b$k)}if(0<b$y)for(b$k=b$M;b$k<b$M+b$i;++b$k){for(b$F=0,b$K=b$y-1;0<=b$K&&0==this._cells[3*(b$k+b$K*b$f)];--b$K,b$F++);for(b$K=b$F;0<b$K;--b$K)this._cells[3*(b$k+(b$y-b$K)*b$f)+2]=b$K,this._check(0<b$K)}},b$y._check=function(b$M){0==b$M&&console.log("xtexMerger 错误啦")},b$y._clear=function(){for(var b$M=this._texCount=0;b$M<this._height;b$M++)this._rowInfo[b$M].spaceCount=this._width;for(var b$y=0;b$y<this._height;b$y++)for(var b$i=0;b$i<this._width;b$i++){var b$H=3*(b$y*this._width+b$i);this._cells[b$H]=0,this._cells[1+b$H]=this._width-b$i,this._cells[2+b$H]=this._width-b$y}this._failSize.width=this._width+1,this._failSize.height=this._height+1},b$M.__init$=function(){b$H=function(){function b$M(){this.spaceCount=0}return b$d(b$M,""),b$M}(),b$S=function(){function b$M(){this.width=0,this.height=0}return b$d(b$M,""),b$M}()},b$M}(),b$B=function(){function b$C(b$M,b$y,b$i,b$H){this._currentAtlasCount=0,this._maxAtlaserCount=0,this._width=0,this._height=0,this._gridSize=0,this._gridNumX=0,this._gridNumY=0,this._init=!1,this._curAtlasIndex=0,this._setAtlasParam=!1,this._atlaserArray=null,this._needGC=!1,this._setAtlasParam=!0,this._width=b$M,this._height=b$y,this._gridSize=b$i,this._maxAtlaserCount=b$H,this._gridNumX=b$M/b$i,this._gridNumY=b$y/b$i,this._curAtlasIndex=0,this._atlaserArray=[]}b$d(b$C,"laya.webgl.atlas.AtlasResourceManager");var b$M=b$C.prototype;return b$M.setAtlasParam=function(b$M,b$y,b$i,b$H){if(1==this._setAtlasParam)return b$C._sid_=0,this._width=b$M,this._height=b$y,this._gridSize=b$i,this._maxAtlaserCount=b$H,this._gridNumX=b$M/b$i,this._gridNumY=b$y/b$i,this._curAtlasIndex=0,this.freeAll(),!0;throw console.log("设置大图合集参数错误，只能在开始页面设置各种参数"),-1},b$M.pushData=function(b$M){var b$y,b$i=b$M.bitmap,b$H=-1,b$S=null,b$f=0,b$V=0;for(b$f=0,b$y=this._atlaserArray.length;b$f<b$y&&(b$V=(this._curAtlasIndex+b$f)%b$y,-1==(b$H=(b$S=this._atlaserArray[b$V]).findBitmapIsExist(b$i)));b$f++);if(-1!=b$H){var b$K=b$S.InAtlasWebGLImagesOffsetValue[b$H];return b$l=b$K[0],b$J=b$K[1],b$S.addToAtlas(b$M,b$l,b$J),!0}this._setAtlasParam=!1;for(var b$k=Math.ceil((b$M.bitmap.width+2)/this._gridSize),b$X=Math.ceil((b$M.bitmap.height+2)/this._gridSize),b$F=!1,b$o=0;b$o<2;b$o++){var b$d=this._maxAtlaserCount;for(b$f=0;b$f<b$d;b$f++){b$V=(this._curAtlasIndex+b$f)%b$d,this._atlaserArray.length-1>=b$V||this._atlaserArray.push(new b$nM(this._gridNumX,this._gridNumY,this._width,this._height,b$C._sid_++));var b$P=this._atlaserArray[b$V],b$l=0,b$J=0,b$h=b$P.addTex(1,b$k,b$X);if(b$h.ret){b$l=b$h.x*this._gridSize+1,b$J=b$h.y*this._gridSize+1,b$i.lock=!0,b$P.addToAtlasTexture(b$i,b$l,b$J),b$P.addToAtlas(b$M,b$l,b$J),b$F=!0,this._curAtlasIndex=b$V;break}}if(b$F)break;this._atlaserArray.push(new b$nM(this._gridNumX,this._gridNumY,this._width,this._height,b$C._sid_++)),this._needGC=!0,this.garbageCollection(),this._curAtlasIndex=this._atlaserArray.length-1}return b$F||console.log(">>>AtlasManager pushData error"),b$F},b$M.addToAtlas=function(b$M){laya.webgl.atlas.AtlasResourceManager.instance.pushData(b$M)},b$M.garbageCollection=function(){if(!0===this._needGC){for(var b$M=this._atlaserArray.length-this._maxAtlaserCount,b$y=0;b$y<b$M;b$y++)this._atlaserArray[b$y].dispose(),console.log("AtlasResourceManager:Dispose the inner Atlas。");console.log(">>>>altas garbageCollection ="+b$M),this._atlaserArray.splice(0,b$M),this._needGC=!1}return!0},b$M.freeAll=function(){for(var b$M=0,b$y=this._atlaserArray.length;b$M<b$y;b$M++)this._atlaserArray[b$M].dispose();this._atlaserArray.length=0,this._curAtlasIndex=0},b$M.getAtlaserCount=function(){return this._atlaserArray.length},b$M.getAtlaserByIndex=function(b$M){return this._atlaserArray[b$M]},b$H(1,b$C,"instance",function(){return b$C._Instance||(b$C._Instance=new b$C(laya.webgl.atlas.AtlasResourceManager.atlasTextureWidth,laya.webgl.atlas.AtlasResourceManager.atlasTextureHeight,16,laya.webgl.atlas.AtlasResourceManager.maxTextureCount)),b$C._Instance}),b$H(1,b$C,"enabled",function(){return b$U.atlasEnable}),b$H(1,b$C,"atlasLimitWidth",function(){return b$C._atlasLimitWidth},function(b$M){b$C._atlasLimitWidth=b$M}),b$H(1,b$C,"atlasLimitHeight",function(){return b$C._atlasLimitHeight},function(b$M){b$C._atlasLimitHeight=b$M}),b$C._enable=function(){b$U.atlasEnable=!0},b$C._disable=function(){b$U.atlasEnable=!1},b$C.__init__=function(){b$C.atlasTextureWidth=2048,b$C.atlasTextureHeight=2048,b$C.maxTextureCount=6,b$C.atlasLimitWidth=512,b$C.atlasLimitHeight=512},b$C._atlasLimitWidth=0,b$C._atlasLimitHeight=0,b$C.gridSize=16,b$C.atlasTextureWidth=0,b$C.atlasTextureHeight=0,b$C.maxTextureCount=0,b$C._atlasRestore=0,b$C.BOARDER_TYPE_NO=0,b$C.BOARDER_TYPE_RIGHT=1,b$C.BOARDER_TYPE_LEFT=2,b$C.BOARDER_TYPE_BOTTOM=4,b$C.BOARDER_TYPE_TOP=8,b$C.BOARDER_TYPE_ALL=15,b$C._sid_=0,b$C._Instance=null,b$C}(),b$Z=function(){function b$M(){this.x=0,this.y=0,this.ret=!1,this.ret=!1,this.x=0,this.y=0}return b$d(b$M,"laya.webgl.atlas.MergeFillInfo"),b$M}(),b$E=function(){function b$y(){}return b$d(b$y,"laya.webgl.canvas.BlendMode"),b$y._init_=function(b$M){b$y.fns=[b$y.BlendNormal,b$y.BlendAdd,b$y.BlendMultiply,b$y.BlendScreen,b$y.BlendOverlay,b$y.BlendLight,b$y.BlendMask,b$y.BlendDestinationOut],b$y.targetFns=[b$y.BlendNormalTarget,b$y.BlendAddTarget,b$y.BlendMultiplyTarget,b$y.BlendScreenTarget,b$y.BlendOverlayTarget,b$y.BlendLightTarget,b$y.BlendMask,b$y.BlendDestinationOut]},b$y.BlendNormal=function(b$M){b$M.blendFunc(1,771)},b$y.BlendAdd=function(b$M){b$M.blendFunc(1,772)},b$y.BlendMultiply=function(b$M){b$M.blendFunc(774,771)},b$y.BlendScreen=function(b$M){b$M.blendFunc(1,1)},b$y.BlendOverlay=function(b$M){b$M.blendFunc(1,769)},b$y.BlendLight=function(b$M){b$M.blendFunc(1,1)},b$y.BlendNormalTarget=function(b$M){b$M.blendFunc(1,771)},b$y.BlendAddTarget=function(b$M){b$M.blendFunc(1,772)},b$y.BlendMultiplyTarget=function(b$M){b$M.blendFunc(774,771)},b$y.BlendScreenTarget=function(b$M){b$M.blendFunc(1,1)},b$y.BlendOverlayTarget=function(b$M){b$M.blendFunc(1,769)},b$y.BlendLightTarget=function(b$M){b$M.blendFunc(1,1)},b$y.BlendMask=function(b$M){b$M.blendFunc(0,770)},b$y.BlendDestinationOut=function(b$M){b$M.blendFunc(0,0)},b$y.activeBlendFunction=null,b$y.NAMES=["normal","add","multiply","screen","overlay","light","mask","destination-out"],b$y.TOINT={normal:0,add:1,multiply:2,screen:3,lighter:1,overlay:4,light:5,mask:6,"destination-out":7},b$y.NORMAL="normal",b$y.ADD="add",b$y.MULTIPLY="multiply",b$y.SCREEN="screen",b$y.LIGHT="light",b$y.OVERLAY="overlay",b$y.DESTINATIONOUT="destination-out",b$y.fns=[],b$y.targetFns=[],b$y}(),b$_=function(){function b$i(b$M){this._color=b$l.create("black"),this.setValue(b$M)}b$d(b$i,"laya.webgl.canvas.DrawStyle");var b$M=b$i.prototype;return b$M.setValue=function(b$M){if(b$M){if("string"==typeof b$M)return void(this._color=b$l.create(b$M));if(b$M instanceof laya.utils.Color)return void(this._color=b$M)}},b$M.reset=function(){this._color=b$l.create("black")},b$M.equal=function(b$M){return"string"==typeof b$M?this._color.strColor===b$M:b$M instanceof laya.utils.Color&&this._color.numColor===b$M.numColor},b$M.toColorStr=function(){return this._color.strColor},b$i.create=function(b$M){var b$y;if(b$M&&("string"==typeof b$M?b$y=b$l.create(b$M):b$M instanceof laya.utils.Color&&(b$y=b$M),b$y))return b$y._drawStyle||(b$y._drawStyle=new b$i(b$M));return laya.webgl.canvas.DrawStyle.DEFAULT},b$V(b$i,["DEFAULT",function(){return this.DEFAULT=new b$i("#000000")}]),b$i}(),b$b=function(){function b$M(){this._x=0,this._y=0,this.dirty=!1,this.offset=0,this.count=0,this.geoStart=0,this.tempArray=[],this.closePath=!1,this.geomatrys=[];b$AM.mainContext;this.ib=b$OM.create(35048),this.vb=b$LM.create(5)}b$d(b$M,"laya.webgl.canvas.Path");var b$y=b$M.prototype;return b$y.addPoint=function(b$M,b$y){this.tempArray.push(b$M,b$y)},b$y.getEndPointX=function(){return this.tempArray[this.tempArray.length-2]},b$y.getEndPointY=function(){return this.tempArray[this.tempArray.length-1]},b$y.polygon=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V;return this.geomatrys.push(this._curGeomatry=b$V=new b$eM(b$M,b$y,b$i,b$H,b$S,b$f)),b$H||(b$V.fill=!1),null==b$f&&(b$V.borderWidth=0),b$V},b$y.setGeomtry=function(b$M){this.geomatrys.push(this._curGeomatry=b$M)},b$y.drawLine=function(b$M,b$y,b$i,b$H,b$S){var b$f;return this.closePath?this.geomatrys.push(this._curGeomatry=b$f=new b$mM(b$M,b$y,b$i,b$H,b$S)):this.geomatrys.push(this._curGeomatry=b$f=new b$TM(b$M,b$y,b$i,b$H,b$S)),b$f.fill=!1,b$f},b$y.update=function(){var b$M=this.ib._byteLength,b$y=this.geomatrys.length;this.offset=b$M;for(var b$i=this.geoStart;b$i<b$y;b$i++)this.geomatrys[b$i].getData(this.ib,this.vb,this.vb._byteLength/20);this.geoStart=b$y,this.count=(this.ib._byteLength-b$M)/b$JM.BYTES_PIDX},b$y.reset=function(){this.vb.clear(),this.ib.clear(),this.offset=this.count=this.geoStart=0,this.geomatrys.length=0},b$y.recover=function(){this._curGeomatry=null,this.vb.destory(),this.vb=null,this.ib.destory(),this.ib=null},b$M}(),b$Y=function(){function b$K(){}b$d(b$K,"laya.webgl.canvas.save.SaveBase");var b$M=b$K.prototype;return b$I.imps(b$M,{"laya.webgl.canvas.save.ISaveData":!0}),b$M.isSaveMark=function(){return!1},b$M.restore=function(b$M){this._dataObj[this._valueName]=this._value,(b$K._cache[b$K._cache._length++]=this)._newSubmit&&(b$M._curSubmit=b$fM.RENDERBASE,b$M._renderKey=0)},b$K._createArray=function(){var b$M=[];return b$M._length=0,b$M},b$K._init=function(){var b$M=b$K._namemap={};return b$M[1]="ALPHA",b$M[2]="fillStyle",b$M[8]="font",b$M[256]="lineWidth",b$M[512]="strokeStyle",b$M[8192]="_mergeID",b$M[1024]=b$M[2048]=b$M[4096]=[],b$M[16384]="textBaseline",b$M[32768]="textAlign",b$M[65536]="_nBlendType",b$M[1048576]="shader",b$M[2097152]="filters",b$M},b$K.save=function(b$M,b$y,b$i,b$H){if((b$M._saveMark._saveuse&b$y)!==b$y){b$M._saveMark._saveuse|=b$y;var b$S=b$K._cache,b$f=0<b$S._length?b$S[--b$S._length]:new b$K;b$f._value=b$i[b$f._valueName=b$K._namemap[b$y]],b$f._dataObj=b$i,b$f._newSubmit=b$H;var b$V=b$M._save;b$V[b$V._length++]=b$f}},b$K._cache=laya.webgl.canvas.save.SaveBase._createArray(),b$K._namemap=b$K._init(),b$K}(),b$r=function(){function b$f(){this._clipRect=new b$n}b$d(b$f,"laya.webgl.canvas.save.SaveClipRect");var b$M=b$f.prototype;return b$I.imps(b$M,{"laya.webgl.canvas.save.ISaveData":!0}),b$M.isSaveMark=function(){return!1},b$M.restore=function(b$M){b$M._clipRect=this._clipSaveRect,(b$f._cache[b$f._cache._length++]=this)._submitScissor.submitLength=b$M._submits._length-this._submitScissor.submitIndex,b$M._curSubmit=b$fM.RENDERBASE,b$M._renderKey=0},b$f.save=function(b$M,b$y){if(131072!=(131072&b$M._saveMark._saveuse)){b$M._saveMark._saveuse|=131072;var b$i=b$f._cache,b$H=0<b$i._length?b$i[--b$i._length]:new b$f;b$H._clipSaveRect=b$M._clipRect,b$M._clipRect=b$H._clipRect.copyFrom(b$M._clipRect),b$H._submitScissor=b$y;var b$S=b$M._save;b$S[b$S._length++]=b$H}},b$V(b$f,["_cache",function(){return this._cache=b$Y._createArray()}]),b$f}(),b$N=function(){function b$P(){this._contextX=0,this._contextY=0,this._clipRect=new b$n,this._rect=new b$n,this._matrix=new b$W}b$d(b$P,"laya.webgl.canvas.save.SaveClipRectStencil");var b$M=b$P.prototype;return b$I.imps(b$M,{"laya.webgl.canvas.save.ISaveData":!0}),b$M.isSaveMark=function(){return!1},b$M.restore=function(b$M){b$FM.restore(b$M,this._rect,this._saveMatrix,this._contextX,this._contextY),b$M._clipRect=this._clipSaveRect,b$M._curMat=this._saveMatrix,b$M._x=this._contextX,b$M._y=this._contextY,b$P._cache[b$P._cache._length++]=this,b$M._curSubmit=b$fM.RENDERBASE},b$P.save=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){if(262144!=(262144&b$M._saveMark._saveuse)){b$M._saveMark._saveuse|=262144;var b$F=b$P._cache,b$o=0<b$F._length?b$F[--b$F._length]:new b$P;b$o._clipSaveRect=b$M._clipRect,b$o._clipRect.setTo(b$V,b$K,b$k,b$X),b$M._clipRect=b$o._clipRect,b$o._rect.x=b$i,b$o._rect.y=b$H,b$o._rect.width=b$S,b$o._rect.height=b$f,b$o._contextX=b$M._x,b$o._contextY=b$M._y,b$o._saveMatrix=b$M._curMat,b$M._curMat.copyTo(b$o._matrix),b$M._curMat=b$o._matrix,b$o._submitStencil=b$y;var b$d=b$M._save;b$d[b$d._length++]=b$o}},b$V(b$P,["_cache",function(){return this._cache=b$Y._createArray()}]),b$P}(),b$$=function(){function b$H(){this._saveuse=0}b$d(b$H,"laya.webgl.canvas.save.SaveMark");var b$M=b$H.prototype;return b$I.imps(b$M,{"laya.webgl.canvas.save.ISaveData":!0}),b$M.isSaveMark=function(){return!0},b$M.restore=function(b$M){b$M._saveMark=this._preSaveMark,b$H._no[b$H._no._length++]=this},b$H.Create=function(b$M){var b$y=b$H._no,b$i=0<b$y._length?b$y[--b$y._length]:new b$H;return b$i._saveuse=0,b$i._preSaveMark=b$M._saveMark,b$M._saveMark=b$i},b$V(b$H,["_no",function(){return this._no=b$Y._createArray()}]),b$H}(),b$x=function(){function b$f(){this._matrix=new b$W}b$d(b$f,"laya.webgl.canvas.save.SaveTransform");var b$M=b$f.prototype;return b$I.imps(b$M,{"laya.webgl.canvas.save.ISaveData":!0}),b$M.isSaveMark=function(){return!1},b$M.restore=function(b$M){b$M._curMat=this._savematrix,b$f._no[b$f._no._length++]=this},b$f.save=function(b$M){var b$y=b$M._saveMark;if(2048!=(2048&b$y._saveuse)){b$y._saveuse|=2048;var b$i=b$f._no,b$H=0<b$i._length?b$i[--b$i._length]:new b$f;b$H._savematrix=b$M._curMat,b$M._curMat=b$M._curMat.copyTo(b$H._matrix);var b$S=b$M._save;b$S[b$S._length++]=b$H}},b$V(b$f,["_no",function(){return this._no=b$Y._createArray()}]),b$f}(),b$g=function(){function b$S(){}b$d(b$S,"laya.webgl.canvas.save.SaveTranslate");var b$M=b$S.prototype;return b$I.imps(b$M,{"laya.webgl.canvas.save.ISaveData":!0}),b$M.isSaveMark=function(){return!1},b$M.restore=function(b$M){b$M._curMat;b$M._x=this._x,b$M._y=this._y,b$S._no[b$S._no._length++]=this},b$S.save=function(b$M){var b$y=b$S._no,b$i=0<b$y._length?b$y[--b$y._length]:new b$S;b$i._x=b$M._x,b$i._y=b$M._y;var b$H=b$M._save;b$H[b$H._length++]=b$i},b$V(b$S,["_no",function(){return this._no=b$Y._createArray()}]),b$S}(),b$j=function(){function b$M(){this.target=null,this.repaint=!1,this._width=NaN,this._height=NaN,this._sp=null,this._clipRect=new b$n}b$d(b$M,"laya.webgl.resource.RenderTargetMAX");var b$y=b$M.prototype;return b$y.setSP=function(b$M){this._sp=b$M},b$y.size=function(b$M,b$y){var b$i=this;this._width!==b$M||this._height!==b$y?(this.repaint=!0,this._width=b$M,this._height=b$y,this.target?this.target.size(b$M,b$y):this.target=b$qM.create(b$M,b$y),this.target.hasListener("recovered")||this.target.on("recovered",this,function(b$M){b$I.timer.callLater(b$i._sp,b$i._sp.repaint)})):this.target.size(b$M,b$y)},b$y._flushToTarget=function(b$M,b$y){if(!b$y._destroy){var b$i=b$vM.worldScissorTest,b$H=b$vM.worldClipRect;b$vM.worldClipRect=this._clipRect,this._clipRect.x=this._clipRect.y=0,this._clipRect.width=this._width,this._clipRect.height=this._height,b$vM.worldScissorTest=!1,b$AM.mainContext.disable(3089);var b$S=b$vM.worldAlpha,b$f=b$vM.worldMatrix4,b$V=b$vM.worldMatrix,b$K=b$vM.worldFilters,b$k=b$vM.worldShaderDefines;if(b$vM.worldMatrix=b$W.EMPTY,b$vM.restoreTempArray(),b$vM.worldMatrix4=b$vM.TEMPMAT4_ARRAY,b$vM.worldAlpha=1,b$vM.worldFilters=null,b$vM.worldShaderDefines=null,b$wM.activeShader=null,b$y.start(),b$U.showCanvasMark?b$y.clear(0,1,0,.3):b$y.clear(0,0,0,0),b$M.flush(),b$y.end(),b$wM.activeShader=null,b$vM.worldAlpha=b$S,b$vM.worldMatrix4=b$f,b$vM.worldMatrix=b$V,b$vM.worldFilters=b$K,b$vM.worldShaderDefines=b$k,b$vM.worldScissorTest=b$i){var b$X=b$vM.height-b$H.y-b$H.height;b$AM.mainContext.scissor(b$H.x,b$X,b$H.width,b$H.height),b$AM.mainContext.enable(3089)}b$vM.worldClipRect=b$H}},b$y.flush=function(b$M){this.repaint&&(this._flushToTarget(b$M,this.target),this.repaint=!1)},b$y.drawTo=function(b$M,b$y,b$i,b$H,b$S){b$M.drawTexture(this.target.getTexture(),b$y,b$i,b$H,b$S,0,0)},b$y.destroy=function(){this.target&&(this.target.destroy(),this.target=null,this._sp=null)},b$M}(),b$O=function(){function b$M(){this.ALPHA=1,this.shaderType=0,this.defines=new b$aM}return b$d(b$M,"laya.webgl.shader.d2.Shader2D"),b$M.prototype.destroy=function(){this.defines=null,this.filters=null,this.glTexture=null,this.strokeStyle=null,this.fillStyle=null},b$M.__init__=function(){var b$M,b$y;b$$M.addInclude("parts/ColorFilter_ps_uniform.glsl","uniform vec4 colorAlpha;\nuniform mat4 colorMat;"),b$$M.addInclude("parts/ColorFilter_ps_logic.glsl","mat4 alphaMat =colorMat;\n\nalphaMat[0][3] *= gl_FragColor.a;\nalphaMat[1][3] *= gl_FragColor.a;\nalphaMat[2][3] *= gl_FragColor.a;\n\ngl_FragColor = gl_FragColor * alphaMat;\ngl_FragColor += colorAlpha/255.0*gl_FragColor.a;\n"),b$$M.addInclude("parts/GlowFilter_ps_uniform.glsl","uniform vec4 u_color;\nuniform float u_strength;\nuniform float u_blurX;\nuniform float u_blurY;\nuniform float u_offsetX;\nuniform float u_offsetY;\nuniform float u_textW;\nuniform float u_textH;"),b$$M.addInclude("parts/GlowFilter_ps_logic.glsl","const float c_IterationTime = 10.0;\nfloat floatIterationTotalTime = c_IterationTime * c_IterationTime;\nvec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\nvec2 vec2FilterDir = vec2(-(u_offsetX)/u_textW,-(u_offsetY)/u_textH);\nvec2 vec2FilterOff = vec2(u_blurX/u_textW/c_IterationTime * 2.0,u_blurY/u_textH/c_IterationTime * 2.0);\nfloat maxNum = u_blurX * u_blurY;\nvec2 vec2Off = vec2(0.0,0.0);\nfloat floatOff = c_IterationTime/2.0;\nfor(float i = 0.0;i<=c_IterationTime; ++i){\n\tfor(float j = 0.0;j<=c_IterationTime; ++j){\n\t\tvec2Off = vec2(vec2FilterOff.x * (i - floatOff),vec2FilterOff.y * (j - floatOff));\n\t\tvec4 vec4Color2 = texture2D(texture, v_texcoord + vec2FilterDir + vec2Off); \n\n      #ifdef TXTALPHA\n   vec4Color2.a = texture2D(texture1, v_texcoord + vec2FilterDir + vec2Off).a;\n   #endif\n\n    vec4Color += vec4Color2/floatIterationTotalTime;        \n\t}\n}\ngl_FragColor = vec4(u_color.rgb,vec4Color.a * u_strength);\ngl_FragColor.rgb *= gl_FragColor.a;"),b$$M.addInclude("parts/BlurFilter_ps_logic.glsl","gl_FragColor =   blur();\ngl_FragColor.w*=alpha;"),b$$M.addInclude("parts/BlurFilter_ps_uniform.glsl","uniform vec4 strength_sig2_2sig2_gauss1;\nuniform vec2 blurInfo;\n\n#define PI 3.141593\n\n//float sigma=strength/3.0;//3σ以外影响很小。即当σ=1的时候，半径为3\n//float sig2 = sigma*sigma;\n//float _2sig2 = 2.0*sig2;\n//return 1.0/(2*PI*sig2)*exp(-(x*x+y*y)/_2sig2)\n//float gauss1 = 1.0/(2.0*PI*sig2);\n\nfloat getGaussian(float x, float y){\n    return strength_sig2_2sig2_gauss1.w*exp(-(x*x+y*y)/strength_sig2_2sig2_gauss1.z);\n}\n\nvec4 blur(){\n    const float blurw = 9.0;\n    vec4 vec4Color = vec4(0.0,0.0,0.0,0.0);\n    vec2 halfsz=vec2(blurw,blurw)/2.0/blurInfo;    \n    vec2 startpos=v_texcoord-halfsz;\n    vec2 ctexcoord = startpos;\n    vec2 step = 1.0/blurInfo;  //每个像素      \n    \n    for(float y = 0.0;y<=blurw; ++y){\n        ctexcoord.x=startpos.x;\n        for(float x = 0.0;x<=blurw; ++x){\n            //TODO 纹理坐标的固定偏移应该在vs中处理\n            vec4 vec4Color1 = texture2D(texture, ctexcoord); \n\n      #ifdef TXTALPHA\n   vec4Color1.a = texture2D(texture1, ctexcoord).a;\n   #endif\n\n    vec4Color += vec4Color1*getGaussian(x-blurw/2.0,y-blurw/2.0);\n            ctexcoord.x+=step.x;\n        }\n        ctexcoord.y+=step.y;\n    }\n    return vec4Color;\n}"),b$$M.addInclude("parts/ColorAdd_ps_uniform.glsl","uniform vec4 colorAdd;\n"),b$$M.addInclude("parts/ColorAdd_ps_logic.glsl","gl_FragColor = vec4(colorAdd.rgb,colorAdd.a*gl_FragColor.a);\ngl_FragColor.xyz *= colorAdd.a;"),b$M="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",b$y='precision mediump float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec4 color= texture2D(texture, v_texcoord);\n\n   #ifdef TXTCOMPRESS\n   color.rgb *= color.a;\n   #endif\n\n   #ifdef TXTALPHA\n   color.rgba *= texture2D(texture1, v_texcoord).a;\n   #endif\n\n   color.a*=alpha;\n   color.rgb*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',b$$M.preCompile2D(0,1,b$M,b$y,null),b$M="attribute vec4 position;\nuniform vec2 size;\nuniform mat4 mmat;\nvoid main() {\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n}",b$y='precision mediump float;\nuniform vec4 color;\nuniform float alpha;\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\nvoid main() {\n\tvec4 a = vec4(color.r, color.g, color.b, color.a);\n\ta.w = alpha;\n\ta.xyz *= alpha;\n\tgl_FragColor = a;\n\t#include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n}',b$$M.preCompile2D(0,2,b$M,b$y,null),b$M="attribute vec4 position;\nattribute vec3 a_color;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nuniform vec2 u_pos;\nuniform vec2 size;\nvarying vec3 color;\nvoid main(){\n  vec4 tPos = vec4(position.x + u_pos.x,position.y + u_pos.y,position.z,position.w);\n  vec4 pos=mmat*u_mmat2*tPos;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  color=a_color;\n}",b$y="precision mediump float;\nvarying vec3 color;\nuniform float alpha;\nvoid main(){\n\t//vec4 a=vec4(color.r, color.g, color.b, 1);\n\t//a.a*=alpha;\n    gl_FragColor=vec4(color.r, color.g, color.b, alpha);\n\tgl_FragColor.rgb*=alpha;\n}",b$$M.preCompile2D(0,4,b$M,b$y,null),b$M="attribute vec4 position;\nattribute vec2 texcoord;\nuniform vec2 size;\n\n#ifdef WORLDMAT\nuniform mat4 mmat;\n#endif\nvarying vec2 v_texcoord;\nvoid main() {\n  #ifdef WORLDMAT\n  vec4 pos=mmat*position;\n  gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  #else\n  gl_Position =vec4((position.x/size.x-0.5)*2.0,(0.5-position.y/size.y)*2.0,position.z,1.0);\n  #endif\n  \n  v_texcoord = texcoord;\n}",b$y='#ifdef FSHIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n//precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nuniform vec4 u_TexRange;\nuniform vec2 u_offset;\n#include?BLUR_FILTER  "parts/BlurFilter_ps_uniform.glsl";\n#include?COLOR_FILTER "parts/ColorFilter_ps_uniform.glsl";\n#include?GLOW_FILTER "parts/GlowFilter_ps_uniform.glsl";\n#include?COLOR_ADD "parts/ColorAdd_ps_uniform.glsl";\n\nvoid main() {\n   vec2 newTexCoord;\n   newTexCoord.x = mod(u_offset.x + v_texcoord.x,u_TexRange.y) + u_TexRange.x;\n   newTexCoord.y = mod(u_offset.y + v_texcoord.y,u_TexRange.w) + u_TexRange.z;\n   vec4 color= texture2D(texture, newTexCoord);\n\n   #ifdef TXTALPHA\n   color.a = texture2D(texture1, newTexCoord).a;\n   #endif\n\n   color.a*=alpha;\n   gl_FragColor=color;\n   #include?COLOR_ADD "parts/ColorAdd_ps_logic.glsl";   \n   #include?BLUR_FILTER  "parts/BlurFilter_ps_logic.glsl";\n   #include?COLOR_FILTER "parts/ColorFilter_ps_logic.glsl";\n   #include?GLOW_FILTER "parts/GlowFilter_ps_logic.glsl";\n}',b$$M.preCompile2D(0,256,b$M,b$y,null),b$M="attribute vec2 position;\nattribute vec2 texcoord;\nattribute vec4 color;\nuniform vec2 size;\nuniform float offsetX;\nuniform float offsetY;\nuniform mat4 mmat;\nuniform mat4 u_mmat2;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nvoid main() {\n  vec4 pos=mmat*u_mmat2*vec4(offsetX+position.x,offsetY+position.y,0,1 );\n  gl_Position = vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0);\n  v_color = color;\n  v_color.rgb *= v_color.a;\n  v_texcoord = texcoord;  \n}",b$y="precision mediump float;\nvarying vec2 v_texcoord;\nvarying vec4 v_color;\nuniform sampler2D texture;\n\n#ifdef TXTALPHA\nuniform sampler2D texture1;\n#endif\n\nuniform float alpha;\nvoid main() {\n\tvec4 t_color = texture2D(texture, v_texcoord);\n\n   #ifdef TXTALPHA\n   t_color.a = texture2D(texture1, v_texcoord).a;\n   #endif\n\n\tgl_FragColor = t_color.rgba * v_color;\n\tgl_FragColor *= alpha;\n}",b$$M.preCompile2D(0,512,b$M,b$y,null)},b$M}(),b$L=function(){function b$y(b$M,b$y,b$i){this._value=0,this._name2int=b$M,this._int2name=b$y,this._int2nameMap=b$i}b$d(b$y,"laya.webgl.shader.ShaderDefines");var b$M=b$y.prototype;return b$M.add=function(b$M){return"string"==typeof b$M&&(b$M=this._name2int[b$M]),this._value|=b$M,this._value},b$M.addInt=function(b$M){return this._value|=b$M,this._value},b$M.remove=function(b$M){return"string"==typeof b$M&&(b$M=this._name2int[b$M]),this._value&=~b$M,this._value},b$M.isDefine=function(b$M){return(this._value&b$M)===b$M},b$M.getValue=function(){return this._value},b$M.setValue=function(b$M){this._value=b$M},b$M.toNameDic=function(){var b$M=this._int2nameMap[this._value];return b$M||b$y._toText(this._value,this._int2name,this._int2nameMap)},b$y._reg=function(b$M,b$y,b$i,b$H){b$H[b$i[b$M]=b$y]=b$M},b$y._toText=function(b$M,b$y,b$i){var b$H=b$i[b$M];if(b$H)return b$H;for(var b$S={},b$f=1,b$V=0;b$V<32&&!(b$M<(b$f=1<<b$V));b$V++)if(b$M&b$f){var b$K=b$y[b$f];b$K&&(b$S[b$K]="")}return b$i[b$M]=b$S},b$y._toInt=function(b$M,b$y){for(var b$i=b$M.split("."),b$H=0,b$S=0,b$f=b$i.length;b$S<b$f;b$S++){var b$V=b$y[b$i[b$S]];if(!b$V)throw new Error("Defines to int err:"+b$M+"/"+b$i[b$S]);b$H|=b$V}return b$H},b$y}(),b$MM=function(){function b$V(){this.mVBBuffer=null,this.mIBBuffer=null,this.mVBData=null,this.mIBData=null,this.mEleNum=0,this.mTexture=null,this.transform=null,this._vs=null,this._ps=null,this._indexStart=-1,this._verticles=null,this._uvs=null,this._tempMatrix=new b$W}b$d(b$V,"laya.webgl.shader.d2.skinAnishader.SkinMesh");var b$M=b$V.prototype;return b$M.init=function(b$M,b$y,b$i){if(b$y)this._vs=b$y;else{this._vs=[];var b$H=b$M.width,b$S=b$M.height;this._vs.push(0,0,0,0,1,1,1,1),this._vs.push(b$H,0,1,0,1,1,1,1),this._vs.push(b$H,b$S,1,1,1,1,1,1),this._vs.push(0,b$S,0,1,1,1,1,1)}b$i?this._ps=b$i:(b$V._defaultPS||(b$V._defaultPS=[]).push(0,1,3,3,1,2),this._ps=b$V._defaultPS),this.mVBData=new Float32Array(this._vs),this.mIBData=new Uint16Array(this._ps.length),this.mIBData.start=-1,this.mEleNum=this._ps.length,this.mTexture=b$M},b$M.init2=function(b$M,b$y,b$i,b$H,b$S){this.transform&&(this.transform=null),b$i?this._ps=b$i:(this._ps=[],this._ps.push(0,1,3,3,1,2)),this._verticles=b$H,this._uvs=b$S,this.mEleNum=this._ps.length,this.mTexture=b$M,(b$C.isConchNode||b$C.isConchApp)&&(this._initMyData(),this.mVBData=new Float32Array(this._vs))},b$M._initMyData=function(){var b$M=0,b$y=0,b$i=4*this._verticles.length;this._vs=b$V._tempVS;var b$H=!1;if(b$C.isConchNode||b$C.isConchApp?(this._vs.length=b$i,b$H=!0):this._vs.length<b$i&&(this._vs.length=b$i,b$H=!0),b$V._tVSLen=b$i,b$H)for(;b$M<b$i;)this._vs[b$M]=this._verticles[b$y],this._vs[b$M+1]=this._verticles[b$y+1],this._vs[b$M+2]=this._uvs[b$y],this._vs[b$M+3]=this._uvs[b$y+1],this._vs[b$M+4]=1,this._vs[b$M+5]=1,this._vs[b$M+6]=1,this._vs[b$M+7]=1,b$M+=8,b$y+=2;else for(;b$M<b$i;)this._vs[b$M]=this._verticles[b$y],this._vs[b$M+1]=this._verticles[b$y+1],this._vs[b$M+2]=this._uvs[b$y],this._vs[b$M+3]=this._uvs[b$y+1],b$M+=8,b$y+=2},b$M.getData2=function(b$M,b$y,b$i){var b$H;this.mVBBuffer=b$M,this.mIBBuffer=b$y,this._initMyData(),b$M.appendEx2(this._vs,Float32Array,b$V._tVSLen,4),this._indexStart=b$y._byteLength,(b$H=b$V._tempIB).length<this._ps.length&&(b$H.length=this._ps.length);for(var b$S=0,b$f=this._ps.length;b$S<b$f;b$S++)b$H[b$S]=this._ps[b$S]+b$i;b$y.appendEx2(b$H,Uint16Array,this._ps.length,2)},b$M.getData=function(b$M,b$y,b$i){if(this.mVBBuffer=b$M,this.mIBBuffer=b$y,b$M.append(this.mVBData),this._indexStart=b$y._byteLength,this.mIBData.start!=b$i){for(var b$H=0,b$S=this._ps.length;b$H<b$S;b$H++)this.mIBData[b$H]=this._ps[b$H]+b$i;this.mIBData.start=b$i}b$y.append(this.mIBData)},b$M.render=function(b$M,b$y,b$i){if(b$C.isWebGL&&this.mTexture){b$M._renderKey=0,b$M._shader2D.glTexture=null,b$yM.getInstance().addSkinMesh(this);var b$H=b$fM.createShape(b$M,this.mIBBuffer,this.mVBBuffer,this.mEleNum,this._indexStart,b$QM.create(512,0));this.transform||(this.transform=b$W.EMPTY),this.transform.translate(b$y,b$i),b$W.mul(this.transform,b$M._curMat,this._tempMatrix),this.transform.translate(-b$y,-b$i);var b$S=b$H.shaderValue,b$f=b$S.u_mmat2||b$vM.getMatrArray();b$vM.mat2MatArray(this._tempMatrix,b$f),b$S.textureHost=this.mTexture,b$S.offsetX=0,b$S.offsetY=0,b$S.u_mmat2=b$f,b$S.ALPHA=b$M._shader2D.ALPHA,b$M._submits[b$M._submits._length++]=b$H}else b$C.isConchApp&&this.mTexture&&(this.transform||(this.transform=b$W.EMPTY),b$M.setSkinMesh&&b$M.setSkinMesh(b$y,b$i,this._ps,this.mVBData,this.mEleNum,0,this.mTexture,this.transform))},b$V._tempVS=[],b$V._tempIB=[],b$V._defaultPS=null,b$V._tVSLen=0,b$V}(),b$yM=function(){function b$M(){this.ib=null,this.vb=null;b$AM.mainContext;this.ib=b$OM.create(35048),this.vb=b$LM.create(8)}b$d(b$M,"laya.webgl.shader.d2.skinAnishader.SkinMeshBuffer");var b$y=b$M.prototype;return b$y.addSkinMesh=function(b$M){b$M.getData2(this.vb,this.ib,this.vb._byteLength/32)},b$y.reset=function(){this.vb.clear(),this.ib.clear()},b$M.getInstance=function(){return b$M.instance=b$M.instance||new b$M},b$M.instance=null,b$M}(),b$iM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){this.r0=0,this.fill=!0,this.r1=Math.PI/2,void 0===b$k&&(b$k=0),this.x=b$M,this.y=b$y,this.width=b$i,this.height=b$H,this.edges=b$S,this.color=b$f,this.borderWidth=b$V,this.borderColor=b$K}b$d(b$M,"laya.webgl.shapes.BasePoly");var b$y=b$M.prototype;return b$I.imps(b$y,{"laya.webgl.shapes.IShape":!0}),b$y.getData=function(b$M,b$y,b$i){},b$y.rebuild=function(b$M){},b$y.setMatrix=function(b$M){},b$y.needUpdate=function(b$M){return!0},b$y.sector=function(b$M,b$y,b$i){var b$H=this.x,b$S=this.y,b$f=this.edges,b$V=(this.r1-this.r0)/b$f,b$K=this.width,b$k=this.height,b$X=this.color,b$F=(b$X>>16&255)/255,b$o=(b$X>>8&255)/255,b$d=(255&b$X)/255;b$M.push(b$H,b$S,b$F,b$o,b$d);for(var b$P=0;b$P<b$f+1;b$P++)b$M.push(b$H+Math.sin(b$V*b$P+this.r0)*b$K,b$S+Math.cos(b$V*b$P+this.r0)*b$k),b$M.push(b$F,b$o,b$d);for(b$P=0;b$P<b$f;b$P++)b$y.push(b$i,b$i+b$P+1,b$i+b$P+2)},b$y.createLine2=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V,b$K,b$k,b$X,b$F,b$o,b$d,b$P,b$l,b$J,b$h,b$C,b$v,b$R,b$A,b$G,b$I,b$U,b$Q,b$W,b$c=b$M.concat(),b$n=b$S,b$a=this.borderColor,b$T=(b$a>>16&255)/255,b$m=(b$a>>8&255)/255,b$e=(255&b$a)/255,b$s=b$c.length/2,b$D=b$H,b$z=b$i/2;b$k=b$c[0],b$X=b$c[1],b$J=b$k-(b$F=b$c[2]),b$l=(b$l=-(b$X-(b$o=b$c[3])))/(b$W=Math.sqrt(b$l*b$l+b$J*b$J))*b$z,b$J=b$J/b$W*b$z,b$n.push(b$k-b$l+this.x,b$X-b$J+this.y,b$T,b$m,b$e,b$k+b$l+this.x,b$X+b$J+this.y,b$T,b$m,b$e);for(var b$w=1;b$w<b$s-1;b$w++)b$k=b$c[2*(b$w-1)],b$X=b$c[2*(b$w-1)+1],b$F=b$c[2*b$w],b$o=b$c[2*b$w+1],b$d=b$c[2*(b$w+1)],b$P=b$c[2*(b$w+1)+1],b$J=b$k-b$F,b$C=b$F-b$d,b$A=(-(b$l=(b$l=-(b$X-b$o))/(b$W=Math.sqrt(b$l*b$l+b$J*b$J))*b$z)+b$k)*(-(b$J=b$J/b$W*b$z)+b$o)-(-b$l+b$F)*(-b$J+b$X),b$U=(-(b$h=(b$h=-(b$o-b$P))/(b$W=Math.sqrt(b$h*b$h+b$C*b$C))*b$z)+b$d)*(-(b$C=b$C/b$W*b$z)+b$o)-(-b$h+b$F)*(-b$C+b$P),b$Q=(b$v=-b$J+b$X-(-b$J+b$o))*(b$I=-b$h+b$F-(-b$h+b$d))-(b$G=-b$C+b$P-(-b$C+b$o))*(b$R=-b$l+b$F-(-b$l+b$k)),Math.abs(b$Q)<.1?(b$Q+=10.1,b$n.push(b$F-b$l+this.x,b$o-b$J+this.y,b$T,b$m,b$e,b$F+b$l+this.x,b$o+b$J+this.y,b$T,b$m,b$e)):(((b$V=(b$R*b$U-b$I*b$A)/b$Q)-b$F)*(b$V-b$F)+((b$K=(b$G*b$A-b$v*b$U)/b$Q)-b$o)+(b$K-b$o),b$n.push(b$V+this.x,b$K+this.y,b$T,b$m,b$e,b$F-(b$V-b$F)+this.x,b$o-(b$K-b$o)+this.y,b$T,b$m,b$e));b$k=b$c[b$c.length-4],b$X=b$c[b$c.length-3],b$J=b$k-(b$F=b$c[b$c.length-2]),b$l=(b$l=-(b$X-(b$o=b$c[b$c.length-1])))/(b$W=Math.sqrt(b$l*b$l+b$J*b$J))*b$z,b$J=b$J/b$W*b$z,b$n.push(b$F-b$l+this.x,b$o-b$J+this.y,b$T,b$m,b$e,b$F+b$l+this.x,b$o+b$J+this.y,b$T,b$m,b$e);var b$q=b$f;for(b$w=1;b$w<b$q;b$w++)b$y.push(b$D+2*(b$w-1),b$D+2*(b$w-1)+1,b$D+2*b$w+1,b$D+2*b$w+1,b$D+2*b$w,b$D+2*(b$w-1));return b$n},b$y.createLine=function(b$M,b$y,b$i,b$H){var b$S=b$M.concat(),b$f=b$M,b$V=this.borderColor,b$K=(b$V>>16&255)/255,b$k=(b$V>>8&255)/255,b$X=(255&b$V)/255;b$S.splice(0,5);var b$F,b$o,b$d,b$P,b$l,b$J,b$h,b$C,b$v,b$R,b$A,b$G,b$I,b$U,b$Q,b$W,b$c,b$n,b$a,b$T,b$m=b$S.length/5,b$e=b$H,b$s=b$i/2;b$d=b$S[0],b$P=b$S[1],b$R=b$d-(b$l=b$S[5]),b$v=(b$v=-(b$P-(b$J=b$S[6])))/(b$T=Math.sqrt(b$v*b$v+b$R*b$R))*b$s,b$R=b$R/b$T*b$s,b$f.push(b$d-b$v,b$P-b$R,b$K,b$k,b$X,b$d+b$v,b$P+b$R,b$K,b$k,b$X);for(var b$D=1;b$D<b$m-1;b$D++)b$d=b$S[5*(b$D-1)],b$P=b$S[5*(b$D-1)+1],b$l=b$S[5*b$D],b$J=b$S[5*b$D+1],b$h=b$S[5*(b$D+1)],b$C=b$S[5*(b$D+1)+1],b$R=b$d-b$l,b$G=b$l-b$h,b$Q=(-(b$v=(b$v=-(b$P-b$J))/(b$T=Math.sqrt(b$v*b$v+b$R*b$R))*b$s)+b$d)*(-(b$R=b$R/b$T*b$s)+b$J)-(-b$v+b$l)*(-b$R+b$P),b$n=(-(b$A=(b$A=-(b$J-b$C))/(b$T=Math.sqrt(b$A*b$A+b$G*b$G))*b$s)+b$h)*(-(b$G=b$G/b$T*b$s)+b$J)-(-b$A+b$l)*(-b$G+b$C),b$a=(b$I=-b$R+b$P-(-b$R+b$J))*(b$c=-b$A+b$l-(-b$A+b$h))-(b$W=-b$G+b$C-(-b$G+b$J))*(b$U=-b$v+b$l-(-b$v+b$d)),Math.abs(b$a)<.1?(b$a+=10.1,b$f.push(b$l-b$v,b$J-b$R,b$K,b$k,b$X,b$l+b$v,b$J+b$R,b$K,b$k,b$X)):(((b$F=(b$U*b$n-b$c*b$Q)/b$a)-b$l)*(b$F-b$l)+((b$o=(b$W*b$Q-b$I*b$n)/b$a)-b$J)+(b$o-b$J),b$f.push(b$F,b$o,b$K,b$k,b$X,b$l-(b$F-b$l),b$J-(b$o-b$J),b$K,b$k,b$X));b$d=b$S[b$S.length-10],b$P=b$S[b$S.length-9],b$R=b$d-(b$l=b$S[b$S.length-5]),b$v=(b$v=-(b$P-(b$J=b$S[b$S.length-4])))/(b$T=Math.sqrt(b$v*b$v+b$R*b$R))*b$s,b$R=b$R/b$T*b$s,b$f.push(b$l-b$v,b$J-b$R,b$K,b$k,b$X,b$l+b$v,b$J+b$R,b$K,b$k,b$X);var b$z=this.edges+1;for(b$D=1;b$D<b$z;b$D++)b$y.push(b$e+2*(b$D-1),b$e+2*(b$D-1)+1,b$e+2*b$D+1,b$e+2*b$D+1,b$e+2*b$D,b$e+2*(b$D-1));return b$f},b$y.createLoopLine=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=b$M.concat(),b$K=b$S||b$M,b$k=this.borderColor,b$X=(b$k>>16&255)/255,b$F=(b$k>>8&255)/255,b$o=(255&b$k)/255;b$V.splice(0,5);var b$d=[b$V[0],b$V[1]],b$P=[b$V[b$V.length-5],b$V[b$V.length-4]],b$l=b$P[0]+.5*(b$d[0]-b$P[0]),b$J=b$P[1]+.5*(b$d[1]-b$P[1]);b$V.unshift(b$l,b$J,0,0,0),b$V.push(b$l,b$J,0,0,0);var b$h,b$C,b$v,b$R,b$A,b$G,b$I,b$U,b$Q,b$W,b$c,b$n,b$a,b$T,b$m,b$e,b$s,b$D,b$z,b$w,b$q=b$V.length/5,b$t=b$H,b$u=b$i/2;b$v=b$V[0],b$R=b$V[1],b$W=b$v-(b$A=b$V[5]),b$Q=(b$Q=-(b$R-(b$G=b$V[6])))/(b$w=Math.sqrt(b$Q*b$Q+b$W*b$W))*b$u,b$W=b$W/b$w*b$u,b$K.push(b$v-b$Q,b$R-b$W,b$X,b$F,b$o,b$v+b$Q,b$R+b$W,b$X,b$F,b$o);for(var b$p=1;b$p<b$q-1;b$p++)b$v=b$V[5*(b$p-1)],b$R=b$V[5*(b$p-1)+1],b$A=b$V[5*b$p],b$G=b$V[5*b$p+1],b$I=b$V[5*(b$p+1)],b$U=b$V[5*(b$p+1)+1],b$W=b$v-b$A,b$n=b$A-b$I,b$m=(-(b$Q=(b$Q=-(b$R-b$G))/(b$w=Math.sqrt(b$Q*b$Q+b$W*b$W))*b$u)+b$v)*(-(b$W=b$W/b$w*b$u)+b$G)-(-b$Q+b$A)*(-b$W+b$R),b$D=(-(b$c=(b$c=-(b$G-b$U))/(b$w=Math.sqrt(b$c*b$c+b$n*b$n))*b$u)+b$I)*(-(b$n=b$n/b$w*b$u)+b$G)-(-b$c+b$A)*(-b$n+b$U),b$z=(b$a=-b$W+b$R-(-b$W+b$G))*(b$s=-b$c+b$A-(-b$c+b$I))-(b$e=-b$n+b$U-(-b$n+b$G))*(b$T=-b$Q+b$A-(-b$Q+b$v)),Math.abs(b$z)<.1?(b$z+=10.1,b$K.push(b$A-b$Q,b$G-b$W,b$X,b$F,b$o,b$A+b$Q,b$G+b$W,b$X,b$F,b$o)):(((b$h=(b$T*b$D-b$s*b$m)/b$z)-b$A)*(b$h-b$A)+((b$C=(b$e*b$m-b$a*b$D)/b$z)-b$G)+(b$C-b$G),b$K.push(b$h,b$C,b$X,b$F,b$o,b$A-(b$h-b$A),b$G-(b$C-b$G),b$X,b$F,b$o));b$f&&(b$y=b$f);var b$B=this.edges+1;for(b$p=1;b$p<b$B;b$p++)b$y.push(b$t+2*(b$p-1),b$t+2*(b$p-1)+1,b$t+2*b$p+1,b$t+2*b$p+1,b$t+2*b$p,b$t+2*(b$p-1));return b$y.push(b$t+2*(b$p-1),b$t+2*(b$p-1)+1,b$t+1,b$t+1,b$t,b$t+2*(b$p-1)),b$K},b$M}(),b$HM=function(){function b$J(){}return b$d(b$J,"laya.webgl.shapes.Earcut"),b$J.earcut=function(b$M,b$y,b$i){b$i=b$i||2;var b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F=b$y&&b$y.length,b$o=b$F?b$y[0]*b$i:b$M.length,b$d=b$J.linkedList(b$M,0,b$o,b$i,!0),b$P=[];if(!b$d)return b$P;if(b$F&&(b$d=b$J.eliminateHoles(b$M,b$y,b$d,b$i)),b$M.length>80*b$i){b$H=b$f=b$M[0],b$S=b$V=b$M[1];for(var b$l=b$i;b$l<b$o;b$l+=b$i)(b$K=b$M[b$l])<b$H&&(b$H=b$K),(b$k=b$M[b$l+1])<b$S&&(b$S=b$k),b$f<b$K&&(b$f=b$K),b$V<b$k&&(b$V=b$k);b$X=0!==(b$X=Math.max(b$f-b$H,b$V-b$S))?1/b$X:0}return b$J.earcutLinked(b$d,b$P,b$i,b$H,b$S,b$X),b$P},b$J.linkedList=function(b$M,b$y,b$i,b$H,b$S){var b$f,b$V;if(b$S===0<b$J.signedArea(b$M,b$y,b$i,b$H))for(b$f=b$y;b$f<b$i;b$f+=b$H)b$V=b$J.insertNode(b$f,b$M[b$f],b$M[b$f+1],b$V);else for(b$f=b$i-b$H;b$y<=b$f;b$f-=b$H)b$V=b$J.insertNode(b$f,b$M[b$f],b$M[b$f+1],b$V);return b$V&&b$J.equals(b$V,b$V.next)&&(b$J.removeNode(b$V),b$V=b$V.next),b$V},b$J.filterPoints=function(b$M,b$y){if(!b$M)return b$M;b$y||(b$y=b$M);var b$i,b$H=b$M;do{if(b$i=!1,b$H.steiner||!b$J.equals(b$H,b$H.next)&&0!==b$J.area(b$H.prev,b$H,b$H.next))b$H=b$H.next;else{if(b$J.removeNode(b$H),(b$H=b$y=b$H.prev)===b$H.next)break;b$i=!0}}while(b$i||b$H!==b$y);return b$y},b$J.earcutLinked=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){if(b$M){!b$V&&b$f&&b$J.indexCurve(b$M,b$H,b$S,b$f);for(var b$K,b$k,b$X=b$M;b$M.prev!==b$M.next;)if(b$K=b$M.prev,b$k=b$M.next,b$f?b$J.isEarHashed(b$M,b$H,b$S,b$f):b$J.isEar(b$M))b$y.push(b$K.i/b$i),b$y.push(b$M.i/b$i),b$y.push(b$k.i/b$i),b$J.removeNode(b$M),b$M=b$k.next,b$X=b$k.next;else if((b$M=b$k)===b$X){b$V?1===b$V?(b$M=b$J.cureLocalIntersections(b$M,b$y,b$i),b$J.earcutLinked(b$M,b$y,b$i,b$H,b$S,b$f,2)):2===b$V&&b$J.splitEarcut(b$M,b$y,b$i,b$H,b$S,b$f):b$J.earcutLinked(b$J.filterPoints(b$M,null),b$y,b$i,b$H,b$S,b$f,1);break}}},b$J.isEar=function(b$M){var b$y=b$M.prev,b$i=b$M,b$H=b$M.next;if(0<=b$J.area(b$y,b$i,b$H))return!1;for(var b$S=b$M.next.next;b$S!==b$M.prev;){if(b$J.pointInTriangle(b$y.x,b$y.y,b$i.x,b$i.y,b$H.x,b$H.y,b$S.x,b$S.y)&&0<=b$J.area(b$S.prev,b$S,b$S.next))return!1;b$S=b$S.next}return!0},b$J.isEarHashed=function(b$M,b$y,b$i,b$H){var b$S=b$M.prev,b$f=b$M,b$V=b$M.next;if(0<=b$J.area(b$S,b$f,b$V))return!1;for(var b$K=b$S.x<b$f.x?b$S.x<b$V.x?b$S.x:b$V.x:b$f.x<b$V.x?b$f.x:b$V.x,b$k=b$S.y<b$f.y?b$S.y<b$V.y?b$S.y:b$V.y:b$f.y<b$V.y?b$f.y:b$V.y,b$X=b$S.x>b$f.x?b$S.x>b$V.x?b$S.x:b$V.x:b$f.x>b$V.x?b$f.x:b$V.x,b$F=b$S.y>b$f.y?b$S.y>b$V.y?b$S.y:b$V.y:b$f.y>b$V.y?b$f.y:b$V.y,b$o=b$J.zOrder(b$K,b$k,b$y,b$i,b$H),b$d=b$J.zOrder(b$X,b$F,b$y,b$i,b$H),b$P=b$M.nextZ;b$P&&b$P.z<=b$d;){if(b$P!==b$M.prev&&b$P!==b$M.next&&b$J.pointInTriangle(b$S.x,b$S.y,b$f.x,b$f.y,b$V.x,b$V.y,b$P.x,b$P.y)&&0<=b$J.area(b$P.prev,b$P,b$P.next))return!1;b$P=b$P.nextZ}for(b$P=b$M.prevZ;b$P&&b$P.z>=b$o;){if(b$P!==b$M.prev&&b$P!==b$M.next&&b$J.pointInTriangle(b$S.x,b$S.y,b$f.x,b$f.y,b$V.x,b$V.y,b$P.x,b$P.y)&&0<=b$J.area(b$P.prev,b$P,b$P.next))return!1;b$P=b$P.prevZ}return!0},b$J.cureLocalIntersections=function(b$M,b$y,b$i){var b$H=b$M;do{var b$S=b$H.prev,b$f=b$H.next.next;!b$J.equals(b$S,b$f)&&b$J.intersects(b$S,b$H,b$H.next,b$f)&&b$J.locallyInside(b$S,b$f)&&b$J.locallyInside(b$f,b$S)&&(b$y.push(b$S.i/b$i),b$y.push(b$H.i/b$i),b$y.push(b$f.i/b$i),b$J.removeNode(b$H),b$J.removeNode(b$H.next),b$H=b$M=b$f),b$H=b$H.next}while(b$H!==b$M);return b$H},b$J.splitEarcut=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=b$M;do{for(var b$K=b$V.next.next;b$K!==b$V.prev;){if(b$V.i!==b$K.i&&b$J.isValidDiagonal(b$V,b$K)){var b$k=b$J.splitPolygon(b$V,b$K);return b$V=b$J.filterPoints(b$V,b$V.next),b$k=b$J.filterPoints(b$k,b$k.next),b$J.earcutLinked(b$V,b$y,b$i,b$H,b$S,b$f),void b$J.earcutLinked(b$k,b$y,b$i,b$H,b$S,b$f)}b$K=b$K.next}b$V=b$V.next}while(b$V!==b$M)},b$J.eliminateHoles=function(b$M,b$y,b$i,b$H){var b$S,b$f,b$V,b$K,b$k,b$X=[];for(b$S=0,b$f=b$y.length;b$S<b$f;b$S++)b$V=b$y[b$S]*b$H,b$K=b$S<b$f-1?b$y[b$S+1]*b$H:b$M.length,(b$k=b$J.linkedList(b$M,b$V,b$K,b$H,!1))===b$k.next&&(b$k.steiner=!0),b$X.push(b$J.getLeftmost(b$k));for(b$X.sort(b$J.compareX),b$S=0;b$S<b$X.length;b$S++)b$J.eliminateHole(b$X[b$S],b$i),b$i=b$J.filterPoints(b$i,b$i.next);return b$i},b$J.compareX=function(b$M,b$y){return b$M.x-b$y.x},b$J.eliminateHole=function(b$M,b$y){if(b$y=b$J.findHoleBridge(b$M,b$y)){var b$i=b$J.splitPolygon(b$y,b$M);b$J.filterPoints(b$i,b$i.next)}},b$J.findHoleBridge=function(b$M,b$y){var b$i,b$H=b$y,b$S=b$M.x,b$f=b$M.y,b$V=-1/0;do{if(b$f<=b$H.y&&b$f>=b$H.next.y&&b$H.next.y!==b$H.y){var b$K=b$H.x+(b$f-b$H.y)*(b$H.next.x-b$H.x)/(b$H.next.y-b$H.y);if(b$K<=b$S&&b$V<b$K){if((b$V=b$K)===b$S){if(b$f===b$H.y)return b$H;if(b$f===b$H.next.y)return b$H.next}b$i=b$H.x<b$H.next.x?b$H:b$H.next}}b$H=b$H.next}while(b$H!==b$y);if(!b$i)return null;if(b$S===b$V)return b$i.prev;var b$k,b$X=b$i,b$F=b$i.x,b$o=b$i.y,b$d=1/0;for(b$H=b$i.next;b$H!==b$X;)b$S>=b$H.x&&b$H.x>=b$F&&b$S!==b$H.x&&b$J.pointInTriangle(b$f<b$o?b$S:b$V,b$f,b$F,b$o,b$f<b$o?b$V:b$S,b$f,b$H.x,b$H.y)&&((b$k=Math.abs(b$f-b$H.y)/(b$S-b$H.x))<b$d||b$k===b$d&&b$H.x>b$i.x)&&b$J.locallyInside(b$H,b$M)&&(b$i=b$H,b$d=b$k),b$H=b$H.next;return b$i},b$J.indexCurve=function(b$M,b$y,b$i,b$H){for(var b$S=b$M;null===b$S.z&&(b$S.z=b$J.zOrder(b$S.x,b$S.y,b$y,b$i,b$H)),b$S.prevZ=b$S.prev,b$S.nextZ=b$S.next,(b$S=b$S.next)!==b$M;);b$S.prevZ.nextZ=null,b$S.prevZ=null,b$J.sortLinked(b$S)},b$J.sortLinked=function(b$M){var b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X=1;do{for(b$i=b$M,b$f=b$M=null,b$V=0;b$i;){for(b$V++,b$H=b$i,b$y=b$K=0;b$y<b$X&&(b$K++,b$H=b$H.nextZ);b$y++);for(b$k=b$X;0<b$K||0<b$k&&b$H;)0!==b$K&&(0===b$k||!b$H||b$i.z<=b$H.z)?(b$i=(b$S=b$i).nextZ,b$K--):(b$H=(b$S=b$H).nextZ,b$k--),b$f?b$f.nextZ=b$S:b$M=b$S,b$S.prevZ=b$f,b$f=b$S;b$i=b$H}b$f.nextZ=null,b$X*=2}while(1<b$V);return b$M},b$J.zOrder=function(b$M,b$y,b$i,b$H,b$S){return(b$M=1431655765&((b$M=858993459&((b$M=252645135&((b$M=16711935&((b$M=32767*(b$M-b$i)*b$S)|b$M<<8))|b$M<<4))|b$M<<2))|b$M<<1))|(b$y=1431655765&((b$y=858993459&((b$y=252645135&((b$y=16711935&((b$y=32767*(b$y-b$H)*b$S)|b$y<<8))|b$y<<4))|b$y<<2))|b$y<<1))<<1},b$J.getLeftmost=function(b$M){for(var b$y=b$M,b$i=b$M;b$y.x<b$i.x&&(b$i=b$y),(b$y=b$y.next)!==b$M;);return b$i},b$J.pointInTriangle=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){return 0<=(b$S-b$V)*(b$y-b$K)-(b$M-b$V)*(b$f-b$K)&&0<=(b$M-b$V)*(b$H-b$K)-(b$i-b$V)*(b$y-b$K)&&0<=(b$i-b$V)*(b$f-b$K)-(b$S-b$V)*(b$H-b$K)},b$J.isValidDiagonal=function(b$M,b$y){return b$M.next.i!==b$y.i&&b$M.prev.i!==b$y.i&&!b$J.intersectsPolygon(b$M,b$y)&&b$J.locallyInside(b$M,b$y)&&b$J.locallyInside(b$y,b$M)&&b$J.middleInside(b$M,b$y)},b$J.area=function(b$M,b$y,b$i){return(b$y.y-b$M.y)*(b$i.x-b$y.x)-(b$y.x-b$M.x)*(b$i.y-b$y.y)},b$J.equals=function(b$M,b$y){return b$M.x===b$y.x&&b$M.y===b$y.y},b$J.intersects=function(b$M,b$y,b$i,b$H){return!!(b$J.equals(b$M,b$y)&&b$J.equals(b$i,b$H)||b$J.equals(b$M,b$H)&&b$J.equals(b$i,b$y))||0<b$J.area(b$M,b$y,b$i)!=0<b$J.area(b$M,b$y,b$H)&&0<b$J.area(b$i,b$H,b$M)!=0<b$J.area(b$i,b$H,b$y)},b$J.intersectsPolygon=function(b$M,b$y){var b$i=b$M;do{if(b$i.i!==b$M.i&&b$i.next.i!==b$M.i&&b$i.i!==b$y.i&&b$i.next.i!==b$y.i&&b$J.intersects(b$i,b$i.next,b$M,b$y))return!0;b$i=b$i.next}while(b$i!==b$M);return!1},b$J.locallyInside=function(b$M,b$y){return b$J.area(b$M.prev,b$M,b$M.next)<0?0<=b$J.area(b$M,b$y,b$M.next)&&0<=b$J.area(b$M,b$M.prev,b$y):b$J.area(b$M,b$y,b$M.prev)<0||b$J.area(b$M,b$M.next,b$y)<0},b$J.middleInside=function(b$M,b$y){for(var b$i=b$M,b$H=!1,b$S=(b$M.x+b$y.x)/2,b$f=(b$M.y+b$y.y)/2;b$i.y>b$f!=b$i.next.y>b$f&&b$i.next.y!==b$i.y&&b$S<(b$i.next.x-b$i.x)*(b$f-b$i.y)/(b$i.next.y-b$i.y)+b$i.x&&(b$H=!b$H),(b$i=b$i.next)!==b$M;);return b$H},b$J.splitPolygon=function(b$M,b$y){var b$i=new b$SM(b$M.i,b$M.x,b$M.y),b$H=new b$SM(b$y.i,b$y.x,b$y.y),b$S=b$M.next,b$f=b$y.prev;return(b$M.next=b$y).prev=b$M,(b$i.next=b$S).prev=b$i,(b$H.next=b$i).prev=b$H,(b$f.next=b$H).prev=b$f,b$H},b$J.insertNode=function(b$M,b$y,b$i,b$H){var b$S=new b$SM(b$M,b$y,b$i);return b$H?(b$S.next=b$H.next,(b$S.prev=b$H).next.prev=b$S,b$H.next=b$S):(b$S.prev=b$S).next=b$S,b$S},b$J.removeNode=function(b$M){b$M.next.prev=b$M.prev,b$M.prev.next=b$M.next,b$M.prevZ&&(b$M.prevZ.nextZ=b$M.nextZ),b$M.nextZ&&(b$M.nextZ.prevZ=b$M.prevZ)},b$J.signedArea=function(b$M,b$y,b$i,b$H){for(var b$S=0,b$f=b$y,b$V=b$i-b$H;b$f<b$i;b$f+=b$H)b$S+=(b$M[b$V]-b$M[b$f])*(b$M[b$f+1]+b$M[b$V+1]),b$V=b$f;return b$S},b$J}(),b$SM=function(){function b$M(b$M,b$y,b$i){this.i=null,this.x=null,this.y=null,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=null,this.i=b$M,this.x=b$y,this.y=b$i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}return b$d(b$M,"laya.webgl.shapes.EarcutNode"),b$M}(),b$fM=(function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this.lineWidth=b$M,this.lineColor=b$y,this.lineAlpha=b$i,this.fillColor=b$H,this.fillAlpha=b$S,this.shape=b$V,this.fill=b$f}b$d(b$M,"laya.webgl.shapes.GeometryData");var b$y=b$M.prototype;b$y.clone=function(){return new b$M(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},b$y.getIndexData=function(){return null},b$y.getVertexData=function(){return null},b$y.destroy=function(){this.shape=null}}(),function(){function b$M(b$M){if(b$M instanceof Float32Array)this.points=b$M;else if(b$M instanceof Array){b$M.length;this.points=new Float32Array(b$M)}}b$d(b$M,"laya.webgl.shapes.Vertex");var b$y=b$M.prototype;b$I.imps(b$y,{"laya.webgl.shapes.IShape":!0}),b$y.getData=function(b$M,b$y,b$i){},b$y.needUpdate=function(b$M){return!1},b$y.rebuild=function(b$M){},b$y.setMatrix=function(b$M){}}(),function(){function b$k(b$M){void 0===b$M&&(b$M=1e4),this._renderType=b$M}b$d(b$k,"laya.webgl.submit.Submit");var b$M=b$k.prototype;return b$I.imps(b$M,{"laya.webgl.submit.ISubmit":!0}),b$M.releaseRender=function(){var b$M=b$k._cache;(b$M[b$M._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},b$M.getRenderType=function(){return this._renderType},b$M.renderSubmit=function(){if(0===this._numEle)return 1;var b$M=this.shaderValue.textureHost;if(b$M){var b$y=b$M.source;if(!b$M.bitmap||!b$y)return 1;this.shaderValue.texture=b$y,b$M.alphaTexture&&b$M.alphaTexture.source&&(this.shaderValue.texture1=b$M.alphaTexture.source)}this._vb.bind_upload(this._ib);var b$i=b$AM.mainContext;return this.shaderValue.upload(),b$E.activeBlendFunction!==this._blendFn&&(b$i.enable(3042),this._blendFn(b$i),b$E.activeBlendFunction=this._blendFn),b$m.drawCall++,b$m.trianglesFaces+=this._numEle/3,b$i.drawElements(4,this._numEle,5123,this._startIdx),1},b$k.__init__=function(){var b$M=b$k.RENDERBASE=new b$k(-1);b$M.shaderValue=new b$QM(0,0),b$M.shaderValue.ALPHA=-1234},b$k.createSubmit=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$k._cache._length?b$k._cache[--b$k._cache._length]:new b$k;null==b$i&&((b$i=b$f._selfVb||(b$f._selfVb=b$LM.create(-1))).clear(),b$H=0),b$f._ib=b$y,b$f._vb=b$i,b$f._startIdx=b$H*b$JM.BYTES_PIDX,b$f._numEle=0;var b$V=b$M._nBlendType;b$f._blendFn=b$M._targets?b$E.targetFns[b$V]:b$E.fns[b$V],b$f.shaderValue=b$S,b$f.shaderValue.setValue(b$M._shader2D);var b$K=b$M._shader2D.filters;return b$K&&b$f.shaderValue.setFilters(b$K),b$f},b$k.createShape=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=b$k._cache._length?b$k._cache[--b$k._cache._length]:new b$k;b$V._ib=b$y,b$V._vb=b$i,b$V._numEle=b$H,b$V._startIdx=b$S,b$V.shaderValue=b$f,b$V.shaderValue.setValue(b$M._shader2D);var b$K=b$M._nBlendType;return b$V._blendFn=b$M._targets?b$E.targetFns[b$K]:b$E.fns[b$K],b$V},b$k.TYPE_2D=1e4,b$k.TYPE_CANVAS=10003,b$k.TYPE_CMDSETRT=10004,b$k.TYPE_CUSTOM=10005,b$k.TYPE_BLURRT=10006,b$k.TYPE_CMDDESTORYPRERT=10007,b$k.TYPE_DISABLESTENCIL=10008,b$k.TYPE_OTHERIBVB=10009,b$k.TYPE_PRIMITIVE=10010,b$k.TYPE_RT=10011,b$k.TYPE_BLUR_RT=10012,b$k.TYPE_TARGET=10013,b$k.TYPE_CHANGE_VALUE=10014,b$k.TYPE_SHAPE=10015,b$k.TYPE_TEXTURE=10016,b$k.TYPE_FILLTEXTURE=10017,b$k.RENDERBASE=null,b$k._cache=((b$k._cache=[])._length=0,b$k._cache),b$k}()),b$VM=function(){function b$H(){this.fun=null,this.args=null}b$d(b$H,"laya.webgl.submit.SubmitCMD");var b$M=b$H.prototype;return b$I.imps(b$M,{"laya.webgl.submit.ISubmit":!0}),b$M.renderSubmit=function(){return this.fun.apply(null,this.args),1},b$M.getRenderType=function(){return 0},b$M.releaseRender=function(){var b$M=b$H._cache;b$M[b$M._length++]=this},b$H.create=function(b$M,b$y){var b$i=b$H._cache._length?b$H._cache[--b$H._cache._length]:new b$H;return b$i.fun=b$y,b$i.args=b$M,b$i},b$H._cache=((b$H._cache=[])._length=0,b$H._cache),b$H}(),b$KM=function(){function b$y(){this.variables={}}b$d(b$y,"laya.webgl.submit.SubmitCMDScope");var b$M=b$y.prototype;return b$M.getValue=function(b$M){return this.variables[b$M]},b$M.addValue=function(b$M,b$y){return this.variables[b$M]=b$y},b$M.setValue=function(b$M,b$y){return this.variables.hasOwnProperty(b$M)?this.variables[b$M]=b$y:null},b$M.clear=function(){for(var b$M in this.variables)delete this.variables[b$M]},b$M.recycle=function(){this.clear(),b$y.POOL.push(this)},b$y.create=function(){var b$M=b$y.POOL.pop();return b$M||(b$M=new b$y),b$M},b$y.POOL=[],b$y}(),b$kM=function(){function b$o(){this.offset=0,this.startIndex=0,this._mat=b$W.create()}b$d(b$o,"laya.webgl.submit.SubmitOtherIBVB");var b$M=b$o.prototype;return b$I.imps(b$M,{"laya.webgl.submit.ISubmit":!0}),b$M.releaseRender=function(){var b$M=b$o._cache;(b$M[b$M._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},b$M.getRenderType=function(){return 10009},b$M.renderSubmit=function(){var b$M=this._shaderValue.textureHost;if(b$M){var b$y=b$M.source;if(!b$M.bitmap||!b$y)return 1;this._shaderValue.texture=b$y}this._vb.bind_upload(this._ib);var b$i=b$vM.worldMatrix4,b$H=b$W.TEMP;b$W.mulPre(this._mat,b$i[0],b$i[1],b$i[4],b$i[5],b$i[12],b$i[13],b$H);var b$S=b$vM.worldMatrix4=b$o.tempMatrix4;b$S[0]=b$H.a,b$S[1]=b$H.b,b$S[4]=b$H.c,b$S[5]=b$H.d,b$S[12]=b$H.tx,b$S[13]=b$H.ty,this._shader._offset=this.offset,this._shaderValue.refresh(),this._shader.upload(this._shaderValue),this._shader._offset=0;var b$f=b$AM.mainContext;return b$E.activeBlendFunction!==this._blendFn&&(b$f.enable(3042),this._blendFn(b$f),b$E.activeBlendFunction=this._blendFn),b$m.drawCall++,b$m.trianglesFaces+=this._numEle/3,b$f.drawElements(4,this._numEle,5123,this.startIndex),b$vM.worldMatrix4=b$i,b$wM.activeShader=null,1},b$o.create=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){void 0===b$k&&(b$k=0);var b$X=b$o._cache._length?b$o._cache[--b$o._cache._length]:new b$o;b$X._ib=b$i,b$X._vb=b$y,b$X._numEle=b$H,b$X._shader=b$S,b$X._shaderValue=b$f;var b$F=b$M._nBlendType;switch(b$X._blendFn=b$M._targets?b$E.targetFns[b$F]:b$E.fns[b$F],b$k){case 0:b$X.offset=0,b$X.startIndex=b$K/(b$JM.BYTES_PE*b$y.vertexStride)*1.5,b$X.startIndex*=b$JM.BYTES_PIDX;break;case 1:b$X.startIndex=b$V,b$X.offset=b$K}return b$X},b$o._cache=((b$o._cache=[])._length=0,b$o._cache),b$o.tempMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b$o}(),b$XM=function(){function b$i(){this.submitIndex=0,this.submitLength=0,this.context=null,this.clipRect=new b$n,this.screenRect=new b$n}b$d(b$i,"laya.webgl.submit.SubmitScissor");var b$M=b$i.prototype;return b$I.imps(b$M,{"laya.webgl.submit.ISubmit":!0}),b$M._scissor=function(b$M,b$y,b$i,b$H){var b$S=b$vM.worldMatrix4,b$f=b$S[0],b$V=b$S[5],b$K=b$S[12],b$k=b$S[13];if(b$H*=b$V,(b$i*=b$f)<1||b$H<1)return!1;var b$X=(b$M=b$M*b$f+b$K)+b$i,b$F=(b$y=b$y*b$V+b$k)+b$H;b$M<0&&(b$i=b$X-(b$M=0)),b$y<0&&(b$H=b$F-(b$y=0));var b$o=b$vM.worldClipRect;if(b$M=Math.max(b$M,b$o.x),b$y=Math.max(b$y,b$o.y),b$i=Math.min(b$X,b$o.right)-b$M,b$H=Math.min(b$F,b$o.bottom)-b$y,b$i<1||b$H<1)return!1;var b$d=b$vM.worldScissorTest;return this.screenRect.copyFrom(b$o),b$o.x=b$M,b$o.y=b$y,b$o.width=b$i,b$o.height=b$H,b$vM.worldScissorTest=!0,b$y=b$vM.height-b$y-b$H,b$AM.mainContext.scissor(b$M,b$y,b$i,b$H),b$AM.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),b$d?(b$y=b$vM.height-this.screenRect.y-this.screenRect.height,b$AM.mainContext.scissor(this.screenRect.x,b$y,this.screenRect.width,this.screenRect.height),b$AM.mainContext.enable(3089)):(b$AM.mainContext.disable(3089),b$vM.worldScissorTest=!1),b$o.copyFrom(this.screenRect),!0},b$M._scissorWithTagart=function(b$M,b$y,b$i,b$H){if(b$i<1||b$H<1)return!1;var b$S=b$M+b$i,b$f=b$y+b$H;b$M<0&&(b$i=b$S-(b$M=0)),b$y<0&&(b$H=b$f-(b$y=0));var b$V=b$vM.worldClipRect;if(b$M=Math.max(b$M,b$V.x),b$y=Math.max(b$y,b$V.y),b$i=Math.min(b$S,b$V.right)-b$M,b$H=Math.min(b$f,b$V.bottom)-b$y,b$i<1||b$H<1)return!1;var b$K=b$vM.worldScissorTest;return this.screenRect.copyFrom(b$V),b$vM.worldScissorTest=!0,b$V.x=b$M,b$V.y=b$y,b$V.width=b$i,b$V.height=b$H,b$y=b$vM.height-b$y-b$H,b$AM.mainContext.scissor(b$M,b$y,b$i,b$H),b$AM.mainContext.enable(3089),this.context.submitElement(this.submitIndex,this.submitIndex+this.submitLength),b$K?(b$y=b$vM.height-this.screenRect.y-this.screenRect.height,b$AM.mainContext.scissor(this.screenRect.x,b$y,this.screenRect.width,this.screenRect.height),b$AM.mainContext.enable(3089)):(b$AM.mainContext.disable(3089),b$vM.worldScissorTest=!1),b$V.copyFrom(this.screenRect),!0},b$M.renderSubmit=function(){return this.submitLength=Math.min(this.context._submits._length-1,this.submitLength),this.submitLength<1||this.clipRect.width<1||this.clipRect.height<1||(this.context._targets?this._scissorWithTagart(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height):this._scissor(this.clipRect.x,this.clipRect.y,this.clipRect.width,this.clipRect.height)),this.submitLength+1},b$M.getRenderType=function(){return 0},b$M.releaseRender=function(){var b$M=b$i._cache;(b$M[b$M._length++]=this).context=null},b$i.create=function(b$M){var b$y=b$i._cache._length?b$i._cache[--b$i._cache._length]:new b$i;return b$y.context=b$M,b$y},b$i._cache=((b$i._cache=[])._length=0,b$i._cache),b$i}(),b$FM=function(){function b$k(){this.step=0,this.blendMode=null,this.level=0}b$d(b$k,"laya.webgl.submit.SubmitStencil");var b$M=b$k.prototype;return b$I.imps(b$M,{"laya.webgl.submit.ISubmit":!0}),b$M.renderSubmit=function(){switch(this.step){case 1:this.do1();break;case 2:this.do2();break;case 3:this.do3();break;case 4:this.do4();break;case 5:this.do5();break;case 6:this.do6();break;case 7:this.do7();break;case 8:this.do8()}return 1},b$M.getRenderType=function(){return 0},b$M.releaseRender=function(){var b$M=b$k._cache;b$M[b$M._length++]=this},b$M.do1=function(){var b$M=b$AM.mainContext;b$M.enable(2960),b$M.clear(1024),b$M.colorMask(!1,!1,!1,!1),b$M.stencilFunc(514,this.level,255),b$M.stencilOp(7680,7680,7682)},b$M.do2=function(){var b$M=b$AM.mainContext;b$M.stencilFunc(514,this.level+1,255),b$M.colorMask(!0,!0,!0,!0),b$M.stencilOp(7680,7680,7680)},b$M.do3=function(){var b$M=b$AM.mainContext;b$M.colorMask(!0,!0,!0,!0),b$M.stencilOp(7680,7680,7680),b$M.clear(1024),b$M.disable(2960)},b$M.do4=function(){var b$M=b$AM.mainContext;0==this.level&&(b$M.enable(2960),b$M.clear(1024)),b$M.colorMask(!1,!1,!1,!1),b$M.stencilFunc(519,0,255),b$M.stencilOp(7680,7680,7682)},b$M.do5=function(){var b$M=b$AM.mainContext;b$M.stencilFunc(514,this.level,255),b$M.colorMask(!0,!0,!0,!0),b$M.stencilOp(7680,7680,7680)},b$M.do6=function(){var b$M=b$AM.mainContext;b$E.targetFns[b$E.TOINT[this.blendMode]](b$M)},b$M.do7=function(){var b$M=b$AM.mainContext;b$M.colorMask(!1,!1,!1,!1),b$M.stencilOp(7680,7680,7683)},b$M.do8=function(){var b$M=b$AM.mainContext;b$M.colorMask(!0,!0,!0,!0),b$M.stencilFunc(514,this.level,255),b$M.stencilOp(7680,7680,7680)},b$k.restore=function(b$M,b$y,b$i,b$H,b$S){var b$f;if((b$M._renderKey=0)<b$k._mask&&b$k._mask--,0==b$k._mask)b$f=laya.webgl.submit.SubmitStencil.create(3),b$M.addRenderObject(b$f),b$M._curSubmit=b$fM.RENDERBASE;else{b$f=laya.webgl.submit.SubmitStencil.create(7),b$M.addRenderObject(b$f);var b$V=b$M._vb;b$V._byteLength;if(b$hM.fillRectImgVb(b$V,null,b$y.x,b$y.y,b$y.width,b$y.height,b$z.DEF_UV,b$i,b$H,b$S,0,0)){b$M._shader2D.glTexture=null;var b$K=b$M._curSubmit=b$fM.createSubmit(b$M,b$M._ib,b$V,(b$V._byteLength-64)/32*3,b$QM.create(2,0));b$K.shaderValue.ALPHA=1,b$M._submits[b$M._submits._length++]=b$K,b$M._curSubmit._numEle+=6,b$M._curSubmit=b$fM.RENDERBASE}else alert("clipRect calc stencil rect error");b$f=laya.webgl.submit.SubmitStencil.create(8),b$M.addRenderObject(b$f)}},b$k.restore2=function(b$M,b$y){var b$i;(b$M._renderKey=0)<b$k._mask&&b$k._mask--,0==b$k._mask?(b$i=laya.webgl.submit.SubmitStencil.create(3),b$M.addRenderObject(b$i),b$M._curSubmit=b$fM.RENDERBASE):(b$i=laya.webgl.submit.SubmitStencil.create(7),b$M.addRenderObject(b$i),b$M._submits[b$M._submits._length++]=b$y,b$i=laya.webgl.submit.SubmitStencil.create(8),b$M.addRenderObject(b$i))},b$k.create=function(b$M){var b$y=b$k._cache._length?b$k._cache[--b$k._cache._length]:new b$k;return 5==(b$y.step=b$M)&&++b$k._mask,b$y.level=b$k._mask,b$y},b$k._cache=((b$k._cache=[])._length=0,b$k._cache),b$k._mask=0,b$k}(),b$oM=function(){function b$K(){this._renderType=0,this._vb=null,this._ib=null,this._startIdx=0,this._numEle=0,this.shaderValue=null,this.blendType=0,this.proName=null,this.scope=null}b$d(b$K,"laya.webgl.submit.SubmitTarget");var b$M=b$K.prototype;return b$I.imps(b$M,{"laya.webgl.submit.ISubmit":!0}),b$M.renderSubmit=function(){this._vb.bind_upload(this._ib);var b$M=this.scope.getValue(this.proName);return b$M&&(this.shaderValue.texture=b$M.source,this.shaderValue.strength&&!this.shaderValue.blurInfo&&(this.shaderValue.blurInfo=[b$M.width,b$M.height]),this.shaderValue.upload(),this.blend(),b$m.drawCall++,b$m.trianglesFaces+=this._numEle/3,b$AM.mainContext.drawElements(4,this._numEle,5123,this._startIdx)),1},b$M.blend=function(){if(b$E.activeBlendFunction!==b$E.fns[this.blendType]){var b$M=b$AM.mainContext;b$M.enable(3042),b$E.fns[this.blendType](b$M),b$E.activeBlendFunction=b$E.fns[this.blendType]}},b$M.getRenderType=function(){return 0},b$M.releaseRender=function(){var b$M=b$K._cache;(b$M[b$M._length++]=this).shaderValue.release(),this.shaderValue=null,this._vb=null,this._ib=null},b$K.create=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=b$K._cache._length?b$K._cache[--b$K._cache._length]:new b$K;return b$V._ib=b$y,b$V._vb=b$i,b$V.proName=b$f,b$V._startIdx=b$H*b$JM.BYTES_PIDX,b$V._numEle=0,b$V.blendType=b$M._nBlendType,b$V.shaderValue=b$S,b$V.shaderValue.setValue(b$M._shader2D),b$V},b$K._cache=((b$K._cache=[])._length=0,b$K._cache),b$K}(),b$dM=function(){function b$M(){this._sourceStr=null}b$d(b$M,"laya.webgl.text.CharSegment");var b$y=b$M.prototype;return b$I.imps(b$y,{"laya.webgl.text.ICharSegment":!0}),b$y.textToSpit=function(b$M){this._sourceStr=b$M},b$y.getChar=function(b$M){return this._sourceStr.charAt(b$M)},b$y.getCharCode=function(b$M){return this._sourceStr.charCodeAt(b$M)},b$y.length=function(){return this._sourceStr.length},b$M}(),b$PM=function(){var b$M;function b$m(){}return b$d(b$m,"laya.webgl.text.DrawText"),b$m.__init__=function(){b$m._charsTemp=new Array,b$m._drawValue=new b$M,b$m._charSeg=new b$dM},b$m.customCharSeg=function(b$M){b$m._charSeg=b$M},b$m.getChar=function(b$M,b$y,b$i){var b$H=b$YM.createOneChar(b$M,b$i);return-1!=b$y&&(b$m._charsCache[b$y]=b$H),b$H},b$m._drawSlow=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F,b$o,b$d,b$P,b$l){var b$J,b$h,b$C=b$m._drawValue.value(b$f,b$K,b$k,b$X,b$d,b$P,b$l),b$v=0,b$R=0,b$A=b$m._charsTemp,b$G=0,b$I=NaN;if(b$H)for(b$A.length=b$H.length,b$v=0,b$R=b$H.length;b$v<b$R;b$v++)(b$h=b$H[b$v])&&(b$I=b$h.charNum+b$C.txtID,b$A[b$v]=b$J=b$m._charsCache[b$I]||b$m.getChar(b$h.char,b$I,b$C),b$J.active());else{var b$U=b$i instanceof laya.utils.WordText?b$i.toString():b$i;if(b$D.CharacterCache){b$m._charSeg.textToSpit(b$U);var b$Q=b$m._charSeg.length();for(b$v=0,b$R=b$A.length=b$Q;b$v<b$R;b$v++)b$I=b$m._charSeg.getCharCode(b$v)+b$C.txtID,b$A[b$v]=b$J=b$m._charsCache[b$I]||b$m.getChar(b$m._charSeg.getChar(b$v),b$I,b$C),b$J.active(),b$G+=b$J.cw}else b$A.length=0,(b$J=b$m.getChar(b$U,-1,b$C)).active(),b$G+=b$J.cw,b$A[0]=b$J}var b$W=0;null!==b$V&&"left"!==b$V&&(b$W=-("center"==b$V?b$G/2:b$G));var b$c,b$n,b$a=NaN,b$T=0;if(b$H)for(b$v=0,b$R=b$A.length;b$v<b$R;b$v++)b$J=b$A[b$v],b$h=b$H[b$v],b$J&&b$h&&!b$J.isSpace&&(b$a=b$J.borderSize,b$c=b$J.texture,b$y._drawText(b$c,b$F+b$W+b$h.x*b$d-b$a,b$o+b$h.y*b$P-b$a,b$c.width,b$c.height,b$S,0,0,0,0));else{for(b$v=0,b$R=b$A.length;b$v<b$R;b$v++)(b$J=b$A[b$v])&&!b$J.isSpace&&(b$a=b$J.borderSize,b$c=b$J.texture,b$y._drawText(b$c,b$F+b$W-b$a,b$o-b$a,b$c.width,b$c.height,b$S,0,0,0,0),b$M&&((b$n=b$M[b$T++])||(b$n=b$M[b$T-1]=[]),b$n[0]=b$c,b$n[1]=b$W-b$a,b$n[2]=-b$a)),b$W+=b$J.cw;b$M&&(b$M.length=b$T)}},b$m._drawFast=function(b$M,b$y,b$i,b$H,b$S){for(var b$f,b$V,b$K=0,b$k=b$M.length;b$K<b$k;b$K++)(b$f=(b$V=b$M[b$K])[0]).active(),b$y._drawText(b$f,b$H+b$V[1],b$S+b$V[2],b$f.width,b$f.height,b$i,0,0,0,0)},b$m.drawText=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F,b$o){if(void 0===b$o&&(b$o=0),!(b$y&&0===b$y.length||b$i&&0===b$i.length)){var b$d=b$H.a,b$P=b$H.d;(0!==b$H.b||0!==b$H.c)&&(b$d=b$P=1);var b$l=1!==b$d||1!==b$P;if(b$l&&b$I.stage.transform){var b$J=b$I.stage.transform;b$l=b$J.a===b$d&&b$J.d===b$P}else b$l=!1;if(b$l){var b$h=(b$H=b$H.copyTo(b$UM._tmpMatrix)).tx,b$C=b$H.ty;b$H.scale(1/b$d,1/b$P),b$H._checkTransform(),b$X*=b$d,b$F*=b$P,b$X+=b$h-b$H.tx,b$F+=b$C-b$H.ty}else b$d=b$P=1;if(b$i)b$m._drawSlow(null,b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F,b$d,b$P,b$o);else{if(null===b$y.toUpperCase){var b$v=b$d+1e5*b$P,b$R=b$y;return void(b$R.changed||b$R.id!==b$v?(b$R.id=b$v,b$R.changed=!1,b$m._drawSlow(b$R.save,b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F,b$d,b$P,b$o)):b$m._drawFast(b$R.save,b$M,b$H,b$X,b$F))}var b$A=b$y+b$S.toString()+b$V+b$K+b$k+b$d+b$P+b$f,b$G=b$m._textsCache[b$A];b$D.CharacterCache?b$G?b$m._drawFast(b$G,b$M,b$H,b$X,b$F):(b$m._textsCache.__length||(b$m._textsCache.__length=0),b$m._textsCache.__length>b$U.WebGLTextCacheCount&&((b$m._textsCache={}).__length=0,b$m._curPoolIndex=0),b$m._textCachesPool[b$m._curPoolIndex]?(b$G=b$m._textsCache[b$A]=b$m._textCachesPool[b$m._curPoolIndex]).length=0:b$m._textCachesPool[b$m._curPoolIndex]=b$G=b$m._textsCache[b$A]=[],b$m._textsCache.__length++,b$m._curPoolIndex++,b$m._drawSlow(b$G,b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F,b$d,b$P,b$o)):b$m._drawSlow(b$G,b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F,b$d,b$P,b$o)}}},b$m._charsTemp=null,b$m._textCachesPool=[],b$m._curPoolIndex=0,b$m._charsCache={},b$m._textsCache={},b$m._drawValue=null,b$m.d=[],b$m._charSeg=null,b$m.__init$=function(){b$M=function(){function b$k(){}return b$d(b$k,""),b$k.prototype.value=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this.font=b$M,this.fillColor=b$y,this.borderColor=b$i,this.lineWidth=b$H,this.scaleX=b$S,this.scaleY=b$f,this.underLine=b$V;var b$K=b$M.toString()+b$S+b$f+b$H+(b$y?b$y.toLowerCase():" ")+(b$i?b$i.toLowerCase():" ")+b$V;return this.txtID=b$k._keymap[b$K],this.txtID||(this.txtID=1e-7*++b$k._keymapCount,b$k._keymap[b$K]=this.txtID),this},b$k.clear=function(){b$k._keymap={},b$k._keymapCount=1},b$k._keymap={},b$k._keymapCount=1,b$k}()},b$m}(),b$lM=function(){function b$S(b$M){this._index=0,this._size=14,this._italic=-2,b$S._cache2=b$S._cache2||[],this.setFont(b$M||"14px Arial")}b$d(b$S,"laya.webgl.text.FontInContext");var b$M=b$S.prototype;return b$M.setFont=function(b$M){var b$y=b$S._cache2[b$M];if(b$y)this._words=b$y[0],this._size=b$y[1];else{this._words=b$M.split(" ");for(var b$i=0,b$H=this._words.length;b$i<b$H;b$i++)if(0<this._words[b$i].indexOf("px")){this._index=b$i;break}this._size=parseInt(this._words[this._index]),b$S._cache2[b$M]=[this._words,this._size]}this._text=null,this._italic=-2},b$M.getItalic=function(){return-2===this._italic&&(this._italic=this.hasType("italic")),this._italic},b$M.hasType=function(b$M){for(var b$y=0,b$i=this._words.length;b$y<b$i;b$y++)if(this._words[b$y]===b$M)return b$y;return-1},b$M.removeType=function(b$M){for(var b$y=0,b$i=this._words.length;b$y<b$i;b$y++)if(this._words[b$y]===b$M){this._words.splice(b$y,1),this._index>b$y&&this._index--;break}this._text=null,this._italic=-2},b$M.copyTo=function(b$M){return b$M._text=this._text,b$M._size=this._size,b$M._index=this._index,b$M._words=this._words.slice(),b$M._italic=-2,b$M},b$M.toString=function(){return this._text?this._text:this._text=this._words.join(" ")},b$H(0,b$M,"size",function(){return this._size},function(b$M){this._size=b$M,this._words[this._index]=b$M+"px",this._text=null}),b$S.create=function(b$M){var b$y=b$S._cache[b$M];return b$y||(b$y=b$S._cache[b$M]=new b$S(b$M))},b$S.EMPTY=new b$S,b$S._cache={},b$S._cache2=null,b$S}(),b$JM=function(){function b$M(){}return b$d(b$M,"laya.webgl.utils.CONST3D2D"),b$M.defaultMatrix4=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b$M.defaultMinusYMatrix4=[1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1],b$M.uniformMatrix3=[1,0,0,0,0,1,0,0,0,0,1,0],b$M._TMPARRAY=[],b$M._OFFSETX=0,b$M._OFFSETY=0,b$V(b$M,["BYTES_PE",function(){return this.BYTES_PE=Float32Array.BYTES_PER_ELEMENT},"BYTES_PIDX",function(){return this.BYTES_PIDX=Uint16Array.BYTES_PER_ELEMENT}]),b$M}(),b$hM=function(){function b$l(){}return b$d(b$l,"laya.webgl.utils.GlUtils"),b$l.make2DProjection=function(b$M,b$y,b$i){return[2/b$M,0,0,0,0,-2/b$y,0,0,0,0,2/b$i,0,-1,1,0,1]},b$l.fillIBQuadrangle=function(b$M,b$y){if(65535/4<b$y)throw Error("IBQuadrangle count:"+b$y+" must<:"+Math.floor(65535/4));b$y=Math.floor(b$y),b$M._resizeBuffer(6*(b$y+1)*2,!1),b$M.byteLength=b$M.bufferLength;for(var b$i=b$M.getUint16Array(),b$H=0,b$S=0;b$S<b$y;b$S++)b$i[b$H++]=4*b$S,b$i[b$H++]=4*b$S+2,b$i[b$H++]=4*b$S+1,b$i[b$H++]=4*b$S,b$i[b$H++]=4*b$S+3,b$i[b$H++]=4*b$S+2;return b$M.setNeedUpload(),!0},b$l.expandIBQuadrangle=function(b$M,b$y){b$M.bufferLength>=6*b$y*2||b$l.fillIBQuadrangle(b$M,b$y)},b$l.mathCeilPowerOfTwo=function(b$M){return b$M--,b$M|=b$M>>1,b$M|=b$M>>2,b$M|=b$M>>4,b$M|=b$M>>8,b$M|=b$M>>16,++b$M},b$l.fillQuadrangleImgVb=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){var b$k=16+(b$M._byteLength>>2);b$M.byteLength=b$k<<2;var b$X=b$M.getFloat32Array();b$X[(b$k-=16)+2]=b$S[0],b$X[b$k+3]=b$S[1],b$X[b$k+6]=b$S[2],b$X[b$k+7]=b$S[3],b$X[b$k+10]=b$S[4],b$X[b$k+11]=b$S[5],b$X[b$k+14]=b$S[6],b$X[b$k+15]=b$S[7];var b$F=b$f.a,b$o=b$f.b,b$d=b$f.c,b$P=b$f.d;if(1!==b$F||0!==b$o||0!==b$d||1!==b$P){b$f.bTransform=!0;var b$l=b$f.tx+b$V,b$J=b$f.ty+b$K;b$X[b$k]=(b$H[0]+b$y)*b$F+(b$H[1]+b$i)*b$d+b$l,b$X[b$k+1]=(b$H[0]+b$y)*b$o+(b$H[1]+b$i)*b$P+b$J,b$X[b$k+4]=(b$H[2]+b$y)*b$F+(b$H[3]+b$i)*b$d+b$l,b$X[b$k+5]=(b$H[2]+b$y)*b$o+(b$H[3]+b$i)*b$P+b$J,b$X[b$k+8]=(b$H[4]+b$y)*b$F+(b$H[5]+b$i)*b$d+b$l,b$X[b$k+9]=(b$H[4]+b$y)*b$o+(b$H[5]+b$i)*b$P+b$J,b$X[b$k+12]=(b$H[6]+b$y)*b$F+(b$H[7]+b$i)*b$d+b$l,b$X[b$k+13]=(b$H[6]+b$y)*b$o+(b$H[7]+b$i)*b$P+b$J}else b$f.bTransform=!1,b$y+=b$f.tx+b$V,b$i+=b$f.ty+b$K,b$X[b$k]=b$y+b$H[0],b$X[b$k+1]=b$i+b$H[1],b$X[b$k+4]=b$y+b$H[2],b$X[b$k+5]=b$i+b$H[3],b$X[b$k+8]=b$y+b$H[4],b$X[b$k+9]=b$i+b$H[5],b$X[b$k+12]=b$y+b$H[6],b$X[b$k+13]=b$i+b$H[7];return b$M._upload=!0},b$l.fillTranglesVB=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){var b$K=(b$M._byteLength>>2)+b$H.length;b$M.byteLength=b$K<<2;var b$k=b$M.getFloat32Array();b$K-=b$H.length;for(var b$X=b$H.length,b$F=b$S.a,b$o=b$S.b,b$d=b$S.c,b$P=b$S.d,b$l=0;b$l<b$X;b$l+=4)if(b$k[b$K+b$l+2]=b$H[b$l+2],b$k[b$K+b$l+3]=b$H[b$l+3],1!==b$F||0!==b$o||0!==b$d||1!==b$P){b$S.bTransform=!0;var b$J=b$S.tx+b$f,b$h=b$S.ty+b$V;b$k[b$K+b$l]=(b$H[b$l]+b$y)*b$F+(b$H[b$l+1]+b$i)*b$d+b$J,b$k[b$K+b$l+1]=(b$H[b$l]+b$y)*b$o+(b$H[b$l+1]+b$i)*b$P+b$h}else b$S.bTransform=!1,b$y+=b$S.tx+b$f,b$i+=b$S.ty+b$V,b$k[b$K+b$l]=b$y+b$H[b$l],b$k[b$K+b$l+1]=b$i+b$H[b$l+1];return b$M._upload=!0},b$l.copyPreImgVb=function(b$M,b$y,b$i){var b$H=b$M._byteLength>>2;b$M.byteLength=b$H+16<<2;for(var b$S=b$M.getFloat32Array(),b$f=0,b$V=b$H-16;b$f<4;b$f++)b$S[b$H]=b$S[b$V]+b$y,++b$V,b$S[++b$H]=b$S[b$V]+b$i,++b$V,b$S[++b$H]=b$S[b$V],++b$V,b$S[++b$H]=b$S[b$V],++b$H,++b$V;b$M._upload=!0},b$l.fillRectImgVb=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F,b$o,b$d){void 0===b$d&&(b$d=!1);var b$P,b$l,b$J,b$h,b$C,b$v,b$R,b$A,b$G,b$I,b$U,b$Q,b$W,b$c,b$n,b$a,b$T=1,b$m=b$K.a,b$e=b$K.b,b$s=b$K.c,b$D=b$K.d,b$z=b$y&&b$y.width<99999999;if(1!==b$m||0!==b$e||0!==b$s||1!==b$D?(b$K.bTransform=!0,0===b$e&&0===b$s&&(b$T=23,b$G=b$S+b$i,b$I=b$f+b$H,b$P=b$m*b$i+(b$U=b$K.tx+b$k),b$J=b$m*b$G+b$U,b$l=b$D*b$H+(b$Q=b$K.ty+b$X),b$h=b$D*b$I+b$Q)):(b$T=23,b$K.bTransform=!1,b$J=(b$P=b$i+b$K.tx+b$k)+b$S,b$h=(b$l=b$H+b$K.ty+b$X)+b$f),b$z&&(b$C=b$y.x,b$v=b$y.y,b$R=b$y.width+b$C,b$A=b$y.height+b$v),1!==b$T){if(Math.min(b$P,b$J)>=b$R)return!1;if(Math.min(b$l,b$h)>=b$A)return!1;if(Math.max(b$J,b$P)<=b$C)return!1;if(Math.max(b$h,b$l)<=b$v)return!1}var b$w=b$M._byteLength>>2;b$M.byteLength=16+b$w<<2;var b$q=b$M.getFloat32Array();switch(b$q[2+b$w]=b$V[0],b$q[3+b$w]=b$V[1],b$q[6+b$w]=b$V[2],b$q[7+b$w]=b$V[3],b$q[10+b$w]=b$V[4],b$q[11+b$w]=b$V[5],b$q[14+b$w]=b$V[6],b$q[15+b$w]=b$V[7],b$T){case 1:b$U=b$K.tx+b$k,b$Q=b$K.ty+b$X;var b$t=b$m*b$i,b$u=b$s*b$H,b$p=b$D*b$H,b$B=b$e*b$i,b$Z=b$m*(b$G=b$S+b$i),b$E=b$s*(b$I=b$f+b$H),b$_=b$D*b$I,b$b=b$e*b$G;b$d?(b$W=b$t+b$u+b$U,b$n=Math.round(b$W)-b$W,b$c=b$p+b$B+b$Q,b$a=Math.round(b$c)-b$c,b$q[b$w]=b$W+b$n,b$q[1+b$w]=b$c+b$a,b$q[4+b$w]=b$Z+b$u+b$U+b$n,b$q[5+b$w]=b$p+b$b+b$Q+b$a,b$q[8+b$w]=b$Z+b$E+b$U+b$n,b$q[9+b$w]=b$_+b$b+b$Q+b$a,b$q[12+b$w]=b$t+b$E+b$U+b$n,b$q[13+b$w]=b$_+b$B+b$Q+b$a):(b$q[b$w]=b$t+b$u+b$U,b$q[1+b$w]=b$p+b$B+b$Q,b$q[4+b$w]=b$Z+b$u+b$U,b$q[5+b$w]=b$p+b$b+b$Q,b$q[8+b$w]=b$Z+b$E+b$U,b$q[9+b$w]=b$_+b$b+b$Q,b$q[12+b$w]=b$t+b$E+b$U,b$q[13+b$w]=b$_+b$B+b$Q);break;case 23:b$d?(b$W=b$P+b$F,b$n=Math.round(b$W)-b$W,b$c=b$l,b$a=Math.round(b$c)-b$c,b$q[b$w]=b$W+b$n,b$q[1+b$w]=b$c+b$a,b$q[4+b$w]=b$J+b$F+b$n,b$q[5+b$w]=b$l+b$a,b$q[8+b$w]=b$J+b$n,b$q[9+b$w]=b$h+b$a,b$q[12+b$w]=b$P+b$n,b$q[13+b$w]=b$h+b$a):(b$q[b$w]=b$P+b$F,b$q[1+b$w]=b$l,b$q[4+b$w]=b$J+b$F,b$q[5+b$w]=b$l,b$q[8+b$w]=b$J,b$q[9+b$w]=b$h,b$q[12+b$w]=b$P,b$q[13+b$w]=b$h)}return b$M._upload=!0},b$l.fillLineVb=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){var b$k=.5*b$V,b$X=b$l._fillLineArray,b$F=-(b$H-b$f),b$o=b$i-b$S,b$d=Math.sqrt(b$F*b$F+b$o*b$o);b$F/=b$d,b$o/=b$d,b$F*=b$k,b$o*=b$k,b$X[0]=b$i-b$F,b$X[1]=b$H-b$o,b$X[4]=b$i+b$F,b$X[5]=b$H+b$o,b$X[8]=b$S+b$F,b$X[9]=b$f+b$o,b$X[12]=b$S-b$F,b$X[13]=b$f-b$o,b$K&&b$K.transformPointArray(b$X,b$X);var b$P=16+(b$M._byteLength>>2);return b$M.byteLength=b$P<<2,b$M.insertData(b$X,b$P-16),!0},b$l._fillLineArray=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],b$l}(),b$CM=(function(){function b$k(){}b$d(b$k,"laya.webgl.utils.MatirxArray"),b$k.ArrayMul=function(b$M,b$y,b$i){if(b$M)if(b$y)for(var b$H=NaN,b$S=NaN,b$f=NaN,b$V=NaN,b$K=0;b$K<4;b$K++)b$H=b$M[b$K],b$S=b$M[b$K+4],b$f=b$M[b$K+8],b$V=b$M[b$K+12],b$i[b$K]=b$H*b$y[0]+b$S*b$y[1]+b$f*b$y[2]+b$V*b$y[3],b$i[b$K+4]=b$H*b$y[4]+b$S*b$y[5]+b$f*b$y[6]+b$V*b$y[7],b$i[b$K+8]=b$H*b$y[8]+b$S*b$y[9]+b$f*b$y[10]+b$V*b$y[11],b$i[b$K+12]=b$H*b$y[12]+b$S*b$y[13]+b$f*b$y[14]+b$V*b$y[15];else b$k.copyArray(b$M,b$i);else b$k.copyArray(b$y,b$i)},b$k.copyArray=function(b$M,b$y){if(b$M&&b$y)for(var b$i=0;b$i<b$M.length;b$i++)b$y[b$i]=b$M[b$i]}}(),function(){function b$y(b$M,b$y,b$i){this._stride=0,this.vertNum=0,this.indexNum=0,this._applied=!1,this._vb=null,this._ib=null,this._vao=null,this._attribInfo=null,this._quadNum=0,this.canReuse=!1,this._stride=b$M,this._vb=new b$LM(b$M,35048),b$y&&this._vb._resizeBuffer(b$y,!1),this._ib=new b$OM,b$i&&this._ib._resizeBuffer(b$i,!1)}b$d(b$y,"laya.webgl.utils.Mesh2D");var b$M=b$y.prototype;return b$M.cloneWithNewVB=function(){var b$M=new b$y(this._stride,0,0);return b$M._ib=this._ib,b$M._quadNum=this._quadNum,b$M._attribInfo=this._attribInfo,b$M},b$M.cloneWithNewVBIB=function(){var b$M=new b$y(this._stride,0,0);return b$M._attribInfo=this._attribInfo,b$M},b$M.getVBW=function(){return this._vb.setNeedUpload(),this._vb},b$M.getVBR=function(){return this._vb},b$M.getIBR=function(){return this._ib},b$M.getIBW=function(){return this._ib.setNeedUpload(),this._ib},b$M.createQuadIB=function(b$M){this._quadNum=b$M,this._ib._resizeBuffer(6*b$M*2,!1),this._ib.byteLength=this._ib.bufferLength;for(var b$y=this._ib.getUint16Array(),b$i=0,b$H=0,b$S=0;b$S<b$M;b$S++)b$y[b$i++]=b$H,b$y[b$i++]=b$H+2,b$y[b$i++]=b$H+1,b$y[b$i++]=b$H,b$y[b$i++]=b$H+3,b$y[b$i++]=b$H+2,b$H+=4;this._ib.setNeedUpload()},b$M.setAttributes=function(b$M){if(this._attribInfo=b$M,this._attribInfo.length%3!=0)throw"Mesh2D setAttributes error!"},b$M.getEleNum=function(){return this._ib.getBuffer().byteLength/2},b$M.releaseMesh=function(){},b$M.destroy=function(){},b$M.clearVB=function(){this._vb.clear()},b$y._gvaoid=0,b$y}()),b$vM=function(){function b$S(){}return b$d(b$S,"laya.webgl.utils.RenderState2D"),b$S.getMatrArray=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},b$S.mat2MatArray=function(b$M,b$y){var b$i=b$M,b$H=b$y;return b$H[0]=b$i.a,b$H[1]=b$i.b,b$H[2]=b$S.EMPTYMAT4_ARRAY[2],b$H[3]=b$S.EMPTYMAT4_ARRAY[3],b$H[4]=b$i.c,b$H[5]=b$i.d,b$H[6]=b$S.EMPTYMAT4_ARRAY[6],b$H[7]=b$S.EMPTYMAT4_ARRAY[7],b$H[8]=b$S.EMPTYMAT4_ARRAY[8],b$H[9]=b$S.EMPTYMAT4_ARRAY[9],b$H[10]=b$S.EMPTYMAT4_ARRAY[10],b$H[11]=b$S.EMPTYMAT4_ARRAY[11],b$H[12]=b$i.tx,b$H[13]=b$i.ty,b$H[14]=b$S.EMPTYMAT4_ARRAY[14],b$H[15]=b$S.EMPTYMAT4_ARRAY[15],b$y},b$S.restoreTempArray=function(){b$S.TEMPMAT4_ARRAY[0]=1,b$S.TEMPMAT4_ARRAY[1]=0,b$S.TEMPMAT4_ARRAY[4]=0,b$S.TEMPMAT4_ARRAY[5]=1,b$S.TEMPMAT4_ARRAY[12]=0,b$S.TEMPMAT4_ARRAY[13]=0},b$S.clear=function(){b$S.worldScissorTest=!1,b$S.worldShaderDefines=null,b$S.worldFilters=null,b$S.worldAlpha=1,b$S.worldClipRect.x=b$S.worldClipRect.y=0,b$S.worldClipRect.width=b$S.width,b$S.worldClipRect.height=b$S.height,b$S.curRenderTarget=null},b$S._MAXSIZE=99999999,b$S.EMPTYMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b$S.worldMatrix4=b$S.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b$S.worldAlpha=1,b$S.worldScissorTest=!1,b$S.worldFilters=null,b$S.worldShaderDefines=null,b$S.curRenderTarget=null,b$S.width=0,b$S.height=0,b$V(b$S,["worldMatrix",function(){return this.worldMatrix=new b$W},"worldClipRect",function(){return this.worldClipRect=new b$n(0,0,99999999,99999999)}]),b$S}(),b$RM=function(){var b$v,b$i;function b$R(b$M,b$y,b$i,b$H,b$S){var b$f=this;function b$V(b$M){var b$y=[],b$i=new b$v(b$y);return b$f._compileToTree(b$i,b$M.split("\n"),0,b$y,b$S),b$i}var b$K=b$P.now();this._VS=b$V(b$y),this._PS=b$V(b$i),this._nameMap=b$H,2<b$P.now()-b$K&&console.log("ShaderCompile use time:"+(b$P.now()-b$K)+"  size:"+b$y.length+"/"+b$i.length)}b$d(b$R,"laya.webgl.utils.ShaderCompile");var b$M=b$R.prototype;return b$M._compileToTree=function(b$M,b$y,b$i,b$H,b$S){var b$f,b$V,b$K,b$k,b$X,b$F,b$o,b$d=0,b$P=0,b$l=0,b$J=0;for(b$P=b$i;b$P<b$y.length;b$P++)if(!((b$K=b$y[b$P]).length<1)&&0!==(b$d=b$K.indexOf("//"))){if(0<=b$d&&(b$K=b$K.substr(0,b$d)),b$f=b$o||new b$v(b$H),b$o=null,b$f.text=b$K,b$f.noCompile=!0,0<=(b$d=b$K.indexOf("#"))){for(b$k="#",b$J=b$d+1,b$l=b$K.length;b$J<b$l;b$J++){var b$h=b$K.charAt(b$J);if(" "===b$h||"\t"===b$h||"\r"===b$h||"\n"===b$h||"?"===b$h)break;b$k+=b$h}switch(b$f.name=b$k){case"#ifdef":case"#ifndef":if(b$f.src=b$K,b$f.noCompile=null!=b$K.match(/[!&|()=<>]/),b$f.noCompile?console.log("function():Boolean{return "+b$K.substr(b$d+b$f.name.length)+"}"):(b$F=b$K.replace(/^\s*/,"").split(/\s+/),b$f.setCondition(b$F[1],"#ifdef"===b$k?1:2),b$f.text="//"+b$f.text),b$f.setParent(b$M),b$M=b$f,b$S)for(b$F=b$K.substr(b$J).split(b$R._splitToWordExps3),b$J=0;b$J<b$F.length;b$J++)(b$K=b$F[b$J]).length&&(b$S[b$K]=!0);continue;case"#if":if(b$f.src=b$K,b$f.noCompile=!0,b$f.setParent(b$M),b$M=b$f,b$S)for(b$F=b$K.substr(b$J).split(b$R._splitToWordExps3),b$J=0;b$J<b$F.length;b$J++)(b$K=b$F[b$J]).length&&"defined"!=b$K&&(b$S[b$K]=!0);continue;case"#else":b$f.src=b$K,b$V=(b$M=b$M.parent).childs[b$M.childs.length-1],b$f.noCompile=b$V.noCompile,b$f.noCompile||(b$f.condition=b$V.condition,b$f.conditionType=1==b$V.conditionType?2:1,b$f.text="//"+b$f.text+" "+b$V.text+" "+b$f.conditionType),b$f.setParent(b$M),b$M=b$f;continue;case"#endif":b$V=(b$M=b$M.parent).childs[b$M.childs.length-1],b$f.noCompile=b$V.noCompile,b$f.noCompile||(b$f.text="//"+b$f.text),b$f.setParent(b$M);continue;case"#include":b$F=b$R.splitToWords(b$K,null);var b$C=b$R.includes[b$F[1]];if(!b$C)throw"ShaderCompile error no this include file:"+b$F[1];if((b$d=b$F[0].indexOf("?"))<0){b$f.setParent(b$M),b$K=b$C.getWith("with"==b$F[2]?b$F[3]:null),this._compileToTree(b$f,b$K.split("\n"),0,b$H,b$S),b$f.text="";continue}b$f.setCondition(b$F[0].substr(b$d+1),1),b$f.text=b$C.getWith("with"==b$F[2]?b$F[3]:null);break;case"#import":b$X=(b$F=b$R.splitToWords(b$K,null))[1],b$H.push({node:b$f,file:b$R.includes[b$X],ofs:b$f.text.length});continue}}else{if((b$V=b$M.childs[b$M.childs.length-1])&&!b$V.name){0<b$H.length&&b$R.splitToWords(b$K,b$V),b$o=b$f,b$V.text+="\n"+b$K;continue}0<b$H.length&&b$R.splitToWords(b$K,b$f)}b$f.setParent(b$M)}},b$M.createShader=function(b$M,b$y,b$i){var b$H={},b$S="";if(b$M)for(var b$f in b$M)b$S+="#define "+b$f+"\n",b$H[b$f]=!0;var b$V=this._VS.toscript(b$H,[]),b$K=this._PS.toscript(b$H,[]);return(b$i||b$$M.create)(b$S+b$V.join("\n"),b$S+b$K.join("\n"),b$y,this._nameMap)},b$R._parseOne=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V={type:b$R.shaderParamsMap[b$i[b$H+1]],name:b$i[b$H+2],size:isNaN(parseInt(b$i[b$H+3]))?1:parseInt(b$i[b$H+3])};return b$f&&("attribute"==b$S?b$M.push(b$V):b$y.push(b$V)),":"==b$i[b$H+3]&&(b$V.type=b$i[b$H+4],b$H+=2),b$H+=2},b$R.addInclude=function(b$M,b$y){if(!b$y||0===b$y.length)throw new Error("add shader include file err:"+b$M);if(b$R.includes[b$M])throw new Error("add shader include file err, has add:"+b$M);b$R.includes[b$M]=new b$i(b$y)},b$R.preGetParams=function(b$M,b$y){var b$i=[b$M,b$y],b$H={},b$S=[],b$f=[],b$V={},b$K=[];b$H.attributes=b$S,b$H.uniforms=b$f,b$H.defines=b$V;for(var b$k=0,b$X=0,b$F=0;b$F<2;b$F++){b$i[b$F]=b$i[b$F].replace(b$R._removeAnnotation,"");var b$o,b$d=b$i[b$F].match(b$R._reg);for(b$k=0,b$X=b$d.length;b$k<b$X;b$k++){var b$P=b$d[b$k];if("attribute"==b$P||"uniform"==b$P)b$k=b$R._parseOne(b$S,b$f,b$d,b$k,b$P,!0);else{if("#define"==b$P){b$K[b$P=b$d[++b$k]]=1;continue}if("#ifdef"==b$P){b$V[b$o=b$d[++b$k]]=b$V[b$o]||[];for(b$k++;b$k<b$X;b$k++)if("attribute"==(b$P=b$d[b$k])||"uniform"==b$P)b$k=b$R._parseOne(b$S,b$f,b$d,b$k,b$P,b$K[b$o]);else if("#else"==b$P)for(b$k++;b$k<b$X;b$k++)if("attribute"==(b$P=b$d[b$k])||"uniform"==b$P)b$k=b$R._parseOne(b$S,b$f,b$d,b$k,b$P,!b$K[b$o]);else if("#endif"==b$P)break}}}}return b$H},b$R.splitToWords=function(b$M,b$y){for(var b$i,b$H,b$S=[],b$f=-1,b$V=0,b$K=b$M.length;b$V<b$K;b$V++)if(b$i=b$M.charAt(b$V),0<=" \t=+-*/&%!<>()'\",;".indexOf(b$i)){if(0<=b$f&&1<b$V-b$f&&(b$H=b$M.substr(b$f,b$V-b$f),b$S.push(b$H)),'"'==b$i||"'"==b$i){var b$k=b$M.indexOf(b$i,b$V+1);if(b$k<0)throw"Sharder err:"+b$M;b$S.push(b$M.substr(b$V+1,b$k-b$V-1)),b$V=b$k,b$f=-1;continue}"("==b$i&&b$y&&0<b$S.length&&(b$H=b$S[b$S.length-1]+";","vec4;main;".indexOf(b$H)<0&&(b$y.useFuns+=b$H)),b$f=-1}else b$f<0&&(b$f=b$V);return b$f<b$K&&1<b$K-b$f&&(b$H=b$M.substr(b$f,b$K-b$f),b$S.push(b$H)),b$S},b$R.IFDEF_NO=0,b$R.IFDEF_YES=1,b$R.IFDEF_ELSE=2,b$R.IFDEF_PARENT=3,b$R._removeAnnotation=new RegExp("(/\\*([^*]|[\\r\\\n]|(\\*+([^*/]|[\\r\\n])))*\\*+/)|(//.*)","g"),b$R._reg=new RegExp("(\".*\")|('.*')|([#\\w\\*-\\.+/()=<>{}\\\\]+)|([,;:\\\\])","g"),b$R._splitToWordExps=new RegExp("[(\".*\")]+|[('.*')]+|([ \\t=\\+\\-*/&%!<>!%(),;])","g"),b$R.includes={},b$V(b$R,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"_splitToWordExps3",function(){return this._splitToWordExps3=new RegExp("[ \\t=\\+\\-*/&%!<>!%(),;\\|]","g")}]),b$R.__init$=function(){b$v=function(){function b$i(b$M){this.childs=[],this.text="",this.parent=null,this.name=null,this.noCompile=!1,this.includefiles=null,this.condition=null,this.conditionType=0,this.useFuns="",this.z=0,this.src=null,this.includefiles=b$M}b$d(b$i,"");var b$M=b$i.prototype;return b$M.setParent=function(b$M){b$M.childs.push(this),this.z=b$M.z+1,this.parent=b$M},b$M.setCondition=function(b$M,b$y){b$M&&(this.conditionType=b$y,b$M=b$M.replace(/(\s*$)/g,""),this.condition=function(){return this[b$M]},this.condition.__condition=b$M)},b$M.toscript=function(b$M,b$y){return this._toscript(b$M,b$y,++b$i.__id)},b$M._toscript=function(b$H,b$S,b$f){if(this.childs.length<1&&!this.text)return b$S;b$S.length;if(this.condition){var b$M=!!this.condition.call(b$H);if(2===this.conditionType&&(b$M=!b$M),!b$M)return b$S}if(this.text&&b$S.push(this.text),0<this.childs.length&&this.childs.forEach(function(b$M,b$y,b$i){b$M._toscript(b$H,b$S,b$f)}),0<this.includefiles.length&&0<this.useFuns.length)for(var b$y,b$i=0,b$V=this.includefiles.length;b$i<b$V;b$i++)this.includefiles[b$i].curUseID!=b$f&&0<(b$y=this.includefiles[b$i].file.getFunsScript(this.useFuns)).length&&(this.includefiles[b$i].curUseID=b$f,b$S[0]=b$y+b$S[0]);return b$S},b$i.__id=1,b$i}(),b$i=function(){function b$M(b$M){this.script=null,this.codes={},this.funs={},this.curUseID=-1,this.funnames="",this.script=b$M;for(var b$y=0,b$i=0,b$H=0;!((b$y=b$M.indexOf("#begin",b$y))<0);){for(b$H=b$y+5;!((b$H=b$M.indexOf("#end",b$H))<0)&&"i"===b$M.charAt(b$H+4);)b$H+=5;if(b$H<0)throw"add include err,no #end:"+b$M;b$i=b$M.indexOf("\n",b$y);var b$S=b$R.splitToWords(b$M.substr(b$y,b$i-b$y),null);"code"==b$S[1]?this.codes[b$S[2]]=b$M.substr(b$i+1,b$H-b$i-1):"function"==b$S[1]&&(b$i=b$M.indexOf("function",b$y),b$i+="function".length,this.funs[b$S[3]]=b$M.substr(b$i+1,b$H-b$i-1),this.funnames+=b$S[3]+";"),b$y=b$H+1}}b$d(b$M,"");var b$y=b$M.prototype;return b$y.getWith=function(b$M){var b$y=b$M?this.codes[b$M]:this.script;if(!b$y)throw"get with error:"+b$M;return b$y},b$y.getFunsScript=function(b$M){var b$y="";for(var b$i in this.funs)0<=b$M.indexOf(b$i+";")&&(b$y+=this.funs[b$i]);return b$y},b$M}()},b$R}(),b$AM=function(){function b$V(){}return b$d(b$V,"laya.webgl.WebGL"),b$V._uint8ArraySlice=function(){for(var b$M=this.length,b$y=new Uint8Array(this.length),b$i=0;b$i<b$M;b$i++)b$y[b$i]=this[b$i];return b$y},b$V._float32ArraySlice=function(){for(var b$M=this.length,b$y=new Float32Array(this.length),b$i=0;b$i<b$M;b$i++)b$y[b$i]=this[b$i];return b$y},b$V._uint16ArraySlice=function(b$M){var b$y,b$i=arguments,b$H=0,b$S=0;if(0===b$i.length)for(b$H=this.length,b$y=new Uint16Array(b$H),b$S=0;b$S<b$H;b$S++)b$y[b$S]=this[b$S];else if(2===b$i.length){var b$f=b$i[0],b$V=b$i[1];if(b$f<b$V)for(b$H=b$V-b$f,b$y=new Uint16Array(b$H),b$S=b$f;b$S<b$V;b$S++)b$y[b$S-b$f]=this[b$S];else b$y=new Uint16Array(0)}return b$y},b$V.expandContext=function(){var b$M=b$S.prototype,b$y=CanvasRenderingContext2D.prototype;b$y.fillTrangles=b$M.fillTrangles,b$xM.__int__(null),b$y.setIBVB=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){void 0===b$k&&(b$k=0),void 0===b$X&&(b$X=0),null===b$i&&(this._ib=this._ib||b$OM.QuadrangleIB,b$i=this._ib,b$hM.expandIBQuadrangle(b$i,b$H._byteLength/64+8)),this._setIBVB(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X)},b$y.fillTrangles=function(b$M,b$y,b$i,b$H,b$S){this._curMat=this._curMat||b$W.create(),this._vb=this._vb||b$LM.create(),this._ib||(this._ib=b$OM.create(),b$hM.fillIBQuadrangle(this._ib,b$V/4));var b$f=this._vb,b$V=b$H.length>>4;b$hM.fillTranglesVB(b$f,b$y,b$i,b$H,b$S||this._curMat,0,0),b$hM.expandIBQuadrangle(this._ib,b$f._byteLength/64+8);var b$K=new b$QM(1,0);b$K.textureHost=b$M;var b$k=new b$jM("attribute vec2 position; attribute vec2 texcoord; uniform vec2 size; uniform mat4 mmat; varying vec2 v_texcoord; void main() { vec4 p=vec4(position.xy,0.0,1.0);vec4 pos=mmat*p; gl_Position =vec4((pos.x/size.x-0.5)*2.0,(0.5-pos.y/size.y)*2.0,pos.z,1.0); v_texcoord = texcoord; }","precision mediump float; varying vec2 v_texcoord; uniform sampler2D texture; #ifdef TXTALPHA uniform sampler2D texture1; #endif void main() {vec4 color= texture2D(texture, v_texcoord); #ifdef TXTALPHA color.a = texture2D(texture1, v_texcoord).a; #endif color.a*=1.0; gl_FragColor= color;}");b$f._vertType=3,this._setIBVB(b$y,b$i,this._ib,b$f,6*b$V,b$S,b$k,b$K,0,0)}},b$V.enable=function(){if(b$P.__init__(),b$C.isConchApp&&!b$C.isConchWebGL)return b$G.skinAniSprite=function(){return new b$MM},b$V.expandContext(),!1;if(b$G.getWebGLContext=function(b$M){for(var b$y,b$i=["webgl","experimental-webgl","webkit-3d","moz-webgl"],b$H=0;b$H<b$i.length;b$H++){try{b$y=b$M.getContext(b$i[b$H],{stencil:b$U.isStencil,alpha:b$U.isAlpha,antialias:b$U.isAntialias,premultipliedAlpha:b$U.premultipliedAlpha,preserveDrawingBuffer:b$U.preserveDrawingBuffer})}catch(b$M){}if(b$y)return b$y}return null},null==(b$V.mainContext=b$G.getWebGLContext(b$C._mainCanvas)))return!1;if(b$C.isWebGL)return!0;b$J.create=function(b$M,b$y){return new b$My(b$M,b$y)},b$h.create=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){return new b$NM(b$M,b$y,b$i,b$H,b$S,b$f,b$V)},b$C.WebGL=b$V,b$C.isWebGL=!0,b$PM.__init__(),b$G.createRenderSprite=function(b$M,b$y){return new b$WM(b$M,b$y)},b$G.createWebGLContext2D=function(b$M){return new b$UM(b$M)},b$G.changeWebGLSize=function(b$M,b$y){laya.webgl.WebGL.onStageResize(b$M,b$y)},b$G.createGraphics=function(){return new b$IM};var b$M=b$G.createFilterAction;return b$G.createFilterAction=b$M||function(b$M){return new b$cM},b$G.clear=function(b$M){b$vM.worldScissorTest&&laya.webgl.WebGL.mainContext.disable(3089);var b$y=b$C.context.ctx,b$i=0==b$y._submits._length||b$U.preserveDrawingBuffer?b$l.create(b$M)._color:b$T._wgColor;b$i&&b$y.clearBG(b$i[0],b$i[1],b$i[2],b$i[3]),b$vM.clear()},b$G.addToAtlas=function(b$M,b$y){void 0===b$y&&(b$y=!1);var b$i=b$M.bitmap;b$C.optimizeTextureMemory(b$M.url,b$M)?b$I.__typeof(b$i,"laya.webgl.resource.IMergeAtlasBitmap")&&b$i.allowMerageInAtlas&&b$i.on("recovered",b$M,b$M.addTextureToAtlas):b$i.enableMerageInAtlas=!1},b$G.isAtlas=function(b$M){return b$M instanceof laya.webgl.atlas.AtlasWebGLCanvas},b$B._enable(),b$G.beginFlush=function(){for(var b$M=b$B.instance,b$y=b$M.getAtlaserCount(),b$i=0;b$i<b$y;b$i++){var b$H=b$M.getAtlaserByIndex(b$i).texture;b$H._flashCacheImageNeedFlush&&b$G.flashFlushImage(b$H)}},b$G.drawToCanvas=function(b$M,b$y,b$i,b$H,b$S,b$f){(b$i<=0||b$H<=0)&&console.log("[error] canvasWidth and canvasHeight should greater than zero"),b$i|=0,b$H|=0,b$S|=0,b$f|=0;var b$V=b$qM.create(b$i,b$H,6408,5121,0,!1);b$V.start(),b$V.clear(0,0,0,0),b$C.context.clear(),b$v.renders[b$y]._fun(b$M,b$C.context,b$S,b$vM.height-b$H+b$f),b$C.context.flush(),b$V.end();var b$K=b$V.getData(0,0,b$i,b$H);if(b$V.recycle(),b$K.byteLength==b$i*b$H*4){var b$k=new b$bM;b$k._canvas=b$P.createElement("canvas"),b$k.size(b$i,b$H);var b$X=b$k._canvas.getContext("2d");b$P.canvas.size(b$i,b$H);var b$F=b$P.context,b$o=b$F.createImageData(b$i,b$H);return b$o.data.set(new Uint8ClampedArray(b$K.buffer)),b$k._imgData=b$o,b$F.putImageData(b$o,0,0),b$X.save(),b$X.translate(0,b$H),b$X.scale(1,-1),b$X.drawImage(b$P.canvas.source,0,0),b$X.restore(),b$k}console.log("drawToCanvas error: w:"+b$i+",h:"+b$H+",datalen:"+b$K.byteLength)},b$G.createFilterAction=function(b$M){var b$y;switch(b$M){case 32:b$y=new b$cM}return b$y},b$G.addTextureToAtlas=function(b$M){b$M._uvID++,b$B._atlasRestore++,b$M.bitmap.enableMerageInAtlas&&b$B.instance.addToAtlas(b$M)},b$G.getTexturePixels=function(b$M,b$y,b$i,b$H,b$S){b$C.context.ctx.clear();var b$f=new b$a;b$f.graphics.drawTexture(b$M,-b$y,-b$i);var b$V=b$qM.create(b$H,b$S);b$V.start(),b$V.clear(0,0,0,0),b$f.render(b$C.context,0,0),b$C.context.ctx.flush(),b$V.end();for(var b$K=b$V.getData(0,0,b$H,b$S),b$k=[],b$X=0,b$F=b$S-1;0<=b$F;b$F--)for(var b$o=0;b$o<b$H;b$o++)b$X=4*(b$F*b$H+b$o),b$k.push(b$K[b$X]),b$k.push(b$K[b$X+1]),b$k.push(b$K[b$X+2]),b$k.push(b$K[b$X+3]);return b$k},b$G.skinAniSprite=function(){return new b$MM},b$X.create=function(b$M,b$y){var b$i=new b$bM;return b$i._imgData=b$y,b$i.flipY=!1,b$i},b$Q._filterStart=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$M.getValue("bounds"),b$V=b$qM.create(b$f.width,b$f.height);if(b$V.start(),b$V.clear(0,0,0,0),b$M.addValue("src",b$V),b$M.addValue("ScissorTest",b$vM.worldScissorTest),b$vM.worldScissorTest){var b$K=new b$n;b$K.copyFrom(b$i.ctx._clipRect),b$M.addValue("clipRect",b$K),b$vM.worldScissorTest=!1,laya.webgl.WebGL.mainContext.disable(3089)}},b$Q._filterEnd=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$M.getValue("bounds");b$M.getValue("src").end();var b$V=b$qM.create(b$f.width,b$f.height);b$V.start(),b$V.clear(0,0,0,0),b$M.addValue("out",b$V),b$y._set$P("_filterCache",b$V),b$y._set$P("_isHaveGlowFilter",b$M.getValue("_isHaveGlowFilter"))},b$Q._EndTarget=function(b$M,b$y){if(b$M.getValue("src").recycle(),b$M.getValue("out").end(),b$M.getValue("ScissorTest")){b$vM.worldScissorTest=!0,laya.webgl.WebGL.mainContext.enable(3089),b$y.ctx.save();var b$i=b$M.getValue("clipRect");b$y.ctx.clipRect(b$i.x,b$i.y,b$i.width,b$i.height)}},b$Q._useSrc=function(b$M){var b$y=b$M.getValue("out");b$y.end(),(b$y=b$M.getValue("src")).start(),b$y.clear(0,0,0,0)},b$Q._endSrc=function(b$M){b$M.getValue("src").end()},b$Q._useOut=function(b$M){var b$y=b$M.getValue("src");b$y.end(),(b$y=b$M.getValue("out")).start(),b$y.clear(0,0,0,0)},b$Q._endOut=function(b$M){b$M.getValue("out").end()},b$Q._recycleScope=function(b$M){b$M.recycle()},b$Q._filter=function(b$M,b$y,b$i,b$H){var b$S=this._next;if(b$S){var b$f,b$V,b$K=b$M.filters,b$k=b$K.length;if(1==b$k&&32==b$K[0].type)return b$y.ctx.save(),b$y.ctx.setFilters([b$K[0]]),b$S._fun.call(b$S,b$M,b$y,b$i,b$H),void b$y.ctx.restore();var b$X=b$KM.create(),b$F=b$c.TEMP,b$o=b$y.ctx._getTransformMatrix(),b$d=b$W.create();b$o.copyTo(b$d);var b$P=0,b$l=0,b$J=!1,b$h=b$M._$P._filterCache?b$M._$P._filterCache:null;if(!b$h||b$M._repaint){b$J=b$M._isHaveGlowFilter(),b$X.addValue("_isHaveGlowFilter",b$J),b$J&&(b$P=50,b$l=25),(b$V=new b$n).copyFrom(b$M.getSelfBounds()),b$V.x+=b$M.x,b$V.y+=b$M.y,b$V.x-=b$M.pivotX+4,b$V.y-=b$M.pivotY+4;var b$C=b$V.x,b$v=b$V.y;if(b$V.width+=b$P+8,b$V.height+=b$P+8,b$F.x=b$V.x*b$d.a+b$V.y*b$d.c,b$F.y=b$V.y*b$d.d+b$V.x*b$d.b,b$V.x=b$F.x,b$V.y=b$F.y,b$F.x=b$V.width*b$d.a+b$V.height*b$d.c,b$F.y=b$V.height*b$d.d+b$V.width*b$d.b,b$V.width=b$F.x,b$V.height=b$F.y,b$V.width<=0||b$V.height<=0)return;b$h&&b$h.recycle(),b$X.addValue("bounds",b$V);var b$R=b$VM.create([b$X,b$M,b$y,0,0],b$Q._filterStart);b$y.addRenderObject(b$R),b$y.ctx._renderKey=0,b$y.ctx._shader2D.glTexture=null;var b$A=b$M.x-b$C+b$l,b$G=b$M.y-b$v+b$l;b$S._fun.call(b$S,b$M,b$y,b$A,b$G),b$R=b$VM.create([b$X,b$M,b$y,0,0],b$Q._filterEnd),b$y.addRenderObject(b$R);for(var b$I=0;b$I<b$k;b$I++){0!=b$I&&(b$R=b$VM.create([b$X],b$Q._useSrc),b$y.addRenderObject(b$R),b$f=b$QM.create(1,0),b$W.TEMP.identity(),b$y.ctx.drawTarget(b$X,0,0,b$V.width,b$V.height,b$W.TEMP,"out",b$f,null,b$E.TOINT.overlay),b$R=b$VM.create([b$X],b$Q._useOut),b$y.addRenderObject(b$R)),b$K[b$I].action.apply3d(b$X,b$M,b$y,0,0)}b$R=b$VM.create([b$X,b$y],b$Q._EndTarget),b$y.addRenderObject(b$R)}else{if((b$J=!!b$M._$P._isHaveGlowFilter&&b$M._$P._isHaveGlowFilter)&&(b$P=50,b$l=25),(b$V=b$M.getBounds()).width<=0||b$V.height<=0)return;b$V.width+=b$P,b$V.height+=b$P,b$F.x=b$V.x*b$d.a+b$V.y*b$d.c,b$F.y=b$V.y*b$d.d+b$V.x*b$d.b,b$V.x=b$F.x,b$V.y=b$F.y,b$F.x=b$V.width*b$d.a+b$V.height*b$d.c,b$F.y=b$V.height*b$d.d+b$V.width*b$d.b,b$V.width=b$F.x,b$V.height=b$F.y,b$X.addValue("out",b$h)}b$i=b$i-b$l-b$M.x,b$H=b$H-b$l-b$M.y,b$F.setTo(b$i,b$H),b$d.transformPoint(b$F),b$i=b$F.x+b$V.x,b$H=b$F.y+b$V.y,b$f=b$QM.create(1,0),b$W.TEMP.identity(),b$y.ctx.drawTarget(b$X,b$i,b$H,b$V.width,b$V.height,b$W.TEMP,"out",b$f,null,b$E.TOINT.overlay),b$R=b$VM.create([b$X],b$Q._recycleScope),b$y.addRenderObject(b$R),b$d.destroy()}},Float32Array.prototype.slice||(Float32Array.prototype.slice=b$V._float32ArraySlice),Uint16Array.prototype.slice||(Uint16Array.prototype.slice=b$V._uint16ArraySlice),Uint8Array.prototype.slice||(Uint8Array.prototype.slice=b$V._uint8ArraySlice),!0},b$V.onStageResize=function(b$M,b$y){null!=b$V.mainContext&&(b$V.mainContext.viewport(0,0,b$M,b$y),b$vM.width=b$M,b$vM.height=b$y)},b$V.onInvalidGLRes=function(){b$B.instance.freeAll(),b$A.releaseContentManagers(!0),b$V.doNodeRepaint(b$I.stage),b$V.mainContext.viewport(0,0,b$vM.width,b$vM.height),b$I.stage.event("devicelost")},b$V.doNodeRepaint=function(b$M){0==b$M.numChildren&&b$M.repaint();for(var b$y=0;b$y<b$M.numChildren;b$y++)b$V.doNodeRepaint(b$M.getChildAt(b$y))},b$V.init=function(b$M,b$y,b$i){b$V.mainCanvas=b$M,b$X._createContext=function(b$M){return new b$UM(b$M)},b$bM._createContext=function(b$M){return new b$UM(b$M)};var b$H=laya.webgl.WebGL.mainContext;if(null!=b$H.getShaderPrecisionFormat){var b$S=b$H.getShaderPrecisionFormat(35633,36338),b$f=b$H.getShaderPrecisionFormat(35632,36338);b$V.shaderHighPrecision=!(!b$S.precision||!b$f.precision)}else b$V.shaderHighPrecision=!1;if(b$H.deleteTexture1=b$H.deleteTexture,b$H.deleteTexture=function(b$M){b$M==b$GM.curBindTexValue&&(b$GM.curBindTexValue=null),b$H.deleteTexture1(b$M)},b$V.onStageResize(b$y,b$i),null==b$V.mainContext)throw new Error("webGL getContext err!");b$s.__init__(),b$B.__init__(),b$aM.__init__(),b$fM.__init__(),b$UM.__init__(),b$QM.__init__(),b$O.__init__(),b$xM.__int__(b$H),b$E._init_(b$H),b$C.isConchApp&&conch.setOnInvalidGLRes(b$V.onInvalidGLRes)},b$V.mainCanvas=null,b$V.mainContext=null,b$V.antialias=!0,b$V.shaderHighPrecision=!1,b$V._bg_null=[0,0,0,0],b$V}(),b$GM=function(){function b$H(){}return b$d(b$H,"laya.webgl.WebGLContext"),b$H.UseProgram=function(b$M){return b$H._useProgram!==b$M&&(b$AM.mainContext.useProgram(b$M),b$H._useProgram=b$M,!0)},b$H.setDepthTest=function(b$M,b$y){b$y!==b$H._depthTest&&((b$H._depthTest=b$y)?b$M.enable(2929):b$M.disable(2929))},b$H.setDepthMask=function(b$M,b$y){b$y!==b$H._depthMask&&(b$H._depthMask=b$y,b$M.depthMask(b$y))},b$H.setDepthFunc=function(b$M,b$y){b$y!==b$H._depthFunc&&(b$H._depthFunc=b$y,b$M.depthFunc(b$y))},b$H.setBlend=function(b$M,b$y){b$y!==b$H._blend&&((b$H._blend=b$y)?b$M.enable(3042):b$M.disable(3042))},b$H.setBlendFunc=function(b$M,b$y,b$i){(b$y!==b$H._sFactor||b$i!==b$H._dFactor)&&(b$H._sFactor=b$y,b$H._dFactor=b$i,b$M.blendFunc(b$y,b$i))},b$H.setCullFace=function(b$M,b$y){b$y!==b$H._cullFace&&((b$H._cullFace=b$y)?b$M.enable(2884):b$M.disable(2884))},b$H.setFrontFace=function(b$M,b$y){b$y!==b$H._frontFace&&(b$H._frontFace=b$y,b$M.frontFace(b$y))},b$H.bindTexture=function(b$M,b$y,b$i){b$M.bindTexture(b$y,b$i),b$H.curBindTexTarget=b$y,b$H.curBindTexValue=b$i},b$H.DEPTH_BUFFER_BIT=256,b$H.STENCIL_BUFFER_BIT=1024,b$H.COLOR_BUFFER_BIT=16384,b$H.POINTS=0,b$H.LINES=1,b$H.LINE_LOOP=2,b$H.LINE_STRIP=3,b$H.TRIANGLES=4,b$H.TRIANGLE_STRIP=5,b$H.TRIANGLE_FAN=6,b$H.ZERO=0,b$H.ONE=1,b$H.SRC_COLOR=768,b$H.ONE_MINUS_SRC_COLOR=769,b$H.SRC_ALPHA=770,b$H.ONE_MINUS_SRC_ALPHA=771,b$H.DST_ALPHA=772,b$H.ONE_MINUS_DST_ALPHA=773,b$H.DST_COLOR=774,b$H.ONE_MINUS_DST_COLOR=775,b$H.SRC_ALPHA_SATURATE=776,b$H.FUNC_ADD=32774,b$H.BLEND_EQUATION=32777,b$H.BLEND_EQUATION_RGB=32777,b$H.BLEND_EQUATION_ALPHA=34877,b$H.FUNC_SUBTRACT=32778,b$H.FUNC_REVERSE_SUBTRACT=32779,b$H.BLEND_DST_RGB=32968,b$H.BLEND_SRC_RGB=32969,b$H.BLEND_DST_ALPHA=32970,b$H.BLEND_SRC_ALPHA=32971,b$H.CONSTANT_COLOR=32769,b$H.ONE_MINUS_CONSTANT_COLOR=32770,b$H.CONSTANT_ALPHA=32771,b$H.ONE_MINUS_CONSTANT_ALPHA=32772,b$H.BLEND_COLOR=32773,b$H.ARRAY_BUFFER=34962,b$H.ELEMENT_ARRAY_BUFFER=34963,b$H.ARRAY_BUFFER_BINDING=34964,b$H.ELEMENT_ARRAY_BUFFER_BINDING=34965,b$H.STREAM_DRAW=35040,b$H.STATIC_DRAW=35044,b$H.DYNAMIC_DRAW=35048,b$H.BUFFER_SIZE=34660,b$H.BUFFER_USAGE=34661,b$H.CURRENT_VERTEX_ATTRIB=34342,b$H.FRONT=1028,b$H.BACK=1029,b$H.CULL_FACE=2884,b$H.FRONT_AND_BACK=1032,b$H.BLEND=3042,b$H.DITHER=3024,b$H.STENCIL_TEST=2960,b$H.DEPTH_TEST=2929,b$H.SCISSOR_TEST=3089,b$H.POLYGON_OFFSET_FILL=32823,b$H.SAMPLE_ALPHA_TO_COVERAGE=32926,b$H.SAMPLE_COVERAGE=32928,b$H.NO_ERROR=0,b$H.INVALID_ENUM=1280,b$H.INVALID_VALUE=1281,b$H.INVALID_OPERATION=1282,b$H.OUT_OF_MEMORY=1285,b$H.CW=2304,b$H.CCW=2305,b$H.LINE_WIDTH=2849,b$H.ALIASED_POINT_SIZE_RANGE=33901,b$H.ALIASED_LINE_WIDTH_RANGE=33902,b$H.CULL_FACE_MODE=2885,b$H.FRONT_FACE=2886,b$H.DEPTH_RANGE=2928,b$H.DEPTH_WRITEMASK=2930,b$H.DEPTH_CLEAR_VALUE=2931,b$H.DEPTH_FUNC=2932,b$H.STENCIL_CLEAR_VALUE=2961,b$H.STENCIL_FUNC=2962,b$H.STENCIL_FAIL=2964,b$H.STENCIL_PASS_DEPTH_FAIL=2965,b$H.STENCIL_PASS_DEPTH_PASS=2966,b$H.STENCIL_REF=2967,b$H.STENCIL_VALUE_MASK=2963,b$H.STENCIL_WRITEMASK=2968,b$H.STENCIL_BACK_FUNC=34816,b$H.STENCIL_BACK_FAIL=34817,b$H.STENCIL_BACK_PASS_DEPTH_FAIL=34818,b$H.STENCIL_BACK_PASS_DEPTH_PASS=34819,b$H.STENCIL_BACK_REF=36003,b$H.STENCIL_BACK_VALUE_MASK=36004,b$H.STENCIL_BACK_WRITEMASK=36005,b$H.VIEWPORT=2978,b$H.SCISSOR_BOX=3088,b$H.COLOR_CLEAR_VALUE=3106,b$H.COLOR_WRITEMASK=3107,b$H.UNPACK_ALIGNMENT=3317,b$H.PACK_ALIGNMENT=3333,b$H.MAX_TEXTURE_SIZE=3379,b$H.MAX_VIEWPORT_DIMS=3386,b$H.SUBPIXEL_BITS=3408,b$H.RED_BITS=3410,b$H.GREEN_BITS=3411,b$H.BLUE_BITS=3412,b$H.ALPHA_BITS=3413,b$H.DEPTH_BITS=3414,b$H.STENCIL_BITS=3415,b$H.POLYGON_OFFSET_UNITS=10752,b$H.POLYGON_OFFSET_FACTOR=32824,b$H.TEXTURE_BINDING_2D=32873,b$H.SAMPLE_BUFFERS=32936,b$H.SAMPLES=32937,b$H.SAMPLE_COVERAGE_VALUE=32938,b$H.SAMPLE_COVERAGE_INVERT=32939,b$H.NUM_COMPRESSED_TEXTURE_FORMATS=34466,b$H.COMPRESSED_TEXTURE_FORMATS=34467,b$H.DONT_CARE=4352,b$H.FASTEST=4353,b$H.NICEST=4354,b$H.GENERATE_MIPMAP_HINT=33170,b$H.BYTE=5120,b$H.UNSIGNED_BYTE=5121,b$H.SHORT=5122,b$H.UNSIGNED_SHORT=5123,b$H.INT=5124,b$H.UNSIGNED_INT=5125,b$H.FLOAT=5126,b$H.DEPTH_COMPONENT=6402,b$H.ALPHA=6406,b$H.RGB=6407,b$H.RGBA=6408,b$H.LUMINANCE=6409,b$H.LUMINANCE_ALPHA=6410,b$H.UNSIGNED_SHORT_4_4_4_4=32819,b$H.UNSIGNED_SHORT_5_5_5_1=32820,b$H.UNSIGNED_SHORT_5_6_5=33635,b$H.FRAGMENT_SHADER=35632,b$H.VERTEX_SHADER=35633,b$H.MAX_VERTEX_ATTRIBS=34921,b$H.MAX_VERTEX_UNIFORM_VECTORS=36347,b$H.MAX_VARYING_VECTORS=36348,b$H.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,b$H.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,b$H.MAX_TEXTURE_IMAGE_UNITS=34930,b$H.MAX_FRAGMENT_UNIFORM_VECTORS=36349,b$H.SHADER_TYPE=35663,b$H.DELETE_STATUS=35712,b$H.LINK_STATUS=35714,b$H.VALIDATE_STATUS=35715,b$H.ATTACHED_SHADERS=35717,b$H.ACTIVE_UNIFORMS=35718,b$H.ACTIVE_ATTRIBUTES=35721,b$H.SHADING_LANGUAGE_VERSION=35724,b$H.CURRENT_PROGRAM=35725,b$H.NEVER=512,b$H.LESS=513,b$H.EQUAL=514,b$H.LEQUAL=515,b$H.GREATER=516,b$H.NOTEQUAL=517,b$H.GEQUAL=518,b$H.ALWAYS=519,b$H.KEEP=7680,b$H.REPLACE=7681,b$H.INCR=7682,b$H.DECR=7683,b$H.INVERT=5386,b$H.INCR_WRAP=34055,b$H.DECR_WRAP=34056,b$H.VENDOR=7936,b$H.RENDERER=7937,b$H.VERSION=7938,b$H.NEAREST=9728,b$H.LINEAR=9729,b$H.NEAREST_MIPMAP_NEAREST=9984,b$H.LINEAR_MIPMAP_NEAREST=9985,b$H.NEAREST_MIPMAP_LINEAR=9986,b$H.LINEAR_MIPMAP_LINEAR=9987,b$H.TEXTURE_MAG_FILTER=10240,b$H.TEXTURE_MIN_FILTER=10241,b$H.TEXTURE_WRAP_S=10242,b$H.TEXTURE_WRAP_T=10243,b$H.TEXTURE_2D=3553,b$H.TEXTURE=5890,b$H.TEXTURE_CUBE_MAP=34067,b$H.TEXTURE_BINDING_CUBE_MAP=34068,b$H.TEXTURE_CUBE_MAP_POSITIVE_X=34069,b$H.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,b$H.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,b$H.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,b$H.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,b$H.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,b$H.MAX_CUBE_MAP_TEXTURE_SIZE=34076,b$H.TEXTURE0=33984,b$H.TEXTURE1=33985,b$H.TEXTURE2=33986,b$H.TEXTURE3=33987,b$H.TEXTURE4=33988,b$H.TEXTURE5=33989,b$H.TEXTURE6=33990,b$H.TEXTURE7=33991,b$H.TEXTURE8=33992,b$H.TEXTURE9=33993,b$H.TEXTURE10=33994,b$H.TEXTURE11=33995,b$H.TEXTURE12=33996,b$H.TEXTURE13=33997,b$H.TEXTURE14=33998,b$H.TEXTURE15=33999,b$H.TEXTURE16=34e3,b$H.TEXTURE17=34001,b$H.TEXTURE18=34002,b$H.TEXTURE19=34003,b$H.TEXTURE20=34004,b$H.TEXTURE21=34005,b$H.TEXTURE22=34006,b$H.TEXTURE23=34007,b$H.TEXTURE24=34008,b$H.TEXTURE25=34009,b$H.TEXTURE26=34010,b$H.TEXTURE27=34011,b$H.TEXTURE28=34012,b$H.TEXTURE29=34013,b$H.TEXTURE30=34014,b$H.TEXTURE31=34015,b$H.ACTIVE_TEXTURE=34016,b$H.REPEAT=10497,b$H.CLAMP_TO_EDGE=33071,b$H.MIRRORED_REPEAT=33648,b$H.FLOAT_VEC2=35664,b$H.FLOAT_VEC3=35665,b$H.FLOAT_VEC4=35666,b$H.INT_VEC2=35667,b$H.INT_VEC3=35668,b$H.INT_VEC4=35669,b$H.BOOL=35670,b$H.BOOL_VEC2=35671,b$H.BOOL_VEC3=35672,b$H.BOOL_VEC4=35673,b$H.FLOAT_MAT2=35674,b$H.FLOAT_MAT3=35675,b$H.FLOAT_MAT4=35676,b$H.SAMPLER_2D=35678,b$H.SAMPLER_CUBE=35680,b$H.VERTEX_ATTRIB_ARRAY_ENABLED=34338,b$H.VERTEX_ATTRIB_ARRAY_SIZE=34339,b$H.VERTEX_ATTRIB_ARRAY_STRIDE=34340,b$H.VERTEX_ATTRIB_ARRAY_TYPE=34341,b$H.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,b$H.VERTEX_ATTRIB_ARRAY_POINTER=34373,b$H.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,b$H.COMPILE_STATUS=35713,b$H.LOW_FLOAT=36336,b$H.MEDIUM_FLOAT=36337,b$H.HIGH_FLOAT=36338,b$H.LOW_INT=36339,b$H.MEDIUM_INT=36340,b$H.HIGH_INT=36341,b$H.FRAMEBUFFER=36160,b$H.RENDERBUFFER=36161,b$H.RGBA4=32854,b$H.RGB5_A1=32855,b$H.RGB565=36194,b$H.DEPTH_COMPONENT16=33189,b$H.STENCIL_INDEX=6401,b$H.STENCIL_INDEX8=36168,b$H.DEPTH_STENCIL=34041,b$H.RENDERBUFFER_WIDTH=36162,b$H.RENDERBUFFER_HEIGHT=36163,b$H.RENDERBUFFER_INTERNAL_FORMAT=36164,b$H.RENDERBUFFER_RED_SIZE=36176,b$H.RENDERBUFFER_GREEN_SIZE=36177,b$H.RENDERBUFFER_BLUE_SIZE=36178,b$H.RENDERBUFFER_ALPHA_SIZE=36179,b$H.RENDERBUFFER_DEPTH_SIZE=36180,b$H.RENDERBUFFER_STENCIL_SIZE=36181,b$H.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,b$H.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,b$H.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,b$H.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,b$H.COLOR_ATTACHMENT0=36064,b$H.DEPTH_ATTACHMENT=36096,b$H.STENCIL_ATTACHMENT=36128,b$H.DEPTH_STENCIL_ATTACHMENT=33306,b$H.NONE=0,b$H.FRAMEBUFFER_COMPLETE=36053,b$H.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,b$H.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,b$H.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,b$H.FRAMEBUFFER_UNSUPPORTED=36061,b$H.FRAMEBUFFER_BINDING=36006,b$H.RENDERBUFFER_BINDING=36007,b$H.MAX_RENDERBUFFER_SIZE=34024,b$H.INVALID_FRAMEBUFFER_OPERATION=1286,b$H.UNPACK_FLIP_Y_WEBGL=37440,b$H.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,b$H.CONTEXT_LOST_WEBGL=37442,b$H.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,b$H.BROWSER_DEFAULT_WEBGL=37444,b$H._useProgram=null,b$H._depthTest=!0,b$H._depthMask=!0,b$H._blend=!1,b$H._cullFace=!1,b$H.curBindTexTarget=null,b$H.curBindTexValue=null,b$V(b$H,["_depthFunc",function(){return this._depthFunc=513},"_sFactor",function(){return this._sFactor=1},"_dFactor",function(){return this._dFactor=0},"_frontFace",function(){return this._frontFace=2305}]),b$H}(),b$IM=function(b$M){function b$y(){b$y.__super.call(this)}b$d(b$y,"laya.webgl.display.GraphicsGL",b$K);var b$i=b$y.prototype;return b$i.setShader=function(b$M){this._saveToCmd(b$C.context._setShader,[b$M])},b$i.setIBVB=function(b$M,b$y,b$i,b$H,b$S,b$f){this._saveToCmd(b$C.context._setIBVB,[b$M,b$y,b$i,b$H,b$S,b$f])},b$i.drawParticle=function(b$M,b$y,b$i){var b$H=b$G.createParticleTemplate2D(b$i);b$H.x=b$M,b$H.y=b$y,this._saveToCmd(b$C.context._drawParticle,[b$H])},b$y}(),b$UM=function(b$M){var b$i;function b$p(b$M){this._x=0,this._y=0,this._id=++b$p._COUNT,this._path=null,this._drawCount=1,this._maxNumEle=0,this._clear=!1,this._isMain=!1,this._atlasResourceChange=0,this._submits=null,this._curSubmit=null,this._ib=null,this._vb=null,this._nBlendType=0,this._saveMark=null,this._shader2D=null,this.meshlist=[],this.mId=-1,this.mHaveKey=!1,this.mHaveLineKey=!1,this.mX=0,this.mY=0,b$p.__super.call(this),this._width=99999999,this._height=99999999,this._clipRect=b$p.MAXCLIPRECT,this.mOutPoint,this._canvas=b$M,this._canvas._addReference(),b$p._contextcount++,b$C.isFlash?(this._ib=b$OM.create(35044),b$hM.fillIBQuadrangle(this._ib,16)):this._ib=b$OM.QuadrangleIB,this.clear()}b$d(b$p,"laya.webgl.canvas.WebGLContext2D",b$S);var b$y=b$p.prototype;return b$y.setIsMainContext=function(){this._isMain=!0},b$y.clearBG=function(b$M,b$y,b$i,b$H){var b$S=b$AM.mainContext;b$S.clearColor(b$M,b$y,b$i,b$H),b$S.clear(16384)},b$y._getSubmits=function(){return this._submits},b$y._releaseMem=function(){if(this._submits){this._curMat.destroy(),this._curMat=null,this._shader2D.destroy(),this._shader2D=null;for(var b$M=0,b$y=this._submits._length;b$M<b$y;b$M++)this._submits[b$M].releaseRender();this._submits.length=0,this._submits._length=0,this._submits=null,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this._other&&(this._other.font=null),this._save=null,this._vb&&(this._vb.releaseResource(),this._vb.destroy(),this._vb.destory(),this._vb=null)}},b$y.destroy=function(){--b$p._contextcount,this.sprite=null,this._releaseMem(),this._targets&&this._targets.destroy(),this._targets=null,this._canvas&&this._canvas._removeReference(),this._canvas=null,this._ib&&this._ib!=b$OM.QuadrangleIB&&this._ib.releaseResource()},b$y.clear=function(){this._submits||(this._other=b$i.DEFAULT,this._curMat=b$W.create(),this._vb=b$LM.create(-1),this._submits=[],this._save=[b$$.Create(this)],this._save.length=10,this._shader2D=new b$O,this._triangleMesh=b$zM.getAMesh()),this._vb.clear(),this._targets&&(this._targets.repaint=!0),this._other=b$i.DEFAULT,this._clear=!0,this._repaint=!1,this._drawCount=1,this._renderKey=0,this._other.lineWidth=this._shader2D.ALPHA=1,this._nBlendType=0,this._clipRect=b$p.MAXCLIPRECT,this._curSubmit=b$fM.RENDERBASE,this._shader2D.glTexture=null,this._shader2D.fillStyle=this._shader2D.strokeStyle=b$_.DEFAULT;for(var b$M=0,b$y=this._submits._length;b$M<b$y;b$M++)this._submits[b$M].releaseRender(),this._submits[b$M]=null;this._submits._length=0,this._curMat.identity(),this._other.clear(),this._saveMark=this._save[0],this._save._length=1},b$y.size=function(b$M,b$y){if(this._width!=b$M||this._height!=b$y)if(0==b$M||0==b$y){0!=this._vb._byteLength&&(this._width=b$M,this._height=b$y,this._vb.clear(),this._vb.upload());for(var b$i=0,b$H=this._submits._length;b$i<b$H;b$i++)this._submits[b$i].releaseRender();this._submits.length=0,this._submits._length=0,this._curSubmit=null,this._path&&this._path.recover(),this._path=null,this.sprite=null,this._targets&&this._targets.destroy(),this._targets=null}else this._width=b$M,this._height=b$y,this._targets&&this._targets.size(b$M,b$y),this._canvas.memorySize-=this._canvas.memorySize;0===b$M&&0===b$y&&this._releaseMem()},b$y._getTransformMatrix=function(){return this._curMat},b$y.translate=function(b$M,b$y){0===b$M&&0===b$y||(b$g.save(this),this._curMat.bTransform&&(b$x.save(this),this._curMat.transformPointN(b$c.TEMP.setTo(b$M,b$y)),b$M=b$c.TEMP.x,b$y=b$c.TEMP.y),this._x+=b$M,this._y+=b$y)},b$y.save=function(){this._save[this._save._length++]=b$$.Create(this)},b$y.restore=function(){var b$M=this._save._length;if(!(b$M<1))for(var b$y=b$M-1;0<=b$y;b$y--){var b$i=this._save[b$y];if(b$i.restore(this),b$i.isSaveMark())return void(this._save._length=b$y)}},b$y._fillText=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){void 0===b$X&&(b$X=0);var b$F=this._shader2D,b$o=this._curSubmit.shaderValue,b$d=b$S?b$lM.create(b$S):this._other.font;if(b$B.enabled)b$F.ALPHA!==b$o.ALPHA&&(b$F.glTexture=null),b$PM.drawText(this,b$M,b$y,this._curMat,b$d,b$k||this._other.textAlign,b$f,b$V,b$K,b$i,b$H,b$X);else{this._shader2D.defines.getValue();var b$P=b$f?b$l.create(b$f)._color:b$F.colorAdd;b$F.ALPHA===b$o.ALPHA&&b$P===b$F.colorAdd&&b$o.colorAdd===b$F.colorAdd||(b$F.glTexture=null,b$F.colorAdd=b$P),b$PM.drawText(this,b$M,b$y,this._curMat,b$d,b$k||this._other.textAlign,b$f,b$V,b$K,b$i,b$H,b$X)}},b$y.fillWords=function(b$M,b$y,b$i,b$H,b$S,b$f){this._fillText(null,b$M,b$y,b$i,b$H,b$S,null,-1,null,b$f)},b$y.fillBorderWords=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this._fillBorderText(null,b$M,b$y,b$i,b$H,b$S,b$f,b$V,null)},b$y.fillText=function(b$M,b$y,b$i,b$H,b$S,b$f){this._fillText(b$M,null,b$y,b$i,b$H,b$S,null,-1,b$f)},b$y.strokeText=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this._fillText(b$M,null,b$y,b$i,b$H,null,b$S,b$f||1,b$V)},b$y.fillBorderText=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){this._fillBorderText(b$M,null,b$y,b$i,b$H,b$S,b$f,b$V,b$K)},b$y._fillBorderText=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){if(!b$B.enabled)return this._fillText(b$M,b$y,b$i,b$H,b$S,null,b$V,b$K||1,b$k),void this._fillText(b$M,b$y,b$i,b$H,b$S,b$f,null,-1,b$k);var b$X=this._shader2D,b$F=this._curSubmit.shaderValue;b$X.ALPHA!==b$F.ALPHA&&(b$X.glTexture=null);var b$o=b$S?(b$p._fontTemp.setFont(b$S),b$p._fontTemp):this._other.font;b$PM.drawText(this,b$M,b$y,this._curMat,b$o,b$k||this._other.textAlign,b$f,b$V,b$K||1,b$i,b$H,0)},b$y.fillRect=function(b$M,b$y,b$i,b$H,b$S){var b$f=this._vb;if(b$hM.fillRectImgVb(b$f,this._clipRect,b$M,b$y,b$i,b$H,b$z.DEF_UV,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var b$V=this._shader2D.fillStyle;b$S&&(this._shader2D.fillStyle=b$_.create(b$S));var b$K=this._shader2D,b$k=this._curSubmit.shaderValue;if(b$K.fillStyle!==b$k.fillStyle||b$K.ALPHA!==b$k.ALPHA){b$K.glTexture=null;var b$X=this._curSubmit=b$fM.createSubmit(this,this._ib,b$f,(b$f._byteLength-64)/32*3,b$QM.create(2,0));b$X.shaderValue.color=b$K.fillStyle._color._color,b$X.shaderValue.ALPHA=b$K.ALPHA,this._submits[this._submits._length++]=b$X}this._curSubmit._numEle+=6,this._shader2D.fillStyle=b$V}},b$y.fillTexture=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){if(b$M.loaded&&b$M.bitmap&&b$M.source){var b$k=this._vb,b$X=b$M.bitmap.width,b$F=b$M.bitmap.height,b$o=b$M.uv,b$d=b$V.x%b$M.width,b$P=b$V.y%b$M.height;if(b$X!=b$K.w||b$F!=b$K.h){if(!b$K.w&&!b$K.h)switch(b$K.oy=b$K.ox=0,b$f){case"repeat":b$K.width=b$H,b$K.height=b$S;break;case"repeat-x":b$K.width=b$H,b$P<0?b$M.height+b$P>b$S?b$K.height=b$S:b$K.height=b$M.height+b$P:(b$K.oy=b$P,b$M.height+b$P>b$S?b$K.height=b$S-b$P:b$K.height=b$M.height);break;case"repeat-y":b$d<0?b$M.width+b$d>b$H?b$K.width=b$H:b$K.width=b$M.width+b$d:(b$K.ox=b$d,b$M.width+b$d>b$H?b$K.width=b$H-b$d:b$K.width=b$M.width),b$K.height=b$S;break;case"no-repeat":b$d<0?b$M.width+b$d>b$H?b$K.width=b$H:b$K.width=b$M.width+b$d:(b$K.ox=b$d,b$M.width+b$d>b$H?b$K.width=b$H-b$d:b$K.width=b$M.width),b$P<0?b$M.height+b$P>b$S?b$K.height=b$S:b$K.height=b$M.height+b$P:(b$K.oy=b$P,b$M.height+b$P>b$S?b$K.height=b$S-b$P:b$K.height=b$M.height);break;default:b$K.width=b$H,b$K.height=b$S}b$K.w=b$X,b$K.h=b$F,b$K.uv=[0,0,b$K.width/b$X,0,b$K.width/b$X,b$K.height/b$F,0,b$K.height/b$F]}if(b$y+=b$K.ox,b$i+=b$K.oy,b$d-=b$K.ox,b$P-=b$K.oy,b$hM.fillRectImgVb(b$k,this._clipRect,b$y,b$i,b$K.width,b$K.height,b$K.uv,this._curMat,this._x,this._y,0,0)){this._renderKey=0;var b$l=b$DM.create(this,this._ib,b$k,(b$k._byteLength-64)/32*3,b$QM.create(256,0)),b$J=(this._submits[this._submits._length++]=b$l).shaderValue;b$J.textureHost=b$M;var b$h=b$o[0]*b$X,b$C=b$o[1]*b$F,b$v=(b$o[2]-b$o[0])*b$X,b$R=(b$o[5]-b$o[3])*b$F,b$A=-b$d/b$X,b$G=-b$P/b$F;b$J.u_TexRange[0]=b$h/b$X,b$J.u_TexRange[1]=b$v/b$X,b$J.u_TexRange[2]=b$C/b$F,b$J.u_TexRange[3]=b$R/b$F,b$J.u_offset[0]=b$A,b$J.u_offset[1]=b$G,b$B.enabled&&!this._isMain&&b$l.addTexture(b$M,(b$k._byteLength>>2)-16),(this._curSubmit=b$l)._renderType=10017,b$l._numEle+=6}}else this.sprite&&b$I.timer.callLater(this,this._repaintSprite)},b$y.setShader=function(b$M){b$Y.save(this,1048576,this._shader2D,!0),this._shader2D.shader=b$M},b$y.setFilters=function(b$M){b$Y.save(this,2097152,this._shader2D,!0),this._shader2D.filters=b$M,this._curSubmit=b$fM.RENDERBASE,this._renderKey=0,this._drawCount++},b$y.drawTexture=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this._drawTextureM(b$M,b$y,b$i,b$H,b$S,b$f,b$V,null,1)},b$y.addTextureVb=function(b$M,b$y,b$i){var b$H=this._curSubmit._vb||this._vb,b$S=b$H._byteLength>>2;b$H.byteLength=b$S+16<<2;for(var b$f=b$H.getFloat32Array(),b$V=0;b$V<16;b$V+=4)b$f[b$S++]=b$M[b$V]+b$y,b$f[b$S++]=b$M[b$V+1]+b$i,b$f[b$S++]=b$M[b$V+2],b$f[b$S++]=b$M[b$V+3];this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),b$H._upload=!0},b$y.willDrawTexture=function(b$M,b$y){if(!(b$M.loaded&&b$M.bitmap&&b$M.source))return this.sprite&&b$I.timer.callLater(this,this._repaintSprite),0;var b$i=b$M.bitmap,b$H=b$i.id+this._shader2D.ALPHA*b$y+10016;if(b$H==this._renderKey)return b$H;var b$S=this._shader2D,b$f=b$S.ALPHA,b$V=this._curSubmit.shaderValue;b$S.ALPHA*=b$y,this._renderKey=b$H,this._drawCount++,b$S.glTexture=b$i;var b$K=this._vb,b$k=null,b$X=b$K._byteLength/32*3,b$F=b$V.textureHost&&b$V.textureHost==b$M&&b$V.textureHost.alphaTexture==b$M.alphaTexture;return b$k=b$DM.create(this,this._ib,b$K,b$X,b$QM.create(1,0)),(this._submits[this._submits._length++]=b$k).shaderValue.textureHost=b$M,b$k._renderType=10016,b$k._preIsSameTextureShader=10016===this._curSubmit._renderType&&b$S.ALPHA===b$V.ALPHA&&b$F,this._curSubmit=b$k,b$S.ALPHA=b$f,b$H},b$y.drawTextures=function(b$M,b$y,b$i,b$H){if(b$M.loaded&&b$M.bitmap&&b$M.source){var b$S=this._clipRect;if(this._clipRect=b$p.MAXCLIPRECT,this._drawTextureM(b$M,b$y[0],b$y[1],b$M.width,b$M.height,b$i,b$H,null,1)){if(this._clipRect=b$S,b$m.drawCall++,!(b$y.length<4)){for(var b$f=this._curSubmit._vb||this._vb,b$V=this._curMat.a,b$K=this._curMat.d,b$k=2,b$X=b$y.length;b$k<b$X;b$k+=2)b$hM.copyPreImgVb(b$f,(b$y[b$k]-b$y[b$k-2])*b$V,(b$y[b$k+1]-b$y[b$k-1])*b$K),this._curSubmit._numEle+=6;this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle)}}else alert("drawTextures err")}else this.sprite&&b$I.timer.callLater(this,this._repaintSprite)},b$y._drawTextureM=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){if(!b$M.loaded||!b$M.source)return this.sprite&&b$I.timer.callLater(this,this._repaintSprite),!1;var b$X=this._curSubmit._vb||this._vb,b$F=b$M.bitmap;b$y+=b$f,b$i+=b$V,this._drawCount++;var b$o=b$F.id+this._shader2D.ALPHA*b$k+10016;if(b$o!=this._renderKey){this._renderKey=b$o;var b$d=this._curSubmit.shaderValue,b$P=this._shader2D,b$l=b$P.ALPHA;b$P.ALPHA*=b$k,b$P.glTexture=b$F;var b$J=this._vb,b$h=null,b$C=b$J._byteLength/32*3,b$v=b$d.textureHost&&b$d.textureHost==b$M&&b$d.textureHost.alphaTexture==b$M.alphaTexture;b$h=b$DM.create(this,this._ib,b$J,b$C,b$QM.create(1,0)),(this._submits[this._submits._length++]=b$h).shaderValue.textureHost=b$M,b$h._renderType=10016,b$h._preIsSameTextureShader=10016===this._curSubmit._renderType&&b$P.ALPHA===b$d.ALPHA&&b$v,this._curSubmit=b$h,b$X=this._curSubmit._vb||this._vb,b$P.ALPHA=b$l}return!!b$hM.fillRectImgVb(b$X,this._clipRect,b$y,b$i,b$H||b$M.width,b$S||b$M.height,b$M.uv,b$K||this._curMat,this._x,this._y,0,0)&&(b$B.enabled&&!this._isMain&&this._curSubmit.addTexture(b$M,(b$X._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0)},b$y._repaintSprite=function(){this.sprite&&this.sprite.repaint()},b$y._drawText=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){var b$F=b$M.bitmap;this._drawCount++;var b$o=b$F.id+this._shader2D.ALPHA+10016;if(b$o!=this._renderKey){this._renderKey=b$o;var b$d=this._curSubmit.shaderValue,b$P=this._shader2D;b$P.glTexture=b$F;var b$l=this._vb,b$J=null,b$h=b$l._byteLength/32*3,b$C=b$d.textureHost&&b$d.textureHost==b$M&&b$d.textureHost.alphaTexture==b$M.alphaTexture;(b$J=b$B.enabled?b$DM.create(this,this._ib,b$l,b$h,b$QM.create(1,0)):b$DM.create(this,this._ib,b$l,b$h,b$gM.create()))._preIsSameTextureShader=10016===this._curSubmit._renderType&&b$P.ALPHA===b$d.ALPHA&&b$C,(this._submits[this._submits._length++]=b$J).shaderValue.textureHost=b$M,b$J._renderType=10016,this._curSubmit=b$J}b$M.active();var b$v=this._curSubmit._vb||this._vb;b$hM.fillRectImgVb(b$v,this._clipRect,b$y+b$V,b$i+b$K,b$H||b$M.width,b$S||b$M.height,b$M.uv,b$f||this._curMat,this._x,this._y,b$k,b$X,!0)&&(b$B.enabled&&!this._isMain&&this._curSubmit.addTexture(b$M,(b$v._byteLength>>2)-16),this._curSubmit._numEle+=6,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle))},b$y.drawTextureWithTransform=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){if(b$f){var b$X=this._curMat,b$F=this._x,b$o=this._y;(0!==b$V||0!==b$K)&&(this._x=b$V*b$X.a+b$K*b$X.c,this._y=b$K*b$X.d+b$V*b$X.b),b$f&&b$X.bTransform?(b$W.mul(b$f,b$X,b$p._tmpMatrix),(b$f=b$p._tmpMatrix)._checkTransform()):(this._x+=b$X.tx,this._y+=b$X.ty),this._drawTextureM(b$M,b$y,b$i,b$H,b$S,0,0,b$f,b$k),this._x=b$F,this._y=b$o}else this._drawTextureM(b$M,b$y,b$i,b$H,b$S,b$V,b$K,null,b$k)},b$y.fillQuadrangle=function(b$M,b$y,b$i,b$H,b$S){var b$f=this._curSubmit,b$V=this._vb,b$K=this._shader2D,b$k=b$f.shaderValue;if(this._renderKey=0,b$M.bitmap){var b$X=b$M.bitmap;b$K.glTexture==b$X&&b$K.ALPHA===b$k.ALPHA||(b$K.glTexture=b$X,(b$f=this._curSubmit=b$fM.createSubmit(this,this._ib,b$V,b$V._byteLength/32*3,b$QM.create(1,0))).shaderValue.glTexture=b$X,this._submits[this._submits._length++]=b$f),b$hM.fillQuadrangleImgVb(b$V,b$y,b$i,b$H,b$M.uv,b$S||this._curMat,this._x,this._y)}else b$f.shaderValue.fillStyle&&b$f.shaderValue.fillStyle.equal(b$M)&&b$K.ALPHA===b$k.ALPHA||(b$K.glTexture=null,(b$f=this._curSubmit=b$fM.createSubmit(this,this._ib,b$V,b$V._byteLength/32*3,b$QM.create(2,0))).shaderValue.defines.add(2),b$f.shaderValue.fillStyle=b$_.create(b$M),this._submits[this._submits._length++]=b$f),b$hM.fillQuadrangleImgVb(b$V,b$y,b$i,b$H,b$z.DEF_UV,b$S||this._curMat,this._x,this._y);b$f._numEle+=6},b$y.drawTexture2=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){if(0!=b$f){var b$k=this._curMat;if(this._x=b$M*b$k.a+b$y*b$k.c,this._y=b$y*b$k.d+b$M*b$k.b,b$S&&(b$S=b$k.bTransform||b$S.bTransform?(b$W.mul(b$S,b$k,b$p._tmpMatrix),b$p._tmpMatrix):(this._x+=b$S.tx+b$k.tx,this._y+=b$S.ty+b$k.ty,b$W.EMPTY)),1!==b$f||b$V){var b$X=this._shader2D.ALPHA,b$F=this._nBlendType;this._shader2D.ALPHA=b$f,b$V&&(this._nBlendType=b$E.TOINT(b$V)),this._drawTextureM(b$K[0],b$K[1]-b$i,b$K[2]-b$H,b$K[3],b$K[4],0,0,b$S,1),this._shader2D.ALPHA=b$X,this._nBlendType=b$F}else this._drawTextureM(b$K[0],b$K[1]-b$i,b$K[2]-b$H,b$K[3],b$K[4],0,0,b$S,1);this._x=this._y=0}},b$y.drawCanvas=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$M.context;if(this._renderKey=0,b$f._targets)this._submits[this._submits._length++]=b$sM.create(b$f,0,null),this._curSubmit=b$fM.RENDERBASE,b$f._targets.drawTo(this,b$y,b$i,b$H,b$S);else{var b$V=this._submits[this._submits._length++]=b$sM.create(b$f,this._shader2D.ALPHA,this._shader2D.filters),b$K=b$H/b$M.width,b$k=b$S/b$M.height,b$X=b$V._matrix;this._curMat.copyTo(b$X),1!=b$K&&1!=b$k&&b$X.scale(b$K,b$k);var b$F=b$X.tx,b$o=b$X.ty;b$X.tx=b$X.ty=0,b$X.transformPoint(b$c.TEMP.setTo(b$y,b$i)),b$X.translate(b$c.TEMP.x+b$F,b$c.TEMP.y+b$o),this._curSubmit=b$fM.RENDERBASE}b$U.showCanvasMark&&(this.save(),this.lineWidth=4,this.strokeStyle=b$f._targets?"yellow":"green",this.strokeRect(b$y-1,b$i-1,b$H+2,b$S+2,1),this.strokeRect(b$y,b$i,b$H,b$S,1),this.restore())},b$y.drawTarget=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){void 0===b$X&&(b$X=-1);var b$F=this._vb;if(b$hM.fillRectImgVb(b$F,this._clipRect,b$y,b$i,b$H,b$S,b$k||b$z.DEF_UV,b$f||this._curMat,this._x,this._y,0,0)){this._renderKey=0,this._shader2D.glTexture=null;this._curSubmit.shaderValue;var b$o=this._curSubmit=b$oM.create(this,this._ib,b$F,(b$F._byteLength-64)/32*3,b$K,b$V);b$o.blendType=-1==b$X?this._nBlendType:b$X,b$o.scope=b$M,this._submits[this._submits._length++]=b$o,this._curSubmit._numEle+=6}},b$y.mixRGBandAlpha=function(b$M){return this._mixRGBandAlpha(b$M,this._shader2D.ALPHA)},b$y._mixRGBandAlpha=function(b$M,b$y){var b$i=(4278190080&b$M)>>>24;return 0!=b$i?b$i*=b$y:b$i=255*b$y,16777215&b$M|b$i<<24},b$y.drawTriangles=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){if(!b$M.loaded||!b$M.source)return this.sprite&&b$I.timer.callLater(this,this._repaintSprite),!1;this._drawCount++;b$M.bitmap;var b$F=this._mixRGBandAlpha(4294967295,b$K),b$o=(b$H.length,b$f.length);this._renderKey=-1;var b$d=this._curSubmit=b$DM.create(this,this._triangleMesh.getIBR(),this._triangleMesh.getVBR(),this._triangleMesh.indexNum,b$QM.create(1,0));return b$d.shaderValue.textureHost=b$M,b$d._renderType=10016,this._submits[this._submits._length++]=b$d,b$V?(b$p._tmpMatrix.a=b$V.a,b$p._tmpMatrix.b=b$V.b,b$p._tmpMatrix.c=b$V.c,b$p._tmpMatrix.d=b$V.d,b$p._tmpMatrix.tx=b$V.tx+b$y,b$p._tmpMatrix.ty=b$V.ty+b$i,b$W.mul(b$p._tmpMatrix,this._curMat,b$p._tmpMatrix)):(b$p._tmpMatrix.a=this._curMat.a,b$p._tmpMatrix.b=this._curMat.b,b$p._tmpMatrix.c=this._curMat.c,b$p._tmpMatrix.d=this._curMat.d,b$p._tmpMatrix.tx=this._curMat.tx+b$y,b$p._tmpMatrix.ty=this._curMat.ty+b$i),this._triangleMesh.addData(b$H,b$S,b$f,b$p._tmpMatrix,b$F,this),this._curSubmit._numEle+=b$o,this._maxNumEle=Math.max(this._maxNumEle,this._curSubmit._numEle),!0},b$y.transform=function(b$M,b$y,b$i,b$H,b$S,b$f){b$x.save(this),b$W.mul(b$W.TEMP.setTo(b$M,b$y,b$i,b$H,b$S,b$f),this._curMat,this._curMat),this._curMat._checkTransform()},b$y.setTransformByMatrix=function(b$M){b$M.copyTo(this._curMat)},b$y.transformByMatrix=function(b$M){b$x.save(this),b$W.mul(b$M,this._curMat,this._curMat),this._curMat._checkTransform()},b$y.rotate=function(b$M){b$x.save(this),this._curMat.rotateEx(b$M)},b$y.scale=function(b$M,b$y){b$x.save(this),this._curMat.scaleEx(b$M,b$y)},b$y.clipRect=function(b$M,b$y,b$i,b$H){if(0!=this._curMat.b||0!=this._curMat.c){this._renderKey=0;var b$S=b$FM.create(4);this.addRenderObject(b$S);var b$f=this._vb,b$V=b$f._byteLength>>2;if(b$hM.fillRectImgVb(b$f,null,b$M,b$y,b$i,b$H,b$z.DEF_UV,this._curMat,this._x,this._y,0,0)){this._shader2D.glTexture=null;var b$K=this._curSubmit=b$fM.createSubmit(this,this._ib,b$f,(b$f._byteLength-64)/32*3,b$QM.create(2,0));b$K.shaderValue.ALPHA=1,this._submits[this._submits._length++]=b$K,this._curSubmit._numEle+=6}else alert("clipRect calc stencil rect error");var b$k=b$FM.create(5);this.addRenderObject(b$k);var b$X=b$f.getFloat32Array(),b$F=Math.min(Math.min(Math.min(b$X[0+b$V],b$X[4+b$V]),b$X[8+b$V]),b$X[12+b$V]),b$o=Math.max(Math.max(Math.max(b$X[0+b$V],b$X[4+b$V]),b$X[8+b$V]),b$X[12+b$V]),b$d=Math.min(Math.min(Math.min(b$X[1+b$V],b$X[5+b$V]),b$X[9+b$V]),b$X[13+b$V]),b$P=Math.max(Math.max(Math.max(b$X[1+b$V],b$X[5+b$V]),b$X[9+b$V]),b$X[13+b$V]);b$N.save(this,b$k,b$M,b$y,b$i,b$H,b$F,b$d,b$o-b$F,b$P-b$d),this._curSubmit=b$fM.RENDERBASE}else{b$i*=this._curMat.a,b$H*=this._curMat.d;var b$l=b$c.TEMP;this._curMat.transformPoint(b$l.setTo(b$M,b$y)),b$i<0&&(b$l.x=b$l.x+b$i,b$i=-b$i),b$H<0&&(b$l.y=b$l.y+b$H,b$H=-b$H),this._renderKey=0;var b$J=this._curSubmit=b$XM.create(this);(this._submits[this._submits._length++]=b$J).submitIndex=this._submits._length,b$J.submitLength=9999999,b$r.save(this,b$J);var b$h=this._clipRect,b$C=b$h.x,b$v=b$h.y,b$R=b$l.x+b$i,b$A=b$l.y+b$H;b$C<b$l.x&&(b$h.x=b$l.x),b$v<b$l.y&&(b$h.y=b$l.y),b$h.width=Math.min(b$R,b$C+b$h.width)-b$h.x,b$h.height=Math.min(b$A,b$v+b$h.height)-b$h.y,this._shader2D.glTexture=null,b$J.clipRect.copyFrom(b$h),this._curSubmit=b$fM.RENDERBASE}},b$y.setIBVB=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F){if(void 0===b$k&&(b$k=0),void 0===b$X&&(b$X=0),void 0===b$F&&(b$F=0),null===b$i){if(b$C.isFlash){var b$o=b$H;b$o._selfIB||(b$o._selfIB=b$OM.create(35044)),b$o._selfIB.clear(),b$i=b$o._selfIB}else b$i=this._ib;b$hM.expandIBQuadrangle(b$i,b$H._byteLength/(4*b$H.vertexStride*4))}if(!b$K||!b$V)throw Error("setIBVB must input:shader shaderValues");var b$d=b$kM.create(this,b$H,b$i,b$S,b$V,b$K,b$k,b$X,b$F);b$f||(b$f=b$W.EMPTY),b$f.translate(b$M,b$y),b$W.mul(b$f,this._curMat,b$d._mat),b$f.translate(-b$M,-b$y),this._submits[this._submits._length++]=b$d,this._curSubmit=b$fM.RENDERBASE,this._renderKey=0},b$y.addRenderObject=function(b$M){this._submits[this._submits._length++]=b$M},b$y.fillTrangles=function(b$M,b$y,b$i,b$H,b$S){var b$f=this._curSubmit,b$V=this._vb,b$K=this._shader2D,b$k=b$f.shaderValue,b$X=b$H.length>>4,b$F=b$M.bitmap;this._renderKey=0,b$K.glTexture==b$F&&b$K.ALPHA===b$k.ALPHA||((b$f=this._curSubmit=b$fM.createSubmit(this,this._ib,b$V,b$V._byteLength/32*3,b$QM.create(1,0))).shaderValue.textureHost=b$M,this._submits[this._submits._length++]=b$f),b$hM.fillTranglesVB(b$V,b$y,b$i,b$H,b$S||this._curMat,this._x,this._y),b$f._numEle+=6*b$X},b$y.submitElement=function(b$M,b$y){var b$i=this._submits;for(b$y<0&&(b$y=b$i._length);b$M<b$y;)b$M+=b$i[b$M].renderSubmit()},b$y.finish=function(){b$AM.mainContext.finish()},b$y.flush=function(){var b$M=Math.max(this._vb._byteLength/64,this._maxNumEle/6)+8;if(b$M>this._ib.bufferLength/12&&b$hM.expandIBQuadrangle(this._ib,b$M),!this._isMain&&b$B.enabled&&b$B._atlasRestore>this._atlasResourceChange){this._atlasResourceChange=b$B._atlasRestore;for(var b$y=this._submits,b$i=0,b$H=b$y._length;b$i<b$H;b$i++){var b$S=b$y[b$i];10016===b$S.getRenderType()&&b$S.checkTexture()}}this.submitElement(0,this._submits._length),this._path&&this._path.reset(),b$yM.instance&&b$yM.getInstance().reset();var b$f;for(b$i=0,b$f=this.meshlist.length;b$i<b$f;b$i++){var b$V=this.meshlist[b$i];b$V.canReuse?b$V.releaseMesh():b$V.destroy()}return this.meshlist.length=0,this._curSubmit=b$fM.RENDERBASE,this._renderKey=0,this._triangleMesh=b$zM.getAMesh(),this.meshlist.push(this._triangleMesh),this._submits._length},b$y.setPathId=function(b$M){if(this.mId=b$M,-1!=this.mId){this.mHaveKey=!1;var b$y=b$q.getInstance();b$y.shapeDic[this.mId]&&(this.mHaveKey=!0),this.mHaveLineKey=!1,b$y.shapeLineDic[this.mId]&&(this.mHaveLineKey=!0)}},b$y.movePath=function(b$M,b$y){var b$i=b$M,b$H=b$y;b$M=this._curMat.a*b$i+this._curMat.c*b$H+this._curMat.tx,b$y=this._curMat.b*b$i+this._curMat.d*b$H+this._curMat.ty,this.mX+=b$M,this.mY+=b$y},b$y.beginPath=function(){var b$M=this._getPath();b$M.tempArray.length=0,b$M.closePath=!1,this.mX=0,this.mY=0},b$y.closePath=function(){this._path.closePath=!0},b$y.fill=function(b$M){void 0===b$M&&(b$M=!1);var b$y=this._getPath();this.drawPoly(0,0,b$y.tempArray,this.fillStyle._color.numColor,0,0,b$M)},b$y.stroke=function(){var b$M=this._getPath();if(0<this.lineWidth){if(-1==this.mId)b$M.drawLine(0,0,b$M.tempArray,this.lineWidth,this.strokeStyle._color.numColor);else if(this.mHaveLineKey){var b$y=b$q.getInstance().shapeLineDic[this.mId];b$y.rebuild(b$M.tempArray),b$M.setGeomtry(b$y)}else b$q.getInstance().addLine(this.mId,b$M.drawLine(0,0,b$M.tempArray,this.lineWidth,this.strokeStyle._color.numColor));b$M.update();var b$i=[this.mX,this.mY],b$H=b$fM.createShape(this,b$M.ib,b$M.vb,b$M.count,b$M.offset,b$QM.create(4,0));b$H.shaderValue.ALPHA=this._shader2D.ALPHA,b$H.shaderValue.u_pos=b$i,b$H.shaderValue.u_mmat2=b$vM.TEMPMAT4_ARRAY,this._submits[this._submits._length++]=b$H,this._renderKey=-1}},b$y.line=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=this._curSubmit,b$K=this._vb;if(b$hM.fillLineVb(b$K,this._clipRect,b$M,b$y,b$i,b$H,b$S,b$f)){this._renderKey=0;var b$k=this._shader2D,b$X=b$V.shaderValue;b$k.strokeStyle===b$X.strokeStyle&&b$k.ALPHA===b$X.ALPHA||(b$k.glTexture=null,(b$V=this._curSubmit=b$fM.createSubmit(this,this._ib,b$K,(b$K._byteLength-64)/32*3,b$QM.create(2,0))).shaderValue.strokeStyle=b$k.strokeStyle,b$V.shaderValue.mainID=2,b$V.shaderValue.ALPHA=b$k.ALPHA,this._submits[this._submits._length++]=b$V),b$V._numEle+=6}},b$y.moveTo=function(b$M,b$y,b$i){void 0===b$i&&(b$i=!0);var b$H=this._getPath();if(b$i){var b$S=b$M,b$f=b$y;b$M=this._curMat.a*b$S+this._curMat.c*b$f,b$y=this._curMat.b*b$S+this._curMat.d*b$f}b$H.addPoint(b$M,b$y)},b$y.lineTo=function(b$M,b$y,b$i){void 0===b$i&&(b$i=!0);var b$H=this._getPath();if(b$i){var b$S=b$M,b$f=b$y;b$M=this._curMat.a*b$S+this._curMat.c*b$f,b$y=this._curMat.b*b$S+this._curMat.d*b$f}b$H.addPoint(b$M,b$y)},b$y.drawCurves=function(b$M,b$y,b$i){this.setPathId(-1),this.beginPath(),this.strokeStyle=b$i[3],this.lineWidth=b$i[4];var b$H=b$i[2];b$M+=b$i[0],b$y+=b$i[1],this.movePath(b$M,b$y),this.moveTo(b$H[0],b$H[1]);for(var b$S=2,b$f=b$H.length;b$S<b$f;)this.quadraticCurveTo(b$H[b$S++],b$H[b$S++],b$H[b$S++],b$H[b$S++]);this.stroke()},b$y.arcTo=function(b$M,b$y,b$i,b$H,b$S){if(-1==this.mId||!this.mHaveKey){var b$f=0,b$V=0,b$K=0,b$k=this._getPath();this._curMat.copyTo(b$p._tmpMatrix),b$p._tmpMatrix.tx=b$p._tmpMatrix.ty=0,b$p._tempPoint.setTo(b$k.getEndPointX(),b$k.getEndPointY()),b$p._tmpMatrix.invertTransformPoint(b$p._tempPoint);var b$X=b$p._tempPoint.x-b$M,b$F=b$p._tempPoint.y-b$y,b$o=Math.sqrt(b$X*b$X+b$F*b$F);if(!(b$o<=1e-6)){var b$d=b$X/b$o,b$P=b$F/b$o,b$l=b$i-b$M,b$J=b$H-b$y,b$h=b$l*b$l+b$J*b$J,b$C=Math.sqrt(b$h);if(!(b$C<=1e-6)){var b$v=b$l/b$C,b$R=b$J/b$C,b$A=b$d+b$v,b$G=b$P+b$R,b$I=Math.sqrt(b$A*b$A+b$G*b$G);if(!(b$I<=1e-6)){var b$U=b$A/b$I,b$Q=b$G/b$I,b$W=Math.acos(b$U*b$d+b$Q*b$P),b$c=Math.PI/2-b$W,b$n=(b$o=b$S/Math.tan(b$c))*b$d+b$M,b$a=b$o*b$P+b$y,b$T=Math.sqrt(b$o*b$o+b$S*b$S),b$m=b$M+b$U*b$T,b$e=b$y+b$Q*b$T,b$s=0,b$D=0;if(0<=b$d*b$R-b$P*b$v){var b$z=2*b$c/b$p.SEGNUM;b$s=Math.sin(b$z),b$D=Math.cos(b$z)}else b$z=2*-b$c/b$p.SEGNUM,b$s=Math.sin(b$z),b$D=Math.cos(b$z);b$V=this._curMat.a*b$n+this._curMat.c*b$a,b$K=this._curMat.b*b$n+this._curMat.d*b$a,b$V==this._path.getEndPointX()&&b$K==this._path.getEndPointY()||b$k.addPoint(b$V,b$K);var b$w=b$n-b$m,b$q=b$a-b$e;for(b$f=0;b$f<b$p.SEGNUM;b$f++){var b$t=b$w*b$D+b$q*b$s,b$u=-b$w*b$s+b$q*b$D;b$V=b$t+b$m,b$K=b$u+b$e,b$M=this._curMat.a*b$V+this._curMat.c*b$K,b$K=b$y=this._curMat.b*b$V+this._curMat.d*b$K,(b$V=b$M)==this._path.getEndPointX()&&b$K==this._path.getEndPointY()||b$k.addPoint(b$V,b$K),b$w=b$t,b$q=b$u}}}}}},b$y.arc=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){if(void 0===b$f&&(b$f=!1),void 0===b$V&&(b$V=!0),-1!=this.mId){var b$K=b$q.getInstance().shapeDic[this.mId];if(b$K&&this.mHaveKey&&!b$K.needUpdate(this._curMat))return;b$y=b$M=0}var b$k,b$X=0,b$F=0,b$o=0,b$d=0,b$P=0,b$l=0,b$J=0;if(b$F=b$S-b$H,b$f)if(Math.abs(b$F)>=2*Math.PI)b$F=2*-Math.PI;else for(;0<b$F;)b$F-=2*Math.PI;else if(Math.abs(b$F)>=2*Math.PI)b$F=2*Math.PI;else for(;b$F<0;)b$F+=2*Math.PI;b$k=b$F/(b$J=b$i<101?Math.max(10,b$F*b$i/5):b$i<201?Math.max(10,b$F*b$i/20):Math.max(10,b$F*b$i/40))/2,b$o=Math.abs(4/3*(1-Math.cos(b$k))/Math.sin(b$k)),b$f&&(b$o=-b$o);var b$h=this._getPath(),b$C=NaN,b$v=NaN;for(b$l=0;b$l<=b$J;b$l++)b$X=b$H+b$F*(b$l/b$J),b$d=b$M+Math.cos(b$X)*b$i,b$P=b$y+Math.sin(b$X)*b$i,b$V&&(b$C=b$d,b$v=b$P,b$d=this._curMat.a*b$C+this._curMat.c*b$v,b$P=this._curMat.b*b$C+this._curMat.d*b$v),b$d==this._path.getEndPointX()&&b$P==this._path.getEndPointY()||b$h.addPoint(b$d,b$P);b$d=b$M+Math.cos(b$S)*b$i,b$P=b$y+Math.sin(b$S)*b$i,b$V&&(b$C=b$d,b$v=b$P,b$d=this._curMat.a*b$C+this._curMat.c*b$v,b$P=this._curMat.b*b$C+this._curMat.d*b$v),b$d==this._path.getEndPointX()&&b$P==this._path.getEndPointY()||b$h.addPoint(b$d,b$P)},b$y.quadraticCurveTo=function(b$M,b$y,b$i,b$H){var b$S=b$o.I,b$f=b$i,b$V=b$H;b$i=this._curMat.a*b$f+this._curMat.c*b$V,b$H=this._curMat.b*b$f+this._curMat.d*b$V,b$f=b$M,b$V=b$y,b$M=this._curMat.a*b$f+this._curMat.c*b$V,b$y=this._curMat.b*b$f+this._curMat.d*b$V;for(var b$K=b$S.getBezierPoints([this._path.getEndPointX(),this._path.getEndPointY(),b$M,b$y,b$i,b$H],30,2),b$k=0,b$X=b$K.length/2;b$k<b$X;b$k++)this.lineTo(b$K[2*b$k],b$K[2*b$k+1],!1);this.lineTo(b$i,b$H,!1)},b$y.rect=function(b$M,b$y,b$i,b$H){this._other=this._other.make(),this._other.path||(this._other.path=new b$b),this._other.path.rect(b$M,b$y,b$i,b$H)},b$y.strokeRect=function(b$M,b$y,b$i,b$H,b$S){var b$f=.5*b$S;this.line(b$M-b$f,b$y,b$M+b$i+b$f,b$y,b$S,this._curMat),this.line(b$M+b$i,b$y,b$M+b$i,b$y+b$H,b$S,this._curMat),this.line(b$M,b$y,b$M,b$y+b$H,b$S,this._curMat),this.line(b$M-b$f,b$y+b$H,b$M+b$i+b$f,b$y+b$H,b$S,this._curMat)},b$y.clip=function(){},b$y.drawPoly=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){void 0===b$V&&(b$V=!1),this._renderKey=0,this._shader2D.glTexture=null;var b$K=this._getPath();if(-1==this.mId)b$K.polygon(b$M,b$y,b$i,b$H,b$S||1,b$f);else if(this.mHaveKey){var b$k=b$q.getInstance().shapeDic[this.mId];b$k.setMatrix(this._curMat),b$k.rebuild(b$K.tempArray),b$K.setGeomtry(b$k)}else{var b$X=b$K.polygon(b$M,b$y,b$i,b$H,b$S||1,b$f);b$q.getInstance().addShape(this.mId,b$X),b$X.setMatrix(this._curMat)}b$K.update();var b$F,b$o=[this.mX,this.mY];if((b$F=b$fM.createShape(this,b$K.ib,b$K.vb,b$K.count,b$K.offset,b$QM.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,b$F.shaderValue.u_pos=b$o,b$F.shaderValue.u_mmat2=b$vM.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=b$F,0<b$S){if(this.mHaveLineKey){var b$d=b$q.getInstance().shapeLineDic[this.mId];b$d.rebuild(b$K.tempArray),b$K.setGeomtry(b$d)}else b$q.getInstance().addShape(this.mId,b$K.drawLine(b$M,b$y,b$i,b$S,b$f));b$K.update(),(b$F=b$fM.createShape(this,b$K.ib,b$K.vb,b$K.count,b$K.offset,b$QM.create(4,0))).shaderValue.ALPHA=this._shader2D.ALPHA,b$F.shaderValue.u_mmat2=b$vM.EMPTYMAT4_ARRAY,this._submits[this._submits._length++]=b$F}},b$y.drawParticle=function(b$M,b$y,b$i){b$i.x=b$M,b$i.y=b$y,this._submits[this._submits._length++]=b$i},b$y._getPath=function(){return this._path||(this._path=new b$b)},b$H(0,b$y,"globalCompositeOperation",function(){return b$E.NAMES[this._nBlendType]},function(b$M){var b$y=b$E.TOINT[b$M];null==b$y||this._nBlendType===b$y||(b$Y.save(this,65536,this,!0),this._curSubmit=b$fM.RENDERBASE,this._renderKey=0,this._nBlendType=b$y)}),b$H(0,b$y,"strokeStyle",function(){return this._shader2D.strokeStyle},function(b$M){this._shader2D.strokeStyle.equal(b$M)||(b$Y.save(this,512,this._shader2D,!1),this._shader2D.strokeStyle=b$_.create(b$M))}),b$H(0,b$y,"globalAlpha",function(){return this._shader2D.ALPHA},function(b$M){(b$M=Math.floor(1e3*b$M)/1e3)!=this._shader2D.ALPHA&&(b$Y.save(this,1,this._shader2D,!0),this._shader2D.ALPHA=b$M)}),b$H(0,b$y,"asBitmap",null,function(b$M){if(b$M){if(this._targets||(this._targets=new b$j),this._targets.repaint=!0,!this._width||!this._height)throw Error("asBitmap no size!");this._targets.setSP(this.sprite),this._targets.size(this._width,this._height)}else this._targets=null}),b$H(0,b$y,"fillStyle",function(){return this._shader2D.fillStyle},function(b$M){this._shader2D.fillStyle.equal(b$M)||(b$Y.save(this,2,this._shader2D,!1),this._shader2D.fillStyle=b$_.create(b$M))}),b$H(0,b$y,"textAlign",function(){return this._other.textAlign},function(b$M){this._other.textAlign===b$M||(this._other=this._other.make(),b$Y.save(this,32768,this._other,!1),this._other.textAlign=b$M)}),b$H(0,b$y,"lineWidth",function(){return this._other.lineWidth},function(b$M){this._other.lineWidth===b$M||(this._other=this._other.make(),b$Y.save(this,256,this._other,!1),this._other.lineWidth=b$M)}),b$H(0,b$y,"textBaseline",function(){return this._other.textBaseline},function(b$M){this._other.textBaseline===b$M||(this._other=this._other.make(),b$Y.save(this,16384,this._other,!1),this._other.textBaseline=b$M)}),b$H(0,b$y,"font",null,function(b$M){b$M!=this._other.font.toString()&&(this._other=this._other.make(),b$Y.save(this,8,this._other,!1),this._other.font===b$lM.EMPTY?this._other.font=new b$lM(b$M):this._other.font.setFont(b$M))}),b$p.__init__=function(){b$i.DEFAULT=new b$i},b$p._tempPoint=new b$c,b$p._SUBMITVBSIZE=32e3,b$p._MAXSIZE=99999999,b$p._RECTVBSIZE=16,b$p.MAXCLIPRECT=new b$n(0,0,99999999,99999999),b$p._COUNT=0,b$p._tmpMatrix=new b$W,b$p.SEGNUM=32,b$p._contextcount=0,b$V(b$p,["_fontTemp",function(){return this._fontTemp=new b$lM},"_drawStyleTemp",function(){return this._drawStyleTemp=new b$_(null)}]),b$p.__init$=function(){b$i=function(){function b$M(){this.lineWidth=1,this.path=null,this.textAlign=null,this.textBaseline=null,this.font=b$lM.EMPTY}b$d(b$M,"");var b$y=b$M.prototype;return b$y.clear=function(){this.lineWidth=1,this.path&&this.path.clear(),this.textAlign=this.textBaseline=null,this.font=b$lM.EMPTY},b$y.make=function(){return this===b$M.DEFAULT?new b$M:this},b$M.DEFAULT=null,b$M}()},b$p}(),b$QM=function(b$M){function b$H(b$M,b$y){this.size=[0,0],this.alpha=1,this.ALPHA=1,this.subID=0,this._cacheID=0,b$H.__super.call(this),this.defines=new b$aM,this.position=b$H._POSITION,this.mainID=b$M,this.subID=b$y,this.textureHost=null,this.texture=null,this.texture1=null,this.fillStyle=null,this.color=null,this.strokeStyle=null,this.colorAdd=null,this.glTexture=null,this.u_mmat2=null,this._cacheID=b$M|b$y,this._inClassCache=b$H._cache[this._cacheID],0<b$M&&!this._inClassCache&&(this._inClassCache=b$H._cache[this._cacheID]=[],this._inClassCache._length=0),this.clear()}b$d(b$H,"laya.webgl.shader.d2.value.Value2D",b$u);var b$y=b$H.prototype;return b$y.setValue=function(b$M){},b$y.refresh=function(){var b$M=this.size;return b$M[0]=b$vM.width,b$M[1]=b$vM.height,this.alpha=this.ALPHA*b$vM.worldAlpha,this.mmat=b$vM.worldMatrix4,this},b$y._ShaderWithCompile=function(){return b$$M.withCompile2D(0,this.mainID,this.defines.toNameDic(),this.mainID|this.defines._value,b$jM.create)},b$y._withWorldShaderDefines=function(){var b$M=b$vM.worldShaderDefines,b$y=b$$M.sharders[this.mainID|this.defines._value|b$M.getValue()];if(!b$y){var b$i,b$H={};for(b$i in this.defines.toNameDic())b$H[b$i]="";for(b$i in b$M.toNameDic())b$H[b$i]="";b$y=b$$M.withCompile2D(0,this.mainID,b$H,this.mainID|this.defines._value|b$M.getValue(),b$jM.create)}var b$S=b$vM.worldFilters;if(!b$S)return b$y;for(var b$f,b$V=b$S.length,b$K=0;b$K<b$V;b$K++)(b$f=b$S[b$K])&&b$f.action.setValue(this);return b$y},b$y.upload=function(){var b$M=b$vM;this.alpha=this.ALPHA*b$M.worldAlpha,b$vM.worldMatrix4!==b$vM.TEMPMAT4_ARRAY&&this.defines.add(128),this.textureHost&&this.textureHost.alphaTexture?this.defines.add(2048):this.defines.remove(2048),this.textureHost&&this.textureHost.bitmap&&(37815==this.textureHost.bitmap.format||37812==this.textureHost.bitmap.format||37821==this.textureHost.bitmap.format)?this.defines.add(4096):this.defines.remove(4096),b$AM.shaderHighPrecision&&this.defines.add(1024);var b$y,b$i=b$M.worldShaderDefines?this._withWorldShaderDefines():b$$M.sharders[this.mainID|this.defines._value]||this._ShaderWithCompile();this.size[0]=b$M.width,this.size[1]=b$M.height,this.mmat=b$M.worldMatrix4,b$wM.activeShader!==b$i?b$i._shaderValueWidth!==b$M.width||b$i._shaderValueHeight!==b$M.height?(b$i._shaderValueWidth=b$M.width,b$i._shaderValueHeight=b$M.height):b$y=b$i._params2dQuick2||b$i._make2dQuick2():b$i._shaderValueWidth!==b$M.width||b$i._shaderValueHeight!==b$M.height?(b$i._shaderValueWidth=b$M.width,b$i._shaderValueHeight=b$M.height):b$y=b$i._params2dQuick1||b$i._make2dQuick1(),b$i.upload(this,b$y)},b$y.setFilters=function(b$M){if(this.filters=b$M)for(var b$y,b$i=b$M.length,b$H=0;b$H<b$i;b$H++)(b$y=b$M[b$H])&&(this.defines.add(b$y.type),b$y.action.setValue(this))},b$y.clear=function(){this.defines.setValue(this.subID)},b$y.release=function(){(this._inClassCache[this._inClassCache._length++]=this).fillStyle=null,this.strokeStyle=null,this.textureHost=null,this.mmat=null,this.clear()},b$H._initone=function(b$M,b$y){b$H._typeClass[b$M]=b$y,b$H._cache[b$M]=[],b$H._cache[b$M]._length=0},b$H.__init__=function(){b$H._POSITION=[2,5126,!1,4*b$JM.BYTES_PE,0],b$H._TEXCOORD=[2,5126,!1,4*b$JM.BYTES_PE,2*b$JM.BYTES_PE],b$H._initone(2,b$pM),b$H._initone(4,b$EM),b$H._initone(256,b$BM),b$H._initone(512,b$uM),b$H._initone(1,b$ZM),b$H._initone(65,b$gM),b$H._initone(9,b$ZM)},b$H.create=function(b$M,b$y){var b$i=b$H._cache[b$M|b$y];return b$i._length?b$i[--b$i._length]:new b$H._typeClass[b$M|b$y](b$y)},b$H._POSITION=null,b$H._TEXCOORD=null,b$H._cache=[],b$H._typeClass=[],b$H.TEMPMAT4_ARRAY=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],b$H}(),b$WM=function(b$M){function b$h(b$M,b$y){b$h.__super.call(this,b$M,b$y)}b$d(b$h,"laya.webgl.utils.RenderSprite3D",b$v);var b$y=b$h.prototype;return b$y.onCreate=function(b$M){switch(b$M){case 8:return void(this._fun=this._blend);case 4:return void(this._fun=this._transform)}},b$y._mask=function(b$M,b$y,b$i,b$H){var b$S,b$f,b$V=this._next,b$K=b$M.mask;if(b$K){b$y.ctx.save();var b$k=b$y.ctx.globalCompositeOperation,b$X=new b$n;if(b$X.copyFrom(b$K.getBounds()),b$X.width=Math.round(b$X.width),b$X.height=Math.round(b$X.height),b$X.x=Math.round(b$X.x),b$X.y=Math.round(b$X.y),0<b$X.width&&0<b$X.height){var b$F=b$M._style._tf,b$o=b$KM.create();b$o.addValue("bounds",b$X),b$S=b$VM.create([b$o,b$y],laya.webgl.utils.RenderSprite3D.tmpTarget),b$y.addRenderObject(b$S),b$K.render(b$y,-b$X.x,-b$X.y),b$S=b$VM.create([b$o],laya.webgl.utils.RenderSprite3D.endTmpTarget),b$y.addRenderObject(b$S),b$y.ctx.save(),b$y.clipRect(b$i-b$F.translateX+b$X.x,b$H-b$F.translateY+b$X.y,b$X.width,b$X.height),b$V._fun.call(b$V,b$M,b$y,b$i,b$H),b$y.ctx.restore(),b$f=b$FM.create(6),b$k=b$y.ctx.globalCompositeOperation,b$f.blendMode="mask",b$y.addRenderObject(b$f),b$W.TEMP.identity();var b$d=b$QM.create(1,0),b$P=b$z.INV_UV,b$l=b$X.width,b$J=b$X.height;(b$X.width<32||b$X.height<32)&&((b$P=b$h.tempUV)[0]=0,b$P[1]=0,b$P[2]=32<=b$X.width?1:b$X.width/32,b$P[3]=0,b$P[4]=32<=b$X.width?1:b$X.width/32,b$P[5]=32<=b$X.height?1:b$X.height/32,b$P[6]=0,b$P[7]=32<=b$X.height?1:b$X.height/32,b$X.width=32<=b$X.width?b$X.width:32,b$X.height=32<=b$X.height?b$X.height:32,b$P[1]*=-1,b$P[3]*=-1,b$P[5]*=-1,b$P[7]*=-1,b$P[1]+=1,b$P[3]+=1,b$P[5]+=1,b$P[7]+=1),b$y.ctx.drawTarget(b$o,b$i+b$X.x-b$F.translateX,b$H+b$X.y-b$F.translateY,b$l,b$J,b$W.TEMP,"tmpTarget",b$d,b$P,6),b$S=b$VM.create([b$o],laya.webgl.utils.RenderSprite3D.recycleTarget),b$y.addRenderObject(b$S),(b$f=b$FM.create(6)).blendMode=b$k,b$y.addRenderObject(b$f)}b$y.ctx.restore()}else b$V._fun.call(b$V,b$M,b$y,b$i,b$H)},b$y._blend=function(b$M,b$y,b$i,b$H){var b$S=b$M._style,b$f=this._next;b$S.blendMode?(b$y.ctx.save(),b$y.ctx.globalCompositeOperation=b$S.blendMode,b$f._fun.call(b$f,b$M,b$y,b$i,b$H),b$y.ctx.restore()):b$f._fun.call(b$f,b$M,b$y,b$i,b$H)},b$y._transform=function(b$M,b$y,b$i,b$H){var b$S=b$M.transform,b$f=this._next;if(b$S&&b$f!=b$v.NORENDER){var b$V=b$y.ctx;b$M._style;b$S.tx=b$i,b$S.ty=b$H;var b$K=b$V._getTransformMatrix(),b$k=b$K.clone();b$W.mul(b$S,b$K,b$K),b$K._checkTransform(),b$S.tx=b$S.ty=0,b$f._fun.call(b$f,b$M,b$y,0,0),b$k.copyTo(b$K),b$k.destroy()}else b$f._fun.call(b$f,b$M,b$y,b$i,b$H)},b$h.tmpTarget=function(b$M,b$y){var b$i=b$M.getValue("bounds"),b$H=b$qM.create(b$i.width,b$i.height);b$H.start(),b$H.clear(0,0,0,0),b$M.addValue("tmpTarget",b$H)},b$h.endTmpTarget=function(b$M){b$M.getValue("tmpTarget").end()},b$h.recycleTarget=function(b$M){b$M.getValue("tmpTarget").recycle(),b$M.recycle()},b$V(b$h,["tempUV",function(){return this.tempUV=new Array(8)}]),b$h}(),b$cM=function(b$M){function b$y(){this.data=null,b$y.__super.call(this)}b$d(b$y,"laya.filters.webgl.ColorFilterActionGL",b$t);var b$i=b$y.prototype;return b$I.imps(b$i,{"laya.filters.IFilterActionGL":!0}),b$i.setValue=function(b$M){b$M.colorMat=this.data._mat,b$M.colorAlpha=this.data._alpha},b$i.apply3d=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$M.getValue("bounds"),b$V=b$QM.create(1,0);b$V.setFilters([this.data]);var b$K=b$W.TEMP;b$K.identity(),b$i.ctx.drawTarget(b$M,0,0,b$f.width,b$f.height,b$K,"src",b$V)},b$y}(),b$nM=function(b$M){function b$f(b$M,b$y,b$i,b$H,b$S){this._atlasCanvas=null,this._inAtlasTextureKey=null,this._inAtlasTextureBitmapValue=null,this._inAtlasTextureOriUVValue=null,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue=null,b$f.__super.call(this,b$M,b$y,b$S),this._inAtlasTextureKey=[],this._inAtlasTextureBitmapValue=[],this._inAtlasTextureOriUVValue=[],this._InAtlasWebGLImagesKey={},this._InAtlasWebGLImagesOffsetValue=[],this._atlasCanvas=new b$_M,this._atlasCanvas.uri="Atlaser.AtlasWebGLCanvas._atlasCanvas",(this._atlasCanvas._atlaser=this)._atlasCanvas.width=b$i,this._atlasCanvas.height=b$H,this._atlasCanvas.activeResource(),this._atlasCanvas.lock=!0}b$d(b$f,"laya.webgl.atlas.Atlaser",b$p);var b$y=b$f.prototype;return b$y.computeUVinAtlasTexture=function(b$M,b$y,b$i,b$H){var b$S=b$B.atlasTextureWidth,b$f=b$B.atlasTextureHeight,b$V=b$i/b$S,b$K=b$H/b$f,b$k=(b$i+b$M.bitmap.width)/b$S,b$X=(b$H+b$M.bitmap.height)/b$f,b$F=b$M.bitmap.width/b$S,b$o=b$M.bitmap.height/b$f;b$M.uv=[b$V+b$y[0]*b$F,b$K+b$y[1]*b$o,b$k-(1-b$y[2])*b$F,b$K+b$y[3]*b$o,b$k-(1-b$y[4])*b$F,b$X-(1-b$y[5])*b$o,b$V+b$y[6]*b$F,b$X-(1-b$y[7])*b$o]},b$y.findBitmapIsExist=function(b$M){if(b$M instanceof laya.webgl.resource.WebGLImage){var b$y=b$M,b$i=b$y.url,b$H=this._InAtlasWebGLImagesKey[b$i||b$y.id];if(b$H)return b$H.offsetInfoID}return-1},b$y.addToAtlasTexture=function(b$M,b$y,b$i){if(b$M instanceof laya.webgl.resource.WebGLImage){var b$H=b$M,b$S=b$H.url;this._InAtlasWebGLImagesKey[b$S||b$H.id]={bitmap:b$M,offsetInfoID:this._InAtlasWebGLImagesOffsetValue.length},this._InAtlasWebGLImagesOffsetValue.push([b$y,b$i])}this._atlasCanvas.texSubImage2D(b$y,b$i,b$M.atlasSource),b$M.clearAtlasSource()},b$y.addToAtlas=function(b$M,b$y,b$i){b$M._atlasID=this._inAtlasTextureKey.length;var b$H=b$M.uv.slice(),b$S=b$M.bitmap;this._inAtlasTextureKey.push(b$M),this._inAtlasTextureOriUVValue.push(b$H),this._inAtlasTextureBitmapValue.push(b$S),this.computeUVinAtlasTexture(b$M,b$H,b$y,b$i),b$M.bitmap=this._atlasCanvas},b$y.clear=function(){for(var b$M=0,b$y=this._inAtlasTextureKey.length;b$M<b$y;b$M++)this._inAtlasTextureKey[b$M].bitmap=this._inAtlasTextureBitmapValue[b$M],this._inAtlasTextureKey[b$M].uv=this._inAtlasTextureOriUVValue[b$M],this._inAtlasTextureKey[b$M]._atlasID=-1,this._inAtlasTextureKey[b$M].bitmap.lock=!1,this._inAtlasTextureKey[b$M].bitmap.releaseResource();this._inAtlasTextureKey.length=0,this._inAtlasTextureBitmapValue.length=0,this._inAtlasTextureOriUVValue.length=0,this._InAtlasWebGLImagesKey=null,this._InAtlasWebGLImagesOffsetValue.length=0},b$y.dispose=function(){this.clear(),this._atlasCanvas.destroy()},b$H(0,b$y,"InAtlasWebGLImagesOffsetValue",function(){return this._InAtlasWebGLImagesOffsetValue}),b$H(0,b$y,"texture",function(){return this._atlasCanvas}),b$H(0,b$y,"inAtlasWebGLImagesKey",function(){return this._InAtlasWebGLImagesKey}),b$f}(),b$aM=function(b$M){function b$i(){b$i.__super.call(this,b$i.__name2int,b$i.__int2name,b$i.__int2nameMap)}return b$d(b$i,"laya.webgl.shader.d2.ShaderDefines2D",b$L),b$i.__init__=function(){b$i.reg("TEXTURE2D",1),b$i.reg("COLOR2D",2),b$i.reg("PRIMITIVE",4),b$i.reg("GLOW_FILTER",8),b$i.reg("BLUR_FILTER",16),b$i.reg("COLOR_FILTER",32),b$i.reg("COLOR_ADD",64),b$i.reg("WORLDMAT",128),b$i.reg("FILLTEXTURE",256),b$i.reg("FSHIGHPRECISION",1024),b$i.reg("TXTALPHA",2048),b$i.reg("TXTCOMPRESS",4096)},b$i.reg=function(b$M,b$y){b$L._reg(b$M,b$y,b$i.__name2int,b$i.__int2name)},b$i.toText=function(b$M,b$y,b$i){return b$L._toText(b$M,b$y,b$i)},b$i.toInt=function(b$M){return b$L._toInt(b$M,b$i.__name2int)},b$i.TEXTURE2D=1,b$i.COLOR2D=2,b$i.PRIMITIVE=4,b$i.FILTERGLOW=8,b$i.FILTERBLUR=16,b$i.FILTERCOLOR=32,b$i.COLORADD=64,b$i.WORLDMAT=128,b$i.FILLTEXTURE=256,b$i.SKINMESH=512,b$i.SHADERDEFINE_FSHIGHPRECISION=1024,b$i.TXTALPHA=2048,b$i.TXTCOMPRESS=4096,b$i.__name2int={},b$i.__int2name=[],b$i.__int2nameMap=[],b$i}(),b$TM=(function(b$M){function b$K(b$M,b$y,b$i,b$H,b$S,b$f,b$V){b$K.__super.call(this,b$M,b$y,b$i,b$H,40,b$S,b$f,b$V)}b$d(b$K,"laya.webgl.shapes.Ellipse",b$iM)}(),function(b$M){function b$f(b$M,b$y,b$i,b$H,b$S){this._points=[],this.rebuild(b$i),b$f.__super.call(this,b$M,b$y,0,0,0,b$S,b$H,b$S,0)}b$d(b$f,"laya.webgl.shapes.Line",b$iM);var b$y=b$f.prototype;return b$y.rebuild=function(b$M){var b$y=b$M.length;b$y!=this._points.length&&(this.mUint16Array=new Uint16Array(6*(b$y/2-1)),this.mFloat32Array=new Float32Array(5*b$y)),this._points.length=0;for(var b$i=NaN,b$H=NaN,b$S=-1,b$f=-1,b$V=b$M.length/2,b$K=0;b$K<b$V;b$K++)b$i=b$M[2*b$K],b$H=b$M[2*b$K+1],(.01<Math.abs(b$S-b$i)||.01<Math.abs(b$f-b$H))&&this._points.push(b$i,b$H),b$S=b$i,b$f=b$H},b$y.getData=function(b$M,b$y,b$i){var b$H=[],b$S=[];0<this.borderWidth&&this.createLine2(this._points,b$H,this.borderWidth,b$i,b$S,this._points.length/2),this.mUint16Array.set(b$H,0),this.mFloat32Array.set(b$S,0),b$M.append(this.mUint16Array),b$y.append(this.mFloat32Array)},b$f}()),b$mM=function(b$M){function b$o(b$M,b$y,b$i,b$H,b$S){this._points=[];for(var b$f=NaN,b$V=NaN,b$K=-1,b$k=-1,b$X=b$i.length/2-1,b$F=0;b$F<b$X;b$F++)b$f=b$i[2*b$F],b$V=b$i[2*b$F+1],(.01<Math.abs(b$K-b$f)||.01<Math.abs(b$k-b$V))&&this._points.push(b$f,b$V),b$K=b$f,b$k=b$V;b$f=b$i[2*b$X],b$V=b$i[2*b$X+1],b$K=this._points[0],b$k=this._points[1],(.01<Math.abs(b$K-b$f)||.01<Math.abs(b$k-b$V))&&this._points.push(b$f,b$V),b$o.__super.call(this,b$M,b$y,0,0,this._points.length/2,0,b$H,b$S)}b$d(b$o,"laya.webgl.shapes.LoopLine",b$iM);var b$y=b$o.prototype;return b$y.getData=function(b$M,b$y,b$i){if(0<this.borderWidth){for(var b$H=this.color,b$S=(b$H>>16&255)/255,b$f=(b$H>>8&255)/255,b$V=(255&b$H)/255,b$K=[],b$k=0,b$X=0,b$F=[],b$o=Math.floor(this._points.length/2),b$d=0;b$d<b$o;b$d++)b$k=this._points[2*b$d],b$X=this._points[2*b$d+1],b$K.push(this.x+b$k,this.y+b$X,b$S,b$f,b$V);this.createLoopLine(b$K,b$F,this.borderWidth,b$i+b$K.length/5),b$M.append(new Uint16Array(b$F)),b$y.append(new Float32Array(b$K))}},b$y.createLoopLine=function(b$M,b$y,b$i,b$H,b$S,b$f){b$M.length;var b$V=b$M.concat(),b$K=b$S||b$M,b$k=this.borderColor,b$X=(b$k>>16&255)/255,b$F=(b$k>>8&255)/255,b$o=(255&b$k)/255,b$d=[b$V[0],b$V[1]],b$P=[b$V[b$V.length-5],b$V[b$V.length-4]],b$l=b$P[0]+.5*(b$d[0]-b$P[0]),b$J=b$P[1]+.5*(b$d[1]-b$P[1]);b$V.unshift(b$l,b$J,0,0,0),b$V.push(b$l,b$J,0,0,0);var b$h,b$C,b$v,b$R,b$A,b$G,b$I,b$U,b$Q,b$W,b$c,b$n,b$a,b$T,b$m,b$e,b$s,b$D,b$z,b$w,b$q=b$V.length/5,b$t=b$H,b$u=b$i/2;b$v=b$V[0],b$R=b$V[1],b$W=b$v-(b$A=b$V[5]),b$Q=(b$Q=-(b$R-(b$G=b$V[6])))/(b$w=Math.sqrt(b$Q*b$Q+b$W*b$W))*b$u,b$W=b$W/b$w*b$u,b$K.push(b$v-b$Q,b$R-b$W,b$X,b$F,b$o,b$v+b$Q,b$R+b$W,b$X,b$F,b$o);for(var b$p=1;b$p<b$q-1;b$p++)b$v=b$V[5*(b$p-1)],b$R=b$V[5*(b$p-1)+1],b$A=b$V[5*b$p],b$G=b$V[5*b$p+1],b$I=b$V[5*(b$p+1)],b$U=b$V[5*(b$p+1)+1],b$W=b$v-b$A,b$n=b$A-b$I,b$m=(-(b$Q=(b$Q=-(b$R-b$G))/(b$w=Math.sqrt(b$Q*b$Q+b$W*b$W))*b$u)+b$v)*(-(b$W=b$W/b$w*b$u)+b$G)-(-b$Q+b$A)*(-b$W+b$R),b$D=(-(b$c=(b$c=-(b$G-b$U))/(b$w=Math.sqrt(b$c*b$c+b$n*b$n))*b$u)+b$I)*(-(b$n=b$n/b$w*b$u)+b$G)-(-b$c+b$A)*(-b$n+b$U),b$z=(b$a=-b$W+b$R-(-b$W+b$G))*(b$s=-b$c+b$A-(-b$c+b$I))-(b$e=-b$n+b$U-(-b$n+b$G))*(b$T=-b$Q+b$A-(-b$Q+b$v)),Math.abs(b$z)<.1?(b$z+=10.1,b$K.push(b$A-b$Q,b$G-b$W,b$X,b$F,b$o,b$A+b$Q,b$G+b$W,b$X,b$F,b$o)):(((b$h=(b$T*b$D-b$s*b$m)/b$z)-b$A)*(b$h-b$A)+((b$C=(b$e*b$m-b$a*b$D)/b$z)-b$G)+(b$C-b$G),b$K.push(b$h,b$C,b$X,b$F,b$o,b$A-(b$h-b$A),b$G-(b$C-b$G),b$X,b$F,b$o));b$f&&(b$y=b$f);var b$B=this.edges+1;for(b$p=1;b$p<b$B;b$p++)b$y.push(b$t+2*(b$p-1),b$t+2*(b$p-1)+1,b$t+2*b$p+1,b$t+2*b$p+1,b$t+2*b$p,b$t+2*(b$p-1));return b$y.push(b$t+2*(b$p-1),b$t+2*(b$p-1)+1,b$t+1,b$t+1,b$t,b$t+2*(b$p-1)),b$K},b$o}(),b$eM=function(b$M){function b$V(b$M,b$y,b$i,b$H,b$S,b$f){this._points=null,this._start=-1,this._repaint=!1,this.earcutTriangles=null,this._mat=b$W.create(),this._points=b$i.slice(0,b$i.length),b$V.__super.call(this,b$M,b$y,0,0,this._points.length/2,b$H,b$S,b$f)}b$d(b$V,"laya.webgl.shapes.Polygon",b$iM);var b$y=b$V.prototype;return b$y.rebuild=function(b$M){this._repaint||(this._points.length=0,this._points=this._points.concat(b$M))},b$y.setMatrix=function(b$M){b$M.copyTo(this._mat)},b$y.needUpdate=function(b$M){return this._repaint=this._mat.a==b$M.a&&this._mat.b==b$M.b&&this._mat.c==b$M.c&&this._mat.d==b$M.d&&this._mat.tx==b$M.tx&&this._mat.ty==b$M.ty,!this._repaint},b$y.getData=function(b$M,b$y,b$i){var b$H,b$S=0,b$f=this._points,b$V=0;if(this.mUint16Array&&this.mFloat32Array&&this._repaint){if(this._start!=b$i){for(this._start=b$i,b$H=[],b$V=this.earcutTriangles.length,b$S=0;b$S<b$V;b$S++)b$H.push(this.earcutTriangles[b$S]+b$i);this.mUint16Array=new Uint16Array(b$H)}}else{this._start=b$i,b$H=[];var b$K=[],b$k=[],b$X=this.color,b$F=(b$X>>16&255)/255,b$o=(b$X>>8&255)/255,b$d=(255&b$X)/255;for(b$V=Math.floor(b$f.length/2),b$S=0;b$S<b$V;b$S++)b$K.push(this.x+b$f[2*b$S],this.y+b$f[2*b$S+1],b$F,b$o,b$d),b$k.push(this.x+b$f[2*b$S],this.y+b$f[2*b$S+1]);for(this.earcutTriangles=b$HM.earcut(b$k,null,2),b$V=this.earcutTriangles.length,b$S=0;b$S<b$V;b$S++)b$H.push(this.earcutTriangles[b$S]+b$i);this.mUint16Array=new Uint16Array(b$H),this.mFloat32Array=new Float32Array(b$K)}b$M.append(this.mUint16Array),b$y.append(this.mFloat32Array)},b$V}(),b$sM=function(b$M){function b$f(){this._matrix=new b$W,this._matrix4=b$JM.defaultMatrix4.concat(),b$f.__super.call(this,1e4),this.shaderValue=new b$QM(0,0)}b$d(b$f,"laya.webgl.submit.SubmitCanvas",b$fM);var b$y=b$f.prototype;return b$y.renderSubmit=function(){if(this._ctx_src._targets)return this._ctx_src._targets.flush(this._ctx_src),1;var b$M=b$vM.worldAlpha,b$y=b$vM.worldMatrix4,b$i=b$vM.worldMatrix,b$H=b$vM.worldFilters,b$S=b$vM.worldShaderDefines,b$f=this.shaderValue,b$V=this._matrix,b$K=this._matrix4,b$k=b$W.TEMP;return b$W.mul(b$V,b$i,b$k),b$K[0]=b$k.a,b$K[1]=b$k.b,b$K[4]=b$k.c,b$K[5]=b$k.d,b$K[12]=b$k.tx,b$K[13]=b$k.ty,b$vM.worldMatrix=b$k.clone(),b$vM.worldMatrix4=b$K,b$vM.worldAlpha=b$vM.worldAlpha*b$f.alpha,b$f.filters&&b$f.filters.length&&(b$vM.worldFilters=b$f.filters,b$vM.worldShaderDefines=b$f.defines),this._ctx_src.flush(),b$vM.worldAlpha=b$M,b$vM.worldMatrix4=b$y,b$vM.worldMatrix.destroy(),b$vM.worldMatrix=b$i,b$vM.worldFilters=b$H,b$vM.worldShaderDefines=b$S,1},b$y.releaseRender=function(){var b$M=b$f._cache;this._ctx_src=null,b$M[b$M._length++]=this},b$y.getRenderType=function(){return 10003},b$f.create=function(b$M,b$y,b$i){var b$H=b$f._cache._length?b$f._cache[--b$f._cache._length]:new b$f;b$H._ctx_src=b$M;var b$S=b$H.shaderValue;return b$S.alpha=b$y,b$S.defines.setValue(0),b$i&&b$i.length&&b$S.setFilters(b$i),b$H},b$f._cache=((b$f._cache=[])._length=0,b$f._cache),b$f}(),b$DM=function(b$M){function b$X(b$M){this._preIsSameTextureShader=!1,this._isSameTexture=!0,this._texs=new Array,this._texsID=new Array,this._vbPos=new Array,void 0===b$M&&(b$M=1e4),b$X.__super.call(this,b$M)}b$d(b$X,"laya.webgl.submit.SubmitTexture",b$fM);var b$y=b$X.prototype;return b$y.releaseRender=function(){var b$M=b$X._cache;(b$M[b$M._length++]=this).shaderValue.release(),this.shaderValue=null,this._preIsSameTextureShader=!1,this._blendFn=null,this._vb=null,this._ib=null,this._texs.length=0,this._vbPos.length=0,this._texsID.length=0,this._isSameTexture=!0},b$y.addTexture=function(b$M,b$y){this._texsID[this._texs.length]=b$M._uvID,this._texs.push(b$M),this._vbPos.push(b$y)},b$y.checkTexture=function(){if(this._texs.length<1)this._isSameTexture=!0;else{var b$M=this.shaderValue.textureHost.bitmap;if(null!==b$M)for(var b$y=this._vb.getFloat32Array(),b$i=0,b$H=this._texs.length;b$i<b$H;b$i++){var b$S=this._texs[b$i];b$S.active();var b$f=b$S.uv;if(this._texsID[b$i]!==b$S._uvID){this._texsID[b$i]=b$S._uvID;var b$V=this._vbPos[b$i];b$y[b$V+2]=b$f[0],b$y[b$V+3]=b$f[1],b$y[b$V+6]=b$f[2],b$y[b$V+7]=b$f[3],b$y[b$V+10]=b$f[4],b$y[b$V+11]=b$f[5],b$y[b$V+14]=b$f[6],b$y[b$V+15]=b$f[7],this._vb.setNeedUpload()}b$S.bitmap!==b$M&&(this._isSameTexture=!1)}}},b$y.renderSubmit=function(){if(0===this._numEle)return b$X._shaderSet=!1,1;var b$M=this.shaderValue.textureHost;if(b$M){var b$y=b$M.source;if(!b$M.bitmap||!b$y)return b$X._shaderSet=!1,1;this.shaderValue.texture=b$y,b$M.alphaTexture&&b$M.alphaTexture.source&&(this.shaderValue.texture1=b$M.alphaTexture.source)}this._vb.bind_upload(this._ib);var b$i=b$AM.mainContext;if(b$E.activeBlendFunction!==this._blendFn&&(b$i.enable(3042),this._blendFn(b$i),b$E.activeBlendFunction=this._blendFn),b$m.drawCall++,b$m.trianglesFaces+=this._numEle/3,this._preIsSameTextureShader&&b$wM.activeShader&&b$X._shaderSet?(b$wM.activeShader.uploadTexture2D(this.shaderValue.texture),this.shaderValue.texture1&&b$wM.activeShader.uploadTexture2D1(this.shaderValue.texture1)):this.shaderValue.upload(),b$X._shaderSet=!0,1<this._texs.length&&!this._isSameTexture)for(var b$H=b$M.bitmap,b$S=0,b$f=b$wM.activeShader,b$V=0,b$K=this._texs.length;b$V<b$K;b$V++){var b$k=this._texs[b$V];b$k.bitmap===b$H&&b$V+1!==b$K||(b$f.uploadTexture2D(b$k.source),b$i.drawElements(4,6*(b$V-b$S+1),5123,this._startIdx+6*b$S*b$JM.BYTES_PIDX),b$H=b$k.bitmap,b$S=b$V)}else b$i.drawElements(4,this._numEle,5123,this._startIdx);return 1},b$X.create=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$X._cache._length?b$X._cache[--b$X._cache._length]:new b$X;null==b$i&&((b$i=b$f._selfVb||(b$f._selfVb=b$LM.create(-1))).clear(),b$H=0),b$f._ib=b$y,b$f._vb=b$i,b$f._startIdx=b$H*b$JM.BYTES_PIDX,b$f._numEle=0;var b$V=b$M._nBlendType;b$f._blendFn=b$M._targets?b$E.targetFns[b$V]:b$E.fns[b$V],b$f.shaderValue=b$S,b$f.shaderValue.setValue(b$M._shader2D);var b$K=b$M._shader2D.filters;return b$K&&b$f.shaderValue.setFilters(b$K),b$f},b$X._cache=((b$X._cache=[])._length=0,b$X._cache),b$X._shaderSet=!0,b$X}(),b$zM=function(b$M){function b$C(){b$C.__super.call(this,laya.webgl.utils.MeshTexture.const_stride,0,0),this.canReuse=!0,this.setAttributes(laya.webgl.utils.MeshTexture._fixattriInfo)}b$d(b$C,"laya.webgl.utils.MeshTexture",b$CM);var b$y=b$C.prototype;return b$y.addData=function(b$M,b$y,b$i,b$H,b$S,b$f){for(var b$V=b$M.length/2,b$K=this._vb.needSize(b$V*b$C.const_stride)>>2,b$k=this._vb.getFloat32Array(),b$X=0,b$F=0;b$F<b$V;b$F++){var b$o=b$M[b$X],b$d=b$M[b$X+1],b$P=b$o*b$H.a+b$d*b$H.c+b$H.tx,b$l=b$o*b$H.b+b$d*b$H.d+b$H.ty;b$k[b$K++]=b$P,b$k[b$K++]=b$l,b$k[b$K++]=b$y[b$X],b$k[b$K++]=b$y[b$X+1],b$X+=2}this._vb.setNeedUpload();var b$J=this.vertNum;if(0<b$J){(b$V=b$i.length)>b$C.tmpIdx.length&&(b$C.tmpIdx=new Uint16Array(b$V));for(var b$h=0;b$h<b$V;b$h++)b$C.tmpIdx[b$h]=b$i[b$h]+b$J;this._ib.appendU16Array(b$C.tmpIdx,b$i.length)}else this._ib.append(b$i);this._ib.setNeedUpload(),this.vertNum+=b$V,this.indexNum+=b$i.length},b$y.releaseMesh=function(){this._vb._byteLength=0,this._ib._byteLength=0,this.vertNum=0,this.indexNum=0,laya.webgl.utils.MeshTexture._POOL.push(this)},b$y.destroy=function(){this._ib.destroy(),this._vb.destroy()},b$C.getAMesh=function(){return laya.webgl.utils.MeshTexture._POOL.length?laya.webgl.utils.MeshTexture._POOL.pop():new b$C},b$C.const_stride=16,b$C._POOL=[],b$V(b$C,["_fixattriInfo",function(){return this._fixattriInfo=[5126,2,0,5126,2,8]},"tmpIdx",function(){return this.tmpIdx=new Uint16Array(4)}]),b$C}(),b$wM=function(b$M){function b$y(){b$y.__super.call(this),this.lock=!0}return b$d(b$y,"laya.webgl.shader.BaseShader",b$R),b$y.activeShader=null,b$y.bindShader=null,b$y}(),b$qM=function(b$y){function b$F(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){this._type=0,this._svWidth=NaN,this._svHeight=NaN,this._preRenderTarget=null,this._alreadyResolved=!1,this._looked=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._mipMap=!1,this._repeat=!1,this._minFifter=0,this._magFifter=0,this._destroy=!1,void 0===b$i&&(b$i=6408),void 0===b$H&&(b$H=5121),void 0===b$S&&(b$S=34041),void 0===b$f&&(b$f=!1),void 0===b$V&&(b$V=!1),void 0===b$K&&(b$K=-1),void 0===b$k&&(b$k=-1),this._type=1,this._w=b$M,this._h=b$y,this._surfaceFormat=b$i,this._surfaceType=b$H,this._depthStencilFormat=b$S,b$C.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipMap=b$f,this._repeat=b$V,this._minFifter=b$K,this._magFifter=b$k,this._createWebGLRenderTarget(),this.bitmap.lock=!0,b$F.__super.call(this,this.bitmap,b$z.INV_UV)}b$d(b$F,"laya.webgl.resource.RenderTarget2D",b$y);var b$M=b$F.prototype;return b$I.imps(b$M,{"laya.resource.IDispose":!0}),b$M.getType=function(){return this._type},b$M.getTexture=function(){return this},b$M.size=function(b$M,b$y){this._w==b$M&&this._h==b$y||(this._w=b$M,this._h=b$y,this.release(),0!=this._w&&0!=this._h&&this._createWebGLRenderTarget())},b$M.release=function(){this.destroy()},b$M.recycle=function(){b$F.POOL.push(this)},b$M.start=function(){var b$M=b$AM.mainContext;return this._preRenderTarget=b$vM.curRenderTarget,b$vM.curRenderTarget=this,b$M.bindFramebuffer(36160,this.bitmap.frameBuffer),this._alreadyResolved=!1,1==this._type&&(b$M.viewport(0,0,this._w,this._h),this._svWidth=b$vM.width,this._svHeight=b$vM.height,b$vM.width=this._w,b$vM.height=this._h,b$wM.activeShader=null),this},b$M.clear=function(b$M,b$y,b$i,b$H){void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=1);var b$S=b$AM.mainContext;b$S.clearColor(b$M,b$y,b$i,b$H);var b$f=16384;switch(this._depthStencilFormat){case 33189:b$f|=256;break;case 36168:b$f|=1024;break;case 34041:b$f|=256,b$f|=1024}b$S.clear(b$f)},b$M.end=function(){var b$M=b$AM.mainContext;b$M.bindFramebuffer(36160,this._preRenderTarget?this._preRenderTarget.bitmap.frameBuffer:null),this._alreadyResolved=!0,b$vM.curRenderTarget=this._preRenderTarget,1==this._type?(b$M.viewport(0,0,this._svWidth,this._svHeight),b$vM.width=this._svWidth,b$vM.height=this._svHeight,b$wM.activeShader=null):b$M.viewport(0,0,b$I.stage.width,b$I.stage.height)},b$M.getData=function(b$M,b$y,b$i,b$H){var b$S=b$AM.mainContext;if(b$S.bindFramebuffer(36160,this.bitmap.frameBuffer),!(36053===b$S.checkFramebufferStatus(36160)))return b$S.bindFramebuffer(36160,null),null;var b$f=new Uint8Array(this._w*this._h*4);return b$S.readPixels(b$M,b$y,b$i,b$H,this._surfaceFormat,this._surfaceType,b$f),b$S.bindFramebuffer(36160,null),b$f},b$M.destroy=function(b$M){void 0===b$M&&(b$M=!1),this._destroy||(this._loaded=!1,this.bitmap.offAll(),this.bitmap.disposeResource(),this.bitmap.dispose(),this.offAll(),this.bitmap=null,this._alreadyResolved=!1,this._destroy=!0,b$y.prototype.destroy.call(this))},b$M.dispose=function(){},b$M._createWebGLRenderTarget=function(){this.bitmap=new b$rM(this.width,this.height,this._surfaceFormat,this._surfaceType,this._depthStencilFormat,this._mipMap,this._repeat,this._minFifter,this._magFifter),this.bitmap.activeResource(),this._alreadyResolved=!0,this._destroy=!1,this._loaded=!0,this.bitmap.on("recovered",this,function(b$M){this.event("recovered")})},b$H(0,b$M,"surfaceFormat",function(){return this._surfaceFormat}),b$H(0,b$M,"magFifter",function(){return this._magFifter}),b$H(0,b$M,"surfaceType",function(){return this._surfaceType}),b$H(0,b$M,"mipMap",function(){return this._mipMap}),b$H(0,b$M,"depthStencilFormat",function(){return this._depthStencilFormat}),b$H(0,b$M,"minFifter",function(){return this._minFifter}),b$H(0,b$M,"source",function(){return this._alreadyResolved?b$I.superGet(b$z,this,"source"):null}),b$F.create=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){void 0===b$i&&(b$i=6408),void 0===b$H&&(b$H=5121),void 0===b$S&&(b$S=34041),void 0===b$f&&(b$f=!1),void 0===b$V&&(b$V=!1),void 0===b$K&&(b$K=-1),void 0===b$k&&(b$k=-1);var b$X=b$F.POOL.pop();return b$X||(b$X=new b$F(b$M,b$y)),b$X.bitmap&&b$X._w==b$M&&b$X._h==b$y&&b$X._surfaceFormat==b$i&&b$X._surfaceType==b$H&&b$X._depthStencilFormat==b$S&&b$X._mipMap==b$f&&b$X._repeat==b$V&&b$X._minFifter==b$K&&b$X._magFifter==b$k||(b$X._w=b$M,b$X._h=b$y,b$X._surfaceFormat=b$i,b$X._surfaceType=b$H,b$X._depthStencilFormat=b$S,b$C.isConchWebGL&&34041===b$X._depthStencilFormat&&(b$X._depthStencilFormat=33189),b$X._mipMap=b$f,b$X._repeat=b$V,b$X._minFifter=b$K,b$X._magFifter=b$k,b$X.release(),b$X._createWebGLRenderTarget()),b$X},b$F.TYPE2D=1,b$F.TYPE3D=2,b$F.POOL=[],b$F}(b$z),b$tM=function(b$M){function b$y(){this._glBuffer=null,this._buffer=null,this._bufferType=0,this._bufferUsage=0,this._byteLength=0,b$y.__super.call(this),b$y._gl=b$AM.mainContext}b$d(b$y,"laya.webgl.utils.Buffer",b$R);var b$i=b$y.prototype;return b$i._bind=function(){this.activeResource(),b$y._bindActive[this._bufferType]!==this._glBuffer&&(34962===this._bufferType&&(b$y._bindVertexBuffer=this._glBuffer),b$y._gl.bindBuffer(this._bufferType,b$y._bindActive[this._bufferType]=this._glBuffer),b$wM.activeShader=null)},b$i.recreateResource=function(){this._glBuffer||(this._glBuffer=b$y._gl.createBuffer()),this.completeCreate()},b$i.disposeResource=function(){this._glBuffer&&(b$AM.mainContext.deleteBuffer(this._glBuffer),this._glBuffer=null),this.memorySize=0},b$H(0,b$i,"bufferUsage",function(){return this._bufferUsage}),b$y._gl=null,b$y._bindActive={},b$y._bindVertexBuffer=null,b$y._enableAtributes=[],b$y}(),b$uM=function(b$M){function b$i(b$M){this.texcoord=null,this.offsetX=300,this.offsetY=0,b$i.__super.call(this,512,0);var b$y=8*b$JM.BYTES_PE;this.position=[2,5126,!1,b$y,0],this.texcoord=[2,5126,!1,b$y,2*b$JM.BYTES_PE],this.color=[4,5126,!1,b$y,4*b$JM.BYTES_PE]}return b$d(b$i,"laya.webgl.shader.d2.skinAnishader.SkinSV",b$QM),b$i}(),b$pM=function(b$M){function b$y(b$M){b$y.__super.call(this,2,0),this.color=[]}return b$d(b$y,"laya.webgl.shader.d2.value.Color2dSV",b$QM),b$y.prototype.setValue=function(b$M){b$M.fillStyle&&(this.color=b$M.fillStyle._color._color),b$M.strokeStyle&&(this.color=b$M.strokeStyle._color._color)},b$y}(),b$BM=function(b$M){function b$y(b$M){this.u_colorMatrix=null,this.strength=0,this.colorMat=null,this.colorAlpha=null,this.u_TexRange=[0,1,0,1],this.u_offset=[0,0],this.texcoord=b$QM._TEXCOORD,b$y.__super.call(this,256,0)}b$d(b$y,"laya.webgl.shader.d2.value.FillTextureSV",b$QM);var b$i=b$y.prototype;return b$i.setValue=function(b$M){this.ALPHA=b$M.ALPHA,b$M.filters&&this.setFilters(b$M.filters)},b$i.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},b$y}(),b$ZM=function(b$M){function b$y(b$M){this.u_colorMatrix=null,this.strength=0,this.blurInfo=null,this.colorMat=null,this.colorAlpha=null,this.texcoord=b$QM._TEXCOORD,void 0===b$M&&(b$M=0),b$y.__super.call(this,1,b$M)}b$d(b$y,"laya.webgl.shader.d2.value.TextureSV",b$QM);var b$i=b$y.prototype;return b$i.setValue=function(b$M){this.ALPHA=b$M.ALPHA,b$M.filters&&this.setFilters(b$M.filters)},b$i.clear=function(){this.texture=null,this.texture1=null,this.shader=null,this.colorMat=null,this.colorAlpha=null,this.defines.setValue(0)},b$y}(),b$EM=function(b$M){function b$y(b$M){this.a_color=null,this.u_pos=[0,0],b$y.__super.call(this,4,0),this.position=[2,5126,!1,5*b$JM.BYTES_PE,0],this.a_color=[3,5126,!1,5*b$JM.BYTES_PE,2*b$JM.BYTES_PE]}return b$d(b$y,"laya.webgl.shader.d2.value.PrimitiveSV",b$QM),b$y}(),b$_M=function(b$M){function b$y(){this._atlaser=null,this._flashCacheImage=null,this._flashCacheImageNeedFlush=!1,b$y.__super.call(this)}b$d(b$y,"laya.webgl.atlas.AtlasWebGLCanvas",b$M);var b$i=b$y.prototype;return b$i.recreateResource=function(){var b$M=b$AM.mainContext,b$y=this._source=b$M.createTexture(),b$i=b$GM.curBindTexTarget,b$H=b$GM.curBindTexValue;b$GM.bindTexture(b$M,3553,b$y),b$M.texImage2D(3553,0,6408,this._w,this._h,0,6408,5121,null),b$M.texParameteri(3553,10241,9729),b$M.texParameteri(3553,10240,9729),b$M.texParameteri(3553,10242,33071),b$M.texParameteri(3553,10243,33071),b$i&&b$H&&b$GM.bindTexture(b$M,b$i,b$H),this.memorySize=this._w*this._h*4,this.completeCreate()},b$i.disposeResource=function(){this._source&&(b$AM.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},b$i.texSubImage2D=function(b$M,b$y,b$i){if(b$C.isFlash){this._flashCacheImage||(this._flashCacheImage=b$J.create(""),this._flashCacheImage._image.createCanvas(this._w,this._h));var b$H=b$i.bitmapdata;this._flashCacheImage._image.copyPixels(b$H,0,0,b$H.width,b$H.height,b$M,b$y),this._flashCacheImageNeedFlush||(this._flashCacheImageNeedFlush=!0)}else{var b$S=b$AM.mainContext,b$f=b$GM.curBindTexTarget,b$V=b$GM.curBindTexValue;b$GM.bindTexture(b$S,3553,this._source),b$S.pixelStorei(37441,!0),0<=b$M-1&&b$S.texSubImage2D(3553,0,b$M-1,b$y,6408,5121,b$i),b$M+1<=this._w&&b$S.texSubImage2D(3553,0,b$M+1,b$y,6408,5121,b$i),0<=b$y-1&&b$S.texSubImage2D(3553,0,b$M,b$y-1,6408,5121,b$i),b$y+1<=this._h&&b$S.texSubImage2D(3553,0,b$M,b$y+1,6408,5121,b$i),b$S.texSubImage2D(3553,0,b$M,b$y,6408,5121,b$i),b$S.pixelStorei(37441,!1),b$f&&b$V&&b$GM.bindTexture(b$S,b$f,b$V)}},b$i.texSubImage2DPixel=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$AM.mainContext,b$V=b$GM.curBindTexTarget,b$K=b$GM.curBindTexValue;b$GM.bindTexture(b$f,3553,this._source);var b$k=new Uint8Array(b$S.data);b$f.pixelStorei(37441,!0),b$f.texSubImage2D(3553,0,b$M,b$y,b$i,b$H,6408,5121,b$k),b$f.pixelStorei(37441,!1),b$V&&b$K&&b$GM.bindTexture(b$f,b$V,b$K)},b$H(0,b$i,"width",b$M.prototype._$get_width,function(b$M){this._w=b$M}),b$H(0,b$i,"height",b$M.prototype._$get_height,function(b$M){this._h=b$M}),b$y}(b$i),b$bM=function(b$M){function b$S(){this.flipY=!0,this.alwaysChange=!1,b$S.__super.call(this)}b$d(b$S,"laya.webgl.resource.WebGLCanvas",b$i);var b$y=b$S.prototype;return b$y.getCanvas=function(){return this._canvas},b$y.clear=function(){this._ctx&&this._ctx.clear()},b$y.destroy=function(){this._ctx&&this._ctx.destroy(),this._ctx=null,laya.resource.Resource.prototype.destroy.call(this)},b$y._setContext=function(b$M){this._ctx=b$M},b$y.getContext=function(b$M,b$y){return this._ctx?this._ctx:this._ctx=b$S._createContext(this)},b$y.size=function(b$M,b$y){this._w==b$M&&this._h==b$y||(this._w=b$M,this._h=b$y,this._ctx&&this._ctx.size(b$M,b$y),this._canvas&&(this._canvas.height=b$y,this._canvas.width=b$M))},b$y.activeResource=function(b$M){void 0===b$M&&(b$M=!1),this._source||this.recreateResource()},b$y.recreateResource=function(){this.createWebGlTexture(),this.completeCreate()},b$y.disposeResource=function(){this._source&&!this.iscpuSource&&(b$AM.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},b$y.createWebGlTexture=function(){var b$M=b$AM.mainContext;this._canvas;var b$y=this._source=b$M.createTexture();this.iscpuSource=!1;var b$i=b$GM.curBindTexTarget,b$H=b$GM.curBindTexValue;b$GM.bindTexture(b$M,3553,b$y),b$M.pixelStorei(37440,this.flipY?1:0),b$S.premulAlpha&&b$M.pixelStorei(37441,!0),b$M.texImage2D(3553,0,6408,6408,5121,this._imgData),b$S.premulAlpha&&b$M.pixelStorei(37441,!1),b$M.texParameteri(3553,10240,9729),b$M.texParameteri(3553,10241,9729),b$M.texParameteri(3553,10242,33071),b$M.texParameteri(3553,10243,33071),b$M.pixelStorei(37440,0),this.memorySize=this._w*this._h*4,b$i&&b$H&&b$GM.bindTexture(b$M,b$i,b$H)},b$y.reloadCanvasData=function(){var b$M=b$AM.mainContext;if(!this._source)throw"reloadCanvasData error, gl texture not created!";var b$y=b$GM.curBindTexTarget,b$i=b$GM.curBindTexValue;b$GM.bindTexture(b$M,3553,this._source),b$S.premulAlpha&&b$M.pixelStorei(37441,!0),b$M.texImage2D(3553,0,6408,6408,5121,this._imgData),b$S.premulAlpha&&b$M.pixelStorei(37441,!1),b$M.pixelStorei(37440,0),b$y&&b$i&&b$GM.bindTexture(b$M,b$y,b$i)},b$y.texSubImage2D=function(b$M,b$y,b$i){var b$H=b$AM.mainContext,b$S=b$GM.curBindTexTarget,b$f=b$GM.curBindTexValue;b$GM.bindTexture(b$H,3553,this._source),b$H.pixelStorei(37441,!0),b$H.texSubImage2D(3553,0,b$y,b$i,6408,5121,b$M._source),b$H.pixelStorei(37441,!1),b$S&&b$f&&b$GM.bindTexture(b$H,b$S,b$f)},b$y.toBase64=function(b$M,b$y,b$i){var b$H=null;this._canvas&&(b$H=this._canvas.toDataURL(b$M,b$y)),b$i.call(this,b$H)},b$H(0,b$y,"context",function(){return this._ctx}),b$H(0,b$y,"source",function(){return this.alwaysChange&&this.reloadCanvasData(),this._source}),b$H(0,b$y,"asBitmap",null,function(b$M){this._ctx&&(this._ctx.asBitmap=b$M)}),b$S._createContext=null,b$S.premulAlpha=!1,b$S}(),b$YM=function(b$M){function b$f(b$M,b$y){this.CborderSize=12,b$f.__super.call(this),this.char=b$M,this.isSpace=" "===b$M,this.xs=b$y.scaleX,this.ys=b$y.scaleY,this.font=b$y.font.toString(),this.fontSize=b$y.font.size,this.fillColor=b$y.fillColor,this.borderColor=b$y.borderColor,this.lineWidth=b$y.lineWidth,this.underLine=b$y.underLine;var b$i,b$H=b$C.isConchApp;b$H?((b$i=ConchTextCanvas)._source=ConchTextCanvas,b$i._source.canvas=ConchTextCanvas):b$i=b$P.canvas.source,this.canvas=b$i,this._enableMerageInAtlas=!0,this._ctx=b$H?b$i:this.canvas.getContext("2d",void 0);var b$S=b$w.measureText(this.char,this.font);this.cw=b$S.width*this.xs,this.ch=(b$S.height||this.fontSize)*this.ys,this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.texture=new b$z(this)}b$d(b$f,"laya.webgl.resource.WebGLCharImage",b$i);var b$y=b$f.prototype;return b$I.imps(b$y,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),b$y.active=function(){this.texture.active()},b$y.recreateResource=function(){var b$M=b$C.isConchApp;if(this.onresize(this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this.canvas&&(this.canvas.height=this._h,this.canvas.width=this._w),b$M){var b$y=this.fontSize;1==this.xs&&1==this.ys||(b$y=parseInt(b$y*(this.xs>this.ys?this.xs:this.ys)+""));var b$i="normal 100 "+this.font;b$i=b$i.replace(b$f._fontSizeReg,b$y),this.borderColor&&(b$i+=" 1 "+this.borderColor),this._ctx.font=b$i,this._ctx.textBaseline="top",this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,this.CborderSize,this.CborderSize,null,null,null)}else{if(this._ctx.save(),this._ctx.lineJoin="round",this._ctx.clearRect(0,0,this.cw+2*this.CborderSize,this.ch+2*this.CborderSize),this._ctx.font=this.font,b$D.RightToLeft&&(this._ctx.textAlign="end"),this._ctx.textBaseline="top",this._ctx.translate(this.CborderSize,this.CborderSize),1==this.xs&&1==this.ys||this._ctx.scale(this.xs,this.ys),this.fillColor&&this.borderColor?(this._ctx.strokeStyle=this.borderColor,this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null),this._ctx.fillStyle=this.fillColor,this._ctx.fillText(this.char,0,0,null,null,null)):-1===this.lineWidth?(this._ctx.fillStyle=this.fillColor?this.fillColor:"white",this._ctx.fillText(this.char,0,0,null,null,null)):(this._ctx.strokeStyle=this.borderColor?this.borderColor:"white",this._ctx.lineWidth=this.lineWidth,this._ctx.strokeText(this.char,0,0,null,null,0,null)),this.underLine){this._ctx.lineWidth=1,this._ctx.strokeStyle=this.fillColor,this._ctx.beginPath(),this._ctx.moveTo(0,this.fontSize+1);var b$H=this._ctx.measureText(this.char).width+1;this._ctx.lineTo(b$H,this.fontSize+1),this._ctx.stroke()}this._ctx.restore()}this.borderSize=this.CborderSize,this.completeCreate()},b$y.onresize=function(b$M,b$y){this._w=b$M,this._h=b$y,this._allowMerageInAtlas=!0},b$y.clearAtlasSource=function(){},b$H(0,b$y,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),b$H(0,b$y,"atlasSource",function(){return this.canvas}),b$H(0,b$y,"enableMerageInAtlas",function(){return this._enableMerageInAtlas},function(b$M){this._enableMerageInAtlas=b$M}),b$f.createOneChar=function(b$M,b$y){return new b$f(b$M,b$y)},b$f._fontSizeReg=new RegExp("\\d+(?=px)","g"),b$f}(),b$rM=function(b$M){function b$X(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){void 0===b$i&&(b$i=6408),void 0===b$H&&(b$H=5121),void 0===b$S&&(b$S=34041),void 0===b$f&&(b$f=!1),void 0===b$V&&(b$V=!1),void 0===b$K&&(b$K=-1),void 0===b$k&&(b$k=1),b$X.__super.call(this),this.uri="WebGLRenderTarget_"+this.id,this._w=b$M,this._h=b$y,this._surfaceFormat=b$i,this._surfaceType=b$H,this._depthStencilFormat=b$S,this._mipMap=b$f,this._repeat=b$V,this._minFifter=b$K,this._magFifter=b$k}b$d(b$X,"laya.webgl.resource.WebGLRenderTarget",b$i);var b$y=b$X.prototype;return b$y.recreateResource=function(){var b$M=b$AM.mainContext;this._frameBuffer||(this._frameBuffer=b$M.createFramebuffer()),this._source||(this._source=b$M.createTexture());var b$y=b$GM.curBindTexTarget,b$i=b$GM.curBindTexValue;b$GM.bindTexture(b$M,3553,this._source),b$M.texImage2D(3553,0,6408,this._w,this._h,0,this._surfaceFormat,this._surfaceType,null);var b$H=this._minFifter,b$S=this._magFifter,b$f=this._repeat?10497:33071,b$V=b$F.isPOT(this._w,this._h);if(b$V?(this._mipMap?-1!==b$H||(b$H=9987):-1!==b$H||(b$H=9729),-1!==b$S||(b$S=9729),b$M.texParameteri(3553,10241,b$H),b$M.texParameteri(3553,10240,b$S),b$M.texParameteri(3553,10242,b$f),b$M.texParameteri(3553,10243,b$f),this._mipMap&&b$M.generateMipmap(3553)):(-1!==b$H||(b$H=9729),-1!==b$S||(b$S=9729),b$M.texParameteri(3553,10241,b$H),b$M.texParameteri(3553,10240,b$S),b$M.texParameteri(3553,10242,33071),b$M.texParameteri(3553,10243,33071)),b$M.bindFramebuffer(36160,this._frameBuffer),b$M.framebufferTexture2D(36160,36064,3553,this._source,0),this._depthStencilFormat)switch(this._depthStencilBuffer||(this._depthStencilBuffer=b$M.createRenderbuffer()),b$M.bindRenderbuffer(36161,this._depthStencilBuffer),b$M.renderbufferStorage(36161,this._depthStencilFormat,this._w,this._h),this._depthStencilFormat){case 33189:b$M.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:b$M.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:b$M.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}b$M.bindFramebuffer(36160,null),b$y&&b$i&&b$GM.bindTexture(b$M,b$y,b$i),b$M.bindRenderbuffer(36161,null),b$V&&this._mipMap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this.completeCreate()},b$y.disposeResource=function(){this._frameBuffer&&(b$AM.mainContext.deleteTexture(this._source),b$AM.mainContext.deleteFramebuffer(this._frameBuffer),b$AM.mainContext.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0)},b$H(0,b$y,"depthStencilBuffer",function(){return this._depthStencilBuffer}),b$H(0,b$y,"frameBuffer",function(){return this._frameBuffer}),b$X}(),b$NM=function(b$M){function b$K(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this.offsetX=0,this.offsetY=0,b$K.__super.call(this),this.repeat=!0,this.mipmap=!1,this.minFifter=-1,this.magFifter=-1,this.atlasImage=b$f,this.canvas=b$M,this._ctx=b$M.getContext("2d",void 0),this._w=b$H,this._h=b$S,this.offsetX=b$y,this.offsetY=b$i,this.src=b$V,this._enableMerageInAtlas=!0,b$B.enabled&&this._w<b$B.atlasLimitWidth&&this._h<b$B.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}b$d(b$K,"laya.webgl.resource.WebGLSubImage",b$i);var b$y=b$K.prototype;return b$I.imps(b$y,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),b$y.size=function(b$M,b$y){this._w=b$M,this._h=b$y,this._ctx&&this._ctx.size(b$M,b$y),this.canvas&&(this.canvas.height=b$y,this.canvas.width=b$M)},b$y.recreateResource=function(){this.size(this._w,this._h),this._ctx.drawImage(this.atlasImage,this.offsetX,this.offsetY,this._w,this._h,0,0,this._w,this._h),this._allowMerageInAtlas&&this._enableMerageInAtlas?this.memorySize=0:this.createWebGlTexture(),this.completeCreate()},b$y.createWebGlTexture=function(){var b$M=b$AM.mainContext;if(!this.canvas)throw"create GLTextur err:no data:"+this.canvas;var b$y=this._source=b$M.createTexture(),b$i=b$GM.curBindTexTarget,b$H=b$GM.curBindTexValue;b$GM.bindTexture(b$M,3553,b$y),b$M.pixelStorei(37441,!0),b$M.texImage2D(3553,0,6408,6408,5121,this.canvas),b$M.pixelStorei(37441,!1);var b$S=this.minFifter,b$f=this.magFifter,b$V=this.repeat?10497:33071,b$K=b$F.isPOT(this.width,this.height);b$K?(this.mipmap?-1!==b$S||(b$S=9987):-1!==b$S||(b$S=9729),-1!==b$f||(b$f=9729),b$M.texParameteri(3553,10240,b$f),b$M.texParameteri(3553,10241,b$S),b$M.texParameteri(3553,10242,b$V),b$M.texParameteri(3553,10243,b$V),this.mipmap&&b$M.generateMipmap(3553)):(-1!==b$S||(b$S=9729),-1!==b$f||(b$f=9729),b$M.texParameteri(3553,10241,b$S),b$M.texParameteri(3553,10240,b$f),b$M.texParameteri(3553,10242,33071),b$M.texParameteri(3553,10243,33071)),b$i&&b$H&&b$GM.bindTexture(b$M,b$i,b$H),this.canvas=null,b$K&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4},b$y.disposeResource=function(){b$B.enabled&&this._allowMerageInAtlas||!this._source||(b$AM.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},b$y.clearAtlasSource=function(){},b$H(0,b$y,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),b$H(0,b$y,"atlasSource",function(){return this.canvas}),b$H(0,b$y,"enableMerageInAtlas",function(){return this._allowMerageInAtlas},function(b$M){this._allowMerageInAtlas=b$M}),b$K}(),b$$M=function(b$M){function b$X(b$M,b$y,b$i,b$H){if(this._curActTexIndex=0,this.tag={},this._program=null,this._params=null,this._paramsMap={},this._offset=0,b$X.__super.call(this),!b$M||!b$y)throw"Shader Error";this._id=++b$X._count,this._vs=b$M,this._ps=b$y,this._nameMap=b$H||{},null!=b$i&&(b$X.sharders[b$i]=this)}b$d(b$X,"laya.webgl.shader.Shader",b$wM);var b$y=b$X.prototype;return b$y.recreateResource=function(){this._compile(),this.completeCreate(),this.memorySize=0},b$y.disposeResource=function(){b$AM.mainContext.deleteShader(this._vshader),b$AM.mainContext.deleteShader(this._pshader),b$AM.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._params=null,this._paramsMap={},this.memorySize=0,this._curActTexIndex=0},b$y._compile=function(){if(!b$AM.mainContext.isContextLost()&&this._vs&&this._ps&&!this._params){this._reCompile=!0,this._params=[];var b$M=[this._vs,this._ps],b$y=b$AM.mainContext;if(this._program=b$y.createProgram(),this._vshader=b$X._createShader(b$y,b$M[0],35633),this._pshader=b$X._createShader(b$y,b$M[1],35632),b$y.attachShader(this._program,this._vshader),b$y.attachShader(this._program,this._pshader),b$y.linkProgram(this._program),!b$C.isConchApp&&!b$y.getProgramParameter(this._program,35714))throw b$y.getProgramInfoLog(this._program);var b$i,b$H,b$S=0,b$f=0;for(b$f=b$C.isConchApp?b$y.getProgramParameterEx(this._vs,this._ps,"",35721):b$y.getProgramParameter(this._program,35721),b$S=0;b$S<b$f;b$S++){var b$V=null;b$i={vartype:"attribute",glfun:null,ivartype:0,attrib:b$V=b$C.isConchApp?b$y.getActiveAttribEx(this._vs,this._ps,"",b$S):b$y.getActiveAttrib(this._program,b$S),location:b$y.getAttribLocation(this._program,b$V.name),name:b$V.name,type:b$V.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._params.push(b$i)}var b$K=0;for(b$K=b$C.isConchApp?b$y.getProgramParameterEx(this._vs,this._ps,"",35718):b$y.getProgramParameter(this._program,35718),b$S=0;b$S<b$K;b$S++){var b$k=null;b$k=b$C.isConchApp?b$y.getActiveUniformEx(this._vs,this._ps,"",b$S):b$y.getActiveUniform(this._program,b$S),0<(b$i={vartype:"uniform",glfun:null,ivartype:1,attrib:b$V,location:b$y.getUniformLocation(this._program,b$k.name),name:b$k.name,type:b$k.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(b$i.name=b$i.name.substr(0,b$i.name.length-3),b$i.isArray=!0,b$i.location=b$y.getUniformLocation(this._program,b$i.name)),this._params.push(b$i)}for(b$S=0,b$H=this._params.length;b$S<b$H;b$S++)if((b$i=this._params[b$S]).indexOfParams=b$S,b$i.index=1,b$i.value=[b$i.location,null],b$i.codename=b$i.name,b$i.name=this._nameMap[b$i.codename]?this._nameMap[b$i.codename]:b$i.codename,(this._paramsMap[b$i.name]=b$i)._this=this,b$i.uploadedValue=[],"attribute"!==b$i.vartype)switch(b$i.type){case 5124:b$i.fun=b$i.isArray?this._uniform1iv:this._uniform1i;break;case 5126:b$i.fun=b$i.isArray?this._uniform1fv:this._uniform1f;break;case 35664:b$i.fun=b$i.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:b$i.fun=b$i.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:b$i.fun=b$i.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:b$i.fun=this._uniform_sampler2D;break;case 35680:b$i.fun=this._uniform_samplerCube;break;case 35676:b$i.glfun=b$y.uniformMatrix4fv,b$i.fun=this._uniformMatrix4fv;break;case 35670:b$i.fun=this._uniform1i;break;case 35674:case 35675:default:throw new Error("compile shader err!")}else b$i.fun=this._attribute}},b$y.getUniform=function(b$M){return this._paramsMap[b$M]},b$y._attribute=function(b$M,b$y){var b$i=b$AM.mainContext,b$H=b$tM._enableAtributes,b$S=b$M.location;return b$H[b$S]||b$i.enableVertexAttribArray(b$S),b$i.vertexAttribPointer(b$S,b$y[0],b$y[1],b$y[2],b$y[3],b$y[4]+this._offset),b$H[b$S]=b$tM._bindVertexBuffer,1},b$y._uniform1f=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y?(b$AM.mainContext.uniform1f(b$M.location,b$i[0]=b$y),1):0},b$y._uniform1fv=function(b$M,b$y){if(b$y.length<4){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]||b$i[2]!==b$y[2]||b$i[3]!==b$y[3]?(b$AM.mainContext.uniform1fv(b$M.location,b$y),b$i[0]=b$y[0],b$i[1]=b$y[1],b$i[2]=b$y[2],b$i[3]=b$y[3],1):0}return b$AM.mainContext.uniform1fv(b$M.location,b$y),1},b$y._uniform_vec2=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]?(b$AM.mainContext.uniform2f(b$M.location,b$i[0]=b$y[0],b$i[1]=b$y[1]),1):0},b$y._uniform_vec2v=function(b$M,b$y){if(b$y.length<2){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]||b$i[2]!==b$y[2]||b$i[3]!==b$y[3]?(b$AM.mainContext.uniform2fv(b$M.location,b$y),b$i[0]=b$y[0],b$i[1]=b$y[1],b$i[2]=b$y[2],b$i[3]=b$y[3],1):0}return b$AM.mainContext.uniform2fv(b$M.location,b$y),1},b$y._uniform_vec3=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]||b$i[2]!==b$y[2]?(b$AM.mainContext.uniform3f(b$M.location,b$i[0]=b$y[0],b$i[1]=b$y[1],b$i[2]=b$y[2]),1):0},b$y._uniform_vec3v=function(b$M,b$y){return b$AM.mainContext.uniform3fv(b$M.location,b$y),1},b$y._uniform_vec4=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]||b$i[2]!==b$y[2]||b$i[3]!==b$y[3]?(b$AM.mainContext.uniform4f(b$M.location,b$i[0]=b$y[0],b$i[1]=b$y[1],b$i[2]=b$y[2],b$i[3]=b$y[3]),1):0},b$y._uniform_vec4v=function(b$M,b$y){return b$AM.mainContext.uniform4fv(b$M.location,b$y),1},b$y._uniformMatrix2fv=function(b$M,b$y){return b$AM.mainContext.uniformMatrix2fv(b$M.location,!1,b$y),1},b$y._uniformMatrix3fv=function(b$M,b$y){return b$AM.mainContext.uniformMatrix3fv(b$M.location,!1,b$y),1},b$y._uniformMatrix4fv=function(b$M,b$y){return b$AM.mainContext.uniformMatrix4fv(b$M.location,!1,b$y),1},b$y._uniform1i=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y?(b$AM.mainContext.uniform1i(b$M.location,b$i[0]=b$y),1):0},b$y._uniform1iv=function(b$M,b$y){return b$AM.mainContext.uniform1iv(b$M.location,b$y),1},b$y._uniform_ivec2=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]?(b$AM.mainContext.uniform2i(b$M.location,b$i[0]=b$y[0],b$i[1]=b$y[1]),1):0},b$y._uniform_ivec2v=function(b$M,b$y){return b$AM.mainContext.uniform2iv(b$M.location,b$y),1},b$y._uniform_vec3i=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]||b$i[2]!==b$y[2]?(b$AM.mainContext.uniform3i(b$M.location,b$i[0]=b$y[0],b$i[1]=b$y[1],b$i[2]=b$y[2]),1):0},b$y._uniform_vec3vi=function(b$M,b$y){return b$AM.mainContext.uniform3iv(b$M.location,b$y),1},b$y._uniform_vec4i=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]||b$i[2]!==b$y[2]||b$i[3]!==b$y[3]?(b$AM.mainContext.uniform4i(b$M.location,b$i[0]=b$y[0],b$i[1]=b$y[1],b$i[2]=b$y[2],b$i[3]=b$y[3]),1):0},b$y._uniform_vec4vi=function(b$M,b$y){return b$AM.mainContext.uniform4iv(b$M.location,b$y),1},b$y._uniform_sampler2D=function(b$M,b$y){var b$i=b$AM.mainContext,b$H=b$M.uploadedValue;return null==b$H[0]?(b$H[0]=this._curActTexIndex,b$i.uniform1i(b$M.location,this._curActTexIndex),b$i.activeTexture(b$X._TEXTURES[this._curActTexIndex]),b$GM.bindTexture(b$i,3553,b$y),this._curActTexIndex++,1):(b$i.activeTexture(b$X._TEXTURES[b$H[0]]),b$GM.bindTexture(b$i,3553,b$y),0)},b$y._uniform_samplerCube=function(b$M,b$y){var b$i=b$AM.mainContext,b$H=b$M.uploadedValue;return null==b$H[0]?(b$H[0]=this._curActTexIndex,b$i.uniform1i(b$M.location,this._curActTexIndex),b$i.activeTexture(b$X._TEXTURES[this._curActTexIndex]),b$GM.bindTexture(b$i,34067,b$y),this._curActTexIndex++,1):(b$i.activeTexture(b$X._TEXTURES[b$H[0]]),b$GM.bindTexture(b$i,34067,b$y),0)},b$y._noSetValue=function(b$M){console.log("no....:"+b$M.name)},b$y.uploadOne=function(b$M,b$y){this.activeResource(),b$GM.UseProgram(this._program);var b$i=this._paramsMap[b$M];b$i.fun.call(this,b$i,b$y)},b$y.uploadTexture2D=function(b$M){b$m.shaderCall++;var b$y=b$AM.mainContext;b$y.activeTexture(33984),b$GM.bindTexture(b$y,3553,b$M)},b$y.uploadTexture2D1=function(b$M){b$m.shaderCall++;var b$y=b$AM.mainContext;b$y.activeTexture(33985),b$GM.bindTexture(b$y,3553,b$M)},b$y.upload=function(b$M,b$y){b$wM.activeShader=b$wM.bindShader=this,this._lastUseFrameCount===b$m.loopCount||this.activeResource(),b$GM.UseProgram(this._program),this._reCompile?(b$y=this._params,this._reCompile=!1):b$y=b$y||this._params;b$AM.mainContext;for(var b$i,b$H,b$S=b$y.length,b$f=0,b$V=0;b$V<b$S;b$V++)null!==(b$H=b$M[(b$i=b$y[b$V]).name])&&(b$f+=b$i.fun.call(this,b$i,b$H));b$m.shaderCall+=b$f},b$y.uploadArray=function(b$M,b$y,b$i){b$wM.activeShader=this,(b$wM.bindShader=this).activeResource(),b$GM.UseProgram(this._program);this._params;for(var b$H,b$S,b$f=0,b$V=b$y-2;0<=b$V;b$V-=2)(b$S=this._paramsMap[b$M[b$V]])&&null!=(b$H=b$M[b$V+1])&&(b$i&&b$i[b$S.name]&&b$i[b$S.name].bind(),b$f+=b$S.fun.call(this,b$S,b$H));b$m.shaderCall+=b$f},b$y.getParams=function(){return this._params},b$X.getShader=function(b$M){return b$X.sharders[b$M]},b$X.create=function(b$M,b$y,b$i,b$H){return new b$X(b$M,b$y,b$i,b$H)},b$X.withCompile=function(b$M,b$y,b$i,b$H){if(b$i&&b$X.sharders[b$i])return b$X.sharders[b$i];var b$S=b$X._preCompileShader[2e-4*b$M];if(!b$S)throw new Error("withCompile shader err!"+b$M);return b$S.createShader(b$y,b$i,b$H)},b$X.withCompile2D=function(b$M,b$y,b$i,b$H,b$S){if(b$H&&b$X.sharders[b$H])return b$X.sharders[b$H];var b$f=b$X._preCompileShader[2e-4*b$M+b$y];if(!b$f)throw new Error("withCompile shader err!"+b$M+" "+b$y);return b$f.createShader(b$i,b$H,b$S)},b$X.addInclude=function(b$M,b$y){b$RM.addInclude(b$M,b$y)},b$X.preCompile=function(b$M,b$y,b$i,b$H){var b$S=2e-4*b$M;b$X._preCompileShader[b$S]=new b$RM(b$S,b$y,b$i,b$H)},b$X.preCompile2D=function(b$M,b$y,b$i,b$H,b$S){var b$f=2e-4*b$M+b$y;b$X._preCompileShader[b$f]=new b$RM(b$f,b$i,b$H,b$S)},b$X._createShader=function(b$M,b$y,b$i){var b$H=b$M.createShader(b$i);return b$M.shaderSource(b$H,b$y),b$M.compileShader(b$H),b$H},b$X._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,,33991,33992],b$X._count=0,b$X._preCompileShader={},b$X.SHADERNAME2ID=2e-4,b$X.sharders=((b$X.sharders=[]).length=32,b$X.sharders),b$V(b$X,["nameKey",function(){return this.nameKey=new b$e}]),b$X}(),b$xM=function(b$M){function b$y(){this._maxsize=0,this._upload=!0,this._uploadSize=0,b$y.__super.call(this),this.lock=!0,this.uri="Buffer2D_"+this.id}b$d(b$y,"laya.webgl.utils.Buffer2D",b$M);var b$i=b$y.prototype;return b$i.needSize=function(b$M){var b$y=this._byteLength;if(b$M){var b$i=this._byteLength+b$M;b$i<=this._buffer.byteLength||this._resizeBuffer(b$i<<1,!0),this._byteLength=b$i}return b$y},b$i._bufferData=function(){this._maxsize=Math.max(this._maxsize,this._byteLength),b$m.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,b$tM._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),b$tM._gl.bufferSubData(this._bufferType,0,this._buffer)},b$i._bufferSubData=function(b$M,b$y,b$i){if(void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),this._maxsize=Math.max(this._maxsize,this._byteLength),b$m.loopCount%30==0&&(this._buffer.byteLength>this._maxsize+64&&(this.memorySize=this._buffer.byteLength,this._buffer=this._buffer.slice(0,this._maxsize+64),this._checkArrayUse()),this._maxsize=this._byteLength),this._uploadSize<this._buffer.byteLength&&(this._uploadSize=this._buffer.byteLength,b$tM._gl.bufferData(this._bufferType,this._uploadSize,this._bufferUsage),this.memorySize=this._uploadSize),b$y||b$i){var b$H=this._buffer.slice(b$y,b$i);b$tM._gl.bufferSubData(this._bufferType,b$M,b$H)}else b$tM._gl.bufferSubData(this._bufferType,b$M,this._buffer)},b$i._checkArrayUse=function(){},b$i._bind_upload=function(){return!!this._upload&&(this._upload=!1,this._bind(),this._bufferData(),!0)},b$i._bind_subUpload=function(b$M,b$y,b$i){return void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),!!this._upload&&(this._upload=!1,this._bind(),this._bufferSubData(b$M,b$y,b$i),!0)},b$i._resizeBuffer=function(b$M,b$y){if(b$M<this._buffer.byteLength)return this;if(this.memorySize=b$M,b$y&&this._buffer&&0<this._buffer.byteLength){var b$i=new ArrayBuffer(b$M);new Uint8Array(b$i).set(new Uint8Array(this._buffer),0),this._buffer=b$i}else this._buffer=new ArrayBuffer(b$M);return this._checkArrayUse(),this._upload=!0,this},b$i.append=function(b$M){this._upload=!0;var b$y,b$i;b$y=b$M.byteLength,b$M instanceof Uint8Array?(this._resizeBuffer(this._byteLength+b$y,!0),b$i=new Uint8Array(this._buffer,this._byteLength)):b$M instanceof Uint16Array?(this._resizeBuffer(this._byteLength+b$y,!0),b$i=new Uint16Array(this._buffer,this._byteLength)):b$M instanceof Float32Array&&(this._resizeBuffer(this._byteLength+b$y,!0),b$i=new Float32Array(this._buffer,this._byteLength)),b$i.set(b$M,0),this._byteLength+=b$y,this._checkArrayUse()},b$i.appendU16Array=function(b$M,b$y){this._resizeBuffer(this._byteLength+2*b$y,!0);for(var b$i=new Uint16Array(this._buffer,this._byteLength,b$y),b$H=0;b$H<b$y;b$H++)b$i[b$H]=b$M[b$H];this._byteLength+=2*b$y,this._checkArrayUse()},b$i.appendEx=function(b$M,b$y){this._upload=!0;var b$i;b$i=b$M.byteLength,this._resizeBuffer(this._byteLength+b$i,!0),new b$y(this._buffer,this._byteLength).set(b$M,0),this._byteLength+=b$i,this._checkArrayUse()},b$i.appendEx2=function(b$M,b$y,b$i,b$H){void 0===b$H&&(b$H=1),this._upload=!0;var b$S,b$f;b$S=b$i*b$H,this._resizeBuffer(this._byteLength+b$S,!0),b$f=new b$y(this._buffer,this._byteLength);var b$V=0;for(b$V=0;b$V<b$i;b$V++)b$f[b$V]=b$M[b$V];this._byteLength+=b$S,this._checkArrayUse()},b$i.getBuffer=function(){return this._buffer},b$i.setNeedUpload=function(){this._upload=!0},b$i.getNeedUpload=function(){return this._upload},b$i.upload=function(){var b$M=this._bind_upload();return b$tM._gl.bindBuffer(this._bufferType,null),b$tM._bindActive[this._bufferType]=null,b$wM.activeShader=null,b$M},b$i.subUpload=function(b$M,b$y,b$i){void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0);var b$H=this._bind_subUpload();return b$tM._gl.bindBuffer(this._bufferType,null),b$tM._bindActive[this._bufferType]=null,b$wM.activeShader=null,b$H},b$i.disposeResource=function(){b$M.prototype.disposeResource.call(this),this._upload=!0,this._uploadSize=0},b$i.clear=function(){this._byteLength=0,this._upload=!0},b$H(0,b$i,"bufferLength",function(){return this._buffer.byteLength}),b$H(0,b$i,"byteLength",null,function(b$M){this._byteLength!==b$M&&(b$M<=this._buffer.byteLength||this._resizeBuffer(2*b$M+256,!0),this._byteLength=b$M)}),b$y.__int__=function(b$M){b$OM.QuadrangleIB=b$OM.create(35044),b$hM.fillIBQuadrangle(b$OM.QuadrangleIB,16)},b$y.FLOAT32=4,b$y.SHORT=2,b$y}(b$tM),b$gM=(function(b$y){function b$i(b$M){this.u_blurX=!1,this.u_color=null,this.u_offset=null,this.u_strength=NaN,this.u_texW=0,this.u_texH=0,b$i.__super.call(this,9)}b$d(b$i,"laya.webgl.shader.d2.value.GlowSV",b$y);var b$M=b$i.prototype;b$M.setValue=function(b$M){b$y.prototype.setValue.call(this,b$M)},b$M.clear=function(){b$y.prototype.clear.call(this)}}(b$ZM),function(b$M){function b$y(b$M){b$y.__super.call(this,64),this.defines.add(64)}b$d(b$y,"laya.webgl.shader.d2.value.TextSV",b$M);var b$i=b$y.prototype;return b$i.release=function(){(b$y.pool[b$y._length++]=this).clear()},b$i.clear=function(){b$M.prototype.clear.call(this)},b$y.create=function(){return b$y._length?b$y.pool[--b$y._length]:new b$y(null)},b$y.pool=[],b$y._length=0,b$y}(b$ZM)),b$jM=function(b$M){function b$S(b$M,b$y,b$i,b$H){this._params2dQuick1=null,this._params2dQuick2=null,this._shaderValueWidth=NaN,this._shaderValueHeight=NaN,b$S.__super.call(this,b$M,b$y,b$i,b$H)}b$d(b$S,"laya.webgl.shader.d2.Shader2X",b$M);var b$y=b$S.prototype;return b$y.upload2dQuick1=function(b$M){this.upload(b$M,this._params2dQuick1||this._make2dQuick1())},b$y._make2dQuick1=function(){if(!this._params2dQuick1){this.activeResource(),this._params2dQuick1=[];for(var b$M,b$y=this._params,b$i=0,b$H=b$y.length;b$i<b$H;b$i++)b$M=b$y[b$i],(b$C.isFlash||"size"!==b$M.name&&"position"!==b$M.name&&"texcoord"!==b$M.name)&&this._params2dQuick1.push(b$M)}return this._params2dQuick1},b$y.disposeResource=function(){b$M.prototype.disposeResource.call(this),this._params2dQuick1=null,this._params2dQuick2=null},b$y.upload2dQuick2=function(b$M){this.upload(b$M,this._params2dQuick2||this._make2dQuick2())},b$y._make2dQuick2=function(){if(!this._params2dQuick2){this.activeResource(),this._params2dQuick2=[];for(var b$M,b$y=this._params,b$i=0,b$H=b$y.length;b$i<b$H;b$i++)b$M=b$y[b$i],(b$C.isFlash||"size"!==b$M.name)&&this._params2dQuick2.push(b$M)}return this._params2dQuick2},b$S.create=function(b$M,b$y,b$i,b$H){return new b$S(b$M,b$y,b$i,b$H)},b$S}(b$$M),b$OM=function(b$M){function b$y(b$M){this._uint8Array=null,this._uint16Array=null,void 0===b$M&&(b$M=35044),b$y.__super.call(this),this._bufferUsage=b$M,this._bufferType=34963,b$C.isFlash||(this._buffer=new ArrayBuffer(8))}b$d(b$y,"laya.webgl.utils.IndexBuffer2D",b$xM);var b$i=b$y.prototype;return b$i._checkArrayUse=function(){this._uint8Array&&(this._uint8Array=new Uint8Array(this._buffer)),this._uint16Array&&(this._uint16Array=new Uint16Array(this._buffer))},b$i.getUint8Array=function(){return this._uint8Array||(this._uint8Array=new Uint8Array(this._buffer))},b$i.getUint16Array=function(){return this._uint16Array||(this._uint16Array=new Uint16Array(this._buffer))},b$i.destory=function(){this._uint16Array=null,this._uint8Array=null,this._buffer=null},b$y.QuadrangleIB=null,b$y.create=function(b$M){return void 0===b$M&&(b$M=35044),new b$y(b$M)},b$y}(),b$LM=function(b$M){function b$i(b$M,b$y){this._floatArray32=null,this._vertexStride=0,b$i.__super.call(this),this._vertexStride=b$M,this._bufferUsage=b$y,this._bufferType=34962,b$C.isFlash||(this._buffer=new ArrayBuffer(8)),this.getFloat32Array()}b$d(b$i,"laya.webgl.utils.VertexBuffer2D",b$M);var b$y=b$i.prototype;return b$y.getFloat32Array=function(){return this._floatArray32||(this._floatArray32=new Float32Array(this._buffer))},b$y.bind=function(b$M){b$M&&b$M._bind(),this._bind()},b$y.insertData=function(b$M,b$y){this.getFloat32Array().set(b$M,b$y),this._upload=!0},b$y.bind_upload=function(b$M){b$M._bind_upload()||b$M._bind(),this._bind_upload()||this._bind()},b$y._checkArrayUse=function(){this._floatArray32&&(this._floatArray32=new Float32Array(this._buffer))},b$y.disposeResource=function(){b$M.prototype.disposeResource.call(this)},b$y.destory=function(){this._byteLength=0,this._upload=!0,this._buffer=null,this._floatArray32=null},b$H(0,b$y,"vertexStride",function(){return this._vertexStride}),b$i.create=function(b$M,b$y){return void 0===b$y&&(b$y=35048),new b$i(b$M,b$y)},b$i}(b$xM),b$My=function(b$M){function b$K(b$M,b$y,b$i,b$H,b$S,b$f){if(this._format=0,this._mipmap=!1,this._allowMerageInAtlas=!1,this._enableMerageInAtlas=!1,this.repeat=!1,this._image=null,this.minFifter=0,void(this.magFifter=0)===b$i&&(b$i=6408),void 0===b$H&&(b$H=!0),b$K.__super.call(this,b$M,b$y),b$M){if(this._format=b$i,this._mipmap=b$H,this.repeat=!1,this.minFifter=-1,this.magFifter=-1,"string"==typeof b$M)this._url=b$M,this._src=b$M,this._image=new b$P.window.Image,b$y&&(b$y.onload&&(this.onload=b$y.onload),b$y.onerror&&(this.onerror=b$y.onerror),b$y.onCreate&&b$y.onCreate(this)),this._image.crossOrigin=b$M&&0==b$M.indexOf("data:")?null:"",b$M&&(this._image.src=b$M);else if(b$M instanceof ArrayBuffer){this._src=b$y,this._url=this._src;var b$V=new b$k(b$M);b$V.readUTFBytes(4),b$V.readUTFBytes(2),b$V.getInt16();b$V.endian="bigEndian",this._w=b$V.getInt16(),this._h=b$V.getInt16();b$V.getInt16(),b$V.getInt16();this._image=new Uint8Array(b$M,b$V.pos),this._format=b$AM.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL,b$B.enabled&&this._w<b$B.atlasLimitWidth&&this._h<b$B.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1}else{if(!(b$M instanceof Uint8Array))return this._src=b$y,this._url=this._src,this._image=b$M.source||b$M,this._$5__enableMerageInAtlas=!1,void this.onresize();this._src=b$y,this._url=this._src,this._w=b$S,this._h=b$f,this._image=b$M,this._format=0===b$i?b$M.byteLength/(b$S*b$f)==4?6408:6407:b$i}this._$5__enableMerageInAtlas=!0}}b$d(b$K,"laya.webgl.resource.WebGLImage",b$J);var b$y=b$K.prototype;return b$I.imps(b$y,{"laya.webgl.resource.IMergeAtlasBitmap":!0}),b$y._init_=function(b$M,b$y){},b$y._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var b$M=b$AM.mainContext,b$y=this._source=b$M.createTexture(),b$i=b$GM.curBindTexTarget,b$H=b$GM.curBindTexValue;b$GM.bindTexture(b$M,3553,b$y);var b$S=this.minFifter,b$f=this.magFifter,b$V=this.repeat?10497:33071,b$K=b$F.isPOT(this._w,this._h),b$k=!1;switch(b$K?(this.mipmap?-1!==b$S||(b$S=9987):-1!==b$S||(b$S=9729),-1!==b$f||(b$f=9729),b$M.texParameteri(3553,10241,b$S),b$M.texParameteri(3553,10240,b$f),b$M.texParameteri(3553,10242,b$V),b$M.texParameteri(3553,10243,b$V),this.mipmap&&b$M.generateMipmap(3553)):(-1!==b$S||(b$S=9729),-1!==b$f||(b$f=9729),b$M.texParameteri(3553,10241,b$S),b$M.texParameteri(3553,10240,b$f),b$M.texParameteri(3553,10242,33071),b$M.texParameteri(3553,10243,33071)),b$M.pixelStorei(37441,!0),this._format){case 6407:case 6408:this._image instanceof Uint8Array?(6407==this._format&&b$M.pixelStorei(b$M.UNPACK_ALIGNMENT,1),b$M.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image)):(6407==this._format&&b$M.pixelStorei(b$M.UNPACK_ALIGNMENT,1),b$M.texImage2D(3553,0,this._format,this._format,5121,this._image));break;case 6406:b$k=!0,b$M.texImage2D(3553,0,this._format,this._w,this._h,0,this._format,5121,this._image);break;case 35840:case 35841:case 35842:case 35843:case 33779:case 37815:case 37812:case 37821:case b$AM.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:b$k=!0,b$M.compressedTexImage2D(3553,0,this._format,this._w,this._h,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}b$M.pixelStorei(37441,!1),b$i&&b$H&&b$GM.bindTexture(b$M,b$i,b$H),this.uri||(this.uri=this._url),b$k?this.memorySize=this._image.length:b$K&&this.mipmap?this.memorySize=this._w*this._h*4*(1+1/3):this.memorySize=this._w*this._h*4,this._image.onload=null,this._image=null,this._recreateLock=!1},b$y.recreateResource=function(){var b$M=this;if(this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._image){if(this._recreateLock)return;this._allowMerageInAtlas&&this._$5__enableMerageInAtlas?(this.memorySize=0,this._recreateLock=!1):this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0;var b$y=this;this._image=new b$P.window.Image,this._image.crossOrigin=0==this._src.indexOf("data:")?null:"",this._image.onload=function(){if(b$y._needReleaseAgain)return b$y._needReleaseAgain=!1,b$y._image.onload=null,void(b$y._image=null);b$y._allowMerageInAtlas&&b$y._enableMerageInAtlas?(b$M.memorySize=0,b$M._recreateLock=!1):b$y._createWebGlTexture(),b$y.completeCreate()},this._image.src=this._src}},b$y.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&b$AM.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0},b$y.onresize=function(){this._w=this._image.width,this._h=this._image.height,b$B.enabled&&this._w<b$B.atlasLimitWidth&&this._h<b$B.atlasLimitHeight?this._allowMerageInAtlas=!0:this._allowMerageInAtlas=!1},b$y.clearAtlasSource=function(){this._image=null},b$H(0,b$y,"format",function(){return this._format}),b$H(0,b$y,"enableMerageInAtlas",function(){return this._$5__enableMerageInAtlas},function(b$M){this._$5__enableMerageInAtlas=b$M}),b$H(0,b$y,"mipmap",function(){return this._mipmap}),b$H(0,b$y,"allowMerageInAtlas",function(){return this._allowMerageInAtlas}),b$H(0,b$y,"atlasSource",function(){return this._image}),b$H(0,b$y,"onload",null,function(b$M){var b$y=this;this._onload=b$M,this._image&&(this._image.onload=null!=this._onload?function(){b$y.onresize(),b$y._onload()}:null)}),b$H(0,b$y,"onerror",null,function(b$M){var b$y=this;this._onerror=b$M,this._image&&(this._image.onerror=null!=this._onerror?function(){b$y._onerror()}:null)}),b$K}();b$I.__init([b$PM,b$p,b$UM,b$RM])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(b$M,b$y){"use strict";for(var b$i in Object.defineProperty(b$y,"__esModule",{value:!0}),Laya){var b$H=Laya[b$i];b$H&&b$H.__isclass&&(b$y[b$i]=b$H)}}),function(b$f,b$M,b$H){b$H.un,b$H.uns;var b$S=b$H.static,b$V=b$H.class,b$K=b$H.getset,b$k=(b$H.__newvec,laya.utils.Browser,laya.display.css.CSSStyle),b$l=laya.utils.ClassUtils,b$o=(laya.events.Event,laya.utils.HTMLChar),b$X=laya.net.Loader,b$F=(laya.display.Node,laya.maths.Rectangle),b$d=laya.renders.Render,b$P=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.display.Sprite),b$J=laya.utils.Stat,b$w=laya.display.Text,b$h=laya.resource.Texture,b$C=laya.net.URL,b$v=laya.utils.Utils,b$R=function(){function b$P(){}return b$V(b$P,"laya.html.utils.HTMLParse"),b$P.parse=function(b$M,b$y,b$i){b$y=(b$y="<root>"+(b$y=b$y.replace(/<br>/g,"<br/>"))+"</root>").replace(b$P.spacePattern,b$P.char255);var b$H=b$v.parseXMLFromString(b$y);b$P._parseXML(b$M,b$H.childNodes[0].childNodes,b$i)},b$P._parseXML=function(b$M,b$y,b$i,b$H){var b$S=0,b$f=0;if(b$y.join||b$y.item)for(b$S=0,b$f=b$y.length;b$S<b$f;++b$S)b$P._parseXML(b$M,b$y[b$S],b$i,b$H);else{var b$V,b$K,b$k;if(3==b$y.nodeType)return void(b$M instanceof laya.html.dom.HTMLDivElement?(null==b$y.nodeName&&(b$y.nodeName="#text"),b$K=b$y.nodeName.toLowerCase(),0<(b$k=b$y.textContent.replace(/^\s+|\s+$/g,"")).length&&(b$V=b$l.getInstance(b$K))&&(b$M.addChild(b$V),b$V.innerTEXT=b$k.replace(b$P.char255AndOneSpacePattern," "))):0<(b$k=b$y.textContent.replace(/^\s+|\s+$/g,"")).length&&(b$M.innerTEXT=b$k.replace(b$P.char255AndOneSpacePattern," ")));if("#comment"==(b$K=b$y.nodeName.toLowerCase()))return;if(b$V=b$l.getInstance(b$K)){(b$V=b$M.addChild(b$V)).URI=b$i,b$V.href=b$H;var b$X=b$y.attributes;if(b$X&&0<b$X.length)for(b$S=0,b$f=b$X.length;b$S<b$f;++b$S){var b$F=b$X[b$S],b$o=b$F.nodeName,b$d=b$F.value;b$V._setAttributes(b$o,b$d)}b$P._parseXML(b$V,b$y.childNodes,b$i,b$V.href)}else b$P._parseXML(b$M,b$y.childNodes,b$i,b$H)}},b$P.char255=String.fromCharCode(255),b$P.spacePattern=/&nbsp;|&#160;/g,b$P.char255AndOneSpacePattern=new RegExp(String.fromCharCode(255)+"|(\\s+)","g"),b$P}(),b$A=function(){function b$z(){}return b$V(b$z,"laya.html.utils.Layout"),b$z.later=function(b$M){null==b$z._will&&(b$z._will=[],b$H.stage.frameLoop(1,null,function(){if(!(b$z._will.length<1)){for(var b$M=0;b$M<b$z._will.length;b$M++)laya.html.utils.Layout.layout(b$z._will[b$M]);b$z._will.length=0}})),b$z._will.push(b$M)},b$z.layout=function(b$M){if(!b$M||!b$M._style)return null;if(0==(512&b$M._style._type))return null;b$M.getStyle()._type&=-513;var b$y=b$z._multiLineLayout(b$M);return b$d.isConchApp&&b$M.layaoutCallNative&&b$M.layaoutCallNative(),b$y},b$z._multiLineLayout=function(b$M){if(b$w.RightToLeft)return b$z._multiLineLayout2(b$M);var b$y=new Array;b$M._addChildsToLayout(b$y);var b$i,b$H,b$S,b$f,b$V,b$K=0,b$k=b$y.length,b$X=b$M._getCSSStyle(),b$F=b$X.letterSpacing,b$o=b$X.leading,b$d=b$X.lineHeight,b$P=b$X._widthAuto()||!b$X.wordWrap,b$l=b$P?999999:b$M.width,b$J=(b$M.height,0),b$h=b$X.italic?b$X.fontSize/3:0,b$C=b$X._getAlign(),b$v=b$X._getValign(),b$R=0!==b$v||0!==b$C||0!=b$d,b$A=0,b$G=0,b$I=0,b$U=0,b$Q=new Array,b$W=b$Q[0]=new b$q,b$c=!1,b$n=!1;b$W.h=0,b$X.italic&&(b$l-=b$X.fontSize/3);var b$a=0,b$T=!0;function b$m(){b$W.y=b$G,b$G+=b$W.h+b$o,0==b$W.h&&(b$G+=b$d),b$W.mWidth=b$a,b$a=0,b$W=new b$q,b$Q.push(b$W),b$W.h=0,b$c=!(b$T=!(b$A=0))}for(b$K=0;b$K<b$k;b$K++)if(null!=(b$i=b$y[b$K]))if(b$T=!1,b$i instanceof laya.html.dom.HTMLBrElement)b$m(),b$W.y=b$G;else{if(b$i._isChar()){if((b$f=b$i).isWord)b$c=b$n||"\n"===b$f.char,b$W.wordStartIndex=b$W.elements.length;else{if(b$I=b$f.width+b$f.style.letterSpacin,0<b$Q.length&&b$l<b$A+b$I&&0<b$W.wordStartIndex){var b$e;b$e=b$W.elements.length-b$W.wordStartIndex+1,b$W.elements.length=b$W.wordStartIndex,b$K-=b$e,b$m();continue}b$c=!1,b$a+=b$f.width}b$I=b$f.width+b$F,b$U=b$f.height,b$n=!1,(b$c=b$c||b$l<b$A+b$I)&&b$m(),b$W.minTextHeight=Math.min(b$W.minTextHeight,b$i.height)}else b$H=b$i._getCSSStyle(),b$V=b$i,b$S=b$H.padding,0===b$H._getCssFloat()||(b$R=!0),b$c=b$n||b$H.lineElement,b$I=b$V.width*b$V._style._tf.scaleX+b$S[1]+b$S[3]+b$F,b$U=b$V.height*b$V._style._tf.scaleY+b$S[0]+b$S[2],b$n=b$H.lineElement,(b$c=b$c||b$l<b$A+b$I&&b$H.wordWrap)&&b$m();b$W.elements.push(b$i),b$W.h=Math.max(b$W.h,b$U),b$i.x=b$A,b$i.y=b$G,b$A+=b$I,b$W.w=b$A-b$F,b$W.y=b$G,b$J=Math.max(b$A+b$h,b$J)}else b$T||(b$A+=b$z.DIV_ELEMENT_PADDING),b$W.wordStartIndex=b$W.elements.length;if(b$G=b$W.y+b$W.h,b$R){var b$s=0,b$D=b$l;for(b$P&&0<b$M.width&&(b$D=b$M.width),b$K=0,b$k=b$Q.length;b$K<b$k;b$K++)b$Q[b$K].updatePos(0,b$D,b$K,b$s,b$C,b$v,b$d),b$s+=Math.max(b$d,b$Q[b$K].h+b$o);b$G=b$s}return b$P&&(b$M.width=b$J),b$G>b$M.height&&(b$M.height=b$G),[b$J,b$G]},b$z._multiLineLayout2=function(b$M){var b$y=new Array;b$M._addChildsToLayout(b$y);var b$i,b$H,b$S,b$f,b$V,b$K=0,b$k=b$y.length,b$X=b$M._getCSSStyle(),b$F=b$X.letterSpacing,b$o=b$X.leading,b$d=b$X.lineHeight,b$P=b$X._widthAuto()||!b$X.wordWrap,b$l=b$P?999999:b$M.width,b$J=(b$M.height,0),b$h=b$X.italic?b$X.fontSize/3:0,b$C=2-b$X._getAlign(),b$v=b$X._getValign(),b$R=0!==b$v||0!=b$C||0!=b$d,b$A=0,b$G=0,b$I=0,b$U=0,b$Q=new Array,b$W=b$Q[0]=new b$q,b$c=!1,b$n=!1;b$W.h=0,b$X.italic&&(b$l-=b$X.fontSize/3);var b$a=0,b$T=!0;function b$m(){b$W.y=b$G,b$G+=b$W.h+b$o,0==b$W.h&&(b$G+=b$d),b$W.mWidth=b$a,b$a=0,b$W=new b$q,b$Q.push(b$W),b$W.h=0,b$c=!(b$T=!(b$A=0))}for(b$K=0;b$K<b$k;b$K++)if(null!=(b$i=b$y[b$K]))if(b$T=!1,b$i instanceof laya.html.dom.HTMLBrElement)b$m(),b$W.y=b$G;else{if(b$i._isChar()){if((b$f=b$i).isWord)b$c=b$n||"\n"===b$f.char,b$W.wordStartIndex=b$W.elements.length;else{if(0<b$Q.length&&b$l<b$A+b$I&&0<b$W.wordStartIndex){var b$e;b$e=b$W.elements.length-b$W.wordStartIndex+1,b$W.elements.length=b$W.wordStartIndex,b$K-=b$e,b$m();continue}b$c=!1,b$a+=b$f.width}b$I=b$f.width+b$F,b$U=b$f.height,b$n=!1,(b$c=b$c||b$l<b$A+b$I)&&b$m(),b$W.minTextHeight=Math.min(b$W.minTextHeight,b$i.height)}else b$H=b$i._getCSSStyle(),b$V=b$i,b$S=b$H.padding,0===b$H._getCssFloat()||(b$R=!0),b$c=b$n||b$H.lineElement,b$I=b$V.width*b$V._style._tf.scaleX+b$S[1]+b$S[3]+b$F,b$U=b$V.height*b$V._style._tf.scaleY+b$S[0]+b$S[2],b$n=b$H.lineElement,(b$c=b$c||b$l<b$A+b$I&&b$H.wordWrap)&&b$m();b$W.elements.push(b$i),b$W.h=Math.max(b$W.h,b$U),b$i.x=b$A,b$i.y=b$G,b$A+=b$I,b$W.w=b$A-b$F,b$W.y=b$G,b$J=Math.max(b$A+b$h,b$J)}else b$T||(b$A+=b$z.DIV_ELEMENT_PADDING),b$W.wordStartIndex=b$W.elements.length;if(b$G=b$W.y+b$W.h,b$R){var b$s=0,b$D=b$l;for(b$K=0,b$k=b$Q.length;b$K<b$k;b$K++)b$Q[b$K].updatePos(0,b$D,b$K,b$s,b$C,b$v,b$d),b$s+=Math.max(b$d,b$Q[b$K].h+b$o);b$G=b$s}for(b$P&&(b$M.width=b$J),b$G>b$M.height&&(b$M.height=b$G),b$K=0,b$k=b$Q.length;b$K<b$k;b$K++)b$Q[b$K].revertOrder(b$l);return[b$J,b$G]},b$z._will=null,b$z.DIV_ELEMENT_PADDING=0,b$z}(),b$q=function(){function b$M(){this.x=0,this.y=0,this.w=0,this.h=0,this.wordStartIndex=0,this.minTextHeight=99999,this.mWidth=0,this.elements=new Array}b$V(b$M,"laya.html.utils.LayoutLine");var b$y=b$M.prototype;return b$y.updatePos=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){var b$K,b$k=0;0<this.elements.length&&(b$k=(b$K=this.elements[this.elements.length-1]).x+b$K.width-this.elements[0].x);var b$X=0,b$F=NaN;1===b$S&&(b$X=(b$y-b$k)/2),2===b$S&&(b$X=b$y-b$k),0===b$V||0!=b$f||(b$f=1);for(var b$o=0,b$d=this.elements.length;b$o<b$d;b$o++){var b$P=(b$K=this.elements[b$o])._getCSSStyle();switch(0!==b$X&&(b$K.x+=b$X),b$P._getValign()){case 0:b$K.y=b$H;break;case 1:var b$l=0;99999!=this.minTextHeight&&(b$l=this.minTextHeight);var b$J=(b$l+b$V)/2;b$J=Math.max(b$J,this.h),b$F=(laya.html.dom.HTMLImageElement,b$H+b$J-b$K.height),b$K.y=b$F;break;case 2:b$K.y=b$H+(b$V-b$K.height)}}},b$y.revertOrder=function(b$M){var b$y;if(0<this.elements.length){var b$i,b$H=0;for(b$i=this.elements.length,b$H=0;b$H<b$i;b$H++)(b$y=this.elements[b$H]).x=b$M-b$y.x-b$y.width}},b$M}(),b$G=function(b$i){function b$y(){this.URI=null,this._href=null,b$y.__super.call(this),this._text=b$y._EMPTYTEXT,this.setStyle(new b$k(this)),this._getCSSStyle().valign="middle",this.mouseEnabled=!0}b$V(b$y,"laya.html.dom.HTMLElement",b$i);var b$M=b$y.prototype;return b$M.layaoutCallNative=function(){var b$M=0;if(this._childs&&0<(b$M=this._childs.length))for(var b$y=0;b$y<b$M;b$y++)this._childs[b$y].layaoutCallNative&&this._childs[b$y].layaoutCallNative();var b$i=this._getWords();b$i?laya.html.dom.HTMLElement.fillWords(this,b$i,0,0,this.style.font,this.style.color,this.style.underLine):this.graphics.clear()},b$M.appendChild=function(b$M){return this.addChild(b$M)},b$M._getWords2=function(){var b$M=this._text.text;if(!b$M||0===b$M.length)return null;var b$y,b$i,b$H=0,b$S=0;if(this._text.drawWords)b$i=this._text.drawWords;else{for(b$S=(b$y=b$M.split(" ")).length-1,b$i=[],b$H=0;b$H<b$S;b$H++)b$i.push(b$y[b$H]," ");0<=b$S&&b$i.push(b$y[b$S]),this._text.drawWords=b$i}var b$f,b$V=this._text.words;if(b$V&&b$V.length===b$i.length)return b$V;null===b$V&&(this._text.words=b$V=[]),b$V.length=b$i.length;var b$K=this.style,b$k=b$K.font;for(b$H=0,b$S=b$i.length;b$H<b$S;b$H++){b$f=b$v.measureText(b$i[b$H],b$k);var b$X=b$V[b$H]=new b$o(b$i[b$H],b$f.width,b$f.height||b$K.fontSize,b$K);if(1<b$X.char.length&&(b$X.charNum=b$X.char),this.href){var b$F=new b$P;this.addChild(b$F),b$X.setSprite(b$F)}}return b$V},b$M._getWords=function(){if(!b$w.CharacterCache)return this._getWords2();var b$M=this._text.text;if(!b$M||0===b$M.length)return null;var b$y,b$i=this._text.words;if(b$i&&b$i.length===b$M.length)return b$i;null===b$i&&(this._text.words=b$i=[]),b$i.length=b$M.length;for(var b$H=this.style,b$S=b$H.font,b$f=0,b$V=b$M.length;b$f<b$V;b$f++)if(b$y=b$v.measureText(b$M.charAt(b$f),b$S)){var b$K=b$i[b$f]=new b$o(b$M.charAt(b$f),b$y.width,b$y.height||b$H.fontSize,b$H);if(this.href){var b$k=new b$P;this.addChild(b$k),b$K.setSprite(b$k)}}else console.warn("_getWords size is null"+b$M.charAt(b$f),b$S);return b$i},b$M.showLinkSprite=function(){var b$M=this._text.words;if(b$M)for(var b$y,b$i,b$H=[],b$S=0;b$S<b$M.length;b$S++)b$i=b$M[b$S],(b$y=new b$P).graphics.drawRect(0,0,b$i.width,b$i.height,"#ff0000"),b$y.width=b$i.width,b$y.height=b$i.height,this.addChild(b$y),b$H.push(b$y)},b$M._layoutLater=function(){var b$M=this.style;512&b$M._type||(b$M.widthed(this)&&(0<this._childs.length||null!=this._getWords())&&b$M.block?(b$A.later(this),b$M._type|=512):this.parent&&this.parent._layoutLater())},b$M._setAttributes=function(b$M,b$y){switch(b$M){case"style":return void this.style.cssText(b$y);case"class":return void(this.className=b$y)}b$i.prototype._setAttributes.call(this,b$M,b$y)},b$M.updateHref=function(){if(null!=this._href){var b$M=this._getWords();if(b$M)for(var b$y,b$i,b$H=0;b$H<b$M.length;b$H++)(b$i=(b$y=b$M[b$H]).getSprite())&&(b$i.size(b$y.width,b$y.height),b$i.on("click",this,this.onLinkHandler))}},b$M.onLinkHandler=function(b$M){switch(b$M.type){case"click":for(var b$y=this;b$y;)b$y.event("link",[this.href]),b$y=b$y.parent}},b$M.formatURL=function(b$M){return this.URI?b$C.formatURL(b$M,this.URI?this.URI.path:null):b$M},b$K(0,b$M,"href",function(){return this._href},function(b$M){null!=(this._href=b$M)&&(this._getCSSStyle().underLine=1,this.updateHref())}),b$K(0,b$M,"color",null,function(b$M){this.style.color=b$M}),b$K(0,b$M,"onClick",null,function(b$M){b$H._runScript("fn=function(event){"+b$M+";}"),this.on("click",this,void 0)}),b$K(0,b$M,"id",null,function(b$M){b$I.document.setElementById(b$M,this)}),b$K(0,b$M,"innerTEXT",function(){return this._text.text},function(b$M){this.text=b$M}),b$K(0,b$M,"style",function(){return this._style}),b$K(0,b$M,"text",function(){return this._text.text},function(b$M){this._text==b$y._EMPTYTEXT?this._text={text:b$M,words:null}:(this._text.text=b$M,this._text.words&&(this._text.words.length=0)),b$d.isConchApp&&this.layaoutCallNative(),this._renderType|=2048,this.repaint(),this.updateHref()}),b$K(0,b$M,"parent",b$i.prototype._$get_parent,function(b$M){if(b$M instanceof laya.html.dom.HTMLElement){var b$y=b$M;this.URI||(this.URI=b$y.URI),this.style.inherit(b$y.style)}b$H.superSet(b$P,this,"parent",b$M)}),b$K(0,b$M,"className",null,function(b$M){this.style.attrs(b$I.document.styleSheets["."+b$M])}),b$y.fillWords=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){b$M.graphics.clear();for(var b$K=0,b$k=b$y.length;b$K<b$k;b$K++){var b$X=b$y[b$K];b$M.graphics.fillText(b$X.char,b$X.x+b$i,b$X.y+b$H,b$S,b$f,"left",b$V)}},b$y._EMPTYTEXT={text:null,words:null},b$y}(b$P),b$y=(function(b$M){function b$y(){b$y.__super.call(this),this.style.lineElement=!0,this.style.block=!0}b$V(b$y,"laya.html.dom.HTMLBrElement",b$G)}(),function(b$M){function b$y(){this.contextHeight=NaN,this.contextWidth=NaN,b$y.__super.call(this),this.style.block=!0,this.style.lineElement=!0,this.style.width=200,this.style.height=200}b$V(b$y,"laya.html.dom.HTMLDivElement",b$M);var b$i=b$y.prototype;return b$i.appendHTML=function(b$M){b$R.parse(this,b$M,this.URI),this.layout()},b$i._addChildsToLayout=function(b$y){var b$M=this._getWords();if(null==b$M&&0==this._childs.length)return!1;b$M&&b$M.forEach(function(b$M){b$y.push(b$M)});for(var b$i=!0,b$H=0,b$S=this._childs.length;b$H<b$S;b$H++){var b$f=this._childs[b$H];b$i?b$i=!1:b$y.push(null),b$f._addToLayout(b$y)}return!0},b$i._addToLayout=function(b$M){this.layout()},b$i.layout=function(){if(this.style){this.style._type|=512;var b$M=b$A.layout(this);if(b$M){this._$P.mHtmlBounds||this._set$P("mHtmlBounds",new b$F);var b$y=this._$P.mHtmlBounds;b$y.x=b$y.y=0,b$y.width=this.contextWidth=b$M[0],b$y.height=this.contextHeight=b$M[1],this.setBounds(b$y)}}},b$K(0,b$i,"height",function(){return this._height?this._height:this.contextHeight},b$M.prototype._$set_height),b$K(0,b$i,"innerHTML",null,function(b$M){this.destroyChildren(),this.appendHTML(b$M)}),b$K(0,b$i,"width",function(){return this._width?this._width:this.contextWidth},function(b$M){var b$y=!1;b$y=0===b$M?b$M!=this._width:b$M!=this.width,b$H.superSet(b$G,this,"width",b$M),b$y&&this.layout()}),b$y}(b$G)),b$I=function(b$M){function b$y(){this.all=new Array,this.styleSheets=b$k.styleSheets,b$y.__super.call(this)}b$V(b$y,"laya.html.dom.HTMLDocument",b$G);var b$i=b$y.prototype;return b$i.getElementById=function(b$M){return this.all[b$M]},b$i.setElementById=function(b$M,b$y){this.all[b$M]=b$y},b$S(b$y,["document",function(){return this.document=new b$y}]),b$y}();(function(b$M){function b$y(){this._tex=null,this._url=null,this._renderArgs=[],b$y.__super.call(this),this.style.block=!0}b$V(b$y,"laya.html.dom.HTMLImageElement",b$G);var b$i=b$y.prototype;b$i._addToLayout=function(b$M){!this._style.absolute&&b$M.push(this)},b$i.render=function(b$M,b$y,b$i){!this._tex||!this._tex.loaded||!this._tex.loaded||this._width<1||this._height<1||(b$J.spriteCount++,this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,b$M.ctx.drawTexture2(b$y,b$i,this.style.translateX,this.style.translateY,this.transform,this.style.alpha,this.style.blendMode,this._renderArgs))},b$i.layaoutCallNative=function(){var b$M=0;if(this._childs&&0<(b$M=this._childs.length))for(var b$y=0;b$y<b$M;b$y++)this._childs[b$y].layaoutCallNative&&this._childs[b$y].layaoutCallNative()},b$K(0,b$i,"width",function(){return this.autoSize?this.getSelfBounds().width:this._width},function(b$M){this._width!==b$M&&(this._width=b$M,this._style.width=b$M,this.repaint())}),b$K(0,b$i,"height",function(){return this.autoSize?this.getSelfBounds().height:this._height},function(b$M){this._height!==b$M&&(this._height=b$M,this._style.height=b$M,this.repaint())}),b$i.destroy=function(){null!=this._tex&&(this._tex.off("loaded",this,this.onloaded),b$X.clearCache(this,this._url),this._tex=null),b$G.prototype.destroy.call(this)},b$i.onloaded=function(){var b$M=this._style;b$M&&!b$M.widthed(this)&&this._width!=this._tex.width&&(this.width=this._tex.width,this.parent&&this.parent._layoutLater()),b$M&&!b$M.heighted(this)&&this._height!=this._tex.height&&(this.height=this._tex.height,this.parent&&this.parent._layoutLater()),b$d.isConchApp&&(this._renderArgs[0]=this._tex,this._renderArgs[1]=this.x,this._renderArgs[2]=this.y,this._renderArgs[3]=this.width||this._tex.width,this._renderArgs[4]=this.height||this._tex.height,this.graphics.drawTexture(this._tex,0,0,this._renderArgs[3],this._renderArgs[4])),this.repaint(),this.parentRepaint()},b$i._loadImageComplete=function(b$M,b$y,b$i){if(!this._destroyed)if(null!=b$i)if(b$i instanceof ArrayBuffer){var b$H=new DataView(b$i);new laya.webgl.resource.WebGLImage(new Uint8Array(b$i,8),b$M,0,!1,b$H.getUint32(0),b$H.getUint32(4));this.onloaded()}else if(b$i instanceof b$h)b$X.imgMgrSet[b$M]=b$y,b$f.imgMgrLock(b$M,b$X.imgMgrSet[b$M]),this._url=b$M,this._tex=b$i,b$X.keepCache(this,b$M),b$X.cacheRes(b$M,this._tex),this.onloaded();else{var b$S=-1!=b$M.indexOf(".png",b$M.length-4)?6408:6407;new laya.webgl.resource.WebGLImage(b$i,b$M,b$S,!1,b$i.width,b$i.height);this.onloaded()}else this.event("error","Load image failed")},b$K(0,b$i,"src",null,function(b$M){(b$M=this.formatURL(b$M),this._url!=b$M)&&(null!=this._tex&&(b$X.clearCache(this,this._url),this._tex.off("loaded",this,this.onloaded)),this._url=b$M,(this._tex=b$X.getRes(b$M))?(b$X.keepCache(this,b$M),this.onloaded()):b$f.imgMgrLoad(b$M,this._loadImageComplete.bind(this),2,!1))})})(),function(b$M){function b$y(){this.type=null,b$y.__super.call(this),this.visible=!1}b$V(b$y,"laya.html.dom.HTMLLinkElement",b$M);var b$i=b$y.prototype;b$i._onload=function(b$M){switch(this.type){case"text/css":b$k.parseCSS(b$M,this.URI)}},b$K(0,b$i,"href",b$M.prototype._$get_href,function(b$M){var b$y=this;b$M=this.formatURL(b$M),this.URI=new b$C(b$M);var b$i=new b$X;b$i.once("complete",null,function(b$M){b$y._onload(b$M)}),b$i.load(b$M,"text")}),b$y._cuttingStyle=new RegExp("((@keyframes[\\s\\t]+|)(.+))[\\t\\n\\r\\s]*{","g")}(b$G),function(b$M){function b$y(){b$y.__super.call(this),this.visible=!1}b$V(b$y,"laya.html.dom.HTMLStyleElement",b$M),b$K(0,b$y.prototype,"text",b$M.prototype._$get_text,function(b$M){b$k.parseCSS(b$M,null)})}(b$G),function(b$M){function b$y(){b$y.__super.call(this),this._getCSSStyle().valign="middle"}b$V(b$y,"laya.html.dom.HTMLIframeElement",b$M),b$K(0,b$y.prototype,"href",b$M.prototype._$get_href,function(b$i){var b$H=this;b$i=this.formatURL(b$i);var b$M=new b$X;b$M.once("complete",null,function(b$M){var b$y=b$H.URI;b$H.URI=new b$C(b$i),b$H.innerHTML=b$M,!b$y||(b$H.URI=b$y)}),b$M.load(b$i,"text")})}(b$y)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(b$M,b$y){"use strict";for(var b$i in Object.defineProperty(b$y,"__esModule",{value:!0}),Laya){var b$H=Laya[b$i];b$H&&b$H.__isclass&&(b$y[b$i]=b$H)}}),function(b$M,b$y,b$J){b$J.un,b$J.uns;var b$H=b$J.static,b$f=b$J.class,b$S=b$J.getset,b$i=(b$J.__newvec,laya.display.Animation),b$h=(laya.utils.Browser,laya.utils.ClassUtils),b$V=laya.filters.ColorFilter,b$K=laya.utils.Ease,b$k=laya.events.Event,b$X=(laya.events.EventDispatcher,laya.display.css.Font),b$F=laya.display.FrameAnimation,b$o=laya.display.Graphics,b$d=laya.utils.Handler,b$P=laya.display.Input,b$v=laya.net.Loader,b$l=(laya.display.Node,laya.maths.Point),b$C=laya.maths.Rectangle,b$R=laya.renders.Render,b$A=laya.display.Sprite,b$G=laya.display.Text,b$I=laya.resource.Texture,b$U=laya.utils.Tween,b$Q=laya.utils.Utils,b$W=laya.utils.WeakObject;b$J.interface("laya.ui.IItem"),b$J.interface("laya.ui.ISelect"),b$J.interface("laya.ui.IRender"),b$J.interface("laya.ui.IComponent"),b$J.interface("laya.ui.IBox","IComponent");var b$c=function(){function b$M(){this.enable=!1,this.top=NaN,this.bottom=NaN,this.left=NaN,this.right=NaN,this.centerX=NaN,this.centerY=NaN,this.anchorX=NaN,this.anchorY=NaN}return b$f(b$M,"laya.ui.LayoutStyle"),b$H(b$M,["EMPTY",function(){return this.EMPTY=new b$M}]),b$M}(),b$n=function(){function b$M(){}return b$f(b$M,"laya.ui.Styles"),b$M.labelColor="#000000",b$M.buttonStateNum=3,b$M.scrollBarMinNum=15,b$M.scrollBarDelayTime=500,b$H(b$M,["defaultSizeGrid",function(){return this.defaultSizeGrid=[4,4,4,4,0]},"labelPadding",function(){return this.labelPadding=[2,2,2,2]},"inputLabelPadding",function(){return this.inputLabelPadding=[1,1,1,3]},"buttonLabelColors",function(){return this.buttonLabelColors=["#32556b","#32cc6b","#ff0000","#C0C0C0"]},"comboBoxItemColors",function(){return this.comboBoxItemColors=["#5e95b6","#ffffff","#000000","#8fa4b1","#ffffff"]}]),b$M}(),b$a=function(){function b$S(){}return b$f(b$S,"laya.ui.UIUtils"),b$S.fillArray=function(b$M,b$y,b$i){var b$H=b$M.concat();if(b$y)for(var b$S=b$y.split(","),b$f=0,b$V=Math.min(b$H.length,b$S.length);b$f<b$V;b$f++){var b$K=b$S[b$f];b$H[b$f]="true"==b$K||"false"!=b$K&&b$K,null!=b$i&&(b$H[b$f]=b$i(b$K))}return b$H},b$S.toColor=function(b$M){return b$Q.toHexColor(b$M)},b$S.gray=function(b$M,b$y){void 0===b$y&&(b$y=!0),b$y?b$S.addFilter(b$M,b$S.grayFilter):b$S.clearFilter(b$M,b$V)},b$S.addFilter=function(b$M,b$y){var b$i=b$M.filters||[];b$i.push(b$y),b$M.filters=b$i},b$S.clearFilter=function(b$M,b$y){var b$i=b$M.filters;if(null!=b$i&&0<b$i.length){for(var b$H=b$i.length-1;-1<b$H;b$H--){var b$S=b$i[b$H];b$J.__typeof(b$S,b$y)&&b$i.splice(b$H,1)}b$M.filters=b$i}},b$S._getReplaceStr=function(b$M){return b$S.escapeSequence[b$M]},b$S.adptString=function(b$M){return b$M.replace(/\\(\w)/g,b$S._getReplaceStr)},b$S.getBindFun=function(b$M){var b$y=b$S._funMap.get(b$M);if(null==b$y){var b$i='"'+b$M+'"',b$H="(function(data){if(data==null)return;with(data){try{\nreturn "+(b$i=b$i.replace(/^"\${|}"$/g,"").replace(/\${/g,'"+').replace(/}/g,'+"'))+"\n}catch(e){}}})";b$y=b$J._runScript(b$H),b$S._funMap.set(b$M,b$y)}return b$y},b$H(b$S,["grayFilter",function(){return this.grayFilter=new b$V([.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,.3086,.6094,.082,0,0,0,0,0,1,0])},"escapeSequence",function(){return this.escapeSequence={"\\n":"\n","\\t":"\t"}},"_funMap",function(){return this._funMap=new b$W}]),b$S}(),b$T=function(){function b$M(){}return b$f(b$M,"UIConfig"),b$M.touchScrollEnable=!0,b$M.mouseWheelEnable=!0,b$M.showButtons=!0,b$M.popupBgColor="#000000",b$M.popupBgAlpha=.5,b$M.closeDialogOnSide=!0,b$M}(),b$m=function(b$i){function b$C(){this.autoCacheCmd=!0,this._width=0,this._height=0,this._source=null,this._sizeGrid=null,this._isChanged=!1,this._offset=null,b$C.__super.call(this),this._weakKeys=[]}b$f(b$C,"laya.ui.AutoBitmap",b$i);var b$M=b$C.prototype;return b$M.destroy=function(){if(b$v.clearObject(this,this._weakKey),this._weakKeys){for(var b$M=0,b$y=this._weakKeys.length;b$M<b$y;++b$M)b$v.clearObject(this,this._weakKeys[b$M]);this._weakKeys=null}b$i.prototype.destroy.call(this),this._source=null,this._sizeGrid=null,this._offset=null},b$M._setChanged=function(){this._isChanged||(this._isChanged=!0,b$J.timer.callLater(this,this.changeSource))},b$M.changeSource=function(){this._isChanged=!1;var b$M=this._source;if(b$M&&b$M.bitmap){var b$y=this.width,b$i=this.height,b$H=this._sizeGrid,b$S=b$M.sourceWidth,b$f=b$M.sourceHeight;if(!b$H||b$S===b$y&&b$f===b$i)this.cleanByTexture(b$M,this._offset?this._offset[0]:0,this._offset?this._offset[1]:0,b$y,b$i);else{b$v.clearObject(this,this._weakKey),b$M.$_GID||(b$M.$_GID=b$Q.getGID());var b$V=b$M.$_GID+"."+b$y+"."+b$i+"."+b$H.join("."),b$K=b$v.findObject(b$V);if(b$Q.isOKCmdList(b$K))return this._weakKey=b$V,b$v.keepObject(this,this._weakKey),void(this.cmds=b$K);this.clear();var b$k,b$X,b$F=b$H[0],b$o=b$H[1],b$d=b$H[2],b$P=b$H[3],b$l=b$H[4],b$J=!1;if(b$y==b$S&&(b$P=b$o=0),b$i==b$f&&(b$F=b$d=0),b$y<b$P+b$o){var b$h=b$y;b$J=!0,b$y=b$P+b$o,this.save(),this.clipRect(0,0,b$h,b$i)}b$P&&b$F&&(b$k=b$C.getTexture(b$M,0,0,b$P,b$F),b$X=this._weakKeys[0],b$k?(b$X!=b$k.weakKey&&(b$v.clearObject(this,b$X),b$v.keepObject(this,b$k.weakKey),this._weakKeys[0]=b$k.weakKey),this.drawTexture(b$k,0,0,b$P,b$F)):(b$v.clearObject(this,b$X),this._weakKeys[0]="")),b$o&&b$F&&(b$k=b$C.getTexture(b$M,b$S-b$o,0,b$o,b$F),b$X=this._weakKeys[1],b$k?(b$X!=b$k.weakKey&&(b$v.clearObject(this,b$X),b$v.keepObject(this,b$k.weakKey),this._weakKeys[1]=b$k.weakKey),this.drawTexture(b$k,b$y-b$o,0,b$o,b$F)):(b$v.clearObject(this,b$X),this._weakKeys[1]="")),b$P&&b$d&&(b$k=b$C.getTexture(b$M,0,b$f-b$d,b$P,b$d),b$X=this._weakKeys[2],b$k?(b$X!=b$k.weakKey&&(b$v.clearObject(this,b$X),b$v.keepObject(this,b$k.weakKey),this._weakKeys[2]=b$k.weakKey),this.drawTexture(b$k,0,b$i-b$d,b$P,b$d)):(b$v.clearObject(this,b$X),this._weakKeys[2]="")),b$o&&b$d&&(b$k=b$C.getTexture(b$M,b$S-b$o,b$f-b$d,b$o,b$d),b$X=this._weakKeys[3],b$k?(b$X!=b$k.weakKey&&(b$v.clearObject(this,b$X),b$v.keepObject(this,b$k.weakKey),this._weakKeys[3]=b$k.weakKey),this.drawTexture(b$k,b$y-b$o,b$i-b$d,b$o,b$d)):(b$v.clearObject(this,b$X),this._weakKeys[3]="")),b$F&&(b$k=b$C.getTexture(b$M,b$P,0,b$S-b$P-b$o,b$F),b$X=this._weakKeys[4],b$k?(b$X!=b$k.weakKey&&(b$v.clearObject(this,b$X),b$v.keepObject(this,b$k.weakKey),this._weakKeys[4]=b$k.weakKey),this.drawBitmap(b$l,b$k,b$P,0,b$y-b$P-b$o,b$F)):(b$v.clearObject(this,b$X),this._weakKeys[4]="")),b$d&&(b$k=b$C.getTexture(b$M,b$P,b$f-b$d,b$S-b$P-b$o,b$d),b$X=this._weakKeys[5],b$k?(b$X!=b$k.weakKey&&(b$v.clearObject(this,b$X),b$v.keepObject(this,b$k.weakKey),this._weakKeys[5]=b$k.weakKey),this.drawBitmap(b$l,b$k,b$P,b$i-b$d,b$y-b$P-b$o,b$d)):(b$v.clearObject(this,b$X),this._weakKeys[5]="")),b$P&&(b$k=b$C.getTexture(b$M,0,b$F,b$P,b$f-b$F-b$d),b$X=this._weakKeys[6],b$k?(b$X!=b$k.weakKey&&(b$v.clearObject(this,b$X),b$v.keepObject(this,b$k.weakKey),this._weakKeys[6]=b$k.weakKey),this.drawBitmap(b$l,b$k,0,b$F,b$P,b$i-b$F-b$d)):(b$v.clearObject(this,b$X),this._weakKeys[6]="")),b$o&&(b$k=b$C.getTexture(b$M,b$S-b$o,b$F,b$o,b$f-b$F-b$d),b$X=this._weakKeys[7],b$k?(b$X!=b$k.weakKey&&(b$v.clearObject(this,b$X),b$v.keepObject(this,b$k.weakKey),this._weakKeys[7]=b$k.weakKey),this.drawBitmap(b$l,b$k,b$y-b$o,b$F,b$o,b$i-b$F-b$d)):(b$v.clearObject(this,b$X),this._weakKeys[7]="")),b$k=b$C.getTexture(b$M,b$P,b$F,b$S-b$P-b$o,b$f-b$F-b$d),b$X=this._weakKeys[8],b$k?(b$X!=b$k.weakKey&&(b$v.clearObject(this,b$X),b$v.keepObject(this,b$k.weakKey),this._weakKeys[8]=b$k.weakKey),this.drawBitmap(b$l,b$k,b$P,b$F,b$y-b$P-b$o,b$i-b$F-b$d)):(b$v.clearObject(this,b$X),this._weakKeys[8]=""),b$J&&this.restore(),this.autoCacheCmd&&!b$R.isConchApp&&(b$v.saveObject(b$V,this.cmds,null),this._weakKey=b$V,b$v.keepObject(this,this._weakKey))}this._repaint()}},b$M.drawBitmap=function(b$M,b$y,b$i,b$H,b$S,b$f){void 0===b$S&&(b$S=0),void 0===b$f&&(b$f=0),b$S<.1||b$f<.1||(!b$M||b$y.width==b$S&&b$y.height==b$f?this.drawTexture(b$y,b$i,b$H,b$S,b$f):this.fillTexture(b$y,b$i,b$H,b$S,b$f))},b$M.clear=function(b$M){void 0===b$M&&(b$M=!0),b$i.prototype.clear.call(this,!1)},b$S(0,b$M,"sizeGrid",function(){return this._sizeGrid},function(b$M){this._sizeGrid=b$M,this._setChanged()}),b$S(0,b$M,"width",function(){return this._width?this._width:this._source?this._source.sourceWidth:0},function(b$M){this._width!=b$M&&(this._width=b$M,this._setChanged())}),b$S(0,b$M,"height",function(){return this._height?this._height:this._source?this._source.sourceHeight:0},function(b$M){this._height!=b$M&&(this._height=b$M,this._setChanged())}),b$S(0,b$M,"source",function(){return this._source},function(b$M){b$M?(this._source=b$M,this._setChanged()):(this._source=null,this.clear())}),b$C.getTexture=function(b$M,b$y,b$i,b$H,b$S){b$H<=0&&(b$H=1),b$S<=0&&(b$S=1),b$M.$_GID||(b$M.$_GID=b$Q.getGID());var b$f=b$M.$_GID+"."+b$y+"."+b$i+"."+b$H+"."+b$S,b$V=b$v.findObject(b$f);if((!b$V||!b$V.source)&&(b$V=b$I.createFromTexture(b$M,b$y,b$i,b$H,b$S))){if(b$M.alphaTexture){var b$K=b$M.width/b$M.alphaTexture.width;b$V.alphaTexture=b$I.createFromTexture(b$M.alphaTexture,b$y/b$K,b$i/b$K,b$H/b$K,b$S/b$K)}b$v.saveObject(b$f,b$V),b$V.weakKey=b$f}return b$V},b$C}(b$o),b$e=(function(b$M){function b$y(){b$y.__super.call(this)}b$f(b$y,"laya.ui.UIEvent",b$k),b$y.SHOW_TIP="showtip",b$y.HIDE_TIP="hidetip"}(),function(b$y){function b$M(){this._comXml=null,this._dataSource=null,this._toolTip=null,this._tag=null,this._disabled=!1,this._gray=!1,this.layoutEnabled=!0,b$M.__super.call(this),this._layout=b$c.EMPTY,this.preinitialize(),this.createChildren(),this.initialize()}b$f(b$M,"laya.ui.Component",b$y);var b$i=b$M.prototype;return b$J.imps(b$i,{"laya.ui.IComponent":!0}),b$i.destroy=function(b$M){void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,b$M),this._dataSource=this._layout=null,this._tag=null,this._toolTip=null},b$i.preinitialize=function(){},b$i.createChildren=function(){},b$i.initialize=function(){},b$i.callLater=function(b$M,b$y){b$J.timer.callLater(this,b$M,b$y)},b$i.runCallLater=function(b$M){b$J.timer.runCallLater(this,b$M)},b$i.commitMeasure=function(){},b$i.changeSize=function(){this.event("resize")},b$i.getLayout=function(){return this._layout===b$c.EMPTY&&(this._layout=new b$c),this._layout},b$i._setLayoutEnabled=function(b$M){this._layout&&this._layout.enable!=b$M&&(this._layout.enable=b$M,this.on("added",this,this.onAdded),this.on("removed",this,this.onRemoved),this.parent&&this.onAdded())},b$i.onRemoved=function(){this.parent.off("resize",this,this.onCompResize)},b$i.onAdded=function(){this.parent.on("resize",this,this.onCompResize),this.resetLayoutX(),this.resetLayoutY()},b$i.onCompResize=function(){this._layout&&this._layout.enable&&(this.resetLayoutX(),this.resetLayoutY())},b$i.resetLayoutX=function(){var b$M=this._layout;if(isNaN(b$M.anchorX)||(this.pivotX=b$M.anchorX*this.width),this.layoutEnabled){var b$y=this.parent;b$y&&(isNaN(b$M.centerX)?isNaN(b$M.left)?isNaN(b$M.right)||(this.x=Math.round(b$y.width-this.displayWidth-b$M.right+this.pivotX*this.scaleX)):(this.x=Math.round(b$M.left+this.pivotX*this.scaleX),isNaN(b$M.right)||(this.width=(b$y._width-b$M.left-b$M.right)/(this.scaleX||.01))):this.x=Math.round(.5*(b$y.width-this.displayWidth)+b$M.centerX+this.pivotX*this.scaleX))}},b$i.resetLayoutY=function(){var b$M=this._layout;if(isNaN(b$M.anchorY)||(this.pivotY=b$M.anchorY*this.height),this.layoutEnabled){var b$y=this.parent;b$y&&(isNaN(b$M.centerY)?isNaN(b$M.top)?isNaN(b$M.bottom)||(this.y=Math.round(b$y.height-this.displayHeight-b$M.bottom+this.pivotY*this.scaleY)):(this.y=Math.round(b$M.top+this.pivotY*this.scaleY),isNaN(b$M.bottom)||(this.height=(b$y._height-b$M.top-b$M.bottom)/(this.scaleY||.01))):this.y=Math.round(.5*(b$y.height-this.displayHeight)+b$M.centerY+this.pivotY*this.scaleY))}},b$i.onMouseOver=function(b$M){b$J.stage.event("showtip",this._toolTip)},b$i.onMouseOut=function(b$M){b$J.stage.event("hidetip",this._toolTip)},b$S(0,b$i,"displayWidth",function(){return this.width*this.scaleX}),b$S(0,b$i,"width",function(){return this._width?this._width:this.measureWidth},function(b$M){this._width!=b$M&&(this._width=b$M,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerX)&&isNaN(this._layout.right)&&isNaN(this._layout.anchorX)||this.resetLayoutX())}),b$S(0,b$i,"measureWidth",function(){var b$M=0;this.commitMeasure();for(var b$y=this.numChildren-1;-1<b$y;b$y--){var b$i=this.getChildAt(b$y);b$i.visible&&(b$M=Math.max(b$i.x+b$i.width*b$i.scaleX,b$M))}return b$M}),b$S(0,b$i,"displayHeight",function(){return this.height*this.scaleY}),b$S(0,b$i,"height",function(){return this._height?this._height:this.measureHeight},function(b$M){this._height!=b$M&&(this._height=b$M,this.conchModel&&this.conchModel.size(this._width,this._height),this.callLater(this.changeSize),!this._layout.enable||isNaN(this._layout.centerY)&&isNaN(this._layout.bottom)&&isNaN(this._layout.anchorY)||this.resetLayoutY())}),b$S(0,b$i,"dataSource",function(){return this._dataSource},function(b$M){for(var b$y in this._dataSource=b$M,this._dataSource)this.hasOwnProperty(b$y)&&"function"!=typeof this[b$y]&&(this[b$y]=this._dataSource[b$y])}),b$S(0,b$i,"scaleY",b$y.prototype._$get_scaleY,function(b$M){b$J.superGet(b$A,this,"scaleY")!=b$M&&(b$J.superSet(b$A,this,"scaleY",b$M),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutY())}),b$S(0,b$i,"measureHeight",function(){var b$M=0;this.commitMeasure();for(var b$y=this.numChildren-1;-1<b$y;b$y--){var b$i=this.getChildAt(b$y);b$i.visible&&(b$M=Math.max(b$i.y+b$i.height*b$i.scaleY,b$M))}return b$M}),b$S(0,b$i,"scaleX",b$y.prototype._$get_scaleX,function(b$M){b$J.superGet(b$A,this,"scaleX")!=b$M&&(b$J.superSet(b$A,this,"scaleX",b$M),this.callLater(this.changeSize),this._layout.enable&&this.resetLayoutX())}),b$S(0,b$i,"top",function(){return this._layout.top},function(b$M){b$M!=this._layout.top&&(this.getLayout().top=b$M,this._setLayoutEnabled(!0)),this.resetLayoutY()}),b$S(0,b$i,"bottom",function(){return this._layout.bottom},function(b$M){b$M!=this._layout.bottom&&(this.getLayout().bottom=b$M,this._setLayoutEnabled(!0)),this.resetLayoutY()}),b$S(0,b$i,"left",function(){return this._layout.left},function(b$M){b$M!=this._layout.left&&(this.getLayout().left=b$M,this._setLayoutEnabled(!0)),this.resetLayoutX()}),b$S(0,b$i,"right",function(){return this._layout.right},function(b$M){b$M!=this._layout.right&&(this.getLayout().right=b$M,this._setLayoutEnabled(!0)),this.resetLayoutX()}),b$S(0,b$i,"centerX",function(){return this._layout.centerX},function(b$M){b$M!=this._layout.centerX&&(this.getLayout().centerX=b$M,this._setLayoutEnabled(!0)),this.resetLayoutX()}),b$S(0,b$i,"centerY",function(){return this._layout.centerY},function(b$M){b$M!=this._layout.centerY&&(this.getLayout().centerY=b$M,this._setLayoutEnabled(!0)),this.resetLayoutY()}),b$S(0,b$i,"anchorX",function(){return this._layout.anchorX},function(b$M){b$M!=this._layout.anchorX&&(this.getLayout().anchorX=b$M,this._setLayoutEnabled(!0)),this.resetLayoutX()}),b$S(0,b$i,"anchorY",function(){return this._layout.anchorY},function(b$M){b$M!=this._layout.anchorY&&(this.getLayout().anchorY=b$M,this._setLayoutEnabled(!0)),this.resetLayoutY()}),b$S(0,b$i,"tag",function(){return this._tag},function(b$M){this._tag=b$M}),b$S(0,b$i,"toolTip",function(){return this._toolTip},function(b$M){this._toolTip!=b$M&&(null!=(this._toolTip=b$M)?(this.on("mouseover",this,this.onMouseOver),this.on("mouseout",this,this.onMouseOut)):(this.off("mouseover",this,this.onMouseOver),this.off("mouseout",this,this.onMouseOut)))}),b$S(0,b$i,"comXml",function(){return this._comXml},function(b$M){this._comXml=b$M}),b$S(0,b$i,"gray",function(){return this._gray},function(b$M){b$M!==this._gray&&(this._gray=b$M,b$a.gray(this,b$M))}),b$S(0,b$i,"disabled",function(){return this._disabled},function(b$M){b$M!==this._disabled&&(this.gray=this._disabled=b$M,this.mouseEnabled=!b$M)}),b$M}(b$A)),b$s=function(b$M){function b$y(){this.lockLayer=null,this.popupEffect=function(b$M){b$M.scale(1,1),b$U.from(b$M,{x:b$J.stage.width/2,y:b$J.stage.height/2,scaleX:0,scaleY:0},300,b$K.backOut,b$d.create(this,this.doOpen,[b$M]))},this.closeEffect=function(b$M,b$y){b$U.to(b$M,{x:b$J.stage.width/2,y:b$J.stage.height/2,scaleX:0,scaleY:0},300,b$K.strongOut,b$d.create(this,this.doClose,[b$M,b$y]))},b$y.__super.call(this),this.maskLayer=new b$A,this.popupEffectHandler=b$d.create(this,this.popupEffect,null,!1),this.closeEffectHandler=b$d.create(this,this.closeEffect,null,!1),this.mouseEnabled=this.maskLayer.mouseEnabled=!0,this.zOrder=1e3,b$J.stage.addChild(this),b$J.stage.on("resize",this,this._onResize),b$T.closeDialogOnSide&&this.maskLayer.on("click",this,this._closeOnSide),this._onResize(null)}b$f(b$y,"laya.ui.DialogManager",b$A);var b$i=b$y.prototype;return b$i._closeOnSide=function(){var b$M=this.getChildAt(this.numChildren-1);b$M instanceof laya.ui.Dialog&&b$M.close("side")},b$i.setLockView=function(b$M){this.lockLayer||(this.lockLayer=new b$D,this.lockLayer.mouseEnabled=!0,this.lockLayer.size(b$J.stage.width,b$J.stage.height)),this.lockLayer.removeChildren(),b$M&&(b$M.centerX=b$M.centerY=0,this.lockLayer.addChild(b$M))},b$i._onResize=function(b$M){var b$y=this.maskLayer.width=b$J.stage.width,b$i=this.maskLayer.height=b$J.stage.height;this.lockLayer&&this.lockLayer.size(b$y,b$i),this.maskLayer.graphics.clear(),this.maskLayer.graphics.drawRect(0,0,b$y,b$i,b$T.popupBgColor),this.maskLayer.alpha=b$T.popupBgAlpha;for(var b$H=this.numChildren-1;-1<b$H;b$H--){var b$S=this.getChildAt(b$H);b$S.popupCenter&&this._centerDialog(b$S)}},b$i._centerDialog=function(b$M){b$M.x=Math.round((b$J.stage.width-b$M.width>>1)+b$M.pivotX),b$M.y=Math.round((b$J.stage.height-b$M.height>>1)+b$M.pivotY)},b$i.open=function(b$M,b$y,b$i){void 0===b$y&&(b$y=!1),void 0===b$i&&(b$i=!1),b$y&&this._closeAll(),b$M.popupCenter&&this._centerDialog(b$M),this.addChild(b$M),(b$M.isModal||this._$P.hasZorder)&&this.timer.callLater(this,this._checkMask),b$i&&null!=b$M.popupEffect?b$M.popupEffect.runWith(b$M):this.doOpen(b$M),this.event("open")},b$i.doOpen=function(b$M){b$M.onOpened()},b$i.lock=function(b$M){this.lockLayer&&(b$M?this.addChild(this.lockLayer):this.lockLayer.removeSelf())},b$i.close=function(b$M,b$y,b$i){void 0===b$i&&(b$i=!1),b$i&&null!=b$M.closeEffect?b$M.closeEffect.runWith([b$M,b$y]):this.doClose(b$M,b$y),this.event("close")},b$i.doClose=function(b$M,b$y){b$M.removeSelf(),b$M.isModal&&this._checkMask(),b$M.closeHandler&&b$M.closeHandler.runWith(b$y),b$M.onClosed(b$y)},b$i.closeAll=function(){this._closeAll(),this.event("close")},b$i._closeAll=function(){for(var b$M=this.numChildren-1;-1<b$M;b$M--){var b$y=this.getChildAt(b$M);b$y&&null!=b$y.close&&this.doClose(b$y)}},b$i.getDialogsByGroup=function(b$M){for(var b$y=[],b$i=this.numChildren-1;-1<b$i;b$i--){var b$H=this.getChildAt(b$i);b$H&&b$H.group===b$M&&b$y.push(b$H)}return b$y},b$i.closeByGroup=function(b$M){for(var b$y=[],b$i=this.numChildren-1;-1<b$i;b$i--){var b$H=this.getChildAt(b$i);b$H&&b$H.group===b$M&&(b$H.close(),b$y.push(b$H))}return b$y},b$i._checkMask=function(){this.maskLayer.removeSelf();for(var b$M=this.numChildren-1;-1<b$M;b$M--){var b$y=this.getChildAt(b$M);if(b$y&&b$y.isModal)return void this.addChildAt(this.maskLayer,b$M)}},b$y}(),b$D=function(b$M){function b$y(){b$y.__super.call(this)}b$f(b$y,"laya.ui.Box",b$M);var b$i=b$y.prototype;return b$J.imps(b$i,{"laya.ui.IBox":!0}),b$S(0,b$i,"dataSource",b$M.prototype._$get_dataSource,function(b$M){for(var b$y in this._dataSource=b$M){var b$i=this.getChildByName(b$y);b$i?b$i.dataSource=b$M[b$y]:this.hasOwnProperty(b$y)&&"function"!=typeof this[b$y]&&(this[b$y]=b$M[b$y])}}),b$y}(b$e),b$z=function(b$y){function b$i(b$M,b$y){this.toggle=!1,this._bitmap=null,this._text=null,this._strokeColors=null,this._state=0,this._selected=!1,this._skin=null,this._autoSize=!0,this._sources=null,this._clickHandler=null,this._stateChanged=!1,b$i.__super.call(this),this._labelColors=b$n.buttonLabelColors,this._stateNum=b$n.buttonStateNum,void 0===b$y&&(b$y=""),this.skin=b$M,this.label=b$y}b$f(b$i,"laya.ui.Button",b$y);var b$M=b$i.prototype;return b$J.imps(b$M,{"laya.ui.ISelect":!0}),b$M.destroy=function(b$M){b$v.clearCache(this,this._skin),b$v.clearObject(this,this._weakKey),void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,b$M),this._bitmap&&this._bitmap.destroy(),this._text&&this._text.destroy(b$M),this._bitmap=null,this._text=null,this._clickHandler=null,this._labelColors=this._sources=this._strokeColors=null},b$M.createChildren=function(){this.graphics=this._bitmap=new b$m},b$M.createText=function(){this._text||(this._text=new b$G,this._text.overflow=b$G.HIDDEN,this._text.align="center",this._text.valign="middle",this._text.width=this._width,this._text.height=this._height)},b$M.initialize=function(){1!==this._mouseEnableState&&(this.mouseEnabled=!0,this._setBit(2,!0)),this._createListener("mouseover",this,this.onMouse,null,!1,!1),this._createListener("mouseout",this,this.onMouse,null,!1,!1),this._createListener("mousedown",this,this.onMouse,null,!1,!1),this._createListener("mouseup",this,this.onMouse,null,!1,!1),this._createListener("click",this,this.onMouse,null,!1,!1)},b$M.onMouse=function(b$M){if(!1!==this.toggle||!this._selected)return"click"===b$M.type?(this.toggle&&(this.selected=!this._selected),void(this._clickHandler&&this._clickHandler.run())):void(!this._selected&&(this.state=b$i.stateMap[b$M.type]))},b$M.changeClips=function(){var b$M=b$v.getRes(this._skin);if(b$M&&this._skin&&""!=this._skin){b$v.clearObject(this,this._weakKey);var b$y=b$M.sourceWidth,b$i=b$M.sourceHeight/this._stateNum;b$M.$_GID||(b$M.$_GID=b$Q.getGID());var b$H=b$M.$_GID+"-"+this._stateNum,b$S=b$v.findObject(b$H);if(b$Q.isOkTextureList(b$S)||(b$S=null),b$S)this._weakKey=b$H,b$v.keepObject(this,this._weakKey),this._sources=b$S;else{if(this._sources=[],1===this._stateNum)this._sources.push(b$M);else for(var b$f=0;b$f<this._stateNum;b$f++){var b$V=b$I.createFromTexture(b$M,0,b$i*b$f,b$y,b$i);if(b$M.alphaTexture){var b$K=b$M.width/b$M.alphaTexture.width;b$V.alphaTexture=b$I.createFromTexture(b$M.alphaTexture,0/b$K,b$i*b$f/b$K,b$y/b$K,b$i/b$K)}this._sources.push(b$V)}b$v.saveObject(b$H,this._sources),this._weakKey=b$H,b$v.keepObject(this,this._weakKey)}this._autoSize?(this._bitmap.width=this._width||b$y,this._bitmap.height=this._height||b$i,this._text&&(this._text.width=this._bitmap.width,this._text.height=this._bitmap.height)):this._text&&(this._text.x=b$y)}else console.warn("lose skin ",this._skin,this.name,this.__className)},b$M.changeState=function(){this._stateChanged=!1,this.runCallLater(this.changeClips);var b$M=this._state<this._stateNum?this._state:this._stateNum-1;this._sources&&(this._bitmap.source=this._sources[b$M]),this.label&&(this._text.color=this._labelColors[b$M],this._strokeColors&&(this._text.strokeColor=this._strokeColors[b$M]))},b$M._setStateChanged=function(){this._stateChanged||(this._stateChanged=!0,this.callLater(this.changeState))},b$S(0,b$M,"labelStrokeColor",function(){return this.createText(),this._text.strokeColor},function(b$M){this.createText(),this._text.strokeColor=b$M}),b$S(0,b$M,"measureHeight",function(){return this.runCallLater(this.changeClips),this._text?Math.max(this._bitmap.height,this._text.height):this._bitmap.height}),b$S(0,b$M,"skin",function(){return this._skin},function(b$M){this._skin!=b$M&&(b$v.clearCache(this,this._skin),this._skin=b$M,b$v.keepCache(this,this._skin),this.callLater(this.changeClips),this._setStateChanged())}),b$S(0,b$M,"state",function(){return this._state},function(b$M){this._state!=b$M&&(this._state=b$M,this._setStateChanged())}),b$S(0,b$M,"text",function(){return this.createText(),this._text}),b$S(0,b$M,"stateNum",function(){return this._stateNum},function(b$M){"string"==typeof b$M&&(b$M=parseInt(b$M)),this._stateNum!=b$M&&(this._stateNum=b$M<1?1:3<b$M?3:b$M,this.callLater(this.changeClips))}),b$S(0,b$M,"strokeColors",function(){return this._strokeColors?this._strokeColors.join(","):""},function(b$M){this._strokeColors=b$a.fillArray(b$n.buttonLabelColors,b$M,String),this._setStateChanged()}),b$S(0,b$M,"labelColors",function(){return this._labelColors.join(",")},function(b$M){this._labelColors=b$a.fillArray(b$n.buttonLabelColors,b$M,String),this._setStateChanged()}),b$S(0,b$M,"measureWidth",function(){return this.runCallLater(this.changeClips),this._autoSize?this._bitmap.width:(this.runCallLater(this.changeState),this._bitmap.width+(this._text?this._text.width:0))}),b$S(0,b$M,"label",function(){return this._text?this._text.text:null},function(b$M){(this._text||b$M)&&(this.createText(),this._text.text!=b$M&&(b$M&&!this._text.parent&&this.addChild(this._text),this._text.text=(b$M+"").replace(/\\n/g,"\n"),this._setStateChanged()))}),b$S(0,b$M,"selected",function(){return this._selected},function(b$M){this._selected!=b$M&&(this._selected=b$M,this.state=this._selected?2:0,this.event("change"))}),b$S(0,b$M,"labelPadding",function(){return this.createText(),this._text.padding.join(",")},function(b$M){this.createText(),this._text.padding=b$a.fillArray(b$n.labelPadding,b$M,Number)}),b$S(0,b$M,"labelSize",function(){return this.createText(),this._text.fontSize},function(b$M){this.createText(),this._text.fontSize=b$M}),b$S(0,b$M,"labelStroke",function(){return this.createText(),this._text.stroke},function(b$M){this.createText(),this._text.stroke=b$M}),b$S(0,b$M,"labelBold",function(){return this.createText(),this._text.bold},function(b$M){this.createText(),this._text.bold=b$M}),b$S(0,b$M,"labelFont",function(){return this.createText(),this._text.font},function(b$M){this.createText(),this._text.font=b$M}),b$S(0,b$M,"labelAlign",function(){return this.createText(),this._text.align},function(b$M){this.createText(),this._text.align=b$M}),b$S(0,b$M,"clickHandler",function(){return this._clickHandler},function(b$M){this._clickHandler=b$M}),b$S(0,b$M,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(b$M){this._bitmap.sizeGrid=b$a.fillArray(b$n.defaultSizeGrid,b$M,Number)}),b$S(0,b$M,"width",b$y.prototype._$get_width,function(b$M){b$J.superSet(b$e,this,"width",b$M),this._autoSize&&(this._bitmap.width=b$M,this._text&&(this._text.width=b$M))}),b$S(0,b$M,"height",b$y.prototype._$get_height,function(b$M){b$J.superSet(b$e,this,"height",b$M),this._autoSize&&(this._bitmap.height=b$M,this._text&&(this._text.height=b$M))}),b$S(0,b$M,"dataSource",b$y.prototype._$get_dataSource,function(b$M){"number"==typeof(this._dataSource=b$M)||"string"==typeof b$M?this.label=b$M+"":b$J.superSet(b$e,this,"dataSource",b$M)}),b$S(0,b$M,"iconOffset",function(){return this._bitmap._offset?this._bitmap._offset.join(","):null},function(b$M){this._bitmap._offset=b$M?b$a.fillArray([1,1],b$M,Number):[]}),b$H(b$i,["stateMap",function(){return this.stateMap={mouseup:0,mouseover:1,mousedown:2,mouseout:0}}]),b$i}(b$e),b$w=function(b$y){function b$H(b$M,b$y,b$i){this._sources=null,this._bitmap=null,this._skin=null,this._clipX=1,this._clipY=1,this._clipWidth=0,this._clipHeight=0,this._autoPlay=!1,this._interval=50,this._complete=null,this._isPlaying=!1,this._index=0,this._clipChanged=!1,this._group=null,this._toIndex=-1,b$H.__super.call(this),void 0===b$y&&(b$y=1),void 0===b$i&&(b$i=1),this._clipX=b$y,this._clipY=b$i,this.skin=b$M}b$f(b$H,"laya.ui.Clip",b$y);var b$M=b$H.prototype;return b$M.destroy=function(b$M){b$v.clearCache(this,this._skin),b$v.clearObject(this,this._weakKey),void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,this._sources=null},b$M.dispose=function(){this.destroy(!0),b$J.loader.clearRes(this._skin)},b$M.createChildren=function(){this.graphics=this._bitmap=new b$m},b$M._onDisplay=function(b$M){this._isPlaying?this._displayedInStage?this.play():this.stop():this._autoPlay&&this.play()},b$M.changeClip=function(){if(this._clipChanged=!1,this._skin){var b$M=b$v.getRes(this._skin);b$M?this.loadComplete(this._skin,b$M):b$J.loader.load(this._skin,b$d.create(this,this.loadComplete,[this._skin]))}},b$M.loadComplete=function(b$M,b$y){if(b$M===this._skin&&b$y){b$v.clearObject(this,this._weakKey);var b$i=this._clipWidth||Math.ceil(b$y.sourceWidth/this._clipX),b$H=this._clipHeight||Math.ceil(b$y.sourceHeight/this._clipY),b$S=this._skin+b$i+b$H,b$f=b$v.findObject(b$S);if(b$Q.isOkTextureList(b$f)||(b$f=null),b$f)this._weakKey=b$S,b$v.keepObject(this,this._weakKey),this._sources=b$f;else{this._sources=[];for(var b$V=0;b$V<this._clipY;b$V++)for(var b$K=0;b$K<this._clipX;b$K++){var b$k=b$I.createFromTexture(b$y,b$i*b$K,b$H*b$V,b$i,b$H);if(b$y.alphaTexture){var b$X=b$y.width/b$y.alphaTexture.width;b$k.alphaTexture=b$I.createFromTexture(b$y.alphaTexture,b$i*b$K/b$X,b$H*b$V/b$X,b$i/b$X,b$H/b$X)}this._sources.push(b$k)}b$v.saveObject(b$S,this._sources),this._weakKey=b$S,b$v.keepObject(this,this._weakKey)}this.index=this._index,this.event("loaded"),this.onCompResize()}},b$M.play=function(b$M,b$y){void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=-1),this._isPlaying=!0,this.index=b$M,this._toIndex=b$y,this._index++,b$J.timer.loop(this.interval,this,this._loop),this.on("display",this,this._onDisplay),this.on("undisplay",this,this._onDisplay)},b$M._loop=function(){this._style.visible&&this._sources&&(this._index++,-1<this._toIndex&&this._index>=this._toIndex?this.stop():this._index>=this._sources.length&&(this._index=0),this.index=this._index)},b$M.stop=function(){this._isPlaying=!1,b$J.timer.clear(this,this._loop),this.event("complete")},b$M._setClipChanged=function(){this._clipChanged||(this._clipChanged=!0,this.callLater(this.changeClip))},b$S(0,b$M,"interval",function(){return this._interval},function(b$M){this._interval!=b$M&&(this._interval=b$M,this._isPlaying&&this.play())}),b$S(0,b$M,"skin",function(){return this._skin},function(b$M){this._skin!=b$M&&(b$v.clearCache(this,this._skin),(this._skin=b$M)?(b$v.keepCache(this,this._skin),this._setClipChanged()):this._bitmap.source=null)}),b$S(0,b$M,"sources",function(){return this._sources},function(b$M){this._sources=b$M,this.index=this._index,this.event("loaded")}),b$S(0,b$M,"clipX",function(){return this._clipX},function(b$M){this._clipX=b$M||1,this._setClipChanged()}),b$S(0,b$M,"clipY",function(){return this._clipY},function(b$M){this._clipY=b$M||1,this._setClipChanged()}),b$S(0,b$M,"total",function(){return this.runCallLater(this.changeClip),this._sources?this._sources.length:0}),b$S(0,b$M,"clipWidth",function(){return this._clipWidth},function(b$M){this._clipWidth=b$M,this._setClipChanged()}),b$S(0,b$M,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(b$M){this._bitmap.sizeGrid=b$a.fillArray(b$n.defaultSizeGrid,b$M,Number)}),b$S(0,b$M,"group",function(){return this._group},function(b$M){b$M&&this._skin&&b$v.setGroup(this._skin,b$M),this._group=b$M}),b$S(0,b$M,"clipHeight",function(){return this._clipHeight},function(b$M){this._clipHeight=b$M,this._setClipChanged()}),b$S(0,b$M,"width",b$y.prototype._$get_width,function(b$M){b$J.superSet(b$e,this,"width",b$M),this._bitmap.width=b$M}),b$S(0,b$M,"height",b$y.prototype._$get_height,function(b$M){b$J.superSet(b$e,this,"height",b$M),this._bitmap.height=b$M}),b$S(0,b$M,"measureWidth",function(){return this.runCallLater(this.changeClip),this._bitmap.width}),b$S(0,b$M,"measureHeight",function(){return this.runCallLater(this.changeClip),this._bitmap.height}),b$S(0,b$M,"index",function(){return this._index},function(b$M){this._index=b$M,this._bitmap&&this._sources&&(this._bitmap.source=this._sources[b$M]),this.event("change")}),b$S(0,b$M,"autoPlay",function(){return this._autoPlay},function(b$M){this._autoPlay!=b$M&&((this._autoPlay=b$M)?this.play():this.stop())}),b$S(0,b$M,"isPlaying",function(){return this._isPlaying},function(b$M){this._isPlaying=b$M}),b$S(0,b$M,"dataSource",b$y.prototype._$get_dataSource,function(b$M){"number"==typeof(this._dataSource=b$M)&&Math.floor(b$M)==b$M||"string"==typeof b$M?this.index=parseInt(b$M):b$J.superSet(b$e,this,"dataSource",b$M)}),b$S(0,b$M,"bitmap",function(){return this._bitmap}),b$H}(b$e),b$q=function(b$y){function b$M(){this.changeHandler=null,this._gridSize=11,this._bgColor="#ffffff",this._borderColor="#000000",this._inputColor="#000000",this._inputBgColor="#efefef",this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=[],this._selectedColor="#000000",this._panelChanged=!1,b$M.__super.call(this)}b$f(b$M,"laya.ui.ColorPicker",b$y);var b$i=b$M.prototype;return b$i.destroy=function(b$M){void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,b$M),this._colorPanel&&this._colorPanel.destroy(b$M),this._colorButton&&this._colorButton.destroy(b$M),this._colorPanel=null,this._colorTiles=null,this._colorBlock=null,this._colorInput=null,this._colorButton=null,this._colors=null,this.changeHandler=null},b$i.createChildren=function(){this.addChild(this._colorButton=new b$z),this._colorPanel=new b$D,this._colorPanel.size(230,166),this._colorPanel.addChild(this._colorTiles=new b$A),this._colorPanel.addChild(this._colorBlock=new b$A),this._colorPanel.addChild(this._colorInput=new b$P)},b$i.initialize=function(){this._colorButton.on("click",this,this.onColorButtonClick),this._colorBlock.pos(5,5),this._colorInput.pos(60,5),this._colorInput.size(60,20),this._colorInput.on("change",this,this.onColorInputChange),this._colorInput.on("keydown",this,this.onColorFieldKeyDown),this._colorTiles.pos(5,30),this._colorTiles.on("mousemove",this,this.onColorTilesMouseMove),this._colorTiles.on("click",this,this.onColorTilesClick),this._colorTiles.size(20*this._gridSize,12*this._gridSize),this._colorPanel.on("mousedown",this,this.onPanelMouseDown),this.bgColor=this._bgColor},b$i.onPanelMouseDown=function(b$M){b$M.stopPropagation()},b$i.changePanel=function(){this._panelChanged=!1;var b$M=this._colorPanel.graphics;b$M.clear(),b$M.drawRect(0,0,230,166,this._bgColor,this._borderColor),this.drawBlock(this._selectedColor),this._colorInput.borderColor=this._borderColor,this._colorInput.bgColor=this._inputBgColor,this._colorInput.color=this._inputColor,(b$M=this._colorTiles.graphics).clear();for(var b$y=[0,3355443,6710886,10066329,13421772,16777215,16711680,65280,255,16776960,65535,16711935],b$i=0;b$i<12;b$i++)for(var b$H=0;b$H<20;b$H++){var b$S=0;b$S=0===b$H?b$y[b$i]:1===b$H?0:51*(((3*b$i+b$H/6)%3<<0)+3*(b$i/6<<0))<<16|b$H%6*51<<8|(b$i<<0)%6*51;var b$f=b$a.toColor(b$S);this._colors.push(b$f);var b$V=b$H*this._gridSize,b$K=b$i*this._gridSize;b$M.drawRect(b$V,b$K,this._gridSize,this._gridSize,b$f,"#000000")}},b$i.onColorButtonClick=function(b$M){this._colorPanel.parent?this.close():this.open()},b$i.open=function(){var b$M=this.localToGlobal(new b$l),b$y=b$M.x+this._colorPanel.width<=b$J.stage.width?b$M.x:b$J.stage.width-this._colorPanel.width,b$i=b$M.y+this._colorButton.height;b$i=b$i+this._colorPanel.height<=b$J.stage.height?b$i:b$M.y-this._colorPanel.height,this._colorPanel.pos(b$y,b$i),this._colorPanel.zOrder=1001,b$J._currentStage.addChild(this._colorPanel),b$J.stage.on("mousedown",this,this.removeColorBox)},b$i.close=function(){b$J.stage.off("mousedown",this,this.removeColorBox),this._colorPanel.removeSelf()},b$i.removeColorBox=function(b$M){this.close()},b$i.onColorFieldKeyDown=function(b$M){13==b$M.keyCode&&(this._colorInput.text?this.selectedColor=this._colorInput.text:this.selectedColor=null,this.close(),b$M.stopPropagation())},b$i.onColorInputChange=function(b$M){this._colorInput.text?this.drawBlock(this._colorInput.text):this.drawBlock("#FFFFFF")},b$i.onColorTilesClick=function(b$M){this.selectedColor=this.getColorByMouse(),this.close()},b$i.onColorTilesMouseMove=function(b$M){this._colorInput.focus=!1;var b$y=this.getColorByMouse();this._colorInput.text=b$y,this.drawBlock(b$y)},b$i.getColorByMouse=function(){var b$M=this._colorTiles.getMousePoint(),b$y=Math.floor(b$M.x/this._gridSize),b$i=Math.floor(b$M.y/this._gridSize);return this._colors[20*b$i+b$y]},b$i.drawBlock=function(b$M){var b$y=this._colorBlock.graphics;b$y.clear();var b$i=b$M||"#ffffff";b$y.drawRect(0,0,50,20,b$i,this._borderColor),b$M||b$y.drawLine(0,0,50,20,"#ff0000")},b$i.changeColor=function(){var b$M=this.graphics;b$M.clear();var b$y=this._selectedColor||"#000000";b$M.drawRect(0,0,this._colorButton.width,this._colorButton.height,b$y)},b$i._setPanelChanged=function(){this._panelChanged||(this._panelChanged=!0,this.callLater(this.changePanel))},b$S(0,b$i,"inputBgColor",function(){return this._inputBgColor},function(b$M){this._inputBgColor=b$M,this._setPanelChanged()}),b$S(0,b$i,"selectedColor",function(){return this._selectedColor},function(b$M){this._selectedColor!=b$M&&(this._selectedColor=this._colorInput.text=b$M,this.drawBlock(b$M),this.changeColor(),this.changeHandler&&this.changeHandler.runWith(this._selectedColor),this.event("change",b$k.EMPTY.setTo("change",this,this)))}),b$S(0,b$i,"skin",function(){return this._colorButton.skin},function(b$M){this._colorButton.skin=b$M,this.changeColor()}),b$S(0,b$i,"bgColor",function(){return this._bgColor},function(b$M){this._bgColor=b$M,this._setPanelChanged()}),b$S(0,b$i,"borderColor",function(){return this._borderColor},function(b$M){this._borderColor=b$M,this._setPanelChanged()}),b$S(0,b$i,"inputColor",function(){return this._inputColor},function(b$M){this._inputColor=b$M,this._setPanelChanged()}),b$M}(b$e),b$t=function(b$y){function b$i(b$M,b$y){this._visibleNum=6,this._button=null,this._list=null,this._isOpen=!1,this._itemSize=12,this._labels=[],this._selectedIndex=-1,this._selectHandler=null,this._itemHeight=NaN,this._listHeight=NaN,this._listChanged=!1,this._itemChanged=!1,this._scrollBarSkin=null,this._isCustomList=!1,this.itemRender=null,b$i.__super.call(this),this._itemColors=b$n.comboBoxItemColors,this.skin=b$M,this.labels=b$y}b$f(b$i,"laya.ui.ComboBox",b$y);var b$M=b$i.prototype;return b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,b$M),this._button&&this._button.destroy(b$M),this._list&&this._list.destroy(b$M),this._button=null,this._list=null,this._itemColors=null,this._labels=null,this._selectHandler=null},b$M.createChildren=function(){this.addChild(this._button=new b$z),this._button.text.align="left",this._button.labelPadding="0,0,0,5",this._button.on("mousedown",this,this.onButtonMouseDown)},b$M._createList=function(){this._list=new b$N,this._scrollBarSkin&&(this._list.vScrollBarSkin=this._scrollBarSkin),this._setListEvent(this._list)},b$M._setListEvent=function(b$M){this._list.selectEnable=!0,this._list.on("mousedown",this,this.onListDown),this._list.mouseHandler=b$d.create(this,this.onlistItemMouse,null,!1),this._list.scrollBar&&this._list.scrollBar.on("mousedown",this,this.onScrollBarDown)},b$M.onListDown=function(b$M){b$M.stopPropagation()},b$M.onScrollBarDown=function(b$M){b$M.stopPropagation()},b$M.onButtonMouseDown=function(b$M){this.callLater(this.switchTo,[!this._isOpen])},b$M.changeList=function(){this._listChanged=!1;var b$M=this.width-2,b$y=this._itemColors[2];this._itemHeight=this._itemSize+6,this._list.itemRender=this.itemRender||{type:"Box",child:[{type:"Label",props:{name:"label",x:1,padding:"3,3,3,3",width:b$M,height:this._itemHeight,fontSize:this._itemSize,color:b$y}}]},this._list.repeatY=this._visibleNum,this._list.refresh()},b$M.onlistItemMouse=function(b$M,b$y){var b$i=b$M.type;if("mouseover"===b$i||"mouseout"===b$i){if(this._isCustomList)return;var b$H=this._list.getCell(b$y);if(!b$H)return;var b$S=b$H.getChildByName("label");b$S&&("mouseover"===b$i?(b$S.bgColor=this._itemColors[0],b$S.color=this._itemColors[1]):(b$S.bgColor=null,b$S.color=this._itemColors[2]))}else"click"===b$i&&(this.selectedIndex=b$y,this.isOpen=!1)},b$M.switchTo=function(b$M){this.isOpen=b$M},b$M.changeOpen=function(){this.isOpen=!this._isOpen},b$M.changeItem=function(){if(this._itemChanged=!1,this._listHeight=0<this._labels.length?Math.min(this._visibleNum,this._labels.length)*this._itemHeight:this._itemHeight,!this._isCustomList){var b$M=this._list.graphics;b$M.clear(),b$M.drawRect(0,0,this.width-1,this._listHeight,this._itemColors[4],this._itemColors[3])}for(var b$y=this._list.array||[],b$i=b$y.length=0,b$H=this._labels.length;b$i<b$H;b$i++)b$y.push({label:this._labels[b$i]});this._list.height=this._listHeight,this._list.array=b$y},b$M.changeSelected=function(){this._button.label=this.selectedLabel},b$M._onStageMouseWheel=function(b$M){this._list&&!this._list.contains(b$M.target)&&this.removeList(null)},b$M.removeList=function(b$M){b$J.stage.off("mousedown",this,this.removeList),b$J.stage.off("mousewheel",this,this._onStageMouseWheel),this.isOpen=!1},b$S(0,b$M,"selectedIndex",function(){return this._selectedIndex},function(b$M){this._selectedIndex!=b$M&&(this._selectedIndex=b$M,0<this._labels.length?this.changeSelected():this.callLater(this.changeSelected),this.event("change",[b$k.EMPTY.setTo("change",this,this)]),this._selectHandler&&this._selectHandler.runWith(this._selectedIndex))}),b$S(0,b$M,"measureHeight",function(){return this._button.height}),b$S(0,b$M,"skin",function(){return this._button.skin},function(b$M){this._button.skin!=b$M&&(this._button.skin=b$M,this._listChanged=!0)}),b$S(0,b$M,"measureWidth",function(){return this._button.width}),b$S(0,b$M,"width",b$y.prototype._$get_width,function(b$M){b$J.superSet(b$e,this,"width",b$M),this._button.width=this._width,this._itemChanged=!0,this._listChanged=!0}),b$S(0,b$M,"selectedLabel",function(){return-1<this._selectedIndex&&this._selectedIndex<this._labels.length?this._labels[this._selectedIndex]:null},function(b$M){this.selectedIndex=this._labels.indexOf(b$M)}),b$S(0,b$M,"labels",function(){return this._labels.join(",")},function(b$M){0<this._labels.length&&(this.selectedIndex=-1),b$M?this._labels=b$M.split(","):this._labels.length=0,this._itemChanged=!0}),b$S(0,b$M,"height",b$y.prototype._$get_height,function(b$M){b$J.superSet(b$e,this,"height",b$M),this._button.height=this._height}),b$S(0,b$M,"selectHandler",function(){return this._selectHandler},function(b$M){this._selectHandler=b$M}),b$S(0,b$M,"visibleNum",function(){return this._visibleNum},function(b$M){this._visibleNum=b$M,this._listChanged=!0}),b$S(0,b$M,"labelBold",function(){return this._button.text.bold},function(b$M){this._button.text.bold=b$M}),b$S(0,b$M,"itemColors",function(){return String(this._itemColors)},function(b$M){this._itemColors=b$a.fillArray(this._itemColors,b$M,String),this._listChanged=!0}),b$S(0,b$M,"itemSize",function(){return this._itemSize},function(b$M){this._itemSize=b$M,this._listChanged=!0}),b$S(0,b$M,"scrollBar",function(){return this.list.scrollBar}),b$S(0,b$M,"isOpen",function(){return this._isOpen},function(b$M){if(this._isOpen!=b$M)if(this._isOpen=b$M,this._button.selected=this._isOpen,this._isOpen){this._list||this._createList(),this._listChanged&&!this._isCustomList&&this.changeList(),this._itemChanged&&this.changeItem();var b$y=this.localToGlobal(b$l.TEMP.setTo(0,0)),b$i=b$y.y+this._button.height;b$i=b$i+this._listHeight<=b$J.stage.height?b$i:b$y.y-this._listHeight,this._list.pos(b$y.x,b$i),this._list.zOrder=1001,b$J._currentStage.addChild(this._list),b$J.stage.once("mousedown",this,this.removeList),b$J.stage.on("mousewheel",this,this._onStageMouseWheel),this._list.selectedIndex=this._selectedIndex}else this._list&&this._list.removeSelf()}),b$S(0,b$M,"scrollBarSkin",function(){return this._scrollBarSkin},function(b$M){this._scrollBarSkin=b$M}),b$S(0,b$M,"sizeGrid",function(){return this._button.sizeGrid},function(b$M){this._button.sizeGrid=b$M}),b$S(0,b$M,"button",function(){return this._button}),b$S(0,b$M,"list",function(){return this._list||this._createList(),this._list},function(b$M){b$M&&(b$M.removeSelf(),this._isCustomList=!0,this._list=b$M,this._setListEvent(b$M),this._itemHeight=b$M.getCell(0).height+b$M.spaceY)}),b$S(0,b$M,"dataSource",b$y.prototype._$get_dataSource,function(b$M){"number"==typeof(this._dataSource=b$M)&&Math.floor(b$M)==b$M||"string"==typeof b$M?this.selectedIndex=parseInt(b$M):b$M instanceof Array?this.labels=b$M.join(","):b$J.superSet(b$e,this,"dataSource",b$M)}),b$S(0,b$M,"labelColors",function(){return this._button.labelColors},function(b$M){this._button.labelColors!=b$M&&(this._button.labelColors=b$M)}),b$S(0,b$M,"labelPadding",function(){return this._button.text.padding.join(",")},function(b$M){this._button.text.padding=b$a.fillArray(b$n.labelPadding,b$M,Number)}),b$S(0,b$M,"labelSize",function(){return this._button.text.fontSize},function(b$M){this._button.text.fontSize=b$M}),b$S(0,b$M,"labelFont",function(){return this._button.text.font},function(b$M){this._button.text.font=b$M}),b$S(0,b$M,"stateNum",function(){return this._button.stateNum},function(b$M){this._button.stateNum=b$M}),b$i}(b$e),b$u=function(b$y){function b$i(b$M){this.rollRatio=.95,this.changeHandler=null,this.scaleBar=!0,this.autoHide=!1,this.elasticDistance=0,this.elasticBackTime=500,this.upButton=null,this.downButton=null,this.slider=null,this._scrollSize=1,this._skin=null,this._thumbPercent=1,this._target=null,this._lastPoint=null,this._lastOffset=0,this._checkElastic=!1,this._isElastic=!1,this._value=NaN,this._hide=!1,this._clickOnly=!0,this._offsets=null,b$i.__super.call(this),this._showButtons=b$T.showButtons,this._touchScrollEnable=b$T.touchScrollEnable,this._mouseWheelEnable=b$T.mouseWheelEnable,this.skin=b$M,this.max=1}b$f(b$i,"laya.ui.ScrollBar",b$y);var b$M=b$i.prototype;return b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),this.stopScroll(),this.target=null,b$y.prototype.destroy.call(this,b$M),this.upButton&&this.upButton.destroy(b$M),this.downButton&&this.downButton.destroy(b$M),this.slider&&this.slider.destroy(b$M),this.upButton=this.downButton=null,this.slider=null,this.changeHandler=null,this._offsets=null},b$M.createChildren=function(){this.addChild(this.slider=new b$p),this.addChild(this.upButton=new b$z),this.addChild(this.downButton=new b$z)},b$M.initialize=function(){this.slider.showLabel=!1,this.slider.on("change",this,this.onSliderChange),this.slider.setSlider(0,0,0),this.upButton.on("mousedown",this,this.onButtonMouseDown),this.downButton.on("mousedown",this,this.onButtonMouseDown)},b$M.onSliderChange=function(){this._value!=this.slider.value&&(this.value=this.slider.value)},b$M.onButtonMouseDown=function(b$M){var b$y=b$M.currentTarget===this.upButton;this.slide(b$y),b$J.timer.once(b$n.scrollBarDelayTime,this,this.startLoop,[b$y]),b$J.stage.once("mouseup",this,this.onStageMouseUp)},b$M.startLoop=function(b$M){b$J.timer.frameLoop(1,this,this.slide,[b$M])},b$M.slide=function(b$M){b$M?this.value-=this._scrollSize:this.value+=this._scrollSize},b$M.onStageMouseUp=function(b$M){b$J.timer.clear(this,this.startLoop),b$J.timer.clear(this,this.slide)},b$M.changeScrollBar=function(){this.upButton.visible=this._showButtons,this.downButton.visible=this._showButtons,this._showButtons&&(this.upButton.skin=this._skin.replace(".png","$up.png"),this.downButton.skin=this._skin.replace(".png","$down.png")),this.slider.isVertical?this.slider.y=this._showButtons?this.upButton.height:0:this.slider.x=this._showButtons?this.upButton.width:0,this.resetPositions(),this.repaint()},b$M.changeSize=function(){b$y.prototype.changeSize.call(this),this.repaint(),this.resetPositions(),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this.value)},b$M.resetPositions=function(){this.slider.isVertical?this.slider.height=this.height-(this._showButtons?this.upButton.height+this.downButton.height:0):this.slider.width=this.width-(this._showButtons?this.upButton.width+this.downButton.width:0),this.resetButtonPosition()},b$M.resetButtonPosition=function(){this.slider.isVertical?this.downButton.y=this.slider.y+this.slider.height:this.downButton.x=this.slider.x+this.slider.width},b$M.setScroll=function(b$M,b$y,b$i){this.runCallLater(this.changeSize),this.slider.setSlider(b$M,b$y,b$i),this.slider.bar.visible=0<b$y,!this._hide&&this.autoHide&&(this.visible=!1)},b$M.onTargetMouseWheel=function(b$M){this.value-=b$M.delta*this._scrollSize,this.target=this._target},b$M.onTargetMouseDown=function(b$M){this._clickOnly=!0,this._lastOffset=0,this._checkElastic=!1,this._lastPoint||(this._lastPoint=new b$l),this._lastPoint.setTo(b$J.stage.mouseX,b$J.stage.mouseY),b$J.timer.clear(this,this.tweenMove),b$U.clearTween(this),b$J.stage.once("mouseup",this,this.onStageMouseUp2),b$J.stage.once("mouseout",this,this.onStageMouseUp2),b$J.timer.frameLoop(1,this,this.loop)},b$M.loop=function(){var b$M=b$J.stage.mouseY,b$y=b$J.stage.mouseX;if(this._lastOffset=this.isVertical?b$M-this._lastPoint.y:b$y-this._lastPoint.x,this._clickOnly){if(!(1<Math.abs(this._lastOffset*(this.isVertical?b$J.stage._canvasTransform.getScaleY():b$J.stage._canvasTransform.getScaleX()))))return;this._clickOnly=!1,this._offsets||(this._offsets=[]),this._offsets.length=0,this._target.mouseEnabled=!1,!this.hide&&this.autoHide&&(this.alpha=1,this.visible=!0),this.event("start")}this._offsets.push(this._lastOffset),this._lastPoint.x=b$y,this._lastPoint.y=b$M,0!==this._lastOffset&&(this._checkElastic||(0<this.elasticDistance?this._checkElastic||0==this._lastOffset||(0<this._lastOffset&&this._value<=this.min||this._lastOffset<0&&this._value>=this.max?(this._isElastic=!0,this._checkElastic=!0):this._isElastic=!1):this._checkElastic=!0),this._isElastic?this._value<=this.min?this.value-=this._lastOffset*Math.max(0,1-(this.min-this._value)/this.elasticDistance):this._value>=this.max&&(this.value-=this._lastOffset*Math.max(0,1-(this._value-this.max)/this.elasticDistance)):this.value-=this._lastOffset)},b$M.onStageMouseUp2=function(b$M){if(b$J.stage.off("mouseup",this,this.onStageMouseUp2),b$J.stage.off("mouseout",this,this.onStageMouseUp2),b$J.timer.clear(this,this.loop),!(this._clickOnly&&this._value>=this.min&&this._value<=this.max))if(this._target.mouseEnabled=!0,this._isElastic)this._value<this.min?b$U.to(this,{value:this.min},this.elasticBackTime,b$K.sineOut,b$d.create(this,this.elasticOver)):this._value>this.max&&b$U.to(this,{value:this.max},this.elasticBackTime,b$K.sineOut,b$d.create(this,this.elasticOver));else{if(!this._offsets)return;this._offsets.length<1&&(this._offsets[0]=this.isVertical?b$J.stage.mouseY-this._lastPoint.y:b$J.stage.mouseX-this._lastPoint.x);for(var b$y=0,b$i=Math.min(this._offsets.length,3),b$H=0;b$H<b$i;b$H++)b$y+=this._offsets[this._offsets.length-1-b$H];if(this._lastOffset=b$y/b$i,(b$y=Math.abs(this._lastOffset))<2)return void this.event("end");60<b$y&&(this._lastOffset=0<this._lastOffset?60:-60);var b$S=Math.round(Math.abs(this.elasticDistance*(this._lastOffset/240)));b$J.timer.frameLoop(1,this,this.tweenMove,[b$S])}},b$M.elasticOver=function(){this._isElastic=!1,!this.hide&&this.autoHide&&b$U.to(this,{alpha:0},500),this.event("end")},b$M.tweenMove=function(b$M){this._lastOffset*=this.rollRatio;var b$y=NaN;if(0<b$M&&(0<this._lastOffset&&this.value<=this.min?(this._isElastic=!0,b$y=.5*-(this.min-b$M-this.value),this._lastOffset>b$y&&(this._lastOffset=b$y)):this._lastOffset<0&&this.value>=this.max&&(this._isElastic=!0,b$y=.5*-(this.max+b$M-this.value),this._lastOffset<b$y&&(this._lastOffset=b$y))),this.value-=this._lastOffset,Math.abs(this._lastOffset)<1){if(b$J.timer.clear(this,this.tweenMove),this._isElastic)return void(this._value<this.min?b$U.to(this,{value:this.min},this.elasticBackTime,b$K.sineOut,b$d.create(this,this.elasticOver)):this._value>this.max?b$U.to(this,{value:this.max},this.elasticBackTime,b$K.sineOut,b$d.create(this,this.elasticOver)):this.elasticOver());this.event("end"),!this.hide&&this.autoHide&&b$U.to(this,{alpha:0},500)}},b$M.stopScroll=function(){this.onStageMouseUp2(null),b$J.timer.clear(this,this.tweenMove),b$U.clearTween(this)},b$S(0,b$M,"measureHeight",function(){return this.slider.isVertical?100:this.slider.height}),b$S(0,b$M,"skin",function(){return this._skin},function(b$M){this._skin!=b$M&&(this._skin=b$M,this.slider.skin=this._skin,this.callLater(this.changeScrollBar))}),b$S(0,b$M,"max",function(){return this.slider.max},function(b$M){this.slider.max=b$M}),b$S(0,b$M,"showButtons",function(){return this._showButtons},function(b$M){this._showButtons=b$M,this.callLater(this.changeScrollBar)}),b$S(0,b$M,"measureWidth",function(){return this.slider.isVertical?this.slider.width:100}),b$S(0,b$M,"min",function(){return this.slider.min},function(b$M){this.slider.min=b$M}),b$S(0,b$M,"value",function(){return this._value},function(b$M){b$M!==this._value&&(this._value=b$M,this._isElastic||(this.slider._value!=b$M&&(this.slider._value=b$M,this.slider.changeValue()),this._value=this.slider._value),this.event("change"),this.changeHandler&&this.changeHandler.runWith(this._value))}),b$S(0,b$M,"isVertical",function(){return this.slider.isVertical},function(b$M){this.slider.isVertical=b$M}),b$S(0,b$M,"sizeGrid",function(){return this.slider.sizeGrid},function(b$M){this.slider.sizeGrid=b$M}),b$S(0,b$M,"scrollSize",function(){return this._scrollSize},function(b$M){this._scrollSize=b$M}),b$S(0,b$M,"dataSource",b$y.prototype._$get_dataSource,function(b$M){"number"==typeof(this._dataSource=b$M)||"string"==typeof b$M?this.value=Number(b$M):b$J.superSet(b$e,this,"dataSource",b$M)}),b$S(0,b$M,"thumbPercent",function(){return this._thumbPercent},function(b$M){this.runCallLater(this.changeScrollBar),this.runCallLater(this.changeSize),b$M=1<=b$M?.99:b$M,this._thumbPercent=b$M,this.scaleBar&&(this.slider.isVertical?this.slider.bar.height=Math.max(this.slider.height*b$M,b$n.scrollBarMinNum):this.slider.bar.width=Math.max(this.slider.width*b$M,b$n.scrollBarMinNum))}),b$S(0,b$M,"target",function(){return this._target},function(b$M){this._target&&(this._target.off("mousewheel",this,this.onTargetMouseWheel),this._target.off("mousedown",this,this.onTargetMouseDown)),(this._target=b$M)&&(this._mouseWheelEnable&&this._target.on("mousewheel",this,this.onTargetMouseWheel),this._touchScrollEnable&&this._target.on("mousedown",this,this.onTargetMouseDown))}),b$S(0,b$M,"hide",function(){return this._hide},function(b$M){this._hide=b$M,this.visible=!b$M}),b$S(0,b$M,"touchScrollEnable",function(){return this._touchScrollEnable},function(b$M){this._touchScrollEnable=b$M,this.target=this._target}),b$S(0,b$M,"mouseWheelEnable",function(){return this._mouseWheelEnable},function(b$M){this._mouseWheelEnable=b$M,this.target=this._target}),b$S(0,b$M,"tick",function(){return this.slider.tick},function(b$M){this.slider.tick=b$M}),b$i}(b$e),b$p=function(b$y){function b$i(b$M){this.changeHandler=null,this.isVertical=!0,this.showLabel=!0,this._allowClickBack=!1,this._max=100,this._min=0,this._tick=1,this._value=0,this._skin=null,this._bg=null,this._progress=null,this._bar=null,this._tx=NaN,this._ty=NaN,this._maxMove=NaN,this._globalSacle=null,b$i.__super.call(this),this.skin=b$M}b$f(b$i,"laya.ui.Slider",b$y);var b$M=b$i.prototype;return b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,b$M),this._bg&&this._bg.destroy(b$M),this._bar&&this._bar.destroy(b$M),this._progress&&this._progress.destroy(b$M),this._bg=null,this._bar=null,this._progress=null,this.changeHandler=null},b$M.createChildren=function(){this.addChild(this._bg=new b$B),this.addChild(this._bar=new b$z)},b$M.initialize=function(){this._bar.on("mousedown",this,this.onBarMouseDown),this._bg.sizeGrid=this._bar.sizeGrid="4,4,4,4,0",this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid),this.allowClickBack=!0},b$M.onBarMouseDown=function(b$M){this._globalSacle||(this._globalSacle=new b$l),this._globalSacle.setTo(this.globalScaleX||.01,this.globalScaleY||.01),this._maxMove=this.isVertical?this.height-this._bar.height:this.width-this._bar.width,this._tx=b$J.stage.mouseX,this._ty=b$J.stage.mouseY,b$J.stage.on("mousemove",this,this.mouseMove),b$J.stage.once("mouseup",this,this.mouseUp),b$J.stage.once("mouseout",this,this.mouseUp),this.showValueText()},b$M.showValueText=function(){if(this.showLabel){var b$M=laya.ui.Slider.label;this.addChild(b$M),b$M.textField.changeText(this._value+""),this.isVertical?(b$M.x=this._bar.x+20,b$M.y=.5*(this._bar.height-b$M.height)+this._bar.y):(b$M.y=this._bar.y-20,b$M.x=.5*(this._bar.width-b$M.width)+this._bar.x)}},b$M.hideValueText=function(){laya.ui.Slider.label&&laya.ui.Slider.label.removeSelf()},b$M.mouseUp=function(b$M){b$J.stage.off("mousemove",this,this.mouseMove),b$J.stage.off("mouseup",this,this.mouseUp),b$J.stage.off("mouseout",this,this.mouseUp),this.sendChangeEvent("changed"),this.hideValueText()},b$M.mouseMove=function(b$M){var b$y=this._value;this.isVertical?(this._bar.y+=(b$J.stage.mouseY-this._ty)/this._globalSacle.y,this._bar.y>this._maxMove?this._bar.y=this._maxMove:this._bar.y<0&&(this._bar.y=0),this._value=this._bar.y/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x+=(b$J.stage.mouseX-this._tx)/this._globalSacle.x,this._bar.x>this._maxMove?this._bar.x=this._maxMove:this._bar.x<0&&(this._bar.x=0),this._value=this._bar.x/this._maxMove*(this._max-this._min)+this._min,this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width)),this._tx=b$J.stage.mouseX,this._ty=b$J.stage.mouseY;var b$i=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*b$i)/b$i,this._value!=b$y&&this.sendChangeEvent(),this.showValueText()},b$M.sendChangeEvent=function(b$M){void 0===b$M&&(b$M="change"),this.event(b$M),this.changeHandler&&this.changeHandler.runWith(this._value)},b$M.setBarPoint=function(){this.isVertical?this._bar.x=Math.round(.5*(this._bg.width-this._bar.width)):this._bar.y=Math.round(.5*(this._bg.height-this._bar.height))},b$M.changeSize=function(){b$y.prototype.changeSize.call(this),this.isVertical?this._bg.height=this.height:this._bg.width=this.width,this.setBarPoint(),this.changeValue()},b$M.setSlider=function(b$M,b$y,b$i){this._value=-1,this._min=b$M,this._max=b$M<b$y?b$y:b$M,this.value=b$i<b$M?b$M:b$y<b$i?b$y:b$i},b$M.changeValue=function(){var b$M=Math.pow(10,(this._tick+"").length-1);this._value=Math.round(Math.round(this._value/this._tick)*this._tick*b$M)/b$M,this._value=this._value>this._max?this._max:this._value<this._min?this._min:this._value;var b$y=this._max-this._min;0===b$y&&(b$y=1),this.isVertical?(this._bar.y=(this._value-this._min)/b$y*(this.height-this._bar.height),this._progress&&(this._progress.height=this._bar.y+.5*this._bar.height)):(this._bar.x=(this._value-this._min)/b$y*(this.width-this._bar.width),this._progress&&(this._progress.width=this._bar.x+.5*this._bar.width))},b$M.onBgMouseDown=function(b$M){var b$y=this._bg.getMousePoint();this.isVertical?this.value=b$y.y/(this.height-this._bar.height)*(this._max-this._min)+this._min:this.value=b$y.x/(this.width-this._bar.width)*(this._max-this._min)+this._min},b$S(0,b$M,"measureHeight",function(){return Math.max(this._bg.height,this._bar.height)}),b$S(0,b$M,"skin",function(){return this._skin},function(b$M){if(this._skin!=b$M){this._skin=b$M,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png");var b$y=this._skin.replace(".png","$progress.png");b$v.getRes(b$y)&&(this._progress||(this.addChild(this._progress=new b$B),this._progress.sizeGrid=this._bar.sizeGrid,this.setChildIndex(this._progress,1)),this._progress.skin=b$y),this.setBarPoint(),this.callLater(this.changeValue)}}),b$S(0,b$M,"allowClickBack",function(){return this._allowClickBack},function(b$M){this._allowClickBack!=b$M&&((this._allowClickBack=b$M)?this._bg.on("mousedown",this,this.onBgMouseDown):this._bg.off("mousedown",this,this.onBgMouseDown))}),b$S(0,b$M,"max",function(){return this._max},function(b$M){this._max!=b$M&&(this._max=b$M,this.callLater(this.changeValue))}),b$S(0,b$M,"measureWidth",function(){return Math.max(this._bg.width,this._bar.width)}),b$S(0,b$M,"tick",function(){return this._tick},function(b$M){this._tick!=b$M&&(this._tick=b$M,this.callLater(this.changeValue))}),b$S(0,b$M,"sizeGrid",function(){return this._bg.sizeGrid},function(b$M){this._bg.sizeGrid=b$M,this._bar.sizeGrid=b$M,this._progress&&(this._progress.sizeGrid=this._bar.sizeGrid)}),b$S(0,b$M,"min",function(){return this._min},function(b$M){this._min!=b$M&&(this._min=b$M,this.callLater(this.changeValue))}),b$S(0,b$M,"value",function(){return this._value},function(b$M){if(this._value!=b$M){var b$y=this._value;this._value=b$M,this.changeValue(),this._value!=b$y&&this.sendChangeEvent()}}),b$S(0,b$M,"dataSource",b$y.prototype._$get_dataSource,function(b$M){"number"==typeof(this._dataSource=b$M)||"string"==typeof b$M?this.value=Number(b$M):b$J.superSet(b$e,this,"dataSource",b$M)}),b$S(0,b$M,"bar",function(){return this._bar}),b$H(b$i,["label",function(){return this.label=new b$Z}]),b$i}(b$e),b$B=function(b$y){function b$i(b$M){this._bitmap=null,this._skin=null,this._group=null,b$i.__super.call(this),this.skin=b$M}b$f(b$i,"laya.ui.Image",b$y);var b$M=b$i.prototype;return b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,!0),this._bitmap&&this._bitmap.destroy(),this._bitmap=null,b$v.clearCache(this,this._skin)},b$M.dispose=function(){this.destroy(!0),b$v.clearCache(this,this._skin)},b$M.createChildren=function(){this.graphics=this._bitmap=new b$m},b$M.setSource=function(b$M,b$y){b$M===this._skin&&b$y&&(this.source=b$y,this.onCompResize())},b$S(0,b$M,"source",function(){return this._bitmap.source},function(b$M){this._bitmap&&(this._bitmap.source=b$M,this.event("loaded"),this.repaint())}),b$S(0,b$M,"dataSource",b$y.prototype._$get_dataSource,function(b$M){"string"==typeof(this._dataSource=b$M)?this.skin=b$M:b$J.superSet(b$e,this,"dataSource",b$M)}),b$S(0,b$M,"measureHeight",function(){return this._bitmap.height}),b$S(0,b$M,"skin",function(){return this._skin},function(b$M){if(this._skin!=b$M)if(b$v.clearCache(this,this._skin),this._skin=b$M){b$v.keepCache(this,this._skin);var b$y=b$v.getRes(b$M);b$y?(this.source=b$y,this.onCompResize()):b$J.loader.load(this._skin,b$d.create(this,this.setSource,[this._skin]),null,"image",1,!0,this._group)}else this.source=null}),b$S(0,b$M,"group",function(){return this._group},function(b$M){b$M&&this._skin&&b$v.setGroup(this._skin,b$M),this._group=b$M}),b$S(0,b$M,"sizeGrid",function(){return this._bitmap.sizeGrid?this._bitmap.sizeGrid.join(","):null},function(b$M){this._bitmap.sizeGrid=b$a.fillArray(b$n.defaultSizeGrid,b$M,Number)}),b$S(0,b$M,"measureWidth",function(){return this._bitmap.width}),b$S(0,b$M,"width",b$y.prototype._$get_width,function(b$M){b$J.superSet(b$e,this,"width",b$M),this._bitmap.width=0==b$M?1e-7:b$M}),b$S(0,b$M,"height",b$y.prototype._$get_height,function(b$M){b$J.superSet(b$e,this,"height",b$M),this._bitmap.height=0==b$M?1e-7:b$M}),b$i}(b$e),b$Z=function(b$y){function b$i(b$M){this._tf=null,b$i.__super.call(this),void 0===b$M&&(b$M=""),b$X.defaultColor=b$n.labelColor,this.text=b$M}b$f(b$i,"laya.ui.Label",b$y);var b$M=b$i.prototype;return b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,b$M),this._tf=null},b$M.createChildren=function(){this.addChild(this._tf=new b$G)},b$M.changeText=function(b$M){this._tf.changeText(b$M)},b$S(0,b$M,"padding",function(){return this._tf.padding.join(",")},function(b$M){this._tf.padding=b$a.fillArray(b$n.labelPadding,b$M,Number)}),b$S(0,b$M,"bold",function(){return this._tf.bold},function(b$M){this._tf.bold=b$M}),b$S(0,b$M,"align",function(){return this._tf.align},function(b$M){this._tf.align=b$M}),b$S(0,b$M,"text",function(){return this._tf.text},function(b$M){this._tf.text!=b$M&&(b$M&&(b$M=b$a.adptString(b$M+"")),this._tf.text=b$M,this.event("change"),this._width&&this._height||this.onCompResize())}),b$S(0,b$M,"italic",function(){return this._tf.italic},function(b$M){this._tf.italic=b$M}),b$S(0,b$M,"wordWrap",function(){return this._tf.wordWrap},function(b$M){this._tf.wordWrap=b$M}),b$S(0,b$M,"font",function(){return this._tf.font},function(b$M){this._tf.font=b$M}),b$S(0,b$M,"dataSource",b$y.prototype._$get_dataSource,function(b$M){"number"==typeof(this._dataSource=b$M)||"string"==typeof b$M?this.text=b$M+"":b$J.superSet(b$e,this,"dataSource",b$M)}),b$S(0,b$M,"color",function(){return this._tf.color},function(b$M){this._tf.color=b$M}),b$S(0,b$M,"valign",function(){return this._tf.valign},function(b$M){this._tf.valign=b$M}),b$S(0,b$M,"leading",function(){return this._tf.leading},function(b$M){this._tf.leading=b$M}),b$S(0,b$M,"fontSize",function(){return this._tf.fontSize},function(b$M){this._tf.fontSize=b$M}),b$S(0,b$M,"bgColor",function(){return this._tf.bgColor},function(b$M){this._tf.bgColor=b$M}),b$S(0,b$M,"borderColor",function(){return this._tf.borderColor},function(b$M){this._tf.borderColor=b$M}),b$S(0,b$M,"stroke",function(){return this._tf.stroke},function(b$M){this._tf.stroke=b$M}),b$S(0,b$M,"strokeColor",function(){return this._tf.strokeColor},function(b$M){this._tf.strokeColor=b$M}),b$S(0,b$M,"textField",function(){return this._tf}),b$S(0,b$M,"measureWidth",function(){return this._tf.width}),b$S(0,b$M,"measureHeight",function(){return this._tf.height}),b$S(0,b$M,"width",function(){return this._width||this._tf.text?b$J.superGet(b$e,this,"width"):0},function(b$M){b$J.superSet(b$e,this,"width",b$M),this._tf.width=b$M}),b$S(0,b$M,"height",function(){return this._height||this._tf.text?b$J.superGet(b$e,this,"height"):0},function(b$M){b$J.superSet(b$e,this,"height",b$M),this._tf.height=b$M}),b$S(0,b$M,"overflow",function(){return this._tf.overflow},function(b$M){this._tf.overflow=b$M}),b$S(0,b$M,"underline",function(){return this._tf.underline},function(b$M){this._tf.underline=b$M}),b$S(0,b$M,"underlineColor",function(){return this._tf.underlineColor},function(b$M){this._tf.underlineColor=b$M}),b$i}(b$e),b$E=function(b$y){function b$i(b$M){this.changeHandler=null,this._bg=null,this._bar=null,this._skin=null,this._value=.5,b$i.__super.call(this),this.skin=b$M}b$f(b$i,"laya.ui.ProgressBar",b$y);var b$M=b$i.prototype;return b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,b$M),this._bg&&this._bg.destroy(b$M),this._bar&&this._bar.destroy(b$M),this._bg=this._bar=null,this.changeHandler=null},b$M.createChildren=function(){this.addChild(this._bg=new b$B),this.addChild(this._bar=new b$B)},b$M.changeValue=function(){if(this.sizeGrid){var b$M=this.sizeGrid.split(","),b$y=Number(b$M[3]),b$i=Number(b$M[1]),b$H=(this.width-b$y-b$i)*this._value;this._bar.width=b$y+b$i+b$H,this._bar.visible=this._bar.width>b$y+b$i}else this._bar.width=this.width*this._value},b$S(0,b$M,"measureHeight",function(){return this._bg.height}),b$S(0,b$M,"skin",function(){return this._skin},function(b$M){this._skin!=b$M&&(this._skin=b$M,this._bg.skin=this._skin,this._bar.skin=this._skin.replace(".png","$bar.png"),this.callLater(this.changeValue))}),b$S(0,b$M,"measureWidth",function(){return this._bg.width}),b$S(0,b$M,"height",b$y.prototype._$get_height,function(b$M){b$J.superSet(b$e,this,"height",b$M),this._bg.height=this._height,this._bar.height=this._height}),b$S(0,b$M,"bar",function(){return this._bar}),b$S(0,b$M,"value",function(){return this._value},function(b$M){this._value!=b$M&&(b$M=1<b$M?1:b$M<0?0:b$M,this._value=b$M,this.callLater(this.changeValue),this.event("change"),this.changeHandler&&this.changeHandler.runWith(b$M))}),b$S(0,b$M,"bg",function(){return this._bg}),b$S(0,b$M,"sizeGrid",function(){return this._bg.sizeGrid},function(b$M){this._bg.sizeGrid=this._bar.sizeGrid=b$M}),b$S(0,b$M,"width",b$y.prototype._$get_width,function(b$M){b$J.superSet(b$e,this,"width",b$M),this._bg.width=this._width,this.callLater(this.changeValue)}),b$S(0,b$M,"dataSource",b$y.prototype._$get_dataSource,function(b$M){"number"==typeof(this._dataSource=b$M)||"string"==typeof b$M?this.value=Number(b$M):b$J.superSet(b$e,this,"dataSource",b$M)}),b$i}(b$e),b$_=(function(b$M){function b$i(){this._tipBox=null,this._tipText=null,this._defaultTipHandler=null,b$i.__super.call(this),this._tipBox=new b$e,this._tipBox.addChild(this._tipText=new b$G),this._tipText.x=this._tipText.y=5,this._tipText.color=b$i.tipTextColor,this._defaultTipHandler=this._showDefaultTip,b$J.stage.on("showtip",this,this._onStageShowTip),b$J.stage.on("hidetip",this,this._onStageHideTip),this.zOrder=1100}b$f(b$i,"laya.ui.TipManager",b$e);var b$y=b$i.prototype;b$y._onStageHideTip=function(b$M){b$J.timer.clear(this,this._showTip),this.closeAll(),this.removeSelf()},b$y._onStageShowTip=function(b$M){b$J.timer.once(b$i.tipDelay,this,this._showTip,[b$M],!0)},b$y._showTip=function(b$M){if("string"==typeof b$M){var b$y=String(b$M);Boolean(b$y)&&this._defaultTipHandler(b$y)}else b$M instanceof laya.utils.Handler?b$M.run():"function"==typeof b$M&&b$M.apply();b$J.stage.on("mousemove",this,this._onStageMouseMove),b$J.stage.on("mousedown",this,this._onStageMouseDown),this._onStageMouseMove(null)},b$y._onStageMouseDown=function(b$M){this.closeAll()},b$y._onStageMouseMove=function(b$M){this._showToStage(this,b$i.offsetX,b$i.offsetY)},b$y._showToStage=function(b$M,b$y,b$i){void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0);var b$H=b$M.getBounds();b$M.x=b$J.stage.mouseX+b$y,b$M.y=b$J.stage.mouseY+b$i,b$M.x+b$H.width>b$J.stage.width&&(b$M.x-=b$H.width+b$y),b$M.y+b$H.height>b$J.stage.height&&(b$M.y-=b$H.height+b$i)},b$y.closeAll=function(){b$J.timer.clear(this,this._showTip),b$J.stage.off("mousemove",this,this._onStageMouseMove),b$J.stage.off("mousedown",this,this._onStageMouseDown),this.removeChildren()},b$y.showDislayTip=function(b$M){this.addChild(b$M),this._showToStage(this),b$J._currentStage.addChild(this)},b$y._showDefaultTip=function(b$M){this._tipText.text=b$M;var b$y=this._tipBox.graphics;b$y.clear(),b$y.drawRect(0,0,this._tipText.width+10,this._tipText.height+10,b$i.tipBackColor),this.addChild(this._tipBox),this._showToStage(this),b$J._currentStage.addChild(this)},b$S(0,b$y,"defaultTipHandler",function(){return this._defaultTipHandler},function(b$M){this._defaultTipHandler=b$M}),b$i.offsetX=10,b$i.offsetY=15,b$i.tipTextColor="#ffffff",b$i.tipBackColor="#111111",b$i.tipDelay=200}(),function(b$M){var b$P;function b$l(){this._idMap=null,this._aniList=null,this._watchMap={},b$l.__super.call(this)}b$f(b$l,"laya.ui.View",b$D);var b$y=b$l.prototype;return b$y.createView=function(b$M){if(b$M.animations&&!this._idMap&&(this._idMap={}),b$l.createComp(b$M,this,this),b$M.animations){var b$y,b$i,b$H=[],b$S=b$M.animations,b$f=0,b$V=b$S.length;for(b$f=0;b$f<b$V;b$f++){switch(b$y=new b$F,b$i=b$S[b$f],b$y._setUp(this._idMap,b$i),(this[b$i.name]=b$y)._setControlNode(this),b$i.action){case 1:b$y.play(0,!1);break;case 2:b$y.play(0,!0)}b$H.push(b$y)}this._aniList=b$H}0<this._width&&null==b$M.props.hitTestPrior&&!this.mouseThrough&&(this.hitTestPrior=!0)},b$y.onEvent=function(b$M,b$y){},b$y.loadUI=function(b$M){var b$y=b$l.uiMap[b$M];b$y&&this.createView(b$y)},b$y.destroy=function(b$M){void 0===b$M&&(b$M=!0),this._aniList&&(this._aniList.length=0),this._idMap=null,this._aniList=null,this._watchMap=null,laya.ui.Component.prototype.destroy.call(this,b$M)},b$y.changeData=function(b$M){var b$y=this._watchMap[b$M];if(b$y){console.log("change",b$M);for(var b$i=0,b$H=b$y.length;b$i<b$H;b$i++){b$y[b$i].exe(this)}}},b$l._regs=function(){for(var b$M in b$l.uiClassMap)b$h.regClass(b$M,b$l.uiClassMap[b$M])},b$l.createComp=function(b$M,b$y,b$i,b$H){if(!(b$y=b$y||b$l.getCompInstance(b$M)))return console.warn("can not create:"+b$M.type),null;var b$S=b$M.child;if(b$S)for(var b$f=b$y instanceof laya.ui.List,b$V=0,b$K=b$S.length;b$V<b$K;b$V++){var b$k=b$S[b$V];if(!b$y.hasOwnProperty("itemRender")||"render"!=b$k.props.name&&"render"!==b$k.props.renderType)if("Graphic"==b$k.type)b$h.addGraphicsToSprite(b$k,b$y);else if(b$h.isDrawType(b$k.type))b$h.addGraphicToSprite(b$k,b$y,!0);else{if(b$f){var b$X=[],b$F=b$l.createComp(b$k,null,b$i,b$X);b$X.length&&(b$F._$bindData=b$X)}else b$F=b$l.createComp(b$k,null,b$i,b$H);"Script"==b$k.type?"owner"in b$F?b$F.owner=b$y:"target"in b$F&&(b$F.target=b$y):"mask"==b$k.props.renderType||"mask"==b$k.props.name?b$y.mask=b$F:b$F instanceof laya.display.Sprite&&b$y.addChild(b$F)}else b$y.itemRender=b$k}var b$o=b$M.props;for(var b$d in b$o){var b$P=b$o[b$d];b$l.eventDic[b$d]?b$P&&b$i&&b$y.on(b$d,b$i,b$i.onEvent,[b$P]):b$l.setCompValue(b$y,b$d,b$P,b$i,b$H)}return b$J.__typeof(b$y,"laya.ui.IItem")&&b$y.initItems(),b$M.compId&&b$i&&b$i._idMap&&(b$i._idMap[b$M.compId]=b$y),b$y},b$l.setCompValue=function(b$M,b$y,b$i,b$H,b$S){if("string"==typeof b$i&&-1<b$i.indexOf("${")){if(b$l._sheet||(b$l._sheet=b$h.getClass("laya.data.Table")),!b$l._sheet)return void console.warn("Can not find class Sheet");if(b$S)b$S.push(b$M,b$y,b$i);else if(b$H){-1==b$i.indexOf("].")&&(b$i=b$i.replace(".","[0]."));var b$f,b$V,b$K=new b$P(b$M,b$y,b$i);b$K.exe(b$H);for(var b$k=b$i.replace(/\[.*?\]\./g,".");null!=(b$f=b$l._parseWatchData.exec(b$k));){for(var b$X=b$f[1];null!=(b$V=b$l._parseKeyWord.exec(b$X));){var b$F=b$V[0],b$o=b$H._watchMap[b$F]||(b$H._watchMap[b$F]=[]);b$o.push(b$K),b$l._sheet.I.notifer.on(b$F,b$H,b$H.changeData,[b$F])}(b$o=b$H._watchMap[b$X]||(b$H._watchMap[b$X]=[])).push(b$K),b$l._sheet.I.notifer.on(b$X,b$H,b$H.changeData,[b$X])}}}else if("var"===b$y&&b$H)b$H[b$i]=b$M;else if("onClick"==b$y){var b$d=b$J._runScript("(function(){"+b$i+"})");b$M.on("click",b$H,b$d)}else b$M[b$y]="true"===b$i||"false"!==b$i&&b$i},b$l.getCompInstance=function(b$M){var b$y,b$i=b$M.props?b$M.props.runtime:null;return b$y=b$i?b$l.viewClassMap[b$i]||b$l.uiClassMap[b$i]||b$J.__classmap[b$i]:b$l.uiClassMap[b$M.type],b$M.props&&b$M.props.hasOwnProperty("renderType")&&"instance"==b$M.props.renderType?b$y.instance:b$y?new b$y:null},b$l.regComponent=function(b$M,b$y){b$l.uiClassMap[b$M]=b$y,b$h.regClass(b$M,b$y)},b$l.regViewRuntime=function(b$M,b$y){b$l.viewClassMap[b$M]=b$y},b$l.uiMap={},b$l.viewClassMap={},b$l._sheet=null,b$H(b$l,["uiClassMap",function(){return this.uiClassMap={ViewStack:b$MM,LinkButton:b$z,TextArea:b$XM,ColorPicker:b$q,Box:b$D,Button:b$z,CheckBox:b$b,Clip:b$w,ComboBox:b$t,Component:b$e,HScrollBar:b$$,HSlider:b$g,Image:b$B,Label:b$Z,List:b$N,Panel:b$x,ProgressBar:b$E,Radio:b$O,RadioGroup:b$KM,ScrollBar:b$u,Slider:b$p,Tab:b$kM,TextInput:b$iM,View:b$l,VScrollBar:b$yM,VSlider:b$HM,Tree:b$L,HBox:b$fM,VBox:b$VM,Sprite:b$A,Animation:b$i,Text:b$G,FontClip:b$r}},"eventDic",function(){return this.eventDic={mousedown:!0,mouseup:!0,mousemove:!0,mouseover:!0,mouseout:!0,click:!0,doubleclick:!0,rightmousedown:!0,rightmouseup:!0,rightclick:!0}},"_parseWatchData",function(){return this._parseWatchData=/\${(.*?)}/g},"_parseKeyWord",function(){return this._parseKeyWord=/[a-zA-Z_][a-zA-Z0-9_]*(?:(?:\.[a-zA-Z_][a-zA-Z0-9_]*)+)/g}]),b$l.__init$=function(){b$l._regs(),b$P=function(){function b$M(b$M,b$y,b$i){this.comp=null,this.prop=null,this.value=null,this.comp=b$M,this.prop=b$y,this.value=b$i}return b$f(b$M,""),b$M.prototype.exe=function(b$M){var b$y=b$a.getBindFun(this.value);this.comp[this.prop]=b$y.call(this,b$M)},b$M}()},b$l}()),b$b=function(b$M){function b$i(b$M,b$y){void 0===b$y&&(b$y=""),b$i.__super.call(this,b$M,b$y)}b$f(b$i,"laya.ui.CheckBox",b$M);var b$y=b$i.prototype;return b$y.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!0,this._autoSize=!1},b$y.initialize=function(){b$M.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0},b$S(0,b$y,"dataSource",b$M.prototype._$get_dataSource,function(b$M){"boolean"==typeof(this._dataSource=b$M)?this.selected=b$M:"string"==typeof b$M?this.selected="true"===b$M:b$J.superSet(b$z,this,"dataSource",b$M)}),b$i}(b$z),b$Y=function(b$M){function b$y(){this._space=0,this._align="none",this._itemChanged=!1,b$y.__super.call(this)}b$f(b$y,"laya.ui.LayoutBox",b$D);var b$i=b$y.prototype;return b$i.addChild=function(b$M){return b$M.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChild.call(this,b$M)},b$i.onResize=function(b$M){this._setItemChanged()},b$i.addChildAt=function(b$M,b$y){return b$M.on("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.addChildAt.call(this,b$M,b$y)},b$i.removeChild=function(b$M){return b$M.off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChild.call(this,b$M)},b$i.removeChildAt=function(b$M){return this.getChildAt(b$M).off("resize",this,this.onResize),this._setItemChanged(),laya.display.Node.prototype.removeChildAt.call(this,b$M)},b$i.refresh=function(){this._setItemChanged()},b$i.changeItems=function(){this._itemChanged=!1},b$i.sortItem=function(b$M){b$M&&b$M.sort(function(b$M,b$y){return b$M.y-b$y.y})},b$i._setItemChanged=function(){this._itemChanged||(this._itemChanged=!0,this.callLater(this.changeItems))},b$S(0,b$i,"space",function(){return this._space},function(b$M){this._space=b$M,this._setItemChanged()}),b$S(0,b$i,"align",function(){return this._align},function(b$M){this._align=b$M,this._setItemChanged()}),b$y}(),b$r=function(b$y){function b$i(b$M,b$y){this._valueArr=null,this._indexMap=null,this._sheet=null,this._direction="horizontal",this._spaceX=0,this._spaceY=0,this._align="left",this._wordsW=0,this._wordsH=0,b$i.__super.call(this),b$M&&(this.skin=b$M),b$y&&(this.sheet=b$y)}b$f(b$i,"laya.ui.FontClip",b$y);var b$M=b$i.prototype;return b$M.createChildren=function(){this._bitmap=new b$m,this.on("loaded",this,this._onClipLoaded)},b$M._onClipLoaded=function(){this.callLater(this.changeValue)},b$M.changeValue=function(){var b$M;if(this._sources&&(this._valueArr&&(this.graphics.clear(!0),b$M=this._sources[0]))){var b$y="horizontal"===this._direction;b$y?(this._wordsW=this._valueArr.length*(b$M.sourceWidth+this.spaceX),this._wordsH=b$M.sourceHeight):(this._wordsW=b$M.sourceWidth,this._wordsH=(b$M.sourceHeight+this.spaceY)*this._valueArr.length);var b$i=0;if(this._width)switch(this._align){case"center":b$i=.5*(this._width-this._wordsW);break;case"right":b$i=this._width-this._wordsW;break;default:b$i=0}for(var b$H=0,b$S=this._valueArr.length;b$H<b$S;b$H++){var b$f=this._indexMap[this._valueArr.charAt(b$H)];this.sources[b$f]&&(b$M=this.sources[b$f],b$y?this.graphics.drawTexture(b$M,b$i+b$H*(b$M.sourceWidth+this.spaceX),0,b$M.sourceWidth,b$M.sourceHeight):this.graphics.drawTexture(b$M,0+b$i,b$H*(b$M.sourceHeight+this.spaceY),b$M.sourceWidth,b$M.sourceHeight))}this._width||(this.resetLayoutX(),this.callLater(this.changeSize)),this._height||(this.resetLayoutY(),this.callLater(this.changeSize))}},b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),this._valueArr=null,this._indexMap=null,this.graphics.clear(!0),this.removeSelf(),this.off("loaded",this,this._onClipLoaded),b$y.prototype.destroy.call(this,b$M)},b$S(0,b$M,"sheet",function(){return this._sheet},function(b$M){b$M+="";var b$y=(this._sheet=b$M).split(" ");this._clipX=String(b$y[0]).length,this.clipY=b$y.length,this._indexMap={};for(var b$i=0;b$i<this._clipY;b$i++)for(var b$H=b$y[b$i].split(""),b$S=0,b$f=b$H.length;b$S<b$f;b$S++)this._indexMap[b$H[b$S]]=b$i*this._clipX+b$S}),b$S(0,b$M,"height",b$y.prototype._$get_height,function(b$M){b$J.superSet(b$w,this,"height",b$M),this.callLater(this.changeValue)}),b$S(0,b$M,"direction",function(){return this._direction},function(b$M){this._direction=b$M,this.callLater(this.changeValue)}),b$S(0,b$M,"value",function(){return this._valueArr?this._valueArr:""},function(b$M){b$M+="",this._valueArr=b$M,this.callLater(this.changeValue)}),b$S(0,b$M,"width",b$y.prototype._$get_width,function(b$M){b$J.superSet(b$w,this,"width",b$M),this.callLater(this.changeValue)}),b$S(0,b$M,"spaceX",function(){return this._spaceX},function(b$M){this._spaceX=b$M,"horizontal"===this._direction&&this.callLater(this.changeValue)}),b$S(0,b$M,"spaceY",function(){return this._spaceY},function(b$M){this._spaceY=b$M,"horizontal"!==this._direction&&this.callLater(this.changeValue)}),b$S(0,b$M,"align",function(){return this._align},function(b$M){this._align=b$M,this.callLater(this.changeValue)}),b$S(0,b$M,"measureWidth",function(){return this._wordsW}),b$S(0,b$M,"measureHeight",function(){return this._wordsH}),b$i}(b$w),b$N=function(b$M){function b$y(){this.selectHandler=null,this.renderHandler=null,this.mouseHandler=null,this.selectEnable=!1,this.totalPage=0,this._content=null,this._scrollBar=null,this._itemRender=null,this._repeatX=0,this._repeatY=0,this._repeatX2=0,this._repeatY2=0,this._spaceX=0,this._spaceY=0,this._array=null,this._startIndex=0,this._selectedIndex=-1,this._page=0,this._isVertical=!0,this._cellSize=20,this._cellOffset=0,this._isMoved=!1,this.cacheContent=!1,this._createdLine=0,this._cellChanged=!1,this._cells=[],this._offset=new b$l,b$y.__super.call(this)}b$f(b$y,"laya.ui.List",b$M);var b$i=b$y.prototype;return b$J.imps(b$i,{"laya.ui.IRender":!0,"laya.ui.IItem":!0}),b$i.destroy=function(b$M){void 0===b$M&&(b$M=!0),this._content&&this._content.destroy(b$M),this._scrollBar&&this._scrollBar.destroy(b$M),laya.ui.Component.prototype.destroy.call(this,b$M),this._content=null,this._scrollBar=null,this._itemRender=null,this._cells=null,this._array=null,this.selectHandler=this.renderHandler=this.mouseHandler=null},b$i.createChildren=function(){this.addChild(this._content=new b$D)},b$i.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=b$J.superGet(b$D,this,"cacheAs")),b$J.superSet(b$D,this,"cacheAs","none"),this._scrollBar.once("end",this,this.onScrollEnd)},b$i.onScrollEnd=function(){b$J.superSet(b$D,this,"cacheAs",this._$P.cacheAs)},b$i._removePreScrollBar=function(){var b$M=this.removeChildByName("scrollBar");b$M&&b$M.destroy(!0)},b$i.changeCells=function(){if(this._cellChanged=!1,this._itemRender){this.scrollBar=this.getChildByName("scrollBar");var b$M=this._getOneCell(),b$y=b$M.width+this._spaceX||1,b$i=b$M.height+this._spaceY||1;0<this._width&&(this._repeatX2=this._isVertical?Math.round(this._width/b$y):Math.ceil(this._width/b$y)),0<this._height&&(this._repeatY2=this._isVertical?Math.ceil(this._height/b$i):Math.round(this._height/b$i));var b$H=this._width?this._width:b$y*this.repeatX-this._spaceX,b$S=this._height?this._height:b$i*this.repeatY-this._spaceY;this._cellSize=this._isVertical?b$i:b$y,this._cellOffset=this._isVertical?b$i*Math.max(this._repeatY2,this._repeatY)-b$S-this._spaceY:b$y*Math.max(this._repeatX2,this._repeatX)-b$H-this._spaceX,this._isVertical&&this._scrollBar?this._scrollBar.height=b$S:!this._isVertical&&this._scrollBar&&(this._scrollBar.width=b$H),this.setContentSize(b$H,b$S);var b$f=this._isVertical?this.repeatX:this.repeatY,b$V=(this._isVertical?this.repeatY:this.repeatX)+(this._scrollBar?1:0);this._createItems(0,b$f,b$V),this._createdLine=b$V,this._array&&(this.array=this._array,this.runCallLater(this.renderItems))}},b$i._getOneCell=function(){if(0===this._cells.length){var b$M=this.createItem();if(this._offset.setTo(b$M.x,b$M.y),this.cacheContent)return b$M;this._cells.push(b$M)}return this._cells[0]},b$i._createItems=function(b$M,b$y,b$i){var b$H=this._content,b$S=this._getOneCell(),b$f=b$S.width+this._spaceX,b$V=b$S.height+this._spaceY;if(this.cacheContent){var b$K=new b$D;b$K.cacheAsBitmap=!0,b$K.pos((this._isVertical?0:b$M)*b$f,(this._isVertical?b$M:0)*b$V),this._content.addChild(b$K),this._content.optimizeScrollRect=!0,b$H=b$K}else{for(var b$k=[],b$X=this._cells.length-1;-1<b$X;b$X--){var b$F=this._cells[b$X];b$F.removeSelf(),b$k.push(b$F)}this._cells.length=0}for(var b$o=b$M;b$o<b$i;b$o++)for(var b$d=0;b$d<b$y;b$d++)(b$S=b$k&&b$k.length?b$k.pop():this.createItem()).x=(this._isVertical?b$d:b$o)*b$f-b$H.x,b$S.y=(this._isVertical?b$o:b$d)*b$V-b$H.y,b$S.name="item"+(b$o*b$y+b$d),b$H.addChild(b$S),this.addCell(b$S)},b$i.createItem=function(){var b$M=[];if("function"==typeof this._itemRender)var b$y=new this._itemRender;else b$y=b$_.createComp(this._itemRender,null,null,b$M);if(0==b$M.length&&b$y._watchMap){var b$i=b$y._watchMap;for(var b$H in b$i)for(var b$S=b$i[b$H],b$f=0;b$f<b$S.length;b$f++){var b$V=b$S[b$f];b$M.push(b$V.comp,b$V.prop,b$V.value)}}return b$M.length&&(b$y._$bindData=b$M),b$y},b$i.addCell=function(b$M){b$M.on("click",this,this.onCellMouse),b$M.on("rightclick",this,this.onCellMouse),b$M.on("mouseover",this,this.onCellMouse),b$M.on("mouseout",this,this.onCellMouse),b$M.on("mousedown",this,this.onCellMouse),b$M.on("mouseup",this,this.onCellMouse),this._cells.push(b$M)},b$i.initItems=function(){if(!this._itemRender&&null!=this.getChildByName("item0")){this.repeatX=1;for(var b$M=0,b$y=b$M=0;b$y<1e4;b$y++){var b$i=this.getChildByName("item"+b$y);if(!b$i)break;this.addCell(b$i),b$M++}this.repeatY=b$M}},b$i.setContentSize=function(b$M,b$y){this._content.width=b$M,this._content.height=b$y,(this._scrollBar||0!=this._offset.x||0!=this._offset.y)&&(this._content.scrollRect||(this._content.scrollRect=new b$C),this._content.scrollRect.setTo(-this._offset.x,-this._offset.y,b$M,b$y),this._content.scrollRect=this._content.scrollRect),this.event("resize")},b$i.onCellMouse=function(b$M){"mousedown"===b$M.type&&(this._isMoved=!1);var b$y=b$M.currentTarget,b$i=this._startIndex+this._cells.indexOf(b$y);b$i<0||("click"===b$M.type||"rightclick"===b$M.type?this.selectEnable&&!this._isMoved?this.selectedIndex=b$i:this.changeCellState(b$y,!0,0):"mouseover"!==b$M.type&&"mouseout"!==b$M.type||this._selectedIndex===b$i||this.changeCellState(b$y,"mouseover"===b$M.type,0),this.mouseHandler&&this.mouseHandler.runWith([b$M,b$i]))},b$i.changeCellState=function(b$M,b$y,b$i){var b$H=b$M.getChildByName("selectBox");b$H&&(this.selectEnable=!0,b$H.visible=b$y,b$H.index=b$i)},b$i.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this.width,this.height),this._scrollBar&&this.callLater(this.onScrollBarChange)},b$i.onScrollBarChange=function(b$M){this.runCallLater(this.changeCells);var b$y=this._scrollBar.value,b$i=this._isVertical?this.repeatX:this.repeatY,b$H=this._isVertical?this.repeatY:this.repeatX,b$S=Math.floor(b$y/this._cellSize);if(this.cacheContent)b$V=b$H+1,this._createdLine-b$S<b$V&&(this._createItems(this._createdLine,b$i,this._createdLine+b$V),this.renderItems(this._createdLine*b$i,0),this._createdLine+=b$V);else{var b$f=b$S*b$i,b$V=0;if(b$f>this._startIndex){b$V=b$f-this._startIndex;var b$K=!0,b$k=this._startIndex+b$i*(b$H+1);this._isMoved=!0}else b$f<this._startIndex&&(b$V=this._startIndex-b$f,b$K=!1,b$k=this._startIndex-1,this._isMoved=!0);for(var b$X=0;b$X<b$V;b$X++){if(b$K){var b$F=this._cells.shift();this._cells[this._cells.length]=b$F;var b$o=b$k+b$X}else b$F=this._cells.pop(),this._cells.unshift(b$F),b$o=b$k-b$X;var b$d=Math.floor(b$o/b$i)*this._cellSize;this._isVertical?b$F.y=b$d:b$F.x=b$d,this.renderItem(b$F,b$o)}this._startIndex=b$f,this.changeSelectStatus()}var b$P=this._content.scrollRect;this._isVertical?(b$P.y=b$y-this._offset.y,b$P.x=-this._offset.x):(b$P.y=-this._offset.y,b$P.x=b$y-this._offset.x),this._content.scrollRect=b$P},b$i.posCell=function(b$M,b$y){if(this._scrollBar){var b$i=this._isVertical?this.repeatX:this.repeatY,b$H=(this._isVertical?this.repeatY:this.repeatX,Math.floor(b$y/b$i)*this._cellSize);this._isVertical?b$M.y=b$H:b$M.x=b$H}},b$i.changeSelectStatus=function(){for(var b$M=0,b$y=this._cells.length;b$M<b$y;b$M++)this.changeCellState(this._cells[b$M],this._selectedIndex===this._startIndex+b$M,1)},b$i.renderItems=function(b$M,b$y){void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0);for(var b$i=b$M,b$H=b$y||this._cells.length;b$i<b$H;b$i++)this.renderItem(this._cells[b$i],this._startIndex+b$i);this.changeSelectStatus()},b$i.renderItem=function(b$M,b$y){this._array&&0<=b$y&&b$y<this._array.length?(b$M.visible=!0,b$M._$bindData?(b$M._dataSource=this._array[b$y],this._bindData(b$M,this._array[b$y])):b$M.dataSource=this._array[b$y],this.cacheContent||this.posCell(b$M,b$y),this.hasListener("render")&&this.event("render",[b$M,b$y]),this.renderHandler&&this.renderHandler.runWith([b$M,b$y])):(b$M.visible=!1,b$M.dataSource=null)},b$i._bindData=function(b$M,b$y){for(var b$i=b$M._$bindData,b$H=0,b$S=b$i.length;b$H<b$S;b$H++){var b$f=b$i[b$H++],b$V=b$i[b$H++],b$K=b$i[b$H],b$k=b$a.getBindFun(b$K);b$f[b$V]=b$k.call(this,b$y)}},b$i.refresh=function(){this.array=this._array},b$i.getItem=function(b$M){return-1<b$M&&b$M<this._array.length?this._array[b$M]:null},b$i.changeItem=function(b$M,b$y){-1<b$M&&b$M<this._array.length&&(this._array[b$M]=b$y,b$M>=this._startIndex&&b$M<this._startIndex+this._cells.length&&this.renderItem(this.getCell(b$M),b$M))},b$i.setItem=function(b$M,b$y){this.changeItem(b$M,b$y)},b$i.addItem=function(b$M){this._array.push(b$M),this.array=this._array},b$i.addItemAt=function(b$M,b$y){this._array.splice(b$y,0,b$M),this.array=this._array},b$i.deleteItem=function(b$M){this._array.splice(b$M,1),this.array=this._array},b$i.getCell=function(b$M){return this.runCallLater(this.changeCells),-1<b$M&&this._cells?this._cells[(b$M-this._startIndex)%this._cells.length]:null},b$i.scrollTo=function(b$M){if(this._scrollBar){var b$y=this._isVertical?this.repeatX:this.repeatY;this._scrollBar.value=Math.floor(b$M/b$y)*this._cellSize}else this.startIndex=b$M},b$i.tweenTo=function(b$M,b$y,b$i){if(void 0===b$y&&(b$y=200),this._scrollBar){var b$H=this._isVertical?this.repeatX:this.repeatY;b$U.to(this._scrollBar,{value:Math.floor(b$M/b$H)*this._cellSize},b$y,null,b$i,0,!0)}else this.startIndex=b$M,b$i&&b$i.run()},b$i._setCellChanged=function(){this._cellChanged||(this._cellChanged=!0,this.callLater(this.changeCells))},b$i.commitMeasure=function(){this.runCallLater(this.changeCells)},b$S(0,b$i,"cacheAs",b$M.prototype._$get_cacheAs,function(b$M){b$J.superSet(b$D,this,"cacheAs",b$M),this._scrollBar&&(this._$P.cacheAs=null,"none"!==b$M?this._scrollBar.on("start",this,this.onScrollStart):this._scrollBar.off("start",this,this.onScrollStart))}),b$S(0,b$i,"content",function(){return this._content}),b$S(0,b$i,"height",b$M.prototype._$get_height,function(b$M){b$M!=this._height&&(b$J.superSet(b$D,this,"height",b$M),this._setCellChanged())}),b$S(0,b$i,"itemRender",function(){return this._itemRender},function(b$M){if(this._itemRender!=b$M){this._itemRender=b$M;for(var b$y=this._cells.length-1;-1<b$y;b$y--)this._cells[b$y].destroy();this._cells.length=0,this._setCellChanged()}}),b$S(0,b$i,"vScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(b$M){this._removePreScrollBar();var b$y=new b$yM;b$y.name="scrollBar",b$y.right=0,b$M&&" "!=b$M&&(b$y.skin=b$M),this.scrollBar=b$y,this.addChild(b$y),this._setCellChanged()}),b$S(0,b$i,"page",function(){return this._page},function(b$M){this._page=b$M,this._array&&(this._page=0<b$M?b$M:0,this._page=this._page<this.totalPage?this._page:this.totalPage-1,this.startIndex=this._page*this.repeatX*this.repeatY)}),b$S(0,b$i,"hScrollBarSkin",function(){return this._scrollBar?this._scrollBar.skin:null},function(b$M){this._removePreScrollBar();var b$y=new b$$;b$y.name="scrollBar",b$y.bottom=0,b$M&&" "!=b$M&&(b$y.skin=b$M),this.scrollBar=b$y,this.addChild(b$y),this._setCellChanged()}),b$S(0,b$i,"repeatX",function(){return 0<this._repeatX?this._repeatX:0<this._repeatX2?this._repeatX2:1},function(b$M){this._repeatX=b$M,this._setCellChanged()}),b$S(0,b$i,"scrollBar",function(){return this._scrollBar},function(b$M){this._scrollBar!=b$M&&(this._scrollBar=b$M)&&(this._isVertical=this._scrollBar.isVertical,this.addChild(this._scrollBar),this._scrollBar.on("change",this,this.onScrollBarChange))}),b$S(0,b$i,"width",b$M.prototype._$get_width,function(b$M){b$M!=this._width&&(b$J.superSet(b$D,this,"width",b$M),this._setCellChanged())}),b$S(0,b$i,"repeatY",function(){return 0<this._repeatY?this._repeatY:0<this._repeatY2?this._repeatY2:1},function(b$M){this._repeatY=b$M,this._setCellChanged()}),b$S(0,b$i,"spaceX",function(){return this._spaceX},function(b$M){this._spaceX=b$M,this._setCellChanged()}),b$S(0,b$i,"spaceY",function(){return this._spaceY},function(b$M){this._spaceY=b$M,this._setCellChanged()}),b$S(0,b$i,"selectedIndex",function(){return this._selectedIndex},function(b$M){this._selectedIndex!=b$M&&(this._selectedIndex=b$M,this.changeSelectStatus(),this.event("change"),this.selectHandler&&this.selectHandler.runWith(b$M),this.startIndex=this._startIndex)}),b$S(0,b$i,"selectedItem",function(){return-1!=this._selectedIndex?this._array[this._selectedIndex]:null},function(b$M){this.selectedIndex=this._array.indexOf(b$M)}),b$S(0,b$i,"length",function(){return this._array?this._array.length:0}),b$S(0,b$i,"selection",function(){return this.getCell(this._selectedIndex)},function(b$M){this.selectedIndex=this._startIndex+this._cells.indexOf(b$M)}),b$S(0,b$i,"startIndex",function(){return this._startIndex},function(b$M){this._startIndex=0<b$M?b$M:0,this.callLater(this.renderItems)}),b$S(0,b$i,"array",function(){return this._array},function(b$M){this.runCallLater(this.changeCells),this._array=b$M||[];var b$y=this._array.length;if(this.totalPage=Math.ceil(b$y/(this.repeatX*this.repeatY)),this._selectedIndex=this._selectedIndex<b$y?this._selectedIndex:b$y-1,this.startIndex=this._startIndex,this._scrollBar){this._scrollBar.stopScroll();var b$i=this._isVertical?this.repeatX:this.repeatY,b$H=this._isVertical?this.repeatY:this.repeatX,b$S=Math.ceil(b$y/b$i);1<(0<this._cellOffset?this.totalPage+1:this.totalPage)?(this._scrollBar.scrollSize=this._cellSize,this._scrollBar.thumbPercent=b$H/b$S,this._scrollBar.setScroll(0,(b$S-b$H)*this._cellSize+this._cellOffset,this._scrollBar.value)):this._scrollBar.setScroll(0,0,0),this._scrollBar.target=this._content}}),b$S(0,b$i,"dataSource",b$M.prototype._$get_dataSource,function(b$M){"number"==typeof(this._dataSource=b$M)&&Math.floor(b$M)==b$M||"string"==typeof b$M?this.selectedIndex=parseInt(b$M):b$M instanceof Array?this.array=b$M:b$J.superSet(b$D,this,"dataSource",b$M)}),b$S(0,b$i,"cells",function(){return this.runCallLater(this.changeCells),this._cells}),b$y}(b$D),b$$=function(b$M){function b$y(){b$y.__super.call(this)}return b$f(b$y,"laya.ui.HScrollBar",b$M),b$y.prototype.initialize=function(){b$M.prototype.initialize.call(this),this.slider.isVertical=!1},b$y}(b$u),b$x=function(b$M){function b$y(){this._content=null,this._vScrollBar=null,this._hScrollBar=null,this._scrollChanged=!1,b$y.__super.call(this),this.width=this.height=100}b$f(b$y,"laya.ui.Panel",b$M);var b$i=b$y.prototype;return b$i.destroy=function(b$M){void 0===b$M&&(b$M=!0),laya.ui.Component.prototype.destroy.call(this,b$M),this._content&&this._content.destroy(b$M),this._vScrollBar&&this._vScrollBar.destroy(b$M),this._hScrollBar&&this._hScrollBar.destroy(b$M),this._vScrollBar=null,this._hScrollBar=null,this._content=null},b$i.destroyChildren=function(){this._content.destroyChildren()},b$i.createChildren=function(){laya.display.Node.prototype.addChild.call(this,this._content=new b$D)},b$i.addChild=function(b$M){return b$M.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChild(b$M)},b$i.onResize=function(){this._setScrollChanged()},b$i.addChildAt=function(b$M,b$y){return b$M.on("resize",this,this.onResize),this._setScrollChanged(),this._content.addChildAt(b$M,b$y)},b$i.removeChild=function(b$M){return b$M.off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChild(b$M)},b$i.removeChildAt=function(b$M){return this.getChildAt(b$M).off("resize",this,this.onResize),this._setScrollChanged(),this._content.removeChildAt(b$M)},b$i.removeChildren=function(b$M,b$y){return void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=2147483647),this._content.removeChildren(b$M,b$y),this._setScrollChanged(),this},b$i.getChildAt=function(b$M){return this._content.getChildAt(b$M)},b$i.getChildByName=function(b$M){return this._content.getChildByName(b$M)},b$i.getChildIndex=function(b$M){return this._content.getChildIndex(b$M)},b$i.changeScroll=function(){this._scrollChanged=!1;var b$M=this.contentWidth||1,b$y=this.contentHeight||1,b$i=this._vScrollBar,b$H=this._hScrollBar,b$S=b$i&&b$y>this._height,b$f=b$H&&b$M>this._width,b$V=b$S?this._width-b$i.width:this._width,b$K=b$f?this._height-b$H.height:this._height;b$i&&(b$i.x=this._width-b$i.width,b$i.y=0,b$i.height=this._height-(b$f?b$H.height:0),b$i.scrollSize=Math.max(.033*this._height,1),b$i.thumbPercent=b$K/b$y,b$i.setScroll(0,b$y-b$K,b$i.value)),b$H&&(b$H.x=0,b$H.y=this._height-b$H.height,b$H.width=this._width-(b$S?b$i.width:0),b$H.scrollSize=Math.max(.033*this._width,1),b$H.thumbPercent=b$V/b$M,b$H.setScroll(0,b$M-b$V,b$H.value))},b$i.changeSize=function(){laya.ui.Component.prototype.changeSize.call(this),this.setContentSize(this._width,this._height)},b$i.setContentSize=function(b$M,b$y){var b$i=this._content;b$i.width=b$M,b$i.height=b$y,b$i.scrollRect||(b$i.scrollRect=new b$C),b$i.scrollRect.setTo(0,0,b$M,b$y),b$i.scrollRect=b$i.scrollRect},b$i.onScrollBarChange=function(b$M){var b$y=this._content.scrollRect;if(b$y){var b$i=Math.round(b$M.value);b$M.isVertical?b$y.y=b$i:b$y.x=b$i,this._content.scrollRect=b$y}},b$i.scrollTo=function(b$M,b$y){void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),this.vScrollBar&&(this.vScrollBar.value=b$y),this.hScrollBar&&(this.hScrollBar.value=b$M)},b$i.refresh=function(){this.changeScroll()},b$i.onScrollStart=function(){this._$P.cacheAs||(this._$P.cacheAs=b$J.superGet(b$D,this,"cacheAs")),b$J.superSet(b$D,this,"cacheAs","none"),this._hScrollBar&&this._hScrollBar.once("end",this,this.onScrollEnd),this._vScrollBar&&this._vScrollBar.once("end",this,this.onScrollEnd)},b$i.onScrollEnd=function(){b$J.superSet(b$D,this,"cacheAs",this._$P.cacheAs)},b$i._setScrollChanged=function(){this._scrollChanged||(this._scrollChanged=!0,this.callLater(this.changeScroll))},b$S(0,b$i,"numChildren",function(){return this._content.numChildren}),b$S(0,b$i,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(b$M){null==this._hScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._hScrollBar=new b$$),this._hScrollBar.on("change",this,this.onScrollBarChange,[this._hScrollBar]),this._hScrollBar.target=this._content,this._setScrollChanged()),this._hScrollBar.skin=b$M}),b$S(0,b$i,"contentWidth",function(){for(var b$M=0,b$y=this._content.numChildren-1;-1<b$y;b$y--){var b$i=this._content.getChildAt(b$y);b$M=Math.max(b$i.x+b$i.width*b$i.scaleX,b$M)}return b$M}),b$S(0,b$i,"contentHeight",function(){for(var b$M=0,b$y=this._content.numChildren-1;-1<b$y;b$y--){var b$i=this._content.getChildAt(b$y);b$M=Math.max(b$i.y+b$i.height*b$i.scaleY,b$M)}return b$M}),b$S(0,b$i,"width",b$M.prototype._$get_width,function(b$M){b$J.superSet(b$D,this,"width",b$M),this._setScrollChanged()}),b$S(0,b$i,"hScrollBar",function(){return this._hScrollBar}),b$S(0,b$i,"content",function(){return this._content}),b$S(0,b$i,"height",b$M.prototype._$get_height,function(b$M){b$J.superSet(b$D,this,"height",b$M),this._setScrollChanged()}),b$S(0,b$i,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(b$M){null==this._vScrollBar&&(laya.display.Node.prototype.addChild.call(this,this._vScrollBar=new b$yM),this._vScrollBar.on("change",this,this.onScrollBarChange,[this._vScrollBar]),this._vScrollBar.target=this._content,this._setScrollChanged()),this._vScrollBar.skin=b$M}),b$S(0,b$i,"vScrollBar",function(){return this._vScrollBar}),b$S(0,b$i,"cacheAs",b$M.prototype._$get_cacheAs,function(b$M){b$J.superSet(b$D,this,"cacheAs",b$M),this._$P.cacheAs=null,"none"!==b$M?(this._hScrollBar&&this._hScrollBar.on("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.on("start",this,this.onScrollStart)):(this._hScrollBar&&this._hScrollBar.off("start",this,this.onScrollStart),this._vScrollBar&&this._vScrollBar.off("start",this,this.onScrollStart))}),b$y}(b$D),b$g=function(b$M){function b$y(b$M){b$y.__super.call(this,b$M),this.isVertical=!1}return b$f(b$y,"laya.ui.HSlider",b$p),b$y}(),b$j=function(b$M){function b$i(b$M,b$y){this.selectHandler=null,this._items=null,this._selectedIndex=-1,this._skin=null,this._direction="horizontal",this._space=0,this._labels=null,this._labelColors=null,this._labelFont=null,this._labelStrokeColor=null,this._strokeColors=null,this._labelStroke=NaN,this._labelSize=0,this._labelBold=!1,this._labelPadding=null,this._labelAlign=null,this._stateNum=0,this._labelChanged=!1,b$i.__super.call(this),this.skin=b$y,this.labels=b$M}b$f(b$i,"laya.ui.UIGroup",b$M);var b$y=b$i.prototype;return b$J.imps(b$y,{"laya.ui.IItem":!0}),b$y.preinitialize=function(){this.mouseEnabled=!0},b$y.destroy=function(b$M){void 0===b$M&&(b$M=!0),laya.ui.Component.prototype.destroy.call(this,b$M),this._items&&(this._items.length=0),this._items=null,this.selectHandler=null},b$y.addItem=function(b$M,b$y){void 0===b$y&&(b$y=!0);var b$i=b$M,b$H=this._items.length;if(b$i.name="item"+b$H,this.addChild(b$i),this.initItems(),b$y&&0<b$H){var b$S=this._items[b$H-1];"horizontal"==this._direction?b$i.x=b$S.x+b$S.width+this._space:b$i.y=b$S.y+b$S.height+this._space}else b$y&&(b$i.x=0,b$i.y=0);return b$H},b$y.delItem=function(b$M,b$y){void 0===b$y&&(b$y=!0);var b$i=this._items.indexOf(b$M);if(-1!=b$i){var b$H=b$M;this.removeChild(b$H);for(var b$S=b$i+1,b$f=this._items.length;b$S<b$f;b$S++){var b$V=this._items[b$S];b$V.name="item"+(b$S-1),b$y&&("horizontal"==this._direction?b$V.x-=b$H.width+this._space:b$V.y-=b$H.height+this._space)}if(this.initItems(),-1<this._selectedIndex){var b$K;b$K=this._selectedIndex<this._items.length?this._selectedIndex:this._selectedIndex-1,this._selectedIndex=-1,this.selectedIndex=b$K}}},b$y.initItems=function(){this._items||(this._items=[]);for(var b$M=this._items.length=0;b$M<1e4;b$M++){var b$y=this.getChildByName("item"+b$M);if(null==b$y)break;this._items.push(b$y),b$y.selected=b$M===this._selectedIndex,b$y.clickHandler=b$d.create(this,this.itemClick,[b$M],!1)}},b$y.itemClick=function(b$M){this.selectedIndex=b$M},b$y.setSelect=function(b$M,b$y){this._items&&-1<b$M&&b$M<this._items.length&&(this._items[b$M].selected=b$y)},b$y.createItem=function(b$M,b$y){return null},b$y.changeLabels=function(){if(this._labelChanged=!1,this._items)for(var b$M=0,b$y=0,b$i=this._items.length;b$y<b$i;b$y++){var b$H=this._items[b$y];this._skin&&(b$H.skin=this._skin),this._labelColors&&(b$H.labelColors=this._labelColors),this._labelSize&&(b$H.labelSize=this._labelSize),this._labelStroke&&(b$H.labelStroke=this._labelStroke),this._labelStrokeColor&&(b$H.labelStrokeColor=this._labelStrokeColor),this._strokeColors&&(b$H.strokeColors=this._strokeColors),this._labelBold&&(b$H.labelBold=this._labelBold),this._labelPadding&&(b$H.labelPadding=this._labelPadding),this._labelAlign&&(b$H.labelAlign=this._labelAlign),this._stateNum&&(b$H.stateNum=this._stateNum),this._labelFont&&(b$H.labelFont=this._labelFont),"horizontal"===this._direction?(b$H.y=0,b$H.x=b$M,b$M+=b$H.width+this._space):(b$H.x=0,b$H.y=b$M,b$M+=b$H.height+this._space)}this.changeSize()},b$y.commitMeasure=function(){this.runCallLater(this.changeLabels)},b$y._setLabelChanged=function(){this._labelChanged||(this._labelChanged=!0,this.callLater(this.changeLabels))},b$S(0,b$y,"labelStrokeColor",function(){return this._labelStrokeColor},function(b$M){this._labelStrokeColor!=b$M&&(this._labelStrokeColor=b$M,this._setLabelChanged())}),b$S(0,b$y,"skin",function(){return this._skin},function(b$M){this._skin!=b$M&&(this._skin=b$M,this._setLabelChanged())}),b$S(0,b$y,"selectedIndex",function(){return this._selectedIndex},function(b$M){this._selectedIndex!=b$M&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=b$M,this.setSelect(b$M,!0),this.event("change"),this.selectHandler&&this.selectHandler.runWith(this._selectedIndex))}),b$S(0,b$y,"labels",function(){return this._labels},function(b$M){if(this._labels!=b$M){if(this._labels=b$M,this.removeChildren(),this._setLabelChanged(),this._labels)for(var b$y=this._labels.split(","),b$i=0,b$H=b$y.length;b$i<b$H;b$i++){var b$S=this.createItem(this._skin,b$y[b$i]);b$S.name="item"+b$i,this.addChild(b$S)}this.initItems()}}),b$S(0,b$y,"strokeColors",function(){return this._strokeColors},function(b$M){this._strokeColors!=b$M&&(this._strokeColors=b$M,this._setLabelChanged())}),b$S(0,b$y,"labelColors",function(){return this._labelColors},function(b$M){this._labelColors!=b$M&&(this._labelColors=b$M,this._setLabelChanged())}),b$S(0,b$y,"labelStroke",function(){return this._labelStroke},function(b$M){this._labelStroke!=b$M&&(this._labelStroke=b$M,this._setLabelChanged())}),b$S(0,b$y,"labelSize",function(){return this._labelSize},function(b$M){this._labelSize!=b$M&&(this._labelSize=b$M,this._setLabelChanged())}),b$S(0,b$y,"stateNum",function(){return this._stateNum},function(b$M){this._stateNum!=b$M&&(this._stateNum=b$M,this._setLabelChanged())}),b$S(0,b$y,"labelBold",function(){return this._labelBold},function(b$M){this._labelBold!=b$M&&(this._labelBold=b$M,this._setLabelChanged())}),b$S(0,b$y,"labelFont",function(){return this._labelFont},function(b$M){this._labelFont!=b$M&&(this._labelFont=b$M,this._setLabelChanged())}),b$S(0,b$y,"labelPadding",function(){return this._labelPadding},function(b$M){this._labelPadding!=b$M&&(this._labelPadding=b$M,this._setLabelChanged())}),b$S(0,b$y,"direction",function(){return this._direction},function(b$M){this._direction=b$M,this._setLabelChanged()}),b$S(0,b$y,"space",function(){return this._space},function(b$M){this._space=b$M,this._setLabelChanged()}),b$S(0,b$y,"items",function(){return this._items}),b$S(0,b$y,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(b$M){this.selectedIndex=this._items.indexOf(b$M)}),b$S(0,b$y,"dataSource",b$M.prototype._$get_dataSource,function(b$M){"number"==typeof(this._dataSource=b$M)&&Math.floor(b$M)==b$M||"string"==typeof b$M?this.selectedIndex=parseInt(b$M):b$M instanceof Array?this.labels=b$M.join(","):b$J.superSet(b$D,this,"dataSource",b$M)}),b$i}(b$D),b$O=function(b$y){function b$i(b$M,b$y){this._value=null,void 0===b$y&&(b$y=""),b$i.__super.call(this,b$M,b$y)}b$f(b$i,"laya.ui.Radio",b$y);var b$M=b$i.prototype;return b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,b$M),this._value=null},b$M.preinitialize=function(){laya.ui.Component.prototype.preinitialize.call(this),this.toggle=!1,this._autoSize=!1},b$M.initialize=function(){b$y.prototype.initialize.call(this),this.createText(),this._text.align="left",this._text.valign="top",this._text.width=0,this.on("click",this,this.onClick)},b$M.onClick=function(b$M){this.selected=!0},b$S(0,b$M,"value",function(){return null!=this._value?this._value:this.label},function(b$M){this._value=b$M}),b$i}(b$z),b$L=function(b$M){function b$y(){this._list=null,this._source=null,this._renderHandler=null,this._spaceLeft=10,this._spaceBottom=0,this._keepStatus=!0,b$y.__super.call(this),this.width=this.height=200}b$f(b$y,"laya.ui.Tree",b$M);var b$i=b$y.prototype;return b$J.imps(b$i,{"laya.ui.IRender":!0}),b$i.destroy=function(b$M){void 0===b$M&&(b$M=!0),laya.ui.Component.prototype.destroy.call(this,b$M),this._list&&this._list.destroy(b$M),this._list=null,this._source=null,this._renderHandler=null},b$i.createChildren=function(){this.addChild(this._list=new b$N),this._list.renderHandler=b$d.create(this,this.renderItem,null,!1),this._list.repeatX=1,this._list.on("change",this,this.onListChange)},b$i.onListChange=function(b$M){this.event("change")},b$i.getArray=function(){var b$M,b$y=[];for(var b$i in this._source)b$M=this._source[b$i],this.getParentOpenStatus(b$M)&&(b$M.x=this._spaceLeft*this.getDepth(b$M),b$y.push(b$M));return b$y},b$i.getDepth=function(b$M,b$y){return void 0===b$y&&(b$y=0),null==b$M.nodeParent?b$y:this.getDepth(b$M.nodeParent,b$y+1)},b$i.getParentOpenStatus=function(b$M){var b$y=b$M.nodeParent;return null==b$y||!!b$y.isOpen&&(null==b$y.nodeParent||this.getParentOpenStatus(b$y))},b$i.renderItem=function(b$M,b$y){var b$i=b$M.dataSource;if(b$i){b$M.left=b$i.x;var b$H=b$M.getChildByName("arrow");b$H&&(b$i.hasChild?(b$H.visible=!0,b$H.index=b$i.isOpen?1:0,b$H.tag=b$y,b$H.off("click",this,this.onArrowClick),b$H.on("click",this,this.onArrowClick)):b$H.visible=!1);var b$S=b$M.getChildByName("folder");b$S&&(2==b$S.clipY?b$S.index=b$i.isDirectory?0:1:b$S.index=b$i.isDirectory?b$i.isOpen?1:0:2),this._renderHandler&&this._renderHandler.runWith([b$M,b$y])}},b$i.onArrowClick=function(b$M){var b$y=b$M.currentTarget.tag;this._list.array[b$y].isOpen=!this._list.array[b$y].isOpen,this.event("open"),this._list.array=this.getArray()},b$i.setItemState=function(b$M,b$y){this._list.array[b$M]&&(this._list.array[b$M].isOpen=b$y,this._list.array=this.getArray())},b$i.fresh=function(){this._list.array=this.getArray(),this.repaint()},b$i.parseXml=function(b$M,b$y,b$i,b$H){var b$S,b$f=b$M.childNodes,b$V=b$f.length;if(!b$H){b$S={};var b$K,b$k=b$M.attributes;for(var b$X in b$k){var b$F=(b$K=b$k[b$X]).nodeName,b$o=b$K.nodeValue;b$S[b$F]="true"==b$o||"false"!=b$o&&b$o}b$S.nodeParent=b$i,0<b$V&&(b$S.isDirectory=!0),b$S.hasChild=0<b$V,b$y.push(b$S)}for(var b$d=0;b$d<b$V;b$d++){var b$P=b$f[b$d];this.parseXml(b$P,b$y,b$S,!1)}},b$i.parseOpenStatus=function(b$M,b$y){for(var b$i=0,b$H=b$y.length;b$i<b$H;b$i++){var b$S=b$y[b$i];if(b$S.isDirectory)for(var b$f=0,b$V=b$M.length;b$f<b$V;b$f++){var b$K=b$M[b$f];if(b$K.isDirectory&&this.isSameParent(b$K,b$S)&&b$S.label==b$K.label){b$S.isOpen=b$K.isOpen;break}}}},b$i.isSameParent=function(b$M,b$y){return null==b$M.nodeParent&&null==b$y.nodeParent||null!=b$M.nodeParent&&null!=b$y.nodeParent&&(b$M.nodeParent.label==b$y.nodeParent.label&&this.isSameParent(b$M.nodeParent,b$y.nodeParent))},b$i.filter=function(b$M){if(Boolean(b$M)){var b$y=[];this.getFilterSource(this._source,b$y,b$M),this._list.array=b$y}else this._list.array=this.getArray()},b$i.getFilterSource=function(b$M,b$y,b$i){var b$H;for(var b$S in b$i=b$i.toLocaleLowerCase(),b$M)!(b$H=b$M[b$S]).isDirectory&&-1<String(b$H.label).toLowerCase().indexOf(b$i)&&(b$H.x=0,b$y.push(b$H)),b$H.child&&0<b$H.child.length&&this.getFilterSource(b$H.child,b$y,b$i)},b$S(0,b$i,"spaceBottom",function(){return this._list.spaceY},function(b$M){this._list.spaceY=b$M}),b$S(0,b$i,"keepStatus",function(){return this._keepStatus},function(b$M){this._keepStatus=b$M}),b$S(0,b$i,"itemRender",function(){return this._list.itemRender},function(b$M){this._list.itemRender=b$M}),b$S(0,b$i,"array",function(){return this._list.array},function(b$M){this._keepStatus&&this._list.array&&b$M&&this.parseOpenStatus(this._list.array,b$M),this._source=b$M,this._list.array=this.getArray()}),b$S(0,b$i,"mouseHandler",function(){return this._list.mouseHandler},function(b$M){this._list.mouseHandler=b$M}),b$S(0,b$i,"dataSource",b$M.prototype._$get_dataSource,function(b$M){this._dataSource=b$M,b$J.superSet(b$D,this,"dataSource",b$M)}),b$S(0,b$i,"source",function(){return this._source}),b$S(0,b$i,"scrollBar",function(){return this._list.scrollBar}),b$S(0,b$i,"list",function(){return this._list}),b$S(0,b$i,"scrollBarSkin",function(){return this._list.vScrollBarSkin},function(b$M){this._list.vScrollBarSkin=b$M}),b$S(0,b$i,"renderHandler",function(){return this._renderHandler},function(b$M){this._renderHandler=b$M}),b$S(0,b$i,"selectedIndex",function(){return this._list.selectedIndex},function(b$M){this._list.selectedIndex=b$M}),b$S(0,b$i,"spaceLeft",function(){return this._spaceLeft},function(b$M){this._spaceLeft=b$M}),b$S(0,b$i,"selectedItem",function(){return this._list.selectedItem},function(b$M){this._list.selectedItem=b$M}),b$S(0,b$i,"width",b$M.prototype._$get_width,function(b$M){b$J.superSet(b$D,this,"width",b$M),this._list.width=b$M}),b$S(0,b$i,"height",b$M.prototype._$get_height,function(b$M){b$J.superSet(b$D,this,"height",b$M),this._list.height=b$M}),b$S(0,b$i,"xml",null,function(b$M){var b$y=[];this.parseXml(b$M.childNodes[0],b$y,null,!0),this.array=b$y}),b$S(0,b$i,"selectedPath",function(){return this._list.selectedItem?this._list.selectedItem.path:null}),b$y}(b$D),b$MM=function(b$M){function b$y(){this._items=null,this._selectedIndex=0,b$y.__super.call(this),this._setIndexHandler=b$d.create(this,this.setIndex,null,!1)}b$f(b$y,"laya.ui.ViewStack",b$M);var b$i=b$y.prototype;return b$J.imps(b$i,{"laya.ui.IItem":!0}),b$i.setItems=function(b$M){this.removeChildren();for(var b$y=0,b$i=0,b$H=b$M.length;b$i<b$H;b$i++){var b$S=b$M[b$i];b$S&&(b$S.name="item"+b$y,this.addChild(b$S),b$y++)}this.initItems()},b$i.addItem=function(b$M){b$M.name="item"+this._items.length,this.addChild(b$M),this.initItems()},b$i.initItems=function(){this._items=[];for(var b$M=0;b$M<1e4;b$M++){var b$y=this.getChildByName("item"+b$M);if(null==b$y)break;this._items.push(b$y),b$y.visible=b$M==this._selectedIndex}},b$i.setSelect=function(b$M,b$y){this._items&&-1<b$M&&b$M<this._items.length&&(this._items[b$M].visible=b$y)},b$i.setIndex=function(b$M){this.selectedIndex=b$M},b$S(0,b$i,"dataSource",b$M.prototype._$get_dataSource,function(b$M){if("number"==typeof(this._dataSource=b$M)&&Math.floor(b$M)==b$M||"string"==typeof b$M)this.selectedIndex=parseInt(b$M);else for(var b$y in this._dataSource)this.hasOwnProperty(b$y)&&(this[b$y]=this._dataSource[b$y])}),b$S(0,b$i,"selectedIndex",function(){return this._selectedIndex},function(b$M){this._selectedIndex!=b$M&&(this.setSelect(this._selectedIndex,!1),this._selectedIndex=b$M,this.setSelect(this._selectedIndex,!0))}),b$S(0,b$i,"selection",function(){return-1<this._selectedIndex&&this._selectedIndex<this._items.length?this._items[this._selectedIndex]:null},function(b$M){this.selectedIndex=this._items.indexOf(b$M)}),b$S(0,b$i,"items",function(){return this._items}),b$S(0,b$i,"setIndexHandler",function(){return this._setIndexHandler},function(b$M){this._setIndexHandler=b$M}),b$y}(b$D),b$yM=function(b$M){function b$y(){b$y.__super.call(this)}return b$f(b$y,"laya.ui.VScrollBar",b$u),b$y}(),b$iM=function(b$y){function b$i(b$M){this._bg=null,this._skin=null,b$i.__super.call(this),void 0===b$M&&(b$M=""),this.text=b$M,this.skin=this.skin}b$f(b$i,"laya.ui.TextInput",b$y);var b$M=b$i.prototype;return b$M.preinitialize=function(){this.mouseEnabled=!0},b$M.destroy=function(b$M){b$v.clearCache(this,this._skin),void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,b$M),this._bg&&this._bg.destroy(),this._bg=null},b$M.createChildren=function(){this.addChild(this._tf=new b$P),this._tf.padding=b$n.inputLabelPadding,this._tf.on("input",this,this._onInput),this._tf.on("enter",this,this._onEnter),this._tf.on("blur",this,this._onBlur),this._tf.on("focus",this,this._onFocus)},b$M._onFocus=function(){this.event("focus",this)},b$M._onBlur=function(){this.event("blur",this)},b$M._onInput=function(){this.event("input",this)},b$M._onEnter=function(){this.event("enter",this)},b$M.initialize=function(){this.width=128,this.height=22},b$M.select=function(){this._tf.select()},b$M.setSelection=function(b$M,b$y){this._tf.setSelection(b$M,b$y)},b$S(0,b$M,"text",b$y.prototype._$get_text,function(b$M){this._tf.text!=b$M&&(b$M+="",this._tf.text=b$M,this.event("change"))}),b$S(0,b$M,"bg",function(){return this._bg},function(b$M){this.graphics=this._bg=b$M}),b$S(0,b$M,"inputElementYAdjuster",function(){return this._tf.inputElementYAdjuster},function(b$M){this._tf.inputElementYAdjuster=b$M}),b$S(0,b$M,"multiline",function(){return this._tf.multiline},function(b$M){this._tf.multiline=b$M}),b$S(0,b$M,"skin",function(){return this._skin},function(b$M){this._skin!=b$M&&(b$v.clearCache(this,this._skin),this._skin=b$M,this._bg||(this.graphics=this._bg=new b$m),b$v.keepCache(this,this._skin),this._bg.source=b$v.getRes(this._skin),this._width&&(this._bg.width=this._width),this._height&&(this._bg.height=this._height))}),b$S(0,b$M,"sizeGrid",function(){return this._bg&&this._bg.sizeGrid?this._bg.sizeGrid.join(","):null},function(b$M){this._bg||(this.graphics=this._bg=new b$m),this._bg.sizeGrid=b$a.fillArray(b$n.defaultSizeGrid,b$M,Number)}),b$S(0,b$M,"inputElementXAdjuster",function(){return this._tf.inputElementXAdjuster},function(b$M){this._tf.inputElementXAdjuster=b$M}),b$S(0,b$M,"width",b$y.prototype._$get_width,function(b$M){b$J.superSet(b$Z,this,"width",b$M),this._bg&&(this._bg.width=b$M)}),b$S(0,b$M,"height",b$y.prototype._$get_height,function(b$M){b$J.superSet(b$Z,this,"height",b$M),this._bg&&(this._bg.height=b$M)}),b$S(0,b$M,"editable",function(){return this._tf.editable},function(b$M){this._tf.editable=b$M}),b$S(0,b$M,"restrict",function(){return this._tf.restrict},function(b$M){this._tf.restrict=b$M}),b$S(0,b$M,"prompt",function(){return this._tf.prompt},function(b$M){this._tf.prompt=b$M}),b$S(0,b$M,"promptColor",function(){return this._tf.promptColor},function(b$M){this._tf.promptColor=b$M}),b$S(0,b$M,"maxChars",function(){return this._tf.maxChars},function(b$M){this._tf.maxChars=b$M}),b$S(0,b$M,"focus",function(){return this._tf.focus},function(b$M){this._tf.focus=b$M}),b$S(0,b$M,"type",function(){return this._tf.type},function(b$M){this._tf.type=b$M}),b$S(0,b$M,"asPassword",function(){return this._tf.asPassword},function(b$M){this._tf.asPassword=b$M}),b$i}(b$Z),b$HM=function(b$M){function b$y(){b$y.__super.call(this)}return b$f(b$y,"laya.ui.VSlider",b$p),b$y}(),b$SM=function(b$M){function b$H(){this.popupCenter=!0,this.closeHandler=null,this.popupEffect=null,this.closeEffect=null,this.group=null,this.isModal=!1,this._dragArea=null,b$H.__super.call(this)}b$f(b$H,"laya.ui.Dialog",b$M);var b$y=b$H.prototype;return b$y.initialize=function(){this.popupEffect=b$H.manager.popupEffectHandler,this.closeEffect=b$H.manager.closeEffectHandler,this._dealDragArea(),this.on("click",this,this._onClick)},b$y._dealDragArea=function(){var b$M=this.getChildByName("drag");b$M&&(this.dragArea=b$M.x+","+b$M.y+","+b$M.width+","+b$M.height,b$M.removeSelf())},b$y._onClick=function(b$M){var b$y=b$M.target;if(b$y)switch(b$y.name){case"close":case"cancel":case"sure":case"no":case"ok":case"yes":this.close(b$y.name)}},b$y.show=function(b$M,b$y){void 0===b$M&&(b$M=!1),void 0===b$y&&(b$y=!0),this._open(!1,b$M,b$y)},b$y.popup=function(b$M,b$y){void 0===b$M&&(b$M=!1),void 0===b$y&&(b$y=!0),this._open(!0,b$M,b$y)},b$y._open=function(b$M,b$y,b$i){b$H.manager.lock(!1),this.isModal=b$M,b$H.manager.open(this,b$y,b$i)},b$y.onOpened=function(){},b$y.close=function(b$M,b$y){void 0===b$y&&(b$y=!0),b$H.manager.close(this,b$M,b$y)},b$y.onClosed=function(b$M){},b$y._onMouseDown=function(b$M){var b$y=this.getMousePoint();this._dragArea.contains(b$y.x,b$y.y)?this.startDrag():this.stopDrag()},b$S(0,b$y,"dragArea",function(){return this._dragArea?this._dragArea.toString():null},function(b$M){if(b$M){var b$y=b$a.fillArray([0,0,0,0],b$M,Number);this._dragArea=new b$C(b$y[0],b$y[1],b$y[2],b$y[3]),this.on("mousedown",this,this._onMouseDown)}else this._dragArea=null,this.off("mousedown",this,this._onMouseDown)}),b$S(0,b$y,"isPopup",function(){return null!=this.parent}),b$S(0,b$y,"zOrder",b$M.prototype._$get_zOrder,function(b$M){b$J.superSet(b$_,this,"zOrder",b$M),b$H.manager._checkMask()}),b$S(1,b$H,"manager",function(){return b$H._manager=b$H._manager||new b$s},function(b$M){b$H._manager=b$M}),b$H.setLockView=function(b$M){b$H.manager.setLockView(b$M)},b$H.lock=function(b$M){b$H.manager.lock(b$M)},b$H.closeAll=function(){b$H.manager.closeAll()},b$H.getDialogsByGroup=function(b$M){return b$H.manager.getDialogsByGroup(b$M)},b$H.closeByGroup=function(b$M){return b$H.manager.closeByGroup(b$M)},b$H.CLOSE="close",b$H.CANCEL="cancel",b$H.SURE="sure",b$H.NO="no",b$H.OK="ok",b$H.YES="yes",b$H._manager=null,b$H}(b$_),b$fM=function(b$M){function b$y(){b$y.__super.call(this)}b$f(b$y,"laya.ui.HBox",b$M);var b$i=b$y.prototype;return b$i.sortItem=function(b$M){b$M&&b$M.sort(function(b$M,b$y){return b$M.x-b$y.x})},b$i.changeItems=function(){this._itemChanged=!1;for(var b$M=[],b$y=0,b$i=0,b$H=this.numChildren;b$i<b$H;b$i++){var b$S=this.getChildAt(b$i);b$S&&b$S.layoutEnabled&&(b$M.push(b$S),b$y=this._height?this._height:Math.max(b$y,b$S.height*b$S.scaleY))}this.sortItem(b$M);var b$f=0;for(b$i=0,b$H=b$M.length;b$i<b$H;b$i++)(b$S=b$M[b$i]).x=b$f,b$f+=b$S.width*b$S.scaleX+this._space,"top"==this._align?b$S.y=0:"middle"==this._align?b$S.y=.5*(b$y-b$S.height*b$S.scaleY):"bottom"==this._align&&(b$S.y=b$y-b$S.height*b$S.scaleY);this.changeSize()},b$S(0,b$i,"height",b$M.prototype._$get_height,function(b$M){this._height!=b$M&&(b$J.superSet(b$Y,this,"height",b$M),this.callLater(this.changeItems))}),b$y.NONE="none",b$y.TOP="top",b$y.MIDDLE="middle",b$y.BOTTOM="bottom",b$y}(b$Y),b$VM=function(b$M){function b$y(){b$y.__super.call(this)}b$f(b$y,"laya.ui.VBox",b$M);var b$i=b$y.prototype;return b$i.changeItems=function(){this._itemChanged=!1;for(var b$M=[],b$y=0,b$i=0,b$H=this.numChildren;b$i<b$H;b$i++){var b$S=this.getChildAt(b$i);b$S&&b$S.layoutEnabled&&(b$M.push(b$S),b$y=this._width?this._width:Math.max(b$y,b$S.width*b$S.scaleX))}this.sortItem(b$M);var b$f=0;for(b$i=0,b$H=b$M.length;b$i<b$H;b$i++)(b$S=b$M[b$i]).y=b$f,b$f+=b$S.height*b$S.scaleY+this._space,"left"==this._align?b$S.x=0:"center"==this._align?b$S.x=.5*(b$y-b$S.width*b$S.scaleX):"right"==this._align&&(b$S.x=b$y-b$S.width*b$S.scaleX);this.changeSize()},b$S(0,b$i,"width",b$M.prototype._$get_width,function(b$M){this._width!=b$M&&(b$J.superSet(b$Y,this,"width",b$M),this.callLater(this.changeItems))}),b$y.NONE="none",b$y.LEFT="left",b$y.CENTER="center",b$y.RIGHT="right",b$y}(b$Y),b$KM=function(b$M){function b$y(){b$y.__super.call(this)}return b$f(b$y,"laya.ui.RadioGroup",b$j),b$y.prototype.createItem=function(b$M,b$y){return new b$O(b$M,b$y)},b$y}(),b$kM=function(b$M){function b$y(){b$y.__super.call(this)}return b$f(b$y,"laya.ui.Tab",b$j),b$y.prototype.createItem=function(b$M,b$y){return new b$z(b$M,b$y)},b$y}(),b$XM=function(b$y){function b$i(b$M){this._vScrollBar=null,this._hScrollBar=null,void 0===b$M&&(b$M=""),b$i.__super.call(this,b$M)}b$f(b$i,"laya.ui.TextArea",b$y);var b$M=b$i.prototype;return b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,b$M),this._vScrollBar&&this._vScrollBar.destroy(),this._hScrollBar&&this._hScrollBar.destroy(),this._vScrollBar=null,this._hScrollBar=null},b$M.initialize=function(){this.width=180,this.height=150,this._tf.wordWrap=!0,this.multiline=!0},b$M.onVBarChanged=function(b$M){this._tf.scrollY!=this._vScrollBar.value&&(this._tf.scrollY=this._vScrollBar.value)},b$M.onHBarChanged=function(b$M){this._tf.scrollX!=this._hScrollBar.value&&(this._tf.scrollX=this._hScrollBar.value)},b$M.changeScroll=function(){var b$M=this._vScrollBar&&0<this._tf.maxScrollY,b$y=this._hScrollBar&&0<this._tf.maxScrollX,b$i=b$M?this._width-this._vScrollBar.width:this._width,b$H=b$y?this._height-this._hScrollBar.height:this._height,b$S=this._tf.padding||b$n.labelPadding;this._tf.width=b$i,this._tf.height=b$H,this._vScrollBar&&(this._vScrollBar.x=this._width-this._vScrollBar.width-b$S[2],this._vScrollBar.y=b$S[1],this._vScrollBar.height=this._height-(b$y?this._hScrollBar.height:0)-b$S[1]-b$S[3],this._vScrollBar.scrollSize=1,this._vScrollBar.thumbPercent=b$H/Math.max(this._tf.textHeight,b$H),this._vScrollBar.setScroll(1,this._tf.maxScrollY,this._tf.scrollY),this._vScrollBar.visible=b$M),this._hScrollBar&&(this._hScrollBar.x=b$S[0],this._hScrollBar.y=this._height-this._hScrollBar.height-b$S[3],this._hScrollBar.width=this._width-(b$M?this._vScrollBar.width:0)-b$S[0]-b$S[2],this._hScrollBar.scrollSize=Math.max(.033*b$i,1),this._hScrollBar.thumbPercent=b$i/Math.max(this._tf.textWidth,b$i),this._hScrollBar.setScroll(0,this.maxScrollX,this.scrollX),this._hScrollBar.visible=b$y)},b$M.scrollTo=function(b$M){this.commitMeasure(),this._tf.scrollY=b$M},b$S(0,b$M,"scrollY",function(){return this._tf.scrollY}),b$S(0,b$M,"width",b$y.prototype._$get_width,function(b$M){b$J.superSet(b$iM,this,"width",b$M),this.callLater(this.changeScroll)}),b$S(0,b$M,"hScrollBar",function(){return this._hScrollBar}),b$S(0,b$M,"height",b$y.prototype._$get_height,function(b$M){b$J.superSet(b$iM,this,"height",b$M),this.callLater(this.changeScroll)}),b$S(0,b$M,"maxScrollX",function(){return this._tf.maxScrollX}),b$S(0,b$M,"vScrollBarSkin",function(){return this._vScrollBar?this._vScrollBar.skin:null},function(b$M){null==this._vScrollBar&&(this.addChild(this._vScrollBar=new b$yM),this._vScrollBar.on("change",this,this.onVBarChanged),this._vScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._vScrollBar.skin=b$M}),b$S(0,b$M,"hScrollBarSkin",function(){return this._hScrollBar?this._hScrollBar.skin:null},function(b$M){null==this._hScrollBar&&(this.addChild(this._hScrollBar=new b$$),this._hScrollBar.on("change",this,this.onHBarChanged),this._hScrollBar.mouseWheelEnable=!1,this._hScrollBar.target=this._tf,this.callLater(this.changeScroll)),this._hScrollBar.skin=b$M}),b$S(0,b$M,"vScrollBar",function(){return this._vScrollBar}),b$S(0,b$M,"maxScrollY",function(){return this._tf.maxScrollY}),b$S(0,b$M,"scrollX",function(){return this._tf.scrollX}),b$i}(b$iM);!function(b$M){function b$y(){this._uiView=null,this.isCloseOther=!1,b$y.__super.call(this)}b$f(b$y,"laya.ui.AsynDialog",b$SM);var b$i=b$y.prototype;b$i.createView=function(b$M){this._uiView=b$M},b$i._open=function(b$M,b$y,b$i){this.isModal=b$M,this.isCloseOther=b$y,b$SM.manager.lock(!0),this._uiView?this.onCreated():this.onOpen()},b$i.onCreated=function(){this.createUI(),this.onOpen()},b$i.createUI=function(){laya.ui.View.prototype.createView.call(this,this._uiView),this._uiView=null,this._dealDragArea()},b$i.onOpen=function(){b$SM.manager.open(this,this.isCloseOther),b$SM.manager.lock(!1)},b$i.close=function(b$M,b$y){void 0===b$y&&(b$y=!0),b$SM.manager.close(this),this.onClose()},b$i.onClose=function(){},b$i.destroy=function(b$M){void 0===b$M&&(b$M=!0),laya.ui.View.prototype.destroy.call(this,b$M),this._uiView=null,this.onDestroy()},b$i.onDestroy=function(){}}();b$J.__init([b$_])}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(b$M,b$y){"use strict";for(var b$i in Object.defineProperty(b$y,"__esModule",{value:!0}),Laya){var b$H=Laya[b$i];b$H&&b$H.__isclass&&(b$y[b$i]=b$H)}}),function(b$d,b$M,b$G){b$G.un,b$G.uns;var b$o=b$G.static,b$P=b$G.class,b$l=b$G.getset,b$H=b$G.__newvec,b$A=laya.maths.Arith,b$V=laya.webgl.atlas.AtlasResourceManager,b$i=laya.webgl.shader.BaseShader,b$e=laya.utils.Browser,b$K=laya.webgl.utils.Buffer,b$I=laya.utils.Byte,b$S=laya.utils.ClassUtils,b$k=b$G.Config,b$f=(laya.events.Event,laya.events.EventDispatcher),b$n=laya.utils.Handler,b$C=laya.net.Loader,b$y=laya.net.LoaderManager,b$X=(laya.maths.MathUtil,laya.display.Node),b$J=laya.renders.Render,b$F=(laya.renders.RenderContext,laya.renders.RenderSprite,laya.webgl.utils.RenderState2D),b$h=laya.resource.Resource,b$v=laya.utils.RunDriver,b$R=(laya.webgl.shader.Shader,laya.webgl.utils.ShaderCompile),b$U=laya.display.Sprite,b$Q=laya.utils.Stat,b$W=laya.utils.StringKey,b$a=(laya.display.css.Style,laya.resource.Texture,laya.net.URL),b$c=laya.utils.Utils,b$T=laya.webgl.WebGL,b$m=laya.webgl.WebGLContext;laya.webgl.canvas.WebGLContext2D;b$G.interface("laya.d3.core.IClone"),b$G.interface("laya.d3.graphics.IVertex"),b$G.interface("laya.d3.core.render.IUpdate"),b$G.interface("laya.d3.core.scene.ITreeNode"),b$G.interface("laya.d3.core.render.IRenderable");(function(){function b$z(){}b$P(b$z,"laya.d3.animation.AnimationClipParser01"),b$z.READ_DATA=function(){b$z._DATA.offset=b$z._reader.getUint32(),b$z._DATA.size=b$z._reader.getUint32()},b$z.READ_BLOCK=function(){for(var b$M=b$z._BLOCK.count=b$z._reader.getUint16(),b$y=b$z._BLOCK.blockStarts=[],b$i=b$z._BLOCK.blockLengths=[],b$H=0;b$H<b$M;b$H++)b$y.push(b$z._reader.getUint32()),b$i.push(b$z._reader.getUint32())},b$z.READ_STRINGS=function(){var b$M=b$z._reader.getUint32(),b$y=b$z._reader.getUint16(),b$i=b$z._reader.pos;b$z._reader.pos=b$M+b$z._DATA.offset;for(var b$H=0;b$H<b$y;b$H++)b$z._strings[b$H]=b$z._reader.readUTFString();b$z._reader.pos=b$i},b$z.parse=function(b$M,b$y){b$z._animationClip=b$M;(b$z._reader=b$y).__getBuffer();b$z.READ_DATA(),b$z.READ_BLOCK(),b$z.READ_STRINGS();for(var b$i=0,b$H=b$z._BLOCK.count;b$i<b$H;b$i++){var b$S=b$y.getUint16(),b$f=b$z._strings[b$S],b$V=b$z["READ_"+b$f];if(null==b$V)throw new Error("model file err,no this function:"+b$S+" "+b$f);b$V.call()}},b$z.READ_ANIMATIONS=function(){var b$M,b$y=0,b$i=0,b$H=b$z._reader,b$S=b$H.__getBuffer(),b$f=[],b$V=b$H.getUint8();for(b$f.length=b$V,b$y=0;b$y<b$V;b$y++)b$f[b$y]=b$H.getUint16();var b$K=[],b$k=b$H.getUint16();for(b$K.length=b$k,b$y=0;b$y<b$k;b$y++)b$K[b$y]=b$H.getFloat32();var b$X=b$z._animationClip;b$X.name=b$z._strings[b$H.getUint16()];var b$F=b$X._duration=b$H.getFloat32();b$X.islooping=!!b$H.getByte(),b$X._frameRate=b$H.getInt16();var b$o=b$H.getInt16(),b$d=b$X._nodes=new Array;b$d.length=b$o,(b$X._publicClipDatas=[]).length=b$o;var b$P=b$X._nodesMap={},b$l=0,b$J=0;for(b$y=0;b$y<b$o;b$y++){b$M=b$d[b$y]=new b$E;var b$h=b$H.getUint16(),b$C=b$M.path=[];for(b$C.length=b$h,b$i=0;b$i<b$h;b$i++)b$C[b$i]=b$z._strings[b$H.getUint16()];var b$v=b$C.join("/"),b$R=b$P[b$v];b$R||(b$P[b$v]=b$R=[]),b$R.push(b$M);var b$A=b$H.getInt16();-1!==b$A&&(b$M.componentType=b$z._strings[b$A]);var b$G=b$B._propertyIndexDic[b$z._strings[b$H.getUint16()]];if(null==b$G)throw new Error("AnimationClipParser01:unknown property name.");var b$I=b$G<4,b$U=!b$I||b$I&&""===b$C[0];(b$M._cacheProperty=b$U)?b$l++:b$J++,b$M.propertyNameID=b$G;var b$Q=b$f[b$H.getUint8()];b$M.keyFrameWidth=b$Q/4;var b$W=b$M.keyFrames=[],b$c=b$W.length=b$H.getUint16(),b$n=null,b$a=NaN;for(b$i=0;b$i<b$c;b$i++){var b$T=b$W[b$i]=new b$Z;b$a=b$T.startTime=b$K[b$H.getUint16()];var b$m=b$H.pos;b$T.inTangent=new Float32Array(b$S.slice(b$m,b$m+b$Q)),b$H.pos+=b$Q,b$m=b$H.pos,b$T.outTangent=new Float32Array(b$S.slice(b$m,b$m+b$Q)),b$H.pos+=b$Q,b$m=b$H.pos,b$T.data=new Float32Array(b$S.slice(b$m,b$m+b$Q)),b$H.pos+=b$Q,b$n&&(b$n.next=b$T,b$n.duration=b$a-b$n.startTime),b$n=b$T}b$T.next=null,b$T.duration=b$F-b$a}var b$e=b$X._nodeToCachePropertyMap=new Int32Array(b$o),b$s=b$X._cachePropertyMap=new Int32Array(b$l),b$D=b$X._unCachePropertyMap=new Int32Array(b$J);for(b$l=b$J=0,b$y=0;b$y<b$o;b$y++)(b$M=b$d[b$y])._cacheProperty?(b$e[b$y]=b$l,b$s[b$l++]=b$y):b$D[b$J++]=b$y},b$z._animationClip=null,b$z._reader=null,b$z._strings=[],b$o(b$z,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])})(),function(){function b$u(){}b$P(b$u,"laya.d3.animation.AnimationClipParser02"),b$u.READ_DATA=function(){b$u._DATA.offset=b$u._reader.getUint32(),b$u._DATA.size=b$u._reader.getUint32()},b$u.READ_BLOCK=function(){for(var b$M=b$u._BLOCK.count=b$u._reader.getUint16(),b$y=b$u._BLOCK.blockStarts=[],b$i=b$u._BLOCK.blockLengths=[],b$H=0;b$H<b$M;b$H++)b$y.push(b$u._reader.getUint32()),b$i.push(b$u._reader.getUint32())},b$u.READ_STRINGS=function(){var b$M=b$u._reader.getUint32(),b$y=b$u._reader.getUint16(),b$i=b$u._reader.pos;b$u._reader.pos=b$M+b$u._DATA.offset;for(var b$H=0;b$H<b$y;b$H++)b$u._strings[b$H]=b$u._reader.readUTFString();b$u._reader.pos=b$i},b$u.parse=function(b$M,b$y){b$u._animationClip=b$M;(b$u._reader=b$y).__getBuffer();b$u.READ_DATA(),b$u.READ_BLOCK(),b$u.READ_STRINGS();for(var b$i=0,b$H=b$u._BLOCK.count;b$i<b$H;b$i++){var b$S=b$y.getUint16(),b$f=b$u._strings[b$S],b$V=b$u["READ_"+b$f];if(null==b$V)throw new Error("model file err,no this function:"+b$S+" "+b$f);b$V.call()}},b$u.READ_ANIMATIONS=function(){var b$M,b$y=0,b$i=0,b$H=b$u._reader,b$S=b$H.__getBuffer(),b$f=[],b$V=b$H.getUint8();for(b$f.length=b$V,b$y=0;b$y<b$V;b$y++)b$f[b$y]=b$H.getUint16();var b$K=[],b$k=b$H.getUint16();for(b$K.length=b$k,b$y=0;b$y<b$k;b$y++)b$K[b$y]=b$H.getFloat32();var b$X=b$u._animationClip;b$X.name=b$u._strings[b$H.getUint16()];var b$F=b$X._duration=b$H.getFloat32();b$X.islooping=!!b$H.getByte(),b$X._frameRate=b$H.getInt16();var b$o=b$H.getInt16(),b$d=b$X._nodes=new Array;b$d.length=b$o,(b$X._publicClipDatas=[]).length=b$o;var b$P=b$X._nodesMap={},b$l=0,b$J=0;for(b$y=0;b$y<b$o;b$y++){b$M=b$d[b$y]=new b$E;var b$h=b$H.getUint16(),b$C=b$M.path=[];for(b$C.length=b$h,b$i=0;b$i<b$h;b$i++)b$C[b$i]=b$u._strings[b$H.getUint16()];var b$v=b$C.join("/"),b$R=b$P[b$v];b$R||(b$P[b$v]=b$R=[]),b$R.push(b$M);var b$A=b$H.getInt16();-1!==b$A&&(b$M.componentType=b$u._strings[b$A]);var b$G=b$B._propertyIndexDic[b$u._strings[b$H.getUint16()]];if(null==b$G)throw new Error("AnimationClipParser02:unknown property name.");var b$I=b$G<4,b$U=!b$I||b$I&&""===b$C[0];(b$M._cacheProperty=b$U)?b$l++:b$J++,b$M.propertyNameID=b$G;var b$Q=b$f[b$H.getUint8()];b$M.keyFrameWidth=b$Q/4;var b$W=b$M.keyFrames=[],b$c=b$W.length=b$H.getUint16(),b$n=null,b$a=NaN;for(b$i=0;b$i<b$c;b$i++){var b$T=b$W[b$i]=new b$Z;b$a=b$T.startTime=b$K[b$H.getUint16()];var b$m=b$H.pos;b$T.inTangent=new Float32Array(b$S.slice(b$m,b$m+b$Q)),b$H.pos+=b$Q,b$m=b$H.pos,b$T.outTangent=new Float32Array(b$S.slice(b$m,b$m+b$Q)),b$H.pos+=b$Q,b$m=b$H.pos,b$T.data=new Float32Array(b$S.slice(b$m,b$m+b$Q)),b$H.pos+=b$Q,b$n&&(b$n.next=b$T,b$n.duration=b$a-b$n.startTime),b$n=b$T}b$T.next=null,b$T.duration=b$F-b$a}var b$e=b$H.getUint16();for(b$y=0;b$y<b$e;b$y++){var b$s,b$D=new b$p;b$D.time=b$H.getFloat32(),b$D.eventName=b$u._strings[b$H.getUint16()];var b$z=b$H.getUint16();for(0<b$z&&(b$D.params=b$s=[]),b$i=0;b$i<b$z;b$i++){switch(b$H.getByte()){case 0:b$s.push(!!b$H.getByte());break;case 1:b$s.push(b$H.getInt32());break;case 2:b$s.push(b$H.getFloat32());break;case 3:b$s.push(b$u._strings[b$H.getUint16()]);break;default:throw new Error("unknown type.")}}b$X.addEvent(b$D)}var b$w=b$X._nodeToCachePropertyMap=new Int32Array(b$o),b$q=b$X._cachePropertyMap=new Int32Array(b$l),b$t=b$X._unCachePropertyMap=new Int32Array(b$J);for(b$l=b$J=0,b$y=0;b$y<b$o;b$y++)(b$M=b$d[b$y])._cacheProperty?(b$w[b$y]=b$l,b$q[b$l++]=b$y):b$t[b$J++]=b$y},b$u._animationClip=null,b$u._reader=null,b$u._strings=[],b$o(b$u,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}])}();var b$p=function(){function b$M(){this.time=NaN,this.eventName=null,this.params=null}return b$P(b$M,"laya.d3.animation.AnimationEvent"),b$M}(),b$B=function(){function b$H(){this._childs=[],this.transform=new b$vy(this)}b$P(b$H,"laya.d3.animation.AnimationNode");var b$M=b$H.prototype;return b$G.imps(b$M,{"laya.d3.core.IClone":!0}),b$M.addChild=function(b$M){b$M._parent=this,b$M.transform.setParent(this.transform),this._childs.push(b$M)},b$M.removeChild=function(b$M){var b$y=this._childs.indexOf(b$M);-1!==b$y&&this._childs.splice(b$y,1)},b$M.getChildByName=function(b$M){for(var b$y=0,b$i=this._childs.length;b$y<b$i;b$y++){var b$H=this._childs[b$y];if(b$H.name===b$M)return b$H}return null},b$M.getChildByIndex=function(b$M){return this._childs[b$M]},b$M.getChildCount=function(){return this._childs.length},b$M.cloneTo=function(b$M){var b$y=b$M;b$y.name=this.name;for(var b$i=0,b$H=this._childs.length;b$i<b$H;b$i++){var b$S=this._childs[b$i],b$f=b$S.clone();b$y.addChild(b$f);var b$V=b$S.transform,b$K=b$f.transform;b$K.setLocalPosition(b$V.getLocalPosition()),b$K.setLocalRotation(b$V.getLocalRotation()),b$K.setLocalScale(b$V.getLocalScale()),b$K._localRotationEuler=b$V._localRotationEuler,b$K._setWorldMatrixIgnoreUpdate(b$V.getWorldMatrix())}},b$M.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$H.__init__=function(){b$H.registerAnimationNodeProperty("localPosition",b$H._getLocalPosition,b$H._setLocalPosition),b$H.registerAnimationNodeProperty("localRotation",b$H._getLocalRotation,b$H._setLocalRotation),b$H.registerAnimationNodeProperty("localScale",b$H._getLocalScale,b$H._setLocalScale),b$H.registerAnimationNodeProperty("localRotationEuler",b$H._getLocalRotationEuler,b$H._setLocalRotationEuler),b$H.registerAnimationNodeProperty("particleRender.sharedMaterial.tintColor",b$H._getParticleRenderSharedMaterialTintColor,b$H._setParticleRenderSharedMaterialTintColor),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.tilingOffset",b$H._getMeshRenderSharedMaterialTilingOffset,b$H._setMeshRenderSharedMaterialTilingOffset),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.albedoColor",b$H._getMeshRenderSharedMaterialAlbedo,b$H._setMeshRenderSharedMaterialAlbedo),b$H.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.tilingOffset",b$H._getSkinnedMeshRenderSharedMaterialTilingOffset,b$H._setSkinnedMeshRenderSharedMaterialTilingOffset),b$H.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedoColor",b$H._getSkinnedMeshRenderSharedMaterialAlbedo,b$H._setSkinnedMeshRenderSharedMaterialAlbedo),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.albedo",b$H._getMeshRenderSharedMaterialAlbedo,b$H._setMeshRenderSharedMaterialAlbedo),b$H.registerAnimationNodeProperty("skinnedMeshRender.sharedMaterial.albedo",b$H._getSkinnedMeshRenderSharedMaterialAlbedo,b$H._setSkinnedMeshRenderSharedMaterialAlbedo),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.intensity",b$H._getMeshRenderSharedMaterialIntensity,b$H._setMeshRenderSharedMaterialIntensity),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.alpha",b$H._getMeshRenderSharedMaterialAlpha,b$H._setMeshRenderSharedMaterialAlpha),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.alphaColor",b$H._getMeshRenderSharedMaterialAlphaColor,b$H._setMeshRenderSharedMaterialAlphaColor),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.baseColor",b$H._getMeshRenderSharedMaterialBaseColor,b$H._setMeshRenderSharedMaterialBaseColor),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolve",b$H._getMeshRenderSharedMaterialDissolve,b$H._setMeshRenderSharedMaterialDissolve),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveSpeed",b$H._getMeshRenderSharedMaterialDissolveSpeed,b$H._setMeshRenderSharedMaterialDissolveSpeed),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.mMultiplier",b$H._getMeshRenderSharedMaterialMMultiplier,b$H._setMeshRenderSharedMaterialMMultiplier),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedX",b$H._getMeshRenderSharedMaterialBaseScrollSpeedX,b$H._setMeshRenderSharedMaterialBaseScrollSpeedX),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.baseScrollSpeedY",b$H._getMeshRenderSharedMaterialBaseScrollSpeedY,b$H._setMeshRenderSharedMaterialBaseScrollSpeedY),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedX",b$H._getMeshRenderSharedMaterialSecondScrollSpeedX,b$H._setMeshRenderSharedMaterialSecondScrollSpeedX),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.secondScrollSpeedY",b$H._getMeshRenderSharedMaterialSecondScrollSpeedY,b$H._setMeshRenderSharedMaterialSecondScrollSpeedY),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.detailTilingOffset",b$H._getMeshRenderSharedMaterialDetailTilingOffset,b$H._setMeshRenderSharedMaterialDetailTilingOffset),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.dissolveTilingOffset",b$H._getMeshRenderSharedMaterialDissolveTilingOffset,b$H._setMeshRenderSharedMaterialDissolveTilingOffset),b$H.registerAnimationNodeProperty("meshRender.sharedMaterial.maskTilingOffset",b$H._getMeshRenderSharedMaterialMaskTilingOffset,b$H._setMeshRenderSharedMaterialMaskTilingOffset)},b$H.registerAnimationNodeProperty=function(b$M,b$y,b$i){if(b$H._propertyIndexDic[b$M])throw new Error("AnimationNode: this propertyName has registered.");b$H._propertyIndexDic[b$M]=b$H._propertyIDCounter,b$H._propertyGetFuncs[b$H._propertyIDCounter]=b$y,b$H._propertySetFuncs[b$H._propertyIDCounter]=b$i,b$H._propertyIDCounter++},b$H._getLocalPosition=function(b$M,b$y){return b$M?b$M.transform.getLocalPosition():b$y._transform.localPosition.elements},b$H._setLocalPosition=function(b$M,b$y,b$i){if(b$M)b$M.transform.setLocalPosition(b$i);else{var b$H=b$y._transform,b$S=b$H.localPosition;b$S.elements=b$i,b$H.localPosition=b$S}},b$H._getLocalRotation=function(b$M,b$y){return b$M?b$M.transform.getLocalRotation():b$y._transform.localRotation.elements},b$H._setLocalRotation=function(b$M,b$y,b$i){if(b$M)b$M.transform.setLocalRotation(b$i);else{var b$H=b$y._transform,b$S=b$H.localRotation;b$S.elements=b$i,b$H.localRotation=b$S}},b$H._getLocalScale=function(b$M,b$y){return b$M?b$M.transform.getLocalScale():b$y._transform.localScale.elements},b$H._setLocalScale=function(b$M,b$y,b$i){if(b$M)b$M.transform.setLocalScale(b$i);else{var b$H=b$y._transform,b$S=b$H.localScale;b$S.elements=b$i,b$H.localScale=b$S}},b$H._getLocalRotationEuler=function(b$M,b$y){return b$M?b$M.transform.getLocalRotationEuler():b$y._transform.localRotationEuler.elements},b$H._setLocalRotationEuler=function(b$M,b$y,b$i){if(b$M)b$M.transform.setLocalRotationEuler(b$i);else{var b$H=b$y._transform,b$S=b$H.localRotationEuler;b$S.elements=b$i,b$H.localRotationEuler=b$S}},b$H._getMeshRenderSharedMaterialTilingOffset=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.tilingOffset.elements:null}return b$y.meshRender.sharedMaterial.tilingOffset.elements},b$H._setMeshRenderSharedMaterialTilingOffset=function(b$M,b$y,b$i){var b$H,b$S;if(b$M){var b$f=b$M.transform._entity;b$f&&((b$S=(b$H=b$f.owner.meshRender.material).tilingOffset).elements=b$i,b$H.tilingOffset=b$S)}else(b$S=(b$H=b$y.meshRender.material).tilingOffset).elements=b$i,b$H.tilingOffset=b$S},b$H._getMeshRenderSharedMaterialAlbedo=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.albedoColor.elements:null}return b$y.meshRender.sharedMaterial.albedoColor.elements},b$H._setMeshRenderSharedMaterialAlbedo=function(b$M,b$y,b$i){var b$H,b$S;if(b$M){var b$f=b$M.transform._entity;b$f&&((b$S=(b$H=b$f.owner.meshRender.material).albedoColor).elements=b$i,b$H.albedoColor=b$S)}else(b$S=(b$H=b$y.meshRender.material).albedoColor).elements=b$i,b$H.albedoColor=b$S},b$H._getSkinnedMeshRenderSharedMaterialTilingOffset=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.skinnedMeshRender.sharedMaterial.tilingOffset.elements:null}return b$y.skinnedMeshRender.sharedMaterial.tilingOffset.elements},b$H._setSkinnedMeshRenderSharedMaterialTilingOffset=function(b$M,b$y,b$i){var b$H,b$S;if(b$M){var b$f=b$M.transform._entity;b$f&&((b$S=(b$H=b$f.owner.skinnedMeshRender.material).tilingOffset).elements=b$i,b$H.tilingOffset=b$S)}else(b$S=(b$H=b$y.skinnedMeshRender.material).tilingOffset).elements=b$i,b$H.tilingOffset=b$S},b$H._getSkinnedMeshRenderSharedMaterialAlbedo=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.skinnedMeshRender.sharedMaterial.albedoColor.elements:null}return b$y.skinnedMeshRender.sharedMaterial.albedoColor.elements},b$H._setSkinnedMeshRenderSharedMaterialAlbedo=function(b$M,b$y,b$i){var b$H,b$S;if(b$M){var b$f=b$M.transform._entity;b$f&&((b$S=(b$H=b$f.owner.skinnedMeshRender.material).albedoColor).elements=b$i,b$H.albedoColor=b$S)}else(b$S=(b$H=b$y.skinnedMeshRender.material).albedoColor).elements=b$i,b$H.albedoColor=b$S},b$H._getParticleRenderSharedMaterialTintColor=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.particleRender.sharedMaterial.tintColor.elements:null}return b$y.particleRender.sharedMaterial.tintColor.elements},b$H._setParticleRenderSharedMaterialTintColor=function(b$M,b$y,b$i){var b$H,b$S;if(b$M){var b$f=b$M.transform._entity;b$f&&((b$S=(b$H=b$f.owner.particleRender.material).tintColor).elements=b$i,b$H.tintColor=b$S)}else(b$S=(b$H=b$y.particleRender.material).tintColor).elements=b$i,b$H.tintColor=b$S},b$H._getMeshRenderSharedMaterialAlphaColor=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.alphaColor.elements:null}return b$y.meshRender.sharedMaterial.alphaColor.elements},b$H._setMeshRenderSharedMaterialAlphaColor=function(b$M,b$y,b$i){var b$H,b$S;if(b$M){var b$f=b$M.transform._entity;b$f&&((b$S=(b$H=b$f.owner.meshRender.material).alphaColor).elements=b$i,b$H.alphaColor=b$S)}else(b$S=(b$H=b$y.meshRender.material).alphaColor).elements=b$i,b$H.alphaColor=b$S},b$H._getMeshRenderSharedMaterialBaseColor=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.baseColor.elements:null}return b$y.meshRender.sharedMaterial.baseColor.elements},b$H._setMeshRenderSharedMaterialBaseColor=function(b$M,b$y,b$i){var b$H,b$S;if(b$M){var b$f=b$M.transform._entity;b$f&&((b$S=(b$H=b$f.owner.meshRender.material).baseColor).elements=b$i,b$H.baseColor=b$S)}else(b$S=(b$H=b$y.meshRender.material).baseColor).elements=b$i,b$H.baseColor=b$S},b$H._getMeshRenderSharedMaterialDissolve=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.dissolve:0}return b$y.meshRender.sharedMaterial.dissolve},b$H._setMeshRenderSharedMaterialDissolve=function(b$M,b$y,b$i){if(b$M){var b$H=b$M.transform._entity;b$H&&(b$H.owner.meshRender.material.dissolve=b$i[0])}else b$y.meshRender.material.dissolve=b$i[0]},b$H._getMeshRenderSharedMaterialDissolveSpeed=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.dissolveSpeed:0}return b$y.meshRender.sharedMaterial.dissolveSpeed},b$H._setMeshRenderSharedMaterialDissolveSpeed=function(b$M,b$y,b$i){if(b$M){var b$H=b$M.transform._entity;b$H&&(b$H.owner.meshRender.material.dissolveSpeed=b$i[0])}else b$y.meshRender.material.dissolveSpeed=b$i[0]},b$H._getMeshRenderSharedMaterialMMultiplier=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.mMultiplier:0}return b$y.meshRender.sharedMaterial.mMultiplier},b$H._setMeshRenderSharedMaterialMMultiplier=function(b$M,b$y,b$i){if(b$M){var b$H=b$M.transform._entity;b$H&&(b$H.owner.meshRender.material.mMultiplier=b$i[0])}else b$y.meshRender.material.mMultiplier=b$i[0]},b$H._getMeshRenderSharedMaterialBaseScrollSpeedX=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.baseScrollSpeedX:0}return b$y.meshRender.sharedMaterial.baseScrollSpeedX},b$H._setMeshRenderSharedMaterialBaseScrollSpeedX=function(b$M,b$y,b$i){if(b$M){var b$H=b$M.transform._entity;b$H&&(b$H.owner.meshRender.material.baseScrollSpeedX=b$i[0])}else b$y.meshRender.material.baseScrollSpeedX=b$i[0]},b$H._getMeshRenderSharedMaterialBaseScrollSpeedY=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.baseScrollSpeedY:0}return b$y.meshRender.sharedMaterial.baseScrollSpeedY},b$H._setMeshRenderSharedMaterialBaseScrollSpeedY=function(b$M,b$y,b$i){if(b$M){var b$H=b$M.transform._entity;b$H&&(b$H.owner.meshRender.material.baseScrollSpeedY=b$i[0])}else b$y.meshRender.material.baseScrollSpeedY=b$i[0]},b$H._getMeshRenderSharedMaterialSecondScrollSpeedX=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.secondScrollSpeedX:0}return b$y.meshRender.sharedMaterial.secondScrollSpeedX},b$H._setMeshRenderSharedMaterialSecondScrollSpeedX=function(b$M,b$y,b$i){if(b$M){var b$H=b$M.transform._entity;b$H&&(b$H.owner.meshRender.material.secondScrollSpeedX=b$i[0])}else b$y.meshRender.material.secondScrollSpeedX=b$i[0]},b$H._getMeshRenderSharedMaterialSecondScrollSpeedY=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.secondScrollSpeedY:0}return b$y.meshRender.sharedMaterial.secondScrollSpeedY},b$H._setMeshRenderSharedMaterialSecondScrollSpeedY=function(b$M,b$y,b$i){if(b$M){var b$H=b$M.transform._entity;b$H&&(b$H.owner.meshRender.material.secondScrollSpeedY=b$i[0])}else b$y.meshRender.material.secondScrollSpeedY=b$i[0]},b$H._getMeshRenderSharedMaterialAlpha=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.alpha:0}return b$y.meshRender.sharedMaterial.alpha},b$H._setMeshRenderSharedMaterialAlpha=function(b$M,b$y,b$i){if(b$M){var b$H=b$M.transform._entity;b$H&&(b$H.owner.meshRender.material.alpha=b$i[0])}else b$y.meshRender.material.alpha=b$i[0]},b$H._getMeshRenderSharedMaterialIntensity=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.intensity:0}return b$y.meshRender.sharedMaterial.intensity},b$H._setMeshRenderSharedMaterialIntensity=function(b$M,b$y,b$i){if(b$M){var b$H=b$M.transform._entity;b$H&&(b$H.owner.meshRender.material.intensity=b$i[0])}else b$y.meshRender.material.intensity=b$i[0]},b$H._getMeshRenderSharedMaterialDetailTilingOffset=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.detailTilingOffset.elements:null}return b$y.meshRender.sharedMaterial.detailTilingOffset.elements},b$H._setMeshRenderSharedMaterialDetailTilingOffset=function(b$M,b$y,b$i){var b$H,b$S;if(b$M){var b$f=b$M.transform._entity;b$f&&((b$S=(b$H=b$f.owner.meshRender.material).detailTilingOffset).elements=b$i,b$H.detailTilingOffset=b$S)}else(b$S=(b$H=b$y.meshRender.material).detailTilingOffset).elements=b$i,b$H.detailTilingOffset=b$S},b$H._getMeshRenderSharedMaterialDissolveTilingOffset=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.dissolveTilingOffset.elements:null}return b$y.meshRender.sharedMaterial.dissolveTilingOffset.elements},b$H._setMeshRenderSharedMaterialDissolveTilingOffset=function(b$M,b$y,b$i){var b$H,b$S;if(b$M){var b$f=b$M.transform._entity;b$f&&((b$S=(b$H=b$f.owner.meshRender.material).dissolveTilingOffset).elements=b$i,b$H.dissolveTilingOffset=b$S)}else(b$S=(b$H=b$y.meshRender.material).dissolveTilingOffset).elements=b$i,b$H.dissolveTilingOffset=b$S},b$H._getMeshRenderSharedMaterialMaskTilingOffset=function(b$M,b$y){if(b$M){var b$i=b$M.transform._entity;return b$i?b$i.owner.meshRender.sharedMaterial.maskTilingOffset.elements:null}return b$y.meshRender.sharedMaterial.maskTilingOffset.elements},b$H._setMeshRenderSharedMaterialMaskTilingOffset=function(b$M,b$y,b$i){var b$H,b$S;if(b$M){var b$f=b$M.transform._entity;b$f&&((b$S=(b$H=b$f.owner.meshRender.material).maskTilingOffset).elements=b$i,b$H.maskTilingOffset=b$S)}else(b$S=(b$H=b$y.meshRender.material).maskTilingOffset).elements=b$i,b$H.maskTilingOffset=b$S},b$H._propertyIDCounter=0,b$H._propertyIndexDic={},b$H._propertySetFuncs=[],b$H._propertyGetFuncs=[],b$H}(),b$Z=function(){function b$M(){this.startTime=NaN,this.inTangent=null,this.outTangent=null,this.data=null,this.duration=NaN,this.next=null}return b$P(b$M,"laya.d3.animation.Keyframe"),b$M}(),b$E=function(){function b$M(){this._cacheProperty=!1,this.path=null,this.componentType=null,this.propertyNameID=0,this.keyFrameWidth=0,this.defaultData=null,this.keyFrames=null}return b$P(b$M,"laya.d3.animation.KeyframeNode"),b$M}(),b$s=(function(){function b$M(){this._tempVector30=new b$Vy,this._tempVector31=new b$Vy,this._tempVector32=new b$Vy,this._a=new b$Vy,this._b=new b$Vy,this._c=new b$Vy,this._d=new b$Vy}b$P(b$M,"laya.d3.core.glitter.SplineCurvePositionVelocity");var b$y=b$M.prototype;b$y.Init=function(b$M,b$y,b$i,b$H){b$M.cloneTo(this._d),b$y.cloneTo(this._c),b$Vy.scale(b$M,2,this._a),b$Vy.scale(b$i,2,this._tempVector30),b$Vy.subtract(this._a,this._tempVector30,this._a),b$Vy.add(this._a,b$y,this._a),b$Vy.add(this._a,b$H,this._a),b$Vy.scale(b$i,3,this._b),b$Vy.scale(b$M,3,this._tempVector30),b$Vy.subtract(this._b,this._tempVector30,this._b),b$Vy.subtract(this._b,b$H,this._b),b$Vy.scale(b$y,2,this._tempVector30),b$Vy.subtract(this._b,this._tempVector30,this._b)},b$y.Slerp=function(b$M,b$y){b$Vy.scale(this._a,b$M*b$M*b$M,this._tempVector30),b$Vy.scale(this._b,b$M*b$M,this._tempVector31),b$Vy.scale(this._c,b$M,this._tempVector32),b$Vy.add(this._tempVector30,this._tempVector31,b$y),b$Vy.add(b$y,this._tempVector32,b$y),b$Vy.add(b$y,this._d,b$y)}}(),function(){function b$q(b$M,b$y,b$i,b$H){this._datas=null,this._w=0,this._h=0,this._minHeight=NaN,this._maxHeight=NaN,this._datas=[],this._w=b$M,this._h=b$y,this._minHeight=b$i,this._maxHeight=b$H}b$P(b$q,"laya.d3.core.HeightMap");var b$M=b$q.prototype;b$M._inBounds=function(b$M,b$y){return 0<=b$M&&b$M<this._h&&0<=b$y&&b$y<this._w},b$M.getHeight=function(b$M,b$y){return this._inBounds(b$M,b$y)?this._datas[b$M][b$y]:NaN},b$l(0,b$M,"width",function(){return this._w}),b$l(0,b$M,"height",function(){return this._h}),b$l(0,b$M,"maxHeight",function(){return this._maxHeight}),b$l(0,b$M,"minHeight",function(){return this._minHeight}),b$q.creatFromMesh=function(b$M,b$y,b$i,b$H){for(var b$S=[],b$f=[],b$V=b$M.getSubMeshCount(),b$K=0;b$K<b$V;b$K++){for(var b$k=b$M.getSubMesh(b$K),b$X=b$k._getVertexBuffer(),b$F=b$X.getData(),b$o=[],b$d=0;b$d<b$F.length;b$d+=b$X.vertexDeclaration.vertexStride/4){var b$P=new b$Vy(b$F[b$d+0],b$F[b$d+1],b$F[b$d+2]);b$o.push(b$P)}b$S.push(b$o);var b$l=b$k._getIndexBuffer();b$f.push(b$l.getData())}var b$J=b$M.boundingBox,b$h=b$J.min.x,b$C=b$J.min.z,b$v=b$J.max.x,b$R=b$J.max.z,b$A=b$J.min.y,b$G=b$J.max.y,b$I=b$v-b$h,b$U=b$R-b$C,b$Q=b$H.elements[0]=b$I/(b$y-1),b$W=b$H.elements[1]=b$U/(b$i-1),b$c=new b$q(b$y,b$i,b$A,b$G),b$n=b$q._tempRay,b$a=b$n.direction.elements;b$a[0]=0,b$a[1]=-1,b$a[2]=0;var b$T=b$G+.1;b$n.origin.elements[1]=b$T;for(var b$m=0;b$m<b$i;b$m++){var b$e=b$C+b$m*b$W;b$c._datas[b$m]=[];for(var b$s=0;b$s<b$y;b$s++){var b$D=b$h+b$s*b$Q,b$z=b$n.origin.elements;b$z[0]=b$D,b$z[2]=b$e;var b$w=b$q._getPosition(b$n,b$S,b$f);b$c._datas[b$m][b$s]=b$w===Number.MAX_VALUE?NaN:b$T-b$w}}return b$c},b$q.createFromImage=function(b$M,b$y,b$i){for(var b$H=b$M.width,b$S=b$M.height,b$f=new b$q(b$H,b$S,b$y,b$i),b$V=(b$i-b$y)/254,b$K=b$M.getPixels(),b$k=0,b$X=0;b$X<b$S;b$X++)for(var b$F=b$f._datas[b$X]=[],b$o=0;b$o<b$H;b$o++){var b$d=b$K[b$k++],b$P=b$K[b$k++],b$l=b$K[b$k++],b$J=b$K[b$k++];b$F[b$o]=255==b$d&&255==b$P&&255==b$l&&255==b$J?NaN:(b$d+b$P+b$l)/3*b$V+b$y}return b$f},b$q._getPosition=function(b$M,b$y,b$i){for(var b$H=Number.MAX_VALUE,b$S=0;b$S<b$y.length;b$S++)for(var b$f=b$y[b$S],b$V=b$i[b$S],b$K=0;b$K<b$V.length;b$K+=3){var b$k=b$f[b$V[b$K+0]],b$X=b$f[b$V[b$K+1]],b$F=b$f[b$V[b$K+2]],b$o=b$ly.rayIntersectsTriangle(b$M,b$k,b$X,b$F);!isNaN(b$o)&&b$o<b$H&&(b$H=b$o)}return b$H},b$o(b$q,["_tempRay",function(){return this._tempRay=new b$Sy(new b$Vy,new b$Vy)}])}(),function(){function b$S(){this._visible=!0,this._nonRigidbodyOffset=0,this._colliders=[]}b$P(b$S,"laya.d3.core.Layer");var b$M=b$S.prototype;return b$M._binarySearchIndex=function(){for(var b$M=0,b$y=b$S._collsionTestList.length-1,b$i=0;b$M<=b$y;){b$i=Math.floor((b$M+b$y)/2);var b$H=b$S._collsionTestList[b$i];if(b$H==this._number)return b$i;b$H>this._number?b$y=b$i-1:b$M=b$i+1}return b$M},b$M._addCollider=function(b$M){0===this._colliders.length&&b$S._collsionTestList.splice(this._binarySearchIndex(),0,this._number),b$M._isRigidbody?(this._colliders.unshift(b$M),this._nonRigidbodyOffset++):this._colliders.push(b$M)},b$M._removeCollider=function(b$M){var b$y=this._colliders.indexOf(b$M);b$y<this._nonRigidbodyOffset&&this._nonRigidbodyOffset--,this._colliders.splice(b$y,1),0===this._colliders.length&&b$S._collsionTestList.splice(b$S._collsionTestList.indexOf(this._number),1)},b$l(0,b$M,"number",function(){return this._number}),b$l(0,b$M,"visible",function(){return this._visible},function(b$M){this._visible=b$M,b$S._visibleLayers=b$M?b$S._visibleLayers|this.mask:b$S._visibleLayers&~this.mask}),b$l(0,b$M,"mask",function(){return this._mask}),b$l(1,b$S,"visibleLayers",function(){return b$S._visibleLayers},function(b$M){b$S._visibleLayers=b$M;for(var b$y=0,b$i=b$S._layerList.length;b$y<b$i;b$y++){var b$H=b$S._layerList[b$y];b$H._visible=0!=(b$H._mask&b$S._visibleLayers)}}),b$S.__init__=function(){b$S._layerList.length=31;for(var b$M=0;b$M<31;b$M++){var b$y=new b$S;b$S._layerList[b$M]=b$y,0===b$M?(b$y.name="Default Layer",b$y.visible=!0):(b$y.name="Layer-"+b$M,b$y.visible=!1),b$y._number=b$M,b$y._mask=Math.pow(2,b$M)}b$S.currentCreationLayer=b$S._layerList[0]},b$S.getLayerByNumber=function(b$M){if(b$M<0||30<b$M)throw new Error("无法返回指定Layer，该number超出范围！");return b$S._layerList[b$M]},b$S.getLayerByName=function(b$M){for(var b$y=0;b$y<31;b$y++)if(b$S._layerList[b$y].name===b$M)return b$S._layerList[b$y];throw new Error("无法返回指定Layer,该name不存在")},b$S.isVisible=function(b$M){return 0!=(b$M&b$S._currentCameraCullingMask&b$S._visibleLayers)},b$S._layerList=[],b$S._visibleLayers=2147483647,b$S._collsionTestList=[],b$S._currentCameraCullingMask=2147483647,b$S.maxCount=31,b$S.currentCreationLayer=null,b$S}()),b$D=(function(){function b$M(b$M,b$y,b$i){this._time=NaN,this._minCount=0,this._maxCount=0,this._time=b$M,this._minCount=b$y,this._maxCount=b$i}b$P(b$M,"laya.d3.core.particleShuriKen.module.Burst");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y.cloneTo=function(b$M){var b$y=b$M;b$y._time=this._time,b$y._minCount=this._minCount,b$y._maxCount=this._maxCount},b$y.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$y,"time",function(){return this._time}),b$l(0,b$y,"minCount",function(){return this._minCount}),b$l(0,b$y,"maxCount",function(){return this._maxCount})}(),function(){function b$M(b$M){this._color=null,this.enbale=!1,this._color=b$M}b$P(b$M,"laya.d3.core.particleShuriKen.module.ColorOverLifetime");var b$y=b$M.prototype;b$y.cloneTo=function(b$M){var b$y=b$M;this._color.cloneTo(b$y._color),b$y.enbale=this.enbale},b$y.clone=function(){var b$M;switch(this._color.type){case 0:b$M=b$w.createByConstant(this._color.constant.clone());break;case 1:b$M=b$w.createByGradient(this._color.gradient.clone());break;case 2:b$M=b$w.createByRandomTwoConstant(this._color.constantMin.clone(),this._color.constantMax.clone());break;case 3:b$M=b$w.createByRandomTwoGradient(this._color.gradientMin.clone(),this._color.gradientMax.clone())}var b$y=new this.constructor(b$M);return b$y.enbale=this.enbale,b$y},b$l(0,b$y,"color",function(){return this._color})}(),function(){function b$M(){this._destroyed=!1,this._emissionRate=0,this._bursts=null,this.enbale=!1,this._destroyed=!1,this.emissionRate=10,this._bursts=[]}b$P(b$M,"laya.d3.core.particleShuriKen.module.Emission");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.core.IClone":!0,"laya.resource.IDestroy":!0}),b$y._destroy=function(){this._bursts=null,this._destroyed=!0},b$y.getBurstsCount=function(){return this._bursts.length},b$y.getBurstByIndex=function(b$M){return this._bursts[b$M]},b$y.addBurst=function(b$M){var b$y=this._bursts.length;if(0<b$y)for(var b$i=0;b$i<b$y;b$i++)this._bursts[b$i].time>b$M.time&&this._bursts.splice(b$i,0,b$M);this._bursts.push(b$M)},b$y.removeBurst=function(b$M){var b$y=this._bursts.indexOf(b$M);-1!==b$y&&this._bursts.splice(b$y,1)},b$y.removeBurstByIndex=function(b$M){this._bursts.splice(b$M,1)},b$y.clearBurst=function(){this._bursts.length=0},b$y.cloneTo=function(b$M){var b$y=b$M,b$i=b$y._bursts;b$i.length=this._bursts.length;for(var b$H=0,b$S=this._bursts.length;b$H<b$S;b$H++){var b$f=b$i[b$H];b$f?this._bursts[b$H].cloneTo(b$f):b$i[b$H]=this._bursts[b$H].clone()}b$y._emissionRate=this._emissionRate,b$y.enbale=this.enbale},b$y.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$y,"destroyed",function(){return this._destroyed}),b$l(0,b$y,"emissionRate",function(){return this._emissionRate},function(b$M){if(b$M<0)throw new Error("ParticleBaseShape:emissionRate value must large or equal than 0.");this._emissionRate=b$M})}(),function(){function b$H(){this._type=0,this._constant=0,this._overTime=null,this._constantMin=0,this._constantMax=0,this._overTimeMin=null,this._overTimeMax=null}b$P(b$H,"laya.d3.core.particleShuriKen.module.FrameOverTime");var b$M=b$H.prototype;return b$G.imps(b$M,{"laya.d3.core.IClone":!0}),b$M.cloneTo=function(b$M){var b$y=b$M;b$y._type=this._type,b$y._constant=this._constant,this._overTime.cloneTo(b$y._overTime),b$y._constantMin=this._constantMin,b$y._constantMax=this._constantMax,this._overTimeMin.cloneTo(b$y._overTimeMin),this._overTimeMax.cloneTo(b$y._overTimeMax)},b$M.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$M,"frameOverTimeData",function(){return this._overTime}),b$l(0,b$M,"constant",function(){return this._constant}),b$l(0,b$M,"type",function(){return this._type}),b$l(0,b$M,"frameOverTimeDataMin",function(){return this._overTimeMin}),b$l(0,b$M,"constantMin",function(){return this._constantMin}),b$l(0,b$M,"frameOverTimeDataMax",function(){return this._overTimeMax}),b$l(0,b$M,"constantMax",function(){return this._constantMax}),b$H.createByConstant=function(b$M){var b$y=new b$H;return b$y._type=0,b$y._constant=b$M,b$y},b$H.createByOverTime=function(b$M){var b$y=new b$H;return b$y._type=1,b$y._overTime=b$M,b$y},b$H.createByRandomTwoConstant=function(b$M,b$y){var b$i=new b$H;return b$i._type=2,b$i._constantMin=b$M,b$i._constantMax=b$y,b$i},b$H.createByRandomTwoOverTime=function(b$M,b$y){var b$i=new b$H;return b$i._type=3,b$i._overTimeMin=b$M,b$i._overTimeMax=b$y,b$i},b$H}()),b$z=function(){function b$X(){this._type=0,this._separateAxes=!1,this._constant=NaN,this._constantSeparate=null,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._gradientW=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null,this._gradientWMin=null,this._gradientWMax=null}b$P(b$X,"laya.d3.core.particleShuriKen.module.GradientAngularVelocity");var b$M=b$X.prototype;return b$G.imps(b$M,{"laya.d3.core.IClone":!0}),b$M.cloneTo=function(b$M){var b$y=b$M;b$y._type=this._type,b$y._separateAxes=this._separateAxes,b$y._constant=this._constant,this._constantSeparate.cloneTo(b$y._constantSeparate),this._gradient.cloneTo(b$y._gradient),this._gradientX.cloneTo(b$y._gradientX),this._gradientY.cloneTo(b$y._gradientY),this._gradientZ.cloneTo(b$y._gradientZ),b$y._constantMin=this._constantMin,b$y._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(b$y._constantMinSeparate),this._constantMaxSeparate.cloneTo(b$y._constantMaxSeparate),this._gradientMin.cloneTo(b$y._gradientMin),this._gradientMax.cloneTo(b$y._gradientMax),this._gradientXMin.cloneTo(b$y._gradientXMin),this._gradientXMax.cloneTo(b$y._gradientXMax),this._gradientYMin.cloneTo(b$y._gradientYMin),this._gradientYMax.cloneTo(b$y._gradientYMax),this._gradientZMin.cloneTo(b$y._gradientZMin),this._gradientZMax.cloneTo(b$y._gradientZMax)},b$M.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$M,"gradientZ",function(){return this._gradientZ}),b$l(0,b$M,"constant",function(){return this._constant}),b$l(0,b$M,"gradient",function(){return this._gradient}),b$l(0,b$M,"separateAxes",function(){return this._separateAxes}),b$l(0,b$M,"type",function(){return this._type}),b$l(0,b$M,"constantSeparate",function(){return this._constantSeparate}),b$l(0,b$M,"gradientX",function(){return this._gradientX}),b$l(0,b$M,"gradientY",function(){return this._gradientY}),b$l(0,b$M,"gradientW",function(){return this._gradientW}),b$l(0,b$M,"gradientMin",function(){return this._gradientMin}),b$l(0,b$M,"constantMin",function(){return this._constantMin}),b$l(0,b$M,"gradientMax",function(){return this._gradientMax}),b$l(0,b$M,"constantMax",function(){return this._constantMax}),b$l(0,b$M,"gradientWMin",function(){return this._gradientWMin}),b$l(0,b$M,"constantMinSeparate",function(){return this._constantMinSeparate}),b$l(0,b$M,"constantMaxSeparate",function(){return this._constantMaxSeparate}),b$l(0,b$M,"gradientXMin",function(){return this._gradientXMin}),b$l(0,b$M,"gradientXMax",function(){return this._gradientXMax}),b$l(0,b$M,"gradientWMax",function(){return this._gradientWMax}),b$l(0,b$M,"gradientYMin",function(){return this._gradientYMin}),b$l(0,b$M,"gradientYMax",function(){return this._gradientYMax}),b$l(0,b$M,"gradientZMin",function(){return this._gradientZMin}),b$l(0,b$M,"gradientZMax",function(){return this._gradientZMax}),b$X.createByConstant=function(b$M){var b$y=new b$X;return b$y._type=0,b$y._separateAxes=!1,b$y._constant=b$M,b$y},b$X.createByConstantSeparate=function(b$M){var b$y=new b$X;return b$y._type=0,b$y._separateAxes=!0,b$y._constantSeparate=b$M,b$y},b$X.createByGradient=function(b$M){var b$y=new b$X;return b$y._type=1,b$y._separateAxes=!1,b$y._gradient=b$M,b$y},b$X.createByGradientSeparate=function(b$M,b$y,b$i,b$H){var b$S=new b$X;return b$S._type=1,b$S._separateAxes=!0,b$S._gradientX=b$M,b$S._gradientY=b$y,b$S._gradientZ=b$i,b$S._gradientW=b$H,b$S},b$X.createByRandomTwoConstant=function(b$M,b$y){var b$i=new b$X;return b$i._type=2,b$i._separateAxes=!1,b$i._constantMin=b$M,b$i._constantMax=b$y,b$i},b$X.createByRandomTwoConstantSeparate=function(b$M,b$y){var b$i=new b$X;return b$i._type=2,b$i._separateAxes=!0,b$i._constantMinSeparate=b$M,b$i._constantMaxSeparate=b$y,b$i},b$X.createByRandomTwoGradient=function(b$M,b$y){var b$i=new b$X;return b$i._type=3,b$i._separateAxes=!1,b$i._gradientMin=b$M,b$i._gradientMax=b$y,b$i},b$X.createByRandomTwoGradientSeparate=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){var b$k=new b$X;return b$k._type=3,b$k._separateAxes=!0,b$k._gradientXMin=b$M,b$k._gradientXMax=b$y,b$k._gradientYMin=b$i,b$k._gradientYMax=b$H,b$k._gradientZMin=b$S,b$k._gradientZMax=b$f,b$k._gradientWMin=b$V,b$k._gradientWMax=b$K,b$k},b$X}(),b$w=function(){function b$H(){this._type=0,this._constant=null,this._constantMin=null,this._constantMax=null,this._gradient=null,this._gradientMin=null,this._gradientMax=null}b$P(b$H,"laya.d3.core.particleShuriKen.module.GradientColor");var b$M=b$H.prototype;return b$G.imps(b$M,{"laya.d3.core.IClone":!0}),b$M.cloneTo=function(b$M){var b$y=b$M;b$y._type=this._type,this._constant.cloneTo(b$y._constant),this._constantMin.cloneTo(b$y._constantMin),this._constantMax.cloneTo(b$y._constantMax),this._gradient.cloneTo(b$y._gradient),this._gradientMin.cloneTo(b$y._gradientMin),this._gradientMax.cloneTo(b$y._gradientMax)},b$M.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$M,"gradient",function(){return this._gradient}),b$l(0,b$M,"constant",function(){return this._constant}),b$l(0,b$M,"type",function(){return this._type}),b$l(0,b$M,"gradientMin",function(){return this._gradientMin}),b$l(0,b$M,"constantMin",function(){return this._constantMin}),b$l(0,b$M,"gradientMax",function(){return this._gradientMax}),b$l(0,b$M,"constantMax",function(){return this._constantMax}),b$H.createByConstant=function(b$M){var b$y=new b$H;return b$y._type=0,b$y._constant=b$M,b$y},b$H.createByGradient=function(b$M){var b$y=new b$H;return b$y._type=1,b$y._gradient=b$M,b$y},b$H.createByRandomTwoConstant=function(b$M,b$y){var b$i=new b$H;return b$i._type=2,b$i._constantMin=b$M,b$i._constantMax=b$y,b$i},b$H.createByRandomTwoGradient=function(b$M,b$y){var b$i=new b$H;return b$i._type=3,b$i._gradientMin=b$M,b$i._gradientMax=b$y,b$i},b$H}(),b$q=(function(){function b$M(){this._alphaCurrentLength=0,this._rgbCurrentLength=0,this._alphaElements=null,this._rgbElements=null,this._alphaElements=new Float32Array(8),this._rgbElements=new Float32Array(16)}b$P(b$M,"laya.d3.core.particleShuriKen.module.GradientDataColor");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y.addAlpha=function(b$M,b$y){this._alphaCurrentLength<8?(6===this._alphaCurrentLength&&1!==b$M&&(b$M=1,DEBUG),this._alphaElements[this._alphaCurrentLength++]=b$M,this._alphaElements[this._alphaCurrentLength++]=b$y):DEBUG},b$y.addRGB=function(b$M,b$y){this._rgbCurrentLength<16?(12===this._rgbCurrentLength&&1!==b$M&&(b$M=1,DEBUG),this._rgbElements[this._rgbCurrentLength++]=b$M,this._rgbElements[this._rgbCurrentLength++]=b$y.x,this._rgbElements[this._rgbCurrentLength++]=b$y.y,this._rgbElements[this._rgbCurrentLength++]=b$y.z):DEBUG},b$y.cloneTo=function(b$M){var b$y=b$M,b$i=0,b$H=0;b$y._alphaCurrentLength=this._alphaCurrentLength;var b$S=b$y._alphaElements;for(b$S.length=this._alphaElements.length,b$i=0,b$H=this._alphaElements.length;b$i<b$H;b$i++)b$S[b$i]=this._alphaElements[b$i];b$y._rgbCurrentLength=this._rgbCurrentLength;var b$f=b$y._rgbElements;for(b$f.length=this._rgbElements.length,b$i=0,b$H=this._rgbElements.length;b$i<b$H;b$i++)b$f[b$i]=this._rgbElements[b$i]},b$y.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$y,"alphaGradientCount",function(){return this._alphaCurrentLength/2}),b$l(0,b$y,"rgbGradientCount",function(){return this._rgbCurrentLength/4})}(),function(){function b$M(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}b$P(b$M,"laya.d3.core.particleShuriKen.module.GradientDataInt");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y.add=function(b$M,b$y){this._currentLength<8?(6===this._currentLength&&1!==b$M&&(b$M=1,console.log("Warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=b$M,this._elements[this._currentLength++]=b$y):console.log("Warning:data count must lessEqual than 4")},b$y.cloneTo=function(b$M){var b$y=b$M;b$y._currentLength=this._currentLength;var b$i=b$y._elements;b$i.length=this._elements.length;for(var b$H=0,b$S=this._elements.length;b$H<b$S;b$H++)b$i[b$H]=this._elements[b$H]},b$y.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$y,"gradientCount",function(){return this._currentLength/2})}(),function(){function b$M(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(8)}b$P(b$M,"laya.d3.core.particleShuriKen.module.GradientDataNumber");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y.add=function(b$M,b$y){this._currentLength<8?(6===this._currentLength&&1!==b$M&&(b$M=1,DEBUG),this._elements[this._currentLength++]=b$M,this._elements[this._currentLength++]=b$y):DEBUG},b$y.getKeyByIndex=function(b$M){return this._elements[2*b$M]},b$y.getValueByIndex=function(b$M){return this._elements[2*b$M+1]},b$y.getAverageValue=function(){for(var b$M=0,b$y=this._currentLength-2;b$M<b$y;b$M+=2){this._elements[b$M+1];this._elements[b$M+3],this._elements[b$M+2]-this._elements[b$M]}return 0},b$y.cloneTo=function(b$M){var b$y=b$M;b$y._currentLength=this._currentLength;var b$i=b$y._elements;b$i.length=this._elements.length;for(var b$H=0,b$S=this._elements.length;b$H<b$S;b$H++)b$i[b$H]=this._elements[b$H]},b$y.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$y,"gradientCount",function(){return this._currentLength/2})}(),function(){function b$M(){this._currentLength=0,this._elements=null,this._elements=new Float32Array(12)}b$P(b$M,"laya.d3.core.particleShuriKen.module.GradientDataVector2");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y.add=function(b$M,b$y){this._currentLength<8?(6===this._currentLength&&1!==b$M&&(b$M=1,DEBUG&&console.log("GradientDataVector2 warning:the forth key is  be force set to 1.")),this._elements[this._currentLength++]=b$M,this._elements[this._currentLength++]=b$y.x,this._elements[this._currentLength++]=b$y.y):DEBUG&&console.log("GradientDataVector2 warning:data count must lessEqual than 4")},b$y.cloneTo=function(b$M){var b$y=b$M;b$y._currentLength=this._currentLength;var b$i=b$y._elements;b$i.length=this._elements.length;for(var b$H=0,b$S=this._elements.length;b$H<b$S;b$H++)b$i[b$H]=this._elements[b$H]},b$y.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$y,"gradientCount",function(){return this._currentLength/3})}(),function(){function b$K(){this._type=0,this._separateAxes=!1,this._gradient=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=NaN,this._constantMax=NaN,this._constantMinSeparate=null,this._constantMaxSeparate=null,this._gradientMin=null,this._gradientMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}b$P(b$K,"laya.d3.core.particleShuriKen.module.GradientSize");var b$M=b$K.prototype;return b$G.imps(b$M,{"laya.d3.core.IClone":!0}),b$M.getMaxSizeInGradient=function(){var b$M=0,b$y=0,b$i=-Number.MAX_VALUE;switch(this._type){case 0:if(this._separateAxes){for(b$M=0,b$y=this._gradientX.gradientCount;b$M<b$y;b$M++)b$i=Math.max(b$i,this._gradientX.getValueByIndex(b$M));for(b$M=0,b$y=this._gradientY.gradientCount;b$M<b$y;b$M++)b$i=Math.max(b$i,this._gradientY.getValueByIndex(b$M))}else for(b$M=0,b$y=this._gradient.gradientCount;b$M<b$y;b$M++)b$i=Math.max(b$i,this._gradient.getValueByIndex(b$M));break;case 1:b$i=this._separateAxes?(b$i=Math.max(this._constantMinSeparate.x,this._constantMaxSeparate.x),b$i=Math.max(b$i,this._constantMinSeparate.y),Math.max(b$i,this._constantMaxSeparate.y)):Math.max(this._constantMin,this._constantMax);break;case 2:if(this._separateAxes){for(b$M=0,b$y=this._gradientXMin.gradientCount;b$M<b$y;b$M++)b$i=Math.max(b$i,this._gradientXMin.getValueByIndex(b$M));for(b$M=0,b$y=this._gradientXMax.gradientCount;b$M<b$y;b$M++)b$i=Math.max(b$i,this._gradientXMax.getValueByIndex(b$M));for(b$M=0,b$y=this._gradientYMin.gradientCount;b$M<b$y;b$M++)b$i=Math.max(b$i,this._gradientYMin.getValueByIndex(b$M));for(b$M=0,b$y=this._gradientZMax.gradientCount;b$M<b$y;b$M++)b$i=Math.max(b$i,this._gradientZMax.getValueByIndex(b$M))}else{for(b$M=0,b$y=this._gradientMin.gradientCount;b$M<b$y;b$M++)b$i=Math.max(b$i,this._gradientMin.getValueByIndex(b$M));for(b$M=0,b$y=this._gradientMax.gradientCount;b$M<b$y;b$M++)b$i=Math.max(b$i,this._gradientMax.getValueByIndex(b$M))}}return b$i},b$M.cloneTo=function(b$M){var b$y=b$M;b$y._type=this._type,b$y._separateAxes=this._separateAxes,this._gradient.cloneTo(b$y._gradient),this._gradientX.cloneTo(b$y._gradientX),this._gradientY.cloneTo(b$y._gradientY),this._gradientZ.cloneTo(b$y._gradientZ),b$y._constantMin=this._constantMin,b$y._constantMax=this._constantMax,this._constantMinSeparate.cloneTo(b$y._constantMinSeparate),this._constantMaxSeparate.cloneTo(b$y._constantMaxSeparate),this._gradientMin.cloneTo(b$y._gradientMin),this._gradientMax.cloneTo(b$y._gradientMax),this._gradientXMin.cloneTo(b$y._gradientXMin),this._gradientXMax.cloneTo(b$y._gradientXMax),this._gradientYMin.cloneTo(b$y._gradientYMin),this._gradientYMax.cloneTo(b$y._gradientYMax),this._gradientZMin.cloneTo(b$y._gradientZMin),this._gradientZMax.cloneTo(b$y._gradientZMax)},b$M.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$M,"gradientZ",function(){return this._gradientZ}),b$l(0,b$M,"gradient",function(){return this._gradient}),b$l(0,b$M,"separateAxes",function(){return this._separateAxes}),b$l(0,b$M,"type",function(){return this._type}),b$l(0,b$M,"gradientMin",function(){return this._gradientMin}),b$l(0,b$M,"constantMin",function(){return this._constantMin}),b$l(0,b$M,"gradientX",function(){return this._gradientX}),b$l(0,b$M,"gradientY",function(){return this._gradientY}),b$l(0,b$M,"gradientMax",function(){return this._gradientMax}),b$l(0,b$M,"constantMax",function(){return this._constantMax}),b$l(0,b$M,"constantMinSeparate",function(){return this._constantMinSeparate}),b$l(0,b$M,"constantMaxSeparate",function(){return this._constantMaxSeparate}),b$l(0,b$M,"gradientXMin",function(){return this._gradientXMin}),b$l(0,b$M,"gradientXMax",function(){return this._gradientXMax}),b$l(0,b$M,"gradientYMin",function(){return this._gradientYMin}),b$l(0,b$M,"gradientYMax",function(){return this._gradientYMax}),b$l(0,b$M,"gradientZMin",function(){return this._gradientZMin}),b$l(0,b$M,"gradientZMax",function(){return this._gradientZMax}),b$K.createByGradient=function(b$M){var b$y=new b$K;return b$y._type=0,b$y._separateAxes=!1,b$y._gradient=b$M,b$y},b$K.createByGradientSeparate=function(b$M,b$y,b$i){var b$H=new b$K;return b$H._type=0,b$H._separateAxes=!0,b$H._gradientX=b$M,b$H._gradientY=b$y,b$H._gradientZ=b$i,b$H},b$K.createByRandomTwoConstant=function(b$M,b$y){var b$i=new b$K;return b$i._type=1,b$i._separateAxes=!1,b$i._constantMin=b$M,b$i._constantMax=b$y,b$i},b$K.createByRandomTwoConstantSeparate=function(b$M,b$y){var b$i=new b$K;return b$i._type=1,b$i._separateAxes=!0,b$i._constantMinSeparate=b$M,b$i._constantMaxSeparate=b$y,b$i},b$K.createByRandomTwoGradient=function(b$M,b$y){var b$i=new b$K;return b$i._type=2,b$i._separateAxes=!1,b$i._gradientMin=b$M,b$i._gradientMax=b$y,b$i},b$K.createByRandomTwoGradientSeparate=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=new b$K;return b$V._type=2,b$V._separateAxes=!0,b$V._gradientXMin=b$M,b$V._gradientXMax=b$y,b$V._gradientYMin=b$i,b$V._gradientYMax=b$H,b$V._gradientZMin=b$S,b$V._gradientZMax=b$f,b$V},b$K}()),b$t=function(){function b$K(){this._type=0,this._constant=null,this._gradientX=null,this._gradientY=null,this._gradientZ=null,this._constantMin=null,this._constantMax=null,this._gradientXMin=null,this._gradientXMax=null,this._gradientYMin=null,this._gradientYMax=null,this._gradientZMin=null,this._gradientZMax=null}b$P(b$K,"laya.d3.core.particleShuriKen.module.GradientVelocity");var b$M=b$K.prototype;return b$G.imps(b$M,{"laya.d3.core.IClone":!0}),b$M.cloneTo=function(b$M){var b$y=b$M;b$y._type=this._type,this._constant.cloneTo(b$y._constant),this._gradientX.cloneTo(b$y._gradientX),this._gradientY.cloneTo(b$y._gradientY),this._gradientZ.cloneTo(b$y._gradientZ),this._constantMin.cloneTo(b$y._constantMin),this._constantMax.cloneTo(b$y._constantMax),this._gradientXMin.cloneTo(b$y._gradientXMin),this._gradientXMax.cloneTo(b$y._gradientXMax),this._gradientYMin.cloneTo(b$y._gradientYMin),this._gradientYMax.cloneTo(b$y._gradientYMax),this._gradientZMin.cloneTo(b$y._gradientZMin),this._gradientZMax.cloneTo(b$y._gradientZMax)},b$M.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$M,"gradientZ",function(){return this._gradientZ}),b$l(0,b$M,"constant",function(){return this._constant}),b$l(0,b$M,"type",function(){return this._type}),b$l(0,b$M,"gradientXMax",function(){return this._gradientXMax}),b$l(0,b$M,"constantMin",function(){return this._constantMin}),b$l(0,b$M,"gradientX",function(){return this._gradientX}),b$l(0,b$M,"gradientY",function(){return this._gradientY}),b$l(0,b$M,"gradientXMin",function(){return this._gradientXMin}),b$l(0,b$M,"constantMax",function(){return this._constantMax}),b$l(0,b$M,"gradientYMin",function(){return this._gradientYMin}),b$l(0,b$M,"gradientYMax",function(){return this._gradientYMax}),b$l(0,b$M,"gradientZMin",function(){return this._gradientZMin}),b$l(0,b$M,"gradientZMax",function(){return this._gradientZMax}),b$K.createByConstant=function(b$M){var b$y=new b$K;return b$y._type=0,b$y._constant=b$M,b$y},b$K.createByGradient=function(b$M,b$y,b$i){var b$H=new b$K;return b$H._type=1,b$H._gradientX=b$M,b$H._gradientY=b$y,b$H._gradientZ=b$i,b$H},b$K.createByRandomTwoConstant=function(b$M,b$y){var b$i=new b$K;return b$i._type=2,b$i._constantMin=b$M,b$i._constantMax=b$y,b$i},b$K.createByRandomTwoGradient=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=new b$K;return b$V._type=3,b$V._gradientXMin=b$M,b$V._gradientXMax=b$y,b$V._gradientYMin=b$i,b$V._gradientYMax=b$H,b$V._gradientZMin=b$S,b$V._gradientZMax=b$f,b$V},b$K}(),b$u=(function(){function b$M(b$M){this._angularVelocity=null,this.enbale=!1,this._angularVelocity=b$M}b$P(b$M,"laya.d3.core.particleShuriKen.module.RotationOverLifetime");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y.cloneTo=function(b$M){var b$y=b$M;this._angularVelocity.cloneTo(b$y._angularVelocity),b$y.enbale=this.enbale},b$y.clone=function(){var b$M;switch(this._angularVelocity.type){case 0:b$M=this._angularVelocity.separateAxes?b$z.createByConstantSeparate(this._angularVelocity.constantSeparate.clone()):b$z.createByConstant(this._angularVelocity.constant);break;case 1:b$M=this._angularVelocity.separateAxes?b$z.createByGradientSeparate(this._angularVelocity.gradientX.clone(),this._angularVelocity.gradientY.clone(),this._angularVelocity.gradientZ.clone(),this._angularVelocity.gradientW.clone()):b$z.createByGradient(this._angularVelocity.gradient.clone());break;case 2:b$M=this._angularVelocity.separateAxes?b$z.createByRandomTwoConstantSeparate(this._angularVelocity.constantMinSeparate.clone(),this._angularVelocity.constantMaxSeparate.clone()):b$z.createByRandomTwoConstant(this._angularVelocity.constantMin,this._angularVelocity.constantMax);break;case 3:b$M=this._angularVelocity.separateAxes?b$z.createByRandomTwoGradientSeparate(this._angularVelocity.gradientXMin.clone(),this._angularVelocity.gradientYMin.clone(),this._angularVelocity.gradientZMin.clone(),this._angularVelocity.gradientWMin.clone(),this._angularVelocity.gradientXMax.clone(),this._angularVelocity.gradientYMax.clone(),this._angularVelocity.gradientZMax.clone(),this._angularVelocity.gradientWMax.clone()):b$z.createByRandomTwoGradient(this._angularVelocity.gradientMin.clone(),this._angularVelocity.gradientMax.clone())}var b$y=new this.constructor(b$M);return b$y.enbale=this.enbale,b$y},b$l(0,b$y,"angularVelocity",function(){return this._angularVelocity})}(),function(){function b$M(){this.enable=!1,this.randomDirection=!1}b$P(b$M,"laya.d3.core.particleShuriKen.module.shape.BaseShape");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y._getShapeBoundBox=function(b$M){throw new Error("BaseShape: must override it.")},b$y._getSpeedBoundBox=function(b$M){throw new Error("BaseShape: must override it.")},b$y.generatePositionAndDirection=function(b$M,b$y,b$i,b$H){throw new Error("BaseShape: must override it.")},b$y._calculateProceduralBounds=function(b$M,b$y,b$i){this._getShapeBoundBox(b$M);var b$H=b$M.min,b$S=b$M.max;b$Vy.multiply(b$H,b$y,b$H),b$Vy.multiply(b$S,b$y,b$S);var b$f=new b$xM(new b$Vy,new b$Vy);this.randomDirection?(b$f.min=new b$Vy(-1,-1,-1),b$f.max=new b$Vy(1,1,1)):this._getSpeedBoundBox(b$f);var b$V=new b$xM(new b$Vy,new b$Vy),b$K=b$V.min,b$k=b$V.max;b$Vy.scale(b$f.min,b$i.y,b$K),b$Vy.scale(b$f.max,b$i.y,b$k),b$Vy.add(b$M.min,b$K,b$K),b$Vy.add(b$M.max,b$k,b$k),b$Vy.min(b$M.min,b$K,b$M.min),b$Vy.max(b$M.max,b$K,b$M.max);var b$X=new b$xM(new b$Vy,new b$Vy),b$F=b$X.min,b$o=b$X.max;b$Vy.scale(b$f.min,b$i.x,b$F),b$Vy.scale(b$f.max,b$i.x,b$o),b$Vy.min(b$X.min,b$o,b$K),b$Vy.max(b$X.min,b$o,b$k),b$Vy.min(b$M.min,b$K,b$M.min),b$Vy.max(b$M.max,b$K,b$M.max)},b$y.cloneTo=function(b$M){b$M.enable=this.enable},b$y.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$M}()),b$_=function(){function b$f(){}return b$P(b$f,"laya.d3.core.particleShuriKen.module.shape.ShapeUtils"),b$f._randomPointUnitArcCircle=function(b$M,b$y,b$i){var b$H=b$y.elements,b$S=NaN;b$S=b$i?b$i.getFloat()*b$M:Math.random()*b$M,b$H[0]=Math.cos(b$S),b$H[1]=Math.sin(b$S)},b$f._randomPointInsideUnitArcCircle=function(b$M,b$y,b$i){var b$H=b$y.elements;b$f._randomPointUnitArcCircle(b$M,b$y,b$i);var b$S=NaN;b$S=b$i?Math.pow(b$i.getFloat(),.5):Math.pow(Math.random(),.5),b$H[0]=b$H[0]*b$S,b$H[1]=b$H[1]*b$S},b$f._randomPointUnitCircle=function(b$M,b$y){var b$i=b$M.elements,b$H=NaN;b$H=b$y?b$y.getFloat()*Math.PI*2:Math.random()*Math.PI*2,b$i[0]=Math.cos(b$H),b$i[1]=Math.sin(b$H)},b$f._randomPointInsideUnitCircle=function(b$M,b$y){var b$i=b$M.elements;b$f._randomPointUnitCircle(b$M);var b$H=NaN;b$H=b$y?Math.pow(b$y.getFloat(),.5):Math.pow(Math.random(),.5),b$i[0]=b$i[0]*b$H,b$i[1]=b$i[1]*b$H},b$f._randomPointUnitSphere=function(b$M,b$y){var b$i=b$M.elements,b$H=NaN,b$S=NaN;b$S=b$y?(b$H=b$i[2]=2*b$y.getFloat()-1,b$y.getFloat()*Math.PI*2):(b$H=b$i[2]=2*Math.random()-1,Math.random()*Math.PI*2);var b$f=Math.sqrt(1-b$H*b$H);b$i[0]=b$f*Math.cos(b$S),b$i[1]=b$f*Math.sin(b$S)},b$f._randomPointInsideUnitSphere=function(b$M,b$y){var b$i=b$M.elements;b$f._randomPointUnitSphere(b$M);var b$H=NaN;b$H=b$y?Math.pow(b$y.getFloat(),1/3):Math.pow(Math.random(),1/3),b$i[0]=b$i[0]*b$H,b$i[1]=b$i[1]*b$H,b$i[2]=b$i[2]*b$H},b$f._randomPointInsideHalfUnitBox=function(b$M,b$y){var b$i=b$M.elements;b$y?(b$i[0]=b$y.getFloat()-.5,b$i[1]=b$y.getFloat()-.5,b$i[2]=b$y.getFloat()-.5):(b$i[0]=Math.random()-.5,b$i[1]=Math.random()-.5,b$i[2]=Math.random()-.5)},b$f}(),b$b=(function(){function b$M(b$M){this._size=null,this.enbale=!1,this._size=b$M}b$P(b$M,"laya.d3.core.particleShuriKen.module.SizeOverLifetime");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y.cloneTo=function(b$M){var b$y=b$M;this._size.cloneTo(b$y._size),b$y.enbale=this.enbale},b$y.clone=function(){var b$M;switch(this._size.type){case 0:b$M=this._size.separateAxes?b$q.createByGradientSeparate(this._size.gradientX.clone(),this._size.gradientY.clone(),this._size.gradientZ.clone()):b$q.createByGradient(this._size.gradient.clone());break;case 1:b$M=this._size.separateAxes?b$q.createByRandomTwoConstantSeparate(this._size.constantMinSeparate.clone(),this._size.constantMaxSeparate.clone()):b$q.createByRandomTwoConstant(this._size.constantMin,this._size.constantMax);break;case 2:b$M=this._size.separateAxes?b$q.createByRandomTwoGradientSeparate(this._size.gradientXMin.clone(),this._size.gradientYMin.clone(),this._size.gradientZMin.clone(),this._size.gradientXMax.clone(),this._size.gradientYMax.clone(),this._size.gradientZMax.clone()):b$q.createByRandomTwoGradient(this._size.gradientMin.clone(),this._size.gradientMax.clone())}var b$y=new this.constructor(b$M);return b$y.enbale=this.enbale,b$y},b$l(0,b$y,"size",function(){return this._size})}(),function(){function b$H(){this._type=0,this._constant=NaN,this._constantMin=NaN,this._constantMax=NaN}b$P(b$H,"laya.d3.core.particleShuriKen.module.StartFrame");var b$M=b$H.prototype;return b$G.imps(b$M,{"laya.d3.core.IClone":!0}),b$M.cloneTo=function(b$M){var b$y=b$M;b$y._type=this._type,b$y._constant=this._constant,b$y._constantMin=this._constantMin,b$y._constantMax=this._constantMax},b$M.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$M,"constant",function(){return this._constant}),b$l(0,b$M,"type",function(){return this._type}),b$l(0,b$M,"constantMin",function(){return this._constantMin}),b$l(0,b$M,"constantMax",function(){return this._constantMax}),b$H.createByConstant=function(b$M){var b$y=new b$H;return b$y._type=0,b$y._constant=b$M,b$y},b$H.createByRandomTwoConstant=function(b$M,b$y){var b$i=new b$H;return b$i._type=1,b$i._constantMin=b$M,b$i._constantMax=b$y,b$i},b$H}()),b$Y=(function(){function b$M(b$M,b$y){this._frame=null,this._startFrame=null,this.tiles=null,this.type=0,this.randomRow=!1,this.rowIndex=0,this.cycles=0,this.enableUVChannels=0,this.enable=!1,this.tiles=new b$fy(1,1),this.type=0,this.randomRow=!0,this.rowIndex=0,this.cycles=1,this.enableUVChannels=1,this._frame=b$M,this._startFrame=b$y}b$P(b$M,"laya.d3.core.particleShuriKen.module.TextureSheetAnimation");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y.cloneTo=function(b$M){var b$y=b$M;this.tiles.cloneTo(b$y.tiles),b$y.type=this.type,b$y.randomRow=this.randomRow,this._frame.cloneTo(b$y._frame),this._startFrame.cloneTo(b$y._startFrame),b$y.cycles=this.cycles,b$y.enableUVChannels=this.enableUVChannels,b$y.enable=this.enable},b$y.clone=function(){var b$M,b$y;switch(this._frame.type){case 0:b$M=b$D.createByConstant(this._frame.constant);break;case 1:b$M=b$D.createByOverTime(this._frame.frameOverTimeData.clone());break;case 2:b$M=b$D.createByRandomTwoConstant(this._frame.constantMin,this._frame.constantMax);break;case 3:b$M=b$D.createByRandomTwoOverTime(this._frame.frameOverTimeDataMin.clone(),this._frame.frameOverTimeDataMax.clone())}switch(this._startFrame.type){case 0:b$y=b$b.createByConstant(this._startFrame.constant);break;case 1:b$y=b$b.createByRandomTwoConstant(this._startFrame.constantMin,this._startFrame.constantMax)}var b$i=new this.constructor(b$M,b$y);return this.tiles.cloneTo(b$i.tiles),b$i.type=this.type,b$i.randomRow=this.randomRow,b$i.cycles=this.cycles,b$i.enableUVChannels=this.enableUVChannels,b$i.enable=this.enable,b$i},b$l(0,b$y,"frame",function(){return this._frame}),b$l(0,b$y,"startFrame",function(){return this._startFrame})}(),function(){function b$M(b$M){this._velocity=null,this.enbale=!1,this.space=0,this._velocity=b$M}b$P(b$M,"laya.d3.core.particleShuriKen.module.VelocityOverLifetime");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y.cloneTo=function(b$M){var b$y=b$M;this._velocity.cloneTo(b$y._velocity),b$y.enbale=this.enbale,b$y.space=this.space},b$y.clone=function(){var b$M;switch(this._velocity.type){case 0:b$M=b$t.createByConstant(this._velocity.constant.clone());break;case 1:b$M=b$t.createByGradient(this._velocity.gradientX.clone(),this._velocity.gradientY.clone(),this._velocity.gradientZ.clone());break;case 2:b$M=b$t.createByRandomTwoConstant(this._velocity.constantMin.clone(),this._velocity.constantMax.clone());break;case 3:b$M=b$t.createByRandomTwoGradient(this._velocity.gradientXMin.clone(),this._velocity.gradientYMin.clone(),this._velocity.gradientZMin.clone(),this._velocity.gradientXMax.clone(),this._velocity.gradientYMax.clone(),this._velocity.gradientZMax.clone())}var b$y=new this.constructor(b$M);return b$y.enbale=this.enbale,b$y.space=this.space,b$y},b$l(0,b$y,"velocity",function(){return this._velocity})}(),function(){function b$M(){this._tempInt0=0,this._tempInt1=0,this._tempUint0=0,this._tempUint1=0,this._tempUint2=0,this._tempUint3=0,this._tempUint4=0,this._tempUint5=0,this._tempUint6=0,this._tempUint7=0,this._tempNumver0=NaN,this._tempNumver1=NaN,this._tempNumver2=NaN,this._tempNumver3=NaN,this._floatSizePerVer=7,this._defaultBufferSize=600*this._floatSizePerVer,this._vb=null,this._posInVBData=0,this._ib=null,this._posInIBData=0,this._primitiveType=NaN,this._hasBegun=!1,this._numVertsPerPrimitive=0,this._camera=null,this._sharderNameID=0,this._shader=null,this._shaderCompile=null,this._vbData=new Float32Array(this._defaultBufferSize),this._ibData=new Uint16Array(this._defaultBufferSize),this._spriteShaderValue=new b$dy,this._vb=b$uy.create(b$M._vertexDeclaration,this._defaultBufferSize/this._floatSizePerVer,35048),this._ib=b$ty.create("ushort",this._defaultBufferSize,35048),this._sharderNameID=b$wy.nameKey.getID("LINE"),this._shaderCompile=b$Qy._preCompileShader[this._sharderNameID]}b$P(b$M,"laya.d3.core.PhasorSpriter3D");var b$y=b$M.prototype;return b$y.line=function(b$M,b$y,b$i,b$H){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+2*this._floatSizePerVer>this._vbData.length||this._posInIBData+2>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(b$M.x,b$M.y,b$M.z,b$y.x,b$y.y,b$y.z,b$y.w),this.addVertex(b$i.x,b$i.y,b$i.z,b$H.x,b$H.y,b$H.z,b$H.w),this.addIndexes(this._tempUint0,this._tempUint0+1),this},b$y.circle=function(b$M,b$y,b$i,b$H,b$S,b$f){for(this._hasBegun&&1===this._primitiveType||this.drawLinesException(),this._tempUint0=2*b$y,(this._posInVBData+this._tempUint0*this._floatSizePerVer>this._vbData.length||this._posInIBData+2*this._tempUint0>this._ibData.length)&&this.flush(),this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=0,this._tempInt0=0;this._tempNumver0<6.2832;this._tempNumver0=this._tempNumver0+3.1416/b$y,this._tempInt0++)this.addVertex(Math.sin(this._tempNumver0)*b$M,Math.cos(this._tempNumver0)*b$M,0,b$i,b$H,b$S,b$f),0===this._tempInt0?this.addIndexes(this._tempUint1):this._tempInt0===this._tempUint0-1?(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2,this._tempUint1)):(this._tempUint2=this._tempUint1+this._tempInt0,this.addIndexes(this._tempUint2,this._tempUint2));return this},b$y.plane=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+4*this._floatSizePerVer>this._vbData.length||this._posInIBData+6>this._ibData.length)&&this.flush(),this._tempNumver0=b$H/2,this._tempNumver1=b$S/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(b$M-this._tempNumver0,b$y+this._tempNumver1,b$i,b$f,b$V,b$K,b$k),this.addVertex(b$M+this._tempNumver0,b$y+this._tempNumver1,b$i,b$f,b$V,b$K,b$k),this.addVertex(b$M-this._tempNumver0,b$y-this._tempNumver1,b$i,b$f,b$V,b$K,b$k),this.addVertex(b$M+this._tempNumver0,b$y-this._tempNumver1,b$i,b$f,b$V,b$K,b$k),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint0+3),this},b$y.box=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){return this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+36>this._ibData.length)&&this.flush(),this._tempNumver0=b$H/2,this._tempNumver1=b$S/2,this._tempNumver2=b$f/2,this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(b$M-this._tempNumver0,b$y+this._tempNumver1,b$i+this._tempNumver2,b$V,b$K,b$k,b$X),this.addVertex(b$M+this._tempNumver0,b$y+this._tempNumver1,b$i+this._tempNumver2,b$V,b$K,b$k,b$X),this.addVertex(b$M-this._tempNumver0,b$y-this._tempNumver1,b$i+this._tempNumver2,b$V,b$K,b$k,b$X),this.addVertex(b$M+this._tempNumver0,b$y-this._tempNumver1,b$i+this._tempNumver2,b$V,b$K,b$k,b$X),this.addVertex(b$M+this._tempNumver0,b$y+this._tempNumver1,b$i-this._tempNumver2,b$V,b$K,b$k,b$X),this.addVertex(b$M-this._tempNumver0,b$y+this._tempNumver1,b$i-this._tempNumver2,b$V,b$K,b$k,b$X),this.addVertex(b$M+this._tempNumver0,b$y-this._tempNumver1,b$i-this._tempNumver2,b$V,b$K,b$k,b$X),this.addVertex(b$M-this._tempNumver0,b$y-this._tempNumver1,b$i-this._tempNumver2,b$V,b$K,b$k,b$X),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint2,this._tempUint2,this._tempUint1,this._tempUint3,this._tempUint4,this._tempUint5,this._tempUint6,this._tempUint6,this._tempUint5,this._tempUint7,this._tempUint5,this._tempUint0,this._tempUint7,this._tempUint7,this._tempUint0,this._tempUint2,this._tempUint1,this._tempUint4,this._tempUint3,this._tempUint3,this._tempUint4,this._tempUint6,this._tempUint5,this._tempUint4,this._tempUint0,this._tempUint0,this._tempUint4,this._tempUint1,this._tempUint2,this._tempUint3,this._tempUint7,this._tempUint7,this._tempUint3,this._tempUint6),this},b$y.cone=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){for(this._hasBegun&&4===this._primitiveType||this.drawTrianglesException(),(this._posInVBData+(2*b$i+2)*this._floatSizePerVer>this._vbData.length||this._posInIBData+6*b$i>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData,this._tempUint1=this._posInVBData/this._floatSizePerVer,this._tempNumver0=2*Math.PI/b$i,this.addVertexIndex(0,b$y,0,b$H,b$S,b$f,b$V,this._tempUint0),this.addVertexIndex(0,0,0,b$H,b$S,b$f,b$V,this._tempUint0+this._floatSizePerVer),this._tempInt0=2,this._tempNumver1=0,this._tempInt1=0;this._tempInt1<b$i;this._tempInt1++)this._tempNumver2=Math.cos(this._tempNumver1),this._tempNumver3=Math.sin(this._tempNumver1),this.addVertexIndex(b$M*this._tempNumver2,0,b$M*this._tempNumver3,b$H,b$S,b$f,b$V,this._tempUint0+this._tempInt0*this._floatSizePerVer),this.addIndexes(this._tempUint1,this._tempUint1+this._tempInt0),this._tempInt1==b$i-1?this.addIndexes(this._tempUint1+2):this.addIndexes(this._tempUint1+this._tempInt0+1),this.addVertexIndex(b$M*this._tempNumver2,0,b$M*this._tempNumver3,b$H,b$S,b$f,b$V,this._tempUint0+(this._tempInt0+b$i)*this._floatSizePerVer),this.addIndexes(this._tempUint1+1),this._tempInt1==b$i-1?this.addIndexes(this._tempUint1+b$i+2):this.addIndexes(this._tempUint1+this._tempInt0+b$i+1),this.addIndexes(this._tempUint1+this._tempInt0+b$i),this._tempInt0++,this._tempNumver1+=this._tempNumver0;return this},b$y.boundingBoxLine=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){return this._hasBegun&&1===this._primitiveType||this.drawLinesException(),(this._posInVBData+8*this._floatSizePerVer>this._vbData.length||this._posInIBData+48>this._ibData.length)&&this.flush(),this._tempUint0=this._posInVBData/this._floatSizePerVer,this.addVertex(b$M,b$S,b$f,b$V,b$K,b$k,b$X),this.addVertex(b$H,b$S,b$f,b$V,b$K,b$k,b$X),this.addVertex(b$M,b$y,b$f,b$V,b$K,b$k,b$X),this.addVertex(b$H,b$y,b$f,b$V,b$K,b$k,b$X),this.addVertex(b$H,b$S,b$i,b$V,b$K,b$k,b$X),this.addVertex(b$M,b$S,b$i,b$V,b$K,b$k,b$X),this.addVertex(b$H,b$y,b$i,b$V,b$K,b$k,b$X),this.addVertex(b$M,b$y,b$i,b$V,b$K,b$k,b$X),this._tempUint1=this._tempUint0+1,this._tempUint2=this._tempUint0+2,this._tempUint3=this._tempUint0+3,this._tempUint4=this._tempUint0+4,this._tempUint5=this._tempUint0+5,this._tempUint6=this._tempUint0+6,this._tempUint7=this._tempUint0+7,this.addIndexes(this._tempUint0,this._tempUint1,this._tempUint1,this._tempUint3,this._tempUint3,this._tempUint2,this._tempUint2,this._tempUint0,this._tempUint4,this._tempUint5,this._tempUint5,this._tempUint7,this._tempUint7,this._tempUint6,this._tempUint6,this._tempUint4,this._tempUint5,this._tempUint0,this._tempUint0,this._tempUint2,this._tempUint2,this._tempUint7,this._tempUint7,this._tempUint5,this._tempUint1,this._tempUint4,this._tempUint4,this._tempUint6,this._tempUint6,this._tempUint3,this._tempUint3,this._tempUint1,this._tempUint5,this._tempUint4,this._tempUint4,this._tempUint1,this._tempUint1,this._tempUint0,this._tempUint0,this._tempUint5,this._tempUint2,this._tempUint3,this._tempUint3,this._tempUint6,this._tempUint6,this._tempUint7,this._tempUint7,this._tempUint2),this},b$y.addVertex=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){return this._hasBegun||this.addVertexIndexException(),this._vbData[this._posInVBData]=b$M,this._vbData[this._posInVBData+1]=b$y,this._vbData[this._posInVBData+2]=b$i,this._vbData[this._posInVBData+3]=b$H,this._vbData[this._posInVBData+4]=b$S,this._vbData[this._posInVBData+5]=b$f,this._vbData[this._posInVBData+6]=b$V,this._posInVBData+=this._floatSizePerVer,this},b$y.addVertexIndex=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){return this._hasBegun||this.addVertexIndexException(),this._vbData[b$K]=b$M,this._vbData[b$K+1]=b$y,this._vbData[b$K+2]=b$i,this._vbData[b$K+3]=b$H,this._vbData[b$K+4]=b$S,this._vbData[b$K+5]=b$f,this._vbData[b$K+6]=b$V,(b$K+=this._floatSizePerVer)>this._posInVBData&&(this._posInVBData=b$K),this},b$y.addIndexes=function(b$M){var b$y=arguments;this._hasBegun||this.addVertexIndexException();for(var b$i=0;b$i<b$y.length;b$i++)this._ibData[this._posInIBData]=b$y[b$i],this._posInIBData++;return this},b$y.begin=function(b$M,b$y){return this._hasBegun&&this.beginException0(),1!==b$M&&4!==b$M&&this.beginException1(),this._primitiveType=b$M,this._camera=b$y,this._hasBegun=!0,this},b$y.end=function(){return this._hasBegun||this.endException(),this.flush(),this._hasBegun=!1,this},b$y.flush=function(){0!==this._posInVBData&&(this._ib.setData(this._ibData),this._vb.setData(this._vbData),this._vb._bind(),this._ib._bind(),this._shader=this._shaderCompile.withCompile(0,0,0),this._shader.bind(),this._shader.uploadAttributes(b$M._vertexDeclaration.shaderValues.data,null),this._spriteShaderValue.setValue(1,this._camera.projectionViewMatrix.elements),this._shader.uploadSpriteUniforms(this._spriteShaderValue.data),b$Q.drawCall++,b$T.mainContext.drawElements(this._primitiveType,this._posInIBData,5123,0),this._posInIBData=0,this._posInVBData=0)},b$y.addVertexIndexException=function(){throw new Error("请先调用begin()函数")},b$y.beginException0=function(){throw new Error("调用begin()前请确保已成功调用end()！")},b$y.beginException1=function(){throw new Error("只支持“LINES”和“TRIANGLES”两种基元！")},b$y.endException=function(){throw new Error("调用end()前请确保已成功调用begin()！")},b$y.drawLinesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“LINES”基元！")},b$y.drawTrianglesException=function(){throw new Error("您必须确保在此之前已调用begin()且使用“TRIANGLES”基元！")},b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(28,[new b$VM(0,"vector3",0),new b$VM(12,"vector4",1)])}]),b$M}()),b$r=function(){function b$M(){this._id=0,this._type=0,this._mainSortID=0,this._render=null,this._sprite3D=null,this._material=null,this._renderObj=null,this._staticBatch=null,this._tempBatchIndexStart=0,this._tempBatchIndexEnd=0,this._canDynamicBatch=!1,this._shaderValue=null,this._onPreRenderFunction=null,this._id=++b$M._uniqueIDCounter,this._canDynamicBatch=!0,this._shaderValue=new b$dy}b$P(b$M,"laya.d3.core.render.RenderElement");var b$y=b$M.prototype;return b$y.getDynamicBatchBakedVertexs=function(b$M){for(var b$y=this._renderObj._getVertexBuffer(b$M),b$i=b$y.getData().slice(),b$H=b$y.vertexDeclaration,b$S=b$H.getVertexElementByUsage(0).offset/4,b$f=b$H.getVertexElementByUsage(3).offset/4,b$V=this._sprite3D.transform,b$K=b$V.worldMatrix,b$k=b$V.rotation,b$X=b$H.vertexStride/4,b$F=0,b$o=b$i.length;b$F<b$o;b$F+=b$X){var b$d=b$F+b$S,b$P=b$F+b$f;b$hy.transformVector3ArrayToVector3ArrayCoordinate(b$i,b$d,b$K,b$i,b$d),b$hy.transformVector3ArrayByQuat(b$i,b$P,b$k,b$i,b$P)}return b$i},b$y.getBakedIndices=function(){return this._renderObj._getIndexBuffer().getData()},b$y._destroy=function(){this._staticBatch&&this._staticBatch._manager._garbageCollection(this)},b$l(0,b$y,"id",function(){return this._id}),b$l(0,b$y,"renderObj",function(){return this._renderObj},function(b$M){this._renderObj!==b$M&&(this._renderObj=b$M)}),b$M._uniqueIDCounter=0,b$M}(),b$N=function(){function b$y(b$M){this._id=0,this._needSort=!1,this._renderElements=null,this._renderableRenderObjects=null,this._dynamicBatchCombineRenderElements=null,this._finalElements=null,this._scene=null,this._id=++b$y._uniqueIDCounter,this._needSort=!1,this._scene=b$M,this._renderElements=[],this._renderableRenderObjects=[],this._dynamicBatchCombineRenderElements=[],this._errorRecord={}}b$P(b$y,"laya.d3.core.render.RenderQueue");var b$M=b$y.prototype;return b$M._sortOpaqueFunc=function(b$M,b$y){if(b$M._render&&b$y._render){var b$i=b$M._material.renderQueue-b$y._material.renderQueue;return 0==b$i?b$M._render._distanceForSort-b$y._render._distanceForSort:b$i}return 0},b$M._sortAlphaFunc=function(b$M,b$y){if(b$M._render&&b$y._render){var b$i=b$M._material.renderQueue-b$y._material.renderQueue;return 0==b$i?b$y._render._distanceForSort-b$M._render._distanceForSort:b$i}return 0},b$M._begainRenderElement=function(b$M,b$y,b$i){return!!b$y._beforeRender(b$M)},b$M._sortAlpha=function(b$M){b$y._cameraPosition=b$M,this._finalElements.sort(this._sortAlphaFunc)},b$M._sortOpaque=function(b$M){b$y._cameraPosition=b$M,this._finalElements.sort(this._sortOpaqueFunc)},b$M._preRender=function(b$M){this._finalElements=this._renderElements.concat(this._dynamicBatchCombineRenderElements)},b$M._render=function(b$M,b$y){for(var b$i,b$H,b$S,b$f,b$V,b$K,b$k=b$Q.loopCount,b$X=this._scene,b$F=b$M.camera,b$o=(b$F.id,!1),b$d=0,b$P=this._finalElements.length;b$d<b$P;b$d++){var b$l,b$J,b$h,b$C=this._finalElements[b$d];if(null!=b$C._onPreRenderFunction&&b$C._onPreRenderFunction.call(b$C._sprite3D,b$M),0===b$C._type){if(b$M.owner=b$h=b$C._sprite3D,b$M.renderElement=b$C,b$h._preRenderUpdateComponents(b$M),b$l=b$C.renderObj,b$J=b$C._material,this._begainRenderElement(b$M,b$l,b$J)){if(b$i=b$l._getVertexBuffers(),!(b$S=(b$H=b$l._getVertexBuffer(0)).vertexDeclaration)){if(!this._errorRecord[b$H.id]){this._errorRecord[b$H.id]=1;var b$v="vertexBuffer:"+("("+b$H._destroyed+","+b$H._released+","+b$H._referenceCount+","+b$H._buffer+")")+", material:"+(b$J?b$J.__className+"("+b$J._destroyed+","+b$J._released+")":"null")+", owner:"+(b$h?b$h.__className+"("+b$h._destroyed+","+b$h._activeInHierarchy+","+b$h._displayedInStage+")":"null")+", renderObj:"+(b$l?b$l.__className+"("+b$l._destroyed+","+b$l._released+","+b$l._referenceCount+")":"")+", parent:, url:"+(b$h?b$h.url:"")+", disposeStack:"+b$H.disposeStack;b$G.recordError("报错：unknown vertexDeclaration  "+b$v)}continue}if(b$o=(b$f=b$M._shader=b$J._getShader(b$X._shaderDefineValue,b$S.shaderDefineValue,b$h._shaderDefineValue)).bind()||b$k!==b$f._uploadLoopCount,b$i){if(b$f._uploadVertexBuffer!==b$i||b$o){for(var b$R=0;b$R<b$i.length;b$R++){var b$A=b$i[b$R];b$f.uploadAttributesX(b$A.vertexDeclaration.shaderValues.data,b$A)}b$f._uploadVertexBuffer=b$i}}else(b$f._uploadVertexBuffer!==b$H||b$o)&&(b$f.uploadAttributes(b$S.shaderValues.data,null),b$f._uploadVertexBuffer=b$H);(b$f._uploadScene!==b$X||b$o)&&(b$f.uploadSceneUniforms(b$X._shaderValues.data),b$f._uploadScene=b$X),(b$F!==b$f._uploadCamera||b$f._uploadSprite3D!==b$h||b$o)&&(b$f.uploadSpriteUniforms(b$h._shaderValues.data),b$f._uploadSprite3D=b$h),(b$F!==b$f._uploadCamera||b$o)&&(b$f.uploadCameraUniforms(b$F._shaderValues.data),b$f._uploadCamera=b$F),(b$f._uploadMaterial!==b$J||b$o)&&(b$J._upload(),b$f._uploadMaterial=b$J),b$V!==b$J?(b$J._setRenderStateBlendDepth(),b$J._setRenderStateFrontFace(b$y,b$h.transform),b$V=b$J,b$K=b$h):b$K!==b$h&&(b$J._setRenderStateFrontFace(b$y,b$h.transform),b$K=b$h),b$l._render(b$M),b$f._uploadLoopCount=b$k}b$h._postRenderUpdateComponents(b$M)}else if(2===b$C._type){b$C.renderObj;b$M.owner=b$h=b$C._sprite3D,b$M.renderElement=b$C,b$M._batchIndexStart=b$C._tempBatchIndexStart,b$M._batchIndexEnd=b$C._tempBatchIndexEnd,b$l=b$C.renderObj,b$J=b$C._material,this._begainRenderElement(b$M,b$l,b$J)&&(b$S=(b$H=b$l._getVertexBuffer(0)).vertexDeclaration,b$o=(b$f=b$M._shader=b$J._getShader(b$X._shaderDefineValue,b$S.shaderDefineValue,b$h._shaderDefineValue)).bind()||b$k!==b$f._uploadLoopCount,(b$f._uploadVertexBuffer!==b$H||b$o)&&(b$f.uploadAttributes(b$S.shaderValues.data,null),b$f._uploadVertexBuffer=b$H),(b$f._uploadScene!==b$X||b$o)&&(b$f.uploadSceneUniforms(b$X._shaderValues.data),b$f._uploadScene=b$X),(b$F!==b$f._uploadCamera||b$f._uploadSprite3D!==b$h||b$o)&&(b$f.uploadSpriteUniforms(b$h._shaderValues.data),b$f._uploadSprite3D=b$h),(b$F!==b$f._uploadCamera||b$o)&&(b$f.uploadCameraUniforms(b$F._shaderValues.data),b$f._uploadCamera=b$F),(b$f._uploadMaterial!==b$J||b$o)&&(b$J._upload(),b$f._uploadMaterial=b$J),b$V!==b$J?(b$J._setRenderStateBlendDepth(),b$J._setRenderStateFrontFace(b$y,b$h.transform),b$V=b$J,b$K=b$h):b$K!==b$h&&(b$J._setRenderStateFrontFace(b$y,b$h.transform),b$K=b$h),b$l._render(b$M),b$f._uploadLoopCount=b$k)}}},b$M._renderShadow=function(b$M,b$y){for(var b$i,b$H,b$S,b$f,b$V,b$K=b$Q.loopCount,b$k=this._scene,b$X=b$M.camera,b$F=!1,b$o=0,b$d=this._finalElements.length;b$o<b$d;b$o++){var b$P,b$l,b$J,b$h=this._finalElements[b$o];0===b$h._type&&(b$M.owner=b$J=b$h._sprite3D,b$y||b$J._projectionViewWorldUpdateCamera===b$X&&b$J._projectionViewWorldUpdateLoopCount===b$Q.loopCount||(b$J._render._renderUpdate(b$M._projectionViewMatrix),b$J._projectionViewWorldUpdateLoopCount=b$Q.loopCount,b$J._projectionViewWorldUpdateCamera=b$X),b$M.renderElement=b$h,b$J._preRenderUpdateComponents(b$M),b$P=b$h.renderObj,b$l=b$h._material,this._begainRenderElement(b$M,b$P,null)&&(b$H=(b$i=b$P._getVertexBuffer(0)).vertexDeclaration,b$F=(b$S=b$M._shader=b$l._getShader(b$k._shaderDefineValue,b$H.shaderDefineValue,b$J._shaderDefineValue)).bind()||b$K!==b$S._uploadLoopCount,(b$S._uploadVertexBuffer!==b$i||b$F)&&(b$S.uploadAttributes(b$H.shaderValues.data,null),b$S._uploadVertexBuffer=b$i),(b$X!==b$S._uploadCamera||b$S._uploadSprite3D!==b$J||b$F)&&(b$S.uploadSpriteUniforms(b$J._shaderValues.data),b$S._uploadSprite3D=b$J),(b$X!==b$S._uploadCamera||b$F)&&(b$S.uploadCameraUniforms(b$X._shaderValues.data),b$S._uploadCamera=b$X),(b$S._uploadMaterial!==b$l||b$F)&&(b$l._upload(),b$S._uploadMaterial=b$l),b$S._uploadRenderElement,b$f!==b$l?(b$l._setRenderStateFrontFace(!1,b$J.transform),b$f=b$l,b$V=b$J):b$V!==b$J&&(b$l._setRenderStateFrontFace(!1,b$J.transform),b$V=b$J),b$P._render(b$M),b$S._uploadLoopCount=b$K),b$J._postRenderUpdateComponents(b$M))}},b$M._clearRenderElements=function(){this._dynamicBatchCombineRenderElements.length=0,this._renderElements.length=0,this._needSort=!0},b$M._addRenderElement=function(b$M){this._renderElements.push(b$M),this._needSort=!0},b$M._addDynamicBatchElement=function(b$M){this._dynamicBatchCombineRenderElements.push(b$M)},b$l(0,b$M,"id",function(){return this._id}),b$y._uniqueIDCounter=0,b$y._cameraPosition=null,b$y}(),b$$=function(){function b$M(){this._staticBatch=null,this._batchIndexStart=0,this._batchIndexEnd=0,this._viewMatrix=null,this._projectionMatrix=null,this._projectionViewMatrix=null,this._viewport=null,this._shader=null,this.elapsedTime=NaN,this.scene=null,this.owner=null,this.renderElement=null,this.camera=null}return b$P(b$M,"laya.d3.core.render.RenderState"),b$M.clientWidth=0,b$M.clientHeight=0,b$M}(),b$x=function(){function b$V(b$M,b$y){this._exactBox=null,this._relaxBox=null,this._scene=null,this._parent=null,this._currentDepth=0,this._boundingSphere=new b$jM(new b$Vy,0),this._corners=[new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy],this._boundingBoxCenter=new b$Vy,this._children=b$H(8),this._objects=[],this._tempBoundBoxCorners=[new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy],this._scene=b$M,this._currentDepth=b$y}b$P(b$V,"laya.d3.core.scene.OctreeNode");var b$M=b$V.prototype;return b$G.imps(b$M,{"laya.d3.core.scene.ITreeNode":!0}),b$M.init=function(b$M,b$y){var b$i=new b$Vy,b$H=new b$Vy;b$Vy.scale(b$y,-.5,b$i),b$Vy.scale(b$y,.5,b$H),b$Vy.add(b$i,b$M,b$i),b$Vy.add(b$H,b$M,b$H),this.exactBox=new b$xM(b$i,b$H),this.relaxBox=new b$xM(b$i,b$H)},b$M.addTreeNode=function(b$M){1===Collision.boxContainsBox(this._relaxBox,b$M.boundingBox)?this.addNodeDown(b$M,0):this.addObject(b$M)},b$M.addChild=function(b$M){var b$y=this._children[b$M];if(null==b$y){b$y=new b$V(this._scene,this._currentDepth+1),(this._children[b$M]=b$y)._parent=this,b$Vy.subtract(this._exactBox.max,this._exactBox.min,b$V.tempSize),b$Vy.multiply(b$V.tempSize,b$V._octreeSplit[b$M],b$V.tempCenter),b$Vy.add(this._exactBox.min,b$V.tempCenter,b$V.tempCenter),b$Vy.scale(b$V.tempSize,.25,b$V.tempSize);var b$i=new b$Vy,b$H=new b$Vy;b$Vy.subtract(b$V.tempCenter,b$V.tempSize,b$i),b$Vy.add(b$V.tempCenter,b$V.tempSize,b$H),b$y.exactBox=new b$xM(b$i,b$H),b$Vy.scale(b$V.tempSize,b$V.relax,b$V.tempSize);var b$S=new b$Vy,b$f=new b$Vy;b$Vy.subtract(b$V.tempCenter,b$V.tempSize,b$S),b$Vy.add(b$V.tempCenter,b$V.tempSize,b$f),b$y.relaxBox=new b$xM(b$S,b$f)}return b$y},b$M.addObject=function(b$M){(b$M._treeNode=this)._objects.push(b$M)},b$M.removeObject=function(b$M){if(b$M._treeNode!=this)return console.log("OctreeNode::removeObject error"),!1;var b$y=this._objects.indexOf(b$M);return-1!==b$y&&(this._objects.splice(b$y,1),!0)},b$M.clearObject=function(){this._objects.length=0},b$M.addNodeUp=function(b$M,b$y){this._parent&&1!==Collision.boxContainsBox(this._exactBox,b$M.boundingBox)?this._parent.addNodeUp(b$M,b$y-1):this.addNodeDown(b$M,b$y)},b$M.addNodeDown=function(b$M,b$y){if(b$y<this._scene.treeLevel){var b$i=this.inChildIndex(b$M.boundingBoxCenter),b$H=this.addChild(b$i);1===Collision.boxContainsBox(b$H._relaxBox,b$M.boundingBox)?b$H.addNodeDown(b$M,++b$y):this.addObject(b$M)}else this.addObject(b$M)},b$M.inChildIndex=function(b$M){return 4*(b$M.z<this._boundingBoxCenter.z?0:1)+2*(b$M.y<this._boundingBoxCenter.y?0:1)+(b$M.x<this._boundingBoxCenter.x?0:1)},b$M.updateObject=function(b$M){1===Collision.boxContainsBox(this._relaxBox,b$M.boundingBox)?(this.removeObject(b$M),b$M._treeNode=null,this.addNodeDown(b$M,this._currentDepth)):this._parent&&(this.removeObject(b$M),b$M._treeNode=null,this._parent.addNodeUp(b$M,this._currentDepth-1))},b$M.cullingObjects=function(b$M,b$y,b$i,b$H,b$S){var b$f,b$V=0,b$K=0,b$k=0,b$X=this._scene._dynamicBatchManager;for(b$V=0,b$f=this._objects.length;b$V<b$f;b$V++){var b$F=this._objects[b$V];if(b$s.isVisible(b$F._owner.layer.mask)&&b$F.enable){if(b$y&&(b$Q.treeSpriteCollision+=1,0===b$M.containsBoundSphere(b$F.boundingSphere)))continue;b$F._renderUpdate(b$S),b$F._distanceForSort=b$Vy.distance(b$F.boundingSphere.center,b$H)+b$F.sortingFudge;var b$o=b$F._renderElements;for(b$K=0,b$k=b$o.length;b$K<b$k;b$K++){var b$d=b$o[b$K],b$P=b$d._staticBatch;if(b$P&&b$P._material===b$d._material)b$P._addBatchRenderElement(b$d);else{var b$l=b$d.renderObj;b$l.triangleCount<10&&1===b$l._vertexBufferCount&&b$l._getIndexBuffer()&&b$d._material.renderQueue<2&&b$d._canDynamicBatch&&!b$F._owner.isStatic?b$X._addPrepareRenderElement(b$d):this._scene.getRenderQueue(b$d._material.renderQueue)._addRenderElement(b$d)}}}}for(b$V=0;b$V<8;b$V++){var b$J=this._children[b$V];if(null!=b$J){var b$h=b$y;if(b$y){var b$C=b$M.containsBoundBox(b$J._relaxBox);if(b$Q.treeNodeCollision+=1,0===b$C)continue;b$h=2===b$C}b$J.cullingObjects(b$M,b$h,b$i,b$H,b$S)}}},b$M.cullingShadowObjects=function(b$M,b$y,b$i,b$H,b$S){var b$f,b$V=0,b$K=0,b$k=0;this._scene._dynamicBatchManager;for(b$V=0,b$f=this._objects.length;b$V<b$f;b$V++){var b$X=this._objects[b$V];if(b$X.castShadow&&b$s.isVisible(b$X._owner.layer.mask)&&b$X.enable){if(b$i&&0===b$M[0].containsBoundSphere(b$X.boundingSphere))continue;for(var b$F=1,b$o=b$M.length;b$F<b$o;b$F++){var b$d=b$y[b$F-1];if(0!==b$M[b$F].containsBoundSphere(b$X.boundingSphere)){var b$P=b$X._renderElements;for(b$K=0,b$k=b$P.length;b$K<b$k;b$K++)b$d._addRenderElement(b$P[b$K])}}}}for(b$V=0;b$V<8;b$V++){var b$l=this._children[b$V];if(null!=b$l){var b$J=b$i;if(b$i){var b$h=b$M[0].containsBoundBox(b$l._relaxBox);if(0===b$h)continue;b$J=2===b$h}b$l.cullingShadowObjects(b$M,b$y,b$J,b$H,b$S)}}},b$M.cullingShadowObjectsOnePSSM=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V,b$K=b$y[0],b$k=0,b$X=0,b$F=0;for(b$k=0,b$V=this._objects.length;b$k<b$V;b$k++){var b$o=this._objects[b$k];if(b$o.castShadow&&b$s.isVisible(b$o._owner.layer.mask)&&b$o.enable){if(b$H&&0===b$M.containsBoundSphere(b$o.boundingSphere))continue;b$o._renderUpdate(b$i);var b$d=b$o._renderElements;for(b$X=0,b$F=b$d.length;b$X<b$F;b$X++)b$K._addRenderElement(b$d[b$X])}}for(b$k=0;b$k<8;b$k++){var b$P=this._children[b$k];if(null!=b$P){var b$l=b$H;if(b$H){var b$J=b$M.containsBoundBox(b$P._relaxBox);if(0===b$J)continue;b$l=2===b$J}b$P.cullingShadowObjectsOnePSSM(b$M,b$y,b$i,b$l,b$S,b$f)}}},b$M.renderBoudingBox=function(b$M){this._renderBoudingBox(b$M);for(var b$y=0;b$y<8;++b$y){var b$i=this._children[b$y];b$i&&b$i.renderBoudingBox(b$M)}},b$M.buildAllChild=function(b$M){if(b$M<this._scene.treeLevel)for(var b$y=0;b$y<8;b$y++){this.addChild(b$y).buildAllChild(b$M+1)}},b$M._renderBoudingBox=function(b$M){},b$l(0,b$M,"exactBox",function(){return this._exactBox},function(b$M){this._exactBox=b$M,b$Vy.add(b$M.min,b$M.max,this._boundingBoxCenter),b$Vy.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter)}),b$l(0,b$M,"relaxBox",function(){return this._relaxBox},function(b$M){(this._relaxBox=b$M).getCorners(this._corners),b$jM.createfromPoints(this._corners,this._boundingSphere)}),b$V.debugMode=!1,b$V.relax=1.15,b$V.CHILDNUM=8,b$o(b$V,["tempVector0",function(){return this.tempVector0=new b$Vy},"tempSize",function(){return this.tempSize=new b$Vy},"tempCenter",function(){return this.tempCenter=new b$Vy},"_octreeSplit",function(){return this._octreeSplit=[new b$Vy(.25,.25,.25),new b$Vy(.75,.25,.25),new b$Vy(.25,.75,.25),new b$Vy(.75,.75,.25),new b$Vy(.25,.25,.75),new b$Vy(.75,.25,.75),new b$Vy(.25,.75,.75),new b$Vy(.75,.75,.75)]}]),b$V}(),b$g=(function(){function b$M(){}b$P(b$M,"laya.d3.core.scene.SceneManager")}(),function(){function b$M(b$M,b$y,b$i,b$H){this._r=NaN,this._g=NaN,this._b=NaN,this._a=NaN,void 0===b$M&&(b$M=1),void 0===b$y&&(b$y=1),void 0===b$i&&(b$i=1),void 0===b$H&&(b$H=1),this._r=b$M,this._g=b$y,this._b=b$i,this._a=b$H}return b$P(b$M,"laya.d3.core.trail.module.Color",null,"Color$1"),b$M.prototype.cloneTo=function(b$M){b$M._r=this._r,b$M._g=this._g,b$M._b=this._b,b$M._a=this._a},b$o(b$M,["RED",function(){return this.RED=new b$M(1,0,0,1)},"GREEN",function(){return this.GREEN=new b$M(0,1,0,1)},"BLUE",function(){return this.BLUE=new b$M(0,0,1,1)},"CYAN",function(){return this.CYAN=new b$M(0,1,1,1)},"YELLOW",function(){return this.YELLOW=new b$M(1,.92,.016,1)},"MAGENTA",function(){return this.MAGENTA=new b$M(1,0,1,1)},"GRAY",function(){return this.GRAY=new b$M(.5,.5,.5,1)},"WHITE",function(){return this.WHITE=new b$M(1,1,1,1)},"BLACK",function(){return this.BLACK=new b$M(0,0,0,1)}]),b$M}()),b$j=(function(){function b$M(){this._mode=0,this._colorKeys=null,this._alphaKeys=null,this.index=0,this._colorKeyData=new Float32Array(40),this._alphaKeyData=new Float32Array(20),this._colorKeys=[],this._alphaKeys=[]}b$P(b$M,"laya.d3.core.trail.module.Gradient");var b$y=b$M.prototype;b$y.setKeys=function(b$M,b$y){var b$i,b$H;this._colorKeys=b$M;for(var b$S=this.index=0;b$S<b$M.length;b$S++){var b$f=(b$i=b$M[b$S]).color;this._colorKeyData[this.index++]=b$f._r,this._colorKeyData[this.index++]=b$f._g,this._colorKeyData[this.index++]=b$f._b,this._colorKeyData[this.index++]=b$i.time}this._alphaKeys=b$y;for(var b$V=this.index=0;b$V<b$y.length;b$V++)b$H=b$y[b$V],this._alphaKeyData[this.index++]=b$H.alpha,this._alphaKeyData[this.index++]=b$H.time},b$y.cloneTo=function(b$M){var b$y=0,b$i=0,b$H=this.colorKeys,b$S=[];for(b$y=0,b$i=b$H.length;b$y<b$i;b$y++){var b$f=new b$O;b$H[b$y].cloneTo(b$f),b$S.push(b$f)}var b$V=this.alphaKeys,b$K=[];for(b$y=0,b$i=b$V.length;b$y<b$i;b$y++){var b$k=new b$j;b$V[b$y].cloneTo(b$k),b$K.push(b$k)}b$M.setKeys(b$S,b$K)},b$l(0,b$y,"mode",function(){return this._mode},function(b$M){this._mode=b$M}),b$l(0,b$y,"colorKeys",function(){return this._colorKeys},function(b$M){this._colorKeys=b$M;for(var b$y=this.index=0;b$y<b$M.length;b$y++){var b$i=b$M[b$y],b$H=b$i.color;this._colorKeyData[this.index++]=b$H._r,this._colorKeyData[this.index++]=b$H._g,this._colorKeyData[this.index++]=b$H._b,this._colorKeyData[this.index++]=b$i.time}}),b$l(0,b$y,"alphaKeys",function(){return this._alphaKeys},function(b$M){this._alphaKeys=b$M;for(var b$y=this.index=0;b$y<b$M.length;b$y++){var b$i=b$M[b$y];this._alphaKeyData[this.index++]=b$i.alpha,this._alphaKeyData[this.index++]=b$i.time}})}(),function(){function b$M(b$M,b$y){this._alpha=NaN,this._time=NaN,void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),this._alpha=b$M,this._time=b$y}b$P(b$M,"laya.d3.core.trail.module.GradientAlphaKey");var b$y=b$M.prototype;return b$y.cloneTo=function(b$M){b$M.alpha=this.alpha,b$M.time=this.time},b$l(0,b$y,"alpha",function(){return this._alpha},function(b$M){this._alpha=b$M}),b$l(0,b$y,"time",function(){return this._time},function(b$M){this._time=b$M}),b$M}()),b$O=function(){function b$M(b$M,b$y){this._color=null,this._time=NaN,void 0===b$y&&(b$y=0),this._color=b$M||new b$g,this._time=b$y}b$P(b$M,"laya.d3.core.trail.module.GradientColorKey");var b$y=b$M.prototype;return b$y.cloneTo=function(b$M){this.color.cloneTo(b$M.color),b$M.time=this.time},b$l(0,b$y,"color",function(){return this._color},function(b$M){this._color=b$M}),b$l(0,b$y,"time",function(){return this._time},function(b$M){this._time=b$M}),b$M}(),b$L=(function(){function b$M(){}b$P(b$M,"laya.d3.core.trail.module.GradientMode"),b$M.Blend=0,b$M.Fixed=1}(),function(){function b$M(){}b$P(b$M,"laya.d3.core.trail.module.TextureMode"),b$M.Stretch=0,b$M.Tile=1}(),function(){function b$M(){this.time=NaN,this.inTangent=NaN,this.outTangent=NaN,this.value=NaN}b$P(b$M,"laya.d3.core.trail.module.TrailKeyFrame"),b$M.prototype.cloneTo=function(b$M){b$M.time=this.time,b$M.inTangent=this.inTangent,b$M.outTangent=this.outTangent,b$M.value=this.value}}(),function(){function b$y(b$M){this._id=0,this._owner=null,this._camera=null,this._vertexBuffers=null,this._verticesCount=0,this._virtualVerticesCount=0,this._maxVerticesCount=256,this._vertices1=null,this._vertexBuffer1=null,this._floatCountPerVertices1=8,this._verticesIndex1=0,this._everyAddVerticeCount1=0,this._delLength=0,this._vertices2=null,this._vertexBuffer2=null,this._floatCountPerVertices2=1,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._pointe=null,this._pointAtoBVector3e=null,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._curtime=NaN,this._curDisappearIndex=0,this._lastPosition=new b$Vy,this._curPosition=new b$Vy,this._delVector3=new b$Vy,this._lastFixedVertexPosition=new b$Vy,this._pointAtoBVector3=new b$Vy,this._pointA=new b$Vy,this._pointB=new b$Vy,this._owner=b$M,this._id=b$y.renderElementCount++,0==this._id?b$M._owner.transform.position.cloneTo(this._lastPosition):b$M._curSubTrailFinishPosition.cloneTo(this._lastPosition),this._everyGroupVertexBirthTime=[],this._VerticesToTailLength=new Float32Array(this._maxVerticesCount),this._everyVertexToPreVertexDistance=new Float32Array(this._maxVerticesCount),this._vertices1=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices1),this._vertices2=new Float32Array(this._maxVerticesCount*this._floatCountPerVertices2),this._vertexBuffer1=new b$uy(b$L.vertexDeclaration1,this._maxVerticesCount,35044,!0),this._vertexBuffer2=new b$uy(b$L.vertexDeclaration2,this._maxVerticesCount,35044,!0),this._vertexBuffers=[],this._vertexBuffers.push(this._vertexBuffer1),this._vertexBuffers.push(this._vertexBuffer2)}b$P(b$y,"laya.d3.core.trail.TrailRenderElement");var b$M=b$y.prototype;b$G.imps(b$M,{"laya.d3.core.render.IRenderable":!0}),b$M._updateTrail=function(){this._everyAddVerticeCount1=0,this._isStart||this._addTrailByFirstPosition(this._lastPosition,this._curPosition),this._addTrailByNextPosition(this._curPosition),this._vertexBuffer1.setData(this._vertices1,this._verticesIndex1,this._verticesIndex1,this._everyAddVerticeCount1),this._verticesIndex1+=this._everyAddVerticeCount1,this._curPosition.cloneTo(this._lastPosition),2==this._virtualVerticesCount&&(this._verticesIndex1-=2*this._floatCountPerVertices1)},b$M._addTrailByFirstPosition=function(b$M,b$y){b$Vy.subtract(b$y,b$M,this._delVector3),b$Vy.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),b$Vy.normalize(this._pointAtoBVector3,this._pointAtoBVector3),b$Vy.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._updateVerticesByPosition(b$M),b$M.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._curtime=this._owner._hasLifeSubTrail?this._owner._curSubTrailFinishCurTime:this._owner._curtime,this._everyGroupVertexBirthTime.push(this._curtime),this._isStart=!0,this._owner._hasLifeSubTrail=!0},b$M._addTrailByNextPosition=function(b$M){b$Vy.subtract(b$M,this._lastFixedVertexPosition,this._delVector3),b$Vy.cross(this._delVector3,this._camera.forward,this._pointAtoBVector3),b$Vy.normalize(this._pointAtoBVector3,this._pointAtoBVector3),b$Vy.scale(this._pointAtoBVector3,this._owner.widthMultiplier/2,this._pointAtoBVector3),this._delLength=b$Vy.scalarLength(this._delVector3),this._delLength-this._owner.minVertexDistance>=b$OM.zeroTolerance?(this._owner._trailTotalLength+=this._delLength,this._owner._trailSupplementLength=0,this._updateVerticesByPosition(b$M),b$M.cloneTo(this._lastFixedVertexPosition),this._verticesCount+=2,this._virtualVerticesCount=0,this._everyGroupVertexBirthTime.push(this._owner._curtime),this._verticesCount==this._maxVerticesCount&&this._onTrailRenderElementFinish()):(this._owner._trailSupplementLength=this._delLength,this._updateVerticesByPosition(b$M),this._virtualVerticesCount=2)},b$M._updateVerticesByPosition=function(b$M){this._pointe=b$M.elements,this._pointAtoBVector3e=this._pointAtoBVector3.elements,this._curtime=this._owner._curtime,this._owner._hasLifeSubTrail&&0==this._isStart&&(this._pointe=this._owner._curSubTrailFinishPosition.elements,this._pointAtoBVector3e=this._owner._curSubTrailFinishDirection.elements,this._curtime=this._owner._curSubTrailFinishCurTime),this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=-this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=1,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointe[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[0],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[1],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._pointAtoBVector3e[2],this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=this._curtime,this._vertices1[this._verticesIndex1+this._everyAddVerticeCount1++]=0,this._VerticesToTailLength[this._verticesCount/2]=this._owner._trailTotalLength+this._owner._trailSupplementLength,0==this._owner._trailSupplementLength?this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._delLength:this._everyVertexToPreVertexDistance[this._verticesCount/2]=this._isStart?this._owner._trailSupplementLength:0},b$M._updateVertexBuffer2=function(){var b$M,b$y=0,b$i=0,b$H=0;for(b$H=0,b$M=(this._verticesCount+this._virtualVerticesCount)/2;b$H<b$M;b$H++)b$i=0==this._owner.textureMode?(this._VerticesToTailLength[b$H]-this._owner._trailDeadLength)/(this._owner._trailTotalLength+this._owner._trailSupplementLength-this._owner._trailDeadLength):this._owner._trailTotalLength+this._owner._trailSupplementLength-this._VerticesToTailLength[b$H],this._vertices2[b$y++]=1-b$i,this._vertices2[b$y++]=1-b$i;this._vertexBuffer2.setData(this._vertices2,0,0,this._verticesCount+this._virtualVerticesCount)},b$M._onTrailRenderElementFinish=function(){this._lastFixedVertexPosition.cloneTo(this._owner._curSubTrailFinishPosition),this._pointAtoBVector3.cloneTo(this._owner._curSubTrailFinishDirection),this._owner._curSubTrailFinishCurTime=this._owner._curtime,this._isFinish=!0},b$M._updateDisappear=function(){var b$M,b$y=0;for(b$y=this._curDisappearIndex,b$M=(this._verticesCount+this._virtualVerticesCount)/2;b$y<b$M;b$y++)this._owner._curtime-this._everyGroupVertexBirthTime[b$y]>=this._owner.time+b$OM.zeroTolerance&&(this._curDisappearIndex++,this._owner._trailDeadLength+=this._everyVertexToPreVertexDistance[this._curDisappearIndex],this._curDisappearIndex>=(this._verticesCount+this._virtualVerticesCount)/2&&(this._isDead=!0))},b$M._beforeRender=function(b$M){return this._camera=b$M.camera,null!=this._camera&&(this._owner._owner.transform.position.cloneTo(this._curPosition),!this._isDead&&(this._verticesCount<this._maxVerticesCount?(this._owner._isStart||(this._owner._owner.transform.position.cloneTo(this._lastPosition),this._owner._isStart=!0),b$Vy.equals(this._lastPosition,this._curPosition)||this._updateTrail()):this._isFinish&&(this._isFinish=!1,this._owner._curSubTrailFinished=!0),0<this._verticesCount)&&(this._updateVertexBuffer2(),this._updateDisappear(),!0))},b$M._render=function(b$M){this._isDead||(b$T.mainContext.drawArrays(5,2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),console.log(2*this._curDisappearIndex,this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex),b$Q.drawCall++,b$Q.trianglesFaces+=this._verticesCount+this._virtualVerticesCount-2*this._curDisappearIndex-2)},b$M._getVertexBuffer=function(b$M){return void 0===b$M&&(b$M=0),0===b$M?this._vertexBuffer1:1===b$M?this._vertexBuffer2:null},b$M._getVertexBuffers=function(){return this._vertexBuffers},b$M._getIndexBuffer=function(){return null},b$M.reActivate=function(){this._id=laya.d3.core.trail.TrailRenderElement.renderElementCount++,this._isStart=!1,this._isFinish=!1,this._isDead=!1,this._verticesCount=0,this._virtualVerticesCount=0,this._verticesIndex1=0,this._delLength=0,this._curDisappearIndex=0,this._everyGroupVertexBirthTime=[],this._owner._curSubTrailFinishPosition.cloneTo(this._lastPosition)},b$M._destroy=function(){this._vertexBuffer1.dispose(),this._vertexBuffer2.dispose(),this._vertices1=null,this._vertexBuffer1=null,this._vertices2=null,this._vertexBuffer2=null,this._vertexBuffers=null,this._everyGroupVertexBirthTime=null,this._VerticesToTailLength=null,this._everyVertexToPreVertexDistance=null,this._lastPosition=null,this._curPosition=null,this._delVector3=null,this._lastFixedVertexPosition=null,this._pointAtoBVector3=null,this._pointe=null,this._pointAtoBVector3e=null,this._pointA=null,this._pointB=null},b$l(0,b$M,"_vertexBufferCount",function(){return this._vertexBuffers.length}),b$l(0,b$M,"triangleCount",function(){return 0}),b$y.renderElementCount=0}(),function(){function b$M(){}b$P(b$M,"laya.d3.core.trail.VertexTrail");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration1}),b$l(1,b$M,"vertexDeclaration1",function(){return b$M._vertexDeclaration1}),b$l(1,b$M,"vertexDeclaration2",function(){return b$M._vertexDeclaration2}),b$o(b$M,["_vertexDeclaration1",function(){return this._vertexDeclaration1=new b$fM(32,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",41),new b$VM(24,"single",33),new b$VM(28,"single",40)])},"_vertexDeclaration2",function(){return this._vertexDeclaration2=new b$fM(4,[new b$VM(0,"single",38)])}]),b$M}()),b$MM=function(){function b$A(b$M){this._vertexDeclaration=null,this._vertexDatas=null,this._indexDatas=null,this._vertexBuffer=null,this._indexBuffer=null,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=null,this._materials=null,this._materialToRenderElementsOffsets=null,this._merageElements=null,this._combineRenderElementPool=null,this._combineRenderElementPoolIndex=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._combineRenderElements=[],this._materialToRenderElementsOffsets=[],this._materials=[],this._merageElements=[],this._combineRenderElementPool=[],this._combineRenderElementPoolIndex=0,this._vertexDeclaration=b$M}b$P(b$A,"laya.d3.graphics.DynamicBatch");var b$M=b$A.prototype;return b$G.imps(b$M,{"laya.d3.core.render.IRenderable":!0}),b$M._getVertexBuffer=function(b$M){return void 0===b$M&&(b$M=0),0===b$M?this._vertexBuffer:null},b$M._getIndexBuffer=function(){return this._indexBuffer},b$M._getCombineRenderElementFromPool=function(b$M,b$y,b$i){var b$H=this._combineRenderElementPool[this._combineRenderElementPoolIndex++];return b$H||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=b$H=new b$r,b$H._sprite3D=new b$Ny),b$H._sprite3D._render._renderUpdate(b$i),b$H},b$M._getRenderElement=function(b$M,b$y,b$i){this._vertexDatas||(this._vertexDatas=new Float32Array(this._vertexDeclaration.vertexStride/4*b$A.maxVertexCount),this._indexDatas=new Uint16Array(b$A.maxIndexCount),this._vertexBuffer=b$uy.create(this._vertexDeclaration,b$A.maxVertexCount,35048),this._indexBuffer=b$ty.create("ushort",b$A.maxIndexCount,35048));for(var b$H=this._merageElements.length=0,b$S=0,b$f=0,b$V=this._combineRenderElements.length;b$f<b$V;b$f++){var b$K=this._combineRenderElements[b$f],b$k=b$K.getDynamicBatchBakedVertexs(0),b$X=b$K.getBakedIndices(),b$F=b$K._sprite3D.transform._isFrontFaceInvert,b$o=b$H/(this._vertexDeclaration.vertexStride/4),b$d=b$S,b$P=b$d+b$X.length;b$K._tempBatchIndexStart=b$d,b$K._tempBatchIndexEnd=b$P,this._indexDatas.set(b$X,b$S);var b$l=0;if(b$F)for(b$l=b$d;b$l<b$P;b$l+=3){this._indexDatas[b$l]=b$o+this._indexDatas[b$l];var b$J=this._indexDatas[b$l+1],b$h=this._indexDatas[b$l+2];this._indexDatas[b$l+1]=b$o+b$h,this._indexDatas[b$l+2]=b$o+b$J}else for(b$l=b$d;b$l<b$P;b$l+=3)this._indexDatas[b$l]=b$o+this._indexDatas[b$l],this._indexDatas[b$l+1]=b$o+this._indexDatas[b$l+1],this._indexDatas[b$l+2]=b$o+this._indexDatas[b$l+2];b$S+=b$X.length,this._vertexDatas.set(b$k,b$H),b$H+=b$k.length}for(this._vertexBuffer.setData(this._vertexDatas),this._indexBuffer.setData(this._indexDatas),b$f=this._combineRenderElementPoolIndex=0,b$V=this._materials.length;b$f<b$V;b$f++){var b$C=this._getCombineRenderElementFromPool(b$M,b$y,b$i);b$C._type=2,b$C._staticBatch=null;var b$v=(b$C.renderObj=this)._combineRenderElements[this._materialToRenderElementsOffsets[b$f]]._tempBatchIndexStart,b$R=b$f+1===this._materialToRenderElementsOffsets.length?b$S:this._combineRenderElements[this._materialToRenderElementsOffsets[b$f+1]]._tempBatchIndexStart;b$C._tempBatchIndexStart=b$v,b$C._tempBatchIndexEnd=b$R,b$C._material=this._materials[b$f],this._merageElements.push(b$C)}},b$M._addCombineRenderObjTest=function(b$M){var b$y=b$M.renderObj,b$i=this._currentCombineIndexCount+b$y._getIndexBuffer().indexCount,b$H=this._currentCombineVertexCount+b$y._getVertexBuffer().vertexCount;return!(b$A.maxVertexCount<b$H||b$A.maxIndexCount<b$i)},b$M._addCombineRenderObj=function(b$M){var b$y=b$M.renderObj;this._combineRenderElements.push(b$M),this._currentCombineIndexCount=this._currentCombineIndexCount+b$y._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+b$y._getVertexBuffer().vertexCount},b$M._addCombineMaterial=function(b$M){this._materials.push(b$M)},b$M._addMaterialToRenderElementOffset=function(b$M){this._materialToRenderElementsOffsets.push(b$M)},b$M._clearRenderElements=function(){this._combineRenderElements.length=0,this._materials.length=0,this._materialToRenderElementsOffsets.length=0,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0},b$M._addToRenderQueue=function(b$M,b$y,b$i,b$H){this._getRenderElement(b$y,b$i,b$H);for(var b$S=0,b$f=this._materials.length;b$S<b$f;b$S++)b$M.getRenderQueue(this._materials[b$S].renderQueue)._addDynamicBatchElement(this._merageElements[b$S])},b$M._beforeRender=function(b$M){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},b$M._render=function(b$M){var b$y=b$M._batchIndexEnd-b$M._batchIndexStart;b$T.mainContext.drawElements(4,b$y,5123,2*b$M._batchIndexStart),b$Q.drawCall++,b$Q.trianglesFaces+=b$y/3},b$M._getVertexBuffers=function(){return null},b$l(0,b$M,"_vertexBufferCount",function(){return 1}),b$l(0,b$M,"triangleCount",function(){return this._indexBuffer.indexCount/3}),b$l(0,b$M,"combineRenderElementsCount",function(){return this._combineRenderElements.length}),b$A.maxVertexCount=2e4,b$A.maxIndexCount=4e4,b$A.maxCombineTriangleCount=10,b$A}(),b$yM=function(){function b$A(){this._dynamicBatches=null,this._prepareDynamicBatchCombineElements=null,this._dynamicBatches={},this._prepareDynamicBatchCombineElements=[]}b$P(b$A,"laya.d3.graphics.DynamicBatchManager");var b$M=b$A.prototype;return b$M.getDynamicBatch=function(b$M,b$y){var b$i,b$H=b$M.id.toString()+b$y;return this._dynamicBatches[b$H]?b$i=this._dynamicBatches[b$H]:this._dynamicBatches[b$H]=b$i=new b$MM(b$M),b$i},b$M._garbageCollection=function(){for(var b$M in this._dynamicBatches)0===this._dynamicBatches[b$M].combineRenderElementsCount&&delete this._dynamicBatches[b$M]},b$M._addPrepareRenderElement=function(b$M){this._prepareDynamicBatchCombineElements.push(b$M)},b$M._finishCombineDynamicBatch=function(b$M){var b$y,b$i,b$H;this._prepareDynamicBatchCombineElements.sort(b$A._sortPrepareDynamicBatch);for(var b$S,b$f,b$V,b$K,b$k,b$X=-1,b$F=!0,b$o=0,b$d=-1,b$P=0,b$l=this._prepareDynamicBatchCombineElements.length;b$P<b$l;b$P++){var b$J=(b$f=this._prepareDynamicBatchCombineElements[b$P]).renderObj._getVertexBuffer(0).vertexDeclaration,b$h=b$i!==b$J;b$h&&(b$o=0,b$i=b$J);var b$C=b$o!==b$X;if(b$C&&(b$X=b$o),(b$h||b$C)&&(b$V=this.getDynamicBatch(b$J,b$o),b$y=null),b$F)if(b$V._addCombineRenderObjTest(b$f)){if(b$y!==(b$S=b$f._material))b$K&&(b$M.getRenderQueue(b$k._material.renderQueue)._addRenderElement(b$k),b$k=b$K=null,b$d=-1),b$K=b$S,b$d=b$V.combineRenderElementsCount,b$k=b$f,b$y=b$S;else if(b$K){var b$v=b$k.renderObj,b$R=b$f.renderObj;b$v._getVertexBuffer().vertexCount+b$R._getVertexBuffer().vertexCount>b$MM.maxVertexCount||b$v._getIndexBuffer().indexCount+b$R._getIndexBuffer().indexCount>b$MM.maxIndexCount?(b$M.getRenderQueue(b$k._material.renderQueue)._addRenderElement(b$k),b$K=b$S,b$d=b$V.combineRenderElementsCount,b$k=b$f):(b$V._addCombineMaterial(b$K),b$V._addMaterialToRenderElementOffset(b$d),b$V._addCombineRenderObj(b$k),b$k=b$K=null,b$d=-1,b$V._addCombineRenderObj(b$f))}else b$V._addCombineRenderObj(b$f);b$F=!0}else b$K&&(b$M.getRenderQueue(b$k._material.renderQueue)._addRenderElement(b$k),b$k=b$K=null,b$d=-1),b$o++,b$F=!1;else b$H=this._prepareDynamicBatchCombineElements[b$P-1],b$V._addMaterialToRenderElementOffset(b$V.combineRenderElementsCount),b$y=b$H._material,b$V._addCombineMaterial(b$y),b$V._addCombineRenderObj(b$H),b$F=!0,b$y!==(b$S=b$f._material)?(b$K=b$S,b$d=b$V.combineRenderElementsCount,b$k=b$f):b$V._addCombineRenderObj(b$f),b$y=b$S}b$K&&(b$M.getRenderQueue(b$k._material.renderQueue)._addRenderElement(b$k),b$k=b$K=null,b$d=-1),this._prepareDynamicBatchCombineElements.length=0},b$M._clearRenderElements=function(){for(var b$M in this._dynamicBatches)this._dynamicBatches[b$M]._clearRenderElements()},b$M._addToRenderQueue=function(b$M,b$y,b$i,b$H){for(var b$S in this._dynamicBatches){var b$f=this._dynamicBatches[b$S];0<b$f.combineRenderElementsCount&&b$f._addToRenderQueue(b$M,b$y,b$i,b$H)}},b$M.dispose=function(){this._dynamicBatches=null},b$A._sortPrepareDynamicBatch=function(b$M,b$y){return b$M._mainSortID-b$y._mainSortID},b$A}(),b$iM=function(){function b$M(){}return b$P(b$M,"laya.d3.graphics.FrustumCulling"),b$M.renderShadowObjectCulling=function(b$M,b$y,b$i,b$H,b$S){var b$f=0,b$V=0,b$K=0,b$k=0;for(b$f=0,b$K=b$i.length;b$f<b$K;b$f++){var b$X=b$i[b$f];b$X&&b$X._clearRenderElements()}var b$F,b$o,b$d,b$P=b$M._cullingRenders;if(1<b$S){for(b$f=0,b$K=b$M._cullingRendersLength;b$f<b$K;b$f++)if((b$F=b$P[b$f]).castShadow&&b$s.isVisible(b$F._owner.layer.mask)&&b$F.enable)for(var b$l=1,b$J=b$y.length;b$l<b$J;b$l++)if(b$o=b$i[b$l-1],0!==b$y[b$l].containsBoundSphere(b$F.boundingSphere))for(b$V=0,b$k=(b$d=b$F._renderElements).length;b$V<b$k;b$V++)b$o._addRenderElement(b$d[b$V])}else for(b$f=0,b$K=b$M._cullingRendersLength;b$f<b$K;b$f++)if((b$F=b$P[b$f]).castShadow&&b$s.isVisible(b$F._owner.layer.mask)&&b$F.enable&&0!==b$y[0].containsBoundSphere(b$F.boundingSphere))for(b$F._renderUpdate(b$H),b$o=b$i[0],b$V=0,b$k=(b$d=b$F._renderElements).length;b$V<b$k;b$V++)b$o._addRenderElement(b$d[b$V])},b$M.renderShadowObjectCullingOctree=function(b$M,b$y,b$i,b$H,b$S){for(var b$f=0,b$V=b$i.length;b$f<b$V;b$f++){var b$K=b$i[b$f];b$K&&b$K._clearRenderElements()}1<b$S?b$M.treeRoot.cullingShadowObjects(b$y,b$i,!0,0,b$M):b$M.treeRoot.cullingShadowObjectsOnePSSM(b$y[0],b$i,b$H,!0,0,b$M)},b$M.renderObjectCulling=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=0,b$K=0,b$k=0,b$X=0,b$F=b$y._quenes,b$o=b$y._dynamicBatchManager,b$d=b$y._cullingRenders;for(b$V=0,b$K=b$F.length;b$V<b$K;b$V++){var b$P=b$F[b$V];b$P&&b$P._clearRenderElements()}var b$l=b$HM._staticBatchManagers;for(b$V=0,b$K=b$l.length;b$V<b$K;b$V++)b$l[b$V]._clearRenderElements();b$o._clearRenderElements();var b$J=b$i.transform.position;for(b$V=0,b$K=b$y._cullingRendersLength;b$V<b$K;b$V++){var b$h=b$d[b$V];if(b$s.isVisible(b$h._owner.layer.mask)&&b$h.enable&&0!==b$M.containsBoundSphere(b$h.boundingSphere)&&b$h._renderUpdate(b$f)){b$h._distanceForSort=b$Vy.distance(b$h.boundingSphere.center,b$J)+b$h.sortingFudge;var b$C=b$h._renderElements;for(b$k=0,b$X=b$C.length;b$k<b$X;b$k++){var b$v=b$C[b$k],b$R=b$v._staticBatch;if(b$R&&b$R._material===b$v._material)b$R._addBatchRenderElement(b$v);else{var b$A=b$v.renderObj;b$A.triangleCount<10&&1===b$A._vertexBufferCount&&b$A._getIndexBuffer()&&b$v._material.renderQueue<2&&b$v._canDynamicBatch&&!b$h._owner.isStatic?b$o._addPrepareRenderElement(b$v):b$y.getRenderQueue(b$v._material.renderQueue)._addRenderElement(b$v)}}}}for(b$V=0,b$K=b$l.length;b$V<b$K;b$V++)b$l[b$V]._addToRenderQueue(b$y,b$H,b$S,b$f);b$o._finishCombineDynamicBatch(b$y),b$o._addToRenderQueue(b$y,b$H,b$S,b$f)},b$M.renderObjectCullingOctree=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=0,b$K=0,b$k=b$y._quenes,b$X=b$y._dynamicBatchManager;for(b$V=0,b$K=b$k.length;b$V<b$K;b$V++){var b$F=b$k[b$V];b$F&&b$F._clearRenderElements()}var b$o=b$HM._staticBatchManagers;for(b$V=0,b$K=b$o.length;b$V<b$K;b$V++)b$o[b$V]._clearRenderElements();for(b$X._clearRenderElements(),b$y._cullingRenders.length=0,b$y.treeRoot.cullingObjects(b$M,!0,0,b$i.transform.position,b$f),b$V=0,b$K=b$o.length;b$V<b$K;b$V++)b$o[b$V]._addToRenderQueue(b$y,b$H,b$S,b$f);b$X._finishCombineDynamicBatch(b$y),b$X._addToRenderQueue(b$y,b$H,b$S,b$f)},b$M.renderObjectCullingNoBoundFrustum=function(b$M,b$y,b$i,b$H,b$S){var b$f=0,b$V=0,b$K=0,b$k=0,b$X=b$M._quenes,b$F=b$M._dynamicBatchManager,b$o=b$M._cullingRenders;for(b$f=0,b$V=b$X.length;b$f<b$V;b$f++){var b$d=b$X[b$f];b$d&&b$d._clearRenderElements()}var b$P=b$HM._staticBatchManagers;for(b$f=0,b$V=b$P.length;b$f<b$V;b$f++)b$P[b$f]._clearRenderElements();b$F._clearRenderElements();var b$l=b$y.transform.position;for(b$f=0,b$V=b$M._cullingRendersLength;b$f<b$V;b$f++){var b$J=b$o[b$f];if(b$s.isVisible(b$J._owner.layer.mask)&&b$J.enable){b$J._renderUpdate(b$S),b$J._distanceForSort=b$Vy.distance(b$J.boundingSphere.center,b$l)+b$J.sortingFudge;var b$h=b$J._renderElements;for(b$K=0,b$k=b$h.length;b$K<b$k;b$K++){var b$C=b$h[b$K],b$v=b$C._staticBatch;if(b$v&&b$v._material===b$C._material)b$v._addBatchRenderElement(b$C);else{var b$R=b$C.renderObj;b$R.triangleCount<10&&1===b$R._vertexBufferCount&&b$R._getIndexBuffer()&&b$C._material.renderQueue<2&&b$C._canDynamicBatch&&!b$J._owner.isStatic?b$F._addPrepareRenderElement(b$C):b$M.getRenderQueue(b$C._material.renderQueue)._addRenderElement(b$C)}}}}for(b$f=0,b$V=b$P.length;b$f<b$V;b$f++)b$P[b$f]._addToRenderQueue(b$M,b$i,b$H,b$S);b$F._finishCombineDynamicBatch(b$M),b$F._addToRenderQueue(b$M,b$i,b$H,b$S)},b$M}(),b$HM=function(){function b$f(){this._initBatchRenderElements=null,this._staticBatches=null,this._initBatchRenderElements=[],this._staticBatches={}}b$P(b$f,"laya.d3.graphics.StaticBatchManager");var b$M=b$f.prototype;return b$M._finishInit=function(){for(var b$M in this._staticBatches)this._staticBatches[b$M]._finishInit();this._initBatchRenderElements.length=0},b$M._initStaticBatchs=function(b$M){throw new Error("StaticBatchManager:must override this function.")},b$M._addInitBatchSprite=function(b$M){for(var b$y=b$M._render._renderElements,b$i=0,b$H=b$y.length;b$i<b$H;b$i++)this._initBatchRenderElements.push(b$y[b$i])},b$M._clearRenderElements=function(){for(var b$M in this._staticBatches)this._staticBatches[b$M]._clearRenderElements()},b$M._garbageCollection=function(b$M){var b$y=b$M._staticBatch,b$i=b$y._initBatchRenderElements,b$H=b$i.indexOf(b$M);b$i.splice(b$H,1),0===b$i.length&&(b$y.dispose(),delete this._staticBatches[b$y._key])},b$M._addToRenderQueue=function(b$M,b$y,b$i,b$H){for(var b$S in this._staticBatches){var b$f=this._staticBatches[b$S];0<b$f._batchRenderElements.length&&b$f._updateToRenderQueue(b$M,b$H)}},b$M.dispose=function(){this._staticBatches=null},b$f._addToStaticBatchQueue=function(b$M){b$M instanceof laya.d3.core.RenderableSprite3D&&b$M._addToInitStaticBatchManager();for(var b$y=0,b$i=b$M.numChildren;b$y<b$i;b$y++)b$f._addToStaticBatchQueue(b$M._childs[b$y])},b$f.combine=function(b$M,b$y){var b$i,b$H=0,b$S=0;if(b$y)for(b$H=0,b$S=b$y.length;b$H<b$S;b$H++){b$y[b$H]._addToInitStaticBatchManager()}else b$M&&b$f._addToStaticBatchQueue(b$M);for(b$H=0,b$S=b$f._staticBatchManagers.length;b$H<b$S;b$H++)(b$i=b$f._staticBatchManagers[b$H])._initStaticBatchs(b$M),b$i._finishInit()},b$f._staticBatchManagers=[],b$f}(),b$SM=function(){function b$M(b$M,b$y,b$i){this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=null,this._initBatchRenderElements=null,this._batchRenderElements=null,this._material=null,this._rootOwner=null,this._key=null,this._manager=null,this._key=b$M,this._manager=b$y,this._combineRenderElementPoolIndex=0,this._combineRenderElementPool=[],this._initBatchRenderElements=[],this._batchRenderElements=[],this._rootOwner=b$i}b$P(b$M,"laya.d3.graphics.StaticBatch");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),b$y._binarySearch=function(b$M){for(var b$y=0,b$i=this._batchRenderElements.length-1,b$H=0;b$y<=b$i;)b$H=Math.floor((b$y+b$i)/2),this._compareBatchRenderElement(this._batchRenderElements[b$H],b$M)?b$i=b$H-1:b$y=b$H+1;return b$y},b$y._compareBatchRenderElement=function(b$M,b$y){throw new Error("StaticBatch:must override this function.")},b$y._getVertexDecLightMap=function(b$M){return b$M===b$tM.vertexDeclaration?b$sM.vertexDeclaration:b$M===b$qM.vertexDeclaration?b$eM.vertexDeclaration:b$M===b$WM.vertexDeclaration?b$AM.vertexDeclaration:b$M===b$ZM.vertexDeclaration?null:b$M===b$JM.vertexDeclaration?b$hM.vertexDeclaration:b$M===b$pM.vertexDeclaration?b$zM.vertexDeclaration:b$M===b$TM.vertexDeclaration?b$mM.vertexDeclaration:b$M===b$uM.vertexDeclaration?b$DM.vertexDeclaration:b$M===b$qM.vertexDeclaration?b$eM.vertexDeclaration:b$M===b$cM.vertexDeclaration?b$GM.vertexDeclaration:b$M===b$ZM.vertexDeclaration?null:b$M===b$JM.vertexDeclaration?b$hM.vertexDeclaration:b$M===b$BM.vertexDeclaration?b$wM.vertexDeclaration:b$M===b$TM.vertexDeclaration?b$mM.vertexDeclaration:b$M},b$y._getCombineRenderElementFromPool=function(){throw new Error("StaticBatch:must override this function.")},b$y._addBatchRenderElement=function(b$M){this._batchRenderElements.splice(this._binarySearch(b$M),0,b$M)},b$y._updateToRenderQueue=function(b$M,b$y){this._combineRenderElementPoolIndex=0,this._getRenderElement(b$M.getRenderQueue(this._material.renderQueue)._renderElements,b$M,b$y)},b$y._getRenderElement=function(b$M,b$y,b$i){throw new Error("StaticBatch:must override this function.")},b$y._finishInit=function(){throw new Error("StaticBatch:must override this function.")},b$y._clearRenderElements=function(){this._batchRenderElements.length=0},b$y.dispose=function(){},b$y._getVertexBuffer=function(b$M){return void 0===b$M&&(b$M=0),null},b$y._getIndexBuffer=function(){return null},b$y._beforeRender=function(b$M){return!0},b$y._render=function(b$M){},b$y._getVertexBuffers=function(){return null},b$l(0,b$y,"_vertexBufferCount",function(){return 1}),b$l(0,b$y,"triangleCount",function(){return 0}),b$M.combine=function(b$M){console.log("StaticBatch: discard property,please use StaticBatchManager.combine() function instead."),b$HM.combine(b$M)},b$M.maxBatchVertexCount=65535,b$M}(),b$fM=function(){function b$V(b$M,b$y){if(this._id=0,this._shaderValues=null,this._shaderDefineValue=0,this._vertexStride=0,this._vertexElements=null,this._vertexElementsDic=null,this._id=++b$V._uniqueIDCounter,this._id>b$V.maxVertexDeclaration)throw new Error("VertexDeclaration: VertexDeclaration count should not large than ",b$V.maxVertexDeclaration);this._shaderValues=new b$dy,this._vertexElementsDic={},this._vertexStride=b$M,this._vertexElements=b$y;for(var b$i=0;b$i<b$y.length;b$i++){var b$H=b$y[b$i],b$S=b$H.elementUsage;this._vertexElementsDic[b$S]=b$H;var b$f=[b$V._getTypeSize(b$H.elementFormat)/4,5126,!1,this._vertexStride,b$H.offset];switch(this._shaderValues.setValue(b$S,b$f),b$S){case 1:this._addShaderDefine(b$Qy.SHADERDEFINE_COLOR);break;case 2:this._addShaderDefine(b$Qy.SHADERDEFINE_UV0);break;case 15:this._addShaderDefine(b$Qy.SHADERDEFINE_UV1)}}}b$P(b$V,"laya.d3.graphics.VertexDeclaration");var b$M=b$V.prototype;return b$M._addShaderDefine=function(b$M){this._shaderDefineValue|=b$M},b$M._removeShaderDefine=function(b$M){this._shaderDefineValue&=~b$M},b$M.getVertexElements=function(){return this._vertexElements.slice()},b$M.getVertexElementByUsage=function(b$M){return this._vertexElementsDic[b$M]},b$M.unBinding=function(){},b$l(0,b$M,"shaderDefineValue",function(){return this._shaderDefineValue}),b$l(0,b$M,"id",function(){return this._id}),b$l(0,b$M,"vertexStride",function(){return this._vertexStride}),b$l(0,b$M,"shaderValues",function(){return this._shaderValues}),b$V._getTypeSize=function(b$M){switch(b$M){case"single":return 4;case"vector2":return 8;case"vector3":return 12;case"vector4":return 16;case"color":case"byte4":case"short2":return 4;case"short4":return 8;case"normalizedshort2":return 4;case"normalizedshort4":return 8;case"halfvector2":return 4;case"halfvector4":return 8}return 0},b$V.getVertexStride=function(b$M){for(var b$y=0,b$i=0;b$i<b$M.Length;b$i++){var b$H=b$M[b$i],b$S=b$H.offset+b$V._getTypeSize(b$H.elementFormat);b$y<b$S&&(b$y=b$S)}return b$y},b$V._maxVertexDeclarationBit=1e3,b$V._uniqueIDCounter=1,b$o(b$V,["maxVertexDeclaration",function(){return this.maxVertexDeclaration=2147483647-1e3*Math.floor(2147483.647)}]),b$V}(),b$VM=function(){function b$M(b$M,b$y,b$i){this.offset=0,this.elementFormat=null,this.elementUsage=0,this.offset=b$M,this.elementFormat=b$y,this.elementUsage=b$i}return b$P(b$M,"laya.d3.graphics.VertexElement"),b$M}(),b$KM=(function(){function b$M(){}b$P(b$M,"laya.d3.graphics.VertexElementFormat"),b$M.Single="single",b$M.Vector2="vector2",b$M.Vector3="vector3",b$M.Vector4="vector4",b$M.Color="color",b$M.Byte4="byte4",b$M.Short2="short2",b$M.Short4="short4",b$M.NormalizedShort2="normalizedshort2",b$M.NormalizedShort4="normalizedshort4",b$M.HalfVector2="halfvector2",b$M.HalfVector4="halfvector4"}(),function(){function b$M(){}b$P(b$M,"laya.d3.graphics.VertexElementUsage"),b$M.POSITION0=0,b$M.COLOR0=1,b$M.TEXTURECOORDINATE0=2,b$M.NORMAL0=3,b$M.BINORMAL0=4,b$M.TANGENT0=5,b$M.BLENDINDICES0=6,b$M.BLENDWEIGHT0=7,b$M.DEPTH0=8,b$M.FOG0=9,b$M.POINTSIZE0=10,b$M.SAMPLE0=11,b$M.TESSELLATEFACTOR0=12,b$M.COLOR1=13,b$M.NEXTTEXTURECOORDINATE0=14,b$M.TEXTURECOORDINATE1=15,b$M.NEXTTEXTURECOORDINATE1=16,b$M.CORNERTEXTURECOORDINATE0=17,b$M.VELOCITY0=18,b$M.STARTCOLOR0=19,b$M.STARTSIZE=20,b$M.AGEADDSCALE0=21,b$M.STARTROTATION=22,b$M.ENDCOLOR0=23,b$M.STARTLIFETIME=24,b$M.TIME0=33,b$M.SHAPEPOSITIONSTARTLIFETIME=30,b$M.DIRECTIONTIME=32,b$M.SIZEROTATION0=27,b$M.RADIUS0=28,b$M.RADIAN0=29,b$M.STARTSPEED=31,b$M.RANDOM0=34,b$M.RANDOM1=35,b$M.SIMULATIONWORLDPOSTION=36,b$M.SIMULATIONWORLDROTATION=37,b$M.TEXTURECOORDINATE0X=38,b$M.TEXTURECOORDINATE0X1=39,b$M.TEXTURECOORDINATE0Y=40,b$M.OFFSETVECTOR=41}(),function(){function b$M(b$M,b$y,b$i){this._position=null,this._textureCoordinate0=null,this._time=NaN,this._position=b$M,this._textureCoordinate0=b$y,this._time=b$i}b$P(b$M,"laya.d3.graphics.VertexGlitter");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate0}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"time",function(){return this._time}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(24,[new b$VM(0,"vector3",0),new b$VM(12,"vector2",2),new b$VM(20,"single",33)])}])}(),function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){this._cornerTextureCoordinate=null,this._position=null,this._velocity=null,this._startColor=null,this._endColor=null,this._sizeRotation=null,this._radius=null,this._radian=null,this._ageAddScale=NaN,this._time=NaN,this._cornerTextureCoordinate=b$M,this._position=b$y,this._velocity=b$i,this._startColor=b$H,this._endColor=b$S,this._sizeRotation=b$f,this._radius=b$V,this._radian=b$K,this._ageAddScale=b$k,this._time=b$X}b$P(b$M,"laya.d3.graphics.VertexParticle");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"endColor",function(){return this._endColor}),b$l(0,b$y,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),b$l(0,b$y,"sizeRotation",function(){return this._sizeRotation}),b$l(0,b$y,"velocity",function(){return this._velocity}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"startColor",function(){return this._startColor}),b$l(0,b$y,"radius",function(){return this._radius}),b$l(0,b$y,"radian",function(){return this._radian}),b$l(0,b$y,"ageAddScale",function(){return this._ageAddScale}),b$l(0,b$y,"time",function(){return this._time}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(116,[new b$VM(0,"vector4",17),new b$VM(16,"vector3",0),new b$VM(28,"vector3",18),new b$VM(40,"vector4",19),new b$VM(56,"vector4",23),new b$VM(72,"vector3",27),new b$VM(84,"vector2",28),new b$VM(92,"vector4",29),new b$VM(108,"single",24),new b$VM(112,"single",33)])}])}(),function(){function b$M(b$M){this._position=null,this._position=b$M}b$P(b$M,"laya.d3.graphics.VertexPosition");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(12,[new b$VM(0,"vector3",0)])}]),b$M}()),b$kM=function(){function b$M(b$M,b$y){this._position=null,this._normal=null,this._position=b$M,this._normal=b$y}b$P(b$M,"laya.d3.graphics.VertexPositionNormal");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(24,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3)])}]),b$M}(),b$XM=function(){function b$M(b$M,b$y,b$i){this._position=null,this._normal=null,this._color=null,this._position=b$M,this._normal=b$y,this._color=b$i}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColor");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(40,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1)])}]),b$M}(),b$FM=function(){function b$M(b$M,b$y,b$i,b$H,b$S){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._blendIndex=b$H,this._blendWeight=b$S}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorSkin");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(72,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector4",7),new b$VM(56,"vector4",6)])}]),b$M}(),b$oM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._tangent=b$H,this._blendIndex=b$S,this._blendWeight=b$f}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorSkinSTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(88,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector4",7),new b$VM(56,"vector4",6),new b$VM(72,"vector4",5)])}]),b$M}(),b$dM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f){this._position=null,this._normal=null,this._color=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._tangent=b$H,this._blendIndex=b$S,this._blendWeight=b$f}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorSkinTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(84,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector4",7),new b$VM(56,"vector4",6),new b$VM(72,"vector3",5)])}]),b$M}(),b$PM=function(){function b$M(b$M,b$y,b$i,b$H){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._tangent=b$H}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorSTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(56,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector4",5)])}]),b$M}(),b$lM=function(){function b$M(b$M,b$y,b$i,b$H){this._position=null,this._normal=null,this._color=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._tangent=b$H}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(52,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector3",5)])}]),b$M}(),b$JM=function(){function b$M(b$M,b$y,b$i,b$H){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._textureCoordinate=b$H}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorTexture");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(48,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector2",2)])}]),b$M}(),b$hM=function(){function b$M(b$M,b$y,b$i,b$H,b$S){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._textureCoordinate0=b$H,this._textureCoordinate1=b$S}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(0,b$y,"textureCoordinate1",function(){return this._textureCoordinate1}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(56,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector2",2),new b$VM(48,"vector2",15)])}]),b$M}(),b$CM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._textureCoordinate0=b$H,this._textureCoordinate1=b$S,this._blendIndex=b$f,this._blendWeight=b$V}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Skin");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(0,b$y,"textureCoordinate1",function(){return this._textureCoordinate1}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(88,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector2",2),new b$VM(48,"vector2",15),new b$VM(56,"vector4",7),new b$VM(72,"vector4",6)])}]),b$M}(),b$vM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._textureCoordinate0=b$H,this._textureCoordinate1=b$S,this._tangent=b$f,this._blendIndex=b$V,this._blendWeight=b$K}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinSTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(0,b$y,"textureCoordinate1",function(){return this._textureCoordinate1}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(104,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector2",2),new b$VM(48,"vector2",15),new b$VM(56,"vector4",7),new b$VM(72,"vector4",6),new b$VM(88,"vector4",5)])}]),b$M}(),b$RM=function(){function b$M(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1SkinTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$y.VertexPositionNormalColorTexture0SkinTangent=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){this._position=b$M,this._normal=b$y,this._color=b$i,this._textureCoordinate0=b$H,this._textureCoordinate1=b$S,this._tangent=b$f,this._blendIndex=b$V,this._blendWeight=b$K},b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(0,b$y,"textureCoordinate1",function(){return this._textureCoordinate1}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(100,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector2",2),new b$VM(48,"vector2",15),new b$VM(56,"vector4",7),new b$VM(72,"vector4",6),new b$VM(88,"vector3",5)])}]),b$M}(),b$AM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._textureCoordinate0=b$H,this._textureCoordinate1=b$S,this._tangent=b$f}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1STangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(0,b$y,"textureCoordinate1",function(){return this._textureCoordinate1}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(72,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector2",2),new b$VM(48,"vector2",15),new b$VM(56,"vector4",5)])}]),b$M}(),b$GM=function(){function b$M(){this._position=null,this._normal=null,this._color=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorTexture0Texture1Tangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$y.VertexPositionNormalColorTexture0Tangent=function(b$M,b$y,b$i,b$H,b$S,b$f){this._position=b$M,this._normal=b$y,this._color=b$i,this._textureCoordinate0=b$H,this._textureCoordinate1=b$S,this._tangent=b$f},b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(0,b$y,"textureCoordinate1",function(){return this._textureCoordinate1}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(68,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector2",2),new b$VM(48,"vector2",15),new b$VM(56,"vector3",5)])}]),b$M}(),b$IM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._textureCoordinate=b$H,this._blendIndex=b$S,this._blendWeight=b$f}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorTextureSkin");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(80,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector2",2),new b$VM(48,"vector4",7),new b$VM(64,"vector4",6)])}]),b$M}(),b$UM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._textureCoordinate=b$H,this._tangent=b$S,this._blendIndex=b$f,this._blendWeight=b$V}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorTextureSkinSTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(96,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector2",2),new b$VM(48,"vector4",7),new b$VM(64,"vector4",6),new b$VM(80,"vector4",5)])}]),b$M}(),b$QM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._textureCoordinate=b$H,this._tangent=b$S,this._blendIndex=b$f,this._blendWeight=b$V}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorTextureSkinTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(92,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector2",2),new b$VM(48,"vector4",7),new b$VM(64,"vector4",6),new b$VM(80,"vector3",5)])}]),b$M}(),b$WM=function(){function b$M(b$M,b$y,b$i,b$H,b$S){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._textureCoordinate=b$H,this._tangent=b$S}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorTextureSTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(64,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector2",2),new b$VM(48,"vector4",5)])}]),b$M}(),b$cM=function(){function b$M(b$M,b$y,b$i,b$H,b$S){this._position=null,this._normal=null,this._color=null,this._textureCoordinate=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._color=b$i,this._textureCoordinate=b$H,this._tangent=b$S}b$P(b$M,"laya.d3.graphics.VertexPositionNormalColorTextureTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"color",function(){return this._color}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(60,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",1),new b$VM(40,"vector2",2),new b$VM(48,"vector3",5)])}]),b$M}(),b$nM=function(){function b$M(b$M,b$y,b$i){this._position=null,this._normal=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._tangent=b$i}b$P(b$M,"laya.d3.graphics.VertexPositionNormalSTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(40,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector4",5)])}]),b$M}(),b$aM=function(){function b$M(b$M,b$y,b$i){this._position=null,this._normal=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._tangent=b$i}b$P(b$M,"laya.d3.graphics.VertexPositionNormalTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(36,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector3",5)])}]),b$M}(),b$TM=function(){function b$M(b$M,b$y,b$i){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=b$M,this._normal=b$y,this._textureCoordinate=b$i}b$P(b$M,"laya.d3.graphics.VertexPositionNormalTexture");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(32,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector2",2)])}]),b$M}(),b$mM=function(){function b$M(b$M,b$y,b$i,b$H){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._position=b$M,this._normal=b$y,this._textureCoordinate0=b$i,this._textureCoordinate1=b$H}b$P(b$M,"laya.d3.graphics.VertexPositionNormalTexture0Texture1");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(0,b$y,"textureCoordinate1",function(){return this._textureCoordinate1}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(40,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector2",2),new b$VM(32,"vector2",15)])}]),b$M}(),b$eM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._position=b$M,this._normal=b$y,this._textureCoordinate0=b$i,this._textureCoordinate1=b$H,this._blendIndex=b$S,this._blendWeight=b$f}b$P(b$M,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Skin");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(0,b$y,"textureCoordinate1",function(){return this._textureCoordinate1}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(72,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector2",2),new b$VM(32,"vector2",15),new b$VM(40,"vector4",7),new b$VM(56,"vector4",6)])}]),b$M}(),b$sM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._textureCoordinate0=b$i,this._textureCoordinate1=b$H,this._tangent=b$S,this._blendIndex=b$f,this._blendWeight=b$V}b$P(b$M,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinSTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(0,b$y,"textureCoordinate1",function(){return this._textureCoordinate1}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(88,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector2",2),new b$VM(32,"vector2",15),new b$VM(40,"vector4",7),new b$VM(56,"vector4",6),new b$VM(72,"vector4",5)])}]),b$M}(),b$DM=function(){function b$M(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null}b$P(b$M,"laya.d3.graphics.VertexPositionNormalTexture0Texture1SkinTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$y.VertexPositionNormalTexture0SkinTangent=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){this._position=b$M,this._normal=b$y,this._textureCoordinate0=b$i,this._textureCoordinate1=b$H,this._tangent=b$S,this._blendIndex=b$f,this._blendWeight=b$V},b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(0,b$y,"textureCoordinate1",function(){return this._textureCoordinate1}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(84,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector2",2),new b$VM(32,"vector2",15),new b$VM(40,"vector4",7),new b$VM(56,"vector4",6),new b$VM(72,"vector3",5)])}]),b$M}(),b$zM=function(){function b$M(b$M,b$y,b$i,b$H,b$S){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._textureCoordinate0=b$i,this._textureCoordinate1=b$H,this._tangent=b$S}b$P(b$M,"laya.d3.graphics.VertexPositionNormalTexture0Texture1STangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(0,b$y,"textureCoordinate1",function(){return this._textureCoordinate1}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(56,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector2",2),new b$VM(32,"vector2",15),new b$VM(40,"vector4",5)])}]),b$M}(),b$wM=function(){function b$M(){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._tangent=null}b$P(b$M,"laya.d3.graphics.VertexPositionNormalTexture0Texture1Tangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$y.VertexPositionNormalTexture0Tangent=function(b$M,b$y,b$i,b$H,b$S){this._position=b$M,this._normal=b$y,this._textureCoordinate0=b$i,this._textureCoordinate1=b$H,this._tangent=b$S},b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(0,b$y,"textureCoordinate1",function(){return this._textureCoordinate1}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(52,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector2",2),new b$VM(32,"vector2",15),new b$VM(40,"vector3",5)])}]),b$M}(),b$qM=function(){function b$M(b$M,b$y,b$i,b$H,b$S){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._position=b$M,this._normal=b$y,this._textureCoordinate=b$i,this._blendIndex=b$H,this._blendWeight=b$S}b$P(b$M,"laya.d3.graphics.VertexPositionNormalTextureSkin");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(64,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector2",2),new b$VM(32,"vector4",7),new b$VM(48,"vector4",6)])}]),b$M}(),b$tM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._textureCoordinate=b$i,this._tangent=b$H,this._blendIndex=b$S,this._blendWeight=b$f}b$P(b$M,"laya.d3.graphics.VertexPositionNormalTextureSkinSTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(80,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector2",2),new b$VM(32,"vector4",7),new b$VM(48,"vector4",6),new b$VM(64,"vector4",5)])}]),b$M}(),b$uM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f){this._position=null,this._normal=null,this._textureCoordinate=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._textureCoordinate=b$i,this._tangent=b$H,this._blendIndex=b$S,this._blendWeight=b$f}b$P(b$M,"laya.d3.graphics.VertexPositionNormalTextureSkinTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(76,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector2",2),new b$VM(32,"vector4",7),new b$VM(48,"vector4",6),new b$VM(64,"vector3",5)])}]),b$M}(),b$pM=function(){function b$M(b$M,b$y,b$i,b$H){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._textureCoordinate=b$i,this._tangent=b$H}b$P(b$M,"laya.d3.graphics.VertexPositionNormalTextureSTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(48,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector2",2),new b$VM(32,"vector4",5)])}]),b$M}(),b$BM=function(){function b$M(b$M,b$y,b$i,b$H){this._position=null,this._normal=null,this._textureCoordinate=null,this._tangent=null,this._position=b$M,this._normal=b$y,this._textureCoordinate=b$i,this._tangent=b$H}b$P(b$M,"laya.d3.graphics.VertexPositionNormalTextureTangent");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(44,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector2",2),new b$VM(32,"vector3",5)])}]),b$M}(),b$ZM=function(){function b$M(b$M,b$y,b$i){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=b$M,this._normal=b$y,this._textureCoordinate=b$i}b$P(b$M,"laya.d3.graphics.VertexPositionNTBTexture");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(56,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector3",5),new b$VM(36,"vector3",4),new b$VM(48,"vector2",2)])}]),b$M}(),b$EM=function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){this._position=null,this._normal=null,this._textureCoordinate0=null,this._textureCoordinate1=null,this._blendIndex=null,this._blendWeight=null,this._tangent=null,this.binormal=null,this._position=b$M,this._normal=b$y,this._textureCoordinate0=b$H,this._textureCoordinate1=b$S,this._tangent=b$f,b$i=b$i,this._blendIndex=b$V,this._blendWeight=b$K}b$P(b$M,"laya.d3.graphics.VertexPositionNTBTexture0Texture1Skin");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"tangent",function(){return this._tangent}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(0,b$y,"textureCoordinate1",function(){return this._textureCoordinate1}),b$l(0,b$y,"blendIndex",function(){return this._blendIndex}),b$l(0,b$y,"blendWeight",function(){return this._blendWeight}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(96,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector3",5),new b$VM(36,"vector3",4),new b$VM(48,"vector2",2),new b$VM(56,"vector2",15),new b$VM(64,"vector4",7),new b$VM(80,"vector4",6)])}]),b$M}(),b$_M=function(){function b$M(b$M,b$y,b$i){this._position=null,this._normal=null,this._textureCoordinate=null,this._position=b$M,this._normal=b$y,this._textureCoordinate=b$i}b$P(b$M,"laya.d3.graphics.VertexPositionNTBTextureSkin");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"textureCoordinate",function(){return this._textureCoordinate}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(88,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector3",5),new b$VM(36,"vector3",4),new b$VM(48,"vector2",2),new b$VM(56,"vector4",7),new b$VM(72,"vector4",6)])}]),b$M}(),b$bM=(function(){function b$M(b$M,b$y,b$i,b$H){this._position=null,this._normal=null,this._textureCoord0=null,this._textureCoord1=null,this._position=b$M,this._normal=b$y,this._textureCoord0=b$i,this._textureCoord1=b$H}b$P(b$M,"laya.d3.graphics.VertexPositionTerrain");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"normal",function(){return this._normal}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"textureCoord0",function(){return this._textureCoord0}),b$l(0,b$y,"textureCoord1",function(){return this._textureCoord1}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(40,[new b$VM(0,"vector3",0),new b$VM(12,"vector3",3),new b$VM(24,"vector2",2),new b$VM(32,"vector2",15)])}])}(),function(){function b$M(b$M,b$y){this._position=null,this._textureCoordinate0=null,this._position=b$M,this._textureCoordinate0=b$y}b$P(b$M,"laya.d3.graphics.VertexPositionTexture0");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"position",function(){return this._position}),b$l(0,b$y,"textureCoordinate0",function(){return this._textureCoordinate0}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(20,[new b$VM(0,"vector3",0),new b$VM(12,"vector2",2)])}]),b$M}()),b$YM=(function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F,b$o,b$d,b$P){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=b$M,this._positionStartLifeTime=b$y,this._velocity=b$i,this._startColor=b$H,this._startSize=b$S,this._startRotation0=b$f,this._startRotation1=b$V,this._startRotation2=b$K,this._startLifeTime=b$k,this._time=b$X,this._startSpeed=b$F,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=b$P}b$P(b$M,"laya.d3.graphics.VertexShurikenParticleBillboard");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),b$l(0,b$y,"random1",function(){return this._randoms1}),b$l(0,b$y,"startRotation2",function(){return this._startRotation2}),b$l(0,b$y,"positionStartLifeTime",function(){return this._positionStartLifeTime}),b$l(0,b$y,"velocity",function(){return this._velocity}),b$l(0,b$y,"random0",function(){return this._randoms0}),b$l(0,b$y,"startSize",function(){return this._startSize}),b$l(0,b$y,"startColor",function(){return this._startColor}),b$l(0,b$y,"startRotation0",function(){return this._startRotation0}),b$l(0,b$y,"startRotation1",function(){return this._startRotation1}),b$l(0,b$y,"startLifeTime",function(){return this._startLifeTime}),b$l(0,b$y,"time",function(){return this._time}),b$l(0,b$y,"startSpeed",function(){return this._startSpeed}),b$l(0,b$y,"simulationWorldPostion",function(){return this._simulationWorldPostion}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(152,[new b$VM(0,"vector4",17),new b$VM(16,"vector4",30),new b$VM(32,"vector4",32),new b$VM(48,"vector4",19),new b$VM(64,"vector3",20),new b$VM(76,"vector3",22),new b$VM(88,"single",31),new b$VM(92,"vector4",34),new b$VM(108,"vector4",35),new b$VM(124,"vector3",36),new b$VM(136,"vector4",37)])}])}(),function(){function b$M(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F,b$o,b$d,b$P){this._cornerTextureCoordinate=null,this._positionStartLifeTime=null,this._velocity=null,this._startColor=null,this._startSize=null,this._startRotation0=null,this._startRotation1=null,this._startRotation2=null,this._startLifeTime=NaN,this._time=NaN,this._startSpeed=NaN,this._randoms0=null,this._randoms1=null,this._simulationWorldPostion=null,this._cornerTextureCoordinate=b$M,this._positionStartLifeTime=b$y,this._velocity=b$i,this._startColor=b$H,this._startSize=b$S,this._startRotation0=b$f,this._startRotation1=b$V,this._startRotation2=b$K,this._startLifeTime=b$k,this._time=b$X,this._startSpeed=b$F,this._randoms0=this.random0,this._randoms1=this.random1,this._simulationWorldPostion=b$P}b$P(b$M,"laya.d3.graphics.VertexShurikenParticleMesh");var b$y=b$M.prototype;b$G.imps(b$y,{"laya.d3.graphics.IVertex":!0}),b$l(0,b$y,"cornerTextureCoordinate",function(){return this._cornerTextureCoordinate}),b$l(0,b$y,"velocity",function(){return this._velocity}),b$l(0,b$y,"position",function(){return this._positionStartLifeTime}),b$l(0,b$y,"random0",function(){return this._randoms0}),b$l(0,b$y,"startSize",function(){return this._startSize}),b$l(0,b$y,"startColor",function(){return this._startColor}),b$l(0,b$y,"startRotation0",function(){return this._startRotation0}),b$l(0,b$y,"startRotation1",function(){return this._startRotation1}),b$l(0,b$y,"random1",function(){return this._randoms1}),b$l(0,b$y,"startRotation2",function(){return this._startRotation2}),b$l(0,b$y,"startLifeTime",function(){return this._startLifeTime}),b$l(0,b$y,"time",function(){return this._time}),b$l(0,b$y,"startSpeed",function(){return this._startSpeed}),b$l(0,b$y,"simulationWorldPostion",function(){return this._simulationWorldPostion}),b$l(0,b$y,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$l(1,b$M,"vertexDeclaration",function(){return b$M._vertexDeclaration}),b$o(b$M,["_vertexDeclaration",function(){return this._vertexDeclaration=new b$fM(172,[new b$VM(0,"vector3",0),new b$VM(12,"vector4",1),new b$VM(28,"vector2",2),new b$VM(36,"vector4",30),new b$VM(52,"vector4",32),new b$VM(68,"vector4",19),new b$VM(84,"vector3",20),new b$VM(96,"vector3",22),new b$VM(108,"single",31),new b$VM(112,"vector4",34),new b$VM(128,"vector4",35),new b$VM(144,"vector3",36),new b$VM(156,"vector4",37)])}])}(),function(){function b$R(b$M,b$y,b$i,b$H,b$S,b$f){this._version=null,this._strings=["BLOCK","DATA","STRINGS"],this._materials=null,this._subMeshes=null,this._materialMap=null,this._readData=null,this._mesh=null,this._BLOCK={count:0},this._DATA={offset:0,size:0},this._STRINGS={offset:0,size:0},this._shaderAttributes=null,this._mesh=b$i,this._materials=b$H,this._subMeshes=b$S,this._materialMap=b$f,this._version=b$y,this._onLoaded(b$M)}b$P(b$R,"laya.d3.loaders.LoadModelV01");var b$M=b$R.prototype;return b$M._onLoaded=function(b$M){this._readData=b$M,this.READ_BLOCK();for(var b$y=0;b$y<this._BLOCK.count;b$y++){var b$i=this._readData.getUint16(),b$H=this._strings[b$i],b$S=this["READ_"+b$H];if(null==b$S)throw new Error("model file err,no this function:"+b$i+" "+b$H);if(!b$S.call(this))break}return this._mesh},b$M.onError=function(){},b$M._readString=function(){return this._strings[this._readData.getUint16()]},b$M.READ_BLOCK=function(){this._readData.getUint16();return this._BLOCK.count=this._readData.getUint16(),!0},b$M.READ_DATA=function(){return this._DATA.offset=this._readData.getUint32(),this._DATA.size=this._readData.getUint32(),!0},b$M.READ_STRINGS=function(){this._STRINGS.offset=this._readData.getUint16(),this._STRINGS.size=this._readData.getUint16();var b$M=this._readData.pos;this._readData.pos=this._STRINGS.offset+this._DATA.offset;for(var b$y=0;b$y<this._STRINGS.size;b$y++)this._strings[b$y]=this._readData.readUTFString();return this._readData.pos=b$M,!0},b$M.READ_MATERIAL=function(){var b$M=this._readData.getUint16(),b$y=(this._readString(),this._readString());return this._materials[b$M]="null"!==b$y?b$C.getRes(this._materialMap[b$y]):new b$ay,!0},b$M.READ_MESH=function(){this._readString();switch(this._version){case"LAYAMODEL:01":console.log("Warning: The (.lm) file is converted by old fbxTools,please reConverted it use  lastest fbxTools version,later we will remove the  support of old version (.lm) support.");break;case"LAYASKINANI:01":case"LAYAMODEL:02":var b$M,b$y=this._readData.__getBuffer(),b$i=0,b$H=this._readData.getUint32(),b$S=this._readData.getUint32(),b$f=(new Float32Array(b$y.slice(b$H+this._DATA.offset,b$H+this._DATA.offset+b$S)),this._readData.getUint32()),b$V=this._readData.getUint32(),b$K=new Float32Array(b$y.slice(b$f+this._DATA.offset,b$f+this._DATA.offset+b$V));for(this.mesh._inverseBindPoses=[],b$i=0,b$M=b$K.length;b$i<b$M;b$i+=16){var b$k=new b$My(b$K[b$i+0],b$K[b$i+1],b$K[b$i+2],b$K[b$i+3],b$K[b$i+4],b$K[b$i+5],b$K[b$i+6],b$K[b$i+7],b$K[b$i+8],b$K[b$i+9],b$K[b$i+10],b$K[b$i+11],b$K[b$i+12],b$K[b$i+13],b$K[b$i+14],b$K[b$i+15]);this.mesh._inverseBindPoses.push(b$k)}break;default:throw new Error("LoadModel:unknown version.")}return!0},b$M.READ_SUBMESH=function(){this._readString(),this._readData.getUint8();var b$M=this._readString();this._shaderAttributes=b$M.match(b$R._attrReg);var b$y=this._readData.getUint32(),b$i=this._readData.getUint32(),b$H=(this._readData.getUint32(),this._readData.getUint32(),this._readData.getUint32()),b$S=this._readData.getUint32(),b$f=this._readData.getUint32(),b$V=this._readData.getUint32(),b$K=this._readData.__getBuffer(),b$k=new b$Xy(this._mesh),b$X=this._getVertexDeclaration(),b$F=b$uy.create(b$X,b$S/b$X.vertexStride,35044,!0),b$o=b$H+this._DATA.offset,b$d=b$K.slice(b$o,b$o+b$S);b$F.setData(new Float32Array(b$d));for(var b$P=(b$k._vertexBuffer=b$F).vertexDeclaration.getVertexElements(),b$l=0;b$l<b$P.length;b$l++)b$k._bufferUsage[b$P[b$l].elementUsage]=b$F;var b$J=b$ty.create("ushort",b$i/2,35044,!0),b$h=b$y+this._DATA.offset,b$C=b$K.slice(b$h,b$h+b$i);b$J.setData(new Uint16Array(b$C)),b$k._indexBuffer=b$J;var b$v=b$K.slice(b$f+this._DATA.offset,b$f+this._DATA.offset+b$V);return b$k._boneIndicesList[0]=new Uint8Array(b$v),this._subMeshes.push(b$k),!0},b$M.READ_DATAAREA=function(){return!1},b$M._getVertexDeclaration=function(){for(var b$M,b$y=!1,b$i=!1,b$H=!1,b$S=!1,b$f=!1,b$V=!1,b$K=!1,b$k=!1,b$X=!1,b$F=0;b$F<this._shaderAttributes.length;b$F+=8)switch(this._shaderAttributes[b$F]){case"POSITION":b$y=!0;break;case"NORMAL":b$i=!0;break;case"COLOR":b$H=!0;break;case"UV":b$S=!0;break;case"UV1":b$f=!0;break;case"BLENDWEIGHT":b$K=!0;break;case"BLENDINDICES":b$k=!0;break;case"TANGENT":b$V=!0;break;case"BINORMAL":b$X=!0}return b$y&&b$i&&b$H&&b$S&&b$f&&b$K&&b$k&&b$V?b$M=b$RM.vertexDeclaration:b$y&&b$i&&b$H&&b$S&&b$f&&b$K&&b$k?b$M=b$CM.vertexDeclaration:b$y&&b$i&&b$S&&b$f&&b$K&&b$k&&b$V?b$M=b$DM.vertexDeclaration:b$y&&b$i&&b$S&&b$f&&b$K&&b$k?b$M=b$eM.vertexDeclaration:b$y&&b$i&&b$H&&b$S&&b$K&&b$k&&b$V?b$M=b$QM.vertexDeclaration:b$y&&b$i&&b$H&&b$S&&b$K&&b$k?b$M=b$IM.vertexDeclaration:b$y&&b$i&&b$V&&b$X&&b$S&&b$K&&b$k?b$M=b$_M.vertexDeclaration:b$y&&b$i&&b$S&&b$K&&b$k&&b$V?b$M=b$uM.vertexDeclaration:b$y&&b$i&&b$S&&b$K&&b$k?b$M=b$qM.vertexDeclaration:b$y&&b$i&&b$H&&b$K&&b$k&&b$V?b$M=b$dM.vertexDeclaration:b$y&&b$i&&b$H&&b$K&&b$k?b$M=b$FM.vertexDeclaration:b$y&&b$i&&b$H&&b$S&&b$f&&b$V?b$M=b$GM.vertexDeclaration:b$y&&b$i&&b$H&&b$S&&b$f?b$M=b$hM.vertexDeclaration:b$y&&b$i&&b$S&&b$f&&b$V?b$M=b$wM.vertexDeclaration:b$y&&b$i&&b$S&&b$f?b$M=b$mM.vertexDeclaration:b$y&&b$i&&b$H&&b$S&&b$V?b$M=b$cM.vertexDeclaration:b$y&&b$i&&b$S&&b$V&&b$X?b$M=b$ZM.vertexDeclaration:b$y&&b$i&&b$H&&b$S?b$M=b$JM.vertexDeclaration:b$y&&b$i&&b$S&&b$V?b$M=b$BM.vertexDeclaration:b$y&&b$i&&b$S?b$M=b$TM.vertexDeclaration:b$y&&b$i&&b$H&&b$V?b$M=b$lM.vertexDeclaration:b$y&&b$i&&b$H&&(b$M=b$XM.vertexDeclaration),b$M},b$l(0,b$M,"mesh",function(){return this._mesh}),b$R._attrReg=new RegExp("(\\w+)|([:,;])","g"),b$R}()),b$rM=function(){function b$U(){}return b$P(b$U,"laya.d3.loaders.LoadModelV02"),b$U.parse=function(b$M,b$y,b$i,b$H,b$S,b$f){b$U._mesh=b$i,b$U._materials=b$H,b$U._subMeshes=b$S,b$U._materialMap=b$f,b$U._version=b$y,b$U._readData=b$M,b$U.READ_DATA(),b$U.READ_BLOCK(),b$U.READ_STRINGS();for(var b$V=0,b$K=b$U._BLOCK.count;b$V<b$K;b$V++){b$U._readData.pos=b$U._BLOCK.blockStarts[b$V];var b$k=b$U._readData.getUint16(),b$X=b$U._strings[b$k],b$F=b$U["READ_"+b$X];if(null==b$F)throw new Error("model file err,no this function:"+b$k+" "+b$X);b$F.call()}b$U._strings.length=0,b$U._readData=null,b$U._version=null,b$U._mesh=null,b$U._materials=null,b$U._subMeshes=null,b$U._materialMap=null},b$U._readString=function(){return b$U._strings[b$U._readData.getUint16()]},b$U.READ_DATA=function(){b$U._DATA.offset=b$U._readData.getUint32(),b$U._DATA.size=b$U._readData.getUint32()},b$U.READ_BLOCK=function(){for(var b$M=b$U._BLOCK.count=b$U._readData.getUint16(),b$y=b$U._BLOCK.blockStarts=[],b$i=b$U._BLOCK.blockLengths=[],b$H=0;b$H<b$M;b$H++)b$y.push(b$U._readData.getUint32()),b$i.push(b$U._readData.getUint32())},b$U.READ_STRINGS=function(){var b$M=b$U._readData.getUint32(),b$y=b$U._readData.getUint16(),b$i=b$U._readData.pos;b$U._readData.pos=b$M+b$U._DATA.offset;for(var b$H=0;b$H<b$y;b$H++)b$U._strings[b$H]=b$U._readData.readUTFString();b$U._readData.pos=b$i},b$U.READ_MATERIAL=function(){b$U._readString(),b$U._readString();var b$M=b$U._readString();return""!==b$M&&b$U._materials.push(b$C.getRes(b$U._materialMap[b$M])),!0},b$U.READ_MESH=function(){b$U._readString();var b$M,b$y=b$U._readData.__getBuffer(),b$i=0,b$H=b$U._readData.getInt16(),b$S=b$U._DATA.offset;for(b$i=0;b$i<b$H;b$i++){var b$f=b$S+b$U._readData.getUint32(),b$V=b$U._readData.getUint32(),b$K=new Float32Array(b$y.slice(b$f,b$f+b$V)),b$k=b$U._readString().match(b$U._attrReg),b$X=b$U._getVertexDeclaration(b$k),b$F=b$uy.create(b$X,4*b$K.length/b$X.vertexStride,35044,!0);b$F.setData(b$K),b$U._mesh._vertexBuffers.push(b$F)}var b$o=b$S+b$U._readData.getUint32(),b$d=b$U._readData.getUint32(),b$P=new Uint16Array(b$y.slice(b$o,b$o+b$d)),b$l=b$ty.create("ushort",b$d/2,35044,!0);b$l.setData(b$P),b$U._mesh._indexBuffer=b$l;var b$J=b$U._mesh._boneNames=[],b$h=b$U._readData.getUint16();for(b$J.length=b$h,b$i=0;b$i<b$h;b$i++)b$J[b$i]=b$U._strings[b$U._readData.getUint16()];var b$C=b$U._readData.getUint32(),b$v=b$U._readData.getUint32(),b$R=(new Float32Array(b$y.slice(b$S+b$C,b$S+b$C+b$v)),b$U._readData.getUint32()),b$A=b$U._readData.getUint32(),b$G=new Float32Array(b$y.slice(b$S+b$R,b$S+b$R+b$A));for(b$U._mesh._inverseBindPoses=[],b$i=0,b$M=b$G.length;b$i<b$M;b$i+=16){var b$I=new b$My(b$G[b$i+0],b$G[b$i+1],b$G[b$i+2],b$G[b$i+3],b$G[b$i+4],b$G[b$i+5],b$G[b$i+6],b$G[b$i+7],b$G[b$i+8],b$G[b$i+9],b$G[b$i+10],b$G[b$i+11],b$G[b$i+12],b$G[b$i+13],b$G[b$i+14],b$G[b$i+15]);b$U._mesh._inverseBindPoses.push(b$I)}return b$U._mesh._skinnedDatas=new Float32Array(16*b$G.length),!0},b$U.READ_SUBMESH=function(){var b$M=b$U._readData.__getBuffer(),b$y=new b$Xy(b$U._mesh),b$i=b$U._readData.getInt16(),b$H=b$U._readData.getUint32(),b$S=b$U._readData.getUint32();b$y._vertexBuffer=b$U._mesh._vertexBuffers[b$i],b$y._vertexStart=b$H,b$y._vertexCount=b$S;var b$f=b$U._readData.getUint32(),b$V=b$U._readData.getUint32(),b$K=b$U._mesh._indexBuffer;b$y._indexBuffer=b$K,b$y._indexStart=b$f,b$y._indexCount=b$V,b$y._indices=new Uint16Array(b$K.getData().buffer,2*b$f,b$V);var b$k=b$U._DATA.offset,b$X=b$y._subIndexBufferStart,b$F=b$y._subIndexBufferCount,b$o=b$y._boneIndicesList,b$d=b$U._readData.getUint16();b$X.length=b$d,b$F.length=b$d,b$o.length=b$d;for(var b$P=0;b$P<b$d;b$P++){b$X[b$P]=b$U._readData.getUint32(),b$F[b$P]=b$U._readData.getUint32();var b$l=b$U._readData.getUint32(),b$J=b$U._readData.getUint32();b$y._boneIndicesList[b$P]=new Uint8Array(b$M.slice(b$k+b$l,b$k+b$l+b$J))}return b$U._subMeshes.push(b$y),!0},b$U._getVertexDeclaration=function(b$M){for(var b$y,b$i=!1,b$H=!1,b$S=!1,b$f=!1,b$V=!1,b$K=!1,b$k=!1,b$X=!1,b$F=!1,b$o=0;b$o<b$M.length;b$o++)switch(b$M[b$o]){case"POSITION":b$i=!0;break;case"NORMAL":b$H=!0;break;case"COLOR":b$S=!0;break;case"UV":b$f=!0;break;case"UV1":b$V=!0;break;case"BLENDWEIGHT":b$k=!0;break;case"BLENDINDICES":b$X=!0;break;case"TANGENT":b$K=!0;break;case"BINORMAL":b$F=!0}return b$i&&b$H&&b$S&&b$f&&b$V&&b$k&&b$X&&b$K?b$y=b$RM.vertexDeclaration:b$i&&b$H&&b$S&&b$f&&b$V&&b$k&&b$X?b$y=b$CM.vertexDeclaration:b$i&&b$H&&b$f&&b$V&&b$k&&b$X&&b$K?b$y=b$DM.vertexDeclaration:b$i&&b$H&&b$f&&b$V&&b$k&&b$X?b$y=b$eM.vertexDeclaration:b$i&&b$H&&b$S&&b$f&&b$k&&b$X&&b$K?b$y=b$QM.vertexDeclaration:b$i&&b$H&&b$S&&b$f&&b$k&&b$X?b$y=b$IM.vertexDeclaration:b$i&&b$H&&b$f&&b$k&&b$X&&b$K?b$y=b$uM.vertexDeclaration:b$i&&b$H&&b$f&&b$k&&b$X?b$y=b$qM.vertexDeclaration:b$i&&b$H&&b$S&&b$k&&b$X&&b$K?b$y=b$dM.vertexDeclaration:b$i&&b$H&&b$S&&b$k&&b$X?b$y=b$FM.vertexDeclaration:b$i&&b$H&&b$S&&b$f&&b$V&&b$K?b$y=b$GM.vertexDeclaration:b$i&&b$H&&b$S&&b$f&&b$V?b$y=b$hM.vertexDeclaration:b$i&&b$H&&b$f&&b$V&&b$K?b$y=b$wM.vertexDeclaration:b$i&&b$H&&b$f&&b$V?b$y=b$mM.vertexDeclaration:b$i&&b$H&&b$S&&b$f&&b$K?b$y=b$cM.vertexDeclaration:b$i&&b$H&&b$f&&b$K&&b$F?b$y=b$ZM.vertexDeclaration:b$i&&b$H&&b$S&&b$f?b$y=b$JM.vertexDeclaration:b$i&&b$H&&b$f&&b$K?b$y=b$BM.vertexDeclaration:b$i&&b$H&&b$f?b$y=b$TM.vertexDeclaration:b$i&&b$H&&b$S&&b$K?b$y=b$lM.vertexDeclaration:b$i&&b$H&&b$S&&(b$y=b$XM.vertexDeclaration),b$y},b$U._attrReg=new RegExp("(\\w+)|([:,;])","g"),b$U._strings=[],b$U._readData=null,b$U._version=null,b$U._mesh=null,b$U._materials=null,b$U._subMeshes=null,b$U._materialMap=null,b$o(b$U,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),b$U}(),b$NM=function(){function b$I(){}return b$P(b$I,"laya.d3.loaders.LoadModelV03"),b$I.parse=function(b$M,b$y,b$i,b$H,b$S){b$I._mesh=b$i,b$I._subMeshes=b$H,b$I._materialMap=b$S,b$I._version=b$y,b$I._readData=b$M,b$I.READ_DATA(),b$I.READ_BLOCK(),b$I.READ_STRINGS();for(var b$f=0,b$V=b$I._BLOCK.count;b$f<b$V;b$f++){b$I._readData.pos=b$I._BLOCK.blockStarts[b$f];var b$K=b$I._readData.getUint16(),b$k=b$I._strings[b$K],b$X=b$I["READ_"+b$k];if(null==b$X)throw new Error("model file err,no this function:"+b$K+" "+b$k);b$X.call()}b$I._strings.length=0,b$I._readData=null,b$I._version=null,b$I._mesh=null,b$I._subMeshes=null,b$I._materialMap=null},b$I._readString=function(){return b$I._strings[b$I._readData.getUint16()]},b$I.READ_DATA=function(){b$I._DATA.offset=b$I._readData.getUint32(),b$I._DATA.size=b$I._readData.getUint32()},b$I.READ_BLOCK=function(){for(var b$M=b$I._BLOCK.count=b$I._readData.getUint16(),b$y=b$I._BLOCK.blockStarts=[],b$i=b$I._BLOCK.blockLengths=[],b$H=0;b$H<b$M;b$H++)b$y.push(b$I._readData.getUint32()),b$i.push(b$I._readData.getUint32())},b$I.READ_STRINGS=function(){var b$M=b$I._readData.getUint32(),b$y=b$I._readData.getUint16(),b$i=b$I._readData.pos;b$I._readData.pos=b$M+b$I._DATA.offset;for(var b$H=0;b$H<b$y;b$H++)b$I._strings[b$H]=b$I._readData.readUTFString();b$I._readData.pos=b$i},b$I.READ_MESH=function(){var b$M,b$y=b$I._readString(),b$i=b$I._readData.__getBuffer(),b$H=0,b$S=b$I._readData.getInt16(),b$f=b$I._DATA.offset;for(b$H=0;b$H<b$S;b$H++){var b$V,b$K=b$f+b$I._readData.getUint32(),b$k=b$I._readData.getUint32(),b$X=new Float32Array(b$i.slice(b$K,b$K+b$k)),b$F=b$I._readString();switch(b$I._version){case"LAYAMODEL:03":b$V=b$I._vertexDeclarationMap_Discard[b$F];break;case"LAYAMODEL:0301":b$V=b$I._vertexDeclarationMap[b$F];break;default:throw new Error("LoadModelV03: unknown version.")}if(!b$V)throw new Error("LoadModelV03: unknown vertexDeclaration.  version="+b$I._version+"  bufferAttribute="+b$F+"  name="+b$y+"  url="+(b$I._mesh?b$I._mesh.url:"null"));var b$o=b$uy.create(b$V,4*b$X.length/b$V.vertexStride,35044,!0,b$I._mesh._url+"_"+b$H);b$o.setData(b$X),b$I._mesh._vertexBuffers.push(b$o)}var b$d=b$f+b$I._readData.getUint32(),b$P=b$I._readData.getUint32(),b$l=new Uint16Array(b$i.slice(b$d,b$d+b$P)),b$J=b$ty.create("ushort",b$P/2,35044,!0,b$I._mesh._url);b$J.setData(b$l),b$I._mesh._indexBuffer=b$J;var b$h=b$I._mesh._boneNames=[],b$C=b$I._readData.getUint16();for(b$h.length=b$C,b$H=0;b$H<b$C;b$H++)b$h[b$H]=b$I._strings[b$I._readData.getUint16()];b$I._readData.pos+=8;var b$v=b$I._readData.getUint32(),b$R=b$I._readData.getUint32(),b$A=new Float32Array(b$i.slice(b$f+b$v,b$f+b$v+b$R));for(b$I._mesh._inverseBindPoses=[],b$H=0,b$M=b$A.length;b$H<b$M;b$H+=16){var b$G=new b$My(b$A[b$H+0],b$A[b$H+1],b$A[b$H+2],b$A[b$H+3],b$A[b$H+4],b$A[b$H+5],b$A[b$H+6],b$A[b$H+7],b$A[b$H+8],b$A[b$H+9],b$A[b$H+10],b$A[b$H+11],b$A[b$H+12],b$A[b$H+13],b$A[b$H+14],b$A[b$H+15]);b$I._mesh._inverseBindPoses.push(b$G)}return b$I._mesh._skinnedDatas=new Float32Array(16*b$A.length),!0},b$I.READ_SUBMESH=function(){var b$M=b$I._readData.__getBuffer(),b$y=new b$Xy(b$I._mesh),b$i=b$I._readData.getInt16(),b$H=b$I._readData.getUint32(),b$S=b$I._readData.getUint32();b$y._vertexBuffer=b$I._mesh._vertexBuffers[b$i],b$y._vertexStart=b$H,b$y._vertexCount=b$S;var b$f=b$I._readData.getUint32(),b$V=b$I._readData.getUint32(),b$K=b$I._mesh._indexBuffer;b$y._indexBuffer=b$K,b$y._indexStart=b$f,b$y._indexCount=b$V,b$y._indices=new Uint16Array(b$K.getData().buffer,2*b$f,b$V);var b$k=b$I._DATA.offset,b$X=b$y._subIndexBufferStart,b$F=b$y._subIndexBufferCount,b$o=b$y._boneIndicesList,b$d=b$I._readData.getUint16();b$X.length=b$d,b$F.length=b$d,b$o.length=b$d;for(var b$P=0;b$P<b$d;b$P++){b$X[b$P]=b$I._readData.getUint32(),b$F[b$P]=b$I._readData.getUint32();var b$l=b$I._readData.getUint32(),b$J=b$I._readData.getUint32();b$o[b$P]=new Uint8Array(b$M.slice(b$k+b$l,b$k+b$l+b$J))}return b$I._subMeshes.push(b$y),!0},b$I._strings=[],b$I._readData=null,b$I._version=null,b$I._mesh=null,b$I._subMeshes=null,b$I._materialMap=null,b$o(b$I,["_vertexDeclarationMap_Discard",function(){return this._vertexDeclarationMap_Discard={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":b$RM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":b$CM.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":b$EM.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":b$DM.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":b$eM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":b$QM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":b$IM.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":b$uM.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":b$qM.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":b$dM.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":b$FM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":b$GM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":b$hM.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":b$wM.vertexDeclaration,"POSITION,NORMAL,UV,UV1":b$mM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":b$cM.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":b$ZM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":b$JM.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":b$BM.vertexDeclaration,"POSITION,NORMAL,UV":b$TM.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":b$lM.vertexDeclaration,"POSITION,NORMAL,COLOR":b$XM.vertexDeclaration,"POSITION,NORMAL,TANGENT":b$aM.vertexDeclaration,"POSITION,NORMAL":b$kM.vertexDeclaration,"POSITION,UV":b$bM.vertexDeclaration,POSITION:b$KM.vertexDeclaration}},"_vertexDeclarationMap",function(){return this._vertexDeclarationMap={"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":b$vM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,BLENDWEIGHT,BLENDINDICES":b$CM.vertexDeclaration,"POSITION,NORMAL,TANGENT,BINORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,":b$EM.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES,TANGENT":b$sM.vertexDeclaration,"POSITION,NORMAL,UV,UV1,BLENDWEIGHT,BLENDINDICES":b$eM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":b$UM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,BLENDWEIGHT,BLENDINDICES":b$IM.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES,TANGENT":b$tM.vertexDeclaration,"POSITION,NORMAL,UV,BLENDWEIGHT,BLENDINDICES":b$qM.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES,TANGENT":b$oM.vertexDeclaration,"POSITION,NORMAL,COLOR,BLENDWEIGHT,BLENDINDICES":b$FM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1,TANGENT":b$AM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,UV1":b$hM.vertexDeclaration,"POSITION,NORMAL,UV,UV1,TANGENT":b$zM.vertexDeclaration,"POSITION,NORMAL,UV,UV1":b$mM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV,TANGENT":b$WM.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT,BINORMAL":b$ZM.vertexDeclaration,"POSITION,NORMAL,COLOR,UV":b$JM.vertexDeclaration,"POSITION,NORMAL,UV,TANGENT":b$pM.vertexDeclaration,"POSITION,NORMAL,UV":b$TM.vertexDeclaration,"POSITION,NORMAL,COLOR,TANGENT":b$PM.vertexDeclaration,"POSITION,NORMAL,COLOR":b$XM.vertexDeclaration,"POSITION,NORMAL,TANGENT":b$nM.vertexDeclaration,"POSITION,NORMAL":b$kM.vertexDeclaration,"POSITION,UV":b$bM.vertexDeclaration,POSITION:b$KM.vertexDeclaration}},"_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),b$I}(),b$$M=function(){function b$K(){}return b$P(b$K,"laya.d3.loaders.MeshReader"),b$K.read=function(b$M,b$y,b$i,b$H,b$S){var b$f=new b$I(b$M);b$f.pos=0;var b$V=b$f.readUTFString();switch(b$V){case"LAYAMODEL:01":case"LAYASKINANI:01":b$K._readVersion01(b$f,b$V,b$y,b$i,b$H,b$S);break;case"LAYAMODEL:02":b$rM.parse(b$f,b$V,b$y,b$i,b$H,b$S);break;case"LAYAMODEL:03":case"LAYAMODEL:0301":b$NM.parse(b$f,b$V,b$y,b$H,b$S);break;default:throw new Error("MeshReader: unknown mesh version.")}b$y._setSubMeshes(b$H)},b$K._readVersion01=function(b$M,b$y,b$i,b$H,b$S,b$f){new b$YM(b$M,b$y,b$i,b$H,b$S,b$f)},b$K}(),b$xM=function(){function b$M(b$M,b$y){this.min=null,this.max=null,this.min=b$M,this.max=b$y}b$P(b$M,"laya.d3.math.BoundBox");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y.getCorners=function(b$M){b$M.length=8;var b$y=this.min.elements,b$i=this.max.elements,b$H=b$y[0],b$S=b$y[1],b$f=b$y[2],b$V=b$i[0],b$K=b$i[1],b$k=b$i[2];b$M[0]=new b$Vy(b$H,b$K,b$k),b$M[1]=new b$Vy(b$V,b$K,b$k),b$M[2]=new b$Vy(b$V,b$S,b$k),b$M[3]=new b$Vy(b$H,b$S,b$k),b$M[4]=new b$Vy(b$H,b$K,b$f),b$M[5]=new b$Vy(b$V,b$K,b$f),b$M[6]=new b$Vy(b$V,b$S,b$f),b$M[7]=new b$Vy(b$H,b$S,b$f)},b$y.toDefault=function(){this.min.toDefault(),this.max.toDefault()},b$y.cloneTo=function(b$M){var b$y=b$M;this.min.cloneTo(b$y.min),this.max.cloneTo(b$y.max)},b$y.clone=function(){var b$M=new this.constructor(new b$Vy,new b$Vy);return this.cloneTo(b$M),b$M},b$M.createfromPoints=function(b$M,b$y){if(null==b$M)throw new Error("points");var b$i=b$y.min,b$H=b$y.max,b$S=b$i.elements;b$S[0]=Number.MAX_VALUE,b$S[1]=Number.MAX_VALUE,b$S[2]=Number.MAX_VALUE;var b$f=b$H.elements;b$f[0]=-Number.MAX_VALUE,b$f[1]=-Number.MAX_VALUE,b$f[2]=-Number.MAX_VALUE;for(var b$V=0,b$K=b$M.length;b$V<b$K;++b$V)b$Vy.min(b$i,b$M[b$V],b$i),b$Vy.max(b$H,b$M[b$V],b$H)},b$M.merge=function(b$M,b$y,b$i){b$Vy.min(b$M.min,b$y.min,b$i.min),b$Vy.max(b$M.max,b$y.max,b$i.max)},b$M}(),b$gM=function(){function b$X(b$M){this._matrix=null,this._near=null,this._far=null,this._left=null,this._right=null,this._top=null,this._bottom=null,this._matrix=b$M,this._near=new b$yy(new b$Vy),this._far=new b$yy(new b$Vy),this._left=new b$yy(new b$Vy),this._right=new b$yy(new b$Vy),this._top=new b$yy(new b$Vy),this._bottom=new b$yy(new b$Vy),b$X._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}b$P(b$X,"laya.d3.math.BoundFrustum");var b$M=b$X.prototype;return b$M.equalsBoundFrustum=function(b$M){return this._matrix.equalsOtherMatrix(b$M.matrix)},b$M.equalsObj=function(b$M){if(b$M instanceof laya.d3.math.BoundFrustum){var b$y=b$M;return this.equalsBoundFrustum(b$y)}return!1},b$M.getPlane=function(b$M){switch(b$M){case 0:return this._near;case 1:return this._far;case 2:return this._left;case 3:return this._right;case 4:return this._top;case 5:return this._bottom;default:return null}},b$M.getCorners=function(b$M){b$X._get3PlaneInterPoint(this._near,this._bottom,this._right).cloneTo(b$M[0]),b$X._get3PlaneInterPoint(this._near,this._top,this._right).cloneTo(b$M[1]),b$X._get3PlaneInterPoint(this._near,this._top,this._left).cloneTo(b$M[2]),b$X._get3PlaneInterPoint(this._near,this._bottom,this._left).cloneTo(b$M[3]),b$X._get3PlaneInterPoint(this._far,this._bottom,this._right).cloneTo(b$M[4]),b$X._get3PlaneInterPoint(this._far,this._top,this._right).cloneTo(b$M[5]),b$X._get3PlaneInterPoint(this._far,this._top,this._left).cloneTo(b$M[6]),b$X._get3PlaneInterPoint(this._far,this._bottom,this._left).cloneTo(b$M[7])},b$M.containsPoint=function(b$M){for(var b$y=b$yy.PlaneIntersectionType_Front,b$i=b$yy.PlaneIntersectionType_Front,b$H=0;b$H<6;b$H++){switch(b$H){case 0:b$i=Collision.intersectsPlaneAndPoint(this._near,b$M);break;case 1:b$i=Collision.intersectsPlaneAndPoint(this._far,b$M);break;case 2:b$i=Collision.intersectsPlaneAndPoint(this._left,b$M);break;case 3:b$i=Collision.intersectsPlaneAndPoint(this._right,b$M);break;case 4:b$i=Collision.intersectsPlaneAndPoint(this._top,b$M);break;case 5:b$i=Collision.intersectsPlaneAndPoint(this._bottom,b$M)}switch(b$i){case b$yy.PlaneIntersectionType_Back:return 0;case b$yy.PlaneIntersectionType_Intersecting:b$y=b$yy.PlaneIntersectionType_Intersecting}}switch(b$y){case b$yy.PlaneIntersectionType_Intersecting:return 2;default:return 1}},b$M.containsBoundBox=function(b$M){for(var b$y,b$i=b$X._tempV30,b$H=b$X._tempV31,b$S=1,b$f=0;b$f<6;b$f++){if(b$y=this.getPlane(b$f),this._getBoxToPlanePVertexNVertex(b$M,b$y.normal,b$i,b$H),Collision.intersectsPlaneAndPoint(b$y,b$i)===b$yy.PlaneIntersectionType_Back)return 0;Collision.intersectsPlaneAndPoint(b$y,b$H)===b$yy.PlaneIntersectionType_Back&&(b$S=2)}return b$S},b$M.containsBoundSphere=function(b$M){for(var b$y=b$yy.PlaneIntersectionType_Front,b$i=b$yy.PlaneIntersectionType_Front,b$H=0;b$H<6;b$H++){switch(b$H){case 0:b$i=Collision.intersectsPlaneAndSphere(this._near,b$M);break;case 1:b$i=Collision.intersectsPlaneAndSphere(this._far,b$M);break;case 2:b$i=Collision.intersectsPlaneAndSphere(this._left,b$M);break;case 3:b$i=Collision.intersectsPlaneAndSphere(this._right,b$M);break;case 4:b$i=Collision.intersectsPlaneAndSphere(this._top,b$M);break;case 5:b$i=Collision.intersectsPlaneAndSphere(this._bottom,b$M)}switch(b$i){case b$yy.PlaneIntersectionType_Back:return 0;case b$yy.PlaneIntersectionType_Intersecting:b$y=b$yy.PlaneIntersectionType_Intersecting}}switch(b$y){case b$yy.PlaneIntersectionType_Intersecting:return 2;default:return 1}},b$M._getBoxToPlanePVertexNVertex=function(b$M,b$y,b$i,b$H){var b$S=b$M.min,b$f=b$S.elements,b$V=b$M.max,b$K=b$V.elements,b$k=b$y.elements,b$X=b$k[0],b$F=b$k[1],b$o=b$k[2];b$S.cloneTo(b$i);var b$d=b$i.elements;0<=b$X&&(b$d[0]=b$K[0]),0<=b$F&&(b$d[1]=b$K[1]),0<=b$o&&(b$d[2]=b$K[2]),b$V.cloneTo(b$H);var b$P=b$H.elements;0<=b$X&&(b$P[0]=b$f[0]),0<=b$F&&(b$P[1]=b$f[1]),0<=b$o&&(b$P[2]=b$f[2])},b$l(0,b$M,"top",function(){return this._top}),b$l(0,b$M,"matrix",function(){return this._matrix},function(b$M){this._matrix=b$M,b$X._getPlanesFromMatrix(this._matrix,this._near,this._far,this._left,this._right,this._top,this._bottom)}),b$l(0,b$M,"near",function(){return this._near}),b$l(0,b$M,"far",function(){return this._far}),b$l(0,b$M,"left",function(){return this._left}),b$l(0,b$M,"right",function(){return this._right}),b$l(0,b$M,"bottom",function(){return this._bottom}),b$X._getPlanesFromMatrix=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){var b$K=b$M.elements,b$k=b$K[0],b$X=b$K[1],b$F=b$K[2],b$o=b$K[3],b$d=b$K[4],b$P=b$K[5],b$l=b$K[6],b$J=b$K[7],b$h=b$K[8],b$C=b$K[9],b$v=b$K[10],b$R=b$K[11],b$A=b$K[12],b$G=b$K[13],b$I=b$K[14],b$U=b$K[15],b$Q=b$y.normal.elements;b$Q[0]=b$o+b$F,b$Q[1]=b$J+b$l,b$Q[2]=b$R+b$v,b$y.distance=b$U+b$I,b$y.normalize();var b$W=b$i.normal.elements;b$W[0]=b$o-b$F,b$W[1]=b$J-b$l,b$W[2]=b$R-b$v,b$i.distance=b$U-b$I,b$i.normalize();var b$c=b$H.normal.elements;b$c[0]=b$o+b$k,b$c[1]=b$J+b$d,b$c[2]=b$R+b$h,b$H.distance=b$U+b$A,b$H.normalize();var b$n=b$S.normal.elements;b$n[0]=b$o-b$k,b$n[1]=b$J-b$d,b$n[2]=b$R-b$h,b$S.distance=b$U-b$A,b$S.normalize();var b$a=b$f.normal.elements;b$a[0]=b$o-b$X,b$a[1]=b$J-b$P,b$a[2]=b$R-b$C,b$f.distance=b$U-b$G,b$f.normalize();var b$T=b$V.normal.elements;b$T[0]=b$o+b$X,b$T[1]=b$J+b$P,b$T[2]=b$R+b$C,b$V.distance=b$U+b$G,b$V.normalize()},b$X._get3PlaneInterPoint=function(b$M,b$y,b$i){var b$H=b$M.normal,b$S=b$y.normal,b$f=b$i.normal;b$Vy.cross(b$S,b$f,b$X._tempV30),b$Vy.cross(b$f,b$H,b$X._tempV31),b$Vy.cross(b$H,b$S,b$X._tempV32);var b$V=b$Vy.dot(b$H,b$X._tempV30),b$K=b$Vy.dot(b$S,b$X._tempV31),b$k=b$Vy.dot(b$f,b$X._tempV32);return b$Vy.scale(b$X._tempV30,-b$M.distance/b$V,b$X._tempV33),b$Vy.scale(b$X._tempV31,-b$y.distance/b$K,b$X._tempV34),b$Vy.scale(b$X._tempV32,-b$i.distance/b$k,b$X._tempV35),b$Vy.add(b$X._tempV33,b$X._tempV34,b$X._tempV36),b$Vy.add(b$X._tempV35,b$X._tempV36,b$X._tempV37),b$X._tempV37},b$o(b$X,["_tempV30",function(){return this._tempV30=new b$Vy},"_tempV31",function(){return this._tempV31=new b$Vy},"_tempV32",function(){return this._tempV32=new b$Vy},"_tempV33",function(){return this._tempV33=new b$Vy},"_tempV34",function(){return this._tempV34=new b$Vy},"_tempV35",function(){return this._tempV35=new b$Vy},"_tempV36",function(){return this._tempV36=new b$Vy},"_tempV37",function(){return this._tempV37=new b$Vy}]),b$X}(),b$jM=function(){function b$F(b$M,b$y){this.center=null,this.radius=NaN,this.center=b$M,this.radius=b$y}b$P(b$F,"laya.d3.math.BoundSphere");var b$M=b$F.prototype;return b$G.imps(b$M,{"laya.d3.core.IClone":!0}),b$M.toDefault=function(){this.center.toDefault(),this.radius=0},b$M.intersectsRayDistance=function(b$M){return Collision.intersectsRayAndSphereRD(b$M,this)},b$M.intersectsRayPoint=function(b$M,b$y){return Collision.intersectsRayAndSphereRP(b$M,this,b$y)},b$M.cloneTo=function(b$M){var b$y=b$M;this.center.cloneTo(b$y.center),b$y.radius=this.radius},b$M.clone=function(){var b$M=new this.constructor(new b$Vy,new b$Vy);return this.cloneTo(b$M),b$M},b$F.createFromSubPoints=function(b$M,b$y,b$i,b$H){if(null==b$M)throw new Error("points");if(b$y<0||b$y>=b$M.length)throw new Error("start"+b$y+"Must be in the range [0, "+(b$M.length-1)+"]");if(b$i<0||b$y+b$i>b$M.length)throw new Error("count"+b$i+"Must be in the range <= "+b$M.length+"}");var b$S=b$y+b$i,b$f=b$F._tempVector3;b$f.elements[0]=0,b$f.elements[1]=0,b$f.elements[2]=0;for(var b$V=b$y;b$V<b$S;++b$V)b$Vy.add(b$M[b$V],b$f,b$f);var b$K=b$H.center;b$Vy.scale(b$f,1/b$i,b$K);var b$k=0;for(b$V=b$y;b$V<b$S;++b$V){var b$X=b$Vy.distanceSquared(b$K,b$M[b$V]);b$k<b$X&&(b$k=b$X)}b$H.radius=Math.sqrt(b$k)},b$F.createfromPoints=function(b$M,b$y){if(null==b$M)throw new Error("points");b$F.createFromSubPoints(b$M,0,b$M.length,b$y)},b$o(b$F,["_tempVector3",function(){return this._tempVector3=new b$Vy}]),b$F}(),b$OM=(function(){function b$M(){}b$P(b$M,"laya.d3.math.ContainmentType"),b$M.Disjoint=0,b$M.Contains=1,b$M.Intersects=2}(),function(){function b$i(){}return b$P(b$i,"laya.d3.math.MathUtils3D"),b$i.isZero=function(b$M){return Math.abs(b$M)<b$i.zeroTolerance},b$i.nearEqual=function(b$M,b$y){return!!b$i.isZero(b$M-b$y)},b$i.fastInvSqrt=function(b$M){return b$i.isZero(b$M)?b$M:1/Math.sqrt(b$M)},b$o(b$i,["zeroTolerance",function(){return this.zeroTolerance=1e-6},"MaxValue",function(){return this.MaxValue=340282347e30},"MinValue",function(){return this.MinValue=-340282347e30}]),b$i}()),b$LM=function(){function b$k(){var b$M=this.elements=new Float32Array(9);b$M[0]=1,b$M[1]=0,b$M[2]=0,b$M[3]=0,b$M[4]=1,b$M[5]=0,b$M[6]=0,b$M[7]=0,b$M[8]=1}b$P(b$k,"laya.d3.math.Matrix3x3");var b$M=b$k.prototype;return b$G.imps(b$M,{"laya.d3.core.IClone":!0}),b$M.determinant=function(){var b$M=this.elements,b$y=b$M[0],b$i=b$M[1],b$H=b$M[2],b$S=b$M[3],b$f=b$M[4],b$V=b$M[5],b$K=b$M[6],b$k=b$M[7],b$X=b$M[8];return b$y*(b$X*b$f-b$V*b$k)+b$i*(-b$X*b$S+b$V*b$K)+b$H*(b$k*b$S-b$f*b$K)},b$M.translate=function(b$M,b$y){var b$i=b$y.elements,b$H=this.elements,b$S=b$M.elements,b$f=b$H[0],b$V=b$H[1],b$K=b$H[2],b$k=b$H[3],b$X=b$H[4],b$F=b$H[5],b$o=b$H[6],b$d=b$H[7],b$P=b$H[8],b$l=b$S[0],b$J=b$S[1];b$i[0]=b$f,b$i[1]=b$V,b$i[2]=b$K,b$i[3]=b$k,b$i[4]=b$X,b$i[5]=b$F,b$i[6]=b$l*b$f+b$J*b$k+b$o,b$i[7]=b$l*b$V+b$J*b$X+b$d,b$i[8]=b$l*b$K+b$J*b$F+b$P},b$M.rotate=function(b$M,b$y){var b$i=b$y.elements,b$H=this.elements,b$S=b$H[0],b$f=b$H[1],b$V=b$H[2],b$K=b$H[3],b$k=b$H[4],b$X=b$H[5],b$F=b$H[6],b$o=b$H[7],b$d=b$H[8],b$P=Math.sin(b$M),b$l=Math.cos(b$M);b$i[0]=b$l*b$S+b$P*b$K,b$i[1]=b$l*b$f+b$P*b$k,b$i[2]=b$l*b$V+b$P*b$X,b$i[3]=b$l*b$K-b$P*b$S,b$i[4]=b$l*b$k-b$P*b$f,b$i[5]=b$l*b$X-b$P*b$V,b$i[6]=b$F,b$i[7]=b$o,b$i[8]=b$d},b$M.scale=function(b$M,b$y){var b$i=b$y.elements,b$H=this.elements,b$S=b$M.elements,b$f=b$S[0],b$V=b$S[1];b$i[0]=b$f*b$H[0],b$i[1]=b$f*b$H[1],b$i[2]=b$f*b$H[2],b$i[3]=b$V*b$H[3],b$i[4]=b$V*b$H[4],b$i[5]=b$V*b$H[5],b$i[6]=b$H[6],b$i[7]=b$H[7],b$i[8]=b$H[8]},b$M.invert=function(b$M){var b$y=b$M.elements,b$i=this.elements,b$H=b$i[0],b$S=b$i[1],b$f=b$i[2],b$V=b$i[3],b$K=b$i[4],b$k=b$i[5],b$X=b$i[6],b$F=b$i[7],b$o=b$i[8],b$d=b$o*b$K-b$k*b$F,b$P=-b$o*b$V+b$k*b$X,b$l=b$F*b$V-b$K*b$X,b$J=b$H*b$d+b$S*b$P+b$f*b$l;b$J||(b$M=null),b$J=1/b$J,b$y[0]=b$d*b$J,b$y[1]=(-b$o*b$S+b$f*b$F)*b$J,b$y[2]=(b$k*b$S-b$f*b$K)*b$J,b$y[3]=b$P*b$J,b$y[4]=(b$o*b$H-b$f*b$X)*b$J,b$y[5]=(-b$k*b$H+b$f*b$V)*b$J,b$y[6]=b$l*b$J,b$y[7]=(-b$F*b$H+b$S*b$X)*b$J,b$y[8]=(b$K*b$H-b$S*b$V)*b$J},b$M.transpose=function(b$M){var b$y=b$M.elements,b$i=this.elements;if(b$M===this){var b$H=b$i[1],b$S=b$i[2],b$f=b$i[5];b$y[1]=b$i[3],b$y[2]=b$i[6],b$y[3]=b$H,b$y[5]=b$i[7],b$y[6]=b$S,b$y[7]=b$f}else b$y[0]=b$i[0],b$y[1]=b$i[3],b$y[2]=b$i[6],b$y[3]=b$i[1],b$y[4]=b$i[4],b$y[5]=b$i[7],b$y[6]=b$i[2],b$y[7]=b$i[5],b$y[8]=b$i[8]},b$M.identity=function(){var b$M=this.elements;b$M[0]=1,b$M[1]=0,b$M[2]=0,b$M[3]=0,b$M[4]=1,b$M[5]=0,b$M[6]=0,b$M[7]=0,b$M[8]=1},b$M.cloneTo=function(b$M){var b$y,b$i,b$H;if((b$i=this.elements)!==(b$H=b$M.elements))for(b$y=0;b$y<9;++b$y)b$H[b$y]=b$i[b$y]},b$M.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$k.createFromTranslation=function(b$M,b$y){b$y.elements;var b$i=b$M.elements;b$y[0]=1,b$y[1]=0,b$y[2]=0,b$y[3]=0,b$y[4]=1,b$y[5]=0,b$y[6]=b$i[0],b$y[7]=b$i[1],b$y[8]=1},b$k.createFromRotation=function(b$M,b$y){var b$i=b$y.elements,b$H=Math.sin(b$M),b$S=Math.cos(b$M);b$i[0]=b$S,b$i[1]=b$H,b$i[2]=0,b$i[3]=-b$H,b$i[4]=b$S,b$i[5]=0,b$i[6]=0,b$i[7]=0,b$i[8]=1},b$k.createFromScaling=function(b$M,b$y){var b$i=b$y.elements,b$H=b$M.elements;b$i[0]=b$H[0],b$i[1]=0,b$i[2]=0,b$i[3]=0,b$i[4]=b$H[1],b$i[5]=0,b$i[6]=0,b$i[7]=0,b$i[8]=1},b$k.createFromMatrix4x4=function(b$M,b$y){b$y[0]=b$M[0],b$y[1]=b$M[1],b$y[2]=b$M[2],b$y[3]=b$M[4],b$y[4]=b$M[5],b$y[5]=b$M[6],b$y[6]=b$M[8],b$y[7]=b$M[9],b$y[8]=b$M[10]},b$k.multiply=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y.elements,b$V=b$S[0],b$K=b$S[1],b$k=b$S[2],b$X=b$S[3],b$F=b$S[4],b$o=b$S[5],b$d=b$S[6],b$P=b$S[7],b$l=b$S[8],b$J=b$f[0],b$h=b$f[1],b$C=b$f[2],b$v=b$f[3],b$R=b$f[4],b$A=b$f[5],b$G=b$f[6],b$I=b$f[7],b$U=b$f[8];b$H[0]=b$J*b$V+b$h*b$X+b$C*b$d,b$H[1]=b$J*b$K+b$h*b$F+b$C*b$P,b$H[2]=b$J*b$k+b$h*b$o+b$C*b$l,b$H[3]=b$v*b$V+b$R*b$X+b$A*b$d,b$H[4]=b$v*b$K+b$R*b$F+b$A*b$P,b$H[5]=b$v*b$k+b$R*b$o+b$A*b$l,b$H[6]=b$G*b$V+b$I*b$X+b$U*b$d,b$H[7]=b$G*b$K+b$I*b$F+b$U*b$P,b$H[8]=b$G*b$k+b$I*b$o+b$U*b$l},b$k.lookAt=function(b$M,b$y,b$i,b$H){b$Vy.subtract(b$M,b$y,b$k._tempV30),b$Vy.normalize(b$k._tempV30,b$k._tempV30),b$Vy.cross(b$i,b$k._tempV30,b$k._tempV31),b$Vy.normalize(b$k._tempV31,b$k._tempV31),b$Vy.cross(b$k._tempV30,b$k._tempV31,b$k._tempV32);var b$S=b$k._tempV30.elements,b$f=b$k._tempV31.elements,b$V=b$k._tempV32.elements,b$K=b$H.elements;b$K[0]=b$f[0],b$K[3]=b$f[1],b$K[6]=b$f[2],b$K[1]=b$V[0],b$K[4]=b$V[1],b$K[7]=b$V[2],b$K[2]=b$S[0],b$K[5]=b$S[1],b$K[8]=b$S[2]},b$k.DEFAULT=new b$k,b$o(b$k,["_tempV30",function(){return this._tempV30=new b$Vy},"_tempV31",function(){return this._tempV31=new b$Vy},"_tempV32",function(){return this._tempV32=new b$Vy}]),b$k}(),b$My=function(){function b$W(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F,b$o,b$d,b$P,b$l,b$J){void 0===b$M&&(b$M=1),void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=0),void 0===b$S&&(b$S=0),void 0===b$f&&(b$f=1),void 0===b$V&&(b$V=0),void 0===b$K&&(b$K=0),void 0===b$k&&(b$k=0),void 0===b$X&&(b$X=0),void 0===b$F&&(b$F=1),void 0===b$o&&(b$o=0),void 0===b$d&&(b$d=0),void 0===b$P&&(b$P=0),void 0===b$l&&(b$l=0),void 0===b$J&&(b$J=1);var b$h=this.elements=new Float32Array(16);b$h[0]=b$M,b$h[1]=b$y,b$h[2]=b$i,b$h[3]=b$H,b$h[4]=b$S,b$h[5]=b$f,b$h[6]=b$V,b$h[7]=b$K,b$h[8]=b$k,b$h[9]=b$X,b$h[10]=b$F,b$h[11]=b$o,b$h[12]=b$d,b$h[13]=b$P,b$h[14]=b$l,b$h[15]=b$J}b$P(b$W,"laya.d3.math.Matrix4x4");var b$M=b$W.prototype;return b$G.imps(b$M,{"laya.d3.core.IClone":!0}),b$M.getElementByRowColumn=function(b$M,b$y){if(b$M<0||3<b$M)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(b$y<0||3<b$y)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");return this.elements[4*b$M+b$y]},b$M.setElementByRowColumn=function(b$M,b$y,b$i){if(b$M<0||3<b$M)throw new Error("row","Rows and columns for matrices run from 0 to 3, inclusive.");if(b$y<0||3<b$y)throw new Error("column","Rows and columns for matrices run from 0 to 3, inclusive.");this.elements[4*b$M+b$y]=b$i},b$M.equalsOtherMatrix=function(b$M){var b$y=this.elements,b$i=b$M.elements;return b$OM.nearEqual(b$y[0],b$i[0])&&b$OM.nearEqual(b$y[1],b$i[1])&&b$OM.nearEqual(b$y[2],b$i[2])&&b$OM.nearEqual(b$y[3],b$i[3])&&b$OM.nearEqual(b$y[4],b$i[4])&&b$OM.nearEqual(b$y[5],b$i[5])&&b$OM.nearEqual(b$y[6],b$i[6])&&b$OM.nearEqual(b$y[7],b$i[7])&&b$OM.nearEqual(b$y[8],b$i[8])&&b$OM.nearEqual(b$y[9],b$i[9])&&b$OM.nearEqual(b$y[10],b$i[10])&&b$OM.nearEqual(b$y[11],b$i[11])&&b$OM.nearEqual(b$y[12],b$i[12])&&b$OM.nearEqual(b$y[13],b$i[13])&&b$OM.nearEqual(b$y[14],b$i[14])&&b$OM.nearEqual(b$y[15],b$i[15])},b$M.decomposeTransRotScale=function(b$M,b$y,b$i){var b$H=b$W._tempMatrix4x4;return this.decomposeTransRotMatScale(b$M,b$H,b$i)?(b$iy.createFromMatrix4x4(b$H,b$y),!0):(b$y.identity(),!1)},b$M.decomposeTransRotMatScale=function(b$M,b$y,b$i){var b$H=this.elements,b$S=b$M.elements,b$f=b$y.elements,b$V=b$i.elements;b$S[0]=b$H[12],b$S[1]=b$H[13],b$S[2]=b$H[14];var b$K=b$H[0],b$k=b$H[1],b$X=b$H[2],b$F=b$H[4],b$o=b$H[5],b$d=b$H[6],b$P=b$H[8],b$l=b$H[9],b$J=b$H[10],b$h=b$V[0]=Math.sqrt(b$K*b$K+b$k*b$k+b$X*b$X),b$C=b$V[1]=Math.sqrt(b$F*b$F+b$o*b$o+b$d*b$d),b$v=b$V[2]=Math.sqrt(b$P*b$P+b$l*b$l+b$J*b$J);if(b$OM.isZero(b$h)||b$OM.isZero(b$C)||b$OM.isZero(b$v))return b$f[1]=b$f[2]=b$f[3]=b$f[4]=b$f[6]=b$f[7]=b$f[8]=b$f[9]=b$f[11]=b$f[12]=b$f[13]=b$f[14]=0,b$f[0]=b$f[5]=b$f[10]=b$f[15]=1,!1;var b$R=b$W._tempVector0,b$A=b$R.elements;b$A[0]=b$P/b$v,b$A[1]=b$l/b$v,b$A[2]=b$J/b$v;var b$G=b$W._tempVector1,b$I=b$G.elements;b$I[0]=b$K/b$h,b$I[1]=b$k/b$h,b$I[2]=b$X/b$h;var b$U=b$W._tempVector2;b$Vy.cross(b$R,b$G,b$U);var b$Q=b$W._tempVector1;return b$Vy.cross(b$U,b$R,b$Q),b$f[3]=b$f[7]=b$f[11]=b$f[12]=b$f[13]=b$f[14]=0,b$f[15]=1,b$f[0]=b$Q.x,b$f[1]=b$Q.y,b$f[2]=b$Q.z,b$f[4]=b$U.x,b$f[5]=b$U.y,b$f[6]=b$U.z,b$f[8]=b$R.x,b$f[9]=b$R.y,b$f[10]=b$R.z,b$f[0]*b$K+b$f[1]*b$k+b$f[2]*b$X<0&&(b$V[0]=-b$h),b$f[4]*b$F+b$f[5]*b$o+b$f[6]*b$d<0&&(b$V[1]=-b$C),b$f[8]*b$P+b$f[9]*b$l+b$f[10]*b$J<0&&(b$V[2]=-b$v),!0},b$M.decomposeYawPitchRoll=function(b$M){var b$y=b$M.elements,b$i=Math.asin(-this.elements[9]);b$y[1]=b$i,Math.cos(b$i)>b$OM.zeroTolerance?(b$y[2]=Math.atan2(this.elements[1],this.elements[5]),b$y[0]=Math.atan2(this.elements[8],this.elements[10])):(b$y[2]=Math.atan2(-this.elements[4],this.elements[0]),b$y[0]=0)},b$M.normalize=function(){var b$M=this.elements,b$y=b$M[0],b$i=b$M[1],b$H=b$M[2],b$S=Math.sqrt(b$y*b$y+b$i*b$i+b$H*b$H);if(!b$S)return b$M[0]=0,b$M[1]=0,void(b$M[2]=0);1!=b$S&&(b$S=1/b$S,b$M[0]=b$y*b$S,b$M[1]=b$i*b$S,b$M[2]=b$H*b$S)},b$M.transpose=function(){var b$M,b$y;return b$y=(b$M=this.elements)[1],b$M[1]=b$M[4],b$M[4]=b$y,b$y=b$M[2],b$M[2]=b$M[8],b$M[8]=b$y,b$y=b$M[3],b$M[3]=b$M[12],b$M[12]=b$y,b$y=b$M[6],b$M[6]=b$M[9],b$M[9]=b$y,b$y=b$M[7],b$M[7]=b$M[13],b$M[13]=b$y,b$y=b$M[11],b$M[11]=b$M[14],b$M[14]=b$y,this},b$M.invert=function(b$M){var b$y=this.elements,b$i=b$M.elements,b$H=b$y[0],b$S=b$y[1],b$f=b$y[2],b$V=b$y[3],b$K=b$y[4],b$k=b$y[5],b$X=b$y[6],b$F=b$y[7],b$o=b$y[8],b$d=b$y[9],b$P=b$y[10],b$l=b$y[11],b$J=b$y[12],b$h=b$y[13],b$C=b$y[14],b$v=b$y[15],b$R=b$H*b$k-b$S*b$K,b$A=b$H*b$X-b$f*b$K,b$G=b$H*b$F-b$V*b$K,b$I=b$S*b$X-b$f*b$k,b$U=b$S*b$F-b$V*b$k,b$Q=b$f*b$F-b$V*b$X,b$W=b$o*b$h-b$d*b$J,b$c=b$o*b$C-b$P*b$J,b$n=b$o*b$v-b$l*b$J,b$a=b$d*b$C-b$P*b$h,b$T=b$d*b$v-b$l*b$h,b$m=b$P*b$v-b$l*b$C,b$e=b$R*b$m-b$A*b$T+b$G*b$a+b$I*b$n-b$U*b$c+b$Q*b$W;0!==Math.abs(b$e)&&(b$e=1/b$e,b$i[0]=(b$k*b$m-b$X*b$T+b$F*b$a)*b$e,b$i[1]=(b$f*b$T-b$S*b$m-b$V*b$a)*b$e,b$i[2]=(b$h*b$Q-b$C*b$U+b$v*b$I)*b$e,b$i[3]=(b$P*b$U-b$d*b$Q-b$l*b$I)*b$e,b$i[4]=(b$X*b$n-b$K*b$m-b$F*b$c)*b$e,b$i[5]=(b$H*b$m-b$f*b$n+b$V*b$c)*b$e,b$i[6]=(b$C*b$G-b$J*b$Q-b$v*b$A)*b$e,b$i[7]=(b$o*b$Q-b$P*b$G+b$l*b$A)*b$e,b$i[8]=(b$K*b$T-b$k*b$n+b$F*b$W)*b$e,b$i[9]=(b$S*b$n-b$H*b$T-b$V*b$W)*b$e,b$i[10]=(b$J*b$U-b$h*b$G+b$v*b$R)*b$e,b$i[11]=(b$d*b$G-b$o*b$U-b$l*b$R)*b$e,b$i[12]=(b$k*b$c-b$K*b$a-b$X*b$W)*b$e,b$i[13]=(b$H*b$a-b$S*b$c+b$f*b$W)*b$e,b$i[14]=(b$h*b$A-b$J*b$I-b$C*b$R)*b$e,b$i[15]=(b$o*b$I-b$d*b$A+b$P*b$R)*b$e)},b$M.identity=function(){var b$M=this.elements;b$M[1]=b$M[2]=b$M[3]=b$M[4]=b$M[6]=b$M[7]=b$M[8]=b$M[9]=b$M[11]=b$M[12]=b$M[13]=b$M[14]=0,b$M[0]=b$M[5]=b$M[10]=b$M[15]=1},b$M.cloneTo=function(b$M){var b$y,b$i,b$H;if((b$i=this.elements)!==(b$H=b$M.elements))for(b$y=0;b$y<16;++b$y)b$H[b$y]=b$i[b$y]},b$M.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$M.getTranslationVector=function(b$M){var b$y=this.elements,b$i=b$M.elements;b$i[0]=b$y[12],b$i[1]=b$y[13],b$i[2]=b$y[14]},b$M.setTranslationVector=function(b$M){var b$y=this.elements,b$i=b$M.elements;b$y[12]=b$i[0],b$y[13]=b$i[1],b$y[14]=b$i[2]},b$M.getForward=function(b$M){var b$y=this.elements,b$i=b$M.elements;b$i[0]=-b$y[8],b$i[1]=-b$y[9],b$i[2]=-b$y[10]},b$M.setForward=function(b$M){var b$y=this.elements,b$i=b$M.elements;b$y[8]=-b$i[0],b$y[9]=-b$i[1],b$y[10]=-b$i[2]},b$W.createRotationX=function(b$M,b$y){var b$i=b$y.elements,b$H=Math.sin(b$M),b$S=Math.cos(b$M);b$i[1]=b$i[2]=b$i[3]=b$i[4]=b$i[7]=b$i[8]=b$i[11]=b$i[12]=b$i[13]=b$i[14]=0,b$i[0]=b$i[15]=1,b$i[5]=b$i[10]=b$S,b$i[6]=b$H,b$i[9]=-b$H},b$W.createRotationY=function(b$M,b$y){var b$i=b$y.elements,b$H=Math.sin(b$M),b$S=Math.cos(b$M);b$i[1]=b$i[3]=b$i[4]=b$i[6]=b$i[7]=b$i[9]=b$i[11]=b$i[12]=b$i[13]=b$i[14]=0,b$i[5]=b$i[15]=1,b$i[0]=b$i[10]=b$S,b$i[2]=-b$H,b$i[8]=b$H},b$W.createRotationZ=function(b$M,b$y){var b$i=b$y.elements,b$H=Math.sin(b$M),b$S=Math.cos(b$M);b$i[2]=b$i[3]=b$i[6]=b$i[7]=b$i[8]=b$i[9]=b$i[11]=b$i[12]=b$i[13]=b$i[14]=0,b$i[10]=b$i[15]=1,b$i[0]=b$i[5]=b$S,b$i[1]=b$H,b$i[4]=-b$H},b$W.createRotationYawPitchRoll=function(b$M,b$y,b$i,b$H){b$iy.createFromYawPitchRoll(b$M,b$y,b$i,b$W._tempQuaternion),b$W.createRotationQuaternion(b$W._tempQuaternion,b$H)},b$W.createRotationAxis=function(b$M,b$y,b$i){var b$H=b$M.elements,b$S=b$H[0],b$f=b$H[1],b$V=b$H[2],b$K=Math.cos(b$y),b$k=Math.sin(b$y),b$X=b$S*b$S,b$F=b$f*b$f,b$o=b$V*b$V,b$d=b$S*b$f,b$P=b$S*b$V,b$l=b$f*b$V,b$J=b$i.elements;b$J[3]=b$J[7]=b$J[11]=b$J[12]=b$J[13]=b$J[14]=0,b$J[15]=1,b$J[0]=b$X+b$K*(1-b$X),b$J[1]=b$d-b$K*b$d+b$k*b$V,b$J[2]=b$P-b$K*b$P-b$k*b$f,b$J[4]=b$d-b$K*b$d-b$k*b$V,b$J[5]=b$F+b$K*(1-b$F),b$J[6]=b$l-b$K*b$l+b$k*b$S,b$J[8]=b$P-b$K*b$P+b$k*b$f,b$J[9]=b$l-b$K*b$l-b$k*b$S,b$J[10]=b$o+b$K*(1-b$o)},b$W.createRotationQuaternion=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements,b$S=b$i[0],b$f=b$i[1],b$V=b$i[2],b$K=b$i[3],b$k=b$S*b$S,b$X=b$f*b$f,b$F=b$V*b$V,b$o=b$S*b$f,b$d=b$V*b$K,b$P=b$V*b$S,b$l=b$f*b$K,b$J=b$f*b$V,b$h=b$S*b$K;b$H[3]=b$H[7]=b$H[11]=b$H[12]=b$H[13]=b$H[14]=0,b$H[15]=1,b$H[0]=1-2*(b$X+b$F),b$H[1]=2*(b$o+b$d),b$H[2]=2*(b$P-b$l),b$H[4]=2*(b$o-b$d),b$H[5]=1-2*(b$F+b$k),b$H[6]=2*(b$J+b$h),b$H[8]=2*(b$P+b$l),b$H[9]=2*(b$J-b$h),b$H[10]=1-2*(b$X+b$k)},b$W.createTranslate=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements;b$H[4]=b$H[8]=b$H[1]=b$H[9]=b$H[2]=b$H[6]=b$H[3]=b$H[7]=b$H[11]=0,b$H[0]=b$H[5]=b$H[10]=b$H[15]=1,b$H[12]=b$i[0],b$H[13]=b$i[1],b$H[14]=b$i[2]},b$W.createScaling=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements;b$H[0]=b$i[0],b$H[5]=b$i[1],b$H[10]=b$i[2],b$H[1]=b$H[4]=b$H[8]=b$H[12]=b$H[9]=b$H[13]=b$H[2]=b$H[6]=b$H[14]=b$H[3]=b$H[7]=b$H[11]=0,b$H[15]=1},b$W.multiply=function(b$M,b$y,b$i){var b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F;for(b$S=b$i.elements,b$f=b$M.elements,b$S===(b$V=b$y.elements)&&(b$V=b$V.slice()),b$H=0;b$H<4;b$H++)b$K=b$f[b$H],b$k=b$f[b$H+4],b$X=b$f[b$H+8],b$F=b$f[b$H+12],b$S[b$H]=b$K*b$V[0]+b$k*b$V[1]+b$X*b$V[2]+b$F*b$V[3],b$S[b$H+4]=b$K*b$V[4]+b$k*b$V[5]+b$X*b$V[6]+b$F*b$V[7],b$S[b$H+8]=b$K*b$V[8]+b$k*b$V[9]+b$X*b$V[10]+b$F*b$V[11],b$S[b$H+12]=b$K*b$V[12]+b$k*b$V[13]+b$X*b$V[14]+b$F*b$V[15]},b$W.createFromQuaternion=function(b$M,b$y){var b$i=b$y.elements,b$H=b$M.elements,b$S=b$H[0],b$f=b$H[1],b$V=b$H[2],b$K=b$H[3],b$k=b$S+b$S,b$X=b$f+b$f,b$F=b$V+b$V,b$o=b$S*b$k,b$d=b$f*b$k,b$P=b$f*b$X,b$l=b$V*b$k,b$J=b$V*b$X,b$h=b$V*b$F,b$C=b$K*b$k,b$v=b$K*b$X,b$R=b$K*b$F;b$i[0]=1-b$P-b$h,b$i[1]=b$d+b$R,b$i[2]=b$l-b$v,b$i[3]=0,b$i[4]=b$d-b$R,b$i[5]=1-b$o-b$h,b$i[6]=b$J+b$C,b$i[7]=0,b$i[8]=b$l+b$v,b$i[9]=b$J-b$C,b$i[10]=1-b$o-b$P,b$i[11]=0,b$i[12]=0,b$i[13]=0,b$i[14]=0,b$i[15]=1},b$W.createAffineTransformation=function(b$M,b$y,b$i,b$H){var b$S=b$M.elements,b$f=b$y.elements,b$V=b$i.elements,b$K=b$H.elements,b$k=b$f[0],b$X=b$f[1],b$F=b$f[2],b$o=b$f[3],b$d=b$k+b$k,b$P=b$X+b$X,b$l=b$F+b$F,b$J=b$k*b$d,b$h=b$k*b$P,b$C=b$k*b$l,b$v=b$X*b$P,b$R=b$X*b$l,b$A=b$F*b$l,b$G=b$o*b$d,b$I=b$o*b$P,b$U=b$o*b$l,b$Q=b$V[0],b$W=b$V[1],b$c=b$V[2];b$K[0]=(1-(b$v+b$A))*b$Q,b$K[1]=(b$h+b$U)*b$Q,b$K[2]=(b$C-b$I)*b$Q,b$K[3]=0,b$K[4]=(b$h-b$U)*b$W,b$K[5]=(1-(b$J+b$A))*b$W,b$K[6]=(b$R+b$G)*b$W,b$K[7]=0,b$K[8]=(b$C+b$I)*b$c,b$K[9]=(b$R-b$G)*b$c,b$K[10]=(1-(b$J+b$v))*b$c,b$K[11]=0,b$K[12]=b$S[0],b$K[13]=b$S[1],b$K[14]=b$S[2],b$K[15]=1},b$W.createLookAt=function(b$M,b$y,b$i,b$H){var b$S=b$H.elements,b$f=b$W._tempVector0,b$V=b$W._tempVector1,b$K=b$W._tempVector2;b$Vy.subtract(b$M,b$y,b$K),b$Vy.normalize(b$K,b$K),b$Vy.cross(b$i,b$K,b$f),b$Vy.normalize(b$f,b$f),b$Vy.cross(b$K,b$f,b$V),b$H.identity(),b$S[0]=b$f.x,b$S[4]=b$f.y,b$S[8]=b$f.z,b$S[1]=b$V.x,b$S[5]=b$V.y,b$S[9]=b$V.z,b$S[2]=b$K.x,b$S[6]=b$K.y,b$S[10]=b$K.z,b$S[12]=-b$Vy.dot(b$f,b$M),b$S[13]=-b$Vy.dot(b$V,b$M),b$S[14]=-b$Vy.dot(b$K,b$M)},b$W.createPerspective=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$S.elements,b$V=1/Math.tan(b$M/2),b$K=1/(b$i-b$H);b$f[0]=b$V/b$y,b$f[5]=b$V,b$f[10]=(b$H+b$i)*b$K,b$f[11]=-1,b$f[14]=2*b$H*b$i*b$K,b$f[1]=b$f[2]=b$f[3]=b$f[4]=b$f[6]=b$f[7]=b$f[8]=b$f[9]=b$f[12]=b$f[13]=b$f[15]=0},b$W.createOrthoOffCenterRH=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){var b$K=b$V.elements,b$k=1/(b$M-b$y),b$X=1/(b$i-b$H),b$F=1/(b$S-b$f);b$K[1]=b$K[2]=b$K[3]=b$K[4]=b$K[6]=b$K[7]=b$K[8]=b$K[9]=b$K[11]=0,b$K[15]=1,b$K[0]=-2*b$k,b$K[5]=-2*b$X,b$K[10]=2*b$F,b$K[12]=(b$M+b$y)*b$k,b$K[13]=(b$H+b$i)*b$X,b$K[14]=(b$f+b$S)*b$F},b$W.translation=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements;b$H[0]=b$H[5]=b$H[10]=b$H[15]=1,b$H[12]=b$i[0],b$H[13]=b$i[1],b$H[14]=b$i[2]},b$o(b$W,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new b$W},"_tempVector0",function(){return this._tempVector0=new b$Vy},"_tempVector1",function(){return this._tempVector1=new b$Vy},"_tempVector2",function(){return this._tempVector2=new b$Vy},"_tempQuaternion",function(){return this._tempQuaternion=new b$iy},"DEFAULT",function(){return this.DEFAULT=new b$W},"ZERO",function(){return this.ZERO=new b$W(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}]),b$W}(),b$yy=(function(){function b$R(b$M,b$y){this.extents=null,this.transformation=null,this.extents=b$M,this.transformation=b$y}b$P(b$R,"laya.d3.math.OrientedBoundBox");var b$M=b$R.prototype;b$M.getCorners=function(b$M){var b$y=b$R._tempV30.elements,b$i=b$R._tempV31.elements,b$H=b$R._tempV32.elements,b$S=this.extents.elements;b$y[0]=b$S[0],b$y[1]=b$y[2]=0,b$i[1]=b$S[1],b$i[0]=b$i[2]=0,b$H[2]=b$S[2],b$H[0]=b$H[1]=0,b$Vy.TransformNormal(b$R._tempV30,this.transformation,b$R._tempV30),b$Vy.TransformNormal(b$R._tempV31,this.transformation,b$R._tempV31),b$Vy.TransformNormal(b$R._tempV32,this.transformation,b$R._tempV32);var b$f=b$R._tempV33;this.transformation.getTranslationVector(b$f),b$M.length=8,b$Vy.add(b$f,b$R._tempV30,b$R._tempV34),b$Vy.add(b$R._tempV34,b$R._tempV31,b$R._tempV34),b$Vy.add(b$R._tempV34,b$R._tempV32,b$M[0]),b$Vy.add(b$f,b$R._tempV30,b$R._tempV34),b$Vy.add(b$R._tempV34,b$R._tempV31,b$R._tempV34),b$Vy.subtract(b$R._tempV34,b$R._tempV32,b$M[1]),b$Vy.subtract(b$f,b$R._tempV30,b$R._tempV34),b$Vy.add(b$R._tempV34,b$R._tempV31,b$R._tempV34),b$Vy.subtract(b$R._tempV34,b$R._tempV32,b$M[2]),b$Vy.subtract(b$f,b$R._tempV30,b$R._tempV34),b$Vy.add(b$R._tempV34,b$R._tempV31,b$R._tempV34),b$Vy.add(b$R._tempV34,b$R._tempV32,b$M[3]),b$Vy.add(b$f,b$R._tempV30,b$R._tempV34),b$Vy.subtract(b$R._tempV34,b$R._tempV31,b$R._tempV34),b$Vy.add(b$R._tempV34,b$R._tempV32,b$M[4]),b$Vy.add(b$f,b$R._tempV30,b$R._tempV34),b$Vy.subtract(b$R._tempV34,b$R._tempV31,b$R._tempV34),b$Vy.subtract(b$R._tempV34,b$R._tempV32,b$M[5]),b$Vy.subtract(b$f,b$R._tempV30,b$R._tempV34),b$Vy.subtract(b$R._tempV34,b$R._tempV31,b$R._tempV34),b$Vy.subtract(b$R._tempV34,b$R._tempV32,b$M[6]),b$Vy.subtract(b$f,b$R._tempV30,b$R._tempV34),b$Vy.subtract(b$R._tempV34,b$R._tempV31,b$R._tempV34),b$Vy.add(b$R._tempV34,b$R._tempV32,b$M[7])},b$M.transform=function(b$M){b$My.multiply(this.transformation,b$M,this.transformation)},b$M.scale=function(b$M){b$Vy.multiply(this.extents,b$M,this.extents)},b$M.translate=function(b$M){this.transformation.getTranslationVector(b$R._tempV30),b$Vy.add(b$R._tempV30,b$M,b$R._tempV31),this.transformation.setTranslationVector(b$R._tempV31)},b$M.Size=function(b$M){b$Vy.scale(this.extents,2,b$M)},b$M.getSize=function(b$M){var b$y=this.extents.elements;b$R._tempV30.x=b$y[0],b$R._tempV31.y=b$y[1],b$R._tempV32.z=b$y[2],b$Vy.TransformNormal(b$R._tempV30,this.transformation,b$R._tempV30),b$Vy.TransformNormal(b$R._tempV31,this.transformation,b$R._tempV31),b$Vy.TransformNormal(b$R._tempV31,this.transformation,b$R._tempV32);var b$i=b$M.elements;b$i[0]=b$Vy.scalarLength(b$R._tempV30),b$i[1]=b$Vy.scalarLength(b$R._tempV31),b$i[2]=b$Vy.scalarLength(b$R._tempV32)},b$M.getSizeSquared=function(b$M){var b$y=this.extents.elements;b$R._tempV30.x=b$y[0],b$R._tempV31.y=b$y[1],b$R._tempV32.z=b$y[2],b$Vy.TransformNormal(b$R._tempV30,this.transformation,b$R._tempV30),b$Vy.TransformNormal(b$R._tempV31,this.transformation,b$R._tempV31),b$Vy.TransformNormal(b$R._tempV31,this.transformation,b$R._tempV32);var b$i=b$M.elements;b$i[0]=b$Vy.scalarLengthSquared(b$R._tempV30),b$i[1]=b$Vy.scalarLengthSquared(b$R._tempV31),b$i[2]=b$Vy.scalarLengthSquared(b$R._tempV32)},b$M.getCenter=function(b$M){this.transformation.getTranslationVector(b$M)},b$M.containsPoint=function(b$M){var b$y=this.extents.elements,b$i=b$y[0],b$H=b$y[1],b$S=b$y[2];this.transformation.invert(b$R._tempM0),b$Vy.transformCoordinate(b$M,b$R._tempM0,b$R._tempV30);var b$f=b$R._tempV30.elements,b$V=Math.abs(b$f[0]),b$K=Math.abs(b$f[1]),b$k=Math.abs(b$f[2]);return b$OM.nearEqual(b$V,b$i)&&b$OM.nearEqual(b$K,b$H)&&b$OM.nearEqual(b$k,b$S)?2:b$V<b$i&&b$K<b$H&&b$k<b$S?1:0},b$M.containsPoints=function(b$M){var b$y=this.extents.elements,b$i=b$y[0],b$H=b$y[1],b$S=b$y[2];this.transformation.invert(b$R._tempM0);for(var b$f=!0,b$V=!1,b$K=0;b$K<b$M.length;b$K++){b$Vy.transformCoordinate(b$M[b$K],b$R._tempM0,b$R._tempV30);var b$k=b$R._tempV30.elements,b$X=Math.abs(b$k[0]),b$F=Math.abs(b$k[1]),b$o=Math.abs(b$k[2]);b$OM.nearEqual(b$X,b$i)&&b$OM.nearEqual(b$F,b$H)&&b$OM.nearEqual(b$o,b$S)&&(b$V=!0),b$X<b$i&&b$F<b$H&&b$o<b$S?b$V=!0:b$f=!1}return b$f?1:b$V?2:0},b$M.containsSphere=function(b$M,b$y){void 0===b$y&&(b$y=!1);var b$i=this.extents.elements,b$H=b$i[0],b$S=b$i[1],b$f=b$i[2],b$V=b$M.radius;this.transformation.invert(b$R._tempM0),b$Vy.transformCoordinate(b$M.center,b$R._tempM0,b$R._tempV30);var b$K=NaN;if(b$K=b$y?b$V:(b$Vy.scale(b$Vy.UnitX,b$V,b$R._tempV31),b$Vy.TransformNormal(b$R._tempV31,b$R._tempM0,b$R._tempV31),b$Vy.scalarLength(b$R._tempV31)),b$Vy.scale(this.extents,-1,b$R._tempV32),b$Vy.Clamp(b$R._tempV30,b$R._tempV32,this.extents,b$R._tempV33),b$K*b$K<b$Vy.distanceSquared(b$R._tempV30,b$R._tempV33))return 0;var b$k=b$R._tempV30.elements,b$X=b$k[0],b$F=b$k[1],b$o=b$k[2],b$d=b$R._tempV32.elements,b$P=b$d[0],b$l=b$d[1],b$J=b$d[2];return b$P+b$K<=b$X&&b$X<=b$H-b$K&&b$K<b$H-b$P&&b$l+b$K<=b$F&&b$F<=b$S-b$K&&b$K<b$S-b$l&&b$J+b$K<=b$o&&b$o<=b$f-b$K&&b$K<b$f-b$J?1:2},b$M.containsOrientedBoundBox=function(b$M){var b$y=0,b$i=0;b$M.getCorners(b$R._corners);var b$H=this.containsPoints(b$R._corners);if(0!=b$H)return b$H;var b$S=this.extents.elements;b$M.extents.cloneTo(b$R._tempV35);var b$f=b$R._tempV35.elements;b$R._getRows(this.transformation,b$R._rows1),b$R._getRows(b$M.transformation,b$R._rows2);var b$V=NaN;for(b$y=0;b$y<4;b$y++)for(b$i=0;b$i<4;b$i++)3==b$y||3==b$i?(b$R._tempM0.setElementByRowColumn(b$y,b$i,0),b$R._tempM1.setElementByRowColumn(b$y,b$i,0)):(b$V=b$Vy.dot(b$R._rows1[b$y],b$R._rows2[b$i]),b$R._tempM0.setElementByRowColumn(b$y,b$i,b$V),b$R._tempM1.setElementByRowColumn(b$y,b$i,Math.abs(b$V)));b$M.getCenter(b$R._tempV34),this.getCenter(b$R._tempV36),b$Vy.subtract(b$R._tempV34,b$R._tempV36,b$R._tempV30);var b$K=b$R._tempV31.elements;b$K[0]=b$Vy.dot(b$R._tempV30,b$R._rows1[0]),b$K[1]=b$Vy.dot(b$R._tempV30,b$R._rows1[1]),b$K[2]=b$Vy.dot(b$R._tempV30,b$R._rows1[2]);var b$k=b$R._tempV32.elements,b$X=b$R._tempV33.elements;for(b$y=0;b$y<3;b$y++)if(b$k[0]=b$R._tempM1.getElementByRowColumn(b$y,0),b$k[1]=b$R._tempM1.getElementByRowColumn(b$y,1),b$k[2]=b$R._tempM1.getElementByRowColumn(b$y,2),b$S[b$y]+b$Vy.dot(b$R._tempV35,b$R._tempV32)<Math.abs(b$K[b$y]))return 0;for(b$i=0;b$i<3;b$i++)if(b$k[0]=b$R._tempM1.getElementByRowColumn(0,b$i),b$k[1]=b$R._tempM1.getElementByRowColumn(1,b$i),b$k[2]=b$R._tempM1.getElementByRowColumn(2,b$i),b$X[0]=b$R._tempM0.getElementByRowColumn(0,b$i),b$X[1]=b$R._tempM0.getElementByRowColumn(1,b$i),b$X[2]=b$R._tempM0.getElementByRowColumn(2,b$i),b$Vy.dot(this.extents,b$R._tempV32)+b$f[b$i]<Math.abs(b$Vy.dot(b$R._tempV31,b$R._tempV33)))return 0;for(b$y=0;b$y<3;b$y++)for(b$i=0;b$i<3;b$i++){var b$F=(b$y+1)%3,b$o=(b$y+2)%3,b$d=(b$i+1)%3,b$P=(b$i+2)%3;if(b$S[b$F]*b$R._tempM1.getElementByRowColumn(b$o,b$i)+b$S[b$o]*b$R._tempM1.getElementByRowColumn(b$F,b$i)+(b$f[b$d]*b$R._tempM1.getElementByRowColumn(b$y,b$P)+b$f[b$P]*b$R._tempM1.getElementByRowColumn(b$y,b$d))<Math.abs(b$K[b$o]*b$R._tempM0.getElementByRowColumn(b$F,b$i)-b$K[b$F]*b$R._tempM0.getElementByRowColumn(b$o,b$i)))return 0}return 2},b$M.containsLine=function(b$M,b$y){b$R._corners[0]=b$M,b$R._corners[1]=b$y;var b$i=this.containsPoints(b$R._corners);if(0!=b$i)return b$i;var b$H=this.extents.elements,b$S=b$H[0],b$f=b$H[1],b$V=b$H[2];this.transformation.invert(b$R._tempM0),b$Vy.transformCoordinate(b$M,b$R._tempM0,b$R._tempV30),b$Vy.transformCoordinate(b$y,b$R._tempM0,b$R._tempV31),b$Vy.add(b$R._tempV30,b$R._tempV31,b$R._tempV32),b$Vy.scale(b$R._tempV32,.5,b$R._tempV32),b$Vy.subtract(b$R._tempV30,b$R._tempV32,b$R._tempV33);var b$K=b$R._tempV33.elements,b$k=b$K[0],b$X=b$K[1],b$F=b$K[2],b$o=b$R._tempV34.elements,b$d=b$o[0]=Math.abs(b$K[0]),b$P=b$o[1]=Math.abs(b$K[1]),b$l=b$o[2]=Math.abs(b$K[2]),b$J=b$R._tempV32.elements,b$h=b$J[0],b$C=b$J[1],b$v=b$J[2];return Math.abs(b$h)>b$S+b$d?0:Math.abs(b$C)>b$f+b$P?0:Math.abs(b$v)>b$V+b$l?0:Math.abs(b$C*b$F-b$v*b$X)>b$f*b$l+b$V*b$P?0:Math.abs(b$h*b$F-b$v*b$k)>b$S*b$l+b$V*b$d?0:Math.abs(b$h*b$X-b$C*b$k)>b$S*b$P+b$f*b$d?0:2},b$M.containsBoundBox=function(b$M){var b$y=0,b$i=0,b$H=b$M.min,b$S=b$M.max;b$M.getCorners(b$R._corners);var b$f=this.containsPoints(b$R._corners);if(0!=b$f)return b$f;b$Vy.subtract(b$S,b$H,b$R._tempV30),b$Vy.scale(b$R._tempV30,.5,b$R._tempV30),b$Vy.add(b$H,b$R._tempV30,b$R._tempV30),b$Vy.subtract(b$S,b$R._tempV30,b$R._tempV31);var b$V=this.extents.elements,b$K=b$R._tempV31.elements;b$R._getRows(this.transformation,b$R._rows1),this.transformation.invert(b$R._tempM0);for(b$y=0;b$y<3;b$y++)for(b$i=0;b$i<3;b$i++)b$R._tempM1.setElementByRowColumn(b$y,b$i,Math.abs(b$R._tempM0.getElementByRowColumn(b$y,b$i)));this.getCenter(b$R._tempV35),b$Vy.subtract(b$R._tempV30,b$R._tempV35,b$R._tempV32);var b$k=b$R._tempV31.elements;b$k[0]=b$Vy.dot(b$R._tempV32,b$R._rows1[0]),b$k[1]=b$Vy.dot(b$R._tempV32,b$R._rows1[1]),b$k[2]=b$Vy.dot(b$R._tempV32,b$R._rows1[2]);var b$X=b$R._tempV33.elements,b$F=b$R._tempV34.elements;for(b$y=0;b$y<3;b$y++)if(b$X[0]=b$R._tempM1.getElementByRowColumn(b$y,0),b$X[1]=b$R._tempM1.getElementByRowColumn(b$y,1),b$X[2]=b$R._tempM1.getElementByRowColumn(b$y,2),b$V[b$y]+b$Vy.dot(b$R._tempV31,b$R._tempV33)<Math.abs(b$k[b$y]))return 0;for(b$i=0;b$i<3;b$i++)if(b$X[0]=b$R._tempM1.getElementByRowColumn(0,b$i),b$X[1]=b$R._tempM1.getElementByRowColumn(1,b$i),b$X[2]=b$R._tempM1.getElementByRowColumn(2,b$i),b$F[0]=b$R._tempM0.getElementByRowColumn(0,b$i),b$F[1]=b$R._tempM0.getElementByRowColumn(1,b$i),b$F[2]=b$R._tempM0.getElementByRowColumn(2,b$i),b$Vy.dot(this.extents,b$R._tempV33)+b$K[b$i]<Math.abs(b$Vy.dot(b$R._tempV31,b$R._tempV34)))return 0;for(b$y=0;b$y<3;b$y++)for(b$i=0;b$i<3;b$i++){var b$o=(b$y+1)%3,b$d=(b$y+2)%3,b$P=(b$i+1)%3,b$l=(b$i+2)%3;if(b$V[b$o]*b$R._tempM1.getElementByRowColumn(b$d,b$i)+b$V[b$d]*b$R._tempM1.getElementByRowColumn(b$o,b$i)+(b$K[b$P]*b$R._tempM1.getElementByRowColumn(b$y,b$l)+b$K[b$l]*b$R._tempM1.getElementByRowColumn(b$y,b$P))<Math.abs(b$k[b$d]*b$R._tempM0.getElementByRowColumn(b$o,b$i)-b$k[b$o]*b$R._tempM0.getElementByRowColumn(b$d,b$i)))return 0}return 2},b$M.intersectsRay=function(b$M,b$y){b$Vy.scale(this.extents,-1,b$R._tempV30),this.transformation.invert(b$R._tempM0),b$Vy.TransformNormal(b$M.direction,b$R._tempM0,b$R._ray.direction),b$Vy.transformCoordinate(b$M.origin,b$R._tempM0,b$R._ray.origin),b$R._boxBound1.min=b$R._tempV30,b$R._boxBound1.max=this.extents;var b$i=Collision.intersectsRayAndBoxRP(b$R._ray,b$R._boxBound1,b$y);return-1!==b$i&&b$Vy.transformCoordinate(b$y,this.transformation,b$y),b$i},b$M._getLocalCorners=function(b$M){b$M.length=8;var b$y=this.extents.elements;b$R._tempV30.x=b$y[0],b$R._tempV31.y=b$y[1],b$R._tempV32.z=b$y[2],b$Vy.add(b$R._tempV30,b$R._tempV31,b$R._tempV33),b$Vy.add(b$R._tempV33,b$R._tempV32,b$M[0]),b$Vy.add(b$R._tempV30,b$R._tempV31,b$R._tempV33),b$Vy.subtract(b$R._tempV33,b$R._tempV32,b$M[1]),b$Vy.subtract(b$R._tempV31,b$R._tempV30,b$R._tempV33),b$Vy.subtract(b$R._tempV33,b$R._tempV30,b$M[2]),b$Vy.subtract(b$R._tempV31,b$R._tempV30,b$R._tempV33),b$Vy.add(b$R._tempV33,b$R._tempV32,b$M[3]),b$Vy.subtract(b$R._tempV30,b$R._tempV31,b$R._tempV33),b$Vy.add(b$R._tempV33,b$R._tempV32,b$M[4]),b$Vy.subtract(b$R._tempV30,b$R._tempV31,b$R._tempV33),b$Vy.subtract(b$R._tempV33,b$R._tempV32,b$M[5]),b$Vy.scale(b$M[0],-1,b$M[6]),b$Vy.subtract(b$R._tempV32,b$R._tempV30,b$R._tempV33),b$Vy.subtract(b$R._tempV33,b$R._tempV31,b$M[7])},b$M.equals=function(b$M){return this.extents==b$M.extents&&this.transformation==b$M.transformation},b$M.cloneTo=function(b$M){var b$y=b$M;this.extents.cloneTo(b$y.extents),this.transformation.cloneTo(b$y.transformation)},b$R.createByBoundBox=function(b$M,b$y){var b$i=b$M.min,b$H=b$M.max;b$Vy.subtract(b$H,b$i,b$R._tempV30),b$Vy.scale(b$R._tempV30,.5,b$R._tempV30),b$Vy.add(b$i,b$R._tempV30,b$R._tempV31),b$Vy.subtract(b$H,b$R._tempV31,b$R._tempV32),b$My.translation(b$R._tempV31,b$R._tempM0);var b$S=b$R._tempV32.clone(),b$f=b$R._tempM0.clone();b$y.extents=b$S,b$y.transformation=b$f},b$R.createByMinAndMaxVertex=function(b$M,b$y){return b$Vy.subtract(b$y,b$M,b$R._tempV30),b$Vy.scale(b$R._tempV30,.5,b$R._tempV30),b$Vy.add(b$M,b$R._tempV30,b$R._tempV31),b$Vy.subtract(b$y,b$R._tempV31,b$R._tempV32),b$My.translation(b$R._tempV31,b$R._tempM0),new b$R(b$R._tempV32,b$R._tempM0)},b$R._getRows=function(b$M,b$y){b$y.length=3;var b$i=b$M.elements,b$H=b$y[0].elements;b$H[0]=b$i[0],b$H[1]=b$i[1],b$H[2]=b$i[2];var b$S=b$y[1].elements;b$S[0]=b$i[4],b$S[1]=b$i[5],b$S[2]=b$i[6];var b$f=b$y[2].elements;b$f[0]=b$i[8],b$f[1]=b$i[9],b$f[2]=b$i[10]},b$R.getObbtoObbMatrix4x4=function(b$M,b$y,b$i,b$H){var b$S=b$M.transformation,b$f=b$y.transformation;if(b$i){b$R._getRows(b$S,b$R._rows1),b$R._getRows(b$f,b$R._rows2);for(var b$V=0;b$V<3;b$V++)for(var b$K=0;b$K<3;b$K++)b$H.setElementByRowColumn(b$V,b$K,b$Vy.dot(b$R._rows2[b$V],b$R._rows1[b$K]));b$y.getCenter(b$R._tempV30),b$M.getCenter(b$R._tempV31),b$Vy.subtract(b$R._tempV30,b$R._tempV31,b$R._tempV32);var b$k=b$H.elements;b$k[12]=b$Vy.dot(b$R._tempV32,b$R._rows1[0]),b$k[13]=b$Vy.dot(b$R._tempV32,b$R._rows1[1]),b$k[14]=b$Vy.dot(b$R._tempV32,b$R._rows1[2]),b$k[15]=1}else b$S.invert(b$R._tempM0),b$My.multiply(b$f,b$R._tempM0,b$H)},b$R.merge=function(b$M,b$y,b$i){var b$H=b$M.extents,b$S=b$M.transformation;b$R.getObbtoObbMatrix4x4(b$M,b$y,b$i,b$R._tempM0),b$y._getLocalCorners(b$R._corners),b$Vy.transformCoordinate(b$R._corners[0],b$R._tempM0,b$R._corners[0]),b$Vy.transformCoordinate(b$R._corners[1],b$R._tempM0,b$R._corners[1]),b$Vy.transformCoordinate(b$R._corners[2],b$R._tempM0,b$R._corners[2]),b$Vy.transformCoordinate(b$R._corners[3],b$R._tempM0,b$R._corners[3]),b$Vy.transformCoordinate(b$R._corners[4],b$R._tempM0,b$R._corners[4]),b$Vy.transformCoordinate(b$R._corners[5],b$R._tempM0,b$R._corners[5]),b$Vy.transformCoordinate(b$R._corners[6],b$R._tempM0,b$R._corners[6]),b$Vy.transformCoordinate(b$R._corners[7],b$R._tempM0,b$R._corners[7]),b$Vy.scale(b$H,-1,b$R._boxBound1.min),b$H.cloneTo(b$R._boxBound1.max),b$xM.createfromPoints(b$R._corners,b$R._boxBound2),b$xM.merge(b$R._boxBound2,b$R._boxBound1,b$R._boxBound3);var b$f=b$R._boxBound3.min,b$V=b$R._boxBound3.max;b$Vy.subtract(b$V,b$f,b$R._tempV30),b$Vy.scale(b$R._tempV30,.5,b$R._tempV30),b$Vy.add(b$f,b$R._tempV30,b$R._tempV32),b$Vy.subtract(b$V,b$R._tempV32,b$H),b$Vy.transformCoordinate(b$R._tempV32,b$S,b$R._tempV33)},b$o(b$R,["_tempV30",function(){return this._tempV30=new b$Vy},"_tempV31",function(){return this._tempV31=new b$Vy},"_tempV32",function(){return this._tempV32=new b$Vy},"_tempV33",function(){return this._tempV33=new b$Vy},"_tempV34",function(){return this._tempV34=new b$Vy},"_tempV35",function(){return this._tempV35=new b$Vy},"_tempV36",function(){return this._tempV36=new b$Vy},"_tempM0",function(){return this._tempM0=new b$My},"_tempM1",function(){return this._tempM1=new b$My},"_corners",function(){return this._corners=[new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy]},"_rows1",function(){return this._rows1=[new b$Vy,new b$Vy,new b$Vy]},"_rows2",function(){return this._rows2=[new b$Vy,new b$Vy,new b$Vy]},"_ray",function(){return this._ray=new b$Sy(new b$Vy,new b$Vy)},"_boxBound1",function(){return this._boxBound1=new b$xM(new b$Vy,new b$Vy)},"_boxBound2",function(){return this._boxBound2=new b$xM(new b$Vy,new b$Vy)},"_boxBound3",function(){return this._boxBound3=new b$xM(new b$Vy,new b$Vy)}])}(),function(){function b$G(b$M,b$y){this.normal=null,this.distance=NaN,void 0===b$y&&(b$y=0),this.normal=b$M,this.distance=b$y}return b$P(b$G,"laya.d3.math.Plane"),b$G.prototype.normalize=function(){var b$M=this.normal.elements,b$y=b$M[0],b$i=b$M[1],b$H=b$M[2],b$S=1/Math.sqrt(b$y*b$y+b$i*b$i+b$H*b$H);b$M[0]=b$y*b$S,b$M[1]=b$i*b$S,b$M[2]=b$H*b$S,this.distance*=b$S},b$G.createPlaneBy3P=function(b$M,b$y,b$i){var b$H=b$M.elements,b$S=b$y.elements,b$f=b$i.elements,b$V=b$S[0]-b$H[0],b$K=b$S[1]-b$H[1],b$k=b$S[2]-b$H[2],b$X=b$f[0]-b$H[0],b$F=b$f[1]-b$H[1],b$o=b$f[2]-b$H[2],b$d=b$K*b$o-b$k*b$F,b$P=b$k*b$X-b$V*b$o,b$l=b$V*b$F-b$K*b$X,b$J=1/Math.sqrt(b$d*b$d+b$P*b$P+b$l*b$l),b$h=b$d*b$J,b$C=b$P*b$J,b$v=b$l*b$J,b$R=b$G._TEMPVec3.elements;b$R[0]=b$h,b$R[1]=b$C,b$R[2]=b$v;var b$A=-(b$h*b$H[0]+b$C*b$H[1]+b$v*b$H[2]);return new b$G(b$G._TEMPVec3,b$A)},b$G.PlaneIntersectionType_Back=0,b$G.PlaneIntersectionType_Front=1,b$G.PlaneIntersectionType_Intersecting=2,b$o(b$G,["_TEMPVec3",function(){return this._TEMPVec3=new b$Vy}]),b$G}()),b$iy=function(){function b$S(b$M,b$y,b$i,b$H){this.elements=new Float32Array(4),void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=1),this.elements[0]=b$M,this.elements[1]=b$y,this.elements[2]=b$i,this.elements[3]=b$H}b$P(b$S,"laya.d3.math.Quaternion");var b$M=b$S.prototype;return b$G.imps(b$M,{"laya.d3.core.IClone":!0}),b$M.scaling=function(b$M,b$y){var b$i=b$y.elements,b$H=this.elements;b$i[0]=b$H[0]*b$M,b$i[1]=b$H[1]*b$M,b$i[2]=b$H[2]*b$M,b$i[3]=b$H[3]*b$M},b$M.normalize=function(b$M){var b$y=b$M.elements,b$i=this.elements,b$H=b$i[0],b$S=b$i[1],b$f=b$i[2],b$V=b$i[3],b$K=b$H*b$H+b$S*b$S+b$f*b$f+b$V*b$V;0<b$K&&(b$K=1/Math.sqrt(b$K),b$y[0]=b$H*b$K,b$y[1]=b$S*b$K,b$y[2]=b$f*b$K,b$y[3]=b$V*b$K)},b$M.length=function(){var b$M=this.elements,b$y=b$M[0],b$i=b$M[1],b$H=b$M[2],b$S=b$M[3];return Math.sqrt(b$y*b$y+b$i*b$i+b$H*b$H+b$S*b$S)},b$M.rotateX=function(b$M,b$y){var b$i=b$y.elements,b$H=this.elements;b$M*=.5;var b$S=b$H[0],b$f=b$H[1],b$V=b$H[2],b$K=b$H[3],b$k=Math.sin(b$M),b$X=Math.cos(b$M);b$i[0]=b$S*b$X+b$K*b$k,b$i[1]=b$f*b$X+b$V*b$k,b$i[2]=b$V*b$X-b$f*b$k,b$i[3]=b$K*b$X-b$S*b$k},b$M.rotateY=function(b$M,b$y){var b$i=b$y.elements,b$H=this.elements;b$M*=.5;var b$S=b$H[0],b$f=b$H[1],b$V=b$H[2],b$K=b$H[3],b$k=Math.sin(b$M),b$X=Math.cos(b$M);b$i[0]=b$S*b$X-b$V*b$k,b$i[1]=b$f*b$X+b$K*b$k,b$i[2]=b$V*b$X+b$S*b$k,b$i[3]=b$K*b$X-b$f*b$k},b$M.rotateZ=function(b$M,b$y){var b$i=b$y.elements,b$H=this.elements;b$M*=.5;var b$S=b$H[0],b$f=b$H[1],b$V=b$H[2],b$K=b$H[3],b$k=Math.sin(b$M),b$X=Math.cos(b$M);b$i[0]=b$S*b$X+b$f*b$k,b$i[1]=b$f*b$X-b$S*b$k,b$i[2]=b$V*b$X+b$K*b$k,b$i[3]=b$K*b$X-b$V*b$k},b$M.getYawPitchRoll=function(b$M){b$Vy.transformQuat(b$Vy.ForwardRH,this,b$S.TEMPVector31),b$Vy.transformQuat(b$Vy.Up,this,b$S.TEMPVector32);var b$y=b$S.TEMPVector32.elements;b$S.angleTo(b$Vy.ZERO,b$S.TEMPVector31,b$S.TEMPVector33);var b$i=b$S.TEMPVector33.elements;b$i[0]==Math.PI/2?(b$i[1]=b$S.arcTanAngle(b$y[2],b$y[0]),b$i[2]=0):b$i[0]==-Math.PI/2?(b$i[1]=b$S.arcTanAngle(-b$y[2],-b$y[0]),b$i[2]=0):(b$My.createRotationY(-b$i[1],b$S.TEMPMatrix0),b$My.createRotationX(-b$i[0],b$S.TEMPMatrix1),b$Vy.transformCoordinate(b$S.TEMPVector32,b$S.TEMPMatrix0,b$S.TEMPVector32),b$Vy.transformCoordinate(b$S.TEMPVector32,b$S.TEMPMatrix1,b$S.TEMPVector32),b$i[2]=b$S.arcTanAngle(b$y[1],-b$y[0])),b$i[1]<=-Math.PI&&(b$i[1]=Math.PI),b$i[2]<=-Math.PI&&(b$i[2]=Math.PI),b$i[1]>=Math.PI&&b$i[2]>=Math.PI&&(b$i[1]=0,b$i[2]=0,b$i[0]=Math.PI-b$i[0]);var b$H=b$M.elements;b$H[0]=b$i[1],b$H[1]=b$i[0],b$H[2]=b$i[2]},b$M.invert=function(b$M){var b$y=b$M.elements,b$i=this.elements,b$H=b$i[0],b$S=b$i[1],b$f=b$i[2],b$V=b$i[3],b$K=b$H*b$H+b$S*b$S+b$f*b$f+b$V*b$V,b$k=b$K?1/b$K:0;b$y[0]=-b$H*b$k,b$y[1]=-b$S*b$k,b$y[2]=-b$f*b$k,b$y[3]=b$V*b$k},b$M.identity=function(){var b$M=this.elements;b$M[0]=0,b$M[1]=0,b$M[2]=0,b$M[3]=1},b$M.fromArray=function(b$M,b$y){void 0===b$y&&(b$y=0),this.elements[0]=b$M[b$y+0],this.elements[1]=b$M[b$y+1],this.elements[2]=b$M[b$y+2],this.elements[3]=b$M[b$y+3]},b$M.cloneTo=function(b$M){var b$y,b$i,b$H;if((b$i=this.elements)!==(b$H=b$M.elements))for(b$y=0;b$y<4;++b$y)b$H[b$y]=b$i[b$y]},b$M.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$M.equals=function(b$M){var b$y=this.elements,b$i=b$M.elements;return b$OM.nearEqual(b$y[0],b$i[0])&&b$OM.nearEqual(b$y[1],b$i[1])&&b$OM.nearEqual(b$y[2],b$i[2])&&b$OM.nearEqual(b$y[3],b$i[3])},b$M.lengthSquared=function(){var b$M=this.elements[0],b$y=this.elements[1],b$i=this.elements[2],b$H=this.elements[3];return b$M*b$M+b$y*b$y+b$i*b$i+b$H*b$H},b$l(0,b$M,"x",function(){return this.elements[0]}),b$l(0,b$M,"y",function(){return this.elements[1]}),b$l(0,b$M,"z",function(){return this.elements[2]}),b$l(0,b$M,"w",function(){return this.elements[3]}),b$S.createFromYawPitchRoll=function(b$M,b$y,b$i,b$H){var b$S=.5*b$i,b$f=.5*b$y,b$V=.5*b$M,b$K=Math.sin(b$S),b$k=Math.cos(b$S),b$X=Math.sin(b$f),b$F=Math.cos(b$f),b$o=Math.sin(b$V),b$d=Math.cos(b$V),b$P=b$H.elements;b$P[0]=b$d*b$X*b$k+b$o*b$F*b$K,b$P[1]=b$o*b$F*b$k-b$d*b$X*b$K,b$P[2]=b$d*b$F*b$K-b$o*b$X*b$k,b$P[3]=b$d*b$F*b$k+b$o*b$X*b$K},b$S.multiply=function(b$M,b$y,b$i){var b$H=b$M.elements,b$S=b$y.elements,b$f=b$i.elements,b$V=b$H[0],b$K=b$H[1],b$k=b$H[2],b$X=b$H[3],b$F=b$S[0],b$o=b$S[1],b$d=b$S[2],b$P=b$S[3],b$l=b$K*b$d-b$k*b$o,b$J=b$k*b$F-b$V*b$d,b$h=b$V*b$o-b$K*b$F,b$C=b$V*b$F+b$K*b$o+b$k*b$d;b$f[0]=b$V*b$P+b$F*b$X+b$l,b$f[1]=b$K*b$P+b$o*b$X+b$J,b$f[2]=b$k*b$P+b$d*b$X+b$h,b$f[3]=b$X*b$P-b$C},b$S.arcTanAngle=function(b$M,b$y){return 0==b$M?1==b$y?Math.PI/2:-Math.PI/2:0<b$M?Math.atan(b$y/b$M):b$M<0?0<b$y?Math.atan(b$y/b$M)+Math.PI:Math.atan(b$y/b$M)-Math.PI:0},b$S.angleTo=function(b$M,b$y,b$i){b$Vy.subtract(b$y,b$M,b$S.TEMPVector30),b$Vy.normalize(b$S.TEMPVector30,b$S.TEMPVector30),b$i.elements[0]=Math.asin(b$S.TEMPVector30.y),b$i.elements[1]=b$S.arcTanAngle(-b$S.TEMPVector30.z,-b$S.TEMPVector30.x)},b$S.createFromAxisAngle=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements;b$y*=.5;var b$f=Math.sin(b$y);b$H[0]=b$f*b$S[0],b$H[1]=b$f*b$S[1],b$H[2]=b$f*b$S[2],b$H[3]=Math.cos(b$y)},b$S.createFromMatrix3x3=function(b$M,b$y){var b$i,b$H=b$y.elements,b$S=b$M.elements,b$f=b$S[0]+b$S[4]+b$S[8];if(0<b$f)b$i=Math.sqrt(b$f+1),b$H[3]=.5*b$i,b$i=.5/b$i,b$H[0]=(b$S[5]-b$S[7])*b$i,b$H[1]=(b$S[6]-b$S[2])*b$i,b$H[2]=(b$S[1]-b$S[3])*b$i;else{var b$V=0;b$S[4]>b$S[0]&&(b$V=1),b$S[8]>b$S[3*b$V+b$V]&&(b$V=2);var b$K=(b$V+1)%3,b$k=(b$V+2)%3;b$i=Math.sqrt(b$S[3*b$V+b$V]-b$S[3*b$K+b$K]-b$S[3*b$k+b$k]+1),b$H[b$V]=.5*b$i,b$i=.5/b$i,b$H[3]=(b$S[3*b$K+b$k]-b$S[3*b$k+b$K])*b$i,b$H[b$K]=(b$S[3*b$K+b$V]+b$S[3*b$V+b$K])*b$i,b$H[b$k]=(b$S[3*b$k+b$V]+b$S[3*b$V+b$k])*b$i}},b$S.createFromMatrix4x4=function(b$M,b$y){var b$i,b$H,b$S=b$M.elements,b$f=b$y.elements,b$V=b$S[0]+b$S[5]+b$S[10];0<b$V?(b$i=Math.sqrt(b$V+1),b$f[3]=.5*b$i,b$i=.5/b$i,b$f[0]=(b$S[6]-b$S[9])*b$i,b$f[1]=(b$S[8]-b$S[2])*b$i,b$f[2]=(b$S[1]-b$S[4])*b$i):b$S[0]>=b$S[5]&&b$S[0]>=b$S[10]?(b$H=.5/(b$i=Math.sqrt(1+b$S[0]-b$S[5]-b$S[10])),b$f[0]=.5*b$i,b$f[1]=(b$S[1]+b$S[4])*b$H,b$f[2]=(b$S[2]+b$S[8])*b$H,b$f[3]=(b$S[6]-b$S[9])*b$H):b$S[5]>b$S[10]?(b$H=.5/(b$i=Math.sqrt(1+b$S[5]-b$S[0]-b$S[10])),b$f[0]=(b$S[4]+b$S[1])*b$H,b$f[1]=.5*b$i,b$f[2]=(b$S[9]+b$S[6])*b$H,b$f[3]=(b$S[8]-b$S[2])*b$H):(b$H=.5/(b$i=Math.sqrt(1+b$S[10]-b$S[0]-b$S[5])),b$f[0]=(b$S[8]+b$S[2])*b$H,b$f[1]=(b$S[9]+b$S[6])*b$H,b$f[2]=.5*b$i,b$f[3]=(b$S[1]-b$S[4])*b$H)},b$S.slerp=function(b$M,b$y,b$i,b$H){var b$S,b$f,b$V,b$K,b$k,b$X=b$M.elements,b$F=b$y.elements,b$o=b$H.elements,b$d=b$X[0],b$P=b$X[1],b$l=b$X[2],b$J=b$X[3],b$h=b$F[0],b$C=b$F[1],b$v=b$F[2],b$R=b$F[3];return(b$f=b$d*b$h+b$P*b$C+b$l*b$v+b$J*b$R)<0&&(b$f=-b$f,b$h=-b$h,b$C=-b$C,b$v=-b$v,b$R=-b$R),b$k=1e-6<1-b$f?(b$S=Math.acos(b$f),b$V=Math.sin(b$S),b$K=Math.sin((1-b$i)*b$S)/b$V,Math.sin(b$i*b$S)/b$V):(b$K=1-b$i,b$i),b$o[0]=b$K*b$d+b$k*b$h,b$o[1]=b$K*b$P+b$k*b$C,b$o[2]=b$K*b$l+b$k*b$v,b$o[3]=b$K*b$J+b$k*b$R,b$o},b$S.lerp=function(b$M,b$y,b$i,b$H){var b$S=b$H.elements,b$f=b$M.elements,b$V=b$y.elements,b$K=b$f[0],b$k=b$f[1],b$X=b$f[2],b$F=b$f[3];b$S[0]=b$K+b$i*(b$V[0]-b$K),b$S[1]=b$k+b$i*(b$V[1]-b$k),b$S[2]=b$X+b$i*(b$V[2]-b$X),b$S[3]=b$F+b$i*(b$V[3]-b$F)},b$S.add=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y.elements;b$H[0]=b$S[0]+b$f[0],b$H[1]=b$S[1]+b$f[1],b$H[2]=b$S[2]+b$f[2],b$H[3]=b$S[3]+b$f[3]},b$S.dot=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements;return b$i[0]*b$H[0]+b$i[1]*b$H[1]+b$i[2]*b$H[2]+b$i[3]*b$H[3]},b$S.rotationLookAt=function(b$M,b$y,b$i){b$S.lookAt(b$Vy.ZERO,b$M,b$y,b$i)},b$S.lookAt=function(b$M,b$y,b$i,b$H){b$LM.lookAt(b$M,b$y,b$i,b$S._tempMatrix3x3),b$S.rotationMatrix(b$S._tempMatrix3x3,b$H)},b$S.invert=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements,b$S=b$M.lengthSquared();b$OM.isZero(b$S)||(b$S=1/b$S,b$H[0]=-b$i[0]*b$S,b$H[1]=-b$i[1]*b$S,b$H[2]=-b$i[2]*b$S,b$H[3]=b$i[3]*b$S)},b$S.rotationMatrix=function(b$M,b$y){var b$i=b$M.elements,b$H=b$i[0],b$S=b$i[1],b$f=b$i[2],b$V=b$i[3],b$K=b$i[4],b$k=b$i[5],b$X=b$i[6],b$F=b$i[7],b$o=b$i[8],b$d=b$y.elements,b$P=NaN,b$l=NaN,b$J=b$H+b$K+b$o;0<b$J?(b$P=Math.sqrt(b$J+1),b$d[3]=.5*b$P,b$P=.5/b$P,b$d[0]=(b$k-b$F)*b$P,b$d[1]=(b$X-b$f)*b$P,b$d[2]=(b$S-b$V)*b$P):b$K<=b$H&&b$o<=b$H?(b$l=.5/(b$P=Math.sqrt(1+b$H-b$K-b$o)),b$d[0]=.5*b$P,b$d[1]=(b$S+b$V)*b$l,b$d[2]=(b$f+b$X)*b$l,b$d[3]=(b$k-b$F)*b$l):b$o<b$K?(b$l=.5/(b$P=Math.sqrt(1+b$K-b$H-b$o)),b$d[0]=(b$V+b$S)*b$l,b$d[1]=.5*b$P,b$d[2]=(b$F+b$k)*b$l,b$d[3]=(b$X-b$f)*b$l):(b$l=.5/(b$P=Math.sqrt(1+b$o-b$H-b$K)),b$d[0]=(b$X+b$f)*b$l,b$d[1]=(b$F+b$k)*b$l,b$d[2]=.5*b$P,b$d[3]=(b$S-b$V)*b$l)},b$S.DEFAULT=new b$S,b$o(b$S,["TEMPVector30",function(){return this.TEMPVector30=new b$Vy},"TEMPVector31",function(){return this.TEMPVector31=new b$Vy},"TEMPVector32",function(){return this.TEMPVector32=new b$Vy},"TEMPVector33",function(){return this.TEMPVector33=new b$Vy},"TEMPMatrix0",function(){return this.TEMPMatrix0=new b$My},"TEMPMatrix1",function(){return this.TEMPMatrix1=new b$My},"_tempMatrix3x3",function(){return this._tempMatrix3x3=new b$LM},"NAN",function(){return this.NAN=new b$S(NaN,NaN,NaN,NaN)}]),b$S}(),b$Hy=function(){function b$M(b$M){this._temp=new Uint32Array(1),this.seeds=new Uint32Array(4),this.seeds[0]=b$M,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}b$P(b$M,"laya.d3.math.Rand");var b$y=b$M.prototype;return b$y.getUint=function(){return this._temp[0]=this.seeds[0]^this.seeds[0]<<11,this.seeds[0]=this.seeds[1],this.seeds[1]=this.seeds[2],this.seeds[2]=this.seeds[3],this.seeds[3]=this.seeds[3]^this.seeds[3]>>>19^this._temp[0]^this._temp[0]>>>8,this.seeds[3]},b$y.getFloat=function(){return this.getUint(),(8388607&this.seeds[3])*(1/8388607)},b$y.getSignedFloat=function(){return 2*this.getFloat()-1},b$l(0,b$y,"seed",function(){return this.seeds[0]},function(b$M){this.seeds[0]=b$M,this.seeds[1]=1812433253*this.seeds[0]+1,this.seeds[2]=1812433253*this.seeds[1]+1,this.seeds[3]=1812433253*this.seeds[2]+1}),b$M.getFloatFromInt=function(b$M){return 1/8388607*(8388607&b$M)},b$M.getByteFromInt=function(b$M){return(8388607&b$M)>>>15},b$M}(),b$Sy=(function(){function b$S(b$M){if(this._state0U=NaN,this._state0L=NaN,this._state1U=NaN,this._state1L=NaN,!(b$M instanceof Array)||4!==b$M.length)throw new Error("Rand:Seed must be an array with 4 numbers");this._state0U=0|b$M[0],this._state0L=0|b$M[1],this._state1U=0|b$M[2],this._state1L=0|b$M[3]}b$P(b$S,"laya.d3.math.RandX");var b$M=b$S.prototype;b$M.randomint=function(){var b$M=this._state0U,b$y=this._state0L,b$i=this._state1U,b$H=this._state1L,b$S=(b$H>>>0)+(b$y>>>0),b$f=b$i+b$M+(b$S/2>>>31)>>>0,b$V=b$S>>>0,b$K=0,b$k=0;b$K=(b$M^=b$K=b$M<<23|(-512&b$y)>>>9)^(this._state0U=b$i),b$k=(b$y^=b$k=b$y<<23)^(this._state0L=b$H);b$K^=b$M>>>18,b$k^=b$y>>>18|(262143&b$M)<<14;return b$K^=b$i>>>5,b$k^=b$H>>>5|(31&b$i)<<27,this._state1U=b$K,this._state1L=b$k,[b$f,b$V]},b$M.random=function(){var b$M=this.randomint(),b$y=b$M[0],b$i=1023<<20|b$y>>>12,b$H=0|(b$M[1]>>>12|(4095&b$y)<<20);return b$S._CONVERTION_BUFFER.setUint32(0,b$i,!1),b$S._CONVERTION_BUFFER.setUint32(4,b$H,!1),b$Hy._CONVERTION_BUFFER.getFloat64(0,!1)-1},b$o(b$S,["_CONVERTION_BUFFER",function(){return this._CONVERTION_BUFFER=new DataView(new ArrayBuffer(8))},"defaultRand",function(){return this.defaultRand=new b$Hy([0,Date.now()/65536,0,Date.now()%65536])}])}(),function(){function b$M(b$M,b$y){this.origin=null,this.direction=null,this.origin=b$M,this.direction=b$y}return b$P(b$M,"laya.d3.math.Ray"),b$M}()),b$fy=function(){function b$M(b$M,b$y){this.elements=new Float32Array(2),void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0);var b$i=this.elements;b$i[0]=b$M,b$i[1]=b$y}b$P(b$M,"laya.d3.math.Vector2");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y.fromArray=function(b$M,b$y){void 0===b$y&&(b$y=0),this.elements[0]=b$M[b$y+0],this.elements[1]=b$M[b$y+1]},b$y.cloneTo=function(b$M){var b$y=b$M.elements,b$i=this.elements;b$y[0]=b$i[0],b$y[1]=b$i[1]},b$y.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$y,"x",function(){return this.elements[0]},function(b$M){this.elements[0]=b$M}),b$l(0,b$y,"y",function(){return this.elements[1]},function(b$M){this.elements[1]=b$M}),b$M.scale=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements;b$H[0]=b$S[0]*b$y,b$H[1]=b$S[1]*b$y},b$o(b$M,["ZERO",function(){return this.ZERO=new b$M(0,0)},"ONE",function(){return this.ONE=new b$M(1,1)}]),b$M}(),b$Vy=function(){function b$F(b$M,b$y,b$i){this.elements=new Float32Array(3),void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0);var b$H=this.elements;b$H[0]=b$M,b$H[1]=b$y,b$H[2]=b$i}b$P(b$F,"laya.d3.math.Vector3");var b$M=b$F.prototype;return b$G.imps(b$M,{"laya.d3.core.IClone":!0}),b$M.fromArray=function(b$M,b$y){void 0===b$y&&(b$y=0),this.elements[0]=b$M[b$y+0],this.elements[1]=b$M[b$y+1],this.elements[2]=b$M[b$y+2]},b$M.cloneTo=function(b$M){var b$y=b$M.elements,b$i=this.elements;b$y[0]=b$i[0],b$y[1]=b$i[1],b$y[2]=b$i[2]},b$M.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$M.toDefault=function(){this.elements[0]=0,this.elements[1]=0,this.elements[2]=0},b$M.reset=function(b$M,b$y,b$i){this.elements[0]=b$M,this.elements[1]=b$y,this.elements[2]=b$i},b$l(0,b$M,"x",function(){return this.elements[0]},function(b$M){this.elements[0]=b$M}),b$l(0,b$M,"y",function(){return this.elements[1]},function(b$M){this.elements[1]=b$M}),b$l(0,b$M,"z",function(){return this.elements[2]},function(b$M){this.elements[2]=b$M}),b$F.distanceSquared=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements,b$S=b$i[0]-b$H[0],b$f=b$i[1]-b$H[1],b$V=b$i[2]-b$H[2];return b$S*b$S+b$f*b$f+b$V*b$V},b$F.distance=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements,b$S=b$i[0]-b$H[0],b$f=b$i[1]-b$H[1],b$V=b$i[2]-b$H[2];return Math.sqrt(b$S*b$S+b$f*b$f+b$V*b$V)},b$F.min=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y.elements;b$H[0]=Math.min(b$S[0],b$f[0]),b$H[1]=Math.min(b$S[1],b$f[1]),b$H[2]=Math.min(b$S[2],b$f[2])},b$F.max=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y.elements;b$H[0]=Math.max(b$S[0],b$f[0]),b$H[1]=Math.max(b$S[1],b$f[1]),b$H[2]=Math.max(b$S[2],b$f[2])},b$F.transformQuat=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y.elements,b$V=b$S[0],b$K=b$S[1],b$k=b$S[2],b$X=b$f[0],b$F=b$f[1],b$o=b$f[2],b$d=b$f[3],b$P=b$d*b$V+b$F*b$k-b$o*b$K,b$l=b$d*b$K+b$o*b$V-b$X*b$k,b$J=b$d*b$k+b$X*b$K-b$F*b$V,b$h=-b$X*b$V-b$F*b$K-b$o*b$k;b$H[0]=b$P*b$d+b$h*-b$X+b$l*-b$o-b$J*-b$F,b$H[1]=b$l*b$d+b$h*-b$F+b$J*-b$X-b$P*-b$o,b$H[2]=b$J*b$d+b$h*-b$o+b$P*-b$F-b$l*-b$X},b$F.scalarLength=function(b$M){var b$y=b$M.elements,b$i=b$y[0],b$H=b$y[1],b$S=b$y[2];return Math.sqrt(b$i*b$i+b$H*b$H+b$S*b$S)},b$F.scalarLengthSquared=function(b$M){var b$y=b$M.elements,b$i=b$y[0],b$H=b$y[1],b$S=b$y[2];return b$i*b$i+b$H*b$H+b$S*b$S},b$F.normalize=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements,b$S=b$i[0],b$f=b$i[1],b$V=b$i[2],b$K=b$S*b$S+b$f*b$f+b$V*b$V;0<b$K&&(b$K=1/Math.sqrt(b$K),b$H[0]=b$i[0]*b$K,b$H[1]=b$i[1]*b$K,b$H[2]=b$i[2]*b$K)},b$F.multiply=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y.elements;b$H[0]=b$S[0]*b$f[0],b$H[1]=b$S[1]*b$f[1],b$H[2]=b$S[2]*b$f[2]},b$F.scale=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements;b$H[0]=b$S[0]*b$y,b$H[1]=b$S[1]*b$y,b$H[2]=b$S[2]*b$y},b$F.lerp=function(b$M,b$y,b$i,b$H){var b$S=b$H.elements,b$f=b$M.elements,b$V=b$y.elements,b$K=b$f[0],b$k=b$f[1],b$X=b$f[2];b$S[0]=b$K+b$i*(b$V[0]-b$K),b$S[1]=b$k+b$i*(b$V[1]-b$k),b$S[2]=b$X+b$i*(b$V[2]-b$X)},b$F.transformV3ToV3=function(b$M,b$y,b$i){var b$H=b$F._tempVector4;b$F.transformV3ToV4(b$M,b$y,b$H);var b$S=b$H.elements,b$f=b$i.elements;b$f[0]=b$S[0],b$f[1]=b$S[1],b$f[2]=b$S[2]},b$F.transformV3ToV4=function(b$M,b$y,b$i){var b$H=b$M.elements,b$S=b$H[0],b$f=b$H[1],b$V=b$H[2],b$K=b$y.elements,b$k=b$i.elements;b$k[0]=b$S*b$K[0]+b$f*b$K[4]+b$V*b$K[8]+b$K[12],b$k[1]=b$S*b$K[1]+b$f*b$K[5]+b$V*b$K[9]+b$K[13],b$k[2]=b$S*b$K[2]+b$f*b$K[6]+b$V*b$K[10]+b$K[14],b$k[3]=b$S*b$K[3]+b$f*b$K[7]+b$V*b$K[11]+b$K[15]},b$F.TransformNormal=function(b$M,b$y,b$i){var b$H=b$M.elements,b$S=b$H[0],b$f=b$H[1],b$V=b$H[2],b$K=b$y.elements,b$k=b$i.elements;b$k[0]=b$S*b$K[0]+b$f*b$K[4]+b$V*b$K[8],b$k[1]=b$S*b$K[1]+b$f*b$K[5]+b$V*b$K[9],b$k[2]=b$S*b$K[2]+b$f*b$K[6]+b$V*b$K[10]},b$F.transformCoordinate=function(b$M,b$y,b$i){var b$H=b$F._tempVector4.elements,b$S=b$M.elements,b$f=b$S[0],b$V=b$S[1],b$K=b$S[2],b$k=b$y.elements;b$H[0]=b$f*b$k[0]+b$V*b$k[4]+b$K*b$k[8]+b$k[12],b$H[1]=b$f*b$k[1]+b$V*b$k[5]+b$K*b$k[9]+b$k[13],b$H[2]=b$f*b$k[2]+b$V*b$k[6]+b$K*b$k[10]+b$k[14],b$H[3]=1/(b$f*b$k[3]+b$V*b$k[7]+b$K*b$k[11]+b$k[15]);var b$X=b$i.elements;b$X[0]=b$H[0]*b$H[3],b$X[1]=b$H[1]*b$H[3],b$X[2]=b$H[2]*b$H[3]},b$F.Clamp=function(b$M,b$y,b$i,b$H){var b$S=b$M.elements,b$f=b$S[0],b$V=b$S[1],b$K=b$S[2],b$k=b$y.elements,b$X=b$k[0],b$F=b$k[1],b$o=b$k[2],b$d=b$i.elements,b$P=b$d[0],b$l=b$d[1],b$J=b$d[2],b$h=b$H.elements;b$f=(b$f=b$P<b$f?b$P:b$f)<b$X?b$X:b$f,b$V=(b$V=b$l<b$V?b$l:b$V)<b$F?b$F:b$V,b$K=(b$K=b$J<b$K?b$J:b$K)<b$o?b$o:b$K,b$h[0]=b$f,b$h[1]=b$V,b$h[2]=b$K},b$F.add=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y.elements;b$H[0]=b$S[0]+b$f[0],b$H[1]=b$S[1]+b$f[1],b$H[2]=b$S[2]+b$f[2]},b$F.subtract=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y.elements;b$H[0]=b$S[0]-b$f[0],b$H[1]=b$S[1]-b$f[1],b$H[2]=b$S[2]-b$f[2]},b$F.cross=function(b$M,b$y,b$i){var b$H=b$M.elements,b$S=b$y.elements,b$f=b$i.elements,b$V=b$H[0],b$K=b$H[1],b$k=b$H[2],b$X=b$S[0],b$F=b$S[1],b$o=b$S[2];b$f[0]=b$K*b$o-b$k*b$F,b$f[1]=b$k*b$X-b$V*b$o,b$f[2]=b$V*b$F-b$K*b$X},b$F.dot=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements;return b$i[0]*b$H[0]+b$i[1]*b$H[1]+b$i[2]*b$H[2]},b$F.equals=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements;return b$OM.nearEqual(Math.abs(b$i[0]),Math.abs(b$H[0]))&&b$OM.nearEqual(Math.abs(b$i[1]),Math.abs(b$H[1]))&&b$OM.nearEqual(Math.abs(b$i[2]),Math.abs(b$H[2]))},b$F.ZERO=new b$F(0,0,0),b$F.ONE=new b$F(1,1,1),b$F.NegativeUnitX=new b$F(-1,0,0),b$F.UnitX=new b$F(1,0,0),b$F.UnitY=new b$F(0,1,0),b$F.UnitZ=new b$F(0,0,1),b$F.ForwardRH=new b$F(0,0,-1),b$F.ForwardLH=new b$F(0,0,1),b$F.Up=new b$F(0,1,0),b$F.NAN=new b$F(NaN,NaN,NaN),b$o(b$F,["_tempVector4",function(){return this._tempVector4=new b$Ky}]),b$F}(),b$Ky=function(){function b$M(b$M,b$y,b$i,b$H){this.elements=new Float32Array(4),void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=0);var b$S=this.elements;b$S[0]=b$M,b$S[1]=b$y,b$S[2]=b$i,b$S[3]=b$H}b$P(b$M,"laya.d3.math.Vector4");var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y.fromArray=function(b$M,b$y){void 0===b$y&&(b$y=0),this.elements[0]=b$M[b$y+0],this.elements[1]=b$M[b$y+1],this.elements[2]=b$M[b$y+2],this.elements[3]=b$M[b$y+3]},b$y.cloneTo=function(b$M){var b$y=b$M.elements,b$i=this.elements;b$y[0]=b$i[0],b$y[1]=b$i[1],b$y[2]=b$i[2],b$y[3]=b$i[3]},b$y.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$y.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},b$y.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},b$l(0,b$y,"x",function(){return this.elements[0]},function(b$M){this.elements[0]=b$M}),b$l(0,b$y,"y",function(){return this.elements[1]},function(b$M){this.elements[1]=b$M}),b$l(0,b$y,"z",function(){return this.elements[2]},function(b$M){this.elements[2]=b$M}),b$l(0,b$y,"w",function(){return this.elements[3]},function(b$M){this.elements[3]=b$M}),b$M.lerp=function(b$M,b$y,b$i,b$H){var b$S=b$H.elements,b$f=b$M.elements,b$V=b$y.elements,b$K=b$f[0],b$k=b$f[1],b$X=b$f[2],b$F=b$f[3];b$S[0]=b$K+b$i*(b$V[0]-b$K),b$S[1]=b$k+b$i*(b$V[1]-b$k),b$S[2]=b$X+b$i*(b$V[2]-b$X),b$S[3]=b$F+b$i*(b$V[3]-b$F)},b$M.transformByM4x4=function(b$M,b$y,b$i){var b$H=b$M.elements,b$S=b$H[0],b$f=b$H[1],b$V=b$H[2],b$K=b$H[3],b$k=b$y.elements,b$X=b$i.elements;b$X[0]=b$S*b$k[0]+b$f*b$k[4]+b$V*b$k[8]+b$K*b$k[12],b$X[1]=b$S*b$k[1]+b$f*b$k[5]+b$V*b$k[9]+b$K*b$k[13],b$X[2]=b$S*b$k[2]+b$f*b$k[6]+b$V*b$k[10]+b$K*b$k[14],b$X[3]=b$S*b$k[3]+b$f*b$k[7]+b$V*b$k[11]+b$K*b$k[15]},b$M.equals=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements;return b$OM.nearEqual(Math.abs(b$i[0]),Math.abs(b$H[0]))&&b$OM.nearEqual(Math.abs(b$i[1]),Math.abs(b$H[1]))&&b$OM.nearEqual(Math.abs(b$i[2]),Math.abs(b$H[2]))&&b$OM.nearEqual(Math.abs(b$i[3]),Math.abs(b$H[3]))},b$M.normalize=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements,b$S=b$M.length();0<b$S&&(b$H[0]=b$i[0]*b$S,b$H[1]=b$i[1]*b$S,b$H[2]=b$i[2]*b$S,b$H[3]=b$i[3]*b$S)},b$M.add=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y.elements;b$H[0]=b$S[0]+b$f[0],b$H[1]=b$S[1]+b$f[1],b$H[2]=b$S[2]+b$f[2],b$H[3]=b$S[3]+b$f[3]},b$M.subtract=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y.elements;b$H[0]=b$S[0]-b$f[0],b$H[1]=b$S[1]-b$f[1],b$H[2]=b$S[2]-b$f[2],b$H[3]=b$S[3]-b$f[3]},b$M.multiply=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y.elements;b$H[0]=b$S[0]*b$f[0],b$H[1]=b$S[1]*b$f[1],b$H[2]=b$S[2]*b$f[2],b$H[3]=b$S[3]*b$f[3]},b$M.scale=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements;b$H[0]=b$S[0]*b$y,b$H[1]=b$S[1]*b$y,b$H[2]=b$S[2]*b$y,b$H[3]=b$S[3]*b$y},b$M.Clamp=function(b$M,b$y,b$i,b$H){var b$S=b$M.elements,b$f=b$S[0],b$V=b$S[1],b$K=b$S[2],b$k=b$S[3],b$X=b$y.elements,b$F=b$X[0],b$o=b$X[1],b$d=b$X[2],b$P=b$X[3],b$l=b$i.elements,b$J=b$l[0],b$h=b$l[1],b$C=b$l[2],b$v=b$l[3],b$R=b$H.elements;b$f=(b$f=b$J<b$f?b$J:b$f)<b$F?b$F:b$f,b$V=(b$V=b$h<b$V?b$h:b$V)<b$o?b$o:b$V,b$K=(b$K=b$C<b$K?b$C:b$K)<b$d?b$d:b$K,b$k=(b$k=b$v<b$k?b$v:b$k)<b$P?b$P:b$k,b$R[0]=b$f,b$R[1]=b$V,b$R[2]=b$K,b$R[3]=b$k},b$M.distanceSquared=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements,b$S=b$i[0]-b$H[0],b$f=b$i[1]-b$H[1],b$V=b$i[2]-b$H[2],b$K=b$i[3]-b$H[3];return b$S*b$S+b$f*b$f+b$V*b$V+b$K*b$K},b$M.distance=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements,b$S=b$i[0]-b$H[0],b$f=b$i[1]-b$H[1],b$V=b$i[2]-b$H[2],b$K=b$i[3]-b$H[3];return Math.sqrt(b$S*b$S+b$f*b$f+b$V*b$V+b$K*b$K)},b$M.dot=function(b$M,b$y){var b$i=b$M.elements,b$H=b$y.elements;return b$i[0]*b$H[0]+b$i[1]*b$H[1]+b$i[2]*b$H[2]+b$i[3]*b$H[3]},b$M.min=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y.elements;b$H[0]=Math.min(b$S[0],b$f[0]),b$H[1]=Math.min(b$S[1],b$f[1]),b$H[2]=Math.min(b$S[2],b$f[2]),b$H[3]=Math.min(b$S[3],b$f[3])},b$M.max=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y.elements;b$H[0]=Math.max(b$S[0],b$f[0]),b$H[1]=Math.max(b$S[1],b$f[1]),b$H[2]=Math.max(b$S[2],b$f[2]),b$H[3]=Math.max(b$S[3],b$f[3])},b$o(b$M,["ZERO",function(){return this.ZERO=new b$M},"ONE",function(){return this.ONE=new b$M(1,1,1,1)},"UnitX",function(){return this.UnitX=new b$M(1,0,0,0)},"UnitY",function(){return this.UnitY=new b$M(0,1,0,0)},"UnitZ",function(){return this.UnitZ=new b$M(0,0,1,0)},"UnitW",function(){return this.UnitW=new b$M(0,0,0,1)}]),b$M}(),b$ky=function(){function b$f(b$M,b$y,b$i,b$H){this.minDepth=0,this.maxDepth=1,this.x=b$M,this.y=b$y,this.width=b$i,this.height=b$H}b$P(b$f,"laya.d3.math.Viewport");var b$M=b$f.prototype;return b$M.project=function(b$M,b$y,b$i){b$Vy.transformV3ToV3(b$M,b$y,b$i);var b$H=b$M.elements,b$S=b$y.elements,b$f=b$i.elements,b$V=b$H[0]*b$S[3]+b$H[1]*b$S[7]+b$H[2]*b$S[11]+b$S[15];1!==b$V&&(b$f[0]=b$f[0]/b$V,b$f[1]=b$f[1]/b$V,b$f[2]=b$f[2]/b$V),b$f[0]=.5*(b$f[0]+1)*this.width+this.x,b$f[1]=.5*(1-b$f[1])*this.height+this.y,b$f[2]=b$f[2]*(this.maxDepth-this.minDepth)+this.minDepth},b$M.unprojectFromMat=function(b$M,b$y,b$i){var b$H=b$M.elements,b$S=b$y.elements,b$f=b$i.elements;b$f[0]=(b$H[0]-this.x)/this.width*2-1,b$f[1]=-((b$H[1]-this.y)/this.height*2-1);var b$V=(this.maxDepth-this.minDepth)/2;b$f[2]=(b$H[2]-this.minDepth-b$V)/b$V;var b$K=b$f[0]*b$S[3]+b$f[1]*b$S[7]+b$f[2]*b$S[11]+b$S[15];b$Vy.transformV3ToV3(b$i,b$y,b$i),1!==b$K&&(b$f[0]=b$f[0]/b$K,b$f[1]=b$f[1]/b$K,b$f[2]=b$f[2]/b$K)},b$M.unprojectFromWVP=function(b$M,b$y,b$i,b$H,b$S){b$My.multiply(b$y,b$i,b$f._tempMatrix4x4),b$H&&b$My.multiply(b$f._tempMatrix4x4,b$H,b$f._tempMatrix4x4),b$f._tempMatrix4x4.invert(b$f._tempMatrix4x4),this.unprojectFromMat(b$M,b$f._tempMatrix4x4,b$S)},b$o(b$f,["_tempMatrix4x4",function(){return this._tempMatrix4x4=new b$My}]),b$f}(),b$Xy=function(){function b$a(b$M){this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._indexInMesh=0,this._vertexBuffer=null,this._vertexStart=0,this._vertexCount=0,this._indexBuffer=null,this._indexStart=0,this._indexCount=0,this._indices=null,this._bufferUsage={},this._mesh=b$M,this._boneIndicesList=[],this._subIndexBufferStart=[],this._subIndexBufferCount=[]}b$P(b$a,"laya.d3.resource.models.SubMesh");var b$M=b$a.prototype;return b$G.imps(b$M,{"laya.d3.core.render.IRenderable":!0,"laya.resource.IDispose":!0}),b$M._getVertexBuffer=function(b$M){return void 0===b$M&&(b$M=0),0===b$M?this._vertexBuffer:null},b$M._getIndexBuffer=function(){return this._indexBuffer},b$M._getStaticBatchBakedVertexs=function(b$M,b$y){var b$i,b$H,b$S=this._vertexBuffer,b$f=b$S.vertexDeclaration,b$V=b$f.getVertexElementByUsage(0).offset/4,b$K=b$f.getVertexElementByUsage(3).offset/4,b$k=b$y.meshRender.lightmapScaleOffset,b$X=0,b$F=0,b$o=0,b$d=0,b$P=0,b$l=0;if(b$k)if(b$H=b$f.getVertexElementByUsage(15))b$o=b$f.vertexStride/4,b$i=0<this._vertexCount?b$S.getData().slice(this._vertexStart*b$o,(this._vertexStart+this._vertexCount)*b$o):b$S.getData().slice(),b$d=b$H.offset/4;else{b$o=(b$l=b$f.vertexStride/4)+2,b$i=this._vertexCount?new Float32Array(this._vertexCount*(b$S.vertexDeclaration.vertexStride/4+2)):new Float32Array(b$S.vertexCount*(b$S.vertexDeclaration.vertexStride/4+2)),b$d=(b$P=b$f.getVertexElementByUsage(2).offset/4)+2;var b$J=b$S.getData();for(b$X=0,b$F=b$J.length/b$l;b$X<b$F;b$X++){var b$h=0;b$h=0<this._vertexCount?(this._vertexStart+b$X)*b$l:b$X*b$l;var b$C=b$X*b$o,b$v=0;for(b$v=0;b$v<b$d;b$v++)b$i[b$C+b$v]=b$J[b$h+b$v];for(b$v=b$d;b$v<b$l;b$v++)b$i[b$C+b$v+2]=b$J[b$h+b$v]}}else b$o=b$f.vertexStride/4,b$i=this._vertexCount?b$S.getData().slice(this._vertexStart*b$o,(this._vertexStart+this._vertexCount)*b$o):b$S.getData().slice();if(b$M){var b$R=b$M.worldMatrix,b$A=b$a._tempMatrix4x40;b$R.invert(b$A);var b$G=b$a._tempMatrix4x41,b$I=b$y.transform.worldMatrix;b$My.multiply(b$A,b$I,b$G)}else b$G=b$y.transform.worldMatrix;var b$U=b$a._tempQuaternion0;for(b$G.decomposeTransRotScale(b$a._tempVector30,b$U,b$a._tempVector31),b$X=0,b$F=b$i.length/b$o;b$X<b$F;b$X++){var b$Q=b$X*b$o+b$V,b$W=b$X*b$o+b$K;if(b$hy.transformVector3ArrayToVector3ArrayCoordinate(b$i,b$Q,b$G,b$i,b$Q),b$hy.transformVector3ArrayByQuat(b$i,b$W,b$U,b$i,b$W),b$k){var b$c=b$X*b$o+b$d;if(b$H)b$hy.transformLightingMapTexcoordByUV1Array(b$i,b$c,b$k,b$i,b$c);else{var b$n=b$X*b$l+b$P;b$hy.transformLightingMapTexcoordByUV0Array(b$J,b$n,b$k,b$i,b$c)}}}return b$i},b$M._getVertexBuffers=function(){return null},b$M._beforeRender=function(b$M){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},b$M._render=function(b$M){var b$y,b$i=0,b$H=b$M.renderElement;if(1<this._indexCount){var b$S=this._boneIndicesList.length;if(1<b$S){for(var b$f=0;b$f<b$S;b$f++)(b$y=b$H._skinAnimationDatas||this._skinAnimationDatas)&&(b$H._shaderValue.setValue(0,b$y[b$f]),b$M._shader.uploadRenderElementUniforms(b$H._shaderValue.data)),b$T.mainContext.drawElements(4,this._subIndexBufferCount[b$f],5123,2*this._subIndexBufferStart[b$f]);b$Q.drawCall+=b$S}else(b$y=b$H._skinAnimationDatas||this._skinAnimationDatas)&&(b$H._shaderValue.setValue(0,b$y[0]),b$M._shader.uploadRenderElementUniforms(b$H._shaderValue.data)),b$T.mainContext.drawElements(4,this._indexCount,5123,2*this._indexStart),b$Q.drawCall++;b$i=this._indexCount}else b$i=this._indexBuffer.indexCount,(b$y=b$H._skinAnimationDatas||this._skinAnimationDatas)&&(b$H._shaderValue.setValue(0,b$y[0]),b$M._shader.uploadRenderElementUniforms(b$H._shaderValue.data)),b$T.mainContext.drawElements(4,b$i,5123,0),b$Q.drawCall++;b$Q.trianglesFaces+=b$i/3},b$M.getIndices=function(){return 0<this._indexCount?this._indices:this._indexBuffer.getData()},b$M.dispose=function(){this._indexBuffer.destroy(),this._vertexBuffer.destroy(),this._mesh=null,this._boneIndicesList=null,this._subIndexBufferStart=null,this._subIndexBufferCount=null,this._skinAnimationDatas=null,this._bufferUsage=null,this._vertexBuffer=null,this._indexBuffer=null},b$l(0,b$M,"_vertexBufferCount",function(){return 1}),b$l(0,b$M,"triangleCount",function(){return this._indexBuffer.indexCount/3}),b$o(b$a,["_tempVector30",function(){return this._tempVector30=new b$Vy},"_tempVector31",function(){return this._tempVector31=new b$Vy},"_tempQuaternion0",function(){return this._tempQuaternion0=new b$iy},"_tempMatrix4x40",function(){return this._tempMatrix4x40=new b$My},"_tempMatrix4x41",function(){return this._tempMatrix4x41=new b$My}]),b$a}(),b$Fy=function(){function b$M(b$M){this.defineCounter=0,this.defines=null,b$M?(this.defineCounter=b$M.defineCounter,this.defines=b$M.defines.slice()):(this.defineCounter=0,this.defines=[])}return b$P(b$M,"laya.d3.shader.ShaderDefines",null,"ShaderDefines$1"),b$M.prototype.registerDefine=function(b$M){var b$y=Math.pow(2,this.defineCounter++);return this.defines[b$y]=b$M,b$y},b$M}(),b$oy=function(){function b$M(){}return b$P(b$M,"laya.d3.shader.ShaderInit3D"),b$M.__init__=function(){var b$M,b$y;b$Qy._globalRegDefine("HIGHPRECISION",b$Qy.SHADERDEFINE_HIGHPRECISION),b$Qy._globalRegDefine("FOG",b$Qy.SHADERDEFINE_FOG),b$Qy._globalRegDefine("DIRECTIONLIGHT",b$Qy.SHADERDEFINE_DIRECTIONLIGHT),b$Qy._globalRegDefine("POINTLIGHT",b$Qy.SHADERDEFINE_POINTLIGHT),b$Qy._globalRegDefine("SPOTLIGHT",b$Qy.SHADERDEFINE_SPOTLIGHT),b$Qy._globalRegDefine("UV",b$Qy.SHADERDEFINE_UV0),b$Qy._globalRegDefine("COLOR",b$Qy.SHADERDEFINE_COLOR),b$Qy._globalRegDefine("UV1",b$Qy.SHADERDEFINE_UV1),b$Qy._globalRegDefine("CASTSHADOW",b$Py.SHADERDEFINE_CAST_SHADOW),b$Qy._globalRegDefine("SHADOWMAP_PSSM1",b$Py.SHADERDEFINE_SHADOW_PSSM1),b$Qy._globalRegDefine("SHADOWMAP_PSSM2",b$Py.SHADERDEFINE_SHADOW_PSSM2),b$Qy._globalRegDefine("SHADOWMAP_PSSM3",b$Py.SHADERDEFINE_SHADOW_PSSM3),b$Qy._globalRegDefine("SHADOWMAP_PCF_NO",b$Py.SHADERDEFINE_SHADOW_PCF_NO),b$Qy._globalRegDefine("SHADOWMAP_PCF1",b$Py.SHADERDEFINE_SHADOW_PCF1),b$Qy._globalRegDefine("SHADOWMAP_PCF2",b$Py.SHADERDEFINE_SHADOW_PCF2),b$Qy._globalRegDefine("SHADOWMAP_PCF3",b$Py.SHADERDEFINE_SHADOW_PCF3),b$Qy._globalRegDefine("DEPTHFOG",b$Qy.SAHDERDEFINE_DEPTHFOG),b$wy.addInclude("LightHelper.glsl","\nstruct DirectionLight\n{\n vec3 Direction;\n vec3 Diffuse;\n};\n\nstruct PointLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n float Range;\n};\n\nstruct SpotLight\n{\n vec3 Diffuse;\n vec3 Attenuation;\n vec3 Position;\n vec3 Direction;\n float Spot;\n float Range;\n};\n\n\nvec3 NormalSampleToWorldSpace(vec3 normalMapSample, vec3 unitNormal, vec3 tangent)\n{\n\tvec3 normalT = 2.0*normalMapSample - 1.0;\n\n\t// Build orthonormal basis.\n\tvec3 N = normalize(unitNormal);\n\tvec3 T = normalize(tangent- dot(tangent, N)*N);\n\tvec3 B = cross(T, N);\n\n\tmat3 TBN = mat3(T, B, N);\n\n\t// Transform from tangent space to world space.\n\tvec3 bumpedNormal = TBN*normalT;\n\n\treturn bumpedNormal;\n}\n\n\nvoid  computeDirectionLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in DirectionLight dirLight,in vec3 ambinentColor,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);//不初始化在IOS中闪烁，PC中不会闪烁\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec=-normalize(dirLight.Direction);\n\t\n\tamb=matAmb*ambinentColor;\n\t\n\tfloat  diffuseFactor=dot(lightVec, normal);\n\t\n\tif(diffuseFactor>0.0)\n\t{\n\t   vec3 v = reflect(-lightVec, normal);\n\t   float specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t   \n\t   dif = diffuseFactor * matDif * dirLight.Diffuse;\n\t   spec = specFactor * matSpe.rgb;\n\t}\n\t\n}\n\nvoid computePointLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in PointLight poiLight,in vec3 ambinentColor, in vec3 pos,in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tdif=vec3(0.0);\n\tamb=vec3(0.0);\n\tspec=vec3(0.0);\n\tvec3 lightVec = poiLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > poiLight.Range )\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif( diffuseFactor > 0.0 )\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * poiLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\n\tfloat attenuate = 1.0 / dot(poiLight.Attenuation, vec3(1.0, d, d*d));\n\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\nvoid ComputeSpotLight(in vec3 matDif,in vec3 matAmb,in vec4 matSpe,in SpotLight spoLight,in vec3 ambinentColor,in vec3 pos, in vec3 normal,in vec3 toEye,out vec3 dif,out vec3 amb,out vec3 spec)\n{\n\tamb = vec3(0.0);\n\tdif =vec3(0.0);\n\tspec= vec3(0.0);\n\tvec3 lightVec = spoLight.Position - pos;\n\t\t\n\tfloat d = length(lightVec);\n\t\n\tif( d > spoLight.Range)\n\t\treturn;\n\t\t\n\tlightVec /= d; \n\t\n\tamb = matAmb*ambinentColor;\t\n\n\tfloat diffuseFactor = dot(lightVec, normal);\n\n\tif(diffuseFactor > 0.0)\n\t{\n\t\tvec3 v= reflect(-lightVec, normal);\n\t\tfloat specFactor = pow(max(dot(v, toEye), 0.0), matSpe.w);\n\t\t\t\t\t\n\t\tdif = diffuseFactor * matDif * spoLight.Diffuse;\n\t\tspec = specFactor * matSpe.rgb;\n\t}\n\t\n\tfloat spot = pow(max(dot(-lightVec, normalize(spoLight.Direction)), 0.0), spoLight.Spot);\n\n\tfloat attenuate = spot/dot(spoLight.Attenuation, vec3(1.0, d, d*d));\n\n\tamb *= spot;\n\tdif *= attenuate;\n\tspec*= attenuate;\n}\n\n"),b$wy.addInclude("ShadowHelper.glsl","uniform sampler2D u_shadowMap1;\nuniform sampler2D u_shadowMap2;\nuniform sampler2D u_shadowMap3;\nuniform vec2\t  u_shadowPCFoffset;\nuniform vec4     u_shadowPSSMDistance;\nvec4 packDepth(const in float depth)\n{\n\tconst vec4 bitShift = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\n\tconst vec4 bitMask\t= vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);\n\tvec4 res = mod(depth*bitShift*vec4(255), vec4(256))/vec4(255);\n\tres -= res.xxyz * bitMask;\n\treturn res;\n}\nfloat unpackDepth(const in vec4 rgbaDepth)\n{\n\tconst vec4 bitShift = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);\n\tfloat depth = dot(rgbaDepth, bitShift);\n\treturn depth;\n}\nfloat tex2DPCF( sampler2D shadowMap,vec2 texcoord,vec2 invsize,float zRef )\n{\n\tvec2 texelpos =texcoord / invsize;\n\tvec2 lerps = fract( texelpos );\n\tfloat sourcevals[4];\n\tsourcevals[0] = float( unpackDepth(texture2D(shadowMap,texcoord)) > zRef );\n\tsourcevals[1] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x,0))) > zRef );\n\tsourcevals[2] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(0,invsize.y))) > zRef );\n\tsourcevals[3] = float( unpackDepth(texture2D(shadowMap,texcoord + vec2(invsize.x, invsize.y) )) > zRef );\n\treturn mix( mix(sourcevals[0],sourcevals[2],lerps.y),mix(sourcevals[1],sourcevals[3],lerps.y),lerps.x );\n}\nfloat getShadowPSSM3( sampler2D shadowMap1,sampler2D shadowMap2,sampler2D shadowMap3,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\tnPSNum += int(posViewZ>pssmDistance.z);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\telse if( nPSNum == 2 )\n\t{\n\t\tlightVP = lightShadowVP[3];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t} \n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap3,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 2 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap3,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM2( sampler2D shadowMap1,sampler2D shadowMap2,mat4 lightShadowVP[4],vec4 pssmDistance,vec2 shadowPCFOffset,vec3 worldPos,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tint nPSNum = int(posViewZ>pssmDistance.x);\n\tnPSNum += int(posViewZ>pssmDistance.y);\n\t//真SB,webgl不支持在PS中直接访问数组\n\tmat4 lightVP;\n\tif( nPSNum == 0 )\n\t{\n\t\tlightVP = lightShadowVP[1];\n\t}\n\telse if( nPSNum == 1 )\n\t{\n\t\tlightVP = lightShadowVP[2];\n\t}\n\tvec4 vLightMVPPos = lightVP * vec4(worldPos,1.0);\n\t//为了效率，在CPU计算/2.0 + 0.5\n\t//vec3 vText = (vLightMVPPos.xyz / vLightMVPPos.w)/2.0 + 0.5;\n\tvec3 vText = vLightMVPPos.xyz / vLightMVPPos.w;\n\tfloat fMyZ = vText.z - zBias;\n\t/*\n\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\tbool bInFrustum = all( bInFrustumVec );\n\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\tbool bFrustumTest = all( bFrustumTestVec );\n\tif ( bFrustumTest ) \n\t*/\n\tif( fMyZ <= 1.0 )\n\t{\n\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,\tfMyZ );\n\t\t\tvalue = value/4.0;\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF2\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap2,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tvec4 color = texture2D( shadowMap2,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n\t\t}\n#endif\n#ifdef SHADOWMAP_PCF_NO\n\t\tvec4 color;\n\t\tif ( nPSNum == 0 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap1,vText.xy );\n\t\t}\n\t\telse if( nPSNum == 1 )\n\t\t{\n\t\t\tcolor = texture2D( shadowMap2,vText.xy );\n\t\t}\n\t\tzdepth = unpackDepth(color);\n\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t}\n\treturn value;\n}\nfloat getShadowPSSM1( sampler2D shadowMap1,vec4 lightMVPPos,vec4 pssmDistance,vec2 shadowPCFOffset,float posViewZ,float zBias )\n{\n\tfloat value = 1.0;\n\tif( posViewZ < pssmDistance.x )\n\t{\n\t\tvec3 vText = lightMVPPos.xyz / lightMVPPos.w;\n\t\tfloat fMyZ = vText.z - zBias;\n\t\t/*\n\t\tbvec4 bInFrustumVec = bvec4 ( vText.x >= 0.0, vText.x <= 1.0, vText.y >= 0.0, vText.y <= 1.0 );\n\t\tbool bInFrustum = all( bInFrustumVec );\n\t\tbvec2 bFrustumTestVec = bvec2( bInFrustum, fMyZ <= 1.0 );\n\t\tbool bFrustumTest = all( bFrustumTestVec );\n\t\t*/\n\t\tif ( fMyZ <= 1.0 ) \n\t\t{\n\t\t\tfloat zdepth=0.0;\n#ifdef SHADOWMAP_PCF3\n\t\t\tvalue =  tex2DPCF( shadowMap1, vText.xy,shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.xy),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(shadowPCFOffset.x,0),shadowPCFOffset,fMyZ );\n\t\t\tvalue += tex2DPCF( shadowMap1, vText.xy+vec2(0,shadowPCFOffset.y),shadowPCFOffset,fMyZ );\n\t\t\tvalue = value/4.0;\n#endif\n#ifdef SHADOWMAP_PCF2\t\t\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF1\n\t\t\tvalue = tex2DPCF( shadowMap1,vText.xy,shadowPCFOffset,fMyZ);\n#endif\n#ifdef SHADOWMAP_PCF_NO\t\t\n\t\t\tvec4 color = texture2D( shadowMap1,vText.xy );\n\t\t\tzdepth = unpackDepth(color);\n\t\t\tvalue = float(fMyZ < zdepth);\n#endif\n\t\t}\n\t}\n\treturn value;\n}"),b$M={a_Position:0,a_Color:1,a_Normal:3,a_Texcoord0:2,a_Texcoord1:15,a_TexcoordNext0:14,a_BoneWeights:7,a_BoneIndices:6,a_Tangent0:5},b$y={u_Bones:[0,0],u_DiffuseTexture:[1,1],u_SpecularTexture:[3,1],u_NormalTexture:[2,1],u_AmbientTexture:[5,1],u_ReflectTexture:[6,1],u_AlphaTestValue:[0,1],u_Albedo:[7,1],u_UVMatrix:[13,1],u_UVAge:[14,1],u_UVAniAge:[8,1],u_MaterialDiffuse:[10,1],u_MaterialAmbient:[9,1],u_MaterialSpecular:[11,1],u_MaterialReflect:[12,1],u_TilingOffset:[15,1],u_WorldMat:[0,2],u_MvpMatrix:[1,2],u_LightmapScaleOffset:[2,2],u_LightMap:[3,2],u_CameraPos:[0,3],u_FogStart:[1,4],u_FogRange:[2,4],u_FogColor:[0,4],"u_DirectionLight.Direction":[3,4],"u_DirectionLight.Diffuse":[4,4],"u_PointLight.Position":[5,4],"u_PointLight.Range":[6,4],"u_PointLight.Attenuation":[7,4],"u_PointLight.Diffuse":[8,4],"u_SpotLight.Position":[9,4],"u_SpotLight.Direction":[10,4],"u_SpotLight.Range":[12,4],"u_SpotLight.Spot":[11,4],"u_SpotLight.Attenuation":[13,4],"u_SpotLight.Diffuse":[14,4],u_AmbientColor:[21,4],u_shadowMap1:[18,4],u_shadowMap2:[19,4],u_shadowMap3:[20,4],u_shadowPSSMDistance:[15,4],u_lightShadowVP:[16,4],u_shadowPCFoffset:[17,4]};var b$i=b$wy.nameKey.add("SIMPLE");shaderCompile=b$Qy.add(b$i,"attribute vec4 a_Position;\nuniform mat4 u_MvpMatrix;\n\n\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))||(defined(LIGHTMAP)&&defined(UV))\nattribute vec2 a_Texcoord0;\nvarying vec2 v_Texcoord0;\n  #ifdef UVTRANSFORM \n  uniform mat4 u_UVMatrix;\n  #endif\n#endif\n\n#if defined(AMBIENTMAP)||(defined(LIGHTMAP)&&defined(UV1))\nattribute vec2 a_Texcoord1;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec4 u_LightmapScaleOffset;\nvarying vec2 v_LightMapUV;\n#endif\n\n\n#ifdef COLOR\nattribute vec4 a_Color;\nvarying vec4 v_Color;\n#endif\n\n#ifdef BONE\nattribute vec4 a_BoneIndices;\nattribute vec4 a_BoneWeights;\nconst int c_MaxBoneCount = 24;\nuniform mat4 u_Bones[c_MaxBoneCount];\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nattribute vec3 a_Normal;\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP))&&defined(NORMALMAP)\nattribute vec3 a_Tangent0;\nvarying vec3 v_Tangent0;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\nuniform mat4 u_WorldMat;\nvarying vec3 v_PositionWorld;\n#endif\n\nvarying float v_posViewZ;\n#ifdef RECEIVESHADOW\n  #ifdef SHADOWMAP_PSSM1 \n  varying vec4 v_lightMVPPos;\n  uniform mat4 u_lightShadowVP[4];\n  #endif\n#endif\n\n#ifdef TILINGOFFSET\n\tuniform vec4 u_TilingOffset;\n#endif\n\nvoid main_castShadow()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n \n//TODO没考虑UV动画呢\n#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\tv_Texcoord0=a_Texcoord0;\n#endif\n\tv_posViewZ = gl_Position.z;\n}\n\nvoid main_normal()\n{\n#ifdef BONE\n\tmat4 skinTransform=mat4(0.0);\n\tskinTransform += u_Bones[int(a_BoneIndices.x)] * a_BoneWeights.x;\n\tskinTransform += u_Bones[int(a_BoneIndices.y)] * a_BoneWeights.y;\n\tskinTransform += u_Bones[int(a_BoneIndices.z)] * a_BoneWeights.z;\n\tskinTransform += u_Bones[int(a_BoneIndices.w)] * a_BoneWeights.w;\n\tvec4 position=skinTransform*a_Position;\n\tgl_Position = u_MvpMatrix * position;\n#else\n\tgl_Position = u_MvpMatrix * a_Position;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tmat3 worldMat;\n\t#ifdef BONE\n\t\tworldMat=mat3(u_WorldMat*skinTransform);\n\t#else\n\t\tworldMat=mat3(u_WorldMat);\n\t#endif  \n\tv_Normal=worldMat*a_Normal;\n\t#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tv_Tangent0=worldMat*a_Tangent0;\n\t#endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||defined(RECEIVESHADOW)\n\t#ifdef BONE\n\t\tv_PositionWorld=(u_WorldMat*position).xyz;\n\t#else\n\t\tv_PositionWorld=(u_WorldMat*a_Position).xyz;\n\t#endif\n#endif\n\n#if defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\n\tv_Texcoord0=a_Texcoord0;\n\t#ifdef TILINGOFFSET\n\t\tv_Texcoord0=(vec2(v_Texcoord0.x,v_Texcoord0.y-1.0)*u_TilingOffset.xy)+u_TilingOffset.zw;\n\t\tv_Texcoord0=vec2(v_Texcoord0.x,v_Texcoord0.y+1.0);\n\t#endif\n\t#ifdef UVTRANSFORM\n\t\tv_Texcoord0=(u_UVMatrix*vec4(v_Texcoord0,0.0,1.0)).xy;\n\t#endif\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\n\t#ifdef SCALEOFFSETLIGHTINGMAPUV\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=vec2(a_Texcoord1.x*u_LightmapScaleOffset.x+u_LightmapScaleOffset.z,1.0+a_Texcoord1.y*u_LightmapScaleOffset.y+u_LightmapScaleOffset.w);\n\t\t#else\n\t\t\tv_LightMapUV=vec2(a_Texcoord0.x,a_Texcoord0.y-1.0)*u_LightmapScaleOffset.xy+u_LightmapScaleOffset.zw;\n\t\t#endif \n\t#else\n\t\t#ifdef UV1\n\t\t\tv_LightMapUV=a_Texcoord1;\n\t\t#else\n\t\t\tv_LightMapUV=a_Texcoord0;\n\t\t#endif \n\t#endif \n#endif\n\n#ifdef COLOR\n\tv_Color=a_Color;\n#endif\n\n#ifdef RECEIVESHADOW\n\tv_posViewZ = gl_Position.w;\n\t#ifdef SHADOWMAP_PSSM1 \n\t\tv_lightMVPPos = u_lightShadowVP[0] * vec4(v_PositionWorld,1.0);\n\t#endif\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\n\tmain_castShadow();\n#else\n\tmain_normal();\n#endif\n}",'#ifdef HIGHPRECISION\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n\n#include "LightHelper.glsl";\n\nuniform vec4 u_Albedo;\n\n#ifdef ALPHATEST\nuniform float u_AlphaTestValue;\n#endif\n\n#ifdef DIFFUSEMAP\nuniform sampler2D u_DiffuseTexture;\n#endif\n\n#ifdef REFLECTMAP\nuniform samplerCube u_ReflectTexture;\nuniform vec3 u_MaterialReflect;\n#endif\n\n#if   defined(DIFFUSEMAP)||((defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&(defined(COLOR)&&defined(SPECULARMAP)||defined(NORMALMAP)))\nvarying vec2 v_Texcoord0;\n#endif\n\n#if defined(AMBIENTMAP)||defined(LIGHTMAP)\nvarying vec2 v_LightMapUV;\n#endif\n#ifdef AMBIENTMAP\nuniform sampler2D u_AmbientTexture;\n#endif\n#ifdef LIGHTMAP\nuniform sampler2D u_LightMap;\n#endif\n\n#ifdef COLOR\nvarying vec4 v_Color;\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\nuniform vec3 u_MaterialDiffuse;\nuniform vec4 u_MaterialSpecular;\n  #if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP) \n  uniform sampler2D u_SpecularTexture;\n  #endif\n#endif\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(AMBIENTMAP)||defined(LIGHTMAP)\nuniform vec3 u_MaterialAmbient;\n#endif\n\n#if defined(FOG)||defined(DEPTHFOG)\n\tuniform float u_FogStart;\n\tuniform float u_FogRange;\n\t#ifdef ADDTIVEFOG\n\t#else\n\t\tuniform vec3 u_FogColor;\n\t#endif\n#endif\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\nvarying vec3 v_Normal;\n#endif\n\n#if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\nuniform sampler2D u_NormalTexture;\nvarying vec3 v_Tangent0;\n#endif\n\n#ifdef DIRECTIONLIGHT\nuniform DirectionLight u_DirectionLight;\n#endif\n\n#ifdef POINTLIGHT\nuniform PointLight u_PointLight;\n#endif\n\n#ifdef SPOTLIGHT\nuniform SpotLight u_SpotLight;\n#endif\n\nuniform vec3 u_AmbientColor;\n\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)||(defined(RECEIVESHADOW)&&(defined(SHADOWMAP_PSM2)||defined(SHADOWMAP_PSM3)))\nuniform vec3 u_CameraPos;\n#endif\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(DEPTHFOG)||defined(REFLECTMAP)\nvarying vec3 v_PositionWorld;\n#endif\n\n#include "ShadowHelper.glsl"\n#ifdef RECEIVESHADOW\n\t#if defined(SHADOWMAP_PSSM2)||defined(SHADOWMAP_PSSM3)\n\tuniform mat4 u_lightShadowVP[4];\n\t#endif\n\t#ifdef SHADOWMAP_PSSM1 \n\tvarying vec4 v_lightMVPPos;\n\t#endif\n#endif\nvarying float v_posViewZ;\n\n\n\nvoid main_castShadow()\n{\n\t//gl_FragColor=vec4(v_posViewZ,0.0,0.0,1.0);\n\tgl_FragColor=packDepth(v_posViewZ);\n\t#if defined(DIFFUSEMAP)&&defined(ALPHATEST)\n\t\tfloat alpha = texture2D(u_DiffuseTexture,v_Texcoord0).w;\n\t\tif( alpha < u_AlphaTestValue )\n\t\t{\n\t\t\tdiscard;\n\t\t}\n\t#endif\n}\nvoid main_normal()\n{\n#if defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n#endif \n  \n#if defined(COLOR)&&!defined(DIFFUSEMAP)\n\tgl_FragColor=v_Color;\n#endif \n  \n#if defined(DIFFUSEMAP)&&defined(COLOR)\n\tvec4 texColor=texture2D(u_DiffuseTexture, v_Texcoord0);\n\tgl_FragColor=texColor*v_Color;\n#endif\n  \n#if !defined(DIFFUSEMAP)&&!defined(COLOR)\n\tgl_FragColor=vec4(1.0,1.0,1.0,1.0);\n#endif \n    \n#ifdef ALPHATEST\n\tif(gl_FragColor.a-u_AlphaTestValue<0.0)\n\t\tdiscard;\n#endif\n  \n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(REFLECTMAP)\n\tvec3 normal;\n    #if (defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT))&&defined(NORMALMAP)\n\t\tvec3 normalMapSample = texture2D(u_NormalTexture, v_Texcoord0).rgb;\n\t\tnormal = normalize(NormalSampleToWorldSpace(normalMapSample, v_Normal, v_Tangent0));\n\t#else\n\t\tnormal = normalize(v_Normal);\n    #endif\n#endif\n\t\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\tvec3 diffuse = vec3(0.0);\n\tvec3 ambient = vec3(0.0);\n\tvec3 specular= vec3(0.0);\n\tvec3 dif, amb, spe;\n#endif\n  \n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)||defined(FOG)||defined(REFLECTMAP)\n\tvec3 toEye;\n\t#ifdef FOG\n\t\ttoEye=u_CameraPos-v_PositionWorld;\n\t\tfloat toEyeLength=length(toEye);\n\t\ttoEye/=toEyeLength;\n\t#else\n\t\ttoEye=normalize(u_CameraPos-v_PositionWorld);\n\t#endif\n#endif\n\t\n#ifdef DIRECTIONLIGHT\n\tcomputeDirectionLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_DirectionLight,u_AmbientColor,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n \n#ifdef POINTLIGHT\n\tcomputePointLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_PointLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef SPOTLIGHT\n\tComputeSpotLight(u_MaterialDiffuse,u_MaterialAmbient,u_MaterialSpecular,u_SpotLight,u_AmbientColor,v_PositionWorld,normal,toEye, dif, amb, spe);\n\tdiffuse+=dif;\n\tambient+=amb;\n\tspecular+=spe;\n#endif\n\n#ifdef RECEIVESHADOW\n\tfloat shadowValue = 1.0;\n\t#ifdef SHADOWMAP_PSSM3\n\t\tshadowValue = getShadowPSSM3( u_shadowMap1,u_shadowMap2,u_shadowMap3,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif\n\t#ifdef SHADOWMAP_PSSM2\n\t\tshadowValue = getShadowPSSM2( u_shadowMap1,u_shadowMap2,u_lightShadowVP,u_shadowPSSMDistance,u_shadowPCFoffset,v_PositionWorld,v_posViewZ,0.001);\n\t#endif \n\t#ifdef SHADOWMAP_PSSM1\n\t\tshadowValue = getShadowPSSM1( u_shadowMap1,v_lightMVPPos,u_shadowPSSMDistance,u_shadowPCFoffset,v_posViewZ,0.001);\n\t#endif\n#endif\n\n#ifdef AMBIENTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_AmbientTexture, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\n#ifdef LIGHTMAP\n\t#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t#else\n\t\t#if defined(RECEIVESHADOW)\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb * shadowValue);\n\t\t#else\n\t\t\tgl_FragColor.rgb=gl_FragColor.rgb*(u_MaterialAmbient+texture2D(u_LightMap, v_LightMapUV).rgb); \n\t\t#endif\n\t#endif\n#endif\n\ngl_FragColor=gl_FragColor*u_Albedo;\n\n#if defined(DIRECTIONLIGHT)||defined(POINTLIGHT)||defined(SPOTLIGHT)\n\t#if (defined(DIFFUSEMAP)||defined(COLOR))&&defined(SPECULARMAP)\n\t\tspecular =specular*texture2D(u_SpecularTexture, v_Texcoord0).rgb;\n    #endif\n\t#ifdef RECEIVESHADOW\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse*shadowValue) + specular*shadowValue,gl_FragColor.a);\n\t#else\n\t\tgl_FragColor =vec4( gl_FragColor.rgb*(ambient + diffuse) + specular,gl_FragColor.a);\n\t#endif\n#endif\n  \n#ifdef REFLECTMAP\n\tvec3 incident = -toEye;\n\tvec3 reflectionVector = reflect(incident,normal);\n\tvec3 reflectionColor  = textureCube(u_ReflectTexture,reflectionVector).rgb;\n\tgl_FragColor.rgb += u_MaterialReflect*reflectionColor;\n#endif\n  \n#ifdef FOG\n\tfloat lerpFact=clamp((toEyeLength-u_FogStart)/u_FogRange,0.0,1.0);\n\t#ifdef ADDTIVEFOG\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,vec3(0.0,0.0,0.0),lerpFact);\n\t#else\n\t\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n\t#endif\n#endif\n#ifdef DEPTHFOG\n\tfloat lerpFact = (-v_PositionWorld.y-u_FogStart)/u_FogRange;\n\tgl_FragColor.rgb=mix(gl_FragColor.rgb,u_FogColor,lerpFact);\n#endif\n}\n\nvoid main()\n{\n#ifdef CASTSHADOW\t\t\n\tmain_castShadow();\n#else\n  main_normal();\n#endif  \n}\n\n',b$M,b$y),b$qy.SHADERDEFINE_DIFFUSEMAP=shaderCompile.registerMaterialDefine("DIFFUSEMAP"),b$qy.SHADERDEFINE_NORMALMAP=shaderCompile.registerMaterialDefine("NORMALMAP"),b$qy.SHADERDEFINE_SPECULARMAP=shaderCompile.registerMaterialDefine("SPECULARMAP"),b$qy.SHADERDEFINE_EMISSIVEMAP=shaderCompile.registerMaterialDefine("EMISSIVEMAP"),b$qy.SHADERDEFINE_AMBIENTMAP=shaderCompile.registerMaterialDefine("AMBIENTMAP"),b$qy.SHADERDEFINE_REFLECTMAP=shaderCompile.registerMaterialDefine("REFLECTMAP"),b$qy.SHADERDEFINE_UVTRANSFORM=shaderCompile.registerMaterialDefine("UVTRANSFORM"),b$qy.SHADERDEFINE_TILINGOFFSET=shaderCompile.registerMaterialDefine("TILINGOFFSET"),b$qy.SHADERDEFINE_ADDTIVEFOG=shaderCompile.registerMaterialDefine("ADDTIVEFOG")},b$M}(),b$dy=function(){function b$M(){this._data=null,this._data=[]}b$P(b$M,"laya.d3.shader.ValusArray");var b$y=b$M.prototype;return b$y.setValue=function(b$M,b$y){this._data[b$M]=b$y},b$l(0,b$y,"data",function(){return this._data}),b$M}(),b$Py=function(){function b$M(){}return b$M.SHADERDEFINE_RECEIVE_SHADOW=1,b$M.SHADERDEFINE_CAST_SHADOW=512,b$M.SHADERDEFINE_SHADOW_PSSM1=1024,b$M.SHADERDEFINE_SHADOW_PSSM2=2048,b$M.SHADERDEFINE_SHADOW_PSSM3=4096,b$M.SHADERDEFINE_SHADOW_PCF_NO=8192,b$M.SHADERDEFINE_SHADOW_PCF1=16384,b$M.SHADERDEFINE_SHADOW_PCF2=32768,b$M.SHADERDEFINE_SHADOW_PCF3=65536,b$M.MAX_PSSM_COUNT=3,b$M}(),b$ly=function(){function b$N(){}return b$P(b$N,"laya.d3.utils.Picker"),b$N.calculateCursorRay=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=b$M.elements[0],b$K=b$M.elements[1],b$k=b$N._tempVector30,b$X=b$k.elements;b$X[0]=b$V,b$X[1]=b$K,b$X[2]=b$y.minDepth;var b$F=b$N._tempVector31,b$o=b$F.elements;b$o[0]=b$V,b$o[1]=b$K,b$o[2]=b$y.maxDepth;var b$d=b$f.origin,b$P=b$N._tempVector32;b$y.unprojectFromWVP(b$k,b$i,b$H,b$S,b$d),b$y.unprojectFromWVP(b$F,b$i,b$H,b$S,b$P);var b$l=b$f.direction.elements;b$l[0]=b$P.x-b$d.x,b$l[1]=b$P.y-b$d.y,b$l[2]=b$P.z-b$d.z,b$Vy.normalize(b$f.direction,b$f.direction)},b$N.rayIntersectsPositionsAndIndices=function(b$M,b$y,b$i,b$H,b$S){for(var b$f=b$i.vertexStride/4,b$V=b$i.getVertexElementByUsage(0).offset/4,b$K=Number.MAX_VALUE,b$k=-1,b$X=-1,b$F=-1,b$o=0;b$o<b$H.length;b$o+=3){var b$d=b$N._tempVector35,b$P=b$d.elements,b$l=b$H[b$o]*b$f,b$J=b$l+b$V;b$P[0]=b$y[b$J],b$P[1]=b$y[1+b$J],b$P[2]=b$y[2+b$J];var b$h=b$N._tempVector36,b$C=b$h.elements,b$v=b$H[b$o+1]*b$f,b$R=b$v+b$V;b$C[0]=b$y[b$R],b$C[1]=b$y[1+b$R],b$C[2]=b$y[2+b$R];var b$A=b$N._tempVector37,b$G=b$A.elements,b$I=b$H[b$o+2]*b$f,b$U=b$I+b$V;b$G[0]=b$y[b$U],b$G[1]=b$y[1+b$U],b$G[2]=b$y[2+b$U];var b$Q=laya.d3.utils.Picker.rayIntersectsTriangle(b$M,b$d,b$h,b$A);!isNaN(b$Q)&&b$Q<b$K&&(b$K=b$Q,b$k=b$l,b$X=b$v,b$F=b$I)}if(b$K===Number.MAX_VALUE)return b$S.position.toDefault(),b$S.distance=Number.MAX_VALUE,b$S.trianglePositions[0].toDefault(),b$S.trianglePositions[1].toDefault(),b$S.trianglePositions[2].toDefault(),b$S.triangleNormals[0].toDefault(),b$S.triangleNormals[1].toDefault(),b$S.triangleNormals[2].toDefault(),!1;b$S.distance=b$K,b$Vy.scale(b$M.direction,b$K,b$S.position),b$Vy.add(b$M.origin,b$S.position,b$S.position);var b$W=b$S.trianglePositions,b$c=b$W[0],b$n=b$W[1],b$a=b$W[2],b$T=b$c.elements,b$m=b$n.elements,b$e=b$a.elements,b$s=b$k+b$V;b$T[0]=b$y[b$s],b$T[1]=b$y[b$s+1],b$T[2]=b$y[b$s+2];var b$D=b$X+b$V;b$m[0]=b$y[b$D],b$m[1]=b$y[b$D+1],b$m[2]=b$y[b$D+2];var b$z=b$F+b$V;b$e[0]=b$y[b$z],b$e[1]=b$y[b$z+1],b$e[2]=b$y[b$z+2];var b$w=b$i.getVertexElementByUsage(3);if(b$w){var b$q=b$w.offset/4,b$t=b$S.triangleNormals,b$u=b$t[0],b$p=b$t[1],b$B=b$t[2],b$Z=b$u.elements,b$E=b$p.elements,b$_=b$B.elements,b$b=b$k+b$q;b$Z[0]=b$y[b$b],b$Z[1]=b$y[b$b+1],b$Z[2]=b$y[b$b+2];var b$Y=b$X+b$q;b$E[0]=b$y[b$Y],b$E[1]=b$y[b$Y+1],b$E[2]=b$y[b$Y+2];var b$r=b$F+b$q;b$_[0]=b$y[b$r],b$_[1]=b$y[b$r+1],b$_[2]=b$y[b$r+2]}return!0},b$N.rayIntersectsTriangle=function(b$M,b$y,b$i,b$H){var b$S=b$N._tempVector30,b$f=b$N._tempVector31;b$Vy.subtract(b$i,b$y,b$S),b$Vy.subtract(b$H,b$y,b$f);var b$V,b$K=b$N._tempVector32;if(b$Vy.cross(b$M.direction,b$f,b$K),(b$V=b$Vy.dot(b$S,b$K))>-Number.MIN_VALUE&&b$V<Number.MIN_VALUE)return Number.NaN;var b$k,b$X=1/b$V,b$F=b$N._tempVector33;if(b$Vy.subtract(b$M.origin,b$y,b$F),b$k=b$Vy.dot(b$F,b$K),(b$k*=b$X)<0||1<b$k)return Number.NaN;var b$o,b$d,b$P=b$N._tempVector34;return b$Vy.cross(b$F,b$S,b$P),b$o=b$Vy.dot(b$M.direction,b$P),(b$o*=b$X)<0||1<b$k+b$o?Number.NaN:(b$d=b$Vy.dot(b$f,b$P),(b$d*=b$X)<0?Number.NaN:b$d)},b$o(b$N,["_tempVector30",function(){return this._tempVector30=new b$Vy},"_tempVector31",function(){return this._tempVector31=new b$Vy},"_tempVector32",function(){return this._tempVector32=new b$Vy},"_tempVector33",function(){return this._tempVector33=new b$Vy},"_tempVector34",function(){return this._tempVector34=new b$Vy},"_tempVector35",function(){return this._tempVector35=new b$Vy},"_tempVector36",function(){return this._tempVector36=new b$Vy},"_tempVector37",function(){return this._tempVector37=new b$Vy}]),b$N}(),b$Jy=(function(){function b$M(){this.distance=NaN,this.trianglePositions=null,this.triangleNormals=null,this.position=null,this.sprite3D=null,this.distance=-1,this.trianglePositions=[new b$Vy,new b$Vy,new b$Vy],this.trianglePositions.length=3,this.triangleNormals=[new b$Vy,new b$Vy,new b$Vy],this.triangleNormals.length=3,this.position=new b$Vy}b$P(b$M,"laya.d3.utils.RaycastHit"),b$M.prototype.cloneTo=function(b$M){b$M.distance=this.distance,this.trianglePositions[0].cloneTo(b$M.trianglePositions[0]),this.trianglePositions[1].cloneTo(b$M.trianglePositions[1]),this.trianglePositions[2].cloneTo(b$M.trianglePositions[2]),this.triangleNormals[0].cloneTo(b$M.triangleNormals[0]),this.triangleNormals[1].cloneTo(b$M.triangleNormals[1]),this.triangleNormals[2].cloneTo(b$M.triangleNormals[2]),this.position.cloneTo(b$M.position),b$M.sprite3D=this.sprite3D}}(),function(){function b$M(b$M,b$y){this._width=0,this._height=0,this._width=b$M,this._height=b$y}b$P(b$M,"laya.d3.utils.Size");var b$y=b$M.prototype;return b$l(0,b$y,"width",function(){return-1===this._width?b$$.clientWidth:this._width}),b$l(0,b$y,"height",function(){return-1===this._height?b$$.clientHeight:this._height}),b$l(1,b$M,"fullScreen",function(){return new b$M(-1,-1)}),b$M}()),b$hy=function(){function b$s(){}return b$P(b$s,"laya.d3.utils.Utils3D"),b$s._rotationTransformScaleSkinAnimation=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F,b$o){var b$d,b$P,b$l,b$J,b$h,b$C=b$s._tempArray16_0,b$v=b$s._tempArray16_1,b$R=b$s._tempArray16_2,b$A=b$H+b$H,b$G=b$S+b$S,b$I=b$f+b$f,b$U=b$H*b$A,b$Q=b$S*b$A,b$W=b$S*b$G,b$c=b$f*b$A,b$n=b$f*b$G,b$a=b$f*b$I,b$T=b$V*b$A,b$m=b$V*b$G,b$e=b$V*b$I;for(b$C[15]=1,b$C[0]=1-b$W-b$a,b$C[1]=b$Q+b$e,b$C[2]=b$c-b$m,b$C[4]=b$Q-b$e,b$C[5]=1-b$U-b$a,b$C[6]=b$n+b$T,b$C[8]=b$c+b$m,b$C[9]=b$n-b$T,b$C[10]=1-b$U-b$W,b$v[15]=1,b$v[0]=b$K,b$v[5]=b$k,b$v[10]=b$X,b$d=0;b$d<4;b$d++)b$P=b$C[b$d],b$l=b$C[b$d+4],b$J=b$C[b$d+8],b$h=b$C[b$d+12],b$R[b$d]=b$P,b$R[b$d+4]=b$l,b$R[b$d+8]=b$J,b$R[b$d+12]=b$P*b$M+b$l*b$y+b$J*b$i+b$h;for(b$d=0;b$d<4;b$d++)b$P=b$R[b$d],b$l=b$R[b$d+4],b$J=b$R[b$d+8],b$h=b$R[b$d+12],b$F[b$d+b$o]=b$P*b$v[0]+b$l*b$v[1]+b$J*b$v[2]+b$h*b$v[3],b$F[b$d+b$o+4]=b$P*b$v[4]+b$l*b$v[5]+b$J*b$v[6]+b$h*b$v[7],b$F[b$d+b$o+8]=b$P*b$v[8]+b$l*b$v[9]+b$J*b$v[10]+b$h*b$v[11],b$F[b$d+b$o+12]=b$P*b$v[12]+b$l*b$v[13]+b$J*b$v[14]+b$h*b$v[15]},b$s._createNodeByJson=function(b$M,b$y,b$i,b$H){if(!b$i)switch(b$y.type){case"Sprite3D":b$i=new b$zy;break;case"MeshSprite3D":b$i=new b$Ny;break;case"SkinnedMeshSprite3D":b$i=new SkinnedMeshSprite3D;break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":b$i=new ShuriKenParticle3D;break;case"TrailSprite3D":b$i=new TrailSprite3D;break;case"Terrain":b$i=new Terrain;break;case"Camera":b$i=new b$ry;break;case"DirectionLight":b$i=new DirectionLight;break;default:throw new Error("Utils3D:unidentified class type in (.lh) file.")}var b$S=b$y.props;if(b$S)for(var b$f in b$S)b$i[b$f]=b$S[b$f];var b$V=b$y.customProps;b$V&&(b$i instanceof laya.d3.core.Sprite3D?(b$i._parseBaseCustomProps(b$V),b$i._parseCustomProps(b$M,b$H,b$V,b$y),b$i._parseCustomComponent(b$M,b$H,b$y.components)):b$i._parseCustomProps(b$M,b$H,b$V,b$y));var b$K=b$y.child;if(b$K)for(var b$k=0,b$X=b$K.length;b$k<b$X;b$k++){var b$F=b$s._createNodeByJson(b$M,b$K[b$k],null,b$H);b$i.addChild(b$F)}return b$i},b$s._computeBoneAndAnimationDatasByBindPoseMatrxix=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V,b$K,b$k=0,b$X=0,b$F=b$M.length;for(b$V=0;b$V<b$F;b$k+=b$M[b$V].keyframeWidth,b$X+=16,b$V++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(b$y[b$k+0],b$y[b$k+1],b$y[b$k+2],b$y[b$k+3],b$y[b$k+4],b$y[b$k+5],b$y[b$k+6],b$y[b$k+7],b$y[b$k+8],b$y[b$k+9],b$H,b$X),0!=b$V&&(b$K=16*b$M[b$V].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(b$H,b$K,b$H,b$X,b$H,b$X));var b$o=b$i.length;for(b$V=0;b$V<b$o;b$V++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(b$H,16*b$f[b$V],b$i[b$V],b$S,16*b$V)},b$s._computeAnimationDatasByArrayAndMatrixFast=function(b$M,b$y,b$i,b$H){for(var b$S=0,b$f=b$M.length;b$S<b$f;b$S++)laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(b$y,16*b$H[b$S],b$M[b$S],b$i,16*b$S)},b$s._computeBoneAndAnimationDatasByBindPoseMatrxixOld=function(b$M,b$y,b$i,b$H,b$S){var b$f,b$V,b$K=0,b$k=0,b$X=b$M.length;for(b$f=0;b$f<b$X;b$K+=b$M[b$f].keyframeWidth,b$k+=16,b$f++)laya.d3.utils.Utils3D._rotationTransformScaleSkinAnimation(b$y[b$K+7],b$y[b$K+8],b$y[b$K+9],b$y[b$K+3],b$y[b$K+4],b$y[b$K+5],b$y[b$K+6],b$y[b$K+0],b$y[b$K+1],b$y[b$K+2],b$H,b$k),0!=b$f&&(b$V=16*b$M[b$f].parentIndex,laya.d3.utils.Utils3D.mulMatrixByArray(b$H,b$V,b$H,b$k,b$H,b$k));var b$F=b$i.length;for(b$f=0;b$f<b$F;b$f++){var b$o=16*b$f;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(b$H,b$o,b$i[b$f],b$S,b$o)}},b$s._computeAnimationDatasByArrayAndMatrixFastOld=function(b$M,b$y,b$i){for(var b$H=b$M.length,b$S=0;b$S<b$H;b$S++){var b$f=16*b$S;laya.d3.utils.Utils3D.mulMatrixByArrayAndMatrixFast(b$y,b$f,b$M[b$S],b$i,b$f)}},b$s._computeRootAnimationData=function(b$M,b$y,b$i){for(var b$H=0,b$S=0,b$f=0,b$V=b$M.length;b$H<b$V;b$S+=b$M[b$H].keyframeWidth,b$f+=16,b$H++)laya.d3.utils.Utils3D.createAffineTransformationArray(b$y[b$S+0],b$y[b$S+1],b$y[b$S+2],b$y[b$S+3],b$y[b$S+4],b$y[b$S+5],b$y[b$S+6],b$y[b$S+7],b$y[b$S+8],b$y[b$S+9],b$i,b$f)},b$s.transformVector3ArrayByQuat=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$i.elements,b$V=b$M[b$y],b$K=b$M[b$y+1],b$k=b$M[b$y+2],b$X=b$f[0],b$F=b$f[1],b$o=b$f[2],b$d=b$f[3],b$P=b$d*b$V+b$F*b$k-b$o*b$K,b$l=b$d*b$K+b$o*b$V-b$X*b$k,b$J=b$d*b$k+b$X*b$K-b$F*b$V,b$h=-b$X*b$V-b$F*b$K-b$o*b$k;b$H[b$S]=b$P*b$d+b$h*-b$X+b$l*-b$o-b$J*-b$F,b$H[b$S+1]=b$l*b$d+b$h*-b$F+b$J*-b$X-b$P*-b$o,b$H[b$S+2]=b$J*b$d+b$h*-b$o+b$P*-b$F-b$l*-b$X},b$s.mulMatrixByArray=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V,b$K,b$k,b$X,b$F;if(b$S===b$i){for(b$i=b$s._tempArray16_3,b$V=0;b$V<16;++b$V)b$i[b$V]=b$S[b$f+b$V];b$H=0}for(b$V=0;b$V<4;b$V++)b$K=b$M[b$y+b$V],b$k=b$M[b$y+b$V+4],b$X=b$M[b$y+b$V+8],b$F=b$M[b$y+b$V+12],b$S[b$f+b$V]=b$K*b$i[b$H+0]+b$k*b$i[b$H+1]+b$X*b$i[b$H+2]+b$F*b$i[b$H+3],b$S[b$f+b$V+4]=b$K*b$i[b$H+4]+b$k*b$i[b$H+5]+b$X*b$i[b$H+6]+b$F*b$i[b$H+7],b$S[b$f+b$V+8]=b$K*b$i[b$H+8]+b$k*b$i[b$H+9]+b$X*b$i[b$H+10]+b$F*b$i[b$H+11],b$S[b$f+b$V+12]=b$K*b$i[b$H+12]+b$k*b$i[b$H+13]+b$X*b$i[b$H+14]+b$F*b$i[b$H+15]},b$s.mulMatrixByArrayFast=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V,b$K,b$k,b$X,b$F;for(b$V=0;b$V<4;b$V++)b$K=b$M[b$y+b$V],b$k=b$M[b$y+b$V+4],b$X=b$M[b$y+b$V+8],b$F=b$M[b$y+b$V+12],b$S[b$f+b$V]=b$K*b$i[b$H+0]+b$k*b$i[b$H+1]+b$X*b$i[b$H+2]+b$F*b$i[b$H+3],b$S[b$f+b$V+4]=b$K*b$i[b$H+4]+b$k*b$i[b$H+5]+b$X*b$i[b$H+6]+b$F*b$i[b$H+7],b$S[b$f+b$V+8]=b$K*b$i[b$H+8]+b$k*b$i[b$H+9]+b$X*b$i[b$H+10]+b$F*b$i[b$H+11],b$S[b$f+b$V+12]=b$K*b$i[b$H+12]+b$k*b$i[b$H+13]+b$X*b$i[b$H+14]+b$F*b$i[b$H+15]},b$s.mulMatrixByArrayAndMatrixFast=function(b$M,b$y,b$i,b$H,b$S){var b$f,b$V,b$K,b$k,b$X,b$F=b$i.elements,b$o=b$F[0],b$d=b$F[1],b$P=b$F[2],b$l=b$F[3],b$J=b$F[4],b$h=b$F[5],b$C=b$F[6],b$v=b$F[7],b$R=b$F[8],b$A=b$F[9],b$G=b$F[10],b$I=b$F[11],b$U=b$F[12],b$Q=b$F[13],b$W=b$F[14],b$c=b$F[15],b$n=b$y,b$a=b$y+4,b$T=b$y+8,b$m=b$y+12,b$e=b$S,b$s=b$S+4,b$D=b$S+8,b$z=b$S+12;for(b$f=0;b$f<4;b$f++)b$V=b$M[b$n+b$f],b$K=b$M[b$a+b$f],b$k=b$M[b$T+b$f],b$X=b$M[b$m+b$f],b$H[b$e+b$f]=b$V*b$o+b$K*b$d+b$k*b$P+b$X*b$l,b$H[b$s+b$f]=b$V*b$J+b$K*b$h+b$k*b$C+b$X*b$v,b$H[b$D+b$f]=b$V*b$R+b$K*b$A+b$k*b$G+b$X*b$I,b$H[b$z+b$f]=b$V*b$U+b$K*b$Q+b$k*b$W+b$X*b$c},b$s.createAffineTransformationArray=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F,b$o){var b$d=b$H+b$H,b$P=b$S+b$S,b$l=b$f+b$f,b$J=b$H*b$d,b$h=b$H*b$P,b$C=b$H*b$l,b$v=b$S*b$P,b$R=b$S*b$l,b$A=b$f*b$l,b$G=b$V*b$d,b$I=b$V*b$P,b$U=b$V*b$l;b$F[b$o+0]=(1-(b$v+b$A))*b$K,b$F[b$o+1]=(b$h+b$U)*b$K,b$F[b$o+2]=(b$C-b$I)*b$K,b$F[b$o+3]=0,b$F[b$o+4]=(b$h-b$U)*b$k,b$F[b$o+5]=(1-(b$J+b$A))*b$k,b$F[b$o+6]=(b$R+b$G)*b$k,b$F[b$o+7]=0,b$F[b$o+8]=(b$C+b$I)*b$X,b$F[b$o+9]=(b$R-b$G)*b$X,b$F[b$o+10]=(1-(b$J+b$v))*b$X,b$F[b$o+11]=0,b$F[b$o+12]=b$M,b$F[b$o+13]=b$y,b$F[b$o+14]=b$i,b$F[b$o+15]=1},b$s.transformVector3ArrayToVector3ArrayCoordinate=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$s._tempArray4_0,b$V=b$M[b$y+0],b$K=b$M[b$y+1],b$k=b$M[b$y+2],b$X=b$i.elements;b$f[0]=b$V*b$X[0]+b$K*b$X[4]+b$k*b$X[8]+b$X[12],b$f[1]=b$V*b$X[1]+b$K*b$X[5]+b$k*b$X[9]+b$X[13],b$f[2]=b$V*b$X[2]+b$K*b$X[6]+b$k*b$X[10]+b$X[14],b$f[3]=1/(b$V*b$X[3]+b$K*b$X[7]+b$k*b$X[11]+b$X[15]),b$H[b$S+0]=b$f[0]*b$f[3],b$H[b$S+1]=b$f[1]*b$f[3],b$H[b$S+2]=b$f[2]*b$f[3]},b$s.transformLightingMapTexcoordByUV0Array=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$i.elements;b$H[b$S+0]=b$M[b$y+0]*b$f[0]+b$f[2],b$H[b$S+1]=(b$M[b$y+1]-1)*b$f[1]+b$f[3]},b$s.transformLightingMapTexcoordByUV1Array=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$i.elements;b$H[b$S+0]=b$M[b$y+0]*b$f[0]+b$f[2],b$H[b$S+1]=1+b$M[b$y+1]*b$f[1]+b$f[3]},b$s.getURLVerion=function(b$M){var b$y=b$M.indexOf("?");return 0<=b$y?b$M.substr(b$y):null},b$s._quaternionCreateFromYawPitchRollArray=function(b$M,b$y,b$i,b$H){var b$S=.5*b$i,b$f=.5*b$y,b$V=.5*b$M,b$K=Math.sin(b$S),b$k=Math.cos(b$S),b$X=Math.sin(b$f),b$F=Math.cos(b$f),b$o=Math.sin(b$V),b$d=Math.cos(b$V);b$H[0]=b$d*b$X*b$k+b$o*b$F*b$K,b$H[1]=b$o*b$F*b$k-b$d*b$X*b$K,b$H[2]=b$d*b$F*b$K-b$o*b$X*b$k,b$H[3]=b$d*b$F*b$k+b$o*b$X*b$K},b$s._createAffineTransformationArray=function(b$M,b$y,b$i,b$H){var b$S=b$y[0],b$f=b$y[1],b$V=b$y[2],b$K=b$y[3],b$k=b$S+b$S,b$X=b$f+b$f,b$F=b$V+b$V,b$o=b$S*b$k,b$d=b$S*b$X,b$P=b$S*b$F,b$l=b$f*b$X,b$J=b$f*b$F,b$h=b$V*b$F,b$C=b$K*b$k,b$v=b$K*b$X,b$R=b$K*b$F,b$A=b$i[0],b$G=b$i[1],b$I=b$i[2];b$H[0]=(1-(b$l+b$h))*b$A,b$H[1]=(b$d+b$R)*b$A,b$H[2]=(b$P-b$v)*b$A,b$H[3]=0,b$H[4]=(b$d-b$R)*b$G,b$H[5]=(1-(b$o+b$h))*b$G,b$H[6]=(b$J+b$C)*b$G,b$H[7]=0,b$H[8]=(b$P+b$v)*b$I,b$H[9]=(b$J-b$C)*b$I,b$H[10]=(1-(b$o+b$l))*b$I,b$H[11]=0,b$H[12]=b$M[0],b$H[13]=b$M[1],b$H[14]=b$M[2],b$H[15]=1},b$s._mulMatrixArray=function(b$M,b$y,b$i,b$H){var b$S,b$f,b$V,b$K,b$k,b$X=b$y.elements,b$F=b$X[0],b$o=b$X[1],b$d=b$X[2],b$P=b$X[3],b$l=b$X[4],b$J=b$X[5],b$h=b$X[6],b$C=b$X[7],b$v=b$X[8],b$R=b$X[9],b$A=b$X[10],b$G=b$X[11],b$I=b$X[12],b$U=b$X[13],b$Q=b$X[14],b$W=b$X[15],b$c=b$H,b$n=b$H+4,b$a=b$H+8,b$T=b$H+12;for(b$S=0;b$S<4;b$S++)b$f=b$M[b$S],b$V=b$M[b$S+4],b$K=b$M[b$S+8],b$k=b$M[b$S+12],b$i[b$c+b$S]=b$f*b$F+b$V*b$o+b$K*b$d+b$k*b$P,b$i[b$n+b$S]=b$f*b$l+b$V*b$J+b$K*b$h+b$k*b$C,b$i[b$a+b$S]=b$f*b$v+b$V*b$R+b$K*b$A+b$k*b$G,b$i[b$T+b$S]=b$f*b$I+b$V*b$U+b$K*b$Q+b$k*b$W},b$s.getYawPitchRoll=function(b$M,b$y){b$s.transformQuat(b$Vy.ForwardRH,b$M,b$iy.TEMPVector31),b$s.transformQuat(b$Vy.Up,b$M,b$iy.TEMPVector32);var b$i=b$iy.TEMPVector32.elements;b$s.angleTo(b$Vy.ZERO,b$iy.TEMPVector31,b$iy.TEMPVector33);var b$H=b$iy.TEMPVector33.elements;b$H[0]==Math.PI/2?(b$H[1]=b$s.arcTanAngle(b$i[2],b$i[0]),b$H[2]=0):b$H[0]==-Math.PI/2?(b$H[1]=b$s.arcTanAngle(-b$i[2],-b$i[0]),b$H[2]=0):(b$My.createRotationY(-b$H[1],b$iy.TEMPMatrix0),b$My.createRotationX(-b$H[0],b$iy.TEMPMatrix1),b$Vy.transformCoordinate(b$iy.TEMPVector32,b$iy.TEMPMatrix0,b$iy.TEMPVector32),b$Vy.transformCoordinate(b$iy.TEMPVector32,b$iy.TEMPMatrix1,b$iy.TEMPVector32),b$H[2]=b$s.arcTanAngle(b$i[1],-b$i[0])),b$H[1]<=-Math.PI&&(b$H[1]=Math.PI),b$H[2]<=-Math.PI&&(b$H[2]=Math.PI),b$H[1]>=Math.PI&&b$H[2]>=Math.PI&&(b$H[1]=0,b$H[2]=0,b$H[0]=Math.PI-b$H[0]),b$y[0]=b$H[1],b$y[1]=b$H[0],b$y[2]=b$H[2]},b$s.arcTanAngle=function(b$M,b$y){return 0==b$M?1==b$y?Math.PI/2:-Math.PI/2:0<b$M?Math.atan(b$y/b$M):b$M<0?0<b$y?Math.atan(b$y/b$M)+Math.PI:Math.atan(b$y/b$M)-Math.PI:0},b$s.angleTo=function(b$M,b$y,b$i){b$Vy.subtract(b$y,b$M,b$iy.TEMPVector30),b$Vy.normalize(b$iy.TEMPVector30,b$iy.TEMPVector30),b$i.elements[0]=Math.asin(b$iy.TEMPVector30.y),b$i.elements[1]=b$s.arcTanAngle(-b$iy.TEMPVector30.z,-b$iy.TEMPVector30.x)},b$s.transformQuat=function(b$M,b$y,b$i){var b$H=b$i.elements,b$S=b$M.elements,b$f=b$y,b$V=b$S[0],b$K=b$S[1],b$k=b$S[2],b$X=b$f[0],b$F=b$f[1],b$o=b$f[2],b$d=b$f[3],b$P=b$d*b$V+b$F*b$k-b$o*b$K,b$l=b$d*b$K+b$o*b$V-b$X*b$k,b$J=b$d*b$k+b$X*b$K-b$F*b$V,b$h=-b$X*b$V-b$F*b$K-b$o*b$k;b$H[0]=b$P*b$d+b$h*-b$X+b$l*-b$o-b$J*-b$F,b$H[1]=b$l*b$d+b$h*-b$F+b$J*-b$X-b$P*-b$o,b$H[2]=b$J*b$d+b$h*-b$o+b$P*-b$F-b$l*-b$X},b$s.quaterionNormalize=function(b$M,b$y){var b$i=b$M[0],b$H=b$M[1],b$S=b$M[2],b$f=b$M[3],b$V=b$i*b$i+b$H*b$H+b$S*b$S+b$f*b$f;0<b$V&&(b$V=1/Math.sqrt(b$V),b$y[0]=b$i*b$V,b$y[1]=b$H*b$V,b$y[2]=b$S*b$V,b$y[3]=b$f*b$V)},b$s.matrix4x4MultiplyFFF=function(b$M,b$y,b$i){var b$H,b$S,b$f,b$V,b$K;if(b$i===b$y)for(b$y=new Float32Array(16),b$H=0;b$H<16;++b$H)b$y[b$H]=b$i[b$H];for(b$H=0;b$H<4;b$H++)b$S=b$M[b$H],b$f=b$M[b$H+4],b$V=b$M[b$H+8],b$K=b$M[b$H+12],b$i[b$H]=b$S*b$y[0]+b$f*b$y[1]+b$V*b$y[2]+b$K*b$y[3],b$i[b$H+4]=b$S*b$y[4]+b$f*b$y[5]+b$V*b$y[6]+b$K*b$y[7],b$i[b$H+8]=b$S*b$y[8]+b$f*b$y[9]+b$V*b$y[10]+b$K*b$y[11],b$i[b$H+12]=b$S*b$y[12]+b$f*b$y[13]+b$V*b$y[14]+b$K*b$y[15]},b$s.matrix4x4MultiplyMFM=function(b$M,b$y,b$i){b$s.matrix4x4MultiplyFFF(b$M.elements,b$y,b$i.elements)},b$o(b$s,["_typeToFunO",function(){return this._typeToFunO={INT16:"writeInt16",SHORT:"writeInt16",UINT16:"writeUint16",UINT32:"writeUint32",FLOAT32:"writeFloat32",INT:"writeInt32",UINT:"writeUint32",BYTE:"writeByte",STRING:"writeUTFString"}},"_tempVector3_0",function(){return this._tempVector3_0=new b$Vy},"_tempVector3_1",function(){return this._tempVector3_1=new b$Vy},"_tempVector3_2",function(){return this._tempVector3_2=new b$Vy},"_tempVector3_3",function(){return this._tempVector3_3=new b$Vy},"_tempVector3_4",function(){return this._tempVector3_4=new b$Vy},"_tempVector3_5",function(){return this._tempVector3_5=new b$Vy},"_tempVector3_6",function(){return this._tempVector3_6=new b$Vy},"_tempArray4_0",function(){return this._tempArray4_0=new Float32Array(4)},"_tempArray16_0",function(){return this._tempArray16_0=new Float32Array(16)},"_tempArray16_1",function(){return this._tempArray16_1=new Float32Array(16)},"_tempArray16_2",function(){return this._tempArray16_2=new Float32Array(16)},"_tempArray16_3",function(){return this._tempArray16_3=new Float32Array(16)}]),b$s}(),b$Cy=function(){function b$m(){}return b$P(b$m,"Laya3D"),b$m._cancelLoadByUrl=function(b$M){b$G.loader.cancelLoadByUrl(b$M),b$m._innerFirstLevelLoaderManager.cancelLoadByUrl(b$M),b$m._innerSecondLevelLoaderManager.cancelLoadByUrl(b$M),b$m._innerThirdLevelLoaderManager.cancelLoadByUrl(b$M),b$m._innerFourthLevelLoaderManager.cancelLoadByUrl(b$M)},b$m._changeWebGLSize=function(b$M,b$y){b$T.onStageResize(b$M,b$y),b$$.clientWidth=b$M,b$$.clientHeight=b$y},b$m.__init__=function(){var b$M=b$y.createMap;b$M.lh=[b$zy,"SPRITE3DHIERARCHY"],b$M.ls=[b$Dy,"SPRITE3DHIERARCHY"],b$M.lm=[b$Zy,"MESH"],b$M.lmat=[b$qy,"MATERIAL"],b$M.jpg=[b$_y,"nativeimage"],b$M.jpeg=[b$_y,"nativeimage"],b$M.png=[b$_y,"nativeimage"],b$M.pkm=[b$_y,"arraybuffer"],b$M.raw=[b$py,"arraybuffer"],b$M.mipmaps=[b$py,"arraybuffer"],b$C.parserMap.SPRITE3DHIERARCHY=b$m._loadHierarchy,b$C.parserMap.MESH=b$m._loadMesh,b$C.parserMap.MATERIAL=b$m._loadMaterial,b$C.parserMap.TEXTURECUBE=b$m._loadTextureCube,b$C.parserMap.TERRAIN=b$m._loadTerrain,b$m._innerFirstLevelLoaderManager.on("error",null,b$m._eventLoadManagerError),b$m._innerSecondLevelLoaderManager.on("error",null,b$m._eventLoadManagerError),b$m._innerThirdLevelLoaderManager.on("error",null,b$m._eventLoadManagerError),b$m._innerFourthLevelLoaderManager.on("error",null,b$m._eventLoadManagerError)},b$m.READ_BLOCK=function(){return b$m._readData.pos+=4,!0},b$m.READ_DATA=function(){return b$m._DATA.offset=b$m._readData.getUint32(),b$m._DATA.size=b$m._readData.getUint32(),!0},b$m.READ_STRINGS=function(){var b$M=[],b$y={offset:0,size:0};b$y.offset=b$m._readData.getUint16(),b$y.size=b$m._readData.getUint16();b$m._readData.pos;b$m._readData.pos=b$y.offset+b$m._DATA.offset;for(var b$i=0;b$i<b$y.size;b$i++){var b$H=b$m._readData.readUTFString();-1===b$H.lastIndexOf(".lmat")&&-1===b$H.lastIndexOf(".lpbr")||b$M.push(b$H)}return b$M},b$m.formatRelativePath=function(b$M,b$y){var b$i;if("."===b$y.charAt(0)){for(var b$H=(b$M+b$y).split("/"),b$S=0,b$f=b$H.length;b$S<b$f;b$S++)if(".."==b$H[b$S]){var b$V=b$S-1;0<b$V&&".."!==b$H[b$V]&&(b$H.splice(b$V,2),b$S-=2)}b$i=b$H.join("/")}else b$i=b$M+b$y;return null!=b$a.customFormat&&(b$i=b$a.customFormat(b$i,null)),b$i},b$m._eventLoadManagerError=function(b$M){b$G.loader.event("error",b$M)},b$m._addHierarchyInnerUrls=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V=b$m.formatRelativePath(b$H,b$S);b$i&&(b$V+=b$i),b$M.push({url:b$V,clas:b$f}),b$y[b$S]=b$V},b$m._getSprite3DHierarchyInnerUrls=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){var b$K,b$k=0,b$X=0;switch(b$M.type){case"Scene":var b$F=b$M.customProps.lightmaps;for(b$k=0,b$X=b$F.length;b$k<b$X;b$k++){var b$o=b$F[b$k].replace(".exr",".png");b$m._addHierarchyInnerUrls(b$H,b$S,b$f,b$V,b$o,b$_y)}break;case"MeshSprite3D":case"TrailSprite3D":case"LineSprite3D":case"SkinnedMeshSprite3D":var b$d;if(b$M.instanceParams)(b$d=b$M.instanceParams.loadPath)&&b$m._addHierarchyInnerUrls(b$y,b$S,b$f,b$V,b$d,b$Zy);else{(b$d=(b$K=b$M.customProps).meshPath)&&b$m._addHierarchyInnerUrls(b$y,b$S,b$f,b$V,b$d,b$Zy);var b$P=b$K.materials;if(b$P)for(b$k=0,b$X=b$P.length;b$k<b$X;b$k++){for(var b$l=b$P[b$k],b$J=b$l.type.split("."),b$h=b$e.window,b$C=0,b$v=b$J.length;b$C<b$v;++b$C){b$h=b$h[this.clasPaths[b$C]]}if("function"!=typeof b$h)throw"_getSprite3DHierarchyInnerUrls 错误: "+b$l.type+" 不是类";b$m._addHierarchyInnerUrls(b$i,b$S,b$f,b$V,b$l.path,b$h)}}break;case"ShuriKenParticle3D":case"MyShuriKenParticle3D":var b$R=(b$K=b$M.customProps).meshPath;b$R&&b$m._addHierarchyInnerUrls(b$y,b$S,b$f,b$V,b$R,b$Zy);var b$A=b$K.material;if(b$A){b$J=b$A.type.split("."),b$h=b$e.window;for(b$C=0,b$v=b$J.length;b$C<b$v;++b$C){b$h=b$h[this.clasPaths[b$C]]}b$m._addHierarchyInnerUrls(b$i,b$S,b$f,b$V,b$A.path,b$h)}else{var b$G=b$K.materialPath;if(b$G)b$m._addHierarchyInnerUrls(b$i,b$S,b$f,b$V,b$G,ShurikenParticleMaterial);else{var b$I=b$K.texturePath;b$I&&b$m._addHierarchyInnerUrls(b$H,b$S,b$f,b$V,b$I,b$_y)}}break;case"Terrain":b$m._addHierarchyInnerUrls(b$H,b$S,b$f,b$V,b$M.customProps.dataPath,TerrainRes)}var b$U=b$M.components;for(var b$Q in b$U){var b$W=b$U[b$Q];switch(b$Q){case"Animator":var b$c=b$W.avatarPath;if(b$c)b$m._addHierarchyInnerUrls(b$H,b$S,b$f,b$V,b$c,Avatar);else{var b$n=b$W.avatar;b$n&&b$m._addHierarchyInnerUrls(b$H,b$S,b$f,b$V,b$n.path,Avatar)}var b$a=b$W.clipPaths;for(b$k=0,b$X=b$a.length;b$k<b$X;b$k++)b$m._addHierarchyInnerUrls(b$H,b$S,b$f,b$V,b$a[b$k],AnimationClip)}}var b$T=b$M.child;for(b$k=0,b$X=b$T.length;b$k<b$X;b$k++)b$m._getSprite3DHierarchyInnerUrls(b$T[b$k],b$y,b$i,b$H,b$S,b$f,b$V)},b$m._loadHierarchy=function(b$M){b$M.on("loaded",null,b$m._onHierarchylhLoaded,[b$M,b$M._class._getGroup()]),b$M.load(b$M.url,"json",!1,null,!0)},b$m._onHierarchylhLoaded=function(b$M,b$y,b$i){if(b$M._class.destroyed)b$M.endLoad();else{var b$H=b$M.url,b$S=b$hy.getURLVerion(b$H),b$f=b$a.getPath(b$H),b$V=[],b$K=[],b$k=[],b$X={};b$m._getSprite3DHierarchyInnerUrls(b$i,b$V,b$K,b$k,b$X,b$S,b$f);var b$F=b$V.length+b$K.length+b$k.length,b$o=b$F+1,b$d=1/b$o;if(b$m._onProcessChange(b$M,0,b$d,1),0<b$k.length){var b$P=b$F/b$o,b$l=b$n.create(null,b$m._onProcessChange,[b$M,b$d,b$P],!1);b$m._innerFourthLevelLoaderManager.create(b$k,b$n.create(null,b$m._onHierarchyInnerForthLevResouLoaded,[b$M,b$y,b$l,b$i,b$X,b$V,b$K,b$d+b$P*b$k.length,b$P]),b$l,null,null,1,!0,b$y)}else b$m._onHierarchyInnerForthLevResouLoaded(b$M,b$y,null,b$i,b$X,b$V,b$K,b$d,b$P)}},b$m._onHierarchyInnerForthLevResouLoaded=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){if(b$M._class.destroyed)b$M.endLoad();else if(b$i&&b$i.recover(),0<b$V.length){var b$X=b$n.create(null,b$m._onProcessChange,[b$M,b$K,b$k],!1);b$m._innerSecondLevelLoaderManager.create(b$V,b$n.create(null,b$m._onHierarchyInnerSecondLevResouLoaded,[b$M,b$y,b$X,b$H,b$S,b$f,b$K+b$k*b$V.length,b$k]),b$i,null,null,1,!0,b$y)}else b$m._onHierarchyInnerSecondLevResouLoaded(b$M,b$y,null,b$H,b$S,b$f,b$K,b$k)},b$m._onHierarchyInnerSecondLevResouLoaded=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K){if(b$M._class.destroyed)b$M.endLoad();else if(b$i&&b$i.recover(),0<b$f.length){var b$k=b$n.create(null,b$m._onProcessChange,[b$M,b$V,b$K],!1);b$m._innerFirstLevelLoaderManager.create(b$f,b$n.create(null,b$m._onHierarchyInnerFirstLevResouLoaded,[b$M,b$k,b$H,b$S]),b$i,null,null,1,!0,b$y)}else b$m._onHierarchyInnerFirstLevResouLoaded(b$M,null,b$H,b$S)},b$m._onHierarchyInnerFirstLevResouLoaded=function(b$M,b$y,b$i,b$H){b$y&&b$y.recover(),b$M.endLoad([b$i,b$H])},b$m._loadTerrain=function(b$M){b$M.on("loaded",null,b$m._onTerrainLtLoaded,[b$M,b$M._class._getGroup()]),b$M.load(b$M.url,"json",!1,null,!0)},b$m._onTerrainLtLoaded=function(b$M,b$y,b$i){if(b$M._class.destroyed)b$M.endLoad();else{var b$H,b$S,b$f=b$M.url,b$V=b$hy.getURLVerion(b$f),b$K=b$a.getPath(b$f),b$k=[],b$X={},b$F=0,b$o=0,b$d=b$i.heightData;b$H=b$d.url,b$S=b$m.formatRelativePath(b$K,b$H),b$V&&(b$S+=b$V),b$H=b$X[b$H]=b$S;var b$P=b$i.detailTexture;for(b$F=0,b$o=b$P.length;b$F<b$o;b$F++)b$k.push({url:b$P[b$F].diffuse});var b$l=b$i.normalMap;for(b$F=0,b$o=b$l.length;b$F<b$o;b$F++)b$k.push({url:b$l[b$F]});var b$J=b$i.alphaMap;for(b$F=0,b$o=b$J.length;b$F<b$o;b$F++)b$k.push({url:b$J[b$F],params:[!1,!1,6408,!0]});for(b$F=0,b$o=b$k.length;b$F<b$o;b$F++){var b$h=b$k[b$F].url;b$S=b$m.formatRelativePath(b$K,b$h),b$V&&(b$S+=b$V),b$k[b$F].url=b$S,b$X[b$h]=b$S}var b$C=b$k.length,b$v=b$C+2,b$R=1/b$v;b$m._onProcessChange(b$M,0,b$R,1);var b$A={heightMapLoaded:!1,texturesLoaded:!1},b$G=b$n.create(null,b$m._onProcessChange,[b$M,b$R,b$R],!1);b$m._innerFourthLevelLoaderManager.create(b$H,b$n.create(null,b$m._onTerrainHeightMapLoaded,[b$M,b$G,b$i,b$X,b$A]),b$G,null,[b$d.numX,b$d.numZ,b$d.bitType,b$d.value],1,!0,b$y);var b$I=b$n.create(null,b$m._onProcessChange,[b$M,2*b$R,b$C/b$v],!1);b$m._innerFourthLevelLoaderManager.create(b$k,b$n.create(null,b$m._onTerrainTexturesLoaded,[b$M,b$I,b$i,b$X,b$A]),b$I,null,null,1,!0,b$y)}},b$m._onTerrainHeightMapLoaded=function(b$M,b$y,b$i,b$H,b$S){b$S.heightMapLoaded=!0,b$S.texturesLoaded&&(b$M.endLoad([b$i,b$H]),b$y.recover())},b$m._onTerrainTexturesLoaded=function(b$M,b$y,b$i,b$H,b$S){b$S.texturesLoaded=!0,b$S.heightMapLoaded&&(b$M.endLoad([b$i,b$H]),b$y.recover())},b$m._loadMesh=function(b$M){b$M.on("loaded",null,b$m._onMeshLmLoaded,[b$M,b$M._class._getGroup()]),b$M.load(b$M.url,"arraybuffer",!1,null,!0)},b$m._onMeshLmLoaded=function(b$M,b$y,b$i){if(b$M._class.destroyed)b$M.endLoad();else{var b$H,b$S,b$f,b$V=b$M.url,b$K=b$hy.getURLVerion(b$V),b$k=b$a.getPath(b$V),b$X={},b$F=0,b$o=0;switch((b$m._readData=new b$I(b$i)).pos=0,b$m._readData.readUTFString()){case"LAYAMODEL:02":case"LAYAMODEL:03":case"LAYAMODEL:0301":var b$d=b$m._readData.getUint32();b$m._readData.pos=b$m._readData.pos+4,b$o=b$m._readData.getUint16(),b$m._readData.pos=b$m._readData.pos+8*b$o;var b$P=b$m._readData.getUint32();for(b$o=b$m._readData.getUint16(),b$m._readData.pos=b$d+b$P,b$H=[],b$F=0;b$F<b$o;b$F++){var b$l=b$m._readData.readUTFString();-1!==b$l.lastIndexOf(".lmat")&&b$H.push(b$l)}break;default:for(b$m.READ_BLOCK(),b$F=0;b$F<2;b$F++){var b$J=b$m._readData.getUint16(),b$h=b$m._strings[b$J],b$C=b$m["READ_"+b$h];if(null==b$C)throw new Error("model file err,no this function:"+b$J+" "+b$h);1===b$F?b$H=b$C.call():b$C.call()}}for(b$F=0,b$f=b$H.length;b$F<b$f;b$F++){var b$v=b$H[b$F];b$S=b$m.formatRelativePath(b$k,b$v),b$K&&(b$S+=b$K),b$H[b$F]=b$S,b$X[b$v]=b$S}if(0<b$H.length){b$m._onProcessChange(b$M,0,.5,1);var b$R=b$n.create(null,b$m._onProcessChange,[b$M,.5,.5],!1);b$m._innerSecondLevelLoaderManager.create(b$H,b$n.create(null,b$m._onMeshMateialLoaded,[b$M,b$R,b$i,b$X]),b$R,null,null,1,!0,b$y)}else b$M.endLoad([b$i,b$X])}},b$m._onMeshMateialLoaded=function(b$M,b$y,b$i,b$H){b$M.endLoad([b$i,b$H]),b$y.recover()},b$m._getMaterialTexturePath=function(b$M,b$y,b$i){var b$H=b$M.length-4;return b$M.indexOf(".dds")!=b$H&&b$M.indexOf(".tga")!=b$H&&b$M.indexOf(".exr")!=b$H&&b$M.indexOf(".DDS")!=b$H&&b$M.indexOf(".TGA")!=b$H&&b$M.indexOf(".EXR")!=b$H||(b$M=b$M.substr(0,b$H)+".png"),b$M=b$m.formatRelativePath(b$i,b$M),b$y&&(b$M+=b$y),b$M},b$m._loadMaterial=function(b$M){b$M.on("loaded",null,b$m._onMaterilLmatLoaded,[b$M,b$M._class._getGroup()]),b$M.load(b$M.url,"json",!1,null,!0)},b$m._onMaterilLmatLoaded=function(b$M,b$y,b$i){if(b$M._class.destroyed)b$M.endLoad();else{var b$H,b$S=b$M.url,b$f=b$hy.getURLVerion(b$S),b$V=b$a.getPath(b$S),b$K=[],b$k={},b$X=b$i.customProps,b$F=b$i.version;if(b$F)switch(b$F){case"LAYAMATERIAL:01":case"LAYAMATERIAL:02":for(var b$o=b$i.props.textures,b$d=0,b$P=b$o.length;b$d<b$P;b$d++){var b$l=b$o[b$d],b$J=b$l.path;if(b$J){var b$h=b$J.length-4;b$J.indexOf(".exr")!=b$h&&b$J.indexOf(".EXR")!=b$h||(b$J=b$J.substr(0,b$h)+".png"),b$H=b$m.formatRelativePath(b$V,b$J),b$f&&(b$H+=b$f),b$K.push({url:b$H,params:b$l.params}),b$k[b$J]=b$H}}break;default:throw new Error("Laya3D:unkonwn version.")}else{var b$C=b$X.diffuseTexture.texture2D;if(b$C&&(b$H=b$m._getMaterialTexturePath(b$C,b$f,b$V),b$K.push(b$H),b$k[b$C]=b$H),b$X.normalTexture){var b$v=b$X.normalTexture.texture2D;b$v&&(b$H=b$m._getMaterialTexturePath(b$v,b$f,b$V),b$K.push(b$H),b$k[b$v]=b$H)}if(b$X.specularTexture){var b$R=b$X.specularTexture.texture2D;b$R&&(b$H=b$m._getMaterialTexturePath(b$R,b$f,b$V),b$K.push(b$H),b$k[b$R]=b$H)}if(b$X.emissiveTexture){var b$A=b$X.emissiveTexture.texture2D;b$A&&(b$H=b$m._getMaterialTexturePath(b$A,b$f,b$V),b$K.push(b$H),b$k[b$A]=b$H)}if(b$X.ambientTexture){var b$G=b$X.ambientTexture.texture2D;b$G&&(b$H=b$m._getMaterialTexturePath(b$G,b$f,b$V),b$K.push(b$H),b$k[b$G]=b$H)}if(b$X.reflectTexture){var b$I=b$X.reflectTexture.texture2D;b$I&&(b$H=b$m._getMaterialTexturePath(b$I,b$f,b$V),b$K.push(b$H),b$k[b$I]=b$H)}}var b$U=b$K.length,b$Q=b$U+1,b$W=1/b$Q;if(b$m._onProcessChange(b$M,0,b$W,1),0<b$U){var b$c=b$n.create(null,b$m._onProcessChange,[b$M,b$W,b$U/b$Q],!1);b$m._innerFourthLevelLoaderManager.create(b$K,b$n.create(null,b$m._onMateialTexturesLoaded,[b$M,b$c,b$i,b$k]),b$c,b$_y,null,1,!0,b$y)}else b$m._onMateialTexturesLoaded(b$M,null,b$i,null)}},b$m._onMateialTexturesLoaded=function(b$M,b$y,b$i,b$H){b$M.endLoad([b$i,b$H]),b$y&&b$y.recover()},b$m._loadTextureCube=function(b$M){b$M.on("loaded",null,b$m._onTextureCubeLtcLoaded,[b$M]),b$M.load(b$M.url,"json",!1,null,!0)},b$m._onTextureCubeLtcLoaded=function(b$M,b$y){if(b$M._class.destroyed)b$M.endLoad();else{var b$i=b$a.getPath(b$M.url),b$H=[b$m.formatRelativePath(b$i,b$y.px),b$m.formatRelativePath(b$i,b$y.nx),b$m.formatRelativePath(b$i,b$y.py),b$m.formatRelativePath(b$i,b$y.ny),b$m.formatRelativePath(b$i,b$y.pz),b$m.formatRelativePath(b$i,b$y.nz)];b$m._onProcessChange(b$M,0,1/7,1);var b$S=b$n.create(null,b$m._onProcessChange,[b$M,1/7,6/7],!1);b$m._innerFourthLevelLoaderManager.load(b$H,b$n.create(null,b$m._onTextureCubeImagesLoaded,[b$M,b$H,b$S]),b$S,"nativeimage")}},b$m._onTextureCubeImagesLoaded=function(b$M,b$y,b$i){var b$H=[];b$H.length=6;for(var b$S=0;b$S<6;b$S++){var b$f=b$y[b$S];b$H[b$S]=b$C.getRes(b$f),b$C.clearRes(b$f)}b$M.endLoad(b$H),b$i.recover()},b$m._onProcessChange=function(b$M,b$y,b$i,b$H){(b$H=b$y+b$H*b$i)<1&&b$M.event("progress",b$H)},b$m.init=function(b$M,b$y,b$i,b$H,b$S,b$f){if(void 0===b$i&&(b$i=!1),void 0===b$H&&(b$H=!1),void 0===b$S&&(b$S=!0),void 0===b$f&&(b$f=!0),b$v.update3DLoop=function(){},b$v.cancelLoadByUrl=function(b$M){b$m._cancelLoadByUrl(b$M)},b$k.isAntialias=b$i,b$k.isAlpha=b$H,b$k.premultipliedAlpha=b$S,b$k.isStencil=b$f,!b$T.enable())throw new Error("Laya3D启动失败！\n模拟器：请尝试使用《雷电模拟器》最新版本！\n浏览器：请尝试关闭浏览器，确保浏览器进程全部结束后再进游戏！");b$v.changeWebGLSize=b$m._changeWebGLSize,b$J.is3DMode=!0,b$G.init(b$M,b$y),b$s.__init__(),b$oy.__init__(),b$Ny.__init__(),b$B.__init__(),b$m.__init__(),b$V.maxTextureCount=2,(b$m.debugMode||b$x.debugMode)&&(b$m._debugPhasorSprite=new b$Y)},b$m.HIERARCHY="SPRITE3DHIERARCHY",b$m.MESH="MESH",b$m.MATERIAL="MATERIAL",b$m.PBRMATERIAL="PBRMTL",b$m.TEXTURECUBE="TEXTURECUBE",b$m.TERRAIN="TERRAIN",b$m._readData=null,b$m._debugPhasorSprite=null,b$m.debugMode=!1,b$o(b$m,["_DATA",function(){return this._DATA={offset:0,size:0}},"_strings",function(){return this._strings=["BLOCK","DATA","STRINGS"]},"_innerFirstLevelLoaderManager",function(){return this._innerFirstLevelLoaderManager=new b$y},"_innerSecondLevelLoaderManager",function(){return this._innerSecondLevelLoaderManager=new b$y},"_innerThirdLevelLoaderManager",function(){return this._innerThirdLevelLoaderManager=new b$y},"_innerFourthLevelLoaderManager",function(){return this._innerFourthLevelLoaderManager=new b$y}]),b$m}(),b$vy=function(b$M){function b$S(b$M){b$S.__super.call(this),this._owner=b$M,this._childs=[],this._localMatrix=new Float32Array(16),this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0}b$P(b$S,"laya.d3.animation.AnimationTransform3D",b$f);var b$y=b$S.prototype;return b$y._getlocalMatrix=function(){return this._localUpdate&&(b$hy._createAffineTransformationArray(this._localPosition,this._localRotation,this._localScale,this._localMatrix),this._localUpdate=!1),this._localMatrix},b$y._onWorldTransform=function(){if(!this._worldUpdate){this._worldUpdate=!0;for(var b$M=0,b$y=this._childs.length;b$M<b$y;b$M++)this._childs[b$M]._onWorldTransform()}},b$y._setWorldMatrixAndUpdate=function(b$M){if(this._worldMatrix=b$M,null==this._parent)throw new Error("don't need to set worldMatrix to root Node.");if(null==this._parent._parent)for(var b$y=this._getlocalMatrix(),b$i=0;b$i<16;++b$i)this._worldMatrix[b$i]=b$y[b$i];else b$hy.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);this._worldUpdate=!1},b$y._setWorldMatrixNoUpdate=function(b$M){this._worldMatrix=b$M},b$y._setWorldMatrixIgnoreUpdate=function(b$M){this._worldMatrix=b$M,this._worldUpdate=!1},b$y.getLocalPosition=function(){return this._localPosition},b$y.setLocalPosition=function(b$M){if(this._parent)this._localPosition=b$M,this._localUpdate=!0,this._onWorldTransform();else{var b$y=this._entity.owner._transform,b$i=this._entity.localPosition,b$H=b$i.elements;b$H[0]=b$M[0],b$H[1]=b$M[1],b$H[2]=b$M[2],b$y.localPosition=b$i}},b$y.getLocalRotation=function(){if(this._localQuaternionUpdate){var b$M=this._localRotationEuler;b$hy._quaternionCreateFromYawPitchRollArray(b$M[1]/b$S._angleToRandin,b$M[0]/b$S._angleToRandin,b$M[2]/b$S._angleToRandin,this._localRotation),this._localQuaternionUpdate=!1}return this._localRotation},b$y.setLocalRotation=function(b$M){if(this._parent)this._localRotation=b$M,b$hy.quaterionNormalize(this._localRotation,this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var b$y=this._entity.owner._transform,b$i=this._entity.localRotation,b$H=b$i.elements;b$H[0]=b$M[0],b$H[1]=b$M[1],b$H[2]=b$M[2],b$H[3]=b$M[3],b$y.localRotation=b$i}},b$y.getLocalScale=function(){return this._localScale},b$y.setLocalScale=function(b$M){if(this._parent)this._localScale=b$M,this._localUpdate=!0,this._onWorldTransform();else{var b$y=this._entity.owner._transform,b$i=this._entity.localScale,b$H=b$i.elements;b$H[0]=b$M[0],b$H[1]=b$M[1],b$H[2]=b$M[2],b$y.localScale=b$i}},b$y.getLocalRotationEuler=function(){if(this._locaEulerlUpdate){b$hy.getYawPitchRoll(this._localRotation,b$S._tempVector3);var b$M=b$S._tempVector3,b$y=this._localRotationEuler;b$y[0]=b$M[1]*b$S._angleToRandin,b$y[1]=b$M[0]*b$S._angleToRandin,b$y[2]=b$M[2]*b$S._angleToRandin,this._locaEulerlUpdate=!1}return this._localRotationEuler},b$y.setLocalRotationEuler=function(b$M){if(this._parent)b$hy._quaternionCreateFromYawPitchRollArray(b$M[1]/b$S._angleToRandin,b$M[0]/b$S._angleToRandin,b$M[2]/b$S._angleToRandin,this._localRotation),this._localRotationEuler=b$M,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!1,this._localUpdate=!0,this._onWorldTransform();else{var b$y=this._entity.owner._transform,b$i=this._entity.localRotationEuler,b$H=b$i.elements;b$H[0]=b$M[0],b$H[1]=b$M[1],b$H[2]=b$M[2],b$y.localRotationEuler=b$i}},b$y.getWorldMatrix=function(){if(this._worldUpdate){if(null!=this._parent._parent)b$hy.matrix4x4MultiplyFFF(this._parent.getWorldMatrix(),this._getlocalMatrix(),this._worldMatrix);else for(var b$M=this._getlocalMatrix(),b$y=0;b$y<16;++b$y)this._worldMatrix[b$y]=b$M[b$y];this._worldUpdate=!1}return this._worldMatrix},b$y.setParent=function(b$M){if(this._parent!==b$M){if(this._parent){var b$y=this._parent._childs,b$i=b$y.indexOf(this);b$y.splice(b$i,1)}b$M&&(b$M._childs.push(this),b$M&&this._onWorldTransform()),this._parent=b$M}},b$o(b$S,["_tempVector3",function(){return this._tempVector3=new Float32Array(3)},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),b$S}(),b$Ry=function(b$M){function b$y(){this._destroyed=!1,this._id=0,this._enable=!1,this._owner=null,this.started=!1,b$y.__super.call(this),this._destroyed=!1,this._id=b$y._uniqueIDCounter,b$y._uniqueIDCounter++}b$P(b$y,"laya.d3.component.Component3D",b$f);var b$i=b$y.prototype;return b$G.imps(b$i,{"laya.d3.core.render.IUpdate":!0,"laya.resource.IDestroy":!0}),b$i._initialize=function(b$M){this._owner=b$M,this._enable=!0,this.started=!1,this._load(b$M)},b$i._destroy=function(){this._unload(this._owner),this._owner=null,this._destroyed=!0},b$i._load=function(b$M){},b$i._start=function(b$M){},b$i._update=function(b$M){},b$i._lateUpdate=function(b$M){},b$i._preRenderUpdate=function(b$M){},b$i._postRenderUpdate=function(b$M){},b$i._unload=function(b$M){this.offAll()},b$i._cloneTo=function(b$M){},b$l(0,b$i,"id",function(){return this._id}),b$l(0,b$i,"destroyed",function(){return this._destroyed}),b$l(0,b$i,"owner",function(){return this._owner}),b$l(0,b$i,"enable",function(){return this._enable},function(b$M){this._enable!==b$M&&(this._enable=b$M,this.event("enablechanged",this._enable))}),b$l(0,b$i,"isSingleton",function(){return b$y._isSingleton}),b$y._isSingleton=!0,b$y._uniqueIDCounter=1,b$y}(),b$Ay=function(b$M){function b$y(){this._destroyed=!1,b$y.__super.call(this),this._destroyed=!1}b$P(b$y,"laya.d3.core.GeometryFilter",b$f);var b$i=b$y.prototype;return b$G.imps(b$i,{"laya.resource.IDestroy":!0}),b$i._destroy=function(){this.offAll(),this._destroyed=!0},b$l(0,b$i,"_isAsyncLoaded",function(){return!0}),b$l(0,b$i,"_originalBoundingBoxCorners",function(){throw new Error("BaseRender: must override it.")}),b$l(0,b$i,"_originalBoundingSphere",function(){throw new Error("BaseRender: must override it.")}),b$l(0,b$i,"_originalBoundingBox",function(){throw new Error("BaseRender: must override it.")}),b$l(0,b$i,"destroyed",function(){return this._destroyed}),b$y}(),b$Gy=function(b$M){function b$H(b$M){b$H.__super.call(this),this._id=++b$H._uniqueIDCounter,this._indexInSceneFrustumCullingObjects=-1,this._boundingBox=new b$xM(new b$Vy,new b$Vy),this._boundingBoxCenter=new b$Vy,this._boundingSphere=new b$jM(new b$Vy,0),this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0,this._materials=[],this._renderElements=[],this._isPartOfStaticBatch=!1,this._destroyed=!1,this._owner=b$M,this._enable=!0,this._materialsInstance=[],this.lightmapIndex=-1,this.castShadow=!1,this.receiveShadow=!1,this.sortingFudge=0,this._owner.transform.on("worldmatrixneedchanged",this,this._onWorldMatNeedChange)}b$P(b$H,"laya.d3.core.render.BaseRender",b$f);var b$y=b$H.prototype;return b$G.imps(b$y,{"laya.resource.IDestroy":!0}),b$y._changeMaterialReference=function(b$M,b$y){b$M&&b$M._removeReference(),b$y._addReference()},b$y._getInstanceMaterial=function(b$M,b$y){var b$i=new b$M.constructor;return b$M.cloneTo(b$i),b$i.name=b$i.name+"(Instance)",this._materialsInstance[b$y]=!0,this._changeMaterialReference(this._materials[b$y],b$i),this._materials[b$y]=b$i},b$y._setShaderValuelightMap=function(b$M){this._setShaderValueTexture(3,b$M)},b$y._onWorldMatNeedChange=function(){this._boundingSphereNeedChange=!0,this._boundingBoxNeedChange=!0,this._boundingBoxCenterNeedChange=!0,this._octreeNodeNeedChange=!0},b$y._renderRenderableBoundBox=function(){var b$M=b$Cy._debugPhasorSprite,b$y=this.boundingBox,b$i=b$H._tempBoundBoxCorners;b$y.getCorners(b$i),b$M.line(b$i[0],b$H._greenColor,b$i[1],b$H._greenColor),b$M.line(b$i[2],b$H._greenColor,b$i[3],b$H._greenColor),b$M.line(b$i[4],b$H._greenColor,b$i[5],b$H._greenColor),b$M.line(b$i[6],b$H._greenColor,b$i[7],b$H._greenColor),b$M.line(b$i[0],b$H._greenColor,b$i[3],b$H._greenColor),b$M.line(b$i[1],b$H._greenColor,b$i[2],b$H._greenColor),b$M.line(b$i[2],b$H._greenColor,b$i[6],b$H._greenColor),b$M.line(b$i[3],b$H._greenColor,b$i[7],b$H._greenColor),b$M.line(b$i[0],b$H._greenColor,b$i[4],b$H._greenColor),b$M.line(b$i[1],b$H._greenColor,b$i[5],b$H._greenColor),b$M.line(b$i[4],b$H._greenColor,b$i[7],b$H._greenColor),b$M.line(b$i[5],b$H._greenColor,b$i[6],b$H._greenColor)},b$y._calculateBoundingSphere=function(){throw"BaseRender: must override it."},b$y._calculateBoundingBox=function(){throw"BaseRender: must override it."},b$y._setShaderValueTexture=function(b$M,b$y){this._owner._shaderValues.setValue(b$M,b$y)},b$y._setShaderValueMatrix4x4=function(b$M,b$y){this._owner._shaderValues.setValue(b$M,b$y?b$y.elements:null)},b$y._setShaderValueColor=function(b$M,b$y){this._owner._shaderValues.setValue(b$M,b$y?b$y.elements:null)},b$y._setShaderValueBuffer=function(b$M,b$y){this._owner._shaderValues.setValue(b$M,b$y)},b$y._setShaderValueInt=function(b$M,b$y){this._owner._shaderValues.setValue(b$M,b$y)},b$y._setShaderValueBool=function(b$M,b$y){this._owner._shaderValues.setValue(b$M,b$y)},b$y._setShaderValueNumber=function(b$M,b$y){this._owner._shaderValues.setValue(b$M,b$y)},b$y._setShaderValueVector2=function(b$M,b$y){this._owner._shaderValues.setValue(b$M,b$y?b$y.elements:null)},b$y._addShaderDefine=function(b$M){this._owner._shaderDefineValue|=b$M},b$y._removeShaderDefine=function(b$M){this._owner._shaderDefineValue&=~b$M},b$y._renderUpdate=function(b$M){return!0},b$y._applyLightMapParams=function(){if(0<=this._lightmapIndex){var b$M=this._owner.scene;if(b$M){var b$y=b$M.getlightmaps()[this._lightmapIndex];b$y?(this._addShaderDefine(b$Yy.SAHDERDEFINE_LIGHTMAP),b$y.loaded?this._setShaderValuelightMap(b$y):b$y.once("loaded",this,this._setShaderValuelightMap)):this._removeShaderDefine(b$Yy.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(b$Yy.SAHDERDEFINE_LIGHTMAP)}else this._removeShaderDefine(b$Yy.SAHDERDEFINE_LIGHTMAP)},b$y._updateOctreeNode=function(){var b$M=this._treeNode;b$M&&this._octreeNodeNeedChange&&(b$M.updateObject(this),this._octreeNodeNeedChange=!1)},b$y._destroy=function(){this.offAll();var b$M=0,b$y=0;for(b$M=0,b$y=this._renderElements.length;b$M<b$y;b$M++)this._renderElements[b$M]._destroy();for(b$M=0,b$y=this._materials.length;b$M<b$y;b$M++)this._materials[b$M]._removeReference();this._renderElements=null,this._owner=null,this._materials=null,this._boundingBox=null,this._boundingBoxCenter=null,this._boundingSphere=null,this._lightmapScaleOffset=null,this._destroyed=!0},b$l(0,b$y,"boundingSphere",function(){return this._boundingSphereNeedChange&&(this._calculateBoundingSphere(),this._boundingSphereNeedChange=!1),this._boundingSphere}),b$l(0,b$y,"id",function(){return this._id}),b$l(0,b$y,"material",function(){var b$M=this._materials[0];if(b$M&&!this._materialsInstance[0]){var b$y=this._getInstanceMaterial(b$M,0);this.event("materialchanged",[this,0,b$y])}return this._materials[0]},function(b$M){this.sharedMaterial=b$M}),b$l(0,b$y,"sharedMaterial",function(){return this._materials[0]},function(b$M){var b$y=this._materials[0];b$y!==b$M&&(this._materials[0]=b$M,this._materialsInstance[0]=!1,this._changeMaterialReference(b$y,b$M),this.event("materialchanged",[this,0,b$M]))}),b$l(0,b$y,"lightmapIndex",function(){return this._lightmapIndex},function(b$M){this._lightmapIndex=b$M,this._applyLightMapParams()}),b$l(0,b$y,"lightmapScaleOffset",function(){return this._lightmapScaleOffset},function(b$M){this._lightmapScaleOffset=b$M,this._setShaderValueColor(2,b$M),this._addShaderDefine(b$Yy.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV)}),b$l(0,b$y,"enable",function(){return this._enable},function(b$M){this._enable=b$M,this.event("enablechanged",[this,b$M])}),b$l(0,b$y,"materials",function(){for(var b$M=0,b$y=this._materials.length;b$M<b$y;b$M++)if(!this._materialsInstance[b$M]){var b$i=this._getInstanceMaterial(this._materials[b$M],b$M);this.event("materialchanged",[this,b$M,b$i])}return this._materials.slice()},function(b$M){this.sharedMaterials=b$M}),b$l(0,b$y,"sharedMaterials",function(){return this._materials.slice()},function(b$M){if(!b$M)throw new Error("MeshRender: shadredMaterials value can't be null.");var b$y=b$M.length;this._materialsInstance.length=b$y;for(var b$i=0;b$i<b$y;b$i++){var b$H=this._materials[b$i];b$H!==b$M[b$i]&&(this._materialsInstance[b$i]=!1,this._changeMaterialReference(b$H,b$M[b$i]),this.event("materialchanged",[this,b$i,b$M[b$i]]))}this._materials=b$M}),b$l(0,b$y,"boundingBox",function(){return this._boundingBoxNeedChange&&(this._calculateBoundingBox(),this._boundingBoxNeedChange=!1),this._boundingBox}),b$l(0,b$y,"boundingBoxCenter",function(){if(this._boundingBoxCenterNeedChange){var b$M=this.boundingBox;b$Vy.add(b$M.min,b$M.max,this._boundingBoxCenter),b$Vy.scale(this._boundingBoxCenter,.5,this._boundingBoxCenter),this._boundingBoxCenterNeedChange=!1}return this._boundingBoxCenter}),b$l(0,b$y,"receiveShadow",function(){return this._receiveShadow},function(b$M){this._receiveShadow!==b$M&&((this._receiveShadow=b$M)?this._addShaderDefine(b$Py.SHADERDEFINE_RECEIVE_SHADOW):this._removeShaderDefine(b$Py.SHADERDEFINE_RECEIVE_SHADOW))}),b$l(0,b$y,"destroyed",function(){return this._destroyed}),b$H._uniqueIDCounter=0,b$o(b$H,["_tempBoundBoxCorners",function(){return this._tempBoundBoxCorners=[new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy,new b$Vy]},"_greenColor",function(){return this._greenColor=new b$Ky(0,1,0,1)}]),b$H}(),b$Iy=function(b$M){function b$K(b$M){this._owner=null,this._localQuaternionUpdate=!1,this._locaEulerlUpdate=!1,this._localUpdate=!1,this._worldUpdate=!0,this._positionUpdate=!0,this._rotationUpdate=!0,this._scaleUpdate=!0,this._parent=null,this._childs=null,this._dummy=null,this.pivot=null,b$K.__super.call(this),this._localPosition=new b$Vy,this._localRotation=new b$iy(0,0,0,1),this._localScale=new b$Vy(1,1,1),this._localRotationEuler=new b$Vy,this._localMatrix=new b$My,this._position=new b$Vy,this._rotation=new b$iy(0,0,0,1),this._scale=new b$Vy(1,1,1),this._worldMatrix=new b$My,this._forward=new b$Vy,this._up=new b$Vy,this._right=new b$Vy,this._owner=b$M,this._childs=[]}b$P(b$K,"laya.d3.core.Transform3D",b$f);var b$y=b$K.prototype;return b$y._updateLocalMatrix=function(){if(!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z)b$My.createAffineTransformation(this._localPosition,this.localRotation,this._localScale,this._localMatrix);else{var b$M=b$K._tempVector30;b$Vy.multiply(this.pivot,this._localScale,b$M);var b$y=b$K._tempVector31;b$Vy.subtract(b$M,this.pivot,b$y);var b$i=b$K._tempVector32,b$H=this.localRotation;b$Vy.transformQuat(b$M,b$H,b$i),b$Vy.subtract(b$i,b$M,b$i);var b$S=b$K._tempVector33;b$Vy.subtract(this._localPosition,b$y,b$S),b$Vy.subtract(b$S,b$i,b$S),b$My.createAffineTransformation(b$S,b$H,this._localScale,this._localMatrix)}},b$y._onWorldPositionRotationTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._rotationUpdate){this._worldUpdate=this._positionUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var b$M=0,b$y=this._childs.length;b$M<b$y;b$M++)this._childs[b$M]._onWorldPositionRotationTransform()}},b$y._onWorldPositionScaleTransform=function(){if(!this._worldUpdate||!this._positionUpdate||!this._scaleUpdate){this._worldUpdate=this._positionUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var b$M=0,b$y=this._childs.length;b$M<b$y;b$M++)this._childs[b$M]._onWorldPositionScaleTransform()}},b$y._onWorldPositionTransform=function(){if(!this._worldUpdate||!this._positionUpdate){this._worldUpdate=this._positionUpdate=!0,this.event("worldmatrixneedchanged");for(var b$M=0,b$y=this._childs.length;b$M<b$y;b$M++)this._childs[b$M]._onWorldPositionTransform()}},b$y._onWorldRotationTransform=function(){if(!this._worldUpdate||!this._rotationUpdate){this._worldUpdate=this._rotationUpdate=!0,this.event("worldmatrixneedchanged");for(var b$M=0,b$y=this._childs.length;b$M<b$y;b$M++)this._childs[b$M]._onWorldPositionRotationTransform()}},b$y._onWorldScaleTransform=function(){if(!this._worldUpdate||!this._scaleUpdate){this._worldUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var b$M=0,b$y=this._childs.length;b$M<b$y;b$M++)this._childs[b$M]._onWorldPositionScaleTransform()}},b$y._onWorldTransform=function(){if(!(this._worldUpdate&&this._positionUpdate&&this._rotationUpdate&&this._scaleUpdate)){this._worldUpdate=this._positionUpdate=this._rotationUpdate=this._scaleUpdate=!0,this.event("worldmatrixneedchanged");for(var b$M=0,b$y=this._childs.length;b$M<b$y;b$M++)this._childs[b$M]._onWorldTransform()}},b$y.translate=function(b$M,b$y){void 0===b$y&&(b$y=!0),b$y?(b$My.createFromQuaternion(this.localRotation,b$K._tempMatrix0),b$Vy.transformCoordinate(b$M,b$K._tempMatrix0,b$K._tempVector30),b$Vy.add(this.localPosition,b$K._tempVector30,this._localPosition),this.localPosition=this._localPosition):(b$Vy.add(this.position,b$M,this._position),this.position=this._position)},b$y.rotate=function(b$M,b$y,b$i){var b$H;void 0===b$y&&(b$y=!0),void 0===b$i&&(b$i=!0),b$H=b$i?b$M:(b$Vy.scale(b$M,Math.PI/180,b$K._tempVector30),b$K._tempVector30),b$iy.createFromYawPitchRoll(b$H.y,b$H.x,b$H.z,b$K._tempQuaternion0),b$y?(b$iy.multiply(this._localRotation,b$K._tempQuaternion0,this._localRotation),this.localRotation=this._localRotation):(b$iy.multiply(b$K._tempQuaternion0,this.rotation,this._rotation),this.rotation=this._rotation)},b$y.lookAt=function(b$M,b$y,b$i){void 0===b$i&&(b$i=!1);var b$H,b$S=b$M.elements;if(b$i){if(b$H=this._localPosition.elements,Math.abs(b$H[0]-b$S[0])<b$OM.zeroTolerance&&Math.abs(b$H[1]-b$S[1])<b$OM.zeroTolerance&&Math.abs(b$H[2]-b$S[2])<b$OM.zeroTolerance)return;b$iy.lookAt(this._localPosition,b$M,b$y,this._localRotation),this._localRotation.invert(this._localRotation),this.localRotation=this._localRotation}else{var b$f=this.position;if(b$H=b$f.elements,Math.abs(b$H[0]-b$S[0])<b$OM.zeroTolerance&&Math.abs(b$H[1]-b$S[1])<b$OM.zeroTolerance&&Math.abs(b$H[2]-b$S[2])<b$OM.zeroTolerance)return;b$iy.lookAt(b$f,b$M,b$y,this._rotation),this._rotation.invert(this._rotation),this.rotation=this._rotation}},b$l(0,b$y,"_isFrontFaceInvert",function(){var b$M=this.scale,b$y=b$M.x<0;return b$M.y<0&&(b$y=!b$y),b$M.z<0&&(b$y=!b$y),b$y}),b$l(0,b$y,"owner",function(){return this._owner}),b$l(0,b$y,"localRotation",function(){if(this._localQuaternionUpdate){var b$M=this._localRotationEuler.elements;b$iy.createFromYawPitchRoll(b$M[1]/b$K._angleToRandin,b$M[0]/b$K._angleToRandin,b$M[2]/b$K._angleToRandin,this._localRotation)}return this._localRotation},function(b$M){this._localRotation=b$M,this._localRotation.normalize(this._localRotation),this._locaEulerlUpdate=!0,this._localQuaternionUpdate=!1,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),b$l(0,b$y,"worldMatrix",function(){return this._worldUpdate&&(null!=this._parent?b$My.multiply(this._parent.worldMatrix,this.localMatrix,this._worldMatrix):this.localMatrix.cloneTo(this._worldMatrix),this._worldUpdate=!1),this._worldMatrix},function(b$M){null===this._parent?b$M.cloneTo(this._localMatrix):(this._parent.worldMatrix.invert(this._localMatrix),b$My.multiply(this._localMatrix,b$M,this._localMatrix)),this.localMatrix=this._localMatrix,this._worldMatrix=b$M,this._worldUpdate=!1}),b$l(0,b$y,"worldNeedUpdate",function(){return this._worldUpdate}),b$l(0,b$y,"localMatrix",function(){return this._localUpdate&&(this._updateLocalMatrix(),this._localUpdate=!1),this._localMatrix},function(b$M){this._localMatrix=b$M,this._localMatrix.decomposeTransRotScale(this._localPosition,this._localRotation,this._localScale),this._localUpdate=!1,this._onWorldTransform()}),b$l(0,b$y,"dummy",function(){return this._dummy},function(b$M){this._dummy!==b$M&&(this._dummy&&(this._dummy._entity=null),b$M&&(b$M._entity=this),this._dummy=b$M)}),b$l(0,b$y,"localPosition",function(){return this._localPosition},function(b$M){this._localPosition=b$M,this._localUpdate=!0,this._onWorldPositionTransform()}),b$l(0,b$y,"position",function(){if(this._positionUpdate){if(null!=this._parent){var b$M=this._parent.position;b$Vy.multiply(this._localPosition,this._parent.scale,b$K._tempVector30),b$Vy.transformQuat(b$K._tempVector30,this._parent.rotation,b$K._tempVector30),b$Vy.add(b$M,b$K._tempVector30,this._position)}else this._localPosition.cloneTo(this._position);this._positionUpdate=!1}return this._position},function(b$M){if(null!=this._parent){b$Vy.subtract(b$M,this._parent.position,this._localPosition);var b$y=this._parent.scale.elements,b$i=b$y[0],b$H=b$y[1],b$S=b$y[2];if(1!==b$i||1!==b$H||1!==b$S){var b$f=b$K._tempVector30,b$V=b$f.elements;b$V[0]=1/b$i,b$V[1]=1/b$H,b$V[2]=1/b$S,b$Vy.multiply(this._localPosition,b$f,this._localPosition)}this._parent.rotation.invert(b$K._tempQuaternion0),b$Vy.transformQuat(this._localPosition,b$K._tempQuaternion0,this._localPosition)}else b$M.cloneTo(this._localPosition);this.localPosition=this._localPosition,this._position=b$M,this._positionUpdate=!1}),b$l(0,b$y,"localScale",function(){return this._localScale},function(b$M){this._localScale=b$M,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldScaleTransform():this._onWorldPositionScaleTransform()}),b$l(0,b$y,"localRotationEuler",function(){if(this._locaEulerlUpdate){this._localRotation.getYawPitchRoll(b$K._tempVector30);var b$M=b$K._tempVector30.elements,b$y=this._localRotationEuler.elements;b$y[0]=b$M[1]*b$K._angleToRandin,b$y[1]=b$M[0]*b$K._angleToRandin,b$y[2]=b$M[2]*b$K._angleToRandin}return this._localRotationEuler},function(b$M){this._localRotationEuler=b$M,this._locaEulerlUpdate=!1,this._localQuaternionUpdate=!0,this._localUpdate=!0,!this.pivot||0===this.pivot.x&&0===this.pivot.y&&0===this.pivot.z?this._onWorldRotationTransform():this._onWorldPositionRotationTransform()}),b$l(0,b$y,"rotation",function(){return this._rotationUpdate&&(null!=this._parent?b$iy.multiply(this._parent.rotation,this.localRotation,this._rotation):this.localRotation.cloneTo(this._rotation),this._rotationUpdate=!1),this._rotation},function(b$M){null!=this._parent?(this._parent.rotation.invert(b$K._tempQuaternion0),b$iy.multiply(b$M,b$K._tempQuaternion0,this._localRotation)):b$M.cloneTo(this._localRotation),this.localRotation=this._localRotation,this._rotation=b$M,this._rotationUpdate=!1}),b$l(0,b$y,"scale",function(){return this._scaleUpdate&&(null!==this._parent?b$Vy.multiply(this._parent.scale,this._localScale,this._scale):this._localScale.cloneTo(this._scale),this._scaleUpdate=!1),this._scale},function(b$M){if(null!==this._parent){var b$y=this._parent.scale.elements,b$i=b$K._tempVector30.elements;b$i[0]=1/b$y[0],b$i[1]=1/b$y[1],b$i[2]=1/b$y[2],b$Vy.multiply(b$M,b$K._tempVector30,this._localScale)}else b$M.cloneTo(this._localScale);this.localScale=this._localScale,this._scale=b$M,this._scaleUpdate=!1}),b$l(0,b$y,"rotationEuler",null,function(b$M){b$iy.createFromYawPitchRoll(b$M.y,b$M.x,b$M.z,this._rotation),this.rotation=this._rotation}),b$l(0,b$y,"forward",function(){var b$M=this.worldMatrix.elements;return this._forward.elements[0]=-b$M[8],this._forward.elements[1]=-b$M[9],this._forward.elements[2]=-b$M[10],this._forward}),b$l(0,b$y,"up",function(){var b$M=this.worldMatrix.elements;return this._up.elements[0]=b$M[4],this._up.elements[1]=b$M[5],this._up.elements[2]=b$M[6],this._up}),b$l(0,b$y,"right",function(){var b$M=this.worldMatrix.elements;return this._right.elements[0]=b$M[0],this._right.elements[1]=b$M[1],this._right.elements[2]=b$M[2],this._right}),b$l(0,b$y,"parent",function(){return this._parent},function(b$M){if(this._parent!==b$M){if(this._parent){var b$y=this._parent._childs,b$i=b$y.indexOf(this);b$y.splice(b$i,1)}b$M&&(b$M._childs.push(this),b$M&&this._onWorldTransform()),this._parent=b$M}}),b$o(b$K,["_tempVector30",function(){return this._tempVector30=new b$Vy},"_tempVector31",function(){return this._tempVector31=new b$Vy},"_tempVector32",function(){return this._tempVector32=new b$Vy},"_tempVector33",function(){return this._tempVector33=new b$Vy},"_tempQuaternion0",function(){return this._tempQuaternion0=new b$iy},"_tempMatrix0",function(){return this._tempMatrix0=new b$My},"_angleToRandin",function(){return this._angleToRandin=180/Math.PI}]),b$K}(),b$Uy=(function(b$M){function b$y(){this._rotation=0,this._matNeedUpdte=!1,b$y.__super.call(this),this._matrix=new b$My,this._offset=new b$fy,this._tiling=new b$fy(1,1)}b$P(b$y,"laya.d3.core.TransformUV",b$f);var b$i=b$y.prototype;b$G.imps(b$i,{"laya.d3.core.IClone":!0}),b$i._updateMatrix=function(){b$y._tempOffsetV3.elements[0]=this._offset.x,b$y._tempOffsetV3.elements[1]=this._offset.y,b$iy.createFromYawPitchRoll(0,0,this._rotation,b$y._tempRotationQua),b$y._tempTitlingV3.elements[0]=this._tiling.x,b$y._tempTitlingV3.elements[1]=this._tiling.y,b$My.createAffineTransformation(b$y._tempOffsetV3,b$y._tempRotationQua,b$y._tempTitlingV3,this._matrix)},b$i.cloneTo=function(b$M){b$M._matrix=this._matrix.clone(),b$M._offset=this._offset.clone(),b$M._rotation=this._rotation,b$M._tiling=this._tiling.clone()},b$i.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$i,"matrix",function(){return this._matNeedUpdte&&(this._updateMatrix(),this._matNeedUpdte=!1),this._matrix}),b$l(0,b$i,"tiling",function(){return this._tiling},function(b$M){this._tiling=b$M,this._matNeedUpdte=!0}),b$l(0,b$i,"offset",function(){return this._offset},function(b$M){this._offset=b$M,this._matNeedUpdte=!0}),b$l(0,b$i,"rotation",function(){return this._rotation},function(b$M){this._rotation=b$M,this._matNeedUpdte=!0}),b$o(b$y,["_tempOffsetV3",function(){return this._tempOffsetV3=new b$Vy(0,0,0)},"_tempRotationQua",function(){return this._tempRotationQua=new b$iy},"_tempTitlingV3",function(){return this._tempTitlingV3=new b$Vy(1,1,1)}])}(),function(b$i){function b$M(){this.x=NaN,this.y=NaN,this.z=NaN,b$M.__super.call(this),this.x=1,this.y=1,this.z=1,this.randomDirection=!1}b$P(b$M,"laya.d3.core.particleShuriKen.module.shape.BoxShape",b$i);var b$y=b$M.prototype;b$y._getShapeBoundBox=function(b$M){var b$y=b$M.min.elements;b$y[0]=.5*-this.x,b$y[1]=.5*-this.y,b$y[2]=.5*-this.z;var b$i=b$M.max.elements;b$i[0]=.5*this.x,b$i[1]=.5*this.y,b$i[2]=.5*this.z},b$y._getSpeedBoundBox=function(b$M){var b$y=b$M.min.elements;b$y[0]=0,b$y[1]=0,b$y[2]=0;var b$i=b$M.max.elements;b$i[0]=0,b$i[1]=1,b$i[2]=0},b$y.generatePositionAndDirection=function(b$M,b$y,b$i,b$H){var b$S=b$M.elements,b$f=b$y.elements;b$i?(b$i.seed=b$H[16],b$_._randomPointInsideHalfUnitBox(b$M,b$i),b$H[16]=b$i.seed):b$_._randomPointInsideHalfUnitBox(b$M),b$S[0]=this.x*b$S[0],b$S[1]=this.y*b$S[1],b$S[2]=this.z*b$S[2],this.randomDirection?b$i?(b$i.seed=b$H[17],b$_._randomPointUnitSphere(b$y,b$i),b$H[17]=b$i.seed):b$_._randomPointUnitSphere(b$y):(b$f[0]=0,b$f[1]=0,b$f[2]=1)},b$y.cloneTo=function(b$M){b$i.prototype.cloneTo.call(this,b$M);var b$y=b$M;b$y.x=this.x,b$y.y=this.y,b$y.z=this.z,b$y.randomDirection=this.randomDirection}}(b$u),function(b$i){function b$V(){this.radius=NaN,this.arc=NaN,this.emitFromEdge=!1,b$V.__super.call(this),this.radius=1,this.arc=2*Math.PI,this.emitFromEdge=!1,this.randomDirection=!1}b$P(b$V,"laya.d3.core.particleShuriKen.module.shape.CircleShape",b$i);var b$M=b$V.prototype;b$M._getShapeBoundBox=function(b$M){var b$y=b$M.min.elements;b$y[0]=b$y[2]=-this.radius,b$y[1]=0;var b$i=b$M.max.elements;b$i[0]=b$i[2]=this.radius,b$i[1]=0},b$M._getSpeedBoundBox=function(b$M){var b$y=b$M.min.elements;b$y[0]=b$y[1]=-1,b$y[2]=0;var b$i=b$M.max.elements;b$i[0]=b$i[1]=1,b$i[2]=0},b$M.generatePositionAndDirection=function(b$M,b$y,b$i,b$H){var b$S=b$M.elements,b$f=b$V._tempPositionPoint.elements;b$i?(b$i.seed=b$H[16],this.emitFromEdge?b$_._randomPointUnitArcCircle(this.arc,b$V._tempPositionPoint,b$i):b$_._randomPointInsideUnitArcCircle(this.arc,b$V._tempPositionPoint,b$i),b$H[16]=b$i.seed):this.emitFromEdge?b$_._randomPointUnitArcCircle(this.arc,b$V._tempPositionPoint):b$_._randomPointInsideUnitArcCircle(this.arc,b$V._tempPositionPoint),b$S[0]=-b$f[0],b$S[1]=b$f[1],b$S[2]=0,b$Vy.scale(b$M,this.radius,b$M),this.randomDirection?b$i?(b$i.seed=b$H[17],b$_._randomPointUnitSphere(b$y,b$i),b$H[17]=b$i.seed):b$_._randomPointUnitSphere(b$y):b$M.cloneTo(b$y)},b$M.cloneTo=function(b$M){b$i.prototype.cloneTo.call(this,b$M);var b$y=b$M;b$y.radius=this.radius,b$y.arc=this.arc,b$y.emitFromEdge=this.emitFromEdge,b$y.randomDirection=this.randomDirection},b$o(b$V,["_tempPositionPoint",function(){return this._tempPositionPoint=new b$fy}])}(b$u),function(b$i){function b$d(){this.angle=NaN,this.radius=NaN,this.length=NaN,this.emitType=0,b$d.__super.call(this),this.angle=25/180*Math.PI,this.radius=1,this.length=5,this.emitType=0,this.randomDirection=!1}b$P(b$d,"laya.d3.core.particleShuriKen.module.shape.ConeShape",b$i);var b$M=b$d.prototype;b$M._getShapeBoundBox=function(b$M){var b$y=this.radius+this.length*Math.sin(this.angle),b$i=this.length*Math.cos(this.angle),b$H=b$M.min.elements;b$H[0]=b$H[1]=-b$y,b$H[2]=0;var b$S=b$M.max.elements;b$S[0]=b$S[1]=b$y,b$S[2]=b$i},b$M._getSpeedBoundBox=function(b$M){var b$y=Math.sin(this.angle),b$i=b$M.min.elements;b$i[0]=b$i[1]=-b$y,b$i[2]=0;var b$H=b$M.max.elements;b$H[0]=b$i[1]=b$y,b$H[2]=1},b$M.generatePositionAndDirection=function(b$M,b$y,b$i,b$H){var b$S,b$f=b$M.elements,b$V=b$y.elements,b$K=b$d._tempPositionPoint.elements,b$k=NaN,b$X=NaN,b$F=Math.cos(this.angle),b$o=Math.sin(this.angle);switch(this.emitType){case 0:b$i?(b$i.seed=b$H[16],b$_._randomPointInsideUnitCircle(b$d._tempPositionPoint,b$i),b$H[16]=b$i.seed):b$_._randomPointInsideUnitCircle(b$d._tempPositionPoint),b$k=b$K[0],b$X=b$K[1],b$f[0]=b$k*this.radius,b$f[1]=b$X*this.radius,b$f[2]=0,this.randomDirection?(b$i?(b$i.seed=b$H[17],b$_._randomPointInsideUnitCircle(b$d._tempDirectionPoint,b$i),b$H[17]=b$i.seed):b$_._randomPointInsideUnitCircle(b$d._tempDirectionPoint),b$S=b$d._tempDirectionPoint.elements,b$V[0]=b$S[0]*b$o,b$V[1]=b$S[1]*b$o):(b$V[0]=b$k*b$o,b$V[1]=b$X*b$o),b$V[2]=b$F;break;case 1:b$i?(b$i.seed=b$H[16],b$_._randomPointUnitCircle(b$d._tempPositionPoint,b$i),b$H[16]=b$i.seed):b$_._randomPointUnitCircle(b$d._tempPositionPoint),b$k=b$K[0],b$X=b$K[1],b$f[0]=b$k*this.radius,b$f[1]=b$X*this.radius,b$f[2]=0,this.randomDirection?(b$i?(b$i.seed=b$H[17],b$_._randomPointInsideUnitCircle(b$d._tempDirectionPoint,b$i),b$H[17]=b$i.seed):b$_._randomPointInsideUnitCircle(b$d._tempDirectionPoint),b$S=b$d._tempDirectionPoint.elements,b$V[0]=b$S[0]*b$o,b$V[1]=b$S[1]*b$o):(b$V[0]=b$k*b$o,b$V[1]=b$X*b$o),b$V[2]=b$F;break;case 2:b$i?(b$i.seed=b$H[16],b$_._randomPointInsideUnitCircle(b$d._tempPositionPoint,b$i)):b$_._randomPointInsideUnitCircle(b$d._tempPositionPoint),b$k=b$K[0],b$X=b$K[1],b$f[0]=b$k*this.radius,b$f[1]=b$X*this.radius,b$V[b$f[2]=0]=b$k*b$o,b$V[1]=b$X*b$o,b$V[2]=b$F,b$Vy.normalize(b$y,b$y),b$i?(b$Vy.scale(b$y,this.length*b$i.getFloat(),b$y),b$H[16]=b$i.seed):b$Vy.scale(b$y,this.length*Math.random(),b$y),b$Vy.add(b$M,b$y,b$M),this.randomDirection&&(b$i?(b$i.seed=b$H[17],b$_._randomPointUnitSphere(b$y,b$i),b$H[17]=b$i.seed):b$_._randomPointUnitSphere(b$y));break;case 3:b$i?(b$i.seed=b$H[16],b$_._randomPointUnitCircle(b$d._tempPositionPoint,b$i)):b$_._randomPointUnitCircle(b$d._tempPositionPoint),b$k=b$K[0],b$X=b$K[1],b$f[0]=b$k*this.radius,b$f[1]=b$X*this.radius,b$V[b$f[2]=0]=b$k*b$o,b$V[1]=b$X*b$o,b$V[2]=b$F,b$Vy.normalize(b$y,b$y),b$i?(b$Vy.scale(b$y,this.length*b$i.getFloat(),b$y),b$H[16]=b$i.seed):b$Vy.scale(b$y,this.length*Math.random(),b$y),b$Vy.add(b$M,b$y,b$M),this.randomDirection&&(b$i?(b$i.seed=b$H[17],b$_._randomPointUnitSphere(b$y,b$i),b$H[17]=b$i.seed):b$_._randomPointUnitSphere(b$y));break;default:throw new Error("ConeShape:emitType is invalid.")}},b$M.cloneTo=function(b$M){b$i.prototype.cloneTo.call(this,b$M);var b$y=b$M;b$y.angle=this.angle,b$y.radius=this.radius,b$y.length=this.length,b$y.emitType=this.emitType,b$y.randomDirection=this.randomDirection},b$o(b$d,["_tempPositionPoint",function(){return this._tempPositionPoint=new b$fy},"_tempDirectionPoint",function(){return this._tempDirectionPoint=new b$fy}])}(b$u),function(b$i){function b$M(){this.radius=NaN,this.emitFromShell=!1,b$M.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}b$P(b$M,"laya.d3.core.particleShuriKen.module.shape.HemisphereShape",b$i);var b$y=b$M.prototype;b$y._getShapeBoundBox=function(b$M){var b$y=b$M.min.elements;b$y[0]=b$y[1]=b$y[2]=-this.radius;var b$i=b$M.max.elements;b$i[0]=b$i[1]=this.radius,b$i[2]=0},b$y._getSpeedBoundBox=function(b$M){var b$y=b$M.min.elements;b$y[0]=b$y[1]=-1,b$y[2]=0;var b$i=b$M.max.elements;b$i[0]=b$i[1]=b$i[2]=1},b$y.generatePositionAndDirection=function(b$M,b$y,b$i,b$H){var b$S=b$M.elements;b$i?(b$i.seed=b$H[16],this.emitFromShell?b$_._randomPointUnitSphere(b$M,b$i):b$_._randomPointInsideUnitSphere(b$M,b$i),b$H[16]=b$i.seed):this.emitFromShell?b$_._randomPointUnitSphere(b$M):b$_._randomPointInsideUnitSphere(b$M),b$Vy.scale(b$M,this.radius,b$M);var b$f=b$S[2];b$f<0&&(b$S[2]=-1*b$f),this.randomDirection?b$i?(b$i.seed=b$H[17],b$_._randomPointUnitSphere(b$y,b$i),b$H[17]=b$i.seed):b$_._randomPointUnitSphere(b$y):b$M.cloneTo(b$y)},b$y.cloneTo=function(b$M){b$i.prototype.cloneTo.call(this,b$M);var b$y=b$M;b$y.radius=this.radius,b$y.emitFromShell=this.emitFromShell,b$y.randomDirection=this.randomDirection}}(b$u),function(b$i){function b$M(){this.radius=NaN,this.emitFromShell=!1,b$M.__super.call(this),this.radius=1,this.emitFromShell=!1,this.randomDirection=!1}b$P(b$M,"laya.d3.core.particleShuriKen.module.shape.SphereShape",b$i);var b$y=b$M.prototype;b$y._getShapeBoundBox=function(b$M){var b$y=b$M.min.elements;b$y[0]=b$y[1]=b$y[2]=-this.radius;var b$i=b$M.max.elements;b$i[0]=b$i[1]=b$i[2]=this.radius},b$y._getSpeedBoundBox=function(b$M){var b$y=b$M.min.elements;b$y[0]=b$y[1]=b$y[2]=-1;var b$i=b$M.max.elements;b$i[0]=b$i[1]=b$i[2]=1},b$y.generatePositionAndDirection=function(b$M,b$y,b$i,b$H){b$i?(b$i.seed=b$H[16],this.emitFromShell?b$_._randomPointUnitSphere(b$M,b$i):b$_._randomPointInsideUnitSphere(b$M,b$i),b$H[16]=b$i.seed):this.emitFromShell?b$_._randomPointUnitSphere(b$M):b$_._randomPointInsideUnitSphere(b$M),b$Vy.scale(b$M,this.radius,b$M),this.randomDirection?b$i?(b$i.seed=b$H[17],b$_._randomPointUnitSphere(b$y,b$i),b$H[17]=b$i.seed):b$_._randomPointUnitSphere(b$y):b$M.cloneTo(b$y)},b$y.cloneTo=function(b$M){b$i.prototype.cloneTo.call(this,b$M);var b$y=b$M;b$y.radius=this.radius,b$y.emitFromShell=this.emitFromShell,b$y.randomDirection=this.randomDirection}}(b$u),function(b$M){function b$y(){this._batchIndexStart=0,this._batchIndexEnd=0,this._skinAnimationDatas=null,b$y.__super.call(this)}return b$P(b$y,"laya.d3.core.render.SubMeshRenderElement",b$r),b$y}()),b$Qy=function(b$M){function b$h(b$M,b$y,b$i,b$H,b$S,b$f){this._name=NaN,this._attributeMap=null,this._renderElementUniformMap=null,this._materialUniformMap=null,this._spriteUniformMap=null,this._cameraUniformMap=null,this._sceneUniformMap=null,this.sharders=null,this._spriteDefineCounter=3,this._spriteInt2name=[],this._spriteName2Int={},this._materialDefineCounter=1,this._materialInt2name=[],this._materialName2Int={},this._conchShader=null,this._name=b$M,this._renderElementUniformMap={},this._materialUniformMap={},this._spriteUniformMap={},this._cameraUniformMap={},this._sceneUniformMap={},this.sharders=[],this._spriteInt2name[b$Py.SHADERDEFINE_RECEIVE_SHADOW]="RECEIVESHADOW",this._spriteInt2name[b$Yy.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV]="SCALEOFFSETLIGHTINGMAPUV",this._spriteInt2name[b$Yy.SAHDERDEFINE_LIGHTMAP]="LIGHTMAP",this._spriteInt2name[0]="BONE",this._materialInt2name[b$ay.SHADERDEFINE_ALPHATEST]="ALPHATEST";b$h.__super.call(this,b$M,b$y,b$i,null,{}),this._attributeMap=b$H;var b$V;for(b$V in b$S){var b$K=b$S[b$V];switch(b$K[1]){case 0:this._renderElementUniformMap[b$V]=b$K[0];break;case 1:this._materialUniformMap[b$V]=b$K[0];break;case 2:this._spriteUniformMap[b$V]=b$K[0];break;case 3:this._cameraUniformMap[b$V]=b$K[0];break;case 4:this._sceneUniformMap[b$V]=b$K[0];break;default:throw new Error("ShaderCompile3D: period is unkonw.")}}}b$P(b$h,"laya.d3.shader.ShaderCompile3D",b$R);var b$y=b$h.prototype;return b$y._definesToNameDic=function(b$M,b$y){for(var b$i={},b$H=1,b$S=0;b$S<32&&!(b$M<(b$H=1<<b$S));b$S++)if(b$M&b$H){var b$f=b$y[b$H];b$f&&(b$i[b$f]="")}return b$i},b$y.withCompile=function(b$M,b$y,b$i,b$H){var b$S,b$f,b$V;if(b$f=this.sharders[b$M])if(b$V=b$f[b$y]){if(b$S=b$V[b$i])return b$S}else b$V=b$f[b$y]=[];else b$V=(b$f=this.sharders[b$M]=[])[b$y]=[];var b$K,b$k=this._definesToNameDic(b$M,b$h._globalInt2name),b$X=this._definesToNameDic(b$y,this._spriteInt2name),b$F=this._definesToNameDic(b$i,this._materialInt2name),b$o={},b$d="";if(b$k)for(b$K in b$k)b$d+="#define "+b$K+"\n",b$o[b$K]=!0;if(b$X)for(b$K in b$X)b$d+="#define "+b$K+"\n",b$o[b$K]=!0;if(b$F)for(b$K in b$F)b$d+="#define "+b$K+"\n",b$o[b$K]=!0;var b$P=b$wy.nameKey.getName(this._name)+" compile ("+b$M+","+b$y+","+b$i+")",b$l=this._VS.toscript(b$o,[]),b$J=this._PS.toscript(b$o,[]);b$e.now();if(b$S=b$wy.create(b$d+b$l.join("\n"),b$d+b$J.join("\n"),this._attributeMap,this._sceneUniformMap,this._cameraUniformMap,this._spriteUniformMap,this._materialUniformMap,this._renderElementUniformMap,b$H,b$P),b$V[b$i]=b$S,laya.d3.shader.ShaderCompile3D.debugMode)b$e.now();return b$S},b$y.precompileShaderWithShaderDefine=function(b$M,b$y,b$i){this.withCompile(b$M,b$y,b$i,!0)},b$y.addMaterialDefines=function(b$M){var b$y=b$M.defines;for(var b$i in b$y){var b$H=b$y[b$i],b$S=parseInt(b$i);this._materialInt2name[b$S]=b$H,this._materialName2Int[b$H]=b$S}},b$y.addSpriteDefines=function(b$M){var b$y=b$M.defines;for(var b$i in b$y){var b$H=b$y[b$i],b$S=parseInt(b$i);this._spriteInt2name[b$S]=b$H,this._spriteName2Int[b$H]=b$S}},b$y.getMaterialDefineByName=function(b$M){return this._materialName2Int[b$M]},b$y.registerMaterialDefine=function(b$M){var b$y=Math.pow(2,this._materialDefineCounter++);return this._materialInt2name[b$y]=b$M,this._materialName2Int[b$M]=b$y},b$y.registerSpriteDefine=function(b$M){var b$y=Math.pow(2,this._spriteDefineCounter++);return this._spriteInt2name[b$y]=b$M,this._spriteName2Int[b$M]=b$y},b$h._globalRegDefine=function(b$M,b$y){b$h._globalInt2name[b$y]=b$M},b$h.add=function(b$M,b$y,b$i,b$H,b$S){return laya.d3.shader.ShaderCompile3D._preCompileShader[b$M]=new b$h(b$M,b$y,b$i,b$H,b$S,b$R.includes)},b$h.get=function(b$M){return laya.d3.shader.ShaderCompile3D._preCompileShader[b$wy.nameKey.getID(b$M)]},b$h._preCompileShader={},b$h._globalInt2name=[],b$h.debugMode=!1,b$h.SHADERDEFINE_HIGHPRECISION=1,b$h.SHADERDEFINE_FOG=4,b$h.SHADERDEFINE_DIRECTIONLIGHT=8,b$h.SHADERDEFINE_POINTLIGHT=16,b$h.SHADERDEFINE_SPOTLIGHT=32,b$h.SHADERDEFINE_UV0=64,b$h.SHADERDEFINE_COLOR=128,b$h.SHADERDEFINE_UV1=256,b$h.SAHDERDEFINE_DEPTHFOG=131072,b$h}(),b$Wy=function(b$M){function b$l(){b$l.__super.call(this)}b$P(b$l,"laya.d3.graphics.MeshSprite3DStaticBatchManager",b$HM);var b$y=b$l.prototype;return b$y._getStaticBatch=function(b$M,b$y,b$i,b$H){var b$S,b$f;return b$f=b$M?b$M.id.toString()+b$i.id.toString()+b$y.id.toString()+b$H.toString():b$i.id.toString()+b$y.id.toString()+b$H.toString(),this._staticBatches[b$f]?b$S=this._staticBatches[b$f]:this._staticBatches[b$f]=b$S=new b$cy(b$f,this,b$M,b$y,b$i),b$S},b$y._initStaticBatchs=function(b$M){var b$y,b$i;this._initBatchRenderElements.sort(b$l._sortPrepareStaticBatch);for(var b$H,b$S=!1,b$f=0,b$V=0,b$K=this._initBatchRenderElements.length;b$V<b$K;b$V++){var b$k,b$X=this._initBatchRenderElements[b$V],b$F=b$X.renderObj._getVertexBuffer(0);b$X._sprite3D;if(b$i===b$F.vertexDeclaration&&b$y===b$X._material)if(b$S)b$H._addCombineBatchRenderObjTest(b$X)?(b$k=b$X._staticBatch)!==b$H&&(b$k&&b$k._deleteCombineBatchRenderObj(b$X),b$H._addCombineBatchRenderObj(b$X)):(b$S=!1,b$f++);else{var b$o=this._initBatchRenderElements[b$V-1],b$d=b$o.renderObj,b$P=b$X.renderObj;b$S=!(65535<b$d._getVertexBuffer().vertexCount+b$P._getVertexBuffer().vertexCount)&&(b$H=this._getStaticBatch(b$M,b$i,b$y,b$f),(b$k=b$o._staticBatch)!==b$H&&(b$k&&b$k._deleteCombineBatchRenderObj(b$o),b$H._addCombineBatchRenderObj(b$o)),(b$k=b$X._staticBatch)!==b$H&&(b$k&&b$k._deleteCombineBatchRenderObj(b$X),b$H._addCombineBatchRenderObj(b$X)),!0)}else b$S=!1,b$f=0;b$y=b$X._material,b$i=b$F.vertexDeclaration}},b$l._sortPrepareStaticBatch=function(b$M,b$y){var b$i=b$M._render,b$H=b$y._render,b$S=b$i.lightmapIndex-b$H.lightmapIndex;if(0!=b$S)return b$S;var b$f=b$i.receiveShadow-b$H.receiveShadow;if(0!=b$f)return b$f;var b$V=b$M._mainSortID-b$y._mainSortID;return 0==b$V?b$M.renderObj.triangleCount-b$y.renderObj.triangleCount:b$V},b$l}(),b$cy=function(b$M){function b$f(b$M,b$y,b$i,b$H,b$S){this._batchOwnerIndices=null,this._batchOwners=null,this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=null,this._vertexBuffer=null,this._indexBuffer=null,b$f.__super.call(this,b$M,b$y,b$i),this._batchOwnerIndices=[],this._batchOwners=[],this._needFinishCombine=!1,this._currentCombineVertexCount=0,this._currentCombineIndexCount=0,this._vertexDeclaration=b$H,this._material=b$S}b$P(b$f,"laya.d3.graphics.SubMeshStaticBatch",b$SM);var b$y=b$f.prototype;return b$y._compareBatchRenderElement=function(b$M,b$y){return b$M._batchIndexStart>b$y._batchIndexStart},b$y._addCombineBatchRenderObjTest=function(b$M){var b$y=b$M.renderObj._vertexCount;return!(65535<(0<b$y?this._currentCombineVertexCount+b$y:this._currentCombineVertexCount+b$M.renderObj._getVertexBuffer().vertexCount))},b$y._addCombineBatchRenderObj=function(b$M){var b$y=b$M.renderObj,b$i=b$y._vertexCount;this._initBatchRenderElements.push(b$M),b$M._staticBatch=this,0<b$i?(this._currentCombineIndexCount+=b$y._indexCount,this._currentCombineVertexCount+=b$i):(this._currentCombineIndexCount=this._currentCombineIndexCount+b$y._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount+b$y._getVertexBuffer().vertexCount),this._needFinishCombine=!0},b$y._deleteCombineBatchRenderObj=function(b$M){var b$y=b$M.renderObj,b$i=this._initBatchRenderElements.indexOf(b$M);if(-1!==b$i){this._initBatchRenderElements.splice(b$i,1),b$M._staticBatch=null;var b$H=b$y._vertexCount;0<b$H?(this._currentCombineIndexCount=this._currentCombineIndexCount-b$y._indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-b$H):(this._currentCombineIndexCount=this._currentCombineIndexCount-b$y._getIndexBuffer().indexCount,this._currentCombineVertexCount=this._currentCombineVertexCount-b$y._getVertexBuffer().vertexCount),this._needFinishCombine=!0}},b$y._finishInit=function(){if(this._needFinishCombine){var b$M=0,b$y=0;0<=this._initBatchRenderElements[0]._sprite3D._render.lightmapIndex?this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration):this._material instanceof laya.d3.core.material.StandardMaterial&&this._material.ambientTexture&&(this._vertexDeclaration=this._getVertexDecLightMap(this._vertexDeclaration));var b$i=new Float32Array(this._vertexDeclaration.vertexStride/4*this._currentCombineVertexCount),b$H=new Uint16Array(this._currentCombineIndexCount);this._vertexBuffer&&(this._vertexBuffer.destroy(),this._indexBuffer.destroy()),this._vertexBuffer=b$uy.create(this._vertexDeclaration,this._currentCombineVertexCount,35044),this._indexBuffer=b$ty.create("ushort",this._currentCombineIndexCount,35044);for(var b$S=0,b$f=this._initBatchRenderElements.length;b$S<b$f;b$S++){var b$V=this._initBatchRenderElements[b$S],b$K=b$V.renderObj,b$k=b$K._getStaticBatchBakedVertexs(this._rootOwner?this._rootOwner._transform:null,b$V._sprite3D),b$X=b$K.getIndices(),b$F=b$V._sprite3D.transform._isFrontFaceInvert,b$o=b$M/(this._vertexDeclaration.vertexStride/4)-b$K._vertexStart,b$d=b$y,b$P=b$d+b$X.length;b$V._batchIndexStart=b$d,b$V._batchIndexEnd=b$P,b$H.set(b$X,b$y);var b$l=0;if(b$F)for(b$l=b$d;b$l<b$P;b$l+=3){b$H[b$l]=b$o+b$H[b$l];var b$J=b$H[b$l+1],b$h=b$H[b$l+2];b$H[b$l+1]=b$o+b$h,b$H[b$l+2]=b$o+b$J}else for(b$l=b$d;b$l<b$P;b$l+=3)b$H[b$l]=b$o+b$H[b$l],b$H[b$l+1]=b$o+b$H[b$l+1],b$H[b$l+2]=b$o+b$H[b$l+2];b$y+=b$X.length,b$i.set(b$k,b$M),b$M+=b$k.length}this._vertexBuffer.setData(b$i),this._indexBuffer.setData(b$H),this._needFinishCombine=!1}},b$y._getCombineRenderElementFromPool=function(){return this._combineRenderElementPool[this._combineRenderElementPoolIndex++]||(this._combineRenderElementPool[this._combineRenderElementPoolIndex-1]=new b$Uy)},b$y._getRenderElement=function(b$M,b$y,b$i){for(var b$H,b$S,b$f=this._batchRenderElements.length,b$V=!0,b$K=0;b$K<b$f;b$K++){var b$k,b$X,b$F=(b$S=this._batchRenderElements[b$K])._sprite3D._render;if(0!==b$K&&(b$V=(b$k=(b$H=this._batchRenderElements[b$K-1])._sprite3D._render).lightmapIndex!==b$F.lightmapIndex||b$k.receiveShadow!==b$F.receiveShadow||b$H._batchIndexEnd!==b$S._batchIndexStart),b$V){(b$X=this._getCombineRenderElementFromPool()).renderObj=this,b$X._material=this._material,b$X._batchIndexStart=b$S._batchIndexStart,b$X._batchIndexEnd=b$S._batchIndexEnd;var b$o=b$F.lightmapIndex,b$d=b$o+1,b$P=this._batchOwnerIndices[b$d];b$P||(b$P=this._batchOwnerIndices[b$d]=[]);var b$l,b$J=b$P[b$S._render.receiveShadow?1:0];void 0===b$J?(b$P[b$F.receiveShadow?1:0]=this._batchOwners.length,(b$l=new b$Ny(null,"StaticBatchMeshSprite3D"))._scene=b$y,b$l._transform=this._rootOwner?this._rootOwner._transform:null,b$l._render.lightmapIndex=b$o,b$l._render.receiveShadow=b$S._render.receiveShadow,this._batchOwners.push(b$l)):b$l=this._batchOwners[b$J],b$l._render._renderUpdate(b$i),b$X._sprite3D=b$l,b$M.push(b$X)}else b$X._batchIndexEnd=b$S._batchIndexEnd}},b$y._beforeRender=function(b$M){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},b$y._render=function(b$M){var b$y=b$M.renderElement,b$i=b$y._batchIndexStart,b$H=b$y._batchIndexEnd-b$i;b$T.mainContext.drawElements(4,b$H,5123,2*b$i),b$Q.drawCall++,b$Q.trianglesFaces+=b$H/3},b$y.dispose=function(){this._batchOwnerIndices=null,this._batchOwners=null,this._vertexDeclaration=null,this._vertexBuffer.destroy(),this._indexBuffer.destroy()},b$y._getVertexBuffer=function(b$M){return void 0===b$M&&(b$M=0),this._vertexBuffer},b$f}(),b$ny=function(b$M){function b$y(){this._componentsMap=null,this._typeComponentsIndices=null,this._components=null,this._scripts=null,b$y.__super.call(this),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[],this._scripts=[]}b$P(b$y,"laya.d3.core.ComponentNode",b$X);var b$i=b$y.prototype;return b$i.addComponent=function(b$M){var b$y,b$i=this._componentsMap.indexOf(b$M);if(-1===b$i)b$y=[],this._componentsMap.push(b$M),this._typeComponentsIndices.push(b$y);else if(b$y=this._typeComponentsIndices[b$i],this._components[b$y[0]].isSingleton)throw new Error("无法单实例创建"+b$M+"组件，"+b$M+"组件已存在！");var b$H=b$S.getInstance(b$M);return b$y.push(this._components.length),this._components.push(b$H),b$H instanceof laya.d3.component.Script&&this._scripts.push(b$H),b$H._initialize(this),b$H},b$i._removeComponent=function(b$M,b$y){var b$i=this._typeComponentsIndices[b$M],b$H=b$i[b$y],b$S=this._components[b$H];this._components.splice(b$H,1),b$S instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(b$S),1),b$i.splice(b$y,1),0===b$i.length&&(this._typeComponentsIndices.splice(b$M,1),this._componentsMap.splice(b$M,1));for(var b$f=0,b$V=this._componentsMap.length;b$f<b$V;b$f++)for(var b$K=(b$i=this._typeComponentsIndices[b$f]).length-1;0<=b$K;b$K--){var b$k=b$i[b$K];if(!(b$H<b$k))break;b$i[b$K]=--b$k}b$S._destroy()},b$i.getComponentByType=function(b$M,b$y){void 0===b$y&&(b$y=0);var b$i=this._componentsMap.indexOf(b$M);return-1===b$i?null:this._components[this._typeComponentsIndices[b$i][b$y]]},b$i.getComponentsByType=function(b$M,b$y){var b$i=this._componentsMap.indexOf(b$M);if(-1!==b$i){var b$H=this._typeComponentsIndices[b$i],b$S=b$H.length;b$y.length=b$S;for(var b$f=0;b$f<b$S;b$f++)b$y[b$f]=this._components[b$H[b$f]]}else b$y.length=0},b$i.getComponentByIndex=function(b$M){return this._components[b$M]},b$i.removeComponentByType=function(b$M,b$y){void 0===b$y&&(b$y=0);var b$i=this._componentsMap.indexOf(b$M);-1!==b$i&&this._removeComponent(b$i,b$y)},b$i.removeComponentsByType=function(b$M){var b$y=this._componentsMap.indexOf(b$M);if(-1!==b$y)for(var b$i=this._typeComponentsIndices[b$y],b$H=0,b$S=b$i.length;b$H<b$S;b$i.length<b$S?b$S--:b$H++)this._removeComponent(b$y,b$H)},b$i.removeAllComponent=function(){for(var b$M=0,b$y=this._componentsMap.length;b$M<b$y;this._componentsMap.length<b$y?b$y--:b$M++)this.removeComponentsByType(this._componentsMap[b$M])},b$i._updateComponents=function(b$M){for(var b$y=0,b$i=this._components.length;b$y<b$i;b$y++){var b$H=this._components[b$y];!b$H.started&&(b$H._start(b$M),b$H.started=!0),b$H.enable&&b$H._update(b$M)}},b$i._lateUpdateComponents=function(b$M){for(var b$y=0;b$y<this._components.length;b$y++){var b$i=this._components[b$y];!b$i.started&&(b$i._start(b$M),b$i.started=!0),b$i.enable&&b$i._lateUpdate(b$M)}},b$i._preRenderUpdateComponents=function(b$M){for(var b$y=0;b$y<this._components.length;b$y++){var b$i=this._components[b$y];!b$i.started&&(b$i._start(b$M),b$i.started=!0),b$i.enable&&b$i._preRenderUpdate(b$M)}},b$i._postRenderUpdateComponents=function(b$M){for(var b$y=0;b$y<this._components.length;b$y++){var b$i=this._components[b$y];!b$i.started&&(b$i._start(b$M),b$i.started=!0),b$i.enable&&b$i._postRenderUpdate(b$M)}},b$y}(),b$ay=function(b$H){function b$M(){b$M.__super.call(this),this._shaderDefineValue=0,this._disablePublicShaderDefine=0,this._shaderValues=new b$dy,this._values=[],this.renderQueue=2e3,this._alphaTest=!1,this.cull=2,this.blend=0,this.srcBlend=1,this.dstBlend=0,this.srcBlendRGB=1,this.dstBlendRGB=0,this.srcBlendAlpha=1,this.dstBlendAlpha=0,this.blendConstColor=new b$Ky(1,1,1,1),this.blendEquation=0,this.blendEquationRGB=0,this.blendEquationAlpha=0,this.depthTest=513,this.depthWrite=!0}b$P(b$M,"laya.d3.core.material.BaseMaterial",b$H);var b$y=b$M.prototype;return b$G.imps(b$y,{"laya.d3.core.IClone":!0}),b$y._addShaderDefine=function(b$M){this._shaderDefineValue|=b$M},b$y._removeShaderDefine=function(b$M){this._shaderDefineValue&=~b$M},b$y._addDisablePublicShaderDefine=function(b$M){this._disablePublicShaderDefine|=b$M},b$y._removeDisablePublicShaderDefine=function(b$M){this._disablePublicShaderDefine&=~b$M},b$y._setBuffer=function(b$M,b$y){this._shaderValues.setValue(b$M,b$y),this._values[b$M]=b$y},b$y._getBuffer=function(b$M){return this._values[b$M]},b$y._setMatrix4x4=function(b$M,b$y){this._shaderValues.setValue(b$M,b$y?b$y.elements:null),this._values[b$M]=b$y},b$y._getMatrix4x4=function(b$M){return this._values[b$M]},b$y._setInt=function(b$M,b$y){this._shaderValues.setValue(b$M,b$y),this._values[b$M]=b$y},b$y._getInt=function(b$M){return this._values[b$M]},b$y._setNumber=function(b$M,b$y){this._shaderValues.setValue(b$M,b$y),this._values[b$M]=b$y},b$y._getNumber=function(b$M){return this._values[b$M]},b$y._setBool=function(b$M,b$y){this._shaderValues.setValue(b$M,b$y),this._values[b$M]=b$y},b$y._getBool=function(b$M){return this._values[b$M]},b$y._setVector2=function(b$M,b$y){this._shaderValues.setValue(b$M,b$y?b$y.elements:null),this._values[b$M]=b$y},b$y._getVector2=function(b$M){return this._values[b$M]},b$y._setColor=function(b$M,b$y){this._shaderValues.setValue(b$M,b$y?b$y.elements:null),this._values[b$M]=b$y},b$y._getColor=function(b$M){return this._values[b$M]},b$y._setTexture=function(b$M,b$y){var b$i=this._values[b$M];this._values[b$M]=b$y,this._shaderValues.setValue(b$M,b$y),0<this.referenceCount&&(b$i&&b$i._removeReference(),b$y&&b$y._addReference())},b$y._getTexture=function(b$M){return this._values[b$M]},b$y._upload=function(){this._shader.uploadMaterialUniforms(this._shaderValues.data)},b$y._getShader=function(b$M,b$y,b$i){var b$H=(b$M|b$y)&~this._disablePublicShaderDefine;return this._shader=this._shaderCompile.withCompile(b$H,b$i,this._shaderDefineValue),this._shader},b$y._setRenderStateBlendDepth=function(){var b$M=b$T.mainContext;switch(b$m.setDepthMask(b$M,this.depthWrite),0===this.depthTest?b$m.setDepthTest(b$M,!1):(b$m.setDepthTest(b$M,!0),b$m.setDepthFunc(b$M,this.depthTest)),this.blend){case 0:b$m.setBlend(b$M,!1);break;case 1:b$m.setBlend(b$M,!0),b$m.setBlendFunc(b$M,this.srcBlend,this.dstBlend);break;case 2:b$m.setBlend(b$M,!0)}},b$y._setRenderStateFrontFace=function(b$M,b$y){var b$i=b$T.mainContext,b$H=0;switch(this.cull){case 0:b$m.setCullFace(b$i,!1);break;case 1:b$m.setCullFace(b$i,!0),b$H=b$M?b$y&&b$y._isFrontFaceInvert?2305:2304:b$y&&b$y._isFrontFaceInvert?2304:2305,b$m.setFrontFace(b$i,b$H);break;case 2:b$m.setCullFace(b$i,!0),b$H=b$M?b$y&&b$y._isFrontFaceInvert?2304:2305:b$y&&b$y._isFrontFaceInvert?2305:2304,b$m.setFrontFace(b$i,b$H)}},b$y.onAsynLoaded=function(b$M,b$y,b$i){var b$H=b$y[0],b$S=b$y[1];switch(b$H.version){case"LAYAMATERIAL:01":var b$f=0,b$V=0,b$K=b$H.props;for(var b$k in b$K)switch(b$k){case"vectors":var b$X=b$K[b$k];for(b$f=0,b$V=b$X.length;b$f<b$V;b$f++){var b$F=b$X[b$f],b$o=b$F.value;switch(b$o.length){case 2:this[b$F.name]=new b$fy(b$o[0],b$o[1]);break;case 3:this[b$F.name]=new b$Vy(b$o[0],b$o[1],b$o[2]);break;case 4:this[b$F.name]=new b$Ky(b$o[0],b$o[1],b$o[2],b$o[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}}break;case"textures":var b$d=b$K[b$k];for(b$f=0,b$V=b$d.length;b$f<b$V;b$f++){var b$P=b$d[b$f],b$l=b$P.path;b$l&&(this[b$P.name]=b$C.getRes(b$S[b$l]))}break;case"defines":var b$J=b$K[b$k];for(b$f=0,b$V=b$J.length;b$f<b$V;b$f++){var b$h=this._shaderCompile.getMaterialDefineByName(b$J[b$f]);this._addShaderDefine(b$h)}break;case"cull":case"blend":case"srcBlend":case"dstBlend":case"depthWrite":this[b$k]=b$K[b$k];break;case"renderQueue":switch(b$K[b$k]){case 1:this.renderQueue=2e3;break;case 2:this.renderQueue=3e3}break;default:this[b$k]=b$K[b$k]}break;case"LAYAMATERIAL:02":for(b$k in b$K=b$H.props)switch(b$k){case"vectors":for(b$f=0,b$V=(b$X=b$K[b$k]).length;b$f<b$V;b$f++)switch((b$o=(b$F=b$X[b$f]).value).length){case 2:this[b$F.name]=new b$fy(b$o[0],b$o[1]);break;case 3:this[b$F.name]=new b$Vy(b$o[0],b$o[1],b$o[2]);break;case 4:this[b$F.name]=new b$Ky(b$o[0],b$o[1],b$o[2],b$o[3]);break;default:throw new Error("BaseMaterial:unkonwn color length.")}break;case"textures":for(b$f=0,b$V=(b$d=b$K[b$k]).length;b$f<b$V;b$f++)(b$l=(b$P=b$d[b$f]).path)&&(this[b$P.name]=b$C.getRes(b$S[b$l]));break;case"defines":for(b$f=0,b$V=(b$J=b$K[b$k]).length;b$f<b$V;b$f++)b$h=this._shaderCompile.getMaterialDefineByName(b$J[b$f]),this._addShaderDefine(b$h);break;default:this[b$k]=b$K[b$k]}break;default:throw new Error("BaseMaterial:unkonwn version.")}this._endLoaded()},b$y._addReference=function(){b$H.prototype._addReference.call(this);for(var b$M=0,b$y=this._values.length;b$M<b$y;b$M++){var b$i=this._values[b$M];b$i&&b$i instanceof laya.d3.resource.BaseTexture&&b$i._addReference()}},b$y._removeReference=function(){b$H.prototype._removeReference.call(this);for(var b$M=0,b$y=this._values.length;b$M<b$y;b$M++){var b$i=this._values[b$M];b$i&&b$i instanceof laya.d3.resource.BaseTexture&&b$i._removeReference()}},b$y.disposeResource=function(){this.blendConstColor=null,this._shader=null,this._shaderValues=null,this._values=null},b$y.setShaderName=function(b$M){var b$y=b$wy.nameKey.getID(b$M);if(-1===b$y)throw new Error("BaseMaterial: unknown shader name.");this._shaderCompile=b$Qy._preCompileShader[b$y]},b$y.cloneTo=function(b$M){var b$y=b$M;b$y.name=this.name,b$y.cull=this.cull,b$y.blend=this.blend,b$y.srcBlend=this.srcBlend,b$y.dstBlend=this.dstBlend,b$y.srcBlendRGB=this.srcBlendRGB,b$y.dstBlendRGB=this.dstBlendRGB,b$y.srcBlendAlpha=this.srcBlendAlpha,b$y.dstBlendAlpha=this.dstBlendAlpha,this.blendConstColor.cloneTo(b$y.blendConstColor),b$y.blendEquation=this.blendEquation,b$y.blendEquationRGB=this.blendEquationRGB,b$y.blendEquationAlpha=this.blendEquationAlpha,b$y.depthTest=this.depthTest,b$y.depthWrite=this.depthWrite,b$y.renderQueue=this.renderQueue,b$y._shader=this._shader,b$y._disablePublicShaderDefine=this._disablePublicShaderDefine,b$y._shaderDefineValue=this._shaderDefineValue;var b$i,b$H=0,b$S=b$y._shaderValues;b$y._shaderValues.data.length=this._shaderValues.data.length;var b$f=this._values.length,b$V=b$y._values;for(b$H=0,b$i=b$V.length=b$f;b$H<b$i;b$H++){var b$K=this._values[b$H];if(b$K)if("number"==typeof b$K)b$V[b$H]=b$K,b$S.data[b$H]=b$K;else if("number"==typeof b$K&&Math.floor(b$K)==b$K)b$V[b$H]=b$K,b$S.data[b$H]=b$K;else if("boolean"==typeof b$K)b$V[b$H]=b$K,b$S.data[b$H]=b$K;else if(b$K instanceof laya.d3.math.Vector2){var b$k=b$V[b$H]||(b$V[b$H]=new b$fy);b$K.cloneTo(b$k),b$S.data[b$H]=b$k.elements}else if(b$K instanceof laya.d3.math.Vector3){var b$X=b$V[b$H]||(b$V[b$H]=new b$Vy);b$K.cloneTo(b$X),b$S.data[b$H]=b$X.elements}else if(b$K instanceof laya.d3.math.Vector4){var b$F=b$V[b$H]||(b$V[b$H]=new b$Ky);b$K.cloneTo(b$F),b$S.data[b$H]=b$F.elements}else if(b$K instanceof laya.d3.math.Matrix4x4){var b$o=b$V[b$H]||(b$V[b$H]=new b$My);b$K.cloneTo(b$o),b$S.data[b$H]=b$o.elements}else b$K instanceof laya.d3.resource.BaseTexture&&(b$V[b$H]=b$K,b$S.data[b$H]=b$K)}},b$y.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$l(0,b$y,"alphaTestValue",function(){return this._getNumber(0)},function(b$M){this._setNumber(0,b$M)}),b$l(0,b$y,"alphaTest",function(){return this._alphaTest},function(b$M){(this._alphaTest=b$M)?this._addShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST):this._removeShaderDefine(laya.d3.core.material.BaseMaterial.SHADERDEFINE_ALPHATEST)}),b$M.__init__=function(){b$M.SHADERDEFINE_ALPHATEST=b$M.shaderDefines.registerDefine("ALPHATEST")},b$M.RENDERQUEUE_OPAQUE=2e3,b$M.RENDERQUEUE_ALPHATEST=2450,b$M.RENDERQUEUE_TRANSPARENT=3e3,b$M.CULL_NONE=0,b$M.CULL_FRONT=1,b$M.CULL_BACK=2,b$M.BLEND_DISABLE=0,b$M.BLEND_ENABLE_ALL=1,b$M.BLEND_ENABLE_SEPERATE=2,b$M.BLENDPARAM_ZERO=0,b$M.BLENDPARAM_ONE=1,b$M.BLENDPARAM_SRC_COLOR=768,b$M.BLENDPARAM_ONE_MINUS_SRC_COLOR=769,b$M.BLENDPARAM_DST_COLOR=774,b$M.BLENDPARAM_ONE_MINUS_DST_COLOR=775,b$M.BLENDPARAM_SRC_ALPHA=770,b$M.BLENDPARAM_ONE_MINUS_SRC_ALPHA=771,b$M.BLENDPARAM_DST_ALPHA=772,b$M.BLENDPARAM_ONE_MINUS_DST_ALPHA=773,b$M.BLENDPARAM_SRC_ALPHA_SATURATE=776,b$M.BLENDEQUATION_ADD=0,b$M.BLENDEQUATION_SUBTRACT=1,b$M.BLENDEQUATION_REVERSE_SUBTRACT=2,b$M.DEPTHTEST_OFF=0,b$M.DEPTHTEST_NEVER=512,b$M.DEPTHTEST_LESS=513,b$M.DEPTHTEST_EQUAL=514,b$M.DEPTHTEST_LEQUAL=515,b$M.DEPTHTEST_GREATER=516,b$M.DEPTHTEST_NOTEQUAL=517,b$M.DEPTHTEST_GEQUAL=518,b$M.DEPTHTEST_ALWAYS=519,b$M.SHADERDEFINE_ALPHATEST=1,b$M.ALPHATESTVALUE=0,b$o(b$M,["shaderDefines",function(){return this.shaderDefines=new b$Fy}]),b$M}(b$h),b$Ty=function(b$M){function b$y(){this._type=0,this._width=0,this._height=0,this._size=null,this._repeat=!1,this._mipmap=!1,this._minFifter=0,this._magFifter=0,this._format=0,this._source=null,this._conchTexture=null,this._wrapModeU=0,this._wrapModeV=0,b$y.__super.call(this),this._repeat=!0,this.mipmap=!0,this.minFifter=-1,this.magFifter=-1}b$P(b$y,"laya.d3.resource.BaseTexture",b$h);var b$i=b$y.prototype;return b$l(0,b$i,"width",function(){return this._width}),b$l(0,b$i,"repeat",function(){return this._repeat},function(b$M){if(this._repeat!==b$M&&(this._repeat=b$M,this._source)){var b$y=b$T.mainContext;b$m.bindTexture(b$y,this._type,this._source),b$A.isPOT(this._width,this._height)&&this._repeat?(b$y.texParameteri(this._type,10242,10497),b$y.texParameteri(this._type,10243,10497)):(b$y.texParameteri(this._type,10242,33071),b$y.texParameteri(this._type,10243,33071))}}),b$l(0,b$i,"height",function(){return this._height}),b$l(0,b$i,"magFifter",function(){return this._magFifter},function(b$M){(this._magFifter=b$M)!=this._magFifter&&this._conchTexture&&this._conchTexture.setMaxFifter(b$M)}),b$l(0,b$i,"wrapModeV",function(){return this._wrapModeV}),b$l(0,b$i,"size",function(){return this._size}),b$l(0,b$i,"wrapModeU",function(){return this._wrapModeU}),b$l(0,b$i,"mipmap",function(){return this._mipmap},function(b$M){this._mipmap=b$M,this._mipmap!=b$M&&this._conchTexture&&this._conchTexture.setMipMap(b$M)}),b$l(0,b$i,"minFifter",function(){return this._minFifter},function(b$M){this._minFifter=b$M,this._minFifter!=b$M&&this._conchTexture&&this._conchTexture.setMinFifter(b$M)}),b$l(0,b$i,"format",function(){return this._format}),b$l(0,b$i,"source",function(){return this.activeResource(),this._source}),b$l(0,b$i,"defaulteTexture",function(){return b$Ey.grayTexture}),b$y.WARPMODE_REPEAT=0,b$y.WARPMODE_CLAMP=1,b$y}(),b$my=function(b$M){function b$y(){this._subMeshCount=0,this._boundingBox=null,this._boundingSphere=null,this._boundingBoxCorners=null,this._positions=null,b$y.__super.call(this),this._boundingBoxCorners=b$H(8,null)}b$P(b$y,"laya.d3.resource.models.BaseMesh",b$h);var b$i=b$y.prototype;return b$i._getPositions=function(){throw new Error("未Override,请重载该属性！")},b$i._generateBoundingObject=function(){this._boundingSphere=new b$jM(new b$Vy,0),b$jM.createfromPoints(this._positions,this._boundingSphere),this._boundingBox=new b$xM(new b$Vy,new b$Vy),b$xM.createfromPoints(this._positions,this._boundingBox),this._boundingBox.getCorners(this._boundingBoxCorners)},b$i.getRenderElementsCount=function(){throw new Error("未Override,请重载该属性！")},b$i.getRenderElement=function(b$M){throw new Error("未Override,请重载该属性！")},b$l(0,b$i,"subMeshCount",function(){return this._subMeshCount}),b$l(0,b$i,"boundingBox",function(){return this._boundingBox}),b$l(0,b$i,"boundingBoxCorners",function(){return this._boundingBoxCorners}),b$l(0,b$i,"boundingSphere",function(){return this._boundingSphere}),b$y}(),b$ey=(function(b$M){function b$y(){b$y.__super.call(this)}b$P(b$y,"laya.d3.component.Script",b$Ry);var b$i=b$y.prototype;b$i.onTriggerEnter=function(b$M){},b$i.onTriggerExit=function(b$M){},b$i.onTriggerStay=function(b$M){},b$l(0,b$i,"isSingleton",function(){return b$y._isSingleton}),b$y._isSingleton=!1}(),function(b$M){function b$y(b$M){this._owner=null,this._sharedMesh=null,b$y.__super.call(this),this._owner=b$M}b$P(b$y,"laya.d3.core.MeshFilter",b$M);var b$i=b$y.prototype;return b$i._sharedMeshLoaded=function(){this.event("loaded")},b$i._destroy=function(){b$M.prototype._destroy.call(this),this._owner=null,this._sharedMesh&&(this._sharedMesh._removeReference(),this._sharedMesh=null)},b$l(0,b$i,"sharedMesh",function(){return this._sharedMesh},function(b$M){var b$y=this._sharedMesh;b$y&&b$y._removeReference(),(this._sharedMesh=b$M)._addReference(),this.event("meshchanged",[this,b$y,b$M]),b$M.loaded||this._sharedMesh.once("loaded",this,this._sharedMeshLoaded)}),b$l(0,b$i,"_isAsyncLoaded",function(){return this._sharedMesh.loaded}),b$l(0,b$i,"_originalBoundingBoxCorners",function(){return this._sharedMesh.boundingBoxCorners}),b$l(0,b$i,"_originalBoundingSphere",function(){return this._sharedMesh.boundingSphere}),b$l(0,b$i,"_originalBoundingBox",function(){return this._sharedMesh.boundingBox}),b$y}(b$Ay)),b$sy=function(b$M){function b$y(b$M){b$y.__super.call(this,b$M),b$M.meshFilter.on("meshchanged",this,this._onMeshChanged)}b$P(b$y,"laya.d3.core.MeshRender",b$Gy);var b$i=b$y.prototype;return b$i._onMeshChanged=function(b$M,b$y,b$i){b$i.loaded?this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0:b$i.once("loaded",this,this._onMeshLoaed)},b$i._onMeshLoaed=function(b$M,b$y){this._boundingSphereNeedChange=this._boundingBoxNeedChange=this._boundingBoxCenterNeedChange=this._octreeNodeNeedChange=!0},b$i._calculateBoundingSphereByInitSphere=function(b$M){var b$y=NaN,b$i=this._owner.transform,b$H=b$i.scale.elements,b$S=Math.abs(b$H[0]),b$f=Math.abs(b$H[1]),b$V=Math.abs(b$H[2]);b$y=b$f<=b$S&&b$V<=b$S?b$S:b$V<=b$f?b$f:b$V,b$Vy.transformCoordinate(b$M.center,b$i.worldMatrix,this._boundingSphere.center),this._boundingSphere.radius=b$M.radius*b$y},b$i._calculateBoundBoxByInitCorners=function(b$M){for(var b$y=this._owner.transform.worldMatrix,b$i=0;b$i<8;b$i++)b$Vy.transformCoordinate(b$M[b$i],b$y,b$Gy._tempBoundBoxCorners[b$i]);b$xM.createfromPoints(b$Gy._tempBoundBoxCorners,this._boundingBox)},b$i._calculateBoundingSphere=function(){var b$M=this._owner.meshFilter.sharedMesh;null==b$M||null==b$M.boundingSphere?this._boundingSphere.toDefault():this._calculateBoundingSphereByInitSphere(b$M.boundingSphere)},b$i._calculateBoundingBox=function(){var b$M=this._owner.meshFilter.sharedMesh;null==b$M||null==b$M.boundingBox?this._boundingBox.toDefault():this._calculateBoundBoxByInitCorners(b$M.boundingBoxCorners)},b$i._renderUpdate=function(b$M){var b$y=this._owner.transform;if(b$y){this._setShaderValueMatrix4x4(0,b$y.worldMatrix);var b$i=this._owner.getProjectionViewWorldMatrix(b$M);this._setShaderValueMatrix4x4(1,b$i)}else this._setShaderValueMatrix4x4(0,b$My.DEFAULT),this._setShaderValueMatrix4x4(1,b$M);return b$Cy.debugMode&&this._renderRenderableBoundBox(),!0},b$y}(),b$Dy=function(b$y){function b$H(){this._time=0,this._enableLightCount=3,this._customRenderQueneIndex=11,this.enableLight=!0,b$H.__super.call(this),this._renderState=new b$$,this._lights=[],this._quenes=[],this._cameraPool=[],this._renderableSprite3Ds=[],this.__loaded=!0,this._lightmaps=[],this._shaderValues=new b$dy,this.parallelSplitShadowMaps=[],this._dynamicBatchManager=new b$yM,this._cullingRenders=[],this._cullingRendersLength=0,this.enableFog=!1,this.fogStart=300,this.fogRange=1e3,this.fogColor=new b$Vy(.7,.7,.7),this.ambientColor=new b$Vy(.212,.227,.259),b$T.shaderHighPrecision&&this.addShaderDefine(b$Qy.SHADERDEFINE_HIGHPRECISION),this.on("display",this,this._display),this.on("undisplay",this,this._unDisplay),this._componentsMap=[],this._typeComponentsIndices=[],this._components=[]}b$P(b$H,"laya.d3.core.scene.Scene",b$y);var b$M=b$H.prototype;return b$G.imps(b$M,{"laya.webgl.submit.ISubmit":!0,"laya.resource.ICreateResource":!0}),b$M._setUrl=function(b$M){this._url=b$M},b$M._getGroup=function(){return this._group},b$M._setGroup=function(b$M){this._group=b$M},b$M._display=function(){b$G.stage._scenes.push(this),b$G.stage._scenes.sort(b$H._sortScenes);for(var b$M=0,b$y=this._childs.length;b$M<b$y;b$M++){var b$i=this._childs[b$M];b$i.active&&b$i._activeHierarchy()}},b$M._unDisplay=function(){var b$M=b$G.stage._scenes;b$M.splice(b$M.indexOf(this),1);for(var b$y=0,b$i=this._childs.length;b$y<b$i;b$y++){var b$H=this._childs[b$y];b$H.active&&b$H._inActiveHierarchy()}},b$M._addChild3D=function(b$M){b$M.transform._onWorldTransform(),b$M._setBelongScene(this),this.displayedInStage&&b$M.active&&b$M._activeHierarchy()},b$M._removeChild3D=function(b$M){b$M.transform.parent=null,this.displayedInStage&&b$M.active&&b$M._inActiveHierarchy(),b$M._setUnBelongScene()},b$M.initOctree=function(b$M,b$y,b$i,b$H,b$S){void 0===b$S&&(b$S=6),this.treeSize=new b$Vy(b$M,b$y,b$i),this.treeLevel=b$S,this.treeRoot=new b$x(this,0),this.treeRoot.init(b$H,this.treeSize)},b$M._prepareUpdateToRenderState=function(b$M,b$y){b$y.elapsedTime=this._lastCurrentTime?this.timer.currTimer-this._lastCurrentTime:0,this._lastCurrentTime=this.timer.currTimer,b$y.scene=this},b$M._prepareSceneToRender=function(b$M){var b$y=this._lights.length;if(0<b$y)for(var b$i=0,b$H=0;b$H<b$y&&!(this._lights[b$H]._prepareToScene(b$M)&&++b$i>=this._enableLightCount);b$H++);},b$M._updateChilds=function(b$M){for(var b$y=0,b$i=this._childs.length;b$y<b$i;++b$y)this._childs[b$y]._update(b$M)},b$M._preRenderScene=function(b$M,b$y,b$i){var b$H,b$S=b$y._viewMatrix,b$f=b$y._projectionMatrix,b$V=b$y._projectionViewMatrix,b$K=0,b$k=b$y.camera;for(b$k.useOcclusionCulling?this.treeRoot?b$iM.renderObjectCullingOctree(b$i,this,b$k,b$S,b$f,b$V):b$iM.renderObjectCulling(b$i,this,b$k,b$S,b$f,b$V):b$iM.renderObjectCullingNoBoundFrustum(this,b$k,b$S,b$f,b$V),b$K=0,b$H=this._quenes.length;b$K<b$H;b$K++)this._quenes[b$K]&&this._quenes[b$K]._preRender(b$y)},b$M._clear=function(b$M,b$y){var b$i=b$y._viewport,b$H=b$y.camera,b$S=b$i.x,b$f=b$H.renderTargetSize.height-b$i.y-b$i.height,b$V=b$i.width,b$K=b$i.height;b$M.viewport(b$S,b$f,b$V,b$K);var b$k=256,b$X=b$H.renderTarget;switch(b$H.clearFlag){case 0:var b$F=b$H.clearColor;if(b$F){b$M.enable(3089),b$M.scissor(b$S,b$f,b$V,b$K);var b$o=b$F.elements;b$M.clearColor(b$o[0],b$o[1],b$o[2],b$o[3]),b$k|=16384}if(b$X)switch(b$F||(b$k=16384),b$X.depthStencilFormat){case 33189:b$k|=256;break;case 36168:b$k|=1024;break;case 34041:b$k|=256,b$k|=1024}b$M.clear(b$k),b$F&&b$M.disable(3089);break;case 1:case 2:if(b$X)switch(b$k=16384,b$X.depthStencilFormat){case 33189:b$k|=256;break;case 36168:b$k|=1024;break;case 34041:b$k|=256,b$k|=1024}b$M.clear(b$k);break;case 3:break;default:throw new Error("BaseScene:camera clearFlag invalid.")}},b$M._renderScene=function(b$M,b$y){var b$i,b$H,b$S=b$y.camera,b$f=0;for(b$f=0;b$f<2;b$f++)(b$H=this._quenes[b$f])&&(b$S.renderTarget?b$H._render(b$y,!0):b$H._render(b$y,!1));if(1===b$S.clearFlag){var b$V=b$S.sky;b$V&&(b$m.setCullFace(b$M,!1),b$m.setDepthFunc(b$M,515),b$m.setDepthMask(b$M,!1),b$V._render(b$y),b$m.setDepthFunc(b$M,513),b$m.setDepthMask(b$M,!0))}for(b$f=2,b$i=this._quenes.length;b$f<b$i;b$f++)(b$H=this._quenes[b$f])&&(b$H._sortAlpha(b$y.camera.transform.position),b$S.renderTarget?b$H._render(b$y,!0):b$H._render(b$y,!1))},b$M._set3DRenderConfig=function(b$M){b$M.disable(3042),b$m._blend=!1,b$M.blendFunc(770,771),b$m._sFactor=770,b$m._dFactor=771,b$M.disable(2929),b$m._depthTest=!1,b$M.enable(2884),b$m._cullFace=!0,b$M.depthMask(1),b$m._depthMask=!0,b$M.frontFace(2304),b$m._frontFace=2304},b$M._set2DRenderConfig=function(b$M){b$m.setBlend(b$M,!0),b$m.setBlendFunc(b$M,1,771),b$m.setDepthTest(b$M,!1),b$m.setCullFace(b$M,!1),b$m.setDepthMask(b$M,!0),b$m.setFrontFace(b$M,2305),b$M.viewport(0,0,b$F.width,b$F.height)},b$M._parseCustomProps=function(b$M,b$y,b$i,b$H){var b$S=b$H.customProps.lightmaps,b$f=b$S.length,b$V=this._lightmaps;b$V.length=b$f;for(var b$K=0;b$K<b$f;b$K++)b$V[b$K]=b$C.getRes(b$y[b$S[b$K].replace(".exr",".png")]);this.setlightmaps(b$V);var b$k=b$H.customProps.ambientColor;b$k&&(this.ambientColor=new b$Vy(b$k[0],b$k[1],b$k[2]));var b$X=b$H.customProps.fogColor;b$X&&(this.fogColor=new b$Vy(b$X[0],b$X[1],b$X[2]))},b$M._addLight=function(b$M){this._lights.indexOf(b$M)<0&&this._lights.push(b$M)},b$M._removeLight=function(b$M){var b$y=this._lights.indexOf(b$M);0<=b$y&&this._lights.splice(b$y,1)},b$M._updateScene=function(){var b$M=this._renderState;this._prepareUpdateToRenderState(b$T.mainContext,b$M),this._updateComponents(b$M),this._updateChilds(b$M),this._lateUpdateComponents(b$M),this._time+=b$M.elapsedTime/1e3,this._shaderValues.setValue(22,this._time)},b$M._updateSceneConch=function(){var b$M=this._renderState;this._prepareUpdateToRenderState(b$T.mainContext,b$M),this._updateComponents(b$M),this._lateUpdateComponents(b$M),this._prepareSceneToRender(b$M);for(var b$y=0,b$i=this._cameraPool.length;b$y<b$i;b$y++){var b$H=this._cameraPool[b$y];(b$M.camera=b$H)._prepareCameraToRender()}},b$M._preRenderShadow=function(b$M,b$y,b$i,b$H,b$S){this.treeRoot?b$iM.renderShadowObjectCullingOctree(this,b$y,b$i,b$H,b$S):b$iM.renderShadowObjectCulling(this,b$y,b$i,b$H,b$S);for(var b$f=0,b$V=b$i.length;b$f<b$V;b$f++)b$i[b$f]&&b$i[b$f]._preRender(b$M)},b$M._renderShadowMap=function(b$M,b$y,b$i){var b$H=this.parallelSplitShadowMaps[0];b$H._calcAllLightCameraInfo(b$i);var b$S,b$f,b$V,b$K=b$H.PSSMNum;if(this._preRenderShadow(b$y,b$H._lightCulling,b$H._shadowQuenes,b$H._lightVPMatrix[0],b$K),this.addShaderDefine(b$Py.SHADERDEFINE_CAST_SHADOW),1<b$K)for(var b$k=0;b$k<b$K;b$k++)b$S=b$H.getRenderTarget(b$k+1),b$H.beginRenderTarget(b$k+1),b$M.clearColor(1,1,1,1),b$M.clear(16640),b$M.viewport(0,0,b$S.width,b$S.height),b$y.camera=b$V=b$H.getLightCamera(b$k),b$V._prepareCameraToRender(),b$V._prepareCameraViewProject(b$V.viewMatrix,b$V.projectionMatrix),b$y._projectionViewMatrix=b$H._lightVPMatrix[b$k+1],(b$f=b$H._shadowQuenes[b$k])._preRender(b$y),b$f._renderShadow(b$y,!1),b$H.endRenderTarget(b$k+1);else b$S=b$H.getRenderTarget(1),b$H.beginRenderTarget(1),b$M.clearColor(1,1,1,1),b$M.clear(16640),b$M.viewport(0,0,b$S.width,b$S.height),b$y.camera=b$V=b$H.getLightCamera(0),b$V._prepareCameraToRender(),b$V._prepareCameraViewProject(b$V.viewMatrix,b$V.projectionMatrix),b$y._projectionViewMatrix=b$H._lightVPMatrix[0],(b$f=b$H._shadowQuenes[0])._preRender(b$y),b$f._renderShadow(b$y,!0),b$H.endRenderTarget(1);this.removeShaderDefine(b$Py.SHADERDEFINE_CAST_SHADOW)},b$M.addTreeNode=function(b$M){this.treeRoot.addTreeNode(b$M)},b$M.removeTreeNode=function(b$M){this.treeSize&&b$M._treeNode&&b$M._treeNode.removeObject(b$M)},b$M.setlightmaps=function(b$M){this._lightmaps=b$M;for(var b$y=0,b$i=this._renderableSprite3Ds.length;b$y<b$i;b$y++)this._renderableSprite3Ds[b$y]._render._applyLightMapParams()},b$M.getlightmaps=function(){return this._lightmaps},b$M.addChildAt=function(b$M,b$y){if(!(b$M instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.  className="+(b$M&&b$M.__className));if(!b$M||this.destroyed||b$M===this)return b$M;if(b$M.zOrder&&this._set$P("hasZorder",!0),0<=b$y&&b$y<=this._childs.length){if(b$M._parent===this){var b$i=this.getChildIndex(b$M);this._childs.splice(b$i,1),this._childs.splice(b$y,0,b$M),this.conchModel&&(this.conchModel.removeChild(b$M.conchModel),this.conchModel.addChildAt(b$M.conchModel,b$y)),this._childChanged()}else b$M.parent&&b$M.parent.removeChild(b$M),this._childs===b$X.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(b$y,0,b$M),this.conchModel&&this.conchModel.addChildAt(b$M.conchModel,b$y),(b$M.parent=this)._addChild3D(b$M);return b$M}throw new Error("appendChildAt:The index is out of bounds")},b$M.addChild=function(b$M){if(!(b$M instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!b$M||this.destroyed||b$M===this)return b$M;if(b$M.zOrder&&this._set$P("hasZorder",!0),b$M._parent===this){var b$y=this.getChildIndex(b$M);b$y!==this._childs.length-1&&(this._childs.splice(b$y,1),this._childs.push(b$M),this.conchModel&&(this.conchModel.removeChild(b$M.conchModel),this.conchModel.addChildAt(b$M.conchModel,this._childs.length-1)),this._childChanged())}else b$M.parent&&b$M.parent.removeChild(b$M),this._childs===b$X.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(b$M),this.conchModel&&this.conchModel.addChildAt(b$M.conchModel,this._childs.length-1),(b$M.parent=this)._childChanged(),this._addChild3D(b$M);return b$M},b$M.removeChildAt=function(b$M){var b$y=this.getChildAt(b$M);return b$y&&(this._removeChild3D(b$y),this._childs.splice(b$M,1),this.conchModel&&this.conchModel.removeChild(b$y.conchModel),b$y.parent=null),b$y},b$M.removeChildren=function(b$M,b$y){if(void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=2147483647),this._childs&&0<this._childs.length){var b$i=this._childs;if(0===b$M&&b$f<=b$y){var b$H=b$i;this._childs=b$X.ARRAY_EMPTY}else b$H=b$i.splice(b$M,b$y-b$M);for(var b$S=0,b$f=b$H.length;b$S<b$f;b$S++)this._removeChild3D(b$H[b$S]),b$H[b$S].parent=null,this.conchModel&&this.conchModel.removeChild(b$H[b$S].conchModel)}return this},b$M.addFrustumCullingObject=function(b$M){this.treeRoot?this.addTreeNode(b$M):(this._cullingRendersLength===this._cullingRenders.length?this._cullingRenders.push(b$M):this._cullingRenders[this._cullingRendersLength]=b$M,b$M._indexInSceneFrustumCullingObjects=this._cullingRendersLength++)},b$M.removeFrustumCullingObject=function(b$M){if(this.treeRoot)this.removeTreeNode(b$M);else{this._cullingRendersLength--;var b$y=b$M._indexInSceneFrustumCullingObjects;if(b$y!==this._cullingRendersLength){var b$i=this._cullingRenders[this._cullingRendersLength];(this._cullingRenders[b$y]=b$i)._indexInSceneFrustumCullingObjects=b$y,b$M._indexInSceneFrustumCullingObjects=-1}}},b$M.getRenderQueue=function(b$M){return b$M<3e3?this._quenes[1]||(this._quenes[1]=new b$N(this)):this._quenes[2]||(this._quenes[2]=new b$N(this))},b$M.addRenderQuene=function(){this._quenes[this._customRenderQueneIndex++]=new b$N(this)},b$M.addShaderDefine=function(b$M){this._shaderDefineValue|=b$M},b$M.removeShaderDefine=function(b$M){this._shaderDefineValue&=~b$M},b$M.addScript=function(b$M){return this._addComponent(b$M)},b$M.getScriptByType=function(b$M,b$y){return void 0===b$y&&(b$y=0),this._getComponentByType(b$M,b$y)},b$M.getScriptsByType=function(b$M,b$y){this._getComponentsByType(b$M,b$y)},b$M.getScriptByIndex=function(b$M){return this._getComponentByIndex(b$M)},b$M.removeScriptByType=function(b$M,b$y){void 0===b$y&&(b$y=0),this._removeComponentByType(b$M,b$y)},b$M.removeScriptsByType=function(b$M){this._removeComponentByType(b$M)},b$M.removeAllScript=function(){this._removeAllComponent()},b$M.render=function(b$M,b$y,b$i){(b$J._context.ctx._renderKey=0)<this._childs.length&&b$M.addRenderObject(this)},b$M.renderSubmit=function(){var b$M=b$T.mainContext,b$y=this._renderState;this._set3DRenderConfig(b$M),this._prepareSceneToRender(this._renderState);var b$i,b$H=0,b$S=0;if(b$Cy.debugMode||b$x.debugMode)for(b$H=0,b$S=this._cameraPool.length;b$H<b$S;b$H++)b$i=this._cameraPool[b$H],b$Cy._debugPhasorSprite.begin(1,b$i),b$i.activeInHierarchy&&b$i._renderCamera(b$M,b$y,this),b$Cy._debugPhasorSprite.end();else for(b$H=0,b$S=this._cameraPool.length;b$H<b$S;b$H++)(b$i=this._cameraPool[b$H]).activeInHierarchy&&b$i._renderCamera(b$M,b$y,this);return this._set2DRenderConfig(b$M),1},b$M.onAsynLoaded=function(b$M,b$y,b$i){var b$H=b$y[0];if("Scene"!==b$H.type)throw new Error("Scene: the .lh file root type must be Scene,please use other function to  load  this file.");var b$S=b$y[1];b$hy._createNodeByJson(this,b$H,this,b$S),this.event("hierarchyloaded",[this]),this.__loaded=!0},b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),this.destroyed||(b$y.prototype.destroy.call(this,b$M),this._renderState=null,this._lights=null,this._lightmaps=null,this._renderTargetTexture=null,this._shaderValues=null,this._cullingRenders=null,this._dynamicBatchManager=null,this._quenes=null,this._cameraPool=null,this._renderableSprite3Ds=null,this.treeRoot=null,this.treeSize=null,this.parallelSplitShadowMaps=null,this._typeComponentsIndices=null,this._components=null,b$C.clearRes(this.url),this.loaded||b$Cy._cancelLoadByUrl(this.url))},b$M.getRenderType=function(){return 0},b$M.releaseRender=function(){},b$M._addComponent=function(b$M){var b$y,b$i=this._componentsMap.indexOf(b$M);if(-1===b$i)b$y=[],this._componentsMap.push(b$M),this._typeComponentsIndices.push(b$y);else if(b$y=this._typeComponentsIndices[b$i],this._components[b$y[0]].isSingleton)throw new Error("无法单实例创建"+b$M+"组件，"+b$M+"组件已存在！");var b$H=b$S.getInstance(b$M);b$y.push(this._components.length),this._components.push(b$H);return b$H._initialize(this),b$H},b$M._removeComponent=function(b$M,b$y){var b$i=this._typeComponentsIndices[b$M],b$H=b$i[b$y],b$S=this._components[b$H];this._components.splice(b$H,1),b$i.splice(b$y,1),0===b$i.length&&(this._typeComponentsIndices.splice(b$M,1),this._componentsMap.splice(b$M,1));for(var b$f=0,b$V=this._componentsMap.length;b$f<b$V;b$f++)for(var b$K=(b$i=this._typeComponentsIndices[b$f]).length-1;0<=b$K;b$K--){var b$k=b$i[b$K];if(!(b$H<b$k))break;b$i[b$K]=--b$k}b$S._destroy()},b$M._getComponentByType=function(b$M,b$y){void 0===b$y&&(b$y=0);var b$i=this._componentsMap.indexOf(b$M);return-1===b$i?null:this._components[this._typeComponentsIndices[b$i][b$y]]},b$M._getComponentsByType=function(b$M,b$y){var b$i=this._componentsMap.indexOf(b$M);if(-1!==b$i){var b$H=this._typeComponentsIndices[b$i],b$S=b$H.length;b$y.length=b$S;for(var b$f=0;b$f<b$S;b$f++)b$y[b$f]=this._components[b$H[b$f]]}else b$y.length=0},b$M._getComponentByIndex=function(b$M){return this._components[b$M]},b$M._removeComponentByType=function(b$M,b$y){void 0===b$y&&(b$y=0);var b$i=this._componentsMap.indexOf(b$M);-1!==b$i&&this._removeComponent(b$i,b$y)},b$M._removeComponentsByType=function(b$M){var b$y=this._componentsMap.indexOf(b$M);if(-1!==b$y)for(var b$i=this._typeComponentsIndices[b$y],b$H=0,b$S=b$i.length;b$H<b$S;b$i.length<b$S?b$S--:b$H++)this._removeComponent(b$y,b$H)},b$M._removeAllComponent=function(){for(var b$M=0,b$y=this._componentsMap.length;b$M<b$y;this._componentsMap.length<b$y?b$y--:b$M++)this._removeComponentsByType(this._componentsMap[b$M])},b$M._updateComponents=function(b$M){for(var b$y=0,b$i=this._components.length;b$y<b$i;b$y++){var b$H=this._components[b$y];!b$H.started&&(b$H._start(b$M),b$H.started=!0),b$H.enable&&b$H._update(b$M)}},b$M._lateUpdateComponents=function(b$M){for(var b$y=0;b$y<this._components.length;b$y++){var b$i=this._components[b$y];!b$i.started&&(b$i._start(b$M),b$i.started=!0),b$i.enable&&b$i._lateUpdate(b$M)}},b$M._preRenderUpdateComponents=function(b$M){for(var b$y=0;b$y<this._components.length;b$y++){var b$i=this._components[b$y];!b$i.started&&(b$i._start(b$M),b$i.started=!0),b$i.enable&&b$i._preRenderUpdate(b$M)}},b$M._postRenderUpdateComponents=function(b$M){for(var b$y=0;b$y<this._components.length;b$y++){var b$i=this._components[b$y];!b$i.started&&(b$i._start(b$M),b$i.started=!0),b$i.enable&&b$i._postRenderUpdate(b$M)}},b$l(0,b$M,"_loaded",null,function(b$M){this.__loaded=b$M}),b$l(0,b$M,"fogColor",function(){return this._fogColor},function(b$M){this._fogColor=b$M,this._shaderValues.setValue(0,b$M.elements)}),b$l(0,b$M,"enableFog",function(){return this._enableFog},function(b$M){this._enableFog!==b$M&&((this._enableFog=b$M)?(this.addShaderDefine(b$Qy.SHADERDEFINE_FOG),this.removeShaderDefine(b$Qy.SAHDERDEFINE_DEPTHFOG)):this.removeShaderDefine(b$Qy.SHADERDEFINE_FOG))}),b$l(0,b$M,"url",function(){return this._url}),b$l(0,b$M,"loaded",function(){return this.__loaded}),b$l(0,b$M,"enableDepthFog",function(){return this._enableDepthFog},function(b$M){this._enableDepthFog!=b$M&&((this._enableDepthFog=b$M)?(this.addShaderDefine(b$Qy.SAHDERDEFINE_DEPTHFOG),this.removeShaderDefine(b$Qy.SHADERDEFINE_FOG)):this.removeShaderDefine(b$Qy.SAHDERDEFINE_DEPTHFOG))}),b$l(0,b$M,"fogStart",function(){return this._fogStart},function(b$M){this._fogStart=b$M,this._shaderValues.setValue(1,b$M)}),b$l(0,b$M,"fogRange",function(){return this._fogRange},function(b$M){this._fogRange=b$M,this._shaderValues.setValue(2,b$M)}),b$l(0,b$M,"ambientColor",function(){return this._ambientColor},function(b$M){this._ambientColor=b$M,this._shaderValues.setValue(21,b$M.elements)}),b$l(0,b$M,"scene",function(){return this}),b$l(0,b$M,"renderableSprite3Ds",function(){return this._renderableSprite3Ds.slice()}),b$H._sortScenes=function(b$M,b$y){if(b$M.parent!==b$G.stage||b$y.parent!==b$G.stage)return b$M.parent!==b$G.stage&&b$y.parent!==b$G.stage?b$H._sortScenes(b$M.parent,b$y.parent):b$M.parent===b$G.stage?-1:1;var b$i=b$G.stage._childs;return b$i.indexOf(b$M)-b$i.indexOf(b$y)},b$H.load=function(b$M){return b$G.loader.create(b$M,null,null,b$H)},b$H.FOGCOLOR=0,b$H.FOGSTART=1,b$H.FOGRANGE=2,b$H.LIGHTDIRECTION=3,b$H.LIGHTDIRCOLOR=4,b$H.POINTLIGHTPOS=5,b$H.POINTLIGHTRANGE=6,b$H.POINTLIGHTATTENUATION=7,b$H.POINTLIGHTCOLOR=8,b$H.SPOTLIGHTPOS=9,b$H.SPOTLIGHTDIRECTION=10,b$H.SPOTLIGHTSPOT=11,b$H.SPOTLIGHTRANGE=12,b$H.SPOTLIGHTATTENUATION=13,b$H.SPOTLIGHTCOLOR=14,b$H.SHADOWDISTANCE=15,b$H.SHADOWLIGHTVIEWPROJECT=16,b$H.SHADOWMAPPCFOFFSET=17,b$H.SHADOWMAPTEXTURE1=18,b$H.SHADOWMAPTEXTURE2=19,b$H.SHADOWMAPTEXTURE3=20,b$H.AMBIENTCOLOR=21,b$H.TIME=22,b$H}(b$U),b$zy=function(b$M){function b$y(b$M){b$y.__super.call(this),this.__loaded=!0,this._projectionViewWorldUpdateLoopCount=-1,this._activeInHierarchy=!1,this._projectionViewWorldMatrix=new b$My,this._shaderValues=new b$dy,this._colliders=[],this._id=++b$y._uniqueIDCounter,this._transform=new b$Iy(this),this.name=b$M||"Sprite3D-"+b$y._nameNumberCounter++,this.layer=b$s.currentCreationLayer,this.active=!0}b$P(b$y,"laya.d3.core.Sprite3D",b$ny);var b$i=b$y.prototype;return b$G.imps(b$i,{"laya.d3.core.render.IUpdate":!0,"laya.resource.ICreateResource":!0,"laya.d3.core.IClone":!0}),b$i._setUrl=function(b$M){this._url=b$M},b$i._getGroup=function(){return this._group},b$i._setGroup=function(b$M){this._group=b$M},b$i._addChild3D=function(b$M){b$M.transform.parent=this.transform,this._hierarchyAnimator&&(!b$M._hierarchyAnimator&&b$M._setHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(b$M,!0,[b$M.name])),this._scene&&(b$M._setBelongScene(this._scene),this._activeInHierarchy&&b$M._active&&b$M._activeHierarchy())},b$i._removeChild3D=function(b$M){b$M.transform.parent=null,this._scene&&(this._activeInHierarchy&&b$M._active&&b$M._inActiveHierarchy(),b$M._setUnBelongScene()),this._hierarchyAnimator&&(b$M._hierarchyAnimator==this._hierarchyAnimator&&b$M._clearHierarchyAnimator(this._hierarchyAnimator,null),this._getAnimatorToLinkSprite3D(b$M,!1,[b$M.name]))},b$i._parseBaseCustomProps=function(b$M){var b$y=this.transform.localPosition;b$M.translate?(b$y.fromArray(b$M.translate),b$y.x*=100,b$y.y*=100,b$y.z*=100):b$y.elements.fill(0),this.transform.localPosition=b$y;var b$i=this.transform.localRotation;b$M.rotation?b$i.fromArray(b$M.rotation):b$i.fromArray([0,0,0,-1]),this.transform.localRotation=b$i;var b$H=this.transform.localScale;b$M.scale?b$H.fromArray(b$M.scale):b$H.elements.fill(1),this.transform.localScale=b$H;var b$S=b$M.layer;null!=b$S&&(this.layer=b$s.getLayerByNumber(b$S))},b$i._parseCustomComponent=function(b$M,b$y,b$i){for(var b$H in b$i){var b$S=b$i[b$H];switch(b$H){case"Animator":var b$f=this.addComponent(Animator);if(b$S.avatarPath)b$f.avatar=b$C.getRes(b$y[b$S.avatarPath]);else{var b$V=b$S.avatar;if(b$V){b$f.avatar=b$C.getRes(b$y[b$V.path]);var b$K=b$V.linkSprites;b$K&&b$M.once("hierarchyloaded",this,this._onRootNodeHierarchyLoaded,[b$f,b$K])}}for(var b$k=b$S.clipPaths,b$X=b$k.length,b$F=0;b$F<b$X;b$F++)b$f.addClip(b$C.getRes(b$y[b$k[b$F]]));b$f.clip=b$C.getRes(b$y[b$k[0]]);var b$o=b$S.playOnWake;void 0!==b$o&&(b$f.playOnWake=b$o);break;case"Rigidbody":this.addComponent(Rigidbody);break;case"SphereCollider":var b$d=this.addComponent(SphereCollider);b$d.isTrigger=b$S.isTrigger;var b$P=b$d.center;b$P.fromArray(b$S.center),b$d.center=b$P,b$d.radius=b$S.radius;break;case"BoxCollider":var b$l=this.addComponent(BoxCollider);b$l.isTrigger=b$S.isTrigger,b$l.center.fromArray(b$S.center);var b$J=b$l.size;b$J.fromArray(b$S.size),b$l.size=b$J;break;case"MeshCollider":this.addComponent(MeshCollider)}}},b$i._onRootNodeHierarchyLoaded=function(b$M,b$y){for(var b$i in b$y){for(var b$H=this,b$S=b$y[b$i],b$f=0,b$V=b$S.length;b$f<b$V;b$f++){var b$K=b$S[b$f];if(""===b$K)break;if(!(b$H=b$H.getChildByName(b$K)))break}b$H&&b$M.linkSprite3DToAvatarNode(b$i,b$H)}},b$i._setHierarchyAnimator=function(b$M,b$y){this._changeHierarchyAnimator(b$M);for(var b$i=0,b$H=this._childs.length;b$i<b$H;b$i++){var b$S=this._childs[b$i];b$S._hierarchyAnimator==b$y&&b$S._setHierarchyAnimator(b$M,b$y)}},b$i._clearHierarchyAnimator=function(b$M,b$y){this._changeHierarchyAnimator(b$y);for(var b$i=0,b$H=this._childs.length;b$i<b$H;b$i++){var b$S=this._childs[b$i];b$S._hierarchyAnimator==b$M&&b$S._clearHierarchyAnimator(b$M,b$y)}},b$i._getAnimatorToLinkSprite3D=function(b$M,b$y,b$i){var b$H=this.getComponentByType(Animator);if(b$H&&(b$H.avatar?b$H.avatar._version||b$M._setAnimatorToLinkAvatar(b$H,b$y):b$M._setAnimatorToLinkSprite3DNoAvatar(b$H,b$y,b$i)),this._parent&&this._parent instanceof laya.d3.core.Sprite3D){b$i.unshift(this._parent.name);var b$S=this._parent;b$S._hierarchyAnimator&&b$S._getAnimatorToLinkSprite3D(b$M,b$y,b$i)}},b$i._setAnimatorToLinkSprite3DNoAvatar=function(b$M,b$y,b$i){var b$H=0,b$S=0;for(b$H=0,b$S=b$M.getClipCount();b$H<b$S;b$H++)b$M._handleSpriteOwnersBySprite(b$H,b$y,b$i,this);for(b$H=0,b$S=this._childs.length;b$H<b$S;b$H++){var b$f=this._childs[b$H],b$V=b$i.length;b$i.push(b$f.name),b$f._setAnimatorToLinkSprite3DNoAvatar(b$M,b$y,b$i),b$i.splice(b$V,1)}},b$i._changeHierarchyAnimator=function(b$M){this._hierarchyAnimator=b$M},b$i._isLinkSpriteToAnimationNode=function(b$M,b$y,b$i){var b$H=b$M._avatarNodes.indexOf(b$y),b$S=b$M._cacheSpriteToNodesMap;if(b$i)this._transform.dummy=b$y.transform,b$M._cacheNodesToSpriteMap[b$H]=b$S.length,b$S.push(b$H);else{this._transform.dummy=null;var b$f=b$M._cacheNodesToSpriteMap[b$H];b$M._cacheNodesToSpriteMap[b$H]=null,b$S.splice(b$f,1)}},b$i._setBelongScene=function(b$M){this._scene=b$M;for(var b$y=0,b$i=this._childs.length;b$y<b$i;b$y++)this._childs[b$y]._setBelongScene(b$M)},b$i._setUnBelongScene=function(){this._scene=null;for(var b$M=0,b$y=this._childs.length;b$M<b$y;b$M++)this._childs[b$M]._setUnBelongScene()},b$i._activeHierarchy=function(){var b$M=0,b$y=0;for(this._activeInHierarchy=!0,this._addSelfRenderObjects(),b$M=0,b$y=this._colliders.length;b$M<b$y;b$M++)this._layer._addCollider(this._colliders[b$M]);for(this.event("activeinhierarchychanged",!0),b$M=0,b$y=this._childs.length;b$M<b$y;b$M++){var b$i=this._childs[b$M];b$i._active&&b$i._activeHierarchy()}},b$i._inActiveHierarchy=function(){var b$M=0,b$y=0;for(this._activeInHierarchy=!1,this._clearSelfRenderObjects(),b$M=0,b$y=this._colliders.length;b$M<b$y;b$M++){var b$i=this._colliders[b$M];b$i._clearCollsionMap(),this._layer._removeCollider(b$i)}for(this.event("activeinhierarchychanged",!1),b$M=0,b$y=this._childs.length;b$M<b$y;b$M++){var b$H=this._childs[b$M];b$H._active&&b$H._inActiveHierarchy()}},b$i.addComponent=function(b$M){var b$y,b$i=this._componentsMap.indexOf(b$M);if(-1===b$i)b$y=[],this._componentsMap.push(b$M),this._typeComponentsIndices.push(b$y);else if(b$y=this._typeComponentsIndices[b$i],this._components[b$y[0]].isSingleton)throw new Error("无法单实例创建"+b$M+"组件，"+b$M+"组件已存在！");var b$H=b$S.getInstance(b$M);return b$y.push(this._components.length),this._components.push(b$H),b$H instanceof laya.d3.component.Script&&this._scripts.push(b$H),b$H._initialize(this),b$H},b$i._removeComponent=function(b$M,b$y){var b$i,b$H=0,b$S=this._typeComponentsIndices[b$M],b$f=b$S[b$y],b$V=this._components[b$f];for(b$V instanceof laya.d3.component.Script&&this._scripts.splice(this._scripts.indexOf(b$V),1),b$S.splice(b$y,1),0===b$S.length&&(this._typeComponentsIndices.splice(b$M,1),this._componentsMap.splice(b$M,1)),b$H=0,b$i=this._componentsMap.length;b$H<b$i;b$H++)for(var b$K=(b$S=this._typeComponentsIndices[b$H]).length-1;0<=b$K;b$K--){var b$k=b$S[b$K];if(!(b$f<b$k))break;b$S[b$K]=--b$k}b$V._destroy()},b$i._clearSelfRenderObjects=function(){},b$i._addSelfRenderObjects=function(){},b$i._parseCustomProps=function(b$M,b$y,b$i,b$H){},b$i._updateChilds=function(b$M){var b$y=this._childs.length;if(0!==b$y)for(var b$i=0;b$i<b$y;++b$i)this._childs[b$i]._update(b$M)},b$i._getSortID=function(b$M,b$y){return 1e3*b$y.id+b$M._getVertexBuffer().vertexDeclaration.id},b$i._update=function(b$M){(b$M.owner=this)._activeInHierarchy&&(this._updateComponents(b$M),this._lateUpdateComponents(b$M),b$Q.spriteCount++,this._childs.length&&this._updateChilds(b$M))},b$i.getProjectionViewWorldMatrix=function(b$M){return b$My.multiply(b$M,this.transform.worldMatrix,this._projectionViewWorldMatrix),this._projectionViewWorldMatrix},b$i.loadHierarchy=function(b$M){this.addChild(laya.d3.core.Sprite3D.load(b$M))},b$i.addChildAt=function(b$M,b$y){if(!(b$M instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!b$M||this.destroyed||b$M===this)return b$M;if(b$M.zOrder&&this._set$P("hasZorder",!0),0<=b$y&&b$y<=this._childs.length){if(b$M._parent===this){var b$i=this.getChildIndex(b$M);this._childs.splice(b$i,1),this._childs.splice(b$y,0,b$M),this.conchModel&&(this.conchModel.removeChild(b$M.conchModel),this.conchModel.addChildAt(b$M.conchModel,b$y)),this._childChanged()}else b$M.parent&&b$M.parent.removeChild(b$M),this._childs===b$X.ARRAY_EMPTY&&(this._childs=[]),this._childs.splice(b$y,0,b$M),this.conchModel&&this.conchModel.addChildAt(b$M.conchModel,b$y),(b$M.parent=this)._addChild3D(b$M);return b$M}throw new Error("appendChildAt:The index is out of bounds")},b$i.addChild=function(b$M){if(!(b$M instanceof laya.d3.core.Sprite3D))throw new Error("Sprite3D:Node type must Sprite3D.");if(!b$M||this.destroyed||b$M===this)return b$M;if(b$M.zOrder&&this._set$P("hasZorder",!0),b$M._parent===this){var b$y=this.getChildIndex(b$M);b$y!==this._childs.length-1&&(this._childs.splice(b$y,1),this._childs.push(b$M),this.conchModel&&(this.conchModel.removeChild(b$M.conchModel),this.conchModel.addChildAt(b$M.conchModel,this._childs.length-1)),this._childChanged())}else b$M.parent&&b$M.parent.removeChild(b$M),this._childs===b$X.ARRAY_EMPTY&&(this._childs=[]),this._childs.push(b$M),this.conchModel&&this.conchModel.addChildAt(b$M.conchModel,this._childs.length-1),(b$M.parent=this)._childChanged(),this._addChild3D(b$M);return b$M},b$i.removeChildAt=function(b$M){var b$y=this.getChildAt(b$M);return b$y&&(this._removeChild3D(b$y),this._childs.splice(b$M,1),this.conchModel&&this.conchModel.removeChild(b$y.conchModel),b$y.parent=null),b$y},b$i.removeChildren=function(b$M,b$y){if(void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=2147483647),this._childs&&0<this._childs.length){var b$i=this._childs;if(0===b$M&&b$f<=b$y){var b$H=b$i;this._childs=b$X.ARRAY_EMPTY}else b$H=b$i.splice(b$M,b$y-b$M);for(var b$S=0,b$f=b$H.length;b$S<b$f;b$S++)this._removeChild3D(b$H[b$S]),b$H[b$S].parent=null,this.conchModel&&this.conchModel.removeChild(b$H[b$S].conchModel)}return this},b$i.onAsynLoaded=function(b$M,b$y,b$i){var b$H=b$y[0];if("Sprite3D"!==b$H.type)throw new Error("Sprite3D: The .lh file root type must be Sprite3D,please use other function to  load  this file.");var b$S=b$y[1];b$hy._createNodeByJson(this,b$H,this,b$S),this.event("hierarchyloaded",[this]),this.__loaded=!0},b$i.cloneTo=function(b$M){if(this.destroyed)throw new Error("Sprite3D: Can't be cloned if the Sprite3D has destroyed.");var b$y=b$M;b$y.name=this.name,b$y._destroyed=this._destroyed,b$y.timer=this.timer,b$y._$P=this._$P,b$y.active=this._active;var b$i=b$y.transform.localPosition;this.transform.localPosition.cloneTo(b$i),b$y.transform.localPosition=b$i;var b$H=b$y.transform.localRotation;this.transform.localRotation.cloneTo(b$H),b$y.transform.localRotation=b$H;var b$S=b$y.transform.localScale;this.transform.localScale.cloneTo(b$S),b$y.transform.localScale=b$S,b$y.isStatic=this.isStatic;var b$f=0,b$V=0;for(b$f=0,b$V=this._componentsMap.length;b$f<b$V;b$f++){var b$K=b$y.addComponent(this._componentsMap[b$f]);this._components[b$f]._cloneTo(b$K)}for(b$f=0,b$V=this._childs.length;b$f<b$V;b$f++)b$y.addChild(this._childs[b$f].clone());var b$k=b$y.getComponentByType(Animator);if(b$k){var b$X=b$k._linkSpritesData;if(b$X)for(var b$F in b$X){for(var b$o=b$X[b$F],b$d=b$y,b$P=0,b$l=b$o.length;b$P<b$l&&(b$d=b$d.getChildByName(b$o[b$P]));b$P++);if(b$d){var b$J=b$k._avatarNodeMap[b$F];b$d._isLinkSpriteToAnimationNode(b$k,b$J,!0)}}}},b$i.clone=function(){var b$M=new this.constructor;return this.cloneTo(b$M),b$M},b$i.destroy=function(b$M){if(void 0===b$M&&(b$M=!0),!this.destroyed){laya.display.Node.prototype.destroy.call(this,b$M);var b$y,b$i=0;for(b$i=0,b$y=this._components.length;b$i<b$y;b$i++)this._components[b$i]._destroy();this._components=null,this._componentsMap=null,this._typeComponentsIndices=null,this._transform=null,this._colliders=null,b$C.clearRes(this.url),this.loaded||b$Cy._cancelLoadByUrl(this.url)}},b$i._handleSpriteToAvatar=function(b$M,b$y){b$M._avatarNodes;var b$i=b$M._avatarNodeMap[this.name];b$i&&b$i.name===this.name&&!this._transform.dummy&&this._isLinkSpriteToAnimationNode(b$M,b$i,b$y)},b$i._setAnimatorToLinkAvatar=function(b$M,b$y){this._handleSpriteToAvatar(b$M,b$y);for(var b$i=0,b$H=this._childs.length;b$i<b$H;b$i++){this._childs[b$i]._setAnimatorToLinkAvatar(b$M,b$y)}},b$l(0,b$i,"activeInHierarchy",function(){return this._activeInHierarchy}),b$l(0,b$i,"_loaded",null,function(b$M){this.__loaded=b$M}),b$l(0,b$i,"active",function(){return this._active},function(b$M){this._active!==b$M&&(this._active=b$M,this._parent&&(this._parent===this._scene&&this._parent.displayedInStage||this._parent._activeInHierarchy)&&(b$M?this._activeHierarchy():this._inActiveHierarchy()))}),b$l(0,b$i,"componentsCount",function(){return this._components.length}),b$l(0,b$i,"loaded",function(){return this.__loaded}),b$l(0,b$i,"id",function(){return this._id}),b$l(0,b$i,"url",function(){return this._url}),b$l(0,b$i,"layer",function(){return this._layer},function(b$M){if(this._layer!==b$M){if(!b$M)throw new Error("Layer value can be null.");if(this._activeInHierarchy){var b$y=0,b$i=this._colliders.length;if(this._layer)for(b$y=0;b$y<b$i;b$y++)this._layer._removeCollider(this._colliders[b$y]);for(b$y=0;b$y<b$i;b$y++)b$M._addCollider(this._colliders[b$y])}this._layer=b$M,this.event("layerchanged",b$M)}}),b$l(0,b$i,"scene",function(){return this._scene}),b$l(0,b$i,"transform",function(){return this._transform}),b$y.instantiate=function(b$M,b$y,b$i,b$H,b$S){void 0===b$i&&(b$i=!0);var b$f=b$M.clone();b$y&&b$y.addChild(b$f);var b$V=b$f.transform;if(b$i){var b$K=b$V.worldMatrix;b$M.transform.worldMatrix.cloneTo(b$K),b$V.worldMatrix=b$K}else b$H&&(b$V.position=b$H),b$S&&(b$V.rotation=b$S);return b$f},b$y.load=function(b$M){return b$G.loader.create(b$M,null,null,b$y)},b$y.WORLDMATRIX=0,b$y.MVPMATRIX=1,b$y._uniqueIDCounter=0,b$y._nameNumberCounter=0,b$y}(),b$wy=function(b$M){function b$F(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){if(this._curActTexIndex=0,this._program=null,this._attributeParams=null,this._uniformParams=null,this._attributeParamsMap=[],this._sceneUniformParamsMap=[],this._cameraUniformParamsMap=[],this._spriteUniformParamsMap=[],this._materialUniformParamsMap=[],this._renderElementUniformParamsMap=[],b$F.__super.call(this),!b$M||!b$y)throw"Shader Error";this._id=++b$F._count,this._vs=b$M,this._ps=b$y,this._attributeMap=b$i,this._sceneUniformMap=b$H,this._cameraUniformMap=b$S,this._spriteUniformMap=b$f,this._materialUniformMap=b$V,this._renderElementUniformMap=b$K,this._precompile=b$k,this._define=b$X,this._precompile&&b$F.extCompileObj&&b$F.extCompileFunc?b$F.extCompileFunc.call(b$F.extCompileObj,b$M,b$y,b$X):this.recreateResource()}b$P(b$F,"laya.d3.shader.Shader3D",b$i);var b$y=b$F.prototype;return b$y.recreateResource=function(){b$e.now();this._compile(),this.completeCreate(),this.memorySize=0},b$y.disposeResource=function(){b$T.mainContext.deleteShader(this._vshader),b$T.mainContext.deleteShader(this._pshader),b$T.mainContext.deleteProgram(this._program),this._vshader=this._pshader=this._program=null,this._attributeParams=null,this._uniformParams=null,this.memorySize=0,this._curActTexIndex=0},b$y._compile=function(){if(!b$T.mainContext.isContextLost()&&this._vs&&this._ps&&!this._attributeParams&&!this._uniformParams){this._reCompile=!0,this._attributeParams=[],this._uniformParams=[];var b$M=[this._vs,this._ps],b$y=b$T.mainContext;if(this._program=b$y.createProgram(),this._vshader=b$F._createShader(b$y,b$M[0],35633),this._pshader=b$F._createShader(b$y,b$M[1],35632),b$y.attachShader(this._program,this._vshader),b$y.attachShader(this._program,this._pshader),b$y.linkProgram(this._program),!b$J.isConchApp&&b$Qy.debugMode&&!b$y.getProgramParameter(this._program,35714))throw b$y.getProgramInfoLog(this._program);var b$i,b$H=0,b$S=0,b$f=0;for(b$f=b$J.isConchApp?b$y.getProgramParameterEx(this._vs,this._ps,"",35721):b$y.getProgramParameter(this._program,35721),b$H=0;b$H<b$f;b$H++){var b$V=null;b$i={vartype:"attribute",ivartype:0,attrib:b$V=b$J.isConchApp?b$y.getActiveAttribEx(this._vs,this._ps,"",b$H):b$y.getActiveAttrib(this._program,b$H),location:b$y.getAttribLocation(this._program,b$V.name),name:b$V.name,type:b$V.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0},this._attributeParams.push(b$i)}var b$K=0;for(b$K=b$J.isConchApp?b$y.getProgramParameterEx(this._vs,this._ps,"",35718):b$y.getProgramParameter(this._program,35718),b$H=0;b$H<b$K;b$H++){var b$k=null;b$k=b$J.isConchApp?b$y.getActiveUniformEx(this._vs,this._ps,"",b$H):b$y.getActiveUniform(this._program,b$H),0<(b$i={vartype:"uniform",ivartype:1,attrib:b$V,location:b$y.getUniformLocation(this._program,b$k.name),name:b$k.name,type:b$k.type,isArray:!1,isSame:!1,preValue:null,indexOfParams:0}).name.indexOf("[0]")&&(b$i.name=b$i.name.substr(0,b$i.name.length-3),b$i.isArray=!0,b$i.location=b$y.getUniformLocation(this._program,b$i.name)),this._uniformParams.push(b$i)}for(b$H=0,b$S=this._attributeParams.length;b$H<b$S;b$H++)(b$i=this._attributeParams[b$H]).indexOfParams=b$H,b$i.index=1,b$i.value=[b$i.location,null],b$i.codename=b$i.name,b$i.name=null!=this._attributeMap[b$i.codename]?this._attributeMap[b$i.codename]:b$i.codename,this._attributeParamsMap.push(b$i.name),this._attributeParamsMap.push(b$i),b$i._this=this,b$i.uploadedValue=[],b$i.fun=this._attribute;for(b$H=0,b$S=this._uniformParams.length;b$H<b$S;b$H++)switch((b$i=this._uniformParams[b$H]).indexOfParams=b$H,b$i.index=1,b$i.value=[b$i.location,null],b$i.codename=b$i.name,null!=this._sceneUniformMap[b$i.codename]?(b$i.name=this._sceneUniformMap[b$i.codename],this._sceneUniformParamsMap.push(b$i.name),this._sceneUniformParamsMap.push(b$i)):null!=this._cameraUniformMap[b$i.codename]?(b$i.name=this._cameraUniformMap[b$i.codename],this._cameraUniformParamsMap.push(b$i.name),this._cameraUniformParamsMap.push(b$i)):null!=this._spriteUniformMap[b$i.codename]?(b$i.name=this._spriteUniformMap[b$i.codename],this._spriteUniformParamsMap.push(b$i.name),this._spriteUniformParamsMap.push(b$i)):null!=this._materialUniformMap[b$i.codename]?(b$i.name=this._materialUniformMap[b$i.codename],this._materialUniformParamsMap.push(b$i.name),this._materialUniformParamsMap.push(b$i)):null!=this._renderElementUniformMap[b$i.codename]?(b$i.name=this._renderElementUniformMap[b$i.codename],this._renderElementUniformParamsMap.push(b$i.name),this._renderElementUniformParamsMap.push(b$i)):console.log("Shader:can't find uinform name:"+b$i.codename+" in shader file."),b$i._this=this,b$i.uploadedValue=[],b$i.type){case 5124:b$i.fun=b$i.isArray?this._uniform1iv:this._uniform1i;break;case 5126:b$i.fun=b$i.isArray?this._uniform1fv:this._uniform1f;break;case 35664:b$i.fun=b$i.isArray?this._uniform_vec2v:this._uniform_vec2;break;case 35665:b$i.fun=b$i.isArray?this._uniform_vec3v:this._uniform_vec3;break;case 35666:b$i.fun=b$i.isArray?this._uniform_vec4v:this._uniform_vec4;break;case 35678:b$i.fun=this._uniform_sampler2D;break;case 35680:b$i.fun=this._uniform_samplerCube;break;case 35676:b$i.fun=this._uniformMatrix4fv;break;case 35670:b$i.fun=this._uniform1i;break;case 35674:b$i.fun=this._uinformMatrix2fv;break;case 35675:b$i.fun=this._uinformMatrix3fv;break;default:throw new Error("compile shader err!")}}},b$y._attribute=function(b$M,b$y){var b$i=b$T.mainContext,b$H=b$K._enableAtributes,b$S=b$M.location;return b$H[b$S]||b$i.enableVertexAttribArray(b$S),b$i.vertexAttribPointer(b$S,b$y[0],b$y[1],b$y[2],b$y[3],b$y[4]),b$H[b$S]=b$K._bindVertexBuffer,1},b$y._uniform1f=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y?(b$T.mainContext.uniform1f(b$M.location,b$i[0]=b$y),1):0},b$y._uniform1fv=function(b$M,b$y){if(b$y.length<4){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]||b$i[2]!==b$y[2]||b$i[3]!==b$y[3]?(b$T.mainContext.uniform1fv(b$M.location,b$y),b$i[0]=b$y[0],b$i[1]=b$y[1],b$i[2]=b$y[2],b$i[3]=b$y[3],1):0}return b$T.mainContext.uniform1fv(b$M.location,b$y),1},b$y._uniform_vec2=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]?(b$T.mainContext.uniform2f(b$M.location,b$i[0]=b$y[0],b$i[1]=b$y[1]),1):0},b$y._uniform_vec2v=function(b$M,b$y){if(b$y.length<2){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]||b$i[2]!==b$y[2]||b$i[3]!==b$y[3]?(b$T.mainContext.uniform2fv(b$M.location,b$y),b$i[0]=b$y[0],b$i[1]=b$y[1],b$i[2]=b$y[2],b$i[3]=b$y[3],1):0}return b$T.mainContext.uniform2fv(b$M.location,b$y),1},b$y._uniform_vec3=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]||b$i[2]!==b$y[2]?(b$T.mainContext.uniform3f(b$M.location,b$i[0]=b$y[0],b$i[1]=b$y[1],b$i[2]=b$y[2]),1):0},b$y._uniform_vec3v=function(b$M,b$y){return b$T.mainContext.uniform3fv(b$M.location,b$y),1},b$y._uniform_vec4=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]||b$i[2]!==b$y[2]||b$i[3]!==b$y[3]?(b$T.mainContext.uniform4f(b$M.location,b$i[0]=b$y[0],b$i[1]=b$y[1],b$i[2]=b$y[2],b$i[3]=b$y[3]),1):0},b$y._uniform_vec4v=function(b$M,b$y){return b$T.mainContext.uniform4fv(b$M.location,b$y),1},b$y._uniformMatrix2fv=function(b$M,b$y){return b$T.mainContext.uniformMatrix2fv(b$M.location,!1,b$y),1},b$y._uniformMatrix3fv=function(b$M,b$y){return b$T.mainContext.uniformMatrix3fv(b$M.location,!1,b$y),1},b$y._uniformMatrix4fv=function(b$M,b$y){return b$T.mainContext.uniformMatrix4fv(b$M.location,!1,b$y),1},b$y._uinformMatrix2fv=function(b$M,b$y){return b$T.mainContext.uniformMatrix2fv(b$M.location,!1,b$y),1},b$y._uinformMatrix3fv=function(b$M,b$y){return b$T.mainContext.uniformMatrix3fv(b$M.location,!1,b$y),1},b$y._uniform1i=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y?(b$T.mainContext.uniform1i(b$M.location,b$i[0]=b$y),1):0},b$y._uniform1iv=function(b$M,b$y){return b$T.mainContext.uniform1iv(b$M.location,b$y),1},b$y._uniform_ivec2=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]?(b$T.mainContext.uniform2i(b$M.location,b$i[0]=b$y[0],b$i[1]=b$y[1]),1):0},b$y._uniform_ivec2v=function(b$M,b$y){return b$T.mainContext.uniform2iv(b$M.location,b$y),1},b$y._uniform_vec3i=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]||b$i[2]!==b$y[2]?(b$T.mainContext.uniform3i(b$M.location,b$i[0]=b$y[0],b$i[1]=b$y[1],b$i[2]=b$y[2]),1):0},b$y._uniform_vec3vi=function(b$M,b$y){return b$T.mainContext.uniform3iv(b$M.location,b$y),1},b$y._uniform_vec4i=function(b$M,b$y){var b$i=b$M.uploadedValue;return b$i[0]!==b$y[0]||b$i[1]!==b$y[1]||b$i[2]!==b$y[2]||b$i[3]!==b$y[3]?(b$T.mainContext.uniform4i(b$M.location,b$i[0]=b$y[0],b$i[1]=b$y[1],b$i[2]=b$y[2],b$i[3]=b$y[3]),1):0},b$y._uniform_vec4vi=function(b$M,b$y){return b$T.mainContext.uniform4iv(b$M.location,b$y),1},b$y._uniform_sampler2D=function(b$M,b$y){var b$i=b$y.source||b$y.defaulteTexture.source,b$H=b$T.mainContext,b$S=b$M.uploadedValue;if(null!=b$S[0])return b$H.activeTexture(b$F._TEXTURES[b$S[0]]),b$i&&b$m.bindTexture(b$H,3553,b$i),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return b$S[0]=this._curActTexIndex,b$H.uniform1i(b$M.location,this._curActTexIndex),b$H.activeTexture(b$F._TEXTURES[this._curActTexIndex]),b$i&&b$m.bindTexture(b$H,3553,b$i),this._curActTexIndex++,1},b$y._uniform_samplerCube=function(b$M,b$y){var b$i=b$y.source||b$y.defaulteTexture.source,b$H=b$T.mainContext,b$S=b$M.uploadedValue;if(null!=b$S[0])return b$H.activeTexture(b$F._TEXTURES[b$S[0]]),b$i?b$m.bindTexture(b$H,34067,b$i):b$m.bindTexture(b$H,34067,SolidColorTextureCube.grayTexture.source),0;if(7<this._curActTexIndex)throw new Error("Shader3D: shader support textures max count is 8,can't large than it.");return b$S[0]=this._curActTexIndex,b$H.uniform1i(b$M.location,this._curActTexIndex),b$H.activeTexture(b$F._TEXTURES[this._curActTexIndex]),b$i?b$m.bindTexture(b$H,34067,b$i):b$m.bindTexture(b$H,34067,SolidColorTextureCube.grayTexture.source),this._curActTexIndex++,1},b$y._noSetValue=function(b$M){console.log("no....:"+b$M.name)},b$y.bind=function(){return b$i.activeShader=this,(b$i.bindShader=this).activeResource(),b$m.UseProgram(this._program)},b$y.uploadAttributes=function(b$M,b$y){for(var b$i,b$H,b$S=0,b$f=0,b$V=this._attributeParamsMap.length;b$f<b$V;b$f+=2)b$H=this._attributeParamsMap[b$f+1],null!=(b$i=b$M[this._attributeParamsMap[b$f]])&&(b$y&&b$y[b$H.name]&&b$y[b$H.name].bind(),b$S+=b$H.fun.call(this,b$H,b$i));b$Q.shaderCall+=b$S},b$y.uploadAttributesX=function(b$M,b$y){for(var b$i,b$H,b$S=0,b$f=0,b$V=this._attributeParamsMap.length;b$f<b$V;b$f+=2)b$H=this._attributeParamsMap[b$f+1],null!=(b$i=b$M[this._attributeParamsMap[b$f]])&&(b$y._bind(),b$S+=b$H.fun.call(this,b$H,b$i));b$Q.shaderCall+=b$S},b$y.uploadSceneUniforms=function(b$M){for(var b$y,b$i,b$H=0,b$S=0,b$f=this._sceneUniformParamsMap.length;b$S<b$f;b$S+=2)b$i=this._sceneUniformParamsMap[b$S+1],null!=(b$y=b$M[this._sceneUniformParamsMap[b$S]])&&(b$H+=b$i.fun.call(this,b$i,b$y));b$Q.shaderCall+=b$H},b$y.uploadCameraUniforms=function(b$M){for(var b$y,b$i,b$H=0,b$S=0,b$f=this._cameraUniformParamsMap.length;b$S<b$f;b$S+=2)b$i=this._cameraUniformParamsMap[b$S+1],null!=(b$y=b$M[this._cameraUniformParamsMap[b$S]])&&(b$H+=b$i.fun.call(this,b$i,b$y));b$Q.shaderCall+=b$H},b$y.uploadSpriteUniforms=function(b$M){for(var b$y,b$i,b$H=0,b$S=0,b$f=this._spriteUniformParamsMap.length;b$S<b$f;b$S+=2)b$i=this._spriteUniformParamsMap[b$S+1],null!=(b$y=b$M[this._spriteUniformParamsMap[b$S]])&&(b$H+=b$i.fun.call(this,b$i,b$y));b$Q.shaderCall+=b$H},b$y.uploadMaterialUniforms=function(b$M){for(var b$y,b$i,b$H=0,b$S=0,b$f=this._materialUniformParamsMap.length;b$S<b$f;b$S+=2)b$i=this._materialUniformParamsMap[b$S+1],null!=(b$y=b$M[this._materialUniformParamsMap[b$S]])&&(b$H+=b$i.fun.call(this,b$i,b$y));b$Q.shaderCall+=b$H},b$y.uploadRenderElementUniforms=function(b$M){for(var b$y,b$i,b$H=0,b$S=0,b$f=this._renderElementUniformParamsMap.length;b$S<b$f;b$S+=2)b$i=this._renderElementUniformParamsMap[b$S+1],null!=(b$y=b$M[this._renderElementUniformParamsMap[b$S]])&&(b$H+=b$i.fun.call(this,b$i,b$y));b$Q.shaderCall+=b$H},b$F.create=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){return new b$F(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X)},b$F.addInclude=function(b$M,b$y){b$R.addInclude(b$M,b$y)},b$F._createShader=function(b$M,b$y,b$i){var b$H=b$M.createShader(b$i);if(b$M.shaderSource(b$H,b$y),b$M.compileShader(b$H),b$Qy.debugMode&&!b$M.getShaderParameter(b$H,35713))throw b$M.getShaderInfoLog(b$H);return b$H},b$F.PERIOD_RENDERELEMENT=0,b$F.PERIOD_MATERIAL=1,b$F.PERIOD_SPRITE=2,b$F.PERIOD_CAMERA=3,b$F.PERIOD_SCENE=4,b$F._TEXTURES=[33984,33985,33986,33987,33988,33989,33990,33991],b$F._count=0,b$F._preCompile=!1,b$F.extCompileFunc=null,b$F.extCompileObj=null,b$o(b$F,["shaderParamsMap",function(){return this.shaderParamsMap={float:5126,int:5124,bool:35670,vec2:35664,vec3:35665,vec4:35666,ivec2:35667,ivec3:35668,ivec4:35669,bvec2:35671,bvec3:35672,bvec4:35673,mat2:35674,mat3:35675,mat4:35676,sampler2D:35678,samplerCube:35680}},"nameKey",function(){return this.nameKey=new b$W}]),b$F}(),b$qy=function(b$K){function b$k(){this._transformUV=null,b$k.__super.call(this),this.setShaderName("SIMPLE"),this._setColor(9,new b$Vy(.6,.6,.6)),this._setColor(10,new b$Vy(1,1,1)),this._setColor(11,new b$Ky(1,1,1,8)),this._setColor(12,new b$Vy(1,1,1)),this._setColor(7,new b$Ky(1,1,1,1)),this._setNumber(0,.5),this._setColor(15,new b$Ky(1,1,0,0)),this.renderMode=1}b$P(b$k,"laya.d3.core.material.StandardMaterial",b$K);var b$M=b$k.prototype;return b$M.disableLight=function(){this._addDisablePublicShaderDefine(b$Qy.SHADERDEFINE_POINTLIGHT|b$Qy.SHADERDEFINE_SPOTLIGHT|b$Qy.SHADERDEFINE_DIRECTIONLIGHT)},b$M.disableFog=function(){this._addDisablePublicShaderDefine(b$Qy.SHADERDEFINE_FOG)},b$M.onAsynLoaded=function(b$M,b$y,b$i){var b$H=b$y[0];if(b$H.version)b$K.prototype.onAsynLoaded.call(this,b$M,b$y,b$i);else{var b$S=b$y[1],b$f=b$H.props;for(var b$V in b$f)this[b$V]=b$f[b$V];b$k._parseStandardMaterial(b$S,this,b$H),this._endLoaded()}},b$M.cloneTo=function(b$M){b$K.prototype.cloneTo.call(this,b$M);var b$y=b$M;this._transformUV&&(b$y._transformUV=this._transformUV.clone())},b$l(0,b$M,"ambientColor",function(){return this._getColor(9)},function(b$M){this._setColor(9,b$M)}),b$l(0,b$M,"ambientTexture",function(){return this._getTexture(5)},function(b$M){b$M?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_AMBIENTMAP),this._setTexture(5,b$M)}),b$l(0,b$M,"renderMode",null,function(b$M){switch(b$M){case 1:this.renderQueue=2e3,this.depthWrite=!0,this.cull=2,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 2:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 3:this.depthWrite=!0,this.cull=2,this.blend=0,this.renderQueue=2e3,this.alphaTest=!0,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 4:this.renderQueue=2e3,this.depthWrite=!0,this.cull=0,this.blend=0,this.alphaTest=!0,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 13:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 14:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 15:this.renderQueue=3e3,this.depthWrite=!0,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 16:this.renderQueue=3e3,this.depthWrite=!0,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 5:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 6:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 7:this.renderQueue=3e3,this.depthWrite=!1,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 8:this.renderQueue=3e3,this.depthWrite=!1,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 9:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 10:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=771,this.alphaTest=!1,this._removeShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 11:this.renderQueue=3e3,this.depthTest=513,this.cull=2,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;case 12:this.renderQueue=3e3,this.depthTest=513,this.cull=0,this.blend=1,this.srcBlend=770,this.dstBlend=1,this.alphaTest=!1,this._addShaderDefine(b$k.SHADERDEFINE_ADDTIVEFOG);break;default:throw new Error("Material:renderMode value error.")}this._conchMaterial&&this._conchMaterial.setRenderMode(b$M)}),b$l(0,b$M,"reflectColor",function(){return this._getColor(12)},function(b$M){this._setColor(12,b$M)}),b$l(0,b$M,"tilingOffset",function(){return this._getColor(15)},function(b$M){if(b$M){var b$y=b$M.elements;1!=b$y[0]||1!=b$y[1]||0!=b$y[2]||0!=b$y[3]?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET)}else this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_TILINGOFFSET);this._setColor(15,b$M)}),b$l(0,b$M,"albedo",function(){return this._getColor(7)},function(b$M){this._setColor(7,b$M)}),b$l(0,b$M,"diffuseColor",function(){return this._getColor(10)},function(b$M){this._setColor(10,b$M)}),b$l(0,b$M,"albedoColor",function(){return this._getColor(7)},function(b$M){this._setColor(7,b$M)}),b$l(0,b$M,"specularColor",function(){return this._getColor(11)},function(b$M){this._setColor(11,b$M)}),b$l(0,b$M,"diffuseTexture",function(){return this._getTexture(1)},function(b$M){b$M?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_DIFFUSEMAP),this._setTexture(1,b$M)}),b$l(0,b$M,"normalTexture",function(){return this._getTexture(2)},function(b$M){b$M?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_NORMALMAP),this._setTexture(2,b$M)}),b$l(0,b$M,"specularTexture",function(){return this._getTexture(3)},function(b$M){b$M?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_SPECULARMAP),this._setTexture(3,b$M)}),b$l(0,b$M,"emissiveTexture",function(){return this._getTexture(4)},function(b$M){b$M?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_EMISSIVEMAP),this._setTexture(4,b$M)}),b$l(0,b$M,"reflectTexture",function(){return this._getTexture(6)},function(b$M){b$M?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_REFLECTMAP),this._setTexture(6,b$M)}),b$l(0,b$M,"transformUV",function(){return this._transformUV},function(b$M){this._transformUV=b$M,this._setMatrix4x4(13,b$M.matrix),b$M?this._addShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM):this._removeShaderDefine(laya.d3.core.material.StandardMaterial.SHADERDEFINE_UVTRANSFORM),this._conchMaterial&&this._conchMaterial.setShaderValue(13,b$M.matrix.elements,0)}),b$k.__init__=function(){b$k.SHADERDEFINE_DIFFUSEMAP=b$k.shaderDefines.registerDefine("DIFFUSEMAP"),b$k.SHADERDEFINE_NORMALMAP=b$k.shaderDefines.registerDefine("NORMALMAP"),b$k.SHADERDEFINE_SPECULARMAP=b$k.shaderDefines.registerDefine("SPECULARMAP"),b$k.SHADERDEFINE_EMISSIVEMAP=b$k.shaderDefines.registerDefine("EMISSIVEMAP"),b$k.SHADERDEFINE_AMBIENTMAP=b$k.shaderDefines.registerDefine("AMBIENTMAP"),b$k.SHADERDEFINE_REFLECTMAP=b$k.shaderDefines.registerDefine("REFLECTMAP"),b$k.SHADERDEFINE_UVTRANSFORM=b$k.shaderDefines.registerDefine("UVTRANSFORM"),b$k.SHADERDEFINE_TILINGOFFSET=b$k.shaderDefines.registerDefine("TILINGOFFSET"),b$k.SHADERDEFINE_ADDTIVEFOG=b$k.shaderDefines.registerDefine("ADDTIVEFOG")},b$k.load=function(b$M){return b$G.loader.create(b$M,null,null,b$k)},b$k._parseStandardMaterial=function(b$M,b$y,b$i){var b$H=b$i.customProps,b$S=b$H.ambientColor;b$y.ambientColor=new b$Vy(b$S[0],b$S[1],b$S[2]);var b$f=b$H.diffuseColor;b$y.diffuseColor=new b$Vy(b$f[0],b$f[1],b$f[2]);var b$V=b$H.specularColor;b$y.specularColor=new b$Ky(b$V[0],b$V[1],b$V[2],b$V[3]);var b$K=b$H.reflectColor;b$y.reflectColor=new b$Vy(b$K[0],b$K[1],b$K[2]);var b$k=b$H.albedoColor;b$k&&(b$y.albedo=new b$Ky(b$k[0],b$k[1],b$k[2],b$k[3]));var b$X=b$H.diffuseTexture.texture2D;b$X&&(b$y.diffuseTexture=b$C.getRes(b$M[b$X]));var b$F=b$H.normalTexture.texture2D;b$F&&(b$y.normalTexture=b$C.getRes(b$M[b$F]));var b$o=b$H.specularTexture.texture2D;b$o&&(b$y.specularTexture=b$C.getRes(b$M[b$o]));var b$d=b$H.emissiveTexture.texture2D;b$d&&(b$y.emissiveTexture=b$C.getRes(b$M[b$d]));var b$P=b$H.ambientTexture.texture2D;b$P&&(b$y.ambientTexture=b$C.getRes(b$M[b$P]));var b$l=b$H.reflectTexture.texture2D;b$l&&(b$y.reflectTexture=b$C.getRes(b$M[b$l]))},b$k.RENDERMODE_OPAQUE=1,b$k.RENDERMODE_OPAQUEDOUBLEFACE=2,b$k.RENDERMODE_CUTOUT=3,b$k.RENDERMODE_CUTOUTDOUBLEFACE=4,b$k.RENDERMODE_TRANSPARENT=13,b$k.RENDERMODE_TRANSPARENTDOUBLEFACE=14,b$k.RENDERMODE_ADDTIVE=15,b$k.RENDERMODE_ADDTIVEDOUBLEFACE=16,b$k.RENDERMODE_DEPTHREAD_TRANSPARENT=5,b$k.RENDERMODE_DEPTHREAD_TRANSPARENTDOUBLEFACE=6,b$k.RENDERMODE_DEPTHREAD_ADDTIVE=7,b$k.RENDERMODE_DEPTHREAD_ADDTIVEDOUBLEFACE=8,b$k.RENDERMODE_NONDEPTH_TRANSPARENT=9,b$k.RENDERMODE_NONDEPTH_TRANSPARENTDOUBLEFACE=10,b$k.RENDERMODE_NONDEPTH_ADDTIVE=11,b$k.RENDERMODE_NONDEPTH_ADDTIVEDOUBLEFACE=12,b$k.SHADERDEFINE_DIFFUSEMAP=0,b$k.SHADERDEFINE_NORMALMAP=0,b$k.SHADERDEFINE_SPECULARMAP=0,b$k.SHADERDEFINE_EMISSIVEMAP=0,b$k.SHADERDEFINE_AMBIENTMAP=0,b$k.SHADERDEFINE_REFLECTMAP=0,b$k.SHADERDEFINE_UVTRANSFORM=0,b$k.SHADERDEFINE_TILINGOFFSET=0,b$k.SHADERDEFINE_ADDTIVEFOG=0,b$k.DIFFUSETEXTURE=1,b$k.NORMALTEXTURE=2,b$k.SPECULARTEXTURE=3,b$k.EMISSIVETEXTURE=4,b$k.AMBIENTTEXTURE=5,b$k.REFLECTTEXTURE=6,b$k.ALBEDO=7,b$k.UVANIAGE=8,b$k.MATERIALAMBIENT=9,b$k.MATERIALDIFFUSE=10,b$k.MATERIALSPECULAR=11,b$k.MATERIALREFLECT=12,b$k.UVMATRIX=13,b$k.UVAGE=14,b$k.TILINGOFFSET=15,b$o(b$k,["defaultMaterial",function(){var b$M=new b$k;return b$M.lock=!0,this.defaultMaterial=b$M},"shaderDefines",function(){return this.shaderDefines=new b$Fy(b$ay.shaderDefines)}]),b$k}(b$ay),b$ty=function(b$M){function b$V(b$M,b$y,b$i,b$H,b$S){this._indexType=null,this._indexTypeByteCount=0,this._indexCount=0,this._canRead=!1,void 0===b$i&&(b$i=35044),void 0===b$H&&(b$H=!1),b$V.__super.call(this),this._indexType=b$M,this._indexCount=b$y,this._bufferUsage=b$i,this._bufferType=34963,this._canRead=b$H;var b$f;if("ushort"==b$M)this._indexTypeByteCount=2;else{if("ubyte"!=b$M)throw new Error("unidentification index type.");this._indexTypeByteCount=1}b$f=this._indexTypeByteCount*b$y,this._byteLength=b$f,this._bind(),b$K._gl.bufferData(this._bufferType,b$f,this._bufferUsage),this.uri=b$S,b$H?("ushort"==b$M?this._buffer=new Uint16Array(b$y):"ubyte"==b$M&&(this._buffer=new Uint8Array(b$y)),this.memorySize=2*b$f):this.memorySize=b$f}b$P(b$V,"laya.d3.graphics.IndexBuffer3D",b$M);var b$y=b$V.prototype;return b$y.setData=function(b$M,b$y,b$i,b$H){void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=4294967295);var b$S=0;if("ushort"==this._indexType?(b$S=2,0===b$i&&4294967295===b$H||(b$M=new Uint16Array(b$M.buffer,b$i*b$S,b$H))):"ubyte"==this._indexType&&(b$S=1,0===b$i&&4294967295===b$H||(b$M=new Uint8Array(b$M.buffer,b$i*b$S,b$H))),this._bind(),b$K._gl.bufferSubData(this._bufferType,b$y*b$S,b$M),this._canRead)if(0!==b$y||0!==b$i||4294967295!==b$H){var b$f=this._buffer.length-b$y;b$f<b$H&&(b$H=b$f);for(var b$V=0;b$V<b$H;b$V++)this._buffer[b$y+b$V]=b$M[b$V]}else this._buffer=b$M},b$y.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},b$y.disposeResource=function(){b$M.prototype.disposeResource.call(this),this._buffer=null,this.memorySize=0},b$l(0,b$y,"indexType",function(){return this._indexType}),b$l(0,b$y,"indexTypeByteCount",function(){return this._indexTypeByteCount}),b$l(0,b$y,"indexCount",function(){return this._indexCount}),b$l(0,b$y,"canRead",function(){return this._canRead}),b$V.INDEXTYPE_UBYTE="ubyte",b$V.INDEXTYPE_USHORT="ushort",b$V.create=function(b$M,b$y,b$i,b$H,b$S){return void 0===b$i&&(b$i=35044),void 0===b$H&&(b$H=!1),new b$V(b$M,b$y,b$i,b$H,b$S)},b$V}(b$K),b$uy=function(b$f){function b$V(b$M,b$y,b$i,b$H,b$S){this._vertexDeclaration=null,this._vertexCount=0,this._canRead=!1,void 0===b$H&&(b$H=!1),b$V.__super.call(this),this._vertexDeclaration=b$M,this._vertexCount=b$y,this._bufferUsage=b$i,this._bufferType=34962,this._canRead=b$H,this.uri=b$S,this.memorySize=this._byteLength=this._vertexDeclaration.vertexStride*b$y,this._bind(),b$K._gl.bufferData(this._bufferType,this._byteLength,this._bufferUsage),b$H&&(this._buffer=new Float32Array(this._byteLength/4))}b$P(b$V,"laya.d3.graphics.VertexBuffer3D",b$f);var b$M=b$V.prototype;return b$M.bindWithIndexBuffer=function(b$M){b$M&&b$M._bind(),this._bind()},b$M.setData=function(b$M,b$y,b$i,b$H){if(void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=4294967295),0===b$i&&4294967295===b$H||(b$M=new Float32Array(b$M.buffer,4*b$i,b$H)),this._bind(),b$K._gl.bufferSubData(this._bufferType,4*b$y,b$M),this._canRead)if(0!==b$y||0!==b$i||4294967295!==b$H){var b$S=this._buffer.length-b$y;b$S<b$H&&(b$H=b$S);for(var b$f=0;b$f<b$H;b$f++)this._buffer[b$y+b$f]=b$M[b$f]}else this._buffer=b$M},b$M.getData=function(){if(this._canRead)return this._buffer;throw new Error("Can't read data from VertexBuffer with only write flag!")},b$M.disposeResource=function(){for(var b$M=b$T.mainContext,b$y=this._vertexDeclaration.getVertexElements(),b$i=b$K._enableAtributes,b$H=0,b$S=b$y.length;b$H<b$S;b$H++)b$i[b$H]===this._glBuffer&&(b$M.disableVertexAttribArray(b$H),b$i[b$H]=null);b$f.prototype.disposeResource.call(this),this._buffer=null,this._vertexDeclaration=null,this.memorySize=0},b$l(0,b$M,"vertexDeclaration",function(){return this._vertexDeclaration}),b$l(0,b$M,"vertexCount",function(){return this._vertexCount}),b$l(0,b$M,"canRead",function(){return this._canRead}),b$V.create=function(b$M,b$y,b$i,b$H,b$S){return void 0===b$i&&(b$i=35044),void 0===b$H&&(b$H=!1),new b$V(b$M,b$y,b$i,b$H,b$S)},b$V}(b$K),b$py=function(b$M){function b$R(){this.simLodInfo=null,this._src=null,this._buffer=null,this._image=null,this._mipmaps=null,this._recreateLock=!1,this._needReleaseAgain=!1,b$R.__super.call(this),this._type=3553}b$P(b$R,"laya.d3.resource.DataTexture2D",b$Ty);var b$y=b$R.prototype;return b$y.genDebugMipmaps=function(){var b$M=[];return b$M.push(new Uint8Array(new Uint32Array(131072).fill(4278190335).buffer)),b$M.push(new Uint8Array(new Uint32Array(32768).fill(4278223103).buffer)),b$M.push(new Uint8Array(new Uint32Array(8192).fill(4278255615).buffer)),b$M.push(new Uint8Array(new Uint32Array(2048).fill(4278255360).buffer)),b$M.push(new Uint8Array(new Uint32Array(512).fill(4286595072).buffer)),b$M.push(new Uint8Array(new Uint32Array(128).fill(4294901760).buffer)),b$M.push(new Uint8Array(new Uint32Array(32).fill(4294901888).buffer)),b$M.push(new Uint8Array(new Uint32Array(8).fill(0).buffer)),b$M.push(new Uint8Array(new Uint32Array(2).fill(4286611584).buffer)),b$M.push(new Uint8Array(new Uint32Array(1).fill(4294967295).buffer)),b$M},b$y._onTextureLoaded=function(b$M){},b$y._createWebGlTexture=function(){if(!this._buffer&&!this._image&&!this._mipmaps)throw"create GLTextur err:no data";var b$M=b$T.mainContext,b$y=this._source=b$M.createTexture(),b$i=this._width,b$H=this._height,b$S=b$m.curBindTexTarget,b$f=b$m.curBindTexValue,b$V=!1;if(b$m.bindTexture(b$M,this._type,b$y),this._mipmaps){if(laya.d3.resource.DataTexture2D.lodasatlas){var b$K=0;b$M.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null);for(var b$k=0;b$k<this._mipmaps.length;b$k++){if(this._mipmaps[b$k].byteLength!=b$X*b$F*4)throw"mipmap size error  level:"+b$k;b$M.texSubImage2D(this._type,0,b$R.simLodRect[b$K++],b$R.simLodRect[b$K++],b$R.simLodRect[b$K++],b$R.simLodRect[b$K++],6408,5121,new Uint8Array(this._mipmaps[b$k]))}this.minFifter=9729,this.magFifter=9729}else{var b$X=this._width,b$F=this._height;for(b$K=0,b$M.texImage2D(this._type,0,6408,this._width,this._height,0,6408,5121,null),b$k=0;b$k<this._mipmaps.length;b$k++){if(this._mipmaps[b$k].byteLength!=b$X*b$F*4)throw"mipmap size error  level:"+b$k;b$M.texImage2D(this._type,b$k,6408,b$X,b$F,0,6408,5121,new Uint8Array(this._mipmaps[b$k])),(b$X/=2)<1&&(b$X=1),(b$F/=2)<1&&(b$F=1),this.minFifter=9987,this.magFifter=9729}}this.mipmap=!1}else if(this._image)6407==this._format&&b$M.pixelStorei(b$M.UNPACK_ALIGNMENT,1),b$M.texImage2D(this._type,0,this._format,this._format,5121,this._image);else if(this._buffer){var b$o=0,b$d=!1,b$P=!1;this._buffer.byteLength==4*b$i*b$H?(b$o=6408,b$d=!0):this._buffer.byteLength==3*b$i*b$H?(b$o=6407,b$P=!0):b$o=this._format,b$d||b$P?(this._buffer instanceof Uint8Array||(this._buffer=new Uint8Array(this._buffer)),b$P&&b$M.pixelStorei(b$M.UNPACK_ALIGNMENT,1),b$M.texImage2D(this._type,0,b$o,b$i,b$H,0,b$o,5121,this._buffer)):b$M&&b$o==b$M.ALPHA?(b$M.texImage2D(3553,0,b$o,b$i,b$H,0,b$o,b$M.UNSIGNED_BYTE,this._buffer),b$V=!0):0!=b$o&&(b$M.compressedTexImage2D(3553,0,b$o,b$i,b$H,0,this._buffer),b$V=!0)}var b$l=this._minFifter,b$J=this._magFifter,b$h=0==this._wrapModeU?10497:33071,b$C=0==this._wrapModeV?10497:33071,b$v=b$A.isPOT(b$i,b$H);b$v?(this._mipmap||this._mipmaps?-1!==b$l||(b$l=9987):-1!==b$l||(b$l=9729),-1!==b$J||(b$J=9729),b$M.texParameteri(this._type,10241,b$l),b$M.texParameteri(this._type,10240,b$J),b$M.texParameteri(this._type,10242,b$h),b$M.texParameteri(this._type,10243,b$C),this._mipmap&&b$M.generateMipmap(this._type)):(-1!==b$l||(b$l=9729),-1!==b$J||(b$J=9729),b$M.texParameteri(this._type,10241,b$l),b$M.texParameteri(this._type,10240,b$J),b$M.texParameteri(this._type,10242,33071),b$M.texParameteri(this._type,10243,33071)),b$S&&b$f&&b$m.bindTexture(b$M,b$S,b$f),this.memorySize=b$V?this._buffer.length:b$v?b$i*b$H*4*(1+1/3):b$i*b$H*4,this.src&&0<this.src.length&&(this._buffer=null,this._image=null),this._recreateLock=!1},b$y.recreateResource=function(){if(this._buffer||this._image||null!=this._src&&""!==this._src)if(this._needReleaseAgain=!1,this._buffer||this._image||this._mipmaps){if(this._recreateLock)return;this._createWebGlTexture(),this.completeCreate()}else{this._recreateLock=!0}},b$y.onAsynLoaded=function(b$M,b$y,b$i){var b$H;b$i&&(b$H=b$i[0].call(this,b$y)),b$H&&(this._width=b$H.width,this._height=b$H.height,this._buffer=b$H.data),this._src=b$M,this._size=new b$Jy(this._width,this._height),this._conchTexture?alert("怎么给runtime传递datatexture数据"):this.activeResource(),this._endLoaded()},b$y.getPixels=function(){return new Uint8Array(this._buffer)},b$y.disposeResource=function(){this._recreateLock&&(this._needReleaseAgain=!0),this._source&&(b$T.mainContext.deleteTexture(this._source),this._source=null,this._buffer=null,this._image=null,this.memorySize=0)},b$l(0,b$y,"src",function(){return this._src}),b$R.create=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){if(void 0===b$H&&(b$H=9729),void 0===b$S&&(b$S=9729),void 0===b$f&&(b$f=!0),!b$M||b$M.byteLength<b$y*b$i*4)throw"DataTexture2D create error";var b$K=new b$R;return b$K.uri=b$V,b$K._buffer=b$M,b$K._width=b$y,b$K._height=b$i,b$K._mipmap=b$f,b$K._magFifter=b$H,b$K._minFifter=b$S,b$K._size=new b$Jy(b$K._width,b$K._height),b$K._conchTexture?alert("怎么给runtime传递datatexture数据"):b$K.activeResource(),b$K},b$R.load=function(b$M,b$y,b$i,b$H,b$S){if(void 0===b$y&&(b$y=0),void 0===b$i&&(b$i=0),void 0===b$H&&(b$H=9729),void 0===b$S&&(b$S=9729),"mipmaps"===b$c.getFileExtension(b$M)){var b$f=b$G.loader.create(b$M,null,null,b$R,[function(b$M){this._mipmaps=[];var b$y=new Uint32Array(b$M);this._width=b$y[0];var b$i=512;if(laya.d3.resource.DataTexture2D.lodasatlas&&(this._width*=2,b$i=1024),this._width!=b$i)throw"现在只支持512x256的环境贴图。当前的是"+b$y[0];this._height=b$y[1];for(var b$H=laya.d3.resource.DataTexture2D.lodasatlas?this._width/2:this._width,b$S=this._height,b$f=8;;){var b$V=b$H*b$S*4;if(b$f+b$V>b$M.byteLength)throw"load mipmaps data size error ";var b$K=new Uint8Array(b$M,b$f,b$V);if(this._mipmaps.push(b$K),b$f+=b$V,1==b$H&&1==b$S)break;(b$H/=2)<1&&(b$H=1),(b$S/=2)<1&&(b$S=1)}return null}]);if(laya.d3.resource.DataTexture2D.lodasatlas){b$f.simLodInfo=new Float32Array(40);for(var b$V=0;b$V<b$f.simLodInfo.length;)b$f.simLodInfo[b$V]=(b$R.simLodRect[b$V]+.5)/1024,b$V++,b$f.simLodInfo[b$V]=(b$R.simLodRect[b$V]+.5)/256,b$V++,b$f.simLodInfo[b$V]=Math.max(b$R.simLodRect[b$V]-1,.1)/1024,b$V++,b$f.simLodInfo[b$V]=Math.max(b$R.simLodRect[b$V]-1.5,.1)/256,b$V++}return b$f}if("number"==typeof b$y)return b$G.loader.create(b$M,null,null,b$R,[function(b$M){return this._width=b$y,this._height=b$i,this._buffer=b$M,null}]);if("function"==typeof b$y)return b$G.loader.create(b$M,null,null,b$R,[b$y]);throw new Error("unknown params.")},b$R.lodasatlas=!1,b$o(b$R,["simLodRect",function(){return this.simLodRect=new Uint32Array([0,0,512,256,512,0,256,128,768,0,128,64,896,0,64,32,960,0,32,16,992,0,16,8,1008,0,8,4,1016,0,4,2,1020,0,2,1,1022,0,1,1])}]),b$R}(),b$By=function(b$M){function b$y(){this._numberVertices=0,this._numberIndices=0,this._vertexBuffer=null,this._indexBuffer=null,b$y.__super.call(this)}b$P(b$y,"laya.d3.resource.models.PrimitiveMesh",b$my);var b$i=b$y.prototype;return b$G.imps(b$i,{"laya.d3.core.render.IRenderable":!0}),b$i._getVertexBuffer=function(b$M){return void 0===b$M&&(b$M=0),0===b$M?this._vertexBuffer:null},b$i._getVertexBuffers=function(){return null},b$i._getIndexBuffer=function(){return this._indexBuffer},b$i._getPositions=function(){var b$M,b$y=[],b$i=this._vertexBuffer.vertexDeclaration.getVertexElements(),b$H=0;for(b$H=0;b$H<b$i.length;b$H++){var b$S=b$i[b$H];if("vector3"===b$S.elementFormat&&0===b$S.elementUsage){b$M=b$S;break}}var b$f=this._vertexBuffer.getData();for(b$H=0;b$H<b$f.length;b$H+=this._vertexBuffer.vertexDeclaration.vertexStride/4){var b$V=b$H+b$M.offset/4,b$K=new b$Vy(b$f[b$V+0],b$f[b$V+1],b$f[b$V+2]);b$y.push(b$K)}return b$y},b$i.getRenderElement=function(b$M){return this},b$i.getRenderElementsCount=function(){return 1},b$i.disposeResource=function(){this._vertexBuffer&&(this._vertexBuffer._removeReference(),this._vertexBuffer=null),this._indexBuffer&&(this._indexBuffer._removeReference(),this._indexBuffer=null),this.memorySize=0},b$i._beforeRender=function(b$M){return this._vertexBuffer._bind(),this._indexBuffer._bind(),!0},b$i._render=function(b$M){b$T.mainContext.drawElements(4,this._numberIndices,5123,0),b$Q.drawCall++,b$Q.trianglesFaces+=this._numberIndices/3},b$l(0,b$i,"_vertexBufferCount",function(){return 1}),b$l(0,b$i,"triangleCount",function(){return this._indexBuffer.indexCount/3}),b$y}(),b$Zy=function(b$M){function b$y(){this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null,this._skinnedDatas=null,b$y.__super.call(this),this._subMeshes=[],this._materials=[],this._vertexBuffers=[]}b$P(b$y,"laya.d3.resource.models.Mesh",b$my);var b$i=b$y.prototype;return b$i._getPositions=function(){var b$M,b$y,b$i,b$H,b$S,b$f=[],b$V=0,b$K=0,b$k=0;if(0!==this._vertexBuffers.length){var b$X=this._vertexBuffers.length;for(b$V=0;b$V<b$X;b$V++){for(b$i=(b$M=this._vertexBuffers[b$V]).vertexDeclaration.getVertexElements(),b$K=0;b$K<b$i.length;b$K++)if("vector3"===(b$H=b$i[b$K]).elementFormat&&0===b$H.elementUsage){b$y=b$H;break}for(b$S=b$M.getData(),b$K=0;b$K<b$S.length;b$K+=b$M.vertexDeclaration.vertexStride/4)b$k=b$K+b$y.offset/4,b$f.push(new b$Vy(b$S[b$k+0],b$S[b$k+1],b$S[b$k+2]))}}else{var b$F=this._subMeshes.length;for(b$V=0;b$V<b$F;b$V++){for(b$i=(b$M=this._subMeshes[b$V]._getVertexBuffer()).vertexDeclaration.getVertexElements(),b$K=0;b$K<b$i.length;b$K++)if("vector3"===(b$H=b$i[b$K]).elementFormat&&0===b$H.elementUsage){b$y=b$H;break}for(b$S=b$M.getData(),b$K=0;b$K<b$S.length;b$K+=b$M.vertexDeclaration.vertexStride/4)b$k=b$K+b$y.offset/4,b$f.push(new b$Vy(b$S[b$k+0],b$S[b$k+1],b$S[b$k+2]))}}return b$f},b$i._setSubMeshes=function(b$M){this._subMeshes=b$M,this._subMeshCount=b$M.length;for(var b$y=0;b$y<this._subMeshCount;b$y++)b$M[b$y]._indexInMesh=b$y;this._positions=this._getPositions(),this._generateBoundingObject()},b$i.onAsynLoaded=function(b$M,b$y,b$i){var b$H=b$y[0],b$S=b$y[1];b$$M.read(b$H,this,this._materials,this._subMeshes,b$S),this.completeCreate(),this._endLoaded()},b$i.getSubMesh=function(b$M){return this._subMeshes[b$M]},b$i.getSubMeshCount=function(){return this._subMeshes.length},b$i.getRenderElementsCount=function(){return this._subMeshes.length},b$i.getRenderElement=function(b$M){return this._subMeshes[b$M]},b$i.disposeResource=function(){for(var b$M=0;b$M<this._subMeshes.length;b$M++)this._subMeshes[b$M].dispose();this._materials=null,this._subMeshes=null,this._vertexBuffers=null,this._indexBuffer=null,this._boneNames=null,this._inverseBindPoses=null},b$l(0,b$i,"materials",function(){return this._materials.slice()}),b$l(0,b$i,"InverseAbsoluteBindPoses",function(){return this._inverseBindPoses}),b$y.load=function(b$M){return b$G.loader.create(b$M,null,null,b$y)},b$y}(),b$Ey=(function(b$M){function b$X(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k){this._alreadyResolved=!1,this._surfaceFormat=0,this._surfaceType=0,this._depthStencilFormat=0,this._frameBuffer=null,this._depthStencilBuffer=null,void 0===b$i&&(b$i=6408),void 0===b$H&&(b$H=5121),void 0===b$S&&(b$S=33189),void 0===b$f&&(b$f=!1),void 0===b$V&&(b$V=!1),void 0===b$K&&(b$K=-1),void 0===b$k&&(b$k=-1),b$X.__super.call(this),this._type=3553,this._width=b$M,this._height=b$y,this._size=new b$Jy(b$M,b$y),this._surfaceFormat=b$i,this._surfaceType=b$H,this._depthStencilFormat=b$S,b$J.isConchWebGL&&34041===this._depthStencilFormat&&(this._depthStencilFormat=33189),this._mipmap=b$f,this._repeat=b$V,this._minFifter=b$K,this._magFifter=b$k,this.activeResource(),this._alreadyResolved=!0}b$P(b$X,"laya.d3.resource.RenderTexture",b$Ty);var b$y=b$X.prototype;b$y.recreateResource=function(){var b$M=b$T.mainContext;this._frameBuffer=b$M.createFramebuffer(),this._source=b$M.createTexture();var b$y=b$m.curBindTexTarget,b$i=b$m.curBindTexValue;b$m.bindTexture(b$M,this._type,this._source),b$M.texImage2D(this._type,0,6408,this._width,this._height,0,this._surfaceFormat,this._surfaceType,null);var b$H=this._minFifter,b$S=this._magFifter,b$f=this._repeat?10497:33071;if(b$A.isPOT(this._width,this._height)?(this._mipmap?-1!==b$H||(b$H=9987):-1!==b$H||(b$H=9729),-1!==b$S||(b$S=9729),b$M.texParameteri(this._type,10241,b$H),b$M.texParameteri(this._type,10240,b$S),b$M.texParameteri(this._type,10242,b$f),b$M.texParameteri(this._type,10243,b$f),this._mipmap&&b$M.generateMipmap(this._type)):(-1!==b$H||(b$H=9729),-1!==b$S||(b$S=9729),b$M.texParameteri(this._type,10241,b$H),b$M.texParameteri(this._type,10240,b$S),b$M.texParameteri(this._type,10242,33071),b$M.texParameteri(this._type,10243,33071)),b$y&&b$i&&b$m.bindTexture(b$M,b$y,b$i),b$M.bindFramebuffer(36160,this._frameBuffer),this._depthStencilFormat)switch(this._depthStencilBuffer=b$M.createRenderbuffer(),b$M.bindRenderbuffer(36161,this._depthStencilBuffer),b$M.renderbufferStorage(36161,this._depthStencilFormat,this._width,this._height),b$M.bindRenderbuffer(36161,null),this._depthStencilFormat){case 33189:b$M.framebufferRenderbuffer(36160,36096,36161,this._depthStencilBuffer);break;case 36168:b$M.framebufferRenderbuffer(36160,36128,36161,this._depthStencilBuffer);break;case 34041:b$M.framebufferRenderbuffer(36160,33306,36161,this._depthStencilBuffer)}b$M.framebufferTexture2D(36160,36064,3553,this._source,0),b$M.bindFramebuffer(36160,null),this.memorySize=this._width*this._height*4,this.completeCreate()},b$y.start=function(){b$T.mainContext.bindFramebuffer(36160,this.frameBuffer),(b$X._currentRenderTarget=this)._alreadyResolved=!1},b$y.end=function(){b$T.mainContext.bindFramebuffer(36160,null),b$X._currentRenderTarget=null,this._alreadyResolved=!0},b$y.getData=function(b$M,b$y,b$i,b$H){var b$S=b$T.mainContext;if(b$S.bindFramebuffer(36160,this._frameBuffer),!(36053===b$S.checkFramebufferStatus(36160)))return b$S.bindFramebuffer(36160,null),null;var b$f=new Uint8Array(this._width*this._height*4);return b$S.readPixels(b$M,b$y,b$i,b$H,this._surfaceFormat,this._surfaceType,b$f),b$S.bindFramebuffer(36160,null),b$f},b$y.disposeResource=function(){if(this._frameBuffer){var b$M=b$T.mainContext;b$M.deleteTexture(this._source),b$M.deleteFramebuffer(this._frameBuffer),b$M.deleteRenderbuffer(this._depthStencilBuffer),this._source=null,this._frameBuffer=null,this._depthStencilBuffer=null,this.memorySize=0}},b$l(0,b$y,"surfaceFormat",function(){return this._surfaceFormat}),b$l(0,b$y,"surfaceType",function(){return this._surfaceType}),b$l(0,b$y,"depthStencilFormat",function(){return this._depthStencilFormat}),b$l(0,b$y,"source",function(){return this._alreadyResolved?b$G.superGet(b$Ty,this,"source"):null}),b$l(0,b$y,"depthStencilBuffer",function(){return this._depthStencilBuffer}),b$l(0,b$y,"frameBuffer",function(){return this._frameBuffer}),b$X._currentRenderTarget=null}(),function(b$M){function b$y(b$M){this._color=null,this._pixels=null,b$y.__super.call(this),this._type=3553,this._width=1,this._height=1,this._size=new b$Jy(this.width,this.height),this._color=b$M,this._pixels=new Uint8Array([255*b$M.x,255*b$M.y,255*b$M.z,255*b$M.w]),this.uri="SolidColorTexture2D_"+this.id}b$P(b$y,"laya.d3.resource.SolidColorTexture2D",b$Ty);var b$i=b$y.prototype;return b$i._createWebGlTexture=function(){var b$M=b$T.mainContext,b$y=this._source=b$M.createTexture(),b$i=this._width,b$H=this._height,b$S=b$m.curBindTexTarget,b$f=b$m.curBindTexValue;b$m.bindTexture(b$M,this._type,b$y),b$M.texImage2D(this._type,0,6408,b$i,b$H,0,6408,5121,this._pixels);var b$V=this._minFifter,b$K=this._magFifter,b$k=this._repeat?10497:33071,b$X=b$A.isPOT(b$i,b$H);b$X?(this._mipmap?-1!==b$V||(b$V=9987):-1!==b$V||(b$V=9729),-1!==b$K||(b$K=9729),b$M.texParameteri(this._type,10241,b$V),b$M.texParameteri(this._type,10240,b$K),b$M.texParameteri(this._type,10242,b$k),b$M.texParameteri(this._type,10243,b$k),this._mipmap&&b$M.generateMipmap(this._type)):(-1!==b$V||(b$V=9729),-1!==b$K||(b$K=9729),b$M.texParameteri(this._type,10241,b$V),b$M.texParameteri(this._type,10240,b$K),b$M.texParameteri(this._type,10242,33071),b$M.texParameteri(this._type,10243,33071)),b$S&&b$f&&b$m.bindTexture(b$M,b$S,b$f),this.memorySize=b$X?b$i*b$H*4*(1+1/3):b$i*b$H*4},b$i.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},b$i.disposeResource=function(){this._source&&(b$T.mainContext.deleteTexture(this._source),this._source=null,this.memorySize=0)},b$o(b$y,["magentaTexture",function(){var b$M=new b$y(new b$Ky(1,0,1,1));return b$M.lock=!0,this.magentaTexture=b$M},"grayTexture",function(){var b$M=new b$y(new b$Ky(.5,.5,.5,1));return b$M.lock=!0,this.grayTexture=b$M}]),b$y}()),b$_y=function(b$M){function b$S(b$M,b$y,b$i,b$H){this._canRead=!1,this._image=null,this._pixels=null,void 0===b$M&&(b$M=!1),void 0===b$y&&(b$y=!0),void 0===b$i&&(b$i=6408),void 0===b$H&&(b$H=!0),b$S.__super.call(this),this._type=3553,this._repeat=b$y,this._canRead=b$M,this._format=b$i,this._mipmap=b$H}b$P(b$S,"laya.d3.resource.Texture2D",b$Ty);var b$y=b$S.prototype;return b$y._createWebGlTexture=function(){if(!this._image)throw"create GLTextur err:no data:"+this._image;var b$M=b$T.mainContext,b$y=this._source=b$M.createTexture(),b$i=this._width,b$H=this._height,b$S=b$m.curBindTexTarget,b$f=b$m.curBindTexValue;switch(b$m.bindTexture(b$M,this._type,b$y),this._format){case 6407:case 6408:this._canRead?b$M.texImage2D(this._type,0,this._format,b$i,b$H,0,this._format,5121,this._pixels):this._image instanceof laya.webgl.resource.WebGLImage?b$M.texImage2D(this._type,0,this._image._format,b$i,b$H,0,this._image._format,5121,this._image.atlasSource):b$M.texImage2D(this._type,0,this._format,this._format,5121,this._image);break;case b$T.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:b$M.compressedTexImage2D(this._type,0,this._format,this._width,this._height,0,this._image);break;default:console.error("收到其他的纹理类型：",this._format)}var b$V=this._minFifter,b$K=this._magFifter,b$k=this._repeat?10497:33071,b$X=0==this._wrapModeU?10497:33071,b$F=0==this._wrapModeV?10497:33071,b$o=b$A.isPOT(b$i,b$H);b$o?(this._mipmap?-1!==b$V||(b$V=9987):-1!==b$V||(b$V=9729),-1!==b$K||(b$K=9729),b$M.texParameteri(this._type,10241,b$V),b$M.texParameteri(this._type,10240,b$K),b$M.texParameteri(this._type,10242,b$k),b$M.texParameteri(this._type,10243,b$k),b$M.texParameteri(this._type,10242,b$X),b$M.texParameteri(this._type,10243,b$F),this._mipmap&&b$M.generateMipmap(this._type)):(-1!==b$V||(b$V=9729),-1!==b$K||(b$K=9729),b$M.texParameteri(this._type,10241,b$V),b$M.texParameteri(this._type,10240,b$K),b$M.texParameteri(this._type,10242,33071),b$M.texParameteri(this._type,10243,33071)),b$S&&b$f&&b$m.bindTexture(b$M,b$S,b$f),this._image.onload=null,this._image=null,this.memorySize=b$o?b$i*b$H*4*(1+1/3):b$i*b$H*4},b$y.recreateResource=function(){this._createWebGlTexture(),this.completeCreate()},b$y.onAsynLoaded=function(b$M,b$y,b$i){if(b$i){var b$H=b$i[0];void 0!==b$H&&(this._canRead=b$H);var b$S=b$i[1];void 0!==b$S&&(this._repeat=b$S);var b$f=b$i[2];void 0!==b$f&&(this._format=b$f);var b$V=b$i[3];void 0!==b$V&&(this._mipmap=b$V);var b$K=b$i.wrapModeU;void 0!==b$K&&(this._wrapModeU=b$K);var b$k=b$i.wrapModeV;void 0!==b$k&&(this._wrapModeV=b$k)}switch(this._format){case 6407:case 6408:var b$X=(this._image=b$y).width,b$F=b$y.height;this._width=b$X,this._height=b$F,this._size=new b$Jy(b$X,b$F),this._canRead&&(b$J.isConchApp?b$y instanceof b$d.HTMLElement&&(this._pixels=new Uint8Array(b$y.getImageData(0,0,b$X,b$F))):(b$e.canvas.size(b$X,b$F),b$e.canvas.clear(),b$e.context.drawImage(b$y,0,0,b$X,b$F),this._pixels=new Uint8Array(b$e.context.getImageData(0,0,b$X,b$F).data.buffer)));break;case b$T.compressEtc1.COMPRESSED_RGB_ETC1_WEBGL:var b$o=new b$I(b$y);b$o.readUTFBytes(4),b$o.readUTFBytes(2),b$o.getInt16();b$o.endian="bigEndian",this._width=b$o.getInt16(),this._height=b$o.getInt16(),this._size=new b$Jy(this._width,this._height);b$o.getInt16(),b$o.getInt16();this._image=new Uint8Array(b$y,b$o.pos)}this.recreateResource(),this._endLoaded()},b$y.getPixels=function(){if(this._canRead)return this._pixels;throw new Error("Texture2D: must set texture canRead is true.")},b$y.disposeResource=function(){this._source&&(b$T.mainContext.deleteTexture(this._source),this._source=null,this._image=null,this.memorySize=0)},b$l(0,b$y,"_src",function(){return this.url}),b$l(0,b$y,"src",function(){return this.url}),b$S.load=function(b$M){return b$G.loader.create(b$M,null,null,b$S)},b$S}(),b$by=function(b$y){function b$i(b$M,b$y){b$i.__super.call(this),void 0===b$M&&(b$M=.3),void 0===b$y&&(b$y=1e3),this._tempVector3=new b$Vy,this._position=new b$Vy,this._up=new b$Vy,this._forward=new b$Vy,this._right=new b$Vy,this._fieldOfView=60,this._useUserProjectionMatrix=!1,this._orthographic=!1,this._viewportExpressedInClipSpace=!0,this._renderTargetSize=b$Jy.fullScreen,this._orthographicVerticalSize=10,this.renderingOrder=0,this._nearPlane=b$M,this._farPlane=b$y,this.cullingMask=2147483647,this.clearFlag=0,this.useOcclusionCulling=!0,this._calculateProjectionMatrix(),b$G.stage.on("resize",this,this._onScreenSizeChanged)}b$P(b$i,"laya.d3.core.BaseCamera",b$y);var b$M=b$i.prototype;return b$M._sortCamerasByRenderingOrder=function(){if(this._displayedInStage)for(var b$M=this.scene._cameraPool,b$y=b$M.length-1,b$i=0;b$i<b$y;b$i++)if(b$M[b$i].renderingOrder>b$M[b$y].renderingOrder){var b$H=b$M[b$i];b$M[b$i]=b$M[b$y],b$M[b$y]=b$H}},b$M._calculateProjectionMatrix=function(){},b$M._onScreenSizeChanged=function(){this._calculateProjectionMatrix()},b$M._prepareCameraToRender=function(){b$s._currentCameraCullingMask=this.cullingMask;var b$M=this._shaderValues;b$M.setValue(0,this.transform.position.elements),b$M.setValue(5,this.forward.elements),b$M.setValue(6,this.up.elements)},b$M._prepareCameraViewProject=function(b$M,b$y){var b$i=this._shaderValues;b$i.setValue(1,b$M.elements),b$i.setValue(2,b$y.elements)},b$M._renderCamera=function(b$M,b$y,b$i){},b$M.addLayer=function(b$M){29!==b$M.number&&30!=b$M.number&&(this.cullingMask=this.cullingMask|b$M.mask)},b$M.removeLayer=function(b$M){29!==b$M.number&&30!=b$M.number&&(this.cullingMask=this.cullingMask&~b$M.mask)},b$M.addAllLayers=function(){this.cullingMask=2147483647},b$M.removeAllLayers=function(){this.cullingMask=0|b$s.getLayerByNumber(29).mask|b$s.getLayerByNumber(30).mask},b$M.ResetProjectionMatrix=function(){this._useUserProjectionMatrix=!1,this._calculateProjectionMatrix()},b$M.moveForward=function(b$M){this._tempVector3.elements[0]=this._tempVector3.elements[1]=0,this._tempVector3.elements[2]=b$M,this.transform.translate(this._tempVector3)},b$M.moveRight=function(b$M){this._tempVector3.elements[1]=this._tempVector3.elements[2]=0,this._tempVector3.elements[0]=b$M,this.transform.translate(this._tempVector3)},b$M.moveVertical=function(b$M){this._tempVector3.elements[0]=this._tempVector3.elements[2]=0,this._tempVector3.elements[1]=b$M,this.transform.translate(this._tempVector3,!1)},b$M._addSelfRenderObjects=function(){var b$M=this.scene._cameraPool,b$y=b$M.length;if(0<b$y){for(var b$i=b$y-1;0<=b$i;b$i--)if(this.renderingOrder<=b$M[b$i].renderingOrder){b$M.splice(b$i+1,0,this);break}}else b$M.push(this),this.scene.conchModel&&this.scene.conchModel.setCurrentCamera(this.conchModel)},b$M._clearSelfRenderObjects=function(){var b$M=this.scene._cameraPool;b$M.splice(b$M.indexOf(this),1)},b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),this._sky&&this._sky.destroy(),this.renderTarget=null,b$G.stage.off("resize",this,this._onScreenSizeChanged),b$y.prototype.destroy.call(this,b$M)},b$l(0,b$M,"sky",function(){return this._sky},function(b$M){(this._sky=b$M)._ownerCamera=this}),b$l(0,b$M,"forward",function(){var b$M=this.transform.worldMatrix.elements,b$y=this._forward.elements;return b$y[0]=-b$M[8],b$y[1]=-b$M[9],b$y[2]=-b$M[10],this._forward}),b$l(0,b$M,"position",function(){var b$M=this.transform.worldMatrix.elements,b$y=this._position.elements;return b$y[0]=b$M[12],b$y[1]=b$M[13],b$y[2]=b$M[14],this._position}),b$l(0,b$M,"renderTarget",function(){return this._renderTarget},function(b$M){null!=(this._renderTarget=b$M)&&(this._renderTargetSize=b$M.size)}),b$l(0,b$M,"up",function(){var b$M=this.transform.worldMatrix.elements,b$y=this._up.elements;return b$y[0]=b$M[4],b$y[1]=b$M[5],b$y[2]=b$M[6],this._up}),b$l(0,b$M,"right",function(){var b$M=this.transform.worldMatrix.elements,b$y=this._right.elements;return b$y[0]=b$M[0],b$y[1]=b$M[1],b$y[2]=b$M[2],this._right}),b$l(0,b$M,"renderTargetSize",function(){return this._renderTargetSize},function(b$M){null!=this.renderTarget&&this._renderTargetSize,this._renderTargetSize=b$M,this._calculateProjectionMatrix()}),b$l(0,b$M,"fieldOfView",function(){return this._fieldOfView},function(b$M){this._fieldOfView=b$M,this._calculateProjectionMatrix()}),b$l(0,b$M,"nearPlane",function(){return this._nearPlane},function(b$M){this._nearPlane=b$M,this._calculateProjectionMatrix()}),b$l(0,b$M,"farPlane",function(){return this._farPlane},function(b$M){this._farPlane=b$M,this._calculateProjectionMatrix()}),b$l(0,b$M,"orthographic",function(){return this._orthographic},function(b$M){this._orthographic=b$M,this._calculateProjectionMatrix()}),b$l(0,b$M,"orthographicVerticalSize",function(){return this._orthographicVerticalSize},function(b$M){this._orthographicVerticalSize=b$M,this._calculateProjectionMatrix()}),b$l(0,b$M,"renderingOrder",function(){return this._renderingOrder},function(b$M){this._renderingOrder=b$M,this._sortCamerasByRenderingOrder()}),b$i.CAMERAPOS=0,b$i.VIEWMATRIX=1,b$i.PROJECTMATRIX=2,b$i.VPMATRIX=3,b$i.VPMATRIX_NO_TRANSLATE=4,b$i.CAMERADIRECTION=5,b$i.CAMERAUP=6,b$i.ENVIRONMENTDIFFUSE=7,b$i.ENVIRONMENTSPECULAR=8,b$i.SIMLODINFO=9,b$i.DIFFUSEIRRADMATR=10,b$i.DIFFUSEIRRADMATG=11,b$i.DIFFUSEIRRADMATB=12,b$i.HDREXPOSURE=13,b$i.RENDERINGTYPE_DEFERREDLIGHTING="DEFERREDLIGHTING",b$i.RENDERINGTYPE_FORWARDRENDERING="FORWARDRENDERING",b$i.CLEARFLAG_SOLIDCOLOR=0,b$i.CLEARFLAG_SKY=1,b$i.CLEARFLAG_DEPTHONLY=2,b$i.CLEARFLAG_NONE=3,b$o(b$i,["_invertYScaleMatrix",function(){return this._invertYScaleMatrix=new b$My(1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1)},"_invertYProjectionMatrix",function(){return this._invertYProjectionMatrix=new b$My},"_invertYProjectionViewMatrix",function(){return this._invertYProjectionViewMatrix=new b$My}]),b$i}(b$zy),b$Yy=function(b$i){function b$y(b$M){this._render=null,this._geometryFilter=null,b$y.__super.call(this,b$M)}b$P(b$y,"laya.d3.core.RenderableSprite3D",b$i);var b$M=b$y.prototype;return b$M._addToInitStaticBatchManager=function(){},b$M._setBelongScene=function(b$M){b$i.prototype._setBelongScene.call(this,b$M),b$M._renderableSprite3Ds.push(this),this._render._applyLightMapParams()},b$M._setUnBelongScene=function(){var b$M=this._scene._renderableSprite3Ds,b$y=b$M.indexOf(this);b$M.splice(b$y,1),this._render._removeShaderDefine(laya.d3.core.RenderableSprite3D.SAHDERDEFINE_LIGHTMAP),b$i.prototype._setUnBelongScene.call(this)},b$M._update=function(b$M){(b$M.owner=this)._activeInHierarchy&&(this._updateComponents(b$M),this._render._updateOctreeNode(),this._lateUpdateComponents(b$M),b$Q.spriteCount++,this._childs.length&&this._updateChilds(b$M))},b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),b$i.prototype.destroy.call(this,b$M),this._render._destroy(),this._render=null},b$y.__init__=function(){b$y.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=b$y.shaderDefines.registerDefine("SCALEOFFSETLIGHTINGMAPUV"),b$y.SAHDERDEFINE_LIGHTMAP=b$y.shaderDefines.registerDefine("LIGHTMAP")},b$y.SHADERDEFINE_SCALEOFFSETLIGHTINGMAPUV=2,b$y.SAHDERDEFINE_LIGHTMAP=4,b$y.LIGHTMAPSCALEOFFSET=2,b$y.LIGHTMAP=3,b$o(b$y,["shaderDefines",function(){return this.shaderDefines=new b$Fy}]),b$y}(b$zy),b$ry=(function(b$M){function b$H(b$M,b$y,b$i){this._long=NaN,this._width=NaN,this._height=NaN,void 0===b$M&&(b$M=1),void 0===b$y&&(b$y=1),void 0===b$i&&(b$i=1),b$H.__super.call(this),this._long=b$M,this._width=b$y,this._height=b$i,this.activeResource(),this._positions=this._getPositions(),this._generateBoundingObject()}b$P(b$H,"laya.d3.resource.models.BoxMesh",b$By);var b$y=b$H.prototype;b$y.recreateResource=function(){this.disposeResource(),this._numberVertices=24,this._numberIndices=36;var b$M=b$TM.vertexDeclaration,b$y=(b$M.vertexStride,this._long/2),b$i=this._height/2,b$H=this._width/2,b$S=new Float32Array([-b$y,b$i,-b$H,0,1,0,0,0,b$y,b$i,-b$H,0,1,0,1,0,b$y,b$i,b$H,0,1,0,1,1,-b$y,b$i,b$H,0,1,0,0,1,-b$y,-b$i,-b$H,0,-1,0,0,1,b$y,-b$i,-b$H,0,-1,0,1,1,b$y,-b$i,b$H,0,-1,0,1,0,-b$y,-b$i,b$H,0,-1,0,0,0,-b$y,b$i,-b$H,-1,0,0,0,0,-b$y,b$i,b$H,-1,0,0,1,0,-b$y,-b$i,b$H,-1,0,0,1,1,-b$y,-b$i,-b$H,-1,0,0,0,1,b$y,b$i,-b$H,1,0,0,1,0,b$y,b$i,b$H,1,0,0,0,0,b$y,-b$i,b$H,1,0,0,0,1,b$y,-b$i,-b$H,1,0,0,1,1,-b$y,b$i,b$H,0,0,1,0,0,b$y,b$i,b$H,0,0,1,1,0,b$y,-b$i,b$H,0,0,1,1,1,-b$y,-b$i,b$H,0,0,1,0,1,-b$y,b$i,-b$H,0,0,-1,1,0,b$y,b$i,-b$H,0,0,-1,0,0,b$y,-b$i,-b$H,0,0,-1,0,1,-b$y,-b$i,-b$H,0,0,-1,1,1]),b$f=new Uint16Array([0,1,2,2,3,0,4,7,6,6,5,4,8,9,10,10,11,8,12,15,14,14,13,12,16,17,18,18,19,16,20,23,22,22,21,20]);this._vertexBuffer=new b$uy(b$M,this._numberVertices,35044,!0),this._indexBuffer=new b$ty("ushort",this._numberIndices,35044,!0),this._vertexBuffer._addReference(),this._indexBuffer._addReference(),this._vertexBuffer.setData(b$S),this._indexBuffer.setData(b$f),this.memorySize=2*(this._vertexBuffer._byteLength+this._indexBuffer._byteLength),this.completeCreate()},b$l(0,b$y,"long",function(){return this._long},function(b$M){this._long!==b$M&&(this._long=b$M,this.releaseResource(),this.activeResource())}),b$l(0,b$y,"width",function(){return this._width},function(b$M){this._width!==b$M&&(this._width=b$M,this.releaseResource(),this.activeResource())}),b$l(0,b$y,"height",function(){return this._height},function(b$M){this._height!==b$M&&(this._height=b$M,this.releaseResource(),this.activeResource())})}(),function(b$M){function b$V(b$M,b$y,b$i){void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=.3),void 0===b$i&&(b$i=1e3),this._viewMatrix=new b$My,this._projectionMatrix=new b$My,this._projectionViewMatrix=new b$My,this._viewport=new b$ky(0,0,0,0),this._normalizedViewport=new b$ky(0,0,1,1),this._aspectRatio=b$M,this._boundFrustumUpdate=!0,this._boundFrustum=new b$gM(b$My.DEFAULT),b$V.__super.call(this,b$y,b$i),this.transform.on("worldmatrixneedchanged",this,this._onWorldMatrixChanged)}b$P(b$V,"laya.d3.core.Camera",b$by);var b$y=b$V.prototype;return b$y._onWorldMatrixChanged=function(){this._boundFrustumUpdate=!0},b$y._parseCustomProps=function(b$M,b$y,b$i,b$H){var b$S=b$i.clearColor;this.clearColor=new b$Ky(b$S[0],b$S[1],b$S[2],b$S[3]);var b$f=b$i.viewport;this.normalizedViewport=new b$ky(b$f[0],b$f[1],b$f[2],b$f[3])},b$y._calculateProjectionMatrix=function(){if(!this._useUserProjectionMatrix)if(this._orthographic){var b$M=this.orthographicVerticalSize*this.aspectRatio*.5,b$y=.5*this.orthographicVerticalSize;b$My.createOrthoOffCenterRH(-b$M,b$M,-b$y,b$y,this.nearPlane,this.farPlane,this._projectionMatrix)}else b$My.createPerspective(3.1416*this.fieldOfView/180,this.aspectRatio,this.nearPlane,this.farPlane,this._projectionMatrix);this._boundFrustumUpdate=!0},b$y._update=function(b$M){this.conchModel&&(this.conchModel.setViewMatrix(this.viewMatrix.elements),this.conchModel.setProjectMatrix(this.projectionMatrix.elements)),laya.d3.core.Sprite3D.prototype._update.call(this,b$M)},b$y._renderCamera=function(b$M,b$y,b$i){var b$H,b$S;b$i.parallelSplitShadowMaps[0]&&b$i._renderShadowMap(b$M,b$y,this),(b$y.camera=this)._prepareCameraToRender(),b$i._preRenderUpdateComponents(b$y),b$H=b$y._viewMatrix=this.viewMatrix;var b$f=this._renderTarget;b$f?(b$f.start(),b$My.multiply(b$by._invertYScaleMatrix,this._projectionMatrix,b$by._invertYProjectionMatrix),b$My.multiply(b$by._invertYScaleMatrix,this.projectionViewMatrix,b$by._invertYProjectionViewMatrix),b$S=b$y._projectionMatrix=b$by._invertYProjectionMatrix,b$y._projectionViewMatrix=b$by._invertYProjectionViewMatrix):(b$S=b$y._projectionMatrix=this._projectionMatrix,b$y._projectionViewMatrix=this.projectionViewMatrix),this._prepareCameraViewProject(b$H,b$S),b$y._viewport=this.viewport,b$i._preRenderScene(b$M,b$y,this.boundFrustum),b$i._clear(b$M,b$y),b$i._renderScene(b$M,b$y),b$i._postRenderUpdateComponents(b$y),b$f&&b$f.end()},b$y.viewportPointToRay=function(b$M,b$y){b$ly.calculateCursorRay(b$M,this.viewport,this._projectionMatrix,this.viewMatrix,null,b$y)},b$y.normalizedViewportPointToRay=function(b$M,b$y){var b$i=b$V._tempVector20,b$H=this.viewport,b$S=b$M.elements,b$f=b$i.elements;b$f[0]=b$S[0]*b$H.width,b$f[1]=b$S[1]*b$H.height,b$ly.calculateCursorRay(b$i,this.viewport,this._projectionMatrix,this.viewMatrix,null,b$y)},b$y.worldToViewportPoint=function(b$M,b$y){b$My.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.viewport.project(b$M,this._projectionViewMatrix,b$y);var b$i=b$y.elements;b$i[0]=b$i[0]/b$G.stage.clientScaleX,b$i[1]=b$i[1]/b$G.stage.clientScaleY},b$y.worldToNormalizedViewportPoint=function(b$M,b$y){b$My.multiply(this._projectionMatrix,this._viewMatrix,this._projectionViewMatrix),this.normalizedViewport.project(b$M,this._projectionViewMatrix,b$y);var b$i=b$y.elements;b$i[0]=b$i[0]/b$G.stage.clientScaleX,b$i[1]=b$i[1]/b$G.stage.clientScaleY},b$y.convertScreenCoordToOrthographicCoord=function(b$M,b$y){if(this._orthographic){var b$i=b$$.clientWidth,b$H=b$$.clientHeight,b$S=this.orthographicVerticalSize*this.aspectRatio/b$i,b$f=this.orthographicVerticalSize/b$H,b$V=b$M.elements,b$K=b$y.elements;return b$K[0]=(-b$i/2+b$V[0])*b$S,b$K[1]=(b$H/2-b$V[1])*b$f,b$K[2]=(this.nearPlane-this.farPlane)*(b$V[2]+1)/2-this.nearPlane,b$Vy.transformCoordinate(b$y,this.transform.worldMatrix,b$y),!0}return!1},b$l(0,b$y,"projectionViewMatrix",function(){return b$My.multiply(this.projectionMatrix,this.viewMatrix,this._projectionViewMatrix),this._projectionViewMatrix}),b$l(0,b$y,"aspectRatio",function(){if(0!==this._aspectRatio)return this._aspectRatio;var b$M=this.viewport;return b$M.width/b$M.height},function(b$M){if(b$M<0)throw new Error("Camera: the aspect ratio has to be a positive real number.");this._aspectRatio=b$M,this._calculateProjectionMatrix()}),b$l(0,b$y,"boundFrustum",function(){return this._boundFrustumUpdate&&(this._boundFrustum.matrix=this.projectionViewMatrix),this._boundFrustum}),b$l(0,b$y,"needViewport",function(){var b$M=this.normalizedViewport;return 0===b$M.x&&0===b$M.y&&1===b$M.width&&1===b$M.height}),b$l(0,b$y,"viewport",function(){if(this._viewportExpressedInClipSpace){var b$M=this._normalizedViewport,b$y=this.renderTargetSize,b$i=b$y.width,b$H=b$y.height;this._viewport.x=b$M.x*b$i,this._viewport.y=b$M.y*b$H,this._viewport.width=b$M.width*b$i,this._viewport.height=b$M.height*b$H}return this._viewport},function(b$M){if(null!=this.renderTarget&&(b$M.x<0||b$M.y<0||0==b$M.width||0==b$M.height))throw new Error("Camera: viewport size invalid.","value");this._viewportExpressedInClipSpace=!1,this._viewport=b$M,this._calculateProjectionMatrix()}),b$l(0,b$y,"normalizedViewport",function(){if(!this._viewportExpressedInClipSpace){var b$M=this._viewport,b$y=this.renderTargetSize,b$i=b$y.width,b$H=b$y.height;this._normalizedViewport.x=b$M.x/b$i,this._normalizedViewport.y=b$M.y/b$H,this._normalizedViewport.width=b$M.width/b$i,this._normalizedViewport.height=b$M.height/b$H}return this._normalizedViewport},function(b$M){b$M.x<0&&(b$M.x=0,console.warn("Camera: viewport.x must large than 0.0.")),b$M.y<0&&(b$M.y=0,console.warn("Camera: viewport.y must large than 0.0.")),1<b$M.x+b$M.width&&(b$M.width=1-b$M.x,console.warn("Camera: viewport.width + viewport.x must less than 1.0.")),1<b$M.y+b$M.height&&(b$M.height=1-b$M.y,console.warn("Camera: viewport.height + viewport.y must less than 1.0.")),this._viewportExpressedInClipSpace=!0,this._normalizedViewport=b$M,this._calculateProjectionMatrix()}),b$l(0,b$y,"projectionMatrix",function(){return this._projectionMatrix},function(b$M){this._projectionMatrix=b$M,this._useUserProjectionMatrix=!0}),b$l(0,b$y,"viewMatrix",function(){return this.transform.worldMatrix.invert(this._viewMatrix),this._viewMatrix}),b$o(b$V,["_tempVector20",function(){return this._tempVector20=new b$fy}]),b$V}()),b$Ny=function(b$i){function b$H(b$M,b$y){b$H.__super.call(this,b$y),this._geometryFilter=new b$ey(this),this._render=new b$sy(this),this._geometryFilter.on("meshchanged",this,this._onMeshChanged),this._render.on("materialchanged",this,this._onMaterialChanged),b$M&&(this._geometryFilter.sharedMesh=b$M)instanceof laya.d3.resource.models.Mesh&&(b$M.loaded?this._render.sharedMaterials=b$M.materials:b$M.once("loaded",this,this._applyMeshMaterials))}b$P(b$H,"laya.d3.core.MeshSprite3D",b$i);var b$M=b$H.prototype;return b$M._changeRenderObjectByMesh=function(b$M){var b$y=this._render._renderElements,b$i=b$y[b$M];b$i||(b$i=b$y[b$M]=new b$Uy),b$i._render=this._render;var b$H=this._render.sharedMaterials[b$M];b$H||(b$H=b$qy.defaultMaterial);var b$S=this._geometryFilter.sharedMesh.getRenderElement(b$M);return b$i._mainSortID=this._getSortID(b$S,b$H),b$i._sprite3D=this,b$i.renderObj=b$S,b$i._material=b$H,b$i},b$M._changeRenderObjectByMaterial=function(b$M,b$y){var b$i=this._render._renderElements[b$M];b$y||(b$y=b$qy.defaultMaterial);var b$H=this._geometryFilter.sharedMesh.getRenderElement(b$M);return b$i._mainSortID=this._getSortID(b$H,b$y),b$i._sprite3D=this,b$i.renderObj=b$H,b$i._material=b$y,b$i},b$M._changeRenderObjectsByMesh=function(){var b$M=this._geometryFilter.sharedMesh.getRenderElementsCount();this._render._renderElements.length=b$M;for(var b$y=0;b$y<b$M;b$y++)this._changeRenderObjectByMesh(b$y)},b$M._onMeshChanged=function(b$M){var b$y=b$M.sharedMesh;b$y.loaded?this._changeRenderObjectsByMesh():b$y.once("loaded",this,this._onMeshLoaded)},b$M._onMeshLoaded=function(b$M){b$M===this.meshFilter.sharedMesh&&this._changeRenderObjectsByMesh()},b$M._onMaterialChanged=function(b$M,b$y,b$i){b$y<this._render._renderElements.length&&this._changeRenderObjectByMaterial(b$y,b$i)},b$M._clearSelfRenderObjects=function(){this.scene.removeFrustumCullingObject(this._render)},b$M._addSelfRenderObjects=function(){this.scene.addFrustumCullingObject(this._render)},b$M._parseCustomProps=function(b$M,b$y,b$i,b$H){var b$S=this.meshRender,b$f=b$i.lightmapIndex;null!=b$f&&(b$S.lightmapIndex=b$f);var b$V,b$K,b$k=b$i.lightmapScaleOffset;if(b$k&&(b$S.lightmapScaleOffset=new b$Ky(b$k[0],b$k[1],b$k[2],b$k[3])),b$H.instanceParams)(b$V=b$H.instanceParams.loadPath)&&(b$K=b$C.getRes(b$y[b$V]),(this.meshFilter.sharedMesh=b$K).loaded?b$S.sharedMaterials=b$K.materials:b$K.once("loaded",this,this._applyMeshMaterials));else{(b$V=b$i.meshPath)&&(b$K=b$C.getRes(b$y[b$V]),this.meshFilter.sharedMesh=b$K);var b$X=b$i.materials;if(b$X){var b$F=b$S.sharedMaterials,b$o=b$X.length;b$F.length=b$o;for(var b$d=0;b$d<b$o;b$d++)b$F[b$d]=b$C.getRes(b$y[b$X[b$d].path]);b$S.sharedMaterials=b$F}}},b$M._applyMeshMaterials=function(b$M){for(var b$y=this._render.sharedMaterials,b$i=b$M.materials,b$H=0,b$S=b$i.length;b$H<b$S;b$H++)b$y[b$H]||(b$y[b$H]=b$i[b$H]);this._render.sharedMaterials=b$y},b$M._addToInitStaticBatchManager=function(){b$H._staticBatchManager._addInitBatchSprite(this)},b$M.cloneTo=function(b$M){var b$y=b$M;b$y._geometryFilter.sharedMesh=this._geometryFilter.sharedMesh;var b$i=this._render,b$H=b$y._render;b$H.enable=b$i.enable,b$H.sharedMaterials=b$i.sharedMaterials,b$H.castShadow=b$i.castShadow;var b$S=b$i.lightmapScaleOffset;b$S&&(b$H.lightmapScaleOffset=b$S.clone()),b$H.lightmapIndex=b$i.lightmapIndex,b$H.receiveShadow=b$i.receiveShadow,b$H.sortingFudge=b$i.sortingFudge,laya.d3.core.Sprite3D.prototype.cloneTo.call(this,b$M)},b$M.destroy=function(b$M){if(void 0===b$M&&(b$M=!0),!this.destroyed){var b$y=this.meshFilter.sharedMesh;null!=b$y&&(b$y.loaded||b$y.off("loaded",this,this._applyMeshMaterials)),b$i.prototype.destroy.call(this,b$M),this._geometryFilter._destroy()}},b$l(0,b$M,"meshFilter",function(){return this._geometryFilter}),b$l(0,b$M,"meshRender",function(){return this._render}),b$H.__init__=function(){b$HM._staticBatchManagers.push(b$H._staticBatchManager)},b$H.load=function(b$M){return b$G.loader.create(b$M,null,null,b$H)},b$o(b$H,["_staticBatchManager",function(){return this._staticBatchManager=new b$Wy}]),b$H}(b$Yy)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(b$M,b$y){"use strict";for(var b$i in Object.defineProperty(b$y,"__esModule",{value:!0}),Laya){var b$H=Laya[b$i];b$H&&b$H.__isclass&&(b$y[b$i]=b$H)}}),function(b$M,b$y,b$SM){b$SM.un,b$SM.uns;var b$i=b$SM.static,b$H=b$SM.class,b$f=b$SM.getset,b$J=b$SM.__newvec,b$K=laya.maths.Bezier,b$o=laya.utils.Browser,b$TM=laya.utils.Byte,b$S=(laya.events.Event,laya.events.EventDispatcher),b$V=laya.display.Graphics,b$k=(laya.resource.HTMLCanvas,laya.utils.Handler),b$X=laya.net.Loader,b$d=laya.maths.MathUtil,b$mM=laya.maths.Matrix,b$h=(laya.display.Node,laya.maths.Point,laya.maths.Rectangle,laya.renders.Render),b$F=(laya.renders.RenderContext,laya.resource.Resource),b$P=laya.utils.RunDriver,b$fM=laya.display.Sprite,b$l=laya.utils.Stat,b$eM=laya.resource.Texture,b$C=(laya.net.URL,laya.utils.Utils),b$m=function(){function b$M(){this.nodes=null,this.name=null,this.playTime=NaN,this.bone3DMap=null,this.totalKeyframeDatasLength=0}return b$H(b$M,"laya.ani.AnimationContent"),b$M}(),b$e=function(){function b$M(){this.name=null,this.parentIndex=0,this.parent=null,this.keyframeWidth=0,this.lerpType=0,this.interpolationMethod=null,this.childs=null,this.keyFrame=null,this.playTime=NaN,this.extenData=null,this.dataOffset=0}return b$H(b$M,"laya.ani.AnimationNodeContent"),b$M}(),b$R=function(){function b$M(){}return b$H(b$M,"laya.ani.AnimationParser01"),b$M.parse=function(b$M,b$y){var b$i=b$y.__getBuffer(),b$H=0,b$S=0,b$f=0,b$V=0,b$K=0,b$k=0,b$X=0,b$F=b$y.readUTFString();b$M._aniClassName=b$F;var b$o,b$d=b$y.readUTFString().split("\n"),b$P=b$y.getUint8(),b$l=b$y.getUint32(),b$J=b$y.getUint32();0<b$l&&(b$o=b$i.slice(b$l,b$J));var b$h=new b$TM(b$o);for(0<b$J&&(b$M._publicExtData=b$i.slice(b$J,b$i.byteLength)),b$M._useParent=!!b$y.getUint8(),b$M._anis.length=b$P,b$H=0;b$H<b$P;b$H++){var b$C=b$M._anis[b$H]=new b$m;b$C.nodes=new Array;var b$v=b$C.name=b$d[b$y.getUint16()];b$M._aniMap[b$v]=b$H,b$C.bone3DMap={},b$C.playTime=b$y.getFloat32(),b$C.playTime<=0&&console.error("播放时间不能为0  url="+b$M.url+" name="+b$C.name);var b$R=b$C.nodes.length=b$y.getUint8();for(b$S=b$C.totalKeyframeDatasLength=0;b$S<b$R;b$S++){var b$A=b$C.nodes[b$S]=new b$e;b$A.childs=[];var b$G=b$y.getInt16();0<=b$G&&(b$A.name=b$d[b$G],b$C.bone3DMap[b$A.name]=b$S),b$A.keyFrame=new Array,b$A.parentIndex=b$y.getInt16(),-1==b$A.parentIndex?b$A.parent=null:b$A.parent=b$C.nodes[b$A.parentIndex],b$A.lerpType=b$y.getUint8();var b$I=b$y.getUint32();b$h.pos=b$I;var b$U=b$A.keyframeWidth=b$h.getUint16();if(b$C.totalKeyframeDatasLength+=b$U,0===b$A.lerpType||1===b$A.lerpType)for(b$A.interpolationMethod=[],b$A.interpolationMethod.length=b$U,b$f=0;b$f<b$U;b$f++)b$A.interpolationMethod[b$f]=b$z.interpolation[b$h.getUint8()];null!=b$A.parent&&b$A.parent.childs.push(b$A);var b$Q=b$y.getUint16();0<b$Q&&(b$A.extenData=b$i.slice(b$y.pos,b$y.pos+b$Q),b$y.pos+=b$Q);var b$W,b$c=b$y.getUint16(),b$n=0;for(b$f=0,b$V=b$A.keyFrame.length=b$c;b$f<b$V;b$f++){if((b$W=b$A.keyFrame[b$f]=new b$s).duration=b$y.getFloat32(),b$W.startTime=b$n,2===b$A.lerpType){b$W.interpolationData=[];var b$a,b$T=b$y.getUint8();switch(b$a=b$y.getFloat32()){case 254:for(b$W.interpolationData.length=b$U,b$X=0;b$X<b$U;b$X++)b$W.interpolationData[b$X]=0;break;case 255:for(b$W.interpolationData.length=b$U,b$X=0;b$X<b$U;b$X++)b$W.interpolationData[b$X]=5;break;default:for(b$W.interpolationData.push(b$a),b$k=1;b$k<b$T;b$k++)b$W.interpolationData.push(b$y.getFloat32())}}for(b$W.data=new Float32Array(b$U),b$K=0;b$K<b$U;b$K++)b$W.data[b$K]=b$y.getFloat32(),-1e-8<b$W.data[b$K]&&b$W.data[b$K]<1e-8&&(b$W.data[b$K]=0);b$n+=b$W.duration}b$W.startTime=b$C.playTime,b$A.playTime=b$C.playTime,b$M._calculateKeyFrame(b$A,b$c,b$U)}}},b$M}(),b$A=function(){function b$G(){}return b$H(b$G,"laya.ani.AnimationParser02"),b$G.READ_DATA=function(){b$G._DATA.offset=b$G._reader.getUint32(),b$G._DATA.size=b$G._reader.getUint32()},b$G.READ_BLOCK=function(){for(var b$M=b$G._BLOCK.count=b$G._reader.getUint16(),b$y=b$G._BLOCK.blockStarts=[],b$i=b$G._BLOCK.blockLengths=[],b$H=0;b$H<b$M;b$H++)b$y.push(b$G._reader.getUint32()),b$i.push(b$G._reader.getUint32())},b$G.READ_STRINGS=function(){var b$M=b$G._reader.getUint32(),b$y=b$G._reader.getUint16(),b$i=b$G._reader.pos;b$G._reader.pos=b$M+b$G._DATA.offset;for(var b$H=0;b$H<b$y;b$H++)b$G._strings[b$H]=b$G._reader.readUTFString();b$G._reader.pos=b$i},b$G.parse=function(b$M,b$y){b$G._templet=b$M;(b$G._reader=b$y).__getBuffer();b$G.READ_DATA(),b$G.READ_BLOCK(),b$G.READ_STRINGS();for(var b$i=0,b$H=b$G._BLOCK.count;b$i<b$H;b$i++){var b$S=b$y.getUint16(),b$f=b$G._strings[b$S],b$V=b$G["READ_"+b$f];if(null==b$V)throw new Error("model file err,no this function:"+b$S+" "+b$f);b$V.call()}},b$G.READ_ANIMATIONS=function(){var b$M=b$G._reader,b$y=b$M.__getBuffer(),b$i=0,b$H=0,b$S=0,b$f=0,b$V=b$M.getUint16(),b$K=[];for(b$K.length=b$V,b$i=0;b$i<b$V;b$i++)b$K[b$i]=b$z.interpolation[b$M.getByte()];var b$k=b$M.getUint8();for(b$G._templet._anis.length=b$k,b$i=0;b$i<b$k;b$i++){var b$X=b$G._templet._anis[b$i]={};b$X.nodes=new Array;var b$F=b$X.name=b$G._strings[b$M.getUint16()];b$G._templet._aniMap[b$F]=b$i,b$X.bone3DMap={},b$X.playTime=b$M.getFloat32();var b$o=b$X.nodes.length=b$M.getInt16();for(b$H=b$X.totalKeyframeDatasLength=0;b$H<b$o;b$H++){var b$d=b$X.nodes[b$H]={};b$d.keyframeWidth=b$V,b$d.childs=[];var b$P=b$M.getUint16();0<=b$P&&(b$d.name=b$G._strings[b$P],b$X.bone3DMap[b$d.name]=b$H),b$d.keyFrame=new Array,b$d.parentIndex=b$M.getInt16(),-1==b$d.parentIndex?b$d.parent=null:b$d.parent=b$X.nodes[b$d.parentIndex],b$X.totalKeyframeDatasLength+=b$V,b$d.interpolationMethod=b$K,null!=b$d.parent&&b$d.parent.childs.push(b$d);var b$l=b$M.getUint16(),b$J=null,b$h=null;for(b$S=0,b$f=b$d.keyFrame.length=b$l;b$S<b$f;b$S++){(b$J=b$d.keyFrame[b$S]={}).startTime=b$M.getFloat32(),b$h&&(b$h.duration=b$J.startTime-b$h.startTime);var b$C=b$G._DATA.offset,b$v=b$M.getUint32(),b$R=4*b$V,b$A=b$y.slice(b$C+b$v,b$C+b$v+b$R);b$J.data=new Float32Array(b$A),b$h=b$J}b$J.duration=0,b$d.playTime=b$X.playTime,b$G._templet._calculateKeyFrame(b$d,b$l,b$V)}}},b$G._templet=null,b$G._reader=null,b$G._strings=[],b$i(b$G,["_BLOCK",function(){return this._BLOCK={count:0}},"_DATA",function(){return this._DATA={offset:0,size:0}}]),b$G}(),b$sM=(function(){function b$M(){}b$H(b$M,"laya.ani.AnimationState"),b$M.stopped=0,b$M.paused=1,b$M.playing=2}(),function(){function b$S(){this.name=null,this.root=null,this.parentBone=null,this.length=10,this.transform=null,this.inheritScale=!0,this.inheritRotation=!0,this.rotation=NaN,this.resultRotation=NaN,this.d=-1,this._tempMatrix=null,this._sprite=null,this.resultTransform=new b$YM,this.resultMatrix=new b$mM,this._children=[]}b$H(b$S,"laya.ani.bone.Bone");var b$M=b$S.prototype;return b$M.setTempMatrix=function(b$M){this._tempMatrix=b$M;var b$y,b$i=0;for(b$i=0,b$y=this._children.length;b$i<b$y;b$i++)this._children[b$i].setTempMatrix(this._tempMatrix)},b$M.update=function(b$M){var b$y;if(this.rotation=this.transform.skX,b$M)b$y=this.resultTransform.getMatrix(),b$mM.mul(b$y,b$M,this.resultMatrix),this.resultRotation=this.rotation;else if(this.resultRotation=this.rotation+this.parentBone.resultRotation,this.parentBone)if(this.inheritRotation&&this.inheritScale)b$y=this.resultTransform.getMatrix(),b$mM.mul(b$y,this.parentBone.resultMatrix,this.resultMatrix);else{var b$i=this.parentBone,b$H=NaN,b$S=NaN,b$f=NaN,b$V=this.parentBone.resultMatrix;b$y=this.resultTransform.getMatrix();var b$K=b$V.a*b$y.tx+b$V.c*b$y.ty+b$V.tx,b$k=b$V.b*b$y.tx+b$V.d*b$y.ty+b$V.ty,b$X=new b$mM;this.inheritRotation?(b$H=Math.atan2(b$i.resultMatrix.b,b$i.resultMatrix.a),b$S=Math.cos(b$H),b$f=Math.sin(b$H),b$X.setTo(b$S,b$f,-b$f,b$S,0,0),b$mM.mul(this._tempMatrix,b$X,b$mM.TEMP),b$mM.TEMP.copyTo(b$X),b$y=this.resultTransform.getMatrix(),b$mM.mul(b$y,b$X,this.resultMatrix),this.resultTransform.scX*this.resultTransform.scY<0&&this.resultMatrix.rotate(.5*Math.PI)):(this.inheritScale,b$y=this.resultTransform.getMatrix(),b$mM.TEMP.identity(),b$mM.TEMP.d=this.d,b$mM.mul(b$y,b$mM.TEMP,this.resultMatrix)),this.resultMatrix.tx=b$K,this.resultMatrix.ty=b$k}else(b$y=this.resultTransform.getMatrix()).copyTo(this.resultMatrix);var b$F,b$o=0;for(b$o=0,b$F=this._children.length;b$o<b$F;b$o++)this._children[b$o].update()},b$M.updateChild=function(){var b$M,b$y=0;for(b$y=0,b$M=this._children.length;b$y<b$M;b$y++)this._children[b$y].update()},b$M.setRotation=function(b$M){this._sprite&&(this._sprite.rotation=180*b$M/Math.PI)},b$M.updateDraw=function(b$M,b$y){b$S.ShowBones&&!b$S.ShowBones[this.name]||(this._sprite||(this._sprite=new b$fM,this._sprite.graphics.drawCircle(0,0,5,"#ff0000"),this._sprite.graphics.drawLine(0,0,this.length,0,"#00ff00"),this._sprite.graphics.fillText(this.name,0,0,"20px Arial","#00ff00","center"),b$SM.stage.addChild(this._sprite)),this._sprite.x=b$M+this.resultMatrix.tx,this._sprite.y=b$y+this.resultMatrix.ty);var b$i,b$H=0;for(b$H=0,b$i=this._children.length;b$H<b$i;b$H++)this._children[b$H].updateDraw(b$M,b$y)},b$M.addChild=function(b$M){this._children.push(b$M),b$M.parentBone=this},b$M.findBone=function(b$M){if(this.name==b$M)return this;var b$y,b$i,b$H=0;for(b$H=0,b$y=this._children.length;b$H<b$y;b$H++)if(b$i=this._children[b$H].findBone(b$M))return b$i;return null},b$M.localToWorld=function(b$M){var b$y=b$M[0],b$i=b$M[1];b$M[0]=b$y*this.resultMatrix.a+b$i*this.resultMatrix.c+this.resultMatrix.tx,b$M[1]=b$y*this.resultMatrix.b+b$i*this.resultMatrix.d+this.resultMatrix.ty},b$S.ShowBones={},b$S}()),b$DM=function(){function b$J(){this.name=null,this.parent=null,this.attachmentName=null,this.srcDisplayIndex=-1,this.type="src",this.templet=null,this.currSlotData=null,this.currTexture=null,this.currDisplayData=null,this.displayIndex=-1,this._diyTexture=null,this._parentMatrix=null,this._resultMatrix=null,this._replaceDic={},this._curDiyUV=null,this._curDiyVS=null,this._skinSprite=null,this.deformData=null,this._mVerticleArr=null}b$H(b$J,"laya.ani.bone.BoneSlot");var b$M=b$J.prototype;return b$M.showSlotData=function(b$M,b$y){void 0===b$y&&(b$y=!0),this.currSlotData=b$M,b$y&&(this.displayIndex=this.srcDisplayIndex),this.currDisplayData=null,this.currTexture=null},b$M.showDisplayByName=function(b$M){this.currSlotData&&this.showDisplayByIndex(this.currSlotData.getDisplayByName(b$M))},b$M.replaceDisplayByName=function(b$M,b$y){if(this.currSlotData){var b$i;b$i=this.currSlotData.getDisplayByName(b$M);var b$H;b$H=this.currSlotData.getDisplayByName(b$y),this.replaceDisplayByIndex(b$i,b$H)}},b$M.replaceDisplayByIndex=function(b$M,b$y){this.currSlotData&&(this._replaceDic[b$M]=b$y,this.displayIndex==b$M&&this.showDisplayByIndex(b$M))},b$M.showDisplayByIndex=function(b$M){if(null!=this._replaceDic[b$M]&&(b$M=this._replaceDic[b$M]),this.currSlotData&&-1<b$M&&b$M<this.currSlotData.displayArr.length){if(this.displayIndex=b$M,this.currDisplayData=this.currSlotData.displayArr[b$M],this.currDisplayData){var b$y=this.currDisplayData.name;this.currTexture=this.templet.getTexture(b$y),this.currTexture&&0==this.currDisplayData.type&&this.currDisplayData.uvs&&(!b$h.isConchApp||b$h.isConchApp&&"0.9.15"<b$fM.RUNTIMEVERION)&&(this.currTexture=this.currDisplayData.createTexture(this.currTexture))}}else this.displayIndex=-1,this.currDisplayData=null,this.currTexture=null},b$M.replaceSkin=function(b$M){this._diyTexture=b$M,this._curDiyUV&&(this._curDiyUV.length=0),this.currDisplayData&&this._diyTexture==this.currDisplayData.texture&&(this._diyTexture=null)},b$M.setParentMatrix=function(b$M){this._parentMatrix=b$M},b$M.draw=function(b$M,b$y,b$i,b$H){if(void 0===b$i&&(b$i=!1),void 0===b$H&&(b$H=1),(null!=this._diyTexture||null!=this.currTexture)&&null!=this.currDisplayData||this.currDisplayData&&3==this.currDisplayData.type){var b$S,b$f=this.currTexture;switch(this._diyTexture&&(b$f=this._diyTexture),this.currDisplayData.type){case 0:if(b$M){var b$V=this.getDisplayMatrix();if(this._parentMatrix){var b$K=!1;if(b$V){var b$k;if(b$mM.mul(b$V,this._parentMatrix,b$mM.TEMP),b$k=b$i?(null==this._resultMatrix&&(this._resultMatrix=new b$mM),this._resultMatrix):new b$mM,!b$h.isWebGL&&this.currDisplayData.uvs||b$h.isWebGL&&this._diyTexture&&this.currDisplayData.uvs){var b$X=b$J._tempMatrix;b$X.identity(),this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(b$X.d=-1),this.currDisplayData.uvs[0]>this.currDisplayData.uvs[4]&&this.currDisplayData.uvs[1]>this.currDisplayData.uvs[5]&&(b$K=!0,b$X.rotate(-Math.PI/2)),b$mM.mul(b$X,b$mM.TEMP,b$k)}else b$mM.TEMP.copyTo(b$k);b$K?b$M.drawTexture(b$f,-this.currDisplayData.height/2,-this.currDisplayData.width/2,this.currDisplayData.height,this.currDisplayData.width,b$k):b$M.drawTexture(b$f,-this.currDisplayData.width/2,-this.currDisplayData.height/2,this.currDisplayData.width,this.currDisplayData.height,b$k)}}}break;case 1:if(null==(b$S=b$i?(null==this._skinSprite&&(this._skinSprite=b$J.createSkinMesh()),this._skinSprite):b$J.createSkinMesh()))return;var b$F;if(null==this.currDisplayData.bones){var b$o,b$d=this.currDisplayData.weights;this.deformData&&(b$d=this.deformData),b$o=this._diyTexture?(this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=b$U.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=b$U.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs,this._mVerticleArr=b$d;this.currDisplayData.triangles.length;b$F=this.currDisplayData.triangles,b$S.init2(b$f,null,b$F,this._mVerticleArr,b$o);var b$P,b$l=this.getDisplayMatrix();if(this._parentMatrix)if(b$l)b$mM.mul(b$l,this._parentMatrix,b$mM.TEMP),b$P=b$i?(null==this._resultMatrix&&(this._resultMatrix=new b$mM),this._resultMatrix):new b$mM,b$mM.TEMP.copyTo(b$P),b$S.transform=b$P}else this.skinMesh(b$y,b$S,b$H);b$M.drawSkin(b$S);break;case 2:if(null==(b$S=b$i?(null==this._skinSprite&&(this._skinSprite=b$J.createSkinMesh()),this._skinSprite):b$J.createSkinMesh()))return;this.skinMesh(b$y,b$S,b$H),b$M.drawSkin(b$S)}}},b$M.skinMesh=function(b$M,b$y,b$i){var b$H,b$S=this.currTexture,b$f=this.currDisplayData.bones;b$H=this._diyTexture?(b$S=this._diyTexture,this._curDiyUV||(this._curDiyUV=[]),0==this._curDiyUV.length&&(this._curDiyUV=b$U.getRelativeUV(this.currTexture.uv,this.currDisplayData.uvs,this._curDiyUV),this._curDiyUV=b$U.getAbsoluteUV(this._diyTexture.uv,this._curDiyUV,this._curDiyUV)),this._curDiyUV):this.currDisplayData.uvs;var b$V,b$K,b$k=this.currDisplayData.weights,b$X=this.currDisplayData.triangles,b$F=0,b$o=0,b$d=0,b$P=NaN,b$l=NaN,b$J=0,b$h=0,b$C=[],b$v=0,b$R=0;if(this.deformData&&0<this.deformData.length){var b$A=0;for(b$v=0,b$R=b$f.length;b$v<b$R;){for(b$d=b$f[b$v++]+b$v,b$o=b$F=0;b$v<b$d;b$v++)b$K=b$M[b$f[b$v]],b$P=b$k[b$J]+this.deformData[b$A++],b$l=b$k[b$J+1]+this.deformData[b$A++],b$h=b$k[b$J+2],b$F+=(b$P*b$K.a+b$l*b$K.c+b$K.tx)*b$h,b$o+=(b$P*b$K.b+b$l*b$K.d+b$K.ty)*b$h,b$J+=3;b$C.push(b$F,b$o)}}else for(b$v=0,b$R=b$f.length;b$v<b$R;){for(b$d=b$f[b$v++]+b$v,b$o=b$F=0;b$v<b$d;b$v++)b$K=b$M[b$f[b$v]],b$P=b$k[b$J],b$l=b$k[b$J+1],b$h=b$k[b$J+2],b$F+=(b$P*b$K.a+b$l*b$K.c+b$K.tx)*b$h,b$o+=(b$P*b$K.b+b$l*b$K.d+b$K.ty)*b$h,b$J+=3;b$C.push(b$F,b$o)}this._mVerticleArr=b$C,b$V=b$X,b$y.init2(b$S,null,b$V,this._mVerticleArr,b$H)},b$M.drawBonePoint=function(b$M){b$M&&this._parentMatrix&&b$M.drawCircle(this._parentMatrix.tx,this._parentMatrix.ty,5,"#ff0000")},b$M.getDisplayMatrix=function(){return this.currDisplayData?this.currDisplayData.transform.getMatrix():null},b$M.getMatrix=function(){return this._resultMatrix},b$M.copy=function(){var b$M=new b$J;return b$M.type="copy",b$M.name=this.name,b$M.attachmentName=this.attachmentName,b$M.srcDisplayIndex=this.srcDisplayIndex,b$M.parent=this.parent,b$M.displayIndex=this.displayIndex,b$M.templet=this.templet,b$M.currSlotData=this.currSlotData,b$M.currTexture=this.currTexture,b$M.currDisplayData=this.currDisplayData,b$M},b$J.createSkinMesh=function(){return b$h.isWebGL||b$h.isConchApp?b$P.skinAniSprite():(b$h.isWebGL,null)},b$i(b$J,["_tempMatrix",function(){return this._tempMatrix=new b$mM}]),b$J}(),b$zM=function(){function b$M(){this.skinName=null,this.deformSlotDataList=[]}return b$H(b$M,"laya.ani.bone.DeformAniData"),b$M}(),b$wM=function(){function b$M(){this.deformSlotDisplayList=[]}return b$H(b$M,"laya.ani.bone.DeformSlotData"),b$M}(),b$qM=function(){function b$M(){this.boneSlot=null,this.slotIndex=-1,this.attachment=null,this.deformData=null,this.frameIndex=0,this.timeList=[],this.vectices=[],this.tweenKeyList=[]}b$H(b$M,"laya.ani.bone.DeformSlotDisplayData");var b$y=b$M.prototype;return b$y.binarySearch1=function(b$M,b$y){var b$i=0,b$H=b$M.length-2;if(0==b$H)return 1;for(var b$S=b$H>>>1;;){if(b$M[Math.floor(b$S+1)]<=b$y?b$i=b$S+1:b$H=b$S,b$i==b$H)return b$i+1;b$S=b$i+b$H>>>1}return 0},b$y.apply=function(b$M,b$y,b$i){if(void 0===b$i&&(b$i=1),b$M+=.05,!(this.timeList.length<=0)){var b$H=0;if(!(b$M<this.timeList[0])){var b$S=this.vectices[0].length,b$f=[],b$V=this.binarySearch1(this.timeList,b$M);if(this.frameIndex=b$V,b$M>=this.timeList[this.timeList.length-1]){var b$K=this.vectices[this.vectices.length-1];if(b$i<1)for(b$H=0;b$H<b$S;b$H++)b$f[b$H]+=(b$K[b$H]-b$f[b$H])*b$i;else for(b$H=0;b$H<b$S;b$H++)b$f[b$H]=b$K[b$H];this.deformData=b$f}else{this.tweenKeyList[this.frameIndex];var b$k=this.vectices[this.frameIndex-1],b$X=this.vectices[this.frameIndex],b$F=this.timeList[this.frameIndex-1],b$o=this.timeList[this.frameIndex];b$i=this.tweenKeyList[b$V-1]?(b$M-b$F)/(b$o-b$F):0;var b$d=NaN;for(b$H=0;b$H<b$S;b$H++)b$d=b$k[b$H],b$f[b$H]=b$d+(b$X[b$H]-b$d)*b$i;this.deformData=b$f}}}},b$M}(),b$tM=function(){function b$M(){this.time=NaN,this.drawOrder=[]}return b$H(b$M,"laya.ani.bone.DrawOrderData"),b$M}(),b$uM=function(){function b$M(){this.name=null,this.intValue=0,this.floatValue=NaN,this.stringValue=null,this.time=NaN}return b$H(b$M,"laya.ani.bone.EventData"),b$M}(),b$v=function(){function b$HM(b$M,b$y){this._targetBone=null,this._bones=null,this._data=null,this.name=null,this.mix=NaN,this.bendDirection=NaN,this.isSpine=!0,this._sp=null,this.isDebug=!1,this._data=b$M,this._targetBone=b$y[b$M.targetBoneIndex],this.isSpine=b$M.isSpine,null==this._bones&&(this._bones=[]);for(var b$i=this._bones.length=0,b$H=b$M.boneIndexs.length;b$i<b$H;b$i++)this._bones.push(b$y[b$M.boneIndexs[b$i]]);this.name=b$M.name,this.mix=b$M.mix,this.bendDirection=b$M.bendDirection}b$H(b$HM,"laya.ani.bone.IkConstraint");var b$M=b$HM.prototype;return b$M.apply=function(){switch(this._bones.length){case 1:this._applyIk1(this._bones[0],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.mix);break;case 2:this.isSpine?this._applyIk2(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix):this._applyIk3(this._bones[0],this._bones[1],this._targetBone.resultMatrix.tx,this._targetBone.resultMatrix.ty,this.bendDirection,this.mix)}},b$M._applyIk1=function(b$M,b$y,b$i,b$H){var b$S=b$M.parentBone,b$f=1/(b$S.resultMatrix.a*b$S.resultMatrix.d-b$S.resultMatrix.b*b$S.resultMatrix.c),b$V=b$y-b$S.resultMatrix.tx,b$K=b$i-b$S.resultMatrix.ty,b$k=(b$V*b$S.resultMatrix.d-b$K*b$S.resultMatrix.c)*b$f-b$M.transform.x,b$X=(b$K*b$S.resultMatrix.a-b$V*b$S.resultMatrix.b)*b$f-b$M.transform.y,b$F=Math.atan2(b$X,b$k)*b$HM.radDeg-0-b$M.transform.skX;b$M.transform.scX<0&&(b$F+=180),180<b$F?b$F-=360:b$F<-180&&(b$F+=360),b$M.transform.skX=b$M.transform.skY=b$M.transform.skX+b$F*b$H,b$M.update()},b$M.updatePos=function(b$M,b$y){this._sp&&this._sp.pos(b$M,b$y)},b$M._applyIk2=function(b$M,b$y,b$i,b$H,b$S,b$f){if(0!=b$f){var b$V=b$M.resultTransform.x,b$K=b$M.resultTransform.y,b$k=b$M.transform.scX,b$X=b$M.transform.scY,b$F=b$y.transform.scX,b$o=0,b$d=0,b$P=0;b$P=b$k<0?(b$k=-b$k,b$o=180,-1):(b$o=0,1),b$X<0&&(b$X=-b$X,b$P=-b$P),b$d=b$F<0?(b$F=-b$F,180):0;var b$l=b$y.resultTransform.x,b$J=NaN,b$h=NaN,b$C=NaN,b$v=b$M.resultMatrix.a,b$R=b$M.resultMatrix.c,b$A=b$M.resultMatrix.b,b$G=b$M.resultMatrix.d,b$I=Math.abs(b$k-b$X)<=1e-4;b$C=b$I?(b$h=b$v*b$l+b$R*(b$J=b$y.resultTransform.y)+b$M.resultMatrix.tx,b$A*b$l+b$G*b$J+b$M.resultMatrix.ty):(b$J=0,b$h=b$v*b$l+b$M.resultMatrix.tx,b$A*b$l+b$M.resultMatrix.ty),this.isDebug&&(this._sp||(this._sp=new b$fM,b$SM.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(b$i,b$H,15,"#ffff00"),this._sp.graphics.drawCircle(b$h,b$C,15,"#ff00ff")),b$M.setRotation(Math.atan2(b$C-b$M.resultMatrix.ty,b$h-b$M.resultMatrix.tx));var b$U=b$M.parentBone;b$v=b$U.resultMatrix.a,b$R=b$U.resultMatrix.c,b$A=b$U.resultMatrix.b;var b$Q=1/(b$v*(b$G=b$U.resultMatrix.d)-b$R*b$A),b$W=b$i-b$U.resultMatrix.tx,b$c=b$H-b$U.resultMatrix.ty,b$n=(b$W*b$G-b$c*b$R)*b$Q-b$V,b$a=(b$c*b$v-b$W*b$A)*b$Q-b$K,b$T=((b$W=b$h-b$U.resultMatrix.tx)*b$G-(b$c=b$C-b$U.resultMatrix.ty)*b$R)*b$Q-b$V,b$m=(b$c*b$v-b$W*b$A)*b$Q-b$K,b$e=Math.sqrt(b$T*b$T+b$m*b$m),b$s=b$y.length*b$F,b$D=NaN,b$z=NaN;if(b$I){var b$w=(b$n*b$n+b$a*b$a-b$e*b$e-(b$s*=b$k)*b$s)/(2*b$e*b$s);b$w<-1?b$w=-1:1<b$w&&(b$w=1),b$z=Math.acos(b$w)*b$S,b$v=b$e+b$s*b$w,b$R=b$s*Math.sin(b$z),b$D=Math.atan2(b$a*b$v-b$n*b$R,b$n*b$v+b$a*b$R)}else{var b$q=(b$v=b$k*b$s)*b$v,b$t=(b$R=b$X*b$s)*b$R,b$u=b$n*b$n+b$a*b$a,b$p=Math.atan2(b$a,b$n),b$B=-2*b$t*b$e,b$Z=b$t-b$q;if(0<(b$G=b$B*b$B-4*b$Z*(b$A=b$t*b$e*b$e+b$q*b$u-b$q*b$t))){var b$E=Math.sqrt(b$G);b$B<0&&(b$E=-b$E);var b$_=(b$E=-(b$B+b$E)/2)/b$Z,b$b=b$A/b$E,b$Y=Math.abs(b$_)<Math.abs(b$b)?b$_:b$b;b$Y*b$Y<=b$u&&(b$c=Math.sqrt(b$u-b$Y*b$Y)*b$S,b$D=b$p-Math.atan2(b$c,b$Y),b$z=Math.atan2(b$c/b$X,(b$Y-b$e)/b$k))}var b$r=0,b$N=Number.MAX_VALUE,b$$=0,b$x=0,b$g=0,b$j=0,b$O=0,b$L=0;b$j<(b$G=(b$W=b$e+b$v)*b$W)&&(b$g=0,b$j=b$G,b$O=b$W),(b$G=(b$W=b$e-b$v)*b$W)<b$N&&(b$r=Math.PI,b$N=b$G,b$$=b$W);var b$MM=Math.acos(-b$v*b$e/(b$q-b$t));(b$G=(b$W=b$v*Math.cos(b$MM)+b$e)*b$W+(b$c=b$R*Math.sin(b$MM))*b$c)<b$N&&(b$r=b$MM,b$N=b$G,b$$=b$W,b$x=b$c),b$j<b$G&&(b$g=b$MM,b$j=b$G,b$O=b$W,b$L=b$c),b$z=b$u<=(b$N+b$j)/2?(b$D=b$p-Math.atan2(b$x*b$S,b$$),b$r*b$S):(b$D=b$p-Math.atan2(b$L*b$S,b$O),b$g*b$S)}var b$yM=Math.atan2(b$J,b$l)*b$P,b$iM=b$M.resultTransform.skX;180<(b$D=(b$D-b$yM)*b$HM.radDeg+b$o-b$iM)?b$D-=360:b$D<-180&&(b$D+=360),b$M.resultTransform.x=b$V,b$M.resultTransform.y=b$K,b$M.resultTransform.skX=b$M.resultTransform.skY=b$iM+b$D*b$f,b$iM=b$y.resultTransform.skX,180<(b$z=((b$z+b$yM)*b$HM.radDeg-0)*b$P+b$d-(b$iM%=360))?b$z-=360:b$z<-180&&(b$z+=360),b$y.resultTransform.x=b$l,b$y.resultTransform.y=b$J,b$y.resultTransform.skX=b$y.resultTransform.skY=b$y.resultTransform.skY+b$z*b$f,b$M.update()}},b$M._applyIk3=function(b$M,b$y,b$i,b$H,b$S,b$f){if(0!=b$f){var b$V,b$K,b$k=b$y.resultMatrix.a*b$y.length,b$X=b$y.resultMatrix.b*b$y.length,b$F=b$k*b$k+b$X*b$X,b$o=Math.sqrt(b$F),b$d=b$M.resultMatrix.tx,b$P=b$M.resultMatrix.ty,b$l=b$y.resultMatrix.tx,b$J=b$y.resultMatrix.ty,b$h=b$l-b$d,b$C=b$J-b$P,b$v=b$h*b$h+b$C*b$C,b$R=Math.sqrt(b$v),b$A=(b$h=b$i-b$M.resultMatrix.tx)*b$h+(b$C=b$H-b$M.resultMatrix.ty)*b$C,b$G=Math.sqrt(b$A);if(b$o+b$R<=b$G||b$G+b$o<=b$R||b$G+b$R<=b$o){var b$I=NaN;b$l=b$d+(b$I=b$o+b$R<=b$G?1:-1)*(b$i-b$d)*b$R/b$G,b$J=b$P+b$I*(b$H-b$P)*b$R/b$G}else{var b$U=(b$v-b$F+b$A)/(2*b$A),b$Q=Math.sqrt(b$v-b$U*b$U*b$A)/b$G,b$W=b$d+b$h*b$U,b$c=b$P+b$C*b$U,b$n=-b$C*b$Q,b$a=b$h*b$Q;b$J=0<b$S?(b$l=b$W-b$n,b$c-b$a):(b$l=b$W+b$n,b$c+b$a)}b$V=b$l,b$K=b$J,this.isDebug&&(this._sp||(this._sp=new b$fM,b$SM.stage.addChild(this._sp)),this._sp.graphics.clear(),this._sp.graphics.drawCircle(b$d,b$P,15,"#ff00ff"),this._sp.graphics.drawCircle(b$i,b$H,15,"#ffff00"),this._sp.graphics.drawCircle(b$V,b$K,15,"#ff00ff"));var b$T,b$m;b$T=Math.atan2(b$K-b$M.resultMatrix.ty,b$V-b$M.resultMatrix.tx),b$M.setRotation(b$T),(b$m=b$HM._tempMatrix).identity(),b$m.rotate(b$T),b$m.scale(b$M.resultMatrix.getScaleX(),b$M.resultMatrix.getScaleY()),b$m.translate(b$M.resultMatrix.tx,b$M.resultMatrix.ty),b$m.copyTo(b$M.resultMatrix),b$M.updateChild();var b$e,b$s;b$e=Math.atan2(b$H-b$K,b$i-b$V),b$y.setRotation(b$e),(b$s=b$HM._tempMatrix).identity(),b$s.rotate(b$e),b$s.scale(b$y.resultMatrix.getScaleX(),b$y.resultMatrix.getScaleY()),b$s.translate(b$V,b$K),b$m.copyTo(b$y.resultMatrix),b$y.updateChild()}},b$i(b$HM,["radDeg",function(){return this.radDeg=180/Math.PI},"degRad",function(){return this.degRad=Math.PI/180},"_tempMatrix",function(){return this._tempMatrix=new b$mM}]),b$HM}(),b$pM=function(){function b$M(){this.name=null,this.targetBoneName=null,this.bendDirection=1,this.mix=1,this.isSpine=!0,this.targetBoneIndex=-1,this.boneNames=[],this.boneIndexs=[]}return b$H(b$M,"laya.ani.bone.IkConstraintData"),b$M}(),b$G=function(){function b$s(b$M,b$y){this.target=null,this.data=null,this.bones=null,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this._debugKey=!1,this._spaces=null,this._segments=[],this._curves=[],this.data=b$M,this.position=b$M.position,this.spacing=b$M.spacing,this.rotateMix=b$M.rotateMix,this.translateMix=b$M.translateMix,this.bones=[];for(var b$i=this.data.bones,b$H=0,b$S=b$i.length;b$H<b$S;b$H++)this.bones.push(b$y[b$i[b$H]])}b$H(b$s,"laya.ani.bone.PathConstraint");var b$M=b$s.prototype;return b$M.apply=function(b$M,b$y){if(this.target){var b$i=this.translateMix,b$H=this.translateMix,b$S=0<b$H,b$f=this.data.spacingMode,b$V="length"==b$f,b$K=this.data.rotateMode,b$k="tangent"==b$K,b$X="chainScale"==b$K,b$F=[],b$o=this.bones.length,b$d=b$k?b$o:b$o+1,b$P=[];(this._spaces=b$P)[0]=this.position;var b$l=this.spacing;if(b$X||b$V)for(var b$J=0,b$h=b$d-1;b$J<b$h;){var b$C=this.bones[b$J],b$v=b$C.length,b$R=b$v*b$C.resultMatrix.a,b$A=b$v*b$C.resultMatrix.b;b$v=Math.sqrt(b$R*b$R+b$A*b$A),b$X&&(b$F[b$J]=b$v),b$P[++b$J]=b$V?Math.max(0,b$v+b$l):b$l}else for(b$J=1;b$J<b$d;b$J++)b$P[b$J]=b$l;var b$G=this.computeWorldPositions(this.target,b$M,b$y,b$d,b$k,"percent"==this.data.positionMode,"percent"==b$f);if(this._debugKey){for(b$J=0;b$J<b$G.length;b$J++)b$y.drawCircle(b$G[b$J++],b$G[b$J++],5,"#00ff00");var b$I=[];for(b$J=0;b$J<b$G.length;b$J++)b$I.push(b$G[b$J++],b$G[b$J++]);b$y.drawLines(0,0,b$I,"#ff0000")}var b$U=b$G[0],b$Q=b$G[1],b$W=this.data.offsetRotation,b$c="chain"==b$K&&0==b$W,b$n=NaN;for(b$J=0,b$n=3;b$J<b$o;b$J++,b$n+=3){(b$C=this.bones[b$J]).resultMatrix.tx+=(b$U-b$C.resultMatrix.tx)*b$i,b$C.resultMatrix.ty+=(b$Q-b$C.resultMatrix.ty)*b$i;var b$a=(b$R=b$G[b$n])-b$U,b$T=(b$A=b$G[b$n+1])-b$Q;if(b$X&&0!=(b$v=b$F[b$J])){var b$m=(Math.sqrt(b$a*b$a+b$T*b$T)/b$v-1)*b$H+1;b$C.resultMatrix.a*=b$m,b$C.resultMatrix.c*=b$m}if(b$U=b$R,b$Q=b$A,b$S){var b$e=b$C.resultMatrix.a,b$s=b$C.resultMatrix.c,b$D=b$C.resultMatrix.b,b$z=b$C.resultMatrix.d,b$w=NaN,b$q=NaN,b$t=NaN;b$w=b$k?b$G[b$n-1]:0==b$P[b$J+1]?b$G[b$n+2]:Math.atan2(b$T,b$a),b$w-=Math.atan2(b$D,b$e)-b$W/180*Math.PI,b$c&&(b$q=Math.cos(b$w),b$t=Math.sin(b$w),b$U+=((b$v=b$C.length)*(b$q*b$e-b$t*b$D)-b$a)*b$H,b$Q+=(b$v*(b$t*b$e+b$q*b$D)-b$T)*b$H),b$w>Math.PI?b$w-=2*Math.PI:b$w<-Math.PI&&(b$w+=2*Math.PI),b$w*=b$H,b$q=Math.cos(b$w),b$t=Math.sin(b$w),b$C.resultMatrix.a=b$q*b$e-b$t*b$D,b$C.resultMatrix.c=b$q*b$s-b$t*b$z,b$C.resultMatrix.b=b$t*b$e+b$q*b$D,b$C.resultMatrix.d=b$t*b$s+b$q*b$z}}}},b$M.computeWorldVertices2=function(b$M,b$y,b$i,b$H,b$S,b$f){var b$V,b$K,b$k=b$M.currDisplayData.bones,b$X=b$M.currDisplayData.weights,b$F=b$M.currDisplayData.triangles,b$o=0,b$d=0,b$P=0,b$l=0,b$J=0,b$h=0,b$C=0,b$v=0,b$R=0,b$A=0,b$G=0;if(null!=b$k){for(b$o=0;b$o<b$i;b$o+=2)b$d+=(b$l=b$k[b$d])+1,b$P+=b$l;var b$I=b$y;for(b$J=b$f,b$h=3*b$P;b$J<b$H;b$J+=2){for(b$v=b$C=0,b$l=b$k[b$d++],b$l+=b$d;b$d<b$l;b$d++,b$h+=3){b$V=b$I[b$k[b$d]].resultMatrix,b$R=b$X[b$h],b$A=b$X[b$h+1];var b$U=b$X[b$h+2];b$C+=(b$R*b$V.a+b$A*b$V.c+b$V.tx)*b$U,b$v+=(b$R*b$V.b+b$A*b$V.d+b$V.ty)*b$U}b$S[b$J]=b$C,b$S[b$J+1]=b$v}}else{var b$Q,b$W;if(b$F||(b$F=b$X),b$M.deformData&&(b$F=b$M.deformData),b$Q=b$M.parent,b$y)for(b$G=b$y.length,b$o=0;b$o<b$G;b$o++)if(b$y[b$o].name==b$Q){b$K=b$y[b$o];break}b$K&&(b$W=b$K.resultMatrix),b$W||(b$W=b$s._tempMt);var b$c=b$W.tx,b$n=b$W.ty,b$a=b$W.a,b$T=b$W.b,b$m=b$W.c,b$e=b$W.d;for(b$K&&(b$e*=b$K.d),b$d=b$i,b$J=b$f;b$J<b$H;b$d+=2,b$J+=2)b$R=b$F[b$d],b$A=b$F[b$d+1],b$S[b$J]=b$R*b$a+b$A*b$T+b$c,b$S[b$J+1]=-(b$R*b$m+b$A*b$e+b$n)}},b$M.computeWorldPositions=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V){b$M.currDisplayData.bones,b$M.currDisplayData.weights,b$M.currDisplayData.triangles;var b$K=[],b$k=0,b$X=b$M.currDisplayData.verLen,b$F=this.position,b$o=this._spaces,b$d=[],b$P=[],b$l=b$X/6,b$J=-1,b$h=NaN,b$C=0,b$v=0,b$R=NaN,b$A=NaN,b$G=NaN,b$I=NaN;if(b$l--,b$X-=4,this.computeWorldVertices2(b$M,b$y,2,b$X,b$K,0),this._debugKey)for(b$k=0;b$k<b$K.length;)b$i.drawCircle(b$K[b$k++],b$K[b$k++],10,"#ff0000");b$d=b$K,this._curves.length=b$l;var b$U=this._curves,b$Q=b$d[b$h=0],b$W=b$d[1],b$c=0,b$n=0,b$a=0,b$T=0,b$m=0,b$e=0,b$s=NaN,b$D=NaN,b$z=NaN,b$w=NaN,b$q=NaN,b$t=NaN,b$u=NaN,b$p=NaN,b$B=0;for(b$k=0,b$B=2;b$k<b$l;b$k++,b$B+=6)b$c=b$d[b$B],b$n=b$d[b$B+1],b$a=b$d[b$B+2],b$T=b$d[b$B+3],b$q=2*(b$s=.1875*(b$Q-2*b$c+b$a))+(b$z=.09375*(3*(b$c-b$a)-b$Q+(b$m=b$d[b$B+4]))),b$t=2*(b$D=.1875*(b$W-2*b$n+b$T))+(b$w=.09375*(3*(b$n-b$T)-b$W+(b$e=b$d[b$B+5]))),b$u=.75*(b$c-b$Q)+b$s+.16666667*b$z,b$p=.75*(b$n-b$W)+b$D+.16666667*b$w,b$h+=Math.sqrt(b$u*b$u+b$p*b$p),b$u+=b$q,b$p+=b$t,b$q+=b$z,b$t+=b$w,b$h+=Math.sqrt(b$u*b$u+b$p*b$p),b$u+=b$q,b$p+=b$t,b$h+=Math.sqrt(b$u*b$u+b$p*b$p),b$u+=b$q+b$z,b$p+=b$t+b$w,b$h+=Math.sqrt(b$u*b$u+b$p*b$p),b$U[b$k]=b$h,b$Q=b$m,b$W=b$e;if(b$f&&(b$F*=b$h),b$V)for(b$k=0;b$k<b$H;b$k++)b$o[b$k]*=b$h;var b$Z=this._segments,b$E=0,b$_=0;for(b$_=b$v=b$C=b$k=0;b$k<b$H;b$k++,b$C+=3)if((b$R=b$F+=b$A=b$o[b$k])<0)this.addBeforePosition(b$R,b$d,0,b$P,b$C);else if(b$h<b$R)this.addAfterPosition(b$R-b$h,b$d,b$X-4,b$P,b$C);else{for(;;b$v++)if(!((b$I=b$U[b$v])<b$R)){0==b$v?b$R/=b$I:b$R=(b$R-(b$G=b$U[b$v-1]))/(b$I-b$G);break}if(b$v!=b$J){var b$b=6*(b$J=b$v);for(b$Q=b$d[b$b],b$W=b$d[b$b+1],b$c=b$d[b$b+2],b$n=b$d[b$b+3],b$a=b$d[b$b+4],b$T=b$d[b$b+5],b$q=2*(b$s=.03*(b$Q-2*b$c+b$a))+(b$z=.006*(3*(b$c-b$a)-b$Q+(b$m=b$d[b$b+6]))),b$t=2*(b$D=.03*(b$W-2*b$n+b$T))+(b$w=.006*(3*(b$n-b$T)-b$W+(b$e=b$d[b$b+7]))),b$u=.3*(b$c-b$Q)+b$s+.16666667*b$z,b$p=.3*(b$n-b$W)+b$D+.16666667*b$w,b$E=Math.sqrt(b$u*b$u+b$p*b$p),b$Z[0]=b$E,b$b=1;b$b<8;b$b++)b$u+=b$q,b$p+=b$t,b$q+=b$z,b$t+=b$w,b$E+=Math.sqrt(b$u*b$u+b$p*b$p),b$Z[b$b]=b$E;b$u+=b$q,b$p+=b$t,b$E+=Math.sqrt(b$u*b$u+b$p*b$p),b$Z[8]=b$E,b$u+=b$q+b$z,b$p+=b$t+b$w,b$E+=Math.sqrt(b$u*b$u+b$p*b$p),b$Z[9]=b$E,b$_=0}for(b$R*=b$E;;b$_++)if(!((b$I=b$Z[b$_])<b$R)){0==b$_?b$R/=b$I:b$R=b$_+(b$R-(b$G=b$Z[b$_-1]))/(b$I-b$G);break}this.addCurvePosition(.1*b$R,b$Q,b$W,b$c,b$n,b$a,b$T,b$m,b$e,b$P,b$C,b$S||0<b$k&&0==b$A)}return b$P},b$M.addBeforePosition=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$y[b$i],b$V=b$y[b$i+1],b$K=b$y[b$i+2]-b$f,b$k=b$y[b$i+3]-b$V,b$X=Math.atan2(b$k,b$K);b$H[b$S]=b$f+b$M*Math.cos(b$X),b$H[b$S+1]=b$V+b$M*Math.sin(b$X),b$H[b$S+2]=b$X},b$M.addAfterPosition=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$y[b$i+2],b$V=b$y[b$i+3],b$K=b$f-b$y[b$i],b$k=b$V-b$y[b$i+1],b$X=Math.atan2(b$k,b$K);b$H[b$S]=b$f+b$M*Math.cos(b$X),b$H[b$S+1]=b$V+b$M*Math.sin(b$X),b$H[b$S+2]=b$X},b$M.addCurvePosition=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F,b$o){0==b$M&&(b$M=1e-4);var b$d=b$M*b$M,b$P=b$d*b$M,b$l=1-b$M,b$J=b$l*b$l,b$h=b$J*b$l,b$C=b$l*b$M,b$v=3*b$C,b$R=b$l*b$v,b$A=b$v*b$M,b$G=b$y*b$h+b$H*b$R+b$f*b$A+b$K*b$P,b$I=b$i*b$h+b$S*b$R+b$V*b$A+b$k*b$P;b$X[b$F]=b$G,b$X[b$F+1]=b$I,b$X[b$F+2]=b$o?Math.atan2(b$I-(b$i*b$J+b$S*b$C*2+b$V*b$d),b$G-(b$y*b$J+b$H*b$C*2+b$f*b$d)):0},b$s.NONE=-1,b$s.BEFORE=-2,b$s.AFTER=-3,b$i(b$s,["_tempMt",function(){return this._tempMt=new b$mM}]),b$s}(),b$BM=function(){function b$M(){this.name=null,this.target=null,this.positionMode=null,this.spacingMode=null,this.rotateMode=null,this.offsetRotation=NaN,this.position=NaN,this.spacing=NaN,this.rotateMix=NaN,this.translateMix=NaN,this.bones=[]}return b$H(b$M,"laya.ani.bone.PathConstraintData"),b$M}(),b$ZM=function(){function b$M(){this.name=null,this.slotArr=[]}return b$H(b$M,"laya.ani.bone.SkinData"),b$M}(),b$EM=function(){function b$M(){this.name=null,this.attachmentName=null,this.type=0,this.transform=null,this.width=NaN,this.height=NaN,this.texture=null,this.bones=null,this.uvs=null,this.weights=null,this.triangles=null,this.vertices=null,this.lengths=null,this.verLen=0}b$H(b$M,"laya.ani.bone.SkinSlotDisplayData");var b$y=b$M.prototype;return b$y.createTexture=function(b$M){return this.texture||(this.texture=new b$eM(b$M.bitmap,this.uvs),b$M.bitmap.alphaTexture&&(this.texture.alphaTexture=new b$eM(b$M.bitmap.alphaTexture,this.uvs)),this.uvs[0]>this.uvs[4]&&this.uvs[1]>this.uvs[5]?(this.texture.width=b$M.height,this.texture.height=b$M.width,this.texture.offsetX=-b$M.offsetX,this.texture.offsetY=-b$M.offsetY,this.texture.sourceWidth=b$M.sourceHeight,this.texture.sourceHeight=b$M.sourceWidth):(this.texture.width=b$M.width,this.texture.height=b$M.height,this.texture.offsetX=-b$M.offsetX,this.texture.offsetY=-b$M.offsetY,this.texture.sourceWidth=b$M.sourceWidth,this.texture.sourceHeight=b$M.sourceHeight),b$h.isWebGL||this.uvs[1]>this.uvs[5]&&(this.texture.offsetY=this.texture.sourceHeight-this.texture.height-this.texture.offsetY)),this.texture},b$y.destory=function(){this.texture&&this.texture.destroy()},b$M}(),b$_M=function(){function b$M(){this.name=null,this.displayArr=[]}return b$H(b$M,"laya.ani.bone.SlotData"),b$M.prototype.getDisplayByName=function(b$M){for(var b$y=0,b$i=this.displayArr.length;b$y<b$i;b$y++)if(this.displayArr[b$y].attachmentName==b$M)return b$y;return-1},b$M}(),b$I=function(){function b$M(b$M,b$y){this._data=null,this._bones=null,this.target=null,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this._temp=b$J(2,0),this._data=b$M,null==this._bones&&(this._bones=[]),this.target=b$y[b$M.targetIndex];var b$i,b$H=0;for(b$H=0,b$i=b$M.boneIndexs.length;b$H<b$i;b$H++)this._bones.push(b$y[b$M.boneIndexs[b$H]]);this.rotateMix=b$M.rotateMix,this.translateMix=b$M.translateMix,this.scaleMix=b$M.scaleMix,this.shearMix=b$M.shearMix}return b$H(b$M,"laya.ani.bone.TfConstraint"),b$M.prototype.apply=function(){for(var b$M,b$y=this.target.resultMatrix.a,b$i=this.target.resultMatrix.b,b$H=this.target.resultMatrix.c,b$S=this.target.resultMatrix.d,b$f=0,b$V=this._bones.length;b$f<b$V;b$f++){if(b$M=this._bones[b$f],0<this.rotateMix){var b$K=b$M.resultMatrix.a,b$k=b$M.resultMatrix.b,b$X=b$M.resultMatrix.c,b$F=b$M.resultMatrix.d,b$o=Math.atan2(b$H,b$y)-Math.atan2(b$X,b$K)+this._data.offsetRotation*Math.PI/180;b$o>Math.PI?b$o-=2*Math.PI:b$o<-Math.PI&&(b$o+=2*Math.PI),b$o*=this.rotateMix;var b$d=Math.cos(b$o),b$P=Math.sin(b$o);b$M.resultMatrix.a=b$d*b$K-b$P*b$X,b$M.resultMatrix.b=b$d*b$k-b$P*b$F,b$M.resultMatrix.c=b$P*b$K+b$d*b$X,b$M.resultMatrix.d=b$P*b$k+b$d*b$F}if(this.translateMix&&(this._temp[0]=this._data.offsetX,this._temp[1]=this._data.offsetY,this.target.localToWorld(this._temp),b$M.resultMatrix.tx+=(this._temp[0]-b$M.resultMatrix.tx)*this.translateMix,b$M.resultMatrix.ty+=(this._temp[1]-b$M.resultMatrix.ty)*this.translateMix,b$M.updateChild()),0<this.scaleMix){var b$l=Math.sqrt(b$M.resultMatrix.a*b$M.resultMatrix.a+b$M.resultMatrix.c*b$M.resultMatrix.c),b$J=Math.sqrt(b$y*b$y+b$H*b$H),b$h=1e-5<b$l?(b$l+(b$J-b$l+this._data.offsetScaleX)*this.scaleMix)/b$l:0;b$M.resultMatrix.a*=b$h,b$M.resultMatrix.c*=b$h,b$l=Math.sqrt(b$M.resultMatrix.b*b$M.resultMatrix.b+b$M.resultMatrix.d*b$M.resultMatrix.d),b$J=Math.sqrt(b$i*b$i+b$S*b$S),b$h=1e-5<b$l?(b$l+(b$J-b$l+this._data.offsetScaleY)*this.scaleMix)/b$l:0,b$M.resultMatrix.b*=b$h,b$M.resultMatrix.d*=b$h}if(0<this.shearMix){b$k=b$M.resultMatrix.b,b$F=b$M.resultMatrix.d;var b$C=Math.atan2(b$F,b$k);(b$o=Math.atan2(b$S,b$i)-Math.atan2(b$H,b$y)-(b$C-Math.atan2(b$M.resultMatrix.c,b$M.resultMatrix.a)))>Math.PI?b$o-=2*Math.PI:b$o<-Math.PI&&(b$o+=2*Math.PI),b$o=b$C+(b$o+this._data.offsetShearY*Math.PI/180)*this.shearMix,b$h=Math.sqrt(b$k*b$k+b$F*b$F),b$M.resultMatrix.b=Math.cos(b$o)*b$h,b$M.resultMatrix.d=Math.sin(b$o)*b$h}}},b$M}(),b$bM=function(){function b$M(){this.name=null,this.targetIndex=0,this.rotateMix=NaN,this.translateMix=NaN,this.scaleMix=NaN,this.shearMix=NaN,this.offsetRotation=NaN,this.offsetX=NaN,this.offsetY=NaN,this.offsetScaleX=NaN,this.offsetScaleY=NaN,this.offsetShearY=NaN,this.boneIndexs=[]}return b$H(b$M,"laya.ani.bone.TfConstraintData"),b$M}(),b$YM=function(){function b$M(){this.skX=0,this.skY=0,this.scX=1,this.scY=1,this.x=0,this.y=0,this.skewX=0,this.skewY=0,this.mMatrix=null}b$H(b$M,"laya.ani.bone.Transform");var b$y=b$M.prototype;return b$y.initData=function(b$M){null!=b$M.x&&(this.x=b$M.x),null!=b$M.y&&(this.y=b$M.y),null!=b$M.skX&&(this.skX=b$M.skX),null!=b$M.skY&&(this.skY=b$M.skY),null!=b$M.scX&&(this.scX=b$M.scX),null!=b$M.scY&&(this.scY=b$M.scY)},b$y.getMatrix=function(){var b$M;return(b$M=this.mMatrix?this.mMatrix:this.mMatrix=new b$mM).identity(),b$M.scale(this.scX,this.scY),(this.skewX||this.skewY)&&this.skew(b$M,this.skewX*Math.PI/180,this.skewY*Math.PI/180),b$M.rotate(this.skX*Math.PI/180),b$M.translate(this.x,this.y),b$M},b$y.skew=function(b$M,b$y,b$i){var b$H=Math.sin(b$i),b$S=Math.cos(b$i),b$f=Math.sin(b$y),b$V=Math.cos(b$y);return b$M.setTo(b$M.a*b$V-b$M.b*b$H,b$M.a*b$f+b$M.b*b$S,b$M.c*b$V-b$M.d*b$H,b$M.c*b$f+b$M.d*b$S,b$M.tx*b$V-b$M.ty*b$H,b$M.tx*b$f+b$M.ty*b$S),b$M},b$M}(),b$U=function(){function b$M(){}return b$H(b$M,"laya.ani.bone.UVTools"),b$M.getRelativeUV=function(b$M,b$y,b$i){var b$H=b$M[0],b$S=b$M[2]-b$M[0],b$f=b$M[1],b$V=b$M[5]-b$M[1];b$i||(b$i=[]),b$i.length=b$y.length;var b$K,b$k=0;b$K=b$i.length;var b$X=1/b$S,b$F=1/b$V;for(b$k=0;b$k<b$K;b$k+=2)b$i[b$k]=(b$y[b$k]-b$H)*b$X,b$i[b$k+1]=(b$y[b$k+1]-b$f)*b$F;return b$i},b$M.getAbsoluteUV=function(b$M,b$y,b$i){if(0==b$M[0]&&0==b$M[1]&&1==b$M[4]&&1==b$M[5])return b$i?(b$C.copyArray(b$i,b$y),b$i):b$y;var b$H=b$M[0],b$S=b$M[2]-b$M[0],b$f=b$M[1],b$V=b$M[5]-b$M[1];b$i||(b$i=[]),b$i.length=b$y.length;var b$K,b$k=0;for(b$K=b$i.length,b$k=0;b$k<b$K;b$k+=2)b$i[b$k]=b$y[b$k]*b$S+b$H,b$i[b$k+1]=b$y[b$k+1]*b$V+b$f;return b$i},b$M}(),b$s=function(){function b$M(){this.startTime=NaN,this.duration=NaN,this.interpolationData=null,this.data=null,this.nextData=null}return b$H(b$M,"laya.ani.KeyFramesContent"),b$M}(),b$Q=function(){function b$F(){}return b$H(b$F,"laya.ani.math.BezierLerp"),b$F.getBezierRate=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$F._getBezierParamKey(b$y,b$i,b$H,b$S),b$V=100*b$f+b$M;if(b$F._bezierResultCache[b$V])return b$F._bezierResultCache[b$V];var b$K,b$k=b$F._getBezierPoints(b$y,b$i,b$H,b$S,b$f),b$X=0;for(b$K=b$k.length,b$X=0;b$X<b$K;b$X+=2)if(b$M<=b$k[b$X])return b$F._bezierResultCache[b$V]=b$k[b$X+1],b$k[b$X+1];return b$F._bezierResultCache[b$V]=1},b$F._getBezierParamKey=function(b$M,b$y,b$i,b$H){return 100*(100*(100*(100*b$M+b$y)+b$i)+b$H)},b$F._getBezierPoints=function(b$M,b$y,b$i,b$H,b$S){return b$F._bezierPointsCache[b$S]?b$F._bezierPointsCache[b$S]:(b$f=[0,0,b$M,b$y,b$i,b$H,1,1],b$V=(new b$K).getBezierPoints(b$f,100,3),b$F._bezierPointsCache[b$S]=b$V);var b$f,b$V},b$F._bezierResultCache={},b$F._bezierPointsCache={},b$F}(),b$W=function(b$M){function b$y(){this._destroyed=!1,this._templet=null,this._currentTime=NaN,this._currentFrameTime=NaN,this._playStart=NaN,this._playEnd=NaN,this._playDuration=NaN,this._overallDuration=NaN,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=NaN,this._startUpdateLoopCount=NaN,this._currentAnimationClipIndex=0,this._currentKeyframeIndex=0,this._paused=!1,this._cacheFrameRate=0,this._cacheFrameRateInterval=NaN,this._cachePlayRate=NaN,this._fullFrames=null,this.isCache=!0,this.playbackRate=1,this.returnToZeroStopped=!1,b$y.__super.call(this),this._destroyed=!1,this._currentAnimationClipIndex=-1,this._currentKeyframeIndex=-1,this._currentTime=0,this._overallDuration=Number.MAX_VALUE,this._stopWhenCircleFinish=!1,this._elapsedPlaybackTime=0,this._startUpdateLoopCount=-1,this._cachePlayRate=1,this.cacheFrameRate=60,this.returnToZeroStopped=!1}b$H(b$y,"laya.ani.AnimationPlayer",b$S);var b$i=b$y.prototype;return b$SM.imps(b$i,{"laya.resource.IDestroy":!0}),b$i._onTempletLoadedComputeFullKeyframeIndices=function(b$M,b$y,b$i){this._templet===b$i&&this._cachePlayRate===b$M&&this._cacheFrameRate===b$y&&this._computeFullKeyframeIndices()},b$i._computeFullKeyframeIndices=function(){for(var b$M=this._fullFrames=[],b$y=this._templet,b$i=this._cacheFrameRateInterval*this._cachePlayRate,b$H=0,b$S=b$y.getAnimationCount();b$H<b$S;b$H++){for(var b$f=[],b$V=0,b$K=b$y.getAnimation(b$H).nodes.length;b$V<b$K;b$V++){for(var b$k=b$y.getAnimation(b$H).nodes[b$V],b$X=Math.floor(b$k.playTime/b$i+.01),b$F=new Uint16Array(b$X+1),b$o=-1,b$d=0,b$P=b$k.keyFrame.length;b$d<b$P;b$d++){var b$l=b$k.keyFrame[b$d],b$J=b$l.startTime,b$h=b$J+b$l.duration+b$i;do{for(var b$C=Math.floor(b$J/b$i+.5),b$v=b$o+1;b$v<b$C;b$v++)b$F[b$v]=b$d;b$F[b$o=b$C]=b$d,b$J+=b$i}while(b$J<=b$h)}b$f.push(b$F)}b$M.push(b$f)}},b$i._onAnimationTempletLoaded=function(){this.destroyed||this._calculatePlayDuration()},b$i._calculatePlayDuration=function(){if(0!==this.state){var b$M=this._templet.getAniDuration(this._currentAnimationClipIndex);0===this._playEnd&&(this._playEnd=b$M),this._playEnd>b$M&&(this._playEnd=b$M),this._playDuration=this._playEnd-this._playStart}},b$i._setPlayParams=function(b$M,b$y){this._currentTime=b$M,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/b$y+.01),0),this._currentFrameTime=this._currentKeyframeIndex*b$y},b$i._setPlayParamsWhenStop=function(b$M,b$y){this._currentTime=b$M,this._currentKeyframeIndex=Math.max(Math.floor(b$M/b$y+.01),0),this._currentFrameTime=this._currentKeyframeIndex*b$y,this._currentAnimationClipIndex=-1},b$i._update=function(b$M){if(-1!==this._currentAnimationClipIndex&&!this._paused&&this._templet&&this._templet.loaded){var b$y=this._cacheFrameRateInterval*this._cachePlayRate,b$i=0;this._startUpdateLoopCount!==b$l.loopCount&&(b$i=b$M*this.playbackRate,this._elapsedPlaybackTime+=b$i);var b$H=this.playDuration;if(0!==this._overallDuration&&this._elapsedPlaybackTime>=this._overallDuration||0===this._overallDuration&&this._elapsedPlaybackTime>=b$H)return this._setPlayParamsWhenStop(b$H,b$y),void this.event("stopped");if(b$i+=this._currentTime,0<b$H)if(b$H<=b$i)do{if(b$i-=b$H,this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(b$H,b$y),this._stopWhenCircleFinish=!1,void this.event("stopped");b$i<b$H&&(this._setPlayParams(b$i,b$y),this.event("complete"))}while(b$H<=b$i);else this._setPlayParams(b$i,b$y);else{if(this._stopWhenCircleFinish)return this._setPlayParamsWhenStop(b$H,b$y),this._stopWhenCircleFinish=!1,void this.event("stopped");this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this.event("complete")}}},b$i._destroy=function(){this.offAll(),this._templet=null,this._fullFrames=null,this._destroyed=!0},b$i.play=function(b$M,b$y,b$i,b$H,b$S){if(void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=1),void 0===b$i&&(b$i=2147483647),void 0===b$H&&(b$H=0),void 0===b$S&&(b$S=0),!this._templet)throw new Error("AnimationPlayer:templet must not be null,maybe you need to set url.");if(b$i<0||b$H<0||b$S<0)throw new Error("AnimationPlayer:overallDuration,playStart and playEnd must large than zero.");if(0!==b$S&&b$S<b$H)throw new Error("AnimationPlayer:start must less than end.");this._currentTime=0,this._currentFrameTime=0,this._elapsedPlaybackTime=0,this.playbackRate=b$y,this._overallDuration=b$i,this._playStart=b$H,this._playEnd=b$S,this._paused=!1,this._currentAnimationClipIndex=b$M,this._currentKeyframeIndex=0,this._startUpdateLoopCount=b$l.loopCount,this.event("played"),this._templet.loaded?this._calculatePlayDuration():this._templet.once("loaded",this,this._onAnimationTempletLoaded),this._update(0)},b$i.playByFrame=function(b$M,b$y,b$i,b$H,b$S,b$f){void 0===b$M&&(b$M=0),void 0===b$y&&(b$y=1),void 0===b$i&&(b$i=2147483647),void 0===b$H&&(b$H=0),void 0===b$S&&(b$S=0),void 0===b$f&&(b$f=30);var b$V=1e3/b$f;this.play(b$M,b$y,b$i,b$H*b$V,b$S*b$V)},b$i.stop=function(b$M){void 0===b$M&&(b$M=!0),b$M?(this._currentTime=this._currentFrameTime=this._currentKeyframeIndex=0,this._currentAnimationClipIndex=-1,this.event("stopped")):this._stopWhenCircleFinish=!0},b$f(0,b$i,"playEnd",function(){return this._playEnd}),b$f(0,b$i,"templet",function(){return this._templet},function(b$M){0===!this.state&&this.stop(!0),this._templet!==b$M&&((this._templet=b$M).loaded?this._computeFullKeyframeIndices():b$M.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,this._cacheFrameRate]))}),b$f(0,b$i,"playStart",function(){return this._playStart}),b$f(0,b$i,"playDuration",function(){return this._playDuration}),b$f(0,b$i,"state",function(){return-1===this._currentAnimationClipIndex?0:this._paused?1:2}),b$f(0,b$i,"currentKeyframeIndex",function(){return this._currentKeyframeIndex}),b$f(0,b$i,"overallDuration",function(){return this._overallDuration}),b$f(0,b$i,"currentFrameTime",function(){return this._currentFrameTime}),b$f(0,b$i,"currentAnimationClipIndex",function(){return this._currentAnimationClipIndex}),b$f(0,b$i,"currentPlayTime",function(){return this._currentTime+this._playStart}),b$f(0,b$i,"cachePlayRate",function(){return this._cachePlayRate},function(b$M){this._cachePlayRate!==b$M&&(this._cachePlayRate=b$M,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[b$M,this._cacheFrameRate])))}),b$f(0,b$i,"cacheFrameRate",function(){return this._cacheFrameRate},function(b$M){this._cacheFrameRate!==b$M&&(this._cacheFrameRate=b$M,this._cacheFrameRateInterval=1e3/this._cacheFrameRate,this._templet&&(this._templet.loaded?this._computeFullKeyframeIndices():this._templet.once("loaded",this,this._onTempletLoadedComputeFullKeyframeIndices,[this._cachePlayRate,b$M])))}),b$f(0,b$i,"currentTime",null,function(b$M){if(-1!==this._currentAnimationClipIndex&&this._templet&&this._templet.loaded){if(b$M<this._playStart||b$M>this._playEnd)throw new Error("AnimationPlayer:value must large than playStartTime,small than playEndTime.");this._startUpdateLoopCount=b$l.loopCount;var b$y=this._cacheFrameRateInterval*this._cachePlayRate;this._currentTime=b$M,this._currentKeyframeIndex=Math.max(Math.floor(this.currentPlayTime/b$y),0),this._currentFrameTime=this._currentKeyframeIndex*b$y}}),b$f(0,b$i,"paused",function(){return this._paused},function(b$M){(this._paused=b$M)&&this.event("paused")}),b$f(0,b$i,"cacheFrameRateInterval",function(){return this._cacheFrameRateInterval}),b$f(0,b$i,"destroyed",function(){return this._destroyed}),b$y}(),b$D=function(b$M){function b$y(){b$y.__super.call(this),b$h.isConchNode&&(this.drawSkin=function(b$M){b$M.transform||(b$M.transform=b$mM.EMPTY),this._addCmd([b$M]),this.setSkinMesh&&this.setSkinMesh(b$M._ps,b$M.mVBData,b$M.mEleNum,0,b$M.mTexture,b$M.transform)})}return b$H(b$y,"laya.ani.GraphicsAni",b$V),b$y.prototype.drawSkin=function(b$M){var b$y=[b$M];this._saveToCmd(b$h._context._drawSkin,b$y)},b$y.create=function(){return b$y._caches.pop()||new b$y},b$y.recycle=function(b$M){b$M.clear(),b$y._caches.push(b$M)},b$y._caches=[],b$y}(),b$z=function(b$M){function b$v(){this._aniMap={},this.unfixedLastAniIndex=-1,b$v.__super.call(this),this._anis=new Array}b$H(b$v,"laya.ani.AnimationTemplet",b$F);var b$y=b$v.prototype;return b$y.parse=function(b$M){var b$y=new b$TM(b$M);this._aniVersion=b$y.readUTFString(),b$R.parse(this,b$y)},b$y._calculateKeyFrame=function(b$M,b$y,b$i){var b$H=b$M.keyFrame;b$H[b$y]=b$H[0];for(var b$S=0;b$S<b$y;b$S++){var b$f=b$H[b$S];b$f.nextData=0===b$f.duration?b$f.data:b$H[b$S+1].data}b$H.length--},b$y.onAsynLoaded=function(b$M,b$y,b$i){var b$H=new b$TM(b$y);switch(this._aniVersion=b$H.readUTFString(),this._aniVersion){case"LAYAANIMATION:02":b$A.parse(this,b$H);break;default:b$R.parse(this,b$H)}this._endLoaded()},b$y.disposeResource=function(){this._aniVersion=null,this._anis=null,this._aniMap=null,this._publicExtData=null,this.unfixedCurrentFrameIndexes=null,this.unfixedCurrentTimes=null,this.unfixedKeyframes=null,this._aniClassName=null,this._animationDatasCache=null},b$y.getAnimationCount=function(){return this._anis.length},b$y.getAnimation=function(b$M){return this._anis[b$M]},b$y.getAniDuration=function(b$M){return this._anis[b$M].playTime},b$y.getNodes=function(b$M){return this._anis[b$M].nodes},b$y.getNodeIndexWithName=function(b$M,b$y){return this._anis[b$M].bone3DMap[b$y]},b$y.getNodeCount=function(b$M){return this._anis[b$M].nodes.length},b$y.getTotalkeyframesLength=function(b$M){return this._anis[b$M].totalKeyframeDatasLength},b$y.getPublicExtData=function(){return this._publicExtData},b$y.getAnimationDataWithCache=function(b$M,b$y,b$i,b$H){var b$S=b$y[b$i];if(b$S){var b$f=b$S[b$M];return b$f?b$f[b$H]:null}return null},b$y.setAnimationDataWithCache=function(b$M,b$y,b$i,b$H,b$S){var b$f=b$y[b$i]||(b$y[b$i]={});(b$f[b$M]||(b$f[b$M]=[]))[b$H]=b$S},b$y.getOriginalData=function(b$M,b$y,b$i,b$H,b$S){for(var b$f=this._anis[b$M].nodes,b$V=0,b$K=0,b$k=b$f.length,b$X=0;b$K<b$k;b$K++){var b$F,b$o=b$f[b$K];b$F=b$o.keyFrame[b$i[b$K][b$H]],b$o.dataOffset=b$X;var b$d=b$S-b$F.startTime,b$P=b$o.lerpType;if(b$P)switch(b$P){case 0:case 1:for(b$V=0;b$V<b$o.keyframeWidth;)b$V+=b$o.interpolationMethod[b$V](b$o,b$V,b$y,b$X+b$V,b$F.data,b$d,null,b$F.duration,b$F.nextData);break;case 2:var b$l=b$F.interpolationData,b$J=b$l.length,b$h=0;for(b$V=0;b$V<b$J;){var b$C=b$l[b$V];switch(b$C){case 6:case 7:b$V+=b$v.interpolation[b$C](b$o,b$h,b$y,b$X+b$h,b$F.data,b$d,null,b$F.duration,b$F.nextData,b$l,b$V+1);break;default:b$V+=b$v.interpolation[b$C](b$o,b$h,b$y,b$X+b$h,b$F.data,b$d,null,b$F.duration,b$F.nextData)}b$h++}}else for(b$V=0;b$V<b$o.keyframeWidth;)b$V+=b$o.interpolationMethod[b$V](b$o,b$V,b$y,b$X+b$V,b$F.data,b$d,null,b$F.duration,b$F.nextData);b$X+=b$o.keyframeWidth}},b$y.getNodesCurrentFrameIndex=function(b$M,b$y){var b$i=this._anis[b$M].nodes;b$M!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(b$i.length),this.unfixedCurrentTimes=new Float32Array(b$i.length),this.unfixedLastAniIndex=b$M);for(var b$H=0,b$S=b$i.length;b$H<b$S;b$H++){var b$f=b$i[b$H];for(b$y<this.unfixedCurrentTimes[b$H]&&(this.unfixedCurrentFrameIndexes[b$H]=0),this.unfixedCurrentTimes[b$H]=b$y;this.unfixedCurrentFrameIndexes[b$H]<b$f.keyFrame.length&&!(b$f.keyFrame[this.unfixedCurrentFrameIndexes[b$H]].startTime>this.unfixedCurrentTimes[b$H]);)this.unfixedCurrentFrameIndexes[b$H]++;this.unfixedCurrentFrameIndexes[b$H]--}return this.unfixedCurrentFrameIndexes},b$y.getOriginalDataUnfixedRate=function(b$M,b$y,b$i){var b$H=this._anis[b$M].nodes;b$M!==this.unfixedLastAniIndex&&(this.unfixedCurrentFrameIndexes=new Uint32Array(b$H.length),this.unfixedCurrentTimes=new Float32Array(b$H.length),this.unfixedKeyframes=b$J(b$H.length),this.unfixedLastAniIndex=b$M);for(var b$S=0,b$f=0,b$V=b$H.length,b$K=0;b$f<b$V;b$f++){var b$k=b$H[b$f];for(b$i<this.unfixedCurrentTimes[b$f]&&(this.unfixedCurrentFrameIndexes[b$f]=0),this.unfixedCurrentTimes[b$f]=b$i;this.unfixedCurrentFrameIndexes[b$f]<b$k.keyFrame.length&&!(b$k.keyFrame[this.unfixedCurrentFrameIndexes[b$f]].startTime>this.unfixedCurrentTimes[b$f]);)this.unfixedKeyframes[b$f]=b$k.keyFrame[this.unfixedCurrentFrameIndexes[b$f]],this.unfixedCurrentFrameIndexes[b$f]++;var b$X=this.unfixedKeyframes[b$f];b$k.dataOffset=b$K;var b$F=b$i-b$X.startTime;if(b$k.lerpType)switch(b$k.lerpType){case 0:case 1:for(b$S=0;b$S<b$k.keyframeWidth;)b$S+=b$k.interpolationMethod[b$S](b$k,b$S,b$y,b$K+b$S,b$X.data,b$F,null,b$X.duration,b$X.nextData);break;case 2:var b$o=b$X.interpolationData,b$d=b$o.length,b$P=0;for(b$S=0;b$S<b$d;){var b$l=b$o[b$S];switch(b$l){case 6:case 7:b$S+=b$v.interpolation[b$l](b$k,b$P,b$y,b$K+b$P,b$X.data,b$F,null,b$X.duration,b$X.nextData,b$o,b$S+1);break;default:b$S+=b$v.interpolation[b$l](b$k,b$P,b$y,b$K+b$P,b$X.data,b$F,null,b$X.duration,b$X.nextData)}b$P++}}else for(b$S=0;b$S<b$k.keyframeWidth;)b$S+=b$k.interpolationMethod[b$S](b$k,b$S,b$y,b$K+b$S,b$X.data,b$F,null,b$X.duration,b$X.nextData);b$K+=b$k.keyframeWidth}},b$v._LinearInterpolation_0=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){var b$F=0===b$K?0:b$f/b$K;return b$i[b$H]=(1-b$F)*b$S[b$y]+b$F*b$k[b$y],1},b$v._QuaternionInterpolation_1=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){var b$F=0===b$K?0:b$f/b$K;return b$d.slerpQuaternionArray(b$S,b$y,b$k,b$y,b$F,b$i,b$H),4},b$v._AngleInterpolation_2=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){return 0},b$v._RadiansInterpolation_3=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){return 0},b$v._Matrix4x4Interpolation_4=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){for(var b$F=0;b$F<16;b$F++,b$y++)b$i[b$H+b$F]=b$S[b$y]+b$f*b$V[b$y];return 16},b$v._NoInterpolation_5=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X){return b$i[b$H]=b$S[b$y],1},b$v._BezierInterpolation_6=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F){return void 0===b$F&&(b$F=0),b$i[b$H]=b$S[b$y]+(b$k[b$y]-b$S[b$y])*b$Q.getBezierRate(b$f/b$K,b$X[b$F],b$X[b$F+1],b$X[b$F+2],b$X[b$F+3]),5},b$v._BezierInterpolation_7=function(b$M,b$y,b$i,b$H,b$S,b$f,b$V,b$K,b$k,b$X,b$F){return void 0===b$F&&(b$F=0),b$i[b$H]=b$X[b$F+4]+b$X[b$F+5]*b$Q.getBezierRate((.001*b$f+b$X[b$F+6])/b$X[b$F+7],b$X[b$F],b$X[b$F+1],b$X[b$F+2],b$X[b$F+3]),9},b$v.load=function(b$M){return b$SM.loader.create(b$M,null,null,b$v)},b$v.interpolation=[b$v._LinearInterpolation_0,b$v._QuaternionInterpolation_1,b$v._AngleInterpolation_2,b$v._RadiansInterpolation_3,b$v._Matrix4x4Interpolation_4,b$v._NoInterpolation_5,b$v._BezierInterpolation_6,b$v._BezierInterpolation_7],b$v}(),b$c=function(b$y){function b$i(b$M,b$y){this._templet=null,this._player=null,this._curOriginalData=null,this._boneMatrixArray=[],this._lastTime=0,this._currAniName=null,this._currAniIndex=-1,this._pause=!0,this._aniClipIndex=-1,this._clipIndex=-1,this._skinIndex=0,this._skinName="default",this._aniMode=0,this._graphicsCache=null,this._boneSlotDic=null,this._bindBoneBoneSlotDic=null,this._boneSlotArray=null,this._index=-1,this._total=-1,this._indexControl=!1,this._aniPath=null,this._texturePath=null,this._complete=null,this._loadAniMode=0,this._yReverseMatrix=null,this._ikArr=null,this._tfArr=null,this._pathDic=null,this._rootBone=null,this._boneList=null,this._aniSectionDic=null,this._eventIndex=0,this._drawOrderIndex=0,this._drawOrder=null,this._lastAniClipIndex=-1,this._lastUpdateAniClipIndex=-1,b$i.__super.call(this),void 0===b$y&&(b$y=0),b$M&&this.init(b$M,b$y)}b$H(b$i,"laya.ani.bone.Skeleton",b$y);var b$M=b$i.prototype;return b$M.init=function(b$M,b$y){void 0===b$y&&(b$y=0);var b$i,b$H,b$S,b$f=0,b$V=0;if(1==b$y)for(this._graphicsCache=[],b$f=0,b$V=b$M.getAnimationCount();b$f<b$V;b$f++)this._graphicsCache.push([]);if(this._yReverseMatrix=b$M.yReverseMatrix,this._aniMode=b$y,this._templet=b$M,this._player=new b$W,this._player.cacheFrameRate=b$M.rate,this._player.templet=b$M,this._player.play(),this._parseSrcBoneMatrix(),this._boneList=b$M.mBoneArr,this._rootBone=b$M.mRootBone,this._aniSectionDic=b$M.aniSectionDic,0<b$M.ikArr.length)for(this._ikArr=[],b$f=0,b$V=b$M.ikArr.length;b$f<b$V;b$f++)this._ikArr.push(new b$v(b$M.ikArr[b$f],this._boneList));if(0<b$M.pathArr.length)for(null==this._pathDic&&(this._pathDic={}),b$f=0,b$V=b$M.pathArr.length;b$f<b$V;b$f++)b$i=b$M.pathArr[b$f],b$H=new b$G(b$i,this._boneList),(b$S=this._boneSlotDic[b$i.name])&&((b$H=new b$G(b$i,this._boneList)).target=b$S),this._pathDic[b$i.name]=b$H;if(0<b$M.tfArr.length)for(this._tfArr=[],b$f=0,b$V=b$M.tfArr.length;b$f<b$V;b$f++)this._tfArr.push(new b$I(b$M.tfArr[b$f],this._boneList));if(0<b$M.skinDataArray.length){var b$K=this._templet.skinDataArray[this._skinIndex];this._skinName=b$K.name}this._player.on("played",this,this._onPlay),this._player.on("stopped",this,this._onStop),this._player.on("paused",this,this._onPause)},b$M.load=function(b$M,b$y,b$i){},b$M._onLoaded=function(){},b$M._parseComplete=function(){var b$M=b$n.TEMPLET_DICTIONARY[this._aniPath];b$M&&(this.init(b$M,this._loadAniMode),this.play(0,!0)),this._complete&&this._complete.runWith(this)},b$M._parseFail=function(){console.error("[Error]:"+this._aniPath+"解析失败")},b$M._onPlay=function(){this.event("played")},b$M._onStop=function(){var b$M,b$y=this._templet.eventAniArr[this._aniClipIndex];if(b$y&&this._eventIndex<b$y.length)for(;this._eventIndex<b$y.length;this._eventIndex++)(b$M=b$y[this._eventIndex]).time>=this._player.playStart&&b$M.time<=this._player.playEnd&&this.event("label",b$M);this._eventIndex=0,this._drawOrder=null,this.event("stopped")},b$M._onPause=function(){this.event("paused")},b$M._parseSrcBoneMatrix=function(){var b$M=0,b$y=0;for(b$y=this._templet.srcBoneMatrixArr.length,b$M=0;b$M<b$y;b$M++)this._boneMatrixArray.push(new b$mM);if(0==this._aniMode)this._boneSlotDic=this._templet.boneSlotDic,this._bindBoneBoneSlotDic=this._templet.bindBoneBoneSlotDic,this._boneSlotArray=this._templet.boneSlotArray;else{null==this._boneSlotDic&&(this._boneSlotDic={}),null==this._bindBoneBoneSlotDic&&(this._bindBoneBoneSlotDic={}),null==this._boneSlotArray&&(this._boneSlotArray=[]);var b$i,b$H,b$S=this._templet.boneSlotArray;for(b$M=0,b$y=b$S.length;b$M<b$y;b$M++)b$i=b$S[b$M],null==(b$H=this._bindBoneBoneSlotDic[b$i.parent])&&(this._bindBoneBoneSlotDic[b$i.parent]=b$H=[]),this._boneSlotDic[b$i.name]=b$i=b$i.copy(),b$H.push(b$i),this._boneSlotArray.push(b$i)}},b$M._emitMissedEvents=function(b$M,b$y,b$i){void 0===b$i&&(b$i=0);var b$H=this._templet.eventAniArr[this._player.currentAnimationClipIndex];if(b$H){var b$S,b$f,b$V=0;for(b$S=b$H.length,b$V=b$i;b$V<b$S;b$V++)(b$f=b$H[b$V]).time>=this._player.playStart&&b$f.time<=this._player.playEnd&&this.event("label",b$f)}},b$M._update=function(b$M){if(void 0===b$M&&(b$M=!0),!(this._pause||b$M&&this._indexControl)){var b$y=this.timer.currTimer,b$i=this._player.currentKeyframeIndex,b$H=b$y-this._lastTime;if(b$M?this._player._update(b$H):b$i=-1,this._lastTime=b$y,this._player&&(this._index=this._clipIndex=this._player.currentKeyframeIndex,!(this._index<0||0<b$H&&this._clipIndex==b$i&&this._lastUpdateAniClipIndex==this._aniClipIndex))){var b$S;this._lastUpdateAniClipIndex=this._aniClipIndex,b$i>this._clipIndex&&0!=this._eventIndex&&(this._emitMissedEvents(this._player.playStart,this._player.playEnd,this._eventIndex),this._eventIndex=0);var b$f,b$V=this._templet.eventAniArr[this._aniClipIndex];if(b$V&&this._eventIndex<b$V.length&&((b$S=b$V[this._eventIndex]).time>=this._player.playStart&&b$S.time<=this._player.playEnd?this._player.currentPlayTime>=b$S.time&&(this.event("label",b$S),this._eventIndex++):this._eventIndex++),0==this._aniMode){if(b$f=this._templet.getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=b$f&&(this.graphics=b$f));var b$K=0,b$k=0;for(b$k=this._clipIndex;!this._templet.getGrahicsDataWithCache(this._aniClipIndex,b$k-1)&&0<b$k;)b$k--;if(b$k<this._clipIndex)for(b$K=b$k;b$K<this._clipIndex;b$K++)this._createGraphics(b$K)}else if(1==this._aniMode){if(b$f=this._getGrahicsDataWithCache(this._aniClipIndex,this._clipIndex))return void(this.graphics!=b$f&&(this.graphics=b$f));for(b$k=this._clipIndex;!this._getGrahicsDataWithCache(this._aniClipIndex,b$k-1)&&0<b$k;)b$k--;if(b$k<this._clipIndex)for(b$K=b$k;b$K<this._clipIndex;b$K++)this._createGraphics(b$K)}this._createGraphics()}}},b$M._createGraphics=function(b$M){void 0===b$M&&(b$M=-1),-1==b$M&&(b$M=this._clipIndex);var b$y,b$i,b$H=b$M*this._player.cacheFrameRateInterval,b$S=this._templet.drawOrderAniArr[this._aniClipIndex];if(b$S&&0<b$S.length)for(this._drawOrderIndex=0,b$y=b$S[this._drawOrderIndex];b$H>=b$y.time&&(this._drawOrder=b$y.drawOrder,this._drawOrderIndex++,!(this._drawOrderIndex>=b$S.length));)b$y=b$S[this._drawOrderIndex];0==this._aniMode||1==this._aniMode?this.graphics=b$D.create():this.graphics instanceof laya.ani.GraphicsAni?this.graphics.clear():this.graphics=b$D.create(),b$i=this.graphics;var b$f=this._templet.getNodes(this._aniClipIndex);this._templet.getOriginalData(this._aniClipIndex,this._curOriginalData,this._player._fullFrames[this._aniClipIndex],b$M,b$H);var b$V,b$K,b$k,b$X,b$F=this._aniSectionDic[this._aniClipIndex],b$o=0,b$d=0,b$P=0,b$l=0,b$J=0,b$h=this._templet.srcBoneMatrixArr.length;for(b$J=b$F[b$d=0];b$d<b$h;b$d++)b$X=this._boneList[b$d],b$k=this._templet.srcBoneMatrixArr[b$d],b$X.resultTransform.scX=b$k.scX*this._curOriginalData[b$o++],b$X.resultTransform.skX=b$k.skX+this._curOriginalData[b$o++],b$X.resultTransform.skY=b$k.skY+this._curOriginalData[b$o++],b$X.resultTransform.scY=b$k.scY*this._curOriginalData[b$o++],b$X.resultTransform.x=b$k.x+this._curOriginalData[b$o++],b$X.resultTransform.y=b$k.y+this._curOriginalData[b$o++],8===this._templet.tMatrixDataLen&&(b$X.resultTransform.skewX=b$k.skewX+this._curOriginalData[b$o++],b$X.resultTransform.skewY=b$k.skewY+this._curOriginalData[b$o++]);var b$C,b$v={},b$R={};for(b$J+=b$F[1];b$d<b$J;b$d++)b$v[(b$C=b$f[b$d]).name]=this._curOriginalData[b$o++],b$R[b$C.name]=this._curOriginalData[b$o++],this._curOriginalData[b$o++],this._curOriginalData[b$o++],this._curOriginalData[b$o++],this._curOriginalData[b$o++];var b$A,b$G,b$I={},b$U={};for(b$J+=b$F[2];b$d<b$J;b$d++)b$I[(b$C=b$f[b$d]).name]=this._curOriginalData[b$o++],b$U[b$C.name]=this._curOriginalData[b$o++],this._curOriginalData[b$o++],this._curOriginalData[b$o++],this._curOriginalData[b$o++],this._curOriginalData[b$o++];if(this._pathDic)for(b$J+=b$F[3];b$d<b$J;b$d++){if(b$C=b$f[b$d],b$A=this._pathDic[b$C.name])switch(new b$TM(b$C.extenData).getByte()){case 1:b$A.position=this._curOriginalData[b$o++];break;case 2:b$A.spacing=this._curOriginalData[b$o++];break;case 3:b$A.rotateMix=this._curOriginalData[b$o++],b$A.translateMix=this._curOriginalData[b$o++]}}if(this._yReverseMatrix?this._rootBone.update(this._yReverseMatrix):this._rootBone.update(b$mM.TEMP.identity()),this._ikArr)for(b$d=0,b$J=this._ikArr.length;b$d<b$J;b$d++)b$G=this._ikArr[b$d],b$I.hasOwnProperty(b$G.name)&&(b$G.bendDirection=b$I[b$G.name]),b$U.hasOwnProperty(b$G.name)&&(b$G.mix=b$U[b$G.name]),b$G.apply();if(this._pathDic)for(var b$Q in this._pathDic)(b$A=this._pathDic[b$Q]).apply(this._boneList,b$i);if(this._tfArr)for(b$d=0,b$l=this._tfArr.length;b$d<b$l;b$d++)this._tfArr[b$d].apply();for(b$d=0,b$l=this._boneList.length;b$d<b$l;b$d++)if(b$X=this._boneList[b$d],b$K=this._bindBoneBoneSlotDic[b$X.name],b$X.resultMatrix.copyTo(this._boneMatrixArray[b$d]),b$K)for(b$P=0,b$J=b$K.length;b$P<b$J;b$P++)(b$V=b$K[b$P])&&b$V.setParentMatrix(b$X.resultMatrix);var b$W,b$c,b$n,b$a,b$T={},b$m=this._templet.deformAniArr;if(b$m&&0<b$m.length){if(this._lastAniClipIndex!=this._aniClipIndex)for(this._lastAniClipIndex=this._aniClipIndex,b$d=0,b$J=this._boneSlotArray.length;b$d<b$J;b$d++)(b$V=this._boneSlotArray[b$d]).deformData=null;var b$e,b$s=b$m[this._aniClipIndex];for(b$e in b$W=b$s.default,this._setDeform(b$W,b$T,this._boneSlotArray,b$H),b$s)"default"!=b$e&&b$e!=this._skinName&&(b$W=b$s[b$e],this._setDeform(b$W,b$T,this._boneSlotArray,b$H));b$W=b$s[this._skinName],this._setDeform(b$W,b$T,this._boneSlotArray,b$H)}if(this._drawOrder)for(b$d=0,b$J=this._drawOrder.length;b$d<b$J;b$d++)b$c=b$v[(b$V=this._boneSlotArray[this._drawOrder[b$d]]).name],b$n=b$R[b$V.name],isNaN(b$n)||(b$i.save(),b$i.alpha(b$n)),isNaN(b$c)||-2==b$c||(this._templet.attachmentNames?b$V.showDisplayByName(this._templet.attachmentNames[b$c]):b$V.showDisplayByIndex(b$c)),b$T[this._drawOrder[b$d]]?(b$a=b$T[this._drawOrder[b$d]],b$V.currDisplayData&&b$a[b$V.currDisplayData.attachmentName]?b$V.deformData=b$a[b$V.currDisplayData.attachmentName]:b$V.deformData=null):b$V.deformData=null,isNaN(b$n)?b$V.draw(b$i,this._boneMatrixArray,2==this._aniMode):b$V.draw(b$i,this._boneMatrixArray,2==this._aniMode,b$n),isNaN(b$n)||b$i.restore();else for(b$d=0,b$J=this._boneSlotArray.length;b$d<b$J;b$d++)b$c=b$v[(b$V=this._boneSlotArray[b$d]).name],b$n=b$R[b$V.name],isNaN(b$n)||(b$i.save(),b$i.alpha(b$n)),isNaN(b$c)||-2==b$c||(this._templet.attachmentNames?b$V.showDisplayByName(this._templet.attachmentNames[b$c]):b$V.showDisplayByIndex(b$c)),b$T[b$d]?(b$a=b$T[b$d],b$V.currDisplayData&&b$a[b$V.currDisplayData.attachmentName]?b$V.deformData=b$a[b$V.currDisplayData.attachmentName]:b$V.deformData=null):b$V.deformData=null,isNaN(b$n)?b$V.draw(b$i,this._boneMatrixArray,2==this._aniMode):b$V.draw(b$i,this._boneMatrixArray,2==this._aniMode,b$n),isNaN(b$n)||b$i.restore();0==this._aniMode?this._templet.setGrahicsDataWithCache(this._aniClipIndex,b$M,b$i):1==this._aniMode&&this._setGrahicsDataWithCache(this._aniClipIndex,b$M,b$i)},b$M._setDeform=function(b$M,b$y,b$i,b$H){if(b$M){var b$S,b$f,b$V,b$K=0,b$k=0,b$X=0;if(b$M)for(b$K=0,b$k=b$M.deformSlotDataList.length;b$K<b$k;b$K++)for(b$S=b$M.deformSlotDataList[b$K],b$X=0;b$X<b$S.deformSlotDisplayList.length;b$X++)b$V=b$i[(b$f=b$S.deformSlotDisplayList[b$X]).slotIndex],b$f.apply(b$H,b$V),b$y[b$f.slotIndex]||(b$y[b$f.slotIndex]={}),b$y[b$f.slotIndex][b$f.attachment]=b$f.deformData}},b$M.getAnimNum=function(){return this._templet.getAnimationCount()},b$M.getAniNameByIndex=function(b$M){return this._templet.getAniNameByIndex(b$M)},b$M.getSlotByName=function(b$M){return this._boneSlotDic[b$M]},b$M.showSkinByName=function(b$M,b$y){void 0===b$y&&(b$y=!0),this.showSkinByIndex(this._templet.getSkinIndexByName(b$M),b$y)},b$M.showSkinByIndex=function(b$M,b$y){void 0===b$y&&(b$y=!0);for(var b$i=0;b$i<this._boneSlotArray.length;b$i++)this._boneSlotArray[b$i].showSlotData(null,b$y);if(this._templet.showSkinByIndex(this._boneSlotDic,b$M,b$y)){var b$H=this._templet.skinDataArray[b$M];this._skinIndex=b$M,this._skinName=b$H.name}this._clearCache()},b$M.showSlotSkinByIndex=function(b$M,b$y){if(0!=this._aniMode){var b$i=this.getSlotByName(b$M);b$i&&b$i.showDisplayByIndex(b$y),this._clearCache()}},b$M.showSlotSkinByName=function(b$M,b$y){if(0!=this._aniMode){var b$i=this.getSlotByName(b$M);b$i&&b$i.showDisplayByName(b$y),this._clearCache()}},b$M.replaceSlotSkinName=function(b$M,b$y,b$i){if(0!=this._aniMode){var b$H=this.getSlotByName(b$M);b$H&&b$H.replaceDisplayByName(b$y,b$i),this._clearCache()}},b$M.replaceSlotSkinByIndex=function(b$M,b$y,b$i){if(0!=this._aniMode){var b$H=this.getSlotByName(b$M);b$H&&b$H.replaceDisplayByIndex(b$y,b$i),this._clearCache()}},b$M.setSlotSkin=function(b$M,b$y){if(0!=this._aniMode){var b$i=this.getSlotByName(b$M);b$i&&b$i.replaceSkin(b$y),this._clearCache()}},b$M._clearCache=function(){if(1==this._aniMode)for(var b$M=0,b$y=this._graphicsCache.length;b$M<b$y;b$M++){for(var b$i=0,b$H=this._graphicsCache[b$M].length;b$i<b$H;b$i++){var b$S=this._graphicsCache[b$M][b$i];b$S!=this.graphics&&b$D.recycle(b$S)}this._graphicsCache[b$M].length=0}},b$M.play=function(b$M,b$y,b$i,b$H,b$S,b$f){void 0===b$i&&(b$i=!0),void 0===b$H&&(b$H=0),void 0===b$S&&(b$S=0),void 0===b$f&&(b$f=!0),this._indexControl=!1;var b$V=-1,b$K=NaN;if(b$K=b$y?2147483647:0,"string"==typeof b$M)for(var b$k=0,b$X=this._templet.getAnimationCount();b$k<b$X;b$k++){var b$F=this._templet.getAnimation(b$k);if(b$F&&b$M==b$F.name){b$V=b$k;break}}else b$V=b$M;-1<b$V&&b$V<this.getAnimNum()&&(this._aniClipIndex=b$V,(b$i||this._pause||this._currAniIndex!=b$V)&&(this._currAniIndex=b$V,this._curOriginalData=new Float32Array(this._templet.getTotalkeyframesLength(b$V)),this._drawOrder=null,this._eventIndex=0,this._player.play(b$V,this._player.playbackRate,b$K,b$H,b$S),b$f&&this._templet.showSkinByIndex(this._boneSlotDic,this._skinIndex),this._pause&&(this._pause=!1,this._lastTime=b$o.now(),this.timer.frameLoop(1,this,this._update,null,!0)),this._update()))},b$M.stop=function(){this._pause||(this._pause=!0,this._player&&this._player.stop(!0),this.timer.clear(this,this._update))},b$M.playbackRate=function(b$M){this._player&&(this._player.playbackRate=b$M)},b$M.paused=function(){this._pause||(this._pause=!0,this._player&&(this._player.paused=!0),this.timer.clear(this,this._update))},b$M.resume=function(){this._indexControl=!1,this._pause&&(this._pause=!1,this._player&&(this._player.paused=!1),this._lastTime=b$o.now(),this.timer.frameLoop(1,this,this._update,null,!0))},b$M._getGrahicsDataWithCache=function(b$M,b$y){return this._graphicsCache[b$M][b$y]},b$M._setGrahicsDataWithCache=function(b$M,b$y,b$i){this._graphicsCache[b$M][b$y]=b$i},b$M.destroy=function(b$M){void 0===b$M&&(b$M=!0),b$y.prototype.destroy.call(this,b$M),this._templet=null,this._player&&this._player.offAll(),this._player=null,this._curOriginalData=null,this._boneMatrixArray.length=0,this._lastTime=0,this.timer.clear(this,this._update)},b$f(0,b$M,"url",function(){return this._aniPath},function(b$M){this.load(b$M)}),b$f(0,b$M,"index",function(){return this._index},function(b$M){this.player&&(this._index=b$M,this._player.currentTime=1e3*this._index/this._player.cacheFrameRate,this._indexControl=!0,this._update(!1))}),b$f(0,b$M,"total",function(){return this._templet&&this._player?this._total=Math.floor(this._templet.getAniDuration(this._player.currentAnimationClipIndex)/1e3*this._player.cacheFrameRate):this._total=-1,this._total}),b$f(0,b$M,"templet",function(){return this._templet}),b$f(0,b$M,"player",function(){return this._player}),b$i.useSimpleMeshInCanvas=!1,b$i}(b$fM),b$n=function(b$y){function b$S(){this._mainTexture=null,this._textureJson=null,this._graphicsCache=[],this.srcBoneMatrixArr=[],this.ikArr=[],this.tfArr=[],this.pathArr=[],this.boneSlotDic={},this.bindBoneBoneSlotDic={},this.boneSlotArray=[],this.skinDataArray=[],this.skinDic={},this.subTextureDic={},this.isParseFail=!1,this.yReverseMatrix=null,this.drawOrderAniArr=[],this.eventAniArr=[],this.attachmentNames=null,this.deformAniArr=[],this._isDestroyed=!1,this._rate=30,this.isParserComplete=!1,this.aniSectionDic={},this._skBufferUrl=null,this._textureDic={},this._loadList=null,this._path=null,this.tMatrixDataLen=0,this.mRootBone=null,b$S.__super.call(this),this.skinSlotDisplayDataArr=[],this.mBoneArr=[]}b$H(b$S,"laya.ani.bone.Templet",b$y);var b$M=b$S.prototype;return b$M.getLoadList=function(){return this._loadList},b$M.loadAni=function(b$M){this._skBufferUrl=b$M,b$SM.loader.load(b$M,b$k.create(this,this.onComplete),null,"arraybuffer")},b$M.onComplete=function(b$M){if(this._isDestroyed)this.destroy();else{var b$y=b$X.getRes(this._skBufferUrl);b$y?(this._path=this._skBufferUrl.slice(0,this._skBufferUrl.lastIndexOf("/"))+"/",this.parseData(null,b$y)):this.event("error","load failed:"+this._skBufferUrl)}},b$M.parseData=function(b$M,b$y,b$i){void 0===b$i&&(b$i=30),!this._path&&this.url&&(this._path=this.url.slice(0,this.url.lastIndexOf("/"))+"/"),this._mainTexture=b$M,this._mainTexture&&b$h.isWebGL&&b$M.bitmap&&(b$M.bitmap.enableMerageInAtlas=!1),this._rate=b$i,this.parse(b$y)},b$M.buildArmature=function(b$M){return void 0===b$M&&(b$M=0),new b$c(this,b$M)},b$M.parse=function(b$M){b$y.prototype.parse.call(this,b$M),this._endLoaded(),this._aniVersion!=b$S.LAYA_ANIMATION_VISION&&(console.error("[Error] 版本不一致，请使用IDE版本配套的重新导出"+this._aniVersion+"->"+b$S.LAYA_ANIMATION_VISION),this._loaded=!1),this.loaded?this._mainTexture?this._parsePublicExtData():this._parseTexturePath():(this.event("error",this),this.isParseFail=!0)},b$M._parseTexturePath=function(){if(this._isDestroyed)this.destroy();else{var b$M=0;this._loadList=[];var b$y,b$i=new b$TM(this.getPublicExtData()),b$H=0,b$S=0,b$f=0,b$V=b$i.getInt32(),b$K=b$i.readUTFString(),b$k=b$K.split("\n");for(b$M=0;b$M<b$V;b$M++)b$y=this._path+b$k[2*b$M],b$K=b$k[2*b$M+1],b$i.getFloat32(),b$i.getFloat32(),b$H=b$i.getFloat32(),b$S=b$i.getFloat32(),b$f=b$i.getFloat32(),isNaN(b$f)?0:b$f,b$f=b$i.getFloat32(),isNaN(b$f)?0:b$f,b$f=b$i.getFloat32(),isNaN(b$f)?b$H:b$f,b$f=b$i.getFloat32(),isNaN(b$f)?b$S:b$f,-1==this._loadList.indexOf(b$y)&&this._loadList.push(b$y);this.event("inited",this)}},b$M._textureComplete=function(){for(var b$M,b$y,b$i=0,b$H=this._loadList.length;b$i<b$H;b$i++)b$y=this._loadList[b$i],b$M=this._textureDic[b$y]=b$X.getRes(b$y),b$h.isWebGL&&b$M&&b$M.bitmap&&(b$M.bitmap.enableMerageInAtlas=!1);this._parsePublicExtData()},b$M._parsePublicExtData=function(){var b$M=0,b$y=0,b$i=0,b$H=0,b$S=0;for(b$M=0,b$S=this.getAnimationCount();b$M<b$S;b$M++)this._graphicsCache.push([]);var b$f;b$f="Dragon"!=this._aniClassName;var b$V,b$K,b$k=new b$TM(this.getPublicExtData()),b$X=0,b$F=0,b$o=0,b$d=0,b$P=0,b$l=0,b$J=0,b$h=0,b$C=0,b$v=b$k.getInt32(),b$R=b$k.readUTFString(),b$A=b$R.split("\n");for(b$M=0;b$M<b$v;b$M++){if(b$V=this._mainTexture,b$K=this._path+b$A[2*b$M],b$R=b$A[2*b$M+1],null==this._mainTexture&&(b$V=this._textureDic[b$K]),!b$V)return this.event("error",this),void(this.isParseFail=!0);b$X=b$k.getFloat32(),b$F=b$k.getFloat32(),b$o=b$k.getFloat32(),b$d=b$k.getFloat32(),b$C=b$k.getFloat32(),b$P=isNaN(b$C)?0:b$C,b$C=b$k.getFloat32(),b$l=isNaN(b$C)?0:b$C,b$C=b$k.getFloat32(),b$J=isNaN(b$C)?b$o:b$C,b$C=b$k.getFloat32(),b$h=isNaN(b$C)?b$d:b$C,this.subTextureDic[b$R]=b$eM.create(b$V,b$X,b$F,b$o,b$d,-b$P,-b$l,b$J,b$h),b$V.alphaTexture&&(this.subTextureDic[b$R].alphaTexture=b$eM.create(b$V.alphaTexture,b$X,b$F,b$o,b$d,-b$P,-b$l,b$J,b$h))}this._mainTexture=b$V;var b$G,b$I,b$U,b$Q,b$W,b$c=b$k.getUint16();for(b$M=0;b$M<b$c;b$M++)(b$G=[]).push(b$k.getUint16()),b$G.push(b$k.getUint16()),b$G.push(b$k.getUint16()),b$G.push(b$k.getUint16()),this.aniSectionDic[b$M]=b$G;var b$n,b$a=b$k.getInt16(),b$T={};for(b$M=0;b$M<b$a;b$M++)b$I=new b$sM,0==b$M?b$n=b$I:b$I.root=b$n,b$I.d=b$f?-1:1,b$Q=b$k.readUTFString(),b$W=b$k.readUTFString(),b$I.length=b$k.getFloat32(),1==b$k.getByte()&&(b$I.inheritRotation=!1),1==b$k.getByte()&&(b$I.inheritScale=!1),b$I.name=b$Q,b$W&&((b$U=b$T[b$W])?b$U.addChild(b$I):this.mRootBone=b$I),b$T[b$Q]=b$I,this.mBoneArr.push(b$I);this.tMatrixDataLen=b$k.getUint16();var b$m,b$e,b$s=b$k.getUint16(),b$D=Math.floor(b$s/this.tMatrixDataLen),b$z=this.srcBoneMatrixArr;for(b$M=0;b$M<b$D;b$M++)(b$m=new b$YM).scX=b$k.getFloat32(),b$m.skX=b$k.getFloat32(),b$m.skY=b$k.getFloat32(),b$m.scY=b$k.getFloat32(),b$m.x=b$k.getFloat32(),b$m.y=b$k.getFloat32(),8===this.tMatrixDataLen&&(b$m.skewX=b$k.getFloat32(),b$m.skewY=b$k.getFloat32()),b$z.push(b$m),(b$I=this.mBoneArr[b$M]).transform=b$m;var b$w,b$q=b$k.getUint16(),b$t=0;for(b$M=0;b$M<b$q;b$M++){for(b$e=new b$pM,b$t=b$k.getUint16(),b$y=0;b$y<b$t;b$y++)b$e.boneNames.push(b$k.readUTFString()),b$e.boneIndexs.push(b$k.getInt16());b$e.name=b$k.readUTFString(),b$e.targetBoneName=b$k.readUTFString(),b$e.targetBoneIndex=b$k.getInt16(),b$e.bendDirection=b$k.getFloat32(),b$e.mix=b$k.getFloat32(),b$e.isSpine=b$f,this.ikArr.push(b$e)}var b$u,b$p=b$k.getUint16(),b$B=0;for(b$M=0;b$M<b$p;b$M++){for(b$w=new b$bM,b$B=b$k.getUint16(),b$y=0;b$y<b$B;b$y++)b$w.boneIndexs.push(b$k.getInt16());b$w.name=b$k.getUTFString(),b$w.targetIndex=b$k.getInt16(),b$w.rotateMix=b$k.getFloat32(),b$w.translateMix=b$k.getFloat32(),b$w.scaleMix=b$k.getFloat32(),b$w.shearMix=b$k.getFloat32(),b$w.offsetRotation=b$k.getFloat32(),b$w.offsetX=b$k.getFloat32(),b$w.offsetY=b$k.getFloat32(),b$w.offsetScaleX=b$k.getFloat32(),b$w.offsetScaleY=b$k.getFloat32(),b$w.offsetShearY=b$k.getFloat32(),this.tfArr.push(b$w)}var b$Z=b$k.getUint16(),b$E=0;for(b$M=0;b$M<b$Z;b$M++){for((b$u=new b$BM).name=b$k.readUTFString(),b$E=b$k.getUint16(),b$y=0;b$y<b$E;b$y++)b$u.bones.push(b$k.getInt16());b$u.target=b$k.readUTFString(),b$u.positionMode=b$k.readUTFString(),b$u.spacingMode=b$k.readUTFString(),b$u.rotateMode=b$k.readUTFString(),b$u.offsetRotation=b$k.getFloat32(),b$u.position=b$k.getFloat32(),b$u.spacing=b$k.getFloat32(),b$u.rotateMix=b$k.getFloat32(),b$u.translateMix=b$k.getFloat32(),this.pathArr.push(b$u)}var b$_,b$b,b$Y,b$r,b$N,b$$=0,b$x=0,b$g=0,b$j=NaN,b$O=0,b$L=b$k.getInt16();for(b$M=0;b$M<b$L;b$M++){var b$MM=b$k.getUint8(),b$yM={};this.deformAniArr.push(b$yM);for(var b$iM=0;b$iM<b$MM;b$iM++)for((b$_=new b$zM).skinName=b$k.getUTFString(),b$yM[b$_.skinName]=b$_,b$$=b$k.getInt16(),b$y=0;b$y<b$$;b$y++)for(b$b=new b$wM,b$_.deformSlotDataList.push(b$b),b$x=b$k.getInt16(),b$i=0;b$i<b$x;b$i++)for(b$Y=new b$qM,b$b.deformSlotDisplayList.push(b$Y),b$Y.slotIndex=b$k.getInt16(),b$Y.attachment=b$k.getUTFString(),b$g=b$k.getInt16(),b$H=0;b$H<b$g;b$H++)for(1==b$k.getByte()?b$Y.tweenKeyList.push(!0):b$Y.tweenKeyList.push(!1),b$j=b$k.getFloat32(),b$Y.timeList.push(b$j),b$r=[],b$Y.vectices.push(b$r),b$O=b$k.getInt16(),b$S=0;b$S<b$O;b$S++)b$r.push(b$k.getFloat32())}var b$HM,b$SM,b$fM=b$k.getInt16(),b$VM=0,b$KM=0;for(b$M=0;b$M<b$fM;b$M++){for(b$VM=b$k.getInt16(),b$N=[],b$y=0;b$y<b$VM;b$y++){for((b$HM=new b$tM).time=b$k.getFloat32(),b$KM=b$k.getInt16(),b$i=0;b$i<b$KM;b$i++)b$HM.drawOrder.push(b$k.getInt16());b$N.push(b$HM)}this.drawOrderAniArr.push(b$N)}var b$kM,b$XM=b$k.getInt16(),b$FM=0;for(b$M=0;b$M<b$XM;b$M++){for(b$FM=b$k.getInt16(),b$SM=[],b$y=0;b$y<b$FM;b$y++)(b$kM=new b$uM).name=b$k.getUTFString(),b$kM.intValue=b$k.getInt32(),b$kM.floatValue=b$k.getFloat32(),b$kM.stringValue=b$k.getUTFString(),b$kM.time=b$k.getFloat32(),b$SM.push(b$kM);this.eventAniArr.push(b$SM)}var b$oM=b$k.getInt16();if(0<b$oM)for(this.attachmentNames=[],b$M=0;b$M<b$oM;b$M++)this.attachmentNames.push(b$k.getUTFString());var b$dM,b$PM,b$lM=b$k.getInt16();for(b$M=0;b$M<b$lM;b$M++)(b$dM=new b$DM).name=b$k.readUTFString(),b$dM.parent=b$k.readUTFString(),b$dM.attachmentName=b$k.readUTFString(),b$dM.srcDisplayIndex=b$dM.displayIndex=b$k.getInt16(),(b$dM.templet=this).boneSlotDic[b$dM.name]=b$dM,null==(b$PM=this.bindBoneBoneSlotDic[b$dM.parent])&&(this.bindBoneBoneSlotDic[b$dM.parent]=b$PM=[]),b$PM.push(b$dM),this.boneSlotArray.push(b$dM);var b$JM,b$hM,b$CM,b$vM=b$k.readUTFString().split("\n"),b$RM=0,b$AM=b$k.getUint8(),b$GM=0,b$IM=0,b$UM=0,b$QM=0,b$WM=0,b$cM=0,b$nM=0;for(b$M=0;b$M<b$AM;b$M++){for((b$JM=new b$ZM).name=b$vM[b$RM++],b$GM=b$k.getUint8(),b$y=0;b$y<b$GM;b$y++){for((b$hM=new b$_M).name=b$vM[b$RM++],b$dM=this.boneSlotDic[b$hM.name],b$IM=b$k.getUint8(),b$i=0;b$i<b$IM;b$i++){if(b$CM=new b$EM,this.skinSlotDisplayDataArr.push(b$CM),b$CM.name=b$vM[b$RM++],b$CM.attachmentName=b$vM[b$RM++],b$CM.transform=new b$YM,b$CM.transform.scX=b$k.getFloat32(),b$CM.transform.skX=b$k.getFloat32(),b$CM.transform.skY=b$k.getFloat32(),b$CM.transform.scY=b$k.getFloat32(),b$CM.transform.x=b$k.getFloat32(),b$CM.transform.y=b$k.getFloat32(),b$hM.displayArr.push(b$CM),b$CM.width=b$k.getFloat32(),b$CM.height=b$k.getFloat32(),b$CM.type=b$k.getUint8(),b$CM.verLen=b$k.getUint16(),0<(b$a=b$k.getUint16()))for(b$CM.bones=[],b$H=0;b$H<b$a;b$H++){var b$aM=b$k.getUint16();b$CM.bones.push(b$aM)}if(0<(b$UM=b$k.getUint16()))for(b$CM.uvs=[],b$H=0;b$H<b$UM;b$H++)b$CM.uvs.push(b$k.getFloat32());if(0<(b$QM=b$k.getUint16()))for(b$CM.weights=[],b$H=0;b$H<b$QM;b$H++)b$CM.weights.push(b$k.getFloat32());if(0<(b$WM=b$k.getUint16()))for(b$CM.triangles=[],b$H=0;b$H<b$WM;b$H++)b$CM.triangles.push(b$k.getUint16());if(0<(b$cM=b$k.getUint16()))for(b$CM.vertices=[],b$H=0;b$H<b$cM;b$H++)b$CM.vertices.push(b$k.getFloat32());if(0<(b$nM=b$k.getUint16()))for(b$CM.lengths=[],b$H=0;b$H<b$nM;b$H++)b$CM.lengths.push(b$k.getFloat32())}b$JM.slotArr.push(b$hM)}this.skinDic[b$JM.name]=b$JM,this.skinDataArray.push(b$JM)}1==b$k.getUint8()?(this.yReverseMatrix=new b$mM(1,0,0,-1,0,0),b$n&&b$n.setTempMatrix(this.yReverseMatrix)):b$n&&b$n.setTempMatrix(new b$mM),this.showSkinByIndex(this.boneSlotDic,0),this.isParserComplete=!0,this.event("complete",this)},b$M.getTexture=function(b$M){var b$y=this.subTextureDic[b$M];return b$y||(b$y=this.subTextureDic[b$M.substr(0,b$M.length-1)]),null==b$y?this._mainTexture:b$y},b$M.showSkinByIndex=function(b$M,b$y,b$i){if(void 0===b$i&&(b$i=!0),b$y<0&&b$y>=this.skinDataArray.length)return!1;var b$H,b$S,b$f=0,b$V=0,b$K=this.skinDataArray[b$y];if(b$K){for(b$f=0,b$V=b$K.slotArr.length;b$f<b$V;b$f++)(b$S=b$K.slotArr[b$f])&&(b$H=b$M[b$S.name])&&(b$H.showSlotData(b$S,b$i),b$i&&"undefined"!=b$H.attachmentName&&"null"!=b$H.attachmentName?b$H.showDisplayByName(b$H.attachmentName):b$H.showDisplayByIndex(b$H.displayIndex));return!0}return!1},b$M.getSkinIndexByName=function(b$M){for(var b$y=0,b$i=this.skinDataArray.length;b$y<b$i;b$y++)if(this.skinDataArray[b$y].name==b$M)return b$y;return-1},b$M.getGrahicsDataWithCache=function(b$M,b$y){return this._graphicsCache[b$M][b$y]},b$M.setGrahicsDataWithCache=function(b$M,b$y,b$i){this._graphicsCache[b$M][b$y]=b$i},b$M.destroy=function(){var b$M;for(var b$y in this._isDestroyed=!0,this.subTextureDic)(b$M=this.subTextureDic[b$y])&&b$M.destroy();for(b$y in this._textureDic)(b$M=this._textureDic[b$y])&&b$M.destroy();for(var b$i=0,b$H=this.skinSlotDisplayDataArr.length;b$i<b$H;b$i++)this.skinSlotDisplayDataArr[b$i].destory();this.skinSlotDisplayDataArr.length=0,this.url&&delete b$S.TEMPLET_DICTIONARY[this.url],laya.resource.Resource.prototype.destroy.call(this)},b$M.getAniNameByIndex=function(b$M){var b$y=this.getAnimation(b$M);return b$y?b$y.name:null},b$f(0,b$M,"rate",function(){return this._rate},function(b$M){this._rate=b$M}),b$S.LAYA_ANIMATION_VISION="LAYAANIMATION:1.6.0",b$S.TEMPLET_DICTIONARY=null,b$S}(b$z)}(window,document,Laya),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(b$M,b$y){"use strict";for(var b$i in Object.defineProperty(b$y,"__esModule",{value:!0}),Laya){var b$H=Laya[b$i];b$H&&b$H.__isclass&&(b$y[b$i]=b$H)}});