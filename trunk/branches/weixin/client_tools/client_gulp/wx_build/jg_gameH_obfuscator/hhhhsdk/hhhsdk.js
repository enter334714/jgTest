var O=wx.$C;import sdk from"./hhhhelp.js";var config={game_id:256,game_pkg:O[30383],partner_label:O[30384],partner_id:O[30385],game_ver:O[30386],is_auth:!1,partner_app_id:28,partner_mp_id:O[30387]};window.config=config;var $hX6RYU=$hXRUY6();var HOST=O[30388];var $hX6RUY=null;var $hXRYU6=null;var sysInfo=wx.getSystemInfoSync();var platform=sysInfo.platform;var partner_user_info=null;var checkHandler=null;var loginHandler=null;var requestCallback=!1;function $hXRUY6(){var n={};return{order_data:{},init:function(e,r){e=e&&e.game_ver?e.game_ver:0;console.log(O[30389]);var t=this;var a;a=wx.getStorageSync(O[30390])?0:(a=t.uuid(16,32),wx.setStorageSync(O[30390],a),1),wx.getStorageSync(O[30391])||(o=t.uuid(16,32),wx.setStorageSync(O[30391],o));var o=wx.getLaunchOptionsSync();var n=o.scene||"";a&&o.query&&o.query.ad_code&&wx.setStorageSync(O[30392],o.query.ad_code),t.log(O[282],{install:a,scene:n}),wx.showShareMenu();t=o.query&&o.query.invite?o.query.invite:"";o=o.query&&o.query.invite_type?o.query.invite_type:"";t&&($hXRYU6={invite:t,invite_type:o,is_new:a,scene:n}),e&&this.checkGameVersion(e,function(e){r&&r(e)})},login:function(e,r){console.log(O[30393]),n[O[30394]]=typeof r==O[29940]?r:null;var t=this;let a=wx.getLaunchOptionsSync();sdk.init({app_id:config.partner_app_id,mp_id:config.partner_mp_id,showLoading:!1}).then(e=>{sdk.login({data:{state:a.query.state||a.query.scene||""},confg:{showLoading:!1}}).then(e=>{partner_user_info=e.data,t.do_login(e.data),console.log(O[30395]+JSON.stringify(e))})})},do_login:function(e){var a=this;var r=a.getPublicData();if(r[O[30396]]=JSON.stringify(e),$hXRYU6&&typeof $hXRYU6==O[277])for(var t in $hXRYU6)r[t]=$hXRYU6[t];var o=Date.now();wx.request({url:O[26267]+HOST+O[30397],method:O[30323],dataType:O[6065],header:{"content-type":O[30324]},data:r,success:function(e){if(console.log(O[30398]+JSON.stringify(e)),requestCallback=!0,loginHandler&&clearTimeout(loginHandler),loginHandler=null,200==e.statusCode){var r=e.data;if(r.state){try{wx.setStorageSync(O[30399],r.data.sdk_token),wx.setStorageSync(O[30400],r.data.user_id),wx.setStorageSync(O[30401],r.data.username),r.data.ext&&wx.setStorageSync(O[30402],r.data.ext)}catch(e){}var t={userid:r.data.user_id,account:r.data.nick_name,token:r.data.token,invite_uid:r.data.invite_uid||"",invite_nickname:r.data.invite_nickname||"",invite_head_img:r.data.invite_head_img||"",head_img:r.data.head_img||"",is_client:r.data.is_client||"0",ios_pay:r.data.ios_pay||"0"};n[O[30394]]&&n[O[30394]](0,t)}else n[O[30394]]&&n[O[30394]](1,{type:O[30403],errMsg:r.msg,time:Date.now()-o,res:e});a.getShareInfo(O[30404],function(e){console.log(O[30405]),wx.onShareAppMessage(function(){return a.logStartShare(O[30404]),{title:e.title,imageUrl:e.img,query:e.query}})})}else n[O[30394]]&&n[O[30394]](1,{type:O[30403],errMsg:O[30406],time:Date.now()-o,res:e})},fail:function(e){console.log(O[30407]),console.log(e),requestCallback=!0,loginHandler&&clearTimeout(loginHandler),loginHandler=null,n[O[30394]]&&n[O[30394]](1,{type:O[30408],errMsg:e.errMsg,time:Date.now()-o,res:e})}}),requestCallback||(loginHandler=setTimeout(function(){console.log(O[30409]),n[O[30394]]&&n[O[30394]](1,{type:O[30410],errMsg:O[30411],time:Date.now()-o}),n[O[30394]]=null},2e4))},share:function(e){n[O[30412]]=typeof callback==O[29940]?callback:null;var t=e.type||O[30412];console.log(O[30413]+t);var a=this;this.getShareInfo(t,function(e){a.logStartShare(t);var r=e.query;sdk.getShareInfo({data:{path:O[30414]}}).then(e=>{wx.onShareAppMessage(function(){return{title:e.data.title,imageUrl:e.data.image,query:"state="+e.data.state+"&"+r}})})}),sdk.addShareInfo({data:{to_target:"wx"}}).then(e=>{})},logStartShare:function(e){var r=wx.getStorageSync(O[30399]);wx.request({url:O[26267]+HOST+O[30415],method:O[30323],dataType:O[6065],header:{"content-type":O[30324]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:r,server_id:$hX6RUY?$hX6RUY.server_id:"",role_id:$hX6RUY?$hX6RUY.role_id:"",type:e},success:function(e){}})},openService:function(){wx.openCustomerServiceConversation()},checkGameVersion:function(e,r){console.log(O[30416]),n[O[7359]]=typeof r==O[29940]?r:null;wx.getStorageSync(O[30399]);wx.request({url:O[26267]+HOST+O[30417],method:O[30323],dataType:O[6065],header:{"content-type":O[30324]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,game_ver:e},success:function(e){var r;console.log(O[30418]),console.log(e),requestCallback=!0,checkHandler&&clearTimeout(checkHandler),checkHandler=null,200==e.statusCode&&(r=e.data).state?n[O[7359]]&&n[O[7359]](r.data):n[O[7359]]&&n[O[7359]]({develop:0})},fail:function(e){console.log(O[30419]),console.log(e),requestCallback=!0,checkHandler&&clearTimeout(checkHandler),checkHandler=null,n[O[7359]]&&n[O[7359]]({develop:0})}}),requestCallback||(checkHandler=setTimeout(function(){console.log(O[30420]),n[O[7359]]&&n[O[7359]]({develop:0}),n[O[7359]]=null},1e4))},getShareInfo:function(e,r){console.log(O[30421]);var t=wx.getStorageSync(O[30399]);wx.request({url:O[26267]+HOST+O[30422],method:O[30323],dataType:O[6065],header:{"content-type":O[30324]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:t,type:e,server_id:$hX6RUY?$hX6RUY.server_id:"",role_id:$hX6RUY?$hX6RUY.role_id:"",no_log:1},success:function(e){console.log(O[30423]),console.log(e),200==e.statusCode?(e=e.data).state?r&&r(e.data):n[O[30412]]&&n[O[30412]](1,{errMsg:O[30424]+e.msg}):n[O[30412]]&&n[O[30412]](1,{errMsg:O[30425]})}})},updateShare:function(e,r,t,a,o,n){console.log(O[30426]);var i=wx.getStorageSync(O[30399]);wx.request({url:O[26267]+HOST+O[30427],method:O[30323],dataType:O[6065],header:{"content-type":O[30324]},data:{game_pkg:config.game_pkg,partner_id:config.partner_id,sdk_token:i,invite:e,invite_type:r,is_new:t,role_id:a,sever_id:o,scene:n},success:function(e){console.log(O[30428]+JSON.stringify(e))}})},msgCheck:function(e,r){console.log(O[30429]+e);let t={data:{}};sdk.checkMsg({data:{content:e}}).then(e=>{console.log(O[30430]+JSON.stringify(e)),e.msg==O[10186]?(t.statusCode=200,t.data.state=1):(t.statusCode=0,t.data.state=0),r&&r(t)},e=>{console.log(e),t.statusCode=0,t.data.state=0,r&&r(t)})},pay:function(e,r){this.startPay(e,r)},startPay:function(e,r){console.log(O[30431]+JSON.stringify(e));n[O[30432]]=typeof r==O[29940]?r:null;r=wx.getStorageSync(O[30399]);var t=wx.getStorageSync(O[30402]);r?(e={cpbill:e.cpbill,productid:e.productid,productname:e.productname,productdesc:e.productdesc,serverid:e.serverid,servername:e.servername,roleid:e.roleid,rolename:e.rolename,rolelevel:e.rolelevel,price:e.price,extension:e.extension,sdk_token:r,session_key:t,platform:platform},this.order_data=e,(r=this.getPublicData())[O[30434]]=JSON.stringify(e),wx.request({url:O[26267]+HOST+O[30435],method:O[30323],dataType:O[6065],header:{"content-type":O[30324]},data:r,success:function(e){console.log(O[30436]+JSON.stringify(e)),200==e.statusCode?(e=e.data).state?sdk.checkPay({data:{"order-currency":O[30437],"order-cp_order_id":e.data.pay_data.orderId,"order-product_price":e.data.pay_data.amount,"order-product_id":e.data.pay_data.productId,"order-product_cnt":1,"order-product_name":e.data.pay_data.productName,"order-product_desc":e.data.pay_data.productDec,"order-ext":e.data.pay_data.orderId,"role-event":"5","role-server_id":e.data.pay_data.serverId,"role-server_name":e.data.pay_data.serverName,"role-role_id":e.data.pay_data.roleId,"role-role_name":e.data.pay_data.roleName,"role-role_level":e.data.pay_data.roleLevel,"role-role_vip":0}}).then(e=>{console.log(O[30438]+JSON.stringify(e))}):n[O[30432]]&&n[O[30432]](1,{errMsg:e.msg}):n[O[30394]]&&n[O[30394]](1,{errMsg:O[30406]})}})):n[O[30432]]&&n[O[30432]](1,{errMsg:O[30433]})},logCreateRole:function(e){var r=wx.getStorageSync(O[30400]);var t=wx.getStorageSync(O[30401]);var a={};a[O[30439]]=r,a[O[30440]]=t,a[O[11136]]=e.roleid,a[O[30441]]=e.rolelevel,a[O[30442]]=e.rolename,a[O[11813]]=e.serverid,e.roleid&&e.serverid&&($hX6RUY={role_id:e.roleid,server_id:e.serverid}),this.log(O[6],a),sdk.updateRole({data:{"role-event":"2","role-server_id":e.serverid,"role-server_name":e.servername,"role-role_id":e.roleid,"role-role_name":e.rolename,"role-role_level":e.rolelevel,"role-role_vip":0,"role-combat_num":0}}).then(e=>{},e=>{})},logEnterGame:function(e){var r=wx.getStorageSync(O[30400]);var t=wx.getStorageSync(O[30401]);var a={};a[O[30439]]=r,a[O[30440]]=t,a[O[11136]]=e.roleid,a[O[30441]]=e.rolelevel,a[O[30442]]=e.rolename,a[O[11813]]=e.serverid,e.roleid&&e.serverid&&($hX6RUY={role_id:e.roleid,server_id:e.serverid}),this.log(O[5947],a),$hXRYU6&&this.updateShare($hXRYU6.invite,$hXRYU6.invite_type,$hXRYU6.is_new,e.roleid,e.serverid,$hXRYU6.scene),sdk.updateRole({data:{"role-event":"1","role-server_id":e.serverid,"role-server_name":e.servername,"role-role_id":e.roleid,"role-role_name":e.rolename,"role-role_level":e.rolelevel,"role-role_vip":0,"role-combat_num":0}}).then(e=>{},e=>{})},logRoleUpLevel:function(e){var r=wx.getStorageSync(O[30400]);var t=wx.getStorageSync(O[30401]);var a={};a[O[30439]]=r,a[O[30440]]=t,a[O[11136]]=e.roleid,a[O[30441]]=e.rolelevel,a[O[30442]]=e.rolename,a[O[11813]]=e.serverid,e.roleid&&e.serverid&&($hX6RUY={role_id:e.roleid,server_id:e.serverid}),this.log(O[30443],a)},uuid:function(e,r){var t=O[30444].split("");var a,o=[];var n;if(e=e||t.length,r)for(a=0;a<r;a++)o[a]=t[0|Math.random()*e];else for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",a=0;a<36;a++)o[a]||(n=0|16*Math.random(),o[a]=t[19==a?3&n|8:n]);return o.join("")},getPublicData:function(){var e=wx.getStorageSync(O[30390]);var r=wx.getStorageSync(O[30391]);var t=wx.getStorageSync(O[30392]);return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id,partner_label:config.partner_label,ad_code:t,uuid:e,idfv:r,mac:O[30445],is_from_min:1,dname:sysInfo.model,net_type:0==sysInfo.wifiSignal?"4G":O[30446],os_ver:sysInfo.system,sdk_ver:sysInfo.version,game_ver:config.game_ver,device:sysInfo.platform==O[30318]?1:2}},log:function(e,r){var t=this.getPublicData();for(var a in r)t[a]=r[a];console.log(O[30447]+e),console.log(t),wx.request({url:O[26267]+HOST+O[30448]+e+O[30449]+encodeURIComponent(JSON.stringify(t))})},getDate:function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"-"+e.getDate()},downloadClient:function(){wx.openCustomerServiceConversation()},weiduanHelper:function(){},setMessageToFriendQuery:function(e,r){e=e.activity_id;r(wx.setMessageToFriendQuery({shareMessageToFriendScene:e}))}}}function run(e,r,t){e in $hX6RYU&&$hX6RYU[e](r,t)}exports.init=function(e,r){run(O[363],e,r)},exports.login=function(e){run(O[30394],"",e)},exports.login=function(e){run(O[30394],"",e)},exports.pay=function(e,r){run(O[30432],e,r)},exports.openService=function(){run(O[24342])},exports.logCreateRole=function(e,r,t,a,o){run(O[30450],{serverid:e,servername:r,roleid:t,rolename:a,rolelevel:o})},exports.logEnterGame=function(e,r,t,a,o){run(O[30451],{serverid:e,servername:r,roleid:t,rolename:a,rolelevel:o})},exports.logRoleUpLevel=function(e,r,t,a,o){run(O[30452],{serverid:e,servername:r,roleid:t,rolename:a,rolelevel:o})},exports.share=function(e){run(O[30412],{type:e})},exports.msgCheck=function(e,r){run(O[12518],e,r)},exports.downloadClient=function(){run(O[30453])},exports.getConfig=function(){return{game_id:config.game_id,game_pkg:config.game_pkg,partner_id:config.partner_id}},exports.getPublicData=function(){run(O[30454])},exports.weiduanHelper=function(){run(O[24232])},exports.setMessageToFriendQuery=function(e,r){run(O[30455],e,r)};