var O=wx.$C;!function(o,l){l.un,l.uns;var t=l.static,a=l.class,e=l.getset,d=(l.__newvec,laya.utils.Browser),n=(laya.events.Event,laya.events.EventDispatcher),u=laya.resource.HTMLImage,c=laya.utils.Handler,i=laya.display.Input,h=laya.net.Loader,f=(laya.maths.Matrix,laya.renders.Render),m=laya.utils.RunDriver,v=(laya.media.Sound,laya.media.SoundChannel),p=laya.media.SoundManager,w=(laya.display.Stage,laya.net.URL),x=laya.utils.Utils,r=(a(xhj0dw,"laya.wx.mini.MiniAdpter"),xhj0dw.getJson=function(t){return JSON.parse(t)},xhj0dw.init=function(t,e){void 0===t&&(t=!1),void 0===e&&(e=!1),xhj0dw._inited||(xhj0dw.window=o).navigator.userAgent.indexOf("MiniGame")<0||(xhj0dw._inited=!0,xhj0dw.isZiYu=e,xhj0dw.isPosMsgYu=t,xhj0dw.EnvConfig={},xhj0dw.isZiYu||(s.setNativeFileDir("/layaairGame"),s.existDir(s.fileNativeDir,c.create(xhj0dw,xhj0dw.onMkdirCallBack))),xhj0dw.window.focus=function(){},l.getUrlPath=function(){},xhj0dw.window.logtime=function(t){},xhj0dw.window.alertTimeLog=function(t){},xhj0dw.window.resetShareInfo=function(){},xhj0dw.window.CanvasRenderingContext2D=function(){},xhj0dw.window.CanvasRenderingContext2D.prototype=xhj0dw.window.wx.createCanvas().getContext("2d").__proto__,xhj0dw.window.document.body.appendChild=function(){},xhj0dw.EnvConfig.pixelRatioInt=0,m.getPixelRatio=xhj0dw.pixelRatio,xhj0dw._preCreateElement=d.createElement,d.createElement=xhj0dw.createElement,m.createShaderCondition=xhj0dw.createShaderCondition,x.parseXMLFromString=xhj0dw.parseXMLFromString,i._createInputElement=y._createInputElement,xhj0dw.EnvConfig.load=h.prototype.load,h.prototype.load=g.prototype.load,xhj0dw.isZiYu&&t&&wx.onMessage(function(t){t.isLoad&&(s.ziyuFileData[t.url]=t.data)}))},xhj0dw.onMkdirCallBack=function(t,e){t||(s.filesListObj=JSON.parse(e.data))},xhj0dw.pixelRatio=function(){if(!xhj0dw.EnvConfig.pixelRatioInt)try{var t=wx.getSystemInfoSync();return xhj0dw.EnvConfig.pixelRatioInt=t.pixelRatio,t.pixelRatio}catch(t){}return xhj0dw.EnvConfig.pixelRatioInt},xhj0dw.createElement=function(t){return"canvas"!=t?"textarea"==t||"input"==t?xhj0dw.onCreateInput(t):"div"==t?((n=xhj0dw._preCreateElement(t)).contains=function(t){return null},n.removeChild=function(t){},n):xhj0dw._preCreateElement(t):(1==xhj0dw.idx?xhj0dw.isZiYu?(e=sharedCanvas).style={}:e=o.canvas:e=o.wx.createCanvas(),xhj0dw.idx++,e);var e;var n},xhj0dw.onCreateInput=function(t){t=xhj0dw._preCreateElement(t);return t.focus=y.wxinputFocus,t.blur=y.wxinputblur,t.style={},t.value=0,t.parentElement={},t.placeholder={},t.type={},t.setColor=function(t){},t.setType=function(t){},t.setFontFace=function(t){},t.addEventListener=function(t){},t.contains=function(t){return null},t.removeChild=function(t){},t},xhj0dw.createShaderCondition=function(t){var e=this;return function(){return e[t.replace("this.","")]}},xhj0dw.EnvConfig=null,xhj0dw.window=null,xhj0dw._preCreateElement=null,xhj0dw._inited=!1,xhj0dw.wxRequest=null,xhj0dw.systemInfo=null,xhj0dw.version="0.0.1",xhj0dw.isZiYu=!1,xhj0dw.isPosMsgYu=!1,xhj0dw.parseXMLFromString=function(t){var e;t=t.replace(/>\s+</g,"><");try{e=(new o.Parser.DOMParser).parseFromString(t,"text/xml")}catch(t){throw"\u9700\u8981\u5f15\u5165xml\u89e3\u6790\u5e93\u6587\u4ef6"}return e},xhj0dw.idx=1,xhj0dw),y=(a(omlt5k,"laya.wx.mini.MiniImage"),omlt5k.prototype._loadImage=function(t){var e=!1;-1==t.indexOf("layaNativeDir/")&&(e=!0,t=w.formatURL(t)),s.getFileInfo(t)?omlt5k.onCreateImage(t,this,!e):-1!=t.indexOf("http://")||-1!=t.indexOf("https://")?s.downImg(t,new c(omlt5k,omlt5k.onDownImgCallBack,[t,this]),t):omlt5k.onCreateImage(t,this,!0)},omlt5k.onDownImgCallBack=function(t,e,n){n?e.onError(null):omlt5k.onCreateImage(t,e)},omlt5k.onCreateImage=function(e,n,t){var i;function lup$5c(){i.onload=null,i.onerror=null,delete n.imgCache[e]}t=(t=void 0===t?!1:t)?e:(t=s.getFileInfo(e).md5,s.getFileNativePath(t)),null==n.imgCache&&(n.imgCache={});function As(){lup$5c(),n.onLoaded(i)}function Ds(){lup$5c(),n.event("error","Load image failed")}"nativeimage"==n._type?((i=new d.window.Image).crossOrigin="",i.onload=As,i.onerror=Ds,i.src=t,n.imgCache[e]=i):new u.create(t,{onload:As,onerror:Ds,onCreate:function(t){i=t,n.imgCache[e]=t}})},a(xhd0jw,"laya.wx.mini.MiniInput"),xhd0jw._createInputElement=function(){i._initInput(i.area=d.createElement("textarea")),i._initInput(i.input=d.createElement("input")),i.inputContainer=d.createElement("div"),i.inputContainer.style.position="absolute",i.inputContainer.style.zIndex=1e5,d.container.appendChild(i.inputContainer),i.inputContainer.setPos=function(t,e){i.inputContainer.style.left=t+"px",i.inputContainer.style.top=e+"px"},l.stage.on("resize",null,xhd0jw._onStageResize),wx.onWindowResize&&wx.onWindowResize(function(t){o.dispatchEvent&&o.dispatchEvent("resize")}),p._soundClass=E,p._musicClass=E,o._videoClass=k},xhd0jw._onStageResize=function(){l.stage._canvasTransform.identity().scale(d.width/f.canvas.width/m.getPixelRatio(),d.height/f.canvas.height/m.getPixelRatio())},xhd0jw.wxinputFocus=function(t){var e=i.inputElement.target;e&&!e.editable||(r.window.wx.offKeyboardConfirm(),r.window.wx.offKeyboardInput(),r.window.wx.showKeyboard({defaultValue:e.text,maxLength:e.maxChars,multiple:e.multiline,confirmHold:!0,confirmType:"done",success:function(t){},fail:function(t){}}),r.window.wx.onKeyboardConfirm(function(t){t=t?t.value:"";e.text=t,e.event("input"),laya.wx.mini.MiniInput.inputEnter()}),r.window.wx.onKeyboardInput(function(t){t=t?t.value:"";e.multiline||-1==t.indexOf("\n")?(e.text=t,e.event("input")):laya.wx.mini.MiniInput.inputEnter()}))},xhd0jw.inputEnter=function(){i.inputElement.target.focus=!1},xhd0jw.wxinputblur=function(){xhd0jw.hideKeyboard()},xhd0jw.hideKeyboard=function(){r.window.wx.offKeyboardConfirm(),r.window.wx.offKeyboardInput(),r.window.wx.hideKeyboard({success:function(t){console.log("\u9690\u85cf\u952e\u76d8")},fail:function(t){console.log("\u9690\u85cf\u952e\u76d8\u51fa\u9519:"+(t?t.errMsg:""))}})},xhd0jw),g=(a(as_n,"laya.wx.mini.MiniLoader"),(C=as_n.prototype).load=function(t,e,n,i,o){void 0===n&&(n=!0),void 0===o&&(o=!1);var l=this;0===(l._url=t).indexOf("data:image")?l._type=e="image":l._type=e=e||l.getTypeFromUrl(t),l._cache=n,l._data=null;var a="ascii";-1!=t.indexOf(".fnt")?a="utf8":"arraybuffer"==e&&(a="");var d=x.getFileExtension(t);if(-1!=as_n._fileTypeArr.indexOf(d))r.EnvConfig.load.call(this,t,e,n,i,o);else if(s.getFileInfo(t))r.EnvConfig.load.call(this,t,e,n,i,o);else{if(-1!=t.indexOf("layaNativeDir/"))return r.isZiYu?(d=s.ziyuFileData[t],void l.onLoaded(d)):(cosnole.log("read read"),void s.read(t,a,new c(as_n,as_n.onReadNativeCallBack,[a,t,e,n,i,o,l])));d=""==w.rootPath?t:t.split(w.rootPath)[0],-1!=t.indexOf("http://")||-1!=t.indexOf("https://")?r.EnvConfig.load.call(l,t,e,n,i,o):s.readFile(d,a,new c(as_n,as_n.onReadNativeCallBack,[a,t,e,n,i,o,l]),t)}},C.resMgrLoad=function(t,i,e,n,o,l,a){void 0===e&&(e=0),void 0===n&&(n=!1),void 0===o&&(o=!1),void 0===l&&(l=0),void 0===a&&(a=3),-1!=t.indexOf("mpack")&&console.log("=============resMgrLoad url:",t),r.EnvConfig.resMgrLoad(t,(t,e,n)=>{as_n.prototype.resMgrLoadCallBack(t,e,n,i)},e,n,o,l,a)},C.resMgrLoadCallBack=function(t,e,n,i){console.log("buff:::",t,n,s.fileNativeDir+"///"+s.fileListName),i(t,e,n)},C.clearRes=function(t,e){this.clearRes(t,e=void 0===e?!1:e);e=s.getFileInfo(t);!e||-1==t.indexOf("http://")&&-1==t.indexOf("https://")||(t=e.md5,e=s.getFileNativePath(t),s.remove(e))},as_n.onReadNativeCallBack=function(t,e,n,i,o,l,a,d,s){void 0===i&&(i=!0),void 0===l&&(l=!1),(d=void 0===d?0:d)?1==d&&r.EnvConfig.load.call(a,e,n,i,o,l):(d="json"==n||"atlas"==n?r.getJson(s.data):"xml"==n?x.parseXMLFromString(s.data):s.data,a.onLoaded(d),!r.isZiYu&&r.isPosMsgYu&&"arraybuffer"!=n&&wx.postMessage({url:e,data:d,isLoad:!0}))},t(as_n,["_fileTypeArr",function(){return this._fileTypeArr=["png","jpg","bmp","jpeg","gif"]}]),as_n),s=(a(mot5kl,"laya.wx.mini.MiniFileMgr",n),mot5kl.isLoadFile=function(t){return-1!=mot5kl._fileTypeArr.indexOf(t)},mot5kl.getFileInfo=function(t){t=t.split("?")[0],t=mot5kl.filesListObj[t];return null==t?null:t},mot5kl.onFileUpdate=function(t,e){var t=t.split("/"),t=t[t.length-1],n=mot5kl.getFileInfo(e);null==n?mot5kl.onSaveFile(e,t):n.readyUrl!=e&&mot5kl.remove(t,e)},mot5kl.exits=function(t,e){t=mot5kl.getFileNativePath(t);mot5kl.fs.getFileInfo({filePath:t,success:function(t){null!=e&&e.runWith([0,t])},fail:function(t){null!=e&&e.runWith([1,t])}})},mot5kl.read=function(t,e,n,i){void 0===e&&(e="ascill"),t=""!=(i=void 0===i?"":i)?mot5kl.getFileNativePath(t):t,mot5kl.fs.readFile({filePath:t,encoding:e,success:function(t){null!=n&&n.runWith([0,t])},fail:function(t){t&&""!=i?mot5kl.down(i,e,n,i):null!=n&&n.runWith([1])}})},mot5kl.readNativeFile=function(t,e){mot5kl.fs.readFile({filePath:t,encoding:"",success:function(t){null!=e&&e.runWith([0])},fail:function(t){null!=e&&e.runWith([1])}})},mot5kl.down=function(t,e,n,i){void 0===e&&(e="ascill"),void 0===i&&(i="");var o=mot5kl.getFileNativePath(i);mot5kl.wxdown({url:t,filePath:o,success:function(t){200===t.statusCode&&mot5kl.readFile(t.filePath,e,n,i)},fail:function(t){null!=n&&n.runWith([1,t])}}).onProgressUpdate(function(t){null!=n&&n.runWith([2,t.progress])})},mot5kl.readFile=function(e,t,n,i){void 0===i&&(i=""),mot5kl.fs.readFile({filePath:e,encoding:t=void 0===t?"ascill":t,success:function(t){-1==e.indexOf("http://")&&-1==e.indexOf("https://")||mot5kl.onFileUpdate(e,i),null!=n&&n.runWith([0,t])},fail:function(t){t&&null!=n&&n.runWith([1,t])}})},mot5kl.downImg=function(t,e,n){void 0===n&&(n="");mot5kl.wxdown({url:t,success:function(t){200===t.statusCode&&mot5kl.copyFile(t.tempFilePath,n,e)},fail:function(t){null!=e&&e.runWith([1,t])}})},mot5kl.copyFile=function(t,e,n){var i=t.split("/"),o=i[i.length-1],l=(e.split("?")[0],mot5kl.getFileInfo(e)),i=mot5kl.getFileNativePath(o);mot5kl.fs.copyFile({srcPath:t,destPath:i,success:function(t){l?l.readyUrl!=e&&mot5kl.remove(o,e,n):(mot5kl.onSaveFile(e,o),null!=n&&n.runWith([0]))},fail:function(t){null!=n&&n.runWith([1,t])}})},mot5kl.getFileNativePath=function(t){return laya.wx.mini.MiniFileMgr.fileNativeDir+"/"+t},mot5kl.remove=function(e,n,i){void 0===n&&(n="");var t=mot5kl.getFileInfo(n),o=mot5kl.getFileNativePath(t.md5);l.loader.clearRes(t.readyUrl),mot5kl.fs.unlink({filePath:o,success:function(t){""!=n&&mot5kl.onSaveFile(n,e),null!=i&&i.runWith([0])},fail:function(t){}})},mot5kl.onSaveFile=function(t,e){var n=t.split("?")[0];mot5kl.filesListObj[n]={md5:e,readyUrl:t},mot5kl.fs.writeFile({filePath:mot5kl.fileNativeDir+"/"+mot5kl.fileListName,encoding:"utf8",data:JSON.stringify(mot5kl.filesListObj),success:function(t){console.log("\u5199\u5165\u6d4b\u8bd5\u6d4b\u8bd5\u6210\u529f\uff1a",t)},fail:function(t){console.log("\u5199\u5165\u6d4b\u8bd5\u6d4b\u8bd5\u5931\u8d25\uff1a",t)}})},mot5kl.existDir=function(t,e){mot5kl.fs.mkdir({dirPath:t,success:function(t){null!=e&&e.runWith([0,{data:JSON.stringify({})}])},fail:function(t){-1!=t.errMsg.indexOf("file already exists")?mot5kl.readSync(mot5kl.fileListName,"utf8",e):null!=e&&e.runWith([1,t])}})},mot5kl.readSync=function(t,e,n,i){void 0===e&&(e="ascill"),void 0===i&&(i="");var o,e=mot5kl.getFileNativePath(t);try{o=mot5kl.fs.readFileSync(e),null!=n&&n.runWith([0,{data:o}])}catch(t){null!=n&&n.runWith([1])}},mot5kl.readCache=function(){},mot5kl.writeCache=function(t){var e=readyUrl.split("?")[0];mot5kl.filesListObj[e]={md5:md5Name,readyUrl:readyUrl},mot5kl.fs.writeFile({filePath:mot5kl.fileNativeDir+"/"+mot5kl.fileListName,encoding:"utf8",data:JSON.stringify(mot5kl.filesListObj),success:function(t){},fail:function(t){}})},mot5kl.setNativeFileDir=function(t){mot5kl.fileNativeDir=wx.env.USER_DATA_PATH+t},mot5kl.filesListObj={},mot5kl.fileNativeDir=null,mot5kl.fileListName="layaairfiles.txt",mot5kl.ziyuFileData={},t(mot5kl,["_fileTypeArr",function(){return this._fileTypeArr=["json","ani","xml","sk","txt","atlas","swf","part","fnt","proto","lh","lav","lani","lmat","lm","ltc"]},"fs",function(){return this.fs=wx.getFileSystemManager()},"wxdown",function(){return this.wxdown=wx.downloadFile}]),mot5kl),E=(a(rzu9$8,"laya.wx.mini.MiniSound",n),(C=rzu9$8.prototype).load=function(t){var e;t=w.formatURL(t),this.url=t,rzu9$8._audioCache[t]?this.event("complete"):(this._sound.onCanplay(function(){e.loaded=!0,e.event("complete"),rzu9$8._audioCache[e.url]=e}),this._sound.onError(function(t){console.error("errCode="+t.errCode+"  errMsg="+t.errMsg),e.event("error")}),this._sound.src=t,e=this)},C.play=function(t,e){var n,i;return void 0===t&&(t=0),void 0===e&&(e=0),i=(n=this.url==p._tMusic?(rzu9$8._musicAudio||(rzu9$8._musicAudio=this._sound),rzu9$8._musicAudio):this._sound,this._chanell),n.src=this.url,n.startTime=0,i.isStopped&&(i.url=this.url,i.loops=e,i.startTime=t,i.play(),p.addChannel(i)),i},C.dispose=function(){var t=rzu9$8._audioCache[this.url];t&&(t.src="",delete rzu9$8._audioCache[this.url])},e(0,C,"duration",function(){return this._sound.duration}),rzu9$8._createSound=function(){return rzu9$8._id++,r.window.wx.createInnerAudioContext({useWebAudioImplement:!1})},rzu9$8._musicAudio=null,rzu9$8._id=0,rzu9$8._audioCache={},rzu9$8._null=void 0,rzu9$8),_=(a(z9hjrd,"laya.wx.mini.MiniSoundChannel",v),(t=z9hjrd.prototype).__onEnd=function(){if(1==this.loops)return this.completeHandler&&(l.timer.once(10,this,this.__runComplete,[this.completeHandler],!1),this.completeHandler=null),this.stop(),void this.event("complete");0<this.loops&&this.loops--,this.startTime=0,this.play()},t.__onNull=function(){},t.play=function(){this.isStopped=!1,p.addChannel(this),this._audio&&this._audio.play()},t.stop=function(){this.isStopped=!0,p.removeChannel(this),this.completeHandler=null,this._audio&&this._audio.stop()},t.pause=function(){this.isStopped=!0,this._audio.pause()},t.resume=function(){this._audio&&(this.isStopped=!1,p.addChannel(this),this._audio.play())},e(0,t,"position",function(){return this._audio?this._audio.currentTime:0}),e(0,t,"duration",function(){return this._audio?this._audio.duration:0}),e(0,t,"volume",function(){return 1},function(t){}),z9hjrd._null=void 0,z9hjrd),k=(a(ocmtl5,"laya.wx.mini.MiniVideo"),(n=ocmtl5.prototype).on=function(t,e,n){"loadedmetadata"==t?(this.onPlayFunc=n.bind(e),this.videoElement.onPlay=this.onPlayFunction.bind(this)):"ended"==t&&(this.onEndedFunC=n.bind(e),this.videoElement.onEnded=this.onEndedFunction.bind(this)),this.videoElement.onTimeUpdate=this.onTimeUpdateFunc.bind(this)},n.onTimeUpdateFunc=function(t){this.position=t.position,this._duration=t.duration},n.onPlayFunction=function(){this.videoElement&&(this.videoElement.readyState=200),console.log("=====\u89c6\u9891\u52a0\u8f7d\u5b8c\u6210========"),null!=this.onPlayFunc&&this.onPlayFunc()},n.onended=function(t,e){this.onEndedFunC=e.bind(t),this.videoElement.onended=this.onEndedFunction.bind(this)},n.onEndedFunction=function(){this.videoElement&&(this.videoend=!0,console.log("=====\u89c6\u9891\u64ad\u653e\u5b8c\u6bd5========"),null!=this.onEndedFunC&&this.onEndedFunC())},n.off=function(t,e,n){"loadedmetadata"==t?(this.onPlayFunc=n.bind(e),this.videoElement.offPlay=this.onPlayFunction.bind(this)):"ended"==t&&(this.onEndedFunC=n.bind(e),this.videoElement.offEnded=this.onEndedFunction.bind(this))},n.load=function(t){this.videoElement&&(this.videoElement.src=t)},n.play=function(){this.videoElement&&(this.videoend=!1,this.videoElement.play())},n.pause=function(){this.videoElement&&(this.videoend=!0,this.videoElement.pause())},n.size=function(t,e){this.videoElement&&(this.videoElement.width=t,this.videoElement.height=e)},n.destroy=function(){this.videoElement&&this.videoElement.destroy(),this.videoElement=null,this.onEndedFunC=null,this.onPlayFunc=null,this.videoend=!1,this.videourl=null},n.reload=function(){this.videoElement&&(this.videoElement.src=this.videourl)},e(0,n,"duration",function(){return this._duration}),e(0,n,"currentTime",function(){return this.videoElement?this.videoElement.initialTime:0},function(t){this.videoElement&&(this.videoElement.initialTime=t)}),e(0,n,"videoWidth",function(){return this.videoElement?this.videoElement.width:0}),e(0,n,"videoHeight",function(){return this.videoElement?this.videoElement.height:0}),e(0,n,"ended",function(){return this.videoend}),e(0,n,"loop",function(){return!!this.videoElement&&this.videoElement.loop},function(t){this.videoElement&&(this.videoElement.loop=t)}),e(0,n,"playbackRate",function(){return this.videoElement?this.videoElement.playbackRate:0},function(t){this.videoElement&&(this.videoElement.playbackRate=t)}),e(0,n,"muted",function(){return!!this.videoElement&&this.videoElement.muted},function(t){this.videoElement&&(this.videoElement.muted=t)}),e(0,n,"paused",function(){return!!this.videoElement&&this.videoElement.paused}),e(0,n,"x",function(){return this.videoElement?this.videoElement.x:0},function(t){this.videoElement&&(this.videoElement.x=t)}),e(0,n,"y",function(){return this.videoElement?this.videoElement.y:0},function(t){this.videoElement&&(this.videoElement.y=t)}),e(0,n,"currentSrc",function(){return this.videoElement.src}),e(0,n,"src",function(){return this.videoElement?this.videoElement.src:0},function(t){this.videoElement&&(this.videoElement.src=t)}),e(0,n,"controls",function(){if(this.videoElement)return this.videoElement.controls},function(t){this.videoElement&&(this.videoElement.controls=t)}),e(0,n,"autoplay",function(){if(this.videoElement)return this.videoElement.autoplay},function(t){this.videoElement&&(this.videoElement.autoplay=t)}),ocmtl5);function ocmtl5(){this.videoend=!1,this.videourl="",this.videoElement=r.window.wx.createVideo({showCenterPlayBtn:!1,showProgressInControlMode:!1,objectFit:"fill"})}function z9hjrd(t){this._audio=null,this._onEnd=null,z9hjrd.__super.call(this),this.isStopped=!0,this._audio=t,this._onEnd=x.bind(this.__onEnd,this),t.onEnded(this._onEnd)}function rzu9$8(){this._sound=null,this._chanell=null,this.url=null,this.loaded=!1,rzu9$8.__super.call(this),this._sound=rzu9$8._createSound(),this._chanell=new _(this._sound)}function mot5kl(){mot5kl.__super.call(this)}function as_n(){}var C;function xhd0jw(){}function omlt5k(){}function xhj0dw(){}}(window,(document,Laya)),"function"==typeof define&&define.amd&&define("laya.core",["require","exports"],function(t,e){"use strict";for(var n in Object.defineProperty(e,"__esModule",{value:!0}),Laya){var i=Laya[n];i&&i.__isclass&&(e[n]=i)}});